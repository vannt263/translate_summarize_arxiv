{
  "article_text": [
    "the last decade has witnessed a proliferation in methodologies for numerically solving large - scale problems in electrostatics and electronic structure .",
    "the rapid growth has been driven by several factors .",
    "first , theoretical advances in the understanding of localization properties of electronic systems have justified at a fundamental level approaches which utilize localized density matrices or orbitals in their formulation ( kohn , 1996 ; ismail - beigi and arias , 1998 ; goedecker , 1999 ) .",
    "second , a wide variety of computational methods have exploited that physical locality , leading to linear scaling of the computing time with system size ( goedecker , 1999 ) .",
    "third , general algorithms for solving electrostatics and eigenvalue problems have been improved or newly developed including particle - mesh methods ( hockney and eastwood , 1988 ; darden _ et al .",
    "_ , 1993 ; pollock and glosli , 1996 ) , fast - multipole approaches ( greengard , 1994 ) , multigrid techniques ( brandt , 1977 , 1982 , 1984 ; hackbusch , 1985 ) , and krylov subspace and related algorithms ( booten and van der vorst , 1996 ) .",
    "last , and perhaps not least , the ready availability of very fast processors for low cost has allowed for quantum modeling of systems of unprecedented size .",
    "these calculations can be performed on workstations or workstation clusters , thus creating opportunities for a wide range of researchers in fields both inside and outside of computational physics and chemistry ( bernholc , 1999 ) .",
    "several monographs and collections of reviews illustrate the great variety of problems recently addressed with electrostatics and electronic structure methods ( gross and dreizler , 1994 ; bicout and field , 1996 ; seminario , 1996 ; springborg , 1997 ; banci and comba , 1997 ; von rague schleyer , 1998 ; jensen , 1999 ; hummer and pratt , 1999 ) .",
    "this review examines one subset of these new computational methods , namely real - space techniques .",
    "real - space methods can loosely be categorized as one of three types : finite differences ( fd ) , finite elements ( fe ) , or wavelets .",
    "all three lead to structured , very sparse matrix representations of the underlying differential equations on meshes in real space . applications of wavelets in electronic structure calculations have been thoroughly reviewed recently ( arias , 1999 ) and will therefore not be addressed here .",
    "this article discusses the fundamentals of fd and fe solutions of poisson and nonlinear poisson - boltzmann equations in electrostatics and self - consistent eigenvalue problems in electronic structure . as implied in the title , the primary focus is on calculations in density functional theory ( dft ) ; real - space methods are in no way limited to dft , but since dft calculations comprise a dominant theme in modern electrostatics and electronic structure , the discussion here will mainly be restricted to this particular theoretical approach .",
    "consider a physical system for which local approaches such as real - space methods are appropriate : a transition metal ion bound to several ligands embedded in a protein .",
    "these systems are of significance in a wide range of biochemical mechanisms ( banci and comba , 1997 ) .",
    "treating the entire system with _ ab initio _ methods is presently impossible .",
    "however , if the primary interest is in the nature of the bonding structure and electronic states of the transition metal ion , one can imagine a three - tier approach ( fig .",
    "[ fig : protein ] ) .",
    "the central region , including the metal ion and the ligands , is treated with an accurate quantum method such as dft .",
    "a second neighboring shell is represented quantum mechanically but is not allowed to change during self - consistency iterations .",
    "the wavefunctions in the central zone must be orthogonalized to the fixed orbitals in the second region . finally , the very distant portions of the protein are fixed in space and treated classically ; the main factors to include from the far locations are the electrostatic field from charged or partially charged groups on the protein and the response of the solvent ( typically treated as a dielectric continuum ) .",
    "real - space methods provide a helpful language for representing such a problem .",
    "the real - space grid can be refined to account for the high resolution necessary around the metal ion and can be adjusted for a coarser treatment further away .",
    "there is clearly no need to allow the metal and ligand orbitals to extend far from the central zone , so a localized representation is advantageous .",
    "also , the electrostatic potential can be generated over the entire domain ( quantum , classical , and solvent zones ) with a single real - space solver without requiring special techniques for matching conditions in the various regions .",
    "the same ideas could be applied to defects in a covalent solid or impurity atoms in a cluster .    in order to place the real - space methods in context",
    ", we first briefly examine other computational approaches .",
    "the plane - wave pseudopotential method has proven to be a powerful technique for locating the electronic ground state for many - particle systems in condensed phases ( payne _ et al .",
    "_ , 1992 ) . in this method",
    "the orbitals are expanded in the nonlocal plane - wave basis .",
    "the core states are removed via pseudopotential methods which allow for relatively smooth valence functions in the core region even for first - row and transition elements ( vanderbilt , 1990 ) .",
    "therefore , a reasonable number of plane - waves can be used to accurately represent most elements important for materials simulation .",
    "strengths of this method include the use of efficient fast fourier transform ( fft ) techniques for updates of the orbitals and electrostatic potentials , lack of dependence of the basis on atom positions , and the rigorous control of numerical convergence of the approximation with decrease in wavelength of the highest fourier mode .",
    "algorithmic advances have led to excellent convergence characteristics of the method in terms of the number of required self - consistency steps ( payne _ et al . _ , 1992 ; hutter _ et al .",
    "_ , 1994 ; kresse and furthmller , 1996 ) ; only 5 - 10 self - consistency iterations are required to obtain tight convergence of the total energy , even for metals . in spite of the numerous advantages of this approach ,",
    "there are restrictions centered around the nonlocal basis set .",
    "even with the advances in pseudopotential methods , strong variations in the potential occur in the core regions ( especially for first - row and transition elements ) , and local refinements would allow for smaller effective energy cutoffs away from the nuclei .",
    "this issue has been addressed by the development of adaptive - coordinate plane - wave methods ( gygi , 1993 ) .",
    "if any information is required concerning the inner - shell electrons , plane - wave methods suffer severe difficulties .",
    "of course such states can be represented with a sufficient number of plane waves ( bellaiche and kunc , 1997 ) , but the short - wavelength modes required to build in the rapidly varying local structure extend over the entire domain to portions of the system where such resolution is not necessary .",
    "also , for localized systems like molecules , clusters , or surfaces , nontrivial effort is expended to accurately reproduce the vacuum ; the zero - density regions must be of significant size in order to minimize spurious effects in a supercell representation .",
    "in addition , charged systems create technical difficulties since a uniform neutralizing background needs to be properly added and subtracted in computations of total energies .",
    "lastly , without special efforts to utilize localized - orbital representations , the wavefunction orthogonality step scales as @xmath0 , where @xmath1 is the number of electrons .    in quantum chemistry ,",
    "localized basis sets built from either slater - type orbitals ( stos ) or gaussian functions have predominated in the description of atoms and molecules ( szabo and ostlund , 1989 ; jensen , 1999 ) .",
    "the molecular orbitals are constructed from linear combinations of the atomic orbitals ( lcao ) .",
    "an accurate representation can be obtained with less than thirty gaussians for a first - row atom . in relation to plane - wave expansions , the localized nature of these basis functions is more in line with chemical concepts . with stos or other numerical orbitals ,",
    "the multicenter integrals in the hamiltonian must be evaluated numerically , while with a gaussian basis , the coulomb integrals are available analytically .",
    "the ` price ' for using gaussians is that more basis functions are required to accurately describe the electron states , since they do not exhibit the correct behavior at either small or large distances from the nuclei .",
    "techniques such as direct inversion in the iterative subspace ( diis ) have been developed to significantly accelerate the convergence behavior of basis - set self - consistent electronic structure methods ( pulay , 1980 , 1982 ; hamilton and pulay , 1986 ) .",
    "the lcao methods have led to a dramatic growth in accurate calculations on molecules with up to tens of atoms .",
    "it is now common to see papers devoted to detailed comparisons of experimental results and electronic structure calculations on systems with more than one hundred electrons ( rodriguez _ et al .",
    "_ , 1998 ) . often in basis - set calculations",
    ", care must be taken to account for basis - set superposition errors which arise due to overlap of nonorthogonal atom centered functions for composite systems .",
    "also , linear dependence is a problem for very large basis sets chosen to minimize the errors .",
    "these factors lead to difficulty in obtaining the basis - set limit for a given level of theory .",
    "the scaling of basis - set methods can be severe , but recent developments ( see section [ sec : linsc ] ) have brought the scaling down to linear for large systems .    with the successes of plane - wave and quantum chemical basis functions , what is the motivation to search for alternative algorithms ?",
    "ten years ago , a review article discussing the relevance of gaussian basis - set calculations for lattice gauge theories argued for the utilization of gaussian basis sets in place of grids ( wilson , 1990 ) . the author states ( concerning the growth of quantum chemistry ) :  the most important algorithmic advance was the introduction of systematic algorithms using analytic basis functions in place of numerical grids , first proposed in the early 1950s . \" the point was illustrated by examination of core states for carbon : only a few gaussians are required ( with variable exponential parameters ) , while up to @xmath2 grid points are necessary for the same energy resolution on a uniform mesh .",
    "what developments have occurred over the last decade which could begin to overcome such a large disparity in computational effort ?    this review seeks to answer the above question by summarizing recent research on real - space mesh techniques . to locate them in relation to plane - wave expansions and lcao methods ,",
    "some general features are introduced here and further developed throughout the article .",
    "the representation of the physical problems is simple : the potential operator is diagonal in coordinate space and the laplacian is nearly local , depending on the order of the approximation .",
    "the near - locality makes real - space methods well suited for incorporation into linear - scaling approaches .",
    "it also allows for relatively straightforward domain - decomposition parallel implementation .",
    "finite or charged systems are easily handled . with higher - order fd and fe approximations , the size of the overall domain is substantially reduced from the estimate above .",
    "adaptive mesh refinements or coordinate transformations can be employed to gain resolution in local regions of space , further reducing the grid overhead .",
    "real - space pseudopotentials result in smooth valence functions in the core region , again leading to smaller required grids .",
    "as mentioned above , the grid - based matrix representation produces structured and highly banded matrices , in contrast to plane - wave and lcao expansions ( payne _ et al _ , 1992 ; challacombe , 2000 ) .",
    "these matrix equations can be rapidly solved with efficient multiscale ( or other preconditioning ) techniques .",
    "however , while more banded than lcao representations , the overall dimension of the hamiltonian is substantially higher .",
    "mesh leads to roughly 0.005% nonzero elements or @xmath3 total terms ; with 2000 basis functions in an sto-3g / lda water cluster calculation , about 10% of the elements are nonzero implying @xmath4 remaining matrix terms . see millam and scuseria ( 1997 ) . ] in a sense , the real - space methods are closely linked to plane - wave approaches : they are both ` fully numerical ' methods with one or at most a few parameters controlling the convergence of the approximation , for example the grid spacing @xmath5 or the wavevector of the highest mode @xmath6 . on the other hand ,",
    "the lcao methods employ a better physical representation of the orbitals ( thus requiring fewer basis functions ) ; attached with this representation , however , are some of the problems discussed above related to the art of constructing nonorthogonal , atom- or bond - centered basis sets .",
    "the purposes of this paper are 1 ) to provide a basic introduction to real - space computational techniques , 2 ) to review their recent applications to chemical and physical problems , and 3 ) to relate the methods to other commonly used numerical approaches in electrostatics and electronic structure .",
    "the numerical problems addressed in this review can be categorized into four types in order of increasing complexity :    @xmath7    the first expression symbolizes the generation of the laplacian on the real - space grid .",
    "the second is the linear , elliptic poisson equation .",
    "the third is the nonlinear poisson - boltzmann equation of electrostatics which describes the motion of small counterions in the field of fixed charges .",
    "the final equation is an eigenvalue equation such as the self - consistent schrdinger equation occurring in electronic structure .",
    "note that both the third and fourth equations are nonlinear .",
    "the poisson - boltzmann equation includes exponential driving terms on the rhs .",
    "the self - consistent eigenvalue problem is ` doubly nonlinear ' : one must solve for both the eigenvalues and eigenfunctions , and the potential generally depends nonlinearly on the eigenfunctions .",
    "the multigrid method allows for solution of both linear and nonlinear problems with similar efficiencies .",
    "the article is organized into several sections beginning with background discussion and then following the order of problems listed above .",
    "section [ sec : dft ] introduces the central equations of dft for electronic structure and charged classical systems .",
    "section [ sec : linsc ] reviews developments in linear - scaling computational algorithms and discusses their relationship to real - space methods .",
    "section [ sec : fdfe ] presents the fundamental aspects of representation in real space by examination of poisson problems .",
    "section [ sec : mg ] discusses multigrid methods for efficient solution of the resulting matrix representations .",
    "section [ sec : es ] summarizes recent advances in electrostatics computations in real space including both poisson and nonlinear poisson - boltzmann solvers .",
    "applications in biophysics are illustrated with several examples .",
    "section [ sec : ks ] discusses real - space eigenvalue methods for self - consistent problems in electronic structure .",
    "section [ sec : tddft ] summarizes recent computations of optical response properties and excitation energies with real - space methods .",
    "the review concludes with a short summary and discussion of possible future directions for research .",
    "motivated by the fundamental hohenberg - kohn theorems ( hohenberg and kohn 1964 ) of dft , kohn and sham ( 1965 ) developed a set of accessible one - electron self - consistent eigenvalue equations .",
    "these equations have provided a practical tool for realistic electronic structure computations on a vast array of atoms , molecules , and materials ( parr and yang , 1989 ) .",
    "the hohenberg - kohn theorems have been extended to finite - temperature quantum systems by mermin ( 1965 ) and to purely classical fluids in subsequent work ( hansen and mcdonald , 1986 ; ichimaru , 1994 ) .",
    "an integral formulation of electronic structure has also been discovered in which the one - electron density is obtained directly without the introduction of orbitals ( harris and pratt , 1985 ; parr and yang , 1989 ) .",
    "this approach is in the spirit of the original hohenberg - kohn theorems , but to date this promising theory has not been used extensively in numerical studies .",
    "this section reviews the basic equations of dft for electronic structure and charged classical systems .",
    "these equations provide the background for discussion of the real - space numerical methods .",
    "the kohn - sham self - consistent eigenvalue equations for electronic structure can be written as follows ( atomic units are assumed throughout ) :    @xmath8 \\psi_i({\\bf r } ) = \\epsilon_i \\psi_i({\\bf r } ) , \\label{eq : ks}\\ ] ]    where the density - dependent effective potential is    @xmath9 ; { \\bf r } ) .",
    "\\label{eq : veff}\\ ] ]    the classical electrostatic potential @xmath10 is due to both the electrons and nuclei , and the ( in principle ) exact exchange - correlation potential @xmath11 ; { \\bf r})$ ] incorporates all nonclassical effects .",
    "the exchange - correlation potential includes a kinetic contribution since the expectation value of the kohn - sham kinetic energy is that for a set of _ non - interacting _",
    "electrons moving in the one - electron effective potential .",
    "the electron density , @xmath12 , is obtained from the occupied orbitals ( double occupation is assumed here ) :    @xmath13    the electrostatic portion of the potential for a system of electrons and nuclei ( hartree potential plus nuclear potential ) is given by    @xmath14    this potential can be obtained by numerical solution of the poisson equation :    @xmath15    where @xmath16 is the total charge density due to the electrons and nuclei .    if the exchange - correlation potential is taken as a local _ function _ ( as opposed to functional ) of the density with the value the same as for a uniform electron gas , the approximation is termed the _ local density approximation _ ( lda ) .",
    "ceperley and alder ( 1980 ) determined the exchange - correlation energy for the uniform electron gas numerically via monte carlo simulation .",
    "the data have been parametrized in various ways for implementation in computational algorithms ( see , for example , vosko _ et al . _ , 1980 ) .",
    "the lda theory has been extended to handle spin - polarized systems ( parr and yang , 1989 ) .",
    "the lda yields results with accuracies comparable to or often superior to hartree - fock , but generally leads to overbinding in chemical bonds among other deficiencies .",
    "one obtains the hartree - fock approximation if the local exchange - correlation potential in eq .",
    "( [ eq : veff ] ) is replaced by the nonlocal exact exchange operator .    in recent years",
    ", a great deal of effort has gone into developing more accurate exchange - correlation potentials ( see jensen , 1999 , for a review ) .",
    "these advances involve both gradient expansions which incorporate information from electron density derivatives and hybrid methods which include some degree of exact hartree - fock exchange . with the utilization of these modifications ,",
    "results of chemical accuracy can be obtained .",
    "since the main focus of this review is on numerical approaches for solving the self - consistent equations , we do not further examine these developments .",
    "pseudopotential techniques allow for the removal of the core electrons .",
    "the valence electrons then move in a smoother ( nonlocal ) potential in the core region while exhibiting behavior the same as in an all - electron calculation outside the core .",
    "recently developed real - space versions of the pseudopotentials allow for computations on meshes ( troullier and martins , 1991a , 1991b ; goedecker _ et al .",
    "_ , 1996 ; briggs _ et al .",
    "_ , 1996 ) .",
    "inclusion of the pseudopotentials substantially reduces the computational overhead since fewer orbitals are treated explicitly and the required mesh resolution can be coarser .",
    "however , truly local mesh - refinement techniques may allow for the efficient inclusion of core electrons when necessary ( see sections [ subsubsec : mrt ] and [ subsec : scmrt ] ) .",
    "self - consistent solution of the kohn - sham equations [ eq.([eq : ks ] ) ] for fixed nuclear locations is conceptually straightforward .",
    "an initial guess is made for the orbitals .",
    "this yields an electron density from which the effective potential is constructed by solution of the poisson equation and generation of the exchange - correlation potential .",
    "the eigenvalue equation is solved with the current effective potential [ eq .  ( [ eq : veff ] ) ] , resulting in a new set of orbitals .",
    "the process is repeated until the density or total energy change only to within some desired tolerance .",
    "alternatively , the total energy can be minimized variationally using a technique such as conjugate gradients ( payne _ et al . _ , 1992 ) ; the orbitals at the minimum correspond to those from the iterative process described above .      the ground - state theory discussed above has been extended to finite - temperature quantum and classical systems and has found wide use in the theory of fluids ( rowlinson and widom , 1982 ; hansen and mcdonald , 1986 ; ichimaru , 1994 ) . here",
    "i discuss the formulation for systems of charged point particles ( mobile ions ) moving in the external potential produced by other charged particles in the solution ( for example , colloid spheres or cylinders ) .",
    "the solvent is assumed to be a uniform dielectric with dielectric constant @xmath17 in these equations .",
    "the free energy for an ion gas of counterions can be written as the sum of an ideal term , the energy of the mobile ions in the external field due to the fixed colloid particles ( this term incorporates both the electrostatic potential from the fixed charges on the colloids and an excluded - volume potential ) ,    @xmath18    the coulomb interaction potential energy of the mobile ions with each other , and a correlation free energy . the mobile - ion density @xmath19 is the number density , not the charge density , in the solution .",
    "the charge on the counterions is @xmath20 , and the approximate correlation free energy typically assumes a local density approximation for a one - component plasma . thus the theory includes ion correlations , but the approximation is not systematically refineable , just as in the kohn - sham lda equations .",
    "lwen ( 1994 ) utilized this free energy functional in car - parrinello - type simulations ( car and parrinello , 1985 ) of charged rods with surrounding counterions .",
    "the equilibrium distribution is obtained by taking the functional derivative of the free energy with respect to the mobile - ion density and setting it to zero .",
    "it is clear that , if the correlation term is set to zero , the equilibrium density of the mobile counterions is proportional to the boltzmann factor of the sum of the external and mobile ion coulomb potentials :    @xmath21\\}. \\label{eq : cmdftrho}\\ ] ]    the potential @xmath22 is that due to the mobile ions only and @xmath23 .    since the total charge ( fixed charges on colloid particles and mobile ion charges ) at equilibrium",
    "must satisfy the poisson equation , the following nonlinear differential equation results for the equilibrium distribution of the mobile ions in the absence of correlations .",
    "the treatment is generalized here to account for the possibility of additional salt in the solution and a dielectric constant that can vary in space ( coalson and beck , 1998 ) :    @xmath24 , \\label{eq : pb}\\ ] ]    where @xmath25 is the total potential due to the fixed colloid charges and mobile ions , @xmath26 is the charge density of the fixed charges on the colloids , @xmath27 and @xmath28 are the bulk equilibrium ion densities at infinity ( determined self - consistently so as to conserve charge in the region of interest ) , and @xmath29 is a very large positive excluded - volume potential which prevents penetration of the mobile ions into the colloids .",
    "fushiki ( 1992 ) performed molecular dynamics simulations of charged colloidal dispersions at the poisson - boltzmann level ; the nonlinear poisson - boltzmann equation was solved numerically at each time step with fd techniques .",
    "an alternative elegant statistical mechanical theory for the ion gas has been formulated ( coalson and duncan , 1992 ) .",
    "it uses field theoretic techniques to convert the boltzmann factor for the ion interactions into a functional - integral representation of the partition function .",
    "the poisson - boltzmann - level theory results from a saddle - point approximation to the functional integral .",
    "the distinct advantage of this theory is that correlations can be systematically included by computing the corrections to the mean - field approximation via loop expansions .",
    "however , in practice the corrections are computationally costly for real - space grids of substantial size .",
    "this theory was used in simulations of colloids ( walsh and coalson , 1994 ) , and the deviations from mean - field theory were investigated . for realistic concentrations of monovalent background ions ,",
    "the corrections are often small in magnitude , thus justifying the poisson - boltzmann - level treatment .",
    "correlations must be considered , however , for accurate computations involving divalent ions ( guldbrand _ et al .",
    "_ , 1984 ; tomac and grslund , 1998 ; patra and yethiraj , 1999 ) .",
    "several new methods have appeared for computations involving systems with long - range interactions . in this section ,",
    "developments in linear - scaling methods for classical and quantum systems are summarized .",
    "goedecker ( 1999 ) has clearly reviewed applications in electronic structure , so the discussion of this topic will be limited .",
    "the purpose is to illustrate the context in which real - space methods can be utilized in linear - scaling solvers for electrostatics and electronic structure .",
    "three algorithms have been most widely used in classical electrostatics calculations which require consideration of long - range forces .",
    "the first is the ewald ( 1921 ) summation , which partitions the coulomb interactions into a short - range sum handled in real space and a long - range contribution summed in reciprocal space .",
    "both sums are convergent . the partitioning is effected by adding and subtracting localized gaussian functions centered about the discrete charges ( pollock and glosli , 1996 ) . in the original ewald method , the coulomb interaction of the gaussians is obtained analytically :    @xmath30    once the charge structure factor ,    @xmath31    is computed . in eq .",
    "( [ eq : egauss ] ) , @xmath32 is the cell volume and @xmath33 is the gaussian width .",
    "this method scales as @xmath34 ( where @xmath1 is the number of particles ) so long as an optimal exponential factor is used in the gaussians .",
    "discussion of the optimization equation which yields the @xmath34 scaling is given in pollock ( 1999 ) .",
    "the ewald technique has been used extensively in simulations of charged systems ( allen and tildesley , 1987 ) .",
    "an efficient alternative procedure for madelung sums in electronic structure calculations on crystals was proposed by harris and monkhorst ( 1970 ) .",
    "the scaling of the ewald method has been reduced by an alternative treatment for the interaction energy of the gaussians . instead of solving the problem analytically , 1 )",
    "the charge density is assigned to a mesh , 2 ) the poisson equation is solved using fft methods , 3 ) the potential is differentiated , and lastly 4 ) the forces are interpolated to the particles .",
    "these methods are termed particle - particle particle - mesh ( hockney and eastwood , 1988 ) or particle - mesh ewald ( darden _ et al . _ , 1993 ) [ or an improved version called smooth particle - mesh ewald ( essmann _ et al . _ , 1995 ) ] . since",
    "the potential is generated numerically via fft , the methods scale as @xmath35 ( or @xmath36 if an optimal @xmath33 is used ; see pollock , 1999 ) .",
    "the above - mentioned methods differ in how the four steps in the force generation are performed , but all three center on the use of fft algorithms for their efficiency .",
    "comparative studies have suggested that the original particle - particle particle - mesh method is more accurate than the particle - mesh ewald versions ; deserno and holm ( 1998 ) recommend its use with modifications obtained from particle - mesh ewald .",
    "see also sagui and darden ( 1999 ) , where it is shown that similar accuracies can be obtained with particle - mesh ewald as compared to the particle - particle particle - mesh method .",
    "the second algorithmic approach utilizes the fast multipole method ( fmm ) ( greengard , 1994 ) or related hierarchical techniques . in these methods ,",
    "the near - field contributions are treated explicitly , while the far field is handled by clustering charges into spatial cells and representing the field with a multipole expansion .",
    "the methods are claimed to scale linearly with system size , but recent work contends the scaling is slightly higher ( prez - jord and yang , 1998 ) .",
    "fast multipole techniques and the quantum chemical tree code ( qctc ) of challacombe _ et al . _",
    "( 1996 ) , have been widely applied in gaussian - based electronic structure calculations . since",
    "the classical coulomb part of the problem is a significant or even dominant part of the overall computational effort , near linear scaling is required for an overall linear - scaling solver ( strain _ et al .",
    "_ , 1996 ; white _ et al . _ , 1996 ) .",
    "prez - jord and yang ( 1997 ) have developed an alternative efficient recursive bisection method for obtaining the coulomb energy from electron densities .",
    "the fmm has also been utilized extensively in particle simulations . in comparative studies of periodic systems ,",
    "pollock and glosli ( 1996 ) and challacombe _ et al . _",
    "( 1997 ) , have shown that , for the case of discrete particles , the particle - mesh related techniques are more efficient than the fast multipole method over a wide range of system sizes ( up to 10@xmath37 particles ) . however , for the case of continuous overlapping distributions , it is difficult to develop systematic ways in the particle - mesh approach to handle the charge penetration in large - scale gaussian calculations ( challacombe , 1999a ) .",
    "recently , cheng _ et al . _",
    "( 1999 ) have developed a more efficient and adaptive version of the fast multipole method which will make the technique competitive with the particle - mesh method . also , greengard and lee ( 1996 ) presented a method combining a local spectral approximation and the fast multipole method for the poisson equation .",
    "a third set of linear - scaling algorithms for classical electrostatics employs real - space methods , which will be discussed in - depth in subsequent sections .",
    "the problem is represented with fd equations , fe methods , or wavelets , and solved iteratively on the mesh .",
    "since all operations are near - local in space , the application of the laplacian to the potential is strictly linear scaling .",
    "however , the iterative process on the fine mesh typically suffers from slowing down in the solution process , so efficient preconditioning techniques must be employed to obtain the linear scaling .",
    "the multigrid method ( brandt , 1977 , 1982 , 1984 , 1999 ; hackbusch , 1985 ) is a particularly efficient method for solving the discrete equations .",
    "linear - scaling real - space methods have been developed for solution of the poisson problem in dft ( white _ et al .",
    "_ , 1989 ; merrick _ et al .",
    "_ , 1995 , 1996 ; gygi and galli , 1995 ; briggs _ et al .",
    "_ , 1995 ; modine _ et al .",
    "_ , 1997 ; goedecker and ivanov , 1998a ) .",
    "these studies have illustrated the accuracies and efficiencies of the real - space approach .",
    "one possible application of multigrid techniques which has not received attention is in solving for the coulomb energy of the gaussian charges in the particle - mesh algorithms .",
    "since the multigrid techniques are highly efficient , scale linearly , and allow for variable resolution , they may provide a helpful counterpart to the fft - based methods currently used .",
    "an advantageous feature of the multigrid solution during a charged - particle simulation is that , once the potential is generated for a given configuration , it can be saved for the next solution process for the updated positions which have changed only slightly .",
    "thus the required number of iterations is likely to be low .",
    "tsuchida and tsukada ( 1998 ) utilized similar ideas in their fe method for electronic structure , where they employed mg acceleration for rapid solution of the poisson equation and discussed the relation of their method to the particle - mesh approach .",
    "electronic structure calculations involve computational complexities which go well beyond the necessity for efficient solution of the poisson equation . in order to obtain linear scaling ,",
    "physical localization properties must be exploited either for the range of the density matrix or the orbitals .",
    "goedecker ( 1999 ) categorized the various linear - scaling electronic structure methods as follows : fermi operator expansion ( foe ) , fermi operator projection ( fop ) , divide and conquer ( dc ) , density matrix minimization ( dmm ) , orbital minimization ( om ) , and optimal - basis density matrix minimization ( obdmm ) .",
    "he further classified the algorithms into those which employ small basis sets ( lcao - type approaches ) and ones which utilize large basis sets ( fd or fe ) .",
    "for discussion of the use of basis set terminology in reference to the fd method .",
    "] clearly the methods most relevant to the present discussion are those which can be implemented with large basis sets ( fop , om , and obdmm ) .",
    "the two approaches most directly related to the fd and fe mesh techniques considered here are the om and obdmm methods , so we review their characteristics .",
    "the om method obtains the localized wannier functions by minimization of the functional :    @xmath38    the minimization is unconstrained in that no orthogonalization is required ; the orthonormality condition is automatically satisfied at convergence . in eq .",
    "( [ eq : omfunc ] ) , @xmath32 is the ` grand potential ' , the @xmath39 are the expansion coefficients for the wannier function @xmath40 with basis function @xmath41 , and the @xmath42 are the matrix elements of @xmath43 , where @xmath44 is the chemical potential controlling the number of electrons and @xmath45 is the identity matrix .",
    "the functional can be derived by making a taylor expansion of the inverse of the overlap matrix occurring in the total energy expression ( mauri _ et al .",
    "_ , 1993 ) .",
    "( 1995 ) presented an alternative derivation and related the om functionals to the dmm approach . assuming no localization restriction on the orbitals",
    ", it can be shown that the functional @xmath32 gives the correct ground state at its minimum .",
    "however , some problems arise when localization constraints are imposed : 1 ) the functional can have multiple minima , 2 ) the number of required iterations to reach the ground state can be quite large , 3 ) there may be runaway solutions depending on the initial guess , and 4 ) the total charge is not conserved for all stages of the minimization ( although charge is accurately conserved close to the minimum ) .    the original om methods utilized underlying plane - wave ( mauri _ et al . _ , 1993 ; mauri and galli , 1994 ) and tight - binding or lcao - type bases ( kim , _ et al .",
    "_ , 1995 ; ordejn _ et al . _ , 1995 ; snchez - portal _ et al . _ , 1997 ) for the representation of the localized orbitals . in the work of snchez - portal _",
    "( 1997 ) on very large systems , a fully numerical lcao basis developed by sankey and niklewski ( 1989 ) was implemented for the orbitals , and the hartree problem was solved via fft techniques on a real - space grid .",
    "( 1997 ) developed a related hybrid gaussian and plane - wave algorithm which uses gaussians in place of the numerical atomic basis .",
    "also , haynes and payne ( 1997 ) formulated a new localized spherical - wave basis which has features in common with plane waves in that a single parameter controls the convergence .",
    "real - space formulations have also applied om ideas ; since the real - space approach is inherently local , it provides a natural representation for the linear - scaling algorithms .",
    "tsuchida and tsukada ( 1998 ) incorporated unconstrained minimization into their fe electronic structure method .",
    "hoshi and fujiwara ( 1997 ) also employed unconstrained minimization in their fd self - consistent electronic structure solver .",
    "finally , bernholc _ et al . _",
    "( 1997 ) utilized the original localized - orbital functional of galli and parrinello ( 1992 ) in their fd multigrid method to obtain linear scaling .",
    "they are also investigating other order @xmath1 functionals",
    ". these real - space algorithms will be the subject of extensive discussion in section [ sec : ks ] .",
    "the obdmm method is an efficient combination of density matrix and orbital - based methodologies .",
    "the optimization process to locate the ground state is divided into two minimization steps . in the inner loop , the usual dmm procedure is followed to obtain the density matrix for a fixed contracted basis .",
    "the density matrix @xmath46 is represented in terms of contracted basis functions @xmath47 and a matrix @xmath48 which is a purified form from the dmm method :    @xmath49    and    @xmath50    where @xmath51 is the contracted basis density matrix and @xmath52 the overlap matrix .",
    "the matrix @xmath48 is ` purified ' in that if the eigenvalues of @xmath51 are close to zero or one , the eigenvalues of @xmath48 will be even closer to those values .",
    "the outer loop searches for the optimal basis with fixed @xmath51 . the obdmm method was developed independently by hierse and stechel ( 1994 ) and hernndez and gillan ( 1995 ) .",
    "the two approaches differ in that the algorithm of hernndez and gillan allows for a number of basis functions larger than the number of electrons . also , hierse and stechel ( 1994 ) used tight - binding and gaussian bases , while hernndez and gillan ( 1994 ) employed a fd difference representation in their original work .",
    "later , hernndez _ et al . _",
    "( 1997 ) developed a blip - function basis ( a local basis of b - splines , see strang and fix , 1973 ) , very closely related to fe methods .    in the quantum chemistry literature ,",
    "efforts have focused on gaussian basis - function algorithms .",
    "as discussed above , the coulomb problem is typically solved with the fmm or other hierarchical techniques ( white _ et al .",
    "_ , 1996 ; strain _ et al .",
    "_ , 1996 ; challacombe _ et al .",
    "_ , 1996 ; challacombe and schwegler , 1997 ) .",
    "additional algorithmic advances include linear scaling for the exchange - correlation calculation in dft ( stratmann _ et al .",
    "_ , 1996 ) , for the exact exchange matrix in hartree - fock theory ( schwegler and challacombe , 1996 ; schwegler _ et al .",
    "_ , 1997 ) , and for the diagonalization operation ( millam and scuseria , 1997 ; challacombe , 1999b ) .",
    "alternative linear - scaling algorithms include the early green s function based fd method of baroni and giannozzi ( 1992 ) and the finite - temperature real - space method of alavi _ et al . _",
    "( 1994 ) .",
    "it is evident from the above discussion that real - space methods , in particular fd and fe approaches , are well suited for linear - scaling algorithms .",
    "in classical electrostatics calculations , the multigrid method provides an efficient and linear - scaling technique for solution of poisson problems given a charge distribution on a mesh ( finite or periodic systems ) . in electronic structure ,",
    "fd and fe representations have been extensively employed in the om and obdmm localized - orbital linear - scaling contexts .",
    "the early development of fd and fe methods for solving partial differential equations stemmed from engineering problems involving complex geometries , where analytical approaches were not possible ( strang and fix , 1973 ) .",
    "example applications include structural mechanics and fluid dynamics in complicated geometries .",
    "however , even in the early days of quantum mechanics , attention was paid to fd numerical solutions of the schrdinger equation ( kimball and shortley , 1934 ; pauling and wilson , 1935 ) .",
    "also , fully converged numerical solutions of self - consistent electronic structure calculations have played an important role in atomic physics ( see mahan and subbaswamy , 1990 , for a discussion of the methodology for spherically symmetric systems ) and more recently in molecular physics ( laaksonen _ et al .",
    "_ , 1985 ; becke , 1989 ) .",
    "real - space calculations are performed on meshes ; these meshes can be as simple as cartesian grids or can be constructed to conform to the more demanding geometries arising in many applications .",
    "finite - difference representations are most commonly constructed on regular cartesian grids .",
    "they result from a taylor series expansion of the desired function about the grid points .",
    "the advantages of fd methods lie in the simplicity of the representation and resulting ease of implementation in efficient solvers .",
    "disadvantages are that the theory is not variational ( in the sense of providing and upper bound , see below ) , and it is difficult to construct meshes flexible enough to conform with the physical geometry of many problems .",
    "finite - element methods , on the other hand , have the advantages of significantly greater flexibility in the construction of the mesh and an underlying variational formulation .",
    "the cost of the flexibility is an increase in complexity and more difficulty in the implementation of multiscale or related solution methods . in this section ,",
    "we review the technical aspects of real - space fd and fe representations of differential equations by examination of poisson problems .",
    "the second - order fd representation of elliptic equations is very simple but serves to illustrate several key features .",
    "consider the poisson equation in one dimension ( the @xmath53 is left here since we will be considering three - dimensional problems ) :    @xmath54    where @xmath55 is the potential and @xmath56 the charge density . expand the potential in the positive and negative directions about the grid point @xmath57 :    @xmath58    the grid spacing is @xmath5 , here assumed uniform . if these two equations are added and the sum is solved for @xmath59 , the following approximation results :    @xmath60   - \\frac{1}{12}\\phi^{(iv)}(x_i)h^2 + o(h^2)\\ ] ]    the first contribution to the truncation error is second order in @xmath5 with a prefactor involving the fourth derivative of the potential .",
    "depending on the nature of the function @xmath55 , the errors can be of either sign .",
    "when @xmath55 is used to compute a physical quantity such as the total electrostatic energy , the net errors in the energy can be either positive or negative . in this sense ,",
    "the fd approximation is _ not variational_. as we will see below , the solution can be obtained by minimizing an energy ( or action ) functional , which is a variational process , but the solution does not necessarily satisfy the variational theorem obtained in a basis - set method .",
    "_ so the fd approach is not a basis - set method . _    in matrix form ,",
    "the one - dimensional discrete poisson equation is    @xmath61 \\left [ \\begin{array}{r } \\phi(x_1 ) \\\\",
    "\\cdot \\\\ \\cdot \\\\ \\cdot \\\\",
    "\\phi(x_n ) \\end{array } \\right ] = -4\\pi\\left [ \\begin{array}{r } \\rho(x_1 ) \\\\",
    "\\cdot\\\\ \\cdot\\\\ \\cdot \\\\",
    "\\rho(x_n ) \\end{array } \\right ] .",
    "\\label{eq : matrix}\\ ] ]    this equation can be expressed symbolically as    @xmath62    where @xmath63 is the discrete laplacian , @xmath64 is the exact solution on the grid , and @xmath65 is @xmath66 .",
    "the operator @xmath67 is positive definite .",
    "an observation from the matrix form eq.([eq : matrix ] ) is that the laplacian is highly sparse and banded in the fd representation ; its application to the potential is thus a linear - scaling step . in one dimension",
    "the matrix is tridiagonal , while in two or three dimensions it is no longer tridiagonal but is still extremely sparse with nonzero values only near the diagonal .",
    "this differs from the wavelet representation , which is sparse but includes several bands in the matrix ( goedecker and ivanov , 1998b , fig .",
    "7 ; arias , 1999 , fig .",
    "in addition to the truncation error ,    @xmath68    estimates can be made of the function error itself ( see strang and fix , 1973 , p. 19 ) :    @xmath69    where @xmath70 is the exact solution to the continuous differential equation and @xmath71 is proportional to the second derivative of the potential .",
    "therefore , one can test the order of a given solver for a case with a known solution by computing errors over the domain and taking ratios for variable grid spacing @xmath5 .",
    "for example , the ratio of the errors on a grid with spacing @xmath72 to those on @xmath5 for overlapping points should be close to 4.0 in a second - order calculation .",
    "the two- and three - dimensional representations are obtained by summing the one - dimensional case along the two or three orthogonal coordinate axes ( this holds for higher - order forms as well ) . since the laplacian is the dot product of two vector operators , off - diagonal terms are not necessary .",
    "the second - order two - dimensional laplacian consists of five terms with a weight of -4 instead of -2 on the diagonal , and the three - dimensional case has seven terms with a weight of -6 along the diagonal .",
    "see abramowitz and stegun ( 1964 , sections 25.3.30 and 25.3.31 ) , for the two - dimensional representation of the laplacian .",
    "consider the action functional :    @xmath73 = \\frac{1}{2}\\int \\left| \\nabla\\phi \\right|^2 d^3x - 4\\pi \\int \\rho\\phi d^3x .",
    "\\label{eq : actionibp}\\ ] ]    if the first term on the rhs is integrated by parts ( assuming the function and/or its derivative go to zero at infinity or are periodic ) , one obtains    @xmath74 = -\\frac{1}{2 } \\int \\phi\\nabla^2\\phi d^3x    - 4\\pi \\int \\rho\\phi d^3x .",
    "\\label{eq : action}\\ ] ]    take the functional derivative of the action with respect to variations of the potential , and a ` force ' term results ,    @xmath75    which can be employed in a steepest - descent minimization process :    @xmath76    where @xmath77 is a fictitious time variable .",
    "then discretize the problem in space and time , leading to ( for simplicity of representation a one - dimensional form is given here )    @xmath78 , \\label{eq : update}\\ ] ]    the parameter @xmath79 is @xmath80 .",
    "the two- and three - dimensional expressions are easily obtained following the same procedure . since the action as defined in eq.([eq : action ] ) possesses only a single minimum , the iterative process eventually converges so long as a sufficiently small time step @xmath81 is chosen to satisfy the required stability criterion ( below ) .",
    "several relaxation strategies result from the steepest - descent scheme of eq .",
    "( [ eq : update ] ) .",
    "as it is written , the method is termed _ weighted - jacobi _ iteration .",
    "if the previously updated value @xmath82 is used in place of @xmath83 on the right hand side , the relaxation steps are called _ successive over - relaxation _ or sor . if the parameter in sor is taken as @xmath84 , the result is _ gauss - seidel _ iteration .",
    "gauss - seidel and sor do not guarantee reduction in the action at each step since they use the previously updated value . generally , gauss - seidel iteration is the best method for the smoothing steps in multigrid solvers ( brandt , 1984 ) .",
    "if one cycles sequentially through the lattice points , the ordering is termed _",
    "lexicographic_. higher efficiencies ( and vectorization ) can be obtained with _ red - black _ ordering schemes in which the grid points are partitioned into two interlinked sets and the red points are first updated , followed by the black ( brandt , 1984 ; press _ et al .",
    "_ , 1992 ) .",
    "similar techniques can be used for high orders with multicolor schemes .",
    "conjugate - gradient methods ( press _ et al .",
    "_ , 1992 ) significantly outperform the above relaxation methods when used on a single grid level .",
    "however , in a multigrid solver the main function of relaxation is only to smooth the high - frequency components of the errors on each level ( see section [ subsec : efmg ] ) , and simple relaxation procedures ( especially gauss - seidel ) do very well for less cost .",
    "an important issue in iterative relaxation steps relates to the eigenvalues of the update matrix defined by eq .",
    "[ eq : update ] ( briggs , 1987 ) .",
    "solution of the laplace equation using weighted - jacobi iteration illustrates the basic problem .",
    "for that particular case , the eigenvalues of the update matrix are    @xmath85    where @xmath79 is the relaxation parameter defined above , @xmath86 is the number of grid points in the domain , and @xmath6 labels the mode in the fourier expansion of the function .",
    "generally , the fourier component of the error with wavevector @xmath6 is reduced in magnitude by a factor proportional to @xmath87 in @xmath77 iterations .",
    "first , it is easy to see that if too large an @xmath79 value ( that is ` time ' step for fixed @xmath5 ) is taken , the magnitude of some modes will exceed one , leading to instability .",
    "this shows up very quickly in a numerical solver !",
    "second , for the longest - wavelength modes , the eigenvalues are of the form :    @xmath88    as more grid points are used to obtain increased accuracy on a fixed domain , the eigenvalues of the longest - wavelength modes approach one .",
    "therefore , these modes of the error are very slowly reduced .",
    "this fact leads to the phenomenon of _ critical slowing down _ in the iterative process ( fig .",
    "[ fig : csd ] ) , which motivated the development of multigrid techniques .",
    "multigrid methods utilize information from multiple length scales to overcome the critical slowing down ( section [ sec : mg ] ) .",
    "mathematical arguments lead to the conclusion that the fd scheme discussed above is convergent in the sense that @xmath89 as @xmath90 ( strang and fix , 1973 ; vichnevetsky , 1981 ) .",
    "therefore , one only needs to proceed to smaller grid spacings to obtain results with a desired accuracy .",
    "this neglects the practical issues of computer time and memory , however , and it has become apparent that orders higher than second are most often necessary to obtain sufficient accuracy in electronic structure calculations on reasonable - sized meshes ( chelikowsky , troullier , and saad , 1994 ) .",
    "the higher - order difference formulas are well known ( hamming , 1962 ; vichnevetsky , 1981 ) , and can easily be generated using computer algebra programs ( see appendix a ) .",
    "why does it pay to use high - order approximations ?",
    "consider the three - dimensional poisson equation with a singular - source charge density :    @xmath91    the dirac delta function is approximated by a unit charge on a single grid point .",
    "let us solve the fd version of eq .",
    "( [ eq : pesingular ] ) on a 65@xmath92 domain using 2nd- and 4th - order laplacians and compare the potential eight grid points away from the origin . and [ sec : ks ] . ] in order to obtain the same numerical accuracy with a 2nd - order laplacian , a grid spacing with one third that for the 4th - order case is required .",
    "this implies a 27-fold increase in storage and roughly a 14-fold increase in computer time , since the application of the laplacian contains 7(13 ) terms for the 2nd(4th)-order calculations .    as a second example , we solve for five states of the hydrogen - atom eigenvalue problem using the fixed potential generated in the solution of eq .",
    "( [ eq : pesingular ] ) .",
    "the grid parameters are the same as those used in the multigrid eigenvalue computations of section [ subsubsec : evalapps ] .",
    "the variation of the eigenvalues , the first orbital moments , and the virial ratios with approximation order are presented in figs .  [ fig : evalord ] , [ fig : raveord ] , and [ fig : virord ] .",
    "a possible accuracy target is the thermal energy at room temperature ( @xmath93 au ) ; this accuracy is achieved at 12th order .",
    "clearly the results at 2nd order are not physically reasonable , but accurate results can be obtained with the higher orders .",
    "( 1995 ) and chelikowsky , trouller , wu , and saad ( 1994 ) have presented analyses of the impact of order on accuracy in dft electrostatics and kohn - sham calculations ; in the kohn - sham calculations , 8th or 12th orders were required for adequate convergence .",
    "there exist alternative high - order discretizations such as the mehrstellen form used in the work of briggs _ et al . _",
    "this discretization is 4th order and leads to terms which are off - diagonal in both the kinetic and potential operators .",
    "the advantage of the mehrstellen approach is that both terms only require near - neighbor points on the lattice , while the high - order forms above include information from further points ( which increases the communication overhead somewhat in parallel implementations ) .",
    "however , the 4th - order mehrstellen operator involves 33 multiplies to apply the hamiltonian to the wavefunction , while the standard 4th - order discretization requires only 14 ( a 12th - order standard form uses 38 multiplies ) .",
    "also , the mehrstellen representation has only been applied to the 4th - order case , and for some applications higher orders may be required .",
    "the exact terms for the mehrstellen representation of the real - space hamiltonian are given in briggs _",
    "( 1996 ) .",
    "consider again the action of eq.([eq : actionibp ] ) in one dimension :    @xmath73 = \\frac{1}{2}\\int \\left ( \\frac{d\\phi}{dx } \\right)^2 dx - 4\\pi \\int \\rho\\phi dx .",
    "\\label{eq : actionibp1d}\\ ] ]",
    "this form of the action proves useful since the appearance of the first derivative as opposed to the second expands the class of functions which may be used to represent the potential .",
    "now , expand the potential in a basis :    @xmath94    where the @xmath95 are the expansion coefficients and @xmath96 the basis functions .",
    "the action is then    @xmath97    the variational calculation is performed by minimizing the action with respect to variations in the expansion coefficients ( assuming the original differential operator is positive definite ) :    @xmath98 dx = 0 .",
    "\\label{eq : varbasis}\\ ] ]    the minimization equation leads to a matrix problem completely analogous to eq .",
    "( [ eq : luf ] ) . in the present case ,",
    "the grid index is replaced by the basis - function index .",
    "it is often necessary to perform the integral of the second term ( which involves the charge density ) numerically .    a more general origin of the fe method",
    "is termed the galerkin approach which takes as its starting point the  weak \" formulation of the problem .",
    "this method allows one to handle problems which can not be cast in the minimization format described above by requiring only an extremum of the action functional and not a minimum .",
    "also , it does not require symmetric operators .",
    "take the action functional of eq .",
    "( [ eq : actionibp1d ] ) and perturb it by the addition of a small term @xmath99 . and @xmath100 exist in a subspace of a hilbert space which becomes a finite - dimensional subspace for any fe basis - set numerical computation . ]",
    "the action becomes    @xmath101 = s[\\phi ] + \\frac{1}{2}\\epsilon^2\\int   \\left ( \\frac{dv}{dx } \\right)^2 dx +   \\epsilon\\int\\left(\\frac{d\\phi}{dx}\\right ) \\left(\\frac{dv}{dx}\\right ) dx - 4\\pi \\epsilon\\int \\rho v dx .",
    "\\label{eq : actionpert}\\ ] ]    by taking the derivative with respect to @xmath17 , making @xmath17 zero , and setting what remains to zero ,",
    "the stationary point is obtained .",
    "this variational form results in the following integral equation :    @xmath102    this equation is valid for any test function @xmath100 ; solution requires finding the function @xmath103 for which the equation holds for all @xmath100 .",
    "alternatively , eq .  [ eq : vbvp ] can be derived by simply left multiplying the differential equation by the test function @xmath100 and integrating by parts . when the functions @xmath103 and @xmath100 are represented in the @xmath96 basis , a matrix equation the same as eq .",
    "( [ eq : varbasis ] ) is obtained .",
    "this basis - set manifestation of the weak formulation is termed the galerkin method . if the test function space for @xmath100 is taken to include all dirac delta functions , and the problem is cast in the strong form @xmath104 ( where @xmath51 is the differential operator , in this case the laplacian ) , the _ collocation _ ( or pseudospectral ) approximation results when the problem is discretized ( orszag , 1972 ; vichnevetsky , 1981 ; ringnalda _ et al . _ , 1990 ) .",
    "excellent reviews of the theory and application of finite elements are given in strang and fix ( 1973 ) , vichnevetsky ( 1981 ) , brenner and scott ( 1994 ) , and reddy ( 1998 ) .",
    "any linearly independent basis may be used to expand the potential .",
    "one choice would be to expand in trigonometric functions which span the whole domain .",
    "then fourier transform techniques could be used to solve the equations . in the fe method ,",
    "the basis functions are rather taken as piecewise polynomials which are nonzero only in a local region of space ( that is , have small support ) .",
    "the simplest possible basis consists of piecewise - linear functions whose values are one at the grid point about which they are centered and zero everywhere beyond the nearest - neighbor grid points .",
    "then the coefficients @xmath95 correspond to the actual function values on the mesh . with this basis and a basis - set representation of the charge density @xmath56 , the resulting matrix representation of the one - dimensional poisson equation is identical to eq .",
    "( [ eq : matrix ] ) , except the right hand side is replaced by terms which are local averages of the charge density over three points .",
    "the local average is idential to simpson s rule integration .",
    "therefore , for uniform meshes , there is a close correspondence between fd and fe representations .",
    "relaxation methods similar to those described above can be used to solve the fe equations .",
    "besides the variational foundation of the fe method , the key advantage over fd approaches is in the flexibility available to construct the mesh to conform to the physical geometry .",
    "this issue becomes particularly relevant for two- and three - dimensional problems .",
    "there is of course an immense literature on development of accurate and efficient basis sets for fe calculations in a wide variety of engineering and physical applications , and that topic can not be covered properly here .",
    "some representative bases are mentioned from recent three - dimensional electronic structure calculations .",
    "white _ et al . _",
    "( 1989 ) employed a cubic - polynomial basis and constructed an orthogonal basis from the nonorthogonal set .",
    "( 1994 ) used a tetrahedral discretization with orders @xmath105 .",
    "( 1999 ) utilized piecewise cubic functions ( termed `` serendipity '' elements ) .",
    "( 1994 ) employed a lobatto - gauss basis set with orders ranging from five to seven .",
    "( 1997 ) developed a b - spline basis which is closely related to traditional fe bases . tsuchida and tsukada ( 1998 ) used piecewise third - order polynomials in their self - consistent electronic structure calculations .    in relating the fd and fe methods ,",
    "two points are worth noting .",
    "first , the fe bases are typically nonorthogonal and this issue must be dealt with in the formulation .",
    "second , since the basis is local , the representation is banded with the width depending on the degree of the polynomials . for the fd representation ,",
    "the high - order laplacian includes @xmath106 terms in a row of @xmath51 for three - dimensional calculations .",
    "alternatively , the fe method requires @xmath107 terms along a row of @xmath51 in the limit of high orders , although the exact number of terms depends on the particular elements ( pask , 1999 ) .",
    "this issue of scaling of the bandwidth with order may become a significant one in development of efficient iterative solvers of the equations . due to the relative merits of the two representations",
    ", there is no clear ` answer ' as to which one is preferable ; the key feature for this review is that both are near - local leading to structured and sparse matrix representations of the differential equations .",
    "the wavelet basis method is closer in form to the fe representation but , as mentioned above , leads to more complicated matrix structures than either the fd or fe cases ( goedecker and ivanov , 1998b ; arias , 1999 ) .",
    "the previous section discussed the basics of real - space formulations .",
    "the representations are near - local in space , and this locality manifests itself in the stalling process of iterative solvers induced by eq .",
    "( [ eq : longmode ] ) .",
    "the finer the resolution of the mesh , the longer it takes to remove the long - wavelength modes of the error .",
    "the multigrid technique was developed in order to overcome this inherent difficulty in real - space methods .",
    "multigrid methods provide the optimal solvers for problems represented in real space .",
    "the asymptotic convergence of an iterative solver on a given scale is controlled by eq .",
    "( [ eq : longmode ] ) .",
    "however , for shorter - wavelength modes it is easy to show that the _ convergence factor _    @xmath108    where @xmath109 is the norm of the difference vector between the exact grid solution @xmath64 and the current approximation @xmath110 , and @xmath111 is the vector for the next step of iteration , is of order 0.5 for gauss - seidel iteration on the poisson equation ( brandt , 1984 ) .",
    "those components of the error are reduced by an order of magnitude in only three relaxation sweeps .",
    "thus , relaxation steps on a given grid level are referred to as _ smoothing _ steps ; the high - frequency components of the error are efficiently removed while the long - wavelength modes remain . following the fine - scale smoothing ,",
    "the key step of multigrid is then to pass the problem to a coarser level , say @xmath112 ( with appropriate rules for the construction of the problem on the coarse grid ) ; smoothing steps on the coarse level efficiently remove errors of twice the wavelength .",
    "finally , the fine - grid function is corrected with the error interpolated from the coarse level , and further iterations on the fine level remove remaining high - frequency components induced by the coarse - grid correction .",
    "when this process is recursively followed through several levels , the stalling behavior can be completely removed and the solution is obtained in @xmath113 operations , where @xmath1 is the number of unknowns . typically , the problem can be solved to within the truncation errors in roughly ten total smoothing steps on the finest level .",
    "the previous discussion rests on a local - mode analysis of the errors ( brandt , 1977 , 1984 ) ; additional mathematical arguments confirm the excellent convergence rates and linear scaling of multigrid solvers ( hackbusch , 1985 ) .      for linear problems , the algebraic eq .",
    "( [ eq : luf ] ) can be rewritten as    @xmath114    where @xmath5 is the finest grid spacing , @xmath115 ( grid error ) , and @xmath116 ( residual equation ) . during the multigrid correction cycles ,",
    "the coarse - grid iterations only need to be performed on the error term @xmath117 which is subsequently interpolated to the fine grid to provide the correction .",
    "however , this rearrangement is not possible for nonlinear problems .",
    "brandt ( 1977 , 1984 ) developed the full approximation scheme ( fas ) approach for handling such problems .",
    "besides providing solutions to nonlinear differential equations like the poisson - boltzmann equation , the fas strategy is well suited to handle eigenvalue problems and mesh - refinement approaches .",
    "the fas form of multigrid is thus presented here due to its generality . in the case of linear problems ,",
    "the fas is equivalent to the error - iteration version mentioned above .",
    "consider a poisson problem discretized on a cartesian lattice with a fd representation on a fine grid with spacing @xmath5 ( eq .  [ eq : luf ] ) .",
    "now construct a sequence of coarser grids each with grid spacing twice the previous finer value . for",
    "a 4-level problem in three dimensions , the sequence of grids will consist of @xmath118 , @xmath119 , @xmath120 , and @xmath121 points including the boundaries .",
    "if @xmath122 , the coarser grid spacings are 2 , 4 , and 8 .",
    "the boundary values of the potential on each level are fixed based on the physics of the problem .",
    "for example , if there are a set of discrete charges inside the lattice , direct summation of the @xmath123 potential or a multipole expansion can be performed .",
    "alternatively it is easy to apply periodic boundary conditions by wrapping the potential . on the coarsest grid ,",
    "only the one central point is iterated during relaxation steps there .",
    "assume there are @xmath124 levels for the general case ; each level is labeled by the index @xmath6 which runs from 1 ( coarsest level ) to @xmath124 ( finest level ) .",
    "the operator @xmath125 is defined by the fd discretization on level @xmath6 with grid spacing @xmath126 .",
    "the goal is to obtain the solution @xmath127 of eq .",
    "[ eq : luf ] on the finest level .",
    "the equations to be iterated on level @xmath6 take the form :    @xmath128    where one starts from a trial @xmath129 and improves it .",
    "the initial @xmath129 on coarse levels is obtained by applying the _ full - weighting restriction _",
    "operator @xmath130 to @xmath131 :    @xmath132    the restriction operator takes a local average of the finer - grid function .",
    "the average is over all 27 fine grid points ( in three dimensions ) including the central point which coincides with the coarse grid and the 26 neighboring points .",
    "the weights are : 1/8 for the central point , 1/16 for the 6 faces , 1/32 for the 12 edges , and 1/64 for the 8 corners .",
    "the restriction operator is a rectangular matrix of size @xmath133 ( columns ) by @xmath134 ( rows ) where @xmath134 is the number of grid points on level @xmath6 . of course",
    ", only the weights need be stored .",
    "the coarse - grid charge density @xmath135 is obtained similary from @xmath136 .",
    "the _ defect correction _",
    "@xmath137 is defined as    @xmath138    the defect correction is zero on the finest level @xmath124 .",
    "therefore the third term on the rhs is zero for the grid next - coarser to the fine scale .",
    "it is easy to show that if one had the exact grid solution @xmath127 on the finest level , the coarse - grid equations ( eq .",
    "[ eq : lufcoarse ] ) would also be satisfied on all levels , illustrating zero correction at convergence .",
    "another point of view is that the defect correction modifies the coarse - grid equations to ` optimally mimic ' the finer scales .",
    "the defect correction provides an approximate measure of the discretization errors and can be used in the construction of adaptive solvers ( brandt , 1984 ) : higher resolution is placed in regions where the defect correction magnitude exceeds a prescribed value .",
    "the solver begins with initial iterations on the finest level ( typically two or three relaxation steps are adequate on each level ) .",
    "the problem is restricted to the next coarser level as outlined above , and relaxation steps are performed there .",
    "this process is repeated until the coarsest grid is reached .",
    "the solver then returns to the fine level by providing corrections to each next - finer level and applying relaxation steps there .",
    "the correction equation for grid @xmath139 is    @xmath140    the additional operator @xmath141 is the interpolation operator .",
    "most often it is acceptable to use linear interpolation , and the easiest way to apply the operator in three dimensions is to interpolate along the lines in each plane and finally to interpolate along lines between the planes .",
    "that is , the operator can be applied by a sequence of one - dimensional interpolations . for linear interpolation ,",
    "the coarse - grid points which coincide with the fine grid are placed directly into the fine - grid function , and the intermediate points get a weight of 1/2 from each neighboring coarse - grid point . in the same way , high - order interpolation operators can be applied as a sequence of one - dimensional operations ; see beck ( 1999b ) for a listing of the high - order interpolation weights .",
    "the high - order weights are used in interpolating to new fine levels in full multigrid eigenvalue solvers ( brandt _ et al .",
    "_ , 1993 ) and in high - order local mesh - refinement multigrid methods ( beck , 1999b ) .",
    "the interpolation operator is a rectangular matrix of size @xmath134 ( columns ) by @xmath133 rows . only the weights need be stored , just as for the restriction operator .",
    "all of the operators defined above can be initialized once and used repeatedly throughout the algorithm . the multigrid cycle defined by the above discussion",
    "is termed a v - cycle which is shown schematically in fig .",
    "[ fig : vcycle ] .",
    "alternative cycling methods have been employed as well , such as w - cycles .",
    "reductions in the norm of the residual in one v - cycle are generally an order of magnitude .",
    "the same set of operations is employed in a high - order solver ; the second - order laplacian is simply replaced by the high - order version .",
    "the form of the multigrid solver is quite flexible ; for example , a lower - order representation could be used on coarse levels during the correction cycles . in our own work , we have observed similar optimal convergence rates for high - order solvers as for second - order ones , so there is no degradation in efficiency with order .",
    "applications in electrostatics and extensions for eigenvalue problems are discussed in sections [ sec : es ] and [ sec : ks ] .      the grid solution can be efficiently obtained with one or at most a few v - cycles described above .",
    "the process obeys linear scaling since the solution is obtained with a fixed number of multigrid cycles and each operation on the grid scales linearly with the number of grid points . in three dimensions ,",
    "the total grid overhead is @xmath142 , where    @xmath143    and @xmath124 is the number of levels . in the limit of many levels , @xmath144 thus approaches @xmath145 .",
    "another development in the multigrid approach , full multigrid ( fmg ) , can even further accelerate the solution process beyond the v - cycle algorithm .",
    "the idea of fmg is to begin iterations on the coarsest level .",
    "the initial approximation there is interpolated to the next - finer level , iterated , and the new fine - grid approximation is corrected in a v - cycle on that level .",
    "this process is repeated until the finest scale is reached .",
    "the fmg solver for a poisson problem is illustrated in fig .",
    "[ fig : fmg ] .",
    "the advantage of this approach is that a good initial ( or preconditioned ) approximation to the fine - scale function is obtained on the left side of the final v - cycle . with this strategy",
    ", the solution to poisson problems can be obtained with a single passage through the fmg solver .",
    "( self - consistent problems may require two or more passages through the final v - cycle to obtain convergence . )",
    "note that a direct passage via iterations and interpolation from coarse to fine scales without the correction cycles does not guarantee multigrid convergence behavior since residual long - wavelength errors can remain from coarser levels .",
    "the multigrid corrections on each level serve to remove those errors , leading to optimal convergence ( brandt , 1984 ; hackbusch , 1985 ; briggs , 1987 ; wesseling , 1991 ) .",
    "multigrid solvers have been applied to many problems in fluid dynamics , structural mechanics , electrostatics , eigenvalue problems , _ etc .",
    "_ the majority of applications have utilized fd - type representations , but significant effort has gone into developing efficient solvers for fe representations as well ( brandt , 1980 ; deconinck and hirsch , 1982 ; hackbusch , 1985 ; braess and verfurth , 1990 ; brenner and scott , 1994 ) .",
    "an additional difficulty with fe multigrid methods is a proper representation of the problem on coarse levels : the more regular the fine - scale mesh , the easier is the coarsening process .",
    "the original formulation of the multigrid method was directed at solution of linear elliptic equations like the poisson equation .",
    "subsequently , methods were developed to handle nonlinear problems such as the poisson - boltzmann equation of ionic solution theory . in this section ,",
    "applications of real - space methods to electrostatics problems are discussed .",
    "first , the high efficiency of the multigrid method is demonstrated by examination of a poisson problem .",
    "then , new mesh - refinement techniques which allow for treatment of widely varying length scales are examined .",
    "poisson - boltzmann numerical solvers are discussed , with presentation of some representative applications in biophysics .",
    "we investigate a model atomic - like poisson problem which has an analytic solution :    @xmath146 .",
    "\\label{eq : arfken}\\ ] ]    the analytic solution is @xmath147 .",
    "the source singularity is modeled as a single discrete charge at the origin , and the neutralizing background charge value at the origin is set to give a net charge of zero summed over the whole domain .",
    "here we discretize the problem with a 12th - order laplacian on a @xmath148 lattice with fine grid spacing @xmath149 .",
    "the problem was solved with the fas - fmg technique with a single passage through the fmg process .",
    "linear interpolation and full - weighting restriction were employed for the grid transfers .",
    "the potential was initially set to zero over the whole domain .",
    "three gauss - seidel smoothing steps were performed on each level .",
    "several additional smoothing steps were taken for points just surrounding the singularity to accelerate the convergence there ( bai and brandt , 1987 ) .",
    "this requires virtually no additional effort since only few grid points are involved .",
    "the solution is obtained to within the truncation errors with a total of six relaxation sweeps on the finest level ( fig .",
    "[ fig : arfken ] ) .",
    "thus the entire solution process only requires roughly ten times the effort it takes to represent the differential equation on the grid .",
    "the total energy of the charge distribution is @xmath150 , where @xmath151 is the action of eq .",
    "( [ eq : action ] ) . after the single fmg cycle",
    ", the energy is converged to within 0.00029 au of the fully converged energy of 4.31800 au ( obtained with repeated v - cycles on the finest level ) .",
    "the final residual ( using the 1-norm divided by the total number of points , that is the average absolute value of the grid residuals ) is @xmath152 .",
    "after 1200 gauss - seidel iterations on the finest level alone , the residual is still of magnitude @xmath153 .",
    "( with an optimal sor parameter , the number of iterations to obtain a residual of @xmath152 can be reduced to 200 iterations . )",
    "thus there is an enormous acceleration due to the multiscale processing .",
    "similar efficiencies are observed for an fas - fmg eigenvalue solver ( section [ subsec : eval ] ) .",
    "since the number of iterations is independent of the number of fine grid points , these efficiencies are quite general and can be routinely expected from a correctly functioning multigrid solver .",
    "next we compare the operations count for generating the solution to eq .",
    "[ eq : arfken ] from scratch using multigrid and fft methods on the same @xmath148 lattice .",
    "the fft solver required @xmath154 floating point operations .",
    "the multigrid solver required @xmath155 , @xmath156 , @xmath157 , and @xmath158 operations for the 2nd , 4th , 8th , and 12th order solvers , respectively . therefore , there appears to be no clear advantage in generating the poisson potential from scratch with multigrid as opposed to fft .",
    "however , there are some advantages to using the real - space multigrid approach : 1 ) finite and periodic systems are handled with equal ease , 2 ) in a quantum simulation where particles move only slightly from a previous configuration , the potential can be saved from the previous configuration , thus reducing the number of iterations , and 3 ) one can incorporate mesh refinements to reduce the computational overhead .",
    "for example , if the same problem is solved with three nested refinement patches centered on the singularity , the number of floating point operations is reduced by nearly two orders - of - magnitude while the accuracy is sufficient since the smooth parts of the potential away from the singularity can be well represented on coarser meshes . in addition",
    ", multigrid methods can be used to solve nonlinear problems such as the poisson - boltzmann equation with similar efficiencies .    a situation that arises in",
    "many applied electrostatics computations is that of strongly varying dielectric profiles .",
    "analogous problems occur in steady - state diffusion problems with widely varying diffusion coeffcients such as those encountered in neutron diffusion .",
    "if the coefficients vary by orders of magnitude , multigrid efficiency can be lost ( alcouffe _ et al . _ , 1981 ) .",
    "the reason is that the correct continuity condition across the boundaries is @xmath159 rather than continuity of the gradients themselves .",
    "thus the gradients vary widely across the boundaries , and the standard smoothing steps do not properly reduce the errors in the function .",
    "et al . _ ( 1981 ) developed procedures based on the above continuity condition which restore the standard multigrid convergence .",
    "in biophysical applications , the dielectric constant varies from one to eighty , so such modifications prove useful for that case ( holst and saied , 1993 ) .",
    "many physical problems require consideration of a wide range of length scales .",
    "one example given in the introduction is a transition metal ion buried inside a protein .",
    "a protein interacting with a charged membrane surface is another example : particular charged groups near the interaction region must be treated accurately , but distant portions of the protein and membrane do not require high resolution to obtain reliable energetics . in electronic structure ,",
    "the electron density is very large near the nucleus but is diffuse further away .",
    "a significant strength of real - space methods lies in the ability to place adaptive refinements in regions where the desired functions vary rapidly while treating the distant zones with a coarser description .",
    "two approaches exist for such refinements in the fd method ( fe methods allow quite easily for grid adaptation ) : grid curving and local mesh refinements .",
    "while grid curving is an elegant procedure for adapting higher resolution in certain regions of space , generally the coordinate transformations are global .",
    "therefore , the higher resolution tends to spread some distance from where the refinement is necessary ( modine _ et al .",
    "_ , 1997 , figs",
    ".  1 , 4 , and 5 ) , and depending on the geometry of the problem it may be difficult or impossible to design an appropriate grid transformation .",
    "also , the transformations can be quite complex leading to additional difficulties in the solution process .",
    "finally , the grid - curving transformations alter the underlying spectral properties of the operators which can in principle lead to degradation of the multigrid efficiency in the solution process .",
    "however , this does not appear to have been a problem in the methods of gygi and galli ( 1995 ) and modine _ et al . _",
    "( 1997 ) , although the convergence behavior of their multigrid poisson solvers was not extensively discussed in those works .",
    "mesh - curving strategies for electronic structure calculations are discussed in section [ subsec : scmrt ] .",
    "an alternative procedure is to place nested uniform patches of refinement locally in space ( fig .",
    "[ fig : meshrefine ] ) .",
    "then the overall structure of the multigrid solver is the same , except fine - level iterations are performed only over the nested patches .",
    "the same forms for the laplacian , restriction , interpolation , and smoothing operators are maintained .",
    "this procedure is highly flexible since the nested refinements can be centered about any locations of space and can move as the problem evolves .",
    "the placement of the refinements can be adaptively controlled by examination of the defect correction @xmath160 ; higher resolution should be placed in regions where @xmath160 is large . if an underlying fd representation is employed , it is relatively easy to extend the method to high - order solvers since the mesh of the refinement patch is uniform .",
    "bai and brandt ( 1987 ) developed an fas multigrid mesh - refinement method for treating widely varying length - scale poisson - type problems .",
    "they first developed a @xmath161-fmg exchange - rate algorithm which minimizes the error obtained for a given amount of computational work .",
    "since the number of visits to the coarse levels ( which extend over the whole domain ) is proportional to the number of patches , direct application of the multigrid algorithm does not scale strictly linearly for many levels ; the @xmath161-fmg process restores the linear scaling for a solver including the mesh refinements .",
    "second , they showed that extra local relaxations around structural singularities restore asymptotic convergence rates which can otherwise degrade .",
    "third , they developed a conservative - differencing technique for handling source singularities .    to motivate the need for conservative differencing in the fas - fmg mesh - refinement solver ,",
    "consider eq.([eq : lufcoarse ] ) and a two - level problem with one nested patch .",
    "the defect correction on the coarse level @xmath162 is initially defined only over the interior region of the patch . however ,",
    "if one examines the sum of @xmath160 over the refinement , most of the terms in the interior cancel , but nonzero values remain near the boundaries .",
    "the remaining terms closely resemble flux operators at the boundary .",
    "the net effect is thus the introduction of additional sources in the poisson equation , which pollutes the solution severely over the whole domain . by balancing the local fluxes with additional defect correction terms on the patch boundary ,",
    "the correct source strength is restored .",
    "bai and brandt ( 1987 ) solved this problem for second - order equations and tested the method on a source - singularity problem in two dimensions .    recently",
    "the method has been extended to high - order fd approximations by beck ( 1999b , 2000 ) .",
    "the boundary defect correction terms were determined by examination of the noncancelling terms for the high - order approximations . without the conservative scheme ,",
    "significant errors are apparent over the whole domain . with the inclusion of the boundary corrections ,",
    "the sum of @xmath160 over the patch is zero to machine precision and the correct high - order behavior is obtained over the whole domain .",
    "the method was tested on a source - singularity problem in three dimensions for multiple nested patches .",
    "typical multigrid efficiencies were observed .",
    "additional corrections will be necessary at the boundaries for continuous charge distributions which cover the refinement boundaries , but these are independent of the order of the laplacian .",
    "these techniques are currently being included in high - order fd electronic structure calculations .",
    "they will significantly reduce the grid overhead in comparison to uniform - grid calculations while still maintaining the linear - scaling properties of the multigrid method .",
    "it is not possible to handle truly local refinements with the fft approach .",
    "in related work , goedecker and ivanov ( 1998a ) developed a linear - scaling multiresolution wavelet method for the poisson equation which allows for treatment of widely varying length scales .",
    "they utilized second - generation interpolating wavelets since the mapping from grid values to expansion coefficients is easy for these functions , and they have a fast wavelet transform .",
    "they solved the poisson equation for the challenging case of the all - electron uranium dimer .",
    "their solver employed 22 hierarchical levels , and the potential was obtained to six significant digits .      as discussed in section [ subsec : cmdft ] , the poisson - boltzmann equation arises from the assumption of no ion correlations .",
    "that is , it is a mean - field treatment .",
    "onsager ( 1933 ) showed that there exists an inherent asymmetry at the poisson - boltzmann level .",
    "nevertheless , calculations performed at this level of theory can yield accurate energetics for monovalent ions at moderate concentrations ( honig and nicholls , 1995 ; tomac and grslund , 1998 ; patra and yethiraj , 1999 ) .",
    "linearization of the poisson - boltzmann equation restores the symmetry , but for many cases of experimental interest the linearization assumption is too severe .",
    "solution of the poisson - boltzmann equation produces the electrostatic potential throughout space , which in turn generates the equilibrium mobile - ion charge densities and the total free energy of the ion gas ( below ) . by computing the total energies for several macroion configurations ,",
    "the potential of mean force due to electrostatic effects can be approximated ( rice , 1959 ) . in this section ,",
    "we focus on real - space numerical methods for solution of the nonlinear poisson - boltzmann equation [ eq .  ( [ eq : pb ] ) ]",
    ".    numerical solution of nonlinear partial differential equations is problematic . for the poisson - boltzmann case",
    ", the nonlinearities can be severe near fixed charges since the ratio of the potential to @xmath163 can be large .",
    "also , strong dielectric discontinuities at the boundary of a large molecular ion and the solution create technical difficulties .",
    "however , it is known that there is a single stable minimum of the action functional whose derivative yields the poisson - boltzmann equation ( coalson and duncan , 1992 ; ben - tal and coalson , 1994 ) .",
    "therefore , properly constructed iterative processes can be expected to locate that minimum .",
    "early numerical work centered on fd representations .",
    "nicholls and honig ( 1991 ) developed an efficient single - level sor method which included special techniques for memory allocation and for locating the optimal relaxation parameter .",
    "for the test cases considered , between 76 and 184 iterations were required for convergence .",
    "they also observed divergence for some highly nonlinear cases .",
    "davis and mccammon ( 1989 ) and luty _ et al . _",
    "( 1992 ) used instead a conjugate - gradients relaxation method . between 90 and 118 iterations",
    "were required to obtain convergence .",
    "they observed a factor of at least two improvement in efficiency in comparison with sor relaxation in their test calculations .    after the development of multigrid methods for solving linear poisson - type problems , efforts focused on nonlinear problems .",
    "the fas algorithm presented above is well suited for solving nonlinear problems ( brandt , 1984 ) .",
    "two modifications are needed : the driving term @xmath65 on a given level now includes the nonlinear terms , and additional terms must be included in the defect correction to ensure zero correction at convergence .",
    "the defect correction for the poisson - boltzmann problem is of the form ( a single monovalent positive ion component with uniform dielectric is considered here ) :    @xmath164 , \\label{eq : taupb}\\ ] ]    where the additional terms reflect the differing representations of the nonlinear terms on the two levels .",
    "the concentration on a given level is given by    @xmath165    the sum is over the lattice and @xmath166 is the number of positive ions in the computation domain ( coalson and duncan , 1992 ) .",
    "this procedure for obtaining the bulk ion concentrations ensures charge conservation at all steps of iteration .",
    "simple smoothing steps can be taken to relax on a given level , or newton iterations ( press _ et al .",
    "_ , 1992 ) may also be conducted on each level .",
    "variable @xmath79 parameters may be required in the relaxation steps due to the differing degrees of nonlinearities on the respective levels .",
    "related multigrid techniques for nonlinear problems are presented in stben and trottenberg ( 1982 ) and hackbusch ( 1985 ) .",
    "holst and saied ( 1995 ) developed a highly efficient method which combines linear multilevel techniques with inexact - newton iterations .",
    "they compared the convergence behavior of the inexact - newton multigrid method with sor and conjugate - gradients minimization on a single level .",
    "their multilevel technique converged robustly and more efficiently than the relaxation methods on all problems investigated including challenging source problems with dielectric discontinuities .",
    "conjugate gradients and sor exhibited similar convergence rates when compared with each other .",
    "they also examined a standard nonlinear multigrid method similar to that outlined above .",
    "for some cases , the nonlinear multigrid technique gave good convergence , but under certain conditions it diverged .",
    "the authors thus recommended caution in applying the fas multigrid method directly to the poisson - boltzmann equation .",
    "coalson and beck ( 1998 ) tested the fas approach on model problems in the lattice field theory including source singularities and found convergence for each case .",
    "oberei and allewell ( 1993 ) have also developed a convergent multigrid solver for the poisson - boltzmann equation .",
    "it is not entirely clear at the present time whether differences in observed convergence are due to the model problems investigated or to differences in the algorithms .",
    "one issue that has not been addressed to date concerns charge conservation on the various levels .",
    "the standard form of the poisson - boltzmann equation ( honig and nicholls , 1995 ) assumes fixed and equal concentrations of the mobile ions at infinity where the potential is zero .",
    "the ion charge density can then be expressed as the product of a constant term involving the debye length of the ion gas and a sinh term involving the potential .",
    "typically the boundary potential is fixed with the linearized debye - hckel value .",
    "this representation conserves charge if the system size is allowed to go to infinity due to the infinite extent of the bath .",
    "however , charge is not conserved for finite system sizes , and in a multilevel procedure differing charge states will be encountered on the various levels . in the lattice field theory of coalson and duncan ( 1992 ) , on the other hand , the charge is naturally conserved ( maintaining overall charge neutrality ) by updating the parameters @xmath27 and @xmath28 during each step of iteration ( see eqs .",
    "[ eq : pb ] and [ eq : pbconc ] ) .",
    "lack of conservation of charge on the grid levels in the standard approach may impact the convergence behavior of a multilevel solver ; this issue deserves further attention .    in a recent study ,",
    "tomac and grslund ( 1998 ) extended the poisson - boltzmann level of theory to include ion correlations in an approximate way .",
    "they solved for the kirkwood ( 1934 ) hierarchy of equations on a fd grid assuming a closure proposed by loeb ( 1951 ) .",
    "multigrid techniques were used to solve the initial poisson - boltzmann equation and to implement the inclusion of ion correlations .",
    "coarser grids were used to estimate the fluctuation term , and the impact of large grid spacing on the accuracy of the correlation term was examined .",
    "excellent agreement with previous theoretical results and monte carlo simulation was obtained for divalent ion distributions around a central sphere .",
    "test calculations were also performed on ion distributions around an atp molecule .",
    "this work allows for the more accurate treatment of systems containing multivalent ions .",
    "the computational expense of obtaining the fluctuation contribution is extensive , however .",
    "what is clear from the multigrid studies to date is that multilevel methods can yield solutions to the poisson - boltzmann equation ( and its modifications to include ion correlations ) with efficiencies resembling those for linear problems and with linear - scaling behavior .",
    "hence , they show a great deal of promise for large - scale colloid and biophysical applications . under some circumstances , special measures",
    "may be necessary to obtain correct multigrid convergence efficiencies .",
    "to my knowledge , all fd poisson - boltzmann calculations so far have employed second - order laplacians ; going to higher orders improves accuracy for little additional cost , so higher - order solvers should be considered . however , high - order techniques near dielectric discontinuities introduce some additional complexity .",
    "in addition to fd - related methods for solving the poisson - boltzmann equation , fe solutions have appeared .",
    "the fe discretization leads to a more accurate physical representation of complex molecular surfaces at the expense of additional computational overhead .",
    "you and harvey ( 1993 ) developed a three - dimensional fe method for solving the linearized poisson - boltzmann equation .",
    "more accurate results were obtained with the fe approach compared with fd solutions in model problems .",
    "potential distributions were computed surrounding trna molecules and the enzyme superoxide dismutase .",
    "this was the first application of the fe method to large - scale biological macromolecular electrostatics .",
    "cortis and friesner ( 1997 ) formulated a method for constructing tetrahedral fe meshes around macromolecules .",
    "the authors discussed the relative merits of fd and fe representations including applications of multilevel methods in their solution .",
    "they used their discretization procedure to solve the linearized poisson - boltzmann equation .",
    "bowen and sharif ( 1997 ) presented a fe numerical method for solution of the nonlinear poisson - boltzmann equation in cylindrical coordinates .",
    "adaptive mesh refinements were employed to gain accuracy near curved surfaces .",
    "they considered applications to membrane separation processes by examining the case of a charged spherical particle near a cylindrical pore .",
    "alternative formulations of electrostatic problems include boundary element methods which reduce poisson problems to calculations involving the molecular surface ( yoon and lenhoff , 1990 , 1992 ; pratt _ et al . _ , 1997 ) .",
    "they lead to dense matrix representations of the problem ; if nonlinear salt effects are to be included , volume integrals , in addition to surface integrals , must be incorporated .",
    "several proposals have appeared concerning computation of free energies of the ion gas once the solution of the poisson - boltzmann equation is obtained .",
    "the free energies are crucial for determining electrostatic interaction energies of charged macromolecules at the mean - field level . the energies can be obtained either by charging methods or volume / surface integrations ( verwey and overbeek , 1948 ; marcus , 1955 ; rice , 1959 ; reiner and radke , 1990 ) .",
    "the most commonly used volume integration approach stems from the variational formulation of sharp and honig ( 1990b ) .",
    "they postulated a form for the free energy which , when extremized , produces the poisson - boltzmann equation .",
    "fogolari and briggs ( 1997 ) critiqued this variational form , showing that the extremum in the free energy is a maximum , not a minimum , with respect to variations of the potential .",
    "they presented another form which is minimized .",
    "the lattice field theoretic free energy is derived from a rigorous representation of the grand partition function of the ion gas ( coalson and duncan , 1992 ) . in this section , we will derive the variational form from the lattice field theory formulation to illustrate differences between the two ; the variational form is obtained from the infinite system size limit of the lattice field theory .",
    "we assume here the case of uniform dielectric and monovalent ions ; the extensions for variable dielectric and higher valences follow the same arguments .",
    "the mean - field lattice field theory helmholtz free energy is    @xmath167    where @xmath168 is an action term ( defined below ) and @xmath166 and @xmath169 are the total numbers of positive and negative mobile ions in the calculation domain . in order to handle periodic as well as finite domains , we assume that the total number of mobile and fixed charges is such that overall charge neutrality is maintained . the free energy eq .",
    "( [ eq : lftfe ] ) is invariant to a uniform shift of the potential , which is the correct physical result . the concentration @xmath27 is given by eq .",
    "( [ eq : pbconc ] ) , while @xmath28 is obtained by the analogous formula for negative charges .",
    "consider the action which , when minimized , results in the poisson - boltzmann equation :    @xmath170 d^3x .",
    "\\label{eq : pbaction}\\ ] ]    the action of eq .",
    "( [ eq : lftfe ] ) is related to @xmath151 by    @xmath171    then the total helmholtz free energy on the lattice is    @xmath172    where the grid potential is @xmath173 , and the sums are over the lattice points .",
    "let us examine a process in which two macroions are moved relative to each other ( fig .",
    "[ fig : colloid ] ) .",
    "the macroions are assumed to reside in a large calculation domain which contains counterions plus perhaps salt ions , so the potential is screened at large distances .",
    "we assume that the potential decays effectively to zero some finite distance from the ions and is zero all the way to the boundaries . the mobile ions",
    "behave as an ideal gas where the potential is zero .",
    "the numbers of fixed and mobile ions is maintained constant throughout the process .",
    "now , consider the free energy change from the ` activity ' term for the positive mobile ions upon moving from configuration 1 to 2 :    @xmath174    call the number of free sites in the domain where the potential is effectively zero @xmath175 and @xmath176 .",
    "the sums over regions where the potential is nonzero are labelled @xmath177 and @xmath178 .",
    "the free energy change @xmath179 is then    @xmath180 } { \\left [ n^f_2 + \\sigma_2 \\right]}. \\label{eq : deltafact1}\\ ] ]    factor out the @xmath181 terms :    @xmath182 } { n^f_2 \\left [ 1 + \\frac{\\sigma_2}{n^f_2 } \\right]}.   \\label{eq : deltafact2}\\ ] ]    the term involving the ratio of the free sites can be represented as    @xmath183 } { n'_{tot } \\left [ 1 - \\frac{\\sigma_{2g}}{n'_{tot } } \\right ] } ,   \\label{eq : deltafact3}\\ ] ]    where @xmath184 is the total number of grid points outside any excluded volume regions and @xmath185 and @xmath186 count the numbers of grid points outside of excluded volume zones where the potential is nonzero .    for very large system sizes ,",
    "the above expressions can be approximated as    @xmath187    analogous terms are obtained for the negative ion case .",
    "as the system size approaches infinity , we can make the further approximations @xmath188 and @xmath189 .    the resulting free energy change for both ionic species is then    @xmath190 .",
    "\\label{eq : deltafact5}\\ ] ]    if we call the grid concentration @xmath191 , then the free energy change can be written as    @xmath192 .",
    "\\label{eq : deltafact6}\\ ] ]    the grid ` activity coefficient ' @xmath193 is @xmath194 which can be assumed to be @xmath195 . in the continuum limit",
    "the free energy change due to the logarithmic terms in the total free energy is thus    @xmath196e^{-v_2 } d^3x   - \\int \\left [ \\cosh ( \\beta\\phi_1 )    - 1 \\right]e^{-v_1 } d^3x \\right ] .",
    "\\label{eq : deltafact7}\\ ] ]    the overall free energy change can then be written as the difference of two terms , one for each configuration :    @xmath197e^{-v } d^3x + \\frac{\\beta\\epsilon}{8\\pi } \\int \\phi \\nabla^2 \\phi d^3x \\label{eq : honigfe1}\\ ] ]    so long as the potential and/or its derivative go to zero on the boundaries , eq .",
    "( [ eq : honigfe1 ] ) can be rewritten as    @xmath198e^{-v } d^3x - \\frac{\\beta}{8\\pi } \\int \\epsilon \\left| \\nabla \\phi\\right| ^2 d^3x \\label{eq : honigfe2}\\ ] ]    which is identical to eq .",
    "( 13 ) in sharp and honig ( 1990b ) .",
    "thus the variational free energy of sharp and honig is derived as the infinite system limit of the lattice field theory expression , where the potential is assumed to go to zero at the distant boundaries .",
    "since the variational form is not invariant to a uniform shift of the potential , some arbitrariness is introduced .",
    "in addition , charge conservation is not maintained as discussed above .",
    "the issue of charge conservation is particularly relevant if one considers periodic boundary domains .",
    "therefore , it is recommended to use the lattice field theoretic form for computations of free energies for cases where these considerations are deemed important .",
    "one reason for a resurgence of interest in continuum models of solvation for large macromolecules is that , for many systems of interest , the total number of particles is simply too large to accurately model at the atomic level .",
    "for example , consider a protein interacting with a dna strand : the atomistic treatment including solvent and salt effects would involve several tens of thousands of atoms , and the motions occur over time scales longer than nanoseconds .",
    "so long as the energetics are proven to be reasonable in testable model calculations , some confidence can be placed in the poisson - boltzmann calculations on larger systems .",
    "the number of applications of poisson - boltzmann - level theory to biological macromolecules is now very large .",
    "previous reviews summarize progress in this area ( sharp and honig , 1990a ; honig and nicholls , 1995 ) .",
    "a few representative studies from the main categories of application are presented here to give a flavor of the types of problems which are accessible .",
    "the first type of application concerns the computed average electrostatic potential and the resulting charge distributions . haggerty and lenhoff ( 1991 ) performed fd calculations to generate the electrostatic potential on the surfaces of proteins .",
    "they found a clear correlation between retention data in ion - exchange chromatography and the average protein surface potential .",
    "ion - exchange chromatography is one of the important techniques for separating mixtures of proteins .",
    "montoro and abascal ( 1998 ) compared monte carlo simulations and fd poisson - boltzmann calculations on distributions of monovalent ions around a model of b - dna .",
    "they found good agreement between the simulations and poisson - boltzmann calculations for low to moderate ion concentrations , but for concentrations above 1 m , the agreement deteriorates .",
    "pettit and valdeavella ( 1999 ) compared electrostatic potentials obtained from molecular dynamics simulations and poisson - boltzmann calculations for a tetra - peptide .",
    "they observed qualitative differences for the electrostatic potentials around the peptide .",
    "however , they argued that the free energies obtained by integration over the entire domain include cancellation of errors and yield more reliable results compared with the potential itself .",
    "patra and yethiraj ( 1999 ) developed a dft method for the ion atmosphere around charged cylinders ( a model for dna or tobacco mosaic virus ) .",
    "their theory includes contributions from finite ion size and ion correlations beyond the mean - field level .",
    "their dft approach gave good agreement with simulations for both monovalent and divalent ion atmospheres .",
    "the poisson - boltzmann level theory does well for low axial charge densities on the cylinder .",
    "interesting charge inversion effects were seen for divalent salts which are entirely absent from the poisson - boltzmann calculations .",
    "recently baker _",
    "( 1999 ) developed a highly adaptive multilevel fe method for solving the poisson - boltzmann equation . by placing adaptive meshes in the regions of the dielectric discontinuities , large reductions in overall computation cost",
    "were observed .",
    "computations were performed to obtain the electrostatic potential around large protein and dna systems .",
    "the second utility of poisson - boltzmann calculations lies in the computation of free energies and resulting interaction energies for variable macromolecule conformations .",
    "yoon and lenhoff ( 1992 ) used a boundary - elements method to compute interaction energies for a protein and a negatively charged surface at the linearized poisson - boltzmann level .",
    "they found the most favorable orientation with the protein active site facing the surface .",
    "zacharias _ et al . _",
    "( 1992 ) investigated the interaction of a protein with dna utilizing the fd poisson - boltzmann method .",
    "they studied the distribution of ions in the region between the two species and the energetics for protein binding .",
    "the interaction energy depends strongly on the charge distributions on the dna and protein .",
    "the computed number of ions released upon complexation agreed well with experiment .",
    "( 1994 ) performed fd poisson - boltzmann calculations to study the influence of added salt on protein - dna interactions .",
    "long - range salt effects play a significant role in relative stabilities of competing structures of protein - dna complexes .",
    "ben - tal _ et al . _",
    "( 1997 ) examined electrostatic effects in the binding of proteins to biological membranes .",
    "the binding constant for the protein - membrane complex was successfully compared with experimental data .",
    "chen and honig ( 1997 ) extended their fd poisson - boltzmann method to mixed salts including both monovalent and divalent species .",
    "they found that , for pure salt cases , the electrostatic contribution to binding varies linearly with the logarithm of the ion concentration ; for divalent salts , nonlinear effects were observed due to competitive binding of the two ionic species .",
    "a third type of problem addressed with poisson - boltzmann level computations is the determination of ph - dependent properties of proteins .",
    "since the net charge of the protein is crucial in understanding its properties , a predictive method is desired for computing electrostatic effects ( due to other charged groups ) on the pk@xmath199 s of ionizable groups .",
    "( 1994 , 1996 ) presented extensive calculations on a large data set for several proteins .",
    "somewhat surprisingly , they obtained the best agreement with experiment assuming an interior dielectric constant of 20 for the protein .",
    "possible explanations of this effect were discussed , including approximate accounting for specific ion binding and conformational relaxation of the protein .",
    "they also found improvements if nmr structural sets were used as opposed to single crystal x - ray structures for the proteins .",
    "( 1998 ) recently performed boundary - element multigrid calculations to determine pk@xmath199 shifts ; they obtained excellent agreement with experiment for polypentapeptides .",
    "fourth , poisson - boltzmann methods have been incorporated into electronic structure calculations to study solvation effects . as an example , fisher _ et al . _",
    "( 1996 ) performed dft electronic structure calculations on a model for the manganese superoxide dismutase enzyme active site .",
    "the region treated explicitly included 37 or 38 atoms ( 115 valence electrons ) . the surrounding solvent was modeled as a dielectric continuum ( water ) .",
    "the electronic structure was computed self - consistently by updating the reaction - field potential due to the solvent following calculations with fixed potential .",
    "typically , the continuum solvation procedure converged within seven iterations .",
    "the authors computed redox potentials and pk@xmath199 s for the complex .",
    "differences from measured redox potentials were observed , and the authors stressed the importance of explicitly including electrostatic effects from the rest of the protein in the calculations .    as a final biophysical real - space application , a lattice relaxation algorithm has been developed by kurnikova _",
    "( 1999 ) to examine ion transport through membrane - bound proteins .",
    "the coupled poisson and steady - state diffusion equations ( poisson - nernst - planck or pnp equations ) were solved self - consistently on a fd real - space grid for motion through a membrane protein , the gramicidin a dimer .",
    "the charges embedded in the channel interior had a large impact on computed diffusion rates .",
    "the computed current - voltage behavior agreed well with experimental findings .",
    "the accuracy of the continuum mean - field treatment is encouraging for the further study of ion transport through a wide range of membrane proteins . a recent study",
    "( corry _ et al .",
    "_ , 2000 ) has critiqued the mean - field approach for narrow ion channels , so some modifications in the pnp theory may be required for those cases .",
    "eigenvalue problems arise in a wide range of applications .",
    "solution of the schrdinger equation with fixed or self - consistent potential is of course a dominant one .",
    "however , eigenvalue problems occur in several other areas . included",
    "are computation of modes and frequencies for molecular vibrations ( jensen , 1999 ) and optical modes of waveguides ( coalson _ et al .",
    "_ , 1994 ) .",
    "self - consistent eigenvalue problems also arise in polymer theory ( tsonchev _ et al . _ , 1999 ) .",
    "this section reviews recent research on real - space methods for fixed and self - consistent potential eigenvalue problems .",
    "the main focus is on novel methods for solving the kohn - sham equations in electronic structure .",
    "additional discussion concerns applications in semiconductor and polymer physics .",
    "let us consider the problem of minimizing the total energy for a single quantum particle subject to the constraint that the wavefunction must be normalized . with the inclusion of a lagrange multiplier term for the constraint ,",
    "the energy functional reads    @xmath200 = -\\frac{1}{2 } \\int \\psi^*\\nabla^2\\psi d^3x    + \\int \\psi^ * v \\psi d^3x - \\lambda\\int \\psi^*\\psi d^3x , \\label{eq : evalaction}\\ ] ]    where @xmath161 is the lagrange multiplier .",
    "if multiple states are desired , then the single lagrange multiplier becomes a matrix of multipliers designed to enforce orthonormality of all the eigenfunctions .",
    "the ` force ' analogous to eq .",
    "( [ eq : force ] ) is then    @xmath201    when the force term is set to zero indicating location of the minimum , the eigenvalue equation for the ground state results . discretizing this equation on a one - dimensional grid leads to the second - order fd representation of the schrdinger equation :    @xmath202 \\left [ \\begin{array}{r } \\psi(x_1 ) \\\\",
    "\\cdot \\\\ \\cdot \\\\ \\cdot \\\\",
    "\\psi(x_n ) \\end{array } \\right ] + \\left [ \\begin{array}{rrrr } v(x_1)&0&0&\\ldots \\\\ 0&v(x_2)&0&\\ldots \\\\ 0&0&v(x_3)&\\ldots \\\\ \\vdots&\\vdots&\\vdots&\\ddots \\end{array } \\right ] \\left [ \\begin{array}{r } \\psi(x_1 ) \\\\ \\cdot \\\\ \\cdot \\\\ \\cdot \\\\",
    "\\psi(x_n ) \\end{array } \\right ] = \\lambda\\left [ \\begin{array}{r } \\psi(x_1 ) \\\\ \\cdot\\\\",
    "\\cdot\\\\ \\cdot\\\\ \\psi(x_n ) \\end{array } \\right ]   \\label{eq : evalmatrix}\\ ] ]    solution of this matrix equation with standard diagonalization routines ( excluding the lanczos and multigrid methods ) results in an @xmath203 scaling of the solution time , where @xmath204 is the number of grid points .",
    "since the matrix is sparse , iterative techniques are expected to lead to increased efficiencies , just as for poisson problems .",
    "we can note that the solution of eq .",
    "( [ eq : evalmatrix ] ) is a nonlinear problem since we seek both the eigenvalues and eigenvectors . in this section ,",
    "we consider necessary extensions of the fas - fmg method for the eigenvalue problem and discuss applications of fd and fe real - space methods for fixed - potential cases .",
    "clear discussion of alternative lanczos and related algorithms ( such as the conjugate - gradient , gmres , and jacobi - davidson algorithms ) for handling sparse matrix diagonalization is given in golub and van loan ( 1996 ) and booten and van der vorst ( 1996 ) .",
    "the derivation of the fd matrix eigenvalue equation above parallels that for the poisson problem .",
    "the additional complexities introduced are : 1 ) the necessity of solving for multiple eigenfunctions , 2 ) computation of eigenvalues , and 3 ) enforcement of orthonormality related constraints .",
    "( bmr , 1983 ) extended the fas - fmg algorithm to eigenvalue problems .",
    "hackbusch ( 1985 ) discussed related eigenvalue methods .",
    "the algorithm of bmr allows for fully nonlinear solution of the eigenvalue problem ; due to the nonlinear treatment , the eigenvalues and constraint equations only need to be updated on the coarsest level where the computational expense is small .",
    "one exception to the previous statement in the original bmr algorithm is a ritz projection ( below ) on the finest level at the end of each v - cycle , preceded by a gram - schmidt orthogonalization .",
    "costiner and taasan ( 1995a ) have since extended the method to process the ritz projection on coarse levels as well .",
    "the same basic fas - fmg procedure is followed in the bmr eigenvalue algorithm as discussed above for poisson problems . the laplacian operator @xmath63 in eq .",
    "( [ eq : luf ] ) is replaced by the real - space hamiltonian minus the eigenvalue @xmath205 .",
    "there is no source term @xmath65 , and there are @xmath20 equations , where @xmath20 is the number of eigenfunctions . since the orthogonalization constraints are global operations involving integrals over the whole domain , these processes can be performed on the coarse levels .",
    "the relaxation sweeps ( two or three ) on finer levels smooth the high - frequency errors and do not destroy the existing orthonormality of the functions ; of course , if many unconstrained iterations were performed on fine levels , all wavefunctions would begin to collapse to the ground state .",
    "linear interpolation and full - weighting restriction are sufficient , but use of cubic interpolation results in more accurate eigenfunctions upon entry to a new finer level .",
    "a direct gram - schmidt orthogonalization is not applicable on coarse levels ; if the exact grid solution is restricted to the coarse levels , the resulting eigenfunctions are no longer orthonormal . therefore , to satisfy the zero correction at convergence condition , a coarse grid matrix equation for the constraints",
    "is    @xmath206    solution requires inversion of a @xmath207 matrix .",
    "the inversion can be effected by direct matrix methods if @xmath20 is small or iterative procedures as performed by bmr in their solver .",
    "the grid overhead for the operation is very small since it is performed on the coarsest level ; for example , if three levels were employed in the eigenvalue solver , the coarse grid operations would require 1/64 the effort compared to the fine scale in three dimensions .",
    "an additional consideration in the eigenvalue problem is that the coarse grid must contain enough points to ` properly resolve ' the eigenfunctions ; bmr give a criterion of @xmath208 for the required number of points .",
    "the eigenvalues can also be updated on the coarse levels by inclusion of the defect correction :    @xmath209    the grid hamiltonian on the coarse level is @xmath210 .",
    "the same set of eigenvalues applies on all levels with this formulation .",
    "relaxation steps are performed on each level with gauss - seidel iterations .",
    "a final addition to the fas - fmg technique in the eigenvalue algorithm of bmr is a ritz projection performed at the conclusion of each v - cycle in the fmg solver .",
    "the purpose of this step is to improve the occupied subspace by making all residuals orthogonal to that subspace .",
    "the eigenfunctions are first orthogonalized with a gram - schmidt step and the @xmath207 hamiltonian matrix in the space of the occupied orbitals is diagonalized .",
    "the orbitals are then corrected .",
    "this step improves the convergence rate .",
    "the ritz projection can be written as    @xmath211    where @xmath79 is the @xmath212 ( @xmath204 is the total number of grid points ) matrix of the eigenfunctions , @xmath213 is the grid hamiltonian , and the @xmath214 are the solved - for coefficients used to improve the occupied subspace .",
    "we have closely followed this algorithm in our own work with two changes : 1 ) we update the eigenfunctions simultaneously ( as opposed to sequentially in the original algorithm ) and 2 ) high - order approximations are used in the fd hamiltonian .    in the form",
    "presented above , the algorithm exhibits @xmath215 scaling due to the ritz projection on the fine scale .",
    "the scaling of the relaxation steps is @xmath216 so long as the orbitals span the entire grid . if a localized representation of the orbitals is possible ( fattebert and bernholc , 2000 ) , then linear scaling of each step in the algorithm results .",
    "further discussion of the scaling of each operation is presented in wang and beck ( 2000 ) .",
    "costiner and taasan ( 1995a ) have generalized the bmr algorithm in several ways .",
    "they transferred the ritz projection step to coarse grids and added a backrotation to prevent rotations of the solutions in subspaces of equal or close eigenvalues .",
    "they also developed an adaptive clustering algorithm for handling groups of eigenfunctions with near eigenvalues .",
    "the scaling of their algorithm is @xmath216 when the eigenfunctions span the entire grid .",
    "several numerical experiments in two and three dimensions demonstrated the high efficiency of their method , and the method was extended to handle self - consistency ( costiner and taasan , 1995b ) .      to demonstrate the efficiency of the bmr fas - fmg eigenvalue solver , consider the three - dimensional hydrogen atom .",
    "while this may seem a very simple case , it presents numerical difficulties for a real - space method due to the presence of the coulomb singularity in the potential . in addition , the s - orbitals exhibit cusps at the singularity and the @xmath217 angular momentum states are degenerate .",
    "beck ( 1999a ) presented numerical results for the hydrogen atom which exhibit the excellent convergence characteristics of the nonlinear fas - fmg eigensolver .",
    "the potential was generated numerically with a 12th - order poisson solver as described above .",
    "the grid was taken as a 65@xmath92 cartesian lattice .",
    "the boundary potentials were set to the analytical @xmath123 values .",
    "the fine grid uniform spacing was @xmath218 au , and a 12th - order fd discretization was employed .",
    "five eigenfunction / eigenvalue pairs were computed .",
    "the fully converged eigenvalues ( obtained by repeated v - cycles on the finest scale ) were -0.50050 for the 1s state , -0.12504 for the 2s state , and -0.12496 for the three 2p states ( which are degenerate out to 10 decimal places when fully converged ) , so the results are accurate to better than @xmath163 .",
    "the eigenvalues were converged to five decimal places following one passage through the fas - fmg solver with three relaxation sweeps on each level on each side of the v - cycles .",
    "thus , only six fine - scale applications of the hamiltonian to the wavefunctions were required to obtain the solution .",
    "the major computational cost for this system occurred during the relaxation steps on the fine scale .",
    "the total solution time was roughly 90 seconds on a 350 mhz pentium ii machine .",
    "these results show that similar convergence behavior can be expected for eigenvalue solvers as for poisson solvers so long as the nonlinear fas - fmg methodology is followed .",
    "mesh refinements will yield comparable accuracies with much less numerical overhead .",
    "the required high - order methods are now in place ( beck , 1999b ) and are being incorporated into the eigenvalue solver .",
    "we now consider related efforts at efficient solution of real - space fixed - potential eigenvalue problems .",
    "et al . _ ( 1983 ) developed a second - order fd multigrid method to solve for a single eigenfunction .",
    "they employed an fas - fmg approach and used a gauss elimination method to exactly solve the equations on the coarsest level .",
    "since they solved for single eigenfunctions , constraints were not necessary .",
    "the eigenvalue was fixed and not computed , so the problem was effectively linear .",
    "( 1995 ) solved fixed - potential eigenvalue problems using a high - order fd representation and a conjugate - gradient method for obtaining the eigenfunctions and eigenvalues .",
    "they tested their method on the p@xmath219 dimer and obtained rapid convergence of the approximation with decreasing grid size .",
    "the representation of the wavefunctions was better than in corresponding plane - wave calculations .",
    "they also computed eigenfunctions for positron states centered at a cd vacancy in cdte .",
    "extensive effort has also been applied to development of fe methodology for fixed - potential problems .",
    "( 1993 ) proposed a two - dimensional fe method in which coulomb singularities were handled with condensed special elements around the nuclei .",
    "test calculations were performed on the linear h@xmath220 molecule , and highly accurate results ( to 10@xmath221 au ) were obtained .",
    "ackerman and roitzsch ( 1993 ) proposed an adaptive multilevel fe approach which utilized high - order shape functions .",
    "inverse iteration was used to solve the large - dimension eigenvalue problem for the two - dimensional harmonic oscillator and the linear h@xmath220 molecule ; accuracies comparable or even superior to the previous study were reported .",
    "subsequently , they extended their method to three dimensions ( ackerman _ et al .",
    "_ , 1994 ) ; in this work , conjugate - gradient techniques were employed to solve the eigenproblem .",
    "results were presented for the three - dimensional harmonic oscillator and h@xmath220 in the equilateral triangle geometry .",
    "sugawara ( 1998 ) presented a hierarchical fe method in which the mesh points and polynomial orders are generated adaptively to gain high accuracy .",
    "the method was tested on the one - dimensional harmonic oscillator .",
    "batcho ( 1998 ) proposed a spectral element method which combines ideas from fe and collocation approaches .",
    "the coulomb singularity was treated with a duffy ( 1982 ) transformation .",
    "( 1999 ) have recently developed a fe method for periodic solid - state computations .",
    "the method uses a flexible @xmath222 piecewise - cubic basis and incorporates general bloch boundary conditions , thus allowing arbitrary sampling of the brillouin zone .",
    "band structure results were presented which illustrate the rapid convergence of the method with decreasing grid size .",
    "the authors emphasized the structured , banded , and variational properties of the fe basis .",
    "( 1999 ) subsequently applied the method to large - scale _ ab initio _ positron calculations for systems of up to 863 atoms .      in this section ,",
    "we begin our examination of real - space methods for solving self - consistent eigenvalue problems with a discussion of fd methods .",
    "the focus here is mainly on the basic fd formulation and its relationship to other numerical methods in terms of accuracy .",
    "later sections will discuss specialized techniques for solution in the real - space representation including multigrid , mesh refinements , fe formulations , and related lcao methods .",
    "one direction has been to develop atom - centered numerical grids in order to obtain converged results independent of basis - set approximations .",
    "becke ( 1989 ) presented a fully numerical fd method for performing molecular orbital calculations . in this method",
    ", the physical domain was partitioned into a collection of single - center components , with radial grids centered at each nucleus .",
    "a polyatomic numerical integration scheme was developed .",
    "this work was the first which extended the previous two - dimensional methods for diatomics ( see , for example , laaksonen _ et al .",
    "_ , 1985 ) .",
    "this numerical method has allowed for accurate computations to test various levels of dft approximations on small molecules without concerns of basis - set linear - dependence effects .",
    "the main focus of this approach has been on numerically converged results and not on scaling and efficiency for large - scale problems .",
    "in contrast to the atom - centered grids discussed above , recent work has focused on development of high - order pseudopotential methods on uniform cartesian grids .",
    "chelikowsky , troullier , and saad ( 1994 ) and chelikowsky , troullier , wu , and saad ( 1994 ) proposed a fd pseudopotential method in which high - order forms were utilized for the laplacian ( appendix ) .",
    "they employed the real - space pseudopotentials of troullier and martins ( 1991a , 1991b ) .",
    "the simplicity of the fd method in relation to plane - wave approaches was highlighted .",
    "the hartree potential was obtained either by a direct summation on the grid or by iterative subspace techniques .",
    "they also employed iterative subspace methods for the eigenvalue problem .",
    "a main emphasis was on the accuracy of the fd approximation in relation to plane - wave methods .",
    "a multipole expansion was used to generate the fixed potential on the boundaries .",
    "three parameters determine the accuracy in their fd calculations : the grid spacing , the order of the laplacian , and the overall domain size .",
    "results were presented concerning the convergence of the eigenvalues with order and decreasing grid spacing .",
    "the 12th - order form of the laplacian was found to be sufficient for well - converged results .",
    "accurate eigenvalues ( to 0.01 au ) were obtained for atomic states .",
    "extensive calculations on diatomic molecules were also presented .",
    "the high - order fd approximation gave good results for binding energies , bond lengths , and vibrational frequencies .",
    "comparisons were made to plane - wave calculations with two supercell sizes , one with 12 au and one with 24 au on a side .",
    "the fd calculation box was 12 au on a side .",
    "the plane - wave energies were not converged with the smaller box size , but the plane - wave calculations approached the fd results when a supercell of 24 au was used , suggesting that quite large supercells must be employed ( even for nonpolar molecules ) for converged orbital energies in localized systems ( see table i ) .",
    "the authors obtained a dipole value of 0.10 d for the co molecule ( with the c@xmath223o@xmath224 orientation ) .",
    "the experimental value is 0.1227 d with the same orientation , while hartree - fock theory yields the wrong sign for the dipole .",
    "however , the fully converged lda dipole is 0.24 d ( laaksonen _ et al . _ , 1985 ) .",
    "form for the exchange - correlation potential .",
    "however , the computed dipole is insensitive when that potential is changed to the lda form .",
    "see jensen ( 1999 ) for converged basis set lda results . ]",
    "the error is most likely due to the restricted overall domain size in their calculation ( see kim , stdele , and martin , 1999 ; wang and beck , 2000 ) . to conclude , the authors emphasized that the fd method is ideal for localized and charged systems , is easy to implement , and is well suited for parallel computations .",
    "related work which has analyzed the impact of fd order on accuracy for poisson problems can be found in the multigrid papers of merrick _ et al . _",
    "( 1995 ) , gupta _ et al . _",
    "( 1997 ) , and zhang ( 1998 ) . also , see section [ subsubsec : hofd ] .",
    "subsequently , jing _",
    "( 1994 ) extended the high - order fd method to compute forces and perform molecular dynamics simulations of si clusters . for most of their work",
    ", they performed langevin molecular dynamics simulations with a random force component to simulate a heat bath .",
    "the clusters were annealed from high temperature to room temperature and the cluster structures were examined ; the fd method gave excellent agreement with other numerical methods .",
    "when the heat bath was turned off , the trajectory exhibited total energy fluctuations two orders of magnitude smaller than the potential energy fluctuations .",
    "the fluctuations agreed in magnitude with those in a plane - wave simulation to within a few percent .",
    "vasiliev , _ et al . _",
    "( 1997 ) recently utilized the higher - order fd methods in computations of polarizabilities of semiconductor clusters with finite - field methods for the response .",
    "the results of the high - order fd method from chelikowsky s group clearly show that the fd representation can yield results of comparable or superior accuracy compared with plane - wave calculations on similar - sized meshes .",
    "in related work , hoshi _ et al . _",
    "( 1995 ) presented a supercell fd method in which they used an exact form of the fd laplacian which spans the whole domain along each direction .",
    "therefore , @xmath225 points are necessary to apply the laplacian to the wavefunction at each grid point ; the method is equivalent to a very high - order representation .",
    "fast fourier transform routines were used to solve for the hartree potential . a preconditioning technique similar to that of payne _",
    "( 1992 ) was employed to improve convergence .",
    "pseudopotential results were presented for the he atom and the h@xmath219 molecule .",
    "their method required 45 steps of iteration to converge within 10@xmath226 au with the preconditioning .",
    "subsequently , hoshi and fujiwara ( 1997 ) incorporated the unconstrained om linear scaling scheme into their method .",
    "windowing functions were employed to confine the orbitals to localized regions of space .",
    "test calculations were performed on the diamond crystal with four localized orbitals per atom .",
    "they obtained a ground state energy of 5.602 au / atom which compared reasonably well with their previous result of 5.617 au / atom .",
    "as mentioned above , fd methods have found application in areas outside of traditional electronic structure theory .",
    "abou - elnour and schuenemann ( 1993 ) developed a self - consistent fd method for computing wave functions , carrier distributions , and sub - band energies in semiconductor heterostructures .",
    "only one - dimensional problems were examined .",
    "they compared the fd method to a basis set calculation and found the fd approach to be faster . in polymer physics",
    ", self - consistent fd methods have also appeared .",
    "( 1999 ) derived a formal field theory for the statistical mechanics of charged polymers in electrolyte solution .",
    "the theoretical development parallels the earlier work of coalson and duncan ( 1992 ) for the ion gas . a functional - integral representation was derived for the partition function of the coupled polymer / ion system .",
    "the mean - field theory solution leads to coupled poisson - boltzmann ( for the ion gas moving in the field of the other ions and the polymer charges ) and eigenvalue ( for the polymer chain distribution ) equations .",
    "these equations were solved numerically with fd methods for polymers confined within spherical cavities .",
    "the three - dimensional eigenvalue problem was solved with the lanczos technique .",
    "electrostatics plays a key role in the chain structure for high chain charge densities and low salt concentrations in the cavities .",
    "the finite - difference results of the previous section show that accurate results can be obtained on uniform grid domains with high - order approximations .",
    "multiscale methods allow for accelerated solution of the grid - based equations .",
    "the first application of multigrid methods to self - consistent eigenvalue problems in electronic structure was by white _",
    "many of the important issues related to real - space approaches were laid out in this early paper .",
    "the authors developed an orthogonal fe basis and solved the poisson equation numerically with multigrid .",
    "due to the orthogonal basis , a standard fd solver only required simple revisions to apply to the fe case .",
    "they also presented preliminary results of multigrid methods applied to the eigenvalue portion of the problem , but only single orbital cases were considered .",
    "they found that the multigrid solver was faster than a conjugate - gradient method ( without preconditioning ) .",
    "computations were performed on the hydgrogen atom , the h@xmath227 molecular ion , the he atom , and the h@xmath219 molecule .",
    "more discussion of their method will be given below in section [ subsec : fes ] on fe methods .",
    "another early method by davstad ( 1992 ) proposed a two - dimensional multigrid solver for diatomic molecules in the hartree - fock approximation .",
    "he combined multigrid and krylov subspace methods in the solver .",
    "high - order fd discretization was employed .",
    "the orthomin procedure ( a krylov subspace method ) was used for iterations on all coarse levels , with gauss - seidel iteration as preconditioner .",
    "computations were performed on the diatomics bh , hf , co , cuh , and the zn atom .",
    "good convergence rates were observed ( presented in terms of orbital residuals ) , and excellent agreement with previous numerical work was obtained for total energies and orbital eigenvalues .    since this early work",
    ", several groups have utilized multigrid solvers for many - orbital problems in three dimensions .",
    "bernholc s group has developed a multigrid pseudopotential method for large systems .",
    "preliminary calculations ( bernholc _ et al . _ , 1991 ) were reported for the h atom and the h@xmath219 molecule . a grid - refinement strategy for adding resolution around the nuclei",
    "was also presented .",
    "subsequently , briggs _",
    "( 1995 ) included real - space pseudopotential techniques into their multigrid method and presented calculations for large condensed - phase systems on uniform grids .",
    "they introduced the fd mehrstellen discretization which leads to a 4th - order representation .",
    "variations of the total energy of atoms when moved in relation to the grid points were investigated . with increasing grid resolution ,",
    "the errors decrease , so this criterion can be used to choose the necessary fine - grid spacing for accurate dynamical simulations .",
    "the hartree potential was also generated with a multigrid solver . in their method , the computation time to perform one multigrid step is comparable to a single propagation step in the car - parrinello method .",
    "results were presented for a 64-atom diamond supercell , the c@xmath228 molecule , and a 32-atom gan cell . for large systems ,",
    "the multigrid method was found to converge to the ground state an order - of - magnitude faster than their car - parrinello code .",
    "for the gan case , 240 multigrid iterations were required to reach the ground state from random initial wavefunctions , while for an 8-atom diamond cell roughly 20 iterations were necessary to converge the total energy to a tolerance of 10@xmath229 au .",
    "their multigrid algorithm was further developed in briggs _",
    "( 1996 ) , where extensive details of the solver were presented .",
    "calculations were performed on a si supercell , bulk al , and an aln supercell with comparisons made to car - parrinello calculations to test the accuracy of the approximations .",
    "excellent agreement with the car - parrinello results was obtained .",
    "their multigrid implementation for the eigenvalue problem utilized a double - discretization scheme ; on the fine level the mehrstellen discretization was employed , while on the coarse grids a seven - point central - difference formula was used .",
    "full - weighting restriction and trilinear interpolation were used for the grid transfers , and jacobi iterations were performed for the smoothing steps .",
    "the eigenvalue problem was linearized by computing the eigenvalues only on the fine grid and performing coarse - grid corrections on each eigenvector .",
    "the constraints were imposed on the fine scale at the end of the double - discretization correction cycle .",
    "subspace diagonalization was performed to accelerate convergence .",
    "tests of the convergence were conducted on a 64-atom si cell and a 64-atom diamond cell with a substitutional n impurity .",
    "substantial accelerations were obtained with multigrid in comparison to steepest - descent iterations ; roughly 20 self - consistency iterations were required in the multigrid solver to obtain 10@xmath230 ry convergence in the total energy",
    ". while these convergence rates are a significant improvement over steepest - descent iterations , they are non - optimal due to the linearization in their method ( see below ) .",
    "the overhead for implementing multigrid in addition to steepest - descent iterations was only 10% of the total computing time .",
    "the authors discussed extensions of the multigrid method for molecular dynamics ( tested on a 64-atom si supercell which exhibited good energy conservation ) .",
    "applications to other large - scale systems appear in bernholc _",
    "( 1997 ) .    in an algorithm very similar to",
    "that described above , ancilotto _ et al . _",
    "( 1999 ) developed a solver which included fmg processing to provide a good initial guess on the finest level .",
    "the mehrstellen discretization was employed on all levels . with the fmg addition , the initial state of the orbitals is irrelevant since it takes very little numerical effort to obtain the initial fine - grid approximation during the preliminary coarse - grid cycles .",
    "they performed red - black gauss - seidel smoothing steps on each level and used full - weighting restriction and trilinear interpolation for grid transfers .",
    "eigenvalues were computed only on the finest level , and ritz projections were also performed to accelerate convergence .",
    "they also reported 20 self - consistency iterations to obtain convergence on several diatomic molecules ( c@xmath219 , o@xmath219 , co , and si@xmath219 ) , and good agreement with plane - wave results was observed for equilibrium bond lengths and vibrational frequencies ( both to within 1% ) .",
    "they presented numerical results for the c@xmath219 dimer ( pseudopotential calculations ) which illustrated the convergence of their algorithm in comparison to a car - parrinello ( damped molecular dynamics ) plane - wave code .",
    "superior convergence was found even in relation to state - of - the - art car - parrinello algorithms ( tassone _ et al .",
    "_ , 1994 ) , which exhibit performance similar to conjugate - gradient algorithms .",
    "the method was tested by using simulated annealing cycles to locate the most stable ground state of the al@xmath231 cluster .",
    "then calculations were performed to find stable minima for charged li clusters with sizes @xmath232 .",
    "the numerical results indicated that the fragmentation behavior observed in experiments likely has a strong non - statistical component .",
    "in addition to the two - dimensional solver of davstad discussed above , all - electron multigrid methods in three dimensions have been developed .",
    "( 1995 ) discussed a multigrid method for solving the kohn - sham equations in which the entire problem was discretized on a three - dimensional cartesian lattice , including all electron orbitals and the nuclear charge densities .",
    "an eighth - order fd form for the laplacian was used in this work .",
    "the nuclear charge densities were discretized as a single cube on the lattice , and the poisson equation was solved with the standard multigrid technique . since the total charge density included both the electron and nuclear densities , all the electrostatic interactions were handled in a single linear - scaling step , including the nucleus - nucleus term .",
    "a self energy must be subtracted from the total energy , but this is a one - time computation for each order of the laplacian since the self energy scales as @xmath233 .",
    "computations were performed on hydrogenic atoms and the h@xmath227 molecule .",
    "a simple nested procedure was utilized for the kohn - sham solver in which an initial approximation was generated on a coarse level , smoothing steps were performed , and the problem was interpolated to the next finer grid followed by relaxations .",
    "this process significantly accelerated the convergence , but some critical slowing down remained due to incomplete decimation of long - wavelength modes on the coarse levels .",
    "these results show that a one - way multigrid procedure without coarse - grid corrections does not guarantee proper multigrid convergence .",
    "various relaxation procedures were compared ; conjugate gradients gave the best convergence per step but required more numerical effort than simple gauss - seidel iterations , so gauss - seidel is equally efficient .",
    "this result illustrates the important point that simple smoothing iterations are enough to decimate the errors with wavelength on the order of a few grid spacings on a given level , and special techniques are not necessary .",
    "results were presented for the all - electron ne atom which exhibited the significant speedup due to a multiscale treatment , but the residual stalling on the fine levels was used to motivate inclusion of the bmr fas - fmg method for the eigenvalue problem .",
    "beck _ et al . _",
    "( 1997 ) presented the first application of the bmr fas - fmg algorithm ( section [ subsubsec : algorithms ] ) to self - consistent electronic structure problems . in this initial effort ,",
    "the bmr algorithm was followed , except the orbitals were updated simultaneously during the correction cycle as opposed to sequentially in the original method .",
    "also , gram - schmidt orthogonalization steps were implemented on each level , so the constraint procedure outlined in section [ subsubsec : algorithms ] was not followed exactly .",
    "convergence calculations were performed on the ne atom on a 33@xmath92 grid ; the fas - fmg approach led to faster convergence than the one - way multigrid calculations of iyer _ et al . _",
    "beck ( 1997 ) extended these calculations to the co molecule ( all electrons and three dimensions ) and developed an fas solver for the poisson - boltzmann equation .",
    "the convergence of the co molecular calculation was limited by the handling of the constraints discussed above . a relatively accurate dipole moment of 0.266 d ( c@xmath223o@xmath224 ) was obtained on a 33@xmath92 mesh .",
    "subsequently , beck ( 1999a ) and wang and beck ( 2000 ) developed a fully convergent fas - fmg kohn - sham self - consistent all - electron solver . in this work , the eigenfunction constraint equations [ eq .",
    "( [ eq : constraints ] ) ] were implemented on the coarsest grid only , and the eigenvalues were also updated on the coarsest level via eq .",
    "( [ eq : cgeval ] ) .",
    "ritz projection was performed on the finest level at the conclusion of each v - cycle .",
    "the effective potential was updated once upon entry to the next finest level and at the end of each v - cycle .",
    "both sequential and simultaneous updates of the orbitals were examined to test the efficiency of each approach .",
    "the sequential method leads to slightly more rapid convergence to the ground state , but it results in a @xmath216 scaling in a self - consistent method since the effective potential is updated following coarse - grid corrections on each orbital . the discretized problem was solved on a 65@xmath92 grid domain with a 12th - order form for the laplacian .",
    "atomic ionization potential computations were performed to illustrate the ease of applicability to charged , finite systems .",
    "numerical results were presented for the all - electron co molecule .",
    "the co eigenvalues were accurate to within 0.015 au for all states above the core , and the highest occupied @xmath234(2p ) and @xmath235(2p ) states were accurate to within 0.006 au .",
    "the computed dipole was 0.25 d , in good agreement with previous fully numerical results on diatomics ( laaksonen _ et al .",
    "_ , 1985 ) .",
    "convergence data was presented for the be atom and the co molecule ( fig .",
    "[ fig : convergence ] ) .",
    "implementation of the nonlinear fas - fmg strategy leads to order - of - magnitude efficiency improvement in relation to linearized versions of the multigrid algorithm ( ancilotto _ et al . _ , 1999 ) .",
    "the converged ground state was obtained in only two or three self - consistency cycles , with three orbital relaxation steps on each side of the v - cycle .",
    "therefore , the entire self - consistent solution process required a total of only 12 - 18 smoothing steps on the finest grid and a few updates of the effective potential .",
    "one self - consistency cycle for the 14 electron co molecule on a 65@xmath92 grid required roughly a minute of cpu time on a 350 mhz pentium - ii machine .",
    "the update of the hartree potential involves the same effort as the update of a single eigenfunction ; it is therefore a small contributor to the overall numerical effort . due to the handling of the constraints and eigenvalues on the coarsest level ,",
    "each self - consistency update requires less computation than the algorithms of briggs _ et al . _",
    "( 1996 ) and ancilotto _ et al . _",
    "( 1999 ) .    since these fas - fmg computations included all electrons and the nuclear singularities in three dimensions , the rapid convergence in relation to the pseudopotential computations of ancilotto _ et al . _",
    "( 1999 ) is noteworthy ( the total energy is nearly three orders - of - magnitude larger than in the pseudopotential calculation ) .",
    "these results are the first to exhibit the full power of the nonlinear bmr technique for solution of self - consistent electronic structure problems .",
    "the slightly slower convergence for the co molecule ( compared with the be atom ) is due to the relatively poor treatment of the core electrons on a uniform grid ; with a finer grid , the convergence is even more rapid .",
    "wang and stuchebrukhov ( 1999 ) have applied the fas - fmg algorithm described above to computation of tunneling currents in electron transfer ; they found that real - space calculations give a significantly more accurate representation of current densities than gaussian basis - set calculations .",
    "some simple arguments can be made concerning the total number of operations for the multigrid solution _",
    "vs. _ the conjugate - gradient plane - wave method .",
    "the present discussion assumes the orbitals span the entire physical domain .",
    "( 1992 ) showed that the conjugate - gradient method requires @xmath236 operations to update all the orbitals .",
    "the second term is for the orthogonalization constraints .",
    "the variable @xmath20 is the number of orbitals and @xmath237 is @xmath238 where @xmath239 is the number of plane waves .",
    "thus @xmath237 is the number of operation counts for fourier transformation on the real - space grid .",
    "the multigrid method requires @xmath240 operations , where @xmath241 is the number of operations to update one orbital with the multigrid method and @xmath204 is the number of fine grid points .",
    "the @xmath242 dependent term is for the orthogonalization constraints ( gram - schmidt followed by ritz projection ) which are performed once at the end of each correction cycle , and the second @xmath241 term is for the poisson solver . since a multigrid update of one eigenfunction ( with say an 8th - order approximation ) requires roughly four times the number of operations count of a single fft ( see section [ subsubsec : icb ] ) , the net cost for the multigrid update ( neglecting the relative constraint costs which are much smaller with multigrid , see below ) is slightly less than that for the conjugate - gradient method .",
    "figure [ fig : convergence ] shows that the number of self - consistency iterations is also very low with the multigrid solver .",
    "the study of ancilotto _ et al . _",
    "( 1999 ) compared damped molecular dynamics to their linearized multigrid method ( on diatomic molecules ) .",
    "they also compared multigrid ( favorably ) with the optimized dynamics method of tassone _ et al . _",
    "( 1994 ) which in turn exhibits convergence rates very similar to conjugate - gradients . since the nonlinear fas - fmg solver outperforms the linearized multigrid method by an order - of - magnitude , this suggests the multigrid solver is more efficient than the conjugate - gradient approach .",
    "the best available plane - wave techniques ( see , for example , kresse and furthmller , 1996 ) can reduce the number of self - consistency iterations to 5 - 10 , so the multigrid solver is at least as efficient as the most efficient plane - wave techniques for uniform - domain problems where the orbitals span the whole domain .",
    "the major benefits of the multigrid approach in addition to the above discussion are : 1 ) all the constraint and subspace orthogonalization operations can be removed to coarse levels where the cost is minimal ; for example if they are performed two levels removed from the fine level , the cost is 1/64 that on the fine level ( costiner and taasan , 1995a ) , 2 ) it is quite easy to impose localization constraints in the real - space multigrid approach ( fattebert and bernholc , 2000 ) , and 3 ) mesh refinements can be incorporated while maintaining the same convergence rates ( see beck , 1999b , for the poisson version ) .",
    "the mesh - refinement methods are in place and are currently being incorporated into kohn - sham solvers ; they should lead to a further near order - of - magnitude reduction in computational cost .",
    "finally , costiner and taasan ( 1995b ) have shown that by updating the effective potential simultaneously with the eigenfunctions on coarse levels self - consistent solutions can be obtained in a _",
    "passage through the final v - cycle of the fmg process .",
    "therefore , multiscale real - space approaches offer a promising alternative to plane - wave techniques .",
    "recently , lee _ et al . _",
    "( 1999 ) proposed a one - way multigrid method similar to that of iyer _ et al . _",
    "initial approximations were obtained on coarse levels , and the solution was interpolated to the next finer level without multigrid correction cycles .",
    "high - order interpolation was used to proceed to the next finer grid .",
    "conjugate - gradient techniques were employed to relax the orbitals on each level .",
    "the method led to a factor of five reduction in computation time compared to a single - grid calculation .",
    "computations were performed on a 20-electron quantum dot and charged h clusters .",
    "kim , lee , and martin ( 1999 ) developed an object - oriented code for implementation of the one - way multigrid algorithm .",
    "several other groups have utilized multigrid solvers as components of real - space electronic structure algorithms ; these will be discussed in the following sections on mesh - refinement techniques and fe methods .",
    "the previous sections have discussed fd methods for electronic structure ; the calculations were performed primarily on uniform grids . with the incorporation of real - space pseudopotentials , results with accuracies comparable to plane - wave methods ( with similar grid cutoffs ) can be obtained with high - order fd techniques .",
    "the calculations of beck ( 1999a ) and wang and beck ( 2000 ) are instructive in that surprisingly accurate results are possible even in all - electron calculations on uniform grids ; in addition , their work shows that multigrid efficiencies are obtainable for the challenging case of very harsh effective potentials which include the nuclear singularities .",
    "however , it is clear that increasing uniform grid resolution until acceptable accuracy is reached is a wasteful process since small grid spacings are only required in the neighborhood of the atomic cores .",
    "this section reviews recent work on development of fd mesh - refinement techniques which address this issue for the eigenvalue problem .    as discussed in section [ subsubsec : mrt ] which covered closely related methods for the poisson equation , there are presently two strategies for mesh refinements : grid curving and local refinements which are included within a coarser mesh ( fig .",
    "[ fig : meshrefine ] ) .",
    "gygi and galli ( 1995 ) extended a previous plane - wave method of gygi ( 1993 ) to adaptive - coordinate fd calculations .",
    "a curvilinear coordinate system was developed which focused resolution near the nuclei .",
    "the necessary extensions of the standard fd method to handle the curvilinear laplacian were presented .",
    "fd forms of order 2 and 4 were utilized , and norm - conserving pseudopotentials were employed .",
    "the poisson equation was solved with a multigrid method .",
    "the calculations were implemented on a cray - t3d massively parallel machine .",
    "test calculations were conducted on diatomics and the co@xmath219 molecule .",
    "the calculations of the total energy of the co@xmath219 molecule vs.  internuclear distance exhibited a spurious double minimum with a uniform grid treatment ( cutoff energy of 227 ry ) .",
    "this double minimum is due to the numerical errors from a grid which is too coarse .",
    "when the adaptive coordinate transformation was included ( with effective cutoffs of 360 ry for carbon and 900 ry for oxygen ) , a single minimum was observed near the correct experimental bond length .",
    "modine _ et al . _",
    "( 1997 ) presented another adaptive - coordinate fd method which they termed acres ( adaptive - coordinate real - space electronic structure ) .",
    "they first discussed the goals of their real - space method : 1 ) sparsity , 2 ) parallelizability , and 3 ) adaptability .",
    "the real - space approach satisfies these criteria , while the plane - wave method does not .",
    "extensive details were given concerning the construction of their grid - curved meshes and the resulting laplacian .",
    "one issue to note is that the fd laplacian in curvilinear coordinates contains off - diagonal terms and the number of terms scales as @xmath243 , where @xmath40 is the order .",
    "therefore , high - order derivative forms add complexity to the adaptive - coordinate approach .",
    "computations were performed on atoms and molecules at both the all - electron and pseudopotential levels .",
    "the authors discussed the limitations of the lanczos method for the eigenvalue problem ; the width of the real - space spectrum is dominated by the largest eigenvalue which in turn is determined by the minimum grid spacing , so the method slows with increasing resolution .",
    "instead , they used a modified inverse iteration eigensolver .",
    "the equations were solved with a conjugate - gradient algorithm .",
    "conjugate - gradient techniques were also employed for the poisson equation , with multigrid used for preconditioning .",
    "highly accurate all - electron results were obtained for the o atom and the h@xmath219 and o@xmath219 molecules ; computed bond lengths for o@xmath219 agreed with both the previous calculations of chelikowsky , trouller , wu , and saad ( 1994 ) and experiment to within 0.02@xmath244 . to conclude , they discussed the high efficiency of acres in relation to uniform grid computations .",
    "two works have appeared which utilize nested mesh refinements as opposed to grid - curving techniques for increased resolution .",
    "fattebert ( 1999 ) developed an algorithm to treat a single grid refinement placed inside a coarser - level grid domain .",
    "a fd mehrstellen discretization was employed over the whole domain , with nonuniform difference stencils at the boundaries between the fine and coarse levels .",
    "the discretization is 4th order over the uniform regions and 2nd order at the boundaries .",
    "the impact of this nonuniformity of the representation order on the solution order was not examined .",
    "the eigenvalue problem was solved with a block galerkin inverse iteration in which multigrid methods were used to solve the linear systems .",
    "smoothing iterations were enacted with the gmres algorithm ( golub and van loan , 1996 ) .",
    "pseudopotential calculations were performed on the furan molecule which requires treatment of 13 eigenfunctions .",
    "excellent convergence rates were observed , especially on the finer composite meshes ; the coarse grid convergence was not as rapid .",
    "the author also presented results for the total energy of the co molecule which are similar to those of gygi and galli ( 1995 ) described above .",
    "incorporation of the grid refinements led to smooth variations of the energy , while the coarser - grid computation resulted in irregular variations .",
    "ono and hirose ( 1999 ) proposed another double - grid method in which the inner products of the wavefunctions and pseudopotentials are treated on a fine grid .",
    "the double - grid treatment leads to smooth forces without the necessity of pulay ( 1969 ) corrections ( which are required in the adaptive - coordinate method ) .",
    "just as for the fd formulation , the application of fe methods to self - consistent eigenvalue problems has followed two different tracks . in the first , the fe basis has been utilized to obtain highly accurate results for atoms and small molecules .",
    "the fe method can achieve very high accuracies since it does not suffer from the linear - dependence problems of lcao approximations , and the mesh can be arbitrarily refined .",
    "the second type of application concerns development of efficient methods for large - scale electronic structure problems .",
    "we begin with methods designed to obtain high accuracies .",
    "levin and shertzer ( 1985 ) performed fe calculations on the he atom ground state .",
    "the problem reduces to three - dimensional for the @xmath245 state .",
    "a basis of cubic hermite polynomials was employed .",
    "they computed both the ground - state energy and the moments @xmath246 of the wavefunction .",
    "an energy within 0.0005 au of the numerically exact result was obtained . also , the orbital moments were substantially more accurate than those computed in basis - set calculations .",
    "this occurs since the lcao basis functions are global ; if the functions are optimized to give a good wavefunction near the nucleus ( where the largest contribution to the total energy occurs ) , they can not be adjusted simultaneously to give a good representation far from the origin .",
    "the fe basis overcomes this difficulty .",
    "( 1987 ) and heinemann _ et al . _",
    "( 1988 ) developed a two - dimensional fe method and applied it to computations on the h@xmath219 , n@xmath219 , bh , and co molecules . using a 5th - order basis ,",
    "accuracies to better than @xmath247 au for the total energies were observed , which exceeds by two orders the accuracy of the fd calculations by laaksonen _",
    "et al . _ ( 1985 ) .",
    "( 1994 ) implemented an order 5 or 6 lobatto - gauss fe basis and employed a block lanczos algorithm to solve the eigenvalue problem . a duffy ( 1982 )",
    "transformation allowed for handling of the coulomb singularity .",
    "calculations were performed on diatomic and triatomic hydrogen molecules and ions ; these three - dimensional results were not as accurate as in the two - dimensional study of heinemann _ et al . _",
    "( 1987 ) , differing by .00051 au in the total energy of h@xmath219 .",
    "more recently , kopylow _",
    "( 1998 ) incorporated an fmg solver into their two - dimensional method for diatomics .",
    "conjugate - gradient smoothing steps were employed on each level .",
    "excellent convergence rates were obtained for the solver which was tested on the be@xmath219 molecule ; only 5 self - consistency iterations were required to obtain 10@xmath248 au convergence in the energy .",
    "( 1998 ) combined the lcao and fe methods in a defect correction approach which allowed for a more rapid attainment of the ground state due to a better representation around the nuclei .",
    "next , we consider methods directed toward larger systems .",
    "the fe method of white _ et al . _",
    "( 1989 ) was discussed above related to multigrid methods for self - consistent problems .",
    "they utilized a high - order fe basis and constructed orthogonal functions from the nonorthogonal basis .",
    "the cost of this construction is the requirement of more functions to obtain the same level of completeness .",
    "the three - dimensional basis functions were products of the one - dimensional functions on a cartesian grid .",
    "the coulomb singularity was handled with an integral transform representation of @xmath123 .",
    "the hamiltonian is sparse in their basis since only near - neighbor overlaps need to be considered . to solve the poisson equation ,",
    "multigrid techniques were employed with a double - discretization procedure similar to that of briggs _ et al . _",
    "( 1996 ) ; on coarser levels , the problem was represented with a fd form rather than with a fe basis . as discussed above , multigrid solution of",
    "the eigenvalue problem was faster than conjugate gradients . to conclude , they emphasized the importance of developing new grid methods for refinements around the nuclei , where the largest errors occur .",
    "gillan and coworkers have developed a general method for linear - scaling electronic structure ( of the obdmm form discussed in section [ subsec : linsces ] ) .",
    "closely related is the work of hierse and stechel ( 1994 ) , which differs in the choice of basis and the number of basis functions . in their initial work ( hernndez and gillan , 1995 ) ,",
    "the obdmm strategy was developed , and the calculations were performed directly on a real space grid with second - order fd techniques .",
    "the total energy was minimized with conjugate - gradients iterations .",
    "typically , 50 iterations were required to obtain energy convergence to within 10@xmath249 ev / atom .",
    "hernndez _ et al . _",
    "( 1997 ) developed a blip - function basis instead of the previous fd representation .",
    "this method is general in the sense that any local function ( that is , completely restricted to a finite volume ) can be used for the basis ; however , we examine this method in relation to fe bases since it is so closely related .",
    "the actual basis employed in their work is a set of b - splines ( see , for example , strang and fix , 1973 , p.  60 ) .",
    "the basis was implemented on a cartesian mesh as products of three one - dimensional functions .",
    "the kinetic and overlap terms were treated analytically , but the matrix elements of the potential were evaluated numerically on a grid different from the blip grid .",
    "the blip - function basis agreed very well with plane - wave results in calculations on si solids ; a discrepancy of only 0.1 ev / atom was observed between the two different approaches .",
    "( 1997 ) discussed implementation of the algorithm on very large systems ( up to 6000 atoms ) on parallel machines .",
    "the essential features of the obdmm method were reviewed .",
    "fast fourier transform methods were used to solve for the electrostatic potential on a grid .",
    "complete discussion was given of the steps in parallelizing every portion of the code using real - space domain decomposition .",
    "the numerical results on a cray - t3d parallel machine exhibited linear scaling of cpu time with the number of atoms using between 32 and 512 processors .    as discussed in bowler _",
    "( 1999 ) and reviewed in goedecker ( 1999 ) , three forms of ill - conditioning can lead to degradation of convergence to the ground state in the obdmm method : length - scale , superposition , and redundancy ill - conditioning .",
    "the first is an inherent feature of any real - space solver ( section [ subsubsec : fdsit ] ) .",
    "the second form results from the localization constraints imposed in the method , and is similar to problems in om methods .",
    "the third is related to the fact that their method includes more basis functions than occupied orbitals ; the localization constraints lead to small but nonzero occupation numbers of the higher - lying states , and they have little influence on the total energy . bowler and gillan ( 1998 ) addressed the length - scale ill - conditioning problem .",
    "they developed a preconditioning technique related to the plane - wave method of payne _ et al . _",
    "the blip - function preconditioning matrix only needs to be calculated once .",
    "test calculations were performed for a si crystal with significant accelerations of the convergence due to the preconditioning . however , the convergence efficiency of their method decreased both with decreasing grid spacing and with increasing localization radius .",
    "it is an interesting question whether multigrid methods might lead to higher efficiencies in the context of the obdmm method .",
    "an alternative fe method for large - scale electronic structure has been developed by tsuchida and tsukada ( 1995 , 1998 ) . in their original method",
    ", the authors utilized first- and second - order shape functions and derived the appropriate variational expression for the total energy at the lda level .",
    "the hartree potential was generated by conjugate - gradient iteration .",
    "they also implemented the om linear - scaling method .",
    "nonuniform meshes were employed to focus resolution around the nuclei in the h@xmath219 molecule .",
    "test calculations were also performed on an 8-atom si solid with 16@xmath92 uniform elements of the second order .",
    "good agreement with plane - wave calculations and experiment were obtained for the lattice constant , cohesive energy , and bulk modulus . due to",
    "the integral formulation of the total energy , the coulomb singularity in the potential becomes finite . in tsuchida and tsukada ( 1998 )",
    ", the method was substantially extended for large - scale condensed - phase systems .",
    "third - degree polynomials were used as fe basis functions .",
    "they implemented the grid - curving method of gygi and galli ( 1995 ) to adapt for higher resolution near the nuclei .",
    "pulay ( 1969 ) corrections were computed to obtain accurate forces on the ions .",
    "a multigrid procedure was followed to solve the fe poisson equation .",
    "the multigrid aspect was used as preconditioner to final conjugate - gradient iterations on the finest scale . again , om techniques were used to obtain linear scaling .",
    "they also utilized a one - way multigrid - type approach for the eigenvalue problem , where a good initial approximation was obtained on the finest level from previous iterations on a coarser level . with this approach ,",
    "20 to 30 self - consistency iterations were required for convergence on the fine level .",
    "calculations were limited to the @xmath250 point ; for the treatment of general bloch boundary conditions , see pask _ et al . _",
    "a parallel code was written using real - space domain decomposition .",
    "many applications were considered in this work , including computations on diamond lattices , cubic bn , the c@xmath228 molecule , molecular dynamics simulations , and parallel implementations .",
    "pseudopotential calculations on systems with up to 512 carbon atoms were presented .",
    "the final statement from this paper captures well the rapid development of real - space methods in the last decade :  about ten years ago , the fe method was described to be in its infancy for electronic structure calculations ( white _ et al .",
    "_ , 1989 ) .",
    "we have shown in this paper that it can be routinely used for large systems today . \"    as a final application of fe methods to self - consistent eigenvalue problems , lepaul _ et al . _",
    "( 1996 ) considered semiconductor quantum nanostructures .",
    "they solved the two - dimensional schrdinger equation self - consistently with updates of the poisson equation ( variable dielectric case ) to obtain carrier densities , conduction bands , and the potential distribution at finite temperatures .",
    "the image potential and exchange - correlation energies were neglected .",
    "the carrier confinement was due to heterojunction discontinuities and the electrostatic potential . by varying the potential bias ,",
    "a bidimensional quantum gas was observed .",
    "the real - space approach allowed for treatment of realistic device geometries .      to conclude our review of real - space self - consistent eigenvalue problems , we consider a related om linear - scaling algorithm which uses lcao bases ( snchez - portal _ et al .",
    "_ , 1997 ) .",
    "the reason for its inclusion here is that the bases ( sankey and niklewski , 1989 ) are 1 ) numerical and 2 ) confined to a local region of space",
    ". therefore , the method shares features in common with fd and fe approaches .",
    "the authors discussed construction of the hamiltonian matrix elements and the total energy in the numerical bases .",
    "the total energy was re - expressed in a form which has terms involving only two - centered integrals which are interpolated from calculated tables ( one - time calculation ) and other terms computed entirely on a real - space grid ( involving screened neutral - atom potentials and the hartree and exchange - correlation potentials ) .",
    "the hartree potential was computed via fft methods .",
    "rapid convergence of the approximations with decreasing grid spacing was observed .",
    "the om functional of kim _ et al . _",
    "( 1995 ) was employed to obtain linear scaling .",
    "the method was applied in calculations on several diatomics and triatomics where various - quality basis sets were tested in computations of bond lengths , bond angles , and binding energies .",
    "gradient corrections to the lda approximation were also considered .",
    "finally , large - scale computations were performed on a turn of the dna double helix consisting of ten guanine - cytosine base pairs in periodic boundaries ( 650 atoms ) .",
    "the equilibrium geometry was obtained in 200 minimization steps , requiring 5 days of computation on an hp c110 workstation .",
    "the number of self - consistency iterations required for each minimization step was not given . also , it is not entirely clear what is the sparsity of the hamiltonian in the numerical localized lcao basis in relation to fd and fe methods .",
    "the spherical - wave basis set of haynes and payne ( 1997 ) should also prove useful since it is localized in space and its truncation is controlled by a single parameter , the kinetic energy cutoff ( similar to plane - wave methods ) .",
    "hybrid basis - set / grid type methods such as discrete variable representations ( dvr ) and distributed approximating functionals ( dafs ) also exist which yield accurate local representations ( light _ et al .",
    "_ , 1985 ; marchioro _ et al .",
    "_ , 1994 ; schneider and feder , 1999 ) .",
    "the kohn - sham method for electronic structure lies on solid theoretical ground due to the hohenberg - kohn theorems .",
    "extensions of dft to excited states and/or frequency - dependent polarizabilities present more difficult challenges , but significant progress has been made in this area in the last few years .",
    "the developments include real - space computations of excitation energies and response properties ( yabana and bertsch , 1996 ; vasiliev _ et al .",
    "_ , 1999 ; kim , stdele , and martin , 1999 ) .",
    "thorough reviews of the foundations of time - dependent dft ( tddft ) methods are available ( see , for example , gross and kohn , 1990 ; casida , 1996 ) . the starting point for practical computations",
    "is typically the solution of the time - dependent lda ( tdlda ) equations :    @xmath251 \\psi_i({\\bf r } , t ) = i\\frac{\\partial\\psi_i({\\bf r } , t)}{\\partial t } ,   \\label{eq : tdks}\\ ] ]    where the density - dependent effective potential is just the kohn - sham lda potential ( eqs .",
    "[ eq : veff ] and [ eq : ves ] ) for the set of orbitals at time @xmath77 .",
    "the tdlda method includes dynamic screening effects which modify the excitation frequencies away from the kohn - sham lda eigenvalue differences toward the physical ones .",
    "inclusion of gradient corrections does not significantly improve the results ( bauernschmitt and ahlrichs , 1996 ; casida _ et al .",
    "_ , 1998 ) .",
    "there are two important approximations involved in eq .",
    "( [ eq : tdks ] ) : 1 ) the static lda potential exhibits the incorrect asymptotic behavior at long range ( exponential rather than @xmath252 ) , and 2 ) no time dependence is incorporated in the exchange - correlation potential ( adiabatic approximation ) .",
    "it is generally recognized that the first approximation is the most severe ( van gisbergen _",
    "et al . _ , 1998 ) ; with improvements to the lda which yield the correct asymptotic large-@xmath253 behavior , quite accurate results are obtainable even for rydberg states ( casida , 1996 ; jamorski _ et al . _ , 1996 ;",
    "casida _ et al .",
    "_ , 1998 ; van gisbergen _ et al .",
    "_ , 1998 ; tozer and handy , 1998 ) .",
    "the adiabatic approximation makes physical sense for slow processes , and integrals ( over frequency ) of the response in the mean - field theory obey rigorous sum rules which are satisfied for the small - amplitude tdlda ( yabana and bertsch , 1999 ) .",
    "proper modeling of the long - range behavior of the effective potential is important for the higher - lying kohn - sham states , which in turn are crucial for obtaining accurate excitation energies above the highest occupied kohn - sham lda eigenvalue .",
    "these states are also important for computing accurate polarizabilities . for low - lying excitations ,",
    "the tdlda - level of theory is remarkably accurate ( casida _ et al .",
    "_ , 1998 ; yabana and bertsch , 1999 )",
    ". observed errors in excitation energies are on the order of one or a few tenths of an ev for small molecules in comparison with experiments .",
    "two main approaches have been followed in development of the tddft method . in the first ( yabana and bertsch , 1996 ) ,",
    "( [ eq : tdks ] ) is solved directly in real time by propagating the orbitals on a real - space grid .",
    "the frequency - dependent polarizability and the strength function are obtained by fourier transformation of the time - dependent dipole moment computed on the grid . in the second approach ( petersilka _",
    "et al . _ , 1996 ; casida , 1996 )",
    ", the problem is recast in the energy representation by calculating the response at the linear - response level .",
    "solution of an eigenvalue problem involving the kohn - sham energy differences and a coupling matrix yields the excitation energies and oscillator strengths and from them the frequency - dependent polarizabilities .",
    "applications of the second theoretical approach have employed both basis - set ( casida , 1996 ; van gisbergen _ et al .",
    "_ , 1998 ; tozer and handy , 1998 ) and real - space ( vasiliev _ et al .",
    "_ , 1999 ) formulations .",
    "the real - time and energy representations should give equivalent results for physical situations which allow a linear - response treatment .",
    "in this section , we review recent real - space computations in tdlda theory .",
    "the real - time approach directly integrates eq .",
    "( [ eq : tdks ] ) once an initial impulse has been given to the one - electron orbitals ( obtained from a previous ground - state calculation ) .",
    "yabana and bertsch ( 1996 ) propagated the wavefunctions in time with a 4th - order taylor expansion of the tdlda equation .",
    "the procedure followed the previous time - dependent hartree - fock method of flocard _",
    "et al . _ ( 1978 ) in nuclear physics .",
    "that method was shown to conserve the energy and wavefunction norms to high accuracy .",
    "a predictor - corrector method was implemented to fix the density at times between successive wavefunction evaluations .",
    "the hamiltonian was represented with a fd form on a uniform cartesian mesh .",
    "an 8th - order expression was employed for the laplacian operator , and the real - space pseudopotentials of troullier and martins ( 1991a , 1991b ) were utilized to remove the core electrons .",
    "the method scales as @xmath216 since it only requires repeated applications of the kohn - sham hamiltonian to the wavefunctions , here assumed to cover the whole domain .",
    "if the orbitals could be confined to local regions of space , the method would scale linearly .",
    "roughly @xmath254 time - propagation steps are required to obtain the frequency - dependent response .",
    "as mentioned above , the physical quantities generated are the frequency - dependent polarizability and the closely related dipole strength function .",
    "the entire spectrum is produced in a single calculation without computations of excited - state kohn - sham orbitals , and the method is not restricted to the linear - response level of theory .",
    "in addition , the method only requires storage of the occupied states .",
    "computations were first performed on the jellium model for li@xmath255 to compare with previous numerical results ; the dipole strength function agreed well with that computed using a green s function technique .",
    "then calculations were performed on more physically realistic models of large charged na clusters and c@xmath228 .",
    "the strength function yields the polarizability ; for the c@xmath228 case , a value of @xmath256 was computed compared with the experimental value of @xmath257 obtained from the dielectric constant .",
    "a tight - binding model predicted a much lower polarizability of @xmath258 . in a second study ,",
    "yabana and bertsch ( 1997 ) applied the method to carbon chains and rings which are found in interstellar matter .",
    "for the c@xmath259 chain , the lowest tdlda mode occurs at roughly twice the frequency of the homo - lumo gap in the kohn - sham lda states .",
    "the size dependence of the transitions was modeled as the classical resonance of electrons in a conducting needle .",
    "the ring and chain geometries led to widely different frequencies for the lowest collective mode .",
    "yabana and bertsch ( 1999 ) presented further computations on conjugated hydrocarbons including polyenes , retinal ( c@xmath260h@xmath261o ) , benzene , and c@xmath228 . in this work",
    ", the scaling of the method was displayed vs.  system size and was found to be even below @xmath262 .",
    "the tdlda dipole strength was compared to precise experiments for the benzene molecule , and excellent agreement for the dipole strength was obtained .",
    "the computed lowest @xmath263 sharp transition was at 6.9 ev , the same as the experimental value , and a broad feature above 9 ev due to @xmath264 transitions was also relatively accurately reproduced .",
    "discussion was given of the applicability of the hckel hamiltonian ; the hckel treatment performed well for the @xmath263 manifold . in light of the large systems already addressed with the real - time tdlda method ,",
    "it holds significant promise for examining such problems as solvation effects on electronic excitations in condensed phases .      in the spin - unrestricted linear - response energy representation ( casida , 1996 )",
    ", the excitation energies are obtained from an eigenvalue equation :    @xmath265    where the excitation energy differences are @xmath266 and the matrix @xmath32 is    @xmath267    the @xmath268 terms are the occupation differences between the @xmath41 and @xmath269 @xmath235-spin states , @xmath270 are the corresponding kohn - sham energy differences , and the response matrix is    @xmath271    where @xmath272 is the linear response of the kohn - sham density in the basis of the unperturbed orbitals .",
    "the resulting full expression for @xmath273 in terms of the kohn - sham orbitals can be found in casida ( 1996 ) and vasiliev _ et al . _",
    "( 1999 ) ; it involves the unperturbed orbitals only and ( in the adiabatic approximation ) the second derivatives of the static exchange - correlation functional @xmath274 with respect to the spin densities .",
    "therefore , at this level of theory @xmath273 is time- and frequency - independent .",
    "however , it includes screening effects which alter the spectrum toward the correct physical result .",
    "the eigenvalues of eq .",
    "( [ eq : erepeval ] ) give the transition energies , and the eigenvectors yield the oscillator strengths from which the dynamic polarizability can be computed .",
    "the oscillator strengths in this formulation satisfy the same sum rule as for the real - time version presented above .",
    "the method scales as @xmath0 [ where @xmath1 is the number of electrons , see casida ( 1996 ) ] ; however , linear - scaling methods can be applied just as for the ground - state kohn - sham theory .",
    "vasiliev _ et al . _",
    "( 1999 ) utilized the high - order fd pseudopotential method of chelikowsky , troullier , and saad ( 1994 ) in solving eq .",
    "( [ eq : erepeval ] ) for excitation energies .",
    "they considered the exact form for @xmath32 [ eq .",
    "( [ eq : omega ] ) ] and two approximate forms , one of which was employed by petersilka _",
    "( 1996 ) in their work .",
    "they first examined excitations in closed - shell atoms and found that the exact expression resulted in the highest accuracies .",
    "errors for low - lying excitations attributed to the lda exchange - correlation potential in petersilka _",
    "( 1996 ) were corrected by using the exact expression .",
    "computed energies were in error by only a few tenths of an ev in comparison with experiment for singlet excitations .",
    "they also found that transition energies for singlet and triplet excitations computed with tdlda theory are in better agreement with experiment than optimized effective potential ( oep , see talman and shadwick , 1976 ) or ordinary self - consistent field methods due to the approximate inclusion of correlation effects .",
    "the authors proceeded to apply the tdlda method to computations of absorption spectra for na clusters .",
    "only computations using the exact formulation resulted in spectra that agreed with experiment ( to within 0.2 ev ) .",
    "this indicates the importance of collective excitations since the approximate forms neglect these contributions . finally , they computed the static polarizabilities of na and si clusters with the exact and approximate formulations and found that only the exact representation yielded good agreement with finite - field calculations . in related work , t _ et al . _",
    "( 1997 ) computed _ ab initio _ optical gaps for very large si nanocrystals ( up to si@xmath275h@xmath276 ) with high - order fd methods .",
    "kim , stdele , and martin ( 1999 ) have recently utilized the high - order fd pseudopotential method in calculations on small molecules at the krieger - li - iagrate ( kli , 1992 ) level for the effective potential .",
    "this potential is an approximation to the oep theory which is computationally tractable and has the correct @xmath252 tail in the effective potential .",
    "the calculations yielded better approximations to excited - state energies in relation to the kohn - sham lda values , but the full tddft energy - representation method was not employed for corrections to the kohn - sham kli levels .",
    "real - space methods for solving electrostatics and eigenvalue problems involve either local taylor expansions of the desired functions about a point or localized basis - set representations .",
    "higher accuracy is obtained by increasing the order of the approximation and/or the resolution of the mesh .",
    "however , standard iterative processes become less efficient on finer meshes due to the difficulty of reducing the long - wavelength modes of the errors .",
    "multigrid methods provide a remedy for this slowing - down phenomenon inherent in real - space numerical methods .",
    "many of the early limitations of real - space methods ( such as very large required meshes ) have been overcome in recent years with the development of efficient high - order finite - difference and finite - element methods .",
    "this review has surveyed a wide range of physical applications of real - space numerical techniques including biophysical electrostatics , ground - state electronic structure , and computations of electronic response and excitation energies .",
    "recent real - space computations have tackled problems with hundreds to thousands of atoms at a realistic level of representation .",
    "the discussion presented in this review leads to several conclusions :    * the underlying representation is relatively simple in real space .",
    "the finite - difference method is particulary straightforward , while the finite - element and wavelet methods involve some increased complexity . as an example , a self - consistent kohn - sham lda multigrid program using the high - order finite - difference method requires less than 5000 lines of computer code . * with the incorporation of high - order methods , accuracies comparable to plane - wave calculations are obtained on similar - sized meshes . *",
    "the laplacian and hamiltonian operators require information only from close lattice points ; that is , the operators are near - local in space .",
    "therefore , the matrices are sparse , highly banded , and very structured .",
    "each application of the operators scales linearly with system size , and the method is readily implemented on parallel computers by partitioning the problem in space .",
    "the locality also allows for incorporation into linear - scaling electronic structure methods .",
    "* multigrid methods provide the optimal solvers for problems represented in real space . for poisson problems ,",
    "the multigrid method scales linearly with system size and requires only about 10 iterations on the finest level to obtain convergence .",
    "eigenvalue solvers scale as @xmath215 ( where @xmath20 is the number of eigenfunctions and @xmath204 the number of fine grid points ) if the eigenfunctions span the whole space .. see costiner and taasan ( 1995 ) . ] if a localized orbital representation is possible , the multigrid eigenvalue methods scale linearly with size due to the locality of each operation in the algorithm . *",
    "nonlinear multigrid methods require fewer operations per self - consistency update than plane - wave methods on uniform grids with orbitals that span the physical domain .",
    "in addition , the multigrid method is at least as efficient as the best plane - wave methods in terms of the number of self - consistency steps to reach the ground state .",
    "the multigrid solution requires at most a few self - consistency iterations .",
    "the solution involves 10 - 20 total applications of the hamiltonian to the wavefunctions on the finest level and a few updates of the effective potential ( one for each self - consistency cycle ) ; each update of the hartree potential requires the same effort as the update of one orbital .",
    "* real - space methods allow for higher resolution in space without loss of efficiency .",
    "that is , they are readily adaptable and thus can handle problems with a wide range of length scales .",
    "* the eigenfunction constraint and subspace orthogonalization operations can be performed on coarse levels where the cost is very low .",
    "also , the effective potential can be updated on coarse levels leading to the possibility of complete solution in a single self - consistency cycle .",
    "these developments , along with the mesh - refinement techniques , will lead to reductions in computational cost of an order - of - magnitude compared with existing algorithms . *",
    "the flexibility of the representation has been utilized both in very high accuracy computations and in applications to large systems .",
    "the real - space methods do not suffer from linear dependence problems which occur in lcao methods .",
    "typically , the numerical convergence is controlled by a few parameters such as grid spacing , domain size , and order of the representation .",
    "* real - space algorithms very similar to those for electrostatics and ground - state electronic structure can be employed to solve time - dependent problems .    in the view of the author , the most promising areas for future work on real - space methods concern the development of highly _ adaptive _ and _ efficient _ numerical techniques which focus resolution in key regions of space as the iterative process moves towards the ground - state solution or evolves in real time .",
    "there will always exist a tradeoff between the simplicity of the representation ( where finite differences are best ) and the flexibility and accuracy of local basis functions ( where finite element methods are superior ) .",
    "the related local lcao methods allow for significantly smaller overall basis - set size in relation to real - space formulations , but the laplacian and hamiltonian operators are not as well structured and banded .",
    "the intersection between the simple structured approaches on the one hand and the more physical local bases on the other should provide for a fruitful growth of new ideas in computational materials science .",
    "multiscale methods for solving the problems will figure prominently since they allow for flexibility in the representation while maintaining high efficiency .",
    "a brief survey of physical and chemical problems which have already been addressed serves to illustrate the wide range of length scales accessible with real - space techniques : electrostatics of proteins interacting with nucleic acids , charged polymers in confined geometries , large - scale electronic structure of materials , and computation of spectroscopic quantities for large molecules in the gas phase .",
    "one can imagine a time in the not - too - distant future when it is possible to simulate the motion of a solute molecule in a liquid with the inclusion of all the electrons and model the solvent influence on the electronic absorption spectra .",
    "real - space methods possess many of the features that would be required to address such a challenging problem .",
    "i would like to thank matt challacombe , rob coalson , and john pask for helpful discussions , and victoria manea for a critical reading of the manuscript .",
    "i gratefully acknowledge the significant contributions from the members of my research group : karthik iyer , michael merrick , and jian wang .",
    "i especially thank achi brandt for his advice on multigrid methods .",
    "the research was partially supported by the national science foundation .",
    "as an example of the ease of generating a high - order form for the laplacian operator , the following mathematica script for the 10th - order case is included :              the weights obtained for the fd laplacian up through 12th order are presented in table ii . for the three - dimensional case ,",
    "the @xmath277th order approximation requires @xmath278 terms .",
    "hamming ( 1962 ) also discusses procedures for generating other high - order formulas such as interpolation and integration .",
    "abramowitz , m. , and i. a. stegun , 1964 , _ handbook of mathematical functions _ ( national bureau of standards , washington , dc ) .",
    "abou - elnour , a. , and k. schuenemann , 1993 , j. appl . phys . * 74 * , 3273 .",
    "ackermann , j. , b. erdmann , and r. roitzsch , 1994 , j. chem .",
    "* 101 * , 7643 .",
    "ackerman , j. , and r. roitzsch , 1993 , chem .",
    "lett . * 214 * , 109 .",
    "alavi , a. , j. kohanoff , m. parrinello , and d. frenkel , 1994 , phys .",
    "73 * , 2599 .",
    "alcouffe , r. e. , a. brandt , j. e. dendy , and j. w. painter , 1981 , siam j. sci .",
    "* 2 * , 430 .",
    "allen , m. p. , and d. j. tildesley , 1987 , _ computer simulation of liquids _",
    "( oxford , new york ) .",
    "ancilotto , f. , p. blandin , and f. toigo , 1999 , phys . rev .",
    "b * 59 * , 7868 .",
    "antosiewicz , j. , j. a. mccammon , and m. k. gilson , 1994 , j. mol . biol . * 238 * , 415 .",
    "antosiewicz , j. , j. a. mccammon , and m. k. gilson , 1996 , biochemistry * 35 * , 7819 .",
    "arias , t. a. , 1999 , rev .",
    "71 * , 267 .",
    "bai , d. , and a. brandt , 1987 , siam j. sci .",
    "* 8 * , 109 .",
    "baker , n. , m. holst , and f. wang , 1999 , j. comput .",
    "( submitted ) .",
    "banci , l. , and p. comba , 1997 , editors , _ molecular modeling and dynamics of bioinorganic systems _",
    "( kluwer , boston ) .",
    "baroni , s. , and p. giannozzi , 1992 , europhys . lett . * 17 * , 547 .",
    "batcho , p. f. , 1998 , phys .",
    "a * 57 * , 4246 .",
    "bauernschmitt , r. , and r. ahlrichs , 1996 , chem .",
    ". lett . * 256 * , 454 .",
    "beck , t. l. , 1997 , intl .",
    "j. quantum chem . * 65 * , 477 .",
    "beck , t. l. , 1999a , in _ simulation and theory of electrostatic interactions in solution _ , aip conference proceedings no . 492 , edited by g. hummer and l. r. pratt ( aip , new york ) .",
    "beck , t. l. , 1999b , j. comput .",
    "chem . * 20 * , 1731 .",
    "beck , t. l. , 2000 , in _ multiscale computational methods in chemistry and biology _ , edited by j. bernholc , k. binder , and a. brandt , nato proceedings of eilat workshop , in press .",
    "beck , t. l. , k. a. iyer , and m. p. merrick , 1997 , intl .",
    "j. quantum chem . * 61 * , 341 .",
    "becke , a. d. , 1989 , intl .",
    "j. quantum chem . : quantum chem . symp . * 23 * , 599 .",
    "bellaiche , l. , and k. kunc , 1997 , intl .",
    "j. quantum chem . * 61 * , 647 .",
    "ben - tal , n. , and r. d. coalson , 1994 , j. chem .",
    "* 101 * , 5148 .",
    "ben - tal , n. , b. honig , c. miller , and s. mclaughlin , 1997 , biophys .",
    "j. * 73 * , 1717 .",
    "bernholc , j. , 1999 , physics today , september issue , page 30 .",
    "bernholc , j. , e. l. briggs , d. j. sullivan , c. j. brabec , m. buongiorno nardelli , k. rapcewicz , c. roland , and m. wensell , 1997 , intl",
    ". j. quantum chem . * 65 * , 531 .",
    "bernholc , j. , j .- y .",
    "yi , and d. j. sullivan , 1991 , faraday disc .",
    "* 92 * , 217 .",
    "bicout , d. , and m. field , 1996 , editors , _ quantum mechanical simulation methods for studying biological systems _",
    "( springer , new york ) .",
    "booten , a. , and h. van der vorst , 1996 , computers in physics * 10 * , 239 .",
    "bowen , w. r. , and a. o. sharif , 1997 , j. coll .",
    "sci . * 187 * , 363 .",
    "bowler , d. r. , i. j. bush , and m. j. gillan , 1999 , preprint xxx.lanl.gov/abs/cond-mat/9902343 .",
    "submitted to intl . j.",
    "quantum chem .",
    "bowler , d. r. , and m. j. gillan , 1998 , comput .",
    ". commun . * 112 * , 103 .",
    "braess , d. , and r. verfurth , 1990 , siam j. numer .",
    "27 * , 979 .",
    "brandt , a. , 1977 , math .",
    "comput . * 31 * , 333 .",
    "brandt , a. , 1980 , in _ special topics of applied mathematics _",
    "j. frehse , d. pallaschke , and u. trottenberg ( north - holland , new york ) .",
    "brandt , a. , 1982 , in _ multigrid methods _ , edited by w. hackbusch and u. trottenberg ( springer - verlag , new york ) .",
    "brandt , a. , 1984 , _",
    "multigrid techniques : 1984 guide , with applications to fluid dynamics _ ; gmd - studien nr .",
    "85 ; available from gmd - aiw , postfach 1316 .",
    "d-53731 , st .",
    "augustin 1 , germany .",
    "brandt , a. , 1999 , _ multiscale scientific computation : six year research summary_. available at www.wisdom.weizmann.ac.il/@xmath279achi .",
    "brandt , a. , s. f. mccormick , and j. ruge , 1983 , siam j. sci .",
    "* 4 * , 244 .",
    "brenner , s. c. , and l. r. scott , 1994 , _ the mathematical theory of finite element methods _",
    "( springer , new york ) .",
    "briggs , e. l. , d. j. sullivan , and j. bernholc , 1995 , phys . rev .",
    "b * 52 * , r5471 .",
    "briggs , e. l. , d. j. sullivan , and j. bernholc , 1996 , phys .",
    "b * 54 * , 14362 .",
    "briggs , w. l. , 1987 , _ a multigrid tutorial _",
    "( siam books , philadelphia ) .",
    "car , r. , and m. parrinello , 1985 , phys .",
    "lett . * 55 * , 2471 .",
    "casida , m. e. , 1996 , in _ recent developments and applications of modern density functional theory _ , edited by j. m. seminario ( elsevier , new york ) .",
    "casida , m. e. , c. jamorski , k. c. casida , and d. r. salahub , 1998 , j. chem . phys . *",
    "108 * , 4439 .",
    "ceperley , d. m. , and b. j. alder , 1980 , phys . rev .",
    "* 45 * , 566 .",
    "challacombe , m. , 1999a , personal communication .",
    "challacombe , m. , 1999b , j. chem .",
    "phys . * 110 * , 2332 .",
    "challacombe , m. , 2000 , comput .",
    ", in press .",
    "challacombe , m. , and e. schwegler , 1997 , j. chem .",
    "phys . * 106 * , 5526 .",
    "challacombe , m. , e. schwegler , and j. almlf , 1996 , j. chem .",
    "phys . * 104 * , 4685 .",
    "challacombe , m. , c. white , and m. head - gordon , 1997 , j. chem .",
    "phys . * 107 * , 10131 .",
    "chelikowsky , j. r. , n. troullier , and y. saad , 1994 , phys .",
    "lett . * 72 * , 1240 .",
    "chelikowsky , j. r. , n. troullier , k. wu , and y. saad , 1994 , phys .",
    "b * 50 * , 11355 . chen , s. w. , and b. honig , 1997 , j. phys .",
    "b * 101 * , 9113 .",
    "cheng , h. , l. greengard , and v. rokhlin , 1999 , j. comput .",
    "phys . * 155 * , 468 .",
    "coalson , r. d. , and t. l. beck , 1998 , in _ encyclopedia of computational chemistry _ , edited by p. von rague schleyer , vol .",
    "3 , p. 2086",
    "( john - wiley , new york ) .",
    "coalson , r. d. , and a. duncan , 1992 , j. chem .",
    "phys . * 97 * , 5653 .",
    "coalson , r. d. , d. k. pant , and d. w. langer , 1994 , j. lightwave tech .",
    "* 12 * , 1015 .",
    "corry , b. , s. kuyucak , and s .- h .",
    "chung , 2000 , biophys .",
    "j. * 78 * , 2364 .",
    "cortis , c. m. , and r. a. friesner , 1997 , j. comput . chem .",
    "* 18 * , 1570 .",
    "costiner , s. , and s. taasan , 1995a , phys .",
    "e * 51 * , 3704 .",
    "costiner , s. , and s. taasan , 1995b , phys .",
    "e * 52 * , 1181 .",
    "darden , t. , d. york , and l. pedersen , 1993 , j. chem .",
    "* 98 * , 10089 .",
    "davis , m. e. , and j. a. mccammon , 1989 , j. comput . chem . * 10 * , 386 .",
    "davstad , k. , 1992 , j. comput . phys . *",
    "99 * , 33 .",
    "deconinck , h. , and c. hirsch , 1982 , in _ multigrid methods _ , edited by w. hackbusch and u. trottenberg ( springer - verlag , new york ) .",
    "deserno , j. , and c. holm , 1998 , j. chem . phys . *",
    "109 * , 7678 .",
    "duffy , m. g. , 1982 , siam j. numer .",
    "dsterhft , c. , d. heinemann , and d. kolb , 1998 , chem .",
    ". lett . * 296 * , 77 .",
    "essmann , u. , l. perera , m. l. berkowitz , t. darden , h. lee , and l. pedersen , 1995 , j. chem . phys . * 103 * , 8577 .",
    "ewald , p. , 1921",
    ", ann . phys . *",
    "64 * , 253 fattebert , j .- l . , 1999 , j. comput . phys . * 149 * , 75 .",
    "fattebert , j .- l . , and",
    "j. bernholc , 2000 , preprint .",
    "fisher , c. l. , j .- l .",
    "chen , j. li , d. bashford , and l. noodleman , 1996 , j. phys .",
    "chem . * 100 * , 13498 .",
    "flocard , h. , s. e. koonin , and m. s. weiss , 1978 , phys .",
    "c * 17 * , 1682 .",
    "fogolari , f. , and j. m. briggs , 1997 , chem .",
    ". letts . * 281 * , 135 .",
    "fushiki , m. , 1992 , j. chem .",
    "phys . * 97 * , 6700 .",
    "galli , g. , and m. parrinello , 1992 , phys .",
    "* 69 * , 3547 .",
    "goedecker , s. , 1999 , rev .",
    "phys . * 71 * , 1085 .",
    "goedecker , s. , and o. v. ivanov , 1998a , solid state commun .",
    "* 105 * , 665 .",
    "goedecker , s. , and o. v. ivanov , 1998b , computers in phys .",
    "* 12 * , 548 .",
    "goedecker , s. , m. teter , and j. hutter , 1996 , phys .",
    "b * 54 * , 1703 . golub , g. h. , and c. f. van loan , 1996 , _ matrix computations _ ( johns hopkins university , baltimore ) .",
    "goringe , c. m. , e. hernndez , m. j. gillan , and i. j. bush , 1997 , comput .",
    ". commun . * 102 * , 1 .",
    "greengard , l. , 1994 , science * 265 * , 909 .",
    "greengard , l. , and j .- y .",
    "lee , 1996 , j. comput . phys . *",
    "125 * , 415 .",
    "grinstein , f. f. , h. rabitz , and a. askar , 1983 , j. comput . phys . * 51 * , 423 .",
    "gross , e. k. u. , and r. m. dreizler , 1994 , editors , _ density functional theory _",
    "( plenum , new york ) . gross , e. k. u. , and w. kohn , 1990 , in _ advances in quantum chemistry : vol .",
    "21 _ , edited by s. b. trickey ( academic press , new york ) .",
    "guldbrand , l. , b. jnsson , h. wennerstrm , and p. linse , 1984 , j. phys . chem . * 80 * , 2221 .",
    "gupta , m. m. , j. kouatchou , and j. zhang , 1997 , j. comput .",
    "* 132 * , 226 .",
    "gygi , f. , 1993 , phys .",
    "b * 48 * , 11692 . gygi , f. , and g. galli , 1995 , phys .",
    "b * 52 * , r2229 .",
    "hackbusch , w. , 1985 , _ multigrid methods and applications _",
    "( springer - verlag , new york ) .",
    "hackel , s. , d. heinemann , d. kolb , and b. fricke , 1993 , chem .",
    ". lett . * 206 * , 91 .",
    "haggerty , l. , and a. m. lenhoff , 1991 , j. phys .",
    "chem . * 95 * , 1472 .",
    "hamilton , t. p. , and p. pulay , 1986 , j. chem .",
    "phys . * 84 * , 5728 .",
    "hamming , r. w. , 1962 , _ numerical methods for scientists and engineers _ ( dover , new york ) .",
    "hansen , j .-",
    "p . , and i. r. mcdonald , 1986 , _ theory of simple liquids _ ( academic press , new york ) .",
    "harris , f. e. , and h. j. monkhorst , 1970 , phys .",
    "b * 2 * , 4400 ; ( errata ) 1974 , * 9 * , 3946 .",
    "harris , r. a. , and l. r. pratt , 1985 , j. chem .",
    "phys . * 82 * , 856 .",
    "haynes , p. d. , and m. c. payne , 1997 , comput .",
    ". commun . *",
    "102 * , 17 .",
    "heinemann , d. , b. fricke , and d. kolb , 1988 , chem .",
    "145 * , 125 .",
    "heinemann , d. , d. kolb , and b. fricke , 1987 , chem .",
    ". lett . * 137 * , 180 .",
    "hernndez , e. , and m. gillan , 1995 , phys .",
    "b * 51 * , 10157 .",
    "hernndez , e. , m. j. gillan , and c. m. goringe , 1997 , phys .",
    "b * 55 * , 13485 .",
    "hierse , w. , and e. b. stechel , 1994 , phys . rev .",
    "b * 50 * , 17811 . hockney , r. w. , and j. w. eastwood , 1988 , _",
    "computer simulation using particles _",
    "( adam hilger , new york ) .",
    "hohenberg , p. , and w. kohn , 1964 , phys . rev . * 136 * , b864 .",
    "holst , m. j. , and f. saied , 1993 , j. comput . chem . * 14 * , 105 .",
    "holst , m. j. , and f. saied , 1995 , j. comput . chem . * 16 * , 337 .",
    "honig , b. , and a. nicholls , 1995 , science * 268 * , 1144 .",
    "hoshi , t. , m. arai , and t. fujiwara , 1995 , phys .",
    "b * 52 * , r5459 .",
    "hoshi , t. , and t. fujiwara , 1997 , j. phys .",
    ". jpn . * 66 * , 3710 .",
    "hummer , g. , and l. r. pratt , 1999 , editors , _ simulation and theory of electrostatic interactions in solution _ , aip conference proceedings no",
    ". 492 ( aip , new york ) .",
    "hutter , j. , h. p. lthi , and m. parrinello , 1994 , comput .",
    "* 2 * , 244 .",
    "ichimaru , s. , 1994 , _ statistical plasma physics volume ii : condensed plasmas _ ( addison - wesley , new york ) .",
    "ismail - beigi , s. , and t. arias , 1998 , phys .",
    "b * 57 * , 11923 .",
    "iyer , k. , m. p. merrick , and t. l. beck , 1995 , j. chem . phys . * 103 * , 227 .",
    "jamorski , c. , m. e. casida , and d. r. salahub , j. chem . phys . * 104 * , 5134 .",
    "jensen , f. , 1999 , _ introduction to computational chemistry _",
    "( wiley , new york ) . jing , x. , n. troullier , d. dean , n. binggeli , j. r. chelikowsky , k. wu , and y. saad , 1994 , phys . rev .",
    "b * 50 * , 12234 .",
    "kim , j. , f. mauri , and g. galli , 1995 , phys .",
    "b * 52 * , 1640 .",
    "kim , y .- h .",
    "lee , and r. m. martin , 1999 , preprint http://xxx.lanl.gov/abs/physics/9911031 .",
    "kim , y .- h . , m. stdele , and r. m. martin , 1999 , preprint xxx.lanl.gov/abs/physics/9909006 .",
    "kimball , g. e. , and g. h. shortley , 1934 , phys . rev . * 45 * , 815 .",
    "kirkwood , j. g. , 1934 , j. chem .",
    "* 2 * , 767 .",
    "kohn , w. , 1996 , phys .",
    "lett . * 76 * , 3168 .",
    "kohn , w. , and l. j. sham , 1965 , phys .",
    "rev . * 140 * , a1133 .",
    "kopylow , a. v. , d. heinemann , and d. kolb , 1998 , j. phys .",
    "b * 31 * , 4743 .",
    "kresse , g. , and j. furthmller , 1996 , phys .",
    "b * 54 * , 11169 . krieger , j. b. , y. li , and g. j. iafrate , 1992 , phys .",
    "a * 45 * , 101 .",
    "kurnikova , m. g. , r. d. coalson , and a. nitzan , 1999 , biophys .",
    "j. * 76 * , 642 .",
    "laaksonen , l. , d. sundholm , and p. pyykko , 1985 , intl .",
    "j. quantum chem . * 27 * , 601 .",
    "lee , i .- h . ,",
    "kim , and r. m. martin , 1999 , preprint http://xxx.lanl.gov/abs/physics/9911030 .",
    "leforestier , c. , r. h. bisseling , c. cerjan , m. d. feit , r. friesner , a. guldberg , a. hammerich , g. jolicard , w. karrlein , h .- d .",
    "meyer , n. lipkin , o. roncero , and r. kosloff , 1991 , j. comput .",
    "phys . * 94 * , 59 .",
    "lepaul , s. , a. de lustrac , and r. bouillault , 1996 , ieee trans . magn . * 32 * , 1018 .",
    "levin , f. s. , and j. shertzer , 1985 , phys .",
    "a * 32 * , 3285 .",
    "light , j. c. , i. p. hamilton , and j. v. lill , 1985 , j. chem .",
    "phys . * 82 * , 1400 .",
    "lippert , g. , j. hutter , and m. parrinello , 1997 , mol . phys .",
    "* 92 * , 477 .",
    "loeb , a. l. , 1951 , j. coll .",
    "* 6 * , 75 .",
    "lwen , h. , 1994 , j. chem .",
    "phys . * 100 * , 6738 .",
    "luty , b. a. , m. e. davis , and j. a. mccammon , 1992 , j. comput . chem . * 13 * , 1114 .",
    "mahan , g. d. , and k. r. subbaswamy , _ local density theory of polarizability _",
    "( plenum , new york , 1990 ) .",
    "marchioro , t. l. , m. arnold , d. k. hoffman , w. zhu , y. huang , and d. j. kouri , 1994 , phys .",
    "e * 50 * , 2320 .",
    "marcus , r. a. , 1955 , j. chem .",
    "* 23 * , 1057 .",
    "mauri , f. , and g. galli , 1994 , phys .",
    "b * 50 * , 4316 .",
    "mauri , f. , g. galli , and r. car , 1993 , phys .",
    "b * 47 * , 9973 . merrick , m. p. , k. a. iyer , and t. l. beck , 1995 , j. phys .",
    "chem . * 99 * , 12478 .",
    "merrick , m. p. , k. a. iyer , and t. l. beck , 1996 , in _ quantum mechanical simulation methods for studying biological systems _ , edited by d. bicout and m. field ( springer , new york ) .",
    "mermin , n. d. , 1965 , phys . rev . * 137 * , a1441 .",
    "millam , j. m. , and g. e. scuseria , 1997 , j. chem .",
    "phys . * 106 * , 5569 .",
    "misra , v. k. , j. l. hecht , k. a. sharp , r. a. friedman , and b. honig , 1994 , j. mol . biol . * 238 * , 264 .",
    "modine , n. a. , g. zumbach , and e. kaxiras , 1997 , phys .",
    "b * 55 * , 10289 .",
    "moncrieff , d. , and s. wilson , 1993 , chem .",
    ". lett . * 209 * , 423 .",
    "montoro , j. c. g. , and j. l. f. abascal , 1998 , j. chem . phys . * 109 * , 6200 .",
    "nicholls , a. , and b. honig , 1991 , j. comput .",
    "* 12 * , 435 .",
    "oberoi , h. , and n. m. allewell , 1993 , biophys .",
    "j. * 65 * , 48 .",
    "t , s. , j. r. chelikowsky , and s. g. louie , 1997 , phys .",
    "lett . * 79 * , 1770 .",
    "ono , t. , and k. hirose , 1999 , phys .",
    "lett . * 82 * , 5016 .",
    "onsager , l. , 1933 , chem . rev . * 13 * , 73 .",
    "ordejn , p. , d. a. drabold , r. m. martin , and m. p. grumbach , 1995 , phys .",
    "b * 51 * , 1456 .",
    "orszag , s. a. , 1972 , stud .",
    "appl . math . *",
    "51 * , 253 .",
    "parr , r. g. , and w. yang , 1989 , _ density functional theory of atoms and molecules _",
    "( oxford , oxford ) .",
    "pask , j. e. , 1999 , personal communication .",
    "pask , j. e. , b. m. klein , c. y. fong , and p. a. sterne , 1999 , phys .",
    "b * 59 * , 12352 .",
    "patra , c. n. , and a. yethiraj , 1999 , j. phys .",
    "b * 103 * , 6080 .",
    "pauling , l. , and e. b. wilson , 1935 , _ introduction to quantum mechanics _",
    "( dover , new york ) , p. 202 .",
    "payne , m. , m. teter , d. allan , t. arias , and j. joannopoulos , 1992 , rev .",
    "64 * , 1045 .",
    "prez - jord , j. m. , and w. yang , 1997 , j. chem . phys . * 107 * , 1218 .",
    "prez - jord , j. m. , and w. yang , 1998 , chem .",
    ". lett . * 282 * , 71 .",
    "petersilka , m. , u. j. gossmann , and e. k. u. gross , 1996 , phys .",
    "lett . * 76 * , 1212 .",
    "pettit , b. m. , and c. v. valdeavella , 1999 , in _ simulation and theory of electrostatic interactions in solution _ , aip conference proceedings no . 492 , edited by g. hummer and l. r. pratt ( aip , new york ) .",
    "pollock , e. l. , 1999 , in _ simulation and theory of electrostatic interactions in solution _ , aip conference proceedings no .",
    "492 , edited by l. r. pratt and g. hummer ( aip , new york ) .",
    "pollock , e. l. , and j. glosli , 1996 , comput .",
    ". commun . * 95 * , 93 .",
    "pratt , l. r. , g. j. tawa , g. hummer , a. e. garcia , and s. a. corcelli , 1997 , intl .",
    "j. quantum chem . * 64 * , 121 .",
    "press , w. h. , s. a. teukolsky , w. t. vetterling , and b. p. flannery , 1992 , _ numerical recipes in c : the art of scientific computing _",
    "( cambridge , new york ) .",
    "pulay , p. , 1969",
    "* 17 * , 197 .",
    "pulay , p. , 1980",
    ". lett . * 73 * , 393 .",
    "pulay , p. , 1982",
    ", j. comput",
    ". chem . * 3 * , 556 .",
    "reddy , b. d. , 1998 , _ introductory functional analysis with applications to boundary value problems and finite elements _ ( springer , new york ) .",
    "reiner , e. s. , and c. j. radke , 1990 , j. chem .",
    "faraday trans . *",
    "86 * , 3901 .",
    "rice , s. a. , 1959 , rev .",
    "phys . * 31 * , 69 .",
    "ringnalda , m. n. , m. belhadj , and r. a. friesner , 1990 , j. chem .",
    "phys . * 93 * , 3397 .",
    "rodriguez , j. h. , d. e. wheeler , and j. k. mccusker , 1998 , j. am .",
    "soc . * 120 * , 12051 .",
    "rowlinson , j. s. , and b. widom , 1982 , _ molecular theory of capillarity _",
    "( oxford , new york ) .",
    "sagui , c. , and t. a. darden , 1999 , in _ simulation and theory of electrostatic interactions in solution _ , aip conference proceedings no . 492 , edited by l. r. pratt and g. hummer ( aip , new york ) .",
    "snchez - portal , d. , p. ordejn , e. artacho , and j. m. soler , 1997 , intl . j. quantum chem . *",
    "65 * , 453 .",
    "sankey , o. f. , and d. j. niklewski , 1989 , phys .",
    "b * 40 * , 3979 .",
    "schneider , b. i. , and d. l. feder , 1999 , phys . rev .",
    "a * 59 * , 2232 .",
    "schwegler , e. , and m. challacombe , 1996 , j. chem .",
    "phys . * 105 * , 2726 .",
    "schwegler , e. , m. challacombe , and m. head - gordon , 1997 , j. chem .",
    "phys . * 106 * , 9708 .",
    "seminario , j. m. , 1996 , editor , _ recent developments and applications of modern density functional theory _",
    "( elsevier , new york ) .",
    "seitsonen , a. p. , m. j. puska , and r. m. nieminen , 1995 , phys .",
    "b * 51 * , 14057",
    ". sharp , k. a. , and b. honig , 1990a , annual rev .",
    "biophys . chem .",
    "* 19 * , 301 .",
    "sharp , k. a. , and b. honig , 1990b , j. phys .",
    "chem . * 94 * , 7684 .",
    "springborg , m. , 1997 , editor , _ density - functional methods in chemistry and materials science _",
    "( wiley , new york ) .",
    "sterne , p. a. , j. e. pask , and b. m. klein , 1999 , appl .",
    "sci . * 149 * , 238 .",
    "strain , m. c. , g. e. scuseria , and m. j. frisch , 1996 , science * 271 * , 51 .",
    "strang , g. , and g. j. fix , 1973 , _ an analysis of the finite element method _",
    "( prentice - hall , englewood cliffs ) .",
    "stratmann , r. e. , g. e. scuseria , and m. j. frisch , 1996 , chem .",
    ". lett . * 257 * , 213 .",
    "stben , k. , and u. trottenberg , 1982 , in _ multigrid methods _ , ed .",
    "w. hackbusch and u. trottenberg ( springer - verlag , new york ) .",
    "sugawara , m. , 1998 , chem .",
    ". lett . * 295 * , 423 .",
    "szabo , a. , and n. s. ostlund , 1989 , _ modern quantum chemistry _",
    "( mcgraw - hill , new york ) .",
    "talman , j. d. , and w. f. shadwich , 1976 , phys .",
    "a * 14 * , 36 .",
    "tassone , f. , f. mauri , and r. car , 1994 , phys .",
    "b * 50 * , 10561 .",
    "tomac , s. , and a. grslund , 1998 , j. comput . chem . * 19 * , 893 .",
    "tozer , d. j. , and n. c. handy , j. chem .",
    "phys . * 109 * , 10180 ( 1998 ) .",
    "troullier , n. , and j. l. martins , 1991a , phys .",
    "b * 43 * , 1993 .",
    "troullier , n. , and j. l. martins , 1991b , phys .",
    "b * 43 * , 8861 .",
    "tsonchev , s. , r. d. coalson , and a. duncan , 1999 , phys .",
    "e * 60 * , 4257 .",
    "tsuchida , e. , and m. tsukada , 1995 , phys .",
    "b * 52 * , 5573 .",
    "tsuchida , e. and m. tsukada , 1998 , j. phys .",
    ". jpn . * 67 * , 3844 .",
    "van gisbergen , s. j. a. , f. kootstra , p. r. t. schipper , o. v. gritsenko , j. g. shijders , and e. j. baerends , 1998 , phys .",
    "a * 57 * , 2556 .",
    "vanderbilt , d. , 1990 , phys .",
    "b * 41 * , 7892 . vasiliev , i. , s. t , and j. r. chelikowsky , 1997 , phys .",
    "lett . * 78 * , 4805 .",
    "vasiliev , i. , s. t , and j. r. chelikowsky , 1999 , phys .",
    "lett . * 82 * , 1919 .",
    "verwey , e. j. , and j. th .",
    "g. overbeek , 1948 , _ theory of the stability of lyophobic colloids _ ( elsevier , new york ) .",
    "vichnevetsky , r. , 1981 , _ computer methods for partial differential equations : volume i _",
    "( prentice - hall , englewood cliffs ) .",
    "vila , j. a. , d. r. ripoll , y. n. vorobjev , and h. a. scheraga , 1998 , j. phys .",
    "b * 102 * , 3065 .",
    "von rague schleyer , p. , 1998 , editor , _ encyclopedia of computational chemistry _ ( john - wiley , new york ) .",
    "vosko , s. h. , l. wilk , and m. nussair , 1980 , can .",
    "* 58 * , 1200 .",
    "walsh , a. m. , and r. d. coalson , 1994 , j. chem .",
    "phys . * 100 * , 1559 .",
    "wang , j. , and t. l. beck , 2000 , j. chem . phys . * 112 * , 9223 ( 2000 ) .",
    "wang , j. , and a. a. stuchebrukhov , 1999 , preprint .",
    "wesseling , p. , 1991",
    ", _ an introduction to multigrid methods _ ( john wiley , new york ) .",
    "white , c. a. , b. g. johnson , p. m. w. gill , and m. head - gordon , 1996 , chem .",
    ". lett . * 253 * , 268 .",
    "white , s. r. , j.w .",
    "wilkins , and m. p. teter , 1989 , phys .",
    "b * 39 * , 5819 .",
    "wilson , k. g. , 1990 , nucl .",
    "b ( proc . suppl . ) * 17 * , 82 .",
    "yabana , k. , and g. f. bertsch , 1996 , phys .",
    "b * 54 * , 4484 .",
    "yabana , k. , and g. f. bertsch , 1997 , z. phys .",
    "d * 42 * , 219 .",
    "yabana , k. , and g. f. bertsch , 1999 , intl .",
    "j. quantum chem . * 75 * , 55 .",
    "yoon , b. j. , and a. m. lenhoff , 1990 , j. comput .",
    "chem . * 11 * , 1080 .",
    "yoon , b. j. , and a. m. lenhoff , 1992 , j. phys .",
    "chem . * 96 * , 3130 .",
    "you , t. j. , and s. c. harvey , 1993 , j. comp .",
    "* 14 * , 484 .",
    "yu , h. , and a. d. bandrauk , 1995 , j. chem . phys . * 102 * , 1257 .",
    "yu , h. , a. d. bandrauk , and v. sonnad , 1994 , chem .",
    ". lett . * 222 * , 387 .",
    "zacharias , m. , b. a. luty , m. e. davis , and j. a. mccammon , 1992 , biophys . j. * 63 * , 1280 .",
    "zhang , j. , 1998 , j. comput .",
    "phys . * 143 * , 449 .",
    ".orbital energies for the oxygen dimer , from chelikowsky , troullier , wu , and saad ( 1994 ) .",
    "fd-12 refers to high - order fd calculations in a 12 au box .",
    "pw-12 and pw-24 refer to plane - wave calculations with supercells of 12 and 24 au on a side .",
    "energies are in ev . [ cols= \" < , > , > , > \" , ]"
  ],
  "abstract_text": [
    "<S> this review discusses progress in efficient solvers which have as their foundation a representation in real space , either through finite - difference or finite - element formulations . </S>",
    "<S> the relationship of real - space approaches to linear - scaling electrostatics and electronic structure methods is first discussed . </S>",
    "<S> then the basic aspects of real - space representations are presented . </S>",
    "<S> multigrid techniques for solving the discretized problems are covered ; these numerical schemes allow for highly efficient solution of the grid - based equations . </S>",
    "<S> applications to problems in electrostatics are discussed , in particular numerical solutions of poisson and poisson - boltzmann equations . </S>",
    "<S> next , methods for solving self - consistent eigenvalue problems in real space are presented ; these techniques have been extensively applied to solutions of the hartree - fock and kohn - sham equations of electronic structure , and to eigenvalue problems arising in semiconductor and polymer physics . </S>",
    "<S> finally , real - space methods have found recent application in computations of optical response and excited states in time - dependent density functional theory , and these computational developments are summarized . </S>",
    "<S> multiscale solvers are competitive with the most efficient available plane - wave techniques in terms of the number of self - consistency steps required to reach the ground state , and they require less work in each self - consistency update on a uniform grid . besides excellent efficiencies , the decided advantages of the real - space multiscale approach are 1 ) the near - locality of each function update , 2 ) the ability to handle global eigenfunction constraints and potential updates on coarse levels , and 3 ) the ability to incorporate adaptive local mesh refinements without loss of optimal multigrid efficiencies .    1.5 cm    to be published in reviews of modern physics . </S>"
  ]
}