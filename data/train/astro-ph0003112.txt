{
  "article_text": [
    "light from the night sky interferes with the analysis of the spectra of all but the brightest astronomical objects . for the determination of galaxy redshifts",
    "this limit was reached about forty years ago ( @xcite ) . with the advent of digital spectrographs ( e.g. @xcite , @xcite ) simultaneous measurement of",
    "object and night sky spectra became routine , thus allowing sky subtraction .",
    "the basic principle of sky subtraction has been that the sky spectrum should be observed in as identical a manner as possible ( in time , location on the sky , and optical path ) to the sky spectrum observed in the direction of the object . as ever fainter objects",
    "have been observed the accuracy of the sky subtraction has become more critical , and increasingly sophisticated methods , mechanical , observational , and algorithmic , have been employed to match the observed sky to the sky in front of the object . for wide field ,",
    "multiobject , fiber optic spectrographs this procedure has been especially problematic .",
    "@xcite review the problem of sky subtraction with fiber optic spectrographs in detail .",
    "in this paper we present a new method for removing the influence of the night sky emission from the spectra of faint astronomical objects ; this new method does not rely on the simultaneous measurement of the sky with the object .",
    "removing the sky from an object @xmath0 sky observation is equivalent to estimating the sky spectrum in the direction of the object at the time of observation .",
    "because the sky spectrum is composed of several components the first step in the estimation process must be to decide which of these components must be accurately estimated , and which can be .",
    "dark sky spectra may be characterized by a smooth continuum , plus weak absorption lines ( from the zodiacal light ) and a host of emission lines . for many projects involving multi - fiber spectroscopy of faint galaxies ( e.g. redshift surveys ) the continuum of the object",
    "is removed before the analysis ( @xcite , hereafter km98 ) ; in these instances it is not necessary to estimate the continuum of the sky separately ; it suffices to estimate the continuum of the object @xmath0 sky . additionally , some lines in the sky spectrum are so bright that errors in their estimation , which are large compared with typical features in the object spectra , are unavoidable",
    ".    our new method for sky subtraction begins by estimating and subtracting the sky @xmath0 object continuum ; this step removes typically more than 80%  of the sky flux , as well as the object s continuum .",
    "all through the sky subtraction process , we ignore pixels which correspond to the bright sky lines we choose not to estimate .",
    "next we fit the residual sky @xmath0 object spectrum with a two component eigenvector model ( section [ eigen ] ) of the continuum subtracted sky , and subtract this fit .",
    "figure [ pass1vec ] shows the two component sky model used in section [ test ] ; to first approximation the first vector represents the mean sky , and the second adjusts for the fluctuations in the oh lines .",
    "typically we remove more than 80%  of the flux in the residual sky spectrum with this step .",
    "the second order residual which results from these steps typically shows large ( wavelength ) scale variations due to errors in the continuum estimation . with",
    "most of the sky lines removed a second order continuum fit may be made , resulting in a reflattened ( @xcite ) residual sky spectrum .",
    "finally we fit a several component ( in section [ test ] we use ten ) eigenvector model of the reflattened residual sky spectrum , and subtract it .",
    "the residual from this last operation is the continuum subtracted object spectrum , along with any remaining noise and errors .",
    "eigenvector decomposition techniques ( e.g. @xcite , @xcite ) have long been used to classify astronomical objects .",
    "@xcite used principal component analysis ( pca ) to classify stars on the basis of multicolor photometry ; used pca to classify galaxies on the basis of their integrated properties ; and @xcite used pca to classify stars on the basis of their spectra . in these cases classification is exactly equivalent to fitting an eigenvector model to the data , with the addition that the resulting coefficient space is partitioned into classes .",
    "more recently several authors have used pca and singular value decomposition ( svd , a similar eigenvector technique , see the discussion in @xcite ) to classify stellar ( @xcite and references therein ) and galaxy ( @xcite and references therein ) spectra .    in this work",
    "we use svd to create two eigenvector models , first for the continuum subtracted sky spectra , and second for the residual reflattened sky spectra . to accomplish this task",
    "we begin with a set of well - observed sky spectra ( we typically use 500  1000 ) , which does not contain spectra with cosmic ray hits , bad focus , or other anomalies .",
    "we process these spectra so that each contains exactly the same number of counts on exactly the same wavelength scale .",
    "additionally in all of these steps we ignore the pixels corresponding to the sky lines we choose not to estimate , ( section [ test ] ) oii 5007 , nad , oii 6300 , and oii 6363 .",
    "next we subtract the continuum from each normalized sky spectrum using a high order ( @xmath140 ) spline fit .",
    "we decompose the continuum subtracted , normalized sky spectra into eigenvectors using svd ; the first two eigenvectors are our model for the continuum subtracted sky . note that higher order eigenvectors are contaminated by errors in the continuum fit .",
    "finally we fit the two component eigenvector model for the continuum subtracted sky to our set of normalized , continuum subtracted sky spectra , and subtract the fit ; then we reflatten the residual spectra using another high order spline fit .",
    "we then decompose the reflattened residual spectra using svd ; the resulting eigenvectors are our final model for the reflattened residual sky spectra .",
    "because of the reflattening , the principal eigenvectors in this final model do not show contamination by errors in the continuum estimation ; thus there is not an obvious cut - off point for the number of eigenvectors to use in the fits .",
    "this cut - off will vary from project to project and from observing protocol to observing protocol . in section [ test ]",
    "we use ten eigenvectors ; there is a clear change in slope in the log - singular - value vs. eigenvector - number diagram at the tenth eigenvector , indicating the transition from signal to noise .",
    "the purpose of our new sky subtraction method is to allow observations of fainter objects to be made with multi - object fiber - optic spectrographs , such as the 300 fiber hectospec ( @xcite , @xcite ) on the converted 6.5 m mmt .",
    "a typical operating mode for this instrument is that each half hour there would be three 10 minute exposures using the same fiber set - up ; the sets of three 10 minute spectra would be combined to remove cosmic rays and other shot noise . in this operating mode , with 10%  of the fibers devoted to sky observations , several hundred defect - free sky spectra would be observed per night .",
    "this instrument is not yet in operation ; here we therefore build sets of spectra for testing from the archive of spectra from the fast spectrograph ( @xcite ) .",
    "fast is a long slit spectrograph residing on the 1.5 m tillinghast telescope .",
    "we choose two datasets , the first of well observed dark skys , both to create the eigenvector models and to add to the object spectra , and the second a set of typical redshift survey spectra .    for the sky spectra we took all sky exposures ( exactly 1000 ) made between 21 jan 1999 and 27 dec 1999 where the exposure time was greater than 500 seconds , the sun was at least 30@xmath2 below the horizon , the moon was at least 20@xmath2 below the horizon , and the instrumental set - up was close to that standardly used in redshift surveys .",
    "we removed spectra which showed signs of anomalies , including cosmic rays or residual noise from uv flooding , for a final list of 924 sky spectra .",
    "the mean number of counts per 1.7  pixel in these spectra is 569 , with a factor of three variation about this value .",
    "we obtained these sky spectra from regions along the slit adjacent to the objects being observed ; they typically measured an area on the sky of 3@xmath3 @xmath4 30@xmath3 , which , for constant observing time , produce a flux about three times what we expect from a 1.5@xmath3 diameter fiber on the hectospec / mmt , after taking into account the 18.2 times larger collecting area of the mmt .",
    "the galaxy spectra are the set of all spectra from the 15r survey ( @xcite ) where the exposure time was greater than 500 seconds , the sun was at least 30@xmath2 below the horizon , the moon was at least 20@xmath2 below the horizon , and the redshifts were judged secure by s. tokarz following manual inspection .",
    "this dataset consists of 1648 spectra , of @xmath115th mag ( r ) galaxies , taken between 1994 and 1997 .",
    "we then put these spectra through a fully automatic redshift reduction ( km98 ) , and remove the 15 spectra where the fully automated result did not match the result confirmed by manual inspection ; typically this difference results from unremoved cosmic ray hits in the spectra .",
    "we further remove 110 spectra where the @xmath5 statistic ( a measure of quality of fit , @xcite ) is @xmath6 , the redshifts from absorption line spectra with @xmath7 are nearly always correct(km98 ) ; we routinely accept them without manual inspection .",
    "our final test set is 1523 typical redshift survey spectra ; each original spectrum is reducible fully automatically . the mean number of counts per 1.7  pixel in these spectra is 277 , the fluctuations about this value are about a factor of 1.5 .",
    "we take each of the 1523 galaxy spectra , and combine it with ten different sky spectra , which are created by summing between 1 and 10 randomly selected sky spectra .",
    "this procedure yields a sample of 15230 test spectra with sky to object flux ratios which vary by more than two orders of magnitude .",
    "each of these combined spectra then has the sky removed by the procedure described in section [ iter ] , and has its redshift determined by the automated methods of km98 .",
    "we compare these redshifts with those derived from the original reduction of the galaxy spectra ; a redshift is considered correct if it is within 300@xmath8 of the original value .",
    "figure [ all3 ] shows the fraction of correct redshifts obtained in this test as a function of the flux ratio between the object and the sky , expressed in magnitudes .",
    "this flux ratio refers to light entering the fiber , and is thus primarily a measure of the seeing convolved central surface brightness of the object with respect to the brightness of the dark sky .",
    "we divide the galaxy spectra into two subsamples : emission line dominated spectra , and absorption line dominated spectra .",
    "the solid lines marked em / abs represent spectra where the emission / absorption line template ( km98 ) obtained the higher @xmath5 value in the original reduction .",
    "emission line objects still give redshifts for objects about a magnitude fainter than absorption line objects , everything else being held constant .",
    "the dotted line between the em / abs lines is the total , and represents a typical mix of spectra for a magnitude limited redshift survey at redshift 0.05 transformed to fainter apparent magnitude .",
    "the absorption line redshifts are more than 95%  correct until the objects are 2 magnitudes fainter than the sky and more than 50%correct until the objects are 3.25 magnitudes fainter than the sky",
    ". the emission line spectra are more than 95%  correct until the objects are 2.5 magnitudes fainter than the sky , and 50%  correct until they are 4.4 magnitudes fainter than the dark sky .    to simulate the poisson limit we add noise to the original spectra corresponding to the poisson noise expected from the number of counts in the skies added to the spectra , using @xmath9 for each pixel and a gaussian random deviate generator .",
    "this procedure simulates perfect sky subtraction .",
    "we then put these spectra through the automated processing of km98 and obtain redshifts .",
    "figure [ noiseab ] shows the fraction with correct redshifts as a function of brightness ratio with the sky .",
    "the dotted line shows the fraction correct for the absorption line objects at the simulated poisson limit ( i.e. with perfect sky subtraction ) ; the solid line shows the absorption line result from figure [ all3 ] shifted 0.7 mag fainter ; the sky subtraction in this test came within 0.7 mag of matching the limiting magnitude imposed by poisson statistics .",
    "the plots for the emission line objects and the sum of all objects yield very similar results .",
    "figure [ demofig ] shows a typical absorption line spectrum at several stages in the test . on top ( [ demofig]a )",
    "is the original galaxy spectrum from the 15r survey , its correlation with our absorption line template gave an @xmath5 value of 7.6 ; below it ( [ demofig]b ) is that spectrum with the continuum subtracted .",
    "below that ( [ demofig]c ) is the sum of that spectrum and a sky spectrum which is the sum of seven original sky spectra , the object is 2.2 magnitudes fainter than the sky .",
    "the next figure ( [ demofig]d ) is the sky @xmath0 object with the bright sky lines and the continuum removed .",
    "second from the bottom ( [ demofig]e ) is the residual spectrum after the sky subtraction process , this spectrum yields the correct redshift with an @xmath5 value of 4.2 ; the bottom plot ( [ demofig]f ) shows the original spectrum in [ demofig]a with added random poisson noise corresponding to the number of sky photons in [ demofig]c , and after the continuum has been removed .",
    "this spectrum yields the correct redshift with an @xmath5 value of 6.1 .",
    "this paragraph will not be published .",
    "figure [ demo2 ] is similar to figure [ demofig ] , but shows a typical emission line spectrum .",
    "the initial correlation with the emission line template gave an @xmath5 value of 24.6 ; the object is 2.5 magnitudes fainter than the sky , and the residual spectrum ( [ demo2]e ) gave the correct redshift with and @xmath5 value of 18.3 , while the poisson limited noise spectrum ( [ demo2]f ) gave the correct redshift with an @xmath5 value of 17.9 .",
    "our new method for sky subtraction can remove the spectrum of the sky from faint redshift survey spectra with an efficiency within a factor of two of the poisson limit , and _ without any simultaneous measurement of the sky spectra_.    the sky spectra in the test were observed over one year , and contain larger variations than would be found in a few - night hectospec run .",
    "for example the principal eigenvector in the reflattened residual model has ni 5199  as its strongest feature ; this line was substantially stronger during two months of the early summer than at any other time .",
    "another eigenvector , which shows a solar ( zodiacal light ) spectrum , has a clear yearly variation .",
    "variations caused by changes in the instrument set - up , focus , or chip response ( we periodically uv flood ) will also affect the result .",
    "even with these added sources of variance we obtain very good results for absorption line spectra two magnitudes fainter than the sky , which if the mt .",
    "hopkins sky is v@xmath1021.46 mag / arcsec ( @xcite ) , and assuming a 1.5@xmath3 diameter fiber , corresponds to an object with a 1.5@xmath3 aperture magnitude in v of 22.8 ; to measure this would take about two hours of integration on the converted mmt .",
    "clearly the new techniques we have described can be combined with simultaneous sky measurements to achieve improved results .",
    "one approach might be to fit a continuum subtracted mean spectrum derived from the sky spectra in a single pointing ( either derived from the first eigenvector , or some other method of obtaining a robust estimate of the mean sky ) , then a fit to a set of reflattened residual eigenvectors , where the reflattened residual model is derived from a much larger set of reflattened residual sky spectra , perhaps those observed during an observing run .",
    "this procedure would , in the first pass , save for the continuum subtraction and the details of the fitting , mimic current methods for simultaneous sky estimation .",
    "the second - pass fit with the reflattened residual model would allow subtraction of correlated small amplitude sky flickering in the sky lines , and systematic effects such as due to bending of the fibers .    with this combination of methods we expect that sky subtraction , save for the unremovable poisson noise component , will not be a dominant limitation in deep observations with multi - object fiber optic spectrographs ."
  ],
  "abstract_text": [
    "<S> we develop a new method for estimating and removing the spectrum of the sky from deep spectroscopic observations ; our method does not rely on simultaneous measurement of the sky spectrum with the object spectrum . </S>",
    "<S> the technique is based on the iterative subtraction of continuum estimates and eigenvector sky models derived from singular value decompositions ( svd ) of sky spectra , and sky spectra residuals . using simulated data derived from small telescope observations </S>",
    "<S> we demonstrate that the method is effective for faint objects on large telescopes . </S>",
    "<S> we discuss simple methods to combine our new technique with the simultaneous measurement of sky to obtain sky subtraction very near the poisson limit .    </S>",
    "<S> accepted for publication in the astrophysical journal ( letters ) 2000 march 7 . </S>"
  ]
}