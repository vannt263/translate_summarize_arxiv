{
  "article_text": [
    "we consider the _ cubic nonlinear schrdinger _ equation @xmath0 in the defocusing ( @xmath1 ) or focusing case ( @xmath2 ) .",
    "we impose periodic boundary conditions in arbitrary spatial dimension @xmath3 : the spatial variable @xmath4 belongs to the @xmath5-dimensional torus @xmath6 .",
    "this nonlinear schrdinger equation has a class of simple solutions , the _ plane wave solutions _",
    "@xmath7 for @xmath8 , @xmath9 and @xmath10 , where @xmath11 and @xmath12 .",
    "a natural question is whether these plane wave solutions   are stable under small perturbations of the initial value . in this context",
    "it is common knowledge that a _ linear stability analysis _",
    ", where one examines the eigenvalues of the linearization of the nonlinear schrdinger equation   around a plane wave , leads to the condition @xmath13 for ( linear ) stability , see for instance ( * ? ? ?",
    "since nonlinear effects are ignored , the validity of such a linear stability analysis is inherently restricted to a short time interval .",
    "stability and instability on long time intervals of plane waves in the exact solution is discussed in the recent papers @xcite and @xcite , respectively .",
    "of particular importance for the present paper is @xcite , where orbital stability over long times is shown for perturbations in high - order sobolev spaces .",
    "orbital stability means that the solution stays close to the orbit .    from the viewpoint of numerical analysis",
    ", it is of interest whether ( and if so why ) a numerical method shares the stability or instability of the exact solution near plane waves .",
    "this is the topic of the present paper",
    ".    this problem can be traced back to the seminal paper @xcite by weideman & herbst from 1986 . in that paper ,",
    "conditions on the discretization parameters for various numerical methods are derived that ensure that the numerical solution shares the _ linear stability _ of the exact solution .",
    "this is done by examining the eigenvalues of the linearization around a plane wave of a numerical method applied to  .",
    "such a linear stability analysis has recently been extended to different numerical methods @xcite .    in the present paper , we take up this line of research .",
    "in contrast to previous work @xcite , however , we are interested in the _ long - time behaviour _ of a numerical method near plane waves , and hence a linear stability analysis is of limited use .",
    "we pursue the question as to whether the remarkably stable behaviour on long time intervals of the exact solution near plane waves  @xcite is shared by one of the most popular numerical methods for the nonlinear schrdinger equation , the _ split - step fourier method _  @xcite .",
    "this method combines a fourier collocation in space with a strang splitting in time , see subsect .",
    "[ subsec - method ] .",
    "it integrates plane wave solutions   exactly .",
    "our main result states that the long - time orbital stability of the exact solution near plane waves transfers to the numerical solution , see subsect .",
    "[ subsec - mainresult ] for a precise statement . in the case of a spatially constant plane wave ( @xmath14 in ) , the case considered by weideman & herbst @xcite",
    ", it is further shown that the assumptions of this main result essentially hold under a cfl condition on the discretization parameters , see subsect .",
    "[ subsec - discassum ] .",
    "the long - time stability result of the present paper deals with the _ completely resonant _",
    "equation  : the eigenvalues ( frequencies ) of the linear part of the equation are @xmath15 , @xmath16 , whose integer linear combinations may vanish identically .",
    "this is in marked contrast to previous long - time stability results for numerical discretizations of nonlinear hamiltonian partial differential equations that consider non - resonant situations .",
    "see @xcite for the split - step fourier method applied to the nonlinear schrdinger equation , where is considered with an additional ( generic but artificial ) convolution term @xmath17 in order to have non - resonant frequencies .",
    "another feature of the result in the present paper is that it covers a much larger class of _ initial values that are not small _ than the aforementioned previous stability results that all deal with small initial values .",
    "the proof of our stability result is given in sects .",
    "[ sec - trf][sec - nonres ] .",
    "we first eliminate , in sect .",
    "[ sec - trf ] , the principal fourier mode from the numerical scheme with a sequence of transformations and reductions .",
    "the resulting system of equations has small initial values .",
    "this enables us to use the technique of modulated fourier expansions for its long - time analysis , see sect .",
    "[ sec - mfe ] .",
    "it is likely that normal form techniques in the spirit of @xcite would lead to similar conclusions , but we have not worked out the details . in order to obtain results that are valid on long time intervals ,",
    "the frequencies have to satisfy a certain non - resonance condition .",
    "in fact , the completely resonant frequencies of the nonlinear schrdinger equation are modified during the transformations of sect .",
    "[ sec - trf ] , and we are able to verify a non - resonance condition for the new frequencies in the final sect .",
    "[ sec - nonres ] .",
    "we discretize the nonlinear schrdinger equation with the split - step fourier method as introduced in @xcite . in this method ,",
    "the equation is discretized in space by a spectral collocation method and in time by a splitting integrator .    *",
    "discretization in space . * for the discretization in space we make the ansatz @xmath18 with the spatial discretization parameter @xmath19 . for fixed @xmath20",
    ", @xmath21 is a _",
    "trigonometric polynomial _ which is uniquely determined by its values in the collocation points @xmath22 , @xmath23 . requiring that the ansatz @xmath24 fulfills the nonlinear schrdinger equation in the collocation points leads to the equation @xmath25 where the trigonometric interpolation @xmath26 ( with respect to the spatial variable @xmath4 ) of a function @xmath27 is the uniquely determined trigonometric polynomial that interpolates @xmath28 in the collocation points .",
    "this trigonometric interpolation is given by @xmath29 where the congruence modulo @xmath30 has to be understood entrywise .    * discretization in time .",
    "* equation is then discretized in time by a splitting integrator with time step - size @xmath31 . for this purpose we split in its linear and its nonlinear part , @xmath32 denoting by @xmath33 and @xmath34 the flows over a time @xmath31 of these equations ,",
    "we compute approximations @xmath35 to @xmath36 at discrete times @xmath37 by    [ eq - splitting ] @xmath38 the initial value @xmath39 is chosen as @xmath40    equations provide a fully discrete scheme for the numerical solution of the nonlinear schrdinger equation , the _ split - step fourier method_. since its introduction in @xcite it has become a widely used and well analysed method , see for example @xcite and references therein .    * computational aspects . * in",
    ", both flows @xmath33 and @xmath34 can be computed exactly in an efficient way .",
    "the flow of the linear equation is given in terms of the fourier coefficients @xmath41 of a trigonometric polynomial @xmath42 by @xmath43 thus , it can be computed easily in terms of these fourier coefficients . on the other hand ,",
    "the flow of the nonlinear equation is given by @xmath44 i.e. , @xmath45 for all @xmath23 .",
    "this is easy to compute in terms of the function values in the collocation points .",
    "note that the fast fourier transform provides an efficient tool to switch from fourier coefficients to function values in the collocation points and vice - versa .",
    "the computational cost per time step is thus of order @xmath46 .    * plane waves in the split - step fourier method . *",
    "the split - step fourier method has _",
    "plane wave solutions _",
    "@xmath47 with @xmath10 and @xmath48 . in other words ,",
    "the plane wave solutions @xmath49 of the nonlinear schrdinger equation are integrated exactly by the split - step fourier method if @xmath48 .",
    "it is the stability of these plane wave solutions under perturbations of the initial value that we are interested in .      for the study of the stability of plane wave solutions , with fixed vector @xmath48 , we impose the following assumptions ( with constants that do not depend on the discretization parameters @xmath31 and @xmath19 ) .",
    "[ assum - linearstability ] we assume that the time step - size @xmath31 and the spatial discretization parameter @xmath19 fulfill together with @xmath50 ( which will be chosen later as the @xmath51-norm of the initial value ) @xmath52 with a positive constant @xmath53 , where @xmath54    assumption  [ assum - linearstability ] ensures that the _ frequencies _ @xmath55 are well defined for all @xmath56 .",
    "these frequencies show up after a linearization of the split - step fourier method around a plane wave .",
    "this linearization has eigenvalues @xmath57 , see sect .",
    "[ sec - trf ] .    as a second assumption",
    "we need a _ non - resonance condition_. ideally we would like to impose this condition directly on the frequencies @xmath58 .",
    "for the verification of the non - resonance condition , however , it turns out to be appropriate to consider modifications of these frequencies .",
    "[ assum - nonres ] we assume that the time step - size @xmath31 , the spatial discretization parameter @xmath19 and @xmath50 are chosen such that there exist _ modified frequencies _ @xmath59 , @xmath56 , with the following properties for some @xmath60 :    \\(a ) the modified frequencies are close to the frequencies @xmath58 , @xmath61 with a small parameter @xmath62 .",
    "\\(b ) there exist positive constants @xmath63 , @xmath64 and @xmath65 such that the following holds for all vectors @xmath66 of integers with @xmath67 and with @xmath68 only if @xmath69 for all indices @xmath70 with @xmath71 : if @xmath72 then for all @xmath73 satisfying @xmath74 , @xmath75    \\(c ) complete resonances among the modified frequencies , i.e. , @xmath76 for a vector @xmath77 of integers with @xmath78 , can only occur if @xmath79    under these assumptions we will prove the following main result . here",
    "we denote , for a trigonometric polynomial @xmath80 , by @xmath81 its sobolev @xmath82-norm .",
    "we further denote by @xmath83 the same function with the @xmath84th fourier coefficient set to zero , followed by a shift of fourier coefficients by @xmath84 and a trigonometric interpolation .",
    "note that @xmath85 measures the size of those fourier coefficients whose subscript differs from @xmath84 modulo  @xmath30 .",
    "[ thm - main ] fix an index @xmath48 , an integer @xmath60 and positive numbers @xmath53 , @xmath63 , @xmath65 , @xmath64 and @xmath86 .",
    "there exist @xmath87 and @xmath88 such that for every @xmath89 there exists @xmath90 such that the following holds : if the time step - size @xmath31 , the spatial discretization parameter @xmath19 and @xmath91 fulfill assumptions  [ assum - linearstability ] and [ assum - nonres ] with some @xmath92 ( and with the prescribed constants @xmath53 , @xmath63 , @xmath65 , @xmath64 ) , then for every initial value @xmath39 with @xmath93 we have the long - time stability estimate @xmath94    the proof of this theorem will be given in sects .",
    "[ sec - trf][sec - mfe ] .",
    "theorem  [ thm - main ] states that  under suitable assumptions  initial values that are close to a plane wave lead to numerical solutions that remain close to a plane wave for a long time , i.e. , the numerical solution is concentrated in a single fourier mode over long times .",
    "the closeness is measured by the sobolev @xmath82-norm of @xmath95 .",
    "this implies long - time _ orbital stability _ in @xmath82 , i.e. , the numerical solution stays close to the orbit , see ( * ? ? ?",
    "* subsect .",
    "the bounds @xmath87 , @xmath88 and @xmath96 are independent of the discretization parameters @xmath31 and @xmath19 subject to assumptions 1 and 2 and of the small parameters @xmath97 and @xmath62 . in more detail ,",
    "the proof of theorem  [ thm - main ] shows that @xmath87 depends only on @xmath5 and @xmath65 ; @xmath88 depends only on @xmath53 and @xmath86 ; and @xmath96 depends on @xmath53 , @xmath63 , @xmath5 , @xmath84 , @xmath98 , @xmath99 , @xmath65 , @xmath64 and @xmath86 .",
    "the conclusion of theorem  [ thm - main ] equally holds if the ( lie - trotter ) splitting is replaced by its symmetric version , the _ strang splitting _ @xmath100 in fact , both numerical schemes differ only by half a time step with the linear flow at the beginning and at the end of the interval of integration .",
    "this does not affect the long - time stability .",
    "the same remark applies to the other version of the strang splitting , @xmath101      assumptions  [ assum - linearstability ] and [ assum - nonres ] for theorem  [ thm - main ] exclude two different types of ( potential ) instabilities that show up on different time scales .",
    "assumption  [ assum - linearstability ] , which is derived in ( * ? ? ?",
    "* sect .  5 ) and @xcite with a slightly different meaning of @xmath102 , ensures that ( numerical ) plane wave solutions are _ linearly stable_. this means that all eigenvalues of the linearization of the numerical scheme around a plane wave are of modulus one .",
    "eigenvalues of modulus larger than one would lead to an instability right from the start .",
    "in contrast , the non - resonance condition of assumption  [ assum - nonres ] on the frequencies is crucial for the proof of our _ long - time _ result .",
    "indeed , the longer the time interval under consideration is , the more the nonlinear interaction becomes relevant , possibly leading to resonance phenomena if the frequencies are resonant or close to resonant .",
    "a non - resonance condition as stated in assumption  [ assum - nonres ] is typically required in a long - time analysis of hamiltonian partial differential equations and their numerical discretizations , see for example @xcite for uses and discussions of similar conditions .",
    "note , however , that we do not ( and can not ) impose this non - resonance condition on the completely resonant frequencies of the nonlinear schrdinger equation and its discretization by the split - step fourier method , but only on the frequencies @xmath58 of for the linearization around a plane wave .    in sect .",
    "[ sec - nonres ] we will prove the following theorem on a sufficient ( though not necessary ) condition under which assumptions  [ assum - linearstability ] and [ assum - nonres ] hold in the case of a constant plane wave ( @xmath14 ) for many values of @xmath103 and @xmath31 .",
    "[ thm - main2 ] let @xmath14 , and fix @xmath104 with @xmath105 @xmath106 and @xmath60 .",
    "then we have the following result .    for every @xmath107 there exists a subset @xmath108 of @xmath109\\times[0,h_0]$ ] of lebesgue measure @xmath110 such that assumptions  [ assum - linearstability ] and  [ assum - nonres ] hold for all @xmath111 and",
    "all @xmath19 that satisfy the restriction @xmath112 with small parameter @xmath113 and constants @xmath114 , @xmath115 , @xmath116 , @xmath117 and @xmath118 .",
    "theorem  [ thm - main ] together with theorem  [ thm - main2 ] is the discrete counterpart of ( * ? ? ?",
    "* theorem  1.1 ) : for @xmath14 , the long - time orbital stability of plane waves proven there for the exact solution transfers to the numerical discretization provided that the step - size restriction is fulfilled and that @xmath103 and @xmath31 belong to a large set . in comparison with the result ( * ? ? ?",
    "* theorem  1.1 ) for the exact solution , our discrete counterpart is valid on a time interval of length @xmath119 instead of @xmath120 , and the value of @xmath98 is restricted by the step - size restriction  .",
    "these changes are due to the non - resonance condition that is much more involved for the numerical frequencies than for the analytical frequencies .",
    "let us finally comment on condition   in theorem  [ thm - main2 ] .",
    "this condition ensures linear stability of ( analytical ) plane wave solutions to the nonlinear schrdinger equation , i.e. , that all eigenvalues of the linearization of the nonlinear schrdinger equation around a plane wave are real valued @xcite .",
    "theorem  [ thm - main2 ] states in particular that this implies linear stability of ( numerical ) plane wave solutions ( in assumption  [ assum - linearstability ] ) under the step - size restriction  .",
    "actually , weaker step - size restrictions that yield linear stability are discussed in detail in ( * ? ? ?",
    "* sect .  5 ) , but is sufficient for our long - time result because it allows us to verify assumption  [ assum - nonres ] .",
    "on the other hand , reduces to ( with @xmath121 ) in the limit @xmath122 for fixed @xmath19 .    for nonzero but small @xmath84",
    ", the condition of linear stability in assumption  [ assum - linearstability ] can still be expected to hold under a step - size restriction similar to . in this case , the frequencies @xmath58 differ from those for @xmath14 only for large @xmath123 ( we have @xmath124 and @xmath125 for all @xmath123 that are not large , and we have @xmath126 for large @xmath123 ) .",
    "this property can also be used to argue that the non - resonance condition of assumption  [ assum - nonres ] can be expected to hold for nonzero but small @xmath84 , see remark  [ rem - lne0 ] in sect .",
    "[ sec - nonres ] .",
    "in one dimension ( @xmath127 ) , the linear stability of the split - step fourier method for @xmath128 has been recently analysed in detail by lakoba @xcite .",
    "we present numerical experiments which illustrate theorem  [ thm - main ] in situations that are not covered by theorem  [ thm - main2 ] .",
    "they show in particular that the conditions of theorem  [ thm - main2 ] are not necessary for the assumptions and conclusions of theorem  [ thm - main ] to hold .    throughout",
    ", we let @xmath2 and @xmath129 such that @xmath130 , and hence we have linear stability of plane waves in the exact solution .",
    "we consider the nonlinear schrdinger equation in dimension one ( @xmath127 ) with an initial value that is chosen randomly such that for @xmath14 , @xmath131 and @xmath132 @xmath133",
    "i.e. , the initial value is , in the @xmath134 norm , up to @xmath135 close to the constant plane wave  @xmath102 .    for the numerical discretization with the split - step fourier method we use @xmath136 points for the fourier collocation in space ( @xmath137 ) , and we consider three different step - sizes for the discretization in time : the step - size @xmath138 that does not fulfill the step - size restriction   of theorem  [ thm - main2 ] and the slightly larger step - sizes @xmath139 and @xmath140 .",
    "we have checked numerically for @xmath138 and @xmath140 that assumptions  [ assum - linearstability ] and assumption  [ assum - nonres ] of theorem  [ thm - main ] are fulfilled for @xmath141 with @xmath142 , @xmath143 , @xmath144 , @xmath145 and @xmath146 for @xmath138 and @xmath147 for @xmath140 .",
    "note , however , that the step - size restriction   of theorem  [ thm - main2 ] is not fulfilled . for figure  [ fig - exp1 ]",
    "we compute the numerical solution with step - size @xmath138 on a long time interval @xmath148 and plot the absolute values of the fourier coefficients on two subintervals of length @xmath149 . the same is done in figure  [ fig - exp2 ] with the step - size @xmath140 . as stated in theorem  [ thm - main ] we observe in both cases that the solution stays concentrated in the @xmath84th fourier mode over long times .",
    ".,title=\"fig : \" ] .,title=\"fig : \" ]    .,title=\"fig : \" ] .,title=\"fig : \" ]    for the intermediate step size @xmath139 , however , assumption  [ assum - linearstability ] of theorem  [ thm - main ] is not fulfilled . in figure",
    "[ fig - exp3 ] we again plot the absolute values of the fourier coefficients of the numerical solution and clearly observe an instability .    . ]",
    "from now on we omit the index @xmath19 of the numerical solution @xmath150 , @xmath151 . instead , we denote by @xmath152 the @xmath123th fourier coefficient of @xmath153 : @xmath154 .",
    "we work with the numerical scheme   in terms of these fourier coefficients , which takes the form ( see and ) @xmath155    the goal of this section is to eliminate the @xmath84th fourier mode , which is not small , from @xmath153 . to this end",
    "we apply similar reductions and transformations to those for the exact solution in ( * ? ? ?",
    "2 ) , which can be summarised as follows .",
    "* transformation @xmath156 with @xmath157 , @xmath158 : shift to the case @xmath14 , see subsect .",
    "[ subsec - var - v ] .",
    "* transformation @xmath159 with @xmath160 and @xmath161 : introduction of polar coordinates @xmath162 for @xmath163 and rotations @xmath164 of @xmath165 , see subsect .  [ subsec - var - wz ] .",
    "* reduction @xmath166 : elimination of @xmath167 and @xmath168 using conservation of mass and gauge invariance , see subsect .",
    "[ subsec - var - wz ] .",
    "* transformation @xmath169 with @xmath170 : diagonalization of the linear part , see subsects .",
    "[ subsec - numfrequ][subsec - var - xi ] .",
    "these transformations and reductions are applied directly to the numerical scheme in the form  . in subsect .",
    "[ subsec - splitstruc - exact ] , we consider them from a different perspective , namely from the perspective of the differential equations that form the two steps of the splitting integrator  . both perspectives will be important in the following sect .  [ sec - mfe ] .",
    "we introduce new variables @xmath171 the numerical scheme in the new variables @xmath172 becomes @xmath173      we introduce polar coordinates @xmath162 for @xmath163 , @xmath174 and new variables @xmath164 , @xmath175 , by @xmath176 in these new variables @xmath177 with @xmath178 the numerical scheme becomes @xmath179 where we use the convention @xmath180 .",
    "now , we eliminate @xmath167 and @xmath168 from . for the elimination of @xmath167",
    "we observe that the split - step fourier method conserves mass , @xmath181 a fact that can be easily derived from the representations and of the flows composing the numerical scheme and the discrete parseval identity @xmath182 .",
    "the conservation of mass allows us to express @xmath183 in terms of @xmath184 , @xmath56 , and @xmath185 , @xmath186 also the factor @xmath187 in can be expressed in terms of @xmath164 using for @xmath188 : @xmath189 hence , @xmath190 and @xmath191 are determined by @xmath164 , @xmath56 .",
    "the numerical scheme is therefore completely described by the reduced set of variables @xmath192 .",
    "now , we can replace @xmath193 in and by .",
    "furthermore , we can use with @xmath194 instead of @xmath195 and @xmath196 replaced by to replace @xmath197 in . for sufficiently small @xmath198",
    "this leads , after a taylor expansion of @xmath199 , to an equation for @xmath200 of the following form ( with right - hand side depending only on @xmath201 ) : @xmath202 the subscripts here and in the following all belong to the reduced set @xmath203 .",
    "the linear part in equation couples @xmath164 to @xmath204 .",
    "this leads us to consider the equation for @xmath164 together with the one for @xmath204 , @xmath205 with the matrix @xmath206 where @xmath207 this matrix has @xmath208 and its eigenvalues are @xmath209 the reason for including @xmath210 in the definition of the eigenvalues @xmath211 will become clear in the following subsect .",
    "[ subsec - var - xi ] .",
    "assumption  [ assum - linearstability ] ensures that @xmath212 , and hence the eigenvalues @xmath213 of @xmath214 are of modulus one : we have @xmath215 with the _ numerical frequencies _",
    "@xmath58 from , @xmath216 where the branch of @xmath217 with values in @xmath218 $ ] is used . note that eigenvalues of @xmath219 of modulus greater than one would lead to a growth of the corresponding modes in the linearization of .",
    "assumption  [ assum - linearstability ] excludes this scenario and thus ensures linear stability of the split - step fourier method .",
    "we introduce new variables @xmath220 that diagonalize the linear part of : @xmath221 where , with the notation of the previous subsection , @xmath222 such that @xmath223 note that @xmath224 and hence this change of variables , which defines @xmath220 and @xmath225 , is well defined because of the structure of @xmath226 ( this is the reason for including the sign of @xmath227 in the definition of the numerical frequencies ) .",
    "moreover , it is symplectic since @xmath228 . with this change of variables ,",
    "is transformed to @xmath229      recall that in the original variables @xmath28 @xmath230 see equation  .",
    "here , @xmath231 is the flow at time @xmath31 of the hamiltonian differential equation with hamiltonian function @xmath232 , @xmath233 correspondingly , @xmath234 is the flow at time @xmath31 of the hamiltonian differential equation with hamiltonian function @xmath235 , @xmath236 now , we consider the transformations @xmath237 from the previous subsections on the level of these differential equations ( instead of their flows , as we have done in the previous subsections )",
    ".    * shift @xmath156 . * after the change of variables @xmath156 described in subsect .",
    "[ subsec - var - v ] ( leading to the numerical scheme  ) the splitting scheme becomes @xmath238 with the hamiltonian functions @xmath239 and @xmath240    * transformation @xmath159 . * in the variables @xmath177 introduced at the beginning of subsect .",
    "[ subsec - var - wz ] ( leading to the numerical scheme  ) , the flow of the hamiltonian differential equation with hamiltonian function @xmath241 has to be replaced by the flow of @xmath242 the corresponding equation for @xmath243 becomes , after taking the real part , @xmath244 correspondingly , the flow of the hamiltonian differential equation with hamiltonian function @xmath245 has to be replaced by the flow of @xmath246 note that the function @xmath247 is actually independent of @xmath168 ( gauge invariance ) .",
    "the equation for @xmath243 becomes , after taking the real part , @xmath248    * reduction @xmath249 . * solving for @xmath250 and inserting this into the equations for @xmath251 shows that becomes , in the reduced set of variables @xmath198 from subsect .",
    "[ subsec - var - wz ] ( with the numerical scheme  ) , @xmath252 solving for @xmath250 and inserting this into the equations for @xmath251 yields @xmath253 using @xmath254 with @xmath167 given by , we see that the equation   becomes , in the reduced set of variables @xmath198 from subsect .",
    "[ subsec - var - wz ] ( with the numerical scheme  ) , @xmath255 which surprisingly is again of hamiltonian form .",
    "we hence have @xmath256 the splitting integrator in the reduced set of variables @xmath198 is still a hamiltonian splitting , a splitting into two hamiltonian equations .",
    "* transformation @xmath257 . * concerning the final change of variables @xmath258 of subsect .",
    "[ subsec - var - xi ] ( leading to the numerical scheme  ) we note first that the matrix @xmath226 was chosen in such a way that it is symplectic .",
    "we therefore end up with    [ eq - split - diffeq ] @xmath259 with @xmath260    while it is an obvious observation that the numerical scheme in the new variables @xmath261 is still a splitting scheme , it is highly remarkable that the split equations retain their hamiltonian structure .    by virtue of the expansion",
    ", we have a concrete expression for the flow @xmath262 , @xmath263 for later purposes we also introduce an expansion @xmath264 of the hamiltonian function @xmath265 .",
    "we derive some bounds for the change of variables @xmath266 described in subsects .",
    "[ subsec - var - v][subsec - var - xi ] .",
    "we assume throughout that assumption  [ assum - linearstability ] is fulfilled .",
    "note that @xmath267 for @xmath56 , and hence we first consider the last transformation @xmath258 of subsect .",
    "[ subsec - var - xi ] described by the matrices @xmath226 .",
    "[ lemma - sj ] the absolute values of the entries of the matrices @xmath226 and @xmath268 are bounded by @xmath269 , independently of @xmath123 and @xmath31 .    with the notations of subsect .",
    "[ subsec - numfrequ ] we have by   @xmath270 this proves the statement of the lemma since @xmath271 and since @xmath272 by assumption  [ assum - linearstability ] .",
    "now we consider the norm @xmath273 i.e. , @xmath274 is the sobolev @xmath82 norm of the function @xmath275 as introduced in subsect .",
    "[ subsec - mainresult ] .",
    "the previous lemma  [ lemma - sj ] implies the following result .",
    "[ lemma - norm - equivalent ] for the change of variables @xmath266 there exist positive constants @xmath276 and @xmath277 depending only on @xmath53 and an upper bound of @xmath102 such that @xmath278    in particular , the previous lemma shows that the condition @xmath279 of theorem  [ thm - main ] becomes in the new variables @xmath261",
    "@xmath280    we finally collect some estimates for the nonlinearity in the numerical scheme written in the new variables @xmath261 as given by .",
    "[ lemma - nonlinearity ] the nonlinearity given by the coefficients @xmath281 in satisfies for @xmath282 @xmath283 for vectors @xmath284 .",
    "the constants @xmath285 depend only on @xmath286 , @xmath287 , @xmath99 , @xmath53 and @xmath102 and satisfy @xmath288 for some positive constants @xmath289 and @xmath88 depending only on @xmath53 , @xmath99 and @xmath290 .",
    "\\(a ) by carefully going through the construction of the coefficients @xmath281 in subsects .",
    "[ subsec - var - wz ] and  [ subsec - var - xi ] one shows for the coefficients @xmath281 that there exists a constant @xmath88 depending on @xmath53 and @xmath102 such that @xmath291 for all @xmath56 , all @xmath292 and all @xmath293 .",
    "\\(b ) the first estimate of the lemma follows by applying   and the cauchy - schwarz inequality and by using @xmath294 with a constant @xmath295 depending only on @xmath282 .",
    "the second estimate of the lemma then follows also from  .",
    "in this section we will prove theorem  [ thm - main ] using _ modulated fourier expansions _ originally introduced in @xcite , see also @xcite . throughout",
    "we will work with the numerical scheme in the new variables @xmath261 introduced in sect .",
    "[ sec - trf ] , see .",
    "there are two main steps :    * construction of a short - time approximation of @xmath296 from by a modulated fourier expansion in subsects .",
    "[ subsec - mfe][subsec - defect ] . *",
    "almost - invariants of the modulated fourier expansion that allow us to prove a result on a long time interval in subsects .",
    "[ subsec - splitstruc - mfe][subsec - longtimenearcons ] .    for the first main step it is convenient to work with the numerical scheme as given by the composition of flows ,",
    "whereas for the derivation of the almost - invariants it is necessary to switch to the level of the differential equations whose flows compose the numerical scheme  .",
    "we ultimately show that @xmath297 stays of order @xmath97 for initial values @xmath298 of order @xmath97 .",
    "this preservation of smallness and regularity of @xmath296 is the main ingredient for the final proof of theorem  [ thm - main ] in subsect .",
    "[ subsec - proof1 ] .",
    "the proof via modulated fourier expansions given here uses and combines ideas from several previous proofs using such expansions : the aforementioned idea of switching between the flows and the differential equations is loosely based on @xcite , the construction of the modulated fourier expansion with an asymptotic expansion is based on @xcite , the idea of using modified frequencies @xmath59 instead of the original ( numerical ) frequencies @xmath58 of for the modulated fourier expansion is also used in @xcite , the non - resonance condition in assumption  [ assum - nonres ] is used in a similar way to @xcite , and the use of almost - invariants of the modulated fourier expansion to prove long - time almost - conservation properties can be traced back to @xcite .    in the following analysis , the ( generic ) constants @xmath88 , @xmath87 and @xmath299 are all independent of the small parameters @xmath97 from and @xmath62 from assumption  [ assum - nonres ] . the constants @xmath88 and @xmath299 will depend on the constants @xmath53 , @xmath63 , @xmath65 , @xmath64 and @xmath98 of assumptions  [ assum - linearstability ] and [ assum - nonres ] , on @xmath99 from , on an upper bound of @xmath300 , on the index @xmath48 from   and on the dimension @xmath5 .",
    "the constant @xmath87 will depend only on @xmath5 and @xmath65 .      in order to motivate the modulated fourier expansion we consider here ,",
    "let us first have a look at in the linear case ( all @xmath301 ) . in this case",
    ", the evolution of the @xmath123th mode is given by the multiplication with @xmath302 .",
    "in the presence of the nonlinearity , we seek for an expansion , the modulated fourier expansion , in terms of products of these exponentials that are multiplied ( modulated ) by slowly varying coefficients .",
    "there are two pitfalls in the present situation that have to be handled with care .",
    "first , it turns out that the frequencies @xmath58 of are inconvenient when it comes to resonance issues .",
    "therefore we use the modified frequencies @xmath59 of assumption  [ assum - nonres ] instead and consider products of the exponentials @xmath303 : @xmath304 for vectors of integers @xmath305 and the vector @xmath306 of modified frequencies .",
    "second , the modified frequencies @xmath59 of assumption  [ assum - nonres ] are by definition exactly resonant , for instance @xmath307 for @xmath308 in the case @xmath14 .",
    "hence , we can not distinguish all products @xmath309 , and we therefore introduce the _ resonance module _",
    "@xmath310 where @xmath311 the restriction @xmath312 in the definition of the resonance module comes from the fact that the products @xmath309 are attached to some specific mode @xmath220 , namely @xmath313 , as we will see in the following .    with these preliminaries",
    ", we introduce the _ resonant modulated fourier expansion _",
    "@xmath314 } z_j^{[{\\mathbf{k}}]}({\\delta}t ) { \\mathrm{e}}^{- { \\mathrm{i}}({\\mathbf{k}}\\cdot{\\boldsymbol{{\\varpi } } } ) t}\\ ] ] here , @xmath315 is a small parameter and the sum is over all residue classes @xmath316\\in{\\mathbb{z}}^{\\mathcal{z}}/ { \\mathcal{m}}$ ] .",
    "the coefficients of the modulated fourier expansion , the _ modulation functions _",
    "@xmath317}$ ] , are required to be polynomials on a slow time scale @xmath318 with @xmath319 from that have all derivatives bounded independently of the small parameters . by a slight abuse of notation we write in the following @xmath320 instead of @xmath317}$ ] and",
    "@xmath321 instead of @xmath322}$ ] .",
    "requiring @xmath323 for @xmath324 with @xmath325 given by yields , after a comparison of the coefficients of @xmath326 , _ modulation equations _ for the modulation functions @xmath320 :    [ eq - modsystem ] @xmath327}}\\\\ & \\sum_{k\\in{\\mathcal{z}}^m,\\ , l\\in{\\mathcal{z}}^{m ' } } h q_{j , k , l } z_{k^1}^{{\\mathbf{k}}^1}({\\tau } ) \\dotsm z_{k^m}^{{\\mathbf{k}}^m}({\\tau } ) \\overline{z}_{l^1}^{{\\mathbf{l}}^1}({\\tau})\\dotsm \\overline{z}_{l^{m'}}^{{\\mathbf{l}}^{m'}}({\\tau } ) .",
    "\\end{split}\\ ] ] the condition @xmath328 yields @xmath329    for the approximate solution of the modulation equations   it is useful to expand the modulation functions in powers of @xmath97 and @xmath319 , @xmath330 with polynomials @xmath331 in @xmath332 .",
    "we call the functions @xmath331 _ modulation coefficient functions _ and set @xmath333 for @xmath334 .",
    "after dividing by @xmath335 , expanding @xmath336 around @xmath337 and ( formally ) comparing the coefficients of @xmath338 , the modulation equations become    [ eq - modsys ] @xmath339 } } \\\\ & \\qquad\\qquad\\qquad\\qquad   \\sum_{k\\in{\\mathcal{z}}^m,\\ , l\\in{\\mathcal{z}}^{m ' } } { \\mathrm{e}}^{{\\mathrm{i}}({\\mathbf{k}}\\cdot{\\boldsymbol{{\\varpi } } } ) h } q_{j , k , l } z_{k^1,p_1}^{{\\mathbf{k}}^1 } \\dotsm z_{k^m , p_m}^{{\\mathbf{k}}^m } \\overline{z}_{l^1,q_1}^{{\\mathbf{l}}^1}\\dotsm \\overline{z}_{l^{m'},q_{m'}}^{{\\mathbf{l}}^{m'}}. \\end{split}\\ ] ] condition yields @xmath340 where @xmath341 denotes the @xmath123th unit vector in @xmath342 .",
    "we construct modulation functions @xmath320 that solve the modulation equations up to a small defect .",
    "we work with the asymptotic expansion   and consider the equations  .",
    "the crucial observation is that the right - hand side of depends only on modulation coefficient functions @xmath343 with @xmath344 .",
    "this allows us to solve the equations up to a small defect by the following simple recursion .",
    "fix @xmath345 and assume that we have computed all modulation coefficient functions @xmath346 with @xmath344 ( this is true for @xmath347 ) .",
    "equation is then of the form @xmath348 with a polynomial @xmath265 .",
    "the unique polynomial solution of this equation is given for @xmath349 by @xmath350 we therefore compute @xmath331 for all @xmath123 and all @xmath351 as follows .",
    "[ eq - construction ]    1 .   for indices",
    "@xmath352 with @xmath353 or @xmath354 for all @xmath355 $ ] we set @xmath356 this is consistent with since the right - hand side of this equation vanishes for these indices by induction ( recall that @xmath301 if @xmath357 ) .",
    "2 .   for indices",
    "@xmath352 with @xmath358 that are not covered by ( i ) we @xmath359 indeed , the factor in front of @xmath331 in is bounded for these indices away from zero , and the comparison of coefficients used to derive thus makes sense .",
    "3 .   for indices",
    "@xmath360 that are neither covered by ( i ) nor by ( ii ) we set @xmath361 of course , this introduces a defect which , however , can be controlled using the non - resonance condition of assumption  [ assum - nonres ] as we shall see in subsect .",
    "[ subsec - defect ] .",
    "+ for the considered indices @xmath352 we have @xmath362 , and they are in this sense close to a resonance .",
    "we therefore call them _ near - resonant _ in the following .",
    "4 .   having computed @xmath331 for all @xmath123 and all @xmath363 in ( i)(iii ) we can @xmath364 moreover , since the factor in front of @xmath331 in vanishes for @xmath365 , we can @xmath366 this allows us to compute the diagonal modulation coefficient functions @xmath367 .",
    "we stop the above construction of modulation coefficient function @xmath331 after @xmath368 , @xmath369    it is clear that the construction leads to modulation coefficient functions @xmath331 that are polynomials in @xmath337 , of degree bounded by @xmath370 .",
    "moreover , we have @xmath371 because the right - hand side of vanishes for @xmath347 .",
    "we estimate the modulation coefficient functions constructed in . for fixed index @xmath370",
    "we collect them in the vectors @xmath372 we also consider their rescalings @xmath373 } \\bigl ( 2^{{\\lvert\\widetilde{{\\mathbf{k}}}\\rvert } } \\prod_{l\\in{\\mathcal{z } } } { \\lvertl\\rvert}^{{\\lvert\\widetilde{k}_l\\rvert } } \\bigr)\\ ] ] and with @xmath374 such that lemma  [ lemma - nonlinearity ] is applicable for @xmath99 and @xmath375 .    for vectors @xmath376 of polynomials",
    "@xmath377 in @xmath337 we use the norm @xmath378 where @xmath379    [ lemma - size ] the modulation coefficient functions satisfy on @xmath380 for @xmath381 and @xmath382 @xmath383 for all @xmath370 with constants @xmath88 and @xmath299 .",
    "this follows from the recursive construction : the property @xmath384 together with lemma  [ lemma - nonlinearity ] yields inductively an estimate of the nonlinearity on the right - hand side of in the norm @xmath385 ( note that terms in the nonlinearity with @xmath386 vanish , and hence the sum over @xmath286 and @xmath287 is finite ) .",
    "then , the property @xmath387 allows us to estimate the norm @xmath385 for the vector consisting of modulation coefficient functions constructed with . for the remaining nonzero modulation coefficient functions constructed with  , the estimate in the norm @xmath385 then follows using the smallness of the initial value and the property @xmath388 .    for the estimate of the rescaling @xmath389 in the norm",
    "@xmath390 we can use essentially the same argument : we just have to take into account that @xmath391 and that @xmath392 .",
    "the latter follows from @xmath393 for @xmath394 $ ] and @xmath56 .",
    "the modulation functions constructed in via their modulation coefficient functions are supposed to fulfill the modulation system  . however , there are two sources of error in their construction : first , we stopped the construction of modulation coefficient functions @xmath395 after @xmath368 .",
    "second , the modulation functions for near - resonant indices @xmath352 were set to zero . in other words ,",
    "the constructed modulation functions satisfy the equations of motion   of the modulation system only up to a defect , @xmath396}}\\\\ & \\qquad\\qquad\\qquad\\qquad\\qquad\\qquad \\sum_{k\\in{\\mathcal{z}}^m,\\ , l\\in{\\mathcal{z}}^{m ' } } h q_{j , k , l } z_{k^1}^{{\\mathbf{k}}^1 } \\dotsm z_{k^m}^{{\\mathbf{k}}^m } \\overline{z}_{l^1}^{{\\mathbf{l}}^1 } \\dotsm \\overline{z}_{l^{m'}}^{{\\mathbf{l}}^{m ' } } , \\end{split}\\ ] ] whereas the initial condition   is met exactly .",
    "here , @xmath397 denotes the defect from the cut - off  , i.e. , @xmath398 where @xmath399 is the right - hand side of . the defect in near - resonant indices that is not yet covered by @xmath400 is denoted by @xmath401 , i.e. , @xmath402 is different from zero only for near - resonant indices and in this case @xmath403 ( recall that @xmath404 for @xmath347 . )",
    "both defects are estimated in the following lemma .",
    "[ lemma - defect ] the defects ",
    "satisfy on @xmath380 for @xmath381 and @xmath89 @xmath405 with constants @xmath88 , @xmath87 and @xmath299 .",
    "\\(a ) for the bound of @xmath400 , we note that by lemmas  [ lemma - nonlinearity ] and  [ lemma - size ] @xmath406 where @xmath407 denotes the constant of lemma  [ lemma - size ] . splitting the sum over @xmath286 and @xmath287 in a part with @xmath408 and another part with @xmath409",
    "proves the claimed estimate of @xmath400 using the second part of lemma  [ lemma - nonlinearity ] for the sum with @xmath409 and sufficiently small @xmath319 .",
    "the estimates of @xmath410 and @xmath411 follow similarly .",
    "\\(b ) concerning the defect @xmath412 in near - resonant indices , we note that for those indices @xmath352",
    "@xmath413 by assumption  [ assum - nonres ] and for @xmath414 .",
    "the non - resonance condition of assumption  [ assum - nonres ] ( used with @xmath415 in place of @xmath351 ) thus implies @xmath416 for @xmath417 .",
    "this shows that @xmath418 and the claimed estimate of @xmath412 follows from lemma  [ lemma - size ] .",
    "now , we study the difference @xmath419 of the numerical solution @xmath296 of and its modulated fourier expansion @xmath420 of . in this modulated fourier expansion @xmath420 of we use the modulation functions constructed in at discrete times @xmath421 .",
    "[ prop - error ] we have for @xmath381 and @xmath89 @xmath422 with constants @xmath88 , @xmath87 and @xmath299 .",
    "\\(a ) from lemma  [ lemma - size ] we know for the modulated fourier expansion the estimate @xmath423    \\(b ) a corresponding estimate holds , for sufficiently small @xmath97 , also for the numerical solution : @xmath424 with @xmath276 from , since by lemma  [ lemma - nonlinearity ] and induction @xmath425 for @xmath426 with @xmath88 and @xmath289 from lemma  [ lemma - nonlinearity ] .",
    "we may assume without loss of generality that the constant @xmath88 from ( a ) is larger than @xmath427 .",
    "\\(c ) the modulated fourier expansion satisfies by @xmath428 subtracting the numerical solution @xmath429 of and using ( a ) , ( b ) , lemma  [ lemma - nonlinearity ] and lemma  [ lemma - defect ] shows that for @xmath430 and for sufficiently small @xmath97 @xmath431 the claimed estimate follows inductively .      in the previous subsections ,",
    "a modulated fourier expansion was constructed and analysed based on the representation of the numerical scheme , i.e. , based on flows of differential equations . recall that we have derived in subsect .",
    "[ subsec - splitstruc - exact ] differential equations ( hamiltonian functions ) that underly the flows that compose the numerical scheme . in this subsection",
    ", we will derive corresponding differential equations for the modulated fourier expansion .    motivated by , we denote by @xmath432 the flow at time @xmath31 of the hamiltonian differential equation @xmath433 with hamiltonian function @xmath434 correspondingly",
    ", we denote by @xmath435 the flow at time @xmath31 of the hamiltonian differential equation with hamiltonian function @xmath436 compare .",
    "the splitting structure of the modulation system for the modulation functions @xmath437 is revealed in the following lemma : advancing the modulation functions by @xmath438 corresponds , up to a small defect , to solving hamiltonian differential equations with hamiltonian functions @xmath439 and @xmath440 one after another .",
    "[ lemma - splittingmfe ] we have @xmath441 with the defects @xmath400 and @xmath412 of  and where @xmath442 .    let @xmath443 be the expansion of the flow @xmath444 given by .",
    "then one verifies that the flow @xmath445 is given by the same coefficients @xmath446 , @xmath447 } } p_{j , k , l } z_{k^1}^{{\\mathbf{k}}^1}\\dotsm z_{k^m}^{{\\mathbf{k}}^m } \\overline{z}_{l^1}^{{\\mathbf{l}}^1}\\dotsm\\overline{z}_{l^{m'}}^{{\\mathbf{l}}^{m'}}.\\ ] ] this implies that also the coefficients of the expansions of @xmath448 and @xmath449 coincide .",
    "the coefficients in the expansion of @xmath448 are given by , and they also appear in the expansion of @xmath450 .",
    "the statement of the lemma follows .",
    "an essential property of modulated fourier expansions is the existence of formal invariants .",
    "these invariants will finally allow us to consider long time intervals by patching together many of the short time intervals considered so far .",
    "they take the form @xmath451 this is well defined ( recall that the @xmath321 stands for the sum over the equivalence classes @xmath316\\in{\\mathbb{z}}^{\\mathcal{z}}/{\\mathcal{m}}$ ] ) since @xmath452 for @xmath453 by part ( c ) of assumption  [ assum - nonres ] .",
    "[ lemma - invariant ] we have @xmath454    let @xmath455 be defined by @xmath456 for @xmath457 .",
    "the hamiltonian function @xmath440 from the previous subsection is invariant under the transformations @xmath455 , and this leads to conserved quantities by noether s theorem : we have along a solution @xmath458 of the hamiltonian differential equation with hamiltonian function @xmath440 @xmath459 this implies conservation of @xmath460 along the flow of @xmath440 , @xmath461 in the same way , one shows conservation of @xmath460 along the flow of @xmath439 , and the statement of the lemma follows .    in the end , we are interested more in @xmath462 than in @xmath463 .",
    "the following lemma shows that @xmath460 is an almost - invariant along the modulation functions  @xmath437 .",
    "[ prop - almostinvariants ] we have for @xmath381 and @xmath89 @xmath464 with constants @xmath88 , @xmath87 and @xmath299 .    throughout the proof , we work with the representative @xmath351 of @xmath316 $ ] for which the minimum in the definition   of @xmath465 is attained .",
    "\\(a ) by lemma  [ lemma - splittingmfe ] and lemma  [ lemma - invariant ] we have @xmath466 since @xmath467 if @xmath468 . here , the modulation functions @xmath320 on the right - hand side are evaluated at time @xmath469 and the defects @xmath470 and @xmath471 at time @xmath472 .",
    "\\(b ) let @xmath473 and @xmath474 , and let @xmath475 be the index of largest norm @xmath476 with @xmath477 .",
    "then we have @xmath478 indeed , if @xmath479 , then necessarily @xmath480 and @xmath481 for all @xmath482 with @xmath483 , and hence @xmath484 i.e. , @xmath485 .",
    "this implies for @xmath486 that @xmath487 the last estimate improves for near - resonant indices ( for which @xmath468 ) by the non - resonance condition in assumption  [ assum - nonres ] to @xmath488 if @xmath489 .",
    "\\(c ) by ( a ) , ( b ) , the cauchy - schwarz inequality and lemma  [ lemma - nj ] below we have @xmath490 the statement of the proposition thus follows from lemma  [ lemma - size ] and lemma  [ lemma - defect ] by summing up .",
    "[ lemma - nj ] we have @xmath491 with a positive constant @xmath88 depending only on @xmath84 .",
    "we have @xmath492 since @xmath493 , and hence @xmath494 . to get a lower bound for @xmath495 we note that @xmath496 , and hence @xmath497 this holds not only for the first component , and we get by summing up all components @xmath498 we therefore get @xmath499 for @xmath500 .",
    "for @xmath501 we have @xmath502 .",
    "next we show that the almost - invariants @xmath460 of are close to the _ super - actions _ @xmath503 that collect those _ actions _",
    "@xmath504 with the same value @xmath505 .",
    "[ prop - actionsinvariants ] we have for @xmath381 and @xmath89 @xmath506 with constants @xmath88 , @xmath87 and @xmath299 .",
    "we omit the argument @xmath507 of the modulation functions .",
    "we have by @xmath508 and part ( b ) of the proof of proposition  [ prop - almostinvariants ] together with lemma  [ lemma - size ] , lemma  [ lemma - nj ] and implies @xmath509 on the other hand , we have for the modulated fourier expansions @xmath420 @xmath510 and hence by the cauchy - schwarz inequality together with lemma  [ lemma - size ] , lemma  [ lemma - nj ] and @xmath511 finally , we have by proposition  [ prop - error ] and lemma  [ lemma - nj ] for the numerical solution @xmath296 @xmath512 where we have used that @xmath513 . putting all this together",
    "proves the statement of the proposition .",
    "all estimates of the previous subsections are valid on the time interval @xmath514 .",
    "we assume without loss of generality that @xmath515 for some @xmath516 .",
    "in this subsection , we consider consecutive short time intervals @xmath517 in principle , we can repeat the construction of a modulated fourier expansion described in subsects .",
    "[ subsec - modequations][subsec - constr ] on these time intervals , taking @xmath518 as initial value instead of @xmath298 .",
    "this gives us modulation functions @xmath519 on the @xmath520th time interval constructed in such a way that @xmath521    the estimates of subsects .",
    "[ subsec - size][subsec - invariants ] remain valid provided that @xmath518 satisfies a smallness condition as @xmath298 . in the following lemma , we bound the difference of the modulated fourier expansions @xmath519 and @xmath522 at the interface @xmath523 of their intervals of validity .",
    "[ lemma - interface ] assume that for @xmath524 @xmath525 then we have for @xmath381 and @xmath89 @xmath526 with constants @xmath88 , @xmath87 and @xmath299 .",
    "let @xmath527 .",
    "\\(a ) we first show by induction on @xmath528 that @xmath529 where @xmath530 .",
    "for this purpose we split the modulation functions , @xmath531 with @xmath532 and @xmath533 for @xmath363 .",
    "we consider the nonlinearities @xmath534 and @xmath535 on the right - hand sides of . by lemma  [ lemma - nonlinearity ] and lemma  [ lemma - size ] we have @xmath536 and hence by construction and @xmath537    in order to complete the inductive proof of",
    ", we need a similar estimate also for @xmath538 .",
    "note that by construction of @xmath539 @xmath540 with @xmath541 by proposition  [ prop - error ] ( applied on the @xmath542th interval with modulation functions @xmath543 truncated after @xmath544 instead of @xmath368 as in  ) .",
    "this shows that @xmath545 and hence by   @xmath546 this completes the proof of  .",
    "\\(b ) in order to prove the statement of the lemma , we have to consider @xmath547 instead of @xmath548 .",
    "note that @xmath549 and that the estimates   transfer to @xmath550 by  .",
    "this finishes the proof of the lemma .    the following proposition bounds , in the situation of the above lemma , the difference of the almost - invariants @xmath460 at the interface of two time intervals .",
    "[ prop - diffinvariants ] assume that for @xmath524 @xmath525 then we have for @xmath381 and @xmath89 @xmath551 with constants @xmath88 , @xmath87 and @xmath299 .",
    "this follows using part ( b ) of the proof of proposition  [ prop - almostinvariants ] , the cauchy - schwarz inequality and the estimates of lemma  [ lemma - size ] , lemma  [ lemma - nj ] and lemma  [ lemma - interface ] .",
    "we put the results of all previous subsections together to show near - conservation of the super - actions on _ long _ time intervals of length @xmath552 .",
    "[ thm - superactions ] the super - actions are nearly conserved for @xmath381 and @xmath89 : @xmath553 with constants @xmath88 , @xmath87 and @xmath299 .",
    "let @xmath554 be the maximum of the constant of proposition  [ prop - diffinvariants ] and the constants that appear in propositions  [ prop - almostinvariants ] and  [ prop - actionsinvariants ] if @xmath555 in is replaced by @xmath556 .    with this constant @xmath88",
    ", we prove the theorem for @xmath557 and @xmath558 by induction on @xmath520 .",
    "the main observation is that for @xmath557 and with @xmath559 as in   @xmath560 after multiplying by @xmath561 and summing over @xmath457 we can apply propositions  [ prop - almostinvariants ] , [ prop - actionsinvariants ] and [ prop - diffinvariants ] to the different terms in , since , in case @xmath524 , the induction hypothesis implies for @xmath562 @xmath563 provided that @xmath564 with the constant @xmath565 of lemma  [ lemma - nj ] .",
    "this gives @xmath566 the statement of the theorem follows for @xmath567 , i.e. , @xmath568 .      in order to complete the proof of theorem  [ thm - main ] ,",
    "we go in a final step back from the new variables @xmath261 introduced in sect .",
    "[ sec - trf ] to the original variables @xmath28 , in which the split - step fourier method is formulated . under the conditions and with the constant @xmath88 of theorem  [ thm - superactions ] , we have for @xmath569 and @xmath564 @xmath570 with the constant @xmath565 of lemma  [ lemma - nj ] . by lemma [ lemma - norm - equivalent ] , this transfers to a statement in the original variables , @xmath571 as claimed in theorem  [ thm - main ] .",
    "in this section , we give the proof of theorem  [ thm - main2 ] on a sufficient condition under which assumptions  [ assum - linearstability ] and [ assum - nonres ] in theorem  [ thm - main ] hold .",
    "the first subsection deals with the ( numerical ) linear stability of assumption  [ assum - linearstability ] , while the remaining main part of this section is devoted to the non - resonance condition of assumption  [ assum - nonres ] .",
    "[ lemma - stab - numericalvsanalytical ] under the step - size restriction the condition of analytical linear stability implies the condition of numerical linear stability for @xmath575 with @xmath114 .",
    "moreover , @xmath576 with @xmath577          now , we turn to assumption  [ assum - nonres ] , again for @xmath14 .",
    "we begin by constructing the modified frequencies .",
    "the reason , why we use modified frequencies in the theory developed in the present paper , is that it seems to be very hard to verify the non - resonance condition in part ( b ) of assumption  [ assum - nonres ] directly for the frequencies @xmath58 of .",
    "for the frequencies that show up after the linearization of the nonlinear schrdinger equation itself around a plane wave , however , a suitable non - resonance condition can be established , see  ( * ? ? ?",
    "* lemma  2.2 ) .",
    "these frequencies are @xmath584 , and we therefore seek modified frequencies of a similar form .",
    "we fix @xmath104 with and @xmath31 and @xmath19 with for some @xmath60 as in theorem  [ thm - main2 ] . the frequencies @xmath58 of",
    "are considered henceforth as functions of @xmath585 with @xmath586 : @xmath587 ( note that the step - size restriction together with ensures that the sign of @xmath58 in is positive . )    the derivative of the frequencies @xmath58 with respect to @xmath588 is given by @xmath589 with @xmath590 from which is positive for @xmath56 by  .",
    "this motivates the definition @xmath591 of the _ modified frequencies _ since we then have @xmath592 this implies @xmath593 for all @xmath56 and some @xmath594 , and hence @xmath595 with @xmath596 by .",
    "the modified frequencies @xmath59 are hence close to the original frequencies @xmath58 as required in part ( a ) of assumption  [ assum - nonres ] .",
    "we study resonances among the modified frequencies @xmath59 of derived in the previous subsection .",
    "as @xmath597 for @xmath598 , we introduce @xmath599 we verify for these modified frequencies a non - resonance condition that has been introduced by bambusi and is widely used in the long - time analysis of infinite dimensional hamiltonian systems .",
    "the verification is an adaptation of ( * ? ? ?",
    "5.1 ) to the present situation along with some simplifications .",
    "we proceed roughly as follows .",
    "the aim is to show that there are a lot of `` good '' values of @xmath588 for which linear combinations of frequencies do not become small .",
    "more precisely , a value of @xmath588 is considered as `` good '' if for all vectors @xmath600 and @xmath601 with @xmath602 and @xmath603 the linear combinations @xmath604 are bounded away from zero by a negative power of @xmath605 , where we denote by @xmath605 the largest index @xmath578 with @xmath606 ( and set @xmath607 for @xmath608 ) .",
    "the first step is to observe that it suffices to consider @xmath609 with integers @xmath286 instead of @xmath610 , the reason being that @xmath611 is either close to an integer by the asymptotic behaviour @xmath612 of the frequencies ( see lemma  [ lemma - asymptotic ] below ) or may be absorbed into @xmath613 .",
    "this is done in proposition  [ prop - bambusi ] below . furthermore",
    ", if one excludes some values of @xmath588 , a bound of @xmath614 can be obtained from a bound of some derivative @xmath615 of @xmath614 ( lemma  [ lemma - pc ] ) .",
    "therefore we study in lemma  [ lemma - det ] a matrix made up of derivatives of the frequencies @xmath616 .",
    "this matrix is such that its inverse multiplied with the vector containing the first derivatives of @xmath613 is just the vector containing the nonzero entries of @xmath351 .",
    "bounding its inverse ( see lemma  [ lemma - det ] ) thus helps to study the derivatives of @xmath614 .    as in the previous subsection we fix @xmath104 with and @xmath31 and @xmath19 with for some @xmath60",
    "let us emphasize , however , that again all constants will be independent of the discretization parameters @xmath31 and @xmath19 .",
    "we will make extensive use of the asymptotic behaviour of @xmath617 from   and of the modified frequencies described in the following lemma .",
    "the estimates of @xmath617 follow from @xmath620 by  . for the estimates of @xmath616",
    "we note that @xmath621 this shows @xmath622 the estimate   of lemma  [ lemma - stab - numericalvsanalytical ] and @xmath623 thus lead to the claimed lower bound of @xmath624 .",
    "now we begin with the investigation of ( integer ) linear combinations @xmath625 of modified frequencies .",
    "the following lemma will help us to control derivatives of these linear combinations with respect to @xmath588 , which in turn will allow us to control the linear combinations themselves .",
    "we have @xmath633 with @xmath634 and @xmath635 for @xmath636 , @xmath637 and @xmath638 .",
    "note that for all @xmath629 @xmath639 with positive constants @xmath640 and @xmath641 by lemmas  [ lemma - stab - numericalvsanalytical ] and  [ lemma - asymptotic ] .",
    "hence , the bound on the entry @xmath642 as stated in the lemma follows from the representation .",
    "moreover , this representation shows that @xmath643 with the diagonal matrices @xmath644 and @xmath645 and the vandermonde matrix @xmath646 . in order to examine the inverse of @xmath214 , we first invert @xmath647 .",
    "its inverse is given by @xmath648 with @xmath649 see for example ( * ? ? ?",
    "2.8.1 ) . since @xmath650 with @xmath651 , the bounds and the step - size restriction imply @xmath652 with @xmath632 .",
    "the estimate of @xmath653 stated in the lemma follows .",
    "now we consider sets of values of @xmath588 for which linear combinations of modified frequencies are small .",
    "we define for vectors @xmath654 and @xmath655 and integers @xmath286 the sets @xmath656 : { \\bigl\\lvert({\\mathbf{k}}+{\\mathbf{l}})\\cdot{\\boldsymbol{{\\omega}}}({\\sigma } ) + m\\bigr\\rvert } < \\frac{\\gamma}{\\operatorname{argmax}({\\mathbf{k}})^{\\alpha } } \\,\\biggr\\}.\\ ] ] we first estimate the lebesgue measure @xmath476 of these sets in the case @xmath657 .",
    "\\(b ) the function @xmath669\\rightarrow{\\mathbb{r}},\\ , { \\sigma}\\mapsto { \\mathbf{k}}\\cdot{\\omega}({\\sigma } ) + m$ ] is infinitely differentiable and its first @xmath670 derivatives are uniformly bounded on @xmath671 $ ] by a constant depending only on @xmath672 and @xmath98 ( lemma  [ lemma - det ] ) .",
    "the property then enables us to apply ( * ? ? ? * lemma 8.4 ) , which yields the statement of the lemma .",
    "\\(b ) for @xmath678 let @xmath679 be a constant such that @xmath680 if @xmath681 .",
    "this constant exists by lemma  [ lemma - asymptotic ] and depends on @xmath672 and @xmath98 . then for @xmath682 @xmath683 whereas @xmath684 for @xmath681 .",
    "\\(d ) for @xmath691 , where without loss of generality @xmath692 , note that with the constant @xmath88 of lemma  [ lemma - asymptotic ] @xmath693 then for @xmath694 @xmath695 and this set is empty for @xmath696 with a constant @xmath697 by lemma  [ lemma - asymptotic ] . on the other hand",
    ", we have for @xmath698 @xmath699 a situation that is covered by ( b ) .",
    "the results ( a)-(d ) show that there exists a constant @xmath700 such that @xmath701 since the number of vectors @xmath351 with @xmath702 and @xmath703 is at most @xmath704 we have by lemma  [ lemma - pc ] @xmath705 with a constant @xmath706 .",
    "the choice of @xmath707 ensures that @xmath708 , and hence the latter sum converges and the proposition is proven .",
    "first , the frequencies of ( and also the modified frequencies ) contain an additional summand @xmath709 .",
    "this is an integer and does not affect the proof of lemmas  [ lemma - det ] and [ lemma - pc ] , where also the integer summand @xmath710 in the modified frequencies   does not pose a problem .",
    "it does neither pose a problem in the proof of proposition  [ prop - bambusi ] since it is of order one for small @xmath84 ( for part ( b ) and ( c ) of the proof ) and is an integer ( for part ( d ) of the proof ) .",
    "second , the quantity @xmath573 appearing in the frequencies of can be different from @xmath15 .",
    "but for small @xmath84 , these two quantities are of the same order , see lemma  [ lemma - nj ] .",
    "we therefore expect the statements of lemmas  [ lemma - det ] and [ lemma - pc ] and of proposition  [ prop - bambusi ] to transfer to this situation with constants depending on @xmath84 .",
    "we have already verified in lemma  [ lemma - stab - numericalvsanalytical ] that assumption  [ assum - linearstability ] is satisfied under the conditions   and   of theorem  [ thm - main2 ] .",
    "we have also verified in that the modified frequencies   are close to the original frequencies as required in part ( a ) of assumption  [ assum - nonres ] .",
    "we will now prove that they satisfy the non - resonance condition in part ( b ) of assumption  [ assum - nonres ] for many values of @xmath31 and @xmath102 .",
    "note that , in the considered case @xmath14 , part ( c ) of assumption  [ assum - nonres ] follows from part ( b ) since @xmath597 for all @xmath711 with @xmath712 .",
    "fix @xmath713 with  , @xmath106 and @xmath98 .",
    "in contrast to the previous subsection , we do not fix the time step - size @xmath31 anymore .",
    "we consider for all @xmath714 the corresponding sets   for @xmath715 which we denote now by @xmath716 to emphasize the dependence ( of the modified frequencies , and hence the sets ) on @xmath31 .",
    "we set for @xmath659 @xmath717 \\times [ 0,{\\rho}_0 ] : { \\rho}^2 \\not\\in{\\mathcal{q}}_h({\\gamma},{\\alpha } ) \\,\\bigr\\}\\ ] ] with @xmath718 .",
    "as mentioned above , all @xmath719 satisfy assumption  [ assum - linearstability ] with constant @xmath114 and part ( a ) of assumption  [ assum - nonres ] with @xmath720 and constant @xmath115 provided that @xmath19 satisfies  .",
    "we still have to show that for all @xmath719 the modified frequencies @xmath721 satisfy the non - resonance condition in part ( b ) of assumption  [ assum - nonres ] provided that   holds . for this purpose let @xmath654 with @xmath722 .",
    "then we have @xmath723 since the ( strong and not only @xmath724 , say . ] ) step - size restriction ensures together with lemma  [ lemma - asymptotic ] that @xmath725 .",
    "now we write @xmath726 with @xmath727 in such a way that there is no pairwise cancellation ( @xmath728 ) .",
    "for @xmath729 we have by   and by lemma  [ lemma - asymptotic ] that @xmath730 with @xmath731 .",
    "moreover , the choice of the set @xmath716 yields @xmath732 combining this with   we get @xmath733 the non - resonance condition of assumption  [ assum - nonres ] thus holds for @xmath734 , @xmath117 and @xmath735 .",
    "we finally have to estimate the lebesgue measure of @xmath108 . by fubini s theorem and proposition  [ prop - bambusi ]",
    "we have @xmath736 because the constant in this proposition is independent of @xmath31 .",
    "the proof of theorem  [ thm - main2 ] is thus complete if we redefine @xmath737 .",
    "d.  cohen , e.  hairer and ch .",
    "lubich , http://dx.doi.org/10.1007/s00205-007-0095-z[_long-time analysis of nonlinearly perturbed wave equations via modulated fourier expansions _ ] , arch .",
    "* 187 * ( 2008 ) , 341368 .",
    "m.  dahlby and b.  owren , http://dx.doi.org/10.1051/m2an/2009022[_plane wave stability of some conservative schemes for the cubic schrdinger equation _ ] , m2an math . model .",
    "* 43 * ( 2009 ) , 677687 .",
    "e.  faou , l.  gauckler and ch .",
    "lubich , http://dx.doi.org/10.1080/03605302.2013.785562[_sobolev stability of plane wave solutions to the cubic nonlinear schrdinger equations on a torus _ ] , comm .",
    "partial differential equations * 38 * ( 2013 ) , 11231140 .",
    "e.  faou , b.  grbert and e.  paturel , http://dx.doi.org/10.1007/s00211-009-0258-y[_birkhoff normal form for splitting methods applied to semilinear hamiltonian pdes .",
    "i. finite - dimensional discretization _ ] , numer . math .",
    "* 114 * ( 2010 ) , 429458 .",
    "e.  faou , b.  grbert and e.  paturel , http://dx.doi.org/10.1007/s00211-009-0257-z[_birkhoff normal form for splitting methods applied to semilinear hamiltonian pdes .",
    "abstract splitting _ ] , numer . math . * 114 * ( 2010 ) , 459490 .",
    "l.  gauckler , http://nbn-resolving.de/urn:nbn:de:bsz:21-opus-47540[_long-time analysis of hamiltonian partial differential equations and their discretizations _ ] , dissertation ( doctoral thesis ) , universitt tbingen , 2010 , http://nbn-resolving.de/urn:nbn:de:bsz:21-opus-47540 .",
    "l.  gauckler , e.  hairer and ch .",
    "lubich , http://dx.doi.org/10.1007/s00220-013-1728-8[_energy separation in oscillatory hamiltonian systems without any non - resonance condition _ ] , comm .",
    "* 321 * ( 2013 ) , 803815 .",
    "l.  gauckler , e.  hairer , ch .",
    "lubich and d.  weiss , http://dx.doi.org/10.1080/03605302.2012.683503[_metastable energy strata in weakly nonlinear wave equations _ ] , comm .",
    "partial differential equations * 37 * ( 2012 ) , 13911413 .",
    "e.  hairer and ch .",
    "lubich , http://dx.doi.org/10.1137/s0036142999353594[_long-time energy conservation of numerical methods for oscillatory differential equations _ ] , siam j. numer .",
    "38 * ( 2000 ) , 414441 ( electronic ) .",
    "e.  hairer , ch .",
    "lubich and g.  wanner , http://dx.doi.org/10.1007/3-540-30666-8[_geometric numerical integration .",
    "structure - preserving algorithms for ordinary differential equations _ ] , second ed .",
    ", springer series in computational mathematics , vol .",
    "31 , springer - verlag , berlin , 2006 .",
    "z.  hani , http://dx.doi.org/10.1007/s00205-013-0689-6[_long-time instability and unbounded sobolev orbits for some periodic nonlinear schrdinger equations _ ] , arch . ration .",
    "( to appear ) , http://dx.doi.org/10.1007/s00205-013-0689-6[doi:10.1007/s00205-013-0689-6 ] .",
    "r.  h.  hardin and f.  d.  tappert , http://dx.doi.org/10.1137/1015060[_applications of the split - step fourier method to the numerical solution of nonlinear and variable coefficient wave equations _ ] , siam rev . *",
    "15 * ( 1973 ) , 423 .",
    "m.  khanamiryan , o.  nevanlinna and t.  vesanen , http://www.damtp.cam.ac.uk/user/na/people/marianna/papers/nls.pdf[_long-term behavior of the numerical solution of the cubic non - linear schrdinger equation using strang splitting method _ ] , preprint , 2012 , http://www.damtp.cam.ac.uk/user/na/people/marianna/papers/nls.pdf .",
    "t.  r.  taha and m.  j.  ablowitz , http://dx.doi.org/10.1016/0021-9991(84)90003-2[_analytical and numerical aspects of certain nonlinear evolution equations .",
    "numerical , nonlinear schrdinger equation _ ] , j. comput .",
    "* 55 * ( 1984 ) , 203230 ."
  ],
  "abstract_text": [
    "<S> plane wave solutions to the cubic nonlinear schrdinger equation on a torus have recently been shown to behave orbitally stable . under generic perturbations of the initial data that are small in a high - order sobolev norm , plane waves are stable over long times that extend to arbitrary negative powers of the smallness parameter . </S>",
    "<S> the present paper studies the question as to whether numerical discretizations by the split - step fourier method inherit such a generic long - time stability property . </S>",
    "<S> this can indeed be shown under a condition of linear stability and a non - resonance condition . </S>",
    "<S> they can both be verified if the time step - size is restricted by a cfl condition in the case of a constant plane wave . </S>",
    "<S> the proof first uses a hamiltonian reduction and transformation and then modulated fourier expansions in time . </S>",
    "<S> it provides detailed insight into the structure of the numerical solution . </S>",
    "<S> + * mathematics subject classification ( 2010 ) : * primary 65p10 , 65p40 ; secondary : 65m70 . </S>"
  ]
}