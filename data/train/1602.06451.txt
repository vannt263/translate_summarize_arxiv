{
  "article_text": [
    "the casselman  shalika formula describes a spherical whittaker function using the root system and the character of an irreducible representation of the dual group .",
    "the formula not only plays a fundamental role in the theory of @xmath0-adic groups and automorphic forms , but also connects many different constructions in mathematics , such as schubert varieties , crystal bases and macdonald polynomials .",
    "for example , see @xcite .    in this paper",
    ", we study a generalization of the casselman ",
    "shalika formula to the case of iwahori  whittaker functions through demazure characters . to be precise ,",
    "let @xmath1 be a finite - dimensional simple lie algebra over @xmath2 , which should be considered as the lie algebra of the dual group .",
    "let @xmath3 be the weight lattice of @xmath1 , and @xmath4 $ ] the group algebra of @xmath3 , with basis @xmath5 , @xmath6 .",
    "the subset of dominant weights will be denoted by @xmath7 .",
    "we also denote by @xmath8 the set of roots and positive roots , by @xmath9 the set of simple roots , and by @xmath10 the set of simple reflections , which generates the weyl group @xmath11 .",
    "let @xmath12 be an indeterminate , and set @xmath13 $ ] .",
    "consider the demazure character @xmath14 for @xmath15 and @xmath16 , which is the formal character of the demazure module associated with the weight @xmath17 . when @xmath18 , the longest element , the character @xmath19 is nothing but the character of the irreducible representation of @xmath1 with highest weight @xmath20 . now the casselman ",
    "shalika formula is given by @xmath21 where @xmath22 is the spherical whittaker function .",
    "as mentioned above , this paper is concerned with generalizing the formula to the case involving the iwahori  whittaker functions @xmath23 ( to be defined in the next section ) and the demazure characters @xmath24 , for @xmath25 .",
    "that is to say , we would like to compute the coefficients @xmath26 , @xmath27 , in the expansion @xmath28    to make the problem more tractable , we consider the _ demazure atoms _",
    "@xmath29 ( see section  [ sect2 ] ) , instead of working with the demazure characters directly .",
    "we write @xmath30 and study how to compute @xmath31 , @xmath27 .",
    "the coefficients @xmath32 and @xmath33 are related in a simple way ( corollary [ simple ] ) : @xmath34    still , in general , it would be difficult to obtain a complete description of the coefficients @xmath33 .",
    "however , the main result of this paper shows how to compute the coefficients @xmath33 under some interesting conditions involving _ good words _ and _",
    "shellability_. more precisely , under condition ( a ) or ( b ) at the beginning of section [ sec - main ] , we obtain :    let @xmath35 be a reduced word with @xmath36 for some @xmath37 , @xmath38 , and @xmath39 where the indices @xmath40 between @xmath41 and @xmath42 are determined by condition ( a ) or ( b )",
    ". then we have @xmath43 where @xmath44 and @xmath45 is the demazure operator corresponding to the root @xmath46 .    conditions ( a ) and ( b ) are intriguing .",
    "in fact , based on thorough computer tests , in section  [ cond - a - b ] we conjecture that they are equivalent in a strong sense . shortly after posting our paper ,",
    "d. muthiah and a. pusks proved our conjecture ; their proof is included as an appendix .",
    "as discussed in section  [ goodword ] , condition ( a ) is closely related to smoothness of schubert varieties in flag varieties @xmath47 .",
    "we also present some statistical information regarding the frequency with which these conditions are satisfied .",
    "we establish an application of conditions ( a ) and ( b ) to the problem of computing the transition matrix between two natural bases for the space of iwahori fixed vectors of an induced representation of a @xmath0-adic group .",
    "the same problem was studied by bump and nakasuji @xcite .",
    "they showed that , in the simply - laced case , when @xmath48 admits a good word for @xmath49 , the entry @xmath50 of the transition matrix is given by @xmath51 where @xmath52 is the set of roots determined by the good word condition .",
    "however , it seems that there is a gap in the proof of @xcite , which we do not know how to fix at the present . in section [ sec - cass ] , we assume condition ( b ) and prove the formula with @xmath52 replaced by a set determined by condition ( b ) .",
    "the main idea of the proof is similar to that of @xcite .",
    "given the equivalence of conditions ( a ) and ( b ) , the bump - nakasuji result in full root system generality follows .",
    "this provides another evidence that conditions ( a ) and ( b ) are natural ones to be considered in representation theory .",
    "related to the above mentioned coefficients @xmath53 , it is also worth noting the recent paper of nakasuji and naruse @xcite . by using a change of basis in the hecke algebra , they express all of these coefficients in a completely different way compared to , namely as sums over combinatorial sets .",
    "the mentioned change of basis in the hecke algebra generalizes the theory of so - called _ root polynomials _ , which provides similar combinatorial formulas for localizations of schubert classes in the equivariant cohomology and @xmath54-theory of flag varieties , see @xcite and the references therein , as well as ( * ? ? ?",
    "* remark  1 ) .",
    "the fact that there are two types of formulas for the coefficients @xmath53 , namely the general formula in @xcite and the simpler formula if conditions ( a ) and ( b ) hold , is very similar to the existence of a general summation formula for schubert classes ( via root polynomials ) , versus a much simpler product formula in the smooth case , see ( * ? ? ?",
    "* chapter  7 ) .",
    "it turns out that the latter formula is hard to derive from the former , so completely separate proofs are needed . in this context",
    ", it is not surprising that conditions ( a ) and ( b ) are related to smoothness of schubert varieties , as noted above .",
    "in this section , we present the main question of this paper , introduced in the previous section , in more detail . we keep the notions fixed in the previous section .",
    "recall that the hecke algebra @xmath55 is the algebra over @xmath56 defined by the generators @xmath57 , @xmath58 , subject to the quadratic relations @xmath59 and the braid relations corresponding to @xmath11 .",
    "the algebra @xmath55 acts on @xmath60 by @xmath61 where @xmath62 , @xmath63 , are the demazure operators defined by @xmath64 in particular the operators @xmath65 , @xmath63 , satisfy the braid relations .",
    "hence one may define @xmath66 for an arbitrary choice of reduced expression @xmath67 . for a dominant weight @xmath68 ,",
    "define @xmath69 as shown in @xcite , the expression @xmath70 corresponds to the iwahori ",
    "whittaker function , and the sum @xmath22 corresponds to the spherical whittaker function where @xmath71 is the longest element .",
    "it is well - known that the demazure operators @xmath62 , @xmath63 , satisfy the braid relations as well so that the operator @xmath72 is well - defined for @xmath73 using any reduced expression of @xmath48 . then the demazure character is given by @xmath74 which is the formal character of the demazure module associated with the weight @xmath17 .",
    "recall the casselman ",
    "shalika formula : @xmath75    as mentioned above , we are interested in generalizing the formula to the cases involving @xmath76 ( or @xmath70 ) and @xmath24 for @xmath25 .",
    "precisely , we would like to compute the coefficients @xmath77 , @xmath27 , in the expansion @xmath78 alternatively , if we write @xmath79 we have @xmath80 and @xmath81 by the mbius inversion ( * ? ? ?",
    "* theorem 1.2 ) .",
    "however , we found it more convenient to work with _",
    "demazure atoms_. we define @xmath82 which is the specialization of @xmath65 at @xmath83 .",
    "then @xmath84 , @xmath63 satisfy the braid relations , and we define @xmath85 , @xmath15 in the obvious way .",
    "now the demazure atoms are defined to be @xmath86    [ prob ] consider the transition between @xmath87 and @xmath85 , @xmath88 and study how to compute @xmath89\\otimes{\\bf z}[p]$ ] , @xmath27 .",
    "the coefficients @xmath32 and @xmath33 can be related in a simple way , using the fact that the demazure character is the sum of all the lower demazure atoms .",
    "we give a proof of this fact below using a result in @xcite .",
    "@xmath90 and @xmath91 .",
    "@xmath62 , @xmath63 are the specialization of @xmath92 at @xmath83 .",
    "let @xmath93 be a reduced expression of @xmath48 , and define @xmath94 in the obvious way . by ( * ? ?",
    "* theorem 6 ) one has @xmath95 where @xmath96 is the poincar polynomial of fibre of the bott ",
    "samelson resolution @xmath97 over the open cell @xmath98 .",
    "specializing @xmath83 gives that @xmath99    [ simple ] @xmath100 and @xmath101    by the reduction made above , the computation of the coefficients @xmath102 or @xmath32 is equivalent to the computation of the coefficients @xmath33 , for @xmath27 .",
    "hence we will focus on problem [ prob ] from now on .",
    "note that the operators @xmath84 are twisted derivations in the sense that @xmath103.\\ ] ] in fact the last equation is the specialization at @xmath83 of @xmath104.\\ ] ]    it is also known that @xmath105 , @xmath15 satisfy the relation @xmath106 for example one has the quadratic relation @xmath107 , @xmath63 .",
    "specializing ( [ hecke ] ) at @xmath83 gives @xmath108",
    "in this section we give some general inductive steps for later use .",
    "we recall a well - known lemma from @xcite , which is called @xmath109 property of the bruhat order , and it will be used frequently in this paper .",
    "[ lem ] let @xmath110 be a simple reflection and @xmath111 .",
    "assume that @xmath112 , @xmath113 . then @xmath114    this lemma can be visualized using the diamond square in figure  [ fig ] , where the validities of the three dashed lines are all equivalent .",
    "@xmath115 \\ar@{-}[ld ] \\ar@{--}[dd ]   & \\\\   w_2 \\ar@{--}[rd ] & & sw_1 \\ar@{-}[dl ] \\\\ & w_1 & } \\ ] ]    the following lemma can be easily verified by using ( [ dem ] ) .",
    "[ lem2 ] let @xmath116 be a simple root and @xmath117 .",
    "then @xmath118    [ lem3 ] assume that the simple reflection @xmath117 is a left ascent of @xmath48 , i.e. , @xmath119 .",
    "then @xmath120    applying @xmath121 to the equation @xmath122 and using ( [ der2 ] ) gives that @xmath123 the lemma follows from inserting lemma [ lem2 ] into the last equation , and also from noting that @xmath124 here the second equation is an immediate consequence of the first .    by comparing the coefficients in lemma [ lem3 ] with @xmath125",
    ", we obtain the following inductive algorithm .",
    "[ ind ] assume that @xmath126 , @xmath127 , and that @xmath128 .",
    "then    \\(i ) if @xmath27 , @xmath129 , then @xmath130    \\(ii ) if @xmath27 , @xmath131 , then @xmath132    \\(iii ) if @xmath133 , in which case @xmath131 , then @xmath134    the three cases are illustrated in figure  [ fig-2 ] . note that in the last case we have either @xmath49 and @xmath48 incomparable , as depicted , or @xmath135 .",
    "@xmath136 \\ar@{-}[ld ] \\ar@{-}[dd ]   & \\\\   w \\ar@{-}[rd ] & & sx \\ar@{-}[dl ] \\\\ & x & } \\qquad   \\xymatrix { & sw   \\ar@{-}[ld ] \\\\   w \\ar@{-}[rd ] &   \\\\ & x \\ar@{-}[dl ] \\\\ sx &   } \\qquad \\xymatrix { & sw \\ar@{-}[rd ] \\ar@{-}[ld ]    & \\\\   w \\ar@{-}[rd ] & & x \\ar@{-}[dl ] \\\\ & sx & } \\ ] ]    the following corollary is immediate by applying proposition [ ind ] ( i ) and ( iii ) recursively . throughout ,",
    "we let @xmath137 be the inversion set of @xmath138 .",
    "[ cor ] we have @xmath139",
    "following @xcite , we consider the notion of a good word .",
    "assume that @xmath27 , and introduce the sets @xmath140 deodhar s inequality states that @xmath141 with equality holding if the kazhdan  lusztig polynomial @xmath142 , or equivalently if the schubert variety @xmath143 is rationally smooth at the @xmath144-fixed point @xmath145 ( see @xcite ) .",
    "we remark that @xmath146 has the trivial upper bound @xmath147 because of the inclusion @xmath148 , where the last set is the inversion set of @xmath48 , of cardinality @xmath147 ; indeed , it is well known that @xmath149 is an inversion of @xmath48 , i.e. , @xmath150 , if and only if @xmath151 .",
    "for any reduced expression @xmath152 of @xmath48 , let @xmath153 be the set of integers @xmath154 $ ] such that @xmath155 .",
    "let @xmath156 be such that @xmath36 , @xmath157 .",
    "then there are bijections @xmath158 moreover it is clear that @xmath159 . by abuse of notation , we also write @xmath160 for the vector formed by elements of @xmath153 arranged in ascending order @xmath161 . then @xmath93 is called a _ good word _ for @xmath49 if @xmath162 since @xmath163 , a good word exists only if ( [ good ] ) is a reduced expression hence @xmath164 .",
    "conversely , it is conjectured in @xcite that if @xmath11 is simply - laced and @xmath164 , then @xmath48 has a good word for @xmath49 .",
    "this conjecture is proved in [ _ loc .",
    "_ ] for @xmath165 or @xmath166 using sage , and it is shown to be false in non - simply - laced case , e.g. for @xmath167 .",
    "we recall the lexicographic shellability of bruhat order , following @xcite . for @xmath168",
    ", we say that @xmath169 _ covers _",
    "@xmath49 , denoted by @xmath170 , if @xmath171 and there is no @xmath172 such that @xmath173 . in this case @xmath174 and there is a unique @xmath175 such that @xmath176 .",
    "moreover for any reduced expression @xmath177 , there is a unique @xmath178 such that @xmath179 , and one has @xmath180 .",
    "we may also write @xmath181 to specify the reflection @xmath182 that takes @xmath169 to @xmath49 .",
    "consider @xmath27 and the bruhat interval @xmath183:=\\ { y\\in w| x\\leq y\\leq w\\}$ ] .",
    "then all maximal chains @xmath184 of @xmath183 $ ] have the same length @xmath164 .",
    "let us describe a labeling of the maximal chains of @xmath183 $ ] .",
    "fix once for all a reduced expression @xmath152 of @xmath48 . for a maximal chain @xmath185 of",
    "@xmath183 $ ] as above , there is a unique sequence @xmath186 of distinct integers in @xmath187 $ ] such that @xmath188 is obtained by removing @xmath189 from @xmath190 , @xmath191 . in particular",
    "this implies that the resulting subwords representing @xmath188 s are all reduced .",
    "then we assign the label @xmath192    recall that the _ lexicographic order _ of @xmath193 is the linear ordering @xmath194 such that @xmath195 if @xmath196 in the first coordinate where they differ .",
    "the main result of @xcite states that @xmath183 $ ] is lexicographically shellable . in particular",
    "this implies that    \\(i ) there is a unique maximal chain @xmath197 in @xmath183 $ ] whose label @xmath198 is increasing , i.e. , @xmath199 ;    \\(ii ) @xmath200 for any other maximal chain @xmath185 of @xmath183 $ ] .",
    "+ note that the maximal chain @xmath197 depends on the choice of the reduced word @xmath93 which we fix from the beginning .",
    "similarly , consider the reduced word @xmath201 of @xmath138 . by applying shellability",
    "to @xmath138 with this reduced word and reverting to @xmath48 , we see that    ( i@xmath202 ) there is a unique maximal chain @xmath203 in @xmath183 $ ] whose label @xmath204 is decreasing , i.e. , @xmath205 ;    ( ii@xmath202 ) @xmath206 for any other maximal chain @xmath185 in @xmath183 $ ] .",
    "in this section we compute the coefficient @xmath33 , for @xmath27 , under either of the following two conditions for the pair @xmath207 :    \\(a ) @xmath48 admits a reduced word @xmath190 such that @xmath208 ;    \\(b ) @xmath48 admits a reduced word @xmath190 such that @xmath209 .",
    "here we write @xmath210 for a vector @xmath211 .",
    "note that the reduced word @xmath190 satisfying condition ( a ) is necessarily a good word for @xmath49 .",
    "as we will prove , both conditions guarantee that only the relations in proposition  [ ind ]  ( i ) and ( iii ) are used in the recursive computation of @xmath33 ; these relations have the advantage of being simple , compared with the relation in part ( ii ) .",
    "we first prove a few more facts regarding combinatorial properties of a reduced word .    [ 6.1 ] assume that @xmath152 is a good word of @xmath48 for @xmath49 such that @xmath212 with @xmath213 .",
    "then    \\(i ) @xmath214    \\(ii ) @xmath215    \\(iii ) @xmath216 is a good word of @xmath217 for @xmath218 and @xmath219",
    ".    part ( i ) is obvious from the definition of good word .",
    "part ( iii ) follows from ( ii ) . to prove ( ii ) , it suffices to show that @xmath220 is contained in @xmath52 , which implies that @xmath221 because of deodhar s inequality @xmath222 take @xmath223 , i.e. , @xmath224 . we claim that @xmath225 . to the contrary ,",
    "assume that @xmath226 .",
    "then by lemma [ lem ] we have the diamond square @xmath227 \\ar@{-}[ld ] \\ar@{-}[dd ]   & \\\\",
    "ws_\\alpha \\ar@{--}[rd ] & & x \\ar@{-}[dl ] \\\\ & s_1x & } \\ ] ] where the two dashed lines follow from the middle vertical line .",
    "this implies that @xmath228 , a contradiction to part ( i ) .",
    "hence @xmath225 , and using lemma [ lem ] again we obtain the diagram @xmath229 \\ar@{-}[ld ]   & & \\\\   s_1w\\ar@{-}[rd ] & & ws_\\alpha \\ar@{-}[dl ]   \\ar@{--}[dr ] \\\\ & s_1ws_\\alpha & & x \\\\ & &   s_1x \\ar@{-}[ul ] \\ar@{-}[ur ] & } \\ ] ] which implies that @xmath230 .    [ 6.2 ] let @xmath152 be a fixed reduced word of @xmath48 , @xmath231 , @xmath232 , where @xmath233 and @xmath234 . consider the reduced word @xmath235 of @xmath236 .",
    "then    \\(i ) if @xmath213 , then @xmath237 and @xmath238    \\(ii ) if @xmath239 , then @xmath240    \\(iii ) if @xmath241 , then @xmath242    \\(iv ) if @xmath243 , then @xmath244 and @xmath245    write @xmath246 .",
    "\\(i ) the last claim is clear since we have obviously a maximal chain @xmath247 of @xmath248 $ ] with increasing label @xmath249 .",
    "we must have @xmath250 because of the uniqueness of increasing label .",
    "it remains to prove that @xmath251 . to the contrary ,",
    "assume that @xmath252 .",
    "then concatenation of @xmath253 with any maximal chain in @xmath254 $ ] will give a maximal chain @xmath185 in @xmath255 $ ] such that @xmath256 , since @xmath257 .",
    "this is a contradiction .",
    "\\(ii ) the proof is similar .",
    "\\(iii ) @xmath258 equals the following subchain of @xmath259 @xmath260    \\(iv ) @xmath261 is the last arrow in the chain @xmath262 hence @xmath244 .",
    "the following subchain of @xmath262 @xmath263 gives rise to the maximal chain of @xmath264 $ ] @xmath265 with decreasing label @xmath266 , which implies that @xmath267 .",
    "[ 6.3 ] assume that @xmath152 is a good word of @xmath48 for @xmath49 such that @xmath268 with @xmath241 .",
    "then    \\(i ) @xmath269",
    "\\(ii ) @xmath270 , where @xmath271    \\(iii ) @xmath235 is a good word of @xmath236 for @xmath272    \\(iv ) @xmath273 .    part ( i ) and",
    "the last equality in ( iv ) follow from lemma [ 6.2 ] ( iv ) . part ( iii ) and the first equality in ( iv )",
    "are direct consequences of ( ii ) .",
    "finally ( ii ) follows from lemma [ 6.4 ] below , which is of independent interest .",
    "[ 6.4 ] assume that @xmath274 , @xmath275 and @xmath129 , where @xmath276 . if @xmath277 , then @xmath278 .",
    "consider the following diamond given by lemma [ lem ] .",
    "@xmath279 \\ar@{-}[ld ] \\ar@{-}[dd ]    & \\\\   sw \\ar@{--}[rd ] & & sx \\ar@{-}[dl ] \\\\ & x & } \\ ] ] take @xmath280 , i.e. , @xmath281 .",
    "we claim that @xmath282 , i.e. , @xmath283 . if @xmath284 , then the claim is obvious , again by lemma [ lem ] . if @xmath285 , then lemma [ lem ] gives the following diamond @xmath286 \\ar@{-}[ld ] \\ar@{-}[dd ]    & \\\\",
    "ws_\\beta \\ar@{--}[rd ] & & sx \\ar@{-}[dl ] \\\\ & x & } \\ ] ] hence the claim follows .",
    "obviously @xmath287 , because @xmath288 .",
    "therefore we get an inclusion @xmath289 .",
    "this inclusion is an equality because of deodhar s inequality @xmath290 where the last equality follows from the assumption @xmath277 .",
    "we can now apply previous lemmas together with proposition [ ind ] recursively to compute @xmath33 , assuming condition ( a ) or ( b ) . as mentioned above",
    ", only cases ( i ) and ( iii ) of proposition [ ind ] show up in the computation . in order to formulate our main result",
    ", we introduce an additional notation .    for any @xmath291 ,",
    "let @xmath292 using this notation , it is easy to see that we have @xmath293    [ thm - main ] assume that either condition ( a ) or ( b ) holds . in either case , let @xmath294 then we have @xmath295    in either case we use recursion",
    ". first assume condition ( a ) .",
    "if @xmath213 , then @xmath296 satisfies condition ( a ) as well , due to lemma [ 6.1 ] ( iii ) and lemma [ 6.2 ] ( ii )",
    ". moreover , we may apply proposition [ ind ] ( iii ) because of lemma [ 6.1 ] ( i ) , which gives that @xmath297 if @xmath241 , then @xmath298 also satisfies ( a ) and we may apply proposition [ ind ] ( i ) , due to lemma [ 6.3 ] , which gives that @xmath299 iterating this process gives us @xmath300 one may use ( [ cross ] ) to push the reflections @xmath301 , @xmath302 , @xmath303 across the operators @xmath304 , @xmath305 , @xmath306 , noting that @xmath307 .",
    "the proof assuming condition ( b ) is similar . if @xmath213 , then by lemma [ 6.2 ] ( i)-(ii ) , @xmath308 also satisfies ( b ) and proposition [ ind ] ( iii ) applies . if @xmath241 , then by lemma [ 6.2 ] ( iii)-(iv ) , @xmath298 satisfies ( b ) and proposition [ ind ] ( i ) applies .",
    "\\(i ) note that in the special cases @xmath309 and @xmath310 , we recover @xmath311 and @xmath312 respectively , as given by corollary [ cor ] .",
    "\\(ii ) the roots @xmath313 can be interpreted as follows .",
    "we have @xmath314 moreover , under condition ( b ) , the roots @xmath315 give the sequence of reflections along the maximal chain @xmath259 of @xmath183 $ ] , i.e. , we have @xmath316 hence the calculation of @xmath33 amounts to inserting the operators @xmath317 into the product @xmath318 in a natural , combinatorial way .",
    "since these conditions are essential for our main result , we now discuss them in more detail .",
    "we start with an example .",
    "consider @xmath319 and @xmath320 in @xmath321 .",
    "it is easy to see that both conditions ( a ) and ( b ) hold in this example .",
    "based on thorough computer tests , we now formulate a conjecture about the equivalence of conditions ( a ) and ( b ) in a strong sense .",
    "[ conj ] let @xmath190 be a reduced word for @xmath48 and @xmath322 .",
    "the following are equivalent :    \\(i ) @xmath323    \\(ii ) @xmath324    \\(iii ) @xmath325    the proof of the conjecture , due to d. muthiah and a. pusks , is included as an appendix .",
    "thus , we are able use the more symmetric condition @xmath326 note that it is enough to prove @xmath327 , as @xmath328 would easily follow ; indeed , just reverse the reduced word and use the fact that inversion is an automorphism of the bruhat order .",
    "we now discuss some statistics related to the frequency with which conditions ( a ) and ( b ) are satisfied .",
    "we looked at the symmetric groups @xmath329 , @xmath330 , and @xmath331 , as well as at the hyperoctahedral groups @xmath332 and @xmath333 .",
    "for each ( signed ) permutation @xmath48 , we calculated ( with the help of a computer ) the percentage of @xmath322 which satisfy conditions ( a ) and ( b ) .",
    "the distribution of these percentages in @xmath330 and @xmath331 is shown in figure  [ fig-3 ] .",
    "it is interesting to note that this distribution is skewed right , with the mode at the right tail , while the interquartile range reaches 100% in both cases .",
    "by contrast , in type @xmath334 , the distribution looks closer to a uniform one .",
    "experiments with the same weyl groups mentioned above also showed that the formula in theorem  [ thm - main ] fails if conditions ( a ) and ( b ) are not satisfied .",
    "@xmath335{hist1.pdf } & \\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\!\\ ! \\includegraphics[scale=0.75]{hist2.pdf }          \\end{array}\\ ] ]",
    "in this section , under the shellability condition ( b ) in section 6 , we compute the transition matrix between two natural bases of the iwahori fixed vectors in a spherical representation of a semisimple @xmath0-adic group , considered by casselman in @xcite . for simply - laced cases , a conjectural formula is given in @xcite , which is proved under the assumption that a good word exists ; however , it seems that there is a gap in this proof , which we do not know how to fix at present .",
    "we follow the strategy of computations in @xcite , although we consider reduced words from a very different point of view .",
    "let us first recall the basic formulations and collect a few results we need from @xcite .",
    "let @xmath336 be an unramified character of @xmath337 , which is parametrized by an element @xmath338 in the complex torus @xmath339 of the l - group @xmath340 .",
    "let @xmath341 be the induced representation which consists of locally constant functions @xmath342 such that @xmath343 , where @xmath344 is the modular character .",
    "let @xmath345 be the iwahori subgroup which is the preimage of @xmath346 under the reduction @xmath347 .",
    "then the space of @xmath345-fixed vectors @xmath348 has dimension @xmath349 , and there are two bases @xmath350 and @xmath351 of @xmath348 parametrized by @xmath11 .    the first natural basis @xmath350 is defined using the disjoint decomposition @xmath352 such that @xmath353 is supported on @xmath354 and @xmath355 .",
    "let @xmath356 be the intertwining operator defined by @xmath357 then @xmath351 is the dual basis of the linear functionals @xmath358 , @xmath359 , @xmath15 .",
    "casselman @xcite asks for the transition matrix between these two bases , which is in general a very difficult problem .",
    "it is better to use the basis @xmath360 instead of @xmath361 , and by mbus inversion one has @xmath362 if we write @xmath363 , then obviously @xmath364 and in @xcite it is shown that @xmath365 is upper triangular . in [ _ loc .",
    "cit _ ] it is conjectured that @xmath366 when the root system @xmath367 is simply - laced and @xmath368 , and it is proved under the additional assumption that @xmath48 admits a good word for @xmath49 .",
    "let @xmath369 be the iwahori ",
    "hecke algebra which consists of bi-@xmath345-invariant functions supported on @xmath54 .",
    "then @xmath369 has a basis @xmath370 , where @xmath371 is the characteristic function of @xmath372 , and @xmath369 is generated by @xmath373 , @xmath63 .",
    "let @xmath374 be the isomorphism of left @xmath369-modules defined by @xmath375 .",
    "let @xmath376 be the map making the following diagram commute : @xmath377^{m_w } \\ar[d]^{\\alpha_\\chi } & v({}^w\\chi ) \\ar[d]^{\\alpha_{{}^w\\chi } } \\\\ h \\ar[r]^{{\\mathcal}m_{w } } & h   } \\ ] ] define @xmath378 .",
    "then @xmath379 and for @xmath380 one has @xmath381 define @xmath382 . then @xmath383 is independent of @xmath384 . for @xmath385 let @xmath386 be the coefficient of @xmath41 in the expression of @xmath387 in terms of the basis @xmath371",
    "then @xmath388 for @xmath389 and @xmath390 , write @xmath391 if @xmath392 is a linear combination of @xmath371 s with @xmath393",
    ".    @xcite [ bn ] let @xmath127 , @xmath390 such that @xmath394 .",
    "then @xmath395    now we can give our formula for @xmath50 in full root system generality , assuming that condition ( b ) holds .",
    "[ 7.2 ] assume condition ( b ) .",
    "let @xmath396 , @xmath191",
    ". then @xmath397    the proof follows the argument in @xcite , but we shall give some details for the sake of completeness .",
    "write @xmath398 , @xmath399 , suppressing the dependence of spectral parameters .",
    "write @xmath400 as a sum @xmath401\\mu(s_{n-1})\\cdots\\mu(s_1)&+\\\\ [ \\psi(s_1\\cdots\\hat{s}_{i_1}\\cdots \\hat{s}_{i_d}\\cdots s_{n-1})\\mu(s_{n-1})-\\psi(s_1\\cdots\\hat{s}_{i_1}\\cdots \\hat{s}_{i_d}\\cdots s_{n-2})]\\mu(s_{n-2})\\cdots\\mu(s_1)&+\\\\ \\cdots & \\\\ [ \\psi(s_1\\cdots\\hat{s}_{i_1}\\cdots \\hat{s}_{i_d})\\mu(s_{i_d})-c(d)\\psi(s_1\\cdots\\hat{s}_{i_1}\\cdots \\hat{s}_{i_d})]\\mu(s_{i_d-1})\\cdots\\mu(s_1 ) & + \\\\",
    "c(d)[\\psi(s_1\\cdots\\hat{s}_{i_1}\\cdots s_{i_d-1})\\mu(s_{i_d-1})-\\psi(s_1\\cdots\\hat{s}_{i_1}\\cdots s_{i_d-2})]\\mu(s_{i_d-2})\\cdots\\mu(s_1 ) & + \\\\ \\cdots & \\\\",
    "c(d)\\cdots c(1)[\\psi(s_1)\\mu(s_1)-\\psi(1)]&+\\\\ c(d)\\cdots c(1)\\psi(1),&\\end{aligned}\\ ] ] where @xmath402 we will show that the linear functional @xmath403 annihilates every summand except the last , so that @xmath404 .",
    "since we have the reduced words @xmath405 , @xmath406 , which form the maximal chain @xmath197 , we see that @xmath407 . therefore by proposition [ bn ]",
    "the summands of the form @xmath408\\mu(s_{i_k-1})\\cdots \\mu(s_1)\\ ] ] are all equal to zero .",
    "note that the spectral parameter of @xmath409 is @xmath410 and one has @xmath411    every other summand is a constant multiple of the form @xmath412\\mu(s_{j-1})\\cdots \\mu(s_1).\\ ] ] since @xmath413 is reduced , by proposition [ bn ] we have @xmath414 applying ( [ mu1 ] ) , ( [ mu2 ] ) and arguing as in @xcite one can deduce that ( [ other ] ) is annihilated by @xmath403 unless @xmath415 assume that is true , let @xmath416 , @xmath417 and @xmath418 . recall that we have the reduced words @xmath419 , @xmath191 , which make the maximal chain @xmath262 .",
    "consider the following subchain of @xmath262 @xmath420 by taking reduced subwords , it gives rise to a maximal chain of @xmath421 $ ] @xmath422 where @xmath423 , @xmath424",
    ". then @xmath425 is decreasing , which implies that @xmath426 .",
    "but similarly to the proof of lemma [ 6.2 ] ( i ) , this contradicts ( [ eqn - no ] ) because @xmath427 is lexicographically maximal .",
    "this finishes the proof of the theorem .",
    "given the equivalence of conditions ( a ) and ( b ) , proved in the appendix , the bump - nakasuji result @xcite in full root system generality immediately follows from theorem  [ 7.2 ] .",
    "in this appendix , we prove conjecture [ conj ] .",
    "the conjecture is that the following three conditions are equivalent .",
    "assume first that @xmath444 then the chain @xmath445 starts with @xmath446 and hence @xmath447 and thus @xmath448 for the other direction , assume @xmath448 omitting the first simple reflection from @xmath449 only decreases its length by @xmath450 hence @xmath451 composing @xmath452 with a maximal chain from @xmath453 to @xmath49 gives a maximal chain @xmath454 from @xmath449 to @xmath49 whose label starts with @xmath455 then @xmath456 implies @xmath444    [ rmk : wgoodif1 ] if @xmath431 holds for @xmath49 and @xmath457 i.e. @xmath458 then @xmath449 is a good word of @xmath48 for @xmath459 ( omitting all the reflections from @xmath449 that appear in @xmath460 is the same as taking the last element of the maximal chain @xmath461 that last element is @xmath459 )              by lemma [ 6.2 ] ( iii ) and ( iv ) , we have : @xmath474 together with @xmath241 ( lemma [ lem : ione - equals - one - is - equivalent - to - lambdaone - equals - one ] ) we conclude that @xmath475 for every @xmath476 , hence @xmath432 holds for the pair @xmath463 .",
    "* case 2 : * @xmath477 . by lemma",
    "[ 6.1 ] ( iii ) and lemma [ 6.2 ] ( ii ) , @xmath431 holds for the pair @xmath478 and @xmath479 . by induction",
    ", @xmath432 also holds for @xmath480 . by lemma [ lem :",
    "ione - equals - one - is - equivalent - to - lambdaone - equals - one ] , @xmath481 .",
    "thus by lemma [ 6.2 ] ( i ) and ( ii ) , we have @xmath482 , which implies @xmath483 .                      ( -2,0 )  ( 0,2 ) ; ( 0,-2 )  ( 2,0 ) ; ( 0,-2 )  ( -2,0 ) ; ( 0,-2 )  ( 0,2 ) ; ( -0.3 * 2,-0.2 * 2 ) node [ ] ; ( -2,0 ) node [ fill = white ] @xmath236 ; ( 0,2 ) node [ fill = white ] @xmath48 ; ( 0,-2 ) node [ fill = white ] @xmath49 ; ( 2,0 ) node [ fill = white ] @xmath498 ;    and conclude that @xmath499 let @xmath500 and @xmath501 and @xmath502 to show @xmath503 it suffices to prove @xmath504 ( note that we are slightly abusing notation .",
    "for example , when we write @xmath505 , we mean @xmath506 where @xmath507 is the weyl group element obtained by multiplying out the word @xmath508 . )",
    "( -2,0 )  ( 0,2 ) ; ( 0,-2 )  ( 2,0 ) ; ( 0,-2 )  ( -2,0 ) ; ( 0,-2 )  ( 0,2 ) ; ( -0.3 * 2,-0.2 * 2 ) node [ ] ; ( -2,0 ) node [ fill = white ] @xmath236 ; ( 0,2 ) node [ fill = white ] @xmath48 ; ( 0,-2 ) node [ fill = white ] @xmath49 ; ( 2,0 ) node [ fill = white ] @xmath498 ;      ( -2,0 )  ( 0,2 ) ; ( 0,-2 )  ( 2,0 ) ; ( 0,-2 )  ( -2,0 ) ; ( 0,0 ) node [ ] ; ( 2,0 )  ( 0,2 ) ; ( -2,0 ) node [ fill = white ] @xmath236 ; ( 0,2 ) node [ fill = white ] @xmath48 ; ( 0,-2 ) node [ fill = white ] @xmath498 ; ( 2,0 ) node [ fill = white ] @xmath49 ;    shows that @xmath515 take @xmath500 and @xmath516 and @xmath517 as in the case @xmath241 above . to prove @xmath518 we need to show @xmath519 first consider the case when @xmath520 then if @xmath521 we have @xmath522 whence @xmath523 if on the other hand @xmath524 then again by lemma [ lem ] we have the diagram    ( -2,0 ) ",
    "( 0,2 ) ; ( 0,-2 )  ( 2,0 ) ; ( 0,-2 ) ",
    "( -2,0 ) ; ( 0,0 ) node [ ] ; ( 2,0 )  ( 0,2 ) ; ( -2,0 ) node [ fill = white ] @xmath517 ; ( 0,2 ) node [ fill = white ] @xmath516 ; ( 0,-2 ) node [ fill = white ] @xmath498 ; ( 2,0 ) node [ fill = white ] @xmath49 ;                * case 2 : * @xmath538 .",
    "the argument is very similar . in this case ,",
    "@xmath539 by lemma [ lem : ione - equals - one - is - equivalent - to - lambdaone - equals - one ] , and lemma [ lem : remove - one - node - lambda - result ] tells us that @xmath540 and : @xmath541    by lemma [ 6.2 ] ( i ) and ( ii ) , we have that : @xmath542 by induction , we know : @xmath543 in particular : @xmath544 by deodhar s inequality : @xmath545 so ( [ eq:5 ] ) , ( [ eq:7 ] ) , and ( [ eq:8 ] ) together imply : @xmath546 by , and , @xmath536",
    ". therefore @xmath537 ."
  ],
  "abstract_text": [
    "<S> in this paper , we consider how to express an iwahori  whittaker function through demazure characters . under some interesting combinatorial conditions , </S>",
    "<S> we obtain an explicit formula and thereby a generalization of the casselman  shalika formula . under the same conditions , we compute the transition matrix between two natural bases for the space of iwahori fixed vectors of an induced representation of a @xmath0-adic group ; this generalizes a result of bump  nakasuji .    </S>",
    "<S> k .- h.l . </S>",
    "<S> was partially supported by a grant from the simons foundation ( # 318706 ) . ]     </S>",
    "<S> c.l . </S>",
    "<S> was partially supported by the nsf grant dms1362627 . ] </S>"
  ]
}