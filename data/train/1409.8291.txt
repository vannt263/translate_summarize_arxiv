{
  "article_text": [
    "diffusive shock acceleration ( dsa ; e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ) at non - relativistic collisionless shocks is a prominent mechanism for producing very energetic particles .",
    "it is particularly efficient at supernova remnant ( snr ) blast waves ( e.g. , * ? ? ?",
    "* ) , and is likely responsible for the acceleration of galactic cosmic rays ( crs ) .",
    "nevertheless , determining the exact fraction of particles that are injected into dsa is a vexed question in cr physics .",
    "a characterization of particle injection without free parameters requires a self - consistent calculation of the shock structure on microphysical scales , which can be achieved only with kinetic plasma simulations .    in this paper",
    "we develop a simplified predictive model of injection that matches results from hybrid simulations ( kinetic ions ",
    "fluid electrons ) . from simulations",
    "we infer the dynamics of the shock transition ( section [ sec : reform ] ) and characterize the trajectories of accelerated ions after their first shock reflection , determining the conditions for injection into dsa as a function of the magnetic field orientation ( section [ sec : inj ] ) .",
    "we then use these relations to construct a minimal theory of ion injection at dsa - efficient shocks , which accounts for the fraction of accelerated ions , and for the ion spectrum from thermal to non - thermal energies ( section [ sec : suprath ] ) .",
    "we discuss our results in section [ sec : disc ] , and conclude in section [ sec : conclusions ] .",
    "evolution of the density profile for a parallel shock ( @xmath0 , top panel ) , and a quasi - perpendicular shock ( @xmath1 , bottom ) with @xmath2 . for better readability ,",
    "profiles at later times are shown as increasingly shifted up .",
    ", title=\"fig : \" ]   evolution of the density profile for a parallel shock ( @xmath0 , top panel ) , and a quasi - perpendicular shock ( @xmath1 , bottom ) with @xmath2 . for better readability ,",
    "profiles at later times are shown as increasingly shifted up .",
    ", title=\"fig : \" ]",
    "hybrid simulations describe the evolution of a collisionless plasma integrated over the electron scales , fully retaining the physics of shock formation , ion acceleration , and magnetic field amplification , as we discussed in a recent series of papers ( * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* hereafter paper i , ii , iii ) . here",
    "we present 2d simulations performed with the massively - parallel code _",
    "@xcite , where a shock is produced by sending a supersonic fluid against a reflecting wall ( see paper i ) .",
    "lengths are in units of @xmath3 , where @xmath4 is the speed of light and @xmath5 , with @xmath6 , and @xmath7 the ion mass , charge , and number density .",
    "time is in units of @xmath8 , with @xmath9 the background magnetic field ; the time step is @xmath10 .",
    "velocities and energies are normalized to @xmath11 and @xmath12 .",
    "sonic and alfvnic mach numbers are @xmath13 , with @xmath14 the upstream fluid velocity in the simulation frame .",
    "boxes measure @xmath15 , with 5 cells per @xmath3 and 4 particles per cell .",
    "the shock inclination is expressed by @xmath16 .",
    "evolution of the @xmath17 phase space distribution for a parallel shock with @xmath2 .",
    "the discontinuity is almost steady for @xmath18 , until the beam of reflected ions induces its reformation.,title=\"fig : \" ]   evolution of the @xmath17 phase space distribution for a parallel shock with @xmath2 .",
    "the discontinuity is almost steady for @xmath18 , until the beam of reflected ions induces its reformation.,title=\"fig : \" ]   evolution of the @xmath17 phase space distribution for a parallel shock with @xmath2 .",
    "the discontinuity is almost steady for @xmath18 , until the beam of reflected ions induces its reformation.,title=\"fig : \" ]   evolution of the @xmath17 phase space distribution for a parallel shock with @xmath2 .",
    "the discontinuity is almost steady for @xmath18 , until the beam of reflected ions induces its reformation.,title=\"fig : \" ]   evolution of the @xmath17 phase space distribution for a parallel shock with @xmath2 .",
    "the discontinuity is almost steady for @xmath18 , until the beam of reflected ions induces its reformation.,title=\"fig : \" ]   evolution of the @xmath17 phase space distribution for a parallel shock with @xmath2 .",
    "the discontinuity is almost steady for @xmath18 , until the beam of reflected ions induces its reformation.,title=\"fig : \" ]   evolution of the @xmath17 phase space distribution for a parallel shock with @xmath2 .",
    "the discontinuity is almost steady for @xmath18 , until the beam of reflected ions induces its reformation.,title=\"fig : \" ]    figure [ fig : rho ] shows the evolution of the density profile for a parallel ( @xmath0 ) and a quasi - perpendicular ( @xmath1 ) shock ; in both cases @xmath2 and the discontinuity propagates with the same average speed .",
    "for @xmath19 the density peak first broadens and then suddenly jumps ahead , while for @xmath1 the shock propagation is significantly smoother ( see also * ? ? ?",
    "the shock reformation is revealed in figure [ fig : trans ] , which shows the evolution of the @xmath17 phase space for @xmath19 . at @xmath20",
    "there is a sharp transition between the cold upstream beam and the isotropic downstream distribution , which is associated with compression and pressure increase , and in turn with an electric field @xmath21 directed upstream ; the electron pressure @xmath22 is taken as polytropic , with an effective adiabatic index satisfying the shock jump conditions with thermal equilibration between downstream ions and electrons ( @xmath23 for @xmath2 ) .",
    "ions impinging on such a barrier are specularly reflected back into the upstream ( beam with positive @xmath24 at @xmath25 in figure [ fig : trans ] ) . reflected",
    "ions gyrate into the upstream , eventually producing a new discontinuity about one gyroradius @xmath26 ahead of the old one . meanwhile , the first barrier is smoothed out , and ions trapped between the two discontinuities are rapidly isotropized .",
    "this indicates that a necessary condition for an ion to be energized is to impinge on the shock when the potential barrier is at its maximum ; therefore , the shock reformation timescale ( @xmath27 , half the gyration time ) sets the duty cycle for ion injection",
    ".     energy evolution and @xmath17 phase space distribution for typical supra - thermal ( top panels ) and non - thermal ions ( bottom panels ) , for a parallel shock with @xmath2 .",
    "the @xmath28-axis is rescaled such that the shock is at @xmath29 , and moves with constant velocity .",
    ", title=\"fig : \" ]   energy evolution and @xmath17 phase space distribution for typical supra - thermal ( top panels ) and non - thermal ions ( bottom panels ) , for a parallel shock with @xmath2 .",
    "the @xmath28-axis is rescaled such that the shock is at @xmath29 , and moves with constant velocity .",
    ", title=\"fig : \" ]    by tracking the trajectories of individual ions , we find that all the ions that eventually achieve energies larger than @xmath30 are reflected by the potential barrier at their first shock encounter .",
    "after reflection , ions perform a few gyrations around the shock , gaining energy via shock drift acceleration ( sda , see , e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "at any shock reformation , @xmath31 of the incoming ions are reflected , but not all of them enter dsa .",
    "more precisely , ions impinging on the shock turn into :    * _ thermal ions _ , which encounter a barrier too weak to reflect them , and immediately cross downstream ; * _ supra - thermal ions _",
    ", which are specularly reflected , and achieve @xmath32 via sda before being advected downstream ( figure [ fig : part ] , top panels ) ; * _ non - thermal ions _ , which are reflected , energized up to @xmath33 , and eventually escape toward upstream ( figure [ fig : part ] , bottom panels ) .",
    "non - thermal ions are injected into the dsa process : they later scatter on self - generated magnetic fluctuations and diffuse back to the shock for further energization .",
    "the existence of supra - thermal ions , instead , demonstrates that reflection is necessary but not sufficient for dsa injection .",
    "several authors have already pointed out the importance of shock reformation ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* and references therein ) and specular reflection ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) for the production of energetic ions ( see also * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "however , the distinction between supra - thermal and non - thermal ions ( which undergo a similar initial reflection , but have different fates ) , has not been fully characterized . our goal is to develop a theory able to predict the spectrum and fractions of thermal , supra - thermal , and non - thermal ions observed in simulations , as a function of shock strength and inclination .",
    "we adopt the formalism developed by @xcite and @xcite for studying ion reflection off the shock discontinuity , with the important difference that we account for specular reflection in the downstream frame ( hereafter , dsf ) rather than in the shock frame , since the potential barrier stalls before reformation ( see also * ? ? ?",
    "we introduce the _ de hoffmann  teller _ frame ( hereafter , htf ) .",
    "] , in which the shock is at rest and there is no motional electric field @xcite , and the ortho - normal triad @xmath34 , such that @xmath35 and the shock normal @xmath36 .",
    "the velocity of the htf with respect to the dsf is @xmath37 where @xmath38 is the shock compression ratio . in this section ,",
    "we normalize velocities to the shock velocity in the upstream frame , @xmath39 , and indicate with @xmath40 ( @xmath41 ) velocities in the dsf ( htf ) ; in general : @xmath42 in the htf , any velocity can be decomposed as @xmath43,\\ ] ] where @xmath44 , @xmath45 is the guiding center velocity , @xmath46 is the gyro - speed , and @xmath47 is the gyro - phase that gives the correct @xmath48 . a velocity written in the dsf as @xmath49 can be rewritten in the htf as ( equations ( [ eq : wht])([eq : wt ] ) ) : @xmath50 ^ 2+\\delta v_{\\xi}^2};\\\\ \\phi&= \\arcsin(\\delta v_{\\xi}/w_g ) .",
    "\\end{split}\\end{aligned}\\ ] ] if an ion undergoes a specular reflection in the dsf ( @xmath51 ) , its final velocity in the htf reads : @xmath52 if @xmath53 , the ion guiding center motion is towards downstream , and the ion is advected away .",
    "if @xmath54 , the guiding center motion is upstream , but gyration may still bring it back to the shock . by integrating equation ( [ eq : wt ] ) , with @xmath55 given by equation ( [ eq : wr ] ) , we obtain the ion s displacement along the shock normal : @xmath56 for given @xmath57 and @xmath55 , if there exists a @xmath58 such that @xmath59 , a reflected ion reencounters the shock , impinging with normal velocity @xmath60 we define the characteristic loss angle @xmath61 as the smallest angle for which @xmath62 has a solution , so that , if @xmath63 , reflected ions escape upstream and are injected into dsa .",
    "let us consider a cold upstream ion with @xmath64 , and @xmath65 , which corresponds to @xmath66 for cold ions @xmath67 ( accounting for a finite - temperature beam only introduces a small spread in @xmath61 , @xmath68 for @xmath69 ) , which means that ions can be injected by a single reflection only at shocks with @xmath70 .",
    "however , quasi - parallel shocks isotropize and amplify the pre - shock magnetic field ( paper ii ) , which implies that the effective shock inclination is typically @xmath71 ; therefore , injection at ( initially ) quasi - parallel shocks can not rely just on simple reflection of thermal upstream ions .",
    "if @xmath72 the ion reencounters the shock , and may either penetrate downstream , or be reflected again , depending on the ion `` normal '' energy @xmath73 being sufficient to overcome the shock potential @xmath74 , estimated as @xmath75 if downstream electrons are in equipartition with ions ; the last equality comes from jump conditions for strong shocks .",
    "ions penetrate the shock barrier if @xmath76 with @xmath77 for rankine - hugoniot conditions .",
    "maximum shock inclination allowing a reflected ion to escape upstream , as a function of the pre - reflection velocity , with @xmath78 .",
    "the modulus of the minimum velocity necessary to escape from a shock with @xmath79 ( green contour ) is typically @xmath80 corresponding to @xmath81 . ]",
    "if condition ( [ eq : cond ] ) is not satisfied , reflected ions reencounter the shock , being no longer cold because they have experienced sda , and have been partially isotropized .",
    "we can calculate the velocity that ions need for escaping upstream by looking at the phase space for which @xmath82 has no solutions .",
    "figure [ fig : thl ] shows @xmath61 as a function of the pre - reflection ion velocity , decomposed as in equation ( [ eq : vn ] ) .",
    "the green contour indicates the velocity components that permit reflected ions to escape from a dsa - efficient shock with @xmath71 ; the corresponding minimum injection velocity is @xmath83 , and the minimum injection energy is @xmath84 , in good agreement with simulations ( paper i ) ; different orientations of @xmath85 return similar values .    injection into dsa",
    "is suppressed for shocks with @xmath86 because ions can escape very oblique shocks only with @xmath87 ( figure [ fig : thl ] ) .",
    "the achievement of such velocities requires a few more sda cycles , and , since at every cycle ions have a finite probability to pierce the shock barrier and to be lost downstream , the fraction of ions that can achieve larger velocities becomes increasingly smaller .",
    "our results differ from those by @xcite , who assumed reflection in the shock frame rather than in the dsf and found that for @xmath88 all the reflected ions are injected .",
    "we now construct a minimal model that accounts for the observed : 1 ) periodic shock reformation , 2 ) fraction and trajectories of reflected ions , and 3 ) ion spectrum above thermal energies .",
    "since we are interested in dsa - efficient shocks , without loss of generality we consider @xmath71 , and @xmath89 of a few tens ( magnetic field amplification effectively reduces @xmath90 and @xmath91 in the precursor of stronger shocks , see paper ii ) .",
    "( a ) trajectories of test - particles impinging at random times on a periodically - reforming shock with @xmath92 and @xmath93 ( section [ sec : suprath ] ) ; for each ion , @xmath94 corresponds to the first shock encounter .",
    "ions may either not reflect ( `` advected ions '' ) , or experience sda before ending up downstream ( `` sda ions '' ) , or escape upstream after a few reflections ( `` injected ions '' ) .",
    "+ ( b ) post - shock ion spectrum for a parallel shock with @xmath2 . our minimal model ( magenta symbols ) perfectly matches the spectrum obtained in simulations ( solid line ) .",
    ", title=\"fig : \" ]   ( a ) trajectories of test - particles impinging at random times on a periodically - reforming shock with @xmath92 and @xmath93 ( section [ sec : suprath ] ) ; for each ion , @xmath94 corresponds to the first shock encounter .",
    "ions may either not reflect ( `` advected ions '' ) , or experience sda before ending up downstream ( `` sda ions '' ) , or escape upstream after a few reflections ( `` injected ions '' ) .",
    "+ ( b ) post - shock ion spectrum for a parallel shock with @xmath2 . our minimal model ( magenta symbols ) perfectly matches the spectrum obtained in simulations ( solid line ) .",
    ", title=\"fig : \" ]    inspired by simulations , we model the periodic shock reformation by imposing the potential barrier to spend @xmath95 of the time in a `` high '' state with @xmath96 , defined as the overdensity at the density peak ( the `` overshoot '' , see figure [ fig : rho ] ) , and the rest of the time in a `` low state '' , with normalization chosen such that @xmath97 when averaged over a period . ] .    we calculate the trajectories of test - particle ions impinging on the shock at random times ( equation ( [ eq : xt ] ) ) , performing a specular reflection ( equation ( [ eq : wr ] ) ) whenever ions reencounter the shock with normal velocity too small to penetrate the barrier ( equation ( [ eq : cond ] ) ) .",
    "figure [ fig : traj]a shows the displacement from the barrier of several ions impinging at @xmath94 on a shock with @xmath92 , and inclination @xmath98 .",
    "we recover the populations of section [ sec : reform ] , now labeled as : 1 ) `` advected ions '' ( @xmath99 of the total ) , which impinge on the shock when the barrier is in the low state , and remain trapped downstream ; 2 ) `` sda ions '' ( @xmath100 ) , which end up in the downstream after having crossed the barrier once or twice , gaining a factor of a few in energy in the process ; 3 ) `` injected ions '' ( @xmath101 ) , which escape upstream after two to four reflections , and would enter dsa in a full simulation in the presence of upstream scattering .    by using the approach put forward by @xcite , we also calculate the ion spectrum in the supra - thermal region .",
    "if the fractional energy gain at each acceleration cycle is @xmath102 , with @xmath103 the initial ( final ) energy , and the probability of leaving the acceleration region is @xmath104 , the expected particle spectrum reads @xmath105 if @xmath106 , then @xmath107 ; for relativistic particles @xmath108 , and one gets the universal dsa ion spectrum @xmath109 , while for non - relativistic particles @xmath110 and @xmath111 , so that @xmath112 .    the energy gain @xmath113 is independent of the acceleration mechanism ( sda or dsa ) . instead , the probability of leaving the acceleration region is insensitive to the shock discontinuity for dsa ions , but is regulated by the duty cycle of the potential barrier in the sda regime . for non - thermal ions with @xmath33 , we assume @xmath114 as in usual dsa theory , where @xmath104 is determined by the advection of an isotropic ion distribution .",
    "simulations suggest @xmath115 ( independent of energy ) for supra - thermal ions , whose spectrum deviates from a power - law and is steeper than in the dsa region .",
    "figure [ fig : traj]b shows the ion spectrum obtained in a hybrid simulation of a parallel shock with @xmath2 , compared with the spectrum obtained by using the full equation ( [ eq : gam ] ) , and the prescriptions above for @xmath104 and @xmath113 , plus a cut - off at @xmath116 .",
    "our minimal model remarkably reproduces the simulated spectrum , which deviates from a maxwellian above @xmath117 , shows a steep `` bridge '' in the supra - thermal region , and matches the standard dsa prediction above @xmath118 .",
    "the normalization of the non - thermal tail at dsa - efficient shocks is determined by the number @xmath119 of sda cycles needed to accelerate ions above the injection energy for a shock with inclination @xmath71 . with the procedure above",
    ", we calculate @xmath120 , and an injection fraction of @xmath121 , in excellent agreement with simulations .",
    "injection at shocks with @xmath122 is strongly suppressed because it requires higher @xmath123 , corresponding to @xmath124 , and at each sda cycle ions have @xmath99 probability of being lost downstream ; for instance , for @xmath125 we find @xmath126 , and @xmath127 .",
    "this explains why dsa efficiency is almost constant for @xmath128 , and drops rapidly above @xmath129 ( figure 3 in paper i ) ; moreover , acceleration efficiency is almost independent of the shock strength for @xmath130 , which suggests that our recipes hold for any strong shock .",
    "ion injection is often accounted for with a _ thermal leakage _ model ( see ,",
    "e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* and references therein ) ; downstream thermal ions of sufficiently large energy ( @xmath131 ) are assumed to be injected because their gyroradius encompasses the shock thickness , which is however not resolved in macroscopical approaches to dsa .",
    "monte carlo models ( e.g. , * ? ? ?",
    "* ) do not need to specify @xmath132 , and can reproduce the supra - thermal bridge measured , e.g. , at the earth s bow shock @xcite , but need an a priori parametrization of the ion mean free path ( see * ? ? ?",
    "* for a comparison of different approaches to dsa ) .",
    "our self - consistent picture is intrinsically different , in that supra - thermal ions have never been thermalized , and their propagation is never diffusive .",
    "the scheme outlined in section [ sec : inj ] provides a realistic description of the injection microphysics , as well as a simple parametrization of @xmath133 for phenomenological purposes .",
    "when shocks are not strong , three effects may become important : 1 ) for @xmath134 the overshoot vanishes @xcite , and a larger fraction of ions is advected downstream ; 2 ) @xmath135 is smaller , and reaching @xmath132 requires more sda cycles ; 3 ) magnetic field amplification is reduced ( paper ii ) , and the effective shock inclination is @xmath136 , which in principle helps injection ( figure [ fig : thl ] ) .",
    "however , the net effect is that the energy fraction in dsa ions is lower for low-@xmath89 shocks ( figure 3 in paper i ) .",
    "this leads to a crucial feedback : when @xmath137 of the ram pressure is in crs , the development of a shock precursor reduces @xmath91 at the subshock ( paper i , section 6 ) , which suppresses injection and prevents a more prominent shock modification . in simulations we consistently see the normalization of the non - thermal spectrum to decrease with time ( figure 2 in paper ii ) , which keeps the energy in the non - thermal tail saturated at @xmath137 despite the increase of @xmath138 ( paper iii ) .",
    "we stress that the dependence of ion injection on the shock obliquity is not an artifact of 2d simulations ( see 3d runs in paper i ) . at real quasi - parallel shocks ( e.g. , * ? ? ?",
    "* ) , reformation is unlikely coherent along the shock surface ; also , long - wavelength waves produced by cr instabilities perturb the shock front @xcite , interfering with its natural cyclotron period",
    ". pre - existing turbulence may locally affect the shock inclination , possibly providing patchy ion injection also for shocks with a globally quasi - perpendicular magnetic field @xcite .",
    "nevertheless , our results are still expected to be valid in a time / space - averaged sense , as injection is a local process .    in this work",
    "we did not account for injection of electrons , and of heavy ions , which are preferentially accelerated in galactic crs ; we defer the generalization of the presented formalism to particles with different mass / charge ratios to forthcoming publications .",
    "we investigated ion injection in non - relativistic collisionless shocks with kinetic hybrid simulations , in which shock structure and ion distribution are calculated self - consistently .",
    "we focused on dsa - efficient quasi - parallel shocks , and attested to their periodic reformation due to the collective reflection of ions off the shock potential barrier .",
    "because of such a time - dependent barrier , on average @xmath31 of the ions impinging on the shock are reflected and energized via sda ; nevertheless , not all of the reflected ions gain enough energy to enter dsa . for the effective magnetic inclination of dsa - efficient shocks ( @xmath139 ) , reflected ions must undergo two to three gyrations ( sda cycles ) around the shock before escaping upstream ( section [ sec : suprath ] ) ; since at each cycle @xmath99 of them are trapped downstream of the oscillatory barrier , only @xmath140 of the incoming ions survive after several sda cycles to be injected into dsa .",
    "we presented a formalism for studying supra - thermal ions in their multiple reflections , and calculated the minimum energy ions need to escape upstream of the shock , and enter dsa ( figure [ fig : thl ] ) .",
    "we also explained the observed dependence of the injection fraction on the shock inclination ( paper i ) , providing a general explanation for the reason why dsa is most prominent at quasi - parallel shocks . with our minimal shock model , spectrum and normalization of the ion spectra",
    "obtained in simulations are well reproduced .",
    "our findings provide a theory of ion injection that is of primary importance for understanding ion acceleration in interplanetary shocks , and in several astrophysical objects , such as snrs and clusters of galaxies .",
    "we thank l.  gargat for providing _",
    "dhybrid _ and the referee for precious comments .",
    "this research was supported by nasa ( grant nnx14aq34 g to dc ) , and facilitated by the max - planck / princeton center for plasma physics and by the simons foundation ( grant 267233 to as ) .",
    "simulations were performed on the computational resources provided by the princeton high - performance computing center , by nersc ( supported by the office of science of the u.s .",
    "department of energy under contract no .",
    "de - ac02 - 05ch11231 ) , and by xsede ( allocation no .",
    "tg - ast100035 ) ."
  ],
  "abstract_text": [
    "<S> we use kinetic hybrid simulations ( kinetic ions  fluid electrons ) to characterize the fraction of ions that are accelerated to non - thermal energies at non - relativistic collisionless shocks . </S>",
    "<S> we investigate the properties of the shock discontinuity and show that shocks propagating almost along the background magnetic field ( quasi - parallel shocks ) reform quasi - periodically on ion cyclotron scales . </S>",
    "<S> ions that impinge on the shock when the discontinuity is the steepest are specularly reflected . </S>",
    "<S> this is a necessary condition for being injected , but it is not sufficient . also by following the trajectories of reflected ions , </S>",
    "<S> we calculate the minimum energy needed for injection into diffusive shock acceleration , as a function of the shock inclination . </S>",
    "<S> we construct a minimal model that accounts for the ion reflection from quasi - periodic shock barrier , for the fraction of injected ions , and for the ion spectrum throughout the transition from thermal to non - thermal energies . </S>",
    "<S> this model captures the physics relevant for ion injection at non - relativistic astrophysical shocks with arbitrary strengths and magnetic inclinations , and represents a crucial ingredient for understanding the diffusive shock acceleration of cosmic rays . </S>"
  ]
}