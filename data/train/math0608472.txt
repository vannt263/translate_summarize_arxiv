{
  "article_text": [
    "in classical algebraic geometry , the isomorphism class of an elliptic curve is given by its @xmath2-invariant .",
    "the enumeration of complex plane elliptic curves with fixed @xmath2-invariant using gromov - witten theory has been undertaken by r. pandharipande @xcite .",
    "he computed the number of elliptic curves of degree @xmath1 through @xmath4 points and with fixed @xmath2-invariant to be @xmath5 for @xmath6 , where @xmath7 denotes the number of irreducible rational curves of degree @xmath1 interpolating @xmath4 points in general position ( in case @xmath8 , the numbers differ by a factor , due to the presence of extra automorphisms ) .    in tropical geometry",
    ", the isomorphism class of an elliptic curve is determined by the ( integer ) length of its only cycle .",
    "this length , called tropical @xmath2-invariant , can be viewed as a tropical analogue of the @xmath2-invariant of an elliptic curve in classical algebraic geometry @xcite .",
    "the tropical reformulation of the enumerative problem above is the enumeration of tropical curves of genus @xmath9 and degree @xmath1 with prescribed tropical @xmath2-invariant passing through a collection of @xmath4 points in @xmath10 in tropical general position .    in this paper",
    ", we construct the moduli space of tropical elliptic curves as a weighted polyhedral complex .",
    "furthermore , we define the multiplicity of a tropical elliptic curve with fixed @xmath2-invariant  similar to the case of tropical rational curves  as the absolute value of the determinant of the evaluation map times a weight of the moduli space .",
    "then we define the number @xmath0 to be the number of tropical elliptic curves with fixed tropical @xmath2-invariant and interpolating @xmath4 given points in @xmath11 , counted with multiplicities .",
    "we prove that the numbers @xmath0 are independent of the choice of the @xmath2-invariant for all values @xmath12 , without exceptional values for the @xmath2-invariant ( which is different for the complex case ) .",
    "therefore we can choose a special @xmath2-invariant to compute @xmath0 .",
    "there are two possibilities to choose a special @xmath2-invariant such that we can relate the elliptic tropical curves with that @xmath2-invariant to rational tropical curves .",
    "one possibility is to choose a very large @xmath2-invariant , the other a very small @xmath2-invariant .",
    "we prove that an elliptic tropical curve with a very large @xmath2-invariant contains a contracted bounded edge in a way that its image in @xmath10 can also be interpreted as rational tropical curve . in this way",
    "we can show that the numbers @xmath0 satisfy the equation @xmath13 where @xmath14 denotes the number of plane rational tropical curves of degree @xmath1 through @xmath4 points , counted with multiplicities ( see @xcite , definition 4.15 ) . since by g.  mikhalkin s correspondence theorem ( see theorem 1 of @xcite ) the number of rational tropical curves @xmath14 coincides with its complex counterpart @xmath7 , it follows ( using pandharipande s result ) that @xmath15 for @xmath16 .",
    "hence our result leads to a `` correspondence theorem '' for elliptic curves with fixed @xmath2-invariant .",
    "it would be interesting to investigate whether there is also a direct correspondence as in g.  mikhalkin s theorem , that is , a bijection between the set of tropical elliptic curves with fixed @xmath2-invariant ( with multiplicity ) and the set of complex curves with fixed @xmath2-invariant ( and which complex @xmath2-invariant corresponds to which tropical @xmath2-invariant ) .",
    "also , it would be interesting to see why there is no such bijection in the cases where the complex @xmath2-invariant is @xmath17 .",
    "the methods of our computation of @xmath0 using a very large @xmath2-invariant are analogous to pandharipande s computation of the numbers @xmath18  we use moduli spaces of tropical elliptic curves and evaluation maps .",
    "but we can also compute @xmath0 as mentioned above in another way , using a very small @xmath2-invariant .",
    "tropical curves with a very small @xmath2-invariant can be related to rational curves , too .",
    "thus we can determine the number @xmath0 with the aid of g.  mikhalkin s lattice path count ( see theorem 2 of @xcite ) .",
    "the computation of @xmath0 using the very small @xmath2-invariant does not have a counterpart in complex algebraic geometry .",
    "we think that our computation of @xmath0 gives new insights in tropical geometry . as the most important example",
    ", we want to mention here the construction of the moduli space of tropical elliptic curves . this space contains cells which are equipped with weights . for some cells these weights",
    "are not natural numbers but contain a factor of @xmath19 .",
    "this happens due to the presence of `` automorphisms '' ; we therefore think that our moduli space might be an example of a `` tropical orbifold '' .",
    "+ furthermore , equating our two formulas to determine @xmath0  the one using a very large @xmath2-invariant and the one using a very small @xmath2-invariant  we get a new formula to enumerate tropical rational curves .",
    "combined with g.  mikhalkin s lattice path algorithm to count tropical curves ( see theorem 2 of @xcite ) , this leads to a new lattice path count for tropical rational curves , which has the advantage that fewer paths have to be taken into account ( see corollary [ cor - formrat ] ) .",
    "note that , with some minor changes , many of our concepts can be carried over to curves on toric surfaces other than the projective plane , as g.  mikhalkin s correspondence theorem holds for these surfaces as well .",
    "but not all of our results can be generalized to these surfaces , as e.g. corollary [ cor - formrat ] has no counterpart for arbitrary toric surfaces , because the notion of column - wise newton subdivision is lost ( see remarik 3.10 of @xcite ) .",
    "the paper is organized as follows : in section 2 , we recall some basic definitions concerning abstract and plane tropical curves and their moduli .",
    "after that , we construct in section 3 the moduli space of tropical elliptic curves as a ( fractional ) weighted polyhedral complex . in section 4",
    ", we define tropical evaluation maps and use them to define multiplicities for elliptic curves with fixed @xmath2-invariant . using these multiplicities , we prove in section 5 the independence of the numbers @xmath0 from the configuration of the given general points and the given value of the @xmath2-invariant .",
    "this independence is used in section 6 to compute the numbers @xmath0 and in section 7 to obtain our modified version of g.  mikhalkin s algorithm to count rational plane curves via lattice paths .",
    "we would like to thank andreas gathmann for his inspiring ideas and for numerous helpful discussions .",
    "we will define tropical curves almost in the same way as in @xcite , with the only difference that we allow curves of higher genus .",
    "let us first introduce some notions concerning graphs and metric graphs that we will need . for more details on graphs , see definition 2.1 of @xcite .",
    "a graph can have bounded as well as unbounded edges .",
    "we denote the set of vertices by @xmath20 and the set of edges by @xmath21 .",
    "the subset of @xmath21 of bounded edges is denoted by @xmath22 , and the subset of unbounded edges by @xmath23 .",
    "unbounded edges will also be called _",
    "ends_. a _ flag _ @xmath24 of @xmath25 is a pair @xmath26 of a vertex @xmath27 and an edge @xmath28 starting at @xmath27 .",
    "we will denote the edge @xmath28 of a flag @xmath29 by @xmath30=e$ ] , and the vertex @xmath27 by @xmath31 .",
    "we can think of a flag @xmath26 as a `` directed edge '' pointing away from the vertex @xmath27 . for a bounded edge @xmath28",
    "there are two flags @xmath24 and @xmath32 with @xmath30=e$ ] , for an unbounded edge @xmath28 there is only one flag @xmath24 with @xmath30=e$ ] .",
    "we denote the set of flags of @xmath25 by @xmath33 .",
    "now assume @xmath25 is a metric graph , i.e.  all bounded edges @xmath28 are equipped with a length @xmath34 ( they can be thought of as real intervals of length @xmath34 ) . given a flag @xmath29 of a bounded ( respectively unbounded ) edge , we can parametrize @xmath28 ( using an affine map of slope @xmath35 , i.e.  a map of the form @xmath36 ) by an interval @xmath37 $ ] ( respectively , @xmath38 ) , such that the vertex @xmath27 is at @xmath39",
    ". this parametrization will be called the _ canonical parametrization _ for @xmath24 .",
    "the _ genus _ of a graph @xmath25 is defined to be its first betti number @xmath40 .",
    "an _ abstract tropical curve _ of genus @xmath41 is a metric graph @xmath25 of genus @xmath41 whose vertices have valence at least @xmath42",
    ". an _ abstract @xmath43-marked tropical curve _ of genus @xmath41 is a tuple @xmath44 where @xmath25 is an abstract tropical curve of genus @xmath41 and @xmath45 are distinct unbounded edges of @xmath25 .",
    "we will refer to the @xmath46 as marked ends or marked points ( a reason why we call them marked points is given in remark 2.7 of @xcite ) .",
    "two abstract @xmath43-marked tropical curves @xmath47 and @xmath48 are called isomorphic ( and will from now on be identified ) if there is a homeomorphism @xmath49 mapping @xmath50 to @xmath51 for all @xmath52 and preserving the lengths of all bounded edges ( i.e.  every edge of @xmath53 is mapped bijectively onto an edge of @xmath54 by an affine map of slope @xmath55 ) .",
    "the set of all isomorphism classes of connected @xmath43-marked tropical curves with exactly @xmath43 unbounded edges and of genus @xmath41 is called @xmath56 .",
    "[ ex - trop10 ] we want to determine the space @xmath57 .",
    "an element of @xmath57 is an abstract tropical curve with one unbounded edge , and of genus @xmath9 .",
    "as no divalent vertices are allowed , such an abstract tropical curve consists of one bounded edge whose two endpoints are identified and glued to the unbounded edge .",
    "these curves only differ in the length of their bounded edge , which has to be positive .",
    "therefore @xmath57 is isomorphic to the open interval @xmath58 .",
    "we define @xmath59 to be the interval @xmath38 . following g.  mikhalkin , we call the length of the bounded edge  which is an inner invariant of the tropical elliptic curve  its tropical @xmath2-invariant ,",
    "as it plays the role of the @xmath2-invariant of elliptic curves in algebraic geometry ( see example 3.15 of @xcite , see also remark [ rem - cycle ] and definition [ def - evj ] ) .",
    "[ def - planecurve ] an _ @xmath43-marked plane tropical curve _ of genus @xmath41 is a tuple @xmath60 , where @xmath53 is an abstract tropical curve of genus @xmath41 , @xmath61 are distinct unbounded edges of @xmath53 , and @xmath62 is a continuous map satisfying :    1 .   on each edge of @xmath53 the map @xmath63 is of the form @xmath64 for some @xmath65 and @xmath66 ( i.e.  `` @xmath63 is affine linear with rational slope '' ) .",
    "the integral vector @xmath67 occurring in this equation if we pick for @xmath28 the canonical parametrization with respect to a chosen flag @xmath24 of @xmath28 will be denoted @xmath68 and called the _ direction _ of @xmath24 .",
    "2 .   for every vertex @xmath27 of @xmath53",
    "we have the _ balancing condition _",
    "@xmath69 3 .",
    "each of the unbounded edges @xmath70 is mapped to a point in @xmath71 by @xmath63 ( i.e.  @xmath72 for the corresponding flags ) .",
    "two @xmath43-marked plane tropical curves @xmath73 and @xmath74 are called isomorphic ( and will from now on be identified ) if there is an isomorphism @xmath75 of the underlying abstract curves such that @xmath76 .",
    "the _ degree _ of an @xmath43-marked plane tropical curve is defined to be the multiset @xmath77",
    "\\in \\gamma^1_\\infty \\backslash \\",
    "{      x_1,\\dots , x_n \\ } \\ } $ ] of directions of its non - marked unbounded edges .",
    "if this degree consists of the vectors @xmath78 , @xmath79 , @xmath80 each @xmath1 times then we simply say that the degree of the curve is @xmath1 .",
    "[ rem - weightdir ] note that the direction vector of a flag @xmath29 ( if it is nonzero ) can uniquely be written as a product of a positive integer ( called the weight @xmath81 of the edge @xmath28 ) and a primitive integer vector called the primitive direction @xmath82 of the flag @xmath24 .    for all @xmath83 and @xmath84",
    ", we define @xmath85 to be the set of all isomorphism classes of connected plane tropical curves @xmath86 of degree @xmath1 and genus @xmath87 .",
    "[ rem - cycle ] note that for a connected graph @xmath25 the genus satisfies @xmath88 hence for a connected plane tropical curve of genus @xmath9 , we have @xmath89 , so there is one cycle which generates @xmath90 . when we avoid to pass an edge twice in both directions ,",
    "there is a unique way to choose a chain of flags around this cycle ( up to direction - we can go two ways around the cycle ; and up to starting point ) . in the following",
    ", we will therefore speak of `` the cycle '' of an element of @xmath85 of genus @xmath9 , meaning this chain of flags .",
    "the _ combinatorial type _ of an abstract @xmath43-marked tropical curve @xmath44 is the homeomorphism class of @xmath25 relative @xmath91 ( i.e.  modulo homeomorphisms that map @xmath46 to itself )",
    ". we can think about it as the graph with the information of the length of the bounded edges dropped .",
    "the _ combinatorial type _ of a plane tropical curve @xmath86 is the combinatorial type of @xmath44 together with the directions @xmath92 for all flags @xmath93 .",
    "@xmath94 is defined to be the subset of @xmath85 of tropical curves of combinatorial type @xmath95 .",
    "let @xmath95 be a combinatorial type in the space @xmath85 .",
    "the _ deficiency _",
    "@xmath96 is defined to be @xmath97 we will also speak of the deficiency @xmath98 of a curve @xmath99 .",
    "having defined elliptic tropical curves we now want to come to their dual newton subdivisions .",
    "let @xmath27 be an @xmath100-valent vertex of a plane tropical curve @xmath101 ( without markings ) and let @xmath102 be the counterclockwise enumerated edges adjacent to @xmath27 .",
    "draw in the @xmath103-lattice an orthogonal line @xmath104 of integer length @xmath105 ( where @xmath81 denotes the weight of @xmath28 , see remark [ rem - weightdir ] ) to @xmath106 , where @xmath107 starts at any lattice point and @xmath104 starts at the endpoint of @xmath108 , and where by `` integer length '' we mean @xmath109 .",
    "the balancing condition tells us that we end up with a closed @xmath100-gon . if we do this for every vertex we end up with a polygon in @xmath103 that is divided into smaller polygons .",
    "the polygon is called the _",
    "newton polygon _ of the tropical curve , and the division the corresponding _",
    "newton subdivision_. note that the ends of the curve correspond to line segments on the boundary of the newton polygon .",
    "the newton polygon of a curve of degree @xmath1 is the triangle @xmath110 with vertices @xmath111 , @xmath112 and @xmath113 . for more details on the dual newton subdivision of a tropical curve ,",
    "see @xcite , section 3.4 .",
    "some properties of plane tropical curves can be read off from their dual picture . here",
    "are some examples :    1 .",
    "a plane tropical curve is called _ simple _ if its dual subdivision contains only triangles and parallelograms ( see definition 4.2 of @xcite ) .",
    "( this property can also be defined without using the dual language . ) 2 .",
    "the _ genus _ of a simple plane tropical curve @xmath114 is equal to the number of lattice points of the subdivision contained in the interior of the newton polytope minus the number of parallelograms ( see lemma 4.6 of @xcite ) .",
    "3 .   [ tropdef - e ] let @xmath27 be a trivalent vertex of @xmath25 and @xmath115 the edges adjacent to @xmath27 .",
    "the _ multiplicity _ of @xmath27 is defined to be the area of the parallelogram spanned by the two directions of @xmath116 and @xmath117 .",
    "( due to the balancing condition this is independent of the choice of @xmath116 and @xmath117 . )",
    "it is equal to @xmath118 times the area of the dual triangle ( see definition 2.16 of @xcite ) .",
    "[ tropdef - f ] the _ multiplicity _",
    "@xmath119 of a @xmath42-valent tropical plane curve is the product over all multiplicities of the vertices . in the dual language",
    ", the multiplicity of a simple curve is the product over all double areas of triangles of the dual subdivision ( see definition 4.15 of @xcite ) .    for more details on dual newton subdivisions ,",
    "see for example @xcite , section 5 .",
    "let us study the space @xmath85 .",
    "there are only finitely many combinatorial types in the space @xmath85 ( analogously to 2.10 of @xcite ) .",
    "[ lem - dimofmalpha ] for every combinatorial type @xmath120 occurring in @xmath85 the space @xmath121 is naturally an ( unbounded ) open convex polyhedron in a real vector space of dimension @xmath122 , that is a subset of a real vector space given by finitely many linear equations and finitely many linear strict inequalities .",
    "the dimension of @xmath121 is equal to @xmath123    fixing a combinatorial type means we fix the homeomorphism class of @xmath25 and the directions of all flags .",
    "we do not fix the lengths @xmath34 of the bounded edges .",
    "( note that the length of an image @xmath124 is determined by @xmath34 and the direction . ) also , we can move an image @xmath125 in the whole plane .",
    "choose a root vertex @xmath27 of @xmath25 .",
    "two coordinates are given by the position of the image @xmath126 in the plane .",
    "@xmath127 coordinates are given by the lengths of the bounded edges ( which have to be positive ) .",
    "hence we can embed @xmath94 in @xmath128 . note that a graph with @xmath129 unbounded edges and of genus @xmath9 has @xmath130 bounded edges , whereas a rational graph with @xmath129 unbounded edges has @xmath131 bounded edges ( see for example @xcite , proof of 2.13 ) . for a genus @xmath9 curve @xmath99 ,",
    "the lengths of the bounded edges are not independent however , as some are contained in the cycle .",
    "so these lengths satisfy two conditions , namely that their images have to close up a cycle in @xmath10 .",
    "these conditions are only independent if @xmath132 .",
    "if @xmath133 there is one independent equation , and if @xmath134 there is none . hence the dimension of the polyhedron @xmath94 in @xmath128 is @xmath135 .",
    "note that the polyhedron is unbounded , because we can for example move the image of the root vertex in the whole plane . for rational curves ,",
    "no equations have to be fulfilled and we have @xmath136 .",
    "[ rem - boundarymalpha ] let @xmath95 be a combinatorial type occurring in @xmath85 .",
    "then every point in @xmath137 ( where the closure is taken in @xmath128 , see lemma [ lem - dimofmalpha ] ) can naturally be thought of as an element in @xmath85 .",
    "the corresponding map @xmath138 maps the boundary @xmath139 to a union of strata @xmath140 such that @xmath141 is a combinatorial type with fewer internal edges than @xmath95 .",
    "moreover , the restriction of @xmath142 to any inverse image of such a stratum @xmath143 is an affine map .",
    "note that by the proof of [ lem - dimofmalpha ] a point in the boundary of the open polyhedron @xmath144 corresponds to a tuple @xmath86 where some edges @xmath28 have length @xmath145 .",
    "such a curve is of a different combinatorial type then , because the homeomorphism class of the graph has changed .",
    "for all edges @xmath28 with length @xmath145 the vertices @xmath146 and @xmath147 of the two flags @xmath24 and @xmath32 with @xmath30=[f']=e$ ] are identified .",
    "we can as well remove the edges of length @xmath39 then .",
    "note that the balancing condition will be fulfilled at the new vertices .",
    "two examples what this can look like are shown in the following picture .",
    "the edges which tend to have length zero when we move towards the boundary of the open polyhedron @xmath121 are drawn in bold .",
    "let @xmath148 be the graph which is obtained by removing the edges of length @xmath39 .",
    "note that @xmath148 has fewer bounded edges than @xmath25 .",
    "the tuple @xmath149 is a tropical curve again , possibly of a smaller genus than @xmath86 .",
    "this shows that the points in the boundary @xmath150 can naturally be thought of as parametrized tropical curves in @xmath151 themselves .",
    "the combinatorial types @xmath141 that can occur in the boundary of @xmath121 , that is , in the image @xmath152 , have by construction fewer bounded edges than @xmath95 .",
    "finally , it is clear that the restriction of @xmath142 to the inverse image of any stratum @xmath153 is an affine map since the affine structure on any stratum is given by the position of the curve in the plane and the lengths of the bounded edges .",
    "[ def - containedinbound ] we will say that a type @xmath141 appears _ in the boundary _ of another type @xmath95 , if there is a point in @xmath154 that is identified with a curve of type @xmath141 ( as in the proof of proposition [ rem - boundarymalpha ] ) .",
    "our aim is to define a slightly different moduli space @xmath155 , where the strata of dimension bigger than @xmath129 are excluded and where we add a _ weight _ for each stratum .",
    "in fact , our moduli space should be something similar to an abstract tropical variety , a weighted polyhedral complex :    let @xmath156 be ( possibly unbounded ) open convex polyhedra in real vector spaces .",
    "polyhedral complex _ with cells @xmath156 is a topological space @xmath157 together with continuous inclusion maps @xmath158 such that @xmath157 is the disjoint union of the sets @xmath159 and the `` coordinate changing maps '' @xmath160 are linear ( where defined ) for all @xmath161 .",
    "we will usually drop the inclusion maps @xmath162 in the notation and say that the cells @xmath163 are contained in @xmath157 .",
    "the _ dimension _ @xmath164 of a polyhedral complex @xmath157 is the maximum of the dimensions of its cells .",
    "we say that @xmath157 is of _ pure dimension _",
    "@xmath164 if every cell is contained in the closure of a cell of dimension @xmath164 .",
    "a point of @xmath157 is said to be _ in general position _",
    "if it is contained in a cell of dimension @xmath164 .",
    "for a point @xmath165 in general position , we denote the cell of dimension @xmath166 in which it is contained by @xmath167 .",
    "a _ weighted polyhedral complex _ is a polyhedral complex such that there is a weight @xmath168 associated to each cell @xmath169 of highest dimension .",
    "we are now ready to define the moduli space @xmath155 , which is important for our methods :    [ def - relevant ] remove the strata of dimension bigger than @xmath129 from @xmath85 . also , remove the strata of rational curves which are not contained in the boundary of a genus @xmath9 curve as in [ def - containedinbound ] .",
    "let @xmath95 be a type such that @xmath170 . we associate the following weights to the strata of dimension",
    "@xmath129 :    1 .",
    "assume @xmath171 , and the curves of type @xmath95 are of genus @xmath9 .",
    "as we have already seen , the condition that the image of the cycle closes up in @xmath10 is given by two independent linear equations @xmath172 and @xmath173 on the lengths of the bounded edges .",
    "we associate as weight the index of the map @xmath174 ( for more details on lattices , maps between vector spaces and lattices and their indices , see @xcite.)[def - rel-1 ] 2 .",
    "assume @xmath175 . assume first that the @xmath176-valent vertex is adjacent to the cycle , that is , locally the curves look like the following picture : + in the notations above , @xmath177 , @xmath178 and @xmath67 denote the direction vectors of the corresponding edges ( @xmath43 and @xmath179 are chosen such that their greatest common divisor is @xmath9 ) .",
    "if @xmath180 , or if @xmath181 and the cycle is formed by three edges due to the presence of a marked point , we associate the weight @xmath182 .",
    "[ def - rel-2 ] if @xmath181 and no point is on the flat cycle , then we associate @xmath183 .",
    "( due to the balancing condition this definition is not dependent of the choice of @xmath67 . )",
    "+ in case the @xmath176-valent vertex is not adjacent to the cycle , we associate the weight @xmath39 .",
    "3 .   assume @xmath184 .",
    "assume first that the @xmath185-valent vertex is adjacent to the cycle , that is , locally the curves look like this : + where @xmath186 and @xmath67 denote the direction vectors of the corresponding edges .",
    "we associate the weight @xmath187 .",
    "( note that due to the balancing condition this definition is independent of the choice of @xmath186 and @xmath67 . ) in the case that there are two @xmath176-valent vertices or that the @xmath185-valent vertex is not adjacent to the cycle , we associate the weight @xmath39 .",
    "[ def - rel-3 ]    the strata of dimension @xmath129 or less together with these weights for the strata of top dimension form the space @xmath155 , called the _ moduli space of ( relevant ) elliptic tropical curves_.    the reason to drop the cells of dimension bigger than @xmath129 is that we want to construct later on a morphism to a polyhedral complex of the same dimension @xmath129 .",
    "the strata of dimension bigger than @xmath129 would not be mapped injectively to the image .",
    "we will only be interested in strata which are mapped injectively , therefore the strata of dimension higher than @xmath129 are not important to us and we can drop them .",
    "note that the definitions of weight do not depend on the choice of coordinates for the cell @xmath121 .",
    "this is clear for each case except the first one . in the first case ,",
    "the two equations given by the cycle do not depend on the choice of a root vertex , they depend only on the choice of an order for the bounded edges . but",
    "this corresponds to an isomorphism on @xmath128 of determinant @xmath35 , therefore the index of @xmath188 does no depend on this choice .",
    "the definition of the weights for the different strata seems somewhat unnatural .",
    "however , we will see that the weights are just the right ones for our proofs later on .",
    "the idea behind this definition is that we think of elliptic tropical curves as rational tropical curves with two additional marked points , whose images we require to coincide .",
    "the space of rational curves with two additional marked points is of course bigger than the space of elliptic curves , but it contains the space of elliptic curves as the kernel of the map @xmath189 .",
    "note that the index of @xmath189 is equal to @xmath190 where @xmath191 denotes the index of the sublattice generated by @xmath192 in @xmath193 ( see example 1.5 of @xcite ) .",
    "if @xmath133 , the weight we choose is derived in the same way : we compute the multiplicity of a rational curve with two additional marked points .",
    "sometimes we included a factor of @xmath19 in our weights .",
    "it seems maybe unnatural to allow weights which are not natural numbers .",
    "but the factors of @xmath19 are only necessary when the cycle of the elliptic curve `` allows automorphisms '' : when it is a loop consisting of one edge with two non distinguishable orientations , or when it consists of two non distinguishable edges . due to these factors",
    "we believe that the moduli space we construct here can be thought of as a `` tropical orbifold '' .",
    "[ lem - tildempoly ] the space @xmath155 ( defined in [ def - relevant ] ) is a weighted polyhedral complex of pure dimension @xmath129 .",
    "the cells are obviously the strata @xmath121 corresponding to relevant types . by [ lem - dimofmalpha ]",
    "they are open convex polyhedra . by proposition [ rem - boundarymalpha ] , their boundary",
    "is also contained in @xmath155 , and the coordinate changing maps are linear . by definition ,",
    "the highest dimension of a relevant cell is @xmath129 .",
    "furthermore , by definition each rational type which is contained in @xmath121 is in the boundary of a type of genus @xmath9 .",
    "each higher - valent vertex can be resolved to @xmath42-valent vertices .",
    "therefore each type is contained in the boundary of a type of codimension @xmath39 . by definition ,",
    "the strata of top dimension are equipped with weights as required .",
    "we also want to define morphisms between weighted polyhedral complexes .    [ def - morph ] a _ morphism _ between two weighted polyhedral complexes @xmath157 and",
    "@xmath194 is a continuous map @xmath195 such that for each cell @xmath196 the image @xmath197 is contained in only one cell of @xmath194 , and @xmath198 is a linear map ( of polyhedra ) .",
    "assume @xmath199 is a morphism of weighted polyhedral complexes of the same pure dimension , and @xmath200 is a point such that both @xmath165 and @xmath201 are in general position ( in @xmath157 resp .",
    "@xmath194 ) . then locally around @xmath165 the map @xmath202 is a linear map between vector spaces of the same dimension .",
    "we define the _ multiplicity _ @xmath203 of @xmath202 at @xmath165 to be the absolute value of the determinant of this linear map times the weight of the cell @xmath167 .",
    "note that the multiplicity depends only on the cell @xmath167 of @xmath157 in which @xmath165 lies .",
    "we will therefore also call it the multiplicity of @xmath202 in this cell .",
    "a point @xmath204 is said to be _ in @xmath202-general position _ if @xmath205 is in general position in @xmath194 and all points of @xmath206 are in general position in @xmath157 .",
    "note that the set of points in @xmath202-general position in @xmath194 is the complement of a subset of @xmath194 of dimension at most @xmath207 ; in particular it is a dense open subset .",
    "now if @xmath204 is a point in @xmath202-general position we define the _ degree _ of @xmath202 at @xmath205 to be @xmath208 note that this sum is indeed finite : first of all there are only finitely many cells in @xmath157 . moreover , in each cell ( of maximal dimension ) of @xmath157 where @xmath202 is not injective ( i.e.  where there might be infinitely many inverse image points of @xmath205 ) the determinant of @xmath202 is zero and hence so is the multiplicity for all points in this cell .",
    "moreover , since @xmath157 and @xmath194 are of the same pure dimension , the cones of @xmath157 on which @xmath202 is not injective are mapped to a locus of codimension at least 1 in @xmath194 .",
    "thus the set of points in @xmath202-general position away from this locus is also a dense open subset of @xmath194 , and for all points in this locus we have that not only the sum above but indeed the fiber of @xmath205 is finite .",
    "note that the definition of multiplicity @xmath209 in general depends on the coordinates we choose for the cells .",
    "however , we will use this definition only for the morphism @xmath210 ( see [ def - evj ] ) for which the absolute value of the determinant does not depend on the chosen coordinates , if they are chosen in a natural way ( in our case this means we choose a lattice basis of the space @xmath211 , see remark [ rem - detunique ] ) .",
    "the following maps will be important to count elliptic curves :    [ def - evj ] let @xmath212 denote the @xmath52-th evaluation map . by @xmath213",
    "we denote the combination of all @xmath43 evaluation maps .",
    "if @xmath99 is an elliptic curve , let @xmath214 be the minimal connected subgraph of genus @xmath9 of @xmath53 that contains the unbounded edge @xmath215 .",
    "note that @xmath216 can not contain vertices of valence 1 .",
    "so if we `` straighten '' the graph @xmath217 at all 2-valent vertices ( that is we replace the two adjacent edges and the vertex by one edge whose length is the sum of the lengths of the original edges ) then we obtain an element of @xmath218 that we denote by @xmath219 .",
    "( for an elliptic curve , @xmath220 . )",
    "if @xmath99 is rational , we define @xmath221 .",
    "we call @xmath222 the _ tropical @xmath2-invariant _ of @xmath99",
    ".    a combination of these maps yields @xmath223    the following picture shows an elliptic curve @xmath99 .",
    "the marked points are drawn as dotted lines .",
    "the subgraph @xmath148 is indicated with a bold dotted line .",
    "the image @xmath222 is an abstract tropical curve where the cycle has length @xmath224 .",
    "[ lem - evlinear ] the map @xmath225 restricted to a stratum @xmath121 is a linear map .",
    "the coordinates on @xmath121 are by [ lem - dimofmalpha ] given by a root vertex @xmath27 and an order on the bounded edges . of course",
    ", these coordinates do not need to be independent , but if they are not , they fulfill a linear condition themselves . as @xmath25",
    "is connected , we can reach @xmath46 from the root vertex @xmath27 by a chain of flags @xmath24 , such that @xmath30 $ ] is a bounded edge .",
    "then the position of @xmath226 is given as a sum @xmath227),\\ ] ] where the summation goes over all flags @xmath24 in the chain .",
    "hence the position @xmath226 is given by two linear expressions in the coordinates of @xmath121 .",
    "the length of the bounded edge of @xmath222 is by definition given as the sum of the lengths of all bounded edges contained in the cycle of @xmath148 that we straightened to get @xmath222 .",
    "[ lem - evpolymap ] let @xmath228 .",
    "then the map @xmath229 is a morphism of weighted polyhedral complexes of the same dimension .",
    "the space @xmath155 is a weighted polyhedral complex of dimension @xmath230 by [ lem - tildempoly ] .",
    "the space @xmath231 is by [ ex - trop10 ] isomorphic to @xmath232 .",
    "this is obviously a polyhedral complex with only one cell , and we can make it weighted by associating the weight @xmath9 to this cell .",
    "its dimension is @xmath233 , too .",
    "the map @xmath210 restricted to a cell of the weighted polyhedral complex @xmath155 is linear by [ lem - evlinear ] .",
    "furthermore , it maps each cell into the one cell of the space @xmath231 .",
    "we will from now on assume that @xmath228 , in order to have a morphism between polyhedral complexes of the same dimension .",
    "fix @xmath43 points @xmath234 and a @xmath2-invariant @xmath235 in @xmath210-general position ( see definition [ def - morph ] ) .",
    "then determine the set of tropical elliptic curves @xmath236 which pass through the points and have @xmath2-invariant @xmath235 .",
    "we count each such elliptic curve with its @xmath210-multiplicity , that is , we determine @xmath237 .",
    "define @xmath238 to be the _ number of tropical elliptic curves through @xmath4 points in general position and with fixed @xmath2-invariant_. our aim is to show that this definition does not depend on the choice of @xmath239 .",
    "this statement will be shown in theorem [ thm - degconst ] .",
    "[ rem - detunique ] given a stratum @xmath121 of top dimension we choose a lattice basis of the space @xmath121 in @xmath128 , which contains the lattice @xmath240 .",
    "( for @xmath128 , we choose natural coordinates given by a root vertex and an order of the bounded edges . ) with this choice , we can compute a matrix representation of @xmath210 and hence compute its determinant . we claim that the absolute value of this determinant ( and thus , the @xmath210-multiplicity ) does not depend on the choices we made .",
    "to see this , note first that a different choice of the root vertex or the order of the bounded edges corresponds to a basis change of determinant @xmath35 ( see remark 3.2 of @xcite ) .",
    "if we choose a different lattice basis for @xmath121 , then we have to multiply the matrix of @xmath210 with the basis change matrix .",
    "but as this is a basis change of lattice bases , it is of determinant @xmath35 and does therefore not change the absolute value of the determinant of @xmath210 .    the following remark helps us to determine @xmath241 in some cases :    [ rem - johannes ] let @xmath95 be a type of @xmath42-valent genus @xmath9 curves with @xmath171 .",
    "we want to determine the multiplicity of @xmath210 in the stratum @xmath121 . by definition",
    ", it is equal to the absolute value of the determinant of @xmath210 times the weight of the cell @xmath121 .",
    "the weight of the cell is defined to be the index of the lattice map @xmath188 , where @xmath172 and @xmath173 denote the two equations given by the cycle ( see [ def - relevant ] ) . to compute the @xmath210-multiplicity",
    ", we need to compute this weight , and then a matrix representation of @xmath210 restricted to @xmath242 . to get this matrix representation , we need a lattice basis of the subspace @xmath243 . however , lattice bases are in general not easy to determine .",
    "we can instead use example 1.7 of @xcite .",
    "it states that @xmath244 times the lattice index is equal to the absolute value of the determinant of the map @xmath245 ( where @xmath246 and @xmath2 denote here matrix representations of @xmath246 respectively @xmath2 in the coordinates given by the root vertex and the lengths of all bounded edges ) .",
    "this map goes from the space @xmath128 which surrounds @xmath121 .",
    "more precisely , @xmath121 is equal to @xmath247 .",
    "the bigger space @xmath128 does not parametrize tropical curves , as the length coordinates of a general vector of @xmath128 do not need to fulfill the conditions given by the cycle . but",
    "( after choosing coordinates and chains of flags from the root vertex to each marked point ) we can still write down the matrix of @xmath248 .",
    "note that while the matrix does depend on the choices we make , the absolute value of the determinant does not ( see remark 4.65 of @xcite ) .",
    "that is , to compute the multiplicity of @xmath210 in @xmath121 , we can write down a matrix representation for the map @xmath249 and compute its determinant . in the following , we will denote the map by @xmath249 , even though it is not uniquely determined by this term .",
    "it depends on the chosen matrix representation , that is , on the chosen chains of flags .",
    "we will keep in mind that @xmath250 is uniquely determined , though .",
    "compute @xmath250 for the following ( local ) picture of an elliptic curve .",
    "let @xmath27 be the root vertex .",
    "we choose the following chains of flags : for @xmath251 , we pass @xmath252 . for @xmath253 , we pass @xmath254 and @xmath255 . for @xmath189 , we pass @xmath254 , @xmath256 and @xmath257",
    ". then the matrix reads :    @xmath258    each row except the last represent two rows , the first column represents two columns .",
    "@xmath259 stands for the @xmath260 unit matrix .",
    "we add four other statements that help to determine the @xmath210-multiplicity in some cases :    [ lem - evjcontr-1 ] let @xmath134 , that is , @xmath99 contains a contracted loop .",
    "@xmath261 denotes the rational curve which arises from @xmath99 if we remove the loop .",
    "if the vertex @xmath27 to which the loop is adjacent is @xmath185-valent , then @xmath262 where @xmath263 denotes the multiplicity of the vertex @xmath27 of @xmath261 from which the loop was removed and @xmath264 denotes the multiplicity of the tropical curve @xmath261 .",
    "else the @xmath210-multiplicity of @xmath99 is @xmath39 .    to determine a matrix representation for @xmath210 , we do not have to consider equations given by the cycle and lattice bases  the lengths of the bounded edges are independent .",
    "that is , we can choose a root vertex and an order of the bounded edges and write down the matrix of @xmath210 with respect to this basis .",
    "note that in the @xmath2-row there is just one unit at the coordinate of the contracted edge , as no other edge is contained in the cycle . to compute the determinant",
    ", we can therefore remove this last line and the column of the coordinate of the contracted edge which forms the cycle .",
    "the remaining matrix consists of the evaluation maps in the @xmath4 marked points , and it does not take the contracted edge into account .",
    "that is , this matrix describes the evaluation in the marked points of the rational curve @xmath261 which arises when we remove the contracted edge .",
    "proposition 3.8 of @xcite tells us that the determinant of this matrix is equal to the multiplicity of the rational curve @xmath261 . to determine the @xmath210-multiplicity",
    ", we also have to multiply with the weight of the stratum in which @xmath99 lies .",
    "the only case where the weight is non - zero is [ def - relevant][def - rel-3 ] , so we can assume that the contracted loop is adjacent to a @xmath185-valent vertex @xmath27 , and denote the direction vectors of two of the other adjacent edges by @xmath186 and @xmath67 .",
    "then the weight of the stratum is @xmath187 by definition .",
    "if we remove the loop and consider the rational curve @xmath261 , then this weight is equal to @xmath265 , where @xmath263 denotes the multiplicity of the vertex @xmath27 to which the contracted loop was adjacent .    [ lem - evjcontr-2 ]",
    "let @xmath99 be a ( @xmath42-valent ) curve with a contracted bounded edge @xmath28 , which is not a loop .",
    "let @xmath261 denote the rational curve that arises if we remove @xmath28 and straighten the two @xmath118-valent vertices @xmath266 and @xmath267 emerging like this .",
    "let @xmath186 denote the direction of a remaining edge adjacent to @xmath266 , and let @xmath67 denote the direction of a remaining edge adjacent to @xmath267 .",
    "if @xmath28 is part of the cycle , then @xmath268    else the @xmath210-multiplicity of @xmath99 is @xmath39 .",
    "we assumed that the contracted bounded edge @xmath28 is adjacent to two different @xmath42-valent vertices .",
    "( these vertices have to be @xmath42-valent , as we only compute the @xmath210-multiplicity in strata of top dimension . )",
    "the balancing condition implies that at each of these two vertices the two other adjacent edges are mapped to opposite directions :    we are going to use remark [ rem - johannes ] to compute the @xmath210-multiplicity , that is , we use a matrix representation of @xmath269 , where @xmath172 and @xmath173 denote the two equations of the cycle",
    ". if @xmath28 is not part of the cycle its length is a coordinate which is needed neither for the evaluations nor for the map @xmath2 , so we get determinant @xmath39 .",
    "assume now that @xmath28 is part of the cycle .",
    "then @xmath28 is only needed for the map @xmath2 , as it is contracted by @xmath63 it is not needed to describe a position of the image of a marked point .",
    "that is , in the column for @xmath28 , we have a @xmath9 at the row of the map @xmath2 and @xmath39 in every other row . in the matrix of @xmath269 , we can choose a chain of flags to each marked point which avoids the edge @xmath28 .",
    "this is possible , as @xmath28 is contained in the cycle . in the two equations @xmath172 and @xmath173 , exactly one of the edges @xmath116 and @xmath117 will take part , and also exactly one of the edges @xmath270 and @xmath271 .",
    "assume without loss of generality that @xmath116 and @xmath270 are part of the cycle . if @xmath116 is used in a chain of flags to a marked point , then also @xmath117 , and if @xmath270 , then also @xmath271",
    "let @xmath272 denote the length of @xmath273 , and @xmath235 denote the length of @xmath28 .",
    "assume that the directions are as labelled in the picture .",
    "then the @xmath269-matrix looks like this :    @xmath274    we perform the following operations which do not change the absolute value of the determinant : we delete the last row and the @xmath235-column .",
    "we subtract the @xmath275-column from the @xmath276-column and we change the place of the @xmath276-column : it shall appear as first column . then , we subtract the @xmath277-column from the @xmath278-column and move the @xmath278-column to the second place . at last",
    ", we put the two rows @xmath172 and @xmath173 to the beginning .",
    "after these operations the matrix looks like this :    @xmath279    note that this matrix is now a block matrix with a @xmath260 block on the top left , and a block that we will denote by @xmath280 on the bottom right .",
    "that is , its determinant is equal to @xmath281 .",
    "now @xmath280 is the matrix of the evaluation map in the @xmath4 marked points of the rational curve @xmath261 which arises from @xmath99 when we remove the contracted bounded edge @xmath28 and straighten the two bounded edges @xmath116 and @xmath117 as well as the two bounded edges @xmath270 and @xmath271 to one edge .",
    "as before , proposition 3.8 of @xcite tells us that @xmath282 .",
    "that is , the @xmath210-multiplicity of @xmath99 is equal to @xmath182 times the multiplicity of the rational curve @xmath261 which arises after removing the contracted edge and straightening the adjacent edges .",
    "our argument here assumes that the edges @xmath283 are all bounded .",
    "however , we can prove the same if some of these edges are not bounded .",
    "their lengths do not appear as coordinates then , but also there can not be marked points behind unbounded edges .",
    "[ lem - evjcontr-3 ] let @xmath99 be a curve with a flat cycle ( that is , @xmath133 ) which is not adjacent to a marked point . if there is no @xmath176-valent vertex adjacent to the flat cycle , then @xmath284",
    "else , with the notations as in the picture below , we have @xmath285 where @xmath261 denotes the rational curve that arises if we glue the two edges that form the cycle to one edge of direction @xmath286 and straighten the @xmath118-valent vertex emerging like this .",
    "the following picture shows the flat cycle of the curve @xmath99 .",
    "we choose @xmath179 and @xmath43 such that @xmath287 .",
    "to determine the matrix of @xmath210 , we need a lattice basis of @xmath121 .",
    "as the equations of the cycle are given by @xmath288 , we can choose unit vectors for all coordinates except @xmath276 and @xmath275 , plus the vector with @xmath43 at the @xmath276-coordinate and @xmath179 at the @xmath275-coordinate .",
    "as @xmath287 , this is a lattice basis .",
    "the @xmath2-invariant of @xmath99 is given by @xmath289 .",
    "that is , in the @xmath2-row of the matrix , we have only zeros except for the column which belongs to the vector with @xmath43 at @xmath276 and @xmath179 at @xmath275 , there we have the entry @xmath290 .",
    "but then we can delete the @xmath2-row and this column .",
    "the determinant we want to compute is equal to @xmath291 times the determinant of the matrix which arises after deleting .",
    "this matrix can easily be seen to be the matrix of evaluating the points of the rational curve @xmath261 which arises after identifying the two edges which form the cycle . due to @xcite proposition 3.8 ,",
    "its determinant is equal to @xmath264 .",
    "the factor of @xmath182 ( respectively , @xmath292 if @xmath181 ) has to be included , because this is by definition [ def - relevant ] [ def - rel-2 ] the weight of the stratum @xmath121 .",
    "[ lem - evjcontr-4 ] let @xmath99 be a curve with @xmath132 and such that the cycle is formed by @xmath42 edges .",
    "then @xmath293 , where @xmath261 is the rational curve which arises when we shrink the cycle to a vertex @xmath27 .",
    "we compute the @xmath210-multiplicity of @xmath99 using remark [ rem - johannes ] .",
    "that is , we compute the determinant of the matrix @xmath269 , where @xmath172 and @xmath173 denote the two equations of the cycle .",
    "the following picture shows the curve locally around the cycle and fixes a labeling of the adjacent edges :    note that the matrix @xmath269 has a block form with a @xmath39 block on the bottom left , because the equations of the cycle and the @xmath2-invariant only need the three length coordinates of @xmath252 , @xmath254 and @xmath255 .",
    "the block on the top left is just the evaluation of the rational curve @xmath261 at the marked points  hence by @xcite proposition 3.8 , its determinant is equal to @xmath264 .",
    "so @xmath294 is equal to @xmath264 times the absolute value of the determinant of the matrix    @xmath295    where the last row stands for the two rows given by the equation of the cycle .",
    "the absolute value of this determinant can be computed to be @xmath296 which is  using the dual picture , for example  easily seen to be equal to @xmath297 :    the sum of the three determinants is equal to the double areas of the three small triangles , @xmath297 is equal to the double area of the big triangle .",
    "a _ string _ in a tropical curve @xmath99 is a subgraph of @xmath25 homeomorphic either to @xmath298 or to @xmath299 ( that is , a `` path '' starting and ending with an unbounded edge , or a path around a loop ) that does not intersect the closures @xmath300 of the marked points ( see also @xcite , definition 4.47 ) . if the number of marked points on @xmath99 is less than @xmath301 , then @xmath99 has a string .",
    "this follows from lemma 3.50 of @xcite .",
    "we will need the notion of a string in the following proof of the main theorem of this section :    [ thm - degconst ] let @xmath228 .",
    "the degrees @xmath302 do not depend on @xmath303 .",
    "( here @xmath304 denotes a configuration in @xmath210-general position consisting of @xmath4 points in @xmath10 and a length @xmath235 for the @xmath2-invariant . )",
    "analogously to the proof of 4.4 of @xcite , we have that the degree of @xmath305 is _ locally _ constant on the subset of @xmath306 of points in @xmath307-general position since at any curve that counts for @xmath308 with a non - zero multiplicity the map @xmath307 is a local isomorphism .",
    "the points in @xmath307-general position are the complement of a polyhedral complex of codimension 1 , that is they form a finite number of top - dimensional regions separated by `` walls '' that are polyhedra of codimension 1 .",
    "hence it remains to show that @xmath309 is locally constant at these points , too .",
    "such a general point on a wall is the image under @xmath310 of a general tropical curve @xmath99 of a type @xmath95 such that @xmath121 is of codimension 1 .",
    "so we have to check that @xmath309 is locally constant around such a point @xmath311 .",
    "more precisely , if @xmath303 is such a point on a wall , and @xmath99 is a curve through @xmath303 , we want to show that the sum of the @xmath210-multiplicities of the curves through @xmath312 near @xmath303 and close to @xmath99 does not depend on @xmath312 .",
    "let us determine what types @xmath95 are of codimension @xmath9 , using [ lem - dimofmalpha ] .    1 .",
    "[ case1]@xmath171 , @xmath95 is of genus @xmath9 and has one @xmath176-valent vertex ( besides the @xmath42-valent vertices ) ; 2 .",
    "[ case2 ] @xmath175 and @xmath95 has two @xmath176-valent vertices ; 3 .",
    "[ case3]@xmath175 and @xmath95 has one @xmath185-valent vertex ; 4 .",
    "[ case4]@xmath184 and @xmath95 has three @xmath176-valent vertices ; 5 .",
    "[ case5]@xmath184 and @xmath95 has one @xmath185-valent and one @xmath176-valent vertex ; 6 .",
    "[ case6]@xmath184 and @xmath95 has one @xmath313-valent vertex .",
    "note that the codimension @xmath9 case that @xmath95 is the type of a rational curve is missing here : the reason is that we do not `` cross '' such a wall consisting of rational curves , we can only enlarge the @xmath2-invariant if @xmath314 , not make it smaller .",
    "more precisely , the curves which pass through a configuration @xmath312 in the neighborhood of a point configuration through which a rational curve passes , are always of the same types ; the types ( and with them , the multiplicities with which we count ) do not depend on @xmath312 .    for each of the cases in the list",
    ", we have to prove separately that @xmath309 is locally constant around a curve @xmath99 of type @xmath95 .",
    "the proof for [ case1 ] is similar to the proof of 4.4 in @xcite .",
    "there are three types which have @xmath95 in their boundary .",
    "the following is a local picture :    to compute the @xmath210-multiplicity of a curve of each type , we use remark [ rem - johannes ] , that is , we compute a matrix representation of @xmath315 , where @xmath316 denote the two equations of the cycle",
    ". we can choose the coordinates in such a way that these three matrices only differ in one column - in the column corresponding to the new edge @xmath28 .",
    "then we can use the same operations as in 4.4 of @xcite to prove that the sum of the three determinants is @xmath39 .",
    "the matrices we use here differ from the ones in 4.4 of @xcite because they contain the two lines corresponding to @xmath172 and @xmath173 , and the line corresponding to the @xmath2-invariant",
    ". however , the argument does not change in the presence of these other lines . also , with the same argument as in 4.4 of @xcite , the question whether there is a curve of type @xmath317 through a given configuration @xmath312 close to @xmath303 depends on the sign of the determinant .",
    "so we can conclude that we either get the types where the determinant has positive sign or the types where it has negative sign .",
    "but as the sum is @xmath39 , the sum of the absolute values of those determinants , for which a curve exists , stays constant and does not depend on @xmath312 .",
    "so let us now come to [ case2 ] .",
    "first note that if none of the @xmath176-valent vertices is adjacent to the flat cycle , then we count all curves of a type which has @xmath95 in its boundary with the weight @xmath39 , so we do not have to consider this case .",
    "so at least one of the @xmath176-valent vertices is adjacent to the flat cycle . if exactly one of the @xmath176-valent vertices is adjacent to the flat cycle , then the only curves which have @xmath95 in their boundary and which do not count with weight @xmath39 are the curves where the other @xmath176-valent vertex is resolved , as in case [ case1 ] .",
    "the proof is then analogous to the proof of case [ case1 ] , only using the matrices of @xmath210 instead of the big matrices of @xmath269 .",
    "so we can assume now that both @xmath176-valent vertices are adjacent to the flat cycle .",
    "assume first that none of the edges adjacent to a @xmath176-valent vertex in the flat cycle is a marked point .",
    "we claim that @xmath99 has a string .",
    "consider the connected components of @xmath318 .",
    "as in the proof of 3.50 of @xcite , remove the closures of the marked points @xmath319 from @xmath25 one after the other .",
    "we only remove edges at @xmath42-valent vertices .",
    "therefore each removal can either separate one more component , or break a cycle .",
    "assume that all connected components are rational ( else @xmath99 contains a string ) .",
    "then one of our removals must have broken the cycle .",
    "as @xmath99 is marked by @xmath4 points , we end up with @xmath4 connected components .",
    "but then there has to be one connected component which contains two unbounded edges , hence @xmath99 contains a string .",
    "if @xmath99 has at least two strings then @xmath99 moves in an at least 2-dimensional family with the images of the marked points fixed . as @xmath320 is one - dimensional this means that @xmath99 moves in an at least 1-dimensional family with the image point under @xmath321 fixed .",
    "but then also the curves close to @xmath99 are not fixed , hence they count @xmath39 .",
    "so we do not have to consider this case .",
    "also , if for all curves @xmath261 which contain @xmath99 in their boundary the string does not involve an edge of the cycle , then @xmath99 ( and all curves @xmath261 ) move in an at least 1-dimensional family with the image point under @xmath321 fixed .",
    "so we do not have to consider this case either .",
    "so we assume now that @xmath99 lies in the boundary of a type which has exactly one string that involves ( at least ) one of the edges of the flat cycle .",
    "there are ( up to symmetry ) five possibilities for the string",
    ". we will show them in the following local picture .",
    "assume now that there is a marked point adjacent to a @xmath176-valent vertex of the flat cycle .",
    "then the removal of this marked point both breaks a cycle and separates two components .",
    "so we can not conclude that @xmath99 has a string .",
    "however , we can conclude that there is no other marked point adjacent to the cycle , as else two marked points would map to the same line . hence in this case",
    "the curve looks locally like our sixth picture below .",
    "as the cycle is not a string in the cases ( 1)-(3 ) and ( 5 ) , there must be a marked point adjacent to it .",
    "two marked points adjacent to the flat cycle are only possible if the string does not involve any edge of the flat cycle ( as in ( 3 ) and ( 5 ) ) .    in each of the six cases , there are four types which contain @xmath95 in their boundary ( see [ rem - boundarymalpha ] ) . the following picture shows the four types @xmath322 for case ( 1 )",
    ". we will give our argument only for case ( 1 ) , it is analogous in all other five cases .",
    "our first aim is to show that we can choose bases of the corresponding strata @xmath121 such that the matrices @xmath210 ( and the matrices @xmath269 for the types @xmath323 and @xmath324 ) contain a block which involves only the edges locally around the flat cycle .",
    "we can then make statements about the @xmath210-multiplicity ( with the aid of [ rem - johannes ] ) using these smaller blocks .",
    "choose the root vertex for the four types to be @xmath27 as indicated in the picture above . also choose the labeling for the edges around the cycle as above",
    "let @xmath325 be the directions of the @xmath273 ( as indicated in the picture ) .",
    "we then have @xmath326 . as @xmath327 , @xmath328 and @xmath329",
    "are mapped to the same line in @xmath10 , we can choose @xmath43 and @xmath179 with @xmath330 and @xmath331 such that @xmath332 .",
    "we will consider a matrix representation @xmath333 ( @xmath334 ) of @xmath210 for the types @xmath335 and @xmath336 and a matrix representation @xmath337 ( @xmath338 ) of @xmath269 for @xmath323 and @xmath324 .",
    "the @xmath210-multiplicity for @xmath335 is then given by @xmath339 , the @xmath210-multiplicity for @xmath336 is @xmath340 due to [ def - relevant][def - rel-2 ] .",
    "for @xmath323 , it is due to remark [ rem - johannes ] given by @xmath341 and for @xmath324 by @xmath342 . later on , we will also need to consider matrix representations @xmath343 and @xmath344 of @xmath210 for the types @xmath323 and @xmath324 .",
    "we will however not choose a lattice bases for those , so they are not useful for the computation of the @xmath210-multiplicity .",
    "we will specify later on what bases we choose for @xmath343 and @xmath344 .",
    "we choose a basis of the subspace @xmath345 for @xmath334 consisting of two unit vectors for the root vectors and unit vectors for all bounded edges except @xmath327 , @xmath328 and @xmath346 .",
    "in addition , we take two vectors with @xmath327 , @xmath328 and @xmath329-coordinates as follows : @xmath347 and @xmath348 . in fact , this is a lattice basis : as @xmath332 , we can find integer numbers such that @xmath349 .",
    "then we can complete our basis with the vector @xmath350 ( at @xmath351 ) and get a lattice basis of @xmath352 .",
    "for @xmath338 , we choose a basis of @xmath345 consisting of only unit vectors except three vectors involving the coordinates of @xmath353 .    because the bases we choose for the @xmath333 and for the @xmath337 differ only by a few vectors , there will be a block in which the matrices @xmath333 and @xmath337 ( @xmath338 ) do not differ .",
    "the following argumentation works therefore analogously for all six matrices @xmath354 , @xmath355 and @xmath356 .",
    "assume that @xmath357 unbounded ( nonmarked ) edges can be reached from @xmath27 via @xmath116 , @xmath358 via @xmath117 and so on .",
    "as the only string passes via @xmath271 and @xmath270 , there must be @xmath357 marked points which can be reached from @xmath27 via @xmath116 , @xmath358 marked points via @xmath117 , @xmath359 marked points via @xmath270 and @xmath360 via @xmath271 .",
    "note that the marked points which can be reached via @xmath116 and @xmath117 do not need any of the length coordinates of edges via @xmath270 or @xmath271 . as there are @xmath361 rows for the marked points via @xmath270 and @xmath271 and @xmath362 bounded edges via @xmath270 and @xmath271",
    ", all six matrices have a @xmath39 block on the top right . for @xmath355 and @xmath356",
    ", we also put the equations @xmath172 and @xmath173 of the cycle in the first block of rows .",
    "@xmath363    the block on the bottom right is the same for all six matrices .",
    "so we can disregard it and only consider the top left block given by the marked points which can be reached via @xmath116 and @xmath117 , the @xmath2-coordinate , @xmath172 and @xmath173 for @xmath355 and @xmath356 and the length coordinates of @xmath364 plus the length coordinates of bounded edges via @xmath116 respectively @xmath117 .",
    "choose a marked point @xmath253 which can be reached via @xmath116 and a marked point @xmath365 which can be reached via @xmath117 .",
    "choose the following order for the rows : begin with the marked points @xmath366 , then take the @xmath2-coordinate ( and for the matrices @xmath355 and @xmath356 the equations @xmath316 of the cycle ) .",
    "then take the remaining marked points .",
    "choose the following order for the columns : begin with @xmath126 , @xmath116 and @xmath117 .",
    "for the types @xmath335 and @xmath336 , take the two basis vectors involving @xmath367 and then @xmath346 .",
    "for the types @xmath323 and @xmath324 , take the three basis vectors involving @xmath353 . for @xmath355 and @xmath356 ,",
    "take the length coordinates of @xmath353 .",
    "then take the remaining length coordinates .",
    "note that each marked point which can be reached via @xmath116 has the same entries in the first 7 ( respectively , 9 for @xmath355 and @xmath356 ) columns as @xmath253 .",
    "each marked point which can be reached via @xmath117 has the same entries in the first 7 ( respectively , 9 ) columns as @xmath365 .",
    "that is , we can subtract the @xmath253-rows from all rows of marked points via @xmath116 and the @xmath365-rows from all rows of marked points via @xmath117 .",
    "then we have a @xmath39 block on the bottom left .",
    "note that the bottom right block is equal for all six matrices .",
    "that is , we can now go on with the four @xmath368-matrices and the two @xmath369 matrices .",
    "the determinants of the original six matrices only differ by the factor which is equal to the determinants of the corresponding @xmath368-matrices ( respectively , @xmath369 ) matrices .",
    "let us call these blocks @xmath370 , respectively @xmath371 . here",
    "are the four blocks @xmath372 , @xmath373 , @xmath374 and @xmath375 and their determinants :    @xmath376    @xmath377    @xmath378    @xmath379    @xmath380    @xmath381    @xmath382    @xmath383    a computation shows that @xmath384    note that in the cases ( 4 ) and ( 6 ) _ without marked points adjacent to the flat cycle _ we have to make a difference if @xmath181 . in this case ,",
    "definition [ def - relevant][def - rel-2 ] tells us that we have to multiply the types analogous to @xmath335 and @xmath336 ( which still contain a flat cycle ) with the factor @xmath385 respectively @xmath386 , instead of @xmath387 and @xmath388 .",
    "however , the types @xmath323 and @xmath324 are not different in these cases , so we count them only once .",
    "altogether , the weighted sum of determinants as above is still @xmath39 .    we still need to check which types occur for a given point configuration @xmath389 near @xmath312 .",
    "let @xmath390 be a configuration .",
    "if there exists a curve @xmath99 of type @xmath317 through @xmath389 , then @xmath391 gives us the coordinates of @xmath99 in @xmath392 in the basis @xmath393 .",
    "that it , the first two coordinates of the vector @xmath394 denote the position of the root vertex , and all other coordinates the lengths of the bounded edges of @xmath99 .",
    "a curve of type @xmath317 exists if and only if all coordinates of the vector @xmath395 which correspond to lengths are positive .",
    "choose @xmath389 close to the configuration @xmath312 , through which a curve of type @xmath95 exists .",
    "by continuity of @xmath396 , all coordinates of @xmath395 except the length of @xmath346 ( @xmath334 ) , respectively of @xmath346 and @xmath397 ( @xmath338 ) , are positive .    note that there is a curve of type @xmath317 ( @xmath334 ) through @xmath389 if and only if the @xmath346-coordinate of @xmath391 is positive .",
    "now we specify which bases we choose for the types @xmath323 and @xmath324 . for @xmath323 ,",
    "begin again with the two unit vectors for the position of the root vertex .",
    "take unit vectors for all bounded edges which are not contained in the cycle .",
    "let @xmath398 take the three vectors with entries @xmath399 at the coordinates of @xmath353 .",
    "( let the vector with the entries @xmath400 be the last basis vector . )",
    "these three vectors are linearly independent and satisfy the conditions given by the cycle .",
    "however , we can not say whether this basis is a lattice basis of @xmath401 .",
    "so we do not know whether the determinant of the matrix @xmath343 is equal to the @xmath210 multiplicity of @xmath323 .",
    "but we are not interested in the determinant of @xmath343 here , we just want to use @xmath343 to check whether there is a curve of type @xmath323 through @xmath389 or not .",
    "note that the last basis vector is the only one which involves the lengths of @xmath346 and @xmath397 . as due to the balancing condition we have @xmath402 and @xmath403 , the two entries of this vector corresponding to these two lengths are positive .",
    "that is , there is a curve of type @xmath323 through @xmath389 if and only if the last coordinate of @xmath404 ( that is , the coordinate with which we have to multiply our last basis vector to get the lengths ) is positive .    for @xmath324",
    ", choose besides the unit vectors the three vectors with entries @xmath405 at the coordinates of @xmath353 , where @xmath406 the two entries of @xmath407 corresponding to the lengths of @xmath346 and @xmath397 are negative .",
    "hence there is a curve of type @xmath324 through @xmath389 if and only if the last coordinate of @xmath408 ( that is , the coordinate with which we have to multiply our last basis vector to get the lengths ) is negative .",
    "for all four types , we are interested in the last coordinate of @xmath391 . by cramer",
    "s rule , this last coordinate is equal to @xmath409 , where @xmath410 denotes the matrix where the last column of @xmath333 is cancelled and replaced by @xmath389 .",
    "note that the four matrices @xmath354 only differ in the last column .",
    "hence the matrices @xmath411 do not depend on @xmath52 , and we can decide whether there is a curve of type @xmath317 through @xmath389 by determining the sign of @xmath412 .",
    "( this argument is analogous to the proof of proposition 4.4 in @xcite . )",
    "recall that @xmath413 is a product of a factor which does not differ for all four types and a factor which is equal to the determinant of a @xmath368-matrix @xmath370 which describes a curve of type @xmath317 `` locally around the cycle '' .",
    "here are the two matrices @xmath414 and @xmath415 and their determinants :    @xmath416    @xmath417    @xmath418    @xmath419    we know that @xmath420 , @xmath421 and @xmath422 .",
    "so there are now two cases to distinguish :    * @xmath423  then @xmath424 is negative .",
    "as we have seen , a curve of type @xmath324 exists if and only if the last coordinate of @xmath425 is negative , hence if and only if @xmath426 ( a matrix which depend only on @xmath389 , not on @xmath52 ) is positive .",
    "@xmath427 , @xmath428 are both negative , a curve of one of these types exists if the last coordinate of @xmath429 ( @xmath334 ) is positive , hence if @xmath426 is negative .",
    "@xmath430 is positive , and a curve of this type exists if the last coordinate of @xmath431 is positive , hence if @xmath426 is positive . hence @xmath335 and @xmath336 are on one side of the `` wall '' , @xmath323 and @xmath324 on the other .",
    "but as in this case equation [ eq1 ] from above reads @xmath432 we have that the sum of the @xmath210-multiplicities of the curves through a configuration near the wall stays constant .",
    "* @xmath433  then @xmath424 is positive .",
    "a curve of type @xmath324 exists if and only if @xmath426 is negative .",
    "so in this case @xmath335 , @xmath336 and @xmath324 are on one side of the  wall  and @xmath323 on the other . but",
    "equation [ eq1 ] from above reads @xmath434 and we have again that the sum of the @xmath210-multiplicities of the curves through a configuration near the wall stays constant .",
    "let us now come to case [ case3 ] . as before we can argue that only those curves count , where the @xmath185-valent vertex is adjacent to the flat cycle .",
    "then the following curves contain @xmath95 in the boundary and do not count @xmath39 :    the proof is here again analogous to case [ case1 ] , only using the `` small '' matrices of @xmath210 .    in case [ case4 ] ,",
    "all curves which have @xmath95 in their boundary count @xmath39 . in case",
    "[ case5 ] , there is only one possibility with curves that do not count @xmath39 : those where the cycle is adjacent to the @xmath185-valent vertex",
    ". then the curves which have @xmath95 in their boundary are the curves where the @xmath176-valent vertex is resolved , as in [ case1 ] .",
    "the proof is analogous to case [ case1 ] , except that we use the `` small '' matrices for @xmath210 .    in case",
    "[ case6 ] , the @xmath313-valent vertex has to be adjacent to the cycle , because otherwise every curve which has @xmath95 in its boundary would count @xmath39 .",
    "so we can now assume that there is a @xmath313-valent vertex , where two of the adjacent edges are of direction @xmath39 and form a loop . to resolve this @xmath313-valent vertex ,",
    "we can either form a @xmath185-valent vertex with a loop and a @xmath42-valent vertex ( these curves are contained in strata of top dimension then ) , or we can resolve it to four @xmath42-valent vertices .",
    "( we can not form a flat cycle from the given @xmath313 edges : the contracted edge must be part of the cycle , and it can either be the whole cycle itself , or it forces the cycle to span @xmath10 . ) in the second case , two of the four @xmath42-valent vertices are connected by the contracted edge and therefore mapped to the same image point in @xmath10 .",
    "now we want to use the statement that the number of rational curves through given points does not depend on the position of the points for our case here ( see @xcite , respectively use the analogous proof as for proposition 4.4 of @xcite ) .",
    "more precisely , if there is a point configuration through which a curve with a @xmath176-valent vertex passes , and we disturb the point configuration slightly , then we always get the same number of tropical curves ( counted with multiplicity ) passing through the new point configuration .",
    "the image of the @xmath313-valent vertex ( and its adjacent edges ) in @xmath10 looks like a @xmath176-valent vertex .",
    "the types with one @xmath185-valent and one @xmath42-valent vertex are mapped to two @xmath42-valent vertices , and the type with four @xmath42-valent vertices is mapped to two @xmath42-valent vertices and a crossing of two line segments .",
    "that is , the images of the @xmath313-valent vertex as well as of all types which contain it in their boundary look like the possible resolutions of a @xmath176-valent vertex .",
    "we know that there are three types which contain a @xmath176-valent vertex in their boundary , and we only have to check how we can add contracted bounded edges to these @xmath42 types , and with which multiplicity they are counted .",
    "the following picture shows the seven possible ways to add contracted bounded edges to the three types :    note that we can vary the length of the contracted bounded edge in each type , so the curves of these types can have any possible @xmath2-invariant .",
    "the question whether there is a curve of type @xmath317 through a configuration @xmath435 depends therefore only on the question whether the image of the curve passes through @xmath436 .",
    "if a curve of type @xmath335 passes through @xmath303 , then also a curve of type @xmath336 and vice versa .",
    "the same holds for @xmath323 and @xmath324 , and for @xmath437 , @xmath438 and @xmath439 .",
    "so we only have to see that the sum of the @xmath210-multiplicities of the types whose images are equal can be written as a factor times the multiplicity of the rational curve which arises after removing the contracted bounded edge ( and straightening the other edges ) .",
    "then the statement follows from the statement that the number of rational curves through given points does not depend on the position of the points ( see @xcite , respectively proposition 4.4 of @xcite ) . to see this",
    ", we pass to the dual pictures .",
    "the @xmath176-valent vertex is dual to a quadrangle .",
    "the images of curves of type @xmath335 and @xmath336 are dual to a subdivision of this quadrangle in two triangles .",
    "the same holds for the images of curves of type @xmath323 and @xmath324 , however the two triangles arise here by adding the other diagonal .",
    "images of curves of type @xmath437 , @xmath438 and @xmath439 are dual to a subdivision consisting of one parallelogram and two triangles .",
    "lemma [ lem - evjcontr-1 ] tells us that the @xmath440-multiplicity of a curve of type @xmath335 is equal to @xmath441 times the multiplicity of the rational curve which arises after removing the contracted bounded edge .",
    "( recall that the multiplicity of a vertex is by definition equal to @xmath442 , where @xmath443 denotes the dual triangle . )",
    "analogously the @xmath210-multiplicity of a curve of type @xmath336 is equal to @xmath444 times the multiplicity of the same rational curve .",
    "the sum is equal to @xmath445 times the multiplicity of the rational curve , where @xmath205 denotes the quadrangle .",
    "we get the same for curves of type @xmath323 and @xmath324 .",
    "the sum of the @xmath210-multiplicities of @xmath437 , @xmath438 and @xmath439 is again by lemma [ lem - evjcontr-1 ] and lemma [ lem - evjcontr-2 ] equal to @xmath446 times the multiplicity of the corresponding rational curve .",
    "hence the statement follows .",
    "now we want to use the independence of @xmath302 from @xmath303 to compute @xmath302 with the aid of a special configuration @xmath447 - a configuration where the @xmath2-invariant @xmath235 is very large .",
    "[ prop - jbounded ] let @xmath228 and @xmath448 be a point in @xmath307-general position whose @xmath2-invariant is very large ( that is , whose image @xmath449 is a curve with a bounded edge of a very large length ) .",
    "then every tropical curve @xmath450 with @xmath451 has a contracted bounded edge .",
    "the proof is similar to proposition 5.1 of @xcite .",
    "we have to show that the set of all points @xmath452 is bounded in @xmath453 , where @xmath99 runs over all curves in @xmath454 with non - zero @xmath307-multiplicity that have no contracted bounded edge and satisfy the given incidence conditions at the marked points .",
    "as there are only finitely many combinatorial types ( analogously to 2.10 of @xcite ) we can restrict ourselves to curves of a fixed ( but arbitrary ) combinatorial type @xmath120 .",
    "since @xmath455 is in @xmath307-general position we can assume that the curves are @xmath42-valent , respectively contain a flat cycle adjacent to a @xmath176-valent vertex ( it can not contain a contracted cycle , as we assume that is contains no contracted bounded edges at all ) .    assume first that @xmath99 is @xmath42-valent . as @xmath99 is marked by @xmath4 points we can conclude with 3.50 of @xcite that @xmath99 has a string .",
    "analogously to the proof of theorem [ thm - degconst ] above , we get that there is precisely one string .",
    "so let @xmath456 be the unique string in @xmath99 .",
    "assume first that @xmath457 .",
    "then analogously to the proof of 5.1 of @xcite , we can see that the movement of the string is bounded by the adjacent bounded edges , except if the string consists of only two neighboring unbounded edges .",
    "but in this case the only length which is not bounded can not contribute to the @xmath2-invariant .",
    "so in any case @xmath222 is bounded .",
    "assume now @xmath458 .",
    "as this is the only string , there have to be bounded edges adjacent to the cycle .",
    "these bounded edges restrict the movement of the cycle , too . again @xmath222 is bounded .",
    "now assume @xmath99 has a flat cycle and a @xmath176-valent vertex adjacent to it , and assume no marked point is adjacent to that @xmath176-valent vertex . then all marked points are adjacent to a @xmath42-valent vertex , and hence we can analogously to 3.50 of @xcite see that the curve contains a string . as above , there is exactly one string and its movement is bounded",
    ". now assume that there is a marked point adjacent to the flat cycle",
    ". then we can not use 3.50 of @xcite to conclude that @xmath99 has a string .",
    "however , the image of the cycle can still not grow arbitrary large :    the edge @xmath117 has to be bounded : its direction is not a primitive integer vector , as it is equal to the sum of the directions of the two edges of the flat cycle , and therefore it can not be an unbounded edge .",
    "but then the cycle can not grow arbitrary large .    as we know that the number of curves @xmath459 ( counted with multiplicity )",
    "does not depend on @xmath303 by [ thm - degconst ] , we can now choose a special configuration @xmath447 where the @xmath2-invariant @xmath235 is very large .",
    "then by [ prop - jbounded ] we can conclude that all curves @xmath460 contain a contracted bounded edge , which is contained in the cycle . as in lemma [ lem - evjcontr-1 ] and lemma [ lem - evjcontr-2 ]",
    ", this contracted bounded edge can either be a loop itself ( which is then adjacent to a @xmath185-valent vertex ) , or the contracted bounded edge is adjacent to two @xmath42-valent vertices . in both cases , we know that we can form a rational curve @xmath261 of @xmath99 by removing the contracted edge and straightening other edges , and we can compute the @xmath210-multiplicity in terms of the multiplicity of this rational curve .",
    "note that a rational curve which appears like this is @xmath42-valent , as we take an elliptic curve of codimension @xmath39 .",
    "the following lemma shows that we can also `` go back '' : we can form elliptic curves out of a given rational curve which passes through @xmath436 .",
    "define _ tropical general position _ of the points @xmath436 as in @xcite , definition 4.7 .",
    "then only simple tropical curves pass through @xmath436 .",
    "in particular , there are only triangles and parallelograms in the dual newton configurations of these curves .",
    "[ lem - ratel ] let @xmath228 .",
    "take the configuration @xmath447 where the @xmath2-invariant @xmath235 is very large , and such that @xmath436 are in tropical general position .",
    "let @xmath261 a rational curve which passes through the points @xmath436 .",
    "then there are several ways to built an elliptic curve @xmath99 with @xmath2-invariant @xmath235 out of @xmath261 , and the sum of the @xmath210-multiplicities of these elliptic curves is equal to @xmath461 .",
    "let @xmath27 be a @xmath42-valent vertex of @xmath261 .",
    "then we can make an elliptic curve @xmath99 out of @xmath261 by adding a contracted loop at @xmath27 .",
    "there is only one possibility for the length of this loop , as we want to reach that @xmath462 .",
    "the @xmath210-multiplicity of @xmath99 is by [ lem - evjcontr-1 ] equal to @xmath463 , where @xmath443 denotes the triangle dual to @xmath27 .",
    "assume that there is a crossing of two edges @xmath116 and @xmath117 of @xmath261 , that is , the images @xmath464 and @xmath465 intersect in one point .",
    "then we can add a contracted bounded edge and split @xmath116 and @xmath117 into two edges each .",
    "the length of these edges are uniquely determined by the image .",
    "the length of the new contracted edge is uniquely determined by the prescribed @xmath2-invariant @xmath235 .",
    "the multiplicity of the elliptic curve @xmath99 we built like this is due to lemma [ lem - evjcontr-2 ] equal to @xmath466 , where @xmath186 and @xmath67 denote the two directions of @xmath116 and @xmath117 and @xmath165 denotes the parallelogram dual to the crossing of @xmath116 and @xmath117 .",
    "so it remains to show that @xmath467 , where @xmath443 goes over all triangles in the dual newton subdivision of @xmath261 and @xmath165 goes over all parallelograms . to see this",
    ", we use the theorem of pick ( see @xcite , section 5.3 ) . denote the number of interior lattice points of a polygon @xmath205 by @xmath468 and the number of lattice points on the boundary which are not vertices by @xmath469 . then pick s formula states that @xmath470 for a lattice triangle @xmath443 and @xmath471 for a parallelogram @xmath165 .",
    "so we can rewrite the sum from above as @xmath472 where the last equality holds , because @xmath99 is rational and the genus of a simple tropical curve is equal to the number of points of the subdivision minus the number of parallelograms .",
    "now we know that the interior lattice points of the big triangle @xmath110 ( which is the newton polygon of curves of degree @xmath1 ) that are not contained in the subdivision must either be interior points of a triangle or a parallelogram or on the boundary of a triangle or parallelogram . in the first case , they are counted in @xmath473",
    "respectively @xmath474 of a polygon . in the latter case , as they are interior points of @xmath110 , they are part of the boundary of exactly two polygons .",
    "that is , in our above sum , they are counted as @xmath475 respectively @xmath476 for two polygons .",
    "hence the first part of the sum counts all interior points which are not part of the subdivision .",
    "so we have @xmath477    we can now sum up our results to prove our main theorem :    [ th - largej ] the number @xmath0 of tropical elliptic curves passing through @xmath4 points and with a fixed @xmath2-invariant , counted with @xmath210-multiplicity , is equal to @xmath478 , where @xmath14 denotes the number of rational curves through @xmath4 points ( counted with multiplicity ) .    the number of tropical elliptic curves passing through @xmath4 points and with a fixed @xmath2-invariant is equal to @xmath302 , where we can choose any general configuration @xmath447 due to [ thm - degconst ] . we choose a configuration with a very large length @xmath235 as in [ prop - jbounded ] , and conclude that every elliptic curve passing through this configuration has a contracted bounded edge . from each such elliptic curve with a contracted",
    "bounded edge we can form a rational curve by removing the contracted edge and straightening divalent vertices , if necessary .",
    "also , [ lem - ratel ] tells us that we can go `` backwards '' and form an elliptic curve with @xmath2-invariant @xmath235 from each rational curve through @xmath436 , and that each rational curve contributes with the factor @xmath479 to our sum of elliptic curves .",
    "altogether , we have @xmath480 elliptic curves with @xmath2-invariant @xmath235 through @xmath436 .    the numbers @xmath0 and @xmath18 coincide , if @xmath481 .",
    "theorem [ th - largej ] tells us that @xmath482 .",
    "the latter is equal to @xmath483 by g.  mikhalkin s correspondence theorem ( see theorem 1 of @xcite ) and due to pandharipande s count ( @xcite ) , this is equal to @xmath18 .",
    "in the last section , we interpreted a set of rational curves through a given point configuration as elliptic curves with a very large @xmath2-invariant ( and a contracted bounded edge ) .",
    "now , we want to interpret the same set of rational curves as elliptic curves with @xmath2-invariant @xmath39 .",
    "section [ sec - mult ] helps us to express the multiplicity with which we count the elliptic curves in terms of the rational curves we started with .",
    "we will see that we have to count these rational curves with completely different factors than in the previous chapter .",
    "[ lem - ratsmallj ] the number of elliptic curves with a fixed ( very small ) @xmath2-invariant and passing through @xmath4 points in tropical general position is equal to @xmath484 where @xmath99 goes over all rational curves through the @xmath4 points and @xmath443 goes over all triangles in the newton subdivision dual to @xmath99 .    given a rational curve @xmath99 , how can we interpret it as an elliptic curve with @xmath2-invariant @xmath39 ? to answer this question , we have to determine how the elliptic curves @xmath261 with a very small @xmath2-invariant which have @xmath99 in their boundary look like .",
    "there are three possibilities for @xmath261 :    let @xmath485 .",
    "then the cycle has to disappear to a ( @xmath42-valent ) vertex of @xmath99 , hence it must be formed by three edges . due to lemma [ lem - evjcontr-4 ] the @xmath210-multiplicity is @xmath486 then . for each vertex @xmath27 of the rational curve @xmath99",
    ", there are @xmath487 possibilities that a non degenerate cycle disappears to @xmath27 , where @xmath488 denotes the triangle dual to @xmath27 and @xmath487 the number of interior points of this triangle .",
    "hence , to count the elliptic curves with a non degenerate cycle we have to count each rational curve @xmath99 with the factor @xmath489 where @xmath443 goes over all triangles in the newton subdivision dual to @xmath99 .",
    "let @xmath490 . if @xmath28 is an edge of @xmath99 with weight bigger @xmath9 , then there can be a small flat cycle at both sides of @xmath28 .",
    "the edge @xmath28 is dual to an edge with interior points in the dual newton subdivision , and it is in the boundary of two triangles @xmath491 and @xmath492 , dual to the two end vertices @xmath266 and @xmath267 of @xmath28 .",
    "assume the flat cycle is adjacent to the vertex @xmath266 , and assume that it is formed by two edges with directions @xmath177 and @xmath178 , with @xmath332 and @xmath493 , where @xmath67 denotes the direction of @xmath28 .",
    "then by [ lem - evjcontr-3 ] the @xmath210-multiplicity of this curve is @xmath494 where @xmath252 denotes the direction of another edge adjacent to @xmath266 . respectively ,",
    "if @xmath181 it is @xmath495 assume @xmath81 is even .",
    "then there are @xmath496 possibilities to separate @xmath28 to two edges with different directions ( that is , with @xmath180 ) .",
    "each counts with the factor @xmath497 .",
    "also , there is one possibility to separate it to two edges with the same direction , which counts @xmath498 .",
    "altogether , we have to count the rational curve with the factor @xmath499 assume @xmath81 is odd . then there are @xmath500 possibilities to split @xmath28 to two edges with different direction , and each counts with the factor @xmath497 . in any case",
    ", we have to count with the factor @xmath501 .",
    "note that @xmath502 is equal to the number of lattice points on the side of the boundary of @xmath491 which is dual to @xmath28 .",
    "but as we have to count these possibilities for all edges of higher weight , we have to add it for all three sides of @xmath491 , that is , altogether , we get @xmath503 . hence , to count the elliptic curves with a flat cycle we have to count each rational curve @xmath99 with the factor @xmath504 where @xmath443 goes over all triangles in the newton subdivision dual to @xmath99 .",
    "let @xmath505 . by [ lem - evjcontr-1 ]",
    "we have to count it with the factor @xmath506 . hence , to count the elliptic curves with a contracted cycle we have to count each rational curve @xmath99 with the factor @xmath507 where @xmath443 goes over all triangles in the newton subdivision dual to @xmath99 .      at last ,",
    "we want to apply lemma [ lem - ratsmallj ] to a set of rational curves passing through a certain point configuration , namely the point configuration which is used in @xcite , theorem 2 , to prove that marked tropical curves are dual to lattice paths .",
    "our application results in a faster way to count lattice paths dual to rational curves .",
    "let @xmath509 with a very small @xmath510 .",
    "due to @xcite theorem 2 we know that the number of @xmath511-increasing paths in the triangle @xmath110 is equal to the number of tropical curves through a certain point configuration @xmath512 .",
    "use the notations of chapter 3 of @xcite .",
    "the tropical curves through @xmath512 are dual to a set of newton subdivisions . in proposition 3.8 and remark 3.9 of @xcite",
    "we have seen that we can count instead of these newton subdivisions the column - wise newton subdivisions for a path .",
    "note that the set of newton subdivisions which really appear as dual subdivisions of a tropical curve through @xmath512 and the column - wise newton subdivisions only differ in the location of some parallelograms , the size and locations of the triangles coincide . as for our sum from [ lem - ratsmallj ]",
    "we only count the triangles , we can therefore use the column - wise newton subdivisions as well . in remark 3.7 of @xcite",
    "we have seen that a path can only have steps which move one column to the right ( with a simultaneous up or down movement ) , or steps which stay in the same column and move down .",
    "the following picture shows such a path and recalls the notations .    for the path in the picture",
    ", we have @xmath513 , @xmath514 , @xmath515 , @xmath516 , @xmath517 , @xmath518 and @xmath519 ; and @xmath520 , @xmath521 , @xmath522 , @xmath523 , @xmath524 .",
    "the only possibilities for the sequences @xmath525 are : @xmath526 , @xmath527 , @xmath528 , @xmath529 , @xmath530 .",
    "the only possibilities for the sequences @xmath531 are : @xmath532 , @xmath533 , @xmath534 , @xmath535 , @xmath536 , @xmath537 .",
    "proposition 3.8 of @xcite then gives us a formula to compute the number of column - wise newton subdivisions times the multiplicity for a path . to get the number we want",
    ", we only have to multiply with the factor @xmath538 for each triangle .",
    "but note that as in remark 3.9 of @xcite the position of the triangles below a path are such that they lie in one column and point to the left .",
    "that is , they do not have any interior lattice points , and their area is equal to @xmath19 times the length of their right side :      [ cor - formrat ] the following formula holds for all @xmath539 : @xmath540 where the first sum goes over all paths @xmath541 and the second sum goes over all sequences @xmath542 and @xmath543 such that @xmath544 , @xmath545 , @xmath546 and @xmath547 , and where for a sequence @xmath548 @xmath549 denotes the sum @xmath550 .    using g.  mikhalkin s correspondence theorem ( see theorem 2 of @xcite )",
    "we conclude that @xmath551 .",
    "furthermore , @xmath552 , where we can choose any point configuration @xmath303 by theorem [ th - largej ] and theorem [ thm - degconst ] .",
    "so @xmath553 and it remains to argue why the right hand side of the formula above ( times @xmath479 ) is equal to @xmath0 .",
    "we can choose a point @xmath447 with a very small last coordinate @xmath235 for the cycle length , and such that @xmath436 are in the position described in @xcite , theorem 2 .",
    "we apply lemma [ lem - ratsmallj ] that tells us that @xmath554 , where @xmath99 goes over all rational curves through the @xmath4 points and @xmath443 goes over all triangles in the newton subdivision dual to @xmath99 .",
    "the newton subdivision dual to the rational curves through @xmath436 differ from the column - wise newton subdivisions ( as defined in remark 3.9 of @xcite ) only in the location of some parallelograms .",
    "size and location of the triangles coincide .",
    "therefore the above sum is equal to @xmath555 , where @xmath556 goes over all column - wise newton subdivisions arising from newton subdivisions dual to rational tropical curves through @xmath436 .",
    "proposition 3.8 of @xcite gives us a formula to compute the number of column - wise newton subdivisions times their multiplicity .",
    "we only have to multiply this formula with the factor @xmath538 for each triangle . as in remark 3.9 of @xcite",
    "the position of the triangles in a column - wise newton subdivision are such that they lie in one column and point to the left .",
    "that is , they do not have any interior lattice points , and their area is equal to @xmath19 times the length of their right side .",
    "the factor @xmath557 counts the possibilities to arrange parallelograms below and above the path ( hence the number of newton subdivisions ) .",
    "the factor @xmath558 counts the double areas of the triangles - hence the multiplicity of the curves dual to the path .",
    "( see also remark 3.9 of @xcite ) .",
    "the factor @xmath559 is the factor @xmath538 for each triangle .",
    "note that even though this sum looks at the first glance more complicated than the sum from proposition 3.8 of @xcite , it is easier to compute , because we count a lot of paths with the factor @xmath39  all paths with only steps of size @xmath9 .",
    "there are three numbers in the first row below each path : the first number is the number of possible newton subdivisions .",
    "the second number is the multiplicity of the tropical curves dual to these newton subdivisions .",
    "( hence the product of the first two numbers is the multiplicity of the path . )",
    "the third number is the factor @xmath564 with which we have to count here . the fourth number , in the second row",
    ", is the product of the three numbers above , so we have to count each path with that number .",
    "the sum of the numbers is the second row is @xmath565 , as claimed ."
  ],
  "abstract_text": [
    "<S> in complex algebraic geometry , the problem of enumerating plane elliptic curves of given degree with fixed complex structure has been solved by r.pandharipande @xcite using gromov - witten theory . in this article we treat the tropical analogue of this problem , the determination of the number @xmath0 of tropical elliptic plane curves of degree @xmath1 and fixed `` tropical @xmath2-invariant '' interpolating an appropriate number of points in general position and counted with multiplicities . we show that this number is independent of the position of the points and the value of the @xmath2-invariant and that it coincides with the number of complex elliptic curves ( with @xmath2-invariant @xmath3 ) .    </S>",
    "<S> the result can be used to simplify g.  mikhalkin s algorithm to count curves via lattice paths ( see @xcite ) in the case of rational plane curves . </S>"
  ]
}