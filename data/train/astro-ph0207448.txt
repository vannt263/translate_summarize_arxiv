{
  "article_text": [
    "a detailed understanding of galaxy formation in cold dark matter universes remains a primary goal of modern astrophysics . whereas on large scales",
    "the clustering of matter is determined almost solely by gravitational forces , a large number of other physical processes contribute to the dynamics on the scales relevant to galaxy formation . in order to gain insight into this problem , it is important to develop numerical methods which can reliably represent these physical processes , many of which occur on scales too small to be resolved by the simulations .",
    "the aim of this work is to describe a set of numerical tools that can be used to simulate galaxy formation within popular cdm models",
    ".    smoothed particle hydrodynamics or sph ( gingold & moneghan 1977 ; lucy 1977 ) is a particle - based technique for solving gas - dynamics which is often applied to astrophysical problems .",
    "this scheme is fundamentally lagrangian , it can be easily combined with gravity solvers that use tree structures and it lends itself readily to the wide range of densities in galaxy formation problems .",
    "however , standard implementations of sph have limited ability to resolve steep density gradients , and a number of numerical problems occur when particles are close to a region of very different density . these arise because the usual formulation of sph assumes that the density gradient across the smoothing kernel of each particle is small .",
    "this is not true in many situations in which sph is commonly used . as a result ,",
    "low mass clumps of dense gas artificially `` evaporate '' , hot diffuse gas is prevented from coexisting with dense `` clouds '' and radiative cooling is artificially enhanced in the diffuse gas which lies near such clouds . in most current implementations of sph",
    "the nett result of these effects is excessive accretion onto the cold phase ( pearce 1999 ; ritchie & thomas 2000 ; springel & hernquist 2002a ) .    the method we propose to overcome these limitations is based on a new neighbour search that considers the thermodynamic properties of particles .",
    "our scheme evaluates the appropriate local density more correctly than previous schemes for particles near a phase boundary . at the same time",
    ", it performs well in situations where the phases are far from pressure equilibrium , for example in shocks .",
    "the method will be outlined in sec .",
    "2.1 . in sec 3.2",
    ", we compare its stability and convergence to those of the standard sph implementation using a set of idealised galaxy formation simulations of varying resolution .",
    "we will see that the new implementation retains a larger fraction of hot gas , avoiding the artificial overcooling often caused by inappropriate density estimates .",
    "the same test problem also demonstrates the numerical stability of the scheme in the presence of steep density ( and temperature ) gradients as well as in an accretion shock .",
    "as noted above , proper modelling of the formation and evolution of a galaxy requires many physical processes to be considered in addition to the already complex interaction of nonlinear gravitational evolution and dissipative gas dynamics .",
    "the interstellar medium ( ism ) where gas exists in a wide range of density and temperature states , may be considered as a multiphase system resulting from the interplay of processes such as gravity , hydrodynamics , star formation , stellar photo - heating , shocking by supernovae and stellar winds , cosmic ray and magnetic field dynamics , chemical enrichment and dust formation ( field 1965 , cox & smith 1974 , mckee & ostriker 1977 , ferrara 1995 , efstathiou 2000 ) .",
    "each process introduces its own length and time scales which often differ by orders of magnitude from those of the galaxy as a whole . as a result ,",
    "a realistic description of the galactic environment is a severe challenge both for theoretical modelling and for numerical simulation .",
    "simulations of the interstellar medium which attempt to follow all or many of these effects are only possible at the cost of studying a very small portion of a galaxy . the formation of the galaxy as a whole can not then be considered .",
    "a small simulated region makes it possible to resolve the few parsec length scale characteristic of the evolution of individual expanding supernova remnants ( see e.g. rosen & bregman 1995 , wada & norman 2001 , avillez 2000 ) . in order to achieve sufficient resolution ,",
    "a two dimensional geometry is often adopted and important ingredients , for example magnetic fields and cosmic rays , are often neglected .",
    "the results are thus still far from realistic .",
    "our aim is different . we seek to follow the overall evolution of a forming galaxy .",
    "we therefore include small - scale processes only insofar as they affect evolution on scales larger than a few hundred parsecs .",
    "such processes are included with an appropriate ( and heuristic ) `` sub - grid '' model .",
    "in particular , we focus our attention on star formation and on feedback from supernovae and stellar winds , adopting simple recipes similar to those commonly used in semi - analytic models for galaxy formation ( white & frenk 1991 , kauffmann , white & guiderdoni 1993 , cole 1994 , somerville & primack 1999 ) .    in recent years , a number of authors have worked along similar lines , coupling smoothed particle hydrodynamics codes with simple star formation and feedback prescriptions in order to study galaxy formation and evolution ( katz & gunn 1991 , katz 1992 , navarro & white 1993 , 1994 , steinmetz & mller 1994 ) .",
    "others have implemented similar recipes in grid - based hydrodynamics codes for the same purpose ( cen & ostriker 1992 , 1999 ) .",
    "this work has shown that , except at extremely low resolution , the implementation of feedback as a localised heat source is ineffective in regulating star formation ( katz 1992 ) .",
    "this is because most of the gas heated by supernovae is so dense that it radiates the injected energy immediately without significant effect on the dynamics . as a consequence",
    ", nothing prevents more distant and diffuse gas from cooling and adding itself to the rapidly star - forming , dense ism .",
    "such `` thermal feedback '' thus fails to produce the starburst - driven winds which can drive galactic fountains or blow gas out of weakly bound systems like dwarf galaxies .",
    "although such winds are observed and are thought to play an important role in galaxy formation , a robust numerical scheme which can generate them is still lacking .    _",
    "ad hoc _ solutions of varying complexity have been proposed to remedy this weakness of the standard method ( navarro & white 1993 , yepes 1997 , hultman & pharasyn 1999 , thacker & couchman 2000 , springel & hernquist 2002b ) .",
    "our own scheme is a further attempt in this direction , based on an explicit separation of the protogalactic gas into diffuse and dense ( star - forming ) components .",
    "feedback energy is used to heat the two components separately and to convert gas from the dense to the diffuse component . as a result , it becomes possible to cycle material between the two phases and to heat the diffuse phase directly .",
    "our scheme is thus able to regulate star formation and to drive galactic fountains or winds . in our view",
    ", it contains fewer arbitrary elements and is more robust than earlier suggestions , and , in addition , it is closely related to the modification of sph which we propose in order to avoid unphysical effects near phase boundaries .    our methods for simulating stellar feedback are described in  2.3 . their ability to suppress star formation , to reheat cold gas and to drive outflows from the galactic disk is demonstrated in  3.3 , where we also show how feedback has a relatively larger impact in small mass galaxies .",
    "finally , in  3.4 we use our methods for a preliminary study of the formation of galaxies in a @xmath0cdm universe . despite their relatively low numerical resolution ,",
    "these simulations test our schemes in the more realistic context of hierarchical aggregation in an expanding universe . in this situation",
    "also we find that feedback suppresses star formation much more effectively than would be inferred from simulations employing more standard sph methods .",
    "studies of galaxy formation and evolution require appropriate numerical techniques .",
    "these must follow not only the gravitational evolution of the system , but also both the dissipative hydrodynamics of systems with a very wide range of physical conditions , and the `` subgrid '' physics of star formation and feedback .",
    "our work is based on modifications of a software package named gadget .",
    "this is a tree - based n - body / sph code written in c and presented in springel 2001 ( hereafter syw ) .",
    "it is publicly available in both serial and parallel versions , and we refer the interested reader to syw for a general introduction . as we document in the following sections , we have at several points made choices different from those recommended as default by syw . in particular , we have fixed @xmath1 ( rather than the recommended @xmath2 ) in the general form of the sph momentum equation ( monaghan , 1992 ) : @xmath3 where @xmath4 is the number of neighbors , @xmath5 is the pressure , @xmath6 the density , @xmath7 the symmetric smoothing kernel and @xmath8 the artificial viscosity used to capture shocks ( we define @xmath9 in more detail below ) .",
    "we found by experiment that @xmath1 gives better behaviour in the multiphase sph scheme we present below .",
    "furthermore , we have changed the sph energy equation to the form ( for @xmath1 ) : @xmath10 where @xmath11 is the specific internal energy ( basically the temperature ) of particle @xmath12 , and @xmath13 is the relative velocity between particles @xmath12 and @xmath14 .",
    "we found equation ( [ sph_genegyeq ] ) to integrate the thermal energy evolution with much less noise than the manifestly symmetric form used in the public version of gadget .    in the following subsections",
    "we describe other additions to the public version that are necessary to study problems involving radiative cooling , star formation and energy feedback from stars .      as a first step towards a realistic simulation of galaxy formation",
    ", we introduce radiative cooling processes into the publicly available code . in our version of gadget",
    "we adopt an implicit solver for the cooling equation and we interpolate the cooling rates from tables published by sutherland and dopita ( 1993 ) for a variety of gas metallicities , from primordial ( @xmath15 only ) to supersolar ( @xmath16=+0.5 $ ] ) .",
    "we assume the gas is always optically thin to its own cooling radiation .",
    "when cooling is included , it represents an effective sink for the internal energy and pressure support of the gas . as a consequence ,",
    "steep density gradients develop , with the densest gas locked at the cutoff temperature for atomic cooling processes , i.e. at about @xmath17 k. gas that remains at low density may be heated to high temperature by accretion shocks , or may remain at the low temperatures typical of unvirialised `` quasilinear '' , gas .",
    "clearly , additional cooling and heating processes such as @xmath18 cooling ( abel 1997 ) , ionization by high energy cosmic backgrounds ( theuns 1998 ) or stellar photo - heating ( wolfire 1995 ) could lead to an even more complex , multiphase structure with several characteristic density and temperature scales .    when such multiphase structure is present , standard implementations of sph overestimate the density for particles that fall near the boundary of a higher density phase ( pearce 1999 ) .",
    "the usual assumption of small density gradients across the smoothing kernel breaks down in this regime , and nearby clusters of high density particles cause an upward bias in the standard sph estimate : @xmath19 here @xmath4 is the number of neighbours @xmath14 of particle @xmath12 and @xmath7 is a symmetric smoothing kernel . in order to avoid this bias , which leads to artificially high cooling rates and to spatial exclusion effects ,",
    "we modify the neighbor search and the density evaluation of equation ( [ std_dens_eq ] ) in a way which leaves the numerical scheme as simple as possible .",
    "our scheme is quite similar to that of ritchie & thomas ( 2000 , hereafter rt ) as far as the neighbour search is concerned , but is very different for all other aspects of the hydrodynamics .",
    "it is important to recognize that the local density is the gas property responsible for phase segregation ( since it determines the local cooling rate ) .",
    "an appropriate density estimator for a particle of any given phase should use only local material which is also part of that same phase .",
    "theoretical studies show that the coldest and densest gas in a multiphase medium can contain a large fraction of the mass , but has a very small filling factor ( mckee & ostriker , 1977 ) .",
    "thus when evaluating sph quantities for diffuse gas , it is important to exclude dense phase particles which happen to lie within the smoothing kernel .",
    "( the problem is less severe in the opposite direction since few neighbours of a `` dense '' particle are typically part of the diffuse phase . )",
    "thus gas at low densities should give dense neighbours a low `` importance '' ( or weight in the terminology of rt ) to prevent them from monopolizing the sum in equation ( [ std_dens_eq ] ) .    in order to maintain the number of neighbours within a small @xmath20 around @xmath4",
    ", we assume that two particles @xmath12 and @xmath14 do not consider each other as neigbours if their densities are very different ( see condition ( [ msph1_eq ] ) below ) .",
    "this would be equivalent to rt s neighbour search method if the number of neighbours were kept exactly constant . allowing it to fluctuate within a small interval , as happens in gadget , makes essentially no difference .",
    "notice that unlike rt we do not make any assumption about pressure balance .",
    "indeed , our density estimate depends only on the positions and previous density estimates of the particles .",
    "it is independent of their temperatures and velocities .",
    "the importance of pressure gradients is evaluated on a particle by particle basis , as we will explain below .    in detail , our new implementation of sph multiphase gas works as follows .",
    "the sph particle @xmath14 is not considered as a neighbour of @xmath12 , even if their separation is small , when all the following conditions are fulfilled ,    @xmath21    and in this case @xmath12 is also deleted from consideration as a possible neighbour for @xmath14 . here",
    "@xmath22 and @xmath23 are large numbers ( we assume in this work @xmath24 ) , @xmath25 is the specific energy and other symbols are explained below .",
    "condition ( [ msph1_eq ] ) is our proposed solution to the density estimation problems outlined above ; the additional conditions are required to avoid occasional pathological behaviour .",
    "in particular , a complication arises when two different phases , typically a cold , compact clump embedded in more diffuse gas , are not only in contact but are also shocking together . in such situations",
    "a simple prescription based on a density criterion alone ( or similar ones based on temperature ) can produce severe integration instabilities as the resolution is increased .",
    "in sph the conservation of energy and momentum requires symmetric pressure and artificial shock forces to ensure that newton s third law is satisfied .",
    "if particle @xmath14 can see @xmath12 , but particle @xmath12 can not see @xmath14 , then we need to make sure that the reaction of @xmath12 s force on @xmath14 is indeed small compared to the total force on @xmath12 .",
    "this is generally the case near phase boundaries ( where this asymmetry can often occur ) except in shock regions where pressure gradients are very large or the velocity field has a large divergence .",
    "hydro forces in sph are evaluated using local estimates of @xmath26 and of the artificial viscosity pressure term that usually dominates the hydro force in shocks . in order to understand whether particle @xmath12 can really ignore the presence of @xmath14 we need to study in more detail the sph force term .",
    "the reduced pressure force , i.e. the reduced pressure gradient on @xmath12 due to @xmath14 , can be written in general sph form as a function of the free power index @xmath27 in the following way ( see equation [ sph_genmomeq ] ) : @xmath28 where @xmath29 is the pressure of a perfect gas and @xmath30 is the adiabatic index . the relative error in the hydro force on particle @xmath12 arising from the neglect of the contribution from @xmath14",
    "can be estimated as : @xmath31 this quantity can be minimized with respect to @xmath27 and @xmath32 , using the condition given in equation ( [ msph1_eq ] ) .",
    "one then finds that , in order to keep very small @xmath33 , the best value for @xmath27 is @xmath34 .",
    "we also require that the internal energy of @xmath14 should be small compared to that of @xmath12 : @xmath35 this leads to condition ( [ msph4_eq ] ) , which plays an important role in collapse problems where the gas shocked via accretion is more dense than the gas still in the infall phase .",
    "finally , we also need to consider the artificial viscosity term , @xmath9 .",
    "this dominates in shock regions and is defined as @xmath36 where @xmath37 , @xmath38 is the average sound speed and @xmath39 . \\label{visc2}\\ ] ] note that @xmath40 and thus @xmath41 are always negative in shocks .",
    "( see syw for more details on the implementation of artificial viscosity in gadget . ) to avoid non - physical behaviour in shocks we thus impose a `` non - shock '' condition , i.e. we require that the particles pairs to be decoupled should not to be part of a shock front : @xmath42 this translates into condition ( [ msph5_eq ] ) .",
    "when the conditions ( [ msph1_eq ] ) , ( [ msph4_eq ] ) and ( [ msph5_eq ] ) are all satisfied , particle @xmath12 can safely ignore the much denser particle @xmath14 ( and in order to obtain a more symmetric formalism , we also ensure that @xmath14 ignores @xmath12 during its own neighbour search ) .",
    "the scheme described in this section produces appropriate density estimates for particles in each phase of a multiphase system , and it conserves energy and momentum just as well as standard sph , even in extreme dynamical situations note that the density jump across a nonradiative shock can be at most @xmath43 for @xmath44 ( here @xmath30 is the adiabatic index ) . for such shocks our scheme should produce exactly the same results as standard sph since condition ( [ msph1_eq ] ) is never fulfilled .",
    "we have checked that this is indeed the case ( even at low resolution ) in simulations of the self - similar cosmological infall model of bertshinger ( 1985 ) as well as in several other nonradiative problems studied during the development of the numerical scheme .",
    "when gas reaches high density in galaxy formation simulations , it is generally assumed that it will begin to fragment and turn into stars .",
    "however , current computational capabilities do not allow direct simulation of this process within a forming galaxy .",
    "thus , one is forced to adopt heuristic laws to describe star formation in the same way as in semi - analytic models of galaxy formation ( kauffmann , white & guiderdoni 1993 , cole 1994 , somerville & primack 1999 ) .",
    "one must first define the conditions under which a gas particle is eligible for star formation , then calculate the rate at which its gas is converted into stars ( the star formation rate , hereafter sfr ) . since our recipes are  standard \" , we just list them below , and refer the reader to navarro & white ( 1993 , hereafter nw ) and thacker and couchman ( 2000 ) for a more detailed discussion .    the conversion of gas mass into stellar mass is possible if and only if all of the following conditions are satisfied : @xmath45 where @xmath46 is the divergence of the local velocity field , @xmath47 is the sound crossing time , @xmath48 the free fall time , @xmath6 indicates density and @xmath49 temperature . when all conditions listed above are fulfilled by a generic sph particle , the star formation rate is calculated from the following equation : @xmath50 we have found that conditions ( [ sfr_cond ] ) and equation ( [ sfr_eq ] ) with @xmath51 reproduce fairly well the `` laws '' which appear to regulate the observed star formation properties of galaxies ( kennicutt 1998 ) : @xmath52 stars are represented numerically by reducing the mass of the star- forming sph particle and creating a new collisionless `` star '' particle .",
    "it is not feasible , however , to spawn an independent star particle for every minor star formation event .",
    "the number of star particles would then grow prohibitively , and the mass of each would be too low compared to the initial resolution , leading to numerical problems such as two - body heating in encounters with dark matter particles . to avoid this , we treat the gas particles as hybrid gas / star particles in the way suggested by mihos & hernquist ( 1994 ) , where a gas particle can have a `` hidden '' stellar mass that contributes to its inertia but does not play a role in the hydro equations .",
    "once this `` hidden '' stellar mass grows to some fixed fraction ( here assumed @xmath53 ) of the initial particle mass , a new stellar particle is created and the mass of the original particle is reduced . furthermore ,",
    "when the mass of the sph particle falls to @xmath54 of its initial value , the leftover gas is shared among gas neighbours .",
    "if a particle is not itself receiving material from a dissolving neighbours , it will form three stellar particles and then dissolve . in practice ,",
    "since star - forming gas particles are normally highly concentrated in small subvolumes of the simulation , this is true for most of them .",
    "note that creating a stellar particle and dissolving a gas particle requires care in order to conserve mass , momentum and energy , as well as other gas / star properties such as metallicity and stellar age , if these are being followed .",
    "in this section we will explain our numerical scheme to distribute the energy produced by star formation activity , the feedback . in principle , along with feedback one could also study the production and ejection of heavy elements .",
    "this would require the specification of stellar yields , along with an initial mass function , in order to determine the appropriate source terms from our dynamically determined star formation rates . in the present study we will not , however , model the metal enrichment of the gas , but rather focus our attention on the energetics of feedback .",
    "the amount of energy injected by each newly formed solar mass of stars is then the only quantity we need .",
    "we assume the same value as nw :  @xmath55 .",
    "in addition , we neglect the delay of a few tens of millions of years between the formation of a stellar population and the injection of the bulk of its feedback energy .",
    "feedback comes primarily from massive stars ( @xmath56 ) that explode as supernovae and energise interstellar gas .",
    "again , resolution constraints do not allow this process to be studied in detail so it must be modeled using simplified rules .",
    "the most straightforward way to introduce supernova feedback is through injection of thermal energy into neighboring gas particles in proportion to the sfr .",
    "this proves ineffective , however , since cooling rates are extremely high in the vicinity of all eligible sites for star formation ; sph gas particles in these regions have , by definition , very high density ( katz 1992 ) . in reality",
    "the ism structure in star - forming regions is more complex , with gas at a wide range of densities and temperatures .",
    "this well known `` multiphase structure '' is a consequence of a wide variety of interacting physical effects , many of which are not represented in our model .",
    "our simulations do produce coexisting `` cold dense '' and `` hot sparse '' phases , but these are a very crude representation of the true ism structure .",
    "thus , we need a method to include the energy input in our simulations which accounts approximately for all the unresolved physics that we can not study directly ( see yepes 1997 , hultman & pharasyn 1999 , thacker & couchman 2000 , springel & hernquist 2002b for erlier approaches to implementing feedback to a multiphase gas ) .    here",
    "we propose a new method for funneling feedback energy into the ism which takes explicit account of the two phase structure which arises naturally in sph simulations with cooling .",
    "we will loosely refer to the two phases as `` cold '' and `` hot '' .",
    "we define them as follows : the cold gas has @xmath57 and @xmath58 , while the rest of the gas will be considered `` hot '' , even though in cosmological simulations much of it will be cold , unshocked material which has yet to fall into a dense system . when new stars are formed , we distribute the stellar feedback energy to neighboring gas particles with a fraction @xmath59 going to cold gas and a fraction @xmath60 to hot gas .",
    "our fundamental hypothesis is that at large scales ( of @xmath61 order , say ) the nett effect of all the complex _  microscopic \" _ processes is well described by an energy input shared by the _  macroscopic \" _ phases in given proportions .",
    "values for @xmath59 and @xmath60 could be fixed from a complete theory of the ism , describing all the relevant processes , or through direct numerical simulations covering the wide range of scales and physical conditions appropriate for star formation within galaxies .",
    "such numerical studies are not currently available and there is no consensus on a specific analytic model .",
    "we therefore prefer to leave our feedback parameters as freely adjustable and to try to understand how their values impact the problem we are interested in here , namely the large - scale structure of forming galaxies .    from the numerical point of view , implementing our procedure requires an additional neighbour search for each star - forming particle to identify separately its cold and hot neighbours . in gadget , this is easily accomplished through a modification of the neighbour search routines ( see syw for details ) .",
    "feedback to the hot phase is implemented by adding thermal energy to the ten nearest hot neighbours .",
    "feedback to the cold phase is instead accumulated in a reservoir within the star - forming particle itself , which is always a cold particle according to our definition and to the star - formation conditions given in equation ( [ sfr_cond ] ) .",
    "this continues until the accumulated energy is sufficient to heat the gas component of the particle above a certain threshold that we take as @xmath62 kelvin .",
    "this is far enough above @xmath63 for the promoted particle to be considered `` hot '' in its subsequent evolution , and , more physically , is similar to the temperature of the hot phase in the mckee & ostriker ( 1977 ) three - phase model of the ism .",
    "if the mean temperature of the ten nearest hot neighbors is higher than this value , we instead take twice their mean temperature as the threshold for promotion . again",
    ", this is designed to ensure that a promoted particle stays `` hot '' for at least as long as other nearby hot particles .",
    "when this temperature threshold is reached , the energy from the particle reservoir is dumped in its internal energy and the particle is `` promoted '' to be a hot particle .",
    "a new sph density is then calculated excluding all its cold neighbours . at the same time",
    "any `` hidden '' stellar content is dumped to these cold neighbours . in this way",
    ", the density and the cooling rate are strongly reduced for the promoted particle , its entropy is raised above that of the surrounding hot gas , and its phase is changed completely .",
    "in this section we carry out a number of tests in order to check the stability and efficiency of our new schemes for multiphase gas ( hereafter msph ) and for feedback ( hereafter mfb ) . in most cases ,",
    "the initial conditions for these tests are the rotating , centrally concentrated sphere described in nw which consists predominantly of dark matter ( @xmath64 by mass ) .",
    "superposed sph and dark matter particles are placed on a grid and then perturbed radially to give a density profile of the form @xmath65 .",
    "velocities are chosen so that the sphere is initially in solid - body rotation with spin parameter @xmath66 .",
    "the initial thermal energy of the system is always a negligible fraction ( @xmath67 ) of the gravitational energy .",
    "this system collapses from the inside out to form a disk galaxy as the simulation proceeds . as an additional test in a more realistic situation",
    ", we also carry out a low resolution study of the formation and evolution of a galaxy within in a @xmath0cdm cosmology .",
    "as we stated above , we do not expect our msph scheme to give different results from standard sph for non - radiative problems .",
    "we have checked that this is indeed the case for these two kinds of initial conditions .",
    "thus , in the following we will only show tests in which gas is allowed to cool radiatively in order to study how msph and mfb compare with standard sph implementations in the presence of multiphase structures .",
    "the code gadget requires a number of numerical parameters to be specified before a run can be executed .",
    "particularly relevant here are parameters related to timestep and gravitational force accuracy . softening lengths",
    "are quoted explicitly in the following subsections ; in general , we choose the softening length for the gas to be always half that for the dark matter , while the softening for the stars is the mean of the two .",
    "the timestep criterion we use is derived from the softening length as follows : @xmath68 where @xmath69 is the acceleration and @xmath70 a constant that we fix to @xmath71 . for gas particles we also limit the timestep by a courant criterion .",
    "our numerical implementation of the courant condition is that reported in syw , where we fix the courant accuracy parameter to be @xmath72 .",
    "finally we require timesteps to stay between @xmath73 and @xmath74 internal time units ( our length , mass and velocity units are : mpc / h , @xmath75 and km / sec ) .",
    "the lower bound is never reached in any of the simulations shown here and the typical timestep is a few @xmath76 myr .    in gadget , gravitational forces are calculated by means of a tree algorithm .",
    "we adopt the new opening criterion suggested in syw , and we set the dimensionless force accuracy parameter to @xmath77 ( see syw for a full detailed description both of the criterion and of the parameter ) .    finally , the artificial viscosity parameter that we will use is equal to @xmath78 , larger than the value commonly adopted in other studies .",
    "we found this higher value to be necessary to prevent interpenetration of particles both in sph and in msph , when using the shear - corrected version of the artificial viscosity force ( balsara 1995 , navarro & steinmetz 1997 ) .      in our first set of numerical simulations we fix the physical properties of the system and vary the resolution ( i.e. the number of particles ) in order to study the stability and convergence of our msph scheme .",
    "we allow the gas to cool radiatively because we are particularly interested in the dynamics of multiphase gas . in order to isolate such effects",
    ", we do not allow the gas to be converted into stars .",
    "( this allows the gas density to reach very large values , producing an extreme density range . )",
    "we present results for six different simulations of the rotating , collapsing sphere , three for sph and three for msph . along",
    "each set the resolution increases with @xmath79 and @xmath80 particles of each type and the dark matter softening set to @xmath81 , respectively . in all cases the total mass of the system was @xmath82 and its initial radius was @xmath83 .",
    "in all these simulations an initial central collapse generates an accretion shock which moves out through the infalling envelope , while a fraction of the inner gas cools onto a dense and cold central core . at later times ( after about @xmath84 ) this core becomes the centre of a disk of cold , dense gas whose self - gravity is balanced by rotation .",
    "the dark matter particles virialize violently under the effect of their self - gravity and finally assume a centrally concentrated , spheroidal , quasi - equilibrium distribution . in fig .",
    "( [ msph_ncnv_panel ] ) we show the time evolution of the gas fraction in each of three different phases , as well as the evolution of the total internal energy .",
    "our definition of gas phases here differs from that in sec .",
    "2.3 and is as follows :    * _ hot _ when @xmath85 , * _ cold _ when @xmath86 and @xmath87 , * _ warm _ when @xmath86 and @xmath88 .    please notice that these definitions are unrelated to those of the similarly named phases identified in thermal instability studies of the galactic ism .",
    "in particular , our warm phase includes both unshocked infalling gas and gas which has either shocked at low density or has expanded adiabatically to low temperature after shocking .    as we can see in fig .",
    "( [ msph_ncnv_panel ] ) , cooling is less efficient in the msph scheme than in standard sph , since there is a clear increase of hot gas in msph runs and a decrease of the cold phase .",
    "these differences are a result of excessive cooling in sph at the interface between the central cold disk and the surrounding hot atmosphere .",
    "this artifact is caused by incorrect sph density estimates for hot particles near the disk and was first pointed out by pearce ( 1999 ) .",
    "note that it is independent of the problem highlighted by springel & hernquist ( 2002a ) which arises from non - conservation of entropy in convergent flows for many sph implementations .",
    "this latter problem is present to an equal extent in our sph and msph models , and is less severe than in the worst cases studied by springel & hernquist ( 2002a ) because of our chosen representation for the sph energy equation .",
    "notice also that both schemes are quite stable in the regime investigated .    a visual inspection of the particle distributions in fig .",
    "( [ msph_ncnv_positions ] ) shows that hot particles do survive near the central disk in the msph case .",
    "they have an almost spherically symmetric distribution with density peaked at the centre .",
    "the cold disk rotates within this ambient hot medium .",
    "in contrast , in the sph model hot particles are excluded from the vicinity of the disk so that the hot phase actually has a density minimum at the centre of the galaxy .",
    "this is seen most clearly in the gas density profiles of fig .",
    "( [ msph_ncnv_dprof ] ) .",
    "such behaviour is clearly unphysical .",
    "we now study the effects of our multiphase feedback ( mfb ) scheme , again in the simple case of a rotating spherical collapse .    in the first set of simulations ,",
    "we investigate how our scheme affects the evolution of total cold gas mass , total stellar mass and total star formation rate in an object with @xmath89 particles of each type , a dark matter softening length of @xmath90 and a total mass of @xmath82 .",
    "we present results for five simulations .",
    "four use msph with different values for the adjustable feedback efficiency parameters @xmath59 and @xmath60 , while the fifth is a control simulation using sph and no feedback :    [ cols=\"^,^,^,^ \" , ]     the remaining fraction ( @xmath91 ) of feedback energy is understood to be dumped in the classical way as heat input to the cold gas .",
    "this energy is lost by cooling and has no effect on the dynamics .    in a second set of simulations ,",
    "we fix @xmath92 and study the effects of our mfb scheme on objects of different mass .",
    "we compare four runs with @xmath89 particles of each type and with total masses @xmath93 and @xmath82 .",
    "we call these g09 , g10 , g11 and g12 . note that g12 is identical to r04 .",
    "the dark matter softening is @xmath94 for the @xmath82 object and is scaled down in proportion to @xmath95 for the others ( as is the initial radius of the object , and so also its characteristic velocity in virial equilibrium ) .    in fig .",
    "( [ mfb_prfb_panel ] ) and ( [ mfb_mass_panel ] ) we show the gas mass in various phases ( definitions as before ) in units of the total baryonic mass .",
    "the unbound fraction is defined as the fraction of gas particles with positive kinetic plus gravitational potential energy .",
    "also shown is the evolution of the star formation rate and of the total stellar mass",
    ".    runs r01 to r05 are shown in fig .",
    "( [ mfb_prfb_panel ] ) .",
    "the effect of varying the mfb parameters is most clearly seen in the evolution of the hot , cold and unbound fractions and in the total stellar mass .",
    "a comparison of r01 and r02 shows how the better treatment of cooling in msph already results in less star formation and a larger fraction of hot gas .",
    "r03 , r04 and r05 are all quite similar . star formation is reduced by about 20% from that in r02 in all three cases . when @xmath60 is high it has the effect of driving more gas out of the potential well , producing higher hot gas and unbound gas fractions .    in fig .",
    "( [ mfb_mass_panel ] ) we show results from models g09 to g12 .",
    "note that since the characteristic virial temperature varies by a factor of about 4 between neighboring models along this sequence , the relative amounts of warm and hot gas by our previous definition are not meaningful .",
    "for this figure we therefore plot the sum of the hot and warm fractions instead of the warm fraction alone .",
    "the hot gas fraction evolves due to the initial accretion shock and the feedback energy input .",
    "both cooling and feedback are relatively more important in the low mass systems .",
    "the unbound gas mass is a good indicator of feedback effects .",
    "we see that less massive objects allow a larger fraction of gas to be expelled from their potential wells .",
    "this gas expands adiabatically and can cool to the point where it is considered `` warm '' .",
    "the specific star formation rate and the star mass fractions are also substantially reduced in the low mass objects as a result of feedback .",
    "thus conversion of baryons to stars is about nine times less efficient overall in g09 than in g12 .",
    "some care is needed when interpreting the evolution of @xmath96 , since the amount of cold gas evolves not only through cooling of the hot phase , but also through heating by feedback and by conversion into stars .",
    "the last aspect is generally dominant .",
    "the main limitation of these tests is the absence of substructure or of ongoing infall onto the central galaxy .",
    "these simple initial conditions do not allow a proper description of outflows since the expelled gas expands freely ( and unrealistically ) into the vacuum which surrounds the protogalaxy .",
    "in the next section we will study the more realistic case of a galaxy forming in a cold dark matter universe .",
    "infall of clumpy material is then present at all times .      as a final test we study the case of a milky way like galaxy forming in a flat @xmath0cdm universe with @xmath97 , @xmath98 and @xmath99 .",
    "the initial conditions , kindly provided by j. navarro , consist of a high resolution region that contains the particles of the forming galaxy and its immediate environment .",
    "this central region was excised from a large - scale simulation of a cosmologically representative volume , the rest of which is represented only through a distribution of relatively high mass dark matter particles .",
    "these provide an appropriate tidal field on the high resolution region ( see navarro & steinmetz ( 2000 ) for further details ) . in the simulations we present here",
    "there are initially only 7440 particles of each species in the high resolution region , about 15% of which typically end up in the dominant galactic halo .",
    "our adopted softening is @xmath100 , and the initial mass of a gas particle is @xmath101 .",
    "we use exactly the same initial condition for three different simulations in which the sph scheme , star formation and feedback parameters are fixed as in the r01 , r02 and r04 simulations described in sec .",
    "3.3 ; we will refer to these three simulations as sph , msph and msph+mfb , respectively . as a final experiment we repeat the msph+mfb simulation reducing the mass of the system by a factor of 100 and rescaling positions and velocities by a factor of @xmath102 so that all densities and freefall times are unchanged .",
    "the characteristic temperatures of objects then decrease by a factor of @xmath103 so that cooling times are substantially shortened and feedback effects are much more pronounced .",
    "we refer to this model as mfb/100 .",
    "if msph+mfb corresponds to the formation of a galaxy of milky way scale , then mfb/100 corresponds to the formation of a dwarf with a characteristic rotation velocity of about 40 km / s .",
    "although the resolution of these simulations is quite poor , they allow us to test our schemes in the presence of the expansion of the universe and within the hierarchical evolution characteristic of cold dark matter models .",
    "clearly , we can not address in detail the structural properties of our `` galaxies '' , but we are principally interested here in their global evolution , in particular , in their star formation history and in the distribution of baryons over the various phases .",
    "we note that although our principal galaxy is made from only @xmath104 gas particles , this is still quite a large number in comparison with the number of gas elements which form into a typical `` galaxy '' in most simulations of galaxy formation within a `` cosmologically representative '' volume .    in fig .",
    "( [ mfb_lcdm_panel ] ) we display the evolution of various components of the most massive galaxy in each of our three simulations .",
    "we identify galaxies by applying a group finding algorithm named hop ( eisenstein and hut , 1998 ) ti the baryonic components of the simulation .",
    "we adopt the numerical parameters suggested by its authors .",
    "hop groups are characterized by boundaries that exceed a given overdensity threshold ( we use @xmath105 times the mean cosmic baryonic density ) .",
    "however , the internal structure is also taken into account and local maxima ( defined by a density peak threshold ) which are connected by thin bridges are split , according to the topology of a higher density contour .",
    "eisenstein and hut ( 1998 ) demonstrate that the hop algorithm is sensitive only to the density contrast on the boundary contour .",
    "we refer to their work for a complete discussion of the methods and a comparison with other popular group finding algorithms .",
    "the plots show the evolution of the total baryonic mass , the stellar mass , the cold ( dense ) gas , the diffuse ( warm plus hot ) gas , and the successfully promoted mass ( the diffuse mass at each time that was promoted from cold to hot at higher redshift and is still in the diffuse phase ) .",
    "also shown is the star formation history of the most massive galaxy in each of the three simulations .",
    "note that because of hop s overdensity criterion only hot gas relatively close to the main galaxy is included in these plot .",
    "a comparison of the sph and msph models shows relatively modest differences . as in the simplified models r01 and r02 of  3.2 , this is a consequence of the high efficiency of cooling and star formation in the two schemes ; more than 95% of the baryons within the main halo are converted into stars in both cases .",
    "the overcooling problem with standard sph is evident only at late times ( @xmath106 ) when it results in a collapse of the hot atmosphere surrounding the central galaxy and the accretion of about 10% additional gas onto the halo which rapidly cools and turns into stars .",
    "the inclusion of feedback causes much larger effects . until @xmath107",
    "the total baryon content and the cold gas content of the msph and msph+mfb halos are almost identical , while star formation is slightly reduced in msph+mfb . after this time",
    ", however , feedback has a substantial effect on the total baryon content which remains approximately constant in msph+mfb over a period when it doubles in msph .",
    "clearly the addition of baryons through accretion at @xmath108 is almost exactly balanced by outflow in a feedback - driven wind .",
    "thus by @xmath109 the stellar mass of the msph+mfb galaxy is a factor of two smaller than that of the msph galaxy , and an equal mass of baryons has either been driven out of the halo or prevented from accreting in the first place .",
    "the star formation rate plot shows clearly that the major effect of the feedback is to reduce star formation at late times , not at the redshifts where the sfr is highest .",
    "this late time star formation nevertheless accounts for most of the stars in both models .",
    "further points to note from fig .",
    "( [ mfb_lcdm_panel ] ) are that the galaxies in all models are cold gas dominated at redshifts above about 4 and are star - dominated at lower redshifts . in addition , in the model with feedback only a small fraction of the hot gas in the halo at any given time is made up of material that has been reheated and evaporated from the disk by feedback .",
    "most of the hot gas has yet to cool onto the disk for the first time .",
    "it is interesting to look for the missing baryons in the msph+mfb simulated galaxy and to see where they end up . in fig .",
    "( [ mfb_lcdm_fracs ] ) we show the evolution of the baryonic mass fraction in various temperature and density ranges , averaged over the full high resolution region of our simulations .",
    "the left panels in this figure compare results for sph and msph , the two models without feedback .",
    "the evolution of the cold gas fraction ( @xmath110 ) is nearly identical in the two cases because this is almost all gas which has yet to fall into any halo .",
    "the msph model has more warm and hot gas and fewer stars at all redshifts ( but most noticeably at low redshift ) again reflecting overcooling near phase boundaries in the standard algorithm .",
    "the amounts of hot gas differ by more than a factor of two at @xmath109 .",
    "the right panels of fig .",
    "( [ mfb_lcdm_fracs ] ) make a similar comparison between the msph and msph+mfb models .",
    "here the differences are very large .",
    "feedback reduces the overall amount of star formation by about a factor of two .",
    "this reduction is compensated by a large increase in the amount of gas at low density ; the amount of gas at densities greater than 10 times the mean is almost the same in the two models . at redshifts above 3",
    "most of the excess diffuse gas in the msph+mfb model is at temperatures above @xmath111 , at @xmath112 the bulk is at temperatures between @xmath113 and @xmath111 , while at @xmath109 most of the excess is at temperatures below @xmath113 .",
    "clearly , feedback driven winds are driving gas into low density regions where it cools adiabatically as the universe expands    in fig .",
    "( [ mfb_lcdm_resca ] ) we show plots similar to the right - hand panels of fig .",
    "( 6 ) but for the mfb/100 simulation . in the absence of feedback",
    "this model would behave almost identically to msph , since cooling is efficient in most collapsed objects for both scalings of the initial conditions .",
    "when feedback is included , its effects are much more dramatic in mfb/100 than in msph+mfb because specific binding energies are reduced by a factor of more than 20 while the feedback energy injected per unit mass of new stars is unchanged . with these parameters",
    "star formation is much less efficient in the dwarf than in the big galaxy .",
    "the dwarf is dominated by cold gas until redshifts well below unity and it still contains more than 15% cold gas at @xmath109 . for comparison the giant contains less than 2% cold gas at this time and is star - dominated for all @xmath114 .",
    "the overall fraction of baryons converted to stars is also greatly reduced in mfb/100 .",
    "while about 50% of the total available baryons get turned into stars in the giant , this is reduced to about 7.5% in the dwarf .",
    "all these trends agree qualitatively with observation , in that the gas fractions of observed dwarfs are indeed substantially higher than those of giants , and their much lower metallicities argue for a lower overall efficiency of star formation and for ejection of large amounts of gas by winds ( e.g. larson 1974 ; dekel & silk 1986 ) .",
    "a further interesting and suggestive aspect of the mfb/100 simulation is the fact that its baryon mass oscillates and indeed decreases overall from redshift 6 until the present .",
    "this is a result of the interplay between accretion events , bursts of star formation , and the associated injections of feedback energy .",
    "small galaxies do indeed appear to have `` burstier '' star formation histories than giants ( e.g. kauffmann 2002 and references therein ) so this behaviour of the models may also be an echo of reality ( see also gnedin 1998 ) .    to conclude , our msph scheme successfully reduces overcooling in poorly resolved multiphase systems , and our mfb scheme allows feedback to be effective in driving winds and in reheating cold interstellar material , both processes which are observed to be important in starburst systems .",
    "in addition , our msph scheme , in contrast to traditional sph implementations , results in a physically plausible spatial distribution for hot diffuse gas in the vicinity of a cold dense ism , while our feedback scheme , when applied to systems of widely varying mass , leads to star formation efficiencies which scale roughly as inferred from the observed metallicities and gas fractions of galaxies .",
    "in this paper we have proposed and tested two modifications of the standard algorithms used for sph simulations of the formation of galaxies .",
    "the first ( msph ) is designed to reduce artifacts which occur in the common ( and often poorly resolved ) configuration of cold , dense gas clouds embedded in a hot diffuse halo .",
    "the second ( mfb ) is a new implementation of feedback which allows supernova energy to be channeled effectively into the heating of diffuse gas and the evaporation of cold clouds .",
    "when strong density jumps are absent , for example in most non - radiative problems , our msph scheme reduces to a standard sph algorithm . in the presence of cooling a multiphase structure can arise , and our scheme then eliminates the artificial overcooling discussed by pearce ( 1999 ) ; particles in the hot phase which happen to lie near a clump of cold gas have their density , and thus their radiative cooling rate , substantially overestimated by the standard sph formula . in our scheme such cold ,",
    "dense neighbours are not considered when calculating densities for particles in the diffuse phase .",
    "this modification also allows diffuse gas to take up a realistic spatial structure in the presence of an embedded cold component .",
    "this is not the case for standard algorithms ( see figs . ( 2 ) and ( 3 ) ) .",
    "finally in strongly dynamic situations our msph scheme conserves energy and momentum to the same accuracy and is just as stable as standard algorithms when similar timestep criteria are used .    since the work of katz ( 1992 ) it has been recognized that implementations of feedback which simply inject supernova energy into the thermal reservoir of neighboring gas particles have little effect on the dynamics of sph simulations ; most of the energy is radiated before it can accelerate the gas .",
    "many alternative schemes have been proposed ( e.g. navarro & white 1993 , yepes 1997 , hultman & pharasyn 1999 , thacker & couchman 2000 , springel 2000 , springel & hernquist 2002b ) but none is yet accepted as a proper representation of the unresolved `` microphysics '' . our mfb scheme is original in several respects and is designed to facilitate reproducing the observed properties of starbursts , while introducing as few _ ad hoc _ elements as possible .",
    "we use the supernova energy with predefined efficiencies to heat the hot diffuse phase and to evaporate gas from cold clouds into the diffuse phase . as",
    "our tests show , this not only allows feedback to regulate star formation , but also generates winds or galactic fountains without dialling in their characteristics `` by hand '' and permits such flows to entrain significant amounts of cold interstellar material .",
    "our tests have concentrated on the idealised rotating , collapsing sphere of navarro & white ( 1993 ) and on the formation of a single isolated galaxy and its environment in a @xmath0cdm universe .",
    "we have used relatively small numbers of particles in these experiments both to facilitate testing and because these kinds of algorithms are often used to study galaxy formation within cosmologically `` representative '' regions ( e.g. katz .",
    "weinberg & hernquist 1996 , pearce 1999 ; murali 2002 , springel & hernquist 2002a , b ) ; a large fraction of the `` galaxies '' then form from fewer than ( say ) 1000 gas particles .",
    "our tests show that our proposed algorithms are numerically stable , and that for plausible choices of the heating efficiencies they reproduce the main qualitative features of observed star - forming galaxies ; self - regulation of star - formation ; bursting behaviour in small systems ; the generation of fountains and winds with simultaneous inflow and outflow ; the entrainment of disk gas by winds .",
    "the obvious next steps are to carry out much larger simulations both of the formation of individual galaxies and of representative volumes .",
    "the first can study the origin of the spatial , kinematic and chemical structure of galaxies , checking whether more realistic feedback can indeed solve the disk angular momentum problem ( navarro & white 1994 , navarro & steinmetz 1997 , weil , eke & efstathiou 1998 ; thacker & couchman 2001 ) . the second can study how galactic winds enrich and structure the intergalactic medium .",
    "we are currently pursuing projects in both these directions .",
    "evolution of the total gas thermal energy and of the gas mass fractions in various phases for simulations of the collapse of a centrally concentrated , rotating sphere made of 90% dark matter and 10% gas . cooling is included in these simulations but not star formation .",
    "the gas phases are defined as follows : _ hot : _",
    "@xmath115 ; _ cold : _ @xmath116 and @xmath117 ; _ warm : _ otherwise .",
    "solid lines give results for standard sph , while dashed lines are for our new msph scheme .",
    "the thickness of the lines increase with the resolution of the simulation ( 2000 , 4000 , 8000 gas particles ) .",
    ", scaledwidth=110.0% ]     face - on projections at @xmath118 gyr of our 8000 gas particle , cooling only simulations of a collapsing , rotating sphere .",
    "the standard sph simulation is in the upper row with the msph simulation below it .",
    "the left - hand plots show `` hot '' particles ( @xmath119k ) while the right hand ones show `` cold '' particles ( @xmath120k and @xmath121 @xmath122 ) .",
    ", scaledwidth=110.0% ]     particle densities as a function of galactocentric distance after @xmath123 gyr of evolution in two 8000 gas particle , cooling only simulations of the collapse of a rotating sphere .",
    "the upper plot is for an sph model and the lower for an msph model .",
    "gas particles with @xmath124k are plotted with crosses .",
    ", scaledwidth=110.0% ]     the evolution of the star formation rate and of the masses of various components in simulations r01 ( dotted ) r02 ( solid ) r03 ( dashed ) r04 ( long - dashed ) and r05 ( dot - dashed ) .",
    "their parameters are described in the text .",
    "masses are given in units of @xmath125 , the total baryonic mass ( @xmath82 for all these simulations ) .",
    "hot , cold and warm phases are defined as in figure ( [ msph_ncnv_panel ] ) , while the _ unbound mass _ is defined as the gas mass with positive kinetic plus gravitational potential energy . the star formation rate , @xmath126 , is given in solar masses per year , and @xmath127 is the total mass in stars .",
    ", scaledwidth=110.0% ]     as fig .",
    "( [ mfb_prfb_panel ] ) but for simulations g09 ( solid ) , g10 ( dashed ) , g11 ( long dashed ) and g12 ( dotted - dashed ) .",
    "again their parameters are described in the text . for these simulations",
    "the total baryonic mass @xmath125 is @xmath128 for g09 , g10 , g11 and g12 , respectively . because of the varying virial temperature of these systems we plot results only for the combined warm+hot gas component . , scaledwidth=110.0% ]     evolution of the most massive galaxy in three of our @xmath0cdm runs .",
    "the sph model is at top left , msph at bottom left , and msph+mfb at top right . in these panels solid lines refer to total baryonic mass , dashed lines to stellar mass , dot - dashed lines to the mass in cold gas , and long - dashed lines to the hot+warm gas . for the msph+mfb run ,",
    "the dotted line shows the mass of currently diffuse gas which has been promoted from the cold phase by feedback .",
    "the bottom right panel compares the star formation histories of the three objects ( dotted , dashed and solid lines refer to sph , msph and msph+mfb , respectively ) .",
    ", scaledwidth=110.0% ]     evolution with redshift of the baryonic mass fraction in various components averaged over the full high resolution region of our @xmath0cdm simulations .",
    "the left hand panels compare msph ( thick lines ) with sph ( thin lines ) .",
    "the right hand panels compare msph+mfb ( thick lines ) with msph ( thin lines ) .",
    "the upper plots show the mass fractions with @xmath129k ( solid lines ) , with @xmath130k@xmath131k ( dotted lines ) and with @xmath132k ( dashed lines ) .",
    "the lower plots show the stellar mass fraction ( solid lines ) , the gas mass fraction at densities more than 10 times the cosmic mean ( dotted lines ) and the gas mass fraction at densities below this same threshhold ( dashed lines ) . ,",
    "scaledwidth=110.0% ]     evolution of the most massive galaxy in the mfb/100 run .",
    "the lines and plots correspond to those of fig .",
    "( [ mfb_lcdm_panel ] ) except that the mass unit is 100 times smaller to account for the rescaling of the simulation .",
    ", scaledwidth=110.0% ]"
  ],
  "abstract_text": [
    "<S> we investigate a new implementation of the smoothed particle hydrodynamics technique ( sph ) designed to improve the realism with which galaxy formation can be simulated . in situations where cooling leads to the coexistence of phases of very different density and temperature , our method substantially reduces artificial overcooling near phase boundaries , prevents the exclusion of hot gas from the vicinity of cold `` clouds '' , and allows relative motion of the two phases at each point . </S>",
    "<S> we demonstrate the numerical stability of our scheme in the presence of extremely steep density and temperature gradients , as well as in strong accretion shocks and cooling flows . </S>",
    "<S> in addition , we present new implementations of star formation and feedback which simulate the effect of energy injection into multiphase gas more successfully than previous schemes . </S>",
    "<S> our feedback recipes deposit thermal energy separately in cold dense gas and hot diffuse gas , and can explicitly reinject cold gas into the hot phase . </S>",
    "<S> they make it possible to damp star formation effectively , to reheat cold gas , and to drive outflows into the galaxy halo and beyond . </S>",
    "<S> we show feedback effects to be strongest in small mass objects where much of the gas can be expelled . </S>",
    "<S> after idealised tests , we carry out a first low resolution study of galaxy formation in a @xmath0cdm universe . </S>",
    "<S> feedback results in substantial and mass - dependent reductions in the total baryonic mass gathered onto the final object as well as in significant modulation of the star formation history . </S>"
  ]
}