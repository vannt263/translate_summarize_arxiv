{
  "article_text": [
    "a _ topological graph _",
    "@xmath0 is a drawing of a graph @xmath1 in the plane with the following properties .",
    "the vertices of @xmath1 are represented by a set @xmath13 of distinct points in the plane and the edges of @xmath1 are represented by a set @xmath14 of simple curves connecting the corresponding pairs of points .",
    "we call the elements of @xmath13 and @xmath14 the _ vertices _ and the _ edges _ of @xmath15",
    ". the drawing has to satisfy the following general position conditions : ( 1 ) the edges pass through no vertices except their endpoints , ( 2 ) every two edges have only a finite number of intersection points , ( 3 ) every intersection point of two edges is either a common endpoint or a proper crossing ( `` touching '' of the edges is not allowed ) , and ( 4 ) no three edges pass through the same crossing .",
    "a topological graph is _ simple _ if every two edges have at most one common point , which is either a common endpoint or a crossing .",
    "a topological graph is _ complete _ if it is a drawing of a complete graph .",
    "we use two different notions of isomorphism to enumerate topological graphs .",
    "topological graphs @xmath1 and @xmath2 are _ weakly isomorphic _ if there exists an incidence preserving one - to - one correspondence between @xmath16 and @xmath17 such that two edges of @xmath1 cross if and only if the corresponding two edges of @xmath2 do .",
    "note that every topological graph @xmath1 drawn in the plane induces a drawing @xmath18 on the sphere , which is obtained by a standard one - point compactification of the plane .",
    "topological graphs @xmath1 and @xmath2 are _ isomorphic _ if there exists a homeomorphism of the sphere which transforms @xmath18 into @xmath19 . in section  [ section_horni_strong ]",
    "we give an equivalent combinatorial definition .",
    "unlike isomorphism , weak isomorphism can change the faces of the topological graphs involved , the order of crossings along the edges and also the cyclic orders of edges around vertices .",
    "for counting ( weak ) isomorphism classes , we consider all graphs labeled .",
    "that is , each vertex is assigned a unique label from the set @xmath20 , and we require the ( weak ) isomorphism to preserve the labels . mostly it makes no significant difference in the results as we operate with quantities asymptotically larger than @xmath21 .    for a graph @xmath1 ,",
    "let @xmath22 be the number of weak isomorphism classes of simple topological graphs that realize @xmath1 .",
    "pach and tth  @xcite and the author  @xcite proved the following lower and upper bounds on @xmath23 .",
    "[ veta_uplne_historicka ] @xcite for the number of weak isomorphism classes of simple drawings of @xmath24 , we have @xmath25    we prove generalized upper and lower bounds on @xmath22 for all graphs @xmath1 .",
    "[ veta_hlavni ] let @xmath1 be a graph with @xmath3 vertices and @xmath4 edges .",
    "then @xmath26 if @xmath27 , then @xmath28 let @xmath29 .",
    "if @xmath1 is a graph with no isolated vertices and at least one of the conditions @xmath30 or @xmath31 is satisfied , then @xmath32    we also improve the upper bound from theorem  [ veta_uplne_historicka ] .",
    "[ veta_uplne ] we have @xmath33    here @xmath34 is the inverse of the ackermann function .",
    "it is an extremely slowly growing function , which can be defined in the following way  @xcite .",
    "@xmath35 where @xmath36 is the @xmath37th function in the _ inverse ackermann hierarchy_. that is , @xmath38 , @xmath39 for @xmath40 and @xmath41 for @xmath42 .",
    "the constant in the @xmath43 notation in the exponent is huge ( roughly @xmath44 ) , due to a ramsey - type argument used in the proof .",
    "theorem  [ veta_uplne ] is proved in section  [ section_uplne ] . in the proof of theorem  [ veta_uplne ]",
    "we use the fact that for simple complete topological graphs , the weak isomorphism class is determined by the rotation system  @xcite ( see proposition  [ tvrz_1graf-2rot ] ) .",
    "this is combined with a recent combinatorial result , an upper bound on the size of a set of permutations with bounded vc - dimension  @xcite ( theorem  [ veta_vcdimenze ] ) .",
    "the method in the proof of theorem  [ veta_hlavni ] is more topological , gives a slightly weaker upper bound , but can be generalized to all graphs .    in subsection  [ section_combinatorial ]",
    ", we generalize theorem  [ veta_uplne ] by removing almost all topological aspects of the proof .",
    "the resulting theorem  [ veta_kombinatoricka ] is a purely combinatorial statement .    in subsection  [ sub_max_crossings ]",
    ", we consider the class of simple complete topological graphs with maximum number of crossings and suggest an alternative method for obtaining an upper bound on the number of weak isomorphism classes of such graphs .",
    "an arrangement of _ pseudosegments _ ( or also _ @xmath45-strings",
    "_ ) is a set of simple curves in the plane such that any two of the curves cross at most once .",
    "an _ intersection graph of pseudosegments _ ( also called a _ string graph of rank @xmath45 _ ) is a graph @xmath1 such that there exists an arrangement of pseudosegments with one pseudosegment for each vertex of @xmath1 and a pair of pseudosegments crossing if and only if the corresponding pair of vertices forms an edge in @xmath1 . using tools from extremal graph theory , pach and tth",
    "@xcite proved that the number of intersection graphs of @xmath3 pseudosegments is @xmath46 .",
    "as a special case of theorem  [ veta_hlavni ] we obtain the following upper bound .",
    "[ veta_pseudosegmenty ] there are at most @xmath8 intersection graphs of @xmath3 pseudosegments .",
    "the best known lower bound for the number of ( unlabeled ) intersection graphs of @xmath3 pseudosegments is @xmath47 .",
    "this follows by a simple construction or from the the fact that there are @xmath48 nonisomorphic permutation graphs with @xmath3 vertices  @xcite .",
    "let @xmath49 be the number of isomorphism classes of simple topological graphs that realize @xmath1 .",
    "a sequence @xmath50 of graphs where @xmath51 has @xmath3 vertices and @xmath52 edges has _ superlinear _ number of edges if @xmath53 , that is , if for every constant @xmath54 , we have @xmath55 for sufficiently large @xmath3 .",
    "the following theorem generalizes the result @xmath56 from  @xcite .",
    "[ veta_neizo ] let @xmath1 be a graph with @xmath3 vertices , @xmath4 edges and no isolated vertices",
    ". then @xmath57 .",
    "more precisely , @xmath58 let @xmath29 .",
    "for graphs @xmath1 with @xmath12 we have @xmath59 for a sequence of graphs @xmath51 with superlinear number of edges we have @xmath60    the two upper bounds on @xmath49 come from two essentially different approaches .",
    "the first one gives better asymptotic results for dense graphs , whereas the second one is better for sparse graphs ( roughly , with at most @xmath61 edges ) .",
    "for such very sparse graphs ( for example , matchings ) , however , better upper bounds can be deduced more directly from other known results ; see the discussion in subsection  [ sub_very_sparse ] .",
    "the proof in  @xcite implies the upper bound @xmath62 , although it is not explicitly stated in the paper .",
    "however , the key proposition @xmath63 in  @xcite is incorrect .",
    "we prove a correct version in section  [ section_horni_strong ] .    in section  [ section_geometric ]",
    "we briefly discuss the special case of geometric graphs .",
    "all the logarithms used in this paper are binary , unless indicated otherwise .",
    "the weak isomorphism classes of topological graphs can be represented in a combinatorial way by abstract topological graphs .",
    "an _ abstract topological graph _ ( or briefly an _ at - graph _ ) is a pair @xmath64 where @xmath1 is a graph and @xmath65 is a set of pairs of its edges . for a topological graph @xmath15 that is a drawing of @xmath1 we define the at - graph of @xmath15 as @xmath66 where @xmath67 is the set of pairs of edges having at least one common crossing .",
    "a ( simple ) topological graph @xmath15 is called a _ ( simple ) realization _ of @xmath64 if @xmath68 .",
    "clearly , two topological graphs are weakly isomorphic if and only if they are realizations of the same at - graph .",
    "the _ rotation _ of a vertex @xmath69 in a topological graph @xmath15 is the clockwise cyclic order of the edges incident with @xmath69 .",
    "the rotation @xmath70 of a vertex @xmath69 is represented by a cyclic sequence of the vertices adjacent to @xmath69 .",
    "the _ rotation system _ of @xmath15 is the set of rotations of all its vertices .",
    "we use the following property of simple complete topological graphs , which directly implies the upper bound on @xmath23 in theorem  [ veta_uplne_historicka ] .",
    "[ tvrz_1graf-2rot]@xcite the rotation system of a simple complete topological graph @xmath1 uniquely determines which pairs of edges of @xmath1 cross .",
    "that is , two simple complete topological graphs with the same rotation system are weakly isomorphic .",
    "this property can be shown to be satisfied by a broader class of `` sufficiently dense '' graphs .",
    "for example , this property is satisfied by the wheel graph @xmath71 , and consequently by all graphs @xmath1 such that every pair of nonadjacent edges belongs to a subgraph of @xmath1 isomorphic to @xmath72 .",
    "this includes , for example , the complete @xmath73-partite graph @xmath74 with @xmath75 .",
    "but already for complete bipartite graphs , many weakly nonisomorphic drawings can share the same rotation system .",
    "for example , there are at least @xmath76 weakly nonisomorphic simple drawings of @xmath77 with the same rotation system . to see this ,",
    "let @xmath3 be an even positive integer and let @xmath78 be the vertices of @xmath77 with @xmath79 forming the @xmath80-element independent set of the bipartition .",
    "let @xmath81 be the rotation of @xmath69 and @xmath82 the rotation of @xmath83 .",
    "for every @xmath84 , there are two ways of drawing the four edges @xmath85 ( either @xmath86 crosses @xmath87 or @xmath88 crosses @xmath89 ) , and these choices can be done independently .",
    "see figure  [ obr_0_c4_dvema_zpusoby ] .",
    "note that by cloning the vertex @xmath69 into @xmath90 copies we obtain @xmath76 weakly nonisomorphic drawings of @xmath91 with the same rotation system .",
    "we note that the converse of proposition  [ tvrz_1graf-2rot ] is also true : the rotation systems of two weakly isomorphic simple complete topological graphs are either the same or inverse  @xcite .",
    "in this section we prove theorem  [ veta_uplne ] .    the upper bound @xmath92 in theorem  [ veta_uplne_historicka ] follows directly from proposition  [ tvrz_1graf-2rot ] , since there are at most @xmath93 possible rotations for each vertex , thus at most @xmath94 possible rotation systems of @xmath24 . however , not every set of rotations is realizable as a rotation system of a simple complete topological graph .",
    "for example , the rotation of each vertex in a simple complete topological graph is uniquely determined by the set of rotations of the other @xmath90 vertices .",
    "this is easily seen by investigating the drawings of @xmath95  @xcite ( see observation  [ obs_8_rotacnich_systemu ] ) and using the fact that a cyclic permutation of @xmath3 elements is determined by cyclic subpermutations of all triples .",
    "the smallest forbidden patterns in the rotation system are the @xmath96-tuples of cyclic subpermutations of @xmath73 elements that can not be realized as rotation systems of a simple drawing of @xmath95 .",
    "in fact , in section  [ section_combinatorial ] we show that it is possible to prove theorem  [ veta_uplne ] by combinatorial arguments , using only these simple forbidden patterns .",
    "however , we first show a proof relying more on the topological structure of the drawings , which gives a better upper bound on @xmath23 , and also provides an intuition for the purely combinatorial proof .",
    "the core idea in both versions of the proof is to reduce the problem of bounding @xmath23 to counting single permutations with forbidden subpermutations .",
    "let @xmath97 be the set of all _ @xmath3-permutations _ , that is , permutations of the set @xmath98 @xmath99",
    ". the _ restriction of @xmath100 to the @xmath101-tuple @xmath102 of positions _ , where @xmath103 , is the @xmath101-permutation @xmath104 satisfying @xmath105 .",
    "let @xmath106 .",
    "the @xmath101-tuple of positions @xmath107 is _ shattered by @xmath108 _ if each @xmath101-permutation appears as a restriction of some @xmath109 to @xmath107 .",
    "the _ vc - dimension of @xmath108 _ is the size of the largest set of positions shattered by @xmath108 . in other words ,",
    "the vc - dimension of @xmath108 is at most @xmath101 if for every @xmath110 positions @xmath111 there is some forbidden @xmath112-permutation that does not appear as a restriction of any @xmath113 to @xmath114 .",
    "raz  @xcite proved that a set of @xmath3-permutations of vc - dimension @xmath80 has size at most @xmath115 . the following result proved by cibulka and the author  @xcite is the key ingredient in the proof of theorem  [ veta_uplne ] .",
    "[ veta_vcdimenze]@xcite for every @xmath116 , the size of a set of @xmath3-permutations with vc - dimension @xmath117 is at most @xmath118    the upper bound in theorem  [ veta_vcdimenze ] is asymptotically almost tight , since there are sets of permutations with vc - dimension @xmath117 of size @xmath119  @xcite .",
    "if the forbidden @xmath112-permutation is the same for all @xmath112-tuples of positions , we get a better , exponential upper bound on the size of @xmath108 .",
    "this was conjectured by stanley and wilf and proved by marcus and tardos  @xcite , using klazar s earlier result  @xcite .",
    "later cibulka  @xcite improved klazar s reduction and obtained the upper bound @xmath120 on the size of @xmath108 .      a _ complete convex geometric graph _ ( shortly a _ convex graph _ ) is a topological graph whose vertices are in convex position and the edges are drawn as straight - line segments ; see figure  [ obr_1 ] , left .",
    "we denote by @xmath121 any complete convex geometric graph with @xmath4 vertices , as all such graphs belong to the same weak isomorphism class .",
    "a simple complete topological graph with @xmath4 vertices is called _ twisted _ and denoted by @xmath122 if there exists a _",
    "canonical _ ordering of its vertices @xmath123 such that for every @xmath124 and @xmath125 two edges @xmath126 cross if and only if @xmath127 or @xmath128 ; see figure  [ obr_1 ] , right .",
    "figure  [ obr_2 ] shows an equivalent drawing of @xmath122 on the cylindrical surface .",
    "let @xmath1 and @xmath2 be topological graphs .",
    "we say that @xmath1 _ contains _",
    "@xmath2 if @xmath1 has a topological subgraph weakly isomorphic to @xmath2 .",
    "we use the following asymmetric form of the ramsey - type result by pach , solymosi and tth  @xcite , which generalizes the erds ",
    "szekeres theorem for planar point sets .",
    "[ theorem_cm1_or_tm2]@xcite for all positive integers @xmath129 satisfying @xmath130 every simple complete topological graph with @xmath3 vertices contains @xmath131 or @xmath132 .    the graphs @xmath121 and @xmath122 are special cases of simple complete topological graphs with @xmath4 vertices and @xmath133 crossings , which is the maximum number of crossings possible  @xcite .",
    "the existence of a complete subgraph with @xmath4 vertices and @xmath133 crossings in a sufficiently large simple complete topological graph @xmath1 follows directly from ramsey s theorem and the nonplanarity of @xmath134  @xcite , but the bound on the size of @xmath1 obtained is much larger than that from theorem  [ theorem_cm1_or_tm2 ] .",
    "for the special case @xmath135 , harborth , mengersen , and schelp  @xcite showed a much better upper bound than that following from theorem  [ theorem_cm1_or_tm2 ] .",
    "[ theorem_c5_or_t5]@xcite every simple complete topological graph with @xmath136 vertices contains @xmath137 or @xmath138 .",
    "let @xmath1 be a simple complete topological graph and let @xmath69 be a vertex of @xmath1 .",
    "our goal is to obtain an upper bound on the number of possible rotations of @xmath69 in @xmath1 when the complete subgraph @xmath139 is fixed . to this end",
    ", we need to identify some forbidden permutations in the rotation of @xmath69 .",
    "[ lemma_triangle ] let @xmath1 be a simple complete topological graph with vertices @xmath140 .",
    "suppose that the counter - clockwise order of the vertices of the topological triangle @xmath141 is @xmath142 .",
    "if    1 .",
    "the vertex @xmath96 is outside the triangle @xmath141 and its rotation is @xmath143 , or 2 .",
    "the vertex @xmath96 is inside the triangle @xmath141 and its rotation is @xmath144 ,    then @xmath1 has no crossings .",
    "otherwise @xmath1 has one crossing .",
    "figure  [ obr_3 ] shows representatives of all four isomorphism classes of simple complete topological graphs with vertices @xmath140 .",
    "the notions of isomorphism and weak isomorphism for these graphs coincide , since in each of the four drawings different pairs of edges cross .",
    "each of the drawings is chosen so that the vertices @xmath142 appear in counter - clockwise order in the triangle @xmath141 and the vertex @xmath96 is outside the triangle @xmath141 .",
    "this still leaves some freedom in choosing the outer face of the drawing : we may always choose any of the three faces adjacent to the vertex @xmath96 , but the rotation system of the drawing stays the same . since the rotation of the vertex @xmath96 is @xmath143 in @xmath145 , which is without crossings , and @xmath144 in @xmath146 and @xmath147 , which have one crossing , the case when the vertex @xmath96 is in the outer face of @xmath141 follows .",
    "the other case follows by the symmetry exchanging the outer and the inner face of the triangle @xmath141 .",
    "[ lemma_c5 ] let @xmath1 be a simple complete topological graph with vertices @xmath148 .",
    "suppose that @xmath1 contains a convex graph @xmath137 induced by the vertices @xmath149 , which appear in this counter - clockwise order on its outer face .",
    "then the rotation of the vertex @xmath150 is not @xmath151 .",
    "let @xmath2 be the induced convex graph @xmath152 $ ] .",
    "suppose for contradiction that the rotation of the vertex @xmath150 in @xmath1 is @xmath151 .",
    "we distinguish two cases according to the face of @xmath2 in which the vertex @xmath150 is contained .",
    "see figure  [ obr_4 ] .    1 .",
    "the vertex @xmath150 is in one of the inner faces of @xmath2 . by symmetry",
    ", we may assume that it is either in the inner pentagonal face or in the intersection of the triangles @xmath153 and @xmath154 . the rotation of the vertex @xmath150 in @xmath155 $ ] is @xmath156 .",
    "by lemma  [ lemma_triangle ] applied to the triangle @xmath154 , the edge @xmath157 lies completely inside the triangle @xmath154 .",
    "the vertex @xmath150 is also outside the triangle @xmath158 and the rotation of @xmath150 in @xmath159 $ ] is @xmath160 . by lemma  [ lemma_triangle ] , the edges @xmath157 and @xmath161 do not cross .",
    "but this is a contradiction as the vertices @xmath150 and @xmath45 are separated by a closed curve formed by portions of the edges @xmath162 , which the edge @xmath163 can not cross .",
    "the vertex @xmath150 is in the outer face of @xmath2 . by lemma  [ lemma_triangle ]",
    "applied to the triangle @xmath158 , the edge @xmath157 can not cross the edge @xmath161 . consequently , the edge @xmath157 crosses no edge of @xmath2 .",
    "similarly , no other edge adjacent to @xmath150 can cross an edge of @xmath2 .",
    "this contradicts the conclusion of lemma  [ lemma_triangle ] applied to the triangle @xmath154 .",
    "[ lemma_c4 ] let @xmath1 be a simple complete topological graph with vertices @xmath149 .",
    "suppose that @xmath1 contains a convex graph @xmath2 induced by the vertices @xmath140 , which appear in this counter - clockwise order on its outer face .",
    "if the vertex @xmath164 is inside the triangular face of @xmath2 adjacent to the vertices @xmath80 and @xmath73 , then its rotation is not @xmath165 .",
    "see figure  [ obr_5 ] .",
    "suppose for contradiction that the vertex @xmath164 is inside the triangular face of @xmath2 adjacent to the vertices @xmath80 and @xmath73 and its rotation in @xmath1 is @xmath165 . by lemma  [ lemma_triangle ] applied to the triangles @xmath153 and @xmath154 , the edge @xmath166 does not cross the edges @xmath167 and @xmath168 .",
    "but portions of these edges form a closed curve separating the vertices @xmath96 and @xmath164 , a contradiction .",
    "[ lemma_t6 ] let @xmath1 be a simple complete topological graph with vertices @xmath169 .",
    "suppose that @xmath1 contains a twisted graph @xmath170 induced by the vertices @xmath148 , in this canonical order , and with the orientation where the rotation of the vertex @xmath150 is @xmath171 .",
    "then the rotation of the vertex @xmath63 is not @xmath172 .",
    "suppose for contradiction that the rotation of the vertex @xmath63 is @xmath172 .",
    "the subgraphs @xmath173 $ ] and @xmath174 $ ] are both isomorphic to the convex graph @xmath175 .",
    "the @xmath96-cycles corresponding to the outer face of @xmath175 are @xmath176 and @xmath177 , respectively .",
    "the two triangular faces adjacent to the vertices @xmath73 and @xmath96 in @xmath178 and @xmath179 cover the whole plane ; see figure  [ obr_6 ] .",
    "it follows that at least one of these two faces contains the vertex @xmath63 .",
    "the rotation of the vertex @xmath63 is @xmath180 in @xmath181 $ ] and @xmath182 in @xmath183 $ ] , which contradicts lemma  [ lemma_c4 ] .",
    "now we finish the proof of theorem  [ veta_uplne ] by combining previous results from this section .",
    "let @xmath184 be the number of different rotation systems of simple complete topological graphs with @xmath3 vertices . by proposition  [ tvrz_1graf-2rot ] , we have @xmath185 .",
    "we show an upper bound on @xmath184 by induction .",
    "let @xmath186 .",
    "assume that @xmath187 , otherwise @xmath188 , which is a constant .",
    "we may also assume for simplicity that @xmath189 where @xmath101 is a positive integer .",
    "let @xmath1 be a simple complete topological graph with vertices @xmath190 .",
    "let @xmath178 be the subgraph of @xmath1 induced by the vertices @xmath191 and let @xmath179 be the subgraph of @xmath1 induced by the vertices @xmath192 .",
    "fix a rotation system @xmath193 for @xmath178 and @xmath194 for @xmath179 .",
    "choose an arbitrary drawing of @xmath178 with the rotation system @xmath195 .",
    "let @xmath196 be a vertex of @xmath179 .",
    "we show an upper bound on the number of possible rotations of @xmath196 in the subgraph @xmath197 of @xmath1 induced by @xmath198 .    by theorem  [ theorem_cm1_or_tm2 ] ,",
    "every simple complete topological graph with @xmath199 vertices contains @xmath137 or @xmath170 .",
    "therefore , every induced subgraph of @xmath178 with @xmath199 vertices contains a subgraph @xmath2 weakly isomorphic to @xmath137 or @xmath170 . by lemma  [ lemma_c5 ] or  [ lemma_t6 ] ,",
    "one of the cyclic permutations of the vertices of @xmath2 is forbidden in the rotation of @xmath196 .",
    "note that lemmas  [ lemma_c5 ] and  [ lemma_t6 ] can be applied regardless of the particular way how @xmath2 is drawn .",
    "consequently , for each @xmath199-tuple of vertices in @xmath178 , a non - empty subset of their cyclic permutations is forbidden in the rotation of @xmath196 .",
    "let @xmath200 denote the set of all possible rotations of @xmath196 in @xmath197 . to pass from cyclic permutations to linear permutations ,",
    "we arbitrarily select a first element in each cyclic permutation from @xmath200 and denote the resulting set of permutations as @xmath201 . for each forbidden cyclic permutation @xmath202 of @xmath199 elements , the permutations from @xmath201 avoid all @xmath199 linear permutations obtained from @xmath202 .",
    "in particular , the vc - dimension of the set @xmath203 is at most @xmath204 .",
    "let @xmath205 be the maximum possible size of a set of @xmath4-permutations with vc - dimension @xmath204 . by theorem  [ veta_vcdimenze ] , @xmath206 where @xmath207 .",
    "for every @xmath208 , the rotation of @xmath196 in @xmath1 is uniquely determined by the rotation @xmath209 of @xmath196 in @xmath197 , the rotation @xmath210 of @xmath196 in @xmath179 and by one of the @xmath211 ways of merging @xmath209 and @xmath210 together . for @xmath212 , the situation is symmetric .",
    "it follows that the number of all possible rotation systems of @xmath1 with @xmath193 and @xmath194 fixed is at most @xmath213 where @xmath54 is an absolute constant .",
    "since there are @xmath214 possibilities for each of the rotation systems @xmath193 and @xmath194 , we have @xmath215      here we generalize theorem  [ veta_uplne ] to a purely combinatorial statement involving @xmath3-tuples of cyclic permutations .",
    "the aim is to estimate the number of possible rotation systems of a simple complete topological graph using as little topological information as possible . in particular",
    ", the only condition we need comes from drawings of complete graphs with @xmath96 vertices .",
    "@xcite[obs_8_rotacnich_systemu ] the eight rotation systems listed in table  [ rotacni_systemy_k4 ] are the only possible rotation systems of a simple complete topological graph with vertices @xmath140 .",
    ".the eight possible rotation systems of a simple complete topological graph with @xmath96 vertices .",
    "the labels refer to the drawings in figure  [ obr_3 ] , where @xmath216 denotes the mirror image of @xmath217 . [ cols=\"^,^\",options=\"header \" , ]     the eight rotation systems from observation  [ obs_8_rotacnich_systemu ]",
    "can be characterized by the following _ parity condition_. let @xmath218 and @xmath219 , with @xmath220 .",
    "we call the rotation @xmath221 at @xmath222 _ positive _ if @xmath223 and _ negative _ if @xmath224 .",
    "a @xmath96-tuple of rotations at vertices @xmath140 forms a rotation system of a simple complete topological graph with the vertices @xmath140 if and only if the number of negative rotations is even .",
    "note that this characterization does not depend on the particular linear ordering of the vertices .",
    "an _ abstract rotation system _",
    "@xmath225 on a set @xmath226 is an @xmath3-tuple of cyclic @xmath227-permutations @xmath228 where the set of elements of @xmath229 is @xmath230 .",
    "subsystem of @xmath225 induced _ by a subset @xmath231 , denoted by @xmath232 $ ] , is a @xmath233-tuple of cyclic permutations @xmath234 where @xmath235 is a restriction of @xmath236 to the subset @xmath237 .",
    "an abstract rotation system is _ realizable _ if it is a rotation system of a simple complete topological graph .",
    "realizable rotation systems on a set @xmath238 of size @xmath96 are precisely those satisfying the parity condition for some linear ordering of @xmath238 . an abstract rotation system @xmath225 is _ good _ if every subsystem of @xmath225 induced by a @xmath96-element subset is realizable .",
    "we prove the following theorem , generalizing theorem  [ veta_uplne ] .",
    "[ veta_kombinatoricka ] the number of good abstract rotation systems on an @xmath3-element set is at most @xmath239    we do not know whether the upper bound in theorem  [ veta_kombinatoricka ] is asymptotically tight .",
    "the best lower bound @xmath240 on the number of good abstract rotation systems comes from theorem  [ veta_uplne_historicka ] .",
    "[ problem_good ] is it true that the number of good abstract rotation systems on an @xmath3-element set is bounded by @xmath241 ?",
    "we note that the asymptotic number of abstract rotation systems may vary significantly if a different pattern of the same size is forbidden .",
    "there are @xmath163 possible abstract rotation systems on every @xmath96-element set .",
    "if the forbidden pattern consists of a different set of eight abstract rotation systems , we may obtain @xmath242 abstract rotation systems on @xmath3 elements satisfying this restriction .",
    "for example , consider the set @xmath243 of all abstract rotation systems on the set @xmath20 where in every induced subsystem on four elements @xmath244 , we forbid the eight abstract rotation systems with rotation @xmath245 at @xmath246 .",
    "the following construction shows that the size of @xmath243 is @xmath242 .",
    "consider an abstract rotation system @xmath247 where @xmath248 for @xmath249 and @xmath250 for @xmath251 .",
    "clearly , the rotation at @xmath246 in every subsystem of @xmath225 induced by four elements @xmath244 is @xmath252 .",
    "the number of such abstract rotation systems is @xmath253 .",
    "good abstract rotation systems do not characterize realizable abstract rotation systems completely .",
    "for example , the following two good abstract rotation systems on five elements are not realizable :    @xmath254    it is straightforward to check that both @xmath255 and @xmath256 are good .",
    "suppose that these systems are realizable .",
    "in both cases , in the subgraph @xmath2 induced by the vertices @xmath140 , the edges @xmath257 and @xmath168 cross .",
    "fix a drawing of @xmath2 as a convex graph with the vertices @xmath140 on the outer face in clockwise order ; see figure  [ obr_7 ] . in both cases ,",
    "the orientations of triangles and the rotations of vertices imply , by lemma  [ lemma_triangle ] , that the vertex @xmath164 must lie inside the triangles @xmath258 and @xmath259 .",
    "but this is impossible as the two triangles have disjoint interiors .",
    "while it is likely that there is no finite characterization of realizable abstract rotation systems by a finite list of forbidden subsystems , it is known that realizable abstract rotation systems can be recognized in polynomial time  @xcite .    to prove theorem  [ veta_kombinatoricka ]",
    ", we proceed in the same way as in the proof of theorem  [ veta_uplne ] , but we need to replace theorem  [ theorem_cm1_or_tm2 ] , lemma  [ lemma_c5 ] and lemma  [ lemma_t6 ] by combinatorial analogues .    an abstract rotation system on @xmath3 elements is called _ convex _ and denoted by @xmath260 if the elements can be ordered in a sequence @xmath190 so that the rotation at @xmath196 is @xmath261 , @xmath262 , @xmath263 .",
    "an abstract rotation system on @xmath3 elements is called _ twisted _ and denoted by @xmath264 if the elements can be ordered in a sequence @xmath190 so that the rotation at @xmath196 is @xmath265 , @xmath266 , @xmath262 , @xmath267 .",
    "note that @xmath260 is a rotation system of the convex graph @xmath268 and @xmath264 is a rotation system of the twisted graph @xmath269 .",
    "two abstract rotation systems are _ isomorphic _ if they differ only by relabeling of their ground set .",
    "an abstract rotation system @xmath225 _ contains _ an abstract rotation system @xmath270 if @xmath225 has an induced subsystem isomorphic to @xmath270 .",
    "the following theorem generalizes theorem  [ theorem_cm1_or_tm2 ] .",
    "[ veta_unavoidable_kombinatoricka ] for all positive integers @xmath271 there is an @xmath272 such that every good abstract rotation system on @xmath272 elements contains @xmath273 or @xmath274 .    to keep the proof simple ,",
    "we do not try to optimize the value of @xmath272 , as a function of the parameters @xmath275 and @xmath276 .",
    "however , it is likely that the same bound as in theorem  [ theorem_cm1_or_tm2 ] can be proved even in this generalized setting , by adapting the original topological proof  @xcite .",
    "we also note that the assumption of being good is not necessary : theorem  [ veta_unavoidable_kombinatoricka ] holds in general for all abstract rotation systems , only with larger values of @xmath272 .",
    "let @xmath277 be a good abstract rotation system on the set @xmath278",
    "@xmath279 @xmath280 @xmath281 . assume without loss of generality that @xmath282 and that @xmath283 for @xmath284 .",
    "for every three elements @xmath285 with @xmath286 , consider the induced abstract rotation system @xmath287 $ ] .",
    "for @xmath288 , let @xmath289 if the rotation at @xmath222 in @xmath287 $ ] is positive and @xmath290 if the rotation at @xmath222 in @xmath287 $ ] is negative .",
    "the _ type _ of the triple @xmath221 is the sequence @xmath291 . by the parity condition",
    ", we have the following four types of triples : @xmath292 and @xmath293 . by ramsey s theorem , if @xmath272 is sufficiently large , there is a subset @xmath294 of size @xmath295 such that all triples from @xmath238 have the same type . without loss of generality , assume that @xmath296 .",
    "let @xmath297 , with @xmath298 , be the type shared by all the triples from @xmath238 . if @xmath299 , then for each @xmath300 , the entries @xmath301 form an increasing sequence in @xmath302 .",
    "if @xmath303 , the entries @xmath301 form a decreasing sequence in @xmath302 . similarly , the entries @xmath304 form an increasing sequence in @xmath302 if @xmath305 and a decreasing sequence if @xmath306 .",
    "if @xmath307 , then in @xmath302 , all entries smaller than @xmath222 appear before all entries larger than @xmath222 .",
    "if @xmath308 , then in @xmath302 , all entries smaller than @xmath222 appear after all entries larger than @xmath222 . therefore , if @xmath309 or @xmath310 , then @xmath238 induces an abstract rotation system isomorphic to @xmath311 , and if @xmath312 or @xmath293 , then @xmath238 induces an abstract rotation system isomorphic to @xmath313 .",
    "the following two lemmas generalize lemma  [ lemma_c5 ] and lemma  [ lemma_t6 ] .",
    "again , we do not try to optimize the sizes of the two abstract rotation systems @xmath273 and @xmath274 .",
    "[ lemma_abstract_c7 ] let @xmath225 be a good abstract rotation system on the set @xmath314 .",
    "suppose that the subsystem of @xmath225 induced by the vertices @xmath169 is @xmath315 , with @xmath316 .",
    "then the rotation at @xmath317 is not @xmath318 .",
    "let @xmath319 and suppose for contradiction that @xmath320 @xmath321 .",
    "let @xmath322 be three consecutive numbers in the cyclic sequence @xmath323 .",
    "the subsystem @xmath324=(\\rho^i_i,\\rho^i_{i+1},\\rho^i_{i+2},\\rho^i_8)$ ] has at least one negative triple among @xmath325 .",
    "if @xmath326 is negative , that is , @xmath327 , we have @xmath328 .",
    "similarly , if @xmath329 is negative , then @xmath330 . finally , if @xmath331 is negative , then @xmath332",
    "therefore , a negative triple @xmath333 precisely determines the position of the element @xmath317 in the rotation @xmath334 , and each such rotation can arise from at most one negative triple @xmath333 .",
    "it follows that in each of the rotations @xmath335 , the element @xmath317 appears in one of the three possible positions between the elements @xmath336 and @xmath337 .",
    "but then the subsystem @xmath338=((10,3,5),(1,10,5),(1,3,10),(1,3,5))$ ] has exactly one negative triple , a contradiction .",
    "let @xmath339 be an abstract rotation system on a @xmath96-element set .",
    "the _ signature _ of @xmath225 is a sequence @xmath340 of four symbols , where @xmath341 is @xmath342 if @xmath343 is positive and @xmath344 if @xmath343 is negative .",
    "[ lemma_abstract_t816 ] let @xmath345 .",
    "let @xmath225 be a good abstract rotation system on the set @xmath346 .",
    "suppose that the subsystem of @xmath225 induced by the vertices @xmath347 , @xmath348 is @xmath349 , with @xmath350 .",
    "then the rotation at @xmath4 is not @xmath351 .",
    "let @xmath352 and suppose for contradiction that @xmath353 @xmath280 @xmath354 . let @xmath355 , @xmath356 and @xmath357 .    for @xmath358",
    ", we say that a rotation @xmath209 is of the _ first type _ if the element @xmath4 appears in @xmath209 within the subinterval @xmath359 , of the _ second type _ if @xmath4 appears in @xmath209 within the subinterval @xmath360 , of the _ third type _",
    "if @xmath361 , and of the _ fourth type _ if @xmath4 appears in @xmath209 within the subinterval @xmath362 .",
    "let @xmath363 ( @xmath364 ) be the set of those elements @xmath365 such that @xmath209 is of the first ( second , third ) type , respectively .",
    "let @xmath366 be the set of those elements @xmath358 such that @xmath209 is of the fourth type .",
    "first we show that @xmath367 . if @xmath368 , then at least @xmath369 elements @xmath370 of @xmath366 are all odd or all even . in particular",
    ", the rotation @xmath371 in the subsystem @xmath372=(\\rho_{i_1},\\rho_{i_{2k+1}},\\rho_{i_{4k+1}},\\rho_{m})$ ] is positive . since the rotations @xmath373 and @xmath374 are of the fourth type , we observe that the signature of @xmath372 $ ] is @xmath375 , which is a contradiction with the parity condition .",
    "next we show that @xmath376 .",
    "suppose for contradiction that @xmath377 .",
    "let @xmath378 be the set of even elements of @xmath379 and let @xmath380 be the smallest interval containing @xmath378 .",
    "let @xmath381 be the set of odd elements of @xmath379 .",
    "since @xmath382 , the interval @xmath380 contains at least @xmath73 odd elements @xmath383 of @xmath379 .",
    "in particular , for @xmath384 and @xmath385 , we have @xmath386 , @xmath387 and @xmath388 .",
    "it follows that @xmath389=((m , o_2,e_3),(e_1,m , e_3),(o_2,e_1,m),(o_2,e_1,e_3))$ ] . but this subsystem has signature @xmath390 , a contradiction .    for each @xmath391 and @xmath392 , we consider the subsystem @xmath393=(\\rho^{i , j}_{i-2j+1},\\rho^{i , j}_i,\\rho^{i , j}_{i+1},\\rho^{i , j}_{m})$ ] .",
    "since the parity of @xmath246 is opposite to the parity of @xmath394 and @xmath395 , the rotation @xmath396 is negative .",
    "since the rotation @xmath209 is of the first type , we have @xmath397 .",
    "it follows that the signature of @xmath393 $ ] is either @xmath398 or @xmath399 .",
    "moreover , there is a @xmath400 such that for @xmath401 the signature of @xmath393 $ ] is @xmath399 and for @xmath402 the signature of @xmath393 $ ] is @xmath398 .",
    "similarly for each @xmath403 and @xmath392 , we consider the subsystem @xmath404=(\\sigma^{i , j}_{i-2j},\\sigma^{i , j}_i,\\sigma^{i , j}_{i+1},\\sigma^{i , j}_m)$ ] .",
    "we have @xmath405 and @xmath406 , thus @xmath404 $ ] has signature either @xmath407 or @xmath408 .",
    "again , there is a @xmath400 such that the signature is @xmath408 for @xmath401 and @xmath407 for @xmath402 .",
    "let @xmath409 .",
    "for every @xmath410 , the signature of @xmath411 $ ] is @xmath398 .",
    "in particular , the rotation @xmath412 is of the fourth type .",
    "therefore , @xmath413 .",
    "similarly , let @xmath414 .",
    "for every @xmath410 , the signature of @xmath415 $ ] is @xmath407 . in particular , the rotation @xmath416 is of the fourth type .",
    "therefore , @xmath417 .",
    "let @xmath418 .",
    "for every @xmath419 and every @xmath392 , the signature of @xmath393 $ ] is @xmath399 . in particular ,",
    "observe that for every @xmath421 , there is at most one pair @xmath422 such that @xmath423 and @xmath424 .",
    "thus we have @xmath425 .",
    "let @xmath426 .",
    "for every @xmath419 and every @xmath392 , the signature of @xmath404 $ ] is @xmath408 . in particular",
    ", the element @xmath4 appears in @xmath427 in one of the two positions in the subinterval @xmath428 .",
    "this implies that for every @xmath429 , there is at most one pair @xmath422 such that @xmath430 and @xmath431 .",
    "thus we have @xmath432 .",
    "putting all the estimates together , we have @xmath433 and thus @xmath434    by our choice @xmath345 and @xmath355 , this gives @xmath435 and we have a contradiction .",
    "harborth and mengersen  @xcite investigated simple complete topological graphs on @xmath3 vertices with maximum number of crossings , which is @xmath436 .",
    "they showed the lower bound @xmath437 on the number @xmath438 of different weak isomorphism classes of such ( unlabeled ) graphs .",
    "their construction actually gives a better lower bound @xmath439",
    "@xcite .",
    "we do not have any better upper bound on @xmath438 than that from theorem  [ veta_uplne ] , thus the problem of determining @xmath438 asymptotically seems to be wide open .",
    "however , the following observation could help with improving the upper bound to @xmath241 .",
    "let @xmath1 be a simple complete topological graph with vertex set @xmath440 and with @xmath441 crossings .",
    "let @xmath442 and let @xmath443 be a subgraph of @xmath1 induced by @xmath444 .",
    "a _ face _ of @xmath443 is a connected region of the set obtained from the plane by removing all the edges of @xmath443 .",
    "two faces @xmath445 and @xmath446 in two simple complete topological graphs @xmath447 and @xmath448 weakly isomorphic to @xmath443 are considered _ equivalent _ if every triangle @xmath449 in @xmath447 and the corresponding triangle @xmath450 in @xmath448 satisfy the following condition : the triangles @xmath449 and @xmath450 have the same orientation if and only if either @xmath449 contains @xmath445 and @xmath450 contains @xmath446 , or @xmath445 is outside @xmath449 and @xmath446 is outside @xmath450 . by a _ combinatorial face _ we mean an equivalence class of faces , but also any particular face from the class .",
    "lemma  [ lemma_triangle ] implies that the combinatorial face of @xmath443 that contains @xmath69 uniquely determines the rotation of @xmath69 in @xmath1 .",
    "therefore , the number of possible rotations of @xmath69 , with the weak isomorphism class of @xmath443 fixed , is bounded from above by the number @xmath451 of possible combinatorial faces in a simple topological graph weakly isomorphic to @xmath443 . the number",
    "@xmath451 may be exponential , for example when @xmath443 is the convex graph @xmath268 .",
    "this graph has @xmath452 pairwise crossing edges ( main diagonals ) , which may be drawn through a common point @xmath453 .",
    "then each of the edges can be redrawn to go around @xmath453 from the left or from the right .",
    "each of these choices produces a different combinatorial face containing @xmath453 . on the other hand",
    ", it can be shown that @xmath454 , since each of the bounded combinatorial faces of @xmath268 can be assigned to a unique subset of pairwise crossing diagonals , in the following way .",
    "let @xmath455 be the hamiltonian cycle of @xmath268 bounding the outer face .",
    "to each diagonal @xmath456 of @xmath455 we assign the region @xmath457 bounded by @xmath456 and by the shorter arc of @xmath455 determined by the endpoints of @xmath456 .",
    "( for the main diagonals , we choose the `` shorter '' arc arbitrarily . )",
    "each face @xmath458 is assigned to a set @xmath459 of minimal regions @xmath457 containing @xmath458 .",
    "the set @xmath459 determines all triangles containing @xmath458 , and all diagonals @xmath456 such that @xmath460 are pairwise crossing .",
    "a set of pairwise crossing diagonals in @xmath268 is uniquely determined by the set of their endpoints .",
    "therefore , there are at most @xmath461 possible sets @xmath459 . accounting for two possible orientations of the drawing of @xmath268",
    ", we get the upper bound @xmath462",
    ".    we do not know whether similar upper bound holds for all simple complete topological graphs .",
    "[ problem_pocet_sten ] is it true that for every simple complete topological graph @xmath1 with @xmath3 vertices , the number of possible combinatorial faces in simple complete topological graphs weakly isomorphic to @xmath1 satisfies @xmath463    a positive answer to problem  [ problem_pocet_sten ] would imply that @xmath464 , by the proof in subsection  [ sub_dukaz_vety_uplne ] .",
    "a similar question can be asked in the combinatorial setting . in a simple complete topological graph with @xmath3 vertices and @xmath436 crossings",
    ", every @xmath96-tuple of vertices induces a crossing .",
    "therefore , for every complete subgraph with @xmath96 vertices there are @xmath150 possible rotation systems , corresponding to the rotation systems of the graphs @xmath465 in table  [ rotacni_systemy_k4 ] .",
    "in addition to the parity condition , these rotation systems satisfy the following condition .",
    "there exists a pair @xmath466 such that for @xmath467 , the rotation at @xmath101 is @xmath468 and the rotation at @xmath222 is @xmath221 .",
    "in fact , there are always four such pairs @xmath422 , corresponding to the four edges without crossing in the drawing .    what is the number of abstract rotation systems on @xmath3 elements , where every subsystem induced by @xmath96 elements is realizable as a rotation system of a simple drawing of @xmath95 with one crossing ?",
    "we do not know better lower bound than that implied by the topological construction by harborth and mengersen  @xcite .",
    "the best upper bound comes from theorem  [ veta_kombinatoricka ] .",
    "let @xmath469 be a graph with @xmath3 vertices and @xmath4 edges . if @xmath69 is an isolated vertex in @xmath1 , then @xmath470 .",
    "thus , we may assume that @xmath1 has no isolated vertices .",
    "the upper bound on @xmath471 for other graphs @xmath1 then directly follows .",
    "let @xmath472 be a simple topological graph realizing @xmath1 .",
    "a _ topological component _ of @xmath472 is a maximal connected subset of the plane that is a union of vertices and edges of @xmath472 .",
    "note that a topological component of @xmath472 is a union of components of @xmath1 .",
    "a topological graph @xmath472 is _ topologically connected _ if it has only one topological component .",
    "first we extend @xmath1 by adding edges connecting the topological components of @xmath472 as follows .",
    "let @xmath473 and @xmath474 be two topological components of @xmath472 .",
    "we redraw @xmath474 so that it has a vertex @xmath475 on the boundary of its outer face , and place this drawing inside a face of @xmath473 containing a vertex @xmath476 on its boundary",
    ". then we may add the edge @xmath477 as a curve without crossings .",
    "we repeat this process until there is only one topological component . since the graph @xmath1 had no isolated vertices , we added at most @xmath478 new edges , so the new graph has @xmath3 vertices and @xmath479 edges . in this way",
    ", we might have created at most @xmath480 different graphs .",
    "thus , for proving the upper bound on @xmath471 , we may assume that @xmath472 is topologically connected .",
    "ideally , we would like to extend the graph @xmath1 to a connected graph , but it is not clear that it is always possible to connect two components of @xmath1 that form a single topological component in the drawing by an edge so that the resulting drawing is still a simple topological graph .",
    "for example , there are simple topological graphs where some pairs of vertices from different components can not be connected by an edge , so that the resulting drawing is still simple ; see figure  [ obr_8 ] , left .",
    "next we construct a _",
    "topological spanning tree _",
    "@xmath481 of @xmath472 ; see figure  [ obr_9_t_representation ] , left .",
    "a topological spanning tree @xmath481 of @xmath472 is a simply connected subset of the single topological component of @xmath472 containing all vertices of @xmath472 and satisfying the property that the only nonseparating points of @xmath481 are the vertices of @xmath472 .",
    "our goal is to find such a tree consisting of @xmath482 connected portions of edges of @xmath472 .",
    "if @xmath1 is a complete graph , we may take as @xmath481 the star consisting of all edges incident with one vertex of @xmath472  @xcite , since such edges are internally disjoint .",
    "if @xmath1 is connected , we may start with a drawing of an arbitrary spanning tree of @xmath1 , but as some edges of the tree may cross , we may need to remove portions of some edges to break cycles .",
    "if @xmath1 has multiple components , the construction is a bit more involved .",
    "for example , it is not enough to take a union of spanning trees of the individual components , as some of the spanning trees may be topologically disjoint , even if @xmath472 is topologically connected ; see figure  [ obr_8 ] , right .",
    "also we may need to include in @xmath481 multiple disjoint portions of the same edge .",
    "let @xmath483 be the connected components of @xmath1 .",
    "we choose their order in such a way that for every @xmath484 , the drawing of @xmath485 is topologically connected .",
    "then for every @xmath486 , there is an edge @xmath487 in @xmath488 that crosses some edge @xmath489 .",
    "let @xmath449 be a spanning tree of @xmath490 and let @xmath491 be an edge of @xmath449 . for every @xmath486 , let @xmath492 be a spanning tree of @xmath488 containing @xmath487 .",
    "for every @xmath484 , let @xmath493 and let @xmath494 be the remaining edges of @xmath492 ordered in such a way that for every @xmath495 , the subgraph of @xmath492 formed by the edges @xmath496 is connected .",
    "in the rest of this section we often identify the vertices , edges and subgraphs of @xmath1 with the corresponding vertices , edges and subgraphs of @xmath472 .    the construction of @xmath481 proceeds in @xmath101 phases .",
    "in the first phase , we construct a topological spanning tree @xmath497 of @xmath490 , in the following way .",
    "we start with the tree @xmath498 consisting of the single edge @xmath491 .",
    "let @xmath499 and suppose that the tree @xmath500 has been defined .",
    "let @xmath501 be the vertex of @xmath502 that is not contained in the edges @xmath503 .",
    "if @xmath502 crosses none of the edges @xmath504 , then let @xmath505 .",
    "otherwise , among the crossings of @xmath506 with the edges @xmath504 , let @xmath507 be the crossing closest to @xmath501 .",
    "the tree @xmath508 is now obtained from @xmath500 by attaching the portion of @xmath506 between @xmath509 and @xmath501 .",
    "finally , we put @xmath510 .",
    "let @xmath486 and suppose that the tree @xmath511 has been defined . in the @xmath246th phase ,",
    "we construct the tree @xmath512 in the following way .",
    "let @xmath513 and let @xmath514 be the crossing of @xmath487 with @xmath515 .",
    "if @xmath487 crosses @xmath511 in at least one point , then let @xmath516 and @xmath517 be the crossings of @xmath487 with @xmath511 closest to @xmath518 and @xmath519 , respectively .",
    "the tree @xmath520 is then obtained from @xmath511 by attaching the portion of @xmath487 between @xmath518 and @xmath516 and the portion of @xmath487 between @xmath519 and @xmath517 .",
    "if @xmath487 is disjoint with @xmath511 , then we construct @xmath520 from @xmath511 by adding the whole edge @xmath487 and joining @xmath487 with @xmath511 by the shortest portion of @xmath515 connecting @xmath514 with a point of @xmath511 , which may be an endpoint of @xmath515 or a crossing .",
    "the rest of the @xmath246-th phase is similar to the construction of @xmath497 . in @xmath521-th step , we construct @xmath522 from @xmath523 by attaching the portion of @xmath502 connecting the vertex of @xmath502 not contained in @xmath523 with the closest point of @xmath523 along @xmath502 .",
    "finally , we put @xmath524 and @xmath525 .",
    "it follows from the construction that the tree @xmath481 has @xmath526 vertices , which are either vertices or crossings of @xmath472 , and hence at most @xmath527 edges , which are portions of edges of @xmath472 .",
    "now we construct the _ @xmath481-representation of @xmath472 _ , which generalizes the star - cut representation defined in  @xcite .",
    "consider @xmath472 drawn on the sphere @xmath528 and cut the sphere along the edges of @xmath481 .",
    "the resulting open set @xmath529 can be mapped by an orientation preserving homeomorphism @xmath530 to an open regular @xmath531-gon @xmath532 , in such a way that the inverse map @xmath533 can be continuously extended to the closure of @xmath532 so that the vertices and edges of @xmath532 are mapped to the vertices and edges of @xmath481 .",
    "note that every edge of @xmath481 corresponds to two edges of @xmath532 , and a vertex of degree @xmath37 in @xmath481 corresponds to @xmath37 vertices of @xmath532 .",
    "see figure  [ obr_9_t_representation ] , right . during the cutting operation",
    ", every edge @xmath456 of @xmath1 can be cut into at most @xmath534 pieces by the edges of @xmath481 .",
    "each such piece becomes a _ pseudochord _",
    "of @xmath532 .",
    "that is , a simple curve in @xmath532 with endpoints on the boundary of @xmath532 , and with the property that every two such curves cross in at most one point .",
    "moreover , two pseudochords sharing an endpoint are internally disjoint , as they correspond to portions of edges with a common vertex .",
    "to separate the endpoints of the pseudochords , we cut a small disc around each vertex @xmath83 of @xmath532 , draw a part of its boundary inside @xmath532 as an arc @xmath535 and shorten the pseudochords incident with @xmath83 so that their endpoints are on @xmath535 . for an edge @xmath456 of @xmath532 ,",
    "let @xmath536 be the counter - clockwise order of the endpoints of the pseudochords along @xmath456 .",
    "similarly , for each vertex @xmath83 of @xmath532 , let @xmath537 be the counter - clockwise order of the endpoints of the pseudochords along @xmath535 .",
    "the orders @xmath536 and @xmath537 are given as sequences of labels of the pseudochords .",
    "the collection of the orders @xmath536 and @xmath537 , which together form a cyclic sequence of endpoints of the pseudochords along the boundary of @xmath532 , is called the _",
    "perimetric order_.    the _ @xmath481-representation of @xmath472 _ is given by ( 1 ) the topological spanning tree @xmath481 and ( 2 ) the perimetric order @xmath538 .",
    "the tree @xmath481 is given as an abstract graph with a rotation system , which determines its combinatorial planar embedding .",
    "note that the perimetric order determines which pairs of pseudochords cross and how the pseudochords connect to the edges .",
    "thus the @xmath481-representation of @xmath472 determines the weak isomorphism class of @xmath472 .",
    "however , topological graphs weakly isomorphic to @xmath472 may have several different @xmath481-representations , which differ by the orders of crossings along the edges of @xmath481 .",
    "we say that two @xmath481-representations are _ weakly isomorphic _ if they are representations of weakly isomorphic topological graphs .",
    "the upper bound on @xmath471 will follow from an upper bound on the number of weak isomorphism classes of @xmath481-representations of simple drawings of @xmath1 .",
    "first we estimate the number of different topological spanning trees .",
    "[ lemma_trees ] let @xmath1 be a graph with @xmath3 vertices , @xmath4 edges and no isolated vertices",
    ". topologically connected simple realizations of @xmath1 have at most @xmath539 different topological spanning trees , up to a homeomorphism of the plane .",
    "let @xmath101 be the number of connected components of @xmath1 .",
    "a component with @xmath540 vertices has at most @xmath541 spanning trees , hence @xmath1 has at most @xmath539 spanning forests .",
    "let @xmath542 be a fixed spanning forest of @xmath1 .",
    "the inductive construction of the topological spanning tree @xmath481 consists of @xmath543 steps . in each step , an edge of some spanning tree @xmath492 is added to the construction .",
    "consider the step where a portion of the edge @xmath502 is added to the tree @xmath523 .",
    "the new edge is attached either to a vertex of @xmath523 or to an interior point of some edge of @xmath523 .",
    "there are two ways how to attach a new edge to an edge of @xmath523 , and @xmath37 ways how to attach a new edge to a vertex of degree @xmath37 in @xmath523 .",
    "together , there are @xmath544 different ways how to attach a new edge , where @xmath545 is the number of vertices of @xmath523 , and there are at most @xmath4 choices for the edge @xmath502 .",
    "now consider the step where portions of the edge @xmath487 are added to the tree @xmath511 .",
    "if @xmath487 crosses @xmath511 , then two portions of @xmath487 are added and this step is equivalent to two previous steps . if @xmath487 does not cross @xmath511 , then the whole edge @xmath487 and a portion of @xmath515 are added .",
    "there are at most @xmath4 choices for @xmath487 , @xmath4 choices for @xmath515 , two ways how to attach the portion of @xmath515 to @xmath487 and at most @xmath546 different ways how to attach the portion of @xmath515 to @xmath511 .",
    "altogether , we have at most @xmath547 ways how to construct @xmath481 .",
    "it remains to estimate for each topological spanning tree @xmath481 , the maximum number of weak isomorphism classes of @xmath481-representations .",
    "this will be the dominant term in the estimate of @xmath471 .",
    "every edge of @xmath1 corresponds to at most @xmath527 pseudochords in the @xmath481-representation .",
    "hence the @xmath481-representation has at most @xmath548 pseudochords , with at most @xmath549 different perimetric orders .",
    "this gives a trivial @xmath550 upper bound on the number of weak isomorphism classes of @xmath481-representations .    to determine the weak isomorphism class",
    ", we do not need the whole information given by the perimetric order .",
    "in fact , we only need to know the number of pseudochords corresponding to each edge of @xmath1 and the _ type _ of each pseudochord  @xcite , which we define in the next paragraph .",
    "there are at most @xmath551 choices of the numbers of pseudochords corresponding to the edges of @xmath1 in the @xmath481-representation .",
    "this upper bound is asymptotically dominated by the upper bounds in theorem  [ veta_hlavni ] , hence we consider these numbers fixed in the rest of this section .",
    "the _ type _ @xmath552 of a pseudochord @xmath553 is the pair @xmath554 where each of @xmath555 is either an edge of the polygon @xmath532 containing the endpoint of @xmath553 or an endpoint of @xmath553 on the arc @xmath535 for some vertex @xmath83 of @xmath532 .",
    "for each vertex @xmath83 of @xmath532 representing a vertex @xmath69 of @xmath1 , we consider @xmath556 points on @xmath535 as possible values of @xmath557 and @xmath558 . for each triple of vertices @xmath559 of @xmath532 representing a crossing @xmath453 of @xmath472",
    ", we have exactly one possible endpoint as a possible value of @xmath557 and @xmath558 , on exactly one of the arcs @xmath560 .",
    "this follows from the fact that @xmath481 contains exactly three portions of edges incident with @xmath453 and only the fourth portion becomes a pseudochord .",
    "let @xmath553 and @xmath561 be pseudochords with types @xmath554 and @xmath562 , respectively .",
    "we say that the types @xmath554 and @xmath562 are    _ crossing _ if the elements @xmath563 are pairwise distinct and their cyclic order around the boundary of @xmath532 is @xmath564 or @xmath565 ,    _ avoiding _ if they are not crossing and all the elements @xmath563 are pairwise distinct ,    _ parallel _ if @xmath566 or @xmath567 , and    _ adjacent _ otherwise , that is , if exactly one of the following four equalities holds : @xmath568 , @xmath569 , @xmath570 or @xmath571 .",
    "see figure  [ obr_10_typy ] for examples .",
    "if the elements @xmath572 are pairwise distinct , we can directly determine whether @xmath553 and @xmath561 cross : crossing types imply crossing pseudochords and avoiding types imply disjoint pseudochords .",
    "if , for example , @xmath568 ( in which case @xmath557 is an edge of @xmath532 ) , we can not determine whether @xmath553 and @xmath561 cross , since this depends on the relative position of the endpoints of @xmath553 and @xmath561 on @xmath557 .",
    "the pairs of pseudochords with parallel and adjacent types can be arranged into maximal sequences , called _ ladders _ , formed by portions of two edges of @xmath1 , for which we can determine whether they cross or not .",
    "see  @xcite for details .",
    "a pseudochord is called _ external _ if it represents the initial or the terminal portion of an edge of @xmath1 .",
    "thus , at least one of the endpoints of an external pseudochord lies on one of the arcs @xmath535 where @xmath83 is a vertex of @xmath532 representing a vertex of @xmath1 .",
    "all the other pseudochords are called _",
    "internal_. every external pseudochord can have one of @xmath573 possible types .",
    "every internal pseudochord , representing an internal portion of an edge of @xmath1 , can have only @xmath574 different types , since for the variables @xmath555 , we are considering only edges of @xmath532 and points on the arcs @xmath535 , where @xmath83 is a vertex of @xmath532 representing a crossing of @xmath472 . altogether , there are at most @xmath575 combinations of types of the external pseudochords .",
    "this is again asymptotically dominated by the upper bounds in theorem  [ veta_hlavni ] . in the rest of this section",
    ", we consider only internal pseudochords . for a subset @xmath576 of edges of @xmath1 ,",
    "let @xmath577 be the number of possible combinations of types of the internal pseudochords corresponding to the edges from @xmath578 .",
    "similarly , for a set @xmath579 of internal pseudochords , let @xmath580 be the number of possible combinations of types of pseudochords from @xmath579 .",
    "our goal is to obtain a good upper bound on @xmath581 .",
    "a trivial estimate gives the upper bound @xmath582 .",
    "this can be improved by considering the fact that the pseudochords representing a common edge of @xmath1 do not cross .",
    "also note that for two pseudochords @xmath583 representing a common edge @xmath456 , their types are always avoiding .",
    "it follows that the set of types of the pseudochords representing @xmath456 can be represented as a noncrossing matching of size at most @xmath527 on a set of at most @xmath546 points in convex position , where each point corresponds to an edge or a vertex of @xmath532 .",
    "observe that the order of the pseudochords along @xmath456 can be reconstructed from this matching , thus this representation is injective .",
    "the number of such matchings is bounded from above by @xmath115 .",
    "together , this gives the upper bound @xmath584 .",
    "this estimate can be improved even further . in a simple topological graph , edges incident to a common vertex @xmath69 do not cross .",
    "therefore , all the internal pseudochords representing edges incident with @xmath69 are pairwise disjoint .",
    "let @xmath585 be the set of these pseudochords .",
    "note that two pseudochords from @xmath585 representing different edges may have avoiding , parallel or adjacent types .",
    "let @xmath37 be the degree of @xmath69 .",
    "similarly as before , we can represent the set of types of the pseudochords from @xmath585 as a noncrossing matching @xmath272 on a set of at most @xmath586 points in convex position , where each vertex of @xmath532 is represented by a point and each edge of @xmath532 is represented by @xmath37 consecutive points .",
    "again , from the matching @xmath272 and from the types of the external pseudochords representing the edges incident with @xmath69 we can uniquely determine which edge each pseudochords represents and how the pseudochords connect together to form the ( portions of ) edges incident with @xmath69 . a straightforward upper bound @xmath587 follows . to get a better upper bound",
    ", we observe that many of these pseudochords share the same type .",
    "more precisely , we have up to @xmath588 pseudochords in @xmath585 , but only @xmath482 different types , since no two of the types are crossing . there are @xmath115 ways of choosing the set of pairwise noncrossing types for internal pseudochords . for a fixed set @xmath579 of @xmath482 types , we assign to each type",
    "@xmath589 its _ weight _ , that is , a positive integer @xmath590 denoting the number of pseudochords from @xmath585 with type @xmath591 .",
    "the set @xmath592 satisfying the property @xmath593 is called the _ weight vector _ of @xmath579 . from the set @xmath579 and its weight vector",
    ", we can reconstruct the matching @xmath272 and determine the type of each pseudochord and how the pseudochords connect to edges .",
    "this idea is similar to encoding curves on a surface using normal coordinates  @xcite .",
    "for a fixed @xmath579 , there are @xmath594 different weight vectors .",
    "this gives the upper bound @xmath595 . by jensen s inequality , @xmath596 .",
    "together with lemma  [ lemma_trees ] , this gives the first upper bound in theorem  [ veta_hlavni ] .",
    "the previous method gives a good upper bound on @xmath471 for dense graphs . for graphs with @xmath597 edges ,",
    "the method is useful if the graph has very irregular degree sequence ; more precisely , if it has a small number of vertices covering almost all the edges . for graphs with @xmath598 edges and with most of the vertices of degree @xmath599",
    ", we get better results by considering larger subsets of edges .",
    "we just need to balance the number of edges in the subset to keep the number of their crossings small enough .",
    "[ lemma_ktice_hran ] let @xmath576 be a set of @xmath101 edges",
    ". then @xmath600 in particular , for @xmath601 we have @xmath602    let @xmath603 be the set of ( both external and internal ) pseudochords representing the edges of @xmath578 .",
    "since every two edges cross at most once , there are at most @xmath604 crossings among the pseudochords from @xmath603 . in particular , at most @xmath605 pseudochords from @xmath603",
    "cross other pseudochord from @xmath603 .",
    "let @xmath606 be the set of pseudochords crossing at least one pseudochord from @xmath603 .",
    "let @xmath607 be the set of internal pseudochords from @xmath608 .",
    "we estimate the number of perimetric orders of @xmath609 pseudochords in @xmath532 inducing at most @xmath604 crossings .",
    "each such perimetric order , together with the set of types of the external pseudochords from @xmath603 , determine the types of all pseudochords from @xmath603 , since no member of @xmath610 crosses a member of @xmath611 .",
    "for the pseudochords from @xmath612 , we have at most @xmath613 ways of choosing the set of their endpoints on the boundary of @xmath532 , and at most @xmath614 ways of matching them together .",
    "here we do not need to optimize for matchings inducing @xmath615 crossings .",
    "however , proposition  [ prop_chord_diagrams ] in the next section implies the upper bound @xmath616 .",
    "the pseudochords from @xmath607 form a noncrossing matching in the regions of @xmath617 . to determine the positions of the pseudochords from @xmath607",
    ", we need to refine their types into _ subtypes _ by splitting the edges of @xmath532 by the endpoints of the pseudochords from @xmath612 .",
    "see figure  [ obr_11_subtypy ] .",
    "there are at most @xmath618 portions of edges of @xmath532 after this splitting , hence at most @xmath619 choices for the set of pairwise noncrossing subtypes of the pseudochords from @xmath607 .",
    "finally , there are at most @xmath620 ways of assigning a vector of positive integers with total sum at most @xmath621 to the chosen set of subtypes .",
    "this is sufficient to determine the perimetric order of the pseudochords from @xmath603 and the lemma follows .",
    "the second upper bound in theorem  [ veta_hlavni ] is proved as follows . by lemma  [ lemma_trees ]",
    ", we may fix a topological spanning tree .",
    "then we partition the edge set of @xmath1 into @xmath622 subsets of size at most @xmath623 and apply lemma  [ lemma_ktice_hran ] to each of the subsets .",
    "theorem  [ veta_pseudosegmenty ] is a special case of theorem  [ veta_hlavni ] , where the graph @xmath1 is a matching .",
    "we start with some additional definitions and a combinatorial definition of the isomorphism of topological graphs .",
    "then we show that we need to consider only topologically connected topological graphs .",
    "finally , we reduce the problem to counting isomorphism classes of arrangements of pseudochords and present two different solutions to this problem . in the first solution we split the problem into two parts : enumerating chord diagrams and enumerating arrangements with fixed boundary , using encoding by binary vectors .",
    "the second approach is based on enumerating the dual graphs of the arrangements , which form a subclass of quadrangulations of a disc .",
    "a _ rotation _ of a crossing @xmath54 in a topological graph is the clockwise cyclic order in which the four portions of the two edges crossing at @xmath54 leave the point @xmath54 .",
    "note that each crossing has exactly two possible rotations .",
    "an _ extended rotation system _ of a simple topological graph is the set of rotations of all its vertices and crossings . assuming that @xmath15 and @xmath624 are drawings of the same abstract graph",
    ", we say that their ( extended ) rotation systems are _ inverse _ if for each vertex @xmath625 ( and each crossing @xmath54 in @xmath15 ) the rotation of @xmath69 and the rotation of the corresponding vertex @xmath626 are inverse cyclic permutations ( and so are the rotation of @xmath54 and the rotation of the corresponding crossing @xmath627 in @xmath624 ) .",
    "for example , if @xmath624 is a mirror image of @xmath15 , then @xmath15 and @xmath624 have inverse ( extended ) rotation systems .",
    "topologically connected topological graphs @xmath1 and @xmath2 are _ isomorphic _ if ( 1 ) @xmath1 and @xmath2 are weakly isomorphic , ( 2 ) for each edge @xmath456 of @xmath1 the order of crossings with the other edges of @xmath1 is the same as the order of crossings on the corresponding edge @xmath628 in @xmath2 , and ( 3 ) the extended rotation systems of @xmath1 and @xmath2 are either the same or inverse .",
    "this induces a one - to - one correspondence between the faces of @xmath1 and @xmath2 such that the crossings and the vertices incident with a face @xmath458 of @xmath1 appear along the boundary of @xmath458 in the same ( or inverse ) cyclic order as the corresponding crossings and vertices in @xmath2 appear along the boundary of the face @xmath629 corresponding to @xmath458 .",
    "it follows from jordan  schnflies theorem that this definition is equivalent to the previous one in section  [ section_intro ] .",
    "let @xmath1 be a topological graph with more than one topological component .",
    "the _ face structure _ of @xmath1 is a collection of face boundaries , represented as oriented facial walks in the underlying abstract graph , of all noncontractible faces of @xmath1 , that is , faces with more than one boundary component .",
    "the orientations are chosen in such a way that either for each noncontractible face the facial walk of the outer boundary component is oriented clockwise and the facial walks of all inner boundary components are oriented counter - clockwise , or vice versa .",
    "both choices are regarded as giving the same face structure . by this condition ,",
    "the orientations of the facial walks in the face structure encode relative orientations of the topological components .",
    "note that the rotation system of @xmath1 is not sufficient to determine the orientation of topological components that are simple cycles .",
    "topological graphs @xmath1 and @xmath2 with more than one topological component are _ isomorphic _ if there is a one - to - one mapping between the vertices and edges of @xmath1 and @xmath2 satisfying the conditions ( 1)(3 ) and , in addition , ( 4 ) the face structures of @xmath1 and @xmath2 are the same",
    ".      let @xmath1 be a graph with no isolated vertices .",
    "let @xmath472 be a topological graph realizing @xmath1 .",
    "if @xmath472 has more than one topological component , we want to extend it to a topologically connected graph by adding edges connecting the topological components , in the same way as in the previous section . however , for this extension to be possible we may need to rearrange the topological components of @xmath472 , which changes the face structure of @xmath472 . while preserving the isomorphism classes of the @xmath101 topological components of @xmath472 ,",
    "there are @xmath630 ways of choosing their orientation and at most @xmath631 possible face structures of topological graphs built from these components .",
    "thus there are at most @xmath539 rearrangements of topological components of @xmath472 .",
    "hence , by the same argument as in the previous section , we may further assume that @xmath472 is topologically connected .",
    "an essential part of the structure of a particular isomorphism class of simple topological graphs is captured by the following combinatorial object , which slightly generalizes arrangements of pseudolines .",
    "an _ arrangement of pseudochords _ is a finite set @xmath272 of simple curves in the plane with endpoints on a common simple closed curve @xmath632 , such that all the curves from @xmath272 lie in the region bounded by @xmath632 and every two curves in @xmath272 have at most one common point , which is a proper crossing .",
    "the elements of @xmath272 are called _",
    "pseudochords_. the arrangement @xmath272 is _ simple _ if no three pseudochords from @xmath272 share a common crossing .",
    "the _ perimetric order _ of @xmath272 is the counter - clockwise cyclic order of the endpoints of the pseudochords of @xmath272 on @xmath632 .",
    "the perimetric order of @xmath272 determines which pairs of pseudochords cross and which do not , but it does not determine the orders of crossings on the pseudochords .",
    "two ( labeled ) arrangements of pseudochords are _ isomorphic _ if they have the same perimetric order and the same orders of crossings on the corresponding pseudochords .",
    "equivalently , one arrangement can be obtained from the other one by an orientation preserving homeomorphism .",
    "note that a @xmath481-representation of a simple topological graph can be regarded as a simple arrangement of pseudochords .",
    "the following proposition is inspired by felsner s",
    "@xcite enumeration of simple wiring diagrams .",
    "originally it appeared in  @xcite as proposition 7 , but in an incorrect , stronger form .",
    "[ prop_2na2k_chords ] ( * ? ? ?",
    "* a correct form of proposition 7 ) the number of isomorphism classes of simple arrangements of @xmath3 pseudochords with fixed perimetric order inducing @xmath101 crossings is at most @xmath633 .",
    "let @xmath634 be a simple arrangement of pseudochords with endpoints on a circle @xmath632 and with a given perimetric order .",
    "cut the circle at an arbitrary point and unfold it by a homeomorphism to a horizontal line @xmath222 , while keeping all the pseudochords above @xmath222 .",
    "orient each pseudochord @xmath635 from its left endpoint @xmath636 to its right endpoint @xmath637 .",
    "let @xmath638 be the number of crossings on @xmath635 and let @xmath639 be the crossings of @xmath635 ordered from @xmath636 to @xmath637 .",
    "let @xmath640 be the pseudochord that crosses @xmath635 at @xmath641 .    for two crossing pseudochords @xmath635 and @xmath642",
    "we say that @xmath635 _ is to the left of _",
    "@xmath642 if @xmath636 is to the left of @xmath643 .",
    "this is equivalent with the rotation of their common crossing being @xmath644 .",
    "to each @xmath635 we assign a vector @xmath645 where @xmath646 if @xmath640 is to the left of @xmath635 and @xmath647 if @xmath635 is to the left of @xmath640 .",
    "the sum of the lengths of the vectors @xmath648 is equal to @xmath649 .",
    "hence , there are at most @xmath633 different sequences @xmath650 encoding an arrangement with the given perimetric order and the chosen orientation of pseudochords .",
    "it remains to show that we can uniquely reconstruct the isomorphism class of @xmath272 from the vectors @xmath651 by identifying the pseudochords @xmath640 .",
    "we proceed by induction on @xmath101 and @xmath3 . for arrangements without crossings",
    "there is only one isomorphism class with a fixed perimetric order . now",
    ", suppose that we can reconstruct the isomorphism class for arrangements with at most @xmath652 crossings and take a sequence @xmath653 encoding an arrangement @xmath272 with @xmath101 crossings .",
    "if some of the vectors @xmath648 is empty , the corresponding pseudochord @xmath635 is empty ( has no crossing ) .",
    "we may then draw @xmath635 as an arbitrary curve @xmath654 from @xmath636 to @xmath637 in the upper half - plane of @xmath222 .",
    "then we split the arrangement into two parts : the _ inner _ part consisting of pseudochords with endpoints between @xmath636 and @xmath637 , and the _ outer _ part with endpoints to the left of @xmath636 or to the right of @xmath637 .",
    "we draw both parts separately by induction .",
    "finally , by applying a suitable homeomorphism we place the inner part inside the region bounded by @xmath654 and @xmath222 and the outer part outside that region .",
    "further we assume that @xmath272 has no empty pseudochords .",
    "without loss of generality we may assume that the left endpoints are ordered along @xmath222 as @xmath655 from left to right .",
    "clearly , @xmath656 and @xmath657 .",
    "it follows that there exists @xmath658 such that @xmath659 and @xmath660 .",
    "the first crossing on the pseudochords @xmath661 and @xmath662 is their common crossing .",
    "that is , @xmath663 and @xmath664 .",
    "refer to figure  [ obr_12_vynuceni ] . for contradiction ,",
    "suppose that @xmath665 ( the case when @xmath666 is symmetric )",
    ". then @xmath667 .",
    "hence , @xmath668 for some @xmath669 and the crossing of @xmath662 with @xmath670 occurs within the triangle @xmath671 .",
    "this forces the pseudochords @xmath672 and @xmath670 to cross twice , a contradiction .",
    "let @xmath673 be the first crossing on @xmath661 and @xmath662 . since the two arcs @xmath674 and @xmath675 are free of crossings , there is no endpoint between @xmath676 and @xmath677 on @xmath222 . for the induction step ,",
    "we swap the endpoints @xmath678 and @xmath677 in the perimetric order of @xmath272 and delete the first value from the vectors @xmath679 and @xmath680 . in this way we obtain an encoding @xmath681 of an arrangement @xmath682 with @xmath652 crossings , which is obtained from @xmath272 by deleting the arcs @xmath674 and @xmath675 , including a small open neighborhood of @xmath54 . by the induction hypothesis ,",
    "the isomorphism class of @xmath682 can be uniquely reconstructed from @xmath681 . by attaching to @xmath682 two crossing arcs starting at @xmath676 and @xmath677 and thus extending the two pseudochords @xmath661 and @xmath662",
    ", we obtain an arrangement isomorphic to @xmath272 .",
    "let @xmath1 be a graph with @xmath3 vertices , @xmath4 edges and no isolated vertices .",
    "let @xmath472 be a topologically connected simple topological graph that realizes @xmath1 .",
    "the isomorphism class of @xmath472 is determined by the isomorphism class of a @xmath481-representation of @xmath472 . to determine the isomorphism class of a @xmath481-representation",
    ", we need to determine ( 1 ) the topological spanning tree @xmath481 , ( 2 ) the perimetric order of the @xmath481-representation , and ( 3 ) the isomorphism type of the induced arrangement of pseudochords .",
    "\\(1 ) by lemma  [ lemma_trees ] , there are at most @xmath539 choices for the topological spanning tree @xmath481 of @xmath472 , up to a homeomorphism of the plane . for the rest of the section , we fix one topological spanning tree @xmath481 of @xmath472 .",
    "\\(2 ) with @xmath481 fixed , a @xmath481-representation can have at most @xmath550 diferent perimetric orders , as we have seen in subsection  [ sub_pocitani_t_reprezentaci ] .",
    "this estimate is good enough when @xmath1 has @xmath683 edges , but we need a better upper bound for sparser graphs .",
    "this can be achieved by counting only perimetric orders that induce at most @xmath684 crossings .",
    "there are at most @xmath685 ways of choosing the set of endpoints of the pseudochords along the boundary of the disc @xmath532 in the @xmath481-representation .",
    "to determine the perimetric order , we need , in addition , to determine a perfect matching of the endpoints inducing at most @xmath684 crossings .",
    "such matchings can be also regarded as representations of _ circle graphs _ with a given number of vertices and edges . in the literature ,",
    "these structures are called _ chord diagrams _  @xcite .",
    "see figure  [ obr_12_2_sawtooth ] , left .",
    "following the notation in  @xcite , let @xmath686 denote the number of diagrams of @xmath3 chords with @xmath101 crossings .",
    "it is well known that @xmath687 , which is the number of noncrossing perfect matchings of @xmath527 points on the circle , is equal to the @xmath3th catalan number .",
    "precise enumeration results for @xmath686 in the form of generating functions were obtained by touchard  @xcite and riordan  @xcite , but explicit formulas for @xmath686 were computed only for @xmath688  @xcite .",
    "the following asymptotic upper bound is implicit in read s paper  @xcite .",
    "@xcite[prop_chord_diagrams ] for the number of diagrams of @xmath3 chords with at most @xmath101 crossings , we have the upper bound @xmath689 where @xmath690 is the @xmath3th catalan number .    like in the proof of proposition  [ prop_2na2k_chords ] , the key `` trick ''",
    "is breaking the symmetry of the circle by cutting it at one point and unfolding onto a horizontal line @xmath222 . the chords then become arcs in the upper half - plane with endpoints on @xmath222 .",
    "each such arc has a distinguished left endpoint and a right endpoint . instead of arbitrary arcs , read  @xcite constructs triangular `` teeth '' consisting of a diagonal segment from the left endpoint followed by a vertical segment to the right endpoint and calls the resulting drawing the _ sawtooth diagram _ associated to the original chord diagram .",
    "see figure  [ obr_12_2_sawtooth ] , right .",
    "let @xmath691 be the set of all the left endpoints of the chords on @xmath222 , and @xmath692 the set of all the right endpoints .",
    "for every point @xmath453 on @xmath222 , there are at least as many left endpoints than right endpoints to the left of @xmath453 . therefore the sets @xmath691 and @xmath692 correspond to the sets of @xmath3 left and @xmath3 right parentheses that are correctly matched .",
    "there are exactly @xmath690 such partitions @xmath693 of the @xmath527 points on @xmath222 .",
    "one partition @xmath693 can be shared by more sawtooth diagrams , if crossings are allowed . to determine the sawtooth diagram ( and the corresponding chord diagram ) uniquely",
    ", we encode the intersection graph of the chords as follows .",
    "let @xmath694 be the points of @xmath692 ordered from left to right .",
    "for @xmath695 , let @xmath696 be the chord with right endpoint @xmath637 , let @xmath636 be the left endpoint of @xmath696 and let @xmath638 be the number of chords with left endpoint to the right of @xmath636 that cross @xmath696 .",
    "we claim that the vector @xmath697 , together with the partition @xmath693 , uniquely determines the sawtooth diagram .",
    "this can be seen by drawing the diagram from left to right .",
    "all the crossings of the chord @xmath696 with chords with left endpoint to the right of @xmath636 occur on the vertical segment of @xmath696 with endpoint @xmath637 .",
    "therefore , every time we reach the @xmath453-coordinate of some @xmath637 , we take the @xmath698th diagonal segment from the bottom and connect its right endpoint by a vertical line to @xmath637 .",
    "all the other diagonal segments are extended further to the right .",
    "since @xmath699 , for every partition @xmath693 there are at most @xmath700 possible vectors @xmath701 and the proposition follows .    by proposition  [ prop_chord_diagrams ] , by the entropy bound for binomial coefficients and by the inequality @xmath702 , the number of possible perimetric orders of the @xmath481-representation is at most @xmath703    \\(3 ) by proposition  [ prop_2na2k_chords ] , there are less than @xmath704 isomorphism classes of simple arrangements of pseudochords induced by the @xmath481-representation with a given perimetric order . together with proposition  [ prop_chord_diagrams ] and previous discussion , this implies that @xmath705    for graphs with @xmath706 the second term in the exponent becomes more significant . since @xmath707",
    ", the exponent can be also bounded by @xmath708 using the entropy bound for the binomial coefficient @xmath709 .",
    "this proves the second upper bound in theorem  [ veta_neizo ] .      here",
    "we show an alternative approach to enumerating simple arrangements of pseudochords .    a _ quadrangulation _ of the disc @xmath532 is a @xmath80-connected plane graph embedded in @xmath532 such that its outer face coincides with the boundary of @xmath532 and every inner face is bounded by a @xmath96-cycle .",
    "a quadrangulation is called _ simple _ if it has no separating @xmath96-cycle .",
    "the vertices of the quadrangulation lying on the boundary of @xmath532 are called _ external _ , all the other vertices are _",
    "mullin and schellenberg  @xcite proved that there are @xmath710 isomorphism classes of rooted simple quadrangulations of the disc with @xmath199 internal and @xmath711 external vertices .",
    "the _ dual graph _ of a simple arrangement of pseudochords is constructed as follows .",
    "place one vertex inside each @xmath80-dimensional cell and one vertex in the interior of every boundary edge .",
    "then join all pairs of vertices that correspond to adjacent @xmath80-cells or to a boundary edge and its adjacent @xmath80-cell .",
    "see figure  [ obr_12_3_quadrangulation ] .",
    "observe that the dual graph of a simple arrangement of @xmath3 pseudochords with @xmath101 crossings is a simple quadrangulation with @xmath527 external and @xmath712 internal vertices . from the quadrangulation",
    "the original arrangement can be uniquely reconstructed up to isomorphism .",
    "however , not all simple quadrangulations can be obtained in this way : the graph of the @xmath73-dimensional cube is such an example .    by plugging @xmath713 and @xmath714 into mullin s and schellenberg s formula and summing over @xmath715",
    "we obtain the following upper bound .",
    "[ prop_arrangmenty_pres_quadrangulace ] there are at most @xmath716 isomorphism classes of simple arrangements of @xmath3 pseudochords with at most @xmath101 crossings .    instead of using proposition  [ prop_chord_diagrams ] and  [ prop_2na2k_chords ]",
    ", we may directly apply proposition  [ prop_arrangmenty_pres_quadrangulace ] with @xmath717 and @xmath718 .",
    "this gives the first upper bound in theorem  [ veta_neizo ] :    @xmath719    substituting @xmath720 , the exponent can be also bounded by @xmath721 using the entropy bound for the binomial coefficients @xmath722 and @xmath723 .      the upper bound @xmath724 is trivially obtained from the upper bound on the number of unlabeled plane graphs ( or planar maps ) .",
    "indeed , every drawing @xmath472 of @xmath1 can be transformed into a plane graph @xmath2 by subdividing the edges of @xmath472 by its crossings and regarding the crossings of @xmath472 as new @xmath96-valent vertices in @xmath2 .",
    "the graph @xmath2 has thus at most @xmath725 vertices , at most @xmath726 edges , no loops and no multiple edges .",
    "a _ rooted connected planar map _ is an unlabeled connected plane multigraph with a distinguished vertex , the _",
    "root_. in particular , multiple edges and loops are allowed .",
    "tutte  @xcite showed that there are @xmath727 rooted connected planar maps with @xmath272 edges ( see also  @xcite ) .",
    "walsh and lehman  @xcite showed that the number of rooted connected planar loopless maps with @xmath272 edges is @xmath728 this implies the upper bound @xmath729 .",
    "somewhat better estimates could be obtained by reducing the problem to counting @xmath96-regular connected planar maps  @xcite , since typically almost all vertices in @xmath2 are the @xmath96-valent vertices obtained from the crossings of @xmath472 .",
    "but such a reduction would be less straightforward and the resulting upper bound @xmath730 would not improve our upper bound @xmath10 for dense graphs ( for graphs with more than @xmath731 edges the first upper bound from theorem  [ veta_neizo ] is better ) .",
    "note that by the reduction to counting planar maps , for every fixed constant @xmath101 , we also obtain the upper bound @xmath732 on the number of isomorphism classes of connected topological graphs with @xmath4 edges where all pairs of edges are allowed to cross @xmath101 times .",
    "in this section we present constructions of many pairwise different simple drawings of a given graph @xmath1 , proving the lower bounds in theorem  [ veta_neizo ] and  [ veta_hlavni ] .",
    "since we are dealing with arbitrary graphs , we use the following tool to find large subgraphs with more `` regular '' structure .",
    "let @xmath1 be a graph and let @xmath733 be disjoint subsets of its vertices . by @xmath734 $ ] we denote the bipartite graph @xmath735 consisting of all edges with one endpoint in @xmath736 and the other endpoint in @xmath737 .",
    "[ lemma_partitions ] let @xmath738 be positive integers with @xmath739 and @xmath740 .",
    "let @xmath2 be a graph with vertex set @xmath741 and with @xmath742 edges .",
    "let @xmath469 be a graph with @xmath3 vertices and @xmath4 edges .",
    "there is a partition of the vertex set @xmath440 into @xmath743 clusters @xmath744 such that for every edge @xmath745 of @xmath2 the number of edges in the bipartite graph @xmath746 $ ] is at least @xmath747    this is a variant of the result by khn and osthus  ( * ? ? ?",
    "* theorem 3 ) , who consider the case of @xmath748 and assume that @xmath1 has maximum degree bounded by a constant fraction of @xmath3 .",
    "the proof of lemma  [ lemma_partitions ] is similar to that of theorem 3 in  @xcite .",
    "the main idea is to use the second order method to analyze the random partition .    during the analysis we need to bound the number of pairs of adjacent edges in a graph @xmath1 , which we denote by @xmath749 .",
    "let @xmath750 be the class of all graphs with @xmath3 vertices and @xmath4 edges and let @xmath751 be the maximum of @xmath749 over all @xmath752 .",
    "ahlswede and katona  @xcite proved that the maximum of @xmath749 is always attained for at least one of two special graphs in @xmath750 , a _ quasi - star _ or a _ quasi - clique_. brego et al .",
    "@xcite completely characterized all graphs @xmath752 for which @xmath753 .",
    "the problem of computing @xmath751 has been studied and partially solved by many researches ; see  @xcite or  @xcite for an overview of previous results .",
    "although all the values of @xmath751 have been computed , the behavior of the function depends on certain nontrivial number - theoretic properties of the parameters @xmath754  @xcite .",
    "nikiforov  @xcite proved tight asymptotic upper bounds on @xmath751 , which may be stated in a simplified form as follows .",
    "[ lemma_pocet_dvojic_sharp ]  ( * ? ? ? * theorem 2 ) for all @xmath3 and @xmath4 , @xmath755    we use a weaker , even more simplified asymptotic upper bound , which is easier to apply . for our purposes ,",
    "we need the bound to be tight only for small values of @xmath4 .",
    "[ cor_pocet_dvojic_approximation ] for all @xmath3 and @xmath4 , @xmath756    if @xmath757 , then by lemma  [ lemma_pocet_dvojic_sharp ] we have @xmath758 if @xmath759 , then by lemma  [ lemma_pocet_dvojic_sharp ] , the desired upper bound is equivalent to the inequality @xmath760",
    "using the inequality @xmath761 , which holds for @xmath762 , we have @xmath763 @xmath764    let @xmath765 be a random partition of the vertex set @xmath440 , where each vertex is assigned independently to cluster @xmath766 with probability @xmath767 .",
    "for @xmath768 , let @xmath769 be a random variable counting the number of edges in the bipartite graph @xmath746 $ ] . clearly , we have @xmath770 .",
    "let @xmath771 .    by chebyshev s inequality",
    "@xmath772 it follows that there is a partition @xmath765 such that for every edge @xmath745 of @xmath2 , the graph @xmath746 $ ] has at least @xmath773 edges .    to complete the proof , we need to estimate @xmath774 from above .",
    "let @xmath775 for some @xmath768 .",
    "we have    @xmath776    for every edge @xmath456 of @xmath1 , let @xmath777 be the indicator variable of the event that @xmath456 has one endpoint in @xmath766 and the other endpoint in @xmath778 .",
    "clearly , @xmath779 .",
    "recall that @xmath749 denotes the number of pairs of adjacent edges in @xmath1 .",
    "we have    @xmath780    by corollary  [ cor_pocet_dvojic_approximation ] , @xmath781 .",
    "hence ,    @xmath782    and the lemma follows .      the construction giving the first lower bound in theorem  [ veta_neizo ] generalizes the construction from  @xcite .",
    "let @xmath29 and let @xmath469 be a graph with @xmath3 vertices and @xmath4 edges .",
    "we apply lemma  [ lemma_partitions ] with @xmath783 , @xmath784 and @xmath785 . if @xmath786 , then lemma  [ lemma_partitions ] implies that there is a partition of @xmath440 into six clusters @xmath787 such that each of the three subgraphs @xmath788,g[v_2,v_5],g[v_3,v_6]$ ] has @xmath789 edges .",
    "we may assume that @xmath790 $ ] has the least number of edges of these three graphs .",
    "like in  @xcite , we construct @xmath11 drawings of @xmath1 that are all weakly isomorphic to the same geometric graph with vertices in convex position . for each @xmath791",
    ", we place the vertices of the set @xmath792 on the unit circle , inside a small neighborhood of the point @xmath793 ; see figure  [ obr_13_neizo_mrizka ] , left . for every pair of vertices @xmath794 and @xmath795 such that @xmath796",
    ", we draw the edge @xmath797 as a straight - line segment . for @xmath798",
    ", the edges between the sets @xmath792 and @xmath799 are drawn inside a narrow rectangle @xmath800 such that all the crossings among this group of edges occur outside the region @xmath801 , and for @xmath802 , @xmath803 , all the crossings between the edges of g@xmath804 $ ] and g@xmath805 $ ] lie inside @xmath692 . in the region @xmath692 ,",
    "the edges connecting @xmath806 with @xmath807 form @xmath789 parallel curves .",
    "together with the edges connecting @xmath808 with @xmath809 , they form an @xmath810 grid inside @xmath692 .",
    "we partition the crossings of this grid into @xmath789 parallel diagonals forming horizontal rows .",
    "each ( horizontal ) edge @xmath456 connecting @xmath811 with @xmath812 is drawn along one of the diagonal @xmath813 . each edge is assigned to a different diagonal . in the neighborhood of each crossing @xmath54 in @xmath813",
    "we can decide whether the edge @xmath456 passes above or below @xmath54 ; see figure  [ obr_13_neizo_mrizka ] , right .",
    "these two possibilities give us two nonisomorphic topological graphs , and the choices can be made independently at each crossing of the grid . since we make the choice at @xmath814 crossings , we obtain @xmath11 pairwise nonisomorphic drawings of @xmath1 .    for graphs with superlinear number of edges , lemma  [ lemma_partitions ]",
    "gives a partition where each of the graphs @xmath746 $ ] has @xmath815 edges . in the previous construction , this gives a grid with @xmath816 crossings and hence @xmath817 pairwise nonisomorphic drawings of @xmath1 , since @xmath818 of the crossings can be covered by @xmath54 parallel diagonals . for @xmath783 , this gives the lower bound @xmath819 .",
    "the constant @xmath820 can be easily improved .",
    "previous construction used as a `` template '' a convex geometric drawing of @xmath821 .",
    "this topological graph has one _ free triangle _ , that is , a triangular face bounded by three pairwise crossing edges .",
    "a free triangle may be _ switched _ by moving a portion of one of the boundary edges over the crossing of the other two edges .",
    "this feature is then amplified by replacing the free triangle by the grid construction .",
    "a set of @xmath101 free triangles is _ independent _ if no two of the triangles share a vertex .",
    "equivalently , every two triangles share at most one boundary edge .",
    "this guarantees that each of the @xmath630 combinations of switched triangles is possible .",
    "there are simple drawings of @xmath821 with two independent free triangles  @xcite .",
    "if we use one of them as a template , we get @xmath822 pairwise nonisomorphic drawings of @xmath1 .    using larger simple complete topological graphs as templates ,",
    "much better lower bounds can be obtained . instead of free triangles",
    ", we may consider , in general , _",
    "free @xmath101-tuples _ , which consist of @xmath101 pairwise crossing edges with all @xmath823 crossings close to each other , forming locally an arrangement of @xmath101 pseudolines .",
    "a system of free @xmath101-tuples is _ independent _ if no two @xmath101-tuples share a crossing .    when replacing a free @xmath96-tuple by the grid construction , we use both horizontal and vertical diagonals of the grid .",
    "after drawing the horizontal and vertical edges along the diagonals , half of the crossings in the grid become free @xmath96-tuples and the other half free triangles .",
    "every free @xmath96-tuple can be drawn in @xmath317 different ways .",
    "therefore , by replacing each of the original four edges by @xmath54 parallel edges , we obtain @xmath824 pairwise nonisomorphic drawings .",
    "that is , every free @xmath96-tuple in the template with @xmath743 vertices contributes @xmath825 to the exponent in the lower bound on @xmath49 .",
    "for example , the regular convex drawing of @xmath826 on figure  [ obr_14_k10 ] has , after small perturbation , one free @xmath164-tuple , @xmath164 free @xmath96-tuples and @xmath161 free triangles , all independent . using this drawing as a template",
    ", we obtain the lower bound @xmath827 ( for simplicity , we estimate the contribution of the free @xmath164-tuple by the contribution of a free @xmath96-tuple ) .",
    "further improvement can be obtained using all possible partial arrangements of three pairwise crossing systems of parallel pseudolines , in place of the grid construction , which produces only a subset of all such arrangements .",
    "felsner and valtr  @xcite proved that there are @xmath828 partial arrangements of @xmath829 pseudolines that form three pairwise crossing subsets of @xmath3 parallel pseudolines .",
    "they observed that these partial arrangements are dual to rhombic tilings of a regular hexagon and used macmahon s formula enumerating these tilings .",
    "this also implies the rough lower bound @xmath830 on the number of partial arrangements of @xmath831 pseudolines that form four pairwise crossing subsets of @xmath3 parallel pseudolines . using these estimates with the template from figure  [ obr_14_k10 ]",
    ", we obtain the lower bound @xmath832 .",
    "this lower bound on @xmath49 is very likely far from being optimal .",
    "however , it is probably hard to close the gap between the lower and upper bound on @xmath49 , given that even for pseudoline arrangements , the best known lower and upper bounds on their number differ significantly  @xcite .",
    "fix @xmath29 and let @xmath1 be a graph with @xmath3 vertices and @xmath4 edges , with no isolated vertices , and satisfying at least one of the conditions @xmath30 or @xmath31 .      first we show that @xmath833 for graphs with @xmath834 , generalizing a construction by pach and tth  @xcite .    without loss of generality",
    "assume that @xmath3 is odd .",
    "let @xmath238 be a random subset of @xmath835 vertices of @xmath1 .",
    "the expected number of edges in the induced graph @xmath836 $ ] is @xmath837 let @xmath838 be a subset of @xmath835 vertices inducing at least @xmath839 edges .",
    "every graph with @xmath4 edges has a bipartite subgraph with at least @xmath840 edges .",
    "let @xmath841 be a bipartition such that the bipartite graph @xmath842 $ ] has at least @xmath843 edges .",
    "we place the vertices of @xmath440 on three parallel vertical lines as follows .",
    "the vertices of @xmath844 are placed on the @xmath845-axis to the points @xmath846 , @xmath847 , the vertices of @xmath363 to the points @xmath848 , @xmath849 , and the vertices of @xmath850 to the points @xmath851 .",
    "observe that the midpoint of every straight - line segment with one endpoint in @xmath363 and the other endpoint in @xmath850 lies in @xmath852 .",
    "the idea of obtaining exponentially many pairwise different drawings of @xmath1 is now similar as in the grid construction in the previous subsection . the edges of @xmath853",
    "$ ] are drawn as arcs close to the @xmath845-axis .",
    "every edge @xmath854 of @xmath842 $ ] is drawn as an arc along the straight - line segment @xmath855 , in one of two possible ways : either close above or close below the segment .",
    "see figure  [ obr_15_dolni ] .",
    "let @xmath856 be the midpoint of @xmath855 . if @xmath856 is adjacent to a vertex @xmath857 , then in one of the two drawings the edges @xmath855 and @xmath858 cross and in the other one they are disjoint .",
    "since the minimum degree in @xmath1 is at least @xmath45 , for every @xmath859 , there is at most one pair of vertices @xmath860 and @xmath861 such that @xmath856 is a midpoint of the segment @xmath855 and @xmath856 is not adjacent to @xmath862 .",
    "this implies that for at least @xmath863 edges of @xmath842 $ ] , the two choices produce two weakly nonisomorphic drawings . since the choices for all the edges are independent , this gives @xmath864 pairwise weakly nonisomorphic drawings of @xmath1 in total .",
    "the lower bound on @xmath22 can be improved for sparse graphs with minimum degree at least @xmath45 that have at least @xmath865 edges or maximum degree at most @xmath866 .",
    "such assumptions are needed to guarantee a nontrivial number of pairs of independent edges , to avoid graphs like stars , which can only be drawn without crossings .",
    "for every such graph @xmath1 we show the lower bound @xmath867 . moreover , all the drawings in this construction are _ geometric graphs _ ; that is , the edges are drawn as straight - line segments .",
    "[ lemma_les_bipartitni ] let @xmath1 be a graph with @xmath3 vertices , @xmath4 edges , no isolated vertices and satisfying @xmath30 or @xmath31 .",
    "then the vertex set of @xmath1 can be partitioned into three parts @xmath868 such that @xmath869 , every vertex from @xmath808 has a neighbor in @xmath806 and the induced graph @xmath870 $ ] has at least @xmath871 edges .",
    "we distinguish two cases .",
    "* case 1 : * @xmath1 has a spanning forest @xmath578 with no isolated vertices such that its components can be partitioned into two subforests @xmath872 and @xmath873 , each with at least @xmath874 vertices .",
    "assume that @xmath875 .",
    "we set @xmath876 .",
    "now @xmath808 and @xmath806 are defined as the color classes of a proper @xmath80-coloring of @xmath872 , with @xmath877 .",
    "* case 2 : * no spanning forest as in case 1 exists .",
    "let @xmath578 be a spanning forest with no isolated vertices and maximum possible number of components .",
    "if some of the components has a path of length three as a subgraph , then by removing the middle edge of the path , the tree splits into two smaller nontrivial components , contradicting the choice of @xmath578 .",
    "it follows that every component of @xmath578 is a star , that is , a graph isomorphic to @xmath878 for some @xmath879 .",
    "let @xmath880 be the largest component in @xmath578 .",
    "by the assumption , @xmath880 is a star with more than @xmath881 vertices .",
    "in particular , @xmath882 .",
    "hence we have @xmath30 .",
    "this means that @xmath1 has more than @xmath883 edges that do not belong to @xmath880 .",
    "let @xmath811 be the set of vertices spanned by @xmath871 such edges , together with all vertices that do not belong to @xmath880 . finally , we set @xmath806 to be the one - element set containing the central vertex of @xmath880 and @xmath884 .",
    "let @xmath885 be the partition from lemma  [ lemma_les_bipartitni ] .",
    "let @xmath2 be a bipartite subgraph of @xmath870 $ ] with at least @xmath886 edges .",
    "split the set @xmath811 into two parts according to the bipartition of @xmath2 and place all vertices from one part in a small disc with center @xmath887 and radius @xmath888 and all vertices from the second part in a small disc with center @xmath889 and radius @xmath742 , so that the vertices are in general position .",
    "draw all edges of @xmath870 $ ] as straight - line segments .",
    "see figure  [ obr_16_dolni2 ] .",
    "there are two lines @xmath890 , @xmath891 parallel to the @xmath845-axis going through points @xmath892 and @xmath893 , respectively , such that @xmath894 and no two edges of @xmath870 $ ] cross between @xmath890 and @xmath891 . in particular , the edges of @xmath870 $ ] split the vertical strip @xmath579 between @xmath890 and @xmath891 into at least @xmath895 regions .",
    "place all vertices of @xmath806 inside @xmath579 above the horizontal line with @xmath845-coordinate @xmath742 , and each of the vertices of @xmath808 in one of the @xmath895 regions of @xmath579 , so that all vertices are in general position .",
    "draw all the remaining edges as straight - line segments .",
    "the choice of the region for each vertex @xmath69 of @xmath808 determines how many edges from @xmath2 an edge connecting @xmath69 with @xmath806 crosses . in total",
    ", this gives @xmath896 pairwise weakly nonisomorphic geometric drawings of @xmath1 .",
    "a _ geometric graph _ is a topological graph where edges are drawn as straight - line segments .",
    "it is also usually assumed that the vertices are in general position , that is , no three of them lie on a line",
    ".    for geometric graphs , asymptotically matching lower and upper bounds on both the number of isomorphism and weak isomorphism classes can be easily derived from known results .",
    "it is easy to see that there are at least @xmath897 weak isomorphism classes of complete geometric graphs with @xmath3 vertices , even when we drop the labels of vertices : place a set @xmath736 of @xmath452 points in convex position , draw the complete geometric graph on @xmath736 and distribute the remaining @xmath452 points in the @xmath898 bounded faces of @xmath736 .",
    "the number of edges here is not crucial : the same asymptotic lower bound is known for matchings on @xmath3 vertices ( see the remark after theorem  [ veta_pseudosegmenty ] in the introduction ) .    for every given abstract graph @xmath1 with @xmath3 vertices",
    ", there are at most @xmath899 isomorphism classes of geometric graphs realizing @xmath1 .",
    "this follows from the upper bound on the number of sign patterns  @xcite ; see also  ( * ? ? ?",
    "* theorem 6.2.1 ) .",
    "the reduction proceeds as follows .",
    "we define @xmath527 variables as the @xmath527 coordinates of the @xmath3 vertices .",
    "every condition of the form `` segments @xmath900 and @xmath797 cross '' , `` point @xmath453 is to the left of the ray @xmath797 '' ,  the crossing of @xmath900 with @xmath797 is closer to @xmath453 than the crossing of @xmath900 with @xmath901 \" , or `` vertices @xmath902 are seen from @xmath903 in clockwise order '' , is then expressed in a straightforward way by inequalities of quadratic polynomials in the @xmath527 variables . then the theorem on the number of sign patterns is applied .    by the combinatorial definition of isomorphism in subsection  [ sub_5_1_combinatorial_izomorphism ] , this proves the upper bound for topologically connected geometric graphs . by the reduction in subsection",
    "[ sub_5_2_topologically_connected ] , the upper bound holds also for general geometric graphs .",
    "the problem of counting the asymptotic number of `` nonequivalent '' simple drawings of a graph in the plane has been answered only partially .",
    "many open questions remain .",
    "the gap between the lower and upper bounds on @xmath904 proved in theorem  [ veta_hlavni ] is wide open , especially for graphs with low density . for graphs with @xmath905 edges ,",
    "the lower and upper bounds on @xmath906 differ by a logarithmic factor .",
    "we conjecture that the correct answer is closer to the lower bound .",
    "we do not even know whether @xmath904 is a monotone function with respect to the subgraph relation , since there are simple topological graphs that can not be extended to simple complete topological graphs .",
    "see figure  [ obr_8 ] , left , for an example .",
    "due to somewhat `` rigid '' properties of simple complete topological graphs , we have a much better upper bound for the complete graph than , say , for the complete bipartite graph on the same number of vertices .",
    "does the complete graph @xmath24 maximize the value @xmath471 among the graphs @xmath1 with @xmath3 vertices ? more generally , is it true that @xmath907 if @xmath908 ?    our methods for proving upper bounds on the number of weak isomorphism classes of simple topological graphs do not generalize to the case of topological graphs with two crossings per pair of edges allowed .    what is the number of weak isomorphism classes of drawings of a graph @xmath1 where every two independent edges are allowed to cross at most twice and every two adjacent edges at most once ?    for the complete graph with @xmath3 vertices , pach and tth  @xcite proved the lower bound @xmath242 and the upper bound @xmath909 .",
    "a nontrivial lower bound can be proved also in the case when @xmath1 is a matching .",
    "ackerman et al .  @xcite constructed a system of @xmath3 @xmath453-monotone curves where every pair of curves intersect in at most one point where they either cross or touch , with @xmath910 pairs of touching curves .",
    "eyal ackerman ( personal communication ) noted that this also follows from an earlier result by pach and sharir  @xcite , who constructed an arrangement of @xmath3 segments with @xmath910 vertically visible pairs of disjoint segments . by changing the drawing in the neighborhood of every touching point",
    ", we obtain @xmath911 different intersection graphs of @xmath80-intersecting curves , also called _ string graphs of rank @xmath80 _  @xcite .",
    "this improves the trivial lower bound observed by pach and tth  @xcite .    in section  [ section_uplne ]",
    ", we proved that certain patterns are forbidden in the rotation systems of simple complete topological graphs , or more generally , in good abstract rotation systems .",
    "the problem of counting topological graphs was thus reduced to a combinatorial problem of counting permutations with forbidden patterns , by the recursion in subsection  [ sub_dukaz_vety_uplne ] .",
    "a general problem of this type can be formulated as follows .",
    "given a constant @xmath199 and a collection @xmath912 of sets of @xmath199-element permutation patterns , we say that a set @xmath913 of permutations on @xmath3 elements is _ @xmath914-restricted _ if for each @xmath199-tuple @xmath915 of positions , there is an @xmath916 such that for every permutation @xmath917 , all permutations from @xmath918 are forbidden as restrictions of @xmath919 at @xmath557 .",
    "what is the maximum size of an @xmath914-restricted set @xmath913 of permutations on @xmath3 elements ?",
    "for example , in the special case of the stanley - wilf conjecture , the collection @xmath914 consists of a single one - element set .",
    "a set of permutations with vc - dimension at most @xmath101 is an @xmath914-restricted set where the collection @xmath914 consists of @xmath920 one - element sets , each containing a different permutation of @xmath921 .    in subsection  [ sub_dukaz_vety_uplne ]",
    ", we reduced the upper bound in theorem  [ veta_uplne ] to the upper bound on the size of an @xmath914-restricted set where @xmath914 consists of the following @xmath922 sets . for every set @xmath923 of five positions",
    ", the collection @xmath914 contains a set @xmath924 of all permutations of @xmath199 elements whose restriction to @xmath736 is @xmath151 or some of its four cyclic shifts , and a set @xmath925 of all permutations of @xmath199 elements whose restriction to @xmath736 is @xmath926 or some of its four cyclic shifts .",
    "similarly , for every set @xmath927 of six positions , the collection @xmath914 contains a set @xmath928 of all permutations of @xmath199 elements whose restriction to @xmath737 is @xmath929 or some of its five cyclic shifts , and a set @xmath930 of all permutations of @xmath199 elements whose restriction to @xmath737 is @xmath931 or some of its five cyclic shifts .",
    "this follows from lemma  [ lemma_c5 ] , [ lemma_t6 ] and from the proof of theorem  [ theorem_cm1_or_tm2 ] , where the canonical linear ordering of the vertices of the unavoidable convex or twisted graphs is consistent with the linear ordering of the vertices of the given simple complete topological graph .",
    "such @xmath914-restricted sets of permutations are a special case of sets with vc - dimension smaller than @xmath199 , which can have superexponential size  @xcite , and generalize the sets with a single forbidden permutation pattern , for which a single exponential upper bound on their size is known  @xcite",
    ". therefore one might ask for which collections @xmath914 it is true that @xmath914-restricted sets of permutations have only exponential size .    a positive answer to the following problem",
    "would improve the upper bound in theorem  [ veta_uplne ] to @xmath932 , which would be asymptotically optimal .",
    "[ problem_permutacni ] let @xmath933 be a constant positive integer .",
    "let @xmath913 be a set of permutations of @xmath3 elements such that for every @xmath199-tuple @xmath557 of positions , there is either a @xmath164-tuple @xmath934 such that the pattern @xmath926 and all its cyclic shifts are forbidden as restrictions at @xmath736 , or a @xmath164-tuple @xmath935 such that the pattern @xmath151 and all its cyclic shifts are forbidden as restrictions at @xmath936 , or a @xmath150-tuple @xmath937 such that @xmath929 and all its cyclic shifts are forbidden as restrictions at @xmath737 , or a @xmath150-tuple @xmath938 such that @xmath931 and all its cyclic shifts are forbidden as restrictions at @xmath939 .",
    "is it true that @xmath940 ?    for @xmath941 and @xmath942 , a construction in  @xcite shows an @xmath914-restricted set of permutations of superexponential size .",
    "such a construction does not necessarily satisfy the conditions in problem  [ problem_permutacni ] since , for example , the pattern @xmath943 is a restriction of just one cyclic shift of @xmath929 , one cyclic shift of @xmath931 and of no cyclic shift of either @xmath926 or @xmath151 . on the other hand ,",
    "this construction does give a superexponential lower bound on the size of sets of permutations satisfying the restrictions implied by lemma  [ lemma_abstract_c7 ] and lemma  [ lemma_abstract_t816 ] , which appear in the proof of the combinatorial theorem  [ veta_kombinatoricka ] .",
    "this follows from the fact that every cyclic shift of the inverse of @xmath944 contains both patterns @xmath945 and @xmath943 .",
    "therefore , a positive solution to problem  [ problem_good ] will require a different approach .",
    "the author thanks josef cibulka for discussions about enumerating various combinatorial objects .",
    "b. m. brego , s. fernndez - merchant , m. g. neubauer and w. watkins , sum of squares of degrees in a graph , _ jipam .",
    "journal of inequalities in pure and applied mathematics _",
    "* 10*(3 ) ( 2009 ) , article 64 , 34 pp .",
    "h. harborth and i. mengersen , drawings of the complete graph with maximum number of crossings , _ proceedings of the twenty - third southeastern international conference on combinatorics , graph theory , and computing ( boca raton , fl , 1992 ) _ , _ congressus numerantium _ * 88 * ( 1992 ) , 225228 ."
  ],
  "abstract_text": [
    "<S> a _ simple topological graph _ </S>",
    "<S> @xmath0 is a drawing of a graph in the plane where every two edges have at most one common point ( an endpoint or a crossing ) and no three edges pass through a single crossing . </S>",
    "<S> topological graphs @xmath1 and @xmath2 are _ isomorphic _ if @xmath2 can be obtained from @xmath1 by a homeomorphism of the sphere , and _ weakly isomorphic _ if @xmath1 and @xmath2 have the same set of pairs of crossing edges .    </S>",
    "<S> we generalize results of pach and tth and the author s previous results on counting different drawings of a graph under both notions of isomorphism . </S>",
    "<S> we prove that for every graph @xmath1 with @xmath3 vertices , @xmath4 edges and no isolated vertices the number of weak isomorphism classes of simple topological graphs that realize @xmath1 is at most @xmath5 , and at most @xmath6 if @xmath7 . as a consequence </S>",
    "<S> we obtain a new upper bound @xmath8 on the number of intersection graphs of @xmath3 pseudosegments . </S>",
    "<S> we improve the upper bound on the number of weak isomorphism classes of simple complete topological graphs with @xmath3 vertices to @xmath9 , using an upper bound on the size of a set of permutations with bounded vc - dimension recently proved by cibulka and the author . </S>",
    "<S> we show that the number of isomorphism classes of simple topological graphs that realize @xmath1 is at most @xmath10 and at least @xmath11 for graphs with @xmath12 .    department of applied mathematics and institute for theoretical computer science , + charles university , faculty of mathematics and physics , + malostransk nm .  25 , 118   00 praha 1 , czech republic ; + ` kyncl@kam.mff.cuni.cz ` </S>"
  ]
}