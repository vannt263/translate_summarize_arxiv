{
  "article_text": [
    "new surveys at low and high redshift have provided us with estimates of galaxy spectral energy distributions ( seds ) for an enormous number of galaxies . when comparing populations of galaxies at different redshifts in these surveys , we need to use comparable measurements of the galaxy seds .",
    "however , different surveys use different bandpasses and the restframe wavelengths of these bandpasses necessarily vary with redshift .",
    "we need to be able to handle this heterogeneity in order to make sensible comparisons among all of these new surveys .    in this paper",
    ", we present a method for doing so , by calculating @xmath0-corrections between observed and desired bandpasses .",
    "the @xmath0-correction between a bandpass @xmath2 used to observe a galaxy at redshift @xmath3 and the desired bandpass @xmath4 is defined by the equation ( @xcite ) : @xmath5 where @xmath6 is the bolometric distance modulus calculated from the luminosity distance @xmath7 , and @xmath8 is the absolute magnitude .",
    "the absolute magnitude is defined as the apparent magnitude an object would have if were observed 10 pc away , in bandpass @xmath4 , at rest .",
    "the traditional definition of the @xmath0-correction takes @xmath9 .",
    "however , we note that in practice many surveys do perform @xmath0-corrections from one observed bandpass @xmath2 to another bandpass @xmath4 in the rest frame .",
    "this practice is particularly common when dealing with high redshift observations .",
    "in addition to @xmath0-corrections , this method also provides an interpretation of the data in terms of a physical model which describes the stellar mass and star - formation history of each galaxy .",
    "the method is designed to work well for a wide range of data sets .",
    "it uses photometry and spectroscopy of the sloan digital sky survey ( sdss ; @xcite ) the galaxy evolution explorer ( galex ; @xcite ) in the ultraviolet , and the two - micron all sky survey ( 2mass ; @xcite ) in the near infrared ( nir ) . in addition , at higher redshifts , we use constraints from the deep extragalactic evolutionary probe 2 ( deep2 ; @xcite ) and the great observatories origins deep survey ( goods ; @xcite ) .",
    "these and other data sets provide a huge set of information about galaxy colors and spectra which we can use to help understand their star - formation histories .",
    "we note that some of the algorithmic techniques used here may have applications in other areas of astrophysics .",
    "first , nonnegative matrix factorization ( nmf ; @xcite ) , and the extensions to it we describe here , is a particularly useful variant on principal component analysis .",
    "second , the nonnegative least squares algorithm of @xcite has the virtue of being extremely simple to implement .",
    "these methods may find other applications in image analysis , spectroscopic analysis , and model fitting in astrophysics .",
    "we also release the templates in electronic form as well as an implementation of the methods used to fit the templates to data .",
    "this software kcorrect v4_1 is distributed on the world wide web .",
    "it consists of a core c library which performs most of the complex and computationally intensive tasks , plus an idl library that provides a high - level interface .",
    "this software is an update of two major earlier releases ( v1_16 ; @xcite ; v3_2 ) .",
    "the improvement over the previous version is twofold .",
    "first , we have improved the templates such that they successfully fit galaxies in the restframe uv , as observed by galex , deep2 , and goods .",
    "second , because the templates are now completely model - based , the fits have a physical interpretation in terms of a star - formation history .",
    "the idl library also has a number of new useful functions .    in section",
    "[ algorithm ] , we describe how to find suitable templates , given a set of models and a set of data .",
    "we also describe the data and models used here . in section",
    "[ results ] , we show the results : the best - fit templates and how well they fit the data . in section [ kcorrect ] ,",
    "we describe how to convert our results into an estimate of the @xmath0-correction . in section",
    "[ physical ] , we describe the physical interpretation of the templates and of fits to data . in section [ sdss2bessell ]",
    ", we present some simplified , linear transformations between various bandpasses . in section [ summary ] , we summarize our results . appendix [ nmf ] describes the nmf algorithm .",
    "appendix [ format ] describes the electronic format of our results .    where necessary , we have assumed cosmological parameters @xmath10 , @xmath11 , and @xmath12 @xmath13 km s@xmath14 mpc@xmath14 ( with @xmath15 ) , unless otherwise noted .",
    "all magnitudes are ( unless otherwise noted ) ab - relative . except where noted",
    ", i will always be referring to the version of the kcorrect software labeled v4_1_4 .",
    "from the spectroscopic observations we know that galaxy spectra reside in a low - dimensional subspace . principal component analysis ( pca ) of galaxy spectra , introduced by @xcite and",
    "applied many times since then , demonstrates that most of the variance in the distribution of galaxies in spectral space can be explained using a few templates .",
    "this means that , in the linear space of all possible spectra , galaxies exist in only a small subspace .",
    "therefore , even with very heterogeneous data , we should be able to determine the properties of this subspace .    here",
    "we present an approach to combining heterogeneous data in order to determine the properties of the subspace of galaxy spectra .",
    "rather than taking the model - free approach used by pca , we here restrict the space of possible spectra to those predicted from the high resolution stellar population synthesis model of @xcite and the nebular emission line models of @xcite .",
    "this approach both constrains the problem appropriately and yields a natural theoretical interpretation of the results in terms of star - formation histories .    in a nutshell",
    ", our algorithm does the following . given the observations ( and uncertainties of those observations ) available for each galaxy , it finds the nonnegative linear combination of @xmath16 template star - formation histories which best predict those observations in the @xmath17 sense .",
    "given the entire set of galaxy observations available , it also fits for the @xmath16 template star - formation histories .",
    "the technical name for this algorithm is nonnegative matrix factorization ( nmf ; @xcite ) , and we describe it in detail in appendix [ nmf ] .",
    "note that this problem is not the same as the well - known nonnegative least squares problem , which would fit for the best - fit nonnegative linear combination of templates , but not for the form of the templates themselves .",
    "this approach is similar to pca in that it finds the small spectral subspace in which galaxies exist , and can in some ways be thought of as `` nonnegative pca . ''",
    "however , our method has several advantages over the standard pca approach .",
    "first , the results yield , along with a subspace in the space of all possible spectra , a natural interpretation , which is the corresponding subspace in the space of all possible star - formation histories .",
    "second , it naturally handles data uncertainties and missing data , which allows it to ignore that variation which is due purely to statistical errors .",
    "third , it handles the complications of observing galaxy spectra photometrically using broad - band filters of galaxies at varying redshifts , whereas standard pca requires a constant grid of observations in rest - frame wavelength space .    in the following subsections ,",
    "we introduce the basis set of models we use here (  [ models ] ) , the data we fit to (  [ data ] ) , and how we combine the two to set up the nmf problem (  [ setupnmf ] ) . in appendix [ nmf ]",
    "we describe how to actually solve to nmf problem .",
    "we begin with a basis set of 485 spectral templates . of these , 450 are a set of instantaneous bursts from @xcite , using the @xcite stellar initial mass function and the padova1994 isochrones .",
    "we select 6 metallicities ( 0.005 , 0.02 , 0.2 , 0.4 , 1 , and 2.5 times solar ) . for each metallicity",
    "we select 25 ages ( between 1 myr and 13.75 gyr , spaced almost logarithmically in age ) . for each age and metallicity",
    "we make 3 choices of dust model : ( 1 ) no dust extinction ; ( 2 ) @xmath18 dust with milky way type extinction ( as input into the models of @xcite with a `` homogeneous '' distribution and `` shell '' geometry ) ; ( 3 ) @xmath18 dust with smc type extinction ( from the same models ) .",
    "we smooth each template to @xmath19 km s@xmath14 velocity dispersion ( we will smooth the sdss spectra in the training set to the same resolution ) .",
    "the remaining 35 templates are from mappings - iii ( @xcite ) models of emission from ionized gas .",
    "we choose the predictions for an 8 myr old continuous star - formation history with 5 possible metalliciticites ( 0.5 , 0.2 , 0.4 , 1.0 , and 2 .",
    "times solar ) and 7 possible ionization parameters ( @xmath20 , @xmath21 , @xmath22 , @xmath23 , @xmath24 , @xmath25 , and @xmath26 cm s@xmath14 ) .",
    "we take the spectra ( given as a set of delta functions ) and smooth them to @xmath19 km s@xmath14 velocity dispersion .",
    "the one alteration we make to all of these templates is to remove ly@xmath27 , because it is generally much larger than observed in real galaxies .",
    "let us refer to these 485 basis templates as @xmath28 , expressed in units of ergs s@xmath14 @xmath14 .",
    "we seek to reduce this full basis space to a subspace in which galaxies actually exist .",
    "in particular , we seek five templates @xmath29 built from nonnegative combinations of the original basis set of @xmath16 templates : @xmath30 in units of ergs s@xmath14 @xmath14 . in principle",
    ", we could seek any number of templates ; from our experiments , we have found that five turns out to be a number large enough to explain the data we use here . for each galaxy",
    "@xmath31 we want our model @xmath32 for their spectrum to be a nonegative sum of these five templates : @xmath33      the training set consists of :    1 .",
    "sdss spectroscopic data in the observed range @xmath34  , for 400 luminous red galaxies between @xmath35 ( lrgs ; @xcite ) and 1600 main sample galaxies between @xmath36 ( @xcite ) 2 .",
    "sdss photometric data on an independent set of lrgs ( @xmath37 photometry only ) and main sample galaxies ( using the full @xmath38 photometry ) in the same redshift ranges .",
    "we use 2000 lrgs and 7000 main sample galaxies . for these galaxies",
    "we include 2mass @xmath39 extended source catalog data ( @xcite ) where available .",
    "galex dr1 far uv ( @xmath40  ) and near uv ( @xmath41  ) photometry for main sample sdss galaxies with redshifts and @xmath38 photometry ( 4000 galaxies ; @xcite ) .",
    "4 .   the @xmath42 photometry for high redshift galaxies in the deep2 dr1 release between @xmath43 ( 4000 galaxies ; @xcite ) .",
    "the @xmath44 photometry for goods galaxies between @xmath45 ( 1000 galaxies ; @xcite ) .",
    "the sdss , 2mass , and galex galaxies were selected from and the matches were obtained by the new york university value - added galaxy catalog ( nyu - vagc ; @xcite ) .",
    "the sdss data processing consists of astrometry @xcite ; source identification , deblending and photometry @xcite ; photometricity determination @xcite ; calibration @xcite ; spectroscopic target selection @xcite ; spectroscopic fiber placement @xcite ; and spectroscopic data reduction .",
    "we recalibrated our photometry using the `` ubercalibration '' procedure described in @xcite .",
    "descriptions of these pipelines also exist in @xcite .",
    "an automated pipeline called idlspec2d ( in this case v4_9 ) measures the redshifts and classifies the reduced spectra ( schlegel et al . , in preparation ) .",
    "we use the petrosian magnitudes for the sdss data ( except where noted below for the lrg - only sample ) .    for the galex and goods data we use `` auto '' magnitudes , which are the kron - like magnitudes from sextractor ( @xcite ) . for 2mass",
    "we use the `` extrapolated '' magnitudes from the extended source catalog ( @xcite ) .    note that there are 20 different broadband photometric filters listed above ( @xmath46 in deep2 is different than the @xmath46 used by goods ) . the kcorrect product described in section [ summary ]",
    "contains a tabulation of the response functions for all of these filters .",
    "the data consist of spectra and bandband photometric measurements of galaxies at a number of redshifts , and we have to relate the models to these measurements .    for the spectra , we take the observed spectrum @xmath47 ( in ergs @xmath48 s@xmath14 @xmath14 ) of each galaxy @xmath31 at redshift @xmath3 ( corresponding to a luminosity distance @xmath49 in cm ; see @xcite ) and calculate the restframe luminosity per unit wavelength : @xmath50(1+z ) ( 4 \\pi d_l^2),\\ ] ] that is , the spectrum is shifted due to the redshift , while the integral of the numerator over wavelength ( the total luminosity ) is constant with redshift , and the total flux is related to the total luminosity by the inverse square law . in addition , we smooth each spectrum by such an amount that , given its estimated velocity dispersion , its total velocity dispersion after smoothing is 300 km s@xmath14 ( there are a small number of galaxies with larger velocity dispersions , which we leave unchanged ) .    note that if we discretize the spectra to wavelengths @xmath51 , the relationship between the predicted sed for a galaxy @xmath31 and the basis set @xmath52 , becomes simply : @xmath53    if one has a spectrum for a galaxy the expression for the contribution to @xmath17 from each wavelength @xmath51 in the spectrum is then quite simple : @xmath54 ^ 2 \\cr & = & \\left[\\frac{f_{k}(\\lambda_l ) - \\sum_{ij } a_{ki } b_{ij } m_{jl } } { \\sigma^2_k(\\lambda_l)}\\right]^2 . \\end{aligned}\\ ] ]    comparing observed broadband flux measurements is a bit more complicated , because it is a projection of the spectrum onto the broadband filter @xmath55 at the observed redshift @xmath3 . instead of adjusting the observed fluxes",
    "as we could so easily do for the spectra above , for the photometry we express the models in terms of predicted broadband fluxes at each redshift .    here",
    "we express the flux for each galaxy @xmath31 in units of ab maggies @xmath56 , which are defined as what one would measure in bandpass @xmath55 relative to the ab standard source .",
    "for example , if we transform our spectral energy density basis function @xmath28 to a flux density @xmath57 , we can calculate the contribution of that basis function to the predicted maggies as : @xmath58 here , the response function @xmath59 is proportional to the contribution to the detector signal of a photon with wavelength @xmath60 entering the earth s atmosphere ( or entering the telescope for a space telescope ) .",
    "the ab standard source is @xmath61 and @xmath62 jy @xmath63 erg s@xmath14 @xmath48 hz@xmath14 . of course",
    "maggies @xmath64 are related to magnitudes @xmath65 as : @xmath66 such that the ab standard source would ( if it existed ) have @xmath67 and @xmath68 for all bandpasses .    in this context",
    "it is worth noting that many authors ( e.g. @xcite ) tabulate the contribution to the detector signal per _ unit of energy _ in photons of wavelength @xmath60 instead of per _ photon _ with wavelength @xmath60 .",
    "we will refer here to the former quantity as @xmath69 , though in the literature it is often referred to without a prime ( and without any explicit definition ! ) .",
    "clearly @xmath70 , since the higher the frequency of the photon , at a fixed response per unit energy there is a higher response per photon . with this substitution , one can reexpress equation [ maggies ] appropriately in terms of @xmath69 .",
    "generally , though not universally , authors tabulate @xmath69 for bandpasses whose standards were originally calibrated using energy - counting devices rather than photon - counting devices .",
    "however , from the point of view of the analysis of the observations it is irrelevant what the devices used for the standards and the observations are , as long as one calculates @xmath59 and uses equation [ maggies ] .",
    "the prediction for the broadband fluxes from equation [ maggies ] is only for a specific redshift @xmath3 .",
    "it turns out to simplify our mathematics to calculate the projection of each basis function @xmath71 onto each filter @xmath55 for a grid of redshifts ( in this case spaced by 0.005 between redshifts 0 and 2 ) .",
    "thus , below we will take @xmath55 to index all the filters at all such redshifts .    just as before",
    ", we can now write down the relationship between the predicted broadband flux and the basis set @xmath72 , in the bandpass and redshift corresponding to the index @xmath55 , for a galaxy @xmath31 : @xmath73    the contribution to the total @xmath17 of a broadband flux is therefore just : @xmath74 ^ 2 \\cr & = & \\left[\\frac{\\mu_{kp } - \\sum_{ij } a_{ki } b_{ij } \\eta_{jp } } { \\sigma^2_{kp}}\\right]^2 . \\end{aligned}\\ ] ] for a given galaxy we do not have every filter , and we only have an observation of each filter at a single redshift .",
    "we pick the closest redshift on the redshift grid , and use the measured filters at that redshift for our expression of @xmath17 , and set @xmath75 for the rest of the values of the index @xmath55 so that we zero - weight those predictions .",
    "the matrices @xmath76 ( related to the broad - band fluxes ) and @xmath52 ( related to the spectra ) are totally fixed , and we combine them into a single matrix @xmath77 and the indices @xmath55 and @xmath78 into a single index @xmath79 , to handle both the broad - band fluxes and spectra simultaneously .",
    "we can similarly combine our observations @xmath80 and @xmath81 and their uncertainties @xmath82 and @xmath83 into vectors @xmath84 and @xmath85 .",
    "then we can combine the equations [ chi2spec ] and [ chi2photo ] into a single equation : @xmath86 ^ 2\\ ] ] there is a simple method that we describe in appendix [ nmf ] called nonnegative matrix factorization ( nmf ) to iterate to the nonnegative @xmath87 and @xmath88 which locally minimize equation [ chi2 ] .",
    "the basic method is implemented in a public piece of code named nmf_sparse in the idlutils distribution of idl utilities .. as the name implies , our implementation takes advantage of the fact that many of the matrix operations are on very sparse matrices ( for example , for each galaxy with photometric data there are _ no _ spectroscopic data points and _ only _ photometric data at a single redshift ) .    as we describe in appendix [ nmf ] ,",
    "the nmf problem is not convex : that is , there are multiple local minima .",
    "our method finds one of the local minima , but is not guaranteed to find the global minimum .",
    "thus , the reader who tries to reproduce our results using our methods or others may ( depending on their initial conditions ) find different local minima of @xmath17 than do we .",
    "once we have fit for @xmath88 using the training set , we can minimize equation [ chi2 ] for any other galaxy using any nonnegative least squares algorithm to determine @xmath87 ( since the minimization of equation [ chi2 ] has a linear form in that case ) .",
    "when we do so here we use the beautifully simple iterative method of @xcite .",
    "we begin with the simplest case , which is fitting a _ single _ template to the photometric data of the lrg sample ( @xcite ) . for many of these galaxies , which extend to @xmath89 and",
    "are intrinsically red , the @xmath90-band flux is extremely poorly measured , so we ignore the @xmath90-band for all lrgs .",
    "figure [ spec_lrg ] shows the spectrum of the best - fit lrg .",
    "this template is constrained by data between about 2000   and 10000  ; outside that range it is an extrapolation .",
    "figure [ sfh_lrg ] shows the star - formation history corresponding to this best - fit lrg spectrum .",
    "the top panel shows the star - formation per unit time as a function of look - back time .",
    "the bottom panel shows the mean metallicity of the forming stars as a function of time .",
    "when considering these plots and those below , do remember that although these results are our best - fit , the parameters are highly degenerate ( especially in , for example , neighboring age bins ) .",
    "we show these merely to illustrate the general nature of the fits .",
    "figure [ lrg_colors ] shows the lrg colors as a function of redshift , with the best fit template color overplotted as the smooth , thick line . in the code",
    "described in section [ summary ] , we used the routine sdss_kcorrect ( with the optional flag /lrg ) to perform these fits .",
    "the best fit is a good fit to the data .",
    "note that in this example we have fit a nonevolving template , which is inappropriate over this range of redshifts  even if it is a good fit to the colors ! in principle , we can adjust the methods used here for the case of evolving templates , but we will not do so here .    in appendix [ format ]",
    "we describe the form in which we release the star - formation histories and spectra associated with this template .",
    "we next apply the method to the full data set and fit for five templates . from experiments",
    ", we found that we needed five to adequately explain the data .",
    "more than five templates would allow us to explain the data better , but only marginally so .",
    "the right - most column of figure [ sfh_templates ] shows the spectrum from the ultraviolet through the near infrared for the resulting templates .",
    "note that there is a very old template , a very young template , and several intermediate templates , including one which is close to that of an a star .",
    "the left and middle columns of figure [ sfh_templates ] show the star - formation histories and metallicities associated with the templates .",
    "we have not imposed any smoothness criterion on these fits , which explains the ragged appearance of these histories .",
    "the details of these fits are weakly constrained due to degeneracies within and among the templates , but we show them here for completeness .    in all the results below , we use these five templates , unaltered .",
    "that is , when we speak below of `` fitting '' the templates , we mean we fix @xmath88 to the five templates shown in this section and fit only for @xmath87 .",
    "since we have determined these templates to be appropriate for the data sets we include in the training set , they end up providing good fits to most other galaxies from the parent data sets . in general below , the tests we perform are not to the training set but to independent sets of galaxies .    in appendix [ format ]",
    "we describe the form in which we release the star - formation histories and spectra associated with these templates .",
    "these templates explain the photometric data rather well . for example , consider figure [ fullfits ] , showing the color residuals of the observations with respect to the best fits , when fitting to galaxies with galex , sdss , and 2mass data . in this context",
    "we define the color residuals as ( for example ) : @xmath91 = [ u_{\\mathrm{obs}}- g_{\\mathrm{obs } } ] - [ u_{\\mathrm{model}}- g_{\\mathrm{model } } ] .\\ ] ] in the code described in section [ summary ] , we used the routine gst_kcorrect to perform these fits . in figure [ fullfits ]",
    "the thick dashed lines show the estimated 1@xmath92 uncertainties in the colors from the photometric catalogs .",
    "relative to the uncertainties , there are no significant biases or redshift trends in these fits .",
    "note that the galaxies used in this test are distinct from the training set on which we fit the five templates .",
    "the templates do well on higher redshift data , as well . for example , figure [ goods ] shows the color residuals for goods data . here",
    "we find that there are somewhat larger residuals with respect to the uncertainties ( again shown as the thick dashed lines ) .",
    "we can compare this result to that in figure [ goods_special ] , which we get by fitting a new set of templates to _ only _ the goods data ( this alternate set of five templates is also distributed in the manner that appendix [ format ] describes ) . from figure [ goods_special ] , we conclude that _ some _ of the errors are irreducible , and require either a larger set of templates for high redshift galaxies ( a possibility we find a priori unlikely ) , or that there are simply errors in the catalogs or the input filter curves . for example , in the @xmath3 and @xmath93 bands we find significant trends between redshifts @xmath94 and @xmath95 ( echoed in figure [ goods ] ) .",
    "more significantly , in the @xmath96 band there is at least a 10% offset in the magnitudes across all redshifts , which is almost certainly a catalog or filter curve error .",
    "other errors ( such as a large scatter in the residuals in the @xmath46 band and some redshift dependence in the @xmath97 band ) are clearly due to the fact that the templates are not primarily designed for goods data .",
    "all in all , we recommend using the special templates for @xmath0-corrections within the goods data set",
    ".    we can also test how well these templates recover actual spectra given only photometry . to do so ,",
    "we take eight random sdss spectra ( chosen to span color space ) , project them onto the @xmath98 , @xmath99 and @xmath100 bandpasses , and then fit the five templates to just these three fluxes .",
    "figure [ specfit ] compares the reconstructed model spectra to the original spectrum .",
    "the two agree well in general , though some features ( like the emission lines ) are not reproduced well . naturally , this success is mostly due to the quality of the original stellar spectra used in the population synthesis code of @xcite .",
    "we are not suggesting that @xmath101 photometry contains as much information as the full spectra .",
    "however , these results encourage us that by using broad - band data we can infer @xmath0-corrections of galaxies .",
    "perhaps more interestingly , the templates do a good job of predicting _ missing _ data .",
    "that is , we can ask the question : if we use the templates to fit only to some bands but leave out others , how well do the best fits _ predict _ the bands left out ?",
    "consider figures [ twomass_resid ] and [ twomass_predicted ] .",
    "the former shows the color residuals of _ fitting _ to both sdss and 2mass data for each galaxy .",
    "the latter shows the color residuals when we fit _ only _ to the sdss data and do not include 2mass in the fit at all . without any input from 2mass",
    "the templates do a very good job of predicting the 2mass fluxes , with a scatter of 2030%  not far from the uncertainties in the 2mass fluxes themselves .",
    "of course , it is not surprising that it is easy to predict the 2mass fluxes  stellar spectra are very simple in the nir , so having the @xmath38-band fluxes from sdss yields much information regarding the redder bandpasses .",
    "however , we will note here that this result flies in the face of a persistent insistence that nir observations are necessary to measure stellar masses of galaxies .",
    "if we can predict the nir observations themselves , clearly they can not be adding much to our knowledge of the underlying stellar mass .",
    "this fact changes one s decisions about what data is best to use for calculating the stellar mass function .",
    "basing it on 2mass data only improves slightly the stellar mass estimate of each galaxy , while restricting ( and thus biasing ) the sample significantly at the lowest luminosities and surface brightnesses relative to the sdss .",
    "of course , if at high redshift galaxies have a very different locus of their seds , then perhaps this statement is less true for them .    in addition , consider figures [ galex_resid ] and [ galex_predicted ] .",
    "the former shows the color residuals of _ fitting _ to both sdss and galex data for each galaxy .",
    "the latter shows the color residuals when we fit _ only _ to the sdss data and do not include galex in the fit at all . without any input from galex",
    "the templates do a significantly worse job at predicting the galex fluxes .",
    "the scatter becomes about @xmath102 mag . as is common knowledge",
    ", it is more difficult to predict the uv fluxes , because dust and recent star - formation are so variable among galaxies .",
    "however , the median residuals based on are our templates still near zero .",
    "given a model spectrum for the galaxy , the determination of the @xmath0-correction is straightforward . here",
    "we give the relevant formulae for the @xmath0-corrections , leaving the derivation to @xcite .",
    "then , we show the typical @xmath0-corrections for the data we have fit to .",
    "the @xmath0-correction between a bandpass @xmath2 used to observe a galaxy at redshift @xmath3 and the desired bandpass @xmath4 is defined by the equation ( @xcite ) : @xmath103 where @xmath104 is the bolometric distance modulus calculated from the luminosity distance @xmath7 , and @xmath8 is the absolute magnitude .",
    "the absolute magnitude is defined as the apparent magnitude an object would have if were observed 10 pc away , in bandpass @xmath4 , at rest . the traditional definition of the @xmath0-correction takes @xmath9 .",
    "however , we note that in practice many surveys do perform @xmath0-corrections from one observed bandpass @xmath2 to another bandpass @xmath4 in the rest frame .",
    "this practice is particularly common when dealing with high redshift observations .",
    "in addition to @xmath0-corrections , this method also provides an interpretation of the data in terms of a physical model which describes the stellar mass and star - formation history of each galaxy .    equation ( [ kcorrecteqn ] )",
    "holds if the @xmath0-correction @xmath105 is @xmath106}\\ ,    \\frac{\\displaystyle    \\int\\mathrm{d}{\\lambda_o}\\,{\\lambda_o}\\,l_{\\lambda}\\!\\left(\\frac{{\\lambda_o}}{1+z}\\right)\\,r({\\lambda_o})\\ ,      \\int\\mathrm{d}{\\lambda_e}\\,{\\lambda_e}\\ ,      g^q_{\\lambda}({\\lambda_e})\\,q({\\lambda_e } ) }         { \\displaystyle    \\int\\mathrm{d}{\\lambda_o}\\,{\\lambda_o}\\,g^r_{\\lambda}({\\lambda_o})\\,r({\\lambda_o})\\ ,      \\int\\mathrm{d}{\\lambda_e}\\,{\\lambda_e}\\ ,      l_{\\lambda}({\\lambda_e})\\,q({\\lambda_e } ) } \\right ] \\;\\;\\;.\\ ] ] here , @xmath107 and @xmath108 represent the response of the instrument per unit photon entering the earth s atmosphere ( or the telescope aperture for a space instrument ) .",
    "@xmath109 is the flux density per unit wavelength ( e.g.   ergs s@xmath14 @xmath48 @xmath14 ) for the standard source for band @xmath2 , and similarly for band @xmath4 .",
    "for example , if the magnitudes are ab relative , then these represent the ab standard source , while if they are ab relative then they represent the spectrum of vega .",
    "a particularly common special case is when @xmath110 : @xmath111}\\ ,    \\frac{\\displaystyle    \\int\\mathrm{d}{\\lambda_o}\\,{\\lambda_o}\\,l_{\\lambda}\\!\\left(\\frac{{\\lambda_o}}{1+z}\\right)\\,r({\\lambda_o})\\ , }         { \\displaystyle      \\int\\mathrm{d}{\\lambda_e}\\,{\\lambda_e}\\ ,      l_{\\lambda}({\\lambda_e})\\,r({\\lambda_e } ) } \\right ] \\;\\;\\;.\\ ] ]    for example , consider figures [ galex_kcorrect ] , [ sdss_kcorrect ] and [ twomass_kcorrect ] . for a randomly selected set of galaxies",
    "these figures show the @xmath0-corrections from the observed frame bandpasses of galex , sdss , and 2mass respectively , to the same bandpasses in the rest frame",
    ".    often , it makes sense to @xmath0-correct to a different set of band passes than the rest frame .",
    "for example , the sdss main sample is mostly around @xmath112 , so it does not always make sense to @xmath0-correct from the observed frame @xmath99 band to the rest frame @xmath99 band .",
    "doing so means applying large and uncertain corrections to all galaxies .",
    "if precision is not important , this uncertainty might be worth the simplification it brings .",
    "however , if one is ( say ) interested in the evolution of galaxies , the clustering of galaxies , or something else that requires precision , it makes more sense to avoid introducing unnecessary uncertainty .",
    "our solution to this problem is to correct the magnitude to blue - shifted bandpasses that correspond to the observed bandpass at some intermediate redshift .",
    "we denote these bandpasses @xmath113 , where the blue - shift in this case is by a factor @xmath114 .",
    "for example , in the case of sdss galaxies it makes sense to correct to the @xmath115 bandpass  the @xmath99 band blue - shifted to @xmath112 .",
    "this bandpass has the property that the @xmath0-correction is independent of the sed of the galaxy . if the magnitudes are ab relative , then the @xmath0-correction to @xmath113 for a galaxy at redshift @xmath3 is simply @xmath116 .",
    "figure [ main_kcorrect ] shows the @xmath0-corrections from the @xmath117 $ ] bands to the @xmath118}}}$ ] bands as a function of redshift for sdss galaxies .",
    "note that the @xmath0-corrections converge at @xmath112 , so that around that redshift ( where most galaxies are ) the uncertainties in the @xmath0-corrections are minimized .",
    "compare this simplicity to figure [ sdss_kcorrect ] , where the @xmath0-corrections at redshift @xmath112 in the @xmath98-band range between @xmath119 and @xmath120 ( and in the @xmath90-band from @xmath119 and @xmath121 ) .",
    "most sdss galaxies are near redshift @xmath112 , and obviously the @xmath0-corrections are not perfect  why introduce a large uncertainty for most galaxies when it can easily be avoided ?",
    "in addition to @xmath0-corrections , these template fits also provide physical interpretations of the galaxies , since they correspond to actual stellar population synthesis models .",
    "indeed , the code outputs three parameters relevant to the star - formation history : the current mass of stars in the galaxy ; the stellar mass - to - light ratio of the galaxy ; and the fraction of the total amount of star - formation that has occurred recently .    @xcite have also calculated stellar masses for sdss galaxies .",
    "roughly , they have calculated the @xmath3-band stellar mass - to - light ratios of models which best fit the h@xmath122 absorption and d4000 measurements of the spectra , and then applied those mass - to - light ratios to the observed @xmath3-band luminosities of the imaging .",
    "figure [ mass_to_garching ] shows a galaxy - by - galaxy comparison of their stellar masses @xmath123 relative to our @xmath124 , as a function of @xmath124 and of intrinsic @xmath125 color .",
    "the two sets of masses are very similar to each other , with a scatter of only 0.1 dex and trends of less than 0.2 dex with stellar mass .",
    "to be explicit , the masses in figure [ mass_to_garching ] correspond to the current mass in stars remaining in the galaxy .",
    "this mass can differ from the total star - formation rate integrated over time , due to the fact that stars can die  and in practice for our fits the total integrated star - formation rate is usually about twice as high as the total current mass in stars .",
    "similarly , figure [ mtol ] shows the mass - to - light ratios of sdss galaxies in the @xmath93 band as a function of color in @xmath126 . here",
    ", we have calculated the @xmath46 and @xmath93 band fluxes based on the template fits to each galaxy , as explained in section [ sdss2bessell ] below .",
    "we give the mass - to - light ratio in solar units .",
    "the solid line is the relationship that @xcite give based on their fits to spiral galaxies . for blue galaxies ( @xmath127 ) this line is indeed a good fit to our results . for the typical red galaxy ,",
    "the @xcite relation predicts a larger stellar mass than we do .    finally , we can also calculate measures of the recent star - formation rate from these fits .",
    "since our fits are to broad - band photometry , and not based on emission line measurements , we can not expect to have detailed information about the very recent star - formation rate .",
    "however , we can try to measure what fraction of the total star - formation has occurred in , say , the past 1 gyr : @xmath128 where the definition here is meant to be similar to the birthrate parameter @xmath129 in @xcite and references therein .",
    "note that here @xmath130 is defined in terms of the total integrated star - formation history ( unlike the stellar masses referred to above ) as is standard for the @xmath129 parameter .",
    "figure [ umr_bg ] shows the relationship between the rest - frame @xmath131 color for sdss galaxies and @xmath130 . for galaxies with @xmath132 (",
    "redder than which galaxies are mostly reddened , edge - on disks ) these two parameters follow a simple relationship : @xmath133 note , however , the large scatter ( about 0.3 dex at 1@xmath92 ) .",
    "we do not want to overstate the validity of these physical interpretations .",
    "they are sufficiently good physical interpretations to explain broad band data , but are not uniquely so .",
    "certainly more detailed spectroscopic analysis can provide better constraints on star - formation histories and stellar masses .",
    "one particular weakness for high redshift data is that the templates always assume that there is 14 gyrs of star - formation history .",
    "thus , kcorrect may greatly overestimate the stellar masses of galaxies at @xmath134 ( for example ) , where the actual star - formation history must last only 6 gyrs .",
    "the software and templates that we present here are also useful for determining simple conversions between bandpasses performing other common tasks , such as calculating the absolute magnitude of the sun in various band systems , and calculating the conversion between vega and ab magnitudes . in this section",
    ", we present these tools .",
    "for example , table [ solarmagnitudes ] lists the effective wavelengths , conversion from vega to ab magnitudes , and absolute magnitudes of the sun in a number of filters : the galex filters , the bessell filters , the sdss filters , and the 2mass filters .",
    "the listed numbers are the results of running the idl functions k_lambda_eff , k_vega2ab , and k_solar_magnitudes , respectively , so the reader can calculate the same thing easily on any given filter .",
    "the effective wavelengths listed for each filter use the definition @xmath135,\\ ] ] following @xcite and @xcite . for the spectrum of vega in the conversion of ab to vega magnitudes",
    ", we use the @xcite theoretical vega spectrum ( normalized at 5000   to match the @xcite spectrophotometry of vega ) . in k_vega2ab ,",
    "the user has the option to use the spectrum of @xcite instead .",
    "we use the solar spectrum of @xcite for the calculation of the solar absolute magnitude .    for comparison among results from different surveys ,",
    "one also wants to be able to convert the magnitudes in one set of bandpasses to magnitudes in another set of bandpasses .",
    "an example of doing so is given in our piece of code sdss2bessell , which takes sdss input magnitudes and outputs absolute magnitudes in the bessell @xmath136 , @xmath46 , @xmath93 , @xmath2 and @xmath137 bandpasses .",
    "however , often one wants to just make quick and dirty comparisons , without going through the trouble of running any software . for these purposes",
    ", we provide table [ lineareqs ] , which provides the linear relationships among the same bandpasses as those listed in table [ solarmagnitudes ] . in fact , these relationships are usually good to 0.05 mag or better . note that table [ lineareqs ] refers to ab magnitudes _ throughout _ ; use table [ solarmagnitudes ] to get the relationships to vega magnitudes .",
    "we have here described a method for fitting templates to nearly - arbitrary sets of spectra and broad - band fluxes .",
    "the basic concept is that we can recover a small set of templates ( based on models ) , nonnegative linear combinations of which can explain a much larger set of inhomogeneous observations .",
    "we have applied this method to sdss , galex , 2mass , deep2 , and goods data to come up with a set of templates which are effective for describing all of these data sets .",
    "nonnegative matrix factorization ( nmf ) is an effective way to reduce the dimensionality of any large data set , and has that in common with pca .",
    "it is , in some sense , a `` nonnegative pca . ''",
    "however , at least in the current context the method has several advantages over pca .",
    "first , it has a natural physical interpretation associated with that spectral subspace , which is the corresponding subspace of all possible star - formation histories .",
    "second , it naturally handles data uncertainties and missing data , which allows it to ignore that variation which is due purely to statistical errors .",
    "third , it handles the complications of observing galaxy spectra photometrically using broad - band filters .",
    "we note here that the general nmf method does not _",
    "depend _ on using a model  our `` model '' could just have been a set of top hat functions or gaussians on a wavelength grid . in some situations , such as datasets",
    "for which there are not well - developed theoretical models , this approach could be more appropriate .",
    "we have released our results in the form of a templates and a code base called kcorrect which fits those templates to many types of data ( sdss photometric and spectroscopic data , galex data , goods data , deep2 data , and 2mass data ) .",
    "furthermore , this code returns @xmath0-corrections and a physical interpretation of the photometry .",
    "all of the plots in this paper were created using code in the repository .",
    "the code is available from a web page maintained by one of the authors .",
    "this web page is kept updated on improvements in the code and new developments .",
    "it consists of a c language library , stand - alone c programs , and idl language wrappers around the c library .",
    "thus , one can use the basic templates and fitting code using only a machine with a c compiler .",
    "however , there is significant functionality which is programmed in the ( unfortunately , proprietary ) idl language .",
    "these routines depend on the idlutils library .",
    "the authors would like to thank alison coil , michael cooper , david w. hogg , john moustakas , leonidas moustakas , david schiminovich , risa wechsler , and andrew west for their detailed comments and feedback .",
    "this work was funded by a galex archival program ( 38 ) and an hst archival research grant ( ar-9912 ) .",
    "this publication makes use of data products from the two micron all sky survey , which is a joint project of the university of massachusetts and the infrared processing and analysis center / california institute of technology , funded by the national aeronautics and space administration and the national science foundation .",
    "the galaxy evolution explorer ( galex ) is a nasa small explorer .",
    "the mission was developed in cooperation with the centre national detudes spatiales of france and the korean ministry of science and technology .",
    "deep2 is a collaboration between uc santa cruz and uc berkeley .",
    "funding for the deep2 survey has been provided by nsf grant ast-0071048 and ast-0071198 .",
    "funding for the creation and distribution of the sdss archive has been provided by the alfred p. sloan foundation , the participating institutions , the national aeronautics and space administration , the national science foundation , the u.s .",
    "department of energy , the japanese monbukagakusho , and the max planck society .",
    "the sdss web site is http://www.sdss.org/.    the sdss is managed by the astrophysical research consortium ( arc ) for the participating institutions .",
    "the participating institutions are the university of chicago , fermilab , the institute for advanced study , the japan participation group , the johns hopkins university , los alamos national laboratory , the max - planck - institute for astronomy ( mpia ) , the max - planck - institute for astrophysics ( mpa ) , new mexico state university , princeton university , the united states naval observatory , and the university of washington .    39 natexlab#1#1    , e.  f. & de  jong , r.  s. 2001 , , 550 , 212    , e. & arnouts , s. 1996 , , 117 , 393    , m.  s. 1990 , , 102 , 1181    blanton , m.  r. , brinkmann , j. , csabai , i. , doi , m. , eisenstein , d.  j. , fukugita , m. , gunn , j.  e. , hogg , d.  w. , & schlegel , d.  j. 2003 , , 125 , 2348    , m.  r. , lin , h. , lupton , r.  h. , maley , f.  m. , young , n. , zehavi , i. , & loveday , j. 2003 , , 125 , 2276    , m.  r. et  al .",
    "2005 , , 129 , 2562    bruzual , a.  g. & charlot , s. 2003 , , 344 , 1000    , g. 2003 , , 115 , 763    , m. , wheaton , w.  a. , & megeath , s.  t. 2003 , , 126 , 1090    , a.  j. , szalay , a.  s. , bershady , m.  a. , kinney , a.  l. , & calzetti , d. 1995 , , 110 , 1071    , m. , faber , s.  m. , newman , j. , phillips , a.  c. , ellis , r.  s. , steidel , c.  c. , conselice , c. , coil , a.  l. , finkbeiner , d.  p. , koo , d.  c. , guhathakurta , p. , weiner , b. , schiavon , r. , willmer , c. , kaiser , n. , luppino , g.  a. , wirth , g. , connolly , a. , eisenhardt , p. , cooper , m. , & gerke , b. 2003 , in discoveries and research prospects from 6- to 10-meter - class telescopes ii . edited by guhathakurta , puragra .",
    "proceedings of the spie , volume 4834 , pp .",
    "161 - 172 ( 2003 ) . ,",
    "161172    eisenstein , d.  j. et  al .",
    "2001 , , 122 , 2267    , s.  m. , phillips , a.  c. , kibrick , r.  i. , alcott , b. , allen , s.  l. , burrous , j. , cantrall , t. , clarke , d. , coil , a.  l. , cowley , d.  j. , davis , m. , deich , w.  t.  s. , dietsch , k. , gilmore , d.  k. , harper , c.  a. , hilyard , d.  f. , lewis , j.  p. , mcveigh , m. , newman , j. , osborne , j. , schiavon , r. , stover , r.  j. , tucker , d. , wallace , v. , wei , m. , wirth , g. , & wright , c.  a. 2003 , in instrument design and performance for optical / infrared ground - based telescopes . edited by iye , masanori ; moorwood , alan f. m. proceedings of the spie , volume 4841 , pp .",
    "1657 - 1669 ( 2003 ) . , 16571669    fukugita , m. , ichikawa , t. , gunn , j.  e. , doi , m. , shimasaku , k. , & schneider , d.  p. 1996",
    ", , 111 , 1748    , m. et  al .",
    "2004 , , 600 , l93    , d.  s. 1985 , in iau symp . 111 : calibration of fundamental stellar quantities , vol .",
    "111 , 225249    , d.  w. 1999 , in asp conf .",
    "193 : the hy - redshift universe : galaxy formation and evolution at high redshift , 224+    , d.  w. , finkbeiner , d.  p. , schlegel , d.  j. , & gunn , j.  e. 2001 , , 122 , 2129    hogg , d.  w. et  al .",
    "2002 , , 124 , 646    , t.  h. , chester , t. , cutri , r. , schneider , s. , skrutskie , m. , & huchra , j.  p. 2000 , , 119",
    ", 2498    , g. et  al .",
    "2003 , , 341 , 33    , r.  c. , tamblyn , p. , & congdon , c.  e. 1994 , , 435 , 22    , l.  j. , dopita , m.  a. , sutherland , r.  s. , heisler , c.  a. , & trevena , j. 2001 , , 556 , 121    kurucz , r.  l. 1991 , in precision photometry :  astrophysics of the galaxy , l. davis press , inc .",
    ", 2744    lee , d.  d. & seung , h.  s. 1999 , nature , 401 , 788    lee , d.  d. & seung , h.  s. 2000 , in nips , 556562    lupton , r.  h. , gunn , j.  e. , ivezi , z. , knapp , g.  r. , kent , s. , & yasuda , n. 2001 , in asp conf .",
    "ser .  238 :  astronomical data analysis software and systems x , vol .  10 , 269    martin , d.  c. et  al . 2005 , , 619 , l1    , j.  b. & sandage , a. 1968 , , 154 , 21    pier , j.  r. , munn , j.  a. , hindsley , r.  b. , hennessy , g.  s. , kent , s.  m. , lupton , r.  h. , & ivezi ' c ,  .",
    "2003 , , 125 , 1559    richards , g. et  al .",
    "2002 , , 123 , 2945    , d.  p. , gunn , j.  e. , & hoessel , j.  g. 1983 , , 264 , 337    sha , f. , saul , l. , & lee , d. 2002 , university of pennsylvania , technical report ms - cis-02 - 19    skrutskie , m.  f. et  al .",
    "1997 , in assl vol .",
    "210 : the impact of large scale near - ir sky surveys , 25    smith , j.  a. , tucker , d.  l. , et  al .",
    "2002 , , 123 , 2121    stoughton , c. et  al .",
    "2002 , , 123 , 485    strauss , m.  a. et  al .",
    "2002 , , 124 , 1810    , a.  n. & gordon , k.  d. 2000 , , 528 , 799    york , d. et  al .",
    "2000 , , 120 , 1579",
    "the standard non - negative matrix factorization ( nmf ) problem , as originally posed by @xcite , is to approximate a data matrix @xmath138 ( of size @xmath139 ) as the outer product of two rank-@xmath140 non - negative matrices @xmath141 and @xmath142 .",
    "for example , in this paper , @xmath138 represents the fluxes at @xmath143 different wavelengths for @xmath144 different galaxies , @xmath142 represents a set of @xmath140 templates to build each galaxy from , and @xmath141 represents , for each galaxy , the weights to give each template .",
    "this factorization is similar in spirit to singular value decomposition ( svd ) and principal components analysis ( pca ) but crucially , in nmf , @xmath138 , @xmath141 and @xmath142 are all constrained to have non - negative entries .",
    "this changes the problem fundamentally , since no `` cancellation '' of positive and negative basis functions or coefficients is possible  all approximation interactions are strictly additive .",
    "the goal , as with svd or pca , is to minmize the squared approximation error ( frobenius norm ) : [ eq : nmfcost ] ^2 & = x - wh^2 + & = _ kn ( x_kn- _ i w_kih_in)^2 in their seminal papers , @xcite show that this approximation error in non - increasing under the following very simple multiplicative update rules : [ eq : wupdate ] w_ki&w_ki + [ eq : hupdate ] h_in&h_in @xmath145_{ab}$ ] denotes the @xmath146 element of the matrix valued expression @xmath147 .",
    "@xmath148 is the transpose of matrix @xmath142 .",
    "these rules are remarkable because , although they make finite ( not infinitesimal ) adjustments to the elements of the approximation matrices , they have no step - size parameters and are always guaranteed to reduce the error ( or leave it invariant once they have converged ) .",
    "@xmath17 is in general a `` non - convex '' function of @xmath141 and @xmath142 , meaning we can not guarantee there is only one local minimum .",
    "therefore , the procedure does not necessarily find the global optimum .",
    "but in practice , even with random initialization , these rules seem to converge to good solutions for real data ( at least data like ours ) .",
    "the factorization problem we face in this paper is a slight variation on the basic nmf setup described above .",
    "we wish to approximate @xmath138 by the product @xmath149 , where @xmath150 is a given ( fixed ) basis matrix of size @xmath151 and the optimization is over the matrices @xmath152 ( of size @xmath153 ) and @xmath154 ( of size @xmath155 ) .",
    "all matrices @xmath156 have non - negative entries .",
    "this can be thought of as performing non - negative matrix factorization on the coefficients of an approximation , given a fixed ( non - negative ) basis , described by the columns of @xmath150 .",
    "once again , the objective we wish to minimize is the squared approximation error : ^2 & = x - bm^2 + & = _ kn ( x_kn- _ ij a_kib_ijm_jn)^2 this equation is almost that posed in equation [ chi2 ] . in the case of this paper",
    ", this generalization allows us to express the templates in terms of star - formation histories , but to compare the predicted fluxes for the star - formation histories through the @xmath150 matrix to the observed fluxes @xmath138 .    of course ,",
    "in the very special case where @xmath150 is an invertible matrix , this problem can be transformed into the original nmf problem above by right multiplying the data matrix by @xmath157 . however , in most situations , including ours , @xmath150 has many fewer rows than columns , and as such is far from invertible . fortunately , however , it is possible to derive multiplicative updates for this extended problem which minimze the error directly , even when @xmath150 is not invertible .",
    "first , by thinking of the tensor product @xmath158 as a single non - negative matrix @xmath142 , we can trivially derive a multiplicative update equation for the elements of @xmath152 by using the @xmath141 update provided above : a_kia_ki by lee and seung s original proof , this update is guaranteed ( for any non - negative matrices @xmath138,@xmath150 and @xmath154 ) not to increase the approximation error .",
    "our main algorithmic contribution is to derive a similar update equation for the elements of @xmath154 : [ eq : bupdate ] b_ijb_ij following the technique outlined in @xcite , it can still be shown that the error is nonincreasing under the application of this update .",
    "the proof involves the use of an inequality lemma for symmetric non - negative matrices :    * lemma : * _ for any symmetric matrix @xmath159 having non - negative entries @xmath160 , any vector @xmath161 having non - negative entries @xmath162 , and any vector @xmath163 , _ _ ni y_ny_ip_ni_ni y_n^2 p_ni for the standard nmf problem , we can prove that the approximation error is non - increasing under by using the above lemma to construct a function @xmath164 which is an upper bound on the cost @xmath165 for any non - negative matrix @xmath166 : ^2(w ) & = _ kni w_kiw_kh_inh_n- 2 _ kni w_kix_knh_in+ _",
    "kn x_kn^2 + ( w , z ) & = _ kni w_ki^2 h_inh_n - 2 _ kni w_kix_knh_in+ _",
    "x_kn^2 + ( w , z ) & ^2(w ) w_ki0 , z_ki0 with equality being achieved when @xmath167 .",
    "figure [ lemma ] represents this definition schematically , showing the true @xmath17 function and @xmath168 .",
    "the trick of the method is to define @xmath168 such that it is equal to @xmath17 at @xmath169 , greater than @xmath17 everywhere else , and is easily minimizable .",
    "then one can use the minimum of @xmath168 as the update , and be guaranteed that one s updates do not increase @xmath17 .",
    "the function @xmath168 can be analytically minimized with respect to its first argument : ( w^*,z ) & ( w , z ) w , z + w_ki^ * & = z_ki if we set @xmath167 , this becomes exactly and now we can easily prove the validity of this update rule : ^2(w ) = ( w , w ) ( w^*,w ) ^2(w^ * ) where the first inequality comes from the fact that @xmath170 minimizes @xmath171 with respect to its first argument and the second comes from the fact that @xmath172 is a bound on @xmath173 .",
    "the proof of validity for the update is analogous by symmetry .    to prove the validity of our update for our new problem , we proceed in a similar fashion , using the lemma twice to construct consecutive upper bounds on the cost : ^2(b ) & = _ knijs a_kia_kb_ijb_sm_jnm_sn + & - 2 _ knij x_kna_kib_ijm_jn+ _",
    "kn x_kn^2 + ( b , z , ) & = _ knijs a_kia_kb_ij^2 m_jnm_sn + & - 2 _ knij x_kna_kib_ijm_jn+ _",
    "kn x_kn^2 + ( b , z , ) & ^2(b ) b_ij0 , z_kj0 , _ ij0 with equality being achieved when @xmath174 and @xmath175 .",
    "once again , the bound @xmath168 can be analytically minimized with respect to its first argument : ( b^*,z , ) & ( b , z , ) b , z , + b_ij^ * & = _ ij if we set @xmath174 and @xmath175 , this becomes exactly and we can now prove the validity of this update rule : ^2(b ) = ( b , b , b ) ( b^*,b , b ) ^2(b^ * ) where the first inequality comes from the fact that @xmath176 minimizes @xmath177 with respect to its first argument and the second comes from the fact that @xmath178 is a bound on @xmath179 .",
    "the only condition we require is that the elements of the matrix @xmath180 are all non - negative .",
    "when different entries @xmath181 of the data matrix have different uncertainties , the natural objective function is the weighted approximation error ( which also corresponds to the negative log likelihood under a gaussian noise assumption ) : ^2 = _ kn ( ) ^2    this case can easily be handled since during the update for @xmath141 the elements of @xmath142 are fixed and vice versa and the updates are guaranteed not to increase the cost for any nonnegative matrices . in particular , when updating @xmath141 , we can rewrite the cost function as ^2 = _ kn ( - _ i w_ki)^2 yielding updates of the form : w_kiw_ki ( _ n ) / ( _ mn )    and similarly , when updating @xmath142 , we can rewrite the cost function as ^2 = _ kn ( - _ i h_in)^2 yielding updates of the form : h_inh_in ( _ k ) / ( _ mk )    this argument can be equally applied to our extended model , yielding the final update equations which are actually implemented in the kcorrect code : a_ki&a_ki ( _ jn ) / ( _ mljn ) + b_ij&b_ij ( _ kn ) / ( _ mlkn )",
    "we have fit several different sets of templates that we release with the code , which we denote :      the information about the default set of templates is contained in the file data / templates / k_nmf_derived.default.fits in the kcorrect project .",
    "this file has 25 header and data units ( hdus ) , each listed in table [ derived ] and described in more detail in the paragraphs below .",
    "there are similar files for the lrg1 and goods template sets .    as described in section [ models ] , there are @xmath182 basis spectra , consisting of 450 different instantaneous burst stellar populations ( @xmath183 ages , @xmath184 metallicities , and @xmath185 dust properties ) plus 35 different emission line models .",
    "the templates hdu has the coefficients of the five templates in this basis space .",
    "for each of the five templates , we have the template spectrum spec in units of ergs s@xmath14 @xmath48 @xmath14 per solar mass , as it would be observed at 10 pc distance .",
    "the wavelength grid is in the lambda hdu .",
    "as noted above , the models are smoothed at 300 km s@xmath14 resolution ; the rawspec hdus have the original ( unsmoothed ) models from @xcite .",
    "in addition , we give versions without the emission lines ( with the _ nl suffix ) and without the dust extinction applied ( with the _ nd suffix ) . the actual emission - line - only spectra for each template",
    "are in the lspec hdu .",
    "finally , the multiplicative dust extinction factor for each template spectrum is given in the extinction hdu .",
    "we include the star - formation rate as a function of time in the sfr hdu ( the age grid used is in the ages hdu ) .",
    "the time differential used to quantify this rate is in the dage hdu ; to get the total number of stars formed at each age , multiply sfr by dage .",
    "the average metallicity of the stars formed as a function of time is in the metallicity hdu .",
    "the total mass formed in each template ( in solar masses ) is in the mass hdu  this is actually just unity for each template .",
    "the total surviving stellar mass for each template is in the mremain hdu .",
    "the metallicity in the surviving stars is given in the mets hdu .",
    "the total mass in stars formed in the last 300 myrs is in the m300 hdu , and the total mass formed in the last 1 gyr is in the m1000 hdu .",
    "the properties of the 450 stellar population basis vectors are given in the four hdu : basis_ages , basis_mets , basis_dusts , and basis_mremain . respectively , these give the ages , metallicities , dust properties , and fraction of original stellar mass remaining for each instantaneous burst in the grid .",
    "the dust properties are given in terms of a structure with four elements which refer to the properties in the multiple scattering model of @xcite :    1 .",
    "geometry : the geometry of the dust ( e.g. `` shell '' ) 2 .",
    "dust : the dust extinction curve ( e.g. `` mw '' for milky way extinction and `` smc '' for small magellanic cloud type extinction ) 3 .   structure : structure of the dust distribution ( `` h '' for homogeneous , `` c '' for clumpy ) 4 .",
    "tauv : the amount of dust ( the total optical depth in the @xmath93 band )    rrrrr @xmath136 & 3571 . & 0.79 & 6.35 & 5.55@xmath46 & 4344 . & -0.09 & 5.36 & 5.45@xmath93 & 5456 . & 0.02 & 4.80 & 4.78@xmath2 & 6442 . & 0.21 & 4.61 & 4.41@xmath137 & 7994 .",
    "& 0.45 & 4.52 & 4.07@xmath90 & 3546 .",
    "& 0.91 & 6.38 & 5.47@xmath98 & 4670 . &",
    "-0.08 & 5.12 & 5.20@xmath99 & 6156 . &",
    "0.16 & 4.64 & 4.49@xmath100 & 7472 . & 0.37 & 4.53 & 4.16@xmath3 & 8917 .",
    "& 0.54 & 4.51 & 3.97@xmath97 & 12355 .",
    "& 0.91 & 4.56 & 3.65@xmath96 & 16458 .",
    "& 1.39 & 4.71 & 3.32@xmath186 & 21603 .",
    "& 1.85 & 5.14 & 3.29@xmath187 & 3224 .",
    "& 1.25 & 6.78 & 5.53@xmath188 & 4245 .",
    "& -0.01 & 5.43 & 5.44@xmath115 & 5597 . & 0.04 & 4.76 & 4.71@xmath189 & 6792 . & 0.27 & 4.57 & 4.30@xmath190 & 8107 . & 0.46 & 4.52 & 4.05    lr @xmath191 $ ] & @xmath192 = 0.28 $ ] @xmath193 $ ] & @xmath194 = 0.20 $ ] @xmath195 $ ] & @xmath196 = 0.07 $ ] @xmath197 $ ] & @xmath198 = 0.13 $ ] @xmath199 $ ] & @xmath198 = 0.13 $ ] @xmath200 $ ] & @xmath201 = 0.20 $ ] @xmath202 $ ] & @xmath203 = 0.18 $ ] @xmath204 $ ] & @xmath205 = 0.07 $ ] @xmath206 $ ] & @xmath207 = 0.12 $ ] @xmath208 $ ] & @xmath207 = 0.12 $ ] @xmath209 $ ] & @xmath201 = 0.20 $ ] @xmath210 $ ] & @xmath201 = 0.20 $ ] @xmath211 $ ] & @xmath203 = 0.18 $ ] @xmath212 $ ] & @xmath203 = 0.18 $ ] @xmath213 $ ] & @xmath205 = 0.07 $ ] @xmath214 $ ] & @xmath207 = 0.12 $ ] @xmath215 $ ] & @xmath207 = 0.12 $ ] @xmath216 $ ] & @xmath217 = 0.26 $ ] @xmath218 $ ] & @xmath217 = 0.26 $ ] @xmath219 $ ] & @xmath220 = 0.15 $ ] @xmath221 $ ] & @xmath220 = 0.15 $ ] @xmath222 $ ] & @xmath223 = 0.10 $ ] @xmath224 $ ] & @xmath225 = 0.10 $ ] @xmath226 $ ] & @xmath217 = 0.26 $ ] @xmath227 $ ] & @xmath217 = 0.26 $ ] @xmath228 $ ] & @xmath220 = 0.15 $ ] @xmath229 $ ] & @xmath220 = 0.15 $ ] @xmath230 $ ] & @xmath223 = 0.10 $ ] @xmath231 $ ] & @xmath225 = 0.10 $ ] @xmath232 $ ] & @xmath192 = 0.28 $ ] @xmath233 $ ] & @xmath194 = 0.20 $ ] @xmath234 $ ] & @xmath194 = 0.20 $ ] @xmath235 $ ] & @xmath196 = 0.07 $ ] @xmath236 $ ] & @xmath198 = 0.13 $ ]    llcl 0 & templates & @xmath237 & coefficients in basis space for each template 1 & spec & @xmath238 & smoothed spectrum of each template 2 & spec_nl & @xmath238 & smoothed spectrum of each template , lines removed 3 & spec_nd & @xmath238 & smoothed spectrum of each template , without dust 4 & spec_nl_nd & @xmath239 & smoothed spectrum of each template , without lines or dust 5 & rawspec & @xmath238 & unsmoothed spectrum of each template 6 & rawspec_nl & @xmath239 & unsmoothed spectrum of each template , lines removed 7 & rawspec_nd & @xmath238 & unsmoothed spectrum of each template , without dust 8 & rawspec_nl_nd & @xmath238 & unsmoothed spectrum of each template , without lines or dust 9 & lspec & @xmath238 & emission line spectrum 10 & extinction & @xmath238 & extinction as a function of wavelength 11 & lambda & @xmath240 & wavelength grid (  ) 12 & sfr & @xmath241 & star - formation rate ( @xmath242 per year ) as a function of time 13 & metallicity & @xmath243 & average metallicity as a function of time 14 & ages & @xmath244 & age grid ( yrs ) 15 & dage & @xmath244 & age bin size ( yrs ) ; sfr@xmath245dage @xmath246 total star - formation in each bin 16 & mass & @xmath247 & total mass formed in each template 17 & mremain & @xmath247 & total current stellar mass in each template 18 & mets & @xmath247 & average metallicity of current stars in each template 19 & m300 & @xmath247 & total stellar mass formed in last 300 myrs in each template 20 & m1000 & @xmath247 & total stellar mass formed in last 1 gyr in each template 21 & basis_ages & @xmath248 & ages of each stellar population basis vector 22 & basis_mets & @xmath249 & metallicity of each stellar population basis vector 23 & basis_dusts & @xmath250 & dust properties of each stellar population basis vector 24 & basis_mremain & @xmath248 & fraction of original stellar mass surviving for each basis vector"
  ],
  "abstract_text": [
    "<S> template fits to observed galaxy fluxes allow calculation of @xmath0-corrections and conversions among observations of galaxies at various wavelengths . </S>",
    "<S> we present a method for creating model - based template sets given a set of heterogeneous photometric and spectroscopic galaxy data . </S>",
    "<S> our technique , non - negative matrix factorization , is akin to principle component analysis ( pca ) , except that it is constrained to produce nonnegative templates , it can use a basis set of models ( rather than the delta function basis of pca ) , and it naturally handles uncertainties , missing data , and heterogeneous data ( including broad - band fluxes at various redshifts ) . </S>",
    "<S> the particular implementation we present here is suitable for ultraviolet , optical , and near - infrared observations in the redshift range @xmath1 . </S>",
    "<S> since we base our templates on stellar population synthesis models , the results are intepretable in terms of approximate stellar masses and star - formation histories . </S>",
    "<S> we present templates fit with this method to data from galex , sloan digital sky survey spectroscopy and photometry , the two - micron all sky survey , the deep extragalactic evolutionary probe and the great observatories origins deep survey . </S>",
    "<S> in addition , we present software for using such data to estimate @xmath0-corrections and stellar masses . </S>"
  ]
}