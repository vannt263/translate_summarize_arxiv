{
  "article_text": [
    "the spectra of stars encode an enormous amount of information , mainly about the stars current physical state and the composition of the chemical elements in their photosphere . but the number of stellar labels that fully specify a spectrum is large : a handful of stellar parameters and much of the periodic table .",
    "we know that stellar spectra with s / n@xmath9 and @xmath10,@xmath11,@xmath12 , currently emerging for @xmath13 objects from various surveys , contain the information to constrain 1040 labels , at least for stars with favorable effective temperatures , @xmath14k@xmath15k ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "the accuracy and precision of label estimates for vast stellar samples matters greatly for understanding the formation of the galaxy , stellar physics , and the origin of the chemical elements .",
    "a principled determination of these stellar labels requires to fit the data with physical model spectra , in which the stellar labels constitute 1040 model parameters .",
    "the calculation of such _ ab initio _ spectral models ( _ a.i .  _ models ) through radiative transfer calculations has a storied tradition ( for an overview , see * ? ? ?",
    "* ; * ? ? ?",
    "_ models vary by the degree of physical simplification they apply : lte _ vs _ non - lte ; plane - parallel _ vs _ spherical geometry ; 1d , averaged or full 3d ; static _ vs _ time dependent ; and by the extent and robustness of the atomic data that underlie them .    the computation of _ a.i .",
    "_ models is expensive , all the more so if the simplifying assumptions are dropped .",
    "this is why `` brute force '' fitting of spectra with _",
    "_ models ( of , say , 1040 labels ) is unfeasible for the foreseeable future : most approaches to fitting _ a.i .",
    "_ models to observed spectra have relied on pre - computing grids of _ a.i .",
    "_ spectra in the @xmath1-dimensional label space , and then interpolating between them pixel - by - pixel , e.g. , quadratically ( i.e. , @xmath16-order ) or cubic ( i.e. , @xmath17-order ) as in @xcite . but for any number of grid points , @xmath18 , in each label - dimension , the total number of _ a.i .",
    "_ model calculations required grows exponentially with the dimension @xmath1 of label space : @xmath19 .",
    "established approaches have coped with this in practice by fitting models spectra first in a 36 dimensional sub - space of @xmath1 , and subsequently fitting one ( or two ) further label at a time , holding the initial labels fixed .",
    "this approach has important limitations with with state of - the - art data : first , @xcite ( hereafter t16 ) has shown that more than just 2 or 3 elemental abundances affect the atmosphere structure , and hence are physically covariant with the basic stellar parameters ; second , physical correlations and data - driven covariances are known to exist among ( abundance ) labels , but can not be estimated when fitting one label at a time ; third , to mitigate against unaccounted covariances , established fitting approaches have often focused on unblended lines , thereby under - exploiting the information content of the data by a large factor ( t16 ) .",
    "t16 proposed a way to overcome this impasse by employing more linear algebra in the fitting , to save on _ a.i .  _ model calculations ; in this _ letter _",
    "we take this idea a step further .",
    "t16 proposed to tessellate the space of stellar labels into a finite set of regions ( dubbed linear taylor - spheres , or 1ots ) . within each 1ots",
    "the _ a.i .",
    "_ model flux at each wavelength can be described sufficiently well by a linearized spectral model ( lsm ) , linearized ( in all labels ) around the _",
    "a.i .  _ model spectrum at a fiducial label value .",
    "t16 showed that such lsm can sufficiently approximate the exact model spectra within a 1ots . together with the finite number of taylor - spheres , required to cover any given spectral survey ( e.g. , @xmath20 for the apogee red clumps ) , this leads to a dramatic reduction in the total number of _ a.i .",
    "_ model calculations : simultaneous fitting of 1040 labels should then be feasible .",
    "here we point out a rather obvious extension of this idea , which yields even greater computational savings : the construction of approximate model spectra , where the predicted flux at each pixel by a polynomial in all labels away from a fiducial model spectrum .",
    "this idea had been put forth by @xcite for empirical spectra , who did , however , not pursue its potential of fitting many labels simultaneously .",
    "we denote such approximate _ polynomials spectral models _ as psm , to distinguish them from the _ a.i .",
    "_ models themselves .",
    "it is important not to think of these psm as a @xmath21-order interpolation between a _ pre - calculated _ grid of _ a.i .",
    "_ models ( as e.g. , @xcite did for a quadratic psm in three labels ) , as this would still require @xmath22 _ a.i .",
    "_ model calculations . instead",
    ", one should think of determining the ( near)-smallest number of _ a.i .",
    "_ model spectra ( specified by @xmath1 labels ) one needs to calculate in order to construct a @xmath21-order approximation to the _ a.i .",
    "_ model spectra .",
    "the simplification and speed - up of such spectral fitting compared to t16 arise from the fact that a single psm can approximate the _ a.i .  _ model spectra over a much larger volume in label space . while this shares the idea of a polynomial flux approximation with _ the cannon _",
    "@xcite , it is _ not _ data - driven model building .    in the subsequent sections we first derive that the minimal number of _ a.i .",
    "_ models needed to construct a psm of order @xmath2 and then illustrate heuristically how well , and over what volumes in label space , these psms approximate the _ a.i .  _ models .",
    "following t16 , we suppose that an _ a.i .",
    "_ modeling `` machinery '' can predict the normalized flux of a synthetic spectrum , @xmath23 , given a set of stellar labels , @xmath24 . we _ assume _ that the _ a.i .",
    "_ model spectra change from point to point in label - space , but do so smoothly or differentiably at every wavelength .",
    "then the _ a.i .",
    "_ model spectrum at any @xmath24 sufficiently close to an model grid point @xmath25 ( within a @xmath26-order taylor - sphere or 1ots , in the nomenclature of t16 ) can therefore be described with high accuracy by a _ linear _",
    "spectral model ( lsm , see t16 ) :    @xmath27    where @xmath28 .    in principle",
    ", specifying a lsm merely requires @xmath29 model calculations , but t16 showed a a factor of a few more is needed to explore the actual extent of the 1ots .",
    "this lsm approximation , @xmath30 , can obviously be generalized to a polynomial spectra model ( psm ) :    @xmath31    where we will focus on @xmath16-order , both for astrophysical reasons ( it may work well enough ) and to avoid cumbersome notation .",
    "such a psm holds for every one of the @xmath32 wavelengths @xmath33 .",
    "one may think of it as a model with @xmath32 @xmath34-order terms , @xmath35 , then @xmath36 @xmath26-order terms , and finally @xmath37  @xmath16-order terms .",
    "the number @xmath38 arises because of the symmetry of @xmath39 . in total that makes for    @xmath40    unknown terms . for more general psm of order @xmath2",
    ", one has @xmath41 .",
    "if we compute _ a.i .",
    "_ models @xmath42 at @xmath3 different points in label space , @xmath43 , we have created exactly @xmath44 left - hand - side terms to solve exactly for the terms that specify the psm .",
    "note that strictly speaking @xmath45 and @xmath46 are not exactly the `` gradient '' and the `` hessian '' , but merely the @xmath26 and @xmath16-order coefficients that solve the equation .",
    "compared to the 1ots , we have to calculate @xmath47 times more _ a.i .",
    "_ models for any one quadratic psm .",
    "but if the the region in label space around @xmath25 over with this quadratic psm works is sufficiently larger , an important speed - up over the the ( set of ) lsm should result .",
    "calculating somewhat more _",
    "_ models than this minimum , and solving eq.[eq : quadratic ] in a least squares sense , makes for a much better conditioned solution for a psm , as we show below .",
    "strictly verifying the validity of the psm approximation , like any approximation to a high - dimensional function , would be of enormous computational expense . here , too , escaping the curse of dimensionality comes at a price : relying on the physically plausible _ assumption _ that spectral flux changes can be approximated by polynomials for modest label changes ; and settling for heuristic and approximate ways to explore the extent in label space over which a single psm is useful .",
    "as in t16 , we can set out for a pragmatic test of the psm approximation , using kurucz model spectra that resemble in resolution and wavelength coverage the apogee spectra ; the arguments should hold qualitatively for other surveys , but need to be tested case - by - case . in total , the dr12 data release of the apogee @xcite provides 17 labels for each star ( @xmath48 , @xmath49 and 15 elemental abundances ) while fixing @xmath50km / s and adopting a @xmath51 relation for @xmath52 .",
    "a quadratic psm for 19 labels requires a minimum @xmath53 _ a.i .  _ model calculations .",
    "we chose the reference label , @xmath25 , to be the apogee dr12 sample median in each of the 19 labels , providing @xmath54 in eq.[eq : quadratic ] .",
    "the vast majority of targets in apogee are disk stars with all [ x / h]@xmath55 , and we restrict our psm verification to this regime .",
    "we then drew 209 @xmath56 at random from the apogee dr12 catalog .",
    "for the labels @xmath52 and @xmath57 we adopted the same @xmath58 relation from apogee with a spread of @xmath59km / s , and a distribution in @xmath57 uniform across @xmath60km / s  @xmath61km / s .",
    "we convolved spectra to the apogee resolution assuming the combined lsf from apogee and using codes from the apogee python package @xcite , and continuum normalized spectra the same way as _ the cannon _ @xcite .",
    "this provided the remaining 209 left - hand sides of eq.[eq : quadratic ] to solve exactly for the @xmath45 and @xmath62 , fully specifies @xmath63 from eq [ eq : quadratic ] .",
    "as expected by construction of the psm , @xmath64 matches the _",
    "_ model at all the 210 @xmath56 exactly .",
    "this minimally constructed psm also provides good approximations to @xmath65 for other @xmath43 .",
    "empirical experimentation showed that slightly over constraining eq [ eq : quadratic ] worked better : we calculated @xmath66 for 250 and 1000 @xmath43 drawn from apogee , and solved for the right hand side of eq.[eq : quadratic ] in a least squares sense to determine the psm coefficients .",
    "there are two ways in which one can quantify how well the psm , @xmath67 , approximates @xmath42 for any @xmath43 drawn from apogee : how well do the fluxes match , e.g.in a mean absolute deviation ? and",
    ", at what accuracy level does the psm approximation affect the label recovery ?",
    "fig.[fig : rms ] illustrates how well an _",
    ". _ model spectrum of random star in apogee is can be approximated by the psm in a mean absolute deviation sense .",
    "on average the psm - predicted flux at any wavelength for a random star within apogee is within @xmath7 or @xmath68 of that for its _ a.i .",
    "_ model spectrum , depending on whether we used 250 or 1000 _ a.i . _ model calculations to construct the psm .",
    "fig [ fig : label ] shows how much ( or , how little ) the psm approximation , calculated here on the basis of 250 or 1000 _ a.i .",
    "_ models , affects the label recovery across an apogee - like survey .",
    "the labels were recovered by a least squares fit of the psm to noiseless _ a.i .",
    "_ models , fitting all 19 labels _",
    "simultaneously_. these were then compared to the actual labels of the respective _ a.i",
    ".  _ models . with a single psm",
    ", most labels are recovered as accurate as claimed precisions of current spectral surveys .",
    "more quantitatively the quality of the psm label recovery is well - tracked by the information content that the spectra contain about any one label : following t16 , this is quantified by the cramer - rao bound ( for s / n@xmath69 ) using either only the apogee wavelength windows for certain elements or the whole spectrum .",
    "the psm appears heuristically as a better approximation when calculated on the basis of more _ a.i .",
    "model calculations , presumably for two reasons : the system of linear equations in eq.[eq : quadratic ] becomes better conditioned ; and a better sampling of label - space better mitigates any break - down of the polynomial approximation .",
    "both factors must play a role : when we restrict the label range over which we first construct and then test the psm , the psm label recovery is even closer to the exact solution .",
    "yet , the psm constructed on the basis of 1000 ( compared to 250 ) _ a.i .",
    "_ model calculations is still performing better .",
    "how many models to calculate for the psm construction , and over which portion of label space to apply it will therefore depend in practice on the computational expense of the _ a.i .",
    "_ models and the desired label accuracy .",
    "nonetheless , fig.[fig : rms ] and fig.[fig : label ] demonstrate that with calculating only 250 ( or 1000 ) _ a.i .",
    "_ models one can construct a _ single _ ( quadratic ) psm that performs remarkably well in approximating results from exact model spectra at random 19-dimensional label location across much of apogee survey .",
    "we have shown the advantages for spectral model fitting of generalizing the local linear expansion of _ a.i .",
    "_ model spectra laid out in t16 to higher order , constructing polynomial spectral models ( psm ) that approximate the variations of the predicted spectral flux at each wavelength as a polynomial function of the labels .",
    "this reduces the calculation of the model spectra needed in simultaneous fitting of _ many _ stellar labels to observed spectra to linear algebra .",
    "compared to established approaches that first calculate grids and then interpolate , the dramatic gain in constructing a psm comes from the much more benign scaling of the computational effort with increasing label dimension : @xmath70 , or @xmath71 for a quadratic model with @xmath4 , as opposed to @xmath72 . the way these psm",
    "are constructed are mathematically very much analogous to data - driven _ the cannon _",
    "@xcite , where a quadratic spectral model is derived form observed spectra .",
    "the arguments here provide a systematic guidance for the size of the required training set in _",
    "the cannon _ : we should expect the training set size to scale as ( as a multiple ) @xmath73 , or @xmath71 ; this makes it plausible that _ the cannon _ could constrain 19 labels from a training set of @xmath74,@xmath12 @xcite .",
    "the heuristic verification of the psm approximation , along with the framework laid out in t16 , means that there should be no longer serious technical obstacles to determining stellar labels in large surveys to what amounts to fitting all labels with _ a.i . _",
    "model spectra simultaneously .",
    "the accommodation of label correlation facilitates the extraction of abundance information from blended spectral features .",
    "we find from the gradient spectra , that 80% of the spectrum s information on a label is spread over typically 30% of all pixels , and is not just in narrow spectral windows ( t16 ) .",
    "for any given data set this should allow higher precision and accuracy .",
    "psm also allows to treat parameters of the experimental set - up , such as the continuum fit or the spectral line - spread function ( lsf ) quasi as stellar labels , and fit them simultaneously .",
    "of course , constructing psms is not a _ panacea _ : while a single psm appears to suffice for the much of apogee survey , this is presumably because apogee has targeted stars in a rather restricted portion of label space : giant stars in a narrow temperature range . yet , even there , constructing a separate psm for the metal - poor regime may be advisable , as small model flux differences cause larger label recovery errors .",
    "second , it is probably worth exploring the psm approach to higher order in at least some of the labels .",
    "perhaps most importantly , any fitting based on _ a.i .",
    "_ spectral models can only work as well as the physics behind them .",
    "insufficient atomic data or the restrictions of the lte approximation remain untouched by the ideas laid out here .",
    "nonetheless , we feel that t16 and this paper lay out a path that may help in doing justice to the enormous information content of present and future stellar spectroscopy surveys .",
    "yst acknowledges support from nasa grant nnx15ar83h and is grateful to the mpia and the dfg through the sfb 881 ( a3 ) for their hospitality and financial support .",
    "cc acknowledges support from nasa grant nnx13ai46 g , nsf grant ast-1313280 , and the packard foundation .",
    "hwr s research contribution is supported by the erc grant agreement n.@xmath75[321035 ] .",
    "the computations in this paper were partially run on the odyssey cluster supported by the fas division of science , research computing group at harvard university .",
    "the computational work also used the extreme science and engineering discovery environment ( xsede ) , which is supported by national science foundation grant number aci-1053575 .",
    "we thank bob kurucz for developing and maintaining programs and databases without which this work would not be possible ."
  ],
  "abstract_text": [
    "<S> stellar spectra depend on the stellar parameters and on dozens of photospheric elemental abundances . </S>",
    "<S> simultaneous fitting of these @xmath0 model labels to observed spectra has been deemed unfeasible , because the number of _ ab initio _ spectral model grid calculations scales exponentially with @xmath1 . </S>",
    "<S> we suggest instead the construction of a polynomial spectral model ( psm ) of order @xmath2 for the model flux at each wavelength . building this approximation </S>",
    "<S> requires a minimum of only @xmath3 calculations : e.g. a quadratic spectral model ( @xmath4 ) to fit @xmath5 labels simultaneously , can be constructed from as few as 231 _ ab initio _ spectral model calculations ; in practice , a somewhat larger number ( @xmath6 ) of randomly chosen models lead to a better performing psm . </S>",
    "<S> such a psm can be a good approximation only over a portion of label space , which will vary case by case . yet , taking the apogee survey as an example , a single quadratic psm provides a remarkably good approximation to the exact _ ab initio _ spectral models across much of this survey : for random labels within that survey the psm approximates the flux to within @xmath7 , and recovers the abundances to within @xmath8 dex _ rms _ of the exact models . </S>",
    "<S> this enormous speed - up enables the simultaneous many - label fitting of spectra with computationally expensive _ ab initio _ </S>",
    "<S> models for stellar spectra , such as non - lte models . </S>",
    "<S> a psm also enables the simultaneous fitting of observational parameters , such as the spectrum s continuum or line - spread function .    </S>"
  ]
}