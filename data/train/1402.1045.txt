{
  "article_text": [
    "molecular dynamics simulations are becoming increasingly capable not only of assisting the interpretation of experiments , but also of predicting the properties and the behaviour of new materials and compounds  @xcite .",
    "besides the increase in available computer power , these developments have been made possible by an increasingly accurate treatment of the interactions between the atoms , in particular by an explicit treatment of the electronic structure problem  @xcite . however , as the methods that are used to treat the quantum nature of the electrons improve , it becomes increasingly clear that in the presence of light atoms , such as hydrogen or lithium , the error due to approximating the nuclei as classical particles is at least as large as the errors due to the approximate modelling of the electrons .",
    "the importance of nuclear quantum effects ( nqes ) is evident from the fact that the zero - point energy associated with a typical o ",
    "h stretching mode is in excess of 200  mev .",
    "this has significant implications : for example , one can show by extrapolating the experimental values for isotopically pure light , heavy and tritiated water that a hypothetical liquid with classical nuclei would have a 50% higher heat capacity than h@xmath0o and a ph of about 8.5 .    within the born - oppenheimer approximation , nqes can be modelled using the imaginary time path integral formalism  @xcite",
    ". this formalism maps the quantum mechanical partition function for a set of distinguishable nuclei onto the classical partition function of a so - called ring polymer , composed of @xmath1 replicas ( beads ) of the physical system connected by harmonic springs .",
    "the number of replicas needed to achieve a converged result is typically a small multiple of @xmath2 , where @xmath3 is the inverse temperature and @xmath4 is the largest vibrational frequency in the system . for the archetypical case of room - temperature liquid water ,",
    "most properties are reasonably well converged with @xmath5  making the path integral simulation 32 times more expensive than a classical simulation .    as a consequence of this large overhead ,",
    "nqes were for many years only rarely considered in the context of _ ab initio _ molecular dynamics  @xcite . however , with the advent of massively parallel computers , including these effects has become somewhat more affordable @xcite , and their simulation has also been facilitated by new methodological developments .",
    "in particular , it has recently been realised that an approximate modelling of nqes can be obtained by applying a coloured ( correlated)-noise langevin equation thermostat to classical molecular dynamics  @xcite .",
    "moreover , this idea can be turned into a systematically convergent , accurate method  @xcite by combining coloured noise with path integral molecular dynamics ( pimd ) . to give an example ,",
    "the piglet method  @xcite makes it possible to treat nqes in liquid water at 300  k with as few as 6 beads , which promises to make accurate _ ab initio _ pimd calculations almost routine .",
    "unfortunately , most _ ab initio _ electronic structure codes only contain rudimentary implementations of pimd , if any at all .",
    "we have developed i - pi in order to reduce the effort of introducing the latest pimd developments into electronic structure codes , so as to make them readily available to a broader community .",
    "the framework we have adopted is a server - client model , in which i - pi acts as a server passing atomic coordinates to ( multiple instances of ) an electronic structure client program , and receiving the energy and forces in return .",
    "this allows all of the pimd machinery to be confined to the python server side , and minimises the modifications that have to be made to the electronic structure code .",
    "i - pi has been developed with the awareness that the cost of an _ ab initio _ pimd simulation will be dominated by the electronic structure problem , and with a few clear goals :    * to minimise the effort required to modify the client _ ab initio _ electronic structure code , * to include no feature specific to a particular client code , * to be modular , simple to extend and with a structure that reflects the underlying physics , * to be efficient , but never at the cost of clarity .    in order to acheive these goals",
    "we have chosen the python programming language , and a client - server model in which i - pi acts as the server , dealing exclusively with evolving the nuclear degrees of freedom according to the equations of motion .",
    "the evaluation of the forces , the potential and the virial is delegated to one or more instances of the client code ( see figure  [ fig : scheme ] ) . i - pi maintains a list of active clients , to which it dispatches the positions of the nuclei and from which it collects the forces and energy as soon as they have been computed .",
    "the communication is kept to a minimum , not so much for its impact on performance , as for the fact that exchanging more information would require a more substantial implementation effort on the client side .",
    "all the details of the force evaluation  such as the parameters of the electronic structure calculation  are left to the input of the external code : i - pi only sends the dimensions of the simulation box ( @xmath6 ) and the coordinates of the nuclei ( @xmath7 ) , and expects the atomic species to be stored internally by the client code in the same order they are in the i - pi input .",
    "the client code computes and returns the ionic forces ( @xmath8 ) , electronic energy ( @xmath9 ) and stress tensor ( @xmath10 ) , possibly supplemented by a string that contains any further information on the electronic structure ( e.g. the dipole moment , the partial charges of the atoms , etc . )",
    "that might be required for post - processing ; i - pi simply outputs this string verbatim .",
    "schematic overview of the client - server model underlying i - pi .",
    "the communication is kept to a minimum , and so are the modifications that need to be made to adapt an existing electronic structure code to act as the client .",
    "the client is not restarted between successive force evaluations , so that the overhead associated with initialisation is avoided . ]",
    "the client - server communication is implemented using sockets .",
    "if desired , i - pi can communicate with the clients across the internet , realising a rudimentary distributed computing paradigm . if one wishes to reduce the communication overhead ",
    "e.g. if one wants to use i - pi with an empirical forcefield driver ",
    "local unix - domain sockets can be used .",
    "it would also be easy to implement different communication methods , e.g. via inter - process mpi or writing to disk .",
    "instances of the patched _ ab initio _ code can register themselves dynamically , and i - pi keeps track of the active clients so that the forces on multiple path integral replicas can be evaluated at once .",
    "the trivial layer of parallelism over the beads can therefore be fully exploited .",
    "we would recommend implementing the communication code into the client software in a way that mimics one of the existing procedures that update nuclear positions , as is done in molecular dynamics , geometry optimisation , etc .",
    "the electronic structure infrastructure only has to be initialised once , before the client connects to the i - pi server and waits to receive a set of atomic coordinates .",
    "it then performs an electronic structure calculation , returns the energy , forces and stress tensor to the server , and waits for the next set of coordinates .",
    "the converged density / wavefunction from the previous step can be re - used as the starting point for the next , which is advantageous because in all probability this will correspond to a very similar atomic configuration .",
    "this makes our approach superior to a scripting approach in which the client code is re - launched with a new input for each atomic configuration . in order to fully take advantage of the density / wavefunction extrapolation techniques implemented in many modern electronic structure codes , i - pi will always try to dispatch the same replica to a given instance of the client , to ensure that a smooth sequence of configurations is provided to each client from one time step to the next .",
    "schematic overview of the functioning of the _ depend _ class used as the base for properties and physical quantities in i - pi .",
    "a few `` primitive '' quantities  such as atomic positions or momenta  can be modified directly . for most properties",
    ", one defines a function that can compute their value based on the values of other properties .",
    "whenever one property is modified , all the quantities that depend on it are marked as tainted , so that  when the value of one of the properties is used , the function can be invoked and the updated value can be obtained and cached . if the same quantity is requested again and it has not been marked as tainted in the mean time , the cached value is returned . ]    to make the internal coding of i - pi as transparent and as close to the physics of the problem as possible , we have introduced a dedicated python class to represent physical quantities  such as the atomic coordinates , the momenta , the kinetic energy , etc .",
    "instances of this class can be used simply as variables containing the value of the quantity they represent .",
    "however , they also contain information on how each quantity depends on others , and how it can be computed from its dependencies ( see figure  [ fig : depend ] ) .",
    "derived quantities are computed automatically when requested , and their value is cached for future reference .",
    "if the same quantity is needed again , the cached value will be used , avoiding the overhead of re - computing it .",
    "if however one of the quantities it depends on has been modified , it will be re - evaluated automatically .",
    "this mechanism of dependency detection and value caching considerably de - clutters the code , since one does not need to keep track of when quantities need to be recomputed .",
    "the input for i - pi consists in a xml file , containing a number of tags and options that specify the details of the simulation .",
    "the list of available options are described in detail in the manual .",
    "i - pi can dump the full state of the simulation as _ checkpoint _ files , that can be used to seamlessly re - start a simulation and that have the same format of an input file , so it is easy to modify some of the options , if desired .",
    "integrating the pimd equations of motion involves a number of technicalities .",
    "fortunately , these can be kept to a minimum by using stochastic thermostatting  @xcite  which avoids the complication of integrating nos - hoover chain thermostats  and by formulating the time evolution using a symmetric trotter splitting algorithm  @xcite .",
    "this is the approach we have adopted in the i - pi program .",
    "the program implements the most recent developments in path integral and colored - noise molecular dynamics , including the following :    * molecular dynamics and pimd in the _ nve _ , _ nvt _ and _ npt _ ensembles , with the high - frequency internal vibrations of the path propagated in the normal - mode representation  @xcite ; * ring polymer contraction  @xcite , implemented by exposing multiple socket interfaces to deal separately with short and long - range components of the potential energy ; * efficient stochastic velocity rescaling @xcite and path integral langevin equation thermostats  @xcite ; * various generalized langevin equation ( gle ) thermostats , including the optimal sampling  @xcite , quantum  @xcite , and @xmath11  @xcite thermostats , the parameters for which can be downloaded from an on - line repository  @xcite ; * mixed path integral  generalized langevin equation techniques for accelerated convergence , including both pi+gle  @xcite and the more recent and effective version piglet  @xcite ; * all the standard estimators for structural properties , the quantum kinetic energy , pressure , etc . ; * more sophisticated estimators such as the scaled - coordinate heat capacity estimator  @xcite , estimators to obtain isotope fractionation free energies by re - weighting a simulation of the most abundant isotope  @xcite , and a displaced - path estimator for the particle momentum distribution  @xcite ; * the infrastructure that is needed to perform ring polymer molecular dynamics ( rpmd )  @xcite and centroid molecular dynamics ( cmd )  @xcite approximate quantum dynamics calculations .",
    "most of the techniques listed above have been discussed in detail elsewhere . however , our implementation of pimd in the _ npt _ ensemble has not been described before now .",
    "the approach we have adopted for this is a relatively straightforward combination of ideas taken from path integral langevin equation thermostats  @xcite , stochastic barostats for conventional md  @xcite , and previous work on constant - pressure pimd  @xcite .",
    "we report it here as this combination is robust , transparent and streamlined , and we think it could be useful as a reference for future implementations of pimd and piglet in the _ npt _ ensemble .    consider a classical system composed of @xmath12 atoms , described by the hamiltonian @xmath13 where @xmath9 is the potential energy of the system , and @xmath14 the mass of the @xmath15-th atom .",
    "the path integral hamiltonian for the same system reads  @xcite @xmath16 where @xmath17 contains the cartesian coordinates of the @xmath15-th atom in the @xmath18-th replica and @xmath19 is the free - particle ring - polymer hamiltonian . here",
    "@xmath20 and cyclic boundary conditions are implied : @xmath21 .",
    "we have chosen to implement a version of the _ npt _ ensemble in which only the centroid coordinates @xmath22 are scaled when the simulation cell volume @xmath23 is changed  @xcite . following previous literature on molecular dynamics at constant pressure  @xcite",
    "we allow the cell volume to fluctuate , assigning a fictitious mass @xmath24 to the cell and using the log - derivative of the cell volume @xmath23 with respect to time to define the cell momentum @xmath25 .",
    "the fictitious mass can be related to a characteristic relaxation time scale for the cell dynamics , @xmath26 , by @xmath27 .",
    "let us start by stating the equations of motion we will use ; we will then move on to describe the corresponding stationary distribution , and finally how the equations of motion can be integrated . although other stochastic thermostats could be used , we will consider here the case of a white - noise langevin piston and of a configurational pile - l thermostat on the ring polymer normal modes  @xcite .",
    "we will write the equations of motion in the normal mode representation , using @xmath28 ( where @xmath29 is defined in ref .",
    "@xcite ) to indicate the @xmath30-th normal - mode component corresponding to the quantity @xmath31 for the @xmath15-th atom , and @xmath32 as a short - hand to indicate the force @xmath33 . in this notation ,",
    "equations of motion for @xmath34 and @xmath35 , split according to the same scheme we will use for the liouville operator further down , are as follows :    @xmath36.\\end{aligned}\\ ] ]    here @xmath37 is a scalar and @xmath38 a vector of uncorrelated normal deviates with zero mean and unit variance , and we use the centroid - virial estimator for the internal pressure in the form @xmath39.\\ ] ] note that the kinetic energy term in this estimator could equally well be substituted by its mean , @xmath40 .",
    "however , we use the instantaneous value as this is needed for the dynamics to have a well - defined conserved quantity . note also that we use @xmath41 to signify the _ total _ derivative of the potential energy with respect to volume , which typically contains a term obtained from the virial",
    ". we shall not enter into the details of how the virial should be computed , since the evaluation of the potential energy component of the pressure is delegated to the client program .",
    "regardless of the implementation , one should make sure that the client returns the total derivative , including terms that depend explicitly on the volume such as tail corrections .",
    "it is straightforward but tedious to show that the equations of motion in eqs .",
    "- have the conserved quantity @xmath42 where @xmath43 is the heat transfer balance of the thermostatting steps in eqs .   and  , as explained in refs",
    ".  @xcite .",
    "similarly , one can show that the probability distribution @xmath44 \\right)\\label{eq : measure}\\ ] ] is stationary with respect to the liouville operator @xmath45 where the splitting of the liouville operator is that arising from the subdivision of the equations of motion  - :    @xmath46 \\frac{\\partial \\,\\cdot}{\\partial\\alpha}.\\end{aligned}\\ ] ]    note that we have modified slightly the equations of motion given in  @xcite by including just one @xmath47 in eq .   and   rather than two , so that we obtain the same _ npt _ stationary distribution as in ref .",
    "@xcite ( see eq .  ) .",
    "also , the @xmath48 term in this distribution is multiplied by the number of beads , which is consistent with the fact that the path integral partition function is evaluated at @xmath1 times the physical temperature .",
    "the integration scheme we have implemented in i - pi follows closely that of ref .",
    "@xcite and is based on the following symmetric trotter splitting of the propagator @xmath49 thus , the thermostat is first applied to the ring polymer and cell momenta for half a time step ( eqs .   and  ):",
    "@xmath50 next , the momenta are evolved under the action of the pressure term and the inter - atomic forces for half a time step ( eqs .   and  ):",
    "@xmath51    \\\\ + & \\left(\\frac{\\delta t}{2}\\right)^2   \\sum_i \\frac{1}{m_i } \\tilde{\\mathbf{f}}_i^{(0 ) } \\cdot \\tilde{\\mathbf{p}}_i^{(0 ) } + \\left(\\frac{\\delta t}{2}\\right)^3   \\sum_i \\frac{1}{3 m_i } \\tilde{\\mathbf{f}}_i^{(0 ) } \\cdot \\tilde{\\mathbf{f}}_i^{(0 ) } \\\\",
    "\\tilde{\\mathbf{p}}_i^{(k ) } \\,\\leftarrow\\ , &     \\tilde{\\mathbf{p}}_i^{(k ) } + \\tilde{\\mathbf{f}}_i^{(k ) } { \\delta t}/{2}. \\end{split}\\label{eq : prop - pbaro}\\ ] ] this brings us to the central term in eq .  , which comprises two independent ( and commuting ) liouvillians .",
    "one of these ( eqs .",
    ", , and the @xmath52 term in  ) evolves the centroid using an algorithm identical to the stochastic classical barostat of ref .",
    "@xcite , @xmath53 while the other ( comprising the terms with @xmath54 in eq .  ) evolves the internal modes using an algorithm identical to the free ring polymer _ nve _ integrator in ref .  @xcite @xmath55\\sin \\omega_k\\delta t & \\cos \\omega_k\\delta",
    "t \\cr \\end{pmatrix } \\begin{pmatrix } \\tilde{\\mathbf{p}}_{i}^{(k ) } \\cr \\tilde{\\mathbf{q}}_{i}^{(k ) } \\end{pmatrix},\\ ] ] where @xmath56 . at this point ,",
    "one continues with the second part of the integrator , executing again the steps in eqs .  , and finally applying the thermostats as in eq .  .",
    "note that the modular nature of this integration scheme means it is very easy to implement a different thermostatting approach for the ions or the cell , simply by changing eq .",
    "to the appropriate propagator .",
    "to highlight some of the more advanced features available in i - pi , we have used it to perform an illustrative _ ab initio _ piglet @xcite simulation of supercritical water at 750  k and 10  gpa .",
    "this simulation is both technically challenging and physically interesting .",
    "we shall use it to reveal the importance of nqes under conditions similar to those explored in the pioneering work of ref .",
    "@xcite , in which calculations were performed at constant volume and without quantum effects in the nuclear motion .",
    "all the present calculations used a simulation box containing 64 water molecules , initially equilibrated at the desired state point using an empirical forcefield  @xcite .",
    "starting from this configuration , we performed 25  ps of _ nvt _ dynamics with classical nuclei and _ ab initio _ forces .",
    "we employed a patched version of cp2k @xcite as the electronic structure client , with computational details similar to those used in ref .",
    "we used the blyp exchange - correlation functional @xcite and gth pseudopotentials @xcite .",
    "wave functions were expanded in the gaussian dzvp basis set , while the electronic density was represented using an auxiliary plane wave basis , with a kinetic energy cutoff of 300  ry . in our constant - pressure simulations",
    "we used a tzv2p basis set , a cutoff of 800  ry , and a plane wave grid consistent with a cubic reference cell with a side of 10.5    ( the higher cutoff was necessary to converge the stress tensor used to define the pressure virial ) .",
    "we included d3 empirical van der waals corrections  @xcite , which are essential to obtain a reasonable description of water at constant pressure .",
    "after the preliminary _ nvt _ equilibration , we performed a reference 50  ps _ npt _ trajectory with classical nuclei , with the first 5  ps discarded for equilibration .",
    "the integration time step was 0.5  fs .",
    "we used a stochastic velocity rescaling thermostat  @xcite for the ions , with a time constant of 20  fs , and an optimal - sampling gle thermostat  @xcite for the cell momentum  for which we chose a fictitious mass consistent with @xmath57  fs .",
    "we then performed 50  ps of simulation with quantum ions , modelling the quantum nature of nuclei using a 4-bead path integral supplemented with piglet colored noise .",
    "the cell momentum was thermostatted using an optimal - sampling , classical gle thermostat .",
    "input files for both i - pi and cp2k are provided among the examples attached to the source code of i - pi .",
    "histogram of the density ( upper panel ) and of the instantaneous internal pressure estimator in eq .",
    "( lower panel ) , comparing _ npt _",
    "simulations with classical and quantum nuclei . ]",
    "figure  [ fig : histos ] reports the histograms of density and internal pressure obtained during the simulations .",
    "the average density in the classical simulation is @xmath58  g/@xmath59 , which is qualitatively consistent with the simulation of ref .",
    "@xcite , which observed an average pressure of 14.5  gpa in the _ nvt _ ensemble at a density of @xmath60  g/@xmath59 .",
    "the density appears to be slightly higher for simulations with quantum nuclei , @xmath61  g/@xmath59 , but one should note that the correlation time for @xmath62 tends to be underestimated in relatively short _ ab initio _ runs , so the quantum effect is barely significant given that our computed error bars are likely to be optimistic . note that the estimator for the internal pressure is correctly peaked around the value fixed by the definition of the ensemble .",
    "radial distribution functions from _ npt _ simulations of water at a temperature of 750  k and a pressure of 10  gpa . simulations with classical and quantum nuclei are compared . ]",
    "the small role that nqes play in determining the equilibrium density is not surprising : even at room temperature , the isotope effect on the number density of water is extremely small .",
    "however , one should not think that at these high temperatures the quantum nature of light nuclei can be neglected .",
    "it is clear from the radial distribution functions reported in figure  [ fig : gr - npt ] that , while nuclear quantum effects do not change the long - range structure , they do have a very sizeable impact on the short - range part of @xmath63 .",
    "there is very little effect on the oxygen - oxygen @xmath64 ( the difference is barely significant considering the statistical error bars ) , but @xmath65 and @xmath66 are noticeably over - structured for @xmath67 in the classical simulation .",
    "notice in particular how the quantum @xmath66 departs significantly from zero between the intra - molecular and inter - molecular regions .",
    "this is a sign that the combined effect of pressure and nqes leads to significant delocalization of protons along the hydrogen bonds .",
    "these bar charts depict the probability of finding @xmath68 charged pairs in a snapshot of our simulation box .",
    "the upper panel is for a classical simulation , and the lower panel for a quantum simulation .",
    "the dots joined with lines represent the values for a binomial distribution fitted to the computed probabilities  each snapshot contains 64 water molecules , so can accommodate a maximum of 32 ion pairs .",
    "the best - fit probability of a pair being ionized is found to be @xmath69 for the quantum simulation and @xmath70 for the classical simulation . ]    to investigate this delocalisation further , we have adopted the simple protocol used in ref .",
    "@xcite to identify charged species .",
    "each proton in the simulation is assigned to the closest oxygen atom .",
    "one can then distinguish between neutral , positively and negatively charged species based on the number of protons assigned to each oxygen .",
    "we will refer to `` @xmath71 '' species as those oxygen atoms to which three protons have been assigned , and `` @xmath72 '' species as those with just one . given the artificial nature of this procedure , we do not intend to imply that these species correspond to water , hydronium and hydroxide .",
    "however , they do provide a simple way to characterise how much each frame departs from the conventional picture of a molecular fluid composed of neutral molecules . in all of our simulations",
    ", we only detected a single instance of a `` doubly ionised '' oxygen , so in the discussion that follows we shall assume that the charged o atoms always form in pairs .",
    "figure  [ fig : barchart ] shows very clearly just how important nqes are in determining the fluctuations of protons along hydrogen bonds .",
    "most frames in the classical simulation only contain neutral species  the concentration of @xmath71 or @xmath72 is @xmath73% , even smaller than that observed in ref .",
    "@xcite , where the density was higher . in the quantum simulation ,",
    "the concentration is much larger , about @xmath74% , and there is a fairly large probability of having more than one pair of ions in any given frame .",
    "interestingly , in both cases the probability of finding @xmath68 ionised pairs follows closely a binomial distribution , which is a sign that the ionisation events are weakly correlated with each other .",
    "radial distribution functions for positively and negatively charged defects in _ npt _ simulations of water at 10  gpa and 750  k. results from quantum and classical simulations are compared , and the lower panel shows the long - range part of @xmath75 on an enlarged scale . given the low concentration of defects , the radial distribution functions are very noisy , and the normalisation is problematic , so the scale of the ordinate should be considered as arbitrary . ]",
    "it is interesting to investigate the spatial distribution of these ion pairs : in figure  [ fig : gr - ions ] we show the radial distribution functions @xmath75 .",
    "the distributions are very noisy , particularly in the classical case , where we have only a handful of snapshots containing more than a single ion pair . in the quantum simulation",
    ", we could collect better statistics , because the concentration of ion pairs is larger . in this case , is clear that the radial distribution function is almost flat for @xmath76   ( see lower panel of figure  [ fig : gr - ions ] ) , which is consistent with the binomial distribution of @xmath68 in figure  [ fig : barchart ] .",
    "furthermore , the upper panel of figure  [ fig : gr - ions ] clearly shows that , in the vast majority of cases , what is detected as a pair of ions is simply an excursion of a proton along a compressed hydrogen bond .",
    "this is consistent with the observation of short - lived charged species in classical simulations of water at considerably higher pressure  @xcite .",
    "as was shown in a recent study of water under ambient conditions  @xcite , nuclear quantum effects dramatically enhance the delocalisation of the proton along the hydrogen bond .",
    "this suggests that perturbations that modulate the average o  o distance , such as pressure , might trigger auto - ionisation more easily than in the classical case .",
    "in fact , not all of the ion pairs in the present simulations are close together and short - lived : if we define an isolated ion as a positive species that has no negative counterpart within @xmath77   of it , we find a concentration of @xmath78%  of these isolated ions in our classical simulations , and of @xmath79%  in our quantum simulations .",
    "this is not far from the value of 0.5  %  measured in shock - compressed water at 13  gpa  @xcite .",
    "however , our definition of an isolated ion is somewhat arbitrary , and the concentrations we quote will be strongly system - size dependent .",
    "nevertheless , the ratio between these concentrations and the overall fraction of ionised species indicates that quantum effects have an even more dramatic impact on genuine auto - ionisation events than they do on local hydrogen bond fluctuations .",
    "this is perhaps not too surprising , given the significant isotope effect on the ph of water under ambient conditions .     a snapshot from the final stage of our 40  ps quantum simulation of water at 750  k and 10  gpa .",
    "protons that are bound to a different oxygen than the one they were bound to in the initial configuration of the trajectory are highlighted in blue .",
    "note that many exchanges have occurred . in our classical simulation , no exchanges were observed . ]",
    "the presence of a significant fraction of ionised species increases the mobility of protons , which can hop from molecule to molecule in a grotthuss - like fashion .",
    "even though pimd ( and particularly the heavily - thermostatted piglet method ) does not allow us to make quantitative statements about how quantum effects enhance proton mobility , one can clearly see that by the end of our quantum simulation a significant fraction of the protons has been exchanged between water molecules ( see figure  [ fig : colors ] ) . on the contrary , in the classical case",
    "all the water molecules maintain their chemical identity thoughout our simulation .",
    "using an approximate quantum dynamics technique such as rpmd  @xcite or cmd  @xcite to study the dynamics in high pressure water would be an interesting future application of  i - pi .",
    "in this paper we have introduced i - pi , a python interface designed to facilitate including nuclear quantum effects in _ ab initio _ path integral molecular dynamics simulations .",
    "our program delegates the calculation of the potential , forces and virial tensor to an external code , keeping the electronic structure calculation and the propagation of the nuclear dynamics separate .",
    "communication between the codes is achieved using internet sockets , which exchange just the essential information , thereby minimising the number of modifications that have to be made to the _ ab initio _ client .",
    "i - pi implements the most recent developments in path integral simulation technology , including correlated - noise methods that accelerate the convergence with respect to the number of beads , and an implementation of _ npt _ pimd based on stochastic thermostatting .",
    "we have demonstrated the potential of i - pi with an application to the _ ab initio _ simulation of high - pressure water .",
    "our simulations with classical nuclei are consistent with previous simulations  @xcite , performed at a similar thermodynamic state point and using similar computational details for the electronic structure .",
    "however , our results show that even at a temperature as high as 750  k nuclear quantum effects play an important role in determining the behaviour of water .",
    "the concentration of ionised species  as defined by a simple geometric criterion  is increased by more than an order of magnitude when one treats the nuclei as quantum particles .",
    "we have characterised the nature of these charged species , observing that in the vast majority of cases they correspond to fluctuations of a proton along a compressed hydrogen bond , giving rise to a transient contact pair rather than to well - separated , solvated charges .",
    "nevertheless , at the high ionic concentrations ( more than 1  % ) observed in quantum simulations , a smaller fraction of these fluctuations leads to long - range separation of ionised species , and to effective transport and exchange of protons across the hydrogen - bond network , which is observed in classical simulations only at a much higher pressure  @xcite .",
    "these results and those of many other recent studies are leading to an increasing body of evidence that it is desirable ( and in some cases even essential ) to include nuclear quantum effects in molecular dynamics simulations if one wants to obtain a realistic description of systems containing hydrogen atoms .",
    "the inclusion of quantum effects certainly entails a computational overhead , but recent methodological developments that combine path integrals with correlated - noise , generalized langevin dynamics have reduced this overhead considerably .",
    "we envisage that the introduction of i - pi will make these new techniques more readily accessible , and thereby encourage the more routine inclusion of nqes in _ ab initio _ molecular dynamics simulations .",
    "the modular nature of i - pi should also ensure that further methodological developments will be easy to incorporate , so that communities that use a diverse variety of electronic structure programs can be kept up - to - date with the field .",
    "we would like to thank the early adopters of i - pi , including j. cuny , e. davidson , r. distasio , d. donadio , f. giberti , a. hassanali , t. markland , m. rossi , b. santra , d. selassie , t. spura , l. wang , and d. wilkins , who have helped immensely debugging the code and testing it on a variety of problems .",
    "a special thanks goes to a. michaelides , who helped us to decide an acronym for the interface .",
    "we also acknowledge generous allocations of computer time from cscs ( project i d s338 ) and the oxford supercomputing centre , and funding from the eu marie curie ief no .",
    "pief- ga-2010 - 272402 , the wolfson foundation and the royal society .",
    "s.  habershon , d.  e. manolopoulos , t.  e. markland , t.  f. miller , ring - polymer molecular dynamics : quantum effects in chemical dynamics from classical trajectories in an extended phase space . , annual review of physical chemistry 64 ( 2013 ) 387413 .",
    "j.  cao , g.  a. voth , the formulation of quantum statistical mechanics based on the feynman path centroid density .",
    "algorithms for centroid molecular dynamics , j. chem .",
    ". 101  ( 7 ) ( 1994 ) 61686183 .",
    "j.  schmidt , j.  vandevondele , i .-",
    "w. kuo , d.  sebastiani , j.  i. siepmann , j.  hutter , c.  j. mundy , isobaric - isothermal molecular dynamics simulations utilizing density functional theory : an assessment of the structure and density of water at near - ambient conditions . ,",
    "chem .. b 113  ( 35 ) ( 2009 ) 1195964 .",
    "s.  grimme , j.  antony , s.  ehrlich , h.  krieg , a consistent and accurate ab initio parametrization of density functional dispersion correction ( dft - d ) for the 94 elements h - pu . ,",
    "132  ( 15 ) ( 2010 ) 154104 ."
  ],
  "abstract_text": [
    "<S> recent developments in path integral methodology have significantly reduced the computational expense of including quantum mechanical effects in the nuclear motion in _ ab initio _ molecular dynamics simulations . </S>",
    "<S> however , the implementation of these developments requires a considerable programming effort , which has hindered their adoption . here </S>",
    "<S> we describe i - pi , an interface written in python that has been designed to minimise the effort required to bring state - of - the - art path integral techniques to an electronic structure program . </S>",
    "<S> while it is best suited to first principles calculations and path integral molecular dynamics , i - pi can also be used to perform classical molecular dynamics simulations , and can just as easily be interfaced with an empirical forcefield code . to give just one example of the many potential applications of the interface , we use it in conjunction with the cp2k electronic structure package to showcase the importance of nuclear quantum effects in high pressure water .    </S>",
    "<S> path integral , molecular dynamics , _ ab initio _ </S>"
  ]
}