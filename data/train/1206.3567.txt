{
  "article_text": [
    "as stars are the most fundamental elements in the universe , their formation is one of the longstanding key topics in astrophysics . because of its complicated nature and observational difficulties , computational simulations have played crucial roles in this field .",
    "@xcite first showed the scenario from molecular cloud cores to protostellar cores with one dimensional hydrodynamic simulations using the diffusion approximation for radiation transfer , and found that two remarkable quasi - hydrostatic objects are formed in the course of protostellar collapse .",
    "a molecular cloud core initially collapses almost isothermally because thermal emission from dust grains is efficient in this phase .",
    "the gas temperature starts to rise when the central region gets dense and radiation cooling becomes inefficient , then the collapse almost stops and a quasi - hydrostatic object forms .",
    "this object , a so - called first ( hydrostatic ) core , evolves through accretion from the envelope .",
    "when the central temperature reaches about 2,000 k where hydrogen molecules start to dissociate , the core becomes unstable and collapses again because @xmath0 dissociation is strongly endothermic and its gas pressure fails to balance gravity .",
    "this second collapse ends when molecular hydrogen dissociates completely and another quasi - static object is formed .",
    "this is the second core or the protostellar core .",
    "it acquires its mass via accretion on the dynamical timescale of the natal cloud core and evolves into a protostar and eventually a main - sequence star .",
    "more sophisticated simulations have been performed @xcite and the scenario of protostellar collapse under spherical symmetry is by now well established .",
    "however , there is non - negligible internal motion ( i.e. , rotation and turbulence ) in molecular cloud cores which makes the collapse completely different from the spherically - symmetric models . because centrifugal force is typically strong enough to prevent formation of stars (  the angular momentum problem \" ) , there must be sufficiently effective mechanisms of angular momentum transport .",
    "gravitational torque via non - axisymmetric structure like spiral arms takes this role if magnetic fields are very weak . @xcite",
    "first performed 3d smoothed particle hydrodynamics ( sph ) simulations and showed that gravitational torque redistributes angular momentum sufficiently and enables formation of protostellar cores . on the other hand , @xcite showed that magnetic fields transport angular momentum far more efficiently via torsional alfvn waves ( so - called magnetic braking , @xcite ) and bipolar outflows using two - dimensional mhd simulations .",
    "@xcite performed three - dimensional nested - grid mhd simulations of similar situations and investigated the condition for fragmentation in the early phase before the second collapse begins .",
    "@xcite investigated the evolution after the second collapse and showed that two different outflows are launched from the first core and the protostellar core .",
    "more detailed 3d simulations on this problem have been performed @xcite and effects of many physical ingredients such as misaligned magnetic fields @xcite , metallicities @xcite and turbulence @xcite , have been investigated .",
    "even weak magnetic fields can transport angular momentum very efficiently and modify the structure of the accretion flow significantly , and observations suggest that molecular clouds are considerably magnetized @xcite .",
    "therefore , magnetic fields are likely to play dominant roles in typical present - day environments .",
    "non - ideal mhd effects are also important in protostellar collapse .",
    "typical magnetic flux in a molecular cloud core is far larger compared to that in a formed star , which means that there must be significant redistribution of magnetic flux during collapse .",
    "moreover , @xcite claimed that rotationally - supported circumstellar disks are difficult to form in magnetized molecular cloud cores because the angular momentum transport due to magnetic fields is too efficient (  the magnetic braking catastrophe \" , see also @xcite ) .",
    "non - ideal mhd effects such as ohmic dissipation and ambipolar diffusion are supposed to be responsible in this process , because the ionization degree in star forming clouds is very low .",
    "ohmic dissipation redistributes sufficient magnetic flux outward from the centrally - condensed high density region and enables formation of circumstellar disks in the vicinity of protostars @xcite .",
    "gravitational torque becomes important in transporting angular momentum where magnetic fields are significantly weakened @xcite .    in those previous multi - dimensional simulations",
    ", they adopted the barotropic approximation for gas thermodynamics in which the thermal evolution is approximated with simple polytropic relations mimicking the results of 1d rhd simulations ( e.g. , * ? ? ?",
    "* ) , instead of solving radiation transfer .",
    "recently , @xcite ( see also * ? ? ?",
    "* ) reported 3d sph rhd simulations of formation of protostellar cores .",
    "@xcite also performed similar calculations of protostellar collapse using 2d axisymmetric rhd simulations .",
    "they commonly found interesting phenomena happen when the protostellar cores are formed ; bipolar outflows are launched from the disk - like first cores via radiation heating ( not radiation force ) from the protostellar cores .",
    "considering the energy released in the second collapse and subsequent accretion onto the protostellar core , the irradiation is sufficient to heat up the gas in the first core and launch the outflows @xcite .",
    "the barotropic approximation can not reproduce such outflows driven by radiation heating .",
    "the structure of the first core which depends on the angular momentum distribution seems to be important in this phenomenon , and in the extreme case , the first core is almost blown up @xcite .",
    "such violent phenomena may affect the story of protostellar collapse , circumstellar disk formation , and evolution of protostars .",
    "thus both magnetic fields and radiation transfer are critically important in star formation processes . @xcite and @xcite independently performed 3d rmhd simulations of protostellar collapse , but both stopped their calculations before the onset of the second collapse and they adopted the ideal mhd approximation . in this work , we report the first 3d rmhd simulations of protostellar collapse from molecular cloud cores to protostellar cores with and without ohmic dissipation . to follow the evolution after the second collapse , we adopt a realistic equation of state ( eos ) which takes chemical reactions into account . the goal of this study is to describe the realistic evolution in the early phase of protostellar collapse ( i.e. , until protostellar cores are formed ) involving both radiation transfer and magnetic fields .",
    "the plan of this paper is as follows : we describe the basic equations in section 2 .",
    "the adopted numerical methods are given in section 3 and the simulation setups in section 4 .",
    "we show the results of our 3d rmhd simulations in section 5 .",
    "section 6 is devoted to conclusions and discussions . in the appendices ,",
    "we explain the microphysical processes considered in our simulations .",
    "in this work , we solve system equations including mhd , self - gravity , radiation transfer , a realistic eos , and ohmic dissipation .",
    "we use the comoving - frame rhd equations in which all the radiation related variables are defined in the comoving frame of the local fluid element @xcite . for simplicity and to reduce computational load , we adopt the gray approximation ( using frequency - averaged equations assuming the local thermodynamic equilibrium ) and the flux limited diffusion approximation ( fld , * ? ? ?",
    "* ; * ? ? ?",
    "* ) for radiation transfer .",
    "we take ohmic dissipation into account as the first step because it is supposed to be the most significant in the context of magnetic flux loss from high density gas @xcite , although other non - ideal mhd effects such as ambipolar diffusion and hall effects are also important @xcite .",
    "the governing equations are as follows : @xmath1=-\\rho\\nabla\\phi+\\frac{\\sigma_r}{c}\\mathbf{f}_r,\\\\ \\frac{\\partial\\mathbf{b}}{\\partial t}-\\nabla\\times(\\mathbf{v}\\times\\mathbf{b}-\\eta\\nabla\\times\\mathbf{b})=0,\\label{induction}\\\\ \\nabla\\cdot\\mathbf{b}=0,\\label{sole}\\\\ \\frac{\\partial e}{\\partial t}+\\nabla\\cdot\\left[\\left(e+p+\\frac{1}{2}|\\mathbf{b}|^2\\right)\\mathbf{v}-\\mathbf{b}(\\mathbf{v}\\cdot\\mathbf{b})-\\eta\\mathbf{b}\\times(\\nabla\\times\\mathbf{b})\\right]=\\nonumber\\\\ -\\rho\\mathbf{v}\\cdot\\nabla\\phi - c\\sigma_p(a_r t_g^4-e_r)+\\frac{\\sigma_r}{c}\\mathbf{f}_r\\cdot\\mathbf{v},\\label{energy}\\\\ \\nabla^2\\phi=4\\pi g\\rho,\\\\ \\frac{\\partial e_r}{\\partial t}+\\nabla\\cdot[\\mathbf{v}e_r]+\\nabla\\cdot\\mathbf{f}_r+\\mathbb{p}_r:\\nabla\\mathbf{v}=c\\sigma_p(a_r t_g^4 -e_r),\\\\ \\mathbf{f}_r=\\frac{c\\lambda}{\\sigma_r}\\nabla e_r,\\hspace{1em }",
    "\\lambda(r)=\\frac{2+r}{6 + 2r+r^2},\\hspace{1em } r=\\frac{|\\nabla e_r|}{\\sigma_r e_r},\\nonumber\\\\ \\mathbb{p}_r=\\mathbb{d}e_r,\\hspace{1em } \\mathbb{d}=\\frac{1-\\chi}{2}\\mathbb{i}+\\frac{3\\chi-1}{2}\\mathbf{n}\\otimes \\mathbf{n},\\hspace{1em } \\chi=\\lambda+\\lambda^2r^2,\\hspace{1em } \\mathbf{n}=\\frac{\\nabla e_r}{|\\nabla e_r|}\\nonumber,\\label{end}\\end{aligned}\\ ] ] where @xmath2 denotes the gas density , @xmath3 the fluid velocity , @xmath4 the magnetic flux density , @xmath5 the gas pressure , @xmath6 the gas temperature , @xmath7 the total gas energy density ( @xmath8 is the internal energy density of the gas ) , @xmath9 the radiation energy density , @xmath10 the gravitational potential , @xmath11 the radiation energy flux , and @xmath12 the radiation pressure tensor , respectively .",
    "@xmath13 is the speed of light and @xmath14 is the gravitational constant .",
    "@xmath15 is the radiation ( density ) constant where @xmath16 is the stefan - boltzmann constant .",
    "@xmath17 is the resistivity and @xmath18 ( @xmath19 ) is the rosseland ( planck ) mean opacity .",
    "@xmath20 denotes the unit matrix .  : \" means the double dot product of two tensors , @xmath21 .",
    "these equations represent conservation of mass , the equation of motion , the induction equation including ohmic dissipation , the solenoidal constraint , the poisson s equation of gravity , and the gray fld radiation transfer equations from top to bottom .",
    "basically we use the gaussian cgs units but we rescale the magnetic flux density to eliminate the constant coefficients , i.e. , @xmath22 where @xmath23 is given in gauss . additionally , we need an eos which gives the relations between the thermodynamic variables @xmath24 and @xmath8 to close the system .",
    "we adopt the tabulated eos in which we consider internal degrees of freedom and chemical reactions of seven species ( @xmath25 and @xmath26 ) . here",
    "we assume the solar abundance , @xmath27 and @xmath28 .",
    "we also adopt the tabulated tables of the rosseland and planck mean opacities . in order to cover the huge dynamic range ,",
    "we combine three opacity tables : @xcite , @xcite and @xcite .",
    "the resistivity is adopted from @xcite , while we additionally consider thermal ionization of potassium ( k ) .",
    "the detailed descriptions about these microphysical processes are given in appendices .",
    "note that @xcite simplified the resistive term in eq .",
    "[ induction ] to @xmath29 , but it is inadequate because the resistivity @xmath17 has large spatial gradient according to the local gas density and temperature gradients , and what is worse , it violates the divergence free condition ( eq .",
    "[ sole ] ) . in this work",
    "we correctly discretize the original equation , and also includes the effect of the resistivity in the energy equation ( eq .  [ energy ] ) .",
    "in order to solve the complex system described in the previous section , we divide the system into five parts and solve them separately on the nested - grid hierarchy .",
    "we update our system in the following strategy :    * step 1 .",
    "ideal mhd part : * @xmath30&=&0,\\\\ \\frac{\\partial\\mathbf{b}}{\\partial t}-\\nabla\\times(\\mathbf{v}\\times\\mathbf{b})&=&0,\\\\ \\nabla\\cdot\\mathbf{b}&=&0,\\\\ \\frac{\\partial e}{\\partial t}+\\nabla\\cdot\\left[\\left(e+p+\\frac{1}{2}|\\mathbf{b}|^2\\right)\\mathbf{v}-\\mathbf{b}(\\mathbf{v}\\cdot\\mathbf{b})\\right]&=&0,\\label{mhde}\\\\ \\frac{\\partial e_r}{\\partial t}+\\nabla\\cdot[\\mathbf{v}e_r]&=&0 . \\label{advf}\\end{aligned}\\ ] ] * step 2",
    ". self - gravity part : * @xmath31 * step 3 .",
    "resistivity part : * @xmath32&=&0.\\label{md2}\\end{aligned}\\ ] ] * step 4 .",
    "radiation part : * @xmath33 * step 5 .",
    "radiation force part : * @xmath34    introducing such an operator - splitting technique causes loss of time - accuracy , and the overall accuracy of our time - integration scheme is first order .",
    "we solve the mhd system using the hlld approximate riemann solver @xcite .",
    "it is suitable for simulations involving the realistic eos because this scheme does not require the detailed knowledge about the eos , unlike roe s approximate riemann solver .",
    "it is simple , robust , highly efficient , and almost as accurate as roe s solver .",
    "we define all the variables at the cell center . to numerically satisfy the solenoidal constraint ( [ sole ] )",
    ", we adopt the mixed correction based on the generalized lagrangian multiplier approach proposed by @xcite . to achieve second - order accuracy in space and time ,",
    "we adopt standard muscl ( monotone upstream - centered scheme for conservation laws ) approach and the directionally - unsplit two - step predictor - corrector scheme ( e.g. , * ? ? ?",
    "we store ( @xmath2 , @xmath3 , @xmath4 , @xmath8 , @xmath35 , @xmath9 ) as primitive variables and interpolate them for spatial reconstruction with the minmod slope limiter for robustness ( @xmath35 is an additional variable related to the solenoidal constraint ) . we use the gas internal energy @xmath8 as the primitive variable instead of the gas pressure @xmath5 which is the textbook notation in order to minimize the numerical error when we use the tabulated eos .",
    "that is , the discretization error of the eos table will be directly reflected in the results if we perform mutual conversions between @xmath5 and @xmath8 ( i.e. , @xmath36 ) .",
    "we can avoid this error if we use one - way conversion ( @xmath37 ) only ; the discretization error only affects the flux and its effect is small .",
    "some high resolution ( magneto- ) hydrodynamic solvers show strange oscillations at strong shocks aligned to grid structure .",
    "this problem called the carbuncle phenomenon is obviously unphysical . to suppress this unphysical oscillation",
    ", we use the hlld@xmath38 flux developed by @xcite in the cells which potentially contain shocks .",
    "we adopt the method proposed in @xcite to identify such cells .",
    "hlld@xmath38 is a modified version of hlld , in which the tangential velocities ( @xmath39 ) in the riemann fan are replaced by the hll averages while other variables are kept the same as hlld .",
    "sufficient but not too large additional shear viscosity is introduced by this procedure and it stabilizes the carbuncle phenomenon .",
    "we update the advective flux of radiation energy ( [ advf ] ) separately using roe s upwind method .",
    "when the radiation energy dominates the gas energy , the radiation pressure affects the sonic speed of the gas and the characteristics are modified , but we neglect this effect . in our star formation simulations",
    "( at least in low mass cases ) , we expect that we encounter such a radiation dominant region only in the deep interior of the protostellar core in the late phase of protostellar collapse , and we do not expect this effect will be significant .    to solve the poisson s equation ( [ poisson ] ) on the nested - grid hierarchy , we adopt the multigrid solver developed by @xcite .",
    "the solver gives second - order accurate solution in space .",
    "we integrate ( [ grv1 ] ) and ( [ grv2 ] ) using obtained gravitational potential .      because of the low ionization degree , non - ideal mhd effects such as ohmic dissipation , ambipolar diffusion and the hall effect work during protostellar collapse .",
    "ohmic dissipation becomes dominant in the high density region ( typically @xmath40 ) and ambipolar diffusion dominates in the low density region @xcite , but in this work we focus on ohmic dissipation as the first step because it is supposed to be most significant in the context of the magnetic flux problem and the angular momentum problem @xcite . taking account of ambipolar diffusion will be a future work .",
    "the timescale of ohmic dissipation becomes shorter than the dynamical timescale in the high density region ( @xmath41 , figure  [ resist ] ) and significant diffusion of magnetic flux occurs @xcite .",
    "note that these non - ideal mhd processes do not reduce total magnetic flux but redistribute centrally - concentrated magnetic flux outward from the high density region ( see below , figure  [ fmr ] ) , although this process is often mentioned as `` magnetic flux loss '' .",
    "we discretize ( [ md1 ] ) and ( [ md2 ] ) in the same way as @xcite . additionally , we introduce the correction terms proportional to @xmath42 to improve the nature of the system as described in @xcite .",
    "since the timescale of the diffusion of magnetic fields can be far shorter than the dynamical timescale ( figure  [ resist ] ) , here we adopt the super - time - stepping ( sts ) method proposed by @xcite ( for astrophysical applications , see @xcite ) when the timestep for the resistivity part is shorter than the hydrodynamic timestep .",
    "sts is constructed based on the simple explicit scheme , but we can relax the courant - friedrich - levy ( cfl ) stability condition by using the following sequence of sub - timesteps : @xmath43^{-1}.\\label{sts1}\\end{aligned}\\ ] ] the longer time integration of @xmath44 is achieved after @xmath45 sub - timesteps , @xmath46,\\label{sts2}\\end{aligned}\\ ] ] where @xmath47 is the explicit timestep which satisfies the cfl condition and @xmath48 is a small positive parameter which controls the stability and efficiency of the scheme . smaller @xmath48 gives better acceleration but sts may give unphysical results when it is too small .",
    "the optimal choice of @xmath48 depends on the problem , but typically @xmath49 seems to be good for parabolic problems . from ( [ sts2 ] ) , the maximum acceleration for given @xmath48 compared to the explicit scheme ( @xmath50 ) is @xmath51 and the most efficient calculation is realized around @xmath52 . in this work ,",
    "we adopt @xmath53 and @xmath54 .",
    "we apply this scheme repeatedly until required time update is achieved . even in the most time - consuming situation ( i.e.",
    ", the magnetic reynolds number is very low , @xmath55 ) in our production runs , sts keeps the computational cost lower than or similar to the total of all the other parts ( including mhd , self - gravity and radiation transfer ) at most .      the timescale related to radiation can be far shorter than that related to hydrodynamics in star formation simulations .",
    "the lightspeed @xmath13 is far larger than typical fluid velocity in star formation , which is on the order of ( @xmath56  @xmath57 .",
    "moreover , the radiation source terms are strongly non - linear",
    ". therefore the differential equations of the radiation subsystem can be very stiff .",
    "it is unreasonable to calculate such a system using explicit schemes or even sts .",
    "therefore we adopt an implicit time - integration scheme which is stable regardless of the timescale of involved physical processes .",
    "we adopt the first - order backward euler method which is simple and stable .",
    "here we discretize ( [ flds ] ) and ( [ fld2 ] ) in one - dimension ( extension to multi - dimension is straightforward ) as follows : @xmath58,\\label{rhdd1}\\\\ \\frac{e_{r , i}^{n+1}-e_{r , i}^n}{\\delta t}&-&\\frac{1}{\\delta x}\\left[\\left(\\frac{c\\lambda}{\\sigma_r}\\right)_{i+\\frac{1}{2}}^n \\frac{e_{r , i+1}^{n+1}-e_{r , i}^{n+1}}{\\delta x}-\\left(\\frac{c\\lambda}{\\sigma_r}\\right)_{i-\\frac{1}{2}}^n \\frac{e_{r , i}^{n+1}-e_{r , i-1}^{n+1}}{\\delta x}\\right]\\nonumber \\\\ & = & c\\sigma_p^n \\left[a_r \\left(t_{g , i}^{n+1}\\right)^4-e_{r , i}^{n+1}\\right]-\\mathbb{p}_{r , i}^{n+1}:(\\nabla\\mathbf{v})_i.\\label{rhdd2}\\end{aligned}\\ ] ] superscripts and subscripts denote the indices of the discretized time and space , respectively .",
    "to avoid numerical difficulties due to strong non - linearity in the flux limiter and the opacities and to achieve stable integration , we adopt the time - lagged opacities and flux limiter @xcite .",
    "this may cause loss of the time accuracy of the scheme , but we confirmed that it does not matter in our production runs because the timescale of the evolution of radiation fields is similar to the hydrodynamic timescale and therefore well resolved .",
    "we also use the time - lagged eddington tensor @xmath59 , which yields the radiation energy tensor @xmath60 .",
    "there are some ways to evaluate the opacities and the flux limiter at the cell interfaces , @xmath61 . here",
    "we follow @xcite and adopt the surface formula which gives good flux even at a sharp surface of optically thick material like the surface of a first core .",
    "@xmath62.\\end{aligned}\\ ] ] we evaluate the flux limiter at the cell interface @xmath63 using the following equations : @xmath64 in three dimensions , the radiation energy gradient should be replaced with @xmath65      to solve the non - linear system ( [ rhdd1 ] ) and ( [ rhdd2 ] ) , we perform the newton - raphson iterations @xcite . in this method , we search for the zero - points of the residual functions @xmath66 .",
    "we can find the root iteratively using the following matrix equation based on the taylor expansion : @xmath67 in our system , @xmath68 is the vector of the gas and radiation energy densities in all the cells : @xmath69 the residual functions are given from ( [ rhdd1 ] ) and ( [ rhdd2 ] ) as follows : @xmath70,\\\\ f^r_i&=&e_{r , i}^{n+1}-e_{r , i}^n+\\delta",
    "t\\bigl[\\frac{1}{\\delta x}\\left\\{\\left(\\frac{c\\lambda}{\\sigma_r}\\right)_{i+\\frac{1}{2}}^n\\frac{e_{r , i+1}^{n+1}-e_{r , i}^{n+1}}{\\delta x}-\\left(\\frac{c\\lambda}{\\sigma_r}\\right)_{i-\\frac{1}{2}}^n\\frac{e_{r , i}^{n+1}-e_{r , i-1}^{n+1}}{\\delta x}\\right\\}\\nonumber\\\\ & & -c\\sigma_p^n \\left[a_r \\left\\{t_g(\\rho_i , e_{g , i}^{n+1})\\right\\}^4-e_{r , i}^{n+1}\\right]+\\left\\{\\mathbb{d}_i^n:(\\nabla\\mathbf{v})_i\\right\\}e_{r , i}^{n+1}\\bigr].\\end{aligned}\\ ] ] we can rewrite ( [ nrm ] ) explicitly : @xmath71 by substituting ( [ nri1 ] ) into ( [ nri2 ] ) , we can eliminate the equation related to gas energy @xcite ( this procedure corresponds to performing partial lu decomposition analytically ) .",
    "then we obtain the matrix equation : @xmath72 the derivatives are given as follows : @xmath73 ^ 3\\frac{\\partial t_g}{\\partial e_{g}}(\\rho_i , e_{g , i}^{n+1 } ) , \\\\ \\frac{\\partial f_i^g}{\\partial e_{r , i}^{n+1}}&=&-\\delta t\\ , c \\sigma_p^n , \\\\",
    "\\frac{\\partial f_i^r}{\\partial e_{g , i}^{n+1}}&=&-4\\delta t\\ , c\\sigma_p^n a_r   [ t_g(\\rho_i , e_{g , i}^{n+1})]^3\\frac{\\partial t_g}{\\partial e_{g}}(\\rho_i , e_{g , i}^{n+1}),\\\\ \\frac{\\partial f_i^r}{\\partial e_{r , i}^{n+1}}&=&1+\\delta t \\left[c",
    "\\sigma_p^n + \\mathbb{d}_i^n:(\\nabla\\mathbf{v})_i -\\frac{c}{\\delta x^2}\\left\\{\\left(\\frac{\\lambda}{\\sigma_r}\\right)_{i+\\frac{1}{2}}^n+\\left(\\frac{\\lambda}{\\sigma_r}\\right)_{i-\\frac{1}{2}}^n\\right\\}\\right],\\\\ \\frac{\\partial f_i^r}{\\partial e_{r , i\\pm 1}^{n+1}}&=&\\frac{c\\delta t}{\\delta x^2}\\left(\\frac{\\lambda}{\\sigma_r}\\right)_{i\\pm\\frac{1}{2}}^n.\\end{aligned}\\ ] ] @xmath74 and @xmath75 are given from the tabulated eos .",
    "note that this jacobi matrix is symmetric .",
    "we can obtain the solution by updating @xmath76 and @xmath77 using @xmath78 and @xmath79 calculated from ( [ nrif ] ) and ( [ nri1 ] ) until @xmath80 and @xmath81 become sufficiently small . as the initial guess for @xmath82 and @xmath83 , we adopt the solution at the timestep @xmath84 . in our simulations",
    ", we use convergence thresholds like @xmath85 and @xmath86 .",
    "if these thresholds are not satisfied after many iterations , we take substeps with shorter @xmath87 and try again until we obtain the converged solution successfully .      in three dimensional cartesian coordinate , the jacobi matrix in ( [ nrif ] )",
    "is a very large sparse seven - diagonal matrix . moreover , because of the strong nonlinearity of the system , the matrix is not necessarily diagonally dominant .",
    "therefore we need an efficient and robust sparse matrix solver and extensive computational resources to solve this large ( typically @xmath88 cells per grid level ) linear system .",
    "we found that the combination of the bicgstab ( stabilized bi - conjugate gradient ) solver and the incomplete lu ( ilu ) decomposition preconditioner without fill - in works well for our problems .",
    "we simply integrate the radiation force terms in step 5 using the obtained solution in step 4 .",
    "these terms are relatively small , at least in the early phase of low - mass star formation processes .      in order to achieve the huge dynamic range required in protostellar collapse simulations ,",
    "we adopt the three dimensional nested - grid technique @xcite .",
    "this is a simplified version of the adaptive mesh refinement ( amr ) technique .",
    "each grid level consists of @xmath89 cubic cells .",
    "the number of the cells in one direction @xmath90 must be a power of 2 .",
    "the finer grid is placed around the center of the coarser grid self - similarly .",
    "the size of a finer cell is half of that of a coarser cell .",
    "we number the levels from coarsest to finest : @xmath91 .",
    "we calculate the coarsest grid @xmath92 first and then proceed to finer grid levels because we require the boundary conditions at the next timestep in the implicit update .",
    "we update all the grid levels in each step described in [ os ] .",
    "the timestep is determined by the courant - friedrich - levy ( cfl ) criterion derived for the mhd part .",
    "all the grids share this common timestep and are advanced synchronously .",
    "we adopt so - called jeans condition proposed by @xcite ( see also @xcite ) for refinement ; we generate a finer grid to resolve the minimum jeans length with 16 cells .    for the mhd and resistivity parts , we apply the standard procedures to the boundaries between the levels of different resolution .",
    "that is , when we update a level @xmath93 , we construct the boundaries from the coarse level @xmath94 using time and spatial interpolation . for the spatial interpolation",
    ", we adopt linear interpolation with a slope limiter to assure the monotonicity . after updating all the levels , we transfer the results in the overlapped regions from the finer grid to the coarser grid using conserved variables and recalculate the flux in the coarser level @xmath94 using the obtained flux in the finer level @xmath93 , conserving the total flux across the level boundaries .",
    "the implicit time integration for the radiation transport on the nested grids is more tricky . because all the cells among the whole grid levels interact with each other in a single timestep in the implicit scheme , in principle we should integrate all the levels at the same time treating them like one huge non - uniform grid .",
    "however , it makes the jacobian matrix irregular and complicated , and the computational costs can be very expensive because a huge number of cells are involved in the integration .",
    "therefore we solve each grid separately as we do in the mhd part .",
    "this enables us to adopt computational algorithms highly optimized for regular sparse matrices .",
    "when we update a grid level @xmath93 , we treat it as a uniform grid .",
    "the boundary conditions at the next timestep are constructed using linear spatial interpolation from the coarser grid which is already updated , and treated as fixed ( dirichlet ) boundaries . in ( [ flds ] ) and ( [ fld2 ] )",
    ", we need to estimate the internal energy and temperature , rather than the total energy .",
    "we use the total energy for grid interaction in the mhd part , but it causes artificial thermalization of the internal dispersion of fluid motion and magnetic fields resulting in unphysically high entropy and temperature in the region overlapped with the finer grids . to avoid this",
    ", we take the temperature average of the nearest eight cells in the overlapped finest levels and calculate the internal energy using the gas density and the averaged temperature . for consistency between the gas and radiation",
    ", we also take the radiation temperature averaged over the nearest eight cells in the finest level .",
    "these procedures violate conservation of the total energy , but in the diffusion approximation it is more important to properly estimate the temperature at the cell center and its gradient , rather than the total energy . and its effects are kept small because we overwrite the overlapped regions with the results obtained in the finer levels at the end of every timestep , which satisfy the local conservation laws .",
    "we only consider the interaction between the coarse and fine levels at the level boundaries in our implicit scheme on the nested grids , but it may cause the loss of consistency and accuracy . in our production runs , we confirmed that this treatment only causes minor discrepancies between the grid levels in the extremely optically - thin regions . because we are mainly interested in the evolution of the condensed objects , we can tolerate these errors .      as the outer - most boundary conditions for the magnetohydrodynamics and radiation parts",
    ", we set all the cells outside the initial bonnor - ebert sphere to maintain their initial values , mimicking an isolated molecular cloud core confined in a static environment .",
    "for the poisson s equation of self - gravity , we compute the gravitational potential of the isolated system at the boundaries by the multi - pole expansion @xcite .",
    "our boundary conditions allow the gas to inflow into the computational domain through the boundaries , but the inflowing mass during the simulation is sufficiently smaller than that of the total mass of the initial cloud , about 8% in all the models .",
    "we use unstable bonnor - ebert ( * ? ? ?",
    "* ; * ? ? ?",
    "* hereafter be ) spheres of @xmath95as the initial conditions of our simulations , mimicking isolated molecular cloud cores .",
    "we construct a critical be sphere ( with a dimension less radius of @xmath96 ) and make it unstable by increasing the gas density by a factor of @xmath97",
    ". then we introduce uniform ( rigid - body ) rotation , uniform magnetic fields and @xmath98 density perturbation , where @xmath99 is the number of longitudinal modes .",
    "the initial density profile is given as follows : @xmath100,\\end{aligned}\\ ] ] where @xmath101 is the gas density at the center of the cloud core , @xmath102 the normalized density profile of the critical be sphere , @xmath103 the radius of the critical be sphere , @xmath104 the amplitude of @xmath98 perturbation , respectively . in order to minimize the effect of initial resolution , we adopt this  regularized \" @xmath98 perturbation which is smooth at the center of the cloud in contrast to @xcite .",
    "in this work , we adopt @xmath105 and @xmath106 , which yield an unstable be - like sphere whose mass and radius are @xmath107 and @xmath108 .",
    "the initial free fall time at the center of the cloud is @xmath109 .",
    "we calculated a spherically symmetric model and four magnetized rotating models with and without ohmic dissipation ; the parameters of the models are summarized in table  [ models ] .",
    "the first letter of the model name denotes the treatment of magnetic fields : _ i _ denotes an ideal mhd model and _ r _ a resistive mhd model .",
    "the second letter represents the initial rotation speed : _ f _ is fast and _ s _ is slow .",
    "note that we choose these parameters so that the first core disks do not fragment before the second collapse because of the limitation of our nested - grids .",
    "sp _ is the spherical model without rotation and magnetic fields . for magnetized models , we impose the uniform magnetic fields of @xmath110 parallel to the rotation axis .",
    "the corresponding mass - to - flux ratio normalized by the critical value of stability is @xmath111 where @xmath112 and @xmath113 .",
    "here we adopt the critical mass - to - flux ratio of @xcite but we should regard this value as just a guide because our initial conditions are not uniform .",
    "there is another similar threshold for stability between gravity and magnetization derived for disks @xcite ; we have @xmath114 at the center of the cloud , where @xmath115 .",
    "these mass - to - flux ratios indicate that our magnetized models are in the magnetically super - critical regime but considerably magnetized .",
    "we define the origin of time as the epoch of formation of the protostellar core , i.e. , when the central gas density exceeds @xmath116 for the first time , for descriptive purpose .",
    "we stop our simulations when the central temperature reaches @xmath117 .",
    "our simulations show the formation and earliest evolution of protostars .",
    "the typical spatial resolution around the surface of the first cores ( @xmath118 ) is @xmath119 and the finest resolution at the end of the simulations is @xmath120 .",
    "the nested - grid technique enables us to achieve such a huge spatial dynamic range of more than eight orders of magnitude .",
    ".summary of the initial model parameters . from left to right : the normalized angular velocity , the angular velocity , the magnetic field strength , the averaged mass - to - flux ratio , the local mass - to - flux ratio at the cloud center , the amplitude of @xmath98 perturbation and whether the resistivity is introduced or not .",
    "other parameters are common : @xmath121 , @xmath122 , @xmath123 and @xmath124 .",
    "see the text for details . [ cols=\"^,^,^,^,^,^,^,^,^\",options=\"header \" , ]",
    "we performed 3d nested - grid rmhd simulations of formation of protostellar cores from molecular cloud cores with and without ohmic dissipation , and revealed the earliest evolution ( only 1 year after the formation ) of the protostellar cores .",
    "these simulations are , to our knowledge , the first 3d rmhd simulations in the world following the whole evolution from molecular cloud cores to protostellar cores with realistic physics .",
    "we successfully revealed the realistic evolution in the early phase of protostellar collapse .",
    "preceding studies @xcite had showed that the barotropic approximation fails to reproduce the realistic thermal properties , and here we also revealed that the discrepancy is more prominent in the protostellar core phase , because the barotropic approximation does not take account of the shock heating and therefore tend to underestimate the temperature , which results in the smaller radii of the first and protostellar cores and can not reproduce the transient expansion of the protostellar cores . in order to capture the realistic thermal evolution ,",
    "rmhd simulations are thus essential .",
    "our results can be used as the initial and boundary conditions for the stellar evolution simulations ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "we found two qualitatively different phenomena between the ideal mhd models and the resistive mhd models : formation of circumstellar disks and outflows from protostellar cores . in the resistive models ,",
    "the circumstellar disks are quickly built up in the vicinity of the formed protostars .",
    "although the formed disks are still very small ( @xmath125 ) , we expect the disks will grow continuously as the gas with larger angular momentum accretes .",
    "@xcite performed resistive mhd simulations with the sink cell technique and the barotropic approximation and showed that the rotationally - supported disk grows to @xmath126 while the high density region where ohmic dissipation works expands as the disk grows .",
    "the two - component outflows are launched from different scales as the natural by - products : the slow loosely - collimated outflow driven from the first core and the fast well - collimated jet driven from the protostellar core .",
    "these are consistent with previous studies using the barotropic approximation @xcite .",
    "although the maximum velocity of the outflow is still not very fast ( @xmath127 ) , we expect that it will get faster as the protostellar core grows .",
    "meanwhile , we expect that the outflow from the first core is continuously driven from the outer disk , or the remnant of the first core until the accretion stops @xcite .",
    "if it is the case , our simulations can naturally explain the observed high - velocity jets , especially the multi - component outflows ( for example , * ? ? ?",
    "* ; * ? ? ?",
    "* ) . in the ideal mhd cases , on the other hand ,",
    "the protostellar cores are almost the same with the spherically symmetric case and no outflow is launched as a result of efficient magnetic braking .",
    "these results do not necessarily mean that circumstellar disks are never formed in ideal mhd simulations .",
    "the circumstellar disks and outflows may be formed later when the gas with large angular momentum accretes sufficiently , because the magnetic braking is not a process which reduces the total angular momentum but transports the angular momentum from the disk to the thin envelope within the molecular cloud via alfvn waves .",
    "to simulate such a system , long - term simulations with reasonable boundary conditions are required .    although  when and how circumstellar disks are formed ? \" is a crucial question , there has been no conclusive answer .",
    "our results suggest that a circumstellar disk is formed in the earliest phase of protostar evolution , essentially in parallel .",
    "@xcite suggested that class-0 sources ( young , embedded ) are associated with more massive disks than class - i sources , which support the early formation of circumstellar disks .",
    "we need more elaborate observations with higher spatial resolution to answer this question , and we expect the atacama large millimeter / submillimeter array ( alma ) will provide good clues to this problem",
    ".    in our simulations , the formation of the protostellar core does not affect the first core and outer envelope .",
    "considering the large energy released in the second collapse and subsequent accretion with the high accretion rate , we expect that the feedback like @xcite and @xcite reported may happen ; bipolar outflows may be launched by radiation heating from the protostellar core .",
    "there are two possible interpretations of the discrepancy : magnetic fields and duration of the simulations . because of the efficient angular momentum transport due to magnetic fields , the first cores are not supported by rotation even in the resistive models and the structures of the accretion flows are completely different between the models with and without magnetic fields .",
    "indeed , @xcite showed that the outflows are less energetic in the models with slower rotation",
    ". therefore magnetic fields possibly can prevent formation of such outflows driven by radiation heating from the protostellar cores .",
    "the other point is that we only calculate about 1 year after the protostellar core formation while @xcite and @xcite followed the evolution longer than 15 years . because 1 year is shorter than the free - fall time of the first core , the protostellar cores are still deeply obscured in the remnants of the first cores in our simulations .",
    "if this is the case , how long will it take for the feedback to become prominent ? as we mentioned above , the answer is the free - fall timescale of the first core , which is about 5 years .",
    "another interesting factor is the interaction between the first core and the outflow from the protostellar core .",
    "when the outflow from the protostellar core penetrates the first core , it will have some influence on the first core . assuming the constant traveling velocity of @xmath128 , it will reach the surface of the first core in about 1.5 years .",
    "unfortunately , it is almost hopeless to follow such a long evolution with our current code because the simulation timesteps are too small , less than 1 minute , and are still getting smaller . in order to perform the long - term simulations",
    ", we have to modify our code , for example , introducing the sink particle technique @xcite to replace the protostellar core with a subgrid stellar evolution model ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) . to construct reasonable subgrid models , our results can be used as templates . since the radiation feedback from the formed protostar can be highly anisotropic due to the small - scale optically - thick disk @xcite , high resolution down to the protostellar core scale is of crucial importance even when we introduce the sink particle and subgrid stellar evolution model .",
    "all the physical processes involved in this work play crucial roles in star formation processes .",
    "magnetic fields efficiently extract the angular momentum and drive the outflows from the first cores .",
    "ohmic dissipation suppresses the angular momentum transport which is too efficient in the ideal mhd models and enables the formation of the circumstellar disks and the fast outflows from the protostellar cores .",
    "the eos and radiation transfer give the realistic thermal evolution and enable us to discuss the dynamics and thermodynamics quantitatively , which can not be achieved with the barotropic approximation .",
    "we should note , however , that there is no established test for such a complicated system , although we tested each part of our code separately with standard tests . to verify the validity of the codes",
    ", we are planning to perform comparisons with other groups .",
    "+ we thank prof .",
    "matthew r. bate , prof .",
    "shu - ichiro inutsuka , prof .",
    "kazuyuki omukai and dr .",
    "takashi hosokawa for fruitful discussions .",
    "we also thank prof .",
    "james m. stone for reading the manuscript carefully .",
    "we are grateful to prof .",
    "masahiro ikoma for providing his notes on eos and dr .",
    "takahiro miyoshi for providing information about the hlld and hlld@xmath38 solvers .",
    "we also appreciate mr .",
    "richard b. reichart checking the manuscript and improving english .",
    "numerical computations were partly performed on nec sx-9 at center for computational astrophysics of national astronomical observatory of japan , at japan aerospace exploration agency and at osaka university .",
    "this work is partly supported by the ministry of education , culture , sports , science and technology ( mext ) , grants - in - aid for scientific research , 21244021 ( tomisaka ) and 23540270 ( matsumoto ) .",
    "k.  tomida , y.  hori and s.  okuzumi are supported by the research fellowship from the japan society for the promotion of science ( jsps ) .",
    "in some previous studies , the simple eos of perfect gas has been often used , i.e. , the adiabatic index @xmath129 is assumed to be a constant throughout simulations , @xmath130 which is valid for completely idealized diatomic molecular gas , or @xmath131 which is correct only when the gas temperature is very low .",
    "however , the adiabatic index is not constant in reality . in the low temperature molecular cloud ( @xmath132 )",
    ", molecular hydrogen behaves like monoatomic gas , @xmath133 , because the collisional energy is insufficient to excite the rotational degrees of freedom and only translations are excited .",
    "when the gas temperature exceeds @xmath134 , the rotational degrees start to be excited and contribute to the heat capacity .",
    "then the adiabatic index decreases , @xmath135 , close to that of the diatomic gas .",
    "the adiabatic index is of critical importance in the thermal evolution of the gas , and also in the stability of the gas against the gravitational instability @xcite ; the stiffer gas ( with larger @xmath129 ) is more stable gravitationally because it reacts more strongly against compression .",
    "therefore we need to consider these quantum thermodynamic behaviors in our eos .",
    "the second collapse is driven by the endothermic reaction of hydrogen molecule dissociation . in order to simulate the evolution in the second collapse phase , we need to take the chemical reactions into account .",
    "however , it requires quite a large computational cost to solve the network of chemical reactions in every fluid element while solving ( radiation ) hydrodynamics .",
    "fortunately , because we are mainly interested in dense gas , we can assume that the timescale of chemical reactions is shorter than the dynamical timescale .",
    "therefore we implement the chemical reactions related to major species within the eos on the assumption of the local thermodynamic and chemical equilibrium .",
    "we require some assumptions to calculate the eos for simplicity :    * the gas is in the local thermodynamic and chemical equilibrium ( except for the ortho / para ratio of molecular hydrogen ; see below ) . *",
    "all the atoms , molecules and ions are in the ground states . *",
    "the eos can be calculated by simple summation of each component and each degree of freedom , i.e. , the interactions between components and other non - ideal effects are neglected . *",
    "only seven major species ( @xmath25 and @xmath26 ) are considered and other elements are neglected .",
    "based on these assumptions , we calculate the eos using the statistical mechanics theory . here",
    "we also assume that the gas has the solar abundance , @xmath27 and @xmath28 .      here",
    "we describe partition functions of each element .",
    "the partition function of a species @xmath136 can be divided into five parts ; translation @xmath137 , rotation @xmath138 , vibration @xmath139 , spin @xmath140 and electron excitation @xmath141 ( we include contributions from @xmath0 dissociation and ionization of hydrogen and helium in the electron excitation part ) : @xmath142 where v is the volume .",
    "we calculate these partition functions by the standard procedure . in the following descriptions",
    ", @xmath143 denotes the mass of @xmath136-species , @xmath144 the planck constant and @xmath145 the boltzmann constant , respectively .",
    "the partition functions not explicitly described are unity .",
    "+ molecular hydrogen : @xmath146^{\\frac{3}{4}},\\\\ z_{\\rm rot , h_2}^{\\rm even}&=&\\sum_{j=0,2,4, ... }(2j+1)\\exp\\left[-\\frac{j(j+1)\\theta_{\\rm rot}}{2t}\\right],\\\\ z_{\\rm rot , h_2}^{\\rm odd}&=&\\sum_{j=1,3,5, ... }(2j+1)\\exp\\left[-\\frac{j(j+1)\\theta_{\\rm rot}}{2t}\\right],\\\\ z_{\\rm vib , h_2}&=&\\frac{1}{2\\sinh{(\\theta_{\\rm vib}/2t)}},\\\\ z_{\\rm spin , h_2}&=&\\left(2\\cdot \\frac{1}{2}+1\\right)^2=4,\\\\ z_{\\rm elec , h_2}&=&2,\\end{aligned}\\ ] ] where @xmath147 is the excitation temperature of rotation and @xmath148 is that of vibration .",
    "molecular hydrogen has two forms : orthohydrogen with aligned nuclear spins and odd rotational states , and parahydrogen with antiparallel nuclear spins and even rotational states .",
    "here we assumed the ratio of orthohydrogen to parahydrogen is 3:1 .",
    "this ratio has significant impact on the dynamics of collapsing molecular cloud cores in the relatively low temperature region because thermodynamic properties related to rotation of molecular hydrogen depend on the nuclear spins and rotational states .",
    "unfortunately this ratio in star forming regions is quite unclear because of observational difficulties .",
    "although parahydrogen is more stable , some observations of interstellar dark clouds suggest that the ratio is considerably far from the equilibrium value even in the cold environment ; @xcite proposed that the ortho / para ratio is larger than 0.1 . on the other hand",
    ", @xcite claimed that the ratio is quite small , @xmath149 . in this work",
    ", we calculate the eos using the ortho / para ratio of 3:1 .",
    "this assumption helps us interpret our simulation results because the adiabatic index @xmath129 decreases monotonically @xcite and also compare our results with recent simulations performed by @xcite ( but @xcite assumed the equilibrium ratio ) .",
    "+ atomic hydrogen : @xmath150 where @xmath151 is the dissociation energy of @xmath0 @xcite .",
    "+ ionized hydrogen : @xmath152 where @xmath153 is the ionization energy of atomic hydrogen .",
    "+ atomic and ionized helium : @xmath154 where @xmath155 and @xmath156 are the first and second ionization energies of helium .",
    "+ electron : @xmath157      the grand canonical partition function of each species is defined as : @xmath158,\\end{aligned}\\ ] ] where @xmath159 is the chemical potential of @xmath136-species and @xmath160 is the total number of @xmath136-species . the grand potential can be derived from the grand canonical partition function : @xmath161 the total grand potential can be calculated from the summation of each component : @xmath162    we calculate required thermodynamic variables from these functions .",
    "first , we calculate the number density of each species based on the chemical equilibrium .",
    "the number density of @xmath136-species is derived from the partial derivative of the grand potential with respect to @xmath159 : @xmath163 where @xmath164 .",
    "this relation yields : @xmath165    we consider only four reactions between the seven species dominant in relatively dense ( but not too dense ) gas for star formation problems : @xmath166 then the number densities can be calculated from the balance between the chemical potentials in these chemical reactions . @xmath167",
    "the rhs term of each equation , @xmath168 , can be calculated from the partition functions .",
    "we have three additional relations ; conservation of the total number density of hydrogen , conservation of the total number density of helium and the charge neutrality : @xmath169 we eliminate @xmath170 and @xmath171 from ( [ chm5 ]  [ chm7 ] ) using ( [ chm1 ]  [ chm4 ] ) : @xmath172 by substituting @xmath173 and @xmath174 ( we can determine the solution of ( [ chm8 ] ) uniquely since all the physical variables are positive ) to ( [ chm10 ] ) , we obtain one non - linear equation of @xmath175 : @xmath176 then we solve this equation numerically using the bi - section method ( note that the first term of @xmath177 is already modified to avoid the round - off error ) . using the obtained @xmath175 ,",
    "it is straightforward to calculate the number density of each species .    in order to derive thermodynamic variables ,",
    "the temperature and density derivatives of the number densities are required .",
    "we take logarithmic differentiation of ( [ chm1 ]  [ chm7 ] ) , then they yield : @xmath178 from this matrix equation we can numerically derive the required derivatives such as @xmath179 and @xmath180 . for @xmath179",
    "the rhs vector becomes @xmath181 and for @xmath182 @xmath183 the temperature derivatives of the partition functions can be calculated analytically .    the total number density is @xmath184 and its derivatives are @xmath185      we use the relation valid in ideal gas : @xmath186 where @xmath187 is the mean molecular weight .",
    "the derivatives of the pressure are : @xmath188 the specific entropy of each species is derived from the grand potential : @xmath189 and its derivatives are : @xmath190-\\frac{\\partial n_i}{\\partial t}\\frac{\\mu_i}{\\rho t},\\\\ \\left(\\frac{\\partial s_i}{\\partial \\rho}\\right)_t&=&\\frac{kn_i}{\\rho^2}\\left[\\left\\{\\left(\\frac{\\partial \\ln n_i}{\\partial \\ln \\rho}\\right)_t-1\\right\\}\\frac{d\\ln z_i}{d\\ln t}-1\\right]+\\left(\\frac{n_i}{\\rho}-\\frac{\\partial n_i}{\\partial \\rho}\\right)\\frac{\\mu_i}{\\rho t}.\\hspace{2em}\\end{aligned}\\ ] ] because the last terms in these derivatives are canceled out by taking summation of species when the chemical reactions are in equilibrium , we can omit these terms . then the total entropy and its derivatives",
    "are defined as : @xmath191    now we can derive thermodynamic properties we require in radiation hydrodynamic simulations .",
    "+ the isothermal and adiabatic sound speeds : @xmath192 the adiabatic index : @xmath193 the internal energy per volume and its derivative : @xmath194 note that we do not use the relation @xmath195 which is valid only in the completely ideal cases , as @xcite suggested ( see also @xcite ) .",
    "we tabularize these thermodynamic variables as functions of @xmath196 and @xmath197 with sufficiently high resolution ( @xmath198 , @xmath199 and @xmath200 ) in @xmath201  @xmath202 and @xmath203  @xmath204 .",
    "we use this eos table with bi - log - linear interpolation .",
    "our treatment of the eos for hydrogen and helium is valid in relatively low - density regions ranging from interstellar gas to the second collapse phase .",
    "however , in very dense region like the deep interior of the protostellar core , non - ideal effects are not negligible : interactions between particles , weak quantum effects in low - temperature but high - density region , pressure ionization of hydrogen , and contributions from other chemical species . such non - ideal effects will affect the thermodynamics and the dynamics ( e.g. , the quasi - equilibrium state of the second core may vary ) . actually , our eos results in a serious unphysical behavior in the very high density region ( @xmath205 ) that almost all the hydrogen particles are turned into the molecular form even when the gas temperature is high enough to destruct the hydrogen molecule . this is because of the assumption of the ideal chemical equilibrium , but in reality this assumption broke down there due to the neglected interactions between particles @xcite .",
    "then our eos gives the considerably soft adiabatic index @xmath129 ( figure  [ s_ee ] ) because of the contribution from the vibration transitions of molecular hydrogen .",
    "since this behavior is completely unphysical , our eos is invalid in such a high density region .",
    "more realistic eos such as @xcite is required to calculate this region properly .",
    "for the gray radiation transfer , we use the compiled tables of the rosseland and planck mean opacities of @xcite , @xcite and the opacity project ( op ) @xcite . for dust opacities , we adopt the composite aggregate dust model of the normal abundance from semenov s mean opacity tables .",
    "though semenov s tables also contain the gas opacities , we adopt the gas opacities of @xcite and @xcite because semenov s planck mean opacity seems to be significantly lower than other opacity tables @xcite where molecular and atomic lines dominate the opacity sources .",
    "therefore we connect the tables of semenov et al .",
    "( 2003 ) and ferguson et al .",
    "( 2005 ) at the temperature where all the dust components evaporate . the dust evaporation temperature ( it weakly depends on the gas density , but in the typical density region , @xmath206 ",
    "@xmath207 ) is given in semenov s opacity calculation code .",
    "we use @xcite in the low temperature region ( @xmath208 ) and op in the high temperature region ( @xmath209 ) .",
    "we tabulate these tables as functions of ( @xmath210 ) and use them with bi - log - linear interpolation .    unfortunately",
    ", the opacity tables do not cover the whole required region .",
    "figure  [ opcov ] shows the coverage of the opacity tables in the @xmath211 plane .",
    "the typical evolution track of the central gas element and the profile in the spherically symmetric collapse are also plotted .",
    "the dust opacities of @xcite cover @xmath212 . op and @xcite cover @xmath213 where @xmath214 and @xmath215 .",
    "it is not serious that the very low density region is not covered because that region is extremely optically thin and the details of dust opacities do not matter there .",
    "we simply extrapolate the opacities by taking the nearest value at the given temperature .",
    "the high density region is far more problematic ; we do not have proper opacities for the protostellar core .",
    "but actually the thermal evolution in this region is dominated by chemical reactions ( dissociation and ionization ) and radiation transfer is of less importance there because the gas is extremely optically thick .",
    "therefore we dare to extrapolate the tables in the same manner , the earliest phase of the protostar is convectively stable ( see also @xcite ) and therefore radiation plays a critical role in heat transfer .",
    "more elaborate opacity tables covering wider region are highly demanded . ] .",
    "we show the combined opacity tables in figure  [ opacity ] as functions of @xmath2 and @xmath216 .",
    "note that there is quite large uncertainty in opacities , especially due to the dust models such as the structure , composition , size distribution and so on .",
    "the thermal evolution and dynamics in star formation remain qualitatively similar even when we change the dust parameters , but the observational properties such as spectral energy distributions ( sed ) are directly affected by the differences between the ( monochromatic ) opacities .",
    "we calculate ohmic resistivity considering both thermal and non - thermal particles . for non - thermal processes ,",
    "we adopt the table of resistivity based on the reaction network model between dust grains and chemical species constructed by @xcite ( see also @xcite ) .",
    "the table of @xmath217 is given as a function of the gas density @xmath2 , the temperature @xmath216 and the ionization rate @xmath218 .",
    "here we assume the typical interstellar ionization rate due to the cosmic rays , @xmath219 , neglecting shielding by the gas .",
    "since the attenuation depth of the cosmic rays is about @xmath220 , the ionization rate will be lower in the deep interior of the first core . in this sense , and also because we neglect ambipolar diffusion , our models corresponds to the lower limit of ( but still highly efficient ) magnetic flux loss .",
    "because decay of radionuclides ( @xmath221 is the dominant source ) considerably contributes to the ionization rate , @xmath222 @xcite , the effect from neglecting the shielding is as large as about an order of magnitude at most .",
    "we should mention that there is still large uncertainty in the resistivity from the grain properties such as the structure , composition , size distribution and so on .    in order to calculate the resistivity for our simulations ,",
    "it is sufficient to estimate the contribution to the thermal ionization from the species which has low ionization energy .",
    "potassium ( k ) has very low ionization energy ( @xmath223 ) and sufficiently abundant to recover good coupling between gas and magnetic fields , therefore it is the most important electron - supplying species in star formation processes .",
    "here we calculate the resistivity due to the thermal ionization of potassium on the assumption of thermal equilibrium using the following equation : @xmath224 we calculate the total resistivity as follows : @xmath225 because the resistivity is inversely proportional to the ionization degree .",
    "we show the resistivity and magnetic reynolds number @xmath226 as a function of the gas density in figure  [ resist ] . here",
    "we consider the jeans length @xmath227 and the free - fall velocity @xmath228 ( where @xmath229 ) as typical length and velocity scales to estimate the magnetic reynolds number . to draw this plot",
    ", we adopt the barotropic approximation as a typical thermal evolution to calculate the gas temperature : @xmath230 \\ , { \\rm k},\\end{aligned}\\ ] ] where @xmath231 is the critical density and @xmath232 is the adiabatic index .",
    "the resistivity steeply decreases in @xmath233 because of the thermal ionization of potassium .",
    "the magnetic fields are decoupled from fluid where the magnetic reynolds number is less than unity .",
    "our resistivity is significantly lower than the resistivity of @xcite ( see also @xcite ) .",
    "this difference mainly comes from the ionization rates ; they assume that decay of @xmath234 ( @xmath235 ) is the dominant ionization source in the dense region where cosmic rays can not penetrate , and neglect the contribution from short - lived species like @xmath221 .",
    "our resistivity is quite similar to that used in @xcite ."
  ],
  "abstract_text": [
    "<S> we report the first three - dimensional radiation magnetohydrodynamic ( rmhd ) simulations of protostellar collapse with and without ohmic dissipation.we take into account many physical processes required to study star formation processes , including a realistic equation of state . </S>",
    "<S> we follow the evolution from molecular cloud cores until protostellar cores are formed with sufficiently high resolutions without introducing a sink particle . </S>",
    "<S> the physical processes involved in the simulations and adopted numerical methods are described in detail.we can calculate only about one year after the formation of the protostellar cores with our direct three - dimensional rmhd simulations because of the extremely short timescale in the deep interior of the formed protostellar cores , but successfully describe the early phase of star formation processes . </S>",
    "<S> the thermal evolution and the structure of the first and second ( protostellar ) cores are consistent with previous one - dimensional simulations using full radiation transfer , but differ considerably from preceding multi - dimensional studies with the barotropic approximation . </S>",
    "<S> the protostellar cores evolve virtually spherically symmetric in the ideal mhd models because of efficient angular momentum transport by magnetic fields , but ohmic dissipation enables the formation of the circumstellar disks in the vicinity of the protostellar cores as in previous mhd studies with the barotropic approximation . </S>",
    "<S> the formed disks are still small ( less than 0.35 au ) because we simulate only the earliest evolution . </S>",
    "<S> we also confirm that two different types of outflows are naturally launched by magnetic fields from the first cores and protostellar cores in the resistive mhd models . </S>"
  ]
}