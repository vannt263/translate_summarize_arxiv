{
  "article_text": [
    "the sobolev spaces @xmath2 and @xmath3 play an important role in many applications of mixed finite element methods to partial differential equations .",
    "examples include second order elliptic partial differential equations , maxwell s equations for electromagnetism , and the linear elasticity equations .",
    "mixed finite element methods may provide advantages over standard @xmath4 finite element discretizations in terms of added robustness , stability , and flexibility .",
    "however , implementing @xmath2 and @xmath3 methods requires additional code complexity for constructing basis functions and evaluating variational forms , which helps to explain their relative scarcity in practice .",
    "the fenics project  @xcite comprises a collection of free software components for the automated solution of differential equations .",
    "one of these components is the fenics form compiler ( ffc )  @xcite .",
    "ffc allows finite element spaces over simplicial meshes and multilinear forms to be specified in a form language close to the mathematical abstraction and notation .",
    "the form compiler generates low - level ( c++ ) code for efficient form evaluation and assembly based on an efficient tensor contraction .",
    "moreover , the ferari project  @xcite has developed specialized techniques for further optimizing this code based on underlying discrete structure .",
    "ffc relies on the finite element automatic tabulator ( fiat )  @xcite for the tabulation of finite element basis functions .",
    "fiat provides methods for efficient tabulation of finiteelement basis functions and their derivatives at any particular point . in particular",
    ", fiat provides simplicial @xmath2 element spaces such as the families of raviart and thomas  @xcite , brezzi , douglas , and marini  @xcite , and brezzi et al .",
    "@xcite , as well as @xmath3 elements of the ndlec types  @xcite .",
    "previous iterations of ffc have enabled easy use of @xmath4 and @xmath5 conforming finite element spaces , including discontinuous galerkin formulations , but support for @xmath2 and @xmath3 spaces has been absent . in this paper , we extend the previous work  @xcite to allow simple and efficient compilation of variational forms on @xmath2 and @xmath3 , including mixed formulations on combinations of @xmath4 , @xmath2 , @xmath3 , and @xmath5 .",
    "the efficiency of the proposed approach relies , in part , on the tensor representation framework established in  @xcite . in this framework ,",
    "the element tensor is represented as the contraction of a reference tensor and a geometry tensor .",
    "the former can be efficiently precomputed given automated tabulation of finite element basis functions on a reference element , while the latter depends on the geometry of each physical element .",
    "for this strategy , a key aspect of the assembly of @xmath2 and @xmath3 conforming element spaces becomes the piola transformations , isomorphically mapping basis functions from a reference element to each physical element .",
    "also , the orientation of geometrical entities such as facet tangents and normals must be carefully considered .",
    "implementations of @xmath2 and @xmath3 finite element spaces , in particular of arbitrary degree , are not prevalent .",
    "there are , to our knowledge , no implementations that utilize the compiled approach to combine the efficiency of low - level optimized code with a fully automated high - level interface .",
    "some finite element packages , such as feap  @xcite , do not provide @xmath2 or @xmath3 type elements at all .",
    "others , such as freefem  @xcite , typically provide only low - order elements such as the lowest - order raviart  thomas elements .",
    "some libraries such as deal.ii  @xcite or femster  @xcite do provide arbitrary degree elements of raviart  thomas and ndlec type , but do not automate the evaluation of variational forms .",
    "ngsolve  @xcite provides arbitrary order @xmath2 and @xmath3 elements along with automated assembly , but only for a predefined set of bilinear forms .",
    "this exposition and the ffc implementation consider the assembly of @xmath2 and @xmath3 finite element spaces on simplicial meshes .",
    "however , the underlying strategy is extendible to nonsimplicial meshes and tensor - product finite element spaces defined on such meshes . a starting point for an extension to isoparametric @xmath4 conforming finite elements",
    "was discussed in  @xcite .",
    "the further extensions to @xmath2 and @xmath3 follow the same lines as for the simplicial case discussed in this note .",
    "the outline of this paper is as follows .",
    "we begin by reviewing basic aspects of the function spaces @xmath2 and @xmath3 in section  [ sec : hdivcurl ] , and we provide examples of variational forms defined on these spaces .",
    "we continue , in section  [ sec : elements ] , by summarizing the @xmath2 and @xmath3 conforming finite elements implemented by fiat . in section  [ sec : multilinearforms ]",
    ", we recap the multilinear form framework of ffc and we present an extension of the representation theorem from  @xcite .",
    "subsequently , in section  [ sec : assembling ] , we provide some notes on the assembly of @xmath2 and @xmath3 elements .",
    "particular emphasis is placed on aspects not easily found in the standard literature , such as the choice of orientation of geometric entities . in section  [ sec : examples ] , we return to the examples introduced in section  [ sec : hdivcurl ] and illustrate the ease and terseness with which even complicated mixed finite element formulations may be expressed in the ffc form language .",
    "convergence rates in agreement with theoretically predicted results are presented to substantiate the veracity of the implementation .",
    "finally , we make some concluding remarks in section  [ sec : conclusion ] .",
    "in this section , we summarize some basic facts about the sobolev spaces @xmath2 and @xmath3 and we discuss conforming finite element spaces associated with them . our primary focus is on properties relating to interelement continuity and change of variables .",
    "the reader is referred to the monographs  @xcite and  @xcite for a more thorough analysis of @xmath2 and @xmath3 , respectively .      for an open domain @xmath6 , we let @xmath7 denote the space of square - integrable vector fields on @xmath8 with the associated norm @xmath9 and inner - product @xmath10 , and we abbreviate @xmath11 . we define the following standard differential operators on smooth fields",
    "@xmath12 : @xmath13 for a multi - index @xmath14 of length @xmath15 , @xmath16 , @xmath17 , and @xmath18 .",
    "we may then define the spaces @xmath19 , @xmath20 , and @xmath21 by @xmath22 with derivatives taken in the distributional sense .",
    "the reference to the domain @xmath8 will be omitted when appropriate , and the associated norms will be denoted @xmath23 , @xmath24 , and @xmath25 . furthermore , we let @xmath26 denote the space of matrices and we let @xmath27 denote the space of square - integrable matrix fields with square - integrable row - wise divergence .",
    ".26em plus .1em minus .1em for the sake of compact notation , we shall also adopt the exterior calculus notation of  @xcite and let @xmath28 denote the space of smooth differential @xmath29-forms on @xmath8 , and let @xmath30 denote the space of square - integrable differential @xmath29-forms on @xmath8 .",
    "we further let @xmath31 denote the exterior derivative with adjoint @xmath32 , and we define @xmath33 .",
    "further , @xmath34 is the space of polynomial @xmath29-forms of up to and including degree @xmath35 , and @xmath36 denotes the reduced space as defined in @xcite .",
    "the function spaces @xmath2 and @xmath3 are the natural function spaces for an extensive range of partial differential equations , in particular in mixed formulations .",
    "we sketch some examples in the following , both for motivational purposes and for later reference .",
    "the examples considered here are mixed formulations of the hodge laplace equations , the standard eigenvalue problem for maxwell s equations , and a mixed formulation for linear elasticity with weakly imposed symmetry .",
    "we return to these examples in section [ sec : examples ] .",
    "[ ex : mixedpoisson]the most immediate example involving the space @xmath2 is a mixed formulation of poisson s equation : @xmath37 in @xmath38 . by introducing the flux @xmath39 and assuming dirichlet boundary conditions for @xmath40 , we obtain the following mixed variational problem : find @xmath41 and @xmath42 satisfying @xmath43 for all @xmath44 and @xmath45 .    [ ex : hodgelaplace ] with more generality , we may consider weak formulations of the hodge laplacian equation @xmath46 on a domain @xmath6 ; see @xcite . for simplicity of presentation , we assume that @xmath8 is contractible such that the space of harmonic forms on @xmath8 vanishes .",
    "the formulation in example  [ ex : mixedpoisson ] is the equivalent of seeking @xmath47 and @xmath48 for @xmath49 with natural boundary conditions ( the appropriate trace being zero ) . to see this , we test @xmath50 against @xmath51 and we test @xmath52 against @xmath53 to obtain @xmath54 noting that @xmath55 for @xmath47 . integrating by parts",
    ", we obtain @xmath56 we may restate  ( [ eq : mixedpoisson , d ] ) in the form  ( [ eq : mixedpoisson ] ) by making the identifications @xmath57 , @xmath58 , and @xmath59 .",
    "if @xmath60 , we may also consider the following mixed formulations of the hodge laplace equation .    1 .",
    "find @xmath61 and @xmath62 such that @xmath63 for all @xmath64 , @xmath65 .",
    "2 .   find @xmath66 and @xmath67 such that @xmath68 for all @xmath69 .",
    "[ ex : cavity ] the time - harmonic maxwell equations in a cavity with perfectly conducting boundary induces the following eigenvalue problem : find resonances @xmath70 and eigenfunctions @xmath71 , satisfying @xmath72 where @xmath73 .",
    "note that the formulation ( [ eq : maxwell ] ) disregards the original divergence - free constraint for the electric field @xmath74 and thus includes the entire kernel of the @xmath75 operator , corresponding to @xmath76 and electric fields of the form @xmath77 .",
    "[ ex : elasticity ] navier s equations for linear elasticity can be reformulated using the stress tensor @xmath78 , the displacement @xmath40 , and an additional lagrange multiplier @xmath79 corresponding to the symmetry of the stress constraint .",
    "the weak equations for @xmath80 , with the natural formulations the natural boundary condition would be a neumanncondition . ]",
    "boundary condition @xmath81 , take the following form : given @xmath82 , find @xmath83 , @xmath84 , and @xmath85 such that @xmath86 for all @xmath87 , @xmath88 , and @xmath89 .",
    "here , @xmath90 is the compliance tensor , and @xmath91 is the scalar representation of the skew - symmetric component of @xmath92 ; more precisely , @xmath93 .",
    "this formulation has the advantage of being robust with regard to nearly incompressible materials and it provides an alternative foundation for complex materials with nonlocal stress - strain relations . for more details ,",
    "we refer the reader to @xcite .      at this point",
    ", we turn our attention to a few results on continuity - preserving mappings for @xmath2 and @xmath3 .",
    "the results are classical and we refer the reader to  @xcite for a more thorough treatment .",
    "first , it follows from stokes theorem that in order for piecewise @xmath2 vector fields to be in @xmath2 globally , the traces of the normal components over patch interfaces must be continuous , and analogously tangential continuity is required for piecewise @xmath3 fields .",
    "more precisely , we have the following : let @xmath94 be a partition of @xmath8 into subdomains .",
    "define the space @xmath95 of piecewise @xmath2 functions relative to this partition @xmath96 : @xmath97 then @xmath98 is in @xmath20 if and only if the normal traces of @xmath99 are continuous across all element interfaces .",
    "analogously , if @xmath100 for all @xmath101 , then @xmath102 if and only if the tangential traces are continuous across all element interfaces .",
    "second , we turn to consider a nondegenerate mapping @xmath103 with jacobian @xmath104 , @xmath105 . for @xmath106 ,",
    "the mapping @xmath107 defined by @xmath108 is an isomorphism from @xmath109 to @xmath19 .",
    "this , however , is not the case for @xmath2 or @xmath3 , since @xmath107 does not in general preserve continuity of normal or tangential traces .",
    "instead , one must consider the contravariant and covariant piola mappings which preserve normal and tangential continuity , respectively .",
    "[ def : piolas ] let @xmath110 , let @xmath111 be a nondegenerate mapping from @xmath112 onto @xmath113 with @xmath114 , and let @xmath115 .",
    "the contravariant piola mapping @xmath116 is defined by @xmath117 the covariant piola mapping @xmath118 is defined by @xmath119    we remark that the contravariant piola mapping is usually defined with an absolute value , @xmath120 .",
    "however , omitting the absolute value , as in  , can simplify the assembly of @xmath2 elements , as will be expounded in section  [ sec : assembling ] .",
    "the contravariant piola mapping is an isomorphism of @xmath121 onto @xmath20 , and the covariant piola mapping is an isomorphism of @xmath122 onto @xmath21 .",
    "in particular , the contravariant piola mapping preserves normal traces , and the covariant piola mapping preserves tangential traces .",
    "we illustrate this below in the case of simplicial meshes in two and three space dimensions ( triangles and tetrahedra ) .",
    "the same results hold for nonsimplicial meshes with cell - varying jacobians , such as quadrilateral meshes  @xcite .",
    "let @xmath123 be a triangle with vertices @xmath124 and edges @xmath125 for @xmath126 .",
    "we define the unit tangents by @xmath127 .",
    "we further define the unit normals by @xmath128 , where @xmath129 is the clockwise rotation matrix .    now , assume that @xmath123 is affinely mapped to a ( nondegenerate ) simplex @xmath130 with vertices @xmath131 .",
    "the affine mapping @xmath132 takes the form @xmath133 and satisfies @xmath134 for @xmath135 .",
    "it follows that edges are mapped by @xmath136 similarly , normals are mapped by @xmath137 where we have used that @xmath138 and thus @xmath139 for @xmath140 .",
    "the relation between the mappings of tangents and normals ( or edges and rotated edges ) may be summarized in the following commuting diagrams : @xmath141    with this in mind , we may study the effect of the piola transforms on normal and tangential traces .",
    "let @xmath142 and let @xmath143 .",
    "then @xmath144 thus , the contravariant piola mapping preserves normal traces for vector fields under affine mappings , up to edge lengths . in general",
    ", the same result holds for smooth , nondegenerate mappings @xmath145 if the jacobian @xmath146 is invertible for all @xmath147 .",
    "similarly , let @xmath148 .",
    "then @xmath149 thus , the covariant piola preserves tangential traces for vector fields , again up to edge lengths .",
    "observe that the same result holds for tetrahedra without any modifications .",
    "the effect of the contravariant and covariant piola mappings on normal and tangential traces is illustrated in figure  [ fig : piolaexample ] , where @xmath150 for simplicity .",
    "now , let @xmath123 be a tetrahedron . as explained above , the covariant piola",
    "mapping preserves tangential traces . to study the effect of the contravariant piola mapping on normal traces",
    ", we define the face normals of @xmath130 by @xmath151 .",
    "then @xmath152 since @xmath153 .",
    "let @xmath154 and let @xmath155 .",
    "then , it follows that @xmath156 thus , the contravariant piola mapping preserves normal traces , up to the area of faces .",
    "we finally remark that if @xmath157 defines a conformal , orientation - preserving map , the contravariant and covariant piola mappings coincide . in @xmath158",
    ", @xmath159 must also be orthogonal for this to occur .",
    "to construct @xmath2 and @xmath3 conforming finite element spaces , that is , discrete spaces @xmath160 satisfying @xmath161 or @xmath162 , one may patch together local function spaces ( finite elements ) and make an appropriate matching of degrees of freedom over shared element facets . here",
    ", a facet denominates any geometric entity of positive codimension in the mesh ( such as an edge of a triangle or an edge or face of a tetrahedron ) . in particular",
    ", one requires that degrees of freedom corresponding to normal traces match for @xmath2 conforming discretizations and that tangential traces match for @xmath3 conforming discretizations .",
    "several families of finite element spaces with degrees of freedom chosen to facilitate this exist . for @xmath2 on simplicial tessellations in two dimensions , the classical conforming families are those of raviart and thomas ( @xmath163 , @xmath164 )  @xcite ; brezzi , douglas , and marini ( @xmath165 , @xmath166 )  @xcite ; and brezzi et al .",
    "( @xmath167 , @xmath166 )  @xcite .",
    "the former two families were extended to three dimensions by ndlec  @xcite .",
    "however , the same notation will be used for the two- and three - dimensional @xmath2 element spaces here . for @xmath3 , there are the families of ndlec of the first kind ( @xmath168 , @xmath169 )  @xcite and of the second kind ( @xmath170 , @xmath166 )  @xcite .",
    "we summarize in table  [ tab : listofelements ] those @xmath2 and @xmath3 conforming finite elements that are supported by fiat and hence by ffc . in general",
    ", ffc can wield any finite element space that may be generated from a local basis through either of the aforedescribed mappings . in table",
    "[ tab : approximability ] , we also summarize some basic approximation properties of these elements for later comparison with numerical results in section  [ sec : examples ] .",
    "@xmath3 + @xmath171 &    .@xmath2 and @xmath3 conforming finite elements on triangles and tetrahedra supported by fiat and ffc for @xmath172 .",
    "when applicable , the elements are listed with their exterior calculus notation , along with their original references .",
    "note that for @xmath173 , the raviart  thomas and brezzi  douglas  marini elements are also known as the first and second kind @xmath2 ndlec ( face)elements , respectively . [ cols= \" < , < , < \" , ]      eigenvalues of the cavity resonator problem computed using first order ndlec elements ( @xmath174 ) and lagrange elements ( @xmath175 ) on a coarse ( @xmath176 ) criss - cross mesh . the exact analytical values are indicated by the horizontal grid lines.,scaledwidth=78.0% ]    by the ndlec edge elements on a regular criss - cross triangulation are given in comparison with the corresponding lagrange eigenvalue approximations @xmath177 .",
    "note the treacherous spurious lagrange approximations such as @xmath178 .      as a final example",
    ", we consider a mixed finite element formulation of the equations of linear elasticity with the symmetry of the stress tensor imposed weakly as given in example [ ex : elasticity ] . in the homogeneous , isotropic case ,",
    "the inner product induced by the compliance tensor @xmath90 reduces to @xmath179 for @xmath180 material parameters .",
    "a stable family of finite element spaces for the discretization of is given by  @xcite : @xmath181 , @xmath166 .",
    "the @xmath182 lines of ffc code sufficient to define this discretization are included in table  [ tab : codeelasticity ] .    again to demonstrate convergence , we consider a regular triangulation of the unit square and solve for the smooth solution @xmath183 the theoretically predicted convergence rate of the discretization introduced above is of the order @xmath184 for all computed quantities .",
    "the numerical experiments corroborate this prediction .",
    "in particular , the convergence of the stress approximation in the @xmath2 norm can be examined in figure  [ fig : elasticity ] .    0.8 def a(sigma , tau , nu , zeta ) : return ( nu*dot(sigma , tau ) - zeta*trace(sigma)*trace(tau))*dx    def b(tau , w , eta ) : return ( div(tau[0])*w[0 ] + div(tau[1])*w[1 ] + skew(tau)*eta)*dx    nu = 0.5 zeta = 0.2475 r = 2    s = finiteelement(``bdm '' , `` triangle '' , r ) v = vectorelement(``discontinuous lagrange '' , `` triangle '' , r-1 ) q = finiteelement(``discontinuous lagrange '' , `` triangle '' , r-1 ) mx = mixedelement([s , s , v , q ] )    ( tau0 , tau1 , v , eta ) = testfunctions(mx ) ( sigma0 , sigma1 , u , gamma ) = trialfunctions(mx ) sigma = [ sigma0 , sigma1 ] tau = [ tau0 , tau1 ]    a = a(sigma , tau , nu , zeta ) + b(tau ,",
    "u , gamma ) + b(sigma , v , eta ) l = dot(v , f)*dx     error of the approximated stress @xmath185 versus mesh size .",
    "the convergence rates are @xmath184 , @xmath186 .",
    "right : elastic dolphin hanging by the tail under a gravitational force.,title=\"fig:\",scaledwidth=42.0% ]    error of the approximated stress @xmath185 versus mesh size .",
    "the convergence rates are @xmath184 , @xmath186 .",
    "right : elastic dolphin hanging by the tail under a gravitational force.,title=\"fig:\",scaledwidth=43.0% ]",
    "the relative scarcity of @xmath2 and @xmath3 mixed finite element formulations in practical use may be attributed to their higher theoretical and implementational threshold .",
    "indeed , more care is required to implement their finite element basis functions than the standard lagrange bases , and assembly poses additional difficulties . however , as demonstrated in this work , the implementation of mixed finite element formulations over @xmath2 and @xmath3 may be automated and thus be used with the same ease as standard formulations over @xmath4 .",
    "in particular , the additional challenges in the assembly can be viewed as not essentially different from those encountered when assembling higher order lagrange elements .",
    "the efficiency of the approach has been further investigated by lgaard and wells  @xcite , with particular emphasis on the performance when applied to more complicated pdes .",
    "they conclude that the tensor representation significantly improves performance for forms below a certain complexity level , corroborating the previous results of  @xcite .",
    "however , an automated , optimized quadrature approach , also supported by ffc , may prove significantly better for more complex forms .",
    "these findings indicate that a system for automatically detecting the better approach may be valuable .    the tools ( ffc , fiat , dolfin ) used to compute the results presented here are freely available as part of the fenics project  @xcite and it is our hope that this may contribute to further the use of mixed formulations in applications ."
  ],
  "abstract_text": [
    "<S> in this paper , we discuss how to efficiently evaluate and assemble general finite element variational forms on @xmath0 and @xmath1 . </S>",
    "<S> the proposed strategy relies on a decomposition of the element tensor into a precomputable reference tensor and a mesh - dependent geometry tensor . </S>",
    "<S> two key points must then be considered : the appropriate mapping of basis functions from a reference element , and the orientation of geometrical entities . to address these issues , </S>",
    "<S> we extend here a previously presented representation theorem for affinely mapped elements to piola - mapped elements . </S>",
    "<S> we also discuss a simple numbering strategy that removes the need to contend with directions of facet normals and tangents . </S>",
    "<S> the result is an automated , efficient , and easy - to - use implementation that allows a user to specify finite element variational forms on @xmath0 and @xmath1 in close to mathematical notation .    </S>",
    "<S> mixed finite element , variational form compiler , piola    65n30 , 68n20    10.1137/08073901x    assembly of @xmath2 and @xmath3 finite elements </S>"
  ]
}