{
  "article_text": [
    "in this paper we study self - intersections of smooth immersed curves on an oriented surface @xmath2 of genus @xmath3 with @xmath4 punctures .",
    "fix @xmath5 and denote @xmath6 .",
    "we will consider immersions @xmath7",
    "\\to \\s$ ] with @xmath8 and @xmath9  we call them _ closed curves with the base point @xmath10_. throughout the paper , all curves are assumed to be generic , i.e. their only singularities are double points of transversal self - intersection , distinct from @xmath10 .",
    "let @xmath1 be a closed curve and @xmath11 be its self - intersection @xmath12 , @xmath13 .",
    "define @xmath14 if the orientation of the basis @xmath15 coincides with the one prescribed by the orientation of @xmath16 , and @xmath17 otherwise , see figure [ fig : signs]a .",
    "turaev @xcite constructed an important element of the group ring @xmath18 $ ] corresponding to @xmath1 , in the following way .",
    "let @xmath19 be the homotopy class of a loop @xmath20 with @xmath21 \\cup [ v,1]$ ] .",
    "denote @xmath22 the set of double points of @xmath1 and define the element @xmath23 $ ] by @xmath24 in particular , for a curve on @xmath25 one has @xmath18=\\z$ ] so @xmath26 .",
    "[ ex : radial1 ] let @xmath27 and denote by @xmath28 the generator of @xmath29 ( represented by a small loop around @xmath30 ) . for a curve @xmath1 shown in figure [ fig : radial]a we have @xmath31 ; signs of self - intersections and the corresponding curves @xmath32 are shown in figure [ fig : radial]b .    for a curve @xmath1 on",
    "@xmath25 one may define its _ whitney index _ ( or winding number ) @xmath33 as the number of full rotations made by the tangent vector @xmath34 around the origin , as @xmath35 moves from @xmath30 to @xmath36 .    for a curve @xmath1 on @xmath25 and @xmath37 one",
    "can also define @xmath38 as the number of times the curve @xmath1 circles around @xmath39 .",
    "in other words , it is the linking number of a @xmath36-cycle @xmath40 $ ] with the @xmath30-chain @xmath41-[x]$ ] ( composed of a point near infinity taken with the positive sign and @xmath39 taken with the negative sign ) .",
    "it can be calculated as the intersection number of the curve @xmath1 with any ray starting in @xmath39 and going to infinity .",
    "if @xmath1 is a plane curve with a base point @xmath10 , we define @xmath42 by averaging the values of @xmath43 on two components of @xmath44 adjacent to @xmath10 .",
    "h.whitney in @xcite considered closed curves with a base point on @xmath25 and showed that    [ th : whitney ] let @xmath7 \\to \\r^2 $ ] be a generic immersed curve with the base point @xmath45 .",
    "then @xmath46    for a curve @xmath1 shown on figure [ fig : signs]b we have @xmath47 , @xmath48 , and @xmath49 . for a curve @xmath1 shown on figure [ fig : signs]c",
    "we have @xmath50 , @xmath51 , and @xmath52 .",
    "the main results of this paper are generalizations of theorem  [ th : whitney ] for curves on surfaces .",
    "we define appropriate surface versions of expressions in both sides of and relate them .    to define an analog of the whitney index for a curve @xmath53",
    ", we fix a vector field @xmath54 on @xmath16 having no zeros on the curve @xmath1 .",
    "let @xmath55 be the number of rotations of @xmath34 relative to @xmath54 .",
    "it can be calculated as the algebraic number of points in which @xmath34 looks in the direction of @xmath54 ; each such point is counted with a positive sign , if @xmath56 turns counter - clockwise relative to @xmath54 in a neighborhood of @xmath20 and with a negative sign otherwise .",
    "it is clear that @xmath57 does not change under the homotopies of @xmath1 and @xmath54 ( as long as @xmath1 stays an immersion and @xmath54 has no zeros on its image ) .",
    "define the _ whitney index _ of @xmath1 as @xmath58 \\in \\z[\\pi]$ ] where @xmath40 $ ] is the class of homotopy represented by the curve @xmath1 .    in particular , if @xmath59 and @xmath60 is a horizontal vector field directed from left to right , then @xmath29 is trivial and @xmath61 is the usual whitney index of @xmath1 .",
    "[ ex : radial2 ] let s return to example [ ex : radial1 ] .",
    "let @xmath62 be a radial vector field on @xmath63 ; the function @xmath64 is chosen so that the field @xmath54 is smooth .",
    "one may check that @xmath65 , where @xmath33 is the usual whitney index of @xmath1 , @xmath66 is the number of times @xmath1 circles around @xmath67 , and @xmath28 is the generator of @xmath68 . in particular , for the curve @xmath1 shown on figure [ fig : radial]a , the number of rotations of @xmath56 relative to @xmath54 is @xmath69 ( indeed , there is only one tangency point of @xmath54 with @xmath1 , denoted by @xmath70 in figure [ fig : radial]c ; its sign is @xmath69 ) . also , @xmath40=g^2 $ ] , thus @xmath71 .",
    "the results obtained in this article generalize those of the papers @xcite and @xcite where the curves on @xmath72 and @xmath73 were considered ; the methods we use are similar to those of @xcite .",
    "we consider both curves with a base point ( theorem [ th : finite ] ) , and curves without base points ( theorem  [ th : nbfinite ] ) .",
    "both theorems are proved by similar methods , so we collected all proofs in section  [ sec : proofs ] .",
    "for two generic paths @xmath74\\to\\s$ ] , @xmath75 with @xmath76 we may define an element similar to as follows .",
    "let @xmath77 be an intersection point of @xmath78 and @xmath79 , with @xmath80 , @xmath81 .",
    "again , define @xmath14 if the orientation of the basis @xmath82 coincides with the one prescribed by the orientation of @xmath16 , and @xmath17 otherwise .",
    "let @xmath83 be the homotopy class of a loop composed of two arcs : @xmath84 with @xmath85 $ ] , and @xmath86 with @xmath87 $ ] , see figure [ fig : def]a",
    ".    denote by @xmath88 the set of intersections of @xmath78 and @xmath79 and define @xmath89      let @xmath54 be a vector field on the surface @xmath16 . throughout the paper",
    ", we will assume that every trajectory of @xmath54 is infinitely extendable , so a one - parametrical group @xmath91 of diffeomorphisms generated by @xmath54 is well - defined .",
    "denote by @xmath92 its integral trajectory starting at the point @xmath93 .",
    "given @xmath54 , we generalize formula as follows .",
    "let @xmath94 \\to \\s$ ] be a generic immersed curve with the base point @xmath95 .",
    "fix @xmath96 such that @xmath97 .",
    "denote by @xmath98 and @xmath99 the negative ( resp .",
    "positive ) @xmath100-time semi - trajectories @xmath101 , @xmath102 $ ] ( resp .",
    "$ ] ) of the base point @xmath10 .",
    "define the _",
    "@xmath100-time index of @xmath10 with respect to @xmath1 _ by @xmath104\\ ] ] denote by @xmath105 \\to \\s$ ] a @xmath100-shift of @xmath1 along @xmath54 : @xmath106 .",
    "suppose that @xmath54 does not vanish on @xmath1 and all the intersections of @xmath107 with @xmath1 are transversal double points @xmath108 .",
    "define @xmath14 if the orientation of the basis @xmath109 coincides with the orientation of @xmath16 , and @xmath17 otherwise .",
    "let @xmath110 be the homotopy class of a loop composed of three arcs : @xmath111 with @xmath112 $ ] , @xmath113 with @xmath114 $ ] , and @xmath115 with @xmath116 $ ] , see figure [ fig : def]b .    between all such intersection points",
    "@xmath11 pick only the ones with @xmath13 ; denote this set by @xmath117 .",
    "define the element @xmath118 $ ] by @xmath119 in particular , for a curve on @xmath25 one has @xmath18=\\z$ ] so @xmath120 .    for",
    "a small @xmath121 intersections @xmath122 appear near double points of @xmath1 and near points in which @xmath1 is tangent to @xmath54 ( the condition @xmath13 means in this case that the tangent vector should be directed in the direction of @xmath54 ) .",
    "after checking the signs , we see that the contribution of double points to @xmath123 equals @xmath124 , while the contribution of points in which @xmath1 is tangent to @xmath54 equals @xmath125 ( recall that we consider @xmath125 as a multiple of the class @xmath40 $ ] ) and thus obtain @xmath126    [ th : finite ] let @xmath7 \\to \\s$ ] be a generic immersed curve with the base point @xmath127 .",
    "let @xmath54 be a vector field which does not vanish on @xmath1 and is transversal to @xmath1 at the base point @xmath10 .",
    "suppose that @xmath96 is such that all intersections of @xmath1 with @xmath107 are transversal double points distinct from @xmath10 .",
    "then @xmath128    for a small @xmath121 we have @xmath129 and @xmath130 is given by , so in this case equality is trivial .",
    "let @xmath59 and @xmath60 be a horizontal vector field directed from left to right . here",
    "@xmath29 is trivial , and @xmath61 is the usual whitney index of @xmath1 . for a large @xmath100 , @xmath107 is shifted far from @xmath1 , so @xmath131 . also ,",
    "@xmath132 counts intersections of @xmath1 with both horizontal rays emanating from @xmath10 to the left and to the right .",
    "so it equals to the index @xmath133 of the base point , introduced in section [ sec : selfintersec ] .",
    "equation turns in this case into the classical whitney s formula .",
    "[ ex : radial3 ] let s return to example [ ex : radial2 ] . for a large @xmath100 the curve @xmath107 is shifted far from @xmath1 , so @xmath131 . the curve @xmath1 shown in figure [ fig : radial]a has no intersections with @xmath99 , and only one intersection with @xmath98 , denoted by @xmath134 in figure [ fig : radial]c ; its sign is @xmath69 .",
    "the corresponding curve @xmath135 is depicted there in bold .",
    "it represents a class @xmath28 , thus @xmath136 .",
    "this agrees with @xmath137 .",
    "let us consider the behavior of formula when @xmath138 .",
    "[ th : infinite ] let @xmath7 \\to \\s$ ] be a generic immersed curve with the base point @xmath127 .",
    "let @xmath54 be a vector field which does not vanish on @xmath1 .",
    "suppose that the trajectory @xmath139 of the base point intersects @xmath1 only in a finite number of points",
    ". then limits @xmath140 and @xmath141 are well defined and satisfy @xmath142    by the assumption , @xmath139 intersects @xmath1 in a finite number of points @xmath143 , @xmath144 with @xmath145 .",
    "thus when @xmath146 , the index @xmath132 does not change and @xmath147 is well - defined .",
    "now the statement follows from theorem [ th : finite ] . indeed",
    ", note that in addition to @xmath132 , only one term in equation depend on @xmath100 , namely @xmath148 .",
    "since equation is satisfied for any @xmath100 , we conclude that @xmath148 also does not change when @xmath146 .",
    "therefore , @xmath149 is also well - defined .",
    "since the equality holds for any @xmath100 , it is satisfied also in the limit @xmath150 .",
    "one can calculate @xmath148 when @xmath151 in another way , using intersections with the graph of the so - called separatrices of @xmath54 .",
    "separatrices of @xmath54 are trajectories of @xmath54 which bound regions of different dynamics of the flow on @xmath16 .",
    "the idea is that , under appropriate assumptions on @xmath54 , as @xmath150 , the curve @xmath107 is attracted into a neighborhood of the union of separatrices of @xmath54 .",
    "an interested reader may easily visualize it in the simplest case of a gradient vector field of a morse function on @xmath152 . in this case",
    ", separatrices form a graph with vertices in the critical points , with each pair of neighboring critical points connected by two edges ( resulting in a total of @xmath153 vertices and @xmath154 edges ) .    for a general vector field",
    "this approach involves a number of technicalities and requires a lengthy treatment , so we decided to omit it .",
    "our goal is to repeat all constructions of section [ sec : curves ] for curves without base points . in all formulas we will be using now free loops instead of based loops ;",
    "denote by @xmath155 the loop space of @xmath16 .",
    "let @xmath53 be an oriented curve without a base point ; we are to define an appropriate analogue of @xmath156 in this case .",
    "let @xmath11 be a self - intersection of @xmath1 .",
    "smoothing @xmath1 in @xmath11 with respect to the orientation , we obtain two closed curves : @xmath157 and @xmath158 , where the tangent vector of @xmath157 rotates clockwise in the neighborhood of @xmath11 , and that of @xmath158 rotates counter - clockwise",
    ". see figure [ fig : nbased]a .",
    "denote @xmath22 the set of double points of @xmath1 and define @xmath159 $ ] by @xmath160-[\\g^r_d]).\\ ] ]    define the whitney index in the non - based case as @xmath161 - 1 ) \\in \\z[\\go]$ ] where @xmath36 is the class of the trivial loop , and @xmath55 is , like for pointed curves , the number of full rotations of @xmath34 relative @xmath54 .",
    "( note that the definition of @xmath55 does not require the base point . )",
    "the definition of @xmath148 remains almost the same as in section [ sub : finite ] , with few straightforward changes .",
    "namely , we drop the requirement that @xmath13 when we consider intersection points @xmath162 of @xmath1 with @xmath107 , and the corresponding loop @xmath163 consists of just two arcs : a piece of @xmath1 parameterized by the arc @xmath164 of the circle , and @xmath165 for @xmath166 .",
    "see figure [ fig : nbased]b ( the loop @xmath163 is shown in bold ) .",
    "the following theorem is an analogue of theorem [ th : finite ] for curves without base points :    [ th : nbfinite ] let @xmath53 be a generic immersed curve without the base point .",
    "let @xmath54 be a vector field on @xmath16 which does not vanish on @xmath1 .",
    "suppose that @xmath96 is such that all intersections of @xmath1 with @xmath107 are transversal double points",
    ". then @xmath167",
    "thus @xmath124 provides a simple obstruction for pushing a curve off itself :    let @xmath1 be a generic curve on @xmath16 . if @xmath168 - 1]\\subset\\z[\\go]$ ] then the curve @xmath1 can not be pushed off itself by a flow of vector field , i.e.  any shifted copy @xmath107 intersects the initial curve @xmath1 .",
    "[ ex : pushoff ] let @xmath169 be a doubly - punctured plane and @xmath1 be a figure - eight curve with lobes going around the punctures of @xmath16",
    ". then @xmath1 can not be pushed off itself .",
    "note also that the only term in formula , which depends on @xmath100 , is @xmath148 .",
    "thus it is , in fact , independent of @xmath100 and different values of @xmath100 give the same value of @xmath148 .",
    "the main idea is rather simple .",
    "we interpret both sides of the formula as two different ways to compute an intersection number of two 2-chains in a 4-manifold .",
    "very roughly speaking , the manifold is @xmath170 and two chains are @xmath171 and the diagonal @xmath172 .",
    "their intersection is the left part of the formula ( the sum of signs of double points ) . the same intersection number can be also computed by intersecting the boundary of the first chain with a 3-chain , constructed by homotopy @xmath173 of the diagonal .",
    "this comprises the right hand side of the formula .",
    "the reality is somewhat more complicated so some technicalities are involved . in particular , to split the formula by homotopy classes @xmath174 we have to work in the universal covering space @xmath175 of @xmath16 . also , to push the boundary of the first chain off the diagonal , we take a certain @xmath176 cut - off .",
    "theorem [ th : nbfinite ] is completely similar , except that we use a slightly different configuration space .",
    "we treat the case of theorem [ th : finite ] in details and indicate modifications needed for theorem [ th : finite ] .",
    "denote by @xmath175 the set of homotopy classes of paths",
    "@xmath177 \\to \\s$ ] such that @xmath178 ; @xmath175 is a universal covering space for @xmath16 and inherits its orientation .",
    "the projection @xmath179 maps a path @xmath180 into its final point @xmath181 .",
    "the vector field @xmath54 can be lifted to the vector field @xmath182 on @xmath175 such that @xmath183 , where @xmath184 means the trajectory of @xmath182 .",
    "consider a configuration space @xmath185 of ( ordered ) pairs of points on @xmath186 $ ] .",
    "to compactify @xmath187 , we pick a small @xmath188 and take an @xmath176-cut - off : @xmath189 note that apart from compactifying @xmath187 , the condition @xmath190 used in this cut - off allows us to push the boundary of @xmath191 off the diagonal @xmath192 .",
    "topologically , @xmath191 is a closed 2-simplex , whose boundary consists of three intervals , on which @xmath193 , @xmath194 , and @xmath195 , respectively .",
    "the curve @xmath1 defines an evaluation map @xmath196 , @xmath197  we forget the curve itself and leave only the two marked points . for a fixed class @xmath174 define @xmath198 by @xmath199 where @xmath200 is an arc @xmath20 with @xmath201 $ ] ( so its final point is @xmath202 ) and @xmath203 is made of the loop @xmath90 followed by an arc @xmath204 with @xmath205 $ ] ( so its final point is @xmath206 ) , see figure [ fig : lift ] . from the definition of @xmath207 we immediately get @xmath208 ,",
    "so @xmath207 is a lift of the evaluation map .",
    "the diagonal @xmath209 is a proper 2-dimensional submanifold of @xmath210 , which inherits the orientation of @xmath175 ( as the image of the map @xmath211 ) . for",
    "a sufficiently small @xmath176 the intersection number @xmath212 of the image of @xmath191 with @xmath213 is well - defined and independent of @xmath176 , since @xmath214 is oriented , compact , and its boundary does not intersect @xmath213 .",
    "indeed , a pair @xmath217 gives an intersection point of @xmath214 with @xmath213 iff the homotopy classes of paths @xmath200 and @xmath203 coincide , i.e. , endpoints @xmath202 and @xmath206 of these paths coincide and the homotopy class of @xmath218 is trivial .",
    "this means that @xmath219 is a self - intersection point of @xmath1 and the homotopy class of the loop @xmath20 with @xmath201\\cup[v,1]$ ] equals to @xmath90 .",
    "the local intersection sign is easy to compute and a direct check assures that orientations of @xmath214 and @xmath213 give the positive orientation of @xmath220 iff @xmath221 .",
    "consider the @xmath222-chain @xmath223 .",
    "the homotopy @xmath224 is a @xmath225-chain such that @xmath226 .",
    "denote @xmath227 the intersection number , so that one has @xmath228 denote by @xmath229 the coefficient of @xmath90 in @xmath148 , see .        in view of it remains to compute @xmath231 .",
    "each intersection point of @xmath232 with @xmath233 corresponds to a pair @xmath234 , such that the endpoint of the corresponding path @xmath203 is obtained from the endpoint of @xmath200 by a diffeomorphism @xmath91 for some @xmath235 ( in other words , @xmath236 ) and the homotopy class of the path @xmath237 is @xmath90 .",
    "let us study separately each of the three parts of the boundary @xmath238 .",
    "denote by @xmath239 the part of @xmath240 on which @xmath193 , by @xmath241 the part on which @xmath194 , and @xmath242 the part on which @xmath195 ( with the induced orientation ) .",
    "for @xmath248 we have @xmath249 and @xmath250 , thus we are interested in points of intersection of @xmath251 with @xmath206 for @xmath235 and @xmath252 .",
    "but for small @xmath176 these are just intersections of @xmath99 ( see section [ sub : finite ] ) with the whole of @xmath1 .",
    "moreover , it is easy to check that the signs of such intersection points coincide with the signs @xmath253 , @xmath254 introduced in section [ sub : compose ] , which proves the first equality of the lemma .",
    "the second equality is proven in the same way , after we notice that @xmath255 and @xmath194 correspond to intersections of @xmath165 with @xmath256 , i.e. , of @xmath1 with @xmath98 .",
    "for @xmath260 we have @xmath195 . for small @xmath176 ,",
    "values of @xmath261 for which @xmath262 correspond to points in which @xmath56 looks in the direction of @xmath54 .",
    "each such point gives the homotopy class @xmath263 $ ] and is counted with a positive sign , if @xmath56 turns counter - clockwise relative to @xmath54 in a neighborhood of @xmath20 and with a negative sign otherwise .",
    "comparison with the definition of @xmath55 in section [ sec : selfintersec ] proves the lemma .      finally , to prove theorem [ th : nbfinite ] we need another configuration space .",
    "call @xmath264 the set of pairs of points @xmath217 on a circle such that the length of the arc @xmath265 and the length of the arc @xmath164 are both @xmath266 .",
    "topologically , @xmath264 is an annulus , and its boundary @xmath267 is a union of two circles @xmath268 and @xmath269 defined by the conditions @xmath270 and @xmath271 , respectively . the rest of the proof copies the proof of theorem [ th : finite ] ."
  ],
  "abstract_text": [
    "<S> the classical whitney formula relates the number of times an oriented plane curve cuts itself to its rotation number and the index of a base point . in this paper </S>",
    "<S> we generalize whitney s formula to curves on an oriented punctured surface @xmath0 . to define analogs of the rotation number and the index of a base point of a curve @xmath1 , we fix an arbitrary vector field on @xmath0 . </S>",
    "<S> similar formulas are obtained for non - based curves . </S>"
  ]
}