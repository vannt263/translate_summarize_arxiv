{
  "article_text": [
    "structural graph theory has proved to be a powerful tool for coping with computational intractability .",
    "it provides a wealth of concepts and results that can be used to design efficient algorithms for hard computational problems on specific classes of graphs occurring naturally in applications .",
    "of particular importance is the concept of _ tree width _ , introduced by robertson and seymour as part of their seminal graph minor series @xcite .",
    "graphs of small tree width can recursively be decomposed into subgraphs of constant size which can be combined in a tree like way to yield the original graph .",
    "this property allows to use algorithmic techniques such as dynamic programming , divide and conquer etc , to solve many hard computational problems efficiently on graphs of small tree width . in this way",
    ", a huge number of problems has been shown to become tractable , e.g. solvable in linear or polynomial time , on graph classes of bounded tree width .",
    "see e.g.  @xcite and references therein .",
    "but methods from structural graph theory , especially graph minor theory , also provide a powerful and vast toolkit of concepts and ideas to handle graphs of large tree width and to understand their structure .",
    "one of the most fundamental theorems in this context is the _ grid theorem _ , proved by robertson and seymour in @xcite .",
    "it states that there is a function @xmath4 such that every graph of tree with at least @xmath1 contains a @xmath5-grid as a minor .",
    "this function , initially being enormous , has subsequently been improved and is now polynomial @xcite .",
    "the grid theorem is important both for structural graph theory as well as for algorithmic applications .",
    "for instance , algorithmically it is the basis of an algorithm design principle called _ bidimensionality theory _ , which has been used to obtain many approximation algorithms , ptass , subexponential algorithms and fixed - parameter algorithms on graph classes excluding a fixed minor .",
    "these include feedback vertex set , vertex cover , minimum maximal matching , face cover , a series of vertex - removal parameters , dominating set , edge dominating set , r - dominating set , connected dominating set , connected edge dominating set , connected r - dominating set and unweighted tsp tour .",
    "see @xcite and references therein .",
    "furthermore , the grid theorem also plays a key role in robertson and seymour s graph minor algorithm and their solution to the disjoint paths problem @xcite ( also see @xcite ) in a technique known as the _ irrelevant vertex technique_. here , a problem is solved by showing that it can be solved efficiently on graphs of small tree width and otherwise , i.e.if the tree width is large and therefore the graph contains a large grid , that a vertex deep in the middle of the grid is irrelevant for the problem solution and can therefore be deleted .",
    "this yields a natural recursion that eventually leads to the case of small tree width .",
    "such applications also appear in some other problems , see @xcite .",
    "furthermore , with respect to graph structural aspects , the excluded grid theorem is the basis of the seminal structure and decomposition theorems in graph minor theory such as in @xcite .    the structural parameters and techniques discussed above all relate to undirected graphs . however , in various applications in computer science , the most natural model are directed graphs . given the enormous success width parameters",
    "had for problems defined on undirected graphs , it is natural to ask whether they can also be used to analyse the structure of digraphs and the complexity of np - hard problems on digraphs . in principle",
    "it is possible to apply the structure theory for undirected graphs to directed graphs by ignoring the direction of edges .",
    "however , this implies an information loss and may fail to properly distinguish between simple and hard input instances ( for example , the disjoint paths problem is np - complete for directed graphs even with only two source / terminal pairs @xcite , yet it is solvable in polynomial time for any fixed number of terminals for undirected graphs @xcite ) . hence , for computational problems whose instances are digraphs , methods based on undirected graph structure theory may be less useful .    as a first step towards a structure theory specifically for directed graphs , reed @xcite and johnson , robertson , seymour and thomas @xcite proposed a concept of _ directed tree width _ and showed that the @xmath2-disjoint paths problem is solvable in polynomial time for any fixed @xmath2 on any class of graphs of bounded directed tree width .",
    "reed @xcite and johnson et al .",
    "@xcite also conjectured a directed analogue of the grid theorem .",
    "* ( reed and johnson , robertson , seymour , thomas ) * there is a function @xmath0 such that every digraph of directed tree width at least @xmath1 contains a cylindrical grid of order @xmath2 as a butterfly minor    actually , according to @xcite , this conjecture was formulated by robertson , seymour and thomas , together with alon and reed at a conference in annecy , france in 1995 . here , a _ directed grid _ consists of @xmath2 concentric directed cycles and @xmath6 paths connecting the cycles in alternating directions .",
    "see figure  [ fig : grid ] for an illustration and definition  [ def : cyl - grid ] for details .",
    "a _ butterfly minor _ of a digraph @xmath7 is a digraph obtained from a subgraph of @xmath7 by contracting edges which are either the only outgoing edge of their tail or the only incoming edge of their head .",
    "see definition  [ def : butterfly ] for details . in an unpublished manuscript , johnson et al .",
    "@xcite proved the conjecture for planar digraphs .",
    "very recently , we started working on this conjecture , and made some progress .",
    "for example , in @xcite , this result was generalised to all classes of directed graphs excluding a fixed undirected graph as an undirected minor .",
    "this includes classes of digraphs of bounded genus .",
    "another related result was established in @xcite , where a half - integral directed grid theorem was proved .",
    "more precisely , it was shown that there is a function @xmath0 such that every digraph @xmath7 of directed tree width at least @xmath1 contains a half - integral grid of order @xmath2 . here ,",
    "essentially , _ a half - integral grid _ in a digraph @xmath7 is a cylindrical grid in the digraph obtained from @xmath7 by duplicating every vertex , i.e.  adding for each vertex an isomorphic copy with the same in- and out - neighbours .",
    "however , despite the conjecture being open for nearly 20 years now , no progress beyond the results mentioned before has been obtained .",
    "the main result of this paper , building on @xcite is to finally solve this long - standing open problem .",
    "[ thm : main ] there is a function @xmath0 such that every digraph of directed tree width at least @xmath1 contains a cylindrical grid of order @xmath2 as a butterfly minor    = [ shape = circle , fill = black , draw , inner sep=.4 mm ] = [ shape = circle , fill = white , draw , inner sep=.7 mm ] in 1,2,3,4 ( 0,0 ) circle ( ) ; , very thick ] ( 180 - 22.5 : )  ( 180 - 23.5 : ) ; ( -22.5 : )  ( -23.5 : ) ; in 0,45, ... ,350 ( n ) at ( :) ; ( 168 - 12.25:4 ) ",
    "( 167 - 12.25:4 ) ; ( 168 + 180 - 12.25:4 ) ",
    "( 167 + 180 - 12.25:4 ) ; in 0,90, ... ,350 ( :1 )  ( n4 ) ; in 45,135, ... ,350 ( : 4 )  ( n1 ) ;    we believe that this grid theorem for digraphs is a first but important step towards a more general structure theory for directed graphs based on directed tree width , similar to the grid theorem for undirected graphs being the basis of more general structure theorems .",
    "furthermore , it is likely that the duality of directed tree width and directed grids will make it possible to develop algorithm design techniques such as bidimensionality theory or the irrelevant vertex technique for directed graphs .",
    "we are particularly optimistic that this approach will prove very useful for algorithmic versions of erds - psa type results and in the study of the directed disjoint paths problem .",
    "as mentioned above , the half - integral directed grid theorem in @xcite has been used to show that a variant of the quarter - integral directed disjoint paths problem can be solved in polynomial time .",
    "it is conceivable that our grid theorem here will allow us to show that the half - integral directed disjoint paths problem can be solved in polynomial time . here",
    ", the half - integral directed disjoint paths problem is the problem to decide for a given digraph @xmath7 and @xmath2 pairs @xmath8 of vertices whether there are directed paths @xmath9 such that @xmath10 links @xmath11 to @xmath12 and such that no vertex of @xmath7 is contained in more than two paths from @xmath13 . while we are optimistic that the directed grid theorem will provide the key for proving that the problem is solvable in polynomial time , this requires much more work and significant new ideas and we leave this for future work .",
    "note that in a sense , half - integral disjoint paths are the best we can hope for , as the directed disjoint paths problem is np - complete even for only @xmath14 pairs of source / target pairs @xcite .",
    "however , the directed grid theorem may also prove relevant for the integral directed disjoint paths problem . in a recent breakthrough",
    ", cygan et al.@xcite showed that the planar directed disjoint paths problem is fixed - parameter tractable using an irrelevant vertex technique ( but based on a different type of directed grid ) .",
    "they show that if a planar digraph contains a grid - like subgraph of sufficient size , then one can delete a vertex in this grid without changing the solution .",
    "the bulk of the paper then analyses what happens if such a grid is not present .",
    "if one could prove a similar irrelevant vertex rule for the directed grids used in our paper , then the grid theorem would immediately yield the dual notion in terms of directed tree width for free .",
    "the directed disjoint paths problem beyond planar graphs therefore is another prime algorithmic application we envisage for directed grids .",
    "another obvious application of our result is to erds - psa type results such as younger s conjecture proved by reed et al.in 1996 @xcite .",
    "in fact , in their proof of younger s conjecture , reed et al .",
    "construct a kind of a directed grid .",
    "this technique was indeed a primary motivation for considering directed tree width and a directed grid minor as a proof of the directed grid conjecture would yield a simple proof for younger s conjecture .",
    "in fact our result immediately gives the following corollaries .",
    "our grid theorem implies the following stronger result than reed et al.in 1996 @xcite ( see also @xcite ) : for every @xmath15 and every integer @xmath16 , there exists an integer @xmath17 such that for every digraph @xmath7 , either @xmath7 has @xmath18 pairwise vertex disjoint directed cycles of length at least @xmath15 or there exists a set @xmath19 of at most @xmath20 vertices such that @xmath21 has no directed cycle of length at least @xmath15 . + the undirected version was proved by birmel , bondy and reed  @xcite , and very recently , havet and maia  @xcite proved the case @xmath22 for directed graphs . 2 .",
    "the half - integral directed grid theorem in @xcite has been used to show that a variant of the @xmath23-integral directed disjoint paths problem can be solved in polynomial time . by our new result",
    ", we can improve this to @xmath24-integral .",
    "* organisation and high level overview of the proof structure . * in section  [ sec : dtw ] , we state our main result and present relevant definitions . in sections",
    "[ sec : web - to - grid ] and  [ sec : cylindrical - grids ] , then , we present the proof of our main result .",
    "at a very high level , the proof works as follows .",
    "it was already shown in @xcite that if a digraph @xmath7 has high directed tree width , it contains a _ directed bramble _ of very high order ( see section  [ sec : dtw ] ) . from this bramble one",
    "either gets a subdivision of a suitable form of a directed clique , which contains the cylindrical grid as butterfly minor , or one can construct a structure that we call a _ web _ ( see definition  [ def : web - linkedness ] ) .",
    "our main technical contributions of this paper are in sections  [ sec : web - to - grid ] and  [ sec : cylindrical - grids ] . in section  [ sec : web - to - grid ]",
    "we show that this web can be ordered and rerouted to obtain a nicer version of a web called a _",
    "fence_. actually , we need a much stronger property for this fence .",
    "let us observe that a fence is essentially a cylindrical grid with one edge of each cycle deleted . in section  [ sec : web - to - grid ] , we also prove that there is a linkage from the bottom of the fence back to its top ( in addition , we require some other properties that are too technical to state here ) .    hence , in order to obtain a cylindrical grid , all that is needed is to find such a linkage that is disjoint from ( a subfence of ) the fence .",
    "the biggest problem here is that the linkage from the bottom of the fence back to its top can go anywhere in the fence .",
    "therefore , we can not get a subfence that is disjoint from this linkage .",
    "this means that we have to create a cylindrical grid from this linkage , together with some portion of the fence .",
    "this , however , is by far the most difficult and also the most novel part of the proof , which we present in section  [ sec : cylindrical - grids ] , and takes more than 20 pages .",
    "let us mention that our proof is constructive in the sense that we can obtain the following theorem , which may be of independent interest .",
    "[ thm : cor ] there is a function @xmath0 such that given any directed graph and any fixed constant @xmath2 , in polynomial time , we can obtain either    1 .   a cylindrical grid of order @xmath2 as a butterfly minor , or 2 .   a directed tree decomposition of width at most @xmath1 .",
    "note that the second conclusion follows from the result in @xcite , which says that for fixed @xmath3 , there is a polynomial time algorithm to construct a directed tree decomposition of a given directed graph @xmath7 of width @xmath25 , if @xmath7 has directed tree width at most @xmath3 .",
    "so for theorem  [ thm : cor ] , if the directed tree width of a given directed graph is at least @xmath26 , we obtain the first conclusion from the constructive proof of theorem  [ thm : main ] .",
    "otherwise , we obtain the second conclusion by the result in @xcite",
    ".    * acknowledgement .",
    "* we would like to thank julia chuzhoy , as well as an anonymous stoc referee for patiently reading an earlier full version of this paper , and suggesting useful improvements for the presentation .",
    "in this section we fix our notations and briefly review relevant concepts from graph theory .",
    "we refer to , e.g. ,  @xcite for details . for any @xmath27",
    "we define @xmath28 : = \\ { 1 , \\dots , n \\}$ ] . for any set @xmath29 and @xmath30",
    "we define @xmath31^{\\leq k } : = \\ { x\\subseteq u { \\mathrel : } |x|\\leq k \\}$ ] .",
    "we define @xmath31^{=k}$ ] etc . analogously .",
    "we write @xmath32 for the power set of @xmath29 .",
    "let @xmath7 be a digraph .",
    "we refer to its vertex set by @xmath33 and its edge set by @xmath34 .",
    "if @xmath35 is an edge then @xmath36 is its _ tail _ and @xmath37 its head . unless stated explicitly otherwise , all paths in this paper are directed .",
    "we therefore simply write _ path _ for _ directed path_.    the following non - standard notation will be used frequently throughout the paper . if @xmath38 and @xmath39 are paths and @xmath40 is an edge whose tail is the last vertex of @xmath38 and whose head is the first vertex of @xmath39 then @xmath41 is the path @xmath42 obtained from concatenating @xmath40 and @xmath39 to @xmath38 .",
    "we will usually use this notation in reverse direction and , given a path @xmath43 and an edge @xmath44 write `` let @xmath38 and @xmath39 be subpaths of @xmath43 such that @xmath45 . ''",
    "hereby we define the subpath @xmath38 to be the initial subpath of @xmath43 up to the tail of @xmath40 and @xmath39 to be the suffix of @xmath43 starting at the head of @xmath40 .",
    "in this paper we will work with a version of directed minors known as _ butterfly minors _",
    "( see @xcite ) .",
    "[ def : butterfly ] let @xmath7 be a digraph .",
    "an edge @xmath46 is _ butterfly - contractible _ if @xmath40 is the only outgoing edge of @xmath36 or the only incoming edge of @xmath37 . in this case",
    "the graph @xmath47 obtained from @xmath7 by butterfly - contracting @xmath40 is the graph with vertex set @xmath48 , where @xmath49 is a fresh vertex .",
    "the edges of @xmath47 are the same as the edges of @xmath7 except for the edges incident with @xmath36 or @xmath37 .",
    "instead , the new vertex @xmath49 has the same neighbours as @xmath36 and @xmath37 , eliminating parallel edges .",
    "a digraph @xmath50 is a _ butterfly - minor _ of @xmath7 if it can be obtained from a subgraph of @xmath7 by butterfly contraction",
    ".        see figure  [ fig : butterfly ] for an illustration of butterfly contractions .",
    "we illustrate butterfly - contractions by the following example , which will be used frequently in the paper .",
    "[ ex : butterfly ] let @xmath7 be a digraph .",
    "let @xmath51 be a directed path in @xmath7 consisting of two subpaths @xmath52 joined by an edge @xmath40 with tail in @xmath53 and head in @xmath54 .",
    "if every edge in @xmath55 incident to a vertex @xmath56 has @xmath37 as its head and every edge in @xmath55 incident to a vertex @xmath57 has @xmath36 as its tail then @xmath58 can be butterfly - contracted into a single vertex , as then every edge in @xmath59 is the only outgoing edge of its tail and every edge in @xmath60 is the only incoming edge of its head .",
    "[ def : intersection - graph ] let @xmath61 and @xmath62 be sets of pairwise disjoint paths in a digraph @xmath7 .",
    "the _ intersection graph @xmath63 _ of @xmath61 and @xmath62 is the bipartite ( undirected ) graph with vertex set @xmath64 and an edge between @xmath65 and @xmath66 if @xmath67 .",
    "we will also frequently use ramsey s theorem ( see e.g.@xcite ) .",
    "[ thm : ramsey ] for all integers @xmath68 , there exists a ( minimum ) integer @xmath69 so that if @xmath70 is a set with @xmath71 , @xmath43 is a set of @xmath72 colours and @xmath73^l$ ] is a function assigning a colour from @xmath43 to every @xmath3-element subset of @xmath70 then there exist @xmath74 with @xmath75 and @xmath76 so that @xmath77 for all @xmath78 with @xmath79",
    ".    we will also need the following lemma adapted from @xcite . in the following lemma ,",
    "we denote by @xmath80 , for some @xmath81 , the biorientation of the complete graph on @xmath82 vertices .",
    "[ lem : clique ] there is a computable function @xmath83 such that for all @xmath84 , if @xmath85 and @xmath86^{\\leq k}$ ] such that @xmath87 for all @xmath88 then there is @xmath89 such that @xmath90 for all @xmath91 .",
    "let @xmath92 denote the @xmath18-th ramsey number as defined above .",
    "we first define the function @xmath93 inductively as follows . for all @xmath16 let @xmath94 and for @xmath95 let @xmath96    we prove the lemma by induction on @xmath2 . for @xmath97",
    "there is nothing to show .",
    "so let @xmath98 .",
    "choose a vertex @xmath99 and colour all edges @xmath40 in @xmath100 by @xmath37 if @xmath101 and by @xmath102 otherwise .",
    "let @xmath103 . by ramsey s theorem , as @xmath104 there is a set @xmath105 of size @xmath3 such that all edges between elements of @xmath106 are coloured @xmath37 or there is such a set where all edges are coloured @xmath102 .",
    "in the first case , let @xmath47 be the subgraph of @xmath107 induced by @xmath106 .",
    "then , @xmath108 for all @xmath109 and as @xmath110 , we can apply the induction hypothesis to find the desired clique @xmath111 in @xmath47 .",
    "so suppose @xmath106 induces a subgraph where all edges are labelled @xmath102 .",
    "let @xmath112 $ ] and @xmath113 for all @xmath114 $ ] .",
    "as @xmath115 , by the induction hypothesis , @xmath47 contains a subgraph @xmath116 such that @xmath117 for all @xmath118 .",
    "hence , @xmath119 $ ] is the required subgraph of @xmath7 isomorphic to @xmath120 with @xmath121 for all @xmath91 .",
    "[ lem : clique - vertex ] for all integers @xmath84 , if @xmath122 and @xmath123^{\\leq k}$ ] such that @xmath124 for all @xmath99 then there is @xmath89 such that @xmath125 for all @xmath126 .",
    "we construct @xmath50 greedily . in each step",
    "we choose a vertex from @xmath7 , add it to @xmath50 and delete @xmath127 from @xmath7 .",
    "we also need the next result by erds and szekeres@xcite .",
    "[ thm : szekeres ] let @xmath128 be integers and let @xmath129 .",
    "let @xmath130 be distinct integers .",
    "then there exist @xmath131 such that @xmath132 or there exist @xmath133 such that @xmath134 .      a _ linkage _ @xmath135 is a set of mutually vertex - disjoint directed paths in a digraph . for two vertex sets @xmath136 and @xmath137",
    ", @xmath135 is a _",
    "@xmath136-@xmath137 linkage _ if each member of @xmath61 is a directed path from a vertex in @xmath136 to some other vertex in @xmath137 .",
    "the _ order _ of the linkage , denoted by @xmath138 , is the number of paths . in slightly sloppy notations",
    ", we will sometimes identify a linkage @xmath135 with the subgraph consisting of the paths in @xmath135 .",
    "furthermore , we define @xmath139 and @xmath140 .",
    "let @xmath7 be a digraph and @xmath141 .",
    "@xmath142 is _ well linked _ , if for all @xmath143 with @xmath144 there is an @xmath145-linkage of order @xmath146 .",
    "a separation @xmath147 in an undirected graph is a pair @xmath148 such that @xmath149 .",
    "the order is @xmath150 .",
    "separation _ in a directed graph @xmath7 is an ordered pair @xmath151 of subsets of @xmath33 with @xmath152 so that no edge has the tail in @xmath153 and the head in @xmath154 .",
    "its _ order _ is @xmath155 .",
    "we shall frequently need the following version of menger s theorem .",
    "[ thm : menger ]",
    "let @xmath156 be a digraph with @xmath157 and let @xmath158 be an integer . then exactly one of the following holds :    * there is a linkage from @xmath142 to @xmath159 of order @xmath2 or * there is a separation @xmath160 of @xmath7 of order less than @xmath2 with @xmath161 and @xmath162 .",
    "let @xmath163 .",
    "a _ half - integral @xmath142-@xmath159 linkage of order @xmath2 _ in a digraph @xmath7 is a set @xmath61 of @xmath2 @xmath142-@xmath159-paths such that no vertex of @xmath7 is contained in more than two paths in @xmath61 .",
    "the next lemma collects simple facts about half - integral linkages which are needed below .",
    "[ lem : half - integral ] let @xmath7 be a graph and @xmath164 .    1 .",
    "if @xmath7 contains a half - integral @xmath142-@xmath159 linkage of order @xmath2 then @xmath7 contains an @xmath142-@xmath159-linkage of order @xmath165 .",
    "if @xmath166 and @xmath7 contains an @xmath142-@xmath159-linkage @xmath167 of order @xmath2 and a @xmath159-@xmath168-linkage @xmath169 of order @xmath2 then @xmath7 contains an @xmath142-@xmath168-linkage of order @xmath165 .",
    "part ( 2 ) follows immediately from part ( 1 ) as @xmath167 and @xmath169 can be combined to a half - integral @xmath142-@xmath168-linkage ( this follows as @xmath166 and therefore the endpoints of @xmath167 and @xmath169 in @xmath159 coincide ) .    for part ( 1 ) , suppose towards a contradiction that @xmath7 does not contain an @xmath142-@xmath159-linkage of order @xmath165 .",
    "hence , by menger s theorem , there is a separation @xmath160 of @xmath7 of order @xmath170 such that @xmath161 and @xmath162 .",
    "but then there can not be a half - integral @xmath142-@xmath159-linkage of order @xmath2 as every vertex in @xmath171 can only be used twice .",
    "we now define _ minimal linkages _ , which play an important role in our proof .",
    "let @xmath7 be a digraph , let @xmath172 and let @xmath173 be a subgraph . for @xmath174 , a @xmath168-@xmath175-linkage @xmath167 of order",
    "@xmath2 is _ minimal with respect to @xmath50 _ , or _",
    "@xmath50-minimal _ , if for all edges @xmath176 there is no @xmath168-@xmath175-linkage of order @xmath2 in the graph @xmath177 .",
    "the following lemma will be used later on .",
    "[ lem : min - linkage - closure ] let @xmath7 be a digraph .",
    "let @xmath61 be a linkage and let @xmath167 be a linkage such that @xmath167 is @xmath61-minimal",
    ". then @xmath167 is @xmath178-minimal for every @xmath179 .",
    "it suffices to show the lemma for the case where @xmath180 for some path @xmath58 .",
    "the general case then follows by induction .",
    "suppose @xmath167 is not @xmath178-minimal .",
    "hence , there is an edge @xmath181 such that there is an @xmath142-@xmath159-linkage @xmath169 of order @xmath2 in @xmath182 . clearly , this edge has to be in @xmath183 as it would otherwise violate the minimality of @xmath167 with respect to @xmath61 .",
    "furthermore , @xmath169 must use every edge in @xmath184 as again it would otherwise violate the @xmath61-minimality of @xmath167 . let @xmath185 be the maximum directed subpath of @xmath186 containing @xmath40 and let @xmath187 be its first and last vertex , respectively .    if @xmath82 and @xmath188 are both end vertices of paths in @xmath167 then this implies that @xmath189 and no vertex of @xmath43 is adjacent in @xmath190 to any vertex of @xmath178 .",
    "hence in @xmath191 there is no path from @xmath82 to @xmath188 , contradicting the choice of @xmath169 .",
    "it follows that at least one of @xmath192 is not an endpoint of a path in @xmath167 .",
    "we assume that @xmath82 is this vertex .",
    "the case for @xmath188 is analogous .",
    "so suppose @xmath82 is not an end vertex of any path in @xmath167 .",
    "let @xmath193 be the edge in @xmath194 with head @xmath82 .",
    "as any two paths in @xmath61 are pairwise disjoint , the edge @xmath193 can not be in @xmath195 .    by construction of @xmath43 , no vertex in @xmath196 is incident to any edge in @xmath197 other than the edges in @xmath43 .",
    "furthermore , as explained above , @xmath193 must be in @xmath198 as it is not in @xmath195 ( and hence if @xmath193 were not in @xmath198 , then @xmath169 would be @xmath61-minimal ) . as @xmath82 is not an end vertex of a path in @xmath167 , and hence not an end vertex of a path in @xmath169 ,",
    "this implies that there must be an outgoing edge of @xmath82 in @xmath169 .",
    "but this must be on the path @xmath43 .",
    "hence , @xmath169 must include both @xmath43 and the edge @xmath193 , a contradiction .",
    "note that the converse is not true . i.e.  if @xmath167 is @xmath61-minimal and @xmath199 then @xmath169 may no longer be @xmath61-minimal . in the rest of the paper",
    "we will mainly use the following property of minimal linkages .",
    "[ lem : no - forward - paths ] let @xmath7 be a digraph and @xmath200 be a subgraph .",
    "let @xmath201 be a @xmath61-minimal linkage between two sets @xmath142 and @xmath159 .",
    "let @xmath202 be a path and let @xmath203 .",
    "let @xmath204 be the two components of @xmath205 such that the tail of @xmath40 lies in @xmath206 .",
    "then there are at most @xmath207 paths from @xmath206 to @xmath208 in @xmath209 .    as @xmath201 is @xmath61-minimal , there are no @xmath146-pairwise vertex disjoint @xmath142-@xmath159 paths in @xmath210 .",
    "let @xmath211 be a minimal @xmath142-@xmath159 separator in @xmath212 .",
    "hence , @xmath213 and @xmath211 contains exactly one vertex from every @xmath214 .    towards a contradiction ,",
    "suppose there were @xmath146 pairwise vertex - disjoint paths from @xmath206 to @xmath208 in @xmath212 . at most",
    "@xmath215 of these contain a vertex from @xmath211 and hence there is an @xmath206-@xmath208 path @xmath216 in @xmath217 .",
    "but then @xmath218 contains an @xmath142-@xmath159 path in @xmath217 , contradicting the fact that @xmath211 is an @xmath142-@xmath159 separator in @xmath219 .",
    "hence , there are at most @xmath215 disjoint paths from @xmath206 to @xmath208 in @xmath212 and therefore at most @xmath146 pairwise vertex - disjoint @xmath206-@xmath208 paths in in @xmath220 .",
    "the main result of this paper is the grid theorem for directed tree width .",
    "we briefly recall the definition of directed tree width from @xcite .    by an _ arborescence _ we mean a directed graph @xmath221 such that @xmath221 has a vertex @xmath222 , called the _ root _ of @xmath221 , with the property that for every vertex @xmath223 there is a unique directed path from @xmath222 to @xmath146 .",
    "thus every arborescence arises from a tree by selecting a root and directing all edges away from the root . if @xmath224 we write @xmath225 if @xmath226 and there exists a directed path in @xmath221 with initial vertex @xmath146 and terminal vertex @xmath227 . if @xmath228 we write @xmath229 if either @xmath230 or @xmath225 , where @xmath146 is the head of @xmath40 .",
    "let @xmath7 be a digraph and let @xmath231 .",
    "we say that a set @xmath232 is _",
    "@xmath70-normal _ if there is no directed walk in @xmath233 with the first and the last vertex in @xmath211 that uses a vertex of @xmath234 .",
    "it follows that every @xmath70-normal set is the union of the vertex sets of strongly connected components of @xmath233 .",
    "it is straightforward to check that a set @xmath211 is @xmath70-normal if , and only if , the vertex sets of the strongly connected components of @xmath233 can be numbered @xmath235 in such a way that    1 .",
    "if @xmath236 , then no edge of @xmath7 has head in @xmath237 and tail in @xmath238 , and 2 .",
    "either @xmath239 , or @xmath240 for some integers @xmath241 with @xmath242 .",
    "a _ directed tree decomposition _ of a digraph @xmath7 is a triple @xmath243 , where @xmath19 is an arborescence , @xmath244 and @xmath245 are functions such that    1 .",
    "@xmath246 is a partition of @xmath247 into nonempty sets and 2 .   if @xmath248 , then @xmath249 is @xmath250-normal .    for any @xmath251",
    "we define @xmath252 , where @xmath253 if @xmath40 is incident with @xmath188 .    the _ width _ of @xmath254 is the least integer @xmath255 such that @xmath256 for all @xmath257 . the _ directed tree width _ of @xmath7 is the least integer @xmath255 such that @xmath7 has a directed tree decomposition of width @xmath255 .",
    "the sets @xmath258 are called the _ bags _ and the sets @xmath250 are called the _ guards _ of the directed tree decomposition .",
    "it is easy to see that the directed tree width of a subdigraph of @xmath7 is at most the directed tree width of @xmath7 .",
    "= [ shape = circle , fill = black , draw , inner sep=.4 mm ] = [ shape = circle , fill = white , draw , inner sep=.7 mm ] in 1,2,3,4 ( 0,0 ) circle ( ) ; , very thick ] ( 180 - 22.5 : )  ( 180 - 23.5 : ) ; ( -22.5 : ) ",
    "( -23.5 : ) ; in 0,45, ... ,350 ( n ) at ( :) ; ( 168 - 12.25:4 ) ",
    "( 167 - 12.25:4 ) ; ( 168 + 180 - 12.25:4 ) ",
    "( 167 + 180 - 12.25:4 ) ; in 0,90, ... ,350 ( :1 ) ",
    "( n4 ) ; in 45,135, ... ,350 ( : 4 )  ( n1 ) ;    [ ex : dtw ]    [ cols=\"^,^ \" , ]     let @xmath259 for some ( and hence all ) @xmath260 . let @xmath261 be the set of paths in @xmath262 ending in a start vertex of a path in @xmath263 .",
    "finally , let @xmath264 be the set of minimal subpaths of paths @xmath265 containing every vertex @xmath43 has in common with @xmath266 . by construction , every @xmath267 is disjoint from every @xmath268 . for every @xmath269 we can therefore take the subpath @xmath270 from the beginning of @xmath43 to the predecessor of the first vertex @xmath43",
    "has in common with @xmath266 .",
    "let @xmath271 .",
    "then @xmath264 and @xmath266 form a segmentation . by lemma  [ lem : segmentation - grid ]",
    ", @xmath272 contains an acyclic grid @xmath273 such that the paths @xmath274 are obtained from subpaths of @xmath264 and @xmath266 preserving the end vertices of the paths in @xmath266 .",
    "let @xmath275 be ordered in the order in which they appear on the paths in @xmath274 and let @xmath276 ordered in the order in which they appear on @xmath277 .",
    "see figure  [ fig : sec6 - 5 ] a ) .",
    "now let @xmath278 be the subgrid of @xmath279 formed by @xmath280 where @xmath281 is the set of minimal subpaths of @xmath277 to include every vertex of @xmath282 and @xmath283 are the minimal subpaths of @xmath282 including every vertex they have in common with @xmath281 .    then ,",
    "if @xmath284 in @xmath279 there is a linkage @xmath167 of order @xmath285 from the start vertices of @xmath286 to the bottom of @xmath278 and a linkage @xmath169 @xmath285 from the top of @xmath278 to the end vertices of @xmath287 . furthermore , in @xmath288 there is a linkage @xmath289 from the end vertices of @xmath287 to the start vertices of @xmath286 .",
    "as @xmath290 are pairwise disjoint except for the end vertices they have in common , they form a linkage @xmath291 from the top of @xmath278 to the bottom which is disjoint from @xmath278 . as we require that @xmath292 by lemma  [ tech00 ] , @xmath293 form a cylindrical grid of order @xmath2 as a butterfly minor .    by the previous claim , in every @xmath262",
    "there is a path @xmath294 and a path @xmath295 such that the endpoint of @xmath221 is the start vertex of @xmath216 and a set @xmath296 of order @xmath297 such that @xmath216 hits every path @xmath298 within @xmath262 . for all @xmath299",
    "we choose such a path @xmath300 and @xmath301 .",
    "note that @xmath302 is a segmentation of @xmath303 , hence no path @xmath301 can intersect any @xmath298 at a vertex @xmath37 which occurs on @xmath43 before a vertex @xmath304 for some @xmath305 .",
    "as @xmath306 we can choose a set @xmath307 of paths @xmath300 and @xmath301 such that @xmath308 for all @xmath309 .",
    "let @xmath310 for some ( and hence all ) @xmath311 .",
    "hence , @xmath307 and @xmath312 form a pseudo - fence as required .",
    "the current situation is illustrated in figure  [ fig : sec6 - 5 ] b ) .",
    "let @xmath313 be the path such that every @xmath314 contains a good vertex @xmath315 on @xmath316 .",
    "we define @xmath317 .",
    "now , @xmath307 and @xmath318 are no longer a pseudo - fence , but they are a pseudo - fence in restriction to @xmath312 and furthermore , every path @xmath300 and @xmath301 in @xmath307 also intersects @xmath316 .    recall that @xmath307 is a set of paths @xmath319 and @xmath320 .",
    "let @xmath321 be an ordering of the paths @xmath322 in the order in which they occur on the paths in @xmath312 .",
    "we require @xmath323 for some value of @xmath324 to be determined below .",
    "as in the proof of the previous lemma we define horizontal strips @xmath325 and @xmath326 , and let @xmath327 where @xmath328 is the minimal subpath of @xmath43 containing every vertex of @xmath329 .",
    "recall from above that every path @xmath330 is split into three distinct parts , @xmath331 , @xmath332 and @xmath333 .",
    "the subpaths @xmath332 and @xmath333 are part of the construction of @xmath307 , where the @xmath332 play the role of the @xmath300 above and the @xmath333 play the role of @xmath301 .",
    "we will now use the initial subpaths , @xmath331 . recall further that the endpoint of each @xmath331 for @xmath334 is on the path @xmath316 .",
    "there is a @xmath335 such that @xmath336 is disjoint from @xmath337 .    towards a contradiction ,",
    "suppose the claim was false .",
    "for every @xmath335 choose a path @xmath338 such that @xmath339 intersects @xmath337 .",
    "as @xmath339 ends in @xmath316 , in fact ends in @xmath340 , and furthermore , every path @xmath341 intersects @xmath342 , this implies that there is a path @xmath10 from @xmath342 to @xmath340 in @xmath343 .",
    "note that for @xmath344 the paths @xmath10 and @xmath345 may not be disjoint , as , e.g. , @xmath339 may intersect @xmath262 and @xmath346 .",
    "however , the set @xmath347 forms a half - integral linkage from @xmath342 to @xmath340 and therefore , by lemma  [ lem : half - integral ] , there also is an integral linkage of order @xmath348 .",
    "see figure  [ fig : last - claim ] for an illustration .        as @xmath349",
    "this contradicts the fact that in @xmath303 at most @xmath350 paths can go from some @xmath351 to @xmath352 .",
    "let @xmath353 be such that @xmath354 is disjoint from @xmath337 .",
    "let @xmath355 , i.e.  @xmath356 is the same as @xmath262 with the paths @xmath333 removed , which are no longer needed .",
    "we require that @xmath357 where @xmath358 is the function defined in corollary  [ cor : split - minimal ] . by lemma [ lem : segmentation - grid ]",
    ", @xmath359 contains a grid @xmath360 which can be chosen so that the start vertices of the paths @xmath332 are preserved .",
    "let @xmath361 be ordered in the order in which they occur on the paths in @xmath362 and let @xmath363 be ordered in the order in which the paths occur on the paths in @xmath356 .",
    "we now take the subgrid @xmath364 induced by @xmath365 and @xmath366 . more precisely , for every @xmath367 let @xmath368 be the minimal subpath of @xmath50 containing @xmath369 and for all @xmath370 let @xmath371 be the minimal subpath of @xmath372 containing all of @xmath373 .",
    "then @xmath364 is the grid induced by @xmath374 and @xmath375 . by lemma  [ grid ]",
    ", @xmath364 contains a fence @xmath376 whose top @xmath19 and bottom @xmath159 are subsets of the top and bottom of @xmath364 .",
    "we can now construct a linkage from @xmath159 to @xmath19 as follows .",
    "let @xmath377 be the set of paths @xmath331 with end vertex in @xmath19 . by construction ,",
    "every @xmath331 intersects every @xmath352 for @xmath378 .",
    "hence , @xmath379 contains a half - integral linkage from @xmath159 to @xmath19 , and therefore by lemma  [ lem : half - integral ] , also an integral linkage @xmath167 from @xmath159 to @xmath19 of order @xmath380 .    finally , as @xmath381 lemma  [ tech00 ] implies that @xmath364 together with @xmath167 contains a cylindrical grid of order @xmath2 as a butterfly minor .",
    "this completes the proof of theorem  [ thm : main - cylindrical ] and hence the proof of theorem  [ thm : main - bramble ] and therefore theorem  [ thm : main ] .",
    "in this paper we proved the directed grid conjecture by reed and johnson , robertson , seymour and thomas .",
    "we view this result as a first but significant step towards a more general structure theory for directed graphs based on directed tree width , similar to the grid theorem @xcite for undirected graphs being the basis of more general structure theorems @xcite .      _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ there is a function @xmath0 such that given any directed graph and any fixed constant @xmath2 , in polynomial time , we can obtain either    1 .   a cylindrical grid of order @xmath2 as a butterfly minor , or 2 .   a directed tree decomposition of width at most @xmath1 . _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _    we also believe that this theorem will prove to be very useful for further applications of directed tree width , for instance to erds - psa type results for directed graphs",
    "furthermore , it is likely that the duality of directed tree width and directed grids will make it possible to develop algorithm design techniques such as bidimensionality theory or the irrelevant vertex technique for directed graphs .",
    "we are particularly optimistic that this approach will lead to some apparently new ( and most likely best possible ) results for the directed disjoint paths problem .",
    "we leave this to our future project .            h.  l. bodlaender .",
    "treewidth : algorithmic techniques and results . in _ proc .",
    "of mathematical foundations of computer science ( mfcs ) _ , volume 1295 of _ lecture notes in computer science _ , pages 1936 , 1997 .",
    "m.  cygan , d.  marx , m.  pilipczuk , and m.  pilipczuk .",
    "the planar directed k - vertex - disjoint paths problem is fixed - parameter tractable . in _",
    "54th annual ieee symposium on foundations of computer science ( focs ) _ , pages 197206 , 2013 .",
    "k. kawarabayashi , y.  kobayashi , and s.  kreutzer .",
    "an excluded half - integral grid theorem for digraphs and the directed disjoint paths problem . in _ proc . of the acm symposium on theory of computing ( stoc )",
    "70 - 78 , 2014 .",
    "k.  kawarabayashi , m.  krl , d.  krl , and s.  kreutzer .",
    "packing directed cycles through a specified vertex set . in _",
    "acm - siam symp . on discrete algorithms ( soda )",
    "365 - 377 , 2013 .",
    "s.  kreutzer and s.  tazari .",
    "on brambles , grid - like minors , and parameterized intractability of monadic second - order logic . in _ acm - siam symp .",
    "on discrete algorithms ( soda ) , pp . 354364 , 2010 .",
    "_ , ( full version to appear in the journal of the acm ) ."
  ],
  "abstract_text": [
    "<S> the grid theorem , originally proved by robertson and seymour in graph minors v in 1986 , is one of the most central results in the study of graph minors . </S>",
    "<S> it has found numerous applications in algorithmic graph structure theory , for instance in bidimensionality theory , and it is the basis for several other structure theorems developed in the graph minors project .    in the mid-90s , reed and johnson , robertson , seymour and thomas ( see @xcite ) , independently , conjectured an analogous theorem for directed graphs , i.e.  the existence of a function @xmath0 such that every digraph of directed tree - width at least @xmath1 contains a directed grid of order @xmath2 . in an unpublished manuscript from 2001 , johnson , </S>",
    "<S> robertson , seymour and thomas gave a proof of this conjecture for planar digraphs . </S>",
    "<S> but for over a decade , this was the most general case proved for the reed , johnson , robertson , seymour and thomas conjecture .    in this paper , nearly two decades after the conjecture was made , we are finally able to confirm the reed , johnson , robertson , seymour and thomas conjecture in full generality and to prove the directed grid theorem .    as consequence of our results </S>",
    "<S> we are able to improve results in reed et al.in 1996 @xcite ( see also @xcite ) on disjoint cycles of length at least @xmath3 and in @xcite on quarter - integral disjoint paths . </S>",
    "<S> we expect many more algorithmic results to follow from the grid theorem . </S>"
  ]
}