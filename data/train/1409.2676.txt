{
  "article_text": [
    "a key objective in many areas of science is to uncover the interactions amongst a large number of variables based on a limited amount of data .",
    "examples include gene regulatory networks , where one wants to identify the interactions amongst dna segments , market basket analysis where the relations are studied between customers based on their purchase behavior , or neuroscience where the connections between segregated neuronal populations are linked to cognitive ability and impairment . one way to estimate these relations is to employ gaussian graphical models , where the non - zero entries in the off - diagonal of a precision matrix correspond to the edges in a conditional independence graph  @xcite .",
    "however , fully bayesian estimation of the posterior of a gaussian graphical model has proven to be notoriously hard .",
    "to allow bayesian inference of the gaussian graphical model , a conjugate prior  @xcite on a precision matrix restricted by the conditional independence graph @xmath0 was constructed for decomposable graphs  @xcite , and later generalized to arbitrary graphs  @xcite .",
    "subsequent work coined this distribution the @xmath0-wishart distribution  @xcite .",
    "a number of monte carlo algorithms for model estimation using the @xmath0-wishart distribution have been developed  @xcite , but each of these algorithms required substantial computational resources due to difficulty with sampling from the @xmath0-wishart distribution . to address this bottleneck ,",
    "a recent study proposed an efficient way to directly sample from the @xmath0-wishart distribution  @xcite by scaling samples from a regular wishart distribution to fit the required dependency structure  @xcite .",
    "even with the direct sampler , approximating the gaussian graphical model remained difficult because of the doubly intractable partition function of the @xmath0-wishart distribution .",
    "however , by combining features of the exchange algorithm  @xcite with reversible jump sampling  @xcite , calculating the partition function may be circumvented  @xcite .",
    "the algorithm that implements this idea , named the double reversible jump algorithm , provides substantial computational gains compared to earlier approaches  @xcite .",
    "although the double reversible jump algorithm enables model selection in a more efficient manner than previously possible , computational costs remain a limiting factor in practical applications with a large number of variables . in this paper , we propose two novel , faster , algorithms for bayesian estimation of the gaussian graphical model . in the first algorithm , we combine the direct sampler  @xcite with an efficient representation of the conditional bayes factor  @xcite , which results in an elegant metropolis - hastings algorithm to which we will refer as the double conditional bayes factor sampler . in the second algorithm",
    ", we cast the double conditional bayes factors algorithm in a birth - death mcmc setting  @xcite . here , rather than accepting or rejecting a new state with an edge added or removed , we associate with these changes birth and death events , respectively .",
    "these events occur with such rates that their equilibrium coincides with the posterior of interest  @xcite .",
    "both algorithms provide substantial speed improvement over the status quo , as we show in simulations .",
    "we also provide an application of our algorithms by estimating structural and functional connectivity between subcortical structures using resting - state fmri .",
    "it is a major goal in cognitive neuroscience to understand how spatially segregated neural populations are coupled , using indirect measures of neural activity such as functional magnetic resonance imaging  @xcite . in this context , the anatomical pathways between neural populations are referred to as structural connectivity whereas correlated activity patterns between these populations are referred to as functional connectivity  @xcite .",
    "both forms of connectivity may be estimated simultaneously using gaussian graphical models . here",
    ", the precision matrix captures the functional interactions between variables and the associated conditional independence graph represents the direct connections between variables .",
    "bayesian estimation of gaussian graphical models is particularly relevant since the posterior over precision matrices provides complete information about the strength of functional interactions and the posterior over conditional independence graphs allows one to associate a probability with a putative direct connection between variables of interest .",
    "let observed data @xmath1 consist of @xmath2 independent draws from a @xmath3-dimensional multivariate gaussian distribution @xmath4 , with zero mean and precision ( inverse covariance ) matrix @xmath5 . here , @xmath6 , with @xmath7 the space of positive definite @xmath8 matrices .",
    "the likelihood of @xmath5 is given by @xmath9 \\enspace,\\ ] ] where @xmath10 is the empirical covariance and @xmath11 the trace inner product operator .",
    "the precision matrix has the important property that zero elements correspond to conditional independencies . in other words ,",
    "specifies a gaussian markov random field with respect to a graph @xmath12 , with @xmath13 and @xmath14 , in which the absence of a connection indicates independence , i.e. @xmath15 . for convenience , throughout this paper we slightly abuse notation and use @xmath16 to indicate that the edge @xmath17 is present in @xmath18 .",
    "the dependency graph may be used to specify a prior distribution on the precision matrix , which is known as the @xmath0-wishart distribution  @xcite : @xmath19 { \\mathbf{\\bm 1}}_{{\\mathbf{\\bm k}}\\in\\mathbb{p}_g } \\enspace,\\ ] ] in which @xmath20 is the space of positive definite @xmath8 matrices that have zero elements wherever @xmath21 , @xmath22 is the prior degrees of freedom , @xmath23 is the prior scaling matrix and @xmath24 evaluates to 1 if and only if @xmath25 holds and to 0 otherwise .",
    "the @xmath0-wishart distribution is conjugate to the multivariate gaussian likelihood in  , so that @xmath26 \\enspace.\\ ] ] note that the wishart distribution is a special case of the @xmath0-wishart distribution , with which it coincides if @xmath0 is a fully connected graph .",
    "importantly , the partition function @xmath27 depends on @xmath0 , which makes the @xmath0-wishart a doubly intractable distribution .",
    "we return to the implications of this fact later on .",
    "central to this work is that we wish to perform model selection in gaussian graphical models , which revolves around the joint posterior @xmath28 in the remainder , we outline several algorithms to approximate this distribution .",
    "since the prior @xmath29 is @xmath30 , we need a way to draw samples from the @xmath0-wishart distribution .",
    "up until recently , this was achieved using a block gibbs sampler that updates @xmath5 according to either the edges of @xmath0  @xcite or its clique decomposition  @xcite .",
    "although this enables model inference of @xmath31 , as desired , both approaches require substantial computational effort , making them prohibitive for use in contexts with a large number of variables .",
    "an alternative method was proposed that is more efficient  @xcite , which is an adaptation of an algorithm for estimating the mode @xmath32 of the @xmath0-wishart distribution  @xcite .",
    "the algorithm is as follows :    1 .   sample @xmath33 .",
    "2 .   let @xmath34 .",
    "repeat for @xmath35 until convergence : 1 .",
    "let @xmath36 be the set of variables that are connected to @xmath37 in @xmath0 .",
    "+ form @xmath38 and @xmath39 and solve @xmath40 2 .",
    "form @xmath41 by copying the elements of @xmath42 to the appropriate + locations and imputing zeros in those locations not connected to @xmath37 in @xmath0 .",
    "3 .   replace @xmath43 and @xmath44 with @xmath45 .",
    "4 .   return @xmath46 .",
    "conceptually , the algorithm draws a sample from a wishart distribution , which is then iteratively scaled according to the dependence structure in @xmath0 . in practice",
    ", we observe that convergence ( see step 3 ) is typically reached within a handful of iterations , even for moderate to large @xmath3 .",
    "the direct sampler paves the way for novel inference algorithms . here ,",
    "we introduce two novel algorithms for approximation of the joint posterior in  .      as a baseline for comparison",
    ", we use the double reversible jump ( drj ) sampler  @xcite .",
    "this algorithm was shown to be more efficient as previously used approaches and may be considered state of the art .",
    "it builds upon the reversible jump sampler discussed in  @xcite .",
    "the key idea offered by this approach is that it introduces an auxiliary variable @xmath47 , as in the exchange algorithm  @xcite , that is efficiently sampled using the direct sampler discussed above . because of the way this auxiliary variable",
    "is constructed , the doubly intractable partition functions of the @xmath0-wishart distribution are canceled out in the calculation of the acceptance ratios of newly proposed graphs .",
    "the double reversible jump algorithm provides a substantial improvement over previous algorithms , as it avoids the need to approximate the ratio of partition functions or invoke the gibbs sampling algorithm for drawing samples from the @xmath0-wishart distribution .",
    "nonetheless , the algorithm can be simplified . in  @xcite it",
    "is shown that if @xmath0 and @xmath48 differ only in the edge @xmath49 and @xmath50 , the odds ratio of these two models may be expressed as @xmath51 with @xmath52 \\enspace , \\ ] ] where @xmath53 , with @xmath54 the cholesky decomposition of @xmath5 .",
    "the term in   can be considered the conditional bayes factor of the comparison between @xmath0 and @xmath48 .",
    "similar to the double reversible jump approach ,  @xcite propose to augment the sampling process with an auxiliary variable @xmath47 .",
    "this results in a convenient acceptance ratio for the addition of an edge to @xmath0 @xmath55 where the ratio is inverted if the edge is removed from @xmath0 instead .",
    "note that the variables @xmath56 and @xmath23 must be permuted for each edge flip to place the particular edge under consideration in the position @xmath57 .",
    "the algorithm described in  @xcite employs the block gibbs sampler to sample from the @xmath0-wishart distribution . instead",
    ", here we propose to make use of the direct sampler explained in section  [ sec : sampler ] to arrive at the following procedure for estimation of the gaussian graphical model :    1 .",
    "let @xmath58}$ ] be the current graph and let @xmath59}\\sim \\mathcal{w}_g(\\delta+n , { \\mathbf{\\bm d}}+{\\mathbf{\\bm s}})$ ] .",
    "2 .   for each edge @xmath16 ,",
    "create a permutation of the variables so that @xmath60 .",
    "permute @xmath61 and @xmath62 accordingly .",
    "2 .   let @xmath63 if @xmath64 or @xmath65 if @xmath66 .",
    "3 .   draw @xmath67 .",
    "4 .   accept the move from @xmath0 to @xmath48 with probability @xmath68 as in  .",
    "5 .   restore the original ordering of @xmath61 and @xmath62 and draw @xmath69 3 .",
    "set @xmath70}=\\tilde{g}$ ] and @xmath71}\\sim \\mathcal{w}_{\\tilde{g}}(\\delta+n , { \\mathbf{\\bm d}}+{\\mathbf{\\bm s}})$ ] .",
    "the usage of the direct sampler instead of the block gibbs updates makes this direct double conditional bayes factors ( dcbf ) algorithm computationally much more efficient  @xcite .",
    "a downside of the usage of an auxiliary variable scheme is that it decreases the acceptance probability of proposals , as essentially two moves have to be accepted at once .",
    "this hampers mixing of the markov chain , so that multimodal distributions are approximated poorly . to improve acceptance ,  @xcite introduce a birth - death continuous - time markov process  @xcite for gaussian graphical models . rather than accepting the addition or removal of an edge ,  @xcite associates birth and death events with these changes , respectively .",
    "each edge dies independently of all others as a poisson process with death rate @xmath72 . because the edges are independent , the overall death rate at a particular pair of graph @xmath0 and precision @xmath5 is @xmath73 .",
    "birth rates @xmath74 are defined similarly , but for non - edges instead .    because the birth and death processes are independent poisson processes , the expected time between two events is @xmath75 .",
    "this time can be considered the process spends at any particular instance of @xmath76 .",
    "the probability of the death event of edge @xmath77 is @xmath78 with again an analogous definition for the birth event for a non - edge .",
    "mohammadi and wit  @xcite show that the birth - death process has the posterior @xmath79 as stationary distribution , if for all edges and non - edges @xmath80 @xmath81 for @xmath82 .",
    "the birth and death rates may be chosen accordingly as @xmath83 with again @xmath82 .",
    "the key observation is now that these birth - death rates can be computed using the double conditional bayes factors as in  .",
    "here again we make use of the exchange framework by introducing the auxiliary variable @xmath84 , such that explicit evaluation of the partition functions is circumvented .",
    "this leads to a novel approach that we will refer to as the double continuous time ( dct ) sampler , given by :    1 .",
    "let @xmath58}$ ] be the current graph and let @xmath59}\\sim \\mathcal{w}_g(\\delta+n , { \\mathbf{\\bm d}}+{\\mathbf{\\bm s}})$ ] .",
    "2 .   for each non - edge @xmath85 : 1 .   create a random permutation of the variables so that @xmath60 . permute @xmath61 and @xmath62 accordingly .",
    "2 .   let @xmath82 .",
    "draw @xmath86 3 .",
    "compute the birth rate @xmath87 using  .",
    "3 .   compute the total birth rate of the current state @xmath88 .",
    "4 .   for each edge @xmath77 : 1 .   create a random permutation of the variables so that @xmath60 .",
    "permute @xmath61 and @xmath62 accordingly .",
    "2 .   let @xmath89 .",
    "draw @xmath86 3 .",
    "compute the death rate @xmath72 using  .",
    "5 .   compute the total death rate of the current state @xmath90 and the waiting time between events @xmath91 .",
    "create a birth or death event according to the probabilities of death events   and birth events , and set @xmath70}=\\tilde{g}$ ] and @xmath71 } \\sim \\mathcal{w}_{\\tilde{g}}(\\delta+n , { \\mathbf{\\bm d}}+{\\mathbf{\\bm s}})$ ] .",
    "in this section we first analyze the validity of the two proposed methods using an example with a known precision matrix .",
    "subsequently we apply the algorithms in an explorative study to identify structural and functional connectivity between subcortical brain structures .",
    "we compared the performance of the double reversible jump algorithm and the two novel algorithms using a simulation proposed in  @xcite . in this example",
    ", we have @xmath92 and @xmath93 .",
    "furthermore , the precision matrix @xmath5 is given by @xmath94 for @xmath95 , @xmath96 for @xmath97 and finally @xmath98 .",
    "the associated conditional independence graph @xmath0 follows as @xmath99 .",
    "the scatter matrix is then constructed as @xmath100 , which corresponds to @xmath2 independent observations of @xmath101 . through exhaustive enumeration of all 32,768 possible graphs of size @xmath3",
    ",  @xcite shows that the posterior edge probabilities are @xmath102 and the expectation of @xmath5 is @xmath103 we approximate this ground truth using the three different algorithms , each implemented in matlab . throughout",
    ", we use vague priors in the form of @xmath104 for @xmath0 and @xmath105 .",
    "the algorithms are each executed for 100,000 iterations , of which the first 50,000 are discarded as burn - in .",
    "conditional expectations for edges ( i.e.  edge probabilities ) and precision matrices are then calculated as @xmath106 for the double reversible jump and the double conditional bayes factor algorithms , with @xmath107 the number of samples . for the double continuous time algorithm ,",
    "these expectations are calculated as @xmath108 with @xmath109 .",
    "it is easy to see that this idea generalizes the discrete time mcmc approach by assuming @xmath110 for all @xmath111 .",
    "we quantify the approximation accuracy of the three algorithms in a number of ways .",
    "first , the accuracy of the edge probabilities is expressed using the mean squared error with respect to the true probabilities in  .",
    "second , we compute the kullback - leibler divergence  @xcite between the precision matrix obtained in  @xcite as defined in   and @xmath112 using either of the algorithms .",
    "we also count the number of unique models that each algorithm considers to express mixing behavior .",
    "next , we compute the marginal posterior probability of the true graph . finally , we compute the relative computational speeds of the algorithms .",
    "the results of the comparison are shown in table  [ tab : simresults ] .",
    "the algorithms have similar performance in approximating the desired posterior distribution and each obtains the true graph as the mode of the approximated distribution .",
    "contrary to  @xcite , we do not find the continuous time algorithm to have the best mixing .",
    "in fact , of the three considered models , the continuous time mcmc approach finds the smallest number of unique models . note that the continuous time approach may converge faster  @xcite , but this is not apparent in this simulation .",
    "finally , the efficiency of our way of computing the conditional bayes factor ( see  ) is demonstrated by a substantial speed increase , as the dcbf algorithm is 3.57 times faster than the drj sampler , and the dct algorithm is 3.80 times faster than the drj algorithm , whereas the algorithm in  @xcite is 1.79 times slower than the drj sampler .",
    ".results for the comparison between the three described samplers on a simulated example , averaged over 10 simulations .",
    "standard errors are indicated in parentheses . shown",
    "are the mean squared error ( mse ) of edge probabilities relative to  , the kullback - leibler divergence ( kl ) between the expected precision matrix and  , the number of unique models visited , the marginal posterior probability of the true graph @xmath113 and the relative speed of the algorithms compared to the double reversible jump baseline .",
    "[ cols= \" < , > , > , > , > , > \" , ]      as an explorative example , we estimate structural and functional connectivity in a fully bayesian setting . in previous work",
    ", functional connectivity has been estimated under the assumption that the underlying structural connectivity was known  @xcite . here",
    ", we address the more challenging problem of simultaneously estimating the posterior distribution of both structural and functional connectivity .",
    "+      the data consist of resting - state functional mri data collected for one subject .",
    "we refer the reader to  @xcite for details of the acquisition protocol .",
    "preprocessing was performed using fsl 5.0  @xcite and consisted of the following steps .",
    "t1 images were linearly registered to mni-152 space .",
    "multi - echo volumes at each tr were combined  @xcite .",
    "motion correction was performed using mcflirt and estimated motion parameters were regressed out together with their temporal derivatives and mean time courses for both wm and csf . finally ,",
    "data were high - pass filtered at 0.001 hz .",
    "subcortical structures were segmented using fsl first  @xcite , resulting in data for a total of 14 regions , consisting of bilateral accumbens , amygdala , caudate , hippocampus , pallidum , putamen and thalamus ( see fig .  [",
    "fig : subcort]a ) . for each of these regions",
    "the signal was averaged over all voxels in that region and subsequently standardized to have zero mean and unit variance .",
    "the human brain can be viewed as a complex dynamical system where ongoing changes in neuronal dynamics produce adaptive behavior  @xcite .",
    "these dynamics can be expressed in terms of interactions between brain regions , which is commonly referred to as functional connectivity . at the same time , direct functional interactions presuppose anatomical links between brain regions , known as structural connectivity .",
    "for this reason , structural and functional connectivity must be intimately related  @xcite .",
    "functional connectivity is most easily expressed using a covariance matrix that , in the case of standardized data , provides the correlation structure between different brain regions .",
    "however , this approach suffers from the drawback that it can not distinguish between direct and indirect connections .",
    "alternatively , one may use partial correlations that capture only direct effects , in the absence of confounding factors .",
    "the matrix of partial correlations @xmath114 may be obtained from a precision matrix using @xmath115 if @xmath116 and @xmath117 otherwise . because functional coupling must be accompanied by an anatomical connection , partial correlations between brain regions not only reveal the strength of these couplings , but also indicate which regions are physically connected . in other words ,",
    "the joint posterior in   becomes a distribution over functional connectivity @xmath5 ( or , equivalently , @xmath114 ) and structural connectivity @xmath0 .",
    "we proceed by approximating the joint posterior using both the dcbf algorithm as well as the dct sampler .",
    "both algorithms were executed for 100,000 iterations , of which the first 50,000 were discarded as burn in . once again , we set @xmath118 and @xmath105 .",
    "the algorithms yield almost identical results , as shown by an mse of edge probabilities of 0.0006 and a symmetrized kullback - leibler divergence of 0.0002 .    figure  [ fig : subcort]b shows the posterior edge probabilities and partial correlations produced by the dct algorithm .",
    "the structural connectivity estimate shows that the majority of edges is associated with either very high or very low edge probabilities .",
    "the functional connectivity estimate shows that functional homologues in left and right hemispheres are associated with high partial correlations ( expected partial correlations @xmath119 in the range @xmath120 $ ] ) , indicating that these functional homologues have similar functional roles . within a cortical hemisphere ,",
    "the most salient functional interactions ( highest expected partial correlations with @xmath119 in the range @xmath121 $ ] ) are given bilaterally by amygdala@xmath122hippocampus , pallidum@xmath122putamen , accumbens@xmath122caudate , caudate@xmath122thalamus , and hippocampus@xmath122thalamus .",
    "these functional interactions can be explained by direct pathways as well as unobserved common inputs that induce a high partial correlation .",
    "interestingly , edges with high posterior probability ( edge probability higher than 0.999 ) can be associated with weak absolute partial correlations ( with @xmath119 as low as 0.1 ) .",
    "this indicates that there exist weakly coupled regions ( from the linear correlation point of view ) that can not be explained away by other functional interactions .",
    "we have proposed two novel algorithms for bayesian model selection in a gaussian graphical model .",
    "the first algorithm combines a direct manner to sample @xmath0-wishart variates  @xcite with an efficient way of computing conditional bayes factors when comparing two different models  @xcite , resulting in an improved metropolis - hastings approach .",
    "the second approach integrates the direct sampler within a birth - death continuous time markov process  @xcite .",
    "both algorithms provide accurate estimates of the posterior graphs and precision matrices and are substantially faster ( up to a factor of 3.80 ) than previously available alternatives .",
    "we demonstrate the use of the algorithms by estimating , for the first time , both structural and functional connectivity simultaneously using fmri data .    in future work we aim to improve mixing of the samplers by introducing moves between graphs that differ by more than a single edge .",
    "similarly , one may conceive events other than births and deaths of edges . in either case , the corresponding conditional bayes factors must be derived , and these should be more efficient to compute than a series of consecutive edge additions and removals . we expect that this will further contribute to efficient estimation of gaussian graphical models .",
    "the authors gratefully acknowledge the support of the braingain smart mix programme of the netherlands ministry of economic affairs and the netherlands ministry of education , culture and science .",
    "alex lenkoski s work is supported by statistics for innovation , ( sfi)@xmath123 , in oslo .",
    "the authors thank erik van oort and david norris for the acquisition of the fmri data ."
  ],
  "abstract_text": [
    "<S> bayesian estimation of gaussian graphical models has proven to be challenging because the conjugate prior distribution on the gaussian precision matrix , the @xmath0-wishart distribution , has a doubly intractable partition function . </S>",
    "<S> recent developments provide a direct way to sample from the @xmath0-wishart distribution , which allows for more efficient algorithms for model selection than previously possible . </S>",
    "<S> still , estimating gaussian graphical models with more than a handful of variables remains a nearly infeasible task . </S>",
    "<S> here , we propose two novel algorithms that use the direct sampler to more efficiently approximate the posterior distribution of the gaussian graphical model . </S>",
    "<S> the first algorithm uses conditional bayes factors to compare models in a metropolis - hastings framework . </S>",
    "<S> the second algorithm is based on a continuous time markov process . </S>",
    "<S> we show that both algorithms are substantially faster than state - of - the - art alternatives . </S>",
    "<S> finally , we show how the algorithms may be used to simultaneously estimate both structural and functional connectivity between subcortical brain regions using resting - state fmri .    </S>",
    "<S> efficient sampling of gaussian graphical models using conditional bayes factors    max hinne^1^ , alex lenkoski^2^ , tom heskes^1^and marcel van gerven^1^    ^1^radboud university nijmegen , the netherlands    ^2^norwegian computing center , norway </S>"
  ]
}