{
  "article_text": [
    "let @xmath1 be a fixed terminal time and let @xmath2 be a filtered probability space whose filtration is augmented with the @xmath3-null sets .",
    "let @xmath4 be a given time - grid on @xmath5 $ ] and @xmath6 .",
    "additionally , for a fixed @xmath7 , we are given a set @xmath8 of @xmath9-valued random variables in @xmath10 ( i.e. , square integrable and @xmath11-measurable ) that we call malliavin weights . here",
    "@xmath12 stands for the transpose . in this paper , we introduce the malliavin weights least squares algorithm , abbreviated _ mwls _ , to approximate discrete time stochastic processes @xmath13 defined by @xmath14 , & \\quad $ 0 \\le i \\le n$ , \\vspace*{5pt}\\cr \\displaystyle z_i= \\mathbb{e}_i\\biggl[\\xi{h^{(i)}_{n } } + \\sum_{j = i+1}^{n-1 } f_j(y_{j+1},z_j ) { h^{(i)}_{j } } \\delta_j\\biggr ] , & \\quad",
    "$ 0 \\le i \\le n-1$,}\\label{eqmalscheme}\\end{aligned}\\ ] ] where @xmath15:= \\mathbb{e}[\\cdot\\mid\\mathcal{f}_{t_i}]$ ] , @xmath16 is a @xmath17-valued random variable in @xmath10 , and @xmath18 is @xmath19-measurable .",
    "this system is solved backward in time in the order @xmath20 and it takes the form of a dynamic programming equation with malliavin weights .",
    "we call it the malliavin weights dynamic programming equation ( mwdp for short ) .",
    "the main application of ( [ eqmalscheme ] ) is to approximate continuous - time , decoupled forward  backward sdes ( fbsdes ) of the form @xmath21 where @xmath22 is a brownian motion in @xmath23 , @xmath24 is a diffusion in @xmath25 and @xmath26 is of the form @xmath27 .",
    "indeed , the mwdp ( [ eqmalscheme ] ) was inspired by @xcite , theorem  4.2 , which states that there is a version of the continuous - time process @xmath28 given by @xmath29 , \\label{eq4z}\\ ] ] where the processes @xmath30 are malliavin weights defined by @xmath31 for @xmath32 being the malliavin derivative of @xmath33 and @xmath34 is the diffusion coefficient of @xmath35 .",
    "the representation ( [ eq4z ] ) is obtained via a malliavin calculus integration by parts formula , see @xcite for a general account on the subject .",
    "a discretization procedure to approximate the fbsde with ( [ eqmalscheme ] ) , including explicit definitions of the random variables @xmath36 based on  ( [ eq4malweights ] ) , is given in @xcite , where the author also computes the discretization error in terms of @xmath37 .",
    "in honour of the connection between ( [ eqmalscheme ] ) and ( [ eqbsdects])([eq4z ] ) , we call the random variables @xmath36 malliavin weights , @xmath26 the terminal condition , and @xmath38 the driver .",
    "we say that the pair @xmath13 satisfying ( [ eqmalscheme ] ) solves a mwdp with terminal condition @xmath26 and driver @xmath39 .      in this paper ,",
    "we are not concerned with the discretization procedure , but rather with the analysis of the mwdp equation ( [ eqmalscheme ] ) itself and its numerical resolution via the mwls algorithm , in which one uses empirical least - squares regressions ( approximations on finite basis of functions using simulations ) to compute conditional expectations . since the system ( [ eqmalscheme ] ) may be relevant to problems beyond the fbsde system ( [ eqbsdects])([eq4z ] ) , we allow the framework and assumptions to accomodate as much generality as possible . however , mwls is , to the best of our knowledge , the first direct implementation of formula ( [ eq4z ] ) in a fully implementable numerical scheme . for other applications of malliavin calculus in numerical simulations , with different perspectives and results to ours ,",
    "see , for instance , @xcite .",
    "we adapt the recent theoretical analysis of the least squares multi - step forward dynamical programming algorithm ( lsmdp ) of @xcite for discrete bsdes ( without malliavin weights ) to the setting of mwdp . as in the aforementioned reference , we consider a locally lipschitz driver @xmath39 that is locally bounded at @xmath40  see section  [ section4assumptions ] .",
    "this allows the algorithm of the current paper to be applied for the approximation of some quadratic bsdes and for some proxy / variance reduction methods . for more details on these applications ,",
    "see @xcite , section  2.2 . moreover , we make use of analogous stability results and conditioning arguments in the proof of the main result , theorem  [ thmmcerr ] , as in the proof of @xcite , theorem 4.11 . however , the malliavin weights lead to significantly differences in the main theorem and stability results , both in the technical elements of the proofs and the results .",
    "we develop seemingly novel gronwall type inequalities to handle the technical differences ; these results are outlined in section  [ sectiongronwall ] and proved in appendix  [ appendixprooflemintegrals ] .",
    "furthermore , the stability results are more powerful and the complexity of the mwls is better than the lsmdp , as will be discussed in what follows .",
    "we would like to mention that the class of quadratic problems we can treat with these assumptions is quite different to the recent @xcite .",
    "here we are treating the non - degenerate setting where the terminal condition may be hlder continuous , whereas the other reference allows degeneracy at the expense of requiring locally lipschitz terminal conditions .",
    "we prove stability results on the mwdp in section  [ sectionstability ] .",
    "much effort is made to keep the constants explicit .",
    "these results are instrumental throughout the paper .",
    "the stability estimates on @xmath0 are at the individual time points ( coherently with the representation theorem of @xcite ) rather than the time - averaged estimates of @xcite , proposition  3.2 .",
    "this allows for finer and more precise computations .",
    "the time - dependency in our estimates also takes better into account the regularity of the terminal condition , similarly to the continuous - time case @xcite .",
    "section  [ section4mc ] is the core of the paper : it is dedicated to the mwls algorithm in the markovian context @xmath41 and @xmath42 for some markov chain @xmath43 in @xmath25 and unknown functions @xmath44 . in mwls , the conditional expectations in ( [ eqmalscheme ] ) are replaced by monte carlo least - squares regressions . for each point of the time - grid , we use a cloud of independent paths of the markov chain @xmath35 and the malliavin weights @xmath45 , and some approximation spaces for representing the value functions @xmath44 .",
    "the algorithm is detailed in section  [ sectionmcalg ] , and a full error analysis in terms of the number of simulations and the approximation spaces is performed in sections  [ sectionerr ] and  [ sectionproofmainthm ] . the final error estimates ( theorem  [ thmmcerr ] ) are similar to @xcite , theorem 4.11 , in that they are the time - averaged local regression errors of the discrete bsde , but the results are in a stronger norm and the time - dependency is better .",
    "the constants are completely explicit .",
    "although the norms are stronger than in @xcite , the estimates do not deteriorate ; instead , they are significantly improved .",
    "this is intrinsically due to the mwdp representation , which avoids the usual factor in front of all controls on @xmath0 .",
    "this improvement can be tracked by inspecting the a.s .",
    "bounds ( compare ( [ eqasz ] ) and @xcite , equation  ( 14 ) ) and the statistical error bounds ( compare the @xmath46-terms in ( [ eqerr ] ) of theorem  [ thmmcerr ] and the @xmath47-terms of @xcite , theorem 4.11 ) .",
    "these error estimates are optimal with respect to the convergence rates ( up to logarithmic factors ) under high generality regarding the distribution of the stochastic model for @xmath35 and @xmath45 , even if the constants may be conservative .",
    "this is because the local regression errors are optimal under model - free estimates ( proposition  [ propeqyzerrdecom ] ) .     with the error estimates of theorem  [ thmmcerr ] in hand",
    ", we perform a complexity analysis in section  [ sectioncomplexity ] .",
    "we propose a choice of basis functions and use it to calibrate the number of simulations in order to achieve a specified error level .",
    "this then allows us to compute the complexity of the algorithm for that error level .",
    "the methodology for doing this is analogous to @xcite , section  4.4 , in that we use the same basis functions  which also enable us to study the benefit of smoothness properties of the underlying markov functions @xmath44  and also in that we set the ensure the global error level by calibrating the local regression errors .",
    "however , the conclusion of this section is that mwls yields better performance in terms of complexity than lsmdp .",
    "the main reason for this is the improved time - dependancy of the error estimates , which is a systemic improvement that allows one to make generate fewer simulations to obtain certain error levels .",
    "unfortunately , the complexity reduction does not reduce the dependence on the dimension compared to the lsmdp .",
    "the curse of dimensionality still appears , and the rates depend on the dimension of the markov chain @xmath35 ( i.e. , @xmath48 ) .",
    "nevertheless , the reduction of complexity is substantial and , since one is able to make fewer simulations to obtain the same error level , will help alleviate the pressure on memory resources that is typical with least - squares monte carlo algorithms",
    ".    this paper is theoretically oriented , and is aimed at paving the way for new such numerical approaches based on malliavin calculus .",
    "future works will be devoted to a deeper investigation about the numerical performance of the mwls algorithm compared to other known numerical schemes .",
    "* @xmath49 stands for the euclidean norm of the vector @xmath50 , @xmath51 denotes the transpose operator .",
    "* @xmath52)^{{1}/{p } } $ ] stands for the @xmath53-norm ( @xmath54 ) of a random variable @xmath55 .",
    "the conditional version is denoted by @xmath56)^{1/p}$ ] . to indicate that @xmath55 is additionally measurable w.r.t .",
    "the @xmath57-algebra @xmath58 , we may write @xmath59 . * for a multi - dimensional process @xmath60 , its @xmath61th component is denoted by @xmath62 .",
    "* for any finite @xmath63 and @xmath64 , define the truncation function @xmath65 .",
    "* for finite @xmath66 , @xmath67 is the natural logarithm of @xmath50 .",
    "the following assumptions hold throughout the entirety of the paper .",
    "let @xmath68 be a fixed parameter : this constant determines which time - grid can be used .",
    "the larger @xmath69 , the larger the class of admissible time - grids .",
    "all subsequent error estimates depend on @xmath69 .    1 .",
    "@xmath26 is in @xmath10 .",
    "2 .   a.   @xmath70 is @xmath71-measurable for every @xmath72 , and there exist deterministic parameters @xmath73 $ ] and @xmath74 such that @xmath75 for any @xmath76 .",
    "b.   there exist deterministic parameters @xmath77 $ ] and @xmath78 such that @xmath79 c.   the time - grid @xmath80 satisfies @xmath81 3 .   for all @xmath82 ,",
    "the malliavin weights satisfy @xmath83 = 0 , \\qquad\\bigl(\\mathbb{e}\\bigl[\\bigl{\\vert}{h^{(i)}_{j}}\\bigr{\\vert}^2\\mid \\mathcal{f}_{t_i}\\bigr ] \\bigr)^{1/2}\\le\\frac{c_{m } } { ( t_j - t_i)^{1/2}}\\ ] ] for a finite constant @xmath84 .    _ comments .",
    "_ we remark that assumptions @xmath85  and @xmath86  are the same as their equivalents in @xcite , section  2 .",
    "the usual case of `` lipschitz '' bsde is covered by @xmath87 . as explained in @xcite , the case of locally lipschitz driver ( @xmath88 and/or @xmath89 ) is interesting because it allows a large variety of applications , such as solving bsdes using proxy methods or variance reduction methods , and solving quadratic bsdes .",
    "we refer the reader to @xcite , section  2.2 , for details .",
    "assumption @xmath86  is much simpler compared to @xcite .",
    "if @xmath90 , @xmath86  is satisfied by any time grid with non - increasing time - step , such as the grids of @xcite .",
    "this may be valuable for future work on time - grid optimization .",
    "assumption @xmath91  is specific to the dynamic programming equation with malliavin weights .",
    "it is satisfied for the weights derived in @xcite , and this can remain true after discretization ( see @xcite or @xcite ) .",
    "it is also satisfied if @xmath35 takes the form @xmath92 ( like multi - dimensional geometric brownian motion ) , by a simple change of variables one can use the malliavin weights @xmath93 ( note the process @xmath35 may be degenerate ) .",
    "the following assumptions will mostly be used in section  [ section4mc ] .",
    "@xmath94 , @xmath95 , and @xmath96  give us a markov representation for solutions of the discrete bsdes ( see equation ( [ eqmarkov ] ) later ) .",
    "@xmath97  is used for obtaining ( model free ) estimates on regression errors .",
    "we also include additional optional assumptions , @xmath98 , on the terminal condition to obtain tighter estimates on @xmath99 ( see corollary  [ coras ] and subsequent remarks ) .    1 .",
    "@xmath35 is a markov chain in @xmath25 @xmath100 adapted to @xmath101 . for every @xmath72 and @xmath102",
    ", there exist @xmath103-measurable functions @xmath104 where @xmath105 is independent of @xmath106 , such that @xmath107 .",
    "2 .   a.   @xmath26 is a bounded @xmath108-measurable random variable : @xmath109 .",
    "b.   @xmath26 is of form @xmath110 for a bounded , measurable function @xmath111 .",
    "in addition to @xmath97 , for some @xmath112 $ ] and a finite constant @xmath113 , we have @xmath114 for any @xmath115 .",
    "4 .   for every @xmath72 ,",
    "the driver is of the form @xmath116 , and @xmath117 is @xmath118-measurable and @xmath86  is satisfied .",
    "in addition to @xmath91 , for every @xmath72 and @xmath102 , there is a function @xmath119 that is @xmath120-measurable , where @xmath105 is independent of @xmath121 , such that @xmath122 .",
    "_ comments .",
    "_ @xmath94  is usually satisfied when @xmath35 is the solution of sde or its euler scheme built on the time - grid @xmath123 .",
    "the statement of @xmath98  is inspired by the fractional smoothness condition of @xcite , although somewhat stronger .",
    "it is satisfied , for instance , if the terminal function @xmath111 is @xmath124-hlder continuous and if the markov chain satisfies @xmath125 \\le c_x ( t - t_i)$ ] .",
    "this is a reasonable assumption on the markov chain , since it is satisfied by a diffusion process ( possibly including bounded jumps ) with bounded coefficients and also by its euler approximation .",
    "indeed , we have @xmath126    @xmath96  is satisfied by the malliavin weights ( [ eq4malweights ] ) under various conditions .",
    "it is valid for the example @xmath92 mentioned before .",
    "consider now the more complex case of the sde with ( deterministic ) coefficients @xmath127 for the drift and @xmath128 for the diffusion ( @xmath129 ) both having first space - derivatives that are uniformly bounded .",
    "recall the relation for the malliavin derivative of a sde given by @xmath130 where @xmath131 denotes the sde solution starting from @xmath50 at time @xmath132 , and @xmath133 for @xmath134 solving the @xmath135-dimensional , matrix valued linear sde @xmath136 then , it is an easy exercise to prove that if @xmath137 and its inverse are uniformly bounded , then @xmath96  is fulfilled .",
    "here we gather deterministic inequalities frequently used throughout the paper . these inequalities are crucial due to novel technical problems caused by the malliavin weights .",
    "they show how linear inequalities with singular coefficients propagate .",
    "they take the form of unusual gronwall type inequalities .",
    "their proofs are postponed to appendix  [ appendixprooflemintegrals ] .",
    "we assume that @xmath123 is in the class of time - grids satisfying @xmath86 .",
    "[ lemintegrals ] let @xmath138 be finite .",
    "there exists a finite constant @xmath139 depending only on @xmath140 , @xmath141 and @xmath142 ( but not on the time - grid ) such that , for any @xmath143 , @xmath144    [ lemiterationgen1 ] let @xmath145 $ ] and @xmath146 .",
    "suppose that , for a finite constant @xmath147 , the finite non - negative real - valued sequences @xmath148 and @xmath149 satisfy @xmath150 then , for two finite constants @xmath151 and @xmath152 that depend only on @xmath153 and @xmath69 , @xmath154\\\\[-8pt]\\nonumber & & { } + { { \\mathcal c}_{(\\ref{eqiterationfeed2}\\mathrm{b})}}\\sum _ { l = j+1}^{n-1 } \\frac{u_l \\delta_l}{(t - t_l)^{{{1}/2 - \\beta } } } , \\qquad k\\leq j \\leq n.\\end{aligned}\\ ] ]    [ lemiterationgen2 ] let @xmath145 $ ] and @xmath155 .",
    "assume that the finite non - negative real - valued sequences @xmath156 and @xmath149 satisfy ( [ eqiterationfeed2 ] ) for finite constants @xmath151 and @xmath152 .",
    "then , for any finite @xmath157 , there is a finite constant @xmath158 ( depending only on @xmath159 , @xmath160 , @xmath161 , @xmath141 , @xmath142 , @xmath69 and @xmath162 ) such that @xmath163\\\\[-8pt]\\nonumber & & \\quad   \\le { { \\mathcal c}^{(\\gamma)}_{(\\ref{eqintuw } ) } } \\sum_{l = j+1}^{n-1 } \\frac{w_l\\delta _ l}{(t - t_l)^{1/2 - \\beta}(t_l -t_j)^{1-\\gamma } } , \\qquad k\\leq j \\leq n.\\end{aligned}\\ ] ]    plugging ( [ eqintuw ] ) with @xmath164 into ( [ eqiterationfeed ] ) gives a ready - to - use result .",
    "[ coroiterationgen2 ] under the assumptions of lemma  [ lemiterationgen1 ] , ( [ eqiterationfeed ] ) implies @xmath165      suppose that @xmath166 ( resp .",
    ", @xmath167 ) solves a mwdp with terminal condition / driver @xmath168 ( resp . , @xmath169 ) .",
    "we are interested in obtaining estimates on the differences @xmath170 . to give a notion of how stability estimates are used ,",
    "the processes @xmath171 are typically obtained by construction .",
    "for example , in section  [ sectionas ] , they are @xmath172 , whereas in the proof of theorem  [ thmmcerr ] , they are a set of processes determined from a series of arguments based on conditioning w.r.t . the monte carlo samples .",
    "one then applies the stability estimates based on a priori knowledge that what stands on the right - hand side is beneficial to the computations . in corollary",
    "[ coras ] , for example , the right - hand side yields almost sure bounds for the processes @xmath13 .",
    "we note that the assumptions on the drivers in this section are somewhat weaker than the general assumptions of section  [ section4assumptions ] .",
    "the driver @xmath173 does not have to be lipschitz continuous , but we assume that each @xmath174 is in @xmath175 so that @xmath176 and @xmath177 are also square integrable for any @xmath178 ( thanks to @xmath91 ) .",
    "the driver @xmath179 is locally lipschitz continuous w.r.t . @xmath180 as in @xmath86 , which is crucial for the validity of the a priori estimates .",
    "additionally , we do not insist that the drivers be adapted , which will be needed in the setting of sample - dependant drivers .",
    "define @xmath181 let @xmath182 be fixed : throughout this subsection , @xmath183-conditional @xmath184-norms are considered and we recall the notation @xmath185}$ ] for any square integrable random variable  @xmath55 . for @xmath186 , define @xmath187 using @xmath91 , we obtain @xmath188 = \\mathbb { e}_i[(\\delta\\xi- \\mathbb{e}_i \\delta\\xi){h^{(i)}_{n}}]$ ] and @xmath189\\bigr { \\vert}^2 & \\leq & \\mathbb{e}_i\\bigl[{\\vert}\\delta\\xi- \\mathbb{e}_i \\delta\\xi{\\vert}^2\\bigr ] \\frac { c_{m}^2 } { ( t_n - t_i ) } , \\nonumber\\\\[-8pt]\\\\[-8pt]\\nonumber \\bigl{\\vert}{\\mathbb{e}}_i z\\bigl [ \\delta f_j { h^{(i)}_{j } } \\bigr]\\bigr{\\vert}^2 & \\le&\\frac { c_m^2 { \\mathbb{e}}_i[{\\vert}\\delta f_j{\\vert}^2]}{t_j - t_i } , \\qquad j \\ge i+1.\\end{aligned}\\ ] ]",
    "combining this kind of estimates with @xmath86  and the triangle inequality , our stability equations ( for @xmath190 ) are @xmath191\\label{eqbounddelz2 } \\\\[-8pt]\\nonumber & & { }   + \\sum_{j = i+1}^{n-1 } \\frac{l_{f_2}c_{m}{\\vert}\\theta _ j{\\vert}_{2,k}}{(t - t_j)^{(1-{\\theta_l})/2}\\sqrt{t_j - t_i } } \\delta_j.\\end{aligned}\\ ] ]    [ propstability ] taking @xmath192 , @xmath193 and @xmath194 in lemmas  [ lemiterationgen1 ] and  [ lemiterationgen2 ] , recall the constant @xmath195 .",
    "assume that @xmath196 is in @xmath175 .",
    "moreover , for each @xmath197 , assume that @xmath198 is in @xmath175 and @xmath179 is locally lipschitz continuous w.r.t .",
    "@xmath199 and @xmath200 as in @xmath86 , with a constant @xmath201",
    ". then , under @xmath91 , we have @xmath202 where the above constants can be written explicitly : @xmath203    using ( [ eqbounddely2 ] ) and ( [ eqbounddelz2 ] ) , we obtain @xmath204\\\\[-8pt]\\nonumber & & { } + ( c_{m}+\\sqrt t ) \\sum_{l = j+1}^{n-1 } \\frac{l_{f_2 } { \\vert}\\theta _ l{\\vert}_{2,k}\\delta_l}{(t - t_l)^{(1-{\\theta_l})/2}\\sqrt{t_l - t_j}},\\qquad j\\geq k.\\end{aligned}\\ ] ] _ upper bound for _ ( [ eqboundtheta2 ] ) .",
    "we apply lemmas  [ lemiterationgen1 ] and  [ lemiterationgen2 ] under the setting @xmath205 , @xmath206 , @xmath207 , @xmath208 , @xmath209 . to make results fully explicit , we first need to upper bound quantities of the form ( @xmath210 ) @xmath211 using that @xmath212 is non - increasing in @xmath61 and lemma  [ lemintegrals ] , we obtain @xmath213\\\\[-8pt]\\nonumber & \\leq & c_{m}b_{\\sfrac{\\theta_l}2,\\gamma}\\frac { { \\vert}\\delta\\xi- \\mathbb{e } _ { j+1}\\delta\\xi{\\vert}_{2,k}}{(t - t_j)^{1-\\sfrac{\\theta_l}2-\\gamma } } + b_{\\sfrac{1}2+\\sfrac{\\theta_l}2,\\gamma}\\frac{{\\vert}\\delta\\xi { \\vert}_{2,k}}{(t - t_j)^{1/2-\\sfrac{\\theta_l}2-\\gamma}}\\nonumber \\\\ & & { } + ( c_{m}+\\sqrt t)b _ { \\sfrac{\\theta_l}2,\\gamma}\\sum _ { l = j+2}^{n-1}\\frac{{\\vert}\\delta f_l{\\vert}_{2,k}\\delta _ l}{(t_l - t_j)^{1-\\sfrac { \\theta_l}2-\\gamma}}.\\nonumber\\end{aligned}\\ ] ]    _ upper bound for _ @xmath214 . starting from ( [ eqbounddely2 ] ) and applying lemma  [ lemiterationgen2 ] , we get @xmath215 then using the estimate ( [ eqigamma ] ) and @xmath216 , we obtain the announced inequality . _",
    "upper bound of _ @xmath217 .",
    "starting from ( [ eqbounddelz2 ] ) and applying lemma  [ lemiterationgen2 ] , we have @xmath218 therefore using the estimate ( [ eqigamma ] ) , we derive the advertised upper bound on @xmath217 .      in order to obtain error estimates for the monte carlo scheme , we use the model - free estimates of proposition  [ propeqyzerrdecom ] .",
    "typically , these estimates require that the object one is trying to approximate is bounded .",
    "therefore , the following almost sure bounds are crucial .",
    "[ coras ] assume @xmath97 , @xmath86  and @xmath91  and recall the constants @xmath219 and @xmath220 from proposition  [ propstability ] where @xmath221 is replaced by @xmath222 .",
    "then , we have @xmath223    the above upper bounds a valid for terminal values @xmath26 admitted by @xmath97 , which is quite general . without any further information on @xmath26",
    ", we can derive the simple bounds @xmath224 for an explicit , time uniform constant @xmath225 .",
    "it may , however , be useful to take advantage of additional information on @xmath26 , to obtain finer estimates on @xmath226 and @xmath227 with the aim of better tuning the parameters of the mwls method ( see section  [ sectioncomplexity ] ) .",
    "two situations are of particular interest .    * for zero terminal condition , @xmath228 and @xmath0 get smaller and smaller as @xmath229 goes to @xmath161 as expected : @xmath230 for a constant @xmath231 depending only on @xmath232 , @xmath233 , @xmath234 , @xmath235 and @xmath69 .",
    "this result is useful for variance reduction methods like the proxy method of @xcite , section  2.2 , the method of martingale basis @xcite , and the multilevel method of @xcite .",
    "* under @xmath98 , we have @xmath114 , which leads to an improved estimate for @xmath0 : @xmath236 for some constant @xmath231 depending only on @xmath237 , @xmath233 , @xmath238 , @xmath234 , @xmath235 , @xmath69 , @xmath161 , @xmath239 and @xmath240 .",
    "this is why in the subsequent analysis , we keep track on the general dependence on @xmath178 of the constants @xmath226 and @xmath227 .    proof of corollary  [ coras ] @xmath172 is the solution of the mwdp with data @xmath241 . applying proposition  [ propstability ] with @xmath242 and @xmath243 yields @xmath244 for @xmath245 .",
    "taking @xmath246 , plugging in the almost sure bounds on @xmath247 from @xmath97  and @xmath248 from @xmath86 , and using lemma  [ lemintegrals ] then yields the result .",
    "throughout this section , the markovian assumptions @xmath94 , @xmath97 , @xmath95  and @xmath96  are in force . the notation and preliminary results used in this section overlap with @xcite , section  4 , and we recall and adapt them to the setting of mwls in section  [ sectionmcprelims ] for completeness .",
    "an elegant property of the markovian assumptions is there are measurable , deterministic ( but unknown ) functions @xmath249 and @xmath250 for each @xmath251 such that the solution @xmath252 of the discrete bsde ( [ eqmalscheme ] ) is given by @xmath253 in this section , we estimate these functions .",
    "one needs to apply lemma  [ lemcdnexp ] below combined with @xmath254  defined in the assumptions @xmath94  and @xmath96   @xmath255 , and @xmath256 and @xmath257    [ lemcdnexp ] suppose that @xmath258 and @xmath259 are independent sub-@xmath57-algebras of @xmath260 .",
    "for @xmath261 , let @xmath262 be bounded and @xmath263-measurable , and @xmath264 be @xmath259-measurable .",
    "then , @xmath265 = j({u})$ ] where @xmath266 $ ] for all @xmath267 .",
    "least - squares regression has its traditional implementation in nonparametric statistics and signal processing @xcite . in the traditional",
    "setting , the random object is a pair of random variables @xmath268 termed the `` observation '' @xmath269 and the `` response '' @xmath270 .",
    "@xmath270 is considered to be some function of @xmath269 , with the possible addition of noise , and one needs recover this function .",
    "there are three important differences in the use of least - squares regression methods in our setting , and for this reason we give a definition of ( ordinary ) least - squares regression ( ols ) that enables us to approach our problems .",
    "first , the response we consider is a nonlinear transformation of the _ paths _ of the markov chain @xmath35 and the malliavin weights @xmath45 .",
    "we are able to simulate observations and responses ( active learning ) and we know the nonlinear function ; what is unknown is the regression function , that is , the conditional expectation .",
    "therefore , ols is defined in a way that easily enables path - dependence and joint laws by defining the path of the markov chain and malliavin weights as a single random variable , @xmath271 , with law @xmath272 . secondly ,",
    "since we are in a dynamical setting , least - squares regressions will be computed using independent clouds of simulations on each point of the time - grid .",
    "this causes a dependence on an additional source of randomness in the observations , namely the cloud of simulations from the preceding computations .",
    "therefore , ols is defined to depend on _ two _ probability spaces : one for the preceding clouds @xmath273 , and one for the current cloud distribution @xmath274 .",
    "finally , we will make use of both general probability measures ( associated to the joint - law of the markov chain and malliavin weights ) and empirical measures .",
    "the use of simulations to generate the empirical measure creates dependency issues that are avoided when using laws , whence we make two distinct definitions depending on which measure is in use .",
    "we recall the general notation of @xcite , section  4.1 , for ordinary least - squares regression problems .",
    "[ defls ] for @xmath275 and for probability spaces @xmath276 and @xmath274 , let @xmath277 be a @xmath278-measurable @xmath279-valued function such that @xmath280 for @xmath281-a.e .",
    "@xmath282 , and @xmath283 a linear vector subspace of @xmath284 spanned by deterministic @xmath279-valued functions @xmath285 .",
    "the least - squares approximation of @xmath277 in the space @xmath283 with respect to @xmath272 is the ( @xmath286-a.e . ) unique , @xmath278-measurable function @xmath287 given by @xmath288 we say that @xmath287 solves @xmath289 .    on the other hand ,",
    "suppose that @xmath290 is a discrete probability measure on @xmath291 , where @xmath292 is the dirac measure on @xmath50 and @xmath293 are i.i.d .",
    "random variables . for an @xmath278-measurable @xmath279-valued function @xmath277 such that @xmath294 for any @xmath295 and @xmath281-a.e .",
    "@xmath282 , the least - squares approximation of @xmath277 in the space @xmath283 with respect to @xmath296 is the ( @xmath281-a.e . ) unique , @xmath278-measurable function @xmath297 given by @xmath298 we say that @xmath287 solves @xmath299 .    from ( [ eqmarkov ] ) ,",
    "the mwdp ( [ eqmalscheme ] ) can be reformulated in terms of definition  [ defls ] : taking for @xmath300 any dense subset in the @xmath279-valued functions belonging to @xmath301 , for each @xmath302 , @xmath303 @xmath304\\label{eqvecxhvecxh}\\\\[-8pt]\\nonumber { \\mathbf{\\underline{h } } } ^{(i)}&:=&(h_{i+1},\\ldots,{h_{n } } ) \\in\\bigl(\\bigl({\\mathbb{r}}^q\\bigr)^\\top\\bigr)^{{n - i } } , \\qquad{\\mathbf{\\underline{x } } } ^{(i)}:= ( x_i,\\ldots , x_n ) \\in \\bigl({\\mathbb{r}}^d\\bigr)^{n - i+1}.\\end{aligned}\\ ] ] however , the above least - squares regressions encounter two computational problems :    @xmath305 is usually infinite dimensional ;    the integrals of the @xmath306  in ( [ eqmdplsdef ] ) are presumably computed using the untractable law of @xmath307    therefore , the functions @xmath308 and @xmath309 are to be approximated on finite - dimensional function spaces with the sample - based empirical version of the law , as described in the next subsection .      the first computational problem ( * cp1 * ) is handled using a pre - selected _ finite - dimensional vector spaces_.    [ deffindimspace ] for @xmath310 , we are given two finite functional linear spaces of dimension @xmath311 and @xmath312 @xmath313 < + \\infty$ , \\vspace*{5pt}\\cr \\mathcal{k}_{z , i}:= \\operatorname{span}\\bigl\\ { { p_{z , i}^{(1 ) } } , \\ldots , { p_{z , i}^{(k_{z , i } ) } } \\bigr\\ } , & \\quad for $ { p_{z , i}^{(k ) } } \\dvtx { \\mathbb{r}}^d \\rightarrow{\\bigl({\\mathbb{r}}^q\\bigr)^\\top}$ s.t . $ \\mathbb{e}\\bigl[\\bigl{\\vert}{p^{(k)}_{z , i}(x_i ) } \\bigr{\\vert}^2\\bigr ] < + \\infty$.}\\ ] ] the function @xmath308 ( resp . , @xmath314 ) will be approximated in the linear space @xmath315 ( resp . , @xmath316 ) .",
    "the best approximation errors are defined by @xmath317 } , \\qquad\\mathcal{e}^z_{\\mathrm{app.},i}:= \\sqrt { \\inf _ { \\phi\\in\\mathcal{k}_{z , i } } \\mathbb{e } \\bigl [ \\bigl{\\vert}\\phi(x_i ) - z_i(x_i)\\bigr{\\vert}^2 \\bigr]}.\\ ] ]    the second computational problem ( * cp2 * ) is solved using the _ empirical _ measure built from independent simulations with distribution @xmath318 .",
    "the number of simulations is large enough to avoid having under - determined systems of equations to solve .",
    "[ defsimsandempi ] for @xmath302 , generate @xmath319 independent copies @xmath320 of @xmath321 : @xmath322 forms a _ cloud of simulations _ used for the regression at time  @xmath178 .",
    "denote by @xmath323 the empirical probability measure of the @xmath324-simulations , that is , @xmath325 furthermore , we assume that the clouds of simulations @xmath326 are independently generated .",
    "all these random variables are defined on a probability space @xmath327 .",
    "observe that allowing time - dependency in the number of simulations @xmath328 and in the vector spaces @xmath315 and @xmath316 is coherent with our setting of time - dependent local lipschitz driver .",
    "denoting by @xmath329 the probability space supporting @xmath330 , which serves as a generic element for the clouds of simulations , the full probability space used to analyze our algorithm is the product space @xmath331 . by a slight abuse of notation ,",
    "we write @xmath3 ( resp . , @xmath332 ) to mean @xmath333 ( resp . , @xmath334 ) from now on .    in",
    "what follows , extensive use will be made of conditioning on the clouds of simulations .",
    "this is much in the spirit of the proof of @xcite , theorem 4.11 , and the arguments are based on the following definition of @xmath137-algebras .",
    "[ defsimcnd ] define the @xmath137-algebras @xmath335 for every @xmath302 , let @xmath336 $ ] ( resp .",
    ", @xmath337 ) with respect to @xmath338 .",
    "we now come to the definition of the mwls algorithm : this is merely the finite - dimensional version of ( [ eqmdplsdef ] ) plus a soft truncation of the solutions using the truncation function @xmath339 ( defined in section  [ sectionnotation ] ) .",
    "[ defmwls ] set @xmath340 . for each @xmath341 , set the random functions @xmath342 and @xmath343 recursively as follows .    1 .",
    "first , define @xmath344 where @xmath345 is the almost sure bound of corollary  [ coras ] and where @xmath346 where @xmath347 are defined in ( [ eqvecxhvecxh ] ) and ( [ eqempimeasure ] ) .",
    "second and similarly , define @xmath348 where @xmath349    before performing the error analysis , we state the following uniform ( resp .",
    ", conditional variance ) bounds on the functions @xmath350 ( resp . , the @xmath61th coordinate of @xmath351 for each @xmath295 and @xmath61 ) .",
    "these bounds are used repeatedly in section  [ sectionerr ] in conjunction with proposition  [ proplsregproperties ] in order to obtain estimates on the conditional variance of the regressions .",
    "the proof is postponed to appendix  [ appendixprooflemmalemobsbounds ] .",
    "[ lemobsbounds ] for all @xmath352 , there are finite constants @xmath353 and @xmath354 such that @xmath355 & \\le&{\\bar c_{z , i } } ^2 , \\qquad\\forall m \\in \\{1,\\ldots , m_i\\}.\\end{aligned}\\ ] ] we can write a precise time - dependency of the constants @xmath356 and @xmath357 : @xmath358\\\\[-8pt]\\nonumber { \\bar c_{z , i } } & : = & c_3 { c_\\xi(t - t_i)^{-1/2 } } + c_4 c_f ( t - t_i)^{{\\theta_c}- { 1 } /{2 } } , \\end{aligned}\\ ] ] where @xmath359 depend only on @xmath360 ( computed explicitely in the proof ) .",
    "the above time - dependency is to be used to derive convergence rates for the complexity analysis .",
    "we precise the random norms used to quantify the error of mwls .",
    "let @xmath361 or @xmath9 be @xmath362-measurable .",
    "for each @xmath302 , define the random norms @xmath363    the accuracy of the mwls algorithm is measured as follows : @xmath364 } , \\qquad\\bar\\mathcal{e}(z , m , i):= \\sqrt{{\\mathbb{e}}\\bigl[\\bigl{\\vert}{z^{(m)}_{i}(\\cdot)}- z_i(\\cdot ) \\bigr{\\vert}_{i,\\infty } ^2 \\bigr ] } , \\\\",
    "\\mathcal{e}(y , m , i ) & : = & \\sqrt{{\\mathbb{e}}\\bigl[\\bigl{\\vert}{y^{(m)}_{i}(\\cdot)}- y_i(\\cdot)\\bigr{\\vert}_{i , m } ^2 \\bigr ] } , \\qquad\\mathcal{e}(z , m , i):= \\sqrt { \\mathbb{e } \\bigl [ \\bigl{\\vert}{z^{(m)}_{i}(\\cdot)}- z_i(\\cdot)\\bigr{\\vert}_{i , m } ^2 \\bigr ] } .\\end{aligned}\\ ] ] in our analysis , we will have to switch from errors in true measure @xmath365 to errors in empirical measure @xmath366 , and vice - versa : this is not trivial since @xmath367 and the empirical norm @xmath368 depend on the same sample .",
    "however , the switch can be performed using concentration - of - measure estimates uniformly on a class of functions @xcite , chapter  9 .",
    "we directly state the ready - to - use result , which is a straightforward adaptation of @xcite , proposition 4.10 , to our context .",
    "[ propeqyzerrdecom ] recall definition  [ deffindimspace ] and the constants @xmath369 ( resp . , @xmath345 ) from corollary  [ coras ] , and define the _ interdependence errors _",
    "@xmath370 for each @xmath371 , we have @xmath372    the aim is to determine a rate of convergence for @xmath373)^ { 1 /2 } $ ] and @xmath374)^ { 1 /2 } $ ] using the local error terms @xmath375 defined below .",
    "[ thmmcerr ] for @xmath376 , define @xmath377\\\\[-8pt]\\nonumber & & { }   + { \\bar c_{z , k } } \\sqrt{\\frac{k_{z , k } } { m_k } } + l_f \\bigl ( \\mathcal{e } ^y_{\\mathrm{dep.},k+1 } + \\mathcal{e}^z_{\\mathrm{dep.},k } \\bigr).\\end{aligned}\\ ] ] for every @xmath378 , @xmath379 \\bigr)^{1/2 } & \\le & \\mathcal{e}^y_{\\mathrm{app.},k } + { \\bar c_{y , k } } \\sqrt{\\frac { k_{y , k}}{m_k } } + { c^{(m)}_{y } } \\sum_{j = k}^{n-1 } \\frac { \\mathcal{e}(j ) \\delta_j}{(t - t_j)^{(1-{\\theta_l})/2}},\\label { eqmcyerr } \\\\",
    "\\bigl({\\mathbb{e}}\\bigl[\\bigl{\\vert}z_k - z^m_k \\bigr{\\vert}_{k , m } ^2\\bigr ] \\bigr)^{1/2 } & \\le & \\mathcal{e}^z_{\\mathrm{app.},k } + { \\bar c_{z , k } } \\sqrt{\\frac { k_{z , k } } { m_k } } \\nonumber\\\\[-8pt]\\label{eqmczerr } \\\\[-8pt]\\nonumber & & { } + { c^{(m)}_{z } } \\sum_{j = k+1}^{n-1 } \\frac{\\mathcal{e}(j)\\delta _ j}{(t - t_j)^{(1-{\\theta_l})/2}\\sqrt{t_j - t_k}},\\end{aligned}\\ ] ] where , recalling the constant @xmath195 from lemma  [ lemiterationgen2 ] ( with @xmath380 , @xmath381 , @xmath382 and @xmath383 ) , @xmath384    _ discussion_. observe that owing to proposition  [ propeqyzerrdecom ] , similar estimates ( with modified constants ) are valid for @xmath385)^ { 1 /2 } $ ] and @xmath386)^ { 1 /2 } $ ] . the global error ( [ eqmcyerr])([eqmczerr ] ) is a weighted time - average of three different errors .    the contributions @xmath387 are the best approximation errors using the vector spaces of functions : this accuracy is achieved asymptotically with an infinite number of simulations ( take @xmath388 in our estimates ) .",
    "the contributions @xmath389 are the usual statistical error terms : the larger the number of simulations or the smaller the dimensions of the vector spaces , the better the estimation error .",
    "the contributions @xmath390 are related to the interdependencies between regressions at different times .",
    "this is intrinsic to the dynamic programming equation with @xmath37 nested empirical regressions .",
    "however , due to proposition  [ propeqyzerrdecom ] , the latter contributions are of same magnitude as the statistical error terms ( up to logarithmic factors ) .",
    "therefore roughly speaking , the global error is of order of the best approximation errors plus the statistical errors , as if there were a single regression problem @xcite , theorem  11.1 . in this sense , these error bounds are optimal : it is not possible to improve the above estimates with respect to the convergence rates ( but only possibly with respect to the constants ) .",
    "an optimal tuning of parameters is proposed in section  [ sectioncomplexity ] .    in comparison to @xcite , where a different monte carlo regression scheme is analyzed",
    ", the upper bound for the global error has a similar shape , but with two important differences .    * _ norm on @xmath0 . _ in @xcite , one uses the time averaged squared @xmath184-norm @xmath391 \\delta_i$ ] to estimate the error in @xmath0 , whereas here the norm used is time - wise .",
    "this leads to more informative error bounds .",
    "this is an advantage of the discrete bsde with malliavin weights against the mdp of @xcite . * _ time - dependency .",
    "_ the mwdp yields better estimates on @xmath392 and @xmath393 w.r.t .",
    "time in the local error estimates , which allows better parameters tuning and therefore better convergence rates ( see section  [ sectioncomplexity ] ) .",
    "the following proposition lists standard tools from the theory of regression .",
    "they will be used repeatedly in the proof of theorem  [ thmmcerr ] .",
    "this proposition was also used in @xcite , and we refer the reader to that paper for the proof .",
    "the two first properties are of deterministic nature , the two last are probabilistic . item ( iv )",
    "is stated in high generality ; this readily allows its further use in other regression - based monte carlo algorithms .",
    "[ proplsregproperties ] with the notation of definition  [ defls ] , suppose that @xmath283 is finite - dimensional and spanned by the functions @xmath394 .",
    "let @xmath287 solve @xmath289 ( resp . , @xmath299 ) , according to ( [ eqmcmls ] ) ( resp . , ( [ eqmclsempi ] ) ) .",
    "the following properties are satisfied :    linearity : the mapping @xmath395 is linear .",
    "stability property : @xmath396 , where @xmath397 ( resp . , @xmath398 ) .",
    "conditional expectation solution : in the case of the discrete probability measure @xmath296 , assume additionally that the sub-@xmath137-algebra @xmath399 is such that @xmath400 is @xmath58-measurable for every @xmath401 . setting @xmath402 $ ] for each @xmath403 , then @xmath404 $ ] solves @xmath405",
    ".    bounded conditional variance : in the case of the discrete probability measure @xmath296 , suppose that @xmath406 is @xmath407-measurable , for @xmath408 independent of @xmath409 , there exists a borel measurable function @xmath410 , for some euclidean space @xmath411 , such that the random variables @xmath412 are @xmath413-measurable , and there is a finite constant @xmath414 that uniformly bounds the conditional variances @xmath415\\leq \\sigma^2 $ ] @xmath281-a.s . and for all @xmath416",
    ". then @xmath417 \\bigr{\\vert}_{{\\mathbf{l}}_2(\\mathcal{b}({\\mathbb{r}}^l),\\nu_m)}^2 \\mid \\mathcal { g } \\vee \\mathcal{h } \\bigr ] \\le\\sigma^2 \\frac { k } { m } .\\ ] ]    _ intermediate processes and local error terms . _",
    "another technique we borrow from @xcite is to introduce intermediate , _ fictional _ regressions based on the true solutions : one replaces the full @xmath184 space for the approximation space and the true measure for the empirical measure in ( [ eqmdplsdef ] ) .    for each @xmath182 ,",
    "recall the functions @xmath418 and @xmath419 from ( [ eqmdplsdef ] ) , the linear spaces @xmath420 and @xmath421 from definition [ deffindimspace ] , and the empirical measure @xmath422 from ( [ eqempimeasure ] ) , and set @xmath423 note that these regressions are not numerically accessible , because they require knowledge of the true solution to be applied . after a series of conditioning arguments , based on lemma  [ lembary ] below",
    ", the fictional regressions will eventually allow the use of the stability estimates of section  [ sectionstab ] , and ( after a somewhat complex application of the gronwall inequalities of section  [ sectiongronwall ] ) this will yield final result .    from lemma  [ lemcdnexp ] and",
    "our markovian assumptions , observe that @xmath424 , { \\mathbb{e}}^m_k\\bigl [ { s_{z , k}\\bigl({h^{(k , m)}_{}},{x^{(k , m ) } _ { } } \\bigr)}\\bigr ] \\bigr ) = \\bigl ( y_k\\bigl({x^{(k , m)}_{k}}\\bigr ) , z_k\\bigl({x^{(k , m)}_{k}}\\bigr ) \\bigr)\\ ] ] for each @xmath425 where @xmath426 are the unknown functions defined in ( [ eqmarkov ] ) .",
    "proposition [ proplsregproperties](iii ) implies the first statement of the following lemma .",
    "the second statement results from a direct interchange of @xmath427 and @xmath332 , and from the identical distribution of @xmath428 for all  @xmath295 .",
    "[ lembary ] for each @xmath182 , @xmath429 \\quad\\mbox{solves}\\quad{\\mathrm{ols}}\\bigl ( y_k(\\cdot ) , \\mathcal{k}_{y , k } , \\nu_{k , m } \\bigr ) , & \\\\ & \\displaystyle { \\mathbb{e}}^m_k\\bigl[\\psi_{z , k}(\\cdot)\\bigr ] \\quad \\mbox{solves}\\quad{\\mathrm{ols}}\\bigl ( z_k(\\cdot ) , \\mathcal{k}_{z , k } , \\nu_{k , m } \\bigr).&\\end{aligned}\\ ] ] in addition , recalling the local error terms @xmath430 and @xmath431 from definition  [ deffindimspace ] , @xmath432-y_k(\\cdot ) \\bigr{\\vert}_{k , m } ^2 \\bigr]&=&\\mathbb{e } \\bigl [ \\inf _ { \\phi\\in\\mathcal{k}_{y , k } } \\bigl{\\vert}\\phi(\\cdot ) - y_k(\\cdot)\\bigr { \\vert}_{k , m } ^2 \\bigr]\\leq\\bigl(\\mathcal{e } ^y_{\\mathrm{app.},k}\\bigr)^2 , \\\\",
    "\\mathbb{e } \\bigl [ \\bigl{\\vert}{\\mathbb{e}}^m_k\\bigl [ \\psi_{z , k}(\\cdot ) \\bigr ] -z_k(\\cdot)\\bigr{\\vert}_{k , m } ^2 \\bigr]&=&\\mathbb{e } \\bigl [ \\inf _ { \\phi\\in\\mathcal{k}_{z , k } } \\bigl{\\vert}\\phi(\\cdot ) - z_k(\\cdot)\\bigr { \\vert}_{k , m } ^2 \\bigr]\\leq\\bigl(\\mathcal{e } ^z_{\\mathrm{app.},k}\\bigr)^2.\\end{aligned}\\ ] ]      recall the soft truncation function @xmath433 for @xmath434 . from the almost sure bounds of corollary  [ coras ] , @xmath435 .",
    "then , the lipschitz continuity of @xmath436 yields @xmath437 is less than or equal to @xmath438 . using the triangle inequality for the @xmath439-norm",
    ", it follows that @xmath440\\\\[-8pt]\\nonumber & & \\quad   \\le\\bigl{\\vert}y_k(\\cdot ) - { \\mathbb{e}}^m_k \\bigl [ \\psi_{y , k}(\\cdot ) \\bigr ] \\bigr{\\vert}_{k , m } + \\bigl { \\vert}\\mathbb{e } ^{m}_k\\bigl [ \\psi_{y , k } ( \\cdot)\\bigr ] - \\psi^{(m)}_{y , k}(\\cdot ) \\bigr{\\vert}_{k , m}.\\end{aligned}\\ ] ] because @xmath441 depends on @xmath442 computed with the same cloud of simulations @xmath443 as that used to define the ols solution @xmath444 , it raises some interdependency issues that we solve by making a small perturbation to the intermediate processes as follows ( compare with ( [ eqmdplsdef ] ) and  ( [ eqpsimy ] ) ) : for @xmath445 , define @xmath446 this perturbation is not needed for the @xmath0-component , because @xmath447 depends only on the subsequent clouds of simulations @xmath448 . applying the @xmath184-norm @xmath449 , the triangle inequality in ( [ eqmcy1 ] ) , and the first part of lemma  [ lembary ] yields @xmath450\\bigr { \\vert}_{k , m } \\bigr{\\vert}_2\\nonumber \\\\ & & { }   + \\bigl{\\vert}\\bigl{\\vert}\\tilde\\psi^{(m)}_{y , k}(\\cdot)-",
    "\\mathbb{e}^{m}_k \\bigl [ \\tilde\\psi^{(m ) } _ { y , k}(\\cdot)\\bigr]\\bigr{\\vert}_{k , m } \\bigr{\\vert}_2 \\\\ & & { } + \\bigl{\\vert}\\bigl{\\vert}\\tilde\\psi^{(m)}_{y , k } ( \\cdot)-\\psi^{(m)}_{y , k}(\\cdot ) \\bigr{\\vert}_{k , m } \\bigr{\\vert}_2.\\nonumber\\end{aligned}\\ ] ] let us handle each term in the above inequality separately .",
    "term @xmath451{\\vert}_{k , m } { \\vert}_2 $ ] . set @xmath452 recalling that @xmath453 is built only using the clouds @xmath454",
    ", it follows from lemma  [ lemcdnexp ] that @xmath455 $ ] is equal to @xmath456 for every @xmath457 .",
    "then , using proposition  [ proplsregproperties](i )  and  ( iii ) , @xmath458 $ ] solves @xmath459 . by proposition  [ proplsregproperties](ii ) ,",
    "@xmath460\\bigr { \\vert}_{k , m } ^2 \\bigr ] \\leq{\\mathbb{e}}\\bigl [ \\bigl{\\vert}{\\tilde\\xi^*_{y , k}(\\cdot)}\\bigr{\\vert}_{k , m } ^2 \\bigr ] = { \\mathbb{e}}\\bigl[\\bigl({\\tilde\\xi^*_{y , k}(x_k)}\\bigr)^2 \\bigr ] , \\ ] ] where the final equality follows from the fact that @xmath461 is generated only using the simulations in the clouds @xmath462 and @xmath463 are identically distributed .",
    "defining @xmath464,\\ ] ] the triangle inequality yields @xmath465    term @xmath466{\\vert}_{k , m } { \\vert}_2 $ ] . since @xmath467 depends only on the clouds @xmath468 and",
    "is bounded from above by @xmath469 ( like @xmath470 , see lemma  [ lemobsbounds ] ) , it follows from proposition  [ proplsregproperties](iv ) that @xmath471{\\vert}_{k , m } { \\vert}_2 $ ] is bounded from above by @xmath472 .",
    "this is similar to the statistical error term in usual regression theory .",
    "term @xmath473 . owing to proposition  [ proplsregproperties](i )  and",
    "( ii ) , @xmath474 is bounded from above by @xmath475 , which equals @xmath476 collecting the bounds on the three terms , substituting them into ( [ eqmcy2 ] ) and applying proposition  [ propeqyzerrdecom ] yields @xmath477\\\\[-8pt]\\nonumber & & { }   + \\frac{l_f \\delta_k } { ( t - t_k)^{1/2-\\sfrac{\\theta_l}2 } } \\bigl\\ { ( 1 + \\sqrt2 ) { \\mathcal{e}(z , m , k ) } + \\mathcal{e}^z_{\\mathrm { dep.},k } \\bigr\\}.\\end{aligned}\\ ] ]    analogously to ( [ eqmcy2 ] ) , one obtains the upper bound @xmath478\\bigr",
    "{ \\vert}_{k , m } \\bigr{\\vert}_2 + \\bigl{\\vert}\\bigl{\\vert}\\psi^{(m)}_{z , k}(\\cdot)- \\mathbb{e}^{m}_k \\bigl [ \\psi^{(m)}_{z , k}(\\cdot)\\bigr]\\bigr{\\vert}_{k , m } \\bigr{\\vert}_2 .",
    "\\nonumber\\end{aligned}\\ ] ] since @xmath479 depends only on the clouds @xmath480 and the @xmath481-conditional variance of @xmath482 is bounded from above by @xmath483 for all @xmath295 ( see lemma  [ lemobsbounds ] ) , it follows from proposition  [ proplsregproperties](iv ) that @xmath484{\\vert}_{k , m } { \\vert}_2 $ ] is bounded from above by @xmath485 . defining @xmath486,\\ ] ]",
    "it follows that @xmath487 $ ] solves @xmath488 .",
    "therefore , @xmath489    observe that @xmath490 defined in ( [ eqximy ] ) ,  ( [ eqximz ] ) solves a mwdp with terminal condition @xmath491 and driver @xmath492 . applying proposition  [ propstability ] with @xmath493 ( so that @xmath494 ) and using the lipschitz continuity of @xmath495 yields @xmath496 next , introducing the notation @xmath497 and applying proposition  [ propeqyzerrdecom ]",
    ", it follows that @xmath498 substituting the above into ( [ eqmcy3 ] ) and ( [ eqmcz1 ] ) , and merging together the terms in @xmath0 , it follows that @xmath499\\label{eqmcy4 } \\\\[-8pt]\\nonumber & \\le&\\mathcal{e}^y_{\\mathrm{app.},k } + { \\bar c_{y , k } } \\sqrt { \\frac { k_{y , k}}{m_k } } + 2 \\sum_{j = k}^{n-1 } \\frac { \\mathcal{e}(j ) \\delta_j } { ( t - t_j)^{1/2 - \\sfrac{\\theta_l}2 } } \\\\ & & { } + 4 l_f \\sum_{j = k}^{n-1 } \\frac { \\theta_j \\delta_j } { ( t - t_j)^{1/2 - \\sfrac{\\theta_l}2 } } , \\nonumber \\\\ \\mathcal{e}(z , m , k ) & \\le&\\mathcal{e}^z_{\\mathrm{app.},k } + { \\bar c_{z , k } } \\sqrt{\\frac { k_{z , k } } { m_k } } + c_{m}\\sum_{j = k+1}^{n-1 } \\frac { \\mathcal{e}(j ) \\delta_j } { ( t - t_j)^{1/2 - \\sfrac{\\theta_l}2 } \\sqrt{t_j - t_k } } \\nonumber\\\\[-8pt]\\label{eqmcz2}\\\\[-8pt]\\nonumber & & { } + \\sqrt2 c_{m}l_f \\sum _ { j = k + 1}^{n-1 } \\frac { \\theta_j \\delta_j } { ( t - t_j)^{1/2 - \\sfrac{\\theta_l}2 } \\sqrt{t_j - t_k}}.\\end{aligned}\\ ] ]    now , summing ( [ eqmcz2 ] ) and ( [ eqmcy4 ] ) , one obtains an estimate for @xmath500 : @xmath501 thus , using lemmas  [ lemiterationgen1 ] and  [ lemiterationgen2 ] with @xmath380 , @xmath381 , @xmath502 , @xmath503 , we can control weighted sums involving @xmath504 using weighted sums of @xmath505 , which is exactly what we need to complete the upper bounds ( [ eqmcy4])([eqmcz2 ] ) for @xmath506 and @xmath507 .",
    "namely , let @xmath210 : @xmath508 where we have applied lemma  [ lemintegrals ] .",
    "thus , @xmath509 and plugging the above inequality into ( [ eqmcy4 ] ) and ( [ eqmcz2 ] ) yields ( [ eqmcyerr ] ) and ( [ eqmczerr ] ) .      as usual in empirical regression theory , appropriately tuning numerical paramaters is crucial for finding the right trade - off between statistical errors and estimation errors .",
    "this analysis allows to express the error magnitude as a function of computational work ( complexity analysis ) .",
    "we discuss the complexity in different cases according to the regularity of the value functions @xmath510 and the choice of the grid @xmath123 . in order to have a fair comparison with other numerical schemes , we revisit the setting of @xcite , section  4.4 , which we partly recall for completeness , and extend the analysis to include more general settings .",
    "* we perform an asymptotic complexity analysis as the number @xmath37 of grid times goes to @xmath511 .",
    "we are concerned with time - dependent bounds : thus in the following , the order convention , @xmath512 or @xmath513 , is uniform in @xmath229 . *",
    "the grids under consideration are of the form @xmath514 for @xmath515 $ ] ( inspired by @xcite ) .",
    "observe that their time - step @xmath516 is not - increasing in @xmath178 , hence they all satisfy @xmath86  with the same parameter @xmath517 .",
    "* the magnitude of the final accuracy is denoted by @xmath518 for some parameter @xmath519 .",
    "this is usually related to time - discretization errors between the continuous - time bsde and the discrete - time one , @xmath520 may range from @xmath521 ( for non - smooth data @xcite , theorem 1.1 ) to  1 ( in the case of smooth data @xcite , theorems 7 and 8) . *",
    "the approximation spaces are given by local polynomials of degree @xmath522 @xmath523 defined on hypercubes with edge length @xmath524 , covering the set @xmath525^d$ ] ( @xmath526 ) : we denote it by @xmath527 .",
    "the functions in @xmath528 take values in @xmath17 for the @xmath199-component and in @xmath9 for  @xmath200 ( using local polynomials component - wise ) , but we omit this in the notation .",
    "the best - approximation errors are easily controlled ( using the taylor formula ) : @xmath529 for any function @xmath530 that is bounded , @xmath531-times continuously differentiable with bounded derivatives , and where the constant @xmath532 does not depend on @xmath533 .",
    "the dimension of the vector space @xmath528 is bounded by @xmath534 where @xmath535 is the number of polynomials on each hypercube ( it depends on @xmath48 and @xmath522 ) .",
    "+ a significant computational advantage of local polynomial basis is that the cost of computing the regression coefficients associated to a sample of size @xmath536 is @xmath537 flops .",
    "the cost of the regression in the @xmath61th hypercube is of order @xmath538 using svd least squares minimization @xcite , chapter  5 , where @xmath539 is the number of simulations that land in the hypercube .",
    "therefore , the total cost of the regressions at any time - point is of order @xmath540 . on the other hand ,",
    "the cost of generating the clouds of simulations and computing the simulated functionals @xmath541 is @xmath542 , which is clearly dominant in the computational cost @xmath543 of the mwls algorithm .",
    "to summarize , the computational cost is @xmath544 another advantage of the local polynomial basis is that there is substantial potential for parallel computing . * to make the tail contributions ( outside @xmath525^d$ ] ) small enough , we assume that @xmath43 has exponential moments ( uniformly in @xmath178 ) , that is , @xmath545 for some @xmath546 , so that the choice @xmath547 is sufficient to ensure @xmath548 .    to simplify the discussion , we assume @xmath87 .",
    "assume that @xmath549 are , respectively , of class @xmath550 and @xmath551 ( bounded with bounded derivatives ) for some @xmath552 : this is similar to the discussion of @xcite , section  4.4 .",
    "in fact , this is usually valid for the continuous - time limit ( a priori estimates on the semi - linear pde , see @xcite ) provided that the data are smooth enough .",
    "in particular , we may assume @xmath98  with @xmath553 .",
    "this leads to time - uniform bounds on the quantities @xmath554 .",
    "set @xmath555 take @xmath556 and @xmath557 . from proposition",
    "[ propeqyzerrdecom ] , theorem  [ thmmcerr ] and the inequality ( [ eqpolloc ] ) , it is easy to check that @xmath558 consequently , using lemma  [ lemintegrals ] , we finally obtain @xmath559 \\bigr)^{1/2}&=&\\mathrm{o } \\bigl(n^{-{\\theta_{\\mathrm{conv}}}}\\bigr ) , \\\\",
    "\\bigl({\\mathbb{e}}\\bigl[\\bigl{\\vert}z_i - z^m_i\\bigr{\\vert}_{i , m } ^2 \\bigr ] \\bigr)^{1/2}&=&\\mathrm{o}\\bigl(n^{-{\\theta_{\\mathrm{conv}}}}\\bigr ) \\biggl(1 + \\frac{(t - t_i)^{-\\sfrac { 1 } { 2 } } } { \\sqrt{\\log(n+1 ) } } \\biggr).\\end{aligned}\\ ] ] for any time - grid @xmath560 , we get @xmath561 + \\sum_{i=0}^{n-1}\\delta_i { \\mathbb{e}}[{\\vert}z_i - z^m_i{\\vert}_{i , m } ^2]= \\mathrm{o}(n^{-2{\\theta_{\\mathrm{conv}}}})$ ] .",
    "the computational cost is @xmath562 . ignoring the logarithmic factors , we obtain a final accuracy in terms of the computational cost : @xmath563 it",
    "should be compared with the rate @xmath564 which is valid for the least squares multi - step forward dynamical programming algorithm ( lsmdp ) @xcite .",
    "this shows an improvement on the rate , although there is no change in the dependence on dimension .",
    "the ratio @xmath565 is the usual balance between dimension and smoothness , arising when approximating a multi - dimensional function .",
    "the controls of mwls are stated in stronger norms than the controls of lsmdp , and despite that , the estimates improve .",
    "the convergence improvement is due to better mwdp - intrinsic estimates on @xmath0 , which avoid the @xmath566-factor of the lsmdp .",
    "this results in better local error bounds , whence better global estimates .",
    "the reader can easily check that this happens already in the simple case with null driver .",
    "we investigate the case of non - smooth terminal condition , where nevertheless there is a smoothing effect of the conditional expectation yielding smooth value functions @xmath44 .",
    "namely , assume that @xmath111 is bounded and @xmath124-hlder continuous ( in particular with @xmath98 ) , and that , for all  @xmath178 , the function @xmath308 ( resp . , @xmath309 ) is @xmath567-times ( resp . , @xmath61-times ) continuously differentiable with highest derivatives bounded by @xmath568 these qualitative assumptions are related to the works of @xcite , who have determined similar estimates for the gradients of quasi - linear pdes under quite general conditions on the driver , terminal condition and differential operator .",
    "their estimates cover the case @xmath569 ( @xcite , theorem  2.1 ) or @xmath570 and @xmath261 ( @xcite , theorem 1.4 ) , but the hlder continuous setting with high order derivatives is not investigated .",
    "we therefore extrapolate these results in the assumptions ( [ eqderivyz ] ) for the purposes of this discussion .    in this setting , we have time - uniform bounds on the quantities @xmath226 , @xmath571 , @xmath572 , @xmath573 . set @xmath574 take @xmath556 and @xmath557 .",
    "similarly to before , using in particular ( [ eqpolloc ] ) , we eventually obtain @xmath575 consequently , using lemma  [ lemintegrals ] , we finally obtain @xmath576 \\bigr)^{1/2}&=&\\mathrm{o } \\bigl(n^{-{\\theta_{\\mathrm{conv}}}}\\bigr ) , \\\\",
    "\\bigl({\\mathbb{e}}\\bigl[\\bigl{\\vert}z_i - z^m_i \\bigr{\\vert}_{i , m } ^2\\bigr ] \\bigr)^{1/2}&=&\\mathrm{o } \\bigl(n^{-{\\theta_{\\mathrm{conv}}}}\\bigr ) \\biggl((t - t_i)^{\\vfrac{{\\theta_\\phi}- 1 } { 2 } } + \\frac{(t - t_i)^{-\\sfrac { 1 } { 2 } } } { \\sqrt { \\log(n+1 ) } } \\biggr).\\end{aligned}\\ ] ] the computation cost is given by ( under the assumption @xmath560 ) @xmath577 up to possibly a @xmath578-factor , the last sum is @xmath579 . ignoring the logarithmic factors , we obtain @xmath580 .",
    "equivalently , as a function of the computational cost , the convergence rate of the final accuracy equals @xmath581 following @xcite ( under suitable assumptions ) , two time - grid choices are possible for solving the same bsde .    *",
    "the uniform grid @xmath582 gives @xmath583 ( at least ) .",
    "the convergence order becomes @xmath584 .",
    "* the grid @xmath585 ( for @xmath586 ) gives @xmath587 .",
    "taking @xmath588 , the convergence order is @xmath589 .",
    "the grid @xmath590 exhibits a better convergence rate compared to the uniform grid .",
    "this corroborates the interest in time grids that are well adapted to the regularity of the data .",
    "these features will be investigated in subsequent more experimental works .",
    "the first inequality , for @xmath591 , follows by bounding the sum by @xmath592 , whence @xmath593 .",
    "the case @xmath594 is obvious with @xmath595 . for the second inequality ,",
    "there are two main cases :    if @xmath596 and @xmath597 , the advertised inequality is obvious with @xmath598",
    ".    now , assume the complementary case , that is , @xmath599 and/or @xmath600 , and first consider the case @xmath601 and @xmath602 .",
    "we set @xmath603 and we use the integral @xmath604 ( equivalent to the usual beta function with parameters @xmath605 ) to bound the sum .",
    "a simple but useful property ( due to @xmath599 and/or @xmath600 ) is that @xmath606 is either monotone or has a unique minimum on @xmath607 , whence @xmath608 summing up over @xmath609 and defining @xmath610 concludes the proof for the simple case . for general @xmath611 and @xmath612 one can use the bounds on the simple case by rearranging the @xmath609-sum which is equal to @xmath613      if @xmath614 , the result trivially holds with @xmath615 and @xmath616 .",
    "now , assume @xmath617 : if ( [ eqiterationfeed ] ) holds , of course we also have @xmath618 by substituting ( [ eqiterationgenbis ] ) into the last sum , and using lemma  [ lemintegrals ] we observe @xmath619 substituting into ( [ eqiterationgenbis ] ) , we observe that we have an equation of similar form to ( [ eqiterationgenbis ] ) , except that , in the sum involving @xmath530 , @xmath620 and @xmath621 , and , in the sum involving @xmath622 , @xmath623 .",
    "after @xmath624 iterations of the previous step , we obtain @xmath625 .",
    "hence , for @xmath624 sufficiently large so that @xmath626 , that is , @xmath627 , we obtain the bound advertised in the lemma statement .",
    "we can assume that @xmath615 in ( [ eqiterationfeed2 ] ) ; if it is not , one can redefine @xmath622 as @xmath628 .",
    "we first prove the case @xmath629 .",
    "define @xmath630 and write @xmath631 for brevity .",
    "we first multiply ( [ eqiterationfeed2 ] ) by @xmath632 , then sum the outcome equation over @xmath633 , and finally switch the order of summation on the right - hand side as follows : @xmath634 where we have used ( because @xmath635 is non - decreasing and @xmath636 ) @xmath637 by subtracting the term with factor @xmath638 , the result for @xmath639 follows . moreover , plugging the result into ( [ eqiterationfeed2 ] ) , and returning to general @xmath159 , gives @xmath640\\\\[-8pt]\\nonumber & & { } + { { \\mathcal c}_{\\mathrm{(\\ref{equpperboundu})}}}\\sum _ { l = j+1}^{n-1 } \\frac{w_l \\delta_l}{(t - t_l)^{{{1}/2 - \\beta } } } \\end{aligned}\\ ] ] for a constant @xmath641 . now for the general case @xmath210 , observe that , for any @xmath642 , one obtains by change of the order of summation that @xmath643\\\\[-8pt]\\nonumber & & \\qquad \\leq b_{\\beta+\\delta,\\gamma } \\sum_{l = i+2}^{n-1 } \\frac{w_l\\delta _ l}{(t - t_l)^{\\sfrac{1 } 2 - \\beta}(t_l - t_i)^{1-\\beta-\\delta-\\gamma } } .\\end{aligned}\\ ] ] thus , ( [ equpperboundu ] ) yields @xmath644      using the bounds @xmath369 and @xmath345 on @xmath342 and @xmath343 , respectively , one applies the local lipschitz continuity and boundedness properties of @xmath645 given in @xmath86  to obtain the bound @xmath646 substituting this into the definition @xmath647 ( see ( [ eqpsimy ] ) ) , it follows from @xmath86  that @xmath648 substituting the value of @xmath649 and @xmath650 given in equations ( [ eqasy ] ) and ( [ eqasz ] ) , respectively , using the crude bound @xmath651 and lemma [ lemintegrals ] , we obtain the bound @xmath572 , with the form  ( [ eqboundobsbd ] ) .    to obtain the bound @xmath357 , apply first the triangle inequality on the conditional standard deviation of @xmath652 ; second use the bound ( [ eqmcbdf ] ) on the driver , and the bound @xmath91  to obtain @xmath653 } \\\\ & & \\quad \\leq\\frac{{c_\\xi } c_{m}}{\\sqrt{t - t_i } } + \\sum_{j = i+1}^{n-1 } \\biggl(\\frac{l_f ( { c_{y , j+1}}+ { c_{z , j } } ) } { ( t - t_j)^{1/2 { - \\sfrac{\\theta_l}2 } } } + \\frac { c_f}{(t - t_j)^{1-{\\theta_c } } } \\biggr ) \\frac { c_{m}}{\\sqrt{t_j - t_i } } \\delta_j.\\end{aligned}\\ ] ] then , the computation of @xmath357 follows again from equations ( [ eqasy ] ) and ( [ eqasz ] ) , and lemma  [ lemintegrals ] . the form ( [ eqboundobsbd ] ) is also derived .",
    "we skip details .",
    "this research benefited from the support of the chair finance and sustainable development , under the aegis of louis bachelier finance and sustainable growth laboratory , a joint initiative with ecole polytechnique .",
    "emmanuel gobet s research is part of the chair financial risks of the risk foundation and of the fime laboratory .",
    "plamen turkedjiev acknowledges support form german science fondation dfg via berlin mathematical school and matheon ."
  ],
  "abstract_text": [
    "<S> we design a numerical scheme for solving a dynamic programming equation with malliavin weights arising from the time - discretization of backward stochastic differential equations with the integration by parts - representation of the @xmath0-component by ( _ ann . </S>",
    "<S> appl . </S>",
    "<S> probab . _ </S>",
    "<S> * 12 * ( 2002 ) 13901418 ) . when the sequence of conditional expectations is computed using empirical least - squares regressions , we establish , under general conditions , tight error bounds as the time - average of local regression errors only ( up to logarithmic factors ) . </S>",
    "<S> we compute the algorithm complexity by a suitable optimization of the parameters , depending on the dimension and the smoothness of value functions , in the limit as the number of grid times goes to infinity . </S>",
    "<S> the estimates take into account the regularity of the terminal function .    </S>",
    "<S> ./style / arxiv - general.cfg </S>"
  ]
}