{
  "article_text": [
    "the development of linear scaling computational methods for electronic structure calculations in molecules and solids with a very large number of atoms , ( i.e. methods whose computational demands grow as the first power of the size of the system , ) has been a very active and successful field in the last decade.@xcite linear scaling and low order scaling techniques exist for the computation of the one - electron effective hamiltonian matrix in first - principles calculations ( with density functional theory and wave function based methods ) ,  @xcite as well as for the energy minimization step ,  @xcite which is a common step to first - principles and semiempirical calculations . in low order scaling energy minimization methods ,",
    "the traditional cubic scaling diagonalization of the matrix representation of the effective one - electron hamiltonian in a finite basis set ,  @xcite which leads to the canonical orbitals , is substituted by different algorithms which , either solve directly for the unique optimal density matrix ,  @xcite or for some sort of arbitrary optimal localized orbitals .",
    "@xcite in parallel to linear scaling electronic structure methods , a significant development has also been made in embedding methods , which focus the computational effort on local properties of a system  @xcite ( see refs .   and for recent reviews ) .    in this paper",
    ", we present a new method for the energy minimization step which can be used in semiempirical and first - principles hartree - fock and kohn - sham calculations .",
    "it is expected to be useful as a complement of linear - scaling methods for the computation of the hamiltonian matrix , which are nowadays available for local exchange - correlation potentials and coulomb potentials ,  @xcite as well as for exact exchange fields .",
    "@xcite the energy minimization method is based on exploiting the self - consistent calculation of the optimum localized orbitals of any localization method of choice and the use of orbital - specific basis sets .",
    "the @xmath0 occupied localized orbitals of a very large molecule which correspond to a chosen localization method ( e.g. the popular methods of boys ,  @xcite edmiston - ruedenberg ,  @xcite and pipek - mezey ,  @xcite or any other available or newly developed localization method ) can be regarded as a mosaic of orbitals , where each of its component  contains only a few orbitals . in the present method",
    "we define an orbital  as a subset of the occupied localized orbitals ( of the method of choice ) which are localized in some region of real space and compute the localized orbitals of each  out of one specific pseudoeigenvalue equation to be solved in a basis set expansion approximation , using a basis set specific to the , or orbital - specific basis set . in other words , a set of building - block embedded cluster pseudoeigenvalue coupled equations , one for each , is solved in a self - consistent manner . doing so , the method becomes parallel ( the  are computed independently of each other in the self - consistent procedure ) and exhibits a linear - scaling dependence with the size of the molecule .",
    "we call the present method .    early works on localized orbitals proposed the ideas of computing them directly by a self - consistent procedure  @xcite and computing one or several localized orbitals out of separate eigenvalue equations starting with a set of qualitatively localized orbitals .",
    "@xcite these ideas have been used by several authors to propose methods leading to some particular sets of localized orbitals or to localized orbitals dependent on the initial guess .",
    "@xcite we apply them to the computation of the occupied localized orbitals of any localization method of choice . here",
    ", we do not pay attention to the computation of virtual localized orbitals ; methods for the determination of virtual localized orbitals useful in wave function based correlation methods have been used already in early works  @xcite .",
    "the idea of using different basis sets for different regions of the system is also present in early work ,  @xcite it has been used and discussed by several authors ,  @xcite and is a common procedure in embedded cluster and effective core potential calculations .",
    "@xcite    besides its use as a linear scaling method in large molecules and solids , the  method can be used as an embedded cluster method , where only a few localized orbitals of a large system are treated variationally while the rest is taken from a calculation on a similar molecule and frozen , with obvious computational advantages .",
    "this can be done because the solutions of the building - block embedded cluster coupled equations are the localized orbitals corresponding to a given localization method of choice , which enables their transferability between similar molecules .    in sec .",
    "[ sec : method ] we present the details of the  method .",
    "we performed monitoring calculations on large poly(ethylen oxide ) molecules and three dimensional carbon monoxide clusters using an extended hckel semiempirical hamiltonian , which are presented in sec .",
    "[ sec : results ] .",
    "they are aimed at showing the convergence of the parallel calculation to the right solution , the convergence of the total energy with the size of the orbital - specific basis sets towards the exact value , the linear - scaling characteristics of the method , and the performance of embedded cluster approximations .",
    "let us consider the hartree - fock equations in wave function based _ ab initio _ methods ,  @xcite the kohn - sham equations in density functional theory ,  @xcite or the effective hartree - fock equations in semiempirical methods .",
    "@xcite the canonical form of the spin - restricted closed - shell version of these equations can be written as @xmath1 with an appropriate choice of the one - electron hamiltonian @xmath2 for each case , where @xmath3 is a row vector of @xmath0 occupied molecular orbitals , @xmath4 and @xmath5 is an @xmath6 diagonal matrix of orbital energies .",
    "this and what follows can be generalized to the spin - unrestricted cases if the orbitals and the hamiltonian in eqs .",
    "[ eq : caneq ] and [ eq : canmos ] are adequately substituted by the @xmath7 and @xmath8 choices ;  @xcite here we will continue with the detailed description of the spin - restricted closed - shell case for the sake of clarity .",
    "the virtual orbitals , @xmath9 , are also solutions of eq .",
    "[ eq : caneq ] ; in this paper , however , we will focus our attention on the occupied spectrum and , unless specified , we will refer only to different sets of occupied orbitals from now on .",
    "the fock - dirac one - electron density operator is defined as @xmath10 it is invariant under arbitrary unitary transformations of the occupied orbitals , @xmath11 where we use the notation @xmath12 for the unitary matrix that transforms canonical occupied orbitals onto localized orbitals of a given localization method , which we label @xmath13 . also , @xmath14 is the projection operator of the occupied space , @xmath15    the fact that wave function , one - electron density , total energy , and fock operator are invariant under unitary transformations within the occupied space ( eq .  [ eq : canul ] ) has been exploited to define localized orbitals , which are useful to facilitate large scale calculations and to bridge the gap between extensive numerical calculations and qualitative chemical thinking .",
    "a localization method , say @xmath13 , can be defined by its choice of @xmath12 .",
    "very sound and popular localization methods are the methods of boys ,  @xcite edmiston - ruedenberg ,  @xcite and pipek - mezey ,  @xcite although others have been proposed .",
    "all of the above can be used in first - principles methods ; pipek - mezey s can also be applied in semiempirical methods .",
    "the common procedure to compute localized orbitals is to complete firstly a canonical calculation and , later , use the canonical orbitals in an iterative optimization process converging to @xmath12 .",
    "gilbert  @xcite has pointed out that any set of occupied localized orbitals formally fulfills the eigenvalue equation of an effective fock ( or kohn - sham ) hamiltonian defined as @xmath16 , @xmath17 \\,\\underline{\\varphi}^{l }      =    \\underline{\\varphi}^{l } \\ , \\underline{\\lambda } \\,,\\end{aligned}\\ ] ] where @xmath18 is a hermitean localization operator and @xmath19 is a diagonal matrix whose diagonal elements are the eigenvalues of @xmath20 and of @xmath18 , @xmath21 localization operators @xmath18 corresponding to the above mentioned localization methods are , in general , not known and eq .",
    "[ eq : loceq ] has not been exploited to compute the localized orbitals via diagonalization of the matrix @xmath22 , to our knowledge .",
    "[ eq : loceq ] has been discussed by several authors  @xcite and it has been used as a basis for a building - block technique based on a self - consistent series of embedded cluster calculations .  @xcite the iterative solution of the building - block equations of ref .  , which contain arbitrary localization operators , leads to localized orbitals dependent on the initial guess and on the iteration procedure .",
    "although in principle this is not detrimental for total energy calculations , it is an undesirable property because it creates problems of transferability of localized orbitals between similar molecules .    here , on the basis of the same ideas than in ref .",
    ", we present a new building - block and embedding method that , starting from an arbitrary guess and a choice of a particular localization method ( boys , edmiston - ruedenberg s , pipek - mezey s , or any other ) , leads , in a controlled manner , to the corresponding localized orbitals",
    ". we will call this method .",
    "let us suppose we set the goal of computing the @xmath0 occupied localized orbitals corresponding to a localization method @xmath13 for the ground state of a molecule , @xmath23 and related properties such as electron density and total energy .",
    "we see the whole set of localized orbitals as a mosaic of orbitals , and define subsystem , fragment , cluster , or _",
    "tessera _ as a subset of these orbitals which are localized in some region of real space .",
    "( for example , in an organic acid r - cooh we may define one of the subsystems or _",
    "tesserae _ as that made of nine orbitals localized in the spatial region close to the cooh nuclei . )",
    "the terms subsystem , fragment , and cluster have been used by many authors with different meanings and we prefer to use the term _ tessera _ all over the paper for the present definition of subsystem . in this way , the whole mosaic of localized orbitals is made of @xmath24 _ tesserae _ , and the vector of localized orbitals can be rewritten as @xmath25 where @xmath26 is a row vector with the @xmath27 occupied orbitals of  a , @xmath28 @xmath29 a row vector with the @xmath30 orbitals of  b , @xmath31 and so on , with @xmath32 .",
    "the orbitals of a  define a subspace of the occupied space whose density and projection operator is @xmath33 the density operators of the  fulfil @xmath34 where the sum in eq .",
    "[ eq : rhocond - b ] extends over all the @xmath24  of the system .    in the  method we seek to compute the localized orbitals of each out of its own eigenvalue equation : @xmath35         \\,\\underline{\\varphi}^{l}_a      =      \\underline{\\varphi}^{l}_a\\,\\underline{\\lambda}_a \\ , ,            \\\\",
    "\\label{eq : bb - b }    \\mbox{\\it tessera}\\,\\,b & : &       \\nonumber \\\\     \\hat{f}^{l}_b\\,\\underline{\\varphi}^{l}_b      & = &      \\left [ \\hat{f } - \\hat{\\rho}\\,\\hat{f}\\,\\hat{\\rho }                          + \\hat{\\rho}\\,\\hat{l}_b\\,\\hat{\\rho } \\right ]         \\,\\underline{\\varphi}^{l}_b      =      \\underline{\\varphi}^{l}_b\\,\\underline{\\lambda}_b \\ , , \\\\",
    "\\nonumber    & \\ldots & \\hfill \\hspace{1mm}\\end{aligned}\\ ] ] ( @xmath36 , @xmath37 ,  , being diagonal matrices of size @xmath38 , @xmath39 ,  , ) under the conditions of eqs .",
    "[ eq : rhoa]-[eq : rhocond - c ] .",
    "these conditions are fulfilled if all the orbitals are eigenfunctions of the same hermitean operator . in other words ,",
    "all the orbitals @xmath40 for @xmath41 must be eigenfunctions of @xmath42 , all the orbitals @xmath43 for @xmath44 must be eigenfunctions of @xmath45 , and so on .",
    "this means that the subsystem localization operators @xmath46 , @xmath47 ,   of eqs .",
    "[ eq : bb - a ] , [ eq : bb - b ] ,",
    "  must be such that the effective subsystem hartree - fock or kohn - sham hamiltonians @xmath42",
    ", @xmath45 ,  , have the same eigenfunctions as @xmath20 in eq .  [ eq : loceq ] but different eigenvalues .",
    "( note that the virtual orbitals @xmath9 are also eigenfunctions of eqs .",
    "[ eq : bb - a ] , [ eq : bb - b ] ,  since @xmath48 ; their calculation has not been stated as a goal here and they will not be referred to in the rest of the section . )    as commented above , the localization operator @xmath18 in eq .",
    "[ eq : loceq ] corresponding to a localization method @xmath13 is usually not known .",
    "however , every localization method @xmath13 has a well defined procedure for the computation of the unitary transformation matrix @xmath12 ( eq .",
    "[ eq : canul ] ) in a given molecule .",
    "@xcite this procedure can also be applied to any orthogonal basis of the occupied space @xmath49 other than the canonical orbital basis @xmath3 ; the result is then the unitary matrix @xmath50 that transforms the initial non - canonical set of occupied orbitals onto the @xmath13-method localized orbitals , @xmath51 at this point , we can express the operator @xmath18 of eq .",
    "[ eq : loceq ] as its spectral representation in any basis of the occupied space , e.g. @xmath49 , @xmath52    now , consistently with the discussion following eqs .",
    "[ eq : bb - a ] , [ eq : bb - b ] ,  , we can define the following hermitean subsystem or  localization operators : @xmath53 where @xmath54 , @xmath55 , ",
    "are diagonal matrices of size @xmath6 with arbitrary diagonal real data . a choice consisting on low values for the @xmath27 diagonal elements of @xmath54 corresponding to the localized orbitals of  @xmath56 , @xmath43 , and sufficiently higher values for the @xmath57 remaining diagonal elements , guarantees that the localized orbitals of  @xmath56 are computed as the lowest @xmath27 eigenvectors of the effective hartree - fock or kohn - sham hamiltonian @xmath42 ( eq .  [ eq : bb - a ] ) , which is a convenient choice for safe and efficient orbital selection in the iterations of self - consistent procedures .",
    "obviously , the same comments stand for all .",
    "we may remark that a choice consisting on negative values for the @xmath27 , @xmath30 ,   cited diagonal elements and zero values for the @xmath58 , @xmath59 , ",
    "remaining elements , although not necessary , is efficient and simplifies the expression of the subsystem localization operators , @xmath60 where @xmath61 , of size @xmath38 , is the diagonal eigenvalue matrix of eq .",
    "[ eq : bb - a ] , and @xmath62 is a rectangular matrix made of @xmath27 columns of @xmath50 , and similarly for all .",
    "using eqs .",
    "[ eq : la ] , [ eq : lb ] ,  in [ eq : bb - a ] , [ eq : bb - b ] ,  , plus the fact that @xmath14 is the projection operator of the occupied space ( eq .  [ eq : rhoisproj ] ) , results in the working equations of the  method for a localization method of choice @xmath13 : @xmath63         \\,\\underline{\\varphi}^{l}_a                                \\nonumber \\\\      & = &      \\underline{\\varphi}^{l}_a\\,\\underline{\\lambda}_a \\ , ,            \\\\ \\label{eq : mosaico - b }    \\mbox{\\it tessera}\\,\\,b & : & \\nonumber \\\\     \\hat{f}^{l}_b\\,\\underline{\\varphi}^{l}_b      & = &      \\left [ \\hat{f } - \\hat{\\rho}\\,\\hat{f}\\,\\hat{\\rho } +              \\underline{\\varphi}^{(0 ) }              \\,_{0}\\underline{u}^{l}\\ ,              \\,\\underline{\\lambda}_{b(n)}\\ ,              \\,\\,_{0}\\underline{u}^{l \\dagger}\\ ,              \\underline{\\varphi}^{(0 ) \\dagger }      \\right ]         \\,\\underline{\\varphi}^{l}_b                                \\nonumber \\\\      & = &      \\underline{\\varphi}^{l}_b\\,\\underline{\\lambda}_b \\ , , \\\\",
    "\\nonumber    & \\ldots & \\end{aligned}\\ ] ] eq .",
    "[ eq : mosaico - a ] is the mosaico equation for the embedded  @xmath56 , eq .",
    "[ eq : mosaico - b ] for the embedded  @xmath64 , and so on .",
    "they are pseudoeigenvalue equations ( even in the case of semiempirical methods with density - independent @xmath2 hamiltonians . )",
    "they can be solved with standard scf iterative procedures . starting with an initial guess , @xmath49 , the procedure of the localization method of choice , @xmath13 ,",
    "is applied in order to compute @xmath50 , which , together with @xmath14 and @xmath2 , give the embedded  hamiltonians @xmath42 , @xmath45 ,  for the current iteration .",
    "( note that the elements of the diagonal matrices @xmath54 , @xmath55 ,  , are input real numbers . ) solving the eigenvalue equations leads to new orbitals which are used to update @xmath49 and iterate . at convergence ,",
    "@xmath65 and @xmath50 is the unit matrix . also",
    ", the eigenvalues of the  are identical to the input values of @xmath54 , @xmath55 ,  .",
    "for instance , the @xmath27 non - zero values of @xmath61 coincide with the non - zero values of @xmath54 associated with the localized orbitals of  a.    several options are open for iterative procedures leading to the solutions of the mosaico equations [ eq : mosaico - a ] , [ eq : mosaico - b ] , ",
    "they all have to face two basic types of iterations : ( 1 ) the microiterations , or  iterations , which are standard scf iterations addressed to solve one of the embedded  equations , e.g. eq .  [ eq : mosaico - a ] , for fixed orbitals of the other .",
    "all the methods available for speeding the solution of the canonical hartree - fock or kohn - sham equations can be used here .",
    "( 2 ) the macroiterations , or mosaic iterations , which involve repeated solutions of all the embedded  equations .",
    "the macroiterations can be performed sequentially on a given list of , e.g. @xmath56 , @xmath64 ,  , @xmath56 , @xmath64 ,  , meaning that the orbitals computed for  @xmath56 are used in the calculation of  @xmath64 , and so on .",
    "most interestingly , they can be performed in parallel , meaning that the calculations of all  @xmath56 , @xmath64 , ",
    "are done using the whole mosaic of orbitals from the previous macroiteration .",
    "this alternative is very important , because it allows to take full advantage of parallelism at a high level of the calculation . in other words ,",
    "the full calculation is made of a sequence of macroiterations , each of them consisting of a parallel set of hartree - fock , kohn - sham , or semiempirical calculations on the embedded  @xmath56 , @xmath64 ,  .",
    "each of these  calculations , which can be time consuming , can be performed in a separate processor or computer .",
    "alternataively , the macroiterations can be done _",
    " la carte _ , that is restricted to only one or several selected .",
    "this is to say that only some of the localized orbitals are optimized whereas the rest of them are frozen .",
    "this is the embedded cluster approximation .",
    "its reliability rests upon the transferability of the localized orbitals .",
    "embedded cluster calculations are significantly cheaper than the full calculation of a complete system .",
    "they can be performed on a molecule or solid if a calculation on a similar molecule or solid has been carried out before in order to provide the orbitals of the embedding frozen .",
    "they are specially useful to study defects in solids , chemisorption , series of molecules with different substituents , or reactions taking place in local regions of large molecules .    the  equations ( eqs .",
    "[ eq : mosaico - a ] , [ eq : mosaico - b ] ,  ) , which give the localized orbitals of a given localization method @xmath13 and , in consequence , the same total energy and electron density than the canonical calculation , are the basis for approximations that make them useful in practice .",
    "these approximations , which resort to truncations supported by the localized nature of the orbitals , are systematic and converge to the exact result .",
    "they are basically twofold : ( 1 )  an orbital - specific basis set approximation can be adopted , where the localized orbitals of a  are expanded in a different basis set than the localized orbitals of another .",
    "this can be done because the @xmath27 occupied localized orbitals of  @xmath56 are the only orbitals to be computed by solving equation [ eq : mosaico - a ] , whereas the @xmath58 orbitals of the other  are discarded ; consequently , a local basis set can be used as long as it is sufficient for a good representation of the localized orbitals @xmath43 .",
    "obviously , this is true for any .",
    "( 2 )  a localization algorithm based on local rotations can be used in each interation instead of the standard algorithm of the localization method of choice , @xmath13 . in the local rotations algorithm ,",
    "the localized orbitals of  @xmath56 are computed in each iteration using a subset of the @xmath49 orbitals which is localized in  not too distant from @xmath56 .",
    "this can be done because the target localized orbitals are computed out of input localized orbitals rather than out of canonical orbitals .      in a standard molecular calculation ,",
    "all the orbitals of a molecule are expanded in a common basis set , which is the basis set of the molecule and consists of @xmath66 basis set functions , @xmath67 which could be contracted gaussian functions or other sort of local functions . in the orbital - specific basis",
    "set approximation , osbs , the localized orbitals of  @xmath56 are expanded in a local basis set made of @xmath68 functions , the localized orbitals of  @xmath64 in a local basis set made of @xmath69 functions , and so on .",
    "although not necessary , it is very convenient that the local basis sets are subsets of the global basis set , and that several  share a number of basis set functions .",
    "the local basis sets can be represented by the following row vectors , @xmath70 accordingly , eqs .",
    "[ eq : mosaico - a ] ,  [ eq : mosaico - b ] ,  , take the usual matrix form ,  @xcite @xmath71 in eq .",
    "[ eq : a ] , for instance , @xmath72 and @xmath73 are the @xmath74 matrix representations of the @xmath75 and the unit operators in the @xmath76 basis set , @xmath77 and @xmath78 is the @xmath79 matrix of localized orbital coefficients , @xmath80 the solution of eq .",
    "[ eq : a ] can be attained using standard ( @xmath81 ) diagonalization procedures . except for low gap materials , where the degree of localization attainable",
    "is limited and the localized orbitals may decay slowly with distance ,  @xcite the local basis set size @xmath68 is expected to remain within reasonable limits for a diagonalization or , more generally , for an embedded cluster calculation .",
    "obviously , the growth of @xmath68 will impose more practical limitations in 3d systems , like bulk solids and very big clusters , than in 2d and 1d systems , like many molecules .",
    "in general , all the methods useful to speed up a standard molecular calculation , like convergence acceleration methods , can be used with eq .",
    "[ eq : a ] .",
    "but , in this case , additional advantage can be taken from the fact that only a small number of eigenvalues / eigenfunctions are computed for each , and efficient diagonalization algorithms used in ci calculations , like the multiroot davidson - liu method ,  @xcite can be applied to significantly reduce the prefactor of the ( @xmath81 ) dependence .",
    "let us comment on the calculation of the effective hamiltonian matrix of a , @xmath72 , where the localized nature of the orbitals is also profitable . for simplicity , we will call @xmath82 the row vector of the @xmath0 current localized orbitals ( @xmath83 , eq .",
    "[ eq:0ul ] ) at a given iteration , which can be written as the union of the row vectors @xmath84 , @xmath85 ,  , that contain the @xmath27 , @xmath30 ,  current localized orbitals of  @xmath56 , @xmath64 ,   respectively , @xmath86 the @xmath74 effective hamiltonian matrix of  @xmath56 is @xmath87 the first term in the right hand side of eq .",
    "[ eq : feffa ] is a diagonal block of the hamiltonian matrix of the full system .",
    "the second term can be expanded in inter-  terms by inserting eq .",
    "[ eq : rhocond - b ] : @xmath88 \\,.\\end{aligned}\\ ] ] in the evaluation of eq .",
    "[ eq : rhohrho ] , we can take advantage of the locality of basis sets and molecular orbitals by evaluating a @xmath89 interaction table and a @xmath90 interaction table .",
    "@xmath89 is set to @xmath91 if all the elements of the @xmath92 matrix @xmath93 and all the elements of the @xmath94 matrix @xmath95 have an absolute value lower than a given threshold , and is set to @xmath96 otherwise .",
    "similarly , @xmath90 is set to @xmath91 if all the elements of the @xmath97 matrix @xmath98 have an absolute value lower than a given threshold , and is set to @xmath96 otherwise . rearranging eq .",
    "[ eq : rhohrho ] and using these interaction tables , we can write @xmath99 \\,.\\end{aligned}\\ ] ] the use of the  interaction tables @xmath89 and @xmath90 guarantees that the calculation of the present term does not scale as @xmath100 because the number of  in the neighborhood of ( or interacting with )  @xmath56 does not increase indefinitely with the size of the molecule .",
    "also , note that the interaction tables do not need to be updated every macroiteration , because the localized orbitals do not experience big changes in size after a few iterations .",
    "it should be noticed that we assume that a linear - scaling method is used for the computation of the hamiltonian matrix of the full system ,  @xcite of which diagonal and nondiagonal blocks are needed in eqs .",
    "[ eq : feffa ] and [ eq : rhohrho - ok ] .",
    "the last term in eq .",
    "[ eq : feffa ] can be written as @xmath101 where the @xmath89 interaction table is used and @xmath102 is the @xmath39 diagonal matrix resulting from the elements of @xmath54 corresponding to the localized orbitals of  @xmath64 . for the particular choice of the arbitrary diagonal matrix @xmath54 leading to eq .",
    "[ eq : la2 ] , eq .",
    "[ eq : thirdterm ] is further simplified : @xmath103 where all @xmath104 must be negative .    the computation of the @xmath72 matrices ( eqs .",
    "[ eq : feffa ] , [ eq : rhohrho - ok ] , and [ eq : thirdterm ] ) and their diagonalization ( eq .  [ eq : a ] ) can be performed in parallel .",
    "this is graphically indicated in the upper part of fig .",
    "[ fig : loops ] . the global scaling of this diagonalization step",
    "is @xmath105 ; in the case of all  having the same local basis set size , @xmath106 , and same number of interactions with other , the scaling is @xmath107 .     +      usually , a given set of localized orbitals of a molecule , @xmath83 , is computed out of the canonical orbitals ( eq .  [ eq : canul ] ) .",
    "well defined algorithms are routinely used to calculate the @xmath6 unitary transformation matrix @xmath12 , which are normally of order @xmath108 or higher .",
    "@xcite in the present method , however , they are computed in each macroiteration out of other set of localized orbitals ( eq .  [ eq:0ul ] ) .",
    "we can expect the contributions of the initial localized orbitals @xmath49 to the target localized orbitals @xmath83 to decay with distance .",
    "accordingly , a @xmath109 local rotation table can be computed , where @xmath110 if the initial localized orbitals of  @xmath64 are used to compute the target localized orbitals of  @xmath56 ( and viceversa ) and @xmath111 otherwise .",
    "several options to compute the @xmath109 local rotation table are possible .",
    "reasonable choices are to use the same criterium as for the @xmath112 interaction table except for the use of a different threshold or , simply , make the @xmath109 local rotation table identical to the @xmath112 interaction table .    arranging the initial localized orbitals in , @xmath113 the approximation of local rotations for the localization step can be written as @xmath114 in eq .",
    "[ eq : locrot - a ] , @xmath115 is the @xmath116 block of @xmath117 with the contributions of the initial localized orbitals of  @xmath118 to the target localized orbitals of  @xmath56 . the column block made of all @xmath115 with @xmath119 is represented by the fill rectangular box shown in fig .",
    "[ fig : lrot ] . this column block can be calculated approximately as the column block of the submatrix of @xmath120 indicated in fig .",
    "[ fig : lrot ] by the open square box .",
    "we can call this submatrix @xmath121 , so that if @xmath122 is a row vector with the initial localized orbitals of all  @xmath118 having @xmath123 ( of length ) , then @xmath124 @xmath121 can be computed by simple application of the localization method of choice to the set of @xmath125 initial localized orbitals @xmath122 .",
    "note that only the @xmath27 orbitals of @xmath126 corresponding to  @xmath56 ( @xmath127 ) are taken from eq .",
    "[ eq : ulra ] . lowering the threshold of the local rotation table",
    "improves the precision of this approximation systematically .",
    "+     +    the computation of the @xmath121 matrices ( eqs .",
    "[ eq : ulra ] ) can be performed in parallel .",
    "this is graphically indicated in the lower part of fig .",
    "[ fig : loops ] .",
    "the global scaling of this localization step is @xmath128 , where @xmath129 is the order of the localization method of choice @xmath13 ( e.g. 3 in pipek - mezey and 5 in edmiston - ruedenberg methods ) ; if the same number of orbitals are used in the local rotations of all , @xmath130 , the scaling is @xmath131 .",
    "since the localization by local rotations among initial localized orbitals goes together with the use of orbital - specific basis sets , the resulting localized orbitals of  @xmath56 must be represented with the basis set @xmath76 alone .",
    "this can be achieved by truncation of @xmath26 after the transformation ( eq .",
    "[ eq : locrot - a ] ) or , alternatively , by its projection on the @xmath76 space , @xmath132 .",
    "we have not observed any practical advantage in projecting instead of truncating , neither in the precision attainable in the total energy nor in the convergence , in all the tests performed .",
    "the orbitals resulting from the present method do not belong to irreducible representations of the molecular point symmetry group because they are not eigenfunctions of the totally symmetric one - electron hamiltonian @xmath2 . however , except for symmetry breaking localization methods , they are related by the symmetry operations of the molecule and this fact can be used to reduce computing time .",
    "@xcite in effect , all  orbitals can be obtained by applying molecular symmetry operations , @xmath133 , to a list of symmetry independent , so that if @xmath56 is a symmetry independent  and  @xmath64 is obtained from @xmath56 by symmetry operation @xmath133 , then @xmath134 . in other words , the diagonalizations and localizations",
    "described in sections  [ sec : osbs ] and [ sec : lr ] can be performed only on the list of symmetry independent .",
    "the computation of @xmath72 ( eq .  [ eq : feffa ] ) can also profit from this property .",
    "also , the site symmetry of the  can be used in exactly the same way that molecular symmetry is used in standard molecular calculations , because the matrix of the effective hamiltonian of any embedded  is blocked according to the irreducible representations of the local point symmetry group of that particular .    besides the use of symmetry",
    ", one can also take advantage of quasisymmetry for speeding up purposes .",
    "so , if two  @xmath56 and @xmath64 are quasisymmetry related by an operation @xmath135 ( @xmath136 ) , they can be treated as symmetry related for a number of macroiterations , in which the list of  where the diagonalization and localization steps are performed can be shortened , finally releasing all quasisymmetry restrictions up to a full convergence of the  calculation .      in summary , the algorithm for a  calculation of a molecule is the following :    1 .",
    "[ mosaico - step-1 ] take the current guess of localized orbitals of the molecule and do , in parallel , for each symmetry independent : 1 .   compute the embedded  effective hamiltonian matrix ( eqs .",
    "[ eq : feffa ] , [ eq : rhohrho - ok ] , and [ eq : thirdterm ] ) , 2 .",
    "diagonalize it ( eq .",
    "[ eq : a ] ) and compute new  orbitals ( eq .  [ eq : neworb ] ) , 2 .",
    "[ mosaico - step-2 ] take all the orbitals produced in step [ mosaico - step-1 ] and do , in parallel , for each symmetry independent : 1 .",
    "compute the @xmath121 unitary matrix ( eq .  [ eq : ulra ] ) corresponding to the localization method of choice @xmath13 by applying the corresponding localization algorithm , and take the columns that correspond to the current , 2 .",
    "compute the target  localized orbitals ( eq .  [ eq : locrot - a ] ) , 3 .",
    "check for convergence and iterate on step  [ mosaico - step-1 ] if necessary .",
    "compute properties upon convergence .",
    "[ eq : project ]    the parallel steps [ mosaico - step-1 ] and [ mosaico - step-2 ] are schematically represented in fig .",
    "[ fig : loops ] .",
    "in this section , we present the results of monitoring calculations on poly(ethylene oxide ) molecules , , ( sec .",
    "[ sec : peo ] ) and three dimensional co clusters , ( co)@xmath137 , ( sec .",
    "[ sec : co ] ) aimed at showing the convergence of the parallel calculations to the right solutions , the convergence of the total energies with the size of the orbital - specific basis sets towards the exact values , and the linear - scaling of the method .",
    "we also include embedded cluster calculations on defective systems resulting from a chemical substitution of one o atom by a s atom in poly(ethylene oxide ) , ( sec .",
    "[ sec : ec ] ) aimed at showing the performance of embedded cluster calculations vs. full system calculations .",
    "all the calculations are single point energy calculations with an extended hckel ( eh ) hamiltonian .",
    "@xcite this is a convenient choice to monitor the  procedure because , on the one hand , the hamiltonian and overlap matrices of the eh method are isomorphous with their  counterparts , and on the other , the hamiltonian is not self - consistent and its computation is straightforward . in this way , the analysis of timing and scaling is focused on the orbital optimization or diagonalization part and free from contaminations due to the computation of the hamiltonian matrix .",
    "the calculations have been performed with a 2 gb ram personal computer with the program mosaico ;  @xcite the extended hckel hamiltonian and overlap matrices have been calculated with the program eht .",
    "@xcite although the loops performed mimic parallel loops ( fig .",
    "[ fig : loops ] ) , the total elapsed times shown hereafter correspond to sequential loops performed in a single processor . in the present version of the program",
    "we have paid special attention to the scaling features , whereas the prefactors are highly improvable .",
    "this fact , together with the average performance of the personal computer used , makes the absolute values of the elapsed times shown in this section of little value ; instead , it is the scaling of the method what is relevant .",
    "poly(ethylene oxide ) ( peo )  @xcite is a polymer widely used in the field of polymer electrolytes of molecular formula .",
    "the molecular calculations we present for different numbers of monomers , @xmath138 , use the localization method of projected localized molecular orbitals ( plmo )  @xcite ( see appendix ) using a very simple set of reference orbitals : @xmath139 for all a - b pairs of bonded atoms , plus @xmath140 and @xmath141 for all oxygen atoms , where @xmath142 and @xmath143 are local cartesian axis on the oxygen assuming the c - o - c atoms define a @xmath144 plane with the @xmath142 axis bisecting the c - o - c angle .    in all these calculation we used the following definition for the  or subsystems : one  made of 10 orbitals localized in the sigma bonds and lone pairs of ch@xmath145och@xmath146 [ which , in the localization method used for these particular calculations , are the 10 orbitals with one - to - one maximum overlap with the reference orbitals @xmath147 , @xmath148 , @xmath149 , @xmath150 , @xmath151 , @xmath152 , @xmath153 , @xmath154 , @xmath155 , @xmath156 , plus @xmath157  made of 9 orbitals localized in the sigma bonds and lone pairs of the next ch@xmath146och@xmath146 groups , and a final  of 9 orbitals localized in the sigma bonds and lone pairs of the terminal ch@xmath146och@xmath145 .",
    "we performed the  calculations using three different orbital - specific basis sets : in the calculations labeled 1n , the orbitals of each  have been represented with a subset of the global basis set consisting of all the basis set functions of the atoms involved in the bonds and lone pairs of the  plus those of the atoms involved in bonds and lone pairs of the first neighbor  or monomers . in the 2n and 3n calculations , the orbital - specific basis sets were extended to second and third neighbor monomers .",
    "all the calculations converge to the same results regardless of the initial guess and the iteration procedure ( parallel or any kind of sequential choice ) .",
    "the 9 localized orbitals which constitute one of the the bulk  of h(ch@xmath146och@xmath146)@xmath158h are shown in fig .",
    "[ fig : peo - tess9 ] .     +    fig .",
    "[ fig : peo - etot ] shows the total energy of h(ch@xmath146och@xmath146)@xmath158h as a function of the orbital - specific basis sets used , which converges to the exact energy in the limit of a standard calculation where all orbitals are spanned in a common basis set . as the size of the osbs increases , the lack of full orthogonality between orbitals of differente  originated by the basis set truncation becomes negligible and , accordingly , the difference between the total energy properly computed and the total energy computed under the assumption that the orbitals are fully orthogonal vanishes .",
    "the energy loss per monomer due to the use of orbital - specific basis sets instead of a common basis set for all orbitals , is presented in table  [ tab : one ] for several orbital - specific basis sets as a function of the molecular size .",
    "the predictability of the energy losses is apparent .",
    "[ fig : peo - evsiter ] shows the convergence with macroiterations of the total energy of the h(ch@xmath146och@xmath146)@xmath158h polymer at the 2n level of orbital - specific basis set .     +     ccrrr   + & osbs & +   + & & & +   + & 1n & @xmath159 & @xmath160 & @xmath161 + & 2n & @xmath162 & @xmath163 & @xmath164 + & 3n & @xmath165 & @xmath165 & @xmath166 +   + & & & +   + & 1n & @xmath167 & @xmath168 + & 2n & @xmath169 & @xmath170 + & 3n & @xmath171 & @xmath172 +    fig .",
    "[ fig : peo - time ] shows the wall clock elapsed time per macroiteration in the calculation of the h(ch@xmath146och@xmath146)@xmath173h molecules as a function of the number of monomers @xmath138 ( which in this case coincides with the number of , @xmath24 ) , of atoms , and of basis set functions .",
    "the times per macroiteration and spent in the diagonalization step and in the localization step are shown in fig .",
    "[ fig : peo - tesseratime ] .",
    "the horizontal lines reflect the ( @xmath24 ) scalings of both steps .",
    "the ( @xmath174 ) scaling of the diagonalization step is clearly reflected in the separation between the 1n , 2n , and 3n horizontal lines .",
    "the drop of the lines at low number of monomers is due to surface effects : the ratio between edge  and bulk  is significant in small polymers and , since edge  are less demanding in terms of orbital - specific basis set and in terms of number of inter-  interactions , they reduce the computing time with respect to what it would be if all of them were bulk . as we will see below , this fortunate surface effect , which lowers time with respect to a set of @xmath24 bulk ,",
    "is much more pronounced in 3d systems .",
    "the localization times shown in the bottom part of fig .",
    "[ fig : peo - tesseratime ] are very similar in the 1n , 2n and 3n calculations .",
    "this is so because they depend basically on the number of orbitals used in the local rotations , which is the same in the three calculations . for the particular localization method we used for these calculation , plmo ,",
    "the elapsed times scale as @xmath175(@xmath176 ) @xmath177  ( @xmath178)(@xmath24 ) .",
    "the small dependence with the size of the orbital - specific basis sets is related with the lengths of the matrix transformations in eq .",
    "[ eq : plolr ] .",
    "+     +     +      we performed  calculations on three dimensional ( co)@xmath173 clusters of several sizes , extracted from the crystalline structure of the @xmath7 phase of solid carbon monoxide ( @xmath179 spatial group , co bond length @xmath180(c - o )  =  1.128   , cell constant @xmath181  =  5.64   ) ,  @xcite which is an interesting material known to experience irreversible photopolymerization under pressure .",
    "@xcite in this crystal , a bulk co molecule has a first - neigbhor coordination number 12 ( co molecules at a distance between centers of gravity of 3.99   ) , and second- and third - neigbhor coordination numbers 18 and 42 ( co molecules at 5.64    and 6.91   , respectively ) . the ( co)@xmath182 cluster is represented in fig .",
    "[ fig : co63 ] as an example .",
    "+     +    in these calculations we also used the plmo localization method , with the reference orbitals defined as the @xmath183 valence occupied canonical orbitals of the @xmath138 isolated co molecules .",
    "we defined each  to be made of 5 orbitals localized in the spatial region of a co molecule , which , for the chosen localization method , means the 5 localized orbitals with maximum overlap with the canonical orbitals of the co molecule .",
    "the orbital - specific basis sets used have been labeled 1n , 2n , and 3n when the basis set of a  consists of the basis set functions of its c and o atoms plus the basis set functions of the atoms of the first , second , and third - neighbor co molecules , respectively ( see above ) .",
    "the energy losses per co molecule ( table  [ tab : one ] ) are small and diminish as the size of the osbs increases .",
    "times per macroiteration and spent in the diagonalization step and in the localization step are shown in fig .",
    "[ fig : co - tesseratime ] .",
    "the diagonalization times spent in a inner or bulk , which is the most demaning , are included as a reference .",
    "this time is constant for all clusters where the inner  is a truly bulk , that is , where its osbs and its interaction tables die off before the limits of the cluster ; this situation is reached in a smaller cluster for the 1n osbs and in a bigger cluster for the 3n osbs .",
    "naturally , the times spent per  in the full system calculations are lower than the times spent in the bulk , the differences showing the importance of surface effects : smaller clusters and bigger orbital - specific basis sets have a larger ratio of surface / bulk  and , accordingly , a larger time reduction with respect to the bulk . in a large @xmath138 regime ,",
    "the bulk  are dominant and set the assymptotic limit of the full system times , which scale linearly with the cluster size .",
    "the ( @xmath184 ) dependence is shown by the asymptotic values of the 1n , 2n , and 3n lines , as well as by the values of @xmath185 printed along the 3n line in fig .",
    "[ fig : co - tesseratime ] .",
    "the localization times ( bottom of fig .",
    "[ fig : co - tesseratime ] ) are very much independent of the size of the osbs because they are directly dependent in the number of occupied orbitals included in the local rotations , which is the same in 1n , 2n , and 3n calculations ; the small dependence shown in the figure is due to the fact that the transformations down to the basis set level depend on the osbs size .",
    "+      the  method can be used for embedded cluster calculations , where the computational effort is focused on an active site of a molecule , comprising only a number of relevant , while the rest of it is taken from a previous calculation on a similar molecule and frozen . in this section",
    "we show the results of embedded cluster calculations on h(ch@xmath146och@xmath146)@xmath186-ch@xmath146sch@xmath146-(ch@xmath146och@xmath146)@xmath186h .",
    "h(ch@xmath146och@xmath146)@xmath186-ch@xmath146sch@xmath146-(ch@xmath146och@xmath146)@xmath186h can be regarded as the result of creating a chemical defect in h(ch@xmath146och@xmath146)@xmath173h , with @xmath187 , by substitution of the central oxygen by a sulfur atom .",
    "we may expect the localized orbitals distant from the s atom in the  defective \" molecule to be very similar to the orbitals of the  perfect \" molecule localized in the same spatial regions and , accordingly , we may take them from a previous calculation on h(ch@xmath146och@xmath146)@xmath173h and use them in a  calculation of h(ch@xmath146och@xmath146)@xmath186-ch@xmath146sch@xmath146-(ch@xmath146och@xmath146)@xmath186h where they are kept frozen ; this defines an embedded cluster  calculation .",
    "canonical and  calculations on the @xmath188 polymer ( using the same nuclear configurations before and after the creation of the s defect ) reveal that the precision reached with a 3n orbital - specific basis set on the perfect polymer requires a better osbs after creating this chemical defect : a 5n basis set for the central defective  and its 5 neighbor together with a 3n basis set for the remaining , gives an energy error of @xmath189 hartree / monomer . taking this into account , we performed embedded cluster calculations using a 5n osbs for the variational  and taking the orbitals that remain frozen for the rest of in the polymer from the 3n osbs calculation on the  perfect \" polymer molecule h(ch@xmath146och@xmath146)@xmath173h .",
    "the total energy errors of these embedded cluster calculations ( with respect to the full molecular  calculations ) on the polymers of 21 and 201 monomers are shown in fig .",
    "[ fig : peo - s - ec ] as a function of the active cluster size ( number of active ) .",
    "+     +    it is shown that the errors are too large to be acceptable if only the central defective  is active , whereas they drop to an acceptable value of @xmath190  hartree when the orbitals of the first - neigbhor  are optimized as well , and to less than @xmath191  hartree when second - neigbhor  are part of the variational embedded cluster .",
    "these errors are the same in the two @xmath188 and @xmath192 polymers , as corresponds to the local nature of the chemical defect .",
    "the times spent in the embedded cluster calculations , as a fraction of the times spent in the respective full system calculations , are shwon at the bottom of fig .",
    "[ fig : peo - s - ec ] .",
    "overall , this figure illustrates the potentiallity of embedded cluster calculations where the transferability of the localized orbitals of a localization method of choice is exploited .",
    "we presented a new linear - scaling method for the energy minimization step of semiempirical and first - principles hartree - fock and kohn - sham calculations , which we abbreviated under the name . in this method , a set of embedded  pseudoeigenvalue coupled equations is solved in a building - block self - consistent fashion , which results in optimum occupied localized orbitals of any localization method of choice , represented with orbital - specific basis sets .",
    "the  method is parallel at a high level of the calculation .",
    "it can be used in full system calculations as well as in embedded cluster calculations , where only an active fraction of the localized molecular orbitals of the whole system are variational while the rest are taken from a similar molecule and kept frozen .",
    "we presented the results of monitoring , single point energy calculations with the extended hckel hamiltonian on poly(ethylene oxide ) molecules and three dimensional carbon monoxide clusters with very large number of basis set functions .",
    "total energy losses due to the use of orbital - specific basis sets are small for reasonably small sizes of these and total energies converge to the canonical values when the orbital - specific basis sets are increased towards the limit of a common basis set for all the localized orbitals",
    ". convergence of total energy with self - consistent macroiterations is good and elapsed times per macroiterations have been shown to scale linearly with the molecular size . besides the full system calculations , the good performance of the much less demanding embedded cluster approach has been shown in total energy calculations on defective systems resulting from chemical substitution of an oxygen atom by a sulfur atom in poly(ethylene oxide ) molecules .",
    "the transferability of the localized orbitals of a given localization method between similar molecules has been shown to lead to the same total energy precision than full molecular calculations at a fraction of the computational cost .",
    "this research was supported in part by direccin general de investigacin , ministerio de ciencia y tecnologa , spain , under contract bqu2002 - 01316 , and ministerio de educacin , cultura y deportes , spain , accciones de movilidad pr2003 - 0024 and pr2003 - 0027 .",
    "we are very grateful to professor martin head - gordon , university of california , berkeley , and to his research group for their hospitality .",
    "a simple localization method has been proposed by ruedenberg ,  @xcite which has not reached the popularity of other methods like boys ,  @xcite edmiston - ruedenberg ,  @xcite and pipek - mezey  @xcite methods . although it has been formulated in a context of atoms - in - molecules , it is a general method . here ,",
    "we reformulate it in the general case and in the case of localization by local rotations ( sec .  [ sec : lr ] ) , using the present notation .",
    "given a set of @xmath0 input occupied ( canonical or localized ) orthogonal orbitals of a molecule , @xmath193 , and a set of @xmath0 reference arbitrary orbitals , @xmath194 , the @xmath0 projected localized orthogonal orbitals , @xmath195 , are defined as those resulting from a unitary transformation of @xmath49 which are most similar to @xmath196 .",
    "the plmos correspond to maximizing the one - to - one overlaps with the reference orbitals @xmath196 , or the functional @xmath197 , under orthogonality constraints  @xcite and can be computed as  @xcite @xmath198^{-\\frac{1}{2 } }    =     \\underline{\\varphi}^{(0)}\\ , _ 0\\underline{u}^{plmo } \\,,\\end{aligned}\\ ] ] with @xmath199^{-\\frac{1}{2 } } \\,.\\end{aligned}\\ ] ] in the approximation of local rotations ( section  [ sec : lr ] ) , the projected localized orbitals of a  @xmath56 are computed out of @xmath125 ( @xmath200 ) input localized orbitals @xmath122 and @xmath125 reference orbitals @xmath201 , both of them including the localized / reference orbitals belonging to the  included in the local rotations , with the expression : @xmath202 being @xmath203^{-\\frac{1}{2 } }    \\big\\}_{n_a-\\mbox{col } } \\,,\\end{aligned}\\ ] ] where it has been indicated that only the @xmath27 columns that correspond to  @xmath56 are computed and used .    among the advantages of the plmo localization method are its speed and its simplicity , because the usual iterative optimization procedures involved in localization  @xcite are substituted by a one - step calculation of the reciprocal square root of a symmetrical matrix , which is an ( @xmath108 ) process ( or ( @xmath204 ) in local rotations ) .",
    "its main disadvantage is the requirement of an external , arbitrary set of reference orbitals , @xmath196 .",
    "although this is a limitation in calculations of reactivity , it is not a practical problem in molecular structure calculations where the nature of the bonds is known in advance and finding good reference bond and lone pair orbitals is not difficult .",
    "we may remark that the application of the plmo method with a reference consisting of a given set of localized orbitals , e.g. edmiston - ruedenberg s , leads exactly to that set of orbitals .",
    "this property can be exploited in many ways and , in particular , in order to remove the arbitrariness inherent to the plmo method .",
    "for instance , it can be used to produce reference orbitals for the plmo method ( to be used in large molecules ) out of edmiston - ruedenberg s or other non - arbitrary localized sets computed in selected sets of relatively small molecules .",
    "also , a  calculation addressed to produce a given set of localized orbitals like edmiston - ruedenberg s can be safely performed using the chosen localization method in some macroiterations and the faster plmo method , with the current er orbitals as a reference set , in the rest of them ."
  ],
  "abstract_text": [
    "<S> we present a new linear scaling method for the energy minimization step of semiempirical and first - principles hartree - fock and kohn - sham calculations . </S>",
    "<S> it is based on the self - consistent calculation of the optimum localized orbitals of any localization method of choice and on the use of orbital - specific basis sets . </S>",
    "<S> the full set of localized orbitals of a large molecule is seen as an orbital mosaic where each  is made of only a few of them . </S>",
    "<S> the orbital  are computed out of a set of embedded cluster pseudoeigenvalue coupled equations which are solved in a building - block self - consistent fashion . in each iteration , </S>",
    "<S> the embedded cluster equations are solved independently of each other and , as a result , the method is parallel at a high level of the calculation . </S>",
    "<S> in addition to full system calculations , the method enables to perform simpler , much less demanding embedded cluster calculations , where only a fraction of the localized molecular orbitals are variational while the rest are frozen , taking advantage of the transferability of the localized orbitals of a given localization method between similar molecules . monitoring single point energy calculations of large poly(ethylene oxide ) molecules and three dimensional carbon monoxide clusters using an extended hckel hamiltonian </S>",
    "<S> are presented . </S>"
  ]
}