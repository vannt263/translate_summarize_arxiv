{
  "article_text": [
    "nonlinear diffusion equations are often used to describe a system of interacting particles at the continuum level . these play a key role in various physical and biological applications , including colloidal systems and granular gases , ion transport , chemotaxis , neural networks , and animal swarms .",
    "these continuum models are important as tools to explain how individual - level mechanisms give rise to population - level or collective behavior .",
    "closure approximations such as the mean - field closure are often used to obtain the continuum model , but depending on the type of interactions they can lead to substantial errors . in this paper",
    "we present a new approach that is suited for short - range repulsive interactions .",
    "a typical model for a system of @xmath0 interacting particles is to assume each particle evolves according to the overdamped langevin dynamics and interacts with the other particles via a pairwise interaction potential @xmath1 , so that @xmath2 for @xmath3 , where @xmath4 is the position of the @xmath5th particle at time @xmath6 , @xmath7 is the diffusion constant , @xmath8 denotes a @xmath9-dimensional brownian motion , and @xmath10 is an external force .    despite the conceptual simplicity of the stochastic model [ ssde ]",
    ", it can be computationally intractable for systems with a large number of interacting particles @xmath0 , since the interaction term has to be evaluated for all particle pairs .",
    "in such cases , a continuum description of the system , based on the evolution of the population - averaged spatial concentration instead of individual particles , becomes attractive .",
    "depending on the nature of the interaction potential different averaging techniques may be suitable .",
    "interactions can be broadly classified into local and nonlocal depending on the range of interaction between particles .",
    "nonlocal interactions are associated with a long - range or _ ultra - soft _ interaction potential @xmath1 in [ ssde ] .",
    "then every particle can interact not only with its immediate neighbors but also with particles far away , and one can use a mean - field approximation to obtain a partial differential equation ( pde ) for the one - particle probability density @xmath11 of finding a given particle at position @xmath12 at time @xmath6 . the standard mean - field approximation ( mfa ) procedure applied to the microscopic model [ ssde ] gives @xmath13,\\ ] ] where @xmath14 .",
    "the main assumption in writing down [ mean_field ] is that , in deriving the interaction term , particles can be treated as though they were uncorrelated .",
    "since one is often interested in system with a large number of particles @xmath0 , it is common to consider the number density ( @xmath15 ) and take the limit in which the number of particles and the volume tend to infinity , while keeping the average number density constant , that is , @xmath16 , @xmath17 .",
    "this is known as the thermodynamic limit @xcite , and results in equation ( [ mean_field ] ) for @xmath18 without the factor @xmath19 .    while the mean - field approximation [ mean_field ] is convenient and leads to an accurate description for long - range interactions , such as with coulomb interactions @xcite , it fails when considering relatively strong repulsive short - range potentials .",
    "sometimes [ mean_field ] does not make sense since the convolution does not exist ; in other cases , it results in a poor model of the system because the underlying assumptions of the method are not satisfied , as we will discuss later .",
    "in particular , the model [ mean_field ] does not make sense with hard - core repulsive interactions , which are commonly used to model excluded - volume effects in biological and social contexts @xcite . a common way to circumvent",
    "this is to assume particles are restricted to a lattice , giving rise to so - called on - lattice models .",
    "the most common of these is the simple exclusion model , in which a particle can only move to a site if it is presently unoccupied @xcite .",
    "one can derive an analogous continuous limit to [ mean_field ] using taylor expansions @xcite .",
    "however , it turns out that with identical particles the interaction terms ( analogous to the convolution term in [ mean_field ] ) cancel out unless the external force @xmath20 is nonzero .",
    "because of the issues that the mfa has in particle systems with short - range interaction potentials , one must often resort to alternative closure approximations .",
    "there are a large number of closure approximations , and choosing the right closure for a given pair potential is `` an art in itself '' @xcite due to the phenomenological nature of the approach .",
    "each choice of closure relation results in a different approximate equation for the density @xmath21 , and it is not clear a priori whether it will be a good approximation . as discussed above , one may even obtain an equation that does not make sense or is ill - posed .",
    "one class of closures , including the mfa and the kirkwood superposition approximation ( ksa ) , impose a relation between the @xmath22th and @xmath23th density functions in the bbgky hierarchy ( see [ sec : ibm ] ) .",
    "whereas the mfa closes at @xmath24 ( writing the two - particle density function in terms of the one - particle density ) , ksa closes at @xmath25 , approximating the three - particle density function as a combination of the one- and two - particle density functions @xcite . while the ksa originated in the field of statistical mechanics , where it has been the basis of a whole theory ,",
    "it has recently also been used in biological applications to obtain closed equations for a system of biological cells @xcite .",
    "however , the resulting ksa model is quite complicated to solve and the mfa remains the most commonly used approximation .",
    "another class of closure relations , similar in spirit to ksa , is based on the ornstein  zernike ( oz ) integral equation .",
    "here the pair correlation function is decomposed into a direct part and an indirect part .",
    "the latter is mediated through ( and integrated over ) a third particle . in addition",
    ", the oz equation requires a further closure assumption providing an additional relation between the direct and indirect correlations .",
    "commonly used closures , for hard spheres and soft spheres respectively , include the percus  yevick approximation and the hypernetted chain approximation .",
    "in this paper we are interested in systems such as [ ssde ] with short - range repulsive interactions for which mfa fails .",
    "we will employ an alternative averaging method to obtain a continuum description of the system based on matched asymptotic expansions ( mae ) .",
    "unlike the mean - field approach , this method is systematic .",
    "it is valid for low concentrations , exploiting a small parameter @xmath26 arising from the short - range potential and the typical separation between particles .",
    "the result is a nonlinear advection - diffusion equation of the form @xmath27,\\end{aligned}\\ ] ] where the coefficient @xmath28 depends on the interaction potential @xmath1 and @xmath9 is the dimension of the physical space .",
    "the reminder of the paper is organized as follows . in [ sec : ibm ] we introduce the fokker ",
    "planck pde for the joint probability density of the particle system ; this is another individual - based description equivalent to the langevin stochastic differential equation [ ssde ] . in [ sec : closure ] we discuss three common closure approximations which reduce the fokker ",
    "planck equation to a population - level pde . in [ sec : soft_mae ] we present our alternative approach to closure based on mae , and derive equation [ mae_eq ] . in [ sec : results ] we test the models obtained from the different methods against each other and stochastic simulations of the stochastic particle system for various interaction potentials . finally , in [ sec : conclusions ]",
    ", we present our conclusions .",
    "we consider a set of @xmath0 identical particles evolving according to the langevin stochastic differential equation [ ssde ] in a domain @xmath29 , with @xmath30 .",
    "we nondimensionalise time and space such that the diffusion coefficient @xmath31 , and the volume of the domain @xmath32 .",
    "we suppose the interaction potential @xmath33 is repulsive and short range , with range @xmath34 .",
    "the interaction potential of a system of @xmath0 particles is , assuming pairwise additivity , the sum of isolated pair interactions @xmath35 where @xmath36 is the @xmath0-particle position vector .",
    "the interaction force acting on the @xmath5th particle due to the other @xmath19 particles is given by @xmath37 here forces are non - dimensionalized with the mobility ( the inverse of the drag coefficient ) so that we can talk about a force acting on a brownian particle .",
    "finally , we suppose that the initial positions @xmath38 are random and identically distributed .",
    "the counterpart of [ ssde ] in probability space is the fokker ",
    "planck equation    [ sfp ] @xmath39 \\qquad \\text{in } \\qquad \\omega^n,\\end{aligned}\\ ] ] where @xmath40 is the joint probability density function of the @xmath0 particles being at positions @xmath41 at time @xmath6 and @xmath42 .",
    "since we want to conserve the number of particles , on the domain boundaries @xmath43 we require either no - flux or periodic boundary conditions . throughout this work we use the latter .",
    "accordingly , the potential @xmath1 will be a periodic function in @xmath44 .",
    "the initial condition is @xmath45 with @xmath46 invariant to permutations of the particle labels .",
    "we proceed to reduce the dimensionality of the problem [ sfp ] by looking at the marginal density function of one particle ( the first particle , say ) given by @xmath47 the particle choice is unimportant since @xmath48 is invariant with respect to permutations of particle labels . integrating [ sfp_eq ] over @xmath49 and applying the divergence theorem gives @xmath50,\\ ] ] where @xmath51 is the @xmath9-vectorial function @xmath52 and @xmath53 is the two - particle density function , which gives the joint probability density of particle 1 being at position @xmath54 and particle 2 being at @xmath55 .",
    "an equation for @xmath56 can be written from [ sfp_eq ] , but this then depends on @xmath57 , the three - particle density function .",
    "this results in a hierarchy ( the bbgky hierarchy ) of @xmath0 equations for the set of @xmath22-particle density functions ( @xmath58 ) , the last of which is [ sfp_eq ] itself ( since @xmath48 is the @xmath0-particle density function ) . in order to obtain a practical model ,",
    "a common approach is to truncate this hierarchy at a certain level to obtain a closed system . in particular ,",
    "closure approximations in which the @xmath22-particle density function @xmath59 is replaced by an expression involving lower density functions @xmath60 , @xmath61 , are commonly used . however , because of their phenomenological nature , they can often lead to errors in the resulting model . in the next section we present three such closure approximations and highlight the issues they encounter when dealing with short - range repulsive potentials .",
    "in [ sec : soft_mae ] we present an alternative approach based on matched asymptotic expansions .",
    "the simplest and most common closure approximation is to assume that particles are not correlated at all in evaluating the interaction term @xmath62 , that is , @xmath63 substituting [ closure_approx ] into [ balltrue ] gives @xmath64 combining this with the equation for @xmath21 in [ sfp_int ] gives equation [ mean_field ] presented in the introduction , the mean - field approximation ( mfa ) .",
    "however , one should keep in mind that [ closure_approx ] might not always be valid when using such model .",
    "in particular , when @xmath33 is a short - range interaction potential , the dominant contribution to the integral [ balltrue ] is when @xmath54 is close to @xmath55 , and this is exactly the region in which the positions of particles are correlated .",
    "we note that the mean - field closure is often used implicitly with [ mean_field ] written down directly rather than being derived from [ sfp_eq ] @xcite .",
    "the reasoning goes as follows : if @xmath11 is the probability of finding a particle at @xmath65 , the force on a particle at @xmath54 is given by multiplying the force due to another particle at @xmath55 by the density of particles at @xmath55 and integrating over all positions @xmath55 .",
    "if we suppose the pair potential is short - ranged , we can approximate the integral in [ bcclosed ] to remove of the convolution term .",
    "in particular , we suppose that @xmath66 for some @xmath67 as @xmath68 and rewrite the potential as @xmath69 with @xmath34 . introducing the change of variable @xmath70 and expanding @xmath71 about @xmath54 gives @xmath72    \\nabla_{\\tilde { \\bf x } } \\ ,   \\tilde u ( \\| \\tilde { \\bf x } \\| ) \\ ,    { \\mathrm{d}}\\tilde { \\bf x } + \\cdots,\\end{aligned}\\ ] ] where we can extend the integral with respect to variable @xmath73 to the whole space since the potential @xmath74 is localized near the origin and decays at infinity . noting that the potential is a radial function , the leading - order term in the integral vanishes , and , after integrating by parts in the next term , we obtain @xmath75 inserting [ bcfinal ] into [ sfp_int ] , we find that the marginal density function satisfies the following nonlinear fokker ",
    "planck equation    [ sfpnfinal_close ] @xmath76 { \\nabla}_{{\\bf   x}_1 }   p -   { \\bf   f}({\\bf   x}_1 ) p \\right \\},\\end{aligned}\\ ] ] where the nonlinear coefficient is given by @xmath77    we will refer to , in which the mean - field closure has been combined with the assumption of a short - range potential , as the localized mfa or lmfa .",
    "as we shall see later , the mfa or lmfa are not defined for many commonly used short - range repulsive potentials . if the integral in [ alphav_close ] does not exist because of the behavior at infinity then this is an indication that the potentials is too long range for the localization performed above to be valid and the full mfa integral needs to be retained . however ,",
    "if the integral in [ alphav_close ] diverges because of the behavior at the origin then the mfa itself will diverge , that is , the integral in [ bcclosed ] will not exist .",
    "examples of the inappropriate use of mfa for such short range potentials exist in the literature @xcite .",
    "a more elaborated closure is suggested by felderhof @xcite .",
    "his derivation considers a more general context of interacting brownian particles suspended in a fluid , including hydrodynamic interactions .",
    "his analysis is valid for zero external force , @xmath78 , and is based on the thermodynamic limit ( in which the number of particles @xmath0 and the system volume @xmath79 tend to infinity , with the number density @xmath17 fixed ) .",
    "because of this , instead of working with probability densities , it is convenient to switch to number densities : @xmath80 and @xmath81 . in what follows we outline his derivation for hard spheres ignoring hydrodynamic interactions .",
    "the equation for the one - particle number density @xmath82 is @xmath83 where @xmath84 is the interparticle distance and @xmath85 ( the two - particle number density ) satisfies , to lowest order in @xmath86 , @xmath87 + \\nabla_{{\\bf   x}_2 }   \\cdot \\left [ \\nabla_{{\\bf   x}_2 } \\ ,   q + q \\nabla_{{\\bf   x}_2 } u(r ) \\right].\\ ] ] equations [ felde1 ] and [ felde2 ] have the following time - independent equilibrium solutions @xmath88 where @xmath86 is constant and @xmath89 is the pair correlation function @xmath90 felderhof then looks for a linearized solution around the equilibrium values [ felde_ss ] , by making the ansatz @xmath91 and considering the deviations @xmath92 and @xmath93 , @xmath94 then , to terms linear in @xmath92 and @xmath93 , [ felde_ansatz ] becomes @xmath95 substituting in [ felde1 ] and linearizing gives @xmath96.\\end{gathered}\\ ] ] at this stage , felderhof supposes that perturbations from equilibrium [ felde_ss ] are small so that @xmath97 and the pair correlation function is at its equilibrium value , that is , @xmath98 .",
    "then [ felde3 ] simplifies to @xmath99.\\end{aligned}\\ ] ] now , using [ felde_corr ] and expanding @xmath100 about @xmath54 and keeping only the first non - vanishing term gives @xcite @xmath101,\\end{aligned}\\ ] ] where @xmath102 note that this is the evolution equation for the perturbation @xmath92 from the uniform equilibrium @xmath86 ( valid with @xmath103 ) .      as we will see later in the results section",
    ", the mfa can only provide an adequate approximation for relatively soft interaction potentials and low densities .",
    "an alternative closure approximation is based on the kirkwood superposition approximation ( ksa ) @xcite , and consists of truncating the hierarchy at the two - particle density function . to this end",
    ", we consider the equation satisfied by @xmath104 by integrating the @xmath0-particle fokker ",
    "planck equation [ sfp_eq ] over @xmath105 , applying the divergence theorem and relabelling particles as before to obtain @xmath106   \\\\",
    "+    \\nabla_{{\\bf   x}_2 } \\cdot \\left [ \\nabla_{{\\bf x}_2 }    p_2 -   { \\bf   f}({\\bf   x}_2 )   p_2 + \\nabla _ { { { \\bf x}}_2 } u ( \\| { { \\bf x}}_1 - { { \\bf x}}_2 \\| ) p_2 +   { \\bf g}_2({{\\bf x}}_2 , { { \\bf x}}_1 , t )   \\right ] , \\end{gathered}\\ ] ] where @xmath107 and @xmath108 is the three - particle density function . we note that in writing [ g2 ] we are using that @xmath57 is invariant to particle relabelling .",
    "the ksa then approximates the three - particle density function as @xmath109 where @xmath21 and @xmath56 are the one- and two - particle density functions , respectively . inserting [ kirkwood ] into [ g2 ] one",
    "can then solve the coupled system [ sfp_int ] and [ p2eqhier ] for @xmath21 and @xmath56 .",
    "the ksa closure has been the basis of many subsequent closure approximations , and it can be derived as the maximum entropy closure in the thermodynamic limit @xcite . because it is thought to be superior to the mfa at high densities , it has been used in several biological applications such as on - lattice birth - death - movement processes with size - exclusion @xcite and off - lattice cell motility processes with soft interactions @xcite .",
    "middleton , fleck and grima @xcite consider a system of brownian particles evolving according to [ ssde ] in one dimension interacting via a morse potential ( see [ pair_mo ] ) and compare the ksa closure to the mfa closure and simulations of the stochastic system .",
    "markham et al .",
    "@xcite use the ksa on a more general individual - based model , where the random jumps of particles are not gaussian but depend on the positions of all particles , resulting in multiplicative noise .",
    "berlyand , jabin and potomkin @xcite use a variant of the ksa closure , approximating either @xmath110 or @xmath111 in [ kirkwood ] by their corresponding mean - field approximation @xmath112 , for a system of interacting deterministic particles .",
    "it is worth noting that the ksa model is computationally expensive and complicated to solve , especially if the interaction potential @xmath1 is short ranged , requiring a fine discretization .",
    "for example , in 3 dimensions one must solve a 6-dimensional problem which , once discretized , involves a full discretization matrix because of the convolution terms @xmath51 and @xmath113 . as we shall see in [ sec : numerics ] , even in one physical dimensional the ksa model is rather complicated to solve .",
    "in this section we consider an approach based on matched asymptotic expansions ( mae ) to obtain a closed equation for the one - particle density @xmath21 that is valid for short - range interaction potentials , and that is computationally practical to solve even in two or three dimensions .",
    "we go back to the evolution equation [ sfp_int ] for the one - particle density @xmath21 . assuming that the pair potential @xmath1 is localized near @xmath54 , we can determine @xmath62 in [ balltrue ] using mae . to do so",
    ", we first must obtain an expression for @xmath56 .    for low - concentration solutions with short - range interactions ,",
    "three - particle ( and higher ) interactions are negligible compared to two - particle interactions : when two particles are close to each other , the probability of a third particle being nearby is so small that it can be ignored .",
    "mathematically , this means that the two - particle probability density @xmath114 is governed by the dynamics of particles 1 and 2 only , independently of the remaining @xmath115 particles . in other words , the terms @xmath113 in [ p2eqhier ]",
    "are negligible and the equation for @xmath56 reduces to @xmath116   \\\\",
    "+    \\nabla_{{\\bf   x}_2 } \\cdot \\left [ \\nabla_{{\\bf x}_2 }    p_2 -   { \\bf   f}({\\bf   x}_2 )   p_2 + \\nabla _ { { { \\bf x}}_2 } u ( \\| { { \\bf x}}_1 - { { \\bf x}}_2 \\| ) p_2    \\right ] , \\end{gathered}\\ ] ] for @xmath117 , complemented with periodic boundary conditions on @xmath118 . this equation is basically [ felde2 ] with an added external force . essentially our mfa approach aims to solve [ felde1,felde2 ] systematically asymptotically rather than through felderhof s linearization and approximations .",
    "by assumption , the pair interaction potential @xmath33 is negligible everywhere except when the interparticle distance @xmath119 is of order @xmath26 .",
    "therefore , we suppose that when two particles are far apart ( @xmath120 ) they are independent , whereas when they are close to each other ( @xmath121 ) they are correlated .",
    "we designate these two regions of configuration space the outer region and inner region , respectively .    in the outer region",
    "we define @xmath122 . by independence",
    ", we have that for some function @xmath123 but the normalization condition on @xmath48 implies @xmath124 . ] @xmath125 for some function @xmath126 .    in the inner region , we set @xmath127 and @xmath128 and define @xmath129 and @xmath130 . rewriting [ sfp2_eq ] in terms of the inner coordinates gives @xmath131 + \\epsilon   { \\nabla } _ { \\tilde { \\bf x } } \\cdot \\left\\ { \\left [ { \\bf   f}(\\tilde { \\bf x}_1 ) -   { \\bf    f}(\\tilde { \\bf x}_1 + \\epsilon \\tilde { \\bf x } ) \\right ] \\tilde p \\right \\}\\\\ -   \\epsilon   \\nabla_{\\tilde { { \\bf   x}}_1 }   \\cdot   \\left [ 2 \\nabla_{\\tilde { \\bf   x } }   \\tilde p + \\nabla_{\\tilde { \\bf   x } }   \\tilde u (   \\| \\tilde { \\bf   x } \\| ) \\tilde p   \\right ] + \\epsilon^2 \\nabla_{\\tilde { \\bf x}_1}^2 \\ , \\tilde p - \\epsilon ^2   { { \\boldsymbol{\\nabla } } } _ { \\tilde { \\bf x}_1 } \\cdot \\left [ { \\bf   f}(\\tilde { \\bf x}_1 )   \\tilde p \\right ] . \\end{gathered}\\ ] ] the inner solution @xmath132 must match with the outer solution @xmath133 as @xmath134 .",
    "expanding @xmath133 in terms of the inner variables gives ( omitting the time variable for ease of notation ) @xmath135    we look for a solution of [ sfp3_eq ] matching with [ 4:bc_match ] as @xmath136 of the form @xmath137 .",
    "the leading - order inner problem is @xmath138 ,   \\qquad \\tilde p^{(0 ) } \\sim p^2 ( \\tilde { { \\boldsymbol{\\mathrm x}}}_1 ) \\quad \\textrm{as } \\quad \\|\\tilde { { \\boldsymbol{\\mathrm x}}}\\|\\to \\infty,\\end{aligned}\\ ] ] with solution @xmath139    the @xmath140 problem reads    [ stwo_order1 ] @xmath141   -     \\nabla_{\\tilde { { \\bf   x}}_1 }   \\cdot   \\left [ 2 \\nabla_{\\tilde { \\bf   x } }   \\tilde p^{(0 ) } + \\nabla_{\\tilde { \\bf   x } }   \\tilde u ( \\| \\tilde { \\bf   x } \\| ) \\tilde p^{(0 ) }   \\right ] ,   \\\\ \\label{stwo_order1_bc1 } \\tilde p^{(1 ) } & \\sim   p(\\tilde {    { \\bf   x}}_1 ) \\ , \\tilde { \\bf x } \\cdot \\nabla _ { \\tilde    { \\bf x}_1 } p ( \\tilde { \\bf x}_1 ) + p_\\text{o}^{(1)}(\\tilde { \\bf   x}_1 , \\tilde { \\bf x}_1 )   \\qquad \\textrm{as } \\qquad \\|\\tilde { { \\boldsymbol{\\mathrm x}}}\\|\\sim \\infty.\\end{aligned}\\ ] ]    using [ stwo_order0_sol ] , we can rearrange [ stwo_order1_eq ] to give @xmath142",
    "= 0.\\ ] ] solving [ stwo_order1_eqb ] together with [ stwo_order1_bc1 ] gives @xmath143 e^{-\\tilde u ( \\| \\tilde { \\bf x } \\|)}.\\ ] ] thus we find that the inner region solution is , to @xmath140 , @xmath144 e^{-\\tilde u ( \\| \\tilde { \\bf x } \\|)}.\\end{aligned}\\ ] ]      now we go back to the interaction integral @xmath145 in [ balltrue ] .",
    "because of the short - range nature of the potential @xmath1 , the main contribution to this integral is from the inner region .",
    "therefore , we will use the inner solution [ s_innersol ] to evaluate it .",
    "first we split the integration volume @xmath44 for @xmath55 into the inner and the outer regions defined in the previous section .",
    "although there is no sharp boundary between the inner and outer regions , it is convenient to introduce an intermediate radius @xmath146 , with @xmath147 , which divides the two regions",
    ". then the inner region is @xmath148 and the outer region is the complimentary set @xmath149 .",
    "the dominant contribution to [ balltrue ] is then @xmath150 the first and third terms of the integral vanish using the divergence theorem and that @xmath74 is a radial function of @xmath151 .",
    "integration by parts on the second component gives @xmath152    \\nabla_{\\tilde { \\bf x } }    e^{-\\tilde u ( \\| \\tilde { \\bf x } \\| ) } \\ , { \\mathrm{d}}\\tilde { \\bf x}\\\\   \\sim \\nabla _ {   { \\bf x}_1 } p ( { \\bf x}_1,t)\\ !   \\bigg [ \\tfrac{2(d-1)\\pi}{d } \\left ( \\tfrac{\\delta}{\\epsilon } \\right)^d - \\int_{\\| \\tilde { \\bf x } \\| <   \\delta/\\epsilon }    e^{-\\tilde u",
    "( \\| \\tilde { \\bf x } \\| ) } \\ , { \\mathrm{d}}\\tilde { \\bf x}\\bigg ] , \\end{gathered}\\ ] ] where we have used that @xmath153 at @xmath154 . finally , rewriting the first term above as a volume integral ,- dimensional sphere of radius @xmath155 is equal to . ]",
    "[ svecb ] becomes @xmath156 since @xmath157 decays at infinity , we can extend the domain of integration to the entire @xmath158 introducing only lower order errors .",
    "therefore we can write @xmath159 with @xmath160 note that we obtain the same coefficient @xmath28 that appeared in equation [ felde5 ] using the closure at the pair correlation function .      combining [ bmae ] with [ sfp_int ] we find that , to @xmath161 ,    [ sfpnfinal ] @xmath162 { \\nabla}_{{\\bf   x}_1 }   p -   { \\bf   f}({\\bf   x}_1 ) p \\right \\},\\end{aligned}\\ ] ] where @xmath163    therefore , we find that the mae method yields the same type of equation as the lmfa ( see [ sfpnfinal_close ] ) , but with a different coefficient in the nonlinear diffusion term .",
    "expanding the exponential in [ alphav ] for small @xmath1 gives @xmath164 that is , the lmfa closure is the leading contribution of the potential , provided that @xmath165 is small .",
    "however , as we will see in [ sec : results ] , this is not always true .",
    "we also see that the equation obtained by felderhof @xcite , [ felde5 ] is the linearized version of [ sfpnfinal_eq ] after taking @xmath166 and setting the external force to zero .",
    "the coefficient @xmath28 can be related to basic concepts from statistical mechanics .",
    "namely , the integrand in [ alphav ] is the negative of the _ total correlation function _",
    "@xmath167 , where @xmath168 $ ] is the low - density limit of the pair correlation function , the so - called boltzmann factor of the pair potential @xcite .      in contract",
    "to the mfa , using maes we have obtained an approximation of the two - particle density function @xmath169 in two regions of the configuration space , the outer and the inner regions , defined according to the separation between the two particles .",
    "it is convenient to have a uniformly valid expansion in the whole space  so that for example we can plot and compare it against simulations of the stochastic particle system .",
    "this can be done by constructing a so - called composite expansion , consisting of the inner expansion [ s_innersol ] plus the outer expansion [ sindep ] minus the common part ( * ? ? ?",
    "* chapter 5 ) .",
    "the result is @xmath170",
    "so far we have assumed that the set of brownian particles interact via a soft pair potential @xmath33 .",
    "however , the resulting reduced fokker  planck equation [ sfpnfinal ] obtained via mae can be used to model a system of hard - core interacting particles of diameter @xmath26 . in particular",
    ", the model [ sfpnfinal ] for soft spheres has exactly the same structure as the counterpart model for hard spheres derived in @xcite . inserting the hard - sphere pair potential @xmath171 into the nonlinear diffusion coefficient in [ alphav ] gives @xmath172 that is , @xmath173 for @xmath174 , @xmath175 for @xmath176 , and @xmath177 for @xmath178 .",
    "this is in agreement with our previous work where the reduced model was specifically derived for a system of hard spheres @xcite . for hard spheres the configuration space has holes due to the illegal configurations ( associated with infinite energy ) and",
    "the derivation is slightly different .",
    "we note that the mfa for hard spheres does not work and that , in particular , the coefficient @xmath179 in [ alphav_close ] is not defined .    because the mae models for soft and hard spheres coincide , for every potential @xmath1 we can find an effective hard - sphere diameter @xmath180 such that the continuum models of both systems  the soft - sphere system with pair potential @xmath33 and the hard - sphere system with diameter @xmath180  are equivalent .",
    "in other words , a characterization of a given soft potential @xmath1 is to find @xmath180 such that @xmath181 where @xmath28 is given in [ alphav ] and @xmath182 given in [ salphahs ] .",
    "rearranging , we find that @xmath183    this idea of finding the effective hard - sphere diameter associated to a soft - sphere system , known as the effective hard sphere diameter method , has been widely used to calculate both equilibrium and transport properties @xcite .",
    "the reason this method is appealing is that it allows us to `` translate '' a general system of interacting soft spheres ( whose properties may have not been studied before ) to the widely studied hard - sphere system , on which most theories are based .",
    "moreover , the derived model [ sfpnfinal ] implies that , as far as the population - level dynamics are concerned , soft interactions may be incorporated into the effective hard particle model by adjusting the hard - sphere diameter with [ epeff ] .",
    "this is provided @xmath28 in [ alphav ] is well - defined and positive .",
    "in contrast , if @xmath28 does not exist ( or is negative ) , the mae approach breaks down ( or may become unstable ) for the given pair potential @xmath1 .",
    "even this is instructive : it means that the potential is not decaying at infinity fast enough to be incorporated into a population - level equation of the form [ sfpnfinal_eq ] and that the mfa is preferrable .",
    "another application of the effective hard - sphere diameter is to provide an effective volume fraction for the system of soft spheres : using @xmath180 , one can define the effective volume fraction of soft spheres and use it to check whether the `` low - volume fraction '' condition holds .",
    "[ soft_potentials ] the simplest repulsive pair potential is the soft - sphere ( ss ) potential , which assumes the form @xmath184 where @xmath26 is a measure of the range of the interaction and @xmath185 is the softness parameter which characterizes the particles .",
    "we note that for @xmath186 , the ss potential corresponds to the coulomb interaction ( @xmath186 ) ( * ? ? ?",
    "* chapter 9 ) .",
    "other common purely repulsive potentials include the exponential ( ex ) potential ( * ? ? ?",
    "* chapter 7 ) @xmath187 and the repulsive yukawa ( yu ) potential @xmath188 this potential , also known as screened coulomb , is used to describe elementary particles , small charged `` dust '' grains observed in plasma environments , and suspensions of charge - stabilized colloids @xcite .    to model some physical systems it is convenient to incorporate an attractive part to the repulsive pair potential .",
    "the most common situation is that particles repel each other in the short range and attract each other in a longer range .",
    "for example , the ss potential in [ pairpotentialss ] may be generalized to power - law repulsive  attractive potentials of the form @xmath189 , with @xmath190 and @xmath191 , known as the mie potentials .",
    "the most famous example of this class of potentials is the lennard ",
    "jones potential , @xmath192 another common repulsive  attractive potential is the morse ( mo ) potential @xmath193 where @xmath194 and @xmath195 are , respectively , the relative strength and relative lengthscale of the repulsion to attraction . the most relevant situations for biological applications are given for @xmath196 and @xmath197 , which correspond to short - range repulsion and weak long - range attraction @xcite .",
    "[ fig : potentials_soft ] shows examples of all the interaction potentials above .",
    "[ ] [ ] [ ] @xmath198 [ ] [ ] [ ] [ 0]@xmath33 [ ] [ ] [ ] @xmath199 , [ pairpotentialhs ] [ ] [ ] [ ] @xmath200 , [ pairpotentialss ] [ ] [ ] [ ] @xmath201 , [ pairpotentialex ] [ ] [ ] [ ] @xmath202 , [ pairpotentialyu ] [ ] [ ] [ ] @xmath203 , [ pair_lj ] [ ] [ ] [ ] @xmath204 , [ pair_mo ]    a simple way to compare between approaches for short - range interaction potentials is to consider the nonlinear diffusion term using either mae or lmfa .",
    "their respective coefficients @xmath28 in [ alphav ] and @xmath205 in [ alphav_close ] for the potentials above are shown in [ table : comparison ] .",
    "we see that the lmfa coefficient @xmath205 is not defined for some potentials , that is , the lmfa closure fails .",
    "this is because the strongly repulsive short - range part of the potential results in correlations which violate the mfa that particles may be considered independent . moreover ,",
    "there are considerable discrepancies between @xmath28 and @xmath205 for the cases for which the latter is defined .",
    ".values of the nonlinear diffusion coefficient obtained via matched asymptotics or via closure for various types of interaction potential in 2 or 3 dimensions .",
    "[ cols=\"<,^,^,^,^,^,^ \" , ]     the coefficient @xmath205 is undefined for inverse - power potentials such as ss and lj , since the integral in [ alphav_close ] is either singular at the origin or at infinity for all possible powers . on the other hand",
    ", @xmath28 exists for potential ss in [ pairpotentialss ] for @xmath206 .",
    "therefore , we find that mae is not valid for the coulomb interaction [ @xmath207 in [ pairpotentialss ] ] .",
    "the interpretation is that the coulomb interaction does not decay sufficiently quickly at infinity and hence the inner region spans the whole configuration space ( so there is no outer region where the integral @xmath208 is negligible as assumed in the mae derivation ) .",
    "[ fig : alpha_vs_soft ] shows the variation of @xmath209 against the softness parameter @xmath185 .",
    "as expected , @xmath210 since the hs potential is the limiting case of the ss potential for @xmath211 .",
    "also note that the strength of the nonlinear diffusion term , parametrized by @xmath209 , decreases as the softness of the potential @xmath212 decreases .",
    "the effect of the softness parameter @xmath185 on the diffusion and other transport coefficients was studied in @xcite ; they found that for @xmath213 the soft sphere system behaved essentially as a hard sphere system in molecular - dynamics simulations .",
    "we find that the relative error between @xmath209 and @xmath214 for @xmath215 in three dimensions is 2.6% .",
    "[ ] [ ] [ ] @xmath185 [ ] [ ] [ ] @xmath216 [ ] [ ] [ ] @xmath217 [ ] [ ] [ ] @xmath218   given by [ alphav ] for the ss potential [ pairpotentialss ] , versus the softness parameter @xmath185 . (",
    "a ) two dimensions .",
    "( b ) three dimensions .",
    "the dash lines show the corresponding @xmath214 , equal to @xmath219 for @xmath176 and @xmath220 for @xmath178.,title=\"fig : \" ]    the morse potential [ pair_mo ] has well - defined coefficients @xmath221 and @xmath222 for @xmath194 and @xmath195 positive . however , they differ substantially depending on the relative strength @xmath194 and relative lengthscale @xmath195 of the repulsion to the attraction , see [ fig : alpha_morse ] .",
    "we note that both coefficients @xmath221 and @xmath222 may be negative for some parameter values , which implies , from [ sfpnfinal_eq ] , that the nonlinear component of the diffusion coefficient becomes negative .",
    "when this occurs , the system enters a so - called catastrophic regime and the particles collapse to a point as @xmath223 @xcite .",
    "[ ] [ ] [ ] @xmath194 [ ] [ ] [ ] @xmath195 [ b][][]@xmath217 [ b][][]@xmath218   ( solid lines ) and @xmath222 ( dash lines ) versus @xmath194 for 4 values of @xmath195 , @xmath224 ( arrow indicating the direction of increasing @xmath195 ) . (",
    "a ) two dimensions .",
    "( b ) three dimensions .",
    "the system is said to be in a catastrophic regime when @xmath225.,title=\"fig : \" ]   ( solid lines ) and @xmath222 ( dash lines ) versus @xmath194 for 4 values of @xmath195 , @xmath224 ( arrow indicating the direction of increasing @xmath195 ) .",
    "( a ) two dimensions .",
    "( b ) three dimensions .",
    "the system is said to be in a catastrophic regime when @xmath225.,title=\"fig : \" ]    evaluation of @xmath28 and @xmath205 provides a straightforward way to determine the type of dynamics the interacting particle system has .",
    "initially it is not so easy to discern whether the potential is `` short - range enough '' and , as a result , which method is more suitable to obtain a reduced population - level model .",
    "the nonlinear diffusion coefficient [ sfpnfinal_eq ] , @xmath226 , gives an idea of the strength of the interaction and whether the mae will be the appropriate method ( in particular , one can compute the effective volume fraction as described in [ sec : softhard_pot ] and ascertain whether the low - volume fraction assumption holds ) .",
    "regarding the mfa closure , one should keep in mind that @xmath205 not being defined does not necessarily mean that standard mfa fails , as mentioned in [ sec : soft_fp ] ; it could be that the short - range assumption used to obtain the nonlinear diffusion equation [ sfpnfinal_close ] does not hold and that , instead , one should keep the original mfa integro - differential model [ mean_field ] .",
    "conversely , if @xmath205 is not defined due to the singular behavior of the potential at the origin ( which is the case for all those seen in [ table : comparison ] ) , this is an indication that the convolution in the original mfa will not exist .      in this section",
    "we compare the macroscopic models obtained via the closures mfa and ksa , and via the mae method we have introduced to each other as well as to numerical simulations of the stochastic particle system .",
    "we use the open - source c`++ ` library aboria @xcite to perform the particle - level simulations . the overdamped langevin equation [ ssde ]",
    "is integrated using the euler - maruyama method and a constant timestep @xmath227 , leading to an explicit update step for each particle given by @xmath228 where @xmath229 is a @xmath9-dimensional normally distributed random variable with zero mean and unit variance .",
    "we choose the timestep @xmath227 so that the results are converged ( that is , there is no change in the results for smaller timesteps ) .",
    "for all simulations in this paper a timestep of @xmath230 was sufficient for convergence , leading to an average diffusion step size of @xmath231 .",
    "a naive implementation of the particle force interaction term over all particle pairs would lead to a large number ( @xmath232 ) of potential pair interactions to perform . to improve the efficiency of the code ,",
    "we take advantage of the compact nature of the potentials and restrict particle interaction to those pairs that are within a certain cutoff length @xmath233 .",
    "all particle pairs @xmath234 separated by a distance greater than this cutoff will implicitly be given a pair potential of @xmath235 .    in order to compare the particle - level models with the pde models , we perform @xmath236 independent realizations and output the positions of all @xmath237 particles at a set of output time points .",
    "a histogram of the positions is calculated and then scaled to produce a discretized density function that can be compared with the pde models .",
    "to generate the two - particle density function , we create a two - dimensional histogram of the positions of each particle pair @xmath238 and scale it accordingly to produce a two - particle density .",
    "first , we consider a one - dimensional problem in @xmath239 $ ] with periodic boundary conditions .",
    "we compare estimates of the one - particle density @xmath240 as well as the two - particle density @xmath241 obtained from simulating [ eq : particle ] to solutions of the same quantities using the ksa , mfa or mae models .",
    "we start with a set of parameters in which the potential is sufficiently long range that the system is not really in the low - density limit with the number of particles we use , and then consider an example with a strongly repulsive short - ranged potential .",
    "in all the examples we set the external drift to zero .",
    "we begin by presenting the models for the three approaches for @xmath174 .",
    "the mfa reads , combining [ sfp_int ] and [ bcclosed ] , @xmath242,\\ ] ] where @xmath243 unless explicitly written and @xmath244 .",
    "to solve [ mfa ] we use a second - order accurate finite - difference approximation with @xmath245 grid points in space and the method of lines in time with the inbuilt matlab ode solver ` ode15s ` . to evaluate the integral in [ mfa ] , we use the periodic trapezoid rule ( which converges exponentially fast for smooth integrands ( * ? ? ?",
    "* chapter 12 ) ) .",
    "to avoid evaluating the interaction potential at zero , we shift the grid for @xmath246 by @xmath247 , where @xmath248 is the grid spacing .",
    "the density @xmath249 is approximated from @xmath240 using @xmath250 . because of the convolution term , the discretization matrix of [ mfa ] is full , making the numerical solution of the mfa computationally expensive .",
    "an alternative would be to use a nonuniform mesh with more points near the diagonal or an adaptive grid scheme such as that presented by carrillo and moll @xcite , which uses a transport map between the uniform density and the unknown density @xmath21 such that more grid points are placed where the density is higher .",
    "the ksa closure model is the coupled system for @xmath240 and @xmath241 , given by    [ ksa ] @xmath251,\\ ] ] @xmath252    \\\\    & +   \\frac{\\partial}{\\partial x_2 }   \\ ! \\bigg [ \\frac{\\partial p_2}{\\partial x_2 }    +   f_u(x_2 , x_1 ) p_2   \\\\ & \\hspace{2 cm }   +   ( n-2 ) \\tfrac { p_2 ( x_1,x_2,t ) } { p ( x_1,t ) p ( x_2,t ) } \\ ! \\int_\\omega   \\tfrac { p_2 ( x_1,x_3,t ) p_2 ( x_2,x_3,t ) } { p ( x_3,t ) }   f_u(x_2 , x_3 )   \\ , { \\mathrm{d}}x_3    \\bigg ] ,   \\end{aligned}\\end{aligned}\\ ] ]    where @xmath243 and @xmath253 unless explicitly written .",
    "we solve in the computational spatial domain @xmath254 and therefore the ksa model requires a two - dimensional grid with full matrices , making it very computationally expensive . as with the mfa , we shift the grid for @xmath246 by @xmath247 to avoid any issues with @xmath255 when the interaction potential @xmath1 is singular at the origin . in the first integral of [ ksa_p ] , the coordinate @xmath256 is evaluated on the same grid as @xmath246 , and in the second integral it is evaluated on the same grid as @xmath257 .",
    "an alternative implementation of the ksa system is to solve for @xmath56 only and evaluate the one - particle density as @xmath258 ( replacing [ ksa_p ] ) @xcite .",
    "while this is true in the infinite bbgky hierarchy , we note that once the ksa closure [ kirkwood ] is adopted , the resulting model is not necessarily equal to the ksa system [ ksa ] .    finally , the reduced model from the mae method reads @xmath259 \\frac{\\partial p } { \\partial x_1 } \\right\\ } , \\ ] ] where @xmath260 . noting that the right - hand side in [ mae ] can be written as @xmath261_{x x}$ ] , the numerical implementation is straightforward and , since the discretization matrix is banded , very efficient .    in the first example",
    ", we use the exponential potential @xmath201 [ pairpotentialex ] with @xmath262 in a system in @xmath263 particles .",
    "the particles are initially distributed according to @xmath264 $ ] , with @xmath265 and @xmath266 , and we let them diffuse until time @xmath267 . the evolution in time of the one - particle density obtained with the various methods",
    "is shown in [ fig:1dcase1 ] .",
    "we observe very good agreement between the stochastic simulations and the mfa and ksa models , whereas the mae model slightly underestimates the diffusion strength .",
    "this can be explained since , for the chosen values of @xmath26 and @xmath0 , the potential is not short - ranged and the assumptions of the mae model break down . in particular , using [ epeff ] we find that the effective hard - sphere radius is @xmath268 and hence the effective volume fraction is 0.64 .",
    "similarly , the solution obtained via the lmfa ( shown at @xmath269 in [ fig:1dcase1](b ) ) differs noticeably to the mfa solution .",
    "[ ] [ ] [ ] ( a ) [ ] [ ] [ ] ( b ) [ ] [ ] [ ] @xmath257 [ ] [ ] [ ] @xmath6 [ r][][][-90]@xmath21   at times ( a ) @xmath270 and ( b ) @xmath271 with @xmath267 , interaction potential @xmath272 , @xmath262 , and @xmath273 . the initial data is @xmath274 $ ] , with @xmath265 and @xmath266 and we use periodic boundary conditions .",
    "solution of the ksa model [ ksa ] , the mae model [ mae ] , the mfa model [ mfa ] and histogram computed from @xmath275 realizations of the particle - level simulation [ eq : particle ] . in ( b ) we also plot the lmfa model [ sfpnfinal_close ] .",
    "we use @xmath276 grid points in each direction to solve the ksa , mae and mfa models.,title=\"fig : \" ]    at times ( a ) @xmath270 and ( b ) @xmath271 with @xmath267 , interaction potential @xmath272 , @xmath262 , and @xmath273 .",
    "the initial data is @xmath274 $ ] , with @xmath265 and @xmath266 and we use periodic boundary conditions .",
    "solution of the ksa model [ ksa ] , the mae model [ mae ] , the mfa model [ mfa ] and histogram computed from @xmath275 realizations of the particle - level simulation [ eq : particle ] . in ( b ) we also plot the lmfa model [ sfpnfinal_close ] .",
    "we use @xmath276 grid points in each direction to solve the ksa , mae and mfa models.,title=\"fig : \" ]    shows the corresponding two - particle density function at the final time @xmath269 . for the ksa ,",
    "@xmath56 is solved for as discussed above .",
    "for the mfa and mae models , @xmath56 is given by [ closure_approx ] and [ mae_p2 ] respectively .",
    "as before , @xmath246 is shifted by half the grid size and @xmath249 is approximated from @xmath240 using the centered average .",
    "the correlation between particles can be seen by the drop in probability at the diagonal @xmath277 in the simulations as well as in the ksa and mae plots .",
    "conversely , the mfa misses the correlation between particles , as expected from the ansatz @xmath278 .",
    "the differences in @xmath56 between the models can be clearly seen in [ fig : case12centrelines](a ) , which shows a plot of @xmath279 along @xmath280 .     at time @xmath267 for the parameters in [ fig:1dcase1 ] .",
    "the initial data is @xmath281 .",
    "the plots mfae and lmfae use the approximation @xmath282 , where @xmath21 is computed with the mfa or lmfa model , respectively . ]",
    "next we consider an example using a more repulsive interaction potential .",
    "in particular , we consider a smoothed version of the yukawa potential [ pairpotentialyu ] , namely @xmath283 with @xmath284 and @xmath285 .",
    "we choose to smooth the potential so that particles can still swap positions and so that we can use the closure models ksa and mfa ( in one dimension the singularity at zero poses problems in the convolution terms , see [ table : comparison ] ) .",
    "we run a simulation with @xmath286 particles up to time @xmath267 . for these parameters ,",
    "the effective hard - sphere radius is @xmath287 and the effective volume fraction is 0.18 .",
    "thus we expect the mae model to perform better than in the previous example where the potential was not short range .",
    "the one - particle density plots are shown in [ fig:1dcase2 ] , and the results for the two - particle density function are shown in [ fig:2dcase2 ] .",
    "we see that the mfa closure solution diffuses substantially faster than the ksa closure solution , whereas the mae model spreads slightly slower than the ksa one ( [ fig:1dcase2 ] ) .",
    "the particle - level simulations match the ksa solution closely over all times .",
    "the two - particle density functions for the particle simulation , the ksa and the mae solution are indistinguishable at time @xmath267 , whereas the mfa misses the drop in probability for closely spaced particles , as expected due to its assumption of no particle correlations ( [ fig:2dcase2,fig : case12centrelines](b ) ) .",
    "[ ] [ ] [ ] ( a ) [ ] [ ] [ ] ( b ) [ ] [ ] [ ] @xmath257 [ ] [ ] [ ] @xmath6 [ r][][][-90]@xmath21   at times ( a ) @xmath270 and ( b ) @xmath288 with @xmath267 , interaction potential @xmath289 , @xmath284 , @xmath285 , and @xmath290 .",
    "the initial data is @xmath274 $ ] , with @xmath265 and @xmath266 and we use periodic boundary conditions .",
    "solution of the ksa model [ ksa ] , the mae model [ mae ] , the mfa model [ mfa ] and histogram computed from @xmath275 realizations of the particle - level simulation [ eq : particle ] . in ( b ) we also plot the lmfa model [ sfpnfinal_close ] .",
    "we use @xmath276 grid points in each direction to solve the ksa , the mfa and the mae models .",
    ", title=\"fig : \" ]    at times ( a ) @xmath270 and ( b ) @xmath288 with @xmath267 , interaction potential @xmath289 , @xmath284 , @xmath285 , and @xmath290 .",
    "the initial data is @xmath274 $ ] , with @xmath265 and @xmath266 and we use periodic boundary conditions .",
    "solution of the ksa model [ ksa ] , the mae model [ mae ] , the mfa model [ mfa ] and histogram computed from @xmath275 realizations of the particle - level simulation [ eq : particle ] . in ( b ) we also plot the lmfa model [ sfpnfinal_close ] .",
    "we use @xmath276 grid points in each direction to solve the ksa , the mfa and the mae models .",
    ", title=\"fig : \" ]     at time @xmath267 for the parameters in [ fig:1dcase2 ] .",
    "the initial data is @xmath281 .",
    "the plots mfae and lmfae use the approximation @xmath282 , where @xmath21 is computed with the mfa or lmfa model , respectively . ]",
    "[ ] [ ] [ ] ( a ) [ ] [ ] [ ] ( b ) [ ] [ ] [ ] @xmath257 [ ] [ ] [ ] @xmath6 [ r][][][-90]@xmath56   along the line @xmath280 at time @xmath267 corresponding to the two - dimensional plots shown in ( a ) [ fig:2dcase1 ] and ( b ) [ fig:2dcase2 ] . , title=\"fig : \" ]   along the line @xmath280 at time @xmath267 corresponding to the two - dimensional plots shown in ( a ) [ fig:2dcase1 ] and",
    "( b ) [ fig:2dcase2 ] . , title=\"fig : \" ]    generally , we see that mae is good for strongly repulsive interactions ( such as in the example in [ fig:1dcase2,fig:2dcase2 ] ) while mfa is better for softer or longer - range interactions ( [ fig:1dcase1,fig:2dcase1 ] ) .",
    "the ksa provides a good approximation in all cases .",
    "when the two - particle density is required in a system with long - range interactions , our results may one lead to think that one should use the ksa , since the mfa does not capture the correlation in @xmath56 .",
    "however , we suggest that a slight modification in the mfa can provide a good approximation to @xmath56 also . specifically , one could still use the standard mfa closure @xmath278 to compute the one - particle density , but then use @xmath282 as an approximation of the two - particle density .",
    "this modification of @xmath56 , using either the mfa or the lmfa to compute @xmath21 , is shown as mfae and lmfae respectively in [ fig:2dcase1,fig:2dcase2,fig : case12centrelines ] .",
    "we see that mfae provides a better approximation of @xmath56 than mfa and lmfae in the first example with longer - range interactions ( [ fig : case12centrelines](a ) ) , whereas in the second example ( with strong repulsion ) the three approximations mfa , mfae , and lfmae are poor ( [ fig : case12centrelines](b ) ) .    finally , we consider a two - dimensional example in @xmath291 ^2 $ ] .",
    "we choose a system of @xmath292 yukawa - interacting particles , with interaction potential @xmath202 [ pairpotentialyu ] and @xmath284 , initially distributed according to a normal distribution in @xmath293 with mean @xmath294 and standard deviation @xmath295 .",
    "the effective hard - sphere radius is @xmath296 , giving an effective volume fraction of 0.04 .",
    "being in two dimensions , solving the ksa model would require solving a system of @xmath297 equations , where @xmath245 is the number of grid points in one direction .",
    "because of the short - range nature of the pair potential @xmath202 , we require a large number of points @xmath245 to resolve the interaction near the origin . as a result , solving the ksa model for this system becomes computationally impractical , and we compare the mfa and the mae methods only .",
    "we also solve the interaction - free model ( @xmath298 ) for reference .",
    "we plot the comparison at times @xmath299 and @xmath269 in [ fig : final_yu1d ] . we observe a very good agreement between the stochastic simulations of the particle system and the mae model , whereas the mfa model overestimates the diffusion strength . because of the short - range nature of the potential",
    ", we find no noticeable difference between the solution of the mfa and the localized version lmfa [ sfpnfinal_close ] , which is computationally much easier to solve ( the two curves would lie on top of each other in [ fig : final_yu1d ] , the norm of the relative error is of order @xmath300 ) . as expected , the interaction - free case spreads the slowest of all models since the nonlinear diffusion term is set to zero .",
    "[ ] [ ] [ ] @xmath257 [ ] [ ] [ ] ( a ) [ ] [ ] [ ] ( b ) [ r][][][-90]@xmath21 [ ] [ ] [ ] p1 [ ] [ ] [ ] p2 [ ] [ ] [ ] c [ ] [ ] [ ] @xmath298 [ ] [ ] [ ] p1 [ ] [ ] [ ] p2   at @xmath301 at times @xmath302 ( left ) and @xmath303 ( right ) with interaction potential @xmath304 , @xmath305 , and @xmath306 .",
    "we use 1d - normally distributed initial data ( @xmath307 and @xmath295 ) and periodic boundary conditions .",
    "solution of the mae model [ sfpnfinal ] , the mfa model [ mean_field ] , the interaction - free model ( setting @xmath298 in [ sfpnfinal ] ) , and histogram computed from @xmath308 realizations ( averaged over the @xmath309-dimension ) of the particle - level model [ eq : particle ] .",
    "we use @xmath276 grid points in each direction to solve the mfa and mae models.,title=\"fig : \" ]   at @xmath301 at times @xmath302 ( left ) and @xmath303 ( right ) with interaction potential @xmath304 , @xmath305 , and @xmath306 .",
    "we use 1d - normally distributed initial data ( @xmath307 and @xmath295 ) and periodic boundary conditions .",
    "solution of the mae model [ sfpnfinal ] , the mfa model [ mean_field ] , the interaction - free model ( setting @xmath298 in [ sfpnfinal ] ) , and histogram computed from @xmath308 realizations ( averaged over the @xmath309-dimension ) of the particle - level model [ eq : particle ] .",
    "we use @xmath276 grid points in each direction to solve the mfa and mae models.,title=\"fig : \" ]",
    "we have studied a system of brownian particles interacting via a short - range repulsive potential @xmath1 , and have discussed several ways to obtain a population - level model for the one - particle density . in particular , we have considered two common closure approximations and presented an alternative method based on matched asymptotic expansions ( mae ) .",
    "the mae method has the advantage that it is systematic and works well for very short - ranged potentials , especially singular potentials for which common closure approximations can lead to ill - posed models .",
    "the mae result is a nonlinear diffusion equation similar to our previous work for hard - spheres @xcite , with the coefficient of the nonlinear term @xmath28 depending on the potential through ( [ alphav ] ) .",
    "we have performed monte carlo simulations of the stochastic particle system in one and two dimensions , and compared the results with the solution of the mae model and two common closure approximations : the mean - field approximation ( mfa ) and the kirkwood superposition approximation ( ksa ) .",
    "while mfa closes the system at the level of the one - particle density @xmath21 , the ksa closes it at the level of the two - particle density @xmath56 .",
    "we have tested the models in examples with long- and short - range interactions .",
    "we found that the ksa agreed well with the stochastic simulations in both scenarios , but we could only use it in the one - dimensional examples due to its high computational cost .",
    "this is because the discretisation of the convolution term yields a full matrix , making the method impractical to use in two or three dimensions , especially for strongly repulsive potentials that require a very fine mesh in the region where two particles are in close proximity .",
    "this is also true , but to a lesser extent , for the mfa model , which captured well the behavior of the system with a long - range potential but was outperformed by mae in examples with a short - range potential .",
    "the mae method results in a nonlinear diffusion model ( which is thus local , with banded discretization matrix ) for @xmath21 , making it straightforward to solve .",
    "recently @xcite argued in favour of the ksa because it gave the two - particle density as well as the one - particle density , and could therefore capture correlations in particle positions , which the mfa can not .",
    "our mae method also gives an approximation for @xmath56 , and it successfully captures the low likelihood of finding particles close to each other when there are strong short - range repulsions .",
    "we emphasize again that it does so at a fraction of the cost of ksa , so that the mae method becomes particularly suited for problems in two or three dimensions where the ksa or similar higher - order closures are impractical .",
    "we noted also that the mfa can be extended simply ( to what we called mfae ) to produce an approximation for @xmath56 , so that it too becomes a viable alternative if the interactions are longer range .",
    "stochastic simulations of system of repulsive soft spheres are generally regarded as simpler than the simulation of hard spheres since one avoids the issue of how to approximate the collision between two particles . instead",
    ", soft sphere simulations involve summing up the contribution to the interaction force of all the neighbors at each time - step and adding it as a drift term to the brownian motion .",
    "however , for very repulsive potentials this needs to be done very carefully , since if the time - step is not small enough the repulsive part of the potential is not resolved correctly and easily missed .",
    "if this happened , the low - density diagonal in the two - particle density plots ( see for example [ fig:2dcase2 ] ) would either not be well resolved or not be there at all .",
    "it is therefore important to do a proper convergence study for the stochastic simulations in order to decide on the appropriate time - step .",
    "we note in this respect that our coefficient @xmath28 provides a natural way to determine the radius of the equivalent hard - sphere for any short range potential .",
    "we have seen that the mae method works well for repulsive short - range potentials , while the mfa provides a good approximation for long - range interactions .",
    "a natural question is to ask what to do for potentials with both characteristics , namely those which are very singular at the origin but with fat tails at infinity .",
    "this work provides a possible route to deal with such potentials : to combine the mae and mfa methods .",
    "specifically , one could break the potential into two parts and deal with each of them separately .",
    "the result would be an equation of the type [ mean_field ] with the nonlocal convolution term due to the long - range component of the potential , and a nonlinear diffusion due to the short - range component .",
    ", _ particle , kinetic , and hydrodynamic models of swarming _ , in mathematical modeling of collective behavior in socio - economic and life sciences , g.  naldi , l.  pareschi , and g.  toscani , eds . , birkhuser basel , 2010 , pp",
    ".  297336 ."
  ],
  "abstract_text": [
    "<S> a system of interacting brownian particles subject to short - range repulsive potentials is considered . </S>",
    "<S> a continuum description in the form of a nonlinear diffusion equation is derived systematically in the dilute limit using the method of matched asymptotic expansions . </S>",
    "<S> numerical simulations are performed to compare the results of the model with those of the commonly used mean - field and kirkwood - superposition approximations , as well as with monte carlo simulation of the stochastic particle system , for various interaction potentials . </S>",
    "<S> our approach works best for very repulsive short - range potentials , while the mean - field approximation is suitable for long - range interactions . </S>",
    "<S> the kirkwood superposition approximation provides an accurate description for both short- and long - range potentials , but is considerably more computationally intensive .    </S>",
    "<S> diffusion , soft spheres , closure approximations , particle systems , matched asymptotic expansions    35b27 , 35q84 , 60j70 , 82c31 </S>"
  ]
}