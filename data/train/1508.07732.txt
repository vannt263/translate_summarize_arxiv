{
  "article_text": [
    "hierarchical organisation is an ubiquitous feature of a large variety of systems studied in natural- and social sciences .",
    "examples of empirical studies on hierarchy are including the transcriptional regulatory network of escherichia coli @xcite , the dominant - subordinate hierarchy among crayfish @xcite , the leader - follower network of pigeon flocks @xcite , the rhesus macaque kingdoms @xcite , neural networks @xcite and technological networks @xcite , social interactions @xcite , urban planning @xcite , ecological systems @xcite , and evolution @xcite .",
    "naturally , hierarchy is a very relevant concept also in network theory @xcite .",
    "the network approach has become an ubiquitous tool for analysing complex systems ranging from the interactions within cells through transportation systems , the internet and other technological networks to economic networks , collaboration networks and the society @xcite .",
    "grasping the signs of hierarchy in networks is a non - trivial task with a number of possible different approaches . on the one hand , we may try the statistical inference of an underlying hierarchy based on the observed network structure , as suggested in ref.@xcite . on the other hand , the introduction of a hierarchy measure is also a natural idea @xcite . in general , a hierarchy measure , can be viewed as a function on the domain of graphs , @xmath0 , mapping a graph @xmath1 into a real number , @xmath2 .",
    "the value of the measure is actually @xmath3 $ ] or @xmath4 $ ] in most cases , with high values corresponding to hierarchical structures and low values indicating the absence of hierarchy in the examined network .",
    "one of the first methods was proposed by d.  krackhardt , motivated by organisational hierarchy , defining the hierarchy measure simply as the number of ordered pairs divided by the number of connected pairs @xcite . in the approach introduced by a.  trusina et al . , the position of the nodes in the hierarchy is assumed to be given by the degree , and the hierarchy measure is given by the fraction of directed shortest paths going strictly upwards in the hierarchy @xcite .",
    "another way for quantifying the possible asymmetry between nodes is to assume some sort of flow on the links , and examine whether the global map of flows in the system is revealing a kind of overall directionality or not .",
    "probably the simplest approach in this framework is to define the fraction of links not participating in any cycle as the measure of the hierarchy , as suggested by j. luo and c.  l.  magee @xcite .",
    "a further important property of a hierarchical system is that reaching the rest of the network should be relatively easy for the nodes high in the hierarchy , and more difficult for the nodes at the bottom of the hierarchy , as pointed out by e.  mones et al .  in ref.@xcite .",
    "the hierarchy measure based on this aspect is given by the global reaching centrality , characterising the inhomogeneity of the fraction of reachable nodes in at most @xmath5-steps in the network @xcite .",
    "a more elaborate quantification of hierarchy was proposed by b. corominas - murta et al .  in ref.@xcite with the introduction of treeness , feedforwardness and orderability , projecting the studied network onto a point in a 3 dimensional space , where each dimension is aimed to capture a different aspect of hierarchy .",
    "treeness , @xmath6 , is measuring how ambiguous are the chain of commands in the network , while feedforwardness , @xmath7 is related to the size and position of the strongly connected components in the network . finally , the orderability , @xmath8 is simply the fraction of nodes not taking part in any directed cycles , i.e. , it is analogous to the hierarchy measure introduced by j. luo and c.  l.  magee .",
    "the 3d scatter plots of @xmath6 , @xmath7 and @xmath8 provided very interesting results , revealing different clusters of hierarchical networks @xcite . a more detailed description and comparison between the mentioned methods",
    "is given in the supplementary information s1 .",
    "although the methods listed above allow the examination of the hierarchical organisation from different perspectives , a noteworthy common aspect of these approaches that they all treat acyclic networks as already maximally hierarchical , independent of the further details of the graph structure .",
    "( the global reaching centrality given in ref.@xcite is an exception , considering the star configuration as the most hierarchical ) .",
    "here we argue that different acyclic networks are not necessarily equally hierarchical . the general intuition of a hierarchy is usually corresponding to a multi level pyramidal structure , with levels becoming wider and wider as we descend from the root towards the bottom .",
    "on the one hand this way the top nodes in the hierarchy can reach most of the network in a very effective way , i.e. , via paths of average length scaling as @xmath9 , where @xmath10 denotes the number of nodes . on the other hand , in this structure all",
    "nodes can have a treatable number of direct subordinates .",
    "in contrast , if we consider a directed chain , all the levels are of size one , and this is leading to a large average distance scaling as @xmath10 . the other extreme limiting case of acyclic networks",
    "is given by the directed star configuration , where all the nodes have a single incoming link from a central hub , and no further out - links .",
    "in this case the hierarchy is consisting of only two levels , and the supposed leader in the network has to cope with a number of direct descendants scaling as @xmath10 .",
    "based on that , introducing a hierarchy measure preferring trees to chains and stars would be a substantial step towards achieving a more intuitive approach for evaluating the importance of hierarchy in a network structure .    in this paper",
    "we tackle this problem with the help of random walks on the network .",
    "random walks provide a fundamental model for stochastic processes in a large variety of systems ranging from physics @xcite , chemistry @xcite and computer science @xcite through biology and ecology @xcite to economics @xcite and psychology @xcite . in the current problem of quantifying the extent of hierarchy in a network structure ,",
    "random walkers can be used to evaluate the rank of the nodes in the hierarchy .",
    "the basic idea is assuming an information flow on the links from nodes high in the hierarchy towards the lower levels , in a similar fashion as in case of a company , where the management is likely to send information and instructions to the employees on a regular basis . given the network structure , the source of information in the system can be traced back by sending random walkers traversing the links in reverse direction from all nodes . in case",
    "the density of the random walkers is reaching a steady state , its value at a given node can be interpreted as the probability that the node was the source of information .",
    "consequently , high random walker density values indicate a high standing in the hierarchy , whereas low density values are corresponding to bottom nodes . the significance of hierarchical organisation in the network structure can be judged based on the inhomogeneity of the distribution : in a homogeneous distribution we can not pinpoint the source of information , thus ,",
    "it is corresponding to a non - hierarchical network .",
    "in contrast , a very inhomogeneous distribution is indicating a strongly hierarchical structure .",
    "the details of the random walk process are the following .",
    "since the random walkers are traversing the links backwards , the transition probability for a walker from node @xmath11 to @xmath12 is proportional to the inverse of the in - degree of @xmath11 , i.e. , @xmath13 .",
    "another important factor to be taken into account is the limited capacity of the information sources for sending information : in general we can assume that the more out - neighbours a given node has , the less resource it can allocate for managing the communication over a given link .",
    "this effect can be taken into account by assuming that @xmath14 is also proportional to the out - degree of @xmath12 , i.e. , @xmath15.combining the above factors together is resulting in @xmath16 for the transition probability of the random walkers from node @xmath11 to @xmath12 .",
    "( in case @xmath12 is not an in - neighbour of @xmath11 the transition probability @xmath14 is zero by definition ) .",
    "we note that due to the second factor on the right hand side of ( [ eq : trans_k ] ) , the probability for staying at the same node can be non - zero in general , given by @xmath17 . for weighted networks ( [ eq : trans_k ] ) can be naturally generalised to @xmath18 where @xmath19 denotes the weight of the link from @xmath12 to @xmath11 .    in case of acyclic networks ,",
    "all random walkers eventually converge into nodes with no incoming links , ( i.e. , the `` sources '' in the network ) . in order to avoid judging the importance of hierarchical organisation in the system solely based on these `` sources '' ,",
    "we inject new random walkers into the network at every time step .",
    "the update rules are the following :    * we insert @xmath20 random walkers into the system , increasing the random walker density on every node by @xmath21 , thus , the random walker density at node @xmath12 given by @xmath22 is changing as @xmath23 * we let all random walkers in the system proceed on step , governed by the transition probabilities given in ( [ eq : trans_k ] ) . by introducing a transition matrix @xmath24 with matrix elements @xmath25 , the density of random walkers on node @xmath12 after the transition can be expressed as @xmath26 * the total sum of random walkers has to be normalised , i.e. , we require @xmath27 . since the sum of new random walkers added to the system was @xmath20 , we have to simply divide the density of random walkers by @xmath28 in order to fulfil the normalisation condition , @xmath29    the above normalisation of the random walker density to unity after each iteration is equivalent to using `` decaying '' random walkers , having a weight decreasing by a factor of @xmath30 in each step .",
    "let us denote the characteristic distance under which the weight of a random walker is decreased to @xmath31 by @xmath32 , fulfilling @xmath33 based on that , @xmath20 can be also expressed as @xmath34 although @xmath32 , ( or equivalently , @xmath20 ) is a parameter of the method at the current stage , later on in the results we shall find a natural condition for fixing @xmath32 at an optimal value in general .",
    "our main object of interest is the stationary distribution of the random walkers in the network . by writing this distribution in a vector form of @xmath35 ,",
    "where the @xmath12-th component of the vector , @xmath36 , is corresponding to the random walker density on node @xmath12 , we can derive a simple equation based on the update rules .",
    "adding @xmath21 new random walkers at each node is simply incrementing each vector component by @xmath21 , while the transition to the next site by the random walkers corresponds to multiplying by the transition matrix @xmath24 . finally , the normalisation of the random walker density simply multiplies each vector component by @xmath37 .",
    "based on the above the stationary distribution fulfils @xmath38=e^{-1/\\lambda}\\left[\\mathbf{t}\\left(\\mathbf{p}^{\\rm stat}+\\frac{e^{1/\\lambda}-1}{n}\\mathbf{1}\\right)\\right ] , \\label{eq : p_stac_alap}\\ ] ] where @xmath39 is corresponding to a vector of size @xmath10 with all elements equal to 1 . by expressing @xmath35",
    "we obtain @xmath40^{-1}\\mathbf{t}\\mathbf{1}=\\frac{e^{1/\\lambda}-1}{n}\\left[e^{1/\\lambda}\\mathbf{i}-\\mathbf{t}\\right]^{-1}\\mathbf{t}\\mathbf{1 } , \\label{eq : p_stac}\\ ] ] where @xmath41 is denoting the identity matrix .",
    "since @xmath24 is a left stochastic matrix , the absolute value of its largest eigenvalue is 1 .",
    "consequently , the absolute value of the eigenvalues of @xmath42 are smaller than 1 , and therefore , ( [ eq : p_stac ] ) can also be written as @xmath43    this formula is very intuitive , showing explicitly that the stationary distribution of random walkers at a given node is given by the sum of the probabilities of all the paths ending on the node , where the contributions from longer paths are suppressed exponentially as a function of the path length .",
    "based on ( [ eq : p_stac]-[eq : q ] ) , @xmath35 can be computed very efficiently .",
    "if the size of the network is moderate , we can use ( [ eq : p_stac ] ) for obtaining exact results .",
    "however , if matrix inversion is becoming computationally expensive , a very good approximation of @xmath35 can be calculated according to ( [ eq : q ] ) .",
    "i.e. , by carrying out the summation up to a certain finite limit @xmath44 , the obtained result is converging to the exact @xmath35 exponentially fast .",
    "our hierarchy measure is based on the inhomogeneity of the stationary distribution of the random walkers .",
    "there are several different possibilities for quantifying the inhomogeneity of a probability distribution in general , here we choose the relative standard deviation , ( also called as the coefficient of variation ) .",
    "thus , the random walk hierarchy measure is defined as @xmath45 where @xmath46 and @xmath47 denote the mean and the standard deviation of @xmath36 respectively . since @xmath48 , the mean is given simply by @xmath49 , and our hierarchy measure can be expressed as @xmath50",
    "for demonstrating the sensitivity of our measure to the topology also in case of acyclic networks , first we evaluate @xmath51 for chains , regular trees with a constant branching number @xmath52 , and stars . according to calculations detailed in methods ,",
    "the corresponding hierarchy values can be expressed as @xmath53 where @xmath10 is the number of nodes in the networks , @xmath54 denotes the levels in case of the tree ( starting from @xmath55 at the root and ending with @xmath56 at the leafs ) , and @xmath57 is corresponding to the stationary distribution of the walkers on level @xmath54 in ( [ eq : rwh_tree_final ] ) , which can be obtained from a simple recursion written as @xmath58    in fig.[fig : chain_tree_star ] .",
    "we compare the hierarchy measures given in ( [ eq : rwh_chain_final]-[eq : rwh_star_final ] ) at @xmath59 ( fig.[fig : chain_tree_star]a ) and at @xmath60 ( fig.[fig : chain_tree_star]b ) .",
    "our construction algorithm for the trees with a branching number @xmath52 was to start by adding @xmath52 links to the root , then move to the second level and subsequently add @xmath52 links to every node on this level , and so on , move to the next level only when the given level was completed .",
    "whenever the number of nodes in the tree has reached @xmath10 , the algorithm terminates , and naturally , the resulting tree is not completely regular in most of the cases .",
    "nevertheless , the overall structure of the trees obtained in this way is getting closer and closer to regular trees as @xmath10 is increasing .     as a function of @xmath10 for a chain ( black ) , a regular tree with branching number @xmath61 ( red ) , a regular tree with @xmath62 ( green ) , a regular tree with @xmath63 ( blue ) and a star ( orange ) at @xmath59 .",
    "b ) the same plot as in a ) when @xmath32 is set to @xmath60.,scaledwidth=63.0% ]    according to fig.[fig : chain_tree_star ] .  the @xmath51 for the chain and the star configurations has a peak at very small system sizes , and shows a decreasing tendency for growing @xmath10 .",
    "in contrast , for regular trees @xmath51 seems more or less converging to a finite value .",
    "thus , above a certain @xmath10 it is the structure of the tree , ( encoded in the branching number ) , what determines the hierarchy measure , not the size of the tree .",
    "this is indicating that @xmath51 is behaving similarly to intensive quantities in physics in some aspects .",
    "the `` intensive '' property of the hierarchy measure is analysed in more details in the supplementary information s2 , here we note that if we take a pair of graphs @xmath64 and @xmath65 which are not connected to each other , then @xmath51 for the union of the graphs is equal to the weighted quadratic mean of the @xmath51 values calculated for the graphs separately , @xmath66 ^ 2+n_2\\left[h_{{\\mathcal g}_2}\\right]^2}{n_1+n_2}}.\\ ] ] thus , in the special case of a pair of isomorphic graphs @xmath67 .",
    "we continue with the examination of the behaviour of @xmath51 in the thermodynamic limit . according to calculations detailed in methods , when the system size is diverging , @xmath68 , the hierarchies given in ( [ eq : rwh_chain_final]-[eq : rwh_star_final ] ) take the form of @xmath69 thus , the hierarchy measure is vanishing for a chain and a star in the thermodynamic limit .",
    "in contrast , @xmath70 is converging to a well defined finite limit value or @xmath71 when @xmath32 is smaller than a @xmath52 dependent critical value , and is diverging otherwise . in the methods",
    "we show that the critical @xmath32 value is given by @xmath72^{-1}. \\label{eq : lambda_c}\\ ] ]     for infinitely large regular trees as a function of the branching number @xmath52 and the parameter @xmath32 .",
    "the formula for @xmath51 is given in ( [ eq : rwh_tree_inf ] ) .",
    "at @xmath73 we recover the infinitely large chain , while the infinitely large star is corresponding to the @xmath74 limit .",
    "the dashed line is showing the maximum place of @xmath51.,scaledwidth=70.0% ]    the behaviour of the limiting @xmath70 given in ( [ eq : rwh_tree_inf ] ) is shown in a 2d plot in fig.[fig : rwh_inf_trees ] .  as a function of @xmath52 and @xmath32 . at @xmath73",
    "the tree becomes equivalent to an infinitely large chain , and according to ( [ eq : chain_inf ] ) the @xmath51 becomes zero .",
    "the 2d surface displayed in fig.[fig : rwh_inf_trees ] .",
    "is consistent with this result , as it starts from @xmath75 at @xmath73 for all @xmath32 values .",
    "similarly , the @xmath51 for an infinitely large star is also zero according to ( [ eq : rwh_star_inf ] ) . the surface shown in fig.[fig : rwh_inf_trees ] .",
    "is consistent with this result as well , as we can see a decreasing tendency in @xmath51 as a function of @xmath52 in the large @xmath52 regime . in the range of intermediate branching numbers we can observe an @xmath32 dependent maximum in @xmath51 .",
    "this behaviour is examined in more details in the supplementary information s3 .",
    "based on the behaviour of @xmath51 in the thermodynamic limit , we can also fix the @xmath32 parameter at an optimal value in general as follows .",
    "since @xmath32 is corresponding to the characteristic path length a random walker can traverse before `` decaying '' , on the one hand we would like to choose a @xmath32 as high as possible .",
    "i.e. , if @xmath32 is small , the random walkers can explore only within a very limited range from their origin , thus , the information we can retrieve via the random walkers is also very local .",
    "however , due to its self similar nature , hierarchical organisation can manifest on all length scales , therefore , we need random walkers travelling longer distances in order to be able to tell apart hierarchical and non - hierarchical networks",
    ".    on the other hand , if @xmath32 is too large , we may run into diverging hierarchy values according to ( [ eq : rwh_tree_inf ] ) , which needs to be avoided in case of a well behaving hierarchy measure .",
    "therefore , we fix @xmath32 at a value as high as possible where a diverging @xmath51 is avoided for sure even in case of infinitely large regular trees .",
    "according to ( [ eq : lambda_c ] ) , the minimum of @xmath76 can be found at @xmath77 , where @xmath78 .",
    "since the path length traversed by a random walker is increasing by unity under every iteration , it is also natural to set @xmath32 to an integer value .",
    "based on the above , the optimal setting for @xmath32 is given by @xmath60 . in the rest of the paper we are assuming that @xmath32 is set to this optimal value , and thereby consider our approach a parameter free method for measuring the amount of hierarchical organisation in the structure of networks .",
    "since real world hierarchies are usually not as highly ordered as a regular tree with a constant branching number , we extended our comparison studies of acyclic graphs also to general directed trees . by applying a simple algorithm detailed in methods , we generated a large family of trees with branching numbers varying around a given average branching number @xmath79 according to a shifted poisson distribution .",
    "in fig.[fig : poisson_trees ] .",
    "we show the average of the random walk hierarchy measure , @xmath80 as a function of @xmath79 , calculated based on 100 realisations of trees consisting of @xmath81 nodes . according to the curve , the maximum of @xmath80 is at an intermediate average branching number , where the structure of the network is really tree like .",
    "i.e. , for low average branching numbers , ( where the structure is basically a chain ) , and also for very large branching numbers comparable to the system size , ( where the structure is close to a star ) , the obtained @xmath80 values are considerably lower .     as a function of the average branching number @xmath79 for general trees of @xmath81 nodes , averaged over @xmath82 instances .",
    "when @xmath79 is close to one , the tree is basically a chain , whereas at very large branching number , its structure is close to a star.,scaledwidth=60.0% ]        here we apply our method for analysing the hierarchy of the st .",
    "marks food web @xcite , representing a part of the ecosystem of goose creek bay , st .",
    "marks national wildlife refuge , florida , usa . the nodes of the network are corresponding to living compartments , ( group of species ) based on probable diet and life history characteristics .",
    "thus , compartments range from single species ( e.g. , pinfish ) through a couple of species ( e.g. , gulf flounder and needlefish ) to large groups of taxa , ( e.g. , bacterioplankton ) .",
    "the links between the nodes represent the feeding pathways , pointing from consumers to their food sources , where the link weights are corresponding to the fractions of the consumer s diet .    ) , and the hierarchy levels are corresponding to groups of nodes for which the standard deviation of @xmath83 is at most @xmath84 , where @xmath47 denotes the standard deviation of @xmath36 over the whole network .",
    "the colour coding of the nodes reflects their effective trophic level published in @xcite .",
    "b ) listing of the abbreviations used in a).,scaledwidth=95.0% ]    the static distribution of the random walkers on the network defined above can be calculated using ( [ eq : p_stac ] ) .",
    "however , @xmath83 is defining only a ranking between the nodes and does not provide the hierarchy levels in the first place .",
    "therefore , we sampled and aggregated nodes into levels so that in each level , the standard deviation of @xmath83 is lower than a pre - defined fraction of the standard deviation in the whole network .",
    "( this type of procedure for obtaining the hierarchy levels was established in @xcite ) .    in fig.[fig :",
    "st_marks ] .",
    "we show the resulting hierarchy between the compartments when the standard deviation of @xmath36 within the levels is at most @xmath85 .",
    "the hierarchy levels are consistent with the common sense about food webs as e.g. , benthic algae is on the lowest level , herbivorous ducks are somewhere in the middle , and raptors ( such as e.g. , the bald eagle ) are on the top of the hierarchy .",
    "the colour coding of the nodes is showing the effective trophic level of the compartments given in @xcite , ranging between 1.0 and 4.32 .",
    "apparently , the position of the nodes in the hierarchy and their colour are coherent in most of the cases , e.g. , the root has the highest effective trophic level , and the nodes with the lowest trophic level are at the bottom of the hierarchy .",
    "however , a small number of discrepancies can be also observed , ( e.g. , as in case of gulf flounder & needlefish ) , signing that the effective trophic levels and the random walk based hierarchy are catching slightly different aspects of the studied food web .",
    "finally , the spearman s rank correlation coefficient between the ranking of the compartments according to @xmath36 and the ranking according to the effective trophic levels is @xmath86 .",
    "in contrast , the spearman s rank correlation coefficient between the effective trophic levels and the hierarchy obtained after applying a degree preserving link randomisation to the network is only @xmath87 .",
    "based on the above , our hierarchy is highly consistent with former results from ecology .",
    "we also calculated the @xmath51 given in ( [ eq : rwh_final ] ) for numerous different systems ranging from metabolic and regulatory networks through citation , trust and language networks to the internet and the www .",
    "( a detailed description of the networks is given in the supplementary information s4 ) .",
    "in fig.[fig : scatter ] .  we show the obtained hierarchy values as a function of the network size , @xmath10 .",
    ".,scaledwidth=70.0% ]    according to the figure food webs , electric circuits and regulatory networks provide the largest @xmath51 values , and in contrast , the informal networks of acquaintances in different organisations seem the least hierarchical . in the mean time , the www , the internet , the citation- , metabolic- , trust- and language networks appear to be moderately hierarchical .",
    "however , under certain circumstances we may obtain a moderate hierarchy measure even in a random graph .",
    "e.g. , the structure of the giant component in the erds  rnyi graph @xcite is more or less tree - like if we are close to the percolation threshold , and tree - like structures are usually considered highly hierarchical .",
    "accordingly , in order to make a fair judgement on the importance of hierarchy in the topology of a real network , we need to compare the measured @xmath51 to the result we expect in a suitably chosen random network ensemble , modelling the structure of the given network under the assumption of random connections . in order to take into account of the degree distribution of the studied networks , we use the configuration model for evaluating the expected value of @xmath51 in the random network ensemble .",
    "a sample from this ensemble can be obtained by simply link randomising the given real network , keeping the degree of the nodes fixed under the random rewiring of the connections .",
    "the difference between @xmath51 obtained for the real networks and the expected value of @xmath51 in their random counterparts can be measured in terms of the @xmath88-score , defined as @xmath89 where @xmath80 and @xmath90 denote the expected value- and the standard deviation of @xmath51 in the random ensemble , respectively .",
    "thus , we basically scale the difference between the real @xmath51 and the average of @xmath51 over the random ensemble by the standard deviation of @xmath51 in the random ensemble .    in fig.[fig :",
    "z_score ] .",
    "we show the @xmath88-scores corresponding to the @xmath51 values displayed in fig.[fig : scatter ] . according to the results , the citation networks and the network between the web pages of the nd.edu domain",
    "achieve outstandingly high @xmath88-scores .",
    "furthermore , all of the food webs , the internet networks and also the rest of the www networks obtain considerably large positive @xmath88-scores .",
    "this means that the structure of these networks is far more hierarchical compared to a random network with the same degree distribution .",
    "in contrast , all of the regulatory- and metabolic networks have negative @xmath88-scores , ( with rather large absolute values in the latter case ) .",
    "thus , these networks are less hierarchical compared to what we would expect on a random base .",
    "-score of @xmath51 for the networks shown in fig.[fig : scatter ] .",
    "the @xmath88-score , given by @xmath91 is plotted as a function of the system size @xmath10 .",
    "the random null - model for evaluating @xmath80 and @xmath90 is corresponding to the configuration model.,scaledwidth=67.0% ]    finally , in case of the electric- , organisational- , and language networks we see a mixed picture , where both positive and negative @xmath88-scores occur .",
    "most of the organisational networks have positive @xmath88-scores , reaching to a quite high value in case consulting network , while in parallel we obtain a negative @xmath88-score for the enron network .",
    "the word adjacency network for the french , spanish and japanese languages have negative @xmath88-scores , opposed to a clearly positive @xmath88-score in case of the english language .",
    "a more detailed analysis of these results is provided in the supplementary information s4 .",
    "measuring the significance of hierarchical organisation in the structure of a complex network is a non - trivial problem with a number of different options available .",
    "here we have proposed a novel method based on random walks on the network .",
    "the basic idea behind our approach is that if nodes were sending instructions or information over the links to their subordinates , then the sources of the information could be traced using random walkers traversing the links backwards .",
    "the update rules of the dynamics are chosen in a way to make the density of the walkers on the nodes converge to a stationary distribution exponentially fast with the number of iterations .",
    "the position of the nodes in the hierarchy is determined by this distribution , with high random walker densities corresponding to top nodes , and low values of the distribution signalling bottom nodes .",
    "the overall measure of the hierarchy is given by the inhomogeneity of the stationary distribution .",
    "the calculation of the hierarchy measure can be carried out based on repeated multiplications of an @xmath10 by @xmath10 transition matrix , making the method computationally very efficient and opens up the possibility for gpu based parallelisation .",
    "the other main advantage of our approach is that it can differentiate between directed acyclic graphs of distinct nature , opposed to most other methods treating all directed acyclic networks as already maximally hierarchical .",
    "the random walk hierarchy measure provides higher scores for trees showing a multilevel pyramidal structure compared to chains and stars .",
    "this is consistent with a general intuitive picture about hierarchies : the multilevel pyramidal structure enables the leaders in the tip of the hierarchy to reach the rest of the system via relatively short paths , and also avoids the `` overloading '' of any nodes with a too large number of direct subordinates . in contrast",
    ", the distance between the top and the bottom becomes very large in a chain , while the number of direct subordinates for the central node is diverging with the system size in case of a star .",
    "a further interesting property of our measure is that it is behaving similarly to intensive quantities in physics .",
    "i.e. , for regular trees with a constant branching number the hierarchy measure is converging to a well defined value in the thermodynamic limit .",
    "thus , above a certain scale it is the structure , ( encoded in the branching number ) , what determines the hierarchy , not the size of the network .",
    "moreover , our tests on real world networks provided rather encouraging results . on the one hand , the detailed analysis of the st .",
    "marks food web resulted in hierarchy levels that are highly consistent with former results from ecology on the effective trophic levels in the system . on the other hand",
    ", the large scale analysis of numerous further real networks revealed that the value of the hierarchy measure on its own does not always provide a fair characterisation of the importance of hierarchy in the structure of the studied system . according to our results , in some cases",
    "a relatively low @xmath51 value can be accompanied by an outstandingly high @xmath88-score , when we compare the actual @xmath51 to the expected value of @xmath51 in a randomly rewired network with the same degree distribution .",
    "this leads to the conclusion that the basic network characteristics such as the link density , degree distribution , etc .",
    "can inflict some constrains on the possible range of @xmath51 and also on @xmath80 in the corresponding random network ensemble .",
    "however , the further analysis of these effects is out of the scope of the present paper and is providing interesting directions for further research .",
    "first we note that @xmath75 when the network is consisting of only a single directed cycle . since all the nodes are equivalent in this case , @xmath92 for all @xmath12 , thus , @xmath93 .",
    "now let us examine how does @xmath51 change if we move from a cycle to a chain by cutting a single link .",
    "since all the nodes have a unit in - degree except the first node , and all the nodes have a unit out - degree except the last node , the transition probability from level @xmath54 to level @xmath94 is unity .",
    "therefore , the stationary distribution on the last node is zero , @xmath95 , ( since the total amount of injected random walkers exit immediately , and there is no inflow of walkers from outside ) .",
    "based on ( [ eq : p_stac_alap ] ) , the stationary distribution of the walkers on the intermediate levels fulfils @xmath96 while in case of the first node the injected random walkers can not exit the node , resulting in @xmath97=e^{-1/\\lambda}\\left[p_2^{\\rm stat}+p_1^{\\rm stat}+2\\frac{e^{1/\\lambda}-1}{n}\\right ] % \\nonumber \\\\ % & & e^{-1/\\lambda}\\left[p_2^{\\rm stat}+p_1^{\\rm stat}+2\\frac{e^{1/\\lambda}-1}{n}\\right ] \\label{eq : chain_1}\\ ] ] by solving ( [ eq : chain]-[eq : chain_1 ] ) we gain @xmath98=\\frac{1-e^{-\\frac{n - l}{\\lambda}}}{n }   \\;\\;\\ ; ( 2\\leq l\\leq n ) , \\\\ p_1^{\\rm",
    "stat}&=&\\frac{p_2^{\\rm stat}}{f}+\\frac{2}{n}=\\frac{p_2^{\\rm stat}}{e^{1/\\lambda}-1}+\\frac{2}{n}.\\end{aligned}\\ ] ] by substituting into ( [ eq : rwh_final ] ) the result simplifies to ( [ eq : rwh_chain_final ] )",
    ".    the random walk hierarchy measure for general trees with varying branching number can not be given in a general formula , nevertheless it can be calculated exactly for any particular finite tree based on ( [ eq : p_stac ] ) and ( [ eq : rwh_final ] ) . however , in case of a regular tree with branching number @xmath52 , a simple recursion can be given for the stationary distribution of the random walkers , as the transition probability from any node to its `` leader '' in the level above is simply @xmath99 .",
    "the random walkers can not exit from the root , which we label as level @xmath55 , and there is an inflow of walkers from the second level , resulting in @xmath100= \\nonumber \\\\   & = & e^{-1/\\lambda}\\left[p_2^{\\rm stat}+p_1^{\\rm stat}+2\\frac{e^{1/\\lambda}-1}{n}\\right ] , \\label{eq : p_tree_1}\\end{aligned}\\ ] ] which is exactly the same as in case of the first node in the chain , given in ( [ eq : chain_1 ] ) . for the intermediate levels , we have an inflow of walkers from the level below , and also a term corresponding to the probability of the walkers staying at the given level instead of moving to the level above , yielding altogether @xmath101= \\nonumber \\\\ & & e^{-1/\\lambda}\\left[p_{l+1}^{\\rm stat}+\\frac{e^{1/\\lambda}-1}{n}+\\left(p_l^{\\rm stat}+\\frac{e^{1/\\lambda}-1}{n}\\right)\\left(1-\\frac{1}{b}\\right)\\right ] \\label{eq : p_tree_l_meth}\\end{aligned}\\ ] ] finally , on the last level @xmath102 we have no inflow from other nodes , giving @xmath103 which provides an immediate solution for @xmath104 in the form given in ( [ eq : p_tree_lmax ] ) . based on ( [ eq : p_tree_lmax ] )",
    "we can calculate the stationary distribution on the rest of the levels as well , i.e. , by rearranging ( [ eq : p_tree_1 ] ) and ( [ eq : p_tree_l_meth ] ) we gain ( [ eq : p_tree_l ] ) and ( [ eq : p_tree_first ] ) .    the hierarchy measure for the star can be evaluated in a similar fashion to that of the chain . in this case",
    "@xmath105 peripheral nodes are connected to a central node , from which the random walkers can not exit .",
    "thus , the stationary distribution of the random walkers fulfil @xmath106=\\nonumber \\\\ & & e^{-1/\\lambda}\\left[p_{\\rm c}^{\\rm stat}+p_{\\rm p}^{\\rm stat}+2\\frac{e^{1/\\lambda}-1}{n}\\right ] , \\label{eq : star_cent}\\\\ p_{\\rm p}^{\\rm stat}&=&\\frac{1}{1+f}\\left(p_{\\rm p}^{\\rm stat}+\\frac{f}{n}\\right)\\left(1-\\frac{1}{n-1}\\right)=\\nonumber \\\\ & & e^{-1/\\lambda}\\left(p_{\\rm p}^{\\rm stat}+\\frac{e^{1/\\lambda}-1}{n}\\right)\\left(1-\\frac{1}{n-1}\\right ) \\label{eq : star_peri}\\end{aligned}\\ ] ] where @xmath107 denotes the density on the central node , and @xmath108 is equal to the density on the peripheral nodes . from ( [ eq : star_peri ] )",
    "we can express @xmath108 directly as @xmath109 and by substituting ( [ eq : star_p_res ] ) into ( [ eq : star_cent ] ) we arrive to @xmath110 for the central node . according to ( [ eq : rwh_final ] ) , the random walk hierarchy measure can be given in this case as @xmath111 - 1}. \\label{eq : rwh_star_alap}\\ ] ] by substituting ( [ eq : star_p_res ] ) and ( [ eq : star_c_res ] ) into ( [ eq : rwh_star_alap ] ) , the resulting formula can be simplified to ( [ eq : rwh_star_final ] ) .",
    "taking the @xmath68 limit of @xmath112 given in ( [ eq : rwh_chain_final ] ) and of @xmath113 written in ( [ eq : rwh_star_final ] ) is trivial , the results are given in ( [ eq : chain_inf ] ) and in ( [ eq : rwh_star_inf ] ) respectively .",
    "in contrast , the evaluating the @xmath68 limit of @xmath70 given in ( [ eq : rwh_tree_final ] ) is more complicated and can be carried out as follows .",
    "first we separate the first term from the rest in the sum over the levels in ( [ eq : rwh_tree_final ] ) as @xmath114 in order to evaluate the remaining sum , we express @xmath57 given in ( [ eq : p_tree_l ] ) as @xmath115,\\ ] ] where @xmath116 based on the above , @xmath117 ^ 2=   \\nonumber \\\\   & & \\frac{1}{n}\\sum_{l=2}^{l_{\\rm max } } \\left[a^2 b^{l-1 } + 2 ab b^{l-1}c^{l_{\\rm max}-l+1 } + b^2 b^{l-1 } c^{2(l_{\\rm max}-l+1)}\\right]= \\nonumber \\\\   & & \\frac{1}{n}\\left\\{a^2\\left(\\frac{b^{l_{\\rm max}}-1}{b-1}-1\\right ) + 2 ab b^{l_{\\rm max}}\\left[\\frac{\\left(\\frac{c}{b}\\right)^{l_{\\rm max}-l+1}}{\\frac{c}{b}-1}-1\\right]+   \\right . \\nonumber \\\\ & & \\left .",
    "+ b^2 b^{l_{\\rm max}}\\left[\\frac{\\left(\\frac{c^2}{b}\\right)^{l_{\\rm max}-l+1}}{\\frac{c^2}{b}-1}-1\\right]\\right\\}. \\label{eq : sum_temp}\\end{aligned}\\ ] ] by using that @xmath118 if @xmath119 , ( [ eq : sum_temp ] ) can be also written as @xmath120 + \\nonumber \\\\ & & -\\frac{2ab}{c / b-1}\\left[n(b-1)+1\\right]-\\frac{b^2}{c^2/b-1}\\left[n(b-1)+1\\right]\\bigg\\}+   \\nonumber \\\\ & & + \\frac{b-1}{b^{l_{\\rm max}}}\\left\\{\\frac{2ab}{c / b-1}c^{l_{\\rm max}}+\\frac{b^2}{c^2/b-1}c^{2l_{\\rm max}}\\right\\}=\\nonumber \\\\ & & a^2-(2ab+b^2)(b-1)-\\frac{2ab}{c / b-1}(b-1)-\\frac{b^2}{c^2/b-1}(b-1)+\\nonumber \\\\ & & + \\mathcal{o}\\left(\\frac{1}{n}\\right)+(b-1)\\left[\\frac{2ab}{c / b-1}\\left(\\frac{c}{b}\\right)^{l_{\\rm max}}+\\frac{b^2}{c^2/b-1}\\left(\\frac{c^2}{b}\\right)^{l_{\\rm max}}\\right ] \\label{eq : sum_temp2}\\end{aligned}\\ ] ]    according to ( [ eq : letter_def ] ) @xmath121 however , the similar inequality of @xmath122 holds if and only @xmath123 or in terms of @xmath32 if and and only @xmath124^{-1}. \\label{eq : lam_cond}\\ ] ] thus , when ( [ eq : b_cond ] ) , or equivalently ( [ eq : lam_cond ] ) are fulfilled , the last two terms in ( [ eq : sum_temp2 ] ) vanish if @xmath125 .",
    "by using ( [ eq : letter_def ] ) and neglecting the @xmath126 terms we obtain @xmath127    now let us examine the @xmath128 term in ( [ eq : sum_sep ] ) . according to ( [ eq : p_tree_1 ] ) we can write @xmath129 where @xmath130 since @xmath131 and @xmath132 , @xmath133 and we obtain that @xmath134 as a consequence , @xmath135 , which is also vanishing when @xmath136 . hence , by substituting ( [ eq : sum_fin ] ) into ( [ eq : sum_sep ] ) and neglecting the @xmath126 terms we arrive to @xmath137 equivalent to the formula given in ( [ eq : rwh_tree_inf ] ) .",
    "we used the following algorithm for generating a tree with varying branching number between @xmath10 nodes :    1 .",
    "initially the nodes are ordered , however , they are also completely isolated from each other 2 .",
    "we iterate over the nodes according to their order . for current node @xmath12",
    "we draw a number @xmath138 from a poisson distribution with a fixed parameter @xmath139 , and assign the branching number @xmath140 to the node .",
    "( this way it is guaranteed that the branching number of @xmath12 is @xmath141 ) .",
    "we scan the nodes coming after @xmath12 and stop at the first node @xmath11 with no incoming link .",
    "we attach directed links pointing from @xmath12 to the nodes starting from @xmath11 and ending at @xmath142 .",
    "4 .   we repeat steps ( ii)-(iii ) until all nodes become connected to the tree .",
    "the advantage of this algorithm is that it enables the study of the swift transition from a chain through a family of trees with increasing average branching number to a star .",
    "i.e. , if we set the parameter of the poisson distribution to @xmath143 , we obtain @xmath144 for all nodes , thus , the resulting graph is actually a chain .",
    "however , if @xmath139 is large enough compared to @xmath10 , the branching number drawn for the first node is already larger than @xmath10 , thus , we obtain a star . for intermediate parameter values",
    "the average branching number of the tree is of course @xmath145 .",
    "however , the branching numbers of the individual nodes in the tree will deviate from this average in a similar manner to real systems .",
    "the authors are grateful to tams vicsek and enys mones for the fruitful discussions and help in the data collection .",
    "the research was partially supported by the european union and the european social fund through project futurict.hu ( grant no.:tamop-4.2.2.c-11/1/konv-2012 - 0013 ) and by the hungarian national science fund ( otka k105447 ) .",
    "the funders had no role in study design , data collection and analysis , decision to publish , or preparation of the manuscript .",
    "gp developed the concept of the study .",
    "dc and gp worked out the definition of the hierarchy measure , dc derived the behaviour in the thermodynamic limit .",
    "dc collected the network data and carried out its analysis .",
    "dc and gp prepared the figures and contributed to the result interpretation .",
    "gp drafted the manuscript .",
    "supplementary information accompanies this paper .",
    "+ the authors declare no competing financial interest .",
    "10 url # 1`#1`urlprefix[2]#2 [ 2][]#2    , & . _ _ * * , ( ) .    , & .",
    "_ _ * * , ( ) .    , , & .",
    "_ _ * * , ( ) .",
    "_ et  al . _ . _ _ * * , ( ) .    , , & . _",
    "_ * * , ( ) .    , & .",
    "_ _ * * , ( ) .    _",
    "_ , vol .   of _ _",
    "( , , ) .    , , , & .",
    "_ _ * * , ( ) .    , & .",
    "_ _ * * , ( ) .    & .",
    "_ _ * * , ( ) .    .",
    "_ _ * * , ( ) .    & _ _ ( , , ) .    & .",
    "_ _ * * , ( ) .    & .",
    "_ _ * * , ( ) .",
    "_ _ ( , , ) .    .",
    "_ _ * * , ( ) .",
    "_ _ * * , ( ) .    , & .",
    "_ _ * * , ( ) .    , , & .",
    "_ _ * * , ( ) .    & .",
    "_ _ * * , ( ) .    & _ _ ( , , ) .    . in & ( eds . )",
    "_ _ , ( , , ) .",
    "_ _ * * , ( ) .    & .",
    "_ _ * * , ( ) .    , & .",
    "_ _ * * , ( ) .    , , & .",
    "_ _ * * , ( ) .",
    "_ _ ( , , ) .",
    "_ _ ( , , ) , edn .",
    "_ _ ( , , ) .    & _ _ ( , , ) .    , & .",
    "_ _ * * , ( ) .",
    "_ _ ( , , ) .    .",
    "_ _ * * , ( ) .    & .",
    "_ _ * * , ( ) .    & .",
    "_ _ * * , ( ) .    .    , &",
    ". in _ _ , ( , ) .    , & .",
    "_ _ * * , ( ) .    . _ _ ( ) .    &",
    ". _ _ * * , ( ) .    , & .",
    "_ _ * * , ( ) .    , , , & .",
    "_ _ * * , ( ) .    , , , & _ _ ( , ) .",
    "( ) .    & _ _ ( , ) .    , , , & .",
    "_ _ * * , ( ) .",
    "_ et  al . _ . _",
    "_ * * , ( ) .    , , , &",
    "_ _ * * , ( ) .    , & .",
    "in _ _ , ( , ) .",
    "_ et  al . _ . _",
    "_ * * , ( ) .    , & . in _ _ , ( , ) .    & .",
    "_ _ * * , ( ) .    , , , & .",
    "_ _ * * , ( ) .    , & .",
    "_ _ * * , ( ) .    & .",
    "in _ _ , ( , ) .",
    "characterising the importance of hierarchy in a given network structure is a non - trivial problem with a large number of alternative approaches . without loss of generality",
    "we can formulate a few intuitive requirements a hierarchy measure should meet : first , we assume no a priori ordering between the nodes , the measure is evaluated purely based on the topology of the network",
    ". moreover , the hierarchy measure should should not be too sensitive to the local structure of the network , i.e. , the degree sequence alone should not provide enough information for complete evaluation of @xmath51 . in other words , we should be able to modify @xmath51 when rewiring the links in a network without changing the degree sequence .",
    "e.g. , let us suppose that the network is corresponding to a single directed cycle of @xmath10 nodes , ( a giant directed `` ring '' ) . since all the nodes are equivalent , the network lacks any hierarchy what so ever , thus , @xmath51 should be equal to 0 .",
    "however , if we take just a single link away , ( which is only a minor change if @xmath10 is large ) , the network becomes a directed chain , which is indeed hierarchical , thus , a significant jump should be observed in @xmath51 .",
    "one of the first hierarchy measure was proposed by d.  krackhardt , motivated by organisational hierarchy @xcite .",
    "the main assumption here is that in a hierarchical company we can reach the lower levels of the hierarchy from the levels above via chains of commands , and in contrast , we can not reach the higher levels in a similar fashion from the levels below .",
    "thus , on the one hand , we count the total number of ordered pairs @xmath146 in the network for which there is directed path either from @xmath12 to @xmath11 or from @xmath11 to @xmath12 , but not both . on the other hand , we also evaluate the total number of connected pairs , for which at least one directed path exists between the two nodes , ( but we also allow paths in both directions ) . by denoting the number of ordered pairs by @xmath147 , and the number of connected pairs by @xmath148 , krackhardt s hierarchy measure @xcite",
    "is simply given by @xmath149    based on the definition above , @xmath150 for all acyclic networks , where all the node pairs are ordered .",
    "nevertheless , @xmath151 is a fine example for a hierarchy measure depending mostly on the global structure of the network : for a directed cycle of @xmath10 nodes @xmath152 , ( since we can reach any node from any other node , and hence , every pair is unordered ) . by deleting a single link",
    "we turn the network into a directed chain , ( where all the pairs are ordered ) , and suddenly the hierarchy measure jumps to @xmath150 .",
    "an approach motivated by similar intuitions compared to krackhard s hierarchy was introduced by e.  mones et al . , assuming that reaching the rest of the network should be relatively easy for the nodes high in the hierarchy , and more difficult for the nodes at the bottom of the hierarchy @xcite . here",
    "the position of the node @xmath12 in the hierarchy is determined by its reaching centrality , @xmath153 , corresponding to the fraction of nodes that can be reached from @xmath12 , ( following directed paths ) .",
    "based on the @xmath154 associated to the individual nodes , the global reaching centrality of the whole network is defined as @xcite @xmath155}{n-1 } , \\label{eq : grc}\\ ] ] where the summation is running over the nodes , the size of the network is given by @xmath10 and the maximal reaching centrality is denoted by @xmath156 .",
    "the maximal possible value of this hierarchy measure is @xmath157 , which is obtained when the network is corresponding to a star with @xmath105 arms , with only the central node having a non zero reaching centrality .",
    "interestingly , for a chain of @xmath10 nodes , we obtain @xmath158 , which is still larger than @xmath159 .",
    "similarly to the previous measure , @xmath160 for a directed cycle .",
    "another way for quantifying the possible asymmetry between nodes is to assume some sort of flow on the links , and examine whether the global map of flows in the system is revealing a kind of overall directionality or not .",
    "probably the simplest approach in this framework is to define the fraction of links not participating in any cycle as the measure of the hierarchy .",
    "i.e. , the link flow hierarchy proposed by j. luo and c.  l.  magee can be formulated as @xcite @xmath161 where @xmath162 denotes the number of acyclic links , not part of any directed cycle , and @xmath163 is corresponding to the total number of links in the network .    similarly to krackhardt s hierarchy , the link flow hierarchy is @xmath164 for all acyclic networks .",
    "furthermore , when the network is corresponding to a single directed cycle , @xmath165 .",
    "thus , when deleting a link from this cycle , we observe a jump from zero hierarchy to maximal hierarchy .",
    "a more elaborate quantification of hierarchy was proposed by b. corominas - murta et al .",
    "@xcite with the introduction of treeness , feedforwardness and orderability , projecting the studied network onto a point in a 3 dimensional space , where each dimension is aimed to capture a different aspect of hierarchy .",
    "treeness , @xmath6 , is measuring how ambiguous are the chain of commands in the network .",
    "i.e. , in a regular tree where links are pointing from higher levers to lower levels we obtain @xmath166 , whereas if revert the link directions , the obtained structure is considered anti - hierarchical , with @xmath167 .",
    "the calculation of @xmath6 is based on comparing forward and backward entropies @xcite .    in the mean time feedforwardness",
    ", @xmath7 is related to the size and position of the strongly connected components in the network .",
    "since we can reach any node from any other node in a strongly connected component , we can not define an ordering amongst these nodes .",
    "furthermore , if the strongly connected component is found near the top of the overall hierarchy , its effect is more severe compared to a situation where it is occurring only at the deeper levels .    finally , the orderability , @xmath8 is simply the fraction of nodes not taking part in any directed cycles , @xmath168 where @xmath169 is the number of nodes that are not members in any directed cycles , and @xmath10 is the total number of nodes .",
    "thus , orderability is analogous to the link - flow hierarchy @xmath170 given in ( [ eq : linkflow ] ) , the only difference is that here we measure the weight of the cycles in the network by the number of contained nodes instead of the number of contained links .",
    "similarly to @xmath170 , the oredrability is @xmath171 for all acyclic networks , while @xmath172 when the network is corresponding to a single directed cycle .",
    "we have seen on fig.1 .  in the main paper that @xmath51 of finite regular trees is converging to the limit value for infinitely large trees already around @xmath81 when @xmath59 , while the convergence is somewhat slower when @xmath60 .",
    "nevertheless , above a certain @xmath10 it is the structure of the tree , ( encoded in the branching number ) , what determines the hierarchy measure , not the size of the tree .",
    "this indicates that @xmath51 is behaving similarly to intensive quantities in physics in some aspects .    to investigate this property further ,",
    "let us examine what happens to @xmath51 if we take a pair of disjoint graphs @xmath64 and @xmath173 , and unite them into a single graph @xmath174 with two isolated components . according to eq.(10 ) in the main paper , the hierarchy measure of the graphs when considered separately",
    "can be written as @xmath175 where @xmath36 and @xmath176 correspond to the stationary distribution of the random walkers on nodes @xmath177 and @xmath178 , while @xmath179 and @xmath180 denote the sizes of @xmath64 and @xmath173 respectively . when considering the union of the two graphs , the stationary distribution of the random walkers has to be normalised over the whole range of @xmath181 nodes .",
    "thus , the stationary distribution on node @xmath12 , originally in @xmath64 , now part of @xmath182 , can be given as @xmath183 .",
    "likewise , the stationary distribution on node @xmath11 , originally in @xmath173 , now part of @xmath182 , can be expressed as @xmath184 .",
    "therefore , the hierarchy measure of the union of the two graphs reads @xmath185 by rearranging ( [ eq : h_g_1]-[eq : h_g_2 ] ) we gain @xmath186 ^ 2 + 1}{n_1 } , \\label{eq : p_1_sqr}\\\\   \\sum_{i=1}^{n_1}(p_i^{\\rm stat})^2&=&\\frac{\\left[h_{{\\mathcal g}_1}\\right]^2 + 1}{n_2 } , \\label{eq : p_2_sqr}\\end{aligned}\\ ] ] and by substituting ( [ eq : p_1_sqr]-[eq : p_2_sqr ] ) into ( [ eq : h_g_u_mid ] ) we obtain @xmath66 ^ 2+n_2\\left[h_{{\\mathcal g}_1}\\right]^2}{n_1+n_2}}. \\label{eq : h_g_uni}\\ ] ]    thus , the hierarchy measure of the union of two isolated networks is simply the weighted quadratic mean of @xmath51 obtained for the individual graphs .",
    "a noteworthy consequence is that if @xmath187 , then this implies also that the hierarchy measure of the union is also the same , @xmath67 .",
    "furthermore , according to ( [ eq : h_g_uni ] ) in general , if we take the union of @xmath64 and @xmath173 which are isolated from each other and @xmath188 , then the hierarchy measure of the resulting network will be between the hierarchies measured for the two graphs separately , @xmath189 therefore , the rule for calculating @xmath51 for a system composed of isolated smaller parts based on @xmath51 obtained for these sub - systems is showing again a great deal of similarity to the behaviour of intensive physical quantities .",
    "according to our results in the main paper , when considering regular trees of infinitely large size , the hierarchy measure may either diverge or remain finite , depending on both the branching number @xmath52 and the value of the @xmath32 parameter . at a fixed @xmath52 , the critical @xmath190 separating the two regimes",
    "is given by eq.(23 ) in the main paper . here , in fig.[fig",
    ": h_phase_diag ] .",
    "we show @xmath191 as a function of @xmath52 on a semi - logarithmic plot , where the regime of diverging @xmath51 values is coloured grey .     in case of regular trees in the thermodynamic limit . if @xmath32 and @xmath52 are falling into the region shown in grey , ( meaning that @xmath32 is larger than @xmath190 calculated from eq.(23 ) in the main paper ) , then @xmath51 is diverging .",
    "in contrast , for parameter settings falling in the white region , @xmath51 remains finite in the thermodynamic limit .",
    "the maximal @xmath51 in this region is obtained at a @xmath192 , given in ( [ eq : lam_star ] ) .",
    "the dashed horizontal line is showing the minimum of @xmath190.,scaledwidth=60.0% ]    in the regime of finite @xmath51 , the limit value for the hierarchy measure is given by eq.(21 ) in the main paper .",
    "the maximum of this function can be located by solving @xmath193 based on that , at a fixed branching number @xmath52 , the @xmath32 parameter providing the maximal @xmath51 can be written as @xmath194^{-1 } , \\label{eq : lam_star}\\ ] ] while at a fixed @xmath32 parameter the tree with maximal hierarchy has a branching number of @xmath195 in fig.[fig : h_phase_diag ] .",
    "we also show @xmath196 given in ( [ eq : lam_star ] ) as a function of @xmath52 . in parallel ,",
    "the @xmath197 expressed in ( [ eq : b_star ] ) is plotted as a function of @xmath32 in fig.[fig : max_helyek ] .     for which @xmath51 is maximal , as a function of the parameter @xmath32 in case of infinitely large regular trees .",
    "the vertical line is corresponding to the minimum of @xmath190 given in eq.(23 ) in the main paper , thus , for @xmath32 values above that @xmath51 can become divergent in the thermodynamic limit.,scaledwidth=60.0% ]    according to picture , the maximum of @xmath51 is at @xmath198 when @xmath32 is low .",
    "however , @xmath197 is steadily increasing as a function of @xmath32 , reaching to @xmath199 at @xmath60 , chosen to be the optimal @xmath32 value based on arguments given in the main paper .",
    "we have analysed the hierarchy in a large number of networks of different types and varying sizes , the scatter plot of the obtained @xmath51 values and the @xmath88-score of @xmath51 are given in figs.5 - 6 .  in the main paper . in tables [ tab",
    ": results_real_prop]-[tab : results_real_rand ] .",
    "we provide the results in more details by listing also the size and the average degree beside the @xmath51 values and @xmath88-scores of the examined networks .",
    ".random walk hierarchy of real networks shown in fig.5 .  in the main paper .",
    "the network type is given in the 1@xmath200 column , the meaning of the links in the @xmath201 column , the references to the data sources are listed in the @xmath202 column . the network size is given in the 4@xmath203 column , followed by the average degree in the 5@xmath203 column .",
    "the hierarchy measure @xmath51 ( calculated at the optimal @xmath60 parameter value ) is provided in the 6@xmath203 column . [ cols=\"^,^,^,^,^,^\",options=\"header \" , ]     the peer to peer message networks over the internet and the metabolic networks , ( where the target of a link was corresponding to a product of the source ) showed moderate levels of hierarchy . for both types , the data points in fig.5 .  in the main paper formed tight clusters .",
    "the intra organisational networks were the least hierarchical according to our measure , with the data points forming a cluster close to the origin .",
    "similarly to the food webs , the variance of the @xmath51 values obtained for the regulatory networks was relatively high .",
    "i.e. , the regulatory networks trn - yeast-2 and trn - yeast-1 are amongst the most hierarchical studied systems , whereas the trn - ec network shows only a modest hierarchy value .    the trust networks obtained moderate hierarchy values , and the variance of their @xmath51 values is far smaller compared to the very large variance in their sizes .",
    "the language networks turned out to be moderately hierarchical as well . here",
    "the networks were originating from large text corpora , and a directed link from word @xmath147 to @xmath204 is signaled that @xmath204 was following @xmath147 in the text . according to the results , the english- french- and japanese language networks obtained @xmath51 values quite close to each other , while the hierarchy of the spanish language seemed considerably lower .",
    "finally , the networks between web pages showed again a moderate hierarchy , where @xmath51 for the google web and polblogs were quite close to each other , while network of nd.edu received a significantly higher hierarchy value .",
    "it is very interesting to see how the picture is changing when we switch from @xmath51 to the @xmath88-score shown in fig.6 in the main paper , corresponding to the difference between @xmath51 and @xmath80 in the configuration model , scaled by standard deviation of @xmath51 in the configuration model .",
    "the citation networks , the internet networks and the food webs are forming three rather tight clusters in fig.6 . in the main paper with significant positive @xmath88-score , ( which is outstandingly high in case of the citation networks ) .",
    "in contrast , the metabolic- and regulatory networks are forming clusters of significant negative @xmath88-score , indicating that their structure is far less hierarchical compared to what we would expect by assuming random connections between the nodes , ( at the same degree distribution as in the original network ) .",
    "the @xmath88-scores of www networks were all positive , ( where the nd.edu network showed an outstandingly high value ) . in case of the trust",
    "networks the @xmath88-scores are also almost always positive , with the exception of the prison network , where @xmath205 .",
    "the organisational- , electric- , and language networks showed a mixed picture , including both positive and negative @xmath88-scores ."
  ],
  "abstract_text": [
    "<S> signs of hierarchy are prevalent in a wide range of systems in nature and society . </S>",
    "<S> one of the key problems is quantifying the importance of hierarchical organisation in the structure of the network representing the interactions or connections between the fundamental units of the studied system . </S>",
    "<S> although a number of notable methods are already available , their vast majority is treating all directed acyclic graphs as already maximally hierarchical . here </S>",
    "<S> we propose a hierarchy measure based on random walks on the network . </S>",
    "<S> the novelty of our approach is that directed trees corresponding to multi level pyramidal structures obtain higher hierarchy scores compared to directed chains and directed stars . </S>",
    "<S> furthermore , in the thermodynamic limit the hierarchy measure of regular trees is converging to a well defined limit depending only on the branching number . </S>",
    "<S> when applied to real networks , our method is computationally very effective , as the result can be evaluated with arbitrary precision by subsequent multiplications of the transition matrix describing the random walk process . </S>",
    "<S> in addition , the tests on real world networks provided very intuitive results , e.g. , the trophic levels obtained from our approach on a food web were highly consistent with former results from ecology . </S>"
  ]
}