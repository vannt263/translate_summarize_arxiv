{
  "article_text": [
    "electrostatic forces play a major role in intra- and inter - molecular interactions .",
    "in particular , in locally charged systems , strong coulomb interactions between charged particles often dominate structural and dynamical properties @xcite .",
    "this situation occurs frequently in biological systems , where both protein @xcite and dna macromolecules @xcite typically undergo h+ dissociation or association , thereby generating a charged macroion with counterions in solution .",
    "in addition , aqueous solutions often contain dissolved salts , thus introducing more mobile ions into the system . the thermally averaged interaction force ( which integrates to give the `` potential of mean force '' ( pmf ) @xcite ) between two macroions depends strongly on electrostatic forces that are supplied by the mobile ions in the surrounding solution .",
    "calculation of the pmf , or , equivalently , electrostatic free energy of interaction between two macroions , is critical to understanding their equilibrium ( and , ultimately , dynamical ) properties .",
    "for example , the electrostatic pmf determines the binding equilibrium constant for the macroion pair @xcite .",
    "similar remarks hold for synthetic macroions , for example , charged colloid particles , whose self - assembly properties , phase diagrams , etc .",
    ", are determined by precisely the same type of considerations @xcite .",
    "dynamical properties , such as rate constants for transitions between stable states @xcite and ion currents through channel proteins @xcite , are heavily influenced by the energy landscape determined from equilibrium free energy considerations .",
    "the difficulty of implementing such long range ( `` nonlocal '' ) forces in realistic numerical simulations is well known : each charged particle `` feels '' the effect of all the others , so that naive algorithms typically scale with the square of the system volume @xmath0 , while more sophisticated algorithms ( ewald summation , fourier techniques @xcite ) with better scaling properties nevertheless prove far from efficient in computing the electrostatic energy for large systems .",
    "recently , a local formulation of the coulomb gas problem ( first introduced by maggs and collaborators @xcite has offered a possible exit from this impasse . at the cost of including an unphysical transverse ( or  curl \" )",
    "part in the electric field , the effects of which on the charged particle dynamics can be shown to decouple on average over a suitably long monte carlo simulation of the system , the hamiltonian of the system can be recast in a completely local form , so that the computational cost of a system update becomes of the order of the system volume @xmath0 ( rather than @xmath1 , as above ) .",
    "this method , together with several improvements designed to improve the mobility of the charged particles in the simulations , have been the subject of a number of recent publications @xcite .    the local coulomb gas formalism is based on the partition function of a system consisting of @xmath2 charges ( mobile or fixed ) @xmath3 at locations @xmath4 , thereby producing a charge density @xmath5 accordingly , the canonical partition function for the system at inverse temperature @xmath6 becomes @xmath7 where @xmath8 is the dielectric constant of the medium in which the charges move ( assumed spatially uniform throughout this paper ) .",
    "the essential point is that the transverse , or curl , part of the electric field variable decouples from the charged particle dynamics via the helmholtz decomposition @xmath9",
    "as only the gradient part of the electric field appears in the gauss law constraint in ( [ eq : partfunc ] ) , the curl part clearly decouples from the particle positions .",
    "however , the simulation of the integral in ( [ eq : partfunc ] ) involves charged particle moves that are only sensitive to the local value of the electric field , provided that the local field is modified to maintain gauss law at all times .",
    "practically , the simulations are most readily performed on spatial lattices , with the particle charges associated with lattice sites , and the electric fields with links connecting nearest neighbors on the lattice . for a complete description of the algorithm ,",
    "the reader is referred to ref .  @xcite .",
    "before discussing our fft based approach to updating the electric field in a local coulomb gas simulation , we briefly review some of the field update methods that have been used in previous applications of the local lattice method of maggs et al @xcite .",
    "the implementation of the method is most simply seen on a square lattice with dimensionless variables .",
    "we therefore scale the electric field by a factor of @xmath10 and the inverse temperature by a factor of @xmath11 , where @xmath8 is the dielectric constant of the system and @xmath12 is the lattice spacing .",
    "any field update method must conserve gauss law at every step of the simulation .",
    "the simplest methods for updating the electric field are based on shifting the four link fields of a plaquette by the same amount @xmath13 .",
    "such a shift maintains the gauss law constraint .",
    "one possibility is to use a metropolis procedure to pick @xmath13 , but it is more efficient to use a heat - bath method . considering one plaquette and labeling its links 1 through 4 , the portion of the hamiltonian that depends on these links ( written using dimensionless variables ) is given by @xmath14 where @xmath15 is the electric field on the @xmath16th link in the direction obtained by going around the plaquette clockwise .",
    "this can be rewritten as @xmath17 where we have dropped terms with no @xmath13 dependence .",
    "therefore @xmath13 can be generated with the canonical distribution by setting it to @xmath18 where @xmath19 is a gaussian - distributed variable with zero mean and standard deviation one and @xmath20 is the dimensionless inverse temperature .",
    "updating the plaquettes using this procedure will be referred to in this paper as the local heat bath method , as the change in each plaquette is affected only by the immediate local neighborhood of that plaquette .",
    "of the three methods compared in this paper , the local heat bath is the simplest to implement but also the  most local , \" and can be expected to yield the longest autocorrelation times .",
    "level , alet , rottler and maggs @xcite recently introduced a cluster move to update the electric fields more efficiently based on a worm algorithm developed by alet and srensen @xcite .",
    "the method introduces a pair of positive and negatively charged particles on a randomly chosen site of the lattice .",
    "one of the particles then moves about the lattice in a biased random walk , as described in ref .",
    "this pseudo - particle moves through the lattice ( modifying appropriately the electric field to preserve gauss law ) , eventually returning to its partner where the two annihilate each other .",
    "a loop of links with modified electric fields is left behind along the path taken by the mobile particle .",
    "this change of the electric fields along this loop is then accepted or rejected depending on the fields entering the initial site .",
    "empirically these loop changes are accepted with high probability .",
    "the charge of the virtual pair is randomly chosen with a uniform distribution in the interval ( @xmath21 , @xmath22 ) , where @xmath22 is a free parameter which is chosen to maximize efficiency .",
    "the worm method is clearly more ",
    "global \" than the local heat bath method described above typically the number of links modified is of order the lattice volume and we may expect autocorrelation times that are shorter than those obtained with plaquette updates .",
    "nevertheless , field configurations that differ by a single worm update are still substantially correlated with each other .",
    "next , we show that a global regeneration of the electric field is possible , using fft techniques , which is computationally more efficient than the worm method on reasonably large lattices , and produces a completely decorrelated electric field after a single update step .",
    "in this section we describe in some detail a fft - based approach to updating the electric field in local coulomb gas simulations that is computationally of order @xmath23 , and produces a globally decorrelated transverse field at each update .",
    "it is similar to methods used to study electromagnetic splittings in lattice quantum chromo - dynamics in ref .",
    "the method does not have any free parameters , obviating the need to optimize simulation parameters , and , as we shall see below in some sample computations , is computationally more efficient ( in the sense of computational effort per autocorrelation time of physically interesting observables ) than the other updating schemes described previously .",
    "once again , consider a lattice coulomb gas with charge density @xmath24 and electric field link variables @xmath25 ( where @xmath26 denotes lattice sites and @xmath27 spatial direction ) .",
    "the partition function takes the form , for fixed charge particle locations ( i.e. fixed @xmath28 ) , @xmath29 where @xmath30 ( resp .",
    "@xmath31 ) denote left ( resp .",
    "right ) lattice derivatives here and below .",
    "we wish to develop an efficient procedure for traversing the space of electric field configurations @xmath32 consistent with the gauss law constraint .",
    "a perfect decorrelation can be achieved if the new field has a transverse ( `` curl '' ) part completely decorrelated with the previous transverse field : on the other hand , the longitudinal ( `` gradient '' ) part of the field is fixed by the gauss law constraint and must be preserved by the update procedure . to accomplish this",
    "we must ( a ) extract the longitudinal part , and ( b ) generate a new , and completely independent transverse part of the field .",
    "we shall work on a @xmath33x@xmath33x@xmath33 lattice ( volume @xmath34 ) with fourier transform fields defined as follows @xmath35 note that we distinguish lattice coordinate space fields from their momentum space transforms by using subscripts for the former and function notation for the latter .",
    "up to constant field configurations ( which are separately simulated as explained in ref .",
    "@xcite ) , an arbitrary lattice vector field @xmath25 may be decomposed @xmath36 where @xmath37 is a transverse lattice vector field satisfying @xmath38 ( as we see from eq .",
    "[ eq : etrans ] , the gradient part of @xmath37 is absent from @xmath39 ) .",
    "consequently , the fourier transform of @xmath37 , defined through @xmath40 must satisfy @xmath41 and can accordingly be written in terms of polarization vectors @xmath42 as follows @xmath43 for a discrete mode @xmath44 corresponding to a complex fourier component ( i.e. where @xmath45 with not all of @xmath46 equal to 0 or @xmath47 ) . for the real modes the reader may easily verify that analogous formulas hold involving purely real vectors . from the form of the partition function given in eq .",
    "[ eq : boltzwt ] one finds that the fourier coefficients @xmath48 in eq .",
    "[ eq : afour ] are to be generated according to the gaussian weight @xmath49 with @xmath50 .",
    "once random polarization vectors @xmath51 and @xmath52 are generated satisfying equations [ eq : eps1 ] and [ eq : eps2 ] , then eq .  [ eq : afour ] yields the complete fourier transform @xmath53 .",
    "an inverse fft then yields the coordinate space field @xmath37 , and a lattice curl the desired transverse part of the electric field @xmath39 via eq .",
    "[ eq : etrans ] .",
    "this heat bath procedure clearly produces a new transverse electric field completely decorrelated from the preceding one .",
    "as we wish to update the _ total _ electric field , we must also calculate the gradient part @xmath54 , which can then be added to the new decorrelated transverse field . to do this",
    ", we simply note that from eq .",
    "[ eq : epar ] it follows that @xmath55 where @xmath56 is the fourier transform of the charge density @xmath24 , which is also to be computed by fft .",
    "thus this algorithm involves ( apart from the effort required to generate the fourier components @xmath53 as indicated above ) 4 fft operations to generate a globally decorrelated electric field . as we shall see below",
    ", this computational effort compares favorably with competitive methods , such as local heat - bath or worm type update algorithms .",
    "to test our fft - based method for updating the electric fields , and compare its efficiency with that of the local heat - bath and worm update methods , we simulated the system of charged conducting plates with ions between the plates discussed in ref .",
    "the basic system consists of a 50x50x50 lattice with periodic boundary conditions in all three dimensions .",
    "positive charges are free to move on two fixed plates separated in the @xmath19 direction that extend the entire extent of the lattice in the @xmath57 and @xmath58 directions , while the region between the plates contains mobile counterions ensuring overall neutrality . as in ref .",
    "@xcite , the lattice spacing is chosen to be 1  , the dielectric constant is @xmath59 , and the temperature is @xmath60 so that the dimensionless inverse temperature , @xmath20 , is @xmath61",
    ". the plates are charged with 34 positively charged univalent ions , which are constrained to stay on the plate .",
    "34 negatively charged divalent ions are placed between the plates , and are excluded from the plane of lattice sites closest to the plates .",
    "every lattice site can be occupied by at most one ion .",
    "the ions are moved by the coupled particle - field heat bath method discussed in ref .",
    "@xcite .",
    "each monte carlo step is composed of ( 200 @xmath62 number of charges on the plates ) attempted moves of the positive ions on the plates , ( 2000 @xmath62 number of ions in solution ) attempted moves of negative ions in solution , a global update of the total electric field ( as described in ref .",
    "@xcite ) , and an update of the electric field using either the local heat bath method , the worm method , or the fft based method . for the local heat bath method",
    "@xmath63 links are chosen at random to be updated .",
    "for the worm method , 5 worms are created for each monte carlo sweep . the maximum ghost charge used in the worm method",
    "was set to 0.3 , which was determined experimentally to be the value that minimized the autocorrelation times of our observables . for the fft method the fftw package @xcite",
    "was used to perform the ffts .    on a 2ghz amd processor",
    "it takes 336 seconds to perform 1000 updates of the electric field using the fft method .",
    "it takes 432 seconds to perform 1000 monte carlo sweeps using the local heat bath method .",
    "it takes 700 seconds to perform 1000 monte carlo sweeps using the worm method , where each monte carlo sweep corresponds to creating 5 worms .",
    "thus , using these parameters , the fft - based method is more than a factor of 2 faster than the worm - based method .    to compare the efficiencies of the different methods , we consider the autocorrelation times of various observables .",
    "the autocorrelation of an observable @xmath64 is given by @xmath65 where @xmath66 designates the @xmath16th measurement of @xmath64 and @xmath67 is the average value of @xmath64 .",
    "we extract the autocorrelation time of an observable , @xmath68 , by integrating the autocorrelation function out to a distance where the measurements are decorrelated ( @xmath69 where @xmath70 ) .",
    "direction at the ( 25,25,25 ) lattice site from simulations using fft - based update method , local heat bath update method , and worm update method .",
    "after equilibration the particles are frozen in place for these runs.,width=336 ]    initially we consider the autocorrelation of the electric field on a single link of the lattice . in order to observe how the electric field decorrelates itself using solely the different field update methods , we fix the location of the ions after the warmup sweeps .",
    "we then simulate the electric field using the different field update methods and observe the electric field in the @xmath57 direction on the ( 25,25,25 ) site .",
    "the autocorrelation function of this electric field is shown in fig .",
    "[ fig : efield_autocorr ] .",
    "we determine the autocorrelation time by integrating the autocorrelation function out to 40 .",
    "this gives an autocorrelation time of @xmath71 for the worm method and an autocorrelation time of @xmath72 for the local heat bath method .",
    "the fft based method gives a completely decorrelated set of electric fields , so the electric field under observation is decorrelated after a single monte carlo step and the autcorrelation time is @xmath73 .",
    "the local heat bath method is able to decorrelate this observable rapidly because the observable is so local .",
    "direction from simulations using fft - based update method , local heat bath update method , and worm update method .",
    "after equilibration the particles are frozen in place for these runs.,width=336 ]    we next consider the autocorrelation function of the ( 2 , 2 , 2 ) component of the fourier transform of the electric field in the @xmath19 direction .",
    "again we fix the location of the ions to concentrate on the efficiency of the field update methods .",
    "the autocorrelation functions are shown in fig .",
    "[ fig : fft_autocorr ] . integrating the autocorrelation function out to 50",
    "gives an autocorrelation time of @xmath74 for the local heat bath update method runs and @xmath75 for the worm update method runs .",
    "the local heat bath method has more difficulties with smaller momentum components of the fourier - transformed electric field : the ( 0 , 0 , 1 ) component has an autocorrelation time of @xmath76 with the local heat bath update , while the autocorrelation time with the worm update is only @xmath77 . for this observable the large clusters that are updated with the worm method allow it to decorrelate these small - momentum fourier components more rapidly then the local heat bath method .",
    "the fft based method decorrelates all the fourier components of the electric field in a single monte carlo update step .",
    "we then perform the simulations with the ions allowed to move throughout the simulation and consider the particle - particle energy given by the expression @xmath78 this is a physically interesting observable that depends only on the locations of the ions and not directly on the electric field .",
    "the correlations present in the electric field will affect the correlations of the particle - particle energy .",
    "all runs are composed of 5,000 monte carlo equilibration steps followed by 400,000 measurement steps .",
    "the autocorrelation functions of the particle - particle energy for the different field update methods are shown in fig .",
    "[ fig : ppe_autocorr ] . integrating the autocorrelation function out to 700",
    ", we obtain an autocorrelation time of @xmath79 for the local heat bath method simulation , @xmath80 for the worm update method , and @xmath81 for the fft based update method .",
    "efficient simulation of physical systems using monte carlo simulation depends on monte carlo update moves that decorrelate the system rapidly .",
    "we have studied the correlations of various observables in simulations of charged particles using the method introduced by maggs et al . , and were able to reduce the autocorrelation time of many observables by introducing a method based on the fft that produces a completely independent electric field ( subject to the gauss law constraint ) after a single update step .",
    "we have shown on a physically realistic system that , although local heat bath methods and worm - based methods are able to decorrelate the electric field well on different length scales , the fft based method performs better than either of them on all observables studied . additionally , using our implementations ,",
    "the fft method took the least amount of computer time .",
    "the work of a.  duncan was supported in part by nsf grant phy0244599 . the work of r.d .",
    "sedgewick and r.d .",
    "coalson was supported by nsf grant che0092285 .",
    "a.  duncan is grateful for the support and hospitality of the max planck institute ( heisenburg institut fr physik und astrophysik ) , where part of this work was performed .",
    "maggs and v.  rossetto , phys .",
    "lett .  * 88 * , 196402 ( 2002 ) j. israelachvili , _ intermolecular and surface forces , 2nd ed . _",
    "( academic , london , 1992 ) d. bashford and m. karplus , biochem .  * 29 * , 10219 ( 1990 ) d. bashford and d.a .",
    "case , biochem .  * 32 * , 8045 ( 1993 ) p.g .",
    "arscott , a .-",
    "li , and v.a .",
    "bloomfield , biopoly . * 30 * , 619 ( 1990 ) d.a .",
    "mcquarrie , _ statistical mechanics _ ( harper and row , new york , 1976 ) d. chandler , _ introduction to modern statistical mechanics _ ( oxford university press , new york , 1987 ) m. zacharias , b.a .",
    "luty , m.e .",
    "davis , and j.a .",
    "mccammon , j.  mol .",
    "textbf238 , 455 ( 1994 ) a.k .",
    "sood , in _ solid state physics _ , edited by h.  eherenreich and d.  trunbull ( academic , new york , 1991 ) , vol .",
    "45 , p.  1",
    "n. ise and h. yoshida , acc .",
    "29 * , 3 ( 1996 ) b. hille , _ ion channels of excitable membranes .",
    "_ ( sinauer assoc . ,",
    "sunderland , 2001 ) j.v.l .",
    "beckers , c.p .",
    "lowe and s.w .",
    "de  leeuw , molecular simulation * 20 * , 269 ( 1988 ) j.w .",
    "perram , h.g .",
    "petersen and s.w .",
    "de  leeuw , molecular phys .  * 65 * , 875 ( 1985 ) e.  esssmann , l.  perera , m.l .",
    "berkowitz , t.  darden , h.  lee and l.g .",
    "pedersen , j.  chem .",
    "phys .  * 103 * , 8577 ( 1995 ) a.  duncan , r.d .",
    "sedgewick , and r.d .",
    "coalson , phys .",
    "e * 71 * , 046702 ( 2005 ) l.  levrel , f.  alet , j.  rottler , and a.c .",
    "maggs , statphys22 proceedings , to be published in pramana [ also available at ` cond - mat/0409350 ` ] l.  levrel and a.c .",
    "maggs , ` cond - mat/0503744 ` ( 2005 ) f.  alet and e.  srensen , phys .",
    "e * 67 * , 015701 ( 2003 ) a.  duncan , e.  eichten and h.  thacker , phys .",
    "lett .  * 76 * , 3894 ( 1996 ) m.  frigo and s.g .",
    "johnson , proc .  of the ieee",
    "* 93 * , 216 - 231 ( 2005 )"
  ],
  "abstract_text": [
    "<S> an improved approach to updating the electric field in simulations of coulomb gases using the local lattice technique introduced by maggs and rossetto @xcite , is described and tested . using the fast fourier transform ( fft ) an independent configuration of electric fields subject to gauss law constraint </S>",
    "<S> can be generated in a single update step . </S>",
    "<S> this fft based method is shown to outperform previous approaches to updating the electric field in the simulation of a basic test problem in electrostatics of strongly correlated systems .    </S>",
    "<S> department of biological sciences + carnegie mellon university + pittsburgh , pa 15213 </S>"
  ]
}