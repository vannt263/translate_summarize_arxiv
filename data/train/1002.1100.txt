{
  "article_text": [
    "phylogenetic methods have recently been rediscovered in several interesting areas among which immunodynamics , epidemiology and many branches of evolutionary dynamics .",
    "the reconstruction of phylogenetic trees belongs to a general class of inverse problems whose relevance is now well established in many different disciplines ranging from biology to linguistics and social sciences  @xcite . in a generic inverse problem one",
    "is given with a set of data and has to infer the most likely dynamical evolution process that presumably produced the given data set .",
    "the relevance of inverse problems has been certainly triggered by the fast progress in data - revealing technologies . in molecular biology , for instance , a great amount of genomes data are available thanks to the new high - throughput methods for genome analysis  @xcite . in historical linguistics",
    "@xcite a remarkable effort has been recently done for the compilation of corpora of homologous features ( lexical , phonological , syntactic ) or characters for many different languages .",
    "although phylogenetic reconstruction is not a novel topic , dealing with not purely tree - like processes and identifying the possible sources of non - additivity and their effects in a given dataset is still an open and challenging problem  @xcite .",
    "here we focus on distance - based methods  @xcite and investigate how deviations from additivity affect their performances . in distance - based methods only distances between leaves are considered , and all the information possibly encoded in the combinatorial structure of the character states is lost . despite their simplicity ,",
    "distance - based methods are still widely used thanks to their computational efficiency , but a solid theoretical understanding on the limitation of their applicability is still lacking .",
    "one of the most popular distance - based reconstruction algorithm , neighbor - joining ( nj )  @xcite , was proposed in the late _ 80 s _ , but it is only recently that its theoretical background was put on a more solid basis  @xcite .",
    "another step toward a better understanding of distance - based methods was obtained thanks to an interesting property of additive distances , the pauplin s formula  @xcite .",
    "this property has been used in the formulation of a novel algorithmic strategy with improved performances ( fastme )  @xcite . in parallel , another fundamental property of additive trees , the _ four - points _ condition  @xcite , has been extensively exploited in distance - based phylogenetic reconstruction methods  @xcite . both the pauplin s formula and the _ four - points _ condition will be discussed in details below .    here",
    "we propose a new approach that combines the _ four - points _ condition and the pauplin s formula in a stochastic local search ( sls ) scheme that we name stochastic big - quartet swapping ( sbix ) algorithm .",
    "sls  @xcite algorithms transverse the search space of a given problem in a systematic way , allowing for a sampling of low cost configurations .",
    "sls algorithms start from a randomly chosen initial condition .",
    "subsequently the elementary step is a move from a configuration to a neighboring one .",
    "each move is determined by a decision based on local knowledge only .",
    "typically the decision is taken combining , with a given a priori probability , a greedy step ( i.e. , a step that reduces the local cost contribution ) , with a random one where the local cost is not taken into account .",
    "sls algorithms have been widely used in solving complex combinatorial optimization problems such as satisfiability , coloring , max - sat , and traveling salesman problem  @xcite .    at the heart of our new algorithmic scheme ( named sbix )",
    "there is the notion of _ quartet frustration _ , a quantitative measure of how good a given configuration is , in the space of trees .",
    "following a concept already introduced in  @xcite , we weight the different quartets according to their length , in order to reduce the effect of those which are more likely to undergo double mutations .",
    "the strength of our approach comes from a combination of this strategy with a pauplin s like one , weighting each quartet according to a purely topological property .",
    "we tested the performances of the proposed reconstruction algorithm , i.e. , the ability to reconstruct the true topology , in the presence of high levels of deviation from additivity due to both horizontal transfer and back - mutation processes .",
    "we use both a very simple model to generate artificial phylogenies of binary sequences , and the more realistic kimura two - parameters model , considering sequences with @xmath0-state sites , with @xmath1 .",
    "we have evidence that the performance of our algorithm does not rely on the particular evolutive process giving rise to the phylogeny , nor on the particular representation of the taxa .",
    "we find that when the lack of additivity arises from high mutation rates ( and consequently high probability of back mutations ) , our algorithm significantly outperforms the state - of - art distance - based algorithms .",
    "when the lack of additivity arises from high rate of horizontal transfer events , our algorithm performs better than the algorithms we considered as competing ones .",
    "we show results both for a greedy and a simulated - annealing - like strategy of our algorithm , the former being significantly faster than the latter and with comparable performances .",
    "the sbix algorithm has a complexity of @xmath2 , which is higher that the one of the distance - based algorithms used as competitors for comparing the performances .",
    "nevertheless , the prefactor of the greedy version is so low that our algorithm is fast enough to reconstruct large phylogenies e.g. , of a few thousands taxa , in a time remarkably slower with respect to any character based reconstruction algorithm .",
    "a comparison of the running time and of the performances of our algorithm with a popular character based one , mrbayes  @xcite , is reported respectively in the appendix ii and in the section results .",
    "we show that , while the performances of the two algorithms are comparable , the running time of mrbayes greatly exceed ours , becoming comparable when the reconstruction becomes in practise unfeasible , that is for running times of the order of some thousand of years , and number of taxa of the order of one hundred thousand .",
    "a distance matrix is said to be additive if it can be constructed as the sum of a tree s branches lengths .",
    "two fundamental and widely used properties of additive distances are the pauplin s formula  @xcite and the _ four - points _",
    "condition  @xcite . for",
    "the sake of clarity , we recall them here .    given any quadruplet of taxa @xmath3 , let @xmath4 , @xmath5 , and @xmath6 be the three possible pairs of distances between the four taxa .",
    "a matrix @xmath7 is additive if and only if @xmath8 or @xmath9 or @xmath10 .",
    "when considering experimental data , additivity is almost always violated and so is the _ four - points _ condition . in order to set up a robust method for phylogeny reconstruction based on the _ four - points _ condition",
    ", we need to relax the notion of additivity and to quantify violations in a suitable way . for any four taxa @xmath3 such that @xmath11 are on one side of the tree and @xmath12 on the other ( as in fig .",
    "[ fig : tree ] ) , the quartet @xmath13 is said to satisfy the _ weak four - points _ condition if @xmath14 ( where @xmath15 are defined as above ) .",
    "it is easy to prove that if the distance matrix @xmath7 is additive a unique tree exists in which all quartets satisfy the _",
    "weak four - points _ condition and this tree is the correct one .",
    "many algorithms have been proposed that exploit this _",
    "weak four - points _ condition , one of the most promising being , for instance , the short - quartet method  @xcite .",
    "induces an internal edge @xmath16 that divides the tree in two parts .",
    "all paths joining any pair of sites sitting on opposite parts of the tree pass through @xmath16.,scaledwidth=49.0% ]      another remarkable property of an additive tree is the possibility to compute its total length @xmath17 , defined as the sum of all its branches lengths , through a formula , due to pauplin  @xcite , that only uses distances between taxa : @xmath18    where @xmath19 is the number of nodes on the path connecting @xmath20 and @xmath21 , i.e. , their _ topological distance_. for additive trees @xmath22 , but even when the _ four - points _ condition is no longer satisfied , @xmath23 is a particularly good approximation for the tree length  @xcite .",
    "furthermore , it is recognized that for distance matrices sufficiently `` close '' to additivity  @xcite the correct phylogeny minimizes @xmath23  @xcite .",
    "this principle is used in an implicit way in neighbor - joining  @xcite and more explicitly in a new generation distance - based algorithm , fastme  @xcite . when departure from additivity is too strong @xmath23 is no longer a good functional to minimize in order to recover the correct tree .",
    "violations of additivity can arise both from experimental noise and from properties of the evolutionary process the data come from .",
    "we here consider two of the main sources of violations of the latter type that can either occur together or singularly .",
    "( i ) _ back - mutation _ : in particularly long phylogenies , here the time - scale being set by the mutation rate , a single character can experience multiple mutations . in this case",
    "the distances between taxa are no longer proportional to their evolutionary distances ; we will use in the following the expression _ back - mutation _ as synonymous of multiple mutation on the same site ; ( ii ) _ horizontal transfer _ :",
    "the reconstruction of a phylogeny from data underlies the assumption that information flows _ vertically _ from ancestors to offsprings .",
    "however , in many processes information flows also _",
    "horizontal ( or lateral ) gene transfers  @xcite are often well known confounding factors for a correct phylogenetic inference .      here",
    "we describe the structure of our stochastic big - quartet swapping ( sbix ) algorithm .",
    "as already mentioned this algorithm crucially exploits both the _ weak four - points _ condition and the pauplin s distance , featuring a larger robustness with respect to violations of additivity if compared to algorithms based separately on the _ weak four - points _ condition or on the minimization of the pauplin s length .",
    "the general structure of the sbix algorithm is as follows :    * start with a tree topology for the given set of taxa ; * update the tree topology by local elementary rearrangements through sub - trees quartet swapping ; * repeat point @xmath24 till convergence is reached ;     rooted respectively on @xmath25 . here , the initial reference configuration @xmath26 displayed on the left , leads to two possible rewiring : ( i ) swap the pair @xmath27 ( right - upper panel ) , ( ii ) swap the pair @xmath28 ( right - lower panel).,scaledwidth=49.0% ]      we analyze the three points in details in the following :    * in the simulated - annealing - like version of the algorithm we start with a random topology . in the greedy version we search for a local minimum ( which can eventually be the global one ) , so it is important to start with a meaningful topology .",
    "we tested the algorithm starting both with the fastme and the nj reconstructed topologies .",
    "* we sequentially consider all the internal edges of the present topology .",
    "each internal edge defines four subtrees ( see fig .",
    "[ fig : mcstep ] ) , say @xmath29 , rooted respectively on the four internal nodes @xmath25 . referring to fig .",
    "[ fig : mcstep ] , let @xmath26 being the initial configuration .",
    "we randomly choose one of the two possible local rewirings : ( i ) swap the pair @xmath30 getting the configuration @xmath31 , ( ii ) swap the pair @xmath32 getting the configuration @xmath33 . in the simulated - annealing version ,",
    "the new configuration is accepted with a probability proportional to the statistical weight @xmath34 where @xmath35 is an inverse temperature - like parameter that is set by a simulated annealing - like  @xcite strategy and @xmath36 is the difference of the two configurations local costs : for case ( i ) @xmath37 while for case ( ii ) @xmath38 . in the greedy ( or zero temperature ) version ,",
    "the new configuration is accepted if and only if @xmath39 .",
    "* in the simulated - annealing version , we iterate point @xmath24 starting with @xmath40 and increasing it at a constant rate at each sweep ( where we call _ sweep _ an update of all the internal edges ) until convergence is reached , i.e. , until the algorithm gets stuck in a fixed topology . in the greedy version , we iterate point @xmath24 until the algorithm gets stuck in a fixed topology .    in order to define the configurational local cost ,",
    "say @xmath41 , we consider all the quartets @xmath13 such that @xmath42 ( @xmath20 is a taxa of the subtree @xmath43 ) , @xmath44 , @xmath45 , and @xmath46 . for each quartet",
    "we define the _ quartet frustration _ as :    @xmath47    where @xmath15 are the sums of distances already defined ( @xmath4 , @xmath5 , @xmath6 ) .",
    "the normalization factor in the right - hand side of eq .",
    "[ eq : fru ] , as already pointed out in the introduction , gives a smaller weight to longer distances , typically affected by noise and recombination .",
    "the parameter fixing strategy for the exponent @xmath48 will be discussed in the next subsection .",
    "the cost @xmath41 of the configuration @xmath26 is thus defined as the sum of the costs ( _ frustrations _ ) of all the considered quartets , each weighted with a factor borrowed from the pauplin s formula :    @xmath49    where @xmath50 is the topological distance between the taxa @xmath20 and the internal node @xmath51 , and analogously for the other taxa .      when @xmath52 in eq .",
    "[ eq : fru ] our procedure is equivalent to the minimization of the pauplin s length ( the proof of this statement will be discussed in the appendix ia ) . on the other hand , if the pauplin weights @xmath53 , @xmath54 , @xmath55 , @xmath56 were absent , the difference in local costs between two configurations would be equal to the variation of a global cost , defined as @xmath57 . here",
    "the sum defining the cost , @xmath58 , is running over _ all _ the quartets of the tree and not only on the quartets compatible with the sub - trees @xmath29 .",
    "we will refer to our algorithm with this form of the cost configuration as the _ normalized quartets _ method ( nq ) .",
    "conversely , when one takes the complete form of the local cost as defined in eq .",
    "[ eq : quart - paup ] , with @xmath59 in eq .",
    "[ eq : fru ] , the local cost differences do not correspond to any global cost difference ( the proof of this statement will be discussed in appendix ib ) .",
    "it is however an open question whether a global functional can be defined whose variation between each pair of configurations is compatible with the sign of our local cost difference .",
    "the complexity of a sweep of our algorithm ( i.e. , @xmath60 configurations updates , where @xmath60 is the number of leaves in the tree ) , has a leading term @xmath2 .",
    "the number of quartets to be considered when updating all the edges of the tree in case of a perfectly balanced tree reads : @xmath61 .",
    "we show the results of numerical simulations for the running time of the greedy version of our algorithm in appendix iib . if considering the _ normalized quartets _",
    "method , a nave minimization of the corresponding functional would lead to a complexity of @xmath62 , while a montecarlo sweep for a nave minimization of the pauplin length is only @xmath63 . despite the @xmath2 complexity of the sbix algorithm",
    ", the greedy version has an extremely low prefactor , making the algorithm suitable for trees with a large number of taxa ( see appendix iib ) .",
    "to test the performances of our algorithm , we consider artificially generated phylogenies following one of the simplest evolutionary model that takes into account both mutational events and horizontal transfer .",
    "each taxon is represented by a binary sequence of length @xmath64 .",
    "we start with one sequence , for instance the sequence with all the bits equal to @xmath65 . then at each time step",
    "we perform the following operations : ( i ) we randomly extract one of the already existing leaf sequences , say @xmath66 ; ( ii ) with probability @xmath67 a randomly extracted portion of length @xmath68 of @xmath66 is replaced with the corresponding portion of another randomly chosen sequence   is arbitrary but does not bring loss of generality . choosing randomly in the interval @xmath69 $ ] the length of the part of the sequence horizontally transferred does not alter the qualitative behaviour of the reconstructing algorithms ( results reported in appendix iia ) .",
    "this last procedure is adopted in the @xmath70-state two parameters kimura model ( see below ) . ] ; ( iii ) @xmath66 generates two clones as descendants ; ( iv ) each site of the two new sequences is independently flipped with probability @xmath71 , where @xmath72 is extracted from an exponential distribution with average @xmath73 ( average number of mutations per sequence per time step ) . to ensure that at least on site mutates at each branching event , we randomly choose a site to mutate if no site mutated .",
    "we iterate this procedure until the desired number of taxa is obtained .",
    "we here consider as distance between two taxa the _ correct hamming distance _",
    "@xcite , defined as :    @xmath74    where @xmath75 is the _ hamming distance _ , defined as the fraction of sites in which the sequences differ .",
    "even though the defined correction has its theoretical justification only in absence of horizontal gene transfer , we checked ( data not shown ) that using the _ hamming distance _ @xmath75",
    "all the considered algorithms show the same relative behavior as in the reported results , but the absolute performances are remarkably poorer . ] .",
    "although the evolutionary model described above is a toy model for describing evolution , it allows to control and to tune noise as well as horizontal transfer events .",
    "we also test our algorithm on phylogenies constructed following more realistic model of evolution , such us the standard @xmath70-states two parameters kimura model  @xcite .",
    "in particular , we follow the same steps described above for the @xmath24-state model , but we now consider sequences of nucleotides , with an alphabet of @xmath70 letters , and different rates of transitions ( @xmath51 ) and transversions ( @xmath76 ) .",
    "we consider in this case as distance between two taxa the _ correct hamming distance _ for the jukes - cantor model  @xcite that is the limit of the kimura model when @xmath77 , which reads :    @xmath78      in order to assess the performances of the different algorithms to reconstruct the true phylogeny , we consider the standard robinson - foulds measure ( rf )  @xcite , which counts the number of bipartitions on which the inferred tree differs from the true one .",
    "a bipartition is a split of the leaves in two sets realized through a cut of a tree edge .",
    "we recall that it exists a one - to - one correspondence between the bipartitions of the tree and the set of its edges , so that each tree is uniquely characterized by the set of bipartitions it induces .",
    "note that , since we consider only binary trees , the number of true positive bipartitions equals the number of false positive bipartitions and both are equal to the rf measure .",
    "in order to assess the performances of our algorithm , both in its simulated annealing and greedy version , we compare it with the neighbor - joining ( nj )  @xcite and the fastme  @xcite algorithms .",
    "in addition we implemented the pauplin s length minimization ( from now onwards referred as pauplin ) by making use of our sbix algorithm in its form with @xmath52 ( see above the section about the algorithm s description ) .",
    "this in order to directly investigate the effectiveness of a non - greedy minimization of the pauplin s length in reconstructing trees .",
    "finally we implemented the version of our algorithm without the pauplin s weights ( nq ) ( as discussed above ) .",
    "we also show a comparison with the performances of a state - of - the - art character based algorithm , mrbayes  @xcite .",
    "is here kept @xmath79 .",
    "we compare the performances of the sbix algorithm with @xmath80 with : neighbor - joining ( nj ) , fastme , the pauplin length minimization ( pauplin ) , and normalized - quartets ( nq ) .",
    "right : dependence of the sbix algorithm on the parameter @xmath48 .",
    "the best performances are very stable in the range of @xmath48 between @xmath81 and @xmath82 . in both figures results",
    "are averaged over @xmath83 independent realizations for each reported mutation rate .",
    "the error bars are standard errors .",
    "all the trees generated have @xmath84 leaves and the sequences have fixed length @xmath85.,scaledwidth=80.0% ]     of the number of leaves . here",
    "normalized means the robinson - foulds distance divided by its maximal value @xmath86 .",
    "in all the cases curves for different values of @xmath60 collapse as a function of @xmath87 ( see text for details ) where @xmath88 is the average distance between two leaves in a tree with @xmath60 leaves . in both the analysis the horizontal transfer rate @xmath67",
    "is kept @xmath79 .",
    "we use both the true value of @xmath88 in the simulated phylogenies * ( a ) * , and the value analytically calculated in the case of perfectly balanced trees @xmath89 * ( b)*. in the inset of * ( b ) * we report the behavior of @xmath90 and @xmath91 as a function of tree size @xmath60 .",
    "the experimental values @xmath88 are systematically larger than @xmath91 putting in evidence a slight deviation of the generated trees from a perfectly balance condition.,scaledwidth=80.0% ]    ) with those of the following ones : neighbor - joining ( nj ) , fastme , the pauplin length minimization algorithm ( pauplin ) and the normalized - quartet ( nq ) algorithm .",
    "results are averages over @xmath83 independent realizations for each reported horizontal transfer rate .",
    "the error bars are standard errors .",
    "all the trees generated have @xmath84 leaves . * ( a ) * : mutation rate per site @xmath92 while the sequences have fixed length @xmath93 . *",
    "( b ) * : mutation rate per site of @xmath94 while the sequences have fixed length @xmath85.,scaledwidth=80.0% ]      in this section we compare the performances of all the considered algorithms as a function of the mutation rate and of the horizontal transfer rate in the underlying evolutionary process described in the previous subsection .    in fig .",
    "[ fig : rumandk ] we show the robinson - foulds curves for different algorithms ( left ) as a function of the mutation rate for a fixed tree size ( @xmath84 ) and @xmath80 . in the whole range of values of the mutation rate all the versions of our algorithm",
    "( pauplin , nq and sbix ) outperforms both nj and fastme .",
    "in particular sbix outperforms all the other algorithms .",
    "differences between the global minimization of the pauplin s length ( pauplin ) and fastme arise for very high mutation rates , where the global pauplin s length minimization outperforms fastme .",
    "this is probably due to the fact that fastme is time optimized and therefore less able of our stochastic local search scheme to find the global minimum of the functional for very high mutation rates ( for a discussion on the consistency of greedy local moves based on the balanced minimum evolution principle see  @xcite ) . in fig .",
    "[ fig : rumandk ] we report the dependence of the sbix performances ( right ) on the value of the parameter @xmath48 .",
    "it is evident the existence of a range of values between @xmath80 and @xmath95 where the algorithm features the best results in a stable way . in the following ,",
    "unless otherwise stated , we will consider the @xmath80 case .",
    "up to this point we have characterized the performance of the different algorithms for fixed value of the number of leaves , i.e. , for a given system size .",
    "we are now interested in the robustness of our results at different number @xmath60 of leaves of the tree . defining @xmath88 as the mean topological distance between any couple of leaves",
    ", we empirically found that each algorithm can be characterized by a reference curve obtained by plotting the normalized robinson - foulds distance as a function of @xmath96 .",
    "this scaling can be understood by considering that the relevant quantity for the tree reconstruction is not the bare mutation rate but the amount of back mutation events , that can be estimated as @xmath97 .",
    "the scaling of the normalized robinson - foulds distance when reconstructing trees of different sizes is shown in fig .",
    "[ fig : collapse ] , where for the sake of clarity we only report the curves for fastme and the sbix algorithm .",
    "each of the two algorithms is characterized by a different reference curve , and the interesting point here is that the sbix algorithm is systematically better than fastme at all mutation rates and sizes .",
    "we use both the measured value of @xmath88 in the simulated phylogenies ( fig .",
    "[ fig : collapse]-(a ) ) , and the value analytically calculated in the case of perfectly balanced rooted trees ( fig .",
    "[ fig : collapse]-(b ) ) that reads : @xmath98    we now consider the ability of the different algorithms in recovering the correct tree in the presence of horizontal transfer events .",
    "the robinson - foulds curves at a fixed tree size are shown as a function of the probability @xmath67 for each sequence to receive a borrowing ( with the mechanism defined above ) . in fig .",
    "[ fig : res_hor]-(a ) results at low mutation rate are reported , when deviation from additivity is almost exclusively due to the horizontal transfer events . in fig .",
    "[ fig : res_hor]-(b ) , instead , results are reported at high mutation rate , when both back mutations and the horizontal transfer events are responsible for deviations from additivity . for horizontal transfer events",
    "co - occurring with a low mutation rate , our algorithm is the most suitable to recover the correct tree , at each rate @xmath67 .",
    "the _ normalized quartets _ method , conversely , shows a performance lower than that of nj .",
    "when a high mutation rate is considered jointly with horizontal transfer events , our sbix algorithm significantly outperforms the others when the probability @xmath67 of horizontal transfer is not too high , while in the high @xmath67 region the performance of our algorithm becomes comparable to the minimization of the pauplin s length ( pauplin ) .",
    "it is interesting to compare the performance of the different algorithms in the case of a more realistic data generator . in fig .",
    "[ fig : res_k2p ] we show the analogous of fig .",
    "[ fig : rumandk ] for the two parameter kimura model : we present the robinson - foulds curves obtained for different algorithms ( nj , fastme , sbix greedy from fastme , sbix greedy from nj , sbix simulated annealing , and mrbayes ) for @xmath84 as a function of different per - site mutation rates @xmath99 .",
    "the details of the simulation for mrbayes are presented in appendix iib , together with a comment on the computational complexity of the whole simulation .",
    "the first evidence is that sbix , in its different flavors , clearly outperforms the other two distance based algorithms ( nj , and fastme ) .",
    "the improvement is even more evident compared with the binary characters case displayed in fig  [ fig : rumandk ] .",
    "the three variants of sbix perform similarly in the low mutation rate regime ( @xmath100 ) , and the results show a moderate improvement of the simulated annealing version only for high level of mutation rate , whereas the difference between the two greedy versions of sbix seem to be statistically irrelevant in all the mutation rate interval analyzed .",
    "the comparison with mrbayes is somehow surprising . after a very low mutation rate regime ( @xmath101 ) , where all algorithms show analogous accuracies , we enter in an intermediate regime ( @xmath102 ) where mrbayes outperforms sbix .",
    "one has to notice that the improvement of sbix vs. both nj and fastme is more evident compared with that of mrbayes vs. sbix . in the high mutation rate regime ( @xmath103 )",
    "mrbayes shows results compatible with two greedy versions of sbix , while it is slightly outperformed by the simulated annealing version of sbix , only at the larger mutation rate available ( @xmath104 )",
    ".    one should be careful to draw conclusions about the performance of mrbayes in the high mutation rate regime where the issue of reaching the monte carlo markov chain steady state becomes really problematic .",
    "we can not exclude that , upon doubling the simulation times in this regime , one could improve mrbayes results . in this regime ,",
    "as more thoroughly discussed in appendix iib , the computational time for a single sample is already of the order of five hours , whereas for both greedy versions of sbix is of the order of @xmath105 seconds , and for the simulated annealing version is around 5 minutes .     and transversion rate @xmath106 .",
    "robinson - foulds measure for the reconstructed trees as a function of the mutation rate per site .",
    "we compare the performances of our sbix algorithm ( with @xmath80 ) with those of the following ones : neighbor - joining ( nj ) , fastme , sbix greedy from nj , sbix greedy from fastme , sbix simulated annealing , and mrbayes .",
    "results are averages over @xmath83 independent realizations for each reported mutation rate .",
    "the error bars are standard errors .",
    "all the trees generated have @xmath84 leaves , and the sequence @xmath85.,scaledwidth=40.0% ]",
    "in this paper we have introduced a new algorithmic scheme for phylogeny reconstruction .",
    "belonging to the family of stochastic local search algorithms , our scheme crucially exploits two known properties of additive distance matrices , the _ four - points condition _ and the so - called pauplin s length .",
    "we proposed in particular a stochastic scheme where the correct topology is inferred through a series of swapping of the tree topology .",
    "when tested on artificially generated phylogenies our algorithmic scheme significantly outperforms state - of - art distance - based algorithms in cases of deviation from additivity due to high rate of back mutations . a significant improvement is also observed with respect to the state - of - art algorithms in case of high rate of horizontal transfer .",
    "such good performances are due to the way we differentially weight the different quartets contributions with a term inversely proportional to their length , and thus to their probability to be affected by back mutations . on the other hand further work is needed for a complete theoretical understanding of the algorithm .",
    "in particular , despite many attempts , we are , at present , unable to formulate the update strategy in terms of a state functional . beside the interest in itself",
    ", this would open the way to analytic treatments as well as to algorithmic optimization strategies possibly more efficient than the stochastic local search one .    as for the comparison of our algorithmic scheme with state - of - the art algorithms it is fair to observe that sbix features a definitely larger computational complexity but , in practice",
    ", it is fast enough for reconstructing phylogenies up to a few thousands of leaves .",
    "though sbix outperforms all competitors also in presence of horizontal transfers , the method is especially suited for dealing with non - additivity originated by double mutations .",
    "the issue of horizontal transfer is however central in many fields  @xcite , and we believe that formulating effective strategies to dealing with it , considering both phylogenetic trees and networks , is an open challenge for the next generation reconstruction algorithms and will be the aim of further studies .    it is worth mentioning how the applicability of phylogenetic algorithms has recently widened its scope .",
    "many different fields have arisen in the last few years where a correct reconstruction of phylogenetic trees may reveal underlying relevant dynamical processes .",
    "for instance phylodynamics is a new field at the crossroad of immunodynamics , epidemiology and evolutionary biology , that explores the diversity of epidemiological and phylogenetic patterns observed in rna viruses of vertebrates  @xcite ; phylogeography is the study of the historical processes that may be responsible for the contemporary geographic distributions of individuals as well as of languages or viruses  @xcite . in all these cases",
    "a strong effort is being devoted to the collection of comprehensive datasets and efficient and reliable algorithms are needed especially when deviations from perfect phylogenies become relevant .",
    "we show here that our sbix algorithm minimizes the pauplin s length when @xmath52 in the eq .",
    "[ eq : fru ] . in order to see this",
    ", we explicitly calculate the cost difference between , say , the configurations @xmath26 and @xmath33 .",
    "we note that the sum on the considered quartets can be divided in three parts , in which one of the three distances @xmath107 , @xmath108 and @xmath109 is respectively minimal ( where , as already defined in the text , @xmath4 , @xmath5 and @xmath6 ) . after a little algebra one gets :    @xmath110    where the sum is again over the @xmath111 and @xmath112 . making use of the relation :    @xmath113    and of the equivalences : @xmath114 in the configuration @xmath26 and @xmath115 in the configuration @xmath33 ( and the analogous relations for the other pairs of taxa ) , it is easy to prove that it holds :    @xmath116    where @xmath23 is the pauplin s length and @xmath117 is the difference of the pauplin s length between the two configurations .",
    "we give here an argument to prove that differences in the local cost of our sbix method can not be written as differences of a functional on the whole tree .",
    "if this was the case , a functional could be defined as @xmath118 , where @xmath119 is the value taken by the functional in a reference configuration @xmath120 , and @xmath121 are the cost differences along a path from @xmath120 to @xmath16 . moving in the space of tree s topologies",
    ", we should obtain the same value of @xmath122 each time we visit the same topology , i.e. , the difference of cost between two states does not depend on the path .",
    "this is not the case , as we explicitly checked , when the cost is defined as in eq .",
    "[ eq : quart - paup ] and @xmath123 .",
    "in order to assure that the procedure of keeping the length of the horizontal transfer fixed to @xmath68 , as for the results shown in the main text , does not alter the qualitative behaviour of the compared performances , we here show results where this restriction is relaxed . the figure  [ fig : hor_nofix ] is the analogous of figure 5 ( a ) in the main text , with the difference that here the proportion of horizontal gene transfer is allowed to randomly vary in the interval [ 0,1/4 ] .    ) with those of the following ones : neighbor - joining ( nj ) , fastme , the pauplin length minimization algorithm ( pauplin ) and the normalized - quartet ( nq ) algorithm .",
    "results are averages over @xmath83 independent realizations for each reported horizontal transfer rate the error bars are standard errors .",
    "all the trees generated have @xmath84 leaves , the mutation rate per site is kept fixed to @xmath92 while the sequences have fixed length @xmath93.,scaledwidth=40.0% ]        given the encouraging performance of the sbix compared to other distance based algorithm we have run a detailed comparison with character based methods such as mrbayes @xcite . for all our comparison we used mrbayes v3.1.2 on a standard linux platform , intel core(tm)2 cpu @xmath124 @xmath125 and a cache size of @xmath126 . in the simulation we kept the default setting of the program ( nruns = 2 , datatype = dna , nucmodel = 4by4 , nst = 1 , covarion = no , # states = 4 , rates = equal ) and we did not specify any details of the model generator .",
    "the only parameters we tuned were : ( i ) the number ngen of tree generated by the monte carlo markov chain ( mcmc ) , ( ii ) the number burnin of tree configurations discarded in the analysis .",
    "parameter fixing depends critically on data , and in particular , the more the generative model departs from additivity , the longer the mcmc must be run in order to achieve convergence and obtaining a fair sampling of the likelihood landscape of the problem .",
    "a useful proxy for mcmc convergence is the average standard deviation of the partition split frequencies in the nrun ( in our case nrun=2 ) mcmcs .",
    "one expects that this quantity , after a transient , approaches to zero for a sufficiently long number of iterations , reflecting the fact that the two markov chains become increasingly similar , sampling the same subspace of the problem .",
    "assessing precisely the computational complexity of mrbayes goes definitely beyond the scope of our work .",
    "we performed however a detailed analysis on a particular case for giving a fair comparison of the computational cost of the two strategies .    as a benchmark we used the two parameters kimura generator ( with transition rate @xmath127 and transversion rate @xmath106 ) discussed in the paper .",
    "we generated 100 realization of phylogenies , with sequence length @xmath85 , with a per - site mutation rate @xmath128 , at different values of the number of leaves ranging from @xmath129 to @xmath130 .",
    "as a lower bound on the computational cost of mrbayes we decided to stop the simulation as soon as the average standard deviation of the partition split frequencies became lower than @xmath131 .",
    "we intend this as a lower bound on the true computational cost since this can be considered as a good estimation only of the length of the transient regime . to ensure a fair _ equilibrium sampling _",
    "one should check that the 2 markov chains maintains split values lower than our threshold for a number of generations large enough . for each of our samples we recorded the running time in seconds and we averaged over the 100 sample realizations .",
    "var@xmath132 & samples ( mb ) & @xmath133 & var@xmath134 & samples ( sbix ) & ratio @xmath135 + & & & & + 15 & 11 & 1 & 50 & na & na & na & na + 30 & 60 & 3 & 50 & 0.004 & 0.04 & 100 & @xmath136 + 60 & 297 & 28 & 50 & 0.04 & 0.01 & 100 & @xmath137 + 120 & 2277 & 258 & 50 & 0.64 & 0.02 & 100 & @xmath138 + 240 & 17106 & 692 & 10 & 10.72 & 0.03 & 100 & @xmath139 + 480 & na & na & na & 200.67 & 0.03 & 100 & na + 960 & na & na & na & 5096.7 & 0.3 & 100 & na +    on the same dataset we run the greedy version of sbix starting from the configuration predicted by neighbor joining , and recorded the running time in seconds . in table",
    "[ tab : times ] we displays the comparison of the two algorithms",
    ". we did not display results for sbix at @xmath129 , the execution time being so tiny ( order of milliseconds ) that the measure would be strongly unreliable and basically dominated by input - output operating system tasks .",
    "we also do not present results for mrbayes at @xmath130 , since each run would require a time larger than 32 hours .",
    ", scaledwidth=55.0% ]    in figure  [ fig : sbix_vs_mb ] we plot the average running time per sample as a function of @xmath60 for both algorithm .",
    "we fitted mrbayes result with a simple power - law @xmath140 obtaining as best fit @xmath141 , @xmath142 , @xmath143 .",
    "the sbix curve can be fitted with a simple fourth power behavior @xmath144 , and the best fit value is @xmath145 .",
    "such a small prefactor allows sbix to be faster than mrbayes to @xmath146 , despite the larger exponent ( 4 vs. 2.9 ) .",
    "note that : ( i ) the running times at the crossing point are of the order of the thousand of years , and ( ii ) hardly a @xmath147 leaves genealogy could be of any interest .      in the previous section we outlined the analysis of the computational complexity as a function of the number of taxa in the genealogy . in the paper we presented the accuracy of the different algorithms fixing the number of taxa ( @xmath84 ) and varying the mutation rate per site @xmath99 .",
    "while the running time of other algorithms ( nj , fastme , sbix greedy ) do not depend on the mutation rate , the running time required by mrbayes depends critically on it . in order to obtain a fair sampling of the space of trees we have run a number of preliminary simulations in order to have a quantitative estimate of the convergence time of the algorithm ( the so - called _ burn - in _ time ) .",
    "then we considered a measuring time either @xmath148 or @xmath149 monte carlo steps depending on the mutation rate ( and on the burn - in time ) . in table",
    "[ tab : mc ] we display the burn - in and measure times for the different values of the mutation rate .",
    "for each of the point we analyzed 100 different samples .",
    "the convergence time in the high mutation rate regime ( @xmath150 ) might be still too small , and for some of the samples the mcmc might not have reached convergence . in order to guarantee convergence for all samples one should double the burn - in time , requiring a time too long for our computational resources .",
    "& & & + 0.003 & 50000 & 50000 & 1300 + 0.006 & 50000 & 50000 & 1300 + 0.012 & 50000 & 50000 & 1300 + 0.024 & 50000 & 50000 & 1300 + 0.048 & 50000 & 50000 & 1300 + 0.070 & 50000 & 50000 & 1300 + 0.100 & 100000 & 100000 & 2600 + 0.140 & 100000 & 100000 & 2600 + 0.200 & 300000 & 100000 & 5200 + 0.280 & 300000 & 100000 &",
    "5200 + 0.350 & 500000 & 100000 & 7800 + 0.400 & 700000 & 100000 & 12400 +",
    "the authors wish to thank simone pompei , francesca colaiori , ciro cattuto and damin h. zanette for many interesting discussions and suggestions .",
    "this research has been partly supported by the tagora and atacd projects funded by the european commission under the contracts ist-34721 and 043415 .",
    "bordewich , magnus and gascuel , olivier and huber , katharina t. and moulton , vincent 2009 .",
    "consistency of topological moves based on the balanced minimum evolution principle of phylogenetic inference .",
    "ieee / acm trans .",
    "bioinformatics * 6*(1):110117 .",
    "simonson , a.  b. , j.  a. servin , r.  g. skophammer , c.  w. herbold , m.  c. rivera and j.  a. lake . 2005 .",
    "decoding the genomic tree of life .",
    "proceedings of the national academy of sciences of the united states of america * 102*:66086613 ."
  ],
  "abstract_text": [
    "<S> in many interesting cases the reconstruction of a correct phylogeny is blurred by high mutation rates and/or horizontal transfer events . as a consequence a divergence arises between the true evolutionary distances and the differences between pairs of taxa as inferred from available data , making the phylogenetic reconstruction a challenging problem . </S>",
    "<S> mathematically this divergence translates in a loss of additivity of the actual distances between taxa . in distance - based reconstruction methods , two properties of additive distances </S>",
    "<S> were extensively exploited as antagonist criteria to drive phylogeny reconstruction : on the one hand a local property of quartets , i.e. , sets of four taxa in a tree , the four - points condition ; on the other hand a recently proposed formula that allows to write the tree length as a function of the distances between taxa , the pauplin s formula . here </S>",
    "<S> we introduce a new reconstruction scheme , that exploits in a unified framework both the four - points condition and the pauplin s formula . </S>",
    "<S> we propose , in particular , a new general class of distance - based stochastic local search algorithms , which reduces in a limit case to the minimization of the pauplin s length . </S>",
    "<S> when tested on artificially generated phylogenies our stochastic big - quartet swapping algorithmic scheme significantly outperforms state - of - art distance - based algorithms in cases of deviation from additivity due to high rate of back mutations . a significant improvement is also observed with respect to the state - of - art algorithms in case of high rate of horizontal transfer . </S>"
  ]
}