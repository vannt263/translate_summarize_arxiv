{
  "article_text": [
    "the kalman filter is an efficient algorithm for fitting tracks in particle spectrometers with many position - sensing detectors @xcite .",
    "it cures many of the problems of traditional @xmath1 track fitting using newton steps , which becomes more and more unwieldy as the number of position measurements increases . in such situations where kalman filtering is naturally applied ,",
    "it can be possible to detect and characterize track _ breakpoints _ , defined as locations where one or more of the track parameters is discontinuous .",
    "obvious breakpoints , such as a large kink due to a particle decay , are often found before a full track fit is performed .",
    "more subtle breakpoints may only manifest themselves when the track is fit to obtain the track parameters .",
    "frhwirth@xcite has investigated the detection of breakpoints using information which is a natural by - product of a kalman filter track fit . when fitting a drift - chamber track with @xmath2 position measurements ( `` hits '' ) , the idea has been the following . at the location of hit",
    "@xmath3 , one has the best - fit track parameters ( a ) using hits 1 through @xmath3 and ( b ) using hits @xmath4 through @xmath2 .",
    "one constructs a @xmath1 for the consistency of these two sets of track parameters .",
    "this @xmath1 , along with other @xmath1 s at hand from the two fits , can be combined to form test statistics for breakpoints .",
    "such methods suffer a loss of power because of two defects .",
    "first , @xmath1 s by construction throw away information about the arithmetic signs of differences ; such information is relevant since a track s momentum should normally _ decrease _ when the particle decays .",
    "second , appropriate constraints of a breakpoint hypothesis are not incorporated .",
    "for example , if a particle decays at hit @xmath3 , a desired quantity is the mismatch in track parameters describing the _ momentum _ vector , _ under the constraint _ that the track _ position _ vector from fits ( a ) and ( b ) is identical .    in this paper",
    ", we describe a procedure which uses information from the kalman filter fit to construct the result of a _ full _ track fit which has additional track parameters to account for the discontinuities at a breakpoint .",
    "it is natural to allow for one , two , or three discontinuous parameters in order to describe different physical processes :    * type i : * an electron emitting a bremsstrahlung photon generally changes only its momentum _ magnitude _ , since the photon is essentially collinear with the electron direction .    *",
    "type ii : * a particle with a hard elastic scatter may have momentum magnitude essentially unchanged , while changing the two angles specifying direction .",
    "* type iii : * a charged pion or kaon decaying to @xmath5 in general changes momentum magnitude as well as the two angles .    with the method",
    "we describe , trial breakpoint fits at every hit ( away from the ends ) of the track can be quickly obtained , and used to search for and characterize breakpoints .",
    "billoir @xcite has investigated type ii breakpoints , performing fits which do not assume an existing breakpointless fit .",
    "we show in this paper how the by - products of a kalman filter fit allow one to avoid refitting the hits while incorporating the constraints .",
    "we discuss these tools in the context of the nomad @xcite neutrino experiment at cern , within which this development took place .",
    "however , the results are generally applicable to any experiment in which the number of position measurements is large enough to fit the track on both sides of the potential breakpoint .    in sec .",
    "[ sec : param ] we introduce some notation and describe our track parameters and track models , including energy loss . in sec .",
    "[ sec : fit ] a review of the traditional ( non - kalman ) track fit is given .",
    "[ sec : kalman ] describes its replacement by the kalman filter . in sec .",
    "[ sec : earlier ] , we briefly review previous work on breakpoint variables . in sec .  [",
    "sec : additional ] , we introduce the new breakpoint variables , and in sec .  [",
    "sec : results ] , we present some indicative results of their use . we conclude in sec .",
    "[ sec : conclusion ] .",
    "when fitting a track , one typically describes its location in 6d phase space by choosing a fixed reference surface ( a vacuum window , chamber plane , etc . ) and then fitting for the 5 independent parameters of the track at the position _ where the track intersects this surface_. we let the vector @xmath6 contain these track parameters . in a fixed - target experiment with beam direction along the @xmath7 axis , the parameterization of @xmath6 is often taken to be @xmath8 at a reference plane at fixed @xmath7 , where @xmath9 is the charge / momentum .",
    "nomad is a fixed - target experiment with drift chamber planes perpendicular to the @xmath7 direction ( nearly aligned with the neutrino beam ) .",
    "however , the chambers are immersed in a uniform magnetic field , @xmath10 , and @xmath11 . ] , so that soft tracks often loop back , and a helical parameterization similar to collider experiments is more appropriate .",
    "we maintain the reference surface as a plane with fixed @xmath7 ( the @xmath7 of the first hit of the track ) , and specify a track there by @xmath12 where we have introduced the three parameters of a helical curve in the uniform magnetic field : the signed has a sign opposite to the particle charge .",
    "] inverse radius of curvature @xmath13 , the dip angle @xmath14 , and the angle of rotation @xmath15  ( see fig .  [",
    "fig : helix_params ] ) .",
    "in addition to these 5 traditional parameters , nomad has a sixth parameter , the zero - time - offset for the drift chamber measurements , called @xmath16 .",
    "it has been introduced because of trigger time jitters . in the following , unless specified otherwise , _ track parameters _ will refer to this second parameterization .",
    "the parameter @xmath13 is related to the momentum @xmath17 by @xmath18 while the sign of ( @xmath13 ) only reflects the particle charge if the time runs the right way along the track . in nomad",
    "the sign convention we used implied that the product @xmath19 increases with time along the assumed time direction given by the ordering of the measurements along the track .    throughout our work ,",
    "we use a change in @xmath13 as an indicator of a change in @xmath17 ; this is strictly true only when the change in @xmath20 is negligible , but is an adequate approximation .",
    "( inhomogeneity in the magnetic field b does not matter , since we compare @xmath13 estimates at the same point . )    with this parameterization , the three physical processes enumerated in the introduction have the following breakpoint signatures :    * type i : * an electron emitting a bremsstrahlung photon has a discontinuity in @xmath13 .    *",
    "type ii : * a pion with a hard elastic scatter has discontinuities in @xmath20 and @xmath15 .    *",
    "type iii : * a charged pion or kaon decaying to @xmath5 has discontinuities in @xmath13 , @xmath20 , and @xmath15 .    from the estimation of the track parameters at the reference plane",
    "one needs a transformation , called the track model , with which one computes the expected measurements at any position in the detector .",
    "this model describes the dependence of the measurements on the initial values in the ideal case of no measurement errors and of deterministic interactions of the particle with matter .",
    "use of a correct description is of the utmost importance for the performance of the fitting procedure , be it traditional or not .",
    "the trajectory of a charged particle in a ( static ) magnetic field is determined by the following equation of motion : @xmath21 where @xmath22 is the position vector , @xmath23 is the path length , @xmath3 is a constant of proportionality , @xmath24 is the ( signed ) charge of the particle , @xmath17 is the absolute value of its momentum , and @xmath25 is the static magnetic field .    with our parameterization",
    "it proved convenient to use @xmath15 as the running parameter rather than @xmath7 since particles may loop back in the detector and cross the same measurement plane several times .",
    "the equation of motion can be readily integrated along a trajectory step ( from position 0 to position 1 ) where @xmath26 and @xmath27 are assumed constant .",
    "@xmath28 in the last equation , @xmath29 is the particle velocity and @xmath30 has the right sign following our convention .    in nomad ,",
    "detector measurement planes are located at fixed @xmath7 and eqn .",
    "[ eqn - sinphi ] can be solved , @xmath31 to obtain @xmath32 at the desired @xmath7 . in practice , among all the possible solutions , our track model returns the one corresponding to the next crossing in the requested time direction .",
    "the magnetic field strength varies by a few percent in the tracking volume .",
    "this was accommodated by ignoring the minor components of the field and updating @xmath13 at every tracking step so that the product @xmath33 remains constant , up to energy losses which are now discussed .",
    "the ionization losses are accounted for by updating @xmath13 at every tracking step : @xmath34 where @xmath35 , and where @xmath36 is given by the bethe - bloch equation , evaluated ( by default ) with the pion mass , and a local matter density extracted from the detector model used in the geant @xcite simulation of the experiment . in the central tracker part of the detector , the matter density is about 0.1 g/@xmath37 : the ionization loss model does not need to include detailed relativistic corrections .    in nomad",
    ", bremsstrahlung losses should be accounted for ( on average ) in the track model for electron tracks , because the central tracker amounts to about 1 radiation length ( @xmath38 ) . in the electron",
    "( and positron ) track model , one adds to the ionization losses ( evaluated with the electron mass ) bremsstrahlung losses :    @xmath39    where we can readily approximate @xmath40 . as expressed , these losses include the whole radiated photon spectrum , although beyond a certain threshold , the radiated photons can be detected in the downstream electromagnetic calorimeter , or sometimes as a conversion pair in the tracker .",
    "but no convincing way was found to define a threshold that separates continuous small losses from accidental big ones .",
    "given the track model and an estimate ( @xmath41 ) of the parameters at the reference position , one can compute at each measurement location in the detector ( labeled @xmath42 ) the theoretical `` _ ideal measurements _ '' which would be made in the absence of fluctuations due to the two categories of `` noise '' : process noise ( multiple scattering , bremsstrahlung , etc . ) and measurement noise ( detector resolution ) .",
    "this computation is represented by the system equation in the absence of noise , @xmath43 where @xmath44 is a deterministic function ( the track model ) giving the values of the parameters at each location @xmath3 .    in general",
    "the set of parameters @xmath45 is not measured directly by the apparatus ; only a function of it , @xmath46 , is observed .",
    "( in our case @xmath47 is a drift chamber position measurement . )",
    "let @xmath48 be the measurement equation where @xmath49 represents the measurement errors . by convention , @xmath50 and @xmath51 .",
    "in practice , one has to check that the track model ( involved in the calculation of @xmath45 ) and the measurement function @xmath47 fulfill this convention .    in a traditional ( non - kalman ) track fit ,",
    "one calculates the @xmath2@xmath52@xmath2 covariance matrix of the measurements is to make clear which vector it corresponds to ; this will be the convention in this paper . ] :    @xmath53    where the angle - brackets represent an average over an ensemble of tracks with the same track parameters @xmath6 . according to the gauss - markov theorem , the minimization of @xmath54^{-1}\\             \\left ( { \\mathbf{m}}- { \\mathbf{h}}({\\mathbf{x}})\\right ) \\ ] ] yields parameter estimates with minimum variance among all linear unbiased estimates .    note that when the parameter evolution is not affected by any stochastic noise ( as assumed by eq .",
    "[ eqn : sys ] ) , @xmath55 is diagonal ( at least block diagonal , if the apparatus provides multidimensional correlated measurements ) , and may depend weakly on @xmath6 via the detector response ( for example , the spatial resolution of drift chambers depends on the track angle w.r.t the anode plane ) .",
    "the system equation becomes non deterministic when the track experiences stochastic processes such as multiple scattering , bremsstrahlung or ionization losses .",
    "the system equation ( eq .  [ eqn : sys ] ) becomes : @xmath56 where @xmath57 is a random vector representing the fluctuation of the parameters along the path from location 0 to location @xmath3 .",
    "process noise _ translates , via the track model , into off - diagonal elements in @xmath58 ( the noise from location @xmath59 to @xmath3 depends on the noise from location @xmath59 to @xmath60 and @xmath60 to @xmath3 ) .",
    "more importantly , @xmath58 now depends on the reference location @xmath61 at which the parameters will be estimated .",
    "of course the average value of the perturbing effects have to be included in @xmath62 but the fluctuations ( e.g. track scattering or energy loss straggling when relevant ) have to be described by the p.d.f of @xmath57 .",
    "in fact only the covariance matrix of the @xmath57 is needed in practice .",
    "( see sec .",
    "[ sec : kalman ] . )    given particular data @xmath63 , the track fit consists in finding the value of @xmath6 which minimizes eq .  [ eqn : chifull ] .",
    "minimization is typically an iterative process with some convergence criteria to decide when to stop iterating .",
    "the matrix @xmath58 can be calculated by monte carlo techniques or sometimes analytically .",
    "if one is fortunate , the calculation depends only weakly on @xmath6 , so it can be done once per fit using the initial guess for @xmath6 , and not changed at each iteration .",
    "note that the @xmath2@xmath52@xmath2 matrix @xmath58 must be inverted , where @xmath2 is the number of measurement positions .",
    "let @xmath64 ( written without explicit argument @xmath6 ) be the minimum value after convergence of the minimization procedure and @xmath65 the value of the estimated parameters ( the value of @xmath6 at the minimum ) .",
    "the covariance matrix of the estimates is then approximated by the inverse of the curvature matrix at the minimum : @xmath66^{-1}\\ ] ]    a traditional fit gives the track parameters @xmath65 _ only _ at the _ fixed _ reference @xmath61 , say at the beginning of the track . in order to find the best - fit track parameters at the _ end _ of the track",
    ", one has to recompute @xmath58 using the new reference and perform a completely independent fit . due to multiple scattering ,",
    "the results of two fits using different reference @xmath61 s are _ not _ related by the track model , and can not be obtained from one another .",
    "this effect is already present in a perfectly linear ideal case , where the detector resolution does not depend on @xmath6 .",
    "it just reflects the fact that the weights of measurements to estimate the track parameters depend ( eventually strongly ) on @xmath61 .",
    "this is unfortunate , since in practice , track extrapolation is often desired from both ends of the track .",
    "furthermore , optimal track estimates at every possible sensor position can be quite useful , either to detect outliers efficiently , or to optimally collect hits left over during a first pass .",
    "finally , if one attempts such a traditional track fit in an experiment with large @xmath2 ( such as nomad , where @xmath2 ranges up to 150 ) @xmath2 can be too big to make inversion of @xmath58 practical .",
    "given these difficulties , in nomad the kalman filter was implemented instead @xcite .",
    "the kalman filter is a least - squares stepwise parameter estimation technique .",
    "originally developed in the early 60 s to predict rocket trajectories from a set of their past positions , it can be used to handle multiple scattering while estimating track parameters .",
    "we try here to briefly shed light on the features of the kalman filter for track fitting and refer to the literature for more details  @xcite .",
    "the kalman filter technique gives , mathematically speaking , exactly the same result as a standard least squares minimization . in the framework of track fitting",
    ", it essentially avoids big matrix inversion and provides almost for free an optimal estimate of track parameters at any location , allowing the detection of outlying measurements , extrapolation and interpolation into other subdetectors .",
    "the set of parameters @xmath6 is called the state vector in kalman filtering .    starting from eq .",
    "[ eqn : sysb ] we rewrite the system equation in a stepwise form , where the state vector at location @xmath3 is obtained from its value at previous location @xmath60 .",
    "@xmath67    we shall assume in the following that both @xmath57 and @xmath49 ( the measurement errors from eq .",
    "[ eqn : meas ] ) are independent random variables with mean 0 and a finite covariance matrix .",
    "linearizing the system in the vicinity of @xmath68 , one obtains : @xmath69 @xmath70 for the track model and the measurement equation .",
    "we can now recall keywords used in the kalman filter estimation technique :    * * prediction * is the estimation of the state vector at a  future \" time , that is the estimation of the state vector at time or position ( @xmath4 ) using all the measurements up to and including @xmath71 . * * filtering * is estimating the  present \" state vector based upon all present and  past \" measurements . for _ forward _ filtering , this means estimating track parameters at @xmath3 using measurements up to and including @xmath71 . for _",
    "backward _ filtering , this means estimating track parameters at @xmath3 using the measurements @xmath72 down to @xmath71 . *",
    "* filter . * the algorithm which performs filtering is called a filter and is built incrementally : filtering @xmath73 to @xmath71 consists in filtering @xmath73 to @xmath74 , propagating the track from @xmath74 to @xmath71 and including @xmath71 .",
    "a filter can proceed forward ( @xmath3 increases ) or backward ( @xmath3 decreases ) . * * smoothing * means using all the measurements to provide a track parameter estimate at any position .",
    "the smoothed estimate can be obtained as a weighted mean of two filtered estimates : the first one using @xmath73 to @xmath71 ( forward ) , the other using @xmath72 to @xmath75 ( backward ) . ; averaging these would lead to double - counting the information from @xmath71 .",
    "hence , to be proper , one must unfilter @xmath71 from one of the estimates .",
    "this small correction is implemented in our smoother and in the quantity @xmath76 discussed below , but was deemed negligible and never implemented in the other breakpoint quantities . ]",
    "one can understand the basic idea of the kalman filter in the following way .",
    "if there is an estimate of the state vector at time ( location ) @xmath77 , it is extrapolated to time @xmath78 by means of the system equation .",
    "the estimate at time @xmath78 is then computed as the weighted mean of the predicted state vector and of the actual measurement at time @xmath78 , according to the measurement equation .",
    "the information contained in this estimate can be passed back to all previous estimates by means of a second filter running backwards or by the smoother .",
    "the main formulas for our linear dynamic system are the following :    * system equation : * @xmath79 @xmath80    * measurement equation : * @xmath81 @xmath82 where the matrices @xmath83 and @xmath84 represent the process noise ( multiple scattering , bremsstrahlung , etc . ) and measurement noise ( detector resolution ) respectively .",
    "the details of @xmath83 calculation for the parameterization adopted in nomad can be found in ref .",
    "@xcite . + as an example we include here the formulas for making a prediction :    * extrapolation of the state vector : + @xmath85 * extrapolation of the covariance matrix : + @xmath86 * predicted residuals : + @xmath87 * covariance matrix of the predicted residuals : + @xmath88    using the kalman filter , the computer time consumed for a track fit is proportional to the number of hits on the track , while with the traditional technique it is proportional to the cube of the same number in case of multiple scattering .",
    "after the kalman fitting procedure one has the following available information  :    * @xmath89 and @xmath90  : the forward and backward estimates of the state vector at position @xmath3 , i.e. , the estimate of the track parameters at location @xmath3 using measurements 1 up to @xmath3 ( forward ) or @xmath2 down to @xmath3 ( backward ) . *",
    "@xmath91 and @xmath92  : the minimum @xmath93 value of the forward and backward fits up to measurement @xmath3 . * @xmath94 and @xmath95  : the covariance matrices of @xmath89 and @xmath90 respectively . *",
    "@xmath96 , @xmath64 and @xmath97  : the same quantities , determined from the smoothed estimates , the equivalent of a full fit done at location @xmath3 .",
    "note that the @xmath64 minimum does not depends on the location at which the parameter are estimated ( @xmath64 for @xmath96 is independent of @xmath3 ) .",
    "thus , much information exists as the by - product of a track fit : at every hit on the track away from the ends , we have the results of three fits for the track parameters at that hit : a fit to the part of the track upstream , a fit to the part of the track downstream , and a fit to the whole track .",
    "this information is the input to breakpoint analyses .",
    "a natural way to compare @xmath89 and @xmath90 is discussed by r.  frhwirth  @xcite and was implemented in nomad tracking @xcite before developing our extensions .",
    "one simply constructs the @xmath93 of the mismatch of all the forward - backward parameters at each hit @xmath3 : @xmath98^{-1 }    \\ ( { { { \\mathbf{\\widehat{x}}}_k}^{b}}- { { { \\mathbf{\\widehat{x}}}_k}^{f}}).\\ ] ]    the value of @xmath76 is easily computed from the following relationship which holds for any @xmath3 : @xmath99    after the track fit , we find the hit @xmath3 for which @xmath76 is a maximum , i.e. , for which the forward - backward mismatch in track parameters has greatest significance ; we call this maximum value @xmath100",
    ". one can assign a breakpoint at that @xmath3 there if @xmath100 is above some threshold .",
    "frhwirth also investigated various combinations of @xmath100 with @xmath91 , @xmath92 , and degrees of freedom in the track fits , but concluded that @xmath100 was his best breakpoint test statistic @xcite .",
    "one may suspect that previously defined breakpoint tests do not make optimal use of the available information .",
    "any @xmath1 quantity is by definition insensitive to the arithmetic sign of differences , while in the processes of interest , a _ decrease _ in the momentum is expected .",
    "furthermore , @xmath76 mixes all the parameter mismatch information together .",
    "the signed forward - backward mismatch in single quantities such as @xmath13 can be examined , but it has the problem that the other 5 parameters are not constrained to be the same .",
    "( physical changes in @xmath13 can result , for example , in fitted mismatches in @xmath15 as well as @xmath13 . ) finally , an optimal test should use a more fully developed breakpoint hypothesis , so that a more meaningful comparison of @xmath1 s , with and without breakpoints , can take place .      here",
    "we show how to obtain and examine the result that one would get by doing a traditional fit which uses _ all _ hits , _ but which allows a subset of the track parameters to be discontinuous _ at a particular hit @xmath3 .",
    "we parameterize the full track with 1 to 3 added parameters in order to incorporate breakpoints of types i , ii , and iii at hit @xmath3 .",
    "e.g. , for type i , we replace the parameter @xmath13 by two parameters , a forward value @xmath101 just before hit @xmath3 and a back value @xmath102 just after hit @xmath3 .",
    "thus , our fits to the 3 breakpoint types have 7 , 8 , and 9 parameters , respectively .",
    "we denote these sets with breakpoints by @xmath103 rather than @xmath6 , and they are , respectively for the three types : @xmath104    for definiteness , we discuss here the concept in terms of a type i breakpoint .",
    "one can imagine a cumbersome procedure whereby one puts a type i breakpoint at a _ particular _ hit @xmath3 , and performs a traditional @xmath1 track fit ( with 7 parameters in our case ) to _ all _ the hits of the track , minimizing the full type i track s @xmath1 , which we call @xmath105 one would obtain the best estimate of @xmath106 , its covariance matrix , and the minimum value of @xmath107 , all for a breakpoint at that particular hit @xmath3 .",
    "one could then repeat this for each possible value of @xmath3 , obtaining numerous potential track - with - breakpoint fits .",
    "essentially _ the same set of results _ can be obtained far more economically by starting from the results @xmath89 and @xmath90 at each @xmath3 which _ already exist _ as by - products of the kalman filter fit .",
    "these results carry all the information that we need , since their error matrices contain the information ( up to linear approximation ) on how @xmath91 and @xmath92 change when the track parameters change .",
    "we need only perform a linear @xmath93 minimization in which @xmath108 ( now playing the role of the `` measured data '' ) is compared to the type i breakpoint model prediction @xmath109 .",
    "@xmath110 is the model matrix with 12 rows and 7 columns containing only zeros and ones  :    @xmath111    or , introducing the two @xmath112 submatrices @xmath113 and @xmath114 of @xmath110  : @xmath115    since our 12 pieces of `` measured data '' @xmath108 are two independent sets of 6 parameters with their corresponding covariance matrices , the appropriate chisquare can be written as  : @xmath116^{-1 } \\ ( { { { \\mathbf{\\widehat{x}}}_k}^{f}}- h^f { \\mbox{\\boldmath$\\alpha$ } } )    \\nonumber \\\\    + & ( { { { \\mathbf{\\widehat{x}}}_k}^{b}}- h^b { \\mbox{\\boldmath$\\alpha$}})^t \\ [ { v^{({\\mathbf{\\widehat{x}}}_k , b)}}]^{-1 } \\ ( { { { \\mathbf{\\widehat{x}}}_k}^{b}}- h^b { \\mbox{\\boldmath$\\alpha$}}).\\end{aligned}\\ ] ] ( here and below , we suppress the subscript i since the equations are true for all breakpoint types , with eqns .  [ eqn : preddef ] and [ eqn : alphadef ] suitably changed . )    the full @xmath93 of eq .",
    "[ eqn : chifullsevenk ] can be written as  : @xmath117^{-1 } ( \\mathbf{m } - \\mathbf{h}\\left ( h { \\mbox{\\boldmath$\\alpha$}}\\right ) ) \\label{eqn : fullchi2k}\\ ] ] where @xmath118 is the block diagonal matrix containing the covariance matrix @xmath119 of the measurements @xmath120 and the covariance matrix @xmath121 of the measurement @xmath122 .    as shown in appendix  [ app - chisum ] , @xmath123 of eqn .",
    "[ eqn : chifb ] is related to @xmath124 of eqn .",
    "[ eqn : fullchi2k ] in a revealing way . at each hit @xmath3 ,",
    "@xmath125 subject to sufficient linearity in the fits .",
    "thus by finding the minimum of @xmath123 , we find the minimum of @xmath124 , since @xmath91 and @xmath92 are known .",
    "the minimum of @xmath123 is obtained _ without iteration _ since the model relating @xmath103 to @xmath108 is linear .",
    "the set of estimated parameters is given by  : @xmath126 where @xmath127 ; @xmath128 is the block diagonal matrix containing @xmath94 and @xmath95 ; and where the covariance matrix for the new estimate , @xmath129 , is given by  : @xmath130^{-1}.\\ ] ] the value of @xmath76 at its minimum is @xmath131    since the elements of @xmath132 are mostly 0 , and the rest equal to 1 , the multiplications by @xmath132 and @xmath133 were done by hand before coding the software ; elements of @xmath134 have only one or two simple terms .",
    "the computer time to perform the type i , ii , and iii breakpoint fits at all hits @xmath3 ( away from the track ends ) was a negligible addition ( few per cent ) to the nomad track finding and fitting software .",
    "this added time was more than paid back by the speedup in matrix inversion which was obtained by explicitly unrolling the loops in the dsinv routine from cernlib  @xcite .      from the wealth of information thus available at each hit , we discuss two of the most useful categories : 1 ) signed differences , in sigma , of breakpoint parameters , and 2 ) @xmath1 comparisons based on the fisher @xmath0-test .    as an example , for type iii breakpoint fits , we let @xmath135 be the forward - backward difference in @xmath13 , divided by its standard deviation ( sigma , computed from the covariance matrix taking account of errors in both quantities and their correlations ) .",
    "this _ signed _ quantity effectively gives the significance , in sigma , of the jump in momentum at that hit .",
    "similar quantities , with analogous notation , are calculated for all components of @xmath103 , for all breakpoint types .",
    "thus , for bremsstrahlung studies , @xmath136 gives the momentum change _ under the constraint that all other track parameters are continuous at hit @xmath3_.    the _ fisher @xmath0 statistic _",
    "@xcite is appropriate for testing if adding parameters yields a statistically significant reduction in the @xmath1 of a fit .",
    "it is simply the ratio of the respective @xmath1/dof for the two versions of the fits .",
    "thus we naturally apply it to our track fits with and without breakpoint parameters . for example",
    ", for nomad s type i fits , we have at each hit , @xmath137 we similarly define @xmath138 and @xmath139 .    for a true breakpoint at a _ given _ hit @xmath3 , each @xmath0 statistic in principle obeys the standard significance - table distributions @xcite .",
    "however , we normally search through all hits in a track for the lowest value of @xmath0 , denoted @xmath140 .",
    "this lowest value does not of course follow the usual significance - table values . hence , as a practical matter , we use data or monte carlo events to measure the distribution of @xmath140 and the effect of tests based on it .",
    "the effectiveness of any breakpoint search is of course highly dependent on details of hardware ( e.g. , number and quality of the position measurements ) and software ( e.g. , how many tracks with breakpoints are reconstructed as a single track ) .",
    "we present for illustration some experience with the nomad detector , using both simulated and real data events .",
    "algorithms developed for electron identification and reconstruction have been checked under running conditions using @xmath141-electrons produced by straight - through muons ( 5 gev @xmath142 gev ) crossing the nomad detector during slow - extracted beam between neutrino spills .",
    "this sample of selected electrons from real data can be used to check the subdetector responses compared to simulations and to tune breakpoint search criteria taking into account the effect of the drift chambers alignment quality ( see fig .",
    "[ fig : ele_rd ] ) .",
    "a special approach to deal with electrons emitting bremsstrahlung photons ( type i breakpoints ) in the nomad detector has been developed  @xcite .",
    "if one has identified a reconstructed track in drift chambers as being an electron , then hard bremsstrahlung photons can be looked for and neutral tracks can be created requiring further matching with preshower and electromagnetic calorimeter",
    ". a successful application of this approach to an event from real data is shown in fig .",
    "[ fig : ele_brem_1 ] and fig .",
    "[ fig : ele_brem_2 ] .",
    "a recursive breakpoint search algorithm has been applied to a track identified as an electron . as a result two breakpoints",
    "have been found , each associated with an observed hard bremsstrahlung photon ( one of which converts to a reconstructed @xmath143 pair ) .",
    "when applying the breakpoint search algorithm to an electron track one must keep in mind a potential problem related to a possible presence of several kinks along the trajectory ( since it can bias the calculation of variables used for the breakpoint search ) .",
    "details are in ref .",
    "@xcite .      as another example of using the breakpoint variables described in sec .",
    "[ sec : variables ] , we compare several tests for detecting the type iii breakpoint ( discontinuity of @xmath13 , @xmath20 , and @xmath15 ) of the decay @xmath144 , and for locating the position of the decay .",
    "the results shown here are for monte carlo ( mc ) simulation @xcite of muon neutrino interactions in the nomad detector . from the collaboration s standard mc samples , we selected two samples of reconstructed tracks :    * 25000 pions which did not decay and which were reconstructed .",
    "* 2000 pions which did decay via @xmath144 , and for which a _ single _ track was reconstructed consisting of hits left by _ both _ the pion and the muon .",
    "neither of these two samples contains the pion decays which were broken into separate tracks by the track - finding algorithm , with a vertex assigned at the decay point .",
    "the selected tracks were chosen to have more than 20 hits ( @xmath145 ) and no backward looping , and with the mc pion decays within these hits .",
    "track - finding mistakes ( for example use of hits from other tracks in the event ) were included , but to obtain the pion track , we required that at least 90% of the hits be correctly assigned .",
    "figure  [ fig : mom ] contains histograms of momentum@xmath52charge for the two samples . in order to have samples with similar momenta",
    ", we consider here only tracks with momentum less than 6 gev .",
    "figure  [ fig : by_hit ] shows , for one of the decaying negative pion tracks , the values of @xmath76 , @xmath139 , @xmath135 and @xmath146 at every hit where they are computed .",
    "they are plotted at the @xmath7-positions of the hits , which in the nomad detector are every few cm .",
    "the decay point in the mc is indicated by the line at 360 cm .",
    "the dotted lines are at the @xmath7-positions of the extreme values ( maximum or minimum , as relevant for a breakpoint ) of the respective variables . near the mc decay point , both @xmath76 and @xmath139 reach their extreme values , indicating respectively : a large forward - backward mismatch in the kalman fits , and a marked improvement in the track @xmath1 by adding a three - parameter breakpoint .",
    "the sign of the change in @xmath13 corresponds to a decrease in momentum , as expected in a decay .",
    "@xmath146 also shows an extremum near the breakpoint ; however , we have generally not used it as the primary breakpoint indicator .      for testing the existence of a breakpoint , we compare the following test statistics :    * @xmath147 for the breakpointless fit .",
    "( this test gives no additional information on the location of the breakpoint . ) * @xmath100 .",
    "the breakpoint is located at the maximum value of the forward - backward mismatch chisquare ( @xmath76 ) for breakpointless fit among hits in the track ; * @xmath140 .",
    "the breakpoint is located at the minimum value fisher @xmath0 among hits in the track ( applicable separately to the different breakpoint types if desired ) . *",
    "@xmath148 combined with the forward - backward mismatch in radius of the curvature @xmath135 or angle @xmath146 .",
    "@xmath148 gives the breakpoint location and @xmath135 , @xmath146 are computed at that location .",
    "[ fig : chi2_chi7_chi8_chi9 ] contains histograms of @xmath149 , @xmath150 , @xmath151 , and @xmath152 for decaying and non - decaying pions , with the means shown .",
    "the @xmath147 is in general reduced by adding breakpoint parameters .",
    "a measure of the significance of the improvement is the fisher @xmath0 ( eq .  [ eqn : fisher7 ] ) , which is shown in fig .",
    "[ fig : chi2_fchisq789 ] for the same fits . also shown in fig .",
    "[ fig : chi2_fchisq789 ] is a histogram of @xmath100 , the maximum forward - backward mismatch from the breakpointless fit .    from the histograms in fig .",
    "[ fig : chi2_fchisq789 ] , one can calculate the efficiency of labeling tracks as pion decays using `` cuts '' on these variables .",
    "for tabulating a comparison , we choose a cut value for @xmath140 such that 10% of non - decaying pions are falsely called pion decays .",
    "we then find the efficiency for identifying real pion decays , i.e. , the percentage of pion decay tracks which are called pion decays when using the same cut value .",
    "this cut value in principle depends on the dof , but for illustration we use the same cut value for all track lengths .",
    "the results are given in the first five columns of table  [ tab : chi2_fchisq789 ] .",
    "we include for comparison the result for testing for pion decay simply by using @xmath149 , i.e. , the test one would naturally use if one had only a traditional non - kalman track fit . as observed by frhwirth @xcite , this test is quite competitive with the @xmath100-test for detecting the existence of a breakpoint , even though it gives no information about the location .",
    "the highest efficiency is obtained using @xmath148 .",
    "we find this to be true for various other comparisons , although one is cautioned that the particular efficiencies listed are for the sample of decaying pions which were not detected by the standard track finding / fitting , and are hence expected to be highly experiment - dependent .",
    ".efficiency of the detection of pion decays , using the various test statistics .",
    "the first five columns are for simple cuts on the respective variables .",
    "the last column is for a cut on a 2d likelihood - ratio test for @xmath148 vs @xmath135 described in the text .",
    "the cut value for each test is chosen so that 10% of non - decaying pions are wrongly called decays .",
    "the efficiency is computed with respect to the sample which contains only tracks which were not detected as decaying by the original track - finding / fitting algorithms . [ cols=\"^,^,^,^,^,^\",options=\"header \" , ]     next we add the signed information available in the new fits : the difference in radius of curvature @xmath135 , and/or the angular differences @xmath146 and @xmath153 . we recommend that @xmath135 not be used to locate the breakpoint , but rather we evaluate this difference at the location dictated by @xmath148 .",
    "[ fig : fchisq9_diff9rm1 ] contains scatter plots of @xmath148 vs @xmath135 for decays and non - decays . because true decays have a decrease in momentum , a judicious cut on this scatter plot is more effective than a cut solely on @xmath148 .",
    "an even more powerful technique is to construct likelihood functions based on these 2d densities , and use the constructed likelihood ratio as a test of pion decay .",
    "the result of such a procedure ( applied with simple smoothing of the 2d densities , and tested on an independent sample ) is given in the last column of table  [ tab : chi2_fchisq789 ] .",
    "the improvement over previous breakpoint tests @xcite is most significant . nearly as good efficiencies are obtained from scatter plots of @xmath148 vs @xmath146 ( also shown in fig .",
    "[ fig : fchisq9_diff9rm1 ] ) , and from @xmath148 vs @xmath153 .",
    "one may also ask which of the variables gives the best determination of the location of the breakpoint .",
    "we studied in particular the difference between the mc decay point and the @xmath7 position of the hit corresponding to the extrema @xmath100 or @xmath148 .",
    "these are histogrammed in fig .",
    "[ fig : res ] for pions which decay .",
    "the white histograms show the resolution for the initial samples , with no selection made using @xmath100 or ( @xmath148 vs @xmath135 ) .",
    "the shaded histograms show the ( more relevant ) resolutions for tracks remaining after decay selection using the respective variables .",
    "there was not a significant difference , within the limited scope of this study .",
    "replacement of mismatch chisquare for all the forward - backward parameters by the breakpoint variables introduced in sec .",
    "[ sec : variables ] can give added power to breakpoint detection in the framework of kalman filtering technique .",
    "we show in particular above that this is the case in a realistic simulation of pion decays in the nomad detector .",
    "in addition , these breakpoint variables have been successfully used to reconstruct electron hard bremsstrahlung in real data .",
    "as expected on theoretical grounds , our most powerful breakpoint detection is based on a scatter plot of a fisher @xmath0-test vs.  an appropriate signed difference of a track parameter across the breakpoint .",
    "this work was performed within the nomad collaboration and hence benefited from numerous aspects of nomad s simulation and event reconstruction codes .",
    "the authors are grateful to emmanuel gangler , kyan schahmaneche , and jean gosset for their contributions to the nomad kalman filter .",
    "we gratefully acknowledge some early investigations by mai vo @xcite on track breakpoints in nomad .",
    "99    p.  billoir , nucl .",
    "225 , 352 ( 1984 ) ;    p.  billoir , r.  frhwirth and m.  regler , nucl .",
    "a241 ( 1985 ) 115 - 131 .",
    "f.  frhwirth , `` application of filter methods to the reconstruction of tracks and vertices in events of experimental high energy physics '' , hephy - pub 516/88 ( vienna , dec .",
    "1988 )    p. billoir and s. qian , nucl .",
    "instr . meth .",
    "a294 ( 1990 ) 219 - 228 ; p. billoir and s. qian , nucl .",
    "methods a295 ( 1990 ) 492 - 500 .",
    "d.  stampfer , m.  regler and r.  frhwirth ,  track fitting with energy loss , \" comput .",
    "79 ( 1994 ) 157 - 164 .",
    "m.  regler , r.  frhwirth and w.  mitaroff , ",
    "filter methods in track and vertex reconstruction , \" j. phys .",
    "g g22 , 521 ( 1996 ) .",
    "nomad collaboration , j. altegoer et al .",
    "instr . and meth . a 404 ( 1998 ) 96 ; nomad collaboration , j.  altegoer , et al .",
    "b 431 ( 1998 ) 219 ; nomad collaboration , p.  astier , et al .",
    "b 453 ( 1999 ) 169 .",
    "geant : detector description and simulation tool , cern programming library long writeup w5013 , geant version 3.21    p. astier , a. letessier - selvon , b. popov , m. serrano , `` nomad reconstruction software : drift chamber package '' , version 5 release 2 , unpublished ( 1994 ) , and later releases with additional authors .",
    "boris popov , ph.d .",
    "thesis , u. paris vii , ( unpublished , 1998 ) .",
    "+ http://nuweb.jinr.ru/@xmath154popov",
    "mai vo , nomad collaboration communication ( unpublished , 1995 ) and ph.d .",
    "thesis , saclay , ( unpublished , 1996 ) .",
    "frhwirth refers to @xmath100 as @xmath155 .",
    "he defines a related quantity , @xmath156 , where @xmath157 is the d.o.f . for @xmath100 and @xmath158",
    "is the sum of the d.o.f . for @xmath91 and @xmath92 .",
    "frhwirth concludes that the @xmath159-test is less powerful than the @xmath155-test , and that the @xmath1 is almost as good an indicator of the existence of a kink as the @xmath155-test .",
    "cern program library routine number f012 .",
    "a modified version of the routine was used to write the source code of the unrolled loops .",
    "bevington and d.k .",
    "robinson , _ data reduction and error analysis for the physical sciences _ , ( new york : mcgraw - hill , 1992 ) , pp .",
    "205 - 209 , 261 - 267 .",
    "in eqn .  [ eqn : fullchi2k ] , @xmath118 is the block diagonal matrix containing the covariance matrix @xmath119 of the first @xmath3 measurements @xmath161 and the covariance matrix @xmath121 of the last @xmath162 measurements @xmath163 . the right - hand side of eqn .",
    "[ eqn : fullchi2k ] can thus be split into two terms : @xmath164^t\\   [ { v^{(m , f)}}]^{-1}\\left [ { { \\mathbf{m}}^{f}}- \\mathbf{h}(h^f{\\mbox{\\boldmath$\\alpha$}})\\right ] \\nonumber \\\\ & & +               \\left [ { { \\mathbf{m}}^{b}}- \\mathbf{h}(h^b{\\mbox{\\boldmath$\\alpha$}})\\right ] ^t\\   [ { v^{(m , b)}}]^{-1}\\left [ { { \\mathbf{m}}^{b}}- \\mathbf{h}(h^b{\\mbox{\\boldmath$\\alpha$}})\\right ] , \\label{eqn : chib}\\end{aligned}\\ ] ] where one recognizes , in analogy with eqn .",
    "[ eqn : chifull ] , the forward and backward @xmath93 terms .",
    "we can expand each around their respective minima @xmath89 and @xmath90 , and recall that covariance matrices are the inverse of curvature matrices , giving  : @xmath165^{-1 } \\",
    "\\delta{{\\mathbf{x}}^f}\\nonumber \\\\ & & + { \\chi^{2~(b)}_k}+ ( \\delta{{\\mathbf{x}}^b})^t \\ [ { v^{({\\mathbf{\\widehat{x}}}_k , b)}}]^{-1 } \\ \\delta{{\\mathbf{x}}^b } , \\label{eqn : chif - taylor}\\end{aligned}\\ ] ] where @xmath166 and @xmath167 . + combining this with eqn .",
    "[ eqn : chifb ] yields eq .",
    "[ eqn : chifullseven ] ."
  ],
  "abstract_text": [
    "<S> we give an overview of track fitting using the kalman filter method in the nomad detector at cern , and emphasize how the wealth of by - product information can be used to analyze track breakpoints ( discontinuities in track parameters caused by scattering , decay , etc . ) . </S>",
    "<S> after reviewing how this information has been previously exploited by others , we describe extensions which add power to breakpoint detection and characterization . </S>",
    "<S> we show how complete fits to the entire track , with breakpoint parameters added , can be easily obtained from the information from unbroken fits . </S>",
    "<S> tests inspired by the fisher @xmath0-test can then be used to judge breakpoints . signed quantities ( such as change in momentum at the breakpoint ) </S>",
    "<S> can supplement unsigned quantities such as the various chisquares . </S>",
    "<S> we illustrate the method with electrons from real data , and with monte carlo simulations of pion decays .    </S>",
    "<S> breakpoints , kalman filter , track fitting + pacs code : 07.05.kf </S>"
  ]
}