{
  "article_text": [
    "@xcite conducted a comparison project of numerical simulations of the formation of a massive cluster of galaxies in a cold dark matter ( cdm ) universe in which the results of twelve independent simulation codes were compared . both eulerian mesh codes and lagrangian smoothed particle hydrodynamics ( hereafter sph ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) codes were used in this comparison project . in this project",
    ", they took into account only gravity and hydrodynamics so that the comparison was simplified .",
    "this project is known as the `` santa barbara cluster comparison project '' .",
    "although most of global properties reasonably converged , there was a systematic difference in entropy profiles of the clusters in simulations with different methods .",
    "the results of the eulerian mesh codes showed the central core in entropy profiles , whereas those of sph codes did not ( see figure 18 in their paper ) .",
    "later studies confirmed this tendency ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "@xcite interpreted that this difference might reflect the difference in the treatment of shocks of sph and mesh codes .",
    "@xcite pointed out that there are `` fundamental differences '' between eulerian mesh and lagrangian sph codes ( see also * ? ? ?",
    "* ; * ? ? ?",
    "this difference is originated from the fact that the standard formulation of sph ( hereafter ssph , where @xmath0 and @xmath1 are the mass and density of a particle , as the discrete volume element for the discretization of the equations . ] ) has difficulties when dealing with contact discontinuities .",
    "since ssph requires the differentiability of the density field , the density around a contact discontinuity has a large error .",
    "in particular , the density of particles in the low - density side of the contact discontinuity is overestimated by a large factor .",
    "this error propagates to the pressure evaluation , resulting in the _ unphysical surface tension _ and the suppression of fluid instabilities ( see figure 1 in * ? ? ?",
    "we can solve this problem by using the volume element which does not depend on the density @xcite , by introducing extra dissipation terms @xcite , by using the integration form to evaluate the derivatives of physical quantities @xcite , by employing the non - standard equation of motion which breaks newton s third law @xcite , and by adopting the godunov sph @xcite where physical quantities are smoothed twice @xcite .",
    "@xcite used a diffusive quantity , @xmath2 , instead of the mass and mass density , to formulate the sph approximation .",
    "each particle has the @xmath3 , and from that its density is calculated using the usual formula to calculate mass density from mass of particles in sph .",
    "since all of the sph codes used in the santa barbara cluster comparison project were based on ssph , the cuspy entropy profile obtained with sph codes might be , at least partly , the artifact caused by the unphysical surface tension . in the hierarchical structure formation scenario , a cluster of galaxies grows through mergers of a number of small building blocks which contain cold , low - entropy gas .",
    "the unphysical surface tension of ssph tends to protect cold gas clumps in the building blocks against the fluid instabilities and the ram - pressure stripping , as demonstrated by the `` blob test '' of @xcite . as a result",
    ", cold clumps might reach the center of the cluster due to the dynamical friction with keeping their low entropy state , resulting in a cuspy entropy profile of the cluster .",
    "some of techniques described above have been applied to the cluster formation simulations in order to investigate their effect on the central entropy structure .",
    "@xcite added a diffusion term to the energy equation which mimics the turbulence mixing   and performed the santa barbara cluster simulations .",
    "they found that the entropy core could be formed , but the size and depth of the entropy core depended strongly on the diffusion coefficient and numerical resolutions ( see their figures 12 and 13 ) .",
    "@xcite carried out a set of comparison tests of the cluster formation in a @xmath4cdm universe with sph and an adaptive mesh refinement ( amr ) codes , focusing on the formation of the entropy core . in their comparison tests , they used not only ssph but also their new sph , sphs @xcite which avoids multivalues of physical quantities by artificial diffusion terms with a higher order dissipation switch and increases the force accuracy by adopting a higher order kernel with a large number of neighbor particles . in sphs runs ,",
    "the entropy core was formed in the cluster center and its size was consistent to that obtained by an amr code , ramses @xcite .",
    "this good agreement is achieved when the maximum dissipation parameter @xmath5 ( see their figure 6 ) . on the other hand , in the case with @xmath6 ,",
    "the entropy profile has a core , but it is smaller and the core entropy is lower than those with converged values . in the case with @xmath7 , it is close to that found with ssph .",
    "recently , @xcite reported a new comparison test of a numerical cluster in a @xmath4cdm universe .",
    "they showed that sph codes with the artificial conductivity ( hereafter ac ) term and sphs give entropy profiles which are close to those given by amrs ( i.e. , cored profiles ) , although they did not provide the results of the parameter tests .",
    "the agreement with the results of amr calculations does not guarantee the validity of the results , since eulerian schemes have their own limitations .",
    "an obvious one comes from its eulerian nature . in order to integrate the motion and internal energy of fast - moving cold gas clump",
    ", very high accuracy is required .",
    "the internal energy of a gas clump can be many orders of magnitudes smaller than its kinetic energy in the reference frame of the mesh .",
    "numerical error comes from the kinetic energy , but it affects the internal energy of the clump .",
    "consider the case that a molecular cloud moves in a galaxy following the galactic potential .",
    "the typical temperature of the cloud is @xmath8 while the virial temperature which corresponds to the typical kinematic energy is @xmath9 for a galaxy of the milky way size .",
    "the energy difference between the thermal and kinetic energies of the cloud becomes about five orders of magnitude .",
    "very high accuracy is , thus , required to keep the structure of the clump , and this requirement in turn results in the requirement of high spacial resolution and small time step .",
    "otherwise , a large error is induced by the loss of significant digits and/or negative pressure .",
    "a remedy for this problem is the dual energy formulation @xcite . in this formulation , both total ( @xmath10 ) and internal ( @xmath11 ) energies are solved independently .",
    "then , either @xmath11 or @xmath12 , where @xmath13 is the kinetic energy , is used to evaluate pressure , depending on the fraction of the thermal energy . for the high mach number fluid , e.g. , @xmath14",
    ", @xmath11 is adopted to evaluate pressure . otherwise , since @xmath15 , the loss of significant digits occurs .",
    "another difficulty is that the eulerian formulation is not the galilean invariant , which leads to the numerical diffusion .",
    "an example of this problem can be seen in figure 14 of @xcite . in eulerian codes ,",
    "an initially hydrostatic cluster decays after 1 gyr evolution , in particular in enzo @xcite with zeus @xcite and flash @xcite , when a translational velocity was added . in principle , by going to higher spatial resolution , we can reduce the rate of decay by reducing the effect of the numerical dissipation @xcite .",
    "nevertheless , compared to lagrangian codes with the same effective accuracy , the computational cost would be much higher .",
    "the other way is to adopt higher spatial order schemes , such as essentially non - oscillatory polynomial interpolation ( eno ; * ? ? ?",
    "* ) , weighted eno ( weno ; * ? ? ?",
    "* ) , and constrained interpolation profile ( cip ; * ? ? ?",
    "* ) schemes",
    ". however , these schemes are computationally expensive and it is difficult to combine high - order schemes with amr in a consistent way .",
    "the latter is serious because joint interfaces of finer and coarse meshes lose their accurracy @xcite and thus careful treatment is necessary .",
    "recently , novel numerical schemes have been developed and used in the field of numerical astrophysics .",
    "@xcite developed a moving mesh scheme which is free from the above problem of the eulerian mesh codes . in @xcite",
    ", he carried out simulations of the santa barbara cluster with `` arepo '' , an implementation of his moving mesh scheme , and reported that the entropy core was formed .",
    "the size of the core is smaller than those obtained by amr simulations and the entropy at the core is lower than those obtained by amr simulations .",
    "@xcite developed a new code `` gizmo '' which implemented a meshless method and found that in cluster simulations with gizmo entropy cores similar to those of arepo is formed .",
    "these results are quite encouraging",
    ". however these two codes use similar approaches , such as quasi - lagrangian nature using riemann solvers .",
    "further tests with different schemes are important .    in this paper",
    ", we report the results of santa barbara cluster simulations obtained with the density independent formulation of sph ( disph ) @xcite .",
    "since disph is free from the unphysical surface tension , we can expect that it gives better results compared to ssph .",
    "in addition , since disph do not introduce artificial dissipations , we can expect that the result is not affected by free parameters .",
    "the structure of this paper is as follows . in  [",
    "sec : disph ] we give a brief review of the formulation of ssph and disph and their advantages and disadvantages .",
    "we then describe the initial condition and our numerical methods in  [ sec : method ] .",
    "the comparison is carried out in  [ sec : results ] and discussion is given in ",
    "[ sec : discussion ] .",
    "in the sph method , all physical quantities are evaluated using the kernel approximation over the field discretized by particles .",
    "the kernel approximation for a physical quantity @xmath16 is given by @xmath17 where @xmath18 and @xmath19 are position vectors , @xmath20 is a function with a compact support called the kernel function , and @xmath21 is the kernel size .",
    "we approximate this spatial integration by the summation over particles expressed as @xmath22 where @xmath23 and @xmath24 are the values of @xmath16 at the positions of particles @xmath25 and @xmath26 , respectively , and @xmath27 is the volume element associated with particle @xmath26 . in ssph , we use @xmath28 where @xmath29 and @xmath30 are the mass and density of particle @xmath26 , respectively . from eqs . and , by substituting @xmath1 into @xmath16",
    ", we have @xmath31    note that eq .",
    "gives the _ smoothed _ estimate of the density field .",
    "thus , the density near a contact discontinuity suffers a very large error .",
    "consider the case that we evaluate the density around a contact discontinuity using eq .",
    "the density of a particle at the low - density side is over - estimated , while that of a particle at the high - density side is under - estimated .",
    "the absolute amount of the error is similar at the both sides .",
    "the relative error is much larger at the low - density side , simply because the true density is smaller .",
    "this large overestimate of the density results in equally large overestimate of the pressure for low - density particles near the contact discontinuity , which then causes a strong repulsive force .",
    "this repulsive force works as an unphysical surface tension ( e.g. , * ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "if the distribution of the internal energy is sufficiently smooth , this unphysical surface tension does not show up even with the smoothed density . the ac term introduced by @xcite automatically reduces the pressure jump by spreading the internal energy . .",
    "] a switch is always used to avoid unnecessary diffusion .    in disph , unlike ssph , the pressure ( or its arbitrary function ) is used to evaluate the volume element @xcite .",
    "the pressure field is smooth everywhere , except at the shock front . in sph ,",
    "the shock is handled by the artificial viscosity ( hereafter av ) which smooths the velocity field and prevents multivalues . as a by - product , we have a smoothed pressure distribution in sph simulations , even at the shock front .",
    "therefore , we can expect that the problem of ssph at the contact discontinuity is solved if we use a volume element based on the pressure .",
    "this is the basic idea of disph .",
    "the simplest form of the fundamental equation used in disph can be obtained by using the volume element @xmath32 , where @xmath33 and @xmath34 are the energy density and the internal energy of particle @xmath26 , respectively .",
    "substituting @xmath35 into @xmath16 in eq . and using the energy density based volume element , we have @xmath36 since the pressure is smooth at contact discontinuities and even at the shock front , we can obtain smoothed values without large errors .",
    "note that , if one uses disph for a non - ideal gas , one needs to use pressure directly instead of the energy density @xcite , because it is no longer smooth .",
    "we note that this formulation itself does not introduce any dissipation .",
    "in disph , as a trade - off for using of the smoothed pressure for the formulation , the density distribution has a jump at a contact discontinuity if the internal energy distribution there is not smooth ( see figure 2 in * ? ? ?",
    "* ) . while this jump does not affect the motion of particles , it is necessary to be aware of this `` unphysical '' density jump when one uses this density to evaluate physical quantities , such as radiative cooling",
    "as is noted by @xcite and @xcite , the simplest solution is to use the smoothed density .    in the same manner as ssph , disph can conserve the total energy , linear and angular momentum .",
    "if we use a variation principle for the derivation of sph equations @xcite , we can obtain a set of conservative sph equations @xcite .",
    "the equations in this derivation have the so - called `` grad-@xmath21 '' term . moreover ,",
    "if we carefully constructs energy and momentum equations , we can obtain another set of the conservative equations which do not involve the grad-@xmath21 term ( see section 5.6 in * ? ? ?",
    "here we adopt disph with the grad-@xmath21 term , which is more robust under the strong shock . in appendix",
    "[ sec : method : timeintegration ] , we show the result of the three - dimensional collapse test @xcite .",
    "the relative energy error from the beginning and the end of the simulation is @xmath37% , which is comparable to the previous studies ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "the initial condition we used here is basically the same as that used in @xcite .",
    "the volume of their initial condition is @xmath38 in the comoving space and the initial redshift is @xmath39 .",
    "the @xmath40 overdensity is imposed at the center of the volume so that a massive cluster will be formed at the center .",
    "there are two set of initial conditions with different resolutions : @xmath41 and @xmath42 particles .",
    "the cosmology is the standard cdm and the hubble parameter is @xmath43 where @xmath44 .",
    "we integrated the formation and evolution of the santa barbara cluster with a vacuum boundary condition in the physical space .",
    "we cut the central spherical volume with the radius of @xmath45 in the comoving space and remapped it to the physical space at @xmath46 .",
    "then , we imposed the hubble flow corresponding to the initial redshift .",
    "following @xcite , we assumed @xmath47 and @xmath48 .",
    "since the original initial conditions of @xcite are for dm only simulations , we divided each particle into two particles which have the same position and velocity of the original particle but have different masses , i.e. , that one has @xmath49 and the other has @xmath50 of the original particle mass , for simulations involving both dm and gas .    the number of particles , the mass of particles and the spatial resolutions ( softening lengths for dm and baryon : @xmath51 and @xmath52 ) are summarized in table [ tab : parameters ] .",
    "for both of low- and high - resolution models , we performed two runs , one with the standard sph , and the other with disph .",
    "we carried out five high - resolution ssph runs involving ac .",
    "these five runs adopted different values for the maximum dissipation parameter .",
    "in addition , two extra models which combine the low mass and the high spatial resolutions ( mixed 1 ) and the high mass and the low spatial resolutions ( mixed 2 ) are adopted in order to investigate the effect of the resolutions further .",
    "we also carried out two runs with ssph and disph for each model .",
    "thus , in total we performed thirteen runs .    [ cols=\">,^,^,^,^,^\",options=\"header \" , ]      +      we used a parallel @xmath53-body / sph code asura @xcite for this experiment .",
    "the gravitational interactions between particles were calculated by the tree method @xcite . the tree with grape method @xcite was used .",
    "the parallelization method of the gravity calculation was that proposed by @xcite .",
    "we adopted the symmetrized plummer potential and its multipole expansion @xcite so that we can calculate the gravitational interactions between particles with different values of softening lengths by a single tree .",
    "the opening angles for the ordinary three dimensions and softening lengths were set to @xmath54 following @xcite .",
    "the phantom - grape library was used for the calculation of particle - particle interactions in order to accelerate the calculation @xcite .",
    "the equation of state of the ideal gas with the specific heat ratio @xmath55 was used . in order to handle shocks ,",
    "the av term proposed by @xcite was used .",
    "in addition to this , we used an av switch proposed by @xcite in which the value of the av parameter , @xmath56 , changes in the range of @xmath57 . following @xcite , a modification which accelerates the increase of @xmath56 at lower @xmath56 regime and slows it at higher @xmath56 regime",
    "was also used .",
    "the balsara limiter @xcite was adopted in order to reduce the shear viscosity .",
    "we employed the wendland c4 kernel which is free from the paring instability @xcite .",
    "the number of neighbor particles was kept within @xmath58 .",
    "this higher order kernel with a larger number of neighbor particles can reduce the so - called e0 error @xcite .",
    "the time integration was carried out by a second order scheme ( see appendix  [ sec : method : timeintegration ] for details ) .",
    "the individual and hierarchical time - step methods were used @xcite . for sph particles , the time - step limiter , which enforces the time - step difference among neighboring particles to be small enough to follow strong shocks ,",
    "was used @xcite .",
    "the fast scheme , which allows each particle to have different time - steps for gravitational and hydrodynamical interactions and integrates these two interactions independently , was also adopted @xcite .",
    "when we used the fast scheme , the computational time ( wall - clock time ) became half of what it was without fast ( we used 128 cpu cores of cray xc30 in this comparison ) .",
    "this gain is almost the same as that reported in @xcite , although simulation setups in both runs were completely different .",
    "following previous studies @xcite , we define a dense region which is formed at the center of the simulation volume and with the mean density is 200 times higher than the background density as the `` santa barbara cluster '' .",
    "we express the radius where the mean density becomes 200 times of the background density as @xmath59 and call it the virial radius .",
    "the procedure to find the center and size of the santa barbara cluster is as follows .",
    "first , we find a particle of which total energy is the lowest and adopt it as the center of the cluster of galaxies .",
    "then , we sort all of particles based on the distance from the center of the cluster in ascending order .",
    "we calculate the mean density from the center to the outer part following the particle order , and we halt this operation when the mean density becomes less than 200 times of the background density .",
    "we regard the distance from the center to the particle position where we halt this operation as the virial radius .",
    "this simple strategy works well for the santa barbara test in which a single massive cluster is formed near the center of the simulation volume .      in order to draw radial profiles",
    ", we use a density weighted center instead of the halo center since the peak of the baryon distribution does not always coincide with the position of particle with the lowest total energy .",
    "we use the following definition as the density weighted center @xcite : @xmath60 where we only take care of the gas particles in the virial radius . for this density @xmath30",
    ", we just used the ssph - estimated density .",
    "the kernel function and the number of neighbor particles are the same as those described in  [ sec : method : numerical ] .",
    "in this section , we compare the properties of the santa barbara cluster obtained by simulations with ssph and disph , and then investigate the origin of the difference in the entropy profile .",
    "we first describe the global properties of the santa barbara cluster in  [ sec : results : globalproperties ] .",
    "the density , temperature and entropy distributions in the clusters obtained by simulations with ssph and disph at @xmath61 are compared in  [ sec : results : snapshots ] . in  [ sec : results : radialprofile ] , we compare radial profiles .",
    "we investigate how the central entropy core / cusp formed in  [ sec : results : entropy : formation ] . in ",
    "[ sec : results : ac ] , we investigate the contribution of the ac term for the cluster entropy profile .    in order to avoid confusion",
    ", we use the label `` sph '' to indicate the results of ssph on figures and `` disph '' for the results of disph .",
    "the average of virial radii of the santa barbara clusters of the four runs ( the high- and low - resolution runs with ssph and disph ) is @xmath62 .",
    "this radius is somewhat larger than those obtained in previous studies @xcite .",
    "the total mass within @xmath59 is @xmath63 which is @xmath64 larger than those obtained by @xcite .",
    "these differences are probably due to the difference in the treatment of the boundary condition .",
    "we used the open boundary condition , while all runs in @xcite adopted the periodic boundary condition .",
    "since the radius of the initially imposed overdensity region is @xmath65 , the cut - off radius of @xmath45 would be insufficient to remove boundary effects . nonetheless , as we see later , the central region of the cluster does not seem to be affected by the boundary condition . in the following , we call the santa barbara cluster just `` cluster '' , for brevity .",
    "we found that the clusters obtained by disph contain more gas than those obtained by ssph .",
    "the gas fractions of the cluster with disph are @xmath66 which are close to the results of high resolution mesh codes in @xcite and also the cosmic averaged value of @xmath67 for this model . on the other hand , those of ssph are",
    "@xmath68 which are close to those of ssph runs in @xcite , @xmath69 .",
    "figure [ fig : virial : density ] shows the gas density maps of the four runs within @xmath59 at @xmath61 .",
    "these density maps are not very different . however ,",
    "when we inspect these maps carefully , we find several differences .",
    "first , we can see that the central densities in runs with ssph are higher than those with disph .",
    "the density of the innermost regions of the clusters with ssph is one order of magnitude higher than that with disph .",
    "second , for both of ssph and disph runs , the central density of the cluster is higher for runs with high mass resolution ( large number of particles ) .",
    "figure [ fig : virial : temperature ] shows the temperature distribution within the cluster of four runs .",
    "we can see that the clusters of ssph runs contain more small - scale substructures compared to those of disph runs .",
    "figure [ fig : virial : entropy ] shows the entropy distributions ; the definition of the entropy we adopted in this paper is @xmath70 where @xmath71 and @xmath1 are the temperature in the unit of kelvin and the density in the unit of @xmath72 , respectively , and this definition is the same as that used in @xcite .",
    "it is obvious that the values of the central entropy in ssph runs are much lower than those in disph runs .",
    "the clusters in disph runs have no or a little amount of gas with entropy below @xmath73 , while the clusters in ssph runs have significant amounts of such gas at the center .",
    "it is also clear that the entropy distributions of the cluster in disph runs are smoother than those of clusters in ssph runs . in other words",
    ", the entropy distribution indicates that the gas in the clusters of ssph runs is not well mixed .",
    "figure [ fig : radialprofiles ] shows the radial profiles of the cluster at @xmath61 . in this figure , we used two high - resolution results . in this plots ,",
    "`` sb '' denotes the averaged profiles in @xcite , `` arepo '' is the result of a moving mesh code arepo by @xcite . as expected , with this formalism the entropy generation is slightly suppressed @xcite . on the other hand",
    ", @xcite pointed out that spurious heating from riemann solver errors affects an entropy profile when this formalism turned off .",
    "hence , we adopt the original data shown in @xcite .",
    "] , and `` nyx '' denotes the result of an amr code nyx by @xcite .",
    "-body / gas dynamics code designed for large scale cosmological simulations . in this code , the fluid evolution is solved by a finite volume method with a block structured amr .",
    "the dual energy formulation is used .",
    "the riemann solver is used for the evaluation of fluxes . according to these features ,",
    "nyx is one of good representatives of the state - of - the - art amr codes .",
    "the entropy profile of the santa barbara cluster with nyx is almost identical to those with enzo @xcite and art @xcite . ]",
    "we note that these data were taken from figures in their papers : figure 18 in @xcite for sb , figure 45 in @xcite for arepo ( we adopt the result labeled @xmath41 ) , and figure 7 in @xcite for nyx .",
    "we also note that the entropy profile with gizmo reported by @xcite is comparable to that with arepo .",
    "the density profiles of dm ( the top - left panel of figure [ fig : radialprofiles ] ) of all four runs agree very well .",
    "the central density of gas of the ssph run is significantly higher than those of the other three runs . here , `` sb '' , `` arepo '' and our disph results seem to agree well .",
    "note , however , that the `` sb '' plot is the average of 7 sph and 5 mesh - based scheme runs , and sph models in @xcite gave the result similar to our ssph run , while the mesh runs gave a central density even lower than arepo / disph results .",
    "thus , the agreement between our disph result and the arepo result is rather good , whereas all ssph runs gave high central densities and amr runs , lower density .    from the temperature profile ( the left - bottom panel of figure [ fig : radialprofiles ] ) and density profile ( the top - right panel ) of the gas component , we can see that the standard sph gives a central cusp with the temperature decreasing inward , while arepo and disph give constant - density , constant - temperature cores .",
    "mesh runs in @xcite also gave constant - density cores , but their cores are systematically larger than those obtained by arepo and our disph .",
    "the averaged `` sb '' profile of the temperature shows a sign of central decrease , since it is the average of sph ( decreasing ) and mesh ( increasing ) profiles .",
    "we can see the same tendency in the entropy profile ( the bottom - right panel ) .    in figure",
    "[ fig : entropy : comparison ] , we plot the entropy profiles of our low - resolution runs , as well as those of our high - resolution runs and three results from the literature ( `` sb '' , `` arepo '' and `` nyx '' ) .",
    "we can see that for disph runs , the difference in resolution does not make much difference in the entropy profile ; the entropy profiles with disph are consistent with that obtained by a moving mesh code arepo .",
    "on the other hand , our low - resolution ssph run gave a central entropy significantly higher than that of our high - resolution ssph run .",
    "our low - resolution ssph result is similar to those of the ssph simulations in @xcite and @xcite .",
    "thus , it is clear that the `` core '' in these previous ssph results is due to the limitations in the numerical resolution .    from this figure",
    ", we find that the central entropy in the high - resolution disph run is slightly higher than that in the low - resolution disph run , although we saw the opposite sense from the entropy maps ( figure [ fig : virial : entropy ] ) .",
    "this is because there is an offset of @xmath74 between the position of the entropy minimum and the plot center ( the density weighted center ) in the high - resolution disph run , and it makes the rather flatter central entropy profile .",
    "thus , there is no discrepancy .    in order to assess which parameters , i.e. , mass and spatial resolutions , are more crucial to the final entropy profile of the cluster , we carried out two extra models with disph and ssph which mix resolutions ; ( 1 ) with the high mass / low spatial resolutions ( `` mixed resolution 1 '' ) and ( 2 ) with the low mass / high spatial resolutions ( `` mixed resolution 2 '' ) . as shown in figure [ fig : entropy : mixed ] , the former run reproduced the entropy profile of the high - resolution ssph run , while the latter run did that of the low - resolution ssph run .",
    "a slight difference is found only in the very central region ( @xmath75 ) .",
    "hence , in the ssph runs , the central structure of the entropy profile is sensitive to the small scale power of the initial density fluctuations .",
    "there is no significant influence on the results with disph .",
    "the good agreement between results with disph , arepo , and gizmo is quite encouraging .",
    "however , the analysis so far is only limited at the date of @xmath61 . in the next subsection",
    ", we compare the results obtained by disph and ssph methods deeply , by focusing on the formation process of the cluster .",
    "the cluster grew rapidly while @xmath76 , and then experienced a major merger around @xmath77 , and evolved mildly until @xmath61 .",
    "we follow these typical phases of evolution to understand how and when the entropy core and cusp are established .",
    "figure [ fig : entropy : threeepochs ] shows the radial entropy and density profiles for the high - resolution disph and ssph runs .",
    "we here plot them for three epochs , before the major merger ( @xmath78 ) , after the major merger ( @xmath79 ) , and at the end of the simulation ( @xmath61 ) .    for the run with disph , at @xmath78 , the entropy profile has a relatively small core .",
    "then , the core entropy and core size increase and these quantities are kept unchanged until @xmath61 .",
    "the entropy profile at @xmath79 is comparable to that at @xmath61 ; the last major merger event triggers this core entropy increase ( see below ) .",
    "the entropy of the intermediate region of @xmath80 slightly increased during @xmath81 .",
    "the evolution of the density profile is similar , but in the opposite direction . the core density decreases by almost a factor of three from @xmath78 to @xmath79 , and",
    "it remains unchanged until @xmath61 .",
    "the evolution of the radial profile in the ssph run is quite different from that in the disph run . at @xmath78 , the entropy profile with ssph",
    "has a small core which is comparable to that of the disph run .",
    "this entropy core becomes larger until @xmath79 .",
    "however the core entropy is much lower than that with the disph run . at @xmath61 ,",
    "the entropy core vanishes nearly .",
    "the density profile follows this evolution similarly but in the opposite direction . at the end of the simulation",
    "the density profile has a cusp .",
    "evolution of the radius of the entropy core and the averaged core entropy in the runs with disph and ssph are shown in figures [ fig : entropy : coreradius ] and [ fig : entropy : coreentropy ] .",
    "the definition of the core radius is described in appendix [ sec : method : core ] .",
    "the averaged core entropy is measured using the entropy of gas in the core radius .",
    "their evolutions can be divided into two phases and the transition takes place after the major merger epoch ( @xmath82 ) .    in the disph",
    "runs , two results agree with each other very well . in the early phase ( @xmath83 ) , the radius of the entropy core increases from @xmath84 ( @xmath85 ) to @xmath86 ( @xmath82 ) and the averaged core entropy increases from @xmath87 ( @xmath85 ) to @xmath88 ( @xmath82 ) .",
    "then the growth of the core radius is stopped and the core is essentially unchanged until @xmath61 .    in the ssph",
    "runs , the evolution is completely different from those of disph runs .",
    "when we compare the high resolution runs , the core radius of the ssph run is smaller than that of the disph run in the initial phase ( @xmath89 ) .",
    "major merger triggered the rapid increase , but at @xmath82 the core is still smaller than that of disph runs .",
    "second , the core size shrinks and the averaged core entropy decreases in the late phase ( @xmath90 ) .",
    "these figures suggest that the low - entropy material is supplied to the central region , most likely via minor mergers in the late phase .",
    "the low resolution ssph run follows the evolution of the high resolution one , although its goes between disph runs and the high resolution ssph runs because of lower resolution .    in  [ sec :",
    "majormerger ] and  [ sec : minormerger ] , we further investigate the evolution of the cluster s central entropy induced by the major and minor mergers .",
    "figure [ fig : entropy : merger : disph ] shows the evolution of the distributions of pressure and entropy in the cluster in the high resolution disph run during the major merger phase ( @xmath91 ) . a smaller cluster consisting of the low - entropy material approaches from the top - right corner ( @xmath92 ) , it merges with the main cluster ( @xmath93 ) and after several crossing times these two clusters completely merge to form a single cluster with the relaxed structure ( @xmath94 and @xmath95 ) . in this run , the entropy at the cluster center increases due to shocks ( see bottom panels ) . before the merging event ,",
    "the central entropy is lower than @xmath73 , but it becomes higher than @xmath73 after the merger event ( see also figure [ fig : entropy : coreentropy ] , @xmath96 at @xmath97 whereas @xmath98 at @xmath82 ) .",
    "the pressure maps are smooth throughout this event ( top panels ) .    in the ssph run",
    ", we also observe the increase of the central entropy whereas the absolute value is lower than that in the disph run , as we see figure [ fig : entropy : merger : ssph ] .",
    "there are sharp edges in the distribution of the low - entropy ( cold ) gas clumps , and therefore the mixing of low- and high - entropy components is much weaker in the ssph run compared to that in the disph run .",
    "pressure maps show sharp gaps which are not found in those in the disph run .",
    "thus , these gaps are outcomes of the unphysical surface tension of ssph , resulting in the suppression of the entropy generation due to shocks .      here",
    ", we focus on the late stage of the evolution of the cluster .",
    "figure [ fig : entropy : merger : minor ] shows the evolution of the radial entropy distribution",
    ". the main sequence of the entropy distribution , where the relative fraction is high , corresponds to the radial entropy profile we saw in , e.g. , figure [ fig : entropy : comparison ] . in addition to the main sequence , there are a number of low entropy components .",
    "these low - entropy components are clumps in and around the cluster .",
    "the evolution of the cold gas clumps are quite different in the disph run and ssph run . in the case of",
    "ssph run ( bottom panels ) , there are many clumps with minimum entropy around @xmath99 , within the distance range @xmath100 . on the other hand , in the case of the disph run , there are only a few clumps within the distance @xmath101 , and their minimum entropy is much higher .",
    "thus , in the case of the ssph runs , cold gas clumps survive in the cluster and fall to the cluster center , forming low - entropy core , while in the case of the disph run , cold gas clumps are disrupted before they reach to the center of the cluster .    in order to clarify the difference of the late stage evolution of the disph run and that of the ssph run",
    ", we here focus on the evolution of one clump . for this analysis",
    ", we first pick up low entropy component within @xmath59 .",
    "the threshold entropy is @xmath102 which is slightly lower than the core entropy of the disph runs at @xmath61 . with this threshold",
    ", we found a number of low entropy clumps . in order to select one representative clump from them",
    ", we imposed the following conditions : ( 1 ) the clump is approaching to the cluster center , ( 2 ) the mass is sufficiently large so that we can track its evolution , ( 3 ) the clump reaches to the center of the cluster before @xmath61 , and ( 4 ) the clump can be found in both runs at the same position .",
    "the representative clump we picked up is found at @xmath103 and its total mass is @xmath104 at @xmath105 .",
    "figure [ fig : target : disph ] shows the evolution of this low - entropy clump in the high - resolution disph run . from the particle distribution maps ( upper panels ) , we can see that this representative clump enters the cluster center forming a bow - shock .",
    "its front surface is being stripped due to fluid instabilities , resulting in the complete destruction of the clump by @xmath106 ( recall the blob test in * ? ? ?",
    "the pressure distribution across the interface between the clump and the intracluster medium is always smooth .",
    "figure [ fig : target : ssph ] shows the evolution of the same clump in the high - resolution ssph run .",
    "there is a clear gap both in the particle and pressure distributions in the front of the clump .",
    "this gap is induced by the unphysical surface tension , protecting this clump from the development of fluid instabilities at the surface and ram - pressure stripping .",
    "thus , the low entropy gas in this clump can sink to the cluster center .",
    "we compare the evolutions of this representative clump in disph and ssph runs in figure [ fig : target : evolutions ] .",
    "top , middle , and bottom panels are the distance from the cluster center , the size , and the averaged entropy of the gas particles of the clump , respectively . before the pericenter passage , clumps in two runs are almost identical",
    ". when it passed the pericenter , the orbital decay starts .",
    "the orbital decay in the ssph run is much faster than that in the disph run .",
    "clumps expand when passing the pericenter .",
    "the clump in the disph run is more extended compared to that in the ssph run .",
    "these two results tell us that the clump in the ssph run keeps a compact structure much longer .",
    "the increase of the mean entropy starts slightly before the pericenter passage in both runs . at @xmath61 ,",
    "the mean entropy of the clump in disph is @xmath107 higher than that in ssph .",
    "this indicates that the shock heating is more efficient in the disph run . however , behind the fact that ssph has unphysical surface tension , we should say that the shock heating in ssph is more inefficient .",
    "disph can capture the intrinsic shocks .",
    "this difference in the shock heating efficiency explains why cold gas clumps can reach to the center of the cluster in the ssph run but are disrupted in the disph run .",
    "this tendency that the clumps in the ssph run survive longer at the center of the cluster compared to those in the disph run can be seen in figure [ fig : target : stack ] . here",
    ", we used subfind clumps ( see appendix [ sec : method : subfind ] ) and stacked data during @xmath108 ( total 17 snapshots ) . generally , as clumps move closer to the center of the cluster , they loose their masses due to tidal and ram - pressure stripping . at the same distance from the cluster center , in particular for @xmath109 , we can see the clear tendency that clumps in ssph are more massive than those in disph .",
    "thus , the evolution of the inner part of the cluster strongly affected by the choice of the sph scheme .",
    "while clump surviving time is different , there is no significant difference in mass functions with different sph schemes ( see appendix [ sec : results : massfunction ] ) .",
    "it has been pointed out by @xcite that the cluster core entropy decreased at the low-@xmath110 with ssph .",
    "they measured the evolution of entropy at the central region ( @xmath111 ) of clusters of galaxies in a @xmath4cdm universe .",
    "they found that the core entropy of the ssph run decreased continuously for @xmath112 whereas those of amr and sphs runs were roughly constant .",
    "although they did not follow the individual clumps , they explained that the change of the central entropy found in low-@xmath110 period is due to the accretion of the low - entropy clumps induced by the minor mergers .",
    "our study supports their result and this process works in the evolution of the santa barbara cluster in previous studies as well .",
    "recently , the ac term has become widely used in sph simulations in order to remove the unphysical surface tension ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    ", we investigate the effects of ac on the cluster formation and evolution .",
    "similar studies are found in the literature ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "according to the numerical experiments by @xcite and @xcite , it is expected that the entropy core appears if the ac term is introduced into ssph and the core size and core entropy depend on the maximum value of the conduction control parameter @xmath113 .",
    "thus , in this section , we highlight the contribution of @xmath113 to the thermal structure and the entropy profile .    here , we adopt the following functional form for the ac : @xmath114 where @xmath115 , @xmath116 , @xmath117 is pressure , and @xmath118 $ ] .",
    "following @xcite , we evaluate the ac coefficient of particle @xmath25 , @xmath119 using the following equation ; @xmath120 where @xmath121 is evaluated by the sph manner and @xmath119 is allowed to evolve from @xmath122 to @xmath113 .",
    "this ac term is essentially the same as those adopted in the previous studies ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "we tested several functional forms and switches and found that the conclusion in this subsection does not affected by them .",
    "we show five high - resolution ssph runs with different values of @xmath123 : @xmath124 and @xmath125 .",
    "figure [ fig : ac : temp ] shows the temperature maps of five runs with the ac term , as well as that of the run without ac . from this figure",
    ", we can see that the temperature structure gets blurred when @xmath113 increases .",
    "we find that there is a similar effect in both the density and entropy maps .",
    "this blurring effect has an influence on the entropy profile of the cluster , as we see next .",
    "figure [ fig : ac : entropy ] shows the radial entropy profiles with and without ac . apparently , the entropy profile is affected by ac .",
    "the entropy profile with @xmath126 is cuspy ; it has a slightly higher entropy than that without ac in @xmath127 .",
    "on the other hand , those with @xmath128 have cores .",
    "these core entropies increase with increasing @xmath129 and the increase stalls when @xmath130 .",
    "the core entropy with @xmath131 is comparable to those with disph and arepo whereas that with @xmath132 is rather close to that obtained by a mesh code . in our test , unlike previous study @xcite , the core entropies with @xmath130 are slightly lower than those obtained by mesh codes .",
    "this difference might come from the detailed implementations .",
    "time evolutions of averaged core entropies for five ac runs are shown in figure [ fig : ac : entropy : core ] .",
    "the overall evolutions of the runs with @xmath133 are similar to those of disph runs ; the increase of the core entropy is fast until @xmath82 and then it stops . on the other hand ,",
    "the evolution with @xmath134 is close to that without ac , whereas this run has a slightly higher entropy within @xmath135 .",
    "the final core sizes are @xmath136@xmath137 for the runs with @xmath138 ( recall that they are @xmath139 in disph runs ) .",
    "although ssph runs with ac ( @xmath138 ) have slightly larger entropy cores , the effect of the ac term looks similar to that of disph ; the essential difference is that ac requires the new free parameter @xmath123 .",
    "since the numerical results depend on this parameter , one needs to pay attention to determine its value .",
    "it is of course possible that the calibrated @xmath113 for one experiment is inadequate for another experiment .",
    "in this paper , we studied the formation of the entropy core in the santa barbara cluster .",
    "previous studies ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) have demonstrated that simulations with eulerian mesh codes make the entropy core in the cluster center while those with lagrangian sph codes do not .",
    "the original paper @xcite argued that the origin of this difference came from the different treatment of shocks in the sph and mesh codes .",
    "however , both eulerian mesh codes and lagrangian sph codes have their own , intrinsic limitations which might affect the entropy evolution .",
    "this implies that neither mesh results nor sph results is correct . @xcite and @xcite reported that new lagrangian fluid schemes made entropy cores but the depth of their cores is deeper than those obtained by eulerian codes .    the clusters simulated with disph formed prominent entropy cores and its size and absolute value of the core entropy was insensitive to the adopted resolutions . during the cluster formation , a number of low entropy clumps accreted and these clumps brought low entropy materials to the cluster center . in the disph runs , the ram pressure stripping and fluid instabilities disrupted these clumps efficiently in disph runs .",
    "the entropy of these clumps increased due to hydrodynamical shock and they built the entropy core .",
    "the size of the entropy core at @xmath61 is @xmath139 and the depth of that is @xmath140 .",
    "these values are comparable with those obtained by the original version of the moving mesh code @xcite and the mesh free code @xcite .",
    "the values of the core entropy obtained in these simulations are about unity lower than those with eulerian mesh codes .",
    "this systematic difference is probably due to the numerical diffusion intrinsically existing in eulerian codes ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ) . in principle",
    ", the effect of the numerical diffusion can be reduced by increasing the spatial resolution @xcite . however , whether this strategy is really useful for cosmological simulations or not is unclear since this approach is quite time - consuming .",
    "we were able to reproduce the cuspy entropy profile when we used ssph and the results with ssph depended strongly on the adopted mass resolution .",
    "when we employ low mass resolution , there is a small core which is comparable with the previous simulations .",
    "when we adopt the high mass resolution , the central entropy became much lower and the cusply profile appeared . by following the evolution of the central entropy , we found that the central entropy in ssph runs affected by the minor mergers involving the low - entropy gas .",
    "low - entropy gas in simulations with ssph is `` protected '' against ram - pressure stripping , as found by @xcite .",
    "the evolution of low - entropy clumps in disph is completely different from that in ssph .",
    "the cuspy entropy profile found in the ssph runs is artifact .    we can obtain the entropy core in the santa barbara cluster with just changing the volume element of the formulation and without introducing any diffusions .",
    "there are several studies in which entropy core was obtained by introducing dissipations to sph @xcite . in their studies",
    ", they could obtain cored entropy profiles .",
    "we also confirmed it by our numerical experiments .",
    "as is reported by previous studies , the core size depended on the diffusion coefficient of the conductivity .",
    "our method has advantages over these methods since there is no need to calibrate the diffusion coefficients . in addition",
    ", there is no time and spacial scales which controls the degree of the dissipation strength if we used disph , since formulation of disph itself can remove the unphysical surface tension . we thus conclude that disph is a good alternative to ssph for the cosmological structure formation .",
    "there is room to improve the implementation of the av term and switches .",
    "for instance , a sophisticated switch is important in order to deal with a rotating system @xcite .",
    "recently , @xcite showed a survey of the implementation of the av . in their study",
    ", they showed that the run with the combination of the von - neumann - richtmyer - landshoff type av term velocity gradient @xcite can maintain the keplerian disk for @xmath141 orbits .",
    "we need to investigate the feasibility of these methods in structure formation simulations .",
    "we thank the anonymous referee .",
    "her / his insightful comments improve our manuscript greatly . t.r.s .",
    "thanks takashi okamoto and kohji yoshikawa for useful discussion . t.r.s . also thanks lucy kwok and junko saitoh who helped in writing the manuscript .",
    "numerical simulations were carried out on the cray xc30 system in the center for computational astrophysics at the national astronomical observatory of japan .",
    "this work is supported by grant - in - aid for scientific research ( 26707007 ) of japan society for the promotion of science and strategic programs for innovative research of the ministry of education , culture , sports , science and technology ( spire ) .",
    "this work is supported in part by mext spire and jicfus .",
    "the philosophy of the introduction of ac is to ensure all physical quantities will be smooth everywhere . at a contact discontinuity , ssph makes a pressure blip if the internal energy does not have a smoothed profile consistent with the smoothed profile of density . to guarantee the consistent profile of the internal energy , ac spreads the internal energy until the pressure profile becomes smooth .",
    "this term works very well in the standard tests and widely used .",
    "however , one meets a difficulty when one applies ac to a contact discontinuity consisting of a fluid with different chemical compositions .",
    "consider the case in which there are two contacting fluids and they have different chemical compositions . here",
    ", we assume that they have different mean molecular weights , @xmath142s .",
    "thus , the internal energy is a function of @xmath142 and temperature @xmath71 ; @xmath143 .",
    "moreover , these two fluids are initially in the pressure and temperature equilibrium state .",
    "disph can reproduce the original pressure and temperature equilibrium state without any difficulty . on the other hand",
    ", ssph can not reproduce it ; a pressure jump appears across the contact interface .",
    "ssph with the ac term gives a pressure equilibrium state by changing the internal energy of particles around the contact interface .",
    "since @xmath143 , this change of @xmath144 induced by ac is regarded as the changes of @xmath71 and @xmath142 .",
    "unfortunately , we do not know an appropriate procedure to spread @xmath71 and @xmath142 .",
    "hence , we can not predict exact quantities of @xmath142 and @xmath71 at the contact interface .",
    "there are two possible limits : ( 1 ) @xmath71 changes but @xmath142 does not , and ( 2 ) @xmath142 alters but @xmath71 does not .",
    "the former leads to undesirable chemical reactions if one is solving the chemical reactions , since they depend on @xmath71 .",
    "the latter is the compulsive mixing of chemical compositions .",
    "we show a simple , one - dimensional numerical experiment regarding this problem .",
    "the initial condition is as follows .",
    "the computational domain is @xmath145 with a periodic boundary condition .",
    "the fluid at @xmath146 has @xmath147 while the other has @xmath148 .",
    "both pressure and temperature have constant values in the whole region .",
    "since @xmath149 , the density and internal energy have different values in these two sub - domains . here",
    "the initial pressure and temperature are unity and @xmath150 .",
    "the density is normalized so that @xmath151 .",
    "we solved this system until @xmath152 sound crossing time .",
    "we used two schemes : one was disph and the other was ssph with the ac term . here , we adopt the ac term described in  [ sec : results : ac ] and @xmath153 .",
    "figure [ fig : ac ] shows the results of ssph with the ac term and disph at time @xmath154 ( about 100 crossing time ) . in the ssph run with the ac term , the initial pressure jump is smeared by smoothing the distribution of the internal energy ( the top - right panel in figure [ fig : ac ] ) .",
    "if we consider this change of the internal energy as the change of the temperature , we have the temperature distribution with jumps at the contact discontinuities shown in the middle - right panel . on the other hand ,",
    "if we regard it as the change of @xmath142 , we obtain the smoothed distribution of @xmath142 as shown in the bottom - right panel . in disph",
    ", there is no difficulty in dealing with this system ( panels in the left column ) .",
    "a system consisting of materials with different chemical compositions is not an unphysical situation .",
    "for instance , for a giant impact simulation , one solves collisions of core(iron)-mantle(silicon based rock ) planet embryos @xcite . at the core - mantle boundary",
    ", there is a jump of the composition .",
    "in addition , at the contact interface at the colliding time there is also a jump of the chemical composition .",
    "if we use the ac term for this simulation , the boundary materials are mixed and/or the temperature at these boundaries changes .",
    "disph for a non - ideal gas @xcite can deal with these boundaries without any difficulty @xcite .",
    "the time integration of a single step from @xmath155-th step to @xmath156-th step where the time step is @xmath157 is carried out by the following procedure :    1 .",
    "advance the velocity @xmath158 from @xmath155-th step to @xmath159-th step using the acceleration @xmath160 : @xmath161 2 .",
    "drift the position @xmath162 from @xmath155-th step to @xmath156-th step using @xmath163 : @xmath164 3 .",
    "evaluate the predictor of the velocity at @xmath156-th step using @xmath160 : @xmath165 4 .",
    "evaluate the predictor of the specific internal energy at @xmath156-th step using the time derivative of @xmath166 , @xmath167 : @xmath168 5 .",
    "compute @xmath169 and @xmath170 using @xmath171 , @xmath172 , and @xmath173 .",
    "advance @xmath163 by the rest of the half step using @xmath169 : @xmath174 7 .",
    "compute @xmath175 using both @xmath167 and @xmath176 : @xmath177 \\delta t.\\ ] ]    the manner to integrate the internal energy described above is heun s method ( or the modified euler s method or the second order runge - kutta method ) .",
    "thus , our integration scheme is categorized as the second order method . for dm particles ,",
    "this time integration scheme is reduced the standard second order symplectic scheme , the leap - frog scheme .    as a demonstration",
    ", we show the results of the adiabatic collapse test with this time integration scheme .",
    "this test is one of the standard benchmark tests of self - gravitating fluid @xcite .",
    "a number of simulation codes showed results of this test ( e.g. , * ? ? ? * ; * ? ? ?",
    "* ; * ? ? ?",
    "the typical error of the total energy in this test is less than @xmath178% .",
    "the initial condition of this test was generated as follows .",
    "first , we prepared gas particles located on uniform grid points .",
    "then , by stretching their relative distances from the center of the coordinates , we made the gas distribution with a radial density profile of @xmath179 , where @xmath180 is the distance from the center of the coordinates .",
    "the gas particles in @xmath181 are adopted to make a gas sphere .",
    "we assumed that they do not have a bulk velocity at the beginning of the simulation .",
    "the total mass and the gravitational constant are unity .",
    "the specific initial thermal energy is @xmath182 and @xmath55 .",
    "since the initial kinetic energy is zero and the thermal energy is less than the absolute value of the potential energy , this gas sphere collapses due to self - gravity and eventually reaches a state of equilibrium . here , we represented this gas sphere with the 61432 equal - mass sph particles .",
    "the gravitational softening length was set to @xmath183 .",
    "we carried out four runs .",
    "two are disph and ssph , which were used in this paper . in these runs ,",
    "the kernel size was determined so that the neighbor number is in the range of @xmath58 .",
    "however , it is pointed out that the use of the constant neighbor number often makes sudden change of the interaction radius , resulting in the fluctuations of physical quantities .",
    "thus , the other two runs adopted the smoothed neighbor number method for the evaluation of kernel size @xcite . here , both disph and ssph were used .",
    "we express our fiducial cases as disph and ssph , and the other two cases with the smoothed neighbor number method as disph(s ) and ssph(s ) .",
    "the wendland kernel c4 was adopted .",
    "the self - gravity was solved by using the tree with grape method .",
    "the opening angle was set to @xmath54 .",
    "time step for each particle is determined following @xcite .",
    "figure [ fig:3dcollapse : evolution ] shows the evolution of radial profiles of density , pressure , and radial velocity of the disph run .",
    "three representative epochs are adopted . except for the central region ( @xmath184 ) , our result is comparable with a 1d ppm result .",
    "the other three cases , ssph , disph(s ) , and ssph(s ) , show almost identical results .    in figure [ fig:3dcollapse : all ] , we show time evolutions of the kinetic , thermal , potential and total energies . again , we show the result of the disph run .",
    "the overall evolution is comparable with that obtained in previous studies and the other three cases show identical results .",
    "figure [ fig:3dcollapse : total ] represents time evolutions of the total energies in four runs .",
    "these total energies change significantly at time @xmath185 when the gas sphere collapses , while they keep almost a constant value at other times .",
    "we define the energy error as follows : @xmath186 where @xmath187 and @xmath188 are the total energy of a system at time @xmath189 and @xmath190 , respectively .",
    "energy errors evaluated by the above equation are 0.19% for disph , 0.22% for ssph , 0.14% for disph(s ) , and 0.16% for ssph(s ) , respectively .",
    "thus our time integration scheme works well .",
    "the fact that there is no significant difference among them indicates that the choices of the definition of the neighbor numbers and sph types are not crucial for the energy conservation in our simulations .",
    "in order to compare sizes of entropy core and their time evolutions among different simulations , we need a methodology to evaluate a core size from an entropy profile .",
    "as is shown in the text , the evolutions of core size and entropy are highly time - variable . in order to follow this dynamically evolving structure",
    ", we adopt the technique used in the field of stellar cluster simulation .",
    "below , we describe our method to define the entropy core .",
    "first , we calculate the radially averaged entropy profile ; it is expressed as @xmath191   to @xmath65 from the density center . the constant interval with the logarithmic scale",
    "we calculate the entropy of each particle and add it to a bin which covers the position of the particle .",
    "we obtain the radial entropy profile of the cluster by taking the average of entropy in each bin .",
    "the averaged entropy at the given @xmath192 is calculated by the linear interpolation of the binning values .",
    "if @xmath193 , we use @xmath194 as the averaged entropy at the given @xmath192 . ] , where @xmath192 is the distance from the density center , @xmath195 .",
    "we , then , pick up particles of which entropy is in the range of @xmath196 and evaluate the core radius using these particles .",
    "the reason why we sampled particles from the narrow region is to exclude the contamination of small , low - entropy clumps ( see also figure [ fig : entropy : merger : minor ] ) . without this process , we were unable to obtain a reasonable size of the entropy core",
    ".    the following equation is used in order to evaluate the core radius : @xmath197 where @xmath198 is the entropy of particle @xmath199 and @xmath200 .",
    "the index @xmath199 runs particles of which entropy are in the range of @xmath201 and @xmath202 .",
    "we use a very strong power of the inverse of the entropy as the weight function to determine the entropy core .",
    "the outer part of the entropy profile of clusters of galaxies , typically in the range of @xmath203 , follows @xmath204 @xcite .",
    "therefore , a weight which is stronger than @xmath205 is suitable in order to evaluate of the core .",
    "after intense tests , we found that the weight , @xmath206 , is suitable in order to evaluate the core radius of the radial entropy profile .",
    "we adopt the subfind algorithm @xcite in order to extract self - bound clumps in the santa barbara cluster .",
    "the procedure is as follows .",
    "first , we calculate the density of all particles within @xmath207 using eq .",
    "the density of gas particles is evaluated by counting the contribution of gas particles while that of dm particles is calculated by counting the contribution of dm particles .",
    "the density of each particle is evaluated by the contribution from the nearest @xmath58 particles . here",
    ", we refer these nearest particles `` local particles '' .",
    "after the density evaluation , we sort all of particles in the descending order of the density .",
    "we , then , identify isolate clumps following the density distribution .",
    "we repeatedly compare the densities of particles with those in the densities of their local particles from the highest to the lowest density particles and apply the following operation . here",
    ", we focus a particle @xmath25 . if the particle @xmath25 is the highest density particle in its local particles , we set the particle @xmath25 as the peak of an isolate clump ( the core of a new clump ) .",
    "if the particle @xmath25 is the second highest density particle or it has two higher density particles which are in the same clump , we add the particle @xmath25 to the clump which includes the highest density particle . if the particle @xmath25 has more than two higher density particles and the two highest density particles are in different clumps , we tag these two clumps as _ the subfind clump candidates _ since the particle @xmath25 is at the saddle point which separate two clumps ( two density peaks ) .",
    "then , we merge these clumps with a single larger clump and attach particle @xmath25 to this clump . the last operation is necessary in order to extract subfind clump candidates which are located at the envelop of this merged clump .    as the final step , we remove unbound particles from the subfind clump candidates iteratively .",
    "we first calculate the total energy ( the self - gravitational potential and the kinematic energy where the mean velocity of each clump is set to zero ) of each particle in a clump . then if the clump includes particles of which total energy is larger than zero",
    ", we remove these particles from the clump .",
    "we do not remove more that @xmath50 of the particles at once so that we can carry out this process stably .",
    "we continue this procedure until the clump consists only of the bound particles .",
    "we adopt clumps which contains more than 64 bound particles .",
    "we apply this procedure to all clumps and get a full catalog of subfind clumps .",
    "in this section we investigate the mass functions of substructures .",
    "the subclumps are extracted using the subfind algorithm ( see  [ sec : method : subfind ] ) .",
    "figure [ fig : massfunction ] shows mass functions of substructures .",
    "mass functions of the runs with the same resolutions have almost identical profiles .",
    "all of mass functions asymptotically follow the power law profile with the index of @xmath208 .",
    "it is not surprising that there is no impact on substructure mass functions with different schemes , since the amount of the baryonic component is @xmath209 of the total mass .",
    "mass functions of the baryonic component is shown in figure [ fig : gasmassfunction ] .",
    "not all of substructures hold the baryonic component due to the stripping .",
    "thus , the number of baryonic substructures is very small compared to that of the total substructures .",
    "even though the evolution of the gas clumps in the central area of the cluster is quite different for two runs , this difference is little or no effect on the mass function .",
    "this is probably because in either case that lifetime of gas clump in the central area is short .",
    "our mass functions do not show convergence with different mass resolutions .",
    "we have checked mass functions with mixed resolutions and found that , at least toward the high mass end , the functional form of mass functions depends on the mass resolution .",
    "thus , the discrepancy between high - mass resolution runs and low - mass resolution runs comes from the non - linear effect induced by the smallest scale density fluctuations ."
  ],
  "abstract_text": [
    "<S> the santa barbara cluster comparison project @xcite revealed that there is a systematic difference between entropy profiles of clusters of galaxies obtained by eulerian mesh and lagrangian smoothed particle hydrodynamics ( sph ) codes : mesh codes gave a core with a constant entropy whereas sph codes did not . </S>",
    "<S> one possible reason for this difference is that mesh codes are not galilean invariant . </S>",
    "<S> another possible reason is the problem of the sph method , which might give too much `` protection '' to cold clumps because of the unphysical surface tension induced at contact discontinuities . in this paper , we apply the density independent formulation of sph ( disph ) , which can handle contact discontinuities accurately , to simulations of a cluster of galaxies , and compare the results with those with the standard sph . </S>",
    "<S> we obtained the entropy core when we adopt disph . </S>",
    "<S> the size of the core is , however , significantly smaller than those obtained with mesh simulations , and is comparable to those obtained with quasi - lagrangian schemes such as `` moving mesh '' and `` mesh free '' schemes . we conclude that both the standard sph without artificial conductivity and eulerian mesh codes have serious problems even such an idealized simulation , while disph , sph with artificial conductivity , and quasi - lagrangian schemes have sufficient capability to deal with it . </S>"
  ]
}