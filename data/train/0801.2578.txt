{
  "article_text": [
    "microlensing planets are being discovered at an accelerating rate , with one being reported in 2003 @xcite , three in 2005 @xcite , two in 2006 @xcite , and perhaps as many as six in 2007 .",
    "it has been a huge challenge for modelers to keep up with these discoveries , in large part because the computing requirements are often daunting : the parameter space is large , the @xmath0 surface is complex and generally contains multiple minima , and the magnification calculations are computationally intensive .",
    "proper treatment of individual events can require tens of thousands processor hours , or more .",
    "indeed , some potential planetary events have still not been fully modeled because of computational challenges .",
    "planetary microlensing events are recognized through two broad channels , one in which the lightcurve perturbation is generated by the so - called `` planetary caustic '' that is directly associated with the planet @xcite and the other in which it is generated by the `` central caustic '' that is associated with the host star @xcite .",
    "the former events are relatively easy to analyze and indeed the event parameters can be estimated reasonably well by inspection of the lightcurve .",
    "the latter events are generally much more difficult",
    ".    there are several interrelated reasons for this .",
    "first , planets anywhere in the system can perturb the central caustic .",
    "this is why these events are avidly monitored , but by the same token it is often not obvious without an exhaustive search which planetary geometry or geometries are responsible for the perturbation .",
    "second , this very fact implies that several members of a multi - planet system can be detected in central - caustic events @xcite .",
    "multiple planets create a larger , more complicated parameter space , which can increase the computation time by a large factor .",
    "even if there are no obvious perturbations caused by a second planet , an exhaustive search should be conducted to at least place upper limits on their presence .",
    "third , if the source probes the central caustic , it is ipso facto highly magnified .",
    "such events are brighter and more intensively monitored than typical events and so have more and higher - quality data .",
    "while such excellent data are of course a boon to planet searches , they also require more and more - accurate computations , which requires more computing time .",
    "fourth , central - caustic planetary events are basically detectable in proportion to the size of the caustic , which roughly scales @xmath1 , where @xmath2 is the planet / star mass ratio and @xmath3 is the planet - star separation in units of the einstein ring .",
    "thus , these events are heavily biased toward planets with characteristics that make the caustic big .",
    "such big caustics can undergo subtle changes as the planet orbits its host , and in principle these effects can be measured , thus constraining the planet s properties .",
    "exploration of these subtle variations requires substantial additional computing time .",
    "finally , there is also a bias toward long events , simply because these unfold more slowly and so increase the chance that they will be recognized in time to monitor them intensively over the peak .",
    "such long events often display lightcurve distortions in their wings due to the earth s orbital motion which , if measured , can further constrain the planet properties . however , probing this effect ( called `` microlens parallax '' ) requires yet another expansion of parameter space . moreover , the `` parallax '' signal must be distinguished from `` xallarap '' ( effects of the source orbiting a companion ) , whose description requires a yet larger expansion of parameter space .",
    "there are two broad classes of binary - lens ( or triple - lens ) magnification calculations : point - source and finite - source .",
    "the former can be used whenever the magnification is essentially constant ( or more precisely , well - characterized by a linear gradient ) over face of the source , while the latter must be used when this condition fails .",
    "point - source magnifications can be derived from the solution of a 5th ( or 10th ) order complex polynomial equation and are computationally very fast .",
    "when the point - source is well separated from the caustics ( as it must be to satisfy the linear - gradient condition ) then this calculation is also extremely robust and accurate .",
    "the main computational challenge in modeling planetary events comes from the finite - source calculations .",
    "almost all integration schemes use inverse - ray shooting , which avoids all the pathologies of the caustics by performing an integration over the _ image _ plane ( where the rays behave smoothly ) and simply asks which of the rays land on the source .",
    "the problem is that a large number of rays must be `` shot '' to obtain an accurate estimate of the magnification , which implies that high - quality data demand proportionately longer computations . of course",
    ", the higher the magnification , the larger the images , and so the more rays are required .",
    "there are various schemes to expedite inverse ray - shooting , including clever algorithms for identifying the regions that must be `` shot '' and pixelation of the source plane .",
    "the bottom line is , however , that the overwhelming majority of computation time is spent on finite - source calculations .    here",
    "i present a third class of binary - lens ( or triple - lens ) computation that is intermediate between the two classes just described : the hexadecapole approximation .",
    "@xcite expand finite - source magnification to hexadecapole order and illustrate that the quadrupole term by itself can give quite satisfactory numerical results . in this paper , i develop a simple prescription for evaluating this expansion .",
    "while this algorithm is about 10 times slower than point - source calculations , it is one to several orders of magnitude faster than finite - source calculations .",
    "the method can be applied whenever the source center is at least two source radii from a caustic or the extension from a cusp .",
    "well over half the non - point - source points satisfy this condition , meaning that the method can reduce computation times by a factor of several .",
    "moreover , by isolating the small regions of the lightcurve where finite - source calculations must be used , the method opens up the possibility that the finite - source computations themselves can be radically expedited for the special , but very interesting , class of events in which planetary orbital motion is measured .",
    "if the source does not straddle a caustic , then the magnification field can be taylor expanded around the source center @xmath4 as a function of coordinate position @xmath5 ( all distances being expressed in units of the einstein radius ) , @xmath6 we wish to evaluate @xmath7 , the magnification of a source of radius @xmath8 , @xmath9 in terms of the @xmath10 . here",
    "@xmath11 are polar coordinates : @xmath12 .",
    "to do so , we first average @xmath13 over a ring of radius @xmath14 and obtain , @xmath15 where @xmath16    to evaluate @xmath17 in terms of @xmath18 , @xmath19 , @xmath20 , we must first specify a limb - darkening law for the surface brightness @xmath21 , which for simplicity we take to be linear , @xmath22 { f\\over \\pi\\rho^2 } , \\label{eqn : limbdarken}\\ ] ] where @xmath23 is the limb - darkening coefficient and @xmath24 is the source flux .",
    "we then substitute into equation ( [ eqn : aofz ] ) to obtain @xmath25 note that the `` limb - darkening factors '' in parentheses are simply @xmath26 @xcite , and therefore do not depend on the magnification in any way .",
    "hence , for any given adopted limb - darkening profile , these can be calculated just once .",
    "let us now assume that the field is adequately described by a hexadecapole .",
    "averaging over the four points on a @xmath14-ring that are shifted by an arbitrary angle @xmath27 relative the cardinal directions , we obtain @xmath28 - a_0\\ ] ] @xmath29 while rotating this geometry by @xmath30 gives , @xmath31 for a given source of size @xmath8 and position @xmath4 , one can therefore determine @xmath18 , @xmath32 , @xmath33 , and @xmath34 , from a total of 13 point - source calculations , and thus derive @xmath35 which can then be substituted into equation ( [ eqn : afinite ] ) to obtain @xmath36 .",
    "clearly , this approximation can not be used when the source lies on a caustic , but how close can the source be before the approximation breaks down ?",
    "the breakdown will be driven by the leading term of the caustic s singularity , so it is sufficient to examine idealized cases whose leading - order behavior is the same as that of real caustics .",
    "more formally , one can write the magnification field as the linear sum of an idealized singularity and a more complicated , but well - behaved field . only the former will contribute to the breakdown of the approximation . since equations ( [ eqn : afinite ] ) , ( [ eqn : oplus ] ) , ( [ eqn : otimes ] ) , and ( [ eqn : a2a4 ] ) are strictly linear , this decomposition is absolutely rigorous .",
    "caustic singularities come in two basic varieties , fold caustics and cusps .",
    "the former diverge as @xmath37 as one approaches the caustic from the inside , where @xmath38 is the perpendicular distance to the fold .",
    "the latter are much more complex .",
    "they diverge as @xmath39 in the immediate neighborhood of the cusp as one approaches it from the outside .",
    "however , at greater distances , they develop into long `` fingers '' @xcite .      for simplicity ,",
    "i consider a uniform source that lies a distance @xmath40 ( where @xmath8 is the source radius ) from the fold .",
    "i begin by assuming that the magnification is dominated by the two `` new images '' that meet on the critical curve .",
    "i then discuss how the result is changed when this assumption is relaxed .",
    "the magnified flux is then given by @xmath41 which after some algebra [ e.g. , @xmath42 , simplifies to @xmath43 where @xmath44 .",
    "that is , @xmath45 hence the error due to the hexadecapole approximation is @xmath46    if one is `` sufficiently near '' a fold caustic , the magnification will always be dominated by the two `` new images '' . however , for planetary caustics , this will generally no longer be the case even at one or two source radii from the caustic .",
    "the net effect is to `` dilute '' the caustic divergence and so to make the the hexadecapole approximation valid at even closer separations than indicated by equation ( [ eqn : fold6 ] ) .",
    "[ sec : example ] .      for simplicity ,",
    "i analyze the case of a @xmath39 divergence and then discuss how the results may be expected to change for real cusps . in this case , we have @xmath47 @xmath48 which after some algebra [ e.g. , @xmath49 reduces to @xmath50 ^ 2 } , \\label{eqn : point7}\\ ] ] where , again , @xmath51 .",
    "that is , @xmath52 so that the error due to the hexadecapole approximation is , @xmath53    equation ( [ eqn : point9 ] ) gives a reasonable lower limit on how closely one may approach a cusp using the hexadecapole approximation .",
    "however , because the cusp develops a linear , finger - like structure at moderate distances , this approximation can fail well away from the cusp .",
    "nevertheless , i find numerically that the total duration of the failure is generally represented reasonably well by equation ( [ eqn : point9 ] ) .",
    "[ sec : example ] .",
    "thus , for both fold caustics and cusps , the hexadecapole approximation can reduce the error below 0.1% , except for intervals characterized by @xmath54 .",
    "the main consideration when implementing this approximation is to make certain that it is applied only in its range of validity .",
    "this is easiest when one is probing an already - located minimum , which is often the most time - consuming part of the investigation .",
    "one can then simply plot the difference between the hexadecapole approximation and the finite - source calculation for a _ single model _ as a function of time , and so locate empirically the regions of the former s range of validity .",
    "if a `` safety zone '' is placed around the finite - source regions , then there is little danger that it will be crossed during the minor excursions that occur while probing a minimum .",
    "it is straightforward to determine automatically whether such unexpected crossings are occurring simply by comparing the finite - source and hexadecapole calculations for the first and last points of each finite - source region .",
    "if these do not agree , the `` safety zone '' has been crossed .",
    "one must be more careful when applying this method to blind searches because it is harder to determine whether any particular stretch of the lightcurve is either crossing or nearby a caustic . in some cases , this will be straightforward and in others more difficult .",
    "the one general point to note is that the same `` safety zone '' check can be made .",
    "finally , i remark that in some of the lightcurve regions where the hexadecapole approximation is valid , it may be overkill : the quadrupole or even monopole ( point - source ) approximations may be perfectly satisfactory .",
    "again , it is straightforward to find these subregions , simply by mapping the hexadecapole / quadrupole and hexadecapole / monopole differences for a single model .",
    "figures [ fig : ex1 ] and [ fig : ex2 ] give a practical example of the hexadecapole approximation .",
    "the top panel of figure [ fig : ex1 ] shows a caustic geometry ( _ black _ ) that is based loosely on the caustic in the planetary event ogle-2005-blg-071 @xcite , but with a different source trajectory ( _ blue _ ) that has been chosen the maximize the number of illustrative `` features '' : the source passes by two cusps and then enters and exits the caustic .",
    "the middle panel shows the resulting lightcurve ( _ black _ ) together with three successive levels of approximation : monopole ( i.e. , point - source _ blue _ ) , quadrupole ( _ red _ ) , and hexadecapole ( _ green _ ) .",
    "the bottom panel shows the residuals of the latter three relative to the first .",
    "there are several points to note .",
    "first , the hexadecapole approximation works extremely well over the entire region shown except for a few source - radius crossing times in the immediate vicinity of the first cusp approach and the two caustic crossings .",
    "second , the point - source approximation basically does not work at all over the entire region shown , at least if one is attempting to achieve precisions of 0.1% ( which is typically required ) .",
    "third , there are significant regions where the quadrupole approximation is adequate .",
    "figure [ fig : ex2 ] is a zoom of figure [ fig : ex1 ] , focusing on the region of the two caustic crossings .",
    "the crosses in the bottom panel show the predictions for the breakdown of the quadrupole ( _ red _ ) and hexadecapole ( _ green _ ) approximation inside the caustic ( eqs .  [ [ eqn : fold5 ] ] and [ [ eqn : fold6 ] ] ) , assuming one is trying to achieve a precision of 0.05% .",
    "the _ black _ crosses indicate the prediction for breakdown outside the caustic , namely one source radius from the caustic .",
    "both the quadrupole and hexadecapole approximations prove to be too conservative in that the approximations remain valid substantially closer to the caustic than expected .",
    "the reason for this is clear from the middle panel : at the points of the predicted breakdown , the underlying magnification profile is no longer dominated by the square - root singularity that is produced by the two `` new images '' .",
    "recall from ",
    "[ sec : fold ] that equations ( [ eqn : fold5 ] ) and ( [ eqn : fold6 ] ) were specifically derived under the assumption these images would dominate the magnification .",
    "returning to figure [ fig : ex1 ] , the situation is more complex for the cusp approaches .",
    "equation ( [ eqn : point9 ] ) predicts that the hexadecapole approximation will break down from @xmath55 to @xmath56 .",
    "the actual breakdown is from @xmath57 to @xmath58 .",
    "this displacement to the left reflects the `` finger '' of enhanced magnification that extends from the cusp axis , as indicated in the top panel .",
    "in fact , i find that for trajectories passing farther from this caustic , the breakdown occurs at even earlier times , again corresponding to the intersection of the trajectory with the cusp axis ( rather than the point of closest approach )",
    ". moreover , the breakdown continues to occur even when the point of closest approach is well beyond the separation predicted by equation ( [ eqn : point9 ] ) .",
    "nevertheless , the full duration of the breakdown is never much greater than @xmath59 as predicted by this equation . in brief , for cusps , the hexadecapole approximation does work except for brief intervals whose duration is given by equation ( [ eqn : point9 ] ) , but the time of breakdown is not accurately predicted by this equation .",
    "similar remarks apply to the quadrupole approximation .",
    "while the hexadecapole approximation can save substantial computation time in a wide range of cases , it may be especially useful for planetary lenses with measurable orbital motion by rendering them accessible to the `` magnification map '' technique @xcite .",
    "magnification maps are potentially very powerful .",
    "one first chooses `` map parameters '' , i.e. , @xmath60 for a single planet or @xmath61 for a triple system , where @xmath27 is the angle between the two planets .",
    "then one shoots the entire einstein ring ( out to a specified width corresponding to , say , magnification @xmath62 ) .",
    "one then both stores the individual rays and tiles the source plane with hexagonal pixels , keeping track of the number of rays landing in each pixel .",
    "pixels landing wholly within the source are evaluated at their centroid , while pixels that cross the boundary are evaluated on a ray - by - ray basis . using this map",
    ", one can minimize over the remaining microlensing variables ( time of closest approach @xmath63 , impact parameter @xmath64 , einstein timescale @xmath65 , source trajectory angle @xmath66 , source size @xmath8 , as well as parallax and xallarap parameters , if these are needed ) .",
    "each map can be created in a few seconds and fully explored in a few minutes , thereby permitting a rapid markov - chain walk through map space .",
    "the drawback is that , to date , magnification maps have not been applicable to lenses with significant orbital motion : to the extent that the lens separation changes during the event , different maps would be needed at different phases of the event , potentially a very large number of them . in some cases ,",
    "this problem is now completely resolved .",
    "for example , ogle-2005-blg-071 exhibits some signature of rotation @xcite , which had been difficult to probe simultaneously with finite - source effects .",
    "because the source trajectory comes no closer than @xmath67 source radii from the cusp , this event can now be handled completely in the hexadecapole approximation .    however , even for events with one or several caustic features that require finite - source calculations , it will now be possible to evaluate these with maps .",
    "each caustic feature lasts only about the time required for the source to cross its own diameter , which is typically a few hours .",
    "the orbital motion during these features is negligible , implying that the lens geometry can be adequately represented by a single map .",
    "several maps can be created , one for each feature occurring at different times .",
    "the points `` between features '' can be evaluated in the hexadecapole approximation , which allows a continuously evolving lens geometry .",
    "i have identified an intermediate regime between the ones where finite - source effects are dominant and negligible , respectively . in this regime , magnifications can be evaluated with very high precision using a simple hexadecapole approximation , for which i give a specific prescription . outside of small ( few source - diameter crossing times )",
    "regions associated with caustic crossings and cusp approaches , the approximation has a fractional error of well under 0.1% .",
    "some events can now be analyzed without any traditional finite - source calculations , while for others these calculations will be drastically reduced . in particular , by restricting the regions that do absolutely require finite - source calculation to a few isolated zones , this approximation opens the possibility of applying `` magnification maps '' to planetary systems experiencing significant orbital motion ."
  ],
  "abstract_text": [
    "<S> the frequency of microlensing planet detections , particularly in difficult - to - model high - magnification events , is increasing . </S>",
    "<S> their analysis can require tens of thousands of processor hours or more , primarily because of the high density and high precision of measurements whose modeling requires time - consuming finite - source calculations . </S>",
    "<S> i show that a large fraction of these measurements , those that lie at least one source diameter from a caustic or the extension from a cusp , can be modeled using a very simple hexadecapole approximation , which is one to several orders of magnitude faster than full - fledged finite - source calculations </S>",
    "<S> . moreover , by restricting the regions that actually require finite - source calculations to a few isolated `` caustic features '' , the hexadecapole approximation will , for the first time , permit the powerful `` magnification - map '' approach to be applied to events for which the planet s orbital motion is important . </S>"
  ]
}