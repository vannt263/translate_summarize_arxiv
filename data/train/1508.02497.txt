{
  "article_text": [
    "the economist thomas schelling introduced his model of segregation in @xcite ( developed later in @xcite ) , with the explicit intention of explaining the phenomenon of racial segregation in large cities .",
    "perhaps the earliest agent - based model studied by economists , since then it has become an archetype of agent - based modelling , prominently featuring in libraries of modelling software tools such as netlogo @xcite and often being the subject of experimental analysis and simulations in the modeling and ai communities @xcite .",
    "many versions of the model have been analysed theoretically , from a number of different viewpoints and disciplines : statistical mechanics @xcite and ( * ? ? ?",
    "* section 3.1 ) , evolutionary game theory @xcite the social sciences @xcite , and more recently computer science and ai @xcite .",
    "it was observed in @xcite , however , that despite the vast amount of work that has been done on the schelling model in the last 40 years , rigorous mathematical analyses in the previous literature generally concern altered versions of the model , in which noise is introduced in the dynamics , i.e.  where one allows that agents may make non - rational decisions that are detrimental to their welfare with small probability .",
    "the introduction of such ` perturbations ' may be justifiable from a ` bounded rationality ' standpoint .",
    "the model ( which will be formally defined shortly ) concerns a population of agents arranged geographically , each being of one of two types .",
    "each agent has a certain neighbourhood around them that they are concerned with , and also an intolerance parameter @xmath0 $ ] which we shall assume here to be the same for all agents .",
    "an agent s behaviour is dictated by the proportion of the agents in their neighbourhood which are of its own type .",
    "so long as this proportion is @xmath1 the agent may be considered ` happy ' and will not move . starting with a random configuration ,",
    "one then considers a discrete time dynamical process . at each stage",
    "unhappy agents may be given the opportunity to move , swapping positions with another agent , so as to increase the proportion of their own type within their neighbourhood .",
    "now one might justify a perturbed version of these dynamics , in which agents will occasionally move in such a way as to decrease their utility ( i.e.   the proportion of their own type within their neighbourhood ) by arguing , for example , that it is reasonable to suppose that only incomplete information about the make - up of each neighbourhood is available to the agents .",
    "it is a fact , however , that    * the methods used for the analysis of the perturbed models do not apply to the unperturbed model ; * the segregation that occurs in the perturbed models is often very different than in the unperturbed model .    in the unperturbed models the underlying markov chain does not have the regularities that are found in the perturbed case ( e.g.  the markov process is irreversible ) .",
    "the presence of a large variety of absorbing states means that entirely different and more combinatorial methods are now required . beyond the basic aim of a rigorous analysis for these unperturbed models ,",
    "which have been so extensively studied via simulations , further motivation is provided by the fact that the schelling model is part of a large family of models , arising in a broad variety of contexts  spin glass models , hopfield nets , cascading phenomena as studied by those in the networks community  all of which look to understand the discrete time dynamics of competing populations on underlying network structures of one kind or another , and for many of which the unperturbed dynamics are of significant interest .",
    "the hope is that techniques developed in analysing unperturbed schelling segregation may pave the way for similar analyses in these variants of the model .",
    "the first rigorous analysis of an unperturbed schelling model was described by brandt , immorlica , kamath , and kleinberg in @xcite . in this work",
    "it was also demonstrated that the eventual state of the process differs significantly from the stochastically stable states of the perturbed models .",
    "this study focused on the one - dimensional schelling model and provided an asymptotic analysis , in the sense that the results hold with arbitrarily high probability for all sufficiently large neighbourhoods and population .",
    "more significantly , however , it dealt only with the symmetric case where intolerance parameter @xmath2 ( i.e.  an agent is happy when at least 50% of the agents in its neighbourhood are of its own type ) . in @xcite",
    "a much more general analysis of the unperturbed one - dimensional schelling model for @xmath0 $ ] was provided .",
    "in fact it was shown there that various forms of surprising threshold behaviour exist .",
    "a significant symmetry assumption underlying the results in @xcite is that the populations of the two types of agents are assumed to be uniform ( i.e.  each agent has equal chance of being of each type in the initial configuration ) .",
    "indeed , there is no rigorous study of the unperturbed spacial proximity model with swapping agents for the rather realistic case where the distribution of the two types of agents is skewed .",
    "in fact , the question as to what type of segregation occurs with a skewed population distribution was raised by brandt , immorlica , kamath , and kleinberg in ( * ? ? ? * section 4 ) as well as in popular expositions of the schelling model like @xcite .",
    "the purpose of the present work is to give an answer to this question .",
    "we show that complete segregation is the likely outcome if and only if the intolerance parameter is larger than @xmath3 .",
    "moreover in the case that the minority type is at most 25% , there is a dichotomy between complete segregation and almost complete absence of segregation .",
    "schelling s model of residential segregation belongs to a large family of agent - based models , where a system of competitive agents perform actions in order to increase their personal welfare , while possibly decreasing the welfare of other individuals .",
    "this phenomenon roughly corresponds to the so - called _ spontaneous order approach _ in economics literature , which studies the emergence of norms from the endogenous agreements among rational individuals .",
    "the schelling model that we study is a direct generalisation of that in @xcite and also that studied by the authors in @xcite .",
    "the one - dimensional model with parameters @xmath4 ( as listed in table [ ta : paraandmainres ] ) is defined as follows .",
    "we consider @xmath5 individuals which occupy an equal number of _ sites _",
    "@xmath6 ( ordered clockwise ) on a circle .",
    "each of the individuals belongs to one of the two types @xmath7 and @xmath8 .",
    "the type assignment of individuals is independent and identically distributed ( i.i.d . ) , with each individual having probability @xmath9 of being type @xmath8 . without loss of generality",
    "we always assume that @xmath10 , i.e.  that the individuals of type @xmath8 are the expected minority ( so long as @xmath11 ) .",
    "this random type assignment takes place at stage 0 of the process , and defines the _ initial state_. at the end of stage 0 , we let @xmath12 be the _ actual _ proportion of the individuals that are of type @xmath8 .    unless stated otherwise , addition and subtraction on indices for sites are performed modulo @xmath5 . given two sites @xmath13 in any configuration of the individuals on the circle , the interval @xmath14 $ ] consists of the individuals that occupy sites between @xmath15 and @xmath16 ( inclusive ) .",
    "for example , if @xmath17 then we let @xmath18 $ ] denote the set of nodes @xmath19 \\cup [ 0,v]$ ] ( while @xmath20 $ ] is , of course , understood in the standard way ) .",
    "when we talk about a particular configuration , we identify each individual with the site it occupies , referring to both entities as a _",
    "node_. the _ neighbourhood _ of node @xmath15 consists of the interval @xmath21 $ ] where @xmath22 is a parameter of the model that we call the ( neighbourhood ) _ radius_. the _ tolerance threshold _",
    "@xmath23 is another parameter of the model that reflects how tolerant a node is to nodes of different type in its neighbourhood .",
    "we say that a node is _ happy _ if the proportion of the nodes in its neighbourhood which are of its own type is at least @xmath24 .",
    "are in @xmath25 $ ] .",
    "the two - dimensional axes refer to @xmath24 and @xmath9 . in the first figure ,",
    "the process is static except for the @xmath26 in the small area at the top right corner .",
    "the second figure is a plot of @xmath27 and @xmath28 ( for w=100 ) as functions of @xmath26 .",
    "the third figure is a plot of @xmath29 for w=100.,title=\"fig : \" ]    are in @xmath25 $ ] .",
    "the two - dimensional axes refer to @xmath24 and @xmath9 . in the first figure ,",
    "the process is static except for the @xmath26 in the small area at the top right corner .",
    "the second figure is a plot of @xmath27 and @xmath28 ( for w=100 ) as functions of @xmath26 .",
    "the third figure is a plot of @xmath29 for w=100.,title=\"fig : \" ]   are in @xmath25 $ ] .",
    "the two - dimensional axes refer to @xmath24 and @xmath9 . in the first figure , the process is static except for the @xmath26 in the small area at the top right corner .",
    "the second figure is a plot of @xmath27 and @xmath28 ( for w=100 ) as functions of @xmath26 .",
    "the third figure is a plot of @xmath29 for w=100.,title=\"fig : \" ]    given the initial type assignment ( colouring ) of the nodes , the _ schelling process _ then evolves dynamically in stages as follows . at each stage",
    "@xmath30 we pick uniformly at random a pair of unhappy nodes of different type , and we swap them provided that in both cases the number of nodes of the same type in the new neighbourhood is at least that in the original neighbourhood . if at some stage there are no further legal swaps the process terminates .",
    "if at some stage all nodes of the same type are grouped into a single block , we say that at that stage we have _",
    "complete segregation_.    this completes the definition of the schelling process with parameters @xmath31 and @xmath9 , which we denote by the tuple @xmath32 .",
    "the process can be seen as a markov chain with @xmath33 states corresponding to the configurations that we get by varying the type of each node between @xmath7 and @xmath8 .",
    "a state is called _ dormant _ if either all @xmath7-nodes are happy , or all @xmath8-nodes are happy",
    ". we shall be interested in the case that @xmath22 is large , and that @xmath5 is large compared to @xmath22 . in this context",
    "it will turn out that the absorbing states of the schelling process are exactly the dormant states and , in fact , the only recurrence classes of the schelling process are the dormant states and complete segregation .",
    "note that the number of nodes of type @xmath7 and of type @xmath8 does not change between transitions , once the initial state has been chosen .",
    "given the schelling process @xmath32 we wish to determine with high probability the type of equilibrium that will eventually occur in the system .",
    "moreover , we are interested in asymptotic results , i.e.  statements that hold with arbitrarily high probability for all sufficiently large @xmath22 and all sufficiently large @xmath5 compared to @xmath22 .",
    "we denote this quantification on @xmath34 by ` @xmath35 and @xmath36 ' respectively ( and write ` @xmath37 ' for the combined statement ) .",
    "the following definition encapsulates the type of asymptotic statements about the schelling process @xmath38 that we are interested in establishing .",
    "[ de : prophighprob][defi : staticproc ] suppose that @xmath39 is a property which may or may not be satisfied by any given run of the schelling process @xmath32 , and @xmath40 is a property of the parameters @xmath41 . by the sentence `` if @xmath42 , then with high probability @xmath43 '' we mean that , provided that @xmath41 satisfy @xmath40 , for every @xmath44 and all @xmath45 , @xmath46 the process @xmath32 satisfies @xmath39 with probability at least @xmath47 .",
    "we say that the process @xmath48 is static if , given @xmath44 , with high probability the number of nodes that ever change their type in the entire duration of the process is @xmath49 .    by @xcite , the asymptotic behaviour of the process",
    "@xmath48 is known for @xmath50 ( except perhaps on the threshold @xmath51 ) .",
    "the present work is dedicated to the case where one type of node is the minority , i.e.  when @xmath52 .",
    "we show that with probability 1 the process will either reach complete segregation or reach a dormant state .",
    "complete segregation is , strictly speaking , a a recurrence class of the process , consisting of the rotations of the two blocks , one consisting of all the @xmath7-nodes and the other consisting of all the @xmath8-nodes .",
    "hence , modulo symmetries , we may regard complete segregation as an absorbing state .",
    "dormant states are a different kind of absorbing state , as the process actually stops when it hits a dormant state .",
    "we show that when @xmath53 the highly probable outcome is complete segregation",
    ". moreover , in many cases when @xmath54 the outcome is negligible segregation ( i.e.  the process is static ) .",
    "let @xmath55 and @xmath56 be the unique solutions of @xmath57 and @xmath58 respectively in @xmath59 $ ] .",
    "[ th : complsegm ] if @xmath53 , @xmath52 and @xmath60 , then with high probability the schelling process @xmath48 reaches complete segregation .",
    "the process @xmath32 is static ( with high probability ) if @xmath61\\hspace{0.5cm}or\\hspace{0.5 cm } [ $ \\tau\\leq \\kappa_0 $ \\ & $ \\rho<0.5$]\\hspace{0.5cm}or\\hspace{0.5 cm }",
    "[ $ \\tau\\leq 0.5 $ \\ & $ \\rho\\leq 0.25 $ ] } } \\ ] ] or , more generally , if @xmath62 .",
    "the values of @xmath26 for which we show that the process is static , correspond to the yellow area of the first diagram ( or , equivalently , the collapsed part of the surface of the third diagram ) of figure [ fig : red_3d_tr ] . the case when @xmath63 presents a remarkable contrast as @xmath24 crosses the boundary of @xmath3 . in this case , when @xmath24 exceeds the threshold @xmath3 , the process changes from static to the other extreme of complete segregation .",
    "[ coro : drphasetans ] if @xmath63 , then with high probability the process @xmath32    * converges to complete segregation if @xmath53 ; * is static , if @xmath54 .",
    "moreover with high probability it reaches its final state in time @xmath64 , if @xmath54 and time @xmath65 , if @xmath66 .",
    "we display these results in the second item of table [ ta : paraandmainres ] . in sections",
    "[ se : analyticsche][se : casetaubhalf ] we present the argument that proves these results .",
    "this argument uses a number of smaller results which are stated without proof , and are the building blocks of the proof of theorem [ th : complsegm ] .",
    "it is our intention that the reader gets a fairly good understanding of our analysis in this part of the paper , without the burden of having to verify some of the more technical parts of the proof .",
    "section [ se : prelim ] is an appendix with detailed proofs of all the facts that were used in sections [ se : analyticsche][se : casetaubhalf ] , and completes the proofs of theorem [ th : complsegm ] and corollary [ coro : drphasetans ] .",
    "our proof of theorem is nonuniform , and the analysis is roughly divided in the two cases displayed in table [ ta : validptwocasesnadcorr ] : _ balanced and unbalanced happiness_. here _ happiness _ refers to the numbers of initially happy nodes of the two types , and determines the dynamics that drives the process to an equilibrium .",
    "of the two cases , _ unbalanced happiness _ is the most challenging to deal with , and the dynamics is driven by small number of unhappy @xmath7-nodes against the large number of unhappy @xmath8-nodes , which in fact is preserved throughout a significant part of the process .",
    "one of the most challenging problems in the analysis of the segregation process is the large number of absorbing states . in order to understand which transitions are possible , we use certain metrics that describe the current state .     and the second one from the process @xmath67 .",
    "these simulations illustrate that the number @xmath7-nodes in the infected area remains bounded , until the number of @xmath8-nodes outside the infected area becomes small .",
    "the second figure also illustrates the fact that the number of unhappy nodes fluctuates locally . ]",
    "we define global metrics that reflect the welfare of the entire population .",
    "an obvious choice is the number of happy nodes at a given state .",
    "it is not hard to devise transitions of the process which reduce the total number of happy nodes ( see the second plot of figure [ fig : inf_area ] ) .",
    "however it is possible to show that if @xmath53 the total number of happy nodes is _ approximately non - decreasing _ ( in the sense that it is @xmath68 for some nondecreasing function @xmath69 on the stages , where the underlying constant depends only on @xmath22 ) .",
    "let the _ utility _ of a node ( at a certain state ) be the number of nodes of the same type in its neighborhood .",
    "a better behaved global metric of welfare of a state is the sum of the utilities of the nodes in the state .",
    "we call this parameter the _ social welfare _ of the state and denote it by @xmath70 . a consequence of the transition rule and the definition of utility is that the _ social welfare _ does not decrease along the stages of the process . furthermore , if @xmath54 , every transition of the process strictly increases the social welfare .",
    "let the _ mixing index _ of a node be the number of nodes in its neighbourhood that are of different type . the _ mixing index _",
    "@xmath71 of a state is the sum of the mixing indices of the @xmath7-nodes in that state .",
    "the mixing index of a state is also equal to the sum of the mixing indices of the @xmath8-nodes in that state .",
    "the relationship between the two metrics is @xmath72 hence the mixing index is non - increasing along the transitions .",
    "note that a single swap can not decrease the mixing index by more than @xmath73 . on the other hand , by linearity of expectation we can calculate that @xmath74 the mixing index of complete segregation ( in nontrivial cases ) is @xmath75 . since @xmath76",
    ", this means that ( with high probability ) the process can reach complete segregation only after @xmath77 stages , i.e.  @xmath65 stages . on the other hand",
    ", a case analysis shows that if @xmath54 , each step in the process decreases the mixing index by at least 4 .",
    "this means that if @xmath54 and the process is static , then it reaches its final state within @xmath64 stages .",
    "this happens because each time a swap occurs , the mixing index decreases by at least 4 ( so its not possible that the same few nodes swap more than @xmath64 times ) .",
    "we have shown that the second clause of corollary [ coro : drphasetans ] ( concerning the time to the final state ) follows from the first clause .",
    "as another measure of mixing , we may consider the number @xmath78 of maximal @xmath8-blocks in the state .",
    "these are the contiguous @xmath8-blocks that are maximal , in the sense that they can not be extended to a larger contiguous @xmath8-block .",
    "let @xmath79 be the number of unhappy nodes in a state .",
    "it is not hard to show that if @xmath53 then @xmath80 and in particular @xmath81 this means that the number of unhappy nodes at a certain state reflects the progress of the process towards segregation .",
    "more precisely , the metrics @xmath71 , @xmath82 , @xmath79 are mutually proportional when @xmath53 , where the analogy coefficient depends on @xmath22 ( see figure [ fig : inf_area ] ) . in table",
    "[ ta : validprglobbouatd ] we display these global metrics of welfare , along with their dynamics .",
    "a function ( on the stages of the process ) has positive dynamics if it is non - decreasing and approximately positive dynamics if it is @xmath68 for some nondecreasing function @xmath69 , where the multiplicative constant does not depend on @xmath5 .",
    "similar definitions apply for ` negative ' .",
    "the first clause of theorem [ th : complsegm ] ( the case when @xmath53 ) is the hardest to prove .",
    "it turns out that in this case we can deduce a non - trivial lower bound on the mixing index of dormant states .",
    "[ le : mixindorsta ] consider the process @xmath32 with @xmath53 .",
    "the mixing index in a dormant state is more than @xmath83 , as long as @xmath84 .",
    "the case @xmath53 is further divided in two cases , which reflect the proportions of happy nodes in the initial state .",
    "we display these in table [ ta : validptwocasesnadcorr ] , along with the corresponding expectations for the numbers of happy nodes of each type .",
    "lemma [ le : mixindorsta ] is crucial for the proof of the first clause of theorem [ th : complsegm ] ( in particular the case @xmath85 ) .",
    "we show the case of theorem [ th : complsegm ] where @xmath53 and @xmath86 .",
    "this argument consists of two parts .",
    "first , we show that in this case with high probability the initial state is such that every state with the same number of @xmath7-nodes has unhappy nodes of both types ( i.e.  it is not dormant ) .",
    "hence under these conditions , no accessible state is dormant .",
    "the second part consists of showing that from every state there is a sequence of transitions to either a dormant state or complete segregation .",
    "moreover the latter fact holds in general , for any values of @xmath87 , so it can be reused for the case when @xmath85 , in section [ se : recomsehaca ] .",
    "this latter case is more challenging , as it can be seen that there are permutations of the initial state which are dormant .",
    "[ coro : exiunhangen ] suppose that @xmath53 , @xmath88 and @xmath22 is sufficiently large .",
    "then for every @xmath89 and all sufficiently large @xmath5 , every state of the process @xmath32 has more than @xmath90 unhappy @xmath8-nodes .",
    "if in addition @xmath91 , every state also has more than @xmath90 unhappy @xmath7-nodes .",
    "given @xmath9 , by the law of large numbers with high probability ( tending to 1 , as @xmath5 tends to infinity ) @xmath12 will be arbitrarily close to @xmath9 . hence we may deduce the absence of dormant states ( with high probability ) in the case that @xmath86 .",
    "[ coro : absdormst.g ] if @xmath92 and @xmath86 then with high probability none of the accessible states of the process @xmath32 is dormant .",
    "it remains to show the accessibility of either a dormant state or complete segregation , from any state of the process .",
    "an inductive argument can be used in order to prove this fact .",
    "[ coro : inevcompsegd ] from any state of the process @xmath32 with @xmath37 there exists a series of transitions to complete segregation or to a dormant state .",
    "here is a sketch of the proof . if @xmath54 the mixing index is strictly decreasing through the transitions , so it is immediate that the process will reach a dormant state ( indeed , 0 is a lower bound for the mixing index ) . for the case where @xmath53 ( which we assume for the duration of this discussion ) we can argue inductively , in four steps . an interval of nodes of the same type",
    "is called a _",
    "contiguous block_. first we show that from a stage with few unhappy nodes of one type ( here @xmath93 is a convenient upper bound of what we mean by ` few ' , which is by no means optimal ) there is a series of transitions which lead to either a state with a contiguous block of length @xmath94 or a dormant state .",
    "second , from a state with a contiguous block of length @xmath95 there is a series of transitions to complete segregation or to a dormant state .",
    "third , any state which has at least @xmath96 unhappy nodes of each type , there is a series of transitions to a state with a contiguous block of length at least @xmath22 . finally from a state that has a contiguous block of length @xmath97 and at least @xmath73 unhappy nodes of opposite type from the block , there is a series of transitions to a state with a contiguous block of length @xmath95 .",
    "the combination of these four statements constitutes a strategy for arriving to a dormant state or a state of complete segregation , from any given state .",
    "we illustrate this strategy in figure [ fig : skewstratcomd ] , where two arrows leaving a node indicate that at least one of these routes are possible .    .",
    "this case of theorem [ th : complsegm ] is challenging because we need to show that the process avoids accessible dormant states , until it reaches a _ safe state _",
    "i.e.  a state from which no dormant state is accessible .",
    "the reason for this avoidance is ( in contrast with the case @xmath86 of section [ subse : accdorcose ] ) the dynamics of the process with the given parameters .",
    "the methodology we use is based on a martingale argument , which involves a great deal of the analytical tools ( e.g.  the metrics of social welfare ) and their properties that were developed in the previous sections . having shown that dormant states are avoided until the process reaches a safe state , lemma [ coro : inevcompsegd ] gives theorem [ th : complsegm ] ( for the case where @xmath53 and @xmath85 ) .",
    "an overview of this argument is given in figure [ fig : dysimpleskads ] .      according to our plan",
    ", we wish to establish the existence of unhappy nodes of both types until a safe state is reached . by lemma",
    "[ coro : exiunhangen ] , we do not have to worry about the existence of unhappy @xmath8-nodes .",
    "one device that guaranties the existence of unhappy @xmath7-nodes is a contiguous block of @xmath8-nodes , of length at least @xmath22 . such a block exists in the initial random state ( with high probability ) .",
    "one way to argue for its preservation in subsequent stages is to consider the ratio of the unhappy nodes of the two types . even more relevant",
    "is the ratio between the number of unhappy @xmath7-nodes , and the number of @xmath8-nodes which are not just unhappy , but actually sufficiently unhappy that they can swap with any unhappy @xmath7-node .",
    "[ de : veryunhapy ] given a stage of the process , a node of type @xmath8 is very unhappy if there are at least @xmath98 nodes of type @xmath7 in its neighbourhood .",
    "the number of very unhappy @xmath8-nodes is denoted by @xmath99 .    in the case that we study ( @xmath53 and @xmath85 ) initially , the number of very unhappy @xmath8-nodes is @xmath65 while the number of unhappy @xmath7-nodes is @xmath64 .",
    "the following lemma says that as long as this imbalance is preserved , it is very likely that a sufficiently long contiguous block of @xmath8-nodes is preserved .",
    "[ le : persistb ] consider the process @xmath48 with @xmath53 and let @xmath100 be the least stage where the ratio between the very unhappy @xmath8-nodes and the unhappy @xmath7-nodes becomes less than @xmath101 ( putting @xmath102 if no such stage exists ) .",
    "then with high probability there is a @xmath8-block of length @xmath95 at all stages @xmath103 of the process .",
    "since a @xmath8-block of length at least @xmath22 is a guarantee for unhappy @xmath7-nodes , we get the following corollary .    [ le : percosistb ] under the hypotheses of lemma [ le : persistb ] , with high probability there are unhappy @xmath7-nodes at all stages @xmath103 of the process .    it remains to construct an elaborate martingale argument in order to show that the imbalance between @xmath104 and @xmath105 persists for a sufficiently long time ( until the process reaches a safe state ) .      in the case of unbalanced happiness ( i.e.  when @xmath53 , @xmath85 , see table [ ta : validptwocasesnadcorr ] ) the unhappy @xmath7-nodes are initially very rare , so the interesting activity ( namely @xmath7-to-@xmath8 swaps ) occurs in small intervals of the entire population ( at least in the early stages ) . these intervals contain the unhappy @xmath7-nodes , and gradually expand , while outside these intervals all @xmath8-nodes are very unhappy .",
    "figure [ fig : biasplot ] shows the development of this process , where the height of the nodes ( perpendicular lines ) is proportional to the number of @xmath7-nodes in their neighborhood and the horizontal black line denotes the threshold where an @xmath7-node becomes unhappy .",
    "hence nodes with high proportion of @xmath7-nodes in their neighbourhood will be higher than the nodes with low proportion of @xmath7-nodes in their neighbourhood .",
    "the three horizontal bars are snapshots of the process , and show cascades forming , originating from the initially unhappy @xmath7-nodes .",
    "figure [ fig : cicle_slides ] shows the same process , with the current state in the outer circle , and with swaps represented by a dot at a distance from the center which is proportional to the stage where the swap occurred .",
    "these cascades that spread the unhappy @xmath7-nodes are due to the following domino effect .",
    "an unhappy @xmath7-node moves out of a neighbourhood , thus reducing the number of @xmath7-nodes in that interval .",
    "this in turn often makes another @xmath7-node in the interval unhappy , which can move out at a latter stage , thus causing another @xmath7-node nearby to be unhappy , and so on .",
    "the expanding intervals are the _ infected segments _ which start their life as _",
    "incubators_. for the sake of simplicity , we omit the formal definitions of these notions , which can be found in the appendix . roughly speaking ,",
    "incubators are a small intervals that surround the unhappy @xmath7-nodes in the initial state .",
    "moreover they are defined in such a way that , every @xmath8-node that is outside the incubators is _ very unhappy _ in the initial state . during the process , as we discussed above , these expand into larger _ infected segments _ , so that at each stage every unhappy @xmath7-node is inside an infected segment .",
    "the union of all infected segments is called the _ infected area_. at any stage , every @xmath8-node outside",
    "the infected area is _ very unhappy _ and every @xmath7-node outside the infected area is happy .",
    "it is not hard to show that if @xmath85 , the probability that a node belongs to an incubator is @xmath106 .",
    "hence with high probability the number of incubators as well as the number of nodes belonging to incubators of the process @xmath48 is @xmath107 .",
    "it turns out that the number of unhappy @xmath8-nodes in an interval of nodes , is conveniently bounded in terms of the number of @xmath7-nodes in the interval .",
    "this means that if the number of @xmath7-nodes in the infected area remains @xmath64 , then the number of unhappy @xmath8-nodes in the infected area also remains @xmath64 . in order to give a clear sketch of the argument depicted in figure [ fig : dysimpleskads ] ( for the current case when @xmath53 and @xmath85 )",
    "let us define the global variables in table [ ta : pranvarinfarfa2 ] ( for the current discussion we will not be concerned with @xmath108 or its definition ) . note that since @xmath109 .",
    "a combinatorial argument can be used in order to show that @xmath110 .",
    "hence @xmath111 by we know that a stage where the number of unhappy nodes is less than @xmath112 is a safe stage . hence we wish to show that ( with high probability ) the process will arrive at a stage where each of the three summands in are at most @xmath113 . we know that @xmath114 can be bounded appropriately .",
    "our main argument will show how to obtain a similar bound for @xmath115 .",
    "note that @xmath116 plays a different role , since it is initially large and shrinks monotonically ( as the infected area expands monotonically ) . in order to find a stage where @xmath116 becomes sufficiently small , it is instructive to consider what is a typical swap in the process . at the start of the process",
    "the infected area is a very small proportion of the entire ring .",
    "the vast majority of unhappy @xmath8-nodes occur outside the infected area , while all unhappy @xmath7-nodes are inside the infected area .",
    "it follows that with high probability a swap will involve an @xmath7-node in the infected area and a @xmath8-node outside the infected area .",
    "bogus swap _ is a swap is one that is not of this kind .",
    "a swap which involves a @xmath8-node currently inside the infected area is called bogus . given an infected segment @xmath117 , a bogus swap in @xmath117 is a swap that moves an @xmath7-node into @xmath117 .",
    "note that any swap which is not bogus , reduces @xmath116 by at least 1 .",
    "hence if we show that the bogus swaps have small probability throughout a significant part of the process , we can ensure that @xmath116 becomes sufficiently small . in order to be more precise ,",
    "recall the stopping time @xmath100 from lemma [ le : persistb ] .",
    "we introduce a few more stopping times , all of which will turn out to be earlier than @xmath100 ( with high probability ) .",
    "these basically concern the satisfaction of conditions which will ensure that the mixing index is sufficiently low as to guarantee a safe state . by we have @xmath118 and in order to ensure a safe state ( by lemma [ le : mixindorsta ] ) we want @xmath119 .",
    "so we want @xmath120 at some stage of the process .",
    "let @xmath121 be the first stage which satisfies this condition .",
    "similarly , consider the stopping times @xmath122 of the second part of table [ ta : validprglobbouatd ] ( for simplicity , we will not consider @xmath123 in the present discussion ) .",
    "we use an elaborate martingale argument in order to show the following .",
    "[ le : inthzbouwe ] if @xmath53 and @xmath85 , with high probability we have @xmath124 and @xmath125 for all @xmath126 .",
    "this lemma in combination with corollary [ le : persistb ] implies that @xmath127 .",
    "hence every stage up to @xmath128 involves a swap .",
    "then it follows from the second clause of lemma [ le : inthzbouwe ] that @xmath129 ( since @xmath116 is reduced by at least 1 at every non - bogus swap ) . hence by we have established ( with high probability ) the existence of a stage",
    "@xmath129 such that    @xmath130    hence by we have @xmath131 , which means that by stage @xmath128 a safe state has been reached .",
    "then by corollary [ coro : inevcompsegd ] the process will reach complete segregation , with probability @xmath132 .    [",
    "safe state arrival ] suppose that @xmath85 .",
    "then with high probability the process @xmath48 reaches a safe state by stage @xmath5 , and eventually complete segregation .",
    "this argument ( with the full details given in section [ se : prelim ] ) concludes the proof of theorem [ th : complsegm ] for the case @xmath53 .",
    "it remains to deal with the case @xmath133 .",
    "in this case the behaviour of the process @xmath48 is very different , since the mixing index is strictly decreasing .",
    "this means that the process is bound to arrive to a dormant state , with absolute certainty .",
    "note that if @xmath54 then complete segregation is a dormant state , but it can be shown that the final state is never complete segregation .",
    "we show that in most typical cases for @xmath9 , the outcome is static when @xmath54 .",
    "we assume that @xmath52 because the case @xmath50 has already been analysed in @xcite and the case @xmath134 is symmetric .",
    "hence on the hypothesis @xmath54 we have @xmath135 and by table [ ta : validptwocasesnadcorr ] the unhappy @xmath7-nodes are an arbitrarily small proportion of the @xmath7-nodes as @xmath136 . in any case , since @xmath137 we have @xmath138 , so the probability that an @xmath7-node is unhappy is much smaller than the probability that a @xmath8-node is unhappy",
    ". however what matters in the analysis for @xmath54 is the relationship between the likelihood of stable intervals and unhappy @xmath7-nodes .",
    "this analysis is a reminiscent of the work in @xcite , but has some new features .    .",
    "]    a stable interval is an interval of nodes of length @xmath22 which contains at least @xmath98 nodes of one or the other type .",
    "an interval is @xmath7-stable if it contains at least @xmath98 nodes of type @xmath7 .",
    "the @xmath8-stable intervals are defined analogously .",
    "note that no @xmath7-node which is inside an @xmath7-stable interval can swap during the process .",
    "the reason is that such @xmath7-nodes are happy just because of the presence of the other @xmath7-nodes in the same interval .",
    "then a simple induction shows that they will continue to be happy throughout the process , thereby remaining immune to swaps and fixed in their initial positions .",
    "a similar observation applies to @xmath8-stable intervals .",
    "the existence of stable intervals is characteristic to the case @xmath54 .",
    "the events we are interested are the occurrences of @xmath7-stable intervals and unhappy @xmath7-nodes .",
    "the probabilities @xmath139 of these two rare events can be viewed as tails of certain binomial distributions .",
    "consider the variables , probabilities and distributions of table [ ta : vlikelyghd ] .",
    "it is not hard to see that @xmath140 we are interested in the event where the ratio @xmath141 becomes small , because of the following fact .",
    "suppose that @xmath41 are such that @xmath142 for some @xmath143 .",
    "then with high probability the process @xmath38 is static , and in fact there exists some @xmath144 such that with high probability the process stops after at most @xmath145 many steps .",
    "the intuition here is that , if the unhappy @xmath7-nodes are much more rare than the stable @xmath7-stable intervals ( i.e.   if @xmath146 ) then it is very likely that unhappy @xmath7-nodes are enclosed in small intervals which are guarded by @xmath7-stable intervlas .",
    "this means that the familiar cascades that can be caused by the eviction of an unhappy @xmath7-node are bound to be contained in small areas of nodes .",
    "the very definition of stable intervals ensures that such cascades can not pass through them .",
    "hence the condition @xmath146 guarantees that any @xmath7-to-@xmath8 swaps are contained in small areas of nodes of total size @xmath64 . due to the monotonicity of the mixing index",
    ", this means that there can only be at most @xmath64 swaps in this case .    the second item in figure [ fig : red_3d_tr ] shows the probabilities @xmath139 ( for @xmath147 ) with respect to @xmath87 .",
    "we see that for points away from @xmath148 , the surface @xmath28 is above @xmath27 , and there is a threshold curve beyond which the opposite relationship is established . using basic results about the tail of the binomial distribution , and stirling s approximation",
    "we can derive the following sufficient condition for @xmath146 : @xmath149 the third item of figure [ fig : red_3d_tr ] is a representation of @xmath29 in the space , up to where it becomes negative , at which point we project it on the plane . the values of @xmath87 that we are interested correspond to points on the plane , outside the collapsed area .",
    "this boundary ( a curve ) is more clear in the first item of figure [ fig : red_3d_tr ] which is the projection of the surface to the plane , with different colours indicating the points which make @xmath69 positive or negative .",
    "this boundary can be simplified ( with slight loss of generality ) if we consider the line that passes from the two points where the boundary curve intersects the lines @xmath2 and @xmath50 . hence if @xmath62 , we are in the stable region , which shows a clause of theorem [ th : complsegm ] .",
    "note that both of the partial derivatives of @xmath69 are negative when @xmath150 .",
    "if we fix @xmath50 then the largest value of @xmath24 that keeps @xmath151 is the solution ( @xmath152 ) of the first equation of table [ ta : constantthresint ] .",
    "hence we may conclude that if @xmath153 and @xmath154 $ ] then @xmath155 for some @xmath156 .",
    "we can also look for the largest square that is contained in the large area of the first item of figure [ fig : red_3d_tr ] ( where the process is static ) .",
    "the edge of this square is given in table [ ta : constantthresint ] . hence if @xmath157 then @xmath155 for some @xmath156 .",
    "we have one last observation to make about the function @xmath69 . if we let do not restrict the values of @xmath158 then we wish to find the values of @xmath9 such that @xmath159 .",
    "according to the properties of @xmath69 ( in particular its negative derivative on @xmath9 ) , these are all the positive numbers which are less than the limit ( which is also an infimum ) @xmath160    hence we may conclude that if @xmath63 and @xmath161 then @xmath155 for some @xmath156 .",
    "this concludes the proof of the second clause of theorem [ th : complsegm ] .",
    "cmgp13    g.  barmpalias , r.  elwes , and a.  lewis - pye .",
    "digital morphogenesis via schelling segregation . in _",
    "55th annual ieee symposium on foundations of computer science _",
    "18 - 21 , philadelphia , 2014 .",
    "focs 2014 .",
    "g.  barmpalias , r.  elwes , and a.  lewis - pye . .",
    ", 158:806852 , 2015 .",
    "e.  bertin . .",
    "springer briefs in complexity .",
    "springer , springer berlin heidelberg , 2012 .    c.  brandt , n.  immorlica , g.  kamath , and r.  kleinberg .",
    "an analysis of one - dimensional schelling segregation . in _",
    "stoc 12 : proceedings of the 44th symposium on theory of computing _ ,",
    "pages 789804 , 2012 .",
    "p.  bhakta , s.  miracle , and d.  randall .",
    "clustering and mixing times for segregation models on @xmath162@xmath163 . in _ proceedings of the twenty - fifth annual acm - siam symposium on discrete algorithms , soda 2014 , portland , oregon , usa ,",
    "january 5 - 7 , 2014 _ , pages 327340 , 2014 .",
    "b.  bollobs . .",
    "cambridge studies in advanced mathematics 73 .",
    "cambridge university press , trinity college , cambridge and university of memphis , 2001 , second edition .",
    "r.  conte , g.  andrighetto , m.  campenn , and m.  paolucci .",
    "emergent and immergent effects in complex social systems . in _ proceedings of aaai symposium , social and organizational aspects of intelligence _ , washington dc , 2007 .",
    "association for the advancement of artificial intelligence .",
    "w.  clark and m.  fossett . understanding the social context of the schelling segregation model .",
    ", 11:41094114 , 2008 .",
    "105 .    c.  castellano , s.  fortunato , and v.  loreto .",
    "statistical physics of social dynamics .",
    ", 81:591646 , 2009 .",
    "w.  clark .",
    "residential preferences and neighborhood racial segregation : a test of the schelling segregation model . , 28:119 , 1991 .    p.  collard and s.  mesmoudi . how to prevent intolerant agents from high segregation ? in _ advances in artificial life ( ecal 2011 ) ,",
    "paris , france ( t. lenaerts et al .",
    ", eds . ) , cambridge , ma : mit press _ , 2011 .",
    "p.  collard , s.  mesmoudi , t.  ghetiu , and f.  polack .",
    "emergence of frontiers in networked schelling segregationist models .",
    ", 22 , 2013 .",
    "l.  dallasta , c.  castellano , and m.  marsili .",
    "statistical physics of the schelling model of segregation . ,",
    "7 , 2008 .",
    "michael  j.",
    "de  smith , michael  f. goodchild , and paul  a. longley . .",
    "troubador publishing , 2nd edition , 2007 .",
    "j.m . epstein and r.  axtell . .",
    "a bradford book .",
    "brookings institution press , 1996 .",
    "m.  fossett .",
    "ethnic preferences , social distance dynamics , and residential segregation : theoretical explorations using simulation analysis . , 30:185273 , 2006 .    n.  gilbert and s.  bankes .",
    "platforms and methods for agent - based modeling .",
    ", 99(suppl 3):71977198 , 2002 .",
    "b.  hayes .",
    "the math of segregation .",
    ", 101(5):338341 , 2013 .",
    "heppenstall , a.t .",
    "crooks , l.m .",
    "see , and m.  batty . .",
    "springer netherlands , 2011 .",
    "nadal l.  gauvin , j.  vannemenus .",
    "phase diagram of a schelling segregation model .",
    ", 70:293304 , 2009 .",
    "nima mousavi .",
    "how tight is chernoff bound ? , 2010 .",
    "draft which is available for download at http://ece.uwaterloo.ca/@xmath164nmousavi .",
    "g.  dor . . ,",
    "3:393398 , 2008 .",
    "m.  pollicott and h.  weiss . .",
    ", 27:1740 , 2001 .    t.  c. schelling",
    ". models of segregation . , 59(2):488493 , 1969 .",
    "t.c . schelling .",
    "dynamic models of segregation . , 2:143186 , 1971 .",
    "t.c . schelling . on the ecology of micromotives .",
    ", 25:6198 , 1971 .",
    "t.  c. schelling . .",
    "new york , norton , 1978 .",
    "schut . scientific handbook for simulation of collective intelligence .",
    "http://www.sci-sci.org , 2007 .",
    "e.  v. slud .",
    "distribution inequalities for the binomial law .",
    ", 5:404412 , 1977 .",
    "d.  stauffer and s.  solomon .",
    "ising , schelling and self - organising segregation . , 57(4):473479 , 2007 .",
    "r.  sander , d.  schreiber , and j.  doherty . empirically testing a computational model : the example of housing segregation . in _ proceedings of the workshop on simulation of social agents : architectures and institutions _ , pages 108115 , lexington , ma , 2000 .",
    "lexington books .",
    "u.  wilensky . .",
    "http://ccl.northwestern.edu/netlogo , center for connected learning and computer - based modelling , north - western university .",
    "evanston , il . , 1999 .",
    "l.  yilmaz and t.  ren . .",
    "wiley series in systems engineering and management .",
    "wiley , 2009 .",
    "young . . ,",
    "princeton , nj , 1998 .",
    "j.  zhang . a dynamic model of residential segregation .",
    ", 28(3):147170 , 2004 .",
    "j.  zhang .",
    "residential segregation in an all - integrationist world .",
    ", 54(4):533550 , 2004 .",
    "j.  zhang . tipping and residential segregation : a unified schelling model .",
    ", 51:167193 , 2011 .",
    "in this section we provide supplementary material to the main part of the paper .",
    "this includes mainly proofs of the claims we made towards the proof of our main theorem , but also additional introductory material , figures , tables and mathematical background .",
    "the structure of this supporting material follows the presentation of the main part of the paper .",
    "the definition of the schelling model in section [ def : modseg ] is rather standard , close to the spacial proximity model from @xcite and identical to the model studied in @xcite .",
    "most significantly , it is an unperturbed schelling model , where agents can not make moves that are detrimental to their welfare .",
    "we have already remarked in the introduction that various more realistic - looking rigorously analysed perturbed versions of the model in the literature ( such as @xcite ) actually force ` regularity ' on the process , which makes it fit an already existing methodology ( such as markov chains with a unique stationary distribution , or with properties that guarantee stochastically stable states ) . even if we commit to the absence of perturbations in the model , it is possible to add complications to the simple dynamics defined in section [ def : modseg ] .",
    "for example , the agents may take into account the distance they need to travel before they move .",
    "however it is the simplicity of the original schelling model , contrasted by the complexity of the analysis required to specify its behaviour ( as demonstrated in @xcite ) that make this topic fundamental and interesting .    under the above requirement for simplicity and proximity to the original model",
    ", there remain a number of ways that the model can be altered or generalised .",
    "for example , note that in the case that @xmath53 in the model of section [ def : modseg ] , two nodes may swap although the number of same - type nodes in their neighbourhoods remain the same after the swap .",
    "one may alternatively require that for such a swap , the corresponding numbers of same - type nodes in the neighbourhoods increase ( note that such a modification would not make a difference if @xmath54 ) .",
    "our choice on this issue follows brandt , immorlica , kamath , and kleinberg in ( * ? ? ?",
    "* section 2 ) .",
    "one generalisation , considered in @xcite , is to allow different tolerance thresholds for the two types of individuals .",
    "another generalization , already present in @xcite , is to introduce a number of vacancies , i.e.  to allow the total number of individuals to be smaller than the number of sites .",
    "we could also alter the dynamics .",
    "instead of switching two chosen individuals at each stage , we could merely choose _ one _ individual and change his type .",
    "such an action may be interpreted as the departure of the individual to some external location and the arrival of an individual of the opposite type at the site that has just become available .",
    "model with this dynamics are often said to have _ switching agents _ ( see @xcite , where such a model was analysed ) as opposed to the _ swapping agents _ of the model of section [ def : modseg ] .",
    "it is worth pointing out that the schelling model with switching agents is closely related to the spin-1 models used to analyse phase transitions in physics , and in particular the ising model . indeed ,",
    "in the ising model ( originally introduced in order to explain ferromagnetism in the context of temperature ) a system of atomic nuclei interact with an auxiliary ` heat bath ' which affects their spin .",
    "such connections have been analysed by many authors ( see for example @xcite ) , where the dynamics is based on the boltzmann distribution on the set of possible configurations .",
    "a rough analogy between the two models is that ` energy ' corresponds to some measure of the mixing of types ( see the definition of the mixing index for the schelling model below ) and ` temperature ' corresponds to the intolerance parameter @xmath24 ( as least insofar phase transitions refer to varying values of the temperature or @xmath24 ) . on the other hand , the schelling model with closed dynamics",
    "has a counterpart in the ising model with kawasaki dynamics .",
    "[ se:1dmorphojob ] we use the notation of section [ def : modseg ] , so that the symbol @xmath5 always means the population variable of the process , and @xmath22 always is the parameter of the process which determines the length of the neighbourhood of nodes .",
    "similarly , @xmath41 always refer to the parameters of the schelling process .",
    "in section [ se : accesscomplseg ] we show that , with probability one , the process @xmath32 either reaches complete segregation or it reaches a dormant state . in the second case , we wish to determine the extent of segregation in the dormant state . in view of the large number of states that the process may have ( most of them ` random ' ) a question arrises as to how to classify or even talk precisely about different states that may be the outcome of the process .",
    "brandt , immorlica , kamath , and kleinberg noticed in @xcite that , at least in the case @xmath165 that they considered , the extent of the segregation that occurs in the final state depends crucially on @xmath22 .",
    "in fact , they showed that the dependence on @xmath22 is ` polynomial ' .",
    "we may say that a state is regarded as _ polynomial segregation _ if , with high probability a randomly chosen node belongs to a contiguous block of size that is proportional to the value of a polynomial on @xmath22 .",
    "a similar definition applies to _ exponential segregation_. these two notions turn out to provide a very useful language for explaining the eventual outcome of the schelling process .",
    "a full characterization ( extending the work of brandt , immorlica , kamath , and kleinberg @xcite ) of the asymptotic behaviour of the process @xmath166 for @xmath50 and @xmath167 $ ] was provided by the authors in @xcite in terms of polynomial and exponential segregation , as well as static processes .",
    "intuitively , a random state is non - segregated , while polynomial and exponential segregation correspond to highly non - random states .",
    "the characterization from @xcite is summarized in table [ ta : vsclassifpoex ] .",
    "it is rather striking that when intolerance is increased from , say , @xmath168 to @xmath3 the segregation is decreased .",
    "this phenomenon is akin to the many paradoxes that stem from the missing link between local motives of agents and global behaviour of a system ( e.g.  see schelling s classic monograph @xcite , and in particular chapter 4 which relates to his segregation models ) .",
    "even more strikingly , the authors showed in @xcite that the paradox occurs for all @xmath169 , i.e.  as @xmath24 approaches @xmath3 the segregation ( in the final state ) decreases .",
    "this paradoxical phenomenon is also clear in many simulations of the model .",
    "figure [ fig : ciclmorphostatlides ] shows typical runs of the processes @xmath170 for @xmath171 .",
    "the final state is depicted in the circle , where the nodes of one type are black and the nodes of the other type are grey .",
    "we use the space between the centre of the ring and the ring in order to record the actual process , as it evolves in time .",
    "in particular , if a grey node switches its place with a black node , we put a black node ( the colour of the more recent node ) between the location of the node and the centre of the ring , at a distance from the centre which is proportional to the stage where the swap occurred .",
    "hence we may observe ",
    "cascades of swaps of nodes of the same type , which are less severe as @xmath24 approaches @xmath3 .",
    "such cascades are crucial in the rigorous analysis of the model , both in @xcite and in @xcite .",
    "figure [ fig : ciclmorphostatlides ] shows that as @xmath24 approaches @xmath3 , the segregation is decreased .",
    "this behaviour can be traced to the probability that a node is unhappy in the initial configuration , and in fact , the threshold constant @xmath172 is derived by comparing related probabilities in @xcite .    in the case",
    "@xmath50 the two constants @xmath172 and @xmath3 mark _ phase transitions _ in the limit state of the process @xmath32 , as @xmath24 takes values in @xmath173 $ ] .",
    "this brings us to another important objective of the analysis of the schelling process , which is the discovery of phase transitions with respect to the parameters @xmath41 .",
    "incidentally , we note that the discovery of phase transitions has been one of the original motivations for the study of the one and two dimensional ising model , when one varies the temperature ( see the end of section [ ssub : varschel ] for a brief discussion of the analogy between the ising and the schelling models ) .",
    "finally we are also interested in the expected time that the process take to converge .",
    "we use the asymptotic notation . given two functions @xmath175 on the positive integers , ( as is standard ) we say that @xmath176 is @xmath177 if there exists a positive constant @xmath90 such that @xmath178 for all @xmath179 .",
    "we say that @xmath69 is @xmath180 if @xmath176 is @xmath177 , and that @xmath69 is @xmath181 if both @xmath176 is @xmath177 and @xmath176 is @xmath182 .",
    "we also use this notation , however , in a more general sense : we say that @xmath176 is @xmath183 if there exists some @xmath184 such that @xmath185 for all @xmath179 . for example , when we say that a function @xmath176 is @xmath186 , this means that there is @xmath184 such that @xmath187 for all @xmath179 . or",
    ", if we say that @xmath176 is @xmath188 , this means that there is @xmath184 such that @xmath189 for all @xmath179 .",
    "similarly , we use @xmath190 in a more general sense .",
    "we say that @xmath176 is @xmath191 to mean that there exist constants @xmath192 and @xmath193 such that @xmath194 for all @xmath179 .",
    "we say that @xmath195 if @xmath196 .",
    "the ( often hidden ) variable underlying the asymptotic notation in the various expressions will be @xmath22 .",
    "in other words , for fixed values of @xmath9 and @xmath24 , the choice of constants required in the asymptotic notation , will always depend only on @xmath22 .",
    "we also combine the ` high probability ' terminology with the asymptotic notation in a manner which is worth clarifying .",
    "when we say , for example , that ` with high probability the number of initially unhappy @xmath7-nodes in the process @xmath48 is @xmath197 ' , this means that there exist constants @xmath192 and @xmath193 such that , with high probability , the number of initially unhappy @xmath7-nodes in the process @xmath48 lies between @xmath198 and @xmath199 .",
    "we use different methods for the cases @xmath54 and @xmath53 . if @xmath54 , in order to derive conditions under which the process is static , we analyse and compare the probabilities of initially unhappy nodes and _ stable intervals_. this approach was introduced by the authors in @xcite . if @xmath53 we consider the two cases @xmath200 and @xmath201 and argue ( using distinct arguments ) that in each of them complete segregation is the high probability outcome .",
    "we elaborate on these arguments .",
    "this case is divided to the cases @xmath86 and @xmath85 , and the structure of the analysis was depicted as a flowchart in figure [ fig : dysimpleskads ] . here",
    "we give a more detailed overview , which is illustrated in the more elaborate flowchart of figure [ fig : dyprogeneralskads ] .",
    "first , we show that asymptotically ( on @xmath202 ) , from any state there is a series of transitions that leads to either a dormant state , or complete segregation . hence",
    ", since there are only finitely many states , with probability one the process will reach either a dormant state or complete segregation .",
    "so in order to establish complete segregation as the eventual outcome , it suffices to show that the process maintains unhappy nodes of each colour during all stages .",
    "first , assume that @xmath86 .",
    "in this case we can show that , assuming that the actual proportion of @xmath8-nodes is sufficiently close to @xmath9 ( which is very likely according to the law of large numbers ) , every reachable state is not dormant .",
    "more precisely , we show that given such numbers of @xmath7 and @xmath8-nodes , every permutation of them on the ring corresponds to a state which has both unhappy @xmath7 and unhappy @xmath8-nodes .",
    "since the numbers of nodes of each type do not change during each transition , this argument suffices for this case . recall that states with the property that no series of transitions from them leads to dormant states are called _",
    "safe_. so , in the case @xmath86 we argue that ( with high probability ) the initial state is safe .",
    "second , we assume that @xmath85 , which is a considerably harder case . under this hypothesis ,",
    "in the initial configuration we have @xmath64 many unhappy @xmath7-nodes and @xmath65 many unhappy @xmath8-nodes .",
    "as before , it suffices to show that ( with high probability ) the process never reaches a dormant state .",
    "it is not hard to see that ( with high probability ) the initial state is not dormant .",
    "however it is no longer clear if the initial state is safe .",
    "we show that given the expected numbers of nodes of the two types in the initial state ( or numbers sufficiently close to their expectations ) any permutation of the nodes on a ring corresponds to a state with at least one unhappy @xmath8-node .",
    "hence , with high probability , the process will never run - out of unhappy @xmath8-nodes and we only need to argue about the preservation of unhappy @xmath7-nodes",
    ". already it should be clear that this is an _",
    "case where the @xmath7-nodes ( the majority ) and the @xmath8-nodes ( the minority ) play different roles . when @xmath85 there are many permutations of the nodes ( which correspond to states where all @xmath7-nodes are happy , i.e.  dormant states .",
    "so the argument that was used in the case @xmath86 is no longer relevant for arguing for the preservation of unhappy @xmath7-nodes in the process .",
    "the argument we use instead is based on the asymmetry between the number of unhappy @xmath8-nodes and the unhappy @xmath7-nodes , which creates a dynamic that favours the preservation of unhappy @xmath7-nodes .",
    "more precisely , it favours the preservation of @xmath8-blocks of length @xmath203 , which is a condition implying the existence of unhappy @xmath7-nodes ( indeed , the @xmath7-nodes neighbouring a @xmath8-block of length at least @xmath22 are unhappy ) .",
    "hence if we show that the expected number of unhappy @xmath7-nodes remains small during the stages of the process , then we have that we can expect the existence of unhappy @xmath7-nodes ( and unhappy @xmath8-nodes ) up to the point where the total number of unhappy nodes is small .",
    "in addition we show that if the total number of unhappy nodes in a state is sufficiently small , then this state is safe , i.e.  there is no series of transitions from it to a dormant state .",
    "the argument is concluded by showing that it is very likely that by stage @xmath5 the process will arrive at a state with appropriately low number of unhappy nodes , before it reaches a dormant stage .",
    "figure [ fig : inf_area ] is a plot of the numbers of unhappy @xmath7-nodes and the unhappy @xmath8-node during the stages , taken from two typical simulations ( one with large and one with small population ) , when @xmath85 .",
    "the process we described is clearly visible : the number of unhappy @xmath7-nodes remains small , until the number of unhappy @xmath8-nodes becomes small . up to the later point , as we explained , the dynamics favours the preservation of unhappy @xmath7-nodes .",
    "in this case we have @xmath85 , and this means that in the initial configuration the @xmath7-population is happy with a few exceptions , while the @xmath8-population is unhappy , with a few exceptions . by the definition of the dynamics of the model @xmath7-to-@xmath8 swaps can only occur in areas where there are unhappy @xmath7-nodes . hence in this case the @xmath7-to-@xmath8 swaps will be concentrated in a very few selected areas in the ring , at least in the first stages of the process .",
    "this concentration of @xmath7-to-@xmath8 swaps creates cascades of @xmath7-node evictions which can be clearly seen in simulations such us the one displayed in figure [ fig : cicle_slides ] . if we could argue that such cascades are restricted to small areas around the initially unhappy @xmath7-nodes , then it is not hard to argue that the process reaches a dormant state rather quickly , having affected only a very small number of nodes . the way we do this is through _ stable intervals _ , a device that was also used in @xcite . roughly speaking ,",
    "these are intervals that do not allow the spread of unhappy @xmath7-nodes through them .    if @xmath9 is very small , or if @xmath24 is very small , then stable intervals occur with high probability . on the other hand ,",
    "if @xmath204 get sufficiently large , the probability of a stable interval tends to 0 as @xmath136 .",
    "this contrasts with prevalence of unhappy @xmath7-nodes . when @xmath41 are small , the probability of ( the occurrence of ) an unhappy @xmath7-node is small , while it gets large when @xmath41 increase .",
    "figure [ fig : proba_unhap_stabl ] shows the actual probabilities ( as calculated in section [ se : casetaubhalf ] ) as functions of @xmath87 for the specific value of @xmath147 ( the shape of the plots does not change significantly for different values of @xmath22 ) .",
    "the interesting case is the range for @xmath87 where both probabilities tend to @xmath205 as @xmath136 , i.e.  both events become rare .",
    "somewhere on the horizontal @xmath24-@xmath9 plane there is a line marking the intersection of the two surfaces .",
    "this is where the probability of a stable interval becomes less than the probability of an unhappy @xmath7-node .",
    "moreover , as @xmath136 the ratio of the two probabilities tends to infinity or zero , depending whether @xmath87 sit on one side of the plain ( with respect to the intersection line ) or the other .",
    "the crux of the argument in section [ se : casetaubhalf ] is that for many values of @xmath87 stable intervals are much more common than unhappy @xmath7-nodes in the initial configuration .",
    "this allows us to argue that , in this case , the process has to reach a dormant state after @xmath64 many swaps .",
    "the social welfare @xmath207 of the state can easily be seen to be non - decreasing along the transitions of the process .",
    "let us establish the relationship with the mixing index .",
    "given a certain state of the process and a node @xmath15 , we let @xmath208 denote the number of @xmath7 nodes that are located in the neighbourhood of @xmath15 at this state .",
    "similarly , we let @xmath209 denote the number of @xmath8-nodes that are located in the neighbourhood of @xmath15 .",
    "furthermore , we denote by @xmath210 and @xmath211 and the finite sequences of @xmath7 and @xmath8 nodes respectively in the state .",
    "hence @xmath212 denotes the number of @xmath8-nodes that are located in the neighbourhood of @xmath213 while @xmath214 denotes the number of @xmath7-nodes that are located in the neighbourhood of @xmath215 . given a state ,",
    "let @xmath216 be the number of @xmath7 and @xmath8-nodes respectively .",
    "then @xmath217 in order to prove this equality , consider the state of @xmath7 and @xmath8 types in the state and start by removing all @xmath8 from their positions . then , adding the @xmath8 types one - by - one back to their original positions we can see each placement incurs the same increase to the two sums . hence by induction , the two sums are equal .",
    "we call the number in the _ mixing index _ of the state , because it can be used as a metric of how mixed ( i.e.  not segregated ) the population of @xmath7 and @xmath8 types is at the given state . indeed , suppose that the state has at least @xmath218 nodes of each type",
    ". in the state of complete segregation the sums in take the value @xmath219 , which is @xmath75 .",
    "this can be shown to be the minimum mixing index ( in a state which has at least @xmath218 nodes of each type ) . at the other extreme , if the two types are uniformly mixed ( in the sense that every interval @xmath117 has approximately @xmath220 green nodes ) then the sums in take approximately the value @xmath221 , which can be shown to be the maximum possible mixing index .",
    "we also have @xmath222 from and we get @xmath223 .",
    "suppose that we swap an unhappy @xmath7-node @xmath15 with an unhappy @xmath8-node @xmath224 .",
    "let @xmath225 be the neighbourhoods of @xmath226 respectively and let @xmath227 .",
    "here we view the nodes as stationary , so that a swap of nodes means a swap of their types .",
    "the mixing index of the nodes in @xmath117 will not change after the swap . since @xmath54 the number @xmath228 of @xmath7-nodes in @xmath229 is smaller the the number @xmath230 of @xmath7-nodes in @xmath231 . after the swap the mixing index of each of the @xmath7-nodes in @xmath229 will increase by one while the mixing index of each of the @xmath8-nodes in the same set will decrease by one .",
    "if @xmath232 is the length of the neighbourhood and @xmath233 is the number of @xmath7-nodes in @xmath117 then the mixing index of @xmath15 before and after the swap is @xmath234 ( the size of the neighbourhood minus the @xmath7-nodes in the neighbourhood ) and @xmath235 ( the number of @xmath7-nodes in @xmath236 plus the number of @xmath7-nodes in @xmath237 ) respectively .",
    "hence the difference in the sum of the mixing indices of the nodes in @xmath236 before and after the swap is the addition of      where the differences refer to the stages before and after the swap . for ( a )",
    "we have @xmath238 . for ( b )",
    "there is an increase ( by 1 ) of the mixing indices of each @xmath7-node in @xmath229 since @xmath15 becomes a @xmath8-node .",
    "moreover there is a decrease ( by 1 ) of the mixing index of the @xmath8-nodes ( as @xmath15 ceased to be an @xmath7-node ) .",
    "hence for ( b ) we have @xmath239 .",
    "overall , the difference in the sum of the mixing indices of the nodes in @xmath236 before and after the swap is @xmath240 . a similar argument shows that the difference in the sum of the mixing indices of nodes in @xmath241 is @xmath242 . hence overall",
    "( and since the nodes outside @xmath243 maintain the same mixing index before and after the swap ) the difference in the ( total ) mixing index is @xmath244 .",
    "since @xmath245 this means that a decrease by at least 4 occurs due to the swap .    in our analysis ,",
    "one of the basic facts used is that that dormant states have at least a reasonably high mixing index . if we can show that with high probability the process reaches a point where the mixing index is too low for dormant states to be accessible , then by corollary [ coro : inevcompsegd1 ] we will have shown that with high probability complete segregation is the eventual outcome .",
    "proposition [ prop : maxmixindor ] below provides an appropriate bound for the mixing index of dormant states .",
    "first we prove a technical lemma , which will then be used in the proof of proposition [ prop : maxmixindor ] .",
    "[ le : blockdorml ] suppose that @xmath53 , @xmath88 , and @xmath246 . in a dormant state of the process",
    "@xmath32 every @xmath8-block has length at most @xmath247 and every @xmath8-node is @xmath248-near to an @xmath7-node .",
    "since the second claim implies the first , it suffices to prove the second claim . by lemma [ coro : exiunhangen1 ]",
    "we can assume that there are unhappy @xmath8-nodes in the given state .",
    "for a contradiction , suppose that some @xmath8-node is not @xmath248-near to any @xmath7-node .",
    "consider the @xmath7-node which is adjacent to the block and to the right of it .",
    "for large @xmath22 , @xmath249 , meaning that this @xmath7-node has at least @xmath250 nodes of type @xmath8 in its neighbourhood .",
    "hence the @xmath7-node has at most @xmath251 nodes of type @xmath7 in its neighbourhood , which is less than @xmath98 .",
    "the fact that this @xmath7 node is unhappy means that the state is not dormant .",
    "suppose that in a dormant state the mixing index is at most @xmath83 .",
    "since there are @xmath252 nodes of type @xmath8 , there exists such a node @xmath15 with mixing index at most @xmath253 . by lemma [ le : blockdorml ]",
    "there exists an @xmath7-node @xmath224 within @xmath248 nodes to the left or to the right of @xmath15 .",
    "the number of @xmath7-nodes in the neighbourhood of @xmath254 is therefore at most @xmath255 .",
    "however this same number must be at least @xmath98 since @xmath224 is happy in a dormant state .",
    "this holding for arbitrarily large @xmath22 would imply that @xmath256 which gives the required contradiction .",
    "we do not know if the bound provided by proposition [ prop : maxmixindor ] is tight .",
    "however it is sufficient for the proof of theorem [ th : complsegm ] , which only requires a bound that is proportional to the population size @xmath5 .      while a low mixing index suffices to establish the inaccessibility of dormant states , in fact it will often be more convenient to work directly with the number of unhappy nodes .",
    "the aim of this subsection is to allow us to do this , by establishing a fairly tight relationship between the number of unhappy nodes and the mixing index .    as another measure of mixing",
    ", we may consider the number @xmath78 of maximal contiguous @xmath8-blocks in the state .",
    "let @xmath257 be the @xmath233th node of type @xmath8 and let @xmath258 denote the number of @xmath7-nodes in the neighbourhood around @xmath257 .",
    "let @xmath259 $ ] be a finite interval of integers such that @xmath260 \\}$ ] constitutes a block ( i.e. there is no @xmath7-node between @xmath261 and @xmath262 ) .",
    "if @xmath263 then @xmath264 is bounded above by @xmath265 . if @xmath266 the number @xmath75 continues to be a bound for @xmath264 .",
    "therefore      this inequality is a formal expression of the rather obvious fact that the fewer maximal @xmath8-blocks there are , the less mixed the two types are . by the definition of happy nodes , if @xmath53 and @xmath268 then no two adjacent nodes of different types can both be happy .",
    "this means that , as we move around the circle of nodes , every time we cross the border between a maximal @xmath8-block and a maximal @xmath7-block we may count an additional unhappy node .",
    "so , provided that @xmath53 and @xmath22 is sufficiently large , the number of maximal @xmath8-blocks is bounded above by the number of unhappy nodes in the state .",
    "then by we get      intuitively this inequality says that the only way to have a small number of unhappy nodes is a small mixing index , i.e.  a large degree of segregation .",
    "on the other hand we may bound the number of unhappy nodes in terms of the mixing index . by and the definition of unhappy nodes @xmath270 where @xmath271 are the numbers of unhappy nodes of type @xmath7 and @xmath8 respectively .",
    "so @xmath272 and @xmath273 which means that if @xmath53 ( and @xmath22 is sufficiently large ) then @xmath274 .",
    "we make use of the various concentration of measure inequalities for random variables and ( super)martingales .",
    "the simplest of these is markov s inequality , which says that if @xmath275 is a non - negative random variable with @xmath276 and @xmath277 then @xmath278 .",
    "recall hoeffding s inequality for independent bernoulli trials .",
    "[ le : hoeffdingber][le : tighthoeffd ] let @xmath279 be independent bernoulli trials with expected value @xmath280 , and let @xmath281",
    ". then @xmath282 and @xmath283 for each @xmath44 .",
    "if @xmath284 then @xmath285 for each @xmath44 such that @xmath286 .    the second clause of this lemma ( the tightness of the inequality ) follows from slud s inequality @xcite ( which gives a lower bound of the binomial upper tail in terms of the upper tail of the normal distribution ) and standard lower bounds for upper tail of the normal distribution ( see @xcite for more details ) .",
    "since there are complex dependences amongst the random variables of the schelling process , we often need to ` approximate ' certain processes with canonical processes like simple random walks . here a random walk with respect to the integer - valued random variables @xmath287 is the stochastic process @xmath288 , for some @xmath289 .",
    "we say that @xmath290 _ is ruined _ at step @xmath291 if @xmath291 is the least number such that @xmath292 .",
    "the following simple fact is obtained via a standard coupling argument .",
    "[ le : ranwalksim]let @xmath293 , @xmath294 be ( possibly dependent ) random variables , let @xmath295 be independent bernoulli trials and let @xmath296 , @xmath297 be the associated random walks .",
    "provided that , no matter what occurs at stages prior to @xmath233 , at stage @xmath233 we have @xmath298 $ ] and @xmath299 $ ] , then for all @xmath300 the probability that @xmath301 is ruined by step @xmath291 is bounded above by the probability that @xmath302 is ruined by step @xmath291 .      [",
    "le : ranwalkbiasked ] let @xmath303 , and let @xmath294 be ( possibly dependent ) random variables such that at stage @xmath233 , no matter what has occurred at previous stages , @xmath304 for some @xmath305 .",
    "let @xmath306 , be the associated random walk .",
    "then the probability that @xmath307 is ever ruined is bounded above by @xmath308 .",
    "let @xmath309 be independent variables such that @xmath310 .",
    "let @xmath311 be the associated random walk .",
    "then @xmath312 , so by lemma [ le : ranwalksim ] it suffices to show that the probability that @xmath313 is ruined is bounded above by @xmath308 .",
    "we may view @xmath279 as independent bernoulli trials , where @xmath314 is viewed as success and @xmath315 is viewed as failure .",
    "let @xmath316 , so @xmath317 . if @xmath318 is the number of successes up to step @xmath319 , then @xmath320 so ruin of the random walk @xmath321 at step @xmath319 implies that @xmath322 .",
    "we may use lemma [ le : hoeffdingber ] in order to bound the probability of this event .",
    "if we let @xmath323 note that @xmath324 , so by lemma [ le : hoeffdingber ] , @xmath325 is an upper bound for the probability that @xmath326 is ruined at step @xmath319 .",
    "next , note that @xmath313 can only be ruined at stages @xmath327 .",
    "hence @xmath328 is an upper bound of the probability that @xmath313 is ever ruined ( before stage @xmath329 ) , which concludes the proof .",
    "our analysis depends on various exponential bounds that we can obtained on the expectations of certain parameters ( e.g.  the number of unhappy @xmath7-nodes ) .",
    "the following fact will be routinely used in order to express such bounds in a canonical form . in the following statement the variables @xmath330 concern stage @xmath319 of the schelling process @xmath32 and the constants @xmath331 are independent of @xmath332 .",
    "[ le : boundstech ] let @xmath176 be a polynomial , @xmath333 and @xmath330 a random variables such that @xmath334 for all @xmath319 .",
    "if @xmath335 for some @xmath336 and all all @xmath319 and all sufficiently large @xmath22 then there exists @xmath337 such that @xmath338 for all @xmath339 .    since @xmath176 is a polynomial , we can choose @xmath340 and @xmath341 such that @xmath342 for all @xmath343 .",
    "hence @xmath344 for all @xmath319 and all @xmath343 .",
    "we may choose @xmath345 such that @xmath346 for all @xmath347 .",
    "then by the assumption on @xmath280 we have that @xmath348 for all @xmath22 and all @xmath319 .",
    "the binomial distribution with @xmath179 trials and success probability @xmath280 is denoted by @xmath349 , and @xmath350 means that random variable @xmath351 follows this distribution . stirling s formula asserts that @xmath352 , i.e.  that the limit of the ratio of the two expressions tends to 1 as @xmath5 tends to infinity .",
    "let @xmath357 or @xmath358 . also let @xmath359 or @xmath360 . then according to the definition of the binomial coefficient it suffices to show that there exists a polynomial @xmath361 such that @xmath362 note that there exists @xmath363 such that @xmath364 . then @xmath365 the second term on the right side of the equation is bounded by a polynomial in @xmath291 while the third term is in @xmath366 . hence there is a quadratic polynomial @xmath361 such that @xmath367 by stirling s approximation",
    "it follows that there exists a quadratic polynomial @xmath353 such that for all @xmath291 , @xmath368 and @xmath369 as defined above there exists @xmath370 such that @xmath371 .",
    "this fact , along with the definition of the binomial coefficient , implies the required statement .    in our analysis of the schelling process for the case",
    "when @xmath54 we will need to compare the tails of different binomial distributions .",
    "there are a number of ways for doing this ( including using approximations with the normal distribution ) but the simplest is the following elementary fact from ( * ? ? ?",
    "* theorem 1.1 ) .",
    "[ lem : binom ] suppose that @xmath372 , @xmath373 and for all sufficiently large @xmath374 , @xmath375 , where @xmath376 .",
    "then @xmath377 for all sufficiently large @xmath374 . in asymptotic",
    "notation we have @xmath378 .",
    "the combination of this result with stirling s approximation of the binomial coefficients gives the required information about the asymptotic behaviour of the ratio of the two binomial probabilities of interest ( unhappy nodes and stable intervals ) .",
    "a crucial part of our analysis is based on two supermartingales , one regarding the non - anomalous @xmath7-nodes in the infected area , and one regarding the anomalous nodes .",
    "the latter is somewhat sophisticated , in the sense that it is not _ adapted _ to the stages of the process .",
    "nevertheless it is a supermartingale relative to a more general process , and this is sufficient for our analysis . due to this sophistication , we clarify how we regard the process @xmath48 in probabilistic terms , and what we mean by a martingale .",
    "the states of the system are all configurations of @xmath5 nodes that can have one or the other type .",
    "a state @xmath379 is accessible from another state @xmath380 ( thought as an arrow from @xmath380 to @xmath379 ) if an application of a legitimate swap on @xmath380 gives @xmath379 .",
    "we view the random process as a combination of two parts .",
    "the first is the production of the initial state according to the given probability distribution of the two types .",
    "the second is the stochastic process that starts from the initial state and moves to the next state , choosing uniformly randomly from all the ( finitely many ) currently accessible states .",
    "we denote the initial state by @xmath381 and the state at stage @xmath319 by @xmath382 .",
    "the remaining discussion refers to the second part of the process , where @xmath381 is a constant .",
    "the underlying probability space @xmath383 is the set of all infinite sequences of states , which start with @xmath381 and have the property that each term is a state which is accessible from its predecessor .",
    "we also add into @xmath383 the finite sequences of states , which start with @xmath381 , each of their terms is accessible from its predecessor , and its last term is an absorbing state .",
    "we view this as a tree , where the @xmath233th level of the tree ( prefixes of points in the space of length @xmath233 ) describes all possible outcomes of the process up to stage @xmath233 .",
    "this tree has dead - ends , namely the absorbing states .",
    "the probability measure on @xmath383 is the uniform one , namely the one induced by splitting the total measure @xmath384 uniformly inductively starting from the route and considering all accessible paths .",
    "then each @xmath385 can be viewed as random variable on @xmath383 , which takes any point in the space and outputs its @xmath233th term .",
    "a number of other processes will be defined , relative to the process @xmath386 which contains all the information .",
    "clearly @xmath386 is memoryless ( has the markov property ) since the distribution of @xmath385 only depends on the value of @xmath387 .",
    "the secondary processes that we consider in our analysis ( like @xmath115 or @xmath116 ) can be seen as recording only part of the information of the full process @xmath388 up to stage @xmath319 . in general , a process @xmath389 is _ adapted to _ ( or defined in terms of ) another process @xmath390 if there is a function such that @xmath391 for every point in @xmath383 . recall that a _ filtration _ on @xmath383 is an increasing sequence of @xmath392-algebras on @xmath383 .",
    "the reader who is used to working with filtrations ( especially with respect to martingales ) can equivalently view a process @xmath389 adapted to another process @xmath390 as @xmath389 adapted to the _ natural filtration _",
    "@xmath393 of @xmath394 : this is the filtration generated by the inverse images of the borel sets of @xmath383 , with respect to the variables @xmath390 . for example , the natural filtration of the full process @xmath395 is @xmath396 where @xmath397 is the @xmath392-algebra generated from the maximal branches of @xmath383 restricted to strings of length @xmath319 or less .",
    "intuitively @xmath397 can measure all events that can possibly happen up to stage @xmath319 .    in order to show that a certain process is a martingale , we will have to adapt to another suitable process .",
    "equivalently , we would have to adapt it to a suitable filtration ( which may be different than the standard filtration @xmath396 that we described above ) .",
    "this is the reason for introducing adapted processes : the simplest martingale notion corresponds to processes adapted to themselves , and is not sufficient for our proof . recall that a process @xmath398 is a supermartingale relative to a markov process",
    "@xmath390 if it is adapted to it and @xmath399 for all @xmath319 .",
    "this means that relative to the set of reals in @xmath383 which have the particular value of @xmath390 ( which is regarded as fixed ) the expectation of @xmath400 is bounded by @xmath398 ( which is a function of @xmath390 ) .",
    "this is the standard definition of conditional expectation in terms of processes . in our analysis",
    "we occasionally need to consider @xmath401 conditional on a set of reals @xmath402 .",
    "we denote this by @xmath403 . a _ stopping time _ with respect to a process @xmath394 ) is a random variable @xmath40 such that the truth of the event @xmath404 ( for any integer @xmath291 ) is a function of @xmath405 .",
    "if @xmath40 is a stopping time for @xmath394 and @xmath406 is a supermartingale with respect to @xmath394 , then the _ stopped process _",
    "@xmath407 ( which proceeds as @xmath398 up to stage @xmath40 , and then it is constantly equal to @xmath408 ) is also a supermartingale ( with respect to @xmath394 ) .",
    "doob s _ maximal inequality for supermartingales _ says that if @xmath406 is a non - negative supermartingale with respect to another process @xmath394 and @xmath409 , @xmath277 then @xmath410 .",
    "a property of a node in the initial configuration is called rare ( or a rare event ) if it holds with probability at most @xmath411 , for some positive constant @xmath412 which may depend on @xmath87 but not on @xmath202 . a property",
    "whose negation is rare is called common .",
    "[ de : localevent ] a local property @xmath413 of a node @xmath15 in the initial configuration is one that only depends on the nodes that are at most @xmath414-far from @xmath15 , where @xmath176 is a fixed function . in other words the property is local if given any two nodes @xmath226 such that for all @xmath415 $ ] , @xmath416 is of the same type as @xmath417 , then @xmath413 holds iff @xmath418 holds . in this case",
    "we say that @xmath413 is @xmath176-local .",
    "note that the two probabilities mentioned in lemma [ le : sllnschel ] are on different spaces .",
    "the first one refers to the product space where a point is an infinite series of initial states .",
    "the second one refers to the space of points on a random initial state .",
    "[ le : sllnschel ] given a local property @xmath413 of nodes in the initial state of the process @xmath48 , with probability one , as @xmath419 the proportion of nodes @xmath15 that satisfy @xmath413 tends to the probability of @xmath413 .",
    "let @xmath280 be the probability of @xmath413 and let @xmath176 be the function indicating the area around @xmath15 on which @xmath413 depends ( as in definition [ de : localevent ] ) .",
    "we wish to use the strong law of large numbers , so we need to manufacture a series of independent trials of properties with given expectation .",
    "let @xmath420 be a parameter that depends on @xmath5 ( to be specified shortly ) .",
    "we consider the ring as a union of intervals of length @xmath421 ( which we think of an interval of length @xmath422 with padding @xmath414 nodes on each side ) .",
    "we always assume that @xmath423 .",
    "starting from node @xmath205 , denote the @xmath233th such interval by @xmath424 so that @xmath425 . also , denote the subinterval of @xmath424 that results from deleting the @xmath414-node prefix and the @xmath414-node suffix of @xmath424 by @xmath426 .",
    "hence @xmath427 .",
    "let @xmath428 be the largest integer such that @xmath429 , so that @xmath430 as @xmath419 and @xmath431 .",
    "hence for each @xmath432 , the intervals @xmath424 are defined and are disjoint .",
    "the same is true for @xmath426 , @xmath432 .",
    "moreover , if @xmath433 is the set of all nodes , @xmath434 for each @xmath432 let @xmath435 be the number of nodes @xmath436 such that @xmath413 holds , and note that these random variables are independent .",
    "moreover , by linearity of expectation , @xmath437 . recall that @xmath430 as @xmath438 . according to the strong law of large numbers ,      by",
    ", the required proportion is @xmath440 where @xmath441 range in @xmath442 ( depending on how close @xmath5 is to being a multiple of @xmath443 ) .",
    "if we take @xmath444 , the ratio @xmath445 tends to @xmath205 , so by the required proportion tends to @xmath446 since @xmath447 , the required proportion tends to @xmath280 .",
    "more formally , we may let @xmath448 . in this case , as @xmath419 we have @xmath449 because @xmath450 tends to @xmath205 .",
    "moreover @xmath430 and @xmath451 when @xmath419 so the previous argument applies as indicated .    the following fact concerns pairs of properties @xmath452 and @xmath453 that a node can have , which may both be rare but one ( say @xmath452 ) occurs with much higher probability than the other .",
    "it asserts that in this case , a random node @xmath15 is much more likely to be nearer to a node @xmath224 satisfying @xmath452 than a node @xmath179 satisfying @xmath453 ( although it may be far from any node satisfying @xmath452 or @xmath453 ) . in the statement and proof of this result we use @xmath413 as a boolean random variable which asserts that ` @xmath15 satisfies @xmath452 ' ( and similar with @xmath454 ) .",
    "[ le : rareprop ] let @xmath413 , @xmath454 be @xmath455-local properties of nodes in the initial state ( where @xmath456 is a function of @xmath22 ) and for each node @xmath15 let @xmath457 be the first node @xmath224 to the right of @xmath15 such that either @xmath418 or @xmath458 holds . if @xmath459 are the probabilities of @xmath460 respectively , the probability that @xmath461 and there is no node @xmath224 with @xmath458 to the left of and at distance at most @xmath455 from @xmath457 tends to a number @xmath462 as @xmath419 .",
    "an analogous result holds when ` right ' is replaced by ` left ' .",
    "consider a partition of the ring into disjoint neighbourhoods , starting from a node @xmath463 as follows .",
    "recall that addition of nodes is always modulo @xmath5 . given @xmath464 ,",
    "suppose inductively that @xmath465 has been defined .",
    "then define @xmath466 .",
    "this iteration continues as long as @xmath467 .",
    "let @xmath468 be the number of iterations in this recursive definition ( i.e.  the number of terms of the sequence @xmath469 ) .",
    "consider the property @xmath470 the sequence @xmath471 can be seen as independent trials for this property .",
    "let @xmath472 be the proportion of the terms of @xmath471 that satisfy of @xmath473 in a random initial state .",
    "note that @xmath474 as @xmath419 with probability 1 .",
    "if @xmath475 is the probability of @xmath476 , by the strong law of large numbers we have that @xmath477 as @xmath419 with probability 1 .",
    "let @xmath478 be the proportion of nodes that satisfy @xmath413 and let @xmath479 be the proportion of nodes that satisfy @xmath454 .",
    "note that we view @xmath480 as random variables that depend on the initial state",
    ". then @xmath481 by lemma [ le : sllnschel ] we have @xmath482 and @xmath483 as @xmath419 , which gives the required assymptotic bound .",
    "an important part of our analysis relies on the values of the welfare metrics at the initial state . with high probability",
    ", these will be near to their expected values , which we may compute .",
    "we start with the mixing index .",
    "consider the random variables @xmath258 and note that @xmath485 for each @xmath233 . if @xmath486 is the number of @xmath8-nodes , the expectation of the mixing index in the initial state is @xmath487 by the linearity of expectation . if we see @xmath486 as a random variable , its expected value is @xmath488 . by the rule of iterated expectation ,",
    "the expected value of the mixing index is @xmath484 .",
    "note that the expected value of the mixing index in the initial state is only slightly smaller than the maximum possible mixing index @xmath489 .",
    "this is hardly surprising , as a random state will be almost perfectly mixed , with the occasional non - uniformities that are implied by randomness ( e.g.  the existence of contiguous blocks of certain sizes ) .",
    "next , we are interested in the expected number of unhappy nodes of each type .",
    "it is not hard to see that this depends on whether @xmath85 or @xmath86 ( we will not consider the special case where @xmath490 ) .",
    "let @xmath494 be 1 if the @xmath495th node @xmath496 in the initial state is of type @xmath7 and unhappy , and 0 otherwise .",
    "by lemma [ le : sllnschel ] , it suffices to show that @xmath497 is @xmath106 .",
    "recall that the nodes are labelled independently , following a bernoulli distribution , with the probability of a @xmath8-label being @xmath9 .",
    "let @xmath498 which is positive , according to our hypothesis .",
    "if @xmath496 is an unhappy @xmath7-node , then the proportion of @xmath8-nodes in its neighbourhood @xmath499 is larger than @xmath500 . hence the proportion of @xmath8-nodes in @xmath501 is larger than @xmath500 , so it is at least @xmath502 .",
    "let @xmath380 be the event that @xmath496 is an @xmath7-node and @xmath379 the event that @xmath496 is unhappy , so that @xmath503 and @xmath504 . if we see the labels of the nodes in @xmath505 as a series of @xmath94 independent bernoulli trials , by hoeffding s inequality for bernoulli trials the probability that the proportion of @xmath8-nodes is at least @xmath502 is bounded by @xmath506 . hence by the above discussion , @xmath507 . we may conclude that @xmath508 . hence @xmath509 .",
    "similarly , by lemma [ le : tighthoeffd ] we have @xmath510 .",
    "hence @xmath497 is @xmath493 , which concludes the proof .",
    "[ prop : bougreenuninit][prop : bforbetainit ] given @xmath87 such that @xmath511 , with high probability the number of initially happy @xmath8-nodes in the process @xmath48 is @xmath512 .",
    "if in addition @xmath85 , with high probability this number is @xmath493 .",
    "let @xmath513 be 1 if @xmath496 is of type @xmath8 and happy , and 0 otherwise . then provided that @xmath511 , by hoeffding s inequality for bernoulli variables we have that @xmath514",
    ". then lemma [ le : sllnschel ] gives the first clause of the claim .",
    "now lets assume that we also have @xmath85 .",
    "then by the second clause of lemma [ le : tighthoeffd ] we get @xmath515 .",
    "this application is possible with @xmath516 and @xmath517 because @xmath52 and @xmath85 , which means that @xmath518 .",
    "then by lemma [ le : sllnschel ] we get the second clause of the claim .      [ prop : blacksitesbou ] if @xmath85 , the probability that a node belongs to an incubator is @xmath106 .",
    "hence with high probability the number of incubators as well as the number of nodes belonging to incubators of the process @xmath48 is @xmath107 .",
    "let @xmath519 , and let @xmath494 be the index variable of the event that the left semi - neighbourhood of the @xmath495th node has less than @xmath520 many @xmath7-nodes .",
    "given that @xmath85 , by hoeffding s inequality for bernoulli variables ( lemma [ le : hoeffdingber ] ) and the tightness of it ( lemma [ le : tighthoeffd ] ) , the probability that @xmath521 is @xmath106 .",
    "let @xmath513 be the index variable of the event that the @xmath495th node belongs to an incubator , so that the probability that @xmath522 is @xmath106 ( since @xmath523 is @xmath106 )",
    ". hence @xmath524 is @xmath106 .",
    "then by lemma [ le : sllnschel ] with high probability the number of nodes belonging to incubators of the process @xmath48 is @xmath107 .",
    "it is crucial to understand the dormant states and assess their accessibility from an initial state .",
    "iwe demonstrate that this issue ultimately depends on the given parameters @xmath41 .",
    "we show that if @xmath86 then with high probability we may assert that no dormant state is accessible from the initial state . on the other hand , if @xmath85 then with high probability there are permutations of the initial state which are dormant .",
    "consider the state where the @xmath8-nodes occur in blocks of length @xmath527 , which are divided by blocks of @xmath7-nodes of length at least @xmath528 . since @xmath529 and @xmath526 we can consider an arrangement such that all blocks of @xmath7-nodes have length exactly @xmath528 , except perhaps one which may have longer length . in this state",
    "all @xmath7-nodes are happy and all @xmath8-nodes are unhappy . in particular , it is a dormant state .",
    "[ taurhostarmt1 ] suppose @xmath530 and let @xmath531 be the proportion of @xmath532-nodes in a state of the process @xmath32 .",
    "if @xmath53 and @xmath533 , then for @xmath246 there exist unhappy @xmath532-nodes in the state .    given the parameters @xmath534 , @xmath22 which is large , and any state of the process @xmath32 with no unhappy @xmath532-nodes , it suffices to produce an upper bound on @xmath5 ( which does not depend on the particular state but only @xmath535 and the fact that no @xmath532-nodes are unhappy ) .",
    "let @xmath536 .",
    "since @xmath53 and all @xmath532-nodes are happy , there are no @xmath412-blocks of length @xmath97 .",
    "we may assume that @xmath537 .",
    "define the _ bias _ @xmath538 of an interval @xmath117 of nodes to be the difference between the number of @xmath532-nodes in the interval and the number of @xmath412-nodes in the interval . without loss of generality",
    "suppose that the node occupying site @xmath22 is a @xmath532-node ( otherwise consider a rotation ) .",
    "we define a sequence @xmath471 of @xmath532-nodes in the state , starting with @xmath539 .",
    "let @xmath540 denote the neighbourhood of @xmath541 .",
    "given @xmath541 , define @xmath542 to be the rightmost @xmath532-node in @xmath540 .",
    "since there are no @xmath412-blocks of length @xmath97 , the sequence @xmath471 is well defined and it never happens that @xmath543 .",
    "let @xmath329 be the largest number such that none of the neighbourhoods @xmath540 for @xmath544 contain the node at site 0 .",
    "since @xmath537 we have @xmath545 .",
    "let @xmath546 and @xmath547 .",
    "note that @xmath548 contains all of the nodes except at most @xmath22 .",
    "moreover since @xmath549 we have latexmath:[\\[\\label{eq : bouleim }        note , however , that some nodes have been counted multiple times in the sum that defines @xmath553 , since the intervals @xmath540 are not disjoint . for each @xmath354 let @xmath554 consist of the nodes in @xmath548 which belong to exactly @xmath291 distinct intervals @xmath540 .    by the definition of @xmath471 ,",
    "the node @xmath555 is always outside @xmath540 .",
    "similarly , @xmath556 is always outside @xmath557 .",
    "this means that it is not possible for the neighbourhoods of 5 consecutive terms of @xmath471 to have a nonempty intersection .",
    "this , in turn , implies that @xmath558 for each @xmath559 . a similar consideration shows that @xmath560 consists entirely of @xmath412-nodes ( hence @xmath561 ) .",
    "next , note that @xmath562 , so @xmath563 .",
    "hence by counting the multiplicities of the nodes in the sum which defines @xmath553 , we have @xmath564 let @xmath565 and note that @xmath566 .",
    "moreover let @xmath567 and @xmath568 . by the definition of @xmath471 it follows that if @xmath569 is nonempty , then it consists entirely of @xmath412-nodes . since @xmath570 for each @xmath571 $ ] , @xmath572 and @xmath573 } n_i'$ ]",
    ", we have : @xmath574 let @xmath575",
    ". then @xmath576 and @xmath577 .",
    "hence @xmath578 and @xmath579 then from we get @xmath580 . from the second clause of",
    "and we have @xmath581 if @xmath582 are the numbers of @xmath532 and @xmath412 nodes in @xmath548 respectively , then @xmath583 and @xmath584 .",
    "hence @xmath585 . by hypothesis",
    "we have @xmath586 .",
    "moreover , since @xmath587 we have @xmath588 .",
    "hence @xmath589 , so by , @xmath590 by we may deduce that @xmath591 <   w(12\\theta_{\\ast}-4\\tau+1 )   + 4\\theta_{\\ast}-2\\tau-1.\\ ] ] we may assume that @xmath22 is larger than @xmath592 $ ] . by this condition and the fact that @xmath593 , the left side of is positive .",
    "also , @xmath594 , so by we have @xmath595 . if we combine the latter inequality with we get @xmath596 which is the required bound on @xmath5",
    ".    note that in the above result , the lower bound that is required on @xmath22 depends only on @xmath597 , while the lower bound that is required on @xmath5 depends on @xmath597 and @xmath22 .",
    "we may now apply lemma [ taurhostarmt1 ] in order to establish the conditional existence of unhappy nodes of both types .",
    "[ coro : exiunhangen1 ] suppose that @xmath53 , @xmath88 and @xmath22 is sufficiently large .",
    "then for all sufficiently large @xmath5 , every state of the process @xmath32 has unhappy @xmath8-nodes , and if @xmath91 then every state also has unhappy @xmath7-nodes .",
    "given @xmath9 , by the law of large numbers with high probability ( tending to 1 , as @xmath5 tends to infinity ) @xmath12 will be arbitrarily close to @xmath9 . hence we may deduce the absence of dormant states ( with high probability ) in the case that @xmath86 .",
    "a central part of our analysis is the fact that from any state there is a transition to either a dormant state or complete segregation .",
    "this is what we prove in this section .",
    "this also means that the only absorbing states of the process are the dormant states . if @xmath54 then it is clear that the only absorbing states of the process are the dormant states , since unhappy pairs of nodes of different type can always swap .",
    "it is also not difficult to find an appropriate lyapunov function , establishing that a dormant state must eventually be reached .",
    "consider the _ mixing index _ which is non - negative and strictly decreasing in stages for @xmath54 .",
    "for the case where @xmath53 more effort is required .",
    "we argue in four steps .",
    "the numbers in what follows are fairly arbitrary .",
    "first we show that from a state with few unhappy nodes of one type ( here @xmath93 is a convenient upper bound of what we mean by ` few ' , which is by no means optimal ) there is a series of transitions which lead to either a state with a contiguous block of length @xmath94 or a dormant state .",
    "second , ( assuming that @xmath53 ) from a state with a contiguous block of length @xmath95 there is a series of transitions to complete segregation or to a dormant state .",
    "third , any state which has at least @xmath598 unhappy nodes of each type , there is a series of transitions to a state with a contiguous block of length at least @xmath22 , and at least @xmath96 unhappy nodes of each type . finally ( if @xmath66 ) from a state that has a contiguous block of length @xmath97 and at least @xmath73 unhappy nodes of opposite type from the block , there is a series of transitions to a state with a contiguous block of length @xmath95 .",
    "the combination of these four statements constitutes a strategy for arriving at a dormant state or a state of complete segregation , from any given state .    in the following arguments we will often make use of the following two rather simple facts that hold when @xmath53 .",
    "one is that ( if @xmath268 ) , any @xmath8-node that is adjacent to a happy @xmath7-node is unhappy .",
    "the second concerns the situation where next to a happy @xmath7-node there is a @xmath8-node , and we swap the @xmath8-node for another @xmath7-node .",
    "then , provided that before the swap the the second @xmath7 node is outside the neighbourhood of the @xmath8-node , both @xmath7-nodes will be happy after the swap .    [ le : shortunhapno ] suppose that @xmath53 and that @xmath246 . from a state with less than @xmath93 unhappy nodes of one of the types ,",
    "there is a series of transitions to either a dormant state or to a state containing a contiguous block of length at least @xmath94 .    without loss of generality",
    "suppose that the state has less than @xmath93 unhappy @xmath7-nodes .",
    "since @xmath599 , and @xmath246 , if there does not already exist a contiguous block of length @xmath94 then there exists an interval @xmath18 $ ] of @xmath94 nodes which contains at least one @xmath7-node and such that any unhappy @xmath7-node is distance at least @xmath600 from any node in @xmath18 $ ] .",
    "any unhappy @xmath7 node which can not see any node in @xmath18 $ ] can move to any position in @xmath18 $ ] that is adjacent to an @xmath7-node ( because by doing so , it becomes happy and because if a swap is legal for one member of a potential swapping pair then it is legal for both ) .",
    "hence we can start successively replacing the @xmath8-nodes in @xmath18 $ ] which are adjacent to @xmath7-nodes , with unhappy @xmath7-nodes , each time choosing unhappy @xmath7-nodes that have maximal distance from @xmath226 . note that this recursive procedure is valid because all @xmath7-nodes in @xmath18 $ ] are happy after each swap .",
    "ultimately we either run out of unhappy @xmath7-nodes , or else @xmath18 $ ] becomes an @xmath7-block .",
    "[ le : toblolw ] suppose @xmath53 .",
    "if @xmath246 then from any state which has at least @xmath598 unhappy nodes of each type , there is a series of transitions to a state with an @xmath7-block or @xmath8-block of length at least @xmath22 , and at least @xmath96 many unhappy nodes of each type .",
    "suppose that we are given a certain state of the process .",
    "define a sequence @xmath601 @xmath602 of @xmath7-nodes with neighbourhoods @xmath603 respectively , by induction as follows .",
    "let @xmath463 be the least @xmath7-node whose neighbourhood contains the minimum number of @xmath7-nodes amongst all neighbourhoods of @xmath7-nodes .",
    "if @xmath541 is defined and @xmath604 , define @xmath542 to be the least @xmath7-node whose neighbourhood is disjoint from @xmath605 and whose neighbourhood contains the minimum number of @xmath7-nodes amongst all @xmath7-nodes with the same property ( i.e.  with neighbourhoods that are disjoint from @xmath605 ) .",
    "this completes the definition of @xmath471 , which is sound provided that @xmath5 is sufficiently large .",
    "we define a sequence @xmath606 @xmath602 of @xmath8-nodes with neighbourhoods @xmath607 respectively , in a way entirely analogous to the above definition , ensuring also that all neighbourhoods @xmath603 and @xmath608 are disjoint .    the sequences @xmath471 and @xmath609 provide a pool of nodes which will be used for legitimate swaps in a series of transitions which will lead to the desired state of the process .",
    "we start by considering an interval @xmath610 of nodes of length @xmath611 which is disjoint from @xmath612 and disjoint from @xmath613 .",
    "such an interval exists , provided that @xmath5 is sufficiently large .",
    "let @xmath117 consist of the @xmath22-many nodes in @xmath610 that are at distance at least @xmath614 from any node outside the interval .",
    "clearly any swap that occurs between a node in @xmath117 and one of the nodes @xmath541 , does not affect the composition of the neighbourhoods @xmath615 for @xmath616 , or @xmath608 for @xmath617 ( and similarly for a swap between a node in @xmath117 and one of the @xmath618 ) .",
    "let @xmath619 @xmath620 be the nodes of @xmath117 enumerated from left to right .",
    "we shall describe a swapping process , involving less than @xmath621 swaps . at the end of this process of legal swaps , all nodes in @xmath117",
    "will be of the same type , ( but which type that is will not be determined until the end of the process ) .",
    "this process has @xmath22-many _ steps _ , with each step @xmath319 involving up to @xmath319 swaps .",
    "let @xmath622 be the type of @xmath623 at the end of stage @xmath319 .",
    "also , let @xmath624 contain the nodes @xmath625 which are of type @xmath626 and have not been involved in a swap by the end of stage @xmath319 .",
    "the construction is designed so that @xmath622 is the type of all @xmath627 st the end of stage @xmath319 .",
    "this feature guarantees that at the end of the process , all nodes in @xmath117 have the same type .",
    "stage 0 is null ( i.e.  we carry out no instructions at stage 0 ) .    at stage @xmath628",
    "we check if @xmath629 has type @xmath622 .",
    "if so , then we go to the next stage . if not",
    ", then suppose first that @xmath629 is unhappy .",
    "in the case that @xmath623 is happy , any unhappy @xmath622-node outside @xmath610 can swap with @xmath629 ( because an unhappy @xmath622-node moving next to a happy @xmath622-node can not decrease its utility ) . in the case that @xmath623 is unhappy , we claim that any node @xmath228 from @xmath630 can legitimately swap with @xmath629 . in order to see this , note that the number of @xmath622-nodes in the neighbourhood of @xmath623 is at least as large as this number at the beginning of the process . by the definition of @xmath630 ,",
    "this number is at least as large as the number of @xmath622 nodes in the neighbourhood of @xmath228 .",
    "this means that if @xmath228 moves to the place that @xmath629 occupies , its utility will not decrease .",
    "the last case in the procedure is if @xmath629 is happy and of type different than @xmath622 . in this case",
    "we define @xmath631 and swap all @xmath627 with distinct nodes in @xmath632 , starting with @xmath623 and moving to the left .",
    "these are legitimate swaps , as nodes of type @xmath633 move next to happy nodes of the same type ( so their utility is not decreased after the swap ) .",
    "this concludes the description of the process .    by the end of stage @xmath634 ,",
    "all nodes in @xmath117 are of the same type .",
    "since we perform less than @xmath621 many swaps , there are less than @xmath635 many nodes whose neighbourhoods are affected by these swaps . since @xmath22 is large , there are therefore at least @xmath96 many unhappy nodes remaining of each type remaining .",
    "[ le : tomonbo2w ] suppose that @xmath66 and @xmath636 . from a state that has an @xmath7-block of length @xmath97 and at least @xmath96 unhappy nodes of each type , there is a series of transitions to a state with an @xmath7-block of length @xmath95 .",
    "the same holds for @xmath8-blocks .",
    "consider the given state and assume that there is no @xmath7-block of length @xmath95 ( otherwise 0 transitions suffice ) .",
    "let @xmath259 $ ] be the longest @xmath7-block in the given state , and let @xmath610 consist of all the nodes that are at distance at least @xmath22 from the interval @xmath637 $ ] .",
    "note that @xmath638 is a @xmath8-node and since @xmath53 it is unhappy .",
    "let @xmath639 be the rightmost @xmath7-node to the left of @xmath228 .",
    "if @xmath639 is unhappy , then we may swap it with @xmath638 since its utility will not decrease .",
    "otherwise , if @xmath639 is happy , then it is at a distance at most @xmath22 from @xmath228 and we may successively swap the @xmath8-nodes in @xmath640 , starting from @xmath641 and moving to the right , for an equal number of unhappy @xmath7-nodes in @xmath610 . this is possible because each time that we move an @xmath7 node next to a happy @xmath7-node , the new @xmath7 node becomes happy .",
    "we repeat this process until an @xmath7-block of length @xmath94 has been formed .",
    "each step of the process increases the length of the @xmath7-block that is adjacent and to the left of @xmath230 .",
    "therefore the process will terminate .",
    "we also perform at most @xmath22 many swaps , meaning that we shall not run out of unhappy nodes to perform the swaps with .",
    "consider any state which is not completely segregated , but which has a contiguous block of length at least @xmath94 . without loss of generality ,",
    "suppose that this is a block of @xmath7 nodes occupying the interval @xmath18 $ ] , where this interval is chosen to be of maximum possible length .",
    "our aim is to show that from this state , one may legally reach another with a contiguous block of greater length ( or else a dormant state ) . now if the nodes @xmath15 and @xmath224 are both happy then the length of the interval ensures that all nodes in the block are happy  this follows by induction on the distance from the edge of the interval by considering the difference between successive neighbourhoods . in this case , if there exists an unhappy @xmath7 node @xmath642 , then let @xmath643 be distance at least @xmath614 from @xmath642",
    ". then @xmath642 and the @xmath8 neighbour of @xmath179 may legally be swapped , increasing the length of the run by at least 1 .",
    "so suppose instead that at least one of the nodes @xmath15 and @xmath224 is not happy , and without loss of generality suppose that @xmath15 has _",
    "less than or equal to @xmath224 , where the bias of a node is the number of @xmath7-nodes minus the number of @xmath8-nodes in its neighbourhood .",
    "then @xmath15 and @xmath644 may legally be swapped . performing this swap causes position @xmath644 to have at least the same bias as @xmath224 did before the swap , and causes @xmath645 to have at most the same bias as @xmath15 did before the swap .",
    "thus , the swap has the effect of shifting the run one position to the right and may be repeated until the length of the run is increased by at least 1 , i.e.   for successive @xmath646 we can swap the nodes @xmath416 and @xmath647 , so long as the latter is of type @xmath8 .",
    "the first stage at which the latter is of type @xmath7 the length of the contiguous block has been increased .",
    "putting these observations together , we conclude that from any state which has a contiguous block of length at least @xmath94 it is possible to reach full segregation .",
    "the case @xmath54 , we considered earlier .",
    "suppose that @xmath53 .",
    "we may assume that @xmath599 , because otherwise every state is a dormant state .",
    "if there exist at most @xmath93 unhappy nodes of each type in the state , lemma [ le : shortunhapno ] shows how to reach a dormant state or a state with a contiguous block of length @xmath95 . in the latter case ,",
    "lemma [ le : complsegdromslb ] shows that there is a series of transitions to complete segregation or to a dormant state .",
    "so we may assume that the given state has more than @xmath93 unhappy nodes of each type .",
    "then lemma [ le : toblolw ] shows how to reach a state with a contiguous block of length @xmath97 and at least @xmath96 many unhappy nodes of each type .",
    "furthermore , from such a state lemma [ le : tomonbo2w ] shows how to reach a dormant state or a state with a contiguous block of length @xmath95 . in the latter case ,",
    "lemma [ le : complsegdromslb ] shows that there is a series of transitions to complete segregation or to a dormant state .",
    "this is an exhaustive analysis that establishes a path to a dormant state or complete segregation , from every state .",
    "now we focus on the case where @xmath53 and @xmath200 . having established that a low number of unhappy nodes suffices to ensure dormant states are inaccessible , we now wish to show that such state is reached , before any dormant state is reached .",
    "since in this case there are always unhappy @xmath8-nodes , we are only concerned about the existence of unhappy @xmath7-nodes . one way to ensure this is to establish the existence of blocks of @xmath8-nodes of length @xmath203 .    [ le : persistb1 ] consider the process @xmath48 with @xmath53 and let @xmath100 be the least stage where the ratio between the very unhappy @xmath8-nodes and the unhappy @xmath7-nodes becomes less than @xmath101 ( putting @xmath102 if no such stage exists ) .",
    "then with high probability there is a @xmath8-block of length @xmath95 at all stages @xmath103 of the process .      since the initial state is random , as @xmath419 the probability that there is a @xmath8-block of length at least @xmath230 in the initial state tends to 1 .",
    "hence ( for sufficiently large @xmath5 ) we may assume that there is a @xmath8-block of length @xmath650 in the initial state , with probability at least @xmath651 .",
    "fix such a block and note that during the stages it may expand or retract .",
    "it suffices to show that , conditionally on the existence of such a block in the initial state , the probability that it shrinks to a block of length less than @xmath94 before stage @xmath100 is bounded by @xmath652 .",
    "let @xmath653 be the length of the block at stage @xmath319 , so that @xmath654 . also let @xmath655 and for each @xmath30 let @xmath656 .",
    "then @xmath657 for all @xmath319 , and @xmath658 .",
    "let @xmath330 be @xmath659 if @xmath660 , and let @xmath330 be @xmath384 if @xmath661 ( and @xmath662 if @xmath663 ) .",
    "also let @xmath664 , so if at stage @xmath319 the length of the @xmath8-block becomes less than @xmath94 , the random walk @xmath665 is ruined ( by stage @xmath100 ) .",
    "let @xmath666 be identical to @xmath665 , except for stages after @xmath100 , at which it remains identical to @xmath667 .",
    "hence it suffices to show that the probability that @xmath666 is ruined is bounded above by @xmath652 .",
    "let @xmath668 and let @xmath669 , so that @xmath670 .",
    "since @xmath671 , as long as the length of the block is at least @xmath22 , the nearest @xmath7-node on each side is unhappy .",
    "moreover these @xmath7-nodes can swap with any very unhappy @xmath8-node .",
    "any such swap at stage @xmath319 would make @xmath672 . on the other hand , the only way that @xmath673 ( i.e.  the length of the block is reduced )",
    "is that a @xmath8-node from one of the @xmath94 outer nodes in the block ( @xmath22 on each side ) is part of a swap at stage @xmath319 ( with an unhappy @xmath7-node ) . hence according to our hypothesis we have @xmath674 for all @xmath675 .",
    "so @xmath676 which means that the walk @xmath666 meets the requirements of lemma [ le : ranwalkbiasked ] .",
    "hence the probability that @xmath666 is ruined is bounded by the expression on the left - hand - side of .",
    "we sum up our argument .",
    "given @xmath44 , we start with a block of @xmath8-nodes of length @xmath230 , with probability at least @xmath651 . conditionally on this starting assumption , our argument says that with probability at least @xmath651 this block will continue to have length more than @xmath94 at all stages up to stage @xmath100 .",
    "hence the probability that there is no @xmath8-block of length @xmath95 at some stage @xmath103 is less than @xmath677 .",
    "another tool that was used in our analysis is a bound on the number of unhappy @xmath8-nodes in the infected area , in terms of the number of @xmath7-nodes in the infected area .",
    "this is based on the fact that , when the number of @xmath7-nodes in an interval is limited , then the number of unhappy @xmath8-nodes in the same interval is also limited .",
    "[ le : blockofpro ] consider a block of adjacent nodes which contains exactly @xmath228 nodes of type @xmath7 .",
    "then for each @xmath678 there are at most @xmath679 many @xmath8-nodes in the block for which the proportion of @xmath7-nodes in their neighbourhood is at least @xmath230 .",
    "we are given a block of adjacent nodes @xmath380 .",
    "let us call a node _ weak _ if it is a @xmath8-node for which the proportion of @xmath7-nodes in its neighbourhood is less than @xmath230 .",
    "it suffices to show that the number of @xmath8-nodes in @xmath380 which are not weak is at most @xmath680 .",
    "if we remove all of the weak nodes from @xmath380 , thus obtaining a possibly different ( and shorter ) block @xmath379 , then in the resulting configuration there are no weak nodes",
    ". it then suffices to show that the number of @xmath8-nodes in @xmath379 is at most @xmath679 .",
    "note that the number of @xmath7-nodes in @xmath379 remains @xmath228 , since we did not remove any @xmath7-nodes .",
    "let @xmath681 be the endpoints of block @xmath379 and define a finite sequence @xmath211 of @xmath8-nodes as illustrated in figure [ fig : partpabbinprl ] and formally defined as follows .",
    "let @xmath682 be the leftmost @xmath8-node in @xmath379 such that the left endpoint of its neighbourhood is @xmath683 and such that the neighbourhood of @xmath682 is entirely contained in @xmath379 ( if there exists such ) .",
    "assuming that @xmath257 is defined and there are @xmath8-nodes between the right endpoint of @xmath257 and @xmath684 , define @xmath685 to be the leftmost @xmath8-node in @xmath379 which is to the right of @xmath257 , whose neighbourhood is disjoint from that of @xmath257 and entirely contained in @xmath379 .",
    "let @xmath686 be the sequence defined in this way .",
    "then @xmath686 have disjoint neighbourhoods , each of them containing at least @xmath687 nodes of type @xmath7 .",
    "hence @xmath688 so @xmath689 which means that the number of nodes that are contained in the union of these neighbourhoods is bounded by @xmath690",
    ". since these are neighbourhoods of @xmath8-nodes that are not weak , the number of @xmath8-nodes that are contained in the union of these neighbourhoods is at most @xmath691 .",
    "( -5,-0.5 ) rectangle ( -2,0.5 ) ; ( -3.5,-0.15 ) rectangle ( -4,0.15 ) ; ( -1.3,-0.5 ) rectangle ( 1.7,0.5 ) ; ( 0.2,-0.15 ) rectangle ( -0.5,0.15 ) ; ( -6,0 )  ( 6,0 ) ; ( -6,-0.5 ) rectangle ( -5.5,0.5 ) ; ( 5.5,-0.5 ) rectangle ( 6,0.5 ) ; ( -5,0 )  ( -5,-0.5 ) ; ( -5.5,0 )  ( -5.5,-0.5 ) ; ( -5,0 )  ( -2,0 ) ; ( -5.5,-0.5 )  ( -5,-0.5 ) ; ( -3.5,0 ) circle ( 0.3ex ) ; at ( -3.3,0.2 ) @xmath682 ; ( -3.5,0 )  ( -3.5,-0.5 ) ; ( -4,0 )  ( -4,-0.5 ) ; ( -3.5,-0.5 )  ( -4,-0.5 ) ; ( b2 ) at ( -5.35,-0.55 ) ; ( r2 ) at ( -3.61,-0.55 ) ; ( b2 ) to [ in=-150 , out = -30 ] ( r2 ) ; ( 0.2,0 ) circle ( 0.3ex ) ; ( -1.3,0 )  ( -1.3,-0.5 ) ; ( -2,0 )  ( -2,-0.5 ) ; ( -1.3,0 )  ( 1.7,0 ) ; ( -2,-0.5 )  ( -1.3,-0.5 ) ; at ( 0.4,0.2 ) @xmath692 ; ( 0.2,0 )  ( 0.2,-0.5 ) ; ( -0.5,0 )  ( -0.5,-0.5 ) ; ( 0.2,-0.5 )  ( -0.5,-0.5 ) ; ( b1 ) at ( -1.65,-0.55 ) ; ( r1 ) at ( -0.15,-0.55 ) ; ( b1 ) to [ in=-150 , out = -40 ] ( r1 ) ; at ( 3.6,0.2 ) @xmath693 ; at ( 3.6,-0.2 ) @xmath693 ;    let @xmath694 be the distance between the right endpoint of the neighbourhood of @xmath257 and the left endpoint of the neighbourhood of @xmath685 . note that for each @xmath695 there is a block of at least @xmath694 nodes of type @xmath7 in the the left semi - neighbourhood of @xmath685 . indeed , according to the definition of @xmath211 ,",
    "the only reason why there is some distance @xmath696 between the two endpoints is that a block of @xmath7-nodes of length @xmath696 immediately to the left of @xmath685 . we may conclude that there are at least @xmath697 nodes of type @xmath7 . by the hypothesis the @xmath7-nodes are exactly @xmath228 , so @xmath698",
    "hence the number of @xmath8-nodes in @xmath379 that do not belong to the neighbourhood of some @xmath686 is at most @xmath699 ( where @xmath94 is an upper bound for the number of @xmath8-nodes in the final segment of @xmath379 to the right of the neighbourhood of @xmath700 , or the whole of @xmath379 if @xmath701 ) .",
    "hence , overall , there are at most @xmath702 nodes of type @xmath8 in @xmath379 , which concludes the proof .",
    "a @xmath8-node is unhappy if and only if the proportion of @xmath7-nodes in its neighbourhood is more than @xmath500 .",
    "hence we may apply lemma [ le : blockofpro ] with @xmath230 equal to a value that is slightly larger than @xmath500 ( taking the limit @xmath703 from above and taking into account that the number of nodes are integers ) gives the following bound on the number of unhappy @xmath8-nodes in a block .",
    "[ le : redvsunhapgr ] consider a block of adjacent nodes of type @xmath7 or @xmath8 such that exactly @xmath228 of these nodes are of type @xmath7 .",
    "then there are at most @xmath704 unhappy @xmath8-nodes in this block .    by applying this fact to each of the infected segments of the process , and adding up the numbers unhappy nodes in each of the segments we see that @xmath705 , which is the fact used in the main part of our analysis .      in this case of unbalanced happiness (",
    "i.e.  when @xmath53 and @xmath85 , see table [ ta : validptwocasesnadcorr ] ) the unhappy @xmath7-nodes are initially very rare , so the interesting activity ( namely @xmath7-to-@xmath8 swaps ) occurs in small intervals of the entire population ( at least in the early stages ) . these intervals contain the unhappy @xmath7-nodes , and gradually expand , while outside these intervals all @xmath8-nodes are very unhappy .",
    "figure [ fig : biasplot ] ( produced from a simulation ) shows the development of this process , where the height of the nodes ( perpendicular lines ) is proportional to the number of @xmath7-nodes in their neighborhood and the horizontal black line denotes the threshold where an @xmath7-node becomes unhappy .",
    "these cascades that spread the unhappy @xmath7-nodes are due to the following domino effect .",
    "an unhappy @xmath7-node moves out of a neighbourhood , thus reducing the number of @xmath7-nodes in that interval .",
    "this in turn often makes another @xmath7-node in the interval unhappy , which can move out at a latter stage , thus causing another @xmath7-node nearby to be unhappy , and so on .",
    "the expanding intervals are the _ infected segments _ which start their life as _",
    "[ de : infectincuba ] consider the set @xmath117 of nodes in the initial state which belong to an interval of nodes of length @xmath22 with less than @xmath706 many @xmath7-nodes .",
    "let @xmath707 be the set of nodes whose neighborhood contains a node in @xmath117 .",
    "an incubator is a maximal interval of nodes that is entirely contained in @xmath707 .",
    "an interval of nodes is called _ active _ at a certain state if it contains an unhappy @xmath7-node . the _ infected area _ is the area that incubators generate by making additional @xmath7-nodes unhappy .",
    "it is always expanding , and is defined formally as follows .",
    "let @xmath117 be an incubator .",
    "at stage @xmath205 the infected segment @xmath708 corresponding to @xmath117 is @xmath117 itself . at the end of stage @xmath628 , we first consider those @xmath709 which were active at the end of stage @xmath319 and which are still active .",
    "we consider these active infected segments in turn , starting at position 0 and moving clockwise .",
    "for each such @xmath709 we let @xmath710 , where @xmath610 consists of the nodes which do not already belong to another active infected segment ( by the time we consider @xmath709 ) and whose neighborhood contains an unhappy @xmath7-node in @xmath711 at stage @xmath628 .",
    "we then consider the remaining @xmath709 ( i.e.  those which are no longer active ) : for each such we define @xmath712 where @xmath453 consists of the nodes in @xmath709 which now belong to an active infected segment .",
    "the _ infected area _ is the union of the infected segments .",
    "the _ fresh infected segment _ corresponding to infected segment @xmath117 is @xmath713 , i.e.  consists of the nodes @xmath117 except the nodes in its incubator . hence a _ fresh infected segment _ consists of two growing intervals of nodes .",
    "the _ fresh infected area _ is the infected area except the nodes in the incubators .",
    "the _ interior _ of a set of nodes @xmath610 consists of those nodes whose neighbourhood is entirely contained in @xmath610 .",
    "the _ boundary _ of @xmath610 consists of the nodes in @xmath610 which are not in the interior .",
    "it is not hard to show that if @xmath85 , the probability that a node belongs to an incubator is @xmath106 .",
    "hence with high probability the number of incubators as well as the number of nodes belonging to incubators of the process @xmath48 is @xmath107 .",
    "our goal is now to show that the number of unhappy @xmath7-nodes remains suitably bounded throughout a significant part of the process .",
    "formally , the main idea is to bound this number with a martingale .",
    "intuitively though , why should the number of unhappy @xmath7-nodes remain fairly small ? at the start of the process the infected area is a very small proportion of the entire ring .",
    "the vast majority of unhappy @xmath8-nodes occur outside the infected area , while all unhappy @xmath7-nodes are inside the infected area .",
    "it follows that with high probability a swap will involve an @xmath7-node in the infected area and a @xmath8-node outside the infected area .",
    "a _ bogus swap _ is a swap is one that is not of this kind .",
    "a swap which involves a @xmath8-node currently inside the infected area is called bogus . given an infected segment @xmath117 , a bogus swap in @xmath117 is a swap that moves an @xmath7-node into @xmath117 .    in the absence of bogus swaps , it is not hard to show that the @xmath7-nodes in the infected area ( except those in the incubators ) are unhappy .",
    "this in turn can be used in order to show that the @xmath7-nodes in the infected area ( and so , the unhappy @xmath7-nodes too ) are likely remain @xmath64 .",
    "however there will be bogus swaps , and these can make certain @xmath7-nodes in the infected area happy .",
    "a node is called actively anomalous at some stage of the process if it is a happy @xmath7-node in the interior of the fresh infected area ; it is called anomalous if it has been actively anomalous in this or a previous stage .",
    "finally a node is called generally anomalous at some stage , if it is in the current infected area and has been or will be actively anomalous at some later stage of the process .",
    "clearly _ actively anomalous _ implies _ anomalous _ , which in turn implies _ generally anomalous _ ( but not the other way around ) .",
    "let @xmath108 denote the number of anomalous nodes at stage @xmath319 , and let @xmath714 denote the number of generally anomalous nodes at stage @xmath319 .",
    "a martingale argument will be used in order to show that as long as @xmath715 , the @xmath7-nodes in the infected area are likely to remain @xmath64 .",
    "the definition of anomalous nodes and @xmath714 may seem strange at this point , not least because @xmath714 is not predictable at stage @xmath319 .",
    "the reason that we introduce @xmath714 is that @xmath108 is very hard to analyze , and very hard to bound directly via a martingale ( adapted to the stages of the process ) .",
    "however it is possible to bound @xmath714 via a martingale argument of a more general type ( i.e.  which is not adapted to the stages of the process ) .",
    "since @xmath716 , this suffices for our purposes .",
    "recall that our current goal is to show that the number of unhappy @xmath7-nodes remains suitably bounded for a significant part of the process .",
    "the basic idea is that if the number of unhappy @xmath7-nodes increases sufficiently , then the infected area must become quite large , and it becomes very likely that the next swap will involve an unhappy @xmath7-node in the _ interior _ of the infected area",
    ". we shall be able to argue that there are good chances that the swap is not bogus .",
    "this means that this @xmath7-node will move outside the infected area and will become happy .",
    "the anomalous nodes , however , present a difficulty with this line of argument .",
    "the eviction of the @xmath7-node from the infected area ( and its replacement by a @xmath8-node ) may produce more unhappy @xmath7-nodes in its neighbourhood .",
    "so it is not absolutely true that the total number of unhappy @xmath7-nodes will decrease .",
    "in fact , as the simulations of figure [ fig : inf_area ] suggest , at the early stages of the process this number is likely to increase slightly .    if we assume the absence of bogus swaps , then it is not hard to show that the nodes in the interior of the infected area and outside the incubators have neighborhoods with proportion of @xmath7-nodes well below @xmath98 . in this case",
    "it is straightforward to employ a martingale argument which shows that the number of @xmath7-nodes in the infected area ( hence also the total number of unhappy @xmath7-nodes ) remains bounded with high probability throughout the process .",
    "indeed , in this case there will be no happy @xmath7-nodes in the interior of the fresh infected area , so ( according to the argument we outlined above ) the likely swap absolutely reduces the total number of unhappy @xmath7-nodes .    in the presence of bogus swaps",
    ", we will use a more sophisticated martingale argument to bound the anomalous nodes .",
    "this can be used by another simpler martingale argument , in order to bound the number of unhappy @xmath7-nodes , at least up to some stopping time of the process and with high probability .",
    "this plan requires the calculation of certain probabilities .",
    "the number of pairs which can cause a bogus swap is bounded by @xmath720 . on the other hand ,",
    "any unhappy @xmath7-node can swap with a @xmath8-node outside the infected area .",
    "indeed , this is because the number of @xmath7-nodes in the neighbourhood of any @xmath8-node outside the infected area is at least @xmath98 .",
    "hence there are at least @xmath721 pairs of nodes that can swap at stage @xmath628 .",
    "we can conclude that the probability of a bogus swap is bounded by @xmath722 .",
    "the probability that @xmath724 is at least as much as the probability that the swap is not bogus and it involves a node in the interior of the infected area at stage @xmath628 .",
    "indeed , in this case the swap moves an @xmath7-node from the interior of the infected area to outside the infected area , so @xmath726 , because the length of the infected area remains the same .",
    "the unhappy @xmath7-nodes of the infected area that can not be part of such a swap are the ones that belong to the boundary of the infected area , so they are at most @xmath727 many .",
    "this means that there are at least @xmath728 nodes of type @xmath7 which can be picked as part of a swapping pair at stage @xmath628 such that @xmath729 is negative .",
    "note that each of these @xmath7-nodes forms a swapping pair with any @xmath8-node outside the infected area , since all such @xmath8-nodes are very unhappy . therefore there are at least @xmath730 many swapping pairs which make @xmath729 negative . on the other hand ,",
    "the total number of swapping pairs are at most @xmath731 many .",
    "hence @xmath732 is a lower bound for the probability that @xmath724 .    for the second clause , note that @xmath725 can only happen in the case that the infected area expands at stage @xmath628",
    "this can only occur if the swapping pair involves an @xmath7-node that belongs to the boundary of the infected area of stage @xmath319 .",
    "there are at most @xmath727 such nodes so there are at most @xmath733 swapping pairs that can cause @xmath724 .",
    "moreover there are at least @xmath734 possible swapping pairs for stage @xmath628 .",
    "hence @xmath735 is an upper bound for the probability that @xmath725 .",
    "we may now identify our first supermartingale .",
    "note that the following fact is the reason why we defined the anomalous nodes the way we did .",
    "the fact that @xmath108 is nondecreasing is a necessary part of the following proof .      at the end of stage @xmath319 ( and",
    "given all information as to how the process has unfolded so far ) denote the probability that @xmath724 by @xmath738 and the probability that @xmath725 by @xmath280 .",
    "let @xmath739 be the expected value of @xmath740 .",
    "now at stage @xmath628 the infected area can expand by at most @xmath22 nodes .",
    "moreover , it is not possible that at stage @xmath628 , an @xmath7-node which is not in the infected area of stage @xmath319 is moved to a position in the infected area of stage @xmath628 .",
    "this is because all @xmath7-nodes outside the infected area of stage @xmath319 are happy at stage @xmath319 .",
    "it follows that @xmath741 at each stage @xmath319 .",
    "therefore      by lemma [ le : zs1lzsprob ] , in order to ensure that @xmath743 , it suffices that @xmath744 .\\ ] ] since @xmath737 the expression inside the parentheses in the latter inequality is bounded above by 2 .",
    "hence for the condition @xmath743 it is sufficient that @xmath745 for all @xmath737 .",
    "so now we divide into two cases .",
    "if @xmath746 then @xmath747 .",
    "otherwise , @xmath748 and the result follows from the fact that @xmath108 is non - decreasing .    now to get from @xmath749 to @xmath115 , we need to bound @xmath108 .",
    "intuitively , we expect the proportion of the @xmath7-nodes in neighborhoods of nodes in the interior of the infected area to be rather low , e.g.  considerably lower than the threshold @xmath98 .",
    "the following lemma gives a justification for such an expectation and is also the reason why we chose @xmath519 in the definition of incubators , definition [ de : infectincuba ] .",
    "here is an intuitive explanation of this fact .",
    "let us say that a node in the infected area which is not in the interior of the infected area is in the boundary of the infected area .",
    "a node in the boundary of the infected area can see a node outside the infected area .",
    "the nodes in the complement of the infected area have never seen unhappy @xmath7-nodes , hence the proportion of @xmath7-nodes in their semi - neighbourhoods can only increase .",
    "this means that one of the semi - neighbourhoods of each node in the boundary of the infected area has not been affected by @xmath7-to-@xmath8 swaps .",
    "the following lemma says that such a node can only be included in the interior of the infected area if the semi - neighbourhood of it which has been affected by @xmath7-to-@xmath8 swaps , is affected by at least @xmath750 many such swaps .",
    "in other words , the expansion of the infected area requires a considerable number of stages .",
    "the particular statement refers to the case where the infection travels from right to left . by symmetry",
    ", an analogous statement holds for the case where the infection travels the opposite direction .",
    "[ le : deephl ] let @xmath751 $ ] be an interval of nodes in the initial state of the process , and @xmath305 such that for each @xmath752 $ ] the proportion of @xmath7-nodes in each semi - neighbourhood of @xmath15 is at least @xmath753 . consider a time interval of the process where there have been no @xmath7-to-@xmath8 swaps in @xmath754 .",
    "for each @xmath752 $ ] and any stage in this interval , if there is an unhappy @xmath7-node in @xmath755 $ ] then there have been at least @xmath756 many @xmath7-to-@xmath8 swaps in the right semi - neighbourhood of @xmath15 by that stage .",
    "let @xmath319 be a stage of the process and suppose that there have been no @xmath7-to-@xmath8 swaps in @xmath754 by stage @xmath319 .",
    "suppose that there is an unhappy @xmath7-node in @xmath757 $ ] at stage @xmath319 .",
    "then there must have been an unhappy @xmath7-node in @xmath758 $ ] at some stage @xmath759 .",
    "consider the first such stage @xmath760 and let @xmath761 be the rightmost @xmath7-node in @xmath762 $ ] which became unhappy at stage @xmath760 . by our hypothesis , up to stage @xmath760 there has been no @xmath7-to-@xmath8 swaps in @xmath763 $ ] .",
    "hence all of the @xmath7-to-@xmath8 swaps that occurred in the right semi - neighbourhood of @xmath761 are also in the right semi - neighbourhood of @xmath15 .",
    "the proportion of the @xmath7-nodes in the left semi - neighbourhood of @xmath761 is more than @xmath753 . since @xmath761 is unhappy at @xmath760 , the proportion of the @xmath7-nodes in its neighbourhood is less than @xmath24 .",
    "hence the proportion of the @xmath7-nodes in its right semi - neighbourhood is at most @xmath764 at stage @xmath179 .",
    "hence by hypothesis , by stage @xmath179 at least @xmath756 many @xmath7-to-@xmath8 swaps have occurred in the right semi - neighbourhood of @xmath224 . by the above discussion",
    ", these swaps have also occurred in the right semi - neighbourhood of @xmath15 .    according to the definition of incubators , this fact is relevant for @xmath765 and shows that the infected area expands reasonably slowly in the stages of the process @xmath48 .",
    "indeed , the proportion of @xmath7-nodes in the neighbourhood of any node outside the infected area at any particular stage is at least @xmath766 .",
    "this also shows that , in the absence of bogus swaps , all @xmath7-nodes in the interior of the fresh infected area are always unhappy ( i.e.  there are no anomalous nodes ) . in the presence of bogus swaps",
    "this is no longer true , and this is why we have to work in order to bound the spread of anomalous nodes .",
    "recall that @xmath108 denotes the number of anomalous nodes at stage @xmath319 . in this section",
    "we construct a martingale process which shows that @xmath108 is likely to be bounded appropriately , throughout a significant part of the schelling process .",
    "this argument requires us to consider the random variables localized into the individual infected segments .",
    "recall the stopping times defined in the second part of table [ ta : validprglobbouatd ] .",
    "we use @xmath767 rather than @xmath768 in the definition of @xmath128 so as to allow for the slight discrepancy which one might expect between @xmath9 and @xmath12 .",
    "let @xmath128 be the least stage such that @xmath769 .",
    "define @xmath123 to be the first stage which is either @xmath770 or else such that @xmath771 .",
    "finally let @xmath772 be the first stage for which @xmath119 . in all cases ,",
    "if the stage described does not exist then we define the corresponding stopping time to be @xmath773 .",
    "given an infected segment @xmath117 , let @xmath774 be the number of nodes in @xmath709 that will ever become anomalous , up to stage @xmath128 .",
    "this is a version of the _ generally anomalous _",
    "nodes @xmath714 .",
    "a stage is called an @xmath117-stage if a swap occurs involving a node from @xmath117 .",
    "@xmath775 we use @xmath776 as a superscript in other variables in the following , in order to indicate that they are ` jump processes ' in the sense that they are not updated at every stage or even every @xmath117-stage of the schelling process . for example , @xmath777 is only updated every @xmath778 many @xmath117-stages of the schelling process .",
    "recall that we may view the underlying probability space @xmath383 as a tree , where the nodes are states and branchings correspond to state transitions .",
    "let @xmath779 denote the subspace restricted to the stages up to time @xmath128 ( which may be infinite ) .",
    "normally we would say that an event @xmath780 is @xmath117-independent if it did not impose any branching restrictions regarding the @xmath117-stages that occur in the reals in it . we give a sightly more general definition which is more appropriate for the argument to follow .",
    "an event @xmath780 is called @xmath117-independent if for each @xmath781 and any @xmath319 such that the transition from @xmath782 to @xmath783 occurs at an @xmath117-stage , @xmath784 for every state that is obtained from @xmath785 through a non - bogus swap .",
    "a filtration @xmath786 is called @xmath117-independent if for each @xmath319 the event @xmath787 is @xmath117-independent .",
    "analogously , a process @xmath788 on @xmath383 is called called @xmath117-independent if the natural filtration of it is @xmath117-independent .",
    "intuitively , a process @xmath788 on the underlying probability space @xmath383 is @xmath117-independent , if for each @xmath319 , fixing the value of @xmath789 does not impose any restriction on ( i.e.  is compatible with all ) the transitions of the schelling process from stage @xmath319 to stage @xmath628 , that involve a non - bogus swap and a node from @xmath117 . here",
    "we use boldface font for @xmath789 because this process will typically by global , in the sense that it involves information about the process that is not restricted in the infected segment @xmath117 . in the following lemma",
    "we use @xmath790 for the underlying @xmath117-independent global process in order to indicate that it refers to the subsequence of stages @xmath791 of the process , much like @xmath792 .",
    "given an @xmath117-independent process @xmath794 such that @xmath792 is adapted to @xmath794 ( i.e.  @xmath792 is a function of @xmath794 ) it suffices to show that @xmath795 for all @xmath319 .",
    "let @xmath796 be the number of nodes in the left semi - interval of @xmath709 that will ever become anomalous , up to stage @xmath128 .",
    "similarly let @xmath797 be the number of nodes in the right semi - interval of @xmath709 that will ever become anomalous , up to stage @xmath128 .",
    "clearly @xmath798 .",
    "so it suffices to show that @xmath799 similarly , let @xmath800 be the left interval of the fresh part of @xmath801 and let @xmath802 be the right interval of the fresh part of @xmath801 .",
    "fix @xmath803 and set @xmath804 .",
    "in order to bound the expectation of @xmath805 , we consider the following cases ( where each case applies only if the one above it fails ) :    1 .",
    "@xmath806 ; 2 .",
    "there are bogus swaps in the @xmath117-stages @xmath807 to @xmath791 ; 3 .",
    "a happy @xmath7-node appears in the interior of @xmath808 before the interior becomes all @xmath8-nodes ; 4 .",
    "the above @xmath8-firewall forms , but it shrinks by @xmath73 at some later @xmath117-stage @xmath809 .",
    "5 .   otherwise .",
    "we will show that all of these events yield small expectation ( conditional on @xmath390 ) on the number of happy @xmath7-nodes that will ever appear in the interval @xmath810 after @xmath117-stage @xmath791 of the original process ( in particular , the probabilities of ( b)-(d ) are very small ) .",
    "we decide to accept @xmath73 happy @xmath7 nodes in @xmath811 as a desirable ( i.e.  not too high ) count .",
    "so , irrespective of likelihood , event ( a ) is desirable .",
    "note that by lemma [ le : deephl ] , @xmath812    note that lemma [ le : probboguss ] also holds locally , by the same proof .",
    "in other words , given an interval of nodes of length @xmath455 , then the probability that at stage @xmath628 a bogus swap will occur involving a @xmath8-node from the given interval is bounded above by @xmath813 . since all stages are bounded by @xmath128",
    ", it follows that the probability ( conditional on @xmath814 ) of a bogus swap in an area of length @xmath455 is less than @xmath815 .",
    "hence by , event ( b ) has probability ( conditional on @xmath814 ) upper bounded by @xmath816 .",
    "in this case we can bound the expectation trivially by @xmath817 .",
    "now suppose that ( a ) , ( b ) do not occur so that , by lemma [ le : deephl ] , each subinterval of length @xmath22 in the interior of @xmath810 has @xmath7-proportion at most @xmath818 at @xmath117-stage @xmath791 , where recall that @xmath819 . in particular , all @xmath7 nodes in the interior of @xmath810 are unhappy , and remain so unless @xmath820 bogus swaps happen in @xmath811 .",
    "we wish to show that in this case @xmath821 indeed couple this process ( conditional on @xmath814 , where each stage is either a non - bogus swap in @xmath810 , or something else ) with a gambler s ruin process , where the gambler has @xmath822 chips and the house has @xmath820 chips , and the ratio of the winning probabilities is less than @xmath823 in favor of the house .",
    "then we can estimate an upper bound the probability that @xmath820 bogus swaps occur in @xmath808 before all the interior turns into a @xmath8-firewall . according to the standard gambler s ruin result , this is @xmath824 which is also a bound on the ( conditional ) probability of event ( c ) .",
    "now assume that ( a)-(c ) do not occur , and lets estimate an upper bound for the probability of ( d ) .",
    "again , couple this process ( conditionally on @xmath814 ) with a biased random walk where a negative move corresponds to a bogus swap moving something from the @xmath22 border ( one or the other ) of the firewall , and a positive move is swapping the @xmath7-node at the edge with a @xmath8-node ( other events are ignored ) .",
    "the ratio of the probabilities is bounded above by @xmath825 which is bounded by @xmath826 .",
    "also note that a negative move chips ( at most ) @xmath22 away from the firewall , while a positive move only contributes ( at least ) one node to the firewall .",
    "then the probability that it will eat up @xmath827 at any future time is bounded by @xmath828 .",
    "for @xmath829 we get @xmath830 then the expectation of the number of anomalous nodes that will ever appear in @xmath831 is bounded by @xmath832 finally under case ( e ) it is clear that the conditional expectation of @xmath833 is also bounded by @xmath834 . considering all the different cases , by the law of alternatives for conditional expectation we have that @xmath835 , which concludes the proof .",
    "let @xmath836 be the infected segments ( and @xmath837 $ ] their state at stage @xmath319 ) . recall that @xmath714 is the sum of all @xmath838 , @xmath839 . in order to bound @xmath714",
    "we need to prove a global version of lemma [ le : atomdma ] .",
    "an immediate obstacle is the asynchrony of the @xmath117-stages with respect to the various infected segments @xmath117 .",
    "we need to find a process @xmath840 relative to which @xmath714 ( or some ` asynchronous ' version @xmath841 of it ) is a supermartingale .    for each @xmath839 let @xmath842 be the stage where",
    "exactly @xmath843 many @xmath844-stages have occurred .",
    "also let @xmath845 be a monotone enumeration of the times @xmath846 .",
    "let @xmath847 be @xmath848 for the maximum @xmath329 such that @xmath849 .",
    "let @xmath841 be the sum of all @xmath850 , @xmath839 .",
    "the point of this definition is that @xmath841 considers values of @xmath851 at the last stage @xmath759 where they completed a cycle ( which happens at every @xmath778 many @xmath844-stages ) and outputs their sum .",
    "define @xmath840 to be the vector containing the tuples @xmath852 for each @xmath839 . in this way",
    ", the process @xmath853 is adapted to @xmath854 ( in other words , for each @xmath319 , the value of @xmath841 is a function of @xmath840 ) . note that @xmath841 remains constant in the intervals @xmath855 , just as @xmath856 remains constant in the interval @xmath857 .",
    "using the law of alternatives for conditional expectation , it suffices to show that for each @xmath319 there is a ( finite ) partition @xmath860 of events relative to @xmath859 such that for each @xmath861 we have @xmath862    each event @xmath861 describes which pair of infected intervals @xmath844 completes a cycle at stage @xmath863 , and the sequence of @xmath844-stages ( for each of the two @xmath495 ) from @xmath864 to @xmath863 .",
    "formally , event @xmath380 is a tuple one tuple @xmath865 where @xmath866 , and for each @xmath803 an increasing sequence of stages starting from @xmath867 and ending on the same number @xmath868 .",
    "if @xmath869 then the two sequences should be the same .",
    "the meaning of @xmath380 is that @xmath870 and infected intervals with indices @xmath871 are hit at stage @xmath868 , with the sequence of stages representing the exact stages from @xmath867 to @xmath868 where a swap occurs in @xmath872 . by the definition of @xmath380 , this event is @xmath872-independent for @xmath803 . at stage @xmath863 of the process",
    "there must be exactly one tuple @xmath865 where @xmath873 , such that the swap occurred in @xmath874 and @xmath875 .",
    "for each such event @xmath380 on @xmath876 we have @xmath877 but for @xmath878 we have @xmath879 and by lemma [ le : atomdma ] we have @xmath880 since @xmath380 is @xmath872-independent for @xmath803 .",
    "therefore holds for each of the events @xmath380 . by the law of alternatives , and since there can be at most two infected segments that complete a cycle at stage @xmath863 , we get @xmath881 therefore @xmath882 is a supermartingale adapted to @xmath859 .      by lemma [ le : dhasmgas ] and the maximal inequality for supermartingales , given any @xmath886 , with probability at least @xmath887 we have @xmath888 for all @xmath126 .",
    "since each stage can be an @xmath844-stage for at most two distinct @xmath839 , we have @xmath889 .",
    "hence for each @xmath886 we have @xmath890 also , note that at each stage @xmath319 we have @xmath891 for each @xmath839 . hence @xmath892 .",
    "since we also have @xmath893 for all @xmath319 , the corollary follows from .",
    "the following result is the technical basis for the result that with high probability a safe state will be reached ( at some finite stage ) .",
    "it says that , with high probability the stopping times @xmath897 are equal and are bounded by @xmath5 .",
    "let @xmath44 such that @xmath899 . by hoeffding s inequality for bernoulli trials",
    "we may consider @xmath5 large enough such that the probability that @xmath900 is less than @xmath901 . recall that",
    "@xmath902 is the probability of a bogus swap at stage @xmath628 .",
    "suppose that @xmath22 is large enough such that with probability at least @xmath903      clause ( a ) can be ensured by lemma [ prop : blacksitesbou ] .",
    "clause ( b ) can be ensured by corollary [ coro : boundzhf ] .",
    "clause ( c ) can be ensured by corollary [ coro : boundzadditif ] .",
    "first , for a contradiction , assume that @xmath908",
    ". then @xmath909 .",
    "by corollary [ coro : boundzadditif ] and since ( by definition ) @xmath910 we have @xmath911 which is the required contradiction .",
    "hence with probability @xmath912 we have @xmath913 .",
    "second , we show that with probability at least @xmath651 we have @xmath914 . by clause ( c ) above , @xmath915 by , with probability at least @xmath903 , the expectation of the number of bogus swaps that have occurred by stage @xmath123 is @xmath916 . hence , conditionally on the event that @xmath917 for all stages @xmath906 , the probability that by stage @xmath918 more than @xmath919 bogus swaps have occurred is less than @xmath901 .",
    "hence the unconditional probability that by stage @xmath918 at most @xmath920 bogus swaps have occurred is at least @xmath921 .",
    "we conclude the argument .",
    "we have established that the probability of the event @xmath908 or @xmath922 is bounded by @xmath652 .",
    "it remains to show that outside this rare event , @xmath923 .",
    "since every non - bogus swap reduces @xmath116 by ( at least ) 1 , and @xmath924 , @xmath52 , with probability at least @xmath651 we have @xmath925 which shows that @xmath926 with probability at least @xmath47 .          clause ( a ) can be ensured by lemma [ le : stoptimefin ] and clause ( b ) can be ensured by corollary [ coro : boundzhf ] .",
    "clause ( c ) can be ensured by lemma [ prop : blacksitesbou ] . by the definition of @xmath128 ,",
    "hence by corollary [ coro : boundzadditif ] we have @xmath931 with probability @xmath932 .",
    "but @xmath118 so the mixing index at stage @xmath128 is less than @xmath933 . in other words , @xmath131 , so by proposition [ prop : maxmixindor ] the process at stage @xmath128 is in a safe state , with probability more than @xmath47 .",
    "hence by corollary [ coro : inevcompsegd1 ] , the process will arrive to complete segregation with probability at least @xmath47 ."
  ],
  "abstract_text": [
    "<S> the schelling model of segregation looks to explain the way in which a population of agents or particles of two types may come to organise itself into large homogeneous clusters , and can be seen as a variant of the ising model in which the system is subjected to rapid cooling . while the model has been very extensively studied , the unperturbed ( noiseless ) version has largely resisted rigorous analysis , with most results in the literature pertaining to versions of the model in which noise is introduced into the dynamics so as to make it amenable to standard techniques from statistical mechanics or stochastic evolutionary game theory .    </S>",
    "<S> we rigorously analyse the one - dimensional version of the model in which one of the two types is in the minority , and establish various forms of threshold behaviour . </S>",
    "<S> our results are in sharp contrast with the case when the distribution of the two types is uniform ( i.e.  each agent has equal chance of being of each type in the initial configuration ) , which was studied in @xcite .    </S>",
    "<S> * george barmpalias * + state key lab of computer science , institute of software , chinese academy of sciences , beijing , china . school of mathematics , statistics and operations research , victoria university of wellington , new zealand . </S>",
    "<S> + _ e - mail : _ `` . _ web : _ ``    * richard elwes * + school of mathematics , university of leeds , ls2 9jt leeds , united kingdom . </S>",
    "<S> + _ e - mail : _ `` _ web : _ ``    * andy lewis - pye * + department of mathematics , columbia house , london school of economics , houghton street , london , wc2a 2ae , united kingdom . </S>",
    "<S> + _ e - mail : _ `` _ web : _ `` </S>"
  ]
}