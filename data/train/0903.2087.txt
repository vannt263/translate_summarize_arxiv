{
  "article_text": [
    "in a previous paper @xcite we demonstrated , through a series of simple examples , how a new computer algebra program , cadabra ( @xcite , @xcite , @xcite , @xcite ) could be employed to do the kinds of tensor computations often encountered in general relativity .",
    "the examples were deliberately chosen to be simple .",
    "so it is reasonable to wonder how cadabra might handle much more challenging computations . to explore this question we put cadabra to the task of computing the riemann normal coordinate expansions of the metric and other geometrical quantities , in particular the geodesic arc length .",
    "such computations are known to be , at higher orders , very demanding and prohibitively difficult to compute by hand . here",
    "we will show that cadabra handles these computations with ease .",
    "there is also a direct practical purpose to these calculations .",
    "we are developing ( @xcite , @xcite ) an approach to numerical relativity that uses a lattice , similar to that used in the regge calculus ( @xcite , @xcite , @xcite ) , as way to record the metric ( through the table of leg - lengths ) and topology ( through the connections between vertices ) of the spacetime .",
    "central to that approach is the use of riemann normal coordinates in the computation of the riemann curvatures given just the leg - lengths and ( some ) angles .",
    "for this to work we need an equation that links the curvatures to the geodesic arc - length ( the leg - lengths ) .",
    "the result is equation in section ( [ sixthorderrnc ] ) .",
    "the basic idea behind riemann normal coordinates is to use the geodesics through a given point to define the coordinates for nearby points .",
    "let the given point be @xmath0 ( this will be the origin of the riemann normal frame ) and consider some nearby point @xmath1 . if @xmath1 is sufficiently close to @xmath0 then there exists a unique geodesic joining @xmath0 to @xmath1 .",
    "let @xmath2 be the components of the unit tangent vector to this geodesic at @xmath0 and let @xmath3 be the geodesic arc length measured from @xmath0 to @xmath1 .",
    "then the riemann normal coordinates of @xmath1 relative to @xmath0 are defined to be @xmath4 .",
    "these coordinates are well defined provided the geodesics do not cross ( which we can always ensure by choosing the neighbourhood of @xmath0 to be sufficiently small ) .",
    "one trivial consequence of this definition is that all geodesics through @xmath0 are of the form @xmath5 and that the @xmath2 are constant along each geodesic .",
    "this implies , by direct substitution into the geodesic equation , that @xmath6 at @xmath0 which in turn implies that @xmath7 at @xmath0 .",
    "suppose now that we were to expand the metric as a taylor series in @xmath8 about @xmath0 . in that series there would only be the zero , second and higher derivatives of the @xmath9 .",
    "thus the leading terms of the metric could be expressed as a sum of a constant part plus a curvature part .",
    "if the curvature is weak this can be interpreted as an expansion of the metric in powers ( and derivatives ) of the curvature .",
    "likewise one can imagine similar expansions of other geometrical quantities ( e.g. geodesics , arc length ) in terms of a flat space part plus a curvature contribution .",
    "higher order expansions are extremely tedious to compute by hand .",
    "some hardy souls ( @xcite , @xcite , @xcite ) have endured the journey ( mller et al ( @xcite ) venture as far as 11-th order expansions for the metric ( i.e. to terms involving the 8-th derivative of the curvatures , the notion of order will be defined in the following section ) .",
    "however most people settle for just the first two non - trivial curvature terms ( i.e. @xmath10 and @xmath11 ) .",
    "as we will see , the easiest expansion to compute is that for the metric in powers of the curvatures and its derivatives .",
    "much more challenging is the expression that allows the riemann normal coordinates to be constructed from a given set of coordinates .",
    "this later calculation involves the solution of a two point boundary value problem  not a job for the faint - hearted .",
    "the expansion of the metric in riemann normal form can be found in many articles . for those with a mathematical bent see ( @xcite , @xcite , @xcite ) and in particular the elegant exposition by gray ( @xcite , @xcite ) . for applications in physics see ( @xcite , @xcite , @xcite ) .",
    "each algorithm given later in this paper yields polynomial approximations to particular geometric quantities ( e.g. the metric ) .",
    "higher order approximations are obtained by recursive application of the algorithms .    in this section",
    "we will define what we mean when we say that the polynomial @xmath12 is an expansion of @xmath13 up to and including terms of order @xmath14 .",
    "we will do so by introducing a conformal transformation of the original metric .",
    "consider some neighbourhood of @xmath0 and let @xmath15 be a typical length scale for @xmath0 ( for example , @xmath15 might be the length of the largest geodesic that passes through @xmath0 and confined by the neighbourhood ) .",
    "construct any regular set of coordinates @xmath8 ( i.e. such that the metric components are non - singular ) in the neighbourhood of @xmath0 and let the coordinates of @xmath0 be @xmath16 .",
    "we will use the word _",
    "patch _ to denote the neighbourhood of @xmath0 in which these coordinates are defined .",
    "now define a new set of coordinates @xmath17 by @xmath18 and thus @xmath19 now define the conformal metric @xmath20 by @xmath21 .",
    "this leads to @xmath22 and @xmath23 where the partial derivatives on the left are with respect to @xmath24 and those on the right are with respect to @xmath25 .",
    "since @xmath26 does not depend on @xmath15 we have the general result that @xmath27 from this it follows , by simple inspection of the standard equations , that @xmath28 { \\tilde r}^{a}{}_{bcd , i_1i_2i_3\\cdots i_n } & = \\bigo{\\eps^{n+2}}\\qquad \\text{at } o\\end{aligned}\\ ] ]    there are now two ways to look at the patch .",
    "we can view it as patch of length scale @xmath15 with a curvature independent of @xmath15 .",
    "or we can view it as patch of fixed size but with a curvature that depends on @xmath15 ( and where the limit @xmath29 corresponds to flat space ) .",
    "this later view is useful since in using it we can be sure that the series expansions around flat space are convergent ( for a sufficiently small @xmath15 ) .",
    "we will use these conformal coordinates for the remainder of this paper . as there is no longer any reason to distinguish between @xmath8 and @xmath17 we replace @xmath17 with @xmath8 .",
    "the @xmath8 will now be treated as generic coordinates ( but keep in mind that we are working in a conformal gauge ) .    finally , when we say that @xmath30 is an expansion of @xmath13 up to and including terms of order @xmath14 we mean that @xmath31 for some finite positive @xmath32 i.e.  if @xmath13 were expanded as a taylor series in @xmath15 around @xmath33 then @xmath13 and @xmath30 would differ by terms proportional to @xmath34 .",
    "suppose , as is almost always the case , that our coordinates @xmath8 are _ not _ in riemann normal form .",
    "how might we transform to a local set of riemann normal coordinates ? if we were to appeal to the simple definition @xmath35 we would soon encounter a hurdle .",
    "the quantities @xmath2 are rarely known explicitly but must instead be computed by solving a two - point boundary value problem .",
    "this is non - trivial but it can be dealt with in stages . first construct a taylor series expansion for an arbitrary geodesic passing through @xmath0 .",
    "this solution to the initial value problem will depend on two integration constants , @xmath8 and @xmath36 , being the respective values of @xmath37 and @xmath38 at @xmath39 .",
    "next use a fixed - point iterative scheme to produce successive approximations to @xmath36 so that the geodesic passes through both points @xmath0 and @xmath1 .",
    "then finally compute @xmath2 as @xmath38 at @xmath39 .",
    "this is exactly the plan which we will follow .",
    "it is well known that riemann normal coordinates can always be constructed _ locally _ around any non singular point ( see @xcite ) .",
    "thus we will not concern ourselves here with issues such as existence and convergence but rather we will focus our attention on developing algorithms for expressing various quantities in riemann normal form .",
    "our aim here is to obtain a taylor series , about the point @xmath0 , for solution of the geodesic equation @xmath40 subject to the initial conditions @xmath41 and @xmath42 at @xmath39 .",
    "we choose @xmath39 at @xmath0 and we write the taylor series for @xmath37 as @xmath43 the second and higher derivatives can be obtained by successive differentiation of the geodesic equation leading to @xmath44 where the @xmath45 , known as _ generalised connections _ , are defined recursively by @xmath46 note that the use of round brackets @xmath47 denotes total symmetrisation over the included indices ( see appendix a for more details ) .    a convenient shorthand for equation in terms of covariant derivatives can be obtained if you ignore ( in this context alone ) the single upper index .",
    "this leads to the compact notation @xmath48      here we seek to juggle @xmath36 so that the geodesic passes through not only @xmath0 but also @xmath1 .",
    "suppose that the coordinates of @xmath1 are @xmath49 where @xmath8 are the coordinates of @xmath0 .",
    "the solution already passes through @xmath0 so we have only now to force it to pass through @xmath1 .",
    "let @xmath50 be the geodesic distance from @xmath0 to @xmath1 .",
    "then our challenge is to solve @xmath51 for @xmath36 in terms of @xmath52 and the generalised connections",
    ".    put @xmath53 ( this introduces the riemann normal coordinates ) and re - arrange the equation into the form @xmath54 we now plan to solve this equation for @xmath17 by constructing a sequence of approximations @xmath55 to @xmath17 .",
    "in principle we could imagine that @xmath17 has been found and that we have expanded it as a infinite series in powers of @xmath15 ( i.e. as a power series in the curvatures ) .",
    "we will choose @xmath55 to be the taylor polynomial of @xmath17 to order @xmath56 .",
    "that is , @xmath55 is a polynomial in the curvatures ( and its derivatives ) up to and including terms of order @xmath57 .",
    "we can compute @xmath55 by truncating both side of to terms no higher than @xmath57 .",
    "but note that the @xmath45 are of order @xmath58 .",
    "the upshot is that the infinite series may be truncated at @xmath59 while still retaining all terms up to and including @xmath56 .",
    "thus we have @xmath60 where @xmath61 is a simple truncation operator ( it deletes all terms of order @xmath62 or higher ) .",
    "this is a marginal improvement on ( at least we have a finite series ) but it is still a non - linear equation for @xmath55 .",
    "but fortunately we can do better .",
    "notice , once again , that @xmath63 and this allows us to use lower order estimates for @xmath17 in the product terms on the right hand side .",
    "this leads to @xmath64 now we see that @xmath55 appears only on the left hand side and thus we can use this equation to recursively compute @xmath65 for @xmath66 . here",
    "are the first few @xmath55 .",
    "we start with the lowest order approximation , @xmath67 and as there are no @xmath68 terms in we have @xmath69 now set @xmath70 in equation to obtain @xmath71        & = \\delta x^a + \\frac{1}{2 } \\gamma^a{}_{i_1i_2 } \\delta x^{i_1}_1 \\delta x^{i_2}_1\\end{aligned}\\ ] ] and once more , with @xmath72 , with the result @xmath73        & = \\delta x^a + \\frac{1}{2 } \\gamma^a{}_{i_1i_2 } \\delta x^{i_1 } \\delta x^{i_2 }                      + \\frac{1}{6 } \\left (   \\gamma^a{}_{bi_1}\\gamma^b{}_{i_2i_3 }                                           + \\gamma^a{}_{i_1i_2,i_3}\\right ) \\delta x^{i_1 }                                                                            \\delta x^{i_2 }                                                                            \\delta x^{i_3}\\end{aligned}\\ ] ] this process may seem simple but looks can be deceiving  the higher order @xmath55 contain a profusion of terms that , when computed by hand , are largely unmanageable beyond @xmath74 .",
    "we will return to this point later when we discuss the use of cadabra to perform these computations .",
    "this completes our first objective  to find a way to transform from any non - singular set of coordinates to a local set of riemann normal coordinates .",
    "the question we now pose is  what form does the metric take in these coordinates ?",
    "this is the subject of the second next section .",
    "but first we shall take a short moment to introduce some new notation .",
    "the calculations we are undertaking are flooded with expression such as @xmath75 in which long stretches of indices like @xmath76 abound .",
    "this is tedious to write and , in the authors opinion , rather untidy .",
    "here we propose a variation on the notation that is both easy to read and write while not detracting from the meaning in the expression .",
    "the proposal is that a sequence of indices such as @xmath76 be replaced with a single index of the form @xmath77 . in this notation the previous equation",
    "could be written as @xmath78 where @xmath79 contains @xmath80 indices . in cases where the number of hidden indices needs to be made clear",
    "we will either say so in words ( as we did in the previous example ) or we will include the number as a subscript , for example @xmath81 this version is however , not as clean as the previous version .    for equations like @xmath82 we will write @xmath83 we chose this notation of single dot in @xmath84 because of its suggestive form ( of multiplication of as many copies of @xmath85 as required to exhaust the indices within @xmath86 ) . here is another common construction @xmath87 how might we tidy this up ? by including a dot before the derivative index @xmath86 , like this @xmath88 these simple changes brings some degree of normalcy to the printed form but those gains rapidly pale into insignificance when we ask cadabra ( in section ( [ sixthorderrnc ] ) ) to display the results for the sixth order riemann normal expansions .",
    "these results contain expressions with symmetries in some of the indices which when printed can stretch over many a4-pages .",
    "the reason is in part that the expressions are inherently long but also because cadabra does not use the round - bracket notation to denote symmetrisation over a set of indices .",
    "instead it uses the fully expanded form which , on paper , can lead to an @xmath89 explosion in otherwise similar looking terms .",
    "we will try to minimise this problem as follows .",
    "suppose we have an object @xmath90 which we know to be symmetric on the indices @xmath91 .",
    "we create an arbitrary @xmath92 and instruct cadabra to simplify the expression @xmath93 as much as possible .",
    "then we set @xmath92 equal to one just prior to printing the expression .",
    "but how do we convey to the reader that this operation has been performed ?",
    "the expression that we are trying to print will always be the right hand side of some equation such as @xmath94 and thus @xmath95 is also symmetric on @xmath91 .",
    "so when we print this equation we will include the round brackets on the left hand side .",
    "thus we would display the results as @xmath96 and we would understand that the right hand side should be symmetrised over @xmath91 .",
    "clearly this notational device should only ever be used at the end of the calculations .    our final notational device concerns cases where we want to exclude an index from symmetrisation .",
    "the normal practise is to exclude an index by enclosing it in a pair of vertical lines . in our variation",
    "we will place a dot above the excluded index .",
    "thus , where other authors might write @xmath97 to signify symmetrisation over only @xmath98 and @xmath99 , we will write @xmath100 .",
    "though these variations might appear to make only marginal improvements in the printed equations they have made it considerably easier for the author in creating the latex code for this document .",
    "in the preceding section we chose to distinguish between generic and riemann normal coordinates by using the symbols @xmath8 and @xmath17 respectively",
    ". we will now , for notational convenience and to accord with convention , revert to using @xmath8 for the riemann normal coordinates while stripping @xmath17 of any special meaning .",
    "our aim in this section is to express the metric in riemann normal form .",
    "this will take the form of an infinite series in powers of the curvature tensor and its derivatives .",
    "we start by writing out the taylor series for the metric around @xmath101 @xmath102 where @xmath79 contains @xmath103 indices and @xmath9 are constants ( e.g. @xmath104 ) .",
    "our present task is to express the partial derivatives of the metric in terms of the riemann tensor . from the standard definition of a metric compatible connection we have @xmath105 and",
    "since @xmath106 is totally symmetric in @xmath107 we also have @xmath108 two points should be noted , first , the connection appears only in the form @xmath109 , second , the left hand side contains derivatives one order higher than in the corresponding terms on the right hand side .",
    "the upshot is that we can use this equation to recursively compute all of the metric derivatives solely in terms of the @xmath109 and the constants @xmath9 . in this way",
    "we could express the above taylor series for the metric in terms of the connection .",
    "but we can go one stage further  the derivatives of the connection must surely tie in with the curvatures .",
    "thus we are led to review the standard definition for the curvature , which after a series of derivatives , can be written in the form @xmath110 can we use this to eliminate the connection and its derivatives from the metric ?",
    "yes , but only after we specialise to the riemann normal coordinates .",
    "recall that , in riemann normal coordinates , all geodesics through @xmath0 are of the form @xmath111 which upon substitution into the geodesic equations leads to @xmath112 it follows , by recursion on equation , that @xmath113 we also know that @xmath114 is separately symmetric in its first pair of indices and in the remaining @xmath115 lower indices ( assuming @xmath116 contains @xmath103 indices ) . thus using equation we have @xmath117 we can use this to eliminate the @xmath118 term in the previous equation for the curvature .",
    "the result , after a minor shuffling of terms is @xmath119 ( the reason for rearranging the terms will become clear in a moment ) .",
    "note also that the last term in the previous equation can be eliminated by equation and the product rule .    in summary ,",
    "the equations of interest are @xmath120 \\label{metricgamma } g_{ab , c\\ud } = \\left(g_{ae}\\gamma^{e}{}_{b(c}\\right){}_{\\!,\\ud ) }               + \\left(g_{eb}\\gamma^{e}{}_{a(c}\\right){}_{\\!,\\ud)}\\\\[10pt ] \\label{gammariemann } ( n+3)\\gamma^a{}_{d(b , c\\ue ) } =           ( n+1)\\left ( r^a{}_{(bc\\dot d,\\ue ) }                      - \\left(\\gamma^a{}_{i(c}\\gamma^i{}_{b{\\dot d}}\\right){}_{\\!,\\ue ) }                \\right)\\end{gathered}\\ ] ] we use these equations as follows . first , equation is used to recursively compute the @xmath121 in terms of the riemann tensor and its partial derivatives ( this was the reason behind the shuffling of terms noted above ) .",
    "note that @xmath116 in equation contains @xmath103 hidden indices .",
    "the @xmath122 are then substituted into which in turn is used to recursively express all of the @xmath123 in terms of the riemann tensor and its partial derivatives .",
    "when the dust settles we will have a finite series expansion for the metric in terms of the riemann tensor and its partial derivatives .",
    "the result , accurate to @xmath124 , is    g_ab(x)=g_a b - x^c x^d r_a c b d - x^c x^d x^e _ cr_a d b e+    we conclude this section by introducing one final variation to the algorithm just given  an option to re - express the metric in terms of the covariant rather than partial derivatives of the curvatures .",
    "it is not hard to see that after a series of covariant derivatives one would obtain an equation of the form , in any coordinate frame , @xmath125 where @xmath126 is a function of the @xmath127 , the @xmath128 and their partial derivatives .",
    "if this is going to sit nicely with our algorithm given above then we will need to show , in the riemann normal frame , that this equation only contains connection terms of the form @xmath129 .",
    "fortunately this is rather easy to do .",
    "each term of the form @xmath130 in @xmath131 arose during one round of covariant differentiation .",
    "thus _ at least one _ of the indices @xmath132 and _ all _ of the indices in @xmath133 must be drawn from the index list @xmath116 .",
    "if both @xmath134 and @xmath135 are contained in @xmath116 then the term is of the form @xmath136 and thus will vanish when we specialise to the riemann normal frame .",
    "this completes the proof .",
    "if we re - arrange the above equation into the following form @xmath137 we can use it to recursively compute all of the partial derivatives of the curvatures in terms of their covariant derivatives .",
    "the @xmath126 will contain lower order derivatives of the curvatures and partial derivatives of the connection all of which can be eliminated ( in favour of covariant derivatives ) using previously computed results .",
    "for the first two derivatives we find that the partial and covariant derivatives are equal but differences do appear in higher order derivatives .",
    "more details will be given in a later section .",
    "these calculations , as simple as they may appear , are exceedingly tedious to do except for the first few terms .",
    "the recursive nature of the calculations requires frequent substitution of one result into another which causes an explosion in the number of terms that must be handled .",
    "not only is this tedious but its is also extremely prone to human error .",
    "calculations of this kind are clearly best left to a computer .",
    "we shall return to this point later on .",
    "most of the hard work is now behind us and we can now develop algorithms for riemann normal expansions for other interesting quantities , in this instance the inverse metric @xmath138 . in the previous section we used @xmath139 as our starting point . on this occasion",
    "we start with @xmath140 .",
    "then , following a path similar to that used in the previous section , we arrive at the following equations @xmath141 \\label{invmetricgamma } g^{ab}{}_{,c\\ud } = - \\left(g^{ae}\\gamma^{b}{}_{e(c}\\right){}_{\\!,\\ud ) }                     - \\left(g^{eb}\\gamma^{a}{}_{e(c}\\right){}_{\\!,\\ud)}\\\\[10pt ] ( n+3)\\gamma^a{}_{d(b , c\\ue ) } =           ( n+1)\\left ( r^a{}_{(bc\\dot d,\\ue ) }                      - \\left(\\gamma^a{}_{i(c}\\gamma^i{}_{b{\\dot d}}\\right){}_{\\!,\\ue ) }                \\right)\\tag{\\ref{gammariemann}}\\end{gathered}\\ ] ] these equations can be used to construct the series expansion for @xmath138 , which to @xmath124 is    g^ab(x)=g^a b + x^c x^d r^a_c^b_d + x^c x^d x^e _",
    "in section [ subseccoordsivp ] we saw that the generalised connections @xmath142 arose from successive differentiation of the geodesic equation and that they can be computed recursively using @xmath143 where the index list @xmath79 contains @xmath80 indices , or directly using @xmath144 here are the first three generalised connections    = ^a_b c    = _ b^a_c d - 2 ^a_b e ^e_c d    = - ^f_b c _ f^a_d e - 4 ^f_b c _ d^a_e f + _ b c^a_d e + 2 ^a_f g ^f_b c ^g_d e + 4 ^a_b f ^f_c g ^g_d e - 2 ^a_b f _",
    "c^f_d e    and when we specialise to riemann normal coordinates we obtain    = x^d r^a_b d c + x^d x^e ( 2 _ br^a_d e c + 4 _ dr^a_b e c + ^ar_d b e c)+    = x^e _ br^a_c e d+    =",
    "when first we spoke of riemann normal coordinates we restricted our attention to the geodesics that passed through the point @xmath0 .",
    "now we wish to be somewhat less restrictive .",
    "we would like to know how to construct any geodesic in the neighbourhood of @xmath0 . here",
    "we will once again be building solutions of the geodesic equations and as before we will consider two separate cases , first , the geodesic initial value problem and second , the geodesic boundary value problems .",
    "most of the machinery that we need to tackle these questions has already been developed . here",
    "we apply the formalism developed in sections [ subseccoordsivp ] and [ subseccoordsbvp ] to the metric in riemann normal form as obtained in section [ secmetricrnc ] .",
    "consider a point @xmath1 distinct from @xmath0 . at @xmath1",
    "we can assume that the generalised connections do not vanish ( which is generally true , the exception being flat space ) .",
    "thus the coordinates @xmath8 in the neighbourhood of @xmath1 do not constitute a riemann normal frame relative to @xmath1 . but as @xmath1 lies in the patch for @xmath0 we know that the metric is non - singular at @xmath1 and thus we should be able to construct a new set of riemann normal coordinates , @xmath17 , with @xmath1 as the origin .",
    "we have seen this problem once before , in section [ subseccoordsbvp ] . using equation and the generalised connections from section [ secgengamma ] we find    x^a(s)=x^a + s ^a - s^2 ^b ^c ( 8 x^d r^a_b d c + 2 x^d x^e _ br^a_d e c + 4 x^d x^e _ dr^a_b e c + x^d x^e ^ar_d b e c ) - s^3 ^b ^c ^d x^e _",
    "br^a_c e d+      consider now the case where we have three distinct points @xmath0 , @xmath1 and @xmath131 . in this section",
    "we seek to compute the geodesic that passes through @xmath1 and @xmath131 .",
    "we use the equation of the generalised connections from section [ secgengamma ] to obtain    x^a(s ) = x^a + s x_1^a + s^2 x_2^a + s^3 x_3^a +    x_1^a(s)=^a + x^b ^c ^d r^a_c b d + x^b x^c ^d ^e _ dr^a_b c",
    "e + x^b x^c ^d ^e _ br^a_d c e + x^b x^c ^d ^e ^ar_b d c e + x^b ^c ^d ^e _ cr^a_d b e    x_2^a(s)= - x^b ^c ^d r^a_c b d - x^b x^c ^d ^e _ dr^a_b c e - x^b x^c ^d ^e _ br^a_d c e - x^b x^c ^d ^e ^ar_b d c e    x_3^a(s)= ( ) x^b ^c ^d ^e _ cr^a_d b e",
    "since we now have explicit expressions for the metric and the geodesic that joins the points @xmath1 and @xmath131 we can compute the length of that geodesic by way of the integral @xmath145 we have , to this point , taken @xmath3 to be the proper distance along the geodesic .",
    "however , after careful inspection of the geodesic path we see that any uniform scaling of @xmath3 is allowed .",
    "thus we can re - scale @xmath3 so that @xmath39 at @xmath1 and @xmath146 at @xmath131 ( of course , the parameter @xmath3 no longer measures proper distance ) .",
    "furthermore we know that the integrand is constant along the geodesic and can thus be evaluated at any point which we shall chose to be @xmath1 .",
    "thus the integral is trivial and we have @xmath147 using our previous results we obtain    l^2_pq = g_a b ^a ^b - x^a x^b ^c ^d r_a c b d - x^a x^b ^c ^d ^e _ cr_a d b e - x^a x^b x^c ^d ^e _ ar_b d c e+",
    "no matter how determined one might be , the recursive nature of the preceding equations will wreak havoc with one s sanity should one dare to venture beyond the first few terms . for the good of all concerned it is far better to leave such calculations to computer programs such as cadabra . in this section",
    "we discuss some particular issues we encountered when writing our cadabra programs .",
    "the examples given in the previous paper @xcite actually arose from our earlier investigations of cadabra as a tool to compute riemann normal expansions .",
    "thus it is no surprise that the techniques given in that paper are well suited to ( most of ) our current needs but with two exceptions .",
    "first , we need to develop cadabra code for the truncation operator @xmath61 introduced in section ( [ subseccoordsbvp ] ) .",
    "second , we need to extend the ideas given in @xcite to allow cadabra to compute the symmetrised derivatives of arbitrary tensors , such as @xmath148 . we shall deal with these issues in the following sections after which we will present the final cadabra generated expressions ( to @xmath149 and in all their gory detail ) .      in section ( [ subseccoordsbvp ] )",
    "we introduced a truncation operator @xmath61 . here",
    "we discuss how we constructed that operator in our cadabra code .",
    "it happens to be an extremely useful piece of code and is used extensively throughout our cadabra code .",
    "suppose you are asked to extract the leading terms from an expression such as @xmath150 a standard approach would be to compute the derivatives of @xmath151 at @xmath152",
    ". this approach would be rather simple to code in cadabra .",
    "however a minor issue does pop up .",
    "unless otherwise told , cadabra will assume that all objects have non - zero derivatives .",
    "thus if cadabra were instructed to compute @xmath153 of the above expression it would dutifully do so but it would treat the @xmath25 s and the coefficients @xmath154 as possibly depending on @xmath3 .",
    "cadabra can be coaxed to restrict the derivative operators to act only on specific objects by using the ` : : depends ` property and the ` @unwrap ` algorithm .    a better solution , one that does not involve derivatives , is to use cadabra s ` : : weight ` property and the ` @keep_weight ` algorithm .",
    "the idea is to assign weights to nominated objects ( through the ` : : weight ` property ) and then extract terms matching a chosen weight ( using the ` @keep_weight ` algorithm ) .",
    "here is a small piece of cadabra code that does the job .",
    "x^a::weight(label = xterms , value=1 ) .",
    "poly:= c^a + c^a_b x^b + c^a_b c",
    "x^b x^c + c^a_b c d x^b x^c x^d ;    term00:=@(poly ) : @keep_weight!(term00)xterms0 ; term01:=@(poly ) : @keep_weight!(term01)xterms1 ; term02:=@(poly ) : @keep_weight!(term02)xterms2 ;    the first line identifies the @xmath8 terms as our target ( which we name as ` xterms ` so that they can be distinguished from other targets decalared by other instances of ` : : weight ` ) .",
    "the next three lines then extract the @xmath155 , @xmath156 and @xmath157 terms in the expression ` poly `",
    ". the result would be exactly as if we had written    term00:=c^a ; term01:=c^a_b x^b ; term02:=c^a_b c x^b x^c ;    the truncated polynomial ( in this case a quadratic ) could then be computed simply as ` @(term00)+@(term01)+@(term02 ) ` .",
    "let @xmath158 be a tensor field and suppose we wish to compute @xmath159 at the origin of the riemann normal frame , @xmath0 .",
    "construct any geodesic through @xmath1 and an auxiliary field @xmath160 throughout the patch containing @xmath0 .",
    "let the geodesic be parametrised by the proper distance @xmath3 and described by @xmath161 with unit tangent vector @xmath162 .",
    "we choose @xmath160 so that it is auto - parallel along the geodesic",
    ". thus we have    7pt @xmath163    from which it follows that @xmath164 where @xmath165 contains @xmath103 indices .",
    "thus any higher order covariant derivative can be obtained simply by expanding the right hand side , one derivative at a time , while using the parallel transport conditions listed above to eliminate derivatives in @xmath166 and @xmath167 .",
    "the cadabra code for this is much the same .",
    "each successive covariant derivative is obtained by applying @xmath153 to the previous result then using substitutions to eliminate the newly introduced derivatives of @xmath166 and @xmath167 . comparing coefficients of @xmath168 across the equals sign",
    "will then reveal an expression for @xmath169 , the fully symetrised covariant derivative of @xmath158 at @xmath0 .",
    "note that @xmath170 at @xmath0 in riemann normal coordinates and thus @xmath171 .",
    "this can be used to considerably simplify the above computations .",
    "this idea can be easily extended to other cases .",
    "for example , suppose we require @xmath172 at @xmath0 .",
    "in this case we would introduce two auxiliary fields , @xmath160 and @xmath173 , each constrained to be auto - parallel along the chosen geodesic . then following the above procedure we obtain @xmath174      by inspection of equation we see that the only derivatives of the riemann tensor that enter our calculations are of the form @xmath175 and @xmath176 . according to the prescription given above",
    "we can compute the covariant derivatives in terms of the partial derivatives by the following procedure .",
    "7pt @xmath177    this is not exactly what we want  it yields the _ covariant _ derivatives in terms of the _ partial _ derivatives .",
    "we need instead , the _ partial _ derivatives expressed in terms of the _ covariant _ derivatives . in section [ secmetricrnc ] we provided one solution to this problem .",
    "there we argued that the equations could be re - written in the form @xmath178 where @xmath126 contains all the lower order symmetrised partial derivatives of @xmath128 .",
    "this algorithm certainly works but it is computationally expensive .",
    "if for the moment we label the equation for the @xmath103-th derivative as @xmath179 then our algorithm entails a whole hierarchy of substitutions of @xmath180 into @xmath181 for @xmath182 .",
    "for example , to compute @xmath183 we need to substitute @xmath184 into @xmath185 , then @xmath184 and @xmath185 into @xmath186 , and finally , @xmath187 and @xmath186 into @xmath183 .",
    "our code took about 4 seconds to compute the first four derivatives but with one extra derivative this time grew to 11 minutes .",
    "we did not bother to compute the sixth derivative ( in fact for the results given here we only need the first three derivatives ) .",
    "it seems reasonable to ask : is there a better way ?",
    "indeed there is and the changes required are very simple .",
    "the auxiliary field @xmath188 can be freely chosen so there is nothing stopping us from setting @xmath188 to be constant throughout the neighbourhood of @xmath0 .",
    "thus every partial derivative of @xmath188 is zero at @xmath0 .",
    "what use is this to us ? consider the equation @xmath189 this is clearly true for any @xmath188 and @xmath190 ( and in any coordinate frame ) . in our riemann",
    "normal frame we have @xmath191 and we have chosen @xmath192 . thus the right hand side can be reduced to @xmath193 .",
    "this leads to the following modified scheme ( after swapping the left and right hand sides )    7pt @xmath194    this algorithm computes all the partial derivatives directly , without requiring any substitutions from previous results .",
    "it took less than 10 seconds to compute the first five derivatives which is a dramatic improvement over our previous algorithm ( 11 minutes ) .    in our cadabra code",
    "we compute all of the symmetrised partial derivatives ( using the above algorithm ) before we compute the metric expansion ( equations ( [ metrictaylor ] , [ metricgamma ] , [ gammariemann ] ) ) . in this way",
    "we obtain a series expansions for the metric in terms of the covariant derivatives of the curvatures .",
    "all of our @xmath149 cadabra programs were not overly demanding on computational resources , taking less than 2 minutes to run ( on a macosx with an intel cpu ) and requiring less than 13 mbyte of memory .",
    "the cadabra codes and several support scripts are available from the author s web site http://users.monash.edu.au/~leo .",
    "# 11.5 - 1.5    180g_ab(x)=180 g_a b - 60 x^c x^d r_a c b d - 30 x^c x^d x^e _",
    "cr_a d b e + 8 x^c x^d x^e x^f r_a c g d r_b e g f - 9 x^c x^d x^e x^f _",
    "c dr_a e b f + 4 x^c x^d x^e x^f x^g r_a c h d _ er_b f h g + 4 x^c x^d x^e x^f x^g r_b",
    "er_a f h g - 2 x^c x^d x^e x^f x^g _ c d er_a f b",
    "g+    180g^ab(x)=180 g^a b + 60 x^c x^d r^a_c^b_d + 30 x^c x^d x^e _",
    "cr^a_d^b_e + 12 x^c x^d x^e x^f r^a_c d g r^b_e f g + 9 x^c x^d x^e x^f _ c",
    "dr^a_e^b_f + 6 x^c x^d x^e x^f x^g r^a_c d h _",
    "er^b_f g h + 6 x^c",
    "x^d x^e x^f x^g r^b_c d h _",
    "er^a_f g h + 2 x^c x^d x^e x^f x^g _ c d er^a_f^b_g+    180=120 x^d r^a_b d c + 15 x^d x^e ( 2 _ br^a_d e c + 4 _ dr^a_b e c + ^ar_d b e c ) + x^d x^e x^f ( 32 r^a_d e g r_f b c g - 16 r^a_b d g r_e c f g - 8 r^a_d b g r_e c f g + 18 _ d br^a_e f c + 18 _ d er^a_b f c - 8 r^a_g d b r_e c f g + 9 ^a_dr_e b f c ) + x^d x^e x^f x^g ( 16 r_d b c h _ er^a_f g h + 6 r^a_d e h _ br_f c g h + 16 r^a_d e h _",
    "fr_g b c h - 8 r^a_b d h _ er_f c g h - 4 r^a_d b h _ er_f c g h - 4 r_d b e h _ cr^a_f g h - 8 r_d b e h _ fr^a_c g h - 4 r_d b e h _ fr^a_g c h + 6 _ d e br^a_f g c + 4 _ d e fr^a_b g c - 5 r^a_d e h _",
    "b g c - 4 r^a_h d b _",
    "er_f c g h - 4 r_d b e h ^ar_f c g h - 4 r_d b e h _ fr^a_h g c + 3 ^a_d er_f b g c)+    180=90 x^e _ br^a_c e d + 3 x^e x^f ( 8 r^a_e b g r_f c d g + 32 r^a_b e g r_f c d g - 8 r^a_b c g r_e d f g + 18 _ e br^a_c f d + 6 _ b cr^a_e f d + 24 r^a_g e b r_f c d g + 3 ^a_br_e c f d ) + 10 x^e x^f x^g ( 2 r_e b c h _",
    "dr^a_f g h + 2 r_e b c h _",
    "hr^a_f g d + 4 r_e b c h _",
    "fr^a_d g h + 4 r_e b c h _ fr^a_h g d + 2 r_e b c h",
    "^ar_f d g h + 2 r^a_b e h _ cr_f d g h + 4 r^a_b e h _ fr_g c d h - r^a_b e h _ hr_f c g d + 2 r^a_h e b _",
    "cr_f d g h + 4 r^a_h e b _",
    "fr_g c d h - r^a_h e b _",
    "c g d)+    18=8 x^f r^a_b c g r_f d e g + x^f x^g ( 2 r^a_b c h _ dr_f e g h + 4 r^a_b c h _ fr_g d e h - r^a_b c h _ hr_f d g e + 2 r_f b c h _ dr^a_g e h + 10 r_f b c h _",
    "dr^a_h g e + 4 r_f b c h _",
    "gr^a_d e h + 8 r_f b c h _ hr^a_d g",
    "e + 2 r_f b c h ^ar_g d e h + 12 r_f b c h _",
    "dr^a_e g h + 6 r^a_b f h _",
    "cr_g d e h + 6 r^a_h f b _",
    "cr_g d e h)+    3=x^g ( 2 r^a_b c h _ dr_g e f h + 3 r_g b c h _ dr^a_e f h)+    =    r^u_(bcv , a)=_ar^u_b c v    r^u_(cdv , ab)=_a br^u_c d v    2 r^u_(dev , abc)=2 _ a b cr^u_d e v - r_v a b f _ cr^u_d e f + r^u_a b f _ cr_v d e f    5 r^u_(efv , abcd)=5 _ a b c dr^u_e f v - 7 r_v a b g _ c dr^u_e f g + 7 r^u_a b g _",
    "c dr_v e f g    y^a= x^a + y^a_bcx^bx^c + y^a_bcdx^bx^cx^d + y^a_bcdex^bx^cx^dx^e + y^a_bcdefx^bx^cx^dx^ex^f +    2y^a_bc=^a_b c    6y^a_bcd=^a_b e ^e_c",
    "d + _ b^a_c d    24y^a_bcde=2 ^a_b f _",
    "c^f_d e + ^a_f g ^f_b c ^g_d e + ^f_b c _ f^a_d e + _ b c^a_d e    360y^a_bcdef= - 4 ^a_b g ^g_c h ^h_d",
    "i ^i_e f + 2 ^a_b g ^g_c h _",
    "d^h_e f + 3 ^a_b g ^g_h i ^h_c d ^i_e f + 6 ^a_b g ^h_c d _",
    "h^g_e f - 6 ^a_b g ^h_c d _ e^g_f h + 9 ^a_b g _",
    "c d^g_e f + 4 ^a_g h ^g_b c ^h_d i ^i_e f + 13 ^a_g h ^g_b c _ d^h_e f + ^g_b c ^h_d g _",
    "h^a_e f - 4 ^g_b c ^h_d g _ e^a_f h + 7 _ g^a_b c _ d^g_e f + 2 _ b^a_c g _",
    "d^g_e f + 3 ^g_b c ^h_d e _",
    "g^a_f h + 3 ^g_b c ^h_d e _",
    "f^a_g h + 6 ^g_b c _ d g^a_e f - 3 ^g_b c _ d e^a_f g + 3 _ b c d^a_e f    360y^a_bc=120 x^d r^a_b d c + 15 x^d x^e ( 2 _ br^a_d e c + 4 _ dr^a_b e c + ^ar_d b e c ) + x^d x^e x^f ( 32 r^a_d g e r_g b f c - 16 r^a_b g d r_g e f c - 8 r^a_d g b r_g e f c + 18 _ d br^a_e f c + 18 _ d er^a_b",
    "f c + 8 r^a_g d b r_g e f c + 9 ^a_dr_e b f c ) + x^d x^e x^f x^g ( 16 r_h b d c _ er^a_f h g + 6 r^a_d h e _",
    "br_h f g c + 16 r^a_d h e _",
    "fr_h b g c - 8 r^a_b h d _",
    "er_h f g c - 4 r^a_d h b _",
    "g c - 4 r_h d e b _",
    "cr^a_f h g - 8 r_h d e b _",
    "fr^a_c h g - 4 r_h d e b _",
    "fr^a_g h c + 6 _ d e br^a_f g c + 4 _ d e fr^a_b g c + 5 r^a_d h e _",
    "b g c + 4 r^a_h d b _",
    "er_h f g c - 4 r_h d e b ^ar_h f g c + 4 r_h d e b _",
    "fr^a_h g c + 3 ^a_d er_f b g c )    1080y^a_bcd=90 x^e _ br^a_c e d + 3 x^e x^f ( 8 r^a_e g b r_g c f d + 32 r^a_b g e r_g c f d - 8 r^a_b g c r_g e f d + 18 _ e br^a_c f d + 6 _ b cr^a_e f d + 56 r^a_g e b r_g c f d + 3 ^a_br_e c f d ) + 10 x^e x^f x^g ( 2 r_h b e c _ dr^a_f h g + 4 r_h b e c _ hr^a_f g d + 4 r_h b e c _ fr^a_d h g + 8 r_h b e c _",
    "fr^a_h g d - r_h b e c ^ar_h",
    "f g d + 2 r^a_b h e _ cr_h f g d + 4 r^a_b h e _ fr_h c g d + r^a_b h e _ hr_f c g d + 4 r^a_h e b _ cr_h f g d + 8 r^a_h e b _ fr_h c g d + 2 r^a_h e b _ hr_f c g d )    432y^a_bcde=8 x^f r^a_b g c r_g d f e + x^f x^g ( 2 r^a_b h c _ dr_h f g e + 4 r^a_b h c _ fr_h d g e + r^a_b h c _ hr_f d g e + 2 r_h b f c _ dr^a_g h e - 10 r_h b f c _ dr^a_h g e + 4 r_h b f c _ gr^a_d h e + 28 r_h b f c _ hr^a_d g e + 2 r_h b f c ^ar_h d g e + 12 r_h b f c _ dr^a_e h g + 6 r^a_b h f _ cr_h d g e + 18 r^a_h f b _ cr_h d g e )    360y^a_bcdef = x^g ( 2 r^a_b h c _ dr_h e g f + 3 r_h b g c _ dr^a_e h",
    "f )    l^2_pq = f_abx^ax^b + f_abcx^ax^bx^c + f_abcdx^ax^bx^cx^d + f_abcdex^ax^bx^cx^dx^e + [ geodesiclsq ]    180f_ab=180 g_a b - 60 x^c x^d r_c a d b - 30 x^c x^d x^e _ cr_d a e b + x^c x^d x^e x^f ( 8 r_g c d a r_g e f b - 9 _ c dr_e a f b ) + 2 x^c x^d x^e x^f x^g ( 4 r_h c d a _ er_h f",
    "g b - _ c d er_f a g b )    180f_abc= - 15 x^d x^e _ ar_d b e c + x^d x^e x^f ( 8 r_g d e a r_g b f c - 9 _ d ar_e b f c ) + x^d x^e x^f x^g ( 4 r_h a d b _ er_h f g c + 4 r_h d e a _ br_h f g c + 4 r_h d e a _ fr_h b g c - 3 _ d e ar_f b g c )    540f_abcd= - 3 x^e x^f ( 44 r_g a e b r_g c f d + 3 _ a br_e c f d ) - 5 x^e x^f x^g ( 8 r_h a e b _",
    "cr_h f g d + 9 r_h a e b _",
    "hr_f c g d + 20 r_h a e b _",
    "fr_h c g d - 6 r_h e f a _ br_h c g d )    54f_abcde = x^f x^g r_h a f b _",
    "the value of any new computational tool comes not just in being able to do routine computations , computations that we could do by hand , but rather in giving us the option to perform computations we would not otherwise undertake .",
    "new tools should open new opportunities for research .",
    "cadabra seems to be such a tool .",
    "a .tar.gz archive of the cadabra files used in preparing this paper can be found at this url http://users.monash.edu.au/~leo/research/papers/files/lcb09-03.html",
    "i am very grateful to kasper peeters for his many helpful suggestions .",
    "any errors , omissions or inaccuracies in regard to cadabra are entirely my fault .",
    "the totally symmetric part of a tensor @xmath195 is commonly defined by @xmath196 where the sum on the right hand side includes every permutation of the indices of @xmath76 .",
    "if the tensor @xmath195 happens to be symmetric in every pair of indices then we observe @xmath197 from the above definition it is very easy to establish the following theorems @xmath198 a_{(i_1i_2i_3\\cdots i_n}b_{j_1j_2j_3\\cdots j_m ) }   = a_{((i_1i_2i_3\\cdots i_n)}b_{(j_1j_2j_3\\cdots j_m))}\\\\[5pt ] na_{(i_1i_2i_3i_4\\cdots i_n ) } = a_{i_1(i_2i_3i_4\\cdots i_n ) }                          + a_{i_2(i_1i_3i_4\\cdots i_n ) }                          + a_{i_3(i_1i_2i_4\\cdots i_n ) }                          + \\cdots\\notag\\\\[5pt ]                          { \\hskip 0.7\\textwidth } + a_{i_n(i_1i_2i_3\\cdots i_{n-1})}\\\\[5pt ] na_{(i_1i_2i_3i_4\\cdots i_n ) } = a_{(i_2i_3i_4\\cdots i_n)i_1 }                          + a_{(i_1i_3i_4\\cdots i_n)i_2 }                          + a_{(i_1i_2i_4\\cdots i_n)i_3 }                          + \\cdots\\notag\\\\[5pt ]                          { \\hskip 0.7\\textwidth } + a_{(i_1i_2i_3\\cdots i_{n-1})i_n}\\end{gathered}\\ ] ]    suppose now that we have @xmath199 , that is , @xmath195 is totally symmetric .",
    "then for any @xmath200 we have @xmath201 & \\quad+ \\cdots + a_{i_1i_2i_3\\cdots i_{n-1}j } b_{i_n } \\end{split}\\\\[5pt ] \\intertext{and } \\begin{split } ( n+1 ) a_{(i_1i_2i_3\\cdots i_n , j ) } & = a_{ji_2i_3\\cdots i_n , i_1 } + a_{i_1ji_3\\cdots i_n , i_2 } + a_{i_1i_2j\\cdots i_n , i_3}\\\\[5pt ] & \\quad+\\cdots + a_{i_1i_2i_3\\cdots i_{n-1}j , i_n } + a_{i_1i_2i_3\\cdots i_n , j } \\end{split}\\end{gathered}\\ ] ]      suppose @xmath202 is symmetric in the pair @xmath203 and symmetric in all the indices @xmath204 .",
    "that is , it is symmetric under the interchange of any pair of @xmath205 s and any pair of @xmath206 s but it is _ not _ necessarily symmetric when any @xmath205 is swapped with any @xmath206 .",
    "what can we say about @xmath207 ? here is the result @xmath208 the proof is very easy .",
    "begin by writing out @xmath209 in full .",
    "then partition the terms into two disjoint sets , one set in which @xmath210 appears in one of the first two index slots , the other set in which @xmath210 appears in any of the remaining @xmath211 slots .",
    "the terms in the first set are exactly those that define @xmath212 while those in the second set define @xmath213 .",
    "the above equation follows by simply counting the number of terms in each set ( @xmath214 and @xmath215 respectively ) and the simple observation that @xmath209 equals the sum of the terms from both sets ."
  ],
  "abstract_text": [
    "<S> we present the results of using the computer algebra program cadabra to develop riemann normal coordinate expansions of the metric and other geometrical quantities , in particular the geodesic arc - length . </S>",
    "<S> all of the results are given to sixth - order in the curvature tensor . </S>"
  ]
}