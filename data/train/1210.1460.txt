{
  "article_text": [
    "this study was initiated by the need to analyze real world data collected in the rural town of chanute , kansas .",
    "the goal was to study and simulate potential epidemic outbreaks . from the survey ,",
    "a contact network was constructed representing the sampled population and their potential relationships .",
    "mathematically , this is just a graph where the vertices represent people and the edges represent possible interactions . in this paper",
    ", we introduce a new geometric quantity , the epidemic quasimetric , which we study and relate to more classical quantities , such as effective resistance .",
    "one of the simplest geometric object that is used to study finite graphs is the `` graph metric '' .",
    "namely , the graph metric measures the distance between two nodes @xmath0 and @xmath1 by computing the minimal number of edges that must be traversed ( ` hops ' ) to go from @xmath0 to @xmath1 .",
    "epidemics , on the other hand , can be modeled to begin at one node , then spread to all the neighbors , and then to all the neighbors neighbors , etc ... the possible damage of the epidemic spreads as a circular wave .",
    "we use this dynamic to assign to every pair of nodes of a finite graph a number , which we call the``epidemic quasimetric '' . to compute the epidemic quasimetric between @xmath0 and @xmath1",
    "we expand the range of an epidemic started at @xmath0 until @xmath1 is affected and compute the number of edges that became involved in the process .",
    "then we do the same interchanging @xmath0 and @xmath1 , and we add the two numbers thus obtained .",
    "this is fairly easy to compute numerically and we describe the routine we implemented in matlab in section [ sec : epidd ] .",
    "part of the inspiration for considering the epidemic quasimetric came from reading @xcite where a similar quantity is introduced in order to study bi - lipschitz embeddings of metric spaces .",
    "the hope is that the epidemic quasimetric contains geometric information that allows to view the graph under a new light . to partially confirm this intuition , we experimented with the epidemic quasimetric and showed how it can be used to obtain a pretty accurate cut of the famous karate club graph into `` natural '' communities , see section [ sec : numerical ] . in this direction , aside for clustering techniques , the epidemic quasimetric could be also be useful in sparsification techniques .",
    "our second goal is to compare the notion of epidemic quasimetric to the more classical notion of effective conductance , when the graph is viewed as an electrical network .",
    "effective conductance has also been used in the literature to study graphs from the point of view of community detection and sparsification .",
    "therefore , such a comparison gives us hope that the epidemic quasimetric can also be used effectively to study graphs while being relatively simple to compute numerically .",
    "the paper begins with some preliminaries and notations about graphs ; then in section [ sec : epidd ] we define the epidemic quasimetric and state our goal to relate it to effective resistance .",
    "thereafter we review the theory of random walks on finite graphs in section [ sec : markov ] , its connection to electrical networks , and the notion of effective conductance in section [ sec : electrical ] .",
    "some references for these sections are @xcite , @xcite , and @xcite .",
    "then , in section [ sec : capmod ] , we introduce two more concepts drawn from modern geometric function theory . namely the notions of capacity and modulus of families of curves , see @xcite . in theorem",
    "[ thm : modcap ] we show that all of these concepts coincide with the notion of effective conductance ( the method of lagrange multipliers turned out to be useful in this context ) .",
    "moreover , in proposition [ prop : upperbound ] we exploit the definition of modulus to obtain a comparison between modulus and epidemic quasimetric .",
    "thus we get an estimate for the epidemic quasimetric in terms of effective conductance .",
    "finally , in section [ sec : numerical ] we describe our numerical computations and experiments .",
    "we begin with some preliminaries on elementary graph theory .",
    "we will restrict our study to simple , finite , connected graphs .",
    "let @xmath2 be a _ graph _ with vertex - set @xmath3 and edge - set @xmath4 .",
    "we say that @xmath5 is _ simple _ if there is at most one undirected edge between any two distinct vertices , and it is _ finite _ if the vertex set has cardinality @xmath6 . in this case , the edge - set @xmath4 can be thought of as a subset of @xmath7 , the set of all unordered pairs from @xmath3 . therefore the cardinality of @xmath4 is @xmath8 .",
    "we say that two vertices @xmath9 are _ neighbors _ and write @xmath10 if @xmath11 .",
    "the graph is _ connected _ if for any two vertices @xmath12 there is a chain of vertices @xmath13 , so that @xmath14 for @xmath15 .",
    "it is known that connected graphs must satisfy @xmath16 ( induction ) .",
    "given a subset of vertices @xmath17 , we let @xmath18 be all the edges of @xmath5 that connect pairs of vertices in @xmath19 . with this notation @xmath20",
    "is a simple graph which we call the _ subgraph induced by @xmath19_. more generally , a _ subgraph _ of @xmath5 is a graph @xmath21 such that @xmath17 and @xmath22 .    the number of edges that are incident at a vertex @xmath23 is called the _ degree _ of @xmath23 and we write @xmath24 .",
    "since every edge is incident at two distinct vertices , it contributes to two degrees .",
    "therefore @xmath25 this identity is sometimes referred to as the `` handshake lemma '' .",
    "it says that instead of counting edges , one can add degrees , i.e. , switch to @xmath24 which is a function defined on @xmath3 .",
    "for instance , _ the volume _ of a subgraph @xmath26 of @xmath5 can be defined as @xmath27 , i.e. , the number of edges of @xmath28 ; or as half the sum of the @xmath28-degrees over the vertices of @xmath28 : @xmath29    we say that @xmath30 is a _ curve _ in @xmath5 if @xmath30 is a connected subgraph of @xmath5 .",
    "this is not a very common way of defining curves in graph theory , but it makes sense from the point of view of the function - theory inspired concepts that we will introduce later when we talk about modulus of curve families .",
    "the graph @xmath5 is _ weighted _ if there is a weight function @xmath31 defined on the edges .",
    "the unweighted graph is recovered by setting @xmath32 , @xmath33 .    given a curve @xmath30 in @xmath5 ,",
    "it is natural to define its _ graph - length _ to be the total number of edges in @xmath30 , i.e. , @xmath34      a function of two variables @xmath35 on a space @xmath36 is called a _",
    "metric _ or a _ distance _ , if it is symmetric , @xmath37 ; non - degenerate , @xmath38 iff @xmath39 ; and satisfies the _ triangle inequality _",
    ", @xmath40 , whenever @xmath41 .    on a connected graph @xmath5",
    "the _ graph distance _",
    "@xmath42 is defined as the shortest graph - length of a curve connecting @xmath23 to @xmath43 .",
    "@xmath44 where @xmath45 means that @xmath30 is a curve connecting @xmath23 to @xmath43 .",
    "we leave the verification that @xmath46 is a metric to the reader .",
    "the _ diameter _ of the graph @xmath5 is @xmath47    the _ metric ball _ centered at a vertex @xmath23 and of radius @xmath48 is @xmath49",
    "given two nodes @xmath23 and @xmath43 , we define the epidemic quasimetric between them to be the size of the part of the graph that would be affected ( the potential damage ) if an epidemic started at @xmath23 and reached @xmath43 , or vice versa . in formulas ,",
    "we consider all the vertices in @xmath50 and form the induced subgraph of @xmath5 which we call @xmath51 .",
    "we then compute the volume @xmath52 as in section [ ssec : graphs ] , by counting the number of edges .",
    "so we define the _ epidemic quasimetric _ between @xmath23 and @xmath43 to be @xmath53    the epidemic quasimetric is not a distance in the mathematical sense .",
    "for instance , the triangle inequality can fail as badly as possible , as the following example shows .",
    "[ ex : trineq ] in figure [ fig : trineq ] , @xmath54 while @xmath55 so the triangle inequality in this case can be made to fail as badly as needed by letting @xmath56 increase .        as described in section [ sec : numerical ] , the epidemic quasimetric seems to carry useful geometric information about a graph and in our experiments it appears to behave well with respect to simple clustering algorithms . for the rest of the paper ,",
    "our intent is to present a comprehensive survey of effective resistance and to answer the following question .",
    "is there a connection between the epidemic quasimetric and effective resistance ?",
    "we begin in the next two sections by surveying markov chains and electrical networks .",
    "most of this material can be found in @xcite , @xcite , @xcite .",
    "a markov chain is comprised of a finite set @xmath57 ( the state space ) and a probability distribution on the state space which can be represented in terms of a _ transition matrix _",
    "@xmath58 whose entries correspond to the probability of being at state @xmath59 at time @xmath60 given that you were at state @xmath61 at time @xmath62 .",
    "@xmath63 being a transition matrix means that we must have @xmath64 ( row sums add up to @xmath65 . )    this determines a process , i.e. , a sequence of random variables @xmath66 , with the property that @xmath67 .",
    "note that @xmath68 is independent of @xmath62 .",
    "given @xmath56 states , @xmath69 is an @xmath70 matrix . here",
    "@xmath71 vectors correspond to functions @xmath72 on the state space .",
    "then @xmath63 acts on functions as follows : @xmath73 probabilistically , @xmath74 which is the average or expected value of @xmath75 evaluated on the process at time 1 .    on a graph : @xmath76 so @xmath77 is obtained from @xmath75 by defining @xmath78 to be the average of the values of @xmath75 over all the neighbors of node @xmath23 .    for @xmath79 , we can condition on the first step ; this is known as `` first - step analysis '' . for brevity",
    "we write @xmath80 : @xmath81 since @xmath82 if @xmath83 or @xmath84 , and @xmath85 otherwise .",
    "the function @xmath86 is thus harmonic for @xmath63 at each interior point .",
    "also @xmath86 has boundary values @xmath87 and @xmath88 .",
    "[ fact : maxpr ] a harmonic function achieves its maximum value @xmath89 and minimum value @xmath90 on the boundary .",
    "idea : suppose @xmath75 attains its maximum at an interior point",
    ". by harmonicity it must attain it at each neighboring vertex too and this will propagate out as an oil spill all the way to the boundary .    [",
    "cl : uniq]the problem of finding a harmonic function @xmath86 on @xmath91 with boundary values @xmath87 and @xmath88 has a unique solution .",
    "suppose that @xmath86 and @xmath77 are both harmonic at each interior point and that @xmath92 let @xmath93 .",
    "then , by linearity , we have that @xmath94 with @xmath95 and @xmath96 we get that @xmath97 and @xmath98 and the maximum principle implies that @xmath99 or @xmath100    [ rem : dp ] the example of gambler s ruin above is part of a larger set of problems . given a subset @xmath101 of nodes that we will call `` boundary '' and a function @xmath102 defined only on @xmath101 , it is always possible to extend this function on the remaining nodes ( the _ interior points _ ) so that the extension @xmath86 is harmonic on the interior points .",
    "claim [ cl : uniq ] , shows that if a solution exists it is unique .",
    "however , the existence is obtained by writing down a solution explicitly . for this",
    "we must introduce the notion of _ stopping times_. given a walker starting at some interior node @xmath23 the stopping time @xmath103 is the first time the walker visits a node in @xmath101 . since the walk is a random process , stopping times are random variables .",
    "the solution to the boundary - value ( or dirichlet ) problem is @xmath104 namely , the expected value of @xmath102 evaluated at the exit point of a walk started at @xmath23 .      on a finite graph a random walker either runs until it hits a given set of boundary points , as in the gambler s ruin example , or it bounces around forever . in the latter case , we can ask what fraction of time does it spend at a node @xmath23 ?    intuitively we want to define @xmath105 to be the _ stable distribution _ if @xmath106 and @xmath107 denotes the probability of finding the random walker at @xmath23 in the long run .",
    "this however already implies that the long run stabilizes .",
    "let @xmath108 denote the initial distribution for @xmath109 and similarily @xmath110 the distribution of @xmath111 , after one step. then , conditioning on the previous location we get : @xmath112    if we think of @xmath113 as a row vector then we can rewrite this in matrix multiplication form as @xmath114 , @xmath115 ,  .",
    "the entries of @xmath116 will be of the form @xmath117    in general , we have that @xmath118 , where @xmath119 is the @xmath62th - power of the matrix @xmath63 .",
    "if , as @xmath62 goes to infinity , @xmath120 , then @xmath105 is a unique fixed - point for @xmath63 . that s because for large @xmath62 @xmath121 we say that @xmath105 is a _ stable distribution _ for @xmath63 if @xmath122 .    for a markov chain on a finite state space",
    "there are very mild conditions ( irreducibility and aperiodicity ) that guarantee the existence and uniqueness of a stable distribution @xmath105 , as well as the convergence @xmath123 independently of @xmath124 . in such cases , @xmath125 at every @xmath126 and",
    "@xmath127 equals the expected return time to @xmath23 ( in formulas @xmath128 ) .",
    "namely , @xmath105 is inversely proportional to the average amount of time it takes for the random walker to find its way back to the starting node .",
    "the easier it is to come back , the larger @xmath105 is , and the larger the proportion of time the random walker spends at @xmath23 in the long run .",
    "the chains we will use in the sequel will have one extra property : reversibility .    if @xmath63 is reversible , then the distribution @xmath105 is stable , as the following shows : @xmath129    the reversibility condition is very closely related to the notion of `` symmetric '' or `` self - adjoint '' matrices .",
    "in fact , if we let @xmath130 , then ( [ eq : reverse ] ) is @xmath131 . in matrix notation @xmath132 , where @xmath133 is a diagonal matrix with entries @xmath107 .",
    "so standard results in linear algebra tell us that @xmath134 and thus @xmath63 , are linearizable to a diagonal matrix of real eigenvalues .",
    "moreover , the action of @xmath63 on row vectors is the action of the adjoint ( or transpose ) @xmath135 on column vectors and @xmath135 shares the same eingenvalues as @xmath63 and @xmath134 .",
    "the difference lies in the eigenvectors ( or eigenfunctions ) , but there are simple formulas involving @xmath105 to go from one set to the other .",
    "the fact that the rows of @xmath63 sum to @xmath65 implies that the eigenvalues of @xmath63 are between @xmath136 and @xmath65 . to see this note that @xmath137 suppose that @xmath138 . then , @xmath139 for all @xmath23 s .",
    "hence , @xmath140 .    finally , the fact that the rows of @xmath63 sum to one also imply straightforwardly that @xmath65 is an eigenvalue of @xmath63 for constant eigenvectors .",
    "let @xmath141 be a weighted graph .",
    "the degree of a vertex is usually the number of neighbors of @xmath23 , but for a weighted graph it can also be defined as @xmath142 then a ( weighted ) random walk on @xmath5 is defined to be the markov chain with state space @xmath3 and transition matrix @xmath143 in this situation the probability distribution defined at each @xmath144 by : @xmath145 will satisfy @xmath146 in particular , @xmath63 is reversible in this case .",
    "it is often useful when studying graphs and random walks on graphs to think of them as electrical networks .",
    "each edge @xmath147 then acquires a weight @xmath148 which in this instance plays the role of _",
    "one recalls from high school physics that the electrical current @xmath91 through a connection is related to the potential difference @xmath3 via the formula @xmath149 where @xmath150 is the _ resistance _ and @xmath151 the conductance .",
    "if instead of a simple connection one is looking at a series of connections then simple rules allow one to say that the system behaves as if there was only one connection but with an appropriately modified resistance .",
    "this `` virtual '' resistance is what we call the effective resistance between two nodes .      in order to make this more precise",
    "we need to introduce some notation . given two nodes @xmath0 and @xmath1 we consider a unit current that is allowed to pass through a connected graph with the source at @xmath152 and the sink at @xmath153 . in order to effect this passage",
    "a certain voltage difference must be applied at @xmath0 and @xmath1 , and a corresponding voltage potential will arise at every node @xmath23 in the graph .",
    "let @xmath154 denote the voltage at @xmath155 .",
    "the electric current that runs through the graph is an example of a flow .",
    "mathematically , _ a flow _ is an assignment of a number @xmath156 ( representing its intensity ) to every directed edge @xmath157 , that has the property of being _ antisymmetric _ ,",
    "i.e. , @xmath158 . given two nodes @xmath0 and @xmath1 ,",
    "we say @xmath59 is _ a flow from @xmath0 to @xmath1 _ if the following property is satisfied at every node @xmath159 .",
    "moereover , we also demand that @xmath160 ( and thus @xmath161 ) , since it s a flow from @xmath0 to @xmath1 .",
    "the quantity @xmath162 is the _ strength _ of the flow @xmath59 from @xmath0 to @xmath1 .    to compute effective resistance",
    "we will assume that a unit flow is entering the network at @xmath0 and exiting at @xmath1 , so @xmath163 and @xmath164 for @xmath159 .",
    "a flow from @xmath0 to @xmath1 is furthermore a _ current flow _ , if it also satisfies ohm s law below . in this case",
    "we use the notation @xmath165 .    whenever a flow can be expressed as the edge difference of a potential function defined on the nodes ,",
    "as is the case for current , then around any cycle @xmath166 the following holds necessarily : @xmath167 this is known as and it turns out to be equivalent to the existence of a potential .",
    "combining kirchoff s node law and ohm s law at @xmath159 , we get : @xmath168 where @xmath169 is the conductance of the edge @xmath157 and @xmath170 is the `` degree '' of node @xmath23 when using conductance to weight each edge .",
    "in particular , we have that @xmath171 namely the potential voltage function @xmath172 must necessarily be harmonic with respect to the weighted graph .",
    "that a current flow satisfying all of these laws and requirements exists is a physical fact , however mathematically one has to prove its existence and uniqueness .",
    "proving uniqueness is fairly easy because flows that satisfy the two kirchoff laws mentioned above satisfy the superposition principle , i.e. given two such flows @xmath173 and @xmath174 , then @xmath175 will also satisfy the same laws .",
    "the existence proof is more challenging and its resolution surprising .",
    "a flow can actually be constructed explicitly that satisfies all the requirements using the concept of spanning trees .",
    "probabilistically , the resulting current @xmath165 along an edge @xmath157 can be shown to equal the expected number of ( net ) times that the random walker ( on the graph weighted by the conductances ) crosses from @xmath23 to @xmath43 .      given two nodes @xmath0 and @xmath1 consider a unit current flow entering at @xmath0 and exiting the network at @xmath1 .",
    "this flow exists and is unique , as explained above , once the neumann conditions , namely the entering and exiting flow , is fixed at @xmath0 and @xmath1 .",
    "moreover , this current determines a unique voltage potential @xmath172 at each node ( up to a constant ) .",
    "the absolute value of the voltage drop between @xmath0 and @xmath1 is what we call the _ effective resistance between @xmath0 and @xmath1_. in formulas : @xmath176      write @xmath177 for the _ local conductance _ at a node @xmath23 .",
    "then the random walk on the weighted graph is the markov chain with transition probabilities @xmath178 whenever @xmath179 .",
    "effective resistance , or more appropriately , _ effective conductance _",
    ", @xmath180 is related to the the probability that a random walker starting at @xmath0 visits @xmath1 before returning to @xmath0 . in symbols ,",
    "recall the notion of stopping time . assuming that the random walk is at @xmath0 at time @xmath85 , we write @xmath181 for the first time it visits node @xmath182 and @xmath183 for the first time the walker revisits @xmath0 after time @xmath65 .",
    "we are interested in @xmath184 , the probability that the random walk starting at @xmath0 visits @xmath182 before returning to @xmath0 .",
    "[ prop : escprob ] for any @xmath12 , @xmath185    the proof is a beautiful application of the maximum principle for harmonic functions ( fact [ fact : maxpr ] ) .",
    "consider @xmath186 to be the boundary and @xmath187 the interior .",
    "we want to find a harmonic function on @xmath188 which takes the value @xmath85 at @xmath0 and the value @xmath65 at @xmath1 . by the maximum principle ,",
    "the solution to this problem is unique .",
    "we now produce two such solutions .",
    "the first one is , @xmath189 harmonicity can be checked by conditioning on the first step .",
    "the second solution is given by normalizing the voltage function @xmath154 which is required in order to have one unit of current flow in at @xmath0 and out at @xmath1 .",
    "so let @xmath190    by uniqueness , @xmath191 .",
    "now , by conditional probability , @xmath192    the probability @xmath193 is also known as the _",
    "escape probability_. with probability @xmath194 escape fails and the walker returns to @xmath0 before visiting @xmath1 , at which point another identical walker starts out for another attempt .",
    "this is akin to flipping a biased coin that has probability @xmath195 of success ( heads ) . in particular , the number of tosses @xmath56 required to achieve success is known to be distributed with the geometric distribution : @xmath196 a calculation using the geometric series shows that the expected number of tosses @xmath197 equals @xmath198 . in our context",
    "@xmath56 is the _ number of visits to @xmath0 before escaping through @xmath1 _",
    "( where we count @xmath199 as a visit ) and its expectation is known as the _ green s function _ of the random walk started at @xmath0 and stopped at @xmath1 . more generally , @xmath200 is the expected number of visits to @xmath201 for the walk started at @xmath0 , before it is stopped at @xmath1 .",
    "it follows from this discussion and proposition [ prop : escprob ] that @xmath202 .",
    "the _ energy _ of a flow @xmath59 is @xmath203 notice that for each edge @xmath204 , the quantity @xmath205 is defined up to a sign change .",
    "therefore , the square @xmath206 is well - defined .",
    "[ prop : innerprod ] consider the unit current flow @xmath61 from @xmath0 to @xmath1 and its corresponding potential @xmath172 defined on the nodes . given an arbitrary flow @xmath207 from @xmath0 to @xmath1 , @xmath208    we have    @xmath209    in particular , applying proposition [ prop : innerprod ] to the case when @xmath207 equals the unit current flow @xmath61 itself and using ( [ eq : effres ] ) , we find that @xmath210    [ thm : thomson ] the unique unit flow from @xmath0 to @xmath1 that minimizes energy is the unit current flow .",
    "let @xmath59 be a unit flow from @xmath0 to @xmath1 and @xmath61 the unit current flow from @xmath0 to @xmath1 .",
    "then @xmath211 is also a flow from @xmath0 to @xmath1 , but of strength zero .",
    "we have    @xmath212    using proposition [ prop : innerprod ] , we see that the cross - term @xmath213 equals zero since @xmath214 . therefore , the energy of @xmath59 is strictly greater than the energy of @xmath61 , unless @xmath215 in which case @xmath216 and @xmath217 .",
    "[ cor : rayleigh ] effective resistance is a ( not necessarily strictly ) increasing function of the edge resistances .",
    "let @xmath218 for every @xmath204 , and let @xmath61 and @xmath219 be the corresponding unit current flows from @xmath0 to @xmath1 .",
    "then    @xmath220    a _ tree _ @xmath221 is a connected graph with no loops .",
    "it follows that given two vertices @xmath23 and @xmath43 on a tree , there is a unique geodesic , i.e. , curve of minimal length . in this case",
    "the effective resistance and the graph distance coincide : @xmath222 because no current can flow along edges that are not part of the unique geodesic .",
    "moreover , in a graph @xmath5 we always have @xmath223 to see this , pick a shortest curve @xmath30 connecting @xmath23 to @xmath43 and note that it will not have any loops , since removing an edge along a loop does not affect the connectedness of @xmath30 . then complete @xmath30 to a _ spanning tree _",
    "@xmath221 for @xmath5 , namely a tree on the same @xmath56 vertices of @xmath5 which is also a subgraph of @xmath5 .",
    "by monotonicity , corollary [ cor : rayleigh ] , we have @xmath224 , because removing an edge from @xmath5 is equivalent to setting its resistance to be @xmath225 . on the other hand , since @xmath221 is a tree @xmath226 .",
    "[ effresmetr ] effective resistance is a metric .",
    "symmetry follows by reversing the current flow .",
    "non - degeneracy follows from ( [ eq : energyeffres ] ) and the existence of a unit current flow .",
    "finally , the triangle inequality is verified by noticing that inputing a unit current flow at @xmath23 , extracting it at @xmath182 , then reinputing it at @xmath182 and extracting at @xmath43 is the same as just inputing it at @xmath23 and extracting it at @xmath43 .",
    "the _ adjacency matrix _ of a graph is a way to represent which nodes of a graph are adjacent to each other .",
    "given a simple graph @xmath2 , let @xmath134 be the matrix with entries : @xmath227 ( we write @xmath228 instead of @xmath229 by abuse of notation , even though @xmath230 is an ordered pair . )    if the graph is weighted with weight @xmath231 , then we set @xmath232      let @xmath5 denote a graph with vertex set @xmath233 and edge set @xmath4 .",
    "then the _ combinatorial laplacian _",
    "@xmath234 is an @xmath235 matrix defined by @xmath236 where @xmath237 is the degree of the vertex @xmath61 , i.e. @xmath238 letting @xmath133 be the diagonal matrix @xmath239 , we see that @xmath240 .    also recalling the transition matrix @xmath63 for the random walk on @xmath5 defined in ( [ eq : grphtrans ] ) , we see that @xmath241      given an edge @xmath147 joining two nodes , arbitrarily assign one of these two nodes to be @xmath147 s _ tail _ and the other one to be @xmath147 s _",
    "head_. once this choice is made we will write @xmath242 to mean that @xmath23 is the tail and @xmath43 the head .",
    "consider the following @xmath243 matrix , where @xmath244 , and @xmath245 , @xmath246    we claim that @xmath247 where @xmath248 is the @xmath249 diagonal matrix with entries @xmath250 ( the weight of edge @xmath147 ) . to check this , notice that @xmath251 if @xmath252 , the only term that survives in the sum is",
    "when @xmath23 and @xmath43 are neighbors and @xmath242 , then we get @xmath253 . if @xmath39 , any edge from @xmath23 contributes @xmath254 , so we get the degree at @xmath23 .",
    "a _ quadratic form _ is a function of the form @xmath255 , where @xmath134 is a symmetric matrix . since the combinatorial laplacian is symmetric we can write @xmath256 it follows that the quadratic form associated to the laplacian is positive semi - definite . in practice",
    ", this implies that the eigenvalues are greater than or equal to zero , as can be seen from the so - called `` minimax characterization '' : let @xmath257 , then @xmath258 where @xmath57 is a linear subspace of @xmath259 .",
    "[ rem : quadform ] if @xmath172 is the potential resulting from inputing a unit current flow @xmath61 at @xmath0 and extracting it at @xmath1 , then using ohm s law and ( [ eq : energyeffres ] ) we see that the quadratic form satisfies : @xmath260      we claim that the kernel of the laplacian consists of the constant vectors : @xmath261^t\\}\\ ] ] we use the quadratic form to check this : @xmath262 in particular , this means that the smallest eigenvalue of the laplacian is @xmath85 .",
    "traditionally , we relabel the eigenvalues from @xmath85 to @xmath263 , as follows : @xmath264      being symmetric , the combinatorial laplacian @xmath234 can be diagonalized , i.e. , there are eigenvectors @xmath265 , @xmath266,  ,@xmath267",
    "such that @xmath268 where @xmath269 $ ] , @xmath270 and @xmath271 is the diagonal matrix of eigenvalues ,    @xmath272\\ ] ]    recall that given a vector @xmath273 , the matrix @xmath274 is a rank one matrix with range the line spanned by @xmath273 .",
    "since the laplacian has a non - trivial kernel , it is not invertible .",
    "however , we can still define a pseudoinverse called the _",
    "green operator_. @xmath275 then @xmath276 and @xmath277 which is also equal to the projection in @xmath278 onto @xmath279 .",
    "let @xmath280 denote the current injected at point @xmath0 and extracted at point @xmath1 , which can be thought of as an @xmath71 vector @xmath281^t.\\ ] ] the current @xmath282 for each edge @xmath147 , can be written as an @xmath283 vector since there are @xmath89 edges . since each edge @xmath147",
    "is assigned a head and a tail , then @xmath282 will either be positive or negative depending on whether the current flows from tail to head or vice versa .",
    "then kirchoff s node law can be written in matrix form as @xmath284 where @xmath101 is the square - root of the laplacian defined in ( [ eq : sqrtlapl ] ) .    to see this check that at every vertex @xmath23 ,",
    "@xmath285 the only terms that survive in this sum correspond to edges @xmath147 with either their head or tail at @xmath23 .",
    "let s first assume that each edge was oriented in such a way that the current always flows from tail to head .",
    "then @xmath286 for every edge with current flowing in at @xmath23 and @xmath287 for every edge with current flowing out of @xmath23 ( and @xmath282 is always positive with this choice of orientation ) .",
    "so the sum we get is exactly the divergence at @xmath23 . if for some reason an edge is oriented against the current flow then both @xmath288 and @xmath282 change sign so their product does not .",
    "ohm s law says that the resulting voltage @xmath172 on the network satisfies @xmath289 in matrix form ohm s law can be written as : @xmath290 as the following computation shows : @xmath291 where @xmath242 , since @xmath43 is the head and @xmath23 the tail of @xmath147 .    combining ( [ eq : currentlaw ] ) and ( [ eq : ohmslaw ] ) with ( [ eq : lbtwb ] ) , we see that @xmath292 we interpret this as an inhomogeneous problem to solve in @xmath172 with @xmath280 given .",
    "however , as we ve seen @xmath234 is not generally invertible , unless @xmath280 is perpendicular to the kernel of @xmath234 , i.e. , @xmath293^t\\}$ ] . that s exactly our case , since the current input at @xmath0 equals the current output at @xmath1",
    ". therefore , we can apply green s operator to both sides and get the potential drop @xmath294 in other words , writing @xmath295^t = i_{ext},\\ ] ] we get that the effective resistance @xmath296 if @xmath0 and @xmath1 are neighbors , then @xmath297 is a row of @xmath101 corresponding to the edge @xmath298 , and thus @xmath299",
    "a function @xmath273 defined on the vertices induces a _ gradient _",
    "@xmath300 on the edges , i.e. , for @xmath301 , @xmath302 the _ energy _ of @xmath300 is @xmath303 ( on a weighted graph we modify this definition as follows : @xmath304 . )",
    "given two nodes @xmath0 and @xmath1 in a graph @xmath5 , we will minimize the energy among all the functions @xmath305 with @xmath306 and @xmath307 .",
    "we define the _ capacity _ between @xmath0 and @xmath1 to be @xmath308 the function @xmath273 that attains the minimum is called the _ capacitary _ function for @xmath0 and @xmath1 .    assuming that each edge has unit resistance , recall that thomson s principle ( theorem [ thm : thomson ] ) and ( [ eq : energyeffres ] )",
    "imply that the effective resistance between @xmath0 and @xmath1 can be computed by minimizing the energy of all unit flows between @xmath0 and @xmath1 , and that the minimum is achieved for the unit _ current _ flow .",
    "the electric potential @xmath172 that gives rise to the unit current flow can be used to interpret the unsigned flow as a `` gradient '' .",
    "in fact , by ohm s law , for @xmath301 , @xmath309 the electric potential @xmath172 is only defined up to an additive constant , what matters is the drop @xmath310 which equals @xmath311 .",
    "so , dividing @xmath172 by @xmath311 and shifting by a constant @xmath151 if necessary , we get a function @xmath312 such that @xmath313 , @xmath314 , and whose gradient is @xmath315 computing the energy of @xmath316 and using ( [ eq : energyeffres ] ) we get an upper bound for @xmath317 : @xmath318 this inequality is in fact an equality , even though the two sides are obtained by minimizing the energy of very different objects : flows that do nt necessarily admit potentials , on one hand , and gradients which are obtained from a `` potential '' function defined on the vertex set , on the other hand .",
    "[ prop : capaceff ] we always have @xmath319 and the function @xmath320 defined in ( [ eq : capacitary ] ) is the capacitary function for @xmath0 and @xmath1 .    the quadratic form induced by the combinatorial laplacian of section [ sssec : quadform ] can be used to compute the energy of gradients , since @xmath321 in other words , if we number the nodes @xmath322 , the capacity @xmath323 for @xmath324 is computed by minimizing the quadratic form restricted to the affine subspace of codimension @xmath325 @xmath326 this can be handled with the method of lagrange multipliers .",
    "let @xmath327 for @xmath328 and @xmath329 .",
    "then given @xmath330 , @xmath331 for some parameters @xmath332 and @xmath333 .",
    "notice that @xmath334 , the standard unit vector in the @xmath61-th direction . also @xmath335 .",
    "let @xmath336 be a solution of ( [ eq : lagrange ] ) .",
    "then , interpreted as a function , @xmath337 is harmonic at every node except possibly for nodes @xmath61 and @xmath59 .",
    "moreover , @xmath338 and @xmath339 . by the maximum principle",
    ", there is a unique harmonic function with these boundary values .",
    "therefore the solution to the lagrange multipliers problem coincides with @xmath320 from ( [ eq : capacitary ] ) , i.e. , the harmonic function obtained by renormalizing the electric potential @xmath172 arising from the effective resistance problem .",
    "we relax the notion of gradient and consider arbitrary _ @xmath340-densities _ , i.e. , functions @xmath341 .",
    "the _ @xmath340-length _ of a curve @xmath30 is then : @xmath342 we measure the energy of @xmath340 as done before in ( [ eq : energy ] ) for gradients .    a _ curve family _",
    "@xmath343 is a collection of curves @xmath30 in a graph @xmath5 .",
    "we say that @xmath340 is _ admissible _ for the curve family @xmath343 if @xmath344 we write @xmath345 for the family of all admissible densities for a given curve family @xmath343 .",
    "the _ modulus _ of @xmath343 is @xmath346 the advantage of modulus is that any choice of admissible density gives rise to an upper - bound .",
    "if the family @xmath343 contains a constant curve , then its modulus is infinite .",
    "otherwise , choosing @xmath347 we see that @xmath348 is bounded above by @xmath349 , the number of edges .",
    "given two nodes @xmath0 and @xmath1 , let @xmath350 be the modulus of the curve - family consisting of all curves @xmath30 that contain both @xmath0 and @xmath1 .",
    "we call this curve - family @xmath351 .",
    "it turns out that modulus and capacity are closely related concepts .",
    "[ prop : modcap ] we always have @xmath352    let @xmath320 be the capacitary function for @xmath0 and @xmath1 defined in ( [ eq : capacitary ] ) , whose gradient @xmath316 has energy @xmath353 equal to @xmath317 . we first show that @xmath316 is an admissible @xmath340-density for @xmath351 .",
    "let @xmath30 be an arbitrary curve from @xmath0 to @xmath1 . then , since @xmath30 is connected , it must contain a chain of vertices @xmath354 so that @xmath355 for @xmath356 . by the triangle inequality",
    "@xmath357 so @xmath316 is admissible for @xmath351 and @xmath358    conversely , let @xmath340 be an arbitrary admissible density for @xmath351 . without loss of generality we can assume that there is a curve @xmath359 such that @xmath360 , because otherwise we could scale @xmath340 by dividing by the shortest @xmath340-length and still have an admissible density .",
    "define a function @xmath273 on the vertices by @xmath361 i.e. , the shortest @xmath340-length of curves connecting @xmath0 to @xmath23 .",
    "then @xmath306 ( the constant curve has length zero ) , and @xmath362 because of the curve @xmath363 mentioned above .",
    "furthermore , for an arbitrary edge @xmath301 , @xmath364 because the shortest curve from @xmath0 to @xmath23 followed by the edge @xmath147 is a curve from @xmath0 to @xmath43 .",
    "therefore , inverting the roles of @xmath23 and @xmath43 , we find that the gradient of @xmath273 satisfies @xmath365 this in turn implies that @xmath366 , i.e. , @xmath367 since @xmath340 was an arbitrary admissible density , we can minimize over @xmath340 and get @xmath368    putting propositions [ prop : capaceff ] and [ prop : modcap ] together we obtain :    [ thm : modcap ] the three concepts of effective conductance , capacity and modulus coincide : @xmath369    we can now exploit the definition of modulus as an infimum and obtain a comparison between the epidemic quasimetric and effective conductance .",
    "[ prop : upperbound ] @xmath370    [ cor : estimate ] we have @xmath371    recall some of the notations introduced to define the epidemic quasimetric .",
    "we considered @xmath372 , i.e. , the subgraph of @xmath5 induced by the vertices that are in the ball @xmath373 .",
    "define a @xmath340-density for @xmath351 by letting @xmath374 , if @xmath147 is an edge in @xmath375 , and let @xmath376 otherwise .",
    "we claim that this @xmath340-density is admissible for @xmath351 .",
    "to see this pick an arbitrary curve @xmath30 that contains both @xmath0 and @xmath1 . by definition of graph distance ( [ eq : graphdist ] ) , we have @xmath377 , and this takes care of curves that stay in @xmath378",
    ". some curves might actually exit @xmath378 , but if they do then they must exit the ball @xmath373 and therefore they will again have @xmath340-length greater than one .    by ( [ eq : modulus ] )",
    "we get that @xmath379",
    "for instance , the star @xmath389 is a tree with a vertex @xmath390 that plays the role of hub and has @xmath263 neighbors .",
    "the diameter is @xmath325 and the graph distances are either @xmath65 or @xmath325 . on the other hand ,",
    "the epidemic quasimetric is either @xmath56 or @xmath391 .",
    "therefore @xmath388 grows linearly with @xmath56 .",
    "the complete graph @xmath392 is the graph on @xmath56 vertices with the maximum number of edges , i.e. , every vertex has @xmath263 neighbors . here",
    "the diameter is @xmath65 , and the graph distance is constant equal to @xmath65 .",
    "effective resistance can be computed as follow : fix two nodes @xmath23 and @xmath43 and let @xmath393 be the remaining nodes in @xmath394 . by symmetry the potential induced by a unit current flow between @xmath0 and @xmath1 will be constant on @xmath393 .",
    "hence no current will flow along the @xmath395 complete graph induced by @xmath393 .",
    "we get that @xmath393 can be thought as a single vertex connected by @xmath396 edges to @xmath23 and @xmath43 respectively .",
    "using the `` serial '' and `` parallel '' rules from high school physics , we find that @xmath397 the epidemic quasimetric in this case is constant and equal to @xmath398 .",
    "therefore @xmath388 is also constant and equal to @xmath399 .",
    "again we see that @xmath388 grows linearly with @xmath56 .",
    "one might conjecture that the discrepancy @xmath388 always grows at most linearly in the number of vertices , but that turns out to be false . using ( [ eq : graphdistbound ] ) , the volume of the complete graph @xmath392 and bounding @xmath400 , we find that @xmath401 .",
    "this quadratic worst behavior can be achieved by letting @xmath5 be the graph obtained from the complete graph @xmath392 by picking a vertex @xmath0 and connecting it to a new vertex @xmath1 by a single edge . in this situation @xmath402 , and @xmath403 , but @xmath404 , so @xmath405 .",
    "one could say that in this case the epidemic quasimetric captures a feature of the graph @xmath5 that effective resistance does not see .",
    "we wrote a simple routine in matlab ( actually we wrote a couple different ones ) .",
    "we are given a simple ( possibly weighted graph ) in the form of an adjacency matrix , see section [ ssec : adjacency ] . in some cases , matrices are too large and have to be entered in list form .",
    "this consists of two columns of labels from @xmath65 to @xmath56 , where each row represents an edge in the graph .",
    "we call the adjacency matrix @xmath406 and normalize it so that all the non - zero entries are equal to @xmath65 .",
    "the matrix @xmath406 is zero along the diagonal so we let @xmath407 .",
    "we then take powers @xmath408 of @xmath101 .",
    "an entry in the @xmath230 spot of @xmath408 is non - zero if and",
    "only if at least one of the terms in the sum @xmath409 is non zero , i.e. , if and only if there is at least one chain @xmath410 connecting @xmath61 and @xmath59 . each step @xmath411 either moves to a neighbor or stays at the given node .",
    "we again normalize the entries of @xmath408 to be @xmath65 when non - zero .",
    "let @xmath412 be the normalized version of @xmath408 and define @xmath413 .",
    "next , given a node @xmath414 we look at the row @xmath414 in the matrix @xmath412 and find a @xmath65 in the column corresponding to each node that is graph distance less or equal to @xmath207 from @xmath414 .",
    "we use this row to form a diagonal matrix @xmath89 and compute the matrix @xmath415 .",
    "the entries of @xmath416 are of the form      in other words , we see that @xmath416 is the adjacency matrix of the subgraph of @xmath5 induced by the vertices that are in the ball @xmath418 centered at @xmath414 of radius @xmath207 .",
    "we now compute the volume by summing all the entries of @xmath416 and dividing by @xmath325 .",
    "this is equivalent to first summing all the rows and getting the local degrees and then summing the rows and getting the sum of all the local degrees , which by the handshake lemma equals twice the number of edges .",
    "finally , recall that the graph distance between @xmath23 and @xmath43 is the first time @xmath43 belongs to the ball @xmath419 : @xmath420 the way we actually compute the graph distance is as follows .",
    "we flip each zero and one in @xmath412 , in practice we take a constant matrix @xmath421 with entries @xmath422 and let @xmath423 .",
    "then we sum the @xmath424 from @xmath85 to @xmath56 , i.e. , we let @xmath425 .",
    "then @xmath426    [ [ numerical - experiments - using - the - epidemic - quasimetric - in - clustering - algorithms ] ] numerical experiments using the epidemic quasimetric in clustering algorithms ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~            once we wrote the algorithm for computing the epidemic quasimetric we tested how it would fare in the case of the famous `` karate club '' , see figure  [ fig : karateclub ] .",
    "the nodes represent club members and the edges the friendship relations between them . after an argument between the two leaders , node 1 and 34 , the club split into two clubs , thus the coloring of the vertices into red and blue vertices .",
    "the splitting is a real life phenomenon and then the intuition is that the web of friendships should play a role .",
    "we used the epidemic quasimetric as a measure of `` similarity '' between nodes in the agglomerative agnes algorithm ( this we performed in r ) .",
    "we obtained the dendrogram in figure  [ fig : dendrogram ] .",
    "this is an algorithm that begins by putting each vertex in its own class .",
    "it then ` agglomerates ' two classes based on the degree of similarity between them , which is computed by taking averages of all the similarities between elements of the two classes .",
    "the algorithm tries to agglomerate the least dissimilar classes first ."
  ],
  "abstract_text": [
    "<S> we introduce the epidemic quasimetric on graphs and study its behavior with respect to clustering techniques . in particular we compare its behavior to known objects such as the graph distance , effective resistance , and modulus of curve families . </S>"
  ]
}