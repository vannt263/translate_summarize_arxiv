{
  "article_text": [
    "during the last three decades continuous efforts @xcite have been devoted to extend applicability of the density functional theory ( dft)@xcite to large - scale systems , which leads to realization of more realistic simulations being close to experimental conditions .",
    "in fact , lots of large - scale dft calculations have already contributed for comprehensive understanding of a vast range of materials,@xcite although widely used functionals such as local density approximation ( lda)@xcite and generalized gradient approximation ( gga)@xcite have limitation in describing strong correlation in transition oxides and van der waals interaction in biological systems .",
    "the efficient methods developed so far within the conventional dft can be classified into two categories in terms of the computational complexity , @xcite while the other methods , which deviate from the classification , have been also proposed.@xcite the first category consists of o(@xmath4 ) methods , @xcite where @xmath3 is the number of basis functions , as typified by the householder - qr method,@xcite the conjugate gradient method,@xcite and the pulay method,@xcite which have currently become standard methods .",
    "the methods can be regarded as numerically exact methods , and the computational cost scales as o(@xmath4 ) even if only valence states are calculated because of the orthonormalization process . on the other hand ,",
    "the second category involves approximate o(@xmath3 ) methods such as the density matrix method,@xcite the orbital minimization method,@xcite and the krylov subspace method@xcite of which computational cost is proportional to the number of basis functions @xmath3 .",
    "the linear - scaling of the computational effort in the o(@xmath3 ) methods can be achieved by introducing various approximations like the truncation of the density matrix@xcite or wannier functions@xcite in real space .",
    "although the o(@xmath3 ) methods have been proven to be very efficient , the applications must be performed with careful consideration due to the introduction of the approximations , which might be one of reasons that the o(@xmath3 ) methods have not been widely used compared to the o(@xmath4 ) methods . from the above reason one may think of whether a numerically exact but low - order scaling method can be developed by utilizing the resultant sparse structure of the hamiltonian and overlap matrices expressed by localized basis functions .",
    "recently , a direction towards the development of o(@xmath5 ) methods has been suggested by lin et al . , in which diagonal elements of the density matrix is computed by a contour integration of the green function calculated by making full use of the sparse structure of the matrix.@xcite also",
    ", an efficient scheme has been presented by li et al . to calculate diagonal elements of the green function for electronic transport calculations,@xcite which is based on the algorithm by takahashi et",
    "al.@xcite and erisman and tinney.@xcite however , except for the two methods mentioned above the development of numerically exact o(@xmath5 ) methods , which are positioned in between the o(@xmath3 ) and o(@xmath4 ) methods , has been rarely explored yet for large - scale dft calculations .    in this paper",
    "we present a numerically exact but low - order scaling method for large - scale dft calculations of insulators and metals using localized basis functions such as pseudo - atomic orbital ( pao),@xcite finite element ( fe),@xcite and wavelet basis functions.@xcite the computational effort of the method scales as o(@xmath0 ) , o(@xmath1 ) , and o(@xmath2 ) for one , two , and three dimensional ( 1d , 2d , and 3d ) systems , respectively . in spite of the low - order scaling ,",
    "the method is a numerically exact alternative to the conventional o(@xmath4 ) methods . the key idea of the method is to directly compute selected elements of the density matrix by a contour integration of the green function evaluated with a set of recurrence formulas .",
    "it is shown that a contour integration method based on a continued fraction representation of the fermi - dirac function@xcite can be successfully employed for the purpose , and that the number of poles used in the contour integration does not depend on the size of the system .",
    "we also derive a set of recurrence formulas based on the nested dissection@xcite of the sparse matrix and a block @xmath6 factorization using the schur complement@xcite to calculate selected elements of the green function .",
    "the computational complexity is governed by the calculation of the green function .",
    "in addition to the low - order scaling , the method can be particularly advantageous to the massively parallel computation because of the well separated data structure .",
    "this paper is organized as follows : in sec .",
    "ii the theory of the proposed method is presented together with detailed analysis of the computational complexity . in sec .",
    "iii several numerical calculations are shown to illustrate practical aspects of the method within a model hamiltonian and dft calculations using the pao basis functions . in sec .",
    "iv we summarize the theory and applicability of the numerically exact but low - order scaling method .",
    "let us assume that the kohn - sham ( ks ) orbital @xmath7 is expressed by a linear combination of localized basis functions @xmath8 such as pao,@xcite fe,@xcite and wavelet basis functions@xcite as : @xmath9 where @xmath3 is the number of basis functions . throughout the paper , we consider the spin restricted and @xmath10-independent ks orbitals for simplicity of notation .",
    "however , the generalization of our discussion for these cases is straightforward . by introducing lda or gga for the exchange - correlation functional ,",
    "the ks equation is written in a sparse matrix form : @xmath11 where @xmath12 is the eigenvalue of state @xmath13 , @xmath14 a vector consisting of coefficients @xmath15 , and @xmath16 and @xmath17 are the hamiltonian and overlap matrices , respectively .",
    "due to both the locality of basis functions and lda or gga for the exchange - correlation functional , both the matrices possess the same sparse structure .",
    "it is also noted that the charge density @xmath18 can be calculated by the density matrix @xmath19 : @xmath20 by remembering that @xmath21 is localized in real space , one may notice that the product @xmath22 is non - zero only if they are closely located each other .",
    "thus , the number of elements in the density matrix required to calculate the charge density scales as o(@xmath3 ) . as well as the calculation of the charge density ,",
    "the total energy is computed by only the corresponding elements of the density matrix within the conventional dft as : @xmath23 & = & { \\rm tr}(\\rho h_{\\rm kin } )     + \\int d{\\bf r}n({\\bf r } ) v_{\\rm ext}({\\bf r } ) \\\\     & & + \\int\\int d{\\bf r } d{\\bf r } '     \\frac{n({\\bf r})n({\\bf r } ' ) }         { \\vert { \\bf r}-{\\bf r}'\\vert }       + e_{\\rm xc}[n],\\end{aligned}\\ ] ] where @xmath24 is the matrix for the kinetic operator , @xmath25 an external potential , and @xmath26 an exchange - correlation functional .",
    "since the matrix @xmath24 possesses the same sparse structure as that of @xmath17 , one may find an alternative way that the selected elements of the density matrix , corresponding to the non - zero products @xmath22 , are directly computed without evaluating the ks orbitals .",
    "the alternative way enables us to avoid an orthogonalization process such as gram - schmidt method for the ks orbitals , of which computational effort scales as o(@xmath4 ) even if only the occupied states are taken into account .",
    "the direct evaluation of the selected elements in the density matrix is the starting point of the method proposed in the paper .",
    "the density matrix @xmath19 can be calculated through the green function @xmath27 as follows : @xmath28 where the factor 2 is due to the spin degeneracy , @xmath29 the fermi - dirac function , @xmath30 chemical potential , @xmath31 electronic temperature , @xmath32 the boltzmann factor , and @xmath33 a positive infinitesimal .",
    "also the matrix expression of the green function is given by @xmath34 where @xmath35 is a complex number .",
    "therefore , from eqs .",
    "( 5 ) and ( 6 ) , our problem is cast to two issues : ( i ) how the integration of the green function can be efficiently performed , and ( ii ) how the selected elements of the green function in the matrix form can be efficiently evaluated . in the subsequent subsections",
    "we discuss the two issues in detail .",
    "we perform the integration of the green function , eq .",
    "( 5 ) , by a contour integration method using a continued fraction representation of the fermi - dirac function.@xcite in the contour integration the fermi - dirac function is expressed by @xmath36 where @xmath37 with @xmath38 , @xmath39 and @xmath40 are poles of the continued fraction representation and the associated residues , respectively .",
    "the representation of the fermi - dirac function is derived from a hypergeometric function , and can be regarded as a pad approximant when terminated at the finite continued fraction .",
    "the poles @xmath39 and residues @xmath40 can be easily obtained by solving an eigenvalue problem as shown in ref .",
    "[ @xcite ] . by making use of the expression of eq .",
    "( 7 ) for eq .",
    "( 5 ) and considering the contour integration , one obtain the following expression for the integration of eq .",
    "( 5 ) : @xmath41 where @xmath42 , and @xmath43 is the zeroth order moment of the green function which can be computed by @xmath44 with a large real number @xmath45 . the structure of the poles distribution , that all the poles are located on the imaginary axis like the matsubara pole , but the density of the poles becomes smaller as the poles go away from the real axis , has been found to be very effective for the efficient integration of eq .",
    "it has been shown that only the use of the 100 poles at 600 k gives numerically exact results within double precision.@xcite thus , the contour integration method can be regarded as a numerically exact method even if the summation is terminated at a practically modest number of poles .",
    "moreover , it should be noted that the number of poles to achieve convergence is independent of the size of system . giving the green function in the lehmann representation , eq .",
    "( 8) can be rewritten by @xmath46 although the expression in the second line is obtained by just exchanging the order of the two summations , the expression clearly shows that the number of poles for convergence does not depend on the size of system if the spectrum radius is independent of the size of system .",
    "since the independence of the spectrum radius can be found in general cases , it can be concluded that the computational effort is determined by that for the calculation of the green function .",
    "the energy density matrix @xmath47 , which is needed to calculate forces on atoms within non - orthogonal localized basis functions , can also be calculated by the contour integration method@xcite as follows : @xmath48 with @xmath49 defined by @xmath50 where @xmath43 and @xmath51 are the the zeroth and first order moments of the green function , and can be computed by solving the following simultaneous linear equation : @xmath52 the equation is derived by terminating the summation over the order of the moments in the moment representation of the green function . by letting @xmath53 and @xmath54 be @xmath55 and @xmath56 , respectively , @xmath43 and @xmath51 are explicitly given by @xmath57 where @xmath45 should be a large real number , and @xmath58 is used in this study so that the higher order terms can be negligible in terminating the summation in the moment representation of the green function . inserting eqs .",
    "( 13 ) and ( 14 ) into eq .",
    "( 10 ) , we obtain the following expression which is suitable for the efficient implementation in terms of memory consumption : @xmath59 with @xmath60 and @xmath61 defined by @xmath62 one may notice that the number of poles for convergence does not depend on the size of system even for the calculation of the energy density matrix because of the same reason as for the density matrix .",
    "it is found from the above discussion that the computational effort to compute the density matrix is governed by that for the calculation of the green function , consisting of an inversion of the sparse matrix of which computational effort by conventional schemes such as the gauss elimination or lu factorization based methods scales as o(@xmath4 ) .",
    "thus , the development of an efficient method of inverting a sparse matrix is crucial for efficiency of the proposed method .    here",
    "we present an efficient low - order scaling method , based on a nested dissection approach,@xcite of computing only selected elements in the inverse of a sparse matrix .",
    "the low - order scaling method proposed here consists of two steps : ( 1 ) _ nested dissection _ : by noting that a matrix @xmath63 is sparse , a structured matrix is constructed by a nested dissection approach . in practice ,",
    "just reordering the column and row indices of the matrix @xmath64 yields the structured matrix .",
    "inverse by recurrence formulas _ : by recursively applying a block @xmath6 factorization@xcite to the structured matrix , a set of recurrence formulas is derived . using the recurrence formulas ,",
    "only the selected elements of the inverse matrix @xmath65 are directly computed . the computational effort to calculate the selected elements in the inverse matrix using the steps ( i ) and ( ii ) scales as o(@xmath0 ) ,",
    "o(@xmath1 ) , and o(@xmath2 ) for 1d , 2d , and 3d systems , respectively , as shown later .",
    "first , we discuss the nested dissection of a sparse matrix , and then derive a set of recurrence formulas of calculating the selected elements of the inverse matrix .",
    "-valent nntb and its corresponding matrix , ( b ) the renumbering for atoms by the first step in the nested dissection and its corresponding matrix , ( c ) the renumbering for atoms by the second step in the nested dissection and its corresponding matrix , ( d ) the binary tree structure representing hierarchical interactions between domains in the structured matrix by the numbering shown in fig .",
    ", width=302 ]      as an example the right panel of fig .",
    "1(c ) shows a structured matrix obtained by the nested dissection approach for a finite chain model consisting of ten atoms , where we consider a @xmath66-valent nearest neighbor tight binding ( nntb ) model .",
    "when one assigns the number to the ten atoms as shown in the left panel of fig .",
    "1(a ) , then @xmath64 is a tridiagonal matrix , of which diagonal and off - diagonal terms are assumed to be @xmath67 and @xmath68 , respectively , as shown in the right panel of fig .",
    "1(a ) . as the first step to generate the structured matrix shown in the right panel of fig .",
    "1(c ) , we make a _ dissection _ of the system into the left and right _ domains_@xcite by renumbering for the ten atoms , and obtain a dissected matrix shown in the right panel of fig .",
    "the left and right domains interact with each other through only a _ separator _ consisting of an atom 10 . as the second step we apply a similar dissection for each domain generated by the first step , and",
    "arrive at a _",
    "nested_-_dissected _ matrix given by the right panel of fig .",
    "the subdomains , which consist of atoms 1 and 2 and atoms 3 and 4 , respectively , in the left domain interact with each other through only a separator consisting of an atom 5 .",
    "the similar structure is also found in the right domain consisting of atoms 6 , 7 , 9 , and 8 .",
    "it is worth mentioning that the resultant nested structure of the sparse matrix can be mapped to a binary tree structure which indicates hierarchical interactions between ( sub)domains as shown in fig .",
    "by applying the above procedure to a sparse matrix , one can convert any sparse matrix into a nested and dissected matrix in general .",
    "however in practice there is no obvious way to perform the nested dissection for general sparse matrices , while a lot of efficient and effective methods have been already developed for the purpose.@xcite here we propose a rather simple but effective way for the nested dissection by taking account of a fact that the basis function we are interested in is localized in real space , and that the sparse structure of the resultant matrix is very closely related to the position of basis functions in real space .",
    "the method bisects a system into two domains interacting through only a separator , and recursively applies to the resultant subdomains , leading to a binary tree structure for the interaction .",
    "our algorithm for the nested dissection of a general sparse matrix is summarized as follows :    \\(i ) _ ordering_. let us assume that there are @xmath69 basis functions in a domain we are interested in .",
    "we order the basis functions in the domain by using the fractional coordinate for the central position of localized basis functions along @xmath70-axis , where @xmath71 , and 3 . as a result of the ordering , each basis function",
    "can be specified by the _ ordering number _ , which runs from 1 to @xmath69 in the domain of the central unit cell .",
    "the ordering number in the periodic cells specified by @xmath72 , where @xmath73 , is given by @xmath74 , where @xmath75 is the corresponding ordering number in the central cell . in isolated systems",
    ", one can use the cartesian coordinate instead of the fractional coordinate without losing any generality .",
    "\\(ii ) _ screening of basis functions with a long tail_. the basis functions with a long tail tend to make an efficient dissection difficult .",
    "the sparse structure formed by the other basis functions with a short tail is latescent due to the existence of the basis functions with a long tail .",
    "thus , we classify the basis functions with a long tail in the domain as members in the separator before performing the dissection process . by the screening of the basis functions with a long tail , it is possible to expose concealed sparse structure when atomic basis functions with a variety of tails are used , while a systematic basis set such as the fe basis functions may not require the screening .",
    "\\(iii ) _ finding of a starting nucleus_. among the localized basis functions in the domain , we search a basis function which has the smallest number of non - zero overlap with the other basis functions . once we find the basis function , we set it as a starting _ nucleus _ of a subdomain .",
    "\\(iv ) _ growth of the nucleus_. staring from a subdomain given by the procedure ( iii ) , we grow the subdomain by increasing the size of nucleus step by step .",
    "the growth of the nucleus can be easily performed by managing the minimum and maximum ordering numbers , @xmath76 and @xmath77 , which ranges from 1 to @xmath69 .",
    "we define the subdomain by basis functions with the successive ordering numbers between the minimum and maximum ordering numbers @xmath76 and @xmath77 . at each step in the growth of the subdomain",
    ", we search two basis functions which have the minimum ordering number @xmath78 and maximum ordering number @xmath79 among basis functions overlapping with the subdomain defined at the growth step . in the periodic boundary condition , @xmath78 can be smaller than zero , and @xmath79 can be larger than the number of basis functions @xmath69 .",
    "then , the number of basis functions in the subdomain , the separator , and the other subdomain can be calculated by @xmath80 , @xmath81 , and @xmath82 , respectively , at each growth step . by the growth process",
    "one can minimize @xmath83 being a measure for quality of the dissection , where the measure @xmath83 takes equal bisection size of the subdomains and minimization of the size of the separator into account .",
    "also , if @xmath84 is larger than @xmath69 , then this situation implies that the proper dissection can be difficult along the axis .",
    "\\(v ) _ dissection_. by applying the above procedures ( i)-(iv ) to each @xmath70-axis , where @xmath71 , and 3 , and we can find an axis which gives the minimum @xmath83 .",
    "then , the dissection along the axis is performed by renumbering for basis functions in the domain , and two subdomains and one separator are obtained .",
    "evidently , the same procedures can be applied to each subdomain , and recursively continued until the size of domain reaches the threshold . as a result of the recursive dissection , we obtain a structured matrix by the nested dissection .    as an illustration",
    "we apply the method for the nested dissection to the finite chain molecule shown in fig .  1 .",
    "we first set all the system as _",
    "domain _ , and start to apply the series of procedures to the domain .",
    "the procedure ( i ) is trivial for the case , and we obtain the numbering of atoms and the corresponding matrix shown in fig .",
    "also it is noted that the screening of the basis functions with a long tail is unnecessary , and that we only have to search the chain direction . in the procedure ( iii ) , atoms 1 and 10 in fig .",
    "1(a ) satisfy the condition .",
    "choosing the atom 1 as a starting nucleus of the domain , and we gradually increase the size of the domain according to the procedure ( iv ) .",
    "then , it is found that the division shown in fig .",
    "1(b ) gives the minimum @xmath83 .",
    "renumbering for the basis functions based on the analysis yields the dissected matrix shown in the right panel of fig .",
    "1(b ) . by applying the similar procedures to the left and right subdomains",
    ", one will immediately find the result of fig .",
    "-valent nntb , of which unit cell contains 1024 atoms with periodic boundary condition .",
    "the right blue and red circles correspond to atoms in two domains and a separator , respectively , at the first step in the nested dissection .",
    "( b ) the square lattice model at the final step in the nested dissection .",
    "the separator at the innermost and the outermost levels are labeled as separators 0 and 5 , respectively , and the separators at each level are constructed by atoms with a same color . , width=332 ]    in addition to the finite chain molecule , as an example of more general cases , the above algorithm for the nested dissection is applied to a @xmath66-valent nntb square lattice model of which unit cell contains 1024 atoms with periodic boundary condition . at the first step in the nested dissection , the separator is found to be red atoms as shown in fig .",
    "2(a ) . due to the periodic boundary condition , the separator consists of two _",
    "lines_. at the final step , the system is dissected by the recursive algorithm as shown in fig.2  ( b ) .",
    "the separator at the innermost and the outermost levels are labeled as separators 0 and 5 , respectively , and each subdomain at the innermost level includes 9 atoms .",
    "as demonstrated for the square lattice model , the algorithm can be applied for systems with any dimensionality , and provides a well structured matrix for our purpose in a single framework .",
    "we directly compute the selected elements of the inverse matrix using a set of recurrence formulas which can be derived by recursively applying a block @xmath6 factorization to the structured matrix obtained by the nested dissection method as shown below . to derive the recurrence formulas ,",
    "we first introduce the block @xmath6 factorization@xcite for a symmetric square matrix @xmath64 : @xmath85 where @xmath86 and @xmath87 are diagonal block matrices , and @xmath88 and @xmath89 an off - diagonal block matrix and its transposition , and @xmath90 is given by @xmath91 also the schur complement @xmath17 of the block element @xmath87 is defined by @xmath92 then , it is verified that the inverse matrix of @xmath64 is given by @xmath93 we now consider calculating the selected elements of the inverse of the structured matrix given in fig .",
    "1(c ) using eq .",
    "( 21 ) , and rewrite the matrix in fig .",
    "1(c ) in a block form as follows : @xmath94 where @xmath95 and @xmath96 correspond to @xmath97 and @xmath98 , respectively , and the other block elements can be deduced .",
    "also the blank indicates a block zero element . using eq .",
    "( 20 ) the schur complement of @xmath99 is given by @xmath100 where @xmath101 is calculated by eq .",
    "( 19 ) and can be transformed using eq .",
    "( 21 ) to a recurrence formula as follows : @xmath102 with the definitions : @xmath103)^{t},\\\\    v_{1,0,1}^{t } & = & a_{0,1}^{-1}(b_{1,0}[b_{0,1}])^{t},\\end{aligned}\\ ] ] and @xmath104)^{t }      \\right).\\\\\\end{aligned}\\ ] ] in eqs .",
    "( 25 ) , ( 26 ) , and ( 27 ) , we used a bra - ket notation [  ] which stands for a part of the block element .",
    "for example , @xmath105 $ ] means a part of @xmath106 which has the same columns as those of @xmath96 .",
    "it is noted that one can obtain a similar expression for @xmath107 as well as eq .",
    "( 24 ) for @xmath101 .    to address a more general case where",
    "the dissection for the sparse matrix is further nested , we suppose that the matrix @xmath95 has the same inner structure as @xmath108 then one may notice the recursive structure in eq .",
    "( 24 ) , and can derive the following set of recurrence relations for general cases : @xmath109)^t     \\right ) ,   \\label{eqn : e20}\\\\\\\\    \\nonumber   & &    v_{p , m+1,n}^{t } =    \\left (      \\begin{array}{c }       v_{p , m,2n}^{t }        \\\\",
    "v_{p , m,2n+1}^{t }        \\\\       0       \\end{array }    \\right )    +    \\left (      \\begin{array}{c }      l_{m,2n}^{t }       \\\\",
    "l_{m,2n+1}^{t }       \\\\",
    "-i      \\end{array }    \\right ) q_{p , m+1,n}^{t}.\\\\    \\label{eqn : e21}\\end{aligned}\\ ] ] equation ( [ eqn : e21 ] ) is the central recurrence formula coupled with eq .",
    "( [ eqn : e20 ] ) , where the initial block elements are given by @xmath110)^{t}.    \\label{eqn : e22}\\end{aligned}\\ ] ] also @xmath111 and @xmath112 can be calculated by @xmath113 a set of eqs .",
    "( [ eqn : e20])-(32 ) enables us to calculate all the inverses of the schur complements @xmath17 and @xmath90 . in the recurrence equations eqs .",
    "( [ eqn : e20 ] ) and ( [ eqn : e21 ] ) , three indices of @xmath114 , @xmath115 , and @xmath116 are involved , and they run as follows : @xmath117 the index @xmath114 denotes the level of hierarchy in the nested dissection and the innermost and outermost levels are set to 0 and @xmath118 , respectively .",
    "then , it is noted that the total system is divided into @xmath119 domains at the innermost level . as well as @xmath114 the index @xmath115 is also related to the level of hierarchy in the nested dissection , and runs from 0 to @xmath120 .",
    "the index @xmath116 is a rather intermediate one , being dependent on @xmath115 .",
    "the indices @xmath116 in eq .",
    "( 30 ) is dependent on @xmath114 and @xmath75 and they run as follows : @xmath121 since the set of the recurrence formulas eqs .",
    "( [ eqn : e20])-(32 ) proceed according to eqs  .(33)-(35 ) , the development of recurrence can be illustrated as in fig .",
    "the recurrence starts from eq .",
    "( 30 ) with @xmath122 , and eqs .",
    "( 31 ) and ( 32 ) follow",
    ". then , @xmath114 is incremented by one , and @xmath123 climbs up to 1 .",
    "the increment of @xmath114 and the climbing of @xmath123 are repeated until @xmath124 and @xmath125 . at @xmath126 for each @xmath114 , @xmath90 and @xmath17",
    "are evaluated by eqs .",
    "( 31 ) and ( 32 ) , and the inverse of @xmath17 is calculated by a conventional method such as lu factorization , which are used in the next recurrence for the higher level of hierarchy . the numbers in the right hand side of fig .  3",
    "give the multiplicity for similar calculations by eq .",
    "( [ eqn : e21 ] ) coming from the index @xmath116 at each @xmath123 , since @xmath116 runs from 0 to @xmath127 as given in eq .  ( 35 ) .",
    "the computational complexity can be estimated by fig .  3 , and we will discuss its details later .    )",
    "-(32 ) , which implies that the recurrence starts from @xmath128 and ends at @xmath129 .",
    "the number in the right hand side is the multiplicity for similar calculations by eq .",
    "( [ eqn : e21 ] ) due to the index @xmath116 at each @xmath123 . , width=321 ]    we are now ready to calculate the selected elements of the green function using the inverses of the schur complements @xmath17 and @xmath90 calculated by the recurrence formulas of eqs .",
    "( [ eqn : e20])-(32 ) . by noting that eq",
    "( 21 ) has a recursive structure and the matrix @xmath64 is structured by the nested dissection , one can derive the following recurrence formula : @xmath130 where @xmath131 the recurrence formula eq .",
    "( 38 ) starts with @xmath132 , adds contributions at @xmath126 for every @xmath114 , and at last yields the inverse of the matrix @xmath64 as @xmath133 . since the calculation of each element for the inverse of @xmath64 can be independently performed , only the selected elements can be computed without calculating all the elements .",
    "the selected elements to be calculated are elements in the block matrices @xmath86 , @xmath88 , and @xmath87 , each of which corresponds to a non - zero overlap matrix as discussed before .",
    "thus , we can easily compute only the selected elements using a table function which stores the position for the non - zero elements in the block matrices @xmath86 , @xmath88 , and @xmath87 .",
    "a simple but nontrivial example is given in appendix a to illustrate how the inverse of matrix is computed by the recurrence formulas , and also a similar way is presented to calculate a few eigenstates around a selected energy in appendix b , while the proposed method can calculate the total energy of system without calculating the eigenstates .      as well as the conventional dft calculations , in the proposed method the chemical potential has to be adjusted so that the number of electrons can be conserved .",
    "however , there is no simpler way to know the number of electrons under a certain chemical potential before the contour integration by eq .",
    "( 8) with the chemical potential .",
    "thus , we search the chemical potential by iterative methods for the charge conservation .",
    "since the contour integration is the time - consuming step in the method , a smaller number of the iterative step directly leads to the faster calculation .",
    "therefore , we develop a careful combination of several iterative methods to minimize the number of the iterative step for sufficient convergence . in general ,",
    "the procedure for searching the chemical potential can be performed by a sequence ( 1)-(2 ) or ( 5)-(1)-(3)-(1)-(4)-(1)-(4)-(1)@xmath134 in terms of the following procedures .",
    "as shown later , the procedure enables us to obtain the chemical potential conserving the number of electrons within @xmath135 electron / system by less than 5 iterations on an average .",
    "\\(1 ) _ calculation of the difference @xmath136 in the total number of electrons_. the difference @xmath137 in the total number of electrons is defined with @xmath138 calculated using eq .",
    "( 8) at a chemical potential @xmath139 by @xmath140 where @xmath141 is the number of electrons that the system should possess for the charge conservation .",
    "if @xmath136 is zero , the chemical potential @xmath142 is the desired one of the system .",
    "\\(2 ) _ using the retarded green function_. if the difference @xmath136 is large enough so that the interpolation schemes ( 3 ) and ( 4 ) can fail to guess a good chemical potential , the next trial chemical potential is estimated by using the retarded green function .",
    "when the chemical potential of @xmath143 is considered , the correction @xmath144 to @xmath137 estimated by the retarded green function is given by @xmath145 where @xmath146 and @xmath147 are defined by @xmath148 with a small number @xmath149 ( 0.01  ev in this study ) and @xmath150 the integration in eq .",
    "( 41 ) is numerically evaluated by a simple quadrature scheme such as trapezoidal rule with a similar number of points as for that of poles in eq .",
    "( 8) , and the integration range can be determined by considering the surviving range of @xmath147 .",
    "the search of @xmath143 is performed by a bisection method until @xmath151 , where @xmath152 is a criterion for the convergence , and @xmath135 electron / system is used in this study .",
    "it should be noted that the evaluation of green function being the time - consuming part can be performed before the bisection method and a set of @xmath146 is stored for computational efficiency .",
    "\\(3 ) _ linear interpolation / extrapolation method_. in searching the chemical potential @xmath30 , if two previous results ( @xmath153 ) and ( @xmath154 ) are available , a trial chemical potential @xmath143 is estimated by a linear interpolation / extrapolation method as : @xmath155    \\(4 ) _ muller method_@xcite . in searching the chemical potential @xmath30 ,",
    "if tree previous results ( @xmath153 ) , ( @xmath154 ) , and ( @xmath156 ) are available , they can be fitted to a quadratic equation : @xmath157 where @xmath67 , @xmath68 , and @xmath158 are found by solving a simultaneous linear equation of @xmath159 in size.@xcite then , @xmath143 giving @xmath160 is a solution of eq .",
    "( 45 ) , and given by @xmath161 the selection of sign is unique because of the condition that the gradient at the solution must be positive , and the branching is taken into account to avoid the round - off error . as the iteration proceeds in search of the chemical potential",
    ", we have a situation that the number of available previous results is more than three . for the case , it is important to select three chemical potentials having smaller @xmath162 _ and _ the different sign of @xmath162 among three chemical potentials , since the guess of @xmath143 can be performed as the interpolation rather than the extrapolation .",
    "\\(5 ) _ extrapolation of chemical potential for the second step_. during the self - consistent field ( scf ) iteration , the chemical potential obtained at the last scf step is used as the initial guess @xmath163 in the current scf step .",
    "in addition , we estimate the second trial chemical potential by fitting results @xmath164 , @xmath165 , and @xmath166 , where the subscript and the superscript in @xmath167 and @xmath168 mean the iteration step in search of the chemical potential and the scf step , respectively , at three previous scf steps to the following equation : @xmath169 where @xmath170 , @xmath171 , and @xmath172 are found by solving a simultaneous linear equation of @xmath159 in size .",
    "then , the chemical potential @xmath173 giving @xmath174 can be estimated by solving eq .  ( 47 ) with respect to @xmath173 as follows : @xmath175 it is found from numerical calculations that eq .",
    "( 48 ) provides a very accurate guess in most cases as the scf calculation converges .    .",
    "some of @xmath176 and @xmath177 in eq .",
    "( 50 ) for a finite 1d chain , a finite 2d square lattice , and a finite 3d cubic lattice described by the @xmath66-valent nntb model .",
    "they depends on @xmath115 or @xmath114 for the 2d and 3d systems in a rather complicated way , while @xmath178 for all the cases .",
    "the unit for each case is given in parenthesis . [ cols=\"<,^,^,^,^,^,^,^,^,^,^,^\",options=\"header \" , ]              e.r .",
    "davidson , in methods in computational molecular physics , vol .",
    "113 of nato advanced study institute , series c : mathematical and physical sciences , edited by g.h.f .",
    "diercksen and s. wilson ( plenum , new york , 1983 ) , p. 95",
    "in a precise sense , we use _ domain _ to mean a system that we are now trying to bisect into two _",
    "subdomains_. in the recursive dissection , we obtain two subdomains after the dissection of the domain .",
    "once we move to each subdomain to perform the next dissection , then the subdomain is called domain in the precise sense . in the text",
    "both the terms are distinguished for cases which may cause confusion .",
    "although the coefficients @xmath67 , @xmath68 , and @xmath158 can be analytically evaluated , the round - off error in the analytically evaluated solution is nonnegligible as @xmath162 converges to zero . in order to avoid the numerical problem ,",
    "we refine @xmath67 , @xmath68 , and @xmath158 by minimizing a function @xmath179 with the analytically evaluated coefficients as initial values .",
    "we find that the coefficients refined by the minimization are much more accurate than the analytic ones for serious cases , and that the refinement is quite effective to avoid the numerical instability .",
    "it is noted that the recurrence formula derived by lin et al . allows us to compute selected elements in o@xmath180 operations for 3d systems,@xcite which is superior to our recurrence formulas .",
    "however , the size of separators in their way for the nested dissection can be larger than that of our separators especially for the case that basis functions overlap with a number of other basis functions like in the pao basis functions , which leads to a large prefactor for the computational cost in spite of the lower scaling .",
    "also , the comparison with the algorithm by takahashi et al.@xcite and erisman and tinney@xcite will be in a future work ."
  ],
  "abstract_text": [
    "<S> an efficient low - order scaling method is presented for large - scale electronic structure calculations based on the density functional theory using localized basis functions , which directly computes selected elements of the density matrix by a contour integration of the green function evaluated with a nested dissection approach for resultant sparse matrices . </S>",
    "<S> the computational effort of the method scales as o(@xmath0 ) , o(@xmath1 ) , and o(@xmath2 ) for one , two , and three dimensional systems , respectively , where @xmath3 is the number of basis functions . unlike o(@xmath3 ) methods developed so far the approach is a numerically exact alternative to conventional o(@xmath4 ) diagonalization schemes in spite of the low - order scaling , and can be applicable to not only insulating but also metallic systems in a single framework . </S>",
    "<S> it is also demonstrated that the nested algorithm and the well separated data structure are suitable for the massively parallel computation , which enables us to extend the applicability of density functional calculations for large - scale systems together with the low - order scaling . </S>"
  ]
}