{
  "article_text": [
    "the use of geometrical methods in the study of dynamical systems ( discrete or continuous ) starts by searching for geometrical structures invariant with respect to the given dynamics .",
    "it turns out the various such structures emerge naturally for classical mechanical systems , as for instance , symplectic or poisson structures , together with various bundle structures .",
    "another geometrical feature that is common to all such systems is the presence of symmetries either because there is a redundant or extra information in the description of the system or because the system possesses an intrinsic invariance . to actually solve them ,",
    "it is necessary in most occasions to use numerical methods .",
    "recently , a new breed of ideas in numerical analysis have come that incorporates the geometry of the systems into the analysis and that allows accurate and robust algorithms with lower spurious effects than the traditional ones ( see @xcite and references therein ) .",
    "our approach employs the theory of discrete mechanics and variational integrators  @xcite to derive an integrator for the dynamics preserving some of the geometry of the original system .",
    "the study of discrete mechanics on lie groupoids was proposed by a.  weinstein in  @xcite .",
    "this setting is general enough to include discrete counterparts of several types of fundamental equations in mechanics as for instance , standard euler - lagrange equations for lagrangians defined on tangent bundles , euler - poincar equations for lagrangians defined on lie algebras , lagrange - poincar equations for lagrangians defined on atiyah bundles , etc .",
    "such discrete counterpart is obtained by discretizing the continuous lagrangian to the corresponding lie groupoid and then applying a discrete variational derivation of the discrete equations of motion .",
    "as simple examples , for a given differentiable manifold @xmath0 , the discrete version of the tangent bundle @xmath1 is the product manifold @xmath2 , equipped with the pair lie groupoid structure ; for a given lie group @xmath3 , the discrete version of its lie algebra @xmath4 is the lie group @xmath3 .",
    "a lie groupoid @xmath3 is a natural generalization of the concept of a lie group , where now not all elements are composable .",
    "the product @xmath5 of two elements is only defined on the set of composable pairs @xmath6 where @xmath7 and @xmath8 are the source and target maps over a base manifold @xmath9 .",
    "moreover , in a lie groupoid we have a set of identities playing a similar role that the identity element in group theory .",
    "the infinitesimal counterpart of the notion of a lie groupoid is the notion of a lie algebroid @xmath10 , in the same way as the infinitesimal counterpart of the notion of a lie group is the notion of a lie algebra , or in other words , the discrete version of a lie algebroid is a lie groupoid .    in @xcite we have elucidated the geometrical framework for discrete mechanics on lie groupoids . in that paper , we found intrinsic expressions for the discrete euler - lagrange equations , and we have introduced the poincar - cartan sections , the discrete legendre transformations and the discrete evolution operator in both the lagrangian and the hamiltonian formalism .",
    "the notion of regularity has been completely characterized and we have proven the symplecticity of the discrete evolution operators . the applicability of these developments has been stated in several interesting examples , in particular for the case of discrete lagrange - poincar equations .",
    "in fact , the general theory of discrete symmetry reduction directly follows from our results .",
    "the main objective of this paper is to obtain local expressions for the different objects appearing in discrete mechanics on lie groupoids . for this proposal ,",
    "it is necessary to introduce symmetric neighborhoods of a lie groupoid .",
    "a symmetric neighborhood is an open neighborhood of one point in the manifold of the identities which is  natural \" with respect to the structure maps of the lie groupoid , in the sense of proposition [ sym ] . using the coordinates associated to a symmetric neighborhood we may write the local expressions of left and right invariant vector fields , @xmath11 and @xmath12 associated to a section @xmath13 of the associated lie algebroid . now , as we have deduced in @xcite , the discrete euler - lagrange equations for a discrete lagrangian @xmath14 are @xmath15 therefore , from this expression ,",
    "we easily obtain the local expression of the discrete euler - lagrange equations associated to a discrete lagrangian @xmath14 , the discrete legendre transformations and we locally characterize the regularity of the discrete problem .",
    "an interesting point is that when using symmetric neighborhoods we are implicitly assuming that the discrete flow is well defined on this neighborhood .",
    "however , this is not the more general situation since , in principle , the point @xmath16 and its image @xmath17 under the discrete flow may be far enough in such a way both are not included in the same symmetric neighborhood . in order to tackle this problem",
    "we will use bisections of the lie groupoid which permits to translate neighborhoods of two composable elements @xmath16 and @xmath17 to a symmetric neighborhood at the identity point @xmath18 .",
    "the organization of the paper is as follows .",
    "in section  2 we recall some constructions and results on discrete mechanics on lie groupoids which will be used in the next sections . in section  3",
    ", we will obtain a local expression of the discrete euler - lagrange equation for a discrete lagrangian function on a symmetric neighborhood in the lie groupoid where it is defined .",
    "in addition we will discuss the existence of local discrete euler - lagrange evolution operators in such a symmetric neighborhood .",
    "moreover , several interesting examples are considered .",
    "the existence of general local discrete euler - lagrange evolution operators is studied in section  4 . for this purpose",
    ", we will use bisections on the lie groupoid .",
    "the paper ends with our conclusions and a description of future research directions .",
    "in this section , we will recall the definition of a lie groupoid and some generalities about them are explained ( for more details , see @xcite ) .",
    "a _ groupoid _ over a set @xmath9 is a set @xmath3 together with the following structural maps :    * a pair of maps @xmath19 , the _ source _ , and @xmath20 , the _",
    "target_. thus , an element @xmath21 is thought as an arrow from @xmath22 to @xmath23 in @xmath9 @xmath24_g}&&&*=0{\\stackrel{\\bullet}{\\mbox{\\tiny $ y=\\beta(g)$}}}}\\ ] ] the maps @xmath25 and @xmath26 define the set of composable pairs @xmath27 * a _ multiplication _ @xmath28 , to be denoted simply by @xmath29 , such that * * @xmath30 and @xmath31 . * * @xmath32 .",
    "+ if @xmath33 is an arrow from @xmath34 to @xmath35 and @xmath36 is an arrow from @xmath37 to @xmath38 then @xmath39 is the composite arrow from @xmath40 to @xmath41 @xmath42_{gh}}{\\ar@/^1pc/@<2ex>[rrr]_g}&&&*=0{\\stackrel{\\bullet}{\\mbox{\\tiny   $ y=\\beta(g)=\\alpha(h)$}}}{\\ar@/^1pc/@<2ex>[rrr]_h}&&&*=0{\\stackrel{\\bullet}{\\mbox{\\tiny   $ z=\\beta(h)=\\beta(gh)$}}}}\\ ] ] * an _ identity map _",
    "@xmath43 , a section of @xmath25 and @xmath26 , such that * * @xmath44 and @xmath45 . * an _ inversion map _",
    "@xmath46 , to be denoted simply by @xmath47 , such that * * @xmath48 and @xmath49 .",
    "+ @xmath50_g}&&&*=0{\\stackrel{\\bullet}{\\mbox{\\tiny   $ y=\\beta(g)=\\alpha(g^{-1})$}}}{\\ar@/^1pc/@<2ex>[lll]_{g^{-1}}}}\\ ] ]    a groupoid @xmath3 over a set @xmath9 will be denoted simply by the symbol @xmath51 .",
    "the groupoid @xmath51 is said to be a _ lie groupoid _ if @xmath3 and @xmath9 are manifolds and all the structural maps are differentiable with @xmath25 and @xmath26 differentiable submersions .",
    "if @xmath51 is a lie groupoid then @xmath52 is a submersion , @xmath53 is an immersion and @xmath54 is a diffeomorphism .",
    "moreover , if @xmath55 , @xmath56 ( resp .",
    ", @xmath57 ) will be said the _ @xmath25-fiber _ ( resp .",
    ", the _ @xmath26-fiber _ ) of @xmath40",
    ".    on the other hand , if @xmath21 then the _ left - translation by @xmath21 _ and the _ right - translation by @xmath33 _ are the diffeomorphisms @xmath58 note that @xmath59 and @xmath60 .",
    "a vector field @xmath61 on @xmath3 is said to be _ left - invariant _ ( resp . , _ right - invariant _ ) if it is tangent to the fibers of @xmath25 ( resp .",
    ", @xmath26 ) and @xmath62 ( resp . , @xmath63 , for @xmath64 .",
    "now , we will recall the definition of the _ lie algebroid associated with @xmath3_.    we consider the vector bundle @xmath65 , whose fiber at a point @xmath55 is @xmath66 .",
    "it is easy to prove that there exists a bijection between the space @xmath67 and the set of left - invariant ( resp .",
    ", right - invariant ) vector fields on @xmath3 . if @xmath68 is a section of @xmath65 , the corresponding left - invariant ( resp .",
    ", right - invariant ) vector field on @xmath3 will be denoted @xmath11 ( resp . , @xmath12 ) , where @xmath69 @xmath70 for @xmath21 . using the above facts",
    ", we may introduce a lie algebroid structure @xmath71 on @xmath72 , which is defined by @xmath73 , \\makebox[.3 cm ] { } \\rho(x)(x ) = ( t_{\\epsilon(x)}\\beta)(x(x)),\\ ] ] for @xmath74 and @xmath55 .",
    "note that @xmath75 , \\makebox[.3 cm ] { } [ \\rvec{x } , \\lvec{y } ] = 0,\\ ] ] @xmath76 ( for more details , see @xcite ) .",
    "let @xmath3 be a lie groupoid with structural maps @xmath77 denote by @xmath78 the lie algebroid of @xmath3 .",
    "a _ discrete lagrangian _ is a function @xmath79 .",
    "fixed @xmath80 , we define the set of admissible sequences with values in @xmath3 : @xmath81 an admissible sequence @xmath82 is a solution of _ the discrete euler - lagrange equations _ if @xmath83 , \\ ; \\ ; \\mbox { for } x_{1 } , \\dots , x_{n-1 } \\in \\gamma(\\tau).\\ ] ] for @xmath84 we obtain that @xmath85 is a solution if @xmath86 for every section @xmath68 of @xmath72 .",
    "given a lagrangian function @xmath79 , we will study the geometrical properties of the discrete euler - lagrange equations .",
    "consider the vector bundle @xmath87 where @xmath88 ( respectively , @xmath89 ) is the vertical bundle of the source map @xmath19 ( respectively , the target map @xmath20 ) .",
    "then , one may introduce a lie algebroid structure on @xmath90 .",
    "the anchor map @xmath91 is given by @xmath92 and the lie bracket @xmath93 on the space @xmath94 is characterized by the following relation @xmath95 for @xmath96 ( see @xcite ) .",
    "now , define the _ poincar - cartan 1-sections _ @xmath97 as follows @xmath98 for each @xmath99 and @xmath100 .",
    "if @xmath101 is the differential of the lie algebroid @xmath102 we have that @xmath103 and so , using @xmath104 it follows that @xmath105 .",
    "this means that there exists a unique 2-section @xmath106 , that will be called the _ poincar - cartan _ 2-section .",
    "this 2-section will be important for studying symplecticity of the discrete euler - lagrange equations .",
    "let @xmath68 be a section of the lie algebroid @xmath65 .",
    "then , one may consider the sections @xmath107 and @xmath108 of the vector bundle @xmath90 given by @xmath109 moreover , if @xmath99 , @xmath110 ( respectively , @xmath111 ) is a local basis of @xmath112 in an open subset @xmath113 ( respectively , @xmath114 ) of @xmath9 such that @xmath115 ( respectively , @xmath116 ) then @xmath117 is a local basis of @xmath118 in @xmath119 and @xmath120 and @xmath121 ( for more details , see @xcite ) .",
    "we say that a differentiable mapping @xmath122 is a _ discrete flow _ or a _ discrete lagrangian evolution operator for @xmath123 _ if it verifies the following properties :    1 .",
    "@xmath124 , that is , @xmath125 , @xmath126 .",
    "@xmath127 is a solution of the discrete euler - lagrange equations , for all @xmath99 , that is , @xmath128 for every section @xmath68 of @xmath72 and every @xmath129      given a discrete lagrangian @xmath130 we define two _ discrete legendre transformations _ @xmath131 and @xmath132 as follows ( see @xcite ) @xmath133 @xmath134    [ r4.4 ] note that @xmath135 and @xmath136 .",
    "furthermore , if @xmath137 ( respectively , @xmath111 ) is a local basis of @xmath112 in an open subset @xmath113 such that @xmath138 ( respectively , @xmath116 ) and @xmath139 ( respectively , @xmath140 ) is the dual basis of @xmath141 it follows that @xmath142      a lagrangian @xmath14 on a lie groupoid @xmath3 is said to be _ regular _ if the poincar - cartan @xmath143-section @xmath144 is symplectic on the lie algebroid @xmath145 , that is , @xmath144 is nondegenerate ( see @xcite ) .",
    "using ( [ omega2 ] ) , we deduce that the lagrangian @xmath123 is regular if and only if for every @xmath99 and every local basis @xmath137 ( respectively , @xmath146 ) of @xmath112 on an open subset @xmath113 ( respectively , @xmath114 ) of @xmath9 such that @xmath147 ( respectively , @xmath148 ) we have that the matrix @xmath149 is regular on @xmath150 .    in @xcite",
    ", we have proved that the following conditions are equivalent :    * @xmath151 is a regular discrete lagrangian function . *",
    "the legendre transformation @xmath152 is a local diffeomorphism . *",
    "the legendre transformation @xmath153 is a local diffeomorphism .    moreover ,",
    "if @xmath154 is regular and @xmath155 is a solution of the discrete euler - lagrange equations for @xmath156 then there exist two open subsets @xmath157 and @xmath158 of @xmath3 , with @xmath159 and @xmath160 and there exists a ( local ) discrete lagrangian evolution operator @xmath161 such that :    * @xmath162 * @xmath163 is a diffeomorphism and * @xmath163 is unique , that is , if @xmath164 is an open subset of @xmath3 , with @xmath165 and @xmath166 is a ( local ) discrete lagrangian evolution operator then @xmath167 .",
    "first , we prove the following result    [ sym ] let @xmath168 be an open subset of @xmath3 and @xmath169 be a point such that @xmath170 . there exists an open subset @xmath171 of @xmath3 with @xmath172 and such that    1 .",
    "@xmath173 and @xmath174 , 2 .",
    "@xmath175 , and 3 .",
    "@xmath176 .    the open subset @xmath177 is said to be a _ symmetric neighborhood _ associated to @xmath168 and @xmath178 .    the multiplication map @xmath179 is continuous , so that we may choose an open subset @xmath180 of @xmath3 such that @xmath181 and @xmath182 .",
    "since the identity map @xmath183 is also continuous , we deduce that there exists an open subset @xmath184 of @xmath9 such that @xmath185 and @xmath186 .",
    "thus , if we consider the open @xmath187 of @xmath3 given by @xmath188 , then it is clear that @xmath189 and moreover it is easy to prove that @xmath190 and @xmath191 , and also @xmath192 .",
    "finally , if we take @xmath193 it follows that @xmath177 satisfies the three above mentioned conditions .      on a symmetric neighborhood of a point",
    "it is easy to get local coordinate expressions for the structure maps of the lie groupoid @xmath3 .",
    "we consider a point @xmath169 and a local coordinate system @xmath194 , defined in a neighborhood @xmath195 of @xmath196 , adapted to the fibration @xmath197 , i.e. if the coordinates of @xmath198 are @xmath199 then the coordinates of @xmath200 are @xmath201 .",
    "we can moreover assume that the identities correspond to elements with coordinates @xmath202 .",
    "the target map @xmath26 defines a local function @xmath203 as follows : if the coordinates of @xmath33 are @xmath194 , then the coordinates of @xmath204 are @xmath205 . note that @xmath206 .",
    "two elements @xmath33 and @xmath36 with coordinates @xmath194 and @xmath207 are composable if and only if @xmath208 . hence local coordinates for @xmath209 are given by @xmath210 .    to obtain a local description for the product , we consider a symmetric neighborhood @xmath177 associated to @xmath178 and @xmath168 .",
    "if two elements @xmath211 with coordinates @xmath194 and @xmath207 respectively , are composable then @xmath208 , and the product @xmath39 has coordinates @xmath212 for some smooth function @xmath213 .",
    "we will write @xmath214 the relation @xmath31 , for @xmath215 , imposes the restriction @xmath216 , i.e. @xmath217 the property @xmath45 , for @xmath218 , is locally equivalent to the equation @xmath219 ; while the property @xmath44 is locally equivalent to the equation @xmath220 .",
    "therefore @xmath221 associativity @xmath222 imposes the further relation @xmath223    in what follows we will use the following functions defined in terms of @xmath205 and @xmath224 , @xmath225 we will also take into account that @xmath226 which follow from  .",
    "the only relevant second order derivatives are given by @xmath227 from the definition of @xmath228 and @xmath229 it follows that @xmath230 on the other hand , if @xmath46 is the inversion we have that @xmath231 and the condition @xmath232 , for all @xmath233 , implies that @xmath234 moreover , using that @xmath235 , we deduce that @xmath236 thus , from ( [ pd and pd2 of p ] ) , we obtain that @xmath237      the local expression for left- and right - translations are easy to obtain .",
    "for @xmath238 the left translation @xmath239 is the map @xmath240 , given by @xmath241 .",
    "if @xmath242 has coordinates @xmath243 , then the elements on the @xmath25-fiber @xmath244 have coordinates of the form @xmath245 , and the coordinates of @xmath246 are @xmath247",
    ". we will write @xmath248 similarly , for @xmath249 the right translation map @xmath250 , is defined by @xmath251 . if @xmath252 has coordinates @xmath243 , then the elements on the @xmath26-fiber @xmath253 have coordinates of the form @xmath194 with the restriction @xmath254 , and the coordinates of @xmath255 are @xmath256",
    ". we will write @xmath257    a left - invariant vector field is of the form @xmath258 for @xmath259 . to obtain a local basis of left - invariant vector fields we can take the local coordinate basis @xmath260 of @xmath261",
    "thus , for @xmath99 with coordinates @xmath194 , we have @xmath262    similarly , a right - invariant vector field can be written in the form @xmath263 for @xmath264 . to obtain a local basis of right - invariant vector fields we first have to look for a basis of the vector space @xmath265 . from the definition of the functions @xmath266",
    ", it follows easily that the vectors @xmath267 are in @xmath268 , and moreover they are related to the vectors @xmath269 by the inversion map , that is @xmath270 .",
    "it follows that a basis of right invariant vector fields is given by @xmath271 where as before @xmath194 are the coordinates for @xmath99 .",
    "note that , from  , we deduce that @xmath272 .",
    "the lie algebroid of @xmath3 is defined on the vector bundle @xmath273 with fiber at the point @xmath274 given by @xmath275 .",
    "a local basis of sections of @xmath276 is given by the coordinate vector fields @xmath277 .",
    "the anchor is the map @xmath278 defined by @xmath279 , where @xmath280 . in local coordinates , if @xmath281 then @xmath282 . the bracket is defined in terms of the bracket of left - invariant vector fields .",
    "a simple calculation shows that @xmath283=c^\\nu_{\\gamma\\mu}\\lvec{e}_\\nu$ ] , with @xmath284 given by  , from where we get @xmath285=c^\\nu_{\\gamma\\mu}e_\\nu$ ] .",
    "consider now a discrete lagrangian function @xmath156 .",
    "a composable pair @xmath215 satisfies the euler - lagrange equations for @xmath156 if @xmath286",
    "if both @xmath33 and @xmath36 are on the same symmetric neighborhood @xmath177 , with coordinates @xmath194 for @xmath33 and @xmath207 for @xmath36 , we can apply the local results above and we readily get the coordinate expression of the euler - lagrange equations @xmath287 where the second equation takes into account that @xmath288 .",
    "assume that we have a solution @xmath289 of the euler - lagrange equations . to analyze the existence of solution of the euler - lagrange equations for elements @xmath215 near @xmath290",
    ", we can apply the implicit function theorem . in the application of such a theorem ,",
    "the relevant matrix @xmath291_{\\gamma,\\mu=1,\\ldots , m}$ ] is the following @xmath292    let @xmath293 be the coordinates of the point @xmath252 .",
    "the following statements are equivalent .    *",
    "the matrix @xmath294 is regular . *",
    "the poincare - cartan 2-section @xmath295 is non - degenerate at the point @xmath252 . *",
    "the map @xmath296 is a local diffeomorphism at @xmath252 .",
    "any of them implies the following : there exist open neighborhoods @xmath297 and @xmath298 of @xmath299 and @xmath300 such that if @xmath301 then there is a unique @xmath302 satisfying that the pair @xmath303 is a solution of the euler - lagrange equations for @xmath123 . in fact , the map @xmath304 is a local discrete euler - lagrange evolution operator .",
    "we first notice that the local expression of the map @xmath305 is @xmath306 the differential of this local function at the point @xmath307 is of the form @xmath308 from where the equivalence of the first and the third assertions immediately follows .    for the second we just take a local basis of sections @xmath309 of @xmath276 , defined in a neighborhood of @xmath178 and associated to the @xmath25-vertical vector fields @xmath310 , and we compute the value of @xmath295 on the associated basis @xmath311 . from and it follows that @xmath312 is regular if and only if the matrix @xmath313 is regular . from the expressions   and",
    "this matrix is @xmath314 it follows from   that the matrix @xmath315 is regular .",
    "thus , we get that the regularity of the matrix @xmath316 is equivalent to the regularity of @xmath312",
    ".    finally , let @xmath317 be the left - hand side of the discrete euler - lagrange equations   once the equation   has been used @xmath318 we want to study the existence of solution of the discrete euler - lagrange equations @xmath319 in a neighborhood of the point @xmath320 , where @xmath194 are the data and @xmath321 is the unknown . applying the implicit function theorem we have to study the regularity of the matrix @xmath322 .",
    "a straightforward calculation shows that this matrix is just @xmath323 from where our last assertion readily follows .",
    "suppose that @xmath324 .",
    "then , @xmath300 has local coordinates @xmath325 .",
    "moreover , from ( [ rho - l - r ] ) and ( [ pd and pd2 of p ] ) , it follows that the matrix @xmath326 is the identity matrix .",
    "therefore , we deduce that the matrix @xmath327 is , up to the sign , the matrix @xmath328 ( see the proof of theorem [ dele - operator1 ] in section [ gde - leo ] ) .    in general the euler - lagrange equations are understood as the equations determining @xmath329 from the already known data @xmath330 , as we did in the proof of the above theorem .",
    "however , we can also try to solve these equations backwards to obtain @xmath194 from @xmath207 .",
    "instead of applying again the implicit function theorem to the system of equations   and we can rewrite the equations in a different coordinate system , adapted to the fibration @xmath26 , as follows . on the open subset @xmath331 we consider the local coordinates @xmath332 defined as @xmath333 , where @xmath54 is the inversion map in the groupoid . since @xmath334 , we have that these new coordinates are adapted to the submersion @xmath26 and we can proceed as in the previous case . in these coordinates , a basis of the left - invariant and right - invariant vector fields",
    "is @xmath335      we present here some illustrative examples .",
    "we consider as a first example the pair ( banal ) groupoid @xmath336 , where the structural maps are @xmath337 the lie algebroid of @xmath3 is isomorphic to the standard lie algebroid @xmath338 , therefore the pair groupoid is considered as the discrete phase space for discretization of lagrangian functions @xmath339 .",
    "let @xmath169 and a local coordinate system @xmath201 defined on a neighborhood @xmath340 of @xmath178 .",
    "then @xmath341 is obviously a symmetric neighborhood . for a fixed @xmath342 , an associated coordinate system adapted to the @xmath25-projection is @xmath343 obviously the identities correspond to the elements @xmath344 in this coordinate system and @xmath345 and @xmath346 . on the other hand , the composition of two elements @xmath347 and @xmath348 is @xmath349",
    ". therefore @xmath350 .",
    "the inversion map is now @xmath351 .",
    "if we take the natural local coordinate basis @xmath352 of @xmath353 then @xmath354 therefore , the discrete euler - lagrange equations are @xmath355 the discrete lagrangian is regular if the matrix @xmath356 is non singular .    as a concrete simple example , consider the continuous lagrangian @xmath357 : @xmath358 ( with @xmath9 a constant symmetric invertible matrix ) .",
    "a typical discretization for the lagrangian is , for instance , @xmath359 then , the discrete euler - lagrange equations are : @xmath360 which leads us the classical implicit midpoint rule .    if on the other hand , we take the discretization @xmath361 then the corresponding discrete euler - lagrange equations are : @xmath362 which is a representation of the strmer - verlet method .",
    "another interesting example corresponds to the case of lie groups . in this case",
    ", we consider a lie group @xmath3 as a groupoid over one point @xmath363 , the identity element of @xmath3 .",
    "the structural maps are @xmath364 the lie algebroid associated with @xmath3 is just the lie algebra @xmath365 of @xmath3 .    near of the identity , it is interesting to regard the elements @xmath99 as small displacements on the lie group . thus , it is possible to express each term through a lie algebra element that can be regarded as the averaged velocity of this displacement .",
    "this is typically accomplished using a retraction map @xmath366 which is an analytic local diffeomorphism around the identity such that @xmath367 , where @xmath368 ( see @xcite ) .",
    "thereby @xmath369 provides a local chart on the lie group .    given a retraction map @xmath369 its right trivialized tangent @xmath370 and is inverse @xmath371 are defined for all @xmath372 as follows @xmath373    the retraction map allows us to transport locally the lie group structure on an open symmetric neighborhood of @xmath3 to a local @xmath369-dependent lie group structure on the lie algebra @xmath4 defined on a local neighborhood @xmath114 of @xmath374 .",
    "we will write @xmath375 for an enough small time step @xmath342 such that @xmath376 .",
    "now , on the lie algebra it is easy to consider local coordinates because it is a vector space . in consequence",
    ", fixing a basis @xmath377 of @xmath4 , we induce coordinates @xmath378 on @xmath4 .    in these coordinates ,",
    "a basis of left- and right - invariant vector fields is @xmath379 where @xmath380 . given a lagrangian @xmath381 , we deduce that the discrete euler - poincar equations are : @xmath382 or , alternatively , as discrete lie - poisson equations : @xmath383 where @xmath384    as an example of retraction map we will consider the cayley transform which is one of the most computationally efficient parametrizations of a lie group .",
    "the cayley map @xmath385 is defined by @xmath386 and is valid for a general class of quadratic groups as for instance @xmath387 , @xmath388 or @xmath389 ( see @xcite ) .",
    "its right trivialized derivative and inverse are given by @xmath390    in this case it is possible to write more explicitly the lie - poincar equations .",
    "in fact , we have that @xmath391 with @xmath392 .",
    "therefore , the discrete euler - poincar equations are : @xmath393-\\frac{h^2}{4}\\eta_ke_{\\gamma}\\eta_k ,   \\frac{\\partial l}{\\partial \\xi}(\\eta_{k})\\rangle\\\\ & & -\\langle e_{\\gamma}+\\frac{h}{2}[e_{\\gamma } , \\eta_{k+1}]-\\frac{h^2}{4}\\eta_{k+1}e_{\\gamma}\\eta_{k+1 } ,   \\frac{\\partial l}{\\partial \\xi}(\\eta_{k+1})\\rangle.\\end{aligned}\\ ] ]    as a concrete example , we consider the case of the group @xmath394 , using the cayley transformation and fixing the standard basis of its lie algebra @xmath395 : @xmath396 thus , the elements @xmath397 , @xmath398 in @xmath4 will have coordinates @xmath399 and @xmath400 , respectively , in this fixed basis .",
    "this allows us to write the previous discrete euler - poincar equations as follows : @xmath401 where @xmath402 is defined by @xmath403 .",
    "the theory of lie groupoids covers other interesting examples that are useful for the construction of variational integrators for different mechanical systems .",
    "this is the case of transformation or action lie groupoids .",
    "let @xmath404 be a lie group and @xmath405 , @xmath406 a right action of @xmath404 on @xmath9 .",
    "consider the lie groupoid @xmath407 over @xmath9 with structural maps given by @xmath408 where @xmath409 is the identity on @xmath404 .",
    "the lie groupoid @xmath3 is called the action or transformation lie groupoid .",
    "its associated lie algebroid is the action algebroid @xmath410 where @xmath411 is the lie algebra of lie group @xmath412 ( see @xcite for details about the lie algebroid structure ) .",
    "we have that @xmath413 .",
    "in particular , if @xmath414 then @xmath415 defines a constant section @xmath416 of @xmath417 : @xmath418 for all @xmath274 .",
    "it is possible to check that the corresponding left- and right - invariant vector fields on @xmath3 are ( see @xcite ) : @xmath419 for @xmath420 and where @xmath421 is the infinitesimal generator of the right action @xmath422 associated with @xmath415 .",
    "let @xmath423 be a discrete lagrangian .",
    "then , a composable pair @xmath424 is a solution of the discrete euler - lagrange equations for @xmath156 if @xmath425 given a retraction map @xmath426 , we can transport the lie group structure on an open symmetric neighborhood of @xmath427 in @xmath412 to an open neighborhood of @xmath428 in @xmath429 as in subsection [ ex - lie ] . moreover , if @xmath169 , we may assume , without loss of generality , that this neighborhood acts on an open neighborhood @xmath113 of the point @xmath169 .",
    "thus if @xmath430 the flow @xmath431 of the fundamental vector field @xmath432 associated with this local action is given by @xmath433 for @xmath434 and @xmath435 .",
    "therefore , as in the previous section , fixed a basis @xmath377 of @xmath411 , we induce a basis of left- and right - invariant vector fields @xmath436 where @xmath437 and @xmath435 .",
    "given a lagrangian @xmath438 , we deduce that the discrete euler - lagrange equations are : @xmath439 where for every @xmath437 ( resp . , @xmath274 ) we denote by @xmath440 ( resp . ,",
    "@xmath441 ) the real function on @xmath9 ( resp . , on @xmath429 ) given by @xmath442 ( resp . ,",
    "@xmath443 ) .    as",
    "a typical example of a discrete system defined on a transformation lie groupoid consider a discretization of the heavy top @xcite .",
    "this system is modelled on the transformation lie algebroid @xmath444 with lagrangian @xmath445 where @xmath446 is the angular velocity , @xmath447 is the direction opposite to the gravity and @xmath448 is a unit vector in the direction from the fixed point to the center of mass , all them expressed in a frame fixed to the body .",
    "the constants @xmath52 , @xmath33 and @xmath101 are respectively the mass of the body , the strength of the gravitational acceleration and the distance from the fixed point to the center of mass .",
    "the matrix @xmath449 is the inertia tensor of the body .",
    "we will also use the cayley transformation on @xmath394 to describe the discrete euler - lagrange equations for the heavy top .",
    "we have that @xmath450 with @xmath451 @xmath377 the standard basis on @xmath394 and @xmath452 .    therefore , the discrete euler - lagrange equations are :    @xmath453    or , in other terms @xmath454 @xmath455 @xmath456 where @xmath457 with @xmath458 , @xmath459 and @xmath460     our approach also admits other interesting examples . for instance , assume that we have a discrete system modeled by a @xmath461 which is an approximation of a continuous lagrangian @xmath462 .",
    "this lagrangian typically appears as reduction of a @xmath3-invariant lagrangian function @xmath463 ( see @xcite , for the general case ) . of course we can combine the techniques exposed in subsections [ ex - banal ] and [ ex - lie ] to obtain a local description of the corresponding discrete euler - lagrange equations in terms of the continuous lagrangian @xmath464",
    "one of the main limitations of the techniques exposed in section [ section : symmetric ] is that we need to work in a neighborhood of the identities of the lie groupoid @xmath3 . using an enough small time stepping",
    "we can guarantee that the evolution of the evolution operator for a discrete lagrangian takes values on the chosen symmetric neighborhood , even it is possible to adapt the time stepping to make it happen .",
    "another possibility is to use the notion of bisections on lie groupoids . as we will see",
    "it will allow us to consider points far from the identities completing our local description of discrete mechanics .",
    "we consider now the general case of a solution @xmath289 of the euler - lagrange equations where the points @xmath242 and @xmath465 are not necessarily close enough to be contained in a common symmetric neighborhood . if we want to obtain a local expression of the discrete euler - lagrange operator which connects the above points , we must choose suitable neighborhoods of @xmath242 and @xmath252 . for this purpose , we will consider a symmetric neighborhood @xmath177 , a local bisection through the point @xmath242 and a local bisection through @xmath252 . by left - translation and right - translation ( induced by these sections ) of @xmath177",
    "we will get such neighborhoods .",
    "the results contained in this section are well - known in the literature ( see , for instance , @xcite ) .",
    "however , to make the paper more self - contained , we will include the proofs of them .",
    "let @xmath51 be a lie groupoid with source @xmath197 and target @xmath466 .",
    "a _ bisection _ of @xmath3 is a closed embedded submanifold @xmath467 of @xmath3 such that the restrictions of both @xmath25 and @xmath26 to @xmath467 are diffeomorphisms .",
    "a bisection defines both a section @xmath468 of @xmath25 and a section @xmath469 of @xmath26 as follows .",
    "given a bisection @xmath467 the map @xmath470 is a smooth section of @xmath25 such that @xmath471 and @xmath472 is a diffeomorphism .",
    "alternatively , the map @xmath473 is a smooth section of @xmath26 such that @xmath474 and @xmath475 is a diffeomorphism .",
    "indeed , since @xmath476 is a diffeomorphism , the map @xmath468 is well defined and satisfies @xmath477 .",
    "moreover @xmath478 and @xmath479 is a diffeomorphism because it is a composition of diffeomorphisms .",
    "the proof of the second statement is similar .",
    "notice that the diffeomorphisms @xmath472 and @xmath475 are each one the inverse of the other @xmath480    a _ local bisection _ of @xmath3 is a closed embedded submanifold @xmath177 of @xmath3 such that there exist open subsets @xmath481 for which both @xmath482 and @xmath483 are diffeomorphisms .    given a local bisection @xmath177 the map @xmath484 is a smooth local section of @xmath25 defined on the open set @xmath168 such that @xmath485 and @xmath486 is a diffeomorphism .",
    "alternatively , the map @xmath487 is a smooth local section of @xmath26 defined on the open set @xmath488 such that @xmath489 and @xmath490 is a diffeomorphism .",
    "the proof is a straightforward modification of the proof for global bisections .",
    "we will need the following straightforward result .",
    "let @xmath491 and @xmath492 be linear subspaces of a finite dimensional vector space @xmath114 , with @xmath493 .",
    "there exists a linear subspace @xmath494 such that @xmath495 and @xmath496 .",
    "let @xmath497 be a basis of @xmath498 .",
    "we complete to a basis @xmath499 of @xmath491 , and we also complete to a basis @xmath500 of @xmath492 . then @xmath501 is a basis of @xmath502 , which can be completed to a basis @xmath503 of @xmath114 . then , the subspace @xmath504 is such that @xmath495 and @xmath496 .    given @xmath99",
    "there exists a local bisection @xmath177 such that @xmath218 .",
    "since the dimensions of @xmath505 and @xmath506 are equal , there exists a subspace @xmath507 such that @xmath508 and @xmath509 .",
    "notice that , since @xmath25 and @xmath26 are submersions , we have that @xmath510 and @xmath511 .",
    "let @xmath512 be any submanifold such that @xmath513 and @xmath514 .",
    "the maps @xmath515 and @xmath516 are linear isomorphisms at the point @xmath33 .",
    "indeed @xmath517 , and similarly @xmath518 , and @xmath519 . by the inverse function theorem",
    ", it follows that there exist open subsets @xmath520 and @xmath521 in @xmath467 and @xmath522 and @xmath523 in @xmath9 such that @xmath524 and @xmath525 and @xmath526 are diffeomorphisms .",
    "by taking @xmath527 , @xmath528 and @xmath529 we have that @xmath177 is a local bisection and @xmath218 .",
    "in what follows we do not distinguish , in the notation , global and local bisections ; all then will be denoted by @xmath467 .    given a local bisection @xmath467 defined on the open sets @xmath168 and @xmath488 , the local _ left translation _",
    "by @xmath467 is the map @xmath530 defined by @xmath531 and the local _ right translation _ by @xmath467 is the map @xmath532 defined by @xmath533    alternatively , the left action is @xmath534 , where @xmath535 is the uniquely defined element such that @xmath536 .",
    "similarly the right action is @xmath537 , where @xmath535 is the uniquely defined element such that @xmath538 .",
    "observe that both @xmath539 and @xmath540 are diffeomorphisms .",
    "it is easy to see that , for a bisection @xmath467 , the left action @xmath539 preserves the @xmath26-fibers and maps @xmath25-fibers to @xmath25-fibers .",
    "similarly , the right action @xmath540 preserves the @xmath25-fibers and maps @xmath26-fibers to @xmath26-fibers .",
    "the left action @xmath539 by a bisection @xmath467 extends the natural left action in the groupoid and we have @xmath541 , or in other words @xmath542 .",
    "moreover , since it preserves the @xmath25-fibers , it maps left - invariant vector fields to left invariant vector fields @xmath543 similarly , we have @xmath544 or @xmath545 , from where @xmath546      let @xmath547 be a discrete lagrangian function and consider a solution @xmath548 of the discrete euler - lagrange equations , that is , @xmath549 we denote by @xmath169 the point @xmath550 then , we consider the following objects :    * a symmetric neighborhood @xmath551 associated with @xmath552 and some open subset @xmath113 of @xmath3 , with local coordinates @xmath347 as in section  [ local - expressions ] .",
    "we will denote by @xmath114 the corresponding open subset of @xmath9 and by @xmath553 the local coordinates on @xmath114 . * a local bisection @xmath554 of @xmath3 such that @xmath555 . * a local bisection @xmath556 of @xmath3 such that @xmath557 .",
    "we will assume , without the loss of generality , that the section @xmath558 ( respectively , @xmath559 ) is defined on the open subset @xmath114 of @xmath9 .",
    "it is clear that @xmath560 is an open neighborhood of @xmath242 in @xmath3 diffeomorphic to @xmath177 .",
    "on @xmath561 we may consider a local coordinate system @xmath347 defined as follows : if @xmath562 then there exists a unique @xmath563 such that @xmath564 ; the coordinates of the point @xmath33 are the coordinates in the symmetric neighborhood @xmath177 of he point @xmath565 .",
    "similarly , @xmath566 is an open neighborhood of @xmath252 in @xmath3 diffeomorphic to @xmath177 .",
    "on @xmath567 we consider local coordinates @xmath568 defined as follows : for @xmath569 we consider the unique point @xmath570 such that @xmath571 , and we assign to @xmath36 the coordinates @xmath207 of @xmath572 in the symmetric neighborhood @xmath177 .",
    "moreover , using the same notation as in section  [ local - expressions ] , the pair of elements @xmath573 is composable if and only if @xmath208 .    to find the local equations satisfied by the coordinates of a solution @xmath574 of the discrete euler - lagrange equations for @xmath156 @xmath575 we take into account equations   and  , from where we get that equations   hold if and only if @xmath576 or , equivalently , @xmath577 in conclusion , using ( [ left - alpha ] ) and ( [ right - alpha ] ) , we have proved    [ local - del ] the pair @xmath578 is a solution of the discrete euler - lagrange equations for @xmath123 if and only if the local coordinates of @xmath33 and @xmath36 @xmath579 satisfy the equations @xmath580    note that the coordinates of @xmath299 and @xmath300 in @xmath581 and @xmath582 , respectively , are @xmath583 .    next , as in section [ implicit - theorem ]",
    ", we will consider the matrix @xmath584 , where @xmath585    then , we have the following result :    [ dele - operator1 ] the following statements are equivalent .    *",
    "the matrix @xmath586 is regular . *",
    "the poincare - cartan 2-section @xmath295 is non - degenerate at the point @xmath252 . *",
    "the map @xmath587 is a local diffeomorphism at @xmath252 .",
    "any of them implies the following : there exist open neighborhoods @xmath588 and @xmath589 of @xmath299 and @xmath300 such that if @xmath590 then there is a unique @xmath591 satisfying that the pair @xmath303 is a solution of the euler - lagrange equations for @xmath123 .",
    "in fact , the map @xmath592 is a local discrete euler - lagrange evolution operator .",
    "if the matrix @xmath593 is regular then , using theorem  [ local - del ] and the implicit function theorem , we deduce the result about the existence of the local discrete euler - lagrange evolution operator @xmath592 .    on the other hand ,",
    "the map @xmath594 is a diffeomorphism from an open neighborhood of @xmath595 in the @xmath25-fiber @xmath596 to an open neighborhood of @xmath300 in the @xmath25-fiber @xmath596 .",
    "indeed , ( a ) it is well defined : if @xmath597 then @xmath598 so that @xmath599 ; ( b ) it is injective : it is the restriction of a local diffeomorphism to an @xmath25-fiber ; and ( c ) it is surjective : @xmath600 is a diffeomorphism , so that if @xmath601 there exists @xmath274 such that @xmath602 , from where @xmath603^{-1}\\in\\alpha^{-1}(x_0)$ ] and hence @xmath604 .    consequently , if @xmath605 then @xmath606 is a basis of the vertical bundle to @xmath25 at the point @xmath300 .",
    "moreover , if @xmath607 is the right - invariant vector field on @xmath582 given by @xmath608 then , using ( [ right - alpha ] ) , it follows that @xmath609 which implies that the matrix @xmath610 is , up to the sign , @xmath611 .",
    "in addition , from   and  , we deduce that the local expression of the restriction of @xmath296 to @xmath582 is @xmath612 these facts prove the result .    now , as in section [ implicit - theorem ] , we consider local coordinates @xmath613 on @xmath614 given by @xmath615 .",
    "note that @xmath616 and , thus , we have local coordinates on @xmath617 and @xmath618 which we also denote by @xmath613 .",
    "as above , using equations   and  , we may prove that a pair @xmath619 is a solution of the discrete euler - lagrange equations for @xmath123 if and only if the local coordinates of @xmath33 and @xmath36 @xmath620 satisfy the equations @xmath621    in order to apply the implicit function theorem ( using  , we want to obtain @xmath622 in terms of @xmath623 and @xmath624 in a neighborhood of @xmath320 ) , we consider the matrix @xmath625 , where @xmath626 then , one may prove the following result .",
    "the following statements are equivalent .",
    "* the matrices @xmath586 and @xmath627 are regular . *",
    "the poincare - cartan 2-section @xmath295 is non - degenerate at the points @xmath242 and @xmath300 .",
    "* the maps @xmath628 and @xmath296 are local diffeomorphism at @xmath299 and  @xmath252 .",
    "any of them implies the following : there exist open neighborhoods @xmath588 and @xmath589 of @xmath299 and @xmath300 and a unique ( local ) discrete euler - lagrange evolution operator @xmath592 such that @xmath629 .",
    "in addition , @xmath630 is a diffeomorphism .",
    "suppose that the matrices @xmath631 and @xmath627 are regular .",
    "then , the existence of the local discrete euler - lagrange evolution operator @xmath632 is guaranteed by theorem [ dele - operator1 ] . moreover , using ( [ e - l2 ] ) , ( [ implicit2 ] ) and the implicit function theorem , we deduce that there exist open neighborhoods of @xmath299 and @xmath300 which we will assume , without the loss of generality , that are @xmath633 and @xmath634 and , in addition , there exists a smooth map @xmath635 such that , for each @xmath636 , the pair @xmath637 is a solution of the discrete euler - lagrange equations for @xmath123 .",
    "thus , from theorem [ dele - operator1 ] , we obtain that @xmath638 which implies that @xmath630 is a diffeomorphism . indeed , if @xmath639 then there is a unique element @xmath36 in @xmath640 , namely @xmath641 , such that @xmath574 is a solution of the discrete euler - lagrange equations for @xmath156 .",
    "this proves   and thus @xmath630 is a diffeomorphism .    on the other hand ,",
    "the map @xmath642 is a diffeomorphism from an open neighborhood of @xmath595 in @xmath643 on an open neighborhood of @xmath299 in @xmath643 . using this fact , , , and proceeding as in the proof of theorem [ dele - operator1 ]",
    ", we deduce the result .",
    "let @xmath14 be a discrete regular lagrangian .",
    "starting with a symmetric neighborhood @xmath551 of the lie groupoid @xmath3 , we have local coordinates expressions for the discrete euler - lagrange equations assuming that we can solve it on the symmetric neighborhood .",
    "if this is not the case , we are forced to use bisections .    to illustrate this ,",
    "assume that @xmath3 is a connected lie group and @xmath551 is a symmetric neighborhood of the identity @xmath644 .",
    "assume that there exists a family of points of @xmath3 : @xmath645 and @xmath646 , with @xmath647 such that @xmath648 ( for instance , if @xmath3 is compact this property is verified ) .",
    "given an initial point @xmath33 , then there exists at least an integer @xmath649 , @xmath650 such that @xmath651 ( @xmath652 is the bisection using our notation ) .",
    "now , we try to find an integer @xmath653 , @xmath654 such that there exits a solution @xmath655 of the following equation defined on the symmetric neighborhood @xmath551 : @xmath656 where @xmath377 is a basis of the lie algebra @xmath4 .",
    "if we find this @xmath653 , @xmath654 , we will say that the pair @xmath215 is a solution of the discrete euler - lagrange equations for @xmath156 .",
    "we will explore in a future paper these techniques working with points not included in symmetric neighborhoods or points not included in the neighborhoods where the retraction maps are local diffeomorphisms .",
    "in this paper we have studied the local description of discrete mechanics . in section [ section :",
    "symmetric ] , we have found a local description of the discrete euler - lagrange equations using the notion of symmetric neighborhood on lie groupoids . in section  [ sec : el - general ] , we extend this construction for points outside of this type of neighborhoods using bisections .",
    "we expect that our results apply to a wide range of numerical methods using discrete variational calculus",
    ".    on the other hand , this paper will also open the possibility to easily adapt our construction to other families of geometric integrators derived from discrete mechanics , as for instance , forced or dissipative systems , holonomic constraints , explicitly time - dependent systems @xcite , frictional contact @xcite nonholonomic constraints @xcite , multisymplectic field theories @xcite , discrete optimal control @xcite ."
  ],
  "abstract_text": [
    "<S> in this paper , we introduce local expressions for discrete mechanics . to apply our results simultaneously to several interesting cases , </S>",
    "<S> we derive these local expressions in the framework of lie groupoids , following the program proposed by alan weinstein in @xcite . to do this </S>",
    "<S> , we will need some results on the geometry of lie groupoids , as , for instance , the construction of symmetric neighborhoods or the existence of local bisections . </S>",
    "<S> these local descriptions will be particular useful for the explicit construction of geometric integrators for mechanical systems ( reduced or not ) , in particular , discrete euler - lagrange equations , discrete euler - poincar equations , discrete lagrange - poincar equations ... the results contained in this paper can be considered as a local version of the study that we have started in @xcite , on the geometry of discrete mechanics on lie groupoids .                dedicated to the memory of j. e. marsden </S>"
  ]
}