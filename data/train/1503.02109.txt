{
  "article_text": [
    "let @xmath5 denote the ring of symmetric polynomials in the countably many indeterminates @xmath6 with coefficients in the field @xmath7 of rational functions in two variables .",
    "the _ ( transformed ) macdonald polynomials _",
    "@xmath8 , indexed by the set of all partitions @xmath2 , form an orthogonal basis of @xmath5 , and have specializations @xmath9 and @xmath10 , where @xmath11 and @xmath12 are the homogeneous and elementary symmetric functions , respectively .",
    "the polynomials @xmath13 are a transformation of the functions @xmath14 originally defined by macdonald in @xcite , and have been the subject of much recent attention in combinatorics and algebraic geometry .",
    "( see @xcite , @xcite , and @xcite , for instance . )    the symmetric functions @xmath13 may be defined as the unique collection of polynomials that satisfy certain triangularity conditions . to state them ,",
    "recall that the schur functions @xmath15 form a basis for @xmath16 .",
    "define the _ dominance order _ to be the partial order @xmath17 on partitions given by @xmath18 if and only if @xmath19 for all @xmath20 .",
    "finally , define @xmath21 to be the conjugate of a given partition @xmath2 , formed by reflecting its young diagram about the diagonal .",
    "the symmetric functions @xmath22 are the unique elements of @xmath5 satisfying :    * @xmath23\\in{\\mathbb{q}}(q , t)\\{s_\\lambda:\\lambda\\ge \\mu\\}$ ] * @xmath24\\in{\\mathbb{q}}(q , t)\\{s_\\lambda:\\lambda\\ge \\mu^\\ast\\}$ ] * @xmath25=1 $ ]    above , the notation @xmath26 means that we substitute for the variables @xmath27 the monomials @xmath28 .",
    "the macdonald polynomials @xmath13 are orthogonal with respect to the inner product on @xmath29 defined by @xmath30\\right\\rangle,\\ ] ] where the inner product on the right is the classical hall inner product .",
    "that is , @xmath31 whenever @xmath32 .",
    "( see @xcite for details . )",
    "recall the well - known schur expansion @xmath33 where the coefficients @xmath34 are the _ kostka numbers _",
    ", defined combinatorially as the number of semistandard young tableaux with shape @xmath35 and content @xmath2 . since @xmath36 , it is natural to define a @xmath37-analog of the kostka numbers by expanding the transformed macdonald polynomials @xmath38 in terms of the schur basis .",
    "@xmath37-kostka polynomials _ are the coefficients in the expansion @xmath39    it was conjectured by macdonald , and later proven by haiman @xcite , that the @xmath37-kostka polynomials @xmath40 are polynomials in @xmath41 and @xmath42 with nonnegative integer coefficients .",
    "this fact is known as the _ macdonald positivity conjecture_. haiman s proof involves showing that the polynomial @xmath40 is the hilbert series of a certain bi - graded module arising from the geometry of the hilbert scheme of @xmath43 points in the plane , and relies heavily on geometric methods .",
    "the problem of finding a purely combinatorial explanation of their positivity is still open , in the sense that there is no known formula for the coefficients of the form @xmath44 , where @xmath45 ranges over an appropriate set of young tableaux and @xmath46 and @xmath47 are some combinatorial statistics .",
    "however , a different combinatorial formula for the transformed macdonald polynomials @xmath48 has been found , and appeared in the literature in @xcite in 2004 .",
    "the authors prove that @xmath49 where the sum ranges over all fillings @xmath50 of the diagram of @xmath2 with positive integers , and @xmath51 is the monomial @xmath52 where @xmath53 is the number of times the letter @xmath54 occurs in @xmath50 .",
    "the statistics @xmath55 and @xmath56 are generalizations of the mahonian statistics @xmath55 and @xmath56 for permutations .",
    "their precise definitions can be stated as follows .",
    "given a word @xmath57 where the letters @xmath58 are taken from some totally ordered alphabet @xmath59 , a _ descent _",
    "of @xmath60 is an index @xmath54 for which @xmath61 .",
    "the _ major index _ of @xmath60 , denoted @xmath62 , is the sum of the descents of @xmath60 .    given a filling @xmath50 of a young diagram of shape @xmath2 drawn in french notation , let @xmath63 be the words formed by the successive columns of @xmath50 , read from top to bottom . then @xmath64    the major index of the filling in figure [ examplefilling ] is @xmath65 , since the first column has major index @xmath66 , the second has major index @xmath67 , and the third column , @xmath68 .     a filling of a young diagram .",
    "descents are shown in boldface , and attacking pairs are connected with a gray line . ]",
    "the major index restricts to the usual major index on words in the case that the partition is a single column .    for the statistic @xmath55 , we start with the definition provided in @xcite .",
    "we use the notion of the _ arm _ of an entry , which is defined to be the number of squares strictly to the right of the entry .",
    "descent _ is an entry which is strictly greater than the entry just below it .",
    "an _ attacking pair _ in a filling @xmath50 of a young diagram is a pair of entries @xmath69 and @xmath70 with @xmath71 satisfying one of the following conditions :    1 .",
    "@xmath69 and @xmath70 are in the same row , with @xmath69 to the left of @xmath70 , or 2 .",
    "@xmath69 is in the row above @xmath70 and strictly to its right .    the quantity @xmath72 is defined to be the number of attacking pairs in @xmath50 minus the sum of the arms of the descents .",
    "in figure [ examplefilling ] , there are @xmath73 attacking pairs , and the arms of the descents have lengths @xmath67 , @xmath74 , and @xmath67 .",
    "thus @xmath75 in this case .    for our purposes , we will also need the following cleaner definition of the @xmath55 statistic .",
    "this more closely resembles the @xmath55 statistic on a permutation @xmath76 , defined to be the number of pairs @xmath77 for which @xmath78 .",
    "let @xmath50 be any filling of a young diagram with letters from a totally ordered alphabet @xmath59 , allowing repeated letters .",
    "a _ relative inversion _ of a filling @xmath50 of a young diagram is a pair of entries @xmath69 and @xmath70 in the same row , with @xmath69 to the left of @xmath70 , such that if @xmath79 is the entry directly below @xmath69 , one of the following conditions is satisfied :    * @xmath80 and @xmath79 is between @xmath69 and @xmath70 in size , in particular @xmath81 .",
    "* @xmath71 and @xmath79 is not between @xmath69 and @xmath70 in size , in particular either @xmath82 or @xmath83 ,    if @xmath69 and @xmath70 are on the bottom row , we treat @xmath79 as any value less than @xmath84 , usually @xmath67 in the case @xmath85 .",
    "the conditions above for the triple @xmath86 to form an inversion can also be thought of as saying that the ordering of the sizes of @xmath87 orients the triple counterclockwise : either @xmath82 , @xmath83 , or @xmath81 .",
    "in figure [ examplefilling ] , there are 2 relative inversions : @xmath88 in the bottom row , and @xmath89 in the second row .",
    "in fact , the number of relative inversions in a filling @xmath50 is always equal to @xmath72 . in @xcite ,",
    "the authors introduce the related notion of an _ inversion triple_. relative inversions are simply the inversion triples that contribute @xmath68 to @xmath72 .",
    "the description in terms of relative inversions allows us to think of the @xmath55 as being computed row by row ( just as @xmath56 is computed column by column ) .    for completeness , we include here a proof that @xmath72 is equal to the number of relative inversions of @xmath50 .",
    "[ inversions ] the quantity @xmath72 is equal to the number of relative inversions of @xmath50 .",
    "recall that @xmath72 is defined as the total number of attacking pairs minus the arms of the descents .",
    "each descent of the form @xmath90 where @xmath79 is the entry directly below @xmath69 contributes @xmath91 towards @xmath72 for each @xmath70 to the right of @xmath69 in the same row .",
    "call such pairs @xmath92 _ descent - arm pairs_. each attacking pair contributes @xmath93 towards @xmath72 .",
    "define a _ good triple _ to be a triple of entries @xmath86 where @xmath69 is directly above and adjacent to @xmath79 and @xmath70 is to the right of @xmath69 in its row , where we also allow @xmath79 to be directly below the entire tableau with a value of @xmath67 .",
    "then each descent - arm pair or attacking pair is a member of a unique good triple , and contributes @xmath91 or @xmath93 , respectively , to @xmath72 .",
    "therefore , @xmath72 is the sum of the contributions of all such pairs in each such triple .",
    "a simple case analysis shows that each good triple contributes a total of @xmath68 if it is a relative inversion and @xmath67 otherwise .",
    "thus @xmath72 is the total number of relative inversions .",
    "since this combinatorial formula for @xmath38 is an expansion in terms of monomials rather than schur functions , it does not give an immediate answer to the macdonald positivity conjecture .",
    "indeed , it perhaps raises more questions than it answers . for one , there is a well - known @xmath37-symmetry relation for the transformed macdonald polynomials @xmath38 , namely @xmath94 this is obvious from the triangularity conditions that define @xmath95 , and is also clear from haiman s geometric interpretation @xcite .",
    "when combined with the combinatorial formula , however , we obtain a remarkable generating function identity : @xmath96    setting @xmath4 and @xmath97 and taking the coefficient of @xmath98 on both sides , this reduces to the well - known equation @xmath99 which demonstrates the equidistribution of the mahonian statistics @xmath55 and @xmath56 on permutations .",
    "there are several known bijective proofs of this identity ( see @xcite , @xcite , @xcite ) .    in light of this",
    ", it is natural to ask if there is an elementary combinatorial proof of ( [ symmetryeqn ] ) , in the sense of conjecture [ invmaj ] below .",
    "the _ content _ of a filling @xmath50 , denoted @xmath100 , is the sequence @xmath101 where @xmath102 is the number of @xmath54 s used in the filling .",
    "we also define the symbols :    * @xmath103 - set of all fillings of young diagrams with positive integers * @xmath104 - set of fillings of shape @xmath2 and content @xmath105 * @xmath106 - set of fillings @xmath107 for which @xmath108 and @xmath109 .",
    "we also define a _ weighted set _ to be a set @xmath110 equipped with a number of statistics @xmath111 , and a _ morphism of weighted sets _ to be a map that preserves their statistics .",
    "we write @xmath112 to denote the weighted set if the statistics are not understood .",
    "[ invmaj ] there is a natural isomorphism of weighted sets @xmath113 which interchanges @xmath55 and @xmath56 and sends a partition shape to its conjugate .",
    "that is , for any @xmath114 , the map @xmath115 restricts to a bijection @xmath116    in @xcite , the authors give a combinatorial proof of the fact that the polynomials @xmath48 are symmetric in the variables @xmath117 .",
    "we will make use of this fact repeatedly , rearranging the entries of @xmath105 as needed .",
    "in other words , to prove conjecture [ invmaj ] , it suffices to find a map @xmath115 that restricts to bijections @xmath118 where @xmath46 is some bijective map that rearranges the entries of @xmath105 .",
    "in this paper , we provide explicit bijections @xmath115 for several infinite families of values of @xmath119 , @xmath79 , @xmath105 , and @xmath2 .",
    "our bijections naturally extend carlitz s bijection on permutations , which is defined in section [ carlitz ] . in section [ t=1 ]",
    "we proceed to give a combinatorial proof of the symmetry relation for the specialization @xmath4 , and in section [ hookshapes ] , we give an explicit bijection @xmath115 in the case that @xmath2 is a hook shape .    the bulk of our results are developed in section [ q=0 ] . here",
    "we investigate the hall - littlewood specialization @xmath120 , which corresponds to setting @xmath1 in the macdonald polynomials . we give a combinatorial proof in this case for all shapes @xmath2 having at most three rows , and also for all shapes @xmath2 when the content @xmath105 is fixed to be @xmath121 .",
    "we also conjecture a strategy for the general problem that draws on the work of garsia and procesi on the @xmath122-modules @xmath123 , which arise as the cohomology rings of the springer fibers in type a. @xcite    in section [ applications ] , we state some applications of the results on the hall - littlewood case to understanding the rings @xmath123 , in particular regarding the _ cocharge _ statistic of lascoux and schutzenberger ( see @xcite or @xcite , for instance ) . in particular , we demonstrate a new recursive structure exhibited by the cocharge statistic on words .",
    "particularly technical proofs of results throughout the paper are deferred to section [ proofs ] .",
    "our approach to the symmetry problem is motivated by carlitz s bijection @xmath124 , an alternative to the better - known foata bijection that demonstrates the equidistribution of @xmath55 and @xmath56 on permutations .",
    "a full proof of this bijection can be found in carlitz s original paper @xcite , or in a somewhat cleaner form in @xcite .",
    "for the reader s convenience we will define it here .",
    "the bijection makes use of certain _ codes _ :",
    "a _ carlitz code _ of length @xmath43 is a word @xmath57 consisting of nonnegative integers such that @xmath125 for all @xmath54 .",
    "let @xmath126 denote the set of all carlitz codes of length @xmath43 , equipped with the combinatorial statistic @xmath127 taking a word to the sum of its entries .",
    "notice that the number of carlitz codes of length @xmath43 is equal to @xmath128 .",
    "this allows us to make use of the combinatorial object @xmath129 of carlitz codes as an intermediate object connecting @xmath130 to @xmath131 .",
    "in particular , the carlitz bijection is the composite    ( s_n ; ) & ^ & ( c_n ; ) & ^^-1 & ( s_n ; )    of two simple isomorphisms of weighted sets , defined as follows .",
    "the _ inversion code _ of a permutation @xmath76 , denoted @xmath132 , is the sequence @xmath133 where @xmath134 is the number of inversions of the form @xmath135 in @xmath76 , i.e. where @xmath77 and @xmath54 is to the right of @xmath136 .",
    "we have @xmath137 , because the @xmath68 is the smaller entry of one inversion @xmath138 , the @xmath74 is the smaller entry of the two inversions @xmath139 and @xmath140 , the @xmath141 is the smaller entry of the inversion @xmath142 , and the @xmath73 is not the smaller entry of any inversion .",
    "clearly @xmath143 is a map @xmath144 , and it is not hard to see that it is bijective : given a carlitz code @xmath145 , we can reconstruct the permutation @xmath76 it came from as follows .",
    "first write down the number @xmath43 , corresponding to @xmath146 . then , @xmath147 is either @xmath67 or @xmath68 , and respectively determines whether to write down @xmath148 to the left or to the right of the @xmath43 .",
    "the entry @xmath149 then determines where to insert @xmath150 in the sequence , and so on until we have reconstructed @xmath76 .",
    "it is also clear that @xmath143 is an isomorphism of weighted sets , sending @xmath151 to @xmath152 .",
    "the map @xmath153 is defined as follows . given @xmath154 written as a permutation in word form , remove the @xmath43 from @xmath76 and set @xmath155 to be the amount the major index decreases as a result . then remove the @xmath148 and set @xmath156 to be the amount the major index decreases by , and so on until we have formed a sequence @xmath133 .",
    "then we define @xmath157 .",
    "let @xmath158 .",
    "its major index is @xmath159 . removing the @xmath73 results in the permutation @xmath160 , which has major index @xmath141 ,",
    "so the major index has decreased by @xmath68 and we set @xmath161 . removing the @xmath141 results in @xmath162 , which decreased the major index by @xmath74 .",
    "hence @xmath163 . removing the @xmath74 decreases the major index by @xmath164 , and removing the @xmath68 decreases it by @xmath165 , so @xmath166 .    as in the case of @xmath143",
    "above , it is not hard to construct an inverse for @xmath167 , making it an isomorphism of weighted sets @xmath168 .",
    "the _ carlitz bijection _ is the isomorphism @xmath169    we have @xmath170 by the examples above .",
    "notice that the carlitz bijection gives rise to a bijection @xmath171 satisfying conjecture [ invmaj ] for one - column shapes @xmath172 having content @xmath173 .",
    "indeed , @xmath174 for any filling @xmath50 of a one - column shape @xmath2 , and @xmath175 for any filling @xmath176 of its one - row conjugate @xmath21 .",
    "since @xmath177 and @xmath178 in this case are the same as @xmath56 and @xmath55 of their reading words , this determines a bijection for distinct entries ( @xmath173 . )",
    "we now generalize the carlitz bijection to words , i.e. fillings with _ any _",
    "content @xmath105 for one - column shapes @xmath2 .",
    "[ aweaklyincreasing ] let @xmath179 be any finite multiset of size @xmath43 , with an ordering `` @xmath180 '' such that @xmath181 , and let @xmath2 be a partition of @xmath43 .",
    "we say that a word @xmath182 of length @xmath43 is _",
    "@xmath59-weakly increasing _ if every subword of the form @xmath183 is weakly increasing .    for instance",
    ", if @xmath184 , ordered by magnitude , then the word @xmath185 is @xmath59-weakly increasing , since the subwords @xmath186 , @xmath65 , @xmath187 , and @xmath188 , corresponding to each letter of @xmath59 , are weakly increasing .",
    "we also will make use of macdonald symmetry in the variables @xmath117 by defining a weight - preserving bijection on alphabets .",
    "[ reverse ] the _ reverse _ of the content @xmath189 is the tuple @xmath190 in terms of alphabets , let @xmath59 be a finite multiset of positive integers with maximum element @xmath191 .",
    "the _ content _ of @xmath59 is @xmath105 if @xmath102 is the multiplicity of @xmath54 in @xmath59 .",
    "complement _ of @xmath59 , denoted @xmath192 , is the multiset consisting of the elements",
    "@xmath193 for all @xmath194 .",
    "notice that the content of @xmath192 is @xmath195 .",
    "for instance , the complement of the multiset @xmath196 is @xmath197 and correspondingly , @xmath198 .",
    "we generalize carlitz s codes as follows .",
    "let @xmath199 denote the subset of @xmath126 consisting of all carlitz codes of length @xmath43 which are @xmath59-weakly increasing .",
    "this subset inherits the @xmath127 statistic from @xmath126 .",
    "we now can define bijections @xmath200 and @xmath201    let @xmath60 be a word consisting of the letters in the ordered alphabet @xmath202 ( corresponding to a filling of a horizontal shape ) , with ties among the letters broken in the order they appear in @xmath60 .",
    "the _ inversion code _ of @xmath60 is the code @xmath203 where @xmath134 is the number of inversions having @xmath204 as the smaller entry of the inversion .",
    "for example , the inversion code of the filling        is @xmath205 , since the @xmath68 is the smaller entry of @xmath141 inversions , the first @xmath74 is the smaller entry of @xmath68 inversion , the second @xmath74 is the smaller entry of @xmath74 inversions , and so on .",
    "the map @xmath143 is an isomorphism of weighted sets @xmath206    the above proposition will be implied by proposition [ invcode ] , and so we omit the proof .    to define the map @xmath167 , we first require a standardization rule for fillings of columns .    let @xmath50 be any filling of a column of height @xmath43 with positive integers . we define the * standardization labeling * on repeated entries as follows .    1 .",
    "let @xmath54 be a letter that occurs @xmath207 times in @xmath50 .",
    "remove any entries larger than @xmath54 to form a smaller column @xmath208 .",
    "2 .   find the bottommost @xmath54 that is either on the very bottom of @xmath208 or has entries @xmath119 and @xmath79 above and below it with @xmath209 .",
    "assign this @xmath54 a label of @xmath207 and remove it .",
    "repeat this process , labeling the next @xmath54 by @xmath210 and so on , until there are no @xmath54 s left that satisfy this condition .",
    "3 .   finally , remove and label any remaining @xmath54 s in order from top to bottom , decreasing the label by one each time .",
    "we define @xmath211 is the unique column filling using labels @xmath212 that respects the ordering of the entries of @xmath50 and breaks ties according to the standardization labeling .",
    "[ onecolumnstandardize ] for any column filling @xmath50 with alphabet @xmath59 , let @xmath213 .",
    "then @xmath176 and @xmath50 have the same major index , and @xmath214 is @xmath59-weakly increasing .",
    "we defer the proof to section [ proofs ] .",
    "the key step is the following technical lemma .",
    "define a _ consecutive block _ of @xmath43 s in a filling to be a maximal consecutive run of entries in a column which are all filled with the letter @xmath43 .",
    "[ duplicates ] given a filling of a one - column shape @xmath215 and largest entry @xmath43 , there is a unique way of ordering the @xmath43 s in the filling , say @xmath216 , such that the following two conditions are satisfied .    1",
    ".   any consecutive block of @xmath43 s in the column appears in the sequence in order from bottom to top , and 2 .",
    "if we remove @xmath216 in that order , and let @xmath217 be the amount that the major index of the column decreases at the @xmath54th step , then the sequence @xmath218 is weakly increasing .",
    "we now can define the map @xmath167 on words , that is , for one - column fillings .",
    "let @xmath50 be any filling of a column shape @xmath215 .",
    "we define @xmath219 , where @xmath167 of a standard filling is defined to be the @xmath167 of its reading word ( which is a permutation ) .",
    "let @xmath50 be the one - column filling whose reading word is @xmath220 , the standardization labeling on the @xmath66 s is shown by the subscripts : @xmath221    since this one - column shape has size @xmath188 , the filling @xmath211 will have the @xmath66 s relabeled as the numbers from @xmath222 to @xmath188 according to the subscripts above : @xmath223    we then remove the @xmath224 in order .",
    "this results in a sequence of difference values @xmath225 , which is weakly increasing .",
    "we are left with a column with reading word @xmath226 , in which there is only one @xmath227 , so @xmath228 changes that to a @xmath65 .",
    "we remove this to obtain a difference of @xmath68 in the major index .",
    "we are left with @xmath229 , in which the @xmath73 s are standardized as follows : @xmath230 removing these in order from @xmath66 down to @xmath68 decreases the major index by @xmath231 , respectively .",
    "therefore , @xmath232 note that this sequence is @xmath233-weakly increasing .",
    "the map @xmath167 is a weighted set isomorphism @xmath234 for any alphabet @xmath59 with content @xmath105 , and any one - column partition shape @xmath235 .",
    "carlitz s work shows that @xmath167 is an isomorphism in the case that @xmath173 , i.e. @xmath59 has one of each letter from @xmath68 to @xmath43 . in the case of repeated entries",
    ", we note that @xmath167 is still injective . indeed , given a code corresponding to a filling",
    ", there is a unique place to insert the next number at each step - by applying the @xmath228 map , using carlitz s bijection , and then un - standardizing in the unique way so that the order of entries is preserved and the resulting alphabet is @xmath59 .",
    "now , notice that by our definition of @xmath167 and lemma [ duplicates ] , the codes we get are @xmath59-weakly increasing .",
    "we claim that they are also carlitz codes : at the @xmath54th step , there are @xmath236 letters remaining , and the difference @xmath217 is either the position of the letter we re removing plus the number of descents strictly below it , or the number of descents weakly below it .",
    "therefore , the maximum value of @xmath217 is @xmath236 , and so @xmath237 is a carlitz code and is @xmath59-weakly increasing .",
    "it follows that @xmath167 is an injective morphism of weighted sets @xmath238 .",
    "finally , notice that the two sets have the same cardinality : each has cardinality @xmath239 where @xmath105 is the content of the alphabet @xmath59 .",
    "it follows that @xmath167 is bijective , as desired .",
    "in this section , we give a combinatorial proof of the specialization of conjecture [ invmaj ] at @xmath4 , namely @xmath240 .    by the combinatorial formula in @xcite",
    ", it suffices to prove that , for any content @xmath105 , @xmath241    to prove this , we build on the carlitz bijection , defined in section [ carlitz ] .",
    "let @xmath242 be the carlitz bijection on permutations of a given ordered alphabet with @xmath43 distinct entries .",
    "we first prove equation [ onlyq ] in the case that @xmath173 .",
    "[ cyclic ] we say that a sequence of numbers @xmath243 are in _ cyclic order _",
    "if there exists an index @xmath244 $ ] for which @xmath245    [ distinct ] for any fixed partition @xmath35 , we have @xmath246 where the first sum ranges over all fillings @xmath247 of @xmath35 with distinct entries , and the second ranges over all fillings @xmath248 of the conjugate partition @xmath249 with distinct entries",
    ".    we extend the bijection @xmath250 as follows .",
    "given a filling @xmath50 of @xmath35 , let @xmath251 be the words formed by reading each of the columns of @xmath35 from top to bottom .",
    "let @xmath252 for each @xmath54 , so that @xmath253 .",
    "notice that @xmath254 .",
    "we aim to construct a filling @xmath176 of @xmath255 such that @xmath256 .",
    "let the bottom row of @xmath176 be @xmath257 . to construct the second row ,",
    "let @xmath258 be the corner letter .",
    "let @xmath259 be the unique ordering of the letters of @xmath260 for which the sequence @xmath261 is in cyclic order .",
    "notice that if @xmath117 is placed in the square above @xmath42 , it would be part of exactly @xmath54 relative inversions to the right of it , since @xmath262 would form inversions with it and the others would not .",
    "now , in @xmath260 , let @xmath263 be the number of inversions whose left element is the @xmath207th letter of @xmath260 . then write @xmath264 in the square above @xmath265 in order to preserve the number of inversions the first letter is a part of .",
    "then for the square above @xmath266 , similarly order the remaining @xmath267 s besides @xmath264 in cyclic order after @xmath268 , and write down in this square the unique such @xmath269 for which it is the left element of exactly @xmath270 inversions in its row .",
    "continue this process for each @xmath271 to form the second row of the tableau .",
    "continue this process on each subsequent row , using the words @xmath272 , to form a tableau @xmath176 .",
    "we define @xmath273 , and it is easy to see that this construction process is reversible ( strip off the top row and rearrange according to inversion numbers , then strip off the second , and so on . )",
    "thus we have extended the carlitz bijection to tableaux of content @xmath173 , proving the result in this case .",
    "this proof did not depend on any aspect of the bijection other than the fact that it preserves the statistics .",
    "thus @xmath250 can be replaced by , say , the foata bijection @xcite and the entire proof is still valid .    using this proposition , we prove two technical lemmata about the @xmath41-series involved .",
    "define @xmath274 to be the number of relative inversions in a row @xmath275 given a filling @xmath60 of the row directly beneath it .",
    "[ technical1 ] let @xmath275 be the @xmath276st row in a partition diagram @xmath35 for some @xmath277 .",
    "let @xmath278 be a fixed filling of the @xmath54th row , underneath @xmath275 .",
    "let @xmath279 be any @xmath280 distinct positive integers .",
    "then @xmath281 where the sum ranges over all fillings of the row @xmath275 with the integers @xmath279 in some order .",
    "we know that @xmath282 we use a similar process to that in proposition [ distinct ] to construct a bijection @xmath171 from the set of permutations @xmath46 of @xmath279 to itself such that @xmath283 .",
    "namely , let @xmath284 be a permutation of @xmath285 and let @xmath263 be the number of inversions that @xmath286 is a part of in @xmath46 for each @xmath207 .",
    "let @xmath287 be the ordering of the letters of @xmath46 for which @xmath288 is in cyclic order .",
    "let the first letter of @xmath289 be @xmath264 , remove @xmath264 from the sequence , and repeat the process to form the entire row from the letters of @xmath46 .",
    "let @xmath289 be this row .",
    "the map @xmath171 can be reversed by using the the all-@xmath67 s word for @xmath60 and using the same process as above to recover @xmath46 from @xmath289 .",
    "thus @xmath171 is bijective .",
    "moreover @xmath283 by construction .",
    "this completes the proof .",
    "[ technical2 ] let @xmath46 be the @xmath290st row in a partition diagram @xmath35 for some @xmath277 .",
    "let @xmath278 be a fixed filling of the row directly underneath @xmath46 .",
    "let @xmath279 be positive integers , with multiplicities @xmath291 .",
    "then @xmath292 where the sum ranges over all distinct fillings of the row @xmath46 with the integers @xmath279 in some order .    multiplying both sides of the relation by @xmath293 , we wish to show that @xmath294 this follows immediately by interpreting @xmath295 and each @xmath296 as in lemma [ technical1 ] , and assigning all possible orderings to the repeated elements and counting the total number of relative inversions in each case .",
    "we are now ready to prove equation [ onlyq ] .",
    "we have @xmath297    we break down each sum according to the contents of the columns of @xmath2 and the rows of @xmath21 , respectively . for a given multiset of contents of the columns , where the entries in the @xmath54th column have multiplicities @xmath298 , we have that @xmath299 where the sum ranges over all fillings @xmath50 with the given column entries . by lemma [ technical2 ]",
    ", we have that the corresponding sum over fillings @xmath176 with the given contents in the rows of @xmath21 is the same : @xmath300    summing over all possible choices of the entries from @xmath105 for each column of @xmath2 , the result follows .",
    "we now demonstrate a bijective proof of conjecture [ invmaj ] in the case that @xmath2 is a _ hook shape _ , that is , @xmath301 for some @xmath302 .",
    "there is a known combinatorial formula for the @xmath37-kostka poloynomials in the case of hook shapes @xmath2 given by stembridge @xcite , but it does not involve the @xmath55 and @xmath56 statistics .",
    "the symmetry of @xmath55 and @xmath56 was demonstrated for fillings of hook shapes having _ distinct _ entries in @xcite , and makes use of the foata bijection . in this section",
    ", we instead use the carlitz bijection to prove the result , which will hold for arbitrary fillings by the results in section [ carlitzwords ] .",
    "[ leftzero ] we have the following two facts about one - column and one - row shapes respectively .",
    "* given a filling @xmath50 of a one - column shape , suppose @xmath303 is the alphabet of its entries written in the standardization order as in proposition [ onecolumnstandardize ] , from greatest to least .",
    "then if @xmath204 is the bottommost entry in @xmath50 , then the first @xmath67 in @xmath304 is in position @xmath54 from the left . * given a filling @xmath176 of a one - row shape , suppose @xmath202 is the alphabet of its entries written in order with ties broken in reading order",
    ". then if @xmath204 is the leftmost entry in @xmath50 , then the first @xmath67 in @xmath305 is in position @xmath54 from the left .    for the filling @xmath50 of a one - column shape , recall that we define @xmath167 by removing the entries one at a time from greatest to least in standardization order .",
    "the only time the difference in major index is @xmath67 is when the entry is on the bottom , and so the first time this occurs is when we remove the bottommost entry @xmath204 from the filling ( i.e. at the @xmath54th step ) .    for the filling @xmath176 of a one - row shape , note that the leftmost entry @xmath204 always has an inversion code number of @xmath67 .",
    "moreover , if any entry @xmath79 to its right also has an inversion code number of @xmath67 , then @xmath306 for otherwise it would be the smaller entry of an inversion ( with @xmath204 itself ) .",
    "it follows that @xmath204 is the smallest entry whose inversion code number is @xmath67 .",
    "we now define a map from fillings of hook shapes to _",
    "pairs _ of partial codes that we call _ hook codes_.    let @xmath50 be a filling of a hook shape @xmath2 . we define the _ hook codes _ of @xmath50 to be the pair of codes consisting of the @xmath143 of its bottom row and the @xmath167 of its leftmost column , along with the data of which entries occur in the row and which occur in the column .",
    "notice that , by the standardization orderings on the row and column of @xmath2 as defined in section [ carlitzwords ] , if the corner square in @xmath2 is one of the repeated letters @xmath119 of the filling , then it is considered the largest @xmath119 in its column and the smallest @xmath119 in its row .",
    "thus we can define a standardization ordering on fillings of hook shapes : we order the letters is smallest to largest , with the following tie - breaking rules .",
    "* if two copies of the letter @xmath119 appear in the left column , the tie is broken as in section [ carlitzwords ] . *",
    "if they appear in the bottom row , then the leftmost @xmath119 comes first . *",
    "if one appears in the column and the other in the row , the one in the column comes first .",
    "this enables us to represent hook codes visually , as shown in the following example .",
    "[ hookexample1 ] consider the filling @xmath50 of a hook shape shown below .",
    "the @xmath74 in the corner is considered to be greater than the @xmath74 above it and less than the @xmath74 to its right . to represent the hook code of @xmath50",
    ", we write the entries of the filling in the standardization ordering , and write the @xmath143 and ( the reverse of ) @xmath167 of the bottom row and left column respectively underneath the corresponding letters .",
    "notice that the @xmath167 is written _ backwards _ , because the entries are in increasing order .    we now characterize the pairs of codes that correspond to fillings of hook shapes .    [ hookcodes ]",
    "let @xmath2 be a hook shape of height @xmath307 and width @xmath308 with @xmath309 , and let @xmath310 be an ordered multiset .",
    "a pair of partial codes @xmath311 of lengths @xmath308 and @xmath307 respectively is a hook code of some filling @xmath50 of @xmath2 if and only if the four conditions below are satisfied .    1",
    ".   the leftmost @xmath67 of @xmath312 matches the rightmost @xmath67 of @xmath313 .",
    "2 .   the two codes do not overlap in any other position , and every position is part of at least one of the two codes .",
    "the code @xmath312 is an element of @xmath314 and is @xmath59-weakly increasing , where we restrict @xmath59 to the @xmath308 letters corresponding to the positions of the entries of @xmath312 .",
    "the code @xmath313 , _ when read backwards _ , is an element of @xmath315 and is @xmath59-weakly increasing , where we restrict @xmath59 to the @xmath307 letters corresponding to the positions of the entries of @xmath313 .",
    "first we show that the hook code of any filling @xmath50 of @xmath2 satisfies the four conditions .",
    "condition 1 follows immediately from lemma [ leftzero ] , because the major index code is written in reverse order .",
    "condition 2 is clear since every entry is in either the row or the column and only the corner square is in both .",
    "conditions 3 and 4 follow immediately from the definition of hook codes .    now , suppose we have a pair of codes satisfying conditions 1 - 4 .",
    "then there is a unique way to form a row and a column of entries based on their elements , since they are both valid carlitz codes and are @xmath59-weakly increasing by conditions 3 and 4 . because of condition 1 and lemma [ leftzero ] , the leftmost entry of the row is the same as the bottommost entry of the column , and so we can put them together to form a filling @xmath50 of a hook shape . because of condition 2 , the hook shape @xmath2 has the appropriate size and shape , and we are done .",
    "using lemma [ hookcodes ] , we can now define our bijection .    for any hook shape @xmath2 and",
    "content @xmath105 , let @xmath316 be the map defined by interchanging the pair of hook codes of a given filling and writing them backwards , and also reversing its alphabet .",
    "starting with the tableau in example [ hookexample1 ] , if we reverse the alphabet , interchange @xmath143 and @xmath167 , and write the codes in backwards order , then we obtain the filling and pair of codes below .",
    "it follows that the filling in example [ hookexample1 ] maps to the filling below under @xmath171 .",
    "we have that @xmath317 and @xmath318 for any filling @xmath50 of a given hook shape @xmath2 .",
    "moreover , @xmath171 is a bijection from @xmath104 to @xmath319 for any content @xmath105 .",
    "clearly @xmath171 interchanges @xmath55 and @xmath56 , since it interchanges the @xmath143 and @xmath167 of the filling . to show it is a well - defined map into fillings of the conjugate shape , note that reversing and interchanging the codes and reversing the alphabet results in a pair of codes that satisfy conditions 1 - 4 of lemma [ hookcodes ] .",
    "finally , @xmath171 is a bijection - in fact , it is an involution - because the operations of reversing the alphabet , interchanging the pair of codes , and writing the codes in the reverse order are all involutions .    the map @xmath171 above satisfies the conditions of the conjecture [ invmaj ] , proving combinatorially that @xmath320 when @xmath2 is a hook shape .",
    "we now turn to the specialization in which one of the statistics is zero . in particular , setting @xmath1 , the symmetry relation becomes @xmath321 which is a symmetry relation between the transformed _ hall - littlewood polynomials _ @xmath322 . in this case",
    "the symmetry relation becomes @xmath323 combinatorially , we are trying to find natural morphisms @xmath324 of weighted sets , where @xmath325 is equipped with the @xmath56 statistic , and @xmath326 is equipped with the @xmath55 statistic .",
    "for the bijection @xmath195 , we will use the _ reverse _ map of definition [ reverse ] .      in the context of hall - littlewood symmetry",
    ", we can think of the carlitz bijection as a solution to the case in which @xmath327 is a straight shape with one column , filled with distinct entries .",
    "thus , we wish to generalize the notion of a carlitz code to fillings of arbitrary shapes having @xmath55 or @xmath56 equal to @xmath67 , using arbitrary alphabets .",
    "our generalization is motivated by the monomial basis of the garsia - procesi modules in @xcite , which are closely connected to the cocharge ( @xmath56 ) statistic .",
    "we define a generalized carlitz code as follows .",
    "a word having letters in @xmath328 is _ yamanouchi _ if every suffix contains at least as many @xmath54 s as @xmath276 s for all @xmath329 .    a word @xmath60 has _ content _",
    "@xmath330 if exactly @xmath102 of the entries of @xmath60 are equal to @xmath331 for each @xmath54 .",
    "we also sometimes say it has content @xmath59 where @xmath59 is the multiset of letters of @xmath60 .",
    "finally , a word @xmath57 is @xmath2-_sub - yamanouchi _ , or _ @xmath2-carlitz _ , if there exists a yamanouchi word @xmath332 of content @xmath2 such that @xmath333 for all @xmath54 .    the sub - yamanouchi words for shape",
    "@xmath334 are precisely the classical carlitz codes .",
    "we will see that the @xmath2-sub - yamanouchi words are the correct analog of carlitz codes in the case that our young diagram fillings have distinct entries . however , in general we require the following more precise definition .",
    "we define @xmath335 to be the collection of all @xmath2-sub - yamanouchi codes which are @xmath59-weakly increasing ( see definition [ aweaklyincreasing ] ) .",
    "we call such codes _ generalized carlitz codes _ , and we equip this collection with the statistic @xmath336 by @xmath337 , forming a weighted set @xmath338 .",
    "we now introduce the concept of the _ monomial _ of a code .",
    "the next three definitions are compatible with the notation in @xcite .",
    "fix variables @xmath27 . for",
    "any finite code @xmath182 of length @xmath43 , define its _ monomial _ to be @xmath339 also let @xmath340 be the set of all monomials @xmath341 of @xmath2-sub - yamanouchi words @xmath182 that are @xmath59-weakly increasing .    in @xcite ,",
    "the authors define a similar set of monomials @xmath342 , which are the generators of the modules @xmath123 that arise naturally in the study of the hall - littlewood polynomials .",
    "we will see that in the case @xmath343 , we have @xmath344 , by showing that the sets @xmath340 satisfy a generalized version of the recursion in @xcite . to state this recursion we require two more definitions , which follow the notation in @xcite .    given a partition @xmath2 ,",
    "define @xmath345 to be the partition formed by removing the corner square from the column @xmath204 containing the last square in the @xmath54th row @xmath346 .    given a set of monomials @xmath347 and a monomial @xmath302",
    ", we write @xmath348 to denote the set of all monomials of the form @xmath349 where @xmath350 .",
    "the following recursion defines the sets @xmath342 .",
    "the sets @xmath342 are defined by @xmath351 and the recursion @xmath352 we refer to these sets as the _ garsia - procesi module bases_.    we require one new definition in order to state our general recursion in the next proposition .",
    "let @xmath353 with @xmath354 be a multiset of positive integers , and let @xmath35 be a partition of @xmath148 .",
    "we define @xmath355 to be the set of all monomials @xmath356 of @xmath35-sub - yamanouchi words @xmath357 that are @xmath358-weakly increasing and if @xmath359 then @xmath360 .",
    "[ recursion ] for any partition @xmath2 of @xmath43 and any multiset of positive integers @xmath353 with @xmath354 , we have @xmath361    we defer the proof of this recursion to section [ proofs ] .",
    "notice that in the case @xmath343 , since there are no repeated entries , proposition [ recursion ] reduces to @xmath362 since this is the same as the recursion given for the sets @xmath342 described in the previous section , and @xmath363 , we have the following corollary .    if @xmath343 , we have @xmath344 .",
    "as noted in @xcite , we can now also enumerate the sets @xmath340 in the case @xmath343 . for",
    ", in this case the simplified recursion gives @xmath364 with @xmath365 .",
    "but the multinomial coefficients @xmath366 satisfy @xmath367 and the same recursion : @xmath368    [ standardinv ] if @xmath343 , we have @xmath369      we can now generalize the inversion code of a permutation to arbitrary fillings @xmath176 with @xmath175 .",
    "let @xmath176 be a filling of @xmath21 having @xmath175 .",
    "order its entries by size with ties broken in reading order to form a totally ordered alphabet @xmath370 .",
    "then its _ inversion code _",
    ", denoted @xmath371 , is the sequence @xmath372 whose @xmath54th entry @xmath134 is the number of attacking pairs having @xmath204 as its smaller entry",
    ".    consider the following tableau .",
    "there are three attacking pairs in this diagram : the @xmath74 in the bottom row is attacked by the @xmath141 and @xmath73 in its row , and the @xmath141 is attacked by the @xmath73 in the second row .",
    "when we order the entries in reading order and record the number of larger numbers that attack it , we get the following table .    @xmath373    therefore , the inversion code of the filling above is @xmath374 .",
    "[ invcode ] the inversion code of any filling @xmath375 is @xmath105-weakly increasing and @xmath2-sub - yamanouchi .",
    "moreover , the map @xmath376 is an isomorphism of weighted sets .",
    "the proof of theorem [ invcode ] is somewhat technical , and so we defer it to section [ proofs ] .",
    "to complete the proof of the hall - littlewood case , it now suffices to find a weighted set isomorphism @xmath377 where @xmath105 is the content of the alphabet @xmath59 .",
    "recall the recursion for the @xmath2-sub - yamanouchi codes of content @xmath59 from proposition [ recursion ] : @xmath361 using this recursion , one possible strategy for constructing @xmath167 is by showing combinatorially that @xmath378 satisfies a similar recursion .    in this section",
    ", we present some partial progress towards finding the map @xmath167 .",
    "all of our work is based on the following four - step approach to the problem .    1 .",
    "consider the content @xmath235 corresponding to fillings with distinct entries , and find an explicit weighted set isomorphism @xmath379 that is , @xmath380 should send an inversion - free filling @xmath45 of @xmath2 to an inversion - free filling @xmath381 of @xmath382 for some @xmath383 , such that @xmath384 2 .",
    "define the @xmath167 of a filling @xmath45 having content @xmath235 to be @xmath385 where @xmath386 3 .",
    "check the base case of a single square , and conclude that because the recursion is satisfied , @xmath167 is an isomorphism of weighted sets @xmath387},\\sigma),\\ ] ] where @xmath388}$ ] are the generalized carlitz codes of shape @xmath2 and content @xmath389 $ ] .",
    "4 .   show that there is a standardization map @xmath390 that respects @xmath56 , such that the composition @xmath391 is a bijection to @xmath335 where @xmath59 is the alphabet with content @xmath105 .",
    "that is , show that after standardizing , we get a major index code which is @xmath59-weakly increasing , and none of these codes are mapped to twice .      for step 1 in our strategy ,",
    "in which @xmath343 is an alphabet with no repeated letters , such a map can easily be extracted from the work of killpatrick @xcite . in this paper , the author gives a combinatorial proof of a recursion for a generating function involving _ charge _ , written @xmath392 , and defined in terms of cocharge as @xmath393 where @xmath394 .",
    "killpatrick defines @xmath395 to be the set of words of content @xmath2 , and lets @xmath396 .",
    "the recursion is stated as : @xmath397    if we substitute @xmath398 and multiply both sides by @xmath399 , this becomes @xmath400 which is equivalent to the recursion we stated in step 1 above .",
    "killpatrick s map @xmath380 allows us to define a map @xmath401 that statisfies steps 1 - 3 above .",
    "we therefore immediately obtain the following result .    in the case @xmath402 of fillings with distinct entries , we have that @xmath403 is an isomorphism of weighted sets @xmath404    however , killpatrick s map @xmath405 does not satisfy the requirements of step 4 . to illustrate this , we consider the case in which @xmath327 is a straight column shape . in this case ,",
    "killpatrick s bijection @xmath405 is defined by the following process :    1 .",
    "given a filling @xmath60 of a straight column shape such as the one with reading word @xmath406 in the diagram below , check to see if the bottommost entry is the largest entry .",
    "if not , cyclically increase each entry by @xmath68 modulo the number of boxes @xmath43 .",
    "each such cyclic increase , or _ cyclage _ , can be shown to decrease the major index by exactly one ( see section [ applications ] for details in the language of cocharge ) .",
    "we perform the minimal number of cyclages to ensure that the bottommost letter is @xmath43 , and let @xmath155 be the number of cyclages used .",
    "( in the figure , @xmath407 . )",
    "once the bottommost entry is @xmath43 , remove the bottom box , and repeat step @xmath68 on the new tableau .",
    "the resulting number of cyclages used is recorded as @xmath156 .",
    "( in the figure , @xmath163 . )",
    "continue until there are no boxes left , and set @xmath408 .",
    "( in the figure , @xmath409 . )",
    "now , suppose we had a standardization map @xmath228 as in step @xmath73 .",
    "consider the one - column tableaux having entries from the alphabet @xmath410 and major index @xmath73 .",
    "there are three such tableaux :        there are also three @xmath411-sub - yamanouchi codes that are @xmath410-weakly increasing and sum to @xmath73 , namely : @xmath412",
    "@xmath413 @xmath414    it follows that @xmath228 maps these three tableaux to the three standardized fillings whose codes @xmath405 are @xmath415 , @xmath416 , and @xmath417 , respectively . but",
    "these three tableaux are :        therefore , the map @xmath228 can not preserve the relative ordering of the entries , or even the positions of the descents .",
    "this makes it unlikely that a simple rule for such a standardization map exists .",
    "however , it is possible that there exists a more complicated combinatorial rule for such a map , and we leave this as an open question for future investigation .",
    "is there a natural map @xmath228 that satisfies the conditions of step @xmath73 for killpatrick s map @xmath405 ?",
    "we now return to carlitz s bijection in the next section , in which we generalize @xmath167 to arbitrary inversion - free fillings of certain infinite families of shapes .",
    "the carlitz bijection on words , defined in section [ carlitzwords ] , gives a map @xmath167 for arbitrary fillings of one - column shapes @xmath2 .",
    "we now show present a strategy towards a generalization to all shapes @xmath2 , and show that rectangles behave similarly to one - column shapes .",
    "our primary tool is the following technical result .",
    "this lemma generalizes the fact that if we remove the largest entry @xmath43 from the bottom of a one - column shape , we get a major index code entry @xmath418 .",
    "[ zerobump ] suppose @xmath419 is a filling for which @xmath174 and the largest entry @xmath43 appears in the bottom row .",
    "let @xmath420 be the filling obtained by :    1 .   removing the rightmost @xmath43 from the bottom row of @xmath50 , which must be in the rightmost column since @xmath174 , 2 .",
    "shifting each of the remaining entries in the rightmost column down one row , 3 .   rearranging the entries in each row in the unique way so that @xmath421 .",
    "then the major index does not change : @xmath422    we defer the proof to the section [ proofs ] .",
    "it turns out that the construction @xmath423 is reversible , and to see this we require the following lemma .",
    "[ pullup ] given two collections of letters @xmath424 and @xmath425 , there is a unique element @xmath204 among @xmath426 such that , in any two - row tableau with @xmath427 as the entries in the bottom row and @xmath428 as the entries in the top , with no inversions in the top row , the entry @xmath204 occurs in the rightmost position in the top row .",
    "this lemma allows us to recover @xmath50 from a tableau @xmath429 whose second - longest row @xmath430 is one square shorter than its longest rows ( @xmath431 through @xmath432 ) .",
    "we simply raise the appropriate entry @xmath204 from row @xmath432 to row @xmath430 , then do the same from row @xmath433 to @xmath432 , and so on , and finally insert a number @xmath43 in the bottom row , where @xmath43 is larger than all of the other entries in @xmath429 .    applying the process in the tableau below , the major indexes of the starting tableau and the ending tableau are both @xmath434 .        using proposition [ zerobump ]",
    ", we can provide a new combinatorial proof of the recurrence of garsia and procesi for all rectangular shapes @xmath435 .",
    "this also will provide the first letter of @xmath167 for rectangular shapes .",
    "[ rectanglebump ] let @xmath343 be the alphabet with content @xmath402 , and let @xmath435 be a rectangle shape of size @xmath43 .",
    "then there is a weighted set isomorphism @xmath436 defined combinatorially by the following process",
    ".    1 .   given a filling @xmath419 with distinct entries @xmath437 and @xmath174 , let @xmath54 be the row containing the entry @xmath43 . split the filling just beneath row @xmath54 to get two fillings @xmath438 and @xmath439 where @xmath439 consists of rows @xmath440 of @xmath50 and @xmath438 consists of rows @xmath54 and above .",
    "rearrange the entries of the rows of @xmath438 in the unique way that forms a filling @xmath441 for which @xmath442 .",
    "3 .   apply the procedure of proposition [ zerobump ] to @xmath441 , that is , removing the @xmath43 from the bottom row and bumping each entry in the last column down one row .",
    "let the resulting tableau be called @xmath443 .",
    "4 .   place @xmath443 on top of @xmath439 and rearrange all rows to form a tableau @xmath176 having @xmath444",
    ". then we define @xmath445 .    moreover , if @xmath446 , then @xmath447 and we assign @xmath448 to the @xmath383th set in the disjoint union .",
    "theorem [ rectanglebump ] gives a new combinatorial proof of the recursion @xmath449 of garsia and procesi for rectangular shapes @xmath2 .",
    "the map @xmath380 of theorem [ rectanglebump ] is illustrated by the example below .",
    "the proofs of these results are deferred to sections [ proofs1 ] and [ proofs2 ] . for",
    "now , we state some facts pertaining to theorem [ rectanglebump ] that will be useful in extending this map to other shapes and alphabets .",
    "proofs of these facts can also be found in section [ proofs2 ] .",
    "[ rectbumpcor1 ] let @xmath450 be the height of the rectangle shape @xmath2 .",
    "since @xmath2 is a rectangle , the shape @xmath382 is independent of @xmath451 , so let @xmath452 be this shape .",
    "let @xmath453 , so that there is a copy @xmath454 of @xmath176 in @xmath455 for all @xmath456 .",
    "let @xmath457 for each @xmath383 .",
    "then for each @xmath458 , the largest entry @xmath43 occurs in the @xmath54th row in exactly one of @xmath459 .",
    "the next theorem suggests that the standardization map for rectangle shapes can be inherited from the standardization map for single - column shapes described above .",
    "[ rectbumpcor2 ] for @xmath460 with @xmath2 a rectangle , the value of @xmath461 can be determined as follows .",
    "let @xmath462 be the unique element of @xmath463 for which @xmath43 is in the bottom row and @xmath464 , so that @xmath465 .",
    "let @xmath466 be the entries of the rightmost column of @xmath462 from top to bottom .",
    "then @xmath383 is the same as the difference in the major index obtained from inserting @xmath43 into the @xmath54th position in the one - column shape with reading word @xmath467 .",
    "this theorem is so crucial to the proofs of the results in the next section that it is helpful to give the sequence of @xmath204 s its own name .",
    "we call it the _ bumping sequence _ of @xmath50",
    ".    let @xmath50 be a filling of a rectangle shape @xmath2 having height @xmath307 , with distinct entries @xmath212 .",
    "the _ bumping sequence _ of @xmath50 is the collection of entries @xmath468 defined as in theorem [ rectbumpcor2 ] above .",
    "if @xmath43 is in the @xmath54th row of @xmath50 , then @xmath469 are in rows @xmath68 through @xmath331 respectively , and @xmath470 are in rows @xmath276 through @xmath307 .",
    "we can also say something about the position of these @xmath204 s given the position of the largest entry .",
    "[ rectbumpcor3 ] let @xmath2 be a rectangle shape of height @xmath307 , and let @xmath471 with its largest entry @xmath43 in row @xmath54 .",
    "then if @xmath472 is the bumping sequence of @xmath50 , then @xmath473 all occur in columns weakly to the right of the @xmath43 , and each @xmath474 is weakly to the right of @xmath475 for @xmath476 .",
    "we now provide a complete bijection @xmath167 in the case that @xmath477 is a partition with at most three rows .",
    "we start with the definition of @xmath167 for two - row shapes , which we will use as part of the algorithm for three rows .",
    "[ tworows ] let @xmath478 be any two - row shape of size @xmath43 .",
    "then there is a weighted set isomorphism @xmath479 defined combinatorially by the following process .",
    "given an element @xmath50 of @xmath463 , that is , a filling of the two - row shape @xmath2 having no inversions , consider its largest entry @xmath43 .    1 .",
    "if the @xmath43 is in the bottom row , define @xmath480 as in proposition [ zerobump ] .",
    "2 .   if the @xmath43 is in the second row , remove it and re - order the remaining entries in the top row so that there are no inversions .",
    "let @xmath448 be the resulting filling .",
    "we first show that @xmath380 is a morphism of weighted sets .",
    "if the @xmath43 we remove is in the bottom row , then by proposition [ zerobump ] , the new filling @xmath481 is in @xmath482 and has the same major index as @xmath50 .",
    "this means that @xmath429 is in the @xmath418 component of the disjoint union @xmath483 and the statistic is preserved in this case .    otherwise , if the @xmath43 is in the second ( top ) row , then @xmath484 is in @xmath485 .",
    "we wish to show that the difference in major index , @xmath486 , is @xmath68 in this case . indeed ,",
    "notice that the bottom row remains unchanged after removing the @xmath43 , and so the difference in major index will be the same as if we ignore the extra @xmath487 numbers at the end of the bottom row and consider just the rectangle that includes the second row instead . by theorem [ rectanglebump ] , it follows that @xmath488 .",
    "therefore @xmath380 is a morphism of weighted sets .    to show that @xmath380 is bijective",
    ", we construct an inverse map @xmath171 .",
    "first , let @xmath489 .",
    "then we can insert @xmath43 into the bottom row , and if @xmath2 is a rectangle also bump up one of the entries of the bottom row according to lemma [ pullup ] .",
    "this creates a filling @xmath50 of shape @xmath2 having the same major index as @xmath208 .",
    "we define @xmath490 , which defines an inverse map for @xmath380 on the restriction of @xmath380 to @xmath491 .",
    "now let @xmath208 be a filling of shape @xmath492 .",
    "the shape @xmath492 has a longer first row than second row , so we can insert @xmath43 into the second row and rearrange the row entries to obtain an inversion - free filling @xmath50 of shape @xmath2 and content @xmath105 .",
    "we define @xmath490 , and by theorem [ rectanglebump ] applied to the two - row rectangle inside @xmath2 of width equal to the top row of @xmath2 , the major index increases by @xmath68 from @xmath208 to @xmath50 .",
    "thus @xmath171 is an inverse to @xmath380 on @xmath482 , and @xmath380 is bijective .",
    "we now complete the entire bijection for two rows by defining a standardization map for two - row fillings .",
    "for a two - row shape @xmath478 , we define the map @xmath390 as follows . given a filling @xmath493 ,",
    "define @xmath211 to be the filling of @xmath2 with content @xmath235 that respects the ordering of the entries of @xmath50 by size , with ties broken by reading order .",
    "the standardization map for two rows is illustrated below .",
    "we can now define @xmath167 for two - row shapes .",
    "let @xmath478 be a two - row shape of size @xmath43 .",
    "given a filling @xmath50 of @xmath2 , let @xmath494",
    ". then we define @xmath495 where @xmath496 and where @xmath380 is the map defined in lemma [ tworows ] .",
    "notice that , given a filling @xmath50 of @xmath2 having arbitrary content , we have @xmath497    [ tworowsconclusion ] the map @xmath167 defined on two - row shapes @xmath478 is an isomorphism of weighted sets @xmath498 for each alphabet @xmath59 and corresponding content @xmath105 .",
    "putting together the recursions of lemma [ tworows ] and lemma [ recursion ] , we have that for the content @xmath235 corresponding to alphabet @xmath389 $ ] , the map @xmath167 is a weighted set isomorphism @xmath499}.\\ ] ]    now , let @xmath59 be any alphabet with content @xmath105 .",
    "let @xmath50 be a filling of @xmath2 with content @xmath105 .",
    "then we know @xmath219 , so @xmath500}$ ] . in other words , @xmath304 is @xmath2-sub - yamanouchi .",
    "in addition , since @xmath228 is an injective map ( there is clearly only one way to un - standardize a standard filling to obtain a filling with a given alphabet ) , the map @xmath167 , being a composition of @xmath228 and the @xmath167 for standard fillings , is injective as well on fillings with content @xmath105 .",
    "we now wish to show that @xmath501 is @xmath59-weakly increasing , implying that @xmath167 is an injective morphism of weighted sets to @xmath335 .",
    "to check this , let @xmath502 . then any repeated letter from @xmath50 will become a collection of squares that have consecutive entries and are increasing in reading order in @xmath503 .",
    "neither of the two operations of the map @xmath380 affects the reading order of such subcollections , since consecutive integers @xmath119 and @xmath504 can not occur in reverse order in a filling with distinct entries and no inversions .",
    "so , it suffices to show that if the largest entry @xmath302 of @xmath50 occurs @xmath54 times , then @xmath505 .    in @xmath503 , the @xmath302 s of @xmath50",
    "become the numbers @xmath506 , and occur in reading order .",
    "thus we remove any of these that occur in the bottom row first , and for those we have @xmath507 .",
    "we continue removing these from the bottom row until there are none left in the bottom row .",
    "then the remaining @xmath508 s up to @xmath217 will equal @xmath68 .",
    "therefore , @xmath509 , as required .",
    "finally , the number of fillings with content @xmath105 is the same as the number of cocharge - friendly diagrams , which is the same as the number of inversion - friendly dot - diagrams for the reverse alphabet .",
    "this in turn is the same as the cardinality of @xmath335 by the section on inversion codes above .",
    "thus the injective map @xmath167 is in fact a bijection .",
    "the result follows .    for any two - row shape @xmath2 and content @xmath105 ,",
    "the map @xmath510 is an isomorphism of weighted sets from @xmath511 .",
    "this gives a combinatorial proof of the identity @xmath512 for two - row shapes .    in figure [ tworowexample ] ,",
    "the map @xmath167 is applied to a two - row filling @xmath50 .     for two - row shapes . ]",
    "the figure shows that @xmath513 .",
    "if we apply @xmath514 to this code using the reversed alphabet , we obtain the the filling @xmath176 below :        notice that @xmath515 .",
    "we now have the tools to extend our map @xmath380 to three - row shapes .",
    "let @xmath50 be any filling of a three - row shape @xmath477 , and let @xmath208 be the @xmath516 rectangle contained in @xmath50 .",
    "let @xmath43 be the largest entry in @xmath50 .",
    "choosing one of these @xmath43 s , say @xmath517 , we define @xmath518 by the following process .    1 .",
    "if @xmath517 is to the right of @xmath208 , remove the @xmath43 as in the two - row algorithm to form @xmath518 .",
    "2 .   if @xmath517 is in the bottom row and in @xmath208 , then @xmath50 is a rectangle and we let @xmath519 .",
    "3 .   if @xmath517 is in the second row and in @xmath208 , let @xmath520 be the top entry of the bumping sequence of @xmath208 .",
    "let @xmath79 be the entry in square @xmath521 if it exists , and let @xmath522 otherwise .",
    "if @xmath523 , then remove @xmath517 and bump down @xmath520 to the second row , and if @xmath524 , simply remove @xmath517 . rearrange the modified rows so that there are no inversions , and let @xmath518 be the resulting filling .",
    "if @xmath517 is in the top row and in @xmath208 , let @xmath525 be the bumping sequence of the @xmath516 rectangle in @xmath50 .",
    "if @xmath526 or @xmath527 , then remove @xmath517 from @xmath50 . otherwise , if @xmath528 , remove @xmath43 and bump @xmath520 up to the top row . rearrange the modified rows so that there are no inversions , and let @xmath518 to be the resulting filling .",
    "[ threerows ] let @xmath477 be any three - row shape of size @xmath43 .",
    "then the map @xmath529 defined above is a morphism of weighted sets when restricted to fillings having distinct entries .",
    "that is , in the case of distinct entries there is a unique choice of @xmath43 , and @xmath530 is a morphism of weighted sets .",
    "we defer the proof to section [ proofs ] . in that section ,",
    "we also show :    [ threerowsbijective ] the map @xmath380 of lemma [ threerows ] is an isomorphism .",
    "we can now complete the three - row case by defining its standardization map for fillings with repeated entries .",
    "this definition is designed to force the @xmath167 sequences to be @xmath59-weakly increasing .    given a filling @xmath50 of @xmath2 , define @xmath211 as follows .",
    "first , for any letter @xmath54 that occurs with multiplicity in @xmath50 , label the @xmath54 s with subscripts in reading order to distinguish them .",
    "if we bump one of them up or down one row , choose the one to bump from the row in question that preserves their reading order .",
    "let @xmath43 be the largest entry that occurs in @xmath50 .",
    "for each such @xmath531 compute @xmath532 , and let @xmath533 .",
    "let @xmath534 be the last @xmath43 in reading order for which @xmath535 .",
    "form the filling @xmath536 , and repeat the process on the new filling .",
    "once there are no @xmath43 s left to remove , similarly remove the @xmath148 s , and so on until the empty tableau is reached .",
    "now , consider the order in which we removed the entries of @xmath50 and change the corresponding entries to @xmath537 in that order , where @xmath538 .",
    "the resulting tableau is @xmath211 .",
    "we can now define @xmath167 for three - row shapes .",
    "let @xmath477 be a three - row shape of size @xmath43 .",
    "given a filling @xmath50 of @xmath2 , let @xmath494 .",
    "then we define @xmath495 where @xmath496 and where @xmath380 is the map defined in lemma [ threerows ] .",
    "notice that , given a filling @xmath50 of @xmath2 having arbitrary content , we have @xmath497    [ threerowsconclusion ] the map @xmath167 defined on three - row shapes @xmath478 is an isomorphism of weighted sets @xmath498 for each alphabet @xmath59 and corresponding content @xmath105 .    see section [ proofs ] for the proof .",
    "for any three - row shape @xmath2 and content @xmath105 , the map @xmath510 is an isomorphism of weighted sets from @xmath511 .",
    "this gives a combinatorial proof of the identity @xmath512 for two - row shapes .",
    "we demonstrate all of the above maps on the filling @xmath50 below , with its repeated entries labeled with subscripts in reading order to distinguish them",
    ".        we will standardize and compute @xmath167 simultaneously .",
    "to decide which of the @xmath222 s to remove first , we look at which would give the smallest first @xmath167 .",
    "this is clearly the @xmath539 in the bottom row , so we remove it and bump down the @xmath74 .        to decide which of the remaining @xmath222 s to remove next ,",
    "note that they both would decrease @xmath56 by @xmath74 , and so we remove the one that comes last in reading order , namely @xmath540 . since @xmath541 we bump down the @xmath68 .",
    "finally , when we remove the last @xmath222 , the maj decreases by @xmath74 , so we do not have to lift the @xmath227 up to the third row .",
    "we can now use the two - row algorithm to complete the process , and we find @xmath542 . the corresponding inversion diagram for the reverse alphabet @xmath543",
    "is shown below .",
    "finally , we can reconstruct from this the filling @xmath544 below .",
    "note that @xmath545 , and @xmath546 .",
    "the map above essentially uses the fact that a three - row shape is the union of a rectangle and a two - row shape . for _",
    "any _ shape that is the union of a rectangle and two rows , a similar map can be used to remove the first @xmath43 , and so for `` snorkel '' shapes consisting of two rows plus a long column , a similar algorithm also produces a valid @xmath167 map .        in general",
    ", however , the resulting shape on removing the first @xmath43 is no longer the union of a rectangle and a two - row shape , and we can not use an induction hypothesis .    however , we believe that this method may generalize to all shapes , as follows .    one can extend the map @xmath380 for three - row shapes to all shapes inductively , as follows .",
    "one would first extend it to shapes which are the union of a three - row shape and a single column , then use this to extend it to shapes which are the union of a three - row shape and a rectangle shape , using theorem [ rectbumpcor2 ] .",
    "one could then iterate this new map on any four - row shape , so @xmath167 can then be defined on four - row shapes , and so on .",
    "proposition [ zerobump ] reveals an interesting property of the cocharge statistic on words , first defined by lascoux and schtzenberger . to define it ,",
    "we first recall the definition of knuth equivalence .    given a word @xmath57 of positive integers , a",
    "_ knuth move _ consists of either :    * a transposition of the form @xmath547 where @xmath548 are consecutive letters and @xmath549 or @xmath550 * a transposition of the form @xmath551 where @xmath548 are consecutive letters and @xmath552 or @xmath553 .",
    "two words @xmath554 are said to be _",
    "knuth equivalent _ , written @xmath555 , if one can be reached from the other via a sequence of knuth moves .",
    "knuth equivalence is an equivalence relation on words .",
    "cocharge was originally defined as follows .",
    "[ originalcocharge ] given a word @xmath556 with partition content @xmath2 , the _ cocharge _ of @xmath60 , denoted @xmath557 is the unique statistic satisfying the following properties :    1 .",
    "it is constant on knuth equivalence classes , that is , if @xmath60 is knuth equivalent to @xmath558 then @xmath559 .",
    "if @xmath560 and @xmath561 , let @xmath562 be the word formed by moving the first letter to the end .",
    "then @xmath563 3 .   if the letters of @xmath60 are weakly increasing then @xmath564 .",
    "there is also an algorithmic way of computing cocharge .",
    "[ cochargealgorithm ] let @xmath60 be a word with partition content @xmath2 , so that it has @xmath431",
    "@xmath68 s , @xmath565 @xmath74 s , and so on . let @xmath257 be the subword formed by scanning @xmath60 from right to left until finding the first @xmath68 , then continuing to scan until finding a @xmath74 , and so on , wrapping around cyclically if need be .",
    "let @xmath260 be the subword formed by removing @xmath257 from @xmath60 and performing the same process on the remaining word , and in general define @xmath566 similarly for @xmath567 .",
    "it turns out that @xmath568 ( see , e.g. , @xcite ) and one can compute the cocharge of a word @xmath566 having distinct entries @xmath569 by the following process .    1 .",
    "set a counter to be @xmath67 , and label the @xmath68 in the word with this counter , i.e. give it a subscript of @xmath67 .",
    "2 .   if the @xmath74 in the word is to the left of the @xmath68 , increment the counter by @xmath68 , and otherwise do not change the counter . label the @xmath74 with the new value of the counter .",
    "3 .   continue this process on each successive integer up to @xmath207 , incrementing the counter if it is to the left of the previous letter .",
    "4 .   when all entries are labeled , the sum of the subscripts is the cocharge .",
    "the link between the major index of inversion free fillings and the cocharge of words lies in the _ cocharge word _ construction .",
    "the _ cocharge word _ of a filling @xmath419 is the word @xmath570 consisting of the row indices of the cells @xmath571 , where @xmath572 is the ordering of the cells of @xmath2 such that @xmath573 , and for each constant segment @xmath574 , the cells @xmath575 are in reverse reading order .",
    "as mentioned in section [ cochargewords ] , for any filling @xmath576 we have @xmath577 .",
    "( see @xcite for the proof . )",
    "therefore , we can translate some of our results regarding such fillings to properties of words and their cocharge .",
    "we first require the following fact .",
    "[ columns ] if @xmath576 and @xmath578 , the words @xmath566 correspond to the columns of @xmath50 , in the sense that the letters in the subword @xmath566 are in positions corresponding to the entries in column @xmath54 in @xmath50 .",
    "if @xmath578 and @xmath50 has alphabet @xmath579 , the letters @xmath204 for which the corresponding letter @xmath58 equals @xmath46 are the entries in row @xmath46 .",
    "the smallest - that is rightmost - @xmath580 , say @xmath581 , for which @xmath582 is the leftmost entry of the bottom row , i.e. the bottom entry of the first column .",
    "the second entry of the first column is then the first @xmath204 in cyclic order after @xmath581 for which @xmath583 .",
    "this corresponds to the @xmath74 in the subword @xmath257 , and similarly the letters in @xmath257 correspond to the entries in the first column .",
    "a similar argument shows that the second column corresponds to @xmath260 , and so on .    in particular ,",
    "proposition [ zerobump ] states that if the largest entry of a filling @xmath584 is in the bottom row , then we can remove it , bump down any entries in its ( rightmost ) column , and rearrange the rows to get a filling with no inversions . by lemma [ columns ] , this translates to the following result in terms of words .",
    "let @xmath57 be a word with partition content @xmath2 for which @xmath585 .",
    "let @xmath586 be its decomposition into subwords as in definition [ cochargealgorithm ] .",
    "then @xmath587 , and if @xmath588 is the word formed by removing @xmath589 from @xmath60 and also decreasing each letter that is in @xmath590 by one , then @xmath591    this theorem fills a gap in our understanding of cocharge , as it gives a recursive way of dealing with words that start with @xmath68 .",
    "these are the only words that do not satisfy the relation @xmath592 of definition [ originalcocharge ] .",
    "consider the word @xmath593 .",
    "it has three @xmath68 s , three @xmath74 s , and three @xmath141 s , but only one @xmath73 and @xmath227 , so to find the word @xmath594 we can ignore the @xmath73 and @xmath227 .",
    "the words @xmath257 , @xmath260 , and @xmath595 , ignoring the @xmath73 and @xmath227 , are the subwords listed below : @xmath596 and so the word @xmath588 is formed by removing the leading @xmath68 and decreasing the @xmath74 and @xmath141 from @xmath595 . thus @xmath597 we also find that @xmath598 .",
    "this section contains the proofs of all the results above whose proofs are particularly long or technical .      for any partition @xmath2 of @xmath43 and",
    "any multiset of positive integers @xmath353 with @xmath354 , we have @xmath361    the sets forming the union on the right hand side are disjoint because the @xmath54th set consists only of monomials having @xmath599 as their power of @xmath600 .",
    "we now show inclusion both ways .",
    "( @xmath601 ) let @xmath602 where @xmath603 is a @xmath2-sub - yamanouchi word which is @xmath59-weakly increasing .",
    "let @xmath604 , so that @xmath605 . also let @xmath606 .",
    "notice that if @xmath359 then @xmath607 , and @xmath608 is @xmath358-weakly increasing .",
    "thus , to show @xmath609 , we just need to show that @xmath608 is @xmath345-sub - yamanouchi .",
    "since @xmath182 is @xmath2-sub - yamanouchi , there exists a yamanouchi word @xmath383 having @xmath346 entries equal to @xmath331 for each @xmath54 , for which @xmath610 .",
    "let @xmath42 be the highest index such that @xmath611 .",
    "then @xmath612 .",
    "so , we wish to show that we can form a new @xmath2-yamanouchi word @xmath79 from @xmath383 so that we still have @xmath613 but @xmath614 . this way @xmath608 will be @xmath345-sub - yamanouchi , with respect to @xmath615 .",
    "we have @xmath616 by our assumption defining @xmath42 , so there are strictly more @xmath42 s than @xmath617 s in @xmath383 .",
    "notice that this means we can move the _ leftmost _ @xmath42 in @xmath383 any number of spots to the left without changing the fact that the word is yamanouchi .    also notice that @xmath618 .",
    "but since there are exactly as many @xmath331 s as @xmath54 s , @xmath276 s , and so on up to @xmath42 in @xmath383 , we must in fact have @xmath360 , for otherwise the suffix @xmath619 would not satisfy the yamanouchi property .",
    "so @xmath360 .",
    "now , let @xmath620 be the leftmost @xmath42 in @xmath383 .",
    "we form a subword of @xmath383 as follows .",
    "let @xmath621 be the first letter of our subword .",
    "then let @xmath622 be the leftmost letter between @xmath621 and @xmath620 with @xmath623 , if it exists .",
    "then let @xmath624 be the first letter between @xmath622 and @xmath620 for which @xmath625 , and so on until we reach a point at which no such letter exists .",
    "we now have a subsequence of letters @xmath626 where @xmath620 is the leftmost @xmath42 in @xmath383 .",
    "we define @xmath79 to be the word formed from @xmath383 by cyclically shifting this subsequence , replacing @xmath627 with @xmath628 for all @xmath629 , replacing @xmath622 with @xmath621 , and replacing @xmath621 with @xmath630 .    for instance , if @xmath631 , @xmath632 , then @xmath633 , and we might have @xmath634 with @xmath635 then the subword of @xmath383 consists of those letters in boldface above , and we cyclically shift the boldface letters to the right in their positions to form @xmath636 which is still @xmath2-yamanouchi and still dominates @xmath182 in the sense that @xmath613 .    to verify that in general @xmath613 , notice that @xmath637 , and since the other letters in the subword decrease to the right , we have @xmath638 for all @xmath629 .",
    "thus each @xmath639 for all @xmath54 , and so @xmath613 .    to show that @xmath79 is still yamanouchi , notice that to form @xmath79 from @xmath383",
    ", we have moved the leftmost @xmath42 all the way to the left ( which , we noted above , preserves the yamanouchi property ) and moved each @xmath640 to the right without crossing over any element having value @xmath641 ( for otherwise our sequence @xmath640 would have an extra element , a contradiction . )",
    "thus we have not changed the property of there being at least as many @xmath641 s as @xmath640 s in each suffix , and we have not changed the property that there are at least as many @xmath640 s as @xmath642 s in each suffix , because we moved these elements to the right .",
    "the other yamanouchi conditions remain unchanged , since we are only moving the letters @xmath640 .",
    "thus @xmath79 is yamanouchi as well .",
    "( @xmath643 ) for the other inclusion , let @xmath603 be a word such that @xmath644",
    ". then @xmath645 is @xmath345-sub - yamanouchi , so there exists a word @xmath646 which is yamanouchi of content @xmath345 such that @xmath647 .",
    "let @xmath648 where @xmath42 is the highest index such that @xmath611 .",
    "then @xmath649 is yamanouchi of shape @xmath2 by the definition of @xmath345 , and since @xmath605 , we have @xmath650",
    ". thus @xmath651 .",
    "finally , note that if @xmath359 in @xmath59 , then @xmath607 by the definition of @xmath652 . thus @xmath182 is @xmath59-weakly increasing .",
    "it follows that @xmath602 .",
    "the inversion code of any filling @xmath375 is @xmath105-weakly increasing and @xmath2-sub - yamanouchi .",
    "moreover , the map @xmath376 is an isomorphism of weighted sets .    to prove theorem [ invcode ]",
    ", we first introduce some new notation . in analogy with the cocharge word defined in @xcite , for fillings",
    "@xmath176 having @xmath175 , we can form an associated _ inversion word _ and describe a statistic on the inversion word that measures @xmath178 in the case that @xmath175 .",
    "let @xmath176 be a filling of shape @xmath2 having @xmath653 .",
    "we define the _ inversion word _ of @xmath176 as follows .",
    "starting with the smallest value that appears in the filling , write the column numbers of the entries with that value as they appear in reading order , and then proceed with the second largest entry and so on .",
    "for instance , the filling :        has inversion word @xmath654 .    in order to compute @xmath72 given only its inversion word , we will use a visual representation of the inversion word , which we call a _",
    "diagram_.    fix a linearly ordered finite multiset @xmath59 , with elements @xmath354 .",
    "the _ diagram _",
    "a function @xmath655 is the plot of the function with respect to the ordering on @xmath59 .",
    "we say that the diagram has _ shape _",
    "@xmath2 if @xmath656 for each @xmath54 .    the diagrams we will be using are essentially the plot of the inversion word , considered as a function on a multiset",
    ".    let @xmath176 be a filling of @xmath21 having @xmath175 , and let @xmath60 be the inversion word of @xmath176 .",
    "let @xmath59 be the multiset consisting of the entries of @xmath176 , ordered from least to greatest and in reading order in the case of a tie .",
    "let @xmath655 be the function given by @xmath657 .",
    "we define @xmath658 to be the diagram of the function @xmath250 , whose plot has @xmath659 dots in the @xmath136th row .",
    "notice that the @xmath660 of a filling of shape @xmath21 has shape @xmath2 , the conjugate shape .",
    "for instance , the tableau        has @xmath653 , and its inversion word is @xmath661 .",
    "its plot is as follows .        to compute the number of inversions ,",
    "we define the _ inversion labeling _ of a diagram to be the result of labeling each row of dots @xmath346 in the diagram with the numbers @xmath662 from right to left :        finally , an _ inversion _ in the diagram of a function @xmath655 , labeled as above , is a pair of entries @xmath663 in the ordered multiset @xmath59 for which either :    * the dots above @xmath119 and @xmath79 have the same label and @xmath664 , or * the dot in position @xmath119 is labeled @xmath54 and the dot in position @xmath79 is labeled @xmath276 , and @xmath665 .",
    "so there are @xmath141 inversions in the diagram above , two of type i and one of type ii :        for fillings @xmath50 with @xmath666 ,",
    "there are no descents , and so the number of inversions in @xmath667 is equal to @xmath72 .",
    "in particular , type i and ii inversions correspond to attacking pairs in the same row or on adjacent rows , respectively .",
    "the type i and ii inversions also correspond to the two types of inversions used to define the @xmath668 statistic on parking functions .",
    "indeed , this was the original motivation for the full definition of the @xmath55 statistic .",
    "@xcite    we now classify the types of diagrams that arise as the @xmath660 of a filling .",
    "a consecutive subsequence is in _ inversion - friendly order _ if , when each row is labeled from right to left as above , all dots of label @xmath276 in the subsequence occur before the dots of label @xmath54 for all @xmath54 , and the dots of any given label appear in increasing order from bottom to top .",
    "an example of an inversion - friendly subsequence is shown below .",
    "it is easy to check that , in the plot of any filling @xmath176 having @xmath669 , every subsequence above a fixed letter of the alphabet @xmath59 is in inversion - friendly order .",
    "we claim that the converse is true as well , namely , that every diagram having all such subsequences in inversion - friendly order corresponds to a unique young diagram filling @xmath176 having @xmath175 .",
    "a diagram is of _ inversion word type _ if every subsequence determined by a fixed letter of @xmath59 is in inversion - friendly order .",
    "we let @xmath670 the set of all diagrams of shape @xmath2 of inversion word type over @xmath59 . we equip @xmath670 with its @xmath55 statistic to make it into a weighted set .",
    "[ inversionfriendly ] let @xmath2 be a partition of @xmath43 , and let @xmath59 be a multiset of @xmath43 positive integers with content @xmath105 .",
    "the map @xmath660 is an isomorphism of weighted sets @xmath671    ( sketch . ) as noted above , this is a map of sets that preserves the @xmath55 statistic since there are no descents . to show",
    "it is bijective , we construct its inverse .",
    "let @xmath672 be an arbitrary diagram in @xmath670 , and let @xmath655 be the corresponding map .",
    "for any @xmath194 let @xmath673 be the label on the dot at height @xmath674 .",
    "then let @xmath176 be the filling of shape @xmath21 in which @xmath194 is placed in the square in column @xmath674 from the left , and height @xmath673 from the bottom . by the definition of @xmath660 , we have that @xmath675 , and furthermore if @xmath676 then @xmath677 .",
    "thus the map sending @xmath672 to @xmath176 is the inverse of @xmath660 .",
    "we now show that the inversion - friendly diagrams are in weight - preserving bijection with generalized carlitz codes",
    ". this will complete the proof of theorem [ invcode ] .",
    "the _ inversion code _ of a diagram @xmath60 , denoted @xmath678 is the sequence @xmath679 whose @xmath54th entry @xmath134 is the number of inversion pairs of the form @xmath680 .",
    "the inversion code of the following diagram is @xmath374 .",
    "using proposition [ inversionfriendly ] , we can also define the inversion code of a filling @xmath681 to be @xmath682 it is easy to see that this matches the definition of inversion code in section [ cochargewords ] .    the map @xmath683 is an isomorphism of weighted sets .",
    "we break the proof into several lemmas for clarity .",
    "[ welldefinedinv ] the map @xmath143 is a well - defined morphism from @xmath684 for all @xmath2 and @xmath59 .",
    "let @xmath685 be a diagram in @xmath670 , and let @xmath686 .",
    "we first show that @xmath182 is @xmath2-sub - yamanouchi .",
    "let @xmath687 and consider the subset of dots labeled @xmath54 in the inversion labeling of @xmath60 , say @xmath688 from left to right .",
    "we claim that @xmath689 is the left element of at most @xmath136 inversions for each @xmath690 .",
    "indeed , @xmath689 is to the left of exactly @xmath136 dots labeled @xmath54 ; those dots in a lower row form the type i inversions with @xmath689 . for type ii",
    ", the dots labeled @xmath276 in a higher row must have an @xmath54 to the right of them , so correspond to one of the dots labeled @xmath54 in a higher row and to the right of @xmath689 .",
    "thus @xmath689 is the left element of at most @xmath136 inversions , and so @xmath691 .",
    "it follows that @xmath692 is an ordinary carlitz code .",
    "therefore , @xmath182 can be decomposed into several carlitz codes , one for each label , of lengths @xmath693 .",
    "let @xmath217 be the resulting upper bound on @xmath134 for each @xmath54 .",
    "then @xmath383 is a union of the sequences @xmath694 for each @xmath54 , arranged so that each of these sequences retains its order .",
    "thus @xmath383 is a yamanouchi code , since every entry @xmath217 can be matched with a unique entry having value @xmath695 to its right , namely the next entry in the corresponding subsequence .",
    "note also that @xmath383 is yamanouchi of shape @xmath2 , since there are @xmath431 zeroes , @xmath565 ones , etc in @xmath383 . since @xmath182 is bounded above component - wise by @xmath383",
    ", we have that @xmath182 is @xmath2-sub - yamanouchi .",
    "we now show that @xmath182 is @xmath59-weakly increasing .",
    "it suffices to show that for any two consecutive dots @xmath696 of @xmath60 that are in inversion - friendly order , we have @xmath697 .",
    "suppose the dot @xmath698 is labeled @xmath54 in the inversion labeling , and @xmath699 is labled @xmath136 .",
    "then by assumption , since they are in inversion - friendly order , we have either @xmath700 with the @xmath136 in a higher row than @xmath54 , or @xmath701 .",
    "the @xmath54 is the left element of @xmath702 inversions and the @xmath136 is the left element of @xmath703 inversions .",
    "first suppose @xmath700 and the @xmath136 is in a higher row than the @xmath54 , that is , @xmath704 . if @xmath79 is an index to the right of the @xmath54 such that @xmath705 is an inversion , then there are three possibilities : first , @xmath706 could be labeled @xmath54 and be below @xmath698 , in which case @xmath707 is also an inversion .",
    "second , @xmath706 could be labeled @xmath276 and be above @xmath698 but below @xmath699 , in which case there is a dot labeled @xmath54 in row @xmath706 to the right of @xmath79 , forming an inversion with @xmath699 . and third , @xmath706 could be labeled @xmath276 and be above row @xmath699 , in which case @xmath707 is also an inversion . thus there is at least one inversion with @xmath698 as its left element for every inversion with @xmath699 as the left element , and so @xmath708 in this case .",
    "similarly , if @xmath701 , then any dot labeled @xmath54 or @xmath276 has a dot labeled @xmath136 and a dot labeled @xmath709 to its right , and so @xmath697 in this case as well .",
    "it follows that @xmath143 is a well - defined map .",
    "[ injectiveinv ] the map @xmath143 is injective .    we will show that given a code @xmath182 , we can form an inversion - friendly diagram by placing dots above @xmath133 from left to right .",
    "we claim that there is a unique height that is compatible with @xmath182 at each step .    with the empty word as a trivial base case",
    ", we proceed inductively .",
    "suppose we have already placed the first @xmath710 dots from the left . there may be several possible dot heights available for the @xmath711th dot , depending on the shape @xmath2 and which dot heights have already been chosen .",
    "we claim that each possible height would result in a different value of the code number @xmath702 . to show this ,",
    "let @xmath712 be two possible heights of the @xmath711th dot . since the first @xmath710 dots have been chosen and we know the shape of the diagram , the labels @xmath54 and @xmath136 of a dot at height @xmath713 or @xmath714 respectively are uniquely determined .",
    "we also note that the inversion code number @xmath702 is uniquely determined by the choice of the @xmath711th dot ( given the first @xmath710 dots ) , since any row of length @xmath715 that did not have a dot labeled @xmath54 among the first @xmath42 values must necessarily have one afterwards , and so the set of label values in each row to the right of the @xmath711th entry is determined .",
    "so , let @xmath46 be the inversion code number @xmath702 that would result from the dot at height @xmath713 labeled @xmath54 , and @xmath47 the code number for @xmath714 labeled @xmath136 . we wish to show that @xmath716 , and we consider the cases @xmath717 and @xmath718 separately .",
    "if @xmath717 , let @xmath207 be the number of dots labeled @xmath54 that would be below and to the right of the @xmath698 if @xmath719 ( labeled @xmath54 ) . then @xmath720 would be the number of @xmath276 s above and to the right of it .",
    "each of the @xmath207 rows having the @xmath54 s also have @xmath136 s weakly to the right of them because @xmath717 , and each of the @xmath720 rows with the @xmath276 s have both a @xmath709 and a @xmath136 to the right .",
    "thus if @xmath721 ( labeled @xmath136 ) instead , the @xmath136 would have at least @xmath46 inversions , and so @xmath722 .",
    "but if @xmath721 , then this @xmath136 also forms an inversion with the @xmath136 in row @xmath713 , giving an extra inversion",
    ". thus @xmath723 , and so @xmath716 in this case .",
    "if @xmath724 , consider the @xmath47 dots labeled @xmath136 or @xmath709 that would form an inversion with @xmath698 if @xmath721 . then each of these rows would also contain an @xmath54 or @xmath276 that would form an inversion with the @xmath54 at height @xmath713 , in addition to the row @xmath714 itself , showing that @xmath725 .",
    "thus @xmath716 , as desired .",
    "we have that @xmath726 by our definition of @xmath347 .",
    "furthermore , when @xmath343 we have @xmath727 because we are simply counting the number of unrestricted diagrams having @xmath431 dots in the first row , @xmath565 in the second row , and so on .",
    "we can now conclude bijectivity in this case .",
    "the map @xmath143 is bijective in the case @xmath343 .",
    "we are now ready to prove theorem [ invcode ] .",
    "we already have shown ( corollary [ standardinv ] ) that @xmath143 is a bijective map @xmath728}\\to c_{\\mu,[n]}$ ] .",
    "notice that for any other alphabet @xmath370 , we have @xmath729}$ ] and @xmath730}$ ] .",
    "we also know that the map @xmath731}\\to c_{\\mu,[n]}\\ ] ] restricts to an injective map @xmath683 by lemmas [ welldefinedinv ] and [ injectiveinv ] .",
    "it remains to show that it is surjective onto @xmath335 .",
    "let @xmath732}$ ] .",
    "then @xmath182 is @xmath59-weakly increasing on constant letters of @xmath59 .",
    "let @xmath733}$ ] .",
    "we wish to show that @xmath383 is of inversion word type with respect to @xmath59 , so that @xmath734 , that is , if @xmath735 and @xmath736 in @xmath59 then @xmath737 is not an inversion",
    ". suppose @xmath737 is an inversion .",
    "then either @xmath738 and @xmath739 are both dots labeled @xmath54 with @xmath740 , or @xmath738 is labeled @xmath54 and @xmath739 labeled @xmath276 with @xmath741 .    in the first case , if @xmath742 is another inversion involving @xmath743 , then either @xmath744 is lower than @xmath739 ( and hence lower than @xmath738 ) and labeled @xmath54 , or it is above it and labeled @xmath276 . if the former then @xmath745 is an inversion , and if the latter , either there is an @xmath54 in the same row forming an inversion with @xmath738 , or the @xmath276 is above @xmath738 , forming an inversion with it",
    "thus @xmath738 is the left element of at least as many inversions as @xmath739 , plus one for the inversion @xmath737 .",
    "thus @xmath746 .    in the second case ,",
    "if @xmath742 is another inversion , then @xmath744 is either lower ( but possibly above @xmath738 ) and labeled @xmath276 , or higher and labeled @xmath747 . in the former case either @xmath744 itself forms an inversion with @xmath738 or the @xmath54 in its row does . in the latter case the @xmath276 in its row forms an inversion with @xmath738 .",
    "since @xmath737 is an inversion as well , we again have @xmath746 .",
    "but this contradicts the fact that @xmath182 is @xmath59-weakly increasing .",
    "hence @xmath143 is surjective , and thus bijective , from @xmath670 to @xmath335 .",
    "clearly the map preserves the statistics : the sum of all the entries of the inversion code of a diagram is the total number of inversions of the diagram , so @xmath143 sends @xmath55 to @xmath127 .",
    "therefore , @xmath748 is an isomorphism of weighted sets .      for any column filling @xmath50 with alphabet @xmath59 , let @xmath213 .",
    "then @xmath176 and @xmath50 have the same major index , and @xmath214 is @xmath59-weakly increasing .",
    "we first prove the following technical lemma .",
    "define a _ consecutive block _ of @xmath43 s in a filling to be a maximal consecutive run of entries in a column which are all filled with the letter @xmath43 .    given a filling of a one - column shape @xmath215 having largest entry @xmath43",
    ", there is a unique way of ordering the @xmath43 s in the filling , say @xmath216 , such that the following two conditions are satisfied .    1",
    ".   any consecutive block of @xmath43 s in the column appears in the sequence in order from bottom to top , and 2 .",
    "if we remove @xmath216 in that order , and let @xmath217 be the amount that the major index of the column decreases at the @xmath54th step , then the sequence @xmath218 is weakly increasing .",
    "we first show ( 1 ) that there is a _",
    "unique _ choice of entry labeled @xmath43 at each step which minimizes @xmath383 and is at the bottom of a consecutive block , and then that ( 2 ) the resulting sequence @xmath217 is weakly increasing . for any entry @xmath267",
    ", we define @xmath749 to be the column formed by removing the entry @xmath267 from @xmath50 .    to prove ( 1 ) ,",
    "consider the bottommost entries of each consecutive block of @xmath43 s .",
    "we wish to show that no two of these @xmath43 s have the same value of @xmath750 upon removal .",
    "so , suppose there is an @xmath43 in the @xmath54th square from the top and an @xmath43 in the @xmath136th square from the top , each at the bottom of their blocks , and call them @xmath517 and @xmath751 to distinguish them .",
    "assume for contradiction that removing either of the @xmath43 s results in a decrease by @xmath383 of the major index .",
    "suppose an entry @xmath43 has an entry @xmath119 above it and @xmath79 below . in @xmath752 , @xmath119 and @xmath79 are adjacent , and they can either form a descent or not . if they do , then @xmath461 is equal to the number of descents below and including that @xmath43 , and if they do not , then @xmath383 is equal to the sum of the number of descents _ strictly _ below the @xmath43 _ plus _ the position of the @xmath43 from the top .",
    "we consider several cases based on the two possibilities for each of @xmath517 and @xmath751 .",
    "if either @xmath517 or @xmath751 is at the very bottom of the filling , then removing that entry results in @xmath418 , and the other does not , so we may assume neither of @xmath517 or @xmath751 is in the bottom row .",
    "_ case 1 : _ each of @xmath517 and @xmath751 forms a new descent upon removal , in @xmath518 and @xmath753 .",
    "assume without loss of generality that @xmath77 , and let @xmath42 be the number of descents weakly below position @xmath136 ( meaning its position from the top is greater than or equal to @xmath136 ) and @xmath47 the number of descents weakly below position @xmath54 .",
    "then since the @xmath517 is at the bottom of its block , it is a descent , so @xmath754 .",
    "since @xmath47 and @xmath42 are the values of @xmath383 for the removal of the two @xmath43 s , we have a contradiction .",
    "_ case 2 : _ neither @xmath517 nor @xmath751 , upon removal , forms a new descent . in this case , assume without loss of generality that @xmath77 and let @xmath42 be the number of descents _ strictly _ below position @xmath136 .",
    "let @xmath46 be the number of descents strictly between rows @xmath54 and @xmath136 . since the @xmath43 s are at the bottom of their blocks , the two @xmath43 s are descents as well , so the values of @xmath383 upon removing the @xmath43 s are @xmath755 and @xmath756 . by our assumption",
    ", these are equal , and so we have @xmath757 but @xmath758 counts the number of squares strictly between positions @xmath54 and @xmath136 .",
    "since @xmath46 is the number of squares in this set which are descents , this means that every square between @xmath54 and @xmath136 must be a descent .",
    "but the square in position @xmath136 has the highest possible label @xmath43 , so the square just before it ( above it ) can not be a descent .",
    "hence we have a contradiction .",
    "_ case 3 : _ one of the two @xmath43 s , say the one in position @xmath54 , forms a new descent upon removal , and the other does not . then in this case defining @xmath42 as the number of descents _ strictly _ below position @xmath136 and @xmath47 the number of descents _ weakly _ below position @xmath54 , the two values of @xmath383 are @xmath756 and @xmath47 .",
    "so @xmath759 by our assumption , and so @xmath760 , which implies @xmath761 , or @xmath754 .",
    "thus , necessarily @xmath77 .",
    "now , @xmath762 is the number of descents between positions @xmath54 and @xmath136 , inclusive . since @xmath277",
    "there are at most @xmath136 such squares , and the one preceding @xmath136 can not be a descent since there is an @xmath43 in the @xmath136th position .",
    "thus this quantity @xmath762 is strictly less than @xmath136 , but we showed before that @xmath760 , a contradiction .",
    "this completes the proof of claim ( 1 ) .    for claim ( 2 ) , consider any two consecutive @xmath383 values in this process , say @xmath621 and @xmath763 for simplicity , that correspond to the largest value @xmath43 .",
    "let @xmath764 and @xmath765 be the corresponding copies of @xmath43 .",
    "we wish to show that @xmath766 .    first ,",
    "notice that if @xmath764 and @xmath765 were in the same consecutive block before removal , we have @xmath767 unless @xmath765 is a block of length @xmath68 in @xmath448 , in which case @xmath768 .",
    "so we may assume that @xmath764 and @xmath765 were in different consecutive blocks before removal .",
    "in this case the removal of @xmath764 may only change the value of @xmath383 on removing @xmath765 by at most one , namely by either shifting it back by one position if @xmath764 is above @xmath765 in the column , or by removing one descent from below @xmath765 , if @xmath764 is below @xmath765 .",
    "thus @xmath769 is at most one less than @xmath770 .",
    "since @xmath764 was chosen so as to minimize @xmath621 , and we showed in our proof of ( 1 ) that the choice is unique , this implies that @xmath771 .",
    "thus @xmath768 , as desired .",
    "this completes the proof of ( 2 ) .",
    "proposition [ onecolumnstandardize ] now follows from the proof of the above lemma .",
    "suppose @xmath419 is a filling for which @xmath174 and the largest entry @xmath43 appears in the bottom row .",
    "let @xmath420 be the filling obtained by :    1 .   removing the rightmost @xmath43 from the bottom row of @xmath50 , which must be in the rightmost column since @xmath174 , 2 .",
    "shifting each of the remaining entries in the rightmost column down one row , 3 .   rearranging the entries in each row in the unique way so that @xmath421 .",
    "then the major index does not change : @xmath422    to prove proposition [ zerobump ] , we require a new definition and several technical lemmata .",
    "we write @xmath772 to denote the square in row @xmath54 and column @xmath136 of a young diagram .",
    "the _ cocharge contribution _ @xmath773 of an entry @xmath774 of a filling @xmath50 is the number of descents that occur weakly below the entry @xmath772 in its column , @xmath136 .",
    "it is easy to see that the cocharge contributions add up to the major index .",
    "[ cochargecontributions ] let @xmath419 be any filling .",
    "then @xmath177 is equal to the sum of the cocharge contributions of the entries of @xmath50 , i.e. @xmath775    we omit the proof , and refer the reader to the example in figure [ contributionfigure ] .",
    "the cocharge contribution of the entries in each tableau is shown as a superscript .",
    "notice that the sum of the cocharge contributions of a tableau is equal to its major index .",
    "in addition , the three - step process of proposition [ zerobump ] does not change the major index . ]",
    "let @xmath60 be any sequence consisting of @xmath207 @xmath67 s and @xmath207 @xmath68 s , and let @xmath776 be any ordering of the @xmath67 s .",
    "we define the _ crossing number _ of @xmath60 with respect to this ordering as follows . starting with @xmath777 ,",
    "let @xmath778 be the first @xmath68 to the right of @xmath777 in the sequence , possibly wrapping around cyclically if there are no @xmath68 s to the right of @xmath777 .",
    "then let @xmath779 be the first @xmath68 cyclically to the right of @xmath520 other than @xmath778 , and so on .",
    "then the _ crossing number _ is the number of indices @xmath54 for which @xmath780 is to the left of @xmath204 .    if we order the @xmath67 s from left to right , the word @xmath781 has crossing number @xmath74 .",
    "[ aabb ] let @xmath60 be any sequence consisting of @xmath207 @xmath67 s and @xmath207 @xmath68 s .",
    "then its crossing number is independent of the choice of ordering of the @xmath67 s .",
    "say that a word is _",
    "@xmath67-dominated _ if every prefix has at least as many @xmath67 s as @xmath68 s .",
    "first , we note that there exists a cyclic shift of @xmath60 which is @xmath67-dominated .",
    "indeed , consider the partial sums of the @xmath782 s in the sequence , so that any @xmath67 contributes @xmath93 and any @xmath68 contributes @xmath91 .",
    "the total sum is @xmath67 , and we can shift to start at the index of the minimal partial sum ; the partial sums will now all be positive .",
    "now , we show by induction that any @xmath67-dominated sequence has crossing number @xmath783 .",
    "it is clearly true for @xmath784 , since the only @xmath67-dominated sequence is @xmath785 in this case .",
    "suppose the claim holds for any @xmath67-dominated sequence of @xmath210 @xmath67 s and @xmath210 @xmath68 s and let @xmath47 be an @xmath67-dominated sequence with @xmath207 @xmath67 s .",
    "choose an arbitrary @xmath67 to be @xmath777 , and denote it @xmath786 .",
    "then since @xmath47 is @xmath67-dominated , the last term in @xmath47 is a @xmath68 and so @xmath786 will be paired with a @xmath68 , denoted @xmath787 , to the right of it .",
    "remove both @xmath786 and @xmath787 from @xmath47 to form a sequence @xmath788 having @xmath210 @xmath67 s and @xmath210 @xmath68 s .",
    "we claim that @xmath788 is @xmath67-dominated .",
    "note that all prefixes of @xmath788 that end to the left of @xmath786 are unchanged , and hence still have at least as many @xmath67 s as @xmath68 s .",
    "any prefix @xmath789 that ends between @xmath786 and @xmath787 is the result of removing @xmath786 from a corresponding prefix @xmath790 of @xmath47 , which had at least as many @xmath67 s as @xmath68 s . if there were an equal number of @xmath67 s as @xmath68 s in @xmath790 , then its last term is a @xmath68 .",
    "this means that @xmath787 was not the first @xmath68 to the right of the @xmath67 , a contradiction .",
    "so @xmath790 has strictly more @xmath67 s than @xmath68 s , and so @xmath791 has at least as many @xmath67 s as @xmath68 s .",
    "finally , any prefix which ends to the right of @xmath787 has one less @xmath67 and one less @xmath68 than the corresponding initial subsequence of @xmath47 , and so it also has at least as many @xmath67 s as @xmath68 s .",
    "it follows that @xmath788 is @xmath67-dominated .    by the inductive hypothesis ,",
    "no matter how we order the remaining @xmath67 s , there are no crossing pairs .",
    "since the choice of @xmath777 was arbitrary , the crossing number is @xmath67 for any ordering of the @xmath67 s .",
    "returning to the main proof , let @xmath792 and let @xmath54 be such that the cyclic shift @xmath793 is @xmath67-dominated .",
    "then every pairing in @xmath588 has the @xmath67 to the left of the @xmath68 , and so the crossing number of @xmath60 is the number of pairings in which the @xmath67 is among @xmath794 and the @xmath68 is among @xmath795 .",
    "hence , the crossing number is equal to the difference between the number of @xmath68 s and @xmath67 s among @xmath796 .",
    "this is independent of the choice of order of the @xmath67 s , and the proof is complete .    in the rest of the paper , if a row @xmath46 is above a row @xmath47 in a filling",
    ", we say that we _ rearrange @xmath46 with respect to @xmath47 _ if we place the entries of @xmath46 in the unique ordering for which there are no inversions in row @xmath46 , given that @xmath47 is below it .",
    "[ twist ] let @xmath50 be a filling of the two - row shape @xmath797 with @xmath174 .",
    "let @xmath798 be formed by rearranging the bottom row via the permutation @xmath76 , nad rearranging the top row with respect to the new bottom row",
    ". then @xmath799 .",
    "let @xmath60 be cocharge word of the diagram .",
    "no matter what the permutation of rows , the cocharge word will remain unchanged , a sequence of @xmath207 @xmath68 s and @xmath207 @xmath74 s .",
    "but the permutation of the bottom row determines a permutation of the @xmath68 s , and the subsequent ordering of the top row is determined by the process of selecting the first remaining @xmath74 cyclically to the right of the @xmath68 at each step .",
    "it forms a descent if and only if that @xmath74 is to the left of the @xmath68 , i.e. if it contributes to the crossing number .",
    "so the number of descents is equal to the crossing number of the cocharge word ( thinking of the @xmath68 s as @xmath67 s and the @xmath74 s as @xmath68 s ) , and by lemma [ aabb ] the proof is complete .",
    "we now have the tools to prove the next technical lemma .",
    "[ dangle ] let @xmath800 be any positive integers , and suppose @xmath801 are positive integers such that in the partial tableau @xmath802 has no inversions among the @xmath780 s . then if we rearrange @xmath800 in any way and then rearrange the @xmath79 s in the unique way that guarantees no inversions among the @xmath79 s , then the entry @xmath803 is still in the last position .",
    "furthermore , the total number of descents among @xmath801 is unchanged after this operation .    consider the cyclic ordering of @xmath804 .",
    "since there are no inversions among the @xmath79 s , we have that @xmath805 are in cyclic order for each @xmath54 , possibly with @xmath806 or @xmath807 .",
    "let @xmath808 be the ordering of these letters that is in cyclic order , with ties broken in such a way that @xmath809 occur in that order in the sequence for each @xmath54 . then if we replace the @xmath204 s with @xmath67 s and the @xmath780 s with @xmath68 s , the suffix @xmath810 has crossing number @xmath67 since each @xmath204 is paired with @xmath780 to its right .",
    "it follows from lemma [ aabb ] that , if we rearrange the @xmath204 s , the crossing number is still @xmath67 and so @xmath803 still corresponds to the @xmath68 at the beginning of the sequence .",
    "it follows that @xmath803 is still in the last position in the new filling .",
    "finally , by considering only the first @xmath811 columns , we can apply lemma [ twist ] to see that the total number of descents among @xmath424 remains unchanged .",
    "we require one more technical lemma regarding two - row fillings .",
    "first , notice that in a two - row shape with the bottom row ordered least to greatest and no inversions in the second row , the descents must be  left - justified \" : they must occur in columns @xmath569 for some @xmath207 . for",
    ", if @xmath812 is a descent and @xmath813 is not , then @xmath814 by transitivity and we have @xmath815 , forming an inversion .",
    "moreover , after the descents the @xmath780 s are weakly increasing : @xmath816 for @xmath817 - this follows directly from the fact that none of these @xmath780 s are descents .",
    "the descents @xmath818 are also weakly increasing ; otherwise we would have an inversion .",
    "we will use these facts repeatedly throughout .",
    "[ tworowdrop ] let @xmath819 and let @xmath820 be numbers such that the partial tableau @xmath821 has no inversions in the second row .",
    "then if we bump @xmath803 down one row so that @xmath822 is the bottom row , and leave @xmath424 unchanged , then the new tableau still has no inversions , and the descents in the second row remain the same ( and left - justified ) .",
    "let @xmath207 be the number of descents among the @xmath79 s .",
    "if @xmath823 , there are no descents , and we must have @xmath824 so as not to have inversions . in this case , @xmath803 drops down into the first position in the bottom row , and there are still no descents and no inversions since @xmath825 in this case .    if @xmath826 , then @xmath827 is the last descent . since @xmath828 and @xmath803 do not form an inversion in the original tableau , we must either have @xmath829 or @xmath830 .",
    "we consider these cases separately .",
    "_ case 1 : _",
    "suppose @xmath829 .",
    "then @xmath831 , i.e. @xmath803 drops to a position to the right of the last descent , after which point we have @xmath832 for all such @xmath54 .",
    "thus , for instance , @xmath833 , and since @xmath803 and @xmath834 did not originally form a descent , we must have @xmath835 .",
    "this means that @xmath836 , so @xmath834 still does not form a descent in the new tableau . then , similarly we have @xmath837 , and so @xmath838 , and so on .",
    "thus the descents have stayed the same in the new tableau .",
    "furthermore , since @xmath839 for all @xmath840 in this case , we have @xmath841 for all @xmath840 , and since the @xmath780 s after position @xmath207 are weakly increasing , none of these form inversions .",
    "since @xmath842 are above the same letters @xmath843 as before and are in the same positions relative to the other @xmath780 s , they can not be the left elements of inversions either .",
    "_ case 2 : _ suppose now that @xmath830 . if @xmath844 then in fact it drops to the right of @xmath845 and it is the same as the previous case .",
    "so we can assume that @xmath846 .",
    "then @xmath847 , i.e. @xmath803 drops to a position underneath a descent of the original tableau shape .",
    "since @xmath848 and @xmath849 is a descent , we have @xmath850 and so @xmath834 is still a descent in the new tableau .",
    "similarly @xmath780 is still a descent for all @xmath851 . to check that @xmath852 is still _ not _ a descent , assume it is : that @xmath853",
    ". then @xmath854 , and so @xmath855 since the original filling had no inversions .",
    "if @xmath856 , we get a contradiction , so @xmath857 .",
    "but then @xmath858 , contradicting the fact that @xmath859 .",
    "thus there is not an inversion in the @xmath860st position .",
    "hence the descents stay the same in this case as well .",
    "furthermore , consider @xmath780 and @xmath861 with @xmath862 : if @xmath54 is among @xmath863 then @xmath780 and @xmath861 do not form an inversion since @xmath780 is still above @xmath204 .",
    "if @xmath54 and @xmath136 are both among @xmath864 , then they do not form an inversion , since @xmath780 and @xmath861 are both descents and @xmath865 . if @xmath54 is among @xmath864 and @xmath866 , note that @xmath867 since it is in the run of non - descents of the @xmath79 s .",
    "hence @xmath868 by transitivity , and so @xmath869 since @xmath780 is a descent .",
    "this implies that @xmath780 and @xmath861 do not form an inversion . finally ,",
    "if @xmath870 and @xmath724 , we are once again in the run of non - descents at the end , which is weakly increasing , and hence there are no inversions since none are descents .",
    "we conclude that the @xmath780 s have no inversions among them in this case either .",
    "[ ontop ] let @xmath800 , @xmath871 , and @xmath872 be numbers such that the partial filling @xmath873 has no inversions in the second row .",
    "then there exists an ordering @xmath874 of @xmath875 such that if @xmath876 is the unique ordering of @xmath877 for which the partial filling @xmath878 has no inversions in the second row , then the entry @xmath872 is directly above @xmath803 in the new filling .    let @xmath879 be the two - row filling consisting of the @xmath47 s and @xmath42 s as in the statement of the lemma .",
    "let @xmath267 be the cocharge word of @xmath879 , with the bottom row indexed by @xmath67 and the top by @xmath68 .",
    "then @xmath267 consists of @xmath67 s and @xmath68 s , and as in lemma [ aabb ] , the number of descents in @xmath879 is the crossing number of this word .",
    "so @xmath803 is one of the @xmath67 s in this word , and @xmath872 is one of the @xmath68 s , and we wish to show that there is some ordering of the @xmath67 s in which @xmath803 is paired with @xmath872 .",
    "assume to the contrary that @xmath803 can not be paired with @xmath872 no matter how we order the @xmath67 s .",
    "choose a cyclic shift @xmath880 of @xmath267 whose crossing number is @xmath67 , as we did in lemma [ aabb ] .",
    "if @xmath803 is to the left of @xmath872 in @xmath880 , then since it ca nt be paired with @xmath872 there must be an index @xmath207 between that of @xmath803 and @xmath872 at which the prefix of the first @xmath207 letters is @xmath67-dominated . for , if there were more @xmath67 s than @xmath68 s at every step up to @xmath872 then we can pair off the other @xmath67 s starting from the left until @xmath872 is the first @xmath68 to the right of @xmath803 .",
    "this means we can choose a different cyclic ordering , starting at the @xmath881st letter , for which the crossing number is also @xmath67 . in this cyclic shift ,",
    "@xmath872 is to the left of @xmath803 .",
    "so we have reduced to the case that @xmath872 is to the left of @xmath803 .    in this case , @xmath872 is one of the @xmath68 s , and @xmath803 is one of the @xmath67 s , e.g. in the @xmath67-dominated sequence @xmath882 , we might have @xmath872 be the third entry and @xmath803 the fourth . before we dropped down the @xmath803 and @xmath872 , we had a tableau whose cocharge word looked like this word except with the @xmath67 of @xmath803 replaced by a @xmath68 , and the @xmath68 of @xmath872 replaced by a @xmath74 ( in the example , this would give us the word @xmath883 . ) remove the @xmath74 from this word . in the resulting word of @xmath67 s and @xmath68 s , since we have bumped up a @xmath67 to a @xmath68 but removed one of the @xmath68 s before it , every prefix is @xmath67-dominated except the entire word , which has one more @xmath68 than it has @xmath67 s .",
    "thus the very last @xmath68 is the only entry which is not paired .",
    "but @xmath803 is , by assumption , the entry which is unpaired in the original ordering .",
    "this is a contradiction , since @xmath803 was a @xmath67 in the bumped - down word and hence could not have been in the last position .",
    "it follows that there must exist an ordering of the @xmath67 s in which @xmath803 is paired with @xmath872 .",
    "this completes the proof .    in the next two lemmas , we let @xmath419 be a filling with @xmath174 whose",
    "largest entry appears in the bottom row , and let @xmath884 be constructed from @xmath50 as in the statement of proposition [ zerobump ] .",
    "[ cochargeconservation1 ] suppose @xmath174 .",
    "let @xmath277 be an index such that @xmath885 , i.e. the @xmath290st row of @xmath2 is as long as the bottom row .",
    "then we have @xmath886    we induct on @xmath54 . for the base case ,",
    "@xmath887 , the left hand side is the total cocharge contribution of the entries @xmath888 and the entry @xmath889 .",
    "the square @xmath890 is filled with the largest number @xmath43 , by our assumption that @xmath43 appears in the bottom row and the fact that @xmath174 .",
    "thus the entry in @xmath889 can not be a descent , and so the cocharge contribution of all of these entries are @xmath67 . thus the left hand side is @xmath67 .",
    "the right hand side is also @xmath67 , since it is the sum of the cocharge contributions from the bottom row of @xmath429 .    for the induction , let @xmath629 and suppose the claim is true for @xmath331 .",
    "then the induction hypothesis states that @xmath891 then if there are @xmath207 descents among the entries @xmath892 and @xmath893 of @xmath50 , then their total cocharge contribution is equal to @xmath894 , since they are the entries strictly above those that contribute to the left hand side of the equation above .",
    "so , to show that @xmath895 it suffices to show that the total cocharge contribution of the @xmath54th row of @xmath429 is also @xmath894 . by the induction hypothesis it is equivalent to show that there are @xmath207 descents among the entries in the @xmath54th row of @xmath429 .",
    "now , let @xmath896 be the width of the tableau , and let @xmath800 be the first @xmath811 entries in row @xmath331 of @xmath50 .",
    "let @xmath801 be the elements of row @xmath54 , and let @xmath872 be the entry in square @xmath897 , above @xmath803 .",
    "@xmath898    consider the @xmath899 tableau @xmath879 with bottom row elements @xmath875 and top row elements @xmath877 . by lemma [ ontop ]",
    ", there is a way of rearranging the bottom row of @xmath879 such that if we rearrange the top row respectively , then @xmath872 lies above @xmath803 .",
    "this suffices , for now the remaining columns will form a tableau with no inversions in the second row , with @xmath800 and @xmath424 as the entries of the rows . by lemma [ twist ] this has the same number of descents independent of the ordering of the @xmath204 s , and @xmath872 will be a descent or not depending on whether it was a descent before .",
    "thus there are still @xmath207 descents in the @xmath54th row .",
    "lemma [ cochargeconservation1 ] shows that the cocharge contribution is conserved for rows @xmath54 for which @xmath900 .",
    "the next lemma will show that the cocharge contribution is unchanged for higher rows as well .",
    "again , here @xmath50 is a filling having its largest entry @xmath43 occurring in the bottom row .",
    "[ cochargeconservation2 ] suppose @xmath174 , and the rightmost ( @xmath60th ) column of @xmath2 has height @xmath901 .",
    "then in @xmath429 , row @xmath307 consists of the first @xmath811 letters of row @xmath307 of @xmath50 in the same order , and their cocharge contributions are the same as they were in @xmath50 .",
    "it follows from this lemma that all higher rows are unchanged as well , and combining this with lemma [ cochargeconservation1 ] , it will follow that @xmath902 .",
    "we induct on @xmath307 , the height of the rightmost column . for @xmath903 and @xmath904 ,",
    "we are done by previous lemmata ( see lemma [ tworowdrop ] ) .",
    "so , suppose @xmath905 and the claim holds for all smaller @xmath307 .    performing the operation of proposition [ zerobump ] , suppose we have bumped down all but the topmost entry ( in row @xmath307 ) of the rightmost column and rearranged each row with respect to the previous .",
    "let rows @xmath906 , @xmath907 , and @xmath307 have contents : @xmath908 notice that , by the induction hypothesis , the entries @xmath909 are the same as they were in @xmath50 before bumping down @xmath872 and have the same cocharge contributions as they did before .",
    "thus the row of @xmath383 s as shown is currently the same as row @xmath307 of @xmath50 .",
    "so , we wish to show that upon bumping @xmath910 down and rearranging all rows so that the filling has no inversions , the entries in row @xmath307 are still @xmath911 in that order , and that these entries have the same cocharge contributions as they did before .",
    "we first show that the entries @xmath912 do not change their positions upon bumping @xmath910 down to row @xmath907 ( and rearranging so that there are still no inversions . )",
    "we proceed by strong induction on the width @xmath60 . for the base case ,",
    "@xmath913 , we have that @xmath621 is the only entry left in the top row , and therefore can not change its position .",
    "now , assume that the claim is true for all widths less than @xmath60 .",
    "if @xmath910 bumps down and inserts in a row @xmath42 above @xmath914 , then the numbers @xmath915 are still above @xmath916 respectively since they are still first in cyclic order after each .",
    "likewise the entries @xmath917 remain the same in this case .",
    "thus we may delete the first @xmath710 columns and reduce to a smaller case , in which the claim holds by the induction hypothesis .",
    "this allows us to assume that when @xmath910 bumps down , it is in the first column , above @xmath918 , and so the tableau looks like : @xmath919 where the @xmath920 s are an appropriate permutation of the indices for @xmath912 and @xmath909 .",
    "we now show that @xmath921 remain in their respective positions for all @xmath922 , by induction on @xmath46 .",
    "( so , we are doing a triple induction on the height , the width of the tableau , and the index of the @xmath383 s ) .",
    "for the base case , we wish to show that @xmath621 is the entry above @xmath910 in the new tableau .",
    "we have , from the fact that @xmath923 , that the following triples are in cyclic order for any @xmath207 such that @xmath924 :    1 .",
    "@xmath925 , with possible equalities @xmath926 , @xmath927 2 .   @xmath928 , with possible equalities @xmath929 , @xmath930 3 .",
    "@xmath931 , with possible equalities @xmath932 , @xmath933 4 .",
    "@xmath934 , with possible equalities @xmath935",
    ", @xmath936    combining ( 1 ) and ( 2 ) above , we have that @xmath937 are in cyclic order , and so in particular @xmath938 is in cyclic order . combining this with ( 3 ) above , we have @xmath939 are in cyclic order , and in particular so are @xmath940 . using this and ( 4 )",
    ", we have @xmath941 are in cyclic order , and in particular either @xmath942 or @xmath943 , and so @xmath944 are in cyclic order with either @xmath945 or @xmath946 ; this implies that @xmath621 and @xmath947 will not form an inversion if @xmath621 is placed above the @xmath910 .",
    "thus @xmath621 does indeed stay in the leftmost column .",
    "for the induction step , suppose @xmath948 are in columns @xmath949 respectively in @xmath429 .",
    "we wish to show that @xmath620 must be in the @xmath46th position .",
    "to do so , first notice that since @xmath134 is first in cyclic order after @xmath117 among @xmath950 for each @xmath54 , we have that for each @xmath54 , the element that appears above @xmath117 after bumping @xmath910 down is among @xmath951 .",
    "suppose @xmath952 is above @xmath953 in the new tableau for some @xmath954 .",
    "then @xmath947 is in this column as well by the induction hypothesis , and so removing this entire column will not affect the relative ordering of the remaining entries .",
    "but now @xmath620 is the @xmath955st of the @xmath383 s in question , and therefore must be in the @xmath955st position by the induction hypothesis , and so must be in the @xmath46th position in the full tableau ( prior to removing the @xmath207th column ) .",
    "otherwise , if @xmath952 is never above @xmath953 for any @xmath954 , we have that @xmath155 must appear above @xmath956 , since it can only be @xmath155 or @xmath156 but is not @xmath156 by assumption .",
    "then , @xmath156 must appear above @xmath957 , and so on , up to @xmath958 appearing above @xmath959 .",
    "if @xmath960 appears above @xmath961 , then @xmath620 must be above that since we knew from the previous tableau that it is first in cyclic order after @xmath960 among @xmath962 .",
    "so the only case that remains is where @xmath963 appears in column @xmath46 , above @xmath961 .",
    "the diagram is as follows : @xmath964 we wish to show that the entry @xmath965 above is @xmath620 .",
    "first , we claim that @xmath966 are in cyclic order . for",
    ", we have @xmath967 and @xmath925 are in cyclic order , so @xmath968 are .",
    "since @xmath969 and @xmath970 are in cyclic order , we have that @xmath971 are in cyclic order . since @xmath972 are in cyclic order as well , we can combine this with the last two observations to deduce that @xmath973 are in cyclic order .",
    "now , we can use the triples @xmath974 , @xmath975 , and @xmath976 to deduce that @xmath977 are in cyclic order as well .",
    "but since @xmath978 are in cyclic order , this means that @xmath979 are in cyclic order as well , and so on . at each step , to add @xmath952 to the list we only need consider rows up to that of @xmath980 .",
    "hence , the process continues up to @xmath981 .",
    "finally , notice that since we are only concerned with relative cyclic order of the entries to determine their positions , we may cyclically increase all the entries modulo the highest entry in such a way that @xmath982 in actual size .",
    "furthermore , since we are currently only concerned with the position of @xmath620 , which is determined by its relative ordering with @xmath217 for @xmath983 and with @xmath963 , we may assume that @xmath984 are increasing as well ; it will make no difference as to the value of @xmath965 .",
    "but then the top two rows behave exactly as in the two - row case of lemma [ tworowdrop ] .",
    "we know that @xmath620 occurs in the @xmath46th column from this lemma , and the induction is complete .",
    "we have shown that @xmath912 retain their ordering , and it remains to show that they retain their cocharge contributions . if any @xmath952 lies above @xmath953 , and hence @xmath947 above it , the column has not changed and so @xmath947 does indeed retain its cocharge contribution .",
    "so , as before , we may remove such columns and reduce to the case in which the entries are : @xmath985 for the first column , we have that @xmath925 are in cyclic order since @xmath910 and @xmath155 do not form an inversion .",
    "moreover , either @xmath986 or @xmath987 , in which case we may assume that @xmath910 is in fact located in the second column instead , and reduce to a smaller case .",
    "so we may assume @xmath986 .",
    "in addition , @xmath988 are in cyclic order , with @xmath942 unless @xmath989 , and if @xmath990 then we must have @xmath991 so that @xmath621 does not form an inversion with any element in the new tableau .",
    "we now consider three cases based on the actual ordering of @xmath992 ( which are in cyclic order ) :    _ case 1 : _",
    ". then since @xmath988 are in cyclic order , either @xmath621 is greater than both @xmath155 and @xmath910 or less than or equal to both . since both @xmath155 and @xmath910 are descents when over @xmath918 , the cocharge contribution of @xmath621 is unchanged in this case .",
    "_ case 2 : _",
    "suppose @xmath994 .",
    "then in this case neither @xmath155 nor @xmath910 is a descent when in the first column , and the same analysis as in case 1 shows that @xmath621 has the same cocharge contribution in either case .",
    "_ case 3 : _",
    "suppose @xmath995 . then @xmath996 .",
    "if @xmath621 is strictly greater than @xmath155 , it forms a descent with @xmath155 and not with @xmath910 . but note that @xmath910 is a descent when in the first column , and @xmath155 is not , so the total number of descents weakly beneath @xmath621 balances out and is equal in either case . if @xmath997 , then @xmath991 , which is impossible since then @xmath998 .",
    "so the cocharge contribution of @xmath621 is the same in this case as well .",
    "this completes the proof that @xmath621 retains the same cocharge contribution .",
    "we now show the same holds for an arbitrary column @xmath54 .    in the @xmath54th column",
    ", we have @xmath217 above @xmath999 above @xmath117 .",
    "note that @xmath1000 and @xmath1001 are in cyclic order ( the latter by the above argument which showed that @xmath1002 are in cyclic order given that the @xmath134 s are arranged as above ) , so @xmath1003 are in cyclic order .",
    "in particular @xmath1004 are in cyclic order . moreover , if @xmath1005 then @xmath1006 .",
    "since @xmath1007 are in cyclic order we must have @xmath1008 in this situation .",
    "we also have that @xmath1009 are in cyclic order , and by a similar argument as above we can assume @xmath1010 .",
    "so either @xmath1011 , @xmath1012 , or @xmath1013 .",
    "the exact same casework as above for these three possibilities then shows that @xmath217 retains its cocharge contribution .",
    "proposition [ zerobump ] now follows immediately from lemmas [ cochargeconservation1 ] and [ cochargeconservation2 ] and proposition [ cochargecontributions ] .",
    "we first recall the statement of the theorem .",
    "[ rectanglebump ] let @xmath343 be the alphabet with content @xmath402 , and let @xmath435 be a rectangle shape of size @xmath43 .",
    "then there is a weighted set isomorphism @xmath436 defined combinatorially by the following process",
    ".    1 .   given a filling @xmath419 with distinct entries @xmath437 and @xmath174 , let @xmath54 be the row containing the entry @xmath43 . split the filling just beneath row @xmath54 to get two fillings @xmath438 and @xmath439 where @xmath439 consists of rows @xmath440 of @xmath50 and @xmath438 consists of rows @xmath54 and above .",
    "rearrange the entries of the rows of @xmath438 in the unique way that forms a filling @xmath441 for which @xmath442 .",
    "3 .   apply the procedure of proposition [ zerobump ] to @xmath441 , that is , removing the @xmath43 from the bottom row and bumping each entry in the last column down one row .",
    "let the resulting tableau be called @xmath443 .",
    "4 .   place @xmath443 on top of @xmath439 and rearrange all rows to form a tableau @xmath176 having @xmath444",
    ". then we define @xmath445 .    moreover , if @xmath446 , then @xmath447 and we assign @xmath448 to the @xmath383th set in the disjoint union .",
    "we first need to prove lemma [ pullup ] , which is a sort of inverse to lemma [ dangle ] .    given two collections of letters @xmath424 and @xmath425",
    ", there is a unique element @xmath204 among @xmath426 such that , in any two - row tableau with @xmath427 as the entries in the bottom row and @xmath428 as the entries in the top , with no inversions in the top row , the entry @xmath204 occurs in the rightmost position in the top row .    as usual",
    ", let us think of the @xmath204 s as @xmath67 s and the @xmath780 s as @xmath68 s in a cocharge word , arranged according to the magnitudes of the @xmath204 s and @xmath780 s",
    ". then we have a sequence of @xmath60 @xmath67 s and @xmath811 @xmath68 s , and we wish to show that there is a unique @xmath67 that , when we change it to a @xmath68 , is not paired with any @xmath67 when computing the crossing number . by lemma [ dangle ]",
    ", there is a unique such @xmath68 in any word of @xmath811 @xmath67 s and @xmath60 @xmath68 s .",
    "so , by lemma [ dangle ] , it suffices to find a @xmath67 in the original tableau such that upon removal , the remaining sequence starting with the entry to its right is @xmath67-dominated .",
    "for instance , in the sequence @xmath1014 , which has @xmath227 zeros and @xmath73 ones , if we remove the second - to - last zero and cyclically shift the letters so that the new sequence starts with the @xmath67 to its right , we get the sequence @xmath1015 , which is @xmath67-dominated .    to show that there is a unique such @xmath67 ,",
    "consider the up - down walk starting at @xmath67 in which we move up one step for each @xmath67 in the sequence and down one step for each @xmath68 .",
    "then we end at height @xmath68 , since there is one more @xmath67 than @xmath68 in the sequence .",
    "for instance , the sequence @xmath1014 corresponds to the up - down walk :        consider the last visit to the minimum height of this walk .",
    "if the minimum height is @xmath67 then we simply remove the last @xmath67 in the sequence and we are done . if the minimum height is less than @xmath67 , then there are at least two up - steps ( @xmath67 s ) following it since it is the last visit to the min .",
    "the first of these up - steps corresponds to a @xmath67 which we claim is our desired entry .",
    "indeed , if we remove this @xmath67 , the walk starting at the next step and cycling around the end of the word is a positive walk , corresponding to a @xmath67-dominated sequence .",
    "it is easy to see that if we do the same with any of the other @xmath67-steps , the resulting walk will not be positive and so the corresponding sequence will not be @xmath67-dominated .",
    "this completes the proof .",
    "we now have the tools to prove theorem [ rectanglebump ] .",
    "it is clear that @xmath380 is a morphism of weighted sets , preserving the statistics , so we only need to show that @xmath380 is a bijection .",
    "to do so , we construct an inverse map @xmath1016 that takes a pair @xmath1017 and returns an appropriate filling @xmath1018 , where @xmath1019 is a filling with no inversions using the letters @xmath1020 , and @xmath383 is a number with @xmath1021 . for simplicity",
    "let @xmath450 be the height of @xmath2 .",
    "let @xmath1017 be such a pair .",
    "consider the fillings @xmath1022 formed as follows .",
    "let @xmath1023 be the tableau obtained by inserting the number @xmath43 into the top row of @xmath176 and rearranging the entries of the top row so that @xmath1024 .",
    "let @xmath1025 be the tableau formed from @xmath176 by first moving the unique element of the @xmath1026st row given by lemma [ pullup ] to the top row , and then inserting @xmath43 into the @xmath1026st row and rearranging all rows so that there are no inversions again .",
    "then , let @xmath1025 be formed from @xmath176 by first moving the same element , call it @xmath1027 , up to the top row , then using lemma [ pullup ] again to move an element @xmath1028 from row @xmath906 to row @xmath907 , and finally inserting @xmath43 in row @xmath906 and rearranging the rows again so that there are no inversions . continuing in this manner , we define each of @xmath1029 likewise , and it is easy to see that @xmath1030 for all @xmath54 , by using lemma [ dangle ] repeatedly .",
    "now , we wish to show that the numbers @xmath1031 for @xmath458 form a permutation of @xmath1032 .",
    "let @xmath472 be the elements of rows @xmath1033 that were moved up by @xmath68 in each of the steps as described above . by proposition [ zerobump ] , the filling @xmath462 , whose rightmost column has entries @xmath1034 from top to bottom , has the same major index as @xmath176 .",
    "so @xmath1035 , and @xmath1036 .",
    "we will now compare all other @xmath1037 s to @xmath462 rather than to @xmath176 .",
    "we claim that the difference in the major index from @xmath462 to @xmath1037 is the same as the difference obtained when moving @xmath43 up to row @xmath54 ( and shifting all lower entries down by one ) in the one - column filling having reading word @xmath1034 .",
    "then , by carlitz s original bijection , we will be done , since each possible height gives a distinct difference value @xmath383 between @xmath67 and @xmath907 .    to proceed , consider the total number of descents in each row .",
    "in @xmath1037 , the entry @xmath43 is in the @xmath54th row .",
    "let @xmath443 consist of the top @xmath1038 rows of this filling , arranged so that @xmath1039",
    ". then the top @xmath1040 rows ( row @xmath74 to @xmath1038 of @xmath443 ) are the same as in @xmath462 , with the same descents .",
    "thus if we rearrange _ every _ row with respect to the one beneath , including rows @xmath331 and below to form @xmath1037 , each row also has the same number of descents as it does in @xmath462 by lemma [ twist ] .",
    "we now show the same is true for row @xmath276 . in @xmath443",
    ", we have @xmath580 above @xmath43 , and the remaining entries in that row are above the same set of entries they were in @xmath462 .",
    "so the number of descents in row @xmath276 goes down by @xmath68 from @xmath462 to @xmath1037 if @xmath1041 , and otherwise it remains the same .    for rows @xmath54 and below",
    ", we use lemma [ ontop ] . for any row @xmath42 from @xmath74 to @xmath54 ,",
    "the entries of row @xmath710 can be rearranged so that if row @xmath42 is arranged on top of it with no inversions , the entry @xmath1042 lies in the space above @xmath1043 ( or @xmath43 lies above @xmath1044 in the case @xmath1045 . )",
    "the remaining entries in the top row of this two - row arrangement are then above the same set of entries they were in @xmath462 , with no inversions between them , and by lemma [ twist ] they have the same number of descents among them .",
    "so , the descents have only changed by what the comparison of each @xmath1046 with @xmath1043 ( or @xmath43 with @xmath1044 ) contributes .",
    "therefore , the number of descents in a given row of @xmath1037 , relative to @xmath462 , can either increase by @xmath68 , stay the same , or decrease by @xmath68 , according to whether it does in the one - column shape filled by @xmath1047 when we move @xmath43 up to height @xmath54 .",
    "now , for rectangular shapes , if @xmath1048 is the total number of descents in row @xmath42 , it is easy to see that the total cocharge contribution ( major index ) of the filling is the sum of the partial sums @xmath1049 since the values of @xmath1048 in @xmath1037 differ by @xmath67 or @xmath1050 from the corresponding values of @xmath462 , it follows that the difference @xmath217 is the sum of the partial sums of these differences .",
    "but this is the same as the difference in the one - column case we are comparing to .",
    "this completes the proof .",
    "note that proposition [ rectbumpcor1 ] and theorem [ rectbumpcor2 ] also follow immediately from the above proof .    finally , we prove proposition [ rectbumpcor3 ] of section [ rectangles ] .",
    "let @xmath2 be a rectangle shape of height @xmath307 , and let @xmath471 with its largest entry @xmath43 in row @xmath54 .",
    "then if @xmath472 is the bumping sequence of @xmath50 , then @xmath473 all occur in columns weakly to the right of the @xmath43 , and each @xmath474 is weakly to the right of @xmath475 for @xmath476 .",
    "let @xmath1051 be the entries in row @xmath54 from left to right .",
    "consider the reordering of row @xmath54 given by @xmath1052 and order row @xmath276 with respect to this ordering .",
    "let the numbers in the new ordering in row @xmath276 be @xmath1053 .",
    "then @xmath580 is the same as the value of @xmath580 from theorem [ rectbumpcor2 ] by lemma [ dangle ] ; that is , @xmath204 would lie above @xmath43 if we ordered @xmath1054 by size as well .",
    "now , since @xmath1055 are the first @xmath46 entries in both orderings of row @xmath54 , it follows that @xmath1056 must be the first @xmath46 entries in both corresponding orderings of row @xmath276 .",
    "thus @xmath204 , not being equal to any of @xmath1056 , must be weakly to the right of the column that @xmath43 is in .    the same argument",
    "can be used to show that @xmath1057 is weakly to the right of @xmath204 as well , and so on .",
    "this completes the proof .",
    "we first prove lemma [ threerows ] , restating the definition of @xmath380 as part of the statement .",
    "let @xmath477 be any three - row shape of size @xmath43 .",
    "then there is a morphism of weighted sets @xmath530 defined combinatorially by the following process . given an element @xmath50 of @xmath463 ,",
    "consider its largest entry @xmath43 .",
    "let @xmath208 be the @xmath1058 rectangle contained in @xmath50 .    1 .",
    "if the @xmath43 is to the right of @xmath208 , remove the @xmath43 according to the process in lemma [ tworows ] to form @xmath448 .",
    "if the @xmath43 is in the bottom row and in @xmath208 , then the shape is a rectangle and we remove it according to theorem [ rectanglebump ] to obtain @xmath448 .",
    "3 .   if the @xmath43 is in the second row and in @xmath208 , let @xmath520 be the top entry of the bumping sequence of @xmath208 .",
    "let @xmath79 be the entry in square @xmath521 if it exists , and set @xmath522 if it does not .",
    "if @xmath523 , then remove the @xmath43 and bump down @xmath520 to the second row . if @xmath524 , simply remove the @xmath43 .",
    "rearrange all rows of the resulting tableau so that there are no inversions , and let @xmath448 be this filling .",
    "4 .   if the @xmath43 is in the top row and in @xmath208 , let @xmath525 be the bumping sequence in @xmath208 . if @xmath526 or @xmath527 , then simply remove the @xmath43 , and otherwise , if @xmath528 and @xmath1059 , then remove @xmath43 and bump @xmath520 up to the top row .",
    "rearrange all rows so that there are no inversions , and setet @xmath448 to be the resulting filling .",
    "we wish to show that @xmath380 is a morphism of weighted sets , i.e. that it preserves the statistics on the objects . if the @xmath43 is in the bottom row , then @xmath1060 is in the @xmath418 component of the disjoint union and the maj is preserved , by proposition [ zerobump ] . if @xmath43 is in the second row and to the right of column @xmath1061 , then by lemma [ tworows ] the difference in maj upon removing it is @xmath68 and we obtain a filling in the @xmath488 component of the disjoint union .",
    "this leaves us with two possibilities : @xmath43 is in the second row and weakly to the left of column @xmath1061 , or @xmath43 is in the top ( third ) row . in either case , if @xmath527 then the mapping is the same as that in theorem [ rectanglebump ] , and we get a map to either the @xmath488 or @xmath1062 component of the disjoint union .",
    "so we may assume @xmath1059 .",
    "_ suppose that @xmath43 is in the second row .",
    "we have two subcases to consider : @xmath1063 and @xmath523 .    if @xmath524 , @xmath448 is formed by removing the @xmath43 and rearranging so that there are no inversions .",
    "note that any entry @xmath54 to the right of @xmath43 in row @xmath74 is less than the entry directly south of @xmath43 .",
    "furthermore , such entries @xmath54 are not descents and are increasing from left to right .",
    "thus these entries simply slide to the left one space each to form @xmath448 after removing the @xmath43 .",
    "so @xmath79 is the only new entry to be weakly to the left of column @xmath1061 in @xmath448 .",
    "since @xmath79 is not a descent , the effect on the major index is the same as if we simply replaced @xmath43 by @xmath79 in @xmath208 .",
    "consider any arrangement of the second row of @xmath208 in which @xmath43 is at the end , and arrange the top row relative to this ordering .",
    "then @xmath520 is at the end of this top row by its definition , and so replacing @xmath43 by @xmath79 will make @xmath520 a descent and thereby increase the total cocharge contribution by @xmath68 . by lemma [ twist ] this is the same as the increase in the the cocharge contribution from @xmath50 to @xmath448 .",
    "hence @xmath448 lies in the @xmath488 component of the disjoint union .",
    "if @xmath523 , we claim that if @xmath777 is the entry in the bottom row of the bumping sequence , then @xmath1064 .",
    "if @xmath777 is to the right of the column that @xmath43 is in then the claim clearly holds .",
    "otherwise , let @xmath1065 be the consecutive entries in the bottom row starting from @xmath777 and ending at the entry @xmath217 beneath the @xmath43 , and let @xmath951 be the entries in the second row from the entry above @xmath777 to the entry just before the @xmath43 .",
    "the @xmath1066 s are all descents , and the @xmath1066 s and @xmath1067 s are both increasing sequences",
    ". since there are no inversions in the second row , we have @xmath1068 . since removing the @xmath43 and bumping up @xmath777 results in the @xmath777 at the end of the second row by definition , upon doing this the @xmath217 s all slide to the left one space , and the @xmath134 s must also remain in position and remain descents by proposition [ zerobump ] .",
    "in particular , this means that @xmath1069 , and so @xmath1070 as well .",
    "but then since there are no inversions it follows that @xmath1071 , which is less than @xmath999 , and so on .",
    "continuing , we find that @xmath1064 as claimed .    since @xmath1072 by assumption",
    ", it follows that @xmath1073 and so removing the @xmath43 and bumping down @xmath520 in the rectangle results in a difference in major index of @xmath74 by theorem [ rectbumpcor2 ] .",
    "note also that if we perform this bumping in the entire filling @xmath50 , the entry @xmath520 ends up to the left of column @xmath1074 since @xmath1075 and hence it is to the left of @xmath79 in the second row .",
    "thus the entries to the right of the rectangle are preserved , and @xmath1076 .",
    "it follows that @xmath448 lies in the @xmath1062 component of the disjoint union .",
    "_ case 2 . _",
    "suppose @xmath43 is in the top row .",
    "if @xmath526 , then removing @xmath43 results in the major index decreasing by @xmath1062 , and so @xmath448 is in the @xmath1062 component of the disjoint union . otherwise , @xmath528 .",
    "since @xmath1059 , we remove the @xmath43 and bump @xmath520 up to the top row .",
    "since @xmath528 , by theorem [ rectbumpcor2 ] we find that simply removing the @xmath43 results in a decrease by @xmath68 in the major index .",
    "since the top row has had a descent removed ( by the proof of theorem [ rectanglebump ] ) , it follows that the empty space created in the top row was not above a descent , for otherwise the major index would decrease by @xmath74 .",
    "thus in particular @xmath79 is not a descent .",
    "it follows that if @xmath503 is formed by bumping up @xmath520 and inserting @xmath43 in the second row , then the @xmath43 , being the last descent in the second row , will appear among the first @xmath1061 columns of @xmath503 .",
    "in addition , since @xmath528 this results in an _ increase _ in major index by @xmath68 from @xmath50 to @xmath503 , by proposition [ rectbumpcor1 ] .",
    "we now wish to show that @xmath523 ; if so , we claim removing @xmath43 from @xmath503 will result in a decrease by @xmath74 in the major index , and will also result in the tableau @xmath448 , thereby showing that @xmath1077 and so @xmath448 is in the @xmath488 component . to see that the major index decreases by @xmath74 on removing @xmath43 , note that by proposition [ rectbumpcor2 ] , the effect of removing the @xmath43 is the same as replacing @xmath43 by @xmath79 in the one - column shape with entries @xmath1078 .",
    "if @xmath523 then we have that @xmath1064 by the same argument as in case 1 above , and so the major index decreases by @xmath74 .",
    "thus it suffices to show @xmath523 .",
    "if @xmath520 is not a descent of @xmath50 , this is clear , so suppose @xmath520 is a descent of @xmath50 in the second row .",
    "let @xmath182 be the entry directly below @xmath520 , and assume for contradiction that @xmath524 .",
    "then @xmath1079 , and furthermore the first non - descent in row @xmath74 , say @xmath1080 , is less than @xmath182 .",
    "note that by our above argument we know that @xmath1080 lies within the rectangle @xmath208 .",
    "now , we restrict our attention to @xmath208 and bump @xmath520 and @xmath777 up one row each , and consider the ordering of the bottom row in which we place @xmath182 in the column one to the left of the column that @xmath1080 was contained in and shift the remaining entries to the left to fill the row . rearranging the new second row with respect to the first , we consider the position of @xmath777 relative to @xmath182 .",
    "if @xmath777 is to the left of the @xmath182 we have a contradiction since @xmath777 must land in column @xmath1061 by lemma [ dangle ] and the definition of bumping sequence . therefore the entries in the second row to the left of @xmath182 are unchanged .",
    "since @xmath1081 , and all remaining entries in the second row are either @xmath777 or are less than @xmath182 , we have that @xmath777 must be on top of the @xmath182 in the second row .",
    "this is again a contradiction , since this implies that @xmath777 does not land in column @xmath1061 .",
    "it follows that @xmath523 , as desired .",
    "this completes the proof that @xmath380 is a well - defined morphism of weighted sets .",
    "the map @xmath380 of lemma [ threerows ] is an isomorphism .",
    "we know from the lemma above that @xmath380 is a morphism ; it suffices to show that it is bijective .",
    "first notice that the cardinality of @xmath1082 is @xmath1083 and the cardinality of @xmath1084 is @xmath1085 thus the cardinalities of the two sets are equal , and so it suffices to show that @xmath380 is surjective .    to do so , choose an element @xmath1086 of the codomain",
    ". then @xmath1086 can lie in any one of the three components of the disjoint union @xmath1087 , and we consider these three cases separately .    _ case 1 : _",
    "suppose @xmath1086 lies in the @xmath418 component .",
    "then we can insert @xmath43 in the bottom row so as to reverse the map of proposition [ zerobump ] , and we obtain an element @xmath50 of @xmath1088 which maps to @xmath1086 under @xmath380 .    _ case 2 : _ now , suppose @xmath1086 lies in the @xmath488 component . if @xmath527 then @xmath1089 and so we can find a filling @xmath50 of @xmath2 that maps to @xmath1086 by proposition @xmath1090 . otherwise , the shape of @xmath1086 is @xmath1091 and we wish to find a filling @xmath50 of shape @xmath2 for which @xmath1092 .",
    "let @xmath176 be the filling of @xmath2 formed by inserting @xmath43 into the second row and rearranging entries so that there are no inversions .",
    "notice that if the @xmath43 lies to the right of column @xmath1061 then @xmath1093 and we are done .",
    "so , suppose @xmath43 lies in the @xmath516 rectangle in @xmath176 .",
    "let @xmath777 and @xmath520 be the bumping sequence of this rectangle . since @xmath43 is the rightmost descent in the second row of @xmath176 , inserting it did not change the cocharge contribution of the portion to the right of column @xmath1061 ; there were no descents there in @xmath50 and there are none in @xmath176 .",
    "let @xmath79 be the entry in column @xmath1074 , row @xmath74 of @xmath176 .",
    "if @xmath524 , then @xmath1093 and we are done .    otherwise , if @xmath523 , then by the argument in lemma [ threerows ] we know that @xmath1094 .",
    "we have that @xmath1095 is the filling formed by removing the @xmath43 and bumping @xmath520 down to the second row , and that @xmath1096 .",
    "hence @xmath1097 .",
    "since @xmath523 , @xmath520 lies to the left of @xmath79 in @xmath443 and hence is weakly to the left of column @xmath1061 .",
    "so , let @xmath50 be the tableau formed by inserting @xmath43 in the top row of @xmath443",
    ". now @xmath50 has shape @xmath2 , and can be formed directly from @xmath176 by shifting the position of @xmath43 among @xmath777 and @xmath520 as in theorem [ rectbumpcor2 ] .",
    "it follows that @xmath1098 , and so @xmath1099 is equal to @xmath68 or @xmath141 .",
    "it is not @xmath141 because @xmath443 is formed from @xmath50 by removing an @xmath43 from the top row , which changes the major index by at most @xmath74 by theorem [ rectanglebump ] .",
    "it follows that @xmath1100 , and therefore @xmath528 by theorem [ rectbumpcor2 ] .",
    "thus @xmath1092 by the definition of @xmath380 .",
    "_ case 3 : _",
    "suppose @xmath1086 is in the @xmath1062 component .",
    "if @xmath527 then we simply insert @xmath43 into @xmath1086 in either row @xmath74 or @xmath141 according to theorem [ rectbumpcor2 ] to obtain a tableau @xmath50 with @xmath1092 .    otherwise , if @xmath1059 , @xmath1086 has shape @xmath1101 .",
    "let @xmath176 be the tableau of shape @xmath2 formed by inserting @xmath43 in the top row of @xmath1086 .",
    "let @xmath777 and @xmath520 be the entries in row @xmath68 and @xmath74 corresponding to this @xmath43 in the @xmath516 rectangle contained in @xmath176 .",
    "then if @xmath526 , @xmath1093 and we re done .    if instead @xmath528 , then removing @xmath43 from @xmath176 decreases its major index by @xmath68 .",
    "since the number of descents in the top row goes down by exactly @xmath68 by lemma [ tworows ] , we can conclude that the entry in row @xmath74 , column @xmath1061 is a non - descent ; otherwise removing @xmath43 from @xmath176 would decrease the major index by @xmath74 .",
    "so , let @xmath50 be the filling formed by removing @xmath43 from @xmath176 , bumping @xmath520 to the top row , and inserting @xmath43 in the second row .",
    "since there are non - descents in the rectangle we have that @xmath43 lies in the rectangle in @xmath50 as well .    finally , again by the argument used for lemma [ threerows ] we have that @xmath1075 where @xmath79 is the entry in row @xmath74 , column @xmath1074 in @xmath50 .",
    "thus @xmath1092 as desired .",
    "we can now complete the three - row case by using the standardization map @xmath228 defined in section [ threerowssection ] for fillings with repeated entries .",
    "we first state a structure lemma about three - row shapes with no inversions .",
    "[ patterns ] if the consecutive entries @xmath1102 in some row of a filling with no inversions are directly above a weakly increasing block of squares @xmath1103 in the row below , then there exists a @xmath207 for which @xmath818 are descents and @xmath1104 are not descents .",
    "moreover @xmath1105 and @xmath1106 are both increasing blocks of squares .",
    "this is clear by the definition of inversions .",
    "in particular , the second row has one ( possibly empty ) block of descents and one ( possibly empty ) block of non - descents .",
    "the third row has up to two blocks of descents , one for each of the blocks in the second row , and so on .",
    "we also need to show that the cardinalities of the sets are equal in the case of repeated entries .",
    "[ cardinalities ] we have @xmath1107 for any alphabet @xmath59 with content @xmath105 and any shape @xmath2 .",
    "given an alphabet @xmath59 , the cocharge word of any filling using the letters in @xmath59 has the property that it is weakly increasing on any run of a repeated letter , where we list the elements of @xmath59 from largest to smallest .",
    "furthermore , the cocharge word has content @xmath2 .",
    "it is not hard to see that a word is the cocharge word of a filling in @xmath325 if and only if it has content @xmath2 and is weakly increasing over repeated letters of @xmath59 , listed from greatest to least .",
    "recall that the fillings in @xmath1108 can be represented by their _ inversion word _ , and a word is an inversion word for such a filling if and only if it has content @xmath2 and every subsequence corresponding to a repeated letter of the reversed alphabet is in inversion - friendly order . by swapping the inversion - friendly order for weakly increasing order above each repeated letter",
    ", we have a bijection between inversion words and cocharge words , and hence a bijection ( of sets , not of weighted sets ) from @xmath325 to @xmath1108 . by theorem [ invcode ] , we have that @xmath1109 and so the cardinality of @xmath325 is equal to @xmath1110 as well .",
    "the map @xmath167 defined on three - row shapes @xmath477 is an isomorphism of weighted sets @xmath498 for each alphabet @xmath59 and corresponding content @xmath105 .    by lemmas [ threerows ] , [ threerowsbijective ] , and [ recursion ]",
    ", we have that for the content @xmath235 corresponding to alphabet @xmath389 $ ] , the map @xmath167 is a weighted set isomorphism @xmath499}.\\ ] ]    now , let @xmath59 be any alphabet with content @xmath105 .",
    "let @xmath50 be a filling of @xmath2 with content @xmath105 .",
    "then we know @xmath219 , so @xmath500}$ ] . in other words , @xmath304 is @xmath2-sub - yamanouchi .",
    "in addition , since @xmath228 is an injective map ( there is clearly a unique way to un - standardize a standard filling to obtain a filling with a given alphabet ) , the map @xmath167 , being a composition of @xmath228 and the @xmath167 for standard fillings , is injective as well on fillings with content @xmath105 .",
    "we now wish to show that @xmath501 is @xmath59-weakly increasing , implying that @xmath167 is an injective morphism of weighted sets to @xmath335 . by lemma [ cardinalities ]",
    "this will imply that it is an isomorphism of weighted sets .",
    "it suffices to show this for the largest letter @xmath302 of @xmath59 by the definition of standardization .",
    "suppose @xmath302 occurs @xmath54 times .",
    "we wish to show that @xmath1111 for all @xmath1112 .",
    "so choose @xmath1112 .",
    "suppose @xmath1113 .",
    "then by the definition of @xmath228 , we have that the @xmath302 we removed from @xmath1114 was in the bottom row . if there are still @xmath302 s in the bottom row of @xmath1115 then @xmath1116 as well .",
    "otherwise @xmath1117 , so @xmath1111 in this case .",
    "suppose @xmath1118 .",
    "then the @xmath302 we removed from @xmath1114 was in either the first or second row and there were no @xmath302 s in the bottom row . by the definition of @xmath380 , there are therefore no @xmath302 s in the bottom row of @xmath448 either , and so @xmath1119 .",
    "finally , suppose @xmath1120 .",
    "let @xmath1121 be the @xmath302 we remove from @xmath1114 to obtain @xmath1120 .",
    "as in the previous case we have @xmath1122 , and we wish to show @xmath1123 .",
    "let @xmath1124 be the corresponding @xmath302 .",
    "since @xmath1067 is minimal for @xmath1114 , there are no @xmath302 s in @xmath1114 which we can treat as the largest entry and remove according to @xmath380 to form @xmath1118 . therefore if we removed @xmath1124 before @xmath1121 we would also have a difference of @xmath74 in the major index .",
    "we consider three subcases separately for the locations of @xmath1121 and @xmath1124 : they can either both be in the second row , @xmath1121 can be in the second row with @xmath1124 in the third ( top ) row , or they can both be in the top row .",
    "no other possibilities exist because they must occur in reverse reading order , and can not be in the bottom row since @xmath1120 .    _ subcase 1 : _ suppose both @xmath1121 and @xmath1124 are in the second row",
    ". then @xmath1124 and @xmath1125 are at the end of the block of descents in that order , and weakly to the left of column @xmath1061 .",
    "let @xmath79 be the entry in row @xmath74 , column @xmath1074 .",
    "let @xmath520 be the entry in the third row in the bumping sequence of @xmath1121 , and let @xmath1126 be the entry in the bumping sequence of @xmath1124 in @xmath1127 .",
    "since @xmath1120 , we have @xmath1075 and @xmath1128 , and so @xmath1129 .",
    "therefore no new @xmath302 s are dropped down .",
    "in other words , @xmath1124 is indeed the @xmath302 that will be removed upon applying @xmath380 the second time .",
    "we now need to check that @xmath1124 remains to the left of column @xmath1061 after applying @xmath380 .",
    "indeed , by proposition [ rectbumpcor2 ] , we have that the number of descents in row @xmath74 goes down by one , and the number of descents in the top row remains the same , upon applying @xmath380 to @xmath1114 .",
    "since there are no @xmath302 s in the bottom row , @xmath1124 is the rightmost descent in the second row of @xmath1115 , and the descent we lost was @xmath1121 , so @xmath1124 remains in its column .",
    "we now just need to show that @xmath1130 , where @xmath1131 is the entry in row @xmath74 , column @xmath1061 after applying @xmath171 .",
    "either @xmath1132 , @xmath1133 , or @xmath1131 is the entry @xmath1134 that is bumped out from the first @xmath1135 columns when we drop down @xmath520 .",
    "consider any ordering of the first @xmath1061 entries of the second row of @xmath1114 such that the two @xmath302 s ( @xmath1124 and @xmath1121 ) are at the end in that order , and also place @xmath1134 in the third - to - last position .",
    "now , rearrange the entries above these so that there are no inversions .",
    "we know that @xmath520 is at the end of the top row , above @xmath1121 , by its definition .",
    "let @xmath119 be the entry above @xmath1124 and let @xmath182 be the entry to the left of that ( if such a column exists . )",
    "if @xmath1133 , then the first @xmath1135 entries of the second row are unchanged on applying @xmath380 . in our new ordering",
    "above , this means @xmath1136 , and since @xmath119 and @xmath520 occur above the two @xmath302 s in our new ordering , we have @xmath1137 .",
    "it follows that @xmath1130 .",
    "if @xmath1138 , then @xmath1131 is either @xmath79 or @xmath1134 . to find @xmath1126 in our new ordering , bumping down the @xmath520 can be thought of as replacing the @xmath1134 with @xmath520 and rearranging the top row again so that there are no inversions .",
    "the first @xmath1139 entries remain in the same positions , and either @xmath182 or @xmath119 lies above @xmath1124 based on which comes later in cyclic order after @xmath520 .",
    "so either @xmath1136 or @xmath1140 .",
    "we now have to show that whether @xmath1126 is @xmath119 or @xmath182 , it is less than both @xmath79 and @xmath1134 .",
    "notice that @xmath1141 : since @xmath1124 stays in its place , either @xmath520 replaces a larger entry among the descents in the second row , which in turn bumps out a larger entry @xmath1134 among the non - descents , or it replaces a non - descent itself and displaces a larger non - descent @xmath1134 to its right .",
    "so if @xmath1136 , then since @xmath1137 we have @xmath1142 and also @xmath1143 since @xmath1075 .    finally ,",
    "if @xmath1140 , then @xmath1144 are in cyclic order . if @xmath1145 we are done by the above argument",
    "otherwise @xmath1146 or @xmath1147 , in which case @xmath1136 and we are done by the previous case .",
    "so @xmath1148 , but we already know @xmath1137 , so we have a contradiction .",
    "it follows that @xmath1130 as desired .    _ subcase 2 :",
    "_ suppose @xmath1121 and @xmath1124 are in the top row .",
    "then by lemma [ patterns ] and since there are no @xmath302 s in the second row by the definition of @xmath228 , the @xmath302 s are either in the first or second block of descents in the third row .",
    "if either of them is in the second block , it is clear that removing @xmath1121 results in @xmath1118 , not @xmath74 , a contradiction .",
    "so they are both in the first block , themselves above descents in the second row , with @xmath1124 and @xmath1121 adjacent and in that order .",
    "now , removing @xmath1121 will cause the block of non - descents to its right to slide to the left one space ( since they are necessarily less than the entry beneath @xmath1121 ) . if the _ second _ block of non - descents in the third row is nonempty , one of these will replace the last entry above the descents in the second row , since all of these are still less than the entry below @xmath1121 and the least among the entries to the right will replace it . in that case",
    "the number of descents to the right of @xmath1121 is unchanged , and so @xmath1118 , a contradiction .",
    "thus there are no non - descents in the second block , i.e. above the non - descents in row @xmath74 .",
    "because of this , removing @xmath1121 simply causes all the entries to its right to slide to the left one space , and the first descent to its right becomes a non - descent .",
    "the same then happens when we remove @xmath1124 by the same argument .",
    "it follows that @xmath1149 in this case .    _ subcase 3 : _",
    "suppose @xmath1121 is in the second row and @xmath1124 in the top .",
    "then the @xmath1124 is to the left of @xmath1121 , in the first block of descents in the third row , since otherwise we would have a difference of @xmath68 on removing @xmath1124 .",
    "moreover , as in the previous case , the top row has no non - descents above the non - descents in row @xmath74 .",
    "so , let @xmath1150 be the entries in row @xmath141 that lie weakly to the right of @xmath1121 s column .",
    "then @xmath777 is not a descent and each of @xmath1151 are descents .",
    "let @xmath1152 be the entries below them .",
    "if we rearrange these in the second row in the increasing order @xmath1153 , and then rearrange the @xmath204 s above them as @xmath1154 so that there are no inversions , there are still @xmath1155 descents among the @xmath1156 s by lemma [ twist ]",
    ". these descents must be @xmath1157 by lemma [ patterns ] , and the last entry @xmath1158 above the @xmath1121 is the entry in @xmath1121 s bumping sequence .",
    "now , to form @xmath1127 , we remove @xmath1121 and drop down @xmath1158 .",
    "notice that the entries in the top row to the left of where @xmath1121 was are unchanged : consider the @xmath516 rectangle and bump the @xmath1121 down to the bottom row according to theorem [ rectanglebump ] . then bump it out according to proposition [ zerobump ] , which leaves us with the same top row as that of @xmath1127 .",
    "the entire top row save for the last entry is unchanged upon applying proposition [ zerobump ] , and so having the @xmath1121 inserted into the second row instead can only change the entries to the right of it in the row above .",
    "thus the entries to its left in the top row are unchanged , and have the same cocharge contribution as well .    finally , in the columns weakly to the right of the column that @xmath1121 was in , the entries in the top row are @xmath1159 in some order .",
    "we claim that the entries in the second row are formed by replacing at most one of @xmath1160 by a smaller entry , which is either @xmath1158 or something bumped to the right by @xmath1158 if @xmath1158 lands in a column to the left of the @xmath780 s . indeed ,",
    "the only way it would be a larger entry replacing them is if a descent replaced @xmath1121 , but in this case we would have @xmath1118 since the number of descents in the second row would be the same , and the number of descents in the top row would decrease by only @xmath68 .",
    "therefore , the entries @xmath1157 are all descents in the top row , and so removing @xmath1124 still results in a difference @xmath1149 . in particular , the descents formed by @xmath1124 and one of the @xmath204 s are removed , since the @xmath119 s all slide one position to the left , and did not form new descents upon removing the @xmath1124 before the @xmath1121 .",
    "this completes the proof .    for any three - row shape @xmath2 and content @xmath105 ,",
    "the map @xmath510 is a weighted set isomorphism from @xmath511 .",
    "this gives a combinatorial proof of the identity @xmath512 for three - row shapes .",
    "this work was partially funded by the hertz foundation and the nsf graduate research fellowship program ."
  ],
  "abstract_text": [
    "<S> using the combinatorial formula for the transformed macdonald polynomials of haglund , haiman , and loehr , we investigate the combinatorics of the symmetry relation @xmath0 . </S>",
    "<S> we provide a purely combinatorial proof of the relation in the case of hall - littlewood polynomials ( @xmath1 ) when @xmath2 is a partition with at most three rows , and for the coefficients of the square - free monomials in @xmath3 for all shapes @xmath2 . </S>",
    "<S> we also provide a proof for the full relation in the case when @xmath2 is a hook shape , and for all shapes at the specialization @xmath4 . </S>",
    "<S> our work in the hall - littlewood case reveals a new recursive structure for the cocharge statistic on words . </S>"
  ]
}