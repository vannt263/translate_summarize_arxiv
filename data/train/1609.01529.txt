{
  "article_text": [
    "most research on fault tolerant control sits within the context of large manned aircraft . with regards to unmanned aerial vehicles ( uavs )",
    ", the majority of the literature describes the application of fault tolerant control ( ftc ) to rotorcraft rather than fixed wing aircraft . in this paper",
    "we develop a nonlinear model predictive control ( nmpc ) based controller for a fixed wing aircraft model suitable for the purposes of fault",
    "tolerant flight control .",
    "the controller is first tested and analysed on a lower order 2d robot model . then assuming that fault information is available we successfully demonstrate for the first time the use of an nmpc based fault tolerant flight control system for a fixed wing aircraft .",
    "+ the main characteristic of a fault tolerant control ( ftc ) system is its ability to automatically cope with system faults before they turn into a serious system failure .",
    "the integration of an ftc scheme significantly increases the ability of the system to maintain overall stability in the presence of a fault @xcite .",
    "model predictive control , a highly promising approach to re - configurable and fault tolerant control ( @xcite , @xcite , @xcite and @xcite ) , focuses on _ what to control _ , instead of _ how to control_. this is a subtle , but illuminating , difference allowing for the exploitation of inherent system characteristics such as nonlinearities and cross - coupling effects by the controller , rather than their influence being minimised .",
    "this is possible due to the underlying daisy chaining capability of mpc @xcite .",
    "for example @xcite , the primary function of the rudder of an aircraft is to provide yaw or sideways control .",
    "however , the rudder can also have some effect on the roll of the aircraft . therefore",
    ", in the event of the failure of an aileron actuator , the primary control surface for roll , it is still possible to execute a limited roll manoeuvre with the rudder .",
    "this degree of fault - tolerance in the flight control system requires a suitable re - configurable architecture to be purposefully designed and implemented @xcite , which is able to re - establish control , albeit with limited capacity , and execute the required manoeuvres .",
    "the mission can then either be continued with the failed component or aborted , the primary objective being to avert a catastrophic failure or the loss of the aircraft , and to ensure that it is brought back to ground safely .",
    "the aim of this paper is to design a controller for exactly this purpose .",
    "+ much of the research in model predictive control ( mpc ) is based on linear mpc where a linear model of the plant is utilised .",
    "this paper develops an nmpc controller with the ultimate goal of application to fault tolerant flight control for uavs .",
    "the next section ( section [ sec : nmpc ] ) will detail the workings of mpc , followed by a discussion of nmpc .",
    "the implementation of nmpc requires the solution of an optimal control problem at each time step , and in section [ sec : nmpc ] several methods of achieving a solution are investigated . in section [ sec : brach ] a small selection of these optimal control methods , namely direct single shooting , direct multiple shooting and two collocation methods the first based on euler integration and the second on pseudospectral discretisation are applied to the brachistochrone problem , with the results aiding in the selection of the best technique to integrate into the nmpc controller design .",
    "the results of this section showed the pseudospectral collocation method to be the best choice .",
    "section [ sec:2drobotmodel ] applies a pseudospectral based linear and nonlinear mpc controller to a 2d robot model in both open loop and closed loop scenarios .",
    "the results show that the nonlinear controller outperforms the linear controller particularly as perturbations increase and linear assumptions are violated as is the case when faults occur .",
    "section [ sec : flightcontrol ] applies the final nmpc controller design to the longitudinal motion of a generic aircraft model assuming fault detection information is available .",
    "the results successfully demonstrate the capability of our controller as a fault tolerant flight control system .",
    "many fault tolerant control system designs require two controllers one for the nominal case and one for the fault case .",
    "our system requires the design of only one controller which can handle both nominal and fault cases .",
    "finally section [ sec : conclusion ] gives the analysis followed by the conclusion .",
    "model predictive control ( mpc ) , also referred to as receding horizon control , is an advanced control technology developed by practitioners within the industrial process industry that has had considerable impact on industrial process control .",
    "mpc , being capable of handling equipment and safety constraints @xcite , allows systems to operate at or near constraints , yielding a more efficient and profitable operation . unlike many other control system designs , where the model of the plant is used only for design and analysis purposes , in mpc",
    "the model is an integral part of the control algorithm and is used to predict future behaviour of the plant in order to calculate the optimal control trajectory .",
    "+ linear mpc , where the internal model is linear , is a thoroughly researched area and is commonly used in practice .",
    "the internal prediction model predicts the behaviour of the plant over a future prediction horizon , @xmath0 . the idea is to select the best input that will produce the best predicted behaviour . a number of coincidence points are placed over the horizon with the aim of bringing the predicted output as close as possible to the reference trajectory .",
    "this is achieved by optimising a cost function , commonly a quadratic cost via quadratic programming in the case of linear mpc .",
    "only the first input of the calculated trajectory is applied to the plant and the prediction window slides along by the sampling time .",
    "once the window slides to the next time step and the calculated input is applied to the plant , the new plant states are fed back to the controller and the whole cycle begins again .",
    "the length of the prediction window remains fixed but slides forward by one sampling interval at each step ; a process referred to as the receding horizon strategy . to reduce the computational burden a control horizon , @xmath1 ,",
    "can be defined which is smaller than @xmath0 .",
    "the control inputs are calculated only along the control horizon , beyond which point the value of @xmath2 remains constant .",
    "performance stability increases as the length of @xmath1 approaches the length of @xmath0 .",
    "+ whilst nmpc uses the same structure as linear mpc the advantage of the former is the incorporation of a nonlinear process model for highly nonlinear systems .",
    "these nonlinear models are based on `` first principles '' and are obtained from an understanding of the physical nature of the system @xcite . increased ability to handle the computing demands of solving nonlinear optimization problems",
    "has lead to a rise in interest in nmpc within the control community .",
    "+ the interest in nmpc , which began in the 90s , has been driven by the fact that today s processes need to be operated under tighter performance specifications , with more environmental and safety constraints that can only be met when process nonlinearities and constraints are explicitly considered in the controller design @xcite .",
    "the major limitation of linear mpc is that plant behaviour is described by a linear dynamic model , making it unsuitable for both moderately as well as highly nonlinear processes with large operating regimes @xcite .",
    "nmpc is more frequently used in the process industry because the time scales encountered are in the order of minutes , making real - time requirements less severe than in , for example , aerospace applications . + while nmpc has the potential to improve process operation , it poses theoretical and practical problems that are more challenging than those associated with its linear counterpart , mainly due to the nonlinear program that must be solved online at each sampling period @xcite . however , the inherent robustness of nmpc that allows it to deal with input model uncertainties without taking them directly into account , is a definite advantage , which is what makes it the focus of this paper .",
    "the next sub - section discusses optimal control techniques that can be used to solve nmpc problems .",
    "for the nmpc methodology to be practically feasible the optimisation must be performed within the time constraints governed by the sampling period of the application @xcite . hence , when designing and implementing nmpc strategies , consideration must be given to computational efficiency @xcite .",
    "globally optimal nmpc methods can provide benefits over local techniques and can be successfully used for online control @xcite .",
    "nmpc methods are generally based around tailoring nonlinear programming algorithms @xcite to fit the structure of the online optimization or parametrising the predictions in terms of degrees of freedom .",
    "this directly affects the size of the online optimisation problem and in turn the computational burden of the nmpc strategy .",
    "+ methods used to solve optimal control problems commonly fall under two categories : direct and indirect @xcite .",
    "direct methods have better convergence properties than indirect methods and can be used quickly to solve a number of practical trajectory optimisation problems , hence only direct methods are considered in this paper . + the path - constrained trajectory optimisation problem as detailed in @xcite , is an area that has been heavily researched and forms an integral part of the design of an nmpc controller .",
    "the main aim of optimal control is to determine the state and control pair that minimises a cost functional .",
    "that is , if a state and control pair is represented by @xmath3 then the aim is to minimise : @xmath4 + \\int_{t_0}^{t_f } \\!\\left [ \\mathcal{l}\\left(\\mathbf{x}(t),\\mathbf{u}(t),t\\right)\\right ] \\ , \\mathrm{d}t,\\ ] ] subject to the nonlinear state equations : @xmath5 , \\ ] ] the initial and terminal constraints @xmath6 = 0 , \\\\",
    "\\psi_0\\left[\\mathbf{x}\\left(t_f\\right)\\right ] = 0,\\end{aligned}\\ ] ] the mixed state - control path constraints @xmath7\\leq \\mathbf{g}_u,\\ ] ] and the box constraints @xmath8 here : @xmath9 are the state variables , @xmath10 the control inputs , @xmath11 the time , @xmath12 the terminal non - integral cost ( also known as mayer component ) .",
    "@xmath13 is integral cost ( known as the bolza component ) , @xmath14 represents the initial point conditions , @xmath15 the final point conditions , @xmath16 the lower bounds on the path constraints , and @xmath17 the upper bounds on the path constraints .",
    "+ solving the problem defined by equations to is difficult .",
    "the direct methods detailed here solve this problem by applying a discretisation process and using standard algorithms to solve the resulting discrete optimisation problem .",
    "+ a multitude of discretisation techniques exist for converting the continuous time problem to discrete time . in direct methods",
    "the mathematical programming problem , equations to , is solved by considering either discretised inputs , or a combination of discretised inputs and states , as decision variables .",
    "the most common direct methods use the controls and states as optimisation parameters .",
    "+ when deciding on a discretisation process many important factors need to be considered @xcite , such as the accuracy of the solution for a particular discretisation method given a number of optimisation variables , the computational expense of a particular discretisation method and the robustness of the discretisation method to the initial guess .",
    "the methods chosen for implementation and analysis are direct single shooting @xcite , direct multiple shooting @xcite , direct collocation using euler integration @xcite and direct collocation using pseudospectral discretisation @xcite .      - are used to solve the given problem with initial and terminal conditions .",
    "they convert two point boundary value problems ( bvps ) into initial value problems ( ivps ) by guessing the value of the derivative at the initial boundary . every time",
    "a guess is made a `` shot '' ( using de solvers to find a solution ) , is fired in an attempt to hit the end boundary .",
    "it is an iterative process where `` shots '' are made until the end boundary is reached within a desired tolerance .",
    "+ the main difference between direct single and direct multiple shooting methods is that in the latter a bvp is converted into multiple ivps .",
    "the interval of computation , @xmath18 $ ] is divided into @xmath19 subintervals and an ivp is solved over each subinterval .",
    "all of the solutions over the subintervals are pieced together to form a continuous trajectory / solution , whenever the solutions to the ivps match at the beginning and end of each subinterval , the matching conditions .",
    "these matching conditions introduce algebraic equations which must be satisfied along with the boundary conditions .",
    "- involves fully discretising the problem ( all controls and all states ) and then solving the discrete problem numerically .",
    "the discretisation method , either integration or differentiation based , used to approximate the state equations must be combined with a method for approximating the integral in the generalised bolza problem .",
    "pseudospectral methods , for example , are differentiation based methods relying on differentiating lagrange polynomial expansions of the approximating polynomials for the states , while hermite - simpson based techniques are often thought of as integration methods .",
    "a comparison of various methods can be found in @xcite .",
    "we investigated both an integration based method as well as a differentiation based method .",
    "+ derivative based ( or pseudospectral ) methods provide a better convergence rate known as spectral accuracy ( @xcite , @xcite ) .",
    "the underlying idea is to represent the solution @xmath20 via a truncated series expansion and to use analytic differentiation of the series to obtain spatial derivatives of @xmath20 .",
    "the spectral differentiation matrix , @xmath21 , is a linear mapping of a vector of @xmath22 function values @xmath23 to a vector of @xmath22 derivative values @xmath24 , and its calculation depends on the choice of the approximating series and the location of the points @xmath25 .",
    "+ one advantage pseudospectral methods have over finite element or finite difference methods is that the underlying polynomial space is spanned by orthogonal polynomials that are infinitely differentiable global functions ( @xcite , @xcite , @xcite ) .",
    "the choice of collocation points is crucial in pseudospectral methods @xcite and the legendre - gauss - lobatto ( lgl ) points are implemented here because they provide maximum accuracy for quadrature approximations while at the same time avoiding the runge phenomenon during interpolation @xcite . in the case of lgl",
    ", the nodal points , which are the zeros of the derivatives of the legendre polynomials , lie in the interval @xmath26 $ ] with the end points of the interval being included in the discretisation .",
    "+ finally an nlp solver is required as it forms an integral part of nmpc .",
    "different discretisation methods are affected by the choice of nlp solvers in terms of the speed and robustness of the solution obtained @xcite . for this work snopt @xcite",
    "is the solver of choice due to its popularity and because it is readily available .",
    "snopt solves the quadratic programming subproblem with a quasi - newton approximation to the hessian , via a large - scale sparse sequential quadratic programming algorithm .",
    "the brachistochrone problem is a nonlinear , nontrivial problem with an analytic solution very similar to the 2d robot problem to be addressed later .",
    "the analytical solution allows determination of the accuracy of the implementation of each method and provides a benchmark in choosing a numerical method to continue development of an nmpc controller .",
    "the brachistochrone problem , simply stated , is to find the shape of a wire such that a bead sliding on the wire without friction , in uniform gravity , will reach a given horizontal displacement in minimum time .",
    "+ the analytical solution is given by : @xmath27 where @xmath28 , @xmath29 and @xmath30 are the horizontal and vertical displacements of the bead in the @xmath31-plane , @xmath32 is the gravitational force and @xmath33 is the final x - displacement . the optimal control problem is to minimise the cost function : @xmath34 subject to the equations of motion of the bead : @xmath35 and the initial and terminal constraints : @xmath36    here @xmath37 is the time taken to reach @xmath33 and @xmath38 is the speed of the bead .",
    "+ the number of discretisation points was varied for each method to investigate their effect and to determine the method most suitable for developing the fault tolerant controller .",
    "the value of @xmath33 is set to @xmath39 and the value of @xmath32 for this work is @xmath40 . for the direct single shooing method the control points , @xmath41 , were varied from 5 to 500 and for each value of @xmath41 the state points were varied from 10 to 1000 . similarly the number of sections for the direct multiple shooting method was varied from @xmath42 to @xmath43 and the control points chosen for each section went from @xmath44 to @xmath45 .",
    "the coincidence points for both the collocation methods ( euler integration and pseudospectral ) varied from @xmath46 to @xmath47 .",
    "+ the accuracy of the different numerical methods was assessed by comparing the solutions produced by them and the analytical solution given in .",
    "the comparison was performed by producing plots of the magnitude of the errors in @xmath29 and @xmath30 .",
    "the results showed that the pseudospectral method produced the most accurate solution and increasing the number of coincidence points beyond @xmath48 did not increase the accuracy of the solution .",
    "hence for this reason the pseudospectral method with @xmath48 was used as the nominal solution in the analysis of the cpu time .",
    "+ the time taken to reach @xmath49 in the solution of the analytical problem given by equation is @xmath50 .",
    "plots of the cpu time taken to reach an optimal solution as a percentage of the nominal were produced .",
    "the error plots show the percentage error between the optimal solution produced by each method and the nominal solution .",
    "+ an example plot for the direct single shooting method is given in figure [ fig : chap3_dss_time_nu5 ] for @xmath51 .",
    "the plots showed that for @xmath51 the cpu time is less than the nominal for all @xmath52 however the correct final time is unattainable .",
    "the cpu times for the pseudospectral method are given in figure [ fig : chap3_pseud_time ] .",
    "as expected the cpu time increases for increasing @xmath22 and in general the cpu time taken by the pseudospectral method is higher when compared with the other methods .",
    "+    , @xmath51 ]    ]    overall the results showed that the pseusdospectral method can produce more accurate results with fewer discretisation points consequently requiring less time . while , for large values of @xmath22 , the pseudospectral method results in a greater cpu time , larger values of n are deemed unnecessary to obtain a high level of accuracy . for this reason only the pseudospectral method with @xmath54 points is used in design of the nmpc controller .",
    "in this part of the design phase of the nmpc controller the pseudospectral method is integrated into an mpc framework .",
    "an nmpc controller is designed , implemented and tested for a 2d robot model for trajectory following . both the open and closed loop problems are addressed and comparisons are made to linear mpc .",
    "the next section details the 2d robot model .",
    "the 2d robot model given in figure [ fig : chap3_robot eom ] is used for both the linear and nonlinear implementations of mpc .",
    "the equations of motion for this robot model are : @xmath55 where @xmath56 is the @xmath56-coordinate of the point @xmath57 , @xmath58 the @xmath58-coordinate of the point @xmath57 , @xmath59 the heading angle , @xmath60 the right wheel angular velocity , @xmath61 the left wheel angular velocity and @xmath38 the speed given by @xmath62 .",
    "+ the next few sub - sections detail the development of the linear and nonlinear mpc controllers . for a fair comparison",
    "the pseudospectral method with 50 collocation points is chosen as the method for discretisation for both controllers .      in mpc",
    "an open loop problem is solved at each time step .",
    "hence it was important to implement and test the controller on the open loop problem .",
    "+ many tuning parameters can be used to determine the performance of the controller ; the weighting factors on the cost function , the design of the cost function , the length of the prediction horizon , the initial condition , the integration time step , and the number of discretisation points required for an acceptable solution . from the previous analysis the numerical technique chosen for the application of nmpc is the pseudospectral method with 50 discretisation / coincidence points . as a part of this work the effect of the choice of the cost function , the prediction window length ,",
    "the integration time step and the effect of the initial condition on the solution were all considered .",
    "+ the 2d robot is required to follow the path : @xmath63 travelling with a velocity of @xmath64 and constraints of @xmath65 on the wheel speeds @xmath60 and @xmath61 .",
    "the objective is to drive the robot back to the reference path , from @xmath66 to @xmath67 .",
    "five different cost functions were developed : + * cost type 1 : * errors between the reference / nominal path and the robot path are minimised : @xmath68 * cost type 2 : * errors between the robot path and the nominal path , plus the error between the actual wheel speeds , @xmath60 and @xmath61 and the nominal wheel speeds are minimised : @xmath69 *",
    "cost type 3 : * errors between the robot path and the nominal path , plus the difference between the wheel speeds are minimised : @xmath70 * cost type 4 : * errors between the nominal speed and robot speed as well as the errors between the nominal angular acceleration and the robot s angular acceleration are minimised : @xmath71 * cost type 5 : * errors between the nominal speed and robot speed as well as the errors between the nominal angular acceleration and the robot s angular acceleration along with the errors between the nominal path and the robot path are minimised : @xmath72    each cost type was tested using both linear and nonlinear mpc .",
    "the robot initial @xmath73 and @xmath59 was set to @xmath74^\\intercal$ ] for both controllers .",
    "the prediction window length was varied between @xmath75 , @xmath76 and @xmath77 . through trial and error",
    "the weights were set to :    @xmath78    the optimal trajectories produced by all the different cost functions for the varying window lengths were plotted for both the linear and nonlinear mpc cases .",
    "results showed that for a window length of 1 sec cost types 1 , 2 , 3 and 5 were able to drive the robot back onto the desired path by the end of the window for both the linear and nonlinear cases , however cost type 4 was unsuccessful in doing so .",
    "+ the error plots for all the prediction window lengths were generated showing the magnitude of the error in the y - direction between the nominal path ( @xmath79 ) and the actual robot path .",
    "overall the results showed that for a path following scenario , it is best to not only minimise the path errors , but to also follow a velocity profile to obtain a smoother non oscillating solution .",
    "for this reason cost type 5 ( equation ) was chosen for the final controller design and is used in the remainder of this analysis .",
    "in addition , the error plots show that the difference in errors produced by the linear and nonlinear controllers are the least for this cost function , making it the best candidate for comparison purposes .",
    "+ the effect of the integration time step was also investigated .",
    "the analysis given above considers only the optimal solution produced by the controller , however in an mpc framework only the first output is applied to the plant , with the plant then providing sensor information to the navigation subsystem , for example , ( on an aircraft ) to calculate location and orientation information .",
    "hence it is important to understand the effect of the integration time step in conjunction with the optimal control input .",
    "the integration time step was varied as follows ; @xmath80 $ ] for varying @xmath0 lengths , namely 1 sec , 5 secs and 10 secs , and the optimal trajectories were plotted .",
    "all results showed that the integration time step has very little effect on the results . upon further investigation",
    "the results showed that the smallest integration time step of 0.001secs was able to give a solution closest to the optimal .",
    "the length of the prediction horizon was seen to have the greatest effect on the integrated solution with the integrated solution getting closer to the optimal solution as the look ahead increased .",
    "another point to note is that the integrated output produced with the nonlinear controller more closely matched the optimal solution compared to the linear integrated output .",
    "+ varying the length of the prediction window showed that it is always best to have a longer window as this produced the lowest errors , particularly in the linear controller case .",
    "in addition , the longer window allowed the robot to reach the nominal path more quickly .",
    "the accuracy of the integrated solution increased as the window length increased , but , unfortunately a longer window resulted in an increase in computation time . + from the results obtained a window length of 5 secs was chosen for the final nmpc controller design as it was a good compromise between efficiency and accuracy .",
    "a window length of 1 second proved to be too short to produce an accurate solution particularly in the case of the integrated solution . while a window length of 10 secs produced an integrated solution closely matching the optimal solution in the nonlinear controller case , the solution produced by a window length of 5 secs , while not as precise , still managed to develop a solution closely resembling the optimal solution .",
    "hence for the rest of this research a window length of 5 seconds is used along with cost type 5 and an integration time step of 0.01secs .",
    "+ the initial condition is another factor that must be considered in the design and selection of the controller .",
    "the sensitivity of the starting point on the overall solution is critical particularly in the case of linear techniques . in this analysis",
    "the robot is required to follow the same path as above , @xmath67 , and the initial @xmath58 is varied from 0 m to 10 m in steps of 0.1 m .",
    "the errors between the nominal path and the actual robot position are calculated at various points along the prediction horizon namely at 1 sec , 2 secs , 3 secs , 4 secs and 5 secs for all initial @xmath58 values .",
    "plots of errors versus initial @xmath58 for the different times were obtained and figures [ fig : chap3_inity_1secs ] and [ fig : chap3_inity_5secs ] show the results at @xmath81 sec and @xmath82 secs .",
    "the results show the errors between the optimal solution and the nominal path as well as the errors between the integrated output and the nominal path for both the linear and nonlinear controllers .",
    "the errors arising from the integrated output of the linear controller are shown on a separate plot underneath the main plots as these errors were much higher compared to the others and by plotting all errors on the one graph the errors produced by the other solutions were not as clearly visible .",
    "the results show that as the time increases from 1 second to 5 secs the errors decrease as the robot approaches the nominal path .",
    "the results clearly show that the further away the robot is from the nominal path ( i.e. the greater the perturbation ) the higher the error in the case of the linear controller .",
    "+ at the 1 second mark along the prediction window ( figure [ fig : chap3_inity_1secs ] ) the errors between the solution produced by the nonlinear controller and the nominal path ( @xmath67 ) were seen to be linear as a function of initial @xmath58 .",
    "moving further along , the prediction window shows that these errors decrease and are very close to zero for any @xmath83 .",
    "there is only a small region around the nominal path , @xmath67 , during which the errors produced by the linear controller are zero and match those produced by the nonlinear solution at any time along the prediction window .    ]    ]    the next subsection investigates the closed loop problem and compares the output produced by both linear and nonlinear mpc .",
    "the aim of these simulations is to implement and investigate the behaviour of both linear and nonlinear mpc regarding the closed loop problem .",
    "the fault tolerant problem is essentially closed loop , hence to apply nmpc to fault tolerant control the pseudosepectral nmpc controller design is tested on the 2d robot model where the robot is required to travel on a circular trajectory .",
    "+ based on the analysis from the previous subsections a prediction window length of 5 seconds is used with 50 collocation points , cost type 5 and an integration time step of 0.01secs",
    ". constraints of @xmath65 are placed on the control inputs which are the angular velocities produced by the right and left wheels .",
    "three different scenarios were set up : scenario 1 the robot begins on the path with initial conditions @xmath84^\\intercal$ ] , scenario 2 the robot begins slightly off the path with initial conditions @xmath85^\\intercal$ ] and scenario 3 the robot begins well off the path with initial conditions @xmath86^\\intercal$ ] .",
    "+ for stability @xmath87 @xcite . in many mpc\\nmpc formulations",
    "@xmath1 is less than @xmath0 . while this greatly reduces the computational expense it does however produce a suboptimal solution @xcite ,",
    "hence for the purposes of this research the control horizon is equal to the prediction horizon .    for scenario 1 where the robot begins on the path the trajectories produced by both linear and nonlinear controllers were the same .",
    "the calculated optimal inputs produced by both controllers were also identical . in the case of scenario 2 where the robot begins slightly off the path , both",
    "the linear and nonlinear controllers managed to bring the robot back onto the path .",
    "the plots of the optimal inputs showed that initially both controllers work at the maximum constraint to drive the robot back onto the path .",
    "once the path is reached ( i.e. perturbations are small ) both controllers exhibit the same performance . +            the trajectory plots for scenario 3 show that only the nonlinear controller is able to bring the robot back onto the path with the linear controller unable to drive the robot back to the path .",
    "the control inputs produced by both controllers clearly showed that the linear controller worked very hard to take the robot back onto the path by consistently working at the constraint limits however it was still unable to return the robot back to the path .",
    "+ the results clearly showed that the pseudospectral nmpc solution to the nonlinear model predictive controller is a viable choice outperforming its linear counterpart when the perturbations are large . in the next section",
    "we apply the solution developed thus far to a generic aircraft model .",
    "note that fdi is assumed for the simulation exercise carried out in section [ sec : flightcontrol ] .",
    "the nmpc controller developed in the previous sections was applied to the longitudinal motion of an aircraft to demonstrate fault tolerant control . the generic aircraft model developed here for control",
    "law design and validation is based on the mcdonnell douglas f-4 aircraft @xcite .",
    "it is a fixed wing aircraft equipped with throttle , elevators , ailerons and a rudder for control .",
    "longitudinal motion is predominantly controlled via the throttle and elevators which is used to pitch the aircraft nose up and down and hence the remaining controls will not be considered here .",
    "figure [ fig : chap5_angles_sl_paper1 ] presents a sketch of a generic aircraft which identifies the location of the elevators and defines the coordinate frames in which the equations of motion are defined .",
    "these equations are all carried out in the body axis which has its origin at the centre of gravity ( c.g . ) on the body of the aircraft however position and velocity information are commonly presented in the ned frame which is an earth fixed coordinate system .",
    "the generic aircraft model has the aerodynamic characteristics of the mcdonnell douglas f-4 aircraft however the dimensional and mass properties are those given in tables [ table : chap5_acdims ] and [ table : chap5_mass_props_si ] respectively .",
    ".aircraft dimensional properties [ cols=\"^,^\",options=\"header \" , ]     [ table : chap5_constraints3dof ]    the weighting matrices are diagonal matrices with the following values along the diagonal for each state which were set through trial and error : @xmath88 . note : the control surface rates given in table [ table : chap5_constraints3dof ] are realistic for a high performance unstable airframe or for a lower weight aircraft with a stable airframe ; in either case a feasible fictional aircraft model has been produced for simulation purposes to demonstrate proof of concept .      to illustrate the concept of ftc ,",
    "seven different scenarios were set up , with the first one being the no fault case .",
    "the next five scenarios had the throttle stuck at @xmath89 and @xmath90 for the entire duration of the flight .",
    "scenario seven simulated the throttle getting stuck at @xmath90 80 secs into the flight .",
    "+ it is also assumed that fault detection information is available .",
    "this includes the time at which the throttle becomes stuck and and the position at which it is stuck .",
    "this information is used to update the constraint values of the nmpc controller .",
    "providing the controller with the most accurate and up to date information enables it to make better use of the healthy actuators .",
    "as previously mentioned the force and moment coefficients are valid for @xmath91 . for all scenarios @xmath92 was checked to ensure that @xmath93 was never exceeded .",
    "the plots of @xmath92 vs time ( they have not been provided here due to space constraints ) showed @xmath92 to remain below @xmath93 hence the equations of motion were never violated .",
    "another means of avoiding this would be to place a constraint on @xmath92 in the nmpc controller .",
    "- the demanded airspeed was @xmath94 true airspeed .",
    "the plot given in figure [ fig : chap5_st_ta ] shows the aircraft true airspeed for each of the scenarios .",
    "the results show that in a fault free case the aircraft is able to fly at the demanded true airspeed .",
    "however , when the throttle is stuck at @xmath95 or even @xmath96 there is too much power continually being provided to the aircraft resulting in a large airspeed response .",
    "when the throttle is stuck at @xmath97 the aircraft is able to maintain the demanded @xmath98 for only a short period of time , at the beginning of the flight mission .",
    "however at @xmath99 throttle the maximum deviation from the demanded airspeed is approximately @xmath100 at any given time .",
    "when the throttle drops below @xmath99 the aircraft is unable to maintain the true airspeed which drops to approximately between @xmath101 and @xmath102 .",
    "the results for scenario 7 show that once the fault occurs at 80 secs the true airspeed immediately begins to drop , as expected .",
    "one of the main points to note is that the stall speed was never reached ; the controller was able to avoid the aircraft stalling regardless of the severity of the fault .",
    "- the vertical speed response of the aircraft was also analysed and plots for scenarios 1 - 4 are given in figure [ fig : chap5_st_vd ] .",
    "the plots show the aircraft response along with the constraints ( in red ) placed on the vertical speed . for high values of throttle ( @xmath95 and @xmath96 )",
    "the vertical speed is continuously bouncing between the constraints in an attempt to maintain the true airspeed demand .",
    "for the case when the throttle is stuck at @xmath97 the vertical speed profile is seen to be similar to the no fault case , except in the descent phase . during this phase ,",
    "when the aircraft is descending and gaining speed , the vertical speed response can be seen to continuously move between the constraints to regulate the speed .",
    "results showed that for throttle values less than @xmath99 there is insufficient power to maintain a climb hence the vertical speed is seen to operate at the lower constraint or at zero .",
    "in the case of scenario 7 it was found that once the fault occurred at 80 secs the vertical speed moved between the constraints , working hard to maintain the true airspeed .",
    "- in regards to fault tolerance , the elevator activity is of the most interest . if the throttle is stuck the elevator provides a level of redundancy to maintain the aircraft speed .",
    "figure [ fig : chap5_st_ea ] shows plots of elevator activity for the different scenarios .",
    "the plots clearly show that any change in throttle increases the elevator activity when compared to the no fault case .",
    "the elevator activity increases in an attempt to regulate the airspeed of the aircraft . in the case of the high throttle values ( @xmath95 and @xmath96 ) the elevator activity is the highest because a higher level of power is continually being provided to the aircraft exceeding the amount required to fly at the demanded speed .",
    "hence the elevator constantly jumps between the constraints in an attempt to compensate for the excess power . for the @xmath99",
    "stuck throttle case the elevator activity does increase compared to the no fault case ; however @xmath97 throttle was found to be closer to the amount required to maintain the given height profile , hence the elevator does not need to work as hard compared to the @xmath95 and @xmath96 cases .",
    "for the lower throttle values activity increases during the climb and descent phases . in the climb phase of the mission",
    "there is not enough power available to the aircraft , so it compensates by erratically deflecting the elevator . during the descent phase",
    "however there is too much power ; to regulate this and to stay within the velocity constraints the activity increases .",
    "the last scenario shows that at the fault occurrence time of 80 secs the elevator increases activity to compensate for the faulty throttle .",
    "the plots indicate large oscillations in the elevator activity however the data presented shows 200 seconds of flight .",
    "actuator dynamics have been modelled in both the controller and the plant model . zooming in on the @xmath95",
    "stuck throttle case ( figure [ fig : zoomedea ] ) it can be seen that the rate dynamics are respected .",
    "stuck throttle - elevator activity ( zoomed ) , constraints ( red lines ) , aircraft response ( blue ) ]      - the trajectory flown by the aircraft during the different scenarios is given in figure [ fig : chap5_st_hp ] .",
    "the no fault case , as expected , follows the reference height profile perfectly .",
    "the @xmath97 case is also able to closely maintain the profile . in the @xmath95 and @xmath96 cases the aircraft continually tries to regulate the airspeed to compensate for the excess power",
    "the solutions produced by both scenarios show the aircraft overshooting followed by an undershoot , so the solution oscillates around the reference .",
    "when the throttle becomes stuck at @xmath99 the aircraft begins the climb phase of the mission but is only able to continue climbing for 20 secs before it begins gliding towards the ground . in the @xmath90",
    "stuck throttle case the aircraft completes the straight and level phase of the mission but does not have enough power to begin climbing , and descends to the ground .",
    "the final scenario shows that the elevator is able to compensate for the stuck throttle in mid - flight and successfully finish the mission .",
    "this paper was dedicated to the theoretical and practical implementation aspects of nmpc .",
    "a viable design for a nonlinear mpc controller applicable to ftc was sought .",
    "a number of discretisation methods were implemented using the well known brachistrochrone problem and the pseudospectral numerical method was found to have the best performance .",
    "this method was applied in an nmpc framework to a 2d robot model in both open and closed loop settings .",
    "comparisons were made between linear mpc and the nonlinear mpc solutions . for small perturbations",
    "the two controllers produced the same results .",
    "however , for large perturbations where nonlinearity effects are more significant , the pseudospectral nonlinear mpc controller was found to produce more accurate results than the linear mpc controller .",
    "the final design was also applied to a generic aircraft model where it was assumed that fault detection information was provided .",
    "the motivation behind this was to demonstrate the concept of fault tolerant flight control using nmpc .",
    "it was found that the nonlinear nmpc controller designed in this work is a viable controller for fault tolerant flight control .",
    "this was evident from the results which show that in the event of a stuck throttle the controller is able to manipulate the movement of the elevator to compensate for the fault .",
    "kale  mm , chipperfield  aj .",
    "_ robust and stabilized mpc formulations for fault tolerant and reconfigurable flight control_. proceedings of the 2004 ieee international symposium on intelligent control 2004 ; 222 - 227 .",
    "boskovic  jd , sai - ming  l , mehra  rk .",
    "_ on - line failure detection and identification ( fdi ) and adaptive reconfigurable control ( arc ) in aerospace applications_. proceedings of the 2001 american control conference 2001 ; 4:2625 - 2626 .",
    "doi:10.1109/acc.2001.946269    gopinathan  m , boskovic  jd , mehra  rk , rago  c. _ a multiple model predictive scheme for fault - tolerant flight control design_. proceedings of the 37th ieee conference on decision and control 1998 ; 2:1376 - 1381 .",
    "doi:10.1109/cdc.1998.758477 .",
    "long  c.e , polisetty  pk , gatzke  ep . _ nonlinear model predictive control using deterministic global optimization_. journal of process control 2006 ; 16(6):635 - 643 .",
    "doi : http://dx.doi.org/10.1016/j.jprocont.2005.11.001 .",
    "diehl  m , bock  hg , diedam  h , wieber  pb . _ fast direct multiple shooting algorithms for optimal robot control_. fast motions in biomechanics and robotics - lecture notes in control and information sciences 2006 ; 340:6593 .",
    "doi:10.1007/978 - 3 - 540 - 36119 - 0 - 4 .",
    "diehl  m , bock  hg , schlder  jp , findeisen  r , nagy  z , allgwer  f. _ real - time optimization and nonlinear model predictive control of processes governed by differential - algebraic equations_. journal of process control 2002 ; 12(4):577585 .",
    "doi : http://dx.doi.org/10.1016/s0959 - 1524(01)00023 - 3 .",
    "williams  p. _ a comparison of differentiation and integration based direct transcription methods ( aas 05 - 128)_. advances in the astronautical sciences american astronautical society by univelt 2005 ; 120(1):389409 .",
    "gill  pe , murray  w , saunders  ma .",
    "_ users guide for snopt version 7 : software for large - scale nonlinear programming_. citeseer 2006 ; http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.217.5929 [ last accessed : 20 - 01 - 2016 ] ."
  ],
  "abstract_text": [
    "<S> this paper describes the design process for developing a nonlinear model predictive controller for fault tolerant flight control . after examining and implementing a number of numerical techniques </S>",
    "<S> , this paper identifies pseudospectral discretisation as the most suitable for this design . applying the controller to a 2d robot model shows that the nonlinear controller performs much better than the linear controller , especially in the closed loop scenario . assuming fault detection information , applying the technique to the longitudinal motion of a generic aircraft model shows the design to be eminently suitable for flight control .    </S>",
    "<S> keywords : nonlinear model predictive control , pseudospectral , optimal control , 2d robot , flight control </S>"
  ]
}