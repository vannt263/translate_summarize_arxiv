{
  "article_text": [
    "luminosity and stellar mass are important physical properties of a galaxy .",
    "they are also used for selecting galaxy samples for many extragalactic studies ( e.g. , luminosity - limited or stellar - mass - limited samples ) . how to estimate these quantities accurately for very large data sets , such as wide - field imaging surveys ,",
    "is therefore crucial .",
    "multi - broad - band imaging is an efficient way to obtain large and statistically significant samples of galaxies .",
    "quantities such as luminosity , colors , and stellar mass can be derived from these data , usually using a spectral - energy - distribution ( sed ) fitting method . for a large surveys , where a large sample spectroscopic redshift sample is difficult to obtain , photometric redshifts derived from the same photometry",
    "are often used in deriving these quantities . in this case , the performance of the photometric redshift method , both in terms of accuracy and bias , is crucial to the estimate of quantities such as luminosity and stellar mass , as uncertainties in the photometric redshifts are propagated and magnified when estimating these quantities .",
    "methods for deriving photometric redshifts can be generally grouped into two categories : template fitting ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) and empirical fitting ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "the template - fitting method fits the galaxy sed with templates constructed from either real spectrophotometric data ( e.g. , * ? ? ?",
    "* ) or stellar population synthesis models ( e.g. , * ? ? ?",
    "* ) , or a combination of both .",
    "the empirical - fitting method assumes that the redshift of a galaxy is a function of its photometry ( e.g. , redshift @xmath0 ) .",
    "it utilizes a spectroscopic training set to derive this function and then applies this function to the photometry for all the objects to compute their redshifts . in a recent paper ,",
    "@xcite summarized the performance of a number of existing photometric redshift algorithms .",
    "the performance of the template photometric redshift methods depends heavily on the chosen templates .",
    "if the templates are not representative of the seds of real objects , the results could be biased or incorrect .",
    "this issue can be minimized if more than a dozen broad- and intermedian - bands of photometry are available ( e.g. , cosmos 30-band photometry , * ? ? ? * ) which can provide adequate constraints to determine a proper template for each galaxy and avoid degeneracies between different templates .",
    "however , it is difficult to collect photometry for more than 10 bands in a large survey field ( e.g. , larger than 100 square degrees ) ; photometry with only a few bands ( e.g. , 4 or 5 ) generally provides poorer constraints in sed fitting which increases the chance of picking up a wrong template for a given galaxy .    unlike the template methods , the empirical methods estimate redshifts based on the empirical relation between redshifts and photometry .",
    "one therefore does not need to apply any template , as long as the training set is complete over the selected redshift range . for redshift less than 1.5 , publicly available databases released by several deep spectroscopic redshift surveys ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) provide excellent samples to generate high - quality training sets for the empirical photometric redshift method ; the training sets constructed using these survey data do not suffer from significant completeness issues for @xmath1 . because there is no templates involved in an empirical method",
    ", it can avoid introducing additional noises , biases , and uncertainties due to mis - selected templates , and thus could result in better photometric redshift quality .",
    "this is the most important advantage of empirical methods over template methods .",
    "however , note that this method requires addtional data to create the training set .",
    "a similar situation occurs when estimating luminosities and stellar masses of galaxies using a template - fitting method .",
    "this method would suffer all the issues found in template photometric redshift methods .",
    "furthermore , the noise and bias of the photometric redshift used for deriving the luminosity and the stellar mass are propagated to the final result and could produce an even more deleterious effect .",
    "this is especially serious in data with only a small number of filter bands .",
    "if luminosities and stellar masses can be estimated bypassing the redshift determination , these issues can be minimized .",
    "@xcite show that the morphology of galaxy can be estimated from photometry empirically , without deriving their redshifts .",
    "@xcite derive the @xmath2-correction of galaxy from photometry directly without involving redshifts .",
    "@xcite introduces a unified framework in which the photometric redshift method is simply a mapping of the photometry / color space to the redshift space .",
    "furthermore , other physical properties can also be estimated directly by mapping the photometry / color space to the spaces of these properties . in this paper",
    ", we develop a simple , but powerful and robust , empirical method which , besides being applicable to deriving photometric redshift , can be used to estimate luminosity and stellar mass directly using photometry from a relatively small number of filter bands , bypassing the determination of photometric redshift completely .",
    "we examine its performance using a mock photometric catalog of 4 optical bands and compare the results to those obtained using the more traditional template methods .",
    "this paper is structured as follows . in  [ method ]",
    "we describe the empirical method that we use to estimate redshifts , luminosities , and stellar masses . in  [ mock ]",
    "we provide a description of the mock catalog that we use to examine the performance of our empirical method .",
    "section [ trainingset ] presents the construction of the training sets and the validation sets that are used in our experiments .",
    "we then compare the qualities of photometric redshifts , luminosities , and stellar masses estimated using our empirical method and several conventional template - fitting methods in  [ results ] , and discuss the results in  [ discussion ] . in ",
    "[ summary ] we summarize our results .",
    "the cosmological parameters used in this study are @xmath3 , @xmath4 , @xmath5 km s@xmath6mpc@xmath6 , and @xmath7 .",
    "the idea of using broad - band photometric data to estimate galaxy luminosities and stellar masses directly using a training set is simple .",
    "the empirical photometric redshift method assumes that the redshift of a galaxy is a function of its photometry .",
    "similarly , if one simply assumes that the luminosity and stellar mass of a galaxy are functions of its photometry ( i.e. , luminosity @xmath8 , and stellar mass @xmath9 , where @xmath10 is the magnitude for the @xmath11th filter ) , then the luminosities and stellar masses of galaxies can be derived directly from their photometry , without involving any redshifts and templates .",
    "the training sets for the empirical luminosity and stellar - mass fittings can be constructed using publicly available deep spectroscopic and multi - wavelength photometric datasets ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) . when the luminosities and stellar masses of the training set galaxies are derived using sed fitting with photometry from more than a dozen broad- and intermediate - bands along with spectroscopic redshifts , the mis - selection of templates can be mostly avoided .",
    "the training sets for luminosity and stellar mass constructed as described are thus likely reliable .",
    "alternatively , for the stellar - mass training set , other probes can also be utilized to derive the stellar masses in the training set ( e.g. , stellar mass versus @xmath12-band luminosity relation , * ? ? ?",
    "* ) if they are deemed more suitable than the sed fitting method .",
    "note that this empirical - fitting formalism can be applied to any intrinsic properties , such as @xmath2-corrections ( e.g. , * ? ? ?",
    "* ) and rest - band colors ( @xmath10@xmath13 ) , that are tied to the observed photometry .",
    "the conventional empirical - fitting methods , however , have two major issues that could affect the result significantly .",
    "one is the choice of the proper form of the fitting functions , e.g. , @xmath14 , @xmath15 , and @xmath16 , etc .",
    "the other is that the best - fitted coefficients for the empirical functions can be biased by objects with higher population density ( e.g. , the mid - redshift population for @xmath14 , the low luminosity population for @xmath15 , and the low stellar - mass population for @xmath16 ) .",
    "this effect is also discussed in @xcite .",
    "our new empirical - fitting method is designed to minimize the effects of these issues . in the following subsections ,",
    "we describe how these two issues are dealt with in our empirical photometric redshift method .",
    "while we discuss these techniques in terms of deriving photometric redshifts , they can be generalized to the direct empirical methods for deriving other galaxy properties such as luminosity and stellar mass , and we discuss their implementations and tests in subsequent sections .      finding a proper form of the empirical function is critical for the empirical methods .",
    "@xcite use a polynomial form and find that the higher order the polynomial form , the smaller the fitting @xmath17 .",
    "however , the @xmath17 is only reduced slightly when they move from a third- to a fourth - order fit .",
    "they suggest that this is because the curvature in the photometry - versus - redshift relation is not in all the dimensions of the magnitude - color - redshift space .",
    "however , an alternate explanation could be that a polynomial form may not properly describe the relation exactly .",
    "alternatively , the code _ artificial - neural - network - z _ ( annz , * ? ? ?",
    "* ) takes a more aggressive approach , in which an artificial neural network is used for deriving the empirical relation between redshift and photometry .",
    "the more the layers ( or nodes ) there is in the network ( i.e. , more complicated network ) , the better the photometric redshift performance . however , once the complexity of the network reaches a certain degree , the improvement becomes negligible , which is similar to the afore - mentioned issue of the polynomial fitting method .",
    "these findings suggest that even using a very complicated form for the empirical function does not help significantly in improving the quality of the photometric redshift .",
    "since even complicated functions and algorithms have limitations in delivering better photometric redshifts , we can opt for a simple approach of fitting the function piece - wise . in @xcite , we divide up the data points into several partitions in color - magnitude space using the @xmath18-tree algorithm @xcite , and derive the empirical relation in each partition using a second - order polynomial function .",
    "a complicated curve can be mimicked using multiple line segments ; similarly , deriving the empirical relation for each color - magnitude partition individually using a simple low - order polynomial function may achieve a better performance when compared to a brute - force single fit with a very complicated function for all the data . for the partitional photometric redshift method , the more partitions there are , the better the performance . ideally , it is better to divide up the data points on all the axes of colors and magnitudes ; however , the number of galaxies in a typical training set is likely not adequate for such an operation .",
    "for example , a training set of 10,000 galaxies with four broad - band photometry can inhabit a 10-dimensional color - magnitude space ( 6 unique colors and 4 magnitudes ) .",
    "if one wants to divide up the data points on all the color and magnitude axes once at least , there will be more than one thousand partitions .",
    "this would mean that there are on average less than 10 galaxies in each partition .",
    "thus , one would be in danger of overfitting because of having too few objects per partition .",
    "the typical number of galaxies of a high - quality training set that can be generated nowadays is about 10,000 to 20,000 , similar to that used in our training set . to avoid the overfitting issue",
    ", another approach has to be taken .    instead of dividing the training - set galaxy sample into many fixed partitions ,",
    "an alternate method is to select a sufficiently large subset of the galaxies , e.g. , 50 , whose magnitudes and colors are closest to the input galaxy , a `` local subset '' .",
    "this dynamically - selected local subset is used for deriving the relation between redshift and photometry for that input galaxy , with a first - order polynomial function .",
    "similar methods are also used in @xcite and @xcite . in our method ,",
    "the quadratically summed ranks of color and magnitude differences between the training set galaxies and the input galaxy are used for constructing the local subset .",
    "in addition , we also assign a weight to each galaxy in the local subset , based on the inverse - cube value of the distance between that galaxy in the subset and the input galaxy in the multi - dimensional color - magnitude space .",
    "an important factor in ranking the training set galaxies is that the ranges of the distributions in different galaxy colors and magnitudes are very different , which can bias the selection of galaxies for the local subset .",
    "for example , the magnitude distributions of a catalog with @xmath19 , @xmath20 , @xmath21 , @xmath22 photometry may range from 15 to 25 mag ( i.e. , a 10-mag dynamical range ) , but the color distributions likely have dynamical ranges of @xmath23 mag .",
    "this means that a local subset with equal weights in color and magnitude distances will tend to have galaxies with similar magnitudes rather than those with similar colors , which would degrade the photometric redshift performance , since colors usually provide more redshift information than magnitudes .",
    "therefore , a scaling factor is needed to be applied to each color and magnitude when calculating the distance in the multi - dimensional space to optimize the selection of galaxies .",
    "the initial values of the scaling factors can be roughly determined based on the ratio of the ranges of colors and magnitudes .",
    "for example , one can apply a scaling factor of 3 to each color and 1 to each magnitude , then the ranges of all the colors and magnitudes would be similar .",
    "in addition , the range of a given color is redshift - dependent , and different colors have different ranges at the same redshift . applying different scaling factors to different colors can therefore fine - tune the photometric redshift performance at different redshift ranges .    to derive the photometric redshift value and its uncertainty for each galaxy , we follow the method described in @xcite . to account for the effects due to photometric uncertainties",
    ", we use monte carlo technique to generate 500 data sets based on the photometric measurements and uncertainties of the input galaxies . for each of the monte carlo",
    "generated data set , we bootstrap the training set for each input galaxy 500 times to estimate the sampling effect in the training set .",
    "this produces 250,000 photometric redshift estimates for each input galaxy .",
    "the median value of these 250,000 estimates is assigned to be the photometric redshift of the galaxy , and the distribution of these 250,000 estimates represents the probability function of the photometric redshift ( i.e. , the photometric redshift error ) for that galaxy .",
    "we apply the same monte carlo plus bootstrap method for deriving luminosities and stellar masses of the galaxies ; the probability functions of luminosity and stellar mass are therefore provided as well .",
    "we give our method a general name : the direct empirical photometric method , or demp .",
    "all data fitting procedures are subject to biases due to objects with higher population density in the relevant parameter space .",
    "for example , in a redshift training set there are usually more objects at intermediate redshift range than at both the high- and low - redshift ends because of the smaller survey volume at low redshifts and the brighter absolute magnitude limits at high redshifts for an apparent magnitude - limited sample .",
    "therefore , the best - fitting coefficients are optimized for the intermediate redshift range ; but low - redshift objects would have overestimated photometric redshifts and high - redshift objects would have underestimated photometric redshifts .",
    "if one derives photometric redshifts for a training set using the training set itself , the photometric redshift distribution would always be narrower than the spectroscopic redshift distribution because of this bias effect . using a partitional or regional fitting method as describe in section  [ poly ] might reduce this effect if the total number of objects in the training set are adequate ( e.g. , more than 100,000 objects for @xmath24 , according to our experience ) . in this case , since objects in each partition are expected to have similar redshifts , the redshift distribution in each partition would be approximately `` flat '' .",
    "however , the best training set that can be constructed nowadays includes only around 20,000 objects , making a partition method still affected by this bias effect .",
    "therefore , some other steps have to be taken to alleviate this problem .",
    "the most intuitive solution is to give a weight inversely proportional to the population density function to each object in the training set .",
    "this is similar to the uniform weighting used in data reduction in radio astronomy .",
    "we adopt another straightforward approach by artificially making the number of galaxies in each redshift bin in the training set the same .",
    "the new training set would therefore have a flat redshift distribution .",
    "we call this training set a `` uniformly - weighted '' training set . for regional polynomial fitting , ideally , this procedure should be performed for each local subset of the training set",
    ". however , such an algorithm would be very computing - time intensive .",
    "in fact , based on our tests , we have found a negligible quality difference between using several uniformly - weighted subsets and using a single uniformly - weighted training set .",
    "therefore , we use a single uniformly - weighted training set in demp , without compromising the quality of the result . the details for the construction of the uniformly - weighted training set",
    "are described in section  [ trainingset ] .",
    "to examine the performance of demp , we generated a mock catalog that mimics the data of the second red - sequence cluster survey ( rcs2 , * ? ? ?",
    "rcs2 is a multi - band imaging survey covering nearly 1,000 square degrees carried out using the square - degree imager , megacam , on cfht .",
    "it is designed to search for clusters of galaxies over the redshift range between 0.1 and 1.0 .",
    "the project uses the red - sequence of cluster early - type galaxies to identify clusters @xcite .",
    "the survey comprises three - filter imaging ( @xmath19 , @xmath20 , and @xmath22 ) , with additional @xmath21-band imaging via a data - exchange with the canada - france high-@xmath25 quasar survey @xcite .",
    "the 5@xmath26 limiting magnitudes in ab are 24.4 , 24.3 , 23.7 , and 22.8 , for @xmath19 , @xmath20 , @xmath21 , and @xmath22 , respectively .",
    "the calibrated rcs2 photometry has an absolute accuracy of better than 0.03 mag on any color and @xmath27 mag in the @xmath20-band magnitude , verified with respected to the sloan digital sky survey ( sdss ) .",
    "the details of the rcs2 are described in @xcite .",
    "the small number of filter bands and the relatively shallow photometry make a mock catalog of rcs2 an excellent test data set for the demp method .",
    "all photometric redshift techniques rely on strong features in the spectroscopic continuum ( e.g. , the lyman break , the balmer break ) to estimate the redshift .",
    "rcs2 has only 4 broad - band photometry , with the bluest band being @xmath19 , which has an effective wavelength of around 4,700 , with a @xmath28  bandwidth . without photometry bluer",
    "than @xmath19 , the @xmath29 color becomes the most important parameter in estimating the redshifted wavelength of the balmer break ( or the 4000  break ) for galaxies at @xmath30 .",
    "however , an early - type galaxy at @xmath31 has a @xmath29 color similar to a late - type galaxy at @xmath32 .",
    "therefore , how to integrate the other minor information ( e.g. , magnitudes and colors other than @xmath29 ) becomes very critical in breaking the degeneracy of the @xmath29 color for objects at @xmath30 , and hence influence the photometric redshift performance for these objects .",
    "the accuracies of the luminosity and stellar - mass estimations are also seriously affected by the same issue since luminosity is highly redshift dependent and the strength of the 4000  break is a critical parameter for deriving stellar masses .",
    "thus , an rcs2 mock catalog is ideal for examining the performance of demp and the comparisons with other methods under reasonably challenging circumstances , especially for @xmath30 .",
    "the rcs2 mock catalog is generated using the updated version ( 12/08/2011 ) of the cosmos mock catalog called realisticspectrophotcat @xcite .",
    "realisticspectrophotcat is generated by fitting the real cosmos photometry with a set of sed templates .",
    "the template set includes the coleman extended library ( the observed spectra of @xcite plus extrapolated uv and ir spectra provided by the gissel library ( charlot & bruzual 1996 ) ) and spectra of star - forming galaxies computed using the gissel model .",
    "the calzetti extinction law @xcite is used in the fitting .",
    "realisticspectrophotcat provides for over 500,000 objects both ideal ( i.e. , modeled ) and perturbed ( i.e. , uncertainty - added ) photometry in 17 bands from far - ultraviolet to 8.0@xmath33 m , as well as ideal redshifts , stellar masses , and star - formation rates . this mock catalog is representative of a real galaxy survey in many aspects , such as colors , number counts , and luminosity functions .",
    "moreover , the detection limits of cosmos are deeper than those of rcs2 , making the cosmos mock catalog very suitable for generating a rcs2 mock catalog .",
    "the rcs2 data were obtained using megacam on cfht with the @xmath19 , @xmath20 , @xmath21 , and @xmath22 filters ; however , the cosmos mock catalog does not provide photometry for the cfht megacam filters .",
    "we therefore use the _ ideal _ photometry of the subaru @xmath19- , @xmath20- , @xmath21- , and @xmath22-bands in the cosmos mock catalog directly to mimic the cfht ones . directly using the subaru filter set avoids introducing noise from the flux transformations between the two filter systems .",
    "the transmission curves of the subaru filters will also be used in our performance experiment for the template - fitting methods to make sure there is internal consistency in the filter system . to match the depths of the rcs2 data , we added noises and systematics to the mock photometry according to the detection limits and the systematic photometric offsets reported from the real rcs2 data @xcite .",
    "we then selected objects with @xmath34 to generate the rcs2 mock catalog , which includes @xmath3540,000 objects .    to carry - out out the performance tests , we need information on redshift , luminosity , and stellar mass in the rcs2 mock catalog ; but the cosmos mock catalog provides only redshift and stellar mass for each galaxy .",
    "we therefore calculated the luminosities of the cfht @xmath36 , @xmath19 , @xmath20 , @xmath21 , and @xmath22 bands ( rest ) by doing the sed fittings using the 17-band photometry with the redshifts provided by the cosmos mock catalog .",
    "we use the eazy v2.0 code ( eazy , hereafter , * ? ? ?",
    "* ) to derive the luminosities of the objects in the rcs2 mock catalog",
    ". these luminosities will be the references for examining the qualities of the luminosity estimations using different methods .",
    "the performance of an empirical method would likely be overestimated if the test set is the same as the training set . to examine the quality of the empirical method correctly , an independent validation set should be used .",
    "we therefore separate the rcs2 mock catalog into two sets by randomly selecting galaxies .",
    "one is the training set and the other is the validation set .",
    "each set contains @xmath3520,000 objects .    as discussed in section  [ balance ] , the result of an empirical method can be affected by the distribution of properties of the galaxies in the training set .",
    "we therefore generated two redshift training sets , three luminosity training sets , and three stellar - mass training sets with different galaxy property distributions , as described below , to test the different methods for mitigating these effects .",
    "for the empirical redshift fit , we use two different training sets . the first training set , @xmath37 , is taken from the rcs2 mock catalog directly , which has @xmath3520,000 objects .",
    "the redshift distribution of galaxies of @xmath37 is similar to that in the validation set .",
    "for the second training set , @xmath38 , we generate it as a uniformly - weighted training set using the following procedure .",
    "first , we take the galaxies from @xmath37 and separate them into different redshift bins with a bin size of 0.1 in @xmath25 .",
    "next , we increase the number of galaxies in each redshift bin by randomly duplicating galaxies in the same bin until the number of galaxies in the bin matches that in the redshift bin with the largest number of galaxies . to avoid the singular matrix issue during polynomial fitting",
    ", we apply a small random magnitude offset ( @xmath39 mag ) to each duplicated galaxy .",
    "the magnitude offset is exactly the same for @xmath19 , @xmath20 , @xmath21 , and @xmath22 for the same duplicated galaxy .",
    "the small offset of the photometry is negligible for our experiments since the colors of each object are unchanged . for the empirical luminosity fit",
    ", we use three different training sets for each rest - wavelength filter band .",
    "the first two training sets , @xmath40 and @xmath41 ( where @xmath11 = @xmath36 , @xmath19 , @xmath20 , @xmath21 , or @xmath22 is the filter name ) , are the luminosity counterparts of @xmath37 and @xmath38 .",
    "they are generated following the same procedures used to create the @xmath37 and @xmath38 training sets . for the third training set , @xmath42 , we apply the uniform - weighting to the luminosity distribution with a 0.5 mag luminosity bin size .",
    "we test five luminosity bands in our experiment , the total number of luminosity training sets is therefore 15 .    for the empirical stellar - mass fit , we also use three different training sets .",
    "the training sets @xmath43 , @xmath44 , @xmath45 are the stellar - mass counterparts of @xmath40 , @xmath41 , and @xmath42 , respectively .",
    "the stellar - mass bin size used in the @xmath45 construction is 0.5 dex in @xmath46 .    for the experiments using the flattened training sets ( i.e. , @xmath38 , @xmath41 , @xmath42 , @xmath44 , and @xmath45 ) ,",
    "because the numbers of objects of these training sets are changed by the weighting procedure , we enlarge the size of the local subset of the training set for the regional polynomial fitting by the same factor in order to have statistically equivalent local subset sizes .",
    "we examine the performance of the demp algorithm in deriving the two key properties of galaxies , luminosities and stellar mass , using differently weighted training sets , along with comparing results from two public available , more traditional template methods .",
    "since photometric redshift is a key input for any sample selection or analysis of galaxies , we will first compare the derivations of photometric redshift from these different methods .",
    "we note that only objects in the validation set are used for these comparisons .",
    "photometric redshift is an important input into any analysis of properties of a photometric sample of galaxies .",
    "furthermore , they are input directly into the determination of luminosities and stellar mass when a template - fitting technique is used .",
    "thus , understanding the performance of photometric redshift determination will also inform us in comparing the performance in the derivations of luminosities and stellar mass .",
    "we examine the performance of demp in the determination of photometric redshift performance using two weighting schemes for the training set : no weighting and weighting by redshift distribution .",
    "we also compare the demp results with those derived using two different template - fitting photometric redshift codes : new_hyperz v11 ( newhyperz , hereafter ; rose et al . ) and eazy .",
    "newhyperz is the successor of hyperz @xcite , which is one of the most popular photometric redshift codes about a decade ago .",
    "it is able to deliver photometric redshifts as well as luminosities and stellar masses of galaxies , but no prior can be applied to improve the performance . without applying any prior , some objects would have catastrophic photometric redshift errors due to the confusion between lyman break and balmer break if near - infrared ( nir ) data are not available . unlike newhyperz , eazy can take advantage of an apparent magnitude prior to reduce the fraction of the catastrophic photometric redshift error .",
    "moreover , eazy is able to do sed fits using multiple templates simultaneously .",
    "therefore , eazy can be applied to a galaxy with two or more different stellar populations .",
    "the templates that we used in newhyperz and eazy are the galaxev @xcite templates and the eazy default template v1.0 , respectively .",
    "we use the calzetti extinction law @xcite in both newhyperz and eazy .",
    "it is worth noting that we estimate the zeropoint offset of each filter for newhyperz and eazy by deriving the median difference between the photometry in the training set and the one estimated using newhyperz and eazy with fixed redshifts provided by the training set .",
    "we then apply the zeropoint offsets to the photometry in the validation sets for newhyperz and eazy .",
    "this may take care of the template mismatch between the templates used in newhyperz / eazy and those used in the cosmos mock catalog .",
    "however , we find that the zeropoint offsets are all smaller than 0.02 mag ; the effect due to these small zeropoint offsets is negligible .",
    "lrrrrrrrrrrrr ( a ) newhyperz & 0.884 & 1.177 & 82.6% & 41.5% & 0.044 & 0.447 & 30.6% & 9.4% & -0.023 & 0.169 & 40.6% & 5.1% + ( b ) eazy & 0.115 & 0.170 & 41.9% & 2.1% & -0.011 & 0.063 & 6.4% & 0.4% & -0.141 & 0.103 & 36.9% & 0.6% + ( c ) demp w @xmath37 & 0.053 & 0.158 & 24.3% & 2.7% & -0.014 & 0.067 & 9.4% & 0.7% & -0.112 & 0.113 & 30.5% & 0.8% + ( d ) demp w @xmath38 & 0.041 & 0.182 & 27.2% & 2.9% & -0.005 & 0.088 & 11.5% & 1.1% & -0.011 & 0.130 & 32.2% & 0.9% +    the comparison results of the photometric redshift performance are shown in figure  [ qphotoz ] .",
    "we also quantify the quality of the photometric redshift in three redshift bins for each method and show the results in table  [ qphotoz_table ] .",
    "we note that the bias and scatter of photometric redshift quality are usually calculated in the literature ( e.g. , * ? ? ?",
    "* ) excluding outlier objects with the definition @xmath47 .",
    "however , if the bias of photometric redshift is significant , calculating bias and scatter with this definition of outlier objects can produce seriously underestimated results .",
    "instead , we calculate bias and scatter excluding objects lying outside the 95th percentile boundary ; the bias and scatter that we derive are therefore better able to represent the true quality of photometric redshift for each method . for this paper , we define 0.15 as the outlier boundary .",
    "one may expect the photometric redshifts of objects at @xmath30 to be overestimated because of the absence of @xmath36-band data in the rcs2 mock catalog .",
    "in general this is the case .",
    "however , the performance of newhyperz is significantly worse than others over this redshift range .",
    "the running median and upper 68th percentile lines in panel ( a ) of figure  [ qphotoz ] show that there are many data points outside the plot , which indicates that the photometric redshifts for objects at @xmath48 are seriously overestimated using newhyperz .",
    "this results in an outlier fraction of 82.6% for objects at @xmath30 , which is a factor of 24 of those of the other methods . for the intermediate redshift bin",
    ", newhyperz still has the worst performance in every aspect . in the highest redshift bin ,",
    "the performance of newhyperz is similar to those of the other methods , except for the catastrophic error fraction . on the other hand ,",
    "the performance of eazy is more reasonable , with objects with @xmath30 having photometric redshifts around 0.4 and with @xmath49 having photometric redshifts around 0.9 .",
    "these results are generally within expectation because of the lack of @xmath36-band and nir data .",
    "the outlier fraction at @xmath30 is only half of that of newhyperz because an @xmath20-band apparent magnitude prior is used in eazy to mitigate the catastrophic error problem in our experiment ; it is , however , still a factor of 2 larger than those of the demp methods . for the intermediate redshift bin",
    ", eazy has the best performance over all the other methods .",
    "but for the highest redshift bin , based on table  [ qphotoz_table ] , the bias of eazy is the most serious , while the values of the scatter and outlier fraction are similar to those of the other methods .",
    "while the overall performance of eazy is reasonably good given the fact that @xmath36-band and nir data are absent , the overall performance of demp is better than that of eazy . using the @xmath37 training set , photometric redshifts of objects at low redshifts and high redshifts are still over and underestimated , respectively , similar to the eazy result .",
    "however , the values of bias are milder compared to those of eazy .",
    "it is also worth noting that the bias and the outlier fraction of demp with @xmath37 at @xmath30 are only half of those of eazy . for the intermediate redshift bin ,",
    "the performance of demp with @xmath37 is similar to that of eazy .",
    "we therefore conclude that the performance of demp with @xmath37 is better than that of eazy .    the over- and underestimation shown in the demp with @xmath37 result",
    "are due to the weighting effect of the non - uniform galaxy distribution in the redshift space , and this issue is minimized using demp with @xmath38 . based on table",
    "[ qphotoz_table ] , the @xmath50 bias of demp with @xmath38 is the smallest in all redshift bins , especially at @xmath51 .",
    "this result shows that the uniformly - weighted training set does reduce the bias as we expected , but the price to pay is slightly higher scatter and outlier fraction as compared to that of demp with @xmath37 .",
    "this is because increasing the weighting of objects at low-@xmath25 and high-@xmath25 makes the fitting function less optimized for objects at intermediate redshift , as compared to that derived using @xmath37 . for most scientific analyses using photometric redshifts ,",
    "the bias and scatter of photometric redshifts are more important than the outlier fraction and the catastrophic error fraction . based on these comparisons ,",
    "we conclude that the photometric redshift performance of demp with @xmath38 is the best in our tested methods .",
    "we compare the performances of the luminosity estimations using demp and the template - fitting methods . for the template - fitting method",
    ", we use eazy to estimate the luminosities by using the photometric redshifts derived from eazy and demp .",
    "eazy computes the luminosity of a galaxy by doing an sed fit using the photometry from the few filters with the observed wavelengths close to the redshifted wavelength of the chosen filter band .",
    "the derived luminosity is therefore very stable and not very sensitive to the template used in the sed fitting .",
    "we examine the performances of the different methods in terms of the luminosity accuracy ( expressed in delta absolute magnitude ) as a function of redshift and the precision of the reconstructed luminosity function .",
    "we prepare three different luminosity training sets @xmath40 , @xmath42 , and @xmath41 ( see section  [ trainingset ] ) for deriving the luminosities in rest @xmath36 , @xmath19 , @xmath20 , @xmath21 , and @xmath22 bands using data from observed @xmath19 , @xmath20 , @xmath21 , and @xmath22 bands .",
    "we also use eazy to derive luminosities in these bands using the photometric redshifts provided by eazy and by demp .",
    "the photometric redshifts from demp used in the eazy template fitting are the ones derived using @xmath38 , since it produces the best photometric redshift performance according to section  [ photz ] .",
    "we find that the performances are similar between different bands for a given method , which is demonstrated in figure  [ qlum ] , where we show the comparison results for the rest @xmath36 , @xmath20 , and @xmath22 bands .",
    "we therefore discuss the general statistics in three redshift bins for each method only for the @xmath20 band , which are tabulated in table  [ qlum_table ] . because of the lack of @xmath36-band data , the luminosity for objects at @xmath52 is seriously overestimated .",
    "the result of the luminosity performance examination for objects at @xmath53 can be heavily biased by these objects .",
    "we therefore make the lowest redshift bin in table  [ qlum_table ] @xmath54 and ignore objects at @xmath52 .",
    "lrrrrrr ( a ) eazy w @xmath55 & -1.07 & 0.72 & -0.22 & 0.53 & 0.44 & 0.77 + ( b ) eazy w @xmath56 & -0.41 & 0.85 & -0.09 & 0.92 & -0.22 & 1.15 + ( c ) demp w @xmath57 & -0.51 & 0.77 & 0.11 & 0.54 & 0.42 & 0.73 + ( d ) demp w @xmath58 & -0.12 & 0.83 & 0.21 & 1.03 & 0.55 & 1.35 + ( e ) demp w @xmath59 & -0.35 & 0.84 & 0.04 & 0.74 & 0.12 & 0.79 +    because eazy overestimates redshifts for low-@xmath25 objects and underestimates redshifts for high-@xmath25 objects as described in   [ photz ] , the luminosity is therefore overestimated for low-@xmath25 objects and underestimated for high-@xmath25 objects as shown in table  [ qlum_table ] and figure  [ qlum ] ( method a ) .",
    "although the luminosity biases for method a at low-@xmath25 and high-@xmath25 are relatively large compared to those for the other methods , its performance in terms of scatter over the entire redshift range is better than the other methods .",
    "the small luminosity scatter is directly due to the small scatter in photometric redshifts derived using eazy .",
    "based on the results shown in ",
    "[ photz ] , the photometric redshifts derived using demp with @xmath38 have the smallest bias among all the methods , which is also reflected in the bias performance of its luminosity estimation .",
    "the luminosity bias of method b ( eazy with @xmath56 ) over the entire redshift range is at least a factor of 2 smaller than that of method a ( eazy with @xmath55 ) .",
    "however , the larger photometric redshift scatter of @xmath56 is also propagated to its luminosity results , which makes the luminosity scatter of method b ( up to 70% ) larger than that of method a.    for the template - fitting methods ( i.e. , methods a and b ) , the performance of the luminosity estimation can be easily explained by the quality of the photometric redshifts used to derive the luminosities .",
    "but for the demp methods ( i.e. , methods c , d , and e ) , the same interpretation can not be applied , since the luminosities are derived directly from the photometry , by - passing the photometric redshift estimation . as discussed in  [ balance ] , the result of the empirical method can be affected by the distribution of galaxy properties in the training set . for a luminosity training set",
    "generated using a flux - limited sample , objects with intermediate luminosities are more numerous than those with both fainter and brighter luminosities .",
    "the luminosities of fainter objects are therefore overestimated , and those with brighter luminosities are underestimated .",
    "most of these faint objects are at low-@xmath25 and all the objects at high-@xmath25 are relatively luminous because of the flux limit . hence , the luminosities of low-@xmath25 objects are systematically overestimated , while those of high-@xmath25 objects are underestimated , as shown in table  [ qlum_table ] and figure  [ qlum ] ( method c ) . although method c still has the overestimation and underestimation issues , the absolute values of its biases are actually between those of the two tested template - fitting methods , while its scatters are very similar to those of method a , which has better scatter performance between the two template - fitting methods .",
    "we therefore conclude that the overall performance of method c is better than those of the template - fitting methods .",
    "method d uses demp with the training set that is uniformly - weighted in luminosity space .",
    "we expect it to be able to minimize the problem of over and underestimating luminosities at low and high redshifts , respectively , as it is the case for photometric redshift estimation .",
    "based on table  [ qlum_table ] and figure  [ qlum ] , it works as expected for the lowest redshift bin ; the absolute value of the bias at @xmath54 ( 0.12 ) is the smallest and at least a factor of 3 smaller than those of all the other methods .",
    "however , the bias , as well as the scatter , for the other two redshift bins are almost the worst among all the methods .",
    "these results can be explained by the weighting factor applied in obtaining the @xmath60 training set . because the luminosity at the flux limit boundary at higher @xmath25 changes with redshift much slower than that at lower @xmath25 , the multiplicative factor applied to each luminosity bin for the luminosity uniform - weighting procedure",
    "has a much smaller dependence on redshift at higher @xmath25 .",
    "hence , the shape of the redshift distribution of the uniformly - weighted luminosity training set ( i.e. , @xmath42 ) is similar to the original one ( i.e. , @xmath40 ) for the @xmath61 bins . to demonstrate this",
    ", we plot the redshift distributions of @xmath57 and @xmath58 in figure  [ lbal_zdist ] .",
    "the number of objects in @xmath58 with @xmath62 is boosted by a factor of 1 to 5 compared to that in @xmath57 ; whereas at @xmath63 , the boost is only about 30% .",
    "the relatively much larger number of objects at in the weighted training set at low-@xmath25 produces the best result for the @xmath54 bin for method d. furthermore , since the shape of the redshift distribution of @xmath58 is very similar to that of @xmath57 at @xmath61 , the bias due to the non - uniform redshift distribution of a training set for the @xmath61 bins therefore remains .",
    "moreover , the redshift distribution of @xmath58 is significantly shifted to lower redshift , so the empirical luminosity fitting can be seriously affected by low-@xmath25 objects ( i.e. , fainter objects ) .",
    "this makes the bias and scatter of the estimated luminosity at @xmath61 even worse than those of method c ( demp with @xmath40 ) .",
    "in fact , method d produces the largest positive ( faint ) bias in @xmath64 of all the methods .",
    "hence , we conclude from the overall performance of method d that luminosity weighting does not improve the result , and in fact produces worse outcomes at higher redshift .    comparing methods",
    "d and e , weighting the redshift distribution produces much better results than applying luminosity weights .",
    "compared to method c ( with training set @xmath40 ) , using the training set @xmath65 produces smaller biases in all redshift bins .",
    "there is a slight increase in scatter for all the redshift bins , but not very significant .",
    "we conclude that method e provides the best overall luminosity results over the whole redshift range .",
    "we also find that the performances ( especially in terms of scatter ) of the template - fitting methods become worse when the luminosity band shifts to a longer wavelength , while those of the empirical - fitting methods do not degrade as much .",
    "for example , the scatter of method b ( eazy with @xmath66 ) at @xmath67 is 0.84 for @xmath36 , but it is 1.29 for @xmath22 , while the scatter of method e ( demp with @xmath65 ) at @xmath67 is 0.74 for @xmath36 , and it is 0.82 for @xmath22 . to investigate the limitations of each method to predict luminosities in rest bands",
    "not covered by the observed bands , we repeat the same experiment to estimate the cfht wircam @xmath68-band luminosity using only photometry from the observed optical bands . the results are shown in figure  [ lum_k ] . unlike the results for the optical bands ( figure  [ qlum ] ) , the performances of the estimated @xmath68-band luminosity are significantly different for the template - fitting and empirical - fitting methods . for the template - fitting methods , the bias and scatter of the result derived using eazy with @xmath56 ( e.g. , bias = -2.7 mag and scatter = 1.4 mag at @xmath49 ) are worse than those derived using eazy with @xmath55 ( e.g. , bias = -0.6 mag and scatter = 0.8 mag at @xmath49 ) , even though the bias of @xmath56 is generally smaller than that of @xmath55 as shown in figure  [ qphotoz ] .",
    "this result implies that in extrapolating an sed beyond the observed band ( e.g. , in the optical ) , using photometric redshifts derived with the same sed templates may work better than using photometric redshifts derived by using other templates or methods , even if these other templates or methods produce photometric redshifts that are closer to the spectroscopic redshifts .",
    "in addition , the estimated @xmath68-band luminosities derived using both template - fitting methods are overestimated by @xmath69 mag at @xmath70 . on the other hand , for the empirical - fitting methods ,",
    "both the bias and scatter performances ( e.g. , bias = 0.06 mag and scatter = 0.81 at @xmath61 for method d ) are very similar to the optical - band luminosities shown in figure  [ qlum ] and are therefore much better than those of the template - fitting methods .",
    "these results show that the information of @xmath68-band luminosity is embedded in optical broadband photometry , and the empirical methods have better ability to squeeze the information out as compared to the template methods .",
    "the very large improvement of the demp methods over that of the template methods is likely contributed in part by having @xmath68-band photometry for the training - set galaxies to provide observational constraints on the @xmath68-band luminosities extrapolated using optical bands .",
    "the equivalent information ( i.e. , priors ) for the template - fitting method is embedded in the templates used . however , our test shows that sed template models are clearly not as robust as observed priors and is subject to rather large systematics when extrapolated to greatly different wavelengths .",
    "we examine how well luminosity functions at different redshift ranges can be reconstructed using different methods . since the cosmos mock catalog is built directly from the observed cosmos catalog , the cosmos mock catalog preserves the information of the luminosity functions in the universe to the detection limit of the cosmos data . to mimic real data , we use the derived photometric redshifts to populate the redshift bins in which luminosity functions are measured . the photometric redshifts for method",
    "a are derived using eazy and those for methods b , c , d , and e are derived using demp with @xmath38 .",
    "the completeness limit of the luminosity function for each redshift bin and for each band is estimated by comparing the luminosity function constructed using the ideal redshift and the ideal luminosity of the rcs2 sample ( i.e. , training set plus validation set ) and that constructed using the whole cosmos sample .",
    "the results are shown in figure  [ qlf ] .",
    "there are four redshift bins : 0.00.3 , 0.30.5 , 0.50.7 , and 0.70.9 .",
    "only data points within the completeness limit are shown .",
    "the luminosity function at @xmath49 is mostly incomplete and therefore not shown in this figure .",
    "we find that the quality of a derived luminosity function is tightly related to the biases of both estimated luminosity and photometric redshift .",
    "the quality of the luminosity function is also wavelength dependent : for all methods , the quality for redder filters is better than that for bluer filters .",
    "method a ( eazy with @xmath55 ) uses the luminosity and photometric redshift that have the best performance in terms of scatter among all the methods in general , but the quality of its luminosity functions is the worst . for the @xmath36-band luminosity functions ,",
    "the bright - ends are underestimated by 0.5 dex , the intermediate parts are overestimated by 0.5 dex , and the faint - ends are seriously underestimated again . for the luminosity functions of redder bands ,",
    "the quality becomes better , especially for the bright - ends .",
    "the faint - ends , however , are still seriously underestimated as compared to those derived using the other methods .",
    "this poor performance is primary due to the relatively large biases of @xmath55 and luminosity estimates at @xmath71 .",
    "compared to method a , the performance of method b ( eazy with @xmath56 ) is much better , even though both of them are template - fitting methods .",
    "while the scatters of the photometric redshift ( @xmath56 ) and the luminosity derived using method b are larger than those from method a , they both have significantly smaller biases compared to those of method a ( see tables  [ qphotoz_table ] and [ qlum_table ] ) .",
    "the luminosity function comparison results suggest that the bias performance of photometric redshift and luminosity is the key to the quality of the recovered luminosity functions ; whereas the scatters in these quantities have relatively minor consequences .    for the luminosity functions derived using the demp method ( c , d , and e , using @xmath40 , @xmath42 , and @xmath41 , respectively ) , we use @xmath56 for the purpose of binning the redshift , as is the case for method b. the differences in the qualities of the luminosity functions derived using these methods are therefore completely due to the differences in the estimated luminosities . according to table  [ qlum_table ]",
    ", the ranking of the performance of the luminosity bias from better to poor is : ( e ) @xmath72 ( c ) @xmath72 ( d ) , which agrees with the performance comparison of the luminosity functions shown in figure  [ qlf ] .",
    "this supports the argument that luminosity bias is more important than luminosity scatter for luminosity function recovery . for the lowest redshift bin ,",
    "the biases of the faint - ends of the luminosity functions for method c ( demp with @xmath40 ) are larger than those for methods d and e. this is the result of the number of faint galaxies at low redshifts in @xmath40 being much less than that of brighter galaxies ; the luminosities of these faint galaxies are therefore overestimated .",
    "either weighting the training set in luminosity space ( i.e. , @xmath42 ) or in redshift space ( i.e. , @xmath41 ) can increase the number of these faint galaxies at low redshifts in the training set ; the luminosity biases of these galaxies for methods d and e are therefore minimized .",
    "since the luminosity function results for methods b and e are very similar , we conclude that both of these two methods have the best performance in this experiment .",
    "we compare the estimated stellar masses using demp with those using the conventional sed fitting methods in this section . for the template - fitting methods , we use newhyperz with the galaxev @xcite templates to derive stellar masses , applying the photometric redshifts derived using newhyperz , eazy , and demp with @xmath38 .",
    "as has been done for the luminosity experiment , we examine the performances of the stellar - mass estimations by checking the accuracy of the derived stellar mass as a function of redshift and the precision of the constructed stellar - mass function .",
    "we show the accuracy of the estimated stellar mass as a function of redshift for each method in figure  [ qmass ] and the statistics of these results in table  [ qmass_table ] .",
    "we exclude objects at @xmath52 in table  [ qmass_table ] based on the same reason described in   [ lum ] for table  [ qlum_table ] .    for the template - fitting methods ( methods a , b , and c ) , the qualities of photometric redshifts used to derive stellar masses",
    "are directly reflected in the estimated stellar masses .",
    "@xmath73 has serious catastrophic errors at low-@xmath25 and overestimation at high-@xmath25 , which are also apparent in the estimated stellar - mass result ( panel a of figure  [ qmass ] ) .",
    "@xmath55 has smaller scatter compared to @xmath56 ; the scatter of the estimated stellar masses in panel b ( newhyperz with @xmath55 ) is smaller than that in panel c ( newhyperz with @xmath56 ) .",
    "however , one behavior shown in the photometric redshift results ( see figure  [ qphotoz ] and table  [ qphotoz_table ] ) is not propagated to the estimation of stellar mass .",
    "@xmath56 has smaller biases than @xmath55 at @xmath62 , but the biases of the estimated stellar masses for methods b and c , using @xmath55 and @xmath56 , respectively , are similar .",
    "in addition , the estimated stellar masses derived using the template - fitting methods are all overestimated by roughly 0.4 dex at @xmath74 .",
    "figure  [ lum_k ] shows that template - fitting methods overestimate the @xmath68-band luminosity by one magnitude .",
    "if we assume that the @xmath68-band luminosity is directly correlated with stellar mass , a one magnitude difference in @xmath68-band luminosity translates to a 0.4 dex difference in stellar mass , which is consistent with the stellar - mass biases derived using the template - fitting methods .    for the empirical - fitting methods ( methods d , e , and f ) , the quality of the estimated stellar mass can not be simply explained by the quality of the photometric redshift , since the stellar mass is derived directly from the photometry , by - passing photometric redshift determination . for a stellar - mass training",
    "set constructed from a flux - limited database , the mean stellar mass for galaxies at low-@xmath25 in the training set is lower than that for galaxies at intermediate redshift , and the number of objects at low-@xmath25 is smaller than that at intermediate redshift .",
    "similarly , the mean stellar mass for galaxies at high-@xmath25 is higher than that for galaxies at intermediate redshift , and the number of objects at high-@xmath25 is lower than that at intermediate redshift as well .",
    "hence , the stellar masses of objects at @xmath53 are biased by the objects at intermediate redshift and overestimated , and those at @xmath49 are underestimated because of the same reason .",
    "this effect can be seen in figure  [ qmass ] for method d ( demp with @xmath43 ) .",
    "method e uses the training set that is uniformly - weighted in stellar - mass space ( @xmath45 ) . although the stellar - mass distribution in @xmath45 is flat , the redshift distribution is seriously distorted , similar to that for the @xmath42 training set ( see figure  [ lbal_zdist ] ) .",
    "the uniform stellar - mass weighting process boosts the number of objects at @xmath53 by a factor of @xmath75 while the number of objects at the other redshift range just increases by a factor of @xmath76 .",
    "this reduces the bias at @xmath53 , but increases the scatter at @xmath61 and the bias at @xmath49 , as compared to those of method d ( demp with @xmath43 ) .",
    "method f uses the training set uniformly - weighted in redshift space ( @xmath44 ) . because the redshift distribution in @xmath44 is flat , the stellar - mass biases at @xmath53 and @xmath49 are reduced as compared to those of method d ( demp with @xmath43 ) .",
    "its stellar - mass bias at @xmath53 is not as small as that of method e ( demp with @xmath45 ) , but the performance at @xmath61 is much better than that of method e in terms of both bias and scatter .",
    "therefore , method f delivers the best result among the empirical methods .    generally speaking , the results derived using the empirical methods are all better than those derived using the template methods in the experiment of stellar - mass estimation . in conclusion ,",
    "method f ( demp with @xmath44 ) has the best balance between bias and scatter , outperforming all other tested methods .",
    "lrrrrrr ( a ) newhyperz w @xmath73 & 1.88 & 1.42 & 0.52 & 1.57 & 0.96 & 1.02 + ( b ) newhyperz w @xmath55 & 0.68 & 1.03 & 0.39 & 0.66 & 0.47 & 0.89 + ( c ) newhyperz w @xmath56 & 0.65 & 0.97 & 0.36 & 0.81 & 0.93 & 1.00 + ( d ) demp w @xmath43 & 0.18 & 0.41 & -0.02 & 0.22 & -0.25 & 0.45 + ( e ) demp w @xmath45 & 0.05 & 0.49 & -0.08 & 0.46 & -0.39 & 0.72 + ( f ) demp w @xmath44 & 0.19 & 0.61 & 0.01 & 0.34 & -0.07 & 0.53 +      we examine how well the stellar - mass function at different redshift ranges can be constructed using the different methods .",
    "as has been done in the luminosity function experiment , we use the derived photometric redshifts to populate the redshift bins for the stellar - mass functions to mimic real data .",
    "the photometric redshifts used for the redshift bins in method a are derived using newhyperz , those in method b are derived using eazy , and those in methods c , d , e , and f are derived using demp with @xmath38 .",
    "the completeness limit of the stellar - mass function for each redshift bin is estimated by comparing the stellar - mass function constructed using the ideal redshift and the ideal stellar mass of the rcs2 sample and that constructed using the whole cosmos sample .",
    "the results are shown in figure  [ qmf ] .",
    "there are three redshift bins : 0.00.3 , 0.30.5 , and 0.50.7 .",
    "only data points within the completeness limit are shown .",
    "the stellar - mass function at @xmath77 is mostly incomplete and therefore not shown in this figure .",
    "figure  [ qmf ] shows that all the results derived using the template - fitting methods have significant biases .",
    "these biases are in general due to two reasons : the biases of photometric redshifts which move objects to wrong redshift bins and also lead to biased stellar - mass estimates ; and the significant stellar - mass biases introduced by the template - fitting methods , as described in  [ mass_z ] .    for method a ( newhyperz with @xmath73 ) , the stellar - mass functions for @xmath78 and @xmath79",
    "are significantly underestimated ( @xmath35 0.5 dex ) for objects with stellar mass less than @xmath80 m@xmath81 .",
    "this is the result of the significantly overestimated photometric redshifts for objects at @xmath30 derived using newhyperz . since objects at these redshift bins are offset or scattered to the other higher redshift bins , the numbers of objects in these redshift bins decrease significantly , resulting in the underestimate of the stellar - mass functions .",
    "meanwhile , the stellar masses of these scattered objects are overestimated because of their overestimated photometric redshifts ; the numbers of massive objects ( @xmath82 m@xmath81 ) in the higher redshift bins ( i.e. , the @xmath79 and @xmath83 bins ) therefore increase significantly , resulting in the overestimated stellar - mass functions at the high - mass end .",
    "method b uses @xmath55 to reconstruct the stellar - mass functions . for @xmath53 ,",
    "most galaxies have their redshifts scattered to greater than 0.3 , causing the stellar - mass function for the lowest redshift bin to be seriously underestimated .",
    "these objects with overestimated photometric redshifts also have their stellar masses overestimated as well .",
    "in addition , the biases of the estimated stellar masses ( see method b in table  [ qmass_table ] ) also shift the stellar - mass function to the massive end .",
    "these effects lead to the overestimated high - mass ends of the stellar - mass functions for the 0.30.5 and 0.50.7 redshift bins .",
    "method c uses @xmath56 to generate the mass functions .",
    "the redshift bias of @xmath56 is smaller than @xmath73 and @xmath55 , especially for @xmath30 ; the stellar - mass function for the lowest redshift bin is therefore not as seriously underestimated as those derived using methods a and b. however , the bias in the estimated stellar masses ( see method c in table  [ qmass_table ] ) makes the stellar - mass function offset to the massive end ; the high - mass ends of the stellar - mass functions for all redshift bins are therefore overestimated . based on figure  [ qmf ] , method c outperforms all the other template - fitting methods .    for the empirical - fitting methods ( methods d , e , and f ) ,",
    "the photometric redshift used to reconstruct the stellar - mass functions is @xmath56 , which has the least photometric redshift bias .",
    "furthermore , the stellar masses estimated using the empirical - fitting methods have relatively low systematic bias . therefore , not surprisingly , the qualities of the estimated stellar - mass functions derived using the empirical - fitting methods are better than those derived using the template - fitting methods . the stellar mass used in method",
    "e is derived using @xmath45 ( see   [ mass_z ] ) , and has the largest scatter and bias among the empirical - fitting methods .",
    "the performance of the recovered stellar - mass functions is correspondingly the worst amongst the empirical methods , but not by much ; the variations of the mass functions in all the redshift bins are within @xmath84 dex . on the other hand ,",
    "method f uses the stellar mass derived using @xmath44 , which has the best overall performance in mass estimation . as shown in figure  [ qmf ] , panel f , the variations of the stellar - mass functions in all the redshift bins are within @xmath85 dex . the performances of methods d and f are similar .",
    "method d , which uses the unweighted training set @xmath43 , produces stellar masses with biases similar or slightly larger than those of method f in all the redshift bins , but with somewhat smaller scatters ( see table  [ qmass_table ] ) .",
    "it generates stellar - mass functions with performance very similar to those of method f. we therefore conclude that methods d and f provide the best results in reconstructing the stellar - mass function amongst all the methods tested .",
    "our analysis using a mock catalog of four - band photometry has shown that demp with the uniform redshift - weighted training sets outperforms all the other methods and training sets in our experiments .",
    "the results show that deriving luminosities and stellar masses from photometry directly ( i.e. , bypassing the photometric redshift estimation ) delivers significantly improved results .",
    "this is the result of the demp method avoiding introducing noises caused by photometric redshift errors and template uncertainties .",
    "these mock catalog experiments also show that resampling the training set galaxy sample to have a uniformly weighted redshift distribution produces the best results in not just estimating photometric redshift , but also luminosity and stellar mass .    besides the performance comparisons , the results show some other interesting phenomena that we did not expect .",
    "one may naively expect that one can only derive absolute luminosities for bands that are bracketed by the observed bands since one can interpolate across the sed between the observed bands .",
    "if the redshifted wavelength of the selected band is longer than the wavelength of the reddest filter or shorter than that of the bluest filter , the estimate of the luminosity is expected to be less reliable .",
    "therefore , with the rcs2 filter configuration , we expect the luminosity of a given band to be reliable only within a certain redshift range : @xmath86 for the @xmath36-band luminosity ; @xmath87 for the @xmath19-band luminosity ; @xmath88 for the @xmath20-band luminosity ; and @xmath89 for the @xmath21-band luminosity .",
    "the @xmath22-band luminosity for any redshift can only be derived by extrapolation .",
    "however , figures  [ qlum ] and [ qlf ] suggest that the performances of the empirical luminosity estimations are very similar for the different bands within each of the demp methods .",
    "surprisingly , figure  [ lum_k ] shows that the performances of the demp @xmath68-band luminosity estimations are also very similar to those of the optical luminosity estimations .",
    "these results imply that the observed nir photometry at @xmath90 m for galaxies at @xmath24 can be well constrained by their observed multi - wavelength optical photometry only , assuming one has near - infrared photometry for the training set .",
    "thus , in general , obtaining a relatively small set of training set data in filter bands other than those in the main data set will allow one to extrapolate photometric information for these bands using an empirical - fitting method .",
    "the results of our stellar - mass experiment also show some unexpected interesting results .",
    "conventional wisdom suggests that nir data are required for deriving stellar masses of galaxies , since most of the nir photons are emitted from low - mass stars which dominate a great part of the total stellar mass of a galaxy .",
    "furthermore , nir luminosities are less affected by star - formation rate ( sfr ) and dust extinction .",
    "thus , it is generally accepted that the nir luminosity is a better stellar - mass proxy than the optical luminosity .",
    "however , based on figures  [ qmass ] and [ qmf ] , we find that demp is able to estimate stellar mass relatively accurately , using only optical filter bands up to 9200 .",
    "it is not surprising that demp is able to estimate the stellar mass reasonably well given that it can derive near - infrared luminosities with a similar accuracy from optical data .",
    "the small set of stellar masses derived for the training set provides the additional priors needed to anchor the stellar mass estimates .",
    "some previous studies also found that the stellar mass of galaxies can be reasonably well derived using multi - wavelength optical broad - band photometry ( e.g. , * ? ? ? * ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) , which is consistent with the results of our experiments .",
    "however , it is worth noting that all these papers use spectroscopic redshifts in their measurements . for a large sky survey ,",
    "it is very time - consuming to obtain spectroscopic redshifts for all the sources .",
    "demp appears to be an excellent and robust method for estimating stellar masses for a large optical broadband survey .",
    "a conventional way to estimate the stellar mass using a template - fitting method for a galaxy with photometric redshift is to derive its redshift using a template that can deliver the most accurate photometric redshift , and then , using this photometric redshift , to derive the stellar mass using a template sed that provides information on stellar mass ( e.g. , * ? ? ?",
    "however , templates providing information on stellar mass ( e.g. , galaxev ) are usually not the best template for measuring photometric redshifts . if different templates are used for estimating redshifts and stellar masses , the sed for deriving the stellar mass may not fit the photometry properly for the given fixed photometric redshift .",
    "this can cause larger scatter and bias in the estimated stellar mass .",
    "for example , both the photometric redshifts and the stellar masses in panel a of figure  [ qmass ] are derived using newhyperz with the galaxev template .",
    "this method produces a large number of catastrophic photometric redshift errors ( 41% , see table  [ qphotoz_table ] ) at @xmath30 due to the lack of absolute magnitude priors . as a result ,",
    "a large number of galaxies at @xmath30 have very large errors in their stellar - mass estimates , as shown in the upper right part of panel a in figure  [ qmass ] however , inspecting the dat points in panels a , b , and c in figure  [ qmass ] for galaxies with @xmath91 , it can be seen that galaxies which do not suffer from catastrophic errors have smaller bias and scatter in their stellar mass estimations than those for methods b and c which use different templates or methods for estimating redshifts and stellar masses .",
    "moreover , the best photometric redshift for a certain object is usually calculated from its probability distribution function of photometric redshift instead of the one with the minimum @xmath17 .",
    "therefore , even when the same template is used for estimating redshifts and stellar masses , the sed fitting for the stellar - mass estimation may not be optimal if the best photometric redshift is used .",
    "deriving stellar masses using demp can avoid these issues .",
    "one of the main reasons that an empirical method such as demp can provide more robust results with smaller bias is that the training set basically provides a set of priors for the quantity that one wants to measure .",
    "compared to template - fitting methods , this set of priors is equivalent to the templates . however , having a set of measured priors appears to produce better results than using a set of model templates .",
    "the quality of the results delivered by demp relies on the quality of the training set . a good training set needs to cover a larger volume in the multi - dimensional magnitude - color space than the target set in order to provide a good solution for every object in the target set . in other words ,",
    "a good training set has to be more complete than the target set in terms of all the related aspects , such as depth , galaxy type , and redshift , etc .",
    "however , it is very difficult to generate a good training set .",
    "for example , the typical success rate in determining redshifts from spectroscopic data is about 70% for a flux - limited sample .",
    "this means about 30% of galaxies are not included in the training set , primarily due to the lack of strong features in their spectra .",
    "these missing galaxies usually belong to certain types of galaxies .",
    "thus , the demp result for these unsampled populations can be unreliable .",
    "one possible solution is to use template fitting with photometric data consisting of a great number of bands ( e.g. , more than 20 bands ) to assess these unsampled populations and to account for the incompleteness of the spectroscopic training set .",
    "however , the uniformity of the training set can be affected if some of the members of the training set are obtained using a different method .    there may be 10- or even 15-band large sky surveys in the future .",
    "the comparison of the performances of template - fitting methods and the demp methods for data with more than 10 bands can be very different from those shown in this paper .",
    "however , we focus only on how to derive the best results from a dataset with only a few bands in this paper , and find that demp is the more powerful method under this condition .",
    "investigating how well the template - fitting methods and demp perform using a dataset with more than 10 bands is out of the scope of this paper .",
    "in this paper , we introduce a simple but robust method , demp , which is able to deliver redshifts , luminosities , and stellar masses from multi - wavelength photometry empirically .",
    "it has two important features to minimize the two major issues in conventional empirical - fitting methods .",
    "first , demp uses a local subset of the training set with the 50 nearest neighbors in the multi - dimensional color - magnitude space for each galaxy to derive the photometric redshift for that galaxy .",
    "this feature addresses the issue of the suitability of the form for the empirical function by using a simple function applied locally .",
    "second , demp applies weighting to the objects in the training set to minimize the bias effect due to the non - uniformity of training set galaxy properties such as redshift , luminosity , and stellar mass .    based on the performance tests using an rcs2 mock catalog",
    ", we find that in general demp with a training set uniformly weighted in redshift space provides the best results in deriving photometric redshifts , when compared to demp with no training set weighting , or the template fitting methods .",
    "somewhat surprisingly , this conclusion regarding a redshift - weighted training set also applies to demp used for the direct derivations of galaxy luminosities and stellar mass , bypassing the use of photometric redshift ; it outperforms other demp methods with unweighted training sets , or training sets weighted to have uniform luminosity or stellar - mass distributions .",
    "it also similarly outperforms the template fitting methods .",
    "the demp method can also accurately estimate luminosities in rest filter bands well outside the range of the observed bands in the data .",
    "this is demonstrated by using the 4 observed optical bands in the mock catalog to derived ks band luminosities , producing results that are more than a factor of two more accurate than those from template fitting methods .",
    "this improved result is likely in part due to having ks - band data in the training set which serve the purpose of being a prior in the estimate .",
    "a similar conclusion can be drawn for estimating stellar masses , since they are fairly closely related to nir photometry .",
    "in addition to redshift , luminosity and stellar mass , demp can also be applied to derive other intrinsic properties of galaxies .",
    "for example , by assuming sfr and age are functions of photometry , one is able to estimate the sfrs and ages of galaxies empirically .",
    "the sfr and age training sets can be constructed using the sfrs and ages estimated from suitable spectroscopic datasets .",
    "in fact , studies in all aspects of galaxy evolution can benefit from demp , as long as the output value can be assumed to be a function of the inputs , delivering more robust results than those using conventional template - fitting methods ."
  ],
  "abstract_text": [
    "<S> large direct - imaging surveys usually use a template - fitting technique to estimate photometric redshifts for galaxies , which are then applied to derive important galaxy properties such as luminosities and stellar masses . </S>",
    "<S> these estimates can be noisy and suffer from systematic biases because of the possible mis - selection of templates and the propagation of the photometric redshift uncertainty . </S>",
    "<S> we introduce an algorithm , the direct empirical photometric method ( demp ) , which can be used to directly estimate these quantities using training sets , bypassing photometric redshift determination . </S>",
    "<S> demp also applies two techniques to minimize the effects arising from the non - uniform distribution of training - set galaxy redshifts from a flux - limited sample . </S>",
    "<S> first , for each input galaxy , fitting is performed using a subset of the training - set galaxies with photometry and colors closest to those of the input galaxy . </S>",
    "<S> second , the training set is artificially resampled to produce a flat distribution in redshift , or other properties , e.g. , luminosity . to test the performance of demp </S>",
    "<S> , we use a 4-filter - band mock catalog to examine its ability to recover redshift , luminosity , stellar mass , and luminosity and stellar - mass functions . </S>",
    "<S> we also compare the results to those from two publicly available template - fitting methods , finding that the demp algorithm outperforms both . </S>",
    "<S> we find resampling the training set to have a uniform redshift distribution produces the best results not only in photometric redshift , but also in estimating luminosity and stellar mass . </S>",
    "<S> the demp method is especially powerful in estimating quantities such as near - ir luminosities and stellar mass using only data from a small number of optical bands . </S>"
  ]
}