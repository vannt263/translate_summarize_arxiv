{
  "article_text": [
    "throughout this paper we denote by @xmath0 the free product of two fixed groups @xmath4 and @xmath6 , @xmath12 . note that we do not impose any restrictions on the finiteness properties ( e.g. finite presentability or finite generation ) and the cardinality of @xmath4 and @xmath6 . any element from @xmath0",
    "can be represented as an alternating product of the elements from @xmath4 and @xmath6 : @xmath36 where @xmath37 , @xmath38 , @xmath39 , @xmath40 and @xmath41 are possibly trivial . in the latter case",
    "we omit writing them .",
    "we think of elements @xmath42 as _ elements _ of the factors and presentation ( [ eq : nf ] ) is unique for any @xmath43 , see @xcite . in particular , we adopt the following convention : if @xmath44 , @xmath45 are terms of a word and @xmath46 , we only use either @xmath44 and write @xmath45 as @xmath47 or vice - versa .",
    "note that we do not impose any restrictions on the groups @xmath4 and @xmath6 , e.g. the groups @xmath4 and @xmath6 may be infinitely presented or infinitely generated .",
    "we call elements written in the form ( [ eq : nf ] ) _ reduced_. we refer to elements @xmath37 , @xmath38 as to the _ terms _ of @xmath48 . below",
    "if not stated otherwise we assume that all words are reduced .",
    "henceforth , by the symbol ` @xmath49 ' we denote graphical equality of words , i.e. for two words @xmath48 , @xmath50 of @xmath0 written in normal form ( [ eq : nf ] ) we write @xmath51 if and only if @xmath52 , @xmath53 .",
    "the length @xmath54 of an element @xmath48 written in the form ( [ eq : nf ] ) is the number of non - trivial terms in @xmath48 .",
    "we now define the initial and terminal types of an element .",
    "these functions determine the factors to which the initial and terminal letters of a word in @xmath0 belong .",
    "define the functions @xmath55 and @xmath56 from @xmath0 to the set @xmath57 as follows : @xmath58 @xmath59 set @xmath60 , @xmath61 , where @xmath62 and @xmath63 are the full preimages in @xmath0 of @xmath26 and @xmath64 with respect to @xmath55 and @xmath56 correspondingly . by the definition , set @xmath65 and @xmath66 . finally , @xmath67 is the set of all non - trivial elements of the group @xmath0 .",
    "we say that an element @xmath68 is a subword of @xmath48 if the normal form of @xmath69 is a subword of the normal form of @xmath48 .",
    "in particular if @xmath70 , @xmath71 and if @xmath72 , then @xmath73 and @xmath74 , where @xmath75    we say that @xmath76 is a subdivision of @xmath48 if @xmath77 and @xmath78 are subwords of @xmath48 and @xmath79 .",
    "in particular , we have @xmath80 and if @xmath81 then @xmath82 and , moreover , @xmath83 , where @xmath84 .",
    "if @xmath79 is a subdivision of @xmath48 , then we say that @xmath77 and @xmath78 are , respectively , initial and terminal subwords of @xmath48 .",
    "let @xmath43 and @xmath85 .",
    "then @xmath48 is called _ cyclically reduced _ if and only if , @xmath86 . an element @xmath87 is called a _ cyclic permutation _ of a cyclically reduced element @xmath43 if and only if there exists a subdivision @xmath79 of @xmath48 such that @xmath88 .",
    "note that in this case @xmath69 is also cyclically reduced .",
    "we would like to note that we assume that the group @xmath0 is a free product of two groups @xmath4 and @xmath6 for the sake of simplicity of notation only .",
    "all the definitions , proofs and results in this paper carry over in a straightforward way to the case when @xmath0 is a free product of _ finitely many _ groups , @xmath89 .",
    "in this section we introduce notation for graphs that we use in this paper .",
    "let @xmath90 be an oriented graph , where @xmath91 is the set of vertices of @xmath92 and @xmath93 is the set of edges of @xmath92 . if an edge @xmath94 has _ origin _ @xmath95 and _ terminus _ @xmath96 , we sometimes write @xmath97 . we always denote the paths in a graph by letters @xmath98 and @xmath99 , and cycles by the letter @xmath100 . to indicate that a path @xmath98 begins at a vertex @xmath95 and ends at a vertex @xmath96 we write @xmath101 .",
    "if not stated otherwise , we assume that all paths we consider are simple . for a path @xmath102 by @xmath103",
    "we denote the reverse ( if it exists ) of the path @xmath101 , that is a path @xmath104 from @xmath96 to @xmath95 , @xmath105 , where @xmath106 is the inverse of the edge @xmath107 , @xmath108 .",
    "usually , the edges of the graph are labelled by certain words or letters .",
    "label _ of a path @xmath109 is the concatenation of labels of the edges @xmath110 .",
    "let @xmath92 be an oriented rooted tree , with the root at a vertex @xmath111 and such that for any vertex @xmath112 there exists a unique path @xmath113 from @xmath111 to @xmath95 .",
    "the length of this path from @xmath111 to @xmath95 is called the _ height of the vertex @xmath95_. the number @xmath114 , if it exists , is called the _ height of the tree @xmath92 _ , otherwise we say that the height of @xmath92 is infinite .",
    "we say that a vertex @xmath95 of height @xmath115 is _ above _ a vertex @xmath96 of height @xmath116 if and only if @xmath117 and there exists a path of length @xmath118 from @xmath96 to @xmath95 .      in @xcite g.  baumslag ,",
    "a.  miasnikov and v.  remeslennikov lay down the foundations of algebraic geometry over groups and introduce group - theoretic counterparts of basic notions from algebraic geometry over fields .",
    "we now recall some of the basics of algebraic geometry over groups .",
    "we refer to @xcite for details .    algebraic geometry over groups centers around the notion of a _",
    "@xmath0-group _ , where @xmath0 is a fixed group generated by a set @xmath119 .",
    "these @xmath0-groups can be likened to algebras over a unitary commutative ring , more specially a field , with @xmath0 playing the role of the coefficient ring .",
    "we therefore , shall consider the category of @xmath0-groups , i.e. groups which contain a designated subgroup isomorphic to the group @xmath0 .",
    "if @xmath2 and @xmath120 are @xmath0-groups then a homomorphism @xmath121 is a _ @xmath0-homomorphism _ if @xmath122 for every @xmath123 . in the category of @xmath0-groups morphisms",
    "are @xmath0-homomorphisms ; subgroups are @xmath0-subgroups , etc . by @xmath124",
    "we denote the set of all @xmath0-homomorphisms from @xmath2 into @xmath120 .",
    "a @xmath0-group @xmath2 is termed if there exists a finite subset @xmath125 such that the set @xmath126 generates @xmath2 .",
    "it is not hard to see that the free product @xmath127 is a free object in the category of @xmath0-groups , where @xmath128 is a free group with basis @xmath129 .",
    "this group is called a free @xmath0-group with basis @xmath130 , and we denote it by @xmath131 $ ] .    for any element",
    "@xmath132 $ ] the formal equality @xmath133 can be treated , in an obvious way , as an _ equation _ over @xmath0 . in general , for a subset @xmath134 $ ] the formal equality @xmath135 can be treated as over @xmath0 with coefficients in @xmath119 . in other words ,",
    "every equation is a word in @xmath136 .",
    "elements from @xmath130 are called _ variables _ , and elements from @xmath137 are called _ coefficients _ or _ constants_. to emphasize this we sometimes write @xmath138 .",
    "a @xmath139 of the system @xmath140 over a group @xmath0 is a tuple of elements @xmath141 such that every equation from @xmath11 vanishes at @xmath142 , i.e. @xmath143 in @xmath0 , for all @xmath144 .",
    "equivalently , a solution @xmath139 of the system @xmath145 over @xmath0 is a @xmath0-homomorphism @xmath146 \\to g$ ] induced by the map @xmath147 such that @xmath148 .",
    "when no confusion arises , we abuse the notation and write @xmath149 , where @xmath150 $ ] , instead of @xmath151 .",
    "denote by @xmath152 the normal closure of @xmath11 in @xmath131 $ ] .",
    "then every solution of @xmath140 in @xmath0 gives rise to a @xmath0-homomorphism @xmath153 $ } \\!\\mathord{\\left/ { \\vphantom { g[x ] { \\operatorname{ncl}\\langle s\\rangle ) } } } \\right.\\kern-\\nulldelimiterspace } \\!\\lower0.7ex\\hbox{${\\operatorname{ncl}\\langle s\\rangle ) } $ } } } \\to g$ ] , and vice - versa .",
    "the set of all solutions over @xmath0 of the system @xmath135 is denoted by @xmath154 and is called the @xmath11 .    for every system of equations",
    "@xmath11 we set the to be the following subgroup of @xmath131 $ ] : @xmath155 \\ \\mid \\ \\forall",
    "g_1,\\dots,\\forall g_n   \\left ( s(g_1,\\dots , g_n ) = 1 \\rightarrow t(g_1,\\dots , g_n ) = 1\\right ) \\right\\}.\\ ] ] it is easy to see that @xmath156 is a normal subgroup of @xmath131 $ ] that contains @xmath11 .",
    "there is a one - to - one correspondence between algebraic sets @xmath154 and radical subgroups @xmath156 of @xmath131 $ ] .",
    "notice that if @xmath157 , then @xmath158 $ ] .",
    "it follows from the definition that @xmath159 the factor group @xmath160 $ } \\!\\mathord{\\left/ { \\vphantom { g[x ] { r(s)}}}\\right.\\kern-\\nulldelimiterspace } \\!\\lower0.7ex\\hbox{${r(s)}$}}}\\ ] ] is called the of the algebraic set @xmath154 ( or of the system @xmath11 ) .",
    "there exists a one - to - one correspondence between the algebraic sets and coordinate groups @xmath161 . more formally , the categories of algebraic sets and coordinate groups are equivalent , see theorem 4 , @xcite .    a @xmath0-group @xmath2 is called if every system @xmath140 with coefficients from @xmath0 is equivalent over @xmath0 to a finite subsystem @xmath162 , where @xmath163 , i.e. the system @xmath11 and its subsystem @xmath32 define the same algebraic set .",
    "if @xmath0 is @xmath0-equationally noetherian , then we say that @xmath0 is equationally noetherian . if @xmath0 is equationally noetherian then the zariski topology over @xmath164 is _ noetherian _ for every @xmath34 , i.e. , every proper descending chain of closed sets in @xmath164 is finite .",
    "this implies that every algebraic set @xmath165 in @xmath164 is a finite union of irreducible subsets , called of @xmath165 , and such a decomposition of @xmath165 is unique .",
    "recall that a closed subset @xmath165 is if it is not a union of two proper closed ( in the induced topology ) subsets .",
    "if @xmath166 and @xmath167 are algebraic sets , then a map @xmath168 is a _",
    "morphism _ of algebraic sets if there exist @xmath169 $ ] such that , for any @xmath170 , @xmath171 occasionally we refer to morphisms of algebraic sets as _ word mappings_.    algebraic sets @xmath154 and @xmath172 are called _ isomorphic _ if there exist morphisms @xmath173 and @xmath174 such that @xmath175 and @xmath176 .",
    "two systems of equations @xmath11 and @xmath177 over @xmath0 are called _ equivalent _ if the algebraic sets @xmath154 and @xmath172 are isomorphic .",
    "let @xmath0 be a group and let @xmath154 and @xmath172 be two algebraic sets over @xmath0 .",
    "then the algebraic sets @xmath154 and @xmath172 are isomorphic if and only if the coordinate groups @xmath178 and @xmath179 are @xmath0-isomorphic .",
    "in this section we recall some basic notions of first - order logic and model theory .",
    "we refer the reader to @xcite for details .",
    "let @xmath0 be a group generated by the set @xmath119 .",
    "the standard first - order language of group theory , which we denote by @xmath182 , consists of a symbol for multiplication @xmath183 , a symbol for inversion @xmath184 , and a symbol for the identity @xmath185 . to deal with @xmath0-groups",
    ", we have to enrich the language @xmath182 by all the elements from @xmath0 as constants .",
    "in fact , as @xmath0 is generated by @xmath119 , it suffices to enrich the language @xmath182 by the constants that correspond to elements of @xmath119 , i.e. for every element of @xmath186 we introduce a new constant @xmath187 .",
    "we denote language @xmath182 enriched by constants from @xmath119 by @xmath180 , and by constants from @xmath0 by @xmath188 . in this section we further consider only the language @xmath189 , but everything stated below carries over to the case of the language @xmath188 .",
    "a group word in variables @xmath130 and constants @xmath119 is a word @xmath190 in the alphabet @xmath191 .",
    "one may consider the word @xmath190 as a term in the language @xmath189 .",
    "observe that every term in the language @xmath189 is equivalent modulo the axioms of group theory to a group word in variables @xmath130 and constants @xmath119 .",
    "an in the language @xmath189 is a formula of the type @xmath192 , where @xmath190 is a group word in @xmath130 and @xmath119 .",
    "we interpret atomic formulas in @xmath189 as equations over @xmath0 , and vice versa .",
    "boolean combination _ of atomic formulas in the language @xmath189 is a disjunction of conjunctions of atomic formulas and their negations .",
    "thus every boolean combination @xmath193 of atomic formulas in @xmath189 can be written in the form @xmath194 , where each @xmath195 has one of following form : @xmath196    it follows from general results on disjunctive normal forms in propositional logic that every quantifier - free formula in the language @xmath197 is logically equivalent ( modulo the axioms of group theory ) to a boolean combination of atomic ones . moreover ,",
    "every formula @xmath193 in @xmath189 with _ free variables _",
    "@xmath198 is logically equivalent to a formula of the type @xmath199 where @xmath200 , and @xmath201 is a boolean combination of atomic formulas in variables from @xmath202 . introducing fictitious quantifiers , if necessary , one can always rewrite the formula @xmath193 in the form @xmath203    a first - order formula @xmath193",
    "is called a _ sentence _ , if @xmath193 does not contain free variables .",
    "a sentence @xmath193 is called _ universal _ if and only if @xmath193 is equivalent to a formula of the type : @xmath204 where @xmath205 is a boolean combination of atomic formulas in variables from @xmath130 .",
    "we sometimes refer to universal sentences as to universal formulas .",
    "a _ quasi identity _ in the language @xmath189 is a universal formula of the form @xmath206 where @xmath207 and @xmath208 are terms .",
    "the collection of all quasi identities satisfied by the group @xmath0 is called the _",
    "universal horn theory _ of @xmath0 .",
    "a standard quadratic equation over the group @xmath0 is an equation of the one of the following forms : @xmath209 \\prod_{i=1}^{m}z_i^{-1}c_iz_i d = 1,\\ n , m \\geq 0 , m+n \\geq 1 ; \\ ] ] @xmath210 equations of the form ( [ eq : st2 ] ) are called _ orientable _ of genus @xmath34 , and equations of the form ( [ eq : st4 ] ) are called _ non - orientable _ of genus @xmath34 .",
    "let @xmath211 be a strictly quadratic equation ( that is an equation in which every variable occurs exactly twice ) over a group @xmath0 .",
    "then there is a @xmath0-automorphism @xmath212)$ ] such that @xmath213 is a standard quadratic equation over @xmath0 .    to each quadratic equation one",
    "can associate a punctured surface .",
    "for example , the orientable surface associated to an equation ( [ eq : st2 ] ) will have genus @xmath34 and @xmath214 punctures .",
    "a system of equations @xmath145 is called _ triangular quasi - quadratic _ over @xmath0 if it can be partitioned into the following subsystems @xmath215 where for each @xmath26 one of the following holds :    1 .",
    "@xmath216 is quadratic in variables @xmath217 ; 2 .",
    "[ it:2 ) ] @xmath218=1 , [ y , u]=1 , [ z , u]=1 \\mid y , z \\in x_i\\}$ ] , where @xmath219 is a group word in @xmath220 . in this case",
    "we say that @xmath221 corresponds to an extension of a centraliser ; 3 .   @xmath218=1 \\mid y , z \\in x_i\\}$ ] ; 4 .",
    "@xmath216 is the empty equation .    in the above notation ,",
    "define @xmath222 for @xmath223 and put @xmath224 the triangular quasi - quadratic system @xmath145 is called _ non - degenerate _ or simply ntq if the following conditions hold :    1 .   each system @xmath221 , where @xmath225 are viewed as the corresponding constants from @xmath226 ( under the canonical maps @xmath227 , @xmath228 ) has a solution in @xmath226 ; 2 .",
    "the element in @xmath226 represented by the word @xmath219 from case ( c ) above , is not a proper power in @xmath226 .",
    "the notion of a generalised equation was introduced by makanin in @xcite .",
    "a generalised equation is a combinatorial object which encodes a system of equations .",
    "the motivation for defining a generalised equation is two - fold .",
    "one the one hand , it gives an efficient way of encoding all the information about a system of equations and , on the other hand , elementary transformations , that are essential for makanin s algorithm , see section [ se:5.1 ] , have a cumbersome description in terms of systems of equations , but admit an intuitive one in terms of graphic representations of combinatorial generalised equations . in this sense",
    "graphic representations of generalised equations can be likened to matrices . in linear algebra",
    "there is a correspondence between systems of equations over a field @xmath229 and matrices with elements from @xmath229 . to describe the set of solutions of a system of equations , one uses gauss elimination which is usually applied to matrices , rather than systems of equations .    in @xcite , makanin reduced the decidability of equations over a free group to the decidability of finitely many systems of equations over a free monoid , in other words , he reduced the compatibility problem for a free group to the compatibility problem for generalised equations .",
    "in fact , makanin essentially proved that the study of solutions of systems of equations over free groups reduces to the study of solutions of generalised equations in the following sense : every solution of the system of equations @xmath11 factors trough one of the solutions of one of the generalised equations and , conversely , every solution of the generalised equation extends to a solution of @xmath11 .",
    "a crucial fact for this reduction is that the set of solutions of a given system of equations @xmath11 over a free group , defines only finitely many different cancellation schemes ( cancellation trees ) . by each of these cancellation trees",
    ", one can construct a generalised equation .",
    "the goal of this section is to generalise this approach to systems of equations over a free product of groups @xmath0 .",
    "though the ideas of the reduction are easy , the formal definitions of generalised equation and partition table are technical .",
    "the reader non - familiar with the definitions may wish to consult some of the examples given in @xcite .",
    "let @xmath3 be the free product of two arbitrary groups .",
    "let @xmath230 be a set of variables , let @xmath231 be a set of constants from @xmath0 and let @xmath131 = g \\ast f(x)$ ] .",
    "recall , that we assume that @xmath3 for simplicity of notation only .",
    "all the definitions , proofs and result carry over to the case when @xmath0 is the free product of finitely many groups",
    ".    it will be convenient for us to assume that _ all _ equations of a system @xmath11 over @xmath0 are triangular i.e. every equation @xmath221 of @xmath11 has the form @xmath232 , where @xmath233 and @xmath234 .",
    "the assumption that all equations in @xmath11 are triangular is used in section [ se:4 - 1 ] .",
    "the only reason to triangulate @xmath11 is to simplify the notation .",
    "it is not hard to generalise the constructions given in section [ se:4 - 1 ] to the case where @xmath11 is an arbitrary finite system of equations .",
    "a _ combinatorial generalised equation _ @xmath235 ( with constants from @xmath236 ) consists of the following objects :    1 .   a finite set of _ bases _ @xmath237 .",
    "every base is one of the following three types : * a @xmath4-_constant base _ , a @xmath6-constant base , * a @xmath4-_factor base _ , a @xmath6-factor base , * or a",
    "_ variable base_. + if no confusion arises , we will further omit the prefix @xmath4- or @xmath6-",
    ". each constant base is associated with exactly one element from @xmath236 .",
    "the set of variable bases @xmath238 consists of @xmath239 elements @xmath240 .",
    "the set @xmath238 comes equipped with two functions : a function @xmath241 and an involution @xmath242 ( i.e. @xmath243 is a bijection such that @xmath244 is the identity on @xmath245 )",
    ". bases @xmath246 and @xmath247 are called _",
    "dual bases_. + the set of @xmath248-factor bases @xmath249 consists of @xmath250 elements , comes equipped with a function @xmath251 and is partitioned into disjoint subsets of @xmath252 elements each : @xmath253 .",
    "the sets @xmath254 are called _ sets of dual bases _ , bases belonging to @xmath254 are numbered sequentially : @xmath255 . given a @xmath248-factor base @xmath256 ,",
    "there are precisely two dual to @xmath256 @xmath248-factor bases .",
    "2 .   a set of _ boundaries _ @xmath257 .",
    "the set @xmath258 is a finite initial segment of the set of positive integers @xmath259 .",
    "3 .   two functions @xmath260 and @xmath261 .",
    "we call @xmath262 and @xmath263 the _ initial _ and _ terminal _ boundaries of the base @xmath246 .",
    "these functions satisfy the following conditions : @xmath264 for every base @xmath265 ; if @xmath266 is a constant base then @xmath267 .",
    "4 .   two more functions @xmath268 and @xmath269 .",
    "we call @xmath270 and @xmath271 the _ initial and terminal terms _ of the boundary @xmath26",
    ". 5 .   a finite set of _ boundary connections _",
    "@xmath272 . a ( @xmath246-)boundary connection is a triple @xmath273 , where @xmath274 , @xmath275 such that @xmath276 , @xmath277 and @xmath278 , @xmath279 if @xmath280 , and @xmath281 , @xmath282 if @xmath283 .",
    "we assume that if @xmath284 then @xmath285 .",
    "this allows one to identify the boundary connections @xmath273 and @xmath286 .",
    "though , by the definition , a combinatorial generalised equation is a combinatorial object , it is not practical to work with combinatorial generalised equations describing its sets and functions .",
    "it is more convenient to encode all this information in its graphic representation .",
    "we refer the reader to figure [ fig : et1 ] for an example of a graphic representation of a generalised equation .",
    "further examples along with the formal construction of the graphic representation can be found in @xcite .    to a combinatorial generalised equation @xmath235 ,",
    "one can canonically associate :    * a system of equations in _ variables _",
    "@xmath287 , @xmath288 and coefficients from @xmath236 ( variables @xmath289 are often called _ items _ ) , * a system of equations over @xmath4 , * a system of equations over @xmath6 , * and constraints .",
    "this collection is called a _ generalised equation _ , and ( abusing the language ) we denote it by the same symbol @xmath235 . by a combinatorial generalised equation , the equations and constrains of the generalised equation @xmath235 are constructed as follows .    1 .",
    "each pair of dual variable bases @xmath290 gives rise to an equation @xmath291 : @xmath292}^ { \\varepsilon ( \\lambda)}= { \\left[h_{\\alpha ( \\delta ( \\lambda ) ) } h_{\\alpha ( \\delta ( \\lambda ) ) + 1 } \\cdots h_{\\beta ( \\delta ( \\lambda ) ) -1}\\right]}^{\\varepsilon ( \\delta ( \\lambda))}.\\ ] ] these equations are called _",
    "basic equations_. 2 .",
    "every set of dual bases @xmath254 , @xmath293 , @xmath294 gives rise to the following _ @xmath248-factor equation _ : @xmath295 3 .   for each constant base @xmath266",
    "we write a _ coefficient equation _ : @xmath296 where @xmath297 is the constant associated with @xmath266 .",
    "4 .   every boundary connection @xmath298 gives rise to a _ boundary equation _",
    "@xmath299= [ h_{\\alpha ( \\delta ( \\lambda ) ) } h_{\\alpha ( \\delta ( \\lambda ) ) + 1 } \\cdots h_{q-1}],\\ ] ] if @xmath300 and @xmath301= [ h_{q}h_{q+1}\\cdots h_{\\beta ( \\delta ( \\lambda))-1}]^{-1},\\ ] ] if @xmath302 . 5 .",
    "every item @xmath303 , @xmath304 gives rise to a _ type constraint _",
    "@xmath305    we assume that every generalised equation comes associated with a combinatorial one .",
    "let @xmath306 be a generalised equation in variables @xmath307 with constants from @xmath236 ( here @xmath308 , @xmath309 are words in @xmath310 and @xmath311 are subsets of the sets @xmath312 ) .",
    "a tuple @xmath313 of nontrivial elements of @xmath0 written in the form ( [ eq : nf ] ) is a of @xmath314 if :    1 .",
    "all words @xmath315 are reduced as written ( i.e. written in the form ( [ eq : nf ] ) ) ; 2 .",
    "@xmath316 in @xmath0 , @xmath317 ; 3 .",
    "@xmath318 in the corresponding factor , @xmath319 ; 4 .",
    "the elements @xmath320 satisfy the type constraints , i.e. @xmath321 .    the _ length _ of a solution @xmath2 is defined to be @xmath322    the notation @xmath323 means that @xmath2 is a solution of the generalised equation @xmath235 .",
    "we now introduce a number of notions that we use throughout the text .",
    "let @xmath235 be a generalised equation .",
    "a boundary @xmath26 _ intersects _ the base @xmath246 if @xmath324 . a boundary @xmath26 _ touches _ the base @xmath246 if @xmath325 or @xmath326 .",
    "a boundary is said to be _ open _ if it intersects at least one base , otherwise it is called _",
    "closed_. we say that a boundary @xmath26 is _ tied _ in a base @xmath246 ( or is _ @xmath246-tied _ ) if there exists a boundary connection @xmath327 such that @xmath328 or @xmath329 .",
    "a boundary is _ free _ if it does not touch any base and it is not tied by a boundary connection .",
    "an item @xmath289 _ belongs _ to a base @xmath246 or , equivalently , @xmath246 _ contains _",
    "@xmath289 , if @xmath330 ( in this case we sometimes write @xmath331 ) .",
    "an item @xmath289 is called a _",
    "@xmath332-constant _ item if it belongs to a constant base @xmath266 and the constant @xmath333 associated to the base @xmath266 belongs to @xmath332 , @xmath334 .",
    "the item @xmath289 is called a _ @xmath332-factor",
    "_ item if it belongs to a @xmath332-factor base , @xmath334 , and is called a _ free _ item if it does not belong to any base . by @xmath335",
    "we denote the number of bases which contain @xmath289 , in this case we also say that @xmath289 is _ covered _ @xmath336 times .",
    "an item @xmath289 is called _ linear _ if @xmath337 and is called _ quadratic _ if @xmath338 .",
    "let @xmath339 be a pair of dual bases such that @xmath340 and @xmath341 in this case we say that bases @xmath246 and @xmath247 form _ a pair of matched bases_. a base @xmath342 is _ contained _ in a base @xmath246 if @xmath343 .",
    "we say that two bases @xmath246 and @xmath344 _ intersect _ or _",
    "overlap _ , if @xmath345\\cap [ \\alpha(\\nu),\\beta(\\nu)]\\ne \\emptyset$ ] .",
    "a base @xmath246 is called _ linear _ if there exists an item @xmath346 so that @xmath289 is linear .",
    "a set of consecutive items @xmath347 = \\{h_i,\\ldots , h_{j-1}\\}$ ] is called a _ section_. a section is said to be _ closed _ if the boundaries @xmath26 and @xmath64 are closed and all the boundaries between them are open . if @xmath246 is a base then by @xmath348 we denote the section @xmath345 $ ] and by @xmath349 we denote the product of items @xmath350 . in general for a section",
    "@xmath347 $ ] by @xmath351 $ ] we denote the product @xmath352 .",
    "a base @xmath246 _ belongs _ to a section @xmath347 $ ] if @xmath353 .",
    "similarly an item @xmath354 _ belongs _ to a section @xmath347 $ ] if @xmath355 . in these cases",
    "we write @xmath356 $ ] or @xmath357 $ ] .",
    "let @xmath358 be a solution of a generalised equation @xmath235 in variables @xmath359 .",
    "we use the following notation .",
    "for any word @xmath360 in @xmath361 $ ] set @xmath362 . in particular , for any base @xmath246 ( section @xmath363 $ ] ) of @xmath235 , we have @xmath364 ( @xmath365=h(\\sigma)=h(h(\\sigma))=h_i\\cdots h_{j-1}$ ] , respectively ) .",
    "we now formulate some necessary conditions for a generalised equation to have a solution .",
    "[ defn : formcons ] a generalised equation @xmath235 is called _ formally consistent _ if it satisfies the following conditions .    1 .   [ item : fc1 ] if @xmath366 , then the bases @xmath246 and @xmath367 do not intersect .",
    "[ it : forcon2 ] given two boundary connections @xmath368 and @xmath369 , if @xmath370 , then @xmath371 in the case when @xmath372 , and @xmath373 in the case when @xmath374 . in particular , if @xmath375 then @xmath376 .",
    "3 .   let @xmath246 be a base such that @xmath377 , in other words , let @xmath246 and @xmath247 be a pair of matched bases .",
    "if @xmath378 is a @xmath246-boundary connection then @xmath379 .",
    "[ item : fc4 ] let @xmath380 be either a @xmath19-constant base or a @xmath19-factor base , @xmath381 .",
    "similarly , let @xmath382 be either a @xmath248-constant base or a @xmath248-factor base , @xmath294 . if @xmath383 then @xmath384 .",
    "[ item : clean ] let @xmath385 be a @xmath248-factor base or a @xmath248-constant base . if @xmath385 is contained in a base @xmath246 and @xmath386 , @xmath387 are boundary connections , then @xmath388 .",
    "[ item : fc6 ] let @xmath246 be a variable base or a @xmath248-factor base . if @xmath366 , then @xmath389 and @xmath390 . if @xmath391 , then @xmath392 and @xmath393 .",
    "[ item : fc7 ] let @xmath344 be a @xmath248-factor base , @xmath394 .",
    "if @xmath395 , @xmath396 , then @xmath397 and @xmath398 .",
    "if @xmath399 , then @xmath400 and @xmath401 .",
    "[ le:4.1 ]    1 .",
    "[ it : fcl1 ] if a generalised equation @xmath235 has a solution , then @xmath235 is formally consistent ; 2 .",
    "[ it : fcl2 ] there is an algorithm to check whether or not a given generalised equation is formally consistent .",
    "it is easy to see that if @xmath235 has a solution then it satisfies conditions ( [ item : fc1])-([item : fc4 ] ) , ( [ item : fc6 ] ) , ( [ item : fc7 ] ) of definition [ defn : formcons ] .",
    "condition ( [ item : clean ] ) follows from statement ( [ item : le14 - 3 ] ) of lemma [ le : r1 ] , since if for a given @xmath19-factor base or @xmath19-constant base @xmath344 we have @xmath402 , the equality @xmath403 is not graphical .",
    "we further consider only formally consistent generalised equations .",
    "in this section , we show how for a given finite system of triangular equations @xmath404 over @xmath0 one can canonically associate a finite collection of generalised equations @xmath405 with constants from @xmath236 , which to some extent describes all solutions of the system @xmath404 .",
    "let @xmath404 be a finite system of triangular equations @xmath406 over the group @xmath0 .",
    "write @xmath404 in the form @xmath407 where @xmath408 are letters in the alphabet @xmath409 .",
    "we aim to define a combinatorial object called a partition table , that encodes a particular type of cancellation that happens when one substitutes a solution @xmath410 into @xmath411 and then reduces the words in @xmath412 to the empty word . to acquire an intuition on how the partition tables are constructed",
    ", the reader may consult section [ sec : relsol2ge ] .",
    "informally , a partition table is a collection of words .",
    "each word corresponds to an occurrence of a variable in the system @xmath11 .",
    "letters from @xmath413 ( see the definition below ) encode the pieces of the variable that cancel freely .",
    "the letters from @xmath414 encode cancellation in the factor @xmath19 .",
    "[ defn : partab ] a _ partition table _ @xmath415 of @xmath416 is a set of reduced words @xmath417 from the free group @xmath418 , where @xmath419 , @xmath420 , @xmath421 , @xmath422 , which satisfy the conditions below .",
    "( note , that the triple index @xmath423 of @xmath424 is decoded as follows : @xmath425 see section [ sec : relsol2ge ] for details . )    1 .",
    "[ it : defpt1 ] the equality @xmath426 , @xmath427 holds in @xmath428 .",
    "[ it : defpt2 ] every letter from @xmath429 occurs at most once in the word @xmath165 .",
    "moreover , if a letter @xmath430 occurs in @xmath431 , then the letter @xmath432 does not occur in @xmath431 .",
    "the letters from @xmath433 do not occur in @xmath165 .",
    "[ it : defpt3 ] there are no subwords of the form @xmath434 in the words @xmath431 .",
    "[ it : defpt4 ] for every subword of @xmath435 of the form @xmath436 , where @xmath437 , the following holds @xmath438 5 .",
    "[ it : defpt5 ] if @xmath439 , then @xmath440 .",
    "since the number of letters in @xmath441 is bounded , conditions ( [ it : defpt2 ] ) , ( [ it : defpt3 ] ) and ( [ it : defpt4 ] ) of definition [ defn : partab ] imply that the length @xmath442 of @xmath431 is bounded above by a function of the system @xmath411 .",
    "[ le:4.2 ] let @xmath404 be a finite system of equations over @xmath0",
    ". then    1 .",
    "the set @xmath443 of all partition tables of the system @xmath11 is finite , and its cardinality is bounded above by a number which depends only on @xmath444 ; 2 .",
    "one can effectively construct the set @xmath443 .",
    "since the words @xmath431 have bounded length , one can effectively construct the finite set of all collections of words @xmath445 in @xmath446 which satisfy conditions ( [ it : defpt2 ] ) , ( [ it : defpt3 ] ) , ( [ it : defpt5 ] ) of definition [ defn : partab ] .",
    "now for each such collection @xmath445 , one can effectively check whether or not conditions ( [ it : defpt1 ] ) and ( [ it : defpt4 ] ) hold .",
    "this allows one to list all partition tables for @xmath404 .    by a partition table @xmath447",
    "we construct a generalised equation @xmath448 in the following way . consider the following word @xmath165 in the free monoid @xmath449 @xmath450 where @xmath451 and @xmath452 is the length of @xmath165 .",
    "then the generalised equation @xmath453 has @xmath454 boundaries and @xmath455 variables @xmath456 , @xmath457 .",
    "now we define the bases of @xmath458 and the functions @xmath459 .    put @xmath460 for all @xmath26 .",
    "let @xmath461 . for the ( unique ) pair of distinct occurrences @xmath462 and @xmath463 , @xmath464 of @xmath465 in @xmath165 @xmath466 we introduce a pair of dual variable bases @xmath467 .",
    "put @xmath468 the basic equation that corresponds to this pair of dual bases is @xmath469 .",
    "let @xmath470 .",
    "for any two distinct occurrences of @xmath471 in @xmath404 : @xmath472 so that @xmath473 precedes @xmath474 in left - lexicographical order , we introduce a pair of dual bases @xmath475 and @xmath476 , @xmath477 .",
    "now suppose that @xmath431 and @xmath478 occur in the word @xmath165 as subwords @xmath479 then we put @xmath480 the basic equation which corresponds to this pair of dual bases is @xmath481    for the ( unique ) triple of occurrences @xmath482 of @xmath483 , @xmath484 and @xmath485 in @xmath165 , we introduce a set of dual @xmath332-factor bases @xmath486 , where @xmath487 .",
    "put @xmath488    the @xmath332-factor equation that corresponds to this set of dual bases is @xmath489    let @xmath490 be an element of @xmath332 .",
    "in this case we introduce a constant base @xmath491 with the _ label _ @xmath333 .",
    "if @xmath431 occurs in @xmath165 as @xmath492 , then we put @xmath493 the corresponding coefficient equation is @xmath494 .    for every base @xmath246 so that @xmath495 ( or @xmath496 ) we set :    * @xmath389 ( or @xmath390 ) , if @xmath366 ; * @xmath392 ( or @xmath393 ) , if @xmath391 .",
    "the list of boundary connections ( and hence the boundary equations ) is empty .",
    "this defines the generalised equation @xmath458 .",
    "put @xmath497 then @xmath405 is a finite collection of generalised equations which can be effectively constructed for a given system @xmath404 .",
    "we shall need an analogue of the notion of a cancellation scheme for free groups .",
    "consider the free product of groups @xmath3 .",
    "take the multiplication table presentations of @xmath4 and @xmath6 : @xmath498 then the cayley graph @xmath499 of @xmath500 can be obtained as follows .",
    "take the cayley graph @xmath501 of @xmath4 .",
    "to each vertex @xmath77 of @xmath501 we attach the cayley graph @xmath502 of @xmath6 by identifying @xmath77 and the vertex of @xmath502 corresponding to the identity in @xmath6 . to each vertex @xmath503 of each copy of @xmath502 just attached , we attach @xmath501 by identifying @xmath78 and the vertex of @xmath501 corresponding to the identity in @xmath4 , and so on . summarising , the cayley graph @xmath499 is a tree - graded space with respect to the _ pieces _ : copies of @xmath501 and @xmath502 ( we refer the reader to @xcite for definition and basic properties of tree - graded spaces ) .",
    "let @xmath410 , @xmath504 be a solution of @xmath505 .",
    "we write @xmath416 in the form ( [ * ] ) and substitute @xmath139 in ( [ * ] ) graphically , denote this substitution by @xmath506",
    ". then @xmath507 represents the trivial element in @xmath0 , thus describes a cycle @xmath508 in @xmath499 based at the identity element of @xmath0 . since @xmath499 is a tree - graded space ,",
    "the intersection of the cycle @xmath508 with any piece of @xmath499 is either empty or a point or a non - trivial cycle .",
    "below we treat @xmath508 as a cycle labelled by @xmath509 , where the @xmath408 s are letters in @xmath510 . every term in @xmath511 labels an edge of either a @xmath512-cycle or a @xmath252-cycle . from the structure of a tree - graded space on @xmath499 and since the words @xmath511 are reduced , it follows that distinct edges of any cycle belong to different words @xmath511 .",
    "therefore , the structure of the cancellation in @xmath513 is described by one of the five cancellation schemes shown on figure [ fig : cancsc ] .",
    ".,width=576 ]    we denote the label ( a @xmath332-term ) of an edge of the triangle ( see figure [ fig : cancsc ] ) by the letter @xmath514 , @xmath515 .",
    "the parts of the word @xmath513 that `` cancel freely '' when reducing the word @xmath507 to the identity , are denoted by the letters @xmath516 , @xmath517 and their inverses , see figure [ fig : cancsc ] ( here we write @xmath518 to indicate that @xmath519 corresponds to the @xmath26-th equation of the system @xmath520 ) .",
    "formally , if two terms label a @xmath512-cycle we call them _ dual_. these two terms belong to two distinct words @xmath521 and @xmath522 , @xmath523 correspondingly . denote by @xmath524 the maximal non - trivial sequence of consecutive terms of @xmath521 such that    * every term of the sequence labels an edge of a @xmath512-cycle , * their duals are terms of @xmath525 ;    and by @xmath526 the sequence of their duals in @xmath527 . notice that the structure of a tree - graded space on @xmath499 and the fact that the words @xmath511 are reduced , imply that for every pair @xmath521 and @xmath522 there exists at most one maximal non - trivial sequence of consecutive terms of @xmath521 with duals in @xmath522 .",
    "it follows that we can write @xmath511 as a word in the @xmath528 s and the @xmath529 s and their inverses : @xmath530 straightforward verification shows that the set @xmath447 is a partition table of @xmath411 .",
    "obviously , @xmath531 is a solution of the generalised equation @xmath458 induced by @xmath139 .    for a generalised equation @xmath235 in variables",
    "@xmath69 we can consider the same system of equations over the group @xmath0 .",
    "we denote this system by @xmath532 . in other words ,",
    "if @xmath306 is a generalised equation , then by @xmath533 we denote the system of equations @xmath534 over the group @xmath0 .",
    "let @xmath535 where @xmath536 is a free group with basis @xmath69 .",
    "we call @xmath537 the _ coordinate group _ of the generalised equation @xmath235 .    note that every solution of a generalised equation gives rise to a homomorphism from @xmath537 to @xmath0 , but the converse is not true .",
    "indeed , the variables that occur in @xmath332-factor equations must take values in the group @xmath332 , @xmath334 and the items have to satisfy the type constraints - obviously , this is not true for an arbitrary homomorphism from @xmath537 to @xmath0 .",
    "now we explain the relations between the coordinate groups of the system @xmath404 and of the generalised equation @xmath538 .",
    "we use the notation from definition [ defn : partab ] . for a letter @xmath471 in @xmath130",
    ", we choose an arbitrary occurrence @xmath539 of @xmath471 in @xmath404 .",
    "let @xmath540 , @xmath477 be the base that corresponds to the pair of occurrences @xmath539 and @xmath541 of @xmath471 .",
    "then @xmath431 occurs in @xmath165 as a subword @xmath542 define the word @xmath543 $ ] , where @xmath544 , as follows : @xmath545 and put @xmath546 the tuple of words @xmath547 depends on the choice of occurrences of letters from @xmath130 in @xmath165 .",
    "it follows from the construction above that the map @xmath548 $ ] defined by @xmath549 gives rise to a @xmath0-homomorphism @xmath550 indeed , if @xmath551 then @xmath552 .",
    "it follows from the definition of partition table that @xmath553 in @xmath554 , thus @xmath555 .",
    "therefore @xmath556 and @xmath557 is a homomorphism .",
    "observe that the image @xmath558 in @xmath559 does not depend on a particular choice of the occurrence of @xmath471 in @xmath416 ( the basic equations of @xmath458 make these images equal ) .",
    "hence @xmath557 depends only on @xmath458 .",
    "thus , every solution @xmath2 of the generalised equation gives rise to a solution @xmath139 of @xmath11 so that @xmath560    [ rem : epi ] let @xmath561 be a partition table of the system of equations @xmath416 that satisfies the following condition @xmath562 then for the generalised equation @xmath458 , the homomorphism @xmath563 induced by the map @xmath564 defined above is surjective .",
    "we summarise the discussion above in the following lemma .",
    "[ le : r1 ] for a system of equations @xmath411 over the group @xmath0 , one can effectively construct a finite set @xmath565 of generalised equations such that    1 .",
    "if the set @xmath405 is empty , then @xmath566 has no solutions in @xmath0 ; 2 .   for each @xmath567 and for each @xmath470",
    "one can effectively find a word @xmath568 $ ] of length at most @xmath569 such that the map @xmath570 , @xmath470 gives rise to a @xmath0-homomorphism @xmath571 ; 3 .",
    "[ item : le14 - 3 ] for any solution @xmath572 of the system @xmath411 there exists @xmath567 and a solution @xmath2 of @xmath235 such that @xmath573 , where @xmath574 , and this equality is graphical , @xmath575 ;    [ co : r1 ] in the notation of lemma [ le : r1 ] , for any solution @xmath572 of the system @xmath411 there exist a generalised equation @xmath567 and a solution @xmath2 of @xmath576 such that the following diagram commutes : @xmath577_{\\pi_u } \\ar[rr]^{\\pi_\\omega }   &   & g_{r(\\omega^ * ) } \\ar[ld]^{\\pi_h }                                                                               \\\\                                 &   g & } \\ ] ]    conversely , for every generalised equation @xmath578 and a solution @xmath2 of @xmath235 , there exists a solution @xmath579 of the systems @xmath580 such that the above diagram commutes .",
    "in the previous section we reduced the study of the set of solutions of a system of equations over a free product of groups to the study of solutions of generalised equations . in order to describe the solutions of generalised equations , in this section we describe a branching rewriting process .",
    "the original version of this process for free monoids was introduced by g.  makanin in his important papers @xcite and @xcite , where he solves the compatibility problem of systems of equations over a free monoid ( over a free group ) . in his work",
    "@xcite , @xcite , a.  razborov gave a complete description of all solutions of a system of equations over a free group .",
    "the process was further developed in many different directions by o.  kharlampovich and a.  miasnikov , see @xcite , @xcite , @xcite .",
    "the process we describe is a rewriting system based on the `` divide and conquer '' algorithm design paradigm .    for a given generalised equation @xmath581 , this branching process results in a locally finite and possibly infinite oriented rooted at @xmath111 tree @xmath582 , @xmath583 .",
    "the vertices of the tree @xmath582 are labelled by generalised equations @xmath584 .",
    "the edges of the tree @xmath582 are labelled by epimorphisms of the corresponding coordinate groups .",
    "moreover , for every solution @xmath2 of @xmath581 , there exists a path in the tree @xmath582 from the root vertex to a vertex @xmath585 and a solution @xmath586 of @xmath587 such that the solution @xmath2 is a composition of the epimorphisms corresponding to the edges in the tree and the solution @xmath586 .",
    "conversely , every path from the root to a vertex @xmath585 in @xmath582 and any solution @xmath586 of @xmath587 give rise to a solution of @xmath581 , see proposition [ prop : to ] .",
    "the tree is constructed by induction on the height .",
    "let @xmath95 be a vertex of height @xmath34 .",
    "one can check under the assumptions of which of the 15 cases described in section [ se:5.2 ] the generalised equation @xmath588 falls .",
    "if @xmath588 falls under the assumptions of case 1 or case 2 , then @xmath95 is a leaf of the tree @xmath582 .",
    "otherwise , using the combination of elementary and derived transformations ( defined in sections [ se:5.1 ] and [ se:5.2half ] ) given in the description of the corresponding ( to @xmath95 ) case , one constructs finitely many generalised equations and epimorphisms from the coordinate group of @xmath588 to the coordinate groups of the generalised equations constructed .",
    "we finish this section ( see lemma [ 3.2 ] ) by proving that infinite branches of the tree @xmath582 , as in the case of free groups , correspond to one of the following three cases :    1 .",
    "case 7 - 10 : linear case ( levitt type , thin type ) ; 2 .",
    "case 12 : quadratic case ( surface type , interval exchange type ) ; 3 .",
    "case 15 : general case ( toral type , axial type ) .",
    "[ de : gepar ] let @xmath235 be a generalised equation . if the set @xmath589 of all closed sections of @xmath235 is partitioned into a disjoint union of subsets @xmath590 sections from @xmath591 , @xmath592 , @xmath593 and @xmath594 are called correspondingly , _ variable _ , @xmath4- , @xmath6- , and _",
    "free _ sections .",
    "we sometimes refer to @xmath4- and @xmath6-sections as to _ constant _ sections .",
    "set @xmath595 .",
    "to organise the process properly , we partition the closed sections of @xmath235 in another way into a disjoint union of two disjoint sets , which we refer to as _ parts _ : @xmath596 sections from @xmath597 are called , and sections from @xmath598 are called .",
    "we set @xmath599",
    "if not stated otherwise , we assume that all sections from @xmath591 belong to the active part @xmath597 .",
    "if @xmath600 , then every item ( or base ) from @xmath601 is called active , non - active , @xmath4- , @xmath6- , constant , free item ( base ) , depending on the type of @xmath601 . note the abuse of terminology : free item has already been defined as an item that does not belong to any base .",
    "we say that a generalised equation @xmath235 is in the _ standard form _ if the following conditions hold .    1 .",
    "all non - active sections from @xmath602 are located to the right of all active sections , all @xmath4-sections are located to the right of all non - active sections from @xmath602 , all @xmath6-sections are located to the right of all @xmath4-sections and all free sections are located to the right of all @xmath6-sections .",
    "formally , there are numbers @xmath603 such that @xmath604 $ ] , @xmath605 $ ] , @xmath606 $ ] , @xmath607 $ ] and @xmath608 $ ] are , correspondingly , unions of all active , all variable non - active , all @xmath4- , all @xmath6- , and all free sections . 2 .",
    "all @xmath19-constant bases and @xmath19-factor bases belong to @xmath609 , @xmath381 , and for every letter @xmath297 there is at most one constant base in @xmath235 labelled by @xmath333 , if there exists a base labelled by @xmath610 , then there are no bases labelled by @xmath611 .",
    "every free variable @xmath289 of @xmath235 belongs to a section from @xmath594 .",
    "we will show in lemma [ lem : stform ] that every generalised equation can be taken to the standard form .      in this section",
    "we describe of generalised equations .",
    "recall that we consider only formally consistent generalised equations . in general , an elementary transformation @xmath612 associates to a generalised equation",
    "@xmath235 a finite set of generalised equations @xmath613 and a collection of surjective homomorphisms @xmath614 such that for every pair @xmath615 there exists a unique pair @xmath616 such that the following diagram commutes . @xmath617_{\\pi_h } \\ar[rr]^{\\theta_i }   &   & g_{r(\\omega_i^\\ast ) } \\ar[ld]^{\\pi_{h^{(i ) } } }                                                                               \\\\                                 &   g & } \\ ] ] since the pair @xmath618 is defined uniquely , we have a well - defined map @xmath619 .",
    "it is a good exercise to understand what how the elementary transformations change the system of equations corresponding to the generalised equation .",
    "suppose that @xmath235 contains a boundary connection @xmath621 .",
    "the transformation @xmath620 carries @xmath235 into a single generalised equation @xmath622 which is obtained from @xmath235 as follows .",
    "to obtain @xmath622 from @xmath235 we    * replace ( cut in @xmath623 ) the base @xmath342 by two new bases @xmath624 and @xmath625 , and * replace ( cut in @xmath626 ) @xmath627 by two new bases @xmath628 and @xmath629 ,    so that the following conditions hold .    if @xmath630 , then @xmath631 if @xmath632 , then @xmath633    put @xmath634    let @xmath635 be a boundary connection in @xmath235 . if @xmath636 , then we replace @xmath635 by @xmath637 .",
    "if @xmath638 , then we replace @xmath635 by @xmath639 .",
    "notice that from property ( [ it : forcon2 ] ) of definition [ defn : formcons ] , it follows that @xmath637 ( or @xmath639 ) is a boundary connection in the new generalised equation .",
    "the resulting generalised equation @xmath622 is formally consistent .",
    "put @xmath640 , see figure [ fig : et1 ] .",
    ": cutting a base.,width=576 ]      let a base @xmath342 of a generalised equation @xmath235 be contained in the base @xmath246 , i.e. @xmath642 .",
    "suppose that the boundaries @xmath643 and @xmath644 are @xmath246-tied , i.e. there are boundary connections of the form @xmath645 and @xmath646 .",
    "suppose also that every @xmath342-tied boundary is @xmath246-tied .",
    "the transformation @xmath641 carries @xmath235 into a single generalised equation @xmath622 which is obtained from @xmath235 as follows .",
    "we transfer @xmath342 from the base @xmath246 to the base @xmath647 and adjust all the basic and boundary equations ( see figure [ fig : et2 ] ) .",
    "formally , we replace @xmath342 by a new base @xmath648 such that @xmath649 and replace each @xmath342-boundary connection @xmath298 with a new one @xmath650 where @xmath623 and @xmath651 are related by a @xmath246-boundary connection @xmath652 .",
    "set @xmath653 .    : transferring a base.,width=576 ]      let @xmath246 and @xmath247 be a pair of matched bases in @xmath235 .",
    "since @xmath235 is formally consistent , one has @xmath655 , @xmath656 and every @xmath246-boundary connection is of the form @xmath657 .",
    "the transformation @xmath654 applied to @xmath235 results in a single generalised equation @xmath622 which is obtained from @xmath235 by removing the pair of bases @xmath339 with all the @xmath246-boundary connections , see figure [ fig : et3 ] .    : removing a pair of matched bases.,width=576 ]    [ rem : et123 ] observe that for @xmath658 , the set @xmath659 consists of a single generalised equation @xmath622 , such that @xmath235 and @xmath622 have the same set of variables @xmath69 .",
    "the identity map @xmath361 \\rightarrow g[h]$ ] induces a @xmath0-isomorphism @xmath660 .",
    "moreover , @xmath2 is a solution of @xmath235 if and only if @xmath2 is a solution of @xmath622 .",
    "suppose that in @xmath235 a variable base @xmath246 does not intersect any other base , i.e. the items @xmath662 are contained only in one variable base @xmath246 .",
    "moreover , suppose that all boundaries that intersect @xmath246 are @xmath246-tied , i.e. for every @xmath26 , @xmath663 there exists a boundary @xmath664 such that @xmath665 is a boundary connection in @xmath235 .",
    "since @xmath235 is formally consistent , we have @xmath666 and @xmath667 if @xmath668 , and @xmath669 and @xmath670 if @xmath671 .",
    "the transformation @xmath661 carries @xmath314 into a single generalised equation @xmath622 which is obtained from @xmath235 by deleting the pair of bases @xmath246 and @xmath247 ; deleting all the boundaries @xmath672 , deleting all @xmath246-boundary connections , re - enumerating the remaining boundaries and adjusting the initial and terminal terms as appropriate , see remark [ rem : boundterm ] ( see figure [ fig : et4 ] ) .    : removing a linear base.,width=576 ]    we define the homomorphism @xmath673 , where @xmath674 is the set of variables of @xmath622 , as follows : @xmath675 it is not hard to see that @xmath676 is a @xmath0-isomorphism .",
    "[ rem : boundterm ] every time when we transport or delete a closed section @xmath347 $ ] ( see @xmath661 , @xmath677 , @xmath678 , @xmath679 ) , we re - enumerate the boundaries and adjust the initial and terminal terms of the boundary @xmath26 as follows .",
    "the re - enumeration of the boundaries is defined by the correspondence @xmath680 , @xmath681 : @xmath682 define @xmath683 and @xmath684      suppose that a boundary @xmath623 intersects a base @xmath246 and @xmath623 is not @xmath246-tied .",
    "the transformation @xmath685 @xmath246-ties the boundary @xmath623 in all possible ways , producing finitely many different generalised equations . to this end ,",
    "let @xmath626 be a boundary intersecting @xmath647 .",
    "then we perform one of the following two transformations ( see figure [ fig : et5 ] ) :    : introducing a new boundary.,width=576 ]    1 .",
    "introduce the boundary connection @xmath378 , provided that the resulting equation @xmath686 is formally consistent .",
    "+ the identity map from @xmath361 $ ] to @xmath361 $ ] induces a @xmath0-epimorphism @xmath687 from @xmath537 to @xmath688 .",
    "+ observe that @xmath687 is not necessarily an isomorphism .",
    "more precisely , @xmath687 is not an isomorphism whenever the boundary equation corresponding to the boundary connection @xmath378 does not belong to @xmath689 . in this case",
    "@xmath687 is a proper epimorphism .",
    "2 .   introduce a new boundary @xmath690 between @xmath626 and @xmath691 ; introduce a new boundary connection @xmath692 in @xmath235 ( and introduce the initial and terminal terms of @xmath690 to satisfy the conditions of the definition of a boundary connection ) .",
    "denote the resulting generalised equation by @xmath693 .",
    "the corresponding @xmath0-homomorphism @xmath694 is induced by the map ( below we assume that the boundaries of @xmath693 are labelled @xmath695 ) : @xmath696 observe that @xmath697 is a @xmath0-isomorphism .",
    "[ le : hom - check ] suppose that the universal horn theory ( the theory of quasi - identities ) of @xmath0 is decidable .",
    "let @xmath698 be a generalised equation obtained from @xmath235 by an elementary transformation @xmath612 and let @xmath699 be the corresponding epimorphism .",
    "there exists an algorithm which determines whether or not the epimorphism @xmath676 is a proper epimorphism .",
    "the only non - trivial case is when @xmath700 and no new boundaries were introduced . in this case",
    "@xmath622 is obtained from @xmath235 by adding a new boundary equation @xmath701 , which is effectively determined by @xmath235 and @xmath622 . in this event ,",
    "the coordinate group @xmath702 is a quotient of the group @xmath537 .",
    "the homomorphism @xmath676 is an isomorphism if and only if @xmath703 , or , equivalently , @xmath704 .",
    "the latter condition holds if and only if @xmath705 vanishes on all solutions of the system of equations @xmath706 in @xmath0 , i.e. if the following universal formula ( quasi identity ) holds in @xmath0 : @xmath707    note that in @xcite v.  diekert and m.  lohrey prove that if the universal theories of the factors @xmath4 and @xmath6 are decidable , so is the universal theory of @xmath0 .      in this section",
    "we describe several useful transformations of generalised equations .",
    "some of them are finite sequences of elementary transformations , others result in equivalent generalised equations but can not be presented as a composition of finitely many elementary transformations .    in general , a _",
    "derived transformation _ @xmath708 associates to a generalised equation @xmath235 a finite set of generalised equations @xmath709 , and a collection of surjective homomorphisms @xmath710 such that for every pair @xmath323 there exists a unique pair @xmath616 such that the following diagram commutes . @xmath711_{\\pi_h } \\ar[rr]^{\\theta_i }   &   & g_{r(\\omega_i^ * ) } \\ar[ld]^{\\pi_{h^{(i ) } } }                                                                               \\\\                                 &   g & } \\ ] ] since the pair @xmath618 is defined uniquely , we have a well - defined map @xmath712 .",
    "let @xmath363 $ ] be a section of @xmath314 .",
    "the transformation @xmath714 makes the section @xmath601 closed . to perform @xmath714 , using @xmath685 , we @xmath246-tie the boundary @xmath26 ( the boundary @xmath64 ) in every base @xmath246 containing @xmath26 ( @xmath64 , respectively ) .",
    "using @xmath620 , we cut all the bases containing @xmath26 ( or @xmath64 ) in the boundary @xmath26 ( or in @xmath64 ) , see figure [ fig : d1 ] .    : closing a section.,width=576 ]      let @xmath601 be a closed section of a generalised equation @xmath235 .",
    "the derived transformation @xmath677 takes @xmath235 to a single generalised equation @xmath622 obtained from @xmath235 by cutting @xmath601 out from the interval @xmath716 $ ] together with all the bases , and boundary connections on @xmath601 and moving @xmath601 to the end of the interval or between two consecutive closed sections of @xmath235 , see figure [ fig : d2 ] .",
    "then we re - enumerate all the items and boundaries of the obtained generalised equation and adjust the initial and terminal terms of the boundaries as appropriate , see remark [ rem : boundterm ]",
    ". clearly , the original equation @xmath235 and the new one @xmath622 have the same solution sets and their coordinate groups are isomorphic ( the isomorphism is induced by a permutation of the variables @xmath69 ) .    : transporting a closed section.,width=576 ]      let @xmath314 be a generalised equation . the derived transformation @xmath718 carries @xmath235 into a single generalised equation @xmath719 by applying @xmath620 to all boundary connections in @xmath235 .",
    "formally , for every boundary connection @xmath327 in @xmath235 we cut the base @xmath246 in @xmath623 applying @xmath620 . clearly , the generalised equation @xmath720 does not depend on the choice of a sequence of transformations @xmath620 .",
    "since , by remark [ rem : et123 ] , @xmath620 induces the identity isomorphism between the coordinate groups , equations @xmath235 and @xmath720 have isomorphic coordinate groups and the isomorphism is induced by the identity map @xmath361 \\to g[h]$ ] .      the derived transformation @xmath722 applied to a generalised equation @xmath235 results in a single generalised equation @xmath723 constructed below .",
    "applying @xmath718 , if necessary , one can assume that a generalised equation @xmath235 does not contain boundary connections .",
    "an active variable base @xmath724 is called _ eliminable _ if at least one of the following holds :    1 .",
    "@xmath246 contains an item @xmath289 with @xmath725 ; 2 .",
    "at least one of the boundaries @xmath726 is different from @xmath727 and it does not touch any other base ( except @xmath246 ) .    an _ elimination process _ for @xmath235 consists of consecutive removals ( _ eliminations _ ) of eliminable bases until there are no eliminable bases left in the generalised equation .",
    "the resulting generalised equation is called the _ kernel _ of @xmath235 and we denote it by @xmath728 .",
    "it is easy to see that @xmath728 does not depend on the choice of the elimination process . indeed ,",
    "if @xmath235 has two different eliminable bases @xmath729 , @xmath730 , and elimination of @xmath731 results in a generalised equation @xmath732 then by induction on the number of eliminations @xmath733 is defined uniquely for @xmath734 . obviously , @xmath729 is still eliminable in @xmath735 , as well as @xmath730 is eliminable in @xmath622 . now eliminating @xmath729 and @xmath730 from @xmath735 and @xmath622 respectively , we get the same generalised equation @xmath736 . by induction @xmath737 , hence the result .",
    "we say that a variable @xmath289 , if @xmath289 either belongs to at least one base in the kernel , or is constant .",
    "we now establish a relation between the coordinate group of the generalised equation @xmath235 and the coordinate group of its kernel @xmath728 .    for a generalised equation @xmath235 we denote by @xmath738 the generalised equation which is obtained from @xmath235 by deleting all free variables in @xmath235 .",
    "obviously , @xmath739 where @xmath740 is the set of free variables in @xmath235 .",
    "let us consider what happens in the elimination process on the level of coordinate groups .",
    "we start with the case when just one base is eliminated .",
    "let @xmath246 be an eliminable base in @xmath741 .",
    "denote by @xmath622 the generalised equation obtained from @xmath235 by eliminating @xmath246 .    1 .",
    "[ item:7 - 10c1 ] suppose @xmath742 and @xmath743 , i.e. @xmath246 falls under the assumption ( a ) of the definition of an eliminable base .",
    "then the variable @xmath289 occurs only once in @xmath235 ( in the equation @xmath744 corresponding to the base @xmath246 , denote this equation by @xmath745 ) .",
    "therefore , in the coordinate group @xmath746 the relation @xmath745 can be written as @xmath747 , where @xmath748 does not contain @xmath289 .",
    "consider the generalised equation @xmath749 obtained from @xmath235 by deleting the equation @xmath745 and the item @xmath289 .",
    "the presentation of the coordinate group of @xmath749 is obtained from the presentation of the coordinate group of @xmath235 using a sequence of tietze transformations , thus these groups are isomorphic .",
    "+ it follows immediately that @xmath750 we therefore get that @xmath751 where @xmath752 is the free group generated by the free variables of @xmath622 .",
    "note that all the groups and equations which occur above can be found effectively .",
    "[ item:7 - 10c2 ] suppose now that @xmath246 falls under the assumptions of case b ) of the definition of an eliminable base , with respect to a boundary @xmath26",
    ". then in all the equations of the generalised equation @xmath235 but @xmath745 , the variable @xmath753 occurs as a part of the subword @xmath754 . in the equation @xmath745 the variable @xmath753",
    "either occurs once or it occurs precisely twice and in this event the second occurrence of @xmath753 ( in @xmath247 ) is a part of the subword @xmath754 .",
    "it is obvious that the tuple @xmath755 forms a basis of the ambient free group generated by @xmath756 .",
    "we further assume that @xmath235 is a system of equations in these variables .",
    "notice , that in the new basis , the variable @xmath753 occurs only once in the generalised equation @xmath235 , in the equation @xmath745 .",
    "hence , as in case ( [ item:7 - 10c1 ] ) , the relation @xmath745 can be written as @xmath757 , where @xmath748 does not contain @xmath753 .",
    "+ therefore , if we eliminate the relation @xmath745 , then the set @xmath758 is a generating set of @xmath537 .",
    "this shows that @xmath759 where @xmath760 is the generalised equation obtained from @xmath622 by deleting the boundary @xmath26 , and @xmath761 , @xmath762 are defined as in section [ sec : relsol2ge ] .",
    "denote by @xmath763 an equation obtained from @xmath760 by adding a free variable @xmath465 to the free part @xmath594 of @xmath760 .",
    "it now follows that @xmath764 and @xmath765 where @xmath752 is the free group generated by the free items of @xmath766 distinct from @xmath465 .",
    "notice that all the groups and equations which occur above can be found effectively .",
    "by induction on the number of steps in the elimination process we obtain the following lemma .",
    "[ 7 - 10 ] in the above notation , @xmath767 where @xmath752 is the free group generated by a set of free items from @xmath768 .",
    "moreover , all the groups and equations which occur above can be found effectively .",
    "let @xmath769 where @xmath770 is obtained from @xmath771 by eliminating an eliminable base , @xmath772 .",
    "it is easy to see ( by induction on @xmath115 ) that for every @xmath772 @xmath773 moreover , if @xmath770 is obtained from @xmath771 as in case ( [ item:7 - 10c2 ] ) above , then ( in the above notation ) @xmath774 the statement of the lemma now follows from the remarks above and equations ( [ eq : ker1 ] ) and ( [ eq : ker2 ] ) . note that the cardinality of the set @xmath413 is the number of free variables of @xmath728 minus @xmath115 .      in order to define the derived transformation",
    "@xmath678 we need to introduce several notions .",
    "a base @xmath246 of the generalised equation @xmath235 is called a base if @xmath776 .",
    "a leading base is called a if for any other leading base @xmath342 we have @xmath777 .",
    "let @xmath778 be a carrier base of @xmath235 .",
    "any active base @xmath779 with @xmath780 is called a base ( with respect to @xmath246 ) .",
    "suppose now that @xmath235 is a generalised equation with @xmath781 for each @xmath289 in the active part of @xmath235 .",
    "the _ entire transformation _ is the following sequence of elementary transformations .",
    "we fix a carrier base @xmath246 of @xmath235 . for any transfer base @xmath342 we @xmath246-tie ( applying @xmath685 ) all boundaries that intersect @xmath342 . using @xmath641",
    "we transfer all transfer bases from @xmath246 onto @xmath647 .",
    "now , there exists some @xmath782 such that @xmath783 belong to only one base @xmath784 while @xmath785 belongs to at least two bases . applying @xmath620 we cut @xmath246 in the boundary @xmath786 .",
    "finally , applying @xmath661 , we delete the section @xmath787 $ ] , see figure [ quadratic ] .",
    "let @xmath788 be the boundary between the active and non - active parts of @xmath235 , i.e. @xmath789 $ ] is the active part @xmath597 of @xmath235 and @xmath790 $ ] is the non - active part @xmath598 of @xmath235 .",
    "as we will see later , roughly speaking , the process has two main sub - processes : first it eliminates redundant equations ( cleaning ) , and then applies the entire transformation , which is the motor of the process .",
    "we now introduce the excess of a solution of the generalised equation and prove that it is invariant under the entire transformation .",
    "this fact will be used later , in section [ 5.5.3 ] .",
    "[ defn : excess ] for a pair @xmath615 , we introduce the following notation @xmath791 @xmath792 where @xmath793 is the set of all variable bases @xmath344 for which either @xmath344 or @xmath794 belongs to the active part @xmath789 $ ] of @xmath235 .",
    "we call the number @xmath795 the _ excess _ of the solution @xmath2 of the generalised equation @xmath235 .",
    "since , by assumption , every item @xmath289 of the section @xmath789 $ ] belongs to at least two bases and each of these bases belongs to @xmath597 , hence @xmath796 .",
    "notice , that if for every item @xmath289 of the section @xmath789 $ ] one has @xmath797 , for every solution @xmath2 of @xmath235 the excess @xmath798 .",
    "informally , in some sense , the excess of @xmath2 measures how far the generalised equation @xmath235 is from being quadratic ( every item in the active part is covered twice ) .",
    "[ lem : excess ] let @xmath235 be a generalised equation such that every item @xmath289 from the active part @xmath799 $ ] of @xmath235 is covered at least twice .",
    "suppose that @xmath800 and the carrier base @xmath246 of @xmath235 and its dual @xmath247 belong to the active part of @xmath235 .",
    "then the excess of the solution @xmath2 equals the excess of the solution @xmath801 , i.e. @xmath802 .    by the definition of the entire transformation @xmath678 , it follows that the word @xmath803 $ ] is a terminal subword of the word @xmath804 $ ] , i.e. @xmath805\\doteq u_ih^{(i)}[1,\\rho_{\\omega_i}+1 ] , \\hbox { where } \\rho=\\rho_\\omega.\\ ] ] on the other hand , since @xmath806 , the non - active parts of @xmath235 and @xmath732 coincide . therefore ,",
    "@xmath807 $ ] is the terminal subword of the word @xmath808 $ ] , i.e. the following graphical equality holds : @xmath809\\doteq v_i h[\\rho_a,\\rho + 1].\\ ] ] so we have @xmath810|-|v_{i}|=|u_{i}|= |h({\\mu})|-|h^{(i)}({\\mu})|,\\ ] ] where , in the above notation , if @xmath811 ( and thus @xmath246 has been completely eliminated in @xmath812 ) , then @xmath813 ; otherwise , @xmath814 $ ] .",
    "from ( [ 3.13 ] ) and ( [ 3.22 ] ) it follows that @xmath815 .",
    "let @xmath342 and @xmath246 be two @xmath19-constant bases in @xmath235 with labels @xmath817 and @xmath818 , where @xmath297 and @xmath819 .",
    "suppose that the sections @xmath820 $ ] and @xmath821 $ ] are closed .",
    "the transformation @xmath679 applied to @xmath235 results in a single generalised equation @xmath622 which is obtained from @xmath235 in the following way , see figure [ constants ] .",
    "introduce a new variable base @xmath385 with its dual @xmath822 such that @xmath823 , \\",
    "\\sigma(\\delta(\\eta ) ) = [ j , j+1],\\   \\varepsilon(\\eta ) = \\epsilon_\\lambda , \\",
    "\\varepsilon(\\delta(\\eta ) ) = \\epsilon_\\mu.\\ ] ] then we transfer all bases from @xmath385 onto @xmath822 using @xmath641 , remove the bases @xmath385 and @xmath822 , remove the item @xmath289 , re - enumerate the remaining items and adjust the initial and terminal terms of the boundaries as appropriate , see remark [ rem : boundterm ] .",
    "the corresponding homomorphism @xmath824 is induced by the composition of the homomorphisms defined by the respective elementary transformations .",
    "obviously , @xmath676 is an isomorphism .",
    "we now exhibit the behaviour of the length of a solution of a generalised equation under elementary and derived transformations .",
    "[ lem : solleng ] let @xmath732 be a generalised equation and @xmath801 be a solution of @xmath732 so that @xmath825 then one has @xmath826 . furthermore , in the case that @xmath827 or @xmath828 this inequality is strict @xmath829 .",
    "proof is by straightforward examination of descriptions of elementary and derived transformations .",
    "[ lem : stform ] using derived transformations , every generalised equation can be taken to the standard form .",
    "let @xmath622 be obtained from @xmath235 by an elementary or a derived transformation and let @xmath235 be in the standard form .",
    "then @xmath622 is in the standard form .",
    "proof is straightforward .      in this section",
    "we describe a branching process for rewriting a generalised equation @xmath235 .",
    "this process results in a locally finite and possibly infinite tree @xmath830 . in the end of the section we describe infinite paths in @xmath830 .",
    "we summarise the results of this section in the proposition below .",
    "[ prop : to ] for a generalised equation @xmath831 , one can effectively construct a locally finite , possibly infinite , oriented rooted at @xmath111 tree @xmath582 , @xmath583 , such that :    1 .",
    "the vertices @xmath832 of @xmath582 are labelled by generalised equations @xmath584 .",
    "the edges @xmath833 of @xmath582 are labelled by epimorphisms @xmath834 the edges @xmath835 , where @xmath836 is a leaf of @xmath582 and @xmath837 , are labelled by proper epimorphisms .",
    "all the other epimorphisms @xmath838 are isomorphisms , in particular , edges that belong to infinite branches of the tree @xmath582 are labelled by isomorphisms .",
    "3 .   given a solution @xmath2 of @xmath581",
    ", there exists a finite path @xmath839 and a solution @xmath586 of @xmath587 such that @xmath840 conversely , for every finite path @xmath839 in @xmath582 and every solution @xmath586 of @xmath587 the homomorphism @xmath841 gives rise to a solution of @xmath581 .",
    "we begin with a general description of the tree @xmath830 and then construct it using induction on its height . for each vertex @xmath95 in @xmath830 there exists a generalised equation @xmath588 associated to @xmath95 .",
    "recall , that we consider only formally consistent generalised equations . the initial generalised equation @xmath235 is associated to the root @xmath111 , @xmath842 . for each edge",
    "@xmath843 there exists a unique surjective homomorphism @xmath844 associated to @xmath843 .",
    "if @xmath845 is a path in @xmath846 , then by @xmath847 we denote the composition of corresponding homomorphisms @xmath848 we call this epimorphism the _ canonical homomorphism from @xmath849 to @xmath850 _",
    "there are two kinds of edges in @xmath830 : _ principal _ and _ auxiliary_. every constructed edge is principal , if not stated otherwise .",
    "let @xmath851 be an edge of @xmath830 , we assume that active ( non - active ) sections in @xmath852 are naturally inherited from @xmath588 . if @xmath851 is a principal edge , then there exists a finite sequence of elementary and derived transformations from @xmath588 to @xmath852 and the homomorphism @xmath853 is a composition of the homomorphisms corresponding to these transformations .",
    "since both elementary and derived transformations uniquely associate a pair @xmath618 to @xmath615 : @xmath854 a solution @xmath2 of @xmath235 defines a path in the tree @xmath830 .",
    "we call such a path _ the path defined by a solution @xmath2 in @xmath582_.    let @xmath314 be a generalised equation .",
    "we construct an oriented rooted tree @xmath830 .",
    "we start from the root @xmath111 and proceed by induction on the height of the tree .",
    "suppose , by induction , that the tree @xmath830 is constructed up to height @xmath34 , and let @xmath95 be a vertex of height @xmath34 .",
    "we now describe how to extend the tree from @xmath95 .",
    "the construction of the outgoing edges from @xmath95 depends on which of the case described below takes place at the vertex @xmath95 .",
    "we always assume that :    _ if the generalised equation @xmath588 satisfies the assumptions of case @xmath26 , then @xmath588 does not satisfy the assumptions of all the cases @xmath64 , with @xmath855 .",
    "_    the general guideline of the process is to use the entire transformation to transfer bases to the right of the interval . before applying the entire transformation one has to make sure that the generalised equation is `` clean '' .",
    "the stratification of the process into 15 cases , though seemingly unnecessary , is convenient in the proofs since each of the cases has a different behaviour with respect to `` complexity '' of the generalised equation , see lemma [ 3.1 ] . furthermore , it allows one to narrow the particular type of the generalised equations that can occur in each of the infinite branches of the process , see lemma [ 3.2 ] .",
    "in @xmath581 we transport closed sections using @xmath677 in such a way that all active sections are at the left end of the interval ( the active part of the generalised equation ) , then come all variable non - active sections , behind them come @xmath4-sections , followed by @xmath6-sections , and then the free sections .",
    "the vertex @xmath95 , in this case , is a leaf of the tree @xmath830 .",
    "there are no outgoing edges from @xmath95 .",
    "then the vertex @xmath95 is a leaf of the tree @xmath830 .",
    "there are no outgoing edges from @xmath95 .        in this case",
    ", we make the section @xmath860 closed using the derived transformation @xmath714 .      in this case",
    ", we transport the section @xmath860 to @xmath609 using the derived transformation @xmath677 .",
    "then ( only in the case when @xmath342 is a constant base labelled by @xmath610 ) we identify all closed sections of the type @xmath861 $ ] , which contain a constant base with the label @xmath862 , with the transported section @xmath860 , using the derived transformation @xmath679 . in the resulting generalised equation @xmath852",
    "the section @xmath860 becomes a @xmath19-section , and the corresponding edge @xmath863 is auxiliary , see figure [ constants ] ( note that @xmath714 produces a finite set of generalised equations , figure [ constants ] shows only one of them ) .",
    "using @xmath677 , we transport the section @xmath865 $ ] to the very end of the interval behind all the items of @xmath588 . in the resulting generalised equation @xmath852 the transported section becomes a free section , and the corresponding edge @xmath863 is auxiliary .      in this case , we perform @xmath654 and delete it , see figure [ useless ] .",
    "[ rem : stform ] if @xmath95 does not satisfy the conditions of any of the cases 1 - 6 , then the generalised equation @xmath588 is in the standard form .        then , we remove the closed section @xmath861 $ ] together with the linear base using @xmath661 .      in this case , we first perform @xmath685 and @xmath246-tie @xmath867 by the only base @xmath246 it intersects ; then using @xmath620 we cut @xmath246 in @xmath867 ; and then we delete the closed section @xmath861 $ ] using @xmath661 , see figure [ linear ] .          in this case , using @xmath685 we @xmath868-tie all the boundaries that intersect @xmath729 ; using @xmath641 , we transfer @xmath869 onto @xmath877 ; and remove @xmath868 together with the closed section @xmath601 using @xmath661 , see figure [ linear  ] .      in this event we close the section @xmath861 $ ] using @xmath714 and remove it using @xmath661 , see figure [ linear  ] .            since the assumptions of case 5 are not satisfied , the boundary @xmath26 intersects at least one base , say , @xmath246 .    in this case , we @xmath246-tie @xmath26 using @xmath685 .",
    "we apply the entire transformation @xmath678 , see figure [ quadratic ] .            in this case , using @xmath677 , we transport the section @xmath348 to the beginning of the interval ( this makes @xmath246 a carrier base ) .",
    "we then apply the entire transformation @xmath678 ( note that in this case the whole section @xmath348 is removed ) .        in this case , using @xmath685 , we @xmath246-tie @xmath64 .",
    "we first apply the entire transformation @xmath678 .",
    "then , using @xmath685 , we @xmath246-tie every boundary @xmath64 in the active part that intersects a base @xmath246 and touches at least one base .",
    "this results in finitely many new vertices connected to @xmath95 by principal edges .",
    "if , in addition , @xmath588 satisfies the assumptions of case 15.1 below , then besides the already constructed principal edges , we construct a few more auxiliary edges outgoing from the vertex @xmath95 .",
    "we first construct an auxiliary generalised equation @xmath883 ( which does _ not _ appear in the tree @xmath830 ) as follows .",
    "firstly , we add a new constant section @xmath884 $ ] to the right of all the sections in @xmath588 ( in particular , @xmath885 is a new free variable ) .",
    "secondly , we introduce a new pair of dual variable bases @xmath886 so that @xmath887 notice that @xmath859 can be obtained from @xmath888 if we apply @xmath661 to @xmath888 and delete the base @xmath627 together with the closed section @xmath889 $ ] .",
    "let @xmath890 be the isomorphism induced by @xmath661 .",
    "the assumptions of case 15 still hold for @xmath891 .",
    "note that the carrier base of @xmath891 is the base @xmath342 . applying the transformations described in case 15 to @xmath892 ( first @xmath678 and then @xmath685 )",
    ", we obtain a set of new generalised equations @xmath893 and the set of corresponding epimorphisms of the form : @xmath894    now for each generalised equation @xmath895 we add a vertex @xmath896 and an auxiliary edge @xmath897 in the tree @xmath830 . the edge @xmath897 is labelled by the homomorphism @xmath898 which is the composition of homomorphisms @xmath899 and @xmath900 , @xmath901 .",
    "we associate the generalised equation @xmath895 to the vertex @xmath896",
    ".    the tree @xmath830 is therefore constructed .",
    "observe that , in general , @xmath830 is an infinite locally finite tree .",
    "if the generalised equation @xmath588 satisfies the assumptions of case @xmath902 , then we say that the vertex @xmath95 has _ type _",
    "@xmath26 and write @xmath903 .",
    "if the universal horn theory of @xmath0 is decidable , then for any vertex @xmath95 of the tree @xmath830 there exists an algorithm to decide whether or not @xmath95 is of type @xmath229 , @xmath904 .",
    "the statement of the lemma is obvious for all cases , except for case 1 .    to decide",
    "whether or not the vertex @xmath95 is of type 1 it suffices to show that there exists an algorithm to check whether or not the canonical epimorphism @xmath905 associated with an edge @xmath906 in @xmath830 is a proper epimorphism .",
    "this can be done effectively by lemma [ le : hom - check ] .",
    "we now introduce certain characteristics of generalised equations and establish how these characteristics change depending on which of the above 15 cases holds for a given generalised equations .",
    "denote by @xmath907 the number of bases in the active sections of @xmath235 and by @xmath908 the number of open boundaries in the active sections .    for a closed section @xmath909 denote by @xmath910 the number of bases in @xmath601 .",
    "the of a generalised equation @xmath235 is defined as follows @xmath911    we use the following convention .",
    "let @xmath235 be a generalised equation . by a function of a generalised equation @xmath912 we mean a function of the parameters @xmath913 , @xmath914 , @xmath915 and @xmath916 .",
    "[ 3.1 ] let @xmath917 be a principal edge of the tree @xmath830 . then the following statements hold .    1 .",
    "if @xmath918 , then @xmath919 , moreover if @xmath920 , then this inequality is strict ; 2 .   if @xmath921 , then @xmath922 ; 3 .   if @xmath923 and @xmath924 , then @xmath925 ; 4 .   if @xmath926 , then @xmath927 .    straightforward verification .",
    "the following lemma gives a description of the infinite branches in the tree @xmath830 .",
    "it is , basically , a consequence of lemma [ 3.1 ] ; we refer to @xcite for a proof .",
    "[ 3.2 ] let @xmath928 be an infinite path in the tree @xmath846 .",
    "then there exists a natural number @xmath929 such that all the edges @xmath930 of this path with @xmath931 are principal edges , and one of the following conditions holds : @xmath932    [ rem : leng < ] let @xmath933 be the path defined by the solution @xmath934 . if @xmath935 , then by lemma [ lem : solleng ] , @xmath936 .",
    "informally , the aim of this section is to prove the following strong version of the so - called bulitko s lemma , @xcite :    above , by a solution of a proper equation we mean a homomorphism from a proper quotient of the coordinate group of @xmath235 to @xmath0 .",
    "this approach for free groups was introduced by a.  razborov . in @xcite",
    ", he defines a combinatorial object , called a periodic structure on a generalised equation @xmath235 and constructs a finite set of generators for the group @xmath937 .",
    "we fix till the end of this section a generalised equation @xmath235 in the standard form .",
    "suppose that some boundary @xmath229 ( between @xmath938 and @xmath354 ) in the active part of @xmath235 does not touch bases .",
    "since the generalised equation @xmath235 is in the standard form , the boundary @xmath229 intersects at least one base @xmath246 . using @xmath685 we @xmath246-tie the boundary @xmath229 . applying @xmath718 , if necessary , we may assume that the set of boundary connections in @xmath235 is empty and that each boundary of @xmath235 touches a base .",
    "a reduced , cyclically reduced word @xmath939 in @xmath0 is called a _ period _ if @xmath939 is not a proper power .",
    "note that , in particular , one has that @xmath940 .",
    "the latter condition is equivalent to saying that the length @xmath941 of @xmath942 equals @xmath943 ( note that , in particular @xmath944 ) .",
    "a reduced word @xmath945 is called @xmath939-_periodic _ if @xmath946 and , as written , it is a subword of @xmath947 for some @xmath34 .",
    "every @xmath939-periodic word @xmath948 can be presented in the form @xmath949 where @xmath950 is a cyclic permutation of @xmath951 , @xmath952 , @xmath953 is a subdivision of @xmath950 , and @xmath954 .",
    "this presentation is unique if @xmath955 .",
    "the number @xmath956 is called the _ exponent _ of @xmath948 .",
    "a maximal exponent of the @xmath939-periodic subword in a word @xmath948 is called the _ exponent of @xmath939-periodicity of @xmath948_. we denote it by @xmath957 .    [ 11 ] a solution @xmath958 of @xmath235 is called _ periodic with respect to a period @xmath939 _ , if for every closed variable section @xmath601 of @xmath235 one of the following conditions holds :    1 .   [ it : per1 ] @xmath959 is @xmath939-periodic with exponent @xmath955 ; 2 .",
    "[ it : per2 ] @xmath960 ; 3 .",
    "[ it : per3 ] @xmath959 is @xmath119-periodic and @xmath961 ;    moreover , condition ( [ it : per1 ] ) holds for at least one closed variable section @xmath601 of @xmath235 .",
    "let @xmath2 be a @xmath939-periodic solution of @xmath235 . then",
    "a section @xmath601 satisfying condition ( [ it : per1 ] ) of the above definition is called _ @xmath939-periodic _ ( with respect to @xmath2 ) .",
    "the following lemma gives an intuition about the kind of generalised equations that have periodic solutions .",
    "[ lem : case2 ] let @xmath235 be a generalised equation such that every closed section @xmath962 of @xmath235 is either constant or there exists a pair of dual bases @xmath731 , @xmath963 such that @xmath731 and @xmath963 intersect but do not form a pair of matched bases , and @xmath964 $ ] .",
    "let @xmath2 be a solution of @xmath235 .",
    "then there exists a period @xmath939 such that @xmath2 is @xmath939-periodic .",
    "consider a section @xmath965 $ ] .",
    "the boundary @xmath966 intersects the base @xmath246 , since the bases @xmath246 and @xmath247 overlap .",
    "we @xmath246-tie the boundary @xmath967 , i.e. we introduce a boundary connection @xmath968 in such a way that @xmath2 is a solution of the obtained generalised equation .",
    "it follows that @xmath969 .    repeating this argument",
    ", we obtain a finite set of boundaries @xmath970 , @xmath971 such that    * @xmath972 intersect @xmath246 , * @xmath973 does not intersect @xmath246 , * there is a boundary connection @xmath974 for all @xmath975 and * @xmath2 induces a solution of the generalised equation obtained .",
    "this set of boundaries is finite , since the length of the solution @xmath2 is finite .",
    "let @xmath976=w$ ] , @xmath977 , where @xmath978 and @xmath119 is a period .",
    "then the section @xmath601 is @xmath119-periodic .",
    "indeed , @xmath979\\cup[i_1,i_2]\\cup\\dots\\cup[i_k , i_{k+1}]\\cup[i_{k+1},\\beta(\\delta(\\mu))].\\ ] ] using the boundary equations , we get that @xmath980=h[i_1,i_2]=\\dots = h[i_k , i_{k+1 } ] \\hbox { and } h[i_{k+1},\\beta(\\delta(\\mu))]=h[i_k,\\beta(\\mu)],\\ ] ] thus @xmath981 , where @xmath982 .",
    "set @xmath983 , where @xmath984 . by definition",
    ", @xmath2 is @xmath939-periodic .",
    "below we introduce the notion of a periodic structure .",
    "the idea of considering periodic structures on @xmath235 is to subdivide the set of periodic solutions into subsets so that any two solutions from the same subset have the same set of `` long items '' , i.e. @xmath939-periodic solutions that factor through the generalised equation @xmath235 and a periodic structure @xmath985 on @xmath235 satisfy the following property : @xmath986 one can regard lemma [ le : pp ] below as a motivation for the definition of a periodic structure .    [ above ] let @xmath235 be a generalised equation in the standard form without boundary connections .",
    "a _ periodic structure _ on @xmath235 is a pair @xmath987 , where    1 .",
    "[ it : ps1 ] @xmath988 is a non - empty set consisting of some variables @xmath289 , some variable bases @xmath246 , and some closed sections @xmath601 from @xmath591 such that the following conditions hold : * if @xmath989 , @xmath742 , @xmath990 and @xmath991 , then @xmath992 ; * if @xmath992 , then @xmath993 ; * if @xmath992 and @xmath994 , then @xmath995 ; * there exists a function @xmath996 mapping the set of closed sections from @xmath988 into @xmath997 such that for every @xmath998 , the condition that @xmath999 and @xmath1000 implies @xmath1001 ; 2 .   [ it : ps2 ] @xmath1002 is an equivalence relation on a certain set @xmath1003 ( defined in ( e ) ) such that condition ( f ) is satisfied . *",
    "notice , that for every boundary @xmath115 belonging to a closed section in @xmath1004 either there exists a unique closed section @xmath1005 in @xmath988 containing @xmath115 , or there exist precisely two closed sections @xmath1006 , \\sigma_{\\operatorname{right } }",
    "=   [ l , j]$ ] in @xmath988 containing @xmath115 .",
    "the set of boundaries of the first type we denote by @xmath1007 , and of the second type by @xmath1008 . put @xmath1009 here",
    "@xmath1010 are two `` formal copies '' of @xmath115",
    ". we will use the following agreement : for any base @xmath246 if @xmath1011 then by @xmath262 we mean @xmath1012 and , similarly , if @xmath1013 then by @xmath263 we mean @xmath1014 . *",
    "if @xmath992 then @xmath1015    [ rem : defperstr ] for a given generalised equation @xmath235 , there exists only finitely many periodic structures on @xmath235 , and all of them can be constructed effectively .",
    "indeed , every periodic structure @xmath1016 is uniquely defined by the subset of items of @xmath235 that belong to @xmath1004 and the relation @xmath1017 .",
    "therefore , to describe all periodic structures on @xmath235 it suffices to consider all subsets of the set of items of @xmath235 and different relations @xmath1017 on them .",
    "now we will show how to a @xmath939-periodic solution @xmath2 of @xmath235 one can associate a periodic structure @xmath1018 on @xmath235 .",
    "we define @xmath988 as follows .",
    "a closed section @xmath601 is in @xmath988 if and only if @xmath601 is @xmath939-periodic .",
    "a variable @xmath289 is in @xmath988 if and only if @xmath1019 for some @xmath995 and @xmath1020 .",
    "a variable base @xmath246 is in @xmath988 if and only if either @xmath246 or @xmath247 contains an item @xmath289 from @xmath988 .",
    "notice that for any factor base @xmath344 , @xmath1021 thus @xmath344 never belongs to @xmath1022",
    ".    put @xmath1023 ) = \\pm 1 $ ] depending on whether in ( [ 2.50 ] ) the word @xmath950 is conjugate to @xmath939 or to @xmath1024 .",
    "now let @xmath347\\in { { \\mathcal{p}}}$ ] and @xmath1025 . then one can write @xmath1026 in such a way that if @xmath1027 ) = 1 $ ] , then the word @xmath1028 $ ] is the terminal subword of the word @xmath1029 , where @xmath1030 is the infinite word obtained by concatenating the powers of @xmath939 , and @xmath1031 $ ] is the initial subword of the word @xmath1032 ; and if @xmath1023)= -1 $ ] , then the word @xmath1028 $ ] is the terminal subword of the word @xmath1033 and @xmath1031 $ ] is the initial subword of @xmath1034 . by lemma",
    "1.2.9 @xcite , the subdivision @xmath1035 with these properties is unique ; denote this decomposition by @xmath1036 .",
    "we define the relation @xmath1002 as follows : @xmath1037    [ le : pp ] let @xmath2 be a periodic solution of @xmath235",
    ". then @xmath1022 is a periodic structure on @xmath235 .",
    "let @xmath1018 .",
    "obviously , @xmath988 satisfies conditions ( a ) and ( b ) from definition [ above ] .",
    "we now prove that @xmath1004 satisfies condition ( c ) from definition [ above ] .",
    "let @xmath992 and @xmath1038 $ ] .",
    "there exists an item @xmath1039 such that @xmath1040 or @xmath1041 .",
    "if @xmath1040 , then , by construction , @xmath347 \\in { { \\mathcal{p}}}$ ] .",
    "if @xmath1042 and @xmath1043 $ ] , then @xmath1044 \\in { { \\mathcal{p}}}$ ] , and hence , the word @xmath1045 can be written in the form @xmath1046 , where @xmath1047 is a cyclic permutation of the word @xmath951 and @xmath1048 . since @xmath1049| \\ge |h(\\mu)| = |h(\\delta(\\mu))|\\ge 2 |p|$ ] and from definition [ 11 ] , it follows that @xmath347 $ ] is an @xmath119-periodic section , where @xmath1050 .",
    "then @xmath1051 , where @xmath1052 is a cyclic permutation of the word @xmath137 , @xmath1053 , @xmath1054 , and @xmath1055 . from the equality @xmath1056 and lemma 1.2.9 @xcite",
    "it follows that @xmath1052 is a cyclic permutation of the word @xmath1057 .",
    "consequently , @xmath119 is a cyclic permutation of the word @xmath951 .",
    "therefore , @xmath347 $ ] is a @xmath939-periodic section of @xmath235 with respect to @xmath2 , in other words , the length of @xmath365 $ ] is greater than or equal to @xmath943 and so @xmath347\\in { \\mathcal{p}}$ ] .",
    "if @xmath1058 $ ] , @xmath1059 $ ] and @xmath1060 , then the equality @xmath1061 = @xmath1062 ) \\cdot { \\mathcal x}([i_2 , j_2])$ ] follows from the fact that given @xmath1063 and @xmath1064 , the word @xmath119 can not be a cyclic permutation of the word @xmath1065 , hence condition ( d ) of definition [ 11 ] holds .",
    "since @xmath1066 , from lemma 1.2.9 in @xcite it follows that condition ( f ) also holds for the relation @xmath1002 .",
    "[ rem : subword ] now let us fix a nonempty periodic structure @xmath987 on a generalised equation @xmath235 .",
    "item ( d ) of definition [ above ] allows us to assume ( after replacing the variables @xmath1067 by @xmath1068 on those closed sections @xmath347 \\in { { \\mathcal{p}}}$ ] for which @xmath1023)=-1 $ ] ) that @xmath1069 for all @xmath992 .",
    "therefore , we may assume that for every item @xmath289 , the word @xmath1070 is a subword of the word @xmath1030 .",
    "the rest of this section is devoted to defining the group of automorphisms @xmath937 .",
    "the idea is as follows .",
    "we change the set of generators @xmath69 of the coordinate group @xmath761 by @xmath1071 and we use the new set of generators to give an explicit description of the generating set of the group of automorphisms @xmath937 .    to construct the set of generators @xmath1071 of @xmath761 ,",
    "the following definitions are in order .",
    "we construct the _ graph @xmath1072 of a periodic structure @xmath1073_. the set of vertices @xmath91 of the graph @xmath92 is the set of @xmath1002-equivalence classes . for a boundary @xmath229 ,",
    "denote by @xmath1074 the equivalence class of the relation @xmath1002 to which it belongs .",
    "for each variable @xmath354 that belongs to a certain closed section from @xmath988 , we introduce an oriented edge @xmath1075 from @xmath1074 to @xmath1076 , @xmath1077 and an inverse edge @xmath1078 .",
    "we label the edge @xmath1079 by @xmath1080 ( correspondingly , @xmath1081 ) . for every path @xmath1082 in the graph @xmath92",
    ", we denote its label by @xmath1083 , @xmath1084 , @xmath1085 .",
    "the periodic structure @xmath987 is called _ connected _ , if its graph @xmath92 is connected .",
    "let @xmath987 be an arbitrary periodic structure of a generalised equation @xmath235 .",
    "let @xmath1086 be the connected components of the graph @xmath92 .",
    "the labels of edges of the component @xmath1087 form ( in the generalised equation @xmath235 ) a union of labels of closed sections from @xmath988 .",
    "moreover , if a base @xmath992 belongs to a section from @xmath1004 , then its dual @xmath247 , by condition ( f ) of definition [ above ] , also belongs to a section from @xmath1004 .",
    "therefore , by taking for @xmath1088 : the set of labels of edges from @xmath1087 that belong to @xmath988 , closed sections to which these labels belong , and bases @xmath992 that belong to these sections , and restricting the relation @xmath1002 accordingly , we obtain a connected periodic structure @xmath1089 whose graph is @xmath1087 .",
    "we write @xmath1090 meaning that @xmath1091 and the relation @xmath1092 is a restriction of the relation @xmath1002 . in particular , in the above notation @xmath1093 .",
    "we further assume that the periodic structure @xmath987 is connected .",
    "let @xmath92 be the graph of a periodic structure @xmath1094 , let @xmath1082 be a path in @xmath92 and let @xmath1083 be its label , @xmath1084 , @xmath1085 . to simplify the notation we write @xmath1095 instead of @xmath1096 .",
    "[ 2.9 ] let @xmath2 be a @xmath939-periodic solution of a generalised equation @xmath235 , let @xmath1094 be a periodic structure on @xmath235 and let @xmath100 be a cycle in the graph @xmath1072 at the vertex @xmath1097 , @xmath1098",
    ". then there exists @xmath1099 such that @xmath1100 .    if @xmath1079 is an edge @xmath843 in the graph @xmath92 , and @xmath1101 , @xmath1102 are two decompositions corresponding to the boundaries from @xmath1103 and @xmath1104 respectively .",
    "then , obviously , @xmath1105 , @xmath1106 .",
    "the statement follows if we multiply the values @xmath1107 for all the edges @xmath1079 in the cycle @xmath100 .",
    "[ 2.51 ] a generalised equation @xmath235 is called _ periodised _ with respect to a given periodic structure @xmath987 , if for every two cycles @xmath1108 and @xmath1109 based at the same vertex in the graph @xmath1110 , there is a relation @xmath1111=1 $ ] in @xmath537 .",
    "let @xmath1112 and @xmath1113 .",
    "let @xmath1114 be the subgraph of the graph @xmath1072 having the same set of vertices as @xmath92 and the set of edges @xmath1115 . choose a maximal subforest @xmath1116 in the graph @xmath1117 and extend it to a maximal subforest @xmath1118 of the graph @xmath92 .",
    "since the periodic structure @xmath987 is connected by assumption , it follows that @xmath582 is a tree .",
    "fix an arbitrary vertex @xmath1119 of the graph @xmath92 and denote by @xmath1120 the ( unique ) path in @xmath582 from @xmath1119 to @xmath95 . for every edge @xmath1121 not lying in @xmath582",
    ", we introduce a cycle @xmath1122 .",
    "then the fundamental group @xmath1123 is generated by the cycles @xmath1124 ( see , for example , the proof of proposition iii.2.1 , @xcite ) .",
    "if the universal horn theory of @xmath0 is decidable , then the property of a generalised equation `` to be periodised with respect to a given periodic structure '' is algorithmically decidable .",
    "indeed , it suffices to check if the following universal formula ( quasi - identity ) holds in @xmath0 ( for every pair of cycles @xmath1125 , @xmath1126 ) : @xmath1127=1\\right)\\right).\\ ] ]    furthermore , the set of elements @xmath1128 forms a basis of the free group generated by @xmath1129 if @xmath992 , then @xmath1130 , @xmath1131 by property ( f ) from definition [ above ] and , consequently , the word @xmath1132 is the label of a cycle @xmath1133 from @xmath1134 .",
    "let @xmath1135 .",
    "then @xmath1136 where @xmath219 is the label of the path @xmath1137 .",
    "since @xmath1138 , it follows that @xmath1139 , where @xmath1140 is a certain word in the indicated generators that can be constructed effectively ( see proposition iii.2.1 , @xcite ) .",
    "let @xmath1141 denote the image of the word @xmath1140 in the abelianisation of @xmath1142 .",
    "denote by @xmath1143 the free abelian group consisting of formal linear combinations @xmath1144 , @xmath1145 , and by @xmath1146 its subgroup generated by the elements @xmath1141 , @xmath992 and the elements @xmath1147 , @xmath1148 , @xmath1149 .    by the classification theorem of",
    "finitely generated abelian groups , one can effectively construct a basis @xmath1150 of @xmath1143 such that @xmath1151 < \\infty,\\ ] ] where @xmath1152 is a basis of @xmath1153 and @xmath1154 is a basis of @xmath1155 .    by proposition i.4.4 in @xcite , one can effectively construct a basis @xmath1156 , @xmath1157 of the free ( non - abelian ) group @xmath1123 such that @xmath1152 , @xmath1154 are the natural images of the elements @xmath1158 , @xmath1159 in @xmath1143 .",
    "[ rem : hab ] notice that any equation in @xmath1143 of the form @xmath1160 lifts to an equation in @xmath1161 of the form @xmath1162 where @xmath165 is an element of the derived subgroup of @xmath1161 .",
    "if the generalised equation is periodised , for any two cycles @xmath1163 , we have that @xmath1164=1 $ ] in @xmath761 .",
    "hence , @xmath1165 in @xmath761 .",
    "[ cl : propc1 ] let @xmath235 be a periodised generalised equation . then the basis @xmath1152 can be chosen in such a way that for every @xmath1166 either @xmath1167 , where @xmath1168 , @xmath1169 , or for any solution @xmath2 we have @xmath1170 .",
    "the set @xmath1171 is a subset of the set of generators of @xmath1143 contained in @xmath1153 .",
    "thus , this set can be extended to a basis of @xmath1153 . since , by ( [ 2.54 ] ) , @xmath1172 < \\infty$ ] , for every @xmath1173 there exists @xmath1174 such that @xmath1175 it follows that the set @xmath1176 which completes the set @xmath1177 to a basis of @xmath1153 , can be chosen so that the following equality holds : @xmath1178    hence , by remark [ rem : hab ] , for any solution @xmath2 we have @xmath1179 . since @xmath939 is cyclically reduced and @xmath1180 and since @xmath1181 , we have that @xmath1182 .",
    "let @xmath1183 be the set of edges of @xmath1184 .",
    "since @xmath1185 is the spanning forest of the graph @xmath1117 , it follows that @xmath1186 ; in particular , @xmath1187 .",
    "let @xmath1188 be the free group generated by the variables of @xmath235 .",
    "consider in the group @xmath1189 a new set of generators @xmath1071 defined below ( we prove that the set @xmath1071 is in fact a set of generators of @xmath1189 in part ( [ spl3 ] ) of lemma [ 2.10  ] ) .    let @xmath832 be the origin of the edge @xmath107 .",
    "we introduce new variables @xmath1190 as follows @xmath1191 we denote by @xmath1192 the union @xmath1193 and by @xmath1194 the union @xmath1195 .",
    "denote by @xmath1196 the family of variables that do not belong to closed sections from @xmath1004 .",
    "let @xmath1197    note that without loss of generality we may assume that @xmath1119 corresponds to the beginning of the period @xmath939 .",
    "indeed , it follows from the definition of the periodic structure that for any cyclic permutation @xmath1198 of @xmath939 , we have @xmath1199 .",
    "[ lem : spl1 ] let @xmath314 be a generalised equation periodised with respect to a periodic structure @xmath1200 . then for any cycle @xmath1201 such that @xmath1202 and for any solution @xmath2 of @xmath235 periodic with respect to a period @xmath939 such that @xmath1203 , one has @xmath1204 , where @xmath1205 .",
    "in particular , one can choose a basis @xmath1158 in such a way that for any @xmath1166 one has @xmath1206 , where @xmath1205 .",
    "let @xmath1201 be a cycle such that the edges of @xmath1201 are labelled by variables @xmath354 , @xmath1207 .",
    "observe that @xmath1208 , where @xmath1209 and @xmath1210 are paths in the tree @xmath582 .",
    "since @xmath1211 , it follows that the origin and the terminus of the edge @xmath1212 lie in the same connected component of the graph @xmath1117 and , consequently , are connected by a path @xmath99 in the forest @xmath1185 .",
    "furthermore , @xmath1209 and @xmath1213 are paths in the tree @xmath582 connecting the same vertices ; therefore , @xmath1214 .",
    "hence , @xmath1215 , where @xmath1216 is a certain cycle based at the vertex @xmath1217 in the graph @xmath1117 .    from the equality @xmath1218 and by lemma",
    "[ 2.9 ] , we get that @xmath1219 , where @xmath1220 , @xmath1221 , @xmath1222 , @xmath1223 .",
    "hence @xmath1224 and thus @xmath1225 . from the construction of @xmath1022",
    ", it follows that the inequality @xmath1226 holds for every item @xmath1227 .",
    "since the cycle @xmath1216 is simple , we have that @xmath1228 .",
    "in particular , one has that @xmath1229 for every @xmath1230 , @xmath1149 . by lemma [ cl : propc1 ] one can choose a basis @xmath1158 such that for every @xmath1166 either @xmath1167 and @xmath1229 , or @xmath1170 .",
    "[ 2.10  ] let @xmath314 be a generalised equation periodised with respect to a periodic structure @xmath1200 .",
    "then the following statements hold .    1",
    ".   [ spl2 ] let @xmath1231 be a fully residually @xmath0 quotient of @xmath537 , such that @xmath1231 is discriminated by solutions that satisfy the following condition : for any @xmath1166 , @xmath1206 and @xmath1205 .",
    "then the image of @xmath1232 in @xmath1231 is either trivial or a cyclic subgroup .",
    "[ spl3 ] the system @xmath1233 is equivalent to the union of the following two systems of equations : @xmath1234=1,&\\hbox{where } e_j\\in t , \\,e_j\\in \\operatorname{sh } , \\ , j=1,2 ; 1\\leq i\\leq m \\\\",
    "\\left[h({\\mathfrak{c}}_1),h({\\mathfrak{c}}_2)\\right]=1 , & \\hbox{where } { \\mathfrak{c}}_1,{\\mathfrak{c}}_2\\in c^{(1)}\\cup c^{(2 ) }                  \\end{array }                  \\right.\\ ] ] and a system : @xmath1235 such that neither @xmath1236 , @xmath1237 , nor @xmath1238 occurs in @xmath1239 .",
    "[ spl4 ] if @xmath100 is a cycle based at the origin of @xmath107 , then the transformation @xmath1240 which is identical on all the other elements from @xmath1241 , extends to a @xmath0-automorphism of @xmath537 .",
    "[ spl5 ] if @xmath1242 and @xmath1243 , @xmath1244 , then the transformation defined by @xmath1245 , which is identical on all the other elements from @xmath1241 , extends to a @xmath0-automorphism of @xmath537 .",
    "we first prove ( [ spl2 ] ) .",
    "since the image of the group @xmath1246 in @xmath0 is cyclic , and since for all @xmath1166 the exponent of periodicity @xmath1247 is bounded by lemma [ lem : spl1 ] , for any pair of elements @xmath1248 and any solution @xmath2 at least one of the elements of the finite set : @xmath1249 is trivial .",
    "since @xmath1231 is @xmath0-discriminated ( by @xmath0 ) by @xmath939-periodic solutions , for any pair of elements @xmath1248 one of the elements of the finite set @xmath1250 is trivial in @xmath1251 .",
    "therefore , the subgroup generated by @xmath1252 is cyclic .    to prove ( [ spl3 ] ) we will rewrite the system of equations @xmath533 in the new variables .",
    "it is easy to check that ( in the above notation ) : @xmath1253 from equation ( [ 2.52 ] ) and the discussion above it follows that @xmath1254 i.e. the sets @xmath69 and @xmath1071 generate the same free group @xmath1188 .",
    "we now rewrite the equations from @xmath235 in terms of the new set of generators @xmath1071 .",
    "we first consider the relations induced by bases which do not belong to @xmath1004 , i.e. basic equations of the form @xmath1255 , where @xmath246 is a variable base , @xmath1256 and factor equations @xmath1257 . by construction of the generating set @xmath1071 , all the items @xmath354 which appear in these relations belong to the set @xmath1258 the elements of the sets @xmath1196 and @xmath1259 are generators in both basis .",
    "we now study how elements of @xmath1260 rewrite in the new basis .",
    "let @xmath1080 , @xmath1261 , @xmath1169 .",
    "we have @xmath1262 and @xmath1263 where @xmath99 is a path in @xmath1185 and @xmath1210 is a path in @xmath582 ( see proof of lemma [ lem : spl1 ] ) .",
    "the variables @xmath1236 , @xmath1264 can occur in the right - hand side of equation ( [ eq : obt ] ) ( written in the basis @xmath1265 ) only in @xmath1266 and at most once",
    ". moreover , the sign of this occurrence ( if it exists ) depends only on the orientation of the edge @xmath107 with respect to the root @xmath1119 of the tree @xmath582 . if @xmath1267 , then all the occurrences of the variable @xmath1236 in the words @xmath354 written in the basis @xmath1265 , with @xmath1268 , are contained in the subwords of the form @xmath1269 , i.e. in the subwords of the form @xmath1270 , where @xmath100 is a certain cycle in the graph @xmath92 based at the origin of the edge @xmath1271 .",
    "so the variable @xmath354 rewrites as a word in the generators @xmath1192 , @xmath1194 , @xmath1272 .",
    "summarising , the basic equations corresponding to variable bases which do not belong to @xmath1004 and the factor equations rewrite in the new basis as words in @xmath1196 , @xmath1273 , @xmath1192 and @xmath1194 .    in the new basis , the relations of the form @xmath1255 , where @xmath1274 , are , modulo commutators , words in @xmath1252 , see remark [ rem : hab ] .",
    "since @xmath235 is periodised with respect to @xmath985 , we have @xmath1275=1 \\hbox { and } [ h({\\mathfrak{c}}_1),h({\\mathfrak{c}}_2)]=1 , \\",
    "{ \\mathfrak{c}}_1,{\\mathfrak{c}}_2\\in c^{(1)}\\cup c^{(2)}.\\ ] ]    it follows that the system @xmath1233 is equivalent to the union of the following two systems of equations in the new variables , a system @xmath1276=1,&\\hbox{where } e_j\\in t , \\,e_j\\in \\operatorname{sh } , \\ , j=1,2 ; 1\\leq i\\leq m   \\\\ \\left[h({\\mathfrak{c}}_1),h({\\mathfrak{c}}_2)\\right]=1 , & \\hbox{where } { \\mathfrak{c}}_1,{\\mathfrak{c}}_2\\in c^{(1)}\\cup c^{(2 ) } \\end{array } \\right.\\ ] ] and a system ( defined by the equations from @xmath235 ) : @xmath1277 such that neither @xmath1236 , @xmath1237 , nor variables from @xmath1238 occur in @xmath1239 .",
    "the transformations @xmath1240 ( and @xmath1245 ) from statement ( [ spl4 ] ) ( statement ( [ spl5 ] ) ) of the lemma extend to an automorphism @xmath1278 of @xmath761 .",
    "indeed , by the universal property of the quotient , the following diagram commutes @xmath1279 \\ar[d ] \\ar[r]^{\\varphi } & g[\\bar x ] \\ar[d ]   \\\\   g_{r(\\psi\\cup \\mathcal{o } ) }   \\ar@{-->>}[r]^{\\tilde\\varphi }   & g_{r(\\psi\\cup \\mathcal{o}\\cup \\varphi(\\mathcal{o } ) ) }   } \\ ] ] it is easy to check that @xmath1280 and that @xmath1281 .",
    "therefore , since by statement ( [ spl3 ] ) of the lemma the system @xmath1282 is equivalent to @xmath533 , we get that @xmath1283 is an automorphism of @xmath761 .",
    "we now introduce a reflexive , transitive relation on the set of solutions of a generalised equation .",
    "we use this relation to introduce the notion of a minimal solution with respect to a group of automorphisms of the coordinate group of the generalised equation    [ defn : sol < ] let @xmath1284 = g\\ast f(b)$ ] , where @xmath1285 is a free group with basis @xmath1052 , let @xmath235 be a generalised equation with coefficients from @xmath236 . let @xmath1286 be an arbitrary group of @xmath0-automorphisms of @xmath761 . for solutions @xmath934 and @xmath1287 of the generalised equation @xmath235 in",
    "@xmath1284 $ ] we write @xmath1288 if there exists a @xmath0-endomorphism @xmath557 of the group @xmath1284 $ ] and an automorphism @xmath1289 such that the following conditions hold :    1 .   [ it : minsol1 ] @xmath1290 ; 2 .",
    "[ it : minsol3 ] for any @xmath229 we have @xmath1291 and @xmath1292 .    obviously , the relation ` @xmath1293 ' is transitive .",
    "we would like to draw the reader s attention to the fact that the relation @xmath1294 does not imply relations on the lengths of the solutions @xmath2 and @xmath1295 .",
    "[ lem : minsol ] let @xmath1284 = g\\ast f(b)$ ] and let @xmath235 be a generalised equation with coefficients from @xmath1296 .",
    "let @xmath1286 be an arbitrary group of @xmath0-automorphisms of @xmath1297[h]$ } \\!\\mathord{\\left/ { \\vphantom { g[b][h ] { r(\\omega^*)}}}\\right.\\kern-\\nulldelimiterspace } \\!\\lower0.7ex\\hbox{${r(\\omega^*)}$}}}$ ] and let @xmath934 and @xmath1287 be two solutions of the generalised equation @xmath235 such that @xmath1298 .",
    "then for any word @xmath1299 such that the @xmath1300 is reduced as written , the word @xmath1301 is reduced as written",
    ".    follows from condition ( [ it : minsol3 ] ) in definition [ defn : sol < ] .",
    "[ defn : nfmatrix ] let @xmath235 be a generalised equation in @xmath455 variables and let @xmath2 be a solution of @xmath235 . consider a @xmath455-vector @xmath1302 , with entries in the set @xmath1303 constructed by the solution @xmath2 in the following way .",
    "we set @xmath1304 if and only if @xmath1305 and @xmath1306 .",
    "we call the vector @xmath1302 the ( @xmath455-)_type vector _ of the solution @xmath2 .",
    "[ def : minsol ] a solution @xmath2 of @xmath235 is called _ minimal with respect to the group of automorphisms @xmath1286 _ if there exist no solutions @xmath1295 of the generalised equation @xmath235 so that @xmath1307 and @xmath1308 for all @xmath229 , @xmath1309 and @xmath1310 for at least one @xmath64 , @xmath1311 .",
    "since the length of a solution @xmath2 is a positive integer , every strictly descending chain of solutions @xmath1312 is finite .",
    "it follows that for every solution @xmath2 of @xmath235 there exists a minimal solution @xmath1313 such that @xmath1314 .",
    "[ rem : ms ] note that given a solution @xmath2 , there exists a minimal solution @xmath1313 ( perhaps more than one ) so that @xmath1315 .",
    "furthermore , there may exist minimal solutions @xmath1313 and @xmath1295 so that @xmath1316 and @xmath1317 .",
    "therefore , among all minimal solutions @xmath1313 such that @xmath1314 one can consider a solution of minimal total length .",
    "[ rem : minsol ] note that every generalised equation @xmath235 with coefficients from @xmath236 can be considered as a generalised equation @xmath749 with coefficients from @xmath1296 for _ any _ finite set @xmath1052 .",
    "therefore , any solution @xmath2 of @xmath235 induces a solution @xmath1295 of @xmath749 such that the following diagram commutes : @xmath1318 \\ar[d]_{\\pi_h }   & \\,{{\\raise0.7ex\\hbox{$g[b][h]$ } \\!\\mathord{\\left/ { \\vphantom { g[b][h ] { r(\\omega^\\ast)}}}\\right.\\kern-\\nulldelimiterspace } \\!\\lower0.7ex\\hbox{${r(\\omega^\\ast)}$ } } } \\ar[d]^{\\pi_{h ' } }                                                                               \\\\                     g \\ ,    \\ar@{^{(}->}[r ] & \\,g[b ] } \\ ] ] a solution @xmath2 of @xmath235 is minimal if _ any _ induced solution @xmath1295 is .",
    "there is a subtlety with the type constraints : the type constraints are to be satisfied only when they make sense . in the case",
    "that a component @xmath1070 of the solution @xmath2 ends ( begins ) with a letter from @xmath1052 ( rather than from @xmath0 ) , we do not require that @xmath1070 satisfy the terminal ( initial ) type constraint .",
    "alternatively , one can assume that the letters from @xmath1052 have both type @xmath185 and @xmath512 .",
    "the reason for extending the generating set from @xmath236 to @xmath1296 in the definition above , becomes clear in the proof of lemma [ lem:23 - 1.5 ]    [ lem:2.1 ] let the generalised equation @xmath622 be obtained from the generalised equation @xmath235 by one of the elementary transformation @xmath1319 , i.e. @xmath1320 for some @xmath1321 and assume that @xmath1322 is isomorphic to @xmath761 .",
    "let @xmath2 be a solution of @xmath235 and @xmath934 be a solution of @xmath622 so that the following diagram commutes @xmath617_{\\pi_h } \\ar[rr]^{\\theta }   &    & g_{r(\\omega_1^\\ast ) } \\ar[ld]^{\\pi_{h^{(1 ) } } } \\\\                                 &   g & } \\ ] ] if @xmath2 is a minimal solution of @xmath235 with respect to a group of automorphisms @xmath1323 of @xmath761 , then @xmath934 is a minimal solution of @xmath622 with respect to the group of automorphisms @xmath1324 .    assume the converse , i.e. @xmath934 is not minimal with respect to @xmath1324",
    ". then there exists a solution @xmath1325 of @xmath622 so that @xmath1326 , @xmath1327 for all @xmath229 and @xmath1328 for some @xmath64 .",
    "let @xmath1313 be a solution of the system of equations @xmath533 so that @xmath1329 . as described in the definition of elementary transformations , @xmath1330 and @xmath1331 where @xmath1332 for all @xmath26 , is an item of @xmath622 .",
    "since @xmath1326 , by condition ( [ it : minsol3 ] ) from definition [ defn : sol < ] , we have @xmath1333 and thus @xmath1313 is a solution of @xmath235 and condition ( [ it : minsol3 ] ) from definition [ defn : sol < ] holds for the pair @xmath1313 and @xmath2 .",
    "furthermore , by condition ( [ it : minsol1 ] ) from definition [ defn : sol < ] , we have @xmath1334 , where @xmath1335 , hence @xmath1336 , and thus condition ( [ it : minsol1 ] ) from definition [ defn : sol < ] holds for the pair @xmath1313 and @xmath2 .",
    "we thereby have proven that @xmath1337 .    finally , from equations ( [ 2.16 ] ) ,",
    "( [ 2.17 ] ) and the fact that @xmath1325 is minimal , we get that @xmath1338 for all @xmath229 and @xmath1339 for some @xmath64 , contradicting the minimality of @xmath2 .",
    "[ defn : singreg ] let @xmath235 be a generalised equation and let @xmath1073 be a connected periodic structure on @xmath235 .",
    "we say that the generalised equation @xmath235 is _ singular ( of type ( a ) , ( b ) or ( c ) ) with respect to the periodic structure @xmath1073 _ if one of the following conditions holds    * the generalised equation @xmath235 is not periodised with respect to the periodic structure @xmath1073 . *",
    "the set @xmath1159 has more than one element . *",
    "the set @xmath1159 has exactly one element , and ( in the above notation ) there exists a cycle @xmath1340 , @xmath1202 such that @xmath1341 in @xmath537 .",
    "otherwise , we say that @xmath235 is _ regular with respect to the periodic structure @xmath1073_. in particular if @xmath235 regular with respect to the periodic structure @xmath1073 then @xmath235 is periodised .    when no confusion arises , instead of saying that @xmath235 is singular ( or regular ) with respect to the periodic structure @xmath1073 we say that the periodic structure @xmath1073 is _ singular _ ( of type ( a ) , ( b ) or ( c ) ) ( or _ regular _ ) .    [ defn : aa ]",
    "let @xmath235 be a generalised equation and let @xmath985 be a periodic structure on @xmath235 .",
    "if @xmath235 is singular of type ( a ) with respect to @xmath985 , then we define the group @xmath937 of automorphisms of @xmath537 to be trivial .    otherwise , i.e. if @xmath1342 is singular of types ( b ) or ( c ) or regular , we set @xmath937 to be the group of automorphisms of @xmath537 generated by the automorphisms described in statements ( [ spl4 ] ) and ( [ spl5 ] ) of lemma [ 2.10  ] .",
    "note that by definition , the group @xmath937 is finitely generated .",
    "the next lemma states that if a generalised equation @xmath235 is singular with respect to a periodic structure , then one can construct finitely many proper quotients of the coordinate group @xmath761 , such that for every periodic solution there exists an @xmath937-automorphic image such that this image is in fact a solution of one of the quotients constructed . in other words , every solution of the generalised equation can be obtained as a composition of an automorphism from @xmath937 and a solution of a proper generalised equation .",
    "[ lem:23 - 1 ] let @xmath235 be a formally consistent generalised equation without boundary connections , singular with respect to the periodic structure @xmath1342 .",
    "then there exists a finite family of cycles @xmath1343 in the graph @xmath92 such that :    1 .",
    "[ it:23 - 11 ] @xmath1344 , @xmath1345 in @xmath537 ; 2 .",
    "[ it:23 - 12]for any solution @xmath2 of @xmath235 such that @xmath2 is periodic with respect to a period @xmath939 and @xmath1346 , there exists an @xmath937-automorphic image @xmath1313 of @xmath2 such that @xmath1347 for some @xmath1348 ; 3 .",
    "[ it:23 - 13 ] for any @xmath1349 , @xmath1350 ; and for any @xmath1351 if @xmath1352 , then @xmath1353 , where @xmath1354 , @xmath1355 .",
    "suppose that @xmath235 is not periodised with respect to the periodic structure @xmath985 , i.e. there exist two cycles @xmath1356 so that @xmath1357\\ne 1 $ ] in @xmath761 .",
    "since , by lemma [ 2.9 ] , for every @xmath939-periodic solution @xmath2 , one has that @xmath1358)=1 $ ] , it suffices to take as the set of cycles @xmath1359 the set consisting of the commutator @xmath1360 $ ] .",
    "we further assume that @xmath235 is periodised with respect to the periodic structure @xmath985 .",
    "suppose that @xmath1361 .",
    "let @xmath2 be a @xmath939-periodic solution of a generalised equation @xmath314 , such that @xmath1362 .",
    "let @xmath1363 . by lemma",
    "[ 2.9 ] , @xmath1364 , @xmath1365 .    without loss of generality",
    "we may assume that @xmath1366 .",
    "write @xmath1367 , where either @xmath1368 or @xmath1369 . applying the canonical automorphism @xmath1370",
    ", we get @xmath1371 , hence the exponent of periodicity @xmath1372 is reduced .    applying the euclidean algorithm",
    ", we get that there exists an automorphism @xmath1373 from @xmath937 such that @xmath1374 or @xmath1375 .",
    "set @xmath1376 .",
    "then the set @xmath1377 satisfies conditions ( [ it:23 - 11 ] ) and ( [ it:23 - 12 ] ) of the lemma .    in the notation of lemma",
    "[ 2.10  ] , the automorphism @xmath1373 is identical on all the elements of @xmath1071 except for @xmath1238 , hence , in particular , it is identical on @xmath1378 such that @xmath1379 or @xmath1380 , and on @xmath1252 , i.e. @xmath1381 , for any @xmath1382 or @xmath1383 and @xmath1384 for any @xmath1385 .    if @xmath1386 , @xmath1230 , @xmath1387 , then @xmath1388 , where @xmath1389 are paths in @xmath582",
    "therefore , @xmath1390 .",
    "since @xmath1391 lies in the subgroup generated by @xmath1252 and @xmath1238 , then @xmath1392 and @xmath1393 lie in the cyclic group generated by @xmath939 .",
    "this proves statement ( [ it:23 - 13 ] ) of the lemma .",
    "suppose that @xmath1394 , since the periodic structure is singular , there exists a cycle @xmath1395 such that @xmath1396 in @xmath537 and such that the edges of @xmath100 are labelled by variables @xmath354 , @xmath1207 . let @xmath34 be the number of edges in @xmath100 .",
    "we define the set of cycles @xmath1397 to be @xmath1398    we now show that if @xmath1399 in @xmath1400 , then @xmath1401 .",
    "suppose @xmath1399 .",
    "let @xmath1402 be a generator of the group of automorphisms @xmath937 such that @xmath1403 and @xmath1404 .",
    "hence @xmath1405 in @xmath1400 and @xmath1406 .",
    "this implies that either @xmath1407 ( see proof of part ( [ spl3 ] ) of lemma [ 2.10  ] ) or @xmath1408 . since @xmath1396 , we have @xmath1408 .",
    "similarly , we get @xmath1409 .",
    "let @xmath2 be a @xmath939-periodic solution of the generalised equation @xmath235 , such that @xmath1410 .",
    "since all the edges in the cycle @xmath100 are labelled by items @xmath354 , @xmath1207 , by lemma [ lem : spl1 ] we have @xmath1411 , @xmath1412 .",
    "let @xmath1413 .    if @xmath1414 , we can take @xmath1415 , @xmath1416 and the set of cycles @xmath1417 .",
    "let @xmath1418 , @xmath1419 , @xmath1420 and @xmath1421 .",
    "let @xmath1422 and define @xmath1313 to be the image of @xmath2 under @xmath601 .",
    "set @xmath1423 , then @xmath1424 , @xmath1425 and @xmath1426 .",
    "an analogous argument to the one given in the case @xmath1427 shows that @xmath1428 if @xmath1349 , and @xmath1429 if @xmath1430 and @xmath1351 .      the aim of this section is to prove that if a generalised equation @xmath235 is regular with respect to a periodic structure , then periodic solutions of @xmath235 minimal with respect to the group of automorphisms @xmath937 have bounded exponent of periodicity . in other words , the length of such a solution",
    "is bounded above by a function of @xmath235 and the length @xmath1431 of its period @xmath939 .",
    "[ lem:23 - 1.5 ] let @xmath314 be a generalised equation with no boundary connections , periodised with respect to a connected periodic structure @xmath985 .",
    "let @xmath2 be a periodic solution of @xmath235 such that @xmath1432 and minimal with respect to the trivial group of automorphisms .",
    "then , either for all @xmath229 , @xmath1433 we have @xmath1434 so that @xmath1206 , where @xmath1435 .",
    "let @xmath2 be a @xmath939-periodic solution of the generalised equation @xmath235 minimal with respect to the trivial group of automorphisms .",
    "suppose that there exists a variable @xmath1039 such that @xmath1436 .",
    "we then prove that there exists a cycle @xmath1437 so that @xmath1206 , where @xmath1435 .",
    "construct a chain @xmath1438 in which for all @xmath26 , @xmath1439 is obtained from @xmath1440 using @xmath685 : by @xmath246-tying a free boundary that intersects a certain base @xmath992 .",
    "chain ( [ 2.63 ] ) is constructed once all the boundaries intersecting bases @xmath246 from @xmath988 are @xmath246-tied .",
    "this chain is finite , since , by the definition , boundaries that are introduced when applying @xmath685 are not free .",
    "by construction , the generalised equations @xmath1440 s in ( [ 2.63 ] ) have boundary connections .",
    "our definition of periodic structure is given for generalised equations without boundary connections , see definition [ above ] .",
    "for this reason we define @xmath1441 to be the generalised equation obtained from @xmath584 by omitting all boundary connections ( here we do not apply @xmath718 ) .",
    "it is obvious that the solution @xmath1442 of @xmath584 is also a solution of the generalised equation @xmath1441 and is periodic with respect to the period @xmath939 .",
    "denote by @xmath1089 the periodic structure @xmath1443 on the generalised equation @xmath1444 restricted to the closed sections from @xmath988 , and by @xmath1445 the corresponding graph .    if @xmath1446 , @xmath992 , is a boundary connection of the generalised equation @xmath584 , @xmath1447 , then @xmath1448 .",
    "therefore , all the graphs @xmath1449 , @xmath1450 have the same set of vertices , whose cardinality does not exceed @xmath455 . by lemma [ lem:2.1 ] ,",
    "the solution @xmath1451 of the generalised equation @xmath1452 is also minimal with respect to the trivial group of automorphisms .",
    "suppose that for some variable @xmath1453 belonging to a section from @xmath988 the inequality @xmath1454 holds .",
    "let @xmath1455 .",
    "consider the group @xmath1456=g\\ast\\langle u\\rangle$ ] , where @xmath219 is a new letter .",
    "in the solution @xmath1451 , replace all the components @xmath1457 such that @xmath1458 or @xmath1459 by the letter @xmath219 or @xmath1460 , correspondingly ( see definition [ def : minsol ] ) .",
    "denote the resulting @xmath1461-tuple of words by @xmath1462 .",
    "we show that @xmath1462 is in fact a solution of @xmath1452 ( considered as a generalised equation with coefficients from @xmath1463 , see remark [ rem : minsol ] ) . obviously , every component of @xmath1462 is non - empty and written in the normal form . since in the generalised equation",
    "@xmath1452 all the boundaries from @xmath988 are @xmath246-tied , @xmath1274 , there is a one - to - one correspondence between the items that belong to @xmath246 and the items that belong to @xmath247 .",
    "therefore , @xmath1462 satisfies all basic equations @xmath1255 , @xmath1464 and all the boundary equations of the generalised equation @xmath1452 .",
    "if , on the other hand , @xmath1465 , then for every item @xmath1040 of the generalised equation @xmath235 lying on a closed section from @xmath988 , we have @xmath1227 and , consequently , @xmath1466 .",
    "in particular , this inequality holds for every item @xmath1040 , @xmath1467 of the generalised equation @xmath1452 .",
    "therefore , such items have not been replaced in the solution @xmath1451 , thus @xmath1462 satisfies all basic equations @xmath1255 , @xmath1467 .",
    "let @xmath1468\\to g[u]$ ] be a map that sends @xmath219 to @xmath1469 and fixes @xmath0 .",
    "it is easy to see that @xmath557 is a @xmath0-endomorphism , which contradicts the minimality of the solution @xmath1470 .",
    "indeed , one has @xmath1471 . by construction",
    ", @xmath219 does not occur in the solution @xmath1451 and condition ( [ it : minsol3 ] ) of definition [ defn : sol < ] holds .",
    "therefore , @xmath1472 . obviously , @xmath1473 for all @xmath1474 and @xmath1475 .",
    "we thereby have shown that @xmath1476 , if @xmath1453 belongs to a closed section from @xmath988 .    in the construction of chain ( [ 2.63 ] ) we introduced new boundaries , so every item from @xmath581 can be expressed as a product of items from @xmath1477 . consequently , since @xmath1476 for every @xmath115 , if the component @xmath1478 of the solution @xmath2 of the generalised equation @xmath235 does not satisfy inequality ( [ 2.62 ] ) , then @xmath354 is a product of at least @xmath1479 distinct items of @xmath1477 , @xmath1480 , where @xmath1481 .    since the graph @xmath1482 contains at most @xmath455 vertices , there exist boundaries @xmath1483 , @xmath1484 so that @xmath1485 . the word @xmath1486 $ ] is a label of a cycle @xmath1487 of the graph @xmath1482 for which @xmath1488 .    recall that by @xmath1489 we denote the homomorphism @xmath1490 induced by the elementary transformations .",
    "it remains to prove the existence of a cycle @xmath1491 of the graph @xmath92 for which @xmath1492 . to do this",
    ", it suffices to show that for every path @xmath1493 in the graph @xmath1494 there exists a path @xmath1495 in the graph @xmath1445 such that @xmath1496 . in turn , it suffices to verify the latter statement in the case when @xmath1497 is an edge @xmath1079 .    the generalised equation @xmath1439 is obtained from @xmath584 by @xmath246-tying a boundary @xmath623 .",
    "below we use the notation from the definition of the elementary transformation @xmath685 .    1 .",
    "either we introduce a boundary connection @xmath327 . in this case every variable @xmath1378 of the generalised equation @xmath1439 is also a variable of the generalised equation @xmath584 and the statement is obvious ; 2 .   or we introduce a new boundary @xmath1498 between the boundaries @xmath626 and @xmath691 , and a boundary connection @xmath1499 . using the boundary equations we get @xmath1500}^{-1}h[\\alpha ( \\delta(\\mu ) ) , q ' ] = { h[\\alpha ( \\delta ( \\mu ) ) , q]}^{-1}h[\\alpha ( \\mu ) , p],\\\\ & \\pi ( v_i , v_{i+1})^{-1}(h_{q'})= { h[\\alpha(\\delta(\\mu ) ) , q']}^{-1 } h[\\alpha ( \\delta ( \\mu ) ) , q+1]={h[\\alpha(\\mu ) , p]}^{-1 } h[\\alpha ( \\delta ( \\mu ) ) , q+1 ] .",
    "\\end{split}\\end{gathered}\\ ] ] moreover , @xmath1501 for any other variable .",
    "notice that since @xmath1131 , the right - hand sides of equations ( [ eq : theseform ] ) are labels of paths in @xmath1445 .",
    "thus , we have deduced that there exists a cycle @xmath1502 so that @xmath1503 .",
    "[ lem:23 - 2 ] let @xmath314 be a generalised equation with no boundary connections .",
    "suppose that @xmath235 is regular with respect to a periodic structure @xmath985 .",
    "then there exists a computable function @xmath1504 such that , for every @xmath939-periodic solution @xmath2 of @xmath235 such that @xmath1505 and such that @xmath2 is minimal with respect to @xmath937 , the following inequality holds @xmath1506    let @xmath2 be a @xmath939-periodic minimal solution with respect to the group of automorphisms @xmath937 .",
    "notice that @xmath2 is also minimal with respect to the trivial group of automorphisms .",
    "we first prove that for any regular periodic structure and any @xmath939-periodic solution @xmath2 of @xmath235 minimal with respect to the group of automorphisms @xmath937 , the exponent of periodicity of every simple cycle @xmath1124 , @xmath1168 is bounded by a certain computable function @xmath1507 .",
    "if for every @xmath26 we have @xmath1508 , the statement follows .",
    "we further assume that there exists @xmath26 such that @xmath1509 .    since the periodic structure is regular , either @xmath1510 and for all @xmath1148 so that @xmath1149 we have @xmath1511 , or @xmath1512 .",
    "assume first that , @xmath1394 .",
    "since the periodic structure @xmath1073 is regular , it follows that @xmath1511 for all @xmath1168 , @xmath1513 .",
    "since @xmath1514 is a solution of @xmath235 , it follows that @xmath1515 , @xmath992 . therefore , @xmath1516 for all @xmath100 such that @xmath1517 . by ( [ 2.54 ] )",
    ", we have that @xmath1518<\\infty$ ] , hence we get that @xmath1516 for all @xmath100 such that @xmath1519 . consequently , since the only non - trivial cycle at @xmath1119 is @xmath1520 , by lemma [ lem:23 - 1.5 ] , we get that @xmath1521 . using factorisation ( [ 2.54 ] )",
    ", one can effectively express @xmath1147 , @xmath1148 in terms of the elements of the basis : @xmath1522 hence @xmath1523 , and we finally obtain latexmath:[\\[\\label{2.64 }    where @xmath77 is a certain computable function .",
    "suppose next that @xmath1525 , i.e. @xmath1526 . as we have already seen in the proof of lemma  [ lem : spl1 ] , @xmath1527 , where @xmath1148 , @xmath1528 .",
    "hence , @xmath1229 for all @xmath1079 such that @xmath1528 . since @xmath1529 ,",
    "for every @xmath1530 one can effectively construct the following equality @xmath1531 hence , @xmath1532 .",
    "we now address the statement of the lemma .",
    "the way we proceed is as follows . for a @xmath939-periodic solution @xmath2 minimal with respect to the group of automorphisms @xmath937 ,",
    "we show that the vector that consists of exponents of periodicity of each of the components @xmath1478 of @xmath2 is bounded by a minimal solution of a linear system of equations whose coefficients depend only on the generalised equation .",
    "since by lemma 1.1 from @xcite , the components of a minimal solution of a linear system of equations are bounded above by a recursive function of the coefficients of the system , we then get a recursive bound on the exponents of periodicity of the components of the solution @xmath2 .",
    "let @xmath1533 .",
    "denote by @xmath1534 the algebraic sum of occurrences of the edge with the label @xmath354 in the cycle @xmath100 , ( i.e. edges with different orientation contribute with different signs ) .",
    "for every item @xmath354 that belongs to a closed section from @xmath988 one can write @xmath1535 note that in the case that @xmath1536 , the above equality is graphical . however , in the case that @xmath1207 and @xmath1478 is a subword of @xmath951 there is cancellation .",
    "direct calculations show that @xmath1537 by lemma [ lem:23 - 1.5 ] , @xmath1530 can be chosen in such a way that @xmath1538 .",
    "let @xmath1539 , where @xmath1540 .",
    "equation ( [ 2.66 ] ) implies that the vector @xmath1541 is a solution of the following system of diophantine equations in variables @xmath1542 : @xmath1543 note that the number of variables of the system ( [ 2.67 ] ) is bounded .",
    "furthermore , as we have proven above , free terms @xmath1544 of this system are also bounded above , and so are the coefficients @xmath1545 for @xmath1546 .",
    "a solution @xmath1547 of a system of linear diophantine equations is called _ minimal _ , see @xcite , if @xmath1548 and there is no other solution @xmath1549 such that @xmath1550 for all @xmath229 , and at least one of the inequalities @xmath1551 is strict .",
    "let us verify that the solution @xmath1552 of system ( [ 2.67 ] ) is minimal .",
    "indeed , let @xmath1553 be another solution of system ( [ 2.67 ] ) such that @xmath1550 for all @xmath229 , and at least for one @xmath229 the inequality is strict .",
    "let @xmath1554 .",
    "define a vector @xmath1313 as follows : @xmath1555 if @xmath1227 , and @xmath1556 if @xmath1039 .",
    "we now show that @xmath1313 is a solution of the generalised equation which can be obtained from @xmath2 by an automorphism from @xmath937 .",
    "the vector @xmath1313 satisfies all the coefficient , factor and basic equations of @xmath235 and type constraints .",
    "indeed , since @xmath1549 is a solution of system ( [ 2.67 ] ) , @xmath1557 .",
    "therefore , for every cycle @xmath100 we have @xmath1558 and , in particular , @xmath1559 .",
    "thus the vector @xmath1313 is a solution of the system @xmath1560 .    by construction",
    "every component of the solution @xmath1313 is non - empty , has the same type as the respective component of @xmath2 , and the words @xmath1561 , @xmath1562 are reduced as written . on the other hand , for every @xmath246 we have",
    "@xmath1563 it follows that @xmath1564 thus , @xmath1313 is a solution of the generalised equation @xmath235 .",
    "denote by @xmath1565 an element from the group of automorphisms @xmath937 defined in the following way .",
    "for every @xmath1566 , @xmath319 set @xmath1567 therefore , if @xmath1568 and @xmath1569 , then @xmath1570 , and all the other components of @xmath1295 are the same as in @xmath2 , @xmath1571 , @xmath1572 . denote by @xmath1573 , where @xmath1574 , @xmath1575 .",
    "let us verify the equality @xmath1576    let @xmath1577 .",
    "then , by construction , @xmath1578 for all @xmath229 such that @xmath354 is the label of an edge from @xmath1184 .",
    "if the edge labelled by @xmath354 belongs to @xmath1185 , or @xmath354 does not belong to a closed section from @xmath988 , then @xmath1227 and @xmath1579 . finally , for every @xmath1148 we have @xmath1580 .",
    "as @xmath1581 , where @xmath1209 , @xmath1210 are paths in the tree @xmath582 , and for every item @xmath354 which labels an edge from @xmath582 , the equality @xmath1582 has already been established , so it follows that @xmath1583 .",
    "this proves ( [ 2.69 ] ) .",
    "since @xmath1313 is a solution of @xmath235 , since by construction @xmath1313 satisfies condition ( [ it : minsol3 ] ) from definition [ defn : sol < ] and by ( [ 2.69 ] ) , it follows that @xmath1584 .",
    "we arrive to a contradiction with the minimality of the solution @xmath1514 .",
    "consequently , the solution @xmath1552 of system ( [ 2.67 ] ) is minimal .",
    "lemma 1.1 from @xcite states that the components of the minimal solution @xmath1552 are bounded by a recursive function of the coefficients , the number of variables and the number of equations of the system .",
    "since , as shown above , all of these parameters of system ( [ 2.67 ] ) are bounded above by a computable function , the lemma follows .",
    "in section [ se:5 ] we constructed an infinite tree @xmath830 .",
    "though for every solution @xmath2 the path in @xmath830 @xmath1586 defined by the solution @xmath2 is finite , in general , there is no global bound for the length of these paths .",
    "informally , the aim of this section is to prove that the set of solutions of the generalised equation @xmath235 can be parametrised by a finite subtree @xmath1185 ( to be constructed below ) of the tree @xmath582 , automorphisms from a finitely generated group of automorphisms of the coordinate group @xmath761 , and solutions of the generalised equations associated to leaves of @xmath1185 .",
    "in other words , we prove that there exists a global bound @xmath1587 , such that for any solution @xmath2 of @xmath235 one can effectively construct a path @xmath1588})\\to(\\omega_{v_1},h^{[1]})\\to\\dots$ ] in @xmath830 of length bounded above by @xmath1587 and such that @xmath1589}<_{\\operatorname{aut}(\\omega ) } h$ ] for all @xmath26 , where @xmath1590 is the group of automorphisms of @xmath761 defined in section [ 5.5.3 ] , see definition [ defn : aut ] ( note the abuse of notation : @xmath1589}$ ] and @xmath2 are solutions of different generalised equations ; in fact this relation is between two solutions of @xmath235 : a solution induced by @xmath1589}$ ] and @xmath2 ; see below for a formal definition ) .",
    "we summarise the results of this section in the proposition below .",
    "[ prop : sum5 ] for a generalised equation @xmath831 , one can effectively construct a _",
    "finite _ oriented rooted at @xmath111 tree @xmath1185 , @xmath1591 , such that :    1 .",
    "the tree @xmath1185 is a subtree of the tree @xmath830 .",
    "2 .   to the root @xmath111 of @xmath1185",
    "we assign a finitely generated group of automorphisms @xmath1592 ( see definition [ defn : aut ] ) .",
    "3 .   for any solution @xmath2 of a generalised equation @xmath314",
    "there exists a leaf @xmath948 of the tree @xmath1585 , @xmath1593 , and a solution @xmath1594}$ ] of the generalised equation @xmath1595 such that * @xmath1596}<_{\\operatorname{aut}(\\omega ) } h$ ] ; * if @xmath1597 and the generalised equation @xmath1598 contains non - constant non - active sections , then there exists a period @xmath939 such that @xmath1594}$ ] is periodic with respect to the period @xmath939 and the generalised equation @xmath1595 is singular with respect to the periodic structure @xmath1599},p)$ ] .",
    "this section is organised in three subsections .",
    "the aim of section [ 5.5.2 ] is to define the finitely generated group of automorphisms @xmath1600 of the coordinate group of the generalised equation @xmath588 associated to @xmath95 , @xmath1601 .    in section [ 5.5.3 ]",
    ", we define a finite subtree @xmath1602 of the tree @xmath830 . in order to define @xmath1602",
    "we introduce the notions of prohibited paths of type 7 - 10 , 12 and 15 . using lemma [ 3.2 ] , we prove that any infinite branch of the tree @xmath830 contains a prohibited path .",
    "the tree @xmath1602 is defined to be a subtree of @xmath830 that does not contain prohibited paths and , by construction , is finite .",
    "we then define a finitely generated group of automorphisms @xmath1592 that we assign to the root vertex of the tree @xmath1602 .",
    "the group @xmath1592 is generated by conjugates of the groups @xmath1600 , @xmath1603 , @xmath1604 .    finally , in section [ 5.5.4 ] for any solution @xmath2 of @xmath235 we construct the path @xmath1605 from the root @xmath111 to @xmath948 , prove that @xmath948 is a leaf of the tree @xmath1602 and show that the leaf @xmath948 satisfies the properties required in proposition [ prop : sum5 ] .      to every vertex @xmath95 of the tree @xmath830 , we assign a finitely generated group @xmath1600 of automorphisms of @xmath1606 .    if @xmath1607 , set @xmath1600 to be the group generated by all the groups of automorphisms @xmath1608 corresponding to _ regular _ periodic structures on @xmath588 , see definition [ defn : aa ] .",
    "let @xmath1609 .",
    "let @xmath1610 be obtained from @xmath1611 by removing all equations corresponding to constant bases and all bases from the kernel of @xmath588 .",
    "let @xmath557 be the natural homomorphism from @xmath1612 to @xmath1613 .",
    "an automorphism @xmath1278 of the coordinate group @xmath1613 is called _ invariant with respect to the kernel _ if it is induced by an automorphism @xmath1614 of the coordinate group @xmath1612 identical on the kernel of @xmath588 , i.e. there exists a @xmath0-automorphism @xmath1614 of the coordinate group @xmath1612 so that @xmath1615 for every variable @xmath1616 and the following diagram commutes @xmath1617 in this case , we define @xmath1600 to be the group of automorphisms of @xmath1606 invariant with respect to the kernel .",
    "[ lem : razker ] there exists a finitely presented subgroup @xmath120 of the group of automorphisms of the automorphism group of @xmath361 $ ] such that every automorphism from @xmath120 induces an automorphism of @xmath1618 $ } \\!\\mathord{\\left/ { \\vphantom { g[h ] { \\operatorname{ncl}\\langle\\omega_v\\rangle}}}\\right.\\kern-\\nulldelimiterspace } \\!\\lower0.7ex\\hbox{${\\operatorname{ncl}\\langle\\omega_v\\rangle}$}}}$ ] , which , in turn , induces an automorphism of the coordinate group @xmath1619 .",
    "the finitely generated group of all automorphisms @xmath1620 of @xmath1619 induced by automorphisms from @xmath120 contains all the automorphisms invariant respect to the kernel of @xmath588 .    by lemma [ 7 - 10 ] , for any generalised equation @xmath235 we have",
    "@xmath1621 it follows that , in the above notation , @xmath1622 .",
    "let @xmath120 be the group of @xmath0-automorphisms of @xmath1623 that fix every element from @xmath1624 , i.e. @xmath120 is the automorphism group of the free group @xmath752 .",
    "it follows that @xmath120 is finitely presented , see @xcite .",
    "furthermore , every automorphism from @xmath120 induces an automorphism of @xmath1606 and the following diagram commutes : @xmath1625 it follows that the group of induced automorphisms @xmath1620 by @xmath120 of @xmath1606 is finitely generated and contains all automorphisms of @xmath1606 invariant with respect to the kernel of @xmath588 .",
    "let @xmath1626 . apply",
    "derived transformation @xmath718 and consider the generalised equation @xmath1627 .",
    "notice that , since every boundary in the active part of @xmath1628 that touches a base and intersects another base @xmath246 is @xmath246-tied ( i.e. assumptions of case 14 do not hold ) , the function @xmath1629 is constant on closed sections of @xmath876 , i.e. @xmath1630 whenever @xmath289 and @xmath303 belong to the same closed section of @xmath876 . applying @xmath677 , we can assume that every item in the section @xmath1631 $ ] is covered exactly twice ( i.e. @xmath797 for every @xmath1632 ) and for all @xmath1633 we have @xmath1634 .",
    "in this case we call the section @xmath1631 $ ] _ the quadratic part of @xmath588_. we sometimes refer to the set of non - quadratic sections of the generalised equation @xmath588 as to the _ non - quadratic part _ of @xmath588",
    ".    let @xmath1635 .",
    "then the _ quadratic part of @xmath588 _ is the whole active part of @xmath588 .    a variable base @xmath246 of the generalised equation @xmath235",
    "is called a if @xmath778 and its dual @xmath247 both belong to the quadratic part of @xmath235 .",
    "a base @xmath246 of the generalised equation @xmath235 is called a _ quadratic - coefficient base _",
    "if @xmath246 belongs to the quadratic part of @xmath235 and its dual @xmath247 does not belong to the quadratic part of @xmath235 .",
    "let @xmath1635 or @xmath1626 and let @xmath1631 $ ] be the quadratic part of @xmath588",
    ". denote by @xmath1610 the generalised equation obtained from @xmath588 by removing all non - quadratic bases , all quadratic - coefficient bases and all equations corresponding to constant bases .",
    "let @xmath1636 be the natural homomorphism from @xmath1618 $ } \\!\\mathord{\\left/ { \\vphantom { g[h ] { \\operatorname{ncl}\\langle\\widehat{\\omega}^*_v\\rangle}}}\\right.\\kern-\\nulldelimiterspace } \\!\\lower0.7ex\\hbox{${\\operatorname{ncl}\\langle\\widehat{\\omega}^*_v\\rangle}$}}}$ ] to @xmath1613 .    by lemma 2.6 in @xcite",
    ", @xmath1637 is equivalent to a system of quadratic equations @xmath1638 , where the sets of variables @xmath1639 and @xmath1640 are disjoint if @xmath1641 .",
    "it follows that the group @xmath1618 $ } \\!\\mathord{\\left/ { \\vphantom { g[h ] { \\operatorname{ncl}\\langle\\widehat{\\omega}_v\\rangle}}}\\right.\\kern-\\nulldelimiterspace } \\!\\lower0.7ex\\hbox{${\\operatorname{ncl}\\langle\\widehat{\\omega}_v\\rangle}$}}}$ ] is isomorphic to @xmath1642 , where @xmath216 , @xmath1643 is the fundamental group of a surface .",
    "an automorphism @xmath1278 of the coordinate group @xmath1613 is called _ invariant with respect to the non - quadratic part _ ,",
    "if there exists an automorphism @xmath1644 of the group @xmath1618 $ } \\!\\mathord{\\left/ { \\vphantom { g[h ] { \\operatorname{ncl}(\\widehat{\\omega}^*_v)}}}\\right.\\kern-\\nulldelimiterspace } \\!\\lower0.7ex\\hbox{${\\operatorname{ncl}(\\widehat{\\omega}^*_v)}$}}}\\simeq g\\ast s_1\\ast\\dots\\ast s_k$ ] so that : @xmath1645 , where @xmath1646 is an automorphism of @xmath216 ; for every quadratic - coefficient base @xmath344 of @xmath588 one has @xmath1647 ; for every @xmath289 , @xmath1648 ( recall that @xmath1631 $ ] is the quadratic part of @xmath588 ) one has @xmath1649 , and the following diagram commutes : @xmath1650 $ } \\!\\mathord{\\left/ { \\vphantom { g[h ] { \\operatorname{ncl}\\langle\\widehat{\\omega}^*_v\\rangle}}}\\right.\\kern-\\nulldelimiterspace } \\!\\lower0.7ex\\hbox{${\\operatorname{ncl}\\langle\\widehat{\\omega}^*_v\\rangle}$ } } } @>\\phi > > g_{r(\\omega_v^ * ) } \\\\",
    "@v \\hat{\\varphi } vv                                @vv\\varphi v   \\\\    { { \\raise0.7ex\\hbox{$g[h]$ }",
    "\\!\\mathord{\\left/ { \\vphantom { g[h ] { \\operatorname{ncl}\\langle\\widehat{\\omega}^*_v\\rangle}}}\\right.\\kern-\\nulldelimiterspace } \\!\\lower0.7ex\\hbox{${\\operatorname{ncl}\\langle\\widehat{\\omega}^*_v\\rangle}$ } } } @>>\\phi > g_{r(\\omega_v^ * ) } \\endcd\\ ] ] in this case , we define @xmath1600 to be the group of automorphisms of @xmath1606 invariant with respect to the non - quadratic part .    [",
    "lem : raznqp ] there exists a finitely presented subgroup @xmath120 of the group of automorphisms of @xmath361 $ ] such that every automorphism from @xmath120 induces an automorphism of @xmath1618 $ } \\!\\mathord{\\left/ { \\vphantom { g[h ] { \\operatorname{ncl}\\langle\\omega_v\\rangle}}}\\right.\\kern-\\nulldelimiterspace } \\!\\lower0.7ex\\hbox{${\\operatorname{ncl}\\langle\\omega_v\\rangle}$}}}$ ] , which , in turn , induces an automorphism of the coordinate group @xmath1613 .",
    "the finitely generated group @xmath1620 of all automorphisms of @xmath1613 induced by automorphisms from @xmath120 is the group of all automorphisms invariant with respect to the non - quadratic part of @xmath588 .",
    "since the group of automorphisms of the fundamental group of a surface is isomorphic to the stabiliser of a cyclic quadratic word in the free group , by a result of j.  mccool , see @xcite , it follows that the group of automorphisms @xmath120 of @xmath361 $ ] so that every automorphism from @xmath120 induces an automorphism from @xmath1618 $ } \\!\\mathord{\\left/ { \\vphantom { g[h ] { \\operatorname{ncl}(\\widehat{\\omega}^*_v)}}}\\right.\\kern-\\nulldelimiterspace } \\!\\lower0.7ex\\hbox{${\\operatorname{ncl}(\\widehat{\\omega}^*_v)}$}}}$ ] , so that @xmath1647 for every quadratic - coefficient base @xmath344 of @xmath588 and @xmath1649 for every @xmath289 , @xmath1648 is finitely presented . since , by the definition @xmath1647 for every quadratic - coefficient base @xmath344 of @xmath588 and @xmath1649 for every @xmath289 , @xmath1648 , every automorphism from @xmath120 induces an automorphism of @xmath1619 and",
    "the diagram above is commutative .",
    "hence , the group of all automorphisms invariant with respect to the non - quadratic part of @xmath588 is finitely generated .",
    "in all other cases set @xmath1651 .      the aim of this section is to construct the finite subtree @xmath1602 of @xmath830 as the subtree that does not contain prohibited paths .",
    "the definition of a prohibited path is designed in such a way that the paths @xmath1605 in the tree @xmath582 associated to the solution @xmath2 do not contain them .",
    "therefore , the nature of the definition of a prohibited path will become clearer in section [ 5.5.4 ] .    by lemma",
    "[ 3.2 ] , infinite branches of the tree @xmath830 correspond to the following cases : @xmath1652 for all @xmath229 , or @xmath1653 for all @xmath229 , or @xmath1654 for all @xmath229 .",
    "we now define prohibited paths of types 7 - 10 , 12 and 15 .",
    "we call a path @xmath1655 in @xmath846 if @xmath1656 for all @xmath1657 and some generalised equation with @xmath455 variables occurs among @xmath1658 at least @xmath1659 times .",
    "similarly , a path @xmath1655 in @xmath846 is called if @xmath1660 for all @xmath1657 and some generalised equation with @xmath455 variables occurs among @xmath1658 at least @xmath1659 times .",
    "we now prove that an infinite branch of @xmath830 of type 7 - 10 or 12 contains a prohibited path of type 7 - 10 or 12 , correspondingly .",
    "[ 3.3 ] let @xmath1661 be an infinite path in the tree @xmath830 , where @xmath1662 for all @xmath26 , and let @xmath1663 be the sequence of corresponding generalised equations . then among @xmath1664 some generalised equation occurs infinitely many times . furthermore ,",
    "if @xmath1665 , then @xmath1666 is a @xmath0-automorphism of @xmath1667 invariant with respect to the kernel of @xmath1668 .    by lemma [ 3.1 ] , we have that @xmath1669 and @xmath1670 for all @xmath229 .",
    "we , therefore , may assume that @xmath1671 and @xmath1672 for all @xmath229 .",
    "it follows that all the transformations @xmath685 introduce a new boundary .    for all @xmath229 , the generalised equations @xmath1673 have the same set of bases , recall that @xmath1674 .",
    "indeed , consider the generalised equations @xmath1675 and @xmath1676 .",
    "since @xmath1677 , the active part of @xmath1678 does not contain constant bases .    if @xmath1679 , then @xmath1676 is obtained from @xmath1675 by cutting some base @xmath246 which is eliminable in @xmath1675 and then deleting one of the new bases , which is also eliminable , since it falls under the assumption a ) of the definition of an eliminable base .",
    "since every transformation @xmath685 introduces a new boundary , the remaining part of the base @xmath246 falls under the assumption b ) of the definition of an eliminable base .",
    "therefore , in this case , the set of bases that belong to the kernel does not change .",
    "let @xmath1680 .",
    "it suffices to show that , in the notation of case 9 , all the bases of @xmath1676 obtained by cutting the base @xmath730 do not belong to the kernel . without loss of generality",
    "we may assume that @xmath1681 is a closed section of @xmath1678 .",
    "indeed , if @xmath1681 is not closed , instead , we can consider one of its closed subsections @xmath1682 in the generalised equation @xmath1678 .",
    "notice that , since @xmath1681 is closed , every boundary that intersects @xmath729 and @xmath730 in @xmath1668 , touches exactly two bases in @xmath1678 .",
    "thus , for every boundary connection @xmath1683 in @xmath1684 either the boundary @xmath623 or the boundary @xmath626 touches exactly two bases in @xmath1676 .",
    "construct an elimination process ( see description of the derived transformation @xmath722 ) for the generalised equation @xmath1678 and take the first generalised equation @xmath732 in this elimination process , such that the base @xmath344 eliminated in this equation was obtained from either @xmath729 or @xmath730 or @xmath1685 or @xmath1686 by applying @xmath718 to @xmath1687 .",
    "the base @xmath344 could not be obtained from @xmath868 or @xmath869 , since every item in the section @xmath1681 is covered twice and every boundary in this section touches two bases .",
    "if @xmath344 falls under the assumption of case b ) of the definition of an eliminable base , then @xmath1688 we now construct an elimination process for the generalised equation @xmath1676 .",
    "the first @xmath26 steps of the elimination process for @xmath1676 coincide with the first @xmath26 steps of the elimination process constructed for the generalised equation @xmath1678 .",
    "then the eliminable base @xmath344 of @xmath1689 corresponds to a base @xmath1690 obtained from either @xmath730 or @xmath1686 by applying @xmath718 to @xmath1691 .",
    "the base @xmath1692 is eliminable .",
    "notice that one of the boundaries @xmath1693 , @xmath1694 , @xmath1695 or @xmath1695 touches just two bases .",
    "therefore , after eliminating @xmath1692 , this boundary touches just one base @xmath385 that was obtained from @xmath730 or @xmath1696 .",
    "the base @xmath385 falls under the assumptions b ) of the definition of an eliminable base .",
    "repeating this argument , one can subsequently eliminate all the other bases obtained from @xmath869 or @xmath1696 .",
    "it follows that all the bases of the generalised equation @xmath1697 , obtained from @xmath869 or @xmath1696 do not belong to the kernel .",
    "we thereby have shown that the set of bases is the same for all the generalised equations @xmath1698 and thus the set of bases is the same for all the generalised equations @xmath1698 .",
    "we denote the cardinality of this set by @xmath1699 .",
    "we now prove that the number of bases in the active sections of @xmath1700 , for all @xmath229 , is bounded above by a function of @xmath581 : @xmath1701 indeed , assume the contrary and let @xmath229 be minimal for which inequality ( [ 3.2 ] ) fails .",
    "then @xmath1702 by lemma [ 3.1 ] , @xmath1703 .",
    "in particular the generalised equation @xmath1704 fails the assumptions of cases @xmath1705 .",
    "therefore , every active section of @xmath1706 either contains at least three bases or contains some base of the generalised equation @xmath1707 .",
    "let @xmath1708 and @xmath1709 be the number of active sections of @xmath1704 that contain one base and more than one base , respectively . hence @xmath1710 .",
    "it is easy to see that @xmath1711 then , @xmath1712 , which contradicts ( [ 3.3 ] ) .",
    "furthermore , the number @xmath1713 of items in the active part of @xmath1668 is bounded above : @xmath1714 since the number of bases and number of items is bounded above , the set @xmath1715 is finite and thus some generalised equation occurs in this set infinitely many times .",
    "let @xmath1716 .",
    "since , by assumption , the edges @xmath1717 , @xmath1718 are labelled by isomorphisms , the homomorphism @xmath1719 is an automorphism of the coordinate group @xmath1667 .",
    "we are left to show that @xmath1719 is invariant with respect to the kernel . as shown above , @xmath1720 from the above",
    ", it follows that @xmath1721 is obtained from @xmath1722 by introducing new boundaries and removing some of the items that do not belong to the kernel of @xmath1723 .",
    "therefore , the number of items that belong to the kernel @xmath1721 can only increase .",
    "as @xmath1724 , so this number is the same for all @xmath26 , @xmath1725 .",
    "it follows that @xmath1726 for all @xmath289 that belong to the kernel of @xmath1668 .    since the transformations that take the generalised equation @xmath1727 to @xmath1676 do not involve bases that belong to the kernel of @xmath1727",
    ", the same sequence of transformations can be applied to the generalised equation @xmath1728 , where @xmath1728 is obtained from @xmath1727 by removing all equations corresponding to constant bases and all bases that belong to the kernel of @xmath1678 .",
    "since , by assumption , every time we @xmath246-tie a boundary a new boundary is introduced , we get that the epimorphism from @xmath1729 to @xmath1730 is , in fact , an isomorphism .",
    "we therefore get the following commutative diagram ( see the definition of an automorphism invariant with respect to the kernel , section [ 5.5.2 ] ) : @xmath1731 it follows that the automorphism @xmath1719 is invariant with respect to the kernel of @xmath1732 .",
    "[ cor : proh710 ] let @xmath1733 be an infinite path in the tree @xmath830 , and @xmath1734 for all @xmath26",
    ". then @xmath98 contains a prohibited subpath of type 7 - 10 .",
    "[ lem : c12 ] let @xmath1661 be an infinite path in the tree @xmath830 , where @xmath1735 for all @xmath26 , and @xmath1663 be the sequence of corresponding generalised equations . then among @xmath1664 some generalised equation occurs infinitely many times . furthermore ,",
    "if @xmath1665 , then @xmath1666 is a @xmath0-automorphism of the coordinate group @xmath1667 invariant with respect to the non - quadratic part .",
    "notice that since @xmath1736 is a quadratic generalised equation , quadratic - coefficient bases of @xmath1736 are bases whose duals belong to the non - active part .",
    "let @xmath1737 be the carrier base of the generalised equation @xmath1736 .",
    "consider the sequence @xmath1738 of carrier bases . by lemma",
    "[ 3.1 ] , if @xmath1739 , then @xmath1740 . furthermore ,",
    "if the carrier base @xmath731 is quadratic - coefficient , then this inequality is strict . hence , it suffices to consider the case when all carrier bases are quadratic .",
    "the number of consecutive quadratic bases in the sequence @xmath1741 is bounded above . indeed , by lemma [ 3.1 ] ,",
    "when the entire transformation is applied , the complexity of the generalised equation does not increase .",
    "furthermore , since the generalised equation is quadratic and does not contain free boundaries , the number of items does not increase .",
    "the number of generalised equations with a bounded number of items and bounded complexity is finite and thus some generalised equation occurs in the sequence @xmath1664 infinitely many times .",
    "obviously , if @xmath1716 , then @xmath1666 is a @xmath0-automorphism of @xmath1667 .",
    "we are left to show that @xmath1719 is invariant with respect to the non - quadratic part .    from the definition of the entire transformation @xmath678",
    ", it follows that the number of items that belong to a given quadratic - coefficient base can only increase .",
    "as @xmath1724 , so this number is the same for all @xmath26 , @xmath1742 .",
    "it follows that @xmath1726 for all @xmath289 that belong to a quadratic - coefficient base .    since the transformations that take the generalised equation @xmath1727 to @xmath1676 involve only quadratic bases of @xmath1727 , the same sequence of transformations can be applied to the generalised equation @xmath1728 , where @xmath1728 is the generalised equation obtained from @xmath1678 by removing all non - quadratic bases , all quadratic - coefficient bases and all coefficient equations .",
    "since , by assumption , every time we @xmath246-tie a boundary a new boundary is introduced , we get that the epimorphism from @xmath1729 to @xmath1730 is , in fact , an isomorphism .",
    "we therefore get the following commutative diagram ( see the definition of an automorphism invariant with respect to the non - quadratic part , section [ 5.5.2 ] ) : @xmath1743 $ } \\!\\mathord{\\left/ { \\vphantom { g[h ] { \\operatorname{ncl}\\langle\\widehat{\\omega}_{v_k}\\rangle}}}\\right.\\kern-\\nulldelimiterspace } \\!\\lower0.7ex\\hbox{${\\operatorname{ncl}\\langle\\widehat{\\omega}_{v_k}\\rangle}$ } } }    @>{\\phi } > > g_{r({\\omega_{v_k}}^ * ) } \\\\",
    "@vvv         @vv\\pi ( v_k , v_l)'v   \\\\",
    "{ { \\raise0.7ex\\hbox{$g[h]$ } \\!\\mathord{\\left/ { \\vphantom { g[h ] { \\operatorname{ncl}\\langle\\widehat{\\omega}_{v_l}\\rangle}}}\\right.\\kern-\\nulldelimiterspace } \\!\\lower0.7ex\\hbox{${\\operatorname{ncl}\\langle\\widehat{\\omega}_{v_l}\\rangle}$ } } }   @>{\\phi } > > g_{r({\\omega_{v_{l}}}^ * ) } \\endcd\\ ] ] it follows that the automorphism @xmath1719 is invariant with respect to the non - quadratic part of @xmath1668 .    [ cor : proh12 ] let @xmath1733 be an infinite path in the tree @xmath830 , and @xmath1660 for all @xmath26 .",
    "then @xmath98 contains a prohibited subpath of type 12 .    below we shall define prohibited paths of type 15 in @xmath846 . in this case , the definition of a prohibited path is much more involved .",
    "we need some auxiliary definitions .",
    "recall that the complexity of a generalised equation @xmath314 is defined as follows : @xmath1744 where @xmath910 is the number of bases in @xmath601 .",
    "let @xmath1745 , where @xmath288 is the number of variables in the initial generalised equation @xmath314 and @xmath1746 is the number of free variables belonging to the non - active sections of the generalised equation @xmath859 .",
    "we have @xmath1747 ( see the proof of lemma [ 3.2 ] ) , hence @xmath1748 .",
    "if , in addition , @xmath1749 is an auxiliary edge , then @xmath1750 .",
    "we use induction on @xmath1751 to construct a finite subtree @xmath1752 of @xmath1753 , and the function @xmath1754 .",
    "the tree @xmath1752 is a rooted tree at @xmath95 and consists of some of the vertices and edges of @xmath830 that lie above @xmath95 .",
    "suppose that @xmath1755 .",
    "it follows that @xmath1756 .",
    "then in @xmath830 there are no auxiliary edges .",
    "furthermore , since @xmath1756 , it follows that every closed active section contains at most two bases and so no vertex of type 15 lies above @xmath95 .",
    "we define the subtree @xmath1752 as follows .",
    "the set of vertices of @xmath1752 consists of all vertices @xmath1757 of @xmath830 that lie above @xmath95 , and so that the path from @xmath95 to @xmath1757 does not contain prohibited subpaths of types 7 - 10 and 12 . by corollary [ cor : proh710 ] and corollary [ cor : proh12 ]",
    ", @xmath1752 is finite .",
    "let @xmath1758 where @xmath1759 is taken over all the vertices of @xmath1760 for which @xmath1597 and @xmath1595 contains non - active sections ; @xmath1761 is taken over all regular periodic structures such that the generalised equation @xmath1762 is regular with respect to @xmath985 ; and @xmath1763 is the function defined in lemma [ lem:23 - 2 ] .",
    "suppose now that @xmath1764 .",
    "by induction , we assume that for all @xmath1757 such that @xmath1765 the finite tree @xmath1766 and @xmath1767 are already defined .",
    "furthermore , we assume that the full subtree of @xmath830 whose set of vertices consists of all vertices that lie above @xmath95 does not contain prohibited paths of type 7 - 10 and of type 12 .",
    "consider a path @xmath98 in @xmath830 : @xmath1768 where @xmath1769 , @xmath1770 and all the edges are principal .",
    "we have @xmath1771 .",
    "denote by @xmath1772 the carrier base of the generalised equation @xmath584 .",
    "path ( [ 3.6 ] ) is called _ @xmath246-reducing _ if @xmath1773 and either there are no auxiliary edges from the vertex @xmath1774 and @xmath246 occurs in the sequence @xmath1775 at least twice , or there are auxiliary edges @xmath1776 , @xmath1777 and @xmath246 occurs in the sequence @xmath1778 at least @xmath1779 times .",
    "we will show later , see equation ( [ 3.26 ] ) , that , informally , in any @xmath246-reducing path the length of the solution @xmath2 is reduced by at least @xmath1780 of the length of @xmath1781 , hence the terminology .",
    "[ defn : proh15 ] path ( [ 3.6 ] ) is called , if it can be represented in the form @xmath1782 where for some sequence of bases @xmath1783 the following three conditions are satisfied :    1 .",
    "[ it : prp2 ] the path @xmath1784 is @xmath1785-reducing ; 2 .",
    "[ it : prp1 ] every base @xmath731 that occurs at least once in the sequence @xmath1786 , occurs at least @xmath1787 times in the sequence @xmath1783 , where @xmath1788 is the number of all bases in the generalised equation @xmath584 , and @xmath1789 is the function from lemma [ 2.8 ] ; in other words , in a prohibited path of type 15 , for every carrier base @xmath731 there exists at least @xmath1787 many @xmath731-reducing paths .",
    "[ it : prp3 ] every transfer base of some generalised equation of the path @xmath98 is a transfer base of some generalised equation of the path @xmath104 .",
    "note that for any path of the form ( [ 3.6 ] ) in @xmath830 , there is an algorithm to decide whether this path is prohibited of type 15 or not .",
    "we now prove that any infinite branch of the tree @xmath830 of type 15 contains a prohibited subpath of type 15 .",
    "let @xmath1733 be an infinite path in the tree @xmath830 , and @xmath1790 for all @xmath26 .",
    "then @xmath98 contains a prohibited subpath of type 15 .",
    "let @xmath1791 be the set of all bases occurring in the sequence of carrier bases @xmath1792 infinitely many times , and @xmath1793 be the set of all bases that are transfer bases of infinitely many equations @xmath1736 .",
    "considering , if necessary , a subpath @xmath1794 of @xmath98 of the form @xmath1795 , one can assume that all the bases in the sequence @xmath1796 belong to @xmath1791 and every base which is a transfer base of at least one generalised equation belongs to @xmath1793 .",
    "then for any @xmath1797 the path @xmath1794 contains infinitely many non - intersecting @xmath246-reducing finite subpaths .",
    "hence there exists a subpath of the form ( [ 3.7 ] ) of @xmath1794 which satisfies conditions ( [ it : prp2 ] ) and ( [ it : prp1 ] ) of the definition of a prohibited path of type 15 , see definition [ defn : proh15 ] . taking a long enough subpath @xmath104 of @xmath98 , we obtain a prohibited subpath of @xmath98 .",
    "we now construct the tree @xmath1602 .",
    "let @xmath1798 be the subtree of @xmath1753 consisting of the vertices @xmath1757 such that the path from @xmath95 to @xmath1757 in @xmath830 does not contain prohibited subpaths and does not contain vertices @xmath1799 such that @xmath1800 . thus , the leaves of @xmath1798 are either vertices @xmath1757 such that @xmath1801 or leaves of @xmath1753 .    the subtree @xmath1798 can be effectively constructed .",
    "the tree @xmath1752 is obtained from @xmath1798 by attaching ( gluing ) @xmath1766 ( which is already constructed by the induction hypothesis ) to those leaves @xmath1757 of @xmath1802 for which @xmath1765 . the function @xmath1803 is defined by ( [ so ] ) . set @xmath1804 , which is finite by construction .",
    "[ defn : aut ] denote by @xmath1592 , @xmath831 , the group of automorphisms of @xmath537 , generated by all the groups @xmath1805 , @xmath1603 , @xmath1604 ( thus @xmath856 is an isomorphism ) .",
    "note that by construction the group @xmath1806 is finitely generated .",
    "we adopt the following convention . given two solutions @xmath801 of @xmath584 and @xmath1807 of @xmath1444 , by @xmath1808 we mean @xmath1809 .",
    "[ cor:2.1 ] let @xmath1810 be the path defined by the solution @xmath2 .",
    "if @xmath2 is a minimal solution with respect to the group of automorphisms @xmath1592 , then @xmath801 is a minimal solution of @xmath1736 with respect to the group @xmath1811 for all @xmath26",
    ".    follows from lemma [ lem:2.1 ]      the goal of this section is to give a proof of the proposition below .",
    "[ 3.4 ] for any solution @xmath2 of a generalised equation @xmath314 there exists a leaf @xmath948 of the tree @xmath1585 , @xmath1593 , and a solution @xmath1594}$ ] of the generalised equation @xmath1595 such that    1 .   [ it : prop1 ] @xmath1596}<_{\\operatorname{aut}(\\omega ) } h$ ] ; 2 .",
    "[ it : prop2 ] if @xmath1597 and the generalised equation @xmath1598 contains non - constant non - active sections , then there exists a period @xmath939 such that @xmath1594}$ ] is periodic with respect to the period @xmath939 , and the generalised equation @xmath1595 is singular with respect to the periodic structure @xmath1599},p)$ ] .",
    "the proof of this proposition is rather long and technical .",
    "we now outline the organisation of the proof .    in part ( a ) , for any solution @xmath2 of @xmath235 we describe a path @xmath1812})\\to \\dots \\to ( \\omega_{v_l } , h^{[l]})$ ] , where @xmath1589}<_{\\operatorname{aut}(\\omega ) } h$ ] .    in part",
    "( b ) we prove that all vertices of the paths @xmath1605 belong to the tree @xmath1185 . in order to do so we show that they do not contain prohibited subpaths . in steps ( i ) and",
    "( ii ) we prove that the paths @xmath1605 do not contain prohibited paths of type 7 - 10 and 12 , correspondingly .",
    "the proof is by contradiction : if @xmath1605 is not in @xmath1185 , the fact that a generalised equation repeats enough times , allows us to construct an automorphism that makes the solution shorter , contradicting its minimality .    to prove that the paths @xmath1605 do not contain prohibited paths of type 15 ( step ( iii ) ) we show , by contradiction , that on one hand , the length of minimal solutions is bounded above by a function of the excess ( see definition [ defn : excess ] for definition of excess ) , see equation ( [ 3.18 ] ) and",
    ", on the other hand the length of a minimal solution @xmath2 such that @xmath1605 contains a prohibited path of type 15 fails inequality ( [ 3.18 ] ) .",
    "finally , in part ( c ) we prove that the pair @xmath1813})$ ] , where @xmath948 is a leaf of type 2 , satisfies the properties required in proposition [ 3.4 ] .      to define the path @xmath1605 we shall make use of two functions @xmath1814 and @xmath1815 that assign to the pair @xmath1816 a pair @xmath1817 , where either @xmath1818 or there is an edge @xmath843 in @xmath830 .",
    "the function @xmath1814 can be applied to any pair @xmath1816 , where @xmath1819 and the function @xmath1815 can only be applied to a pair @xmath1816 , where @xmath1626 and there are auxiliary edges outgoing from the vertex @xmath95 .",
    "we now define the functions @xmath1814 and @xmath1815 .",
    "let @xmath1820 or @xmath1821 and let @xmath1822 be the list of all _ principal _ outgoing edges from @xmath95 , then the generalised equations @xmath1823 are obtained from @xmath859 by a sequence of elementary transformations",
    ". for every solution @xmath2 the path defined by @xmath2 is unique , i.e. for the pair @xmath615 there exists a unique pair @xmath1824 such that the following diagram commutes : @xmath617_{\\pi_h } \\ar[rr]^{\\theta_i }   &   & g_{r(\\omega_{w_i}^\\ast ) } \\ar[ld]^{\\pi_{h^{(i ) } } }                                                                               \\\\                                 &   g & } \\ ] ] define a function @xmath1814 that assigns the pair @xmath1825 to the pair @xmath1826 , @xmath1827 .",
    "let @xmath1828 or @xmath1829 . in these cases",
    "there is a single edge @xmath1830 outgoing from @xmath95 and this edge is auxiliary .",
    "we set @xmath1831 .    if @xmath1626 and there are auxiliary outgoing edges from the vertex @xmath95 , then the carrier base @xmath246 of the generalised equation @xmath859 intersects with @xmath647 .",
    "below we use the notation from the description of case 15.1 . for any solution @xmath2 of the generalised equation",
    "@xmath588 one can construct a solution @xmath1295 of the generalised equation @xmath1832 as follows : @xmath1833 $ ] .",
    "we define the function @xmath1815 as follows @xmath1834 .    to construct the path @xmath1605 @xmath1835})\\to ( \\omega _ { v_1 } , h^{[1]})\\to\\ldots\\ ] ] we use induction on its length @xmath26 .",
    "let @xmath1409 , we define @xmath1836}$ ] to be a solution of the generalised equation @xmath235 minimal with respect to the group of automorphisms @xmath1592 , such that @xmath1836 } < _ { \\operatorname{aut}(\\omega ) } h$ ] .",
    "let @xmath1837 and suppose that the term @xmath1838})$ ] of the sequence ( [ 3.8 ] ) is already constructed .",
    "we construct @xmath1839})$ ]    if @xmath1840 , @xmath1841 , we set @xmath1842})={\\mathbf{e}}(\\omega _ { v_i},{h^{[i]}})$ ] .",
    "if @xmath1656 or @xmath1660 and there exists a minimal solution @xmath1313 of @xmath1736 such that @xmath1843}$ ] and @xmath1844}|$ ] , then we set @xmath1839})=(\\omega_{v_i } , h^+)$ ] .",
    "note that , since @xmath1836}$ ] is a minimal solution of @xmath235 with respect to the group of automorphisms @xmath1592 , by construction and by lemma [ cor:2.1 ] , we have that the solution @xmath1589}$ ] is minimal with respect to the group of automorphism @xmath1811 for all @xmath26 .",
    "although @xmath1589}$ ] is a minimal solution , in this step we take a minimal solution of minimal total length , see remark [ rem : ms ] .",
    "let @xmath1769 , @xmath1845 and @xmath1846 be the auxiliary edges outgoing from @xmath832 ( the carrier base @xmath246 intersects with its dual @xmath247 ) . if there exists a period @xmath939 such that @xmath1847}}[1,\\beta ( \\delta ( \\mu))]\\doteq p^rp_1,\\ p\\doteq p_1p_2 , \\ r\\ge \\max",
    "\\limits_{1\\leq i\\leq { { \\mathfrak{n } } } } { \\mathbf{s}}(\\omega _ { w_i}),\\ ] ] then we set @xmath1839 } ) = { \\mathbf{e}}'(\\omega _ { v_i},h^{[i]})$ ] and declare the section @xmath1848 $ ] non - active .",
    "in all the other cases ( when @xmath1769 ) we set @xmath1842})={\\mathbf{e}}(\\omega _ { v_i},{h^{[i]}})$ ] .    the path ( [ 3.8 ] ) ends if @xmath1849 .",
    "a leaf @xmath948 of the tree @xmath830 is called _ final _ if there exists a solution @xmath2 of @xmath581 and a path @xmath1605 such that @xmath1605 ends in @xmath948 .",
    "we use induction on @xmath1850 to show that every vertex @xmath832 of the path @xmath1605 ( see equation ( [ 3.8 ] ) ) belongs to @xmath1602 , i.e. @xmath1851 .",
    "suppose that @xmath1852 and let @xmath1853 be the least among such numbers .",
    "it follows from the construction of @xmath1585 that there exists @xmath1854 such that the path from @xmath1855 to @xmath1856 contains a prohibited subpath @xmath99 . from the minimality of @xmath1853",
    "it follows that the prohibited path @xmath99 goes from @xmath1857 , @xmath1858 to @xmath1856 .",
    "suppose first that the prohibited path @xmath99 is of type 7 - 10 , i.e. @xmath1656 . by definition , there exists a generalised equation @xmath1859 that repeats @xmath1860 times , i.e. @xmath1861 since the path @xmath99 is prohibited , we may assume that @xmath1862 for all @xmath26 and @xmath1863 for all @xmath26 , i.e. @xmath1864})={\\mathbf{e}}(\\omega_{v_{k_i}},h^{[{k_i}]})$ ] .",
    "we now prove that there exist @xmath1865 and @xmath1866 , @xmath1867 such that @xmath1868}<_{\\operatorname{aut}(\\omega)}h^{[k_j]}$ ] .",
    "since , the number of different @xmath1869-type vectors ( see definition [ defn : nfmatrix ] ) is bounded above by @xmath956 , if the generalised equation @xmath1859 repeats @xmath956 times , there exist @xmath1865 and @xmath1866 such that @xmath1870}$ ] and @xmath1868}$ ] have the type vectors , i.e. satisfy condition ( [ it : minsol3 ] ) from definition [ defn : sol < ] . moreover , by lemma [ 3.3 ] , @xmath1871 is an automorphism of @xmath1872 invariant with respect to the kernel of @xmath1873 .    by remark [ rem : leng < ]",
    ", we have @xmath1874}| > |{h^{[k_{j'}]}}|$ ] .",
    "this derives a contradiction , since , by construction of the sequence ( [ 3.8 ] ) one has @xmath1875 .",
    "suppose next that the path @xmath99 is prohibited of type 12 , i.e. @xmath1660 .",
    "an analogous argument to the one for prohibited paths of type 7 - 10 , but using lemma [ lem : c12 ] instead of lemma [ 3.3 ] , leads to a contradiction .",
    "hence , we conclude that @xmath1851 , where @xmath1660 .",
    "finally , suppose that the path @xmath99 is prohibited of type 15 , i.e. @xmath1769 . abusing the notation , we consider a subpath of ( [ 3.8 ] ) @xmath1876})\\to ( \\omega_{v_2},h^{[2]})\\to\\ldots \\to(\\omega_{v_m},h^{[m]})\\to\\ldots,\\ ] ] where @xmath1877 are vertices of the tree @xmath1602 , @xmath1769 and the edges @xmath833 are principal for all @xmath26 .",
    "notice , that by construction the above path is the path defined by the solution @xmath1878}$ ] : @xmath1879    to simplify the notation , below we write @xmath1880 for @xmath1881 .",
    "let @xmath1882 be the set of carrier bases @xmath1772 of the generalised equations @xmath584 s and let @xmath1793 denote the set of bases which are transfer bases for at least one generalised equation in ( [ 3.11 ] ) .",
    "by @xmath1883 we denote the set of all bases @xmath344 of @xmath584 , @xmath1884 so that @xmath1885 .",
    "let @xmath1886 where @xmath788 is the boundary between the active part and the non - active part .    for every element @xmath1887 of the sequence ( [ 3.11 ] )",
    ", using @xmath718 , if necessary , we make the section @xmath1888 $ ] of the generalised equation @xmath1736 closed and set @xmath1889 $ ] to be the non - active part of the generalised equation @xmath584 for all @xmath26 .",
    "recall that by @xmath793 we denote the set of all variable bases @xmath1890 for which either @xmath344 or @xmath794 belongs to the active part @xmath1891 $ ] of the generalised equation @xmath1892 , see definition [ defn : excess ] .",
    "let @xmath2 be a solution of the generalised equation @xmath235 and let @xmath1631 $ ] be the quadratic part of @xmath235 .",
    "set @xmath1893 where @xmath344 is a quadratic - coefficient base .",
    "[ 2.8 ] let @xmath95 be a vertex of @xmath830 , @xmath1626 .",
    "there exists a recursive function @xmath1894 such that for any solution @xmath2 minimal with respect to @xmath1600 one has @xmath1895    since @xmath1626 , every boundary that touches a base is @xmath385-tied in every base @xmath385 which it intersects . instead of @xmath859 below we consider the generalised equation @xmath1896 which does not have any boundary connections .",
    "then @xmath1606 is isomorphic to @xmath1897 .",
    "we abuse the notation and denote @xmath876 by @xmath588 .",
    "consider the sequence @xmath1898 where @xmath1899 is obtained from @xmath1900 by applying the entire transformation @xmath678 in the quadratic part of @xmath235 .",
    "denote by @xmath1737 the carrier base of the generalised equation @xmath1736 and consider the sequence @xmath1741    we use an argument analogous to the one given in the proof of lemma [ lem : c12 ] to show that the number of consecutive quadratic bases in the sequence @xmath1741 is bounded above .",
    "the entire transformation applied in the quadratic part of a generalised equation , does not increase the complexity and the number of items .",
    "the number of generalised equations with a bounded number of items and bounded complexity is finite .",
    "we now prove that if a generalised equation @xmath1859 repeats @xmath1901 times , then there exist @xmath1865 and @xmath1866 such that @xmath1902 .",
    "since , the number of different @xmath1903-type vectors ( see definition [ defn : nfmatrix ] ) is bounded above by @xmath956 , if the generalised equation @xmath1859 repeats @xmath956 times , there exist @xmath1865 and @xmath1866 such that @xmath1904 and @xmath1905 have the same type vectors , i.e. satisfy condition ( [ it : minsol3 ] ) from definition [ defn : sol < ] .",
    "moreover , by lemma [ lem : c12 ] , the automorphism @xmath1871 of @xmath1872 is invariant with respect to the non - quadratic part of @xmath1906 .    by remark [ rem : leng < ] , we have @xmath1907 .",
    "we , therefore , have that @xmath1908 , contradicting the minimality of @xmath1904 .",
    "thus , we have proven that the number of consecutive quadratic carrier bases is bounded .",
    "furthermore , since whenever the carrier base is a quadratic - coefficient base the number of bases in the quadratic part decreases , there exists an integer @xmath929 bounded above by a computable function of the generalised equation , such that the quadratic part of @xmath1909 is empty .",
    "we prove the statement of the lemma by induction on the length @xmath26 of the sequence . if @xmath1910 , since the application of the entire transformation to @xmath1911 results in a generalised equation with the empty quadratic part , the carrier @xmath1912 is a quadratic - coefficient base and all the other bases @xmath1913 are transfer bases and are transferred from the carrier to its dual .",
    "since the length @xmath1914 of every transferred base is less than the length of the carrier , we get that @xmath1915    by induction , we may assume that @xmath1916 , where @xmath1917 is a certain computable function .",
    "we prove that the statement holds for @xmath801 .",
    "suppose that the carrier base @xmath731 is quadratic and let @xmath1918 be the transfer bases of @xmath584 .",
    "then @xmath1919 where @xmath1920 , @xmath1921 are bases of @xmath1439 .",
    "thus , by induction hypothesis , we get @xmath1922 notice that the sets of quadratic - coefficient bases of @xmath584 and @xmath1439 coincide , thus @xmath1923 .",
    "therefore , @xmath1924    suppose now that the carrier base @xmath731 is a quadratic - coefficient base and let @xmath1918 be the transfer bases of the generalised equation @xmath584 . since the duals of the transferred quadratic bases become quadratic - coefficient and since @xmath1925 , @xmath1921 , we get that @xmath1926 where @xmath1927 and the sum is taken over all bases that are quadratic - coefficient in both @xmath584 and @xmath1439 .",
    "therefore , @xmath1928 the statement of the lemma follows .",
    "recall , that by @xmath1929 we denote the generalised equation obtained from @xmath235 applying @xmath718 .",
    "consider the section of @xmath1930 of the form @xmath1891 $ ] .",
    "the section @xmath1891 $ ] lies in the quadratic part of @xmath1930 .",
    "let @xmath1931 be the set of quadratic bases that belong to @xmath1891 $ ] and let @xmath1932 be the group of automorphisms of @xmath537 that are invariant with respect to the non - quadratic part of @xmath1930 and act identically on all the bases which do not belong to @xmath1931 .",
    "by definition , @xmath1933 .",
    "thus the solution @xmath934 minimal with respect to @xmath1934 is also minimal with respect to @xmath1932 . by lemma [ 2.8 ]",
    "we have @xmath1935    recall that ( see definition [ defn : excess ] ) @xmath1936    our next goal is , using inequality ( [ 3.14 ] ) , to give an upper bound of the length of the interval @xmath1937 in terms of the excess @xmath1938 and the function @xmath1939 .",
    "more precisely , we have the following lemma .    [ lem:3.19 ] in the above notation , the following inequality holds @xmath1940    denote by @xmath1941 the number of bases @xmath1942 containing @xmath289 .",
    "then @xmath1943 where @xmath1944 .",
    "let @xmath1945 , and @xmath1946 . by ( [ 3.12 ] )",
    "we have : @xmath1947    let @xmath1948 be a pair of variable quadratic - coefficient bases of the generalised equation @xmath1949 , where @xmath342 belongs to the non - quadratic part of @xmath1950 .",
    "when we apply @xmath718 to @xmath1892 thereby obtaining @xmath1950 , the pair @xmath1948 is obtained from bases @xmath1942 .",
    "there are two types of quadratic - coefficient bases .    * variable bases @xmath342 such that @xmath1951 . in this case , since @xmath342 belongs to the non - quadratic part of @xmath1949 , it is a product of items @xmath1952 and thus @xmath1953 .",
    "thus the sum of the lengths of quadratic - coefficient bases of type 1 and their duals is bounded above by @xmath1954 , where @xmath34 is the number of bases in @xmath235 .",
    "* variable bases @xmath342 such that @xmath1955 .",
    "the sum of the lengths of quadratic - coefficient bases of the second type is bounded above by @xmath1956 .",
    "we have @xmath1957 then from ( [ eq : m ] ) and ( [ 3.15 ] ) it follows that @xmath1958 from equation ( [ 3.16 ] ) , using inequalities ( [ 3.14 ] ) , ( [ 3.17 ] ) , ( [ 3.18 ] ) we get inequality ( [ 3.19 ] ) .",
    "let the path @xmath1959 corresponding to the sequence ( [ 3.11 ] ) be @xmath246-reducing , that is @xmath1773 and , either there are no outgoing auxiliary edges from @xmath1774 and @xmath246 occurs in the sequence @xmath1778 at least twice , or @xmath1774 does have outgoing auxiliary edges @xmath1960 and the base @xmath246 occurs in the sequence @xmath1778 at least @xmath1961 times .",
    "set @xmath1962 .",
    "we give a lower bound for @xmath1963 , i.e. we estimate by how much the length of a solution is reduced in a @xmath246-reducing path .",
    "we first prove that if @xmath1964 , @xmath1965 and @xmath1966 for @xmath1967 , then @xmath1968|.\\ ] ] indeed , if @xmath1969 then @xmath1970|=|h^{(i_1 + 1)}[1,\\alpha ( \\delta ( \\mu))]|.\\ ] ] if @xmath1971 , then @xmath1972 and @xmath246 is a transfer base in the generalised equation @xmath1973 and thus @xmath1974|=|h^{(i_1 + 1)}[1,\\alpha(\\delta(\\mu _ { i_1 + 1}))]|.\\ ] ] since @xmath246 is the carrier base of @xmath1975 we have @xmath1976|.\\ ] ] from ( [ est2 ] ) and ( [ est1 ] ) we get ( [ 3.23 ] ) .",
    "we want to show that every @xmath246-reducing path reduces the length of a solution @xmath934 by at least @xmath1977 .",
    "[ lem:3.26 ] let @xmath1978 be a @xmath246-reducing path , then the following inequality holds @xmath1979    to prove the lemma we consider the two cases from the definition of a @xmath246-reducing path .",
    "suppose first that @xmath1774 does not have any outgoing auxiliary edges , i.e. the bases @xmath869 and @xmath1686 do not intersect in the generalised equation @xmath1980 , then ( [ 3.23 ] ) implies that @xmath1981|\\ge |h^{(2)}({\\mu _",
    "2})|\\ge |h^{(2)}({\\mu})|=|h^{(1)}({\\mu})|-\\delta_1,\\ ] ] which , in turn , implies that @xmath1982    suppose now that there are auxiliary edges @xmath1983 .",
    "let @xmath1984\\doteq q$ ] , and @xmath939 be a period such that @xmath1985 for some @xmath1986 , then @xmath1987 and @xmath1988 are initial subwords of the word @xmath1989 $ ] , which , in turn , is an initial subword of @xmath1030 .    by construction of the sequence ( [ 3.8 ] ) , relation ( [ 3.9 ] ) fails for the vertex @xmath1774 , i. e. ( in the notation of ( [ 3.9 ] ) ) : @xmath1990 let @xmath1964 , @xmath1965 and @xmath1991 for @xmath1967 .",
    "if @xmath1992 is a @xmath1993-periodic subword ( @xmath1993 is a cyclic permutation of @xmath939 ) of the @xmath1993-periodic word @xmath1994 $ ] of length greater than @xmath1995 , it follows by lemma 1.2.9 in @xcite , that @xmath1996|\\ge k|q'|$ ] . as @xmath1997 ( @xmath1998 and @xmath1999 do not form a pair of matched bases ) , so @xmath1996|\\ge |p|$ ] . together with ( [ 3.23 ] ) this gives that @xmath2000 .",
    "the base @xmath246 occurs in the sequence @xmath1778 at least @xmath956 times , so either ( [ 3.26a ] ) fails for some @xmath2001 or @xmath2002 .",
    "if ( [ 3.26a ] ) fails , then from the inequality @xmath2003 and the definition of @xmath2004 follows that @xmath2005 hence in both cases @xmath2002 .",
    "notice that for @xmath2006 , inequality ( [ 3.23 ] ) implies that @xmath2007 ; so @xmath2008 .",
    "together with ( [ 3.25 ] ) this implies that @xmath2009 finally we get that @xmath2010 from the above inequality and inequality ( [ 3.24 ] ) , we see that for a @xmath246-reducing path inequality ( [ 3.26 ] ) always holds .",
    "we thereby have shown that in any @xmath246-reducing path the length of the solution is reduced by at least @xmath1780 of the length of the carrier base @xmath246 .",
    "notice that by property ( [ it : prp3 ] ) from definition [ defn : proh15 ] , we can assume that the carrier bases @xmath731 and their duals @xmath963 belong to the active part @xmath2011 $ ] . then , by lemma [ lem : excess ] and by construction of the path ( [ 3.11 ] ) , we have that @xmath2012 we denote this number by @xmath2013 .",
    "let @xmath1959 be a prohibited path of type 15 . by definition",
    ", @xmath1959 can be presented in the form ( [ 3.7 ] ) .",
    "let @xmath2014 be the length of the subpath @xmath2015 .",
    "then there exists a carrier base @xmath2016 such that the following inequality holds latexmath:[\\[\\label{3.27 }    @xmath34 is the number of bases in @xmath235 .    from the definition of @xmath1938 ,",
    "see ( [ eq : m ] ) , we get that @xmath2018 , hence the inequality @xmath2019 holds for at least one base @xmath1942 . since @xmath2020 , we may assume that @xmath2021 .    if @xmath1797 , then inequality ( [ 3.27 ] ) trivially holds .",
    "if @xmath2022 , then by the third condition in the definition of a prohibited path of type 15 ( see definition [ defn : proh15 ] ) there exists @xmath2023 such that @xmath246 is a transfer base of @xmath1736 . hence , @xmath2024 .    finally , from conditions ( [ it : prp2 ] ) and ( [ it : prp1 ] ) in the definition of a prohibited path of type 15 , from the inequality @xmath2025 , @xmath2026 , and from inequalities ( [ 3.26 ] ) and ( [ 3.27 ] ) , it follows that @xmath2027    by equation ( [ 3.22 ] ) , the sum in the left part of the inequality ( [ 3.28 ] ) equals @xmath2028 , hence @xmath2029 which contradicts the statement of lemma [ lem:3.19 ] .",
    "therefore , the assumption that there are prohibited subpaths ( [ 3.11 ] ) of type 15 in the path ( [ 3.8 ] ) led to a contradiction . hence , the path ( [ 3.8 ] ) does not contain prohibited subpaths .",
    "this implies that @xmath2030 for all @xmath1887 in ( [ 3.8 ] ) .    in particular",
    ", we have shown that final leaves @xmath948 of the tree @xmath830 are , in fact , leaves of the tree @xmath1602 .",
    "naturally , we call such leaves the _ final leaves of @xmath1602_.      for all @xmath26 , either @xmath2031 and @xmath2032}|<|h^{[i]}|$ ] , or @xmath833 is an edge of a finite tree @xmath1602 . hence the sequence ( [ 3.8 ] ) is finite .",
    "let @xmath2033})$ ] be its final term . we show that @xmath2034})$ ] satisfies the properties required in the proposition .",
    "property ( [ it : prop1 ] ) follows directly from the construction of @xmath1594}$ ] .",
    "we now prove that property ( [ it : prop2 ] ) holds .",
    "let @xmath1597 and suppose that @xmath1595 has non - constant non - active sections .",
    "it follows from the construction of ( [ 3.8 ] ) that if @xmath2035 $ ] is an active section of @xmath2036 and is a non - active section of @xmath584 then @xmath1589}[j , k]\\doteq h^{[i+1]}[j , k]\\doteq\\ldots \\doteq h^{[w]}[j , k]$ ] .",
    "therefore , ( [ 3.9 ] ) and the definition of @xmath1803 imply that the word @xmath2037 can be subdivided into subwords @xmath2038,\\ldots , h[i_{l'-1},i_{\\rho_w}]$ ] , such that for any @xmath115 either @xmath1594}[i_l , i_{l+1}]$ ] has length @xmath185 , or the word @xmath2039 $ ] does not appear in basic , factor and coefficient equations , or @xmath2040}[i_l , i_{l+1}]\\doteq p_l^r \\cdot p_l';\\quad p_l\\doteq p_l'p_l '' ; \\quad r\\ge",
    "\\rho_w \\max\\limits_{\\langle { \\mathcal{p}},r\\rangle   } \\left\\ { f_{0}(\\omega_w , { \\mathcal{p } } , r)\\right\\},\\ ] ] where @xmath2041 is a period , and the maximum is taken over all regular periodic structures of @xmath1762 . therefore ,",
    "if we choose @xmath2042 of maximal length , then @xmath2043 is singular with respect to the periodic structure @xmath2044},p_l)$ ] . indeed",
    ", suppose that it is regular with respect to this periodic structure .",
    "then , as in @xmath1594}[i_l , i_{l+1}]$ ] one has @xmath2045 , so ( [ 3.29 ] ) implies that there exists @xmath354 such that @xmath2046}_k|\\ge f_{0}(\\omega_w , { \\mathcal{p } } , r)$ ] . by lemma [ lem:23 - 2 ] , this contradicts the minimality of the solution @xmath1594}$ ] .",
    "this finishes the proof of proposition [ 3.4 ] .",
    "we proved in the previous section that for every solution @xmath2 of a generalised equation @xmath235 , the path @xmath1605 associated to the solution @xmath2 ends in a final leaf @xmath95 of the tree @xmath1585 , @xmath2048 .",
    "furthermore , if @xmath1607 and the generalised equation @xmath2049 contains non - constant non - active sections , then the generalised equation @xmath859 is singular with respect to the periodic structure @xmath2050 , see proposition [ 3.4 ] .",
    "the essence of the decomposition tree @xmath2051 is that to every solution @xmath2 of @xmath235 one can associate the path @xmath1605 in @xmath2051 such that either all sections of the generalised equation @xmath2052 corresponding to the leaf @xmath219 of @xmath2051 are non - active constant sections or the coordinate group of @xmath2052 is a proper quotient of @xmath761 .",
    "we summarise the results of this section in the proposition below .",
    "[ prop : dectree ] for a generalised equation @xmath831 , one can effectively construct a finite oriented rooted at @xmath111 tree @xmath2053 , @xmath2054 , such that :    1 .   the tree",
    "@xmath1602 is a subtree of the tree @xmath2053 .",
    "2 .   to every vertex @xmath95 of @xmath2053",
    "we assign a finitely generated group of automorphisms @xmath15 .",
    "3 .   for any solution @xmath2 of a generalised equation @xmath314",
    "there exists a leaf @xmath219 of the tree @xmath2053 , @xmath2055 , and a solution @xmath2056}$ ] of the generalised equation @xmath2057 such that * @xmath2058}}$ ] , where @xmath2059 ; * if @xmath2060 , then all non - active sections of @xmath2052 are constant sections .    to obtain @xmath2047",
    "we add some edges labelled by proper epimorphisms ( to be described below ) to the final leaves of type @xmath512 of @xmath1602 so that the corresponding generalised equations contain non - constant non - active sections .",
    "the idea behind the construction of this tree is the following .",
    "lem:23 - 1 ] states that given a generalised equation @xmath235 singular with respect to a periodic structure @xmath2061 , there exist finitely many proper quotients of the coordinate group @xmath761 such that for every @xmath939-periodic solution @xmath2 of the generalised equation @xmath235 such that @xmath2062 , an @xmath937-automorphic image @xmath1313 of @xmath2 is a solution of a proper equation . in other words , the @xmath0-homomorphism @xmath2063 factors through one of the finitely many proper quotients of @xmath761",
    ".    recall that given a coordinate group of a system of equations , the homomorphisms @xmath557 from this coordinate group to the coordinate groups of generalised equations determined by partition tables ( see equation ( [ eq : hompt ] ) and discussion in section [ sec : relsol2ge ] ) , are , in general , just homomorphisms ( neither injective nor surjective ) .",
    "our goal here is to prove that in fact , the solution @xmath1313 is a solution of one of the finitely many proper generalised equations such that the homomorphism from the coordinate group of the system of equations to the coordinate group of the generalised equation is an epimorphism .",
    "let @xmath95 be a final leaf of type @xmath512 of @xmath1602 such that @xmath588 contains non - constant non - active sections .",
    "consider a triple @xmath2064 , where    * @xmath588 is singular with respect to the periodic structure @xmath2065 , * @xmath100 is a cycle in @xmath92 , @xmath2066 , where @xmath2067 is the set of cycles from lemma [ lem:23 - 1 ] , * and @xmath415 is a partition table from the set @xmath2068 defined below .    for every such triple , we construct a generalised equation @xmath2069 , a homomorphism @xmath2070 and put an edge @xmath2071 , @xmath2072 .",
    "we then show that the homomorphism @xmath2073 is a proper epimorphism and that every solution @xmath1313 of @xmath588 is a solution of one of the generalised equations @xmath2074 for some @xmath100 and @xmath415 .",
    "the vertex @xmath219 is a leaf of @xmath2047 .",
    "the way we proceed is the following . by part ( [ it:23 - 13 ] ) of lemma [ lem:23 - 1 ] , we know that @xmath1313 is a solution of the generalised equation @xmath2075 .",
    "this fact pilots the construction of the generalised equation @xmath2076 below . on the other hand ,",
    "we consider the system of equations @xmath2077 over @xmath0 corresponding to the bases from @xmath1004 and the cycle @xmath100 ( see below ) .",
    "since the solution @xmath1313 satisfies statement ( [ it:23 - 13 ] ) of lemma [ lem:23 - 1 ] , we can prove that the @xmath0-partition table @xmath415 associated to @xmath1313 satisfies property ( [ 3.31 ] ) . for the partition tables",
    "@xmath415 that satisfy condition ( [ 3.31 ] ) and the corresponding generalised equations @xmath458 , the homomorphism @xmath2078 is surjective .",
    "we construct the generalised equation @xmath2069 from @xmath458 and @xmath2076 by identifying the items they have in common .",
    "we now formalise the construction of @xmath2079 and @xmath2073 .",
    "let @xmath100 be as above and suppose that @xmath2080 .",
    "consider the system of equations @xmath2081 $ ] over @xmath0 : @xmath2082    below we use the notation of section [ sec : consgeneq ] .",
    "for the system of equations @xmath2077 consider the subset @xmath2068 of the set @xmath2083 of all partition tables of @xmath2077 that satisfy condition ( [ 3.31 ] ) .",
    "consider the set of generalised equations @xmath2084 .",
    "for any generalised equation @xmath458 , @xmath2085 , since the partition table @xmath415 satisfies condition ( [ 3.31 ] ) , it follows that the homomorphism @xmath2078 induced by the map @xmath2086 ( see section [ sec : relsol2ge ] for definition ) is surjective .",
    "let the generalised equation @xmath2076 be obtained from @xmath876 by removing all bases and items that belong to @xmath1004 .    construct the generalised equation @xmath2087 as follows .",
    "the set of items @xmath2088 of @xmath2089 is the disjoint union of the items of @xmath2076 and @xmath458 ; the set of coefficient and factor equations of @xmath2087 is the disjoint union of the coefficient and factor equations of @xmath2076 and @xmath458 .",
    "the set of basic equations of @xmath2087 consists of : the basic equations of @xmath2076 , the basic equation of @xmath458 , and basic equations of the form @xmath2090 , @xmath1349 , where in the left hand side of this equation @xmath354 is treated as a variable of @xmath2076 and @xmath2091 , @xmath1349 is a label of a section of @xmath458 .",
    "the initial and terminal terms of boundaries in @xmath2087 are naturally induced from @xmath2076 and @xmath458 .",
    "the natural homomorphism @xmath2070 , induced by a map @xmath2092 : @xmath2093 is surjective , since so is @xmath2094 .",
    "moreover , by construction , @xmath2095 , and therefore @xmath2073 is a proper epimorphism .",
    "we now show that for every @xmath939-periodic solution @xmath2 of @xmath588 such that @xmath588 is singular with respect to the periodic structure @xmath2096 , there exists an @xmath1608-automorphic image @xmath1313 of @xmath2 such that @xmath1313 factors through one of the solutions of the generalised equations @xmath2087 , for some choice of @xmath100 and @xmath415 .",
    "indeed , let @xmath1313 be the solution constructed in lemma [ lem:23 - 1 ] and @xmath100 be one of the cycles from lemma [ lem:23 - 1 ] for which @xmath1426 .",
    "the solution @xmath1313 is a solution of the system @xmath2077 .",
    "all equations of @xmath2077 have the form @xmath2097 , where @xmath2098 is a cycle in the graph of the periodic structure @xmath2096 . from condition ( [ it:23 - 13 ] ) of lemma",
    "[ lem:23 - 1 ] , it follows that , on one hand , the word @xmath2099 , @xmath1433 , is in the normal form , and , on the other hand , that if @xmath2100 is an equation of the system @xmath2077 and @xmath2101 are the respective components of @xmath1313 , then the word @xmath2102 is trivial in the free group @xmath2103 .",
    "furthermore , in the product of two consecutive subwords @xmath2104 and @xmath2105 either there is no cancellation , or one of these words cancels completely , that is either @xmath2106 or @xmath2107 . let @xmath415 be the partition table corresponding to the cancellation scheme of the system @xmath2077 .",
    "the argument above shows that @xmath415 satisfies condition ( [ 3.31 ] ) .",
    "let @xmath2108 , @xmath2109 .    the solution @xmath1313 induces a solution @xmath2110 of the system @xmath2077 .",
    "by lemma [ le : r1 ] , there exists a solution @xmath2111 of the generalised equation @xmath458 such that the following diagram @xmath2112_{\\pi_{h^+_{{\\mathbf{s } } } } }   \\ar[rr ]   &      &   g_{r(\\omega_{\\mathcal{t}}^\\ast ) }   \\ar[ld]^{\\pi_{h^+_{\\omega_{\\mathcal{t } } } } } \\\\                                                  &   g & } \\ ] ] is commutative .    as @xmath1313 satisfies condition ( [ it:23 - 13 ] ) of lemma [ lem:23 - 1 ] , and the @xmath1070 s are in the normal form , so the @xmath2113 s are in the normal form . in particular , @xmath2111 is a solution of the generalised equation @xmath458 .    on the other hand ,",
    "using again part ( [ it:23 - 13 ] ) of lemma [ lem:23 - 1 ] , if we remove the components @xmath2114 of the solution @xmath1313 , we get a solution @xmath2115 of the generalised equation @xmath2076 .    combining the solutions @xmath2115 and @xmath2111",
    "we get a solution @xmath2116 of the generalised equation @xmath2074 . by part ( [ it:23 - 13 ] ) of lemma [ lem:23 - 1 ] , the solution @xmath1313 satisfies the type constraints . therefore",
    ", from the construction it follows that @xmath2116 is a solution of @xmath2074 and @xmath2117 we thereby have shown that for every @xmath939-periodic solution @xmath2 of @xmath588 such that @xmath588 is singular with respect to the periodic structure @xmath2096 , there exists an @xmath1608-automorphic image @xmath1313 of @xmath2 such that @xmath1313 factors through one of the solutions of the generalised equations @xmath2087 .    to the root vertex @xmath111 of the decomposition tree",
    "@xmath2118 we associate the group of automorphisms @xmath1592 of the coordinate group @xmath2119 , see definition [ defn : aut ] . to the vertices @xmath95",
    "such that @xmath95 is a leaf of @xmath1602 but not of @xmath2051 ( those vertices to which we added edges ) , we associate the group of automorphisms generated by the groups @xmath1608 , see definition [ defn : aa ] , corresponding to all periodic structures on @xmath588 with respect to which @xmath588 is singular .",
    "to all the other vertices of @xmath2051 we associate the trivial group of automorphisms .",
    "we denote the automorphism group associated to a vertex @xmath95 of the tree @xmath2051 by @xmath15 .",
    "naturally , we call leaves @xmath219 such that the paths @xmath1605 associated to solutions @xmath2 of @xmath235 end in @xmath219 , _ final leaves of @xmath2051_.",
    "recall that the coordinate group @xmath1606 associated to a final leaf @xmath95 of @xmath2051 is either a proper epimorphic image of @xmath537 or all the sections of the corresponding generalised equation @xmath588 are non - active constant sections .",
    "we now use the assumption that the group @xmath0 is equationally noetherian to get that any sequence of proper epimorphisms of coordinate groups is finite . an inductive argument for those leaves of @xmath2051 that are",
    "proper epimorphic image of @xmath537 shows that we can construct a tree @xmath2121 with the property that for every leaf @xmath95 of @xmath2121 all the sections of the generalised equation @xmath588 are non - active constant sections .",
    "we define a new transformation @xmath2122 , which we call a _ leaf - extension of the tree @xmath2051 at the leaf @xmath95 _ in the following way .",
    "if there are active sections in the generalised equation @xmath588 , we take the union of two trees @xmath2051 and @xmath2123 and identify the leaf @xmath95 of @xmath2051 with the root @xmath95 of the tree @xmath2123 , i.e. we extend the tree @xmath2051 by gluing the tree @xmath2123 to the vertex @xmath95 . if all the sections of the generalised equation @xmath588 are non - active , then the vertex @xmath95 is a leaf and @xmath2123 consists of a single vertex , namely @xmath95 .",
    "we call such a vertex @xmath95 _ terminal_.    we use induction to construct the solution tree @xmath2120 .",
    "let @xmath95 be a non - terminal leaf of @xmath2124 .",
    "apply the transformation @xmath2122 to obtain a new tree @xmath2125 .",
    "if in @xmath2126 there exists a non - terminal leaf @xmath1757 , we apply the transformation @xmath2127 , and so on . by induction",
    "we construct a strictly increasing sequence of finite trees @xmath2128 sequence ( [ eq:5.3.1 ] ) is finite .",
    "indeed , assume the contrary , i.e. the sequence is infinite and hence the union @xmath2129 of this sequence is an infinite tree locally finite tree . by knig",
    "s lemma , @xmath2129 has an infinite branch .",
    "observe that along any infinite branch in @xmath2129 one has to encounter infinitely many proper epimorphisms .",
    "this derives a contradiction with the fact that @xmath0 is equationally noetherian .            1 .",
    "[ it : th1 ] for any solution @xmath2 of the generalised equation @xmath235 there exist : a path @xmath2131 in @xmath2120 from the root vertex @xmath111 to a leaf @xmath95 , a sequence of automorphisms @xmath2132 , where @xmath2133 and a solution @xmath2134 associated to the vertex @xmath95 , such that @xmath2135 2 .   [ it : th2 ] for any path @xmath2131 in @xmath2120 from the root vertex @xmath111 to a leaf @xmath95 , any sequence of automorphisms @xmath2136 , @xmath2133 , and any solution @xmath2134 associated to the vertex @xmath95 , the homomorphism @xmath2137 is a solution of @xmath1560 .",
    "moreover , every solution of @xmath1560 can be obtained in this way .",
    "[ ge ] let @xmath12 be an equationally noetherian free product of groups and let @xmath2138 be a finitely generated ( @xmath0-)group . then the set of all ( @xmath0-)homomorphisms @xmath2139 ( @xmath2140 , correspondingly ) from @xmath2138 to @xmath0 can be described by a finite rooted tree .",
    "this tree is oriented from the root , all its vertices except for the root vertex are labelled by coordinate groups of generalised equations .",
    "to each vertex group we assign the group of automorphisms @xmath15 .",
    "the leaves of this tree are labelled by groups of the form @xmath16 ( @xmath17 , correspondingly ) , where @xmath18 is a coordinate group over @xmath19 .",
    "each edge of this tree is labelled by a ( @xmath0-)homomorphism . furthermore ,",
    "every edge except for the edges from the root is labelled by a proper epimorphism .",
    "each edge from the root vertex corresponds to a ( @xmath0-)homomorphism from @xmath2138 to the coordinate group of a generalised equation .",
    "every ( @xmath0-)homomorphism from @xmath2138 to @xmath0 can be written as a composition of the ( @xmath0-)homomorphisms corresponding to the edges , automorphisms of the groups assigned to the vertices , and a specialisation of the variables of the generalised equation corresponding to a leaf of the tree .",
    "suppose first that @xmath2138 is a finitely generated @xmath0-group @xmath0-generated by @xmath130 , i.e. @xmath2138 is generated by @xmath2141 .",
    "let @xmath11 be the set of defining relations of @xmath2138 .",
    "we treat @xmath11 as a system of equations ( possibly infinite ) over @xmath0 ( with coefficients from @xmath0 ) .",
    "since @xmath0 is equationally noetherian , there exists a finite subsystem @xmath2142 such that @xmath2143 . since every @xmath0-homomorphism from @xmath2144 to @xmath0 factors through @xmath2145 , it suffices to describe the set of all homomorphisms from @xmath2145 to @xmath0 .",
    "we now run the process for the system of equations @xmath32 .",
    "since there is a one - to - one correspondence between solutions of the system @xmath32 and homomorphisms from @xmath2145 to @xmath0 , by theorem [ th:5.3.1 ] , we obtain a description of @xmath2146 .",
    "suppose now that @xmath2138 is not a @xmath0-group , @xmath2147 ( note that the set @xmath11 may be infinite ) .",
    "we treat @xmath11 as a coefficient - free system of equations over @xmath0 .",
    "though , formally , coordinate groups are @xmath0-groups , in this case , we consider instead the group @xmath2148 , where @xmath2149 and the intersection is taken over all homomorphisms @xmath1278 from @xmath128 to @xmath0 such that @xmath2150 .",
    "it is clear that @xmath2151 is a residually @xmath0 group .",
    "since @xmath0 is equationally noetherian , there exists a finite subsystem @xmath2142 such that @xmath2152 .",
    "every homomorphism from @xmath2138 to @xmath0 factors through @xmath2153 , it suffices to describe the homomorphisms from @xmath2153 to @xmath0 .",
    "we now run the process for the system of equations @xmath32 and construct the solution tree , where to each vertex @xmath95 instead of @xmath1613 we associate @xmath2154 and the corresponding epimorphisms , homomorphisms and automorphisms are defined in a natural way .",
    "we thereby obtain a description of the set @xmath2155 .",
    "[ ase ] for any system of equations @xmath20 over an equationally noetherian free product of groups @xmath3 , there exists a finite family of nondegenerate triangular quasi - quadratic systems @xmath21 over groups of the form @xmath22 , where @xmath18 is a coordinate group over @xmath19 , and morphisms of algebraic sets @xmath23 , @xmath24 such that for every @xmath25 there exists @xmath26 and @xmath27 for which @xmath28 , i.e. @xmath29 if the universal horn theory of @xmath0 is decidable , then the finite families @xmath30 and @xmath31 can be constructed effectively .",
    "since , by assumption @xmath0 is equationally noetherian , there exists a finite subsystem @xmath32 of @xmath11 such that @xmath2156 .",
    "note that @xmath32 can be effectively constructed if the universal horn theory of @xmath0 is decidable .",
    "we consider the set of all partition tables @xmath2157 of the system of equations @xmath32 . by every partition table @xmath2158",
    ", we construct the generalised equation @xmath458 , see section [ sec : consgeneq ] .",
    "for every generalised equation @xmath458 , we construct its solution tree @xmath2159 .    by lemma [ le : r1 ]",
    "( the notation from which we further use ) , it follows that there exists finitely many generalised equations @xmath2160 ( corresponding to the partition tables of @xmath32 ) such that every solution of the system @xmath20 is a composition of the homomorphism @xmath2094 and a solution of the generalised equation @xmath458 . it therefore suffices to prove the statement of the theorem for solutions of generalised equations .",
    "consider a generalised equation @xmath2161 . by theorem [ th:5.3.1",
    "] , there are finitely many branches in the tree @xmath2162 .",
    "to each of the branches , we will assign a finite family of homomorphisms @xmath2163 and a finite family of ntq systems @xmath2164 such that all solutions that factor through this branch are a composition of one of the @xmath2165 s and a solution of the ntq system @xmath2166 .",
    "the family of homomorphisms @xmath2167 and the family of ntq systems @xmath2168 satisfy the statement of the theorem .      to construct the family of ntq systems assigned to the branch defined by @xmath98 , we begin from the leaf of the path @xmath98 , whose coordinate group , by definition , is an ntq system and consider a subpath such that    * it contains at least one vertex with non - trivial group of automorphisms assigned to it , * all vertices of the subpath with non - trivial associated automorphism group are of the same type * and the canonical epimorphism from the coordinate group corresponding to the initial vertex of the subpath to the one corresponding to its terminal vertex is a proper epimorphism .    for every type of such subpath , we prove that one can construct quadratic systems of equations over the coordinate group corresponding to the terminal vertex of the path @xmath98 and the corresponding homomorphisms @xmath2171 .",
    "the proof then follows by induction on the length of the path @xmath98 .",
    "[ [ case-1-the - group - of - automorphisms - assigned - to - every - vertex - v_i - is - trivial . ] ] case 1 : the group of automorphisms assigned to every vertex @xmath832 is trivial .",
    "^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^    in this case , all solutions that factor through the branch defined by the path @xmath98 can be presented as a composition of the canonical epimorphism @xmath2172 and a solution of @xmath2173 .",
    "therefore , since the coordinate group of @xmath2173 is , by definition , an ntq system , we set @xmath2174 to be @xmath2172 and @xmath2175 to be the coordinate group of @xmath2173 .",
    "we further assume that there exists @xmath26 so that the group of automorphisms @xmath2176 assigned to the vertex @xmath832 is non - trivial , i.e. @xmath2177 .",
    "let @xmath115 be maximal such number @xmath26 .",
    "it suffices to consider the case when the canonical epimorphism @xmath2178 is proper .      in this case , every solution @xmath2180}$ ] of @xmath587 that factors through the path @xmath2181 is @xmath939-periodic and defines a singular periodic structure @xmath2182},p)$ ] on @xmath2183 ( this periodic structure is the same for all such solutions @xmath2180}$ ] ) .",
    "if @xmath587 is not periodised with respect to the periodic structure @xmath2182},p)$ ] , then , by lemma [ lem:23 - 1 ] , any solution of @xmath587 is a composition of the canonical epimorphism @xmath2184 and a solution of @xmath2185 , which , in turn , by case 1 , is a composition of the canonical epimorphism @xmath2186 and a solution of @xmath2173 . in this case",
    "we set @xmath2174 to be @xmath2187 and @xmath2175 to be the coordinate group of @xmath2173 .",
    "suppose that @xmath587 is periodised and singular with respect to the periodic structure @xmath2182},p)$ ] .",
    "by lemma [ 2.10  ] , we have that @xmath2188 is isomorphic to @xmath2189 where @xmath1239 and @xmath2190 are defined in statement ( [ spl3 ] ) of lemma [ 2.10  ] .    by construction , see section [ 5.5.5 ] , if @xmath1361 , then the coordinate group @xmath2191 is generated by @xmath2192 , where @xmath2193 .",
    "consider the group @xmath2194=1 , [ y_i , h({\\mathfrak{c}}_2)]=1 , , [ y_i , h(c^{(1)})]=1\\right)\\right.\\right>,\\ ] ] where @xmath2195 . by construction @xmath2196",
    "is a coordinate group of an ntq system over @xmath2197 .",
    "furthermore , all solutions of @xmath587 ( that factor through the subpath @xmath99 ) factor through @xmath2196 .",
    "we define @xmath2175 to be @xmath2198=1 , [ y_i , \\pi(v_{l+1 } , w)(h({\\mathfrak{c}}_2))]=1,\\\\ \\ , [ y_i , \\pi(v_{l+1 } , w)(h(c^{(1)}))]=1 \\end{array } \\right)\\right.\\right>.\\ ] ] by construction , @xmath2175 is a coordinate group of an ntq system over @xmath2199 .",
    "all solutions that factor through the subpath @xmath99 , factor through @xmath2175 , therefore , we set @xmath626 to be the composition of the natural homomorphism from @xmath2200 to @xmath2196 and the homomorphism from @xmath2196 to @xmath2175 ( induced by the canonical epimorphism @xmath2201 .          by lemma [ 7 - 10 ] , the coordinate group @xmath2206 is isomorphic to @xmath2207 . in this case",
    "we set @xmath2208 to be @xmath2209 and @xmath2174 to be the natural homomorphism @xmath2207 to @xmath2175 induced by the canonical epimorphism @xmath2210 .",
    "clearly , @xmath2175 is an ntq system over @xmath2211 and every solution that factors through @xmath99 factors through @xmath2208 .        in this case , by lemma 2.6 in @xcite , the coordinate group @xmath2214 is isomorphic to the coordinate group of a system of quadratic equations @xmath2215 over @xmath2211 .",
    "we therefore set @xmath2175 to be @xmath2214 .",
    "let @xmath1631 $ ] be the quadratic part of @xmath587 .",
    "if @xmath2217 , as in case 4 , we consider the coordinate group @xmath2196 of the system of quadratic equations defined by the quadratic part @xmath1631 $ ] of @xmath587 over the coordinate group @xmath2218 .",
    "the quadratic - coefficient bases in @xmath1631 $ ] are identified with their images in the group @xmath2218 via the canonical homomorphism @xmath2187 . by construction",
    ", there exists a natural homomorphism @xmath1636 from @xmath2200 to @xmath2196 defined by the map @xmath2219    furthermore , if @xmath585 has outgoing auxiliary edges , then , by lemma [ 2.10  ] , each regular periodic structure @xmath985 on @xmath587 gives rise to an isomorphism of @xmath2200 and the group @xmath2220=1,\\hbox{where } e_j\\in t , \\,e_j\\in \\operatorname{sh } , \\",
    ", j=1,2 ; 1\\leq i\\leq m\\\\ \\left[h({\\mathfrak{c}}_1),h({\\mathfrak{c}}_2)\\right]=1 , \\hbox{where } { \\mathfrak{c}}_1,{\\mathfrak{c}}_2\\in c^{(1)}\\cup c^{(2 ) } \\end{array } \\right ) \\right . \\right>\\ ] ] where @xmath1239 is defined in statement ( [ spl3 ] ) of lemma [ 2.10  ] .",
    "for each periodic regular periodic @xmath985 structure on @xmath587 , we set @xmath2221 where @xmath1770 and @xmath2222 , @xmath2223 are sets of variables defined in ( [ eq : uie ] ) .",
    "the homomorphism @xmath2224 is induced by the map @xmath2225 by construction , @xmath2226 is a coordinate group of an ntq system over @xmath2218 , and solutions that factor through the path @xmath2227 ( and define the regular periodic structure @xmath985 ) factor through @xmath2226 .",
    "as described above , the coordinate groups assigned to leaves of the tree @xmath2121 are of the form @xmath2228 , where @xmath18 is a coordinate group over @xmath19 , and therefore they are ntq systems , as required .",
    "the proof now follows by induction on the length of the path @xmath98 .",
    "o.  kharlampovich , a.  myasnikov , _ irreducible affine varieties over a free group ii : systems in triangular quasi - quadratic form and description of residually free groups _ , j. of algebra , * 200 * ( 1998 ) , pp .",
    "517 - 570 ."
  ],
  "abstract_text": [
    "<S> using an analogue of makanin - razborov diagrams , we give a description of the solution set of systems of equations over an equationally noetherian free product of groups @xmath0 . </S>",
    "<S> equivalently , we give a parametrisation of the set @xmath1 of all homomorphisms from a finitely generated group @xmath2 to @xmath0 . furthermore </S>",
    "<S> , we show that every algebraic set over @xmath0 can be decomposed as a union of finitely many images of algebraic sets of ntq systems .    if the universal horn theory of @xmath0 ( the theory of quasi - identities ) is decidable , then our constructions are effective .    </S>",
    "<S> in this paper we study the structure of the set of solutions of an arbitrary system of equations over an equationally noetherian free product of groups @xmath3 . </S>",
    "<S> it is clear that the structure of the free product is at least as complicated as is the structure of its factors . </S>",
    "<S> but a general guideline is that it is not much more complicated . from this perspective , a lot of work has been done in order to understand the relations between the factors and the free product itself , i.e. in order to establish which properties of the free product reduce to the factors and , conversely , which properties are stable under taking free products .    </S>",
    "<S> intuitively , one might expect that the properties of the factors that lift to the free product are those that are also satisfied by free groups . </S>",
    "<S> as an illustration , properties such as : to be finite , to be abelian ( nilpotent , solvable ) , to be a torsion group , do not lift to the free product . on the other hand , properties such as : to be torsion free , to have unique roots , to be residually finite , to be csa , to be ( relatively ) hyperbolic , to be cat(0 ) , to have decidable word , conjugacy and isomorphism problems lift to free products . </S>",
    "<S> however , as in any rule , there are exceptions , or at least subtleties : it was proved by i.  dey and h.  neumann that the hopf property is stable under taking free products in the case when the factors are finitely generated , see @xcite , but if one does not assume the factors to be finitely generated , then the free product of hopfian groups may be non - hopfian , see @xcite .    </S>",
    "<S> the interest in understanding the relations between first - order theories of the free product and of its factors , probably , goes back to a.  tarski . </S>",
    "<S> it appears that r.  l.  vaught , while doing his phd under tarski s supervision , was working on the following problem , see @xcite and references there .    </S>",
    "<S> [ prob:1 ] does the elementary theory of the free product of groups reduce to the elementary theories of the factors ? </S>",
    "<S> more precisely :    1 .   </S>",
    "<S> let @xmath4 be elementarily equivalent to @xmath5 , and @xmath6 be elementarily equivalent to @xmath7 . </S>",
    "<S> is it true that @xmath8 is elementarily equivalent to @xmath9 ? </S>",
    "<S> 2 .   let the elementary theories of @xmath4 and @xmath6 be decidable , is the elementary theory of @xmath0 decidable ?    </S>",
    "<S> it was communicated to us by v.  remeslennikov that this problem was in the school of a.  malcev since at least early 1960s . </S>",
    "<S> it also appears in z.  sela s list of open problems @xcite , where he attributes this problem to g.  sabbagh , see problem iii.10 .    </S>",
    "<S> similar problems for other algebraic structures were studied by p. olin , see @xcite , who proved that free product preserves elementary equivalence of groupoids , but does not preserve the elementary equivalence of semigroups . for free products of groups , </S>",
    "<S> some partial results were obtained by v.  diekert and m.  lohrey . in their paper @xcite </S>",
    "<S> , they proved that two free products of groups with universally ( existentially ) equivalent factors are universally ( existentially ) equivalent . </S>",
    "<S> moreover , an analogous statement holds if the factors have the same positive theories . </S>",
    "<S> furthermore , diekert and lohrey proved that the positive and universal ( existential ) theories of the free product are decidable , provided that the corresponding theories of the factors are decidable .    </S>",
    "<S> the possibility of approaching questions about the elementary theory of free products is suggested by the recent solution of tarski s problems on the elementary theory of free groups . in a series of papers o.  </S>",
    "<S> kharlampovich and a.  myasnikov ( see @xcite and references there ) , and z.  sela ( see @xcite and references there ) proved that non - abelian free groups are elementarily equivalent .    in order to understand the elementary theory of a group </S>",
    "<S> , one has to study the structure of algebraic varieties and their projections . </S>",
    "<S> it is therefore natural to ask to which extent algebraic varieties over the factors determine the structure of algebraic varieties over the group .    </S>",
    "<S> the first description of algebraic varieties over a free group ( viewed as solution sets of systems of equations ) , was given by a.  razborov in @xcite , @xcite . </S>",
    "<S> in his work , razborov developed makanin s approach to the compatibility problem for systems of equations over free groups , see @xcite , and gave a construction of what nowadays is called makanin - razborov diagrams . in this paper </S>",
    "<S> we present an analogue of makanin - razborov process and generalise some of the results from @xcite to free products . </S>",
    "<S> therefore , this paper can be viewed as a first step towards solution of problem [ prob:1 ] .    </S>",
    "<S> the main results of this paper are the following two theorems . recall that for any finitely generated group @xmath10 the set of homomorphisms @xmath1 is in one - to - one correspondence with the set of solutions of the system @xmath11 over @xmath0 .    </S>",
    "<S> let @xmath12 be an equationally noetherian free product of groups and let @xmath2 be a finitely generated ( @xmath0-)group . then the set of all ( @xmath0-)homomorphisms @xmath13 ( @xmath14 , correspondingly ) from @xmath2 to @xmath0 can be described by a finite rooted tree . </S>",
    "<S> this tree is oriented from the root , all its vertices except for the root vertex are labelled by coordinate groups of generalised equations . </S>",
    "<S> to each vertex group we assign the group of automorphisms @xmath15 . </S>",
    "<S> the leaves of this tree are labelled by groups of the form @xmath16 ( @xmath17 , correspondingly ) , where @xmath18 is a coordinate group over @xmath19 .    </S>",
    "<S> each edge of this tree is labelled by a ( @xmath0-)homomorphism . furthermore , </S>",
    "<S> every edge except for the edges from the root is labelled by a proper epimorphism . </S>",
    "<S> each edge from the root vertex corresponds to a ( @xmath0-)homomorphism from @xmath2 to the coordinate group of a generalised equation .    </S>",
    "<S> every ( @xmath0-)homomorphism from @xmath2 to @xmath0 can be written as a composition of the ( @xmath0-)homomorphisms corresponding to the edges , automorphisms of the groups assigned to the vertices , and a specialisation of the variables of the generalised equation corresponding to a leaf of the tree .    </S>",
    "<S> this description is effective , provided that the universal horn theory ( the theory of quasi - identities ) of @xmath0 is decidable .    for any system of equations @xmath20 over an equationally noetherian free product of groups @xmath3 </S>",
    "<S> , there exists a finite family of nondegenerate triangular quasi - quadratic systems @xmath21 over the groups of the form @xmath22 , where @xmath18 is a coordinate group over @xmath19 , and morphisms of algebraic sets @xmath23 , @xmath24 such that for every @xmath25 there exists @xmath26 and @xmath27 for which @xmath28 , i.e. @xmath29 if the universal horn theory of @xmath0 is decidable , then the finite families @xmath30 and @xmath31 can be constructed effectively .    </S>",
    "<S> the above theorems require the group @xmath0 to be equationally noetherian . </S>",
    "<S> recall that a group @xmath0 is called equationally noetherian if for any system of equations @xmath11 over @xmath0 there exists a finite subsystem @xmath32 of @xmath11 such that the sets of solutions of @xmath32 and @xmath11 coincide .    the notion of noetherian ring is central in classical algebraic geometry . </S>",
    "<S> so , it is natural , when studying algebraic geometry over a group @xmath2 , to require @xmath2 to be equationally noetherian . </S>",
    "<S> the property of @xmath2 to be equationally noetherian is equivalent to the zariski topology on @xmath33 to be noetherian for all @xmath34 . </S>",
    "<S> it is therefore necessary in order that every closed set in the zariski topology be a _ finite _ union of irreducible algebraic sets , and every coordinate group be a subdirect product of _ finitely many _ coordinate groups of irreducible algebraic sets . </S>",
    "<S> furthermore , the property of a group to be equationally noetherian gives a lot of structure to the coordinate groups . </S>",
    "<S> as shown in @xcite , @xcite , @xcite and @xcite , it allows one to characterise coordinate groups from many different viewpoints : as groups that satisfy some residual properties ; from the viewpoint of universal algebra ; as direct limits of finite substructures ; as algebraic limit groups ; from model - theoretic viewpoint ; from the viewpoint of the theory of atomic types .    </S>",
    "<S> equationally noetherian groups are abundant . </S>",
    "<S> it is known that every linear group ( over a commutative , noetherian , unitary ring ) is equationally noetherian ( see @xcite , @xcite , @xcite ) . </S>",
    "<S> on the other hand , hyperbolic groups are equationally noetherian ( torsion free case is due to z.  sela , see @xcite and torsion case is due to c.  reinfeldt and r.  weidmann ) , toral relatively hyperbolic groups and cat(0 ) groups with isolated flats are also equationally noetherian ( due to d.  groves , @xcite ) , etc . </S>",
    "<S> all these classes are closed under taking free products of groups . </S>",
    "<S> however , it is not known if the free product of equationally noetherian groups is equationally noetherian .    </S>",
    "<S> let @xmath4 and @xmath6 be two equationally noetherian groups . is the free product @xmath35 equationally noetherian ?    </S>",
    "<S> furthermore , the class of equationally noetherian groups is closed under taking subgroups , finite direct products and ultrapowers ; it is also closed under universal equivalence and separation , see theorem b2 , @xcite .    </S>",
    "<S> when this paper was in the final stage of preparation , a preprint @xcite of e.  jaligot and z.  sela addressing similar questions to the ones studied in this paper was published . note that the general problem of describing the set of homomorphism from a _ finitely generated _ group @xmath2 to an _ </S>",
    "<S> arbitrary _ free product remains open . in their work jaligot and sela </S>",
    "<S> describe homomorphisms from finitely presented groups to ( arbitrary ) free products . in this paper </S>",
    "<S> , we require that the free product @xmath0 be equationally noetherian , but give a description of the set of homomorphisms from any finitely generated ( @xmath0-)group to @xmath0 . </S>"
  ]
}