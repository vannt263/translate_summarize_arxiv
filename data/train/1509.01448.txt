{
  "article_text": [
    "collective motion is one of the most ubiquitous collective behaviour displayed by interacting organisms such as cells @xcite , bacteria @xcite , invertebrates ( in locusts : @xcite ; in ants : @xcite ; in honeybees : @xcite ) and vertebrates species ( in birds : @xcite ; in fish : @xcite ; in mammals : @xcite ) including humans @xcite .",
    "a growing interest to decipher the link between individual behaviours and collective patterns has arisen out of these numerous observations and led to the development of models simulating agents performing collective movement inspired from birds , mammals or fish , the latter being the focus of this paper .",
    "different types of model exist to describe fish schooling . in self - propelled particles ( spp ) models ( synchronous @xcite or asynchronous @xcite ) firstly used for computer animation @xcite ,",
    "interactions between fish are mostly composed by a collision avoidance component , a alignement component and a cohesion component @xcite .",
    "similarly , in social forces ( sf ) models fish are considered as newtonian particles subjected to social and physical forces that respectively ensure the cohesion of the group and reflect the interaction ( drag for example ) with the environment @xcite .",
    "both spp and sf models have inspired several studies in statistical physics that aim to characterize features of a large number of interacting agents at the collective level @xcite .",
    "finally , kinematic models describe the evolution of the trajectory of fish by a stochastic differential equation @xcite . this modelling approach has successfully described the movement of fish in closed environment and is a continuous time formulation of a particular case of random walks ( rw ) .",
    "random walks describe stochastic trajectories build by successive random steps that can be drawn from a uniform distribution ( unbiased random walk ) or a non - uniform distribution ( biased random walked ) .",
    "these probabilistic models have a wide range of application , from simulating the brownian motion of particles to the exploratory patterns of many species including humans @xcite .      in all mentioned models of schooling",
    ", the agents move according to their conspecifics ( position , speed , orientation or a combinaison ) .",
    "multiple hypothesis have been proposed to calculate the subset of individuals that influence the motion of a focal fish : the metric perception includes all individuals situated within a defined distance ; the topological perception includes the @xmath0 proximal neighbors ; the perception based on voronoi tessellation includes the fish connected to the focal fish by the delaunay triangulation . however , while these hypothesis produce coherent movement of simulated agents , they are not sufficiently constrained by known biology .",
    "therefore , recent works are now based on visual perception @xcite . in these models ,",
    "the focal fish does not interact with its neighbors according to their cartesian coordinates but according to their representation in its visual field .",
    "thus , theoretical and experimental studies highlighted that the visual sensory system of fish is determinant for information transfer during collective motion .",
    "indeed , the comparison of interaction mechanisms showed that a vision - based model outperforms others mechanisms ( metric , topologic , voronoi ) in explaining experimental data @xcite . in parallel , the increasing knowledge on the visual system of fish allow to develop model based on sensory systems more coherent with the biological reality .",
    "the characterization of the vision of cyprinids reveals that they have a wide visual coverage in the horizontal and vertical planes and an acute vision in the front - dorsal region @xcite . to make a step towards more realistic sensory systems , we introduce in this paper a new mechanism based on a the perception of 3d stimuli in the visual field .",
    "we simulate fish - agents that perceive stimuli ( congeners , environment ) according to the solid angle -an analogous of the planar angle but in 3d- that they intercept in their visual field .",
    "once the focal fish has perceived potential stimuli , this information has to be processed and translated into a movement of the individual . in spp and sf models considering only the influence of congeners , a vector of interaction is computed with all neighbors situated in a delimited range ( metric models ) or according to their proximity rank ( topological models ) .",
    "then , the focal fish moves along the resulting force computed by a weighted summation process of the different interaction forces applied on the focal fish . while it results in coordinated motion of agents , these models can also produce biological incoherent behaviour of the simulated individuals : the influence of some congeners can be omitted / overestimated or the resulting vector can point towards a direction where no stimulus is present ( fig .  [",
    "fig : problem ] ) .",
    "in addition , such process have difficulties in reproducing experimentally observed choices between two concurrent stimuli .",
    "for example , zebrafish larvae randomly chose to orient towards one of two equidistant source of light and do not follow the bisector @xcite . here",
    ", we present a novel algorithm to account for information processing by the individual . rather than summing influential vectors , we propose to sum probability distribution functions to orient towards the different stimuli .",
    "as shown in the model section , such mixture distribution can spontaneously produces transitions from choice to consensus and better describes different biological observations .",
    "closest neighbors can be conflicting ( c ) or disproportionate regarding the rest of the group ( d ) .",
    "even in visual model , the position of the perceived fish can lead to a resulting vector oriented between the stimuli ( e ) or the number of fish can be overestimated by their captured angle due to proximity ( f ) . ]",
    "it would be interesting to develop a multilevel modeling approach that takes into account models for perception and information processing by the individuals .",
    "beyond existing spp and rw models , it requires extending the description of the agents by biologically relevant properties .",
    "we propose a new hybrid class of models , at the crossroads of both rw and spp models , that include a probabilistic component ( inspired by rw ) in the behaviour of the agents that react to their perception field ( inspired by spp models ) . in the model",
    ", the agents chose a direction to move according to a probability distribution function ( pdf ) that is determined by the presence of stimuli in their visual perception field , in accordance with observed stochastic choices made by zebrafish larvae @xcite .",
    "this pdf is computed as a mixture distribution of von mises distributions centered on each perceived stimulus .",
    "once the probability distribution function has been computed , the direction of the agent is chosen accordingly to this pdf . with this model ,",
    "we simulate motion of single individuals or groups of fish evolving in a bounded environment that can include other stimuli like spots of interest .    to validate this model",
    ", we measured the individual ( single fish ) and collective ( group of 10 fish ) motion of adult zebrafish in different environmental conditions .",
    "zebrafish form loosely cohesive groups that do not show strong alignment and could be challenging to model with a classical approach .",
    "in addition , we observed the behaviour of zebrafish in a bounded tank with potential spots of interest to take into account the interactions with the environment .",
    "first , we analysed the locomotion of isolated individual evolving in a uniform environment to determine the intrinsic characteristics of their motion ( speed , change in orientation and probability of presence ) .",
    "we performed similar measurements in heterogeneous environment by placing two floating plastic disk acting as attractive spots .",
    "then , we investigated the influence of conspecifics on the spatial distribution of fish by observing collective motion of group of zebrafish in both homogeneous and heterogeneous environment .",
    "we measured their probability of presence in the experimental tank and their inter - individual distances .",
    "this experimental data is used for both , setting parameter values for individual behaviour , as well as to compare the predictions obtained from our model .",
    "our aim is to model fish swimming in nearly 2d in a bounded environment with potential spots of interest that attract them . to do so",
    ", we simulate agents that update their position vector @xmath1 with a velocity vector @xmath2 though a discrete time process in a bounded two - dimensional space :    @xmath3    @xmath4    with @xmath5 the linear speed of the @xmath6 agent and @xmath7 its orientation .",
    "since we focus on the decision making process of the fish to chose its orientation in a complex environment ( walls of the tanks , spots of interest ) with other fish , we assume the simple hypothesis that the linear speed @xmath5 of the agent is randomly drawn from the instantaneous speed distribution measured in our experiments .",
    "the novelty of this model is the computation of the orientation @xmath7 .",
    "we model the spherical visual perception field of fish ( fig .",
    "[ figure2 ] ) and describe the probability for fish to move in all potential directions by a circular probability density function extending from @xmath8 to @xmath9 .",
    "thus , @xmath7 is not computed as a resulting vector with potential noise but is drawn from a circular probability density function ( pdf ) formed by von mises distributions , an equivalent to the gaussian distribution in circular probability .",
    "this pdf is characterized by a measure of location @xmath10 ( equivalent to the mean of a gaussian pdf ) and a measure of concentration @xmath11 ( an inversely proportional equivalent to the variance of a gaussian pdf ) . for a fish that perceives no stimuli ,",
    "the distribution of probability is described by @xmath12 while the value of @xmath13 is determined experimentally ( eq .  [ pdfbasic ] ) . by doing so , a fish that perceives no stimuli",
    "will move forwards with deviation inversely proportional to @xmath13 . since our goal is to model fish moving in a bounded tank ,",
    "we introduce the interaction of the fish with the walls in the computation of this pdf .",
    "as soon as a fish is situated in a distance shorter than a threshold value @xmath14 , we assume that the fish starts a wall - following behaviour . to simulate this behaviour ,",
    "the value of @xmath10 is not equal to 0 but to the direction along the followed wall .",
    "since there are two potential direction , the pdf is computed as the weighted sum of the pdf associated with each direction .",
    "thus , the pdf @xmath15 for a fish to move in each potential direction @xmath16 in a bounded tank without perceptible stimuli is given by :    @xmath17 , & \\text{if } d \\geq d_w \\\\",
    "\\frac{1}{2 } \\sum_{i=1}^{2 } \\frac{1}{2 \\pi i_0 ( \\kappa_{w } ) } exp[\\kappa_{w } cos(\\theta - \\mu_{w_i } ) ] , & \\text{if } d <",
    "d_w \\\\ \\end{dcases } \\label{pdfbasic}\\ ] ]    @xmath18    with @xmath19 the distance with the closest wall , @xmath14 the threshold distance determining the interaction with the walls , @xmath20 and @xmath21 the dispertion parameters respectively associated with the basic - swimming and wall - following behaviours , @xmath22 and @xmath23 the two possible directions along a considered wall and @xmath24 the modified bessel function of first kind of order zero .",
    "the value of @xmath14 , @xmath20 and @xmath21 are determined experimentally .",
    "equations ( [ equa : zebrapos ] ) to ( [ besselw ] ) are sufficient rules to simulate a fish swimming in an experimental tank . however , since we aim at simulating groups of fish moving in a homogeneous but also heterogeneous environment , we implement the interactions with other congeners and spots of interest .",
    "as soon as the fish perceive stimuli in its perception field , its pdf is influenced by those stimuli following two steps : information gathering and information processing .",
    "we simulate fish - agents that can perceive and react to 3 dimensional stimuli perceived in their visual field .",
    "fish are modeled as 3d polygons with 6 vertices swimming on a 2d plane space ( fig .",
    "[ figure2]a ) .",
    "their visual perception is simulated as a cyclopean vision sensor that has a 270 degree spherical field of view extending frontally and laterally and an infinite effective radius ( fig .",
    "[ figure2]b ) .",
    "fish perceive potential stimuli by the solid angle that the projection of their extremities capture in their spherical perception field ( fig .",
    "[ figure2]c ) .        to reflect our experimental conditions , we include two potential stimuli in our simulations : fish and spots of interest .",
    "fish are considered as polygons of length = 0.035 m , width = 0.01 m and height = 0.01 m whose extremities form the two boundaries of the fish .",
    "spots of interest are considered as floating disks with a radius of 0.1 m floating 0.05 m above the plane space .",
    "once all potential stimuli have been perceived , the model computes a pdf for the focal fish to move according to each stimulus ( fish or spots in this study ) .",
    "for example , the probability of the focal fish to orient towards a perceived fish is given by a von mises distribution clustered around this fish :    @xmath25\\ ] ]    @xmath26    with @xmath16 , the potential direction of movement of the fish , @xmath27 the location of the perceived fish @xmath28 and @xmath29 a measure of concentration .",
    "the model draws such distribution for each stimulus ( fish or spot ) in the perception field of the focal fish .",
    "then for each type of stimuli , it performs a weighted sum of all distributions proportional to the ratio of the solid angle @xmath30 captures by each stimulus to the sum of the solid angles captured by all stimulus @xmath31 . for example",
    ", the pdf computed for the perceived fish is given by :    @xmath32\\ ] ]    @xmath33    with @xmath34 to the sum of the solid angles @xmath35 captured by all fish .",
    "thanks to the summation of pdfs rather than vectors , the model intrinsically produces transitions between consensus ( i.e. the fish orients between two stimuli ) and choice ( i.e. the focal fish orients toward one of two stimuli ) according to the angle between to stimuli ( fig .",
    "[ figure3 ] ) .     according to the position of the neighboring individuals .",
    "contrary to classical models , the fish will not always move forward as it would be predicted by weighting the attraction vectors . when the neighbors are far from each other , the focal fish will randomly orient towards one of them . on the contrary , if the two neighbors are closer , the sum of the pdf associated with to these fish predict that the focal fish will favor the direction between them rather than selecting one of them .",
    "thus , by summing the pdfs rather than interaction vectors , the model reproduce transitions from choice to consensus and vice versa according to the angle between two perceived stimuli . ]",
    "we calculate a similar pdf for the spots of interest perceived by the focal fish :    @xmath36\\ ] ]    @xmath37    with @xmath38 the location of the center of the perceived spots , @xmath39 the dispersion parameters of the perceived spots , @xmath40 the solid angle captured by the spot and @xmath41 the sum of the solid angles @xmath42 captured by all spots .",
    "once the pdfs have been computed for each type of stimuli ( fish - spots ) , we calculate a weighted sum of the pdfs to obtain the @xmath43 probability distribution function @xmath44 of the focal fish to move towards a given direction . in this first approach",
    ", we assumed that the weight of the pdf associated with each type of stimuli is a linear function of the total solid angle @xmath31 that they capture in the perception field of the focal fish ( fig .",
    "[ figure4 ] ) .",
    "this implies that the fish respond more strongly to largely perceived stimuli but it also allows a potential hierarchy in the response to different stimuli .",
    "thus , the @xmath43 pdf f(@xmath16 ) is given by :    @xmath45    @xmath46    @xmath47    with @xmath48 and @xmath49 the parameters weighting the influence of respectively the fish and the shelters for a fish distant from any wall and @xmath50 and @xmath51 for a fish following a wall .",
    "these parameters are fitted experimentally .",
    "then , we numerically compute the cumulated distribution function ( cdf ) corresponding to this custom pdf @xmath44 by performing a cumulative trapezoidal numerical integration of the pdf in the interval [ @xmath8,@xmath9 ] .",
    "finally , the model draws a random direction @xmath7 in this distribution by inverse transform sampling .",
    "the position of the fish is then updated according to this direction and his velocity with equations  [ equa : zebrapos ] and  [ equa : zebraspeed ] .",
    "we measured the positions of ten fish tested individually swimming alone in our 1.20 m x 1.20 m experimental tank during 1 hour . based on this tracking",
    ", we build the trajectories of the fish and computed their speed and change in orientation .",
    "an example of a 10 minutes trajectory of a fish is given on fig .",
    "[ figure5]a .",
    "[ figure6]a shows the cumulated distribution of all instantaneous speeds measured in a homogeneous environment with a average speed of 0.07 @xmath53 003 ms@xmath54 .",
    "similarly , fig .",
    "[ figure6]b represents the cumulative distribution of the changes of orientation along the trajectories and highlights that fish are mainly moving forwards with soft change of orientation ( average change = -0.03 @xmath53 0.84 rad ) .",
    "the distribution of the positions detected in the tank ( fig .",
    "[ figure11]a ) shows that the higher probability of presence was found along the walls .",
    "thus , in a homogeneous environment , fish were mainly swimming along the walls of the tank and avoid the centre of it .",
    "we used this experimental data to set the parameters of our model in order to simulate the movement of a single fish in a homogeneous tank . in the simulations , the speed of the agent is drawn from the experimental distribution of the instantaneous speed of the fish .",
    "speeds are drawn independently from each other so that there is no correlation between the speed of agent @xmath28 at time @xmath55 and @xmath56 . while this differs obviously from the reality , for simplicity we do not take into account speed matching in this first parametrization of our new model .",
    "experiments with single fish allow us to fit the parameter value characterizing the change of direction of fish @xmath13 .",
    "to do so , we measured the change of direction of the fish when they were at least at 0.30 m from any walls . by doing so , we excluded the potential influence of the walls and consider only the intrinsic change of direction .",
    "then , we compared this experimental distributions to theoretical ones and select the best fitting . in this first approach , we chose the sum of least squares minimization as a rapid and low computational costly fitting method .",
    "the best fitting of this experimental distribution was obtained by @xmath57 , as shown by fig .",
    "[ figure7 ] .    for experiments involving a single fish ,",
    "only the interaction with the walls of the tank is present . therefore , the other relevant parameters are the distance of interaction with the walls @xmath14 and the measure of concentration @xmath58 of the pdfs associated with wall following . to estimate these parameter values , we performed simulations with different couples of value ( @xmath14 , @xmath58 ) and compared the experimental distributions of change in orientation and of probability of presence with those generated by the simulations .",
    "fitting of these parameters showed that @xmath59 and @xmath60 are the best values to reproduce our experimental data ( fig .",
    "[ figure8 ] ) . a 10 minutes trajectory of a simulated fish with these parameter values is shown on fig  [ figure5]c .     and @xmath61 determining the interaction of a single fish with the walls of the tank .",
    "the parameter @xmath14 corresponds to the threshold distance of interaction with the walls and @xmath61 is inversely proportional to the width of the von mises distribution associated with wall following . to each couple ( @xmath14 , @xmath61 ) corresponds a couple of squares whose colours indicate the value of the sum of least squares obtained for the comparison of the changes of direction ( left square ) and the probability of presence ( right square ) with the experimental data shown in fig .",
    "[ figure6]b and fig .",
    "[ figure11]a .",
    "lower values of sum of least squares corresponding to better fits are in the purple and blue colour scale .",
    "( a ) the exploration of a first set of parameter values indicated that the best couple ( @xmath14 and @xmath61 ) are found for values ( @xmath59 and @xmath62 ) , highlighted in the red rectangle .",
    "( b ) the refinement of the parameters exploration in the ranges determined in ( a ) showed that the best fitting is obtained by @xmath59 and @xmath63 . ]    then , we performed experiments with 10 groups of 10 zebrafish .",
    "as observed for single fish experiments , fish were mostly detected along the walls of the tank ( fig .",
    "[ figure11]c ) .",
    "since we did not track the fish individually when swimming in group , we could not build the individual trajectories of the fish .",
    "however , we measured the distance between all pair of fish at each time step as a measure of group cohesion .",
    "the distribution of these interindividual distances shows an average of 0.394 m @xmath53 0.38 m with the mode of the distribution between 0.1 and 0.2 m ( fig .",
    "[ figure9]a ) .    to simulate experiments with 10 fish ,",
    "we introduce three parameters describing the interaction with the fish : the measure of concentration @xmath64 associated with the pdf computed for each fish and the parameters @xmath65 and @xmath66 that weight the influence of other individuals on a fish that is far from ( @xmath65 ) or close ( @xmath66 ) to a wall .",
    "the value of @xmath64 is assumed to be similar than @xmath61 and is equal to 20 . by doing so",
    ", we consider that a fish orients towards a given target @xmath10 with a high accuracy .",
    "to determine the value of the weights @xmath67 we perform simulations with different values of ( @xmath65 , @xmath66 ) and compare the distribution of interindividual distances and probability of presence with those obtained for the experiments .",
    "the best values to reproduce both distributions are @xmath68 and @xmath69 ( fig .",
    "[ figure10 ] ) .",
    "thus , fish that follow a wall are less influenced by other congeners than fish situated in the center of the tank . with these parameter values ,",
    "our model was able to reproduce the probability of presence displayed by groups of 10 zebrafish as shown in fig .",
    "[ figure11]d .",
    "concerning the distribution of interindividual distances , the model reproduces the decreasing distribution observed in the experiments except for the mode of the distribution that is between 0 m and 0.1 m ( fig .",
    "[ figure9]b ) .",
    "and @xmath66 determining the interaction of a focal fish that far away or close to a wall with other individuals .",
    "to each couple ( @xmath65 , @xmath66 ) corresponds a couple of rectangles whose colours indicate the value of the sum of least squares obtained for the comparison of the interindividual distances ( left rectangle ) and the probability of presence ( right rectangle ) with the experimental data shown in fig .",
    "[ figure9]a and fig .",
    "[ figure11]b .",
    "lower values of sum of least squares corresponding to better fits are in the purple and blue colour scale .",
    "( a ) the exploration of a first set of parameter values indicated that the best couples ( @xmath65 , @xmath66 ) are found for values ( @xmath70 , @xmath71 ) , highlighted in the red rectangle .",
    "( b ) the refinement of the parameters exploration in the ranges determined in ( a ) showed that the best fitting is obtained by @xmath68 and @xmath69 . ]",
    "we added two spots of interest in the experimental tank placed at 25@xmath72 cm from two opposite corners along the diagonal of the tank .",
    "these spots consisted of blue plastic disks ( 20 cm of @xmath73 ) floating at the water surface and hung by nylon threads .",
    "an example of path followed by a fish during 10 minutes is shown on fig .",
    "[ figure5]b .",
    "we calculated similar parameters from the individual positions of fish ( 10 x 1 fish ) moving alone in the tank with two spots .",
    "in the presence of two spots , the fish are mainly detected along the walls and under the spots as shown by their probability of presence ( fig .",
    "[ figure13]a ) .",
    "experiments with single fish also showed that fish decreased their speed under these spots . indeed , the separation of the speed distribution measured _ outside _ or _ inside _ the spots shows that the average speed was three times slower when fish were located under a floating disk ( fig .  [ figure12]a ) . on the contrary",
    ", the presence of the floating disks did not affect the distribution of the changes in orientation that were similar _",
    "outside _ and _ inside _ ( fig .  [ figure12]b ) .    for experiments involving a single fish , only the interaction with the walls and the shelters of the tank",
    "are present .",
    "since @xmath59 and @xmath60 were fitted by our experiments in homogeneous environment , we explore the parameter values of @xmath74 and @xmath75 ( the ponderation of the influence of the spots ) and assume that the measure of concentration associated with the spots @xmath76 .",
    "we perform simulations for different values of @xmath77 and compare their results with the experimental probability of presence and distribution of change of orientation . the best value to reproduce our experimental data are @xmath78 and @xmath79 as shown by fig .",
    "[ figure14 ] . as observed for the influence of the congeners ,",
    "these values indicate that fish following a wall are less influenced by the spots than fish swimming in the centre of the tank . with these parameter values ,",
    "the model reproduce the spatial distribution of the fish along the wall and under the floating disks ( fig .",
    "[ figure13]c ) .",
    "and @xmath75 determining the interaction of a focal fish that far away or close to a wall with the spots of interest .",
    "to each couple ( @xmath74 , @xmath75 ) corresponds a couple of rectangles whose colours indicate the value of the sum of least squares obtained for the changes of orientation ( left square ) and the probability of presence ( right square ) with the experimental data shown in fig .",
    "[ figure12]b and fig .",
    "[ figure13]a .",
    "lower values of sum of least squares corresponding to better fits are in the purple and blue colour scale .",
    "( a ) the exploration of a first set of parameter values indicated that the best couples ( @xmath74 , @xmath75 ) are found for values ( @xmath80 , @xmath81 ) , highlighted in the red rectangle .",
    "( b ) the refinement of the parameters exploration in the ranges determined in ( a ) showed that the best fitting is obtained by @xmath78 and @xmath79 . ]    finally , we observed 10 groups of 10 zebrafish swimming in the presence of two spots of interest during one hour .",
    "in this case , the fish were also observed mainly under the spots and along the walls but show a preference for the spots ( fig .",
    "[ figure13]b ) .",
    "the measure of the inter - individual distances shows that the presence of spots does not have a strong influence on the distance between the fish ( fig .",
    "[ figure16]a ) .",
    "indeed , the average distance between the individuals is @xmath82 m @xmath83 m , which is 6 mm less than observed in the absence of floating disks .",
    "we simulated these experiments with groups of 10 zebrafish with our model by integrating the interactions of the agents with both the other fish and the spots of interest . in the previous experiments ,",
    "the parameter ruling the interactions with the fish ( @xmath65 , @xmath66 ) and the spots of interest ( @xmath74 , @xmath75 ) were fitted independently but here , both stimuli are simultaneously present in the perception field of the fish .",
    "therefore , we investigate the relative importance of both stimuli by weighting the influence of the other fish or the spots of interest . to do so , we multiply the previously fitted values of ( @xmath65 , @xmath66 ) and ( @xmath74 , @xmath75 ) by different weighting factors @xmath84 and @xmath85 . for example , values @xmath86 and @xmath87 imply that the two stimuli are simply added while values @xmath88 and @xmath89 imply that the influence of the fish is divided by 2 and the influence of the spots by 5 .",
    "thus , we perform simulations for each couple of ( @xmath90 ) and compare the distributions of the probability of presence and the interindividual distances with those measured experimentally .",
    "the best fit is given by @xmath91 and @xmath92 ( fig .",
    "[ figure15 ] ) which implies that the influences of the fish and the spots have to be decreased by a factor 2 and 9 respectively .",
    "therefore , when both stimuli ( congeners and spots ) are perceived by the fish , the best values of @xmath67 and @xmath93 to reproduce the experimental data are @xmath94 , @xmath95 , @xmath96 and @xmath97 . while these values give a correct fit of the experimental probability of presence ( fig .",
    "[ figure13]d ) , the model do not perfectly reproduce the distribution of the interindividual distances ( fig .",
    "[ figure16]b ) . similarly than for the groups of fish in a homogeneous environment , the mode interindividual distances measured in the simulation is between 0 and 0.1 m while the mode of the experimental distances is between 0.1 and 0.2 m .     and the spots @xmath98 in simulation with 10 zebrafish swimming with two spots of interest .",
    "to each couple ( @xmath99 , @xmath98 ) corresponds a couple of rectangles whose colours indicate the value of the sum of least squares obtained for the comparison of the interindividual distances ( left square ) and the probability of presence ( right square ) with the experimental data shown in fig .",
    "[ figure16]a and fig .",
    "[ figure13]b .",
    "lower values of sum of least squares corresponding to better fits are in the purple and blue colour scale .",
    "the exploration of a set of parameter values indicated that the best couples ( @xmath99 , @xmath98 ) is @xmath88 , @xmath100 . ]",
    "in this study , we observed individual and collective behaviour of zebrafish in homogeneous and heterogeneous environments .",
    "firstly , we observed single _ d. rerio _ swimming in our experimental tank to describe the swimming behaviour of zebrafish . in homogeneous environment",
    ", the fish were mainly following the wall of the tank and avoid the center of it .",
    "this observation was also reported in studies performed with zebrafish and robotic - fish @xcite .",
    "we characterized the motion patterns of single individuals and found out an average speed of @xmath101 m / s and an average change of orientation of @xmath102 rad , in coherence with previous studies performed on single zebrafish individuals @xcite .",
    "our experiments with 10 zebrafish showed that the spatial repartition of the group did not differ significantly from the individual one .",
    "fish in groups were also mainly detected along the walls of the tank .",
    "the presence of floating disks influence the spatial distribution of the fish in the experimental tank .",
    "the shaded area seemed as attractive as the walls since fish showed a similar probability of presence for both stimuli .",
    "these disks had no influence on the change of direction of the fish but resulted in a spatial differentiation of the instantaneous speed of the individuals .",
    "indeed , the fish swam with an average speed of @xmath103 m / s outside the shelters but with an average speed of @xmath104 m / s under them",
    ". such reduction of speed can indicate that shaded areas are potentially considered as temporary resting sites by the fish .",
    "the observation of groups of 10 fish showed similar results with preference for both the walls and the shaded area .",
    "these results show that zebrafish are avoiding free water and prefer to swim near potential shelters ( floating objects or bank ) .",
    "although fish were attracted by the floating disk , they did not seem to avoid the light since their presence under the disk and along the wall ( that are exposed to light ) are similar .",
    "these observations are in accordance with the ecology of the species that shows a diurnal activity in the nepalese and indian shallow water and rice paddies @xcite .",
    "based on our observations and on the literature , we developed a model describing individual and collective motion .",
    "currently , collective motion receives attention from researchers of numerous fields such as biology , physics , computer science and robotics .",
    "current modeling tends to give up traditional methods ( metric or topologic ) accounting for the perception of influential neighbors by the focal fish for vision - based approach @xcite .",
    "here we present a 3d perception system accounting for zebrafish vision in which the objects are described by the solid angle that they capture in their perception field . by doing so , we are closer to a realistic description of the sensory system of the fish . in this first step , we assumed the simple hypothesis that object were homogeneously perceived in this 3d sensory field .",
    "however , the recent characterization of the visual system of zebrafish highlighted centers of acute vision ( i.e. _ areae _ ) in the fronto - dorsal region @xcite .",
    "therefore , future models should take into account such heterogeneity in the perception field .",
    "in addition , the position of the areae differs from one species to the other and is expected to influence the structure of the fish school @xcite .",
    "the extension of our model to 3 dimensional movements would allow to test such hypothesis .",
    "in addition to this sensory system , we proposed a new mechanism to determine the direction of an agent according to its visual field . rather than computing a resulting vectorial force that is applied to the fish , we redefined the modeling approach by describing the decision - making process of the fish to make an intentional movement according to its perception field . in this first step",
    ", we represented the choice of the individual by a stochastic process .",
    "the fish can potentially move in any direction but it will favor directions associated with a perceived stimuli ( congeners for example ) . this stochastic model can reproduce collective behaviour exhibited by species that show cohesive behaviour without presenting higher order or only occasionally without introducing a high level of noise accounting for disturbances .",
    "this is made possible by the representation of the perception field of the fish and its translation into a probability distribution function . by doing so , we are closer to an effective description of the individual decision - making process during motion @xcite . indeed , with such approach of pdfs summation",
    ", we can include potentially all kinds of stimuli ( congeners , environment , food ... ) that are perceived by the fish and account for a choice or consensus between potentially antagonist stimuli .",
    "such choice between two concurrent stimuli has been evidenced in zebrafish larvae that orient towards one of two light source rather than swimming towards their bisector @xcite .",
    "the authors showed that two retinal pathways controlling turn movements and rapid forward swimming are responsible for phototaxis .",
    "such advances on the understanding of information processing by neuronal pathways should be integrated in further multi - scale models to make the link between fish movement , perception of information and its processing based on biological knowledge .",
    "moreover , most of the models consider motion in unbounded homogenous space ( torus geometry ) .",
    "while this hypothesis is reasonable to study the collective behaviour of animal living in pelagic water , the interactions with can not be neglected for species living in small streams .",
    "we extend our model to take into account bounded and heterogenous space getting closer to natural conditions of fish like _",
    "d. rerio_. the model correctly reproduced the behaviour of single individual swimming in a bounded tank .",
    "the fish mainly follows the wall but sometimes swim in the center of the tank .",
    "the probability of presence was also correctly reproduce but the distribution of interindividual distances was biased towards short distances .",
    "this could originate from the absence of preferred distance or avoidance distance between the agents .",
    "indeed , while the agents of the model can overlap , the fish have to respect a distance between them .",
    "such distance was not introduce in this first parametrization of the model to limit the number of parameters . in a heterogeneous environment ,",
    "the model was also able to reproduce the individual trajectories of single fish that transits between the walls and the spots of interest .",
    "as in the homogeneous environment , the probability of presence of groups of fish is also fitted , but again , the distribution of the interindividual distances is biased towards short distances . therefore , these results indicate that the approach developed in this study can successfully describe individual and collective motions of fish but that further version could include additional biological variable and behaviour that are species dependent .",
    "for example , here the probability distribution function for a simulated fish are centered on the _ position _ of the other fish that it perceives but the pdf could be centered on the _ direction _ of the congeners to simulate an alignement behaviour .",
    "rather than developing a model that exactly described the behaviour of zebrafish , our goal was to introduce a new decision - making algorithm for motion in complex environment .    in this study",
    ", we applied our decision making algorithm to an individual - based model ( ibm ) .",
    "recently , a kinetic model ( km ) was proposed to account for the individual movement of isolated zebrafish @xcite .",
    "this model inspired by @xcite took into account a dynamic speed regulation characterizing _",
    "d. rerio _ motion . in our model",
    ", we did not implement a function accounting for speed modulation in order to focus on the decision - making mechanism .",
    "the instantaneous speed was drawn from the experimental distribution with a time step corresponding to the tail - beat period of zebrafish .",
    "then , future work should investigate the impact of the proposed stochastic mechanism for orientation on such kms .",
    "moreover , the development of a km version of our ibm could be an intermediate step towards a continuum model ( cm ) description of the group of agents .",
    "this could then be use to perform large - scale analysis and prediction of the collective behaviour displayed by very large population .",
    "such multiscale modeling approach would allow us to identify the properties of the group that are preserved at all scales of analysis or on the contrary that are specific to a particular level of observation @xcite .",
    "we performed simulations with a small number of agents to mimic our experimental conditions in this study that are close to the natural size of zebrafish group @xcite . while our ibm could model larger groups of tens of individuals , simulations involving thousands of agents would require a longer computational time than km and cm .    in parallel to the understanding of information processing by individuals ,",
    "this approach is also a new step towards bio - inspired algorithms that can be implemented in robotic agents .",
    "indeed , it is a major scientific challenge to build artificial systems composed of robots that can perceive , communicate to , interact with other agents ( biological or robotic ) and adapt to their environment @xcite .",
    "to do so , we need to develop artificial agents that communicate through appropriate channels corresponding to specific animal traits but also that correctly perceive and interpret signals emitted by the animals @xcite .",
    "this was firstly achieved in 2007 by building bio - inspired artificial cockroaches that where able to sense the presence of congeners and to adapt their behaviour following a bio - inspired algorithm @xcite .    in fish ,",
    "an increasing number of studies aim at developing such robotic agents to interact with group of fish @xcite .",
    "current experiments generally involve one robot that follows a predetermined trajectory or that moves according to the position of fish detected through the intermediary of a camera that films the entire setup .",
    "while this methodology is in the line of the classical ethological experimentation to investigate behavioural responses of animals , the development of fully autonomous integrated lures in fish schools ( or other species ) requires the development of perception abilities for the robotic agents as well as adapted behavioural algorithms .",
    "in this perspective , the development of perception - based models is a necessary step towards intelligent artificial systems capable of closing the loop of interaction between animals and robots .",
    "we acquired 150 adult wild - type zebrafish ( _ danio rerio _",
    "ab strain from institut curie ( paris ) .",
    "fish were 18 months old at the time of the experiments .",
    "we kept fish under laboratory conditions , @xmath105 , 500@xmath10s salinity with a 10:14 day : night light cycle .",
    "the fish were reared in 55 litres tanks and were fed two times per day ( special diets services sds-400 scientific fish food ) .",
    "water ph was maintained at 7.5 and nitrites ( no@xmath106 ) are below 0.3 mg / l .",
    "we recorded the behaviour of zebrafish in a 120 x 120 x 30 cm experimental tank made of glass with internal walls covered with white adhesive .",
    "the water depth was kept at 10 cm during the experiments .",
    "a logitechhd pro webcam c920 was mounted 160 cm above the water surface to record experiment at a resolution 1920 x 1080 and at 15 fps .",
    "the camera was connected to a workstation dellprecision t5600 dedicated to the recording of the videos and their analysis .",
    "one halogen lamp ( 450w ) was placed at each corner of the tank and oriented towards the wall to provide indirect lightning of the tank .",
    "the whole set - up was confined behind white sheets to isolate experiments and homogenize luminosity .",
    "we recorded the behaviour of zebrafish swimming in our tank during one hour .",
    "we tested two numbers of individuals ( single fish or groups of 10 fish ) in two environmental conditions ( homogeneous or heterogeneous ) .",
    "the heterogeneous environment was created by adding two floating disks made of blue coloured plexiglas ( 200 mm diameter and 3 mm thick ) suspended by nylon threads .",
    "the two spots were spaced from 70 cm and located on a diagonal of the square . before the trials",
    ", fish were placed with a hand net in a cylindrical arena ( 20 cm diameter ) made of plexiglas placed in the centre of our experimental tank . following a five minutes acclimatization period ,",
    "this arena was removed and fish were able to freely swim in the experimental tank .",
    "we performed 10 replicates for each combinaison of parameters ( number of fish x environmental condition ) .",
    "the recorded videos were analyzed offline using a custom matlab script developed to detect the position of the fish .",
    "this script performed a background subtraction on each frame and transformed it in a binary image according to a pixel intensity threshold given by the user .",
    "the software then identified the blobs on this image and kept only the blobs that were formed by more than 20 and less than 200 pixels ( those values were obtained by manually identifying the fish on multiple frames ) .",
    "since this method did not allow a perfect detection of all the individuals , we developed a second script that was run after the first one and that plotted the frame where a fish ( or more ) was undetected for the user to manually identify the missing individual(s ) . while this analysis tool is time - costly , it allowed us to identify the fish that were partially hidden during a collision / superposition with another fish or the fish that were situated under the floating disks since our program was not able to detect them due to a lack of intensity of the pixel after the background subtraction .",
    "the positions @xmath107 of the fish were recorded at each time step @xmath108 during the experiment with single fish in homogeneous environment and @xmath109 for all other experimental conditions .",
    "this allowed us to build the trajectory of each individual for experiments involving a single fish and to compute the speed of the individuals as well as their change in orientation between successive positions .",
    "the instantaneous speed @xmath110 was calculated on three positions and thus computed as the distance between @xmath111 and @xmath112 divided by 2 time steps while change in orientation were computed as the angle between two successive speed vectors ) .",
    "the distributions of speed were computed only for parts of the trajectory during which the fish were not in freezing behaviour ( i.e. immobile ) .",
    "this corresponds to a spontaneous speed higher than 1 mm per second .",
    "since our tracking system did not resolve collision with accuracy , we did not calculate individual measures for data obtained with groups of fish but characterized the aggregation level of the group .",
    "the model was implemented in a matlab script .",
    "the simulations were run during 10800 time steps , each time step representing an increment of 1/3 second to simulate a total time of 1 hour , similarly to our experiments .",
    "this time step was chosen according to the tail beat frequency of the zebrafish of  2.5 hz . by doing so",
    ", we assume that zebrafish can potentially change their orientation at each tail beat .",
    "the position of the agents on the 2d plane space is described by the position of their head ( x , y , 0 ) .",
    "the positions of the other vertices are computed according to the position of the head and the direction of the fish . to compute the solid angle of the perceived stimuli in the perception field of the focal fish , we calculated the area of the spherical polygon delimited by the projection of the stimuli s vertices on a unit sphere centered on the focal fish .",
    "to do so , we divided the polygon in two spherical triangle and computed their spherical excess using lhuilier s theorem :    @xmath113 \\tan[\\frac{1}{2}(s - b ) ] \\tan[\\frac{1}{2}(s - c ) ] } \\ ] ] with @xmath114 , @xmath115 , and @xmath116 the length of the arcs between the vertices expressed in spherical coordinates ( @xmath117 , @xmath16 , @xmath118 ) and computed by : @xmath119 and @xmath120 the semi parameter given by :    @xmath121",
    "the authors thank filippo del bene ( institut curie , paris , france ) that provided us the fish observed in the experiments reported in this paper .",
    "this work was supported by european union information and communication technologies project assisibf , ( fp7-ict - fet n. 601074 ) .",
    "the funders had no role in study design , data collection and analysis , decision to publish , or preparation of the manuscript .",
    "m.  ballerini , n.  cabibbo , r.  candelier , a.  cavagna , e.  cisbani , i.  giardina , a.  orlandi , g.  parisi , a.  procaccini , m.  viale , and v.  zdravkovic . empirical investigation of starling flocks : a benchmark study in collective animal behaviour .",
    ", 76:201215 , 2008 .",
    "fischhoff , s.r .",
    "sundaresan , j.  cordingley , h.m .",
    "larkin , m.j .",
    "sellier , and d.i .",
    "social relationships and reproductive state influence leadership roles in movements of plains zebra , _ equus burchellii_. , 73:825831 , 2007 .",
    "lemasson , j.j .",
    "anderson , and r.a .",
    "collective motion in animal groups from a neurobiological perspective : the adapive benefits of dynamic sensory loads and selection attention .",
    ", 261:501510 , 2009 .",
    "a.  strandburg - peshkin , c.r .",
    "twomey , n.w.f .",
    "bode , a.b .",
    "kao , y.  katz , c.c ioannou , s.b .",
    "rosenthal , c.j .",
    "torney , h.s .",
    "levin , and i.d .",
    "couzin . visual sensory networks and effective information transfer in animal groups . , 23:r709 , 2013 .",
    "s.  butail , g.  polverino , p.  phamduy , f.  del  sette , and m.  porfiri .",
    "influence of robotic shoal size , configuration , and activity on zebrafish behavior in a free - swimming environment .",
    ", 275:269280 , 2014 .",
    "t.  schmickl , s.  bogdan , l.  correia , s.  kernback , f.  mondada , m.  bodi , a.  gribovskiy , s.  hahshold , d.  miklic , m.  szoped , r.  thenius , and j.  halloy .",
    "assisi : mixing animals with robots in a hybrid society . in _",
    "biomimetic and biohybrid systems lecture notes in computer science _ ,",
    "pages 441443 , 2013 .",
    "j.  halloy , f.  mondada , s.  kernback , and t.  schmickl . towards bio - hybrid systems made of social animals and robots . in _",
    "biomimetic and biohybrid systems lecture notes in computer science _ ,",
    "pages 384386 , 2013 .",
    "j.  halloy , g.  sempo , g.  caprari , c.  rivault , m.  asadpour , f.  tche , i.  sad , v.  durier , s.  canonge , j.m .",
    "am , c.  detrain , n.  correll , a.  martinoli , f.  mondada , r.  siegwart , and j.l .",
    "social integration of robots into groups of cockroaches to control self - organized choices .",
    ", 318:11551158 , 2007 .",
    "faria , j.r.g .",
    "dyer , r.o .",
    "clment , i.d .",
    "couzin , n.  holt , a.j.w .",
    "ward , d.  waters , and j.  krause . a novel method for investigating the collective behaviour of fish : introducing robofish. , 64:12111218 , 2010 .",
    "t.  landgraf , h.  nguyen , s.  forgo , j.  schneider , j.  schrer , c.  krger , h.  matzke , r.o .",
    "clment , j.  krause , and r.  rojas .",
    "interactive robotic fish for the analysis of swarm behavior . in _ advances in swarm intelligense , lectures notes in computer science _ , pages 110 , 2013 ."
  ],
  "abstract_text": [
    "<S> collective motion is one of the most ubiquitous behaviours displayed by social organisms and has led to the development of numerous models . </S>",
    "<S> recent advances in the understanding of sensory system and information processing by animals impel to revise classical assumptions made in decisional algorithms . in this context </S>",
    "<S> , we present a new model describing the three dimensional visual sensory system of fish that adjust their trajectory according to their perception field . </S>",
    "<S> furthermore , we introduce a new stochastic process based on a probability distribution function to move in targeted directions rather than on a summation of influential vectors as it is classically assumed by most models . </S>",
    "<S> we show that this model can spontaneously transits from consensus to choice . in parallel </S>",
    "<S> , we present experimental results of zebrafish ( alone or in group of 10 ) swimming in both homogeneous and heterogeneous environments . </S>",
    "<S> we use these experimental data to set the parameter values of our model and show that this perception - based approach can simulate the collective motion of species showing cohesive behaviour in heterogeneous environments . </S>",
    "<S> finally , we discuss the advances of this multilayer model and its possible outcomes in biological , physical and robotic sciences . </S>"
  ]
}