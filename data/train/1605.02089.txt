{
  "article_text": [
    "most data analysis in x - ray astronomy concentrate on describing single datasets or on characterizing samples with results of fits of individual datasets .",
    "once a good description of an example dataset is found , the analysis of comparable datasets follows . finally , the results of all those individual analyses are compared and interpreted .    for instance , a particular parameter is found to depend on other parameters .",
    "instead of going back to the data analysis and fitting this dependency directly to enhance the parameter precision or break degeneracies ( feasible through reduced degrees of freedom ) , the dependency is then analyzed on its own . in another way , the former analysis is indeed repeated but with this parameter fixed according to the discovered dependency .",
    "furthermore , if parameters can not be constrained well , it is common to keep those parameters fixed to a certain standard value .",
    "thus , one can not gain any physical information from this fixed parameter and , more importantly , systematical effects might arise .",
    "the reason for not following sophisticated ways is usually a lack of computation power .",
    "implementing parameter correlations or dependencies would require one to analyze all data at the same time .",
    "however , since computer power has increased and parallel computation using several computers is possible , this situation has changed today . in other words , fitting data simultaneously has become feasible even when large numbers of datasets ( e.g. , 50 - 100 pointings at a single source ) are to be considered .",
    ".advantages and disadvantages of fitting several datasets simultaneously . [ cols=\"<,<\",options=\"header \" , ]     [ tab : procontra ]    in section  [ sec : implementation ] we introduce an implementation of simultaneous data analysis into the ` interactive spectral interpretation system ` ( isis , * ? ? ?",
    "* ) , which has been `` designed to facilitate the interpretation and analysis of high resolution x - ray spectra '' . in section  [ sec : applications ] , we present ideas for possible applications of simultaneous data analysis and further demonstrate the power of this method on the example of the transient x - ray binary gro  j100857 in section  [ sec : gro1008 ] .",
    "finally , we discuss questions and issues , which arise by comparing advantages and disadvantages of simultaneous fits ( table  [ tab : procontra ] ) .",
    "isis @xcite was developed to fit x - ray spectra , but it can also be used to analyze nearly all kinds of data due to its strong customization capability @xcite compared to , e.g. , xspec @xcite .",
    "for instance , user - defined fit - functions , as well as complex correlations between data and models , can be implemented .",
    "however , functions to handle these correlations for a large number of parameters and datasets in an easy way are not yet available .",
    "before we describe the technical realization of simultaneous data analysis in isis , we introduce new notations used by the implemented functions .      the parameters of a model which is fitted to data either act on all datasets loaded into isis , or on an individual dataset .",
    "by defining parameters for each dataset and tying them to each other , parameters can be linked to multiple datasets similar to the approach chosen , e.g. , in xspec .",
    "we call multiple datasets , which should be fitted with the same set of parameters , a _ datagroup_. the corresponding parameters are called _ group parameters_. _ global parameters _ denote parameters which act on all datagroups .     and @xmath1 simultaneous datasets , forming the datagroup a and b , respectively . both datasets have their own group parameters , resulting from a model with @xmath2 parameters .",
    "some of the group parameters are the same for both datagroups and are called global parameters . ]",
    "figure  [ fig : terminology ] illustrates these definitions . in this example , a dataset requires a model with @xmath2 parameters .",
    "there are simultaneous data from @xmath3 detectors available which can be described by the same parameters .",
    "these datasets define the datagroup a with @xmath2 free parameters .",
    "another group of data was recorded by @xmath1 detectors .",
    "these datasets define an individual datagroup b with , again , @xmath2 free parameters . during the analysis of both groups",
    ", however , it turns out that a specific parameter seems to be equal for both data groups within the uncertainties . as a result ,",
    "the two individual values for this parameter are tied to each other , resulting in a global parameter .",
    "that reduces the number of free parameters by one and the remaining group parameters can be constrained better .",
    "since simultaneous fits can have large numbers of fit parameters connected by a complicated logic , we provide a collection of all functions necessary to initialize and perform simultaneous fits in isis .",
    "the initialization of a simultaneous fit is performed via    ....   simfit = simultaneous_fit ( ) ; ....    where ` simultaneous_fit ` returns a structure ( ` struct_type ` ) , which has to be assigned to a variable , here ` simfit ` .",
    "the structure contains several functions and fields to handle simultaneous fits .",
    "the documentation of each function is available using the ` help`-qualifier .",
    "some important functions are described in the following .    ....",
    "simfit.add_data(filenames ) ; ....    this defines a datagroup and loads the spectra given by ` filenames ` , which must be an array of strings .",
    "the function also allows other data than spectra to be loaded or defined .    ....",
    "simfit.fit_fun(model ) ; ....    the string ` model ` defines the fit - function to be used for all datasets . here",
    ", the placeholder % can be used instead of a component instance . in this case individual group parameters are applied to each datagroup automatically .    ....",
    "simfit.set_par_fun(parameter , function ) ; ....    this is probably one of the most useful functions . like the isis intrinsic function , the value of the ` parameter `",
    "is determined by the given ` function ` .",
    "the % -placeholder can be used within the string ` parameter ` to apply the function to the corresponding parameter of each data group .",
    "however , the function may contain other parameters or even a single parameter name as well . in the latter case ,",
    "if the function is also applied to all datagroups ( using the % ) , the single parameter is treated as global parameter from now on .",
    "+ because a simultaneous fit results in a large number of parameters , a single call to a fit - routine ( ` fit_counts ` ) will take a long time . in the example of the previous section , the final model fitted to the data consists of @xmath4 parameters , where only @xmath5 are free . to reduce the runtime of a fit , three fit - routines are implemented within the simultaneous- fit - structure .    ....",
    "simfit.fit_groups(groupid ) ; ....    instead of perfoming a @xmath6-minimization of all parameters and datasets , this function loops over all datagroups and fits only the associated parameters ( group parameters ) .",
    "if a group is specified by the optional ` groupid ` , then only the group parameters of this particular group are fitted .    ....",
    "simfit.fit_global ( ) ; ....    instead of fitting the group parameters , this function fits the global parameters only . since all defined data groups have to be taken into account , the fit usually takes longer than fitting the group parameters .",
    "+      as already mentioned , the runtime of simultaneous fits is increased compared to fitting a single dataset only .",
    "thus , uncertainty calculations of parameters , where a certain parameter s range has to be found corresponding to a change in @xmath6 , will be affected dramatically by the high runtime .",
    "furthermore , it is necessary to distinguish between group- and global parameters .",
    "we recommend to compute the uncertainty intervals for each parameter on a different machine by , e.g. , using @xcite or ` mpi_fit_pars ` and the ` slmpi ` module . we compared the runtime of a parallel uncertainty calculation in isis with a serial approach in xspec . estimating the uncertainties of 10 parameters in parallel ( i.e. , on 10 cores ) is faster by more than a factor of 3 ( 21ks vs. 60ks ) .",
    "additionally , the calculations in isis resulted in a better @xmath7 because the parameter ranges being scanned are larger in the parallel approach .",
    "group parameters depend on a single datagroup only . as a consequence , all other datagroups and therefore all other group parameters can be ignored during the uncertainty calculation .",
    "unfortunately , that is not the case for global parameters . during the analysis of gro  j100857(see section  [ sec : gro1008 ] ) , the uncertainties of the global parameters have been calculated by revealing the @xmath6-landscape of each global parameter by individual fits .",
    "afterwards , every landscape has been interpolated to find the @xmath8-value of interest ( e.g. , @xmath9 corresponding to the 90%-confidence level ) . in this way",
    "the runtime of an uncertainty calculation of a single global parameter could be reduced significantly .",
    "note that depending on the model and amount of data , such a computation can take up to several days .",
    "there are various applications of simultaneous fits and data analysis . besides determining specific parameters which seem to be constant over time by all available data ,",
    "more physical questions can be tackled .",
    "for instance , if a physical property of the object of interest results in multiple observables :    * the geometry of the accretion column in accreting neutron star x - ray binaries affects the line shape of cyclotron resonant scattering features ( crsf ) @xcite as well as the pulse profile shape ( falkner et al .",
    ", in prep . ) .",
    "furthermore , instead of deriving physical properties from parameters after fits have been performed , these properties can be directly fitted to the data by implementing the dependency on the model parameters :    * the components in radio maps of jets in active galactic nuclei move with certain velocities . assuming a constant velocity of the jet components , the velocity itself could be a global fit parameter @xcite . * in the sub - critical accretion regime of neutron stars , the spectrum is believed to harden with increasing luminosity @xcite . any possible dependency between power - law shape and luminosity could be fitted simultaneously with multiple spectra .",
    "as an example of a successful simultaneous fit we briefly summarize the results of our analysis of using almost all available x - ray spectra and -lightcurves .",
    "this transient high - mass x - ray binary consists of a neutron star orbiting a be - type optical companion . for further details of the system as well as for",
    "the results of the analysis see @xcite and references therein .",
    "since sources are only visible for a small fraction of their full orbit , it is challenging to obtain the orbital parameters of transient x - ray binaries by analyzing , e.g. , pulse arrival times @xcite .",
    "thus , an observed shift in the orbital phase with respect to initial orbital parameters can be fitted with either a different orbital period or time of periastron passage .",
    "this leads to a parameter degeneracy , which can be visualized by a contour map of the @xmath6-landscape of these parameters .",
    "the resulting contour map shows that both parameters are degenerated statistically ( i.e. , the ellipsoidal contour lines are tilted ) .",
    "the outburst times of the source are , however , clearly connected to the periastron passage . performing a simultaneous fit of the pulse arrival times and the outburst times",
    "reduces the parameter degeneracy and results in much better constrained parameters ( about a factor of 2 - 3 ) as seen by recalculated contour map .     and",
    "black body flux @xmath10 as functions of power - law flux @xmath11 .",
    "the different colors correspond to different outbursts . ]",
    "initial fits of the spectra of three outbursts of gro  j100857 in 2005 , 2007 and 2011 with an absorbed cutoff power - law and an additional black body component showed that the folding energy @xmath0 , as well as the black body temperature @xmath12 , are independent of time within uncertainties . in particular , it seems that they do not change between different outbursts , i.e. , these parameters are constant properties of the source .",
    "thus , those parameters are set as global parameters using ` simfit.set_par_fun ` and their values are determined by all available data .",
    "in addition , further parameters can be treated as global ones ( see * ? ? ? * for more details ) .",
    "finally , each observation is described by 3 group parameters only ( @xmath13 degrees of freedom for each datagroup , the global parameters contribute marginally ) , which are the power - law flux @xmath11 , the black body flux @xmath10 , and the photon index @xmath14 .",
    "the latter two strongly correlate with @xmath11 , but show no dependency on the outburst time or -shape .",
    "this correlation can be fitted to describe the spectrum of gro  j100857by only one parameter : the power - law flux @xmath11 . the fit is shown in fig .",
    "[ fig : paramfit ] and its values are given in section 4.2 of @xcite .",
    "as already mentioned in section  [ sec : uncertainties ] , the runtime of uncertainty calculations of the global parameters is increased dramatically . in the case of this analysis ,",
    "the @xmath6-landscape produced by taking all 68 spectra into account was interpolated to estimate the uncertainties .",
    "the calculation of a single global parameter took @xmath15days on 100  cpus ( 16320cpuh ) .",
    "although the simultaneous fits have already been applied successfully to real data ( see section  [ sec : gro1008 ] and @xcite ) , the routines and functions are still under development .",
    "we recommend to pull the ` isisscripts`-git - repositoryregularly to be up - to - date .",
    "there are , however , some caveats according to table  [ tab : procontra ] which one should be aware of ( as with any routine , not just our isis implementation ) . in particular , the runtime still has to be reduced .",
    "one way to achieve this is by performing the fit on multiple cpus , e.g. , one cpu handles one dataset or datagroup .",
    "this has not been implemented yet because the dependencies of the datasets on each other require data exchange between the processes on the different machines . additionally , the question about weighing the data is currently under discussion .",
    "the weight depends on the number of datapoints available in each dataset ( or -group ) as well as their uncertainties - but what does this mean for its importance , i.e. , its effect on the model parameters ? these remaining issues have to be clarified and the respective solutions will be published in the future .    m.  khnel was supported by the bundesministerium fr wirtschaft und technologie under deutsches zentrum fr luft- und raumfahrt grant 50or1113 .",
    "we thank john e. davis for developing the ` slxfig ` package , which was used to create all figures shown in this paper .",
    "j.  c. houck , et  al .",
    "isis : an interactive spectral interpretation system for high resolution x - ray spectroscopy . in n.",
    "manset , et  al .",
    "( eds . ) , _ astronomical data analysis software and systems ix _ , vol .",
    "216 of _ astron .",
    "soc . of the pacific conf .",
    "2000 .          m.  s. noble , et  al . using the parallel virtual machine for everyday analysis . in c.",
    "gabriel , et  al .",
    "( eds . ) , _ astronomical data analysis software and systems xv _ , vol .",
    "351 of _ astron .",
    "soc . of the pacific conf .",
    "series _ , p. 481 ."
  ],
  "abstract_text": [
    "<S> parallel computing and steadily increasing computation speed have led to a new tool for analyzing multiple datasets and datatypes : fitting several datasets simultaneously . with this technique , </S>",
    "<S> physically connected parameters of individual data can be treated as a single parameter by implementing this connection into the fit directly . </S>",
    "<S> we discuss the terminology , implementation , and possible issues of simultaneous fits based on the x - ray data analysis tool ` interactive spectral interpretation system ` ( isis ) . while all data modeling tools in x - ray astronomy allow in principle fitting data from multiple data sets individually , the syntax used in these tools is not often well suited for this task .    applying simultaneous fits to the transient x - ray binary gro  j100857 , we find that the spectral shape is only dependent on x - ray flux . </S>",
    "<S> we determine time independent parameters such as , e.g. , the folding energy @xmath0 , with unprecedented precision .    remeis    remeis    remeis    remeis    remeis    mit    gsfc , cresst    isdc    ucsd    iaat    iaat    remeis </S>"
  ]
}