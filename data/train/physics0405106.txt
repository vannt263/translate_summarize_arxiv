{
  "article_text": [
    "synchrotron light sources based on energy recovery linacs ( erls ) show promise to deliver x - ray beams with both brilliance and x - ray pulse duration far superior to the values that can be achieved with storage ring technology .",
    "this is due to the fact that the emittances in an erl are largely determined by a laser - driven source , technology which has been improving steadily over the years , and will undoubtedly improve further . to generate high brilliance high flux",
    "x - rays it is necessary to accelerate beams to the energies ( several gev ) and with the currents ( several @xmath0ma ) that are typical in these storage rings .",
    "this would require that the linac delivers a power of order @xmath1gw to the beam . without somehow recovering this energy after the beam has been used ,",
    "such a device would be practically unfeasible .",
    "energy recovery @xcite can be achieved by decelerating high energy electrons to generate cavity fields which in turn accelerate new electrons to high energy . with this , large beam powers that are not accessible in a conventional linac , can be produced .",
    "several laboratories have proposed high power erls for different purposes .",
    "designs for light production with different parameter sets and various applications are being worked on by cornell university @xcite , bnl @xcite , daresbury @xcite , tjnaf @xcite , jaeri @xcite , the university of erlangen @xcite , novosibirsk @xcite , and kek @xcite .",
    "tjnaf has incorporated an erl in its design of an electron ",
    "ion collider ( eic ) @xcite for medium energy physics , while bnl is working on an erl  based electron cooler @xcite for the ions in the relativistic ion collider ( rhic ) .",
    "the work at tjnaf , jaeri and novosibirsk is based on existing erls of relatively small scale",
    ".    one important limitation to the current that can be accelerated in such an erl is given by the beam - breakup ( bbu ) instability .",
    "the size and cost of all these new accelerators certainly requires a very detailed understanding of this limitation .    a theory of bbu instability in recirculating linacs , where the energy is not recovered in the linac , but where energy is added to the beam when it returns after each recirculation turn , was presented in @xcite .",
    "such a linac can consists of many cavities and several recirculation turns can be used .",
    "this original theory was additionally restricted to scenarios where the bunches of the different turns are in the linac at about the same accelerating rf phase , such as in the so - called continuous wave ( cw ) operation where every bucket is filled . tracking simulations @xcite compared well with this theory . in the following",
    "we therefore refer to it as the cw recirculator bbu theory .",
    "it determines above what threshold current @xmath2 the transverse bunch position @xmath3 displays undamped oscillations in the presence of a higher order mode ( hom ) with frequency @xmath4 .",
    "if there is only one higher order mode and one recirculation turn with a recirculation time @xmath5 in the linac , the following formula is obtained for @xmath6 : @xmath7 where @xmath8 is the speed of light , @xmath9 is the element of the transport matrix that relates initial transverse momentum @xmath10 before and @xmath3 after the recirculation loop , @xmath11 is the elementary charge , @xmath12 is the impedance ( in units of @xmath13 ) of the higher order mode driving the instability , @xmath14 is its quality factor .",
    "a corresponding formula had already been presented in @xcite . occasionally , additional factors are found when this equation is stated @xcite . we give a concise derivation which shows that no such additional factors are required .    in the past efforts",
    "have been made to derive threshold currents from the analysis of experimental data obtained at the tjnaf fel - erl @xcite using the cw recirculator bbu theory .",
    "the data has not been interpreted satisfactorily , and at least part of the reason could be that the underlying theory had not been derived for erl operation .",
    "the theory presented in this paper should therefore be used to extend and improve these previous analysis results , as it is directly applicable to erl operation .    here",
    "we will derive the general theory of the beam - breakup instability in recirculating linear accelerators , in which the bunches do not have to be at the same rf phase during each recirculation turn , similar to what has first been presented in @xcite .",
    "first we treat the simplest case of one dipole hom and one recirculation turn .",
    "then we allow many homs and many recirculations , and finally we analyze several analytically solvable cases .",
    "for recirculating linacs , the simplest case of one hom and one recirculation loop has long been described @xcite .",
    "previous theories which assume that the recirculation time is an integral number of rf periods should not be used when investigating erls .",
    "next we derive more general formulas that may be applied for arbitrary recirculation times .      in the simplest model of multi - pass beam breakup ,",
    "bunches are injected into a cavity , which is assumed to have one dipole hom ( e.g. @xmath15-like mode ) , accelerated in the cavity and then recirculated to pass the cavity a second time before they are ejected . in the case of a two - turn recirculating linac , each bunch would be accelerated on both passes through the linac and ejected to a user area .",
    "the rf phase of the bunch would therefore be approximately the same on both passes . in an erl",
    ", the rf phase on the second pass through the cavity is shifted by @xmath16 with respect to the first pass so that the energy that the bunch gains in the first pass is returned to the cavity during the second pass and the bunch is ejected with reduced energy into a beam dump .",
    "if a dipole hom is excited in the cavity , then a bunch that enters the cavity on axis experiences a transverse kick and starts to oscillate around the design orbit of the recirculation loop and returns to the cavity with a transverse offset .",
    "this offset leads to a change in the energy of the hom .",
    "if it increases the hom energy , transverse kicks experienced by subsequent bunches will be larger , which will in turn lead to a further growth of the hom energy once the kicked bunch returns to the linac : an instability develops .",
    "to describe this effect , we use the ideas and nomenclature from @xcite .",
    "when a current @xmath17 passes the cavity during its recovery loop at a time @xmath18 , the charge @xmath19 with the transverse offset @xmath20 excites the dipole hom , creating a transverse momentum for particles traveling through the cavity subsequently at time @xmath21 , @xmath22 where the wake function @xmath23 describes the transverse force at time @xmath24 after the hom was excited .",
    "the momentum transfer is described by an effective transverse voltage of the hom , @xmath25 .",
    "assuming that all bunches are injected on the cavity s central axis , they do not excite dipole homs on their first path through the cavity .",
    "however , the effective transverse voltage of the hom determines what kick @xmath26 the bunch sees and what position it will have when it returns to the cavity after the recirculation time @xmath5 .",
    "the transfer matrix element @xmath9 maps the transverse momentum @xmath27 to @xmath28 . inserting this into eq .",
    "( [ eq : kick ] ) leads to an integral equation for the hom s effective voltage , @xmath29    to solve this integral equation , one assumes that the current is a continuous stream of short pulses being injected at multiples of an interval between bunches @xmath30 , so that the current on the second turn is given by @xmath31 @xmath32 being the dirac - delta function .",
    "note that @xmath30 is an integer multiple of the rf circulation time @xmath33 for the rf frequency @xmath34 .",
    "we write the recirculation time in terms of the time @xmath30 between bunches as @xmath35 with an integer @xmath36 and @xmath37 . for a recirculating linac one",
    "has @xmath38 and for an erl one has @xmath39 for some integer @xmath40 . a `` @xmath41 '' sign in eq .",
    "[ eq : deltadef ] that defines @xmath42 may seem more natural but our choice leads to simplified equations .",
    "the hom voltage at a time @xmath43 is given by @xmath44 evaluating this at the time @xmath45 when the recirculated bunches pass through the cavity leads to @xmath46 t_b)\\ .\\ ] ] in the cw recirculator bbu theory this difference equation was dealt with by assuming that the voltage can be written as @xmath47 for @xmath48 where a positive imaginary part of @xmath49 indicates instability .",
    "note that this does not require @xmath50 to be a harmonic function , but that it can be a linear combination of harmonic functions with frequencies @xmath51 for integers @xmath52 .",
    "this distinction has not been always made clear and is a potential source of confusion @xcite .",
    "one obtains the equation @xmath53 the smallest value of the current @xmath54 for which there is a real @xmath49 is the threshold current @xmath2 of the instability .",
    "we proceed by writing @xmath50 in terms of its laplace transform , retaining all possible frequencies in hom voltage , which automatically enables proper description of arbitrary recirculating configuration : @xmath55 note that this is not the conventional way of writing a laplace transform .",
    "we have chosen this notation in order to make it appear more similar to a fourier transform .",
    "it also makes the subsequent notation more similar to the cw recirculator bbu theory .",
    "the laplace transform is used rather than the fourier transform since we want to analyze the onset of instability where the frequencies @xmath49 become complex . with the following definition @xmath56 we obtain @xmath57 since @xmath58 is periodic with @xmath59 , it has a fourier series , and its fourier coefficients are @xmath60 .",
    "this shows that @xmath58 does not vanish .",
    "we can therefore choose @xmath61 in eq .",
    "( [ eq : master ] ) and sum over @xmath40 , @xmath62t_b)e^{i\\omega [ n+n_r ] t_b}\\\\ & = & i_0 t_b^2 t_{12}\\frac{e}{c}\\nonumber\\\\ & \\times&\\sum_{n=-\\infty}^\\infty \\sum_{m=0}^\\infty w([m+\\delta]t_b)v([n - m]t_b)e^{i\\omega [ n+n_r ] t_b } \\nonumber\\\\ & = & i_0",
    "t_b t_{12}\\frac{e}{c}e^{i \\omega n_r t_b } \\sum_{m=0}^\\infty w([m+\\delta]t_b)e^{i \\omega m t_b } \\tilde v^\\sigma(\\omega)\\ .",
    "\\nonumber\\end{aligned}\\ ] ] this finally yields the dispersion relation between @xmath54 and @xmath49 which can be used for all @xmath42 .",
    "a corresponding derivation , which has treated the beam recirculation in a way that can be applied to erls , has been presented in @xcite .",
    "we believe that this paper should be referenced more often , since it is hardly referenced , whereas the earlier papers with cw recirculator bbu theory , which was not derived for erls , are often referenced in the context of erls , where they are not strictly applicable .",
    "the sum in the dispersion relation @xmath63t_b)e^{i \\omega n t_b}\\ , \\end{aligned}\\ ] ] can be computed when the far - field approximation for the wake function is used , @xmath64 with @xmath65 and @xmath66 the required sum can be evaluated if @xmath67 and becomes @xmath68t_b)e^{i \\omega n t_b}\\label{eq : wsum}\\\\ & = & \\left(\\frac{r}{q}\\right)_\\lambda\\frac{\\omega_\\lambda^2}{4ic } \\left [ \\frac{e^{i\\omega_\\lambda^+\\delta t_b}}{1-e^{i(\\omega_\\lambda^+ + \\omega)t_b } } - \\frac{e^{-i\\omega_\\lambda^-\\delta t_b}}{1-e^{-i(\\omega_\\lambda^- -\\omega)t_b } } \\right]\\nonumber\\\\ & = & \\left(\\frac{r}{q}\\right)_\\lambda\\frac{\\omega_\\lambda^2}{4c } e^{-i\\omega\\delta t_b}\\nonumber\\\\ & \\times & \\frac { e^{i\\omega^+ ( \\delta-1)t_b}\\sin ( \\omega_\\lambda   \\delta t_b ) - e^{i \\delta",
    "\\omega^+ t_b}\\sin(\\omega_\\lambda [ \\delta-1 ] t_b ) } { \\cos \\omega^+ t_b -\\cos \\omega_\\lambda t_b}\\ .\\nonumber\\end{aligned}\\ ] ] the dispersion relation thus becomes @xmath69 } { e^{-i\\omega^+t_b}\\sin ( \\delta    \\omega_\\lambda t_b)-                   \\sin([\\delta-1]\\omega_\\lambda t_b ) } \\ , \\label{eq : disp}\\ ] ] with @xmath70 . for @xmath71",
    "this becomes the dispersion relation of the cw recirculator bbu theory : @xmath72 this describes the case when the recirculated bunches are in the same buckets as the accelerated bunches .",
    "when the recirculated bunches are just between accelerated bunches , then @xmath73 , @xmath74 for the case that every bucket is filled , this would be an erl with @xmath75 .",
    "the dispersion relation for erls for other @xmath42 is less simple than eq .",
    "( [ eq : erldisp ] ) and has @xmath76 in eq .",
    "( [ eq : disp ] ) .",
    "this occurs when the decelerating and accelerating bunches are not perfectly centered between each other .      for a given positive current @xmath54 , the values of @xmath49 that satisfy the dispersion relation eq .",
    "( [ eq : disp ] ) will in general be complex .",
    "if they all have negative imaginary parts , the beam motion is stable .",
    "if one of them has positive imaginary part it will be unstable .    for small currents",
    "the beam motion is stable .",
    "when the current is increased , at some point , one of these @xmath49 will become real . at this point",
    "the threshold current is reached .",
    "the threshold current @xmath2 is therefore the smallest current @xmath54 for which there is a real @xmath49 that satisfies the dispersion relation . to find this current , we note that @xmath77 it is therefore sufficient to investigate @xmath78 $ ] .    figure  [ fg : spiral ] shows @xmath79 in the complex plain for @xmath80 $ ] .",
    "the intersection with the real axis that has the smallest positive value yields the threshold current .     in the complex plain for @xmath81 $ ] .",
    "the scale is arbitrary.,title=\"fig : \" ] +",
    "it can often be justified to linearize in @xmath82 , @xmath83 , which describes a situation when hom decay is negligible on the time scale of the bunch spacing @xmath30 .",
    "this applies to linacs when nearly every rf bucket is filled .",
    "the smallest @xmath84 in eq .",
    "( [ eq : disp ] ) is obtained when @xmath85 is close to @xmath86 , which occurs whenever @xmath49 is close to @xmath87 for any integer @xmath40 .",
    "due to eq .",
    "( [ eq : period ] ) , all these frequencies lead to the same threshold current .",
    "we therefore additionally linearize in @xmath88 , assuming @xmath89 .",
    "this leads to @xmath90 within the linearization , the phase factors could be combined to @xmath91 .",
    "this is not done in order to retain the symmetries of eq .",
    "( [ eq : period ] ) for @xmath92 and for @xmath93 , i.e.  @xmath94 and @xmath95 .    due to these symmetries , the real current close to @xmath96 is the same for each of these frequencies . without loss of generality",
    "we therefore use @xmath97 and no longer require the symmetries , @xmath98 since @xmath54 must be real , @xmath99 leading to the following two equivalent equations , @xmath100 for this formula to describe the threshold current , it is required that @xmath101 and therefore @xmath102 .",
    "( blue dots ) and @xmath103 ( blue and green curves ) .",
    "the curve is dark blue in the region where @xmath102 and light green otherwise .",
    "the @xmath49 of the instability is given by the intersection of the dotted line with a dark blue solid curve for which @xmath104 is smallest .",
    "left : a case of @xmath105 .",
    "right : a case of @xmath106.,title=\"fig : \" ]   ( blue dots ) and @xmath103 ( blue and green curves ) .",
    "the curve is dark blue in the region where @xmath102 and light green otherwise .",
    "the @xmath49 of the instability is given by the intersection of the dotted line with a dark blue solid curve for which @xmath104 is smallest .",
    "left : a case of @xmath105 .",
    "right : a case of @xmath106.,title=\"fig : \" ]    figure  [ fg : xcotx ] shows @xmath107 and @xmath108 versus @xmath109 $ ] for @xmath110 .",
    "the dotted line and the curve have to meet at a region where @xmath111 , which is indicated by a dark blue curve .    when @xmath112 , i.e.  hom decay is negligible on the time scale of recirculation time , then @xmath113 in the region where @xmath105 and one obtains @xmath114 which is the traditional and commonly used approximation in eq .",
    "( [ eq : simpbbu ] ) which had been derived for @xmath71 .    in the region with @xmath115 one obtains @xmath116 , which can be used in eq .",
    "( [ eq : ksquare ] ) , @xmath117    for @xmath118 , i.e.  when hom damping is substantial on the recirculation time scale , one again uses eq .",
    "( [ eq : ksquare ] ) with @xmath119 , where the @xmath41 or @xmath120 sign is determined by the sign of @xmath121 , @xmath122 note that in this case the threshold current weakly depends on @xmath5 and can be estimated simply by @xmath123 .",
    "one can perform these approximations more accurately , for example , by approximating @xmath124 by a line or second order curve .",
    "however , in regions where @xmath125 is not much larger or much smaller than @xmath1 , simple formulas can not be found .    ) .",
    "parameters : @xmath126 $ ] , @xmath127 , @xmath128 , @xmath129ev / c , @xmath130.,title=\"fig : \" ] ) . parameters : @xmath126 $ ] , @xmath127 , @xmath128 , @xmath129ev / c , @xmath130.,title=\"fig : \" ]    figure  [ fg : track ]  ( top ) shows the threshold current obtained with the approximate analytic solution compared with the threshold current that is found by tracking particles for the simple case of one cavity with one hom and one recirculation loop .",
    "figure  [ fg : track ]  ( bottom ) compares the same tracking results with a numerical solution of the dispersion relation eq .",
    "( [ eq : disp ] ) .",
    "the data agrees remarkably well with the approximate formula in the region where @xmath104 is small , i.e. where @xmath54 is relatively small . in the region where the threshold current is relatively large ,",
    "the agreement with the approximate expression is not satisfactory , however .    to find the threshold current with eq .",
    "( [ eq : disp ] ) , the smallest positive real value of @xmath54 for @xmath80 $ ] was found by linearly interpolating 100 points in the region @xmath131 $ ] .",
    "we denote the threshold current by @xmath132 and the real frequency @xmath133 $ ] satisfies eq .",
    "( [ eq : disp ] ) for this current .",
    "when the current @xmath54 is slightly larger than @xmath134 , there is one frequency @xmath135 that satisfies eq .",
    "( [ eq : disp ] ) and is close to @xmath136 .",
    "it has a positive imaginary part .",
    "all other frequencies @xmath49 at which eq .",
    "( [ eq : disp ] ) holds and for which therefore @xmath137 might not vanish have an imaginary part that is not positive . in eq .",
    "( [ eq : laplace ] ) there are therefore exponentially growing terms . for currents that are only slightly larger than the threshold current , the complex frequency @xmath135 can be expanded with respect to @xmath138 , @xmath139 t } e^{{\\rm \\im}\\{\\frac{d\\omega}{di_0}\\delta i\\}t}\\ .\\ ] ] the rise time per current of the instability is thus given by @xmath140 . the dispersion relation eq .",
    "( [ eq : disp ] ) leads to a long formula .",
    "however , using the simplified eq .",
    "( [ eq : klin ] ) leads to @xmath141 provided parameters are not in the region where the curves diverge in fig .",
    "[ fg : track ]  ( top ) , i.e. @xmath142 is not close to zero , the following approximate formulas hold for the growth rate : for @xmath112 one obtains @xmath143 and for @xmath118 one obtains @xmath144 .",
    "recirculating linacs with many cavities and several recirculation loops have been considered early on @xcite . here",
    "we use the same nomenclature as much as possible .",
    "the @xmath145 higher order modes , which can be associated with different cavities , are numbered by an index @xmath146 .",
    "the @xmath147 passes through the linac are numbered by an index @xmath148 .",
    "the horizontal position and momentum that the beam has at time @xmath21 in the hom @xmath146 during turn @xmath148 is denoted @xmath149 .",
    "the transport matrix that transports the phase space vector @xmath150 at hom @xmath151 during turn @xmath152 to @xmath153 is denoted @xmath154 and the time it takes to transport a particle from the beginning of the first turn to hom @xmath146 during turn @xmath148 is denoted @xmath155 .",
    "the beam is propagated from after hom @xmath156 to after hom @xmath146 by @xmath157)+\\left(\\begin{array}{c}0\\\\ \\frac{e}{c } v_i(t)\\end{array}\\right)\\ .\\ ] ] this equation can be iterated to obtain the phase space coordinates as a function of the hom strength that creates the orbit oscillations . with the matrix element @xmath158 one obtains @xmath159)\\label{eq : xfromv}\\\\ & + & \\phantom{\\sum_{j=1}^{i-1 } } \\sum_{j=1}^{i-1 } t_{ij}^{ii } \\frac{e}{c } v_j(t-[t_i^i - t_j^i])\\nonumber\\ .\\end{aligned}\\ ] ]    the strength @xmath160 of the hom @xmath146 is created by all particles that have traveled through that hom via the integral @xmath161 where @xmath162 is the current at time @xmath21 that the fraction of the beam has which passes the hom @xmath146 on turn @xmath148 . combining this with eq .",
    "( [ eq : xfromv ] ) leads to the following integral - difference equation : @xmath163)dt'\\ , \\nonumber\\\\ n_{i\\!j}(i-1)&= & \\begin{cases }    n , & \\text{if $ i\\ne j$ ; } \\\\",
    "i-1 , & \\text{if $ i = j$. } \\end{cases}\\end{aligned}\\ ] ]    now the approximation of short bunches is used .",
    "the current is given at time @xmath21 by pulses that are equally spaced with the distance @xmath30 , @xmath164 this reduces the integral to a sum , @xmath165 where @xmath166 .",
    "computing @xmath167 leads to @xmath168 t_b+t_j^j)e^{i\\omega nt_b}\\ .\\nonumber\\end{aligned}\\ ] ] the second summation starts at @xmath169 which can be simplified by writing @xmath170 , @xmath171 t_b,[\\delta_i^-\\delta_i^i]t_b)\\\\ & = & -{\\rm max}_m([n_i^l - n_i^i]t_b\\ge [ m+\\delta_i^l-\\delta_i^i]t_b ) \\nonumber\\\\ & = & n_i^i - n_i^l+\\gamma_i(i , l)\\ , \\nonumber\\end{aligned}\\ ] ] where @xmath172 if @xmath173 and @xmath174 otherwise . shifting the summation index",
    "@xmath52 now leads to @xmath175 t_b ) \\sum_{j=1}^i\\sum_{j=1}^{n_{i\\!j}(i-1)}t_{ij}^{i\\!j } \\nonumber\\\\ & \\times & v_j([n - m - n_i^i+n_i^l-\\gamma_i(i , l ) ] t_b+t_j^j)e^{i\\omega nt_b}\\ .\\nonumber\\end{aligned}\\ ] ] and with @xmath176 , which is between @xmath174 and @xmath1 , shifting the index @xmath40 finally leads to the relation @xmath177 t_b ) \\label{eq : viksum}\\\\ & \\times & \\sum_{j=1}^i\\sum_{j=1}^{n_{i\\!j}(i-1 ) } t_{ij}^{i\\!j } e^{i\\omega [ m+n_i^i - n_i^l+\\gamma_i(i , l)]t_b}v_j^j\\ .\\nonumber\\end{aligned}\\ ] ]    the following sum is equivalent to that in eq .",
    "( [ eq : wsum ] ) , @xmath178t_b)e^{i\\omega m t_b}\\ .\\ ] ] equation ( [ eq : viksum ] ) reduces to @xmath179 if a vector @xmath180 is introduced that has the coefficients @xmath181 , this equation can be written in matrix form , @xmath182 where the matrix @xmath183 is determined by eq .",
    "( [ eq : matdef ] ) .",
    "when all electrons are considered to have the speed of light , @xmath184 does not depend on the hom number @xmath146 and we therefore drop this index and obtain the following matrix coefficients : @xmath185 where @xmath186 is the smallest integer that is equal to or larger than @xmath3 . with kronecker @xmath187 this determines the matrices @xmath188 and @xmath189 to be @xmath190    for each frequency @xmath49 , @xmath191 is an eigenvalue of @xmath192 . since the eigenvalues are in general complex , but @xmath54 has to be real , the threshold current is determined by the largest real eigenvalue of @xmath192 .",
    "the matrix has the properties @xmath193 and it is therefore again sufficient to investigate @xmath80 $ ] to find the threshold current .    note that @xmath194 never appears on the right hand side of eq .",
    "( [ eq : viksum ] ) so that the dimension of @xmath195 can be reduced by one to @xmath196 .",
    "furthermore the dimension can be reduced when two fractional parts @xmath197 and @xmath198 are equal since then @xmath181 and @xmath199 are identical .",
    "note also that for @xmath200 and @xmath201 eq .  ( [ eq : viksum ] ) reduces to the dispersion relation for one hom in eq .",
    "( [ eq : disp ] ) .",
    "the growth rate of the instability is again computed by first obtaining the threshold current @xmath132 and the real frequency @xmath136 for which @xmath202 is an eigenvalue of @xmath203 . if this is the @xmath204th eigenvalue @xmath205 of the matrix @xmath192 , then the growth rate of the instability is given by @xmath206",
    "the presented theory for multiple homs and multiple recirculation turns can in general only be evaluated with computers . however , for some simple situation an analytical understanding is possible .",
    "one such case is an accelerator with one recirculation loop and one cavity in which many homs can be excited .",
    "the @xmath207 matrix elements that refer to transport between homs for the same pass are zero , @xmath208 .",
    "all matrix elements that describe the recirculation loop are identical , @xmath209 if @xmath210 . the matrix elements in eq .",
    "( [ eq : mmat ] ) are then given by @xmath211 equation ( [ eq : vmat ] ) becomes with @xmath212 , @xmath213 a summation over the index @xmath146 shows that @xmath214 can only be nonzero when @xmath215 comparing this with eq .",
    "( [ eq : disp0 ] ) shows that one only has to replace @xmath216 of the single hom by @xmath217 to arrive at the threshold formula for the multi - hom case . to find the smallest real @xmath54 that eq .",
    "( [ eq : i0multhom ] ) can produce for real @xmath49 , @xmath217 has to be maximized .",
    "the sum is especially large when the denominator of one of the terms is very small , i.e. when @xmath218 .",
    "when the hom frequencies modulo @xmath59 are sufficiently different for the different homs , the maximal absolute value of @xmath217 will be close to the largest absolute value that any of the @xmath219 could have individually . this is due to the fact that all the @xmath220 for @xmath221 are relatively small for frequencies @xmath49 for which the denominator of @xmath219 is small .    for hom frequencies that are sufficiently different in the above sense , the threshold current for several homs therefore does not differ significantly from the threshold current of the worst individual hom .    } )",
    "$ ] for one hom at @xmath222ghz as a function of a second hom with frequency @xmath223 .",
    "light green curve : threshold current when only the second hom is present .",
    "light red lines : frequencies for which @xmath224 where the threshold current is not simply the minimum of the threshold currents produced by the individual homs . ]",
    "figure  [ fg : twohom ] shows how the threshold current changes when the frequency of one hom is fixed at a small threshold current with @xmath225 and a second hom frequency is varied . superimposed is @xmath226 if only the second hom is present .",
    "it is apparent that the hom that would produce the larger threshold - current if it was solely present only influences the threshold current of the pair when the frequencies @xmath227 and @xmath228 are closer together than about @xmath229 .",
    "one can draw the conclusion that in the case of many homs they do not interact destructively when the frequencies @xmath230 are not very close together .",
    "tracking simulations also demonstrate this effect .     as a function of uniform equidistant frequency spread for 20 homs in a single cavity .",
    "abscissa displays frequency difference between the two homs adjacent in frequency .",
    "parameters : @xmath231ghz , @xmath232 , @xmath233ev / c , @xmath234s , @xmath235ghz .",
    "threshold is determined by tracking with accuracy @xmath236 . ]",
    "one strategy to increase the bbu threshold current is the introduction of hom frequency spreads between cavities . as an example , fig .",
    "[ fg : homspread ] shows the threshold current found by tracking as a function of uniform frequency spread of 20 homs in a single cavity .",
    "for all three curves @xmath12 is the same . it is seen that for lower @xmath14 , the curve begins to saturate for larger frequency spread than for the high @xmath14 case .",
    "it is also seen that the threshold for frequency spread @xmath237 is similar in all three cases .",
    "both observations are consistent with the above assertion that homs do not interfere when they are further apart than @xmath238 .",
    "the fact that oscillations in the fig .",
    "[ fg : homspread ] are smaller for low @xmath14 is consistent with the conclusion that a broader hom resonance peak should lead to more overlaps and as a result to less pronounced differences in the threshold for different hom frequencies .",
    "in order to see how two dipole homs interact , we will now analyze a set of two homs with one recirculation loop , i.e.  @xmath201 .",
    "we abbreviate @xmath212 and @xmath239 .",
    "the dispersion relation is then given by @xmath240 where the matrix @xmath241 is given by @xmath242 the third row is similar to the first row and eliminating it by similarity transformations leads to the @xmath243 matrix @xmath244    even though @xmath245 appears in the denominator , the formula for the eigenvalues of this matrix does not contain such a denominator .",
    "therefore the largest real eigenvalue will again occur at a frequency @xmath49 for which one of the hom frequencies satisfies @xmath246 .",
    "the term @xmath219 and @xmath247 of the other hom can then again be neglected , so that for sufficiently different hom frequencies @xmath248 the threshold current is again approximately determined by the hom which would have the smallest @xmath226 if there were no other homs present .",
    "we therefore now assume that the two homs are equal , @xmath249",
    ". now one can perform an approximation analogous to eq .",
    "( [ eq : klin0 ] ) leading to @xmath250        it is interesting to analyze whether the effect of the two homs can cancel .",
    "a cancellation could occur most naturally when the linac and the recovery loop are mirror symmetric .",
    "a mirror symmetry of the linac means that the beta functions of the first pass , going from low to high energy , are the mirror image of those of the second pass , going from high to low energy .",
    "an example of such an optics is shown in fig .",
    "[ fg : linacsym ] .",
    "since the @xmath207 element of the transport matrix between a region with momentum @xmath251 and a region with momentum @xmath252 can be written with twiss parameters as @xmath253 this symmetry leads to @xmath254 .",
    "an additional mirror symmetry of the return arc leads to @xmath255 .",
    "the eigenvalues of the matrix in eq .",
    "( [ eq : matlin0 ] ) then become , @xmath256\\ . \\nonumber\\end{aligned}\\ ] ] since there are two solutions to the quadratic eigenvalue equation , to every eigenvalue that is smaller than @xmath257 of a single cavity , there exists in general the one that is larger .",
    "therefore two cavities do not compensate their instabilities , but it is possible to decouple the cavities to the extent that the combined threshold current is just as large as that for a single cavity . for this",
    ", one has to choose @xmath258 , i.e.  the phase advance of the return arc has to be a multiple of @xmath16 .",
    "since the kick of a hom disturbs the beam most at low energy , the first and the last cavity of an erl are the strongest contributors to bbu .",
    "it seems therefore advisable to adjust the phase advance of the arc to a multiple of @xmath16 also when the linac has more than two cavities .",
    "one could envision a multi - turn recirculating linac as erl .",
    "the beam would pass the same linac @xmath259 times to reach its top energy , and subsequently it would be decelerated in just as many turns through the linac .",
    "the current in the cavities would be @xmath260 times higher than the current that is available at high energy .",
    "one could therefore conjecture that the bbu threshold current is @xmath259 times smaller than for a one - turn erl . here",
    "we will show that the threshold current can be significantly smaller than that conjecture and in general can be expected to decrease quadratically with @xmath259 .",
    "each bunch passes the linac @xmath261 times and the matrix in eq .",
    "( [ eq : mmat ] ) becomes @xmath262 where the lower indexes have been suppressed since only one hom is considered .",
    "the eigenvalue equation thus becomes @xmath263    an approximation equivalent to that leading to eqs .",
    "( [ eq : klin0 ] ) and ( [ eq : matlin0 ] ) results in @xmath264t_b}t^{i\\!j}v^j\\ . \\nonumber\\end{aligned}\\ ] ] comparing the exponent on the right hand side to those in eqs .",
    "( [ eq : matdef ] ) and ( [ eq : mmat ] ) shows that this can be written as @xmath265 since the right hand side does not depend on @xmath266 , all the terms @xmath267 are equivalent and the condition that they do not vanish is @xmath268 where the double sum goes over all pairs of @xmath148 and @xmath152 for which @xmath269 .",
    "similar to the condition obtained from eq .",
    "( [ eq : klin0 ] ) which is analyzed with fig .",
    "[ fg : xcotx ] , the fact that @xmath54 has to be real entails the condition @xmath270)t^{i\\!j } } { \\sum\\!\\!\\!\\!\\!\\!\\!\\!\\sum\\limits_{i > j } \\sin(\\omega[t^i - t^j])t^{i\\!j } } = \\frac{\\delta\\omega}{\\epsilon}\\ .\\ ] ] in regions where @xmath271)t^{i\\!j}>0 $ ] , we again obtain the approximation that @xmath272 .",
    "the equation for the threshold current of an @xmath259 times recirculating erl @xmath273 corresponds therefore to that of the case without recirculation in eq .",
    "( [ eq : simpbbu ] ) , @xmath274)t^{i\\!j}}\\ .\\ ] ]    a comparison with eq .",
    "( [ eq : simpbbu ] ) shows that this current is smaller than the one - turn erl by a factor of up to @xmath275 .",
    "this is in agreement with earlier result presented in @xcite .",
    "assuming that all matrix elements are of about equal magnitude , the threshold current in an @xmath259 times recirculating erl is therefore in general smaller by about a factor of @xmath276 .",
    "this conclusion is consistent with tracking results for microtrons @xcite and for two - turn erl @xcite .",
    "the scaling in a particular case , however , can be quite different depending on details of the lattice design , e.g.  approximate scaling with @xmath259 was reported in @xcite .",
    "in the derivation above , it was assumed that the bunches travel along the cavities symmetry axes when the current is below the threshold for bbu instability . when the cavities are misaligned",
    ", the beam will excite dipole higher order modes even below the threshold and the trajectory will be disturbed by these modes .",
    "let us assume that the @xmath146th cavity is misaligned with respect to the path adjustment of the @xmath148th turn by @xmath277 , leading to the misalignment vector @xmath278 .",
    "the dipole homs that are excited by the beam are now not only due to the beam position fluctuation that is produced by the homs themselves , but additionally due to the cavity misalignments .",
    "the hom voltages in eq .",
    "( [ eq : homsum ] ) are therefore given by @xmath279dt'\\ .\\ ] ] with the manipulations that led to eq .",
    "( [ eq : hommultsum ] ) this leads to @xmath280\\ .\\nonumber\\end{aligned}\\ ] ] following the derivation to eq .",
    "( [ eq : matdef ] ) leads to @xmath281\\ .\\end{aligned}\\ ] ] for all oscillation frequencies that are not multiples of the bunch repetition frequency , @xmath282 , @xmath283 is an integer , the term @xmath284 vanishes so that the condition for @xmath285 to be non - zero is the same as for the bbu instability without misalignments @xmath277 .",
    "below threshold , the hom voltage therefore has the following form : @xmath286 the voltage seen by bunch @xmath146 on turn @xmath266 is therefore given by @xmath287 so that for the time @xmath288 , eq .  ( [ eq : hommultsum2 ] ) can be written as @xmath289\\ .\\nonumber\\end{aligned}\\ ] ] after performing the summation over @xmath52 one obtains @xmath290\\ , \\nonumber\\end{aligned}\\ ] ] where the superscript @xmath291 means that @xmath216 is computed with eq .",
    "( [ eq : wsum ] ) for @xmath291 .    comparing with eqs .",
    "( [ eq : matdef ] ) and ( [ eq : vmat ] ) shows that this can be written as @xmath292 with @xmath293 and @xmath189 from eqs .",
    "( [ eq : wdef ] ) and ( [ eq : udef ] ) .",
    "the vector of voltages is therefore given by @xmath294^{-1}i_0{\\bf w}\\vec x_0 $ ] .",
    "equation ( [ eq : xfromv ] ) can now be used to compute the beams distance from the cavity center at each turn and each cavity .",
    "one obtains @xmath295^{-1}i_0{\\bf w}\\vec",
    "x_0-\\vec x_0\\label{eq : xcomp}\\\\ & = & [ i_0{\\bf uw}-{\\bf i}]^{-1}\\vec x_0 \\ .\\nonumber\\end{aligned}\\ ] ]    evaluating this for a single cavity with a single hom leads to @xmath296 for @xmath297 and with @xmath82 one obtains    @xmath298^{-1}\\ .\\label{eq : x1comp}\\ ] ]    there is a current @xmath54 at which the denominator becomes @xmath174 and the orbit deviation would become very large .",
    "the question arises whether this current is larger than the bbu threshold @xmath2 or smaller , so that large orbit excursions would present a new kind of instability .",
    "this problem does not only arise for the single hom case of eq .",
    "( [ eq : xcomp ] ) but also for the general case of eq .",
    "( [ eq : x1comp ] ) .",
    "very large orbit excursions @xmath3 occur for currents for which the matrix inverse does not exist .",
    "the inverse matrix to be inverted is @xmath299\\,{\\bf a}^{-1}$ ] , where @xmath300 is the matrix that diagonalizes @xmath301 .",
    "we therefore see that @xmath302 for which the orbit gets very large is given by the eigenvalues of @xmath301 .",
    "these values are naturally smaller than @xmath257 , which is the largest eigenvalue of @xmath303 that is produced for any frequency @xmath49 .",
    "this proves that the bbu instability always occurs before the orbit excursion becomes very large .",
    "the tracking code ` bi ` ( stands for beam instability ) was developed to perform studies of beam breakup in recirculating linacs @xcite .",
    "the algorithm models point charge bunch interactions with homs in linacs , taking into account proper time delays between the cavities , transfer maps , etc . , allowing bbu simulations due to longitudinal , transverse and other higher order modes in a general linac configuration .",
    "the basic algorithm can be summarized as following .",
    "the string of homs that a bunch sees in its lifetime between injection and ejection points is represented by a list of pointers to the actual cavities .",
    "the proper time delays between cavities is also stored for each pointer .",
    "e.g.  for @xmath145 homs and @xmath147 passes , the list of pointers would be @xmath304 long pointing to @xmath145 homs .",
    "this approach allows one to represent any recirculation configuration without limitations . as the train of bunches",
    "is injected into the structure , the next instance when any bunch sees any pointer is determined , and the hom voltage in the corresponding cavity is updated .",
    "then , this bunch is pushed to the next pointer where its coordinates are stored , waiting for its turn in time to be the next bunch going through a pointer . this way no bunches end up ahead of time precluding a situation when a bunch sees a cavity with incorrectly updated hom fields , i.e. causality",
    "is properly realized .",
    "furthermore , the algorithm is general enough to allow modeling of the longitudinal instability where timing between different bunches is no longer kept fixed .",
    "the practical realization of this algorithm is relatively fast , allowing the tracking of a complete @xmath305gev erl with @xmath306 homs for @xmath307ms in less than a minute on an average personal computer .",
    "this duration is sufficient to determine the onset of transverse bbu instability in most practical cases .",
    "the output of the code contains amplitudes of hom voltages as a function of time , which is used to determine the growth rate of the instability by fitting an exponential .",
    "several successive calls are made to the tracking unit to determine the threshold .",
    "the length of the tracking time is estimated from eq .",
    "( [ eq : rate ] ) based on the desired accuracy in threshold determination .",
    "for dipole homs we have derived the bbu theory for arbitrary recirculation times , so that the theory can be applied to erls .",
    "the resulting equations have been used to find analytical results for ( 1 ) multiple homs in one cavity , ( 2 ) two equal homs for a one - turn erl , and ( 3 ) one hom for a multiple times recirculating erl . for ( 1 ) the numerical observation that it often suffices to include only the strongest of several different hom was explained and the distance in frequency was derived for which one can consider two homs as different , for ( 2 ) it was shown that two cavities do not cancel each others instability but that they can be arranged so that they do not add dangerously , and for ( 3 ) was shown that the bbu threshold current for an @xmath259 times recirculating erl is roughly up to @xmath276 times smaller than that in a corresponding one - turn erl .",
    "furthermore , a simple method to compute the orbit deviations produced by cavity misalignments has also been introduced . and it is shown that the bbu instability always occurs before the orbit excursion becomes very large .",
    "several comparisons with tracking data verify the applicability of the theory and of the tracking program .",
    "the conclusions should be useful in determining and optimizing the maximum current for the many erls that are currently in design and pre - proposal stages worldwide .",
    "we thank joseph bisognano and geoffrey krafft for careful reading of the manuscript and for their useful comments ."
  ],
  "abstract_text": [
    "<S> here we will derive the general theory of the beam - breakup instability in recirculating linear accelerators , in which the bunches do not have to be at the same rf phase during each recirculation turn . </S>",
    "<S> this is important for the description of energy recovery linacs ( erls ) where bunches are recirculated at a decelerating phase of the rf wave and for other recirculator arrangements where different rf phases are of an advantage . </S>",
    "<S> furthermore it can be used for the analysis of phase errors of recirculated bunches . </S>",
    "<S> it is shown how the threshold current for a given linac can be computed and a remarkable agreement with tracking data is demonstrated . </S>",
    "<S> the general formulas are then analyzed for several analytically solvable cases , which show : ( a ) why different higher order modes ( hom ) in one cavity do not couple so that the most dangerous modes can be considered individually . </S>",
    "<S> ( b ) how different hom frequencies have to be in order to consider them separately . </S>",
    "<S> ( c ) that no optics can cause the homs of two cavities to cancel . </S>",
    "<S> ( d ) how an optics can avoid the addition of the instabilities of two cavities . ( e ) </S>",
    "<S> how a hom in a multiple - turn recirculator interferes with itself . </S>",
    "<S> furthermore , a simple method to compute the orbit deviations produced by cavity misalignments has also been introduced . </S>",
    "<S> it is shown that the bbu instability always occurs before the orbit excursion becomes very large . </S>"
  ]
}