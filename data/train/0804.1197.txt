{
  "article_text": [
    "large scale structures like galaxies and clusters of galaxies are believed to have formed by gravitational amplification of small perturbations . for an overview and original references , see , e.g. , @xcite .",
    "density perturbations are present at all scales that have been observed @xcite .",
    "understanding the evolution of density perturbations for systems that have fluctuations at all scales is essential for the study of galaxy formation and large scale structures .",
    "the equations that describe the evolution of density perturbations in an expanding universe have been known for a long time and these are easy to solve when the amplitude of perturbations is much smaller than unity .",
    "these equations describe the evolution of density contrast defined as @xmath1 . here",
    "@xmath2 is the density at @xmath3 at time @xmath4 , and @xmath5 is the average density in the universe at that time .",
    "these are densities of non - relativistic matter , the component that clusters at all scales and is believed to drive the formation of large scale structures in the universe . once the density contrast at relevant scales becomes large , i.e. , @xmath6 , the perturbation becomes non - linear and coupling with perturbations at other scales can not be ignored .",
    "the equations that describe the evolution of density perturbations can not be solved for generic perturbations in this regime .",
    "n - body simulations are often used to study the evolution in this regime .",
    "alternative approaches can be used if one requires only a limited amount of information and in such a case either quasi - linear approximation schemes or scaling relations @xcite suffice .    in cosmological n - body simulations ,",
    "we simulate a representative region of the universe .",
    "this is a large but finite volume and periodic boundary conditions are often used .",
    "almost always , the simulation volume is taken to be a cube .",
    "effect of perturbations at scales smaller than the mass resolution of the simulation , and of perturbations at scales larger than the box is ignored . indeed",
    ", even perturbations at scales comparable to the box are under sampled .",
    "it has been shown that perturbations at small scales do not influence collapse of perturbations at much larger scales in a significant manner .",
    "this is certainly true if the scales of interest are in the non - linear regime @xcite .",
    "therefore we may assume that ignoring perturbations at scales much smaller than the scales of interest does not affect results of n - body simulations .",
    "perturbations at scales larger than the simulation volume can affect the results of n - body simulations .",
    "use of the periodic boundary conditions implies that the average density in the simulation box is same as the average density in the universe , in other words we ignore perturbations at the scale of the simulation volume ( and at larger scales ) .",
    "therefore the size of the simulation volume should be chosen so that the amplitude of fluctuations at the box scale ( and at larger scales ) is ignorable .",
    "if the amplitude of perturbations at larger scales is not ignorable then clearly the simulation is not a faithful representation of the model being studied .",
    "it is not obvious as to when fluctuations at larger scales can be considered ignorable , indeed the answer to this question depends on the physical quantity of interest , the model being studied and the specific length / mass scale of interest as well .    the effect of a finite box size has been studied using n - body simulations and the conclusions in this regard may be summarised as follows .    *",
    "if the amplitude of density perturbations around the box scale is small ( @xmath7 ) but not much smaller than unity , simulations underestimate the correlation function though the number density of small mass haloes does not change by much @xcite .",
    "in other words , the formation of small haloes is not disturbed but their distribution is affected by non - inclusion of long wave modes . * in the same situation , the number density of the most massive haloes drops significantly @xcite . * effects of a finite box size modify values of physical quantities like the correlation function even at scales much smaller than the simulation volume @xcite . *",
    "the void spectrum is also affected by finite size of the simulation volume if perturbations at large scales are not ignorable @xcite . *",
    "it has been shown that properties of a given halo can change significantly as the contribution of perturbations at large scales is removed to the initial conditions but the distribution of most internal properties remain unchanged @xcite .",
    "* we presented a formalism for estimating the effects of a finite box size in @xcite .",
    "we used the formalism to estimate the effects on the rms amplitude of fluctuations in density , as well as the two point correlation function .",
    "we used these to further estimate the effects on the mass function and the multiplicity function .",
    "* the formalism mentioned above was used to estimate changes in the formation and destruction rates of haloes @xcite .",
    "* it was pointed out that the second order perturbation theory and corrections arising due this can be used to estimate the effects due to a finite box size @xcite .",
    "this study focused specifically on the effects on baryon acoustic oscillations . *",
    "if the objects of interest are collapsed haloes that correspond to rare peaks , as in the study of the early phase of reionisation , we require a fairly large simulation volume to construct a representative sample of the universe @xcite .    in some cases , one may be able to devise a method to `` correct '' for the effects of a finite box - size , but such methods can not be generalised to all statistical measures or physical quantities .",
    "effects of a finite box size modify values of physical quantities even at scales much smaller than the simulation volume @xcite .",
    "a workaround for this problem was suggested in the form of an ensemble of simulations to take the effect of convergence due to long wave modes into account @xcite , the effects of shear due to long wave modes are ignored here .",
    "however it is not clear whether the approach where an ensemble of simulations is used has significant advantages over using a sufficiently large simulation volume .",
    "we review the basic formalism we proposed in @xcite in  2 .",
    "we then extend the original formalism to the cases of non - linear amplitude of clustering and also for estimating changes in skewness and other reduced moments of counts in cells .",
    "this is done in  3 . in ",
    "4 we confront our analytical models with n - body simulations .",
    "we end with a discussion in  5 .",
    "initial conditions for n - body simulations are often taken to be a realisation of a gaussian random field with a given power spectrum , for details see , e.g. , .",
    "the power spectrum is sampled at discrete points in the @xmath8 space between the scales corresponding to the box size ( fundamental mode ) and the grid size ( nyquist frequency / mode ) . here",
    "@xmath8 is the wave vector .      in the approach outlined above ,",
    "the value of @xmath21 at a given scale is expressed as a combination of the expected value @xmath22 and the correction due to the finite box size @xmath23 . here",
    "@xmath22 is independent of the box size and depends only on the power spectrum and the scale of interest .",
    "it is clear than @xmath24 , and , @xmath25 .",
    "it can also be shown that for hierarchical models , @xmath26 , i.e. , @xmath27 increases or saturates to a constant value as we approach small @xmath12 .    at large scales @xmath19 and @xmath27 have a similar magnitude and the _ rms _ fluctuations in the simulation become negligible compared to the expected values in the model .",
    "as we approach small @xmath12 the correction term @xmath27 is constant and for most models it becomes insignificant in comparison with @xmath19 . in models where @xmath19 increases very slowly at small scales or saturates to a constant value",
    ", the correction term @xmath23 can be significant at all scales .",
    "this formalism can be used to estimate corrections for other estimators of clustering , for example the two point correlation .",
    "see @xcite for details .",
    "the estimation of the _ rms _ amplitude of density perturbations allows us to use the theory of mass function and estimate a number of quantities of interest . for details",
    ", we again refer the reader to @xcite but we list important points here .    *",
    "the fraction of mass in collapsed haloes is under - estimated in n - body simulations .",
    "this under - estimation is most severe near the scale of non - linearity , and falls off on either side .",
    "if we consider fractional under - estimation in the collapsed fraction then this increases monotonically from small scales to large scales . *",
    "the number density of collapsed haloes is under - estimated at scales larger than the scale of non - linearity .",
    "the maximum in collapsed fraction near the scale of non - linearity leads to a change of sign in the effect of a finite box - size for the number density of haloes at this scale : at smaller scales the number density of haloes is over - estimated in simulations .",
    "this can be understood on the basis of a paucity of mergers that otherwise would have led to formation of high mass haloes . *",
    "the above conclusions are generic and do not depend on the specific model for mass function .",
    "indeed , expressions for both the press - schechter @xcite and the sheth - tormen @xcite mass functions are given in @xcite , and we have also checked the veracity of our claims for the @xcite mass function .",
    "in this section we outline how the formalism and results outlined above may be used to estimate the effect of a finite box - size on reduced moments . reduced moments like the skewness and kurtosis can be computed using perturbation theory in the weakly non - linear regime @xcite .",
    "the expected values of the reduced moments are related primarily to the slope of the initial or linearly extrapolated @xmath17 , as all non - gaussianities are generated through evolution of the gaussian initial conditions and the initial @xmath17 characterises this completely .",
    "we can use the expression for @xmath17 as it is realised in simulations with a finite box size to compute the expected values of reduced moments in n - body simulations in the weakly non - linear regime .",
    "@xmath28 @xmath29 is the expected value of @xmath30 for the given mode , i.e. , when there are no box corrections and @xmath31 is the correction term in @xmath30 due to a finite box size .",
    "box size effects lead to a change in slope of @xmath21 , and hence the effective value of @xmath32 changes .",
    "the last term is the offset in skewness in n - body simulations as compared with the expected values in the model being simulated .",
    "we would like to emphasise that this expression is valid only in the weakly non - linear regime .",
    "in general we expect @xmath33 to increase as we go to larger scales .",
    "thus the skewness is under estimated in n - body simulations and the level of under estimation depends on the slope of @xmath33 as compared to the slope of @xmath22 . in the limit of small scales where @xmath23 is almost independent of scale , we find that the correction is : @xmath34 + \\mathcal{o}\\left (    \\frac{\\partial}{\\partial\\ln{r}}\\left(\\frac{\\sigma_1 ^ 2}{\\sigma_0 ^ 2 }     \\right)^2 \\right ) \\nonumber \\\\    & & + \\mathcal{o}\\left(\\frac{1}{\\sigma_0 ^ 2 }    \\frac{\\partial\\sigma_1 ^ 2}{\\partial\\ln{r } } \\right )     \\end{aligned}\\ ] ] here @xmath32 is the index of the initial spectrum we are simulating . for non - power law models this will also be a function of scale .",
    "the correction becomes more significant at larger scales and the net effect , as noted above , is to under estimate @xmath30 .",
    "similar expressions can be written down for kurtosis and other reduced moments using the approach outlined above .",
    "we give the expression for kurtosis below , but do not compute further moments as the same general principle can be used to compute these as well .",
    "@xmath35 ^ 2 + 2 \\frac{\\partial^2\\ln\\sigma^2}{\\partial\\ln^2 r } \\nonumber \\\\ & \\simeq & \\frac{6071}{1323 } - \\frac{62}{3}(n+3 ) \\left[1 +    \\frac{\\sigma_1 ^ 2}{\\sigma_0 ^2 } \\right ]   + \\frac{7}{3 } ( n+3)^2 \\left[1 -    \\frac{8}{7 } \\frac{\\sigma_1 ^ 2}{\\sigma_0 ^ 2 } \\right ]      \\nonumber \\\\ & &    + \\mathcal{o}\\left (    \\frac{\\partial}{\\partial\\ln{r}}\\left(\\frac{\\sigma_1 ^ 2}{\\sigma_0 ^ 2 }     \\right)^2 \\right ) +   \\mathcal{o}\\left(\\frac{1}{\\sigma_0 ^ 2 }    \\frac{\\partial\\sigma_1 ^ 2}{\\partial\\ln{r } } \\right )   \\end{aligned}\\ ] ]",
    "in this section we compare the analytical estimates for finite box size effects for various quantities with n - body simulations .",
    "such a comparison is relevant in order to test the effectiveness of approximations made in computing the effects of a finite box size .",
    "we have made the following approximations :    * effects of mode coupling between the scales that are taken into account in a simulation and the modes corresponding to scales larger than the simulation box are ignored .",
    "we believe that this should not be important unless the initial power spectrum has a sharp feature at scales comparable with the simulation size . * sampling of modes comparable to the box size is sparse , and the approximation of the sum over wave modes as an integral can be poor if the relative contribution of these scales to @xmath36 is significant .",
    "table  1 gives details of the n - body simulations used in this paper . in order to simulate the effects of a finite box size",
    ", we used the method employed by @xcite where initial perturbations are set to zero for all modes with wave number smaller than a given cutoff @xmath37 .",
    "the initial conditions are exactly the same as the reference simulation in each series in all other respects . for a finite simulation box",
    ", there is a natural cutoff at the fundamental wave number @xmath38 and simulations a1 , b1 and c1 impose no other cutoff .",
    "these are the reference simulations for the two series of simulations .",
    "simulations a2 , b2 and c2 sample perturbations at wave numbers larger than @xmath39 whereas simulations a3 , b3 and c3 are more restrictive with non - zero perturbations above @xmath40 .",
    "the cutoff of @xmath39 and @xmath40 corresponds to scales of @xmath41 and @xmath42 grid lengths , respectively . for the c series of simulations , the cutoff of @xmath39 and @xmath40 corresponds to scales of @xmath43  h@xmath44mpc and @xmath45  h@xmath44mpc , respectively .",
    "the background cosmology was taken to be einstein - desitter for the a and b series simulations .",
    "the best fit @xmath46cdm model from wmap-5 @xcite was used for the c series of simulations .    in order to ensure that the initial conditions do not get a rare contribution from a large scale mode , we forced @xmath47 while keeping the phases random for modes @xmath48 .",
    "we have chosen to work with models where box size effects are likely to be significant , particularly with the larger cutoff in wave number .",
    "this has been done to test our analytical model in a severe situation , and also to further illustrate the difficulties in simulating models with large negative indices .",
    "we present results from n - body simulations in the following section .",
    ".this table lists characteristics of n - body simulations used in our study . here",
    "the spectral index gives the slope of the initial power spectrum and the cutoff refers to the wave number below which all perturbations are set to zero : @xmath38 is the fundamental wave mode for the simulation box .",
    "all models were simulated using the treepm code @xcite .",
    "@xmath49 particles were used in each simulation , and the pm calculations were done on a @xmath49 grid .",
    "power spectra for both the a and the b series of simulations were normalised to ensure @xmath50 at the scale of @xmath51 grid lengths at the final epoch if there is no box - size cutoff .",
    "a softening length of @xmath52 grid lengths was used as the evolution of small scale features is not of interest in the present study .",
    "simulations for both the a and the b series were done with the einstein - desitter background and the c series used the wmap-5 best fit ( bf ) model as the cosmological background , as also for the power spectrum and transfer function . [ cols=\"^,^,^\",options=\"header \" , ]      figure  5 shows the number density of haloes for the three series of simulations as a function of mass of haloes .",
    "the haloes have been identified using the friends of friends ( fof ) method with a linking length of @xmath52 in units of the grid length . plotted in the same panels",
    "are the expected values computed using the press - schechter mass function with a correction for the finite box size .    for each series of simulations , and at each epoch , we fitted the value of @xmath53 to match the simulation with the natural cutoff at the box scale .",
    "the same value of @xmath53 is then used for other simulations of the series .",
    "we find that the features of the mass function are reproduced correctly by the analytical approximation , namely :    * the number density of the most massive haloes declines rapidly as the _ effective _ box size is reduced . *",
    "the number density of low mass haloes increases as the _ effective _ box size is reduced .",
    "this feature is apparent only at the late epoch .      in our discussion of analytical estimates of the effects of a finite box size on observable quantities",
    ", we have so far omitted any discussion of velocity statistics .",
    "the main reason for this is that the power spectrum for velocity is different as compared to the power spectrum for density and one can get divergences for quantities analogous to the second order estimators analogous to @xmath21 for models with @xmath54 .",
    "this is due to a more significant contribution of long wave modes to the velocity field than is the case for density .",
    "relative velocity statistics are more relevant on physical grounds and we use these for an empirical study of the effects of a finite box size on velocities .",
    "it is also important to check whether considerations related to velocity statistics put a stronger constraint on the box size required for simulations of a given model .",
    "we measure the radial pair velocity and also the pair velocity dispersion in the simulations used in this work .",
    "these quantities are defined as follows : @xmath55 where the averaging is done over all pairs of particles with separation @xmath56 . in practice",
    "this is done in a narrow bin in @xmath12 . here",
    "@xmath57 is the scale factor , @xmath58 is the hubble parameter and @xmath59 is the velocity of the @xmath60th particle .",
    "similarly , the relative pair velocity dispersion is defined as : @xmath61 where @xmath62 is the relative velocity for a pair of particles , and averaging is done over pairs with separation @xmath12 .",
    "dividing by @xmath63 gives us a dimensionless quantity and the usefulness of this is apparent from the following discussion .",
    "we have plotted the radial component of pair velocity as a function of scale @xmath12 in the top two rows of figure  6 .",
    "panels in these rows show the pair velocity for the different models at early and late epochs . in each panel , we find that the dependence of pair velocity on @xmath12 is very sensitive to the small @xmath15 cutoff used in generating the initial conditions for the simulation .",
    "it has been known for some time @xcite that @xmath64 is an almost universal function of @xmath0 .",
    "this is certainly true in the linear regime where @xmath65 for clustering in an einstein - de sitter universe @xcite . in order to exploit this aspect , and also to check whether the relation between @xmath64 and @xmath0 in the weakly non - linear regime is sensitive to the box size , we plot @xmath64 as a function of @xmath0 at the same scale in the last two rows of figure  6 .",
    "we find that all runs of a series fall along the same line and variations induced by the finite box size are small even in the non - linear regime .",
    "figure  7 shows the relative velocity dispersion as a function of scale ( top two rows ) and also as a function of @xmath0 ( lowest two rows ) .",
    "again , we find that although the relative pair velocity dispersion at a given scale is sensitive to the size of the simulation box , its dependence on @xmath0 is not affected by the large scale cutoff .",
    "thus we can use estimates of the correction in @xmath0 to get an estimate of corrections in pair velocity statistics .",
    "the conclusions of this paper may be summarised as follows :    * we have extended our formalism for estimating the effects of a finite box size beyond the second moment of the density field .",
    "we have given explicit expressions for estimating the skewness and kurtosis in the weakly non - linear regime when a model is simulated in a finite box size .",
    "* we have tested the predictions of our formalism by comparing these with the values of physical quantities in n - body simulations where the large scale modes are set to zero without changing the small scale modes .",
    "* we find that the formalism makes accurate predictions for the finite box size effects on the averaged two point correlation function @xmath0 and skewness .",
    "* we find that the formalism correctly predicts all the features of the mass function of a model simulated in a finite box size .",
    "* we studied the effects of a finite box size on relative velocities .",
    "we find that the effects on relative velocities mirror the effects on @xmath0 .",
    "it is desirable that in n - body simulations the intended model is reproduced at all scales between the resolution of the simulation and a fairly large fraction of the simulation box .",
    "the outer scale up to which the model can be reproduced fixes the effective dynamical range of simulations .",
    "one would like @xmath30 be within a stated tolerance of the expected value at this scale .",
    "we plot @xmath66 for power law models at the scale @xmath67 , @xmath68 and @xmath69 in the left panel of figure  8 .",
    "these are plotted as a function of @xmath70 .",
    "it can be shown that this ratio , as also @xmath71 are functions of scale only through the ratio @xmath72 .",
    "we find that @xmath66 is large for large negative @xmath32 and decreases monotonically as @xmath32 increases .",
    "this ratio is smaller than @xmath73 only for @xmath74 at @xmath75 .",
    "the corresponding number for @xmath76 is @xmath77 , and for @xmath67 is @xmath78 clearly , the effective dynamic range decreases rapidly as @xmath79 .",
    "this highlights the difficulties associated with simulating such models .",
    "similarly , one would like @xmath21 and @xmath22 to be comparable at the scale of non - linearity . from requirements of self similar evolution of power law models in simulations",
    ", we find that at the scale of non - linearity @xmath80 is required for the effects of a finite box size to be ignorable .",
    "this gives us a lower bound on @xmath81 for any given model .",
    "the middle panel shows the required @xmath81 as a function of @xmath70 for @xmath82 , @xmath83 and @xmath52 . here",
    "@xmath84 is the asymptotic value of @xmath23 at @xmath85 and is a fairly good approximation at small scales .",
    "we find that the required @xmath81 for @xmath86 is more than @xmath87 for @xmath88 at the scale of non - linearity .",
    "thus we need a simulation with @xmath89 if we are to probe the strongly non - linear regime ( @xmath90 ) with some degree of confidence .",
    "requirements for models with @xmath91 are much more stringent , and for models like @xmath92 even the largest simulations can not be used to study the asymptotic regime .    to put things in context for the favoured cosmological model , the right panel in figure  8 shows contours of @xmath66 in the @xmath93 plane for the @xmath46cdm model that best fits the wmap-5 data @xcite .",
    "we find that in order to ensure that the error in skewness is less than @xmath73 at a scale of @xmath94  h@xmath44mpc , we need a simulation box of more than @xmath95  h@xmath44mpc .",
    "the required box size is much bigger if the tolerance on error in skewness is smaller .",
    "this is a very stringent requirement for simulations of the epoch of reionization where one would like to get the clustering right at the scales of a few mpc .",
    "given that the formalism we have proposed works well when compared with simulations , and the fact that calculations in this formalism are fairly straightforward , we would like to urge the cosmological n - body simulations community to make use of this formalism .",
    "we would like to request simulators to report the fractional corrections to the linearly extrapolated amplitude of clustering and the fractional correction to skewness across the range of scales of interest .",
    "this will enable users of simulations to assess potential errors arising due to a finite simulation volume .",
    "numerical experiments for this study were carried out at cluster computing facility in the harish - chandra research institute ( http://cluster.mri.ernet.in ) . this research has made use of nasa s astrophysics data system .",
    "we would like to thank t. padmanabhan for useful discussions .",
    "we thank the anonymous referee for useful comments and suggestions ."
  ],
  "abstract_text": [
    "<S> n - body simulations are an important tool in the study of formation of large scale structures . </S>",
    "<S> much of the progress in understanding the physics of galaxy clustering and comparison with observations would not have been possible without n - body simulations . given the importance of this tool , it is essential to understand its limitations as ignoring these can easily lead to interesting but unreliable results . in this paper </S>",
    "<S> we study the limitations due to the finite size of the simulation volume . in an earlier work we proposed a formalism for estimating the effects of a finite box - size on physical quantities and applied it to estimate the effect on the amplitude of clustering , mass function . here , we extend the same analysis and estimate the effect on skewness and kurtosis in the perturbative regime . </S>",
    "<S> we also test the analytical predictions from the earlier work as well as those presented in this paper . </S>",
    "<S> we find good agreement between the analytical models and simulations for the two point correlation function and skewness . </S>",
    "<S> we also discuss the effect of a finite box size on relative velocity statistics and find the effects for these quantities scale in a manner that retains the dependence on the averaged correlation function @xmath0 .    </S>",
    "<S> methods : n - body simulations , numerical  </S>",
    "<S> gravitation  </S>",
    "<S> cosmology : theory , dark matter , large scale structure of the universe </S>"
  ]
}