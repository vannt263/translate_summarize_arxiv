{
  "article_text": [
    ", where @xmath1 is the underlying genotype .",
    "@xmath2 with @xmath3 ; @xmath4 or @xmath5 indicates the state of the mutable site ( e.g. , amino acid position ) .",
    "the effect of a single , double , triple mutation is given by the red arrows .",
    "pairwise ( or second - order ) epistasis is defined as the differential effect of a mutation depending on the background in which it occurs , for example in ( b ) it is the degree to which the effect of one mutation ( e.g. @xmath6 ) deviates in the background of the second mutation ( @xmath7 ) .",
    "thus , the expression for second order epistasis is @xmath8 .",
    "the third order and higher cases are considered in the main text , [ fig : explain ] ]    we begin with a formal definition of genotype , phenotype , and the representation of mutational effects . consider a specific sequence comprised of @xmath9 positions as a binary string @xmath2 with @xmath3 , where @xmath4 and @xmath5 represent the `` wild - type '' and mutant state of each position , respectively .",
    "this defines a total space of @xmath10 genotypes .",
    "the analysis could be expanded to the case of multiple substitutions per position , but we consider just the binary case for clarity here .",
    "each genotype @xmath1 has an associated phenotype @xmath11 , which is of the form that the independent action of two mutations means additivity in @xmath12 . for notational simplicity , we will simply write the genotype in a @xmath13-bit binary form , where @xmath13 is the order of the mutations that are considered .",
    "for example , the effect of a single mutation is simply @xmath14 , the difference in the phenotype between the mutant and wild - type states ( fig .",
    "[ fig : explain]a ) .",
    "the effect of a double mutant is given by @xmath15 ( red arrow , fig .",
    "[ fig : explain]b ) , and its linkage through paths of single mutations is defined by a two - dimensional graph ( a square network ) with four total genotypes . similarly , a triple mutant effect is @xmath16 ( red arrow , fig .",
    "[ fig : explain]c ) , and its linkage through paths of single mutations are enumerated on a three - dimensional graph ( a cube ) with eight total genotypes .",
    "more generally , and as described by horowitz and fersht  @xcite , the phenotypic effect of any arbitrary @xmath17-dimensional mutation can be represented by an @xmath17-dimensional graph , with @xmath18 total genotypes .",
    "understanding the relationship of the phenotypes of multiple mutants to that of the underlying lower - order mutant states is the essence of epistasis , and is described below .",
    "a well - known approach in biochemistry for analyzing the cooperativity of amino acids in specifying protein structure and function is to use the formalism of thermodynamic mutant - cycles  @xcite , one manifestation of the general principle of epistasis . in this approach ,",
    "the `` phenotype '' is typically an equilibrium free energy @xmath19 ( e.g. of thermodynamic stability or biochemical activity ) , and the goal is to obtain information about the structural basis of this phenotype through mutations that represent subtle perturbations of the wild - type state . for pairs of mutations ,",
    "the analysis involves measurements of four variants : wild - type ( @xmath20 ) , each single mutant ( @xmath21 and @xmath22 ) , and the double mutant ( @xmath23 ) , where the subscripts designate the mutated positions , and the superscript o indicates free energy relative to a standard state ( fig .",
    "1b ) .    from this , we can compute a coupling free energy between the two mutations ( @xmath24 ) as the degree to which the effect of one mutation ( @xmath25 ) is different when tried in the background of the other mutation ( @xmath26 ) : @xmath27 whereas the @xmath28 terms are individual measurements and @xmath29 terms are the effects of single mutations relative to wild - type , @xmath30 is a second order epistatic term describing the cooperativity ( or non - independence ) of two mutations with respect to the wild - type state .",
    "this analysis can be expanded to higher order .",
    "for example , the third order epistatic term describing the cooperative action of three mutations 1 , 2 , and 3 ( @xmath31 ) is defined as the degree to which the second order epistasis of any two mutations is different in the background of the third mutation : @xmath32 note that @xmath33 requires measurement of eight individual genotypes ( fig .",
    "more generally , we can define an @xmath17-th order epistatic term ( @xmath34 ) , describing the cooperativity of @xmath17 mutations , @xmath35 it is possible to write this expansion in a compact matrix form : @xmath36 where @xmath37 is the vector of @xmath18 epistasis terms of all orders , and @xmath38 is the vector of @xmath18 free energies corresponding to phenotypes of all the individual variants listed in binary order .",
    "to illustrate , for three mutations @xmath39 , and we obtain @xmath40 1 & 0 & 0 & 0 & 0 & 0 & 0 & \\ \\",
    "0\\ \\\\ -1 & 1 & 0 & 0 & 0 & 0 & 0 & \\ \\",
    "0\\ \\\\ -1 & 0 & 1 & 0 & 0 & 0 & 0 & \\",
    "\\ 0\\ \\\\ 1 & -1 & -1 & 1 & 0 & 0 & 0 & \\ \\",
    "0\\ \\\\ -1 & 0 & 0 & 0 & 1 & 0 & 0 & \\",
    "\\ 0\\ \\\\ 1 & -1 & 0 & 0 & -1 & 1 & 0 & \\",
    "\\ 0\\ \\\\ 1 & 0 & -1 & 0 & -1 & 0 & 1 & \\ \\",
    "0\\ \\\\ -1 & 1 & 1 & -1 & 1 & -1 & -1 & \\ \\ 1\\ \\end{pmatrix * } \\setlength{\\arraycolsep}{6pt } * \\begin{pmatrix * } y_{000}\\\\ y_{001}\\\\ y_{010}\\\\ y_{011}\\\\ y_{100}\\\\ y_{101}\\\\ y_{110}\\\\ y_{111 } \\end{pmatrix*}\\ ] ] in this representation , subscripts in @xmath38 represent combinations of mutations ( e.g. @xmath41 , a double mutant ) and subscripts in @xmath37 represent epistatic order ( e.g. @xmath42 , pairwise epistasis between mutations 1 and 2 ) .",
    "thus , equations and correspond to multiplying @xmath38 by the fourth or eighth row of @xmath43 , respectively , to specify @xmath44 and @xmath45 .",
    "note that @xmath38 and @xmath37 contain precisely the same information , re - written in a different form .",
    "the matrix @xmath43 represents an operator linking these two representations of the mutation data and we will return to the nature of the operation in a later section .",
    "we can write a recursive definition for @xmath43 that defines the mapping between @xmath38 and @xmath37 for all epistatic orders @xmath17 : @xmath46   \\boldsymbol{g}_n & \\ \\ 0 \\ \\    \\\\[0.2em ]   -\\boldsymbol{g}_n & \\boldsymbol{g}_n \\end{pmatrix*}\\ \\ \\mathrm{with}\\ \\ \\ \\setlength{\\arraycolsep}{6pt } \\boldsymbol{g}_0 = 1 \\label{eq : grecursive}\\ ] ] the inverse mapping is defined by @xmath47 .",
    "this relationship gives the effect of any combination of mutants ( in @xmath38 ) as a sum over epistatic terms ( in @xmath37 ) .",
    "for example , the energetic effect of three mutations 1,2 , and 3 ( @xmath48 ) is : @xmath49 thus , in the most general case , the free energy value of a multiple mutation requires knowledge of the effect of the single mutations and all associated epistatic terms . for the triple mutant",
    ", this means the wild - type phenotype , the three single mutant effects , the three two - way epistatic interactions , and the single three - way epistatic term .",
    "this analysis highlights two important properties of epistasis : ( 1 ) the lack of any epistatic interactions between mutations dramatically simplifies the description of multiple mutations to just the sum over the underlying single mutation effects , and ( 2 ) the absence of lower - order epistatic interactions ( e.g. @xmath50 ) does not imply absence of higher order epistatic terms .",
    "in contrast to the biochemical definition , the significance of a mutation ( and its epistatic interactions ) may also be defined not solely with regard to a single reference state as the `` wild - type '' , but as an average over many possible genotypes . as we show below",
    ", such averaging better represents the epistatic level at which mutations operate , and in principle , can separate mutant effects that are idiosyncratic to particular genotypes from those that are fundamentally important .",
    "the concept of averaging epistasis over genotypic backgrounds is analogous to the idea of the schema average fitness in the field of genetic algorithms ( ga ) @xcite , which was recently introduced in biology @xcite .    in its complete form",
    ", background - averaged epistasis considers averages over all possible genotypes for the remaining positions in the ensemble .",
    "for example , if @xmath51 , the epistasis between two positions 1 and 2 is computed as an average over both states of the third position ( @xmath52 , with the averaging denoted by @xmath53 ) ( see .",
    "1c ) : @xmath54\\\\ + [ ( y_{011 } - y_{010 } ) - ( y_{001 } - y_{000 } ) ] \\bigg\\}\\end{gathered}\\ ] ] thus for @xmath51 , we can write all epistatic terms : @xmath55 \\ 1 & 1 & 1 & 1 & 1 & 1 & 1 & 1\\ \\\\ \\ 1 & -1 & 1 & -1 & 1 & -1 & 1 & -1\\ \\\\ \\ 1 & 1 & -1 & -1 & 1 & 1 & -1 & -1\\ \\\\ \\ 1 & -1 & -1 & 1 & 1 & -1 & -1 & 1\\ \\\\ \\ 1 & 1 & 1 & 1 & -1 & -1 & -1 & -1\\ \\\\ \\ 1 & -1 & 1 & -1 & -1 & 1 & -1 & 1\\ \\\\ \\ 1 & 1 & -1 & -1 & -1 & -1 & 1 & 1\\ \\\\ \\ 1 & -1 & -1 & 1 & -1 & 1 & 1 & -1\\ \\end{pmatrix * } \\setlength{\\arraycolsep}{6pt } * \\begin{pmatrix * } y_{000}\\\\ y_{001}\\\\ y_{010}\\\\ y_{011}\\\\ y_{100}\\\\ y_{101}\\\\ y_{110}\\\\ y_{111 } \\end{pmatrix*}\\ ] ] where @xmath56 is a diagonal weighting matrix to account for averaging over different number of terms as a function of the order of epistasis ; @xmath57 , where @xmath58 is the order of the epistatic contribution in row @xmath59 .",
    "more generally , for any number of mutations @xmath17 : @xmath60 where @xmath38 is the same vector of phenotypes of variants as defined above , @xmath61 is the vector of background averaged epistatic terms , and @xmath62 is the operator for background - averaged epistasis , defined recursively as @xmath63 \\ \\boldsymbol{h}_n & \\boldsymbol{h}_n\\\\[0.2em ] \\",
    "\\boldsymbol{h}_n & -\\boldsymbol{h}_n \\end{pmatrix*}\\ \\ \\mathrm{with}\\ \\ \\ \\setlength{\\arraycolsep}{6pt } \\boldsymbol{h}_0 = 1\\ ] ] the recursive definition for the weighting matrix @xmath56 is @xmath64 \\ \\frac{1}{2}\\boldsymbol{v}_n & 0 \\\\[0.2em ] \\   0 & -\\boldsymbol{v}_n\\ \\end{pmatrix*}\\ \\ \\mathrm{with}\\ \\ \\ \\setlength{\\arraycolsep}{6pt } \\boldsymbol{v}_0 = 1\\ ] ]    the matrix @xmath62 has special significance ; its action mathematically corresponds to a generalized fourier analysis  @xcite known as the walsh - hadamard transform .",
    "this converts the phenotypes of individual variants ( in @xmath38 ) into a vector of averaged epistasis ( in @xmath61 ) , an operation that can also be seen as a spectral analysis of the high - dimensional phenotypic landscape defined by the genotypes studied . in this transform ,",
    "the phenotypic effects of combinations of mutations are represented as sums over averaged epistatic terms .    in summary ,",
    "the definition of epistasis proposed in evolutionary genetics is a global definition over sequence space , averaging the epistatic effects of mutations over the ensemble of all possible variants .",
    "in contrast , the biochemical definition given in the previous section is a local one , treating a particular variant as a reference for determining the epistatic effect of mutations .",
    "a third approach for analyzing epistasis is linear regression .",
    "for example , when we have a complete dataset of phenotypes of all @xmath18 genotypes , we can use regression to define the extent to which epistasis is captured by only considering terms to some order @xmath65 .",
    "that is , whether terms up to the @xmath66@xmath67 order are sufficient for effectively capturing the full complexity of a biological system .",
    "the standard form for a linear regression is a set of equations : @xmath68 for each genotype @xmath1 .",
    "the @xmath69 terms denote the regression coefficients corresponding to the ( epistatic ) effects between subscripted positions , and @xmath70 is the residual noise term . in matrix form this can be written as @xmath71 where @xmath72 tabulates which regression coefficients are summed over for genotypes @xmath1 . for @xmath39 ,",
    "regressing to full order , we can write @xmath73 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\\\ 1 & 1 & 0 & 0 & 0 & 0 & 0 & 0\\\\ 1 & 0 & 1 & 0 & 0 & 0 & 0 & 0\\\\ 1 & 1 & 1 & 1 & 0 & 0 & 0 & 0\\\\ 1 & 0 & 0 & 0 & 1 & 0 & 0 & 0\\\\ 1 & 1 & 0 & 0 & 1 & 1 & 0 & 0\\\\ 1 & 0 & 1 & 0 & 1 & 0 & 1 & 0\\\\ 1 & 1 & 1 & 1 & 1 & 1 & 1 & 1 \\end{pmatrix * } * \\begin{pmatrix } \\beta_{000}\\\\ \\beta_{001}\\\\ \\beta_{010}\\\\ \\beta_{011}\\\\ \\beta_{100}\\\\ \\beta_{101}\\\\ \\beta_{110}\\\\ \\beta_{111 } \\end{pmatrix } + \\boldsymbol{\\bar{\\epsilon}}\\ ] ] following the same rule for subscripts as before .",
    "@xmath72 has the recursive definition : @xmath74 \\ \\boldsymbol{x}_n & \\ \\ 0 \\ \\ \\",
    "\\\\[0.2em ] \\",
    "\\boldsymbol{x}_n & \\boldsymbol{x}_n\\ \\end{pmatrix*}\\ \\ \\mathrm{with}\\ \\ \\ \\setlength{\\arraycolsep}{6pt } \\boldsymbol{x}_0 = 1 \\label{eq : recursivex}\\ ] ] it is worth noting that the inverse of @xmath72 is @xmath75 , the operator for biochemical epistasis ( eq . ; see supplementary information ) .",
    "thus , the multi - dimensional mutant - cycle analysis is indistinguishable from regression to full order  the case in which @xmath76 and @xmath77 .",
    "however , the usual aim of regression is to approximate the data with fewer coefficients than there are data points , i.e. , @xmath65 . to express this ,",
    "we simply remove the columns from @xmath72 that refer to the epistatic orders excluded from the regression ( i.e. , @xmath78 ) : @xmath72 is multiplied by an @xmath18-by-@xmath79 matrix @xmath80 , the identity matrix with columns corresponding to epistatic orders higher than @xmath66 removed .",
    "@xmath79 is the number of epistatic terms up to @xmath66 and is given by @xmath81 .",
    "thus for regression to order @xmath66 , we can define @xmath82 , and write @xmath83 the linear regression is performed by solving the so - called normal equations @xmath84 where @xmath85 is necessarily square and invertible as long as @xmath86 is full column rank and hence @xmath85 is full rank .",
    "note that in this analysis we compute epistatic terms only up to the @xmath66@xmath67 order , but use phenotype / fitness data of all @xmath18 combinations of mutants .",
    "the more general case in which we estimate epistatic terms with less than @xmath18 data points is distinct and is discussed below .",
    "if the biochemical definition of epistasis is a local one , exploring the coupling of mutations of all order with regard to one `` wild - type '' reference , and the ensemble view of epistasis is a global one , assessing the coupling of mutations of all order averaged over all possible genotypes , then the regression view of epistasis is an attempt to project to a lower dimension - capturing epistasis as much as possible with low - order terms .",
    "the analysis presented above leads to a simple unifying concept underlying the calculations of epistasis . in general ,",
    "all the calculations are a mapping from the space of phenotypic measurements of genotypes @xmath38 to epistatic coefficients @xmath87 , in a general form @xmath88 , where @xmath89 is the epistasis operator .",
    "we give the bottom line of the different operators below ; their formal mathematical derivations can be found in the supplementary information .",
    "the most general situation is that of the background - averaged epistasis with averaging over the complete space of possible genotypes . in this case @xmath90 where @xmath62 is a @xmath91 matrix corresponding to the walsh - hadamard transform ( @xmath17 is the number of mutated sites ) and @xmath56 is a matrix of weights to normalize for the different numbers of terms for epistasis of different orders .",
    "the biochemical definition of epistasis using one `` wild - type '' sequence as a reference is a sub - sampling of terms in the hadamard transform . in this case @xmath92 where @xmath72 is , as defined in eq . .",
    "in essence , @xmath93 picks out the terms in @xmath62 that concern the wild - type background .",
    "note that both these mapping are one - to - one , such that the number of epistatic terms ( in @xmath87 ) is equal to the number of phenotypic measurements ( in @xmath38 ) and no information is lost . in contrast , regression to lower orders necessarily implies fewer epistatic terms than data points , which means the mapping is compressive and information is lost . in this case @xmath94 where @xmath95 ( @xmath96 ) is the identity matrix but with zeros on the diagonal at the orders that are higher than which we regress over .",
    "the fundamental point is that all three formalisms for computing epistasis are just versions of the walsh - hadamard transform , with terms selected as appropriate for the choice of a single reference sequence or limitations on the order of epistatic terms considered . from a computational point of view , it is interesting to note that regression using the hadamard transform makes matrix inversion unnecessary ( compare with eq . ) .      to illustrate the different analyses of epistasis , we consider a small case study of three spatially proximal mutations that define a switch in ligand specificity in psd95-pdz3 , a member of the pdz family of protein interaction modules ( fig .",
    "[ fig : pdz]a ) .",
    "two mutations are in psd95-pdz3 ( g330 t and h372a ) , and one mutation in its cognate ligand peptide ( t-2f ) .",
    "the phenotype is the binding affinity , @xmath97 , and the absence of epistasis implies additivity in the corresponding free energy , expressed as @xmath98 in kcal mol@xmath99 .",
    "binding affinities for this system are from ref .",
    "@xcite , and given in figure [ fig : pdz]b .",
    "these quantitative phenotypes are then transformed to epistatic terms using eq.[eq : omegahadamard]-[eq : regresshadamard ] ( table 1 ) .",
    "a number of simple mathematical relationships are evident in the data .",
    "first , regression is carried out only to the second - order and therefore the third - order epistatic term for this analysis does not exist ( or , equivalently , is set to zero if the epistatic vector @xmath100 is defined to be of full length @xmath18 ) .",
    "second , there are some equalities .",
    "the regression terms at the highest order ( second , in this case ) are equal to the corresponding terms for the averaged epistasis .",
    "this is because @xmath101 sets columns corresponding to orders higher than the regression order to zero , leaving rows corresponding to the highest regression order with only one non - zero element , on the diagonal . for these rows",
    "the entries in the epistasis operators @xmath102 and @xmath103 are equal .",
    "another more trivial equality is the highest - order term for the mutant - cycle and averaged epistasis formalisms ; there is only one contribution for the highest order , and therefore no backgrounds to average over .",
    "values in @xmath104 m for all eight combinations of two amino acids at the three mutable positions.[fig : pdz ] ]    @height 9.5pt depth4pt width0ptrr|rrrrr & & & & & + & &  & & & + & & & & & + & & & & & + & & & & & + & & & & & + & & & & & + & & & & & + & & & & & + & & & & & + & & & & & + & & & & & & +     + [ table : pdz ]    the data also illustrate the key properties of the different formalisms .",
    "the g330 t , h372a , and t-2f mutations represent a collectively cooperative set of perturbations , as indicated by a significant third - order epistatic term by both mutant cycle and background averaged definitions ( @xmath105 kcal mol@xmath99 ) .",
    "but the three formalisms differ in the energetic value of the lower order epistatic terms .",
    "for example , g330 t is essentially neutral for wild - type ligand binding but shows a dramatic gain in affinity in the context of the t-2f ligand ; thus , a large second - order epistatic term by the biochemical definition ( @xmath106 kcal mol@xmath99 ) .",
    "however , the coupling between g330 t and t-2f is nearly negligible in the background of h372a ; as a consequence , the background averaged second - order epistasis term @xmath107 is smaller ( @xmath108 kcal mol@xmath99 ) .",
    "similarly , both biochemical and regression formalisms assign a large first - order effect to the t-2f ( 1 * * ) and h372a ( * 1 * ) single mutations , while the corresponding background - averaged terms are nearly insignificant . for example , the free energy effect of mutating h372a ( @xmath109 ) is @xmath110 kcal mol@xmath99 in the wild - type background , but is @xmath111 kcal mol@xmath99 in the background of the t-2f ligand mutation - a nearly complete reversal of the effect of this mutation depending on context .",
    "thus with background averaging , the first order term for h372a ( @xmath112 ) is close to zero .",
    "this makes sense ; given the experiment described in figure 2 , the h372a mutation should not be thought of as a general determinant of ligand affinity .",
    "instead it is a conditional determinant , with an effect that depends on the identity of the amino acid at the @xmath113 position of the ligand .",
    "note that the degree of averaging depends on the number of mutated sites , and thus the interpretation of mutational effects will depend on the scale of the experimental study .",
    "these examples show that background averaging has the effect of `` correcting '' mutational effects for the existence of higher - order epistatic interactions . without background averaging ,",
    "the effect of a mutation ( at any order ) idiosyncratically depends on a particular reference genotype and will fail to account for higher order epistasis which modulates the observed mutational effect . thus , background averaging provides a measure of the effects of mutation that represents its general value over many related systems , and more appropriately represents the cooperative unit within which the mutation operates .      the analytical expressions in eq.[eq : omegahadamard]-[eq : regresshadamard ] involves the measurement of phenotypes ( @xmath38 ) for all @xmath18 combinatorial mutants , a fact that exposes two fundamental problems .",
    "first , it is only practical when @xmath17 is small . in such cases ( e.g figure 2 , @xmath51 )",
    ", the data can be combinatorially complete permitting a full analysis - the local and global structure of epistasis , possible evolutionary trajectories , and adaptive trade - offs @xcite .",
    "but for the typical size of protein domains ( @xmath114 ) , the combinatorial complexity of mutations precludes the collection of complete datasets .",
    "second , even if it were possible , the sampling of all genotypes is not desired ; indeed , the majority of systems in such an ensemble are unlikely to be functional and and averages over them are not meaningful with regard to learning the epistatic structure of native systems .",
    "how then can we apply these epistasis formalisms in practice , especially with regard to background averaging ?    to develop general principles , we begin with two obvious approaches that lead to well - defined alternative expressions for averaged epistasis .",
    "first , consider the case in which the data are only `` locally complete '' ; that is , we have all possible mutants up to a certain order @xmath115 .",
    "we can then define a measure that is intermediate between epistasis with a single reference genotype and epistasis with full background - averaging , which we will refer to as the _ partial _ background - averaged epistasis .",
    "for example , for three positions ( @xmath51 ) with data complete only up to order ( @xmath116 ) , the partial background - averaged effect of the first position ( rightmost subscript ) , is calculated as @xmath117 . compared to the full background - averaged epistasis , the partial averages just leaves out the last term , @xmath118 , which represents the unavailable phenotype of the triple mutant @xmath119 .",
    "more generally , we can define this measure of epistasis as another special case of the hadamard transform :    @xmath120    where @xmath121 designates the element - wise product .",
    "@xmath122 is again a diagonal weighting vector , now given by @xmath123 where @xmath58 is the epistatic order associated with row @xmath59 as defined earlier , and @xmath124 .",
    "note that @xmath125 because mutants of order higher than @xmath126 are considered absent in the dataset .",
    "the matrix @xmath127 simply serves to multiply by zero the terms in the hadamard matrix that include orders higher than @xmath126 .",
    "interestingly , the @xmath127 matrices display a self - similar hierarchical pattern ( fig .",
    "[ fig : sierpinski ] ) and are related to so - called sierpinski triangles ( see ref @xcite ) .",
    "this permits a recursive definition in both @xmath17 and @xmath126 for the product @xmath128 , which we will designate as @xmath129 : @xmath130 \\ \\boldsymbol{f}_{\\!_{n-1,p } } \\ \\ \\ & \\boldsymbol{f}_{\\!_{n-1,p-1}}\\   \\\\[0.2em ] \\",
    "\\boldsymbol{f}_{\\!_{n-1,p-1 } } & -\\boldsymbol{f}_{\\!_{n-1,p-1}}\\ \\end{pmatrix * } \\label{eq : partbackgiter}\\ ] ]   + with @xmath131 for @xmath132 , and @xmath133 is a @xmath91 matrix of zeros , except for a 1 in the upper left corner .",
    "this analysis assumes that data are complete up to the order @xmath126 . if not , analytical schemes for background - averaged epistasis such as eqs[eq : partbackg]-[eq : partbackgiter ] are not obvious .",
    "a second analytically tractable case for incomplete data arises in regression , where the idea is to estimate epistatic terms up to a specified order from available data .",
    "this involves solving a set of equations similar to the normal equations : @xmath134 where @xmath135 is an @xmath136 matrix constructed from the @xmath18 by @xmath18 identity matrix by deleting the @xmath137 rows corresponding to the unavailable phenotypic data , and @xmath138 , with @xmath80 defined as above . in order for this system of equations to be solvable",
    ", a necessary constraint is that @xmath139 ; that is , the number of data points available should be larger than or equal to the number of regression parameters .",
    "in addition , the data must be such that it is possible to uniquely solve for all epistatic terms in the regression .",
    "for example , if two mutations always co - occur in the data , it is obviously impossible to calculate their independent effects . in such cases , the number of solutions to eq . is infinite ( @xmath140 is not invertible )",
    ".     introduced to calculate the partial background - averaged epistasis , for @xmath39 . ( a )",
    "@xmath141 for when data for mutants up to second - order is available and ( b ) @xmath142 for when only first - order mutants are available .",
    "both matrices are self - similar , which allows their generation for arbitrary order , and are related to the so - called logical sierpiski triangle .",
    "for example @xmath143 , where @xmath144 is the anti - diagonal identity matrix and @xmath145 is the sierpinski matrix ( i.e. multigrade and in boolean logic ) for three inputs.[fig : sierpinski ] ]    in practice , even with `` high - throughput '' assays , we can only hope to measure a tiny fraction of all combinatorial mutants due to the vast number of possibilities .",
    "in this situation , the problem of inferring epistasis by regression may be further constrained by imposing additional conditions , termed regularization .",
    "for example , kernel ridge regression @xcite and lasso @xcite include a weighted norm of the regression coefficients in the minimization procedure .",
    "regularization comes with its own set of caveats @xcite , but its application is , unlike the approaches in eq . and , not conditional on specific structure of the data or depth of coverage .",
    "however , none of these approaches directly addresses the problem of optimally defining appropriate ensembles of genotypes over which averages should be taken . in principle , the idea should be to perform background averaging over a representative ensemble of systems that show invariance of functional properties of interest .",
    "how can we generally find such ensembles without the impractical notion of exhaustive functional analysis of the space of possible genotypes ?",
    "one idea is motivated by the empirical finding of _ sparsity _ in the pattern of key epistatic interactions within biological systems .",
    "indeed , evidence suggests that in proteins , the architecture is to have a small subset of amino acids that shows strong and distributed epistatic couplings surrounded by a majority of amino acids that are more weakly and locally coupled @xcite .",
    "more generally , the notion of a sparse core of strong couplings surrounded by a milieu of weak couplings has been argued to be a signature of evolvable systems @xcite .",
    "if it can be more generally verified , the notion of sparsity might be exploited to define relevant strategies for optimally learning the epistatic structure of natural systems .",
    "one approach is to minimize the so - called @xmath146-norm ( the sum of absolute values of the epistatic coefficients ) in a constrained optimization , which has the effect of producing many epistatic coefficients with zero or very small values @xcite , while projecting onto background - averaged epistatic terms : @xmath147 this procedure is akin to the technique of compressed sensing @xcite , a powerful approach used in signal processing to recognize the low - dimensional space in which the relevant features of a high - dimensional dataset occur given the assumption of sparsity of these features .",
    "the application of this theory for mapping biological epistasis has to our knowledge not been reported before , but might be explored with focused high - order mutational analyses in specific well - chosen model systems .",
    "the necessary technologies for such experiments are now becoming available , and should help define practical data collection strategies for studying epistasis more generally .",
    "it is worth pointing out that other approaches that use ensemble - averaged information to understand biological systems have been developed and experimentally tested .",
    "for example , statistical methods that operate on multiple sequence alignments of proteins @xcite calculate quantities related to epistasis that are averaged over the space of homologous sequences .",
    "importantly , these approaches have been successful at revealing a hierarchy of cooperative interactions between amino acids that range from local structural contacts in protein tertiary structures @xcite to more global functional modes @xcite . for defining good experimental approaches to epistasis",
    ", a conceptual advance may come from an attempt to formally map the constrained optimization problem described in eq.[eq : cs ] to the kind of ensemble averaging that underlies the statistical coevolution approaches .",
    "a fundamental problem is to define the epistatic structure of biological systems , which holds the key to understanding how phenotype arises from genotype .",
    "here we provide a unified mathematical foundation for epistasis in which different approaches are found to be versions of a single mathematical formalism - the weighted walsh - hadamard transform . in the most general case",
    ", this transform corresponds to an averaging of mutant effects over all possible genetic backgrounds at every order order of epistasis .",
    "this approach corrects the effect of mutations at every level of epistasis for higher order terms .",
    "importantly , it represents the degree to which the effects of mutations are transferable from one model system to another , the usual purpose of most mutagenesis studies . in contrast , the thermodynamic mutant cycle @xcite ( commonly used in biochemistry ) constitutes a special case of taking a single reference genotype and thus no averaging @xcite .",
    "this analysis represents the effects of mutations that are specific to a particular model system .",
    "regression ( commonly used in evolutionary biology ) is an attempt to capture features of a system with epistatic terms up to a defined lower order , often to bound the extent of epistasis or to predict the effects of higher - order combinations of mutations @xcite .",
    "the similarity of the regression operator to that of the mutant cycle ( see eq . ) indicates that this approach is also focused around the local mutational environment of a chosen reference sequence .",
    "in general , background averaging would seem to provide the most informative representation of the effect of a mutation .",
    "however , with the exception of very small - scale studies focused in the local mutational environment of extant systems , it is both impractical and logically flawed to collect combinatorially complete mutation datasets for any system .",
    "thus , the essence of the problem is to define optimal strategies for collecting data on ensembles of genotypes that is sufficient for discovering the biologically relevant epistatic structure of systems .",
    "the notion of sparsity in epistasis provides a general basis for developing such a strategy , and it will be interesting to test practical applications of this concept ( e.g. eq.[eq : cs ] ) in future work . defining optimal data collection strategies will not only provide practical tools to probe specific systems , but might guide us to principles underlying the `` design '' of these systems through the process of evolution , and help the rational design of new systems .",
    "the mathematical relations discussed here provide a necessary foundation to advance such understanding .",
    "we thank e. toprak , k. reynolds , and members of the ranganathan laboratory for critically reading the manuscript .",
    "fjp gratefully acknowledges funding by the helen hay whitney foundation sponsored by the howard hughes medical institute .",
    "rr acknowledges support from the robert a. welch foundation ( i-1366 , r.r . ) and the green center for systems biology .",
    "10    wells ja ( 1990 ) additivity of mutational effects in proteins .",
    "_ biochemistry _ * 29*:8509 .",
    "phillips pc ( 2008 ) epistasis  the essential role of gene interactions in the structure and evolution of genetic systems .",
    "_ nat rev genet _ * 9*:855 .",
    "costanzo m , baryshnikova a , myers cl , andrews b , boone c ( 2011 ) charting the genetic interaction map of a cell .",
    "_ curr opin biotechnol _ * 22*:66 .",
    "lehner b ( 2011 ) molecular mechanisms of epistasis within and between genes .",
    "_ trends genet _ * 27*:323 .",
    "dowell rd , ryan o , jansen a , cheung d , agarwala s , et  al .",
    "( 2010 ) genotype to phenotype : a complex problem .",
    "_ science _ * 328*:469 .",
    "lunzer m , golding gb , dean am ( 2010 ) pervasive cryptic epistasis in molecular evolution .",
    "_ plos genet _ * 6*:e1001162 .",
    "kryazhimskiy s , dushoff j , bazykin ga , plotkin jb ( 2011 ) prevalence of epistasis in the evolution of influenza a surface proteins .",
    "_ plos genet _ * 7*:e1001301 .",
    "bateson w ( 1908 ) facts limiting the theory of heredity .",
    "_ science _ * 26*:647 .",
    "fisher ra ( 1918 ) the correlation between relatives on the supposition of mendelian inheritance .",
    "_ trans r soc edinb _ * 52*:399 .",
    "horovitz a ( 1987 ) non - additivity in protein - protein interactions .",
    "_ j mol biol _ * 196*:733",
    ".    cordes mh , davidson ar , sauer rt ( 1996 ) sequence space , folding and protein design .",
    "_ curr opin struct biol _ * 6*:3 .",
    "horovitz a , bochkareva es , yifrach o , girshovich as ( 1994 ) prediction of an inter - residue interaction in the chaperonin groel from multiple sequence alignment is confirmed by double - mutant - cycle analysis .",
    "_ j mol biol _ * 238*:133 .",
    "dill ka ( 1997 ) additivity principles in biochemistry .",
    "_ j biol chem _ * 272*:701 .",
    "jain rk , ranganathan r ( 2004 ) local complexity of amino acid interactions in a protein core .",
    "_ proc natl acad sci usa _ * 101*:111 .",
    "lander es , schork nj ( 1994 ) genetic dissection of complex traits .",
    "_ science _ * 265*:2037 .",
    "pettersson m , besnier f , siegel pb , carlborg o ( 2011 ) replication and explorations of high - order epistasis using a large advanced intercross line pedigree .",
    "_ plos genet _ * 7*:e1002180 .",
    "kouyos rd , leventhal ge , hinkley t , haddad m , whitcomb jm , et  al .",
    "( 2012 ) exploring the complexity of the hiv-1 fitness landscape",
    ". _ plos genet _ * 8*:e1002551 .",
    "brem rb , kruglyak l ( 2005 ) the landscape of genetic complexity across 5,700 gene expression traits in yeast .",
    "_ proc natl acad sci usa _ * 102*:1572 .",
    "ehrenreich i m , torabi n , jia y , kent j , martis s , et  al .",
    "( 2010 ) dissection of genetically complex traits with extremely large pools of yeast segregants .",
    "_ nature _ * 464*:1039",
    ".    burch cl , chao l ( 2004 ) epistasis and its relationship to canalization in the rna virus phi 6 .",
    "_ genetics _ * 167*:559 .",
    "weinreich dm , watson ra , chao l ( 2005 ) perspective : sign epistasis and genetic constraint on evolutionary trajectories .",
    "_ evolution _ * 59*:1165",
    ".    poelwijk fj , kiviet dj , weinreich dm , tans sj ( 2007 ) empirical fitness landscapes reveal accessible evolutionary paths .",
    "_ nature _ * 445*:383 .",
    "poelwijk fj , tnase - nicola s , kiviet dj , tans sj ( 2011 ) reciprocal sign epistasis is a necessary condition for multi - peaked fitness landscapes .",
    "_ j theor biol _ * 272*:141 .",
    "lozovsky er , chookajorn t , brown km , imwong m , shaw pj , et  al .",
    "( 2009 ) stepwise acquisition of pyrimethamine resistance in the malaria parasite .",
    "_ proc natl acad sci usa _ * 106*:12025 .",
    "maharjan rp , ferenci t ( 2013 ) epistatic interactions determine the mutational pathways and coexistence of lineages in clonal escherichia coli populations .",
    "_ evolution _ * 67*:2762",
    ".    draghi ja , plotkin jb ( 2013 ) selection biases the prevalence and type of epistasis along adaptive trajectories",
    ". _ evolution _ * 67*:3120 .",
    "vandersluis b , bellay j , musso g , costanzo m , papp b , et  al .",
    "( 2010 ) genetic interactions reveal the evolutionary trajectories of duplicate genes .",
    "_ mol syst biol _",
    "* 6*:429 .",
    "natarajan c , inoguchi n , weber re , fago a , moriyama h , et  al . ( 2013 ) epistasis among adaptive mutations in deer mouse hemoglobin .",
    "_ science _ * 340*:1324 .",
    "gong li , suchard ma , bloom jd ( 2013 ) stability - mediated epistasis constrains the evolution of an influenza protein .",
    "_ elife _ * 2*:e00631 .",
    "ashworth a , lord c , reis - filho j ( 2011 ) genetic interactions in cancer progression and treatment .",
    "_ cell _ * 145*:30 .",
    "chakravarti a , clark ag , mootha vk ( 2013 ) distilling pathophysiology from complex disease genetics . _ cell _ * 155*:21 .",
    "leiserson mdm , eldridge jv , ramachandran s , raphael bj ( 2013 ) network analysis of gwas data .",
    "_ curr opin genet dev _ * 23*:602 .",
    "hinkley t , martins j , chappey c , haddad m , stawiski e , et  al .",
    "( 2011 ) a systems analysis of mutational effects in hiv-1 protease and reverse transcriptase .",
    "_ nat genet _",
    "* 43*:487 .",
    "combarros o , cortina - borja m , smith ad , lehmann dj ( 2009 ) epistasis in sporadic alzheimer s disease .",
    "_ neurobiol aging _ * 30*:1333 .",
    "fitzgerald jb , schoeberl b , nielsen ub , sorger pk ( 2006 ) systems biology and combination therapy in the quest for clinical efficacy .",
    "_ nat chem biol",
    "_ * 2*:458 .",
    "fu w , oconnor td , akey jm ( 2013 ) genetic architecture of quantitative traits and complex diseases .",
    "_ curr opin genet dev _ * 23*:678 .",
    "wang x , fu aq , mcnerney me , white kp ( 2014 ) widespread genetic epistasis among cancer genes .",
    "_ nature comm _",
    "* 5*:4828    chen j , stites we ( 2001 ) higher - order packing interactions in triple and quadruple mutants of staphylococcal nuclease .",
    "_ biochemistry _ * 40*:14012 .",
    "frisch c , schreiber g , johnson cm , fersht ar ( 1997 ) thermodynamics of the interaction of barnase and barstar : changes in free energy versus changes in enthalpy on mutation .",
    "_ j mol biol _ * 267*:696 .",
    "jiang c , hwang yt , wang g , randell jcw , coen dm , et  al . ( 2007 ) herpes simplex virus mutants with multiple substitutions affecting dna binding of ul42 are impaired for viral replication and dna synthesis . _",
    "j virol _ * 81*:12077 .",
    "natarajan m , lin km , hsueh rc , sternweis pc , ranganathan r ( 2006 ) a global analysis of cross - talk in a mammalian cellular signalling network .",
    "_ nat cell biol _ * 8*:571 .",
    "weinreich dm , delaney nf , depristo ma , hartl dl ( 2006 ) darwinian evolution can follow only very few mutational paths to fitter proteins .",
    "_ science _ * 312*:111 .",
    "aita t , iwakura m , husimi y ( 2001 ) a cross - section of the fitness landscape of dihydrofolate reductase . _ protein eng _ * 14*:633 .",
    "kinney jb , murugan a , callan cg , cox ec ( 2010 ) using deep sequencing to characterize the biophysical mechanism of a transcriptional regulatory sequence . _",
    "proc natl acad sci usa _ * 107*:9158 .",
    "weinreich dm , lan y , wylie cs , heckendorn rb ( 2013 ) should evolutionary geneticists worry about higher - order epistasis ?",
    "_ curr opin genet dev _ * 23*:700 .",
    "szendro ig , schenk mf , franke j , krug j ,",
    "de  visser jagm ( 2013 ) quantitative analyses of empirical fitness landscapes .",
    "_ j stat mech _ * 2013*:p01005 .",
    "horovitz a , fersht ar ( 1990 ) strategy for analysing the co - operativity of intramolecular interactions in peptides and proteins .",
    "_ j mol biol _ * 214*:613 .",
    "horovitz a ( 1996 ) double - mutant cycles : a powerful tool for analyzing protein structure and function . _ fold des _ * 1*:r121 .",
    "horovitz a , fersht ar ( 1990 ) co - operative interactions during protein folding .",
    "_ j mol biol _ * 224*:733 .",
    "goldberg d ( 1989 ) genetic algorithms and walsh functions : part i , a gentle introduction . _ complex systems _ * 3*:129 .",
    "beer t ( 1981 ) walsh transforms . _ american journal of physics _ * 49*:466 .    stoffer ds ( 1991 - 06 - 01 ) walsh - fourier analysis and its statistical applications . _ journal of the american statistical association _ * 86*:461 .",
    "mclaughlin rn , poelwijk fj , raman a , gosal ws , ranganathan r ( 2012 ) the spatial architecture of protein function and adaptation .",
    "_ nature _ * 491*:138 .",
    "hartl dl ( 2014 ) what can we learn from fitness landscapes ?",
    "_ curr opin microbiol _ * 21*:51 .",
    "sierpinski w ( 1915 ) sur une courbe do nt tout point est un point de ramification . _ cr hebd acad science paris _ * 160*:302 .",
    "hastie t , tibshirani r , friendman j ( 2009 ) the elements of statistical learning , 2@xmath148 ed .",
    "new york : springer publishing .",
    "springer series in statistics .",
    "tibshirani r ( 2011 ) regression shrinkage and selection via the lasso : a retrospective .",
    "_ j roy stat soc : ser b _ * 73*:273 .",
    "otwinowski j , plotkin jb ( 2014 ) inferring fitness landscapes by regression produces biased estimates of epistasis .",
    "_ proc natl acad sci usa _ * 111*:e2301 .",
    "sadovsky y , yifrach o ( 2007 ) principles underlying energetic coupling along an allosteric communication trajectory of a voltage - activated k+ channel .",
    "_ proc natl acad sci usa _ * 104*:19813 .",
    "shi l , kay le ( 2014 ) tracing an allosteric pathway regulating the activity of the hslv protease .",
    "_ proc natl acad sci usa _ * 111*:2140 .",
    "ruschak am , kay le ( 2012 ) proteasome allostery as a population shift between interchanging conformers . _ proc natl acad sci usa _ * 109*:e3454 .",
    "luque i , leavitt sa , freire e ( 2002 ) the linkage between protein folding and functional cooperativity : two sides of the same coin ? .",
    "_ ann rev biophys biomol struct _ * 31*:235 .",
    "halabi n , rivoire o , leibler s , ranganathan r ( 2009 ) protein sectors : evolutionary units of three - dimensional structure",
    ". _ cell _ * 138 * : 774 .",
    "kirschner m , gerhart j ( 1998 ) evolvability .",
    "_ proc natl acad sci usa _ * 95*:8420 .",
    "cands ej , wakin mb ( 2008 ) an introduction to compressive sampling .",
    "_ ieee signal proc mag _ * 25*:21 .",
    "zaremba sm , gregoret lm ( 1999 ) context - dependence of amino acid residue pairing in antiparallel -sheets .",
    "_ j mol biol _ * 291*:463 .",
    "shepherd tr , hard rl , murray am , pei d , fuentes ej ( 2011 ) distinct ligand specificity of the tiam1 and tiam2 pdz domains .",
    "_ biochemistry _ * 50*:1296 .",
    "yifrach o , mackinnon r ( 2002 ) energetics of pore opening in a voltage - gated k+ channel",
    ". _ cell _ * 111*:231 .",
    "hidalgo p , mackinnon r ( 1995 ) revealing the architecture of a k + channel pore through mutant cycles with a peptide inhibitor .",
    "_ science _ * 268*:307 .",
    "carter pj , winter g , wilkinson aj , fersht ar ( 1984 ) the use of double mutants to detect structural changes in the active site of the tyrosyl - trna synthetase ( bacillus stearothermophilus ) .",
    "_ cell _ * 38*:835 .",
    "ranganathan r , lewis jh , mackinnon r ( 1996 ) spatial localization of the k+ channel selectivity filter by mutant cycle - based structure analysis .",
    "_ neuron _ * 16*:131 .",
    "hinkley t , martins j , chappey c , haddad m , stawiski e , whitcomb jm , petropoulos cj , bonhoeffer s ( 2011 ) a systems analysis of mutational effects in hiv-1 protease and reverse transcriptase .",
    "_ nat genetics _ * 43*:487 .",
    "marks ds , hopf t , sander c ( 2012 ) protein structure prediction from sequence variation .",
    "biotechnol _ * 11*:1072",
    ".    morcos f , pagnani a , lunt b , bertolino a , marks ds , sander c , zecchina r , onuchic jn , hwa t , weigt m ( 2011 ) direct - coupling analysis of residue coevolution captures native contacts across many protein families .",
    "_ proc natl acad sci _ * 108*:e1293 .",
    "skerker jm , perchuk bs , siryaporn a , lubin ea , ashenberg o , goulian m , laub mt ( 2008 ) rewiring the specificity of two - component signal transduction systems .",
    "_ cell _ * 133*:1043 .",
    "+    [ [ a .- expressing - the - biochemical - epistasis - operator - boldsymbolg - as - a - hadamard - transform ] ] a. expressing the biochemical epistasis operator @xmath43 as a hadamard transform : ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^",
    "+ @xmath149  ( eq . ) +   +   + first we write the different matrix operators in their recursive form , and then proceed by induction .",
    "we have for the recursive form of @xmath72 : +   + @xmath150 \\ \\boldsymbol{x}_n &   \\ 0 \\ \\ \\ ,     \\\\[0.2em ] \\ \\boldsymbol{x}_n & \\boldsymbol{x}_n\\ , \\end{pmatrix*}\\ \\ \\mathrm{with}\\ \\ \\ \\boldsymbol{x}_0 = 1 $ ] +   +   + in order to find the generative function for the inverse @xmath151 we can write @xmath152 : +   + @xmath153 \\ \\boldsymbol{x}_n &   \\ 0 \\ \\ \\ ,     \\\\[0.2em ] \\",
    "\\boldsymbol{x}_n & \\boldsymbol{x}_n\\ , \\end{pmatrix * } \\boldsymbol{x}^{^{-1}}_{n + 1 } = \\begin{pmatrix*}[r ] \\",
    "\\ \\mathbb{i } & \\ \\ 0 \\ \\ \\\\[0.2em ] \\ \\ 0 & \\ \\ \\mathbb{i}\\ \\ \\end{pmatrix*}$ ] , +   + which we can solve by gauss - jordan elimination : +   + @xmath154 \\boldsymbol{x}_n & \\boldsymbol{x}_n\\ & \\ 0 & \\ \\ \\mathbb{i}\\\\ \\end{array } \\right ) \\rightarrow \\left ( \\begin{array}{rr|rr } \\mathbb{i } & \\ \\ 0 \\ \\   & \\boldsymbol{x}^{^{-1}}_{\\ n } & 0 \\ \\ \\ \\\\[0.2em ] \\mathbb{i } & \\mathbb{i } \\ \\ & 0 \\ \\ \\ & \\boldsymbol{x}^{^{-1}}_{\\ n}\\\\ \\end{array } \\right)\\rightarrow \\left ( \\begin{array}{rr|rr } \\mathbb{i } & \\ \\ 0 \\ \\   & \\boldsymbol{x}^{^{-1}}_{\\ n } & 0 \\ \\ \\ \\\\[0.2em ] 0 & \\mathbb{i } \\ \\ & -\\boldsymbol{x}^{^{-1}}_{\\ n } & \\boldsymbol{x}^{^{-1}}_{\\ n}\\\\ \\end{array } \\right ) $ ] +   + hence we have for the inverse of @xmath72 : +   + @xmath155 \\ \\boldsymbol{x}^{^{-1}}_{\\ n } & \\ \\ 0 \\ \\ \\ \\   \\\\[0.2em ] \\",
    "-\\boldsymbol{x}^{^{-1}}_{\\ n } &",
    "\\boldsymbol{x}^{^{-1}}_{\\ n } \\ \\end{pmatrix*}\\ \\ \\mathrm{with}\\ \\ \\ \\boldsymbol{x}^{^{-1}}_0 = 1 $ ] +   +   + which is identical to the recursive form for @xmath43 : +   + @xmath156 \\ \\boldsymbol{g}_n & \\ \\ 0 \\ \\ \\    \\\\[0.2em ] \\",
    "-\\boldsymbol{g}_n & \\boldsymbol{g}_n\\ \\end{pmatrix*}$ ] +   +   + we further have : +   + @xmath157 \\ \\ \\boldsymbol{h}_n & \\boldsymbol{h}_n\\   \\\\[0.2em ] \\ \\ \\boldsymbol{h}_n & -\\boldsymbol{h}_n\\ \\end{pmatrix*}\\ \\ \\mathrm{with}\\ \\ \\ \\boldsymbol{h}_0 = 1 $ ] +   +   + and @xmath158 \\ \\frac{1}{2 } \\boldsymbol{v}_{\\!n } & 0 \\ \\ \\ \\\\[0.2em ] 0 \\ \\ \\ & -\\boldsymbol{v}_{\\!n}\\ \\end{pmatrix*}\\ \\ \\mathrm{with}\\ \\ \\ \\boldsymbol{v}_{\\!0 } = 1 $ ] +   +   +   + with the above relations we can derive the equality in the main text expressing @xmath43 as a hadamard transform : +   + @xmath159 +   + for @xmath160 the statement is trivial .",
    "we now show by induction that this relation holds for all @xmath17 .",
    "+   + @xmath161 \\ \\boldsymbol{g}_n & \\ \\ 0 \\ \\ \\   \\\\[0.2em ] \\",
    "-\\boldsymbol{g}_n & \\boldsymbol{g}_n \\ \\end{pmatrix * } = \\begin{pmatrix*}[r ] \\   \\boldsymbol{v}_{_{\\!n } } \\boldsymbol{x}_{_{n}}^t \\boldsymbol{h}_n & 0 \\ \\ \\ \\ \\ \\ \\\\[0.2em ] \\   -\\boldsymbol{v}_{_{\\!n } } \\boldsymbol{x}_{_{n}}^t \\boldsymbol{h}_n    &   \\boldsymbol{v}_{_{\\!n } } \\boldsymbol{x}_{_{n}}^t \\boldsymbol{h}_n\\ \\end{pmatrix * } $ ] +   +   + @xmath162 \\ \\frac{1}{2 } \\boldsymbol{v}_{\\!n } & 0 \\ \\ \\ \\\\[0.2em ] 0 \\ \\ \\ & -\\boldsymbol{v}_{\\!n } \\end{pmatrix * } \\begin{pmatrix*}[r ] \\ \\ 2 \\boldsymbol{x}_{_{n}}^t \\boldsymbol{h}_n & 0 \\ \\ \\ \\ \\ \\\\[0.2em ] \\ \\",
    "\\boldsymbol{x}_{_{n}}^t \\boldsymbol{h}_n\\   & -\\boldsymbol{x}_{_{n}}^t \\boldsymbol{h}_n\\ \\end{pmatrix * } = \\begin{pmatrix*}[r ] \\ \\frac{1}{2 } \\boldsymbol{v}_{\\!n } & 0 \\ \\ \\ \\\\[0.2em ] 0 \\ \\ \\ & -\\boldsymbol{v}_{\\!n}\\ \\end{pmatrix * } \\begin{pmatrix*}[r ] \\",
    "\\boldsymbol{x}_{_{n}}^t & \\boldsymbol{x}_{_{n}}^t\\",
    "\\    \\\\[0.2em ] \\ 0 \\ \\   & \\boldsymbol{x}_{_{n}}^t\\ \\ \\end{pmatrix * } \\begin{pmatrix*}[r ] \\ \\ \\boldsymbol{h}_n & \\boldsymbol{h}_n\\   \\\\[0.2em ] \\ \\ \\boldsymbol{h}_n & -\\boldsymbol{h}_n\\ \\end{pmatrix*}$ ] +   +   + @xmath163 +   +   +   +       + @xmath164  ( eq . ) +   +   + we will use @xmath82 and @xmath165 as defined in the main text .",
    "+   + for the right - hand side we can write +   + @xmath166 +   + where we used @xmath167 , which can be proven straightforwardly by induction using the generative function for @xmath62 .",
    "+ rearranging and using @xmath168 , we obtain +   + @xmath169 +   + we thus have to prove +   + @xmath170 +   + left - multiplying both sides by @xmath171 ( mind the hat is only on the first operator ) and right - multiplying by @xmath62 we are left to prove +   + @xmath172 +   + left - multiplication by @xmath80 yields +   + @xmath173 +   + which , again using the relation we proved in section a above , can be rewritten as +   + @xmath174 +   + or +   + @xmath175 +   + given the commutative properties of diagonal matrices @xmath95 and @xmath176 . +   + this equality indicates that setting certain rows of @xmath177 to zero ( left - hand side ) is the same as setting both those rows and corresponding columns of @xmath177 to zero ( right - hand side ) .",
    "this is obviously not true for every set of rows and columns , and needs more discussion .",
    "+   + we can prove this iteratively starting at regression to order @xmath178 and going down to lower order .",
    "if regression is done to order @xmath178 , this means that only the last row of @xmath177 is set to zero , and by construction of @xmath177 ( see above ) the last column only has a non - zero element in this row .",
    "this means that in this case the equality is correct .",
    "another way to see this is looking at matrix @xmath43 for @xmath51 in its explicit representation in the main text ( here @xmath43 being identified with @xmath177 ) and noting that the highest order epistatic term @xmath45 is the only one that receives a contribution from the highest order ( @xmath17 ) mutant term @xmath119 .",
    "+   + next , if regression is performed instead to order @xmath179 , not only the last row of @xmath177 is set to zero , but also the rows corresponding to @xmath178 order mutants .",
    "analogously to above , the only terms in the vector @xmath37 that receive contributions from the @xmath178 order mutants are the ones in the rows corresponding to @xmath178 order of epistasis ( since the row corresponding to @xmath17@xmath67 order is already set to zero ) , meaning that their corresponding column again has only one non - zero element . hence setting these rows to zero",
    "will directly set their corresponding column to zero , and the equality holds .",
    "+   + and so forth for regression to order @xmath180 , etc .",
    "+   + qed +   +"
  ],
  "abstract_text": [
    "<S> defining the extent of epistasis  the non - independence of the effects of mutations  is essential for understanding the relationship of genotype , phenotype , and fitness in biological systems . </S>",
    "<S> the applications cover many areas of biological research , including biochemistry , genomics , protein and systems engineering , medicine , and evolutionary biology . </S>",
    "<S> however , the quantitative definitions of epistasis vary among fields , and its analysis beyond just pairwise effects remains obscure in general . here , we show that different definitions of epistasis are versions of a single mathematical formalism - the weighted walsh - hadamard transform . </S>",
    "<S> we discuss that one of the definitions , the backgound - averaged epistasis , is the most informative when the goal is to uncover the general epistatic structure of a biological system , a description that can be rather different from the local epistatic structure of specific model systems . </S>",
    "<S> key issues are the choice of effective ensembles for averaging and to practically contend with the vast combinatorial complexity of mutations . in this regard , </S>",
    "<S> we discuss possible approaches for optimally learning the epistatic structure of biological systems .    </S>",
    "<S> there has been much recent interest in the prevalence of epistasis in the relationships between genotype , phenotype , and fitness in biological systems @xcite . </S>",
    "<S> epistasis here is defined as the non - independence ( or context - dependence ) of the effect of a mutation , which is a generalization of bateson s original definition of epistasis as a genetic interaction in which a mutation masks the effect of variation at another locus @xcite . </S>",
    "<S> it is also in line with fisher s broader definition of epistacy @xcite . </S>",
    "<S> epistasis limits our ability to predict the function of a system that harbors several mutations given knowledge of the effects of those mutations taken independently @xcite , and makes these relationships increasingly more complex @xcite . from an evolutionary perspective , the presence of epistatic interactions may limit or entirely preclude trajectories of single - mutation steps towards peaks in the fitness landscape @xcite . with regard to human health , epistasis complicates our understanding of the origin and progression of disease @xcite . </S>",
    "<S> thus , interest in the extent of epistatic interactions in biological systems has originated from the fields of protein biochemistry , protein engineering , medicine , systems biology , and evolutionary biology alike .    </S>",
    "<S> originally epistasis was considered in the context of two genes , but we can define it more broadly as the non - independence of mutational effects in the genome , whether the effects are within , between , or even outside protein coding regions ( e.g. in regulatory regions ) . </S>",
    "<S> the perturbations may go beyond point mutagenesis , but we limit the discussion here for clarity of presentation . </S>",
    "<S> importantly , the definition of epistasis can be extended beyond pairwise effects to comprise a hierarchy of 3-way , 4-way , and higher - order terms that represent the complete theoretical description of epistasis between the parts that make up a biological system .    </S>",
    "<S> how can we quantitatively assign an epistatic interaction given experimentally determined effects of mutations ? </S>",
    "<S> since epistasis is deviation from independence , it is crucial to first explicitly state the null hypothesis : asserting what exactly it means to have _ independent _ contributions of mutations . </S>",
    "<S> this by itself can be non - trivial . in some cases </S>",
    "<S> the phenotype is directly related to a thermodynamic state variable , and the issue is then straightforward : independence implies additivity in the state variable . </S>",
    "<S> for example , for equilibrium binding reactions between two proteins , independence means additivity in the free energy of binding @xmath0 , such that the energetic effect of a double mutation is the sum of the energetic effects of each single mutation taken independently . </S>",
    "<S> however , in general , many phenotypes can not be so directly linked to a thermodynamic state variable , and quantification of epistasis needs to be accompanied by a proper rationale for the choice of null hypothesis . in what follows </S>",
    "<S> we will assume this step has already been carried out and we will equate independence with additivity of mutational effects . </S>",
    "<S> epistasis between two mutations is then defined as the degree to which the effect of both mutations together differs from the sum of the effects of the single mutations .    in this paper , we describe three theoretical frameworks that have been proposed for characterizing the epistasis between components of biological systems ; these frameworks originate in different fields and use seemingly different calculations to describe the non - independence of mutations @xcite . </S>",
    "<S> we show that these formalisms are different manifestations of a common mathematical principle , a finding that explains their conceptual similarities and distinctions . </S>",
    "<S> each of these formalisms has its value depending on depth of coverage and nature of sampling in the experimental data , and the purpose of the analysis . in the end , </S>",
    "<S> the fundamental issue is to develop practical approaches for optimally learning the epistatic structure of biological systems in the face of explosive combinatorial complexity of possible epistatic interactions between mutations . </S>",
    "<S> demonstrating the mathematical relationships between the different frameworks for analyzing epistasis is a first key step in this process . </S>"
  ]
}