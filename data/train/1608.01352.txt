{
  "article_text": [
    "seawater intrusion ( swi ) is a complex process that occurs naturally due to small differences in density between freshwater and saltwater .",
    "depending on the hydrogeological setting , seawater can enter the coastal aquifers through preferential flow pathways reaching far into the interior , or remain in close proximity to the coast @xcite .",
    "increased groundwater ( gw ) extraction , reduced recharge into aquifers , and other human activities can cause the swi to propagate further inland . to monitor the swi and manage coastal aquifers , representative groundwater models need to be developed .",
    "such models can then provide explanations for saltwater origin in the area , and can be used to validate different pumping scenarios to manage the saltwater front propagation and future freshwater demands @xcite and @xcite .    for the affected areas we can usually expect some monitoring wells providing direct samples of fluid conductivity and thus indicating the salinity .",
    "however , understanding the complexity of swi advance , this data might be too scarce to calibrate gw models and monitor the swi progress .",
    "geophysical methods offer an attractive option to map this process @xcite .",
    "saltwater in the pore spaces increases the soil bulk electrical conductivity , making it an ideal target for direct current ( dc ) resistivity or electromagnetic methods .",
    "hence , these geophysical methods have become standard tools for monitoring swi in the last two decades @xcite but have also many other environmental applications .",
    "their popularity is mainly due to their ability to map the 3d subsurface non - intrusively and at a lower cost",
    ".    one disadvantage of geophysical data is that they provide only indirect measurements ; mapping the electrical conductivity of the subsurface which is dependent on other geological characteristics such as lithology rather than the amount of solute in groundwater alone .",
    "furthermore , when collecting data , the choice of method and survey design has an effect on the depth resolution , and the area most sensitive to collected data .",
    "in contrast , groundwater well samples can provide the actual fluid conductivity , which in coastal areas is usually directly related to saltwater content .",
    "however , gw data may represent only a small space around the well or might not capture the difference between flow and resident concentration , see @xcite for more details .",
    "combining both the geophysical and hydrological data offers an attractive option to increase the amount of data for model calibration and to improve the estimates of gw states , which is also subject of this study .",
    "there are many different approaches in hydrogeophysical studies , often dependent on available data and software . in the uncoupled framework ,",
    "geophysical and hydrogeological computations are independent .",
    "the advantage of this approach is that hydrogeological and geophysical models run independently , however , this also means that the a - priori information from the hydrology is not integrated into the geophysical inversion .",
    "since geophysical inverse problems are ill - posed and require a regularization term , or a prior stochastic model ( if bayesian methods are used ) , ignoring hydrogeology data can severely deteriorate the quality of the geophysical inversion estimates .",
    "in contrast , in the coupled approach , the geophysical and groundwater models are linked together during the inversion .",
    "the hydrological state estimates are then guaranteed to be physically realistic and less a - priori assumptions are needed for the geophysical inversion . due to this fact ,",
    "coupled approaches were repeatedly found to give better results ( @xcite , @xcite or @xcite ) , however , at a cost of being computationally more intensive .",
    "the computational cost is high also due to the gw flow governing equations , which for variable density flow , require solving a system of two strongly couple da nonlinear partial differential equations .",
    "any 3d simulation is therefore costly when solving the inverse problem , where multiple gw forward simulations are necessary . to decrease the amount of estimated parameters and make the inverse problem solvable , usually some a - priori information based on geology is considered .",
    "for example by applying some geostatistical constraints when estimating the gw parameters @xcite or adding regularization terms to enhance smooth fields for estimated parameters or states .",
    "the actual minimization is then often directed by some general inverse software as pest @xcite or ucode @xcite where the sensitivities are derived by perturbation approach .    in the salt tracer experiments ,",
    "the time and spatial scale enables to consider only solute transport , when modeling the gw flow , and thus simplify the gw inverse problem in terms of the computation cost .",
    "examples can be found in work of fowler and moysey@xcite , where they investigated the non - uniqueness of gw parameter estimation using a single electrode and evaluating only the geophysical data misfit .",
    "a stochastic approach to coupled inversion was applied in jardani et al.@xcite or irving and singha @xcite by jointly inverting geophysical and groundwater concentration data during the tracer test to determine the hydraulic conductivity fields in 2d . in monego",
    "@xcite estimated mean groundwater velocity and aquifer dispersivity ( both assumed to be uniform ) from the ert mapped tracer test in a shallow heterogeneous aquifer .    for the swi ,",
    "the situation is usually more complex in terms of time scale and heterogeneity compared to solute tracer experiments .",
    "many field studies were performed to delineate the swi extent by use of geophysical data to indicate the saltwater intrusion progress @xcite .",
    "less work has been done in conjunction with gw data and estimating the gw parameters and states in the coupled approach .    in the work of herckenrath et al.@xcite ,",
    "the authors compared two approaches for calibration of swi model with the addition of tdem data sets collected in santa cruz county , california . in the sequential approach the geophysical inversion for 1d tdem soundings",
    "are run independently and geophysical estimates served as an extra observation for the gw model ( after transforming via petrophysical relationship - archie s law ) .",
    "both data misfits were then minimized in the gw model inversion process . in the coupled approach the gw model",
    "is used to interpret the data and guide the geophysical inversion .",
    "saltwater concentrations based on the 2d seawat model @xcite were converted to electrical resistivity and 1d tdem sounding forward responses were then calculated and compared with observed data . in total , six parameters were estimated for both the groundwater and tdem model using the pest optimization system .",
    "the authors concluded that the coupled approach provided a significant improvement in spatial resolution which would be hard to obtain with standard geophysical regularization techniques as was the case for the sequential approach .",
    "a different way of transforming the information from geophysical estimates was introduced in beaujean et al.@xcite .",
    "the ert derived conductivities were transformed via archie s law to salt mass fraction estimates .",
    "these estimates were then filtered using a cumulative sensitivity based on squared jacobians and served as extra data for hydrological inversion next to groundwater salt mass fraction data .",
    "the inversion was performed with pest using a gradient based method .",
    "the approaches above are somewhat limited to a small number of parameters because of the direct computations of sensitivities .",
    "a more general framework was developed by commer et al .",
    "@xcite that can be applied to larger scale hydrologeophysical problems for a wide range of processes in multiphase flow and solute transport .",
    "the authors improved the inversion framework of itough2 to enable parallel computing and merge it with parallel geophysical simulator for electromagnetic data .",
    "the sensitivities were evaluated by taking a perturbation approach .",
    "the high computational burden of this approach was balanced by the fact that the perturbed model simulation could be run independently .",
    "while the work in @xcite enables larger scale problems , it can be inefficient due to the finite difference evaluation of derivatives and hydrogeophysical coupling .",
    "our goal here is to improve on this work such that we can solve large scale problems . to this end",
    "we present a new approach for the joint recovery of electrical conductivity and salinity .",
    "we solve the inverse problem by minimizing both types of data , where the petrophysical relationship provides a constraint in the minimization .",
    "the estimation of initial conditions for solute distribution is particularly important because if we have a good estimate of the current situation , we can better predict the future states , which is necessary for managing salt water intrusions .",
    "we developed both geophysical and groundwater models , which are based on discretized systems of equations , in the same computational environment .",
    "although similar models exist , we have developed our own flow and geophysical model to simplify the coupling implementation between physically different models .",
    "more importantly , it enables us to analytically derive the sensitivities necessary for solving the inverse problem .",
    "this allows us to deal with a large number of parameters at a cost that is cheaper than computing sensitivities using finite differences .    for the actual minimization of the coupled problem we have multiple options .",
    "we can use the knowledge of the petrophysical constraint and minimize both the data misfits simultaneously , for example by substituting the constraint and applying the gauss newton method for one variable only .",
    "this would result in a smaller problem , however in such case we have to deal with many regularization parameters to weight the different contributions to the coupled objective function by both data misfits .",
    "furthermore , since the relation between the different physical models is often empirical , forcing it may lead to artifacts ( see @xcite for further details ) .",
    "therefore we introduce alternating direction method of multipliers ( admm ) to solve the coupled problem , which allows us to efficiently split the objective function into gw and geophysical parts and minimize each separately . the main advantage to this",
    "is that by separating the minimization of the coupled problem onto gw and geophysical parts only one regularization parameter is set during each iteration , and inversion codes stay relatively independent enabling for efficient parallelization .",
    "furthermore , since the petrophysics is enforced as a constraint , it is not applied exactly throughout the path of optimization which yields additional degrees of freedom to the optimization algorithm .",
    "admm has been introduced back in early 70 s and has recently gained popularity for many inverse problems .",
    "it is a natural choice for multiphysics problems @xcite , also due to the strong convergence properties @xcite .",
    "it can be used in cases where the constraint ( here the petrophysical relationship ) can be considered as exact , in practice rather having low uncertainty .",
    "a successful hydrological application can be found in wohlberg et al .",
    "@xcite , where admm was applied to solve the inverse problem of estimating the piece - wise smooth hydraulic conductivity fields from sparse data for hydraulic head and conductivity , many more applications can be found in machine learning or statistical modeling .",
    "the joint inversion scheme outlined above is expected to converge towards a solution that will fit both data sets .",
    "difficulty converging may reveal discrepancies between the two sources of data , or between the petrophysical model that is used to link the parameters . in our inverse problem setup with",
    "use synthetic groundwater and geophysical data ( well salinity data end electrical potentials ) generated only once .",
    "the unknown current and initial solute distribution are then estimated from this data .",
    "the fact that we solve for the solute content - electrical conductivity only , with the assumption of at least an approximate knowledge of other gw parameters can be regarded as naive , however , the same framework can be established for gw parameters such as hydraulic permeability , external fluxes and other gw variables as long as appropriate sensitivities are derived .",
    "we do not try here to estimate all of these parameters at once , since despite having two different sets of data , the inverse problem is essentially highly ill - posed , and most of these parameters vary over the entire domain .",
    "our work is based on a frequentist approach to inverse problems @xcite that is suited for large scale problems . alternatively ,",
    "if prior densities are known , one can use the maximum a - postriori estimate when considering the bayesian framework and use similar techniques to the ones developed here .    in the section  [ secgw ] and [ secgeop ] ,",
    "we describe the groundwater model and geophysical model including the discretized form of governing equations .",
    "the authors are aware that these models are already well described in other literature but they are of a key importance in this study in order to follow the sensitivities derivation . in section  [ ip ] , we formulate the coupled inverse problem and introduced the new admm approach .",
    "the results for the joint inversion by admm versus a simple coupled approach are shown in section  [ results ] .",
    "we examined different synthetic cases of a pumping experiment in a coastal aquifer with homogeneous and heterogeneous permeability field and compared the joint approach ( using admm ) with a simpler coupled approach based on a reference model .",
    "additionally , we looked at how the error of estimates changes if the gw model parameters used in the inversion deviate from the `` true '' parameters which served to create the synthetic data .",
    "section  [ disc ] follows with discussion and finally , in section  [ sum ] , we summarize the paper and suggest future work .",
    "in this section , we briefly introduce the groundwater model used in this study , its discretization using finite volumes and the solution of the discrete equations .",
    "our method uses some specific properties of variable density flow ( vdf ) to develop a highly efficient operator splitting method .",
    "the system of governing equations for vdf couples two processes : groundwater flow and solute transport , each represented by a partial differential equation in time and space .",
    "the system can be written as : @xmath0 where @xmath1    the system above is a pressure - solute mass fraction formulation @xcite , where @xmath2 is the fluid density , @xmath3 is the fraction of solute ( saltwater ) in the fluid , @xmath4 porosity , @xmath5 represents the hydrodynamic dispersion and @xmath6 and @xmath7 the external fluxes of solute and groundwater and @xmath8 stands for time .",
    "@xmath9 is the groundwater velocity based on darcy s law @xcite , where @xmath10 is the pressure , @xmath11 the permeability of porous media , @xmath12 the fluid viscosity , @xmath13 the gravitational constant and @xmath14 is a downward coordinate direction . to complete the system a number of physical relationships and parameters",
    "are required .",
    "we assume that the mass fraction @xmath3 is connected to the density by the linear relation @xmath15 where @xmath2 represents the fluid density , @xmath16 freshwater density and @xmath17 saltwater density .",
    "in our model we used a number of simplifications that can be relaxed , but are justified for our application .",
    "first , we assume a steady state for groundwater flow equation , which still has to be resolved throughout each time step computation to update the pressure and velocity field as a result of solute content dynamics .",
    "next , the hydrodynamic dispersion tensor @xmath18 is kept fixed in our model . using a full variable density flow model , as for example in @xcite",
    ", would not change the approaches described in the following sections regarding coupling and solving the inverse problem .      in this subsection",
    ", we briefly discuss the discretization used for each of the governing equations . even though the following text is not necessary to understand the idea behind the hydrogeophysical coupled approach in section [ ip ]",
    ", it is an important part in our study , since we derive the sensitivities analytically based on the discretized equations , which are later needed for the gauss - newton method .",
    "we use a cell - centered finite volume method for the flow equation , and an operator splitting method for the solute transport equation .",
    "in particular , when integrating the solute transport we use a semi - lagrangian method for the advection part and add the dispersion part implicitly .",
    "our groundwater model discretizes equations   and in 3d on a staggered grid .",
    "the solute fraction @xmath3 , and the pressure @xmath10 are placed in the cell centers and the fluxes , @xmath19 , on the cell faces .",
    "the parameters @xmath4 and @xmath5 are discretized at the cell centers and harmonically averaged onto cell faces when needed .",
    "for a complete description on the discretization of systems of the form and using finite volumes see @xcite .",
    "the discrete pressure equation reads @xmath20 where @xmath21 and the division is done pointwise , @xmath22 are divergence and gradient matrix operators .",
    "@xmath23 is the arithmetic averaging operator and @xmath24 is a gravity acceleration vector .",
    "we use the hadamard product @xmath25 for the element wise product of two vectors .",
    "the ad - script @xmath26 stands for the corresponding hydrological state at the @xmath27 time step .",
    "assuming that we know the density at the @xmath27 time step , the unknown pressure @xmath28 can be solved directly @xmath29 where the matrix @xmath30 is inverted using either cholesky ( for small to medium scale problems ) or by the preconditioned conjugate gradient method .",
    "given the pressure @xmath28 we can compute the groundwater linear velocity @xmath31 at the cell faces : @xmath32      for the solution of equation , we use operator splitting .",
    "the system is split into an advection and a dispersion part and then integrated sequentially from time @xmath33 to @xmath34 :    @xmath35    in operator splitting methods , the advection equation is typically solved first , using some explicit method starting at @xmath36 to obtain the temporary variable @xmath37 .",
    "the diffusion equation is solved next using an implicit method and obtaining @xmath38 from @xmath37 .    for the problems in this work",
    ", the advection equation is solved using a semi - lagrangian approach and dispersion is solved with an eulerian step .",
    "our method belongs to the family of modified methods of characteristics ( mmoc ) first introduced in @xcite .",
    "the main advantages are in the alleviation of the courant number restriction due to the lagrangian advection step @xcite and mass conservation .",
    "the eulerian - lagrangian scheme is also effective in overcoming numerical dispersion for advection dominated problems @xcite .",
    "similar approaches are for example taken by codes such as moc3d model for solute transport @xcite , or later mt3dms for variable density flow in connection with modflow @xcite . in the context of review on eulerian - lagrangian localized adjoint methods ( ellam)@xcite",
    "our approach is a finite difference eulerian - lagrangian type , where we do not solve the solute transport equation using an integral equation but with a projection matrix .    in our implementation",
    ", particles are placed at the mesh centers at each time step and tracked forward .",
    "the mass of each transported particle is interpolated to its neighbors yielding the solution at the next time step ( figure  [ pic_sl ] ) .",
    "[ picfig ]    ( 0.65,0.65 ) circle ( 5pt ) ; ( 0.625,0.625 ) to ( 2.7,2.4 ) ; ( 2.8,2.5 ) circle ( 5pt ) ;    ( 3.25,3.25 ) circle ( 5pt ) ; ( 1.95,3.25 ) circle ( 5pt ) ; ( 1.95,1.95 ) circle ( 5pt ) ;    ( 3.25,1.95 ) circle ( 5pt ) ;    ( 2.7,2.4 ) to ( 3.25,3.25 ) ; ( 2.7,2.4 ) to ( 1.95,3.25 ) ; ( 2.7,2.4 ) to ( 1.95,1.95 ) ; ( 2.7,2.4 ) to ( 3.25,1.95 ) ; ( -1,-1 ) grid ( 5,5 ) ;    rather than transporting solute mass fraction @xmath3 , we transport solute mass @xmath39 at each time step , and since the lagrangian method is conservative , @xmath39 is conserved .",
    "the discretization of the advection equation can be written as @xmath40 where @xmath41 is an interpolation matrix that contains the interpolation weights and is a function of the velocity field @xmath31 . using the condition",
    ", we can solve a local quadratic equation for @xmath42 , noting that only one root of the equation makes physical sense .",
    "having the solution @xmath42 , we can now integrate the diffusion dominated part , starting from @xmath42 . with an implicit euler method , the equation reads @xmath43 the implicit diffusion is nonlinear and it is solved using a picard iteration @xcite , updating also the velocity field and corresponding @xmath42 . for vdf with seawater ,",
    "the density difference between the two fluids is fairly small , decreasing the nonlinearity of the coupled system and the number of picard iterations .",
    "even though the time step can be large given the stability of the semi - lagrangian method , care must be taken with respect to the coupling with the flow equation @xcite .",
    "a step too large would lead to a weak coupling and the possibility of erroneous calculations .      in order to proceed with gauss - newton minimization",
    "when solving the inverse problem , we need to know the sensitivities of the collected data with respect to the unknown initial solute content . in our inverse problem ,",
    "the data are represented by the final solute mass fraction . at each time step of the groundwater",
    "forward model simulation we solve the system of two partial differential equations , where at the end of each time step the pressure @xmath28 is given by the solute distribution and boundary conditions .",
    "the groundwater velocity @xmath31 can be then expressed as a function of @xmath44 and @xmath28 only and the system reduces to the second equation for solute transport .",
    "the solute mass balance equation is time dependent , and the velocity dependence is stored in interpolation matrix @xmath45 , which is a function of flux @xmath31 and solute mass @xmath46 . + since the sensitivities do not need to be known exactly , we can assume that for their calculation the density does not vary much and proceed with using the solute mass fraction formulation alone , for which the time stepping process of equation can be written as : @xmath47 since we are using the operator splitting approach , we can explicitly derive the sensitivity of the mass @xmath48 at each time step with respect to the solute fraction at the previous time step .",
    "this is a two step calculation , step 1 being the advection part and step 2 being the diffusion part .",
    "the sensitivity of the final solute fraction can therefore be calculated recursively during the forward gw model run .    more generally , if we consider all time steps together ( see in figure [ eqinpic ] ) ,        which can be written in a compact form as @xmath49 where @xmath50 is the time stepping matrix that is block bidiagonal and @xmath51 is the matrix that multiplies @xmath52 .",
    "the vector @xmath53 involves the boundary conditions and sources and vector @xmath54 is set here as @xmath55^{\\top}$ ] .",
    "differentiating @xmath56 with respect to @xmath52 we obtain that @xmath57 and therefore @xmath58 using we see that @xmath59 and later on , this is referred to as the sensitivity @xmath60 . in particular , if we wish to compute the sensitivity of data that are measured for @xmath54 in a small number of locations / times with respect to @xmath52 , we extract these points from .",
    "let the matrix @xmath61 be the matrix that extracts @xmath54 for the time steps and locations that the data are measured in @xmath62 then , the sensitivity of the last time step is simply @xmath63    it is important to note that in order to compute the sensitivity times a vector , one does not need to compute the sensitivity explicitly in a matrix form .",
    "instead one needs to multiply @xmath51 times a vector and then solve a time stepping problem forward . for the multiplication of @xmath64 times a vector , one multiplies by @xmath65 and then solves a backward time stepping process . for more details about the implementation",
    "see @xcite .",
    "in order to estimate the physical properties of the media , we choose direct current ( dc ) resistivity , also referred to as electrical resistance tomography ( ert ) .",
    "dc resistivity is sensitive to the electrical conductivity of the media and since the conductivity of salt water is a few orders of magnitude larger than that of freshwater , the dc resistivity method is a natural choice .",
    "other electrical methods can be used , however , dc has several advantages , i.e. data acquisition is relatively easy , computational effort is minimal , and cost is low .    in dc experiments ,",
    "a current is injected into the ground creating an electrical potential , which is then measured using pairs of electrodes placed on or under the surface . to model this process",
    ", we used the steady state form of maxwell s electromagnetic equations : @xmath66 where @xmath67 represents the media s electrical conductivity , @xmath68 is the electric potential , @xmath69 is the current source , @xmath70 dirac delta function and @xmath71 stands for location of positive and negative electrodes .",
    "the boundary conditions were set as no flux across the boundaries , @xmath72 . when solving the forward problem , the electrical conductivity field , @xmath67 , is known and potentials everywhere can be calculated using a finite volume approach on a 3d grid . since the discretized dc equation is essentially the same type of equation ( poisson equation ) as the flow equation ( [ flowdis ] ) , we follow the same procedure to solve it as has already been described in the previous section and use a cell - centered finite volume approach for the discretization of the problem leading to a linear system of equations : @xmath73 where @xmath74 the electrical conductivity @xmath75 is averaged harmonically from the cell centers onto cell faces , @xmath76 is the source term and @xmath77 represents the potentials .",
    "the forward model solves the potential values everywhere for a given conductivity field , and using the data projection matrix @xmath78 , the observed data are @xmath79 measured at the receivers .",
    "we can write the forward geophysical model @xmath80 in simple matrix vector notation as : @xmath81 where @xmath82 is commonly chosen to be the log electrical conductivity , i.e. @xmath83 and following eq .",
    "@xmath84 is just @xmath85 following the basic rules of sensitivity calculation , the derivative of the forward geophysical model with respect to @xmath82 is equal to zero : @xmath86 the sensitivity of potential @xmath77 with respect to @xmath82 is then @xmath87 we can then substitute into and obtain the sensitivity of measured data with respect to log conductivity @xmath82 as @xmath88 the matrix @xmath89 is a sparse matrix and its calculation is discussed in @xcite .",
    "again , the sensitivity matrix does not need to be evaluated explicitly , only matrix vector products are used in the gauss - newton minimization procedure .",
    "the electrical conductivity of a porous media is dependent on fluid conductivity , rock / soil porosity , permeability , saturation , temperature and also mineral composition @xcite . in the saturated sediments of coastal aquifers ,",
    "fluid conductivity is usually the main factor due to salinity of the fluid , but in other cases surface conductivity of fluid - grain interface , porosity or amount of saturation can be the main factors influencing the overall electrical conductivity . empirical petrophysical relationships , such as archie s law @xcite , were therefore developed to relate these properties .",
    "for fully saturated sediments archie s law can be written as : @xmath90 where @xmath91 is the bulk electrical conductivity , @xmath92 is the fluid electrical conductivity , @xmath4 porosity . @xmath93 and @xmath26 are empirical parameters related to rock type which can be calibrated based on soil core samples , field survey or estimated by recommended values based on geological characterization .",
    "the fluid electrical conductivity in natural waters increases with the amount of dissolved solids and ions @xcite .",
    "linear relationships can be found for a fixed temperature between total dissolved solids ( tds ) and fluid electrical conductivity .",
    "since the seawater is usually dominated by sodium chloride ions , we can assume a linear relationship between salt mass fraction and fluid conductivity : @xmath94where @xmath95 is the conductivity of freshwater , @xmath96 a constant and @xmath97 is the salt mass fraction .",
    "the electrical conductivity of seawater is approximately two orders of magnitude higher than that of freshwater . after substituting into archie s law",
    ", we have @xmath98 in this petrophysical relationship one assumes that the bulk conductivity is affected only by the electrical conductivity of the fluid in the porous matrix , the variations in temperature are small , and that the surface conductivity of porous material is negligible .",
    "this would not be valid for example , in environments with a high clay content @xcite ; in many cases though , the differences in conductivity due to the variation in geological material are negligible compared to the increase in conductivity due to saltwater ions .",
    "equation ( [ myarchie ] ) was used to generate electrical conductivity models based on the salt mass fraction from groundwater model simulations .    in this study",
    "we refer to groundwater data as solute mass fraction data , @xmath3 , even though in the field applications it is more common to record the fluid conductivity @xmath92 of gw samples , and only later by using a linear relationship to transform it to an actual solute mass fraction .",
    "however , this linear relationship is different from the general petrophysical relationship , having a different error and lower uncertainty .",
    "also , the groundwater model is defined for solute mass fraction , and this way it is easier to distinguish in the following context the groundwater and geophysical origin of data .",
    "assume now that we have obtained dc resistivity and groundwater well samples data at a single time , that is we have @xmath99 where @xmath78 and @xmath61 are projection matrices that project the electrical potential field , @xmath77 , and the solute fraction field , @xmath54 onto their measurement locations , respectively .",
    "let @xmath100 and @xmath101 be vectors with the errors associated with each measurement , which are assumed to be gaussian , independent and identically distributed with covariance matrices @xmath102 and @xmath103 .",
    "the @xmath54 represents the solute fraction at the end of simulation , i.e. at the same time as the geophysical data were collected .",
    "the goal is to jointly invert the different data in order to better recover the flow path and in particular , to better predict the flow .",
    "clearly , the electric data is affected mainly by the electrical conductivity of the porous media in swi and the groundwater data is affected by the initial solute distribution , @xmath104 , the porosity , @xmath4 , the dispersion , @xmath18 , the permeability @xmath11 and the fluid viscosity , @xmath12 . if all gw model parameters are unknown , then the indirect data or scarce direct data will not suffice to accurately estimate them .",
    "well studied aquifers are typically observed for many years and therefore , for now we assume that all parameters , other than solute fraction , are at least approximately known . for example some of these parameters could be estimated by first solving the gw inverse problem using pressure or hydraulic head data , which are not considered in the coupled problem here .",
    "thus we write @xmath105 and solve for the initial conditions only , and to also recover the current solute fraction distribution .",
    "we now develop a procedure to estimate the electrical conductivity @xmath75 and the initial solute fraction distribution @xmath52 by the regularized maximum likelihood estimate @xcite .",
    "this leads to the following constrained optimization problem @xmath106    here @xmath107 is a regularization operator ( to be discussed next ) and @xmath108 and @xmath109 are regularization parameters .",
    "the constraint represents archie s law and is obtained from equation by lumping a few parameters into @xmath110 , and @xmath111 being the background soil bulk conductivity , which is equal to @xmath112 and corresponds to to the conductivity for porous media with freshwater only .",
    "a number of different approaches may be taken to solve this constrained optimization problem outlined in equation .",
    "one possibility is to eliminate @xmath75 and to work with @xmath52 alone .",
    "the objective function ( where we omit the extra regularization on @xmath75 ) is then @xmath113 this approach has the advantage of solving a smaller problem , however , it complicates other aspects of the inversion .",
    "first , we are required to choose two regularization parameters , @xmath114 and @xmath115 for the different data misfits with respect to the regularization term at each iteration . despite abundant research on choosing one regularization parameter , there are almost no criteria for setting two parameters during the iterative minimization process where each data misfit has a different speed of convergence .",
    "a more detailed discussion can be found in @xcite where the authors used magnetotelluric data together with controlled source em data . even though both data sets can be modeled by changes in conductivity ,",
    "non - trivial weighting was needed in order to jointly invert them .",
    "second , the multiplication of jacobians and data misfit calculations can have very different computational cost for each data misfit , which can make each iteration very unbalanced and does not favor parallelization .",
    "finally , if the relationship between @xmath75 and @xmath52 are inexact , forcing them may lead to inversion artifacts .",
    "therefore , we opt to use the alternating direction method of multipliers ( admm ) to minimize this coupled objective function .",
    "the main advantage of admm is that the gw and geophysical parts can be solved separately , that is , we do not need to weight the two different data misfits in one objective function , but instead we split the minimization into two subproblems .",
    "this enables using existing inversion methodologies and even software packages only with minor changes .",
    "it also takes into advantage of the existing parallelization for a single problem and therefore substantially increase the efficiency when solving large scale problems .",
    "following the admm approach , the augmented lagrangian for is @xmath116 here @xmath117 is a lagrange multiplier and @xmath2 is a parameter that can be chosen somewhat arbitrarily .",
    "the @xmath118 iteration of admm is summarized in algorithm  [ alg1 ] .",
    "@xmath119 approximately minimize the augmented lagrangian with respect to @xmath75 . @xmath119",
    "approximately minimize the augmented lagrangian with respect to @xmath52 .",
    "@xmath119 update the lagrange multiplier @xmath120 .",
    "we now discuss the solution of each subproblem and show that by using small modifications to existing inversion codes , the admm iteration can be carried out efficiently .",
    "+      at each step of minimizing the augmented lagrangian with respect to @xmath75 , we approximately solve : @xmath121 the objective function consists of a data misfit and a regularization part , as in usual inverse problems , and coupling terms involving also @xmath54 , the groundwater variable .",
    "we can proceed using the gauss - newton method to minimize with respect to @xmath75 .",
    "compared to a standard inverse problem , we need to know also the derivatives of the coupling terms with respect to @xmath75 , however , these are , in this case , straightforward since @xmath54 is fixed .    here",
    ", we consider a quadratic regularization of the form @xmath122 where @xmath123 is the gradient operator and @xmath124 can be either set to the background conductivity reference model , or derived using archie s law from the last estimate via the groundwater descent step . if we set @xmath125 and assume for simplicity that @xmath126 , the derivative @xmath127 is @xmath128 and the search direction at each time step is : @xmath129 the model is then updated by a `` soft '' armijo line search @xcite , @xmath130 , where the parameter @xmath12 is adjusted to ensure sufficient decrease of @xmath131 , where @xmath11 refers to @xmath118 iteration of the geophysical descent .",
    "we take a small fixed number of gauss - newton steps ( see the numerical experiment section ) , and as has been already mentioned , rather than searching directly for the electrical conductivity @xmath132 , we search for a log of conductivity @xmath133 .",
    "similarly , the objective function for the augmented lagrangian with respect to @xmath134 , the initial solute mass fraction , can be written as : @xmath135 now the geophysical variable @xmath75 is fixed and the derivatives of the coupling terms with respect to @xmath52 involve the sensitivity @xmath136 , as discussed in section  [ gw - sens ] .    assuming a quadratic regularization for @xmath52 of the form @xmath137 with @xmath138 being a reference solute fraction model ( an initial guess or estimate from the previous step ) , the gradient of @xmath139 is then @xmath140 where @xmath141 represents the petrophysical constraint ( equation ) .",
    "the groundwater model minimization follows the same gauss - newton approach as has been described above for geophysical imaging .",
    "the admm algorithm is stopped when the norm of the residual @xmath142 , i.e. the constraint given by the petrophysical relationship @xmath143 , is sufficiently small or the changes in @xmath144 between the last few iterations are bellow some threshold value . at this point , we have the capability of fitting both the geophysical and groundwater data such that the electrical conductivity and solute fraction agree .",
    "it has been shown that admm has a linear rate of convergence , where for some applications the desired precision can be reached in a relatively small amount of steps / descents @xcite .",
    "the penalty term @xmath2 has an effect on the speed of convergence @xcite , however it has been shown that under mild conditions any positive value of @xmath2 will lead to convergence @xcite , both in terms of the residual @xmath145 and finding an optimal solution for both models . in our study",
    "we set up @xmath2 by a trial and error procedure , where @xmath146 $ ] provided similar results . in some cases",
    "better rate of convergence can be achieved by so called over - relaxed admm , or by adding a scaling parameter for the lagrangian multiplier , the work of @xcite provides actual rate bounds based on the parameter choices .",
    "first , we tested our gw model on the henry problem @xcite , which is a classical benchmark problem for the vdf in 2d representing a simplified seawater intrusion case .",
    "we used the dimensionless parameters @xmath147 and @xmath148 , as in @xcite , and obtained similar results as in their study for a diffusive case of the henry problem , i.e. when only molecular diffusion is consider with a fixed value for @xmath18 and transverse and longitudinal dispersivities being zero ( see in figure [ henry comparison ] ) .    [",
    "cols=\"^,^ \" , ]          in order to test our method for the case where the reservoir parameters are not known exactly or only approximately , we solve the problem for an inaccurate permeability field and dispersion . in the first test",
    ", we used the original gw model parameters , but decreased the homogeneous permeability field and dispersion to @xmath149 when running the admm and coupled approach .",
    "the admm joint approach converged , but the actual errors were higher then when the correct gw parameters are used . in figure [ kdis70 ]",
    "you can see the error evolutions for both the admm with correct and incorrect gw parameters , also the error @xmath150 from the coupled approach ( a single value ) , table [ tab - errors - wronggw ] provides the summary of errors for both methods .    in the second test",
    ", we used the homogeneous case 1 and altered the permeability field by adding a 3d random gaussian field to the original ( see in figure [ kdev3 ] ) .",
    "the addition of the gaussian random field thus changed the original anisotropic homogenous permeability field to a heterogenous field , which then generates a differing solute distribution .",
    "the ratio of change in the observed solute fraction data due to different permeability compared to original data was 18@xmath151 .",
    "gw data based on this simulation where used in admm inversion , but leaving the permeability field homogeneous as in the previous calculations for case 1 .",
    "the scaled errors and residual @xmath142 are plotted in figure [ kdev ] . for comparison",
    "we again ran the coupled approach with the same input as used in admm .",
    "+         +    c|cccc test 1 & @xmath152 & @xmath153 & @xmath154 & @xmath155 + initially & 12.2 & 20.7 & 63 & 1150 + coupled & 7.35 & 16.2 & 3.64 & 2.18 + admm & 3.85 & 10.4 & 2.04 & 1.57 +   + test 1 @xmath156 @xmath18 & & & & + initially & 17 & 22.6 & 17.2 & 1140 + coupled & 6.92 & 13.1 & 4.0 & 1.95 + admm & 4.32 & 9.26 & 1.7 & 1.48 +",
    "based on the results of the numerical examples in section 5 , the admm approach and coupled approach proved to be advantageous compared with simple coupled aproach or separate groundwater and geophysical inversions .",
    "the splitting of the minimization procedure into the augmented lagrangians resulted into separation of the gw and geophysical model .",
    "this separation is advantageous as the two different data mistfits do not need to be weighted in one objective function , and we can still proceed with joint minimization , which is a huge advantage . moreover , if different geophysical survey was applied , the same admm method can still be applied with small adjustments to the current codes .    to minimize each subproblem by gauss - newton method",
    ", we avoided using perturbation methods to calculate the sensitivities , as it is usually the case in other studies .",
    "instead , we opted for deriving these sensitivities analytically in our codes to speed up the minimization .",
    "the calculation of exact sensitivities based on discretized equations allows us to work on large scale problems , avoiding expensive finite difference sensitivity calculations and jacobian storage .",
    "therefore , we could perform all calculations on a standard laptop in a time scale of minutes to hours .",
    "the admm comes at a higher computation cost compared to a simple coupled approach .",
    "the additional cost is due to the repeated computation of the gw and geophysical descent , for four or five times . for comparison , using the simple coupled approach for the case 1 , we ran the forward gw model 10 times , while the admm required 57 forward model runs . similarly the dc forward model required 7 runs , as opposed to 32 runs for the coupled admm approach .    the run time for the admm inversion was approximately 110 minutes for admm where we estimated the relative weights",
    "in contrast , a single coupled inversion required 27 minutes on a standard laptop ( intel(r ) core(tm)i7 - 2860 qm processor and 16 gb ram ) .    for comparison , when the relative weighting and regularization parameters are unknown , the admm method can be faster than for example the coupled gauss - newton optimization ( substituting for @xmath104 ) , which needs to be solved a number of times as well for different regularization parameters , however , unlike admm , where each iteration consists of solving a single physical model , the fully coupled gauss - newton method requires solving both problems for each weighting and regularization parameters .",
    "note also that 3d inversions are well known to be computationally intensive , where stochastic approaches , or minimization codes with the sensitivities calculated using perturbation methods , can require time frame of weeks @xcite .",
    "in contrast , our approach of computing the sensitivities allows us to solve 3d problems in minutes .",
    "the joint inversion with admm achieved a lower error for both the initial and final solute fraction distributions in all tested examples compared to simple coupled approach . in the example presented above in detail in section [ res_example ]",
    "the error for @xmath157 estimate by admm was roughly @xmath158 of the error by a coupled approach in homogeneous case , and @xmath159 for the heterogeneous case .",
    "for the initial solute fraction @xmath104 the improvement by admm was @xmath159 and @xmath160 respectively .",
    "the estimates for the final solute distribution were generally better than for the initial solute mass fraction due to the fact that the dc data were collected at this time , and also the coupling constraint between @xmath161 , solute fraction , and @xmath162 , electrical conductivity was enforced for the final time @xmath163 . in all cases the admm converged to minimum , though it shows some of its typical aspects : a relatively quick drop during the first few iterations and a slow decrease towards the end .",
    "however , for the case of groundwater modeling applications , the initial decrease in error might be sufficient .",
    "our synthetic study confirmed the theoretical results about the convergence of this method .",
    "the goodness of estimates with low errors is largely determined by the quality and amount of data available , which play a key role in success of solving any inverse problem .",
    "it is apparent from figure [ all_errors1 ] that different data sampling locations result in differing final model errors , even though the admm method followed the same pattern of error decrease . due to the inverse problem setup , where the other gw model parameters and boundary conditions are known , increasing the amount of gw data led to little improvement of the admm approach compared to the coupled approach .",
    "in contrast if the amount of gw data samples was reduced , the admm method was still able to give reasonable estimates with lower errors .",
    "the experimental design and locations of gw samples are crucial when solving the inverse problem .",
    "for example , if some of the intruding seawater wedges are not captured by gw wells , the success of the joint approach is entirely dependent on the geophysical data .",
    "the uncertainty and credibility of both groundwater and geophysical data also implies there is uncertainty in the derived estimates of the hydrological states , which will remain regardless of the method applied to solve the inverse problem .",
    "the coupled approach has the advantage of revealing possible discrepancies between the two sources of information",
    ".    for the first set of simulations with case 1 and case 2 we assumed the gw model parameters were known , excluding initial and actual solute content .",
    "this can be regarded as an overly simplifying approach , but is justified for testing the feasibility of the joint inversion strategy . to demonstrate the robustness of the admm method with respect to variations in gw parameter values , we altered the gw model parameters in the inversion process .",
    "as expected , this led to estimates with higher error compared to solving the problem with the correct parameters .",
    "nevertheless , the admm converged to estimates with lower error than the simple coupled approach ( see in figure [ kdis70 ] ) , as it could be partially `` corrected '' by information from geophysical data .",
    "we are aware that further increasing of the error in the gw model parametrization would also lead to worse estimates , but in that case any coupled approach will not be able to provide a more accurate estimates .",
    "the admm method can only be applied to constrained optimization problems . for the hydrogeophysical applications",
    "this implies that the petrophysical relationship constraint should have a low uncertainty as it is `` enforced '' during the minimization .",
    "therefore , in environments where we expect varying electrical conductivity of geological material it would not be a recommended approach .",
    "if we still want to follow the methods described above , the coupling term based on the petrophysical relationship would stay as a part of the objective function , but not as a constraint , and a block coordinate descent method could be used for minimization .",
    "however , the sensitivities derived for admm approach would not change . an alternate option would be to use similarity measures based on gradient fields supporting a similar structure of two different models , without forcing a perfect matching relationship",
    ". some of the proposed methods will be subject of future research .",
    "in this paper we have developed a hydrogeophysical inversion framework which improves estimates of hydrological states by jointly inverting both sources of data . to alleviate computational costs in the inverse problem ,",
    "sensitivities were analytically derived as opposed to using perturbation methods . an alternating direction method of multipliers was applied to keep the codes for each inverse subproblem relatively separate , with only a few changes necessary to proceed with a joint inversion . the admm approach presented here enabled us to invert both the geophysical and groundwater data at once .",
    "based on the synthetic cases tested , the new approach improves the estimates of the initial and current solute content when compared with a simple coupled or direct substitution approach .",
    "moreover , the results from the synthetic experiments suggest that even if the gw parameters used in the inversion deviate from the true parameter set , the admm still manages to converge while improving the estimates of solute fraction for both the initial and final time .",
    "not surprisingly , the efficiency and gain of the admm joint inversion compared to inverting gw data alone is dependent on the quality of both data sets .",
    "antonellini , m. , mollema , p. , giambastiani , b. , bishop , k. , caruso , l. , minchio , a. , gabbianelli , g. et al . :",
    "salt water intrusion in the coastal aquifer of the southern po plain , italy .",
    "hydrogeology journal .",
    "16 ( 8) , 1541 - 1556 ( 2008 )        bauer - gottwein , p. , gondwe , b. n. , christiansen , l. , herckenrath , d. , kgotlhang , l. , zimmermann , s. : hydrogeophysical exploration of three - dimensional salinity anomalies with the time - domain electromagnetic method ( tdem ) .",
    "journal of hydrology .",
    "380 ( 3 - 4 ) ( 2010 )      beaujean , j. , nguyen , f. , kemna , a. , antonsson , a. , engesgaard , p. : calibration of seawater intrusion models : inverse parameter estimation using surface electrical resistivity tomography and borehole data",
    ". water resources research .",
    "50 ( 8) , 6828 - 6849 ( 2014 )      boyd , s. , parikh , n. , chu , e. , peleato , b. , eckstein , j. : distributed optimization and statistical learning via the alternating direction method of multipliers .",
    "foundations and trends in machine learning , 3(1 ) , 1 - 122 ( 2011 )    cardona , a. , carrillo - rivera , j. j. , huizar - alvarez , r. , graniel - castro , e. : salinization in coastal aquifers of arid zones : an example from santo domingo , baja california sur , mexico . environmental geology .",
    "45 ( 3 ) , 350 - 366 ( 2004 ) .",
    "commer , m. , kowalsky , m. b. , doetsch , j. , newman , g. a. , finsterle , s. : mpitough2 : a parallel parameter estimation framework for hydrological and hydrogeophysical applications .",
    "computers @xmath164 geosciences , 65 , 127 - 135 ( 2014 )        kolditz , o. , ratke , r. , diersch , h. j. g. , zielke , w. : coupled groundwater flow and transport : 1 .",
    "verification of variable density flow and transport models .",
    "advances in water resources .",
    "21 ( 1 ) , 27 -46 ( 1998 )    dafflon , b. , barrash , w. , cardiff , m. , johnson , t. c. : hydrological parameter estimations from a conservative tracer test with variable - density effects at the boise hydrogeophysical research site .",
    "water resources research .",
    "47 ( 12 ) ( 2011 )      doherty , j. e. , hunt , r. j. , tonkin , m. j. : approaches to highly parameterized inversion : a guide to using pest for model - parameter and predictive - uncertainty analysis .",
    "us department of the interior , us geological survey .",
    "( 2011 )        farquharson , c. g. , oldenburg , d. w. : a comparison of automatic techniques for estimating the regularization parameter in non - linear inverse problems .",
    "geophysical journal international .",
    "156 ( 3 ) , 411 - 425 ( 2004 )    fitterman , d. w. : mapping saltwater intrusion in the biscayne aquifer , miami - dade county , florida using transient electromagnetic sounding .",
    "journal of environmental and engineering geophysics .",
    "19 ( 1 ) , 33 - 43 ( 2014 )        ghadimi , e. , teixeira , a. , shames , i. , johansson , m. : optimal parameter selection for the alternating direction method of multipliers ( admm ) : quadratic problems . automatic control , ieee transactions on .",
    "60(3 ) , 644 - 658 ( 2015 )                  herckenrath , d. , fiandaca , g. , auken , e. , bauer - gottwein , p. : sequential and joint hydrogeophysical inversion using a field - scale groundwater model with ert and tdem data . hydrology and earth system sciences , discussions .",
    "17 ( 10 ) , 4043 - 4060 ( 2013 )    hermans , t. , vandenbohede , a. , lebbe , l. , martin , r. , kemna , a. , beaujean , j. , nguyen , f. : imaging artificial salt water infiltration using electrical resistivity tomography constrained by geostatistical data .",
    "journal of hydrology.438 , 168 - 180 ( 2012 )    hinnell , a. c. , ferr , t. p. a. , vrugt , j. a. , huisman , j. a. , moysey , s. , rings , j. , kowalsky , m. b. : improved extraction of hydrologic information from geophysical data through coupled hydrogeophysical inversion .",
    "water resources research .",
    "46 ( 4 ) ( 2010 )          jardani , a. , revil , a. , dupont , j. p. : stochastic joint inversion of hydrogeophysical data for salt tracer test monitoring and hydraulic conductivity imaging .",
    "advances in water resources .",
    "52 , 62 - 77 ( 2013 )          kowalsky , m. b. , gasperikova , e. , finsterle , s. , watson , d. , baker , g. , hubbard , s. s. : coupled modeling of hydrogeochemical and electrical resistivity data for exploring the impact of recharge on subsurface contamination .",
    "water resources research .",
    "47(2 ) ( 2011 )      langevin , c.d . ,",
    "thorne , d.a .",
    ", guo , w. : seawat version4 ; a computer based program for simulation of multispecies solute and heat transport .",
    "techniques and methods book 6 , chapter a22 , virginia ( 2008 )      de louw , p. g. , eeman , s. , siemon , b. , voortman , b. r. , gunnink , j. , van baaren , e. s. , oude essink , g. h. p. : shallow rainwater lenses in deltaic areas with saline seepage .",
    "hydrology and earth system sciences .",
    "15 ( 12 ) , 3659 - 3678 ( 2011 ) .",
    "monego , m. , cassiani , g. , deiana , r. , putti , m. , passadore , g. , altissimo , l. : a tracer test in a shallow heterogeneous aquifer monitored via time - lapse surface electrical resistivity tomography .",
    "geophysics.75 ( 4 ) , wa61-wa73 ( 2010 )      nenna , v. , herckenrath , d. , knight , r. , odlum , n. , mcphee , d. : application and evaluation of electromagnetic methods for imaging saltwater intrusion in coastal aquifers : seaside groundwater basin , california .",
    "78 ( 2 ) , 77 - 88 ( 2013 )    nguyen , f. , kemna , a. , antonsson , a. , engesgaard , p. , kuras , o. , ogilvy , r. , pulido - bosch , a. : characterization of seawater intrusion using 2d electrical imaging .",
    "near surface geophysics .",
    "7 ( 5 - 6 ) , 377 - 390 ( 2009 )        poeter , e. p. , hill , m. c. , banta , e. r. , mehl , s. , christensen , s. : ucode 2005 and six other computer codes for universal sensitivity analysis , calibration , and uncertainty evaluation : us geological survey techniques and methods 6-a11 . us geological survey .",
    "( 2005 )            douglas , j. , russel , f. : numerical methods for convection - dominated diffusion problems based on combining the method of characteristics with finite element or finite difference procedures .",
    "journal on numerical analysis , 19 ( 5 ) , 871 - 885 ( 1982 )            trabelsi , f. , mammou , a. b. , tarhouni , j. , piga , c. , ranieri , g. : delineation of saltwater intrusion zones using the time domain electromagnetic method : the nabeul  hammamet coastal aquifer case study ( ne tunisia ) .",
    "hydrological processes.27 ( 14 ) , p.2004 - 2020 ( 2013 )        wohlberg , b. , tartakovsky , d. m. , dentz , m. : linearized functional minimization for inverse modeling .",
    "xix internation conference on water resources .",
    "los alamos national laboratory ( united states ) .",
    "funding organisation : doe / lanl ( united states ) ( 2012 )    younes , a. , ackerer , p. , lehmann , f. : a new efficient eulerian  lagrangian localized adjoint method for solving the advection",
    " dispersion equation on unstructured meshes .",
    "advances in water resources .",
    "29 ( 7 ) , 1056 - 1074 ( 2006 )"
  ],
  "abstract_text": [
    "<S> seawater intrusion ( swi ) is a complex process , where 3d modeling is often necessary in order to monitor and manage the affected aquifers . here , we present a synthetic study to test a joint hydrogeophysical inversion approach aimed at solving the inverse problem of estimating initial and current saltwater distribution . </S>",
    "<S> first , we use a 3d groundwater model for variable density flow based on discretized flow and solute mass balance equations . </S>",
    "<S> in addition to the groundwater model , a 3d geophysical model was developed for direct current resistivity imaging and inversion . </S>",
    "<S> the objective function of the coupled problem consists of data misfit and regularization terms as well as a coupling term that relates groundwater and geophysical states . </S>",
    "<S> we present a novel approach to solve the inverse problem using an alternating direction method of multipliers ( admm ) to minimize this coupled objective function . </S>",
    "<S> the sensitivities are derived analytically for the discretized system of equations , which allows us to efficiently compute the gradients in the minimization procedure and reduce the computational complexity of the problem . </S>",
    "<S> the method was tested on different synthetic scenarios with groundwater and geophysical data represented by solute mass fraction data and direct current resistivity data . with the admm approach </S>",
    "<S> , we were able to obtain better estimates for the solute distribution , compared to just considering each data set separately or solving with a simple coupled approach .    </S>",
    "<S> example.eps gsave newpath 20 20 moveto 20 220 lineto 220 220 lineto 220 20 lineto closepath 2 setlinewidth gsave .4 setgray fill grestore stroke grestore </S>"
  ]
}