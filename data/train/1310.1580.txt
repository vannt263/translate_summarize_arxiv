{
  "article_text": [
    "we continue the study of semistable extremal neighborhoods pioneered by mori , kollr , and prokhorov @xcite . our motivation is to compute explicitly stable one - parameter degenerations of smooth canonically polarized surfaces and to describe their moduli space introduced by kollr and shepherd - barron @xcite .",
    "we work throughout over @xmath3 .",
    "extremal neighborhoods are fundamental building blocks of the minimal model program approach to @xmath0-dimensional birational geometry @xcite . the goal of this program is to construct a canonical representative in the birational class of a smooth ( or mildly singular ) proper @xmath0-fold by gradually forcing the canonical divisor to intersect curves non - negatively . on each step of the program",
    ", one has to analyze the local picture of a @xmath0-fold around a curve which has negative intersection with the canonical divisor .",
    "concretely , let @xmath4 be the germ of a @xmath0-fold along a proper reduced irreducible is allowed to be reducible , however we can always reduce to the irreducible case by factoring @xmath5 locally analytically over @xmath6 , see @xcite .",
    "] curve @xmath7 such that @xmath4 has terminal singularities .",
    "we say @xmath4 is an _ extremal neighborhood _ if there is a germ @xmath6 of a @xmath0-fold and a proper birational morphism @xmath8 such that @xmath9 , @xmath10 ( as sets ) and @xmath11 .",
    "then @xmath12 .",
    "the exceptional locus ( the union of positive - dimensional fibers ) of @xmath5 is either equal to @xmath7 or is a divisor with image a curve passing through  @xmath13 .",
    "we say @xmath5 is a _ flipping contraction _ in the first case and a _ divisorial contraction _ in the second .",
    "if @xmath5 is a divisorial contraction then @xmath6 is a terminal singularity ( * ? ? ?",
    "* th 1.10 ) .",
    "if one is running the minimal model program , @xmath14  will ( locally ) give its next step .",
    "if @xmath5 is a flipping contraction then one has to construct the flip .",
    "the _ flip _ of @xmath5 is a germ @xmath15 of a @xmath0-fold along a proper reduced curve @xmath16 such that @xmath15 has terminal singularities , and a proper birational morphism @xmath17 such that @xmath18 , @xmath19 ( as sets ) , and @xmath20 .",
    "the existence of the flip was proved by mori ( * ? ? ?",
    "0.4.1 ) and uniqueness follows from @xmath21 cf .",
    "6.4 ) .    to classify extremal neighborhoods , following miles reid , we choose a general member @xmath22 .",
    "let @xmath23 .",
    "then @xmath24 and @xmath25 are normal surfaces with at worst du val singularities ( * ? ? ?",
    "we say the extremal neighborhood @xmath26 is _ semistable _ if @xmath27 is a du val singularity of type @xmath28 @xcite .",
    "semistable extremal neighborhoods are of two types @xmath2 and @xmath1 .",
    "we  say @xmath5 is of type @xmath2 or @xmath1 if the number of singular points of @xmath24 equals one or two respectively ( * ? ? ?",
    "* , p.542 ) . in the case of a flipping contraction , @xmath5 is semistable iff the general hyperplane section through @xmath6 is a cyclic quotient singularity @xmath29 ( @xcite , corollary  3.4 and appendix ) , i.e. , is ( locally analytically ) isomorphic to the quotient of @xmath30 by @xmath31 acting by @xmath32 , where @xmath33 is a primitive root of unity .",
    "we are primarily interested in semistable neighborhoods due to applications to compact moduli spaces of surfaces .",
    "let @xmath34 be a general element .",
    "consider the corresponding morphism @xmath35 and the induced morphism @xmath36 .",
    "write @xmath37 thus we can view an extremal neighborhood as a total space of a flat family of surfaces .",
    "let @xmath38 , @xmath39 , denote a nearby smooth fiber .",
    "in this paper we assume that the second betti number @xmath40 our motivation for this assumption is as follows .",
    "let @xmath41 be gieseker s moduli space of canonical surfaces of general type with given numerical invariants @xmath42 and @xmath43 .",
    "let @xmath44 be its compactification , the moduli space of stable surfaces of kollr , shepherd - barron , and alexeev . given a map @xmath45 from a punctured smooth curve germ , i.e.   a family @xmath46 of canonical surfaces , one is interested in computing its `` stable limit '' @xmath47 , perhaps after a finite base change .",
    "in many important cases the family @xmath46 can be compactified by a flat family @xmath48 , where the special fiber @xmath49 is irreducible , normal , and has quotient singularities .",
    "computing the stable limit then amounts to running the relative minimal model program for @xmath48 .",
    "it turns out that we can always reduce to the case of flips and divisorial contractions of type @xmath2 and @xmath1 with @xmath50 ( in an analytic neighborhood of a contracted curve ) after a finite surjective base change by passing to a small partial resolution using simultaneous resolution of du val singularities ( see e.g. ( * ? ? ?",
    "* th .  4.28 ) and @xcite ) .",
    "see section [ s4 ] for more details .    building on @xcite , we show in section [ s1 ] that if @xmath4 is an extremal neighborhood of type @xmath2 ( resp .",
    "@xmath1 ) with @xmath50 then @xmath49 is normal and has one ( resp .",
    "two ) cyclic quotient singularities along @xmath7 of the following special form @xmath51 for some @xmath52 , @xmath53 , a so - called _",
    "wahl singularity_.    in @xcite mori gave an explicit algorithm for computing flips of extremal neighborhoods of type @xmath1 .",
    "we extend his result to neighborhoods of type @xmath2 .",
    "the novelty of our approach is that instead of considering extremal neighborhoods one - by - one , we construct their universal family ( see section  [ s2 ] ) , and in particular show that @xmath2 neighborhoods belong to the same deformation family as @xmath1 ( see proposition [ k1adegeneratestok2a ] , whose proof in given at the end of  [ k1atok2a ] ) .    for any extremal neighborhood of type @xmath2 or @xmath1 with @xmath50 , in section  [ s2 ]",
    "we define a four - tuple of integers @xmath54 and the following data which depends only on this four - tuple :    a positive integer @xmath55 , a toric surface @xmath56 and a toric birational morphism @xmath57 which depend only on @xmath55 ( @xmath56 is only locally of finite type for @xmath58 ) , flat irreducible families of surfaces @xmath59 and morphisms @xmath60 such that the following holds .",
    "let @xmath61 be an extremal neighborhood of type @xmath2 or @xmath1 with @xmath50 and with associated four - tuple @xmath54 .",
    "then there is a morphism @xmath62 such that @xmath63 and @xmath64 is the pull - back of @xmath65 under @xmath66 . in other words",
    ", @xmath67 is the universal family of extremal neigborhoods .",
    "if @xmath5 is a flipping contraction then the flip @xmath68 is the pullback of @xmath69 under @xmath70 .",
    "[ thmintro ]    we give an explicit combinatorial algorithm to compute all @xmath2 and @xmath1 corresponding to this family ( see propositions  [ k1ainvariants ] and [ k1adegeneratestok2a ] ) .",
    "the construction of the universal family , which is the content of section  [ s2 ] , follows very closely the division algorithm in @xcite , which one can interpret as a sequence of mutations in the cluster algebra of rank @xmath71 with general coefficients ( see remark  [ cluster ] ) .    if @xmath72 the morphism @xmath73 is the blowup of @xmath74 . if @xmath75 , @xmath56 is the toric variety associated to the fan @xmath76 with support @xmath77 where @xmath78 .",
    "it has rays spanned by @xmath79 for @xmath80 given by @xmath81 , @xmath82 , @xmath83 for @xmath84 , and @xmath85 , @xmath86 , @xmath87 for @xmath84 . over torus orbits of dimension @xmath88 ( resp .",
    "@xmath89 ) corresponding to rays of @xmath76 ( resp .",
    "@xmath71-dimensional cones ) , fibers of @xmath90 are surfaces with one ( resp .",
    "two ) wahl singularities .    in the flipping case , the special fiber @xmath91 is a germ of a cyclic quotient singularity @xmath92 and the special fiber @xmath93 is its _ extremal p - resolution _ ,",
    "i.e. , a partial resolution @xmath94 such that @xmath95 has only wahl singularities @xmath96 for @xmath97 , the exceptional curve @xmath98 , and @xmath99 is relatively ample .",
    "let @xmath100 , and @xmath101 .",
    "the wahl singularities @xmath102 and @xmath103 are minimally resolved by chains of smooth rational curves @xmath104 and @xmath105 respectively , such that @xmath106 , @xmath107 , @xmath108 , @xmath109 , and @xmath110 .",
    "let @xmath111 be a surface germ around a @xmath98 such that @xmath95 has these two wahl singularities , @xmath16 passes through both of them , and in the minimal resolution of @xmath95 , the proper transform of @xmath16 is a @xmath112-curve which only intersects @xmath113 and @xmath114 , and transversally at one point . with this data",
    "we build a @xmath115 as theorem [ thmintro ] .",
    "we have @xmath116 . with this",
    "we construct the universal antiflip @xmath117 , where the central fiber of @xmath118 is a surface germ with one singularity @xmath119 , and the corresponding birational toric morphism @xmath120 defined by the morphism between fans shown in figure [ f0 ] .    in this figure ,",
    "the rays @xmath121 , @xmath122 with @xmath123 in the fan @xmath76 are decorated by the data @xmath124 of the associated @xmath2 antiflip , which has as central fiber a surface with one singularity @xmath125 .",
    "two consecutive @xmath126 or @xmath127 with @xmath128 represents a @xmath1 antiflip , which has two singularities , one from each of the @xmath2 of the rays .",
    "these @xmath2 s are recovered from the @xmath1 by @xmath129-gorenstein smoothing up one of the singularities while preserving the other .",
    "when @xmath130 tends to infinity , the rays @xmath131 and @xmath122 approach to two lines with irrational slopes @xmath132 and @xmath133 , where @xmath134 the rays @xmath135 and @xmath136 correspond to the wahl singularities @xmath103 and @xmath102 of @xmath95 respectively .",
    ".,width=453 ]    in section  [ s2 ] , following @xcite , we show that an extremal p - resolution of a cyclic quotient singularity gives a unique family @xmath137 of ( terminal ) antiflips .",
    "in addition we identify , in the versal deformation space of this cyclic quotient singularity @xmath95 , the locus of deformations such that the total space admits a terminal antiflip , see corollary  [ existenceofterminalantiflips ] .",
    "specifically , we show that a smoothing @xmath138 admits a terminal antiflip if and only if there is a divisor @xmath139 such that @xmath140 is the toric boundary of @xmath95 for some choice of toric structure and the axial multiplicities @xmath141 of the singularities of @xmath15 satisfy @xmath142 .",
    "this raises the following question , which we find very interesting :    classify smoothings of cyclic quotient singularities which admit an antiflip ( not necessarily terminal ) .",
    "see also remark  [ asflnsfgajf ] and example  [ asdvasfgafg ] of a canonical antiflip .    in  [ 2extremalnbhd ] we classify extremal p - resolutions .",
    "we show , by a combinatorial argument built on continued fractions representing zero @xcite ( see  [ contfracpresol ] ) , that any cyclic quotient singularity admits at most two extremal p - resolutions ( and thus at most two families of antiflips ) .",
    "moreover , we prove in  [ delta ] that these two families must have the same parameter @xmath55 , i.e. , they live over the same toric surface @xmath56 . at the end of  [ contfracpresol ] ,",
    "we give a list with the first cyclic quotient singularities ( up to order @xmath143 ) admitting one or two extremal p - resolutions .",
    "finally , in section  [ s4 ] , we give an application to moduli of stable surfaces , which was the original motivation for this paper .",
    "we start by constructing a stable surface which admits a @xmath144-gorenstein smoothing to a canonically polarized smooth surface with @xmath145 and @xmath146 , following ideas of lee and park @xcite .",
    "the surface @xmath49 has two wahl singularities @xmath147 and @xmath148 , and no local - to - global obstructions to deform ( i.e. deformations of its singularities globalize to deformations of @xmath49 ) .",
    "the kollr  shepherd - barron  alexeev moduli space of stable surfaces near @xmath49 is two - dimensional and has two boundary curves , which correspond to @xmath144-gorenstein deformations @xmath149 and @xmath150 which smoothen @xmath151 ( resp .",
    "@xmath152 ) and preserve the remaining singularity .",
    "we address the question of describing minimal models of @xmath153 and @xmath154 .",
    "namely , we consider deformations @xmath155 and @xmath156 of surfaces obtained by simultaneously resolving @xmath151 ( resp .",
    "@xmath152 ) and run our explicit mmp to find new limits @xmath157 of each family .",
    "this allows us to conclude that @xmath158 is a rational surface and @xmath159 is a dolgachev surface of type @xmath160 , i.e. , an elliptic fibration over @xmath161 with two multiple fibers of multiplicity @xmath71 and @xmath0 , respectively .",
    "more systematic study of the boundary of the moduli space of surfaces of geometric genus @xmath89 will appear elsewhere .",
    "paul hacking was supported by nsf grants dms-0968824 and dms-1201439 .",
    "jenia tevelev was supported by nsf grants dms-1001344 and dms-1303415 .",
    "giancarlo urza was supported by the fondecyt inicio grant 11110047 funded by the chilean government .",
    "we would like to thank i.  dolgachev , j.  kollr , s.  mori , and m.  reid for helpful discussions .",
    "in particular , m. reid explained to us in detail his joint work with g. brown which describes explicitly the graded ring of a @xmath1 flip @xcite .",
    "we recall that the minimal resolution of a cyclic quotient singularity of type @xmath29 has exceptional locus a nodal chain of smooth rational curves with self - intersection numbers @xmath162 where @xmath163= b_1 - \\frac{1}{b_2-\\frac{1}{\\ddots -\\frac{1}{b_r}}},\\quad b_i \\ge 2 \\mbox { for all $ i$}\\ ] ] is the expansion of @xmath164 as a hirzebruch ",
    "jung continued fraction .",
    "see @xcite , p.  46 .",
    "moreover , the minimal resolution can be described torically as follows .",
    "identify the singularity @xmath165 with the germ @xmath166 of the affine toric surface corresponding to the cone @xmath167 in the lattice @xmath168 define @xmath169 for @xmath170 by @xmath171 and @xmath172 \\mbox { for $ 2 \\le i \\le r$},\\ ] ] @xmath173 \\mbox { for $ 1 \\le i \\le r-1$}.\\ ] ] define @xmath174 then each @xmath131 is a primitive vector in the lattice @xmath175 .",
    "the minimal resolution @xmath176 is the toric proper birational morphism corresponding to the subdivision @xmath76 of the cone @xmath177 given by adding the rays @xmath178 generated by the @xmath131 for @xmath179 .",
    "let @xmath180 denote the exceptional curve corresponding to the ray @xmath181 .",
    "then @xmath180 is a smooth rational curve such that @xmath182 .",
    "define @xmath183 let @xmath184 denote the strict transform of @xmath185 .",
    "then the toric boundary of @xmath186 is the nodal chain of curves @xmath187 .",
    "moreover , we have @xmath188 and @xmath189 ( indeed , since @xmath180 corresponds to the primitive vector @xmath190 , the orders of vanishing of @xmath191 and @xmath192 along @xmath180 equal @xmath193 and @xmath194 respectively . )",
    "finally the discrepancies @xmath195 defined by @xmath196 are given by @xmath197 ( indeed , for any toric variety @xmath49 with boundary @xmath198 we have @xmath199 .",
    "thus in our case @xmath200 and @xmath201 . now the formula for the discrepancies follows from the formulas for the pullback of @xmath202 and @xmath203 above . )",
    "the wahl singularity is a cyclic quotient singularity of the form @xmath204 for some @xmath52 , @xmath53 .",
    "the number @xmath205 is the index of the singularity .",
    "we have an identification @xmath206 given by @xmath207 the deformation @xmath208 of @xmath165 is of the form @xmath209 for some @xmath210 and convergent power series @xmath211 , @xmath212 .",
    "it follows that we have an isomorphism of germs @xmath213 the number @xmath210 is called the _ axial multiplicity _ of @xmath214 ( * ? ? ?",
    "* def .  1a.5 , p.  140 ) .",
    "in particular , the @xmath0-fold germ @xmath4 is analytically @xmath144-factorial by @xcite .",
    "the following proposition is mostly a combination of results from @xcite and @xcite .",
    "[ b2=1=>normal ] let @xmath61 be an extremal neighborhood of type @xmath2 or @xmath1 .",
    "let @xmath215 be a general element and let @xmath216 be the corresponding morphism .",
    "let @xmath217 denote the special fiber and @xmath38 , @xmath218 , a nearby fiber .",
    "then @xmath50 iff @xmath49 is normal and has the following description .",
    "if @xmath5 is of type @xmath1 then @xmath49 has two singular points @xmath219 , @xmath97 . for each @xmath97",
    "there are numbers @xmath220 , @xmath221 , @xmath222 , and an isomorphism of germs @xmath223    if @xmath5 is of type @xmath2 then @xmath49 has one singular point @xmath224 .",
    "there are numbers @xmath225 , @xmath226 , and an isomorphism @xmath227 for some @xmath228 such that @xmath229    the proper birational morphism @xmath230 can be described as follows .",
    "if @xmath5 is of type @xmath1 then @xmath49 is normal and has two singular points @xmath219 , @xmath97 , of index greater than @xmath88 . for each @xmath97",
    "there are numbers @xmath231 , @xmath221 , @xmath222 , and an isomorphism of germs @xmath232 see ( * ? ? ?",
    "* rk .  2.3 ) .",
    "if @xmath5 is of type @xmath2 then @xmath49 is not necessarily normal .",
    "if @xmath49 is normal then @xmath49 has one singular point @xmath224 of index greater than @xmath88 and possibly an additional singular point @xmath233 of index @xmath88 .",
    "there are numbers @xmath234 , @xmath226 , @xmath235 and an isomorphism @xmath236 for some @xmath228 such that @xmath237 if @xmath238 then @xmath239 is the unique singular point .",
    "if @xmath240 we have an additional singular point @xmath241 and an isomorphism @xmath242 ( so in particular @xmath241 is a du val singularity of type @xmath243 . ) see ( * ? ?",
    "1.8.1 ) .",
    "if @xmath49 is normal then we have @xmath244 indeed , @xmath7 is irreducible by assumption , the link of a cyclic quotient singularity is a lens space , and the milnor fiber @xmath56 of a @xmath144-gorenstein smoothing of a singularity of type @xmath245 has milnor number @xmath246 . now the result follows from a mayer  vietoris argument .",
    "so @xmath50 iff @xmath247 as claimed .",
    "it remains to show that if @xmath49 is not normal then @xmath248 .",
    "we use the classification of the non - normal case given in @xcite , theorem  1.8.2 .",
    "let @xmath249 denote the normalization of @xmath49 and @xmath250 the inverse image of @xmath7 .",
    "then @xmath251 has two components @xmath252 meeting in a single point @xmath253 .",
    "we have an isomorphism @xmath254 for some @xmath255 .",
    "there are also points @xmath256 , @xmath257 and isomorphisms @xmath258 and @xmath259 for some @xmath260 . the non - normal surface @xmath49 is formed from @xmath261 by identifying the curves @xmath262 and @xmath263 .",
    "the points @xmath264 and @xmath265 are identified to a point @xmath266 and we have an isomorphism @xmath267 moreover the image @xmath268 of @xmath253 is a degenerate cusp singularity ( cf .",
    "* def .  4.20 ) ) and @xmath49 has normal crossing singularities along @xmath269 .",
    "let @xmath270 be the minimal resolution .",
    "since @xmath271 is a rational singularity ( by @xcite , corollary  3.4 ) , @xmath272 is a resolution of @xmath273 , and @xmath274 is a smoothing of @xmath273 , we have @xmath275 see @xcite , 4.1c .",
    "we remark that @xmath42 is well - defined in our situation ( see e.g. @xcite ) , and @xmath276 is the second betti number as usual .",
    "the morphism @xmath277 is a proper birational morphism of smooth surfaces , hence a composition of blowups , so @xmath278 also @xmath279 because @xmath216 is @xmath144-gorenstein , so we obtain @xmath280 we use this equation to show that @xmath248 if @xmath49 is non - normal .",
    "write @xmath281 for the strict transform of @xmath282 .",
    "the exceptional locus of @xmath283 is a disjoint union of @xmath0 chains of smooth rational curves @xmath284 , @xmath285 , and @xmath286 ( the exceptional loci over the singularities @xmath287 , @xmath288 , and @xmath253 ) such that the curves @xmath289 form a nodal chain .",
    "we have @xmath290 for some @xmath291 .",
    "write @xmath292 and @xmath293 . by lemma  [ torick^2 ]",
    "below , we have @xmath294 @xmath295 now since the cyclic quotient singularities @xmath287 and @xmath288 are conjugate , that is , of the form @xmath296 and @xmath297 for some @xmath298 , we have the identity @xmath299 ( proof : by induction using the following characterization of conjugate singularities .",
    "we identify a cyclic quotient singularity @xmath296 with the associated continued fraction @xmath300 $ ] , @xmath301 .",
    "then @xmath302,[2]$ ] is a conjugate pair , and if @xmath303 $ ] , @xmath304 $ ] is a conjugate pair , so is @xmath305 $ ] , @xmath306 $ ] . ) so we obtain @xmath307 thus @xmath308 we also compute @xmath309 @xmath310 @xmath311 where we have used the adjunction formula @xmath312 for @xmath313 . combining , we obtain @xmath314 by @xcite , theorem 1.8.2 , we have @xmath315 so @xmath316 now @xmath317 and @xmath318 , so combining we obtain @xmath319 now ( [ mpbound ] ) gives @xmath320 .",
    "the first formula of the following lemma is well - known , see e.g. @xcite .    [ torick^2 ]",
    "let @xmath165 be a cyclic quotient singularity of type @xmath29 .",
    "let @xmath176 be the minimal resolution of @xmath49 .",
    "write @xmath321 $ ] , @xmath322 for all @xmath130 .",
    "let @xmath323 denote the inverse of @xmath324 modulo @xmath325 .",
    "then @xmath326    let @xmath327 be a curve such that @xmath328 let @xmath329 be the strict transform of @xmath330",
    ". then @xmath331    write @xmath332 and let @xmath184 be the strict transform .",
    "let @xmath284 be the exceptional curves of @xmath90 , a nodal chain of smooth rational curves with self - intersection numbers @xmath162 , such that @xmath333 meets @xmath113 and @xmath334 meets @xmath335 .",
    "we have @xmath336 for some @xmath337 , @xmath338 .",
    "the exceptional curves @xmath113 and @xmath335 correspond to the rays in the fan @xmath76 of @xmath186 generated by @xmath29 and @xmath339 , so @xmath340 and @xmath341 .",
    "now we have @xmath342 @xmath343 where we have used the adjunction formula @xmath344 .    in the second case , we have @xmath345 where @xmath346 in particular , @xmath347 .",
    "so @xmath348 @xmath349      [ k1ainvariants ] let @xmath61 be an extremal neighborhood of type @xmath2 with @xmath50 as in proposition  [ b2=1=>normal ] , in particular @xmath350 for some @xmath228 such that @xmath229    let @xmath176 denote the minimal resolution of @xmath49 .",
    "thus the exceptional locus of @xmath90 is a nodal chain of smooth rational curves @xmath284 with self - intersection numbers @xmath351 , ... ,",
    "@xmath352 where @xmath353.\\ ] ] let @xmath354 denote the strict transform of @xmath7 .",
    "then @xmath355 is a @xmath112-curve which intersects a single component @xmath180 of the exceptional locus of @xmath90 transversely in one point .",
    "moreover , identifying @xmath356 with the germ of the affine toric variety given by the cone @xmath167 in the lattice @xmath357 the exceptional divisor @xmath180 is extracted by the toric proper birational morphism given by subdividing @xmath177 by the ray @xmath358    define @xmath359 , @xmath360 , @xmath361 for each @xmath362 , by @xmath363=m_0/(m_0-a_0)\\ ] ] if @xmath364 , @xmath365 if @xmath366 , and @xmath367=m_2/(m_2-a_2)\\ ] ] if @xmath368 , @xmath369 if @xmath370 .",
    "the surface germ @xmath371 is isomorphic to a cyclic quotient singularity of type @xmath92 , where @xmath372= \\delta/\\omega,\\ ] ] equivalently , @xmath373 we also have @xmath374 and @xmath375    the description of the minimal resolution together with the strict transform @xmath251 of @xmath7 is given by @xcite , theorem  1.8.1 .",
    "contracting @xmath251 , we obtain a resolution of @xmath376 with exceptional locus a chain of smooth rational curves with self - intersection numbers @xmath377 hence @xmath376 is a cyclic quotient singularity of type @xmath92 where @xmath378.\\ ] ] given @xmath379 with @xmath380 , @xmath381 , write @xmath163 , \\quad b_i \\ge 2 \\mbox { for all $ i$}\\ ] ] for the hirzebruch ",
    "jung continued fraction .",
    "define @xmath382 by @xmath383 the continued fraction corresponds to the factorization in @xmath384 @xmath385 see @xcite , proposition  2.1 . now , assuming @xmath386 , the equalities @xmath363=m_0/(m_0-a_0)\\ ] ] @xmath367=m_2/(m_2-a_2)\\ ] ] @xmath387=m_1 ^ 2/(m_1a_1 - 1)\\ ] ] give @xmath372=\\delta/\\omega,\\ ] ] where @xmath388 @xmath389 so @xmath390 and @xmath391 as claimed .",
    "the cases @xmath392 are proved similarly .    from the discussion in ",
    "[ toric ] , the discrepancy @xmath393 in the formula @xmath394 is given by @xmath395 now @xmath396 note that @xmath397 is cartier so @xmath398 is an integer .",
    "the matrix factorization @xmath399 @xmath400 implies that @xmath401 which gives @xmath402 and @xmath403 the equation implies that @xmath404 adding and gives @xmath405 finally , combining and gives .",
    "[ k1adegeneratestok2a ] let @xmath406 be as in proposition  [ k1ainvariants ] .",
    "we retain the notations @xmath407 and @xmath408 , @xmath409 .",
    "define proper birational morphisms @xmath410 for @xmath411 as follows .",
    "we identify @xmath371 with the germ of the affine toric variety given by the cone @xmath167 in the lattice @xmath412 define @xmath413 let @xmath414 be the toric proper birational morphism corresponding to the subdivision @xmath415 of @xmath177 given by the ray @xmath416 , and @xmath417 the exceptional curve of @xmath414 .",
    "let @xmath418 denote the torus fixed points corresponding to the maximal cones @xmath419 , @xmath420 of @xmath415 respectively .",
    "then @xmath421 has cyclic quotient singularities of types @xmath422    moreover , @xmath423    the one parameter deformation of @xmath424 given by the trivial deformation of the @xmath425 singularity and the versal @xmath144-gorenstein smoothing of the remaining singularity of @xmath421 ( with the target @xmath371 being fixed ) has general fiber isomorphic to the morphism @xmath406 .",
    "we postpone the proof until the end of ",
    "[ k1atok2a ] , since it is a consequence of the construction of the universal family .",
    "we follow @xcite closely .",
    "let @xmath426 be such that @xmath427 and @xmath222 for each @xmath97 , and    1 .",
    "@xmath428 , 2 .   @xmath429 .",
    "write @xmath430 @xmath431 define an action of @xmath432 on @xmath433 by @xmath434 @xmath435 define @xmath436 and @xmath437 write @xmath438 then @xmath439 is a open covering of @xmath440 and we have identifications @xmath441 for each @xmath97 . here",
    "the coordinates @xmath442 are the restrictions of the coordinates @xmath443 on @xmath433 to the @xmath444 cover of @xmath445 given by setting @xmath446 . similarly for @xmath447 .",
    "the glueing @xmath448 of @xmath445 and @xmath449 is given by @xmath450 ( the expression for @xmath451 in @xmath449 is determined by the equation of @xmath445 . )",
    "write @xmath452 and @xmath453 for each @xmath97",
    ". then @xmath454 is the point @xmath455 for each @xmath97 , and @xmath7 is a proper smooth rational curve in @xmath440 with local equations @xmath456 for each @xmath97 .",
    "write @xmath457 for each @xmath97 .",
    "the morphism @xmath458 is a flat family of surfaces ( flatness is clear in the charts @xmath445 and @xmath449 ) .",
    "write @xmath459 for the fiber over @xmath74 .",
    "then @xmath49 is a toric surface .",
    "write @xmath460 then @xmath461 and we have an identification @xmath462 given by @xmath463 the glueing @xmath464 is given by @xmath465    the surface @xmath49 is the toric variety associated to the fan @xmath76 in the lattice @xmath466 defined as follows .",
    "let @xmath467 be vectors in @xmath175 .",
    "let @xmath76 be the fan in @xmath175 with cones @xmath468 , @xmath469 , @xmath470 , @xmath471 , @xmath472 and @xmath473 .",
    "the ray @xmath181 corresponds to the divisor @xmath474 for each @xmath97 and the ray @xmath475 corresponds to the curve @xmath476",
    ".    let @xmath477 @xmath478 denote the usual orientation of @xmath479 . note that @xmath480 by assumption .",
    "so the support @xmath481 of the fan @xmath76 is the convex cone @xmath482 .",
    "let @xmath273 denote the affine toric surface associated to the cone @xmath177 in @xmath175 and let @xmath483 denote the torus fixed point .",
    "we compute @xmath484 where @xmath485 @xmath486 thus @xmath487 where @xmath488",
    "we have a toric proper birational morphism @xmath489 with exceptional locus the curve @xmath476 .",
    "let @xmath490 denote the cokernel of the homomorphism of abelian groups @xmath491 then @xmath492 and @xmath493    [ classgrouplemma ] the equality @xmath494 induces an identification @xmath495 such that @xmath496 \\mapsto \\bar{e}_i \\in m_{\\gamma}= { \\mathbb z}^2 / { \\mathbb z}(m_1,-m_2)\\ ] ] for each @xmath97 .    write @xmath497 then @xmath498 in particular @xmath499 is an irreducible divisor .",
    "we have @xmath500 where @xmath501 is an irreducible divisor for each @xmath97 .",
    "note that @xmath502 in particular @xmath503 and @xmath504 . now @xmath505 and @xmath506 for @xmath97 , so @xmath507 and @xmath508    write @xmath509 for the quotient map",
    ". we can define a group homomorphism @xmath510 \\mapsto \\chi\\ ] ] as follows .",
    "write @xmath511 some @xmath512 . then , for each @xmath513 , we have @xmath514 for some @xmath515 .    the action of the group @xmath432 on @xmath516 has finite stabilizers and is free in codimension @xmath88 .",
    "it follows that the homomorphism ( [ classgroupmap ] ) is an isomorphism with inverse @xmath517 where we regard @xmath518 as a one dimensional representation of @xmath432 and we identify @xmath519 \\in \\operatorname{cl}({\\mathbb x})$ ] with the isomorphism class of the rank one reflexive sheaf @xmath520 .",
    "the quotient map @xmath521 is identified with the spectrum of the ( relative ) cox ring @xmath522 where cox@xmath523 \\in \\operatorname{cl}({\\mathbb x } ) } { \\mathcal o}_{\\mathbb x}(d)$ ] , via @xmath524 strictly speaking , in order to define the cox ring we need to choose a representative @xmath525 of each class @xmath526 and compatible isomorphisms @xmath527 in our case we take representatives @xmath528 for @xmath529 a list of coset representatives for the quotient @xmath490 and isomorphisms derived from the isomorphism @xmath530      assume without loss of generality that @xmath531 .",
    "define a sequence @xmath532 as follows .",
    "define @xmath533 for @xmath84 , if @xmath534 is defined and @xmath535 , define @xmath536    [ termination ] there exists @xmath537 such that @xmath538 and @xmath539 .",
    "let @xmath540 be the number defined by lemma  [ termination ] .",
    "define @xmath541 and @xmath542    if @xmath543 then @xmath544 and we have @xmath545 @xmath546 in this case we define @xmath534 for @xmath547 by requiring @xmath548 for each @xmath547 . then @xmath549    if @xmath58 then we define @xmath534 for @xmath550 and @xmath551 by requiring that @xmath552    if @xmath58 then @xmath553 for @xmath554 .",
    "define a sequence @xmath555 as follows .",
    "@xmath556 if @xmath543 define @xmath557 and define @xmath558 for @xmath547 by requiring @xmath559 for each @xmath547 . if @xmath560 define @xmath558 for @xmath547 by requiring @xmath561    if @xmath562 then @xmath563 for all @xmath564 .",
    "we define a sequence @xmath565 for @xmath547 as follows .",
    "define @xmath566 \\in \\operatorname{cl}({\\mathbb x } ) , \\quad l_2=[s_1 ] \\in \\operatorname{cl}({\\mathbb x}).\\ ] ] define @xmath567 for @xmath568 by @xmath569 define @xmath570    if @xmath571 then @xmath544 and @xmath566 , \\quad l_2=[s_1 ] , \\quad l_3= l_2 - l_1 , \\quad l_4=-l_2 , \\quad l_5= l_1-l_2.\\ ] ] we define @xmath567 for @xmath547 by requiring @xmath572 for each @xmath547 .",
    "then @xmath573    if @xmath58 define @xmath567 for @xmath574 and @xmath551 by requiring that @xmath575    we define a sequence @xmath576 for @xmath547 .",
    "define @xmath577 we have @xmath576 for @xmath97 by the definitions , and for @xmath578 by the definition ( [ action ] ) of the @xmath432-action and lemma  [ classgrouplemma ] .",
    "note that the equations of @xmath433 can be rewritten @xmath579 @xmath580 define @xmath581 for @xmath582 by @xmath583 define @xmath584 by @xmath585 and @xmath586 by @xmath587    if @xmath571 then @xmath544 and one checks that @xmath588 .",
    "we define @xmath581 for all @xmath547 by requiring @xmath589 for all @xmath547 .",
    "if @xmath562 then we define @xmath581 for @xmath590 and @xmath551 by requiring @xmath591    we can rewrite the equations defining the @xmath581 as follows : @xmath592 where @xmath593 $ ] are defined as follows .",
    "if @xmath72 then @xmath594 @xmath595 and @xmath596 , @xmath597 for each @xmath547 . if @xmath598 then @xmath599 and @xmath600 note in particular that @xmath601 are coprime monomials in @xmath602 $ ] for each @xmath130",
    "moreover , we have @xmath603    in the terminology of @xcite the algebra @xmath604[\\{f_i \\ | \\",
    "i \\in { \\mathbb z}\\}]\\ ] ] is a _",
    "cluster algebra _ of rank @xmath71 , with clusters @xmath605 and coefficient group @xmath606 the group of monomials in @xmath607 . in the notation of @xcite , example  2.5 , p.  502",
    ", the exchange relations are given by @xmath608 and coefficients @xmath601 as defined above .",
    "in particular the case @xmath543 is a cluster algebra of finite type associated to the root system @xmath609 .",
    "[ cluster ]    for each @xmath547 we have @xmath576 .",
    "@xcite , theorems  3.10 , 3.12 , and 3.13 . )    from the definitions it is clear that @xmath581 is a rational section of @xmath567 for each @xmath547 .",
    "we must show that it is a regular global section , or , equivalently , @xmath610 .",
    "we say @xmath611 are _ coprime on @xmath440 _ if @xmath612 has codimension @xmath71 .",
    "define statements @xmath613 for @xmath547 as follows .",
    "* @xmath576 .",
    "* @xmath581 and @xmath614 are coprime on @xmath440 .",
    "* @xmath581 and @xmath615 are coprime on @xmath440 .",
    "the following implications are immediate from the equations @xmath616    1 .   for each @xmath547 ,",
    "@xmath617 2 .   for each @xmath618 , we have 1 .",
    "@xmath619 2 .",
    "@xmath620    indeed , for ( 1 ) we have @xmath621 similarly for @xmath622 . for ( 2a ) , we have @xmath623 using @xmath624 for @xmath625 .",
    "case ( 2b ) is similar .",
    "we show @xmath626 for each @xmath547 .",
    "we have @xmath627    also , let @xmath628 denote congruence modulo @xmath581 in @xmath629 , then @xmath630 @xmath631 @xmath632 @xmath633 so @xmath634 .",
    "now @xmath581 and @xmath635 are coprime on @xmath440 , so by we have @xmath636 is regular in codimension @xmath88 on @xmath516 .",
    "hence @xmath636 is regular on @xmath516 because @xmath433 is normal .",
    "similarly @xmath637 is regular on @xmath516 .",
    "we verify @xmath638 for @xmath639 and @xmath640 for @xmath409 by direct computation .",
    "now by induction using the implications above we prove @xmath641 for @xmath642 , @xmath643 for @xmath644 and @xmath640 for @xmath645 .",
    "we claim that @xmath646 and @xmath647 hold .",
    "( note that the implication ( 2b ) was not established for @xmath648 so can not be used here . )",
    "observe that the loci @xmath649 are irreducible divisors .",
    "so it suffices to prove that @xmath650 and @xmath651 do not contain any of these divisors .",
    "but by lemma  [ restrict_to_h ] below the intersection @xmath652 of these divisors is not contained in @xmath650 or @xmath651 .",
    "this establishes the claim .",
    "finally we deduce that @xmath613 hold for all @xmath547 by induction .",
    "[ restrict_to_h ] define a sequence @xmath653 by @xmath654 , @xmath655 , and @xmath656 for @xmath657 .",
    "( then @xmath658 , and @xmath659 unless @xmath370 or @xmath543 and @xmath660 . )",
    "then @xmath661 in particular , set - theoretically we have @xmath662 and @xmath663 with equality for @xmath664 .",
    "@xcite , ( 3.2 ) , p.  172 . ) the description of @xmath665 and @xmath666 for @xmath667 are verified by direct computation .",
    "we establish the description of @xmath666 for @xmath668 by induction using the equations @xmath669 the final statements follow using @xmath670 .",
    "define a sequence @xmath671 as follows .",
    "define @xmath672 define @xmath673 for @xmath568 by @xmath674 we also define @xmath675 if @xmath543 then @xmath544 so @xmath676 @xmath677 we define @xmath673 for @xmath547 by requiring @xmath678 . if @xmath58 we define @xmath673 for @xmath547 by requiring @xmath679 ( compare with the definition of the sequence @xmath534 , @xmath547 . )",
    "define @xmath680 by @xmath681 and if @xmath682 define @xmath683 by @xmath684    define @xmath685 and @xmath686 define an action of @xmath687 on @xmath688 by @xmath689 @xmath690 define @xmath691 and @xmath692    write @xmath693 then @xmath694 , @xmath695 for each @xmath97 , and the glueing is given by @xmath696 @xmath697    write @xmath698 @xmath699 and @xmath700 for each @xmath97 .",
    "then @xmath701 is a toric surface , @xmath702 is a proper smooth rational curve , and @xmath703 are the torus fixed points of @xmath701 .",
    "we also write @xmath704 for each @xmath97 .",
    "define @xmath705    note that @xmath706 has codimension @xmath71 , and @xmath688 is normal .",
    "thus the coordinate ring of the affine variety @xmath118 is given by @xmath707 where @xmath708\\ ] ] and @xmath709    we have a natural morphism @xmath710    define a birational toric morphism @xmath711 via @xmath712 define a morphism @xmath713 over @xmath714 using the following diagram    @xmath715^{\\pi^ * } \\ar@{^{(}->}[r ] & \\gamma(w',\\o_{w ' } ) \\ar[d ] & \\ar[l ] \\ar[dl]^{\\phi } r ' \\\\     \\gamma({\\mathbb x},\\o_{{\\mathbb x}})=\\text{cox}({\\mathbb x})^{\\gamma } \\ar@{^{(}->}[r ] & \\text{cox}({\\mathbb x } ) &   } \\ ] ]    by @xmath716    note that by construction the equations of @xmath688 correspond to the relations @xmath717 and @xmath718 between the @xmath719 .",
    "also , the group @xmath720 is identified with @xmath721 via @xmath722 , [ s_2]\\ ] ] and @xmath723 here we are using the case @xmath724 in the second formula of :    for @xmath725 we have @xmath726 and an identification @xmath727    cf .",
    "@xcite , propositions  3.14 and 3.15 , p.  174 .",
    "it follows that @xmath90 is well defined .",
    "[ contractinggmaction ] there exists a @xmath728-action on @xmath440 , @xmath714 , @xmath729 , @xmath118 , and @xmath730 such that    1 .",
    "the morphisms @xmath731 , @xmath732 , @xmath733 , @xmath90 , and @xmath734 are @xmath728-equivariant , and 2 .",
    "@xmath728 fixes the points @xmath735 , @xmath736 , and @xmath737 and in each case acts with positive weights on the corresponding maximal ideal in the affine coordinate ring .",
    "we define the @xmath728 action on @xmath731 by @xmath738 recall the equalities @xmath739 , @xmath740 , @xmath741 , and @xmath742 . using the equations @xmath592",
    "we find that @xmath581 is a @xmath728-eigenfunction for each @xmath547 .",
    "( the equations are seen to be homogeneous for the @xmath728-action by induction on @xmath130 using the equalities @xmath743 . )",
    "moreover , the weight of @xmath581 for @xmath744 is given by @xmath745 @xmath746 and @xmath747 cf .",
    "lemma  [ restrict_to_h ] .",
    "recall that @xmath748 , @xmath749 , @xmath750 , @xmath751 , and @xmath752 , @xmath753 .",
    "so we obtain a compatible @xmath728-action on @xmath754 , and an induced action on @xmath732 .",
    "we observe that @xmath728 acts with positive weights on @xmath714 , @xmath730 , and @xmath118 as claimed .",
    "( note that if @xmath544 then @xmath728 acts with weight @xmath89 on @xmath755 , but no power of @xmath756 is @xmath687-invariant . )    assume @xmath757 .",
    "then @xmath758 , @xmath759 , and we have an identification @xmath760    ( cf .",
    "@xcite , theorem  4.5 , p.  178 . )",
    "mori s proof works verbatim .    in particular , in the case @xmath757 the family @xmath732",
    "is independent of @xmath761 , that is , it is the pullback of a family @xmath762 under the projection @xmath763 . for the moment we will keep the redundant variable @xmath761 in order to treat both cases @xmath757 and @xmath764 simultaneously .",
    "[ universalflip ] assume @xmath764 .",
    "the morphism @xmath765 is a proper birational morphism with exceptional locus @xmath766 .",
    "moreover @xmath767 or , equivalently , @xmath768 , where @xmath769 is the self - intersection of the proper transform of @xmath251 in the minimal resolution of @xmath701 .",
    "@xcite , theorem  4.7 , p.  178 . )",
    "the morphism @xmath770 is clearly birational .",
    "we have @xmath771 for some @xmath772 , for each @xmath97 and @xmath773 . recalling that @xmath774 we deduce @xmath775 .",
    "it follows that @xmath734 is proper over a neighbourhood of @xmath737 , and hence over @xmath118 using the existence of a contracting @xmath728-action on @xmath776 , see lemma  [ contractinggmaction ] .",
    "we compute @xmath777 using the toric description of the section @xmath701 .",
    "observe that @xmath778 and @xmath251 is the only proper curve contained in @xmath779 .",
    "( indeed the fibers of @xmath780 are obtained from the special fiber @xmath781 ( the toric boundary of @xmath701 ) by smoothing a subset of the two nodes . )",
    "now since @xmath782 is relatively ample over @xmath118 ( using @xmath783 , @xmath784 , and the contracting @xmath728-action ) it follows that the exceptional locus of @xmath734 equals @xmath251 .    1 .",
    "assume @xmath764 .",
    "the morphism @xmath90 is a proper birational morphism with exceptional locus the codimension 2 set @xmath785 we have @xmath786 or explicitly @xmath787 2 .",
    "assume @xmath757 .",
    "the morphism @xmath90 is a proper birational morphism with exceptional locus the irreducible divisor @xmath788 we have @xmath789    ( cf .",
    "@xcite , theorem  4.3 , p.  177 . )",
    "it is easy to see that @xmath90 is birational .",
    "now consider the base change @xmath790 and the morphism @xmath791 .",
    "let @xmath792 denote the origin .",
    "if @xmath764 then the element @xmath793 is @xmath687-invariant for some @xmath794 , for each @xmath97 and @xmath773 . if @xmath757 then the elements @xmath795 are @xmath687 invariant for some @xmath796 .",
    "it follows that @xmath797 @xmath798 now @xmath799 and @xmath800 by lemma  [ restrict_to_h ] ( using @xmath801 , @xmath802 , @xmath803 , @xmath804 ) .",
    "thus @xmath805 .",
    "it follows that there is an open neighbourhood @xmath806 such that @xmath90 is proper over @xmath807 .",
    "moreover , by lemma  [ contractinggmaction ] we have a contracting @xmath728-action on @xmath808 .",
    "it follows that @xmath90 is proper .",
    "suppose @xmath764 .",
    "then @xmath809 and @xmath810 by @xcite , proposition  3.14(2 ) , p.  174 .",
    "thus @xmath811 and @xmath812 are relatively ample over some open neighbourhood @xmath806 ( because @xmath813 ) . using the contracting @xmath728-action again we deduce that @xmath814 and @xmath812 are relatively ample over @xmath815 .",
    "now @xmath816 where @xmath817 , @xmath818 .",
    "so the exceptional locus of @xmath90 is contained in @xmath819 .",
    "we have @xmath820 by lemma  [ restrict_to_h ] .",
    "also , @xmath819 is preserved by the contracting @xmath728-action ( because @xmath821 and @xmath822 are eigenfunctions for the @xmath728-action ) . moreover ,",
    "each fiber of @xmath819 over @xmath714 is either empty or irreducible of dimension @xmath88 .",
    "thus every fiber of @xmath823 is algebraically equivalent to a multiple of @xmath7 .",
    "it follows that the exceptional locus of @xmath90 is equal to @xmath819 .",
    "similarly , if @xmath757 , then @xmath812 is relatively ample over @xmath815 , and @xmath824 satisfies @xmath825 by lemma  [ restrict_to_h ] ( using @xmath826 ) .",
    "also , the locus @xmath819 is preserved by the contracting @xmath728-action .",
    "it follows that each fiber of @xmath823 is a proper curve , such that each component is algebraically equivalent to a multiple of @xmath7 .",
    "so the exceptional locus of @xmath90 equals @xmath819 .",
    "finally , since the milnor number of a @xmath144-gorenstein smoothing of a singularity of type @xmath125 equals @xmath89 , we have @xmath827 for all @xmath828 .",
    "it follows that the fibers of @xmath823 are irreducible , and hence that @xmath819 is irreducible .",
    "see @xcite , theorem  4.5 , p.  178",
    "for the identification of @xmath829 .",
    "we identify the exceptional locus @xmath819 explicitly in the case @xmath764 of flipping contractions .",
    "[ exceptional_locus_local_eq ] assume @xmath764 .",
    "the locus @xmath830 is given in the charts @xmath831 as follows .",
    "we have @xmath832 for @xmath544 and @xmath833 for @xmath834 .",
    "write @xmath835 for @xmath97",
    ". then @xmath836 @xmath837 and similarly , for @xmath834 , @xmath838 @xmath839 in particular , the nonempty fibers of @xmath823 are irreducible of dimension @xmath88 .",
    "first observe that @xmath840 implies @xmath841 using the equations @xmath717 and @xmath718 .",
    "hence @xmath832 if @xmath544 and @xmath833 if @xmath834 .",
    "recall that @xmath842 by lemma  [ restrict_to_h ] . in proposition  [ glueingfamilies ]",
    "we show that , for @xmath834 , the restriction of the morphism @xmath843 to the open subset @xmath844 is identified with the restriction of the morphism @xmath845 associated to the data @xmath846 to the open subset @xmath847 thus it suffices to describe @xmath848 .",
    "let @xmath849 .",
    "consider the fibers @xmath850 @xmath851 define closed irreducible curves @xmath852 as follows .",
    "@xmath853 @xmath854 @xmath855 @xmath856",
    "@xmath857 @xmath858 now , similarly to lemma  [ restrict_to_h ] , one checks @xmath859 thus , noting that @xmath860 , we obtain @xmath861      let @xmath863 be such that @xmath864 .",
    "explicitly , if @xmath58 then we require @xmath865 if @xmath764 and @xmath866 if @xmath757 . if @xmath543 we require @xmath867 if @xmath764 and @xmath868 if @xmath757 .",
    "we will call the allowed values of @xmath869 _ admissible_. in what follows the superscripts @xmath869 are understood modulo @xmath870 in the case @xmath543 .    define @xmath871 thus @xmath872 and @xmath873 for each @xmath97 .",
    "we have @xmath874 and @xmath875 for each @xmath97 and all admissible @xmath869 .",
    "moreover , @xmath876 and @xmath877    we apply the above constructions to the data @xmath878 , and denote the result by the same notations decorated by a superscript @xmath869 .",
    "[ glueingfamilies ] for each admissible @xmath869 the family @xmath879 is identified with @xmath754 by identifying variables with the same name ( forgetting the superscript ) , that is , @xmath880 in particular we have an induced identification @xmath881 .",
    "let @xmath882 be admissible .",
    "then we have an identification @xmath883 given by @xmath884 @xmath885 and @xmath886 where the subscript @xmath130 is understood modulo @xmath870 if @xmath543 .    using the above identifications we obtain the following :    1 .   a toric surface @xmath56 ( only locally of finite type for @xmath562 ) together with a toric birational morphism @xmath887 such that @xmath56 is the union of the toric open affine sets @xmath888 for @xmath869 admissible and the restriction of @xmath73 to @xmath888 is the morphism @xmath889 2 .   a proper birational morphism @xmath890 such that @xmath891 and the restriction of @xmath892 to @xmath893 is the morphism @xmath894    the toric birational morphism @xmath895 can be described explicitly as follows",
    "we identify @xmath730 as the toric variety associated to the cone @xmath167 in the lattice @xmath466 .",
    "we define a fan @xmath76 in @xmath175 with support @xmath481 contained in @xmath177 such that the toric birational morphism corresponds to the map of fans @xmath896 .",
    "if @xmath543 , define @xmath897 , @xmath898 , and @xmath899 .",
    "let @xmath76 be the fan with cones @xmath468 , @xmath900 , @xmath901 , and @xmath902 , @xmath97 .",
    "( so in the case @xmath72 the morphism @xmath73 is the blowup of @xmath736 . )",
    "if @xmath560 , define primitive vectors @xmath903 for @xmath80 by @xmath904 @xmath905 and @xmath906 @xmath907 ( so @xmath908 where @xmath909 . )",
    "let @xmath76 be the fan with cones @xmath468 , @xmath910 for @xmath80 , @xmath911 for @xmath912 , and @xmath913 for @xmath912 .    for @xmath560",
    "define @xmath914 that is , @xmath132 is the larger root of the quadratic equation @xmath915 equivalently , @xmath132 is given by the infinite hirzebruch - jung continued fraction @xmath916    then the support @xmath481 of the fan @xmath76 is the region @xmath917 or , equivalently , @xmath918    let @xmath919 denote the exceptional locus of @xmath892 ( thus @xmath920 ) .",
    "write @xmath921 and @xmath922 .",
    "[ universality ] let @xmath61 be an extremal neighborhood of type @xmath2 or @xmath1 .",
    "let @xmath923 be the morphism determined by a general element @xmath215 .",
    "assume that the general fiber @xmath38 of @xmath216 satisfies @xmath50 .",
    "then there is a universal family @xmath924 as in proposition  [ glueingfamilies ] and a morphism @xmath925 such that @xmath926 and the diagram @xmath927 is isomorphic to the pullback of the diagram @xmath928 under @xmath66 .",
    "if @xmath5 is a flipping contraction and @xmath17 is the flip of @xmath5 then the diagram @xmath929 is identified with the pullback of the diagram @xmath930 under @xmath70 .",
    "furthermore , if @xmath931 is a general element , then we may assume that @xmath330 is the pullback of @xmath932 .",
    "( then , if @xmath5 is a flipping contraction , the strict transform @xmath933 is the pullback of @xmath934 . )",
    "we note that the cone @xmath935 corresponds to an extremal neighborhood of type @xmath1 with singularities @xmath936 if it is of flipping type , then @xmath937 . in this case",
    "one of the singularities of the surface @xmath701 , which is the fiber over @xmath938 of @xmath754 , is @xmath939 ( see  [ contraction ] ) .",
    "similarly for the cone @xmath940 .",
    "in this way , both singularities of @xmath701 can be read from these  initial \" @xmath1 .",
    "( it is possible that @xmath941 . in that case",
    "the corresponding point in @xmath701 is smooth . )",
    "[ initialk2a ]    [ locallyversal ] the flat family of surfaces @xmath942 induces a versal @xmath144-gorenstein deformation of each fiber .",
    "the flat families of pairs @xmath943 and @xmath944 induce a versal @xmath144-gorenstein deformation of each fiber .    by openness of versality and the existence of the contracting @xmath728-actions ( lemma  [ contractinggmaction ] ) it suffices to consider the toric fibers .",
    "we will establish the statement for pairs first .",
    "we prove it for @xmath945 , the other case being identical .",
    "let @xmath946 be a toric chart and @xmath947 the toric fiber over @xmath735 .",
    "the logarithmic tangent sheaf @xmath948 is the sheaf of infinitesimal automorphisms of the pair @xmath947 .",
    "since @xmath947 is toric we have an identification @xmath949 where @xmath175 is the lattice of @xmath88-parameter subgroups of the torus acting on @xmath49 .",
    "thus @xmath950 for @xmath951 .",
    "it follows that the local - to - global map from the versal @xmath144-gorenstein deformation space of the pair @xmath947 to the product of the @xmath144-gorenstein versal deformation spaces of the singularities @xmath952 , @xmath97 of the pair is an isomorphism .",
    "recall also that a singularity @xmath953 of type @xmath125 has versal @xmath144-gorenstein deformation space a smooth curve germ @xmath954 , with versal family @xmath955 moreover , writing @xmath956 for the toric boundary , the forgetful map @xmath957 from the versal @xmath144-gorenstein deformation space of the pair @xmath958 to the versal @xmath144-gorenstein deformation space of @xmath953 is an isomorphism .",
    "( indeed @xmath198 is cartier on the index one cover @xmath959 given by @xmath960 and the @xmath144-gorenstein deformation is induced by an equivariant deformation of the index one cover .",
    "so there are no obstructions to lifting @xmath198 to the deformation . moreover , since @xmath961 , it s easy to see that every infinitesimal embedded deformation of @xmath198 is induced by an infinitesimal automorphism of @xmath962 . combining",
    "it follows that the forgetful map ( [ forgetdivisor ] ) is an isomorphism . )",
    "now it is clear from the explicit charts @xmath445 , @xmath449 for the restriction of the family @xmath942 to @xmath946 that @xmath945 induces a versal @xmath144-gorenstein deformation of the pair @xmath947 .",
    "finally , we prove versality for @xmath942 . by the above , it suffices to show that @xmath963 for each toric fiber @xmath49 , so that the local - to - global map from the versal @xmath144-gorenstein deformation space of @xmath49 to the product of the versal @xmath144-gorenstein deformation spaces of the singularities of @xmath49 is an isomorphism .",
    "let @xmath964 be the orbifold stack associated to @xmath49 , that is , @xmath964 is the deligne ",
    "mumford stack with coarse moduli space @xmath49 determined by the local smooth covers @xmath965 at each quotient singularity of @xmath49 .",
    "write @xmath966 and @xmath967 , @xmath968 for the associated stacks",
    ". then we have an exact sequence of sheaves on @xmath964 @xmath969 ( where @xmath970 denotes the normal bundle of a closed embedding @xmath499 ) . pushing forward via the natural morphism @xmath971",
    ", we obtain an exact sequence @xmath972 where @xmath973 .",
    "so , since @xmath974 for @xmath951 ( see above ) and @xmath975 are affine , we have @xmath976 and @xmath977 .",
    "finally , we compute that the degree of the line bundle @xmath978 on @xmath12 equals @xmath979 , so @xmath980 as required . in general ,",
    "if @xmath981 is a line bundle on a proper orbifold curve @xmath982 , with coarse moduli space @xmath983 , and orbifold points @xmath984),\\ ] ] where @xmath985 and the action of @xmath986 on the fiber @xmath987 is via the character @xmath988 , @xmath989 , then @xmath990 recall that we have isomorphisms @xmath223 hence the degree of the line bundle @xmath978 on @xmath12 is given by @xmath991 using the formula @xmath992 ( see @xcite , proof of proposition  2.6 ) , we find @xmath993 .",
    "thus @xmath980 as required .",
    "[ k1atok2a ] the computation of the singularities of @xmath421 and the intersection number @xmath994 are straightforward toric calculations .",
    "( note that it suffices by symmetry to treat the case @xmath370 .",
    "now the formulas for @xmath995 and @xmath996 agree with those in ",
    "[ k2adeformation ] and in particular we see that the vector @xmath997 lies in @xmath175 and is primitive . )    now by the description of the versal deformation @xmath713 of @xmath998 over @xmath714 given in  [ contraction ] and the identification of the fibers over @xmath999 ( in particular the description of the exceptional curve in proposition  [ exceptional_locus_local_eq ] ) we find that the general fiber over the appropriate component of the boundary @xmath999 is isomorphic to the given contraction @xmath1000 .",
    "indeed , it suffices to check that the strict transform of the exceptional curve for the deformation of @xmath414 intersects the same component of the exceptional locus of the minimal resolution of the @xmath425 singularity as in the original @xmath2 surface contraction @xmath1001 . by the description of the local equation of the exceptional curve in proposition  [ exceptional_locus_local_eq ] this component corresponds to the ray @xmath1002 in the toric description of the minimal resolution of the singularity .",
    "( to see this , note first that @xmath1003 by definition ( see proposition  [ k1ainvariants ] ) , and that the number @xmath55 coincides with the invariant of the same name for the @xmath1 surface @xmath421 defined in  2 , by the computation of @xmath994 .",
    "now observe that the local equation of @xmath251 is homogeneous with respect to the grading determined by the primitive generator of @xmath475 .",
    "so the strict transform meets the interior @xmath1004 of the associated exceptional divisor . )",
    "this agrees with the description of the original @xmath2 surface @xmath49 given in proposition  [ k1ainvariants ] .    by construction",
    "( and the classification of @xmath1 extremal neighborhoods ) , the hyperplane section @xmath1005 of a @xmath1 extremal neighbourhood occurs as a fiber of a universal family @xmath942 over a torus fixed point of @xmath56 . see @xcite , remark  2.3 , p.  159 . by proposition  [ k1adegeneratestok2a ] ,",
    "the hyperplane section of a @xmath2 extremal neighborhood occurs as a fiber of a universal family over an interior point of a @xmath88-dimensional toric stratum of @xmath56 .",
    "moreover , in each case , the deformation of the fiber given by the family @xmath942 is a versal @xmath144-gorenstein deformation .",
    "this establishes the existence of @xmath66 .    in the case of a flipping contraction",
    "it is immediate that the pullback @xmath1006 of @xmath1007 is a proper birational morphism with exceptional locus @xmath251 such that @xmath1008 is @xmath144-cartier and @xmath1009 .",
    "( note here that the proper birational morphism @xmath1007 has exceptional locus @xmath1010 , see proposition  [ universalflip ] , and @xmath1011 . )",
    "so it is the flip of @xmath5 .    for the final statement ,",
    "note first that @xmath1012 is surjective by kawamata ",
    "viehweg vanishing and cohomology and base change ( using @xmath1013 relatively ample ) , so the restriction of a general element @xmath330 of @xmath1014 is a general element of @xmath1015 .",
    "we observe that every pair @xmath947 of a @xmath2 or @xmath1 surface @xmath49 together with a general element @xmath1016 occurs as a fiber of @xmath945 .",
    "( see lemma  [ restrict_to_h ] and the proof of proposition  [ exceptional_locus_local_eq ] for the the description of the fibers of @xmath921 in the @xmath1 and @xmath2 cases respectively . )",
    "the family of pairs @xmath1017 gives a versal @xmath144-gorenstein deformation of each fiber by lemma  [ locallyversal ] .",
    "so we may assume @xmath330 is the pullback of @xmath932 .",
    "[ existenceofterminalantiflips ] let @xmath94 be a partial resolution of a cyclic quotient singularity such that @xmath95 has t - singularities and @xmath99 is relatively ample , and @xmath1018 a one parameter @xmath144-gorenstein smoothing of the germ @xmath111 .",
    "then the morphism @xmath1019 extends to a proper birational morphism @xmath17 over @xmath954 .",
    "assume that the general fiber @xmath1020 , @xmath1021 satisfies @xmath1022 .",
    "then @xmath16 is irreducible and @xmath95 has only cyclic quotient singularities of type @xmath125 for some @xmath52 with @xmath53 .",
    "the @xmath0-fold @xmath15 has @xmath144-factorial terminal singularities .",
    "the morphism @xmath1019 is toric .",
    "choose a toric structure and let @xmath1023 denote the toric boundary .",
    "let @xmath1024 , @xmath97 be the torus fixed points , @xmath1025 the index of @xmath454 , and define @xmath1026 by @xmath1027 .",
    "assume that the exceptional locus of @xmath1028 equals @xmath16 .",
    "then there exists an antiflip @xmath8 of @xmath1028 such that @xmath4 has terminal singularities if and only if the following conditions are satisfied .    1 .   for some choice of toric structure",
    ", there is a divisor @xmath139 such that @xmath1029 , the toric boundary of @xmath95 .",
    "if @xmath560 , define @xmath1030 . then the axial multiplicities @xmath141 of the singularities of @xmath15 satisfy @xmath1031 or @xmath1032 .",
    "equivalently , we have @xmath1033    in the case that @xmath15 has fewer than two singularities , we define the axial multiplicities @xmath141 as follows .",
    "let @xmath330 be a general element of @xmath1034 . by condition ( 1 ) the restriction",
    "@xmath1029 is a choice of toric boundary for @xmath95 .",
    "let @xmath1035 be the singular points of @xmath1036 .",
    "if @xmath454 is a smooth point of @xmath15 , then the local deformation @xmath1037 of @xmath1038 is of the form @xmath1039 for some @xmath210 and convergent power series @xmath211 , @xmath212 .",
    "equivalently , @xmath1040 is a du val singularity of type @xmath1041 .",
    "we define @xmath1042 .",
    "if @xmath454 is a singular point of @xmath15 then the definition of the axial multiplicity is the usual one .",
    "the morphism @xmath1043 extends to a morphism @xmath1044 because @xmath1045 ( see @xcite , proposition 11.4 ) .",
    "the morphism @xmath1043 is a @xmath1046-resolution of @xmath273 @xcite , definition  3.8 .",
    "it is toric by @xcite , lemma  3.14 .",
    "the singularities of @xmath95 are cyclic quotient singularities of type @xmath1047 for some @xmath1048 with @xmath1049 ( by the existence of the @xmath144-gorenstein smoothing , see @xcite , proposition  3.10 ) .",
    "the milnor fiber @xmath56 of a @xmath144-gorenstein smoothing of such a singularity has milnor number @xmath246 .",
    "thus , if @xmath1050 is the number of irreducible components of @xmath16 and the singularities @xmath1024 have invariants @xmath181 , a mayer  vietoris argument gives @xmath1051 hence @xmath1022 iff @xmath16 is irreducible and @xmath1052 for each @xmath130 .",
    "the @xmath0-fold @xmath15 has singularities of the form @xmath1053 the number @xmath1054 is the index of the singularity and the number @xmath210 is the _ axial multiplicity _ of the singularity @xcite , definition ",
    "corollary  1a.5 , p.  140 .",
    "as already noted , these singularities are terminal , and analytically @xmath144-factorial by @xcite , 2.2.7 .",
    "thus @xmath15 is terminal and @xmath144-factorial .",
    "( note : in general , a one parameter @xmath144-gorenstein smoothing of a surface quotient singularity is terminal @xcite , corollary  3.6 . the modern proof of this fact uses  inversion of adjunction \" , see e.g. @xcite , theorem  5.50(1 ) , p.  174 . )",
    "since @xmath1055 is a cyclic quotient singularity , it follows from the classification of non - semistable flips @xcite , appendix that if @xmath26 is a terminal antiflip of @xmath1028 then @xmath5 is semistable , that is , of type @xmath2 or @xmath1 .",
    "moreover @xmath1056 is normal and @xmath247 by proposition  [ b2=1=>normal ] because @xmath1057 for @xmath1021 .",
    "let @xmath1058 be a general element .",
    "then , by theorem  [ universality ] , @xmath1059 is the pullback of a universal family @xmath1060 via a morphism @xmath62 , such that @xmath1011 .",
    "let @xmath933 denote the strict transform of @xmath330 .",
    "then @xmath1061 is the pull back of @xmath1062 via the morphism @xmath70 , and @xmath1063 is a general element such that @xmath1064 , so ( 1 ) holds .    the morphism @xmath1065 is given by @xmath1066 for some @xmath1067 , @xmath1068 ( where @xmath1069 denotes higher order terms in @xmath1070 ) . by the description of the family @xmath754 , we see that @xmath141 are the axial multiplicities of the singularities of @xmath15 .",
    "identify the fan @xmath76 of @xmath56 with its image in the cone @xmath1071 of @xmath730 under the map of fans corresponding to @xmath73 .",
    "the point @xmath1072 lies in the toric boundary stratum of @xmath56 corresponding to the smallest cone @xmath1073 of the fan of @xmath56 containing the point @xmath1074 .",
    "in particular @xmath1074 lies in the support of the fan of @xmath56 .",
    "now the explicit description of the fan of @xmath56 above gives @xmath1075 .",
    "conversely , suppose the conditions ( 1 ) and ( 2 ) are satisfied .",
    "let @xmath1076 be general , so @xmath1029 is a choice of toric boundary for @xmath95 by ( 1 ) .",
    "let @xmath1077 be the deformation of @xmath1078 constructed in  [ contraction ] .",
    "by lemma  [ locallyversal ] , @xmath1079 is the pullback of @xmath1077 via a map @xmath1080 such that @xmath1081 .",
    "the numerical data to build @xmath67 from @xmath729 is the following .",
    "let @xmath1082 be the singularities of @xmath1083 such that @xmath1084 $ ] , @xmath1085 $ ] , and @xmath1086,\\ ] ] where @xmath769 is the self - intersection of the proper transform of @xmath16 in the minimal resolution of @xmath95 .",
    "if a singularity ( or both ) is ( are ) actually smooth , then we set @xmath1087 .",
    "define @xmath1088 define @xmath1089 , @xmath1090 if @xmath1091 , or @xmath1092 else , and @xmath1093 , @xmath1094 .",
    "one can check that @xmath1095 and gcd@xmath1096 .",
    "if @xmath1097 $ ] , then one can check @xmath1098= \\frac{\\delta}{\\omega}.\\ ] ] one can verify that this gives an  initial \" @xmath1 for a mori sequence whose  flipping \" surface is @xmath95 ( see remark [ initialk2a ] ) . for the other initial @xmath1 ,",
    "we define @xmath1099 , @xmath1100 if @xmath1101 , or @xmath1102 else , and @xmath1103 , @xmath1104 .",
    "notice that these are the only two possibilities for initial @xmath1 corresponding to @xmath729 .    by assumption",
    "( 2 ) and the description of the toric morphism @xmath895 , the morphism @xmath1105 admits a lift @xmath62 such that @xmath1106 . indeed , as above , ( 2 ) is equivalent to requiring that the vector @xmath1074 given by the vanishing orders of the components of @xmath1105 lies in the image of the fan of @xmath56 in the cone @xmath167 corresponding to @xmath714 . this in turn is equivalent to the existence of the lift @xmath66 . now",
    "the pull back of @xmath1107 by @xmath66 is the desired terminal antiflip @xmath1108 of @xmath1028 .",
    "[ asflnsfgajf ] if we only impose condition ( 1 ) in corollary  [ existenceofterminalantiflips ] then there is an antiflip @xmath26 such that @xmath4 has _",
    "canonical _ singularities .",
    "this is an application of @xcite , theorem  3.1 , p.  561 . indeed , by ( 1 ) , for a general divisor @xmath1076 the restriction @xmath140 is a choice @xmath1036 of toric boundary for @xmath1109 .",
    "then , since @xmath140 is a nodal curve , @xmath1076 is a normal surface with at worst du val singularities of type @xmath28 ( at the nodes of @xmath1110 ) .",
    "moreover the contraction @xmath1111 has at worst a du val singularity of type @xmath28 .",
    "( more precisely , for @xmath330 general , we have du val singularities of type @xmath1112 at @xmath1040 for @xmath97 , where @xmath1025 is the index and @xmath1113 the axial multiplicity of @xmath1114 , and a du val singularity of type @xmath1115 at @xmath1116 . ) now by @xcite , theorem  3.1 , the @xmath1117-algebra @xmath1118 is finitely generated , and @xmath1119 has canonical singularities .",
    "the morphism @xmath26 is the antiflip of @xmath1044 .",
    "[ asdvasfgafg ] this is an explicit example of a @xmath129-gorenstein smoothing of a @xmath95 as in corollary [ existenceofterminalantiflips ] which has a nonterminal but canonical antiflip .",
    "let @xmath49 be a surface with one singularity given by the @xmath1120-quotient of a simple elliptic singularity ( cf .",
    "@xcite , theorem 9.6(3 ) ) .",
    "the exceptional locus of its minimal resolution @xmath1121 is a union of @xmath1122 smooth rational curves @xmath113 , @xmath1123 , @xmath1124 , and @xmath1125 so that the @xmath180 are disjoint , each meets the curve @xmath1125 transversally at a single point , and @xmath1126 , @xmath1127 , @xmath1128 , and @xmath1129 .",
    "assume @xmath49 has a smooth rational curve @xmath7 such that its proper transform in @xmath1121 is a @xmath112-curve intersecting only @xmath113 and transversally at one point .",
    "notice that @xmath1130 and @xmath1131 .    the surface @xmath49 has a @xmath129-gorenstein smoothing @xmath1132 ( cf .",
    "the corresponding singularity in @xmath4 is canonical by @xcite , theorem 5.1 .",
    "let @xmath1133 be the contraction of @xmath1134 ( the blowing down deformation ; cf . ) .",
    "then @xmath371 is the cyclic quotient singularity @xmath1135 .",
    "by @xcite , proposition 3.1(4 ) , the extremal nbhd @xmath1136 is @xmath129-factorial .",
    "therefore , if it is of divisorial type , then @xmath14 would be @xmath129-gorenstein but @xmath1137 is not a t - singularity .",
    "so , it is flipping , and the flip is given by the p - resolution @xmath1138 whose exceptional curve is a @xmath1139 passing through two singularities of type @xmath1140 .",
    "[ canexample ]",
    "fix integers @xmath1141 with gcd@xmath1142 .",
    "let @xmath371 be the cyclic quotient singularity @xmath92 . an _",
    "extremal p - resolution _ of @xmath371 is a partial resolution @xmath94 such that @xmath95 has only _ wahl singularities _ ( @xmath1143 cyclic of the type @xmath125 with gcd@xmath1144 ) , the exceptional curve @xmath98 , and @xmath99 is relatively ample .",
    "they appear when we perform flips with the extremal neighborhoods of type @xmath2 or @xmath1 of the previous sections ( see corollary [ existenceofterminalantiflips ] ) .",
    "the surface @xmath95 has at most two wahl singularities @xmath1145 ( @xmath97 ) such that @xmath1146 $ ] , @xmath1147 $ ] , and @xmath1086,\\ ] ] where @xmath769 is the self - intersection of the proper transform of @xmath16 in the minimal resolution of @xmath95 .",
    "if a singularity ( or both ) is ( are ) actually smooth , then we set @xmath1148 .",
    "we define @xmath1149 then @xmath1150 , @xmath1151      by @xcite , theorem 3.9 , there is a natural bijection between p - resolutions of @xmath371 and irreducible components of the formal deformation space @xmath1152 . in @xcite , christophersen and stevens prove that p - resolutions of @xmath371 are in bijection with certain continued fractions representing zero . for extremal p - resolutions we have the following .",
    "let @xmath1153 $ ] .",
    "then the extremal p - resolutions of @xmath371 are in bijection with pairs @xmath1154 such that @xmath1155.\\ ] ] we label these p - resolutions by @xmath1156 $ ] .",
    "we now recall how to describe torically the p - resolution from the zero continued fraction .",
    "we follow @xcite .",
    "let us define in @xmath1157 the vectors @xmath1158 , @xmath1159 , and @xmath1160 for @xmath1161 .",
    "if @xmath1162 , then @xmath1163 $ ] for @xmath1164 . note that @xmath1165",
    "the fan @xmath76 of the toric surface @xmath95 , where the toric birational morphism @xmath94 is the extremal p - resolution , has two cones @xmath1166 and @xmath1167 where @xmath1168 , @xmath1169 , and @xmath1170 ; see @xcite pp.78 .",
    "the @xmath1171 which correspond to @xmath1172 respectively in @xcite ( giving the  roofs \" of the cones ) are @xmath1173 one can verify that @xmath1174 .",
    "[ contfracpres ] the extremal p - resolution @xmath1156 $ ] has @xmath1175 , \\ \\ \\",
    "\\frac{m_1}{a_1}=[c_s,\\ldots , c_{\\beta+1}],\\ ] ] ( if @xmath1176 and/or @xmath1177 , the corresponding points are smooth ) and either @xmath1178 $ ] , if @xmath1179 , for some @xmath1180 , or @xmath1181 .    since @xmath1182",
    ", we have @xmath1183 $ ] .",
    "hence @xmath1184 $ ] . by symmetry",
    ", we have @xmath1185 $ ] .    we know that @xmath1186 .",
    "then use lemma [ partfrac ] below with @xmath1187 $ ] and @xmath1163=:[e_1,\\ldots , e_i]=\\frac{p_{i+1}}{q_{i+1}}$ ] , setting @xmath1188 and @xmath1189 for the second equality in that lemma .",
    "[ partfrac ] let @xmath1190 $ ] be a continued fraction with @xmath1191 and @xmath1192>0 $ ] for all @xmath1193 .",
    "define @xmath1194 , @xmath1195 , and @xmath1196",
    ". then @xmath1197\\ ] ] for all @xmath1198 , @xmath1199 .",
    "we have @xmath1200 and @xmath1201 for all @xmath1198 .",
    "we now do induction on @xmath130 for the first equality , and induction on @xmath1202 for the second .",
    "the following are all the extremal p - resolutions for cyclic quotient singularities @xmath92 with @xmath1203 , apart from the type @xmath1204 $ ] ( which corresponds to @xmath1205 ) .",
    "the underlined notation represents another extremal p - resolution for the same singularity .",
    "@xmath1206 \\ \\ \\frac{11}{8}=[2,\\overline 2,3 , \\overline 2 ] \\ \\",
    "\\frac{13}{10}=[2,2,\\overline 2,\\overline 4 ] \\ \\",
    "\\frac{15}{11}=[\\overline 2,\\underline 2,3,\\overline 2 , \\underline 2]\\ ] ] @xmath1207 \\ \\",
    "\\frac{19}{15}=[\\overline 2,2,2,3,\\overline 2,2 ] \\",
    "\\ \\frac{19}{12}=[2,\\overline 3 , \\overline 2 , 3]\\ ] ] @xmath1208 \\ \\",
    "\\frac{22}{17}=[2,2,\\overline 2,4,\\overline 2 ] \\ \\",
    "\\frac{23}{19}=[\\overline 2,2,2,2,3,\\overline 2,2]\\ ] ] @xmath1209 \\ \\",
    "\\frac{25}{16}=[\\overline 2,3,2,\\overline 2,3 ] \\",
    "\\ \\frac{27}{23}=[\\overline 2,2,2,2,2,3 , \\overline 2,2]\\ ] ] @xmath1210 \\ \\",
    "\\frac{31}{27}=[\\overline 2,2,2,2,2,2,3,\\overline 2,2 ] \\ \\",
    "\\frac{31}{26}=[2,2,2,2,\\overline 2,\\overline 6]\\ ] ] @xmath1211 \\ \\",
    "\\frac{34}{25}=[\\overline 2,2,3,2,\\overline 2,3 ] \\ \\",
    "\\frac{35}{31}=[\\overline 2,2,2,2,2,2,2,3,\\overline 2,2]\\ ] ] @xmath1212 \\ \\",
    "\\frac{37}{30}=[2,2,2,\\overline 2,5,\\overline 2 ] \\ \\",
    "\\frac{37}{27}=[2,2,\\overline 3,\\overline 2,4]\\ ] ] @xmath1213 \\ \\ \\frac{39}{29}=[2,\\overline 2,3,2,2,2,2,2,2,2,\\overline 2]\\ ] ] @xmath1214 \\ \\",
    "\\frac{40}{29}=[2,\\overline 2,3,3,\\overline 2,2 ] \\ \\",
    "\\frac{41}{18}=[3,2,\\overline 2,3,\\overline 3]\\ ] ] @xmath1215 \\ \\",
    "\\frac{43}{37}=[2,2,2,2,2,\\overline 2,\\overline 7 ] \\ \\",
    "\\frac{43}{34}=[\\overline 2,2,2,3,2,\\overline 2,3]\\ ] ] @xmath1216 \\ \\",
    "\\frac{45}{29}=[\\overline 2,3,2,2,\\overline 2,4 ] \\ \\",
    "\\frac{45}{19}=[3 , \\overline 2,3,\\overline 2,3]\\ ] ]    the purpose of the next two subsections is to prove    [ atmost2 ] a cyclic quotient singularity @xmath92 can admit at most two distinct extremal p - resolutions .",
    "[ samedelta ] if a cyclic quotient singularity @xmath92 admits two extremal p - resolutions , then the @xmath55 s are equal .",
    "theorem [ atmost2 ] says that there are at most two universal antiflips over a given@xmath92 , and theorem [ samedelta ] says that the @xmath55 of a universal antiflip is an invariant of @xmath92 .",
    "the proofs for both theorems are going to be completely combinatorial , using the continued fraction of an extremal p - resolution and the formula for @xmath55 in proposition [ contfracpres ] .      according to @xcite ,",
    "@xmath1217 $ ] is a zero - continued fraction if and only if there exists a triangulation of the @xmath1218-gon with vertices indexed by @xmath1219 such that the number of triangles meeting at the @xmath130-th vertex is equal to @xmath131 .",
    "we define @xmath1220 as the number of triangles meeting at the @xmath89-th vertex .",
    "we obviously have @xmath1221    we say that a sequence of integers @xmath1222 is _ of ww type _ if there exists @xmath1223 such that @xmath1224\\ ] ] is a zero - continued fraction .    to prove theorem [ atmost2 ] , we proceed by induction on @xmath1050 , and along the way we more or less classify sequences of @xmath1225 type .",
    "a sequence @xmath1226 of @xmath1225 type gives rise to a triangulation that corresponds to .",
    "we say that this triangulation is _ compatible _ with  @xmath1226 .",
    "the claim is that there are at most two triangulations compatible with  @xmath1226 . for any triangulation , we call @xmath1227 the vertex sequence . by  , all triangulations compatible with @xmath1226 have the same @xmath1220 .",
    "we define @xmath1228 .",
    "notice that @xmath1229 can be equal to one .",
    "it is easy to see ( e.g.  by induction ) that the vertex sequence always contains at least two @xmath88 s .",
    "so we have the following possibilities :    1 .",
    "@xmath1230 , all vertex sequences compatible with @xmath1226 have two  @xmath88 s , @xmath1226  is obtained by substituting these @xmath88 s with @xmath71 s .",
    "2 .   @xmath1231",
    ".    we can handle case ( b ) by induction .",
    "indeed , in this case all triangulations compatible with @xmath1226 contain a triangle @xmath1232 formed by vertices @xmath1050 , @xmath89 , and @xmath88 .",
    "therefore they define triangulations of the @xmath1050-gon obtained by chopping off the triangle @xmath1232 .",
    "these triangulations are compatible with the sequence @xmath1233 if @xmath1234 contains two @xmath88 s then @xmath1235 .",
    "this implies that @xmath1236 and we are triangulating a square .",
    "this case is obvious .",
    "if @xmath1234 contains at most one @xmath88 then we are done by induction .",
    "now we deal with case ( a ) .",
    "first we inductively classify all triangulations with exactly two @xmath88 s in the vertex sequence .",
    "if @xmath1237 then we can chop off a triangle with vertices @xmath1238 .",
    "unless @xmath1236 , a new triangulation will have exactly two @xmath88 s , one of them at @xmath1239 or @xmath1240 .",
    "we chop off the next vertex with @xmath88 , and proceed inductively . in other words , we can get any sequence @xmath1226 of this type by the following procedure",
    ". start with a sequence @xmath1241 . then do a recursion analogous to enumeration of all @xmath1232-singularities : add a new @xmath71 on one end and increase another and by @xmath88 .",
    "so , for example , we can do @xmath1242\\to [ 3,\\bar 2,2,2]\\to [ 2,3,\\bar 2,2,3]\\to [ 2,2,3,\\bar 2,2,4]\\to \\ldots\\ ] ] after doing several steps , fold a sequence around a circle and add a new  @xmath1243 between the ends . now choose @xmath1220 anywhere except at overlined  @xmath71 s ( which should be decreased to ones in the vertex sequence ) .",
    "we are going to ignore @xmath1220 from now on .",
    "in particular , we will sometimes rotate indices if this will be convenient .",
    "start with our sequence @xmath1244 of type ( a ) and let @xmath1245 be the number of @xmath130 s such that @xmath1246 .",
    "now take any triangulation compatible with @xmath1226 .",
    "let @xmath1247 be the indices such that @xmath1248 . by the discussion above , unless we are triangulating a square , there exist unique indices @xmath1249 such that the @xmath73-th vertex is adjacent to the vertex @xmath1250 , and similarly for @xmath1251 .",
    "we rotate , and if necessary reflect the indices ( in the dihedral group ) so that , for the first triangulation , @xmath1252 and @xmath1253 . we create two new sequences :    * @xmath1254 is a subsequence of @xmath1226 of terms greater than @xmath71 . *",
    "@xmath1255 for @xmath1256 is the number of @xmath71 s in @xmath1226 between the terms that correspond to @xmath1113 and @xmath1257 increased by @xmath88 .",
    "the indexing set here is @xmath1258 .",
    "then the inductive procedure above allows us to compute @xmath1113 s in terms of @xmath1255 s .",
    "there are two cases",
    ". if @xmath1259 is even , we have @xmath1260 if @xmath1261 is odd , we have @xmath1262 now consider the second triangulation .",
    "we change notation , and let @xmath1263 denote the data of the second triangulation .",
    "the sequence @xmath1264 has @xmath1265 , @xmath1266 , and @xmath1267 .",
    "the overlined and the underlined @xmath71 s should be decreased by @xmath88 to get the two vertex sequences .",
    "the first triangulation has @xmath1252 , @xmath1268 ; the second has @xmath1269 , @xmath1270 . in this way , @xmath1271 , @xmath1272 , @xmath1273 , @xmath1274 , and @xmath1275 , and so @xmath1276 , @xmath1277 , @xmath1278 , @xmath1279 , and @xmath1280 .",
    "the sequence @xmath1281 has @xmath1282 , @xmath1283 , and @xmath1284 .",
    "we have @xmath1285 , @xmath1272 , @xmath1286 , @xmath1287 , @xmath1288 , @xmath1289 , @xmath1290 , and @xmath1291 , and so @xmath1292 , @xmath1277 , @xmath446 , @xmath1293 , @xmath1294 , @xmath1295 , @xmath1296 , and @xmath1297 .",
    "_ we first consider the case of odd @xmath1261 .",
    "_ after interchanging @xmath73 and @xmath1298 if necessary , we can assume that the vertex @xmath73 is located clock - wise from the vertex @xmath1299 .",
    "we define @xmath1300 through @xmath1301 .",
    "notice that @xmath1302 .",
    "then the sequence @xmath1303 satisfies another system of equations : @xmath1304 ( as a reminder , the indexing set is @xmath1258 ) .",
    "we claim that @xmath1305 is uniquely determined by the sequence @xmath1306 .",
    "this will show that the second triangulation compatible with @xmath1226 is unique ( if exists ) .",
    "we have the following system of equations when @xmath1307 or @xmath1308    @xmath1309 let @xmath1310 then the system of equations above shows that @xmath1255 is constant on @xmath432-cosets in @xmath1258 unless a coset contains @xmath89 , @xmath1311 , @xmath1202 , or @xmath1312 .",
    "next we compute a gauss sum @xmath1313 where @xmath283 is a primitive @xmath1245-th root of unity .",
    "clearly only one or two @xmath432 cosets contribute non - trivially to the gauss sum .",
    "namely , if @xmath1314 then there will be two non - trivial cosets , and we have @xmath1315 where @xmath1316 is the minimal positive integer such that @xmath1317 . geometric series and some manipulations give @xmath1318 we can clearly recover @xmath1319 , and hence @xmath1305 , by applying a fractional - linear transformation .    if @xmath1320 then in fact @xmath1321 , so there is only one coset .",
    "we have @xmath1322 , and we choose a minimal @xmath1070 such that @xmath1323 .",
    "there are two further subcases , either @xmath1324 and we have @xmath1325 and so @xmath1326 , or @xmath1327 , in which case a similar calculation gives @xmath1328 . for the cases",
    "@xmath1329 and @xmath1330 we obtain same @xmath1331 as well .",
    "therefore @xmath1305 is uniquely determined by the @xmath1306 .",
    "_ now let s consider the case of even @xmath1259 . _",
    "after interchanging @xmath73 and @xmath1298 if necessary , we can assume that @xmath1299 satisfies @xmath1332 with @xmath1333 .",
    "there are two further subcases : in the _ clockwise _ ( resp .",
    "_ counter - clockwise _ ) case the vertex @xmath73 is located clockwise ( resp .",
    "_ counter - clockwise _ ) from the vertex @xmath1299 .",
    "notice that in the clockwise case @xmath1302 .",
    "the sequence @xmath1303 satisfies a new system of equations : @xmath1334 in the clockwise case and @xmath1335 in the counter - clockwise case .",
    "this gives a system of equations on @xmath1255 : @xmath1336 in the clockwise case and @xmath1337 in the counter - clockwise case .",
    "we have to recover @xmath1305 ( and whether we have a clockwise or a counter - clockwise case from the sequence @xmath1255 ) . to simplify this problem , consider a new sequence @xmath1338 defined as @xmath1339 we think about @xmath1338 as indexed by the cyclic group @xmath1340 .",
    "it satisfies the following system of equations : @xmath1341 in the clockwise case and @xmath1342 in the counter - clockwise case .",
    "we define a subgroup @xmath1343 in the clockwise ( resp .",
    "counter - clockwise ) case .",
    "we also define a gauss sum @xmath1344 where @xmath283 is a primitive @xmath1202-th root of unity .",
    "the system of equations above shows that @xmath1338 is constant on @xmath432-cosets in @xmath1340 unless a coset contains @xmath89 or @xmath1311 .",
    "moreover , in the latter case the coset must contain both @xmath89 and @xmath1311 , as otherwise we will have a non - constant periodic monotonous function .",
    "only this coset will contribute non - trivially to  @xmath1331 . in the clockwise case we have @xmath1345 @xmath1346 , and",
    "@xmath1347 therefore @xmath1348 obviously @xmath1349 and @xmath1331 determines @xmath1305 . in the counter - clockwise case",
    "we have @xmath1350 hence @xmath1351 where @xmath1352 .",
    "so we obtain @xmath1353 it follows that @xmath1354 and so @xmath1355 indeed , as we connect a fixed vertex @xmath88 of an @xmath1202-gon to other vertices by diagonals , two consecutive diagonals never have equal length , unless @xmath1356 , but this would contradict .",
    "in particular , we can not have both a clockwise ( in which case @xmath1357 ) and a counter - clockwise case .",
    "it follows from that we can find @xmath1305 by solving the quadratic equation @xmath1358 by , this equation can not have two solutions .",
    "we now prove theorem [ samedelta ] . as for theorem [ atmost2 ]",
    ", we only need to consider case ( a ) .",
    "let @xmath1244 be a sequence of type ( a ) .",
    "we adopt the same conventions as before , and define @xmath1359 , and the @xmath1360 , where @xmath1361 and @xmath1362 are the indices defining the two zero continued fractions corresponding to @xmath1226 .",
    "we define for @xmath773 @xmath1363,\\ ] ] for some @xmath1364 ( see proposition [ contfracpres ] ) .",
    "one can verify that @xmath1365\\ ] ] for some @xmath1366 with gcd@xmath1367 ; this is a property of the dual of continued fractions from wahl singularities ( see @xcite , 3.5 ) .",
    "the following is @xcite , lemma 3.4 .    given @xmath1368=\\frac{m^2}{ma-1}$ ] with @xmath1369 and gcd@xmath1144 , we define as in  [ toric ] the sequences @xmath1370 $ ] for @xmath1371 , and @xmath1372 $ ] for @xmath1373 .",
    "define @xmath1374 and @xmath1375 .",
    "let @xmath1376 for @xmath1377 .",
    "let @xmath1378 , @xmath1379 , @xmath1380 be the numbers for @xmath1381 $ ] .",
    "then @xmath1382 for @xmath1383 , and @xmath1384 .",
    "this lemma gives a way to compute @xmath260 for continued fractions of wahl singularities from the inductive procedure ( cf .",
    "@xcite , proposition 3.11 ) @xmath1190 \\to [ e_1 + 1,\\ldots , e_r,2]$ ] or @xmath1385 $ ] , starting with @xmath1386 $ ] . for @xmath1386",
    "$ ] one has @xmath1387 ; here @xmath1388 , @xmath1389 .",
    "thus for @xmath1390 $ ] we have @xmath1391 , and so on .",
    "therefore , the @xmath1392 s can be used to compute @xmath1393 from the continued fraction of @xmath1394 .",
    "start with @xmath1395 $ ] and assign @xmath88 for the first @xmath71 and @xmath88 for the last @xmath71 .",
    "for the new continued fraction we assign to the new @xmath71 the addition of the extremal previous assignations . to obtain @xmath205 from @xmath1190 $ ] , we just add the numbers assigned to @xmath1396 and to @xmath1397 . for @xmath1395",
    "$ ] we have @xmath1398 . for @xmath1399 $ ]",
    "we have @xmath1400 , for @xmath1401 $ ] @xmath1402 , for @xmath1403 $ ] @xmath1404 , etc .",
    "the continued fraction @xmath1405 where @xmath1406 for all @xmath130 , will be denoted by @xmath1407 .",
    "we have    @xmath1408    consider a sequence @xmath1409 of type ( a ) as above .",
    "we recall that for @xmath1410 we have indices @xmath1411 and an integer @xmath1412 .",
    "then @xmath1413 @xmath1414 [ deltalemma ]    the proof uses the inductive way to compute @xmath1415 for the continued fraction of @xmath1416 , and the numbers @xmath1417 defined before .",
    "the role of @xmath1418 is taken by @xmath1419 ( if @xmath1420 ) or @xmath1421 ( if @xmath1422 ) to compute @xmath1423 .",
    "we start with @xmath1424 $ ] and use @xmath1418 to obtain @xmath1425 $ ] .",
    "then use @xmath1426 to obtain @xmath1427 $ ] , and continue . during this process",
    "we keep track of the assigned multiplicities explained above .",
    "this defines the recursion @xmath1428 , @xmath1429 , @xmath1430 for @xmath1431 , and @xmath1432 . in this way , @xmath1433    we are going to compare the @xmath1392 s , but before another lemma .    [ magic ]",
    "let @xmath1434 be a matrix such that @xmath1435 .",
    "define matrices @xmath1436 consider an arbitrary sequence @xmath1437 , where @xmath1438 , and the matrix @xmath1439 ( which ends with @xmath49 or @xmath1440 depending on parity of @xmath1298 )",
    ". then    1 .",
    "@xmath1441 , where @xmath1442 is a polynomial which depends only on  @xmath324 .",
    "2 .   if @xmath1298 is even , the left - upper corner of @xmath1443 is equal to the left - upper corner of @xmath1444 , where @xmath1445 is a sequence given by @xmath1446 for any  @xmath1316 .",
    "the first statement follows by induction on @xmath1298 , where we can show , more precisely , that @xmath1447 if @xmath1298 is odd and @xmath1448 if @xmath1298 is even , where @xmath1449 and @xmath1450 are polynomials in @xmath324 only .    the second statement of the lemma follows from the first .",
    "indeed , in order to compute @xmath1442 we can assume that @xmath1451 is a symmetric matrix of determinant @xmath88 .",
    "then @xmath1452 ( and in particular their upper - left entries are the same ) , where @xmath1453 is a sequence obtained from @xmath1454 by reversing the order . on the other hand , we can also assume that @xmath1455 .",
    "then @xmath1442 is equal ( up to sign ) to the numerator of the hirzebruch ",
    "jung continued fraction with entries @xmath1456 . this numerator does not change if we reverse the order .",
    "we will show @xmath1457 case by case .",
    "some notation : a sequence @xmath1458 is a sequence of @xmath1459 , @xmath1460 is a sequence of integers , and @xmath1461 is the same sequence of integers but in reversed order .    *",
    "case i. * assume @xmath1259 and @xmath1422 , i.e. the counter - clockwise case .",
    "here we have @xmath1462 .",
    "one can check that for all @xmath1463 , @xmath1464 . by the formulas of lemma [ deltalemma ] , we have @xmath1457",
    ".    * case ii . *",
    "assume @xmath1259 and @xmath1420 , i.e. the clockwise case .",
    "we know that either @xmath1311 or @xmath1465 belongs to @xmath432 .",
    "assume that @xmath1466 .",
    "we also redefine @xmath1467 and @xmath1468 .",
    "then , the transposed formulas of lemma [ deltalemma ] are @xmath1469 and @xmath1470 for some @xmath1471 and @xmath1472 .",
    "but we know that @xmath1392 s are computed via the upper - left corner of the multiplication of the corresponding @xmath1473 matrices , and if @xmath1474 we can use lemma [ magic ] to prove @xmath1457 .",
    "we notice that @xmath1475    * case iii . * assume @xmath1259 , @xmath1420 , and that @xmath1476 .",
    "we also redefine @xmath1467 and @xmath1468 .",
    "then , the transposed formulas of lemma [ deltalemma ] are @xmath1477 and @xmath1478 for some @xmath1471 and @xmath1472 .",
    "so we do the same as in case ii , noticing that by lemma [ magic ] the use of @xmath49 or @xmath1440 does not change the @xmath1392 .",
    "* case iv . *",
    "assume @xmath1261 , @xmath1479 or @xmath1480 , and that @xmath1481 .",
    "then @xmath1482 . in this case @xmath1420 .",
    "one can verify that @xmath1483 for all @xmath1463 , and so by lemma [ deltalemma ] if @xmath1484 then @xmath1485 .",
    "this gives @xmath1457 .    * case v. * assume @xmath1261 , @xmath1479 or @xmath1480 , and that @xmath1202 is not in @xmath432",
    ". here @xmath1420 .",
    "this case can be treated as case ii .",
    "* case vi . *",
    "assume @xmath1261 , and that @xmath1329 .",
    "then via lemma [ deltalemma ] we have @xmath1486 and @xmath1487 . in the case @xmath1330",
    ", we would have @xmath1488 and @xmath1489 .",
    "therefore , in any case , @xmath1457 .",
    "let @xmath41 be the gieseker s moduli space of canonical surfaces of general type with given numerical invariants @xmath42 and @xmath43 .",
    "let @xmath44 be its compactification , the moduli space of stable surfaces of kollr , shepherd - barron , and alexeev . given a map @xmath45 from a punctured smooth curve germ , i.e.   a family @xmath46 of canonical surfaces , one is interested in computing its `` stable limit '' @xmath47 , perhaps after a finite base change .",
    "we would like to make more explicit a well - known algorithm for computing a stable limit under an extra assumption that the family @xmath46 can be compactified by a flat family @xmath48 , where the special fiber @xmath49 is irreducible , normal , and has quotient ( = log terminal ) singularities .",
    "we will show that the stable limit can be found using only flips and divisorial contractions from the extremal neighborhoods of type @xmath2 and @xmath1 of the previous sections .",
    "we are going to perform various operations on families ( e.g.  simultaneous partial resolutions ) which make it necessary to assume that the total space of the family is an algebraic space ( or an analytic space ) rather than a scheme , even if the total space of the original family is a scheme .",
    "however , our main applications are to moduli of surfaces of geometric genus  @xmath89 , in which case any flat family is projective , and therefore its total space is a scheme . so the reader can ignore this technicality .",
    "the next lemma shows that we can reduce our analysis to the case when @xmath48 is a @xmath129-gorenstein smoothing and the special fiber has wahl singularities only .",
    "this is a global version of the m - resolution @xcite of behnke and christophersen .",
    "let @xmath1490 be a flat family of irreducible reduced projective surfaces such that the special fiber has quotient ( = log - terminal ) singularities .",
    "there exists a finite morphism @xmath1491 , an analytic space  @xmath1492 , and a proper birational map @xmath1493 such that    1 .   the special fiber @xmath701 is irreducible and has wahl singularities .",
    "@xmath1492 has terminal singularities .",
    "3 .   @xmath1125 induces a minimal resolution of general fibers @xmath1494 .",
    "@xmath1495 is @xmath1125-nef .    by @xcite ,",
    "theorem 3.5 , we can choose @xmath1496 such that all properties above are satisfied except that @xmath701 is allowed to have arbitrary t - singularities ( i.e.  @xmath129-gorenstein smoothable quotient singularities ) . notice that locally on @xmath1497 this is nothing but a p - resolution .",
    "by @xcite , any singular point of @xmath1496 has an analytic neighborhood @xmath807 and a proper crepant map @xmath1498 ( a crepant m - resolution ) which has the properties required in the lemma , in particular the special fiber has wahl singularities only .",
    "gluing these resolutions gives the required analytic space .",
    "[ t3 ] assume we have a @xmath129-gorenstein smoothing @xmath1499 of a projective surface @xmath49 with only wahl singularities .",
    "suppose some positive multiple of @xmath1500 is effective .",
    "then , after a finite sequence of flips and divisorial contractions from extremal neighborhoods of type @xmath2 and @xmath1 ( with @xmath50 , as in proposition [ b2=1=>normal ] ) , we obtain a @xmath129-gorenstein smoothing @xmath1501 with @xmath1008 @xmath1125-nef .",
    "notice that @xmath1502 is nef if and only if @xmath1503 is @xmath1125-nef . indeed , suppose @xmath1504 for some curve in a general fiber . without loss of generality",
    "we can assume that @xmath1505 is a @xmath112-curve , and therefore deforms over @xmath1506 .",
    "since @xmath4 is @xmath129-gorenstein , @xmath1500 will intersect negatively one of the irreducible components of the central fiber of the closure of this family of @xmath112-curves .    to avoid issues with the fact that @xmath4 in general is not a variety",
    ", we will run a mmp on @xmath4 guided by a mmp on the special fiber .",
    "suppose @xmath1500 is not nef .",
    "then we have an extremal contraction @xmath1507 of log terminal surfaces , where the exceptional locus @xmath7 is an irreducible rational curve .",
    "singularities of @xmath273 are log terminal , and therefore rational . by blowing down deformations @xcite ,",
    "we get an extremal neighborhood @xmath64 of either divisorial or flipping type , and in the latter case the flip exists in the category of analytic spaces by @xcite .",
    "it remains to show that we only encounter flips ( or divisorial contractions ) of types @xmath2 and @xmath1 ( with @xmath50 ) .",
    "since @xmath273 has quotient singularities , we just have to rule out the possibility of having non cyclic quotient singularities .",
    "however , this is known by @xcite , pp .",
    "157159 , the proof that subcase ( 3c ) of page 154 does not occur .",
    "below we construct a stable surface @xmath49 which belongs to @xmath44 with @xmath145 and @xmath146 ( so @xmath1508 and @xmath1509 ) .",
    "the surface @xmath49 has two wahl singularities @xmath147 and @xmath148 , and no local - to - global obstructions to deform ( i.e. deformations of its singularities globalize to deformations of @xmath49 ) .",
    "we will show that a @xmath129-gorenstein smoothing of @xmath49 is a simply connected smooth projective surface of general type with the above invariants .",
    "this is the first example in the literature with those invariants and two wahl singularities , which is the maximum possible under no local - to - global obstructions .",
    "examples with one wahl singularity appeared in @xcite .",
    "we consider a @xmath129-gorenstein deformation of @xmath49 which preserves the singularity @xmath454 and smooths @xmath1510 . since this deformation is trivial around @xmath454 ,",
    "we resolve simultaneously @xmath454 to obtain a @xmath129-gorenstein smoothing of a surface with a single wahl singularity at @xmath1510 . on this deformation",
    "we explicitly run the mmp of theorem [ t3 ] .",
    "we do it for each @xmath97 .",
    "let us consider the cubic pencil @xmath1511 in @xmath1512 with @xmath1513 \\in \\p_{t_1,t_2}^1 $ ] .",
    "let @xmath1514 , @xmath1515 , @xmath1516 , @xmath1517 , and @xmath1518 . the curves @xmath198 and @xmath28 are tangent at @xmath1519 $ ] .",
    "this pencil defines an elliptic fibration @xmath1520 with singular fibers @xmath1521 ( kodaira s notation ; cf .",
    "@xcite , p. 201 ) , after we blow - up the nine base points .",
    "choose a nodal @xmath1522 fiber and denote it by @xmath1125 , and consider the line @xmath56 passing through the point @xmath1523 and the node of @xmath1125 .",
    "the line @xmath56 becomes a double section of @xmath66 .",
    "we blow up @xmath1524 times @xmath962 to obtain @xmath1525 .",
    "write @xmath1526 for the composition of these blow - ups .",
    "the curves @xmath1527 in figure [ f3 ] are the exceptional curves of @xmath1073 .",
    "the order of the blow - ups is indicated by the subindices of the @xmath1527 . in figure [ f3 ]",
    "we label all relevant curves for the construction .",
    "the self - intersections of all of them are in figure [ f4 ] .",
    "let @xmath1528 be the contraction of the configurations @xmath1529 and @xmath1530 .",
    "let @xmath454 be the image of @xmath1531 , so @xmath1532 and @xmath1533 .",
    "the surface @xmath49 has no local - to - global obstructions to deform .",
    "a @xmath129-gorenstein smoothing of @xmath49 is a simply connected projective surface of general type with @xmath145 and @xmath146 .",
    "the surface @xmath49 is a stable surface .",
    "[ p4 ]    according to @xcite , section 2 , if @xmath1534 , then @xmath49 has no local - to - global obstructions to deform .",
    "let @xmath1535 be the composition of blow - ups corresponding to @xmath1536 , @xmath1537 , and @xmath1538 .",
    "let @xmath7 be the general fiber of @xmath1539 , and let @xmath1540 .",
    "then @xmath1541 and so @xmath1542 . we can follow the strategy in @xcite to show @xmath1543 .",
    "relevant intersections are @xmath1549 , @xmath1550 , @xmath1551 , @xmath1552 , @xmath1553 , @xmath1554 , and @xmath1555 .",
    "this says that @xmath1500 is nef .",
    "in addition , note that the support of @xmath1544 above contains @xmath1125 , @xmath1556 , @xmath1536 , and @xmath1557 .",
    "this is the support of a fiber , and so @xmath1544 zero curves should be contained in fibers .",
    "there are no such curves .",
    "then by nakai - moishezon criterion we have @xmath1502 is ample , hence @xmath49 is stable .",
    "we clearly have @xmath1558 and @xmath1559 , and so for the general fiber of the smoothing .    to compute the fundamental group of the general fiber of a @xmath129-gorenstein smoothing of @xmath49",
    ", we follow the same strategy as in @xcite , theorem 3 .",
    "let us write @xmath1560 for two equivalent loops @xmath1561 in @xmath1562 .",
    "we refer to @xcite ( see pages 12 and 20 ) for the relations we will use among loops . in particular notice that for any loop @xmath1202 around @xmath1563 we have @xmath1564 , and for any loop @xmath1565 around @xmath1566 we have @xmath1567 .",
    "the relevant loops for us are : @xmath202 around @xmath1537 , @xmath203 around @xmath1538 , @xmath1568 around @xmath1569 , @xmath1570 around @xmath198 , @xmath1571 around @xmath56 , and @xmath1572 around @xmath1573 . because of @xmath1574 , we have @xmath1575 . in this way ,",
    "@xmath1576 in @xmath1562 . by @xcite",
    ", we have @xmath1577 , and so @xmath1578 . by @xcite",
    ", we also have @xmath1579 , and so @xmath1580 .",
    "because of @xmath1581 , we have the relation @xmath1582 , and so @xmath1583 .",
    "but , again by @xcite , we have @xmath1584 .",
    "hence , since @xmath1585 , we obtain @xmath1586 . therefore , the relation @xmath1579 implies @xmath1587 .",
    "but now we use @xmath1588 to have @xmath1589 , and so @xmath1590 .",
    "this together with @xmath1591 gives @xmath1592 .",
    "then @xmath1593 and @xmath1594 , and so @xmath1595 .",
    "the fact that @xmath1596 in @xmath1562 is enough to use directly the method in @xcite , to conclude that a @xmath129-gorenstein smoothing of @xmath49 is simply connected .    consider a @xmath129-gorenstein deformation of @xmath49 which preserves the singularity @xmath151 and smooths @xmath152 .",
    "let @xmath153 be the minimal resolution of @xmath239 .",
    "since this deformation is trivial around @xmath151 , we resolve minimally simultaneously @xmath151 to obtain a @xmath129-gorenstein smoothing @xmath1597 of @xmath153 .",
    "we are going to run theorem [ t3 ] on @xmath1597 . in general , we use the following notation to save writing when running the mmp of theorem [ t3 ] .    [ dualgraphs ] locally , let @xmath1598 be an extremal neighborhood of type @xmath2 or @xmath1 ( with @xmath50 ) .",
    "let @xmath1121 be the minimal resolution of @xmath49 .",
    "we remark that the proper transform @xmath1599 of @xmath7 is a @xmath112-curve .",
    "we have the following dual graph for the exceptional divisors and @xmath1600 .",
    "we draw @xmath1601 for the exceptional curves and a @xmath1602 for @xmath1600 , edges are the transversal intersections between curves . if @xmath1125 is divisorial , then we draw @xmath1601 for exceptional curves in the dual graph of the minimal resolution of @xmath273 .",
    "if @xmath1125 is flipping , we draw the dual graph of the exceptional curves in the minimal resolution of @xmath95 ( the surface corresponding to the extremal p - resolution ) and the proper transform @xmath1603 of @xmath16 , @xmath1601 for the exceptional and a @xmath1604 for @xmath1603 . numbers are minus the self - intersections of the curves , no number means @xmath112-curve .",
    "globally , let @xmath49 be a projective surface with wahl singularities , which has a @xmath129-gorenstein smoothing @xmath1605 .",
    "let @xmath1606 be its minimal resolution .",
    "we consider the dual graph of all exceptional divisors and some curves which may be used when we perform flips and divisorial contractions of @xmath4 . at the beginning",
    "we draw @xmath1601 for the exceptional curves and @xmath1607 for the rest .",
    "one of them is a @xmath1602 which defines the first birational operation ( locally as above ) .",
    "the operation is indicated with an arrow .",
    "the resulting dual graph is the minimal resolution of the new central fiber ( either @xmath273 or @xmath95 ) . when flipping a @xmath1604",
    "will appear , indicating the proper transform of the flipping curve .",
    "also , a new @xmath1602 will indicate the next birational operation .",
    "of course the new dotted graph depends on the computations of the previous sections , and they will be omitted .",
    "we start with the curve @xmath7 as in figure [ f5 ] .",
    "this curve defines a flipping extremal neighborhood of type @xmath2 @xmath1608 .",
    "( we use same letter for a curve and its proper transform . )",
    "we perform the flip and obtain @xmath1609 .",
    "this is our new central fiber . in figure [ f5 ]",
    "we show the action of the flip on the minimal resolutions of @xmath153 and @xmath95 .",
    "figure [ f6 ] shows the dual graphs ( as explained above ) for a sequence of flips and divisorial contractions starting with @xmath153 .",
    "the first arrow represents the situation in figure [ f5 ] . in order",
    "we have : two flips , two divisorial contractions and two flips .",
    "the three concurrent edges of the last graph represent a ( simple ) triple point .",
    "the general fiber of @xmath1610 is a rational surface . in this way",
    "the singularity @xmath239 labels a boundary curve in @xmath44 which generically consists of rational stable surfaces with only @xmath1611 as singularity .",
    "[ p5 ]          we now do it for @xmath241 .",
    "as before , consider a @xmath129-gorenstein deformation of @xmath49 which preserves the singularity @xmath152 and smooths @xmath151 .",
    "let @xmath154 be the minimal resolution of @xmath241 .",
    "since this deformation is trivial around @xmath152 , we resolve minimally simultaneously @xmath152 to obtain a @xmath129-gorenstein smoothing @xmath1612 of @xmath154 .",
    "we now perform @xmath1613 flips , the first @xmath1614 are of type @xmath2 and the last of type @xmath1 .",
    "the corresponding sequence of dual graphs is shown in figures [ f7 ] and [ f8 ] .",
    "( we clarify that in figures [ f7 ] and [ f8 ] there is one darker edge connecting a @xmath1615-curve and a @xmath1616-curve which are tangent .",
    "this is after the 9th flip . )",
    "we will prove that the canonical class of the last special fiber ( see lower right corner of figure [ f8 ] ) is nef . to save notation , we first contract the configuration @xmath1617 into @xmath1618 .",
    "let @xmath1619 be the resulting surface ( last special fiber ) , and let @xmath1620 be its minimal resolution . in figure [ f9 ] we show relevant curves in the blow - up of @xmath1620 at one point ( the corresponding @xmath112-curve is @xmath1621 ) .",
    "notice that the singular @xmath1619 has two t - singularities given by the configurations @xmath1622 and @xmath198 .",
    "the @xmath581 s in figure [ f9 ] are the exceptional curves to obtain the minimal initial elliptic fibration ( with singular fibers @xmath1521 ) from @xmath1623 .",
    "the @xmath180 s are the exceptional curves for the four further blow - ups needed to get @xmath1620 .",
    "notice we do not have the @xmath1624th blow - up associated to @xmath1621 .",
    "let @xmath1625 be the minimal resolution of both t - singularities , and let @xmath1626 be the composition of the @xmath1627 blow - ups . in that way , if @xmath1628 is the class of a line in @xmath1623 , then the canonical class of @xmath1620 is @xmath1629        we know that the @xmath129-gorenstein smoothing of @xmath1619 is simply connected with @xmath146 , and it has a @xmath1637 and a @xmath1616 smooth rational curves @xmath1638 and @xmath1639 respectively , coming from the singularity at @xmath152 . if @xmath38 is the general fiber of the @xmath129-gorenstein smoothing of @xmath1619 , then @xmath1640 , where @xmath1331 is the general fiber of the elliptic fibration of @xmath38 , and @xmath1641 are the multiplicities of the two multiple fibers . in this way , we find @xmath1642 and @xmath1643 using the equations @xmath1644 and @xmath1645 . therefore @xmath38 is a dolgachev surface of type @xmath1646 @xcite , p.383 .",
    "the general fiber of @xmath1612 is a dolgachev surface of type @xmath1646 which has a chain of four @xmath1139 s with consecutive self - intersections @xmath1637 , @xmath1616 , @xmath1615 , @xmath1615 . in this way",
    "the singularity @xmath241 labels a boundary curve in @xmath44 which generically parametrizes dolgachev surfaces of type @xmath1646 containing the exceptional divisor of @xmath1647 .",
    "[ p5 ]          w. p. barth , k. hulek , c. a. m. peters and a. van de ven , _ compact complex surfaces _ , ergebnisse der mathematik und ihrer grenzgebiete .",
    "3 . folge . , second edition , vol .",
    "4 , springer - verlag , berlin , 2004 .",
    "j. a. christophersen , _ on the components and discriminant of the versal base space of cyclic quotient singularities _ , singularity theory and its applications , part i(coventry , 1988/1989 ) , lecture notes in math .",
    "1462 , springer , berlin ( 1991 ) , 8192 .",
    "j. stevens , _ on the versal deformation of cyclic quotient singularities _ , singularity theory and its applications , part i(coventry , 1988/1989 ) , lecture notes in math .",
    "1462 , springer , berlin ( 1991 ) , 302319 ."
  ],
  "abstract_text": [
    "<S> we study semistable extremal @xmath0-fold neighborhoods , which are fundamental building blocks of birational geometry , following earlier work of mori , kollr , and prokhorov . </S>",
    "<S> we classify possible flips and extend mori s algorithm for computing flips of extremal neighborhoods of type @xmath1 to more general @xmath2 neighborhoods . </S>",
    "<S> the novelty of our approach is to show that @xmath2 belong to the same deformation family as @xmath1 , in fact we explicitly construct the universal family of extremal neighborhoods . </S>",
    "<S> this construction follows very closely mori s division algorithm , which can be interpreted as a sequence of mutations in the cluster algebra . </S>",
    "<S> we  identify , in the versal deformation space of a cyclic quotient singularity , the locus of deformations such that the total space admits a ( terminal ) antiflip . </S>",
    "<S> we show that these deformations come from at most two irreducible components of the versal deformation space . as an application </S>",
    "<S> , we give an algorithm for computing stable one - parameter degenerations of smooth projective surfaces ( under some conditions ) and describe several components of the kollr  shepherd - barron  alexeev boundary of the moduli space of smooth canonically polarized surfaces of geometric genus zero . </S>"
  ]
}