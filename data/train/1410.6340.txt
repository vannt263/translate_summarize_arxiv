{
  "article_text": [
    "the description of transport processes in soft matter usually makes use of partial differential equations that are typically non - linear .",
    "the equilibrium properties of the system are described with a free energy functional and the transport properties are described through conservation equations .",
    "a typical example of such partial differential equations ( pdes ) is @xmath0\\right ] \\label{pde}\\end{aligned}\\ ] ] that governs the dynamics of the concentration field @xmath1 .",
    "( [ pde ] ) has become the focus of dynamic density functional theory ( ddft ) for the study of dynamics of colloidal suspensions @xcite .",
    "the two quantities that enter this equation are the free energy functional @xmath2 $ ] and the mobility coefficient @xmath3 that may depend , in general , on the concentration field .",
    "the partial differential equation ( pde ) ( [ pde ] ) is paradigmatic in that it captures two essential features of a non equilibrium system . on one hand , being in divergence form , eq .",
    "( [ pde ] ) conserves the number of particles @xmath4 . on the other , it fulfill an h - theorem because the time derivative of @xmath2 $ ] is always negative provided that the mobility @xmath3 is positive .",
    "fluctuations are also relevant for soft matter and they are important when brownian motion , critical phenomena , transitions events , etc .",
    "are of interest . since the seminal work by landau and lifshitz @xcite , thermal fluctuations in a conservative pde are introduced phenomenologically through the divergence of a stochastic flux . for the particular example of the above non - linear diffusion equation , the stochastic partial differential equation ( spde ) has the form @xmath0\\right ] + \\boldsymbol{\\nabla}{\\!\\cdot\\!}\\tilde{\\bf j}({\\bf r},t ) \\label{spde}\\end{aligned}\\ ] ] where the stochastic mass flux @xmath5 is given by @xmath6 which obviously requires that @xmath7 , and @xmath8 is a white noise in space and time",
    ". we will discuss the stochastic interpretation of eq .",
    "( [ spde ] ) later on .",
    "this stochastic term ensures that the functional fokker - planck equation equivalent to ( [ spde ] ) has formally as invariant measure the canonical equilibrium functional probability distribution @xmath9 & = \\frac{1}{z}\\exp\\{-{\\cal f}[c]/k_bt\\ } \\nonumber\\\\ z&=\\int { \\cal d}c \\exp\\{-{\\cal f}[c]/k_bt\\ } \\label{peq}\\end{aligned}\\ ] ] where the partition function @xmath10 normalizes the probability distribution .",
    "fluctuating equations of the form ( [ spde ] ) have been considered in the ddft literature @xcite , where a debate on its physical meaning has arisen ( see ref .",
    "@xcite for a review ) .",
    "( [ spde ] ) has been used for the description of phase separation @xcite and critical phenomena , where it is known as model b in the terminology of ref .",
    "@xcite .",
    "despite the formal similarity between ( [ pde ] ) and ( [ spde ] ) they are very different kinds of equations , not only because one is deterministic and the other stochastic . as we will discuss in sec .",
    "[ sec : tocg ] , the symbols in eq .",
    "( [ pde ] ) and ( [ spde ] ) need to have different physical meaning . from a purely mathematical point of view",
    ", the very existence of an equation like ( [ spde ] ) or a functional like ( [ peq ] ) is a delicate point , due to the fact that the noise @xmath11 and the field itself @xmath1 are very irregular objects @xcite .",
    "for example , in the ginzburg - landau free energy model , the partition function @xmath10 in eq .",
    "( [ peq ] ) has a proper continuum limit in 1d but it is divergent in @xmath12 due to the so called ultraviolet catastrophe . in this latter case , renormalization group techniques have been used in order to recover a continuum limit @xcite .",
    "a rigorous mathematical analysis of the renormalization of spdes near the critical point has been conducted recently @xcite .",
    "alternatively , one may regularize the equation by introducing a physical coarse - graining length .",
    "this may take the form of regularization of the noise , e.g. replacing white noise with colored noise , or regularization of nonlinear terms @xcite .    from a computational point of view",
    ", the numerical solution of partial differential equations like ( [ pde ] ) always requires to convert the problem in continuum space into a problem in a discrete space , amenable of treatment with a computer .",
    "usual procedures for discretization rely on assigning values of the fields to nodes of a grid .",
    "we are interested in discretizations on _ arbitrary _ ( not necessarily regular ) grids because arbitrary grids can accommodate complex geometries and allow for adaptive spatial resolution .",
    "traditionally , the numerical solution of spdes of the kind ( [ spde ] ) have resorted to finite difference schemes @xcite , that are easy to implement in regular lattices . strictly speaking , though",
    ", a finite difference scheme for an spde like ( [ spde ] ) ( without regularization ) is meaningless in higher dimensions because taking the point - wise value of the field is not appropriate .",
    "instead , one can use a finite volume method , in which the discrete variables are the fields integrated over the cell volume @xcite . the resulting algorithm in regular grids",
    "looks like a finite difference method but the variables have very different meanings .",
    "while finite volumes may deal with adaptive resolutions and irregular grids @xcite , finite elements are often most natural when considering complicated boundary conditions .",
    "finite element methods for the solution of spdes are just beginning to be explored @xcite .    in this work ,",
    "we present a finite element discretization of ( [ pde ] ) that captures the two essential ingredients of exact conservation and fulfillment of the second law , and can be used in arbitrary grids .",
    "while this may be regarded as a standard exercise in numerical analysis , it is a preliminary step for the formulation of a finite element discretization of an spde like ( [ spde ] ) .",
    "we point out that an equation like ( [ spde ] ) requires an understanding of its microscopic underpinning and that ( [ spde ] ) _ is not _ just `` eq . ( [ pde ] ) with added thermal fluctuations ''",
    ".    equations ( [ pde ] ) and ( [ spde ] ) have been used for the description of colloidal suspensions out of equilibrium , and in the study of critical phenomena of fluids . in these fields , these equations correspond to coarse - grained ( cg ) descriptions of systems that at a microscopic level are made of particles governed by hamilton s equations .",
    "this is distinct from what happens in quantum field theory for which similar equations are regarded as the fundamental starting point @xcite .",
    "one natural question to pose when there is an underlying particle description is how to derive the above dynamic equations from the underlying microscopic dynamics of the system .",
    "the theory of coarse - graining ( tocg ) , also known as non - equilibrium statistical mechanics , or the mori - zwanzig formalism , is a well - established framework for the derivation of macroscopic equations from the underlying microscopic laws of motion @xcite .",
    "this theory allows one to obtain closed dynamic equations for a set of coarse variables which are functions of the microscopic state of the system . from the point of view of the tocg an equation like ( [ spde ] ) and , in general , any statistical field theory in soft matter only makes sense in discrete form and the partial differential equation _ appearance _ should be taken as a notational convenience @xcite .",
    "@xcite have explored ways in which the program of the tocg can be implemented for the case of statistical field theories , i.e. how the equations for the dynamics of stochastic fields may be `` deduced '' from the underlying microscopic dynamics of the constituent particles .",
    "understanding the microscopic basis of a mesoscopic equation like ( [ spde ] ) is essential in order to have well - defined _ hybrid _ methods in which a continuum - like description is coupled with a detailed microscopic description .",
    "one of the important messages that we would like to convey in the present paper is that there is a deep connection between `` numerical analysis '' and `` coarse - graining '' when applied to fluctuating fluid systems .",
    "indeed , from a microscopic point of view , the natural setting for a spde is a discrete one , where the cg hydrodynamic variables are defined on the nodes of a grid .",
    "the cg variables are defined by assigning to every node the mass ( momentum , energy ) of the molecules that are `` around '' that node .",
    "there are many possibilities for this attribution .",
    "the simplest one is giving the mass of a molecule to the nearest node giving rise to a voronoi cell partition of the molecules .",
    "this does not give physically sensible dynamic equations as we have shown in ref .",
    "another possibility is to use a finite element basis function defined on a triangulation @xcite .",
    "while this solves the pitfalls of the voronoi cell discretization , it corresponds to a lumped mass approximation of the corresponding continuum equations .",
    "here we present a third possibility that uses the conjugate basis function of the finite element basis functions , rendering microscopic equations that can be understood as petrov - galerkin discretizations of a continuum equation and , therefore , have an appropriate continuum limit .",
    "we discuss the microscopic basis of both eqs .",
    "( [ pde ] ) and ( [ spde ] ) within the framework of the mori - zwanzig formalism that provides microscopic expressions for all the objects in the equations and illustrates the different physical meaning of the symbols in each equation . after having formulated the discrete version of the spde , we present numerical simulations in one dimension , based on the ginzburg - landau model for the free energy and discuss the continuum limit for this model .",
    "as a first step for the discretization of the pde ( [ pde ] ) , we introduce two basis functions associated to the two operations involved in the process of discretizing a pde .",
    "the first is a discretization operation in which a _ continuum field _",
    "@xmath1 is reduced to a _",
    "discrete field _ , defined as a set of discrete values @xmath13 , where each value @xmath14 is assigned to a position @xmath15 of a node in a mesh of @xmath16 points .",
    "the second process is that of transforming a discrete field into a continuum field , an operation also understood as interpolation . in the first process information",
    "is destroyed while in the second it is created .",
    "these two operations are implemented in the present work through a set of two ( dual or reciprocal ) basis functions @xmath17 the functions @xmath18 are localized around the node point @xmath15 .",
    "the discretization of the continuum field is given by @xmath19 where we introduce the scalar product as @xmath20 whereas the interpolation of the discrete field is given by the field @xmath21 . in component form",
    "we have @xmath22 a natural requirement to be satisfied by the two operations of discretizing and interpolating is that the result of interpolating a discrete field and then discretizing the resulting interpolated field should give the original discrete field .",
    "it is straightforward to show that this requirement implies the mutual orthogonality of the basis functions @xmath23 we will further assume that the interpolation basis @xmath24 is _ linearly consistent _ , meaning @xmath25    in the present paper , we will choose for @xmath26 the standard linear basis function of the finite element on node @xmath27 that do satisfy the linear consistency .",
    "the finite element is constructed from a triangulation of the grid like , for example , the delaunay triangulation .",
    "[ fig : delaunay1d ] shows the functions @xmath28 for three neighbor cells in 1d .",
    "the linear basis functions @xmath28 in 1d .",
    "each node @xmath29 has two elements , @xmath30 and @xmath31 shared with its neighbor nodes . ]",
    "the conjugate basis functions @xmath32 in 1d in a regular lattice with total length @xmath33 and @xmath34 nodes . ]",
    "we further assume that the basis functions @xmath35 are given as linear combinations of the basis functions @xmath36 , this is @xmath37 where the matrices @xmath38 and @xmath39 are inverse of each other and , thanks to eq .",
    "( [ projection0 ] ) , are given by @xmath40 fig .",
    "[ fig : delaunay1ddelta ] shows the resulting functions @xmath32 .",
    "in general , the result of discretizing a field @xmath41 and then interpolating this discrete field gives a continuum field @xmath42 which is different from the original field @xmath41 , except for some particular fields .",
    "for linearly consistent basis functions , these particular fields are linear fields of the form @xmath43 with @xmath44 constant .",
    "mathematically , we may express these operations as convolutions @xmath45 where the smoothing kernel is defined as @xmath46 this smoothing operator satisfies @xmath47 and its effect on linear functions is much the same as the dirac delta function . for future reference",
    ", we note that the first equation in ( [ smoothprop ] ) can also be written as the partition of unity property @xmath48 where we have introduced the volume associated to node @xmath15 as @xmath49      a general method for discretizing partial differential equations is the weighted residual method @xcite . with the use of two different sets of basis functions ,",
    "the method is known as the petrov - galerkin method .",
    "the idea of weighted residuals is to approximate the actual solution @xmath1 of the pde with its smoothed version @xmath50 , in such a way that @xmath51 where now @xmath52 become the unknown of the problem .",
    "one defines the residual of the pde ( [ pde ] ) as the result obtained after substitution in eq .",
    "( [ pde ] ) of the approximate field ( [ closure ] ) @xmath53\\right]\\end{aligned}\\ ] ] by weighting the residual with weights @xmath54 and requiring the weighted residual to vanish we obtain @xmath55\\right]\\right ) \\nonumber\\\\ & = -\\left(\\boldsymbol{\\nabla}\\boldsymbol{\\delta},\\gamma(\\overline{c}({\\bf r},t ) ) \\boldsymbol{\\nabla } \\frac{\\delta { \\cal f}}{\\delta c}[\\overline{c}(t)]\\right ) \\label{wrnol}\\end{aligned}\\ ] ] where an integration by parts has been performed .",
    "formally , eq . ( [ wrnol ] ) is a set of @xmath16 ordinary differential equations for the @xmath16 unknowns @xmath56 .",
    "it is apparent that we can not proceed until we have a way to compute the functional derivative @xmath57 . to this end",
    "_ define _ the discrete free energy function @xmath58 as @xmath59 \\label{fdef}\\end{aligned}\\ ] ] this is , the free energy _ function _ of the discrete field @xmath60 is obtained by evaluating the free energy _",
    "functional _ at the interpolated field . what we need",
    ", though , is not a discrete approximation for the functional , but a discrete approximation for its functional derivative .",
    "by using the functional chain rule we may compute the derivative of the function ( [ fdef ] ) @xmath61\\psi_\\mu({\\bf r } ' ) \\label{fder}\\end{aligned}\\ ] ] let us multiply eq .",
    "( [ fder ] ) with the basis function @xmath54 @xmath62 s({\\bf r},{\\bf r } ' ) \\label{funcder}\\end{aligned}\\ ] ] where the smoothing kernel @xmath63 is defined in ( [ smoothing ] ) .",
    "we will assume that the functional derivative does not change appreciably within the range of @xmath64 .",
    "in this case , we may simply write from eq .",
    "( [ funcder ] ) @xmath65 s({\\bf r},{\\bf r } ' ) & \\approx \\frac{\\delta   { \\cal f}}{\\delta c({\\bf r } ) } \\left[\\boldsymbol{\\psi}{\\!\\cdot\\!}{\\bf c}\\right ] \\label{funcderapp}\\end{aligned}\\ ] ] and , therefore , we have an approximate expression for the functional derivative @xmath66 = \\frac{\\delta { \\cal f}}{\\delta c({\\bf r})}\\left[\\boldsymbol{\\psi}{\\!\\cdot\\!}{\\bf c}\\right ] & \\approx \\boldsymbol{\\delta}({\\bf",
    "r}){\\!\\cdot\\!}\\frac{\\partial f } { \\partial { \\bf c}}({\\bf c } ) \\label{funcder2}\\end{aligned}\\ ] ] we may introduce ( [ funcder2 ] ) into ( [ wrnol ] ) and obtain @xmath67 where the dissipative matrix has the elements @xmath68 the matrix @xmath69 is manifestly symmetric and positive semi - definite because @xmath70 ( the semi character is due to ( [ voldelta ] ) ) .",
    "the total number of particles , defined as @xmath71 is a dynamical invariant of the equation ( [ cfinok ] ) .",
    "the time derivative of the discrete free energy @xmath72 , which is given by @xmath73 is always negative or zero , because @xmath74 is semi - positive definite .",
    "therefore , we have obtained in eq .",
    "( [ cfinok ] ) a discrete version of the non - linear diffusion equation ( [ pde ] ) that captures the two essential features about conservation of the number of particles and the second law .",
    "as we will see , the fact that the diffusion matrix is positive definite in this scheme is crucial in order to construct discrete versions of spde . indeed , the fulfillment of the second law in the form of an h - theorem in the discrete setting is intrinsicly linked to the possibility of describing thermal fluctuations .    the only approximation that we have taken is that the functional derivative of the free energy functional hardly changes in the range of @xmath63 defined in eq .",
    "( [ smoothing ] ) .",
    "we have plotted this function in fig .",
    "[ figd ] and observe that if the average lattice spacing is much smaller than the length scale of variation of the field , then the approximation ( [ funcder2 ] ) will be appropriate .",
    "of course , this argument holds for the deterministic setting where the fields are smooth . in a stochastic",
    "setting as set forth later in the paper , for which , in general , the fields are extremely irregular the procedure should be understood not as an approximation but rather as a _ definition _ of the discrete model itself .",
    "plot of @xmath75 in a 1d lattice with length @xmath33 and lattice spacing @xmath76 .",
    "the function @xmath75 is appreciably different from zero only for points differing by a few ( 2 or 3 ) lattice spacings . ]",
    "the form ( [ dfin ] ) for the dissipative matrix involves a space integral that needs to be computed explicitly in order to introduce it in a computer code . note that the mobility depends on the position through its dependence on the concentration field and , therefore",
    ", such space integrals are not immediate .",
    "we will use the following approximation @xmath77 in such a way that the mobility function at the interpolated field is approximated by a linear interpolation of the mobility function at the nodes .",
    "the approximation is exact for the points @xmath78 .",
    "it is expected that this approximation is appropriate for smooth functions @xmath3 provided that the mesh size is sufficiently small . with the approximation in eq .",
    "( [ approx ] ) , the dissipative matrix ( [ dfin ] ) becomes @xmath79 the integral is a geometric object readily computable as we show in what follows .",
    "for the linear finite elements @xmath26 , we may explicitly compute the gradient of the basis functions @xmath80 where @xmath81 is the characteristic function of the sub - element @xmath82 .",
    "the gradient of the basis function @xmath36 is a constant vector @xmath83 for those points @xmath84 that are within the sub - element @xmath85 of node @xmath29 @xcite . in fig .",
    "[ fig : delaunay1d ] we show the sub - elements @xmath82 of the node @xmath29 in 1d while in fig .",
    "[ fig2 ] we show the sub - elements @xmath82 of the node @xmath29 and the corresponding vectors @xmath83 in 2d .    by using ( [ nabladelta ] )",
    "we have @xmath86 where we have introduced the mobility @xmath87 of the element @xmath82 as @xmath88 and represents a weighted average of the mobility associated to the nodes @xmath89 that are the vertices of the element @xmath82 .",
    "we have introduced the volume of element @xmath82 and the geometric ratio @xmath90 as @xmath91 in the simulations presented in this paper , we will assume that the mobility @xmath92 is a constant , where @xmath93 is a constant diffusion coefficient and @xmath94 is the equilibrium value of the concentration field .",
    "in this case , the dissipative matrix ( [ ddeltamunu2 ] ) is simply @xmath95 where the stiffness matrix @xmath96 is given by @xmath97",
    "up to now , the derivation of the discrete equation ( [ cfinok ] ) out of the pde ( [ pde ] ) has been an exercise in numerical analysis . in this section",
    ", we argue that a microscopic view to the problem shows that there is more physics in ( [ cfinok ] ) than this mathematical operations suggest . in the tocg",
    "the first and crucial step is the selection of the ( slow ) cg variables while the theory takes care automatically of the resulting dynamic equations .",
    "we will see in this section that the above numerical analysis suggests _ the appropriate definition of the cg variables _ in the tocg in order to recover , from microscopic grounds , a discrete equation governing the cg variables identical to ( [ cfinok ] ) which , by construction , is compatible with a continuum limit .    by using the tocg , the non - linear diffusion equation ( [ pde ] ) can be obtained from microscopic principles for the description of the dynamics of a colloidal suspension , as shown in ref .",
    "one chooses as relevant variable the empirical or instantaneous concentration @xmath98 where @xmath99 is the microscopic state of the system and @xmath100 is the position of the @xmath101-th colloidal particle .",
    "the tocg allows to obtain an exact equation for the ensemble average @xmath102 of @xmath103 , where the average is over the solution of the microscopic liouville equation .",
    "the resulting exact equation is non - local in space and in time . under the assumption that the concentration evolves very slowly",
    "as compared with any other variable in the system , the exact integro - differential equation becomes an approximate local in time equation .",
    "a further approximation in which the space non - locality of the diffusion kernel is neglected , leads to eq .",
    "( [ pde ] ) @xcite .",
    "the average @xmath102 is just the probability density of finding ( any ) one colloidal particle ( i.e. its center of mass ) at the point @xmath104 of space .",
    "the free energy functional @xmath2 $ ] and the mobility @xmath3 have both expressions in terms of the hamiltonian dynamics of the underlying system .",
    "in particular , the mobility is given in terms of a green - kubo expression ( not shown here ) while @xmath2 $ ] is the standard free energy density functional familiar from liquid state theory @xcite @xmath105&=-k_bt\\ln \\int dz \\rho^{\\rm eq}(z)\\exp\\left\\{-\\int d{\\bf r}\\lambda({\\bf r } )   \\hat{c}_{\\bf r}(z)\\right\\ } \\nonumber\\\\ & -\\int d{\\bf r}\\lambda({\\bf r})c({\\bf r } ) \\label{dft}\\end{aligned}\\ ] ] where @xmath106 is the equilibrium canonical ensemble of the system with hamiltonian @xmath107 , @xmath99 denoting the microstate , i.e. positions and momenta of all the atoms of the system .",
    "the lagrange multiplier @xmath108 is fixed by the condition @xmath109&=\\lambda({\\bf r})\\end{aligned}\\ ] ] that connects in a one to one manner the lagrange multiplier @xmath108 , usually referred to as the chemical potential , and the average value @xmath110 of ( [ hatc ] ) .",
    "note that eq .",
    "( [ pde ] ) describes a dynamics in which @xmath111 $ ] always decreases , while keeping the number of particles fixed .",
    "the final equilibrium profile is then obtained after a constrained maximization of @xmath2 $ ] with the result that the equilibrium concentration field is such that the chemical potential @xmath112 is constant in space .",
    "instead of using the relevant variables ( [ hatc ] ) we may use the number of colloidal particles per unit volume at the mesh node @xmath27 as input for the tocg .",
    "these relevant variables are @xmath113 the function @xmath114 is assumed to be localized around the mesh node @xmath15 and , therefore , the function @xmath115 counts the number of colloidal particles that are around @xmath27 .",
    "different functional form have been proposed for @xmath35 , ranging from a function defined in terms of a finite number of fourier modes @xcite to the characteristic function of the voronoi cell around @xmath116 ( divided by the volume of the cell ) @xcite . as we have discussed in ref .",
    "@xcite , the resulting dynamic equations are not well behaved for the voronoi cells .",
    "motivated by the previous section , in the present paper we choose @xmath35 to be the basis function dual to the finite element basis function @xmath117 .",
    "the proposal for @xmath35 in the present paper differs from our previous proposal @xcite where we used @xmath118 .",
    "the former selection is equivalent to a lumped mass approximation in which the mass matrix is approximated by a diagonal matrix , and is reasonable for regular lattices .",
    "a lumped mass approximation does not satisfy the natural requirement leading to the orthogonality in eq .",
    "( [ projection0 ] ) and for this reason we will use the dual @xmath119 given in ( [ lcdelta ] ) . as the resolution increases and the number of node points @xmath116 increases , the support of the function @xmath119 is reduced and this function converges weakly to the dirac delta function . in the high resolution limit ( @xmath120 ) the function ( [ hatcmu ] ) converges weakly to ( [ hatc ] ) .",
    "note that due to ( [ voldelta ] ) , the relevant variables ( [ hatcmu ] ) satisfy @xmath121 irrespective of the value of the microstate @xmath99 .",
    "the variables @xmath115 change stochastically as a result of the stochastic motion of the underlying colloidal particles .    in the next two subsections",
    ", we present the results obtained from the tocg regarding the dynamics for the averages @xmath122 of the discrete variables ( [ hatcmu ] ) and for the distribution function @xmath123 of these variables ( or the corresponding sde ) .",
    "these dynamic equations are ( [ cgcdot ] ) for the average value of the discrete @xmath124 and ( [ eq : sdedisc ] ) for the fluctuating variables , and are the discrete versions of ( [ pde ] ) and ( [ spde ] ) , respectively .",
    "the tocg allows us to obtain closed equations of motion for the time dependent _ ensemble average _",
    "@xmath125 of the discrete variables ( [ hatcmu ] ) . in this case , one obtains @xmath126 the _ renormalized _ diffusion matrix @xmath127 is given by a green - kubo formula ( not shown here ) .",
    "renormalized _ free energy function @xmath128 is defined as @xmath129 the conjugate parameters @xmath130 are in one to one connection with the discrete field @xmath122 through the relation @xmath131    the equation of motion ( [ cgcdot ] ) obtained microscopically has the same structure as the discretized eq .",
    "( [ cfinok ] ) .",
    "in fact , the symbol @xmath56 in these two equations has the same physical meaning because the relevant variables ( [ hatc ] ) and ( [ hatcmu ] ) are related linearly @xmath132 therefore , a natural question is : what is the connection between the discrete free energy @xmath133 defined `` numerically '' from the free energy functional @xmath2 $ ] through eq .",
    "( [ fdef ] ) and the renormalized free energy function @xmath134 defined `` physically '' in eq .",
    "( [ fdress ] ) ? in the remaining of this section",
    "we show that @xmath135 in the limit of high resolution .",
    "the idea is as follows .",
    "we have two levels of description , level 1 given in terms of the relevant variables @xmath103 and a more coarse - grained level 2 given in terms of the relevant variables @xmath136 .",
    "because the relevant variables of these two levels of description are related linearly , i.e. eq . ( [ cc ] ) , the bridge theorem @xcite , also known as the contraction principle in large - deviation theory @xcite , applies and the free energy of level 2 is obtained from that of level 1 , by maximizing @xmath111 $ ] subject to a given @xmath124 .",
    "we extremize without restriction @xmath105-\\boldsymbol{\\lambda}{\\!\\cdot\\!}\\int d{\\bf r}\\boldsymbol{\\delta}({\\bf r } ) c({\\bf r } ) + \\mu\\int d{\\bf r}c({\\bf r})\\end{aligned}\\ ] ] the maximizer @xmath137 of this functional depends on the lagrange multipliers @xmath138 which are fixed by requiring the constraints @xmath139 therefore , the maximizer @xmath140 depends implicitly on @xmath122 .",
    "the bridge theorem ensures that the free energy of level 2 is obtained when we evaluate the free energy of level 1 at @xmath140 @xmath141 \\label{exact}\\end{aligned}\\ ] ] this is an exact result .",
    "we now show that @xmath142 as the resolution increases . to this end",
    ", we write @xmath143",
    "where therefore , the error field @xmath144 defined through this equation is the difference between the solution @xmath145 and the interpolated field . by inserting ( [ c * ] ) into ( [ exact ] )",
    "we obtain @xmath146={\\cal f}[\\boldsymbol{\\psi}{\\!\\cdot\\!}{\\bf c}+{\\cal \\epsilon } ] \\nonumber\\\\ & = { \\cal f}[\\boldsymbol{\\psi}{\\!\\cdot\\!}{\\bf n}]+\\int d{\\bf r}{\\cal \\epsilon}({\\bf r } ) \\frac{\\delta { \\cal f}}{\\delta c({\\bf r})}[\\boldsymbol{\\psi}{\\!\\cdot\\!}{\\bf c}]+\\cdots",
    "\\nonumber\\\\ & = \\overline{f}({\\bf c})+\\int d{\\bf r}{\\cal \\epsilon}({\\bf r } ) \\frac{\\delta { \\cal f}}{\\delta c({\\bf r})}[\\boldsymbol{\\psi}{\\!\\cdot\\!}{\\bf c}]+\\cdots \\label{exact2}\\end{aligned}\\ ] ] now we show that @xmath147 is vanishingly small in the high resolution limit .",
    "the solution field @xmath137 has to fulfill the restriction ( [ norm ] ) and , therefore , we have @xmath148 the orthogonality of the basis functions ( [ projection0 ] ) implies that @xmath149 and the error field converges weakly to zero .",
    "as we increase the resolution , the functions @xmath35 become more and more localized , implying that the function @xmath150 is vanishingly small in the high resolution limit . in this limit , therefore , the renormalized free energy in the cg method @xmath128 can be obtained in a simpler way not through the exact eq .",
    "( [ exact ] ) , but rather through the simpler recipe ( [ fdef ] ) .",
    "this is very convenient because there are many good approximate free energy density functionals @xmath111 $ ] available in the literature .",
    "note that the above argument applies for arbitrary functionals , in general non - local .",
    "non - locality arises usually in models for free energy functionals due to the appearance of smoothed concentration fields that involve integrals of the concentration field with weight functions @xcite . as we show in appendix [ ap : approx - nonlinear ] for the case of the exact 1d percus free energy functional for hard rods , there is no problem in dealing with these non - local functionals with the recipe ( [ fdef ] ) .",
    "nevertheless , in the present paper we will not consider these non - local functionals since considering non - locality only in the free - energy functional but not in the mobility operator is not physically consistent . at the same time , a detailed microscopic understanding of non - local mobility operators ( and thus non - local noise correlations ) is lacking and requires a careful study in the future .",
    "we now justify the spde ( [ spde ] ) from a physical perspective along the lines in the previous section .",
    "the first question to address is the physical meaning to be assigned to the symbol @xmath102 in eq .",
    "( [ spde ] ) .",
    "it can not be `` the probability density of finding a colloidal particle at @xmath151 at time @xmath152 '' as in eq .",
    "( [ pde ] ) , because in ( [ spde ] ) @xmath1 is an intrinsicly stochastic field and can not be a `` fluctuating probability '' . except for non - interacting brownian walkers , eq .",
    "( [ spde ] ) can not be understood as an equation governing the dynamics of the spiky field ( [ hatc ] ) and even in this case , ( [ spde ] ) can only be interpreted formally @xcite .",
    "there has been a lot of debate about the meaning of fluctuating equations in the field of ddft @xcite .    clearly , in order to speak about `` fluctuations in the number of particles per unit volume '' one needs to use the variables ( [ hatcmu ] ) as relevant variables and consider the time dependent probability distribution @xmath153 that the phase functions @xmath154 in ( [ hatcmu ] ) take particular values @xmath60 . from the tocg it is possible to obtain an exact integro - differential equation for @xmath155 .",
    "after the assumption of clear separation of time scales between the evolution of the concentration and any other variable in the system , one obtains the following fokker - planck equation that governs @xmath156 @xmath157\\right\\ } \\label{eq : fpe}\\end{aligned}\\ ] ] the _ bare _ diffusion matrix @xmath158 is defined in terms of a green - kubo expression ( not shown ) and satisfies @xmath159 where @xmath160 is the volume associated to cell @xmath29 .",
    "the _ bare _ @xmath161 is , in general , a quantity different from the renormalized @xmath162 in eq .",
    "( [ cgcdot ] ) .",
    "the _ bare _ free energy @xmath163 is defined from the equilibrium distribution of ( [ eq : fpe ] ) @xmath164 where @xmath165 is the normalization .",
    "the dirac delta contribution reflects the mass conservation ( [ forall ] ) and ensures that the probability vanishes for those concentration fields that do not have exactly @xmath166 particles .",
    "note that microscopically , the equilibrium distribution function is given by the phase space integral @xmath167 the bare free energy @xmath163 is , in general , a function of @xmath168 which is different from the renormalized free energy @xmath128 since its microscopic definition is different ( see additional discussion below ) .",
    "the difference between the two is expected to be larger the larger the fluctuations are ( i.e. , the smaller the coarse - graining cells are ) .    the ito stochastic differential equation ( sde ) corresponding to",
    "the fpe ( [ eq : fpe ] ) is @xmath169 where the term proportional to @xmath170 is a reflection of the ito stochastic interpretation of this sde . here",
    "@xmath171 is a linear combination of wiener processes that has the covariance structure @xmath172      we have obtained , from the tocg the two dynamic equations , ( [ cgcdot ] ) for the average of the discrete variables ( [ hatcmu ] ) , and ( [ eq : sdedisc ] ) for the fluctuating dynamics of these discrete variables .",
    "the structure of ( [ cgcdot ] ) is formally identical to the finite element discretization of ( [ pde ] ) .",
    "this suggests that the continuum limit of the microscopically derived ( [ cgcdot ] ) is well - defined and given by ( [ pde ] ) . in this way ,",
    "the definition ( [ hatcmu ] ) of the cg variables with the appropriate basis functions is crucial in order to obtain discrete equations with proper continuum limit .",
    "the discussion of the continuum limit of the stochastic equation ( [ eq : sdedisc ] ) is more subtle and given below .",
    "the tocg is extremely useful as it gives the structure of the equations ( [ pde ] ) , ( [ cgcdot ] ) , and ( [ eq : sdedisc ] ) , but it remains formal because the microscopic expressions for the objects appearing in these equations @xmath173,\\hat{f}({\\bf",
    "c}),\\overline{f}({\\bf     c})$ ] and @xmath174 are too complex to be evaluated explicitly .",
    "some general features may be inferred , though .",
    "for example , there exists an exact connection between the bare and renormalized free energies , which can be obtained by inserting the identity @xmath175 inside eq .",
    "( [ fdress ] ) and using eqs .",
    "( [ peq1 ] ) , ( [ einsdisc ] ) .",
    "the result is @xmath176    both the renormalized @xmath128 and bare @xmath177 free energies depend in a non - trivial way on the cell size , introduced implicitly through @xmath119 in the definition of the cg variable @xmath122 in eq .",
    "( [ hatcmu ] ) .",
    "we have shown in the previous section that the renormalized free energy @xmath128 may be obtained from the standard free energy functional @xmath2 $ ] according to @xmath178 $ ] , in the high resolution limit .",
    "it is , therefore , legitimate to ask whether there exists a bare free energy _",
    "functional _ @xmath179 $ ] such that the bare free energy _ function _ may be also written in the form @xmath180 $ ] . unfortunately , the answer is not straightforward .",
    "for example , looking at the high resolution limit of ( [ fhatf ] ) makes not much sense because in the continuum limit the variables ( [ hatcmu ] ) become spiky like in ( [ hatc ] ) and the dirac delta function @xmath181 gives a probability @xmath182 that is non - zero only for spiky fields , parametrized with the position of the particles .",
    "in fact , this probability is given , up to particle permutations , by the gibbs ensemble @xmath183 .",
    "for non - interacting particles , in this limit ( [ spde ] ) becomes simply a formal rewriting of the underlying particle dynamics @xcite . in that limit ( [ fhatf ] )",
    "falls back to ( [ fdress ] ) which is a trivial result .",
    "in addition , the separation of time scales underlying the markov approximation and the fpe is expected to fail in the high resolution limit .    on the other hand ,",
    "in lower resolution situations , when we expect to have typically many particles per cell and the equilibrium probability ( [ peq1 ] ) should remain highly peaked , we may compute the integral in ( [ fhatf ] ) with a saddle approximation , giving @xmath184 up to an irrelevant constant .",
    "this equation would allow one to find the functional form of the bare free energy @xmath163 should the renormalized free energy @xmath185 be known .",
    "of course , for low resolutions ( large cell volumes ) , we do not know in general the functional form of the renormalized free energy . only for single phase systems with known macroscopic thermodynamics",
    "one may use local models for the free energy functional in terms of the macroscopic free energy density @xmath186 of the form @xmath187    this leaves us in the position of having to _ model _ the bare free energy @xmath188 . in the present paper",
    ", we will model the bare free energy according to the prescription @xmath189 \\label{barefdef}\\end{aligned}\\ ] ] for a supposedly known bare free energy functional @xmath190 $ ] .",
    "with this , we are assuming that all `` resolution dependent features '' of the probability @xmath191 in eq .",
    "( [ peq1 ] ) can be dealt with a single functional @xmath179 $ ] .",
    "whether the actual probability @xmath192 is accurately given by such a model is a completely open question that we do not address in the present work ( see @xcite,@xcite ) .",
    "however , this is current practice in the literature starting from , for example , the seminal work by van kampen s on the calculation of @xmath182 for a van der waals fluid @xcite .",
    "he used for @xmath35 the voronoi characteristic function and obtained an approximate expression for @xmath193 that is written without much explanation in a continuum form ( see eq .",
    "( 13 ) of ref .",
    "such a happy transition from discrete world to continuum notation is usual @xcite but not exempt of potential problems .",
    "the natural question to ask is whether a sequence of equations like ( [ eq : sdedisc ] ) , with a given model for the bare free energy functional @xmath179 $ ] has a `` continuum limit '' as we increase the resolution , in such a way that a proper meaning can be given to an equation like ( [ spde ] ) .",
    "even if such a continuum limit is obtained , we should expect that , in general , the bare free energy functional @xmath179 $ ] will not be the same as the usual free energy functional @xmath194 $ ] in eq .",
    "( [ dft ] ) .",
    "in particular , note from ( [ fhatf ] ) that @xmath111 $ ] is always a convex functional even though @xmath195 $ ] needs not to be convex .",
    "the bare and renormalized diffusion matrices @xmath196 , @xmath197 are given in terms of green - kubo expressions and depend in general on the state @xmath122 .",
    "they are , in principle , different quantities . however , for the sake of simplicity , in the present paper we assume that the bare diffusion matrix @xmath198 has the same structure as the renormalized diffusion matrix @xmath199 in eq .",
    "( [ ddeltamunub ] ) .",
    "furthermore , in the simulation results to be presented below , a constant mobility will be assumed .",
    "the actual form of the diffusion matrix determines the form of the noise terms through eq .",
    "( [ fd ] ) .",
    "the problem that we solve in the present section is how to compute explicitly the stochastic forces @xmath200 satisfying ( [ fd ] ) .",
    "we need to find the particular linear combination of wiener processes that lead to eq .",
    "( [ fd ] ) . a brute - force calculation of the square root matrix of the diffusion matrix @xmath201",
    "is very costly computationally , especially if it depends on the state @xmath122 @xcite .",
    "instead , we propose an explicit formula inspired by the very structure of the random term ( [ j ] ) in the continuum equation . alternatively ,",
    "we may look at the explicit structure of the so called _ projected currents _ that enter the green - kubo expression @xcite . in both cases , we obtain the same result that we detail below .",
    "recall that in the weighted residual procedure we multiplied the pde with @xmath35 and integrated over space .",
    "if we do this for the stochastic term @xmath202 in eq .",
    "( [ j ] ) we obtain @xmath203 the correlations of the noises ( [ czeta ] ) are easily computed under the assumption that @xmath204 is a white noise in space and time , satisfying @xmath205 the result is @xmath206 and , therefore , ( [ czeta ] ) has the desired covariances ( [ fd ] ) .",
    "however ( [ czeta ] ) involves the white noise @xmath204 and an integral over the whole space while what we are looking for is a linear combination of a finite number of independent wiener processes . by using the result ( [ nabladelta ] ) in ( [ czeta ] ) , and taking",
    "the same approximation for the mobility that lead to ( [ mobe1 ] ) leads us to _ postulate _ the following linear combination of white noises @xmath207 here @xmath208 is an independent white noise associated to the element @xmath82 in the triangulation , satisfying @xmath209 it is a simple exercise to show that the covariance of the noises ( [ eq : finalnoise ] ) satisfies eq .",
    "( [ fd ] ) . the random term ( [ eq : finalnoise ] )",
    "respects mass conservation in the sense that @xmath210 to prove this , one needs to use @xmath211 , which is obtained from the definition ( [ lcdelta ] ) and the property ( [ voldelta ] ) , and @xmath212 .",
    "colloidal suspensions that may phase separate in liquid - vapor phases @xcite may be described by a van der waals free energy functional . near the critical point ,",
    "the van der waals free energy may be approximated by a ginzburg - landau model , as shown in appendix [ ap : free ] .",
    "the bare free energy functional that we will consider in the present paper is the ginzburg - landau ( gl ) free energy @xmath213 & =   k_b t\\int d{\\bf r}\\ , \\left\\lbrace \\frac{r_0}{2}\\phi({\\bf r})^2   + \\frac{k}{2 }   \\left(\\nabla \\phi({\\bf r})\\right)^2\\right\\rbrace \\nonumber\\\\ & + k_b t\\int d{\\bf r}\\ ,   \\frac{u_0}{4 } \\phi({\\bf r})^4   \\label{eq : glfefunctional}\\end{aligned}\\ ] ] where @xmath214 and @xmath94 is the equilibrium concentration .",
    "the reason to use the gl model instead of the original van der waals model in the present work arises from our interest in the numerical aspects of the problem . the gl _ polynomial _ model allows one to compute the bare free energy function @xmath133 exactly , without further approximations .",
    "in appendix [ ap : approx - nonlinear ] we discuss possible approximations to non - polynomial free energy functionals .",
    "the parameters in the gl model in terms of the van der waals model are ( see appendix [ ap : free ] ) @xmath215 these coefficients depend on temperature but are assumed to be independent of the concentration field . here",
    ", @xmath216 is the molecular volume of the van der waals model , @xmath217 the critical temperature , @xmath89 is a length scale related to the range of the attractive part of the microscopic potential .",
    "the gl free energy functional is non - linear due to the @xmath218 term and observables like correlation functions can only be computed explicitly in an approximate way , either by perturbation theory or other means .",
    "two models that we will also consider in the present work are the solvable gaussian model with surface tension ( ga+@xmath89 ) , which is obtained by setting @xmath219 in eq .",
    "( [ eq : glfefunctional ] ) , and the gaussian model without surface tension ( ga ) which is obtained after setting @xmath220 .",
    "they are @xmath221 & =   k_b t\\int d{\\bf r}\\ , \\left\\lbrace   \\frac{r_0}{2}\\phi({\\bf r})^2   + \\frac{k}{2 }   \\left(\\nabla \\phi({\\bf r})\\right)^2\\right\\rbrace \\nonumber\\\\    \\hat{\\cal f}^{(\\mathrm{ga } ) } [ c({\\bf r } ) ] & =   k_b t\\int d{\\bf r}\\ , \\left\\lbrace   \\frac{r_0}{2}\\phi({\\bf r})^2 \\right\\rbrace \\label{ga}\\end{aligned}\\ ] ] the quadratic models are analytically solvable and they serve as a benchmark comparison for the results on the ginzburg - landau model .",
    "the bare free energy function @xmath188 is defined in ( [ barefdef ] ) . by substituting the interpolated field @xmath222 ( repeated indices are summed over ) one obtains @xmath223 where the mass matrix @xmath224 is defined in ( [ mdelta ] ) and the stiffness matrix @xmath225 is given by @xmath226 and the quartic contribution is defined as @xmath227 with a four - node mass given by @xmath228 note that due to the form of @xmath229 ( see fig .",
    "( [ fig : delaunay1d ] ) ) the elements of the matrices @xmath230 will be non - zero only if the nodes @xmath231 coincide or are nearest neighbors . in a similar way , the elements @xmath232 of the four - node mass will be different from zero only if @xmath233 coincide or are all of them nearest neighbors .",
    "the gl model shows phase separation when @xmath234 giving concentration fields that have two distinct values in different regions of space . in the present paper , though , we will restrict ourselves to supercritical temperatures @xmath235 in such a way that there is no phase transition .",
    "note that the statistics required in subcritical simulations needs to sample the diffusion of the phase separated droplets , which is usually very slow @xcite .",
    "in addition , for supercritical temperatures translation invariance leads to simple forms for the structure factor , which is the basic observable that we will consider in the present paper .",
    "in this section , we consider a 1d periodic system governed by the free energy functionals ( [ eq : glfefunctional])-([ga ] ) . in 1d these models",
    "are well behaved , and the continuum equations have a precise interpretation .",
    "we are concerned with the convergence of the numerical method to the solution of the continuum equations as the grid is refined .      up to now",
    "we have considered the space discretization of a pde or spde , where time is still a continuum variable .",
    "of course , the numerical resolution of these equations require a discretization in time . for the gl model , there is a part in the sde that is linear in the concentration field and that we call the diffusive part of the sde .",
    "the non - diffusive part arises from the quartic term in the gl free energy . in order to be able to use large time step sizes that do not suffer from instabilities",
    ", we will treat the diffusive part of the equation implicitly , while the non - diffusive part will be treated explicitly , following the implicit trapezoidal method proposed in refs .",
    "this temporal integrator has the property that for linear equations , when all terms are discretized using the implicit trapezoidal rule , it is unconditionally stable and gives the same static covariances ( structure factors ) independent of the time step size",
    ". therefore temporal integration errors in the static factors are eliminated by this scheme for the ga and ga+sigma models . when some terms are discretized explicitly , as for the gl model , some temporal discretization error will be observed @xcite .",
    "also note that resolving the correct _ dynamic _",
    "correlations for large wavenumbers requires choosing a sufficiently small time step size .",
    "note that the smallest relaxation time is the one corresponding to the wavenumber @xmath236 where @xmath237 is the lattice spacing .",
    "we use a time step smaller than this relaxation time , but one can use much larger time steps and still recover the correct structure factor for low wavenumbers since the algorithm is implicit .      the set of parameters in the van der waals model and in its approximate form , the ginzburg - landau model , is the following .",
    "the parameters corresponding to the particular fluid being studied are the excluded volume @xmath216 of a van der waals molecule , the length scale @xmath89 of the potential , and the critical temperature @xmath217 of the van der waals fluid .",
    "the parameters corresponding to the thermodynamic state are the temperature @xmath238 and the global concentration @xmath239 where @xmath166 is the total number of particles and @xmath240 is the size of the box . because the dynamics conserves the total number of particles @xmath241 ,",
    "the total number of particles is a parameter of the simulation that enters through the initial conditions specified through the initial profile @xmath242 .",
    "the parameter corresponding to the dynamic equation is the mobility @xmath243 assumed to be constant and given in terms of the diffusion coefficient @xmath93 as @xmath244 .",
    "finally , we have a set of numerical parameters , like the time step size @xmath245 and the total number @xmath16 of nodes of the mesh .",
    "each node has a volume @xmath246 with @xmath247 .    from this set of parameters ,",
    "we choose @xmath248 as our units , thus fixing the basic units of length , time , and mass .",
    "this results in the following dimensionless numbers as our free parameters @xmath249 , @xmath250 , @xmath251 , @xmath166 , @xmath16 .",
    "we will consider a fluid characterized by a fixed value of @xmath252 . in this way",
    ", we will fix the ratio @xmath253 .",
    "we also fix @xmath166 in order to have the total concentration @xmath254 equal to the critical concentration @xmath255 , this is , @xmath256 . in this way",
    ", the number of free parameters to explore is reduced to @xmath249 , @xmath16 , @xmath251 .",
    "the limit @xmath257 is the _ thermodynamic limit _ or infinite system size limit , whereas the limit @xmath258 ( so the volume of each cell approaches zero ) is the _ continuum limit_.    in the following sections , all the simulations are performed at a box of size @xmath33 at a temperature @xmath259 in the selected units , with the corresponding parameters in eq .",
    "( [ param ] ) being @xmath260 and @xmath261 .",
    "they all start from an initial state in which @xmath262 for all @xmath29 , and employ a sufficiently small time step to ensure numerical stability and convergence of results .",
    "we ensure that we sample equilibrium configurations by compiling statistics only after a time of the order @xmath263 . the number of particles @xmath264 is exactly conserved by the algorithm .",
    "the structure factor is an observable that is specially suited when there is translation invariance .",
    "the structure factor is the discrete fourier transform of the matrix of covariances , this is , the matrix of second moments of the probability distribution @xmath182 in eq .",
    "( [ einsdisc ] ) ( see appendix [ app : structure ] ) .",
    "the @xmath265-dependent structure factor allows to discuss correlations of the concentration at different length scales .",
    "the structure factor can be analytically computed in the continuum limit for a ga+@xmath89 model as shown in appendix [ app : structure ] , with the result @xmath266 where @xmath267 the typical length scale below which fluctuations start to decorrelate is given by @xmath268 .",
    "the _ dynamic _ structure factor is the fourier transform of the time dependent correlation function and can also be explicitly computed for the gaussian model leading to @xmath269 with a typical relaxation time given by @xmath270^{-1 } \\label{tauk}\\end{aligned}\\ ] ] the continuum results ( [ sck ] ) and ( [ tauk ] ) serves also as the basis for computing the structure factors of the discrete variables , see appendix [ app : structure ] .",
    "in addition to the structure factor , we will also consider as observable the probability that a region of finite size @xmath271 has a given number of particles in its interior . in 1d",
    ", this observable should be independent of the resolution , given a sufficiently large resolution , and will allow us to detect whether the gl model behaves in a gaussian or non - gaussian way , depending on the temperature .        while the structure factor ( [ sck ] ) has an explicit expression ,",
    "what we compute in a simulation is the covariance @xmath272 of the discrete variables @xmath273 or , for regular lattices , its fourier transform .",
    "we introduce the discrete fourier transform @xmath274 with @xmath275 of the discrete concentration field @xmath273 according to @xmath276 and define the discrete structure factor as @xcite @xmath277 where @xmath278 for integer @xmath279 .",
    "the modes @xmath280 are related to @xmath273 which , in turn , are related to the continuum field through eq .",
    "( [ natural ] ) . for the ga+@xmath89 model",
    "we know the correlations of the fluctuations of the continuum field and , therefore , we have an explicit expression for the discrete structure factor ( see appendix [ app : structure ] ) @xmath281 ^ 2 } \\sum_{\\alpha\\in\\mathbb{z } } \\frac{\\mathrm{sinc}^4\\left(\\frac{ka}{2}-\\pi\\alpha\\right ) } { 1+\\left(\\frac{k}{k_0}-\\frac{2\\pi \\alpha } { k_0a}\\right)^2 } \\label{scfin}\\end{aligned}\\ ] ] note that in the limit of high resolution @xmath282 , the only term that contributes in the sum over @xmath283 is @xmath284 . in this limit ,",
    "then , the discrete structure factor ( [ scfin ] ) converges towards the continuum limit ( [ sck ] ) .",
    "( [ scfin ] ) gives the prediction of the continuum theory for the covariance of fluctuations of the discrete concentration variables .",
    "comparison for the ga@xmath285 model of the static structure factors @xmath286 ( dashed lines ) in eq .",
    "( [ scfin ] ) , @xmath287 ( points ) in eq .",
    "( [ sdfin ] ) , and @xmath288 ( solid pink line ) in eq .",
    "( [ sck ] ) . from top",
    "to bottom : red , @xmath34 ; green , @xmath289 , blue , @xmath290 ; cyan , @xmath291 ; yellow , @xmath292 ; pink , continuum structure factor . as the resolution increases , the range of @xmath265 for which there is no significant discrepancy between the discrete results and the continuum prediction @xmath288 in eq .",
    "( [ sck ] ) increases . ]",
    "the numerical integrator proposed in @xcite produces the same static structure factor regardless of the time step .",
    "as we show in appendix [ app : discretesknum ] , the actual discrete structure factor @xmath293 produced by our integrator for the ga+@xmath89 model is given by @xmath294}\\frac{1}{1+\\frac{k^2}{k_0 ^ 2}\\left(\\frac{3 \\mathrm{sinc}^2(ka/2)}{(2+\\cos ka)}\\right ) } \\label{sdfin}\\end{aligned}\\ ] ] which is independent of the time step @xmath295 @xcite . this result ( [ sdfin ] )",
    "is useful as it allows to check for correct coding of the algorithm .",
    "we have indeed verified that the numerical results lead exactly to ( [ sdfin ] ) .",
    "note that @xmath293 in ( [ sdfin ] ) tends to the continuum limit @xmath296 in ( [ sck ] ) for @xmath297 . in the limit @xmath298 , @xmath299",
    "( [ sckga ] ) ) . for finite @xmath300 , @xmath293 is different from @xmath301 , although both structure factors tend to the continuum value @xmath296 for sufficiently high resolutions .",
    "we compare in fig .",
    "[ fig : gl_sk_comparison ] @xmath296 in eq .",
    "( [ sck ] ) , @xmath301 in eq .",
    "( [ scfin ] ) and @xmath293 in eq .",
    "( [ sdfin ] ) for increasing levels of resolution .",
    "the main observation is that @xmath293 and @xmath301 are very similar .",
    "in other words , not only the infinite limit resolution @xmath296 is well captured by the numerical method , but also the predictions of the continuum theory for a finite mesh are equally well reproduced .",
    "static structure factor as a function of @xmath265 for the model ga . from left to right : red , @xmath34 nodes ( @xmath302 ) ; green , @xmath289 ( @xmath303 ) ; blue , @xmath290 ( @xmath304 ) ; cyan , @xmath291 ( @xmath305 ) ; pink solid line , continuum result @xmath306 given by eq .  ( [ sck ] ) in the limit @xmath298 .",
    "dots correspond to the numerical structure factor obtained from simulations ; dashed lines correspond to the theoretical prediction given by eq .",
    "( [ scfin ] ) . ]",
    "the gaussian model ga is obtained by setting @xmath307 and suppressing the square gradient term .",
    "this implies @xmath308 in eq .",
    "( [ ga ] ) and results in that different points in space are completely uncorrelated .",
    "figure  ( [ fig : ga_sk ] ) shows the _",
    "static _ structure factor for different resolutions , from @xmath34 to @xmath290 as well as the continuum solution @xcite .",
    "we also plot in fig .",
    "( [ fig : ga_sk ] ) the theoretical discrete structure factor , given by eq .",
    "( [ scfin ] ) , which takes into account the finite size of the cell .",
    "the simulation results are indistinguishable from the theoretical prediction at each resolution as they must since in this case eq .",
    "( [ scfin ] ) is equal to ( [ sdfin ] ) .",
    "as we keep increasing the resolution , the range of wavenumber for which the structure factor coincides with the prediction @xmath306 of the continuum theory increases .",
    "however , there is always a discrepancy at large wavenumbers corresponding to the inverse of the lattice spacing .",
    "it should be mentioned that the analytic results obtained for the correlation of the discrete concentration of nodes @xmath309 in the appendix [ app : structure ] are based on the canonical ensemble .",
    "therefore , they do not satisfy the sum rule @xmath310 that results from the conservation of the total number of particles .",
    "the latter property is actually satisfied by the simulation results .",
    "the differences , however , are vanishingly small in the thermodynamic limit .",
    "the _ dynamic _ structure factor can also be obtained from eq .",
    "( [ eq : sktgas ] ) for a given @xmath265 value .",
    "dynamic structure factor for @xmath311 as a function of time for the model ga ( blue circles , top ) and ga@xmath285 ( blue squares , bottom ) . averaged over 10 simulations at @xmath290 .",
    "circles and squares correspond to the numerical result , solid pink line corresponds to the theoretical prediction ( [ eq : sktgas ] ) . in the ga model",
    ", @xmath312 gives a relaxation time @xmath313 .",
    "in the ga@xmath285 model , @xmath314 ( @xmath315 ) gives a relaxation time @xmath316 . ]    figure  ( [ fig : ga_k_t ] ) shows the dynamic structure factor for @xmath311 with @xmath290 ( a sufficiently fine grid ) for both the ga ( circles ) and the ga@xmath285 ( squares ) models , and compares numerical results with the theoretical prediction ( pink solid line ) . in the ga case , the value @xmath317 gives a relaxation time of @xmath318 . in the ga@xmath285 case ,",
    "the parameter @xmath319 remains unchanged and @xmath315 , with a time scale @xmath320 .",
    "as can be seen , numerical simulations overlap with theoretical predictions .",
    "we also plot in fig .",
    "[ fig : gas_sk_t_tau ] the relaxation time @xmath321 obtained through simulations for both the ga ( circles ) and ga@xmath285 ( squares ) models , and compares them with the theoretical result  ( [ tauk ] ) .",
    "both results overlap the theoretical ones for time scales smaller than @xmath322 in reduced units , which is comparable to the time step size @xmath323 .",
    "note that this time step is much smaller than the relaxation time for the wavenumber plotted .",
    "we may still have good results for small wavenumbers with much larger time steps , but we have decided to use a time step that would resolve also the smallest relaxation times , which is roughly @xmath324 .",
    "relaxation time @xmath321 as a function of @xmath265 for @xmath290 in both the ga model ( blue circles , top ) and the ga@xmath285 model ( blue squares , bottom ) averaging over 10 simulations with time step @xmath325 .",
    "dots correspond to the relaxation time obtained from a numerical fitting of the dynamic structure factor to an exponential function .",
    "lines correspond to the theoretical prediction in eq .",
    "( [ tauk ] ) . ]",
    "once the code has been checked for the gaussian models , we may move to the more interesting case of the ginzburg - landau model eq .",
    "( [ eq : glfefunctional ] ) with its discrete free energy function given in eq .",
    "( [ eq : glfediscrete ] ) .",
    "this model shows phase separation at subcritical temperatures . for",
    "sufficiently high supercritical temperatures gaussian behavior is recovered . in order to detect interesting non - linear effects , albeit in the single phase region",
    ", we will explore temperatures near ( above ) the critical temperature characterized by a single non gaussian phase .",
    "( [ fig : gl_hist_overktc ] ) shows the probability distribution of finding a deviation from the mean of the number of particles , @xmath326 , inside a region of size @xmath327 .",
    "the simulation were done at @xmath328 ( @xmath329 ) and @xmath330 ( @xmath331 ) in the selected units .",
    "as we increase the resolution the probability distribution converges towards a unique limit . in a gaussian model , one should expect a linear dependence between @xmath332 and @xmath333 .",
    "this is not observed in the limit curve of fig .",
    "( [ fig : gl_hist_overktc ] ) , signaling non - gaussian behavior for this thermodynamic point state .",
    "probability distribution of finding a deviation from the mean of the number of particles inside a region of size @xmath334 for the gl model .",
    "this is , @xmath335 . from top to bottom , @xmath34 nodes , @xmath289 , @xmath290 and @xmath291 .",
    "we observe convergence of the probability distribution towards a non gaussian distribution as the resolution is increased . ]",
    "static structure factor as a function of @xmath265 for the gl model .",
    "red , @xmath34 nodes ( @xmath302 ) ; green , @xmath289 ( @xmath336 ) ; blue , @xmath290 ( @xmath337 ) ; cyan , @xmath291 ( @xmath338 ) .",
    "convergence of the numerical results is observed as the resolution increases . with solid pink line , the continuum structure factor of the ga@xmath285 model with the same parameters @xmath339 @xmath340 as the gl model .",
    "dashed pink line shows the continuum structure factor of a renormalized ga@xmath285 model which has the same variance as the gl model .",
    "the empirical fitting of the numerical data to the renormalized ga@xmath285 static structure factor gives @xmath341 and @xmath342 .",
    "inset , l@xmath343-norm indicating convergence . ]",
    "figure  ( [ fig : gl_sk ] ) shows the static structure factor for the ginzburg - landau model at different resolutions , @xmath34 ( red ) , @xmath289 ( green ) and @xmath290 ( blue ) and @xmath291 ( cyan ) .",
    "we observe that as we increase the resolution we converge towards a unique answer .",
    "the l@xmath343-norm l@xmath343@xmath344 is also shown in the inset of fig.([fig : gl_sk ] ) , where we compare the structure factor obtained at resolution @xmath345 with the one obtained at a higher resolution @xmath346 .",
    "a pink line of slope -2 agrees well with the numerical results reflecting second order spatial convergence of the algorithm .",
    "we also compare in fig .",
    "( [ fig : gl_sk ] ) the static structure factor of the gl model with the continuum limit of the corresponding one in the ga@xmath285 model .",
    "two regions are clearly observed , separated by a value at around @xmath347 .",
    "on one hand , for @xmath348 ( large length scales ) there is a clear difference between the gaussian and the gl model . for small wavenumbers ,",
    "the contribution of the quartic term is important and suppresses the amplitude of the fluctuations relative to the ga+@xmath89 model . on the other hand , for @xmath349",
    "there is no difference between both models in the limit of infinite resolution , and the quartic term has a minimal effect .",
    "the existence of two regions may be understood from the probability of finding a particular fourier mode @xmath350 of the field , which will be given by the exponential of the free energy ( [ eq : glfefunctional ] ) , expressed in fourier space .",
    "the quadratic term in this free energy has a @xmath265-dependent prefactor @xmath351 .",
    "near the critical point , we have @xmath352 .",
    "therefore , for @xmath353 , the free energy is entirely dominated by the quartic interaction ( which in fourier space is in the form of a convolution ) . at sufficiently large @xmath265 , however , the quadratic term dominates over the quartic .",
    "the effect of the quartic term is to strongly suppress the amplitude of the long - wave fluctuations with respect to the gaussian model with the same @xmath354 parameters .",
    "dynamic structure factor as a function of @xmath152 for @xmath311 for the gl model . with dots : red , @xmath34 nodes ( @xmath302 ) ; green , @xmath289 ( @xmath355 ) ; blue , @xmath290 ( @xmath356 ) . with solid pink line , the dynamic structure factor of a renormalized ga@xmath285 model with parameters @xmath341 and @xmath342 . ]",
    "figure  ( [ fig : gl_sk_k314_t ] ) shows the dynamic structure factor of the gl model for @xmath311 at different resolutions .",
    "we observe convergence as the resolution is increased in the region where the statistical errors are small ( @xmath357 ) .",
    "the fact that the decay of the dynamic structure factor of the gl model is exponential suggests that its dynamics is very similar to that of a _",
    "renormalized _ gaussian model . in order to test this conjecture ,",
    "we have considered the best ga+@xmath89 model that would reproduce the _ static _ structure factor of the gl model .",
    "the best gaussian model is the one that has the same structure factor as that of the gl model .",
    "the result of the fit is presented in fig .",
    "[ fig : gl_sk ] and gives the parameters @xmath358 and @xmath342 .",
    "observe that in the renormalized ga+@xmath89 model the surface tension coefficient @xmath359 is the same and only the value of the quadratic coefficient @xmath319 is renormalized , consistent with predictions of renormalization ( perturbative ) theories @xcite . with these values of @xmath360",
    "we compute independently the prediction for the relaxation time given by eq .",
    "( [ tauk ] ) for a ga+@xmath89 model .",
    "the result is the solid line in [ fig : gl_sk_tau_all ] .",
    "a very good agreement between the measured relaxation times of the gl model and the prediction of this renormalized gaussian model is obtained .",
    "this suggests that indeed , the gl model behaves as a ga+@xmath89 model with renormalized parameters .",
    "relaxation time @xmath321 as a function of @xmath265 in the gl model at different resolutions @xmath34 ( red ) , @xmath289 ( green ) , @xmath290 ( blue ) and @xmath291 ( pink ) .",
    "all of them obtained averaging over 10 simulations .",
    "dots correspond to the numerical relaxation time ( obtained from a numerical fitting of the dynamic structure factor to an exponential function ) .",
    "line corresponds to the theoretical prediction ( [ tauk ] ) of the renormalized ga@xmath285 model with @xmath361 ( @xmath362 ) and @xmath363 ( @xmath315 ) . ]      in this section , we present similar results as in the previous section but in this case for irregular lattices .",
    "adaptive mesh resolution allow one to resolve interfaces appearing below critical conditions , and deal with complicated boundary conditions . in the present paper , while we still remain in the supercritical region of the gl model , where no interfaces are formed , we test the performance of the algorithm presented for irregular lattices .",
    "we consider irregular lattices constructed by displacing randomly the nodes of a regular lattice , allowing for a maximum fluctuation of @xmath364 40% with respect to the regular lattice configuration .",
    "these random lattices are a worst case scenario and other lattices with slowly varying density of nodes behave much better in terms of numerical convergence .",
    "we compare regular and irregular lattice simulation results by using the same set of parameters in both cases .",
    "typically , what we observe is that higher resolutions are required in irregular lattices in order to achieve comparable accuracy as those in regular lattices .",
    "the time step in an irregular lattice is dictated by the shortest lattice distance @xmath365 encountered according to @xmath366 .    from a numerical point of view , obtaining the static structure factor for regular grids can be efficiently done with fast fourier transforms ( fft ) : we just need to perform a fft of the concentration field and multiply it by its complex conjugate . however , irregular grids complicate the use of the fft and we need to follow a different route to obtain the static structure factor .",
    "the idea is to interpolate the discrete field on the irregular coarse grid onto a very fine regular grid on which the fft can be used .",
    "of course , the interpolation procedure modifies the structure factor because we are creating information at the interpolated points .",
    "at the same time , when we consider irregular grids , we do not have simple analytical results to compare , even for the gaussian models . in this case , our strategy is to produce synthetic gaussian fields generated in a very fine grid ensuring that they are distributed in such a way that have a structure factor given by ( [ sck ] ) .",
    "this is achieved by generating random gaussian numbers in fourier space with the correct mean and covariance for each wavenumber @xmath265 so that the theoretical @xmath288 is recovered .",
    "these synthetic gaussian fields are taken as the `` truth '' to compare with . from the synthetic gaussian field , we compute a coarse - grained field on an irregular coarse grid by applying the coarsening operator @xmath35 as in the first equation ( [ natural ] ) , where the integral is approximated as a sum over the very fine grid .",
    "this gives us realizations of a gaussian field in a coarse irregular grid .",
    "we may now apply the methodology used for computing the structure factor in regular grids , by interpolating on a very fine regular grid and using the fft .",
    "static structure factor as a function of @xmath265 for the model ga in irregular lattices . from left to right , @xmath34 nodes ( @xmath367 ) , @xmath289 ( @xmath368 ) , @xmath290 ( @xmath369 ) , @xmath291 ( @xmath370 ) and continuum limit of the ga model ( solid pink line , eq .",
    "[ sck ] ) .",
    "dots correspond to the simulations of the diffusion equation , while dashed lines correspond to the synthetic gaussian fields .",
    "the striking difference with fig .",
    "[ fig : ga_sk ] is due to the interpolation procedure used to compute the static structure factor in the irregular grid . ]",
    "figures  ( [ fig : ga_sk_irr ] ) and ( [ fig : gas_sk_irr ] ) show , for both a ga and a ga@xmath285 model , the agreement between simulations ( in dots ) and the synthetic procedure ( dashed lines ) . we also show the predictions obtained from ( [ sck ] ) , demonstrating that we correctly discretized eq .",
    "( [ pde ] ) on the irregular grid .",
    "structure factor in the ga+@xmath89 model for an irregular lattice . in the main panel , @xmath34 nodes ( red , @xmath371 ) and @xmath289 ( green , @xmath372 ) . in the inset",
    "we plot in log - log scale results for @xmath290 nodes ( blue , @xmath373 ) and @xmath291 nodes ( cyan , @xmath374 ) .",
    "dots correspond to the simulations of the diffusion equation .",
    "dashed lines correspond to the synthetic gaussian ( with surface tension term ) field .",
    "the theoretical prediction in eq .",
    "( [ sck ] ) is also plotted in solid pink line . ]",
    "we move now to the gl model .",
    "we consider the probability distribution of a fluctuation of the number of particles in a fixed region of space for the gl model .",
    "the region of space is delimited by two nodes that are always at the same distance @xmath375 . in a first simulation",
    ", we consider an arbitrary grid of nodes set at random in the whole domain , except for the two points delimiting the region of interest that are always fixed . in fig .",
    "[ prob_irr1 ] we plot the result of increasing the number of nodes in the simulation .",
    "probability of @xmath376 in a given region of space @xmath377 in a random grid .",
    "the points that limit the region are kept fixed as in the regular grid , inside the region the nodes are randomly distributed .",
    "green , @xmath289 ; blue , @xmath290 ; cyan , @xmath291 .",
    "we compare the probability in a random grid ( points ) with the probability corresponding to a regular grid with the same resolution ( dashed lines ) . ]    in a second simulation , we divide the box in 16 equally spaced regions delimited by nodes of the grid .",
    "then , in half of the boxes we have a coarse resolution and in the other half we have a finer resolution .",
    "the probability in any of the regions is essentially the same , as shown in fig .",
    "[ prob_irr2 ] , further validating the method for irregular grids .",
    "probability of @xmath376 in a given region of space @xmath378 .",
    "green dashed line corresponds to a regular lattice with @xmath289 .",
    "blue dots correspond to a grid with @xmath290 and cyan dots correspond to a grid with @xmath291 . for the @xmath291 grid ,",
    "64 nodes are uniformly distributed in half of the box while the remaining 448 nodes are distributed uniformly in the other half . in this way",
    ", we have a grid which is , in one region , seven times finer than the original one ; in the other region , exactly the original one . the grid @xmath290 is defined with @xmath379 nodes in half of the box and @xmath380 nodes in the other half . ]     static structure factor as a function of @xmath265 for the gl model in an irregular lattice . from bottom to top : red , @xmath34 ( @xmath381 ) ; green , @xmath289 ( @xmath382 ) ; blue , @xmath290 ( @xmath383 ) and cyan @xmath291 ( @xmath384 ) . from @xmath34 to @xmath290 , averaged over 10 simulations .",
    "pink solid line shows the theoretical renormalized ga@xmath285 model ( with @xmath341 and @xmath342 ) . ]    finally",
    ", we show in fig .",
    "[ fig : gl_irr_sk ] the static structure factor for the gl model in an irregular random grid , where the simulations are performed with the same parameters as those in figs .",
    "( [ fig : ga_sk_irr ] ) and ( [ fig : gas_sk_irr ] ) .",
    "we observe that by increasing the resolution the structure factor converges towards a continuum result , consistent with the results based on the regular grid .",
    "we conclude that the algorithm presented displays convergence of the gl model for both regular and irregular grids .",
    "we have proposed a petrov - galerkin finite element method for discretizing non - linear diffusion spde on arbitrary grids in arbitrary dimensions .",
    "the method uses the concept of mutually orthogonal sets of discretization basis functions @xmath385 and continuation basis functions @xmath24 .",
    "we use two different basis functions for what is known in the finite element literature as trial ( or test ) functions and solution functions .",
    "as opposed to a galerkin method in which the weak form of the differential equation is constructed with @xmath24 itself , the petrov - galerkin method leads to a positive semi definite diffusion matrix .",
    "this property is crucial for representing at the discrete level the second law satisfied by the original pde .",
    "more importantly , the diffusion matrix needs to be positive definite if thermal fluctuations are to be introduced in the equation , because the covariance matrix of the random terms is just the diffusion matrix .",
    "the method is general , valid for regular and irregular grids , and in any dimension .",
    "our approach combines mathematical aspects of the discretization of a pde as well as attention to the physical origin and meaning of the pde .",
    "in fact , a given pde may be written in many different equivalent forms by just reshuffling derivatives and functions .",
    "for example , the ga+@xmath89 model for constant mobility leads to a pde that contains fourth order space derivatives that may be written in very different ways .",
    "we use in a rational way the physical information of the origin of the different terms in order to propose the discretization of the pde .",
    "we have discussed the microscopic foundation of the different dynamic equations considered in this paper in order to have a well defined physical interpretation for them .",
    "the selection of the relevant variables ( [ hatcmu ] ) used in the tocg to derive the discrete sde has been guided by the finite element methodology , with a view to have well defined continuum limits when possible .    we have shown that the free energy function entering the dynamic equation for _ the ensemble average discrete concentration field _ derived from the tocg , and that entering the finite element discretization of eq .",
    "( [ pde ] ) , are actually the same function , in the limit of high resolution .",
    "while a continuum equation like ( [ pde ] ) has a well - defined meaning , its stochastic counterpart ( [ spde ] ) obtained from the underlying microscopic dynamics has physical meaning only in a discrete setting where , instead of an equation like ( [ spde ] ) one needs to consider an equation for discrete variables of the form ( [ eq : sdedisc ] ) . at the same time , the formal continuum eq .",
    "( [ spde ] ) is a useful device in order to obtain a closed form approximation of the objects appearing in ( [ eq : sdedisc ] ) such as the mobility",
    ".    the microscopic view does not give information about the actual form of the diffusion matrix and free energy functions and we have to _ model _ these objects .",
    "in the present work , we have modeled the bare free energy functional @xmath386 $ ] with a ginzburg - landau form .",
    "we have shown that the continuum limit exists in 1d for a sequence of sde of the form ( [ eq : sdedisc ] ) with increasing number of node points by looking at the structure factor and probability distribution of particles in a region of fixed extension .",
    "although simulation results have been presented for 1d , the methodology is general and applicable , in principle , to higher dimensions .",
    "however , some caution is required in @xmath12 . from the results on the gaussian model , for which the analytic correlation function @xmath387 can be explicitly computed , we know that the point - wise variance @xmath388 diverges in @xmath12 .",
    "this quantity gives the average amplitude of the field at a given point .",
    "this implies that the fields @xmath389 are extremely irregular and should be rather understood as distributions in @xmath12 @xcite .",
    "however , distributions can not be multiplied and a quartic term in the free energy is ill - defined .",
    "this means that the gl model is ill defined in @xmath12 .",
    "if one naively discretizes the corresponding ill - posed nonlinear spde , pathological behavior will be observed in @xmath12 .",
    "for example , the number of particles in a given _",
    "finite _ region of space have fluctuations that depend on the lattice spacing , which is obviously nonphysical .",
    "there are two fundamentally different approaches to address this problem .",
    "on one hand , in stochastic field theories as those appearing in quantum field theory the governing spde is postulated from symmetry arguments without further connection to any other more microscopic description of the system . in this case , the spde is the fundamental equation and one needs to modify the action ( free energy ) with _ counterterms _ that depend on the lattice spacing in order for the final theory to have a proper continuum limit @xcite .    on the other hand ,",
    "when a `` more fundamental '' theory exists , as is the case in colloidal suspension where the fundamental theory are hamilton s equations , the requirement of having a continuum limit is desirable but not essential .",
    "for example , the microscopic underpinning of the spde with a free energy functional of the van der waals form shows that such a model makes sense only for a given cell size ( large enough to contain many particles , small enough for the attractive part of the potential to be treated in mean field ) @xcite .",
    "indeed , if the cell size was to be taken too large , larger than droplet sizes , it would not be able to discriminate between liquid and vapor phases and the free energy functional to be used in that case would need to be different from the usual square gradient van der waals free energy functional .",
    "it makes no sense to look at the mathematical continuum limit of the discrete spde , while the discrete spde still has a physically sounded foundation .",
    "the finite element methodology presented may be extended to other spde like those appearing in the landau - lifshitz navier - stokes ( llns ) equations . for a compressible theory ,",
    "the free energy function plays essentially the same role as in the present theory . in llns one",
    "usually chooses a free energy which is gaussian .",
    "we should expect similar ultraviolet catastrophic behavior as in the present simpler non - linear diffusion .",
    "however , the gaussian theory should still give correct macroscopic observables like the amplitude of the fluctuations of the number of particles in a _",
    "finite _ region of space .",
    "while the equilibrium properties in the gaussian model do not have pathological behavior , the convective terms in the equations , involving non - linear terms , require a careful regularization @xcite .",
    "we appreciate useful discussion with eric vanden - eijnden , pedro tarazona , mike cates , and marc melndez .",
    "discussion at an early stage of this work with daniel duque are greatly appreciated .",
    "a. donev was supported in part by the office of science of the u.s .",
    "department of energy through early career award de - sc0008271 .",
    "support from mineco under grants fis2010 - 22047-c05 - 03 and fis2013 - 47350-c5 - 3-r is acknowledged .",
    "the van der waals free energy functional is usually derived for a fluid system interacting with a pair - wise potential that can be separated into a short range repulsive hard core and a long range attractive part @xmath390 @xcite . this functional was proposed to describe the phase transition between liquid and vapor , a transition that can also be observed in colloidal suspensions @xcite . by using a cell method , with cells large enough to contain many particles ( i.e. size of the cell much larger than the molecular volume @xmath216 but small enough to treat the long ranged attractive interaction in mean field ) , van kampen derived the following free energy functional , written by him in a continuum notation @xmath391=\\int d{\\bf r } \\left[f_0(c({\\bf r}),t ) + \\frac{1}{2}\\int c({\\bf r})c({\\bf r ' } ) \\phi({\\bf r}-{\\bf r}')d{\\bf r}d{\\bf r}'\\right ]    \\label{sl}\\ ] ] where the attractive part is treated in mean field and the short range part of the potential produces the local contribution @xmath392 . under the assumption that the density field hardly varies in the range of the attractive potential",
    ", we may taylor expand @xmath393 with the result @xmath394 where we have defined @xmath395 note that @xmath396 for purely attractive potentials @xmath397 .",
    "the free energy functional ( [ sl ] ) becomes @xmath398=\\int d{\\bf r }   \\left[f(c({\\bf r}),t ) + \\omega_2(\\boldsymbol{\\nabla } c({\\bf r}))^2\\right ]    \\label{gl1}\\ ] ] where @xmath399 . for a van der waals gas , the free energy density is given by @xmath400-ac^2 \\label{fnt0}\\ ] ] the constants @xmath401 are the attraction parameter and the excluded volume , respectively .",
    "the thermal wavelength is given by @xmath402 .",
    "the van der waals gas is characterized by two critical parameters , @xmath217 and @xmath403 , obtained through the first and second derivatives of the pressure , which leads to @xmath404 the free energy functional is an example of a general class of free energy functionals known as the square gradient approximation . in general",
    ", the coefficient of the square gradient term in the free energy depends also on the concentration @xcite .",
    "the van der waals free energy can be approximated by neglecting high order terms in an expansion around a constant concentration field , leading to the ginzburg - landau functional for the free energy .",
    "if we put @xmath405 we may expand to fourth order in @xmath406 @xmath407 = & \\int d{\\bf r }   \\left\\ { a_0+b\\delta c({\\bf r } ) \\right .",
    "\\nonumber \\\\ & + \\frac{1}{2}\\left[\\left.f_0''(c , t)\\right|_{c_0 } -2a\\right]\\delta c({\\bf r})^2   + \\frac{1}{3!}\\left.f_0'''(c , t)\\right|_{c_0}\\delta c({\\bf r})^3 \\nonumber \\\\ & + \\frac{1}{4!}\\left.f_0''''(c ,",
    "t)\\right|_{c_0}\\delta c({\\bf r})^4 + \\left.\\omega_2(\\boldsymbol{\\nabla } \\delta c({\\bf r}))^2\\right\\ } \\label{gl2 } \\end{aligned}\\ ] ] any constant term is irrelevant in the free energy and we can omit the constant term @xmath408 . the linear term in @xmath409",
    "disappears because of the normalization of the density field that ensures @xmath410 . for simplicity ,",
    "in this paper we will restrict ourselves to be near the critical density , @xmath411 .",
    "the derivatives of @xmath412 are , at the critical density @xmath403 , @xmath413 so the free energy functional is obtained as    @xmath414 & = \\frac{3}{8 } \\frac{k_b t}{b } \\int d{\\bf r}\\ , \\left\\lbrace \\frac{1}{8 } \\phi({\\bf r})^4 +   \\left(1-\\frac{k_bt_c}{k_bt } \\right)\\phi({\\bf r})^2 + \\sigma^2 \\frac{k_b t_c}{k_b   t } \\left(\\nabla \\phi({\\bf r})\\right)^2\\right\\rbrace \\label{eq : glfefunctionalb}\\end{aligned}\\ ] ]    where we have defined @xmath415 and @xmath416 .",
    "it is obvious that the ginzburg - landau free energy functional is only a good approximation to the van der waals free energy functional around the critical point for which the concentration profiles are close to the homogeneous profile .",
    "nevertheless , the gl free energy already captures the essential of a phase transition and we will restrict ourselves to this simpler model .",
    "note that the van der waals model does not allow to have values of the concentration larger than @xmath417 ( one molecule per molecular volume ) nor smaller than zero . on the other hand ,",
    "the gl model allows for unbounded values of @xmath418 .",
    "if the temperature is much larger than the critical one , the gl model reduces the gaussian model .",
    "while the mass and stiffness matrices introduced in eqs . ( [ ml ] ) are routinely computed in finite element algorithms , the four - node mass in eq .",
    "( [ m4 ] ) may be a rather cumbersome object to compute , particularly in dimensions higher than one .",
    "for this reason , we will also explore models in which the non - quadratic local contribution of the free energy is approximated in the same way as we did in eq .",
    "( [ approx ] ) .",
    "it is instructive first to look at the simpler case of the ga model . in this model",
    "the static correlation is given by @xmath419 this result can be obtained from the limit @xmath420 of eq .",
    "( [ phirr1d ] ) .",
    "note that this is also the equilibrium correlation function of the concentration field of independent brownian particles and is , so to speak , a `` physical '' result . from the correlation of the fields ( [ crr0 ] ) we can now compute the correlation matrix of the discrete variables @xmath421 with the result @xmath422",
    "observe that the correlations of the discrete concentration field are due to the overlapping of the weight functions @xmath423 .",
    "( [ correq ] ) comes directly from the physics inherent to ( [ crr0 ] ) and the definition of the coarse grained variables ( [ cgc ] ) .",
    "this is also the result obtained for the gaussian model when we use the definition of the free energy function in eq .",
    "( [ fdef ] ) .",
    "therefore , ( [ fdef ] ) is a sensible definition .",
    "the gaussian free energy _ function _ can be obtained exactly from the free energy _ functional _ ( [ ga ] ) because it is just a quadratic functional ( and similarly for the gl leading to the explicit four - node mass ) . for arbitrary functional forms of @xmath424",
    "we can not proceed by computing explicitly the space integrals in ( [ fdef ] ) and we need an approximation scheme .",
    "a naive scheme would be to approximate the free energy density evaluated at the interpolated field by the interpolated values of the free energy density at the nodes , this is @xmath425 indeed , at the nodes @xmath426 this is an exact identity , whereas at other points , the function is approximated . if we insert ( [ fap ] ) into ( [ fdef ] ) we arrive at @xmath427 which is certainly a natural and intuitive discretization of the space integral .",
    "unfortunately , this approximation leads to purely local correlations of the discrete variables , this is @xmath428 which does not conform to the physical result ( [ correq ] ) .",
    "the above discrepancy is expected to produce errors at length scales comparable to cell size , while for larger length scales the approximation ( [ naive ] ) may be sufficient .",
    "it may be convenient , though , to improve the approximation ( [ naive ] ) in order to not miss even small scales features , that may be important in hybrid methods coupling finite elements with particles .",
    "in many cases of practical interest , the local part of the free energy functional is of the form @xmath105&=\\int d{\\bf r}c({\\bf r})g(c({\\bf r } ) ) \\label{calfloc2}\\end{aligned}\\ ] ] where @xmath429 is a free energy per particle .",
    "the discrete free energy function now becomes @xmath430 we may now approximate the free energy density according to @xmath431 the result of this approximation is the explicit discrete free energy @xmath432 where @xmath433 .",
    "when @xmath429 is linear in the concentration , this approximation recovers the correct form of the correlations of the discrete concentration field , as opposed to the approximation ( [ fap ] ) . in the future we will explore ( [ fdisfin ] ) in the context of nonlinear free - energy functionals such as those appearing in the ideal gas or van der waals models .",
    "the methodology presented allows one to treat also non - local free energy functionals .",
    "these functionals usually involve a smoothed density profile that renders the functional non - local @xcite . for the sake of the illustration",
    ", we consider here the exact 1d free energy _",
    "functional _ for hard rods proposed by percus @xcite which has the form @xmath105&=k_bt\\int dz c(x)\\ln ( 1-\\sigma \\overline{c}(x))\\end{aligned}\\ ] ] where @xmath89 is the length of the hard rod and the smoothed concentration profile is @xmath434 which is the space average of the concentration field over the length of the rod .",
    "the recipe ( [ fdef ] ) now leads to a discrete free energy _",
    "function _ of the form @xmath435 where we have introduced @xmath436 where the last identity defines the function @xmath437    however , eq . ( [ nonlocf ] ) is still intractable because the integral needs to be done numerically every time we update @xmath122 .",
    "for this reason , we propose to approximate the smoothed density field according to @xmath438 which is just a linear interpolation with suitable coefficients @xmath439 for the discretization of the smoothed density field .",
    "we evaluate the coefficients @xmath439 by requiring compatibility beteween ( [ c1 ] ) and ( [ c2 ] ) .",
    "this leads to the condition @xmath440 by multiplying both sides with @xmath32 and using ( [ projection0 ] ) leads to the explicit form for @xmath441 in terms of the discrete concentration @xmath273 , this is @xmath442 where the smoothing matrix @xmath443 is given by the geometric object @xmath444 that may be computed easily in an explicit way . as a final step we take the approximation @xmath445 which is a natural way of approximating a function by a piece - wise linear expression . after inserting this result into ( [ nonlocf ] )",
    "we obtain the discrete free energy function as an explicit function of the concentration field and the geometric objects @xmath446 @xmath447 where @xmath448 is defined in ( [ mdelta ] ) .",
    "it is important to note , however , that the above derivation has implicitly assumed that the hydrodynamic cells are sufficently small to allow to treat the concentration as smooth over the cell length .",
    "in many practical cases of interest , such as for example , layering near a wall , there will be spatial variability on length scales comparable to the length of a rod , and the above non - local recipe would require using cells that contain fewer than a single particle ; in this case it is not sensible to also include thermal fluctuations in the description and only the equations for the average can be studied .",
    "the discrete model ( [ eq : sdedisc ] ) , ( [ fgldis0 ] ) is valid for any space dimension . in this section",
    "we present the model in 1d explicitly .",
    "the nodes are at positions @xmath449 , @xmath450 and the basis function @xmath26 is given by @xmath451 where @xmath452 is the heaviside step function , @xmath453 and @xmath454 .",
    "figure  [ fig : delaunay1d ] shows the function @xmath28 for three neighbor cells .",
    "the resulting mass @xmath455 and stiffness @xmath225 defined in eqs .",
    "( [ ml ] ) take the form @xmath456 whereas the four - node mass @xmath457 introduced in ( [ m4 ] ) has the following elements .",
    "for a given @xmath29 , the only non - zero elements are those in which the other indices take the value @xmath29 , @xmath458 or @xmath459 .",
    "this gives the following non - zero elements @xmath460 the quartic contribution to the free energy function can be written as @xmath461    \\end{aligned}\\ ] ] by using ( [ mlpsi ] ) and ( [ 4nodemass ] ) , the gl free energy ( [ fgldis0 ] ) becomes in 1d the following function    @xmath462 \\right .",
    "\\nonumber\\\\ &      + \\left .",
    "\\frac{k}{2 } \\left [           -\\phi_{\\mu } \\phi_{\\mu+1 } \\frac{1}{{\\cal v}_{\\mu}^r }           + \\phi_{\\mu}^2           \\frac{{\\cal v}_\\mu^r + { \\cal v}_\\mu^l}{{\\cal v}_\\mu^r { \\cal           v}_\\mu^l }           -\\phi_{\\mu } \\phi_{\\mu-1 } \\frac{1}{{\\cal v}_\\mu^l }        \\right ]    \\right\\rbrace \\label{eq : glfediscrete}\\end{aligned}\\ ] ]    where @xmath463      we discuss now the temporal integrator for the stochastic diffusion equation ( [ eq : sdedisc ] ) @xmath464 for constant mobility the diffusion matrix in eq .",
    "( [ eq : dcte ] ) is constant and independent of @xmath122 @xmath465 the noise ( [ eq : finalnoise ] ) has the explicit form in 1d @xmath466 where @xmath467 and the vector @xmath468 is a collection of m independent white - noise processes . note that for periodic systems in 1d the number of elements ( which are segments between the nodes ) coincide with the number of nodes .    for the free energy function ( [ eq : glfediscrete ] ) the sde becomes @xmath469 where we have introduced @xmath470 we recognize a term @xmath471 which is linear in the concentration and a non - linear term @xmath472 due to the quartic contribution to the free energy .",
    "the linear term is just a discretization of a diffusion term combining second and fourth order derivatives . in order to avoid instabilities and to be able to use large time steps ,",
    "the linear term is treated implicitly , while the non - linear term is treated explicitly . by following the semi - implicit trapezoidal predictor - corrector scheme of refs .",
    "@xcite we may write the following temporal integrator scheme @xmath473 here , @xmath474 denotes a collection of standard gaussian random numbers generated independently at each time step . for regular lattices , the set of eqs .",
    "( [ eq : numintegrator ] ) can be computed efficiently by using fast fourier transform ( fft ) in any dimension . indeed , as we show in appendix  [ app : structure ]",
    "( see eq .",
    "( [ eigenm ] ) obtained from eq .",
    "( [ eq : intscheme ] ) ) , we may diagonalize the matrices in fourier space , obtaining a set of uncoupled sode .    for non",
    "uniform meshes we can not use the fft procedure , but we still have a set of tridiagonal matrices @xmath475 and @xmath476 ( see eq .",
    "( [ mlpsi ] ) ) . the right hand side of ( [ eq : numintegrator ] ) can be solved using a specialized backward substitution , which is by far more efficient than operating with the dense matrix @xmath477^{-1}$ ] . since the matrix on the left hand side in eq .",
    "( [ eq : numintegrator ] ) is a constant hermitian positive - definite matrix , it can be decomposed with a cholesky factorization , which allows us to solve eq .",
    "( [ eq : numintegrator ] ) efficiently .",
    "in this appendix we present analytic results for the gaussian model in both continuum and discrete settings .",
    "the main result is that the numerical algorithm closely matches not only the infinite resolution limit , but more importantly , it matches closely the predictions of the continuum theory for the fluctuations in finite resolution discrete lattices .",
    "the equilibrium correlation of the fluctuations of the concentration is translationally invariant @xmath478 for some function @xmath479 .",
    "due to translation invariance , the fourier transform @xmath480 of the function @xmath479 , known as the static structure factor , is given by @xmath481    note that @xmath482 , with @xmath483 , and @xmath397 is the relative fluctuations of the concentration field .",
    "the static structure factor is the fourier transform of the second moments of the functional probability @xmath484\\sim \\exp\\{-\\frac{1}{k_bt } { \\cal   f}[c]\\}$ ] . for a gaussian probability we may compute the second moments in a straightforward manner .",
    "the probability functional ( [ peq ] ) with the model @xmath485 $ ] given in ( [ ga ] ) can be written in operator notation as @xmath9 & \\propto\\exp\\left\\{-\\frac{1}{2 } \\int d{\\bf r}\\int d{\\bf r}'\\ , \\phi({\\bf r}){\\cal l}({\\bf r},{\\bf r } ' ) \\phi({\\bf r } ' ) \\right\\ } \\label{peqga}\\end{aligned}\\ ] ] where we have introduced the kernel @xmath486 the covariance of the gaussian probability functional is given by @xmath487 where @xmath488 is the inverse of the operator @xmath489 , satisfying @xmath490 by inserting the form of the operator @xmath489 one recognizes that the inverse operator is just the green s function @xmath491 , which satisfies @xmath492 the solution of this equation is obtained by going to fourier space .",
    "we introduce the fourier transform @xmath493 in fourier space , ( [ green ] ) becomes @xmath494 which gives @xmath495 where @xmath496 .",
    "therefore , the green function is @xmath497 and the covariance , or correlation function , is given by @xmath498    for @xmath499 this correlation takes the form @xmath500 for @xmath501 the result is @xmath502 where @xmath503 is a bessel function .",
    "finally , in @xmath504 the result is @xmath505 note that the quantity @xmath506 that gives the normalized fluctuations of the concentration field at a given point of space does not diverge in @xmath507 but it diverges in @xmath508 and 3d , a phenomenon known as the ultraviolet catastrophe .",
    "this means that the point - wise fluctuations are unbounded in dimensions higher than one .",
    "any particular realization of the field will be extremely rough .",
    "nevertheless , physical observables like the number of particles in a finite region are well behaved . from a physical point of view",
    "this quantity should be independent of the resolution used to discretize the problem .",
    "the number of particles in a region @xmath509 is given by @xmath510 and the relative fluctuations are given by @xmath511 the variance of this fluctuation is @xmath512 this quantity is finite for any finite volume but as the domain shrinks to a point it diverges in 2d logarithmically with the size of the domain , and in 3d inversely with the size of the domain , in agreement with ( [ d15 ] ) .      in this section",
    "we compute the dynamic structure factor for the gaussian model .",
    "assume a constant mobility @xmath244 in ( [ spde ] ) with the model @xmath513 $ ] in eq .",
    "( [ ga ] ) .",
    "the resulting spde is @xmath514 where we have introduced @xmath496 , @xmath8 is a white noise in space and time , this is , @xmath515 , and @xmath516 .",
    "let us solve the spde ( [ spdemucte ] ) by fourier transform @xmath517 where we have introduced the relaxation time @xmath518 the fourier transform of a white noise is also a white noise which obeys the properties , @xmath519 and @xmath520 .",
    "the linear equation ( [ spde_fourier ] ) has the explicit solution @xmath521    by multiplying with respect to the initial condition @xmath522 and averaging with respect to all possible equilibrium realization of the initial condition we obtain @xmath523 where the static structure factor is given in eq .",
    "( [ gk ] ) .",
    "as a first step in order to obtain the discrete static structure factor , we consider the integrator scheme ( [ eq : numintegrator ] ) for the discrete density field @xmath122 in the ga+@xmath89 model , given by @xmath524 which is a matricial sode .",
    "we seek for a transformation that renders the system diagonal , leading to a set of uncoupled sode trivial to solve for each @xmath525 value .",
    "the @xmath16 vectors @xmath526 for @xmath527 diagonalize simultaneously the three matrices involved in a 1d regular lattice of spacing @xmath237 , this is @xmath528 { \\bf v}(m )      = \\widehat{m}(m ) { \\bf v}(m)\\nonumber \\\\ { \\bf l}^{\\psi } { \\bf v}(m )      & = \\frac{2}{a}\\left[1-\\cos\\left(\\frac{2 \\pi m a}{l}\\right)\\right ] { \\bf v}(m )      = \\widehat{l}(m ) { \\bf v}(m ) \\nonumber \\\\ { \\bf n}^{\\psi } { \\bf v}(m )      & = \\frac{2}{\\sqrt{a}}\\sin\\left ( \\frac{\\pi m a}{l } \\right ) { \\bf v}(m )     = \\sqrt{\\widehat{l } }     = \\widehat{n}(m ) { \\bf v}(m ) \\label{eigenm}\\end{aligned}\\ ] ] these equations define the eigenvalues of the problem that will be used below .",
    "the ( continuum ) structure factor is defined as the fourier transform of the static correlation function @xmath529 eq .",
    "( [ gk ] ) shows that @xmath530 in order to compare numerical results from simulations with this theoretical results , it is necessary to take into account the effects of the discretization in the continuum expression . in this appendix",
    ", we obtain from ( [ sk1 ] ) the corresponding discrete structure factor predicted from the continuum theory taking into account the lattice spacing effects .",
    "explicit results are presented for a regular periodic 1d lattice .",
    "we introduce the fourier series representation of the continuum concentration field @xmath531 where the sum is over all those @xmath532 , with integer @xmath533 .",
    "the fourier coefficients are given by @xmath534 note that translation invariance @xmath535 implies that @xmath536 where @xmath288 are the fourier coefficients of @xmath537 , @xmath538 and we are abusing notation and understand @xmath539 as the kroenecker delta @xmath540 for the integers @xmath541 corresponding to @xmath542 .",
    "[ sktsk ] .",
    "we express the second moments of the probability @xmath192 in terms of the continuum structure factor @xmath288 obtained above @xmath543 where we have defined the fourier transform of the basis function @xmath544    from the linear relationship between basis functions @xmath545 we obtain directly the explicit functional form for the fourier transform of the basis function @xmath546 with the corresponding fourier transform of the basis function @xmath547 for a 1d regular grid of lattice spacing @xmath237 given by @xmath548    note that for @xmath549 , we have @xmath550 , which , from ( [ deltamuk ] ) and ( [ lc ] ) is what it should be .",
    "( [ cmucnu ] ) gives the covariance of the discrete field in real space , in terms of the structure factor , but we are interested in the covariances of the discrete fourier transform of the discrete field . to this end",
    ", we introduce the discrete fourier transform @xmath551 with @xmath275 of the discrete concentration field @xmath273 according to @xmath552 we define the discrete static structure factor @xmath553 as the covariance of the discrete fourier components @xmath280 @xmath554 where @xmath555 and we have introduced the doubly fourier transformed basis function @xmath556 where @xmath557 and we have used the mathematical identity @xmath558 in this way , we have @xmath559 ^ 2 \\quad\\quad\\quad\\quad \\mbox{where } \\quad k=\\frac{2\\pi}{l}m \\label{sc10}\\end{aligned}\\ ] ] note that we have @xmath560 and thus @xmath561 ^ 2 \\label{sc1}\\end{aligned}\\ ] ] after inserting ( [ sk1 ] ) into ( [ sc1 ] ) we obtain the discrete structure factor for the ga+@xmath89 model , @xmath281 ^ 2 } \\sum_{\\alpha\\in\\mathbb{z } } \\frac{\\mathrm{sinc}^4\\left(\\frac{ka}{2}-\\pi\\alpha\\right ) } { 1+\\left(\\frac{k}{k_0}-\\frac{2\\pi \\alpha } { k_0a}\\right)^2 } \\label{scfin - app}\\end{aligned}\\ ] ] where @xmath278 .",
    "note that in the limit of high resolution @xmath282 , the only term that contributes in the sum over @xmath283 is @xmath284 . in this limit , the discrete structure factor ( [ scfin - app ] ) converges towards the continuum limit ( [ sk1 ] ) .",
    "( [ scfin - app ] ) gives the the fluctuations of the discrete concentration variables as obtained from the continuum theory and our definition of the coarse - grained variables .    in the limit",
    "@xmath562 corresponding to the ga model , ( [ scfin - app ] ) becomes @xmath563 } \\label{sckga}\\end{aligned}\\ ] ] where @xmath564 .",
    "this is indeed the correct result of the ga model as it can be shown by a more direct route . in the ga model ,",
    "we know that the second moments of the probability functional are given by @xmath565 where ( [ natural ] ) has been used .",
    "next , by using eq .",
    "( [ eigenm ] ) we obtain @xmath566 } \\label{d50}\\end{aligned}\\ ] ] which coincides with ( [ sckga ] ) .",
    "the static structure function ( [ sk1 ] ) has been computed from the second moments of the probability functional and can also be obtained from the following argument that involves the continuum dynamic equation ( [ spde_fourier ] ) . in the limit",
    "@xmath567 , a simple euler integrator scheme for eq .  ( [ spde_fourier ] ) gives @xmath568 if we multiply this equation by itself and average we obtain @xmath569 where we have neglected terms of order @xmath570 . at equilibrium @xmath571 , so that @xmath572 which coincides with ( [ sk1 ] )",
    ".    the same strategy may be used to compute the discrete structure factor , by using the discrete time stepping scheme , and thus including effects due to the finite time step @xcite . in this way",
    ", one may obtain an exact prediction for the discrete structure factor @xmath287 that is produced by the numerical code .",
    "if the code is meant to reproduce the structure factor predicted by the continuum theory , we should have @xmath573 for sufficiently small times .",
    "the only difference from the procedure used to derive eq .",
    "( [ eq : acf_k ] ) is that both @xmath574 and @xmath321 are to be replaced by their corresponding discrete counterparts .",
    "namely , @xmath321 can simply be read from the fact that in the discrete setting the integrator scheme is given , in the ga@xmath285 model , by eq .",
    "( [ eq : numintegrator ] ) with no explicit part . in fourier space ,",
    "this equation should give us eq .",
    "( [ eq : eulerintegrator ] ) .",
    "if we equal ( [ eq : eulerintegrator ] ) with the equivalent ( [ eq : numintegrator ] ) in fourier space we obtain @xmath575 in the same way , the discrete @xmath574 term can be obtained from the covariance of the noise term that appears in ( [ eq : eulerintegrator ] ) , which should coincide with the noise term in ( [ eq : numintegrator ] ) , giving as a result @xmath576 , where we have neglected terms of order @xmath577 .    in this way , the equivalent of eq .",
    "( [ eq : acf_k ] ) for the discrete structure factor will be @xmath578}\\frac{1}{1+\\frac{k^2}{k_0 ^ 2}\\left(\\frac{3 \\mathrm{sinc}^2(ka/2)}{(2+\\cos ka)}\\right)}\\end{aligned}\\ ] ]"
  ],
  "abstract_text": [
    "<S> we present a finite element discretization of a non - linear diffusion equation used in the field of critical phenomena and , more recently , in the context of dynamic density functional theory . </S>",
    "<S> the discretized equation preserves the structure of the continuum equation . specifically , it conserves the total number of particles and fulfills an h - theorem as the original partial differential equation . </S>",
    "<S> the discretization proposed suggests a particular definition of the discrete hydrodynamic variables in microscopic terms . </S>",
    "<S> these variables are then used to obtain , with the theory of coarse - graining , their dynamic equations for both averages and fluctuations . </S>",
    "<S> the hydrodynamic variables defined in this way lead to microscopically derived hydrodynamic equations that have a natural interpretation in terms of discretization of continuum equations . </S>",
    "<S> also , the theory of coarse - graining allows to discuss the introduction of thermal fluctuations in a physically sensible way . </S>",
    "<S> the methodology proposed for the introduction of thermal fluctuations in finite element methods is general and valid for both regular and irregular grids in arbitrary dimensions . </S>",
    "<S> we focus here on simulations of the ginzburg - landau free energy functional using both regular and irregular 1d grids . </S>",
    "<S> convergence of the numerical results is obtained for the static and dynamic structure factors as the resolution of the grid is increased . </S>"
  ]
}