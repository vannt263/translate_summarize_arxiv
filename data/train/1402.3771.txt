{
  "article_text": [
    "all living organisms on earth harbor within their dna a signature of their evolutionary heritage . by studying patterns and differences between the genetic makeup of different species ,",
    "molecular biologists are able to piece together parts of the story of how life today traces back a common origin . in this way",
    ", many basic questions can be answered . when did animals and plants diverge ? are fungi more closely related to plants or animals ?",
    "how and when did photosynthesis arise ? what is the closest living animal to the whales ?",
    "does speciation occur in bursts or at a steady rate ?",
    "other topics are proving more difficult to resolve  for example , deciphering the earliest history of life on earth .",
    "similar questions arise for evolutionary processes in other fields such as epidemiology ( e.g. the relationship between different strains of influenza or hiv ) and linguistics ( e.g. how languages diverged from one another over time ) .",
    "in all these fields , the analysis relies on an underlying mathematical theory , grounded in combinatorics , algebra , and stochastic processes , with the concept of an evolutionary tree as a unifying object .    in this article ,",
    "i describe a cross - section of some of the key concepts in ` phylogenetics ' , which is the theory of reconstructing and analyzing trees and networks from data observed at the present .",
    "i describe some combinatorial features of phylogenetic trees , namely their encoding by set systems , their enumeration , their generation under random models of evolution , and the way in which they can ` perfectly ' display discrete data .",
    "i then focus on tree reconstruction from data ( discrete or distance - based ) , which may not perfectly fit a tree .",
    "such imperfect data can occur when data ` evolve ' along the branches of the tree under a random markov model .",
    "i end by outlining how tree reconstruction is possible from this evolved data , but the choice of method requires care , to avoid falling into a ` zone ' of statistical inconsistency .",
    "the 18th century swedish taxonomist carl linneaus noticed that much of the living world can be nicely organised into a ` hierarchy ' in which groups of living organisms are either disjoint or nested @xcite .",
    "for example , cats and dogs comprise disjoint classes of organisms , but both are subsets of the class of mammals .",
    "formally , a _ hierarchy _",
    "@xmath0 on a finite set @xmath1 is a collection of subsets of @xmath1 with the property that any two elements of @xmath0 are either nested ( one is contained in the other ) or disjoint .",
    "it will also be convenient here to require that any hierarchy on @xmath1 contains the set @xmath1 and all its singleton subsets .",
    "thus @xmath0 forms a hierarchy if it satisfies the two properties :    * for any two sets @xmath2 we have @xmath3 ; and * @xmath0 contains the entire set @xmath1 , and each singleton set @xmath4 for all @xmath5 .",
    "the second condition is harmless : if @xmath0 is any collection of sets that satisfies * h1 * , we can always add the extra elements mentioned by * h2 * without violating * h1*.    to connect hierarchies with trees , recall first that a _ tree _ @xmath6 is a connected graph @xmath7 with no cycles .",
    "often we will deal with rooted trees for which the edges are all directed away from some root vertex , and so each vertex has an ` in - degree ' and ` out - degree ' .",
    "we first define a _ rooted phylogenetic @xmath1-tree _ to be a tree @xmath6 in which :    * @xmath1 is the set of leaves ( vertices of out - degree 0 ) ; * all the arcs ( directed edges ) are directed away from some root vertex @xmath8 ; * every non - leaf vertex has out - degree at least 2 .",
    "-tree , with root @xmath8 .",
    "( b ) the associated unrooted tree obtained by suppressing the root vertex ]    fig .",
    "1(a ) shows a simple biological example of a phylogenetic @xmath1-tree for a set @xmath1 of five species ; it reveals one relationship that is perhaps surprising to most non - biologists : genetic data indicates that fungi are more closely related genealogically to animals than to plants .",
    "the interior vertices of a phylogenetic tree represent hypothetical ancestral species , with the root @xmath8 being the ` most recent common ancestor ' of the species at the leaves .",
    "we will think of two rooted @xmath1-trees as equivalent if they are isomorphic as rooted trees by an isomorphism that is the identity on @xmath1 ( i.e. trees are equivalent up to relabelling of the non - leaf vertices ) . given a vertex @xmath9 of @xmath6 ,",
    "the _ cluster _ associated with @xmath9 is the subset of @xmath1 that becomes separated from the root upon deletion of @xmath9 . for the tree in fig  [ tree1](a ) ,",
    "the sets @xmath10 and @xmath11 are clusters .",
    "any collection @xmath12 of subsets of @xmath1 forms a directed graph , sometimes called the ` cover digraph ' of @xmath12 .",
    "the vertices of this graph are the elements of @xmath12 and we place an arc from @xmath13 to @xmath14 precisely if @xmath15 covers @xmath16 ( i.e. @xmath17 and there is no set @xmath18 with @xmath19 ) .",
    "now , the clusters of any phylogenetic @xmath1-tree @xmath6 form a hierarchy on @xmath1 , and the cover digraph of this hierarchy is isomorphic to @xmath6 under the map that sends each vertex of @xmath6 to the cluster associated with that vertex . moreover",
    ", every hierarchy can be realized in this way , and nonequivalent phylogenetic trees give rise to different hiearchies . in other words",
    ", we have the following fundamental bijective correspondence between hierarchies and rooted phylogenetic @xmath1-trees ( up to equivalence ) @xcite .    [ equiv ] a collection of subsets @xmath0 of @xmath1 is a hierarchy if and only if @xmath0 is the set of clusters of some rooted phylogenetic @xmath1-tree @xmath6 .",
    "moreover , @xmath6 is unique up to equivalence .",
    "the maximal hierarchies correspond to rooted phylogenetic @xmath1-trees in which every non - leaf vertex of @xmath6 has out - degree 2 , which are called _ binary _ trees ( the tree in fig .",
    "1(a ) is an example ) .",
    "we will see shortly that such trees have exactly @xmath20 vertices where @xmath21 , and so ( by lemma  [ equiv ] ) this is the size of the largest hierarchy on a set of size @xmath22 .",
    "biologists often prefer trees to be binary since they show just one lineage splitting off at a time ; by contrast a vertex of out - degree three or more represents what biologists call a ` polytomy ' ( usually interpreted as uncertainty about the order of speciation events , rather than certainty about a sudden speciation event into multiple lineages ) .",
    "the utility of viewing a rooted phylogenetic tree as a set system ( a hierarchy ) is illustrated by two questions biologists often face .",
    "suppose we have a collection of different trees that estimate the evolutionary history of the same set of taxa .",
    "these trees might have been constructed by comparing genetic data across these species , but different choices of which genetic data to use ( e.g. different genes ) could have resulted in different tree estimates . in other words , while there might be one underlying and unknown ` true ' species tree that we wish to infer , the phylogenetic trees constructed from data will typically be merely imperfect estimates of this tree , since the data evolves randomly , a topic we will discuss later .",
    "so two problems arise :    * how can we compare different phylogenetic @xmath1-trees ?",
    "* can we combine different phylogenetic @xmath1-trees into some ` consensus ' tree ?",
    "the hierarchy link provides a very simple solution to both questions .",
    "first , observe that we can define a distance @xmath23 between any two rooted phylogenetic @xmath1-trees @xmath6 and @xmath24 by taking @xmath25 to be the number of clusters which are present in one but not both of the trees @xmath6 and @xmath24",
    ". this distance @xmath23 is called the ` robinson ",
    "foulds metric ' ; it satisfies the triangle inequality and it can be computed quickly .    turning to the consensus question ,",
    "given a sequence of rooted phylogenetic @xmath1-trees @xmath26 , let @xmath27 be the set of clusters that are present in more than half of the corresponding hierarchies .",
    "in other words , if @xmath28 is the hierarchy on @xmath1 corresponding to @xmath29 then @xmath30 the following lemma shows that @xmath27 forms the set of clusters of a tree , the so - called ` majority rule ' consensus tree .",
    "@xmath27 forms a hierarchy , and so corresponds to a rooted phylogenetic @xmath1-tree .",
    "_ proof : _ suppose @xmath31 . by the ` pigeonhole principle ' , there must be some hierarchy @xmath32 that contains both @xmath33 and @xmath34 .",
    "consequently , @xmath33 and @xmath34 are either disjoint or one is nested in the other .",
    "as this holds for all @xmath35 , condition * h1 * holds .",
    "moreover , * h2 * holds also , since @xmath4 and @xmath1 are elements of @xmath32 for every @xmath36 and every @xmath5 .",
    "thus , @xmath27 forms a hierarchy and so ( by lemma  [ equiv ] ) , corresponds to a rooted phylogenetic @xmath1-tree that is unique up to equivalence .",
    "@xmath37    the majority rule consensus tree has the nice combinatorial property that it comes as ` close as possible ' , on average , to the input trees @xmath26 under the robinson - foulds metric ; more precisely , it is a ` median ' tree @xmath6 that minimizes @xmath38 @xcite",
    ".      rooted trees appeal to biologists since they show evolution happening in the time , from the past to the present .",
    "but it is often more convenient to consider unrooted trees .",
    "one reason is that most methods for building trees from data can usually do so only up to the placement of the root , and so produce unrooted trees ( figuring out where the root goes usually comes later ) .",
    "also , from a mathematical perspective , unrooted trees are often the more natural object to consider .",
    "the choice to work with either rooted or unrooted trees is somewhat analogous to the distinction in classical geometry between the affine and projective settings ( respectively ) , where also one viewpoint may have advantages over the other , depending on the questions at hand .    *",
    "definition : * an _ ( unrooted ) phylogenetic @xmath1-tree _ is a tree @xmath6 with leaf set @xmath1 and with every interior ( i.e. non - leaf ) vertex of degree at least two . if the degree of every non - leaf vertex is exactly three , we say that @xmath6 is a _ binary phylogenetic @xmath1-tree_.    here is a first property of such trees , which will be useful in the next section .",
    "[ edge ] any unrooted binary phylogenetic tree @xmath6 with @xmath22 leaves has @xmath39 edges .",
    "_ proof : _ a standard result in elementary graph theory states that a connected graph is a tree if and only if the number @xmath40 of vertices exceeds the number @xmath41 of edges by 1 .",
    "so if our tree @xmath6 has @xmath42 interior vertices , we have @xmath43 and so : @xmath44 also , for any graph , the ` handshake lemma ' tells us that the sum of the degrees of the vertices of any finite graph equals @xmath45 , since each edge is counted twice in this sum .",
    "now , for our tree @xmath6 , the sum of the degrees is @xmath46 + [ 3 + 3+\\cdots + 3 ( i \\mbox { times})]$ ] and so : @xmath47 combining eqns .",
    "( [ eeq ] ) and ( [ 2eeq ] ) we see that @xmath48 , and so @xmath49 , which implies that @xmath50 .",
    "this completes the proof of lemma  [ edge ] .",
    "@xmath37    we will let @xmath51 and @xmath52 be the sets of rooted and unrooted phylogenetic @xmath1-trees ( up to equivalence ) , and @xmath53 and @xmath54 will denote the sets of rooted and unrooted phylogenetic @xmath1-trees .",
    "thus when @xmath1 has just four elements , @xmath54 consists of the three _ quartet trees _ , while @xmath52 has one additional ` star ' tree , that has a single non - leaf vertex of degree four .",
    "when @xmath55=\\{1,\\ldots , n\\}$ ] , we will write @xmath56 and @xmath57 for @xmath58 and @xmath54 , respectively .      counting trees has a long tradition in mathematics , with cayley s @xmath59 formula from 1889 for the total number of trees on @xmath22 labelled vertices , the most famous example .",
    "counting binary phylogenetic trees turns out to be much easier , and it has a history that dates back to even earlier mathematical work , contemporary with darwin @xcite . to explain this , we first describe a close connection between rooted and unrooted phylogenetic trees",
    "there are two natural ways to associate an unrooted phylogenetic @xmath1-tree with a rooted tree .    * _ adding an outgroup : _ take a rooted phylogenetic tree on @xmath60 and attach @xmath61 to the root of @xmath6 by a new edge .",
    "species @xmath61 is called an ` outgroup ' species . * _ suppressing the root : _ simply ignore the root vertex @xmath8 ; if it has degree 2 then delete it and identify its two incident edges , while if the root has degree at least three then just treat this vertex as an interior vertex with no special root status .",
    "an example is shown in fig .",
    "[ tree1 ] .",
    "notice that the operation ` adding an outgroup ' provides a bijection : @xmath62 which restricts to a bijection from @xmath63 to @xmath54 . on the other hand ,",
    "` suppressing the root ' results in a surjective map : @xmath64 which restricts to a surjective map from @xmath53 to @xmath54 . moreover , the number of elements of @xmath53 which map to the same tree in @xmath65 is the number of edges in @xmath6 , which lemma  [ edge ] tells us is @xmath39 .",
    "( @xmath21 ) .",
    "these observations show us that : @xmath66 in particular , if @xmath67 is the number of rooted binary phylogenetic trees on a leaf set of size @xmath22 then @xmath68 , which , together with @xmath69 , gives : @xmath70 this product of the odd numbers is often written as the double factorial ( in this case , @xmath71 ) .",
    "notice that it can be expressed in terms of ordinary factorials and powers of @xmath72 as follows :    @xmath73    graph theorists may recognize this quantity : it is the number of perfect matchings of a complete graph on @xmath74 vertices . in other words , if there are @xmath74 people in a room , eqn .",
    "( [ rntree ] ) counts the number handshake scenarios in which each person shakes hands with precisely one other person .",
    "the bijection between this set of scenarios and set @xmath75 is an interesting but nontrivial exercise @xcite .    applying stirling s approximation @xmath76 to eqn .",
    "( [ rntree ] ) , reveals that @xmath67 grows very rapidly .",
    "for example , @xmath77 is around than 34 million , while @xmath78 ) is more than @xmath79 .",
    "biologists often want to build trees for hundreds ( or even thousands ) of species ; so it s no surprise that mathematics has an important role to play in this task , as it would be impossible to check each tree to see how well it might ` fit the data ' .",
    "there is another way to arrive at eqn ( [ rntree ] ) , by using generating functions .",
    "if we consider the formal power series @xmath80 then : @xmath81 since deleting the root of a tree @xmath82 for @xmath83 results in two rooted binary trees ( or an isolated leaf ) on leaf sets @xmath84 and @xmath85 that partition @xmath86 $ ] .",
    "solving this quadratic equation gives @xmath87 , from which @xmath67 pops out as @xmath88 times the coefficient of @xmath89 in @xmath90 . while this is a more complicated derivation , generating functions turn out to be very useful in other applications  for example , in deriving exact explicit formulae for the number of ` forests ' of rooted binary trees on a given leaf set .",
    "for the number @xmath91 of unrooted binary trees on a leaf set of size @xmath22 , the bijection @xmath92 described above gives @xmath93 nonbinary phylogenetic trees ( rooted and unrooted ) can also be counted using recursions , but a closed - form expression like that for binary trees is lacking .",
    "if we ignore the labeling of the leaves of a rooted or unrooted phylogenetic tree , we obtain a ` tree shape ' .",
    "for example , when @xmath94 , there are two rooted binary tree shapes : the ` fork ' tree shape and the ` pectinate ' tree shape , shown in fig .",
    "[ shapesfig](a , b ) .",
    "biologists are interested in the shapes of trees , since they shed light on the process of speciation and extinction in evolution",
    ".    elementary group theory provides a nice trick to count the number of phylogenetic @xmath1-trees of a given shape using the ` orbit - stablizer theorem ' .",
    "given a finite group @xmath95 which acts on a set @xmath96 , let @xmath97 denote the orbit of @xmath98 under the action of @xmath95 , and let @xmath99 be the stabilizer subgroup of @xmath95 . then the orbit stabilizer theorem provides a bijection between the orbit of @xmath98 and the cosets of @xmath100 in @xmath95 , and so , in particular : @xmath101 in ( c ) ) correspond to reflections . in ( e )",
    "an unrooted tree shape with a symmetry of order @xmath102 about the central vertex is shown . ]",
    "there is a natural action of the symmetric group @xmath103 of permutations on @xmath86 $ ] on the set @xmath104 : given @xmath105 , simply permute the leaves of each tree @xmath6 by replacing leaf @xmath61 by leaf @xmath106 .",
    "this action restricts to an action on the set @xmath75 of rooted binary trees , and so , by ( [ oseq ] ) , the number of trees in @xmath75 that have the same shape as some tree @xmath6 is @xmath107 .",
    "now @xmath108 is a group of order @xmath109 where @xmath110 is the number of _ symmetry vertices _ of @xmath6  these are interior vertices for which the two subtrees of @xmath6 that the vertex separates from the root have the same shape .",
    "for example , for a phylogenetic tree having the ` fork ' tree shape in fig .",
    "[ shapesfig](a ) , @xmath6 has three symmetry vertices and so @xmath108 is a group of order eight .",
    "this group turns out to be isomorphic to the dihedral group of rotational and reflectional symmetries of a square , as illustrated in fig .",
    "[ shapesfig](c , d ) .",
    "in particular , for any set @xmath1 of size four , there are precisely @xmath111 rooted binary @xmath1-trees that have the shape of the fork tree ; by contrast , the pectinate tree ( fig .  [ shapesfig](b ) ) has only one symmetry vertex , and so there are 12 rooted binary phylogenetic @xmath1-trees of this shape .    for unrooted binary trees and nonbinary trees , similar formulae apply , though more complex symmetries arise ; for example , an unrooted binary tree can have a 2-fold symmetry about a central edge and , in the case of the tree shape shown in fig .  [ shapesfig](e ) , a symmetry of order @xmath102 about a central vertex .",
    "in general , the group @xmath108 is usually described using ` wreath products ' .",
    "although extinction has played a major role in the history of life ( after all , most species are extinct ) , suppose we sample some subset @xmath1 of species present today ( species @xmath112 in fig .",
    "[ birth ] ( i ) ) and then consider the minimal tree linking these species .",
    "this results in the so - called ` reconstructed tree ' illustrated in fig .  [ birth ] ( ii ) .",
    "let s think of this as a rooted phylogenetic @xmath1-tree ( ignoring the length of the edges ) .",
    "it turns out that , under very general assumptions concerning the speciation - extinction process , many models predict an identical and simple discrete probability distribution on @xmath53 @xcite .",
    "this distribution is called the _ yule  harding ( yh ) _ distribution , and it is easily described as follows : to obtain a binary tree shape , we start with a tree shape on two leaves and sequentially attach leaves  at each step attaching a new leaf to one of the leaf edges chosen uniformly at random from the tree constructed so far . for example , the probabilities of generating the fork and pectinate tree shapes are 1/3 and 2/3 , respectively , since from the ( unique ) tree shape on three leaves , we can place a new leaf on one leaf - edges to obtain a fork tree shape , or on two edges to obtain a pectinate tree shape ( see fig .  [ birth](iii ) ) .",
    "once we have built up a tree with @xmath22 leaves in this way we obtain a random tree shape on @xmath22 leaves , and we can now label the leaves of this tree shape according to a permutation on @xmath113 chosen uniformly at random .",
    "this is the yule  harding probability distribution on @xmath75 .",
    "curiously , a quite different process that arises in population genetics , and which proceeds backward in time ( rather than forward , like fig .  [ birth](iii ) ) also leads to the yh distribution when we ignore the length of the edges .",
    "this is the celebrated ` coalescent process ' of sir john kingman from the early 1970s .",
    "we now explain how to compute the probability of a yh tree shape and of any rooted phylogenetic tree with this shape .",
    "first let s grow a tree under the yh process until it has @xmath22 leaves , and then select one of the two subtrees incident with the root ( say the ` left - hand one ' , since the orientation in the plane plays no role ) and let @xmath114 denote the number of leaves in this tree .",
    "remarkably , @xmath114 has a completely flat distribution .",
    "[ unif_lem ] @xmath114 has a uniform distribution between 1 and @xmath115 , so @xmath116    _ proof : _ the random process @xmath117 can be exactly described as a special case of a classical process in probability called _ polya s",
    "urn_. this consists of an urn that initially has @xmath118 blue balls and @xmath119 red balls . at each step",
    ", a ball is sampled uniformly at random and it is returned to the urn along with another ball of that same color . in our setting , @xmath120 and ` blue ' corresponds to the left - hand subtree and ` red ' the right - hand subtree in the yule  harding tree . at each step",
    "the uniform process of leaf attachment ensures that @xmath114 has exactly the same probability distribution as the number of blue balls in the urn after @xmath121 steps .",
    "it is well known , and easily shown by induction , that in polya s urn with @xmath120 , the proportion of blue balls has a uniform distribution .",
    "@xmath37    this lemma provides the key to computing the yh probability of a tree exactly , as follows .",
    "[ yhprob ] for any particular tree @xmath82 , the probability @xmath122 of generating @xmath6 under the yh model is given by : @xmath123 where @xmath124 is the set of interior vertices of @xmath6 , and where @xmath125 is @xmath126 plus the number of leaves of @xmath6 that are descendants of @xmath9 .",
    "for example , for the tree in fig .",
    "[ tree1](a ) , @xmath127 , while for fig .",
    "[ birth](ii ) , @xmath128 .",
    "_ proof : _ suppose that the two maximal subtrees @xmath129 and @xmath130 of @xmath6 are of size @xmath131 and @xmath132 , where we may assume that @xmath133 .",
    "by lemma  [ unif_lem ] the probability of such a size distribution is @xmath134 if @xmath135 and @xmath136 if @xmath137 .",
    "conditional on this division , the number of ways to select leaf sets for @xmath129 and @xmath130 that partition @xmath86 $ ] is @xmath138 when @xmath135 , and @xmath139 when @xmath137 ( the factor of @xmath140 recognises that the order of @xmath129 and @xmath130 is interchangeable in @xmath6 when they have the same number of leaves ) . by the markovian nature of the yh process",
    ", each of these two subtrees also follows the yh distribution .",
    "this leads to the recursion : @xmath141 from which proposition ( [ yhprob ] ) now follows by induction .",
    "@xmath37    notice that the yh process leads to a different probability distribution on @xmath75 from that obtained by simply selecting a tree uniformly at random from @xmath75 , which would assign each @xmath82 the probability @xmath142 to see that this is different from the yh distribution , observe that the probability of obtaining a tree with the ` fork ' in fig .",
    "[ shapesfig](a ) has probability @xmath143 under a uniform distribution on @xmath144 ( since only 3 of the 15 trees in @xmath144 have that shape ) and @xmath145 under yh .",
    "there are several more general differences between the uniform and yh distributions .",
    "for instance , in yh trees on @xmath22 leaves , the expected average number of edges between the root and the leaves grows at the rate @xmath146 , while for uniform binary trees , it grows at the rate @xmath147 .",
    "yh trees also tend to be more ` balanced ' than uniform trees , where balance refers to the average difference between the sizes of the two daughter subtrees in the tree , as one ranges over the interior vertices of the tree .",
    "for example , lemma  [ yhprob ] shows that the probability that tree with @xmath22 leaves generated under the yh distribution has a single leaf adjacent to the root is @xmath148 , while for the uniform distribution the corresponding probability is @xmath149 which converges to @xmath140 as @xmath22 grows .",
    "it turns out that many ` real ' phylogenetic trees tend to have a degree of balance somewhere between that predicted by the yh and uniform distributions ; explaining why has required some new mathematical and statistical insights @xcite .",
    "in section  [ unro ] we described a one - to - one correspondence between unrooted phylogenetic @xmath1-trees and rooted phylogenetic @xmath1-trees on @xmath60 ( for any @xmath150 ) , and thereby to hierarchies on @xmath60 .",
    "however , the choice of a particular element @xmath150 is completely arbitrary , so we seek a more satisfactory way to describe an unrooted phylogenetic @xmath1-tree .",
    "this is based on the notion of an _",
    "@xmath1-split _ , which is a bipartition of @xmath1 into two nonempty parts ( @xmath16 and @xmath15 , say ) , and written as @xmath151 .",
    "such a notion has clear biological meaning  for example , we can divide all life into the ` vertebrates ' and the ` invertebrates ' . given any phylogenetic @xmath1-tree @xmath6 , if we delete any particular edge @xmath152 of @xmath6 and consider the leaf sets of the two connected components of the resulting disconnected graph we obtain a corresponding @xmath1-split , which we will refer to as a _ split of @xmath6 _ that corresponds to @xmath152 .",
    "for example , for each @xmath150 , every phylogenetic @xmath1-tree has the _ trivial split _",
    "@xmath153 , corresponding to the edge incident with leaf @xmath61 .",
    "notice that any two splits @xmath154 and @xmath155 of the same phylogenetic @xmath1-tree have the property that one of the four intersections @xmath156 is empty .",
    "if a collection @xmath157 of @xmath1-splits has this property , we say that @xmath157 is _ pairwise compatible_. this is the unrooted analogue of the hieararchy property * h1 * , so it is not surprising that lemma  [ equiv ] has an equivalent formulation for unrooted trees :    _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ a collection @xmath157 of @xmath1-splits is the set of splits of some unrooted phylogenetic @xmath1-tree @xmath6 if and only if @xmath157 is pairwise compatible and contains the trivial splits .",
    "moreover , @xmath6 is uniquely determined up to equivalence by @xmath157 . _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _    we can extend the notion of splits further . instead of deleting a single edge , we may delete a set @xmath158 of @xmath159 edges from a tree , and consider the resulting @xmath160 components of the disconnected graph @xmath161 .",
    "this gives an equivalence relation @xmath162 on @xmath1 where @xmath163 precisely if @xmath61 and @xmath164 are connected in @xmath161 .",
    "the equivalence classes of @xmath162 comprise a partition of @xmath1 into at most @xmath160 parts .",
    "any such partition of @xmath1 that can be obtained in this way is said to be _ convex _ on @xmath6 , a concept that is relevant to the next part of the story .",
    "a function from the set of species @xmath1 into some set @xmath96 of @xmath165 states is referred to by biologists as an @xmath165-state _ character _ on @xmath1 .",
    "for example , @xmath166 might be a morphological character that describes the number of legs that species @xmath61 has , or a genetic character the describes the nucleotide at a particular position in a genetic sequence for species @xmath61 .",
    "that is , @xmath166 describes some ` characteristic ' of @xmath61 that we compare across other species in @xmath1 .",
    "a hypothetical example of four characters across a set of eight well - known species , is provided in the table below , and will serve to illustrate several ideas that follow . if we regard each of the possible states as ( say ) letters of the alphabet , then we can associate a four - letter ` word ' to each species .    [ cols=\"<,<,<,<,<,<\",options=\"header \" , ]     if a phylogenetic @xmath1-tree describes the evolution of a set of species , a character tells us the states of the species at the leaves , but not of the hypothetical ancestral species that correspond to the interior vertices of the tree .",
    "there are myriad ways to explain how the character could have evolved in the tree from some ancestral state at the root .",
    "it is possible that in a path from the root to a leaf a _ reversal _ occurs , where a state @xmath167 changes to state @xmath168 and later back to @xmath167 ; for example , in birds wings first evolved and then in some species ( e.g. kiwi ) disappeared again .",
    "it is also possible for ` convergent ' evolution to occur , where state @xmath167 at some vertex changes to @xmath168 down two edge - disjoint paths that start from that vertex .",
    "again wings provide an example - from an ancestor of birds and mammals , wings evolved both in birds and in mammalian bats .",
    "a character whose evolution on a given tree can be explained without postulating any reversal or convergent events is said to be ` homoplasy - free ' .",
    "homoplasy - free evolution might be expected to hold when the number of potential states is very large , so each change is likely to be to a new state ( for example , the order of genes on a chromosome under random rearrangement operations ) ; or when the rate of state change is very low .",
    "the notion of homoplasy - free can be defined more easily if we suppress the rooting of the tree and so consider unrooted trees .",
    "formally , we will say that a character @xmath169 on @xmath1 is _ homoplasy - free _ on an unrooted phylogenetic @xmath1-tree @xmath6 if states can be assigned to the interior vertices of @xmath6 so that the path between any two vertices that are assigned the same state contains only vertices that are also assigned the same state .",
    "in other words , @xmath170 has an extension @xmath171 to the set @xmath172 of all vertices of @xmath6 so that for each @xmath173 , the subgraph of @xmath6 induced by the set of vertices @xmath9 with @xmath174 is connected .",
    "there are two other ways to characterize when a character @xmath170 is homoplasy - free on a phylogenetic @xmath1-tree @xmath6 :    * @xmath169 has an an extension @xmath175 to all the vertices of @xmath6 for which @xmath175 assigns different states to the endpoints of @xmath176 edges ( equivalently , at most @xmath176 edges ) ; * the partition of @xmath1 induced by the equivalence relation `` @xmath177 '' is convex on @xmath6 ( as defined just prior to section  [ carsec ] ) .",
    "notice that homoplasy - free is considerably weaker than requiring that the actual evolution of the character on some rooting of the tree involved no reversals or convergent evolution  it merely requires that the character _ could _ have evolved in this way .",
    "a sequence @xmath178 of characters on @xmath1 is said to have a _ perfect phylogeny _ if and only if there exists a phylogenetic @xmath1-tree on which each character is homoplasy - free ( the tree is said to be a perfect phylogeny for those characters ) .",
    "we will see soon that our eight - species example above forms a perfect phylogeny .",
    "the computational problem of determining whether or not a collection of characters has a perfect phylogeny is np - complete in general , but a polynomial - time algorithm exists when a bound is placed on either the number of characters or the number of states per character . in the special cases where @xmath179 and @xmath180 a collection of @xmath165-state characters has a perfect phylogeny if and only if every subset of the characters of size @xmath165 has one .",
    "however the ` if ' direction fails for larger values of @xmath165 , as there is a set of @xmath181 characters on @xmath182 states that do not have a perfect phylogeny even though every proper subset does @xcite .",
    "the existence of a perfect phylogeny for a sequence of characters on @xmath1 also has an attractive graph theoretic characterization involving intersection graphs ( for details , see @xcite ; more recent graph - based analysis of related approaches appears in @xcite ) .",
    "when a sequence of characters has a perfect phylogeny @xmath6 , we can also ask when it is unique .",
    "a necessary condition for this is that @xmath6 is binary ; otherwise , we could arbitrarily resolve any vertex of @xmath6 of degree greater than three , and obtain a different tree on which all the characters were homoplasy - free .",
    "an interesting question now arises : what is the smallest number @xmath183 so that for each @xmath184 , there is a sequence of @xmath183 characters on @xmath86 $ ] that has @xmath6 as a unique perfect phylogeny ? if we restrict ourselves to binary characters , then @xmath185 since for any @xmath184 , the sequence of 2-state characters corresponding to the @xmath186 non - trivial splits of @xmath6 have this tree as their unique perfect phylogeny , and none of these characters could be removed ( otherwise we could contract the corresponding edge and still obtain a tree on which the characters were homoplasy - free ) .",
    "but what if we do not insist on restricting ourselves to 2-state characters , or @xmath165-state characters for any fixed @xmath165 .",
    "is it possible that @xmath183 might grow more slowly than linearly with @xmath22 ; perhaps @xmath147 or even @xmath146 characters might suffice ? surprisingly , it turns out that @xmath183 is never more than four .",
    "[ amaze ] for any binary phylogenetic @xmath1-tree @xmath6 , there is a set @xmath187 of at most four characters for which @xmath6 is the _ only _ perfect phylogeny .",
    "an example of @xmath187 is provided by the four hypothetical characters described for the eight species in the table above .",
    "it is easily seen that the tree @xmath6 shown in fig .",
    "[ tree4 ] is a perfect phylogeny for this data set ( this tree , incidentally , is the one biologists generally accept ) .",
    "but what can also be shown is that @xmath6 is the only such perfect phylogeny for these four characters ; moreover the states at the interior vertices ( shown in brackets ) are uniquely determined by the homoplasy - free condition .    a recipe to generate a set @xmath187",
    "is indicated by the letters @xmath188 on the edges of the tree .",
    "these correspond to alternating ` left ' @xmath189 and ` right ' @xmath190 orientations as one moves up the tree , under an arbitrary planar embedding . now",
    ", suppose any edge on which @xmath191 is places causes a state change for the first character , any edge on which @xmath165 is placed causes a state change for the second character , and similarly any edge on which @xmath192 ( resp .",
    "@xmath193 ) is placed causes a state change for the third ( reap .",
    "fourth ) character .",
    "state changes are always to a new state for that character ( to ensure the homoplasy - free condition ; a state present in one character is free to re - appear in a different one ) .",
    "for example , the bottom - most @xmath191 causes true to change to crue . by following this procedure for any binary tree on any number of leaves",
    "it can be shown that @xmath187 satisfies theorem [ amaze ] ( for further details , see @xcite ) .",
    "for the four characters described in the table above .",
    "the assignment of ancestral states ( in brackets ) is also uniquely determined . ]",
    "the homoplasy - free condition is very strong .",
    "a natural relaxation of it , given a character @xmath169 and a phylogenetic tree @xmath6 , is to score @xmath6 by the smallest number of edges of @xmath6 which need to have differently assigned states at their endpoints in order to extend @xmath169 to all the vertices of @xmath6 .",
    "this score is called the _ parsimony score _ of the character on @xmath6 , denoted , @xmath194 . by the equivalent description of the homoplasy - free condition above , we have @xmath195 , with equality if and only if @xmath169 is homoplasy - free .",
    "since there are exponentially many extensions @xmath175 of @xmath169 to @xmath6 it might be suspected that computing @xmath196 is hard .",
    "however , in 1971 , biologist walter fitch proposed a fast algorithm , which was formally verified by mathematician john hartigan in 1973 .",
    "this ` fitch ",
    "hartigan algorithm ' proceeds via a dynamical programming approach , and it also provides an explicit extension @xmath175 that minimises the number of state changes in the tree . for 2-state characters ,",
    "there is also a nice connection between the parsimony score and menger s min - max theorem in graph theory .    given a sequence of characters on @xmath1 , a _ maximum parsimony tree _ for this data is a phylogenetic tree @xmath6 that minimizes the sum of the parsimony scores of the characters .",
    "finding such a tree can be phrased as a ` steiner tree ' problem in a sequence space , and it turns out to be np - hard , though branch and bound algorithms exist .",
    "we saw that no sequence of 2-state characters shorter than linear in @xmath22 can give a unique perfect phylogeny .",
    "but what if we just want a unique most parsimonious tree ?",
    "that is , for each tree @xmath184 , is there a sequence @xmath197 of 2-state characters of length @xmath198 that is sub - linear in @xmath22 and for which @xmath6 is the unique most - parsimonious tree ?",
    "a simple counting argument sets an absolute lower bound on @xmath131 .",
    "let @xmath199 be the set of sequences of 2-state characters on @xmath86 $ ] of length @xmath131",
    ". then @xmath131 must be at least large enough for the function @xmath200 from @xmath57 to @xmath199 to be one - to - one . since @xmath201 this requires that @xmath202 , which can be rewritten as @xmath203 .",
    "if we now invoke eqn .",
    "( [ rntree ] ) and stirling s approximation for @xmath88 to calculate @xmath204 we see that @xmath131 must grow at least at the rate @xmath146 .",
    "remarkably , it was recently shown @xcite that this primitive growth rate is achieved , and by a function @xmath205 that can be constructively implemented . moreover",
    ", the homoplasy score per character of the resulting sequences @xmath197 on @xmath6 necessarily tends to infinity as @xmath22 grows , so this encoding is very ` far ' from supporting a perfect phylogeny .",
    "we will return to maximum parsimony in section  [ markovsec ] .",
    "so far , we have regarded the edges of our trees as being unweighted ; however it is useful  both in biology and in mathematics  to assign weights or lengths to the edges ( often called ` branch lengths ' in biology ) .",
    "for instance the length of an edge could correspond to evolutionary time , or some measure of the amount of genetic change along that edge .",
    "assigning lengths to edges brings in a further tool to help study and reconstruct trees .",
    "firstly , notice that if we have a phylogenetic @xmath1-tree @xmath6 , and some function @xmath206 that assigns strictly positive weights to each edge of the tree , then we can define a metric @xmath207 on @xmath1 by letting @xmath208 be the sum of the weights of the edges on the path in @xmath6 connecting @xmath61 and @xmath164 .",
    "when @xmath23 can be represented by a tree in this way , we say it has a _ tree representation _",
    "( on @xmath6 ) .",
    "this leads to two natural questions :    * does every metric on @xmath1 have a tree representation ? * is the choice of @xmath6 and @xmath206 in a tree representation unique ?    the answers to these questions are ` no ' and ` yes ' respectively .",
    "let s consider the first question .",
    "when @xmath209 , it is an easy exercise to show that every metric @xmath23 on @xmath1 can be represented as a tree metric . but this result is particular to @xmath209 and already runs into problems when @xmath210 .",
    "it is instructive to see why .",
    "consider the three pairwise sums : @xmath211 if @xmath23 has a tree representation ( @xmath212 ) , then two of these pairwise sums must be equal , and larger than the third , regardless of the choice of @xmath6 .",
    "this is illustrated in fig .",
    "[ tree5](i ) .",
    "this ` four - point condition ' is not usually satisfied by an arbitrary metric @xmath23 on a set of size four , but when it is , it turns out that @xmath23 can be represented on a tree .",
    "what is much more remarkable is that , for any @xmath1 , the four point condition holds for all subsets of @xmath1 of size 4 if _ and only if _ @xmath23 has a tree representation .",
    "this result , in various forms , dates back to the 1960s and has been rediscovered several times .",
    "consider now the second question : the uniqueness of a tree representation .",
    "as before , this question was resolved many decades ago , and uniqueness of both the unrooted tree and the strictly positive edge weights holds ; in other words , for trees @xmath213 , and @xmath214 strictly positive , we have : @xmath215 moreover , to reconstruct a phylogenetic tree with @xmath22 leaves we do not usually need all the @xmath216 possible @xmath23-values ; for a binary tree @xmath6 , a subset of @xmath39 carefully chosen pairs of elements from @xmath86 $ ] suffice to uniquely determine both @xmath6 and @xmath206 from the value of @xmath217 for those pairs .",
    "a variety of fast ( polynomial - time ) methods have been devised for building a phylogenetic @xmath1-tree from an arbitrary distance function @xmath23 on @xmath1 , the most popular being called ` neighbor joining ' .",
    "a desirable property of such methods is that when a distance function has a tree representation then the method will return the underlying tree .",
    "moreover , several such methods ( including neighbor joining ) possess a provable ` safety radius ' @xmath218 around @xmath212 for which the method with still return each binary tree @xmath6 from any distance function on @xmath1 that differs by less than @xmath218 from @xmath23 on any pair of elements of @xmath1 . in the case of neighbor - joining ( and several other methods )",
    "this safety radius is @xmath219 where @xmath220 is the smallest interior edge weight .",
    "it is not hard to show that the safety radius of any tree reconstruction method based on distance data can not be made any larger than this .     is smaller than @xmath221 ( which , in turn , equals @xmath222 ) ; ( ii ) a tour of the tree that covers every edge exactly twice . ]      given a phylogenetic @xmath1-tree @xmath6 with an edge weighting @xmath206 , consider @xmath223 , which is the total sum of the edge weights over the tree notice that for the tree in fig .",
    "[ tree5](ii ) we can write : @xmath224,\\ ] ] since the cyclic permutation @xmath225 traverses the tree in a clockwise order and so covers every edge exactly twice .",
    "however , there are other ways to embed the tree in the plane and do this  for example , the cyclic permutation @xmath226 also traverses a different planar embedding of this tree in a clockwise order .",
    "it is easily shown that for any phylogenetic @xmath1-tree , the number @xmath227 of cyclic permutations that traverse the tree in a clockwise order is given by : @xmath228 where @xmath229 is the degree of vertex @xmath9 , and @xmath124 is the set of interior vertices of @xmath6 @xcite .",
    "for example , for the tree fig .",
    "[ tree5](ii ) ) , @xmath230 .    for each cyclic permutation @xmath231",
    ", we have @xmath232.$ ] if we average these over all the @xmath227 cyclic permutations that traverse @xmath6 in clockwise order , we obtain : @xmath233 where @xmath234 depends just on the number and degrees of the vertices in @xmath6 on the path @xmath235 between @xmath61 and @xmath164 . when @xmath6 is a binary tree , @xmath234 is @xmath236 , where @xmath237 is the number of interior vertices in @xmath238 .",
    "for instance , in the case of the quartet tree in fig .",
    "[ tree5](i ) , this gives : @xmath239 for a general phylogenetic tree ( not necessarily binary ) @xmath240    the identity ( [ lameq ] ) suggests a new way to build phylogenetic trees from distances , which is called ` balanced minimum evolution ' ( bme ) @xcite .",
    "given a arbitrary distance function ( not necessarily a tree metric ) @xmath241 on @xmath1 , this method score each phylogenetic @xmath1-tree @xmath6 by the value : @xmath242 and searches for the tree @xmath6 that has the smallest @xmath243 score .",
    "if @xmath241 has a tree representation on some tree @xmath6 , then this tree has the smallest @xmath244 score ; moreover , like neighbor joining , the bme method comes with a ` safety radius ' ( allowing @xmath241 to be just sufficiently close to @xmath217 ) provided , as before , that @xmath6 is binary .",
    "mathematical results also show how bme can be viewed as a weighted least squares method @xcite .    as well as considering the total diversity of the tree @xmath245",
    ", we can also consider how much diversity is spanned by different subsets of leaves .",
    "this measure is called _ phylogenetic diversity _ ( pd ) , and is important for biodiversity conservation @xcite , and other applications .",
    "formally , given a phylogenetic @xmath1-tree and a positive edge weighting @xmath206 , we can associate to each subset @xmath246 of @xmath1 a positive value , denoted @xmath247 , equal to the sum of the weights of the edges of the minimal subtree of @xmath6 that connect the leaves in @xmath246 .",
    "for example , @xmath248 , and @xmath249 . and just as the pd scores of subsets of size @xmath250 ( i.e. distances ) can be used to reconstruct a tree ,",
    "so can the pd scores of subsets of size @xmath131 for any @xmath131 up to ( but not exceeding ) @xmath251 @xcite .",
    "the function @xmath252 is clearly monotone  the pd of a set is always greater than the pd of any strict subset ; moreover pd enjoys a ` strong exchange ' property : for any subset @xmath84 of @xmath1 of size at least two , and any subset @xmath85 of @xmath1 that is larger in size than @xmath84 there always exists an element @xmath253 for which : @xmath254 this property justifies a simple and fast strategy for finding a subset @xmath246 of @xmath1 of any given size @xmath131 having maximal pd for sets of that size .",
    "the strategy is simply the greedy one : first select two leaves @xmath255 that are furtherest apart in the tree ( i.e. maximize @xmath256 ) and then sequentially add a leaf that increases the pd score by the maximum amount to the tree so - far constructed , until @xmath131 leaves are present .",
    "formally , the collection of subsets of @xmath1 that have maximal pd score for their cardinality form what is known in combinatorics as a ` greedoid ' .    a more sophisticated mathematical approach to the study of distances ` t - theory ' ( tight - span ) , and split decomposition theory , pioneered by andreas dress and colleagues @xcite , and an extension of this approach to diversity has recently been described @xcite .",
    "distances and diversities also have a clear meaning if we weight the edges of a tree by arbitrary real values ( possibly negative ) , or more generally by nonzero elements of an arbitrary abelian group .",
    "several of the main results above extend with minor modification .",
    "there is one ` fly in the ointment ' however  for distances , problems arise if the group has elements of order 2 ( for instance , uniqueness of the tree representation fails , since all 15 phylogenetic trees having the shape shown in fig .",
    "[ shapesfig](e ) with edges assigned the element @xmath257 of @xmath258 induce exactly the same ` distance ' function ) . but uniqueness can be restored by moving to from distances to diversities , where not just pairs , but also triples of leaves are considered @xcite .",
    "a major advance in phylogenetics has been the development of stochastic models to describe the evolution of genetic sequences and genomes on a tree . for genetic sequences ,",
    "these models typically describe point substitutions that occur at sites in the dna sequence that codes for some particular gene .",
    "such models allow biologists to convert the sequences we observe today at the leaves of the tree into an estimate of the tree itself ( and perhaps its branch lengths , or ancestral states within the tree ) . by combining these ` gene trees '",
    "one can in turn estimate the ` species tree ' .",
    "the rise of ` statistical phylogenetics ' was pioneered in the 1960s and 70s by anthony edwards , joseph felsenstein and others ( including david sankoff , with a visionary paper in this journal @xcite ) .",
    "today s methods of choice are based on maximum likelihood and bayesian approaches .",
    "stochastic models assume that characters evolve independently on a tree , and the evolution of each character is described by some markovian process ; this may be the same across the characters or vary ( for instance , some characters may evolve more rapidly than others ) .",
    "one of the catalysts that ushered in this stochastic approach was a landmark 1978 paper by joseph felsenstein @xcite .",
    "he showed that if characters evolve independently under a simple stochastic process then existing methods like maximum parsimony ( discussed above ) can be seriously misled .",
    "so , as the number of characters increases , it would be increasingly certain that the maximum parsimony tree will be a different tree from the ` true ' tree ( i.e. the one on which the characters evolved ) .",
    "by contrast , other methods ( like maximum likelihood ) are , under certain conditions , provably statistically consistent and so converge on the true tree as the number of characters grows .",
    "felsenstein considered a simple process involving just two states ",
    "let s call them @xmath259 and @xmath260  which can flip between states with equal probability .",
    "this process is familiar in coding theory as the ` binary symmetric channel ' . in phylogenetics",
    ", we apply this this process to the edges of a tree ",
    "each edge @xmath152 of the tree has a certain probability @xmath261 of a change of state between its endpoints , and , as in coding theory , it is assumed that @xmath261 lies strictly between 0 and 0.5 .",
    "the model also assumes that the ( marginal ) state at any given leaf is uniform ( i.e. no state is ` preferred ' ) and that changes of states on different edges are independent events .    felsenstein s tree is shown in fig .  [ fels](b )  we can imagine it as a tree in which there has been an accelerated rate of evolution ( resulting in higher probabilities of change ) in two non - adjacent lineages .",
    "it can also be realized on a rooted tree as in fig .",
    "[ fels](a ) , with a single rate increase in one short branch ( the branch leading to @xmath257 ) , and a distant out group species ( @xmath262 ) .",
    "denote the probabilities of change on the edges of the tree in fig .",
    "[ fels](b ) by the values @xmath263 , as shown .     and",
    "a distant outgroup species ( @xmath262 ) can be modelled by a markov process on the associated unrooted tree ( obtained by suppressing the root ) in ( b ) ; for this tree @xmath6 , if @xmath264 and @xmath265 are large enough relative to the other @xmath266 values , the maximum parsimony tree for a large number of characters generated on @xmath6 is likely to be the tree @xmath24 shown in ( c ) . ]    now , there are @xmath267 different ways to assign the two states to a set @xmath1 of size @xmath22 , but if we identify complementary assignments , obtained by interchanging @xmath259 and @xmath260 ( these two assignments have equal probability under the model ) we get just @xmath268 distinct _",
    "patterns_. for a subset @xmath16 of @xmath269 , let @xmath270 be the probability of generating a pattern at the leaves of the tree in which @xmath16 is precisely the leaves that are in different state to leaf @xmath22 .",
    "for example , @xmath271 is the probability that all leaves are in the same state ( i.e. all @xmath259 or all @xmath260 ) . for the tree in fig .",
    "[ fels](b ) , it is easily checked that : @xmath272 @xmath273    there are various ways to compute the @xmath270 values , but one particularly elegant way that holds for any phylogenetic tree with @xmath22 leaves is by the following identity : @xmath274 where @xmath275 is the unique set of edges of @xmath6 that lie on any set of edge - disjoint paths in @xmath6 that connect pairs of leaves in the even cardinality set @xmath15 . for the tree in fig .",
    "[ fels](b ) , if we let @xmath276 , and take @xmath277 ( so that @xmath278 for all @xmath15 in eqn .",
    "( [ hada ] ) ) then we obtain : @xmath279 all other @xmath270 values are obtained from the right - hand side of eqn .",
    "( [ emptyeq ] ) by replacing @xmath280 by @xmath281 for exactly half the terms . the somewhat mysterious representation in eqn .",
    "( [ hada ] ) follows from a combinatorial study of this model ( in which @xmath282 $ ] is a @xmath283 hadamard matrix ) due to mike hendy @xcite , and later generalized to other models using group representation based approaches by evans and speed @xcite , and szkely _ et al .",
    "_ @xcite .    with this in hand",
    ", we can now establish the main ingredient in felsenstein s classic result for maximum parsimony .",
    "[ felthm ] for a character generated on tree @xmath6 in fig .",
    "[ fels](b ) under the 2-state symmetric model with @xmath284 , and @xmath285 , the expected parsimony score of @xmath6 is larger than for the tree @xmath24 in fig .",
    "[ fels](c ) precisely when @xmath286 .",
    "_ proof : _ the only 2-state characters that have different parsimony scores on @xmath6 and @xmath24 are @xmath287 and @xmath288 where @xmath289 and @xmath290 .",
    "notice that @xmath287 has a parsimony score of 1 on @xmath6 and 2 on @xmath24 , while @xmath288 has a parsimony score of 1 on @xmath24 and 2 on @xmath6 .",
    "moreover , the probabilities of generating @xmath287 and @xmath288 under the 2-state symmetric model are @xmath291 and @xmath292 respectively ( where @xmath6 is the generating tree ) .",
    "thus , if @xmath293 denotes the parsimony score of a character ( generated on @xmath6 ) on @xmath6 minus the parsimony score of that character on @xmath24 then the expected value of @xmath293 , denoted @xmath294 $ ] , satisfies :    @xmath295 = p_{23}-p_{12}.\\ ] ]    now , if we let @xmath296 , then eqn .  ( [ hada ] ) for @xmath94 , and @xmath297 and @xmath298",
    "gives : @xmath299 @xmath300 substituting these identities into eqn .",
    "[ edelta ] gives : @xmath301 = \\frac{1}{4}(-x_1x_2-x_3x_4 + x_2x_3x_5+x_1x_4x_5).\\ ] ] now , setting @xmath302 and @xmath303 we obtain : @xmath301 = \\frac{v}{4}[u^2+v^2 - 2u ] = v(p^2-q(1-q)),\\ ] ] and so @xmath294>0 $ ] precisely if @xmath304 this completes the proof .",
    "@xmath37    theorem  [ felthm ] , together with the law of large numbers ( or the central limit theorem ) , ensures that for @xmath131 characters generated by the @xmath6 ( with these @xmath266 values ) , a different tree , namely @xmath24 , will have a lower parsimony score than @xmath6 , with probability converging to 1 as @xmath131 grows . intuitively , parallel changes on the two long branches of @xmath6 become more probable than a single change on the short edges",
    "so , through the eyes of parsimony , it is more optimal to join these two edges together in the reconstruction .",
    "this phenomenon of ` long branch attraction ' has been observed in biological data @xcite .    while parsimony can fail to recover the true tree , there are statistically consistent methods for inferring it .",
    "a particularly simple one relies on the following distance function on @xmath1 . for @xmath305 ,",
    "let @xmath306 where @xmath307 is the proportion of characters that assign different states to @xmath61 and @xmath164 .",
    "then provided we apply a distance - based tree reconstruction method with a positive safety radius ( _ c.f .",
    "_ section  [ met ] )  we are guaranteed to recover the underlying ( unrooted ) tree from @xmath131 independently evolved characters , as @xmath131 grows .",
    "the reason is that , as @xmath308 , the law of large numbers ensures that @xmath307 will converge to the probability @xmath309 that leaves @xmath61 and @xmath164 are in different states , and so @xmath310 converges to @xmath311 .",
    "it is then an nice exercise to show that @xmath312 has a tree representation on the true tree @xmath6 with the edge weighting @xmath313 that is , @xmath314 .",
    "the implication in ( [ unique ] ) then ensures the reconstruction of both the unrooted tree and the edge weights from @xmath312 ( and thereby @xmath315 for @xmath131 sufficiently large ) .",
    "biologists deal with much more complex models of character evolution than the 2-state symmetric model , often on 4 , 20 or 64 states ( corresponding to dna , amino acid and codon sequences , respectively ) . for a general markov model involving any state space",
    ", there is a way to construct a metric that has a tree representation on @xmath6 , by taking the negative of the logarithm of the determinant of the matrix of the joint probabilities of states for each pair of species . in this way",
    ", the tree is identifiable from the probability distribution of characters .",
    "this is enough to ensure that methods like maximum likelihood are statistically consistent .",
    "however , for mixtures of such processes , the identifiability of the tree can easily be lost ( mixtures of markov processes are generally no longer markovian ) .",
    "this can be important for biologists  if there are too many parameters to estimate from the data , then one may lose the ability to infer the one(s ) we are interested in ( such as the tree ) .",
    "a striking example of this loss was provided for the 2-state symmetric model @xcite : if 50% of dna sites evolve on a 4-species tree @xmath6 with one carefully chosen set of branch lengths , and 50% evolve on the same tree under a different chosen collection of branch lengths then the expected proportion of site patterns is exactly identical to that in which all sites evolve on a different tree with appropriately chosen edge lengths .    to obtain a deeper understanding of markov processes on trees , techniques from commutative algebra and lie algebra theory",
    "have proved invaluable @xcite . in particular",
    ", these techniques can be applied to determine the extent to which trees and other parameters of the model can be reconstructed from data ( the ` identifiability ' issue mentioned above ) @xcite , a topic that is part of a broader emerging area called ` algebraic statistics ' @xcite .",
    "the combinatorial topology and geometry of two different notions of ` tree space ' are also of interest @xcite , as is the question of how much data we need to reconstruct a tree accurately .",
    "we have provided a brief overview of some of the central ideas in phylogenetics but much has been omitted and the reader interested in this area may wish to consult @xcite for further details .",
    "two areas that are currently very active , and where mathematical and computational approaches play a key role include :    * using probability theory and combinatorics to study how the geneology of each gene ( the ` gene tree ' ) for a set of species relates to the species phylogenetic tree ( the ` species tree ' ) .",
    "biologists typically now have very large numbers ( thousands ) of gene trees to compare species with , but these trees can differ from the species tree by a process called ` incomplete lineage sorting ' . by considering how genes trace back in time and coalesce , it is possible to explain gene tree discordance and predict species trees from these conflicting gene trees ( see e.g. @xcite ) . * extending phylogenetic tree theory to ` phylogenetic networks ' which are graphs that either display uncertainty in the data as to the likely species tree ( implicit networks ) , or which provide an explicit representation of evolution where there has been reticulation ( such as the formation of hybrid species ( see , for example , @xcite ) .",
    "the patchy distribution of genes across taxa and lateral gene transfer also lead to further combinatorial and computational challenges @xcite .",
    "finally , we have seen how any phylogenetic @xmath1-tree can be encoded by its associated set of splits , and also by the leaf - to - leaf distances the tree induces under an edge weighting .",
    "however , there is a third encoding , obtained by considering the quartet trees that are induced by the tree on subsets of @xmath1 of size four .",
    "this association has led to some of the deepest results in phylogenetics ( see e.g. @xcite ) , and the exploration of the links between these three equivalent ways of encoding phylogenetic trees forms the basis of the emerging area of ` phylogenetic combinatorics ' ( for further details , see @xcite ) .",
    "funding for this work was made possible by the nz marsden fund and the allan wilson centre .",
    "i thank simone linz , elliott sober , amelia taylor and three anonymous reviewers for some helpful comments on an earlier version of this article .",
    "bonizzoni , p. , carrieri , a.p . , della vedova , g. , dondi , r. , przytycka , t.m .",
    "when and how the perfect phylogeny model explains evolution . in discrete and topological models in molecular biology ( n. jonoska and m. saito ( eds ) ) .",
    "natural computing series pp 67 - 83 , springer - verlag berlin , heidelberg .",
    "desper , r. and gascuel , o. ( 2004 ) . theoretical foundation of the balanced minimum evolution method of phylogenetic inference and its relationship to weighted least - squares tree fitting .",
    "biol . evol .",
    "21(3):587598 .",
    "* mike steel * is the director of the biomathematics research centre at university of canterbury , christchurch new zealand , where he teaches mathematics and statistics .",
    "he is a fellow of the royal society of new zealand , and deputy director of the allan wilson centre .",
    "when he is not doing mathematics , he enjoys mountain running , biking and alpine climbing ."
  ],
  "abstract_text": [
    "<S> the idea that all life on earth traces back to a common beginning dates back at least to charles darwin s _ origin of species_. ever since , biologists have tried to piece together parts of this ` tree of life ' based on what we can observe today : fossils , and the evolutionary signal that is present in the genomes and phenotypes of different organisms . </S>",
    "<S> mathematics has played a key role in helping transform genetic data into phylogenetic ( evolutionary ) trees and networks . </S>",
    "<S> here , i will explain some of the central concepts and basic results in phylogenetics , which benefit from several branches of mathematics , including combinatorics , probability and algebra . </S>"
  ]
}