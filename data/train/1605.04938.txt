{
  "article_text": [
    "one of the many relevant open problems in economics , and more recently in econophysics , is the understanding of the basic mechanisms driving income or wealth distribution in various economic communities , for instance in different countries .",
    "while it has been shown that the associated probability distribution for the whole population roughly follows a power - law , also known as pareto distribution @xcite , and that the low - income population is better described by a gibbs distribution @xcite , less is known about the mechanisms generating these distributions .",
    "the models proposed in the literature @xcite , typically include the money flow between agents , and their saving propensity .",
    "most of the studies consider random interactions between agents @xcite , or even mean - field approximations @xcite , in which all agents interact with all others , two clearly unrealistic assumptions that do not reflect the reality of economic transactions .",
    "a few studies allow agents to interact above more complex topologies @xcite . however , the synthetic network models ( _ e.g. _ scale - free networks @xcite ) are not based on real observations . the information on everyday monetary transactions",
    "is often considered sensitive .",
    "the resulting scarcity of available data represents a severe limitation and explains why very few studies have tackled this issue , mainly resorting to the possibilities offered by new on - line technologies , _",
    "e.g. _ bitcoins @xcite .",
    "the modelling of money flows bears some similarities with that of modelling the information or opinion spreading in a social network . in this field of research",
    "too the initial models only considered simple topologies @xcite , but it was soon realised that the structures created by interactions between people @xcite and the time - varying organisation of these interactions @xcite both have a dramatic impact on how faithfully the models translates the underlying spreading process .",
    "thus , in analogy with the approach followed in social sciences , one may ask whether and to what degree the transaction topologies are important for creating realistic money flow models . in this contribution",
    ", we make one step in this direction by describing and analysing a unique large - scale data set , including all credit and debit card transactions realised in spain between 2011 and 2012 within the network of one of the biggest spanish banks .",
    "this includes information for both transactions identified as normal and for those identified as fraudulent .",
    "we assume that money flows can be represented as a two - layer network @xcite , with users on one layer , and stores ( or more generally , any economic activity ) on the other .",
    "card transactions then represent flows going from the first to the second layer . to this",
    ", other types of flows should be added : inter - users ( _ e.g. _ transfer of money among members of a family ) ; inter - stores ( _ i.e. _ commercial activities ) ; and from stores to users ( _ i.e. _ salaries ) .",
    "clearly , the analysis of card transactions alone allows a limited representation of the whole system ; furthermore , it does not account for transactions executed in cash .",
    "while this analysis presents some important limitations , it has to be noted that it is , to the best of our knowledge , the first of its kind ; while this reduced view is in line with previous studies @xcite , it represents at the same time a picture of the real economy , and not just a virtual one .",
    "additionally , the possibility of analysing the dynamics of illegal transactions enables a first attempt to characterise the `` black economy '' , something which has seldom been done in the past .",
    "the content of the work is organised as follows .",
    "section [ sec : transactions ] describes the main characteristics of the legal transactions , and thus characterises the network topology of links created between the user and the store layers .",
    "section [ sec : illegal ] presents some results related to illegal transactions .",
    "finally , some conclusions are drawn in section [ sec : discussion ] .",
    "as previously introduced , the studied data set accounts for all credit and debit card transactions of clients of the spanish bank bbva , from january 2011 to december 2012 .",
    "each month , an average of @xmath0 million operations were realised by @xmath1 million cards , for a total of @xmath2 gb of information .",
    "available fields included a time stamp of the operation , the quantity ( both in euro and in the original currency , if different ) , and the origin ( the card ) and destination ( the store ) of the operation ; the two latter fields were anonymised , so that the exact card number and the name of the store could not be recovered .",
    "additionally , information on the outcome of the operation was included , _",
    "i.e. _ whether the operation was detected as illegal or denied for any other reason . in this section ,",
    "only legal and accepted operations are examined .",
    "analysis of credit card transactions .",
    "( left ) cumulative probability distribution of the number of operations realised by different cards .",
    "( right ) cumulative probability distribution of the amount ( in euro ) of each transaction.,scaledwidth=90.0% ]    fig . [ fig01 ] left and right respectively represent the cumulative probability distribution ( cpd ) of the number of operations per card , and the operation size ( in euro ) .",
    "the cpd , with respect to a given parameter value @xmath3 , accounts for the probability of finding an operation with at least value @xmath3 , _",
    "i.e. _ @xmath4 with @xmath5 running all over operations . in fig .",
    "[ fig01 ] left , @xmath6 is thus the number of operations performed by card @xmath5 in one month ; on the other hand , in fig .",
    "[ fig01 ] right , @xmath7 is the quantity of money involved in operation @xmath5 .",
    "while both graphs suggest a scale - free distribution , with long tails , this approximation is far from being precise .",
    "specifically , the number of operations per card seems to display three regions of different slope : between @xmath8 and @xmath9 , between @xmath9 and @xmath10 , and above @xmath10 operations per months , suggesting that different types of users are included .",
    "this is further confirmed by fig .",
    "[ fig01 ] right , in which there is a marked jump at @xmath11 euro ; this is due to the fact that this quantity is , by default , the maximum that can be withdrawn with a debit card in spain .",
    "analysis of user behaviours .",
    "top left and right panels respectively depict the cumulative and normal probability distribution of the time passed between two consecutive operations .",
    "black ( top ) , red ( middle ) and green ( bottom ) curves respectively represent the average for users with 5 , 15 and 25 operations per month .",
    "the bottom panel presents the number of cards operating per day , divided between new cards ( _ i.e _ those that did not operate the previous day , red bars ) and repeating ones ( blue bars).,scaledwidth=90.0% ]     analysis of user behaviours .",
    "top left and right panels respectively depict the cumulative and normal probability distribution of the time passed between two consecutive operations .",
    "black ( top ) , red ( middle ) and green ( bottom ) curves respectively represent the average for users with 5 , 15 and 25 operations per month .",
    "the bottom panel presents the number of cards operating per day , divided between new cards ( _ i.e _ those that did not operate the previous day , red bars ) and repeating ones ( blue bars).,scaledwidth=40.0% ]    beyond the description of the static , or averaged , topology , it is also of interest to evaluate how transactions change and evolve through time .",
    "in particular , it is important to examine whether decisions of using a card are related to past decisions . to shed light on this issue , fig .",
    "[ fig02 ] top depicts the cumulative ( left panel ) and normal ( right panel ) probability distribution corresponding to the time passed between two consecutive operations of the same card .",
    "three curves are represented , corresponding to cards which have realised @xmath12 , @xmath0 and @xmath13 operations in a single month - thus representing the spectrum of normal users .",
    "a clear oscillatory dynamics of 24h period is present in fig .",
    "[ fig02 ] top right - which is partly smoothed out in the cumulative representation .",
    "this indicates that , especially for a low number of operations , users are characterised by a periodic behaviour , in which similar operations are performed at the same time of the day - _ e.g. _ one may tend to visit the gas station at the same hour in the morning , or pay a parking always after work .",
    "[ fig02 ] bottom further depicts how cards reappear in consecutive days , by showing the number of new cards ( _ i.e _ those that did not operate the previous day ) and of repeating ones .",
    "it can be seen that most of them are not repeating in consecutive days , indicating that most of the users do not use the same card within two days .",
    "distribution of hourly and daily activities .",
    "top and bottom graphs respectively represent the distribution of operations during the seven days of the week , and the 24 hours of a day .",
    "left panels correspond to the number of transactions , right ones to the normalised amount of operations.,scaledwidth=70.0% ]    finally , fig .",
    "[ fig03 ] shows how operations depend on the day of the week ( top panels ) and on the hour of the day ( bottom panels ) .",
    "as may be expected , operations are reduced during sunday , but not during saturday - as people use their credit cards in their leisure activities .",
    "there is also an important reduction of the card activity during night hours , with two marked peaks at spanish lunch and dinner time ( 13:00 - 14:00 and 20:00 - 22:00 ) .",
    "in this section , we focus on those transactions that were marked as illicit by the bank s fraud prevention software . fig .",
    "[ fig04 ] top left presents the cpd of the operation size ( in blue ) , compared to the one obtained for legal transactions ( light grey ) .",
    "the former distribution presents a higher probability for large transaction sizes , suggesting that attackers prefer to operate large transactions - which are more profitable when successful . additionally , fig .",
    "[ fig04 ] top right depicts the cpd for the time between consecutive illegal transactions - all transactions are considered together , as the identity of the attacker is not known ; and fig .",
    "[ fig04 ] bottom depicts the evolution of the number of illegal transactions during december 2011 $ ] . ] .",
    "analysis of illicit transactions .",
    "( top left ) cumulative probability distribution of the amount ( in euro ) of illegal transactions ; the curve corresponding to legal ones is reported in grey .",
    "( top right ) cumulative probability distribution of the time between two consecutive illegal transactions .",
    "( bottom ) time evolution of the normalised number of transactions for december 2011.,scaledwidth=90.0% ]",
    "the problem of data confidentiality seldom allows researchers to test a money flow model on a real data set , _",
    "i.e. _ describing real transactions taken place within an economical system . in order to bridge this gap ,",
    "we here present a model able to synthesise a set of transactions starting from the real probability distributions previously obtained . in this section",
    ", we are going to describe its general organisation - a more detailed description of its functions can be found in [ sec : annex1 ] , and its validation is discussed in [ sec : annex2 ] .",
    "the model starts by defining a set of initial credit cards and stores .",
    "each one of them is characterised by an identification number , and by an expected size , _",
    "i.e. _ the number of transactions that are expected to take place in a given time window .",
    "no restriction is imposed on the relation between the number of cards and stores . due to this , the size of the former is strict , meaning that each card is expected on average to execute the assigned number of transactions ; on the contrary , the size of stores is relative , and is used only in a proportional way .",
    "this flexibility allows creating synthetic data sets with different sizes , _",
    "i.e. _ from the original system up to small test cases .",
    "once both sets have been initialised , the algorithm creates transactions in a sequential manner . for each day in the specified time window , the algorithm sequentially selects all cards , one by one , calculates the number of expected transactions ( also taking into account the day of the week ) , and stores those transactions in memory . to these , three more attributes are linked : the hour of the day ( according to the provided distribution ) , the store , and the size of the transaction .",
    "notice how these three attributes are independent from the card executing the transactions ; in other words , second order distributions are not considered . in spite of this , the model is able to recreate all the most important features of the real transaction set - see [ sec : annex2 ] for the results of the validation process .",
    "the synthetic model further includes two options , which allow the creation of a more rich variety of user behaviours .",
    "the first one is designed to reduce the determinism of the model , and allows introducing a  burst \" behaviour in card dynamics .",
    "suppose the model is simulating a credit card , expected to execute 15 operations per month .",
    "this corresponds to @xmath14 operations per day , or , in other words , on average one operation every two days .",
    "the real behaviour of transactions is nevertheless different , as represented in fig .",
    "[ fig03 ] : even cards expected to execute few operations every month have some probability of executing those transactions in a single day , _ i.e. _ to present a  burst \" dynamics . in order to simulate this , the model can introduce a tuneable amount of variability in the number of daily transactions ; if a card executes more transactions than the expected average , an inhibition is saved for the following days , in order to recover the equilibrium .",
    "the second option allows to randomly swap cards , and introduces a higher degree of heterogeneity in the model .",
    "it consists of a random process that exchange the expected average activity of two cards with a given probability , if some constraints ( _ e.g. _ similarity between cards ) are fulfilled .",
    "network science has had a fabulous development in the last twenty years , and is having a huge impact on a multitude of fields , from social sciences to biomedicine @xcite .",
    "however , to the best of our knowledge , no model of credit card transactions has been proposed based on a multi - layer complex network point of view @xcite . in this work ,",
    "we have described a stochastic model to create transaction data sets , feeding from the distributions obtained after a detailed analysis of the topology created by real credit card transactions from one of the biggest world banks between 2011 and 2012 . unlike other models proposed in the literature , which typically consider random interactions and money flows between agents",
    ", our approach assumes that money flows can be represented as a two - layer network , with users laying on one layer and stores on the other , and that card transactions represent flows going from the first to the second layer . in the future",
    "we plan to explore other approaches based on larger and more detailed multilayer network representations , _",
    "e.g. _ by considering different layers for different types of stores , and how users can be classified in a number of ways .",
    "we hope our model will allow researchers to create more realistic money flow models .",
    "the authors gratefully acknowledge the technological risk management research center ( centro para la gestin tecnolgica del riesgo , cigtr ) sponsored by the rey juan carlos university and bbva group , and the i4s - urjc chair on information security , fraud prevention and technological risk management that encourage the base research on pain points of risk management within information systems .    this work has been partly supported by the spanish mineco under project mtm2014 - 59906-p and by the grant for the researching activity for excellence group garecom gi_excelencia 30vcpigi11 .",
    "23 natexlab#1#1[1]`#1 ` [ 2]#2 [ 1]#1 [ 1]http://dx.doi.org/#1 [ ] [ 1]pmid:#1 [ ] [ 2]#2    , , ( ) .",
    ", , , ( ) .    , , ( ) .    , , , , ( ) .    , , , , , ( ) .    , , , , , , , ( ) .    , , , , ( )",
    ", , , , , ( ) .    , , , , , , , ( ) .    , , , , , ( ) .    , , , ( ) .    , , , , , ( ) .    , ,",
    ", , ( ) .    , , ( ) .    , , , , , ( ) .    , , , ( )",
    ", , , , ( ) .    , , ( ) .    , , , , , , , , , , ( ) .    , , , , , , , , , ( ) .",
    "the model has been developed as a set of python libraries , which can be downloaded at www.mzanin.com/moneyflow .",
    "files , and functions within , are organised as follows :    _ synthtransactions_. main file of the library , it contains the following functions :    * _ createtransactions_. this is the main function that creates the synthetic data set .",
    "several parameters are accepted as input : the number of users and stores , the time window covered by the data set , _ etc . _",
    "- see the file itself for a full list .",
    "the output is a list , each element describing a single transaction and containing five fields : the day , the identification of the user , the hour , the quantity involved in the transaction , and the identification of the store . * _ normalizedistributions_. internal function that normalises distributions .    _",
    "synthtransactions_inputdata_. this file includes the definition of the variables encoding the probabilities distributions to be used in the transaction synthesis .",
    "values provided in the original file represent real transactions , but can be changed as needed .",
    "they include :    * _ hourlydistr _ , the distribution of transactions across the 24 hours of the day . * _ dailydistr _ , the distribution of transactions across the seven days of the week . * _ quantitydistr _ , 50 values that describe the distribution of transaction sizes , in steps of 25 monetary units . * _ numopsdistr _ , 100 values describing the probability distribution of the monthly number of transactions per card . * _ numopsdistrstores _ , describing the probability distribution of the number of transactions of stores .",
    "50 values are expected , in steps of 20 .    _",
    "synthtransactions_testfunctions_. set of functions allowing the recreation of the graphs presented in this paper .",
    "the _ matplotlib _",
    "python library is used to plot the results .",
    "the obtained distributions are also returned for further processing .    _",
    "testprogram_. a simple test program , showing how to setup and run the model .    in order to create a synthetic data set , it is only necessary to run the main _ createtransactions _ function with a suitable set of parameters .",
    "for instance , the following code allows creating a data set comprising 2000 cards , 1000 stores , and transactions corresponding to 100 days :    _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ .... transactions = createtransactions(2000 , 1000 , 100 )       .... _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _    a sample of the result , including three transactions and as stored in _ transactions _ , is here reported :    _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ .... ( 0 , 1 , 17 , 87.5 , 78 ) ( 0 , 1 , 17 , 37.5 , 544 ) ( 0 , 2 , 13 , 62.5 , 68 )       .... _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _",
    "the validation of the model has been executed by creating a set of synthetic transactions , and by comparing the resulting probabilities distributions with the one observed in real data .",
    "results are presented in fig .",
    "[ figaux01 ] , for a data set comprising @xmath15 cards , @xmath16 stores , and @xmath17 days , for a total of @xmath18 transactions .",
    "black and green bars respectively correspond to the distributions obtained for real and synthetic transactions .",
    "validation of the synthetic model for creating transaction sets .",
    "black and green bars respectively represent the probability distributions obtained from real and synthetic data . from left to right , top to bottom , the six panels represent : ( _ i _ ) the distribution of the number of transactions per user ( credit card ) ; ( _ ii _ ) distribution of amount of each transaction ; ( _ iii _ ) distribution according to the day of the week ; ( _ iv _ ) distribution according to the hour of the day ; ( _ v _ ) distribution between consecutive transactions of the same card ; and ( _ vi _ ) distribution of the number of transactions per store.,title=\"fig:\",scaledwidth=37.0% ]   validation of the synthetic model for creating transaction sets .",
    "black and green bars respectively represent the probability distributions obtained from real and synthetic data . from left to right , top to bottom , the six panels represent : ( _ i _ ) the distribution of the number of transactions per user ( credit card ) ; ( _ ii _ ) distribution of amount of each transaction ; ( _ iii _ ) distribution according to the day of the week ; ( _ iv _ ) distribution according to the hour of the day ; ( _ v _ ) distribution between consecutive transactions of the same card ; and ( _ vi _ ) distribution of the number of transactions per store.,title=\"fig:\",scaledwidth=37.0% ]   validation of the synthetic model for creating transaction sets .",
    "black and green bars respectively represent the probability distributions obtained from real and synthetic data . from left to right , top to bottom , the six panels represent : ( _ i _ ) the distribution of the number of transactions per user ( credit card ) ; ( _ ii _ ) distribution of amount of each transaction ; ( _ iii _ ) distribution according to the day of the week ; ( _ iv _ ) distribution according to the hour of the day ; ( _ v _ ) distribution between consecutive transactions of the same card ; and ( _ vi _ ) distribution of the number of transactions per store.,title=\"fig:\",scaledwidth=37.0% ]   validation of the synthetic model for creating transaction sets .",
    "black and green bars respectively represent the probability distributions obtained from real and synthetic data . from left to right , top to bottom , the six panels represent : ( _ i _ ) the distribution of the number of transactions per user ( credit card ) ; ( _ ii _ ) distribution of amount of each transaction ; ( _ iii _ ) distribution according to the day of the week ; ( _ iv _ ) distribution according to the hour of the day ; ( _ v _ ) distribution between consecutive transactions of the same card ; and ( _ vi _ ) distribution of the number of transactions per store.,title=\"fig:\",scaledwidth=37.0% ]   validation of the synthetic model for creating transaction sets .",
    "black and green bars respectively represent the probability distributions obtained from real and synthetic data . from left to right , top to bottom , the six panels represent : ( _ i _ ) the distribution of the number of transactions per user ( credit card ) ; ( _ ii _ ) distribution of amount of each transaction ; ( _ iii _ ) distribution according to the day of the week ; ( _ iv _ ) distribution according to the hour of the day ; ( _ v _ ) distribution between consecutive transactions of the same card ; and ( _ vi _ ) distribution of the number of transactions per store.,title=\"fig:\",scaledwidth=80.0% ]   validation of the synthetic model for creating transaction sets .",
    "black and green bars respectively represent the probability distributions obtained from real and synthetic data . from left to right , top to bottom , the six panels represent : ( _ i _ ) the distribution of the number of transactions per user ( credit card ) ; ( _ ii _ ) distribution of amount of each transaction ; ( _ iii _ ) distribution according to the day of the week ; ( _ iv _ ) distribution according to the hour of the day ; ( _ v _ ) distribution between consecutive transactions of the same card ; and ( _ vi _ ) distribution of the number of transactions per store.,title=\"fig:\",scaledwidth=80.0% ]    both sets of distributions present remarkable similarities - notice that some of them , like the distribution of the time between subsequent transactions of a same card , are not hard - coded in the model .",
    "the differences that can be observed in the last panel of fig .",
    "[ figaux01 ] are due to the limited number of stores , which creates a finite size effect ."
  ],
  "abstract_text": [
    "<S> money flow models are essential tools to understand different economical phenomena , like saving propensities and wealth distributions . in spite of their importance , </S>",
    "<S> most of them are based on synthetic transaction networks with simple topologies , _ </S>",
    "<S> e.g. _ random or scale - free ones , as the characterisation of real networks is made difficult by the confidentiality and sensitivity of money transaction data . here </S>",
    "<S> we present an analysis of the topology created by real credit card transactions from one of the biggest world banks , and show how different distributions , _ </S>",
    "<S> e.g. _ number of transactions per card or amount , have nontrivial characteristics . </S>",
    "<S> we further describe a stochastic model to create transactions data sets , feeding from the obtained distributions , which will allow researchers to create more realistic money flow models .    </S>",
    "<S> money flow , networks , econophysics 62p20 , 91b55 , 91b84 </S>"
  ]
}