{
  "article_text": [
    "in this paper we consider the problem of sequential sampling from @xmath0 independent statistical populations with unknown distributions .",
    "the objective is to maximize the expected outcome per period achieved over infinite horizon , under a constraint that the expected sampling cost per period does not exceed an upper bound .",
    "the introduction of a sampling cost introduces a new dimension in the standard tradeoff between experimentation and profit maximization faced in problems of control under incomplete information .",
    "the sampling cost may prohibit using populations with high mean outcomes because their sampling cost may be too high .",
    "instead , the decision maker must identify the subset of populations with the best combination of outcome versus cost and allocate the sampling effort among them in an optimal manner .    from the mathematical point of view , this class of problems incorporates statistical methodologies into mathematical programming problems . indeed , under complete information , the problem of effort allocation under cost constraints is typically formulated in terms of linear or nonlinear programming .",
    "however when some of the problem parameters are not known in advance but must be estimated by experimentation , the decision maker must design adaptive learning and control policies that ensure learning about the parameters while at the same time ensuring that the profit sacrificed for the learning process is as low as possible .",
    "the model in this paper falls in the general area of multi - armed bandit problems , which was initiated by @xcite , who proposed a simple adaptive policy for sequentially sampling from two unknown populations in order to maximize the expected outcome per unit time infinite horizon .",
    "@xcite generalize the results by constructing asymptotically efficient adaptive policies with optimal convergence rate of the average outcome to the optimal value under complete information and show that the finite horizon loss due to incomplete information increases with logarithmic rate .",
    "@xcite prove that simpler index - based efficient policies exist in the case of normal distributions with unknown means , while @xcite extend the results on efficient policies in the nonparametric case of discrete distributions with known support .    in a finite horizon @xcite",
    "develop a minimax version of the @xcite results for two populations , while @xcite construct policies which also achieve logarithmic regret uniformly over time , rather than only asymptotically .    in all works mentioned above",
    "there is no side constraint in sampling .",
    "problems with adaptive sampling and side constraints are scarce in the literature .",
    "@xcite considers a multi - armed bandit model with constraints and adopts a bayesian formulation and the gittins - index approach .",
    "the paper proposes several heuristic policies .",
    "@xcite also consider the problem of estimating the distribution of a single population with sampling cost under the assumption that the number of users who will benefit from the depends on the outcome of the estimation .",
    "finally , @xcite present computational complexity analysis for a version of the multi - armed bandit problem with bernoulli outcomes and beta priors , where there is a total budget for experimentation , which must be allocated to sampling from the different populations .",
    "another approach , which is closer to the one we adopt here is to consider the family of stochastic approximations and reinforcement learning algorithms .",
    "the general idea is to select the sampled population following a randomized policy with randomization probabilities that are adaptively modified after observing the outcome in each period .",
    "the adaptive scheme is based on the stochastic approximation algorithm .",
    "algorithm of this type are analyzed in @xcite for the more general case where the population outcomes have markovian dynamics instead of being i.i.d",
    "..    the contribution of this paper is the construction of a family of policies for which the average outcome per period converges to the optimal value under complete information for all distributions of individual populations with finite means . in this sense",
    ", it generalizes the results of @xcite by including a sampling cost constraint .",
    "the paper organized as follows . in section @xmath1 , we describe the model in the complete and incomplete information framework . in section @xmath2",
    ", we construct a class of adaptive sampling policies and prove that it is consistent . in section @xmath3 , we explore the rate of convergence of the proposed policies using simulation .",
    "section 5 concludes .",
    "consider the following problem in adaptive sampling .",
    "there are @xmath0 independent statistical populations , @xmath4 .",
    "successive samples from population @xmath5 constitute a sequence of i.i.d .",
    "random variables @xmath6 following a univariate distribution with density @xmath7 with respect to a nondegenerate measure @xmath8",
    ". then the stochastic model is uniquely determined by the vector @xmath9 of individual pdf s . given",
    "f let @xmath10 be the vector of expected values , i.e. @xmath11 . the form of @xmath12 is not known . in each period the experimenter must select a population to obtain a single sample from .",
    "sampling from population @xmath5 incurs cost @xmath13 per sample and without loss of generality we assume @xmath14 , but not all equal .",
    "the objective is to maximize the expected average reward per period subject to the constraint that the expected average sampling cost per period over infinite horizon does not exceed a given upper bound @xmath15 . without loss of generality we assume @xmath16 . indeed if @xmath17 then the problem is infeasible . on the other hand if @xmath18 then the cost constraint is redundant .",
    ". then @xmath20 and @xmath21 .",
    "we first analyze the complete information problem .",
    "if all @xmath7 are known , then the problem can be modeled via linear programming .",
    "consider a randomized sampling policy which at each period selects population @xmath22 with probability @xmath23 , for @xmath24 . to find a policy that maximizes the expected reward",
    ", we can formulate the following linear program in standard form    @xmath25    note that @xmath26 depends on @xmath12 only through the vector @xmath10 , i.e. @xmath26 is the same for all collections of pdf with the same @xmath27 .",
    "therefore in the remainder we will denote @xmath26 as a function of the unknown mean vector @xmath28 .    in the analysis we will also use the dual linear program ( dlp ) of , @xmath29 with two variables @xmath30 and @xmath31 which correspond to the first and second constraints of , respectively",
    ".    the basic matrix @xmath32 corresponding to a basic feasible solution ( bfs ) of problem may take one of two forms :    in the first case , the basic variables are @xmath33 , for two populations @xmath34 , with @xmath35 , and the basic matrix is @xmath36    the bfs is then @xmath37 with @xmath38 the solution is nondegenerate when @xmath39 and degenerate when @xmath40 or @xmath41 . in the latter case , it corresponds to sampling from a single population @xmath42 or @xmath43 , respectively : @xmath44 with @xmath45    the second case of a bfs corresponds to basic variables @xmath46 for a population @xmath5 with @xmath47 .",
    "the basic matrix is @xmath48 in this case the bfs corresponds to sampling from population @xmath5 only @xmath49 with @xmath50 the solution is nondegenerate if @xmath51 , otherwise it is degenerate .    from the above",
    "it follows that a bfs is degenerate if @xmath52 for some @xmath53 with @xmath54 .",
    "any basic matrix @xmath32 that includes @xmath55 as a basic variable corresponds to this bfs .    for a bfs @xmath56",
    "let @xmath57 then , either @xmath58 for some @xmath34 with @xmath59 , or @xmath60 for some @xmath61 .",
    "there is a one to one correspondence between basic feasible solutions and sets @xmath62 of this form .",
    "we use @xmath63 to denote the set of bfs , or equivalently @xmath64 since the feasible region of is bounded , @xmath63 is finite .    for a basic matrix @xmath32 ,",
    "let @xmath65 denote the dual vector corresponding to @xmath32 , i.e. , @xmath66 , where @xmath67 , or @xmath68 , depending on the form of @xmath32 .",
    "regarding optimality , a bfs is optimal if and only if for at least one corresponding basic matrix @xmath32 the reduced costs ( dual slacks ) are all nonnegative : @xmath69    a basic matrix @xmath32 satisfying this condition is optimal .",
    "note that if an optimal bfs is degenerate , then not all basic matrices corresponding to it are necessarily optimal .",
    "it is easy to show that the reduced costs can be expressed as a linear combinations @xmath70 , where @xmath71 is an appropriately defined vector that does not depend on @xmath28 .",
    "we finally define the set with optimal solutions of for a @xmath28 , @xmath72    an optimal solution of specifies randomization probabilities that guarantee maximization of the average reward subject to the cost constraint .",
    "note that an alternative way to implement the optimal solution , without randomization , is to sample periodically from all populations so that the proportion of samples from each population @xmath22 is equal to @xmath23 .",
    "this characterization of a policy is valid if randomization probabilities are rational .      in this paper",
    "we assume that the population distributions are unknown .",
    "specifically we make the following assumption .",
    "the outcome distributions are independent , and the expected values @xmath73 , @xmath74 .",
    "let @xmath75 be the set of all @xmath9 which satisfy a.1 .",
    "class @xmath75 is the effective parameter set in the incomplete information framework . under incomplete information , a policy",
    "as that in section 2.1 , which depends on the actual value of @xmath28 , is not admissible .",
    "instead we restrict our attention to the class of adaptive policies , which depend only on the past observations of selections and outcomes .",
    "specifically , let @xmath76 , @xmath77 denote the population selected and the observed outcome at period @xmath78 .",
    "let @xmath79 be the history of actions and observations available at period t.    an adaptive policy is defined as a sequence @xmath80 of history dependent probability distributions on @xmath81 , such that    @xmath82    given the history @xmath83 , let @xmath84 denote the number of times population @xmath85 has been sampled during the first n periods    @xmath86    let @xmath87 be the reward up to period @xmath88 :    @xmath89    and @xmath90 be the total cost up to period @xmath88 :    @xmath91    these quantities can be used to define the desirable properties of an adaptive policy , namely feasibility and consistency .",
    "a policy @xmath92 is called feasible if    @xmath93    a policy @xmath92 is called consistent if it is feasible and    @xmath94    let @xmath95 and @xmath96 denote the class of feasible and consistent policies , respectively .",
    "the above properties are reasonable requirements for an adaptive policy .",
    "the first ensures that the long - run average sampling cost does not exceed the budget .",
    "the second definition means that the long - run average outcome per period achieved by @xmath92 converges with probability one to the optimal expected value that could be achieved under full information , for all possible population distributions satisfying a.1 .",
    "note that consistency as defined in definition @xmath1 is equivalent to the notion of strong consistency of an estimator function .",
    "a key question in the incomplete information framework is whether feasible and , more importantly , consistent policies exist and how they can be constructed .",
    "it is very easy to show that feasible policies exist , since the sampling costs are known .",
    "indeed any randomized policy , such as those defined in section 2.1 , with randomization probabilities satisfying the constraints of lp is feasible for any distribution @xmath12 .",
    "thus , @xmath97 .",
    "on the other hand , the construction of consistent policies is not trivial .",
    "a consistent policy must accomplish three goals : first to be feasible , second to be able to estimate the mean outcomes from all populations , and third , in the long - run , to sample from the nonoptimal populations rarely enough so as not to affect the average profit .    in this section",
    "we establish the existence of a class of consistent policies .",
    "the construction follows the main idea of @xcite , based on sparse sequences , which is adapted to ensure feasibility .",
    "we start with some definitions . for any population @xmath22 ,",
    "let @xmath98 , @xmath99 be a strongly consistent estimator of @xmath100 , i.e. @xmath101 a.s.-@xmath102 .",
    "such estimators exist ; for example from assumption 1 , the sample mean @xmath103 is strongly consistent .    for any @xmath88 ,",
    "let @xmath104 be the vector estimates of @xmath28 based on the history up to period @xmath88 .",
    "also let @xmath105 denote the optimal value of the linear program in where the estimates are used in place of the unknown mean vector in the objective .",
    "@xmath106 will be referred to as the certainty - equivalence lp .",
    "note that @xmath107 is the set of optimal bfs of @xmath106 .",
    "the solution of @xmath106 corresponds to a sampling policy determined by an optimal vector @xmath108 , so that @xmath109 .",
    "we next define a class of sampling policies , which we will show to be consistent .",
    "consider @xmath0 nonoverlapping sparse sequences of positive integers ,    @xmath110    such that @xmath111    now define policy @xmath112 which in period @xmath88 selects any population @xmath22 with probability equal to    @xmath113    where @xmath114 is any optimal bfs of the certainty - equivalence lp @xmath106 .",
    "the main idea in @xmath112 is that at periods which coincide with the terms of sequence @xmath115 , population @xmath22 is selected regardless of the history .",
    "these instances are referred to as forced selections of population @xmath22 .",
    "the purpose of forced selections is to ensure that all populations are sampled infinitely often , so that the estimate vector @xmath116 converges to the true mean @xmath28 as @xmath117 .    on the other hand , because sequences @xmath115 are sparse , the fraction of forced selections periods converges to zero for all @xmath22 , so that sampling from the nonoptimal populations does not affect the average outcome in the long - run .    in the remaining time periods , which do not coincide with a sparse sequence term",
    ", the sampling policy is that suggested by the certainty equivalence lp , i.e. , the experimenter in general randomizes between those populations , which , based on the observed history , appear to be optimal .    in the next theorem we prove the main result of the paper , namely that @xmath118 .",
    "the proof adapts the main idea of @xcite to the problem with the cost constraint .",
    "[ consthm ] policy @xmath112 is consistent .    before we show theorem @xmath119 , we prove an intermediate result which shows that if in some period the certainty equivalence lp yields an optimal solution that is non - optimal under the true distribution @xmath12 , then the estimate of at least one population mean must be sufficiently different from the true value .",
    "we use the supremum norm @xmath120 .    for any @xmath28 there",
    "exists @xmath121 such that for any @xmath122 if @xmath123 and @xmath124 for some @xmath125 , then @xmath126 .    since @xmath127",
    ", we have that for any basic matrix @xmath128 corresponding to bfs @xmath62 there exists at least one @xmath129 such that @xmath130 .",
    "therefore , @xmath131    in addition , since @xmath123 , there exists a basic matrix @xmath32 corresponding to @xmath62 , such for any @xmath132 it is true that @xmath133 , thus , @xmath134    for this basic matrix @xmath32 , it follows from and that @xmath135    @xmath136    @xmath137    @xmath138    because from the property @xmath139 it follows that @xmath140 .    now let @xmath141 where the minimization over @xmath142 is taken over all basic matrices corresponding to bfs @xmath62 .    then @xmath143 .    *",
    "proof of theorem 1 . * for @xmath4 let    @xmath144    denote the number of periods in @xmath145 where a forced selection from population @xmath5 is performed",
    ".    also let ,    @xmath146    since these include all possibilities of selection in a period , it is true that    @xmath147    now let @xmath148 denote the sum of outcomes in periods where true optimal bfs are used :    @xmath149    to show the theorem we will prove that    @xmath150    first , holds since @xmath151 are sparse for all @xmath5 . to show , in no forced selection periods , in order to sample from a bfs @xmath62 it is necessary but not sufficient that @xmath123 , thus    @xmath152    for any @xmath153 and @xmath127 , it follows from lemma @xmath119 that    @xmath154    therefore , for @xmath127    @xmath155    thus ,    @xmath156    because @xmath157 , a.s . , since @xmath158 is strongly consistent estimator , thus holds .",
    "now to show we rewrite @xmath148 as    @xmath159    from this expression it follows that    @xmath160    where @xmath161 .    since @xmath162 , we have    @xmath163    to show we will prove that    @xmath164    random variable @xmath165 is increasing in @xmath88 and @xmath166 , thus either @xmath167 or @xmath168 for some @xmath169 .",
    "we define the following events :    @xmath170    now let @xmath171 and @xmath172 . also let    @xmath173    then @xmath174 .    now ,    @xmath175    from the strong law of large numbers , since @xmath176 @xmath177 @xmath88 , and    @xmath178    since in this case @xmath179 is bounded for any finite @xmath88 .    therefore , @xmath180 , thus    @xmath181    finally ,    @xmath182",
    "thus the proof of the theorem is complete .",
    "from the results of the previous section it follows that there exists significant flexibility in the construction of a consistent sampling policy . indeed , any collection of sparse sequences of forced selection periods satisfying guarantees that theorem [ consthm ] holds .    in this section",
    "we refine the notion of consistency and examine how the rate of convergence of the average outcome to the optimal value is affected by different types of sparse sequences . furthermore , since the sensitivity analysis will be performed using simulation , it is more appropriate to use the expected value of the deviation as the convergence criterion .",
    "we thus consider the expected difference of the average outcome under a consistent policy @xmath92 from the optimal value : @xmath184    note that the almost sure convergence of @xmath185 to @xmath186 proved in theorem [ consthm ] does not imply convergence in expectation , unless further technical assumptions on the unknown distributions are made .",
    "for the purpose of our simulation study , we will further assume that the outcomes of any population are absolutely bounded with probability one , i.e. , @xmath187 , for some @xmath188 . under this assumption",
    "it is easy to show that theorem 1 implies @xmath189 for any consistent policy @xmath92 and any vector @xmath28 .    to explore the rate of convergence in",
    ", we performed a simulation study , for a problem with @xmath190 populations .",
    "the outcomes of population @xmath5 follow binomial distribution with parameters @xmath191 , where @xmath192 .",
    "the vector of expected values is thus @xmath193 .",
    "the cost vector is @xmath194 and @xmath195 . under this set of values the optimal policy under incomplete information",
    "is @xmath196 , @xmath197 and @xmath198 , i.e. , it is optimal to randomize between populations 2 and 3 , the expected sampling cost per period is equal to 5 and the expected average reward per period is equal to 3 .    for the above problem we simulated the performance of a consistent policy for sparse sequences of power function form : @xmath199 where @xmath200 are appropriately defined constants which ensure that the sequences are not overlapping , and the exponent parameter @xmath62 is common for all populations .",
    "we compared the convergence rate in for five values of @xmath62 : ( 1.2 , 1.5 , 2 , 3 , 5 ) . for each value of @xmath62",
    "the corresponding policy was simulated for 1000 scenarios of length @xmath201 periods each , to obtain an estimate of the expected average outcome per period @xmath202 .",
    "the results of the simulations are presented in figure [ fig : av_var ] .",
    "we observe in figure [ fig : av_var ] that the convergence is slower both for small and large values of @xmath62 and faster for intermediate values .",
    "especially for @xmath203 the difference is relatively large even after 10000 periods .",
    "this is explained as follows . for small values of @xmath62",
    "the forced selections are more frequent .",
    "although this has the desirable effect that the mean estimates for all populations become accurate very soon , it also means that non - optimal populations are also sampled frequently because of forced selections . as a result",
    "the average outcome may deviate from the true optimal value for a longer time period . on the other hand ,",
    "for large values of @xmath62 the sequences @xmath115 all become very sparse and thus the forced selections are rare . in this case",
    "it takes a longer time for the estimates to converge , and the linear programming problems may produce non - optimal solutions for long intervals .",
    "it follows from the above discussion that intermediate values of @xmath62 are generally preferable , since they offer a better balance of the two effects , fast estimation of all mean values and avoiding non optimal populations .",
    "this is also evident in the graph , where the value @xmath204 seems to be the best in terms of speed of convergence .    to address the question of accuracy of the comparison of convergence rates based on simulation , figure [ fig : av_a2 ]",
    "presents a 95% confidence region for the average outcome curve corresponding to @xmath204 , based on 1000 simulated scenarios .",
    "the confidence region is generally very narrow ( note that the vertical axes have different scale in the two figures ) , thus the estimate of the expected average outcome is quite accurate .",
    "this is also the case for the other curves , therefore the comparison of convergence rates is valid . furthermore , the length of the confidence interval becomes smaller for larger time periods since , as expected , the convergence to the true value is better for longer scenario durations .    ,",
    "scaledwidth=100.0% ]    .",
    "[ fig : av_a2 ]    another issue arising from figure [ fig : av_var ] is the following .",
    "for @xmath203 the average outcome converges very slowly to @xmath26 , but remains above it for the entire scenario duration .",
    "thus it could be argued that , although the convergence is not good , this policy is actually preferable , because it yields higher average outcomes than the other policies .",
    "it also seems to contradict the fact that @xmath26 is the maximum average outcome under complete information , since there is a sampling policy that even under incomplete information performs better .",
    "the reason for this discrepancy is related to the form of the cost constraint .",
    "the constraint requires the infinite - horizon expected cost per period not to exceed @xmath205 .",
    "this does not preclude the possibility that one or more populations with large sampling costs and large expected outcomes could be used for arbitrarily long intervals before switching to a constrained - optimal policy for the remaining infinite horizon .",
    "such policies might achieve average rewards higher than @xmath26 for long intervals , however this is achieved by `` borrowing '' , i.e. , violating the cost constraint , also for long time periods . since is only required to hold in the limit , this behavior of a policy is allowed .",
    "although the consistent policies in section 3 are not designed specifically to take advantage of this observation , they are neither designed to avoid it .",
    "therefore , it is possible , as it happens here for @xmath204 , that a consistent policy may achieve higher than optimal average outcomes for long time periods before it converges to @xmath26 .",
    "the above discussion shows that the constraint as expressed in , may not be appropriate , if for example the sampling cost is a tangible amount that must be paid each time an observation is taken , and there is a budget @xmath15 per period for sampling .",
    "in this situation a policy may suggest exceeding the budget for long time periods and still be feasible , something that may not be viable in reality .",
    "in such cases it would be more realistic to impose a stricter average cost constraint , for example to require that hold for all @xmath88 and not only in the limit .",
    "in this paper we developed a family of consistent adaptive policies for sequentially sampling from @xmath0 independent populations with unknown distributions under an asymptotic average cost constraint .",
    "the main idea in the development of this class of policies is to employ a sparse sequence of forced selection periods for each population , to ensure consistent estimation of all unknown means and in the remaining time periods employ the solution obtained from a linear programming problem that uses the estimates instead of the true values .",
    "we also performed a simulation study to compare the convergence rate for different policies in this class .",
    "this work can be extended in several directions .",
    "first , as it was shown in section 4 , the asymptotic form of the cost constraint is in some sense weak , since it allows the average sampling cost to exceed the upper bound for arbitrarily long time periods and still be satisfied in the limit .",
    "a more appropriate , albeit more complex , model would be to require the cost constraint to be satisfied at all time points .",
    "the construction of consistent and , more importantly , efficient policies under this stricter version of the constraint is work currently in progress .",
    "another extension is towards the direction of markov process control . instead of assuming distinct independent populations with i.i.d .",
    "observations , one might consider an average reward markovian decision process with unknown transition law and/or reward distributions , and one or more nonasymptotic side constraints on the average cost . in this case",
    "the problem is to construct consistent and , more importantly , efficient control policies , extending the results of @xcite in the constrained case .",
    "this research was supported by the greek secreteriat of research and technology under a greece / turkey bilateral research collaboration program .",
    "the authors thank nickos papadatos and george afendras for useful discussions on the problem of consistent estimation in a random sequence of random variables ."
  ],
  "abstract_text": [
    "<S> we consider the problem of sequential sampling from a finite number of independent statistical populations to maximize the expected infinite horizon average outcome per period , under a constraint that the expected average sampling cost does not exceed an upper bound . </S>",
    "<S> the outcome distributions are not known . </S>",
    "<S> we construct a class of consistent adaptive policies , under which the average outcome converges with probability 1 to the true value under complete information for all distributions with finite means . </S>",
    "<S> we also compare the rate of convergence for various policies in this class using simulation . </S>"
  ]
}