{
  "article_text": [
    "the mathematical analysis of shapes has become a subject of growing interest in the past few decades , and has motivated the development of efficient image acquisition and segmentation methods , with applications to many domains , including computational anatomy and object recognition .",
    "the general purpose of shape analysis is to compare two ( or more ) shapes in a way that takes into account their geometric properties .",
    "two shapes can be very similar from a human s point of view , like a circle and an ellipse , but very different from a computer s automated perspective . in _",
    "shape deformation analysis _",
    ", one optimizes a deformation mapping one shape onto the other and bases the analysis on its properties .",
    "this of course implies that a cost has been assigned to every possible deformation of a shape , the design of this cost function being a crucial step in the method .",
    "this approach has been used extensively in the analysis of anatomical organs from medical images ( see @xcite ) .    in this framework ,",
    "a powerful and convenient approach represents deformations as flows of diffeomorphisms generated by time - dependent vector fields @xcite . indeed ,",
    "when considering the studied shapes as embedded in a real vector space @xmath0 , deformations of the whole space , like diffeomorphisms , induce deformations of the shape itself .",
    "the set of all possible deformations is then defined as the set of flows of time - dependent vector fields of a hilbert space @xmath1 , called space of `` infinitesimal transformations '' , which is a subset of the space of all smooth bounded vector fields on @xmath0 .",
    "this point of view has several interesting features , not the least of which being that the space of possible deformations is a well - defined subgroup of the group of diffeomorphisms , equipped with a structure similar to the one of a right - invariant sub - riemannian metric @xcite .",
    "this framework has led to the development of a family of registration algorithms called _ large deformation diffeomorphic metric mapping _ ( lddmm ) , in which the correspondence between two shapes comes from the minimization of an objective functional defined as a sum of two terms @xcite .",
    "the first term takes into account the cost of the deformation , defined as the integral of the squared norm of the time - dependent vector field from which it arises . in a way , it is the total kinetic energy of the deformation . the second term is a data attachment penalizing the difference between the deformed shape and a target .",
    "an appropriate class of hilbert spaces of vector fields for @xmath1 is the one of _ reproducing kernel hilbert spaces _ ( in short , rkhs ) @xcite , because they provide very simple solutions to the spline interpolation problem when the shape is given by a set of landmarks @xcite , which is an important special case since it includes most practical situations after discretization .",
    "this framework allows one to use tools from riemannian geometry @xcite , along with classical results from the theory of lie groups equipped with right - invariant metrics @xcite .",
    "these existing approaches provide an account for some of the geometric information in the shape , like singularities for example .",
    "however , they do not consider other intrinsic properties of the studied shape , which can also depend on the nature of the object represented by the shape .",
    "for example , for landmarks representing articulations of a robotic arm , the deformation can be searched so as to preserve the distance between certain landmarks . for cardiac motions",
    ", it may be relevant to consider deformations of the shape assuming that the movement only comes from a force applied only along the fiber structure of the muscle .",
    "in other words , it may be interesting to constrain the possible deformations ( by considering non - holonomic constraints ) in order to better fit the model .    in order to take into account such constraints in shape deformation problems ,",
    "we propose to model these problems within the framework of _ optimal control theory _",
    ", where the control system would model the evolution of the deformation and the control would be the time - dependent vector field ( see preliminary ideas in @xcite ) .",
    "the purpose of this paper is to develop the point of view of _ optimal control for shape deformation analysis _ as comprehensively as possible",
    ". we will show the relevance of this framework , in particular because it can be used to model constrained shapes among many other applications .",
    "indeed , a lot of tools have been developed in control theory for solving optimal control problems with or without constraints .",
    "the well - known _ pontryagin maximum principle _ ( in short pmp , see @xcite ) provides first - order conditions for optimality in the form of hamiltonian extremal equations with a maximization condition permitting the computation of the optimal control .",
    "it has been generalized in many ways , and a large number of variants or improvements have been made over the past decades , with particular efforts in order to be able to address optimal control problems involving general state / control constraints ( see the survey article @xcite and the many references therein ) .",
    "the analysis is , however , mainly done in finite dimension .",
    "since shape analysis has a natural setting in infinite dimension ( indeed , in 2d , the shape space is typically a space of smooth curves in @xmath2 ) , we need to derive an appropriate infinite - dimensional variant of the pmp for constrained problems .",
    "such a variant is nontrivial and nonstandard , given that our constrained shape analysis problems generally involve an infinite number of equality constraints .",
    "such a pmp will allow us to derive in a rigorous geometric setting the ( constrained ) geodesic equations that must be satisfied by the optimal deformations .",
    "moreover , modeling shape deformation problems within the framework of optimal control theory can inherit from the many numerical methods in optimal control and thus lead to new algorithms in shape analysis .",
    "the paper is organized as follows .",
    "section [ sec2 ] is devoted to modeling shape deformation problems with optimal control .",
    "we first briefly describe , in section [ sec2.1 ] , the framework of diffeomorphic deformations arising from the integration of time - dependent vector fields belonging to a given rkhs , and recall some properties of rkhs s of vector fields . in section [ modshsp ]",
    "we introduce the action of diffeomorphisms on a shape space , and we model and define the optimal control problem on diffeomorphisms which is at the heart of the present study , where the control system stands for the evolving deformation and the minimization runs over all possible time - dependent vector fields attached to a given rkhs and satisfying some constraints .",
    "we prove that , under weak assumptions , this problem is well posed and has at least one solution ( theorem [ existence ] ) . since the rkhs is in general only known through its kernel , we then provide a kernel formulation of the optimal control problem and we analyze the equivalence between both problems . in section [ mlmk ]",
    "we investigate in our framework two important variants of shape spaces , which are lifted shapes and multi - shapes .",
    "section [ approx ] is devoted to the study of finite - dimensional approximations of the optimal control problem .",
    "section [ sec_proof_thm_existence ] contains a proof of theorem [ existence ] .",
    "section [ secgeod ] is dedicated to the derivation of the constrained geodesic equations in shape spaces , that must be satisfied by optimal deformations .",
    "we first establish in section [ pmps ] an infinite dimensional variant of the pmp which is adapted to our setting ( theorem [ pmp ] ) . as an application",
    ", we derive in section [ geodeqshsp ] the geodesic equations in shape spaces ( theorem [ geodeq ] ) , in a geometric setting , and show that they can be written as a hamiltonian system .    in section [ sec_algos ] , we design some algorithms in order to solve the optimal control problem modeling the shape deformation problem",
    ". problems without constraints are first analyzed in section [ unconsmin ] , and we recover some already known algorithms used in unconstrained shape spaces , however with a more general point of view .",
    "we are thus able to extend and generalize existing methods .",
    "problems with constraints are investigated in section [ matchconst ] in view of solving constrained matching problems .",
    "we analyze in particular the augmented lagrangian algorithm , and we also design a method based on shooting .    in section [ sec7 ] we provide numerical examples , investigating first a matching problem with constant total volume , and then a multishape matching problem .",
    "the following notations will be used throughout the paper .",
    "let @xmath3 fixed .",
    "a vector @xmath4 can be as well viewed as a column matrix of length @xmath5 .",
    "the euclidean norm of @xmath6 is denoted by @xmath7 .",
    "the inner product @xmath8 between two vectors @xmath9 can as well be written , with matrix notations , as @xmath10 , where @xmath11 is the transpose of @xmath6 . in particular",
    "one has @xmath12 .",
    "let @xmath13 be a banach space .",
    "the norm on @xmath13 is denoted by @xmath14 , and the inner product by @xmath15 whenever @xmath13 is a hilbert space .",
    "the topological dual @xmath16 of @xmath13 is defined as the set of all linear continuous mappings @xmath17 .",
    "endowed with the usual dual norm @xmath18 , it is a banach space . for @xmath19 ,",
    "the natural pairing between @xmath20 and @xmath21 is @xmath22 , with the duality bracket . if @xmath23 then @xmath20 can be identified with a column vector through the equality @xmath24 .",
    "let @xmath25 be an open subset of @xmath13 , and let @xmath26 be another banach space .",
    "the frchet derivative of a map @xmath27 at a point @xmath28 is written as @xmath29 .",
    "when it is applied to a vector @xmath30 , it is denoted by @xmath31 or @xmath32 . when @xmath33 ,",
    "we may also write @xmath34 .    we denote by @xmath35 ( resp .",
    "@xmath36 ) the usual sobolev space of elements of @xmath37 , with @xmath38 ( resp . , with @xmath39 ) having a weak derivative in @xmath40 .",
    "for @xmath41 we denote by @xmath42 ( resp .",
    ", by @xmath43 ) the space of all @xmath44 ( resp .",
    ", @xmath45 ) such that @xmath46 .    for every @xmath47 , a mapping @xmath48",
    "is called a @xmath49 diffeomorphism if it is a bijective mapping of class @xmath49 with an inverse of class @xmath49 .",
    "the space of all such diffeomorphisms is denoted by @xmath50 .",
    "note that @xmath51 is the space of all homeomorphisms of @xmath25 .    for every mapping @xmath52 of class @xmath49 with compact support",
    ", we define the usual semi - norm @xmath53 we define the banach space @xmath54 ( endowed with the norm @xmath55 ) as the completion of the space of vector fields of class @xmath49 with compact support on @xmath0 with respect to the norm @xmath56 . in other words , @xmath54 is the space of vector fields of class @xmath49 on @xmath0 whose derivatives of order less than or equal to @xmath57 converge to zero at infinity .",
    "we define @xmath58 as the set of all diffeomorphisms of class @xmath49 that converge to identity at infinity . clearly , @xmath58 is the set of all @xmath59 such that @xmath60 .",
    "it is a group for the composition law @xmath61 .",
    "note that , if @xmath62 , then @xmath58 is an open subset of the affine banach space @xmath63 .",
    "this allows one to develop a differential calculus on @xmath58 .",
    "our approach to shape analysis is based on optimizing evolving deformations .",
    "a deformation is a one - parameter family of flows in @xmath0 generated by time - dependent vector fields on @xmath0 .",
    "let us define this concept more rigorously .",
    "[ [ diffeomorphic - deformations . ] ] diffeomorphic deformations .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + +    let @xmath64 .",
    "let @xmath65 & \\longrightarrow & \\mathcal{c}_0^\\ell(\\r^d,\\r^d ) \\\\ t & \\longmapsto & v(t ) \\end{array}\\ ] ] be a time - dependent vector field such that the real - valued function @xmath66 is integrable .",
    "in other words , we consider an element @xmath67 of the space @xmath68 .",
    "according to the cauchy - lipshitz theorem , @xmath67 generates a ( unique ) flow @xmath69\\rightarrow \\text{diff}\\,_0 ^1(\\r^d)$ ] ( see , e.g. , @xcite or ( * ? ? ?",
    "* chapter 11 ) ) , that is a one - parameter family of diffeomorphisms such that @xmath70 for almost every @xmath71 $ ] and every @xmath72 .",
    "in other words , considering @xmath73 as a curve in the space @xmath74 , the flow @xmath73 is the unique solution of @xmath75 such a flow @xmath73 is called a _ deformation _ of @xmath0 of class @xmath49 .",
    "the set of deformations of @xmath0 of class @xmath49 coincides with the set @xmath76 in other words , the deformations of @xmath0 of class @xmath49 are exactly the curves @xmath77 on @xmath78 that are integrable on @xmath79 as well as their derivative , such that @xmath80 .",
    "let us first prove that there exists a sequence of positive real numbers @xmath81 such that for every deformation @xmath73 of @xmath0 of class @xmath49 , with @xmath82 , induced by the time - dependent vector field @xmath83 , one has @xmath84}\\vert",
    "\\varphi(t)-\\mathrm{id}_{\\r^d}\\vert_{i}{\\leqslant}d_i\\mathrm{exp}\\big(d_i\\int_0 ^ 1\\vert v(t)\\vert_{i}\\big),\\ ] ] for every @xmath85 .",
    "the case @xmath86 is an immediate consequence of the integral formulation of .",
    "combining the formula for computing derivatives of a composition of mappings with an induction argument shows that the derivatives of order @xmath87 of @xmath88 are polynomials in the derivatives of @xmath67 and @xmath73 of order less than or equal to @xmath87 .",
    "moreover , these polynomials are of degree one with respect to the derivatives of @xmath67 , and also of degree one with respect to the derivatives of @xmath73 of order @xmath87 . therefore we can write @xmath89 where @xmath90 is a polynomial independent of @xmath67 and @xmath73 , and the norms of the derivatives of the @xmath91 are computed in the space of @xmath0-valued multilinear maps .",
    "the result then follows from gronwall estimates and from an induction argument on @xmath87 .    that any deformation of @xmath0 of class @xmath49 is a curve of class @xmath92 in @xmath78 is then a direct consequence of and .",
    "conversely , for every curve @xmath73 on @xmath78 of class @xmath92 , we set @xmath93 for every @xmath94 $ ] .",
    "we have @xmath95 for almost every @xmath94 $ ] , and hence it suffices to prove that @xmath96 is integrable . the curve @xmath73 is continuous on @xmath97 $ ] and therefore is bounded .",
    "this implies that @xmath98 is bounded as well .",
    "the formula for computing derivatives of compositions of maps then shows that @xmath99 is integrable whenever @xmath100 is integrable , which completes the proof since @xmath73 is of class @xmath92 .",
    "[ [ reproducing - kernel - hilbert - spaces - of - vector - fields . ] ] reproducing kernel hilbert spaces of vector fields .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    let us briefly recall the definition and a few properties of rkhs s ( see @xcite for more details ) .",
    "let @xmath101 be fixed",
    ".    given a hilbert space @xmath102 , according to the riesz representation theorem , the mapping @xmath103 is a bijective isometry between @xmath1 and @xmath104 , whose inverse is denoted by @xmath105 .",
    "then for every @xmath106 and every @xmath107 one has @xmath108 and @xmath109 .",
    "a reproducing kernel vector space ( rkhs ) of vector fields of class @xmath110 is a hilbert space @xmath102 of vector fields on @xmath111 such that @xmath112 with continuous inclusion .",
    "let @xmath1 be an rkhs of vector fields of class @xmath110 . then",
    ", for all @xmath113 , by definition the linear form @xmath114 on @xmath1 , defined by @xmath115 for every @xmath107 , is continuous ( actually this continuity property holds as well for every compactly supported vector - valued distribution of order at most @xmath57 on @xmath0 ) . by definition of @xmath105 , there holds @xmath116 . the _ reproducing kernel _",
    "@xmath117 of @xmath1 is then the mapping defined on @xmath118 , with values in the set of real square matrices of size @xmath5 , defined by @xmath119 for all @xmath120 . in other words",
    ", there holds @xmath121 , for all @xmath113 and every @xmath107 , and @xmath122 is a vector field of class @xmath49 in @xmath0 , element of @xmath1 .",
    "it is easy to see that @xmath123 , for all @xmath124 , and hence that @xmath125 and that @xmath126 is positive semi - definite under the assumption that no nontrivial linear combination @xmath127 , with given distinct @xmath128 s can vanish for every @xmath107 . finally , writing @xmath129 ,",
    "we have @xmath130 for every compactly supported vector - valued distribution @xmath20 on @xmath0 of order less than or equal to @xmath57 . ] ]    as explained in @xcite , one of the interests of such a structure is that we can define the kernel itself instead of defining the space @xmath1 .",
    "indeed a given kernel @xmath117 yields a unique associated rkhs .",
    "it is usual to consider kernels of the form @xmath131 with @xmath132 .",
    "such a kernel yields a metric that is invariant under rotation and translation .",
    "the most common model is when @xmath133 is a gaussian function but other families of kernels can be used as well @xcite .",
    "we define a _ shape space _ in @xmath0 as an open subset @xmath25 of a banach space @xmath13 on which the group of diffeomorphisms of @xmath0 acts in a certain way . the elements of @xmath25 , called _ states of the shape _ , are denoted by @xmath134 .",
    "they are usually subsets or immersed submanifolds of @xmath0 , with a typical definition of the shape space as the set @xmath135 of all embeddings of class @xmath136 of a given riemannian manifold @xmath137 into @xmath0 .",
    "for example , if @xmath137 is the unit circle then @xmath25 is the set of all parametrized @xmath136 simple closed curves in @xmath0 . in practical applications or in numerical implementations , one has to consider finite - dimensional approximations , so that @xmath138 usually just consists of a finite set of points , and then @xmath25 is a space of landmarks ( see @xcite and see examples further ) .",
    "let us first explain how the group of diffeomorphisms acts on the shape space @xmath25 , and then in which sense this action induces a control system on @xmath25 .    [ [ the - group - structure - of - textdiff_0ellrd . ] ] the group structure of @xmath78 .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    let @xmath64 .",
    "the set @xmath78 is an open subspace of the affine banach space @xmath63 and also a group for the composition law .",
    "however , we can be more precise .",
    "first of all , the mappings @xmath139 and @xmath140 are continuous ( this follows from the formula for the computation of the derivatives of compositions of mappings ) .",
    "moreover , for every @xmath141 , the right - multiplication mapping @xmath142 is lipschitz and of class @xmath136 , as the restriction of the continuous affine map @xmath143 .",
    "its derivative @xmath144 at @xmath145 is then given by @xmath146 .",
    "moreover , @xmath147 is easily seen to be continuous .    finally , the mapping @xmath148 is of class @xmath149 .",
    "indeed we have @xmath150 , for every @xmath151 .",
    "then , using the uniform continuity of any derivative @xmath152 of order @xmath153 , it follows that the mapping @xmath154 is continuous .",
    "these properties are useful for the study of the frchet lie group structure of @xmath155 @xcite .",
    "[ [ group - action - on - the - shape - space . ] ] group action on the shape space . + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    in the sequel , we fix @xmath47 , and we assume that the space @xmath156 acts continuously on @xmath25 ( recall that @xmath25 is an open subset of a banach space @xmath13 ) according to a mapping @xmath157 such that @xmath158 and @xmath159 for every @xmath28 and all @xmath160 .",
    "[ infgaction ] @xmath25 is a _ shape space of order _ @xmath161",
    "if the action is compatible with the properties of the group structure of @xmath162 described above , that is :    * for every @xmath28 fixed , the mapping @xmath163 is lipschitz with respect to the ( weaker when @xmath164 ) norm @xmath56 , i.e. , there exists @xmath165 such that @xmath166 for all @xmath167 . *",
    "the mapping @xmath163 is differentiable at @xmath145 .",
    "this differential is denoted by @xmath168 and is called the _ infinitesimal action _ of @xmath169 . from one",
    "has @xmath170 for every @xmath171 , and if @xmath164 then @xmath168 has a unique continuous extension to the whole space @xmath172 . *",
    "the mapping @xmath173 is continuous , and its restriction to @xmath174 is of class @xmath149 . in particular",
    "the mapping @xmath175 is of class @xmath149 , for every bounded vector field @xmath67 of class @xmath176 .    for @xmath62 ,",
    "the action of @xmath78 on itself by left composition makes it a shape space of order @xmath57 in @xmath0 .",
    "[ example1 ] let @xmath161 and let @xmath137 be a @xmath49 smooth compact riemannian manifold .",
    "consider the space @xmath177 equipped with its usual banach norm .",
    "then @xmath25 is a shape space of order @xmath57 , where the action of @xmath162 is given by the composition @xmath178 .",
    "indeed , it is continuous thanks to the rule for computing derivatives of a composition , and we also have @xmath179 moreover , given @xmath28 and @xmath180 , @xmath181 is the vector field along @xmath134 given by @xmath182 . finally , the formula for computing derivatives of a composition yields @xmath183 for every @xmath184 , and the last part of the definition follows .",
    "this framework describes most of shape spaces .",
    "an interesting particular case of this general example is when @xmath185 is a finite set ( zero - dimensional manifold ) , @xmath186 and @xmath187 is a ( so - called ) space of @xmath188 landmarks in @xmath0 . for @xmath189 ,",
    "the smooth action of order @xmath190 is @xmath191 . for @xmath192 , the infinitesimal action of @xmath67 at @xmath134",
    "is given by @xmath193 .",
    "in most cases , and in all examples given throughout this paper , the mapping @xmath194 restricted to @xmath195 is of class @xmath196 , for every @xmath197 .    for every @xmath28 ,",
    "the mapping @xmath163 is of class @xmath136 , and its differential at @xmath73 is given by @xmath198 .",
    "in particular , given @xmath41 and given @xmath73 a deformation of @xmath0 of class @xmath199 , which is the flow of the time - dependent vector field @xmath67 , the curve @xmath200 is of class @xmath92 and one has @xmath201 for almost every @xmath94 $ ] .",
    "let @xmath41 , fix @xmath202 and take @xmath203 .",
    "then @xmath204 for @xmath205 small enough .",
    "we define @xmath206 .",
    "we have @xmath207 and therefore the mapping @xmath163 is differentiable at @xmath73 , with continuous differential @xmath198 .",
    "the result follows .",
    "the result of this proposition shows that the shape @xmath208 is evolving in time according to the differential equation , where @xmath67 is the time - dependent vector field associated with the deformation @xmath73 .    at this step",
    "we make a crucial connection between shape space analysis and control theory , by adopting another point of view .",
    "the differential equation can be seen as a control system on @xmath25 , where the time - dependent vector field @xmath67 is seen as a control . in conclusion ,",
    "the group of diffeomorphisms acts on the shape space @xmath25 , and this action induces a control system on @xmath25 .    as said in the introduction , in shape analysis problems , the shapes are usually assumed to evolve in time according to the minimization of some objective functional @xcite . with the control theory viewpoint developed above ,",
    "this leads us to model the shape evolution as an optimal control problem settled on @xmath25 , that we define hereafter .",
    "[ [ induced - optimal - control - problem - on - the - shape - space . ] ] induced optimal control problem on the shape space .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    we assume that the action of @xmath209 on @xmath25 is smooth of order @xmath47 .",
    "let @xmath210 be an rkhs of vector fields of class @xmath211 on @xmath0 .",
    "let @xmath117 denote its reproducing kernel ( as defined in section [ sec2.1 ] ) .",
    "let @xmath26 be another banach space .",
    "most problems of shape analysis can be recast as follows .",
    "[ diffprob1 ] let @xmath41 , and let @xmath212 be a mapping such that @xmath213 is linear for every @xmath28 .",
    "let @xmath214 be a function .",
    "we consider the problem of minimizing the functional @xmath215 over all @xmath216 such that @xmath217 and @xmath218 for almost every @xmath71 $ ] .    in the problem above",
    ", @xmath219 stands for an initial shape , and @xmath220 stands for continuous constraints . recall that the infinitesimal action can be extended to the whole space @xmath221 .",
    "note that if @xmath222 is square - integrable then @xmath223 is square - integrable as well .",
    "indeed this follows from the differential equation @xmath217 and from gronwall estimates .",
    "therefore the minimization runs over the set of all @xmath224 .",
    "problem [ diffprob1 ] is an infinite - dimensional optimal control problem settled on @xmath25 , where the state @xmath225 is a shape and the control @xmath226 is a time - dependent vector field",
    ". the constraints @xmath220 can be of different kinds , as illustrated further . a particular but important case of constraints",
    "consists of _ kinetic _ constraints , i.e. , constraints on the speed @xmath227 of the state , which are of the form @xmath228 .",
    "pure state constraints , of the form @xmath229 with a differentiable map @xmath230 , are in particular equivalent to the kinetic constraints @xmath231 .",
    "to the best of our knowledge , except very few studies ( such as @xcite ) , only unconstrained problems have been studied so far ( i.e. , with @xmath232 ) .",
    "in contrast , the framework that we provide here is very general and permits to model and solve far more general constrained shape deformation problems .",
    "[ rempb1_unknowns ] assume @xmath1 is an rkhs of class @xmath233 , and let @xmath234",
    ". then @xmath67 induces a unique deformation @xmath235 on @xmath0 , and the curve @xmath236 satisfies @xmath46 and @xmath237 for almost every @xmath94 $ ] . as above , it follows from the gronwall lemma that @xmath45 .",
    "moreover , according to the cauchy - lipshitz theorem , if @xmath238 then @xmath239 is the unique such element of @xmath240 .",
    "therefore , if @xmath238 then problem [ diffprob1 ] is equivalent to the problem of minimizing the functional @xmath241 over all @xmath242 such that @xmath243 for almost every @xmath94 $ ] .",
    "concerning the existence of an optimal solution of problem [ diffprob1 ] , we need the following definition .",
    "[ compsup ] a state @xmath134 of a shape space @xmath25 of order @xmath57 is said to have compact support if for some compact subset @xmath244 of @xmath0 , for some @xmath165 and for all @xmath245 , we have @xmath246 where @xmath247 denotes the restriction of @xmath248 to @xmath244 .",
    "except for @xmath249 itself , every state of every shape space given so far in examples had compact support .",
    "[ existence ] assume that @xmath1 is an rkhs of vector fields of class @xmath176 on @xmath0 , that @xmath250 is continuous , and that @xmath251 is bounded below and lower semi - continuous .",
    "if @xmath219 has compact support , then problem [ diffprob1 ] has at least one solution .    in practice",
    "one does not usually have available a convenient , functional definition of the space @xmath1 of vector fields .",
    "the rkhs @xmath1 is in general only known through its kernel @xmath117 , as already mentioned in section [ sec2.1 ] ( and the kernel is often a gaussian one ) .",
    "hence problem [ diffprob1 ] , formulated as such , is not easily tractable since one might not have a good knowledge ( say , a parametrization ) of the space @xmath1 .",
    "one can however derive , under a slight additional assumption , a different formulation of problem [ diffprob1 ] that may be more convenient and appropriate in view of practical issues .",
    "this is done in the next section , in which our aim is to obtain an optimal control problem only depending on the knowledge of the reproducing kernel @xmath117 of the space @xmath1 ( and not directly on @xmath1 itself ) , the solutions of which can be lifted back to the group of diffeomorphisms .    [",
    "[ kernel - formulation - of - the - optimal - control - problem . ] ] kernel formulation of the optimal control problem .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    for a given @xmath28 , consider the transpose @xmath252 of the continuous linear mapping @xmath253 .",
    "this means that for every @xmath254 the element @xmath255 ( sometimes called pullback ) is defined by @xmath256 , for every @xmath107 .",
    "besides , by definition of @xmath105 , there holds @xmath257 .",
    "the mapping @xmath258 is often called the _ momentum map _ in control theory @xcite .",
    "we start our discussion with the following remark .",
    "as seen in example [ example1 ] , we observe that , in general , given @xmath28 the mapping @xmath168 is far from being injective ( i.e. , one - to - one ) .",
    "its null space @xmath259 can indeed be quite large , with many possible time - dependent vector fields @xmath67 generating the same solution of @xmath46 and @xmath217 for almost every @xmath94 $ ] .    a usual way to address this overdetermination",
    "consists of selecting , at every time @xmath260 , a @xmath261 that has minimal norm subject to @xmath262 ( resulting in a least - squares problem ) .",
    "this is the object of the following lemma .",
    "[ lemmemoindrecarre ] let @xmath28 .",
    "assume that @xmath263 is closed .",
    "then , for every @xmath107 there exists @xmath254 such that @xmath264 .",
    "moreover , the element @xmath265 is the one with minimal norm over all elements @xmath266 such that @xmath267 .",
    "let @xmath268 denote the orthogonal projection of 0 on the space @xmath269 , i.e. , the element of @xmath270 with minimal norm .",
    "then @xmath268 is characterized by @xmath271 and @xmath272 . using the banach closed - range theorem",
    ", we have @xmath273 , so that there exists @xmath254 such that @xmath274 , and hence @xmath275 .    note that the latter assertion in the proof does not require @xmath276 to be closed , since we always have @xmath277",
    ".    whether @xmath263 is closed or not , this lemma and the previous discussion suggest replacing the control @xmath261 in problem [ diffprob1 ] by @xmath278 such that @xmath279 . plugging this expression into the system @xmath217 leads to the new control system @xmath280 , where @xmath281 for every @xmath28 . the operator @xmath282 is continuous and symmetric ( i.e. , @xmath283 for all @xmath284 ) , satisfies @xmath285 for every @xmath286 and",
    "thus is positive semi - definite , and @xmath287 is as regular as @xmath288 .",
    "note that @xmath289 whenever @xmath290 is closed .",
    "this change of variable appears to be particularly relevant since the operator @xmath291 is usually easy to compute from the reproducing kernel @xmath105 of @xmath1 , as shown in the following examples .",
    "let @xmath292 be the set of continuous mappings from a riemannian manifold @xmath137 to @xmath0 .",
    "the action of @xmath293 is smooth of order @xmath190 , with @xmath294 ( see example [ example1 ] ) .",
    "let @xmath1 be an rkhs of vector fields of class @xmath295 on @xmath0 , with reproducing kernel @xmath117 .",
    "every @xmath254 can be identified with a vector - valued radon measure on @xmath137 .",
    "then @xmath296 for every @xmath28 and for every @xmath107 .",
    "in other words , one has @xmath297 , and therefore , by definition of the kernel , we have @xmath298 . we finally infer that @xmath299    let @xmath186 and @xmath300 ( as in example [ example1 ] )",
    ". then @xmath301 , and every @xmath302 is identified with a vector of @xmath13 by @xmath303 .",
    "therefore , we get @xmath304 , and @xmath305 .",
    "it follows that @xmath306 in other words , @xmath291 can be identified with matrix of total size @xmath307 and made of square block matrices of size @xmath5 , with the block @xmath308 given by @xmath309 .    following the discussion above and the change of control variable @xmath279 ,",
    "we are led to consider the following optimal control problem .",
    "[ diffprob2 ] let @xmath41 , and let @xmath212 be a mapping such that @xmath213 is linear for every @xmath28 .",
    "let @xmath214 be a function .",
    "we consider the problem of minimizing the functional @xmath310 over all couples @xmath311 , where @xmath312\\rightarrow x^*$ ] is a measurable function and @xmath313 are such that @xmath280 and @xmath314 for almost every @xmath71 $ ] .",
    "the precise relation between both problems is clarified in the following result .",
    "[ proposition1 ] assume that @xmath315 and that @xmath263 is closed , for every @xmath28 .",
    "then problems [ diffprob1 ] and [ diffprob2 ] are equivalent in the sense that @xmath316 over their respective sets of constraints .",
    "moreover , if @xmath317 is an optimal solution of problem [ diffprob2 ] , then @xmath318 is an optimal solution of problem [ diffprob1 ] , with @xmath319 and @xmath320 the corresponding curve defined by @xmath321 and @xmath322 for almost every @xmath94 $ ] .",
    "conversely , if @xmath318 is an optimal solution of problem [ diffprob1 ] then there exists a measurable function @xmath323\\rightarrow x^*$ ] such that @xmath319 , and @xmath324 and @xmath317 is an optimal solution of problem [ diffprob2 ] .",
    "first of all , if @xmath325 is finite , then @xmath226 defined by @xmath326 belongs to @xmath327 and therefore , using the differential equation @xmath328 for almost every @xmath260 and the gronwall lemma , we infer that @xmath45 .",
    "the inequality @xmath329 follows obviously .",
    "let us prove the converse .",
    "let @xmath330 arbitrary , and let @xmath234 and @xmath45 be such that @xmath331 , with @xmath328 and @xmath218 for almost every @xmath94 $ ] .",
    "we can write @xmath332 with @xmath333 and @xmath334 , for almost every @xmath94 $ ] , with @xmath335 and @xmath336 measurable functions , and obviously one has @xmath337 . then , choosing @xmath338 such that @xmath339 , it follows that @xmath340 . therefore @xmath341 .",
    "the rest is obvious .",
    "under the assumptions of proposition [ proposition1 ] and of theorem [ existence ] , problem [ diffprob2 ] has at least one solution @xmath324 , there holds @xmath342 , and the minimizers of problems [ diffprob1 ] and [ diffprob2 ] are in one - to - one correspondance according to the above statement .",
    "the assumption @xmath315 is satisfied in the important case where the constraints are kinetic , and is natural to be considered since it means that , in the problem of overdetermination in @xmath67 , the constraints can be passed to the quotient ( see lemma [ lemmemoindrecarre ] ) . actually for kinetic constraints we have the following interesting result ( proved further ,",
    "see remark [ rem_propequiv ] ) , completing the discussion on the equivalence between both problems .",
    "[ equiv ] assume that @xmath1 is an rkhs of vector fields of class at least @xmath343 on @xmath0 , that the constraints are kinetic , i.e. , are of the form @xmath344 , and that the mapping @xmath345 is of class @xmath136 .",
    "if @xmath346 is surjective ( onto ) for every @xmath28 , then for every optimal solution @xmath347 of problem [ diffprob1 ] there exists a measurable function @xmath323\\rightarrow x^*$ ] such that @xmath348 , and @xmath349 is an optimal solution of problem [ diffprob2 ] .",
    "note that this result does not require the assumption that @xmath263 be closed .",
    "it may happen that problems [ diffprob1 ] and [ diffprob2 ] do not coincide whenever @xmath276 is not closed . actually , if the assumption that @xmath276 is closed is not satisfied then it may happen that the set of controls satisfying the constraints in problem [ diffprob2 ] be reduced to the zero control .",
    "let us provide a situation where this occurs .",
    "let @xmath350 with @xmath351 .",
    "in particular @xmath352 .",
    "assume that @xmath353 is defined as the orthogonal projection onto @xmath354 .",
    "then @xmath355 .",
    "we claim that @xmath356 .",
    "indeed , let @xmath254 be such that @xmath357 .",
    "then on the one part @xmath358 , and on the other part , @xmath359 .",
    "therefore @xmath360 , but since @xmath361 , necessarily @xmath362 .      in this section",
    "we provide one last way to study shape spaces and describe two interesting and important variants of shape spaces , namely lifted shape spaces and multishapes .",
    "we show that a slightly different optimal control problem can model the shape deformation problem in these spaces .",
    "[ [ lifted - shape - spaces . ] ] lifted shape spaces .",
    "+ + + + + + + + + + + + + + + + + + + +    lifted shapes can be used to keep track of additional parameters when studying the deformation of a shape .",
    "for example , when studying @xmath188 landmarks @xmath363 in @xmath0 , it can be interesting to keep track of how another point @xmath364 is moved by the deformation .",
    "let @xmath25 and @xmath365 be two shape spaces , open subsets of two banach spaces @xmath13 and @xmath366 respectively , on which the group of diffeomorphisms of @xmath0 acts smoothly with respective orders @xmath57 and @xmath367 .",
    "let @xmath1 be an rkhs of vector fields in @xmath0 of class @xmath368 .",
    "we denote by @xmath168 ( respectively @xmath369 ) the infinitesimal action of @xmath1 on @xmath25 ( respectively @xmath365 ) .",
    "we assume that there exists a @xmath136 equivariant submersion @xmath370 .    by equivariant , we mean that @xmath371 , for every diffeomorphism @xmath372 and every @xmath373 .",
    "note that this implies that @xmath374 and @xmath375    for example , for @xmath376 , the projection @xmath377 defined by @xmath378 is a @xmath136 equivariant submersion .",
    "more generally , for a compact riemannian manifold @xmath379 and a submanifold @xmath380 , the restriction mapping @xmath381 defined by @xmath382 is a @xmath136 equivariant submersion for the action by composition of @xmath383 .",
    "the constructions and results of section [ modshsp ] can be applied to this setting , and in particular the deformation evolution induces a control system on @xmath365 , as investigated previously .",
    "[ refapprox ] let @xmath1 be an rkhs of bounded vector fields of class @xmath384 .",
    "let @xmath251 be a data attachment function on @xmath25 and let @xmath220 be a mapping of constraints .",
    "we set @xmath385 and @xmath386 .",
    "then a time - dependent vector field @xmath67 in @xmath1 is a solution of problem [ diffprob1 ] for @xmath25 with constraints @xmath220 and data attachment @xmath251 if and only if it is also a solution of problem [ diffprob1 ] for @xmath365 with constraints @xmath387 and data attachment @xmath388 .",
    "this remark will be used for finite - dimensional approximations in section [ approx ] .",
    "one can however define a control system of a different form , by lifting the control applied on the smaller shape space @xmath25 to the bigger shape space @xmath365 .",
    "the method goes as follows .",
    "let @xmath41 and @xmath389 . consider a measurable map @xmath312\\rightarrow x^*$ ] and the corresponding curve @xmath239 defined by @xmath46 and @xmath390 for almost every @xmath94 $ ] , where @xmath391 .",
    "this curve is the same as the one induced by the time - dependent vector field @xmath392 .",
    "the deformation @xmath73 corresponding to the flow of @xmath67 defines on @xmath365 a new curve @xmath393 with speed @xmath394 with @xmath395 .",
    "note that @xmath396 for every @xmath94 $ ] .",
    "we have thus obtained a new class of control problems .",
    "[ liftprobmo ] let @xmath397 , and let @xmath398 be continuous and linear with respect to the second variable , with @xmath26 a banach space .",
    "let @xmath399 be a real function on @xmath365 .",
    "we consider the problem of minimizing the functional @xmath400 over all @xmath401 , where @xmath312\\rightarrow x^*$ ] is a measurable function and @xmath402 are such that @xmath403 and @xmath404 for almost every @xmath94 $ ] .",
    "note that , if @xmath251 and @xmath220 only depend on @xmath405 then the solutions @xmath406 of problem [ liftprobmo ] coincide with the ones of problem [ diffprob2 ] on @xmath25 .",
    "problem [ liftprobmo ] can be reformulated back into an optimal control problem on @xmath1 and on @xmath365 , similar to problem [ diffprob1 ] , by adding the constraints @xmath407 where @xmath408 is the orthogonal projection of @xmath67 on @xmath409 .",
    "some examples of lifted shape spaces can be found in @xcite , where controls are used from a small number of landmarks to match a large number of landmarks , with additional state variables defining gaussian volume elements .",
    "another application of lifted shape spaces will be mentioned in section [ approx ] , where they will be used to approximate infinite - dimensional shape spaces by finite - dimensional ones .",
    "[ [ multishapes . ] ] multishapes .",
    "+ + + + + + + + + + + +    shape analysis problems sometimes involve collections of shapes that must be studied together , each of them with specific properties associated with a different space of vector fields .",
    "these situations can be modeled as follows .",
    "consider some shape spaces @xmath410 , open subsets of banach spaces @xmath411 respectively , on which diffeomorphisms of @xmath0 acts smoothly on each shape space @xmath412 with order @xmath413 .",
    "let @xmath414 , and consider @xmath415 , rkhs s of vector fields of @xmath0 respectively of class @xmath416 with kernels @xmath417 , as defined in section [ sec2.1 ] .",
    "in such a model we thus get @xmath418 control systems , of the form @xmath419 , with the controls @xmath420 , @xmath421 .",
    "the shape space of a multi - shape is a space of the form @xmath422 .",
    "let @xmath423 .",
    "similarly to the previous section we consider the problem of minimizing the functional @xmath424 over all time - dependent vector fields @xmath420 , @xmath421 , and with @xmath425 where @xmath426 is the flow generated by @xmath427 ( note that , here , the problem is written without constraint ) .",
    "as in section [ modshsp ] , the kernel formulation of this optimal control problem consists of minimizing the functional @xmath428 over all measurable functions @xmath429 , where the curve @xmath430\\rightarrow m$ ] is the solution of @xmath46 and @xmath431 for almost every @xmath94 $ ] , with @xmath432 for @xmath433 .    obviously , without any further consideration",
    ", studying this space essentially amounts to studying each @xmath412 separately , the only interaction possibly intervening from the final cost function @xmath251 .",
    "more interesting problems arise however when the shapes can interact with each other , and are subject to consistency constraints .",
    "for example , assume that one studies a cat shape , decomposed into two parts for the body and the tail .",
    "since these parts have very different properties , it makes sense to consider them _ a priori _ as two distinct shapes @xmath434 and @xmath435 , with shape spaces @xmath436 and @xmath437 , each of them being associated with rkhs s @xmath438 and @xmath439 respectively .",
    "then , in order to take account for the tail being attached to the cat s body , the contact point of the body and the tail of the cat must belong to both shapes and be equal .",
    "in other words , if @xmath440 represents the body and @xmath441 the tail , then there must hold @xmath442 for some @xmath443 and @xmath444 .",
    "this is a particular case of state constraints , i.e. , constraints depending only on the state @xmath134 of the trajectory .",
    "considering a more complicated example , assume that two ( or more ) shapes are embedded in a given background .",
    "consider two states @xmath445 and @xmath446 in respective spaces @xmath447 and @xmath448 of @xmath0 .",
    "assume that they represent the boundaries of two disjoint open subsets @xmath449 and @xmath450 of @xmath0 .",
    "we define a third space @xmath451 , whose elements are of the form @xmath452 .",
    "this shape space represents the boundary of the complement of @xmath453 ( this complement being the background ) .",
    "each of these three shape spaces is acted upon by the diffeomorphisms of @xmath0 .",
    "consider for every @xmath412 an rkhs @xmath454 of vector fields .",
    "the total shape space is then @xmath455 , an element of which is given by @xmath456 .",
    "note that @xmath457 .",
    "however , since @xmath458 represents the left - hand side of this equality , and @xmath459 the right - hand side , it only makes sense to impose the constraints @xmath460 and @xmath461 .",
    "this model can be used for instance to study two different shapes that are required not to overlap during the deformation .    in this example",
    ", one can even go further : the background does not need to completely mimic the movements of the shapes .",
    "we can for example let the boundaries slide on each another .",
    "this imposes constraints on the speed of the shapes ( and not just on the shapes themselves ) , of the form @xmath462 .",
    "see section [ sec7 ] for additional details .",
    "multi - shapes are of great interest in computational anatomy and provide an important motivation to study shape deformation under constraints .",
    "the purpose of this section is to show that at least one solution of problem [ diffprob1 ] can be approximated by a sequence of solutions of a family of nested optimal control problems on finite - dimensional shape spaces with finite - dimensional constraints .",
    "we assume throughout that @xmath62 .",
    "let @xmath463 be a sequence of banach spaces and @xmath464 be a sequence of continuous mappings @xmath465 that are linear and continuous with respect to the second variable .",
    "let @xmath466 be a sequence of continuous functions on @xmath25 , bounded from below with a constant independent of @xmath188 .",
    "for every integer @xmath188 , we consider the problem of minimizing the functional @xmath467 over all @xmath234 such that @xmath468 for almost every @xmath94 $ ] , where @xmath469\\rightarrow m$ ] is the curve defined by @xmath46 and @xmath217 for almost every @xmath94 $ ] .",
    "it follows from theorem [ existence ] that there exists an optimal solution @xmath470 .",
    "we denote by @xmath471 the corresponding curve .",
    "[ apdimfinie ] assume that @xmath1 is an rkhs of vector fields of class @xmath343 on @xmath0 and that the sequence @xmath472 is decreasing ( in the sense of the inclusion ) and satisfies @xmath473 for every @xmath28 .",
    "assume that @xmath474 converges to @xmath251 uniformly on every compact subset of @xmath25 .",
    "finally , assume that @xmath219 has compact support .",
    "then the sequence @xmath475 is bounded in @xmath327 , and every cluster point of this sequence for the weak topology of @xmath327 is an optimal solution of problem [ diffprob1 ] .",
    "more precisely , for every cluster point @xmath476 of @xmath475 , there exists a subsequence such that @xmath477 converges weakly to @xmath478 , the sequence @xmath479 of corresponding curves converges uniformly to @xmath320 , and @xmath480 converges to @xmath481 as @xmath482 tends to @xmath483 , and @xmath476 is a solution of problem [ diffprob1 ] .    the sequence @xmath475 is bounded in @xmath327 as a consequence of the fact that the functions @xmath474 are uniformly bounded below .",
    "let @xmath476 be a cluster point of this sequence for the weak topology of @xmath327 .",
    "assume that @xmath477 converges weakly to @xmath478 .",
    "denoting by @xmath320 the curve corresponding to @xmath476 , the sequence @xmath479 converges uniformly to @xmath320 ( see lemma [ seqcomp ] ) . using the property of decreasing inclusion",
    ", we have @xmath484 for every integer @xmath485 and every integer @xmath486 . using the same arguments as in the proof of theorem [ existence ] ( see section [ sec_proof_thm_existence ] ) , it follows that @xmath487 . finally , since @xmath488 , and since @xmath474 converges uniformly to @xmath251 on every compact subset of @xmath25 , it follows that @xmath489 .",
    "since every @xmath490 belongs as well to @xmath491 , it follows that @xmath492 , for every time - dependent vector field @xmath234 such that @xmath493 , where @xmath469\\rightarrow m$ ] is the curve corresponding to @xmath226 .",
    "since @xmath474 converges uniformly to @xmath251 , one has @xmath494 as @xmath495 .",
    "it follows that @xmath496 .",
    "we have proved that @xmath497 , and therefore @xmath498 , that is , @xmath476 is an optimal solution of problem [ diffprob1 ] , and @xmath480 converges to @xmath481 as @xmath482 tends to @xmath483 .",
    "[ [ application - approximation - with - finite - dimensional - shape - spaces . ] ] application : approximation with finite dimensional shape spaces .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    let @xmath499 be the unit circle of @xmath2 , let @xmath62 be an integer , @xmath500 and let @xmath501 be the space of parametrized simple closed curves of class @xmath49 on @xmath0 .",
    "we identify @xmath13 with the space of all mappings @xmath502,\\r^d)$ ] such that @xmath503 , @xmath504 , ... , @xmath505 .",
    "the action of the group of diffeomorphisms of @xmath0 on @xmath25 , defined by composition , is smooth of order @xmath57 ( see section [ modshsp ] ) .",
    "let @xmath506 and @xmath507 fixed .",
    "we define @xmath251 by @xmath508 for every @xmath28 .",
    "consider pointwise kinetic constraints @xmath509 , defined by @xmath510 for every @xmath511 , with @xmath512 , where @xmath513 is the set of real matrices of size @xmath514 .",
    "note that the multishapes constraints described in section [ mlmk ] are of this form .",
    "our objective is to approximate this optimal control problem with a sequence of optimal control problems specified on the finite dimensional shape spaces @xmath515 .    for @xmath516 ,",
    "let @xmath517 be the infinitesimal action of the group of diffeomorphisms on @xmath515 , the elements of which are denoted by @xmath518 .",
    "define on the associated control problem the kinetic constraints @xmath519 , and the data attachment function @xmath520 let @xmath521 be an optimal control of problem [ diffprob1 ] for the above optimal control problem specified on @xmath515 .",
    "[ findimapprox ] every cluster point of the sequence @xmath475 for the weak topology on @xmath327 is a solution of problem [ diffprob1 ] specified on @xmath501 with constraints and minimization functional respectively given by @xmath220 and @xmath251 defined above .",
    "define the submersions @xmath522 by @xmath523 let @xmath524 and @xmath525 .",
    "in other words , @xmath474 ( resp .",
    "@xmath526 ) are the lifts of @xmath527 ( resp .",
    "@xmath528 ) from @xmath515 to @xmath25 through @xmath529 . using remark [ refapprox ] on lifted shape spaces , we infer that the optimal control @xmath530 of problem [ diffprob1 ] specified on the finite dimensional space @xmath515 with constraints @xmath528 and data attachment @xmath527 is also optimal for problem [ diffprob1 ] specified on the infinite dimensional set @xmath25 with constraints @xmath526 and data attachment @xmath474 .",
    "now , if @xmath531 for every integer @xmath188 , then @xmath532 for every @xmath533 with @xmath516 and @xmath534 .",
    "the set of such @xmath535 is dense in @xmath97 $ ] , and @xmath536 is continuous .",
    "therefore @xmath532 for every @xmath537 $ ] , that is , @xmath538 .",
    "since the converse is immediate , we get @xmath539 . finally , since @xmath239 is a closed curve of class at least @xmath49 with @xmath62 , it is easy to check that @xmath540 converges to @xmath251 , uniformly on every compact subset of @xmath25 .",
    "therefore , proposition [ apdimfinie ] can be applied to the sequence @xmath475 , which completes the proof .",
    "[ remapdimfinie ] the same argument works as well if we replace @xmath499 with any compact riemannian manifold @xmath138 , and applies to the vertices of increasingly finer triangulations of @xmath138 .",
    "let @xmath541 be a sequence of @xmath327 such that @xmath542 converges to its infimum .",
    "let @xmath543 be the corresponding sequence of deformations and let @xmath544 be the sequence of corresponding curves ( one has @xmath545 thanks to remark [ rempb1_unknowns ] ) .",
    "since @xmath251 is bounded below , it follows that the sequence @xmath541 is bounded in @xmath327 .",
    "the following lemma is well known ( see @xcite ) , but we provide a proof for the sake of completeness .    [ seqcomp ] there exist @xmath478 , corresponding to the deformation @xmath546 , and a sequence @xmath547 of integers such that @xmath548 converges weakly to @xmath476 and such that , for every compact subset @xmath244 of @xmath0 , @xmath549}\\vert(\\varphi_{n_j}(t,\\cdot)- \\bar\\varphi(t,\\cdot))_{\\vert u}\\vert_{\\ell}\\underset{j\\rightarrow+\\infty}{\\longrightarrow } 0.\\ ] ]    since the sequence @xmath541 is bounded in the hilbert space @xmath327 , there exists a subsequence @xmath548 converging weakly to some @xmath550 . besides",
    ", using for @xmath551 and the ascoli theorem , we infer that for every compact subset @xmath244 of @xmath0 , the sequence @xmath552 is contained in a compact subset of the space @xmath553,\\mathcal{c}_0^{\\ell}(u,\\r^d))$ ] . considering a compact exhaustion of @xmath0 and using a diagonal extraction argument",
    ", we can therefore extract a subsequence @xmath554 with limit @xmath546 such that , for any compact subset @xmath244 of @xmath0 , @xmath555}\\vert(\\varphi_{n_{j_k}}(t,\\cdot)- \\bar\\varphi(t,\\cdot))_{\\vert u}\\vert_{\\ell}\\underset{k\\rightarrow+\\infty}{\\longrightarrow } 0.\\ ] ] to complete the proof , it remains to prove that @xmath556 is the deformation induced by @xmath476 . on the first hand",
    ", we have @xmath557 , for every @xmath72 and every @xmath94 $ ] . on the second hand",
    ", one has , for every @xmath558 , @xmath559 set @xmath560 , and define @xmath561}\\delta_{\\bar \\varphi(\\cdot , x)}\\in v^*$ ] by @xmath562}\\delta_{\\bar \\varphi(\\cdot , x)}\\vert v)_{l^2(0,1;v)}=\\int_0^tv\\circ\\bar \\varphi(s , x ) \\ , ds$ ] .",
    "then , @xmath563}\\vert\\varphi_{n_{j_k}}(s , x)- \\bar \\varphi(s , x)\\vert   \\\\ & +   \\left\\vert ( \\chi_{[0,t]}\\delta_{\\bar \\varphi(\\cdot , x)}\\vert v_{n_{j_k}}-\\bar v)_{l^2(0,1;v)}\\right\\vert,\\end{aligned}\\ ] ] which converges to @xmath190 as @xmath482 tends to @xmath483 thanks to and to the weak convergence @xmath564 to @xmath476 .",
    "we thus conclude that @xmath565 , which completes the proof .    setting @xmath566 for every @xmath94",
    "$ ] , one has @xmath567 for almost every @xmath94 $ ] , and it follows from the above lemma and from the fact that @xmath219 has compact support that @xmath568}\\vert \\bar q(t)-q_{n_j}(t)\\vert_x\\underset{j\\rightarrow+\\infty}{\\longrightarrow } 0.\\ ] ]    the operator @xmath569 is linear and continuous on @xmath327 , so it is also weakly continuous @xcite .",
    "we infer that the sequence @xmath570 converges weakly to @xmath571 in @xmath572 .",
    "since @xmath573 for every @xmath574 , it follows that @xmath487 . in other words ,",
    "the time - dependent vector field @xmath476 satisfies the constraints .",
    "it remains to prove that @xmath476 is indeed optimal . from the weak convergence of the sequence @xmath548 to @xmath476 in @xmath327 ,",
    "we infer that@xmath575 besides , since @xmath251 is lower continuous , @xmath576 .",
    "since @xmath577 converges to @xmath578 , it follows that @xmath579 .",
    "in this section , we derive first - order necessary conditions for optimality in problem [ diffprob1 ] .",
    "we extend the well - known pontryagin maximum principle ( pmp ) from optimal control theory to our infinite - dimensional framework , under the assumption that the constraints are surjective .",
    "this allows us to derive the constrained geodesic equations for shape spaces , and we show how they can be reduced to simple hamiltonian dynamics on the cotangent space of the shape space .",
    "we address the pontyagin maximum principle in a slightly extended framework , considering a more general control system and a more general minimization functional than in problem [ diffprob1 ] .",
    "let @xmath1 be a hilbert space , and let @xmath13 and @xmath26 be banach spaces .",
    "let @xmath25 be an open subset of @xmath13 .",
    "let @xmath580 and @xmath212 be mappings of class @xmath136 .",
    "let @xmath581 and @xmath214 be functions of class @xmath136 .",
    "we assume that there exist continuous functions @xmath582 and @xmath583 such that @xmath584 and @xmath585 for all @xmath586 and all @xmath587 .",
    "let @xmath41 .",
    "we consider the optimal control problem of minimizing the functional @xmath588 over all @xmath224 such that @xmath328 and @xmath218 for almost every @xmath94 $ ] .",
    "we define the _ hamiltonian _ @xmath589 by @xmath590 it is a function of class @xmath136 . using the canonical injection @xmath591 , we have @xmath592 .    the estimate on @xmath593",
    "is exactly what is required to ensure that the mapping @xmath594 be well defined and frchet differentiable for every @xmath595 .",
    "indeed , the estimate @xmath596 implies the integrability property .",
    "the differentiability is an immediate consequence of the following estimate , obtained by combining with the mean value theorem : for every @xmath71 $ ] , and for some @xmath597 $ ] , one has @xmath598    [ pmp ] assume that the linear operator @xmath599 is surjective for every @xmath28 .",
    "let @xmath600 be an optimal solution of the above optimal control problem .",
    "then there exist @xmath601 and @xmath602 such that @xmath603 and @xmath604 for almost every @xmath94 $ ] .",
    "this theorem is the extension of the usual pmp to our specific infinite dimensional setting .",
    "any quadruple @xmath605 solution of the above equations is called an _",
    "extremal_. this is a `` weak '' maximum principle , in the sense that we derive the condition @xmath606 along any extremal , instead of the stronger maximization condition @xmath607 for almost every @xmath71 $ ] .",
    "note however that , in the case of shape spaces , @xmath608 is strictly concave and hence both conditions are equivalent .",
    "it is interesting to note that , if we set @xmath609 with @xmath57 large enough , and if @xmath610 and @xmath611 , then the extremal equations given in theorem [ pmp ] coincide with the incompressible euler equation . in other words , we recover the well - known fact that every divergence - free time - dependent vector field minimizing its @xmath612 norm ( in @xmath260 and @xmath364 ) must satisfy the incompressible euler equation ( see @xcite ) .    note that the surjectivity assumption is a strong one in infinite dimension .",
    "it is usually not satisfied in the case of shape spaces when @xmath26 is infinite dimensional .",
    "for instance , consider the shape spaces @xmath613 , with @xmath137 a smooth compact riemannian manifold .",
    "let @xmath1 be an rkhs of vector fields of class @xmath233 , acting on @xmath25 as described in section [ modshsp ] .",
    "let @xmath614 be a submanifold of @xmath137 of class @xmath136 .",
    "set @xmath615 , and consider the kinetic constraints @xmath212 defined by @xmath616 . if @xmath134 is differentiable along @xmath614 , then no nondifferentiable map @xmath617 is in @xmath618 .",
    "it is possible to replace @xmath353 with the orthogonal projection on @xmath619 , which is automatically surjective .",
    "however in this case the constraints become fiber - valued , and for the proof of our theorem to remain valid , one needs to assume that there exists a hilbert space @xmath438 such that , for every @xmath41 , there exists a neighborhood @xmath244 of @xmath219 in @xmath25 such that @xmath620 .",
    "an important consequence of the surjectivity of @xmath353 is that the norm on @xmath26 is equivalent to the hilbert norm induced from @xmath1 by @xmath353 , for every @xmath28 .",
    "the operator @xmath621 is the isometry associated with this norm . in particular @xmath26 must be reflexive , and hence @xmath622 ( whereas we only have an inclusion for general banach spaces ) .",
    "theorem [ pmp ] withstands several generalizations .",
    "for instance it remains valid whenever we consider nonlinear constraints @xmath623 and a general lagrangian @xmath593 of class @xmath136 without any estimates and a nonlinear control system @xmath624 , provided that @xmath194 is of class @xmath136 and that @xmath625 is surjective for every @xmath94 $ ] .",
    "however , this requires to consider @xmath626 and makes the proof of the regularity of the lagrange multipliers slightly more involved .    before proving theorem [ pmp ]",
    ", it can be noted that many versions of the pmp can be found in the existing literature for infinite - dimensional optimal control problems  for instance , with dynamics consisting of partial differential equations , and however , most of the time , without constraint on the state . versions of the pmp with state constraints can also be found in the literature ( see the survey @xcite ) , most of the time in finite dimension , and , for the very few of them existing in infinite dimension , under the additional assumption that the constraints are of finite codimension . to the best of our knowledge",
    ", no version does exist that would cover our specific framework , concerning shape spaces , group actions , with an infinite number of constraints on the acting diffeomorphisms .",
    "the proof that we provide hereafter contains some subtleties such as lemma [ lem4 ] , and hence theorem [ pmp ] is a nontrivial extension of the usual pmp .",
    "we define the mapping @xmath627 by @xmath628 with @xmath629 and @xmath630 for almost every @xmath94 $ ] . the mapping @xmath631 stands for the constraints imposed to the unknowns of the optimal control problem .",
    "the functional @xmath632 and the mapping @xmath631 are of class @xmath136 , and their respective differentials at some point @xmath633 are given by @xmath634 for all @xmath635 , and @xmath636 with @xmath637 for almost every @xmath94 $ ] .",
    "[ ift ] for every @xmath638 , the linear continuous mapping @xmath639 is surjective .",
    "moreover the mapping @xmath640 is an isomorphism .",
    "let @xmath638 and @xmath641 .",
    "let us prove that there exists @xmath642 such that @xmath643 for almost every @xmath71 $ ] .    for every @xmath644",
    ", @xmath645 is a surjective linear continuous mapping .",
    "it follows that @xmath646 is an isomorphism ( note that @xmath647 since @xmath1 is hilbert ) .",
    "we set @xmath648 .",
    "note that @xmath649 is of class @xmath136 in a neighbourhood of @xmath650)$ ] .",
    "assume for the moment that @xmath651 is known .",
    "then we choose @xmath652 defined by @xmath653 for almost every @xmath71 $ ] , so that is satisfied . plugging this expression into yields @xmath654 for almost every @xmath94 $ ]",
    "this is a well - posed linear differential equation with square - integrable coefficients in the banach space @xmath13 , which has a unique solution @xmath655 such that @xmath656 .",
    "this proves the statement .    proving that the mapping @xmath640 , defined by @xmath657 for almost every @xmath94 $ ] , is an isomorphism follows the same argument , by cauchy uniqueness .",
    "let @xmath638 be an optimal solution of the optimal control problem .",
    "in other words , @xmath633 is a minimizer of the problem of minimizing the functional @xmath658 over the set of constraints @xmath659 ( which is a @xmath660 manifold as a consequence of lemma [ ift ] and of the implicit function theorem ) .",
    "since @xmath661 is surjective ( note that this fact is essential since we are in infinite dimension ) , it follows from ( * ? ? ?",
    "* theorem 4.1 ) that there exists a nontrivial lagrange multiplier @xmath662 such that @xmath663 .",
    "moreover since @xmath26 is reflexive one has @xmath664,y^*)$ ] , and hence we can identify @xmath665 with a square - integrable @xmath666-valued measurable mapping , so that the lagrange multipliers relation yields @xmath667 for all @xmath668,y^*)$ ] and all @xmath669 .",
    "note that the space @xmath670 can be different from @xmath671 ( unless @xmath16 satisfies the radon - nikodym property , but there is no reason to consider such a banach space @xmath13 ) , and hence _ a priori _",
    "@xmath20 can not be obviously identified with a square - integrable @xmath16-valued measurable mapping .",
    "anyway , in the next lemma we show that this identification is possible , due to a hidden regularity property in .",
    "[ lem4 ] we can identify @xmath20 with an element of @xmath672,x^*)$ ] , so that @xmath673 for every @xmath674 .    for every @xmath674",
    ", we define @xmath655 by @xmath675 for every @xmath537 $ ] ( bochner integral in the banach space @xmath13 ) , so that @xmath676 . defining @xmath677 by @xmath678 for every @xmath679 , and taking @xmath680 in",
    ", we get @xmath681 let us express @xmath682 in another way with respect to @xmath683 . by definition , one has @xmath684 for every @xmath537 $ ] , and this can be also written as @xmath685}(s ) r(t)\\ , dt$ ] , with @xmath686}(s)=1 $ ] whenever @xmath687 $ ] and @xmath190 otherwise . in other words",
    ", one has @xmath688 } r(t)\\ , dt$ ] ( bochner integral ) .",
    "for every @xmath94 $ ] , we define the operator @xmath689 by @xmath690}x$ ] .",
    "it is clearly linear and continuous .",
    "then , we have @xmath691 , and therefore , using , @xmath692 now , interchanging the bochner integrals and the linear forms , we infer that @xmath693 and then , using the adjoint @xmath694 , we get @xmath695 since this identity holds true for every @xmath674 , it follows that @xmath20 can be identified with an element of @xmath671 , still denoted by @xmath20 , with @xmath696 for almost every @xmath94 $ ]",
    ".    still using the notation introduced in the proof of lemma [ lem4 ] , now that we know that @xmath697 , we infer from that @xmath698 can as well be identified with an element of @xmath672,x^*)$ ] , with @xmath699 for almost every @xmath94 $ ] .",
    "note that @xmath700 , where the hamiltonian @xmath701 is defined by .",
    "since @xmath702 , we have , for every @xmath703 , @xmath704}x\\big\\rangle_{l^2(0,1,x^*),l^2(0,1;x ) }   = \\int_0 ^ 1 \\langle\\alpha(s ) , \\chi_{[t,1]}(s)x\\rangle_{x^*,x } \\ , ds \\\\ & = \\int_t^1 \\langle\\alpha(s ) , x\\rangle_{x^*,x}\\ , ds   = \\big\\langle\\int_t^1\\alpha(s)\\ , ds , x\\big\\rangle_{x^*,x } , \\end{split}\\ ] ] and therefore @xmath705 for every @xmath94 $ ] .",
    "it follows that @xmath706 , and hence , that @xmath601 and that @xmath707 satisfies the differential equation @xmath708 for almost every @xmath94 $ ] and @xmath603 .    finally , taking @xmath709 in yields @xmath710 for every @xmath711 , and hence @xmath712 for almost every @xmath94 $ ] , which exactly means that @xmath713 .",
    "the theorem is proved .",
    "we use the notations introduced in section [ modshsp ] , and consider a shape space @xmath25 of order @xmath714 @xmath1 an rkhs of vector fields of class @xmath343 on @xmath0 , and we set @xmath715 .",
    "we assume that @xmath220 and @xmath251 are at least of class @xmath136 and that @xmath716 is surjective for every @xmath28 .    in this context",
    "@xmath194 is of class @xmath136 .",
    "let us apply theorem [ pmp ] .",
    "we have @xmath717 , and the condition @xmath718 is equivalent to @xmath719",
    ". then we have @xmath720 , where @xmath721 is defined by .",
    "besides , @xmath722 if and only if @xmath723 .",
    "since @xmath353 is surjective , it follows that @xmath724 is invertible , and hence @xmath725 .",
    "the mapping @xmath726 defined as such is of class @xmath136 and is linear in @xmath20 . in particular , @xmath727 is a function of class @xmath136 of @xmath134 and @xmath20 and is linear in @xmath20 .",
    "we have obtained the following result .",
    "[ geodeq ] let @xmath224 be a solution of problem [ diffprob1 ] .",
    "there exists @xmath601 such that @xmath728 for almost every @xmath94 $ ] , and @xmath707 satisfies @xmath603 and the geodesic equations @xmath729 for almost every @xmath94 $ ] , with @xmath730 moreover the mapping @xmath731 is constant , and one has @xmath732    [ rem11 ] defining the so - called reduced hamiltonian @xmath733 by @xmath734 we have a priori @xmath735 .",
    "but since @xmath736 and @xmath737 are such that @xmath738 and @xmath739 , it follows that @xmath740 .",
    "similarly , we have @xmath741 .",
    "therefore , in theorem [ geodeq ] , the geodesics are the solutions of the hamiltonian system @xmath742    [ geodeq3 ] assume that the mappings @xmath220 and @xmath194 are of class @xmath743 .",
    "then @xmath744 is of class @xmath743 as well , and for every @xmath745 , there exists @xmath330 and there exists a unique solution @xmath746\\rightarrow m\\times x^*$ ] of the geodesic equations such that @xmath747 .    note that for most of shape spaces ( at least , for all shape spaces given as examples in this paper ) , the mapping @xmath194 is of class @xmath743 whenever @xmath1 is an rkhs of vector fields of class @xmath748 .",
    "a geodesic @xmath749 on the landmark space @xmath750 must satisfy the equations @xmath751 where @xmath117 is the kernel of @xmath1 .",
    "[ rem_propequiv ] assume that the constraints are kinetic , i.e. , are of the form @xmath344 with @xmath752",
    ". then @xmath753 and @xmath754 .",
    "note that even if @xmath291 is not invertible , the assumption that @xmath346 is surjective means that @xmath755 is invertible .",
    "in particular , minimizing controls take the form @xmath756 , with @xmath757 .",
    "this proves the contents of proposition [ equiv ] ( see section [ modshsp ] ) .",
    "[ rem_abnormal ] let @xmath25 ( resp . , @xmath758 ) , open subset of a banach space @xmath13 ( resp . , @xmath759 ) ,",
    "be a shape space of order @xmath57 ( resp . of order @xmath760 ) .",
    "assume that there is a dense and continuous inclusion @xmath761 , such that @xmath762 is equivariant ( in particular we have @xmath763 ) .",
    "for every @xmath764 , there are more geodesics emanating from @xmath219 on @xmath25 than on @xmath758 ( indeed it suffices to consider initial momenta @xmath765 ) .",
    "these curves are not solutions of the geodesic equations on @xmath758 , and are an example of so - called _ abnormal extremals _ @xcite .",
    "note that they are however not solutions of problem [ diffprob1 ] specified on @xmath759 , since theorem [ pmp ] implies that such solutions are projections of geodesics having an initial momentum in @xmath766 .",
    "an example where this situation is encountered is the following .",
    "let @xmath137 be a compact riemannian manifold .",
    "consider @xmath767 and @xmath768 , with actions defined in definition [ infgaction ] .",
    "if @xmath769 is a @xmath770-th order distribution , then the geodesic equations on @xmath13 with initial momentum @xmath769 yield an abnormal geodesic in @xmath759 .",
    "following remark [ rem_abnormal ] , if the data attachment function @xmath771 can be smoothly extended to a larger space @xmath759 , then the initial momentum of any solution of problem [ diffprob1 ] is actually in @xmath772 .",
    "for example , we set @xmath773 , for some @xmath774 , with @xmath775 and @xmath137 a compact riemannian manifold .",
    ". then the momentum @xmath777\\rightarrow x^*$ ] associated with a solution of problem [ diffprob1 ] ( whose existence follows from theorem [ geodeq ] ) takes its values in @xmath778 .",
    "[ [ the - case - of - pure - state - constraints . ] ] the case of pure state constraints .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    let us consider pure state constraints , i.e. , constraints of the form @xmath779 with @xmath230 . recall",
    "that , if @xmath220 is of class @xmath136 , then they can be transformed into the mixed constraints @xmath780 . in this particular case ,",
    "the geodesic equations take a slightly different form .",
    "[ geodstco ] assume that @xmath230 is of class @xmath781 , and that @xmath782 is surjective for every @xmath28 .",
    "consider problem [ diffprob1 ] with the pure state constraints @xmath779 . if @xmath234 is a solution of problem [ diffprob1 ] , associated with the curve @xmath469\\rightarrow m$ ] , then there exists @xmath783\\rightarrow x^*$ ] such that @xmath784 for almost every @xmath94 $ ] , with @xmath785 moreover one has @xmath786 and @xmath787 for some @xmath788 .",
    "note that all functions involved are of class @xmath136 .",
    "therefore , for a given initial condition @xmath789 with @xmath790 , there exists a unique geodesic emanating from @xmath219 with initial momentum @xmath791 .",
    "the proof just consists in considering @xmath792 and @xmath793 , where @xmath20 and @xmath665 are given by theorem [ geodeq ] , and then in differentiating @xmath229 twice with respect to time .",
    "the mappings @xmath794 and @xmath795 can also be obtained independently of theorem [ geodeq ] as lagrange multipliers for the mapping of constraints @xmath796 , using the same method as in the proof of theorem [ pmp ] , under the assumptions that @xmath797 is of class @xmath743 and @xmath798 is surjective for every @xmath28 .",
    "in this section we derive some algorithms in order to compute the solutions of the optimal control problem considered throughout .",
    "we first consider problems without constraint in section [ unconsmin ] , and then with constraints in section [ matchconst ] .",
    "shape deformation analysis problems without constraint have already been studied in @xcite with slightly different methods , in different and specific contexts . with our previously developed general framework",
    ", we are now going to recover methods that are well known in numerical shape analysis , but with a more general point of view allowing us to generalize the existing approaches .    [ [ gradient - descent . ] ] gradient descent .",
    "+ + + + + + + + + + + + + + + + +    we adopt the notations , the framework and the assumptions used in section [ pmps ] , but without constraint . for @xmath41",
    "fixed , we consider the optimal control problem of minimizing the functional @xmath658 defined by over all @xmath224 such that @xmath328 for almost every @xmath94 $ ] .",
    "the hamiltonian of the problem then does not involve the variable @xmath665 , and is the function @xmath799 defined by @xmath800 .",
    "we assume throughout that @xmath801 , that @xmath580 is of class @xmath802 , is a linear mapping in @xmath67 , and that @xmath803 satisfies the estimate .    as in the proof of theorem [ pmp ]",
    ", we define the mapping @xmath804 by @xmath805 for almost every @xmath94 $ ] .",
    "the objective is to minimize the functional @xmath658 over the set @xmath806 .    according to lemma [ ift ] ,",
    "the mapping @xmath807 is an isomorphism for all @xmath808 .",
    "therefore , the implicit function theorem implies that @xmath809 is the graph of the mapping @xmath810 which to a control @xmath242 associates the curve @xmath811 solution of @xmath812 for almost every @xmath94 $ ] and @xmath813 .",
    "moreover this mapping is , like @xmath631 , of class @xmath743 .",
    "then , as it was already explained in remark [ rempb1_unknowns ] in the case where @xmath715 , minimizing @xmath658 over @xmath809 is then equivalent to minimizing the functional @xmath814 over @xmath327 .",
    "thanks to these preliminary remarks , the computation of the gradient of @xmath815 then provides in turn a gradient descent algorithm .",
    "[ dcost ] the differential of @xmath816 is given by @xmath817 for every @xmath818 , where @xmath819,x^*)$ ] is the solution of @xmath820 for almost every @xmath71 $ ] and @xmath821 .",
    "in particular we have @xmath822 for almost every @xmath94 $ ] .",
    "this result still holds true for lagrangians @xmath593 that do not satisfy , replacing @xmath327 with @xmath823 .",
    "the gradient is computed with respect to the pre - hilbert scalar product inherited from @xmath612 .",
    "let @xmath242 be arbitrary .",
    "for every @xmath818 , we have @xmath824 , with @xmath825 .",
    "note that @xmath826 ( the tangent space of the manifold @xmath809 at @xmath827 ) , since @xmath809 is the graph of the mapping @xmath828 . since @xmath806 , we have @xmath829 for every @xmath830 .",
    "let us find some particular @xmath20 such that @xmath831 only depends on @xmath832 .",
    "let @xmath819,x^*)$ ] be the solution of @xmath820 for almost every @xmath71 $ ] and @xmath821 . using the computations done in the proof of theorem [ pmp ] , we get @xmath833 integrating by parts and using the relations @xmath656 and @xmath821 , we obtain @xmath834 since @xmath829 , the proposition follows .    in the case of shape spaces , which form our main interest here",
    ", we have @xmath715 , and then @xmath835 and @xmath836 .",
    "it follows that @xmath837 in particular , if @xmath838 for some @xmath839,x^*)$ ] , then @xmath840 for every @xmath841 .",
    "therefore , applying a gradient descent algorithm does not change this form .",
    "it is then important to notice that this provides as well a gradient descent algorithm for solving problem [ diffprob2 ] ( the kernel formulation of problem [ diffprob1 ] ) without constraint , and this in spite of the fact that @xmath672,x^*)$ ] is not necessarily a hilbert space . in this case , if @xmath819,x^*)$ ] is the solution of @xmath820 for almost every @xmath71 $ ] and @xmath821 , then @xmath842 is the gradient of the functional @xmath843 defined by with respect to the symmetric nonnegative bilinear form @xmath844 .",
    "this gives a first algorithm to compute unconstrained minimizers in a shape space .",
    "we next provide a second method using the space of geodesics .",
    "[ [ gradient - descent - on - geodesics - minimization - through - shooting . ] ] gradient descent on geodesics : minimization through shooting .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    since the tools are quite technical , in order to simplify the exposition we assume that the shape space @xmath25 is finite dimensional , i.e. , that @xmath23 for some @xmath845 .",
    "the dual bracket @xmath846 is then identified with the canonical euclidean product @xmath847 , and @xmath848 is identified with a @xmath849 positive semi - definite symmetric matrix .",
    "theorem [ geodeq ] and corollary [ geodeq3 ] ( see section [ geodeqshsp ] ) imply that the minimizers of the functional @xmath816 defined by coincide with those of the functional @xmath850 where @xmath851 and @xmath852 is the geodesic solution of the hamiltonian system @xmath853 , @xmath854 , for almost every @xmath94 $ ] , with @xmath747 . here",
    ", @xmath744 is the reduced hamiltonian ( see remark [ rem11 ] ) and is given by @xmath855 .",
    "therefore , computing a gradient of @xmath856 for some appropriate bilinear symmetric nonnegative product provides in turn another algorithm for minimizing the functional @xmath816 .",
    "for example , if the inner product that we consider is the canonical one , then @xmath857 . the term @xmath858 is computed thanks to the following well - known result .",
    "[ gradedo ] let @xmath859 , let @xmath244 be an open subset of @xmath860 , let @xmath861 be a complete smooth vector field on @xmath244 , let @xmath862 be the function of class @xmath136 defined on @xmath244 by @xmath863 , where @xmath251 is a function on @xmath244 of class @xmath136 and @xmath864\\rightarrow\\r^n$ ] is the solution of @xmath865 for almost every @xmath94 $ ] and @xmath46 . then @xmath866 where @xmath867\\rightarrow\\r^n$ ] is the solution of @xmath868 for almost every @xmath94 $ ] and @xmath869 .    in our case",
    ", we have @xmath870 and @xmath871 .",
    "note that we used the euclidean gradient instead of the derivatives .",
    "this is still true thanks to the identification made between linear forms and vectors at the beginning of the section .",
    "we get @xmath872 , where @xmath873 is the solution of @xmath874 for almost every @xmath94 $ ] and @xmath875",
    ".    in numerical implementations , terms of the form @xmath876 , with @xmath877 a vector field and @xmath30 a vector , require a long computational time since every partial derivative of @xmath877 has to be computed . in our context however , using the fact that the vector field @xmath878 is hamiltonian , the computations can be simplified in a substantial way .",
    "indeed , using the commutation of partial derivatives , we get @xmath879 replacing @xmath744 with its expression , we get @xmath880 therefore , instead of computing @xmath881 , which requires the computation of all partial derivatives of @xmath882 , it is required to compute only one of them , namely the one with respect to @xmath698 .",
    "let us sum up the result in the following proposition .",
    "[ prop8 ] we have @xmath872 , where @xmath883 is the solution of @xmath884 with @xmath885 , and @xmath886 satisfies the geodesic equations @xmath887 and @xmath888 for almost every @xmath94 $ ] , with @xmath46 and @xmath889 .    a gradient descent algorithm",
    "can then be used in order to minimize @xmath856 and thus @xmath816 .      in this section ,",
    "we derive several different methods devoted to solve numerically constrained optimal control problems on shape spaces . to avoid using overly technical notation in their whole generality ,",
    "we restrict ourselves to the finite - dimensional case .",
    "the methods can however be easily adapted to infinite - dimensional shape spaces .",
    "we use the notation , the framework and the assumptions of section [ modshsp ] .",
    "let @xmath23 and let @xmath25 be an open subset of @xmath13 . for every @xmath28 , we identify @xmath291 with a @xmath849 symmetric positive semi - definite real matrix . throughout the section , we focus on kinetic constraints and we assume that we are in the conditions of proposition [ equiv ] , so that these constraints take the form @xmath890 .",
    "note that , according to proposition [ proposition1 ] , in this case problems [ diffprob1 ] and [ diffprob2 ] are equivalent .",
    "hence in this section we focus on problem [ diffprob2 ] , and thanks to the identifications above the functional @xmath843 defined by can be written as @xmath891 note ( and recall ) that pure state constraints , of the form @xmath779 , are treated as well since , as already mentioned , they are equivalent to the kinetic constraints @xmath892 .    [ [ the - augmented - lagrangian - method . ] ] the augmented lagrangian method .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    this method consists of minimizing iteratively unconstrained functionals in which the constraints have been penalized .",
    "although pure state constraints are equivalent to kinetic constraints , in this approach they can also be treated directly .",
    "the method goes as follows . in the optimal control problem under consideration ,",
    "we denote by @xmath893\\rightarrow \\r^{k}$ ] the lagrange multiplier associated with the kinetic constraints @xmath462 ( its existence is ensured by theorem [ pmp ] ) .",
    "we define the augmented cost function @xmath894 where @xmath895 , called augmented lagrangian , is defined by @xmath896 with , here , @xmath897 . let @xmath41 fixed .",
    "choose an initial control @xmath898 ( for example , @xmath899 ) , an initial function @xmath900 ( for example , @xmath901 ) , and an initial constant @xmath902 . at step @xmath57 , assume that we have obtained a control @xmath903 generating the curve @xmath904 , a function @xmath905\\rightarrow \\r^{k}$ ] , and a constant @xmath906 .",
    "the iteration @xmath907 is defined as follows .",
    "first , minimizing the unconstrained functional @xmath908 over @xmath909 yields a new control @xmath910 , generating the curve @xmath911 ( see further in this section for an appropriate minimization method ) .",
    "second , @xmath665 is updated according to @xmath912 finally , we choose @xmath913 $ ] ( many variants are possible in order to update this penalization parameter , as is well - known in numerical optimization ) .    under some appropriate assumptions ,",
    "as long as @xmath914 is smaller than some constant @xmath915 , @xmath903 converges to a control @xmath916 which is a constrained extremum of @xmath843 .",
    "note that it is not required to assume that @xmath914 converge to @xmath190 .",
    "more precisely we infer from ( * ? ? ?",
    "* chapter 3 ) the following convergence result .",
    "assume that all involved mappings are least of class @xmath743 and that @xmath917 is surjective for every @xmath28 .",
    "let @xmath916 be an optimal solution of problem [ diffprob2 ] and let @xmath918 be its associated curve .",
    "let @xmath919 be the lagrange multiplier ( given by theorem [ pmp ] ) associated with the constraints .",
    "we assume that there exist @xmath507 and @xmath920 such that @xmath921 for every @xmath922 .",
    "then there exists a neighborhood of @xmath916 in @xmath909 such that , for every initial control @xmath898 in this neighborhood , the sequence @xmath923 built according to the above algorithm converges to @xmath916 , and the sequence @xmath924 converges to @xmath919 , as @xmath57 tends to @xmath483 .",
    "assumption may be hard to check for shape spaces . as is well - known in optimal control theory , this coercivity assumption of the bilinear form @xmath925 is actually equivalent to the nonexistence of _ conjugate points _ of the optimal curve @xmath918 on @xmath97 $ ] ( see @xcite for this theory and algorithms of computation ) . in practice ,",
    "computing conjugate points is a priori easy since it just consists of testing the vanishing of some determinants ; however in our context the dimension @xmath188 is expected to be large and then the computation may become difficult numerically .",
    "pure state constraints @xmath779 can either be treated in the above context by replacing @xmath917 with @xmath926 , or can as well be treated directly by replacing @xmath917 with @xmath927 in the algorithm above .",
    "any of the methods described in section [ unconsmin ] can be used in order to minimize the functional @xmath928 with respect to @xmath929 . for completeness",
    "let us compute the gradient in @xmath929 of @xmath928 at the point @xmath930 .",
    "[ lemma_computation_nabla_ja ] there holds @xmath931 where @xmath707 is the solution of @xmath932 for almost every @xmath94 $ ] and @xmath603 .    for pure state constraints @xmath779 , there simply holds @xmath933 and the differential equation in @xmath20 is @xmath934    we use proposition [ dcost ] with @xmath935 , with @xmath665 and @xmath936 fixed ( it is indeed easy to check that this proposition still holds true when the lagrangian also depends smoothly on @xmath260 ) .",
    "the differential of @xmath928 with respect to @xmath929 is then given by @xmath937 where @xmath707 is the solution of @xmath938 for almost every @xmath94 $ ] and @xmath603 . to get the result",
    ", it then suffices to identify the differential @xmath939 with the gradient @xmath940 with respect to the inner product on @xmath941 given by @xmath942 .",
    "the advantage of the augmented lagrangian method is that , at every step , each gradient is `` easy '' to compute ( at least as easy as in the unconstrained case ) .",
    "the problem is that , as in any penalization method , a lot of iterations are in general required in order to get a good approximation of the optimal solution , satisfying approximately the constraints with enough accuracy .",
    "the next method we propose tackles the constraints without penalization .",
    "[ [ constrained - minimization - through - shooting . ] ] constrained minimization through shooting .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    we adapt the usual shooting method used in optimal control ( see , e.g. , @xcite ) to our context . for @xmath943",
    ", we define @xmath736 as in theorem [ geodeq ] by @xmath944 we also denote @xmath945 . in particular , @xmath946 .",
    "a quick computation shows that @xmath947 is the orthogonal projection of @xmath20 onto @xmath948 for the inner product induced by @xmath291 .    according to theorem [ geodeq ] , corollary [ geodeq3 ] and remark [ rem_propequiv ] ( see section [ geodeqshsp ] ) , the minimizers of @xmath843 have to be sought among the geodesics @xmath852 solutions of , and",
    "moreover @xmath769 is a minimizer of the functional @xmath949 the geodesic equations now take the form @xmath950 where @xmath744 is the reduced hamiltonian ( see remark [ rem11 ] ) .",
    "it follows from proposition [ prop8 ] that @xmath951 , where @xmath952 is the solution of @xmath953 with @xmath885 . replacing @xmath954 and @xmath955 by their expression",
    ", we get @xmath956 in practice , the derivatives appearing in these equations can be efficiently approximated using finite differences .",
    "this algorithm of constrained minimization through shooting has several advantages compared with the previous augmented lagrangian method .",
    "the first is that , thanks to the geodesic reduction , the functional @xmath957 is defined on a finite - dimensional space ( at least whenever the shape space itself is finite dimensional ) and hence @xmath958 is computed on a finite - dimensional space , whereas in the augmented lagrangian method @xmath959 was computed on the infinite - dimensional space @xmath909 .",
    "a second advantage is that , since we are dealing with constrained geodesics , all resulting curves satisfy the constraints with a good numerical accuracy , whereas in the augmented lagrangian method a large number of iterations was necessary for the constraints to be satisfied with an acceptable numerical accuracy .",
    "this substantial gain is however counterbalanced by the computation of @xmath960 , which requires solving of a linear equation at every time @xmath94 $ ] along the curve ( indeed , recall that @xmath754 ) .",
    "the difficulty here is not just that this step is time - consuming , but rather the fact that the linear system may be ill - conditioned , which indicates that this step may require a more careful treatment .",
    "one possible way to overcome this difficulty is to solve this system with methods inspired from quasi - newton algorithms .",
    "this requires however a particular study that is beyond the scope of the present article ( see @xcite for results and algorithms ) .",
    "in this first example we consider a very simple constraint , namely , a constant total volume .",
    "consider @xmath961 , the unit sphere in @xmath0 , and let @xmath135 be the shape space , acted upon with order @xmath962 by @xmath963 .",
    "consider as in @xcite the rkhs @xmath1 of smooth vector fields given by the gaussian kernel @xmath117 with positive scale @xmath964 defined by @xmath965 .",
    "an embedding @xmath28 of the sphere is the boundary of an open subset @xmath966 with total volume given by @xmath967 , where @xmath968 is a @xmath969-form such that @xmath970 .",
    "let @xmath219 be an initial point and let @xmath445 be a target such that @xmath971 .",
    "we impose as a constraint to the deformation @xmath239 to be of constant total volume , that is , @xmath972 .",
    "the data attachment function is defined by @xmath973 , with @xmath5 a distance between submanifolds ( see @xcite for examples of such distances ) .    for the numerical implementation ,",
    "we take @xmath974 ( thus @xmath975 ) and @xmath25 is a space of curves , which is discretized as landmarks @xmath976 .",
    "the volume of a curve is approximately equal to the volume of the polygon @xmath977 with vertices @xmath978 , given by @xmath979 .",
    "if one does not take into account a constant volume constraint , a minimizing flow matching a circle on a translated circle usually tends to shrink it along the way ( see figure [ fig : compa_a ] ) .",
    "if the volume is required to remain constant then the circle looks more like it were translated towards the target , though the diffeomorphism itself does not look like a translation ( see figure [ fig : compa_b ] ) .",
    "the implementation of the shooting method developed in section [ matchconst ] leads to the diffeomorphism represented on figure [ fig : cv ] .",
    "we consider the multishape problem described in section [ mlmk ] .",
    "we define the shape spaces @xmath980 , by @xmath981 for every @xmath982 and @xmath983 ( background space ) . for every @xmath984",
    "we consider a reproducing kernel @xmath985 and a reduced operator @xmath986 for every @xmath987 .    in the following numerical simulations ,",
    "each @xmath988 is a curve in @xmath2 , so that @xmath989 , the unit circle .",
    "the function @xmath251 appearing in the functional is defined by @xmath990 where @xmath991 and @xmath992 are given target curves .",
    "the distance @xmath5 is a distance between curves ( see @xcite for examples of such distances ) .",
    "we consider two types of compatibility constraints between homologous curves @xmath988 and @xmath993 : either the identity ( or stitched ) constraint @xmath994 , or the identity up to reparametrization ( or sliding ) constraint @xmath995 for some ( time - dependent ) diffeomorphism @xmath877 of @xmath499 .",
    "note that , since the curves have the same initial condition , the latter constraint is equivalent to imposing that @xmath996 is tangent to @xmath993 , which can also be written as @xmath997 where @xmath998 and @xmath999 is normal to @xmath993 . in the numerical implementation",
    ", the curves are discretized into polygonal lines , and the discretization of the control system and of the minimization functional is done by reduction to landmark space , as described in section [ approx ] .",
    "the discretization of the constraint in the identity case is straightforward .",
    "for the identity up to reparametrization ( or sliding ) constraint , the discretization is slightly more complicated and can be done in two ways .",
    "a first way is to add a new state variable @xmath999 which evolves while remaining normal to @xmath993 , according to @xmath1000 which can be written as a function of the control @xmath1001 and of the derivatives of @xmath1002 ( this is an example of lifted state space , as discussed in section [ mlmk ] ) .",
    "a second way , which is computationally simpler and that we use in our experiments , avoids introducing a new state variable and uses finite - difference approximations . for every @xmath1003 , and every line segment @xmath1004 $ ] in @xmath1005 ( represented as a polygonal line )",
    ", we simply use the constraint @xmath1006 , where @xmath1007 is the unit vector perpendicular of @xmath1008 and @xmath1009 .",
    "note that the vertices @xmath1010 and @xmath1011 are already part of the state variables that are obtained after discretizing the background boundaries @xmath1012 .        with these choices , the discretized functional and its associated gradient for the augmented lagrangian method",
    "are obtained with a rather straightforward  albeit lengthy  computation . in figure",
    "[ fig : multishape.1 ] , we provide an example comparing the two constraints . in this example , we take @xmath1013 and use the same radial kernel @xmath1014 for the two shapes , letting @xmath1015 , with @xmath1016 the background kernel is @xmath1017 , with @xmath1018 and @xmath1019 .",
    "the desired transformation , as depicted in figure [ fig : multishape.1 ] , moves a curve with elliptical shape upwards , and a flower - shaped curve downwards , each curve being , in addition , subject to a small deformation .",
    "the compared curves have a diameter of order 1 .    the solutions obtained using the stitched and sliding constraints are provided in figures [ fig : multishape.2_a ] and [ fig : multishape.2_b ] , in which we have also drawn a deformed grid representing the diffeomorphisms induced by the vector fields @xmath1020 , @xmath1021 and @xmath1022 in their relevant regions .",
    "the consequence of the difference between the kernel widths inside and outside the curves on the regularity of the deformation is obvious in both experiments .",
    "one can also note differences in the deformation inside between the stitched and sliding cases , the second case being more regular thanks to the relaxed continuity constraints at the boundaries .",
    "finally , we mention the fact that the numerical method that we illustrate here can be easily generalized to triangulated surfaces instead of polygonal lines .",
    "the purpose of this paper was to develop a very general framework for the analysis of shape deformations , along with practical methods to find an optimal deformation in that framework .",
    "the point of view of control theory gives powerful tools to attain this goal .",
    "this allows in particular for the treatment of constrained deformation , which had not been done before .    now that a concrete setting has been fixed , many new developments can be expected .",
    "first of all , the minimization algorithms in the case of constrained shapes are quite slow for a very high number of constraints .",
    "moreover , we did not study any of the geometric aspects of shape deformation spaces .",
    "for example , we only briefly mentioned the infinite - dimensional sub - riemannian structure that the rkhs induces on both groups of diffeomorphism and shape spaces .",
    "sub - riemannian geometry in infinite dimension and codimension is still a very open subject with very few results .",
    "the sub - riemannian geometry in this paper is particularly difficult and interesting to study because the horizontal spaces may not be closed in the ambient space .",
    "a key difference with finite dimension is that some geodesics might exist that are neither normal nor abnormal .",
    "more general control problems can be designed .",
    "one can , for example , use a second - order approach , with a control system taking the form @xmath1023 in which the original state is lifted to the cotangent space ( @xmath1024 ) , and the new control is @xmath929 .",
    "these models have been introduced for shapes in @xcite , with @xmath1025 , providing a way to interpolate smoothly between multiple shapes .",
    "we are currently exploring applications of this approach to model muscle - like motions , with external forces constrained to being collinear to the fibers .",
    "another glaring issue comes from the assumption of the surjectivity of the constraints in theorem [ pmp ] .",
    "indeed , in most practical cases , such as multishapes in section [ mlmk ] , this assumption fails . in finite dimension",
    ", problems can occur when the rank of @xmath353 changes with @xmath134 .",
    "they are usually solved by taking higher - order derivatives of @xmath353 on the sets on which it is not maximal .",
    "this does not seem easily possible with banach spaces .",
    "another problem comes from the incompatibility of topologies between the hilbert space @xmath1 and the banach space @xmath26 in which the constraints are valued : @xmath353 may not have a closed range , in which case we could find `` missing '' lagrange multipliers .",
    "if @xmath1026 were constant , this could be solved simply by restricting @xmath26 to @xmath1026 equipped with the hilbert topology induced by @xmath353 and @xmath1 , but since it is not constant , this might be impossible .",
    "it would be very interesting , both for control theory in general and for shape deformation analysis in particular , to find a way to address this problem .",
    "b. bonnard , l. faubourg , e. trlat , _ mcanique cleste et contrle des vhicules spatiaux ( french ) [ celestial mechanics and the control of space vehicles ] _ , math .",
    "( berlin ) , 51 , springer - verlag , berlin , 2006 .",
    "j. glauns , a. trouv , l. younes , _ diffeomorphic matching of distributions : a new approach for unlabelled point - sets and sub - manifolds matching _ , in cvpr ( 2004 ) , 712718 , los alamitos , ieee comput .",
    "j. glauns , a. trouv , l. younes , _ modeling planar shape variation via hamiltonian flows of curves _ , in : statistics and analysis of shapes , model .",
    "technol . , 335361 , birkhuser boston , 2006 .",
    "u. grenander , m.i .",
    "miller , _ computational anatomy : an emerging discipline _ , current and future challenges in the applications of mathematics ( providence , ri , 1997 ) , quart .",
    "appl . math .",
    "* 56 * ( 1998 ) , no .",
    "4 , 617694 .",
    "m. vaillant , j. glauns , _ surface matching via currents _ , in : information processing in medical imaging , 15 , springer berlin , heidelberg , 2005 , g. christensen and m. sonka ( eds ) , lecture notes in computer science , vol ."
  ],
  "abstract_text": [
    "<S> a crucial problem in shape deformation analysis is to determine a deformation of a given shape into another one , which is optimal for a certain cost . </S>",
    "<S> it has a number of applications in particular in medical imaging .    in this article </S>",
    "<S> we provide a new general approach to shape deformation analysis , within the framework of optimal control theory , in which a deformation is represented as the flow of diffeomorphisms generated by time - dependent vector fields . using reproducing kernel hilbert spaces of vector fields , </S>",
    "<S> the general shape deformation analysis problem is specified as an infinite - dimensional optimal control problem with state and control constraints . in this problem , </S>",
    "<S> the states are diffeomorphisms and the controls are vector fields , both of them being subject to some constraints . </S>",
    "<S> the functional to be minimized is the sum of a first term defined as geometric norm of the control ( kinetic energy of the deformation ) and of a data attachment term providing a geometric distance to the target shape .    </S>",
    "<S> this point of view has several advantages . </S>",
    "<S> first , it allows one to model general constrained shape analysis problems , which opens new issues in this field . </S>",
    "<S> second , using an extension of the pontryagin maximum principle , one can characterize the optimal solutions of the shape deformation problem in a very general way as the solutions of constrained geodesic equations . </S>",
    "<S> finally , recasting general algorithms of optimal control into shape analysis yields new efficient numerical methods in shape deformation analysis . </S>",
    "<S> overall , the optimal control point of view unifies and generalizes different theoretical and numerical approaches to shape deformation problems , and also allows us to design new approaches .    </S>",
    "<S> the optimal control problems that result from this construction are infinite dimensional and involve some constraints , and thus are nonstandard . in this article </S>",
    "<S> we also provide a rigorous and complete analysis of the infinite - dimensional shape space problem with constraints and of its finite - dimensional approximations .    </S>",
    "<S> * keywords : * shape deformation analysis , optimal control , reproducing kernel hilbert spaces , pontryagin maximum principle , geodesic equations .    * </S>",
    "<S> ams classification : * 58e99 49q10 46e22 49j15 62h35 53c22 58d05 </S>"
  ]
}