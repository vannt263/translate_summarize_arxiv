{
  "article_text": [
    "although quantum theory has been in existence for about a century , until recently , the main emphasis in the field was on constructing hamiltonian models and solving the schrodinger equation .",
    "although it was recognized that external fields and potentials could change the hamiltonian and thus the dynamics of a system , and such external fields were certainly used in many areas from nuclear magnetic resonance to atomic physics to effect changes to the system , it was only rather recently that the full potential of using such external fields was recognized . since then the subject of control of quantum systems has developed from a niche area into a subject of rapidly growing interest and importance , with an ever increasing number of applications ranging from quantum chemistry to quantum information processing ( see e.g.  @xcite ) .",
    "quantum control has been applied , for instance , to influence the outcome of chemical reactions  @xcite , to prepare entangled states  @xcite , which are a resource in quantum metrology and information processing , and to realize quantum gates  @xcite , which are fundamental building blocks for a quantum computer .",
    "the scope of the applications is vast .    as the potential and importance of quantum control was realized , attempts were made to formulate quantum control problems abstractly , and establish solid mathematical foundations .",
    "some pioneering attempts were necessarily imperfect and the theory is still under development , but there have been a number of interesting theoretical results .",
    "one important area is the control landscape  @xcite . while it is not too difficult in many cases to formulate a particular task in terms of a control optimization problem , i.e. , of finding an admissible control that maximizes a performance index , solving the resulting control optimization problems is challenging , especially for large or complicated systems , and in almost all cases they",
    "can only be solved computationally using numerical optimization strategies .",
    "since the evaluation of the performance index for quantum control problems generally requires the solution of an operator or partial differential equation , evaluation of the latter becomes computationally demanding and efficient algorithms are therefore crucial .",
    "such algorithms exist for finding local extrema , especially when gradients can be computed relatively cheaply compared to the computational overhead involved in evaluating the performance index , as can be achieved in our case .",
    "we are however primarily interested in global optima of that function , and this is where the `` landscape '' defined by the objective function becomes relevant .",
    "if the landscape is littered with many suboptimal , locally attractive critical points then optimization strategies designed to find local extrema have a very low probability of finding a global optimum from a generic starting point . in such a situation global search strategies are usually required , involving substantially greater computational overheads .",
    "if the landscape is nice , however , i.e. , if most local extrema are actually global extrema , then algorithms that find local extrema are likely to succeed in finding a global optimum and the computational overhead of global search algorithms can be avoided .",
    "the landscape for quantum control problems was initially expected to be complicated , but it was quickly realized that optimization algorithms designed to find local extrema were often very successful at finding controls for which the performance index to be optimized took values very close to its _ global _ optimum .",
    "this has led a number of researchers to study the issue and put forward certain arguments why this should be the case .",
    "the core argument was that , contrary to expectations , the landscape for quantum control was actually extremely simple and devoid of any traps , i.e. , suboptimal locally attractive critical points .",
    "the main objective of this paper is to revisit this topic , taking a closer look at the control landscape .",
    "previous studies @xcite have almost all yielded results that only apply to regular critical points , in particular showing that these can _ not _ be traps for typical quantum control problems .",
    "however , it is well - known in the broader field of optimal control that these are not the only critical points  @xcite , and that the role of such non - regular critical points requires analysis  @xcite . for quantum control problems the existence of non - regular critical points",
    "has only recently been acknowledged  @xcite but their properties have not been studied .",
    "in particular , it is not known if such critical points can be traps .",
    "the existence of such traps would complicate the control landscape and invalidate some general results arrived at by considering only regular points .",
    "the main objective of this paper is to show that non - regular critical points do exist for a large class of quantum control systems and that at least some of these are _ suboptimal extrema _ for which the performance index can take many values .",
    "the particular examples we construct to rigorously prove this claim are quite artificial , but they prove that such bad points _ do _ exist . for problems of practical interest",
    "it is generally extremely difficult to rigorously prove that a critical point is a trap as these problems can only be solved numerically .",
    "however , we present numerical evidence that suggests trapping behavior does occur for practical quantum optimal control problems even if such behavior appears to be relatively rare , at least for the simple systems that have been studied extensively to date .",
    "this suggests that further analysis is required to fully characterize the control landscape , including the nature of potential traps and their practical relevance , e.g. , for the design of efficient algorithms .",
    "the paper is organized as follows . in sec .",
    "ii , we formally define the problem and give the mathematical prerequisites . in section iii , we take a closer look at the landscape for pure - state transfer problems . in sec .",
    "iv we consider the landscape for unitary operator optimization problems . finally , in sec .",
    "v , we present the results of a numerical investigation of the control landscape for a three - qubit gate optimization problem , before concluding with a brief discussion in sec .",
    "the focus of this paper is quantum systems subject to hamiltonian evolution governed by the schrodinger equation .",
    "although the latter generally applies to states evolving over an infinite - dimensional hilbert space , we restrict our attention to finite - dimensional systems .",
    "this is the usual context for work on control of quantum systems and motivated by the fact that in practice one is usually either dealing with a system that intrinsically has a finite number of degrees of freedom such as a collection of spins , or for which the hilbert space can be faithfully truncated , and the controlled dynamics is restricted to finite - dimensional subspace of interest . assuming this hilbert space has dimension @xmath3 , the evolution of the system can be described by a unitary operator @xmath4 satisfying the schrodinger equation @xmath5 where @xmath6 is the identity matrix in @xmath2 and @xmath7 is the hamiltonian of the system , which in our case will be control - dependent , as will be indicated by the subscript @xmath8 . for simplicity",
    "the control dependence will be assumed to be linear in the ( real - valued ) controls @xmath9 , @xmath10 where @xmath11 is the system s intrinsic hamiltonian and @xmath12 are control interaction hamiltonians . in the following we set @xmath13 unless otherwise stated ,",
    "choose units such that @xmath14 , and define the two - point propagator @xmath15 .",
    "most typical control problems for ( hamiltonian ) quantum systems fall in one of the following three categories : pure - state transfer , observable control and unitary operator implementation .",
    "the pure - state transfer problem consists of preparing the system in a desired state @xmath16 , usually at a given time @xmath17 , assuming it is initialized to some state @xmath18 at time @xmath19 .",
    "a natural measure of success in achieving this goal is the transfer probability @xmath20 where in our case @xmath21 and @xmath22 is a solution of  ( [ eq : seu ] ) . for a given hamiltonian , initial and target states , and fixed target time @xmath17",
    ", the transfer probability depends only on the choice of control @xmath8 , i.e. , if the controls vary over @xmath0 then @xmath23 . the observable control problem lies in taking a system characterized by an initial density operator @xmath24 at time @xmath19 to a state @xmath25 at time @xmath17 for which the selected observable @xmath26 attains its maximal possible value , i.e. , we aim to maximize the expectation value @xmath27,\\ ] ] where @xmath28 and @xmath22 is again a solution of  ( [ eq : seu ] ) .",
    "the gate synthesis control problem consists in choreographing the system dynamics to implement the unitary gate @xmath29 over the time interval @xmath30 $ ] .",
    "using the hilbert - schmidt ( frobenius ) norm to measure distance from the target gate @xmath29 , this leads to the gate fidelity @xmath31\\ ] ] as a natural performance index , where @xmath22 is a solution of  ( [ eq : seu ] ) as before .    broadly speaking ,",
    "the objective of quantum control is to find a control @xmath8 to maximize one of these performance indices , where @xmath8 is allowed to vary over a large function space , while @xmath17 is fixed unless stated otherwise . in practical implementations of optimization algorithms for these problems , @xmath8",
    "will always be restricted to a finite - dimensional subspace , but this subspace may be arbitrarily large , and we will be chiefly interested in the ideal case where @xmath8 varies over @xmath0 in this paper , except in sec .",
    "so in general , we wish to find the ( global ) maximum of a ( non - linear ) functional @xmath32 , which in our case is either @xmath33 , @xmath34 , or @xmath35",
    ". it will often be fruitful to think of @xmath36 as a composition of the solution functional @xmath37 taking a control field @xmath8 to the corresponding propagator at time @xmath17 , @xmath38 , via  ( [ eq : seu ] ) , and the fidelity on the lie group @xmath39 , and we shall use @xmath40 , \\quad   \\g_v(u)= \\frac{1}{n}\\re\\tr[v^\\dag u],\\ ] ] respectively , to denote the equivalents of @xmath33 , @xmath34 and @xmath35 above .",
    "whether we allow the fields @xmath41 to range over the whole of @xmath0 or a smaller space such as the continuous or piecewise constant functions , we must consider whether the aforementioned control problems are feasible , i.e. , whether the maximum of the performance index is actually attainable , or the question of controllability .",
    "more specifically , we are interested in whether for a given system @xmath7 , and all endpoint conditions  either @xmath42 , @xmath43 or @xmath44 , there exists a time @xmath17 and an ( admissible ) control @xmath45 that solves the corresponding control problem . in general , for bilinear control systems on a lie group , as in our case , this problem reduces to one about the lie algebra @xmath46 generated by the matrices @xmath47 . for pure - state control problems controllability",
    "is equivalent to @xmath46 being a representation of either @xmath48 , @xmath49 , @xmath50 or @xmath51 . for mixed - state ( density - operator ) control problems ,",
    "we require @xmath50 or @xmath51 , while the system is fully unitary operator controllable only when @xmath52  @xcite .",
    "note that the distinction between @xmath50 and @xmath51 is artificial in the quantum case as the extra dimension contributes only a global phase , which is generally not physically observable .",
    "since it is convenient , and indeed common , to fix the final time @xmath17 when carrying out control optimization , we are also interested in the stronger notion of exact - time controllability , namely , whether a system has some critical time @xmath53 such that all endpoint conditions give solvable control problems for any @xmath54 .",
    "it turns out that , neglecting global phase , these notions of controllability are equivalent to the previous three by theorem 13 of @xcite .    apart from these now standard results",
    ", we will need the following .",
    "let @xmath55 be a control system , @xmath52 or @xmath50 and @xmath56 or @xmath57 be associated lie group .",
    "* if the set of all commutator expressions in @xmath58 and @xmath59 joined with @xmath58 and @xmath59 span @xmath46 ( lie algebra rank condition ) , then there exists a maximal time @xmath60 and neighborhood @xmath61 of @xmath62 in @xmath63 such that for all systems @xmath64 and elements @xmath65 , there is a control taking @xmath66 to @xmath67 in time @xmath68 . *",
    "if the set of all commutator expressions in @xmath58 and @xmath59 joined with @xmath69 span @xmath46 ( exact - time lie algebra rank condition  . ] ) , then there is a critical time @xmath53 and neighborhood @xmath61 of @xmath70 such that for all @xmath64 , @xmath65 and @xmath54 , there is a control taking @xmath66 to @xmath67 in time @xmath17 .    assuming that our system specified by @xmath62 satisfies the lie algebra rank condition , by theorem 1 of @xcite there is a set of values @xmath71 such that the function @xmath72 has jacobian @xmath73 of full rank at some point @xmath74 .",
    "this implies that the extended function @xmath75 also has jacobian @xmath76 of full rank at the point @xmath77 .",
    "thus by the inverse function theorem , choosing neighborhoods @xmath61 of @xmath62 and @xmath29 of @xmath74 bounded , there is a neighborhood @xmath78 of @xmath79 such that @xmath80 includes @xmath81 for every @xmath82 . by compactness ( and connectedness ) , some power @xmath83 covers the entire group @xmath84 . letting @xmath17",
    "be the supremum of @xmath85 over @xmath29 , we see that for all systems in @xmath61 the entire group is reachable in less than time @xmath86 .",
    "assuming @xmath62 satisfies the exact - time lie algebra rank condition , the same argument may be repeated with @xmath87 as constructed in the proof of theorem 3 in @xcite , where now @xmath88 has domain restricted to @xmath89 .",
    "this alteration shows that the critical time @xmath53 of exact - time controllability can indeed be chosen uniformly about @xmath62 , as claimed .",
    "finding the global optimum of a function is generally a very difficult task . on the other hand ,",
    "there are many efficient algorithms to find local extrema , i.e. , attractive critical points of a function .",
    "for this reason we are particularly interested in the nature of the critical points of the various functionals @xmath36 , which depends only on certain local properties of the solution functional @xmath90 .",
    "to study the latter , we need the identity @xmath91u_{f+{\\delta}f}(\\tau)\\,\\dd\\tau\\ ] ] which can be verified by differentiating both sides , and used to derive @xmath92 where @xmath93 is just @xmath94 in the @xmath13 case . for @xmath95",
    "we define the linear map @xmath96 corresponding to the gradient of @xmath22 at @xmath8 , and the bilinear map @xmath97\\dd\\sigma\\dd\\tau\\ ] ] corresponding to its hessian . indeed , the second order perturbative expansion ( [ eq : pert ] ) is the functional analog of the taylor expansion of a function , with the gradient and hessian functionals corresponding to the first and second order terms , respectively .",
    "since the hessian is naturally a linear operator mapping @xmath0 to itself , it is convenient to have notation for referring directly to some such operators , along with the elements of @xmath98 themselves .",
    "we shall use @xmath99 to denote the unnormalized projection onto its argument , and @xmath100 as a placeholder for the argument of the anonymous function it is a constituent of .",
    "for example , @xmath101 $ ] refers to the projector onto the function @xmath102 , that is , the operator that maps each vector @xmath103 to the vector @xmath104 in @xmath0 .",
    "the importance of the gradient and the hessian functionals is that the former determines the critical points of the functional @xmath36 , and the latter their nature . in particular ,",
    "if the hessian at a critical point @xmath8 is negative definite , then the critical point is attractive and corresponds to a local maximum over any finite - dimensional subspace of @xmath0 ; similarly , if it is positive definite , the critical point is repulsive and corresponds to a local minimum over any finite - dimensional subspace , and if the hessian at the critical point can take both positive and negative values , the critical point is a saddle .",
    "as mentioned in the introduction the problem of finding a control @xmath105 to maximize the pure - state fidelity functional  ( [ eq : fp ] ) can be viewed a composition of finding a @xmath106 or @xmath57 that maximizes @xmath33 , and an optimization problem of finding a control in @xmath0 that realizes @xmath107 . defining @xmath108 and @xmath109",
    ", we have @xmath110 $ ] , i.e. , we can rewrite the pure - state optimization problem as a general observable optimization problem .",
    "it is easy to show that a necessary and sufficient condition for @xmath111 or @xmath57 to be a critical point of @xmath112 $ ] is that @xmath26 and @xmath113 commute , i.e. , @xmath114=0 $ ] . in our case , as @xmath26 and @xmath24 ( and thus @xmath113 ) are projectors onto pure states , there are only two types of critical points : ( i ) @xmath26 and @xmath113 are projectors onto orthogonal subspaces of @xmath115 , in which case we have @xmath116=0 $ ] , and ( ii ) @xmath26 and @xmath113 are projectors onto the same 1d subspace of @xmath115 , in which case we have @xmath116=1 $ ] .",
    "thus , the landscape for pure - state optimization over @xmath2 or @xmath57 is very simple : there are only two types of critical points , corresponding to extremal values of the fidelity , i.e. , global extrema , and no saddles or other critical points for which the fidelity assumes values in @xmath1 .",
    "the critical points over @xmath57 or @xmath2 are sometimes referred to as _ kinematic _",
    "critical points  @xcite .",
    "since then several papers have attempted to show that this result extends to the actual optimization problem over @xmath0 , i.e. , that the fidelity @xmath33 as a functional over @xmath0 only has critical points for which it achieves either its global minimum @xmath19 or maximum @xmath117 . however , the arguments put forward in @xcite and @xcite rely , without rigourous justification , on the property that the solution functional @xmath118 is of full rank _",
    "everywhere_. @xcite gives another proof but relies on the same problematic assumption .",
    "@xcite argues that a certain sequence of expressions starting with equation ( 14 ) and ( 15 ) therein generate the full lie algebra generated by @xmath119 and @xmath69 , and hence , assuming controllability , span the entire lie algebra @xmath50 . but",
    "this procedure only allows one to generate specific linear combinations of commutators  , and , although it may seem plausible , these are not guaranteed to span @xmath50 . for the more general density matrix control problem , @xcite similarly assumes that the map @xmath118 is of full rank everywhere to derive that the final state @xmath120 must commute with the observable @xmath26 at critical points , and hence that @xmath19 and @xmath117 are the only critical values for pure states .",
    "@xcite makes use of the same problematic assumption , referring to @xcite as evidence of its validity , to re - derive this critical point characterization , along with the result that all but the global maxima and minima are saddle points .",
    "@xcite recognises the possibility of singular controls @xmath8 , here of @xmath121 not being full rank for a particular control @xmath8 , along with the issues this raises , yet defers analysis of such points to future work .",
    "@xcite finally gives a characterization of singular controls and acknowledges that these can be critical points of the performance index that do not correspond to kinematical critical points , but considers only one example involving eigenstates of a four - level system , to conclude based on numerical simulations that singular controls do not appear to be traps for this problem .",
    "therefore , the question of the existence of non - kinematic critical points for the pure - state fidelity  ( [ eq : fp ] ) , i.e. , critical points @xmath122 for which @xmath33 does not assume extremal values , remains open .",
    "we now show that such critical points do exist for all control - linear hamiltonian systems , and while most of them can not be expected to be attractive , one can construct examples where calculation of the hessian at such a non - kinematic critical point shows it to be strictly negative definite .",
    "thus , not only do non - kinematic critical points exist but they can be attractive , i.e. , traps .",
    "hessian calculations also show that the hessian need not have finite rank at such critical points .",
    "the main implication of these examples is that landscape analysis based on considering regular points only is incomplete , and that in some cases at least , traps definitively do exist .",
    "they may be generally rare but even a single trapping point can be problematic if it has a large domain of attraction . it should be noted here that the mere existence of singular controls implies that the end - point map @xmath121 can not be full rank everywhere , and thus that the hypothesis on which most of the landscape results cited above are predicated , can not be satisfied in general , so that further analysis is necessary . but this still leaves open the question whether the results are true in the absence of this hypothesis , and the significance of exhibiting examples for which traps provably exist is to show that the landscape is not universally trap - free .",
    "let us start by considering , for any choice of final time @xmath17 , a pure state control problem for a two - level system of the general form :    [ genpure ] @xmath123 e^{i t h_0 } & , \\quad      \\ket{\\psi_0 } = \\frac{1}{\\sqrt{2 } }      [ e^{i \\theta } , e^{- i \\left ( \\theta + \\varphi \\right)}]^{t } , \\end{aligned}\\ ] ]    where we can exclude the degenerate case @xmath124 by choosing @xmath125 . for the field",
    "@xmath126 which is identically zero over @xmath30 $ ] , we can calculate @xmath127 , so that the fidelity @xmath33 is @xmath128 .",
    "moreover , @xmath126 is a critical point since the general gradient formula @xmath129 in this case evaluates to @xmath130 a value of @xmath131 can be chosen to achieve any fidelity in the interval @xmath1 , and this can be done avoiding the degenerate case by choosing the right sign for @xmath131 when necessary .",
    "so we already see there is a large family of control problems admitting critical points for which the fidelity assumes any possible value but this is simply a special case of the more general fact that follows .",
    "[ thm:1 ] given any bilinear control system with control hamiltonian @xmath132 , any target time @xmath133 , and any @xmath134 , there exist pairs of initial and target states @xmath135 and a control @xmath8 such that @xmath8 is a critical point of the fidelity @xmath33 with critical value @xmath136 .",
    "any bilinear control system @xmath137 with @xmath138 is equivalent to one with hamiltonians @xmath139 and control @xmath140 .",
    "case 1 : suppose there is a value of @xmath141 such that @xmath142 has degenerate eigenvalues .",
    "choose a two - dimensional subspace @xmath143 of this eigenspace .",
    "then , restricted to the subspace @xmath143 the hamiltonians take the form @xmath144 it easy to see that @xmath145 is a critical point with fidelity @xmath146 for any @xmath17 for the state transfer problem @xmath147 on @xmath143 with @xmath148 , \\quad \\ket{\\psi_0 } =      [ \\cos ( \\varphi ) , \\sin ( \\varphi ) e^{i \\gamma } ] ^{t}\\ ] ] if the hamiltonians restricted to @xmath143 take the form  ( [ unconpure ] ) . since @xmath143 is an invariant space of @xmath149 , if the initial and final states are in @xmath143 , the formulas for the fidelity and gradient simplify to their analogues restricted to @xmath143 .",
    "therefore , @xmath150 is a critical point for the state transfer problem @xmath147 for the original system if we embed the initial and target state into the full hilbert space @xmath115 in the obvious manner .",
    "case 2 : if the eigenvalues of @xmath151 are always distinct then we can continuously parametrize the ( unique ) eigenvectors @xmath152 and @xmath153 corresponding to the maximal and minimal eigenvalues of @xmath154 , respectively .",
    "letting @xmath155 , @xmath156 be the maximal and minimal eigenvalues of @xmath157 , we have the identities @xmath158 hence by continuity we must have @xmath159 for some ( finite ) @xmath160 , unless @xmath161 , which would mean that @xmath157 is a multiple of the identity and so any value of @xmath160 would do . using",
    "this @xmath160 leads to an effective system @xmath162 which , when restricted to the subspace @xmath143 spanned by @xmath163 , and expressed in this basis , is precisely of the form ( [ genpure ] ) .",
    "again we can extend the initial and target states in ( [ genpure ] ) to the full hilbert space in a trivial way so that @xmath145 is a critical point with fidelity @xmath164 for the resulting state transfer problem with the hamiltonian @xmath165 .",
    "restriction to @xmath143 is again a well - behaved procedure since the span of each eigenvector is invariant under the time evolution generated by the corresponding hamiltonian @xmath142 .",
    "this theorem shows that for any control system , in particular any controllable one , there exist pairs of initial and target states for which we can achieve critical values of the fidelity in @xmath1 .",
    "however , the initial and target states which exhibit such critical points in the proof above will not in general be eigenstates of @xmath11 .",
    "one might wonder whether critical points for which the fidelity does not achieve extremal values might be impossible if the initial and target states are restricted to eigenstates of the system hamiltonian @xmath11 , as is the case in many applications , but even in this case we can find counterexamples .    * non - extremal critical points for eigenstate transfer problem . *",
    "consider the system @xmath166 with @xmath167 and the initial and target states @xmath168^\\t$ ] , @xmath169^\\t$ ] .",
    "@xmath33 for this system has a critical point at @xmath170 as @xmath171\\equiv0 $ ] with @xmath172 , where @xmath17 is the target time .",
    "indeed , we can even verify that this system is controllable as @xmath11 has distinct transition frequencies and @xmath157 is connected .",
    "we can furthermore show that the critical points above , for which the fidelity does not assume extremal values , are not necessarily saddle points either .",
    "we show this for pure state examples but the problems can be reformulated as observable optimization problems with @xmath108 for a density matrix that is a projector onto the pure state @xmath173 .",
    "hence the examples also show the existence of non - kinematic critical points for which the observable fidelity @xmath174 $ ] assumes non - extremal values and which are not saddle points .    * critical saddle points with negative semi - definite hessian .",
    "* let @xmath175 with @xmath176 given any target time @xmath17 , choose the initial and target states @xmath177^\\t , \\quad    \\ket{\\psi_g}=[e^{i2t}\\cos\\theta,0,0,e^{i9t}\\sin\\theta]^\\t.\\end{aligned}\\ ] ] then @xmath178 is a critical point of the fidelity , since @xmath179 is diagonal so that @xmath180 , with critical value @xmath181 .",
    "the hessian of the fidelity at this point can be computed as @xmath182 \\left [ \\alpha ( \\tau ) \\beta ( \\sigma ) + \\beta ( \\tau ) \\alpha ( \\sigma ) \\right ] \\dd \\sigma \\dd \\tau\\end{gathered}\\ ] ] which just constitutes two instances of the @xmath183 operator from [ appendix ] and so can more clearly be written as @xmath184+\\pi[\\sin(2\\bullet)]\\big)\\quad\\\\        + \\sin\\theta\\sin\\phi \\big(\\pi[\\cos(4\\bullet)]+\\pi[\\sin(4\\bullet)]\\big)\\big].\\end{aligned}\\ ] ] this expression is clearly negative semi - definite whenever @xmath185 and @xmath186 are both positive , equivalently , when @xmath131 and @xmath187 lie in the interior of the same quadrant . in this circumstance",
    "we are exhibiting a point @xmath8 which to second order is not a saddle .",
    "for example , for @xmath188 and @xmath189 we obtain @xmath190 and hessian taking the form @xmath191+\\pi[\\sin(2\\bullet ) ] + \\pi[\\cos(4\\bullet ) ] + \\pi[\\sin(4\\bullet)]\\big]$ ] . + by extending ( [ eq : pert ] ) , we can compute the third order derivative of @xmath33 in this case to be @xmath192   \\delta f ( \\rho ) \\delta f ( \\sigma ) \\delta f ( \\tau )   \\dd \\rho \\dd \\sigma \\dd \\tau\\end{gathered}\\ ] ] in direction @xmath193 . when @xmath194 , the first and second order derivatives of @xmath33 in direction @xmath195 vanish , with the third order one being @xmath196 .",
    "the condition already imposed on @xmath131 and @xmath187 implies that @xmath197 , hence , unless @xmath198 thus @xmath199 , one of @xmath200 is a direction of increase , showing that @xmath8 is nonetheless a saddle point .",
    "this example shows that we can not rule out the existence of traps by just looking at the gradient and hessian .",
    "in fact , we can construct examples for which we have attractive critical points with fidelity in @xmath1 , i.e. , traps .",
    "* non - extremal critical points with negative definite hessian ( traps ) . *",
    "consider the system @xmath175 with @xmath201 taking the target time to be @xmath202 , choose the initial and target states @xmath203^\\t , \\quad    \\ket{\\psi_g } = \\frac{1}{\\sqrt{2}}[e^{-it(1+\\eps)},0,0,e^{-i2t}]^\\t.\\end{aligned}\\ ] ] for @xmath178 it is easy to verify that the gradient vanishes identically as before , so this is a critical point , with fidelity @xmath204 .",
    "the hessian is @xmath205-    \\!\\!\\!\\!\\!\\!\\underset{0<\\sigma<\\tau<\\frac{\\pi}{\\eps}}{\\int\\!\\!\\int}\\!\\!\\!\\!\\!\\ !",
    "\\cos\\theta [ \\cos\\theta \\cos(\\eps(\\tau-\\sigma ) ) -\\sin\\theta\\sin(\\eps(\\tau-\\sigma ) ) ]   [ \\alpha(\\sigma)\\beta(\\tau)+\\beta(\\sigma)\\alpha(\\tau ) ] \\dd \\sigma \\dd \\tau\\end{aligned}\\ ] ] with @xmath206 , which , using [ appendix ] , can be rewritten as @xmath207 + \\sum_{k=1}^\\infty a_k    \\big ( \\pi[\\sin(2k\\eps\\bullet)]+\\pi[\\cos(2k\\eps\\bullet ) ] \\big )     -\\cos^2\\theta \\big ( \\pi[\\sin(\\eps\\bullet)]+\\pi[\\cos(\\eps\\bullet ) ] \\big )   \\end{aligned}\\ ] ] with the coefficients given by @xmath208 and @xmath209 for @xmath210",
    ". as @xmath211 is always negative , the hessian will be strictly negative definite if @xmath212 for all @xmath213 , which is equivalent to @xmath214 . with @xmath215 , for instance , this double inequality is satisfied for all @xmath216 $ ] , and this range of @xmath131 yields fidelities @xmath217 .",
    "therefore , for all of these values of @xmath131 , the critical point @xmath178 corresponds to a local maximum , at least over any finite dimensional subspace , with @xmath218 . note that this example also shows that the hessian at a ( non - kinematical ) critical point need not have finite rank .    by computing the rank of the relevant lie algebra",
    ", we can verify that @xmath219 specifies an ( exact - time ) controllable system at @xmath220 , so that our uniform controllability result applies .",
    "time-@xmath17 controllability can therefore be ensured by choosing a sufficiently small @xmath221 , which both makes @xmath219 lie in the neighborhood of uniform controllability and @xmath202 be larger than the minimal time required for controllability .",
    "theorem  [ thm:1 ] and the previous examples relied on constant controls to show that critical points with non - extremal values of the fidelity exist for all systems with @xmath175 , i.e. , any choice of @xmath11 and @xmath157 , and that such critical points need not be saddle points but can in fact be traps .",
    "it is also interesting to consider how the critical point condition @xmath222 could be satisfied for a given system for non - constant controls @xmath223 .",
    "let @xmath224 , then the critical point condition reads @xmath225 where @xmath226 must satisfy the schrodinger equation  ( [ eq : seu ] ) , i.e. , we have a differential - algebraic equation system .",
    "note that since @xmath22 is of course not known in advance , we set @xmath227 for some @xmath228 and then @xmath229 , a posteriori . while the existence and uniqueness of solutions to such systems is in general not trivial to ascertain , differentiating the constraint and using the schrodinger equation leads to a more explicit form    @xmath230\\ket{\\psi_0 } \\\\    0 & \\equiv \\im \\bra{\\psi_b } u_f(t)^\\dag [ h_0+f(t)h_1,[h_0,h_1 ] ] u_f(t ) \\ket{\\psi_0}.\\end{aligned}\\ ] ]    assuming the first two equations hold , which can be thought of as a two ( real ) dimensional constraint on @xmath231 , the system can be solved , at least locally about @xmath232 , by adjoining the constraint @xmath233 u_f(t ) \\ket{\\psi_0 } }          { \\im \\bra{\\psi_b } u_f(t)^\\dag [ h_1,[h_0,h_1 ] ] u_f(t ) \\ket{\\psi_0}}\\ ] ] to the schrodinger equation , under the generically true condition that the denominator does not vanish at @xmath232 .",
    "the additional , also generic , property that @xmath234 guarantees that the critical point @xmath8 in question is not a constant function . as the fidelity @xmath33 for the control @xmath8 is @xmath235 we can construct critical points for which the fidelity does not take extremal values .",
    "( [ eq : nonkin ] ) can be solved numerically to find non - constant non - kinematic critical points for which the fidelity assumes any desired value , as has been done for a four - level system in @xcite .",
    "while some of these critical points may be non - attractive , as appeared to be the case for the example studied in @xcite there is no particular reason why _ all _ such critical points should be non - attractive in general .",
    "unfortunately , it is difficult to prove this , however , due to the difficulty involved in calculating the hessian and proving it to be strictly negative definite given only a numerical solution of ( [ eq : nonkin ] ) .",
    "the set of critical points of the fidelity as a map from the unitary group @xmath2 to @xmath236 given by @xmath237 $ ] is equal to all @xmath238 for which @xmath239 $ ] vanishes for every anti - hermitian matrix @xmath240 .",
    "since the bilinear map @xmath241 is an inner product over complex matrices for which the hermitian and anti - hermitian matrices constitute orthogonal subspaces , the latter condition is equivalent to @xmath242 being hermitian .",
    "as @xmath78 is also unitary it must be of the form @xmath243 , where @xmath244 is a projector onto a subspace @xmath245 of @xmath246 , and @xmath247 the projector onto the orthogonal complement of @xmath245 . from this",
    "we see immediately that @xmath248 is equal to @xmath249 , where @xmath250 is the dimension of the subspace @xmath245 , and thus there are @xmath251 critical manifolds corresponding to critical values @xmath252 of @xmath253 for @xmath254 . moreover , the second derivative of @xmath241 is @xmath255 $ ] , where @xmath256 can be any negative semi - definite matrix .",
    "thus @xmath257 , corresponding to @xmath258 are global extrema , and all other possible @xmath78 have both positive and negative eigenvalues , so that @xmath259 $ ] can take any value , showing that all other critical points @xmath238 are saddle points .",
    "this characterization of the critical points on @xmath2 , which can be traced back to at least @xcite , provides the motivation for the claim in @xcite that the landscape for unitary operator optimization has critical points only at these values of the fidelity , and that all critical points @xmath238 , except @xmath257 , which correspond to the global maximum and minimum of @xmath253 , respectively , are saddle points . as in the pure - state transfer case , to conclude this for the optimization problem over @xmath0 from the observations about the critical points of @xmath241 as a functional on @xmath2 , it is implicitly assumed that the solution functional @xmath22 is regular , in the differential geometric sense of having a jacobian of full rank , everywhere over @xmath0 .",
    "@xcite includes the condition that variations of the controls can be used to generate any local variation of @xmath38 as part of the definition of controllability .",
    "as before , the full - rank - everywhere assumption is problematic as it can not be satisfied in general . indeed , for any constant control @xmath260 , the trajectory @xmath261 will be a linear combination of expressions @xmath262 , where @xmath263 are the eigenvalues of @xmath264 .",
    "the gradient of the solution operator at this point @xmath265 is therefore a linear combination of functions @xmath266 for @xmath267 , or equivalently of the real functions @xmath268 for @xmath269 , of which there are only @xmath270 .",
    "more generally the rank of the jacobian where all controls are constants @xmath271 is at most @xmath272 because , in the eigenbasis of @xmath273 , the diagonal elements of each @xmath274 are constant functions .",
    "the observation that constant controls are singular in the sense of not being full - rank has also been made recently in @xcite but without fully considering the implications for the validity of the landscape results .",
    "also , the application of results in @xcite as suggested in @xcite is problematic , as the former work , originating in sub - riemannian geometry requires a ( strictly ) positive definite running costs on the controls , which serves as a regularizing term and is not present in our case , and highly undesirable as it would prevent us from ever reaching the global maximum of the actual objective function . also properties generic over the infinite dimensional space of vector fields , such as the main results of @xcite or @xcite ,",
    "need not hold for any instance within the finite dimensional subset of right - invariant vector fields which we restrict attention to .",
    "thus , it is still not clear whether the fidelity @xmath35 over @xmath0 has critical points that do not satisfy the criteria above , and whether these can be attractive .",
    "before we study the fidelity over @xmath0 , it is useful to briefly consider the critical points of @xmath275 on the lie group in more detail , as there are some subtleties one should be aware of ; in particular when the system evolution is restricted to a subgroup of @xmath2 such as @xmath57 , attractive critical points may emerge even on the group and it may desirable to eliminate these by modifying the performance index .",
    "many problems in quantum control involve control hamiltonians @xmath157 that have zero trace , i.e. @xmath276 , in which case exact - time @xmath277 controllability can not hold .",
    "indeed , we always have @xmath278 = e^{- it / n \\tr [ h_0 ] } = e^{i \\phi}$ ] , regardless of the control @xmath279 , so the reachable set at time @xmath17 is restricted to matrices in @xmath280 times the fixed phase @xmath281 .",
    "hence , even assuming that the system is @xmath277 controllable and @xmath282 are chosen such that @xmath283 to make @xmath29 reachable , when considering the critical points of the fidelity on the group , we should really consider the critical points of @xmath284 $ ] as a functional over @xmath285 .",
    "the critical point condition is now that @xmath286 = 0 $ ] for all traceless @xmath287 , and thus that @xmath78 be equal to a hermitian matrix @xmath288 plus a multiple @xmath289 of the identity with @xmath290 real .",
    "both this and the unitary conditions are properties of the spectrum alone , so we have in general that , @xmath78 is a critical point of @xmath241 whenever its eigenvalues are @xmath291 and @xmath292 with multiplicities @xmath250 and @xmath293 , for some @xmath294 . finally ,",
    "the unit determinant condition on @xmath78 forces @xmath295 to equal @xmath296 times any @xmath297 root of unity .",
    "note that when @xmath298 , this set of points is larger than the set of critical points over @xmath277 which also happen to lie in @xmath280 .",
    "the second derivative of @xmath299 is again @xmath300 $ ] , but now with @xmath301 , and only the hermitian part @xmath288 of @xmath78 contributes in this expression , since @xmath256 is negative semi - definite .",
    "it is clear that if @xmath288 has eigenvalues of both signs , implying @xmath302 , then the corresponding critical point @xmath78 is a second order saddle .",
    "otherwise @xmath303 , and the critical point is a local maximum or minimum if @xmath288 is a positive or negative multiple of the identity , while in case @xmath304 , we can find curves @xmath305 for which @xmath241 does not vanish to third order in @xmath306 , so @xmath78 is a saddle point .",
    "this characterizes the attractive critical points of @xmath307 as those @xmath238 of the form @xmath308 for some @xmath309 root of unity @xmath310 having positive real part , and continuity of the solution operator @xmath311 then implies :    for any controllable system @xmath55 with @xmath312 , and any @xmath313 with @xmath314 , there exists an open subset @xmath315 of @xmath0 such that any monotonically increasing local optimization algorithm started with @xmath316 will never exceed a fidelity of @xmath88 .",
    "these results show that that for optimization of @xmath57 , there are traps , i.e. , attractive critical points of @xmath253 with @xmath318 , and this is relevant for optimization problems over @xmath0 with @xmath319=0 $ ] . as the attractive critical points differ only by a global phase factor @xmath320 from the target gate @xmath29 , however , and we usually do not care about the global phase of a gate , these traps are not really a problem in practice , provided the convergence condition of the algorithm is more sophisticated than checking if @xmath321 is less than a certain tolerance . however , if we do not care about the global phase of the gate @xmath29 , a better choice of the performance index to be optimized would be @xmath322 which is equivalent to optimization over the projective unitary group @xmath317 . to see why it is a better choice , note that the critical point condition for @xmath323 is @xmath324=0 $ ] for every @xmath325 with @xmath242 as before , and @xmath326 $ ] .",
    "this is satisfied only when @xmath327 for some real @xmath290 and hermitian @xmath288 with all eigenvalues of the same magnitude .",
    "the second derivative at these points is @xmath328 + 2|\\tr[w a]|^2 $ ] , the first term can only fail to ever be positive for any @xmath325 if @xmath288 is a non - negative multiple of the identity , or @xmath329 . in the first case , either @xmath330 or @xmath331 , which corresponds to @xmath323 attaining its minimal or maximal values respectively",
    "otherwise , @xmath288 has eigenvalues of opposite sign , so the second derivative s first term must vanish for every @xmath325 , and if its second term always vanishes then @xmath238 must have equal eigenvalues , thus maximizes @xmath323 .",
    "the previous section shows that suboptimal attractive critical points do arise for optimization of @xmath57 , and that this case is relevant for quantum control problems , but these can easily be eliminated by changing the performance index .",
    "we now turn our attention to the existence of sub - optimal attractive critical points for the actual optimization problem of interest , i.e. , the problem of maximizing the fidelity @xmath35 over @xmath0 .",
    "in particular we are interested in whether there are suboptimal attractive critical points , i.e. , points @xmath22 for which the gradient of @xmath35 vanishes , the hessian is negative definite , and @xmath332 for systems that are time-@xmath17 controllable .    * traps for unitary operation optimzation problem . *",
    "consider the control problem specified by : @xmath333 with @xmath202 , whose gradient at @xmath126 can be calculated as @xmath334 and whose hessian at the same @xmath126 expands to @xmath335+\\frac{1}{3 } x \\sum_{k=1}^{\\infty }    \\frac{4}{\\pi(4k^2 - 1)}\\big(\\pi[\\sin(2k\\eps\\bullet)]+\\pi[\\cos(2k\\eps\\bullet)]\\big)\\\\   + \\frac{1}{3 } y\\big(\\pi[\\cos(\\bullet)]+\\pi[\\sin(\\bullet)]\\big)-    \\frac{1}{3 } z\\big(\\pi[\\cos(\\eps\\bullet)]+\\pi[\\sin(\\eps\\bullet)]\\big)\\end{gathered}\\ ] ] where the constants @xmath336 are defined in ( [ egconsts ] ) below .",
    "this formula for the hessian again comes from applying the results of [ appendix ] to the original operator expression @xmath337     [ \\alpha(\\sigma)\\beta(\\tau)+\\alpha(\\tau)\\beta(\\sigma ) ] \\dd \\sigma \\dd \\tau\\end{gathered}\\ ] ] therefore , a sufficient set of conditions for this operator to be negative definite , thus the fidelity @xmath338 to have a local maximum over all finite dimensional subspaces at @xmath126 , are the constraints :    [ egconsts ] @xmath339    we are interested in whether these conditions , which are independent of @xmath221 , can be satisfied for some choice of the other parameters , while having @xmath219 satisfy the ( exact - time ) controllability lie algebra rank condition for @xmath220 , so that by our uniform controllability result a sufficiently small choice of @xmath221 would make this system exact - time controllable at @xmath17",
    ". indeed , several such choices of parameters exist , for example : in the @xmath340 case , @xmath341 , @xmath342 , @xmath343 , @xmath344 , @xmath345 with fidelity @xmath346 , or in the @xmath347 case , @xmath348 , @xmath349 , @xmath350 , @xmath351 , @xmath352 with a fidelity of @xmath353 .      in typical quantum control problems ,",
    "the target time @xmath17 is fixed , but @xmath17 can be allowed to vary . if the target time @xmath17 of control problems is not fixed in advance , and is consequently allowed to vary in the corresponding optimization formulation ,",
    "there is some ambiguity as to how proximity between control fields is to be measured when these lie in different spaces @xmath0 .",
    "we choose to resolve this difficulty by optimizing over hamiltonians of the form @xmath354 with @xmath17 fixed , since propagating @xmath355 up to time @xmath17 is equivalent to propagating @xmath356 up to time @xmath357 .",
    "the expressions for the gradient  ( [ eq : grd ] ) and hessian  ( [ eq : hess ] ) derived earlier from the perturbative expansion can be adapted to this variable time optimization framework simply by replacing all instances of @xmath358 by @xmath359 .",
    "in particular , at a point where @xmath126 , we find the solution functional has gradient simplifying to @xmath360 while its hessian is the bilinear map on @xmath361 given by @xmath362       \\dd\\sigma\\dd\\tau \\\\     - u(t)\\int_0^t       \\left([u_f(\\tau)^{\\dag}h_1u_f(\\tau),h_0]\\tau +            h_0u(\\tau)^{\\dag}h_1u_f(\\tau ) t \\right )       [ \\alpha(\\tau)\\ell_b+\\beta(\\tau)\\ell_a]\\dd\\tau \\\\      - u_f(t)t^2 h_0 ^ 2 \\ell_a \\ell_b.\\end{gathered}\\ ] ]    in this framework we consider the unitary control problem specified by : @xmath363 @xmath364 with @xmath202 , where a fortiori @xmath365 , and we shall set @xmath366 , @xmath367 , @xmath368 , @xmath369 , @xmath370 , @xmath351 , @xmath371 with @xmath372 arbitrary . with these parameters , the gradient at @xmath126 , @xmath373 always vanishes , and the hessian evaluates to @xmath374    & - 1.60\\ \\big ( \\pi[\\cos]+\\pi[\\sin ]",
    "\\big )      - 0.28\\ \\big ( \\pi[\\cos(\\eps\\bullet)]+\\pi[\\sin(\\eps\\bullet ) ] \\big)\\\\   & -\\sum_{k=1}^{\\infty } \\frac{4}{\\pi(4k^2 - 1 ) }       \\big(\\pi[\\sin(2k\\eps\\bullet)]+\\pi[\\cos(2k\\eps\\bullet ) ] \\big),\\end{aligned}\\ ] ] which is always positive definite , since @xmath183 , although dependent on @xmath221 , must be at least @xmath375 , and the fidelity @xmath338 here is @xmath376 .",
    "having demonstrated the existence of suboptimal attractive critical points for quantum control optimization problems , the question arises how significant such points are in practical applications .",
    "the examples in the previous sections for which we can rigorously prove the existence of such bad points are clearly quite artificial , and mainly serve to prove a theoretical point .",
    "unfortunately , it does not appear that any theoretical machinery is available to provide a general answer to this question for far more complex problems that are of immediately practical interest , so we will use numerical simulations to give a glimpse at the range of possibilities . for this purpose ,",
    "we consider the problem of implementing a quantum fourier transform gate for a three - qubit ising - coupled spin chain with full local control .",
    "explicitly , the system has the time varying hamiltonian @xmath377 with six control fields @xmath378 , where @xmath379 are the unnormalized pauli matrices and @xmath380 is a shorthand for the tensor product @xmath381 , etc .",
    "the quantum fourier transform objective @xmath29 is specified by @xmath382{i}}{\\sqrt{8 } } \\omega^{jk}\\ ] ] where @xmath383 is the canonical choice @xmath384 , and the prefactor @xmath385{i}=e^{2\\pi i(m+\\frac{1}{4})/8}$ ] for some integer @xmath386 is needed to ensure @xmath387 as our hamiltonians are in @xmath388 .",
    "we choose @xmath389 . to solve the optimization problem",
    "numerically we use the standard parameterization of the controls @xmath390 in terms of piecewise constant functions over @xmath245 intervals forming a uniform partition of @xmath30 $ ] , i.e. , effectively we define @xmath391 whenever @xmath392 , and optimize over all @xmath393 , @xmath394 variables .",
    "this system satisfies the condition of exact - time controllability over @xmath395 , the case we are usually interested in , although , as is generally the case , we do not know the critical time @xmath53 required to render the whole group accessible .",
    "neither do we know how to ensure having a suitable number of time slices @xmath245 , except that we must satisfy the dimensionality constraint @xmath396 , otherwise the optimization will either get trapped or converge to unbounded fields , for almost all objectives @xmath29 .",
    "however , the fact that we were always able to achieve errors @xmath397 below @xmath398 for 50 randomly selected target gates suggests that our choice of @xmath399 is sufficiently large , and of @xmath400 appropriate .",
    "ideally , we would like control optimization to be effective even under the weaker condition that the target gate @xmath29 be accessible at the given time @xmath17 , using @xmath245 time slices .",
    "this is certainly true , at the @xmath398 accuracy level , for our @xmath29 .    )",
    "show that the good runs terminate with errors @xmath401 , with many reaching smaller errors .",
    "the histogram of the errors for the 42 bad runs ( inset ) show that all but one of these terminate with errors @xmath402 , orders of magnitude larger than the terminal errors for the good runs.,scaledwidth=60.0% ]         for the optimization we primarily used a quasi - newton method  @xcite , relying on the bfgs formula to construct an approximate hessian , and an exact analytic formula for the gradients .",
    "this choice was motivated by related work in which this procedure performed well relative to various others , in particular at high fidelities .",
    "each run of the algorithm was initialized by setting the @xmath393 variables independently at random from a standard normal distribution , a choice which was deemed suitable considering the typical norm of high fidelity solutions .",
    "we carried out 1,000 optimization runs and found 958 of them successfully passed our pre - selected error threshold of @xmath403 , while of the remaining 42 all but one failed to reach even the @xmath404 level .",
    "a histogram of the terminal errors for 100 selected good runs versus the 42 bad runs ( fig .",
    "[ fig : hist ] ) shows that the final fidelites achieved by the good runs are many orders of magnitude higher than the terminal fidelities for the bad runs .",
    "[ fig : conv ] further shows that the convergence behavior for the successful runs is distinctly different from that of the failed ones . considering that the successful runs reached fidelities @xmath405% on average in a few dozen iterations taking mere seconds ,",
    "the bad runs constitute effective traps in that the otherwise highly efficient quasi - newton optimization routine gets stuck at these points and the runs are extremely time - consuming .",
    "we further explored the behavior of the fidelity in neighborhoods of these bad points by evaluating it for @xmath406 small random field perturbations around each of the presumed traps @xmath407 .",
    "the results show that the fidelities for _ all _ of these fields are smaller than the fidelity @xmath408 at the presumed trap @xmath407 , suggesting that the @xmath407 are indeed in the trapping neighbourhood of a local maximum for all 42 runs that terminated at fidelities @xmath409 .",
    "an example of a scatter - plot of the fidelities of the perturbed fields @xmath45 as a function @xmath410 in a neighborhood of trap 1 is shown in fig .",
    "[ fig : trap1 ] . we know that this is not a result of the target time @xmath17 being too short or the dimension of the subspace of @xmath98 being too small as there are solutions for the fields for @xmath399 and @xmath400 with errors @xmath411 on the order of @xmath412 , close to machine precision . to ascertain",
    "whether these bad fields @xmath407 indeed attracted trajectories , we also restarted the optimization with perturbed fields @xmath413 .",
    "even when the size of the perturbations was increased to @xmath414 on the order of @xmath415 the runs tended to remain stuck in the trapping region as illustrated in fig .",
    "[ fig : pert ] .",
    "finally , we also tested other implementations , including several variants of sequential update algorithms , similar to the krotov method _ without _ penalty , but starting with the bad points @xmath407 none of the runs managed to escape the trapping regions .",
    "it is difficult to ascertain if there is a single trap or possibly multiple traps in each region , and there are clearly limitations of this computational investigation , but taken together , the simulation results strongly suggest that there are suboptimal extrema and effective trapping regions , at least for the @xmath416-dimensional search space we chose to optimize over",
    ".     is negative , bounded away from @xmath19 , for all sample points , showing that the fidelity at all of these random samples is less than the fidelity at the presumed local extremum @xmath407 , suggesting that @xmath407 is indeed a local extremum.,scaledwidth=60.0% ]    . for each @xmath407 , for clarity",
    ", the _ difference _ of the fidelity as a function of the iteration number , @xmath417 , and the fidelity of the nearest `` trap '' @xmath418 is shown for 10 runs starting with @xmath419 . for each run",
    "the difference in the fidelites vanishes , i.e. , the fidelities seem to converge to the respective fidelity value for the closest trap .",
    "inset shows close - up of a small portion to better resolve the trajectories.,scaledwidth=60.0% ]    it is difficult to ascertain whether these bad points would constitute traps if each of our six control fields @xmath41 were not restricted to the 140-dimensional subspace of @xmath420 consisting of piecewise constant functions . to get a glimpse of how the convergence behavior changes when we enlarge the subspace of @xmath98 we project onto",
    ", we subdivided the time grid three - fold to @xmath421 , and restarted the optimization , starting with the field @xmath422 for which the optimization got trapped on the original subspace .",
    "as one would expect , tripling the dimension of the parameter space we optimize over from @xmath416 to @xmath423 does increase the attainable fidelities slightly , but in all the cases we studied the improvements were small , and the optimization over the larger subspace exhibited trapping behavior similar to that on the original control space , terminating with substantially lower fidelities after many ( time - consuming ) iterations than typical successful runs ( see fig .",
    "[ fig : refinement ] ) . that refining the mesh would lead to higher fidelities is rather inevitable , since even if there is a local maximum in infinite dimensions , any finite dimensional subspace will almost surely not contain this point , but the distance between increasingly larger subspaces and the point must decrease , tending to zero , allowing the fidelity to increase towards an asymptotic value",
    ". this phenomenon can conveniently be visualised by considering a non - degenerate quadratic potential on the plane and a generic line through the origin : the maximum on the line is lower than the maximum over the plane .",
    "the fact that fidelity increases so little ( relative to the error ) after we refine the mesh is , on the other hand , an indication that said asymptotic value is likely to strictly below the global maximum of @xmath117 , and the data certainly suggests that the neighborhoods of the @xmath407 are really bad neighborhoods for the optimization .     error threshold or exceeded a thousand bfgs iterations ( blue , largest ) , ( 2 ) after increase in fidelity dropped below @xmath424 in additional newton iteration steps ( red , intermediate ) , ( 3 ) after increase in fidelity obtained by a newton iteration remains below @xmath425 even after sub - division of time intervals ( yellow , smallest ) .",
    "the inset focuses on the failed runs . since the rank order of the final errors between runs did not change much across the three stages",
    ", one can see that the gains made by going beyond a thousand iterations or refining the mesh are marginal .",
    "in fact , the largest reduction in the error obtained by refining the mesh was only @xmath426% , orders of magnitude less than what would have been achieved by a successful run with less computational effort.,scaledwidth=60.0% ]",
    "we have revisited the control landscape for several classes of canonical quantum control problems , in particular pure - state transfer and unitary gate optimization problems .",
    "although the pure - state transfer fidelity as a function over the unitary group only has two types of critical points , corresponding to either the global minimum @xmath19 or the global maximum @xmath117 , detailed analysis shows that the class of critical points for the actual optimization problem over functions in @xmath0 is strictly larger than the set of kinematic critical points .",
    "in particular , for any bilinear control system @xmath175 and any fixed target time @xmath17 , there exist pairs of initial and target states , such that some @xmath427 is a critical point of the system , and we can achieve any value of the fidelity between @xmath19 and @xmath117 for such critical points .",
    "moreover , while these critical points are not expected to be attractive in most cases , we have presented examples of systems with attractive suboptimal critical points , showing that traps _ do _ exist for such problems , and the fidelity at these traps can take many values , unlike the fidelity for kinematic critical points , which is limited to 0 or 1 for pure - state optimization problems .    for the problem of unitary operator optimization we demonstrated that there are indeed no traps when we consider the fidelity as a functional over the unitary group .",
    "although there are critical manifolds on which the fidelity takes values between @xmath428 ( global minimum ) and @xmath429 ( global maximum ) , all of these critical points are indeed saddle points , but the situation changes when the analysis is restricted to the special unitary group @xmath57 .",
    "this case may appear artificial but it is actually highly relevant for quantum control , as many quantum control problems involve control hamiltonians that have zero - trace , and hence we have no global phase control . although the system may be @xmath2 controllable when @xmath319=0 $ ] , if the target time is fixed , so is the global phase .",
    "perhaps surprisingly , there are more critical points in this case than for @xmath2 , and some of these are attractive critical points at which the fidelity assumes values @xmath430 , i.e. , traps .",
    "more careful analysis shows that these traps correspond to solutions @xmath431 , where @xmath320 is a root of unity , which immediately shows that these solutions have fidelity @xmath430 , according to the standard definition of the fidelity .",
    "nonetheless , these solutions are perfectly adequate for most practical purposes as we usually do not care about the global phase of an operator , and this problem can be avoided entirely simply by modifying the performance index to reflect the fact that we do not care about the global phase .",
    "optimizating over the projective unitary group @xmath317 there are indeed no traps , at least on the group .",
    "again , the situation is more complicated for actual optimization problem over controls in @xmath0 .",
    "not only are there critical points @xmath8 for which the fidelity assumes critical values other than those permitted over @xmath2 or @xmath57 , but examples again show that the hessian at these critical points can be negative definite , implying that they are locally attractive on any finite - dimensional subspace and therefore traps .",
    "the results can even be extended to the case where the target time @xmath17 is variable , again proving the existence of traps .",
    "the specific examples of traps constructed prove a theoretical point about the existence of traps , but they are not of particular interest in their own right . unfortunately , due to the difficulty of exactly calculating the hessian for complex systems with time - varying controls , it is difficult to _ prove _ the existence of traps for more interesting cases . therefore we turned to numerical simulations to investigate any evidence for the existence of trapping regions in practice .",
    "for a three - qubit gate optimization problem we studied the simulation results suggests that there are genuine traps , i.e. , attractive critical points for which the fidelity is below a certain threshold .",
    "although such traps do not appear to be very common  in the example considered we observed trapping in about 42 out of 1000 cases , they do complicate the control landscape and obstruct convergence to a global extremum , and perhaps even more importantly , trapped runs can be extremely time - consuming , which suggests that it is important to consider the possibility of trapping in the algorithm design , to ensure that trapped runs are quickly identified and terminated . furthermore , the example considered was a rather simple system of dimension @xmath432 with six independently variable controls .",
    "it is quite plausible that the number of traps and the likelihood of a local optimization algorithm converging to these increases with the system dimension or complexity .",
    "this is an important issue of practical concern that requires a systematic further analysis .",
    "we would like to thank thomas schulte - herbrggen , robert zeier and john v. leahy for helpful discussions and suggestions .",
    "sgs acknowledges funding from epsrc arf grant ep / d07192x/1 , the epsrc qip interdisciplinary research collaboration ( irc ) , hitachi and nsf grant phy05 - 51164 .",
    "pdf acknowledges funding from epsrc and hitachi ( case / cna/07/47 ) .",
    "we define the operators @xmath183 and @xmath245 via their action on functions @xmath95    [ eq : sc ] @xmath433\\dd\\sigma\\dd\\tau , \\\\",
    "\\ip{\\beta}{s\\alpha}_{l^2 }    & = \\!\\!\\!\\underset{0<\\sigma<\\tau < t}{\\int\\int}\\!\\!\\",
    "! \\sin(\\omega(\\sigma-\\tau ) )        [ \\alpha(\\tau)\\beta(\\sigma)+\\beta(\\tau)\\alpha(\\sigma)]\\dd\\sigma\\dd\\tau \\end{aligned}\\ ] ]    for @xmath183 , using the trigonometric identity @xmath434 , and symmetrization the double integral , we find @xmath435 + \\pi[\\cos(\\omega\\bullet)]\\ ] ] with @xmath383 arbitrary .",
    "when @xmath436 , @xmath245 can be expressed in terms of its eigenfunction decomposition , constituted of the real fourier basis @xmath437 + \\sum_{k=1}^\\infty \\frac{4}{\\pi(4k^2 - 1 ) }        \\big ( \\pi[\\sin(2k\\omega \\bullet ) ] + \\pi[\\cos(2k\\omega\\bullet)]\\big)\\ ] ] recall that here @xmath99 denotes the unnormalized projection onto its argument and @xmath100 is a placeholder for the argument to an anonymous function .",
    "for example , @xmath438 $ ] is the projector onto the function @xmath439 , i.e. the operator sending each element @xmath440 to the element @xmath441 in @xmath0 .",
    "10 url # 1#1urlprefix[2][]#2 rabitz h 2009 _ new journal of physics _ * 11 * 105030 issn 1367 - 2630"
  ],
  "abstract_text": [
    "<S> the control landscape for various canonical quantum control problems is considered . for the class of pure - state transfer problems , analysis of the fidelity as a functional over the unitary group reveals no suboptimal attractive critical points ( traps ) . for the actual optimization problem over controls in @xmath0 , however , there are critical points for which the fidelity can assume any value in @xmath1 , critical points for which the second order analysis is inconclusive , and traps . for the class of unitary operator optimization problems analysis of the fidelity over the unitary group </S>",
    "<S> shows that while there are no traps over @xmath2 , traps already emerge when the domain is restricted to the special unitary group . </S>",
    "<S> the traps on the group can be eliminated by modifying the performance index , corresponding to optimization over the projective unitary group . however , </S>",
    "<S> again , the set of critical points for the actual optimization problem for controls in @xmath0 is larger and includes traps , some of which remain traps even when the target time is allowed to vary .    , </S>"
  ]
}