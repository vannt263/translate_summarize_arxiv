{
  "article_text": [
    "multigraphs arise in many applications including modelling transportation networks  @xcite , the structure of rna  @xcite and in nonparametric statistics  @xcite .",
    "we use terminology `` multigraphs '' inclusively , with both multiple edges and ( possibly multiple ) loops allowed .",
    "we seek an asymptotic enumeration formula for multigraphs with a given degree sequence , satisfying certain conditions .",
    "let @xmath14 be a nonnegative integer for all pairs @xmath15 of integers which satisfy @xmath16 .",
    "then for each @xmath17 , let @xmath18 .",
    "we usually write @xmath19 instead of @xmath14 .",
    "define @xmath20 .",
    "we assume that @xmath7 is even for an infinite number of values of @xmath5 , and tacitly restrict ourselves to such @xmath5 .    for subsets",
    "@xmath21 of @xmath2 , define @xmath22 to be the set of all multigraphs on the vertex set @xmath8 with degree sequence given by @xmath9 such that the multiplicity of every loop belongs to @xmath1 and the multiplicity of every non - loop edge belongs to  @xmath0 .",
    "loops contribute 2 to the degree of their vertex . also define @xmath23 to be the set of multigraphs on @xmath8 with degree sequence @xmath9 ( and no restrictions on the multiplicities ) .",
    "equivalently we may think of @xmath24 as the set of all @xmath25 symmetric matrices @xmath26 with all diagonal entries in @xmath1 , all off - diagonal entries in @xmath0 and with @xmath27 for @xmath28 .",
    "note that diagonal entries are weighted by  2 in the row sum .",
    "let @xmath29 .",
    "we find an asymptotic expression for @xmath30 that holds when @xmath13 .",
    "for @xmath31 let @xmath32_r\\ ] ] where @xmath33_r = a(a-1)(a-2)\\cdots ( a - r+1)$ ] denotes the falling factorial",
    ". then @xmath34 and @xmath35 for all @xmath36 .    for @xmath37 ,",
    "define @xmath38 our main result is the following .",
    "[ main ] let @xmath0 and @xmath1 be subsets of @xmath2 such that @xmath3 and @xmath4 .",
    "suppose that @xmath39 , @xmath40 and @xmath41 .",
    "then @xmath42    for convenience , we restate the formula in the regular case .    [ regular ] suppose that @xmath43 with @xmath44 even , such that @xmath45 as @xmath39",
    ". then @xmath46 where @xmath47    setting @xmath48 we recapture the asymptotic expression for sparse simple graphs with given degrees presented in  ( * ? ? ?",
    "* theorem 5.2 ) .",
    "similarly , setting @xmath49 , @xmath50 we obtain the asymptotic enumeration by degree sequence of sparse graphs with loops allowed but no multiple edges : this is the second expression in  ( * ? ? ?",
    "* theorem 1.5 ) .",
    "we remark that the conditions @xmath51 and @xmath52 in theorem  [ main ] can be replaced by weaker conditions : namely , that @xmath10 is non - empty and that @xmath11 has at least two elements with the smallest two consecutive .",
    "let @xmath53 denote the least element of @xmath10 and let @xmath54 be the smallest two elements of @xmath11 .",
    "this case is reduced to ours by subtracting @xmath53 from each diagonal element , @xmath55 from each off - diagonal element , and @xmath56 from each @xmath19 , provided the new degree sequence satisfies the conditions of theorem  [ main ] .",
    "theorem  [ main ] is proved using the switching method , building on an asymptotic enumeration of simple graphs with given degrees  @xcite .",
    "our application of the switching method introduces a novel way of combining several different switching operations into a single computation .",
    "the remainder of the paper is structured as follows .",
    "the history of this asymptotic enumeration problem is briefly reviewed in section  [ ss : history ] , then the new switching theorem is given in section  [ s : switchinglemma ] . in section  [ s : multigraphs ]",
    "we describe 15 types of switchings on multigraphs , which are used to show that certain multiplicities of edges or loops are rare .",
    "these switchings are analysed together in subsection  [ ss : combine ] using the new switching theorem . in section  [ s : pairings ]",
    "we complete the enumeration with the help of some calculations performed in  @xcite .",
    "finally , in section  [ s : naive ] we show that a nave argument leads to a formula for @xmath57 which differs asymptotically by a constant factor from the result of theorem  [ main ] in the regular case .",
    "the constant factor takes two different values , depending on whether @xmath58 .",
    "the earliest work on this problem was that of read  @xcite , who found exact and asymptotic formulae when @xmath59 , for all four combinations of @xmath60 and @xmath61 .",
    "the best result for @xmath62 in the sparse range is that of mckay and wormald  @xcite who treated @xmath63 ; see that paper for a survey of the many earlier results on the case .",
    "in addition to @xmath64 , bender and canfield  @xcite found the asymptotics for @xmath65 when @xmath66 .",
    "( although that paper allows nonzero diagonal entries , they contribute singly to the row sums , not doubly as we have  it . )    in  @xcite , mckay and wormald considered @xmath64 in the dense domain defined by @xmath67 for @xmath68 and @xmath69 for all  @xmath70 , where @xmath71 is the average degree .",
    "mckay  @xcite found a better error term under the same conditions , while barvinok and hartigan allowed a wider range of degrees  @xcite .",
    "greenhill and mckay  @xcite added the option of loops in both the sparse and dense ranges by considering @xmath72 , @xmath73 .",
    "finally , mcleod and mckay  @xcite analysed the case of @xmath74 when @xmath75 for @xmath76 .    for sparse rectangular matrices which are not necessarily symmetric , see greenhill and mckay  @xcite .",
    "in order to bound the number of multigraphs having some unusual properties , we will apply the method of switchings .",
    "it will be necessary to apply several switching types , which we could analyse one at a time as in  @xcite .",
    "instead we now prove a generalized switching theorem that allows us to analyse all of them at once .    in order to facilitate use of the method in future work",
    ", we will present the theorem in greater generality than is required in this paper .",
    "[ switchings ] let @xmath77 be a directed multigraph , and let @xmath78 be a positive weighting of the edges of @xmath79 . fix a non - empty finite set @xmath80 , whose elements we will call _ colours _ , and let @xmath81 be an edge colouring of @xmath79 ( which need not be proper )",
    ". for all @xmath82 and @xmath83 denote by @xmath84 the set of edges of colour  @xmath85 entering  @xmath86 , and by @xmath87 the set of edges of colour @xmath85 leaving  @xmath86 .",
    "we introduce the set of variables @xmath88 and consider the following system of linear inequalities on these variables : @xmath89   \\\\",
    "\\sum_{e\\in\\vargamma_c^-(v ) } s(e ) \\le n(v ) , &       \\qquad(v\\in v,\\,\\ , c\\in c ) \\label{ineq3}\\\\     \\sum_{e\\in\\vargamma_c^+(v ) } \\alpha(e)s(e ) \\ge n(v ) , &       \\qquad(v\\in v,\\,\\ , c\\in c,\\,\\ , \\vargamma_c^+(v)\\ne\\emptyset ) .",
    "\\label{ineq4}\\end{aligned}\\ ] ] let @xmath90 be the set of colours entering  @xmath86 . for each @xmath82 which is not a source , let @xmath91 be positive numbers such that @xmath92 . for each @xmath93 , define @xmath94 .",
    "extend this function to any directed path @xmath95 by defining @xmath96 .",
    "now suppose that @xmath97 satisfy the following conditions :    * @xmath98 and @xmath99 ; * if @xmath82 is a sink of @xmath79 , or if @xmath100 for some @xmath93 , then @xmath101 .    for any @xmath102 , define @xmath103 to be the set of non - trivial directed paths in @xmath79 which start in @xmath104 , end in @xmath105 , and have no internal vertices in @xmath106",
    ". then every solution of   satisfies @xmath107 where the maximum over an empty set is taken to be  0 .",
    "the case of one colour appears in  ( * ? ? ?",
    "* theorem 3 ) , apart from an inconsequential difference in the conditions on  @xmath108 .",
    "we proceed by reducing the general problem to one in which there is only one colour , then modifying @xmath79 slightly so that  ( * ? ?",
    "? * theorem 3 ) applies .",
    "define @xmath109 and @xmath110 to be the set of all edges ( regardless of colour ) entering  @xmath86 or leaving  @xmath86 , respectively . for each edge",
    "@xmath93 , define @xmath111 . if we weight inequality   by @xmath112 and sum over @xmath113 , we obtain @xmath114 similarly , if @xmath115 , then we can sum over those @xmath83 with @xmath116 to obtain @xmath117 together with the nonnegativity of @xmath118 and @xmath119 , we have equations of the form of  with only one colour .",
    "next remove from @xmath79 all edges @xmath120 where @xmath101 .",
    "doing so can only weaken the conditions , by decreasing the left hand side of some inequalities in ( [ 1colour1 ] ) or removing some inequalities in ( [ 1colour2 ] ) .",
    "note that none of the quantities in   are changed by removal of these edges .",
    "after this change to @xmath79 , @xmath108 satisfies the requirements of  ( * ? ? ?",
    "* theorem 3 ) , with the variable @xmath121 defined there set equal to  @xmath108 . applying that theorem to the system defined by ( [ 1colour1 ] ) , ( [ 1colour2 ] ) and the nonnegativity of @xmath118 and @xmath119 gives  .",
    "we now describe how theorem  [ switchings ] can be used for counting .",
    "suppose we have a finite set of `` objects '' partitioned into disjoint classes @xmath122 , where @xmath82 for some index set @xmath123 .",
    "define @xmath124 for each @xmath82 .",
    "also suppose that for each @xmath83 we have a relation @xmath125 between objects : to be precise , @xmath125 is a multiset of ordered pairs @xmath126 of objects .",
    "( we call @xmath125 a _ switching _ and usually define it by some operation that modifies @xmath127 to make  @xmath128 . )",
    "now define an edge - coloured directed multigraph @xmath129 with vertex set  @xmath123 , where @xmath79 has a directed edge @xmath120 of colour @xmath85 if and only if @xmath130 for some @xmath131 and @xmath132 .",
    "( there is at most one edge of each colour between any pair of distinct vertices of @xmath79 . ) for each @xmath93 let @xmath133 , counting multiplicities , where @xmath85 is the colour of  @xmath120 .",
    "fix @xmath82 and @xmath83 such that @xmath134 .",
    "suppose that for any @xmath131 there are at least @xmath135 objects @xmath128 with @xmath130 , counting multiplicities .",
    "then @xmath136 similarly , for fixed @xmath137 and @xmath83 , suppose that for every @xmath132 there are at most @xmath138 objects @xmath127 with @xmath130 , counting multiplicities .",
    "then @xmath139 defining @xmath140 and @xmath141 we obtain equations  . theorem  [ switchings ] can thus be used to bound the relative values of @xmath142 and @xmath143 if @xmath144 satisfy the requirements of the lemma . since @xmath145 , this also bounds @xmath143 relative to @xmath146 ; i.e. , it bounds the fraction of all objects that lie in @xmath147 .",
    "define @xmath148 ( we have not attempted to optimise constants . ) given a multigraph @xmath127 , let @xmath149 denote the number of loops with multiplicity @xmath150 and let @xmath151 denote the number of non - loop edges with multiplicity @xmath150 , for @xmath152 .",
    "let @xmath153 be the set of all multigraphs with degree sequence @xmath9 , and allowing all multiplicities except for those in @xmath154 on loops and those in @xmath155 on non - loops .",
    "note that @xmath156 .",
    "we also define the subsets @xmath157 , @xmath108 of @xmath158 by @xmath159    we define 15 coloured switchings which act to reduce the number of loops or edges with high multiplicities , moving in steps from @xmath157 towards @xmath108 .",
    "these switchings are defined below , together with a description of when each should be used .",
    "indeed , any given switching will only be used on multigraphs in @xmath158 for which none of the switchings with a lower - labelled colour are applicable .",
    "an important property of all the switchings is that they do not create simple loops ( with multiplicity 1 ) and they do not create non - loop edges of multiplicity 2  or  3 , as these may not be allowed for multigraphs in  @xmath158 .    for each switching colour @xmath85 and multigraphs @xmath127 ,",
    "@xmath128 we will define the following parameters :    * @xmath160 is a lower bound on the number of ways in which a switching of colour @xmath85 can be applied to @xmath127 . * @xmath161 is an upper bound on the number of ways in which a switching of colour @xmath85 can produce @xmath128 . *",
    "if @xmath128 can be obtained from @xmath127 by performing a switching of colour @xmath85 , then we let @xmath162 be an upper bound on @xmath163 .",
    "( note that the colour @xmath85 is determined by the edge  @xmath164 . )    finally in section  [ ss : combine ] we will analyse all the switchings at once by applying theorem  [ switchings ] .",
    "a switching of colour 1 is used to reduce the number of loops of multiplicity equal to 2 or multiplicity at least 4 .",
    "it is applied to multigraphs @xmath165 with @xmath166 , where @xmath167 is the number of loops in @xmath127 with multiplicity 2 or multiplicity at least 4 .",
    "the switching is described by the sequence @xmath168 of distinct vertices such that there is a loop of multiplicity @xmath169 at @xmath170 and a loop of multiplicity @xmath171 at @xmath172 , with @xmath173 .",
    "let @xmath174 be the multiplicity of the edge from @xmath170 to @xmath172 in @xmath127 ( which may equal zero ) .",
    "the switching reduces the multiplicity of both loops by 2 , and increases the multiplicity of the edge @xmath175 by 4 .",
    "this operation is depicted in figure  [ f : switching1 ] .",
    "= 0.9 cm    ( 9,1.5)(0,0 ) ( 0,0.0 )   ( 0.2,1.15)@xmath169 ( 2.6,1.15)@xmath171 ( 4.9,1.15)@xmath176 ( 7.3,1.15)@xmath177 ( 1.5,0.5)@xmath174 ( 6.3,0.4)@xmath178    suppose that @xmath128 can be produced from @xmath127 using a switching of colour 1 .",
    "the number of ways to perform a switching of colour 1 in @xmath127 is exactly @xmath179_{2 } \\geq 9m\\ ] ] as there is no restriction on the value of @xmath174 .",
    "the number of ways that @xmath128 can be produced using a switching of colour 1 is bounded above by @xmath180 , which is a bound on the number of ways to choose an oriented edge with multiplicity at least 4 .",
    "hence we can set @xmath181 and @xmath182 , giving @xmath183      a switching of colour 2 is used to reduce the number of loops of multiplicity three to at most @xmath184 .",
    "it is performed for multigraphs @xmath127 for which switchings of colour 1 do not apply and such that @xmath185 .",
    "the switching is described by the sequence @xmath168 of distinct vertices such that there is a loop of multiplicity 3 at @xmath170 and at @xmath172 .",
    "let @xmath174 be the multiplicity of the edge from @xmath170 to @xmath172 in @xmath127 ( which may equal zero ) .",
    "the switching removes the loop at @xmath170 and at @xmath172 , and increases the multiplicity of the edge @xmath175 by 6 , as illustrated in figure  [ f : switching2 ] .",
    "= 0.9 cm    ( 9,1.5)(0,0 ) ( 0,0.0 )   ( 0.3,1.1)@xmath186 ( 2.7,1.1)@xmath186 ( 1.5,0.5)@xmath174 ( 6.4,0.4)@xmath187    suppose that the multigraph @xmath128 can be produced from @xmath127 using a switching of colour 2 .",
    "the number of ways to perform a switching of colour 2 in @xmath127 is exactly @xmath188_2 \\geq 9m$ ] , and the number of ways that @xmath128 can be produced using a switching of colour 2 is at most @xmath189 ( since an oriented edge of multiplicity at least 6 determines the reverse operation , from @xmath128 to @xmath127 ) . hence we can take @xmath190 and @xmath191 , leading to @xmath192      a switching of colour 3 is used to reduce the number of loops of multiplicity 1 to at most @xmath193 .",
    "it is applied to multigraphs @xmath127 for which switchings of colour 1 and 2 do not apply and such that @xmath194 .",
    "the switching is defined by the sequence @xmath195 of distinct vertices such that each of @xmath170 , @xmath172 , @xmath196 has a simple loop in @xmath127 ( of multiplicity 1 ) , and none of the edges @xmath175 , @xmath197 , @xmath198 are present in @xmath127 .",
    "the switching removes these three loops and joins the three vertices pairwise by simple edges ( of multiplicity 1 ) , as illustrated in figure  [ f : switching3 ] .",
    "= 0.9 cm    ( 9,3.8)(0,0 ) ( 0,-0.3 )   ( -0.2,0.0)@xmath199 ( 3.3,0.0)@xmath199 ( 1.5,3.5)@xmath199 ( 0.6,1.5)@xmath200 ( 2.5,1.5)@xmath200 ( 1.5,-0.2)@xmath200 ( 5.8,1.5)@xmath199 ( 7.7,1.5)@xmath199 ( 6.7,-0.2)@xmath199    suppose that the multigraph @xmath128 can be produced from @xmath127 using a switching of colour 3 .",
    "the number of ways to perform a switching of colour 3 in @xmath127 is at least @xmath201_3 - o\\(\\kmax   \\ell_1(q)^2\\ ) = \\ell_1(q)^3(1-o(1 ) ) \\geq    \\nfrac{1}{2}\\ , m^{3/2},\\ ] ] while the number of ways that @xmath128 can be produced using a switching of colour 3 is at most @xmath202 .",
    "therefore we can take @xmath203 and @xmath204 , leading to @xmath205      a switching of colour 4 is used to reduce the number of non - loop edges of multiplicity greater than @xmath206 .",
    "it is applied to multigraphs @xmath127 for which switchings of colours @xmath207 do not apply and such that @xmath208 , where @xmath209 a switching of colour 4 in @xmath127 is described by a sequence @xmath210 of distinct vertices such that    * the multiplicity of edge @xmath211 in @xmath127 is @xmath169 and the multiplicity of @xmath212 in @xmath127 is @xmath171 , where @xmath213 , * the edges @xmath175 and @xmath214 have multiplicity zero in @xmath127 ( they are non - edges ) .    the switching reduces the multiplicity of edges @xmath211 and @xmath212 by one and gives multiplicity 1 to edges @xmath175 and @xmath215 , as shown in figure  [ f : switching45 ] .",
    "= 0.9 cm    ( 8.5,4.0)(0,-0.4 ) ( 0.0,0.0 )   ( 1.3,3.0)@xmath169 ( -0.1,1.3)@xmath200 ( 1.3,-0.35)@xmath171 ( 2.9,1.3)@xmath200 ( 6.1,3.0)@xmath216 ( 5.1,1.3)@xmath199 ( 6.1,-0.35)@xmath217 ( 8.2,1.3)@xmath199    now suppose that the multigraph @xmath128 can be produced from @xmath127 using a switching of colour  4",
    ". the number of switchings of colour 4 that can be performed in @xmath127 is bounded below by @xmath218_2 - o(\\kmax^2\\ , e^+(q ) ) = 4e^+(q)^2(1-o(1 ) ) \\geq               64\\ , \\kmax\\ , m ( 1-o(1 ) ) > 60\\kmax\\ , m,\\ ] ] and the number of switchings of colour 4 that can produce @xmath128 is at most @xmath219 hence we can take @xmath220 and @xmath221 , leading to @xmath222      a switching of colour 5 is used to reduce the number of non - loop edges of multiplicity at least 5 and at most @xmath223 . for a multigraph @xmath165 ,",
    "let @xmath224 switchings of colour 5 are applied to multigraphs @xmath127 for which switchings of colours @xmath225 do not apply and such that @xmath226 .",
    "a switching of colour 5 is described by a sequence @xmath210 of distinct vertices such that    * the multiplicity of @xmath227 in @xmath127 is @xmath169 and the multiplicity of @xmath228 in @xmath127 is @xmath171 , where @xmath229 , and * the multiplicity of @xmath175 and @xmath214 in @xmath127 is zero ( these are non - edges ) .",
    "this switching is also illustrated by figure  [ f : switching45 ] , but with different conditions on @xmath230 as above .",
    "suppose that @xmath128 can be produced from @xmath127 using a switching of colour 5 .",
    "the number of ways that a switching of colour 5 can be performed in @xmath127 is bounded below by @xmath231_2 - o(\\kmax^2 e^-(q ) ) = 4 e^-(q)^2(1-o(1 ) )              \\geq 30 \\kmax^2 m,\\ ] ] and the number of ways to produce @xmath128 using a switching of colour 5 is at most @xmath232 hence we can let @xmath233 and @xmath234 , leading to @xmath235      a switching of colour @xmath236 is used to reduce the number of edges of multiplicity @xmath237 to at most @xmath238 , for @xmath239 .",
    "switchings of colour @xmath236 are applied to multigraphs @xmath127 for which switchings of colours @xmath240 do not apply and such that @xmath241 given such a multigraph @xmath127 , a switching of colour @xmath236 is defined by a sequence @xmath242 of distinct vertices such that    * @xmath243 is an edge of multiplicity @xmath237 in @xmath127 for @xmath244 , * every edge @xmath245 with @xmath246 has multiplicity 0 in @xmath127 ( it is a non - edge ) .",
    "the switching deletes these @xmath237 edges of multiplicity @xmath237 , and inserts a complete bipartite graph @xmath247 on @xmath248 , with all @xmath249 new edges simple ( that is , multiplicity 1 ) .",
    "this operation is illustrated in the figure  [ f : switching8 ] for the case @xmath250 .",
    "= 0.9 cm    ( 9,4.4)(0,0 ) ( 0,0.0 )   ( 1.4,0.4)@xmath237 ( 1.4,2.8)@xmath237 ( 1.4,4.0)@xmath237 ( 1.4,1.6)@xmath237    suppose that the multigraph @xmath128 can be obtained from @xmath127 using a switching of colour @xmath236 , for @xmath251",
    ". the number of ways in which a switching of colour @xmath236 can be performed in @xmath127 is bounded below by @xmath252_j - o(\\kmax^2\\ , e_j(q)^{j-1 } ) \\geq \\nfrac{1}{2 }   m^{5j/6},\\ ] ] while the number of switchings of colour @xmath236 which produce @xmath128 is at most @xmath253 .",
    "hence we can define @xmath254 and @xmath255 for @xmath256 .",
    "since @xmath257 , this leads to @xmath258    before describing more coloured switchings , we prove a useful fact .",
    "[ mostlyones ] suppose that @xmath259 is such that no switching of colour 1 to 8 applies to @xmath127",
    ". then @xmath260 .",
    "since no switching of colour 1 , 2 or 3 applies we have @xmath261 and since no switching of colour 48 applies we know that @xmath262 the result follows .",
    "switchings of colour 9 reduce the number of loops of multiplicity 2 or multiplicity at least  4 , until this number is zero .",
    "they are applied to multigraphs @xmath127 for which the switchings of colours @xmath263 do not apply and such that @xmath264 .",
    "let @xmath127 be such a multigraph .",
    "a switching of colour 9 in @xmath127 is defined by a sequence @xmath265 of distinct vertices such that    * there is a loop at vertex @xmath266 in @xmath127 with multiplicity @xmath150 , where @xmath267 or @xmath268 , * @xmath227 and @xmath228 are simple edges ( of multiplicity 1 ) , * @xmath269 , @xmath270 , @xmath271 , @xmath272 are all non - edges in @xmath127 ( with multiplicity zero ) .",
    "the switching reduces the multiplicity of the loop at @xmath266 to @xmath273 , removes the two simple edges @xmath274 and @xmath275 and inserts the four simple edges @xmath269 , @xmath276 , @xmath277 , @xmath272 , as shown in figure  [ f : switching9 ] .",
    "= 0.9 cm    ( 8,3.4)(0,0 ) ( 0,0.0 )   ( 1.4,3.3)@xmath150 ( 6.2,3.3)@xmath273    suppose that the multigraph @xmath128 can be produced from @xmath127 by a switching of colour  9 .",
    "the number of ways to perform a switching of colour 9 in @xmath127 is at least @xmath278_2 - o(\\kmax^2e_1(q)){\\aftergroup\\egroup\\originalright } ) \\geq \\nfrac{1}{2}\\ , l(q)m^2,\\ ] ] using lemma  [ mostlyones ] , while the number of ways to produce @xmath128 using a switching of colour 9 is at most @xmath279 .",
    "( we ignore the presence of the loop at @xmath266 in this upper bound , since no such loop exists when @xmath267 . )",
    "hence we can let @xmath280 and @xmath281 , leading to @xmath282 since @xmath283 .",
    "switchings of colour 10 reduce the number of loops of multiplicity 3 , until this number is zero .",
    "they are applied to multigraphs @xmath127 such that switchings of colours @xmath284 do not apply and such that @xmath285 .",
    "let @xmath127 be such a multigraph .",
    "a switching of colour 10 is defined by a sequence of distinct vertices @xmath286 such that    * there is a loop of multiplicity 3 at @xmath266 in @xmath127 , * there is a simple edge @xmath287 in @xmath127 , for @xmath288 , * the edges @xmath289 and @xmath290 all have multiplicity 0 in @xmath127 , for @xmath288 .",
    "the switching removes the loop of multiplicity 3 and the simple edges @xmath291 for @xmath288 , and adds the six simple edges @xmath292 , as shown in figure  [ f : switching10 ] .",
    "= 0.9 cm    ( 8,4.7)(0,0 ) ( 0,0.0 )   ( 1.4,4.5)@xmath186    now let @xmath128 be a multigraph which can be formed from @xmath127 by a switching of colour 10 .",
    "the number of ways that a switching of colour 10 can be performed in @xmath127 is at least @xmath293_3 - o(\\kmax^2 e_1(q)^2){\\aftergroup\\egroup\\originalright } ) \\geq \\nfrac{1}{2}\\ ,   \\ell_3(q ) m^3,\\ ] ] using lemma  [ mostlyones ] , and the number of ways that @xmath128 can be produced using a switching of colour 10 is bounded above by @xmath294 .",
    "hence we can take @xmath295 and @xmath296 .",
    "this leads to @xmath297    we do not tackle single loops yet . instead",
    ", the next two switchings reduce non - loop edges of high multiplicity down to zero .",
    "switchings of colour 11 reduce the number of non - loop edges with multiplicity 4 or multiplicity at least 7 , until this number is zero .",
    "switchings of colour 11 are applied to multigraphs @xmath127 for which switchings of colours @xmath298 do not apply and @xmath299 , where @xmath300 let @xmath127 be such a multigraph .",
    "a switching of colour 11 in @xmath127 is defined by a sequence @xmath301 of distinct vertices such that    * the edge @xmath302 has multiplicity @xmath150 in @xmath127 , where @xmath303 or @xmath304 , * edges @xmath287 are simple edges in @xmath127 ( with multiplicity 1 ) for @xmath288 , * the edges @xmath289 and @xmath305 are non - edges in @xmath127 for @xmath288 ( with multiplicity zero ) .",
    "the switching reduces the multiplicity of @xmath302 to @xmath306 , removes the edges @xmath291 for @xmath288 and adds the simple edges @xmath289 and @xmath307 for @xmath288 .",
    "this operation is illustrated in figure  [ f : switching11 ] .",
    "= 0.9 cm    ( 9,4.7)(0,0 ) ( 0,0.0 )   ( 1.3,4.1)@xmath150 ( 6.2,4.1)@xmath306    suppose that the multigraph @xmath128 can be obtained from @xmath127 by performing a switching of colour 11 .",
    "the number of ways to perform a switching of colour 11 in @xmath127 is at least @xmath308_3 - o(\\kmax^2 e_1(q)^2){\\aftergroup\\egroup\\originalright } ) \\geq   e(q)\\ , m^3,\\ ] ] using lemma  [ mostlyones ] , and the number of ways to produce @xmath128 using a switching of colour 11 is at most @xmath309 .",
    "hence we can let @xmath310 and @xmath311 .",
    "this leads to @xmath312      switchings of colour 12 reduce the number of non - loop edges with multiplicity 5 or 6 , until this number is zero .",
    "they are applied to multigraphs @xmath127 such that switchings of colours @xmath313 do not apply and @xmath314 .",
    "let @xmath127 be such a multigraph .",
    "then a switching of colour 12 is defined by a sequence of distinct vertices @xmath315 such that    * the edge @xmath302 has multiplicity @xmath150 in @xmath127 , where @xmath316 , * each edge @xmath291 is a simple edge in @xmath127 , with multiplicity 1 , for @xmath317 , * the edges @xmath289 and @xmath307 all have multiplicity 0 in @xmath127 for @xmath317 ( that is , they are non - edges ) .",
    "the switching reduces the multiplicity of the edge @xmath302 to @xmath318 , removes the edges @xmath291 , @xmath317 , and inserts the simple edges @xmath289 , @xmath319 for @xmath317 , as shown in figure  [ f : switching12 ] .",
    "= 0.9 cm    ( 9,7.1)(0,0 ) ( 0,0.0 )   ( 1.3,6.5)@xmath150 ( 6.3,6.5)@xmath318    suppose that the multigraph @xmath128 can be formed from @xmath127 by a switching of colour 12 .",
    "the number of ways that a switching of colour 12 can be performed in @xmath127 is at least @xmath320_5 - o(\\kmax^2 e_1(q)^4){\\aftergroup\\egroup\\originalright } ) \\geq            ( e_5(q ) + e_6(q))\\ , m^5,\\ ] ] using lemma  [ mostlyones ] , and the number of ways that @xmath128 can be produced by a switching of colour 12 is at most @xmath321 .",
    "hence we can set @xmath322 and @xmath323 .",
    "this gives @xmath324      switchings of colour 13 are used to reduce the number of simple loops until this number is at most @xmath325 .",
    "they are applied to multigraphs @xmath127 for which switchings of colours @xmath326 do not apply and @xmath327 .",
    "let @xmath127 be such a multigraph .",
    "then a switching of colour 13 is defined by a sequence of distinct vertices @xmath328 such that there is a simple loop on @xmath266 in @xmath127 , the edge @xmath329 is a simple edge in @xmath127 , and the edges @xmath269 , @xmath270 are both absent in @xmath127 ( that is , they have multiplicity zero ) .",
    "the switching removes the simple loop at @xmath266 and the simple edge @xmath175 and inserts the two simple edges @xmath269 , @xmath270 , as shown in figure  [ f : switching13 ] .",
    "= 0.9 cm    ( 9,2.1)(0,0 ) ( 0,0.0 )     suppose that the multigraph @xmath128 can be obtained from @xmath127 by performing a switching of colour 13 .",
    "the number of ways that a switching of colour 13 can be performed in @xmath127 is at least @xmath330 using lemma  [ mostlyones ] , and the number of ways that a switching of colour 13 can produce @xmath128 is at most @xmath331 .",
    "therefore we can define @xmath332 and @xmath333 , leading to @xmath334 using the definition of @xmath335 .",
    "switchings of colour 14 reduce the number of non - loop edges with multiplicity 2 until this number is at most @xmath336 .",
    "this switching is applied to multigraphs @xmath127 such that switchings of colours @xmath337 do not apply and @xmath338 .",
    "let @xmath127 be such a multigraph .",
    "a switching of colour 14 in @xmath127 is described by a sequence @xmath339 of distinct vertices such that    * @xmath302 is an edge of multiplicity 2 in @xmath127 , * @xmath227 and @xmath228 are simple edges in @xmath127 ( with multiplicity 1 ) , * none of the edges @xmath289 or @xmath305 are present in @xmath127 , for @xmath340 ( these are all non - edges , with multiplicity zero ) .    the switching removes these @xmath186 edges and replaces them with two copies of @xmath341 , one on @xmath342 centred at @xmath266 and the other on @xmath343 centred at @xmath344 .",
    "this operation is shown in figure  [ f : switching14 ] .",
    "= 0.9 cm    ( 9,3)(0,0 ) ( 0,0.0 )   ( 1.4,2.85)@xmath345    suppose that the multigraph @xmath128 can be produced from @xmath127 using a switching of colour 14 .",
    "the number of ways to perform a switching of colour 14 in @xmath127 is at least @xmath346_2 - o(\\kmax^2 e_1(q)){\\aftergroup\\egroup\\originalright } ) \\geq   e_2(q ) m^2,\\ ] ] using lemma  [ mostlyones ] , and the number of ways that @xmath128 can be produced using a switching of colour 14 is at most @xmath347 .",
    "therefore we can take @xmath348 and @xmath349 , leading to @xmath350 by the definition of @xmath351 .",
    "switchings of colour 15 are used to reduce the number of non - loop edges with multiplicity 3 until this number is at most @xmath352 .",
    "they are applied to multigraphs @xmath127 such that switchings of colours @xmath353 do not apply and @xmath354 .",
    "let @xmath127 be such a multigraph .",
    "then a switching of colour 15 is defined by a sequence of distinct vertices @xmath355 such that    * @xmath302 has multiplicity 3 in @xmath127 , * each of @xmath291 is a simple edge in @xmath127 , for @xmath288 , * the edges @xmath289 and @xmath307 are absent in @xmath127 for @xmath288 .",
    "the switching removes the edges @xmath291 for @xmath356 ( setting the multiplicity of each to zero ) and inserts the simple edges @xmath289 , @xmath307 for @xmath288 , as illustrated in figure  [ f : switching11 ] for the case that @xmath357 .",
    "suppose that the multigraph @xmath128 can be produced by performing a switching of colour 15 from  @xmath127 .",
    "the number of ways to perform a switching of colour 15 in @xmath127 is at least @xmath358_3 - o(\\kmax^2 e_1(q)^2){\\aftergroup\\egroup\\originalright } ) \\geq   e_3(q ) m^3,\\ ] ] using lemma  [ mostlyones ] , while the number of ways that @xmath128 could be produced using a switching of colour 15 is at most @xmath359 .",
    "therefore we can take @xmath360 and @xmath361 , leading to @xmath362 by the definition of @xmath363 .",
    "we now explain how to apply theorem  [ switchings ] to analyse these switchings on @xmath158 .",
    "( see the statement of theorem  [ switchings ] for the necessary notation . )",
    "we now define a directed graph @xmath79 with vertex set @xmath364 , where @xmath365 is associated with the set @xmath366 containing one object .",
    "these sets are certainly disjoint . by a slight abuse of notation",
    "we will identify @xmath365 and @xmath127 from now on , and write @xmath127 for both . the edge set of @xmath79",
    "is defined as follows : there is an edge @xmath164 in @xmath79 with colour @xmath367 if and only if @xmath128 can be obtained from @xmath127 using a switching of colour  @xmath85 .",
    "since a switching is used only where no switching with a lower - labelled colour applies , there is at most one edge from @xmath127 to @xmath128 in @xmath79 .",
    "hence the endvertices of an edge uniquely determine the colour of the edge .",
    "we take @xmath368 for all @xmath369 , and so for each edge @xmath164 in @xmath79 we have @xmath370 let @xmath371 be as defined in ( [ ydef ] ) , ( [ zdef ] ) .    with notation",
    "as established above , we have @xmath372 [ switchinganalysis ]    it follows from the analysis of the previous sections that @xmath373 , and therefore @xmath374 , for all edges @xmath164 in @xmath79 .",
    "moreover , we have provided at least one switching which can be performed from @xmath127 , for each graph @xmath127 in @xmath375 .",
    "hence @xmath157 and @xmath108 satisfy the requirements of theorem  [ switchings ] and we can conclude that @xmath376 where @xmath377 for all @xmath378 .    since @xmath379 by definition has only non - trivial paths , and @xmath374 for all edges in  @xmath79 , we know that @xmath380 , and therefore @xmath381    now let @xmath95 be a path in @xmath79 from some @xmath382 to some element of @xmath108 , such that all internal vertices of @xmath95 belong to @xmath383 .",
    "let @xmath164 be the first edge in @xmath95 .",
    "then @xmath164 can not have colour in @xmath384 , since these switchings only produce graphs in  @xmath157 . if @xmath164 is coloured with a colour in @xmath385 then @xmath386 , so @xmath387 .",
    "the remaining possibility is that @xmath164 has colour @xmath388 for some @xmath389 , in which case @xmath95 must contain at least @xmath390 edges of colour @xmath388 .",
    "our analysis showed that @xmath391 and hence that @xmath392 , for all such edges  @xmath393 . by definition @xmath394 for @xmath389 .",
    "therefore , @xmath395 which implies that @xmath396 .",
    "we conclude that @xmath397 but @xmath398 , and hence @xmath399 completing the proof .    it remains to obtain an asymptotic expression for @xmath400 , which we do in the next section .",
    "in this section we work in the _ pairing model _ ( also called _ configuration model _ ) , which we now describe .",
    "this model is standard for working with random graphs of fixed degrees : see for example  @xcite .",
    "consider a set of @xmath7 _ points _ partitioned into _ cells _",
    "@xmath401 , where cell @xmath402 contains @xmath19 points for @xmath28 .",
    "take a partition @xmath95 ( called a _ pairing _ ) of the @xmath7 points into @xmath403 _ pairs _ with each pair having the form @xmath404 where @xmath405 and @xmath406 for some @xmath407 .",
    "the set of all such pairings , of which there are @xmath408 , will be denoted by @xmath409 .",
    "a _ loop _ is a pair whose two points lie in the same cell , while a _ link _ is a pair involving two distinct cells .",
    "two pairs are _ parallel _ if they involve the same cells .",
    "parallel class _ is a maximal set of mutually parallel pairs .",
    "the _ multiplicity _ of a parallel class ( and of the pairs in the class ) is the cardinality of the class . as important special cases , a _",
    "simple pair _ is a parallel class of multiplicity one , a _",
    "double pair _ is a parallel class of multiplicity two and a _",
    "triple pair _ is a parallel class of multiplicity three .",
    "each pairing gives rise to a multigraph in @xmath23 by replacing each cell by a vertex , and letting the multiplicity of the edge @xmath410 equal the multiplicity of the parallel class between the corresponding cells .",
    "let @xmath411 be the set of all pairings in @xmath409 with exactly @xmath412 simple loops , exactly @xmath413 double pairs and exactly @xmath55 triple pairs , but with no loops of multiplicity greater than one and no links of multiplicity greater than three .",
    "if @xmath414 can be formed from a pairing @xmath415 , then exactly @xmath416 pairings in @xmath409 give rise to @xmath417 . now defining @xmath418 we can write @xmath419 hence it suffices to obtain an asymptotic expression for the above sum",
    ".    we will need the following two summation lemmas adapted from  @xcite :    [ sumcor ] let @xmath420 and @xmath421 be real numbers .",
    "suppose that there exist integers @xmath422 , @xmath423 with @xmath424 and @xmath425 , and a real number @xmath426 such that @xmath427 and @xmath428 for all @xmath429 $ ] and @xmath430 $ ] .",
    "further suppose that there are real numbers @xmath431 , for @xmath432 , and @xmath433 , for @xmath434 , such that @xmath435 for @xmath432 .",
    "+ given @xmath436 $ ] and @xmath437 $ ] , define @xmath438 by @xmath439 and @xmath440 for @xmath432 .",
    "then @xmath441 where @xmath442    [ sumcor2 ] let @xmath424 be an integer and , for @xmath443 , let real numbers @xmath444 , @xmath445 be given such that @xmath446 and @xmath447 .",
    "define @xmath448 , @xmath449 , @xmath450 and @xmath451 .",
    "suppose that there exists a real number @xmath452 with @xmath453 such that @xmath454 for all @xmath455 $ ] , @xmath456 $ ] .",
    "define @xmath457 by @xmath439 and @xmath458 for @xmath443 .",
    "then @xmath459 where @xmath460    in the proofs of lemmas 4.34.5 , we will use several results which were proved in  @xcite ( specifically , lemmas 4.14.4 of that paper and some details of their proofs ) .",
    "that paper uses values of @xmath461 that differ from ours , but only by bounded factors , and examination of the proofs in  @xcite shows that the results we wish to apply remain valid when our values of @xmath461 are used .",
    "first we perform a summation over the number of edges of multiplicity three .",
    "[ tripcount ] uniformly for @xmath462 and @xmath463 , we have @xmath464    we will apply the proof of  ( * ? ? ? * lemma  4.1 ) .",
    "let @xmath465 be the first value of @xmath466 for which @xmath467 , or @xmath468 if there is no such value . in  ( * ?",
    "* lemma  4.1 ) , a switching is described that converts any pairing in @xmath411 to at least one in @xmath469 , for @xmath470 , so we know that @xmath471 for @xmath472 . in particular , the present lemma is true when @xmath473 , so we assume that @xmath474 .",
    "noting that @xmath475 when the denominators are nonzero , the calculation in  ( * ? ? ?",
    "* lemma  4.1 ) shows that there is some uniformly bounded function @xmath476 such that @xmath477 for @xmath470 , where @xmath478 for @xmath479 and @xmath480 for @xmath481 .",
    "now we can apply lemma  [ sumcor2 ] .",
    "it is clear that @xmath482 by  . if @xmath483 then @xmath484 , while if @xmath485 then the definition of @xmath486 makes it evidently nonnegative .",
    "now define @xmath487 by taking the minimum and maximum of @xmath486 and @xmath488 over @xmath489 .",
    "let @xmath455 $ ] and @xmath456 $ ] , and set @xmath490 . since @xmath491 and @xmath492 , we have that @xmath493 for @xmath7 sufficiently large , by the definition of @xmath363",
    ".    therefore lemma  [ sumcor2 ] applies , and gives an upper bound @xmath494 since @xmath495 and @xmath496 , @xmath497 in the case that @xmath468 , the lower bound given by lemma  [ sumcor2 ] is the same within the stated error term , so we are done .",
    "this leaves the case @xmath498 . by the counts of the second switching in the proof of (",
    "* lemma  4.1 ) , @xmath499 is only possible if @xmath500 .",
    "if this happens for @xmath501 we have @xmath502 however , this implies that @xmath503 so the upper bound matches the trivial lower bound 1 within the error term .",
    "this completes the proof .",
    "next we perform a summation over the number of simple loops .",
    "[ loopcount ] uniformly for @xmath462 , we have @xmath504    let @xmath505 be the first value of @xmath506 for which @xmath507 , or @xmath508 if there is no such value .",
    "in the proof of  ( * ? ? ? * lemma  4.2 ) , a switching is described that converts any pairing in @xmath509 to at least one in @xmath510 , for @xmath511 , so we know that @xmath473 for @xmath512 . in particular , the present lemma is true when @xmath513 , so we assume that @xmath514 .",
    "noting that @xmath515 when the denominators are nonzero , the calculation in  ( * ? ? ?",
    "* lemma  4.2 ) shows that there is some uniformly bounded function @xmath516 such that @xmath517 for @xmath518 , where @xmath519 for @xmath520 and @xmath521 for @xmath522 .",
    "we can now complete the proof using @xmath523 and following the argument used in the previous lemma .",
    "the treatment of the lower bound when @xmath524 needs some additional care . from the analysis of the second switching used in  ( * ? ? ?",
    "* lemma  4.2 ) , @xmath524 can only happen if @xmath525 .",
    "for @xmath526 , the trivial lower bound of 1 matches the upper bound within the stated error terms . if @xmath527 then the first two terms of the summation give the lower bound @xmath528 which matches the upper bound within the stated error terms . in either case , the proof is complete .",
    "next we perform a summation over the number of edges of multiplicity two .",
    "the exponential factor in the summand corresponds to the error term from lemma  [ loopcount ] which depends on @xmath413 .",
    "[ doublecount ] for any constant @xmath529 have @xmath530    let @xmath531 be the first value of @xmath532 for which @xmath533 , or @xmath534 if no such value of @xmath413 exists .",
    "as in the previous two lemmas , the switchings described in  @xcite ( see also  ( * ? ? ? * lemma 4 ) ) show that @xmath513 for @xmath535 . they also show that @xmath536 is only possible if @xmath537 .",
    "in particular , the lemma is true if @xmath538 , so we assume that @xmath539 .",
    "we divide the proof into two cases , following the division used in  ( * ? ? ?",
    "* lemmas 4.34.4 ) . for @xmath462 , define @xmath540    first suppose that @xmath541 . from  ( * ? ? ?",
    "* lemma  4.3 ) we know that for @xmath542 , @xmath543 the current lemma follows from this , arguing as in the proofs of the previous two lemmas .",
    "( note that the term @xmath544 in the answer is absorbed into the error term , by the assumption that @xmath545 . ) in the case that @xmath536 , the condition @xmath537 implies that 1 is a sufficient lower bound .",
    "now suppose that @xmath546 . in this case @xmath537",
    "is not possible for @xmath532 , so @xmath534 and the series contains only positive terms . by  ( * ? ? ?",
    "* lemma  4.4 ) we have for @xmath547 , @xmath548 where @xmath549    b(d ) & = b = -\\frac{8}{m } + \\frac{16m_3}{m_2 ^ 2 } , \\\\[0.4ex ]    \\delta_d & = o\\((d-1)/m_2\\ ) \\,\\,\\ ,",
    "\\text { uniformly for $ 1\\leq d\\leq n_2$}.\\end{aligned}\\ ] ] ( note that @xmath550 equals @xmath551 within the precision afforded by the error term , since @xmath552 . )    now we will apply lemma  [ sumcor ] to  @xmath553 .",
    "let @xmath554 and @xmath555 , with the minimum and maximum taken over @xmath547 , and let @xmath556 .",
    "define @xmath557 and @xmath558 .",
    "then the conditions of lemma  [ sumcor ] apply with @xmath559 and some value of @xmath560 which satisfies @xmath561 .",
    "application of that lemma now gives the desired result .",
    "recall the definition of @xmath562 , @xmath563 , @xmath564 given just before the statement of theorem  [ main ] . by combining the last three summations we obtain the following .    [ allcount ] as @xmath40 and @xmath41 ,",
    "we have @xmath565    from lemmas  [ tripcount ] and [ loopcount ] , we have @xmath566 uniformly over @xmath413 .",
    "if @xmath567 , we are finished .",
    "if @xmath568 , choose two constants @xmath569 such that the actual value of the error term @xmath570 in   lies in @xmath571 $ ] for all @xmath572 . applying lemma  [ doublecount ] with @xmath573 and noting that the result does not depend on  @xmath529 within the precision given by the error term",
    ", we are done .",
    "finally we can prove our main result .",
    "from lemma  [ switchinganalysis ] and lemma  [ allcount ] together with ( [ counting - pairings ] ) , we obtain @xmath574 now @xmath575 , and it follows from  ( * ? ? ?",
    "* lemma 5.1 ) that @xmath576 combining these two expressions completes the proof .",
    "let @xmath577 be a probability which we will define later . abusing notation slightly , we define the functions @xmath578 and the probability generating functions @xmath579 consider a random symmetric nonnegative integer matrix @xmath580 which is created as follows :    * all entries on and above the diagonal are independent ; * for @xmath581 , let @xmath582 be a randomly chosen element of @xmath10 , with + @xmath583 for all @xmath584 ; * for @xmath585 let @xmath586 be a randomly chosen element of @xmath11 , with + @xmath587 for all @xmath588 ; * finally , let @xmath589 for @xmath585 .",
    "we write @xmath590 to mean probabilities generated by the above procedure .",
    "if @xmath591 is a fixed matrix which corresponds to an element of @xmath592 then the probability that @xmath591 is produced by the above procedure is @xmath593 this follows as the probability of @xmath591 depends only on the sum of the diagonal and above - diagonal entries ( that is , on the number of edges of the corresponding multigraph ) .    for @xmath581 ,",
    "let @xmath594 denote the event that the sum of row @xmath70 equals @xmath19 , recalling that diagonal entries are weighted by a factor of 2 as in  .",
    "now @xmath595 since @xmath590 is uniform on ( the set of matrices corresponding to ) @xmath592 . by ( incorrectly )",
    "assuming that the events @xmath596 are independent , we obtain the following nave estimate of @xmath597 , using ( [ fred ] ) : @xmath598 \\,f(z)^{n-1 } g(z^2 ) \\notag \\\\   & = p^{-m/2}\\ , j(1)^{-\\binom{n}{2 } }     \\ , \\prod_{i=1}^n \\ , [ z^{k_i}]\\ ,   j(z)^{n-1 } j^*(z^2).\\label{gnaive}\\end{aligned}\\ ] ]    let @xmath599 denote the target average row sum .",
    "the value @xmath600 of @xmath601 which makes the expected row sum equal to @xmath71 satisfies @xmath602 we write @xmath603 for @xmath604 from now on .",
    "( as we shall see , the exact value of the @xmath605 term does not affect theorem  [ reformulate ] below , within the stated error bound , even though some of the intermediate formulae we give in the proof are affected . )",
    "we now compare the expression given in theorem  [ main ] with the nave estimate @xmath603 . for future applications",
    ", it will be convenient to express the result in terms of the scaled central moments @xmath606 , @xmath607 defined by @xmath608 for @xmath609 .        to calculate the product in ( [ gnaive ] )",
    "we consider two cases , depending on the value of  @xmath563 .",
    "first assume that @xmath567 ( that is , the value 2 is not permitted off the diagonal ) . then @xmath615 where @xmath616 consequently , for any integer @xmath617 with @xmath618 we have @xmath619\\ , & j(z)^{n-1}j^*(z^2)\\ ,     = \\ , \\sum_{j=0}^r \\binom{n-1}{r - j}p^{r - j } \\ , [ z^j ] h_0(z ) \\notag\\\\     & = \\binom{n-1}{r } p^r          + \\binom{n-1}{r-2 } y_1 p^{r-1 } + \\binom{n-1}{r-3 } \\",
    ", x_3(n-1)p^r   +           \\binom{n-1}{r } p^r \\vardelta_0,\\label{zrjj}\\end{aligned}\\ ] ] where @xmath620 h_0(z).\\ ] ] now define @xmath621 notice that the coefficients of @xmath622 , when expanded as a taylor series in @xmath623 , are nonnegative and dominate those of @xmath624 .",
    "also notice that @xmath625 uniformly for @xmath626 , since @xmath627 .",
    "therefore , setting @xmath628 , @xmath629h_0^+(z)\\\\         & = o\\ ( h_0^+(\\alpha ) - 1 - p\\alpha^2 - ( n-1)p^3\\alpha^3\\).\\end{aligned}\\ ] ] since @xmath630 , by taylor s theorem we can write @xmath631 substituting this into the definition of @xmath632 , we find that @xmath633 and so @xmath634 applying this bound to  , we have @xmath635&\\,j(z)^{n-1}j^*(z^2 ) \\notag\\\\       & = \\binom{n-1}{r } p^r \\exp\\biggl ( \\frac{y_1r(r-1)}{kn }                   + \\frac{x_3 r^3}{n^2 }   + o(r\\kmax^3/m^2 ) \\biggr)\\notag \\\\       & = \\frac{n^r p^r}{r ! } \\exp\\biggl ( -\\frac{r(r+1)}{2n } + \\frac{y_1r(r-1)}{kn }                   + \\frac { r^3(6x_3 - 1)}{6n^2 } + o(r\\kmax^3/m^2 ) \\biggr ) .                      \\label{x=0case}\\end{aligned}\\ ] ]    now we assume that @xmath568 and perform a similar calculation . we have @xmath636 where @xmath637 we find that for any @xmath617 with @xmath638 , @xmath635\\,j(z)^{n-1}j^*(z^2 )     & = \\binom{n+r-2}{r } p^r   + \\binom{n+r-4}{r-2 } y_1 p^{r-1 } \\\\   & { \\quad}+ \\binom{n+r-5}{r-3 } ( x_3 - 1 ) ( n-1)\\ , p^r      + \\binom{n+r-2}{r}\\ , p^r   \\vardelta_1,\\end{aligned}\\ ] ] where @xmath639 h_1(z).\\ ] ] the coefficients of @xmath640 are dominated by those of @xmath641 , where @xmath642 arguing as before , this implies that @xmath643 , and so we have @xmath644\\,j(z)^{n-1}j^*(z^2 )       & = \\binom{n+r-2}{r } p^r \\exp\\biggl ( \\frac{y_1r(r-1)}{kn }                   + \\frac{(x_3 - 1 ) r^3}{n^2 }   + o(r\\kmax^3/m^2 ) \\biggr)\\notag \\\\       & { \\kern-1.2cm}=\\frac{n^r p^r}{r ! } \\exp\\biggl ( \\frac{r(r-3)}{2n } + \\frac{y_1r(r-1)}{kn }                   + \\frac { r^3(6x_3 - 7)}{6n^2 } + o(r\\kmax^3/m^2 ) \\biggr ) .",
    "\\label{x=1case } \\end{aligned}\\ ] ] combining the cases and we have , for @xmath581 , @xmath645\\ , j(z)^{n-1}j^*(z^2 ) & = \\frac{n^{k_i}\\ , p^{k_i}}{{k_i } ! } \\exp\\biggl (     - \\biggl(\\frac{1 + 2x_2}{2n }   + \\frac{y_1}{kn}\\biggr)\\ , k_i -    \\biggl(\\frac{1 - 2x_2}{2n } - \\frac{y_1}{kn}\\biggr)\\ , k_i^2 \\notag \\\\   & \\hspace*{3.5 cm }   - \\frac{1 + 6x_2 - 6x_3}{6n^2}\\ , k_i^3    + o(k_i\\kmax^3/m^2)\\biggr ) .",
    "\\end{aligned}\\ ] ] multiplying these @xmath5 equations together gives @xmath646&\\ , j(z)^{n-1}j^*(z^2 ) \\notag\\\\ & = \\frac{n^m p^m}{\\prod_{i=1}^n k_i!}\\ ,    \\exp\\biggl (   \\frac{m_2(2x_2 - 1 ) -2 m } { 2n } + \\frac{y_1 m_2}{kn }   \\notag \\\\    &   \\hspace*{40 mm }   { }      - \\frac{(6x_2 - 6x_3 + 1)m_3}{6n^2 } + o(\\kmax^3/m)\\biggr ) .",
    "\\label{rowexp}\\end{aligned}\\ ] ]    we now substitute ( [ pexp ] ) , ( [ jexp ] ) and ( [ rowexp ] ) into ( [ gnaive ] ) . writing the result in terms of @xmath606 , @xmath607 , @xmath7 and @xmath5 , using the identities @xmath647",
    "we find that @xmath648 ( at this point we can observe that no remaining terms depend on @xmath85 , which verifies our earlier claim that the exact value of the @xmath605 term in ( [ pdef ] ) does not affect the statement of this theorem . ) the proof is completed by applying theorem  [ main ] and using stirling s formula .",
    "[ naive - corollary ] under the conditions of theorem  [ reformulate ] , if @xmath649 then @xmath650 if the stronger bound @xmath651 holds then @xmath652 finally , if @xmath653 is a regular degree sequence with @xmath44 even , then @xmath654    for the first two statements , we just need to check that all additional terms inside the exponential factor in theorem  [ reformulate ] are covered by the claimed error bounds .",
    "for this it is useful to note that @xmath655 and @xmath656 .",
    "finally , when @xmath9 is a regular degree sequence we have @xmath657 and follows .",
    "the constant @xmath658 in   was previously noted for simple sparse regular graphs in  @xcite , and in  @xcite for simple sparse regular graphs with loops allowed .",
    "interestingly , with different error terms , the same constant was observed in  @xcite for dense simple regular graphs , in  @xcite for dense simple regular graphs with loops allowed , and in  @xcite for dense symmetric integer matrices with zero diagonal . in these three cases , we conjectured that   holds ( with some vanishing error term ) for all degree sequences except for the two extreme cases of graphs with no edges and graphs with all possible edges .",
    "the corresponding conjectures may be less likely to be true in full generality for all @xmath21 .",
    "from the first expression of corollary  [ naive - corollary ] , we see that @xmath597 is closely approximated by @xmath659 whenever @xmath606 is close to 1 .",
    "it appears that , in the random matrix model described at the start of this section , @xmath606 will be concentrated around 1 with high probability whenever @xmath601 tends to zero slowly enough to ensure that @xmath40 with high probability , but quickly enough to ensure that @xmath660 with high probability .",
    "if so , this will lead to a model for the degree sequences of sparse multigraphs analogous to that obtained by mckay and wormald  @xcite for graphs , and by mckay and skerman  @xcite for bipartite graphs and directed graphs .",
    "details will be given in a future paper ."
  ],
  "abstract_text": [
    "<S> let @xmath0 and @xmath1 be subsets of @xmath2 such that @xmath3 and @xmath4 . for infinitely many @xmath5 , let @xmath6 be a vector of nonnegative integers whose sum @xmath7 is even . </S>",
    "<S> we find an asymptotic expression for the number of multigraphs on the vertex set @xmath8 with degree sequence given by  @xmath9 , such that every loop has multiplicity in  @xmath1 and every non - loop edge has multiplicity in  @xmath0 . </S>",
    "<S> equivalently , these are symmetric integer matrices with values @xmath10 allowed on the diagonal and @xmath11 off the diagonal . </S>",
    "<S> our expression holds when the maximum degree @xmath12 satisfies @xmath13 . </S>",
    "<S> we prove this result using the switching method , building on an asymptotic enumeration of simple graphs with given degrees ( mckay and wormald , 1991 ) . </S>",
    "<S> our application of the switching method introduces a novel way of combining several different switching operations into a single computation . </S>"
  ]
}