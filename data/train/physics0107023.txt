{
  "article_text": [
    "maxwell s partial differential equations of electromagnetism describe the evolution of electric and magnetic fields in time and space  @xcite .",
    "they apply to a wide range of different physical situations that are specified by the boundary conditions on the electromagnetic ( em ) fields . in many cases ,",
    "numerical methods are required to solve maxwell s equations , either in the frequency or time domain . for the time domain ,",
    "a well - known class of algorithms is based on a method proposed by yee  @xcite and is called the finite - difference time - domain ( fdtd ) method .",
    "the fdtd method has matured during past years and various algorithms implemented for specific purposes are available by now  @xcite .",
    "these algorithms owe their popularity mainly due to their flexibility and speed while at the same time they are easy to implement .",
    "a limitation of yee - based fdtd techniques is that the stability of the algorithms is conditional .",
    "the stability depends on the mesh size used to discretize space and the time step used to perform the time integration  @xcite .    in this paper",
    "we present a family of unconditionally stable algorithms that solve the time - dependent maxwell equations ( tdme ) through the application of orthogonal transformations . that this is possible follows from the representation of the tdme in matrix form . the exponential of a skew - symmetric matrix plays the role of the time - evolution operator of the em fields .",
    "this time - evolution operator is orthogonal .",
    "the key to the construction of an unconditionally stable algorithm to solve the maxwell equations is the observation that orthogonal approximations to this operator automatically yield unconditionally stable algorithms .",
    "the lie - trotter - suzuki product formulae  @xcite provide the mathematical framework to construct orthogonal approximations to the time - evolution operator of the maxwell equations .",
    "however , this framework does not specify how to implement the algorithm .",
    "recently , a spectral - domain split - operator technique has been proposed to solve the tdme  @xcite .",
    "the split - operator approach is based on one of the many forms of the lie - trotter - suzuki product formulae .",
    "the spectral - domain method makes use of fast fourier transforms to compute the matrix exponentials of the displacement operators . the choice made in ref .",
    "@xcite yields an approximation to the time - evolution operator that is no longer orthogonal and hence unconditional stability is not automatically guarantueed  @xcite .",
    "in contrast , the methodology that we propose yields efficient , explicit , unconditionally stable schemes that operate on the em fields defined on the real space grid only .",
    "this renders the algorithms rather flexible , avoids wrap - around effects  @xcite , and naturally allows for the spatial variations in both the permittivity and the permeability .",
    "on the other hand , the implementation described in this paper is by no means unique and leaves a lot of room for further improvements .    for em fields in a homogeneous medium , zheng et al",
    ". showed that there is an alternating - direction - implicit ( adi ) time - stepping algorithm that is unconditionally stable @xcite .",
    "conceptually this approach is different from ours .",
    "the fourier - mode stability analysis performed by zheng et al.@xcite does not generalize to the case of spatially varying permittivity and permeability whereas in our approach , the algorithms are unconditionally stable by construction .",
    "our presentation is organized as follows : the basic theoretical concepts are given in sec .",
    "[ sec2 ] . in sec .",
    "[ sec3 ] we explain the general philosophy that underlies the suzuki approach to construct algorithms that are unconditionally stable . in sec .",
    "[ sec4 ] , we show in detail how to implement these ideas for the case of the tdme in one , two and three spatial dimensions , using algorithms that are accurate up to second and fourth order in the time step . in sec .",
    "[ sec5 ] we explain how we analyze the data generated by these algorithms . in sec .",
    "[ sec6 ] we present the results of numerical simulations for the physical systems that we selected as examples to test the algorithms .",
    "our conclusions are given in sec .",
    "the model system we consider in this paper describes em fields in a @xmath0-dimensional ( @xmath1 ) medium with spatially varying permittivity and/or permeability , surrounded by a perfectly conducting box . in the absence of free charges and currents , the em fields in such",
    "a system satisfy maxwell s equations  @xcite @xmath2 { \\frac{\\partial}{\\partial t}}\\,{\\be } & = & \\;\\;\\;\\frac{1}{{\\varepsilon } } \\nabla \\times { \\bh}\\ , , \\label{max2}\\\\[0.3 cm ] { \\rm div}\\,{\\varepsilon}\\be & = & 0\\ , , \\label{max3}\\\\[0.3 cm ] { \\rm div}\\,\\bh & = & 0\\ , , \\label{max4}\\end{aligned}\\ ] ] where @xmath3 and @xmath4 denote the magnetic and electric field vector respectively .",
    "the permeability and the permittivity are given by @xmath5 and @xmath6 .",
    "for simplicity of notation , we will omit the spatial dependence on @xmath7 unless this leads to ambiguities . on the surface of the perfectly conducting box",
    "the em fields satisfy the boundary conditions  @xcite @xmath8 with @xmath9 denoting the vector normal to a boundary of the surface .",
    "the conditions eq .  ( [ boundcond ] ) assure that the normal component of the magnetic field and the tangential components of the electric field vanish at the boundary  @xcite .",
    "some important symmetries of the maxwell equations ( [ max1])-([max4 ] ) can be made explicit by introducing the fields @xmath10 in terms of the fields @xmath11 and @xmath12 , the tdme ( eqs.([max1 ] ) and ( [ max2 ] ) ) read @xmath13 writing @xmath14 , eq .",
    "( [ eqn : mtxeqn ] ) becomes @xmath15 it is easy to show that @xmath16 is skew - symmetric , i.e. @xmath17 , with respect to the inner product @xmath18 where @xmath19 denotes the volume of the enclosing box .",
    "the formal solution of eq .",
    "( [ tdme ] ) is given by @xmath20 where @xmath21 represents the initial state of the em fields and the operator @xmath22 determines their time evolution . by construction @xmath23 \\ , d{\\br } , \\label{normpsi}\\ ] ] relating the length of @xmath24 to the energy density @xmath25 of the em fields  @xcite . from @xmath26",
    "it follows that @xmath27 .",
    "hence the time - evolution operator @xmath28 is an orthogonal transformation , rotating the vector @xmath24 without changing its length @xmath29 . in physical terms",
    "this means that the energy density of the em fields does not change with time , as expected on physical grounds  @xcite .",
    "the fact that @xmath28 is an orthogonal transformation is essential for the development of an unconditionally stable algorithm to solve the maxwell equations . in practice , a numerical procedure solves the tdme by making use of an approximation @xmath30 to the true time evolution @xmath28 ( see below ) . a necessary and sufficient condition for an algorithm to be unconditionally stable",
    "is that  @xcite @xmath31 in other words , the length of @xmath24 should be bounded , for arbitrary initial condition @xmath32 and for any time @xmath33  @xcite . by chosing for @xmath21 the eigenvector of @xmath30 that corresponds to the largest eigenvalue of @xmath30",
    ", it follows from eq .",
    "( [ uncond ] ) that the algorithm will be unconditionally stable by construction if and only if the largest eigenvalue of @xmath30 ( denoted by @xmath34 ) is less or equal than one  @xcite .",
    "if the approximation @xmath30 is itself an orthogonal transformation , then @xmath35 and the numerical scheme will be unconditionally stable .    summarizing : unconditionally stable algorithms to solve eq .",
    "( [ eqn : mtxeqn ] ) can be constructed by employing orthogonal approximations to the time - evolution @xmath36 . for the case at hand , unconditional stability",
    "is tantamount to the exact conservation of the energy density .",
    "a numerical procedure that solves the tdme necessarily starts by discretizing the spatial derivatives ( see sec.[sec4 ] ) .",
    "this maps the continuum problem described by @xmath16 onto a lattice problem defined by a matrix @xmath37 .",
    "ideally , this mapping should not change the basic symmetries of the original problem .",
    "the underlying symmetry of the tdme suggests to use matrices @xmath37 that are real and skew - symmetric .",
    "formally the time evolution of the em fields on the lattice is given by @xmath38 the second ingredient of the numerical procedure is to choose an approximation of the time - step operator @xmath39 .",
    "a standard procedure is to truncate the taylor series of the matrix exponential  @xcite @xmath40 retaining terms up to first order in @xmath41 yields @xmath42 where @xmath43 denotes the identity operator . as @xmath44 for @xmath45 ,",
    "it is clear that the matrix eq .",
    "( [ approxu0 ] ) is not orthogonal . making use of the symmetry of @xmath37 and the positivity of the inner product , we find that @xmath46 , implying that eq .",
    "( [ uncond ] ) does not hold . hence , according to the arguments given above , the ( euler ) scheme eq .",
    "( [ approxu0 ] ) is unstable , a fact which is of course well - known  @xcite .",
    "the yee algorithm is based on a leapfrog arrangement  @xcite and formally corresponds to an approximation to the matrix exponential @xmath39 that can be written as @xmath47 where @xmath48 and @xmath49 are matrices , the structure of which depend on the lattice dimensionality .",
    "the presence of the second order contribution can render the algorithm stable under certain conditions .",
    "it seems difficult to determine these conditions for arbitrary ( skew - symmetric ) @xmath48 and ( symmetric ) @xmath49 , i.e. without making use of very specific knowledge about the elements of @xmath48 and @xmath49 . for em fields moving in free space , a fourier - space stability analysis of the yee algorithm yields    @xmath50    as the condition for stability  @xcite . here",
    "@xmath51 is the light velocity in vacuum and @xmath52 denotes the spatial mesh size  @xcite .",
    "a systematic approach to construct orthogonal approximations to matrix exponentials , i.e. to construct unconditionally stable algorithms , is to make use of the lie - trotter - suzuki formula  @xcite @xmath53 and generalizations thereof  @xcite .",
    "applied to the case of interest here , the success of this approach relies on the basic but rather trivial premise that the matrix @xmath37 can be written as @xmath54 where each of the matrices @xmath55 is real and skew - symmetric .",
    "the expression eq .",
    "( [ trot ] ) suggests that @xmath56 might be a good approximation to @xmath39 if @xmath41 is sufficiently small .",
    "most importantly , if all the @xmath57 are real and skew - symmetric , @xmath58 is orthogonal by construction . therefore , by construction , a numerical scheme based on eq .",
    "( [ tsapprox ] ) will be unconditionally stable . using the fact that both @xmath39 and @xmath58 are orthogonal matrices , it can be shown that  @xcite @xmath59\\|\\ , , \\label{tserror}\\ ] ] where @xmath60=h_i h_j - h_j h_i$ ] . from eq .",
    "( [ tserror ] ) it follows that , in general , the taylor series of @xmath39 and @xmath58 are identical up to first order in @xmath41 .",
    "we will call @xmath58 a first - order approximation to @xmath39 .    the product - formula approach provides simple , systematic procedures to improve the accuracy of the approximation to @xmath39 without changing its fundamental symmetries . for example",
    "the orthogonal matrix @xmath61 is a second - order approximation to @xmath39  @xcite .",
    "suzuki s fractal decomposition approach  @xcite gives a general method to construct higher - order approximations based on @xmath58 or @xmath62 .",
    "a particularly useful fourth - order approximation is given by  @xcite @xmath63 where @xmath64 .",
    "the approximations eqs.([tsapprox ] ) and ( [ secordapp ] ) , and ( [ fouordapp ] ) have proven to be very useful in many applications  @xcite and , as we show below , turn out to be equally useful for solving the tdme . in practice",
    "an efficient implementation of the first - order scheme is all that is needed to construct the higher - order algorithms eqs.([secordapp ] ) and ( [ fouordapp ] ) .",
    "to summarize : suzuki s product - formula approach provides the formal machinery to define algorithms that are unconditionally stable by construction .",
    "the accuracy of these algorithms can be improved systematically , to any desired order  @xcite .",
    "the only assumption made so far is that the real , skew - symmetric matrix @xmath37 representing the tdme can be written as a sum of @xmath65 real , skew - symmetric matrices @xmath57 .",
    "the next step is to choose the @xmath57 s such that the matrix exponentials @xmath66 , ... , @xmath67 can be calculated efficiently .",
    "this will turn the formal expressions for @xmath62 and @xmath68 into efficient algorithms to solve the tdme .",
    "in this section we present the details of our implementation of unconditionally stable algorithms to solve the tdme based on the suzuki product - formula approach . for pedagogical reasons",
    "we start by considering the simplest case : a one - dimensional ( 1d ) system .",
    "then we show that the strategy adopted for 1d readily extends to higher spatial dimensions .",
    "the implementation we describe below is by no means unique , leaving a lot of room for further improvements . in principle",
    "any decomposition eq .",
    "( [ decompos ] ) of @xmath37 into real skew - symmetric parts will do .",
    "largely guided by previous work  @xcite , we have adopted a decomposition that is efficient , flexible , sufficiently accurate and easy to program .",
    "we consider a 1d system along the @xmath69-direction .",
    "accordingly , maxwell s equations contain no partial derivatives with respect to @xmath70 or @xmath71 and @xmath72 and @xmath73 do not depend on @xmath70 or @xmath71 . under these conditions ,",
    "the tdme reduce to two independent sets of first - order differential equations  @xcite .",
    "the solutions to these sets are known as the transverse electric ( te ) mode and the transverse magnetic ( tm ) mode  @xcite . as the equations of",
    "the te- and tm - mode only differ by a sign we can restrict our considerations to the tm - mode and obtain the result for the te - mode by reversing the time .    from eq .",
    "( [ eqn : mtxeqn ] ) it follows that the magnetic field @xmath74 and the electric field @xmath75 of the tm - mode are solutions of @xmath76 note that in 1d , the divergence of @xmath77 and @xmath78 is zero . hence eqs.([max3 ] ) and",
    "( [ max4 ] ) are automatically satisfied .    using the second - order central - difference approximation to the first derivative with respect to @xmath69 , we obtain @xmath79 where the integer @xmath80 labels the grid points and @xmath81 denotes the distance between two next - nearest neighbor lattice points ( hence the absence of a factor two in the nominator ) . for notational simplicity we will , from now on , specify the spatial coordinates through the lattice index @xmath80 , e.g. @xmath82 stands for @xmath83 .",
    "( 8.0,1.6 ) ( 0.5,0 )    following yee  @xcite it is convenient to assign @xmath82 and @xmath84 to the odd , respectively , even numbered lattice site , as shown in fig .",
    "[ fig : fig1 ] for a grid of @xmath85 points .",
    "the equations ( [ eqn : discrtmx ] ) and ( [ eqn : discrtmy ] ) can now be combined into one equation of the form eq .",
    "( [ tdme ] ) by introducing the @xmath85-dimensional vector @xmath86 the vector @xmath24 describes both the magnetic and the electric field on the lattice points @xmath87 . as usual the @xmath80-th element of @xmath24 is given by the inner product @xmath88 where @xmath89 denotes the @xmath80-th unit vector in the @xmath85-dimensional vector space .",
    "using this notation , it is easy to show that eqs.([eqn : discrtmx ] ) and ( [ eqn : discrtmy ] ) reduce to @xmath90 where the matrix @xmath37 is given by @xmath91\\ , , \\label{eqn : oper_1d}\\ ] ] with @xmath92 and the prime indicates that the sum is over odd integers only . in complete analogy to eq .",
    "( [ eqn : formal ] ) the time evolution of @xmath24 is formally given by @xmath93 with @xmath94 .",
    "the notation introduced above will prove most useful for the case of 2d and 3d for which it is rather cumbersome to write down matrix representations .",
    "for the 1d case it is not difficult and in fact very instructive to write down the matrix @xmath37 explicitly .",
    "indeed , we have @xmath95 and we immediately see that @xmath37 is skew - symmetric by construction .",
    "furthermore , for @xmath85 odd we have @xmath96 such that the electric field vanishes at the boundaries ( @xmath97 , see also fig .",
    "[ fig : fig1 ] ) , as required by the boundary conditions eq .",
    "( [ boundcond ] ) . for this reason we only consider the case of @xmath85 odd in the sequel .    according to the general procedure outlined in sec.[sec3 ] ,",
    "the final step in the construction of an unconditionally stable algorithm is to decompose @xmath37 .",
    "guided by previous work on schrdinger and diffusion problems  @xcite , we split @xmath37 into two parts , i.e. @xmath98 , where @xmath99 i.e. we divide the lattice into odd and even numbered cells . in matrix notation",
    "we have @xmath100 and @xmath101 clearly both @xmath102 and @xmath103 are skew - symmetric block - diagonal matrices , containing one @xmath104 matrix and @xmath105 real , @xmath106 skew - symmetric matrices .    according to the general theory given above , the first - order algorithm defined by @xmath107 is all that is needed to construct unconditionally stable second and higher - order algorithms .",
    "as the matrix exponential of a block - diagonal matrix is equal to the block - diagonal matrix of the matrix exponentials of the individual blocks , the numerical calculation of @xmath108 ( or @xmath109 ) reduces to the calculation of @xmath105 matrix exponentials of @xmath106 matrices .",
    "the matrix exponential of a typical @xmath106 matrix appearing in @xmath108 or @xmath109 is given by @xmath110 \\left(\\begin{array}{c } \\psi(i , t ) \\\\",
    "\\psi(j , t ) \\end{array } \\right ) \\label{twobytwo } & = & \\left ( \\begin{array}{cc } { \\phantom{+}}\\cos \\alpha & { \\phantom{+}}\\sin\\alpha \\\\ -\\sin \\alpha & { \\phantom{+}}\\cos\\alpha \\end{array}\\right ) \\left(\\begin{array}{c } \\psi(i , t ) \\\\ \\psi(j , t ) \\end{array } \\right).\\end{aligned}\\ ] ]      assuming translational invariance with respect to the @xmath71 direction , the system effectively becomes 2d and the tdme separate into two sets of equations  @xcite . for conciseness , in this section",
    "we only discuss the set of equations for the tm - modes .",
    "the te - modes can be treated in exactly the same manner .",
    "the relevant em fields for the tm - modes in 2d are @xmath111 , in terms of which tdme eq.([eqn : mtxeqn ] ) reads @xmath112 we discretize continuum space by simply re - using the one - dimensional lattice introduced above , as exemplified in fig .",
    "[ fig:2dtm ] for the case of the tm - modes .",
    "this construction automatically takes care of the boundary conditions if @xmath113 and @xmath114 are odd and yields a real skew - symmetric matrix @xmath37 .",
    "( 9.15,5.8 ) ( 0.5,0 )    in analogy with the 1d case the elements of @xmath24 are defined by @xmath115 discretization of the differential operators that appear in eq .",
    "( [ eqn:2dtm ] ) yield expressions that have the same structure as eq .",
    "( [ h ] ) , with extra subscripts to account for the second spatial dimension .",
    "it follows that on the lattice , @xmath116\\psi(t ) , \\label{2dsplit}\\ ] ] where @xmath117 and the superscripts @xmath118 and @xmath119 refer to the derivative with respect to @xmath69 and @xmath70 respectively .",
    "note that we use the pair @xmath120 to label the @xmath121 unit vectors @xmath122 . in complete analogy with the 1d case we split eqs.([eqn:2dsplit_discr_x ] ) and ( [ eqn:2dsplit_discr_y ] ) into two parts and obtain for the first - order approximation to @xmath39 @xmath123 where for instance , in formal analogy to eq .",
    "( [ h2 ] ) , we have @xmath124 it is not difficult to convince oneself that approximation @xmath58 and hence also @xmath62 and @xmath68 do not commute with the ( lattice version of ) the divergence",
    ". therefore the divergence of the em fields in 2d is not conserved .",
    "although the initial state ( at @xmath125 ) of the em fields satifies eqs.([max3 ] ) and ( [ max4 ] ) , time - integration of the tdme using @xmath126 yields a solution that will not satisfy eqs.([max3 ] ) and ( [ max4 ] ) .",
    "however , for algorithm @xmath126 the deviations from zero vanish as @xmath127 so that in practice these errors are under control and can be made sufficiently small for practical purposes .      in terms of @xmath14 for a 3d system , eq .",
    "( [ eqn : mtxeqn ] ) reads @xmath128 where @xmath129 is given by @xmath130 we discretize the spatial coordinates by adopting the standard yee grid  @xcite .",
    "we show a unit cell of this grid in fig .",
    "[ fig:3d ] .",
    "( 7,6.2 ) ( 0.5,0 )    in analogy to the systems in 1d and 2d , we assign the em fields to the lattice points such that the boundary conditions eq .",
    "( [ boundcond ] ) are automatically satisfied .",
    "the elements of the vector @xmath131 are given by @xmath132 for the origin of the coordinate system @xmath133 at the center of the unit cell shown in fig .",
    "[ fig:3d ] .",
    "the number of lattice points in the @xmath69 , @xmath70 , and @xmath71 direction will be denoted by @xmath113 , @xmath114 , and @xmath134 respectively . as before these numbers are assumed to be odd .",
    "discretization of the differential operators that appear in eq .",
    "( [ h ] ) yields eq .",
    "( [ eqn : mtxeqn ] ) in the form @xmath135\\psi(t ) , \\label{3dsplit}\\ ] ] where the superscripts @xmath118 , @xmath119 and @xmath136 refer to the derivative with respect to @xmath69 , @xmath70 and @xmath71 respectively , @xmath137 and the expressions for @xmath138 and @xmath139 follow from eq .",
    "( [ hx ] ) by symmetry .",
    "note that we use the triple @xmath140 to label the @xmath141 unit vectors @xmath142 .    in complete analogy with the 1d and 2d case we split eq .",
    "( [ hx ] ) ( as well as @xmath138 and @xmath139 ) in two parts and obtain for the first - order approximation to @xmath39 @xmath143 where for instance @xmath144 note that each contribution to eq .",
    "( [ h1z ] ) acts on a different pair of elements of @xmath24 .",
    "hence each of the matrix exponentials in eq .",
    "( [ u1d3 ] ) acts on one quarter of all the lattice points .",
    "performing the time - step operation eq .",
    "( [ u1d3 ] ) involves only two sweeps over all lattice points .    by construction",
    "the algorithm defined by eq .  ( [ u1d3 ] ) is unconditionally stable and so are the higher - order algorithms defined by @xmath145 ) and @xmath68 .",
    "each contribution to e.g. eq .",
    "( [ h1z ] ) is of the form eq .",
    "( [ h1 ] ) and hence its matrix exponential can be calculated in exactly the same manner as in the 1d case ( see eq .  ( [ twobytwo ] ) ) .",
    "the divergence of the em fields in 3d is , for the same reason as in the 2d case , not conserved but decreases as @xmath127 .",
    "the notation required to write down the algorithms in mathematical form might give the impression that these algorithms are difficult to program .",
    "actually that is not the case , on the contrary .",
    "recall that the first - order algorithm @xmath58 is all we need to program : as explained in sec .",
    "[ sec3 ] , more accurate schemes can be implemented without extra programming .",
    "let us consider the algorithm for the case of 1d .",
    "for 2d and 3d we simply repeat the steps described below two , respectively , three times .",
    "we have @xmath146\\right\\ } \\left\\{\\mathop{{\\prod}'}_{i=1}^{n } \\exp\\left[\\beta_{i+1,i+2}\\left ( \\be^{{\\phantom{t}}}_{i+1}\\be^t_{i+2}- \\be^{{\\phantom{t}}}_{i+2}\\be^t_{i+1 } \\right)\\right]\\right\\}. \\label{u1d}\\end{aligned}\\ ] ] where we used the block - diagonal structure of @xmath48 and @xmath49 ( see eqs.([h1 m ] ) and ( [ h2 m ] ) ) to obtain an exact expression for @xmath58 in terms of an ordered product of matrix exponentials .",
    "each of these matrix exponentials only operates on a pair of elements of @xmath24 and leaves other elements intact .",
    "the indices of each of these pairs are given by the subscripts of @xmath147 and @xmath148 . from eq.([u1d ] ) it is then clear what the program should do : make loops over @xmath80 with stride 2 .",
    "for each @xmath80 pick a pair of elements from @xmath24 according to the subscripts of @xmath147 and @xmath148 , compute ( or fetch from memory ) the elements of the plane rotation ( see eq .",
    "( [ twobytwo ] ) ) , perform the plane rotation , i.e. multiply the @xmath106 matrices and the vectors of length two , and overwrite the same two elements .",
    "it also follows immediately that performing a time step with algorithms based on eq .",
    "( [ u1d ] ) takes @xmath149 plane rotations where @xmath150 is the total number of elements of the vector @xmath24 ( which is less or equal to the number of grid points ) .",
    "this renders the algorithm efficient : the number of operations to complete one time step scales linearly with the number of grid points .",
    "also note that there is a high degree of intrinsic parallelism in this class of algorithms . in principle ,",
    "the @xmath105 matrix - vector multiplications that implement @xmath108 or @xmath109 can be done in parallel .    in the absence of external currents ( see below ) , updating the em field values of a 3d system using the the yee algorithm requires 6 arithmetic operations ( see eq.(33 ) in ref.@xcite ) whereas the second - order algorithm @xmath62 requires 33 arithmetic operations . for 1d and 2d problems the ratio is 9/4 and 21/6 respectively .",
    "thus , in terms of cpu time , the price paid for the unconditional stability of the algorithms is not that much and for some applications ( see below ) may well be worth paying .",
    "an important aspect that we have not yet discussed is the effect of the discretization of space on the accuracy of the numerical results .",
    "both conditional yee - type algorithms and unconditionally stable algorithms @xmath58 , @xmath62 and @xmath68 suffer from numerical dispersion ( see ref.@xcite , chapter 4 for an in - depth discussion ) .",
    "simple methods to reduce numerical dispersion are taking a finer mesh or employing more accurate finite - difference approximations for the spatial derivates @xcite .",
    "the former obviously can be used here too ( for the simulations discussed below we used a mesh size that yields sufficiently accurate results for the present purposes ) .",
    "there are no fundamental nor practical problems to incorporate the latter method in the suzuki - product - formula approach @xcite .",
    "however as the emphasis of the present paper is on the construction of unconditionally stable algorithms we relegate a presentation of these technical but for applications important extensions to future publications .",
    "time - domain algorithms obviously yield the time development of the em fields .",
    "the scattering ( transmission ) of the em fields from ( through ) objects is one of the main applications of this technique  @xcite .",
    "one approach is to prepare an initial state @xmath21 of the em fields , propagate the fields in time for a number of time - steps and analyse the scattered and/or transmitted fields .",
    "another , more realistic , approach is to use a current source @xmath151 . instead of eq .",
    "( [ tdme ] ) we have @xmath152 where @xmath14 and @xmath153 represents the source term .",
    "the formal solution of eq .",
    "( [ tdmej ] ) is given by @xmath154 showing that we can simply re - use one of the unconditionally stable algorithms to compute the second term in eq .",
    "( [ formalj ] ) . in practice , for a time - step @xmath41 , we update @xmath24 according to @xmath155 a standard quadrature formula can be used to compute the integral over @xmath156  @xcite . when a current source is present we take as the initial condition @xmath157 .",
    "time - domain algorithms can also be used to compute the eigenvalues of @xmath37 , the discretized form of @xmath16 . in general @xmath37",
    "is a ( very ) large matrix , usually too large to be stored in memory . if only a few , well - separated eigenvalues of @xmath37 are required sparse - matrix techniques can be used to compute these eigenvalues  @xcite . however ,",
    "if one is interested in global features of the distribution of eigenvalues , i.e. if we want to determine _ all _ eigenvalues , time - domain algorithms offer several advantages .",
    "in fact they are at the heart of so - called `` fast '' algorithms to compute the density of states ( dos ) and other related quantities  @xcite .",
    "the basic idea of this approach was laid out by alben et al .",
    "@xcite who used it to compute the dos of models for one electron moving in a disordered alloy .    denoting the ( unknown ) eigenvalues and ( unknown ) eigenvectors of @xmath37 by @xmath158 and @xmath159 respectively",
    ", we have @xmath160 where @xmath150 ( @xmath161 for 1d , @xmath162 for 2d , @xmath163 for 3d ) is the dimension of the vector space on which @xmath37 acts . from eq .",
    "( [ ft ] ) it follows immediately that the fourier transform of @xmath164 contains the information on all eigenvalues for which @xmath165 . using independent random numbers to initialize the elements of @xmath21",
    ", it can be shown that the density of states @xmath166 is given by @xcite @xmath167 where @xmath168 is an irrelevant constant factor and @xmath169 is the average of @xmath164 over different realizations of the random initial state .",
    "it is often expedient to consider , in addition to @xmath166 , the integrated density of states @xmath170 the statistical error on @xmath164 vanishes as @xmath171 where @xmath172 is the number of statistically independent samples of @xmath21 @xcite .",
    "the fact that the statistical error decreases with the number of lattice points @xmath173 gives a tremendous boost to the efficiency of the method .",
    "the information on the eigenvalues of @xmath37 , obtained through the use of a time - domain method is intimately related to the unconditional stability of the latter .",
    "as @xmath164 is band - limited , with frequencies @xmath174 in the interval @xmath175 $ ] ( where @xmath176 denotes the largest eigenvalue of h in absolute value ) , it follows from nyquist s sampling theorem that it is sufficient to sample @xmath164 at regular intervals @xmath177 .",
    "if @xmath178 denotes the number of data points used to sample @xmath164 , frequencies @xmath174 that differ less than @xmath179 are indistinguishable ( although they will all contribute to the dos ) . extending the length of the time integration by a factor of two increases the resolution in frequency by a factor of two .",
    "this is a rather efficient and flexible procedure to trade accuracy for computational resources .",
    "one may object that by integrating the tdme over longer and longer times ( larger and larger @xmath178 ) the error on @xmath24 will increase , possibly leading to no gain in accuracy at all .",
    "however , it has been shown rigorously  @xcite that the error on the eigenvalues of @xmath37 vanishes as @xmath180 if one uses unconditionally stable algorithms based on the second - order suzuki product - formula . the proof given in ref .",
    "@xcite applies to the fourth - order algorithm @xmath68 as well , the exponent of @xmath41 being four instead of two .    in some cases",
    "the underlying differential equations and boundary conditions only specify the solution up to a non - zero constant . in the calculation of the dos ,",
    "the presence of such a constant contribution shows up as a peak at zero frequency . in principle",
    "this peak can be removed by modifying the random initial state but as the origin of this irrelevant artifact is understood , there is little reason of doing this .    summarizing : solving the tdme by the @xmath181th - order suzuki product - formula algorithm @xmath126 guarantees that the accuracy with which the eigenvalues of @xmath37 can be determined vanishes as @xmath182 , where @xmath178 is the number of points used to sample @xmath164 ( see eq .",
    "( [ ft ] ) ) .",
    "in this section we present simulation results for several physical systems which we selected as examples to test our algorithms . for numerical purposes it is expedient to use dimensionless quantities .",
    "we will denote the unit of length by @xmath183 and take the velocity of light in vacuum , @xmath51 , as the unit of velocity .",
    "then time and frequency are measured in units of @xmath184 and @xmath185 , respectively .",
    "the permittivity @xmath186 and permeability @xmath73 are measured in units of their corresponding values in vacuum .",
    "let us first consider an empty , one - dimensional cavity with constant permeability @xmath187 and constant permittivity @xmath188 .",
    "the eigenfrequencies for a system of length @xmath189 are given by  @xcite @xmath190 where @xmath191 labels the different em modes . in fig .",
    "[ fig : spec1d ] we show the density of states @xmath192 obtained according to the procedure described in sec .",
    "[ sec5 ] , using the second - order algorithm @xmath62 ( solid line ) and the standard yee algorithm  @xcite ( dashed line ) .",
    "( 9.2,6.6 ) ( 0.5,0 )    in both calculations the lattice spacing @xmath193 and the time step @xmath194 .",
    "each curve shown in fig .",
    "[ fig : spec1d ] is the average of @xmath195 statistically independent runs , taking @xmath196 samples of @xmath164 ( see eq .",
    "( [ ft ] ) ) at time intervals @xmath197 . the peaks in fig .  [ fig : spec1d ] correspond to the exact frequencies ( see eq .",
    "( [ omegak ] ) ) of the 1d cavity .",
    "the background signal produced by the yee algorithm  @xcite is at least eight orders of magnitude larger than that generated by @xmath62 .",
    "the time - step operator of the yee algorithm is not an orthogonal matrix and hence its eigenvalues do not necessarily lie on the unit circle .",
    "this is related to the fact that the yee algorithm is conditionally stable  @xcite and leads to fluctuations in the energy density @xmath198 , as illustrated by the dashed line in fig .",
    "[ fig : normyee ] , and to negative values of the fourier transform of @xmath164 ( which is the reason why fig .",
    "[ fig : spec1d ] shows @xmath192 instead of @xmath199 ) .",
    "in contrast , the unconditional stability of algorithms based on the suzuki product - formula implies that @xmath198 is constant in time . the solid line in fig .",
    "[ fig : normyee ] shows that this is indeed the case .",
    "( 9.2,6.7 ) ( 0.5,0 )    as a second example we consider a one - dimensional stack of dielectric material , schematically shown in fig .",
    "[ fig : fig4 ] .",
    "the material indices of refraction , denoted by @xmath200 and @xmath201 , give rise to a spatially varying permittivity @xmath202    ( 6.8,2.0 ) ( 0.5,0 )    in particular , we consider a structure that is known as the quarter - wave stack and is characterized by the relation @xmath203 such that the length of the optical path in the two layers is the same .",
    "the density of states exhibits a gap centered around the midgap frequency  @xcite @xmath204 in fig .",
    "[ fig : qws1_spec ] we show the density of states @xmath199 as obtained by @xmath62 .",
    "( 8.9,6.4 ) ( 0.5,0 )    also for these calculations the lattice spacing @xmath193 and the time step @xmath194 .",
    "each curve in fig .",
    "[ fig : qws1_spec ] is the average of @xmath205 statistically independent runs , taking @xmath196 samples of @xmath164 ( see eq .  ( [ ft ] ) ) at time intervals @xmath197 .",
    "note that the system length @xmath189 and the ( odd ) number of lattice points have to be chosen judisciously , otherwise the spectrum will exhibit artifacts ( impurity states due to one extra grid point ) .    in fig .",
    "[ fig : qws2_spec ] we show the density of states @xmath199 as obtained by the yee algorithm .",
    "note that the spectral weight can take negative values , an unphysical feature that is a manifestation of the fact that the energy of the em field is not conserved .",
    "( 8.9,6.4 ) ( 0.5,0 )    in fig .",
    "[ fig : qws1_idos ] we present the integrated density of states @xmath206 for both the @xmath62 and yee algorithm .",
    "the result of the @xmath62 algorithm is in excellent agreement with the analytical calculation  @xcite .",
    "( 9,6.8 ) ( 0.5,0 )      a photonic bandgap ( pbg ) material prohibits the propagation of em fields in a range of frequencies that is characteristic for its structure  @xcite",
    ". a pbg is called absolute if it exists for any wave vector of the em fields . the most common method used to compute",
    "a pbg employs a plane - wave expansion to solve the time independent maxwell equations ( see e.g. @xcite ) .",
    "this kind of pbg calculation requires a fourier transform of the unit cell of the dielectric structure which is for simplicity considered to be periodic .    with our time - domain algorithm",
    "the existence of a pbg can be demonstrated with relative ease .",
    "it suffices to compute the spectrum of such a dielectric structure with a random initial state . if the spectrum is gapless there is no need to make additional runs .",
    "if there is a signature of a gap , it can be confirmed and refined by making more runs . as an example we consider a system consisting of a dielectric material pierced by air - filled cylinders  @xcite .",
    "the geometry is taken to be a square parallelepiped of size @xmath207 that is infinitely extended in the @xmath71-direction and hence is effectively two - dimensional . in fig .",
    "[ fig : bandgaps ] we present the results for the pbgs which we obtained for both the transverse magnetic ( tm ) and transverse electric ( te ) modes as a function of the filling fraction .",
    "the data have been generated by means of the algorithm @xmath68 with a mesh size @xmath193 and a time step @xmath208 .",
    "to compute the dos we used @xmath209 samples of @xmath164 at time intervals @xmath197 .",
    "only a single random initial state for the em fields has been used . replacing the free - end boundary conditions eq .",
    "( [ boundcond ] ) by periodic boundary conditions ( results not shown ) only leads to minor changes in the locations of pbgs .",
    "the results shown in fig .  [ fig : bandgaps ] are in good agreement with those presented in ref .",
    "@xcite .",
    "( 9.1,6.6 ) ( 0.5,0 )    in fig .",
    "[ fig:2dtimedep ] we study the propagation of time - dependent em fields through the above described pbg material consisting of twelve unit cells .",
    "( 8.3,7.9 ) ( 0.5,0.2 )    the pbg material is placed in a cavity which contains a point source ( located to the left of the pbg material ) that emits radiation with frequency @xmath210 .",
    "the tdme were solved by the @xmath62 algorithm with @xmath193 and @xmath194 in the presence of a current source according to eq .",
    "( [ psitau ] ) .",
    "the snapshots show the absolute intensity @xmath211 of the tm - mode at @xmath212 .",
    "the computed dos of the pbg material is given in fig .",
    "[ fig:2dspec ] .",
    "we used the @xmath68 algorithm with @xmath193 , @xmath208 , and took @xmath209 samples of @xmath164 at time intervals @xmath197 in this computation .",
    "( 9.1,9.2 ) ( 0.5,0 )    the presence or absence of gaps in the dos leads to qualitative changes in the transmitted ( and reflected ) intensities .",
    "since a gap is present in the dos at @xmath213 , radiation with this frequency does not easily propagate through the ( thin slice of ) pbg material . on the other hand",
    ", the dos has no gaps at @xmath214 and @xmath215 , so that propagation of em fields through the pbg material should be possible , as is indeed confirmed by fig .",
    "[ fig:2dtimedep ] .",
    "we first compute the modes of a simple cubic cavity of size @xmath189 .",
    "the eigenfrequencies are given by  @xcite @xmath216 where @xmath181 , @xmath217 , and @xmath218 are non - negative integers .",
    "eigenmodes corresponding to @xmath219 , @xmath220 and @xmath221 are incompatible with the boundary conditions eq .",
    "( [ boundcond ] ) . in tab .",
    "[ tbl : table3d ] we present the frequencies of the five lowest eigenmodes of a cubic cavity for @xmath222 .",
    ".frequencies of the eigenmodes of a cubic cavity of size @xmath222 .",
    "simulation : values determined from dos data generated using @xmath62 with parameter values @xmath223",
    ", @xmath194 , @xmath224 and @xmath197 . [ cols=\"^,^,^\",options=\"header \" , ]     the agreement with the theoretical values is satisfactory .",
    "note that as the frequency increases , the deviation from the exact result increases .",
    "this is due to the ( second - order ) finite - difference representation of the spatial derivatives on the grid and is a manifestation of the numerical dispersion mentioned earlier .",
    "as a second 3d example we consider the emission of the em radiation from a point source located inside dielectric material containing spherical voids .",
    "a projection of the material onto the @xmath225 ( or @xmath226 or @xmath227 ) plane is shown in the top panels of fig.[fig : pgb3d ] .",
    "a point source is placed inside the center void to mimic an atom or molecule that emits a photon .",
    "the remaining panels in fig.[fig : pgb3d ] show snapshots of the light intensity after an elapsed time @xmath228 , for different sizes of the voids and different values of the permittivity .",
    "if the latter is larger than 5 , the images no longer depend on the value of the permittivity ( results not shown ) . for @xmath229 ( panels ( b ) and ( b ) )",
    "the em field easily propagates through the sample and leaves the sample from all sides .",
    "this is not the case for @xmath230 : radiation can leave the sample only at those locations where there is very little or no dielectric material left . in other words , light emerges from the sample in well - defined directions only .",
    "clearly , much more work is necessary to study the propagation of em radiation in this system as a function of the material parameters , the system size and the frequency of the emitted photons .",
    "( 12.,12 . )",
    "we have introduced a new family of algorithms to solve the time - dependent maxwell equations .",
    "salient features of these algorithms are :    * rigorously provable unconditional stability for one- , two- and three - dimensional systems with spatially varying permittivity and permeability , * the use of a real - space ( yee - like ) grid , * the order of accuracy in the time step can be systematically increased without affecting the unconditional stability ( in this paper we limited ourselves to second and fourth - order schemes ) * the exact conservation of the energy density of the electromagnetic field * easy to implement in practice    we have presented results for the density of states of simple cavities and photonic bandgap materials .",
    "we demonstrated that mathematical properties of the algorithms are such that they can be used to compute the density of states with very good accuracy ( limited by the accuracy of the spatial discretization used ) .",
    "we gave some illustrative examples of scattering of waves by photonic bandgap systems .",
    "these examples also served to show that our algorithms reproduce known results .",
    "the first feature opens up possibilities for applications to left - handed materials  @xcite .",
    "we intend to report on this subject in the near future .",
    "although we believe there is little room to improve upon the time - integration scheme itself ( except for using higher - order product - formulae ) , for some applications it will be necessary to use a better spatial discretization than the most simple one employed in this paper .",
    "there is no fundamental problem to extend our approach in this direction and we will report on this issue and its impact on the numerical dispersion in a future publication .",
    "the rigorous unconditional stability of the algorithms that we proposed in this paper is a direct consequence of adopting a suzuki - product - formula approach that preserves the fundamental symmetries of the physical system . in view of the generic character of this methodology",
    ", the approach pursued in the present paper should be useful for constructing unconditionally stable algorithms that solve the equations for e.g. sound , seismic and elastic waves as well .",
    "we thank k. michielsen for a critical reading of the manuscript and w. bruns for helpful discussions .",
    "this work is partially supported by the dutch ` stichting nationale computer faciliteiten ' ( ncf ) ."
  ],
  "abstract_text": [
    "<S> based on the suzuki product - formula approach , we construct a family of unconditionally stable algorithms to solve the time - dependent maxwell equations . </S>",
    "<S> we describe a practical implementation of these algorithms for one- , two- , and three - dimensional systems with spatially varying permittivity and permeability . </S>",
    "<S> the salient features of the algorithms are illustrated by computing selected eigenmodes and the full density of states of one- , two- , and three - dimensional models and by simulating the propagation of light in slabs of photonic band - gap materials .    </S>",
    "<S> pacs numbers : 02.60.cb , 03.50.de , 41.20.jb , 42.70.qs </S>"
  ]
}