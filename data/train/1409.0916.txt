{
  "article_text": [
    "the evolution of galaxies is intimately linked to their gas processes .",
    "star formation rates are sustained by accretion of infalling gas ( e.g. , * ? ? ? * ) and regulated by stellar feedback processes ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "accretion and feedback likely persist in a stochastic quasi - balancing act that regulates galaxy evolution and yields the global properties of galaxies ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) , such as the stellar mass - halo mass relation and the average star formation history , both a function of halo mass and redshift ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) , the stellar mass - metallicity relation ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) , and the distribution of galaxies on the color - stellar mass diagram ( e.g. , * ? ? ?",
    "* ) .    with deeper appreciation for the key role gas plays in governing the evolution of galaxies",
    ", concentrated effort has been focused on incorporating increasingly sophisticated treatment of hydrodynamics and stellar formation and feedback processes in cosmological simulations .",
    "the ultimate goal is to form realistic galaxies having properties consistent with global galaxy relations while gaining insight into the physics that yields these relations ( e.g. , * ? ? ?",
    "? * ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "since the flow of gas in and around galaxies is central to regulating the evolution of galaxies , it is imperative the properties of this `` circumgalactic medium '' ( cgm ) associated with simulated galaxies also match observations ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "the cgm is observed using absorption lines in the spectra of luminous background sources , such as quasars , whose lines of sight serendipitously probe the vicinity of foreground galaxies .",
    "commonly observed absorption lines include  @xmath0 ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "the and doublets ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) , and the doublet ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* and references therein ) .",
    "commonly measured absorption line quantities include the equivalent widths , column densities , the velocity spreads , the line - of - sight velocities with respect to the presumed host galaxy , and , if voigt profile ( vp ) decomposition is undertaken , the number of vp components and their column densities , velocities , and doppler @xmath1 parameters ( line profile broadening and indicator of gas temperature and turbulence ) . on a sightline by sightline basis , these quantities can be examined as a function of host galaxy properties ( masses , luminosities , colors , star formation rates , etc . ) and projected distance from the host galaxies .",
    "since the absorption occurs from ionized atoms and is proportional to the product of the ion density and line of sight pathlength through the gas , ionization modeling is required to infer the hydrogen density and metallicity of the cgm absorbing gas from observed spectra .",
    "the most commonly employed ionization code is cloudy @xcite . assuming the spectral energy distribution ( sed ) of the ionizing spectrum is known , and assuming a cloud geometry , cloudy allows the ionization conditions , metallicity , and hydrogen density to be constrained from the measured column densities .",
    "usually , a @xcite ultraviolet background ( uvb ) ionizing spectrum is assumed for the model clouds .",
    "ionization modeling is equally critical for the simulations .",
    "since analysis of the simulated cgm requires a comparison with observed absorption line properties , we are required to generate synthetic absorption profiles of `` sightlines '' through the simulated cgm .",
    "this requires that the ionization fractions of the absorbing ions are known .",
    "there are two approaches .",
    "the first is post - process ionization modeling of the simulation output .",
    "the second is incorporation of the ionization modeling self - consistently into the hydrodynamics of the cosmological simulation , which is computationally expensive .    for both observations and simulations ,",
    "several assumptions are often employed , most importantly that the gas is in ionization equilibrium and that the sed of the ionizing spectrum is known , at least approximately . in the cgm",
    ", the ionizing sed can have substantial variations , both temporally and spatially .",
    "since the ionization conditions strongly depend on the density and temperature of the simulated gas , it is important the heating and cooling rates are as realistic as possible .",
    "however , the heating and cooling rates depend upon the ionizing sed , the gas density , temperature , and the atomic abundances of metals in the gas",
    ". if the cooling time is shorter than the ionization and/or recombination timescales of a given ion , then that ion can not settle into ionization equilibrium .",
    "these considerations highlight the importance for incorporating a spatially resolved radiative transfer ( rt ) scheme that is coupled to the hydrodynamics in cosmological simulations ( hereafter , radiation hydrodynamics , rh , see * ? ? ?",
    "* ) .    various explorations , often focused on specific astrophysical problems , have been researched to examine the effects of implementing rt and rh in hydrodynamic simulations @xcite .",
    "in fact , progress has been made toward incorporating rh into some cosmological simulations , either by solving the optically thin variable eddington tensor @xcite , or by employing ray - tracing methods @xcite .",
    "typically , only hydrogen and helium ionization balance is treated .",
    "however , @xcite studied the evolution of to by directly integrating the rate equations using rh in their simulations . @xcite",
    "implemented rh into their simulations and incorporated a rate matrix including several important metals species , but so far they have limited their analysis to a single parcel of gas independent of hydrodynamics .",
    "to date , studies of the simulated cgm that employ the absorption line technique have implemented the post - processing approach ( e.g. , * ? ? ? * ; * ? ? ? * ; * ? ? ? * ; * ? ? ?",
    "typically , the ionization code cloudy is used to create a grid of `` cloud '' models as a function of redshift assuming the @xcite uvb ionizing sed for a range of gas - state variables .",
    "the cloud models usually are constant density with a plane parallel geometry , are illuminated by the ionizing sed on one face , and omit dust and cosmic ray heating .",
    "the ionization condition of the cloud model is normally specified by the ionization parameter , @xmath2 which is defined at the illuminated edge of the cloud model , where @xmath3 is the constant hydrogen density , @xmath4 is specific intensity of the ionizing sed , and @xmath5 is the ionization threshold energy for neutral hydrogen . since cloudy solves the rt through a multi - zone cloud model , the ionization structure can vary with depth into the cloud .",
    "the standard output of cloudy are the zone - depth weighted _ average _ ionization fractions .",
    "a fixed metallicity and abundance pattern ( usually solar ) is adopted . for a given parcel of gas in the simulations , the cloudy grid serves as a look - up table for ionization fractions ,",
    "from which the metallicity and abundance pattern can be scaled ( e.g. , * ? ? ? * ; * ? ? ?",
    "* ) to yield the column density of desired ions required for generating synthetic absorption line spectra .",
    "@xcite employ a post - processing scheme in which they use cloudy 08.00 look - up tables to determine the metal species ionization fractions as a function of density , temperature , and the uvb ionizing spectrum . for gas particles with large neutral hydrogen column densities ,",
    "i.e. , @xmath6 , they incorporate a correction factor for self - shielding by matching the neutral hydrogen fractions to the models of @xcite .",
    "they assume all of the column density from the mg@xmath7 ion arises in the self - shielded region .",
    "@xcite track the hydrogen and helium ionization states within their simulations , and then use a cloudy 07.02.01 look - up table to determine the post - processed ionization fraction of the metal ions as a function of density , temperature , and uvb ionizing spectrum .",
    "whereas @xcite post - processed only their line of sight quantities , @xcite post - processed their full simulation output and obtain the spatial distribution of the ionic species .    using a somewhat different approach , @xcite adopted a post - processing monte - carlo rt method that removes the `` preferred '' direction of the photon path inherent in cloudy by accounting for scattering .",
    "like cloudy , their code includes collisional ionization and photoionization , however they explore photoionization from both the uvb and local stellar sources .",
    "they focus on neutral hydrogen column densities and absorption profiles , though they did make rough estimates of column densities and absorption strengths .",
    "they post - processed their full simulation output and explored the effects of the various ionization mechanisms on the spatial distribution of @xmath8 in the vicinity of simulated galaxies by examining the differences between collisional ionization only models , collisional plus uvb photoionization models , and models that incorporate collisional and uvb plus stellar photoionization .",
    "@xcite applied an ionization code of their own design to post - process the ionization conditions of their full simulation output and conducted a pilot study of how well the inferred conditions of the gas from simulated absorption lines compared with the actual properties of the gas giving rise to the absorption .",
    "our goal with this paper , is to present the details of the ionization code employed by @xcite .",
    "the code , called the hydroart radiative algorithm for trace elements ( ) , is designed to ultimately be adaptable and implemented as post - processing rh for cosmological simulations , especially the eulerian n - body hydrodynamic code hydroart @xcite .",
    "currently , is applied as a post - processing step to the full simulation output but does not yet include rt nor rh through the simulation box .    in section  [ sec : hydroart ] , we describe the fundamental characteristics of the hydroart code and our current approach to post - process ionization modeling . in section  [ sec : themodel ] , we detail the physics incorporated into the and the method of solution for the rate matrix . we compare isolated cloud models to those from the `` industry standard '' code cloudy 13.03 in section  [ sec : compare ] . in section  [ sec : conclude ] , we provide a general summary , including a description of planned future growth and implementation of .",
    "in addition to the first results from an application of to the hydroart simulations presented in @xcite , a stand alone version of the code has been successfully applied to observed absorption line systems by @xcite and @xcite .",
    "underlying all hydrodynamic cosmological simulations is the gravitating dark matter in an expanding simulation box , which is reduced to an n - body problem that is commonly solved using hierarchical multipole expansion ( tree algorithms ) .",
    "the baryons are usually treated as an ideal fluid so that one can simplify the hydrodynamics in terms of the euler and continuity equations as governed by the first law of thermodynamics .",
    "two main numerical methods are employed to solve the coupled system of collisional baryonic matter and collisionless dark matter : the particle methods , which discretize mass , and grid - based methods , which discretize space .",
    "a popular particle based method is smoothed particle hydrodynamics , or sph , which solves the lagrangian form of the euler equations . because the gas is discretized into particles",
    ", sph can achieve good spatial resolutions in high - density regions , but is not as robust in low - density regions .",
    "it also suffers from resolution degradation in shock regions due to artificial viscosity @xcite .",
    "alternatively , eulerian grid - based methods solve the hydrodynamic equations across a structured grid ; each grid cell contains constant properties ( density , temperature , velocity , etc . ) and represents a finite volume of the gas fluid .",
    "grid - based methods are effective in both high- and low - density regions and can handle shocks @xcite . in the cosmological setting , adaptive mesh refinement ( amr ) , in which grid cells vary in size in inverse proportion to the gas density , are employed to increase the resolution in regions of rapid evolution while optimizing the number of cells and computational demands .    for our studies of the simulated cgm",
    ", we use the eulerian n - body hydrodynamic code hydroart @xcite .",
    "the hydroart code follows the evolution of a gravitating n - body dark matter halo and models the baryons using eulerian hydrodynamics ; it is a grid - based amr code that uses the zoom - in technique of @xcite and includes all of the currently relevant physics of galaxy formation @xcite .",
    "stars are formed deterministically with the observed low efficiency in the cold and dense gas of molecular cloud environments .",
    "a stellar particle represents a population of stars with a given mass , age , and metallicity . as the particles age ,",
    "their mass decreases as supernovae are converted back into gas .",
    "the stellar feedback model includes the major contributions from photoionization heating , direct radiation pressure , energy from type ii and type ia supernovae , and stellar winds ( see * ? ? ?",
    "* for the most recent star formation and feedback recipes ) .",
    "the high - resolution region around the galaxy is typically @xmath92 mpc across .",
    "the hydrodynamics is resolved with @xmath10 grid cells , with a minimum cell size of roughly @xmath11 pc at @xmath12 . at each grid cell",
    ", the hydroart code follows the evolution of the density , temperature , velocity , and metal mass fraction .",
    "the metals produced in type ii and ia supernovae are followed separately and are self - consistently advected with the gas flow .",
    "the heating and cooling balance of the gas is determined using heating and cooling functions obtained from cloudy 8.00 ( see * ? ? ?",
    "these account for stellar ionizing seds ( as appropriate to the location and density of the grid cell and the ages , masses , and metallicities of the stellar particles ) , ionization by the uvb , molecular line cooling , and self - shielding of high column density gas .",
    "the treatment is similar to that implemented by @xcite , but also includes the effects of ionization by stellar radiation .",
    "we developed a code ( ) that performs equilibrium ionization calculations in hydroart grid cells , with the goal of incorporating it as a full rh treatment .",
    "the main motivation for the development of is to apply it to amr cosmological simulation in order to study the chemical and ionization conditions of the circumgalactic medium in simulated galaxies using absorption line techniques ( see * ? ? ?",
    "the code we present here computes the equilibrium ionization fractions and number densities of the ions in the gas , and is currently applied as a post - processing step .",
    "we treat each grid cell as an isolated `` cloudlette '' .",
    "the three important gas properties associated with a cell are ( 1 ) the hydrogen density , @xmath3 , ( 2 ) the equilibrium temperature , @xmath13 , and ( 3 ) the abundances of all atomic species . in order to treat photoionization processes , the spectral energy distribution ( sed ) of the ionizing radiation",
    "must also be specified , which requires ( 4 ) the redshift , @xmath14 , which provides the cosmic epoch of the uvb ionizing radiation .",
    "in addition , the option to include stellar radiation is provided , which requires ( 5 ) the characteristics ( mass , age , metallicity , and locations ) of stellar populations . when applied to hydroart",
    ", the stellar populations are drawn from the stellar particles in the simulated galaxy .",
    "the present version of does not treat rt through the grid cell , so there is no ionization structure within the grid cells ( see section  [ sec : thingas ] ) . as such , currently , there is no assumption about the gas geometry .",
    "however , note that the commonly employed ionization parameter ( eq .  [ eq : ionpar ] ) is well defined and can be easily computed from the above inputs .",
    "the ionization code calculates the equilibrium electron density and the ionization fractions of all ions , from which all ionic number densities are computed in each grid cell .",
    "metals up to and including zinc are incorporated , however , the user can select which metals are included in the chemical mixture .",
    "all ions are treated as two - level systems , a bound ground state and the continuum ; no recombination transitions are incorporated .",
    "neither photo - heating nor cooling is treated , since these are directly incorporated into hydroart and yield the equilibrium temperature of the gas in the grid cells .",
    "@xcite examined the effects of additional heating by artificially incrementing the temperatures of the grid cells and found that the morphology of the neutral hydrogen gas was negligibly modified for photoionized gas .",
    "the equilibrium solution requires solving a matrix of coupled non - linear rate equations .",
    "we derived a method in which the rate equations are linearized and the solution is obtained via iterative convergence on the equilibrium ionization fractions using particle and charge density conservation .",
    "the physical gas processes included in are photoionization , auger ionization , direct collisional ionization , excitation auto - ionization , charge exchange ionization , radiative recombination , dielectronic recombination , and charge exchange recombination .",
    "if desired , the effects of each of these processes can be isolated by turning the process `` off '' or `` on '' .      for what follows",
    ", we denote the atomic species by the index @xmath15 , where @xmath15 equals the atomic number , and denote the ionization stage by the index @xmath16 , where @xmath17 is the neutral stage and @xmath18 is the fully ionized stage .",
    "we assume that all ions and neutral atoms are in their ground state . the number density [ @xmath19 of ion @xmath20 is @xmath21 and the electron number density is @xmath22 .",
    "the rate equation , @xmath23 , quantifies the rate of change in the number of ion @xmath20 per unit volume per unit time [ @xmath24  s@xmath25 .",
    "it can be expressed as @xmath26 & &   ( \\hbox{destruction rate of ion $ k , j$ } ) \\ , .",
    "\\end{array}\\ ] ] clearly , there is a rate equation for each ionization stage for each atomic species , which taken together form a rate matrix .",
    "the rate matrix is closed by particle and charge density conservation .",
    "the creation and destruction rates per unit volume are determined by multiplying the rate per unit time [ s@xmath25 by the number density of the initial state particle .",
    "for example , in the case of photoionization ( denoted `` ph '' ) of ion @xmath27 , the contribution to the destruction rate per unit volume is @xmath28 . in the case of recombination ( denoted `` rec '' ) with ion @xmath29 to create ion @xmath20 , the contribution to the creation rate per unit volume is @xmath30 .",
    "note that all rates , @xmath31 , are indexed to the initial ion stage .",
    "all collision based rates are determined from the rate coefficients [ @xmath32  s@xmath25 .",
    "we denote ionization rate coefficients as @xmath33 and recombination rate coefficients as @xmath34 . in the case that ionization is due to a collision with a free electron , the rate per unit time is obtained by multiplying the rate coefficient by the electron density .",
    "we use the convention that ionization rate coefficients are indexed by referencing the initial ion stage @xmath16 , whereas , for recombination , @xmath16 refers to the final ion stage .",
    "that is , for recombination , rate coefficients index the ion towards which recombination proceeds .",
    "for example , in the case of direct collisional ionization ( denoted `` cdi '' ) of ion @xmath20 by a free electron , the contribution to the destruction rate per unit volume of ion @xmath20 is @xmath35 . in the case of radiative recombination",
    "( denoted `` phr '' ) of a free electron with ion @xmath20 to create ion @xmath29 , the contribution to the destruction rate per unit volume of ion @xmath20 is @xmath36 . note that this expression would also be the contribution to the radiative recombination creation rate per unit volume for ion @xmath29    in section  [ sec : rateeqs ] , we write out the rate equations for all ions .",
    "the equilibrium balance is achieved when @xmath37 for all ions , by balancing the creation and destruction rates per unit volume . in section  [ sec : solution ] , we outline our method to solve the rate matrix .      together , particle and charge density conservation provide the constraints for obtaining the ion densities and ionization fractions .",
    "the total number density of all ions and free electrons is @xmath38 , where @xmath39 is the density of free electrons and , as dictated by particle conservation , @xmath40 is the number density of all atomic species , where @xmath41 is the number densities of species @xmath15 , and @xmath42 is the number density of species @xmath15 in ionization stage @xmath16 . since the ionization model includes elements only up to zinc , the maximum @xmath15 is 30 . and ,",
    "since the user can specify a subset of these elements for inclusion into the ionization model , the sum includes only the @xmath15 values of the atomic species used in the ionization model .",
    "the abundance fractions , @xmath43 , are employed to compute the number density of the atomic species . with this formalism",
    ", the number density of each atomic species is determined directly from the input hydrogen number density and abundance fractions via @xmath44 , where @xmath45 and @xmath46 .",
    "the @xmath47 are determined by the mass fractions , @xmath48 , according to @xmath49 where @xmath50 is the atomic mass of species @xmath15 in units of the unified atomic mass unit , @xmath51 [ g ] .",
    "again , the sum includes only the elements used in the ionization model in order to preserve @xmath52 .    in hydroart , each grid cell records the hydrogen density and the type ii and type ia total mass fractions , @xmath53 and @xmath54 . to compute the abundance fractions from eq .",
    "[ eq : afracs ] , we require the individual mass fractions of hydrogen , helium , and the included metal species . for type ii composition",
    ", we use the production factors from the rotating models of @xcite .",
    "the production factors are determined by integrating the model yields for different mass progenitors across the salpeter initial mass function ( @xmath55 , * ? ? ?",
    "* ) over the progenitor mass range 13120  m@xmath56 . for type ia composition",
    ", we use the yields , @xmath57 from the c series dd2 models of @xcite , which are the most consistent with observational constraints of the nucleosynthesis products in the galaxy .",
    "we denote the type ii and type ia mass fractions for atomic species @xmath15 as @xmath58 and @xmath59 , respectively . for hydrogen and helium , @xmath60 , yielding @xmath61 .",
    "the metal mass fractions are rescaled by a constant to recover the mass fractions in the grid cell , @xmath62 for consistency , only the atomic species that are incorporated in the ionization model are included in the sums .",
    "we now need to rescale the hydrogen and helium mass fractions . since all the hydrogen and helium originates from the type ii ejecta , the starting redshift of the simulation .",
    "we do not apply a chemical evolution model to account for the full history of the grid cells , but assume that the feedback enrichment dominates .",
    "] , we define @xmath63 , and obtain the mass fractions for the mixture ( employed in eq .",
    "[ eq : afracs ] ) , @xmath64 which preserves the constraint @xmath65 .",
    "if desired , solar abundance pattern can be used , in which case we directly employ the solar mass fractions from table 1.4 of @xcite , which are derived from @xcite . finally , the metallicity of the gas in solar units is @xmath66 where @xmath67 .",
    "since each ion @xmath20 donates @xmath68 electrons to the free electron pool , the contribution to the electron density from each ion is @xmath69 .",
    "the total electron density from all ions is then @xmath70 introducing the ionization fractions , @xmath71 , we write @xmath72 , and obtain the equation for charge density conservation , @xmath73 note that the ionization fraction depends upon the electron density , temperature , and the ionizing photon field , @xmath74 .",
    "[ eq : chargeconservation ] is a linear transcendental equation ; the electron density , @xmath75 , must be known in order to calculated the ionization fractions , which are constrained via particle and charge density conservation to yield a free electron pool with density @xmath75 .",
    "we provide the options ( 1 ) ionization by the ultraviolet background ( uvb ) , which is redshift dependent , ( 2 ) ionization by stellar populations , which depends on each populations total stellar mass , age , metallicity , and distance from the model cloud , and ( 3 ) ionization by both the uvb and stellar populations .    for the uvb , we use the seds of @xcite added to the cosmic microwave background .",
    "these spectra are specified as the specific intensity , @xmath4 [ erg s@xmath76 @xmath77 str@xmath76 hz@xmath25 over the energy [ ev ] interval @xmath78 and are provided for redshifts @xmath79 .",
    "once the cloud redshift is specified , a grid of seds sampled at intervals of @xmath80 are cubic spline interpolated at each frequency to obtain @xmath81 , which is then converted to the specific intensity per unit energy , @xmath82 [ cm@xmath76 s@xmath76 str@xmath25 versus @xmath84 [ ev ] via @xmath85 .    for the stellar populations , we use seds computed from the starburst99 v6.02 models @xcite .",
    "we built a library of seds comprising stellar populations of @xmath86 , @xmath87 , @xmath88 , and @xmath89  m@xmath90 .",
    "for each mass , five ages were computed ( 1 , 5 , 10 , 20 , and 40 myr ) and for each mass and age five metallicities were computed ( @xmath91 , @xmath92 , @xmath93 , @xmath94 , and @xmath95 ) .",
    "we store the seds as the luminosity density per unit wavelength , @xmath96 [ erg s@xmath76  @xmath25 over the wavelength range @xmath97   , which corresponds to the energy [ ev ] interval @xmath98 .    once the desired mass , age , and metallicity are specified , we first cubic spline interpolate @xmath96 at each wavelength across mass for each age and metallicity , then across age for each metallicity , and then across metallicity . the final sed is then converted to the flux density per unit wavelength , @xmath99 [ erg s@xmath76 @xmath77 str@xmath76 @xmath25 , where @xmath100 is the specified distance to the stellar population from the model cloud . finally , we convert the sed to @xmath74 versus @xmath84 . if a combined uvb plus stellar population sed is used , the two specific intensities are added .",
    "in general , the contribution by stars scales linearly with the mass of the stellar population and with the inverse square of the distance between the model cloud and the stellar population .    in figure  [",
    "fig : seds ] , we illustrate a sed that combines contributions from both the uvb ( red curve ) and a stellar population ( blue dotted curve ) .",
    "for this example , the uvb is a @xmath12 @xcite spectrum and the stellar population has mass @xmath101  m@xmath56 , age @xmath102 myr , and metallicity @xmath103 and is at a distance of 100 pc .",
    "there is no attenuation .",
    "typical of this example , stellar radiation modifies the uvb sed in the spectral region below 100 ev , and when present , will generally lead to higher ionization conditions in regions where photoionization dominates .",
    "even with no assumed attenuation through the ism , stellar seds rarely modify the uvb incident on a grid cell unless the stellar population is very close in proximity , otherwise the population needs to be very young ( populated with o stars ) and massive @xcite .",
    "we treat photoionizationa and auger ionization ( section  [ subsec : photoionization ] ) , direct collisional ionization ( section  [ sec : cdi ] ) , and excitation auto - ionization processes ( section  [ sec : cea ] ) .",
    "we also treat charge exchange ionization , which is presented in section  [ sec : chargeexchange ] .",
    "photoionization and auger ionization both begin with radiative ionization processes in which a bound electron is photo - ejected from an ion or neutral atom .",
    "the electron can be liberated from any one of the ion s populated electron shells .",
    "to compute the rate , @xmath104 , at which an electron in a given shell , index @xmath105 , is photo - ejected from ion @xmath20 , we multiply the cross section for absorption , @xmath106 , for shell @xmath105 at energy @xmath107 by the photon number density per unit energy , @xmath108 [ erg@xmath76 @xmath77  s@xmath25 , and integrate over all energies greater than the binding energy of the electron , @xmath109 where @xmath110 is the ionization ( binding ) energy for electrons in shell @xmath105 of ion @xmath20 .    for the computation of eq .  [",
    "eq : rphoto ] , we adopt the convention for the shell indices such that @xmath111 is the 1s shell , @xmath112 is 2s , @xmath113 is 2p , @xmath114 is 3s , @xmath115 is 3p , @xmath116 is 3d , and @xmath117 is 4s .",
    "the photoionization cross sections are computed from the fitting functions and fitting parameters tabulated by @xcite for inner shells and by @xcite for the outer shells .",
    "their work includes all ionization stages and shells for hydrogen through zinc .",
    "we computed @xmath118 from , @xmath119^{^p } } \\ , , \\label{eq : phxsec}\\ ] ] where @xmath120 and @xmath121 .",
    "the tabulated fitting parameters for each @xmath122 are @xmath123 , @xmath124 , @xmath125 , @xmath126 , @xmath127 , @xmath128 , and @xmath129 . for inner shells",
    "@xmath127 , @xmath128 , and @xmath129 are null and the asymptotic power is @xmath130 , where @xmath131 is the angular momentum quantum number of the shell .",
    "for the outer shell @xmath132 .",
    "the physical interpretation of each fitting parameter is explained in @xcite .    in figure",
    "[ fig : phxsecs ] , we present the photoionization cross sections for h@xmath133 , and mg@xmath7 , and c@xmath134 , and o@xmath135 as a function of the photon energy as computed from eq .  [",
    "eq : phxsec ] and applied in eq .",
    "[ eq : rphoto ] .",
    "ground - state mg@xmath7 has the isoelectronic sequence of neutral sodium ( 1s@xmath1362s@xmath1362p@xmath1373s@xmath138 ) and ground - state c@xmath139 , and o@xmath135 have the isoelectronic sequence of neutral lithium ( 1s@xmath1362s@xmath138 ) .",
    "the individual shell cross sections are shown as colored dotted curves and the total is the solid curve .",
    "the red curves are the ground - state ionization threshold energies for the outermost populated electron shell .    in the case of photoionization",
    ", a single electron , @xmath140 , is ejected and the ionization stage of the incident ion @xmath20 is incremented by one to @xmath141 , @xmath142 in cases where the incident photon has the required energy to liberate an inner shell electron some of its energy can be channeled into also liberating one or more of the less bound , higher shell electrons .",
    "this process is known as auger ionization , in which the ionization stage of the incident ion @xmath20 is incremented by two or more , @xmath143 where we use the convention that that the initial ionization stage is @xmath16 and the final higher ionization stage is @xmath144 .",
    "note that the number of ejected electrons is @xmath145 .",
    "because the photo - electron is included in the notation , the final stage @xmath144 is always greater than or equal to @xmath146 .",
    "photoionization is the special case in which @xmath147 .    in order to compute the photo and auger ionization rates ,",
    "it is necessary to know the yield probability , @xmath148 , i.e. , the probability that @xmath149 electrons in total are ejected from an ion following a photoionization of an electron originating from shell @xmath105 ( the photo - electron ) .",
    "these yield probabilities have been calculated and tabulated by @xcite for each electron shell .    for photoionization , the total photoionization rate , @xmath150 , for destruction of ion @xmath20 is given by @xmath104 ( see eq .",
    "[ eq : rphoto ] ) , the rate at which an electron bound in shell @xmath105 of ion @xmath20 is ionized by incident photons , weighted by the probability that only the photo - electron is ejected from the ion and summed over all electron shells , @xmath151 where @xmath152 is the number of shells for ion @xmath20 .",
    "similarly , the auger ionization rate , @xmath153 , for destruction of an ion @xmath20 that ejects @xmath145 electrons ( including the photo - electron , so @xmath154 ) is the sum of @xmath104 over all electron shells weighted by the probability that @xmath155 electrons in total were ejected from the ion in response to a photo - electron originating in shell @xmath105 , @xmath156 the @xmath157 are unique amongst the various ionization rates , because they dictate the balance between non - adjacent ionization stages of species @xmath15 . clearly , @xmath158 since fully ionized and hydrogenic ions can not undergo auger ionization .",
    "direct collisional ionization is the collision of an electron with an ion , which then directly ionizes from @xmath16 to @xmath159 , @xmath160 in the process , the colliding free electron , @xmath161 , loses an energy equal to the ionization energy plus the kinetic energy of the ejected electron .",
    "the ionization rate for destruction of ion @xmath20 due to direct collisional ionization is obtained by multiplying the total direct collisional ionization rate coefficient , @xmath162 , by the number density of free electrons , @xmath163 where @xmath164 is the sum of the direct collisional ionization rate coefficient contributions , @xmath165 , for ejection of an electron from shell @xmath105 . here , the shell indices are @xmath111 is the 1s shell , @xmath112 is the combined 2s+2p shell , @xmath113 is the combined 3s+3p shell , and @xmath114 is the 4s shell .",
    "the @xmath166 are the expectation values @xmath167 , where @xmath168 is the direct collisional ionization cross section for the shell , @xmath169 is the electron speed for kinetic energy @xmath84 , and @xmath170 is the electron mass . the integration is over energies large enough to overcome the binding energy , @xmath171   \\!\\!\\ ! & = & \\!\\!\\ ! \\displaystyle \\sqrt{\\frac{2k}{m\\sube } }   \\int _ { i\\subkjs}^{\\infty } \\!\\!\\!\\ !   \\sigma",
    "\\cdi \\subkjs ( e ) f(e , t)\\ , e^{\\hbox{\\tiny 1/2 } } de \\ , , \\end{array } \\label{eq : alphacdicomp}\\ ] ] where @xmath172 is the maxwell - boltzmann speed distribution function at equilibrium temperature @xmath13 , and @xmath173 is the ionization energy of shell @xmath105 of ion @xmath20 , .",
    "the direct collisional ionization cross sections and rate coefficients are computed from the fitting functions and parameters tabulated by @xcite . for shell @xmath105 of ion @xmath20 ,",
    "let @xmath174 and @xmath175 . the direct collisional ionization cross section for shell @xmath105",
    "is computed from @xmath176 where the four fitting coefficients , @xmath177 , @xmath178 , @xmath179 , and @xmath180 , are tabulated in @xcite for each shell for all ion stages of hydrogen through nickel .",
    "the units of the fitting coefficients are @xmath181 cm@xmath136 ev@xmath136 . in figure",
    "[ fig : cdixsecs ] , we present the direct collisional ionization cross sections for h@xmath133 , and mg@xmath7 , and c@xmath139 , and o@xmath135 as a function of the electron energy as computed from eq .",
    "[ eq : xsec - cdi ] . the individual shell cross sections are shown as colored dotted curves .",
    "the red curves are the ground - state ionization threshold energies for the outermost populated electron shell .    rather than integrate eq .",
    "[ eq : alphacdicomp ] using eq .",
    "[ eq : xsec - cdi ] , which can be computationally expensive , we computed @xmath165 for each shell using the fitting formulae of @xcite , for which the same fitting coefficients employed for the cross sections apply .",
    "let @xmath183 , then @xmath184 where @xmath185   +    b \\jks",
    "\\left[1 + x   - x ( 2 +   x ) f_{_1}(x ) \\right ] \\\\[10pt ] & & \\!\\ !",
    ",   c \\jks f_{_1}(x ) + d \\jks \\ , x   f_{_2}(x ) \\ , \\end{array}\\ ] ] and where @xmath186 the integral for @xmath187 is the well known exponential function .",
    "both @xmath187 and @xmath188 are computed from the closed form formulae given in @xcite , incorporating the corrections given by @xcite .",
    "we then compute the total direct collisional ionization rate coefficient , @xmath189 , for ion @xmath20 using eq .",
    "[ eq : alpchcditot ] .",
    "we also examined the rate coefficient formulae and parameters of @xcite , but found the results comparable .",
    "excitation auto - ionization ( e - a ) occurs in ions with many inner filled shell electrons and only a few outer shell electrons .",
    "a collision with a free electron first excites the ion .",
    "then , during the internal de - excitation process the released energy can either channel into recombination emission lines or into liberating an outer shell electron , which is auto - ionization , @xmath190 where @xmath191 the free collisional electron and the @xmath192 is ejected auto - ionized electron .",
    "the ionization rate for destruction of ion @xmath20 due to e - a collisional ionization is obtained by multiplying the e - a collisional ionization rate coefficient , @xmath193 , by the number density of free electrons , @xmath194    the total e - a rate coefficient is given by the expectation value @xmath195 computed from eq .  [ eq : alphacdicomp ] with @xmath173 replaced by @xmath196 , the e - a onset energy and @xmath168 replaced by @xmath197 , the total e - a cross section , which is obtained by weighting the de - excitation transition channels over all transitions .    the e - a cross sections and rate coefficients depend on the bound electron configuration of the ion , i.e. , the isoelectronic sequence .",
    "for example , c@xmath139 , n@xmath198 , and o@xmath135 all have the electron configuration of neutral lithium ( 1s@xmath1992s ) and are thus lithium isosequence ions ( @xmath200 ) .",
    "there is no e - a process for hydrogen and helium sequence ions . for lithium sequence ions ,",
    "the dominant contribution to the cross section is the 1s2p transition . as the charge of the ion , @xmath201 , increases , the branching ratio to e - a decreases .",
    "no significant e - a contribution to the direct collisional cross section is observed for the beryllium sequence ( except perhaps o@xmath198 , which is neglected ) , nor for the sequences from boron to neon , which differ only in the number of 2p shell electrons . for the sodium sequence ( @xmath202$]3s@xmath203 ) ,",
    "up to 18 transitions can contribute to e - a , for which the relative importance increases with @xmath201 .",
    "the sequences from magnesium to argon differ in the number of 3p shell electrons , and the relative importance of e - a decreases as the shell fills .",
    "lrclcccc @xmath204$]2s@xmath203 li & 3 & 428 & @xmath205 & @xmath206 & @xmath207 & @xmath208 & 20 + @xmath209$]3s@xmath203 na ( low @xmath201 ) & 11 & 1216 & @xmath210 & @xmath211 & @xmath212 & @xmath213 & 1 + @xmath209$]3s@xmath203 na ( high @xmath201 ) & 11 & 1828 & @xmath214 & @xmath215 & @xmath216 & @xmath213 & 3 + @xmath209$]3s@xmath199 mg & 12 & 1828 & @xmath217 & @xmath201 & @xmath218 & @xmath213 & 3 + @xmath209$]3p@xmath203 al & 13 & 1828 & @xmath219 & @xmath201 & @xmath218 & @xmath213 & 3 + @xmath209$]3p@xmath199 si & 14 & 1828 & @xmath220 & @xmath201 & @xmath218 & @xmath213 & 3 + @xmath209$]3p@xmath221 p & 15 & 1828 & @xmath222 & @xmath201 & @xmath218 & @xmath213 & 3 + @xmath209$]3p@xmath223 s & 16 & 1828 & @xmath224 & @xmath201 & @xmath218 & @xmath213 & 3 + @xmath225$]4s@xmath199 ca@xmath133 & 20 & 20 & 25.0 & @xmath226 & @xmath227 & @xmath228 & @xmath226 + @xmath225$]4s@xmath203 ca@xmath7 & 19 & 20 & 29.0 & @xmath226 & @xmath229 & @xmath228 & @xmath226 + @xmath225$]3d@xmath2214s@xmath199 fe@xmath139 & 23 & 26 & 60.0 & @xmath226 & @xmath230 & @xmath231 & @xmath226 + @xmath225$]3d@xmath1994s@xmath199 fe@xmath198 & 22 & 26 & 73.0 & @xmath226 & @xmath232 & @xmath231 & @xmath226    lcccl @xmath204$]2s@xmath203 li & @xmath233 & @xmath234 & @xmath235 & @xmath236 + @xmath209$]3s@xmath203 na ( low @xmath201 ) & @xmath211 & @xmath237 & 0 & @xmath238 + @xmath209$]3s@xmath203 na ( high @xmath201 ) & @xmath215 & @xmath239 & 0 & @xmath240 + @xmath209$]3s@xmath199 mg & @xmath201 & @xmath241 & 0 & @xmath240 + @xmath209$]3p@xmath203 al & @xmath201 & @xmath241 & 0 & @xmath240 + @xmath209$]3p@xmath199 si & @xmath201 & @xmath241 & 0 & @xmath240 + @xmath209$]3p@xmath221 p & @xmath201 & @xmath241 & 0 & @xmath240 + @xmath209$]3p@xmath223 s & @xmath201 & @xmath241 & 0 & @xmath240 + @xmath225$]4s@xmath199 ca@xmath133 & 1.0 & @xmath242 & 0 & @xmath243 + @xmath225$]4s@xmath203 ca@xmath7 & 1.0 & @xmath244 & 0 & @xmath243 + @xmath225$]3d@xmath2214s@xmath199 fe@xmath139 & 1.0 & @xmath245 & 0 & @xmath246 + @xmath225$]3d@xmath1994s@xmath199 fe@xmath198 & 1.0 & @xmath247 & 0 & @xmath248    we computed the total e - a cross sections and rate coefficients for ions up to nickel using the fitting functions and parameters tabulated by @xcite , with the exceptions of the iron ions , which are computed from the fitting functions and parameters updated by @xcite , and the cross sections for the lithium sequence , which we obtained from @xcite .    in order to simplify the individually presented fitting functions of @xcite and @xcite , we present uniformly generalized fitting functions for which we have distilled several of the their fitting parameters into fewer terms . for ion @xmath20 , the total e - a cross section is computed from @xmath249 where @xmath250 , and where @xmath84 is the incident electron kinetic energy . the range of applicable @xmath201 , and the fitting parameters , @xmath251 , @xmath252 , @xmath123 , @xmath253 , and @xmath254 are listed in upper panel of table  [ tab : ceaxsecs ] as a function of isoelectronic sequence , given by @xmath155 . the translation between isoelectronic sequence and the ion index @xmath20 is given by @xmath255 .",
    "four special cases are treated , for which the fitting function takes the form @xmath256 and for which the fitting parameters are listed in the lower panel of table  [ tab : ceaxsecs ] . in figure",
    "[ fig : ceaxsecs ] , we present the e - a cross sections for mg@xmath7 ( green curve ) , c@xmath257 ( blue curve ) , and o@xmath135 ( red curve ) as a function of the electron energy as computed from eq .",
    "[ eq : xsec - cea ] .    for ion @xmath20 ,",
    "the total e - a rate coefficients are computed from @xmath258 where @xmath259 , and @xmath260 where @xmath187 is given by eq .",
    "[ eq : f1x ] .",
    "the fitting parameters , @xmath252 , @xmath261 , @xmath1 , and coefficients @xmath262 for @xmath263 are listed in table  [ tab : cearates ] .",
    "note that the range of applicable @xmath201 and the ionization potentials used in eq .",
    "[ eq : ceaalpha ] are listed in table  [ tab : ceaxsecs ] .",
    "we treat radiative recombination ( section  [ sec : phr ] ) and dielectronic recombination ( section  [ sec : die ] ) .",
    "charge exchange recombination is discussed in section  [ sec : chargeexchange ] .",
    "radiative recombination is the capture of a free electron by ion @xmath141 followed by the emission of a photon , @xmath264    the radiative recombination rate for creation of ion @xmath20 due to electron recombination with ion @xmath141 is obtained by multiplying the total recombination rate coefficient , @xmath265 , by the electron number density , @xmath266    the cross section for capture of a free electron decreases with electron kinetic energy . given the cross section , @xmath267 , for radiative recombination to shell @xmath105 forming ion @xmath20 ,",
    "the radiative recombination rate coefficient for the shell , @xmath268 , is obtained by integrating over all electron velocities , analogous to eq .",
    "[ eq : alphacdicomp ] , i.e. , with no threshold energy ( @xmath269 ) and with @xmath168 replaced by @xmath270 .",
    "we have ignored radiation induced recombination .",
    "the total recombination rate coefficient is the sum over all shells , @xmath271    for hydrogenic ions ( @xmath272 ) we use the formula originally proposed by @xcite , which is highly accurate @xcite , @xmath273 \\ , , \\ ] ] where @xmath274 and where @xmath275 .    the atomic and molecular diagnostic processes in plasmas ( amdpp ) group has published fitting functions and parameters for radiative recombination rate coefficients for many non - hydrogenic ions @xcite .",
    "the functional form is @xmath276      ^{b ' \\subkj - 1 } } { \\left [ 1 + \\left ( t / t^{\\hbox{\\tiny ( 1)}}\\subkj \\right ) ^{\\hbox{\\tiny 1/2 } } \\right ]      ^{b ' \\subkj + 1 } } \\ , , \\ ] ] where @xmath277 , @xmath278 , @xmath279 are tabulated fitting parameters , and @xmath280 , where @xmath281 , @xmath282 and @xmath283 are additional fitting parameters .",
    "data are tabulated for all elements from helium to zinc for isoelectronic sequences up to the magnesium sequence ( [ ne]3s@xmath284 , @xmath285 ) .",
    "the fitting functions neglect narrow resonant spikes .",
    "since not all ionization stages have been tabulated by @xcite , we employed the fitting functions and parameters for the simple power - law form published by @xcite , based upon work of @xcite , @xcite , and @xcite for cases omitted from the amdpp tables .",
    "the expression is @xmath286 where @xmath287 , and where @xmath277 and @xmath288 are the fitting parameters tabulated by @xcite for all ions of helium through nickel .",
    "dielectronic recombination often dominates over radiative recombination . in this process",
    ", a high energy free electron first excites a bound deep inner shell electron prior to its capture in an elevated excited state of the ion .",
    "there are now two excited electrons and an unfilled state in an inner shell .",
    "multiple channels of relaxation for the ion are now available ( of which one is also auto - ionization ) .    in dielectronic recombination , the doubly excited ion works its way back to the ground state via multiple radiative cascades . at high temperatures this process usually proceeds first by the decay of one of the excited electrons to refill the empty inner shell by radiative decay followed by a downward cascade of the remaining excited electron . at low temperatures ,",
    "the dominant channel occurs when the free electron is capture in a shell that is a resonant state to the emptied inner shell .",
    "the electron transitions rapidly and is then followed by a downward cascade of the remaining excited electron .",
    "the reaction can be written @xmath289 where the sum indicates that several recombination photons can be emitted during the cascade process .",
    "the dielectronic recombination rate for creation of ion @xmath20 due to electron recombination with ion @xmath141 is obtained by multiplying the total dielectronic recombination rate coefficient , @xmath290 , by the electron number density , @xmath291    since the dominant channels for dielectronic recombination are temperature dependent , the rate coefficient is double peaked . for this reason ,",
    "previous fitting functions and parameters for the rate coefficients were split into a low temperature regime @xcite and high temperature regime @xcite .",
    "a newer fitting function and accompanying parameter list for all elements from helium to zinc and valid for temperatures ranging from @xmath292 to @xmath293k has been made available by the amdpp group .",
    "we used the fitting functions and parameters described in @xcite , which are based upon a series of papers ( see references in * ? ? ?",
    "* ; * ? ? ?",
    "the fitting function has the form @xmath294 where @xmath295 is the number of fitting parameters for ion @xmath20 , and @xmath296 and @xmath297 are the fitting parameters .",
    "charge exchange is the transfer of an electron from one ion to another during a collision . since hydrogen is the most abundant species , a charge exchange with a given metal ion @xmath20",
    "is dominated either by ionization ( @xmath298 ) from an ionized hydrogen ( in which the h@xmath7 ion recombines with the exchanged electron ) , or by recombination ( @xmath299 ) via the ionization of neutral hydrogen , @xmath300 helium is also relatively abundant and is the second most important charge exchange channel , @xmath301    the rate for destruction of ion @xmath20 via charge exchange ionization with ionized hydrogen ( @xmath302 ) is @xmath303 where @xmath304 is the ionization rate coefficient .",
    "the rates for creation of ion @xmath29 via destruction of ion @xmath20 via charge exchange recombination with neutral hydrogen ( @xmath305 ) and with neutral helium ( @xmath306 ) are given by @xmath307 r ^{\\hbox{\\tiny xhe}}_{\\hbox{\\tiny k , j } } ( t ) \\!\\!\\!\\ ! & = & \\!\\!\\!\\ !   n_{\\hbox{\\tiny 2,1 } } \\beta ^{\\hbox{\\tiny xhe}}_{\\hbox{\\tiny k , j-1 } } ( t ) \\",
    ", , \\end{array}\\ ] ] where @xmath308 and @xmath309 are the respective recombination rate coefficients .",
    "we computed the total charge exchange ionization and recombination rate coefficients using the fitting function and parameters of @xcite .",
    "the rate coefficient for recombination to ion @xmath20 via charge exchange from neutral hydrogen is given by @xmath310 \\",
    ", , \\label{eq : exhion}\\ ] ] where @xmath287 , and where @xmath311 , @xmath281 , @xmath282 , and @xmath312 are the fitting parameters .",
    "the rate coefficient for ionization of ion @xmath20 via charge exchange to neutral hydrogen is obtained via detailed balancing , @xmath313 where the boltzmann factor , @xmath314 , is also tabulated by @xcite .",
    "the computation of the recombination rate coefficient for charge exchange with neutral helium , @xmath315 , is also obtained from eq .",
    "[ eq : exhion ] using the parameters applicable to these reactions .",
    "the charge exchange ionization of metals via ionized helium is not treated because , to date , there is not a uniform set of published rates covering a wide range of ions .",
    "the fitting parameters provided by @xcite are presented for all species up to and including zinc , but only for the first three ionization stages . for ions with @xmath316",
    ", we use the asymptotic formulae of @xcite , @xmath317 for hydrogen , and @xmath318 for helium .",
    "the different constants are due to the different reduced masses of hydrogen and helium .      here",
    ", we derive the rate equations , @xmath319 , for all ionization stages of all treatable species .",
    "we assume two - level atoms , effectively the ground state and the continuum .    for the following , we drop the explicit temperature dependence of all rates and rate coefficients .",
    "we remind the reader that for recombination , the rate coefficients , @xmath34 , are indexed to the final state .",
    "however , we use the convention that all rates , @xmath320 , are indexed by the initial state .",
    "hydrogen is the simplest case because the channels for creation and destruction involve only two adjacent ionization stages .",
    "because of this , the hydrogen rate equations for @xmath321 and @xmath322 are antisymmetric , @xmath323 \\displaystyle \\frac{dn_{\\hbox{\\tiny 1,2}}}{dt } \\!\\!\\!\\ ! & = & \\!\\!\\!\\ !",
    "\\displaystyle - \\frac{dn_{\\hbox{\\tiny 1,1}}}{dt }   \\ , .",
    "\\end{array } \\label{eq : hydrogenrateeq}\\ ] ] the creation rates of @xmath321 are due to the recombination of @xmath322 with free electrons , @xmath324 , and ionization charge exchange from metals , @xmath325 , where @xmath326 r^{\\hbox{\\tiny xh$^{+}$}}_{\\hbox{\\tiny 1,2 } } \\!\\!\\!\\ ! & = & \\!\\!\\!\\ ! \\sum \\limits_{\\hbox{\\tiny k=2 } } \\sum \\limits_{\\hbox{\\tiny j=1}}^{\\hbox{\\tiny k } }       { \\nkj } { \\acth } \\ , .",
    "\\end{array}\\ ] ] the destruction rates of @xmath321 are due to photoionization , @xmath327 , collisional ionization via free electrons , @xmath328 , and recombination charge exchange to metals , @xmath329 , which ionizes neutral hydrogen , where @xmath330 r^{\\hbox{\\tiny xh}}_{\\hbox{\\tiny 1,1 } } \\!\\!\\!\\ ! & = & \\!\\!\\!\\ !    \\sum",
    "\\limits_{\\hbox{\\tiny k=2 } } \\sum \\limits_{\\hbox{\\tiny j=2}}^{\\hbox{\\tiny k+1 } }       { \\nkj } { \\bcth } \\ , .",
    "\\end{array}\\ ] ] note that the negative of these rates are also the destruction and creation rates of @xmath322 , respectively .",
    "helium has three ionization stages .",
    "there is no published auger channel directly connecting the neutral and fully ionized stages ; however , non - zero dielectronic rate coefficients for the channel from singly ionized to neutral helium exist . the rate equation for neutral helium is @xmath331 the creation rates of @xmath332 are due to the recombination channels of @xmath333 with free electrons , @xmath334 , and ionization charge exchange from metals , @xmath335 , where @xmath336 r^{\\hbox{\\tiny xhe$^{+}$}}_{\\hbox{\\tiny 2,2 } } \\!\\!\\!\\ ! & = & \\!\\!\\!\\ !",
    "n_{\\hbox{\\tiny 1,1 } } \\alpha ^{\\hbox{\\tiny xhe$^{+}$}}_{\\hbox{\\tiny 1,1 } } + \\sum \\limits_{\\hbox{\\tiny k=3 } } \\sum \\limits_{\\hbox{\\tiny j=1}}^{\\hbox{\\tiny k } }      { \\nkj } \\alpha ^{\\hbox{\\tiny xhe$^{+}$ } } \\subkj \\ , .",
    "% { \\acth } \\ , .",
    "\\end{array}\\ ] ] recall , however , that we do not treat charge exchange ionization from ionized helium , so @xmath337 for our work .",
    "the destruction rates of @xmath332 are due to photoionization , @xmath338 , collisional ionization via free electrons , @xmath339 , and recombination charge exchange to metals , @xmath340 , which singly ionizes neutral helium , where @xmath341 r^{\\hbox{\\tiny xhe}}_{\\hbox{\\tiny 2,1 } }    \\!\\!\\!\\ ! & = & \\!\\!\\!\\ !",
    "n_{\\hbox{\\tiny 1,2 } } \\beta ^{\\hbox{\\tiny xhe}}_{\\hbox{\\tiny 1,1 } } + \\sum \\limits_{\\hbox{\\tiny k=3 } } \\sum \\limits_{\\hbox{\\tiny j=2}}^{\\hbox{\\tiny k+1 } }      { \\nkj } { \\bcthe } \\",
    ", , \\end{array}\\ ] ] respectively . for twice ionized helium , the rate equation is @xmath342 the creation rates via the destruction of @xmath333 are due to photoionization , @xmath343 , collisional ionization , @xmath344 , and ionization via charge exchange recombination to ionized hydrogen , where @xmath345 r^{\\hbox{\\tiny xh$^+$}}_{\\hbox{\\tiny 2,2 } }   \\!\\!\\!\\ ! & = & \\!\\!\\!\\ !",
    "n_{\\hbox{\\tiny 1,2 } } \\alpha^{\\hbox{\\tiny xh$^+$}}_{\\hbox{\\tiny 2,2 } } \\ , .",
    "\\end{array}\\ ] ] the destruction rates of @xmath346 are due to the channels of recombination with free electrons , @xmath347 , and recombination via charge exchange ionization of neutral hydrogen , where @xmath348 r^{\\hbox{\\tiny xh}}_{\\hbox{\\tiny 2,3 } } \\!\\!\\!\\ ! & = & \\!\\!\\!\\ !",
    "n_{\\hbox{\\tiny 1,1 } } \\beta^{\\hbox{\\tiny xh}}_{\\hbox{\\tiny 2,2 } } \\ , .",
    "\\end{array}\\ ] ] for singly ionized helium , the creation and destruction rates are simply the negative of the sum of those for neutral and doubly ionized helium , @xmath349      here , we write out the rate equations for all ions with @xmath350 . for what follows ,",
    "let @xmath351 denote the creation rate of @xmath352 via ionization of @xmath353 and let @xmath354 denote the creation rate of @xmath352 via recombination from initial state @xmath355 .",
    "further , let @xmath356 denote the destruction rate of @xmath352 via recombination to final state @xmath353 and let @xmath357 denote the destruction of @xmath352 via ionization to final state @xmath355 .",
    "we then write @xmath358 & &   -   n_{\\hbox{\\tiny k , j } } \\",
    "! \\left ( r^{\\hbox{\\tiny ion}}_{\\hbox{\\tiny k , j } }    +   r^{\\hbox{\\tiny rec}}_{\\hbox{\\tiny k , j } } +   { \\textstyle \\sum \\limits_{\\hbox{\\tiny m = j+2}}^{\\hbox{\\tiny k-1 } } }      r^{\\hbox{\\tiny aug}}_{\\hbox{\\tiny k , j , m } } \\right ) \\ , . \\end{array } \\label{eq : dnkjdt}\\ ] ] the creation rate of @xmath42 via ionization destruction of adjacent ion @xmath359 is @xmath360 note that we do not treat charge exchange ionization from ionized helium . the creation rate of @xmath42 via recombination destruction of adjacent ion @xmath361 is @xmath362    the recombination destruction rate of @xmath42 to adjacent stage @xmath363 and the ionization destruction rate of @xmath42 to adjacent stage @xmath361 , are @xmath364 r^{\\hbox{\\tiny ion}}_{\\hbox{\\tiny k , j } } \\!\\!\\!\\ ! & = & \\!\\!\\!\\ !",
    "r^{\\hbox{\\tiny ph}}_{\\hbox{\\tiny k , j } }   +   \\eden \\ !",
    "\\left ( \\alpha^{\\hbox{\\tiny cdi}}_{\\hbox{\\tiny k , j } }   +                   \\alpha^{\\hbox{\\tiny cea}}_{\\hbox{\\tiny k , j } } \\right )   +   n_{\\hbox{\\tiny 1,2 } } \\alpha^{\\hbox{\\tiny xh$^+$}}_{\\hbox{\\tiny k , j } }   \\ , , \\end{array } \\label{eq : rionrreckj}\\ ] ] respectively .",
    "the summation terms in eq .",
    "[ eq : dnkjdt ] account for auger ionization processes , which skip adjacent ionization stages .",
    "all ions of species @xmath15 from the neutral stage to ionization stage @xmath365 can contribute to the creation rate of @xmath366 due to their destruction via auger ionization @xmath367 similarly , ion @xmath20 can be destroyed by auger ionization to high ionization final stage @xmath144 , where @xmath368 , @xmath369 in practice , auger ionization is a viable creation and destruction channel only for @xmath370 .",
    "if there are @xmath371 atomic species included in the cloud model , then there are @xmath372 non - linear rate equations to be solved , one for each @xmath373 .",
    "the equilibrium solution is obtained when @xmath374 is satisfied for all @xmath15 and @xmath16 ( see eqs .",
    "[ eq : hydrogenrateeq ] , [ eq : heliumirateeq ] , [ eq : heliumiiirateeq ] , [ eq : heliumiirateeq ] , and [ eq : dnkjdt ] ) . the system of equations is `` closed '' by enforcing charge density conservation , given by eq .  [",
    "eq : chargeconservation ] .",
    "the rate equations are non - linear because the collisional ionization and recombination rates for ion @xmath20 include the product of the electron density and the density of ion @xmath20 , and the charge exchange rates include the product of the number densities of the hydrogen and helium ions and the density of ion @xmath20 .    here , we describe our method of linearizing the systems of equations .",
    "we begin be rearranging the rate equations in terms of the ionization fractions , @xmath375 as we show below , this formalism allows us to solve for the ratios of the number densities of adjacent ionization stages @xmath376 . defining @xmath377 , the ionization fractions , @xmath378 ,",
    "are then computed using a recursive formula .",
    "writing @xmath379 , we have @xmath380 where by definition @xmath381 .",
    "note that , alternatively , @xmath382 and @xmath383 .",
    "thus , once all @xmath384 are determined , all ionization fractions are determined from which all ionic number densities can be computed .    in order to linearize the equations , we adopt a method that reduces the problem to solving for a single quantity , the electron density .",
    "this requires that we decouple the hydrogen and helium from the metals in order to remove the non - linearity arising from charge exchange with metals . to accomplish this ,",
    "we first obtain an initial estimate for the hydrogen , helium , and electron densities . using brent s method",
    ", we employ charge density conservation ( eq .  [ eq : chargeconservation ] ) to solve for the equilibrium electron density for a gas cloud composed of hydrogen and helium only . for hydrogen",
    ", we apply eq .",
    "[ eq : rearrange ] and rearrange eq .",
    "[ eq : hydrogenrateeq ] to obtain , @xmath385 and for helium we rearrange eqs .",
    "[ eq : heliumirateeq ] and [ eq : heliumiirateeq ] , to obtain @xmath386 f_{\\hbox{\\tiny 2,1 } }   \\!\\!\\ ! & = & \\!\\!\\ !",
    "\\displaystyle   \\frac{1}{1+\\phi_{\\hbox{\\tiny 2,1}}+\\phi_{\\hbox{\\tiny 2,1 } } \\phi_{\\hbox{\\tiny 2,2 } } } \\ , , & f_{\\hbox{\\tiny 2,2 } }   \\!\\!\\ ! & = & \\!\\!\\ !",
    "\\displaystyle \\phi_{\\hbox{\\tiny 2,1 } } f_{\\hbox{\\tiny 2,1 } } \\ , , \\ , f_{\\hbox{\\tiny 2,3 } }    =   \\displaystyle \\phi_{\\hbox{\\tiny 2,2 } } f_{\\hbox{\\tiny 2,,2 } } \\ , .",
    "\\end{array}\\ ] ]    with an initial estimate of the hydrogen , helium , and electron densities , eq .",
    "[ eq : dnkjdt ] for the metal ions can now be rearranged for each @xmath20 to obtain the recursion formula @xmath387 where @xmath388 and @xmath389 are given by eq .",
    "[ eq : rionrreckj ] , @xmath390 and @xmath391 by eqs .",
    "[ eq : rionkjm ] and [ eq : rreckjp ] , respectively , and the auger destruction and creation rates are @xmath392   r\\aug _ { \\hbox{\\tiny kij } } \\ , , \\ ] ] obtained from eqs .",
    "[ eq : augkj - destruct ] and [ eq : augkj - create ] .",
    "for example , for @xmath174 , we have @xmath393 \\phi_{\\hbox{\\tiny k,2 } }   \\!\\!\\ ! & = & \\!\\!\\ !    \\left (   r^{\\ , \\prime}_{\\hbox{\\tiny k,2 } } - \\phi \\supmo _ { \\hbox{\\tiny k,1 } } r^{\\ , \\hbox{\\tiny ion}}_{\\hbox{\\tiny k,1 } } \\right )   / r\\rec_{\\hbox{\\tiny k,3 } } \\ , , \\\\[7pt ] \\phi_{\\hbox{\\tiny k,3 } }   \\!\\!\\ ! & = & \\!\\!\\ !   \\left (   r^{\\ , \\prime}_{\\hbox{\\tiny k,3 } } - \\phi \\supmo _ { \\hbox{\\tiny k,2 } } r^{\\ , \\hbox{\\tiny ion}}_{\\hbox{\\tiny k,2 } }   - \\phi \\supmo _ { \\hbox{\\tiny k,1 } }   \\phi \\supmo _ { \\hbox{\\tiny k,2 } } r^{\\ , \\hbox{\\tiny aug}}_{\\hbox{\\tiny k,1,3 } } \\right )   / r\\rec_{\\hbox{\\tiny k,4 } } \\ , , \\\\[7pt ] \\phi_{\\hbox{\\tiny k,4 } }   \\!\\!\\ ! & = & \\!\\!\\ !   \\left ( r^{\\ , \\prime}_{\\hbox{\\tiny k,4 } } - \\phi \\supmo _ { \\hbox{\\tiny k,3 } } r^{\\ , \\hbox{\\tiny ion}}_{\\hbox{\\tiny k,3 } }   -   \\phi \\supmo _ { \\hbox{\\tiny k,1 } } \\phi \\supmo _ { \\hbox{\\tiny k,2 } } \\phi \\supmo _ { \\hbox{\\tiny k,3 } } r^{\\ , \\hbox{\\tiny aug}}_{\\hbox{\\tiny k,1,4 } }   - \\phi \\supmo _ { \\hbox{\\tiny k,2 } }   \\phi \\supmo _ { \\hbox{\\tiny k,3 } } r^{\\ , \\hbox{\\tiny aug}}_{\\hbox{\\tiny k,2,4 } } \\right )   / r\\rec_{\\hbox{\\tiny k,5 } } \\ , . \\end{array}\\ ] ] where we combined the destruction rates into the single term @xmath394 . from the @xmath395",
    ", we apply eq .",
    "[ eq : defionfracs ] to compute the ionization fractions for all metal ions .",
    "we then refine the hydrogen and helium ionization fractions by including charge exchange with metals ions , @xmath396 \\phi_{\\hbox{\\tiny 2,1 } }   \\!\\!\\ ! & = & \\!\\!\\ !",
    "\\displaystyle   \\frac{\\displaystyle r\\ph_{\\hbox{\\tiny 2,1 } } + \\eden \\alpha^{\\hbox{\\tiny cdi}}_{\\hbox{\\tiny 2,1 } }   + n_{\\hbox{\\tiny a } } \\eta _ { \\hbox{\\tiny 1 } } f_{\\hbox{\\tiny 1,2 } } \\beta ^{\\hbox{\\tiny xhe}}_{\\hbox{\\tiny 1,1 } } + n_{\\hbox{\\tiny a } } \\textstyle \\sum \\limits_{\\hbox{\\tiny k=3 } } \\eta\\subk \\sum \\limits_{\\hbox{\\tiny j=2}}^{\\hbox{\\tiny k+1 } } f\\subkj { \\bcthe } } { \\displaystyle \\eden \\beta^{\\hbox{\\tiny phr}}_{\\hbox{\\tiny 2,1 } } }   \\ , , \\\\[15pt ] \\phi_{\\hbox{\\tiny 2,2 } }   \\!\\!\\ ! & = & \\!\\!\\ !",
    "\\displaystyle   \\frac{\\displaystyle r\\ph_{\\hbox{\\tiny 2,2 } } + \\eden \\alpha^{\\hbox{\\tiny cdi}}_{\\hbox{\\tiny 2,2 } }    + n_{\\hbox{\\tiny a } } \\eta _ { \\hbox{\\tiny 1 } } f_{\\hbox{\\tiny 1,2 } } \\alpha^{\\hbox{\\tiny xh$^+$}}_{\\hbox{\\tiny 2,2 } }   } { \\displaystyle \\eden \\beta^{\\hbox{\\tiny phr}}_{\\hbox{\\tiny 2,2 } } + n_{\\hbox{\\tiny a } } \\eta _ { \\hbox{\\tiny 1 } } f_{\\hbox{\\tiny 1,1 } } \\beta^{\\hbox{\\tiny xh}}_{\\hbox{\\tiny 2,2 } } } \\ , , \\end{array } \\label{eq : hherefine}\\ ] ]    we remind the reader that we do not treat charge exchange ionization of metals from ionized helium ( which would appear as a additional recombination term in the denominator of the expression for @xmath397 ) .    using brent s method , we iteratively apply eqs .",
    "[ eq : phikj - metals][eq : hherefine ] to converge on the full equilibrium solution by enforcing charge density conservation via eq .",
    "[ eq : chargeconservation ] .",
    "the method solves for the logarithm of the equilibrium electron density to a precision of @xmath398 .",
    "the high precision is required in order to constrain ions that yield small donations to the free electron pool ; mostly these are the elements with the lowest abundances .",
    "since the initial estimate of the hydrogen , helium , and electron density from a zero metallicity gas typically provides @xmath399 to 2 - 3 decimal points of accuracy , usually only 5 - 7 iterations are required to converge @xmath399 to 20 decimal points of accuracy .    in the case of low ionization clouds ,",
    "the ions with the least constrained number densities are the high ionization stages of the low abundance species , since they contribute negligibly to the free electron pool . in the case of high ionization clouds ,",
    "the same applies to the low ionization stages of the low abundance species . in other words ,",
    "the method s strength is that it best constrains the number densities of the ionic stages that contribute the most to the electron pool .",
    "once all ionization fractions are solved , the ion number densities are computed from @xmath400 .",
    "because we do not yet treat radiative transfer through the cloud models ( grid cells ) , currently is appropriate only for optically thin gas ( also see * ? ? ?",
    "* ) . by optically thin",
    ", we employ the definition that the optical depth is less than unity at the hydrogen ionization edge ( 13.6 ev ) , and at both the neutral and singly ionized helium ionization edges ( 24.6 and 54.4 ev , respectively ) , which dominate modification of the ionizing sed .    to illustrate how the ionization edges modify the ionizing sed as cloud models become progressively more optically thick , we plot the mean intensity of the attenuated sed transmitted though various cloudy 13.03 models as a function of photon energy in figure  [ fig : shield ] .",
    "the black curves are the incident @xcite uvb for @xmath12 .",
    "the clouds models have metallicity of 0.1 solar .",
    "blue , green and , red curves show the attenuated transmitted spectrum after having passed through cloud models with fixed @xmath401 , 18.0 , and 18.5 , respectively .",
    "three hydrogen densities are illustrated , @xmath402 , @xmath403 , and @xmath404 .",
    "the ground - state ionization edges of h@xmath133 , he@xmath133 , and he@xmath7 are shown as vertical dotted lines . for reference ,",
    "vertical ticks indicate the ground - state ionization edges of mg@xmath7 ( ) , c@xmath257 ( ) , and o@xmath135 ( ) .",
    "clearly , the number density of ionizing photons for these important metal species can be substantially reduced with depth into the cloud model , resulting in ionization structure in the cloud model and lower ionization conditions in the shielded regions .",
    "since the optical depth is the product of the cross section for bound - free absorption and the column density of the absorbing ion , we can determine the upper limit on the h@xmath133 , he@xmath133 , and he@xmath7 column densities that satisfy our criterion of an upper limit of unity optical depth at the respective ionization edges . for ground state hydrogen and",
    "singly ionized helium , the optical depth at the ionization edge is @xcite , @xmath405 where @xmath406 is the column density , @xmath407 is the bound - free cross section for at the ionization energy from the ground state , @xmath201 is the number or protons in the nucleus , and @xmath408 is the reduced mass of the electron , @xmath409 , where @xmath410 is the nuclear mass of species @xmath15 . for hydrogen , @xmath411 and @xmath412 , and for helium , @xmath413 and @xmath414 .",
    "thus , for @xmath415 , the cloud model is constrained to have @xmath416 @xmath77 for neutral hydrogen and @xmath417 @xmath77 for singly ionized helium .    for ground state neutral helium , the optical depth of the ionization edge is @xcite , @xmath418 where @xmath419 is the effective nuclear charge due to screening , @xmath420   is the wavelength at the ionization edge , and @xmath421 is the bound - free gaunt factor @xcite .",
    "evaluating , we obtain the constraint @xmath422",
    "@xmath77 for @xmath415 .    in terms of the limiting column densities ,",
    "the optically thin constraints place upper limits on the model cloud depth , @xmath423 , which is to say , in our application , that it places an upper limit on the grid cell size before self - shielding must be treated .",
    "geometrically , @xmath424 , where @xmath425 is the ionization fraction of neutral hydrogen .",
    "when @xmath426 @xmath77 , then @xmath427 corresponds to the cloud depth at which the optical depth at the hydrogen ionization edge is unity .",
    "similarly , for neutral helium , the upper limit is @xmath428 for @xmath429 @xmath77 , where @xmath430 and @xmath431 are the abundance fractions of hydrogen and helium , respectively ( see section  [ sec : abundances ] ) . for singly ionized helium , @xmath432 for @xmath433 @xmath77 .    assuming a fairly constant ratio @xmath434 , we can rewrite the cell upper limits as follows , @xmath435 l\\subhenot^{\\rm max } & \\simeq & 9 \\cdot ( { 0.01}/{f\\subhenot } ) ( { 0.01}/{n\\subh } ) \\quad { \\rm kpc } \\\\[5pt ] l\\subheplus^{\\rm max } & \\simeq & 20 \\cdot ( { 0.01}/{f\\subheplus } )   ( { 0.01}/{n\\subh } )   \\ , .",
    "\\end{array } \\label{eq : maxcell}\\ ] ] for the criterion of optically thin radiative transfer , the upper limit on the cloud depth , @xmath436 , is the minimum of @xmath427 , @xmath437 , and @xmath438 .",
    "as the radiation propagates deeper into the cloud , the mean intensity of the sed will be modified by ionization ( the sed is `` softened '' by the removal of high energy photons ) . as such",
    ", @xmath436 is the depth into the cloud to which the ionization structure is constant .",
    "the minimum comoving cell size for the hydroart simulations is roughly @xmath11 pc ( @xmath439 kpc ) and the proper size decreases with redshift in proportion to @xmath440 . from eq .",
    "[ eq : maxcell ] , we see that only in cases where the product of the ionization fraction and the hydrogen number density exceed @xmath91 does the maximum cell size decrease from the fiducial values of 0.5 , 9 and 20 kpc for the respective ionization edges . in figure  [",
    "fig : fh1 ] , we plot the ionization fractions for h@xmath133 ( top ) , he@xmath441 ( center ) , and he@xmath7 ( bottom ) as a function of hydrogen number density , @xmath442 , for constant density and isothermal optically thin clouds .",
    "four temperatures are presented , @xmath443 , 4 , 5 , and 6 as black , blue , red , and green curves , respectively .",
    "examining the behavior of the ionization fractions and propagating them through eq .",
    "[ eq : maxcell ] , we find that is currently not valid for `` cold '' cells ( @xmath444 ) with densities @xmath445 nor for `` warm / hot '' cells ( @xmath446 ) with densities @xmath447 .",
    "the most important quantities for comparing ionization codes are the ionization fractions . in particular , those of hydrogen and helium are critical since they dictate the conditions of the onset of self shielding to the ionizing radiation . to compare these ionization fractions between and cloudy 13.03 , we ran both codes and created a grid of cloud models while enforcing the optically thin constraint .",
    "we present the ionization fractions in figure  [ fig : fh1 ] .",
    "the dashed curves are cloudy models and the solid curves are models . for both codes , we assume constant density isothermal cloud models with no dust , no cosmic ray heating , a metallicity of 10% solar , and a @xcite uvb at @xmath12 .",
    "is in general excellent agreement with cloudy .",
    "however , there are deviations of up to a factor of two in @xmath448 for @xmath449 at all @xmath3 and for @xmath450 for @xmath451 at @xmath452 . at these temperature ,",
    "collisional ionization is becoming more important relative to photoionization .",
    "we have not identified the source of the discrepancy with the he@xmath453 ion in this regime .",
    "one main difference between and cloudy is that cloudy handles recombination levels , whereas assumes two - level ions ( ground state and the continuum ) . in cloudy",
    ", the he@xmath453 ion includes the full helium isoelectronic sequence @xcite .",
    "we now compare the ionization fractions between and cloudy for the metal ions mg@xmath7 , c@xmath139 , and o@xmath454 . for this discussion ,",
    "we slightly modify our notation from section  [ sec : themodel ] such that species @xmath15 in ionization stage @xmath16 is denoted by the somewhat more familiar notation @xmath455 denoting species @xmath456 in ionization stage @xmath16 .    for a constant density gas cloud ,",
    "the column density of species @xmath457 in ionization stage @xmath16 , denoted @xmath458 , is @xmath459 where the number density of ion @xmath460 is @xmath461 , the ionization fraction ( from the ionization model ) is @xmath462 , and the number density of species @xmath456 is @xmath463 .",
    "the quantity @xmath464 is the cloud depth .",
    "observers often combine the measured column density , @xmath465 , with ionization modeling to estimate the pathlength through the absorbing gas , using the expression @xmath466 . for our comparison with cloudy",
    ", we adopt this convention because , observationally , @xmath465 is a directly measurable quantity , whereas @xmath464 is not and must be inferred from the ionization modeling .    substituting the above expression @xmath464 into eq .",
    "[ eq : modelnxj ] , we obtain the `` observers''expression for the cloud column density for metal ion @xmath460 , @xmath467 where @xmath468 corresponds to the abundance ratio @xmath469 .",
    "the second term on the right hand side of equation  [ eq : nxj ] is known as the ionization correction , @xmath470 .",
    "this term is the critical quantity from ionization models that , for observational work , allows the _ measured _ column densities to be used as constraints for inferring gas phase abundances by solving @xmath471 .",
    "however , our application with the simulations will be slightly different ( see * ? ? ?",
    "* ) ; we know the line - of - sight pathlength through the cell and the elemental abundances in the grid cell in the simulation and employ to determine the cell column densities using eq .",
    "[ eq : modelnxj ] .    given the methods of application described above , we focus on the ionization correction as the central quantity for comparing and cloudy .",
    "we define @xmath472 which , for fixed @xmath465 and @xmath473 , provides a direct measure of logarithmic difference in the calculated column density between the two ionization models , @xmath474 we computed @xmath475 as a function of @xmath3 and @xmath13 over the range @xmath476 and @xmath477 for constant density isothermal cloud models .",
    "we apply eq .",
    "[ eq : maxcell ] to ensure that the clouds are optically thin at the hydrogen and helium ionization edges ( which means @xmath465 varies with @xmath3 ) . for both and",
    "cloudy , we assume no dust , no cosmic ray heating , a metallicity of 10% solar , and a @xcite uvb at @xmath12 for the ionizing spectrum .    in figure  [",
    "fig : amber ] , we plot smoothed @xmath475 surfaces as a function of @xmath442 and @xmath478 for the three commonly observed ions , @xmath479 ( left panel ) , c@xmath139 ( center ) , and o@xmath135 ( right ) .",
    "the presented ranges of the density and temperature vary slightly from ion to ion based on the appropriate ranges of gas phase in which they are dominant ( see * ? ? ?",
    "the values of @xmath475 are provided in the color bar .    since typical uncertainties in observed column density measurements",
    "are @xmath480 in the logarithm , values of @xmath481 between the two ionization models would be consistent with typical measurement errors in @xmath482 .",
    "this level of uncertainty corresponds to the green area of the surface in figure  [ fig : amber ] .",
    "thus , the green area provides the @xmath442@xmath13 ranges over which the difference in the ionization correction between and cloudy are within reasonable observational measurement uncertainties , and can therefore be considered to yield column densities that are consistent within practical errors .",
    "the larger departures in @xmath475 ( blue and red regions ) are due to ( 1 ) the linearization method employed for ( see section  [ sec : solution ] ) , and ( 2 ) the convention within cloudy to fix @xmath483 or @xmath484 in the cases of very small ionization fractions . for ( 1 ) , it is because we converge the rate matrix using charge density conservation , per eq .",
    "[ eq : chargeconservation ] , so that ions contributing negligibly to the free electron density do not have robustly constrained ionization fractions . since , in these cases , the ionization fractions are typically on the order of @xmath485 or lower ( recall that we conserve charge to this tolerance level ) , these regions of gas phase space are not abundant in the ion .",
    "as such , these phase space regions do not contribute to absorption lines from the ion , and since one of our main goals is to study the absorption properties of the gas in the simulations ( e.g. , * ? ? ?",
    "* ) , the absolute accuracy in the ionization correction for these ions does not impact our science goals .",
    "we have presented the code for computing the equilibrium ionization conditions for astrophysical gaseous environments .",
    "the main motivation for developing is to apply it to amr cosmological simulation in order to study the chemical and ionization conditions of the circumgalactic medium in simulated galaxies using the absorption line technique . for a first application of the code to amr cosmological simulations ,",
    "see @xcite . a stand - alone version of also exists , and has been applied to observational data ( see * ? ? ?",
    "* ; * ? ? ?",
    "the physical gas processes included in are photoionization , auger ionization , direct collisional ionization , excitation auto - ionization , charge exchange ionization , radiative recombination , dielectronic recombination , and charge exchange recombination .",
    "currently , the code handles only optically thin gas .",
    "treatment of optically thick gas will be presented in a companion paper .",
    "is designed to take a minimum number of inputs to define a `` cloud '' model .",
    "the inputs are the gas hydrogen density , @xmath3 , equilibrium temperature , @xmath13 , and the mass fractions of all atomic species . to define the ionizing spectrum , the required inputs are the redshift , @xmath14 , for the @xcite uvb , and if desired , the masses , ages , metallicities , and locations of stellar populations for the starburst99 @xcite sed models .",
    "we compared to cloudy 13.03 by examining the ionization fractions of neutral hydrogen , neutral helium , and singly ionized helium . in the optically thin regime ,",
    "the ionization fractions are highly consistent , except for a factor of 23 difference in the neutral helium values for @xmath486 .",
    "we also presented a comparison of the ionization corrections for the three metal ions mg@xmath7 , c@xmath139 , and o@xmath135 that are responsible for the , , and doublets commonly studied in absorption . over the @xmath442@xmath13 phase space @xmath487 and @xmath488 , the logarithmic difference in the ionization corrections agreed with in @xmath489 .",
    "this agreement is within typical uncertainties of measured logarithmic column densities .",
    "future improvements to the code include ( 1 ) self shielding so that optically thick cloud models can be treated , and ( 2 ) radiative transfer through the simulation box to handle frequency dependent shadowing from structures intervening to luminous sources .",
    "these will be reported in future papers .",
    "the stand - alone version of , is available on - line at _ http://astronomy.nmsu.edu / cwc / software / ioncode/_. this code is useful for generating grids of optically thin model clouds as a function of hydrogen density , temperature , and redshift .",
    "the output includes the equilibrium ionization fractions , number densities , photoionization rates , and ionization and recombination rate coefficients for all collisional processes for all ions .",
    "once self - shielding is added , the code will be updated on - line and will be capable of generating optically thick cloud models .",
    "cwc , ek , and jrv were partially supported through grants hst - ar-12646 and hst - go-13398 provided by nasa via the space telescope science institute , which is operated by the association of universities for research in astronomy , inc .",
    ", under nasa contract nas 5 - 26555 .",
    "cwc acknowledges assistance through the nasa new mexico space grant consortium ( nmsgc ) research enhancement program , which supported am .",
    "jrv acknowledges support through an nmsgc graduate research fellowship .",
    "thanks to r. sutherland for helpful email exchanges and to g. ferland for insightful conversations during his visit to nmsu .",
    "much gratitude goes to d. verner for providing publicly available electronic tables for photoionization , recombination , collisional ionization , and autoionization and some supporting computational subroutines ( _ http://www.pa.uky.edu/  verner/ _ ) .",
    "we are grateful for the work of n. badnell , r. bingham , g. duxbury , and h. summers of the atomic and molecular diagnostic processes in plasmas group ( _ http://amdpp.phys.strath.ac.uk/tamoc/_ ) , who provided radiative and dielectronic recombination rates .",
    "we also thank p. stancil , d. schultz , j. wang , m. rakovi , j. kingdon , and a. dalgarno , of the oakridge national lab uga charge transfer database for astrophysics ( _ http://www-cfadc.phy.ornl.gov/astro/ps/data/_ ) ."
  ],
  "abstract_text": [
    "<S> we present a code for modeling the ionization conditions of optically thin astrophysical gas structures . given the gas hydrogen density , equilibrium temperature , elemental abundances , and the ionizing spectrum </S>",
    "<S> , the code solves the equilibrium ionization fractions and number densities for all ions from hydrogen to zinc . </S>",
    "<S> the included processes are photoionization , auger ionization , direct collisional ionization , excitation auto - ionization , charge exchange ionization , two - body radiative recombination , dielectronic recombination , and charge exchange recombination . </S>",
    "<S> the ionizing spectrum can be generalized to include the ultraviolet background ( uvb ) and/or starburst99 stellar populations of various masses , ages , metallicities , and distances . </S>",
    "<S> the ultimate goal with the code is to provide fast computation of the ionization conditions of gas in n - body + hydrodynamics cosmological simulations , in particular adaptive mesh refinement codes , in order to facilitate absorption line analysis of the simulated gas for comparison with observations . to this end </S>",
    "<S> , we developed a method to linearize the rate equations and efficiently solve the rate matrix with a minimum number of iterations . comparing the code to cloudy 13.03 ( ferland ) </S>",
    "<S> , we find that the hydrogen and helium ionization fractions and the metal species ionization corrections are in excellent agreement . </S>",
    "<S> we discuss the science drivers and plans for further development of the ionization code to a full radiative hydrodynamic routine that can be employed for processing the simulations . </S>",
    "<S> a stand - alone version of the code has been made publicly available . </S>"
  ]
}