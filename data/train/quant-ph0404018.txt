{
  "article_text": [
    "in discussions of quantum information technology @xcite , it has been pointed out that the ability to coherently transfer information between `` flying '' and stationary qubits will be essential .",
    "atomic samples are good candidates for quantum storage and processing due to their long coherence times and large , controllable interactions , while photons are the fastest and most robust way to transfer information .",
    "this implies that methods to transfer information between atoms and photons will be important to the development of this technology .",
    "recently the observation of ultra - slow light ( usl ) @xcite , propagating at group velocities more than seven orders of magnitude below its vacuum speed ( @xmath4 ) , and the subsequent stopping and storing of light pulses in atomic media @xcite has demonstrated a tool to possibly accomplish this @xcite .",
    "the technique relies on the concept of _ electromagnetically induced transparency _",
    "( eit)@xcite in three level @xmath0-configuration atoms ( see fig .  [",
    "fig : diagram](a ) ) .",
    "a coupling light field @xmath5 is used to control the propagation of a pulse of probe light @xmath6 .",
    "the probe propagates at a slow group velocity and , as it is doing so , coherently imprints it s amplitude and phase on the coherence between two stable internal states of the atoms , labelled @xmath7 and @xmath8 ( which are generally particular hyperfine and zeeman sublevels ) .",
    "switching the coupling field off stops the probe pulse and ramps it s intensity to zero , freezing the probe s coherent ( that is , intensity _ and _ phase ) information into the atomic media , where it can be stored for a controllable time . switching the coupling field back on at a later time writes the information back onto a revived probe pulse , which then propagates out of the atom cloud and can be detected , for example , with a photo - multiplier tube ( pmt ) ( see fig .  [",
    "fig : diagram](b ) ) . in the original experiment @xcite ,",
    "the revived output pulses were indistinguishable in width and amplitude from non - stored usl pulses , indicating the switching process preserved the information in the atomic medium with a high fidelity .    * schematic of ultra - slow light ( usl ) and stopped experiments . *",
    "* ( a ) * the @xmath0 energy level structure which we consider has two stable states , @xmath9 and @xmath8 , and an excited state @xmath10 which decays at a rate @xmath11 ( which is @xmath12  mhz for na and @xmath13  mhz for rb-87 ) . atoms which spontaneously decay from @xmath14 are assumed to exit the levels under consideration . *",
    "( b ) * we consider the two light fields to be _ co - propagating _ and input in the @xmath15 direction ( the long axis of the bose - einstein condensate ( bec ) ) at @xmath16 .",
    "the output intensity at @xmath17 can be detected experimentally with a photo - multiplier tube ( pmt ) .",
    "the probe field is pulsed with half - width @xmath18 .",
    "the coupling beam is c.w .",
    "but can be switched off quickly to stop the probe pulse while it is in the bec .",
    "switching it back on later regenerates the probe light pulse . ]",
    "in addition to the ability to store coherent information , compressing ultra - slow probe pulses to lengths shorter than the atomic cloud puts the atoms in spatially dependent superpositions of @xmath7 and @xmath8 , offering novel possibilities to study two component bec dynamics @xcite . in @xcite slow light pulses propagating in bose - einstein condensates ( becs ) @xcite of sodium were used to create density defects with length scales @xmath19 , near the bec healing length , leading to quantum shock waves and the nucleation of vortices .",
    "motivated by both observations of coherent optical information storage in atom clouds and the interesting dynamics which slow and stopped light pulses can induce in becs , the present paper theoretically examines new possibilities offered by stopping light in becs .",
    "we first present a novel treatment of the switching process and establish that the switch - off and switch - on of the coupling field can occur without dissipating the coherent information , provided the length scale of variations in the atomic wavefunctions are sufficiently large .",
    "we find that the switching of the coupling field can be done _",
    "arbitrarily _ fast in the ultra - slow group velocity limit @xmath20 .",
    "this is consistent with previous work @xcite , but goes further as it applies to pulses in both the weak and strong probe regimes @xcite .",
    "we also present the first explicit calculation of how the behavior of the system differs when one switches the coupling field faster than the natural lifetime of the excited state @xmath21 ( see fig .",
    "[ fig : diagram](a ) ) and find the information is successfully transferred even in this regime . furthermore we will see the analysis presented here , being phrased in terms of the spatial characteristics of the atomic wavefunctions , is well suited to addressing the issue of storage for times long compared to the time scale for atomic dynamics .",
    "investigation of this very issue of longer storage times constitute the central results of the paper . in this regime",
    ", there are important differences between optical information storage in becs versus atom clouds above the condensation temperature ( thermal clouds ) , which have been used in experiments to date . during the storage time , the light fields are off and the atomic wavefunctions evolve due to kinetic energy , the external trapping potential , and atom - atom interactions .",
    "( we label all these _ external _ dynamics to distinguish them from couplings between the internal levels provided by the light fields . ) to successfully regenerate the probe pulse by then switching on the coupling field , there must be a non - zero value of the _ ensemble average _",
    "( over all atoms ) of the coherence between @xmath9 and @xmath8 .",
    "when revivals were attempted after longer storage times in thermal clouds ( several milliseconds in @xcite ) the external dynamics had washed out the phase coherence between @xmath7 and @xmath8 ( due to the atoms occupying a distribution of single particle energy levels ) and no output pulses were observed . in zero temperature becs",
    "the situation is completely different .",
    "there each atom evolves in an identical manner , described by a non - linear schrodinger equation ( gross - pitaevskii equation @xcite ) , preserving the ensemble average of the coherence during the external dynamics .",
    "that is , even as the amplitude and phase of the wavefunctions representing the bec evolve , the relative phase of the two components continues to be well defined at all points in space .",
    "thus , if we switch the coupling field back on , we expect that the evolved bec wavefunctions will be written onto a revived probe field . in this way",
    ", the probe pulses can be _ processed _ by the bec dynamics .",
    "we show several examples , relevant to current rb-87 becs , of the interesting two component dynamics which can occur during the storage time .",
    "this atom possesses internal states with very small inelastic loss rates @xcite , and thus , long lifetimes @xcite .",
    "we find that , depending upon the relative scattering lengths of the internal states involved and the relative intensity of the probe and coupling fields , one could observe the formation of interference fringes , gentle breathing motion , or the formation and motion of two - component ( vector ) solitons @xcite .",
    "in particular we find that using the levels @xmath22 and @xmath23 in rb-87 could allow for long , robust storage of information and controllable processing . in each case , we observe the amplitude and phase due to the dynamical evolution is written onto revived probe pulses .",
    "these pulses then propagate out of the bec as slow light pulses , at which point they can be detected , leaving behind a bec purely in its original state @xmath7 .    for practical applications of this technique to storage and processing",
    ", one must understand in detail how , and with what fidelity , the information contained in the atomic coherence is transferred and output on the light fields .",
    "thus , the last part of the paper is devoted to finding the exact relationship between the bec wavefunctions before the switch - on and the observed output probe pulses .",
    "we find equations linking the two in the ideal limit ( without absorption or distortion ) .",
    "then , using our earlier treatment of the switching process , we identify several sources of imperfections and calculate the fidelity of the information transfer for gaussian shaped wavefunctions of various amplitudes and lengths . in the weak probe limit , we find a simple relationship between the wavefunction in @xmath8 and the output probe field .",
    "we find that optimizing the fidelity involves balancing considerations related to , on one hand , absorption of small length scale features in the bec wavefunctions and , on the other hand , imperfect writing of wavefunctions which are too near the condensate edge . for stronger probes ,",
    "we find a more complicated relationship , though we see one can still reconstruct the amplitude and phase of the wavefunction in @xmath24 using only the output probe .",
    "in this regime , we find that the fidelity of the writing and output is nearly independent of the probe strength when the oscillator strengths for the two transitions involved ( @xmath25 and @xmath26 ) are equal . however , unequal oscillator strengths lead to additional distortions and phase shifts , and therefore lower fidelity of information transfer , for stronger probes .",
    "we first , in section  [ sec : formalism ] , introduce a formalism combining maxwell - schrodinger and gross - pitaevskii equations @xcite , which self - consistently describe both the atomic ( internal and external ) dynamics as well as light field propagation .",
    "we have written a code which implements this formalism numerically .",
    "section  [ sec : switching ] presents our novel analysis of the switching process , whereby the coupling field is rapidly turned off or on , and extends previous treatments of the fast switching regime , as described above .",
    "section  [ sec : processing ] shows examples of the very rich variety of two - component dynamics which occur when one stops light pulses in becs and waits for much times longer than the characteristic time scale for atomic dynamics . section  [ sec : systematic ] contains our quantitative analysis of the fidelity with which the bec wavefunctions are transferred onto the probe field .",
    "we conclude in section  [ sec : conclusion ] and anticipate how the method studied here could eventually be applied to transfer of information between distant becs , and the generation of light with squeezed statistics .",
    "we first introduce our formalism to describe the system and review usl propagation within this formalism .",
    "assume a bose - condensed sample of alkali atoms , with each atom in the bec containing three internal ( electronic ) states in a @xmath0-configuration ( fig .",
    "[ fig : diagram](a ) ) .",
    "the states @xmath7 and @xmath27 are stable and the excited level @xmath14 , radiatively decays at @xmath11 . in the alkalis which we consider , these internal levels correspond to particular hyperfine and zeeman sublevels for the valence electron .",
    "when the atoms are prepared in a particular zeeman sub - level and the proper light polarizations and frequencies are used @xcite , this three level analysis is a good description in practice .",
    "all atoms are initially condensed in @xmath9 and the entire bec is illuminated with a _ coupling field _ , resonant with @xmath28 transition and propagating in the @xmath15 direction ( see fig .  [",
    "fig : diagram](b ) ) .",
    "a pulse of _ probe field _",
    ", with temporal half - width @xmath18 , resonant with the @xmath29 transition , and also propagating in the @xmath15 direction , is then injected into the medium .",
    "the presence of the coupling field completely alters the optical properties of the atoms as seen by the probe . what would otherwise be an opaque medium ( typical optical densities of becs are @xmath30 )",
    "is rendered transparent via _ electromagnetically induced transparency _ ( eit ) @xcite , and the light pulse propagates at ultra - slow group velocities ( @xmath1  m / s)@xcite . as this occurs ,",
    "all but a tiny fraction of the probe energy is temporarily put into the coupling field , leading to a compression of the probe pulse to a length smaller than the atomic medium itself @xcite .    to describe the system theoretically",
    ", we represent the probe and coupling electric fields with their rabi - frequencies @xmath31 , where @xmath32 are slowly varying envelopes of the electric fields ( both of which can be time and space - dependent ) and @xmath33 are the electric dipole moments of the transitions .",
    "the bec is described with a two - component spinor wavefunction @xmath34 representing the mean field of the atomic field operator for states @xmath7 and @xmath8 .",
    "we ignore quantum fluctuations of these quantities , which is valid when the temperature is substantially below the bec transition temperature @xcite .",
    "the excited level @xmath14 can be adiabatically eliminated @xcite when the variations of the light fields envelopes are slow compared to the excited state lifetime @xmath21 ( which is 16  ns in sodium ) .",
    "the procedure is outlined in the appendix .",
    "the functions @xmath35 evolve via two coupled gross - pitaevskii ( gp ) equations @xcite .",
    "for the present paper , we will only consider dynamics in the @xmath36 dimension , giving the bec some cross - sectional area @xmath37 in the transverse dimensions over which all dynamical quantities are assumed to be homogeneous .",
    "this model is sufficient to demonstrate the essential effects here .",
    "we have considered effects due to the transverse dimensions , but a full exploration of these issue is beyond our present scope .",
    "the gp equations are @xcite :    @xmath38 \\psi_1   \\nonumber \\\\ & & - i \\hbar \\left ( \\frac{|\\omega_p|^2}{2 \\gamma } \\psi_1 + \\frac{\\omega_p^\\ast \\omega_c}{2 \\gamma } \\psi_2 \\right ) , \\nonumber \\\\",
    "i \\hbar \\frac{\\partial \\psi_2}{\\partial t } & = & \\bigg[-\\frac{\\hbar^2}{2m}\\frac{\\partial^2}{\\partial z^2 } + v_2(z ) + u_{22 }    & &   - i \\hbar \\left ( \\frac{|\\omega_c|^2}{2 \\gamma } \\psi_2 + \\frac{\\omega_p \\omega_c^\\ast}{2 \\gamma } \\psi_1 \\right),\\end{aligned}\\ ] ]    where @xmath39 is the mass of the atoms and we will consider a harmonic external trapping potential @xmath40 .",
    "the potential @xmath41 can in general differ from @xmath42 .",
    "for example , in a magnetic trap the states @xmath7 and @xmath8 can have different magnetic dipole moments .",
    "however , in the examples we consider the potentials are equal to a good approximation , and so @xmath43 is assumed in the calculations .",
    "atom - atom interactions are characterized by the @xmath44 , where @xmath45 is the total number of condensate atoms and @xmath46 are the s - wave scattering lengths for binary collisions between atoms in internal states @xmath47 and @xmath48 . the last pair of terms in each equation represent the coupling via the light fields and give rise to both coherent exchange between @xmath49 as well as absorption into @xmath14 . in our model , atoms which populate @xmath14 and then spontaneously emit are assumed to be lost from the condensate ( fig .  [ fig : diagram](a ) ) , which is why the light coupling terms are non - hermitian .",
    "the light fields propagation can be described by maxwell s equations .",
    "assuming slowly varying envelopes in time and space ( compared to optical frequencies and wavelengths , respectively ) and with the polarization densities written in terms of the bec wavefunctions these equations are @xcite :    @xmath50    where @xmath51 are the dimensionless oscillator strengths of the transitions and @xmath52 is the resonant cross section ( @xmath53 and @xmath54 for the @xmath55 lines of sodium and rb-87 , respectively ) .",
    "these equations ignore quantum fluctuations of the light fields , just as the gp equations ( [ eq : formalism12 ] ) ignore quantum fluctuations of the atomic fields .",
    "note that in the absence of any coherence @xmath56 these equations predict absorption of each field with the usual two - level atom resonant absorption coefficient ( the atom density times the single atom cross - section ) .    for much of our analysis",
    ", we will solve eqs .",
    "( [ eq : formalism12])-([eq : formalismpc ] ) self consistently with a numerical code , described in @xcite . in @xcite , this was successfully applied to predict and analyze the experimental observation of the nucleation of solitons and vortices via the _ light roadblock_. when the light fields are off , the two states do not exchange population amplitude and eqs .",
    "( [ eq : formalism12 ] ) reduce to coupled gross - pitaevskii equations for a two - component condensate . by contrast , when they are on and the probe pulse length @xmath18 ( and inverse rabi frequencies @xmath57 ) are much faster than the time scale for atomic dynamics ( typically @xmath58  ms ) , the internal couplings induced by the light field couplings will dominate the external dynamics .    for our our initial conditions ,",
    "we consider @xmath59 atoms are initially in @xmath7 in the condensed ground state .",
    "we determine the wavefunction of this state @xmath60 numerically by propagating ( [ eq : formalism12 ] ) in imaginary time @xcite , though the thomas - fermi approximation @xcite provides a good analytic approximation to @xmath60 . in the cases presented in this paper ,",
    "we choose the transverse area @xmath37 so that the central density and chemical potential @xmath61 , as in previous experiments @xcite . in fig .",
    "[ fig : switching ] we consider an example with @xmath62 sodium atoms ( with @xmath63  nm @xcite ) , @xmath64 and @xmath65 .",
    "the ground state density profile @xmath66 is indicated with the dotted curve in fig .",
    "[ fig : switching](b ) . in this case",
    "the chemical potential @xmath67khz .",
    "* coherent storage of a light pulse via fast switching . * results of numerical integration of eqs .",
    "( [ eq : formalism12])-([eq : formalismpc ] ) showing both a slow and stopped light experiment . *",
    "( a ) * the dashed curve shows the normalized _ input _ probe pulse intensity @xmath68 ( a @xmath69s @xmath70 half - width , @xmath71mhz pulse ) , while the dotted curve shows @xmath72 for a constant input coupling field @xmath73mhz .",
    "the thick solid curve shows the delayed output probe pulse ( at @xmath17 , see fig .",
    "[ fig : diagram](b ) ) .",
    "the time that the tail of the input has vanished and the rise of the output has not begun ( marked by the arrow ) corresponds to the time the pulse is completely compressed inside the bec . in the output coupling intensity ( thin solid curve ) we see adiabatons .",
    "the values @xmath74 and @xmath75 and @xmath76 have been used . *",
    "( b ) * the atomic density in the two states , @xmath77 ( solid curve ) and @xmath78 ( dashed curve ) , at @xmath79s ( indicated by the arrow in ( a ) ) .",
    "the dotted curve shows the original density @xmath80 before the probe is input .",
    "the arrow here and in ( c)-(d ) marks the position @xmath81 discussed later in the text . *",
    "( c ) * spatial profiles of the probe @xmath82 ( solid curves ) and coupling @xmath83 ( dashed curves ) field intensities at various times while the coupling field input is switched off .",
    "the switch - off is an error function profile with a width @xmath84s , centered at @xmath85s .",
    "successively thinner curves refer to @xmath86 , and @xmath87s .",
    "the dotted curve indicates the original condensate density ( arb .",
    "units ) . *",
    "( d ) * spatial profiles of the normalized dark @xmath88 ( dashed curves , scale on the left ) and absorbed @xmath89 ( solid curves , scale on right ) field intensities , at the same times as in ( c ) . *",
    "( e ) * the input and output probe and coupling intensities , with the same conventions as ( a ) , in a stopped light simulation . in this case",
    ", the coupling field is switched off at @xmath90 and then back on at @xmath91 . ]    with our initial ground state @xmath60 determined , consider that we initially ( @xmath92 ) input a constant coupling field with a rabi frequency @xmath93 and then inject a gaussian shaped probe pulse at @xmath16 ( see fig .",
    "[ fig : diagram](b ) ) with a temporal half - width @xmath18 and a peak rabi frequency @xmath94 .",
    "we define our times such that @xmath95 corresponds to the time the peak of the pulse is input .",
    "the dotted and dashed curves in fig .",
    "[ fig : switching](a ) show , respectively , a constant coupling input @xmath96mhz and a weaker input probe pulse with peak amplitude @xmath97mhz and width @xmath98s .    solving eqs .",
    "( [ eq : formalism12])-([eq : formalismpc ] ) reveals that , when the conditions necessary for eit hold , the pulse will compress upon entering the bec and propagate with a slow group velocity .",
    "as it does this , it transfers the atoms into superpositions of @xmath7 and @xmath8 such that @xcite :    @xmath99    which is a generalization to becs of the single atom _ dark state",
    "thus , the probe field @xmath6 imprints its ( time and space dependent ) phase and intensity pattern in the bec wavefunctions as it propagates .",
    "when ( [ eq : darkstate ] ) is exactly satisfied , it is easily seen that the two light field coupling terms in each of eqs .",
    "( [ eq : formalism12 ] ) cancel , meaning that @xmath7 and @xmath8 are completely decoupled from the excited state @xmath100 . however , time dependence of @xmath6 causes small deviations from ( [ eq : darkstate ] ) to occur , giving rise to some light - atom interaction which is , in fact , the origin of the slow light propagation .",
    "if one assumes the weak probe limit ( @xmath101 ) and disregards terms of order @xmath102 the group velocity of the probe pulse is @xcite :    @xmath103    and so is proportional the coupling intensity and inversely proportional to the atomic density @xmath104 , which is a reduction from it s free space value by a factor @xmath105 , while its peak amplitude does not change .",
    "thus only a tiny fraction of the input probe pulse energy is in the probe field while it is propagating in the bec .",
    "most of the remaining energy coherently flows into the coupling field and exits the bec , as can be seen in the small hump in the output coupling intensity ( thin solid curve in fig .",
    "[ fig : switching](a ) ) during the probe input .",
    "this has been dubbed an adiabaton @xcite .",
    "the magnitude of the adiabaton is determined by the intensity of the probe pulse .    in the weak probe limit",
    "@xmath106 never significantly deviates from the ground - state wavefunction @xmath107 and the coupling field is nearly unaffected by the propagation @xmath108 ( both of these results hold to @xmath109 ) . in this case ( [ eq : darkstate ] ) shows @xmath110 follows the probe field @xmath6 as the pulse propagates .",
    "the arrow in fig .",
    "[ fig : switching](a ) indicates a time where the probe has been completely input and has not yet begun to output . during this time , the probe is fully compressed in the bec and fig .",
    "[ fig : switching](b ) shows the atomic densities in @xmath9 and @xmath8 at this time .",
    "the spatial region with a non - zero density in @xmath8 corresponds to the region occupied by the probe pulse ( in accordance with ( [ eq : darkstate ] ) ) .",
    "equation  ( [ eq : darkstate ] ) applies to the phases as well as the amplitudes , however the phases in this example are homogenous and not plotted .",
    "once the pulse has propagated through the bec , it begins to exit the @xmath15 side .",
    "the energy coherently flows back from the coupling to probe field , and we see the output probe pulse ( thick solid curve ) .",
    "correspondingly , we see a dip in the coupling output at this time . in the experiments",
    "the delay between the input and output probe pulses seen in fig .",
    "[ fig : switching](a ) is measured with a pmt ( fig .",
    "[ fig : diagram](b ) ) .",
    "this delay and the length of the atomic cloud is used in to calculate the group velocity .",
    "the group velocity at the center of the bec in the case plotted is @xmath111 m/s .",
    "note that the output pulse plotted in fig .",
    "[ fig : switching](a ) at @xmath17 is slightly attenuated .",
    "this reduction in transmission is due to the eit bandwidth .",
    "the degree to which the adiabatic requirement @xmath112 is not satisfied , will determine the deviation the wavefunctions from the dark state ( [ eq : darkstate ] ) , which leads to absorption into @xmath14 and subsequent spontaneous emission .",
    "quantitatively , this reduces the probe transmission ( the time integrated output energy relative to the input energy ) to @xcite :    @xmath113    where @xmath114 is the optical density . in the fig .",
    "[ fig : switching ] example , @xmath115 .",
    "the peak intensity of the pulse is reduced by a factor @xmath116 while the temporal width is increased by @xmath117 ( this spreading can be seen in fig .",
    "[ fig : switching](a ) ) .",
    "the appearance of the large optical density @xmath118 in ( [ eq : tfreqwidth ] ) represents the cumulative effect of the pulse seeing a large number of atoms as it passes through the bec . to prevent severe attenuation and spreading , we see we must use @xmath119 , which is @xmath120s in our example .",
    "we now turn our attention to the question of stopping , storing and reviving probe pulses . we will show here that once the probe is contained in the bec , the coupling field can be switched off and on _ faster _ than the eit adiabatic time scale without causing absorptions or dissipation of the information @xcite .",
    "while we find no requirement on the time scale for the switching , we _ will _ obtain criteria on the length scales of @xmath35 which must be maintained to avoid absorption events . while previous work @xcite had addressed the fast switching case in the weak - probe limit , here we obtain results that are valid even when @xmath121 @xcite .",
    "as we will see , for shorter storage times where the external atomic dynamics play no role , these length scale requirements can be related to the adiabatic requirements on the input probe pulse width @xmath18 .",
    "the advantage of the current analysis is that it is easily applied to analyzing probe revivals after the atomic dynamics have completely altered the wavefunctions @xmath35 .",
    "in such a case it is these altered wavefunctions , rather than the input pulse width @xmath18 , which is relevant .      consider that we switch the coupling field input off at some time @xmath122 with a fast time scale @xmath123 .",
    "[ fig : switching](c ) plots the probe and coupling intensities as a function of @xmath36 at various times during a switch - off with @xmath124 .",
    "we see the probe intensity smoothly ramps down with the coupling field such that their ratio remains everywhere constant in time .",
    "remarkably , for reasons we discuss below , the wavefunctions @xmath35 are _ completely unaffected _ by this switching process .",
    "motivated by this , we will , in the following , assume that @xmath35 do not vary in time during this fast switching period , and later check this assumption .    to understand this behavior ,",
    "it is useful to go into a dark / absorbed basis for the light fields , similar to that used in @xcite , by defining @xcite :    @xmath125    where @xmath126 . from ( [ eq : dalight ] ) one sees that when the condensate is in the dark state ( [ eq : darkstate ] ) , @xmath127 .",
    "using the notation @xmath128 and transforming the propagation equations ( [ eq : formalismpc ] ) according to ( [ eq : dalight ] ) , one gets :    @xmath129    where @xmath130 ,   \\nonumber \\\\ \\alpha_l & \\equiv & \\frac{1}{\\psi_0 ^ 2}\\bigg(|\\psi_1|^2\\frac{d   \\phi_1}{dz}+|\\psi_2|^2\\frac{d \\phi_2}{dz}\\bigg),\\end{aligned}\\ ] ]    and we have ignored the vacuum propagation terms @xmath131 in eq .  ( [ eq : formalismpc ] ) .",
    "they are unimportant so long as the fastest time scale in the problem is slow compared to time it takes a photon travelling at @xmath132 to cross the condensate ( about @xmath133ps ) .",
    "note that @xmath134 represents the usual absorption coefficient weighted according to the atomic density in each of @xmath7 and @xmath8 .",
    "the terms @xmath135 arise from spatial variations in the wavefunctions , which make the transformation ( [ eq : dalight ] ) space - dependent .",
    "the term @xmath136 represents an additional effect present when the light - atom coupling coefficient differs on the two transitions ( @xmath137 and is discussed in detail in section  [ subsec : f23 ] .",
    "consider for the moment a case with @xmath138 ( implying @xmath139 ) and assume a region in which @xmath35 are homogenous ( so @xmath140 ) .",
    "equation  ( [ eq : aprop0 ] ) shows that the _ absorbed _ field @xmath141 attenuates with a length scale @xmath142 , the same as that for resonant light in a two - level atomic medium , and less than @xmath143 m at the cloud center for the parameters here .",
    "one would then get @xmath144 after propagating several of these lengths .",
    "conversely , ( [ eq : dprop0 ] ) shows the _ dark _ light field @xmath145 experiences no interaction with the bec and propagates without attenuation or delay",
    ".    however , spatial dependence in @xmath35 gives rise to @xmath146 in ( [ eq : dprop0])-([eq : aprop0 ] ) , introducing some coupling between @xmath145 and @xmath141 , with the degree of coupling governed by the spatial derivatives @xmath147 . a simple and relevant example to consider is the case of a weak ultra - slow probe pulse input and contained in a bec , as discussed above ( see fig .",
    "[ fig : switching](b ) ) .",
    "the wavefunction @xmath110 has a homogenous phase and an amplitude which follows the pulse shape according to ( [ eq : darkstate ] ) , meaning that @xmath148 scales as the inverse of the pulse s spatial length @xmath149 .",
    "it is important to note that this coupling is determined by spatial variations in the _ relative _ amplitude @xmath150 and does not get any contribution from variations in the _ total _ atomic density @xmath151 . to see this",
    "we note that if we can write the wavefunctions as @xmath152 , where @xmath153 are constants independent of @xmath36 , then @xmath148 and @xmath154 as defined in ( [ eq : alphadef ] ) vanish .",
    "when variations in the relative amplitude are present , examination of ( [ eq : aprop0 ] ) reveals that when the damping is much stronger than the coupling ( @xmath155 ) , one can ignore the spatial derivative term in analogy to an adiabatic elimination procedure .",
    "when we do this , ( [ eq : aprop0 ] ) can be approximated by :    @xmath156    strictly speaking , one can only apply this procedure in the region where @xmath141 has propagated more than one absorption length ( that is for @xmath157 where @xmath81 is defined by @xmath158 ) .",
    "however , @xmath81 is in practice only a short distance into the bec ( marked with arrows in figs .",
    "[ fig : switching](b)-(d ) ) . when the probe has already been input , as in fig.2(b ) ,",
    "@xmath110 and therefore @xmath141 ( see ( [ eq : dalight ] ) ) are already trivially zero for @xmath159 so ( [ eq : omegaa ] ) holds everywhere .",
    "we next plug eq .",
    "( [ eq : omegaa ] ) into eq .",
    "( [ eq : dprop0 ] ) , giving :    @xmath160 \\omega_d.\\ ] ]    these last two equations rely only on assumptions about the spatial derivatives of @xmath35 and _ not _ on the time scale of the switch - off @xmath161 ( though we have assumed @xmath162 in adiabatically eliminating @xmath14 from our original eqs .",
    "( [ eq : formalism12])-([eq : formalismpc ] ) ) .",
    "these results allow us to conclude two important things which hold whenever @xmath163 and the probe has been completely input .",
    "first , the coefficients governing the propagation of @xmath145 in ( [ eq : dprop ] ) are extremely small .",
    "the length scales @xmath164 are already generally comparable to the total bec size and the length scales for changes in @xmath145 , given by ( [ eq : dprop ] ) , scale as these terms multiplied by the large ratio @xmath165 .",
    "( the @xmath154 term in ( [ eq : dprop ] ) can lead to additional phase shifts , which we discuss in section  [ subsec : f23 ] ) .",
    "therefore the dark field @xmath145 propagates with very little attenuation .",
    "as we have noted ( and later justify and discuss in more detail ) the wavefunctions ( and therefore the propagation constant in brackets in ( [ eq : dprop ] ) ) are virtually unchanged during the switch - off . under this condition",
    ", changes initiated in @xmath145 at the entering edge @xmath16 quickly propagate across the entire bec . to apply this observation to the switch - off",
    ", we note when the pulse is contained so @xmath166 at the entering edge , ( [ eq : dalight ] ) shows @xmath167 there .",
    "switching off the coupling field at @xmath16 then amounts to switching off @xmath145 at @xmath16 and ( [ eq : dprop ] ) shows that this switch - off propagates through the entire bec with little attenuation or delay .",
    "second , from ( [ eq : omegaa ] ) we see that as @xmath145 is reduced to zero @xmath141 is reduced such that the ratio @xmath168 remains constant in time .    a numerical simulation corroborating this behavior is plotted in fig .  [ fig : switching](d ) .",
    "the dark field intensity @xmath169 is seen to switch - off everywhere as the coupling field input is reduced to zero over a @xmath170s timescale , confirming that the changes in the input propagate across the bec quickly and with little attenutation .",
    "the ratio @xmath171 is everywhere much smaller than unity and constant in time .",
    "the only exception to this is in a small region @xmath159 at the cloud entrance , where @xmath141 has not yet been fully damped .",
    "the plot of @xmath172 during the switch - off indeed demonstrates how ( [ eq : omegaa ] ) is a generally good approximation , but breaks down in this region . in the case",
    "plotted ( and any case where the probe is fully contained ) the wavefunction @xmath110 is so negligible in this region that @xmath141 is rather small and unimportant ( note the scale on the right hand side of the plot ) .",
    "translating this back into the @xmath173 basis , we note from ( [ eq : dalight ] ) that keeping @xmath174 means the probe must ( at all @xmath36 ) constantly adjust to the coupling field via :    @xmath175    thus we see that @xmath6 smoothly ramps down with @xmath5 even if @xmath5 is ramped down quickly , as seen in fig .",
    "[ fig : switching](c ) .    using our results for the light fields",
    ", we can now see why the wavefunctions @xmath35 do not change during the switching .",
    "physically , the probe is in fact adjusting to maintain the dark state ( [ eq : omegapadjust ] ) , and in doing so induces some transitions between @xmath7 and @xmath8 .",
    "however , only a fraction @xmath176 of the input energy is in the probe while it is contained in the medium , and so the probe is completely depleted before any significant change occurs in @xmath35 @xcite .",
    "in fact , the energy content of the probe field right before the switch - off is less than 1/100th of a free - space photon in the case here .",
    "thus , @xmath6 is completed depleted after only a fraction of one @xmath177 transition .",
    "note that ( [ eq : omegapadjust ] ) is equivalent to ( [ eq : darkstate ] ) .",
    "however , writing it in this way emphasizes that , during the switching , the probe is being driven by a reservoir consisting of the coupling field and atoms and adjusts to establish the dark state .",
    "this is contrast to the situation during the probe input , when many photons from both fields are being input at a specific amplitude ratio , forcing the _ atomic fields _ to adjust to establish the appropriate dark state . plugging in our results for the light fields ( [ eq : omegaa])-([eq : dprop ] ) into our eqs .",
    "( [ eq : formalism12 ] ) we can calculate the changes that occur in @xmath178 and @xmath110 during the switch - off .",
    "doing this , we find relative changes in @xmath35 are both smaller than @xmath179 , which can be made arbitrarily small for fast switching @xmath123 .",
    "the little change which does occur is due not to any process associated with the switching itself but is due to the small amount of propagation during the switch - off .",
    "it is therefore safe to assume ( as we saw numerically ) that @xmath35 are constant in time during the switch - off .",
    "one can also show with this analysis that the ratio of _ coherent _ exchange events ( from @xmath7 to @xmath8 or vice - versa ) to _ absorptive _ events ( transitions to @xmath180 followed by spontaneous emission ) is @xmath181 implying that the switch - off occurs primarily via coherent exchanges .    in the original stopped light experiment @xcite , the coupling field",
    "was then switched back on to @xmath93 , after some controllable storage time @xmath182 , at a time @xmath183 . in that experiment , revivals were observed for storage times @xmath182 too short for significant external atomic dynamics to occur , so the state of the atoms was virtually identical at @xmath184 and @xmath122",
    ". then the analysis of the switch - on is identical to the switch - off as it is just the same coherent process in reverse . the probe is then restored to the same intensity and phase profile as before the switch - off .",
    "an example of such a case is plotted in fig .",
    "[ fig : switching](e ) .",
    "the output revived pulse then looks exactly like the normal usl pulse ( compare the output in figs .  [",
    "fig : switching](a),(e ) ) , as was the case in the experiment .",
    "we have established the requirement @xmath185 is necessary and sufficient for coherent switching to occur . under what conditions is this satisfied ?",
    "when the switch - off occurs while the probe is compressed , it is _ always _ satisfied because of bandwidth considerations mentioned above ( see eq .",
    "( [ eq : tfreqwidth ] ) ) .",
    "specifically , the input pulse must satisfy @xmath186 .",
    "however , this leads to a pulse width in the medium of @xmath187 , implying that @xmath185 is satisfied ( as @xmath188 ) .",
    "therefore , any pulse which can successfully propagate to the cloud center , can be abruptly stopped and coherently depleted by a rapid switch - off of the coupling field .",
    "of course , if the switch - on is then done before significant atomic dynamics , the same reasoning applies then . in this case , our requirements on the spatial derivatives are already encapsulated by the adiabatic requirements on the probe pulse .",
    "it is when the external atomic dynamics during the storage significantly change @xmath35 , that the analysis of the switch - on becomes more complicated .",
    "this is the central purpose of the sections  [ sec : processing]-[sec : systematic ] below .    as hinted above , when the pulse is not yet completely input , the switching can cause absorptions and dissipation of the information . in this case",
    "@xmath110 is significant in the region @xmath159 and so @xmath141 is significant for several absorption lengths into the bec .",
    "physically , the coupling field sees atoms in a superposition of @xmath7 and @xmath8 immediately upon entering the condensate rather than only @xmath7 atoms .",
    "numerical simulations of this situation confirm this . during both the switch - on and switch - off ,",
    "a significant number of atoms are lost from both condensate components , primarily concentrated in the @xmath159 region , and the revived probe pulse is significantly attenuated relative to the pulse before the storage .",
    "incidentally , this explains the apparent asymmetry between the probe and coupling in a stopped light experiment .",
    "whenever _ both _ fields are being input , the temporal variations in both fields must be slow compared with the eit adiabatic time scale , as the atomic fields must adjust their amplitudes to prevent absorptions . however , when one of the fields is no longer being input ( like a contained probe pulse ) , the other field s input can be quickly varied in time .",
    "when the switching is done quickly compared to the natural lifetime of @xmath14 ( @xmath189 ) , the assumptions needed for adiabatic elimination of @xmath190 are no longer valid .",
    "the analysis of the switching then becomes more complicated but , remarkably , we find the quality of the storage is not reduced in this regime .",
    "to see this , we performed numerical simulations of switching in this regime by solving eqs .",
    "( [ eq : fullgp1])-([eq : maxwell ] ) ( which are the analogues of ( [ eq : formalism12])-([eq : formalismpc ] ) without the adiabatic elimination of @xmath190 ) for the same parameters as fig .",
    "[ fig : switching ] but varying @xmath161 from @xmath191 to @xmath192 @xcite .",
    "an example with @xmath193 is shown in fig .",
    "[ fig : fastswitching ] .",
    "we plot the probe and coupling amplitudes versus time at a point near the center of the bec , and zoom in on the regions near the switch - on and -off .",
    "note that that while the coupling field smoothly varies to it s new value in each case , the probe field slightly overshoots the value given by ( [ eq : omegapadjust ] ) before returning to it . in all cases with @xmath189 the probe amplitude",
    "@xmath194 experienced damped oscillations before reaching its final value .",
    "the frequency of the oscillations was determined by @xmath195 and the damping rate was @xmath11 .     * switching faster than the natural linewidth . *",
    "solid and dashed lines show , respectively , the normalized probe and coupling amplitudes at a point in the center of the bec @xmath196 when the switching is faster than the natural linewidth @xmath197 ( but otherwise the same parameters as fig .",
    "[ fig : switching](e ) ) .",
    "the two insets magnify the regions near the @xmath122 and @xmath184 . ]    during these oscillations , the absorbing field @xmath141 is in fact quite significant .",
    "however , the maximum value of @xmath198 and the total atomic loss due to spontaneous emissions events was _ completely independent _ of @xmath161 over the range we explored . to understand this",
    ", we note that even though @xmath141 is larger , the frequency components of the quickly varying coupling field are spread over a range much wider than @xmath11 .",
    "thus a very small fraction of the energy in the field @xmath5 is near resonant with the atomic transition and it passes through the bec unattenuated . analyzing the problem in fourier space one can see that the increase in @xmath141 for smaller @xmath161 is precisely offset by this frequency width effect , leading us to the conclusion that spontaneous emission loss is independent of @xmath161 .    unlike the case of switching",
    "slowly compared with @xmath21 , the adjustment of the probe is not a coherent process .",
    "rather , spontaneous emission damps the system until the dark state ( [ eq : omegapadjust ] ) is reached . however , because we are in the regime @xmath20 the amount of energy in the probe is much less than one photon , and thus still has virtually no impact on @xmath35 .",
    "this will not necessarily hold when @xmath199 and in @xcite it was predicted that there are , in fact , adiabatic requirements for @xmath161 in this regime . however , in all cases of interest here this inequality is well satisfied and there is no restriction on @xmath161 .",
    "we now turn to the question of the atomic dynamics during the storage time .",
    "these dynamics depend strongly on the relative scattering lengths of the states used , and the probe to coupling intensity ratio .",
    "we will see that the these dynamics are written onto revived probe pulses by switching the coupling field back on .",
    "the length scale requirement on variations in the relative amplitude @xmath150 derived above ( @xmath200 ) plays a central role in the fidelity with which these dynamics are written .",
    "we will demonstrate with several examples , relevant to current rb-87 experimental parameters .      in @xcite",
    "the revived pulses were seen to be attenuated for longer storage times with a time constant of @xmath201  ms .",
    "the relative phase between the @xmath7 and @xmath8 ( or coherence ) , averaged over all the atoms , washed out because the atoms , although at a cold temperature of @xmath202 , were above the bose - condensation temperature and so occupied a distribution of energy levels . by contrast , a zero temperature two - component bec will maintain a well defined phase ( the phase between @xmath178 and @xmath110 ) at all @xmath36 , even as @xmath35 evolve .",
    "they evolve according to the two - component coupled gp equations ( [ eq : formalism12 ] ) with the light fields set to zero ( @xmath203 ) , and the initial conditions are determined by the superposition created by the input pulse at @xmath122 ( see fig .",
    "[ fig : switching](b ) ) .",
    "after such an evolution , we can then switch the coupling field back on and the probe will be revived according to ( [ eq : omegapadjust ] ) but with the _ new _ wavefunctions @xmath35 , evaluated at @xmath184 .",
    "here we examine a wide variety of different two - component bec dynamics which can occur after a pulse has been stopped . because of the initial spatial structure of @xmath35 created with the usl pulses , we see some novel effects in the ensuing dynamics .    upon the switch - on , in many cases",
    "the probe will be revived via ( [ eq : omegapadjust ] ) .",
    "we label the spatial profile of the revived probe by @xmath204 .",
    "when we are in the weak probe limit ( @xmath205 or , stated in terms of the wavefunctions , @xmath206 ) , ( [ eq : omegapadjust ] ) becomes    @xmath207    allowing us to make a correspondence between the revived probe and @xmath110 if @xmath93 and @xmath208 are known .",
    "the revived pulse will then propagate out of the bec to the pmt at @xmath17 . in the absence of any attenuation or distortion during the propagation out",
    ", the spatial features of the revived probe get translated into temporal features .",
    "thus if we observe the output @xmath209 then we would deduce that revived pulse was    @xmath210    where @xmath211 is the time it takes the probe pulse to travel from some point @xmath36 to @xmath212 .",
    "note that we are relying here on the fact that we can switch the coupling field onto its full value of @xmath93 with a time scale fast compared to the pulse delay times @xmath213 .",
    "a slow ramp up would lead to a more complicated relationship between @xmath214 and @xmath215 .    combining ( [ eq : proberevive ] ) and ( [ eq : probeout ] ) shows how the phase and amplitude information that was contained in @xmath110 at the time of the switch - on is transferred to the output probe @xmath215 .",
    "this transfer will be imperfect for three reasons .",
    "first , when sufficiently small spatial features are in @xmath110 , then @xmath148 is comparable to @xmath134 , giving rise to a significant @xmath141 .",
    "the resulting absorptions will cause deviations of @xmath216 from our expectation ( [ eq : proberevive ] ) .",
    "second , we mentioned how spatial features are translated into temporal features on the output probe . during the output ,",
    "fast time features on the output probe will be attenuated via the bandwidth effect discussed in ( [ eq : tfreqwidth ] ) , affecting the accuracy of the correspondence ( [ eq : probeout ] ) . finally ,",
    "stronger output probes , which will occur when @xmath217 at the time of the switch - on , make both the writing at the switch - on and the subsequent propagation out more complicated and less reliable .",
    "our following examples will demonstrate these considerations .",
    "interesting dynamics occur in when the two internal states are trapped equally ( @xmath218 ) and the scattering lengths @xmath219 are slightly different .",
    "we consider a case with @xmath220 rb-87 atoms and choose @xmath221 , and @xmath222 .",
    "the two lower states @xmath7 and @xmath8 are magnetically trapped with nearly identical magnetic moments , and we consider a trap with @xmath223 and assume a tranvserse area @xmath224 .",
    "these two states have an anomalously small inelastic collisional loss rate @xcite and so have been successfully used to study interacting two - component condensates for hundreds of milliseconds @xcite .",
    "the elastic scattering lengths are @xmath225 @xcite .",
    "* formation of interference fringes in rb-87 and writing fringes to probe light field .",
    "* * ( a ) * the initial wavefunctions created by a @xmath226 probe pulse .",
    "the coupling field is initially on at @xmath227 then switched off at @xmath228 .",
    "the cloud parameters and atomic levels are described in the text .",
    "the thick solid curve shows the density @xmath229 ( multiplied by 10 for clarity ) while the thick dashed curve shows the phase @xmath230 .",
    "the thin curve shows the density @xmath231 . the phase @xmath232 is approximately homogenous and not shown . *",
    "( b ) * the effective potential @xmath233 ( [ eq : v2eff ] ) seen by the condensate in @xmath8 . * ( c ) * the resulting evolution of the density @xmath234 ( white represents higher density ) as the wave packet is pushed down the both sides of potential hill and interferes with itself upon reaching the hard wall in @xmath235 at the condensate edge .",
    "the vertical grey lines show the condensate boundary , and the horizontal grey lines indicate the times plotted in ( d ) .",
    "* ( d ) * plots of the density and phase of the wavefunctions at the indicated times ( with the same conventions as ( a ) ) at @xmath236 and @xmath237 . *",
    "( e ) * spatial profiles of the probe and coupling field directly after a fast switch - on after a storage time @xmath238 corresponding to the times in ( d ) .",
    "the thick ( thin ) solid curves show the intensities @xmath239 and the dashed curve shows the phase @xmath240 ( @xmath241 is nearly homogenous and not plotted ) . *",
    "( f ) * the time profile of the probe output intensity ( solid curve ) and phase ( dots ) at the output @xmath17 . ]",
    "figure  [ fig : fringeex](a ) shows the initial wavefunctions @xmath35 after the input and stopping of a probe pulse .",
    "we see a gaussian shaped density profile in @xmath8 reflecting the input probe s gaussian shape .",
    "the subsequent dynamics are governed by eqs .",
    "( [ eq : formalism12 ] ) with @xmath203 . in this case , a weak probe ( @xmath242 ) was input . as a result",
    ", @xmath243 is nearly constant in time and the evolution of @xmath110 is governed by essentially linear dynamics , with a potential determined by the magnetic trap _ and _ interactions with @xmath244 atoms :    @xmath245    figure  [ fig : fringeex](b ) shows this potential in this case .",
    "the hill in the middle has a height @xmath246 $ ] and arises because atoms feel a stronger repulsion from the condensate in @xmath7 when they are in @xmath27 .",
    "figures  [ fig : fringeex](c - d ) show the subsequent dynamics .",
    "one sees that the @xmath8 condensate is pushed down both sides of the potential hill and spreads .",
    "however , once it reaches the border of the bec , it sees sharp walls from the trap potential . even for the fairly moderate scattering length difference here",
    ", there is sufficient momentum acquired in the descent down the hill to cause a reflection and formation of interference fringes near the walls .",
    "the wavelength of the fringes is determined by this momentum .    what happens if one switches the coupling field back on after these dynamics ?",
    "figures  [ fig : fringeex](e ) shows the revived probe pulses @xmath214 upon switch - ons at the times corresponding to fig .",
    "[ fig : fringeex](d ) .",
    "one sees a remarkable transfer of the sharp density and phase features of the @xmath8 condensate onto the probe field , according to ( [ eq : proberevive ] ) . because we are in the weak probe regime , the coupling field intensity only very slightly deviates from it s input value @xmath93 .",
    "figures  [ fig : fringeex](f ) then shows the output probe @xmath215 .",
    "the sharp interference fringes are able to propagate out , though there is some attenuation and washing out of the features .",
    "note that the features at more positive @xmath36 propagate out first , leading to a mirror image - like relationship between the spatial fig .",
    "[ fig : fringeex](e ) and temporal fig .",
    "[ fig : fringeex](f ) patterns as predicted by ( [ eq : probeout ] ) .    in this particular example , we successfully output many small features from the @xmath110 to the output probe field .",
    "here the fringes are @xmath247 , which is still larger than the absorption length @xmath248 , but not substantially so , leading to some small amount of dissipation during the switch - on and output .",
    "this gives us a sense of the `` information capacity '' .",
    "the number of absorption lengths , or optical density , which in this case is @xmath249 , ultimately limits the number of features ( for a given desired fidelity ) which could be successfully written and output .",
    "note also that in the @xmath250 case , some of the @xmath110 amplitude occupies the entering region @xmath251 leading to additional imperfections in the writing process in this region .",
    "* breathing behavior and long storage * in this case the states chosen for @xmath7 and @xmath252 are reversed , changing the sign of the curvature in the effective potential ( [ eq : v2eff ] ) in ( a ) .",
    "all plots are the plotted with the same conventions as fig .  [",
    "fig : fringeex ] except we additionally plot thin dotted curves in ( c ) showing the phase @xmath253 and in ( d ) showing the phase @xmath254 . ]",
    "the dynamics in the previous example are quite dramatic , but are not particularly conducive to preserving or controllably processing the information in the bec . for this",
    ", it would be preferable to switch the roles of @xmath7 and @xmath8 .",
    "such a case is shown in fig .",
    "[ fig : breatheex2 ] . because @xmath255 in this case , the potential hill is turned into a trough ( see fig .",
    "[ fig : breatheex2](a ) ) .",
    "the effective potential in the region of the @xmath7 condensate , in the thomas - fermi limit , becomes @xmath256 $ ] and so it harmonic , with a much smaller oscillator frequency than the magnetic trap . the evolution can be easily calculated by decomposing the wavefunction @xmath110 into a basis of the harmonic oscillator states of this potential . in the example here , there is significant occupation of the first several oscillator levels , and so one sees an overall relative phase shift in time ( from the ground state energy of the zeroeth state ) , a slight dipole oscillation ( from occupation of the first excited state ) and breathing ( from the second ) .",
    "after one oscillator period ( 310  ms in the case shown ) , @xmath110 replicates its original value at the switch - off .    in this case , the dynamics are quite gentle , and so the spatial scales of the phase and density features are always quite large compared with the absorption length @xmath142 .",
    "the fidelity of the writing and output of the information on the probe field ( shown in figs .",
    "[ fig : breatheex2](d - e ) ) is correspondingly better than in the previous example .",
    "additionally , because the @xmath27 is trapped near the bec center , this case avoids problems associated with @xmath110 occupying the region @xmath159 .",
    "because of both the ease of analyzing the evolution and the high fidelity of outputting the information , we expect this case to be well - suited to controlled processing of optical information .",
    "for example ,",
    "if the input pulse created a wavefunction @xmath110 corresponding to the ground state of the oscillator potential , the evolution would result only in a homogenous phase shift , proportional to the storage time , allowing long storage of the information or introduction of controllable phase shifts . by choosing the pulse lengths differently so several oscillator states are occupied",
    ", one could achieve linear processing or pulse reshaping .    furthermore , note that in this example there is a small but discernable dip in the @xmath257 density at 51  ms , indicating some nonlinearity in the evolution of @xmath110 .",
    "one can tune this nonlinearity by varying the probe to coupling ratio , leading to nonlinear processing of the information .      * strong probe case : formation of vector solitons . * dynamics resulting from using a relatively strong probe input @xmath258 . in this case",
    "we have @xmath259 rb-87 atoms in a @xmath223 trap and use @xmath260 , and @xmath261 corresponding to the system @xmath262 , and @xmath263 .",
    "we artificially set @xmath264 to exaggerate the phase separation dynamics . * ( a ) * evolution of density in @xmath8 @xmath265 remains almost constant in time . *",
    "( c ) * the densities @xmath266 are plotted as dotted and dashed curves . ]",
    "the two - component dynamics are even richer when one uses strong probe pulses so nonlinear effects become very evident in the evolution . in such a case ,",
    "the qualitative features of the dynamics will be strongly effected by whether or not the relative scattering lengths are in a phase separating regime @xmath267 @xcite .",
    "experiments have confirmed that the @xmath268 studied in our previous examples in rb-87 are very slightly in the phase separating regime @xcite .",
    "relative scattering lengths can also be tuned via feshbach resonances @xcite .",
    "figure  [ fig : solitondynex ] shows the evolution of the two components following the input and stopping of a stronger probe ( @xmath269 ) . in this case",
    "we chose our levels to be @xmath270 , and @xmath263 , which would require an optical trap @xcite in order to trap the @xmath7 and @xmath8 equally .",
    "this level scheme is advantageous in the strong probe case since @xmath138 which , as we will discuss in more detail in section  [ subsec : f23 ] , improves the fidelity of the writing and output processes .",
    "we chose the scattering length @xmath264 , higher than the actual background scattering length , to exaggerate the phase separation dynamics .",
    "one sees in fig .",
    "[ fig : solitondynex](a),(c ) that over a 30  ms timescale , the phase separation causes the density in @xmath27 to become highly localized and dense .",
    "this occurs because the scattering length @xmath271 causes @xmath7 atoms to be repelled from the region occupied by the @xmath8 atoms , and in turn the @xmath8 atoms find it favorable to occupy the resulting `` well '' in the @xmath7 density .",
    "these two processes enhance each other until they are balanced by the cost of the kinetic energy associated with the increasingly large spatial derivatives and we see the formation of two - component ( vector ) solitons @xcite . in the case here ,",
    "two solitons form and propagate around the bec , even interacting with each other .",
    "the alternating grey and white regions along each strip in fig .",
    "[ fig : solitondynex](a ) indicate that the solitons are undergoing breathing motion on top of motion of their centers of mass .",
    "[ fig : solitondynex](b ) shows that the total density profile @xmath151 varies very little in time .",
    "it is the _ relative _ densities of the two components that accounts for nearly all the dynamics .",
    "we found solitons formed even in only slightly phase separating regimes ( @xmath272 ) .",
    "the number of solitons formed , the speed of their formation , and their width were highly dependent on this ratio as well as the number of atoms in @xmath8 .",
    "the ability of stopped light pulses to create very localized two - component structures seems to be a very effective method for inducing the formation of vector solitons , which has hitherto been unobserved in atomic becs .",
    "a full exploration of these dynamics is beyond our scope here .",
    "* writing solitons onto probe field . * * ( a ) * writing of vector solitons onto probe and coupling fields directly after a switch - on after a storage time of @xmath273 and * ( b ) * probe output .",
    "the plots use the same conventions as fig .",
    "[ fig : breatheex2](d - e ) . ]",
    "these non - trivial features can also be written onto probe pulses as shown in fig .",
    "[ fig : solitonoutput](a ) .",
    "note that the condition for coherent revivals @xmath274 does _ not _ depend on the weak probe limit .",
    "therefore , the writing process is still primarily a coherent process , and ( [ eq : omegapadjust ] ) is still well satisfied .",
    "however , we see in fig .  [",
    "fig : solitonoutput](a ) , the coupling field is strongly affected by the writing and is far from homogenous , meaning the weak probe result ( [ eq : proberevive ] ) can not be used .",
    "nonetheless , we see that the qualitative features of both the density and phase of @xmath110 have still been transferred onto @xmath6 .",
    "the writing in the strong probe regime will be studied in more detail in section  [ sec : systematic ] .    in fig .",
    "[ fig : solitonoutput](b ) we plot the resulting output probe pulse in this case . as in the weak probe case",
    "there is some degradation in the subsequent propagation due to attenuation of high frequency components .",
    "in addition , unlike the weak probe case , there are nonlinearities in the pulse propagation itself which causes some additional distortion .",
    "section  [ subsec : f23 ] also addresses this issue .",
    "even so , we again see a very clear signature of the two solitons in the both the intensity and phase of the output probe .    we have performed some preliminary simulations in traps with weaker transverse confinement and which calculate the evolution in the transverse degrees of freedom .",
    "they show that the solitons can break up into two - component vortex patterns via the snake instability @xcite .",
    "we chose our parameters to be in the phase separating regime here .",
    "just as in the weak probe case , other regimes will lead instead to much gentler dynamics .",
    "for example , it has been shown @xcite that when @xmath275 then there exist `` breathe - together '' solutions of the bec whereby complete overlap of the wavefunctions @xmath35 persists . in this case",
    "the nonlinear atomic interaction can lead to spin - squeezing @xcite .",
    "it would be extremely interesting to investigate a probe - revival experiment in such a case , to see to what extent the squeezed statistics are written into probe pulse , producing squeezed light @xcite .",
    "this would require taking both the light propagation and atomic dynamics in our formalism beyond the mean field .",
    "steps in this direction have been taken in @xcite , but these analyses are restricted to the weak probe case .",
    "the above examples demonstrate that a rich variety of two component bec dynamics can occur , depending on the relative interaction strengths and densities of the states involved .",
    "they also show that remarkably complicated spatial features in both the density and phase can be written into temporal features of a probe light pulse and output .",
    "the purpose of this section is to quantify the fidelity with which wavefunctions can be written onto the probe field .",
    "to do this we consider an example of a two - component bec with a gaussian shaped feature in @xmath110 , with parameters characterizing length scales and amplitudes of density and phase variations .",
    "note these gaussian pulse shapes are relevant to cases in which one might perform controlled processing , _",
    "e.g. _ fig .",
    "[ fig : breatheex2 ] . switching on a coupling field then generates and outputs a probe pulse with these density and phase features .",
    "we will calculate this output , varying the parameters over a wide range . in each case",
    ", we will compare the output to what one expect from an `` ideal '' output ( without dissipation or distortion ) , and calculate an error which characterizes how much they differ . using the analysis of the switching process in section  [ sec : switching ] and the usl propagation in section  [ sec : formalism ]",
    "we also obtain analytic estimates of this error .    in the weak probe case , we find a simple relationship between @xmath276 and the output @xmath215 .",
    "we find that to optimize the fidelity in this case one should choose the gaussian pulse length between two important length scales .",
    "the shorter length scale is determined by eit bandwidth considerations , which primarily contribute error during the output . on the other hand , for large pulses comparable to the total condensate size",
    ", the error during the writing process dominates due to @xmath110 partially occupying the condensate entering edge region ( @xmath159 ) .    in the strong probe case , we find that the relationship between @xmath276 and @xmath215 is more complicated , however , when @xmath138 , one can still make an accurate correspondence .",
    "we find the fidelity in this case depends only weakly on the probe strength .",
    "conversely , when @xmath277 , even a small nonlinearity causes additional phase shifts and distortions , making this correspondence much more difficult , leading to higher errors for stronger probes .",
    "for this reason , a system that uses , for example @xmath278 ( as in fig .",
    "[ fig : solitonoutput ] ) would be preferable when one is interested in applications where there are comparable densities in the two states .    by considering the switch - on and output processes , starting with an arbitrary initial two - component bec , we emphasize that this method of outputting the atomic field information onto light fields works regardless of how the bec state was generated",
    ". one could prepare a bec in a coherent superposition of @xmath7 and @xmath8 by any available method including , but not limited to , inputting a slow light pulse .",
    "assume we have a two component bec with wavefunctions @xmath35 ( and again define @xmath279 ) .",
    "for now we assume @xmath138 ( so @xmath280 , see eq .",
    "( [ eq : alphadef ] ) ) , as we treat the @xmath281 case in section  [ subsec : f23 ] . upon a rapid switch - on of a coupling field with amplitude @xmath93 , inverting ( [ eq : dalight ] ) shows the pattern written onto the probe field will be :    @xmath282    in the ideal limit , where the spatial variations of the wavefunction are sufficiently small , @xmath283 and the second term vanishes .",
    "furthermore , ( [ eq : dprop ] ) shows in this case that the dark field intensity is constant @xmath284 .",
    "so in the ideal limit we have for the amplitude :    @xmath285    in practice this will be a good approximation so long as the inequality @xmath286 is satisfied . the extent to",
    "which the second term in ( [ eq : probereviveex ] ) can not be neglected will determine the error between the ideal @xmath287 and actual @xmath288 output .",
    "note that in all the cases studied in section  [ sec : processing ] , @xmath289 was nearly constant in time , being always well approximated by the original ground state @xmath290 . thus @xmath291 can be considered a known function of @xmath36 .",
    "turning now to the phase , the simple relationship @xmath292 is always satisfied in the dark state ( see ( [ eq : omegapadjust ] ) ) .",
    "if @xmath241 was just a constant then the probe phase would simply reflect the relative phase of the two wavefunctions @xmath293 ( choosing our phase conventions so @xmath294 ) .",
    "this is indeed the case in the weak probe limit , as then the coupling field phase @xmath241 is unaffected by the atomic fields upon the switch - on .",
    "however , this is not necessarily so in the strong probe regime . to calculate the true phase shift ,",
    "we calculate phase of @xmath145 from ( [ eq : dprop ] ) . in the ideal limit @xmath295 ( choosing our phase conventions such that @xmath296 ) . defining @xmath297 and using the definition of @xmath154 ( [ eq : alphadef ] ) and ( [ eq : proberevivemag ] )",
    ", we find the relationship :    @xmath298    the equation is written in this way ( the atomic phase in terms of the probe phase and intensity ) because our purpose is to derive the phase pattern @xmath299 based on the observed probe field , rather than vice versa .",
    "the nonlinear correction @xmath300 is fact the phase imprinted on the coupling field @xmath241 during the switch - on .",
    "however , in an experiment , we do not have direct access to the revived probe @xmath301 .",
    "rather , we observe the temporal output @xmath302 . in practice , the intensity of this quantity can be measured with a pmt , while the phase pattern could be measured by beating it with a reference probe field which did not propagate though the bec . in the ideal limit",
    "( the absence of attenuation or distortion ) the relationship ( [ eq : probeout ] ) will link the observed output to the revived probe field @xmath303 .",
    "thus we define the `` ideal '' output via    @xmath304    in practice , additional absorption events and distortion can occur during the output .",
    "if variations of the relative amplitude @xmath150 have some characteristic scale @xmath305 then time features with a scale @xmath306 will be introduced into the probe @xmath307 .",
    "using our result for the bandwidth induced attenuation ( [ eq : tfreqwidth ] ) yields an estimate for transmission energy ( that is , the energy of the actual output pulse @xmath308 relative to an unattenuated output of @xmath216 ) :    @xmath309    for this simple estimate we evaluate @xmath134 and @xmath310 at the location of the center of the pulse @xmath311 , though one could also construct more sophisticated estimates by integrating over the spatial distribution of the pulse . just as in our discussion below eq .",
    "( [ eq : tfreqwidth ] ) , the temporal width is increased by a factor @xmath117 and the peak intensity reduced by @xmath116 during the propagation out .",
    "we now apply these findings to a gaussian pulse , with @xmath110 assumed to be of the form ,    @xmath312\\ ] ]    note @xmath110 has a density feature of amplitude @xmath313 and length @xmath314 and a phase feature of amplitude @xmath315 and length @xmath316 .",
    "for @xmath317 we choose the amplitude so the total density matches the ground state for the trap @xmath318 and in the phase we put in a shift with some amplitude @xmath319 and length @xmath320 .",
    "an example is shown in fig .",
    "[ fig : test1](a ) . these parameters will be varied throughout this section to learn how they effect the writing and output .",
    "we choose a @xmath321hz trap ( @xmath322 ) with @xmath323 rb-87 atoms .",
    "we use @xmath260 , corresponding to the system @xmath262 , and @xmath263 in rb-87 .    *",
    "writing and outputting atomic field information onto the probe fields . * * ( a ) * a test case with a density feature of length @xmath324 of amplitude @xmath325 and phase features of @xmath326 ( see eq .",
    "( [ eq : psi2test ] ) ) and @xmath327 .",
    "the conventions for the curves are the same as fig .",
    "[ fig : solitondynex](c ) . *",
    "( b ) * upon switch - on of the coupling field with @xmath328mhz , we show the dark intensity @xmath329 ( thick solid curve ) and coupling intensity @xmath330 ( thin solid ) .",
    "the dotted , dashed , and dot - dashed curves show , respectively , the phase profiles @xmath241 , @xmath331 and @xmath299 . * ( c ) * the normalized probe intensity profile @xmath332 ( solid curve ) is indistinguishable from the expected profile @xmath333 ( thick dashed ) ( see eq .",
    "( [ eq : proberevivemag ] ) ) .",
    "the thin solid curve shows @xmath240 and the dot - dashed curve shows @xmath334 , while the thin dashed curve shows the expected probe phase profile with the nonlinear correction @xmath335 ( [ eq : proberevivephase ] ) . for reference ,",
    "the dotted curve shows the total density @xmath151 profile .",
    "* ( d ) * the temporal pattern of the output probe intensity @xmath336 ( thick solid curve ) and phase @xmath337 ( thin solid ) , versus an estimate based on perfect propagation of the revived pulse @xmath303 according to ( [ eq : probeout ] ) ( dashed and dotted curves ) .",
    "the dot - dashed curve shows the ideal output attenuated by @xmath116 ( see ( [ eq : tspace ] ) and the discussion afterward ) using the estimate @xmath338 . ]    in the example of fig .",
    "[ fig : test1](a ) , @xmath325 is not particularly small , so the weak probe limit can not be assumed .",
    "figure  [ fig : test1](b ) shows the spatial profiles of the dark field @xmath145 and coupling field @xmath5 immediately following a fast switch - on ( @xmath124 ) .",
    "we see very little attenuation of @xmath145 occurs across the bec , as @xmath339 is quite small compared with @xmath340 . translating this back into the @xmath341 basis , ( [ eq : dalight ] ) predicts that @xmath5 acquires a dip in intensity with a height proportional to the density @xmath342 .",
    "this behavior is indeed seen in the figure .    the phase difference @xmath299 is plotted as the dot - dashed curve in figure  [ fig : test1](b ) .",
    "one sees that in the region where @xmath299 is inhomogeneous , a small phase shift , equal to @xmath300 ( [ eq : proberevivephase ] ) , is introduced in the coupling field ( dotted curve ) . again",
    "this shift only arises in the strong probe regime .",
    "the phase shift in the dark field @xmath331 is plotted as the dashed curve .",
    "figure  [ fig : test1](c ) then compares written probe field to our ideal limit predictions ( [ eq : proberevivemag])-([eq : proberevivephase ] ) in this example .",
    "the numerically calculated intensity @xmath343 ( solid curve ) is almost indistinguishable from our prediction @xmath344 ( [ eq : proberevivemag ] ) ( dashed curve ) .",
    "the phase written onto the probe field @xmath345 is also very close to the ideal limit prediction ( [ eq : proberevivephase ] ) .",
    "one sees that including the nonlinear correction @xmath346 to the simpler estimate @xmath334 ( dot - dashed curve ) is important in making the comparison good .",
    "figure  [ fig : test1](d ) then shows intensity ( thick solid curve ) and phase ( thin solid ) of the output pulse @xmath347 . for comparison the dashed and dotted curves show , respectively , the output expected from an unattenuated and undistorted transmission of the revived pulse @xmath348 via ( [ eq : probeoutideal ] ) .",
    "one sees a very good agreement in the phase pattern , while there is a visible reduction in the intensity , due to bandwidth considerations .",
    "the dot - dashed curve shows the our estimate with the estimated reduction in intensity @xmath116 ( see ( [ eq : tspace ] ) ) using a characteristic length scale @xmath305 calculated from a quadrature sum of contributions from the amplitude and phase features in ( [ eq : psi2test ] ) ( the expression is given in the caption ) .",
    "we have thus calculated a method by which the output probe pulse can be solely used to calculate the relative density and phase of the wavefunctions which generated it , and demonstrated the method with a generic example .",
    "furthermore , we have identified the leading order terms which will cause errors in these predictions . in particular",
    "we have seen in our example in fig .",
    "[ fig : test1](d ) that including the expected bandwidth attenuation accounts for most of the deviation between our ideal predictions and the actual output pulse .",
    "we now quantify the deviations from our predictions ( [ eq : proberevivemag]-[eq : probeoutideal ] ) for our example ( [ eq : psi2test ] ) , varying the length and amplitude parameters over a wide range .",
    "these results can be directly applied to pulses which are approximately gaussian ( as in fig .",
    "[ fig : breatheex2 ] ) .",
    "the results here should also provide a good guide to the expected fidelity in more complicated cases so long as the length scale and amplitude of features can be reasonably estimated .    to quantify the deviation from our ideal case prediction ( [ eq : proberevivemag])-([eq : proberevivephase ] )",
    "we define the write error :    latexmath:[\\[\\label{eq : ewrite } e_w \\equiv \\frac{\\int_{z_{\\mathrm{in}}}^{z_{\\mathrm{out } } } \\ , dz ' \\bigg|\\,\\omega_p^{(\\mathrm{rev } ) } -    e^{i(\\phi_{21}+\\phi_{p}^{\\mathrm{(nl)}}+\\pi)}\\bigg|^2 } { \\int_{z_{\\mathrm{in}}}^{z_{\\mathrm{out } } } \\ , dz '     we plot this quantity in a series of cases with different @xmath314 in fig .",
    "[ fig : serieslength](a ) ( circles ) in a case with amplitude @xmath325 and no phase profiles .",
    "this is compared with a calculated prediction for @xmath350 ( solid curve ) based on ( [ eq : probereviveex ] ) where we calculate @xmath141 with ( [ eq : omegaa ] ) and calculate the small attenuation of @xmath145 with ( [ eq : dprop ] ) .",
    "these errors grow as @xmath314 becomes comparable to @xmath351 , according to the discussion in section  [ subsec : daanalysis ] .",
    "we see the agreement between the analytic and numerical estimates is quite good for small to moderate @xmath314 , confirming that this is the leading source of error .",
    "however , when @xmath314 becomes comparable to the total bec size ( the thomas - fermi radius is @xmath352 here ) , we begin to see additional errors because @xmath110 becomes non - zero at the bec edge .",
    "thus , we see that for a given bec length and density , one must choose @xmath353 to minimize the write error @xmath350 .",
    "because this edge effect depends on the density structure near the bec edge , it is difficult to estimate analytically , but it is related to the fraction of the pulse in or near the region @xmath159 . for pulses near the bec center , this will depend on @xmath354 , whereas for pulses far off center , it will also depend on the location of the center of the pulse .",
    "we also plot a series of cases keeping @xmath355 and @xmath356 but varying the length scale @xmath316 of a phase profile of amplitude @xmath357 .",
    "one sees similar but slightly smaller errors @xmath350 in this case .    *",
    "writing and outputting atomic field information onto light fields . * * ( a ) * circles show the write error @xmath350 ( [ eq : ewrite ] ) versus the length @xmath314 for becs with no phase jumps ( @xmath358 ) and with @xmath325 ( see eq .",
    "( [ eq : psi2test ] ) ) .",
    "the solid curve shows an analytic result based on the analytic expressions ( [ eq : probereviveex ] ) , ( [ eq : omegaa ] ) and ( [ eq : dprop ] ) .",
    "the squares show a case holding @xmath359 and introducing a phase feature @xmath357 with varying length scale @xmath316 . *",
    "( b ) * the output error @xmath360 ( [ eq : eout ] ) for the same cases as ( a ) .",
    "the solid curves showing the prediction @xmath361 discussed in the text ( choosing @xmath362 ) for the case with no phase jumps ( circles ) .",
    "the insets show the output in the cases indicated with arrows , with the same plotting conventions as fig .",
    "[ fig : test1](d ) ( in the lower inset on the right @xmath363 is homogenous and not plotted ) , we again use @xmath321hz , @xmath322 , @xmath364 and @xmath260 , corresponding to the system @xmath262 , and @xmath263 in rb-87 . ]",
    "we define the error accumulated as @xmath303 propagates out using ( [ eq : probeout ] ) :    @xmath365(b ) we plot this quantity for the cases corresponding to fig .  [",
    "fig : serieslength](a ) . for comparison , for the series with no phase shift , we calculated an estimate based on the expected attenuation @xmath116 and spreading @xmath117 of a gaussian pulse , due bandwidth considerations ( see eq .",
    "( [ eq : tspace ] ) and subsequent discussion ) , choosing @xmath362 . in the limit of small",
    "@xmath366 this calculation yields @xmath367 .",
    "this is plotted as a solid curve and we see good agreement with the numerical data .",
    "the error @xmath368 is seen to dominate @xmath350 for small @xmath314 , due to the fact that the large optical density effects the former ( @xmath369 in the case plotted ) . thus our analytic estimate @xmath370 is a good estimate of the total error .",
    "but for larger @xmath314 the edge effect in @xmath350 becomes important . to minimize the total error @xmath371",
    "we should choose @xmath314 so the error @xmath372 is comparable to the edge effect error . in fig .",
    "[ fig : serieslength ] the optimal length is @xmath373 and the total error is @xmath374 .",
    "the scaling of @xmath375 with the condensate size @xmath376 is difficult to estimate . assuming it roughly increases as @xmath377 , then ( [ eq : tspace ] ) shows @xmath378 , giving us a guide as to the improvement in fidelity we can expect by increasing the total optical density of the condensate .",
    "the insets show the plots of the ideal output of @xmath301 ( solid curves ) versus actual outputs @xmath302 ( dotted curves ) in two of the cases . in one case , with no phase jumps and a small @xmath314 , we see an overall reduction in amplitude and slight spreading . in the other , with a larger @xmath314 but a phase shift with a small length scale @xmath316 , we see that the attenuation is localized in the middle of the pulse .",
    "this is because it is the components which contain the sharpest phase profile , near the middle , which are most severely attenuated . generally , in cases with complicated spatial features",
    ", one must be aware of this potential for local attenuation of the sharpest features .",
    "note , however , that in many cases of interest , such as the interference fringes ( fig .",
    "[ fig : fringeex ] ) and solitons ( fig .",
    "[ fig : solitondynex ] ) , large phase shifts occur primarily in regions of low density , meaning these features often survive during the output propagation .    * writing and outputting atomic field information onto light fields . * * ( a ) * the write error @xmath350 ( [ eq : ewrite ] ) versus @xmath379 for the case @xmath380 . * ( b ) * the output error @xmath360 ( [ eq : eout ] ) in the same cases . the solid line shows the estimate @xmath361 ( see eq .",
    "( [ eq : tspace ] ) ) using @xmath381 .",
    "the condensate parameters are the same as in fig .",
    "[ fig : serieslength ] . ]",
    "our analysis of switching process in section  [ sec : switching ] applies even with a large amplitude @xmath379 , as was seen in the @xmath325 case in fig .",
    "[ fig : test1 ] . in fig .",
    "[ fig : seriesamp](a ) we plot the results of a series of simulations with @xmath379 varying all the way up to @xmath382 and see only a very small impact on @xmath350 for @xmath383 .",
    "most of our results for the propagation of usl pulses , _",
    "e.g. _ ( [ eq : vg ] ) and ( [ eq : tfreqwidth ] ) , rely on the weak probe limit .",
    "surprisingly though fig .",
    "[ fig : seriesamp](b ) shows that the output error @xmath360 is independent of @xmath379 through @xmath384 .",
    "the lack of distortion in the strong probe cases discussed so far in this section is a result of us choosing a system with equal oscillator strengths @xmath138 .",
    "the importance of the relative size of the oscillator strengths can be understood by considering the adiabatons ( the changes in the output coupling intensity seen in fig .",
    "[ fig : switching](a , e ) ) .",
    "the adiabatons arise because of the coherent flow of photons between the two light fields and their amplitude is determined by the requirement that the sum of the number of photons in both fields is constant upon such an exchange . in a case",
    "where @xmath385 one must take into account that it is the total field strength @xmath386 , rather than simply the input coupling strength @xmath387 which enters the numerator in our equation for the group velocity @xmath388 ( [ eq : vg ] ) .",
    "however , the expressions for the rabi frequencies involve the oscillator strengths of the relevant transitions .",
    "thus , preserving the total number of _ photons _ at each point in space will result in a homogenous @xmath389 if and only if @xmath138 . during the time that the probe is completely contained in the bec",
    ", @xmath390 will differ from @xmath387 in the vicinity of the pulse according to :    @xmath391 , where we compare a delayed weak probe regular usl output pulse to cases with strong probes @xmath392 and vary @xmath393 ( @xmath75 in all cases ) .",
    "each time we chose the coupling intensity so that that the rabi frequency is @xmath227 .",
    "one sees that when @xmath138 there is no asymmetrical distortion , though we get a slight spreading and a shorter delay time",
    ". however , in the other two cases , there is asymmetry in the output pulses , consistent with the picture that the center of the pulse will travel slower or faster than the edges according to ( [ eq : adiabaton ] ) and ( [ eq : vg ] ) ( with @xmath387 replaced by @xmath390 in the numerator ) .",
    "the result is a breakdown of our estimate ( [ eq : probeoutideal ] ) .",
    "as this is a propagation effect , the absolute magnitude of this effect should roughly be linear with optical density and the relative distortion will go as the optical density divided by the pulse length .",
    "this is the primary reason it would be advantageous to use the levels we chose in our simulation in fig .",
    "[ fig : solitonoutput ] if there is a strong probe .    *",
    "usl with a strong probe . *",
    "the dotted curve shows a strong probe pulse amplitude with peak value @xmath394 input into a sodium cloud with an optical density @xmath395 .",
    "we use an oscillator strength @xmath75 but vary the coupling oscillator strength @xmath396 .",
    "the output @xmath397 is shown in the cases @xmath398 ( thick solid curve ) , @xmath399 ( dot - dashed curve ) , and @xmath76 ( dashed curve ) . for reference , the thin solid curve shows output for a weak input probe @xmath400 . ]",
    "we just outlined the reason that the equal oscillator strengths can be important in reducing distortion during propagation and thus @xmath360 .",
    "it turns out that the writing process is also more robust when @xmath138 .",
    "the reason is the presence of the additional term @xmath136 ( [ eq : alphadef ] ) .",
    "this term is quite small in the weak probe limit , but in the strong probe case leads to an additional phase shift , not accounted for in ( [ eq : proberevivephase ] ) , which depends in detail on the pulse amplitude and structure",
    ".    figs .",
    "[ fig : test2](a - d ) shows a case , similar to fig .  [",
    "fig : test1 ] , but with @xmath401 ( as in the cases in figs .",
    "[ fig : fringeex]-[fig : breatheex2 ] ) , and with a fairly small nonlinearity @xmath402 .",
    "one sees in fig .",
    "[ fig : test2](b ) that there is a dip in @xmath145 in the region of the probe due to the @xmath136 term . fig .",
    "[ fig : test2](c ) shows the written probe pulse .",
    "there is a small but discernable difference between the predicted @xmath403 ( [ eq : proberevivephase ] ) and actual @xmath404 phase .",
    "[ fig : test2](d ) then shows the asymmetric distortion which develops as the strong probe propagates out .",
    "one sees the phase jump is distorted in addition to the amplitude .",
    "[ fig : test2](e - f ) demonstrate how these effects lead to substantially higher errors @xmath350 and @xmath360 as @xmath379 becomes larger . from our estimate from the previous section",
    "we expect an output error of @xmath405 and we see in fig .",
    "[ fig : test2](f ) that the distortion effect leads to errors higher than this when @xmath406 .    * writing information with unequal oscillator strengths . * * ( a - d ) * plots are for the same parameters as fig .",
    "[ fig : test1 ] except with @xmath407 and @xmath402 . *",
    "( e - f ) * write @xmath350 and output @xmath360 errors versus @xmath379 for the parameters @xmath408 . ]",
    "we thus conclude that fidelity of both the writing and output is compromised in a system with unequal oscillator strengths .",
    "however , this only comes into effect in cases where the nonlinearity is important . in weak probe cases",
    "neither of these effects is important and the fidelity can still be estimated with the analysis of the @xmath138 case in sections  [ subsec : fidelity]-[subsec : error ] .",
    "in conclusion , we have established first several new results regarding the fast switching of the coupling field in light storage experiments .",
    "we found the switching could be done arbitrarily fast without inducing absorptions so long as the probe is completely contained in the atomic medium ( and @xmath20 which is usually the case in practice ) .",
    "we have also seen that when the switching is slow compared to the excited state lifetime ( @xmath409  ns ) , the probe smoothly follows the temporal switching of the coupling field , while in the other limit the probe amplitude undergoes oscillations which damp out with this time scale ( see fig .  [",
    "fig : fastswitching ] ) .",
    "next , we saw that these stopped pulses can induce novel and rich two - component becs dynamics during the storage time .",
    "both the relative scattering lengths of the states used and the probe to coupling intensity ratio have a strong effect on the qualitative features of the dynamics . in the weak probe case ,",
    "the @xmath27 condensate sees en either an effective repulsive hill ( when @xmath410 , see fig.[fig : fringeex](b ) ) or harmonic oscillator potential ( when @xmath255 , see fig.[fig : breatheex2](a ) ) .",
    "the characteristic timescale for the dynamics is given my the chemical potential of the bec ( in our cases @xmath411khz ) times the relative scattering length difference @xmath412 . in the latter case",
    ", the resulting evolution can be easily calculated by decomposing the pulse into the various harmonic oscillator eigenstates .",
    "thus it is possible to choose input pulses which preserve their density over time or undergo predictable reshaping such as dipole sloshing or breathing , allowing controlled storage and linear processing of optical information .",
    "inputting stronger probes will add nonlinearity to the evolution , making nonlinear processing possible .",
    "very strong probes and phase separating scattering lengths @xmath413 lead to the formation and motion of vector solitons , which have not been observed in becs to date .",
    "we then showed that switching the coupling field on after the dynamics writes the various density and phase features of the wavefunctions onto revived probe pulses .",
    "this was seen qualitatively for various examples ( figs .",
    "[ fig : fringeex]-[fig : solitonoutput ] ) . a precise relationship between the wavefunctions and output pulses",
    "was found ( [ eq : proberevivemag])-([eq : probeoutideal ] ) , meaning the output probe pulse can be used as a diagnostic of the relative density and phase in the bec wavefunctions .",
    "we have also identified sources of attenuation and distortion in the writing and output processes and quantitative errors were calculated for a wide range of length and amplitudes of gaussian pulses ( figs .",
    "[ fig : serieslength]-[fig : seriesamp ] ) . as we saw there",
    ", the error during the output dominates for shorter pulses and is @xmath361 ( see eq .",
    "( [ eq : tspace ] ) ) . for longer pulses effects due to the condensate edge",
    "introduce errors into the writing process .",
    "balancing these two considerations one can optimize the fidelity , which improves with optical density .    for the strong probe case , we found that for equal oscillator strengths ( @xmath414 ) , one could still relate the wavefunctions to the output pulses by taking into account an additional nonlinear phase shift ( [ eq : proberevivephase ] ) .",
    "the fidelity of transfer of information was virtually independent of the probe strength @xmath415 even when @xmath416 ( see fig .",
    "[ fig : seriesamp ] ) . for unequal oscillator strengths ( @xmath417 ) we found strong probes lead to additional features in the phase pattern during the writing process and in distortion during the propagation during the output , leading to much higher errors ( see fig .",
    "[ fig : test2 ] ) .    looking towards future work",
    ", we note that it is trivial to extend the analysis here to cases where there are two or more spatially distinct becs present .",
    "so long as they are optically connected , information contained in the form of excitations of one bec could be output with this method and then input to another nearby bec , leading to a network . in the near future",
    ", there is the exciting possibility of extending these results beyond the mean field to learn how using this method of writing onto light pulses could be used as a diagnostic of quantum evolution in becs .",
    "a particular example of interest would be to investigate the spin squeezing due to atom - atom interactions in a two - component system and the subsequent writing of the squeezed statistics onto the output probe pulses .",
    "furthermore , we expect that performing revival experiments after long times could be used as a sensitive probe of decoherence in bec dynamics , similar to the proposal in @xcite .",
    "lastly , there is the prospect of inputting two or more pulses in a bec and using controllable nonlinear processing from atom - atom interactions to design of multiple bit gates , such as conditional phase gates .",
    "we anticipate the results presented here can be applied to these problems as well as to applications in quantum information storage , which require the ability to transfer coherent information between light and atom fields .",
    "we arrived at eqs .",
    "( [ eq : formalism12])-([eq : formalismpc ] ) by first considering a system of equations with all three levels considered and then adiabatically eliminating the wavefunction for @xmath418 . for completeness",
    "we write the original equations here .",
    "@xmath419 \\psi_1 \\nonumber \\\\ & & \\hspace{1 cm } + \\frac{1}{2}\\hbar \\ , \\omega_p^ * \\psi_3 , \\\\ \\label{eq : fullgp2 }",
    "i \\hbar \\frac{\\partial \\psi_2}{\\partial t } & = & \\bigg[-\\frac{\\hbar^2}{2m}\\frac{\\partial^2}{\\partial z^2 } + v_2(z ) + u_{22 }    & & \\hspace{1 cm } + \\frac{1}{2}\\hbar \\ , \\omega_c^ * \\psi_3 , \\\\ \\label{eq : fullgp3 }",
    "i \\hbar \\frac { \\partial \\psi_3}{\\partial t }   & = &   \\frac{1}{2 } \\omega_p \\hbar \\ , \\psi_1   + \\frac{1}{2 }   \\omega_c \\hbar \\psi_2 - i \\frac{\\gamma}{2 } \\psi_3\\end{aligned}\\ ] ]        in adiabatically eliminating @xmath190 , we assume all quantities vary slowly compared to excited state lifetime @xmath21 ( @xmath422  ns in sodium ) .",
    "this allows us to set @xmath423 in ( [ eq : fullgp3 ] ) and arrive at :        this work was supported by the u.s .",
    "air force office of scientific research , the u.s .",
    "army research office osd multidisciplinary university research initiative program , the national science foundation , and the national aeronautics and space administration .",
    "the authors would like to thank janne ruostekoski for helpful discussions .",
    "phillips , a. fleischhauer , a. mair , r.l .",
    "walsworth , and m.d .",
    "lukin , phys .",
    "* 86 * , 783 ( 2001 ) ; a. mair , j. hager , d.f .",
    "phillips , r.l .",
    "walsworth , and m.d .",
    "lukin , phys .",
    "a * 65 * , 031802 ( 2002 )",
    ".        l.v .",
    "hau , `` bec and light speeds of 38 miles / hour '' , feb . 10 , 1999 , workshop on bose - einstein condensation and degenerate fermi gases , center for theoretical atomic , molecular , and optical physics , ( boulder , co ) , http://fermion.colorado.edu/@xmath58chg/talks/hau ; l.v",
    ". hau , `` bose - einstein condensation and light speeds of 38 miles per hour '' , harvard university physics dept .",
    "colloquium , feb .",
    "22 , 1999 , videocasette ( harvard university , cambridge , ma , 1999 ) .",
    "m. inguscio , s. stringari , and c. wieman , eds .",
    ", _ bose - einstein condensates in atomic gases , proceedings of the international school of physics enrico fermi , course cxl _ , ( international organisations services b.v . ,",
    "amsterdam , 1999 ) .",
    "myatt , e.a .",
    "burt , r.w .",
    "ghrist , e.a .",
    "cornell , and c.e .",
    "weiman , phys .",
    "lett . * 78 * , 586 ( 1997 ) ; j.p .",
    "burke , c.h .",
    "greene , j.l bohn , phys .",
    "lett . * 81 * , 3355 ( 1998 ) .",
    "a mathematica notebook is available at http://fermion.colorado.edu/@xmath58chg / collisions/.                the code uses a crank - nicolson technique for the external propagation of the atomic fields and a symmmetric second order propagation for the light field internal coupling terms .",
    "the light fields are propagated in space with a second - order runge - kutta algorithm .",
    "the time steps varied between @xmath425  ns during the light propogation to as high as @xmath426 during the storage time with the light fields off . a spatial grid with typical spacing @xmath427 was used .",
    "the intervals @xmath428 were varied to assure they did not effect the results .                in this code , described in @xcite , we keep track of the amplitudes @xmath429 and propagate them and @xmath173 according to the analogues of eqs .",
    "( [ eq : fullgp1])-([eq : maxwell ] ) .",
    "we do not include the atomic dynamics in this code , which are on a much slower time scale ."
  ],
  "abstract_text": [
    "<S> we theoretically explore coherent information transfer between ultra - slow light pulses and bose - einstein condensates ( becs ) and find that storing light pulses in becs allows the coherent condensate dynamics to process optical information . </S>",
    "<S> we consider becs of alkali atoms with a @xmath0 energy level configuration . in this configuration , </S>",
    "<S> one laser ( the coupling field ) can cause a pulse of a second pulsed laser ( the probe field ) to propagate with little attenuation ( electromagnetically induced transparency ) at a very slow group velocity ( @xmath1  m / s ) , and be spatially compressed to lengths smaller than the bec . </S>",
    "<S> these pulses can be fully stopped and later revived by switching the coupling field off and on . </S>",
    "<S> here we develop a formalism , applicable in both the weak and strong probe regimes , to analyze such experiments and establish several new results : ( 1 ) we show that the switching can be performed on time scales much faster than the adiabatic time scale for eit , even in the strong probe regime . </S>",
    "<S> we also study the behavior of the system changes when this time scale is faster than the excited state lifetime . </S>",
    "<S> ( 2 ) stopped light pulses write their phase and amplitude information onto spatially dependent atomic wavefunctions , resulting in coherent two - component bec dynamics during long storage times . </S>",
    "<S> we investigate examples relevant to rb-87 experimental parameters and see a variety of novel dynamics occur , including interference fringes , gentle breathing excitations , and two - component solitons , depending on the relative scattering lengths of the atomic states used and the probe to coupling intensity ratio . </S>",
    "<S> we find the dynamics when the levels @xmath2 and @xmath3 are used could be well suited to designing controlled processing of the information input on the probe . </S>",
    "<S> ( 3 ) switching the coupling field on after the dynamics writes the evolved bec wavefunctions density and phase features onto a revived probe pulse , which then propagates out . </S>",
    "<S> we establish equations linking the bec wavefunction to the resulting output probe pulses in both the strong and weak probe regimes . </S>",
    "<S> we then identify sources of deviations from these equations due to absorption and distortion of the pulses . </S>",
    "<S> these deviations result in imperfect fidelity of the information transfer from the atoms to the light fields and we calculate this fidelity for gaussian shaped features in the bec wavefunctions . in the weak probe case , we find the fidelity is affected both by absorption of very small length scale features and absorption of features occupying regions near the condensate edge . we discuss how to optimize the fidelity using these considerations . in the strong probe case , we find that when the oscillator strengths for the two transitions are equal the fidelity is _ not _ strongly sensitive to the probe strength , while when they are unequal the fidelity is worse for stronger probes . </S>",
    "<S> applications to distant communication between becs , squeezed light generation and quantum information are anticipated . </S>"
  ]
}