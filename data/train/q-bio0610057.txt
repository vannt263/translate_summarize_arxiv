{
  "article_text": [
    "in an important paper , m. e. j. newman studied a network - based susceptible - infectious - removed ( sir ) epidemic model in which infection is transmitted through a network of contacts between individuals @xcite .",
    "the contact network itself is a random undirected network with an arbitrary degree distribution of the form studied by newman , strogatz , and watts @xcite .",
    "given the degree distribution , these networks are maximally random , so they have no small loops and no degree correlations in the limit of a large population @xcite .     in the stochastic sir model considered by newman , the probability that an infected node @xmath0 makes infectious contact with a neighbor @xmath1 is given by @xmath2 , where @xmath3 is the rate of infectious contact from @xmath0 to @xmath1 and @xmath4 is the time that @xmath0 remains infectious .",
    "( we use _ infectious contact _ to mean a contact that results in infection if and only if the recipient is susceptible . )",
    "the infectious period @xmath4 is a random variable with the cumulative distribution function ( cdf ) @xmath5 , and the infectious contact rate @xmath3 is a random variable with the cdf @xmath6 .",
    "the infectious periods for all individuals are independent and identically distributed ( iid ) , and the infectious contact rates for all ordered pairs of individuals are iid .     under these assumptions ,",
    "newman claimed that the spread of disease on the contact network is exactly isomorphic to a bond percolation model on the contact network with bond occupation probability equal to the _ a priori _ probability of disease transmission between any two connected nodes in the contact network @xcite .",
    "this probability is called the _",
    "transmissibility _ and denoted by @xmath7:@xmath8 newman used this bond percolation model to derive the distribution of finite outbreak sizes , the critical transmissibility @xmath9 that defines the epidemic ( i.e. , percolation ) threshold , and the probability and relative final size of an epidemic ( i.e. , an outbreak that never goes extinct ) .     as a counterexample ,",
    "consider a contact network where each subject has exactly two contacts .",
    "assume that ( i ) @xmath10 with probability @xmath11 and @xmath12 with probability @xmath13 and ( ii ) @xmath14 with probability one for all @xmath15 .  under the sir model ,",
    "the probability that the infection of a randomly chosen node results in an outbreak of size one is @xmath16 , which is the sum of the probability @xmath13 that @xmath17 and the probability @xmath18 that @xmath19 and disease is not transmitted to either contact .  under the bond percolation model ,",
    "the probability of a cluster of size one is @xmath20 , corresponding to the probability that neither of the bonds incident to the node are occupied .  since @xmath21 the bond percolation model correctly predicts the probability of an outbreak of size one only if @xmath22 or @xmath23 .",
    "when the infectious period is not constant , it underestimates this probability .",
    "the supremum of the error is @xmath24 , which occurs when @xmath25 and @xmath26 .  in this limit",
    ", the sir model corresponds to a site percolation model rather than a bond percolation model .     when the distribution of infectious periods is nondegenerate , there is no bond occupation probability that will make the bond percolation model isomorphic to the sir model .  to see why ,",
    "suppose node @xmath0 has infectious period @xmath4 and degree @xmath27 in the contact network .  in the epidemic model , the conditional probability that @xmath0 transmits infection to a neighbor @xmath1 in the contact network given",
    "@xmath4 is @xmath28 since the contact rate pairs for all @xmath27 edges incident to @xmath0 are iid , the transmission events across these edges are ( conditionally ) independent bernoulli(@xmath29 ) random variables ; but the transmission probabilities are strictly increasing in @xmath4 , so the transmission events are ( marginally ) dependent unless @xmath30 with probability one for some fixed @xmath31 .",
    "in contrast , the bond percolation model  treats the infections generated by node @xmath0 as @xmath27 ( marginally ) independent bernoulli(@xmath7 ) random variables regardless of the distribution of @xmath4 .",
    "neither counterexample assumes anything about the global properties of the contact network , so newman s claim can not be justified as an approximation in the limit of a large network with no small loops .     in section 2",
    ", we define a semi - directed random network called the _ epidemic percolation network _ and show how it can be used to predict the outbreak size distribution , the epidemic threshold , and the probability and final size of an epidemic in the limit of a large population for any time - homogeneous sir model .  in section 3 ,",
    "we show that the network - based stochastic sir model from @xcite can be analyzed correctly using a semi - directed random network of the type studied by bogu and serrano @xcite .  in section 4 ,",
    "we show that it predicts the same epidemic threshold , mean outbreak size below the epidemic threshold , and relative final size of an epidemic as the bond percolation model .  in section 5",
    ", we show that the bond percolation model fails to predict the distribution of outbreak sizes and the probability of an epidemic when the distribution of infectious periods is nondegenerate .  in section 6 , we compare predictions made by epidemic percolation networks and bond percolation models to the results of simulations .  in an appendix",
    ", we define epidemic percolation networks for a very general time - homogeneous stochastic sir model and show that their out - components are isomorphic to the distribution of possible outcomes of the sir model for any given set of imported infections .",
    "consider a node @xmath0 with degree @xmath27 in the contact network and infectious period @xmath4 .  in the sir model defined above , the number of people who will transmit infection to @xmath0 if they become infectious has a binomial(@xmath32 ) distribution regardless of @xmath4 .",
    "if @xmath0 is infected along one of the @xmath27 edges , then the number of people to whom @xmath33 will transmit infection has a binomial(@xmath34 ) distribution .  in order to produce the correct joint distribution of the number of people who will transmit infection to @xmath0 and the number of people to whom @xmath0 will transmit infection",
    ", we represent the former by directed edges that terminate at @xmath0 and the latter by directed edges that originate at @xmath0 .",
    "since there can be at most one transmission of infection between any two persons , we replace pairs of directed edges between two nodes with a single undirected edge .",
    "starting from the contact network , a single realization of the _ epidemic percolation network _ can be generated as follows :    1 .",
    "choose a recovery period @xmath4 for every node @xmath0 in the network and choose a contact rate @xmath3 for every ordered pair of connected nodes @xmath0 and @xmath1 in the contact network .",
    "2 .   for each pair of connected nodes @xmath0 and @xmath1 in the contact network , convert the undirected edge between them to a directed edge from @xmath0 to @xmath1 with probability @xmath35 , to a directed edge from @xmath1 to @xmath0 with probability @xmath36 , and erase the edge completely with probability @xmath37 .",
    "the edge remains undirected with probability @xmath38 .",
    "the epidemic percolation network is a semi - directed random network that represents a single realization of the infectious contact process for each connected pair of nodes , so @xmath39 possible percolation networks exist for a contact network with @xmath40 edges .",
    "the probability of each possible network is determined by the underlying sir model .",
    "the epidemic percolation network is very similar to the locally dependent random graph defined by kuulasmaa @xcite for an epidemic on a @xmath41-dimensional lattice .",
    "there are two important differences : first , the underlying structure of the contact network is not assumed to be a lattice .",
    "second , we replace pairs of ( occupied ) directed edges between two nodes with a single undirected edge so that its component structure can be analyzed using a generating function formalism .     in the appendix",
    ", we prove that the size distribution of outbreaks starting from any node in a time - homogeneous stochastic sir model is identical to the distribution of its out - component sizes in the corresponding probability space of percolation networks .",
    "since this result applies to any time - homogeneous sir  model , it can be used to analyze network - based models , fully - mixed models ( see @xcite ) , and models with multiple levels of mixing .       in this section ,",
    "we briefly review the structure of directed and semi - directed networks as discussed in @xcite .  in the next section ,",
    "we relate this to the possible outcomes of an sir  model .",
    "the _ indegree _ and _ outdegree _ of node @xmath0 are the number of incoming and outgoing directed edges incident to @xmath0 .  since each directed edge is an outgoing edge for one node and an incoming edge for another node , the mean indegree and outdegree are equal .",
    "the _ undirected degree _ of node @xmath0 is the number of undirected edges incident to @xmath0 .",
    "the _ size _ of a component is the number of nodes it contains and its _ relative size _ is its size divided by the total size of the network .     the _ out - component _ of node @xmath0 includes @xmath0 and all nodes that can be reached from @xmath0 by following a series of edges in the proper direction ( undirected edges are bidirectional ) .",
    "the _ in - component _ of node @xmath0 includes @xmath0 and all nodes from which @xmath0 can be reached by following a series of edges in the proper direction .  by definition ,",
    "node @xmath0 is in the in - component of node @xmath1 if and only if @xmath1 is in the out - component of @xmath0 .  therefore , the mean in- and out - component sizes in any ( semi-)directed network are equal .",
    "the _ strongly - connected component _ of a node @xmath0 is the intersection of its in- and out - components ; it is the set of all nodes that can be reached from node @xmath0 and from which node @xmath0 can be reached .",
    "all nodes in a strongly - connected component have the same in - component and the same out - component .",
    "the _ weakly - connected component _ of node @xmath0 is the set of nodes that are connected to @xmath0 when the direction of the edges is ignored .     for giant components",
    ", we use the definitions given in @xcite .",
    "giant components have asymptotically positive relative size in the limit of a large population .  all other components are small \" in the sense that they have asymptotically zero relative size .",
    "there are two phase transitions in a semi - directed network : one where a unique giant weakly - connected component ( gwcc ) emerges and another where unique giant in- , out- , and strongly - connected components ( gin , gout , and gscc ) emerge .",
    "the gwcc contains the other three giant components .",
    "the gscc is the intersection of the gin and the gout , which are the common in- and out - components of nodes in the gscc .",
    "_ tendrils _ are components in the gwcc that are outside the gin and the gout .",
    "_ tubes _ are directed paths from the gin to the gout that do not intersect the gscc .",
    "all tendrils and tubes are small components .",
    "a schematic representation of these components is shown in figure ( [ bowtie ] ) .",
    "an _ outbreak _ begins when one or more nodes are infected from outside the population .",
    "these are called _ imported infections_.  the _ final size _ of an outbreak is the number of nodes that are infected before the end of transmission , and its _ relative final size _ is its final size divided by the total size of the network .  in the epidemic percolation network ,",
    "the nodes infected in the outbreak can be identified with the nodes in the out - components of the imported infections .",
    "this identification is made mathematically precise in the appendix .",
    "informally , we define a _ self - limited outbreak _ to be an outbreak whose relative final size approaches zero in the limit of a large population and an _ epidemic _ to be an outbreak whose relative final size is positive in the limit of a large population .  there is a critical transmissibility @xmath9 that defines the _ epidemic threshold : _ the probability of an epidemic is zero when @xmath42 , and the probability and final size of an epidemic are positive when @xmath43 @xcite .     if all out - components in the epidemic percolation network are small , then only self - limited outbreaks are possible .",
    "if the percolation network contains a gscc , then any infection in the gin will lead to the infection of the entire gout .",
    "therefore , the epidemic threshold corresponds to the emergence of the gscc in the percolation network .",
    "for any finite set of imported infections , the probability of an epidemic is equal to the probability that at least one imported infection occurs in the gin .",
    "the relative final size of an epidemic is equal to the proportion of the network contained in the gout .",
    "although some nodes outside the gout may be infected ( e.g. nodes in tendrils and tubes ) , they constitute a finite number of small components whose total relative size is asymptotically zero .",
    "it is possible to define epidemic percolation networks for a much larger class of stochastic sir epidemic models than the one from @xcite .",
    "first , we specify an sir model using probability distributions for recovery periods in individuals and times from infection to infectious contact in ordered pairs of individuals .",
    "second , we outline time - homogeneity assumptions under which the epidemic percolation network is well - defined .",
    "finally , we define infection networks and use them to show that the final outcome of the sir model depends only on the set of imported infections and the epidemic percolation network .",
    "suppose there is a closed population in which every susceptible person is assigned an index @xmath196 .",
    "a susceptible person is infected upon infectious contact , and infection leads to recovery with immunity or death .  each person @xmath0 is infected at his or her _ infection time _",
    "@xmath197 , with @xmath198 if @xmath0 is never infected .",
    "person @xmath0 is removed ( i.e. , recovers from infectiousness or dies ) at time @xmath199 , where the _ recovery period _",
    "@xmath200 is a random sample from a probability distribution @xmath201",
    ".  the recovery period @xmath200 may be the sum of a _ latent period _ , when @xmath0 is infected but not yet infectious , and an _ infectious period _ , when @xmath0 can transmit infection .",
    "we assume that all infected persons have a finite recovery period .",
    "let @xmath202 be the set of susceptible individuals at time @xmath203 .",
    "let @xmath204 be the order statistics of @xmath205 , and let @xmath206 be the index of the @xmath207 person infected .",
    "when person @xmath0 is infected , he or she makes infectious contact with person @xmath208 after an _ infectious contact interval _ @xmath209 .",
    "each @xmath209 is a random sample from a conditional probability density @xmath210 .",
    "let @xmath211 if person @xmath0 never makes infectious contact with person @xmath1 , so @xmath210 has a probability mass concentrated at infinity .",
    "person @xmath0 can not transmit disease before being infected or after recovering , so @xmath212 for all @xmath213 and all @xmath214 .",
    "the _ infectious contact time _",
    "@xmath215 is the time at which person @xmath0 makes infectious contact with person @xmath1 .  if person @xmath1 is susceptible at time @xmath216 , then @xmath0 infects @xmath1 and @xmath217 .  if @xmath218 , then @xmath219 because person @xmath1 avoids infection at @xmath216 only if he or she has already been infected .",
    "for each person @xmath0 , let his or her _ importation time _",
    "@xmath220 be the first time at which he or she experiences infectious contact from outside the population , with @xmath221 if this never occurs .",
    "let @xmath222 be the cumulative distribution function of the importation time vector @xmath223 .",
    "first , an importation time vector @xmath224 is chosen .",
    "the epidemic begins with the introduction of infection at time @xmath225 .",
    "person @xmath226 is assigned a recovery period @xmath227 .",
    "every person @xmath228 is assigned an infectious contact time @xmath229 .",
    "we assume that there are no tied infectious contact times less than infinity .",
    "the second infection occurs at @xmath230 , which is the time of the first infectious contact after person @xmath226 is infected .",
    "person @xmath231 is assigned a recovery period @xmath232 .",
    "after the second infection , each of the remaining susceptibles is assigned an infectious contact time @xmath233 .",
    "the third infection occurs at @xmath234 , and so on .",
    "after @xmath48 infections , the next infection occurs at @xmath235 .",
    "the epidemic stops after @xmath40 infections if and only if @xmath236 .       in principle , the above epidemic algorithm could allow the infectious period and outgoing infectious contact intervals for individual @xmath0 to depend on all information about the epidemic available up to time @xmath197 .  in order to generate an epidemic percolation network",
    ", we must ensure that the joint distributions of recovery periods and infectious contact intervals are defined _",
    "a priori_.  the following restrictions are sufficient :     1 .",
    "we assume that the distribution of the recovery period vector @xmath237 does not depend on the importation time vector @xmath224 , the contact interval matrix @xmath238 $ ] , or the history of the epidemic .",
    "we assume that the distribution of the infectious contact interval matrix @xmath239 does not depend on @xmath224 or the history of the epidemic .     with these time - homogeneity assumptions , the cumulative distributions functions @xmath240 of recovery periods and @xmath241 and @xmath239 , the epidemic percolation network is a semi - directed network in which there is a directed edge from @xmath0 to @xmath1 iff @xmath242 and @xmath243 , a directed edge from @xmath1 to @xmath0 iff @xmath211 and @xmath244 , and an undirected edge between @xmath0 and @xmath1 iff @xmath242 and @xmath245 .",
    "the entire time course of the epidemic is determined by @xmath246 , @xmath239 , and @xmath224 .",
    "however , its final size depends only on the set @xmath247 of possible imported infections and the epidemic percolation network corresponding to @xmath239 .  in order to prove this ,",
    "we first define the _ infection network , _ which records the chain of infection from a single realization of the epidemic model .",
    "let @xmath248 be the index of the person who infected person @xmath0 , with @xmath249 for imported infections and @xmath250 for uninfected nodes .",
    "if tied finite infectious contact times are possible , then choose @xmath248 from all @xmath1 such that @xmath251 .",
    "the infection network has the edge set @xmath252 .",
    "it is a purely directed subgraph of the epidemic percolation network corresponding to @xmath239 because @xmath253 for every edge @xmath254 .",
    "since each node has at most one incoming edge , all components of the infection network are trees or isolated nodes .",
    "every imported case is either the root node of a tree or an isolated node .  every person infected through transmission within the population is a nonroot node in a tree .",
    "uninfected persons are isolated nodes .    the infection network can be represented by a vector @xmath255 , as in ref .",
    "@xcite .  if @xmath256 , then @xmath257 .",
    "if @xmath258 , then @xmath1 is in a component of the infection network with a root node @xmath259 and its infection time is @xmath260 where the edges @xmath261 form a directed path from @xmath259 to @xmath1 .",
    "this path is unique because all nontrivial components of the infection network are trees .  if @xmath262 , then @xmath263 .",
    "the removal time of each node @xmath0 is @xmath199 .",
    "if there is more than one possible infection network , they must all be consistent with @xmath264 by definition of @xmath248 .",
    "therefore , the entire time course of the epidemic is determined by the importation time vector @xmath224 , the recovery period vector @xmath246 , and the infectious contact interval matrix @xmath239 .       in an epidemic with infectious contact interval matrix @xmath239 ,",
    "a node is infected if and only if it is in the out - component of a node @xmath0 with @xmath265 in the percolation network .",
    "( equivalently , a node is infected if and only if its in - component includes a node @xmath0 with @xmath265 . )  therefore , the final outcome of the sir model depends only on the set of imported infections and the epidemic percolation network corresponding to @xmath239 .",
    "suppose that person @xmath1 is in the out - component of a node @xmath0 with @xmath265 in the epidemic percolation network corresponding to @xmath239 .",
    "then there is a sequence @xmath261 such that @xmath266 , @xmath267 , and @xmath268 for @xmath269 , so @xmath270 and @xmath1 must be infected during the epidemic .",
    "now suppose that @xmath271 .",
    "then there exists an imported case @xmath0 and a sequence @xmath272 such that @xmath266 , @xmath267 , and @xmath273 since @xmath274 , it follows that @xmath268 for all @xmath48 .",
    "but then the epidemic percolation network corresponding to @xmath239 has an edge with the proper direction or an undirected edge between @xmath275 and @xmath276 for all @xmath48 , so @xmath1 is in the out - component of @xmath0 .     by the law of iterated expectation ( conditioning on @xmath277",
    ", this result implies that the distribution of outbreak sizes caused by the introduction of infection to node @xmath0 is identical to the distribution of his or her out - component sizes in the probability space of epidemic percolation networks .",
    "furthermore , the probability that person @xmath0 gets infected in an epidemic is equal to the probability that his or her in - component contains at least one imported infection .",
    "this isomorphism holds in any finite population .  in the limit of a large population , the probability that node @xmath0",
    "is infected in an epidemic is equal to the probability that he or she is in the gout and the probability that an epidemic results from the infection of node @xmath0 is equal to the probability that he or she is in the gin .",
    "this logic can be extended to predict the mean size of self - limited outbreaks and the probability and final size of an epidemic for outbreaks started by any given set of imported infections .",
    "to analyze the sir model from @xcite , we first calculate the probability generating function ( pgf ) of the degree distribution of the corresponding epidemic percolation network .",
    "then we use methods developed by bogu and serrano @xcite  and meyers _ et al .",
    "_ @xcite to calculate the in- and out - component size distributions and the relative sizes of the gin , gout , and gscc .      if @xmath44 is the probability that a node has degree @xmath45 in the contact network , then @xmath46 is the probability generating function ( pgf ) for the degree distribution of the contact network .",
    "if @xmath47 is the probability that a node in the epidemic percolation network has @xmath1 incoming edges , @xmath48 outgoing edges , and @xmath40 undirected edges , then @xmath49 is the pgf for the degree distribution of the percolation network .",
    "suppose nodes @xmath0 and @xmath1 are connected in the contact network with contact rates @xmath50 and infectious periods @xmath4 and @xmath51 .",
    "let @xmath52 be the conditional pgf for the number of incoming , outgoing , and undirected edges incident to @xmath0 that appear between @xmath0 and @xmath1 in the percolation network .",
    "then @xmath53 given @xmath4 , the conditional pgf for the number of incoming , outgoing , and undirected edges incident to @xmath0 that appear in the percolation network between @xmath0 and any neighbor of @xmath0 in the contact network is @xmath54 the pgf for the degree distribution of a node with infectious period @xmath55 is @xmath56 finally , the pgf for the degree distribution of the epidemic percolation network is @xmath57    if @xmath58 , @xmath59 , and @xmath60 are nonnegative integers , let @xmath61 be the derivative obtained after differentiating @xmath58 times with respect to @xmath62 , @xmath59 times with respect to @xmath63 , and @xmath60 times with respect to @xmath64 .",
    "then the mean indegree and outdegree of the percolation network are @xmath65 and the mean undirected degree is @xmath66       when the contact network underlying an sir epidemic model is an undirected random network with an arbitrary degree distribution , the pgf of its degree distribution can be used to calculate the distribution of small component sizes , the percolation threshold , and the relative sizes of the gin , gout , and gscc using methods developed by bogu and serrano @xcite  and meyers _ et al .",
    "_ @xcite .",
    "these methods generalize earlier methods for undirected and purely directed networks @xcite .  in this section ,",
    "we review these results and introduce notation that will be used in the rest of the paper .",
    "we discuss the case of networks with no two - point degree correlations , which is sufficient to analyze the sir model from @xcite .",
    "let @xmath67 be the pgf for the degree distribution of a node reached by going forward along a directed edge , excluding the edge used to reach the node .  since the probability of reaching any node by following a directed edge is proportional to its indegree , @xmath68 similarly , the pgf for the degree distribution of a node reached by going in reverse along a directed edge ( excluding the edge used to reach the node ) is @xmath69 and the pgf for the degree distribution of a node reached by going to the end of an undirected edge ( excluding the edge used to reach the node ) is @xmath70       let @xmath71 be the pgf for the size of the out - component at the end of a directed edge and @xmath72 be the pgf for the size of the out - component at the end \" of an undirected edge .",
    "then , in the limit of a large population ,    @xmath73    the pgf for the out - component size of a randomly chosen node is    @xmath74    the probability that a node has a finite out - component in the limit of a large population is @xmath75 , so the probability that a randomly chosen node is in the gin is @xmath76 .",
    "the coefficients on @xmath77 in @xmath71 and @xmath72 are @xmath78 and @xmath79 respectively .",
    "therefore , power series for @xmath71 and @xmath72 can be computed to any desired order by iterating equations ( [ hf , out ] ) and ( [ hu , out ] ) .  a power series for @xmath80",
    "can then be obtained using equation ( [ hout ] ) .",
    "for any @xmath81 $ ] , @xmath71 and @xmath72 can be calculated with arbitrary precision by iterating equations ( [ hf , out ] ) and ( [ hu , out ] ) starting from initial values @xmath82 .",
    "estimates of @xmath71 and @xmath72 can be used to estimate @xmath80 with arbitrary precision .",
    "the expected size of the out - component of a randomly chosen node below the epidemic threshold is @xmath83 .",
    "taking derivatives in ( [ hout ] ) yields @xmath84 taking derivatives in equations ( [ hf , out ] ) and ( [ hu , out ] ) and using the fact that @xmath85 below the epidemic threshold yields a set of linear equations for @xmath86 and @xmath87 .",
    "these can be solved to yield @xmath88 and @xmath89 where the argument of all derivatives is @xmath90 .",
    "the in - component size distribution of a semi - directed network can be derived using the same logic used to find the out - component size distribution , except that we consider going backwards along directed edges .",
    "let @xmath91 be the pgf for the size of the in - component at the beginning of a directed edge , @xmath92 be the pgf for the size of the in - component at the beginning \" of an undirected edge , and @xmath93 be the pgf for the in - component size of a randomly chosen node .",
    "then , in the limit of a large population ,    [ hur , in]@xmath94 the probability that a node has a finite in - component is @xmath95 , so the probability that a randomly chosen node is in the gout is @xmath96 .",
    "the expected size of the in - component of a randomly chosen node is @xmath97 .",
    "power series and numerical estimates for @xmath91 , @xmath98 , and @xmath93 can be obtained by iterating these equations .",
    "the expected size of the out - component of a randomly chosen node below the epidemic threshold is @xmath83 .",
    "taking derivatives in equation ( [ hin ] ) yields    @xmath99    taking derivatives in equations ( [ hr , in ] ) and ( [ hu , in ] ) and using the fact that @xmath100 in a subcritical network yields @xmath101 and @xmath102 where the argument of all derivatives is @xmath90 .       the epidemic threshold occurs when the expected size of the in- and out - components in the network becomes infinite .",
    "this occurs when the denominators in equations ( [ hfout(1 ) ] ) and ( [ huout(1 ) ] ) and equations ( [ hrin(1 ) ] ) and ( [ huin(1 ) ] ) approach zero .  from the definitions of @xmath67 , @xmath103 and @xmath104 , both conditions are equivalent to @xmath105 therefore",
    ", there is a single epidemic threshold where the gscc , the gin , and the gout appear simultaneously in both purely directed networks @xcite and semi - directed networks @xcite .",
    "a node is in the gscc if its in- and out - components are both infinite .",
    "a randomly chosen node has a finite in - component with probability @xmath106 and a finite out - component with probability @xmath107 .",
    "the probability that a node reached by following an undirected edge has finite in- and out - components is the solution to the equation @xmath108 and the probability that a randomly chosen node has finite in- and out - components is @xmath109 @xcite .",
    "thus , the relative size of the gscc is @xmath110",
    "in this section , we prove that the in - component size distribution of the epidemic percolation network for the sir model from @xcite is identical to the component size distribution of the bond percolation model with bond occupation probability @xmath7 .",
    "the probability generating function for the total number of incoming and undirected edges incident to any node @xmath0 is @xmath111 which is independent of @xmath4 .",
    "if node @xmath0 has degree @xmath27 in the contact network , then the number of nodes we can reach by going in reverse along a directed edge or an undirected edge has a binomial@xmath112 distribution regardless of @xmath4 .",
    "if we reach node @xmath0 by going backwards along edges , the number of nodes we can reach from @xmath0 by continuing to go backwards ( excluding the node from which we arrived ) has a binomial@xmath113 distribution .  therefore , the in - component of any node in the percolation network is exactly like a component of a bond percolation model with occupation probability @xmath7 .",
    "this argument was used to justify the mapping from an epidemic model to a bond percolation model in @xcite , but it does not apply to the out - components of the epidemic percolation network .",
    "methods of calculating the component size distribution of an undirected random network with an arbitrary degree distribution using the pgf of its degree distribution were developed by newman _",
    "et al_. @xcite .",
    "these methods were used to analyze the bond percolation model of disease transmission @xcite , obtaining results similar to those obtained by andersson @xcite for the epidemic threshold and the final size of an epidemic .  in this paragraph , we review these results and introduce notation that will be used in this section .  let @xmath114 be the pgf for the degree distribution of the contact network .",
    "then the pgf for the degree of a node reached by following an edge ( excluding the edge used to reach that node ) is @xmath115 , where @xmath116 is the mean degree of the contact network .  with bond occupation probability @xmath7",
    ", the number of occupied edges adjacent to a randomly chosen node has the pgf @xmath117 and the number of occupied edges from which infection can leave a node that has been infected along an edge has the pgf @xmath118 .",
    "the pgf for the size of the component at the end of an edge is @xmath119 and the pgf for the size of the component of a randomly chosen node is @xmath120 the proportion of the network contained in the giant component is @xmath121 , and the mean size of components below the percolation threshold is @xmath122 .",
    "@xmath123 and @xmath124 can be expanded as power series to any desired degree by iterating equations ( [ h1 ] ) and ( [ h0 ] ) ,  and their value for any fixed @xmath81 $ ] can be found by iteration from an initial value @xmath125 .",
    "we can now prove that the distribution of component sizes in the bond percolation model is identical to the distribution of in - component sizes in the epidemic percolation network .",
    "@xmath126 for all @xmath127    from equation ( [ gr * ] ) , @xmath128 from equation ( [ gu*]),@xmath129 thus , the degree distribution of a node reached by going backwards along an edge is independent of whether it was a directed or undirected edge .",
    "@xmath130 for all @xmath131 .     from equations ( [ hr , in ] ) and ( [ hu , in ] ) , @xmath132",
    "let @xmath133 .  since @xmath134 for all @xmath4 , @xmath135 from equation ( [ h1 ] ) , we have @xmath136 since there is a unique pgf that solves this equation , @xmath137 .",
    "thus , the in - component size distribution at the beginning of an edge is the same for directed and undirected edges , and it is identical to the distribution of component sizes at the end of an occupied edge in the bond percolation model .     @xmath138 .",
    "let @xmath139 .  from equation ( [ hin ] ) ,",
    "the probability generating function for the distribution of in - component sizes in the percolation network is @xmath140 when @xmath124 is substituted for @xmath141 ( which is justified by the previous lemma ) , this is identical to equation ( [ h0 ] ) for @xmath123 in the bond percolation model .",
    "since there is a unique pgf solution to this equation , @xmath142 @xmath123 , so the distribution of in - components in the percolation network is identical to the distribution of component sizes in the bond percolation model .",
    "since the mean size of out - components is equal to the mean size of in - components in any semi - directed network , the bond percolation model correctly predicts the mean size of outbreaks below the epidemic threshold .",
    "since the mean sizes of in- and out - components diverge simultaneously , the bond percolation model also correctly predicts the critical transmissibility @xmath9 .",
    "since the probability of having a finite in - component in the percolation model is equal to the probability of being in a finite component of the bond percolation model , the bond percolation model also correctly predicts the final size of an epidemic .",
    "in this section , we prove that the distribution of out - component sizes in the epidemic percolation network for the sir model from @xcite is always _ different _ than the distribution of in - component sizes when there is a nondegenerate distribution of infectious periods .  as a corollary",
    ", we find that the probability of an epidemic in the sir model from the introduction is always less than or equal to its final size , with equality only when epidemics have probability zero or the infectious period is constant .",
    "this is similar to a result obtained by kuulasmaa and zachary @xcite , who found that an sir model defined on the @xmath41-dimensional integer lattice reduced to a bond percolation process if and only if the infectious period is constant .",
    "the probability generating function for the total number of outgoing and undirected edges incident to a node @xmath0 with infectious period @xmath4 is @xmath143 where @xmath29 is the conditional probability of transmission across each edge given @xmath4 , as defined in equation ( [ ti ] ) .",
    "the number of nodes we can reach by going forwards along edges starting from @xmath0 has a binomial(@xmath144 ) distribution .",
    "if we reach a node @xmath1 by following an edge , then the number of nodes we can reach from @xmath1 by continuing to go forwards ( excluding the node from which we arrived ) has a binomial(@xmath145 ) distribution .  unless @xmath4 is constant , the out - components of the epidemic percolation network are not like the components of a bond percolation model .",
    "suppose @xmath0 and @xmath1 are connected in the contact network .",
    "the conditional transmission probability from @xmath1 to @xmath0 given @xmath4 is always @xmath7 .",
    "thus , an edge across which we leave any node is directed ( i.e. , outgoing ) with probability @xmath146 and undirected with probability @xmath7 .",
    "this allows us to calculate the pgfs of the out - component distributions without differentiating between outgoing and undirected edges :  let @xmath147 be the probability generating function for the degree distribution of a node that we reach by going forward along an outgoing or undirected edge ( excluding the edge along which we arrived ) .",
    "let @xmath148 be the probability generating function for the size of the out - component at the end of an outgoing or undirected edge .     for the sir model from @xcite , @xmath149",
    "and we have the following self - similarity equation : @xmath150    from equation ( [ gxyu|tau ] ) , we have @xmath151\\\\ & = g(1,y , u|\\tau_{i})\\end{aligned}\\ ] ] for all @xmath63 , @xmath64 , and @xmath4 .",
    "this allows us to rewrite equation ( [ hf , out ] ) : @xmath152 similarly , we can rewrite equation ( [ hu , out ] ) : @xmath153 finally , we can rewrite equation ( [ hout]):@xmath154 but then @xmath155\\\\ & = zg_{o}(1,h_{\\ast}^{out}(z),h_{\\ast}^{out}(z)).\\end{aligned}\\ ] ] as a corollary , we find that the analysis in ref .",
    "@xcite can be corrected if we let @xmath156 and @xmath157 ( see equations ( 13 ) and ( 14 ) in @xcite ) .",
    "@xmath158 for all @xmath81 $ ] .     since @xmath159 is convex , @xmath160 by jensen s inequality .",
    "equality holds only if @xmath161 , @xmath162 , @xmath159 is constant , or @xmath4 is constant .  since @xmath141 is the solution to @xmath163 we must have @xmath164 .",
    "this can be seen by fixing @xmath131 and considering the graphs of @xmath165 and @xmath166 .",
    "@xmath167 is the value of @xmath62 at which @xmath165 intersects the line @xmath168 .",
    "@xmath141 is the value of @xmath62 at which @xmath166 intersects the line @xmath168 .  since @xmath169 , we must have @xmath170 .",
    "@xmath171 for all @xmath81 $ ] .",
    "equality holds only when @xmath161 , @xmath172 and the percolation network is subcritical , or the infectious period is constant .    from equation ( [ hin ] ) , @xmath173 from equation ( [ hout ] ) ,",
    "@xmath174 the first inequality follows from the convexity of @xmath175 and jensen s inequality .",
    "the second follows from the fact that @xmath175 is nondecreasing and @xmath164 .",
    "equality holds in both inequalities only if @xmath161 , @xmath175 is constant , @xmath176 , or @xmath4 is constant .",
    "since the probability of an epidemic is @xmath76 and the final size of an epidemic is @xmath96 , it follows that the probability of an epidemic is always less than or equal to its final size in the sir model from @xcite .",
    "when the infectious period is constant , @xmath177 for all @xmath81 $ ] , so the in- and out - component size distributions are identical and the probability and final size of an epidemic are equal .",
    "when the infectious period has a nondegenerate distribution and the percolation network is subcritical , @xmath178 for all @xmath179 ( so the in- and out - components have dissimilar size distributions ) but @xmath180 ( so the probability and final size of an epidemic are both zero ) .",
    "if the network is supercritical and the infectious period is nonconstant , @xmath178 for all @xmath81 $ ] , so in- and out - components have dissimilar size distributions and the probability of an epidemic is strictly less than its final size .",
    "since the bond percolation model predicts the distribution of in - component sizes , it can not predict the distribution of out - component sizes or the probability of an epidemic for any sir model with a nonconstant infectious period .",
    "however , it does establish an upper limit for the probability of an epidemic in an sir model .",
    "we have recently become aware of independent work @xcite that shows similar results for more general sources of variation in infectiousness and susceptibility in a model where these are independent and uses jensen s inequality to establish a lower bound for the probability and final size of an epidemic .",
    "the lower bound corresponds to a site percolation model with site occupation probability @xmath7 , which is the model that minimized the probability of no transmission in the introduction .",
    "in a series of simulations , the bond percolation model correctly predicted the mean outbreak size ( below the epidemic threshold ) , the epidemic threshold , and the final size of an epidemic @xcite .  in section 4 , we showed that the epidemic percolation network generates the same predictions for these quantities .    in newman s simulations , the contact network had a power - law degree distribution with an exponential cutoff around degree @xmath181 , so the probability that a node has degree @xmath48 is proportional to @xmath182 for all @xmath183 .",
    "this distribution was chosen to reflect degree distributions observed in real - world networks @xcite .",
    "the probability generating function for this degree distribution is @xmath184 where @xmath185 is the @xmath186-polylogarithm of @xmath131 .",
    "in @xcite , newman used @xmath187 .    in our simulations , we retained the same contact network but used a contact model adapted from the counterexample in the introduction .",
    "we fixed @xmath188 for all @xmath15 and let @xmath189 with probability @xmath190 and @xmath191 with probability @xmath190 for all @xmath0 .",
    "the predicted probability of an outbreak of size one is @xmath192 in the epidemic percolation network and @xmath193 in the bond percolation model .",
    "the predicted probability of an epidemic is @xmath76 in the epidemic percolation network and @xmath96 in the bond percolation model .  in all simulations ,",
    "an epidemic was declared when at least @xmath194 persons were infected ( this low cutoff produces a slight overestimate of the probability of an epidemic in the simulations , favoring the bond percolation model ) .",
    "figures [ k10p1 ] and [ k20p1 ] show that percolation networks accurately predicted the probability of an outbreak of size one for all @xmath195 combinations , whereas the bond percolation model consistently underestimated these probabilities .",
    "figures [ k10pepi ] and [ k20pepi ] show that the bond percolation model significantly overestimated the probability of an epidemic for all @xmath195 combinations .",
    "the percolation network predictions were far closer to the observed values .",
    "for any time - homogeneous sir epidemic model , the problem of analyzing its final outcomes can be reduced to the problem of analyzing the components of an epidemic percolation network .",
    "the distribution of outbreak sizes starting from a node @xmath0 is identical to the distribution of its out - component sizes in the probability space of percolation networks .",
    "calculating this distribution may be extremely difficult for a finite population , but it simplifies enormously in the limit of a large population for many sir  models .  for a single randomly chosen imported infection in the limit of a large population ,",
    "the distribution of self - limited outbreak sizes is equal to the distribution of small out - component sizes and the probability of an epidemic is equal to the relative size of the gin .  for any finite set of imported infections ,",
    "the relative final size of an epidemic is equal to the relative size of the gout .     in this paper , we used epidemic percolation networks to reanalyze the sir epidemic model studied in @xcite .",
    "the mapping to a bond percolation model correctly predicts the distribution of in - component sizes , the critical transmissibility , and the final size of an epidemic .",
    "however , it fails to predict the correct distribution of outbreak sizes and overestimates the probability of an epidemic when the infectious period is nonconstant .",
    "since all known infectious diseases have nonconstant infectious periods and heterogeneity in infectiousness has important consequences in real epidemics @xcite , it is important to be able to analyze such models correctly .",
    "the exact finite - population isomorphism between a time - homogeneous sir model and our semi - directed epidemic percolation network is not only useful because it provides a rigorous foundation for the application of percolation methods to a large class of sir epidemic models ( including fully - mixed models as well as network - based models ) , but also because it provides further insight into the epidemic model .",
    "for example , we used the mapping to an epidemic percolation network to show that the distribution of in- and out - component sizes in the sir model from @xcite could be calculated by treating the incoming and outgoing infectious contact processes as separate directed percolation processes , as in @xcite .",
    "however , in contrast with @xcite , the semi - directed epidemic percolation network isolates the fundamental role of the gscc in the emergence of epidemics .",
    "the design of interventions to reduce the probability and final size of an epidemic is a central concern of infectious disease epidemiology .  in a forthcoming paper , we analyze both fully - mixed and network - based sir models in which vaccinating those nodes most likely to be in the gscc is shown to be the most effective strategy for reducing both the probability and final size of an epidemic .  if the incoming and outgoing contact processes are treated separately , the notion of the gscc is lost .",
    "* acknowledgments : * _ this work was supported by the us national institutes of health cooperative agreement 5u01gm076497 models of infectious disease agent study `` ( e.k . ) and ruth l. kirchstein national research service award 5t32ai007535 epidemiology of infectious diseases and biodefense '' ( e.k . ) , as well as a research grant from the institute for quantitative social sciences at harvard university ( e.k . ) .",
    "joel c. miller s comments on the proofs in sections 3 and 4 were extremely valuable , and we are also grateful for the comments of marc lipsitch , james h. maguire , and the anonymous referees of pre .",
    "e.k . would also like to thank charles larson and stephen p. luby of the health systems and infectious diseases division at icddr , b ( dhaka , bangladesh ) .",
    "_    99 m. e. j. newman ( 2002 ) .",
    "spread of epidemic disease on networks .",
    "_ physical review e _ 66 , 016128 .",
    "m. e. j. newman , s. h. strogatz , and d. j. watts ( 2001 ) .",
    "random graphs with arbitrary degree distributions and their applications , _ physical review e _ 64 * * , * * 026118 .",
    "m. bogu and m. a. serrano ( 2005 ) .",
    "generalized percolation in random directed networks . _ physical review e _ 72 , 016106 .    l. a. meyers , m. e. j. newman , and b. pourbohloul ( 2006 ) . predicting epidemics on directed contact networks .",
    "_ journal of theoretical biology _",
    "240(3 ) : 400 - 418 .",
    "k. kuulasmaa ( 1982 ) . the spatial general epidemic and locally dependent random graphs .",
    "_ journal of applied probability _",
    "19(4 ) : 745 - 758 .",
    "e. kenah and j. robins ( 2007 ) .",
    "network - based analysis of stochastic sir epidemic models with random and proportionate mixing .",
    "arxiv : q-bio.qm/0702027 .",
    "a. broder , r. kumar , f. maghoul , p. raghavan , s. rajagopalan , r. stata , a. tomkins , and j. weiner ( 2000 ) .",
    "graph structure in the web .",
    "_ computer networks _ 33 : 309 - 320 .",
    "dorogovtsev , j.f.f .",
    "mendes , and a.n .",
    "sakhunin ( 2001 ) .",
    "giant strongly connected component of directed networks .",
    "_ physical review e , _ 64 : 025101(r ) .",
    "n. schwartz , r. cohen , d. ben - avraham , a .-",
    "barabsi , and s. havlin ( 2002 ) .",
    "percolation in directed scale - free networks .",
    "_ physical review e _ 66 , 015104(r ) .",
    "h. andersson and t. britton ( 2000 ) .",
    "_ stochastic epidemic models and their statistical analysis _",
    "( lecture notes in statistics v.151 ) .",
    "new york : springer - verlag .",
    "o. diekmann and j. a. p. heesterbeek ( 2000 ) .",
    "_ mathematical epidemiology of infectious diseases : model building , analysis and interpretation_. chichester ( uk ) : john wiley & sons .",
    "l. m. sander , c. p. warren , i. m. sokolov , c. simon , and j. koopman ( 2002 ) .",
    "percolation on heterogeneous networks as a model for epidemics .",
    "_ mathematical biosciences _ 180 , 293 - 305 .",
    "r. albert and a - l .",
    "barabsi ( 2002 ) .",
    "statistical mechanics of complex networks .",
    "_ reviews of modern physics , _ 74 : 47 - 97 .",
    "m. e. j. newman ( 2003 ) . the structure and function of complex networks .",
    "_ siam reviews , _",
    "45(2 ) : 167 - 256 .",
    "m. e. j. newman ( 2003 ) .",
    "random graphs as models of networks , in  _ handbook of graphs and networks , _ pp .",
    "s. bornholdt and h. g. schuster , eds .",
    "berlin : wiley - vch , 2003 .",
    "newman , a .-",
    "barabsi , and d.j .",
    "watts ( 2006 ) . _ the structure and dynamics of networks _",
    "( princeton studies in complexity ) .",
    "princeton : princeton university press .",
    "h. andersson .",
    "limit theorems for a random graph epidemic model ( 1998 ) . _",
    "the annals of applied probability",
    "_ 8(4 ) : 1331 - 1349 .",
    "k. kuulasmaa and s. zachary ( 1984 ) . on spatial general epidemics and bond percolation processes .",
    "_ journal of applied probability _",
    "21(4 ) : 911 - 914 .",
    "j. miller ( 2007 ) . predicting the size and probability of epidemics in populations with heterogeneous infectiousness and susceptibility .",
    "_ physical review e _ 76 : 010101(r ) .",
    "m. lipsitch , t. cohen , b. cooper , j. m. robins , s. ma , l. james , g. gopalakrishna , s. k. chew , c. c. tan , m. h. samore , d. fishman , and m. murray ( 2003 ) . transmission dynamics and control of severe acute respiratory syndrome .",
    "_ science _ 300 : 1966 - 1970 .",
    "s. riley , c. fraser , c. a. donnelly , a. c. ghani , l. j. abu - raddad , a. j. hedley , g. m. leung , l .- m .",
    "lam , t. q. thach , p. chau , k .-",
    "chan , s .- v .",
    "lo , p - y leung , t. tsang , w. ho , k .- h .",
    "lee , e. m. c. lau , n. m. ferguson , and r. m. anderson ( 2003 ) .",
    "transmission dynamics of the etiological agent of sars in hong kong : impact of public health interventions . _ science _ 300 : 1961 - 1966 .    c. dye and n. gay . modeling the sars epidemic ( 2003 ) .",
    "_ science _ 300 : 1884 - 1885 .",
    "j. wallinga and p. teunis ( 2004 ) .",
    "different epidemic curves for severe acute respiratory syndrome reveal similar impacts of control measures .",
    "_ american journal of epidemiology , _",
    "160(6 ) : 509 - 516 ."
  ],
  "abstract_text": [
    "<S> in an important paper , m.e.j . </S>",
    "<S> newman claimed that a general network - based stochastic susceptible - infectious - removed ( sir ) epidemic model is isomorphic to a bond percolation model , where the bonds are the edges of the contact network and the bond occupation probability is equal to the marginal probability of transmission from an infected node to a susceptible neighbor .  in this paper </S>",
    "<S> , we show that this isomorphism is incorrect and define a semi - directed random network we call the _ epidemic _ _ percolation network _ that is exactly isomorphic to the sir epidemic model in any finite population .  in the limit of a large population , ( i ) </S>",
    "<S> the distribution of ( self - limited ) outbreak sizes is identical to the size distribution of ( small ) out - components , ( ii ) the epidemic threshold corresponds to the phase transition where a giant strongly - connected component appears , ( iii ) the probability of a large epidemic is equal to the probability that an initial infection occurs in the giant in - component , and ( iv ) the relative final size of an epidemic is equal to the proportion of the network contained in the giant out - component .  for the sir model considered by newman , we show that the epidemic percolation network predicts the same mean outbreak size below the epidemic threshold , the same epidemic threshold , and the same final size of an epidemic as the bond percolation model .  </S>",
    "<S> however , the bond percolation model fails to predict the correct outbreak size distribution and probability of an epidemic when there is a nondegenerate infectious period distribution .  </S>",
    "<S> we confirm our findings by comparing predictions from percolation networks and bond percolation models to the results of simulations .  in an appendix </S>",
    "<S> , we show that an isomorphism to an epidemic percolation network can be defined for any time - homogeneous stochastic sir model . </S>"
  ]
}