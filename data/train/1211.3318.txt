{
  "article_text": [
    "piecewise - affine ( pwa ) systems are a large modeling class for nonlinear systems .",
    "however most of the nonlinear control theory does not apply to pwa systems because it requires certain smoothness assumptions . on the other hand",
    ", linear control theory can not be simply employed due to the special properties of pwa systems inherited from nonlinear systems .",
    "pwa systems can naturally arise from linear systems in the presence of state saturation or from simple hybrid systems with state - based switching where the continuous dynamics in each regime are linear or affine @xcite .",
    "many engineering systems fall in this category , like power electronics converters for example .",
    "in addition , common electrical circuits components as diodes and transistors are naturally modeled as piecewise - linear elements .",
    "pwa systems are also used to approximate large classes of nonlinear systems as in @xcite , @xcite , and @xcite .",
    "these approximations are then used to pose the controller design problem of the original nonlinear system as a robust control problem of an uncertain nonlinear system as suggested in @xcite .",
    "problems of piecewise - affine systems are known to be challenging .",
    "the problems have a complex structure of regions stacked together in the state - space with each region containing an affine system .",
    "any approach must identify the behavior in each region and then link them together to form a global picture of the dynamics . in @xcite , it has been shown that even for some simple pwa systems the problem of analysis or design can be either np - hard or undecidable .",
    "the motivation behind the research in this paper is the need of optimal control synthesis methods for continuous - time pwa systems with both input and state constraints .",
    "additionally , there is often a need to find suitable tools for the design of stabilizing feedback controllers under state and input constraints . over the last few years",
    ", there were several attempts addressing the synthesis problem for continuous - time pwa systems .",
    "the techniques are based on analysis methods and use convex optimization .",
    "these methods result in a state - based switched linear or affine controllers .",
    "for example , in @xcite a piecewise - linear state - feedback controller synthesis is done for piecewise - linear systems by solving convex optimization problem involving lmis .",
    "the method is based on constructing a globally quadratic lyapunov function such that the closed - loop system is stable .",
    "similarly , in @xcite a quadratic performance index is suggested to obtain lower and upper bounds for the optimal cost using any stabilizing controller .",
    "however , the optimal controller is not computed .",
    "the method assumes a piecewise - affine controller structure which can be shown not to be always optimal ( see section [ example ] ) . in @xcite ,",
    "the work done in @xcite is extended to obtain dynamic output feedback stabilizing controllers for piecewise - affine systems .",
    "it formulates the search for a piecewise - quadratic lyapunov function and a piecewise - affine controller as a nonconvex bilinear matrix inequality ( bmi ) , which is solved only locally by convex optimization methods .",
    "more recently in @xcite , a nonconvex bmi formulation is used to compute a state feedback control law .    for constrained pwa systems in discrete - time where both the partitions and the constraints are polyhedral regions",
    ", @xcite combines multi - parametric programming , dynamic programming and polyhedral manipulation to solve optimal control problems for linear or quadratic performance indices .",
    "the resulting solution when applied in receding horizon fashion guarantees stability of the closed - loop system .    to the best of the authors knowledge",
    "there are no available guaranteed methods for synthesis of optimal controllers in continuous - time for pwa systems that consider general semi - algebraic state - space partitions , or that do not restrict the controller to be piecewise - affine , or do not require the performance index to be quadratic or piecewise - quadratic .    the technique presented in this paper",
    "provides a systematic approach , inspired by @xcite , to synthesize a suboptimal state feedback control law for continuous - time pwa systems with multiple equilibria based on a polynomial approximation of the value function .",
    "the ocp is first formulated as an infinite - dimensional linear program ( lp ) over a space of occupation measures .",
    "the pwa structure of the dynamics and the state - space partition are then used to decompose the occupation measure of the trajectory into a combination of local occupation measures , one measure for each partition cell .",
    "then , the lp formulation can be written in terms of only the moments of the occupation measures ( countably many variables ) .",
    "this allows for a numerical solution via a hierarchy of convex lmi relaxations with vanishing conservatism which can be solved using off - the - shelf sdp solvers .",
    "the relaxations give an increasing sequence of lower bounds on the optimal value .",
    "an important feature of the approach is that state constraints as well as any input constraints are very easy to handle .",
    "they are simply reflected into constraints on the supports of the occupation measures .",
    "it turns out that the dual formulation of the original infinite - dimensional lp problem on occupation measures can be written in terms of sum - of - squares ( sos ) polynomials , that when solved yields a polynomial subsolution of the hamilton - jacobi - bellman ( hjb ) equation of the ocp .",
    "this gives a good polynomial approximating value function along optimal trajectories that can be used to synthesize a suboptimal , yet admissible , control law .",
    "the idea behind the developed suboptimal policy exploits the structure of the hjb equation to generate the optimal control trajectory .",
    "the right - hand side of the hjb equation is iteratively minimized to construct a state feedback in a sample - and - hold manner with stabilization and suboptimality guarantees .",
    "in this section , we first introduce the piecewise - affine continuous - time model , and then formulate the optimal control problem using some important assumptions .",
    "we consider exclusively continuous - time pwa systems .",
    "the term pwa is to be understood as pwa in the system state @xmath0 .",
    "the state - space is assumed to be partitioned into a number of cells @xmath1 such that the dynamics in each cell takes the form @xmath2 where @xmath3 is the set of cell indices , and the union of all cells is @xmath4 .",
    "the global dynamics of the system depends on both the cells and the corresponding local dynamics .",
    "the matrices @xmath5 , @xmath6 , and @xmath7 are time independent . in general , the geometry of the partition @xmath8 can be arbitrary . however , to arrive at useful results we assume the cells to be compact basic semi - algebraic sets ( intersection of polynomial sublevel sets ) with disjoint interiors .",
    "they are allowed to share boundaries as long as these boundaries have lebesgue measure zero in @xmath9 .",
    "there are many notions of solutions for pwa systems with different regularity assumptions on the vector field .",
    "the concern here is to ensure the uniqueness of the trajectories .",
    "systems with discontinuous right - hand sides can have attracting sliding modes , non - unique trajectories , or trajectories may not even exist in the classical sense @xcite , @xcite .",
    "we assume that the pwa system is well - posed in the sense that it generates a unique trajectory for any given initial state .",
    "this is guaranteed if we assume that the global vector field is lipschitz .",
    "it is usually the case if the model is the result of approximating a nonlinear function .",
    "optimal control problems ( ocps ) of pwa systems are usually lagrange problems where the state - space is partitioned into a finite number of cells . in addition to the dynamics ,",
    "the cost functional can be also defined locally in each cell .",
    "the objective is to find optimal trajectories starting from an initial set and terminating at a target set that minimize the running cost and respect some input and state constraints .",
    "consider the following general free - time pwa ocp with both terminal and running costs @xmath10 \\\\ & & & x(0 ) = x_0 \\in x_0 \\subset \\mathbb{r}^n ,   & \\\\ & & & x(t ) = x_t \\in x_t \\subset \\mathbb{r}^n , \\\\ & & & ( x(t ) , u(t ) ) \\in x \\times u \\subset \\mathbb{r}^n \\times \\mathbb{r}^m .",
    "\\label{pwaocp } \\end{aligned}\\ ] ] where the scalar mapping @xmath11 is the indicator function defined as follows : @xmath12    the infimum in ( [ pwaocp ] ) is sought over all admissible control functions @xmath13 with free final time @xmath14 .",
    "the dynamic programming approach of optimal control reduces the above problem to the problem of solving the following system of hamilton - jacobi - bellman ( hjb ) equations for the value function @xmath15 :    @xmath16    with the terminal condition @xmath17    in full generality , solving the hjb equations is very hard and the value function is not necessarily differentiable .",
    "therefore , solutions must be interpreted in a generalized sense .",
    "to proceed , we adopt the following assumptions :    * the terminal time @xmath14 is finite and the control functions @xmath13 are measurable . *",
    "the pwa system is well - posed in the sense that it generates a unique trajectory from every initial state , and the vector field is locally lipschitz .",
    "* the lagrangians and the terminal cost are polynomial maps , namely @xmath18\\ ; \\forall i$ ] and @xmath19 $ ] . * the cells @xmath1 , the control set @xmath20 , the sets @xmath21 and @xmath22 are compact basic semi - algebraic sets defined as follows : @xmath23 + @xmath24 * the cells @xmath1 have disjoint interior and they are allowed to share boundaries as long as these boundaries have lebesgue measure zero in @xmath9 .",
    "in this section , we formulate the nonlinear and nonconvex pwa ocp ( [ pwaocp ] ) into a convex infinite - dimensional optimization problem over the state - action occupation measure @xmath25 .",
    "the problem is then approached by an asymptotically converging hierarchy of lmi relaxations to arrive at a polynomial approximation of the value function .",
    "occupation measures are used to deal with dynamic objects where time is involved .",
    "we focus on the application of occupation measures to dynamic control systems where the dynamic objects are ordinary differential equations .",
    "starting by the pwa vector field , we generate a sequence of moments by writing the odes in terms of occupation measures .",
    "we then manipulate the measures through their moments to optimize over system trajectories using a linear matrix inequality ( lmi ) representation .    to illustrate the measures formulation ,",
    "first consider the uncontrolled autonomous dynamic system defined by the lipschitz vector field @xmath26 and the nonlinear differential equation @xmath27    we think of the initial state @xmath28 as a random variable in @xmath29 modeled by a probability measure @xmath30 supported on the compact set @xmath21 , i.e. a nonnegative measure @xmath30 such that @xmath31 .",
    "then at each time instant @xmath32 , the state @xmath33 can also be seen as a random variable ruled by a nonnegative probability measure @xmath34 . solving ( [ eq : ode ] ) for the state trajectory @xmath33 yields a family of trajectories starting in @xmath21 and ending at a final set @xmath22 .",
    "the measure @xmath34 of a set can then be thought of the ratio of the volume of trajectory points that lie inside that set at time @xmath32 to the total volume of points at time @xmath32 . in particular , if the number of trajectory points one is considering is finite , then the measure @xmath34 of a set is nothing else than the ratio of trajectory points that lie in the set at time @xmath32 to the total number of trajectory points .",
    "the family of measures @xmath34 can thus be thought of as a density of trajectory points and satisfies the following linear first - order continuity pde in the nonnegative probability measures space    @xmath35    the above equation is known as liouville s equation or advection pde , in which @xmath36 denotes the divergence of measure @xmath37 in the sense of distributions .",
    "it describes the linear transport of measures from the initial set to the terminal set .",
    "the occupation measure of the solution over some subset @xmath38 in the @xmath39-algebra of @xmath40 \\times x$ ] is simply defined as the time integration of @xmath34 as follows @xmath41 where the last equality is valid when @xmath33 is a single solution to equation ( [ eq : ode ] ) .",
    "it is important to note that when the initial condition @xmath28 is deterministic , the occupation measure @xmath25 is the time spent by the solution @xmath33 in the subset @xmath42 when @xmath43 .",
    "we see that the occupation measure can indicate when the solution is within a given subset .      in the sigma - algebra of borel sets ( smallest sigma - algebra that contains the open sets )",
    "let @xmath44 denote the space of signed borel measures supported on a compact subset @xmath9 of the euclidean space .",
    "furthermore let @xmath45 be the space of bounded continuous functions on @xmath9 , equipped with the supremum norm .",
    "then , the space @xmath44 is the dual space of @xmath45 with the following duality bracket @xmath46    now consider the piecewise - affine optimal control problem ( [ pwaocp ] ) , and assume that the control trajectory @xmath47 is admissible such that all the constraints of the ocp are respected .",
    "accordingly , we define the state - action local occupation measure ( including sets on the space of control inputs ) associated with the cell @xmath1 to be @xmath48 \\times x_i \\times u ) = \\int_{0}^{t }   { 1{\\hskip -2.5 pt}\\hbox{i}}_{x_i \\times",
    "u } ( x(t),u(t ) ) dt.\\ ] ]    the local occupation measure @xmath49 encodes the trajectories in the sense that it measures the total time spent by the trajectories @xmath50 in the admissible set @xmath51 .",
    "furthermore , define the global state - action occupation measure for the trajectory @xmath52 as a linear combination of local occupation measures such that @xmath53 \\times x \\times u ) & = \\int_{0}^{t }   { 1{\\hskip -2.5 pt}\\hbox{i}}_{x \\times",
    "u } ( x(t),u(t ) ) dt\\\\ & = \\sum_{i=1}^r \\mu_i(x_i \\times u ) .",
    "\\end{aligned}\\ ] ] the indicator function @xmath54 equals @xmath55 through the interval @xmath40 $ ] .",
    "the occupation measure of the whole state space is given by the terminal time @xmath14 .",
    "in general we should make sure that @xmath14 is finite , otherwise the occupation measure of the whole state space may escape to infinity .",
    "the initial and terminal occupation measures are probability measures supported on @xmath21 and @xmath22 , respectively .",
    "the objective function of problem ( [ pwaocp ] ) can now be rewritten in terms of these measures to get the following linear cost @xmath56 with duality brackets , it reads @xmath57 if the lagrangian is the same for all the cells , say @xmath58 , the performance measure can be written in terms of the global state - action occupation measure as @xmath59 our next step is to determine the measure transport equation that encodes the pwa dynamics in the measure space . to do that",
    ", we define a compactly supported global test function @xmath60 .",
    "then for @xmath61 we define a linear map @xmath62 @xmath63 integration gives the following @xmath64 equivalently , we can write @xmath65    now define the following ( @xmath66)-tuple , in which we gather all the local occupation measures as the first @xmath67 elements , and the terminal occupation measure as the last element @xmath68 the piecewise - affine optimal control problem ( [ pwaocp ] ) is equivalent to the following infinite - dimensional linear optimization problem over occupation measures : @xmath69 furthermore , defining the linear mapping @xmath70 , as @xmath71 we can rewrite the constraint in ( [ eq : lpv ] ) as @xmath72 this defines the adjoint map @xmath73 .",
    "the measure transport equation ( [ transport ] ) is then given by @xcite @xmath74 with the symbol @xmath75 denoting the dynamics in the cell with index @xmath61 .",
    "finally , define the tuple @xmath76 , and associate the piecewise - affine optimal control problem ( [ pwaocp ] ) to the following infinite - dimensional linear program @xmath77 this is the primal formulation of the ocp in terms of occupation measures of the trajectory @xmath52 .",
    "the nonlinear nonconvex pwa ocp ( [ pwaocp ] ) is therefore reformulated as an infinite - dimensional lp in the measure space .",
    "the moments of the occupation measure @xmath25 are defined by integration of monomials with respect to @xmath25 .",
    "the @xmath78-th moment of @xmath25 over the support @xmath9 is given by @xmath79 where @xmath80 .",
    "noting that @xmath81 and using the definition ( [ mudef ] ) of @xmath25 , moments can be rewritten as @xmath82^\\alpha dt , \\quad \\forall \\alpha \\in \\mathbb{n}^n\\ ] ] where @xmath33 denotes the solution of the ode starting at @xmath28 .",
    "this follows from the definition of @xmath25 .",
    "therefore , if we can find the moments and handle the representation conditions ( [ moments ] ) , solving the moments gives the solution of the ode because the infinite ( but countable ) number of moments uniquely characterize a measure ( on a compact set ) .",
    "note that lps ( [ eq : lpv ] ) and ( [ primallp ] ) are equivalent . to proceed",
    "numerically we restrict the continuously differentiable functions to be polynomial functions of the state .",
    "in other words , we consider @xmath83 \\subset \\mathcal{c}^1(x)$ ] . by this restriction",
    ", we obtain an instance of the generalized moment problem ( gmp ) , i.e. an infinite - dimensional linear program over moments sequences corresponding to the occupation measures .",
    "it turns out that if the supports of the measures are compact basic semi - algebraic sets , the gmp can be approached using an asymptotically converging hierarchy of lmi relaxations .    to write the semidefinite relaxation of the primal infinite - dimensional lp , let @xmath84 , be the moments sequence corresponding to the local occupation measure @xmath85 , @xmath61",
    ". moreover , let @xmath86 and @xmath87 with @xmath88 be the moment sequences corresponding to @xmath30 and @xmath89 respectively .",
    "given any infinite sequence @xmath90 of real numbers with @xmath91 , define the linear functional @xmath92 \\to \\mathbb{r}$ ] that maps polynomials to real numbers as follows @xmath93    in each lmi relaxation we truncate the infinite moment sequence to a finite number of moments . the lmi relaxation of order @xmath94 , including moments up to @xmath95 , of the gmp instance ( [ primallp ] ) can be formulated by taking test functions @xmath96 with @xmath91 , such that @xmath97 , as follows @xmath98    the minimum relaxation order has to allow the enumeration of all the moments appearing in the objective function and the linear equality constraint .",
    "the matrices @xmath99 and @xmath100 are called moment matrices of the local occupation measure and terminal probability measures , respectively .",
    "each moment matrix is defined to be a square matrix of dimension @xmath101 filled with the first @xmath95 moments corresponding to the representing measure .",
    "they are linear in the moments .",
    "similarly , the matrices @xmath102 and @xmath103 are linear in the moments and are called localizing matrices .",
    "the linear equality constraint represents the peicewise - affine dynamics , and the lmis ensure that ( [ moments ] ) holds and that the measures are supported on the given sets defined in ( [ regions])([eq : sets ] ) ( see @xcite for more details ) .",
    "the duality between finite measures and compactly supported bounded continuous functions is captured by convex analysis .",
    "the dual of the lp ( [ primallp ] ) is thus formulated over the space of positive bounded continuously differentiable functions as follows @xmath104 where @xmath105 is a vector of continuous functions .",
    "the dual lp can be written in more explicit form to reveal the structure of the linear constraints .",
    "we can equivalently write @xmath106 and more explicitly @xmath107 we note that any feasible solution of sdp ( [ sdp ] ) is actually a global smooth subsolution of the hjb equations ( [ hjb ] ) . by conic complementarity , along the optimal trajectory @xmath108 , it holds @xmath109 therefore , for the optimal dual function @xmath15 , the following holds : @xmath110 and in addition , @xmath111    this is an important result .",
    "it shows the following :    1 .   with a careful look",
    ", we can easily identify what we have in ( [ eq : pwah ] ) to be the hjb pde of the pwa optimal control problem satisfied along optimal trajectories , with the terminal conditions given by ( [ eq : pwat ] ) .",
    "the optimal dual function @xmath112 is equivalent to the value function of the optimal control problem , hence the notation .",
    "the maximizer function @xmath112 of the dual infinite - dimensional lp in equation ( [ duallp ] ) solves , globally , the hjb equation of the pwa optimal control problem along optimal trajectories .    the dual convex relaxation , dual of lmi ( [ primalsdp ] ) , is formulated over positive polynomials .",
    "positivstellensatz @xcite is used to enforce positiveness .",
    "therefore , the unknown dual variables are the coefficients of the polynomial @xmath113 and several sos polynomials that deal with the polynomial positivity conditions of the constraints . the dual program can then be written as follows : @xmath114 in which the degree of @xmath115 is @xmath94 .",
    "the polynomials @xmath116 are positive .",
    "they are putinar s sos representations of the constraint polynomials @xcite .",
    "the polynomials @xmath117 define the set @xmath51 and the polynomials @xmath118 define the set @xmath22 , see equations ( [ regions])([eq : sets ] ) .    using weak - star compactness arguments similar to those in the proof of (",
    "* theorem 2 ) , we can show that @xmath119 .",
    "moreover , the equality @xmath120 holds if we allow relaxed controls ( enlarging the set of admissible control functions to probability measures ) and chattering phenomena in ocp ( [ pwaocp ] ) , see e.g. the discussion in ( * ? ? ?",
    "* section 3.2 ) and references therein .",
    "note that in @xcite , the identity @xmath121 was shown under stronger convexity assumptions .",
    "assume that the analytical value function @xmath112 of a general optimal control problem is available by solving the hjb pde .",
    "the optimal feedback control function @xmath122 can then be selected such that it generates an admissible optimal control trajectory @xmath123 that satisfies the optimal necessary and sufficient conditions ( [ eq : pwah ] ) .",
    "the resulting optimal feedback function @xmath124 generates the admissible optimal control trajectory starting from any initial value @xmath28 .",
    "therefore we get the solution of the ocp as a feedback strategy , namely , if the system is at state @xmath0 , the control is adjusted to @xmath125 .",
    "this approach has the difficulty that even if the value function was smooth there would be in general no continuous optimal state feedback law that satisfies the optimality conditions for every state .",
    "it is well - known from brockett s existence theorem that if a dynamic control system with some vector field @xmath126 admits a continuous stabilizing feedback law ( taking the origin as equilibrium point ) , then for every @xmath127 , the set @xmath128 is a neighborhood of the origin @xcite , where @xmath129 is a ball of radius @xmath130 with a center at zero .",
    "one famous example where this condition fails is the nonholonomic integrator @xcite .",
    "more recently it was shown that asymptotic controllability of a system is necessary and sufficient for state feedback stabilization without insisting on the continuity of the feedback .",
    "the synthesis of such discontinuous feedbacks was described in @xcite , together with a definition of a solution concept for an ode with discontinuous dynamics , namely the sample - and - hold implementation .",
    "it turns out that this concept is very convenient for pwa systems . the first paper to deal with sampled - date pwa systems in the form used here",
    "can be found in reference @xcite .",
    "the suboptimal trajectory of the control system is defined by a partition , call it @xmath131 , of the time set @xmath132 $ ] as follows : define @xmath133 with a given diameter @xmath134 such that @xmath135 .",
    "the sequence @xmath136 for @xmath137 depends on the evolution of the trajectory and the diameter of the partition @xmath138 .",
    "starting at an initial point @xmath136 , the suboptimal trajectory is the classical solution of the lipschitz ode @xmath139 such that @xmath140 depends on the evolution of the trajectory .",
    "the generated suboptimal trajectory corresponds to a piecewise constant open - loop control ( point - wise feedback ) which has physical meaning .",
    "the optimal points of the trajectory are those points at the beginning of each subinterval at which the control is updated using the optimal control function .",
    "the suboptimal trajectory converges to the optimal trajectory when @xmath141 .",
    "this corresponds to increasing the sampling rate in the implementation such that the sampling time @xmath142 . in this case",
    "the generated trajectory corresponds to a fixed optimal feedback .",
    "this can be shown as follows : take a partition @xmath131 with @xmath143 , we can use the mean value theorem to write @xmath144 ( t_{j+1 } - t_j)\\\\   \\delta_j & = ( t_{j+1 } - t_j ) < = \\delta , \\text { and } \\tau \\in [ 0 , \\delta_j ] . \\end{aligned}\\ ] ] and we note that when @xmath145 , @xmath146 and the algorithm converges to the optimal trajectories .",
    "it is then clear that for every initial condition @xmath28 , and some prescribed @xmath147 ; there exist some @xmath127 and @xmath148 such that if @xmath149 the generated suboptimal trajectories starting at @xmath28 satisfy @xmath150 in the special case of having @xmath151 , we have no gap due to the algorithm and @xmath152 .    assuming that a polynomial approximation of the value function for a given pwa continuous system is available by solving the relaxed dual lmi , the proposed suboptimal feedback policy @xmath153 is constructed using closed - loop sampling and algorithm [ alg1 ] .",
    "@xmath138 , @xmath154 , @xmath155 , @xmath156 , and poly .",
    "approx . of @xmath157 @xmath158 , @xmath159 , @xmath160 .",
    "solve the static polynomial optimization problem @xmath161 solve @xmath162 , starting at @xmath136    set @xmath163 set @xmath164 , and @xmath165 .",
    "determine new region @xmath166 for @xmath33 and set @xmath167    @xmath168 , @xmath33 , and @xmath47 with @xmath169 .",
    "we consider a first - order pwa dynamic system with two cells .",
    "the optimization is done over both the control action and time horizon ( free time ) .",
    "the ocp is defined as follows : @xmath170 where @xmath15 is the value function , and @xmath171 is the initial state . the control @xmath47 is assumed to be a bounded measurable function defined on the interval @xmath172 $ ] , and taking its values in @xmath173 .",
    "the state space is partitioned into two unbounded regions @xmath174    the control hamiltonian @xmath175 is used to write the hjb equation . since the terminal time @xmath14 is subject to optimization , the control hamiltonian vanishes along the optimal trajectory .",
    "this gives the hjb pde @xmath176.\\ ] ]    an analytical optimal solution can be obtained by solving the hjb equations corresponding to each cell .",
    "this results in a state feedback control @xmath177 that satisfies the hjb pde ( [ eq : hjb_ex1 ] ) for all @xmath172 $ ] and @xmath0 . the optimal control trajectory @xmath178\\ ] ]",
    "is obtained when the optimal state feedback is applied starting at the given initial condition .",
    "the partial derivative of the value function with respect to the state is a viscosity solution of the hjb pde ( [ eq : hjb_ex1 ] ) , see e.g. @xcite .",
    "the initial and final states are known .",
    "therefore , the initial and terminal occupation measures are dirac measures .",
    "the global occupation measure @xmath179 is used to encode the system trajectories .",
    "it is defined as a combination of two local occupation measures , one for each cell , as follows @xmath180 such that the support of @xmath181 is @xmath182 and the support of @xmath183 is @xmath184 .",
    "the ocp can then be formulated as an infinite - dimensional lp in measure space @xmath185 where @xmath30 and @xmath89 are the initial and final measures , supported on @xmath186 , @xmath187 , respectively , and @xmath188 is the lagrangian .",
    "the functions @xmath113 are functions of the state @xmath0 and belong to the space of continuously differentiable functions .",
    "the matlab toolbox gloptipoly @xcite is used to formulate this infinite - dimensional lp on measures as a gmp . here",
    ", we are mainly interested in solving the dual formulation on functions .    in the present example , both the state space and the input space are not compact .",
    "hence , the lmi relaxations do not include any localizing constraints ; moreover , putinar s conditions are not sufficient for the convergence of the lmi optimal value .",
    "the sufficiency is guaranteed only for measures on compact support .",
    "the main concern here is that the mass ( zeroth moment ) of the occupation measure is not bounded and might tend to infinity .",
    "this is numerically problematic .",
    "there are two ways to turn this around .",
    "the first is to make the time interval compact by adding a constraint on the mass of the global occupation measure .",
    "for example we enforce that the mass of @xmath25 is less than a given large positive number .",
    "this exploits the fact that the vector field is asymptotically stable . another way , which is more general , is to constrain @xmath9 and @xmath20 to sufficiently large subsets .",
    "one possibility is to take @xmath9 as a large ball centered around @xmath189 ( or the initial state @xmath28 ) .",
    "the same can be assumed for the input space @xmath20 .",
    "this is done without any problems as long as the optimal trajectory remains in the constraint set @xmath190 . to avoid numerical problems ,",
    "it is also recommended in all cases to scale down the problem , if possible , to have all the variables inside the unit box . scaling avoids",
    "blow up of the moments sequences for high relaxation orders .",
    "the results obtained below for the ocp ( [ eq : ex1 ] ) assume that the global occupation measure is supported on @xmath191 without introducing any constraints on the spaces .",
    "the solution consists of two main steps :    1 .   finding a relatively good polynomial approximation of the value function by solving the dual lmi relaxation of the infinite - dimensional lp ( [ eq : lp1 ] ) .",
    "2 .   employing the suboptimal strategy developed in section [ subsec : policy ] to generate a suboptimal admissible feedback control law based on the smooth approximation of the value function obtained in step 1 .    .",
    "]    the first step is achieved by solving the relaxed dual lmi on continuous functions .",
    "figure [ fig : ex1_vf ] shows the obtained approximation of the value function with lmi relaxation order @xmath192 .",
    "the obtained approximation is a polynomial of the state @xmath0 with degree equal to @xmath95 .",
    "based on this approximation , we employ algorithm [ alg1 ] from section [ subsec : policy ] .",
    "the resulting suboptimal feedback control is shown in figure [ fig : ex1_fb ] in comparison with the analytical optimal feedback , @xmath125 , calculated using ( [ eq : analytical_optimal ] ) .",
    "it is clear that the algorithm gives a suboptimal feedback close to the optimal .",
    "the focus of this paper is the synthesis of suboptimal state feedback controllers for continuous - time optimal control problems ( ocp ) with piecewise - affine ( pwa ) dynamics and piecewise polynomial cost functions .",
    "both state constraints and input constraints are considered in a very convenient way and they do not pose additional complexity .    the problem is formulated as an abstract infinite - dimensional convex optimization problem over a space of occupation measures which is then solved via a converging hierarchy of lmi problems . by restricting the dual variables in the dual of the original infinite - dimensional program to be monomials , we obtain a polynomial representation of the value function of the ocp in terms of upper envelope of subsolutions to a system of hjb equations corresponding to the ocp . by fixing the degree of the monomials , the same dual program can be relaxed and written , using putinar s positivstellensatz , as a polynomial sum - of - squares ( sos ) program , which can be transformed and solved as an lmi problem .",
    "as soon as the polynomial approximation of the value function is available , one can systematically generate a suboptimal , yet admissible , feedback control .",
    "the suboptimal control strategy is based on a closed - loop sampling implementation which is very convenient for pwa systems .",
    "the method generates an approximate control signal which is piecewise constant , and near optimal trajectories that respect the given constraints .",
    "part of this work was supported by project number 103/10/0628 of the grant agency of the czech republic , and we are particularly grateful to martin hromk for his help .",
    "r. w. brockett .",
    "asymptotic stability and feedback stabilization . in differential",
    "geometric control theory ( r. w. brockett , r. s. millman and h. j. sussmann , eds . ) , pp 181 - 191 , birkhauser , boston , ma , 1983 .",
    "p. julin , a. desages , o. agamennoni .",
    "high - level canonical piecewise linear representation using a simplicial partition .",
    "ieee trans .",
    "circuits systems i fund .",
    "theory appl .",
    "463 - 480 , 1999 ."
  ],
  "abstract_text": [
    "<S> this paper considers the class of deterministic continuous - time optimal control problems ( ocps ) with piecewise - affine ( pwa ) vector field , polynomial lagrangian and semialgebraic input and state constraints . </S>",
    "<S> the ocp is first relaxed as an infinite - dimensional linear program ( lp ) over a space of occupation measures . </S>",
    "<S> this lp , a particular instance of the generalized moment problem , is then approached by an asymptotically converging hierarchy of linear matrix inequality ( lmi ) relaxations . </S>",
    "<S> the relaxed dual of the original lp returns a polynomial approximation of the value function that solves the hamilton - jacobi - bellman ( hjb ) equation of the ocp . </S>",
    "<S> based on this polynomial approximation , a suboptimal policy is developed to construct a state feedback in a sample - and - hold manner . </S>",
    "<S> the results show that the suboptimal policy succeeds in providing a stabilizing suboptimal state feedback law that drives the system relatively close to the optimal trajectories and respects the given constraints . </S>"
  ]
}