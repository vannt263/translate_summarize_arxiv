{
  "article_text": [
    "* multiscale phenomena in fractured media .",
    "* subsurface formations with discrete fractures , faults , thin features are common in many applications .",
    "these include fractured subsurface formations , fractured composite materials , and so on .",
    "a main challenge in simulating complex processes is due to multiple scale and high contrast .",
    "the material properties within fractures can be very different from the background properties .",
    "due to complex fracture configurations , there are multiple scales and high contrast .",
    "* fine - grid simulation for fractures . * constructing a fine - grid simulation model is typically done in several steps ( we refer @xcite for the overview ) . as a first step",
    ", an unstructured grid is used to describe the fractures .",
    "then , the flow / transport equations are discretized on the unstructured grid .",
    "a variety of techniques have been applied for flow simulation in porous media with discrete fractures using both finite - element and finite - volume methods . within the finite - element framework , the standard galerkin formulation ( @xcite ) , the mixed finite - element method ( @xcite ) , and the discontinuous galerkin method ( @xcite )",
    "have been used to simulate single - phase and multiphase flow in discrete fracture models . within the finite - volume framework ,",
    "formulations have been presented by , e.g. , @xcite . a hybrid approach combining the finite - element method for the pressure equation and the finite volume method for transport",
    "has also been investigated ( @xcite ) .",
    "* the need for model reduction . * because of multiple scales and high contrast , some type of model reduction is needed for simulating physical processes in fractured media .",
    "typical approaches divide the domain into coarse grids , where effective properties in each coarse - grid block are computed @xcite .",
    "the standard upscaling methods compute the effective properties using the solution of local problems in each coarse block or representative volume . however , it is known that these approaches are not sufficient as each coarse block contains multiple important modes .",
    "this led to multi - continuum approaches @xcite , where several equations are formulated for each coarse block .",
    "in particular , the flow equation for the background ( called matrix ) and the fracture are written separately with some interaction terms .",
    "these approaches make several assumptions such as each continua connected throughout the domain and the form of the coupling .",
    "our goal is to show a relation between these approaches and some multiscale finite element methods and further discuss generalizations based on these approaches .    *",
    "brief introduction to the gmsfem . * the gmsfem @xcite follows the framework of the multiscale finite element method ( msfem ) and is introduced to systematically add new degrees of freedom in each coarse block .",
    "the new basis functions are computed by constructing the snapshots and performing local spectral decomposition in the snapshot space .",
    "it was shown that there is a spectral gap and the eigenvectors corresponding to very small eigenvalues represent the connected high - conductivity networks .",
    "these dominant eigenvectors represent fracture networks and can be thought as reduced degrees of freedom representing each continua as explained later .    * this paper . * in this paper , we discuss _ a relation between the gmsfem and the multi - continuum approaches_. as mentioned , the dominant eigenvectors represent the connected fracture networks . for example , if there are @xmath0 separate fracture networks within a coarse block , then we will have @xmath0 very small eigenvalues and the corresponding eigenvectors represent these fracture networks .",
    "we give a detailed comparison between the multi - continua approaches and the gmsfem in the paper .",
    "we discuss the interaction between different continuum media . in multi - continuum approaches ,",
    "this interaction is modeled based on physical principles , while the gmsfem approach provides a rigorous coupling between multiple continua .",
    "we note the gmsfem automatically takes into account the interaction of various continua between different coarse blocks , while in multi - continuum approaches , this interaction is stated apriori based on physical principles @xcite .",
    "we also present simplified basis functions that are related to fractures if the fracture networks are identified .    in the paper",
    ", we discuss _ a coupled gmsfem and the multi - continuum approaches _ by considering fractures over a very rich hierarchy of scales .",
    "our approach uses multi - continuum at the fine grid and the gmsfem for modeling the fractures that can be resolved on the fine grid ( see figure [ schematic ] ) . in this case",
    ", the method deals with a system of equations coupled with the fracture network .",
    "first , we discuss a gmsfem for this system .",
    "secondly , we discuss approaches for computing the parameters of the multi - continuum system based on local representative volume element ( rve ) computations .",
    "we discuss the setup of local rve problems and compute the parameters for the multi - continuum fine - grid discretization .",
    "since these parameters , in general , are heterogeneous , the use of coupled basis functions is crucial , and their constructions will be presented .",
    "we will also discuss a relation between the gmsfem and the multiple interacting continua ( minc ) @xcite .",
    "on the other hand , we establish _ a relation between offline gmsfem and the multi - continua approaches . _",
    "the gmsfem has several important fundamental ingredients that can further be used to achieve higher accuracy and more efficiency .",
    "the first ingredient includes the adaptivity .",
    "the gmsfem s adaptivity can be used to add multiscale basis functions in selected regions .",
    "this concept can be effectively used to add new multiscale basis functions in selected regions .",
    "the second ingredient of the gmsfem is online basis functions .",
    "these basis functions are constructed using the residual information ( adaptively in space and time ) to speed - up the simulations .",
    "this can be used to speed - up the convergence of the proposed method .",
    "we will show numerical results .",
    "first , we discuss the gmsfem s basis construction and numerically show how to identify the number of continua based on local spectral decomposition and the spectrum .",
    "then , we present a simplified basis construction and numerical results for the gmsfem using both simplified basis construction and a general approach . in the second part , we demonstrate numerical results when the gmsfem and the multi - continuum approaches are coupled . in this case",
    ", the multi - continuum approach is used on the fine grid .",
    "our numerical results use both coupled and un - coupled basis functions and show that the gmsfem is able to couple with the multi - continuum appraoch and gives accurate solution using few basis functions .",
    "the gmsfem can be used for heterogeneously varying multi - continuum problems . in @xcite",
    ", we have applied the gmsfem to shale gas flows in multi - continuum media . in this paper",
    ", we also present an example of the application of our proposed approach to shale gas transport .",
    "furthermore , we will present an analysis for the gmsfem when the fine - scale problem is described by a multi - continuum approach . in this case",
    ", the method gives a system of coupled equations .",
    "we study the convergence of the gmsfem for cases when basis functions are independently constructed and in a coupled fashion . in both cases ,",
    "convergence results are obtained .",
    "the paper is organized as follows . in section",
    "[ sec : sec1 ] , we discuss the relation between the gmsfem and multi - continuum approaches .",
    "we develop simplified basis functions and show numerical results . in section [ sec : sec2 ] , we discuss the coupled gmsfem and the multi - continuum approach .",
    "we also show numerical results in this section .",
    "the analysis is given in the appendix [ appendix ] .",
    "the goal of this section is to highlight the similarities between the multi - continuum approaches and the gmsfem .",
    "we assume that the fractures are resolved on a fine grid .",
    "we show that ( 1 ) the gmsfem can identify fracture networks and result in a similar system as a multi - continuum approach , ( 2 ) the gmsfem can resolve the detailed fracture and matrix interaction , and ( 3 ) the gmsfem basis functions can be computed in a simplified way .",
    "we consider a detailed fine - grid discretization of the flow equation in the fractured media @xmath1 where @xmath2 is the solution , @xmath3 is the source term , @xmath4 is permeability and @xmath5 is porosity .",
    "the permeability is large within fractures and the porosity has a smaller value in the fractures .",
    "fractures are modeled as one dimensional objects .",
    "the domain @xmath6 is divided into the fracture and the matrix region @xmath7 where @xmath8 and @xmath9 represent the matrix and the fracture regions .",
    "@xmath10 denotes the aperture of the @xmath11-th fracture and @xmath11 is the index of the fractures .",
    "we denote by @xmath12 the permeability of the @xmath11-th fracture .",
    "@xmath13 is a two - dimensional domain and @xmath14 is a one - dimensional domain . the system is written in a finite - element discretization .",
    "we introduce the concepts of fine and coarse grids .",
    "let @xmath15 be a coarse - grid partition ( computational grid ) of the computational domain @xmath6 into finite elements ( triangles , quadrilaterals , tetrahedra , etc . ) .",
    "we assume that each coarse element is partitioned into a connected union of fine grid blocks .",
    "the fine - grid partition will be denoted by @xmath16 , and is by definition a refinement of the coarse grid @xmath15 .",
    "we use @xmath17 ( where @xmath18 denotes the number of coarse nodes ) to denote the vertices of the coarse mesh @xmath15 and define the neighborhood of the node @xmath19 by @xmath20 see figure [ schematic ] for illustration",
    ".    the bilinear form for the resulting system is @xmath21 where @xmath22 is the fine - grid finite element function , @xmath23 is the derivative along the fracture lines , @xmath24 and @xmath25 porosity and permeability in the matrix , @xmath26 and @xmath27 porosity and permeability in the fractures , and @xmath28 .",
    "the fracture permeability and porosity include the aperature information @xmath10 .",
    "we remind that in our setup , we assume that a fine grid resolves some set of fractures ( very detailed ) , while each fine grid can contain many small fractures ( see figure [ schematic ] ) , i.e. , multi - continua .      the multi - continuum approach is an average model , which is solved on a coarse grid .",
    "we denote the solution for @xmath11-th continuum by @xmath29 and assume that each continuum interacts with every other , for the sake of generality .",
    "then , we can write the resulting system as @xmath30 where @xmath31 is an exchange term , which can contain both space and time derivates of @xmath29 s @xcite . in a special case when each continuum only interacts with the background ,",
    "if the background is @xmath32 , then @xmath33 where @xmath3 is the source term .",
    "we write this equation as @xmath34 where @xmath29 is solved on a coarse grid using standard basis functions and @xmath35 is a standard basis function .",
    "we discuss the use of the gmsfem on a coarse grid .",
    "the gmsfem uses the coarse grid @xmath15 and constructs a local reduced - order model for each coarse block , by constructing snapshot solutions and extracting basis functions .",
    "snapshots are constructed by solving local problems subject to some boundary conditions .",
    "below , we briefly discuss the snapshot calculations and the basis computations .",
    "we briefly describe the construction of the snapshot space @xmath36 .",
    "we refer to @xcite for further discussions .",
    "the snapshot space consists of local solutions .",
    "harmonic functions can be used to construct a snapshot space .",
    "we define @xmath37 , where @xmath38 , where @xmath39 denotes the fine - grid boundary node on @xmath40 and solve the local problems with @xmath37 as boundary conditions .",
    "more precisely , given a fine - scale piecewise linear function defined on @xmath41 ( @xmath42 is a coarse block and we omit the index @xmath11 ) , we define @xmath43 by the following variational problem @xmath44 and @xmath45 on @xmath41 .",
    "note that the source is also placed on fracture boundaries .",
    "the snapshot space is defined as @xmath46 where @xmath47 is the number of functions in the snapshot space in @xmath42 ( a generic coarse block ) .",
    "we also denote @xmath48.\\ ] ] we note that the randomized boundary conditions @xcite can be used to reduce the computational cost .",
    "in particular , we solve local problems subject to the boundary condition @xmath49 where @xmath50 takes independent random values at every grid block in an oversampled region @xmath51 , @xmath52 ( see @xcite for details ) . in this way",
    ", we can compute only @xmath53 snapshots for @xmath0 offline basis vectors .    to construct the offline space , @xmath54 , the local spectral problem is solved in the snapshot space @xcite .",
    "more precisely , @xmath55 where @xmath56 = \\int_{\\omega }    \\kappa_m \\ ,   \\nabla \\psi_m^{\\text{snap } } \\cdot \\nabla \\psi_n^{\\text{snap } } \\ , dx +   \\sum\\limits_j \\int_{d _ { f , j}\\cap \\omega } \\kappa_{f , j } \\ ,   \\nabla_f \\psi_m^{\\text{snap } } \\cdot \\nabla_f \\psi_n^{\\text{snap } } \\ , dx\\ ] ] @xmath57 = \\int_{\\omega }    \\kappa_m\\ ,   \\psi_m^{\\text{snap } } \\psi_n^{\\text{snap } } \\ , dx +   \\sum\\limits_j \\int_{d _ { f ,",
    "j}\\cap \\omega } \\kappa_{f , j } \\ ,   \\psi_m^{\\text{snap } } \\psi_n^{\\text{snap } } \\ , dx.\\ ] ] to compute the offline space , we choose @xmath58 smallest eigenvalues and form @xmath59 for @xmath60 .",
    "furthermore , the partition of unity functions @xmath61 ( taken to be linear basis functions supported in @xmath62 ) is multiplied by the eigenfunctions in the offline space @xmath63 to construct the resulting basis functions @xmath64 here @xmath65 denotes the number of offline eigenvectors that are selected for each coarse node @xmath11 . with the partition of unity functions , we obtain conforming basis functions in the space @xmath66 we can write @xmath67 , where @xmath68 ( here , we use a single index ) and define @xmath69,\\ ] ] where @xmath70 are nodal values of each basis function defined on the fine grid .",
    "we remark that there are other discretizations , such as discontinuous galerkin methods , hybridized galerkin methods , or other methods .",
    "multiscale basis functions can be constructed following a general framework @xcite .",
    "the use of discontinuous basis functions coupled within dg can be an attractive approach for these applications and we will study it in the future .",
    "next , we discuss some properties of multiscale basis functions , which show that the gmsfem basis functions can identify the fracture networks in a general case .",
    "further , we present some simplified basis computations , when the fracture networks have simplistic geometries",
    ". we note that each basis function represents a connected fracture network . to show this",
    ", we depict an example in figure [ sol - bst ] with several fractures . in the figure",
    ", we also show the eigenvalues .",
    "it can be observed that there are three very small eigenvalues and the fourth one is large .",
    "the eigenvalue distribution shows that there are three fracture networks .",
    "our construction can detect the fracture networks when fractures have a complex spatial distribution . moreover",
    ", multiscale basis functions can capture the interaction between the fracture and the background media .      for simple cases ,",
    "simplified basis functions can be constructed .",
    "for these basis functions , we can choose constants within fracture networks and solve local problems .",
    "in this way , we can avoid a general procedure .",
    "our main approach , which we will test , is the following .",
    "for each @xmath42 , we define the fracture networks @xmath71 ( see figure [ schematic_simplified ] ) .",
    "each fracture network intersects with the boundary of @xmath42 at the points @xmath72 . then , the multiscale basis functions are defined as @xmath73 @xmath74 here , @xmath75 corresponds to the local solution operator ( [ harmonic_ex ] ) .",
    "these basis functions are multipled by the partition of unity functions .",
    "the basis functions are plotted in figure [ sol - bsm ] .",
    "there are other possible approaches that can be considered .",
    "for example , the following approach can be an alternative .",
    "we denote each rectangle @xmath76 and denote internal edges by @xmath77 .",
    "we denote the fractures by @xmath78 in @xmath79 and the boundary nodes @xmath80 then , the multiscale basis functions are defined as @xmath73@xmath81      if we denote the basis function for the @xmath11-th network by @xmath82 , as described above , then @xmath83 note that @xmath84 in this case , the coarse - grid equation obtained by the gmsfem for the basis representing the @xmath11-th fracture network can be written as @xmath85 @xmath86 the last two terms represent the interaction of the @xmath11-th continuum with the other continua . in a special case when the interaction is only with the background",
    ", this implies that the support of @xmath87 and @xmath88 is empty unless @xmath89 or @xmath90 . in this case",
    ", the equation reduces to @xmath91      in this example , we take @xmath92 ^ 2 $ ] and solve @xmath93 by resolving the fractures with an embedded fracture model on the fine grid ( see e.g. , @xcite ) . the model for @xmath4",
    "is shown in figure [ schematic ] .",
    "we choose initial conditions @xmath94 and , as the boundary conditions , we set @xmath95 at the two points @xmath96 and @xmath97 and on other boundaries we use zero neuman boundary conditions . here , @xmath98 is the final time .",
    "we set @xmath99 , @xmath100 for the matrix coefficients and @xmath101 , @xmath102 for the fracture .",
    "we will compare the results in the weighted @xmath103 norm and weighted @xmath104 semi - norm computed as @xmath105 , @xmath106 , @xmath107 and @xmath2 are the fine - scale and coarse - scale ( multiscale ) solutions . in the simulation results ,",
    "we use @xmath108 to denote the number of basis functions per coarse element for @xmath2 and @xmath109 is the number of degrees of freedom .    in figure",
    "[ sol - s ] , we show solutions at the final time @xmath110 . in table [ tab : s ] , we present relative errors for gmsfem and simplified basis functions .",
    "the top portion of the table ( `` standard gmsfem '' ) uses multiscale basis functions constructed from the spectral problems and take the equal amount of basis functions in each coarse region . here",
    ", @xmath108 refers to the number of basis functions per node . as we observe that if we take @xmath111 basis functions per node , the error is below 5% . in the second portion of the table",
    ", we show the results if basis functions are selected based on small eigenvalues .",
    "@xmath112 refers to the case when we take only very small eigenvalues that represent the fracture networks . in this case",
    ", the error is small .",
    "@xmath113 and @xmath114 refer to the cases when we take one less or one more basis functions in each node .",
    "in the bottom portion , we use simplified basis functions . as we observe that the simplified basis captures the networks and provide a small error .     &",
    "@xmath103 & @xmath104 +   + 1 & 121 & 49.067 & 79.885 + 2 & 242 & 9.116 & 36.499 + 3 & 363 & 2.325 & 8.099 + 4 & 484 & 1.413 & 3.919 + 5 & 605 & 0.883 & 2.658 + 6 & 726 & 0.708 & 1.795 + 8 & 968 & 0.253 & 0.348 + 16 & 1936 & 0.095 & 0.089 +   + @xmath113 & 184 & 13.554 & 45.342 + @xmath112 & 275 & 2.651 & 11.377 + @xmath114 & 396 & 1.582 & 4.414 +   + all & 268 & 1.850 & 3.799 +",
    "in this section , we discuss a combined gmsfem and multi - continuum method .",
    "we assume that some fractures are resolved on the fine grid , while other fractures are represented using a multi - continuum approach at the fine - grid level . as a result",
    ", we deal with a system of equations with reaction tensors .",
    "we note that each continuum interacts with the resolved fractures and , also , they interact among themselves .",
    "we discuss coupled and un - coupled basis constructions .",
    "the coupled basis functions are important for some flow scenarios as we discuss .",
    "the analysis of the method is given in appendix [ appendix ] .",
    "we will consider two cases .",
    "in the first case , we simply use some values for transfer coefficients @xmath115 and in the second case , we compute these transfer coefficients from rve simulations . in both cases , we assume that each continuum is connected to the fracture . thus , the fractures are added to each continuum equation with an appropriate weight @xmath116 , which represents the amount of the fluid passed to the fracture network from the @xmath11-th continuum .",
    "we can assume @xmath117 .",
    "the resulting equations have the following variational form @xmath118 @xmath119 . here , @xmath120 is the fracture permeability that takes into account the interaction of the @xmath121-th continuum with the resolved fracture network and @xmath122 is the mass exchange term that take into account the interaction between the fracture and the @xmath121-th continuum .",
    "note that @xmath122 , @xmath120 , and @xmath123 depend on @xmath124 .",
    "this is a coupled system of differential equations with multiscale high - contrast coefficients .",
    "the coupling is done via the right hand side and , thus , multiscale basis functions can be constructed for separately for each equation using the high - contrast permeabilities or jointly .    in our numerical simulations",
    ", we will consider two approaches for constructing multiscale spaces as described in appendix [ appendix ] .",
    "in the first approach ( called un - coupled ) , multiscale basis functions will be constructed for each continuum separately by considering only the permeability @xmath12 and ignoring the transfer functions .",
    "this is the same as using single - phase flow basis functions for each continuum and follows the gmsfem approach discussed above . in the second approach ,",
    "the multiscale basis functions will be constructed by solving a coupled problem for snapshot spaces and performing a spectral decomposition as discussed in appendix [ appendix ] .",
    "the resulting gmsfem procedure is the same as the one presented in section [ sec : overview ] , except that the construction of the snapshot functions is replaced by the coupled approach discussed above .",
    "note that a different spectral problem is used for a coupled basis construction .",
    "we present numerical results .",
    "we consider the model shown in figure [ schematic ] .",
    "we consider a dual porosity system for un - resolved fractures ( @xmath125 ) and matrix flow ( @xmath126 ) .",
    "for the un - resolved fractures parameters , we set @xmath127 and @xmath128 . for the matrix parameters , we use @xmath129 and @xmath130 . using dfn ( discrete fracture network ) , we implement a resolved fracture network ( @xmath131 ) , which interacts with both the un - resolved fracture system ( @xmath132 ) and the matrix system ( @xmath133 ) . that is both matrix and un - resolved fracture system communicate with the resolved fractures .",
    "we set @xmath134 , @xmath135 . here",
    ", we use the transfer parameter @xmath136 and @xmath137 . in figure [ sol - dp ] ,",
    "we show solutions at the final time . in table",
    "[ tab : dp - cp ] , we present relative errors for gmsfem and simplified basis functions . in this table , we present the results when the basis is computed in a coupled way and separately for each continuum using the flow equation ( without transfer functions ) . from this table",
    ", we observe that the gmsfem using coupled basis functions provides better accuracy compared to that computed with un - coupled basis functions .",
    "moreover , we observe that when choosing @xmath138 basis functions per coarse node , we can obtain an excellent result using the gmsfem .",
    "we have also tested the gmsfem with simplified basis functions .",
    "the results are similar to those obtained from above .",
    "in particular , we observe a similar accuracy if we choose only basis functions corresponding to very small eigenvalues . we observe large errors if we do not choose eigenvectors corresponding to very small eigenvalues .",
    "dim(@xmath139 ) & @xmath140 & @xmath141 & @xmath142 & @xmath143 & @xmath144 +   + 6 & 1452 & 0.846 & 1.966 & 0.846 & 15.938 & 4.519 + 8 & 1936 & 0.297 & 0.379 & 0.297 & 15.835 & 4.093 + 12 & 2904 & 0.148 & 0.188 & 0.148 & 14.213 & 3.670 + 16 & 3872 & 0.106 & 0.087 & 0.106 & 11.769 & 3.041 +   + all & 536 & 2.386 & 3.831 & 2.386 & 21.765 & 6.713 +   + 6 & 1452 & 1.919 & 2.767 & 1.919 & 9.919 & 3.588 + 8 & 1936 & 1.052 & 1.154 & 1.052 & 2.840 & 1.335 + 12 & 2904 & 0.354 & 0.550 & 0.354 & 1.325 & 0.628 + 16 & 3872 & 0.124 & 0.102 & 0.124 & 0.643 & 0.194 +   + all & 830 & 2.056 & 3.439 & 2.056 & 6.234 & 3.690 +      a representative volume element can be used to compute the parameters in multi - continuum equations .",
    "we follow a known procedure ( see e.g. , @xcite ) . in this approach , we compute the transfer parameters based on rve simulations . we consider a case of two - continua at the microscale and compute the transfer function based on rve simulations . for this reason",
    ", we solve the local problem with dfn ( corresponding to ( [ harmonic_ex ] ) ) @xmath145 and impose @xmath146 at the fracture nodes .",
    "one can also use a source term in the fracture or the local eigenvalue problems see @xcite .",
    "it is assumed that zero neumann boundary conditions are imposed on the rest of the boundaries .",
    "then , the transfer coefficient is defined as @xmath147 @xmath148 will quickly reach an asymptote , which is used as a transfer coefficient .",
    "here @xmath149 is the volume average over the matrix region .",
    "we present results for a dual - continuum coupled with the gmsfem .",
    "we set @xmath150 , @xmath127 , @xmath129 , and @xmath151 , @xmath134 for the fracture . using dfn",
    ", we implement the resolved fracture network with @xmath132 in @xmath152 and @xmath133 to @xmath24 as well as @xmath137 . here",
    ", we use the transfer functions @xmath153 for @xmath154 , @xmath155 for @xmath156 , and linearize @xmath115 in between them , i.e. , @xmath157 .",
    "the values of @xmath115 are computed using local rve simulations .",
    "in particular , we set the pressure to be one and compute @xmath115 as the flux over the pressure difference in the fracture and the average pressure in the matrix ( see @xcite ) .    in figure",
    "[ sol - dpq - cp ] , we plot both the fine - scale and the coarse - scale solutions at the final time , and in table [ tab : dpq - cp ] , we report the relative errors for gmsfem and simplified basis functions . the numerical results are obtained using the parameters as follows : @xmath150 , @xmath127 , @xmath129 and @xmath151 , @xmath134 for the fracture . the resolved fracture network is implemented using dfn with @xmath132 in @xmath152 and @xmath133 to @xmath24 .",
    "in addition , we take the transfer function @xmath136 and @xmath137 . the final time solution plots are shown figure [ sol - dpq - cp ] , and the corresponding relative errors are reported in table [ tab : dpq - cp ] , where the results are shown when the basis are computed in a coupled way and separately for each continuum using flow equation ( without transfer functions ) .",
    "based on these results , we conclude that the gmsfem using coupled basis functions provides better accuracy compared to that computed with un - coupled basis functions .",
    "furthermore , we observe that when choosing @xmath138 basis functions per coarse node , we can obtain an excellent result using the gmsfem . on the other hand",
    ", we tested the performance of our method using simplified basis functions , and observed a similar accuracy .",
    "finally , we observe large errors if we do not choose eigenvectors corresponding to very small eigenvalues .",
    "dim(@xmath139 ) & @xmath140 & @xmath141 & @xmath142 & @xmath143 & @xmath144 +   + 6 & 1452 & 0.837 & 1.925 & 0.837 & 30.542 & 13.869 + 8 & 1936 & 0.293 & 0.358 & 0.293 & 26.427 & 11.912 + 12 & 2904 & 0.148 & 0.193 & 0.148 & 23.165 & 10.440 + 16 & 3872 & 0.108 & 0.089 & 0.108 & 17.945 & 8.086 +   + all & 536 & 2.343 & 3.870 & 2.343 & 36.649 & 16.872 +   + 6 & 1452 & 1.944 & 2.584 & 1.944 & 6.942 & 3.934 + 8 & 1936 & 1.070 & 1.200 & 1.070 & 2.197 & 1.452 + 12 & 2904 & 0.359 & 0.544 & 0.359 & 0.788 & 0.606 + 16 & 3872 & 0.129 & 0.105 & 0.129 & 0.375 & 0.193 +   + all & 830 & 2.105 & 3.399 & 2.105 & 4.122 &",
    "3.557 +    we remark that the rve can be used to approximate the effective properties . to show this example",
    ", we assume that in each fine - grid , the multi - continua can be resolved . in this case",
    ", we construct multiscale basis functions via local spectral decomposition in the form @xmath158 as we discussed above , this equation is a multi - continua model obtained via the gmsfem and can be related to multi - continua ( [ eq : multi_cont ] ) by constructing the basis for the corresponding continua .",
    "when using rves , the main challenge is to define @xmath159 using rve computations .",
    "this is based on a localization assumption , which we introduce next .",
    "we consider @xmath160 , which is the harmonic expansion in @xmath42 , which is defined by solving local problems in each @xmath79 .",
    "we can use @xmath161 to approximate the elements of the stiffness matrix .",
    "our localization assumption uses the local snapshots computed in the rve for each @xmath62 , which we denote by rve@xmath162 .",
    "we denote these rve snapshots by @xmath163 .",
    "then , we propose the following localization assumption @xmath164      in this section , we add a case study for our method .",
    "we follow the example considered in @xcite , where a shale gas transport with dual - continuum ( organic and inorganic pores ) ( see also @xcite ) is studied . in inorganic matter",
    ", we have @xmath165 where @xmath166 is the inorganic porosity , @xmath167 is the tortuosity corrected coefficient of diffusive molecular transport in the inorganic matrix , @xmath12 is the inorganic matrix absolute permeability , @xmath168 is the dynamic gas viscosity , @xmath169 is the inorganic matrix pressure , @xmath170 and @xmath171 is the transfer function .    here",
    ", we use the following transfer function @xmath172 where @xmath173 is a shape factor .    for free and adsorbed gas in the kerogen ( @xmath174 and @xmath175 ) @xmath176 where @xmath177 is the kerogen porosity",
    ", @xmath178 is the tortuosity corrected coefficient of diffusive molecular transport for the free gas in kerogen , @xmath179 is the coefficient of diffusive molecular transport for the adsorbed gas in kerogen , @xmath180 is the kerogen permeability , and @xmath181 is the kerogen pressure .",
    "for @xmath175 we use linear henry s isotherm @xmath182 , @xmath183 .    for free - gas in fracture network , we have @xmath184 where @xmath185 is the fracture porosity",
    ", @xmath186 is the diffusion coefficient , @xmath187 is the fracture absolute permeability , and @xmath188 is the fracture pressure .",
    "we consider the model geometry with discrete fracture distribution as shown in figure [ dp - sh - mesh ] .",
    "the coarse grid is uniform and contains @xmath189 vertices and @xmath190 coarse cells .",
    "the domain @xmath6 has a length of 50 meters in both directions .",
    "the other model parameters used are as follows .",
    "@xmath191[j/(k @xmath192 mol ) ] , @xmath193[k ] , @xmath194 , @xmath195[pa ] , @xmath196[pa ] , @xmath197[pa ] , @xmath198[mol / m@xmath199 , @xmath200[mol / m@xmath199 , @xmath201 , @xmath202 , @xmath203 @xmath204[m@xmath205 , @xmath206[m@xmath205 , @xmath207[m@xmath205 , @xmath208[m@xmath205 , @xmath209[m@xmath210/s ] , @xmath211 , @xmath212[pa @xmath192 s ] . for transfer functions , we set @xmath213 [ 1/m@xmath205 .",
    "as we remarked , the purpose of this example is to show the geo - application of our approach . in figure [ sol - dp - sh ]",
    ", we depict the solutions at the final time @xmath214 days .",
    "we observe that the gmsfem with simplified basis functions provides a good agreement . in this case , we have observed less than @xmath215% in @xmath216 norm .",
    "in this paper , our goals are : ( 1 ) to investigate the gmsfem for fractured media ; ( 2 ) to study the relation between the gmsfem and the multi - continuum approaches ; ( 3 ) to develop a coupled gmsfem and multi - continuum approaches for highly heterogeneous fractured media .",
    "first , we show that gmsfem basis functions represent each continuum and these multiscale basis functions correspond to the eigenvectors associated with very small eigenvalues .",
    "we propose simplified basis functions when fracture geometries are simple .",
    "multiscale basis functions contain the spatial information representing the interaction between the matrix and the fractures .",
    "numerical results show that the gmsfem can provide an accurate solution if we include multiscale basis functions corresponding to very small eigenvalues .",
    "the latter represents the number of the continua in each coarse block . in the second part of the paper , we develop a coupled gmsfem and multi - continuum approaches . in this case , fractures at the fine - subgrid are represented by a multi - continuum approach . as a result , the gmsfem is needed for a system of equations . in this case",
    ", we use un - coupled and coupled basis functions . in the latter ,",
    "the multiscale basis functions are constructed for subgrid multi - continuum media in a coupled fashion .",
    "we present numerical results , where we compute the parameters of the multi - continua from a subgrid problem .",
    "our numerical results show that the gmsfem is able to give solutions with good accuracy .",
    "the accuracy is better when using coupled basis functions .",
    "in this appendix , we present the convergence analysis of our schemes",
    ". we will consider both the un - coupled multiscale basis functions and the coupled multiscale basis functions as well as an abstract formulation to be defined in the following .",
    "note that the abstract formulation can be applied to the practical cases presented in this paper .",
    "we consider the @xmath18-continuum problem : find @xmath217 such that @xmath218 , @xmath219 , and @xmath220 for all test functions @xmath221 with @xmath222 , where @xmath223 note that all the summations are summing over all continua , that is , they are summing over @xmath224 .",
    "next we define two global bilinear operators @xmath225 and @xmath226 by @xmath227 clearly , we have @xmath228 and @xmath229 for all @xmath230^{n}$ ] . equation ( [ eq : ref ] ) defines our multi - continuum problem .",
    "we next define the operator @xmath231 by @xmath232 for all @xmath233 .",
    "this operator corresponds to the contribution of @xmath234 in the coarse region @xmath235 .",
    "we also define the corresponding global operator @xmath236      in the following , we will present the definitions of the un - coupled multiscale basis functions and the coupled multiscale basis functions . for each case , we follow the general procedure to first construct a local snapshot space for each coarse region @xmath235 , and then construct an offline space ( consisting of multiscale basis functions ) using a suitable spectral problem defined on the snapshot space . note that the snapshot functions and the basis functions are independent of time .      for each coarse region @xmath240 , we obtain the @xmath241-th snapshot function by solving the following local problem : find @xmath242^{n}$ ] such that @xmath243^{n } , \\\\",
    "\\text{with the boundary condition}\\quad \\psi_{k}^{(j),\\text{snap } } & = \\delta_{k } , \\quad \\text{on } \\partial\\omega_j,\\end{aligned}\\ ] ] where @xmath244 is a fine - scale space and @xmath245 is the subspace of @xmath244 containing functions with zero trace on the boundary of @xmath235 . in the above definition ,",
    "the discrete delta function @xmath246 is defined as @xmath247 and each @xmath248 is the discrete delta function such that @xmath249 at the fine - grid node @xmath250 and @xmath251 at all other fine - grid nodes on @xmath252 . using the above snapshot functions , we can define the local snapshot space by @xmath253      we will construct the offline space in this section .",
    "the offline space is spanned by all multiscale basis functions . to find the multiscale basis functions , we use a local spectral problem defined in the snapshot space .",
    "more precisely , for each coarse region @xmath240 , we consider the following local eigenvalue problem : find the @xmath241-th eigenfunction @xmath254 and the @xmath241-th eigenvalue @xmath255 such that @xmath256 where the bilinear form @xmath257 is defined as @xmath258 and the eigenvalues are arranged in ascending order .",
    "using the eigenfunction @xmath259 , we can define the @xmath241-th multiscale basis function by @xmath260 , where @xmath261 is a set of partition of unity functions for the coarse - grid partition of the domain @xmath262 .",
    "finally , the local offline space is defined by @xmath263 , which is formed by using the first @xmath264 eigenfunctions .",
    "in addition , the global offline space , @xmath265 , is defined by @xmath266 .",
    "now , we will present the construction of the basis for the un - coupled case .",
    "we first consider the construction of the snapshot space .",
    "for each coarse region @xmath240 and for each continuum @xmath11 , we obtain the @xmath241-th snapshot function by solving the problem : find @xmath267 such that @xmath268 then , the local snapshot space for the coarse region @xmath235 and for the @xmath11-th continuum is defined by @xmath269      we will construct multiscale basis functions for each coarse region @xmath235 and for each continuum @xmath11 .",
    "to do so , we consider the following local eigenvalue problem : find the @xmath241-th eigenfunction @xmath270 and the @xmath241-th eigenvalue @xmath271 such that @xmath272 where @xmath273 we assume that the eigenvalues are arranged in ascending order . using the above eigenfunctions , we can define the @xmath241-th multiscale basis function by @xmath274 . to define the offline space for the @xmath11-th continuum and for the coarse region @xmath235 , we take the first @xmath264 eigenfunctions and define @xmath275 . note that @xmath264 can depend on @xmath11 , but we omit this index to simplify the notation . then the global offline space for the @xmath11-th continuum",
    "is given by @xmath276 . finally ,",
    "the offline space , @xmath265 , is defined by @xmath277 .",
    "now we are ready to present the analysis .",
    "we will first prove the following best approximation estimates ( see lemma [ lem : best ] and lemma [ lem : best2 ] ) .",
    "we will compare the difference between the reference solution @xmath2 , defined by ( [ eq : ref ] ) , and the multiscale solution @xmath278 defined by @xmath279 we also define the following norms @xmath280      we write @xmath283 , where @xmath284 is the component for the @xmath11-th continuum . using ( [ eq : ref ] ) and ( [ eq : ms ] ) , we have @xmath285 let @xmath286 and @xmath287 in the above equation , we obtain @xmath288 therefore , integrating the above in time , we obtain ( [ lem : best1 ] ) .",
    "we will use the above two lemmas to prove the convergence of our scheme .",
    "in particular , we need to find a suitable function @xmath286 and estimate the difference @xmath295 in various norms .",
    "the following is our strategy .",
    "we define the snapshot projection @xmath296 by @xmath297 where @xmath298 is the snapshot space obtained by collecting all snapshot functions .",
    "we note that , since the snapshot functions for each coarse region @xmath235 take all possible values on @xmath252 , the problem in ( [ eq : ms1 ] ) is well - defined . since @xmath299 , it suffices to estimates the two terms @xmath300 and @xmath301 .",
    "note that the term @xmath301 corresponds to an irreducible error of our scheme , since this error can not be improved by using our scheme .",
    "we assume that this irreducible error is small by using a large set of snapshot functions .",
    "based on this argument , it suffices to estimate @xmath300 by choosing an appropriate function @xmath286 .",
    "note that @xmath302 is in the snapshot space , which means that we can represent @xmath2 as a linear combination of all multiscale basis functions . to define @xmath286",
    ", we will take @xmath303 as the projection of @xmath302 in the offline space .",
    "more precisely , we use the following construction . first ,",
    "for the case of un - coupled basis functions , we can represent @xmath304 then the projection @xmath303 of @xmath2 in the offline space is defined as @xmath305 second , for the case of coupled basis functions , we can represent @xmath306 then the projection @xmath303 of @xmath302 in the offline space is defined as @xmath307    next , we will state and prove the main results ( theorem [ thm1 ] and theorem [ thm2 ] ) of this appendix .",
    "as we will see , theorem [ thm1 ] and theorem [ thm2 ] follow from lemmas [ lemma1 ] , [ lemma2 ] , and [ lemma3 ] .",
    "[ thm1 ] for the un - coupled gmsfem , let @xmath2 and @xmath302 be the reference solution and snapshot projection in ( [ eq : ref ] ) and ( [ eq : ms ] ) and let @xmath308 be the projection of @xmath302 defined in ( [ eq : off1 ] ) .",
    "we assume ( [ eq : assume ] )",
    ". then we have @xmath309 where @xmath310 .    [ thm2 ] for the coupled gmsfem , let @xmath2 and @xmath302 be the reference solution and snapshot projection in ( [ eq : ref ] ) and ( [ eq : ms ] ) and let @xmath308 be the projection of @xmath302 defined in ( [ eq : off2 ] ) .",
    "then we have @xmath311 where @xmath312 .",
    "we will proof the above two theorems by estimating @xmath313 , @xmath314 , @xmath315 , and @xmath316 separately in the following lemmas . unless otherwise specified , the constant @xmath317 is independent of any scales and continuum .",
    "[ lemma1 ] let @xmath2 , @xmath302 , and @xmath303 be defined as in theorems [ thm1 ] and [ thm2 ] . for the un - coupled basis functions , we have @xmath318 for the coupled basis functions , we have @xmath319 where @xmath320",
    ".    we will present the proof for the case of un - coupled basis functions . first , note that @xmath321 with @xmath322 where @xmath323 is the number of coarse neighborhoods intersecting with @xmath79 . by using the orthogonality of eigenfunctions ,",
    "we have @xmath324 since @xmath325 is the @xmath326-harmonic expansion of @xmath29 in @xmath235 , we have @xmath327 and similarly @xmath328 therefore , by summing over all @xmath329 , we obtain @xmath330          [ lemma0 ] for the case of coupled basis functions , if @xmath2 satisfies @xmath339^{n},\\ ] ] then we have @xmath340+\\sum_l \\int_{d_{f , l}\\cap \\omega_j}\\kappa_{l , i}|\\nabla_{f}\\chi_{j}|^{2}u^{2 }   \\ , { dx } \\big).\\end{aligned}\\ ] ] for the case of un - coupled basis functions , if @xmath2 satisfies @xmath341 then we have @xmath342    for the case of coupled basis functions , we take @xmath343 and obtain @xmath344 this implies @xmath345 this completes the proof for the case of coupled basis functions . for the case of un - coupled basis functions ,",
    "the proof is similar and is therefore omitted .",
    "[ lemma2 ] let @xmath2 , @xmath302 and @xmath303 be defined as in theorem [ thm1 ] and [ thm2 ] .",
    "for the case of un - coupled basis functions , we have @xmath346 for the case of coupled basis functions , we have @xmath347 where @xmath348 and @xmath349 are defined in theorem [ thm1 ] and [ thm2 ] .      for the case of coupled basis functions , using lemma [ lemma0 ] , we obtain @xmath354 therefore , we have @xmath355 for the case of un - coupled basis functions , using lemma [ lemma0 ] again , we obtain @xmath356 therefore , we have @xmath357 finally , by the definition of the eigen - projection , for the case of coupled basis functions , we have @xmath358 and , for the case of un - coupled basis functions , we have @xmath359 this completes the proof .",
    "[ lemma3 ] let @xmath2 , @xmath302 , and @xmath303 be defined as in theorem [ thm1 ] and [ thm2 ] . for the case of un - coupled basis functions , we have @xmath360 for the case of coupled basis functions , we have @xmath361        , _ multiscale model reduction for shale gas transport in a coupled discrete fracture and dual - continuum media _ , journal of natural gas science and engineering , ( 2016 ) .",
    "submitted for special issue `` multiscale and multiphysics techniques and their applications in unconventional gas reservoirs '' .",
    ", _ finite element - node - centered finite - volume two - phase - flow experiments with fractured rock represented by unstructured hybrid - element meshes _ , spe reservoir evaluation & engineering , 10 ( 2007 ) , pp ."
  ],
  "abstract_text": [
    "<S> simulating complex processes in fractured media requires some type of model reduction . </S>",
    "<S> well - known approaches include multi - continuum techniques , which have been commonly used in approximating subgrid effects for flow and transport in fractured media . </S>",
    "<S> our goal in this paper is to ( 1 ) show a relation between multi - continuum approaches and generalized multiscale finite element method ( gmsfem ) and ( 2 ) to discuss coupling these approaches for solving problems in complex multiscale fractured media . </S>",
    "<S> the gmsfem , a systematic approach , constructs multiscale basis functions via local spectral decomposition in pre - computed snapshot spaces . </S>",
    "<S> we show that gmsfem can automatically identify separate fracture networks via local spectral problems . </S>",
    "<S> we discuss the relation between these basis functions and continuums in multi - continuum methods . </S>",
    "<S> the gmsfem can automatically detect each continuum and represent the interaction between the continuum and its surrounding ( matrix ) . for problems with simplified fracture networks , </S>",
    "<S> we propose a simplified basis construction with the gmsfem . </S>",
    "<S> this simplified approach is effective when the fracture networks are known and have simplified geometries . </S>",
    "<S> we show that this approach can achieve a similar result compared to the results using the gmsfem with spectral basis functions . </S>",
    "<S> further , we discuss the coupling between the gmsfem and multi - continuum approaches . in this case , many fractures are resolved while for unresolved fractures , we use a multi - continuum approach with local representative volume element ( rve ) information . as a result , </S>",
    "<S> the method deals with a system of equations on a coarse grid , where each equation represents one of the continua on the fine grid . </S>",
    "<S> we present various basis construction mechanisms and numerical results </S>",
    "<S> . the gmsfem framework , in addition , can provide adaptive and online basis functions to improve the accuracy of coarse - grid simulations . </S>",
    "<S> these are discussed in the paper . </S>",
    "<S> in addition , we present an example of the application of our approach to shale gas transport in fractured media . </S>"
  ]
}