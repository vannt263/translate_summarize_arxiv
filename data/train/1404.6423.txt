{
  "article_text": [
    "[ sintro ]    genome - wide association studies ( gwas ) constitute a popular approach for investigating the association of common single nucleotide polymorphisms ( snps ) with complex diseases .",
    "usually , a large number of snp are tested across the genome . great interest lies in improving power of testing snp effects by borrowing additional biological information .",
    "indeed , a major criticism of genetic association studies lies in its agnostic style [ @xcite ] : none of the biological knowledge was encoded in the standard genetic association analyses . to overcome such limitations ,",
    "multi - marker analysis has been advocated to integrate biological information into statistical analyses and to decrease the number of tests [ @xcite ; @xcite ] .",
    "analysis using snp - sets grouped by physical locations has better performance than the standard single snp analysis in reanalyzing the breast cancer gwas data [ @xcite ] .",
    "snps can also be grouped into a snp - set according to biological pathways , in which a gene harmonizes with other genes to exert biological functions .",
    "the two factors we try to bridge in genetic association studies are snps and disease risk . despite the success of snp - set analyses in assembling multiple snps based on biological information ,",
    "mechanistic pathways between snps ( snp - sets ) and disease are still neglected .",
    "given the availability of multiple sources in genomic data ( e.g. , gene expression and snps ) [ @xcite ; @xcite ] , it is desirable to perform joint analysis by integrating multiple sources of genomic data .",
    "here we combine the information of snps and gene expression by introducing gene expression as a mediator in the causal pathway from snps to disease .",
    "_ biologically _ , gene expression can be determined by the dna genotype [ @xcite ; @xcite ; @xcite ] and that gene expression can also affect disease risk [ @xcite ] .",
    "moreover , results from the snp - set analysis augmented by a biological model can be more scientifically meaningful .",
    "_ statistically _ , gene expression can help explain variability of the effect of snps on disease when there exists an effect of snps on disease via gene expression and thus increases the power of detecting the overall effect of snps on disease risk .",
    "snps that regulate mrna expression of a gene are so - called expression quantitative trait loci ( eqtl ) [ @xcite ] . statistically , eqtl snps can be viewed as the snps that are correlated with mrna expression of a gene .",
    "_ cis_-eqtl snps are the snps that are within or around the corresponding gene , and _",
    "trans_-eqtl snps are those that are far away or even on different chromosomes .",
    "numerous genome - wide eqtl analyses have been reported to comprehensively capture such a dna  rna ( i.e. , snps - gene expression ) association in the genome in different tissues and organisms [ @xcite ; @xcite ; @xcite ] .",
    "eqtl results can be external information to prioritize the discovery of susceptibility loci in genome - wide association studies [ @xcite ; @xcite ; @xcite ] .",
    "methods are available to integrate multiple genomic data to draw causal inference on a biological network [ @xcite ; @xcite ; @xcite ; @xcite ] .",
    "we focus in this paper on _ joint analysis _ of multiple eqtl snps of a gene and their corresponding mrna expression for their effects on disease phenotypes .",
    "compared with multi - snp analyses , this approach further incorporates eqtls into genetic association studies and accounts for a biological process ( from dna to rna ) within a gene to improve power .",
    "this paper is motivated by an asthma genome - wide association study of subjects of british descent ( mrc - a ) , in which the association between snps at the gene and the risk of childhood asthma was investigated [ @xcite ; @xcite ] .",
    "the mrc - a data set consists of 108 cases and 50 controls with both snp genotype ( illumina 300k ) and gene expression ( affymetrix hu133a 2.0 ) data available .",
    "the original genome - wide study reported that the 10 typed snps on chromosome 17q21 where _",
    "ormdl3 _ is located were strongly associated with childhood asthma in mrc - a data , and the results were validated in several other independent studies .",
    "the authors also found that each of these 10 snps was highly correlated with gene expression of _",
    "ormdl3 _ , which is also associated with asthma .",
    "the 10 snps , _",
    "ormdl3 _ expression and asthma status can be illustrated as the @xmath1 , @xmath2 and @xmath3 , respectively , in figure  [ fig1 ] .",
    "instead of analyzing snp - expression , expression - asthma and snp - asthma associations separately and univariately , here we are interested in assessing the overall genetic effect of _ ormdl3 _ on the occurrence of childhood asthma , by jointly analyzing snp and gene expression data and accounting for the possibility that the _ ormdl3 _ gene expression might be a causal mediator for the association of the snps in the _ ormdl3 _ gene and asthma risk .",
    "our ultimate goal is to integrate multiple sources of genomic data for genetic association analyses .",
    "is a set of correlated exposures , for example , snp set ; @xmath2 is a mediator , for example , gene expression ; @xmath3 is an outcome , for example , disease ( yes / no ) ; and @xmath4 are covariates , including the true and potential confounders . ]    in this paper we propose to jointly model a set of snps within a gene , a gene expression and disease status , where a logistic model is used to model the dependence of disease status on the snp - set and the gene expression , and a linear model is used for the dependence of the gene expression on the snp - set , both adjusting for covariates .",
    "we are primarily interested in testing whether a gene , whose effects are captured by snps and/or gene expression , is associated with a disease phenotype .",
    "we formulate this hypothesis in the causal mediation analysis framework [ @xcite ; @xcite ( @xcite ) ; @xcite ] .",
    "note that the previous work on causal mediation analysis is mostly focused on estimation .",
    "we use the joint model to derive the direct and indirect effects of a snp - set mediated through gene expression on disease risk . for eqtl snps ,",
    "we show that the total effect of a gene on a disease captured by a set of snps and a gene expression corresponds to the total effects of the snp - set , which are the combined direct effects and indirect effects of the snps mediated through the gene expression , on a disease .",
    "this framework allows us to study how the use of gene expression data can enhance power to test for the total effect of a snp - set on disease risk .",
    "we study the impact of model misspecification using the conventional snp - only models when the true model is that both the snps and the gene expression affect the disease outcome . for non - eqtl snps",
    ", the null hypothesis simply corresponds to the joint effects of the snps and the gene expression .",
    "due to a potentially large number of snps within a gene and some of them possibly being highly correlated , that is , in high linkage disequilibrium ( ld ) , conventional tests , such as the likelihood ratio test , for the total effects of multiple snps and a gene expression , do not perform well .",
    "we propose in this paper a  variance component test to assess the overall effects of a snp set and a gene expression on disease risk , under the null that the test statistic follows a mixture of @xmath0 distributions , which can be approximated analytically or empirically using a resampling - based perturbation procedure [ @xcite ; @xcite ] .",
    "as the true disease model is often unknown , we construct an omnibus test to improve the power by accommodating different underlying disease models .",
    "the rest of the paper is organized as follows . in section  [ sec2 ]",
    "we introduce the joint model for snps , a gene expression and disease as well as the null hypothesis of no joint effect of the snps and the gene expression on a disease phenotype . in section  [ sec3 ]",
    "we propose a variance component score test for the total effect of snps and gene expression , and construct an omnibus test to maximize the test power across different underlying disease models . in section  [ sec4 ]",
    "we interpret the null hypothesis and study the assumptions within the framework of causal mediation modeling for eqtl snps and non - eqtl snps . in section  [ sec5 ]",
    "we evaluate the finite sample performance of the proposed test using simulation studies and show that the omnibus test is robust and performs well in different situations .",
    "in section  [ sec6 ] we apply the proposed method to study the overall effect of the _ ormdl3 _ gene contributed by both the snps and the gene expression on the risk of childhood asthma , followed by discussions in section  [ sec7 ] .",
    "[ smodel ]    the statistical problem is to jointly model the effect of a set of snps and a gene expression on the occurrence of a  disease .",
    "assume for subject @xmath5 ( @xmath6 ) an outcome of interest @xmath7 is dichotomous ( e.g. , case / control ) , whose mean is associated with @xmath8 covariates ( @xmath9 , with the first covariate to be 1 , i.e. , the intercept ) , @xmath10 snps in a snp - set ( @xmath11 ) , mrna expression of a gene ( @xmath12 ) and possibly the interactions between the snps and the gene expression as @xmath13 where @xmath14 , and @xmath15 are the regression coefficients for the covariates , the snps , the gene expression , and the interactions of the snps and the gene expression , respectively .",
    "a snp - set and gene expression pair can be defined in multiple ways .",
    "for example , @xmath16 can be the snps in a gene and @xmath2 is the mrna expression of the gene . in the asthma data example , @xmath16 are the 10 typed snps around _ ormdl3 _ and @xmath2 is the expression of _",
    "ormdl3_. alternatively , one can choose the snp - set / expression pair based on the eqtl study : eqtl snp - set / corresponding gene expression .    as snps can affect gene expression",
    "[ @xcite ; @xcite ; @xcite ] , for each subject @xmath5 , we next consider a linear model for the continuous gene expression @xmath12 ( i.e. , the mediator ) , which depends on the @xmath8 covariates ( @xmath9 ) and the @xmath10 snps ( @xmath11 ) : @xmath17 where @xmath18 and @xmath19 are the regression coefficients for the covariates and the snps , respectively , and @xmath20 follows a normal distribution with mean @xmath21 and variance @xmath22 . again",
    ", the @xmath10 snps can be the snps within a gene or the eqtl snps corresponding to a gene for which the expression level is measured .",
    "our goal is to test for the total effect of a gene captured by the snps in a set @xmath16 and a gene expression @xmath2 on @xmath3 , which can be written using the regression coefficients in model ( [ ymodel ] ) as @xmath23 note that the null hypothesis ( [ null ] ) only involves the parameters in the @xmath24 $ ] model ( [ ymodel ] ) .",
    "we use the @xmath25 $ ] model in section  [ sinterpret ] to facilitate interpretation of the null hypothesis ( [ null ] ) and to study the assumptions within the causal mediation analysis framework . throughout the paper",
    ", we term this null hypothesis as a test for the _ total effect of a gene_. later , in section  [ sinterpret ] we will show that it corresponds to the _ total effect of snps _ for eqtl snps and simply to the joint effect of snps and expression for non - eqtl snps .",
    "[ stest ]      [ ssvct ]    we propose in this section to test for the null hypothesis of no total effect of a gene ( [ null ] ) under model ( [ ymodel ] ) . as",
    "the number of snps ( @xmath10 ) in a gene might be large and some might be highly correlated ( due to linkage disequilibrium ) , the likelihood ratio test ( lrt ) or multivariate wald test for the null hypothesis ( [ null ] ) uses a large degree of freedom ( df ) and has limited power . to overcome this problem , we assume under model ( [ ymodel ] ) the regression coefficients of the individual main snp effects @xmath26 are independent and follow an arbitrary distribution with mean 0 and variance @xmath27 , and the snp - by - expression interaction coefficients @xmath28 ( @xmath29 ) are independent and follow another arbitrary distribution with mean 0 and variance @xmath30 .",
    "the resulting outcome model ( [ ymodel ] ) hence becomes a logistic mixed model .",
    "the problem for testing the null hypothesis ( [ null ] ) becomes a joint test of variance components ( @xmath31 ) and the scalar regression coefficient for the fixed gene expression effect ( @xmath32 ) in the induced logistic mixed models as @xmath33 and @xmath32 .",
    "one can easily show that the scores for @xmath27 , @xmath34 and @xmath30 under the induced logistic mixed models are @xmath35 where @xmath36 , @xmath37 , @xmath38 , @xmath39 and @xmath40 ; @xmath41 and @xmath42 is the mean of @xmath7 under @xmath43 , and @xmath44 is the maximum likelihood estimator of @xmath45 under the null model@xmath46    to combine the three scores to test for the null hypothesis @xmath47 and @xmath32 , one may consider the conventional score statistic @xmath48 , where @xmath49 and @xmath50 is the efficient information matrix of @xmath51 .",
    "however , this approach has several major limitations .",
    "first , notice that the score of the regression coefficient of gene expression @xmath52 is a linear function of @xmath3 , while the scores of the variance components of main effects of snps and snp - by - expression interactions @xmath27 and @xmath30 are quadratic functions of @xmath3 .",
    "hence , @xmath52 has a different scale from @xmath53 .",
    "it follows that @xmath53 are likely to dominate @xmath52 .",
    "a  combination of the three scores using @xmath54 is hence not desirable .",
    "second , @xmath54 involves quartic functions of @xmath55 and the information matrix @xmath50 involves the 8th moment of @xmath55 .",
    "hence , calculations of @xmath54 are not stable , and it is difficult to analytically approximate the null distribution of @xmath54 .",
    "we hence propose the following weighted sum of three scores as the test statistic for the null hypothesis ( [ null ] ) : @xmath56\\\\[-8pt ] & = & n^{-1}({\\mathbf{y}}-\\bmuhat_0)^t \\bigl(a_1\\mathbb{ss}^t+a_2 { \\mathbf{gg}}^t+a_3\\mathbb{cc}^t\\bigr ) ( { \\mathbf{y}}- \\bmuhat_0),\\nonumber\\end{aligned}\\ ] ] where @xmath57 are some weights .",
    "@xmath58 is a nice quadratic function of @xmath59 .",
    "hence , its null distribution can be easily approximated by a mixture of @xmath0 distributions .",
    "different weights can be chosen . with an equal weight @xmath60",
    ", @xmath58 is equivalent to the variance component test for @xmath61 by assuming @xmath62 , @xmath34 and @xmath63 follow a common distribution with mean zero and variance @xmath61 .",
    "however , this common distribution assumption is strong , as @xmath16 , @xmath2 and @xmath64 generally have different scales and so do their effects @xmath65 , @xmath34 and @xmath63 .",
    "notice that @xmath66 are all quadratic functions of @xmath59 in similar forms ; we propose to weight each term @xmath66 using the inverse of the square root of their corresponding variances .",
    "this allows each weighted term to have variance 1 and be comparable .",
    "specifically , the variances for @xmath66 are @xmath67 , @xmath68 , @xmath69 , respectively , where @xmath70 denotes the component - wise multiplication of conformable matrices @xmath71 and @xmath72 , @xmath73 denotes a vector of ones , the diagonal and off - diagonal elements of @xmath74 are @xmath75 and @xmath76[\\hat\\mu_{0i'}(1-\\hat\\mu _ { 0i'})]$ ] , respectively [ @xcite ] .",
    "we derive the asymptotic distribution of @xmath58 under the null hypothesis ( [ null ] ) by accounting @xmath77 is a function of @xmath78 , which is the maximum likelihood estimate of @xmath79 under the null model ( [ nullmodel ] ) .",
    "define @xmath80 = n^{-1 } { \\mathbf{u}}^t{\\mathbf{w}}{\\mathbf{u}},\\ ] ] where @xmath81 , @xmath82 , @xmath83 , @xmath84 .",
    "we show in section  3 of the supplementary material [ @xcite ] that under the null hypothesis ( [ null ] ) , the score test statistic @xmath58 converges in distribution to @xmath85 , where @xmath86 is a random vector following @xmath87 , @xmath88 ) and @xmath89 is the @xmath90th row of @xmath91 $ ] .",
    "this means under the null hypothesis @xmath58 follows a  mixture of @xmath0 distributions , which can be approximated using a scaled @xmath0 distribution by matching the first two moments [ @xcite ] as @xmath92 , where @xmath93 $ ] and @xmath94 ^ 2/\\operatorname{var}(q)$ ] , and the expressions of @xmath95 and @xmath96 are given in section  3 of the supplementary material [ @xcite ] .",
    "alternatively , one can approximate the mixture of @xmath0 distribution using the characteristic function inversion method [ @xcite ] .",
    "[ somnibus ]    so far we derive the test statistic @xmath58 under the outcome model specified in ( [ ymodel ] ) , which assumes the disease risk of @xmath3 depends on snps , gene expression and their interactions .",
    "denote this @xmath58 by @xmath97 .",
    "suppose that the disease risk of @xmath3 depends on snps and gene expression but not their interactions , or even depends only on snps , then it is more powerful to test for the total snp effect using the test statistics @xmath98 and @xmath99 , respectively . under these simpler disease models ,",
    "the test statistic @xmath97 loses power as it tests for extra unnecessary parameters . on the other hand ,",
    "if the disease risk indeed depends on snps , expression and their interactions , performing tests only using snps @xmath100 or main effects @xmath101 will lose power , compared to @xmath97 .",
    "since in reality we do not know the underlying true disease model , it is difficult to choose a correct model .",
    "it is hence desirable to develop a test that can accommodate different disease models to maximize the power .",
    "moreover , in a genome - wide association study , it is almost impossible that one disease model is true for tens of thousands of genes .",
    "thus , we further propose an omnibus test where we identify the strongest evidence among the three different models with : ( 1 ) only snps , ( 2 )  snps and gene expression , and ( 3 ) snps , gene expression and their interactions .",
    "specifically , we calculate the @xmath10-value under each of the three models , then compute the minimum of the three @xmath10-values and compare the observed minimum @xmath10-value to its null distribution . because of the complicated correlation among @xmath97 , @xmath101 and @xmath100 , it is difficult to analytically derive the null distribution of the minimum @xmath10-value . to this end , we resort to a resampling perturbation procedure .    as shown in section  [ ssvct ] , @xmath58 converges in distribution to @xmath85 .",
    "the empirical distribution of @xmath102 can be estimated using the resampling method via perturbation [ @xcite ; @xcite ] .",
    "the perturbation method approximates the target distribution of @xmath58 by generating random variables @xmath103 from the estimated asymptotic distribution of @xmath86 .",
    "this perturbation procedure is also called the score - based wild bootstrap [ @xcite ] .",
    "specifically , set @xmath104 , where @xmath105 s are independent @xmath106 . by generating independent @xmath107 repeatedly",
    ", the distribution of @xmath103 conditional on the observed data is asymptotically the same as that of  @xmath86 .",
    "denoted by @xmath108 , where @xmath109 is the number of perturbations , it follows that the empirical distribution of the @xmath110 is the same as that of @xmath102 asymptotically .",
    "the @xmath10-value can be approximated using the tail probability by comparing @xmath111 with the observed @xmath58 .",
    "hence , one can calculate the @xmath10-values of @xmath97 , @xmath101 and @xmath112 by setting @xmath113 , @xmath114 and @xmath115 and generate their perturbed realizations of the null counterpart as @xmath116 , @xmath117 and @xmath118 , and compare them with corresponding observed values , respectively .",
    "note that for each perturbation @xmath119 , the random normal perturbation variable @xmath120 is the same across the three tests such that the correlation among @xmath97 , @xmath101 and @xmath100 can be preserved .",
    "the @xmath10-value of the omnibus test can be easily calculated using the perturbation method .",
    "let @xmath121 , @xmath122 and @xmath123 be the three @xmath10-values using the three statistics , where @xmath124 , @xmath125 and @xmath126 .",
    "the null distribution of the minimum @xmath10-value , @xmath127 , can be approximated by @xmath128 , @xmath129 ( @xmath130 . the @xmath10-value of the omnibus test hence can be calculated by comparing the observed minimum @xmath10-value @xmath131 with its empirical null distribution @xmath132 .",
    "note that different from permutation where the observed data are shuffled and resampled to calculate the test statistic @xmath58 , the perturbation procedure resamples from the asymptotic null distribution of @xmath58 without recalculating @xmath58 using the shuffled data .",
    "thus , it is much more efficient than the permutation method .",
    "using a   cpu ( 2.53 ghz ) to run 100 genes ( each with 10 snps ) and 100  cases/100 controls , the computation time is 134.10 and 809.76 seconds for the perturbation and permutation methods ( both with 200 resampling ) , respectively .",
    "furthermore , covariates can be easily adjusted using the perturbation method , but adjustment is more difficult using permutation .",
    "specifically , the permutation - based @xmath10-values calculated by simply permuting snps and gene expression fail if snps / gene expression are correlated with covariates .",
    "[ sinterpret ]      [ scmm ]    to understand the null hypothesis of no total effect of a gene captured by snps in a gene and a gene expression and the underlying assumptions , we discuss in this section how to interpret the null in  ( [ null ] ) within the causal mediation analysis framework .",
    "causal interpretation can be helpful for understanding genetic etiology of diseases as well as for applications in pharmaceutical research [ @xcite ] .",
    "although genotype is essentially fixed at , it is at that time effectively randomized , conditional on parental genotypes , and could be viewed as subject to have hypothetical intervention .",
    "the statistical problem of jointly modeling a set of snps , a gene expression and a  disease can be presented as a causal diagram [ @xcite ; @xcite ] in  [ fig1 ] and be framed using a causal mediation model [ @xcite ( @xcite ) ; @xcite ] based on counterfactuals [ @xcite ( @xcite ) ] .",
    "@xcite and @xcite have used the causal mediation analysis for epidemiological and social science studies , respectively , where the exposure of interest is univariate .",
    "one can decompose the _ total effect _ ( te ) of snps into the _ direct effect _ ( de ) and the _ indirect effect _ ( ie ) .",
    "the _ direct effect _ of snps is the effect of the snps on the disease outcome that is not through gene expression , whereas the _ indirect effect _ of the snps is the effect of the snps on the disease outcome that is through the gene expression . within the causal mediation analysis framework",
    ", we derive in the supplementary material the te , de and ie of the snps on the disease outcome [ @xcite ] .",
    "specifically , we define the total effect ( te ) of snps as @xmath133 that is , the equation ( [ ymodel ] ) marginalizes over gene expression @xmath2 . in section  1 of the supplementary material [ @xcite ] , we show that for rare diseases , the total effect of the snps on the log odds ratio ( or ) of disease risk can be expressed in terms of the regression coefficients in models ( [ ymodel ] ) and ( [ gmodel ] ) and is approximately equal to @xmath134\\\\[-8pt ] & & { } + \\tfrac{1}{2}\\sigma_g^2({\\mathbf{s}}_1 + { \\mathbf{s}}_0)^t{\\bolds{\\gamma}}({\\mathbf{s}}_1-{\\mathbf{s}}_0)^t{\\bolds{\\gamma}}.\\nonumber\\end{aligned}\\ ] ]    we can express the de and ie of the snps on the log odds ratio of disease risk in terms of the regression coefficients in models ( [ ymodel ] ) and ( [ gmodel ] ) . for rare diseases , they are , respectively , approximately equal to @xmath135 \\nonumber\\\\[-8pt]\\label{de}\\\\[-8pt ] & & { } + \\tfrac{1}{2}\\sigma_g^2({\\mathbf{s}}_1 + { \\mathbf{s}}_0)^t{\\bolds{\\gamma}}({\\mathbf{s}}_1- { \\mathbf{s}}_0)^t{\\bolds{\\gamma}},\\nonumber \\\\ \\mathrm{ie}&=&({\\mathbf{s}}_1-{\\mathbf{s}}_0)^t{\\bolds { \\delta}}\\bigl(\\beta_g+{\\mathbf{s}}_1^t{\\bolds{\\gamma } } \\bigr ) .",
    "\\label{ie}\\end{aligned}\\ ] ] these are derived in section  1 of the supplementary materials using counterfactuals under the assumptions of no unmeasured confounding [ @xcite ] .",
    "the sum of the direct and indirect effects is equal to the total effect of the snps , that is , @xmath136 . as shown in the supplementary material [ @xcite ] and discussed in section  3.2 , identification of the total effect",
    "requires a much weaker assumption than those required for the direct and indirect effects .",
    "[ ssnull ]    under the assumption that the gene expression @xmath2 is associated with the snps @xmath16 ( i.e. , eqtl snps ) , that is , @xmath137 , using equations ( [ de ] ) and ( [ ie ] ) , the test for the joint effects of snps in a snp set @xmath16 and a gene expression @xmath2 on @xmath3 , that is , the total effect of a gene , is equivalent to a test for the total snp effect on the outcome ( @xmath3 ) .",
    "in fact , for eqtl snps , which have nonzero effects on expression @xmath2 ( i.e. , @xmath137 ) , using the expressions of de and ie in ( [ de ] ) and ( [ ie ] ) , one can show that the null hypothesis of no direct and indirect genetic ( snp ) effects is equivalent to the null hypothesis  ( [ null ] ) that all the regression coefficients ( @xmath138 , @xmath34 and @xmath139 ) equal zero : @xmath140 the null hypothesis ( [ null ] ) that all the regression coefficients ( @xmath138 , @xmath34 and @xmath139 ) are equal to zero is also equivalent to the null hypothesis of no total effect of the snps provided @xmath141 if @xmath138 or @xmath34 is not 0 for eqtl snps ( @xmath142 , that is , @xmath143    we show in section  1.4 of the supplementary material that the null hypothesis  ( [ null1 ] ) requires only the assumption of no unmeasured confounding for the effect of eqtl snps ( @xmath16 ) on the outcome ( @xmath3 ) after adjusting for the covariates ( @xmath144 ) [ @xcite ] .",
    "most genetic association studies make this assumption . in other words",
    ", we make no stronger assumption than standard snp only analyses for testing the null hypothesis of no total effect of the snp set in a  gene",
    ".    note that in models ( [ ymodel ] ) and ( [ gmodel ] ) we allow other covariates ( @xmath4 ) to affect both the gene expression and the disease .",
    "if the covariates @xmath4 affect both expression and disease , ignoring @xmath4 may cause confounding in estimating de and ie . as shown in figure  [ fig1",
    "] , if arrows from @xmath4 to @xmath2 and @xmath3 exist and @xmath4 is not controlled for , assumption  ( 2 ) in section  1.2 of the supplementary material is violated [ @xcite ] .",
    "but if the covariates @xmath4 , the common causes of expression and disease , do not affect the snps @xmath1 ( no arrow from @xmath4 to @xmath1 ) , the estimation and hypothesis testing for te is still valid . however , if there does exist an effect of @xmath4 on @xmath1 , then it violates the above assumption of no unmeasured confounding for the @xmath16@xmath3 association and , thus , the test or estimation for te will be biased .",
    "if snps have no effect on gene expression ( @xmath145 ) , that is , they are not eqtl snps , then there is no indirect effect of the snps on @xmath3 , so that the null hypothesis of no total effect of a gene ( @xmath146 ) is not equivalent to testing for no total snp effect on @xmath3 ( @xmath147 ) . in this case",
    ", what the null hypothesis , @xmath146 , tries to evaluate is simply whether there exists a joint effect of the given set of snps @xmath16 and the given gene expression @xmath2 , and possibly their interactive effect , on disease risk .",
    "to test for such a joint effect , we need the first two assumptions regarding no unmeasured confounding in section  1.2 of the supplementary material : no unmeasured confounding of the snps on the outcome and no unmeasured confounding of the gene expression on the outcome [ @xcite ] .",
    "[ ssgwas ]    in standard genetic association analysis , we usually fit the following snp only model : @xmath148 which does not take gene expression into account , but simply considers the association between the outcome and snps adjusting for covariates .",
    "note for the special case where snp , @xmath149 , is univariate , the model ( [ gwas ] ) corresponds to single snp analysis , the most common approach in gwas .",
    "@xcite and @xcite have developed tests for a snp - set for @xmath150 under ( [ gwas ] ) , which can be more powerful than individual snp tests for the association between the joint effects of the snps in a gene and the outcome by borrowing information across snps within a gene , especially when the snps are in good linkage disequilibrium ( ld ) .    assuming the true models that depend on both snps and a gene expression are specified in ( [ ymodel ] ) and ( [ gmodel ] )",
    ", we study in this section how @xmath151 in the misspecified standard snp only model ( [ gwas ] ) is related to the regression parameters @xmath152 and  @xmath139 in the true model ( [ ymodel ] ) and what the null hypothesis @xmath153 under ( [ gwas ] ) tests for . to focus on the fundamental issues and for simplicity",
    ", we first discuss the case of no interaction effect between snps and gene expression on disease risk , that is , @xmath154 in model ( [ ymodel ] ) . under",
    "the true @xmath155 $ ] and @xmath25 $ ] models in ( [ ymodel ] ) and ( [ gmodel ] ) assuming no @xmath156 interaction ( @xmath154 ) , by plugging ( [ gmodel ] ) into  ( [ ymodel ] ) , the true @xmath155 $ ] model can be rewritten as @xmath157 . integrating out @xmath158",
    ", we have the true @xmath159 $ ] model as @xmath160\\approx c \\bigl\\{{\\mathbf{x}}_i^t ( { \\bolds{\\alpha}}+ \\beta_g{\\bolds{\\phi}})+{\\mathbf{s}}_i^t ( { \\bolds{\\beta}}_s+\\beta_g{\\bolds{\\delta } } ) \\bigr\\ } , \\label{trueysmodel}\\ ] ] where @xmath161 [ @xcite ] .",
    "a comparison of ( [ gwas ] ) with ( [ trueysmodel ] ) shows that @xmath162 and that the effect of @xmath163 versus @xmath164 on the outcome @xmath3 under the snp only model ( [ gwas ] ) corresponds to @xmath165 , which is proportional to the total effect of snps in ( [ te ] ) when @xmath154 .",
    "it follows that testing for @xmath166 in the snp only model  ( [ gwas ] ) is approximately equivalent to testing for no total effect of the snps .",
    "however , if there exists a snp - by - expression interaction on @xmath3 and the snps are eqtl snps , the naive snp only analysis using ( [ gwas ] ) does not provide obvious correspondence to the total snp effect . as shown in section  2 of the supplementary material [ @xcite ] , the induced true @xmath159 $ ] model in this setting follows @xmath167\\\\[-8pt ] & & \\qquad \\approx c_{i}^ * \\bigl\\{{\\mathbf{x}}_i^t ( { \\bolds{\\alpha}}+{\\bolds{\\phi } } \\beta_g)+{\\mathbf{s}}_i^t ( { \\bolds{\\beta}}_s+{\\bolds{\\delta}}\\beta_g ) + { \\mathbf{x}}_i^t { \\bolds{\\phi}}{\\mathbf{s}}_i^t{\\bolds{\\gamma}}+{\\mathbf{s}}_i^t { \\bolds{\\delta}}{\\mathbf{s}}_i^t{\\bolds{\\gamma } } \\bigr\\ } , \\nonumber\\end{aligned}\\ ] ] where @xmath168 .",
    "this implies that if the @xmath169 $ ] follows the interaction model ( [ ymodel ] ) , the induced true @xmath170 $ ] model depends not only on the linear terms of @xmath4 and @xmath1 but also on the cross - product terms of @xmath4 and @xmath1 and the second order term of @xmath1 .",
    "a comparison of ( [ gwas ] ) with ( [ trueysint ] ) shows that the standard snp only model ( [ gwas ] ) misspecifies the functional form of the true @xmath170 $ ] . the test for @xmath171 under the misspecified snp only model ( [ gwas ] )",
    "will still be valid for testing the total effects of snps , because under the null the two models are the same .",
    "however , the misspecified model is subject to power loss , compared to the test based on the correctly specified model . with only an interaction effect ( @xmath172 , @xmath173 , @xmath32 ) , ( [ trueysint ] ) can be written as @xmath174 \\approx c_{i}^ * \\{{\\mathbf{x}}_i^t{\\bolds{\\alpha } } + { \\mathbf{x}}_i^t{\\bolds{\\phi}}{\\mathbf{s}}_i^t{\\bolds{\\gamma}}+{\\mathbf{s}}_i^t{\\bolds{\\delta}}{\\mathbf{s}}_i^t{\\bolds{\\gamma } } \\ } , $ ] where @xmath175 . if we assume this is the true model and fit the conventional gwas model ( [ gwas ] ) to test for the snp effect , the test is again still valid under the null , but loses power under the alternative .",
    "the approach here differs in several ways from that based on mendelian randomization [ smith and ebrahim ( @xcite and @xcite ) ] in which genetic markers ( snps ) are instrumental variables to assess the effect of an exposure ( in our case , a gene expression value ) on an outcome .",
    "here we are interested in using a gene expression to increase power for testing for the total effect of snps on a disease outcome .",
    "furthermore , mendelian randomization makes the assumption that snps do not have an effect on an outcome except through an exposure ( e.g. , gene expression in our case ) , in other words , no direct effect .",
    "no such assumption is being made here .",
    "this is because we are interested in testing for a different effect , that is , the effect of snps , rather than the effect of an exposure ( gene expression ) on disease risk .",
    "[ ssimulation ]      to make the simulation mimic the motivating asthma data [ @xcite ] , we simulated data using the _ ormdl3 _ gene on chromosome 17q21 .",
    "we generated the snp data in the _ ormdl3 _ gene by accounting for its linkage disequilibrium structure using hapgen based on the ceu sample [ @xcite ] .",
    "the genomic location used to generate the snp data is between 35.22 and 35.39 mb on chromosome 17 , which contains 99 hapmap snps .",
    "ten of the 99 hapmap snps are genotyped on the illumina humanhap300 array , that is , 10 typed snps .",
    "to generate gene expression and the disease outcome , we assumed there is one causal snp @xmath176 and varied the causal snp among the 99 hapmap snps in each simulation . in section  [ sec5.4 ]",
    "we further perform a simulation study assuming three causal snps . for subject @xmath5 , gene expression @xmath12",
    "was generated by the linear regression model @xmath177 , @xmath178 .",
    "the outcome @xmath7 was generated by the logistic model @xmath179 the parameters and the range of @xmath180 , @xmath34 and @xmath181 were based on the empirical estimates from analysis of the asthma data . for each simulation",
    ", we first generated a cohort with 1000 subjects , and 100 cases and 100 controls were randomly selected from the 1000 subjects to form a case  control sample .",
    "two sets of simulations were performed . in the first set , we selected the snp rs8067378 as the causal snp , as this snp",
    "is highly associated with asthma in the original gwas [ @xcite ] . for each configuration of @xmath180 , @xmath34 , @xmath181 and @xmath182",
    ", we generated 2000 data sets to calculate the empirical size and power .",
    "in the second set of simulation , the causal snp was chosen one at a time out of the 99 hapmap snps .",
    "for each selected causal snp , we generated 1000 data sets and evaluated statistical power for two different disease models : @xmath183 or @xmath184 . in both simulation settings",
    ", we used the 10 typed snps of the gene on the illumina chip to form the snp - set for the model ( [ ymodel ] ) , that is , @xmath185 , in calculating the test statistics @xmath100 , @xmath101 , @xmath97 and the omnibus test . for @xmath101 and @xmath97 , both weighted and unweighted methods were investigated , where @xmath186 , @xmath187 and @xmath188 for the weighted statistic , and @xmath189 for the unweighted statistic .",
    "the @xmath10-values were calculated using the scaled @xmath0 approximation , the davies method by inverting the characteristic function [ @xcite ] and the perturbation procedure with 500 perturbations .",
    "the results of these approximations were very similar at the significance level of 0.05 .",
    "we performed the omnibus test by combining the evidence from @xmath100 , weighted @xmath101 and weighted @xmath97 .",
    "[ ssinglesnp ] we first evaluated the sizes of the proposed score tests , where the null distribution was approximated by either the scaled @xmath0 approximation or the perturbation procedure ( table  [ tab1 ] ) .",
    "type i errors are well protected using both approximation methods under the three models with statistics @xmath190 . the empirical size is close to 0.05 for the omnibus test and the three models . as the results using different approximation methods are similar at the level of 0.05 , we only present in the following the empirical power using the perturbation method .",
    "we also evaluate the performance of the proposed tests using the characteristic function inversion method [ @xcite ] and the perturbation method at smaller sizes ( @xmath191 and @xmath192 ) ( table  [ tab1 ] of the supplementary material [ @xcite ] ) , and find the methods perform well .",
    "@@lcccc@ & & + & & + & * unweighted * & * weighted * & * unweighted * & * weighted * +   + snps & & + snps and expression & 4.80 & 4.95 & 4.80 & 4.80 + snps , expression and interaction & 4.75 & 4.60 & 4.60 & 4.35 + omnibus test & & 5.15 +   + snps & & + snps and expression & 4.87 & 4.90 & 4.83 & 4.87 + snps , expression and interaction & 4.60 & 4.80 & 4.77 & 5.07 + omnibus test & & 5.13 +    [ cols=\"^,^ \" , ]     we performed additional simulations to assess how model misspecification influences our proposed test .",
    "gene expression @xmath12 was generated without the normality assumption @xmath193 , @xmath194 .",
    "two outcome models are explored .",
    "the first model generates the outcome @xmath7 by the logistic model assuming nonlinear effects of snps and @xmath2 as @xmath195 , and the second model generates @xmath7 by a probit model @xmath196 .",
    "although the model is not correctly specified in our proposed test under these settings , the joint analyses of snps and expression still outperform the snp - only analyses when the gene expression contributes to the risk of developing disease .",
    "similarly , the performance of the omnibus test is very close to the optimal test obtained under the true model for different scenarios ( figure  [ fig4 ] ) .",
    "we conducted two additional simulation studies by varying the number of causal variants and ld structures .",
    "the pattern of the results from these additional studies is very similar to what is presented above ( figures  [ fig1 ] and  [ fig2 ] in the supplementary material [ @xcite ] ) .",
    "the first additional study is similar to the study in section  [ ssinglesnp ] , except that there are three causal snps in the _ ormdl3 _ gene instead of a single causal snp . using the same ten typed snps for the analyses",
    ", we again found that the test performs the best when the model is correctly specified and the omnibus test approaches the optimal test obtained under the true model with limited power loss ( figure  [ fig1 ] of the supplementary material [ @xcite ] ) .",
    "similar to analyses in section  [ smultiplesnp ] , the second additional study investigates the performance of the proposed test at 15q2415q25.1 , where snps have a different ld pattern from the _",
    "ormdl3 _ gene .",
    "assuming one causal snp at a time , we used the same ten typed snps to perform our proposed test .",
    "again , the test performs the best when the model is correctly specified , and the omnibus test is robust and approaches the optimal test obtained by assuming the true model , and the power depends on the correlation of the causal snp and the typed snps ( figure  [ fig2 ] of the supplementary material [ @xcite ] ) .",
    "[ sdataanalysis ]    we applied the proposed testing procedures to reinvestigate the genetic effects of the _ ormdl3 _ gene on the risk of childhood asthma in the mrc - a data [ @xcite ; @xcite ] .",
    "this subset of the data contained 108 asthma cases and 50 controls where we have complete data of the 10 typed snps and gene expression of _ ormdl3_. the snp data were genotyped using the illumina 300k chip and the gene expression was collected using the affymetrix hu133a 2.0 .",
    "we analyzed the data using both additive and dominant modes : in the additive mode , the genotype was coded as the number of the minor allele ( i.e. , 0 , 1 , 2 ) , whereas in the dominant mode , the genotype was coded as whether or not the minor allele was present ( i.e. , 0 , 1 ) .",
    "@@lccccc@ & * multivariate * & * bonferroni- * & * permutation- * & * vct * & * vct * + & * wald * & * adjusted @xmath197 * & * adjusted @xmath197 * & * unweighted * & * weighted * +   + snps & 0.122 & 0.102 & 0.039 & + snps , gene & 0.342 & 0.194 & 0.057 & 0.039 & 0.033 + snps , gene and interaction & 0.013 & 0.303 & 0.093 & 0.0025 & 0.0028 + omnibus test & & +   + snps & 0.018 & 0.015 & 0.018 & + snps , gene & 0.094 & 0.031 & 0.018 & 0.0040 & 0.0040 + snps , gene and interaction & 0.131 & 0.098 & 0.048 & 0.0035 & 0.0023 + omnibus test & & +    we applied the proposed tests for the total snp effect of _",
    "ormdl3 _ using the snp and gene expression data .",
    "there are strong associations between the snps and the gene expression ( 8 out of 10 with @xmath10-value@xmath1980.05 and the other two with @xmath10-values of 0.076 and 0.21 ) , that is , the snps are eqtl snps .",
    "we considered six test statistics : @xmath100 , unweighted @xmath101 , weighted @xmath101 , unweighted @xmath97 , weighted @xmath97 , and omnibus test ( table  [ tab2 ] ) .",
    "we compared our methods with the standard multivariate or univariate methods : the multivariate wald test , which has 10 , 11 and 21 degrees of freedom under the three models ( snps only , snps and gene expression , and snps , gene expression and interactions ) .",
    "we also included in the comparison the test using the smallest @xmath10-value from the 10 single snp analyses with the bonferroni adjustment or the adjustment using the permutation procedure to account for the correlation among the snps .",
    "the results in table  [ tab2 ] show that our proposed methods give smaller @xmath10-values compared to the standard testing procedures .",
    "the test @xmath97 , which accounts for the effects of snps , gene expression and their interactions , gives the smallest value compared to the tests only using snps , in both additive and dominant modes .",
    "for example , the @xmath10-values using weighted @xmath97 and @xmath100 are 0.0028 and 0.044 , respectively , using the additive snp model .",
    "the omnibus test calculated using the perturbation procedure by computing the minimum @xmath10-value from @xmath100 , weighted @xmath101 and weighted @xmath97 also provides a more significant signal than those only considering snps , with the @xmath10-value being 0.0055 .",
    "these results are consistent with the findings in simulation studies .",
    "we also performed genome - wide analyses for both snp - sets and single snp .",
    "we first paired eqtl snps with their corresponding gene expression [ @xcite ] and performed snp - only analyses and our proposed method .",
    "for single snp analyses , after adjustment of multiple comparison using false discovery rate [ fdr ; @xcite ] , 56 snps with fdr@xmath1980.1 were identified in snp - only analyses and 97 snps were identified from the proposed omnibus test . for snp - set analyses",
    ", we grouped eqtl snps that correspond to the same gene as a snp - set , and we identified 5 and 15 snp - sets ( fdr@xmath1980.1 ) from snp - only analyses and omnibus tests , respectively .",
    "[ sdiscussion ]    we proposed in this paper to integrate snp and gene expression data to improve power for genetic association studies .",
    "the major contributions of this paper are as follows : ( 1 ) to formulate the data integration problem of different types of genomic data as a mediation problem ; ( 2 ) to propose a powerful and robust testing procedure for the total effect of a gene contributed by snps and a gene expression ; and ( 3 ) to relax the assumptions required for mediation analyses in the test for the total effect .",
    "specifically , as shown in figure  [ fig1 ] , we are able to integrate the information of snps and gene expression as a biological process through the mediation model .",
    "our proposed variance component score test for the total effect of snps and a gene expression circumvents the instability of estimation of the joint effects of multiple snps and gene expression , because only the null model needs to be fit .",
    "mediation analysis to estimate direct and indirect effects generally requires additional unmeasured confounding assumptions , and previous work mainly focused on estimation .",
    "here we focus on testing for the total effect of a gene using snps and a gene expression . for eqtl snps , we show that the total effect of a gene contributed by snps and a gene expression is equivalent to the total effect of snps , which is the sum of direct and indirect effects of snps mediated through gene expression . testing for the total snp effect only requires one assumption : no unmeasured confounding for the effect of snps on the outcome , which is the same assumption as the standard gwas and , thus , no stronger assumption is required .",
    "we characterize the relation among snps , gene expression and disease risk in the framework of causal mediation modeling .",
    "this framework allows us to understand the null hypothesis of no total effect of a gene contributed by snps and gene expression , and the underlying assumptions of the test for both eqtl snps and non - eqtl snps .",
    "we propose a variance component score test for the total effects of a gene on disease .",
    "this test allows to jointly test for the effects of snps , gene expression and their interactions .",
    "we showed that the proposed test statistic follows a mixture of @xmath0 distributions asymptotically , and proposed to approximate its finite sample distribution using a scaled @xmath0 distribution , a characteristic function inversion method or a perturbation method .",
    "we considered three tests : using only snps ( @xmath100 ) , snps and gene expression main effects ( @xmath101 ) , and snps , gene expression and their interactions ( @xmath97 ) .",
    "our simulation study shows that all three tests have the correct type i error for testing for the overall snp effect .",
    "the relative power of these tests depends on the underlying true relation between the predictors ( snps , gene expression and their interactions ) and disease .",
    "as the underlying biology is often unknown , we further constructed the omnibus test that identifies the most powerful test among the three disease models , and proposed to use the perturbation method to calculate the value for the omnibus test .",
    "further , the test using only the main effects of snps and gene expression loses limited power compared to the omnibus test and can be used as a simple alternative .",
    "our results also show that to test for the total effects of a gene , the tests that incorporate both snp and gene expression information , such as @xmath101 and @xmath97 , are more powerful if snps are associated with gene expression than if they are not .",
    "in other words , it is even more beneficial to incorporate gene expression data with snp data to detect genetic effects on disease if gene expression is a good causal mediator for the snps . to achieve this ,",
    "a natural way is to select snps located within or at the neighborhood of a gene , since it has been well destablished that the snp within a gene can alter its expression value via transcription regulation [ @xcite ] .",
    "alternatively , one can restrict the joint snp - expression analysis to known eqtl snps .",
    "if selection of eqtl snps is based on statistical significance , one also needs to be aware of the possibility that cis - action may be a confounding effect of snps on array hybridization [ @xcite ] .",
    "we mainly focus on testing for the total effect of a gene in this paper .",
    "the proposed method can be easily extended to test for direct and indirect effects separately for eqtl snps .",
    "using equation ( [ de ] ) , to test for the direct effect of the snps , one can test @xmath199 .",
    "using the notation in equation ( [ q - stat ] ) , one can test this null hypothesis using the statistic @xmath200 , where the null model is a logistic model with @xmath201 and @xmath202 . to test for the indirect effects of the snps , using equation ( [ ie ] )",
    ", one can test @xmath203 . using the notation in equation ( [ q - stat ] )",
    ", one can test this null hypothesis using the statistic @xmath204 , where the null model is a logistic model with @xmath201  and  @xmath205 .",
    "as the number of snps @xmath205 might be large and some snps might be highly correlated ( with high ld ) , standard regression to fit the null model might not work well .",
    "one can fit the null model using ridge regression . to perform these tests",
    ", one will need to make the four unmeasured confounding assumptions required for estimating direct and indirect effects of snps stated in section  1.2 of the supplementary material [ @xcite ] .",
    "gene expression may not be the only mediator for the relation between snps and disease .",
    "other biomarkers , such as dna methylation , proteins , metabolites of the gene product in the blood , immunological or biochemical markers in the serum , and environmental factors can also serve as potential mediators , depending on the context or the disease to be studied .",
    "for instance , epigenetic variations have been reported to exert heritable phenotypic effects [ @xcite ] .",
    "furthermore , our proposed test can be applied to address many other scientific questions as long as there exists a causal relationship as illustrated in figure  [ fig1 ] .",
    "for example , the snp - gene - disease relations can be replaced by the dna copy number - protein - cancer stage ( early vs. late ) in tumor genomics studies to assess if copy number can have any effect on the clinical stage of cancer .",
    "it is advantageous to set up a biologically meaningful model before applying our proposed test procedure , which makes the best use of the prior knowledge .",
    "the authors would like to thank the editor , the associate editor and the referees for their helpful comments that have improved the paper ."
  ],
  "abstract_text": [
    "<S> genetic association studies have been a popular approach for assessing the association between common single nucleotide polymorphisms ( snps ) and complex diseases . however , </S>",
    "<S> other genomic data involved in the mechanism from snps to disease , for example , gene expressions , are usually neglected in these association studies . in this paper </S>",
    "<S> , we propose to exploit gene expression information to more powerfully test the association between snps and diseases by jointly modeling the relations among snps , gene expressions and diseases . </S>",
    "<S> we propose a variance component test for the total effect of snps and a gene expression on disease risk . </S>",
    "<S> we cast the test within the causal mediation analysis framework with the gene expression as a potential mediator . </S>",
    "<S> for eqtl snps , the use of gene expression information can enhance power to test for the total effect of a snp - set , which is the combined direct and indirect effects of the snps mediated through the gene expression , on disease risk . </S>",
    "<S> we show that the test statistic under the null hypothesis follows a mixture of @xmath0 distributions , which can be evaluated analytically or empirically using the resampling - based perturbation method . </S>",
    "<S> we construct tests for each of three disease models that are determined by snps only , snps and gene expression , or include also their interactions . as the true disease model is unknown in practice , we further propose an omnibus test to accommodate different underlying disease models . </S>",
    "<S> we evaluate the finite sample performance of the proposed methods using simulation studies , and show that our proposed test performs well and the omnibus test can almost reach the optimal power where the disease model is known and correctly specified . we apply our method to reanalyze the overall effect of the snp - set and expression of the _ ormdl3 _ </S>",
    "<S> gene on the risk of asthma .    , </S>"
  ]
}