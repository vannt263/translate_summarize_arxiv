{
  "article_text": [
    "it is widely believed that most complex systems are unpredictable , with concrete implications in earthquake prediction , in engineering failure @xcite , and in financial markets @xcite to cite a few .",
    "in addition to the persistent failures of predictive schemes for these systems , concepts such as self - organized criticality @xcite suggest an intrinsic impossibility for the prediction of catastrophes . several recent works suggest a different picture : catastrophes may result from novel mechanisms amplifying their size @xcite and may thus be less unpredictable than previously thought .",
    "this idea has been mostly explored in material failure @xcite , in earthquakes @xcite , and in financial markets and emerged in the latter from the analysis of cumulative losses ( drawdowns ) @xcite , from measures of algorithmic complexity @xcite , and from agent - based models @xcite .",
    "we present novel empirical tests that provide a strong support for the hypothesis that large events can be predicted .",
    "we focus our analysis on financial indices ( typically the daily dow jones industrial average ( djia ) from 26-may-1896 to 11-mar-2003 ) as they provide perhaps the best data sets that can be taken as proxies for other complex systems .",
    "our methodology is based on the assumption that fast large market drops ( crashes ) are the results of interactions of market players resulting in herding behavior : exogenous shocks ( due to changes in market fundamentals ) often do not play an important role , which is at odds with standard economy theory .",
    "the fact that exogenous shocks may not be the most important driving causes of the structures found in financial time series has been shown to be the case for volatility shocks @xcite : most of the bursts of volatility in major us indices can be explained by an endogenous organization involving long - memory processes , while only a few major shocks such as 9/11/2001 or the coup against gorbachev in 1991 are found to leave observable signatures . concerning financial crashes in indices , bonds and currencies ,",
    "@xcite have performed an extended analysis of the distribution of drawdowns ( cumulative losses ) in the two leading exchange markets ( us dollar against the deutsch and against the yen ) , in the major world stock markets , in the u.s . and japanese bond market and in the gold market and",
    "have shown the existence of `` outliers , '' in the sense that the few largest drawdowns do not belong to the same distribution .",
    "for each identified outlier , @xcite have checked whether the formula ( [ eq : lnpt ] ) given below , expressing a so - called log - periodic power law signature ( lppl ) , could fit the price time series preceding them ; if yes , the existence of the lppl was taken as the qualifying signature for an endogenous crash ( a drawdown outlier was seen as the end of a speculative unsustainable accelerating bubble generated endogenously ) . in the absence of lppl",
    ", @xcite were able to identify the relevant historical event , _",
    "i.e. _ , a new piece of information of such magnitude and impact that it is reasonable to attribute the crash to it , following the standard view of the efficient market hypothesis .",
    "such drawdown outliers were thus classified as having an exogenous origin .",
    "globally over all the markets analyzed , @xcite identified 49 outliers , of which 25 were classified as endogenous , 22 as exogenous and 2 as associated with the japanese `` anti - bubble '' starting in jan .",
    "1990 . restricting to the world market indices",
    ", @xcite found 31 outliers , of which 19 are endogenous , 10 are exogenous and 2 are associated with the japanese anti - bubble .",
    "the combination of the two proposed detection techniques , one for outliers in the distribution of drawdowns and the second one for lppl , provided a systematic taxonomy of crashes .",
    "the present paper goes one step further to propose a prediction scheme for crashes , and by extension large and rapid changes of regime .",
    "our proposed learning algorithm belongs to a recent body of literature that challenges the efficient market hypothesis ( emh ) . in the context of information",
    "theory which is related to the present pattern recognition approach , see for instance @xcite .",
    "our approach is also related to the field of nonlinearity applied to financial time series : see @xcite for a review and @xcite for tests and models of nonlinearity in financial time series . however , while we use a deterministic function to fit bubble periods , our approach is not deterministic because our underlying rational expectation bubble theory acknowledges the stochastic component introduced by the crash hazard rate and by the random regime shifts associated with the nucleation of bubble periods .",
    "in addition , the lppl pattern that we propose to characterize these bubble periods , while rather rigid in its geometrical proportions exemplifying the concept of discrete scale symmetry ( see below ) , is different from one bubble to the next as its time span and amplitude can change .",
    "this paper is organized as follows .",
    "section [ s1:theory ] presents the theoretical foundation of our approach .",
    "section [ s1:pr ] describes the definition of the pattern recognition method and its implementation and tests on the djia .",
    "section [ s1:hsi ] shows further tests on the hong kong hang - seng index and section [ s1:conclude ] concludes .",
    "our key idea is to test for signatures of collective behaviors similar to those well - known in condensed - matter and statistical physics .",
    "the existence of similar collective behaviors in physics and in markets may be surprising to those not involved in the study of complex systems . indeed , in physics , the governing laws are well established and tested whereas one could argue that there is no well - established fundamental law in stock markets .",
    "however , the science of complexity developed in the last two decades has shown that the emergence of collective phenomena proceeds similarly in physics , biology or social sciences as long as one is interested in the coarse - grained properties of large assemblies of constituting elements or agents ( see for instance @xcite and references therein ) .",
    "collective behaviors in population of agents can emerge through the forces of imitation leading to herding @xcite .",
    "herding behavior of investors is reflected in significant deviations of financial prices from their fundamental values @xcite , leading to so - called speculative bubbles @xcite and excess volatility @xcite .",
    "the similarity between herding and statistical physics models , such as the ising model , has been noted by many authors @xcite .",
    "we use this similarity to model a speculative bubble as resulting from positive feedback investing , leading to a faster - than - exponential power law growth of the price @xcite .",
    "in addition , the competition between such nonlinear positive feedbacks , negative feedbacks due to investors trading on fundamental value and the inertia of decision processes lead to nonlinear oscillations ( nonlinear in the sense of amplitude - dependence frequencies ) @xcite that can be captured approximately by adding an imaginary part to the exponent of the power law price growth ( by power law price growth , we refer to the super - exponential growth typically associated with the solution of the equation @xmath2 , with @xmath3 and @xmath4 . for @xmath5 ,",
    "one recovers the standard exponential growth . for @xmath4",
    ", @xmath6 can approach a singularity in finite time like @xmath7 such that it is written @xmath8 describes the existence of accelerating log - periodic oscillations obeying a discrete scale invariance ( dsi ) symmetry @xcite .",
    "this can be seen from the fact that @xmath9 $ ] .",
    "more generally , it can be shown that the first terms in a systematic expansion can be written as @xmath10 = a - b\\tau^m + c\\tau^m \\cos\\left[\\omega\\ln(\\tau)-\\phi\\right]~ , \\label{eq : lnpt}\\ ] ] where @xmath11 is the price of a specific asset ( it can be a specific stock , commodity or index ) , @xmath12 is the logarithm of the price at @xmath13 , @xmath14 is the angular log - frequency , @xmath15 and @xmath16 for an acceleration to exist , @xmath17 quantifies the amplitude of the log - periodic oscillations , @xmath18 is an arbitrary phase determining the unit of the time , @xmath19 is the current time , and @xmath20 is the distance to the critical time @xmath13 defined as the end of the bubble .",
    "equation ( [ eq : lnpt ] ) does not hold for any time but rather applies to those non - stationary transient phases , otherwise known as bubbles .",
    "expression ( [ eq : lnpt ] ) has been used to fit bubbles according to the following algorithm described in @xcite , that we summarize here : ( i ) the crashes were identified within a given financial time series as the largest cumulative losses ( largest drawdowns ) according to the methodology of @xcite ; ( ii ) the bubble preceding a given crash was then identified as the price trajectory starting at the most obvious well - defined minimum before a ramp - up ending at the highest value before the crash .",
    "the starting value ( local minimum ) of the bubble is unambiguous for large developed markets but it was sometimes necessary to change the interval fitted due to some ambiguity with respect to the choice of the first point in these smaller emergent markets @xcite .",
    "this algorithm was applied to over thirty crashes in the major financial markets and the fits of their corresponding bubbles with eqn.([eq : lnpt ] ) showed that the dsi parameter @xmath14 exhibits a remarkable universality , with a mean of @xmath21 and standard deviation of @xmath22 @xcite , suggesting that it is a significant distinguishing feature of bubble regimes . in these previous",
    "look back studies , the knowledge of the time of a given crash was used to identify its associated bubble with the purpose of testing for a common behavior .",
    "this was done in the usual spirit of a scientific endeavor which consists in general in the following steps : ( a ) collect samples ; ( b ) test for regularities and commonalities in the samples to establish a robust classification of a new phenomenon ; ( c ) develop a model accounting for this classification and calibrate it ; ( d ) put the model to test using its prediction that are applied to novel data , that have not be used in the model construction .",
    "the previous works mentioned above @xcite cover the steps ( a - c ) .",
    "the present paper addresses step ( d ) by developing a systematic look forward approach in which the goal is to identify `` in real time '' the existence of a developing bubble and to predict times of increased crash probability .    the physics - type construction ( i.e. , emphasizing interactions and collective behavior ) leading to eqn.([eq : lnpt ] ) is however missing an essential ingredient distinguishing the natural and physical from the social sciences , namely the existence of expectations : market participants are trying to discount a future that is itself shaped by market expectations . as exemplified by the famous parable of keynes beauty contest , in order to predict the winner , recognizing objective beauty is not very important , but knowledge or prediction of others prediction of beauty is much more relevant . similarly , mass psychology and investors expectations influence financial markets significantly .",
    "we use the rational - expectation ( re ) blanchard - watson model of speculative bubbles @xcite to describe concisely such feedback loops of prices on agent expectation and vice - versa . applied to a given bubble price trajectory",
    ", agents form an expectation of the sustainability of such bubble and of its potential burst . by this process , to each price @xmath11 is associated a crash hazard rate @xmath23 , such that @xmath24 is the probability for a crash or large change of regime of average amplitude @xmath25 to occur between @xmath19 and @xmath26 conditioned on the fact that it has not happened . the crash hazard rate @xmath23 quantifies the general belief of agents in the non - sustainability of the bubble .",
    "the re - bubble model predicts the remarkable relationship @xcite @xmath27 = \\kappa\\int_{t_0}^t   h(t')dt ' \\label{positcond}\\ ] ] linking price to crash hazard rate .",
    "this equation is the solution of the model describing the dynamics of the price increment @xmath28 over a time increment dt : @xmath29 , where @xmath30 is the instantaneous return , @xmath31 is a jump process equal to @xmath32 when a crash occurs with amplitude @xmath25 and zero otherwise .",
    "the no - arbitrage condition @xmath33=0 $ ] implies that @xmath34 $ ] , where @xmath35 $ ] denotes the expectation conditional on all information available up to the present time . by definition of the crash hazard rate , @xmath36 $ ] , this gives @xmath37 .",
    "thus , conditioned on no crash having occurred until time @xmath19 , the integration of the model yields ( [ positcond ] ) .    substituting eqn.([eq : lnpt ] ) in eqn.([positcond ] ) and using the fact , that by definition @xmath38 , gives the constraint @xmath39 this condition has been found to provide a significant feature for distinguishing market phases with bubbles ending with crashes from regimes without bubbles @xcite .    note",
    "that @xmath23 is not normalized to @xmath32 : @xmath40 gives the total conditional probability for a crash to occur , which is less than @xmath32 for the re bubble model to hold .",
    "there is thus a finite probability @xmath41 for the bubble to land smoothly without a crash .",
    "this is necessary for the re bubble model , as otherwise the crash would be certain . by having a non - zero probability for no crash to occur ,",
    "it remains rational for investors to remain in the market and harvest the risk premium ( the bubble ) for the risk of a possible ( but not certain ) crash .",
    "technically , using the standard rule of conditional probabilities , @xmath23 is related to the unconditional probability @xmath6 for a crash per unit time by @xmath42 . by integrating , rearranging and differentiating",
    ", this gives @xmath43 $ ] .",
    "let us now build on these insights and construct a systematic predictor of bubble regimes and their associated large changes . due to the complexity of financial time series , to the existence of many different regimes , and to the constant action of investors arbitraging gain opportunities , it is widely held that the prediction of crashes is an impossible task .",
    "the truth is that financial markets do not behave like statistically stationary physical systems and exhibit a variety of non - stationarities , influenced both by exogenous and endogenous shocks @xcite . to obtain robustness and to extract information systematically in the approximately self - similar price series , it is useful to use a multiscale analysis : the calibrations of eqn.([eq : lnpt ] ) and eqn.([positcond ] )",
    "are thus performed for each trading day over nine different time scales of @xmath44 , @xmath45 , @xmath46 , @xmath47 , @xmath48 , @xmath49 , @xmath50 , @xmath51 and @xmath52 trading days .    each trading day",
    "ending an interval of length @xmath52 or smaller is called an object and there are a total of 27428 objects from 06-feb-1902 till 11-mar-2003 .",
    "we define a map from the calendar time @xmath19 to an ordered index @xmath53 of the trading day , such that @xmath54 if @xmath19 is a trading date and @xmath55 ( empty set ) otherwise .",
    "this mapping is just a convenient way for defining the set of objects to which our method is applied",
    ". it does not produce any bias or additional dynamics since it is used only in the classification scheme .",
    "we denote @xmath56 a list of targets ( crashes ) that happened at @xmath57 .",
    "the total number of targets is thus @xmath58 .",
    "all objects are partitioned into two classes @xmath59 and @xmath60 , where class @xmath61 contains all the objects in @xmath62 $ ] for @xmath63 and class @xmath64 includes all the remaining , where @xmath65 is a given number in unit of calender day . in the following ,",
    "our target set are three well - known speculative bubbles that culminated on 14-sep-1929 , 10-oct-1987 and 18-jul-1998 , respectively , before crashing in the following week or month .",
    "the first two bubbles are perhaps the most famous or infamous examples discussed in the literature .",
    "the last one is more recent and has been associated with the crisis of the russian default on its debt and ltcm . of course , the choice of this triplet is otherwise arbitrary .",
    "our goal is just to show that our method can generalize to other bubbles beyond those which have been used for training .",
    "figure [ fig1 ] presents the distributions of the @xmath14 s ( defined in eqn.([eq : lnpt ] ) ) and @xmath66 s ( defined in eqn.([defb ] ) ) , obtained from fits with eqn.([eq : lnpt ] ) in intervals ending on objects for all time scales and for three different values of @xmath65 .",
    "the distributions for classes @xmath59 and @xmath60 , which are very robust with respect to changes in @xmath65 , are very different : for @xmath67 $ ] ( which corresponds to the values obtained in previous works ) , @xmath68 is larger than @xmath69 ; @xmath70 of objects in class @xmath59 obey the constraint @xmath71 compared to @xmath72 in class @xmath60 .",
    "a standard kolmogorov - smirnov test gives a probability that this difference results from noise much less than @xmath73 .",
    "the very significant differences between the distributions in classes @xmath59 and @xmath60 confirm that the dsi and constraint parameters are distinguishing patterns of the three bubbles .",
    "figure  [ fig2 ] plots a vertical line segment for each time scale at the date @xmath19 of the object that fulfills simultaneously three criteria : @xmath74 , @xmath75 and @xmath76 .",
    "the last criterion ensures a smooth super - exponential acceleration .",
    "each stripe thus indicates a potentially dangerous time for the end of a bubble and for the coming of a crash .",
    "the number of dangerous objects decreases with the increase of the scale of analysis , forming a hierarchical structure .",
    "notice the clustering of alarms , especially at large scales , around the times of the three targets .",
    "altogether , figs .",
    "[ fig1 ] and [ fig2 ] suggest that there is valuable information for crash prediction but the challenge remains to decipher the relevant patterns in the changing financial environment . for this , we call in the statistical analysis of sparse data developed by the russian mathematical school @xcite in order to construct a systematic classifier of bubbles . the modified `` cora-3 '' algorithm @xcite that we briefly describe below allows us to construct an alarm index that can then be tested out - of - sample .",
    "each object is characterized by five quantities , which are believed to carry relevant information : @xmath14 , @xmath66 , @xmath77 , the r.m.s . of the residuals of the fits with eqn.([eq : lnpt ] ) and the height of the power spectrum @xmath78 of log - periodicity at @xmath14 @xcite .",
    "the residuals exhibit much less structure that the initial time series but some dependence remains as the fits with eqn.([eq : lnpt ] ) account only for the large time - scale structure .",
    "indeed , using the r.m.s .",
    "of the residuals in the discrimination of the objects is useful only if some dependence remains in them . in other words ,",
    "the residuals contain all the information at the smaller time scales and it is hoped that these sub - structures may be linked to the log - periodic structure at the largest time scale .",
    "this has actually been shown to be the case by @xcite in a specific case and by the construction of trading methods at short time scales [ _ johansen and sornette _ , unpublished ] .",
    "this also follows from the full solution of the underlying so - called renormalization group equation embodying the critical nature of a bubble and crash @xcite .",
    "the use of the power spectrum @xmath78 follows the same logic .",
    "integrated with the 9 scales , there are totally @xmath79 parameters for each object .",
    "one could worry that using so many parameters is meaningless in the deterministic framework of eqn.([eq : lnpt ] ) because the large number of degrees of freedom and their associated uncertainties lead to an effective randomness , but this view does not recognize that this approach amounts to a decomposition in multiple scales : ( a ) it is allowed for or recognized that the price trajectory has patterns at many scales ; ( ii ) for each pre - selected scale , a rather parsimonious deterministic fit is obtained .",
    "the selection of the relevant parameters discussed below amounts actually to searching for those time scales that are the most relevant , since the data should decide and not some a priori preconception .",
    "we set @xmath80 but have checked that all results are robust with large changes of @xmath65 .",
    "class i has 444 objects . by proceeding as in fig .",
    "[ fig1 ] , for each of the 45 parameters , we qualify it as relevant if its distributions in classes i and ii are statistically different .",
    "we have played with several ways of quantifying this difference and find again a strong robustness . out of the 45 parameters , 31 are found to be informative and we have determined their respective intervals over which the two distributions are significantly different .",
    "we use these 31 parameters to construct a questionnaire of 31 questions asked to each object .",
    "the @xmath81th question on a given object asks if the value of the @xmath81th parameter is within its qualifying interval .",
    "each object @xmath12 can then be coded as a sequence of binary decisions so that @xmath82 where @xmath83 is the answer ( y / n ) to the @xmath81th question .",
    "a distinctive property of the pattern recognition approach is to strive for robustness notwithstanding the lack of sufficient training data ( here only three bubbles ) @xcite . in this spirit , we define a trait as an array @xmath84 where @xmath85 , @xmath86 , @xmath87 and @xmath88 y or n. there are @xmath89 possible traits . if @xmath90 , @xmath91 and @xmath92 , we say that the object @xmath12 exhibits a trait @xmath84 .",
    "the number of questions ( three are used here ) defining a trait is a compromise between significance and robustness .",
    "a feature is a trait that is present relatively frequently in class i and relatively infrequently in class ii .",
    "specifically , if there are no less than @xmath93 objects in class @xmath59 and no more than @xmath94 objects in class @xmath60 that exhibit a same trait , then this trait is said to be a feature of class @xmath59 . calling @xmath95 the number of distinctive features of a given object at time @xmath19 , we define the alarm index @xmath96 , here amounting to perform a moving average of @xmath95 over a time window of width @xmath97 .",
    "we then normalize it : @xmath98 .",
    "let us summarize our construction leading to the alarm index .",
    "* we select a few targets ( the three well - known speculative bubbles ending in a crash at oct . 1929 , oct . 1987 and aug .",
    "1998 for the us index and two targets for the hang seng ) , which serve to train our system ( independently for the two indices ) . *",
    "an object is defined simply as a trading day ending a block of trading days of a pre - defined duration . *",
    "those objects which are in a neighborhood of the crashes of the targets are defined to belong to class i. all other objects are said to belong to class ii . * for each object , we fit the price trajectory with expression ( [ eq : lnpt ] ) over a given time scale ( defining the duration of the block of days ending with the object used in the fit ) and obtain the corresponding values of the parameters , which are considered as characteristic of the object .",
    "this step is repeated nine times , once for each of the nine time scales used in the analysis .",
    "we keep @xmath99 parameters of the fit by expression ( [ eq : lnpt ] ) for each time scale , thus giving a total of @xmath100 parameters characterizing each object .",
    "* we construct the probability density functions ( pdf ) of each parameter over all objects of class i and of class ii separately .",
    "those parameters which are found to exhibit sufficiently distinct pdf s over the two classes are kept as being sufficiently discriminating . in this way , out of the total of @xmath101 parameters , @xmath102 are kept . *",
    "each selected parameter gives a binary information , y or n , as whether its value for a given object falls within a qualifying interval for class i. * as a compromise between robustness and an exhausive description , we group the parameters in triplets ( called traits ) to obtain a characterization of objects .",
    "ideally , one would like to use all @xmath102 parameters simultaneously for each object , but the curse of dimensionality prevents doing this .",
    "* we study the statistics of all traits and look for those which are frequent in objects of class i and unfrequent in objects of class ii .",
    "such traits are called features . *",
    "the alarm index at a given time is defined as a moving average number of distinctive features found at that time .",
    "large values of the alarm index are proposed to be predictors of changes of regime in the stock market .",
    "figure [ fig3 ] shows the alarm index @xmath96 for @xmath103 with @xmath104 ( corresponding to at least @xmath105 of the objects in class i ) and @xmath106 ( corresponding to no more than @xmath107 of the objects in class ii ) . the alarm index is found to be highly discriminative as only 13.0% ( respectively 9.5% , and 4.7% ) of the total time is occupied by a high level of alarm larger than @xmath108 ( respectively @xmath109 , and @xmath110 ) .",
    "we have performed extensive experiments to test the robustness of the results .",
    "we have varied simultaneously @xmath93 from 100 to 400 with spacing 50 and @xmath94 from @xmath111 to @xmath112 with spacing @xmath113 .",
    "the results are remarkably robust with no change of the major peaks .",
    "the three bubbles used in the learning process are predicted ( this is expected of course ) : peak 3 is on 01-jul-1929 ( market maximum on 14-sep-1929 ) ; peak 9 is on 10-oct-1987 ( market maximum on 04-sep-1987 and crash on 19-oct-1987 ) ; peak 13 is on 23-apr-1998 ( market maximum on 18-jul-1998 ) .",
    "this timing is a good compromise for a prudent investor to exit or short the market without losing much momentum .",
    "this success is however not a big surprise because this corresponds to in - sample training .",
    "the most remarkable property of our algorithm is its ability for generalizing from the three bubbles ending with crashes to the detection of significant changes of regimes that may take a large variety of shapes ( for instance , a crash is not a one - day drop of , say , + 15% but can be spread over several days or a few weeks with rather complex trajectories , leading to very large cumulative losses ) .",
    "the following peaks are predictors of crashes or of strong corrections with an @xmath114 alarm threshold : peak 1 ( jan , 1907 ) , peak 4 ( apr , 1937 ) , peak 5 ( aug , 1946 ) , peak 6 ( jan , 1952 ) , peak 7 ( sep , 1956 ) , peak 8 ( jan , 1966 ) , peak 12 ( jul , 1997 ) and peak 14 ( sep , 1999 ) .",
    "the more than @xmath115 price drops in 1907 ( peak 1 ) and 1937 ( peak 4 ) have been previously identified as crashes occurring over less than three months @xcite .",
    "peak 12 is occurring three months before the turmoil on the stock market ( one day @xmath116 drop on 27-oct-1997 ) that was followed by a three month plateau ( see discussion in chapter 9 of ref .",
    "peak 10 is a false alarm .",
    "peaks 2 and 11 can be regarded as early alarms of the following 1929 crash and 1997 , 1998 , and 2000 descents .",
    "peak 15 - 17 are smaller peaks just barely above @xmath117 .",
    "peaks 15 and 16 are false alarms , while peak 17 ( 31-may-2000 ) is just two months before the onset of the global anti - bubble starting in august of 2000 @xcite .",
    "figure  [ fig4 ] is constructed as follows .",
    "each alarm index peak is characterized by the time @xmath13 of its maximum and by its corresponding log of price @xmath118 $ ] .",
    "we stack the index time series by synchronizing all the @xmath13 for each peak at the origin of time and by translating vertically the prices so that they coincide at that time .",
    "figure  [ fig4 ] shows four years of the djia before and two years after the time of each alarm index maximum .",
    "we choose this representation to avoid the delicate and still only partly resolved task of defining what is a crash , a large drop or a significant change of regime . on this problem ,",
    "the literature is still vague and not systematic .",
    "previous systematic classifications @xcite miss events that are obvious to the trained eyes of professional investors or on the contrary may incorporate events that are controversial .",
    "figure  [ fig4 ] shows that these peaks all correspond to a time shortly before sharp drops or strong change of market regimes . in a real - time situation ,",
    "a similar prediction quality can be obtained in identifying the peaks by waiting a few weeks for the alarm index to drop or alternatively by declaring an alarm when @xmath96 reaches above a level in the range @xmath119 .",
    "the sharpness and the large amplitudes of the peaks of the alarm index ensures a strong robustness of this latter approach .",
    "our method however misses several large price drops , such as those in 1920 , 1962 , 1969 , 1974 @xcite .",
    "this may be attributed to a combination of the fact that some large market drops are not due to the collective self - organization of agents but result from strong exogenous shocks , as argued in refs .",
    "@xcite and that the method needs to be improved .",
    "however , the generalizing ability of our learning algorithm strengthens the hypothesis that herding behavior leads to speculative bubbles and sharp changes of regimes .",
    "this brief presentation is borrowed from chap .",
    "9 of the book in @xcite . in evaluating predictions and their impact on ( investment ) decisions",
    ", one must weight the relative cost of false alarms with respect to the gain resulting from correct predictions .",
    "the neyman - pearson diagram , also called the decision quality diagram , is used in optimizing decision strategies with a single test statistic .",
    "the assumption is that samples of events or probability density functions are available both for correct signals ( the crashes ) and for the background noise ( false alarms ) ; a suitable test statistic is then sought which optimally distinguishes between the two . using a given test statistic ( or discriminant function )",
    ", one can introduce a cut which separates an acceptance region ( dominated by correct predictions ) from a rejection region ( dominated by false alarms ) . the neyman - pearson diagram plots contamination ( misclassified events , i.e. , classified as predictions which are thus false alarms ) against losses ( misclassified signal events , i.e. , classified as background or failure - to - predict ) , both as fractions of the total sample .",
    "an ideal test statistic corresponds to a diagram where the `` acceptance of prediction '' is plotted as a function of the `` acceptance of false alarm '' in which the acceptance is close to @xmath32 for the real signals , and close to @xmath120 for the false alarms .",
    "different strategies are possible : a `` liberal '' strategy favors minimal loss ( i.e. , high acceptance of signal , i.e. , almost no failure to catch the real events but many false alarms ) , a `` conservative '' one favors minimal contamination ( i.e. , high purity of signal and almost no false alarms but many possible misses of true events ) .",
    "@xcite has shown that the task of predicting an event in continuous time can be mapped onto the neyman - pearson procedure .",
    "he has introduced the `` error diagram '' which plots the rate of failure - to - predict ( the number of missed events divided by the total number of events in the total time interval ) as a function of the rate of time alarms ( the total time of alarms divided by the total time , in other words the fraction of time we declare that a crash or large correction is looming ) ( see also @xcite for extensions and reviews ) .",
    "the best predictor corresponds to a point close to the origin in this diagram , with almost no failure - to - predict and with a small fraction of time declared as dangerous : in other words , this ideal strategy misses no event and does not declare false alarms !",
    "these considerations teach us that making a prediction is one thing , using it is another which corresponds to solving a control optimization problem @xcite .      to assess quantitatively the prediction procedure described above",
    ", we thus construct an error diagram , plotting the failure to predict as a function of the total alarm duration .",
    "the targets to be predicted are defined as large drawdowns ( cumulative losses as defined in @xcite ) whose absolute values are greater than some given value @xmath121 .",
    "each drawdown has a duration covering a time interval @xmath122 $ ] . for a given alarm index threshold @xmath123 ,",
    "if there exist a time @xmath124 so that @xmath125 , then the drawdown is said to be successfully predicted ; in contrast , if @xmath126 for all @xmath127 , we say it is a failure .",
    "this definition ensures that the forecast occurs before the occurrence of the drawdown .",
    "the error diagram is obtained by varying the decision threshold @xmath123 .",
    "the quantity `` failure to predict '' is the ratio of the number of failures over the number of targets as said above .",
    "the total alarm duration is the total time covered by the objects whose alarm index is larger than @xmath123 divided by the total time . by varying the value of @xmath123 , we obtain different pairs of failure to predict and total alarm duration .",
    "figure [ fig5 ] presents the error diagram for two target definitions ( @xmath128 and @xmath129 ) for the djia with @xmath130 , @xmath131 and @xmath132 .",
    "the results do not change significantly as long as @xmath93 is much smaller than @xmath133 .",
    "the anti - diagonal corresponds to the completely random prediction scheme .",
    "the error diagrams with different @xmath134 , @xmath93 and @xmath133 are found to be similar , with small variations , showing a strong robustness of our construction .",
    "the inset shows the prediction gain , defined as the ratio of the fraction of targets correctly predicted ( equal to one minus the fraction of missed targets ) to the total alarm duration .",
    "theoretically , the prediction gain of a random prediction strategy is @xmath32 .",
    "the error diagram shows that half of the targets with @xmath129 are predicted with a very small alarm duration and all targets are predicted for an alarm duration less than 40% .",
    "this gives rise to large prediction gains for small alarm durations , confirming the very good quality of our predictors .",
    "confidence in this conclusion is enhanced by finding that the quality of the prediction increases as the targets are evolved toward largest losses ( @xmath135 loss for @xmath128 to @xmath136 loss for @xmath129 ) .",
    "this trend continues for largest losses but there are too few events to draw statistically meaningful conclusions for larger drawdowns of @xmath115 or more .",
    "the validity of our construction should be ascertained by testing it without modification on other independent time series . here , we present similar promising results obtained for the hong kong hang seng composite index ( hsi ) from 24-nov-1969 to present .",
    "the hong kong hang seng composite index is particularly interesting as it can be considered as a `` textbook '' example of an unending succession of bubbles and crashes @xcite .",
    "the nine biggest crashes since 24-nov-1969 were triggered approximately at the following dates : 20-sep-1971 , 5-mar-1973 , 04-sep-1978 , 13-nov-1980 , 01-oct-1987 , 15-may-1989 , 4-jan-1994 , 8-aug-1997 , and 28-mar-2000 . except for the last one which was posterior to the study published in @xcite ,",
    "all of them have been studied previously in @xcite .",
    "the distinctive properties of the first eight bubbles are consistent with those reported previously @xcite ( see page 461 concerning the parameters @xmath14 and @xmath77 ) .",
    "in contrast with ref .",
    "@xcite in which the positivity constraint was not considered , we find here that it plays a significant role in screening out solutions .",
    "we use the two crashes in 1987 and 1997 to train the parameters of our algorithm because they give the best defined log - periodic power law patterns over the longest time intervals .",
    "figure [ fig6 ] illustrates the typical result for the alarm index obtained with @xmath80 , @xmath137 and @xmath138 .",
    "four out of the five crashes that were not used in the training phase are identified very clearly by the alarm index peaks ( note that the first two crashes in 20-sep-1971 and 5-mar-1973 are omitted in our counting since they occur before the time when our alarm index can be constructed ) .",
    "this encouraging result seems to confirm the hypothesis that the seven crashes , posterior to 1976 where the alarm index can be defined , are triggered by endogenous stock market instabilities preceded by log - periodic power - law speculative bubbles @xcite .",
    "varying the values of the parameters @xmath65 , @xmath93 and @xmath133 of our algorithm gives results which are robust .",
    "in addition , one can identify more peaks in fig .",
    "[ fig6 ] and it is an interesting question to test whether they are associated with an anomaly in the market . in total , we count 15 peaks in fig .",
    "[ fig6 ] around 15-sep-1978 ( s ) , 09-apr-1980 ( ? ) , 29-sep-1981 ( f ) , 30-nov-1982 ( f ) , 01-oct-1986 ( ? ) , 30-sep-1987 ( s ) , 20-may-1989 ( s ) , 18-aug-1990 ( f ) , 09-oct-1991 ( f ) , 19-oct-1992 ( f ) , 28-oct-1993 ( s ) , 05-may-1996 ( ? ) , 06-aug-1997 ( s ) , 10-apr-1999 ( f ) , and 25-mar-2000 ( s ) , whose alarm indexes are greater than @xmath139 .",
    "six peaks whose dates are identified by `` s '' correspond to successful predictions , among which two are trivial since they were used in the training process .",
    "six peaks identified with `` f '' are false alarms . the remaining three peaks marked with `` ? ''",
    "are neither successful predictions nor complete false alarms as they fall close to crashes .",
    "the date with an alarm index of 0.1 on the east side of the first `` ? '' alarm peak is 31-jul-1980 and can probably be interpreted as a forerunner of the crash on 13-nov-1980 . the two other `` ? ''",
    "alarm peaks can probably interpreted as `` fore - alarms '' of two main alarm peaks used for training the algorithm .",
    "similar to fig .",
    "[ fig4 ] , fig .",
    "[ fig7 ] shows a superposed epoch analysis of the price trajectories a few years before and one year after these 15 peaks , to see whether our algorithm is able to generalize beyond the detection of crashes to detect changes of regimes .",
    "the ability to generalize is less obvious for the hang - seng index that it was for the djia shown in fig .",
    "[ fig4 ] .",
    "figure [ fig8 ] presents the error diagram for three target definitions ( @xmath128 , @xmath129 , and @xmath140 ) for the hsi with @xmath130 , @xmath141 and @xmath142 .",
    "the anti - diagonal corresponds to the random prediction scheme .",
    "again , the error diagrams with different @xmath134 , @xmath93 and @xmath133 are robust .",
    "the inset plots the corresponding prediction gains .",
    "more than half of the targets with @xmath143 are predicted with a very small alarm time and all targets are predicted for a finite alarm time less than 50% .",
    "these results are associated with a very significant predictability and strong prediction gains for small alarm durations .",
    "we find that different stock markets have slightly different characteristics : for instance , the parameters trained on the djia are not optimal for the hang - seng index .",
    "when we use the parameters obtained from the training of our algorithm on the djia on the hsi , we find that two of the seven crashes in the hsi are identified accurately ( 01-oct-1987 and 4-jan-1994 ) while the five other crashes are missed .",
    "interestingly , these two crashes are the most significant .",
    "this suggests the existence of a universal behavior only for the `` purest '' event cases , while smaller events exhibit more idiosyncratic behavior .",
    "as we have shown , training our algorithm on these two events on the hsi improves very significantly the prediction of the other events .",
    "this shows both a degree of universality of our procedure and the need to adapt to the idiosyncratic structure of each market .",
    "this situation is similar to that documented in earthquake predictions based on pattern recognition techniques @xcite .    how does the performance of our system compare with those of commonly used stochastic models of stock indices , such as garch ? to answer this question , we have used a standard method to calibrate a garch(1,1 ) model to the s&p500 .",
    "then , the garch model was run to provide a prediction of the volatility for the next period ( here taken in unit of days ) , but not of the sign of the next return ( which is unpredictable according to the garch model )",
    ". we found a quite strong predictability of the volatility `` predicted '' by garch by preceding large drops ( and often large ups ) of the market but not the reverse .",
    "in other words , garch is not predicting in any way future large drops , it is the other way around : large realized drops predict future large garch - predicted values of the volatility .",
    "actually , this is not surprising for two reasons : ( i ) from the structure of the garch model , a previous large daily drop ( or gain ) immediately increases the present amplitude of the volatility ; ( ii ) the fact that losses predict future increases of volatility ( and not the reverse ) has a rich literature associated with the `` leverage '' effect ( see for instance @xcite and references therein ) . thus , we can conclude that the garch model can in no way reproduce or even approach the detection of impending changes of regime as we have documented here .    in summary , we have developed a multiscale analysis on the analysis of stock market bubbles and crashes .",
    "based on a theory of investor imitation , we have integrated the log - periodic power - law patterns characteristic of speculative bubbles preceding financial crashes within a general pattern recognition approach .",
    "we have applied our approach to two financial time series , djia ( dow jones industrial average ) and hsi ( hang - seng hong kong index ) .",
    "training our algorithm on only a few crashes in each market , we have been able to predict the otherwise crashes not used in the training set .",
    "our work provides new evidence of the relevance of log - periodic power - law patterns in the evolution of speculative bubbles supporting the imitation theory .",
    "anifrani , j .- c . ,",
    "lefloch , c. , sornette , d. , & souillard , b. ( 1995 ) .",
    "universal log - periodic correction to renormalization - group scaling for rupture stress prediction from acoustic emissions , _ journal de physique i _ , 5 , 631 - 638 .",
    "blanchard , o.j .",
    ", & watson , m.w .",
    "bubbles , rational expectations and speculative markets , in : p. wachtel ( ed . ) , _ crisis in economic and financial structure : bubbles , bursts , and shocks_. lexington : lexington books .",
    "cecen , a.a . and erkal , c. ( 1996 ) .",
    "distinguishing between stochastic and deterministic behavior in high frequency foreign exchange rate returns : can non - linear dynamics help forecasting ?",
    ". j. forecasting _",
    "12(4 ) , 465 - 473 .",
    "gelfand , i.m . ,",
    "guberman , s.a .",
    ", keilis - borok , v.i . , knopoff , l. , press , f. , ranzman , e.y . ,",
    "rotwain , i.m . , & sadovsky , a.m. ( 1976 ) .",
    "pattern - recognition applied to earthquake epicenters in california , _ physics of the earth and planetary interiors _ , 11 , 227 - 283 .",
    "johansen , a. , & sornette , d. ( 2001 ) .",
    "bubbles and anti - bubbles in latin - american , asian and western stock markets : an empirical study , international journal of theoretical and applied finance 4 ( 6 ) , 853 - 920 .",
    "johansen , a. , & sornette , d. ( 2004 ) .",
    "endogenous versus exogenous crashes in financial markets , in press in `` contemporary issues in international finance '' ( nova science publishers ) .",
    "( http://arxiv.org/abs/cond-mat/0210509 )                                              sornette , d. ( 2002 ) predictability of catastrophic events : material rupture , earthquakes , turbulence , financial crashes , and human birth , _ procedings of the national academic sciences of the united states of america _ , 99 , 2522 - 2529 .",
    "zhou , w .- x . , &",
    "d. sornette ( 2003b ) .",
    "renormalization group analysis of the 2000 - 2002 anti - bubble in the us s&p 500 index : explanation of the hierarchy of five crashes and prediction , _ physica a _ 330 , 584 - 604 .",
    "density distribution @xmath144 of the dsi parameter @xmath14 obtained from eqn.([eq : lnpt ] ) and complementary cumulative distribution @xmath145 of the constraint parameter @xmath66 obtained from eqn.([positcond ] ) for the objects in classes i ( dotted , dashed , and dotted - dashed ) and ii ( continuous ) for three different values of @xmath65.,width=491 ]     alarm times @xmath19 ( or dangerous objects ) obtained by the multiscale analysis .",
    "the alarms satisfy @xmath146 , @xmath74 and @xmath147 simultaneously .",
    "the ordinate is the investigation `` scale '' in trading day unit .",
    "the results are robust with reasonable changes of these bounds . , width=491 ]       ( color online ) superposed epoch analysis of the 11 time intervals , each of 6 years long , of the djia index centered on the time of the maxima of the 11 predictor peaks above @xmath114 of the alarm index shown in fig .",
    "[ fig3].,width=491 ]     error diagram for our predictions for two definitions of targets to be predicted @xmath128 and @xmath129 obtained for the djia .",
    "the anti - diagonal line corresponds to the random prediction result .",
    "the inset shows the prediction gain.,width=491 ]     ( color online ) alarm index @xmath96 ( upper panel ) and the hong kong hang seng composite index from 1975 to 2003 ( lower panel ) .",
    "the vertical lines indicate the timing of the seven largest crashes .",
    "note that the first two crashes are not included in the analysis since the longest window used in our multiscale analysis is seven years.,width=491 ]     ( color online ) superposed epoch analysis of the 15 time intervals of the hsi index centered on the time of the maxima of the 15 peaks above @xmath148 of the alarm index shown in fig .",
    "[ fig6].,width=491 ]     error diagram of the predictions for three definitions of targets to be predicted with @xmath128 , @xmath129 , and @xmath140 in regard to hsi .",
    "the diagonal line is a random prediction . in the inset",
    "shows the prediction gains.,width=491 ]"
  ],
  "abstract_text": [
    "<S> we present a systematic algorithm testing for the existence of collective self - organization in the behavior of agents in social systems , with a concrete empirical implementation on the dow jones industrial average index ( djia ) over the 20th century and on hong kong hang seng composite index ( hsi ) since 1969 . </S>",
    "<S> the algorithm combines ideas from critical phenomena , the impact of agents expectation , multi - scale analysis and the mathematical method of pattern recognition of sparse data . trained on the three major crashes in djia of the century , </S>",
    "<S> our algorithm exhibits a remarkable ability for generalization and detects in advance 8 other significant drops or changes of regimes . </S>",
    "<S> an application to hsi gives promising results as well . </S>",
    "<S> the results are robust with respect to the variations of the recognition algorithm . </S>",
    "<S> we quantify the prediction procedure with error diagrams .    </S>",
    "<S> predictability of large future changes in major financial indices    didier sornette@xmath0 , wei - xing zhou@xmath1    1 .   </S>",
    "<S> institute of geophysics and planetary physics , university of california , los angeles , ca 90095[igpp ] 2 .   </S>",
    "<S> department of earth and space sciences , university of california , los angeles , ca 90095[ess ] 3 .   laboratoire de physique de la matire condense , cnrs umr 6622 and universit de nice - sophia antipolis , 06108 nice cedex 2 , france[lpec ]    correspondence should be address to d. sornette :    1693 geology building + institute of geophysics and planetary physics + university of california , los angeles + ca 90095 - 1567 , usa .    </S>",
    "<S> tel : + 1 - 310 - 825 - 2863 + fax : + 1 - 310 - 206 - 3051 . </S>",
    "<S> + _ </S>",
    "<S> e - mail address:_sornette@moho.ess.ucla.edu ( d. sornette )        predictability of large future changes in major financial indices    _ keywords _ : econophysics ; multiscale analysis ; pattern recognition ; predictability </S>"
  ]
}