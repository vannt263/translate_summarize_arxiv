{
  "article_text": [
    "motion estimation is a fundamental task for the analysis of spatiotemporal data , the prototypical example of which are sequences of images taken by a camera . the term _ optical flow _ has been coined to designate the apparent motion in such data . its accurate and efficient estimation has been a major topic in the fields of computer vision and image processing for more than 30 years . however , the applicability of optical flow algorithms is by no means limited to flat two - dimensional projections of real world scenes .",
    "the advance of microscopy techniques has led to a particularly promising application of optical flow : cell motion analysis .",
    "reliable optical flow algorithms supplied with microscopy images of sufficiently high spatial and temporal resolution can obviously help understanding cellular dynamics in transparent organisms , see for example @xcite .",
    "the particular dataset we are working with in this article depicts a living zebrafish embryo during early embryogenesis .",
    "main feature of this dataset are the embryo s endodermal cells , which have been labelled with a fluorescent protein and are known to develop on the surface of the zebrafish s spherical yolk , see fig .",
    "[ fig : data3d ] and sec .  [",
    "sec : data ] .",
    "the distribution of these cells can be modelled by a nonnegative function @xmath2 depending on time @xmath3 and position @xmath4 on the @xmath0-sphere , such that the number @xmath5 is directly proportional to the fluorescence response of a point @xmath4 at time @xmath3 .",
    "the models we propose below are motivated , but surely not restricted , to this specific type of data .",
    "we argue that the problem of extracting and analysing motion from spherical data is sufficiently general so as to be of potential interest to a wider audience .",
    "degrees around the @xmath6-axis .",
    "see sec .",
    "[ sec : experiments ] for more details on the data and preprocessing.,title=\"fig:\",scaledwidth=49.0% ]   degrees around the @xmath6-axis .",
    "see sec .",
    "[ sec : experiments ] for more details on the data and preprocessing.,title=\"fig:\",scaledwidth=49.0% ] +   degrees around the @xmath6-axis .",
    "see sec .",
    "[ sec : experiments ] for more details on the data and preprocessing.,title=\"fig:\",scaledwidth=49.0% ]   degrees around the @xmath6-axis .",
    "see sec .",
    "[ sec : experiments ] for more details on the data and preprocessing.,title=\"fig:\",scaledwidth=49.0% ] +    our motion models are based on the optical flow equation @xmath7 which every vector field @xmath8 describing the temporal evolution of @xmath2 should ( approximately ) satisfy for all @xmath4 and @xmath3 . here",
    "@xmath9 denotes the surface gradient on the sphere .",
    "we derive this equation in more detail in sec .  [",
    "sec : of ] . directly solving the optical flow equation for @xmath8",
    "is infeasible .",
    "we therefore use tikhonov regularisation to compute an approximate solution to .",
    "tikhonov regularisation consists in minimising a functional which is a weighted sum of two terms .",
    "the first one , usually called data or similarity term , is the squared @xmath10 norm of the left hand side of .",
    "the second term is a regularising functional @xmath11 , which in this article will always be a sobolev @xmath12 norm ( sec .",
    "[ sec : reg ] ) .",
    "these norms are introduced in sec .",
    "[ sec : sobolev ] .",
    "next , we extend the motion estimation method outlined above to two types of decomposition models that are also variational in nature ( sec .  [",
    "sec : decomposition ] ) .",
    "while the input of those is again @xmath2 , their outputs are now two or more vector fields capturing different structural parts of the total motion .",
    "both models are adaptations of recently proposed image decomposition techniques to the optical flow setting .",
    "the first one is a @xmath1 decomposition .",
    "its idea is to replace @xmath8 in the data term with a sum @xmath1 , and then to add two different regularising functionals , one for @xmath8 and one for @xmath13 .",
    "the second one is a hierarchical model . roughly speaking",
    ", one repeatedly minimises an optical flow functional , while the amount of regularisation is constantly decreased . in every iteration ,",
    "the @xmath8 in the data term is replaced by a sum @xmath14 , where only @xmath8 is optimised and the @xmath15 are the results from previous iterations .",
    "finally , all optimisation problems are solved by projecting them onto finite dimensional spaces spanned by vector spherical harmonics ( sec .",
    "[ sec : numerics ] ) .",
    "one advantage of this method is that it automatically yields helmholtz decompositions of all computed vector fields . mathematical background on ( vector )",
    "spherical harmonics is presented in secs .",
    "[ sec : sh ] and [ sec : vsh ] . in sec .",
    "[ sec : experiments ] we provide details of our implementation , give a more detailed account of the used microscopy data , and show experimental results with these data .",
    "to summarise , the main novelties presented in this article are decomposition models for optical flow on the sphere together with their application to microscopy data .      the first variational optical flow method is usually attributed to @xcite , where they used an @xmath16 seminorm for regularisation . in @xcite",
    "it was shown that this particular choice leads to a well - posed problem .",
    "we refer to @xcite for a gentle introduction to optical flow , to @xcite for an overview of different optical flow functionals and to @xcite for a recent survey and benchmark .",
    "optical flow algorithms have only recently been extended to data defined on non - euclidean domains . in @xcite images defined on the sphere were treated , whereas in @xcite the original functional by horn and schunck was generalised to @xmath0-riemannian manifolds and well - posedness was verified .",
    "most recently , optical flow on evolving manifolds has been considered in @xcite .",
    "horn and schunck @xcite numerically solved the variational problem by applying a finite difference scheme to the euler - lagrange equations .",
    "a similar approach was adopted in @xcite after parametrisation of the surface . in @xcite , however , the problem was solved by finite elements on a surface triangulation .",
    "finally , we mention the work by schuster and weickert @xcite , where they used projection methods to solve the optical flow equation in the plane . instead of tikhonov - regularising their solution , they solely relied on regularisation by discretisation .",
    "the main reason for choosing a numerical method based on vector spherical harmonics in this article is that @xmath12-type regularisers , for arbitrary real @xmath17 , are handled very easily in contrast to most other methods .",
    "the aim of @xmath1 image decomposition models , as pioneered in @xcite , is to separate the cartoon and texture parts of images . while the cartoon component should capture large - scale structural components and",
    "should therefore be piecewise smooth , the texture component is supposed to consist of high - frequency oscillating patterns . since the original model was promising but hard to implement , a large number of modifications and approximations have been proposed . in some of them",
    "the problematic @xmath18-norm was approximated by an @xmath19 norm @xcite .",
    "recently , @xmath1 models have been extended to the @xmath20 optical flow setting @xcite .",
    "hierarchical models , originally introduced in @xcite for image analysis , have not yet been tried in combination with optical flow .",
    "they have , however , the preferable property of producing arbitrarily fine multiscale descriptions of input data . as a concluding remark about vector field decompositions ,",
    "let us remark that helmholtz - hodge decompositions of motion fields have enjoyed a certain degree of attention in recent years , not only in the plane @xcite , but also on surfaces @xcite .",
    "applying optical flow algorithms to cell microscopy data has become increasingly popular lately .",
    "see for example @xcite and the references therein .",
    "we highlight the article @xcite , where also endodermal cells of zebrafish embryos have been analysed .",
    "there the authors point out that , although of immense importance for developmental biology , only little is known about the motion behaviour of this type of cells .",
    "let @xmath21 be the two - sphere embedded in @xmath22 . for functions @xmath23 we define the laplace - beltrami operator by @xmath24 where @xmath25 is the usual laplacian of @xmath22 and @xmath26 is the radially constant extension of @xmath2 to @xmath27 .",
    "the eigenvalues of @xmath28 are @xmath29 the corresponding eigenspaces @xmath30 have dimension @xmath31 and are mutually orthogonal in @xmath32 .",
    "their direct sum equals @xmath32 .",
    "every eigenfunction @xmath33 lies in @xmath34 and is called _ ( scalar ) spherical harmonic of degree _ @xmath35 .",
    "their name derives from the equivalent characterisation of @xmath30 as the restriction to @xmath36 of the space of harmonic polynomials @xmath37 that are homogeneous of degree @xmath35 . from now on @xmath38 always refers to a particular orthonormal basis of @xmath32 consisting of real - valued spherical harmonics . for numerical experiments we use the so - called fully normalised spherical harmonics ,",
    "see ( * ? ? ?",
    "5.2 ) for a detailed construction .",
    "denote by @xmath39 the outward unit normal to @xmath36 and let @xmath40 be the surface gradient of @xmath23 .",
    "[ def : vsh ] let @xmath41 and @xmath33 . whenever a function @xmath42 that does not vanish identically admits one of the following three representations @xmath43",
    "then @xmath44 is called a _ vector spherical harmonic of degree @xmath35 and type @xmath45_. for obvious reasons we refer to types @xmath0 and @xmath46 as _ tangential vector spherical harmonics_.    note that there is no tangential spherical harmonic of degree @xmath47 .    .",
    "scalar spherical harmonics are depicted using a blue to red colour bar .",
    "type @xmath0 vector spherical harmonics are visualised with red arrows , type @xmath46 ones with blue arrows .",
    "note that the length of the vectors has been scaled for better illustration.,title=\"fig:\",scaledwidth=49.0% ] .",
    "scalar spherical harmonics are depicted using a blue to red colour bar .",
    "type @xmath0 vector spherical harmonics are visualised with red arrows , type @xmath46 ones with blue arrows .",
    "note that the length of the vectors has been scaled for better illustration.,title=\"fig:\",scaledwidth=49.0% ] + .",
    "scalar spherical harmonics are depicted using a blue to red colour bar .",
    "type @xmath0 vector spherical harmonics are visualised with red arrows , type @xmath46 ones with blue arrows .",
    "note that the length of the vectors has been scaled for better illustration.,title=\"fig:\",scaledwidth=49.0% ] .",
    "scalar spherical harmonics are depicted using a blue to red colour bar .",
    "type @xmath0 vector spherical harmonics are visualised with red arrows , type @xmath46 ones with blue arrows .",
    "note that the length of the vectors has been scaled for better illustration.,title=\"fig:\",scaledwidth=49.0% ] + .",
    "scalar spherical harmonics are depicted using a blue to red colour bar .",
    "type @xmath0 vector spherical harmonics are visualised with red arrows , type @xmath46 ones with blue arrows .",
    "note that the length of the vectors has been scaled for better illustration.,title=\"fig:\",scaledwidth=65.0% ]    we are mainly interested in the space @xmath48 of square integrable tangent vector fields on @xmath36 endowed with the inner product @xmath49 where @xmath50 is the usual surface measure on the sphere .",
    "an orthonormal basis of this space is obtained from by setting @xmath51 for all @xmath52 and @xmath53 . in fig .",
    "[ fig : vspharm ] a handful of the elements of both bases and are depicted .",
    "every @xmath54 has the following fourier series representation @xmath55 in particular , we have parseval s identity @xmath56 for a comprehensive and unified treatment of both scalar and vector spherical harmonics we refer to @xcite .      for an arbitrary real number @xmath17 , the space @xmath57 is commonly defined as the domain of @xmath58 .",
    "see @xcite or ( * ? ? ?",
    "6.2 ) for example . in this section",
    "we introduce the spaces @xmath59 by means of the vectorial counterpart of @xmath60 .    for tangent vector fields",
    "@xmath13 we define the laplace - beltrami operator by @xmath61 where application of @xmath60 to @xmath13 is understood componentwise and @xmath62 is the orthogonal projector onto the tangent plane @xmath63 , compare ( * ? ? ?",
    "* def .  5.26 ) .",
    "the tangential vector spherical harmonics introduced in def .  [ def : vsh ] are eigenfunctions of this operator to the same eigenvalues as their scalar counterparts : if we let @xmath64 then @xmath65 for every @xmath66 .",
    "the @xmath67 are as defined in , the only difference being that now @xmath68 and therefore the spectrum of @xmath69 is strictly positive . applying functional calculus , we formally define the @xmath17-th power of @xmath69 by @xmath70 finally , for every @xmath71 , set @xmath72 note that , in contrast to the scalar setting , this functional is an actual norm , rather than only a seminorm .",
    "we therefore define , for every real @xmath17 , @xmath59 as the space of all distributions @xmath73 for which the series in is finite . clearly , if @xmath74 is any sequence satisfying @xmath75 for two positive constants @xmath76 , @xmath77 and for all @xmath35 , then replacing @xmath78 with @xmath79 in leads to an equivalent norm and thus to the same space . for every sequence of positive numbers",
    "@xmath79 we denote the resulting norm simply by @xmath80 .",
    "let @xmath81 \\subset \\mathbb{r}$ ] be a time interval . we assume to be given a scalar time - varying ( brightness ) function @xmath82 the problem of estimating optical flow",
    "consists in tracking the temporal evolution of the data @xmath2 by means of a time - dependent vector field .",
    "our optical flow model is based on the so - called _ brightness constancy assumption _ : we assume existence of a function @xmath83 satisfying @xmath84 for all @xmath4 and @xmath3 . intuitively this means that for every starting point @xmath4 on the sphere , the function @xmath2 remains constant along the trajectory @xmath85 .",
    "in addition we require that @xmath86 is a diffeomorphism of @xmath36 for every @xmath3 .",
    "the first equation in   implies that @xmath87 this equation is typically written in terms of the vector field @xmath88 whose integral curves are the trajectories @xmath85 , which is defined by the equation @xmath89 . the resulting _ optical flow equation",
    "_ reads @xmath90      solving the optical flow equation directly is problematic . in general , a solution to need not exist , and if it exists , it can not be unique .",
    "the typical remedy is tikhonov regularisation , where one minimises a functional of the form @xmath91 with @xmath92 being a regularising functional that incorporates a - priori knowledge about desirable solutions .",
    "the parameter @xmath93 controls the amount of regularisation . in the context of optical flow one",
    "usually tries to enforce spatial ( and temporal ) smoothness on the solution .",
    "a natural candidate for @xmath92 would then be the squared sobolev @xmath94 ( semi-)norm , which penalises first derivatives in space and time equally , compare @xcite    another , and in fact more popular , possibility is to drop time regularisation , in which case minimisation of is equivalent to minimising @xmath95 for each instant @xmath3 separately .",
    "this corresponds to the original approach of horn and schunck @xcite .",
    "from now on we denote the above data term by @xmath96 . instead of we consider the more general class of optical flow functionals",
    "@xmath97 the regularisation parameter is omitted , as it can be considered a constant factor in the sequence @xmath74 .",
    "functional forms the basic optical flow setting of this article .",
    "all variational models considered here are extensions of .",
    "the following two decomposition models are inspired by techniques that have recently been developed in the context of image analysis .",
    "the fact that motion estimation based on can be viewed as denoising of vector - valued images suggests the translation of said image decomposition models to the optical flow setting @xcite .",
    "the aim is now not to extract one , but two vector fields @xmath8 and @xmath13 in such a way that they capture different structural parts of the total motion @xmath98 of @xmath2 .",
    "the idea is to solve the following variational problem @xmath99 choosing , for instance , the two regularisers to be @xmath100 and @xmath101 norms , respectively , would lead to a model which , in spirit , comes closest to the image decomposition model considered in @xcite . generalising to a decomposition into @xmath102 , instead of two , constituents is possible , but will not be considered here @xcite .",
    "hierarchical image decomposition models have been introduced in @xcite . there",
    ", an original image is decomposed by repeatedly applying denoising steps .",
    "the input of one such step is the residual of the previous one . in every step the degree of regularisation",
    "is decreased .",
    "in contrast to @xmath1 models , hierarchical decomposition models provide multiscale descriptions of the input data .    this iterative procedure can be transferred to the optical flow setting as follows .",
    "let @xmath103 , @xmath104 , be a sequence of norms as defined in section [ sec : sobolev ] , such that @xmath105 for all @xmath35 and @xmath106 . for every such sequence of sequences",
    "we propose the following iterative scheme , @xmath107 the resulting sequence of accumulated solutions @xmath108 provides a multiscale representation which , with an appropriate choice of sequences @xmath109 , can be made arbitrarily fine .",
    "the hierarchical model as formulated above is a slight generalisation of the originally proposed one , in the sense that the sequences of regularising functionals considered in @xcite are always of the form @xmath110 .",
    "that is , the regularising functional of step @xmath106 is the same as the one of previous steps save for a smaller regularisation parameter .",
    "requirement allows a more general setup .",
    "the helmholtz decomposition theorem states that every continuously differentiable tangent vector field @xmath111 on the sphere can be uniquely represented as the sum of a consoidal ( curl - free ) and a toroidal ( divergence - free ) vector field . more precisely , there exist two uniquely determined tangent vector fields @xmath112 and @xmath113 satisfying @xmath114 see ( * ? ? ?",
    "5.3 ) , for example .",
    "the projection method we use to numerically solve the variational problems presented above leads to solutions @xmath111 that are finite fourier sums @xmath115 where @xmath116 .",
    "now , from the definition of basis , and the fact that @xmath117 for all sufficiently smooth functions @xmath118 , the helmholtz decomposition of @xmath111 is obtained immediately @xmath119",
    "in the first subsection below we describe the numerical optimisation of the optical flow functional based on the optical flow equation and explain the modifications necessary for the hierarchical decomposition .",
    "subsection [ sec : u+v_num ] is dedicated to the @xmath1 decomposition model .",
    "finally , we explain how the resulting spherical integrals are approximated ( sec .",
    "[ sec : discretisation ] ) .    for convenience",
    "we relabel the orthonormal basis using a single index @xmath120 and write , for example , @xmath121 from now on .",
    "let @xmath122 and let @xmath74 be a sequence comparable to @xmath123 in the sense of .",
    "then , a minimiser of @xmath124 , if it exists , has to be in @xmath59 .",
    "we solve the problem of finding @xmath125 by a projection method .",
    "that is , we let @xmath8 range only over a finite - dimensional subspace @xmath126 of @xmath59 , where @xmath127 and @xmath128 is a finite index set .",
    "the unknown vector field can now be written as @xmath129 and the problem of finding an optimal @xmath130 simplifies to a minimisation problem over @xmath131 . plugging into the optical flow functional gives",
    "@xmath132 which is minimal , if the optimality conditions @xmath133 , for all @xmath134 , are satisfied .",
    "they read @xmath135 or in matrix - vector form @xmath136 where @xmath137 is the vector of unknown coefficients , the elements of matrix @xmath138 read @xmath139 @xmath140 is a diagonal matrix that corresponds to the regularisation term and the right hand side @xmath141 is given by @xmath142 with a slight abuse of notation we identified the set @xmath143 with @xmath144 in the definitions of @xmath145 .",
    "we continue to do so below .",
    "the hierarchical model only needs a minor modification for the case @xmath146 .",
    "we can rewrite the data term from as @xmath147 where @xmath148 .",
    "therefore , only the right hand side of the optimality system has to be updated in every step .",
    "for simplicity we can assume that the approximation space @xmath126 is the same in every step , so that @xmath149 has the representation @xmath150 , where the coefficients @xmath151 are already known from previous steps .",
    "letting @xmath152 denote the right hand side of the optimality system for step @xmath106 , we calculate @xmath153 or simply @xmath154      the projection approach explained above is easily adapted to the @xmath1 decomposition problem . again , let @xmath155 be real numbers and choose two sequences @xmath74 , @xmath156 so that @xmath157 is a norm for @xmath158 and @xmath159 is one for @xmath59 .",
    "now , we solve @xmath160 where @xmath161 are finite dimensional spaces . proceeding as in the previous section ,",
    "we obtain the following optimality conditions @xmath162 where the coefficients @xmath163 and @xmath164 are as defined in and , respectively .",
    "concatenating the two coefficient vectors @xmath165 and @xmath166 into a single vector @xmath167 , so that the @xmath168 occupy the first @xmath169 entries while the @xmath170 occupy the last @xmath171 entries , the linear system reads @xmath172 the matrix @xmath173 is given by @xmath174 where @xmath175 and @xmath176 is concatenated from two versions of @xmath177 in the same way as @xmath111 .",
    "it remains to discuss the numerical evaluation of the integrals , .",
    "first , we approximate the @xmath0-sphere @xmath36 with a polyhedron @xmath178 defined by a set @xmath179 of vertices and a set @xmath180 of triangular faces .",
    "each triangle @xmath181 is associated with a tuple @xmath182 identifying the corresponding vertices @xmath183 . how the triangulated sphere is obtained in practice ,",
    "is explained in sec .",
    "[ sec : acquisition ] .",
    "second , in every experiment data @xmath2 are given only at the vertices and for two time steps @xmath184 and @xmath185 .",
    "we set @xmath186 and @xmath187 and extend both functions to all of @xmath188 by linear interpolation on every triangle .",
    "thus we obtain two continuous piecewise linear functions @xmath189 , @xmath190 .",
    "the time derivative of @xmath2 is approximated by a simple forward difference @xmath191 which is again piecewise linear on @xmath188 .",
    "the surface gradient @xmath192 is replaced by a vector field @xmath193 that is constant on every triangle .",
    "it is given by    @xmath194    where @xmath195 is the height vector of the triangle @xmath196 pointing from vertex @xmath197 to the opposite side , compare ( * ? ? ?",
    "3.3.3 ) .",
    "finally , we also replace the fully normalised scalar spherical harmonics @xmath198 by their piecewise linear approximations @xmath199 defined on @xmath188 . as before we obtain piecewise constant approximations @xmath200 of @xmath201 .",
    "the resulting approximated integrals read @xmath202 where @xmath203 denotes the area of @xmath204 , and @xmath205",
    "the data which motivated the study of the proposed decomposition models are time - lapse volumetric ( 4d ) images .",
    "the obtained sequence depicts a live zebrafish embryo during the gastrula period , approximately five to ten hours after fertilisation . with the help of confocal laser - scanning microscopy ,",
    "endoderm cells expressing a green fluorescence protein were recorded separately from the background . for details on the imaging techniques and the fluorescence marker we refer to  @xcite and  @xcite , respectively .",
    "the sequence obtained by the microscope captures a cuboid region of approximately @xmath206 .",
    "the spatial resolution is @xmath207  voxels and the intensity is in the range @xmath208 .",
    "a total number of 77 images were taken , one every @xmath209 . in the following",
    ", the microscopic data will be denoted by @xmath210    during this early stage , endodermal cell proliferation is known to take place on a so - called monolayer  @xcite . in other words , cells move and divide without stacking and , as the yolk is ball - shaped , admit for the extraction of a spherical image sequence . for further explanations and numerous illustrations of the developmental process of zebrafish embryos",
    "we refer to  @xcite .",
    "we extracted spherical images from the dataset by first fitting a sphere to the approximate cell centres in each pair of consecutive frames .",
    "for simplicity we restrict our attention to one such pair of frames which we denote by @xmath211 .",
    "cell centres are typically characterised by local maxima in intensity and can be found by applying a gaussian filter and simple thresholding . without loss of generality the radius of the fitted sphere",
    "is assumed to be @xmath212 . in a second step ,",
    "we created a point grid @xmath213 starting from an icosahedron inscribed in the sphere . in each iteration",
    "every triangular face is split into four sub - triangles by connecting the edge midpoints with each other and projecting them onto the sphere .",
    "thus , the total number of faces is @xmath214 , where @xmath106 is the number of refinements . in our experiments we found that @xmath215 iterations suffice .    in order to project the volumetric time - lapse data @xmath216 , onto the grid @xmath217",
    ", we define @xmath218 } \\bar{f}_j^{\\delta}(c v_{i}),\\ ] ] for the said pair of consecutive frames @xmath219 . here",
    "@xmath220 is a piecewise linear extension to @xmath22 of @xmath216 and @xmath221 is sufficiently large .",
    "deviations of the monolayer from a perfect sphere are thereby corrected .",
    "the obtained data are subsequently scaled to the range @xmath222 $ ] .",
    "note that , in contrast to our previous work  @xcite , here we consider the unfiltered microscopy data for optical flow estimation .",
    "the support of the obtained data is contained in the northern hemisphere .",
    "thus , it suffices to consider only half of the triangulation leading to a total number of around 164000 faces .",
    "figure  [ fig : data3d ] depicts a sample of two frames @xmath223 . in fig .",
    "[ fig : data2d ] , a top view of the two frames is shown .               in order to visualise our results",
    "we will apply the standard flow colour - coding  @xcite using a colour disk .",
    "figure  [ fig : colourcoding ] ( rightmost image ) depicts this colour space .",
    "each vector is assigned a colour determined by its angle and length . however , this colour - coding is defined for planar vector fields only . as a possible remedy",
    "we suggest to first project tangential velocities to the plane and then correct the length . to this end , let @xmath224 be the orthogonal projector of @xmath22 onto the @xmath225-@xmath226-plane . accordingly , given a tangent vector field @xmath13 , the planar vector field which we visualise is @xmath227 this construction is chosen so that it preserves the length of @xmath13 .",
    "this additional rescaling is different to  @xcite .",
    "the resulting colour image is finally mapped back onto the hemisphere .",
    "[ fig : colourcoding ] shows a tangent vector field visualised with the proposed approach . from now on we will visualise velocity fields only in top view , as in the right hand side of fig .",
    "[ fig : colourcoding ] .",
    "in addition , for every figure the colour disk s radius @xmath228 was chosen to be equal to the length of the longest vector under consideration .",
    "specific values of @xmath228 are given in table  [ tab : radii ] .    .radii",
    "@xmath228 of the colour disks used in the different experiments below . [ cols=\"<,<,<,<,<,<,<,<,<,<,<\",options=\"header \" , ]     as a second way of illustrating steady velocity fields , we employ streamlines , see e.g.  @xcite . in all our experiments we consider time as fixed and compute the optical flow @xmath13 for one pair of frames , cf .",
    "[ sec : reg ] . given a tangential velocity field @xmath13 and a starting point @xmath229 ,",
    "a streamline @xmath230 on @xmath36 is the solution to the ordinary differential equation @xmath231 numerically , we approximated   by solving @xmath232 where @xmath233 is a step size , for a number of approximately 1300 initial points @xmath234 and @xmath235 iterations .",
    "the step size was chosen as @xmath236 .",
    "this use of integral curves is different from  @xcite , where we computed approximate cell trajectories in a nonsteady velocity field .",
    "the visualisation by means of the colour coding is rich in detail and is even capable of indicating individual cell motion .",
    "nevertheless , it fails to deliver intuition about the helmholtz decomposition .",
    "streamlines provide the anticipated effect .",
    "we performed numerous experiments and minimised functionals  ,  , and   as outlined in sec .",
    "[ sec : numerics ] for the two frames shown in fig .",
    "[ fig : data3d ] and fig .",
    "[ fig : data2d ] . in all experiments the finite - dimensional spaces introduced in sec .",
    "[ sec : numerics ] were chosen as @xmath237 all resulting linear systems were solved using the generalized minimal residual method ( gmres ) on an intel xeon e5 - 1620 @xmath238 workstation with @xmath239  ram .",
    "solutions converged to a relative residual of 0.02 within 100 iterations .",
    "the runtime was governed by the evaluation of the integrals , cf .",
    "[ sec : discretisation ] , and amounts to approximately five hours for the chosen bases and the chosen triangulation .",
    "nevertheless , once the integrals are computed they can be used in all of the proposed models and the linear systems can be solved in a few seconds for different parameters and different norms .",
    "our matlab implementation and the data are available on our website .",
    "( top ) , with @xmath240 , @xmath241 , and increasing values @xmath242 , @xmath243 , and @xmath244 from left to right .",
    "the middle row depicts the curl - free component whereas the bottom row depicts the divergence - free component .",
    "the embryo s body axis roughly runs from bottom left to top right in all images.,title=\"fig:\",scaledwidth=32.0% ]   ( top ) , with @xmath240 , @xmath241 , and increasing values @xmath242 , @xmath243 , and @xmath244 from left to right .",
    "the middle row depicts the curl - free component whereas the bottom row depicts the divergence - free component .",
    "the embryo s body axis roughly runs from bottom left to top right in all images.,title=\"fig:\",scaledwidth=32.0% ]   ( top ) , with @xmath240 , @xmath241 , and increasing values @xmath242 , @xmath243 , and @xmath244 from left to right .",
    "the middle row depicts the curl - free component whereas the bottom row depicts the divergence - free component .",
    "the embryo s body axis roughly runs from bottom left to top right in all images.,title=\"fig:\",scaledwidth=32.0% ] +   ( top ) , with @xmath240 , @xmath241 , and increasing values @xmath242 , @xmath243 , and @xmath244 from left to right .",
    "the middle row depicts the curl - free component whereas the bottom row depicts the divergence - free component .",
    "the embryo s body axis roughly runs from bottom left to top right in all images.,title=\"fig:\",scaledwidth=32.0% ]   ( top ) , with @xmath240 , @xmath241 , and increasing values @xmath242 , @xmath243 , and @xmath244 from left to right .",
    "the middle row depicts the curl - free component whereas the bottom row depicts the divergence - free component .",
    "the embryo s body axis roughly runs from bottom left to top right in all images.,title=\"fig:\",scaledwidth=32.0% ]   ( top ) , with @xmath240 , @xmath241 , and increasing values @xmath242 , @xmath243 , and @xmath244 from left to right .",
    "the middle row depicts the curl - free component whereas the bottom row depicts the divergence - free component .",
    "the embryo s body axis roughly runs from bottom left to top right in all images.,title=\"fig:\",scaledwidth=32.0% ] +   ( top ) , with @xmath240 , @xmath241 , and increasing values @xmath242 , @xmath243 , and @xmath244 from left to right .",
    "the middle row depicts the curl - free component whereas the bottom row depicts the divergence - free component .",
    "the embryo s body axis roughly runs from bottom left to top right in all images.,title=\"fig:\",scaledwidth=32.0% ]   ( top ) , with @xmath240 , @xmath241 , and increasing values @xmath242 , @xmath243 , and @xmath244 from left to right .",
    "the middle row depicts the curl - free component whereas the bottom row depicts the divergence - free component .",
    "the embryo s body axis roughly runs from bottom left to top right in all images.,title=\"fig:\",scaledwidth=32.0% ]   ( top ) , with @xmath240 , @xmath241 , and increasing values @xmath242 , @xmath243 , and @xmath244 from left to right .",
    "the middle row depicts the curl - free component whereas the bottom row depicts the divergence - free component .",
    "the embryo s body axis roughly runs from bottom left to top right in all images.,title=\"fig:\",scaledwidth=32.0% ]    . with increasing parameter @xmath245 the streamlines change colours from yellow ( bright ) to green ( dark ) .",
    "the top row shows the total motion whereas middle and bottom rows depict the curl - free and divergence - free parts of the helmholtz decomposition , respectively .",
    "images are arranged in accordance with fig .",
    "[ fig : of1].,title=\"fig:\",scaledwidth=32.0% ] . with increasing parameter @xmath245 the streamlines change colours from yellow ( bright ) to green ( dark ) .",
    "the top row shows the total motion whereas middle and bottom rows depict the curl - free and divergence - free parts of the helmholtz decomposition , respectively .",
    "images are arranged in accordance with fig .",
    "[ fig : of1].,title=\"fig:\",scaledwidth=32.0% ] . with increasing parameter @xmath245 the streamlines change colours from yellow ( bright ) to green ( dark ) .",
    "the top row shows the total motion whereas middle and bottom rows depict the curl - free and divergence - free parts of the helmholtz decomposition , respectively .",
    "images are arranged in accordance with fig .",
    "[ fig : of1].,title=\"fig:\",scaledwidth=32.0% ] + . with increasing parameter @xmath245 the streamlines change colours from yellow ( bright ) to green ( dark ) .",
    "the top row shows the total motion whereas middle and bottom rows depict the curl - free and divergence - free parts of the helmholtz decomposition , respectively .",
    "images are arranged in accordance with fig .",
    "[ fig : of1].,title=\"fig:\",scaledwidth=32.0% ] . with increasing parameter @xmath245 the streamlines change colours from yellow ( bright ) to green ( dark ) .",
    "the top row shows the total motion whereas middle and bottom rows depict the curl - free and divergence - free parts of the helmholtz decomposition , respectively .",
    "images are arranged in accordance with fig .",
    "[ fig : of1].,title=\"fig:\",scaledwidth=32.0% ] . with increasing parameter @xmath245 the streamlines change colours from yellow ( bright ) to green ( dark ) .",
    "the top row shows the total motion whereas middle and bottom rows depict the curl - free and divergence - free parts of the helmholtz decomposition , respectively .",
    "images are arranged in accordance with fig .",
    "[ fig : of1].,title=\"fig:\",scaledwidth=32.0% ] + . with increasing parameter @xmath245 the streamlines change colours from yellow ( bright ) to green ( dark ) .",
    "the top row shows the total motion whereas middle and bottom rows depict the curl - free and divergence - free parts of the helmholtz decomposition , respectively .",
    "images are arranged in accordance with fig .",
    "[ fig : of1].,title=\"fig:\",scaledwidth=32.0% ] . with increasing parameter @xmath245 the streamlines change colours from yellow ( bright ) to green ( dark ) .",
    "the top row shows the total motion whereas middle and bottom rows depict the curl - free and divergence - free parts of the helmholtz decomposition , respectively .",
    "images are arranged in accordance with fig .",
    "[ fig : of1].,title=\"fig:\",scaledwidth=32.0% ] . with increasing parameter @xmath245 the streamlines change colours from yellow ( bright ) to green ( dark ) .",
    "the top row shows the total motion whereas middle and bottom rows depict the curl - free and divergence - free parts of the helmholtz decomposition , respectively .",
    "images are arranged in accordance with fig .",
    "[ fig : of1].,title=\"fig:\",scaledwidth=32.0% ]    in the first experiment , we minimised functional @xmath124 as defined in   for @xmath240 and different values of @xmath17 and @xmath246 . figure  [ fig : of1 ] , top row , depicts the optical flow field for @xmath241 and values @xmath242 , @xmath243 , and @xmath244 .",
    "the presented results are in accordance with our findings in  @xcite . as explained in sec .",
    "[ sec : decomposition ] , a helmholtz decomposition @xmath247 is obtained immediately .",
    "figure  [ fig : of1 ] , middle row , shows @xmath112 whereas fig .",
    "[ fig : of1 ] , bottom row , shows @xmath113 . furthermore , in fig .",
    "[ fig : of1stream ] , streamlines for the same velocity fields are portrayed and the individual plots are arranged accordingly . in addition , fig .  [",
    "fig : of2 ] shows the velocity fields for parameters @xmath248 , @xmath243 , @xmath249 , and @xmath250 .",
    "are shown in the top row .",
    "parameters were chosen as @xmath248 and @xmath243 , @xmath249 , and @xmath250 and are arranged from left to right .",
    "the bottom row depicts the corresponding streamlines.,title=\"fig:\",scaledwidth=32.0% ]   are shown in the top row .",
    "parameters were chosen as @xmath248 and @xmath243 , @xmath249 , and @xmath250 and are arranged from left to right .",
    "the bottom row depicts the corresponding streamlines.,title=\"fig:\",scaledwidth=32.0% ]   are shown in the top row .",
    "parameters were chosen as @xmath248 and @xmath243 , @xmath249 , and @xmath250 and are arranged from left to right .",
    "the bottom row depicts the corresponding streamlines.,title=\"fig:\",scaledwidth=32.0% ] +   are shown in the top row .",
    "parameters were chosen as @xmath248 and @xmath243 , @xmath249 , and @xmath250 and are arranged from left to right .",
    "the bottom row depicts the corresponding streamlines.,title=\"fig:\",scaledwidth=32.0% ]   are shown in the top row .",
    "parameters were chosen as @xmath248 and @xmath243 , @xmath249 , and @xmath250 and are arranged from left to right .",
    "the bottom row depicts the corresponding streamlines.,title=\"fig:\",scaledwidth=32.0% ]   are shown in the top row .",
    "parameters were chosen as @xmath248 and @xmath243 , @xmath249 , and @xmath250 and are arranged from left to right .",
    "the bottom row depicts the corresponding streamlines.,title=\"fig:\",scaledwidth=32.0% ]      in a next experiment , we computed a minimiser for functional   in order to obtain a @xmath98 decomposition of the optical flow .",
    "the sequences @xmath251 and @xmath252 were chosen as @xmath253 and @xmath254 , respectively . in figs .",
    "[ fig : u+v ] and  [ fig : u+v2 ] , the resulting decomposition is shown for two different parameter settings .",
    "the motion field in fig .",
    "[ fig : u+v ] was obtained with parameters @xmath255 , @xmath256 , @xmath257 , and @xmath258 . as anticipated ,",
    "@xmath8 and @xmath13 capture different structural parts of the motion .",
    "@xmath8 is sufficiently smooth whereas @xmath13 contains spatial oscillations .",
    "the result in fig .",
    "[ fig : u+v2 ] was computed by setting @xmath259 , @xmath256 , @xmath260 , and @xmath261 .",
    "expectedly , the velocity field @xmath8 is , by choice of @xmath262 , smoother than in the previous setting .",
    "in addition , fig .",
    "[ fig : detail ] illustrates the characteristics of the velocity fields during a cell division in more detail .",
    "while @xmath8 is smooth , @xmath13 clearly indicates the cell division .",
    "( left ) into structural parts @xmath8 ( middle ) and @xmath13 ( right ) .",
    "sequences were chosen as @xmath253 and @xmath254 and parameters were set to @xmath255 , @xmath256 , @xmath257 , and @xmath258.,title=\"fig:\",scaledwidth=32.0% ]   ( left ) into structural parts @xmath8 ( middle ) and @xmath13 ( right ) .",
    "sequences were chosen as @xmath253 and @xmath254 and parameters were set to @xmath255 , @xmath256 , @xmath257 , and @xmath258.,title=\"fig:\",scaledwidth=32.0% ]   ( left ) into structural parts @xmath8 ( middle ) and @xmath13 ( right ) .",
    "sequences were chosen as @xmath253 and @xmath254 and parameters were set to @xmath255 , @xmath256 , @xmath257 , and @xmath258.,title=\"fig:\",scaledwidth=32.0% ]     ( left ) into structural parts @xmath8 ( middle ) and @xmath13 ( right ) .",
    "sequences were chosen as @xmath253 and @xmath254 and parameters were set to @xmath259 , @xmath256 , @xmath260 , and @xmath261.,title=\"fig:\",scaledwidth=32.0% ]   ( left ) into structural parts @xmath8 ( middle ) and @xmath13 ( right ) .",
    "sequences were chosen as @xmath253 and @xmath254 and parameters were set to @xmath259 , @xmath256 , @xmath260 , and @xmath261.,title=\"fig:\",scaledwidth=32.0% ]   ( left ) into structural parts @xmath8 ( middle ) and @xmath13 ( right ) .",
    "sequences were chosen as @xmath253 and @xmath254 and parameters were set to @xmath259 , @xmath256 , @xmath260 , and @xmath261.,title=\"fig:\",scaledwidth=32.0% ]     +       of velocity fields obtained by the hierarchical decomposition .",
    "images are aligned from left to right and top to bottom . at iteration @xmath106 the sequence",
    "was set to @xmath263 with parameters @xmath241 and @xmath264.,title=\"fig:\",scaledwidth=32.0% ]   of velocity fields obtained by the hierarchical decomposition .",
    "images are aligned from left to right and top to bottom .",
    "at iteration @xmath106 the sequence was set to @xmath263 with parameters @xmath241 and @xmath264.,title=\"fig:\",scaledwidth=32.0% ]   of velocity fields obtained by the hierarchical decomposition .",
    "images are aligned from left to right and top to bottom . at iteration",
    "@xmath106 the sequence was set to @xmath263 with parameters @xmath241 and @xmath264.,title=\"fig:\",scaledwidth=32.0% ] +   of velocity fields obtained by the hierarchical decomposition .",
    "images are aligned from left to right and top to bottom . at iteration @xmath106 the sequence",
    "was set to @xmath263 with parameters @xmath241 and @xmath264.,title=\"fig:\",scaledwidth=32.0% ]   of velocity fields obtained by the hierarchical decomposition .",
    "images are aligned from left to right and top to bottom .",
    "at iteration @xmath106 the sequence was set to @xmath263 with parameters @xmath241 and @xmath264.,title=\"fig:\",scaledwidth=32.0% ]   of velocity fields obtained by the hierarchical decomposition .",
    "images are aligned from left to right and top to bottom . at iteration @xmath106 the sequence",
    "was set to @xmath263 with parameters @xmath241 and @xmath264.,title=\"fig:\",scaledwidth=32.0% ] +   of velocity fields obtained by the hierarchical decomposition .",
    "images are aligned from left to right and top to bottom . at iteration @xmath106 the sequence",
    "was set to @xmath263 with parameters @xmath241 and @xmath264.,title=\"fig:\",scaledwidth=32.0% ]   of velocity fields obtained by the hierarchical decomposition .",
    "images are aligned from left to right and top to bottom . at iteration @xmath106 the sequence",
    "was set to @xmath263 with parameters @xmath241 and @xmath264.,title=\"fig:\",scaledwidth=32.0% ]   of velocity fields obtained by the hierarchical decomposition .",
    "images are aligned from left to right and top to bottom . at iteration @xmath106 the sequence",
    "was set to @xmath263 with parameters @xmath241 and @xmath264.,title=\"fig:\",scaledwidth=32.0% ]     of velocity fields obtained by the hierarchical decomposition .",
    "images are aligned from left to right and top to bottom . at iteration @xmath106 the sequence",
    "was set to @xmath265 with parameters @xmath266 and @xmath242.,title=\"fig:\",scaledwidth=32.0% ]   of velocity fields obtained by the hierarchical decomposition .",
    "images are aligned from left to right and top to bottom .",
    "at iteration @xmath106 the sequence was set to @xmath265 with parameters @xmath266 and @xmath242.,title=\"fig:\",scaledwidth=32.0% ]   of velocity fields obtained by the hierarchical decomposition .",
    "images are aligned from left to right and top to bottom . at iteration",
    "@xmath106 the sequence was set to @xmath265 with parameters @xmath266 and @xmath242.,title=\"fig:\",scaledwidth=32.0% ] +   of velocity fields obtained by the hierarchical decomposition .",
    "images are aligned from left to right and top to bottom . at iteration @xmath106 the sequence",
    "was set to @xmath265 with parameters @xmath266 and @xmath242.,title=\"fig:\",scaledwidth=32.0% ]   of velocity fields obtained by the hierarchical decomposition .",
    "images are aligned from left to right and top to bottom .",
    "at iteration @xmath106 the sequence was set to @xmath265 with parameters @xmath266 and @xmath242.,title=\"fig:\",scaledwidth=32.0% ]   of velocity fields obtained by the hierarchical decomposition .",
    "images are aligned from left to right and top to bottom . at iteration @xmath106 the sequence",
    "was set to @xmath265 with parameters @xmath266 and @xmath242.,title=\"fig:\",scaledwidth=32.0% ]    as a final experiment , we computed two types of hierarchical decompositions as proposed in sec .",
    "[ sec : decomposition ] .",
    "first we chose @xmath263 such that @xmath246 is halved in every iteration .",
    "solutions @xmath267 were obtained using parameters @xmath241 and @xmath264 . in fig .",
    "[ fig : hierarchical ] , the subsequence @xmath268 is shown .",
    "as @xmath106 increases , the motion field expands on the details . in a second run , @xmath269",
    "was set to @xmath270 , decreasing the exponent of @xmath271 by @xmath272 in every step .",
    "we iteratively computed solutions @xmath273 with parameters @xmath266 and @xmath242 , which were kept constant this time .",
    "figure  [ fig : hierarchical2 ] depicts the subsequence @xmath274 .",
    "note that in figs .",
    "[ fig : hierarchical ] and  [ fig : hierarchical2 ] the colour - coded visualisation is relative to the chosen subsequence . as an exception , here we allowed a maximum number of @xmath275 iterations instead of @xmath276 for the linear system solve to ensure a relative residual of 0.025 in the first step of the hierarchical decomposition .",
    "we provided a set of variational methods for the analysis of motion fields .",
    "while their applicability is limited to data given on the sphere , the proposed models have great flexibility in terms of possible regularising functionals .",
    "in fact , the chosen numerical method based on tangential vector spherical harmonics allows for a straightforward usage of sobolev @xmath12 norms for any real @xmath17 . combined with both @xmath1 and hierarchical decomposition models , which we adapted to the spherical optical flow setting ,",
    "this flexibility makes it possible to capture different motion characteristics with ease .",
    "feasibility of the proposed models was verified on a microscopy dataset depicting endodermal cells of a zebrafish embryo .",
    "we thank pia aanstad from the university of innsbruck for sharing her biological insight and for kindly providing the microscopy data .",
    "this work has been supported by the vienna graduate school in computational science ( ik i059-n ) funded by the university of vienna .",
    "in addition , we acknowledge the support by the austrian science fund ( fwf ) within the national research networks  photoacoustic imaging in biology and medicine \" ( project s10505-n20 , reconstruction algorithms for pai ) and  geometry + simulation \" ( project s11704 , variational methods for imaging on manifolds ) .",
    "j.  abhau , z.  belhachmi , and o.  scherzer . on a decomposition model for optical flow . in _",
    "energy minimization methods in computer vision and pattern recognition _ ,",
    "volume 5681 of _ lecture notes in computer science _ , pages 126139 .",
    "springer - verlag , berlin , heidelberg , 2009 .",
    "g.  aubert and p.  kornprobst .",
    ", volume 147 of _ applied mathematical sciences_. springer , new york , second edition , 2006 . partial differential equations and the calculus of variations , with a foreword by olivier faugeras .",
    "f.  frhauf , c.  pontow , and o.  scherzer .",
    "texture enhancing based on variational image decomposition . in matine bergounioux , editor , _ mathematical image processing _",
    ", volume  5 of _ springer proceedings in mathematics _ ,",
    "pages 127140 , berlin heidelberg , 2011 .",
    "springer .",
    "a.  imiya , h.  sugaya , a.  torii , and y.  mochizuki .",
    "variational analysis of spherical images . in a.",
    "gagalowicz and w.  philips , editors , _ computer analysis of images and patterns _ , volume 3691 of _ lecture notes in computer science _ , pages 104111 .",
    "springer berlin , heidelberg , 2005 .        c.  kirisits , l.  f. lang , and o.  scherzer .",
    "optical flow on evolving surfaces with an application to the analysis of 4d microscopy data .",
    "in a.  kuijper , k.  bredies , t.  pock , and h.  bischof , editors , _ ssvm13 : proceedings of the fourth international conference on scale space and variational methods in computer vision _ ,",
    "volume 7893 of _ lecture notes in computer science _ , pages 246257 , berlin , heidelberg , 2013 .",
    "springer - verlag .",
    "t.  kohlberger , e.  memin , and c.  schnrr .",
    "variational dense motion estimation using the helmholtz decomposition . in l.  d. griffin and m.  lillholm , editors , _ scale space methods in computer vision _ , volume 2695 of _ lecture notes in computer science _ , pages 432448",
    "springer , berlin , 2003 .          c.  melani , m.  campana , b.  lombardot , b.  rizzi , f.  veronesi , c.  zanella , p.  bourgine , k.  mikula , n.  peyriras , and a.  sarti .",
    "cells tracking in a live zebrafish embryo . in _ proceedings of the 29th annual international conference of the ieee engineering in medicine and biology society ( embs 2007 ) _ , pages 16311634 , 2007 .",
    "p.  quelhas , a.  m. mendona , and a.  campilho .",
    "optical flow based arabidopsis thaliana root meristem cell division detection . in a.",
    "campilho and m.  kamel , editors , _ image analysis and recognition _ , volume 6112 of _ lecture notes in computer science _ , pages 217226 .",
    "springer berlin heidelberg , 2010 .",
    "b.  schmid , g.  shah , n.  scherf , m.  weber , k.  thierbach , c.  campos  prez , i.  roeder , p.  aanstad , and j.  huisken .",
    "high - speed panoramic light - sheet microscopy reveals global endodermal cell dynamics .",
    ", 4:2207 , 2013 .",
    "a.  torii , a.  imiya , h.  sugaya , and y.  mochizuki . .",
    "in m.  de  gregorio , v.  di  maio , m.  frucci , and c.  musio , editors , _ brain , vision , and artificial intelligence _ ,",
    "volume 3704 of _ lecture notes in computer science _ , pages 527536 .",
    "springer berlin , heidelberg , 2005 .",
    "l.  vese and s.  osher . modeling textures with total variation minimization and oscillating patterns in image processing .",
    ", 19(13):553572 , 2003 .",
    "special issue in honor of the sixtieth birthday of stanley osher .",
    "j.  weickert , a.  bruhn , t.  brox , and n.  papenberg .",
    "a survey on variational optic flow methods for small displacements . in o.",
    "scherzer , editor , _ mathematical models for registration and applications to medical imaging _ , volume  10 of _ mathematics in industry _ , pages 103136 .",
    "springer , berlin heidelberg , 2006 ."
  ],
  "abstract_text": [
    "<S> we propose a number of variational regularisation methods for the estimation and decomposition of motion fields on the @xmath0-sphere . </S>",
    "<S> while motion estimation is based on the optical flow equation , the presented decomposition models are motivated by recent trends in image analysis . </S>",
    "<S> in particular we treat @xmath1 decomposition as well as hierarchical decomposition . </S>",
    "<S> helmholtz decomposition of motion fields is obtained as a natural by - product of the chosen numerical method based on vector spherical harmonics . </S>",
    "<S> all models are tested on time - lapse microscopy data depicting fluorescently labelled endodermal cells of a zebrafish embryo . </S>"
  ]
}