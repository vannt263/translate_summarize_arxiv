{
  "article_text": [
    "recently , the analysis of data on graphs through time ( network time series ) has become of increasing importance .",
    "we are now able to collect not only large multivariate time series but also strong and useful information on how individuals ( variables ) in those multivariate time series are related to each other via a graph ( network ) description .",
    "such hard network information is typically more powerful than just relying on measures of association ( correlation ) between variables to gauge their real relationship .",
    "we are primarily interested in stochastic processes observed at nodes of a graph over time and so we use ` variable ' and ` node ' interchangeably as context demands .",
    "suitable models for multivariate ( or vector ) time series have existed for a long time .",
    "for example , vector autoregression ( var ) models , see @xcite , chapter  11 or @xcite , chapter  16 . this article proposes a new class of models for network time series : the network autoregressive ( integrated ) moving average ( narima ) processes .",
    "narima models borrow heavily from existing multivariate time series models and , for fixed networks in their simplest form , they are statistically equivalent to a var . however , the narima structure forces analysts to undertake a different approach to data modelling as the network structure influences the type of narima ( or var ) model fitted .",
    "var model fitting requires various approaches to be undertaken to reduce the model dimension to a manageable size . in narima models such modelling is considerably aided by the network structure .",
    "a major advantage of narima models is how they easily cope with the `` moving node '' effect in dynamic networks .",
    "many networks are not static .",
    "in particular , nodes can change their position within the network structure or they can disappear or reappear .",
    "a good example of this effect often arises in epidemiological studies .",
    "for example , in the evolution of a foot and mouth disease outbreak infected individuals ( cows ) can die ( or be born ) but crucially they can move around the network as they get bought , or sold or taken to market or quarantined .",
    "a standard multivariate time series model ( like var ) only looks at the number of cases in a herd ( for example ) and has no explicit mechanism for incorporating the `` moving node '' effect .",
    "however , narima models can explicitly track this important and valuable information and use it for modelling and forecasting purposes .",
    "another interesting , and hard to deal with , feature of network time series is that of trend .",
    "trend is well - handled in regular time series by the important techniques such as differencing or fitting curves and , as such , trend removal is a vital component of time series , see @xcite .",
    "unremoved trend can severely distort estimation of remaining stochastic structure .",
    "we propose using the network lifting method from @xcite and @xcite to estimate and remove trend from networks as a preprocessing step that can be used prior to modelling using narima models .",
    "finally , we consider a simple prototype narima model and show theoretically , for the first time , the conditions under which ( _ spatial _ ) network lifting can achieve decorrelation in _ time_.",
    "this article is concerned with data collected on graphs ( networks ) .",
    "our graph , @xmath0 , consists of a set of nodes , @xmath1 , some of which are joined together by edges from some set of edges @xmath2 .",
    "we define the set of @xmath3 nodes @xmath4 .",
    "two nodes , @xmath5 , connected by an ( undirected ) edge are denoted by @xmath6 .",
    "the set of edges in the graph are defined by @xmath7 .",
    "sometimes , the set of edges is supplemented by another set , the edge distances @xmath8 which merely contains the distance @xmath9 between nodes @xmath10 when @xmath6 .",
    "suppose @xmath11 is a subset of nodes .",
    "the neighbourhood set of @xmath12 is defined by @xmath13 .",
    "we define the set of @xmath14th - stage neighbours of a node @xmath15 by @xmath16 for @xmath17 and @xmath18 . in other words",
    ", @xmath19 is the set of any points connected to any element of @xmath20 by an edge that has not appeared in any earlier neighbourhood set .",
    "initially , we will consider functions that are evaluated at the nodes , and further interested in these values as functions of time .",
    "so , we consider @xmath21 time points , @xmath22 , initially focusing on @xmath23 . a key part of a network time series is its component multivariate time series @xmath24 for the value of the time series at node @xmath25 at time @xmath26 , where @xmath27 is the set of nodes associated with graph @xmath28 .",
    "then    _ mumps example : _ we study the number of cases of mumps in each of 47 counties of england and wales taken weekly during 2005 from week one to week 52 . this period of time was particularly interesting for this disease as it was shortly after the mmr scare which resulted in an abnormally large proportion of the relevant population not receiving the mmr vaccine .",
    "figure  [ fig : mumpsukpic ] shows the situation for the first and last week of 2005 with number of cases colour - coded with deep red indicating few cases and yellow through to white indicating a large number of cases .",
    "for example , during week one wales ( which is treated as a single county here ) and devon have very high counts and in week 52 wales is still high , as is essex , but devon s cases have subsided . in this example",
    ", @xmath24 is the multivariate time series of the number of cases of mumps in county @xmath29 for weeks @xmath30 .",
    "figure  [ fig : mumpsuknet ] shows the graph , @xmath28 , associated with our network time series .",
    "this particular graph was constructed by identifying a `` county town '' for each county ( and rhayader for wales ) and the constructing a graph that connects all towns less than radius of a predefined fixed number of kilometres which reflects the strength of communication links between different parts of the uk .",
    "of course , depending on the disease epidemiology , different graphs could be constructed .",
    "for example , in animal diseases such as foot and mouth routes between farms and between farms and markets , as well as geographical proximity to allow for spread of the disease vector by wind would be instrumental in the development of a suitable graph .",
    "we will now introduce some models for network time series .",
    "suppose that @xmath31 is a network time series .",
    "a _ network autoregressive process of order @xmath32 and neighbourhood order vector @xmath33 of length @xmath32 _ , denoted , is given by : @xmath34 where , for this article at least , we assume @xmath35 are a set of mutually uncorrelated random variables with mean zero and variance of @xmath36 .    writing the vector @xmath37 and letting @xmath38 be a standard vector moving average model of order @xmath39 , with first term @xmath40 , a _ network autoregressive moving average process _ of order @xmath41 is given by @xmath42 .",
    "clearly , such a model specification can get quite complicated , particularly for larger @xmath43 and the majority of this article deals with nar or nari models .",
    "an integrated model can be obtained after some differencing operator , @xmath44 , is applied to some network @xmath45 by @xmath46 and @xmath47 is then modelled as a narma process .",
    "this is analogous to the standard arima mode of operations for univariate time series .",
    "we shall say more on ` network differencing ' or detrending in section  [ sec : detrend ] .",
    "model   expresses how past values of the network time series influence the current values .",
    "in particular , @xmath48 depends directly on its past values at that node via the @xmath49 term and also on past values of its neighbours ( and neighbours of neighbours , etc ) through the @xmath50 term .",
    "our nar@xmath51 model assumes that the @xmath52 and @xmath53 parameter sets do not depend on @xmath54 ( hence , stationarity is assumed ) , neither do they depend on the node @xmath55 ( spatial homogeneity ) .",
    "naturally , both of these assumptions might be questioned in real examples and the model extended .",
    "a nar@xmath56 means a model consisting of @xmath3 separate regular ar@xmath57 time series models , one for each node .",
    "a general nar@xmath51 model , as it is shown in   can be viewed as a vector autoregressive var model with a specific set of constraints on the var parameters . however , the modelling process is somewhat different with narima models as past regressors depend on neighbours ( and stage-@xmath14 neighbours ) of all nodes in the same way .",
    "more importantly , the way in which node neighbour contributions are constructed in narima models is specialized and strongly relate to the structure and topology of the associated graph @xmath28 .",
    "later , though , we will define a gnarima process which is similar to narima except that nodes can drop - out and reappear arbitrarily which is not covered by var .",
    "one might think that multivariate time series with missing observations can deal with this case , but nodes can disappear and reappear and change their geometry within the network in the meantime .",
    "so , in terms of the node and what it represents it refers to the same object , but its position in the graph might be quite different .",
    "gnarima models can handle this , whereas var can not .",
    "to explain the key features of network autoregressive models we focus on the nar@xmath51 model with @xmath59 and @xmath60 which can be written as @xmath61 here we can drop the @xmath62 and @xmath14 subscripts for a simplified presentation . in this simpler example",
    "the value at node @xmath24 depends directly on @xmath63 in the usual autoregressive way , but also depends on the neighbours of node @xmath55 at the previous time step @xmath64 .",
    "there are several modelling choices to be made for network autoregressive models .",
    "we might choose to incorporate distance information into our specification of @xmath65 such as weighting neighbours of @xmath55 more if they are closer to @xmath55 .",
    "for example , we might compute inverse distance weights @xmath66 for @xmath67 .",
    "then we might parametrise @xmath65 in   by @xmath68 for @xmath69 .",
    "this model specifies the overall first - stage neighbour autoregression strength by @xmath70 but modulated by the inverse distance weights . with a gnarima model",
    "we permit the weights to change as a node changes its position ( or existence ) within the network topology .",
    "such changes can be easily incorporated into the least - squares estimation process as the overall model description does not change .",
    "we can use the nar ( ) function in r to model mumps using the nar@xmath71 model as an example and examine the fit .",
    "we first apply the modelling to the disease incidence , that is we divide the raw mumps counts by an estimate of the population size for each county .",
    "this information is stored in the network time series mumpspcor .",
    "we modelled the mumpspcor series using the nar@xmath71 model with the inverse distance weights specification for @xmath65 given in   using the command :    .... model1 < - nar(vts = mumpspcor , net = townnet2 ) ....    the model is fitted using least squares although it is easy to see that maximum likelihood or bayesian inference might well be preferable in some circumstances , particularly when it comes to formulating uncertainty measures . from this model fit we estimated @xmath72 and @xmath73 .",
    "we also compute the residual matrix : @xmath74 for @xmath75 . the residuals are , as usual , vital for assessment of model fit .    figure  [ fig : model1res ] shows the residuals plotted against time for four counties and one can see that the residuals indicate that the model is not a good fit as the variance appears not to be constant over time . in time - honoured tradtion we apply a variance stabilizing logarithmic transform .",
    "more precisely , we model @xmath76 and this new multivariate time series is stored in the object lmumpspcor .",
    "we refit the new model by    .... model2 < - nar(vts = lmumpspcor , net = townnet2 ) ....    which results in new estimates of @xmath77 and @xmath78 .",
    "similar residual plots to those produced in figure  [ fig : model1res ] are shown in figure  [ fig : model2res ] , although not perfect , show a much more reasonable adherence to constancy of variance .",
    "we can further investigate the correlation structure of the residual series by using a cross - covariance analysis .",
    "figure  [ fig : acf136 ] shows the cross - covariance analysis for the @xmath79 series ( log population corrected mumps ) .",
    "the autocorrelation plots for avon and somerset show significant autocorrelations which decay slowy , not inconsistent with an autoregressive structure or _ possibly _ due to trend .",
    "( we will say more on which it might be in section  [ sec : tdsd ] ) .    at this point we should mention that we have only showed autocorrelation plots for two counties .",
    "similar plots occur for most of the other pairs and these two counties are fairly representative behaviour for all that comes below .    a further partial autocorrelation analysis ( not shown ) suggests and ar@xmath80 structure for avon and an ar@xmath81 structure for somerset .",
    "this means that we should investigate maybe a nar@xmath82 model , for some @xmath83 neighbour extent for each of the autoregressive components .",
    "figure  [ fig : acf136 ] also shows significant cross - correlations between the two series .",
    "investigation of cross - plots for other pairs of cities ( even those further apart ) show similar information .",
    "figure  [ fig : acfr136 ] shows a cross - covariance analysis applied to the residuals of the nar@xmath71 fit .",
    "very little cross - correlation exists and much of the correlation in the series themselves is much reduced with maybe some slight further autoregressive structure remaining to be modelled .",
    "since we believe there is further autoregressive structure to be modelled we then fitted a nar@xmath84)$ ] model ( so , up to lag two standard ar structure , plus contributions from immediate neighbours of lag - one nodes ) .",
    "the associated cross - covariance of residuals plot is shown in figure  [ fig : acfr136_21 ] .",
    "pleasingly , the autocorrelation plots look more consistent with white noise . the parameters of the nar@xmath84)$ ] model were @xmath85 , @xmath86 and @xmath87",
    ".    we can also carry out a simple anova analysis shown in table  [ tab : anova ] .",
    "the table shows the benefits of moving from a nar@xmath88 model to a nar@xmath84)$ ] model , but little benefit in going further and using a nar@xmath89)$ ] model .",
    ".anova of selected narima models on log - transformed data.[tab : anova ] [ cols=\"^,>\",options=\"header \" , ]     here , we have used a new model the nar@xmath90)$ ] which only uses one - step temporal dependence , but with neighbours and neighbours of neightbours which corresponds to @xmath91 here , the parametrisation of @xmath92 is the same as above whereas @xmath93 is similar but the inverse distance weights are computed from new distances obtained by adding the distance of ` neighbour of neighbour ' @xmath14 to neighbour @xmath39 and then the distance of @xmath39 to the original node @xmath55 .",
    "this new total distance represents our best informed guess about the overall distance from ` neighbour of neighbour ' @xmath14 to @xmath55 .",
    "the table  [ tab : anova2 ] anova shows that neighbours and neighbours of neighbours seem to have little explanatory power and , at this stage , without further investigation , we might be better off modelling the series purely as a set of separate univariate autoregressive processes as proposed and studied in this after - lifting context by @xcite .",
    "an intriguing empirical observation of the study exploited in @xcite was that network differencing ( across space ) seemed to result in substantial decorrelation across time and the great practical advantage of being able to model a network series as a set of separate arma processes ( i.e.  not requiring var at all ) .",
    "however , there is an important question .",
    "is the excellent low - autocorrelation nature of the lifted multivariate series due to trend removal or decorrelation ?    to study this phenomenon",
    "theoretically we begin with the simplest two - node network and endow it with a zero mean two - dimensional var(1 ) time series model .",
    "we label the nodes @xmath55 and @xmath39 .",
    "the var@xmath81 model we use parallels the one in   given as follows .",
    "let @xmath94 .",
    "then @xmath95 where @xmath96 and @xmath97 is a bivariate white noise process with zero mean and variance @xmath98 .",
    "the eigenvalues of @xmath99 are @xmath100 , @xmath101 and standard texts show that conditions for stationarity are @xmath102 and @xmath103 .",
    "the region of stationarity can be graphically depicted by the square of side length @xmath104 , centered on the origin rotated by @xmath105 .",
    "the stationary covariance matrix of @xmath45 is given by @xmath106 .",
    "let @xmath107 and @xmath108 .",
    "due to the symmetry in the model @xmath109 for this system .",
    "moreover , it can be shown that the cross - correlation @xmath110 .",
    "we desire to study the network lifted version of this var@xmath81 process .",
    "the lifted coefficients in this case are particularly simple and just differences : @xmath111 for all @xmath54 .",
    "hence , now we have a lifted var@xmath81 process what is its autocorrelation ?",
    "first , we compute the autocovariance of the process @xmath24 at lag one @xmath112 using @xmath113 from above .",
    "then , the autocorrelation ( at lag one ) of the lifted series is @xmath114 our empirical results on real data suggested that @xmath115 is often less than @xmath116 in the general multivariate lifting situation .",
    "is this true for our cut - down model ?",
    "we can further simplify @xmath117 by dividing through by @xmath118 to obtain @xmath119 and @xmath120 where we have an explicit expression for @xmath121 in terms of @xmath122 from above .",
    "we examine : @xmath123 as the difference of the absolute values of the unlifted and lifted lag - one covariance .",
    "we are interested in knowing when there is a reduction in absolute covariance and , hence , ask when is @xmath124 ?",
    "figure  [ fig : ad ] ( left ) shows that @xmath125 is more often negative than positive , corresponding to an increase in the absolute value of the lag - one autocorrelation , the opposite of what we might have hoped from @xcite .",
    "it is also helpful to refer to figure  [ fig : ad ] ( right ) which shows the contours of @xmath126 in the same coordinate system as the left plot .",
    "it can be seen that @xmath127 is large near the boundaries of the region and from the left plot it can be seen the negative spatial correlations are associated with an increase in absolute autocorrelation , but with positive spatial correlations are associated with a decrease .    figure  [ fig : fouracf ] shows the above result in action . for @xmath128",
    "the quantity @xmath129 is positive and , according to the theory , should result in a decrease in the absolute autocorrelation .",
    "indeed , comparing the bottom with top plot in the left column of figure  [ fig : fouracf ] shows that the autocorrelations at lag one ( and the rest ) are all much smaller .",
    "however , for @xmath130 we have @xmath131 the theory says that the autocorrelation should increase in absolute value and , indeed , looking at the right column from top to bottom in figure  [ fig : fouracf ] this is indeed the case .",
    "overall , the message is that there is not a uniform reduction in the absolute value of autocorrelation , nor is it possible to say that it mostly happens . whether it happens or not depends specifically on the choice of the parameters in this model ,    at this point",
    "it should be stressed that this is a very simple case .",
    "the theory above only examines a simple bivariate var model on a network with two nodes .",
    "our mumps network has 47 nodes and many real networks are much larger . for the two node network",
    "the lifting step is particularly simple ( differencing of neighbouring values ) . for larger networks ,",
    "nodes with a larger number of neighbours are not merely subject to differencing but subtract off some linear combination of its neighbour values .",
    "we conjecture when these are positively correlated then there will be a reduction in correlation , but for those situations where negative correlations are involved , the result will be unpredictable .",
    "further study is required in this area .    in practical terms",
    ", it seems likely that our network differencing , @xmath44 , is responsible for removing trend which is causing slow autocorrelation decay akin to integrated processes in classical time series analysis .",
    "we would like to thank douglas harding and daniela deangelis of the health protection agency for supplying the mumps data .",
    "jansen , m. , nason , g.  p. , and silverman , b.  w. ( 2001 ) scattered data smoothing by empirical bayesian shrinkage of second generation wavelet coefficients , in m.  unser and a.  aldroubi , eds .",
    ", _ wavelet applications in signal and image processing .",
    "proceedings of spie _ , volume 4478 , pp . 8797 .",
    "nunes , m. , knight , m. , and nason , g. ( 2015 ) modelling and prediction of time series arising on a graph .",
    ", in a.  antoniadis , j .-",
    "m . poggi , and x.  brossat , eds . ,",
    "_ modeling and stochastic learning for forecasting in high dimensions _ ,",
    "volume 217 of _ lecture notes in statistics _ , pp .",
    "183192 , springer ."
  ],
  "abstract_text": [
    "<S> a network time series is a multivariate time series augmented by a graph that describes how variables ( or nodes ) are connected . </S>",
    "<S> we introduce the network autoregressive ( integrated ) moving average ( narima ) processes : a set of flexible models for network time series . for fixed networks </S>",
    "<S> the narima models are essentially equivalent to vector autoregressive moving average - type models </S>",
    "<S> . however , narima models are especially useful when the structure of the graph , associated with the multivariate time series , changes over time . </S>",
    "<S> such network topology changes are invisible to standard varma - like models . for integrated narima models we introduce network differencing , based on the network lifting ( wavelet ) transform , which removes trend . </S>",
    "<S> we exhibit our techniques on a network time series describing the evolution of mumps throughout counties of england and wales weekly during 2005 . </S>",
    "<S> we further demonstrate the action of network lifting on a simple bivariate var(1 ) model with associated two - node graph . </S>",
    "<S> we show theoretically that decorrelation occurs only in certain circumstances and maybe less than expected . </S>",
    "<S> this suggests that the time - decorrelation properties of spatial network lifting are due more to the trend removal properties of lifting rather than any kind of stochastic decorrelation . </S>"
  ]
}