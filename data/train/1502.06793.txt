{
  "article_text": [
    "diffusion mri has become a very important tool for understanding the living brain tissue ( @xcite ) .",
    "it can reveal both macro- and microstructural features of the neuronal network of the human brain .",
    "tractography tries to characterize the structural connectome to understand the details of the interregional relationships of the human brain .",
    "tractography algorithms may be divided in deterministic , streamline - based methods ( @xcite ) , probabilistic approaches ( @xcite ) and global approaches ( @xcite ) . in probabilistic",
    "tractography one basically draws samples from a distribution over paths and computes some statistics over these paths , for example , recording their endpoints . in some work the similarity to the notion of path integrals appearing in quantum mechanics @xcite and statistical physics @xcite was already pointed out @xcite .",
    "rigorous mathematical investigations show that the basic stochastic process behind path integrals is a so called wiener process , a continuous gaussian random walker @xcite . in this work we will recap the foundations of the theory of wiener processes and path integrals . based on this",
    "we build a path integral that leads to a symmetric brain connectivity measure .",
    "we will see that the source of asymmetry of conventional walker principles is due to particle conservation . by dropping particle conservation and starting from the path integral perspective we will find a symmetric brain connectivity measure .",
    "besides the walker perspective and path integrals , there is a third , equivalent approach , which describes expectation values of wiener walkers by partial differential equations ( pde ) .",
    "this equivalence will be used to give an algorithm for the computation of the connectivity measure .",
    "it will be based on solving a large linear system , describing a mixed diffusion / convection process .",
    "we also introduce a novel discretization scheme to avoid the heavy directional dependency , which usually appears for discretized convection operators .",
    "pdes in the context of diffusion mri have been previously used for regularization @xcite , connectivity estimation @xcite and fiber density estimation @xcite .",
    "our proposed pde contains a convection operator , but in the joint position / orientation space , in @xcite also convection was used for tractography , however just in position space . in @xcite",
    "probabilistic tractography was put into a logical framework and and an algorithm was derived which is based on solving a large linear system .",
    "this approach also works just in position space such that crossings can not handled adequately as long as only local neighborhoods are considered .",
    "the system matrix describes a anisotropic diffusion process .",
    "apart from a few examples most methods to estimate brain connectivity are based on the walker principle .",
    "fiber tracts are initiated from certain seed points and are iteratively built by following locally defined directions . while the deterministic tracking approaches are more used for illustrative purposes , the probabilistic ones are more related to quantitative connectivity analysis .",
    "the mathematical principle behind both approaches is an integration of streamlines along the underlying data . in probabilistic tracking",
    "the process can be seen as a markov process .",
    "the iteration process is simple : if we call @xmath0 the current state of the tracker at step @xmath1 , then the next state @xmath2 is drawn from some transition probability density @xmath3 , which may depend in some way on the dw - measurement .",
    "this process is basically a random walk in the state space of the tracker .",
    "if @xmath4 is gaussian , it is possible to formulate the limit for very small time steps , which results in a wiener process , which we will now concentrate on .      in physics and mathematics there exists a huge collection of concepts for the analysis and characterization of wiener random walkers . basically , there are three perspectives which are mostly equivalent .",
    "the first one , which is closest to the above described markov process is the concept of stochastic calculus and stochastic differential equations ( sde ) @xcite . in physics",
    ", sdes are usually written as langevin equations , which do not have the strong mathematical footing of a sde , but are simpler to read and more similar to ordinary calculus . to give an example",
    "( actually this example already covers everything we need later ) we want to consider a simple diffusion process with some additional drift .",
    "let the state of the tracker be @xmath5 and @xmath6 a vector field causing the drift .",
    "then , the corresponding langevin equation is @xmath7 where @xmath8 stands for mean free white noise with variance @xmath9 per unit time .",
    "it is uncorrelated in time , meaning @xmath10 .",
    "the dot in @xmath11 means time differentiation .",
    "an approximative numerical integration gives rise to the following propagation scheme : @xmath12 the first term @xmath13 looks like ordinary euler integration .",
    "the second , stochastic term @xmath14 is drawn independently for each time step from @xmath15 . the factor @xmath16 expresses the fact that the process @xmath17 is not differentiable : variances add up and not standard deviations . note the difference between the continuous wiener process @xmath17 and the discrete process @xmath14 which is just defined at discrete time points @xmath18 .",
    "both are related by @xmath19 .",
    "the transition probability @xmath4 as described in the beginning for the discrete process described in is a gaussian @xmath20 .",
    "the second perspective describes expectation values of an ensemble @xmath21 of random walkers described by .",
    "suppose we have generated such an ensemble @xmath22 of walkers all starting at @xmath23 and we want to know the distribution of the states at some time @xmath24 , i.e. @xmath25 note , that the sum ranges over complete random walks or paths . to make this formally more transparent we always write curly brackets whenever we refer to a path ( a chain of states of a walker ) as a whole and not just a particular state at a specific time .",
    "in fact , the distribution described in is a solution of a partial differential equation , which is called the fokker - planck equation ( fpe ) and is the master equation of the proposed continuous stochastic process . for this example , the fpe takes the form @xmath26 where @xmath27 is the usual gradient operator in @xmath28 and @xmath29 the laplacian .",
    "if we integrate this equation with respect to the initial condition @xmath30 we just resemble the distribution given in .",
    "the function @xmath31 is also known as the propagator or green s function of the corresponding stochastic process .",
    "it can formally be written as @xmath32 .",
    "note that @xmath31 does not necessarily need to be normalized like a probability , e.g. walkers can die at the boundaries , which manifests in the boundary conditions of the corresponding fpe .",
    "the proposed algorithm will be based on discretized solutions of the steady state solutions of a symmetrized fpe .",
    "the third perspective is the path integral concept . from the viewpoint of a brain connectivity ,",
    "the theory of path integrals is probably the most appealing one , however , they are probably the mathematical least understood concept and do not give a constructive way for designing an algorithm .",
    "however , it is essential for the understanding of what we are actually doing . the idea is to compute @xmath31 by summing over _ all _ path starting at @xmath33 and ending at @xmath34 weighted by its probability .",
    "for a rough derivation and motivation recall the discrete time representation . to compute the total probability that a particular path is drawn we take the product along the path @xmath35 but note that @xmath4 is a probability _",
    "density_. so , it is not totally correct to just multiply them , the problem will be discussed below . by taking the logarithm of the above product",
    "it can be converted into a sum and in the continuous time limit @xmath36 with @xmath37 we have the integral form @xmath38 the functional @xmath39 is sometimes called the onsager - machlup functional ( @xcite ) or , in the style of mechanics , the lagrangian .",
    "it describes the cost of a path .",
    "let us further follow the naive way and use and the corresponding @xmath4 to compute @xmath40 . by disregarding the normalization constant ( which actually diverges in the limit ) , we can show that @xmath41 which seems to be plausible but is wrong .",
    "the correct answer is @xmath42 the error is coming from the faulty assumption that we can simply multiply the conditional transition densities @xmath4 to get the total probability , which leads to the diverging normalization constant and the missing term @xmath43 .",
    "actually we have to consider some small volumes instead of infinitesimal points .",
    "we have to consider the portion of walkers starting in a volume around @xmath44 and arriving in a volume around @xmath45 .",
    "this leads to an additional factor @xmath46 which is the infinitesimal volume change during time @xmath47 caused by the drift @xmath6 . in more rigorous derivations of this result the factor is justified by the jacobian of a change of variables ( @xcite ) , or by the considering the most probable tube around the path ( @xcite ) .",
    "let us consider the final equation stating that the probability for a walker starting at @xmath23 and arriving at @xmath48 is the sum over all paths connecting this two points weighted by their probabilities @xmath49 where @xmath50 denotes the set of all paths of length @xmath24 starting in @xmath33 and terminating at @xmath34 .",
    "in fact , the _ sum _ over all path is an integration in a functional space , for more details see e.g. @xcite . for convenience",
    "we omit to write here any normalization constant and assume that the measure is appropriately normalized .",
    "in fact , the additional term @xmath51 in is quite important for us , because it is responsible for the fact that the described random walk is irreversible ( @xcite ) . in the context of brain connectivity",
    "this is directly related to the symmetry of the connectivity measure , so we will detail this out now . if we call @xmath52 the lagrangian with negative velocities @xmath53 and @xmath54 the path traversed in opposite direction .",
    "then , it is easy to see that @xmath55 with the @xmath40 obtained in .",
    "this also leads to @xmath56 .",
    "this asymmetry is basically caused by drift together with particle conservation .",
    "considering the corresponding fpe in makes it more clear . while the diffusion term @xmath57 is symmetric ( selfadjoint , see appendix [ app1 ] for definition ) , the convection / drift is not antisymmetric , i.e. the operator @xmath58 corresponding to the flipped lagrangian @xmath52 is not equal to adjoint operator @xmath59 which has to be case to fulfill @xmath60 .",
    "however , for @xmath61 everything is different .",
    "in fact , we have @xmath62 which should also lead to a symmetric propagator @xmath60 . but how to compute for @xmath61 in practice , what is the corresponding fpe ?",
    "the term @xmath63 acts like an additional potential energy .",
    "in fact , the feynman - kac ( fk ) formula @xcite tells us that such a potential can be directly integrated into the fpe : suppose we have a given lagrangian @xmath40 together with its path integral and a corresponding fpe with operator @xmath64 .",
    "for a potential field @xmath65 we define a new @xmath66 , then the fk formula tells us that the corresponding fpe operator is just @xmath67 .",
    "applying this our problem with @xmath68 gives @xmath69 from the last line we can also see the symmetry property of @xmath70 .",
    "the convection part @xmath71 is antisymmetric in the sense of the operator adjoint and hence the operator @xmath72 , which corresponds to flipped velocities , is just the adjoint of @xmath70 .",
    "one can also see that the particle conservation is lost : we can not write @xmath70 as the a divergence of something . note the similarity of @xmath70 with the quantum mechanical hamiltonian of a particle in a vector potential , which is up to some constants @xmath73 . in quantum mechanics",
    "the hamiltonian is indeed self - adjoint due to the additional complex unit in front of the anti - symmetric part .      up to now",
    "we have considered only paths with some specific length @xmath24 .",
    "however , we are interested in _ all _ path without any length restriction",
    ". that is , we sum up over all paths connecting @xmath33 and @xmath34 of arbitrary length to get a density @xmath74 which is independent of @xmath24 , i.e. @xmath75 where @xmath76 is the set of paths of any length connecting @xmath33 with @xmath34 . with the assumption @xmath77 , i.e. all",
    "walkers eventually die , the function @xmath74 is the steady state solution of the corresponding fpe , i.e. @xmath78 is the solution of the equation @xmath79 this is the basic type of equation we will solve to estimate brain connectivities . in the following we call @xmath78 the connectivity amplitude . from ordinary probabilistic tractography we know the so called length bias . with increasing euclidean distance ,",
    "connectivity values decrease dramatically , usually exponentially . to account for this bias",
    "a linear reweighing was proposed in @xcite , that is , @xmath80 we will see later how @xmath81 can be computed in practice .",
    "due to the exponential decrease one could also tend to use exponential corrections , i.e. use @xmath82 with positive @xmath83 .",
    "in fact , this results in a spectral shift of the operator @xmath84 .",
    "of course , the choice of @xmath85 is difficult .",
    "large @xmath85 will cause bad condition numbers for @xmath64 and , in the extreme case , lead to a diverging @xmath86 .    until now , we were interested in a measure how strong two points @xmath87 and @xmath33 are connected , but one might also be interested in _ how _ the actual connection looks like . instead of just summing over all paths connecting two points , one can additionally image the path itself by counting how often the path visited a specific position @xmath34 .",
    "we call this image the trail image of a path @xmath88 , and it is defined by @xmath89 now , we can write the mean trail image of a path connecting two point @xmath87 and @xmath90 by the expectation value @xmath91 in order to compute @xmath92 we have to use the so called einstein - smoluchowski - kolmogorov - chapman ( eskc ) relation , or simply semigroup property , which tells that the path - integral , or the corresponding propagator can always be split like @xmath93 for any given intermediate point @xmath94 .",
    "this means we can slice the propagator at any given length @xmath95 and consider all possible intermediate positions @xmath96 the path has at @xmath95 and integrate over them by accounting for the probability of the path to get from @xmath33 to @xmath97 and to reach the target @xmath87 starting from @xmath97 . to compute @xmath92",
    "we first consider the point density of the path at some specific length @xmath95 .",
    "that is , we count how often a path traverses the point @xmath34 at length @xmath95 by @xmath98 if we integrate now @xmath99 over all intermediate times @xmath94 and , again , integrate this over all possible @xmath100 we get the mean trail image @xmath101 plugging this altogether gives the simple final result @xmath102 and , as we already know how to compute @xmath103 we are ready . further note that @xmath104 that is , if we integrate the mean trail image , we just get the linearly reweighed version of and have also a way to compute in practice .",
    "all concepts were introduced by considering a 3d diffusion process with drift .",
    "but , how to apply this kind of stochastic process for brain connectivity analysis ?",
    "the data is basically tensor - like , meaning it is point symmetric , there is no velocity field available .",
    "even when we have orientation distributions , there is still no convection - like force .",
    "so , what to do ?    first of all , we have to realize that usual probabilistic tracking algorithms are not markovian with respect to the position @xmath105 .",
    "the propagation direction usually depends not just on the position , but also on the previous step made .",
    "so , the state space of the tracker should be the joint space of position and orientation @xmath106 , where @xmath107 and @xmath108 .",
    "the data we get from the diffusion measurement is basically an fiber orientation distribution @xmath109 defined on this joint position / orientation space .",
    "in fact , in this joint space there are several ways to define meaningful connectivity measures .",
    "we propose to use the following lagrangian @xmath110 as path - costs .",
    "paths with @xmath111 and small changes in @xmath112 are assigned with small costs , and hence , with high probability . from the walker perspective",
    ", there is a convective force which drives a walker with internal state @xmath112 into direction @xmath112 , while the speed is proportional to the data term @xmath113 .",
    "additionally there is diffusion on the orientation variable , enabling the walker to change its directions , or conversely , penalizes too strong bending .",
    "imagine the system as a network of pipes oriented in all possible directions carrying a fluid which flows with speed @xmath109 .",
    "the flow is not perfectly convective , neighboring parallel pipes can exchange fluid ( this is spatial diffusion ) and also crossing pipes exchange some fluid ( this is the angular diffusion ) .",
    "in fact , we can also let spatial diffusion @xmath114 such that there is only pure convection .",
    "however , as we will see later , the discretization of the fpe will force us to have finite values for @xmath115 .",
    "the fpe operator is not totally straight - forward , because there is an additional term coming from the curvature of the sphere ( @xcite ) .",
    "it looks like @xmath116 where the velocity is defined by @xmath117 .",
    "the additional constant @xmath118 is coming from the curvedness of the sphere which is @xmath119 for a 2-sphere of radius @xmath120 .",
    "however , there is actually no metric connection between the position space @xmath28 of the orientation space @xmath121 .",
    "the radius of the sphere @xmath121 has no actual meaning .",
    "so , the value of @xmath122 is rather arbitrary .",
    "in fact , @xmath122 acts like an additional exponential weighting , like the @xmath85 we already introduced above and could be absorbed by that .",
    "so , we exclude @xmath122 in the following , or , imagine @xmath120 to be pretty large .",
    "let us now look at the symmetry properties of @xmath64 .",
    "let @xmath123 the operator that does a point reflection on some function @xmath124 in the sense @xmath125 then , we can easily show that @xmath126 because the data @xmath113 is symmetric @xmath127 . in other words ,",
    "the operator @xmath128 is selfadjoint .",
    "formally we can write the connectivity amplitudes as @xmath129 where @xmath130 .",
    "for the connectivity amplitude the symmetry means @xmath131 because @xmath132 .    if we now think of some function @xmath124 describing a seed point density , and @xmath133 a terminal point density .",
    "for both we can think of indicator functions describing some cortical region of interests .",
    "then , we can define the symmetric connectivity measure @xmath134 to be @xmath135 which can be written in terms of the connectivity amplitudes @xmath136 as @xmath137 so , @xmath134 is the path integral over all path connecting region @xmath138 with region @xmath139 according to the lagrangian @xmath40 .",
    "accordingly , we can also define @xmath140 and @xmath141 corresponding to @xmath81 in equation and @xmath142 in equation , respectively .",
    "the path trail image is @xmath143 note that @xmath144 .",
    "usually the seed functions @xmath138 and @xmath139 do not depend on @xmath112 because we do not have any preference for the starting orientation , so @xmath145 and @xmath146 .",
    "several relationships are then simplified , e.g. @xmath147 and @xmath148 .",
    "for the special case if @xmath149 we can also define the connectivity measure between two spatial locations @xmath150 and @xmath151 as @xmath152 in all experiments we will report the normalized connectivity amplitudes @xmath153 which is quite natural and reminds one of pearson s correlation coefficient .",
    "the lagrangian penalizes bending , which is a good prior for straight fibers , but underestimates curved fibers . in @xcite this problem",
    "does not appear , because the walker is always back projected onto the nearest fiber direction in a voxel .",
    "such a behavior can not be realized by a wiener process .",
    "however , we can mimic such a behavior by an angular constraint such that the walkers do not deviate too strong from the main fiber directions .",
    "that is , we only simulate paths where @xmath112 is not too far away from the main fiber directions , which is similar to the maximum angle thresholds known from ordinary streamline algorithms , but not so rigorous ( it is still possible to find paths where the spatial tangent @xmath154 to the path is not perfectly @xmath112 ) .",
    "now , we are able to set @xmath155 pretty large , i.e. low penalty on bending , but the walker will be along the main fiber directions .",
    "in fact , this idea will also help to keep the running time and memory consumption of our algorithm in a reasonable range , because we only have to simulate the domain in the neighborhood of the fiber directions and not on the complete sphere .",
    "note that the angular constraint may also be seen as an additional cost in the lagrangian , i.e. the forbidden path are assigned with infinite costs .",
    "there are lots of ways to determine the speed function @xmath113 , which represents the dw - data .",
    "for example , we could directly use the fiber orientation distributions ( fod ) , e.g. estimated by spherical deconvolution @xcite . or , one could estimate the main fiber directions by a local maxima detection of an fod , and use them as anchor directions to construct the speed function .",
    "we opt for latter , primarily because the angular constraints can be much beter controlled .",
    "let @xmath156 be the local maximas of the fod .",
    "then , we construct the speed function by @xmath157 with some fixed @xmath158 .",
    "the simulation domain is now defined by thresholding this speed function , i.e. we only consider regions with @xmath159 for some @xmath160 .    to solve the fpe we have to set some boundary conditions .",
    "it is natural to let the walkers die once they touch the boundary of the domain , which is equivalent to a zero dirichlet conditions at the boundary .",
    "so the complete problem we want to solve is @xmath161 where @xmath162 denotes the boundary of the simulation domain , @xmath103 the unknown steady state solution and @xmath138 the seed region where the walkers are emitted .",
    "of course , other boundary condition , like neumann conditions , might be applied , for example at the transitions to the ventricles .",
    "however , we restrict here all considerations to the simple dirichlet conditions .      in order to solve the equation @xmath163 we have to discritize the operator @xmath64 .",
    "the convective part of @xmath64 makes this a pretty hard problem , usual finite element methods are only applicable for diffusion dominated problems .",
    "so , we decided to use a finite difference upwind - downwind scheme .",
    "however , such schemes are known to introduce errors ( known as false diffusion ) when the convection direction is not aligned with the underlying discretization grid . in particular for steady state solutions",
    "these problems become severe and the solutions show heavy orientation dependency . fortunately",
    "our problem is special , the convection direction is always fixed for a volume @xmath164 with fixed @xmath112 , namely @xmath112 .",
    "so , we propose to steer the grid for each direction along the current convection direction .",
    "practically , we discretize the sphere into @xmath165 direction homogeneously distributed over the full sphere ( in the experiments we used @xmath166 directions ) .",
    "so , we have @xmath165 volumes , where the discretization grid of the volume associated with the @xmath167th direction @xmath168 is steered such that one of the coordinate axis is along direction @xmath168 . in this way we are able to produce quite clean convection",
    ", however the angular diffusion gets disturbed .",
    "a voxel at some discrete coordinate in volume @xmath167 does not have a unique partner in volume @xmath169 at exactly the same discrete position .",
    "we need this partner in order to implement the spherical laplace - beltrami operator @xmath170 , which only acts on the spherical coordinate .",
    "the simplest way to account for that is to use trilinear interpolation , which , unfortunately causes another unwanted spatial diffusion effect .",
    "however , this false diffusion is not so disturbing : it is independent of the orientation and the error is proportional to the angular diffusion and not to the speed function .",
    "second , we can reduce the error by a finer discretization of the spatial grid .",
    "we quantified this additional spatial diffusion in an experiment and found that a angular displacement of @xmath171 ( for a @xmath166 points on the sphere ) causes an additional spatial displacement of about @xmath172 spatial grid units , i.e. the cost of a @xmath173 turn on the spot compares to a 5 voxel jump .",
    "so , for some given theoretical @xmath155 and @xmath115 , the actual @xmath174 turns out to be approximately @xmath175 , if @xmath115 is given in grid units .",
    "as this is already pretty much we decided to set the theoretical @xmath115 to zero in all experiments .",
    "in general , for arbitrary number of points on the sphere , we found the approximation @xmath176 , i.e. with a finer sphere discretization the effects get stronger . but again , note that the physical amount of this false diffusion depends also on the spatial grid size .",
    "all the gritty details about the discretization scheme are given in appendix [ app2 ] .",
    "the whole matrix is scattered with matlab s sparse matrix capabilities . to solve the discretized equation we found the gmres algorithm the most stable and efficient @xcite , we just used the matlab s ` gmres ` command . as number of restarts we used @xmath172 .",
    "the tolerance value is set to @xmath177 in all experiments .",
    "the running time depends on the size of the problem .",
    "if we use the setting as described below in the experiments we get usually a system with about @xmath178 variables , which is scattered in @xmath179 minutes on a common desktop pc ( intel i7 , 16 gb ) . solving the equation also takes about one minute .",
    "we want to begin with a small demonstration of the proposed discretization scheme .",
    "let @xmath180 some arbitrary direction and the speed function is constructed according to with @xmath181 and @xmath182 . in figure [ fig1 ]",
    "we choose @xmath183 with @xmath184 ( a , b , e ) and @xmath185 ( c , d , f ) .",
    "further we choose @xmath186 and @xmath187 .",
    "figure [ fig1 ] ( a - d ) shows the solution to with @xmath188 where @xmath151 is located in the lower left corner of the simulation domain .",
    "the spatial intensity maps in figure [ fig1 ] show the solution @xmath103 integrated over the angular variable @xmath189 , i.e. we actually show the connectivity amplitudes @xmath190 as defined in .",
    "the matrix size is of size @xmath191 . in figure [ fig1]a , b ,",
    "c ) we used a sphere with n=128 directions in ( d ) with n=256 directions .",
    "further , we demonstrate the effect of spatial oversampling , i.e. a upsampling by a factor of @xmath192 means that the actual matrix size is in the range of @xmath193 ( for details see appendix [ app2 ] ) . by comparing ( a ) and ( b )",
    "we can obviously see how the the upsampling reduces false diffusion . similarly comparing ( b ) , ( c ) and ( d ) , we see that the amount of false diffusion does not depend on the direction , but the directions are not perfect due to the discretization of the sphere . for comparison",
    "we also simulated an ordinary up / downwind scheme in ( e),(f ) with @xmath194 .",
    "the amount of false diffusion depends dramatically on the direction .      for further demonstration we constructed a numerical phantom consisting of crossing and bending configurations ( see figure [ fig2]d ) ) .",
    "six seed locations @xmath195 were selected such that they are pairwise connected as ( 1 - 2 ) , ( 3 - 4 ) and ( 5 - 6 ) . we did not simulate the mr - signal , but created the underlying directions directly . the directions @xmath156 are created continuously ( not aligned with the discretized sphere directions ) , and a pseudo fod is generated using @xmath196 , which is shown in figure [ fig2]d ) . for robustness analysis we distorted the directions by gaussian noise of standard deviation",
    "@xmath197 .",
    "figure [ fig2]a - c ) gives some first results of our approach .",
    "we show the connectivity amplitudes @xmath198 as images , where @xmath199 is one of the fixed seed point .",
    "figure [ fig2]a ) shows @xmath200 without noise and b ) with noise ( @xmath201 ) .",
    "figure [ fig2]c ) shows the same experiment but with exponential length bias correction of @xmath202 .",
    "examples for the path trails images are shown in figure [ fig2]e ) that correspond to the experiment in figure [ fig2]b ) .",
    "trail images for all pairs of seed combinations are shown , the diagonal shows again the connectivity amplitudes but in logarithmic scaling .    to get a quantitative picture we repeated the above experiment for different noise levels @xmath203 and different discretization scheme , namely spherical discretization with @xmath166 and @xmath204 directions and with and w / o spatial upsampling ( with a factor of @xmath192 ) .",
    "additionally , the orientation of the discrete sphere was randomly changed for each run . as reference approach we followed @xcite ( for details see appendix [ app3 ] ) , with @xmath205 , without revisits and with length bias correction .",
    "figure [ fig3 ] shows barplots of the normalized connectivity amplitudes @xmath206 for all pairs of seeds averaged over 50 runs together with the standard deviation .      to investigate our approach on real dti data we considered 28 scans of healthy volunteers at a b - value of @xmath207 with 61 diffusion directions and an isotropic resolution of @xmath208 .",
    "a white matter probability map was generated with spm ( version 8 , _ http://www.fil.ion.ucl.ac.uk/spm/_ ,",
    "@xcite ) on a t1-weighted scan , which was co - registered to the @xmath209-scan of the diffusion sequence . for each subject",
    "the scans were repeated two times ( in two different sessions ) to allow to investigate the robustness of the approach . to compute the fod",
    "a constrained spherical deconvolution was used together with a @xmath210-regularizer @xcite . the fiber response function ( frf )",
    "was chosen as @xmath211 with @xmath212 for all subjects and reconstructed on a @xmath166 sphere .",
    "the local maximas of the fod are determined by fitting a quadratic form to the neighborhood of the discrete local maxima ( the same approach as used in @xcite ) .",
    "spurious local maximas were filtered out by neglecting all maximas smaller than @xmath213 of the global one .",
    "the speed function is constructed in the same way as for the numerical phantom .",
    "the spherical discretization is kept at @xmath166 and no spatial up sampling is applied .",
    "the probabilistic white matter segmentation of spm was thresholded at @xmath214 and used as white matter mask . to compare and analyze the group ,",
    "the aal atlas @xcite was registered to the subjects native space , normalization was done with spm 8 .",
    "the first 90 rois ( distributed over the neocortex ) of the aal atlas were used to compute connectivity matrices .",
    "figure [ fig4]a - e ) show examples of the mean connectivity matrices ( cm ) over the whole group .",
    "the first 45 rois belong to the right hemisphere , the last 45 the right hemisphere .",
    "the cm is shown in logarithmic scaling . to get a comparable contrast we used the following formula @xmath215 where @xmath1 is the @xmath213 quantile of @xmath216 over all regions .",
    "the cms obtained by our approach are compared to the reference approach @xcite ( figure [ fig4]d - e ) ) . to investigate the robustness we computed the intraclass correlation coefficient ( icc ) and @xmath217 are c - values in the cm for scan 1 and scan 2 , respectively ,",
    "then the icc is @xmath218 , where @xmath219 denotes the expectation over the whole group and @xmath220 .",
    "the icc is 1 if all the variance of the c - value can be explained by differences amongst the subjects .",
    "] for each connectivity value ( c - value ) in the cm . in figure",
    "[ fig4]h ) we show the icc over all c - values in the cm sorted by icc magnitude for different settings : we varied @xmath155 and show one result with exponential weighting ( @xmath221 ) . for all results",
    "we also show the corresponding linear weighted result @xmath222 .",
    "figure [ fig4]i ) compares our approach with @xcite with different parameters : @xmath223 , with ( w / o ) revisits and length bias correction ( lbc ) . in figure [ fig4]f , g )",
    "we show for our approach and the reference the iccs for the individual c - values as a matrix .",
    "table [ tab1 ] shows mean and median iccs for our approach and the reference with more different settings .",
    "it is common to put thresholds to get a binary decision of connectivity . to investigate the robustness of such a thresholding operation an agreement measure",
    "is calculated as follows : let @xmath1 be some threshold , then @xmath224 denotes the number of regions that are not connected in scan @xmath225 and in scan @xmath192 , where the number is counted over all possible roi pairs and subjects .",
    "the agreement value @xmath138 is normalized by the total number of non - connected regions @xmath226 , and hence , @xmath227 is a number between @xmath228 and @xmath225 . if we now vary over all thresholds @xmath1 and plot @xmath227 as a function of @xmath229",
    "we get plots displayed in figure [ fig4]j ) .    finally , figure [ fig5 ] shows examples of path trail images for two roi pairs of the aal atlas .",
    "the two rois are highlighted in green and blue , respectively .",
    "the white matter mask is depicted in dark gray .",
    "the path trail @xmath230 is obviously a function in the joint position / orientation space , which is shown in glyph representation , but note that the glyphs are not pointsymmtric as one used to observe .",
    "the traversal direction is in this example from the blue to the green roi .",
    ".quantitative comparison by icc [ cols=\"<,^,^\",options=\"header \" , ]",
    "we proposed to use a wiener process for the estimation of structural brain connectivities .",
    "the path integral perspective gave us the insight why the usual random walker principle leads to asymmetric connectivities .",
    "to symmetrize the solution an additional potential was introduced , which symmetrized the path integral and the corresponding fokker planck equation .",
    "however , particle conservation and , hence , the usual walker perspective is lost . to solve the fpe we introduced a novel discretization scheme which avoids the directional dependency of the false diffusion introduced by the discretization of the convection operator .",
    "initial experiments ( in figure [ fig1 ] ) show that the new discretization approach is valid . in figure [ fig2 ]",
    "the visual results on the numerical phantom show the approach works also nicely under noisy conditions and that the exponential length bias correction is reasonable .",
    "quantitative experiments show that it leads to a robust connectivity measure .",
    "compared to @xcite the new approach shows smaller connectivity values for bending configurations , which is due to the bending penalty which is inherent to the new approach ( see figure [ fig3 ] ) .",
    "one can also see that the robustness of our approach does not really depend too much on the discretization granularity .",
    "compared to @xcite it is in most cases higher ( lower standard deviation over the trials ) . for stronger noise ( @xmath231 )",
    "our approach gives relatively higher c - values to false connections , but the c - values itself are more stable . another difference to @xcite is the way the curvature is controlled .",
    "if we want for our approach a higher connectivity for bending fibers ( rois ( 5,6 ) ) , then we also get higher c - values for ( 1,3 ) and ( 2,4 ) . for @xcite",
    "it is different , the step directions are always back projected onto the nearest most likely fiber direction , which results in higher c - values for the bending ( 5,6 ) .    to investigate the new approach in - vivo",
    ", we considered a group of volunteers which were all scanned twice .",
    "we did a roi - based approach based on the aal - atlas .",
    "overall , the cms obtained from our approach and the reference are similar .",
    "as one might expect , with our approach strong bending fibers ( like the connection between occipital sup l to occipital sup r ) are assigned smaller connectivity values .",
    "analysis of the intraclass correlations of c - values shows that the new approach is quite robust .",
    "usually higher angular diffusion @xmath155 gives more robust c - values .",
    "robustness is further increased by a length bias correction , either linear or exponentially .",
    "compared to @xcite our approach shows good performance . for @xcite",
    "increasing angular diffusion does not help so much .",
    "one can see that in regions with low connectivity @xcite has problems ( see figure [ fig4]f , g ) ) , which goes inline with our finding in the numerical phantom .",
    "we found @xcite to work best for @xmath232 , @xmath233 , revisits are allowed and with length bias correction ( see table [ tab1 ] ) . in this",
    "setting the median icc is @xmath234 which is acceptable , @xmath235 of the c - values have a icc higher than @xmath234 .",
    "the highest value we can achieve with our approach is a median of @xmath236 .",
    "the agreement scores obtained from thresholded c - values show a similar but more pronounced picture ( see figure [ fig4]j ) ) . from figure [ fig5 ]",
    "it can also be seen that the estimated path trail images are meaningful and follow the expected pattern .",
    "the space of square integrable function on @xmath237 is a hilbert space @xmath238 with the inner - product @xmath239 sometimes we adopt dirac s bra - ket notation , i.e. by @xmath240 we denote a vector in @xmath238 , by @xmath241 a linear 1-form .",
    "the adjoint of a linear operator @xmath242 is defined to be the operator @xmath243 such that @xmath244 for all functions @xmath245 .",
    "let @xmath246 some predefined white matter mask .",
    "for each direction @xmath168 on the sphere , we create a voxel grid @xmath247 such that the @xmath248-axis is aligned with direction @xmath168 .",
    "only valid triples @xmath249 are considered where @xmath250 is on .",
    "the voxel spacing @xmath251 can be chosen arbitrarily . in the experiments we used @xmath252 which is resolution of the dti scan , and @xmath253 , that is an oversampling factor of 2 .",
    "the sphere has a natural neighborhood system @xmath254 obtained by voronoi tessellation .",
    "let @xmath255 be some function on the introduced discrete domain . to discretize the spherical laplace - beltrami @xmath256 operator we define the discrete operator @xmath257 as @xmath258 where @xmath259 is neighborhood system needed for trilinear interpolation at position @xmath260 in the @xmath261-th volume , and @xmath262 are the corresponding weights .",
    "however , the matrix @xmath257 is not symmetric in the sense of the matrix transpose due to the one - sided interpolation .",
    "so the final discretized spherical laplacian is @xmath263 .",
    "the factor @xmath264 is empirically determined to get standard deviations of approximately @xmath155 .    to implement the convection part",
    ", the speed function @xmath109 given in the native dti frame is also transferred by trilinear interpolation onto the new coordinate frame @xmath265 .",
    "the simulation domain is determined by thresholding @xmath266 . for the convection operator we have to distinguish between real boundaries and boundaries coming from the thresholding .",
    "the discretized convection generator @xmath267 is defined as @xmath268 where @xmath269 is an boundary indicator , where @xmath270 means the boundary is coming from thresholding and @xmath271 from a real boundary . finally , the convection part of the equation is @xmath272 , where @xmath273 is the matrix with @xmath266 on the diagonal .      for comparison we followed @xcite .",
    "suppose for some given fiber directions , which are always extracted in the same way as for our approach .",
    "the state of a walker is its current position @xmath150 and its last step direction @xmath112 .",
    "the propagation law for a single walker is : the current voxel contains a set of fiber directions @xmath156 .",
    "determine the fiber direction @xmath180 which is closest to the current @xmath112 .",
    "if the angle between those is above a threshold of @xmath274 tracking is stopped .",
    "otherwise , disturb this fiber direction by gaussian noise @xmath275 with deviation @xmath276 .",
    "renormalize @xmath277 to unity and track along this direction with step width @xmath278 , i.e. @xmath279 and set @xmath280 .",
    "if the new position is out of the tracking mask , stop tracking .",
    "if desired , one can also stop tracking whenever a voxel is visited more than once . during tracking we count how often a walker has visited a voxel resulting in a probabilistic map ( pm ) . alternatively , to account for the length bias",
    ", one can also weight with visitation count by the mean length of all walkers visited the voxel . to compute the connectivity value between roi a and roi b , @xmath165 walkers",
    "are ejected in each voxel in roi a. the connectivity value is then the sum over the pm in roi b. to get a symmetric value the connectivity from a to b is averaged with the connectivity from b to a. to set @xmath165 we computed the intra - scan icc , i.e. for each subject _ and _ scan in the group we started the algorithm twice and computed the icc between the two algorithm runs .",
    "we set @xmath165 , such that the median icc over all roi pairs is above @xmath281 , which resulted in @xmath282 per voxel .",
    "t.  e.  j. behrens , h.  j. berg , s.  jbabdi , m.  f.  s. rushworth , and m.  w. woolrich .",
    "probabilistic diffusion tractography with multiple fibre orientations : what can we gain ?",
    ", 34(1):144155 , 2007 .",
    "english article 1053 - 8119 .",
    "mats bjrnemo , anders brun , ron kikinis , and carl - fredrik westin .",
    "regularized stochastic white matter tractography using diffusion tensor mri . in _",
    "medical image computing and computer - assisted intervention  miccai 2002 _ , pages 435442 .",
    "springer , 2002 .",
    "p.  hagmann , j.  p. thiran , l.  jonasson , p.  vandergheynst , s.  clarke , p.  maeder , and r.  meuli .",
    "dti mapping of human brain connectivity : statistical fibre tracking and virtual dissection .",
    ", 19(3):545554 , 2003 .",
    "english 1053 - 8119 .",
    "s.  mori , b.  j. crain , v.  p. chacko , and p.  c. van zijl .",
    "three - dimensional tracking of axonal projections in the brain by magnetic resonance imaging .",
    ", 45(2):2659 , 1999 .",
    "99142739 0364 - 5134 journal article .",
    "g.  j.  m. parker , h.  a. haroon , and c.  a.  m. wheeler - kingshott . a framework for a streamline - based probabilistic index of connectivity ( pico ) using a structural interpretation of mri diffusion measurements . , 18(2):242254 , 2003 .",
    "english 1053 - 1807 .",
    "tournier , f.  calamante , d.g .",
    "gadian , and a.  connelly .",
    "robust determination of the fibre orientation distribution in diffusion mri : non - negativity constrained super - resolved spherical deconvolution .",
    ", 35(4):14591472 , 2007 .",
    "nathalie tzourio - mazoyer , brigitte landeau , dimitri papathanassiou , fabrice crivello , olivier etard , nicolas delcroix , bernard mazoyer , and marc joliot . automated anatomical labeling of activations in spm using a macroscopic anatomical parcellation of the mni mri single - subject brain .",
    ", 15(1):273289 , 2002 ."
  ],
  "abstract_text": [
    "<S> probabilistic tractography based on diffusion weighted mri has become a powerful approach for quantifying structural brain connectivities . in several works the similarity of probabilistic tractography and path integrals was already pointed out . </S>",
    "<S> this work investigates this connection more closely . </S>",
    "<S> for the so called wiener process , a gaussian random walker , the equivalence is worked out . </S>",
    "<S> we identify the source of the asymmetry of usual random walkers approaches and show that there is a proper symmetrization , which leads to a new symmetric connectivity measure . to compute this measure we will use the fokker - planck equation , which is an equivalent representation of a wiener process in terms of a partial differential equation . in experiments </S>",
    "<S> we show that the proposed approach leads a symmetric and robust connectivity measure . </S>"
  ]
}