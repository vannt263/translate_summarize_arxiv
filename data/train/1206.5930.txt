{
  "article_text": [
    "_ anonymous database search _ is the discipline dedicated to the study of the anonymity of query searches in databases .",
    "namely , it is dedicated to the study of protocols that allow a user to retrieve information from a database server without revealing for the server who he is .",
    "anonymous database search has also been called _ user - private information retrieval _ ( upir ) @xcite .",
    "another example of anonymous database search , similar to the previously mentioned upir protocols , is the protocol crowds  @xcite . unlike private information retrieval ( pir )",
    "protocols , upir protocols do not hide the query for the database .    usually , when people access to a database server , the responsibility of guaranteeing their privacy is assigned to the database owner or to a trusted third party . in upir protocols ,",
    "the privacy of the user is put in the hand of the user .",
    "the protocols for upir presented in  @xcite are defined on a p2p community , and are called p2p upir . in a p2p upir protocol ,",
    "a community of p2p users agree to collaborate in order to search the database anonymously .",
    "the users send queries to the database on behalf of other users , without revealing to the database the identity of the owner of the query . in this way",
    ", the query profiles of the users are diffused among the rest of the users in the community . moreover",
    ", the protocol distributes the queries uniformly to avoid tracing of the queries .",
    "the queries are written and read by users on some memory sectors that are called communication spaces .",
    "each user has access only to some of these communication spaces . as a mean to hinder unauthorized entities from obtaining information about queries ,",
    "the information on the communication spaces is encrypted .",
    "if the encryption of the information on the communication spaces uses the same key over the entire network , then there is a high risk that the key is compromised .",
    "but if the number of keys is too large , then the users can have storage problems .",
    "given a set of requirements on the protocol , the search for the optimal distribution of communication spaces and keys can be defined as a combinatorial problem with constraints .    in the articles @xcite , combinatorial configurations ,",
    "also known as regular and uniform partial linear spaces , were used to manage the distribution of communications spaces and keys for p2p upir .",
    "these combinatorial structures have been used for distributing keys also in other contexts , as in @xcite . in @xcite the p2p upir protocols",
    "were modified and extended to more general families of block designs .",
    "curious users should be prevented from obtaining information about other users .",
    "it can be proved that this prevention is simplified if we avoid , for instance , designs in which a pair of users share more than one communication space , and designs in which a user can access all communication spaces .",
    "this motivates the use of combinatorial configurations .    in this article",
    ", we apply @xmath0-anonymity arguments to the construction of anonymous database search algorithms , and present the combinatorial congurations with @xmath0-anonymous ( open ) neighborhoods and with @xmath0-anonymous closed neighborhoods .",
    "we study transversal designs and linear spaces and we show that they are optimal configurations .",
    "we present two versions of p2p upir protocols that are based on the protocols presented in  @xcite . in one of the protocols ( p2p upir 1 ) , the user can not forward directly his own queries to the database , while in the other he is allowed to do so ( p2p upir 2 ) .",
    "the p2p upir 2 protocol is a modification of p2p upir 1 , designed in order to avoid so - called neighborhood attacks in some combinatorial configurations .",
    "these attacks were first described in @xcite , and are based on query repetition from the p2p upir users , in combination with unique neighborhoods in the combinatorial configuration . as observed in @xcite , a neighborhood attack can be modeled as the intersection of neighborhoods , that may return a single identified point in the case of a unique neighborhood . in this article",
    "we give several examples of combinatorial configurations with unique neighborhoods .",
    "the results presented in this article , shows that it is not necessary for users to self - submit their queries in order to avoid neighborhood attacks .",
    "we present a family of combinatorial configurations with anonymous neighborhoods .",
    "we use the concept of @xmath0-anonymity to measure the degree of this anonymity , and say that a point has a @xmath0-anonymous neighborhood if it is the neighborhood of at least @xmath1 other points .",
    "then we study and characterize the combinatorial configurations with @xmath0-anonymous neighborhoods .",
    "in particular , we justify why the transversal designs can be regarded as optimal among the configurations with @xmath0-anonymous neighborhoods for p2p upir 1 .",
    "we also characterize the anonymity that is provided by the p2p upir 1 protocol , when combinatorial configurations with @xmath0-anonymous neighborhoods are used .",
    "as can be deduced from @xcite , the linear spaces are optimal configurations with respect to maximal diffusion of the query profiles . in @xcite ,",
    "the linear spaces were presented as the only combinatorial configurations that can provide p2p upir with so - called _ perfect anonymity _ , and this was extended to designs in general , among which the covering designs were distinguished for having the same property .    in this article",
    "we show that the linear spaces have @xmath0-anonymous closed neighborhoods , and that they maximize the parameter @xmath0 .",
    "this justifies once again why the linear spaces are optimal for p2p upir .",
    "we also construct a new class of combinatorial configurations that also have @xmath0-anonymous closed neighborhoods , but in which @xmath0 is smaller compared to the linear spaces .",
    "this article is structured as follows .",
    "section  [ sec : prel ] contains the preliminaries , in section  [ sec : p2pupir ] we define the p2p upir protocols , section  [ sec : notations ] introduces notation and formalizes p2p upir in terms of data privacy . in section  [ sec : compprot ] we describe attacks on p2p upir and identify ways to avoid some of them .",
    "section  [ sec : privp2pupir ] discusses the nature of the privacy that can be provided by the p2p upir protocols and under what conditions . in section  [ sec : unique_neighborhoods ]",
    "we give examples of combinatorial configurations with unique neighborhoods .",
    "sections  [ sec : combconfnanneighbors ] and [ sec : nanonymousclosedneighborhoods ] classify and give examples of combinatorial configurations with @xmath0-anonymous neighborhoods and @xmath0-anonymous closed neighborhoods , respectively .",
    "the article ends with conclusions .",
    "this section contains known results and concepts that will be used in the rest of the article .",
    "most of the definitions and the notation presented in the next paragraph are taken from @xcite .",
    "an _ adversary _ , or an _ attacker _ , is an entity that aims for the destruction of the privacy protection .",
    "a subject @xmath2 is _ anonymous _ if the adversary can not identify him within a set of subjects .",
    "we call this set of subjects the _ anonymity set _ of @xmath2",
    ". two or more so - called items of interest are _ unlinkable _ if within the system ( comprising these and possibly other items ) , the adversary can not sufficiently distinguish whether these items of interest are related or not . in this article ,",
    "an item of interest can be a query , a sequence of queries , the owner of a query , the owner of a sequence of queries , or the identity of this owner .",
    "we can express anonymity in terms of unlinkability ; anonymity is provided if it is not possible to link a subject to the identity of this subject . _ confidentiality _ is the quality of being prevented from the disclosure of information to unauthorized individuals or systems .    disclosure risk control for statistical databases is a research area concerned with the protection of the privacy of individuals in published statistical databases  @xcite .",
    "the naive solution is to protect the database by simply removing the identifiers ( e.g. name , i d , social security number ) from the tables .",
    "it is well - known that this solution is far from satisfactory . in many cases",
    "it is rather easy to recover the identifier of the anonymized record ( see for example  @xcite ) .",
    "other more sophisticated solutions for protecting databases have been proposed .",
    "many of these solutions are methods for obtaining so - called @xmath0-anonymity , which we will define below .    a _",
    "database _ is a collection of records of data .",
    "we may assume that all records correspond to distinct individuals or objects .",
    "every record has a unique identifier and is divided into attributes .",
    "the attributes can be very specific , as the attributes `` height '' or `` gender '' , or more general , as the attributes `` text '' or `` sequence of binary numbers '' .",
    "suppose that the database can be represented as a single table .",
    "let the records be the rows of the table and let the attributes be the columns .",
    "the intersection of a row and an attribute is a cell in the table , and we call the data in the cells the entries of the database . also other data structures , like for example graphs , or in general , incidence structures , are representable in table form .",
    "let @xmath3 be a table with the set of attributes @xmath4 .",
    "let @xmath5 be a subset of these attributes .",
    "we denote the projection of the table on the attributes @xmath6 by @xmath7 $ ] .",
    "we suppose that every record contains information about a unique individual .",
    "an _ identifier _",
    "@xmath8 in a database is an attribute such that it uniquely identifies the individuals behind the records .",
    "in particular , any entry in @xmath9 $ ] is unique .",
    "a _ quasi - identifier _ @xmath10 in the database is a collection of attributes @xmath11 , such that they in combination can uniquely , or almost uniquely , identify a record @xcite .",
    "that is , the structure of the table allows for the possibility that an entry in @xmath12 $ ] is unique , or that there are only a small number of equal entries . in the former case",
    "the entry in @xmath12 $ ] uniquely identifies the individual behind the record and in the latter , the few other individuals with the same entries in @xmath12 $ ] may form a collusion and use secret information about themselves in order to make this identification possible .",
    "if a table contains information on students in a school class , the attributes birth data and gender could be sufficient to determine to which individual a record of the table corresponds , although it is possible that not all records will be uniquely identified in this way .",
    "hence for this table , birth date and gender are an example of a quasi - identifier .",
    "the following definition of @xmath0-anonymity appeared for the first time in  @xcite ( see also  @xcite ) .",
    "[ 1:def : nan ] a table @xmath3 , that represents a database and has associated quasi - identifier @xmath10 , is @xmath0-_anonymous _ if every sequence in @xmath12 $ ] appears with at least @xmath0 occurrences in @xmath12 $ ] .",
    "an _ incidence structure _ @xmath13 sometimes also called a _ block design _ , consists of a _ point set _ @xmath14 , a family of subsets of points @xmath15 called _ block set _ , and an _ incidence relation _",
    "@xmath8 on @xmath14 .",
    "the elements of @xmath14 and @xmath15 are called _ points _ and _ blocks _ , respectively , and two points are related by the incidence relation if and only if there is a block containing both . in this article",
    "we assume that the same block only can appear once in @xmath15 .",
    "we will also assume that the incidence structures are connected , so that for every two different points @xmath16 , there is a chain of incidences starting with @xmath17 and ending with @xmath18 .",
    "if all blocks have the same number of points @xmath0 , then we say that the incidence structure is _",
    "@xmath0-uniform_. if all points are in the same number of blocks @xmath19 , then we say that the incidence structure is _",
    "@xmath19-regular_. the _ order _ of a uniform and regular incidence structure is the integer pair @xmath20 .",
    "a _ parallel class _ @xmath21 is a subset of @xmath15 such that for all @xmath22 there is a unique block @xmath23 such that @xmath24 .",
    "every parallel class @xmath25 is a partition of @xmath14 , because @xmath26 and @xmath27 for @xmath28 .",
    "an incidence structure @xmath13 is _ resolvable _ if there exists a partition of the set of blocks @xmath29 , such that @xmath30 is a parallel class of blocks for @xmath31 .",
    "the _ line _ spanned by two points is the intersection of the all blocks containing these points . when every pair of points is contained in at most one block , then the blocks are the lines .    in an incidence structure",
    "in which the blocks are lines , we say that two points are _ collinear _ if there is a line through the two points .",
    "observe that a point is always collinear with itself .",
    "we define the _ closed neighborhood _ @xmath32 of @xmath17 as the set of points that are collinear with the point @xmath17 .",
    "the _ neighborhood _ or _ set of neighbors _",
    "@xmath33 of a point @xmath17 is the set of points in @xmath34 that are collinear with @xmath17 but different from @xmath17 . observe that @xmath35 .",
    "a _ linear space _ is an incidence structure in which every two points are in exactly one block , so in a linear space we may say that the blocks are lines . it is not required for the lines to have the same number of points , but the minimum number of points on a line is two .    a _",
    "finite affine plane _ is an incidence structure in which    * every two points span exactly one line , * for every point @xmath17 and line @xmath36 not incident with @xmath17 , there is exactly one other line @xmath37 such that @xmath17 is incident with @xmath38 and @xmath39 , * there is a triangle , a set of three points such that they pairwise span different lines .",
    "a finite affine plane is therefore a linear space . in a finite affine plane",
    "there is always a natural number @xmath40 such that there are @xmath40 points on every line , @xmath41 lines through every point , @xmath42 points and @xmath43 lines .",
    "in particular , a finite affine plane is uniform and regular .",
    "the order of a finite affine plane is @xmath44 , but the usual notation is that the order is @xmath40 .",
    "the second condition in the definition of affine plane implies that the set of lines is partitioned into classes of parallel lines , so that an affine plane is resolvable .",
    "the affine plane over a finite field of order @xmath18 is always a finite affine plane of order @xmath18 which we denote by @xmath45 . from this",
    "it is deduced that there exists a finite affine plane of order @xmath18 for every prime power @xmath18 .",
    "when @xmath18 is not prime , then there are other finite affine planes than @xmath45 , but it is not known if there are finite affine planes of order @xmath40 when @xmath40 is not a power of a prime .",
    "it is conjectured that there exists a finite affine plane of order @xmath40 if and only if @xmath40 is a power of a prime .",
    "other examples of uniform and regular finite linear spaces are the finite projective planes , the unitals , and the denniston designs .",
    "a _ partial linear space _ is an incidence structure in which every two points can be on at most one line .",
    "also it is required that the minimum number of points on a line is two .",
    "all linear spaces are partial linear spaces . the number of points is usually denoted by @xmath46 , and the number of lines by @xmath47 . in this article",
    "we will concentrate on @xmath19-regular and @xmath0-uniform partial linear spaces , also known as _ combinatorial @xmath48-configurations , _ or shorter , @xmath49-configurations . for general references on combinatorial configurations , see @xcite .",
    "another interesting type of incidence structure are the @xmath50-designs . a @xmath50-_design _ with parameters",
    "@xmath51 has @xmath46 points , @xmath0 points in every block and every @xmath50-element subset of points appear in exactly @xmath52 blocks .",
    "a @xmath53-design with @xmath54 is a combinatorial configuration , or more precisely , a regular linear space .",
    "the @xmath53-designs are also called _ balanced incomplete block designs _ with parameters @xmath51 , or shorter , _",
    "@xmath51-bibd_.    in this article we will also treat a third type of incidence structure , the transversal designs . a _ transversal design _",
    "@xmath55 is a @xmath0-uniform incidence structure @xmath13 with @xmath56 that admits a partition of @xmath14 whose parts , called _ groups _ , have cardinality @xmath40 , and satisfy the following properties :    1 .",
    "any group and any block contain exactly one common point , and 2 .",
    "every pair of points from distinct groups is contained in exactly @xmath52 blocks .    in a transversal design the set of groups forms a partition of @xmath14 but it is not a parallel class since the groups are not blocks . on the other hand , if the block set @xmath15 can be partitioned into parallel classes",
    ", then we get a resolvable transversal design .",
    "a transversal design @xmath55 is a combinatorial @xmath57-configuration if and only if @xmath54 . in this article",
    "we are interested in the transversal designs of this kind . for simplicity of notation",
    "we will denote a transversal design with @xmath54 by @xmath58 .",
    "it is well - known that affine planes can be used to construct transversal designs as described in the following lemma .",
    "[ 1:lem : transaffine ] whenever there exists a finite affine plane of order @xmath40 , then for every @xmath59 there exists a transversal design @xmath60 .    as point",
    "set @xmath14 of @xmath58 , take the points on the @xmath0 lines from one of the parallel classes of an affine plane of order @xmath40 . as the groups of @xmath58 ,",
    "take the lines from the same parallel class . as lines of @xmath58 ,",
    "take the lines in the rest of the parallel classes of the affine plane , restricted to the points in @xmath14 .    more generally , it is well - known that the existence of transversal designs is related to the existence of a set of mutually orthogonal latin squares . for more information about these structures ,",
    "see for example @xcite .",
    "in this section we describe the peer - to - peer protocols for user - private information retrieval ( p2p upir ) , first presented in  @xcite .",
    "these protocols use communication spaces , that are memory sectors in which a user who has access to the corresponding cryptographic key can write and read queries and the answers to these queries .",
    "the distribution of the cryptographic keys is determined by a combinatorial configuration .",
    "the clients of the protocol are mapped to the points of a combinatorial configuration , and the keys , or the communication spaces , are mapped to the lines .",
    "the result is that a client , represented by the point @xmath17 , has the cryptographic keys giving access to the communication spaces that are represented by the lines through @xmath17 .",
    "the p2p upir protocols described herein are called by a protocol that is implemented by all the community of users together .",
    "we call this protocol p2p upir init .",
    "this protocol takes as parameter the combinatorial configuration for the distribution of communication spaces .    by abuse of notation",
    ", we will not distinguish the points and the lines of the configuration from the users and the communication spaces they represent .",
    "a communication space is a queue of messages , together with a cryptographic key from a symmetric cipher , used to encrypt the messages .",
    "the precondition is here that a community @xmath14 of @xmath40 users wants to implement a p2p upir protocol .",
    "the postcondition is that some user has dropped out of the protocol .",
    "[ 1:def : p2pupirinit ]    1 .",
    "the users in @xmath14 are mapped to the points of the combinatorial configuration .",
    "2 .   the users repeat execution of the p2p upir protocol with frequency @xmath61 ( which is not required to be constant , nor the same for all users ) .",
    "[ rmk : freqcheck ] the protocol described in @xcite was different .",
    "for instance , the user repeated the p2p upir protocol only when they had a query to post .",
    "however , in order to limit the waiting time before a user can post his query , and the response time for the answer , the period of protocol repetition must be bounded .",
    "more exactly , @xmath61 should always be higher or equal to the highest query submission frequency among the users .",
    "it is not necessary to end the p2p upir init protocol only because a user @xmath17 is temporally away .",
    "the owner of a query that should have been posted by @xmath17 , can execute p2p upir again in order to get his query posted to the server .",
    "however , we think that only modest and controlled absences should be allowed for , since a prolonged absence causes the deterioration of the provided anonymity",
    ".      first we present a p2p upir protocol which is similar to the protocol described in @xcite , but modified following the ideas from @xcite . we will call this protocol p2p upir 1 .",
    "the individual @xmath17 is member of a community of user implementing the p2p upir init protocol , and @xmath17 s execution of p2p upir 1 is done within p2p upir init . the user @xmath17 may , or may not , have a query @xmath62 which he wants to post to the community .       1 .",
    "the user ( point ) @xmath17 selects uniformly at random a communication space ( line ) @xmath36 passing through @xmath17 ; 2 .   @xmath17",
    "decrypts the content on @xmath36 using the corresponding cryptographic key .",
    "the outcome is a queue of messages @xmath63 . for every message @xmath64 in the queue : * if @xmath64 is a * query addressed to @xmath17 * , then @xmath17 removes @xmath64 from the queue , forwards @xmath64 to the server , receives the answer @xmath4 , encrypts @xmath4 and writes @xmath4 to the end of the queue @xmath65 ; * else if @xmath64 is an * answer to a query belonging to @xmath17 * , then @xmath17 reads @xmath64 and removes @xmath64 from the queue @xmath65 ; * else , @xmath17 leaves @xmath64 on the queue without action ; 3 .   if @xmath17 has a query @xmath62 , then 1 .",
    "@xmath17 selects uniformly at random a point @xmath66 on @xmath36 ; 2 .",
    "@xmath17 addresses @xmath62 to @xmath67 and writes @xmath62 to the end of the queue @xmath65 .",
    "we also present a variation of the former protocol which we will call p2p upir 2 .",
    "this protocol was first described in  @xcite .",
    "the p2p upir 2 protocol differs from the p2p upir 1 protocol only in how the users forward their own queries .",
    "we say that a user who forwards his own queries with probability @xmath68 , has self - submission @xmath68 .",
    "the p2p upir 2 protocol with self - submission @xmath68 is obtained from the p2p upir 1 protocol by replacing step 3 ( a ) by : + _ 3 ( a ) @xmath17 selects a point @xmath67 on @xmath36 ; with probability @xmath68 he selects @xmath69 , else he selects uniformly at random @xmath66 on @xmath36 ; _    as will be proved in proposition  [ prop : selfsubmission ] , the p2p upir 2 protocol should be executed with self - submission @xmath70 .",
    "in this section we will define the formal framework in which the rest of the analysis will take place .",
    "let @xmath14 be a community of users implementing an instance of the p2p upir protocol .",
    "for every user @xmath22 we define the _ real query profile _ @xmath71 as the temporal sequence of queries which @xmath17 posts to the communication spaces and the _ apparent query profile _ @xmath72 as the temporal sequence of queries which the user posts to the server . by extension",
    "we define the real query profile @xmath73 and the apparent query profile @xmath74 of a set of users @xmath75 .",
    "a _ query _ is a set of one or more search terms .",
    "a _ repeated query _ is a query which occurs more than once in the real profile of a user .",
    "a _ repeated variation of a query _ is a query posted by a user which is a slight modification of a previous query posted by the same user .",
    "the latter definition is vague and ambiguous , but still useful .",
    "we say that a profile is _ rare _ if it contains many unique queries or unique combinations of queries and we say that it has repetition if it contains many repeated queries or repeated variations of queries .      in @xcite ,",
    "three types of privacy protection are distinguished , in function of the entity for whom the protection is provided : _ respondent privacy _ , _ owner ( holder ) privacy _ and _ user privacy_. the aim of the p2p upir protocol is to provide anonymous database search , which falls under the area of anonymous communication , or , following the notation in @xcite , user privacy .",
    "however , in this article we choose to model it in the context of respondent privacy , as a method for disclosure control of databases .",
    "the database protected by p2p upir is then the collection of queries that the users of the protocol post to the server , or in other words , the real profiles of the users .",
    "there are two important differences between traditional disclosure control for statistical databases ( respondent privacy ) and disclosure control for p2p upir ( user privacy interpreted as respondent privacy ) :    * typically , in respondent privacy , the disclosure control is applied to a given database .",
    "the p2p upir protocol is however executed in real - time as the users post queries to the server , that is , as the information is introduced into the database .",
    "we may say that the p2p upir is a _ streaming _ disclosure control method ; * for respondent privacy , it is typically important to balance low disclosure risk with low information loss , since it is useless to publish a database without information . in the p2p upir protocol ,",
    "the users anonymize the data they give to the server themselves , instead of leaving this task to the server . for the aim of p2p upir",
    ", there is no need to control the utility of the query profiles collected by the server .",
    "we will assume that the users have no interest in providing a useful statistical database .",
    "some users find useful some of the services provided by the server that are based on their query ( or mail ) profile .",
    "also , typically , the server provides query searches for free , in exchange for the valuable information that is collected in the query profiles .",
    "we propose that the query profile should be maintained by the user himself , and provided to the server when so desired .",
    "this approach would put the privacy of the user in the hand of the user , where it should be .    consider a community of @xmath46 users @xmath14 implementing an instance of the p2p upir 1 protocol . without loss of generality",
    ", we can limit the analysis to some time interval @xmath50 .",
    "then we note by @xmath76 and @xmath77 the profiles @xmath78 and @xmath79 restricted to @xmath50 . in this context",
    ", the p2p upir protocol is a transformation of the database which we will denote by @xmath80 where @xmath81 is the space of all possible query databases .",
    "the database @xmath76 is a table where the identifier is the user i d , and there is an attribute q(@xmath82 ) for every approximate time interval @xmath82 , containing a single query posted to the server by the user approximately at time @xmath82 , or a null entry .    after applying @xmath83 to this table",
    "we obtain the transformed database @xmath77 .",
    "the action of @xmath83 can be described as swapping the data in the column @xmath84 , under the constraint that the content in the record @xmath17 can be replaced by the content in the record @xmath18 only if @xmath85 .",
    "disclosure control methods of this type are called data swapping ( first appearance in  @xcite ) .",
    "observe that @xmath83 also adds some noise to the time stamps of the queries . for example , the fact that @xmath17 posts first @xmath86 and then @xmath87 to the community of users , does not imply that @xmath86 is posted before @xmath87 to the server .",
    "therefore , in order for the swapping to preserve columns , we should think of the queries in @xmath77 as sorted according to the time they are posted to the community of users , not according to the time they are posted to the server .",
    "in this section we will discuss attacks on p2p upir and some countermeasures .",
    "the purpose with the p2p upir protocol is to protect the privacy of the user when retrieving information from a server",
    ". therefore our main concerns are attacks from the server , or adversaries that have characteristics similar to the server .",
    "we will also briefly consider attacks from other users .      in the p2p upir 1 protocol",
    "the user forwards to the server only queries from collinear users different from himself .",
    "consider a community of users implementing the p2p upir 1 protocol and suppose that the initialization protocol is given a combinatorial configuration such that there are points with unique neighborhoods .",
    "that is , there are points @xmath22 such that @xmath88 for every @xmath89 , @xmath90 .",
    "the users are mapped to the points in the combinatorial configuration , and a user @xmath17 will share communication spaces with the set of users @xmath33 , so that the users who post the queries in @xmath71 are the users in @xmath33 . now suppose that the user @xmath17 repeats the same query over and over again .",
    "after a while , the probability that all users in @xmath33 have posted the query will be high .",
    "therefore , since we know that @xmath17 is the only user with the neighborhood @xmath33 , if the query is rare , then we will be able to link the query to the user @xmath17 , and so the anonymity provided by the protocol is broken .",
    "the article @xcite discussed the fact that it is very common that users of web - based search engines post the same or a slightly modified version of the same query several times .",
    "other references on this subject are @xcite .",
    "examples of combinatorial configurations with unique neighborhoods are provided in section  [ sec : unique_neighborhoods ] and combinatorial configurations with @xmath40-anonymous neighborhoods are discussed in section  [ sec : combconfnanneighbors ] .",
    "we just saw that the p2p upir 1 protocol , which is similar to the version of the p2p upir protocol that appears in @xcite , can be attacked if the configuration that is used has points with unique neighborhoods .",
    "examples of combinatorial configurations with unique neighborhoods are the linear spaces ( see section  [ sec : unique_neighborhoods ] ) .",
    "this is a problem , since otherwise the linear spaces are optimal configurations for p2p upir , if we consider the anonymity of the user in front of the server .",
    "the use of a linear space maximizes the number of apparent profiles into which the real profile of a user is diffused , under the restriction that we keep the cardinality of the user community fixed .",
    "in particular , a linear space is the only type of combinatorial configuration in which , for all points @xmath17 , the point set satisfies @xmath91    we want to modify the protocol so that the use of linear spaces resists the attack described in the previous section .",
    "a first approach is to let the user @xmath17 forward also his own queries . in this way he will forward the queries from @xmath32 .",
    "however , this implies that the users will forward to the server more of their own queries than queries of other users .",
    "indeed , if the user @xmath17 for every line @xmath36 selects a point @xmath67 on @xmath36 with equal probability , then @xmath17 will select @xmath66 with probability @xmath92 , and himself with probability @xmath93 .",
    "the server can therefore infer the real profile of a user from his apparent profile .",
    "there will be partial protection of the privacy of the user in front of the server .",
    "but if we let the protocol run for a while in order to let the user post enough queries , then a user s real profile will be inferable from his apparent profile .    a compromise between these two extremes is to let the user adjust the proportion of self - submission of queries so that his real profile results uniformly distributed over the apparent profiles of the users in @xmath32 .",
    "this is the strategy employed by the p2p upir 2 protocol , as will be illustrated below .",
    "let @xmath94 be a user in a p2p upir community .",
    "we say that @xmath94 s real query profile is uniformly and independently distributed over the apparent query profiles of a set of users @xmath4 , if , for all queries @xmath95 and for all users @xmath96 , the events `` @xmath17 forwards @xmath62 to the server '' , have equal probability and are mutually independent .",
    "a user @xmath94 in a community of users who are executing the p2p upir 1 protocol from the p2p upir init protocol , selects the proxy for every query uniformly at random from @xmath97 , and the choices are independent .",
    "it is therefore clear that the @xmath98 is uniformly and independently distributed over the apparent query profiles of @xmath97 .",
    "we will now see that we can adjust the self - submission in p2p upir 2 and achieve a uniform and independent distribution of @xmath98 over the apparent query profiles of @xmath99 .",
    "[ prop : selfsubmission ] let @xmath94 be a user in a p2p upir 2 community . then @xmath94 s real query profile is uniformly and independently distributed over the apparent query profiles of @xmath99 , if and only if @xmath94 s probability of query self - submission is @xmath100 .",
    "the set of users who forwards @xmath98 to the server is @xmath99 .",
    "it is clear that @xmath98 is uniformly distributed over @xmath99 if the probability for any user in @xmath99 to forward any of @xmath94 s queries is @xmath101 . in particular",
    "this implies that for @xmath98 to be uniformly distributed over @xmath99 , @xmath94 should have self - submission probability @xmath101 .",
    "we have @xmath102 for all @xmath17 .",
    "we will now see that , for @xmath98 to be uniformly distributed over @xmath99 , it is sufficient that @xmath94 has self - submission probability @xmath103 .",
    "suppose @xmath94 has self - submission probability @xmath103 .",
    "let @xmath62 be a query in @xmath98 .",
    "the probability that @xmath62 is posted to the community is @xmath104 .",
    "the queries in @xmath98 are distributed by @xmath94 over his communication spaces following a uniform distribution , so the probability that @xmath62 is posted to the communication space @xmath36 is @xmath105 .",
    "there are @xmath1 other users than @xmath94 connected to @xmath36 , and they are selected using a uniform distribution , so the probability that any particular user @xmath106 will read and forward @xmath62 is @xmath107 which equals the probability that @xmath94 forwards @xmath62 .",
    "the choices of communication space and user are independent , so we conclude that for every query @xmath62 that @xmath94 posts to the community of users , the events `` @xmath17 forwards @xmath62 to the server '' have equal probability for all @xmath108 and that the choices of @xmath17 are all mutually independent .    from now on",
    ", we will always assume that the p2p upir 2 protocol is implemented with self - submission @xmath109 , as indicated by proposition  [ prop : selfsubmission ] .",
    "the p2p upir 2 protocol with self - submission @xmath109 avoids the attack described in section  [ sec : attack1 ] , when the configuration that is used is a linear space .",
    "however , in general , for other combinatorial configurations , the p2p upir 2 protocol also presents weaknesses in case of repeated queries .",
    "the real query profile of @xmath17 is independently and uniformly distributed over the apparent profiles of @xmath32 .",
    "if @xmath17 repeats a rare query enough , then this query can be linked to him whenever the set @xmath32 can .",
    "examples of combinatorial configurations with unique closed neighborhoods are provided in section  [ sec : unique_neighborhoods ] and we discuss combinatorial configurations with @xmath40-anonymous closed neighborhoods in section  [ sec : nanonymousclosedneighborhoods ] .",
    "swanson and stinson described an attack on the p2p upir 2 protocol that was based on the intersection of closed neighborhoods  @xcite .",
    "following @xcite , they also use a repeated rare query or variation of query , say @xmath62 . instead of focusing on the closed neighborhood of the real owner of @xmath62 , their concern is the closed neighborhood of the proxy .",
    "the attack consists in intersecting the closed neighborhoods of the users who act as proxy for the query @xmath62 .",
    "the result of the attack is set of users containing the anonymity set of the origin of the query .",
    "if this set is small , we have reidentification .",
    "it is clear that there is an analogous attack on the p2p upir 1 protocol , intersecting the neighborhoods of the proxies .",
    "these attacks are performed by a curious server , just as the attacks in section  [ sec : attack1 ] and [ sec : attack2 ] .",
    "it is easy to see that an intersection attack can take place if and only if the configuration that is used in the protocol has unique neighborhoods or closed neighborhoods , respectively .",
    "therefore , the two types of attacks are essentially the same .",
    "as observed by swanson and stinson , we can also consider intersection attacks in which the adversary is a user in the community . in this case",
    "@xmath38 proxies collude in order to find the origin of a sequence of @xmath36 linked queries .",
    "swanson and stinson use other incidence structures than configurations , where two points may appear together in more than one block . in this case , the proxies can intersect the blocks over which they received @xmath62 . if we use combinatorial configurations , this does not occur , so this is a strong reason for using combinatorial configurations in p2p upir .",
    "below we briefly list other possible attacks :    * the adversary can reveal the underlying combinatorial structure , by introducing users owned by him in the community .",
    "this attack was briefly discussed in @xcite ; * the adversary can determine who is in the community , since these users will have very similar apparent query profiles , and this profile will differ from apparent query profiles of users outside the community .      we want to point out that although p2p upir 2 allows for the use of linear spaces without risk for intersection attacks , and the linear spaces have neighborhoods of maximal cardinality , the original p2p upir 1 protocol is still slightly simpler in implementation .",
    "this would be even more so , if the self - submission was expressed as a proportion of the query profile . because of its simplicity , the use of the p2p upir 1 protocol is still justified , if anonymity can be ensured .",
    "in this section we specify the type of privacy that can be attained using p2p upir .",
    "we also show which combinatorial configurations to use in order to attain this privacy .",
    "we will use the notations on database disclosure control , introduced in section  [ sec : notations ] . as commented there , there is no interest in preserving the utility of the database in the transformation .",
    "we are only interested in minimizing the disclosure risk .",
    "the best result would therefore be a protected database completely free from information . the p2p upir protocol can not achieve this , as single queries contain information and are indivisible .",
    "the purpose of p2p upir is to cause confusion on who is the real sender of the query .",
    "it is useful to have a measure of the provided confusion .",
    "if the cardinality of the anonymity set for the owner of any sequence of linked queries ( or query ) is at least @xmath40 , then we say that we have _ @xmath40-confusion .",
    "_ in this case we say that we have _ @xmath40-confusing _",
    "p2p upir .",
    "if it is known who is in the community of users @xmath14 , then the confusion on who is the sender of a query ( i.e. the cardinality of the anonymity set ) , can not be larger than the set of users . in section",
    "[ sec : attack_altres ] we saw that the server can see who is in the community , since these users will have similar apparent query profiles .",
    "therefore , the best we can aspire for is a confusion of magnitude @xmath110 on who is the owner of a query . in general , we want to cause confusion on who is the owner of a sequence of queries , also when the sequence is linkable by content . also in this case , the obvious upper bound for the confusion",
    "is @xmath111 .",
    "we are interested in achieving @xmath40-confusion also for @xmath112 , if this can be justified by other advantages , for example , as in this article , if it permits us to use the simpler p2p upir 1 protocol , instead of the slightly more complicated p2p upir 2 protocol .    in the following example",
    "we see that @xmath40-confusion with @xmath113 can fail to be achieved by p2p upir , if the sequence of linked queries contains a quasi - identifier",
    ". therefore , in this case , the owner of the query sequence will not be anonymous .",
    "[ ex : nonanonymity ] consider a sequence @xmath2 of queries posted by a user @xmath17 that is linkable by content .",
    "observe that this does not imply that @xmath2 is linkable to @xmath17 .",
    "suppose that the content of the queries in @xmath2 gives information for linking @xmath2 to @xmath17 .",
    "then the anonymity set of @xmath2 has cardinality one , so p2p upir can not provide anonymity for @xmath17 with respect to @xmath2 .    in the following",
    "we will always assume that @xmath77 does not contain sequences of linkable queries with quasi - identifiers . under this assumption ,",
    "the privacy provided by p2p upir in case of sequences of linked queries is anonymity ; we can link the queries but we can not link them to their owner .",
    "the presence of sequences of queries that are linkable because of their content , obstructs unlinkability in p2p upir .",
    "however , if we assume that the adversary can not use the query content for the analysis , then unlinkability can be provided for the queries .",
    "this situation may occur , for example , if the range of possible queries is small .",
    "more precisely , it occurs if there are no rare repeated queries .",
    "either we have anonymity or we do not .",
    "anonymity is therefore provided by p2p upir if the protocol satisfies @xmath40-confusion with @xmath114 the anonymity of a user can be broken by a collusion of the @xmath115 other users in his anonymity set . therefore it is interesting to maximize @xmath40 .    in the previous discussion",
    "we have always assumed that the information that is available to the adversary is the same information that is available to the server .",
    "we have anonymity also with respect to other users if the identity of the owner of a query , or a sequence query , is known only to this user .",
    "this occurs if traffic analysis is prohibited , there are no linked sequence of queries with quasi - identifier , and the number of users @xmath0 on every communication space is large . if @xmath116 then one of the two users know with certainty who is the owner of the query . in general , a collusion of @xmath1 users is needed to deduce the identity of the query owner .",
    "therefore it is interesting to maximize @xmath0 .    on the other hand , if we assume that the adversary user can see the identity of the query owner , using for example traffic analysis , or if there are linked sequences with quasi - identifier , then it is interesting to break up the real query profiles in small parts , in order to provide some confidentiality . in this case",
    "it is therefore interesting to maximize @xmath19 , the number of communication spaces per user .",
    "it is clear that the use of p2p upir does not imply that the resulting database @xmath77 is @xmath40-anonymous in the sense of definition  [ 1:def : nan ] .",
    "indeed , @xmath77 will not in general have @xmath40 occurrences in @xmath40 different records of any sensitive sequence @xmath2 .",
    "the attacks in sections  [ sec : attack1 ] and [ sec : attack2 ] suggest that there is a quasi - identifier present in @xmath77 . for p2p upir 1 and p2p upir 2 this",
    "quasi - identifier is the set of neighborhoods and the set of closed neighborhoods , respectively .    formally , before transforming the database @xmath76 using the p2p upir protocol transformation @xmath83 ,",
    "we first add the attribute @xmath33 ( or @xmath32 ) of @xmath22 to @xmath76 . the attribute @xmath117 ( resp .",
    "@xmath118 ) is invariant for the action of @xmath83 , which in particular means that @xmath83 preserves its quasi - identifying property .",
    "according to definition [ 1:def : nan ] , in order to make @xmath77 @xmath40-anonymous with respect to this quasi - identifier , we have to ensure that every element of the set of neighborhoods ( resp .",
    "the set of closed neighborhoods ) occurs at least @xmath40 times in @xmath77 .",
    "[ def : nanconf1 ] we say that a combinatorial configuration has @xmath40-_anonymous neighborhoods _ ( resp .",
    "@xmath40-_anonymous closed neighborhoods _ ) , if every neighborhood ( resp . closed neighborhood ) of a point , is the neighborhood ( resp . closed neighborhood ) of at least @xmath40 points .    [ cols=\"^,^,^ \" , ]",
    "the privacy provided to the users of @xmath40-anonymous p2p upir 1 is @xmath40-confusion , where @xmath40 is the cardinality of the anonymity sets .",
    "the points in the same anonymity set have the same neighborhood . as we saw in proposition",
    "[ prop : p2pnconf ] , if query sequences can not be linked by content , then we have @xmath119-confusion , since this is the cardinality of the neighborhood of the proxy of a single query .",
    "it is therefore interesting to maximize both @xmath40 and @xmath119 , although which one is the most important may depend on the context .    in a combinatorial configuration with @xmath40-anonymous neighborhoods , the anonymity set and the neighborhood of a point",
    "are disjoint .",
    "therefore , maximizing @xmath40 and @xmath119 simultaneously is the same as requiring @xmath120 , so that the anonymity set and the neighborhood together form the entire point set of the configuration .",
    "it is easy to see that a transversal design satisfies this condition , since a point @xmath17 in a transversal design is neighbor with all points that are not in the anonymity set of @xmath17 .    indeed ,",
    "if we in lemma  [ thm : charnanonym ] add a restriction on regularity of the group cardinalities , and maximize @xmath40 , what we get are exactly the transversal designs .    in a combinatorial @xmath48-configuration @xmath34 with @xmath40-anonymous neighborhoods and anonymity partition @xmath121 and @xmath122 for all @xmath123 $ ] , we have that    @xmath124 if and only if @xmath125 .    in this case @xmath34 is a transversal design @xmath58 and @xmath126 , @xmath127 .    since the configuration is connected , if @xmath124 , then necessarily @xmath128 . on the other hand ,",
    "if @xmath128 , then necessarily @xmath124 , since if we fix one part @xmath129 and a point @xmath130 , then a line through @xmath131 has @xmath0 points through @xmath128 distinct parts @xmath129 , so the line have one point in every part in @xmath132 .",
    "for any part @xmath133 different from @xmath131 there is also a total of @xmath40 lines through @xmath17 .",
    "since these lines have one point in every part of @xmath132 , we get @xmath124 .",
    "a transversal design is a uniform group divisible design in which the number of groups @xmath134 equals the length of the blocks @xmath0 .",
    "we have seen that an @xmath40-anonymous combinatorial @xmath135-configuration such that @xmath122 and @xmath125 satisfy exactly these conditions , so it is a transversal design @xmath58 .",
    "in section  [ sec : nconfnan ] we saw that combinatorial configurations with @xmath40-anonymous closed neighborhoods are interesting for p2p upir 2 . by now , the reader is already familiar with the most important example of combinatorial configurations with @xmath40-anonymous closed neighborhoods .",
    "[ prop : lin_anon ] a linear space on @xmath40 points has @xmath40-anonymous closed neighborhoods .    in a linear space",
    "all points are collinear .",
    "after all , there is not much difference between the definition of @xmath40-anonymous neighborhoods and the definition of @xmath40-anonymous closed neighborhoods .",
    "the next theorem  [ thm : nanonym(iii)from(i ) ] shows that we can use combinatorial configurations with the former property to construct combinatorial configurations with the latter property .",
    "[ thm : nanonym(iii)from(i ) ] let @xmath34 be a combinatorial @xmath48-configuration with @xmath40-anonymous neighborhoods such that @xmath136 .",
    "then there also exists a combinatorial @xmath137-configuration @xmath138 with @xmath40-anonymous closed neighborhoods .",
    "let @xmath34 be as stated above .",
    "then every point shares neighborhood with exactly @xmath40 more points .",
    "theorem  [ thm : charnanonym ] implies that in @xmath34 there is a partition @xmath132 of the point set so that points in the same partition are the points with the same neighborhood .",
    "this implies that points in the same partition are not collinear .",
    "define @xmath138 by adding @xmath139 new lines , so that every new line contains only points from the same part of @xmath132 .",
    "let @xmath4 be a set of points with the same neighborhood in @xmath34 .",
    "for any @xmath96 there are @xmath1 other points @xmath140 in @xmath4 collinear with @xmath17 by one of the new lines , such that @xmath141 for @xmath142 .",
    "this concludes the proof .    as a corollary of theorem  [ thm : nanonym(iii)from(i ) ] we get that an affine plane of order @xmath0 is a combinatorial configuration with @xmath0-anonymous closed neighborhoods .",
    "just apply the construction in the proof of theorem  [ thm : nanonym(iii)from(i ) ] to a transversal design @xmath143 .",
    "but an affine plane of order @xmath0 is a linear space on @xmath144 points , so we already know from proposition  [ prop : lin_anon ] that it is a @xmath145-anonymous combinatorial configuration for p2p upir 2 . indeed , @xmath40-anonymity implies @xmath38-anonymity for all @xmath146 .",
    "observe though that in general the combinatorial @xmath49-configuration constructed in theorem  [ thm : nanonym(iii)from(i ) ] is @xmath0-anonymous but not @xmath38-anonymous for @xmath147 .",
    "not all combinatorial configurations with @xmath40-anonymous closed neighborhoods can be obtained using the construction in theorem  [ thm : nanonym(iii)from(i ) ] .",
    "for example , we can not use this method to construct a finite projective plane .",
    "the p2p upir 2 was designed to provide @xmath40-confusion with linear spaces .",
    "we have the following result .",
    "[ thm : optpp ] a regular linear space on @xmath46 points provides @xmath40-confusing p2p upir 2 with @xmath148 .",
    "this is optimal .",
    "it is immediate that a linear space provides @xmath40-confusing p2p upir 2 with @xmath148 .",
    "since the confusion can not be larger than the total number of points @xmath46 in the configuration , this is optimal .",
    "a linear space is a @xmath149-bibd .",
    "more generally , in a @xmath51-bibd any two points are connected by @xmath150 lines , so also in this case we have optimal @xmath40-confusing p2p upir 2 . however , then the bibd is not a combinatorial configuration . in this article",
    "we have provided reasons that justify the use of combinatorial configurations for p2p upir . as was observed in @xcite , other incidence structures",
    "are also interesting , in particular if it is assumed that colluding users can communicate over channels that are exterior to the protocol .",
    "we have presented two different p2p upir protocols , p2p upir 1 in which the users do not self - submit and p2p upir 2 in which they do .",
    "then we described an attack on p2p upir 1 , based on unique neighborhoods , and adjusted the self - submission for p2p upir 2 in order to avoid neighborhood attacks on linear spaces .",
    "we also showed that p2p upir 2 is still vulnerable to closed neighborhood attacks , if the closed neighborhoods in the combinatorial configurations are unique .",
    "we gave examples of combinatorial configurations with unique neighborhoods and unique closed neighborhoods .",
    "then we presented the combinatorial configurations with @xmath0-anonymous neighborhoods and @xmath0-anonymous closed neighborhoods , respectively .",
    "we characterized , as @xmath40-confusion , the privacy provided by a p2p upir protocol that uses one of the combinatorial configurations from these families .",
    "finally we studied the combinatorial configurations with @xmath0-anonymous neighborhoods and @xmath0-anonymous closed neighborhoods .",
    "we distinguished the transversal designs and the linear spaces as optimal configurations for p2p upir from these two families , respectively .",
    "we want to point out that there are two trivial ways to connect communication spaces and users ; the all - to - all and the one - to - all distributions . as combinatorial structures both can be interpreted as degenerated linear spaces , since every pair of points ( users ) share exactly one line ( communication space ) .",
    "used in the p2p upir 2 protocol , they provide the same anonymity in front of the server as does a linear space with the same number of points .",
    "however , with respect to other users , there is no anonymity in the all - to - all distribution and confidentiality is lost in the all - to - one distribution .",
    "consequently , the reason why non - degenerated combinatorial configurations are interesting for p2p upir 2 , is because they offer some anonymity and confidentiality with respect to the other users in the community .",
    "the authors want to thank maria bras - amors , douglas r. stinson , colleen swanson , vicen torra and the anonymous referees for useful discussions and suggestions",
    ". partial support by the spanish mec projects ares ( consolider  ingenio  2010  csd2007 - 00004 ) and ripup ( tin2009 - 11689 ) is acknowledged .",
    "the authors are with the unesco chair in data privacy , but their views do not necessarily reflect those of unesco nor commit that organization .",
    "r. j. r. abel , c.j .",
    "colbourn and j.h .",
    "dinitz ( 2007 ) mutually orthogonal latin squares ( mols ) . in the second edition of c.j .",
    "colbourn , j.h .",
    "dinitz ( eds . ) `` the crc handbook of combinatorial designs . '' crc press , boca raton , fl , pp",
    ". 160193 .",
    "a. pfitzmann , m .",
    "khntopp and h. federrath ( 2001 ) _ anonymity , unobservability , and pseudonymity  a proposal for terminology .",
    "_ in designing privacy enhancing technologies , lecture notes in computer science , springer berlin / heidelberg , 2009 , pp .",
    "an updated version of this document can be found at the following url ( accessed february 2012 ) a. spink , d. wolfram , m. b. j. jansen , t. saracevic ( 2001 ) _ searching the web : the public and their queries .",
    "_ journal of the american society for information science and technology , 52:3 , pp .",
    "226234 .",
    "k. stokes and m. bras - amors ( 2011 ) _ on query self - submission in peer - to - peer user - private information retrieval .",
    "_ proceedings of the 4th international workshop on privacy and anonymity in the information society ( pais11 ) , acm , new york , ny , usa . k. stokes and m. bras - amors ( 2010 ) _ optimal configurations for peer - to - peer user - private information retrieval . _ computers & mathematics with applications , 59:4 , pp .",
    "1568  1577 .",
    "k. stokes and m. bras - amors ( 2011 ) _ combinatorial structures for an anonymous data search protocol .",
    "_ proceedings of workshop on computational security , crm ( uab ) , barcelona , november 28 - december 2 , 2011 .",
    "j. teevan , e. adar , r. jones , m. potts ( 2005 ) _ history repeats itself : repeat queries in yahoo s query logs .",
    "_ in proceedings of the 29th annual acm conference on research and development in information retrieval ( sigir 06 ) ."
  ],
  "abstract_text": [
    "<S> anonymous database search protocols allow users to query a database anonymously </S>",
    "<S> . this can be achieved by letting the users form a peer - to - peer community and post queries on behalf of each other . in this article </S>",
    "<S> we discuss an application of combinatorial configurations ( also known as regular and uniform partial linear spaces ) to a protocol for anonymous database search , as defining the key - distribution within the user community that implements the protocol . </S>",
    "<S> the degree of anonymity that can be provided by the protocol is determined by properties of the neighborhoods and the closed neighborhoods of the points in the combinatorial configuration that is used . </S>",
    "<S> combinatorial configurations with unique neighborhoods or unique closed neighborhoods are described and we show how to attack the protocol if such configurations are used . </S>",
    "<S> we apply @xmath0-anonymity arguments and present the combinatorial configurations with @xmath0-anonymous neighborhoods and with @xmath0-anonymous closed neighborhoods . </S>",
    "<S> the transversal designs and the linear spaces are presented as optimal configurations among the configurations with @xmath0-anonymous neighborhoods and @xmath0-anonymous closed neighborhoods , respectively . </S>"
  ]
}