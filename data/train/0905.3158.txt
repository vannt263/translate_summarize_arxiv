{
  "article_text": [
    "queueing networks , petri nets , and chemical reaction networks , are three mathematical models of `` networks '' , each of them with an identified community of researchers .    in queueing theory ,",
    "the existence of `` product form '' markovian networks is one of the cornerstones and jewels of the theory .",
    "monographies are dedicated to the subsect , e.g. kelly  @xcite or van dijk  @xcite .",
    "roughly , the interest lies in the equilibrium behavior of a markovian queueing network .",
    "the existence of such an equilibrium is equivalent to the existence of a stationary distribution @xmath0 for the queue - length process . in some remarkable cases ,",
    "@xmath0 not only exists but has an explicit decomposable shape called `` product form '' .",
    "the interest is two - fold .",
    "first , from a quantitative point of view , it makes the explicit computation of @xmath0 possible , even for large systems .",
    "second , the product form has important qualitative implications , like the `` poisson - input poisson - output '' theorems .",
    "consequently , important and lasting efforts have been devoted to the quest for product form queueing networks .",
    "it is attractive and natural to try to develop an analog theory for markovian petri nets , with the marking process replacing the queue - length process .",
    "there is indeed a continuous string of research on this topic since the nineties , e.g. @xcite .",
    "tools have been developped in the process which build on classical objects of petri net theory ( e.g. closed support t - invariants ) .",
    "the most accomplished results are the ones in @xcite .    in chemistry and biology , models of chemical reaction networks",
    "have also emerged .",
    "such a network is specified by a finite set of reactions between species of the type `` @xmath1 '' , meaning that two molecules of @xmath2 can interact with one molecule of @xmath3 to create one molecule of @xmath4 .",
    "the dynamics of such models is either deterministic or stochastic , see @xcite .",
    "deterministic models are the most studied ones ; they correspond to coupled sets of ordinary differential equations .",
    "the most significant result is arguably the deficiency zero theorem of feinberg  @xcite .",
    "deficiency zero is a structural property which can be very easily checked knowing the shape of the reactions in a chemical network .",
    "it does not refer to any assumption on the associated dynamics .",
    "feinberg theorem states that if a network satisfies the deficiency zero condition , then the associated deterministic dynamic model has remarkable stability properties .",
    "an intermediate result is to prove that a set of non - linear equations ( nle ) have a strictly positive solution .",
    "stochastic models of chemical reaction networks correspond to continuous - time markov processes of a specific shape .",
    "such models were considered in chapter 8 of the seminal book by kelly  @xcite . there",
    "it is proved that if a set of non - linear `` traffic equations '' ( nlte ) have a strictly positive solution then the markov process has a product form .",
    "how does feinberg result connect with product form markovian petri nets  ?",
    "a first observation is that chemical reaction networks and petri nets are two different descriptions of the same object .",
    "this has been identified by different authors in the biochemical community : see for instance @xcite and the references therein .",
    "conversely , petri nets were originally introduced by carl adam petri to model chemical processes , see @xcite .",
    "a second observation was made recently by anderson , craciun , and kurtz  @xcite .",
    "they observe that the nle of feinberg and the nlte of kelly are the same .",
    "it implies that if a chemical network has deficiency zero , then the stochastic dynamic model has a product form .    in the present paper ,",
    "we combine the two observations .",
    "the deficiency zero condition provides a sufficient condition for a markovian petri net to have a product form .",
    "the deficiency zero condition is equivalent to another criterion known in the petri net literature  @xcite .",
    "the advantage is that deficiency is easy to compute and handle .",
    "the class of petri nets whose markovian version have a product form is an interesting one .",
    "it is therefore natural to study how this class intersects with the classical families of petri nets : state machines and free - choice petri nets .",
    "we use the simplicity of the deficiency zero condition to carry out this study .",
    "the central result that we prove is , in a sense , a negative result .",
    "we show that within the class of free - choice petri nets , the only ones which have a product form are closely related to state machines .",
    "we also show that the markovian state machines are `` equivalent '' to jackson networks . the latter form",
    "the most basic and classical example of product form queueing networks .    a conference version of the present paper appeared in @xcite . compared with @xcite ,",
    "additional results have been proved : the equivalence between deficiency 0 and the condition of haddad @xmath5 al @xcite ( prop .",
    "[ pr : hmss2 ] ) , and the results in section [ sse - addi ] .",
    "we use the notation @xmath6 . the coordinate - wise ordering of @xmath7 is denoted by the symbol @xmath8 .",
    "we say that @xmath9 is _ strictly positive _ if @xmath10 for all @xmath11 .",
    "we denote by @xmath12 the indicator function of @xmath13 , that is the mapping taking value 1 inside @xmath13 and 0 outside .",
    "our definition of petri net is standard , with weights on the arcs .",
    "[ def : pn ] a _ petri net _ is a 6-tuple @xmath14 where :    * @xmath15 is a directed bipartite graph , that is , @xmath16 and @xmath17 are non - empty and finite disjoint sets , and @xmath18 is a subset of @xmath19 * @xmath20 , @xmath21 are such that @xmath22 $ ] and @xmath23 \\,;$ ] * @xmath24 belongs to @xmath25    the elements of @xmath16 are called _ places _ , those of @xmath17 are called _",
    "transitions_. the 5-tuple @xmath26 is called the _ petri graph_. the vectors @xmath27 and @xmath28 , @xmath29 , are called the _ input bag _ and the _ output bag _ of the transition @xmath30 .",
    "the _ weight _ of the arc @xmath31 ( resp .",
    "@xmath32 ) is @xmath33 ( resp .",
    "@xmath34 ) .",
    "an element of @xmath35 is called a _ marking _ , and @xmath24 is called the _",
    "initial marking_.    petri nets inherit the usual terminology of graph theory .",
    "graphically , a petri net is represented by a directed graph in which places are represented by circles and transitions by rectangles .",
    "the initial marking is also materialized : if @xmath36 , then @xmath37 tokens are drawn inside the circle @xmath38 . by convention , the weights different from 1 are represented on the arcs .",
    "see figures [ fig : ltenotnlte ] or [ fi-4 ] for examples .",
    "a petri net is a dynamic object .",
    "the petri graph always remains unchanged , but the marking evolves according to the _ firing rule_. a transition @xmath30 is _ enabled _ in the marking @xmath39 if @xmath40 , then @xmath30 may _ fire _ which transforms the marking from @xmath39 into @xmath41 we write @xmath42 .",
    "a marking @xmath43 is _ reachable _ from a marking @xmath39 if there exists a ( possibly empty ) sequence of transitions @xmath44 and sequence of markings @xmath45 such that @xmath46 we denote by @xmath47 the set of markings which are reachable from @xmath39 .",
    "[ def : markinggraph ] the _ marking graph _ of a petri net with initial marking @xmath24 is the directed graph with    * nodes : @xmath48 arcs : @xmath49    the marking graph defines the state space on which the marking may evolve .",
    "observe that the marking graph may be finite or infinite .",
    "in section [ subsec : spn ] , we will define a _",
    "markovian petri net _ as a continuous - time markovian process evolving on the marking graph .",
    "the analysis of petri nets relies heavily on linear algebra techniques , the central object being the incidence matrix .",
    "the _ incidence matrix _",
    "@xmath50 of the petri net @xmath51 is the @xmath52-matrix @xmath50 defined by : @xmath53    figure [ fig : ltenotnlte ] represents a petri net with places @xmath54 and transitions @xmath55 .",
    "the initial marking is @xmath56 here all the weights of the arcs are equal to 1 .",
    "-7575 - 6075 ( -37.5 , -37.5)@xmath57 ( 37.5 , -37.5)@xmath58 ( -37.5 , 37.5)@xmath59 ( 37.5 , 37.5)@xmath60    ( -1.5 , 1.5)@xmath61 ( -7.5 , 60)@xmath62 ( -24 , 1.5)@xmath63 ( -46.5 , 1.5)@xmath64 ( 21 , 1.5)@xmath65 ( 43.5 , 1.5)@xmath66      consider a petri net @xmath14 . from",
    "now on , we assume that no two transitions have the same pair input bag - output bag .",
    "so we can identify each @xmath30 with the ordered pair @xmath67 .    in the context of markovian petri nets with race policy ( see  [ subsec : spn ] ) , this assumpion is made without loss of generality .",
    "indeed , several transitions with the same pair of bags can be replaced by a single transition whose transition rate is the sum of the original rates . also this transformation does not modify the deficiency or weak reversibility ( to be defined below ) .    under this assumption , the petri net can be viewed as a triple @xmath68 .",
    "( in particular , the flow relation @xmath69 is encoded in @xmath70 . )",
    "petri nets have appeared with this presentation in different contexts and under different names : _ vector addition systems _ ( see for instance @xcite ) , or _ chemical reaction networks _ ( see for instance @xcite ) .    in the chemical context ,",
    "the elements of @xmath16 are species .",
    "the marking is the number of molecules of the different species .",
    "the elements of @xmath17 are _",
    "reactions_. a reaction @xmath71 is represented as follows : @xmath72    the `` chemical '' form of the petri net in figure [ fig : ltenotnlte ] is : @xmath73    let us now introduce two notions , deficiency and weak reversibility , which are borrowed from the chemical literature .",
    "[ def : reactiongraph ] let @xmath74 be a petri net .",
    "a _ complex _ is a vector @xmath75 in @xmath76 such that : @xmath77 .",
    "the set of all complexes is denoted by @xmath78 .",
    "the _ reaction graph _ associated to the petri net is the directed graph with nodes : @xmath79 , arcs : @xmath80 if @xmath81 .",
    "let @xmath2 be the _ node - arc incidence matrix _ of the reaction graph , that is the @xmath82-matrix defined by @xmath83    [ lem : ranka ] consider a petri net with set of complexes @xmath79 .",
    "let @xmath84 be the number of connected components of the reaction graph .",
    "the rank of the node - arc incidence matrix satisfies : @xmath85    assume that @xmath86 .",
    "consider @xmath87 such that @xmath88 .",
    "let @xmath4 be such that @xmath89 .",
    "consider @xmath90 .",
    "since @xmath86 , there exists an undirected path @xmath91 in the reaction graph .",
    "assume wlog that @xmath92 and let @xmath93 be such that @xmath94 .",
    "by definition of @xmath2 , we have @xmath95 .",
    "so we have @xmath96 for all @xmath11 , and @xmath97 .",
    "we have proved that @xmath98 .",
    "conversely , by definition of @xmath2 , we have @xmath99 .",
    "hence @xmath100 , and by the rank theorem , @xmath101 . for a general value of @xmath84",
    ", we get similarly that @xmath102 .    a central notion in what follows",
    "is the _ deficiency _ of a petri net .",
    "[ deficiency][def : deficiency ] with the above notations , the _ deficiency _ of the petri net is @xmath103    of particular importance are the petri nets with * deficiency 0*. this class will be central in the study of markovian petri nets having a product form , see section [ sec : prodres ] .",
    "such petri nets are `` extremal '' , in a sense made precise by the next proposition .",
    "[ pr - nonneg ] for all @xmath104 : @xmath105 \\implies",
    "\\bigl [ nx    = 0 \\bigr ] \\:.\\ ] ] in particular it implies that : @xmath106 .",
    "equivalently , the deficiency of a petri net is always greater or equal to 0 .",
    "the non - negativity of the deficiency appears in feinberg  @xcite , using a different argument .    using the definition of the matrix @xmath2",
    ", we can rewrite the condition @xmath107 as : @xmath108 now for each place @xmath109 , we have : @xmath110 x_t \\\\ & = &   \\sum_{c \\in \\cc } \\bigl ( \\sum_{t : o(t ) = c } c_s x_t - \\sum_{t : i(t ) = c }",
    "c_s x_t \\bigr )   \\ = \\   \\sum_{c \\in \\cc } c_s \\bigl ( \\sum_{t :",
    "o(t ) = c } x_t - \\sum_{t : i(t ) = c } x_t \\bigr)\\ , .",
    "\\\\\\end{aligned}\\ ] ] using , this last sum is equal to @xmath111 .",
    "the inequality @xmath112 is equivalent to @xmath113 , which follows immediately from .",
    "the second central notion is _ weak reversibility_.    [ def : weakrevers ] a petri net is _ weakly reversible ( wr ) _ if every connected component of the reaction graph is strongly connected .",
    "weak reversibility is a restrictive property , see section [ subsec : freechoice ] .",
    "it is important to observe that a connected and weakly reversible petri net is not necessarily strongly connected .",
    "an example is given below .    -9595 - 2050    ( -45 , 7.5)@xmath38    ( 36.75 , .75)@xmath114 ( 68.25 ,",
    ".75)@xmath38    elementary circuits of the reaction graph can be identified with the so - called `` minimal closed support t - invariants '' of the petri net literature ( see @xcite ) .",
    "in particular , a petri net is weakly reversible if and only if it is covered by minimal closed support t - invariants .",
    "such petri nets are called _",
    "@xmath115-nets _ in @xcite .",
    "[ [ weak - reversibility - and - deficiency-0 . ] ] weak reversibility and deficiency 0 .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    weak reversibility and deficiency 0 are two independent properties , see figure [ fi-4 ] .",
    "the upper - left petri net is an instance of the famous `` dining philosopher '' model .",
    "the petri nets in fig .",
    "[ fi-4 ] are live and bounded except for the upper - right one .    -150150 - 112.5112.5    ( -75 , 15)wr , @xmath116    ( 37.5 , 15)not wr , @xmath116    ( -75 , -105)wr , @xmath117    ( 37.5 , -105)not wr , @xmath117    [ [ algorithmic - complexity . ] ] algorithmic complexity",
    ". + + + + + + + + + + + + + + + + + + + + + + +    weak reversibility and deficiency 0 are algorithmically simple to check .",
    "let us determine the time complexity of the algorithms with respect to the size of the petri net ( number of places and transitions ) .",
    "observe first that the number of complexes is bounded by @xmath118 . building the reaction graph from the petri graph",
    "can be done in time @xmath119 .",
    "a depth - first - search algorithm on the reaction graph enables to check the weak reversibility and to compute the number of connected components ( @xmath84 ) .",
    "the dfs algorithm runs in time @xmath120 . computing the rank of the incidence matrix",
    "can be done in time @xmath121 using a gaussian elimination .",
    "globally the complexity is @xmath121 for computing the deficiency as well as for checking weak - reversibility .",
    "a petri net is a logical object with no physical time involved .",
    "there exist several alternative ways to define timed models of petri nets , see for instance @xcite .",
    "we consider the model of markovian petri nets with race policy .",
    "the rough description is as follows .    with each enabled transition",
    "is associated a `` countdown clock '' whose positive initial value is set at random .",
    "when a clock reaches 0 , the corresponding transition fires .",
    "this changes the set of enabled transitions and all the clocks get reinitialized .",
    "the initial values of the clocks are chosen independently , according to an exponential distribution whose rate depends on the transition and on the current marking .",
    "with probability 1 , no two clocks reach zero at the same time so the model is unambiguously defined .",
    "enabled transitions are involved in a `` race '' : the transition to fire is the one whose clock will reach zero first .",
    "we now proceed to a formal definition of the model .    when @xmath122 , the firing of transition @xmath30 does not modify the marking , nor the distribution of the value of the clocks ( memoryless property of the exponential ) . without loss of generality ,",
    "we assume from now on that @xmath123 for all @xmath30 .",
    "[ def : spn ] a _ markovian petri net ( with race policy ) _ is formed by a petri net @xmath124 and a set of _ rate functions _",
    "@xmath125 , @xmath126 , satisfying @xmath127 for some constants @xmath128 , and some functions @xmath129 and @xmath130 valued in @xmath131 .",
    "the marking evolves as a continuous - time jump markov process with state space @xmath132 and infinitesimal generator @xmath133 , given by : @xmath134    the shape for the infinitesimal generator is the transcription of the informal description given at the beginning of the section .",
    "the condition for the rate functions @xmath125 is the same as the one in @xcite and ( * ? ? ?",
    "* section 2 ) .",
    "( in ( * ? ? ?",
    "* section 3 ) , an even more general shape for the rate function is considered .",
    ") condition is specifically cooked up in order for the product form result of theorem [ thm : kelly ] to hold , which explains its artificial shape .",
    "this general condition englobes two classical types of rate functions : the constant rates and the mass - action rates .",
    "* constant rates .",
    "* in the petri net literature , the standard assumption is that the firing rates are constant : @xmath135    * mass - action rates .",
    "* in the chemical literature , the rate is often proportional to the number of different subsets of tokens ( i.e. molecules ) that can be involved in the firing ( i.e. reaction ) . more precisely : @xmath136 such rates are said to be of _ mass - action _ form and the corresponding stochastic process has _ mass - action kinetics_. to obtain from , set @xmath137 .",
    "we are interested in the equilibrium behavior of markovian petri nets .",
    "this section presents the product form results which exist in the literature .",
    "we gather results which were spread out , obtained independently either in the petri net community , or in the chemical one .",
    "let @xmath138 be the infinitesimal generator of the marking process .",
    "an invariant measure @xmath0 of the process is characterized by the balance equations @xmath139 , that is : @xmath140 , @xmath141 a stationary distribution is an invariant probability measure .",
    "it is characterized by @xmath139 , @xmath142 .",
    "if @xmath0 is an invariant measure and @xmath143 , then @xmath144 is a stationary distribution .    when the marking graph is strongly connected , the marking process is irreducible .",
    "it follows from the basic markovian theory that the stationary distribution is unique when it exists ( the ergodic case ) .",
    "when the state space is finite , irreducibility implies ergodicity .",
    "[ def : nlte ] consider a markovian petri net with general rates .",
    "let @xmath79 be the set of complexes .",
    "we call _ non - linear traffic equations ( nlte ) _ the equations over the unknowns @xmath145 defined by : @xmath146 , @xmath147 ( with the usual convention that the empty product is 1 . )",
    "the nlte can be viewed as a kind of balance equations ( what goes in equals what goes out ) at the level of complexes .",
    "their central role appears in the next theorem which is essentially due to kelly  ( * ? ? ?",
    "* theorem 8.1 ) ( see also ( * ? ? ? * theorem 4.1 ) ) . in kelly s book , the setting is more restrictive , but the proof carries over basically unchanged .",
    "[ thm : kelly ] consider a markovian petri net .",
    "assume that the nlte ( [ eq : nlte ] ) admit a strictly positive solution @xmath148 .",
    "then the marking process of the petri net has an invariant measure @xmath0 defined by : @xmath149 , @xmath150    we then say that @xmath0 has a _ product form _ : @xmath151 decomposes as a product over the places @xmath38 of terms depending only on the local marking @xmath152 .",
    "observe that @xmath153 for all @xmath154 in .",
    "in particular it implies that the marking process is irreducible . on the other hand , the measure defined in may have a finite or infinite mass . when it has a finite mass , the marking process is ergodic , and the normalization of @xmath0 is the unique stationary distribution .    in the case of mass - action rates ,",
    "we get @xmath155",
    "so we are always in the ergodic case . for constant rates ,",
    "if the state space @xmath156 is infinite , the ergodicity depends on the values of the constants @xmath157 .",
    "theorem [ thm : kelly ] is the core result .",
    "below , all the developments consist in determining conditions under which theorem [ thm : kelly ] applies .",
    "more precisely , we want conditions on the model ensuring the existence of a strictly positive solution to the nlte and the finiteness of the measure @xmath0 .",
    "the ideal situation is as follows :    * _ structural _ properties of the petri net ( i.e. independent of the firing rates ) ensure the existence of a strictly positive solution to the nlte ; * conditions on the firing rates ensure the finiteness of the measure @xmath0 .",
    "solving the non - linear traffic equations is still a challenging task .",
    "we may avoid a direct attack to these equations by considering a simpler system of equations called the linear traffic equations .",
    "[ def : lte ] we call _ linear traffic equations ( lte ) _ the equations over the unknowns @xmath158 defined by : @xmath146 , @xmath159 furthermore , if @xmath160 , then @xmath161 .",
    "the nlte and the lte are clearly linked .",
    "[ le : nlte - lte ] if the nlte ( [ eq : nlte ] ) have a strictly positive solution @xmath162 , then @xmath163 , @xmath164 is a strictly positive solution to the lte ( [ eq : lte ] ) .    for a partial converse statement , see lemma [ le : lte - nlte ] .",
    "the following proposition provides a simple and structural criterium for the existence of a strictly positive solution to the lte .",
    "[ prop : wrandlte ] the following statements are equivalent :    * @xmath165 such that the equations ( [ eq : lte ] ) have a strictly positive solution . *",
    "@xmath166 , the equations ( [ eq : lte ] ) have a strictly positive solution . *",
    "the petri net is weakly reversible .",
    "proofs can be found in ( * ? ? ?",
    "* theorem 3.5 ) or ( * ? ? ?",
    "* corollary 4.2 ) .",
    "we recall the argument from @xcite which is simple and illuminating .    the _ reaction process _ is a continuous - time markov process , analog to the marking process , except that it is built on the reaction graph instead of the marking graph .",
    "more precisely , the state space is the set of complexes @xmath79 and the infinitesimal generator @xmath167 is defined by : @xmath168 ( the discrete - time version of this process was introduced in @xcite under the name `` routing process '' . )",
    "the key observation is that the lte are precisely the balance equations @xmath169 of the reaction process .",
    "the result now follows using standard perron - frobenius theory .",
    "so weak reversibility is a necessary condition to have a strictly positive solution to the nlte , and to be able to apply theorem [ thm : kelly ] .",
    "unfortunately , it is not a sufficient condition as shown by the following example .",
    "let us consider a markovian petri net whose underlying petri net is shown in figure [ fig : ltenotnlte ] , and is equivalently defined by the chemical reactions .",
    "this is a weakly reversible petri net , thus its lte always have a strictly positive solution regardless of the choice of the constants @xmath157 .",
    "the nlte are : @xmath170 the system ( [ eq : ltenotnlte ] ) does not always have a strictly positive solution .",
    "for example , set @xmath171 , and @xmath172 .",
    "any solution to ( [ eq : ltenotnlte ] ) must satisfy either @xmath173 or @xmath174 .    depending on the values of the constants @xmath175 ,",
    "the markovian petri net may or may not have a product form invariant measure . anticipating on theorem [ thm : defzero ] , the deficiency of the petri net has to be different from 0 for this property to hold . and ,",
    "indeed , we have @xmath176 and @xmath177 so the deficiency is equal to 1 .",
    "so now the goal is to find additional conditions on top of weak reversibility to ensure the existence of a product form .",
    "an early result in this direction appears in coleman , henderson and taylor  ( * ? ? ?",
    "* theorem 3.1 ) .",
    "the condition is not structural ( i.e. rate dependent ) and not very tractable .",
    "the next result , due to haddad , moreaux , sereno , and silva  ( * ? ? ?",
    "* theorem 9 ) , provides a structural sufficient condition .",
    "[ pr : hmss ] consider a markovian petri net ( set of complexes @xmath79 ) .",
    "assume that the petri net is weakly reversible .",
    "let @xmath50 be the incidence matrix of the petri net , see .",
    "let @xmath2 be the node - arc incidence matrix of the reaction graph , see .",
    "assume that there exists a @xmath178-valued @xmath179-matrix @xmath3 such that @xmath180 .",
    "then the marking process has an invariant measure @xmath0 given by : @xmath181 , @xmath182 where @xmath183 is a strictly positive solution to the lte .      independently of the efforts in the petri net community ( @xcite )",
    ", the following result was proved on the chemical side by feinberg  ( * ? ? ?",
    "* theorem 5.1 ) .",
    "[ thm : feinberg ] consider a markovian petri net .",
    "assume that the petri net has deficiency 0 .",
    "then the nlte have a strictly positive solution if and only if the network is weakly reversible .",
    "by combining theorems [ thm : kelly ] and [ thm : feinberg ] , we obtain the following result whose formulation is original .",
    "[ thm : defzero ] consider a petri net which is weakly reversible and has deficiency 0 .",
    "consider any associated markovian petri net .",
    "the nlte have a strictly positive solution @xmath184 and the marking process has a product form invariant measure : @xmath185 if we assume furthermore that the rates are of mass - action type , then the marking process is ergodic and its stationary distribution is : @xmath186 where @xmath187 .",
    "the above result is interesting .",
    "indeed , the `` deficiency 0 '' condition is structural and very simple to handle .",
    "we now prove that the result in theorem [ thm : defzero ] is equivalent to the one in proposition [ pr : hmss ] .",
    "[ pr : hmss2 ] consider a petri net .",
    "there exists a @xmath188-matrix @xmath3 such that @xmath180 ( with the notations of prop .",
    "[ pr : hmss ] ) if and only if the petri net has deficiency 0 .",
    "the deficiency of the petri net is 0 iff @xmath189 .",
    "assume first that there exists a matrix @xmath3 such that @xmath180 .",
    "since @xmath180 , we have @xmath190 . by proposition [ pr - nonneg ]",
    ", we also have @xmath191 .",
    "therefore the petri net has deficiency 0 .",
    "we now prove the converse result .",
    "assume that the petri net has deficiency 0 .",
    "set @xmath192 .",
    "we have @xmath193 . since @xmath194 , we know that there exists an invertible and @xmath178-valued @xmath195-matrix @xmath138 such that the first @xmath196 column vectors of @xmath197 are linearly independant and the last @xmath198 column vectors are @xmath199 . according to ( [ eq : eliminationan2 ] ) , the last @xmath198 column vectors of @xmath200 are @xmath199 .",
    "but @xmath201 , so the first @xmath196 column vectors of @xmath200 must be linearly independant .",
    "denote by @xmath202 , _ resp .",
    "_ @xmath203 , the first @xmath196 column vectors of @xmath197 , _ resp .",
    "_ @xmath200 .",
    "since the two families are independent , we know that there exists a @xmath178-valued @xmath204-matrix @xmath3 such that @xmath205 for all @xmath206 . in other words , @xmath207 finally , right - multiplying both sides of by @xmath208 , we obtain @xmath209 .",
    "[ [ roadmaps . ] ] roadmaps .",
    "+ + + + + + + + +    the main results are summarized in the diagram of figure [ fi - recap ] . in the diagram , (",
    "n)lte is a shorthand for : `` the ( n)lte have a strictly positive solution '' .",
    "@xmath210    the implications which do not appear on figure [ fi - recap ] are false .",
    "the counter - examples are summarized on figure [ fi - recap2 ] .",
    "( using lemma [ le : nlte - lte ] and prop . [",
    "prop : wrandlte ] , any petri net of deficiency 0 and not wr is a counter - example to [ `` deficiency 0 '' @xmath211 `` nlte for some rates '' ] . )    @xmath212    the product form property depends on the initial marking via the reachability set , while the other properties appearing in figure [ fi - recap ] do not depend on it by definition .",
    "this provides a striking picture .",
    "in fact , for petri nets which are weakly reversible and have deficiency zero , when the initial marking varies , the product form remains the `` same '' but is defined on different state spaces .",
    "we illustrate this point in  [ sse - haddad ] , and we come back to it in  [ sse - cex ] .",
    "consider the petri graph represented on the left of figure [ fi - haddad ] .",
    "the corresponding reaction graph is given on the right of the figure .",
    "the reaction graph is strongly connected so the petri graph is weakly reversible .",
    "the incidence matrices @xmath50 and @xmath2 are given by ( indices are ranked as @xmath213 , @xmath214 , and @xmath215 ) : @xmath216    we check that @xmath217 , so the deficiency is 0 .",
    "we are in the scope of application of the results of section [ sse - def0 ] .",
    "denote a marking @xmath39 by the triple @xmath218 .",
    "consider the two petri nets corresponding to the above petri graph with two different initial markings : @xmath219 and @xmath220 .",
    "-9090 - 9090    ( 47 , 5)@xmath38 ( -39 , 5)@xmath221 ( 47 , -35)@xmath196    ( 0 , 10)@xmath63 ( -40 , -30)@xmath65 ( 42 , 44)@xmath64    ( -20 , 0)@xmath222 ( 20 , 0)@xmath222 ( 36 , 20)@xmath222 ( -60 , -20)@xmath222    ( 120 , 10)@xmath223 ( 160 , 10)@xmath224 ( 140 , -20)@xmath225    ( 140 , 20)@xmath64 ( 128 , -10)@xmath63 ( 152 , -10)@xmath65    the two petri nets have a drastically different behaviour .",
    "the first one is live and bounded , while the second one if live and unbounded .",
    "the sets of reachable markings are , respectively , @xmath226    for the initial marking @xmath219 , the marking graph is the elementary circuit @xmath227 . for the initial marking @xmath220 ,",
    "the marking graph is represented in figure [ fi - marking ] .",
    "the dashed arrows correspond to transition @xmath64 , the dash - and - dotted ones to @xmath63 , and the plain ones to @xmath65 .",
    "-300100 - 100100    ( -285 , 80)@xmath228 ( -285 , 40)@xmath229    ( -220 , 80)@xmath230 ( -220 , 40)@xmath231 ( -220 , 0)@xmath232 ( -220 , -40)@xmath233    ( -157 , 80)@xmath234 ( -157 , 40)@xmath235 ( -130 , 0)@xmath236    ( -87 , 80)@xmath237 ( -75 , 40)@xmath238 ( -80 , 0)@xmath239 ( -80 , -40)@xmath240    ( 20 , 80)@xmath236 ( -10 , 40)@xmath241 ( -10 , 0)@xmath242 ( -10 , -40)@xmath243    ( -160 , 0)@xmath236 ( 80 , 0)@xmath236    consider the markovian petri nets associated with the above petri nets and constant firing rates @xmath244 for @xmath214 .",
    "the nlte over the unknowns @xmath245 are given by @xmath246    a strictly positive solution to the nlte is @xmath247 .",
    "let @xmath248 denote the set of reachable markings . according to theorem [ thm : defzero ] ,",
    "the invariant measure @xmath0 is given by @xmath249 the invariant measure is expressed in exactly the same way for the two petri nets .",
    "but it corresponds to two very different situations .    for the initial marking @xmath219",
    ", we have @xmath250 , the model is ergodic and the unique stationary distribution @xmath38 , obtained by normalization of , is given by @xmath251 with @xmath252 .    for the initial marking @xmath220 , we have @xmath253 , and the model is ergodic if and only if the following stability condition is satisfied @xmath254    it is interesting to observe that we get a non - linear stability condition .      the statements of proposition [ pr : hmss ] and theorem [ thm : defzero ] differ in that they rely respectively on the lte and the nlte .",
    "in particular , it seems at first glance that prop .",
    "[ pr : hmss ] manages to bypass the nlte .",
    "but it is not the case : the nlte are hidden in the matrix @xmath3 , see below .",
    "[ le : lte - nlte ] consider a weakly reversible markovian petri net .",
    "assume that there exists a @xmath178-valued matrix @xmath3 such that @xmath180 ( notations of prop .",
    "[ pr : hmss ] ) .",
    "let @xmath163 be a strictly positive solution to the lte .",
    "then @xmath255 is a strictly positive solution to the nlte .    for each transition",
    "@xmath30 , we have : @xmath256    then we have @xmath257 \\   & \\longleftrightarrow & \\ \\forall c , \\quad \\sum_{i(t ) = c } \\kappa_t = \\sum_{o(t ) = c } \\kappa_t \\prod_p u_p^{i(t)_p - o(t)_p } \\\\ & \\longleftrightarrow & \\ \\forall c , \\quad   \\sum_{i(t ) = c } \\kappa_t = \\sum_{o(t ) = c } \\kappa_t \\frac{v_{i(t)}}{v_{o(t ) } } \\\\ & \\longleftrightarrow & \\ \\bigl [ v\\ \\mbox{strictly positive sol . lte }",
    "\\bigr ] \\:.\\end{aligned}\\ ] ]    let us comment on a specific point .",
    "consider theorem [ thm : defzero ] .",
    "the invariant measure is defined in fonction of a specific strictly positive solution to the nlte .",
    "however , it is easily seen that the nlte may have several strictly positive solutions .",
    "is this contradictory with the uniqueness of the stationary measure in the ergodic case  ? in the non - ergodic case , do we get several invariant measures  ?",
    "the next result answers these questions .",
    "assume that the petri net is weakly reversible and has deficiency 0 .",
    "let @xmath75 , @xmath258 be solutions to the nlte and @xmath0 , @xmath259 be the corresponding invariant measures ( given by ) .",
    "then there exists a constant @xmath260 such that for all reachable marking @xmath154 , @xmath261 .",
    "it suffices to show that @xmath262 for all reachable marking @xmath154 and for all enabled transition @xmath30 of @xmath154 .",
    "define @xmath163 , and @xmath263 by @xmath264 according to lemma [ le : nlte - lte ] , @xmath183 and @xmath265 are solutions to the lte .",
    "equality holds if and only if @xmath266 the last equality is proved by feinberg in ( * ? ? ?",
    "* proposition 4.1 ) .",
    "let us compare proposition [ pr : hmss ] and theorem [ thm : defzero ] from an algorithmic point of view .    in both cases , one needs to check weak reversibility . using proposition [ prop : wrandlte ]",
    ", weak reversibility is equivalent to the existence of a strictly positive solution to the lte .",
    "this last point can be checked in time @xmath267 .",
    "then the procedures diverge .",
    "* _ proposition [ pr : hmss ] .",
    "_ we need to compute the matrix @xmath3 satisfying @xmath268 .",
    "this requires to solve @xmath79 linear systems of dimension @xmath269 .",
    "so the time - complexity is @xmath270 using gaussian elimination . * _ theorem [ thm : defzero ] .",
    "_ we have seen in section [ subsec : chem ] that the deficiency 0 condition can be checked in time @xmath271 .",
    "then one needs to compute a strictly positive solution to the nlte .",
    "this can be done as follows .",
    "consider , apply the logarithm operation on both sides and solve the linear system .",
    "the corresponding time - complexity is @xmath272",
    "(= @xmath273 since @xmath274 ) .",
    "we conclude that it is more efficient asymptotically to determine the product form by using the characterization in theorem [ thm : defzero ] .",
    "we have seen above that the existence of a strictly positive solution to the nlte is a sufficient condition for the existence of a product form . however , it is not a necessary condition , and we now provide a counter - example .",
    "-8080 - 6565    ( -94 , 36)@xmath57 ( -94 , -24)@xmath60 ( -124 , 6)@xmath59 ( -64 , 6)@xmath58    ( -92 , 61)@xmath64 ( -92 , 1)@xmath63 ( -92 , -59)@xmath65    ( 20 , 20)@xmath275 ( 70 , 20)@xmath276 ( 120 , -22)@xmath277 ( 20 , -22)@xmath278 ( 70 , -22)@xmath279    ( 45 , 20)@xmath63 ( 45 , -20)@xmath63 ( 95 , -20)@xmath63 ( 20 , 0)@xmath65 ( 70 , 0)@xmath65 ( 47 , 0)@xmath64 ( 100 , 0)@xmath64    consider the petri graph of figure [ fig : def1notwr ] .",
    "it is not weakly reversible , so in particular there is no strictly positive solution to the nlte .",
    "furthermore , the deficiency is 1 .",
    "consider the initial marking @xmath280 .",
    "the marking graph is given on the right of figure [ fig : def1notwr ] . by solving directly the balance equations of the marking process",
    ", we get : @xmath281 we have @xmath282 .",
    "so the petri net has a product form .",
    "consider now the same petri graph with a new initial marking @xmath283 .",
    "the marking graph is still finite ( 9 states ) , strongly connected but we no longer have a product form stationary distribution . indeed , suppose that @xmath284 where @xmath285 are strictly positive constants .",
    "the balance equations for @xmath286 and @xmath287 are : @xmath288 these equations can not be simultaneously satisfied , so the stationary distribution is not of product form .    to summarize , as opposed to the case of `` weakly reversible and deficiency 0 '' petri nets , the existence of a product form depends on the initial marking .",
    "the class of petri nets whose markovian versions have a product form is an interesting one .",
    "it is therefore natural to study how this class intersects with the classical families of petri nets : state machines and free - choice petri nets .    the central result of this section is , in a sense , a negative result .",
    "we show that within the class of free - choice petri nets , the only ones which are weakly reversible are closely related to state machines . we also show that the markovian state machines are `` equivalent to '' jackson networks .",
    "the latter form the most basic and classical examples of product form queueing networks .    from now on ,",
    "we consider only _ non - weighted _ petri nets , that is petri nets with @xmath289 . in this case",
    ", the input / output bags can be retrieved from the flow relation @xmath69 and we can define the petri net as a quadruple @xmath290 .",
    "we also identify complexes with subsets of @xmath291 .                        in a sm , each complex is just one place . starting from the petri graph and replacing @xmath307,\\ p , q\\in \\cp , \\ t \\in \\ct,$ ] by @xmath308 $ ] , we get the reaction graph . for gsm ,",
    "the mapping is the same with the empty complex corresponding to the `` new '' place in the associated sm .      in a sm ,",
    "the complexes are the places .",
    "so the nlte and the lte coincide exactly . for a gsm ,",
    "the complexes are the places and the empty set . with the convention @xmath161",
    ", we still have that the nlte and the lte coincide .",
    "the next proposition follows .      in the weakly reversible case ,",
    "the lte have a strictly positive solution for every choice of the rates , proposition [ prop : wrandlte ] .",
    "therefore the nlte have a strictly positive solution for every choice of the rates .",
    "the above proof does not require feinberg s theorem [ thm : feinberg ] .",
    "however , it turns out that the deficiency is 0 , which provides a second proof of prop .",
    "[ prop : wrstatemachinenlte ] using theorem [ thm : feinberg ] .",
    "consider first a state machine .",
    "let @xmath50 be the incidence matrix , and let @xmath2 be the node - arc incidence matrix of the reaction graph , see . using lemma [ lem : isomorphsm ] , we get immediately that @xmath309 .",
    "so , in particular , we have @xmath310 and the deficiency is 0 .",
    "consider now a gsm @xmath311 and its associated sm @xmath312 .",
    "call @xmath79 ( resp .",
    "@xmath313 ) , @xmath50 ( resp .",
    "@xmath314 ) and @xmath84 ( resp .",
    "@xmath315 ) the set of complexes , the incidence matrix and the number of connected components of the reaction graph of @xmath311 ( resp .",
    "@xmath312 ) .      by construction of @xmath312 , @xmath314 is @xmath50 augmented with a row @xmath317 defined by @xmath318 ( where @xmath319 and @xmath320 are defined in @xmath311 ) .",
    "we have @xmath321 .",
    "on the other hand , observe that @xmath322 , so @xmath323 , where @xmath3 is the @xmath324 identity matrix augmented with the row @xmath325 .",
    "hence @xmath326 .",
    "so : @xmath327        [ th : sm ] consider a markovian weakly reversible gsm .",
    "the deficiency is 0 .",
    "the nlte have a strictly positive solution @xmath184 .",
    "the marking process admits a product form invariant measure given by : @xmath181 , @xmath328 if @xmath329 , the state space @xmath156 is finite , the marking process is ergodic , and @xmath0 can be normalized to give a product form stationary distribution : @xmath181 , @xmath330 where @xmath331 .",
    "the product form result for jackson networks is one of the cornerstones of markovian queueing theory .",
    "it was originally proved by jackson  @xcite for open networks and by gordon @xmath5 newell  @xcite for closed networks .      *",
    "a place @xmath109 becomes a simple queue , that is a single server markovian queue with an infinite buffer .",
    "the service rate at queue @xmath109 is @xmath333 . *",
    "the routing matrix @xmath334 of the jackson network is the stochastic matrix defined by : @xmath335 * a token in place @xmath109 becomes a customer in queue @xmath109 .",
    "the classical product form results for jackson networks ( jackson  @xcite and gordon @xmath5 newell  @xcite ) are exactly the translation via the above transformation of theorem [ th : sm ] . in the open case ,",
    "the weak - reversibility implies the classical `` without capture '' condition of jackson networks .",
    "the above transformation from gsm to queueing network can also be performed in the case of general rate functions of type .",
    "queueing networks with those rate functions are called _ whittle networks _ in the literature .",
    "the existence of product form invariant measures for these networks is a classical result , see for instance @xcite and the references therein .",
    "we study the family of live and bounded free - choice nets .",
    "this is an important class of petri nets realizing a nice compromise between modelling power and tractability , see the dedicated monography of desel @xmath5 esparza  @xcite .",
    "we show that the only such petri nets having a product form are , in a sense , the gsm .",
    "[ def : cluster ] the _ cluster _ of a node @xmath348 , denoted by @xmath349 $ ] , is the minimal set of nodes such that : @xmath350 @xmath351\\,;$ ]",
    "@xmath352 @xmath353 \\implies \\ ^{\\bullet}t   \\subset [ x]\\,;$ ] @xmath354 @xmath355 \\implies   p^{\\bullet } \\subset [ x]\\,.$ ]      [ lem : isomorphismclusterscomplexes ] consider a weakly reversible free - choice petri net .",
    "the non - empty complexes are disjoint subsets of @xmath291 .",
    "the partition of @xmath291 induced by the non - empty complexes is the same as the partition of @xmath291 induced by the clusters .",
    "it follows from the definition of clusters that every non - empty input bag is entirely contained in a cluster .",
    "this cluster is unique because the clusters partition the set of places .",
    "let @xmath356 be a non - empty complex ( which is also a non - empty input bag ) .",
    "denote by @xmath357 $ ] the cluster containing @xmath356 .",
    "we have @xmath358 $ ] , so @xmath359 $ ] . since the petri net is free - choice , @xmath360 for all @xmath361 .",
    "the set @xmath362 satisfies the three conditions of the definition of clusters , so we have @xmath357 \\subset i \\cup i^\\bullet$ ] .",
    "we conclude that @xmath357 = i \\cup i^\\bullet$ ] and @xmath356 is the set of places of the cluster @xmath357 $ ] .",
    "conversely , let @xmath349 $ ] be a cluster such that @xmath349 \\cap \\cp \\neq \\emptyset$ ] .",
    "let @xmath356 be a non - empty input bag contained in @xmath349 $ ] .",
    "we have , using the above , @xmath357 = i \\cup i^\\bullet \\subset [ x]$ ] . by minimality , @xmath357=[x]$ ] and @xmath349\\cap \\cp = i$ ] .      under the assumptions of lemma [ lem : isomorphismclusterscomplexes ] , the non - empty complexes are disjoint .",
    "thus each non - empty complex behaves as if it was a `` big place '' .",
    "consider the operation which reduces each non - empty complex to a single place .",
    "the resulting petri net is a generalized state machine .",
    "and this generalized state machine is weakly reversible because the original free - choice petri net was weakly reversible .",
    "let us define all this more formally .",
    "[ def : reducedstatemachine ] let @xmath302 be a weakly reversible free - choice petri net with set of complexes @xmath79 .",
    "we call the _ reduced generalized state machine ( rgsm ) _ of @xmath311 the gsm @xmath363 where :        [ lem : isomorphpnsm ] let @xmath311 be a weakly reversible free - choice petri net and @xmath368 its rgsm",
    ". the marking graph of @xmath368 is isomorphic to the one of @xmath311 . if @xmath311 and @xmath368 are markovian with the same rates then the two marking processes are `` identical '' , meaning that they have the same infinitesimal generator .",
    "consider two places @xmath38 and @xmath221 belonging to the same complex .",
    "since the complexes are disjoint , lemma [ lem : isomorphismclusterscomplexes ] , each time @xmath38 gains ( resp . loses ) a token , so does @xmath221 .",
    "so the difference @xmath369 is invariant over all the reachable markings @xmath39 .",
    "it has the following consequence .",
    "consider @xmath370 defined by @xmath371 .",
    "if @xmath42 in @xmath311 then @xmath372 in @xmath368 .",
    "so @xmath373 and the marking graph of @xmath368 is the marking graph of @xmath311 up to a renaming of the nodes .",
    "one could introduce the rgsm associated with a non - wr free - choice petri net as in definition [ def : reducedstatemachine ] , see figure [ fig : wriso ] .",
    "but in this case lemma [ lem : isomorphpnsm ] does not hold , and the two marking graphs may have nothing in common .",
    "the petri graph of @xmath368 is isomorphic to its reaction graph , lemma [ lem : isomorphsm ] .",
    "now by construction , @xmath311 and @xmath368 have the same reaction graph .",
    "so the number of complexes and the number of connected components of the reaction graph do not change .",
    "call @xmath50 and @xmath314 the incidence matrices of @xmath311 and @xmath368 respectively .",
    "let @xmath4 be an arbitrary complex , let @xmath375 be two places of @xmath4 . for every transition @xmath30 , we have @xmath376 , which implies that @xmath377 .",
    "so the two petri nets have the same deficiency ."
  ],
  "abstract_text": [
    "<S> consider a markovian petri net with race policy . </S>",
    "<S> the marking process has a `` product form '' stationary distribution if the probability of viewing a given marking can be decomposed as the product over places of terms depending only on the local marking . </S>",
    "<S> first we observe that the deficiency zero theorem of feinberg , developed for chemical reaction networks , provides a structural and simple sufficient condition for the existence of a product form . in view of this , we study the classical subclass of free - choice nets . </S>",
    "<S> roughly , we show that the only petri nets of this class which have a product form are the state machines , which can alternatively be viewed as jackson networks . </S>"
  ]
}