{
  "article_text": [
    "the standard lore in the idealized picture of galaxy formation by spherical infall of gas inside dark - matter haloes is that the gas is first heated to the halo virial temperature behind an expanding virial shock .",
    "it is then supported by pressure in a quasi - static equilibrium while it is cooling radiatively and is slowly contracting to a disc where it can eventually form stars .",
    "the cooling process thus determines important galaxy properties such as the star - formation rate and the metal enrichment , so it is necessarily an important ingredient in the galaxy formation process .    however , it is not at all clear that a stable shock can persist in the halo gas away from the disc under the conditions valid in many galactic haloes . in the absence of a virial shock , the gas is not heated to the virial temperature until it falls all the way to the disc , where the collapse stops and the gas is heated in a thin layer .",
    "this may alter some of the assumed processes of disc formation and in particular the star formation rate in it .",
    "it may work against blowout by supernova - driven winds in dwarf galaxies .",
    "the result of heating near the disc instead of at the virial radius may result in weakening the soft x - ray emission from such haloes and producing a high flux of instead . in this paper",
    "we evaluate the conditions for the existence of a virial shock in galactic haloes .",
    "initial density perturbations are assumed to grow by gravitational instability , reach maximum expansion , and collapse into virial equilibrium at roughly half the maximum - expansion radius . during the initial phase , and roughly until shells start crossing each other near the virial radius , the gas pressure is negligible compared to the gravitational force , so the shells of gas and dark matter move in a similar manner .",
    "once interior to the virial radius , where shells tend to cross and the gas density becomes high enough , the gas pressure becomes an important player in the dynamics .",
    "its hydrodynamic properties allow transfer of bulk kinetic energy into internal energy and the pressure prevents gas element from passing through other gas elements and from being compressed without limit .",
    "this makes the infall velocity vanish at the centre . since in the cold infalling gas",
    "the typical velocity is higher than the speed of sound , the information about this inner boundary condition can not propagate outwards in time , and these supersonic conditions create a shock . after the gas crosses the shock , it is heated up , the speed of sound increases , and the flow becomes subsonic .",
    "the shock transfers the kinetic energy that has been built during the collapse into internal gas energy just behind the shock .",
    "a stable spherical shock would slowly propagate outwards through the infalling gas , leaving behind it hot , high - entropy gas that is almost at rest .",
    "the temperature of the post - shock gas roughly equals the virial temperature .",
    "the persistence of the shock depends on sufficient pressure by the post - shock gas , which supports it against being swept inwards due to the gravitational pull together with the infalling matter .",
    "radiative gas cooling makes the gas lose entropy and pressure , which weakens the pressure support behind the shock front .",
    "our approach here is to evaluate the existence of a virial shock by analyzing the gravitational stability of the supporting gas behind the shock in the presence of significant cooling .    in we",
    "first summarize the standard analysis of an adiabatic shock and then generalize the gravitational stability criterion to the case where cooling is important . in",
    "we describe our spherical hydrodynamic lagrangian code , which includes gravitating dark - matter and gas shells , artificial viscosity , radiative cooling and centrifugal forces .",
    "we test the code in this section and in appendix [ app : code ] . in",
    "we apply the numerical code to simulations which demonstrate the shock formation and test the validity of the analytical model . in",
    "we apply the shock stability criterion to realistic haloes forming in cosmological conditions . in",
    "we summarize our results and discuss potential astrophysical implications .",
    "our goal here is to derive a criterion for the existence of a virial shock in terms of the properties of the infalling gas just in front of the shock front .",
    "it is based on a gravitational stability analysis of the post - shock gas .",
    "we first remind ourselves of the standard stability analysis in the simple adiabatic case , and then derive a more general criterion for stability in the radiative case , under certain assumptions and using a perturbation analysis .      throughout this paper ,",
    "we treat the baryons as an ideal monoatomic gas .",
    "their _ equation of state _ could therefore be written as [ eq : ideal_eos ] p=(-1 ) e , where @xmath9 is the pressure , @xmath10 is the specific internal energy , @xmath3 is the density of the gas and @xmath11 is the adiabatic index . along an isentrope ( an adiabatic process of constant entropy )",
    "the pressure and density are related via @xmath12 , so the adiabatic index is defined by [ eq : gamma ] = ( p ) _ s . for a monoatomic gas @xmath13 .",
    "becomes smaller .",
    "once the gas becomes fully ionized , the original value of @xmath14 is restored , but with a different effective density .",
    "this should have only a marginal effect on our results , and is ignored in this paper . ]",
    "the virial shock is assumed to be a spherical accretion shock which propagates outwards slowly while infalling gas crosses it inwards .",
    "the kinetic energy of the infalling gas is transformed at the shock front into thermal energy  the post - shock gas is thus heated to a temperature close to the virial temperature of the system of dark - matter halo and gas , @xmath15 . because the original temperature of the infalling gas is negligible compared to the virial temperature , the system obeys the strong - shock limit .",
    "when we denote the pre - shock and post - shock quantities by subscripts 0 and 1 respectively , the jump conditions across the shock are in this case @xcite : _ 0= _ 1 , [ eq : j1 ] ( u_0-)= ( u_1- ) , [ eq : j2 ] p_1= , [ eq : j3 ]",
    "t_1 = = u_0 ^ 2 , [ eq : j4 ] where @xmath4 stands for radial velocity , @xmath16 is the shock velocity , @xmath17 is avogadro s number , @xmath18 is the average number of molecules per unit mass , and @xmath19 is boltzman s constant .    according to standard shock theory ,",
    "the post - shock gas is always sub - sonic ( in the frame of reference of the moving shock ) because of the increase of the sound velocity behind the shock .",
    "this gas is thus capable of providing the necessary pressure to support the shock against the gravitational pull inwards applied by the self - gravity of the gas and the dark - matter halo as well as the pressure applied by the infalling matter at the shock front .",
    "the criterion for gravitational stability of this post - shock gas in the adiabatic case is the standard jeans stability criterion : @xmath20 ( e.g. , * ? ? ?",
    "* chapter 8)    if the post - shock gas is gravitationally unstable , it falls into the galaxy centre on a dynamical timescale and can no longer support the shock . as a result , the shock weakens and it is swept inwards .",
    "the jeans criterion can be qualitatively understood in terms of the following heuristic derivation . for a shell of radius @xmath1",
    ", we compare the gravitational pull inwards , @xmath21 ( where @xmath22 is the mass interior to @xmath1 ) , to the pressure pushing outwards , @xmath23 .",
    "we assume an isentrope , @xmath24 .",
    "we also assume homology , such that the local density scales like the mean density in the sphere interior to @xmath1 , @xmath25 .",
    "then @xmath26 can be replaced by @xmath27 and we obtain ^-4/3 .",
    "[ eq : jeans ] if @xmath28 , we have an unstable configuration . starting in hydrostatic equilibrium , @xmath29 , a perturbation involving contraction is associated with a larger @xmath3 , and therefore @xmath30 by , implying that the pressure can not prevent collapse . if @xmath31 , the pressure force increases until it balances the increased gravitational pull .",
    "we note that even this simple derivation of the jeans criterion had to assume homology  an assumption that we will have to adopt also in our analysis of the radiative case below .",
    "we wish to replace the adiabatic jeans criterion by a more general stability condition that will be valid also in the radiative case .",
    "this criterion must depend on the cooling rate and should therefore be naturally expressed in terms of time derivatives .",
    "we generalize the adiabatic @xmath11 of by an effective @xmath11 following a comoving volume element along its lagrangian path : [ eq : def_gam_eff ] .",
    "we expect that the system would be stable when @xmath32 is larger than a certain critical value , the analog of the requirement @xmath31 in the adiabatic case .    in our lagrangian analysis all the quantities ( @xmath1 , @xmath4 , @xmath3 , @xmath9 , etc .",
    ") refer to comoving shells ; they are all functions of the gas mass @xmath33 interior to radius @xmath1 and time @xmath34 .",
    "derivatives with respect to time following a comoving volume element will be denoted by an upper dot , and derivatives with respect to m will be denoted by a prime .",
    "the effective gamma can be related to its adiabatic analog given the cooling rate and other post - shock gas quantities .",
    "the time derivative of yields : [ eq : dpdt ] = ( -1 ) ( + e ) .",
    "energy conservation in the presence of radiative losses can be expressed by [ eq : dedt ] e =- p v -q= -q , where @xmath35 is the radiative cooling rate [ to be discussed below , e.g. , ] and @xmath36 is the specific volume . substituting @xmath37 from into , and using it in ,",
    "we obtain [ eq : fin_gam_eff ] = - .",
    "note that in the limit @xmath38 we reproduce the adiabatic case ; the process is nearly adiabatic when the cooling timescale is long compared to the contraction timescale .",
    "we assume that in the region close behind the shock the pattern of the velocity field is",
    "_ homologous_. by this we mean that at any given time the ( radial ) velocity is proportional to the radius ( as in a hubble flow ) , namely [ eq : homo ] u / r = u_1/ , thus providing a boundary condition for the post - shock gas .",
    "the homology is shown to be a valid approximation in the simulations discussed below , where the post - shock shell trajectories are roughly parallel to each other in the @xmath39 plane , at any given time close enough to shock crossing .",
    "the time evolution of the density can then be evaluated via the _ continuity _ equation in lagrangian form for the spheri - symmetric case , [ eq : drodt ] = - = -(r^2 u ) = - , where the last equality results from the assumed homology , .",
    "the homology thus implies that @xmath40 at a given @xmath34 is a constant in @xmath33 throughout the post - shock region .",
    "can then be simplified : = + .",
    "[ eq : gameff ]    we start with a hypothetical unperturbed state for the post - shock gas , where we assume that the net force _ vanishes _ , @xmath41 .",
    "the system adjusts itself to this state on a timescale associated with the speed of sound @xmath42 , provided that it is much higher than the infall velocity @xmath4 .",
    "this is expected to be the case in the sub - sonic post - shock medium , where @xmath42 becomes high and",
    "@xmath4 becomes low .",
    "the unperturbed equation of _ motion _ in lagrangian form is then [ eq : dpdm ] = -4r^2 p - = 0 , where @xmath22 is the total mass interior to radius @xmath1 .",
    "we then introduce a perturbation due to a homologous infall velocity @xmath4 . over a short time interval @xmath43",
    ", it introduces a small displacement inwards , @xmath44 . in order to distinguish between stability and instability",
    "we wish to determine whether the induced acceleration , @xmath45 , is positive or negative , tending to decrease or increase the velocity respectively .",
    "note that under homology , , the relative displacement is /r",
    "[ eq : rad ]    writing the equation of motion , , but for the perturbed quantities @xmath46 and @xmath47 , and subtracting the unperturbed , we obtain to first order = -4r^2 ( p) + .",
    "[ eq : motion_first ] we next manipulate the right - hand side of to obtain a simple expression involving @xmath32 .    in the second term",
    "we use the homology , , and then the unperturbed equation of motion , , to obtain = - p .",
    "[ eq : term2 ]    the manipulation of the first term is somewhat more elaborate .",
    "we use the definition of @xmath32 , , to write p = ( / ) p t = - ( 3 u_1/ ) p t , where the second equality is due to .",
    "note that the @xmath33 dependence in this term is only in the product @xmath48 .",
    "we now express @xmath32 in terms of the cooling rate @xmath35 as in , and need to take the derivative @xmath49 .",
    "we make here the standard assumption that the radiative cooling rate is proportional to density , q=(t ) , [ eq : q_def ] with @xmath50 the macroscopic cooling function and @xmath51 the post - shock temperature .",
    "the immediate post - shock medium is assumed to be isothermal , reflecting via the jump conditions an assumed approximate uniformity of the pre - shock gas over a short time interval .",
    "using we have @xmath52 , and together with it becomes pq / e=(-1 ) ^2 .",
    "[ eq : pqe ] in the computation of @xmath49 , we first replace @xmath53 , then use to write @xmath54 , use backwards to replace @xmath55 by @xmath56 , and finally use to obtain @xmath57 $ ] .",
    "we thus have in the first term of the rhs of -(p) = p [ - 2 ^ -1(- ) ] .",
    "[ eq : term1 ]    with the right - hand side of given by and , the first - order equation finally becomes , = . since @xmath58 and @xmath59 are both always negative , the desired sign of @xmath60 is determined by the sign of the expression inside the square brackets .",
    "note that in the adiabatic case , @xmath61 , we have @xmath62 , so we recover the standard stability criterion , @xmath31 . in the radiative case , @xmath63 , we finally obtain the generalized stability criterion : [ eq : stability_criterion ] > for a monoatomic gas , where the adiabatic value is @xmath64 , the threshold for stability is @xmath65 , which is close but not identical to the adiabatic threshold @xmath66 .",
    "next , we wish to express @xmath32 and the stability criterion in terms of the properties of the pre - shock gas ; the infall velocity @xmath67 and the gas density @xmath68 at @xmath69 .",
    "we use the jump conditions , through , in . in",
    "we assume @xmath70 , namely that the shock is temporarily at _ rest _ , which should be valid when the shock is marginally stable ( or unstable ) .",
    "this is because a stable shock is pushed outwards by the post - shock gas , while cooling reduces the pressure , slows the outward motion , and eventually causes it to halt and then be swept inwards by the infalling matter and gravitational pull .",
    "the transition from stability to instability can thus be associated with a transition from expansion to contraction of the shocked volume .    according to and we have [ eq : e1 ] e_1==. according to and with @xmath70 we have = - = -3 . with these and we obtain the desired expression for the effective @xmath11 of the post - shock gas in terms of the pre - shock conditions : [ eq : final_gamma ] = - . for a monoatomic gas , @xmath64 , we obtain = 5/3 -18.96 .",
    "[ eq : gamma_mono ] based on , the criterion for stability of a @xmath64 gas finally becomes < 0.0126 .",
    "[ eq : fin_stability ]    the post - shock temperature is related to the pre - shock infall velocity using the jump condition , , which for @xmath64 gives t_1 = u_0 ^ 2 .",
    "[ eq : t1 ] for a given cooling function @xmath5 , is a simple criterion for determining whether a stable shock can form at some radius @xmath69 of the halo .",
    "it is in a form that can be directly tested against hydrodynamic simulations ( ) , and can serve for evaluating shock stability under realistic conditions in cosmological haloes ( ) .    under the simplifying assumption that the gas is unclumped , the cooling rate is given by .",
    "the macroscopic cooling function @xmath5 is related to the microscopic @xmath71 , the energy - loss rate of a particle , via @xmath72 , where @xmath73 is the number of electrons per particle .",
    "we assume a helium atomic fraction of 0.1 for @xmath74 and @xmath73 .",
    "the microscopic cooling function is shown in for three different values of mean metallicity @xmath75 .",
    "the cooling at temperatures below @xmath76k is very slow because the main available cooling agent is molecular hydrogen , which is very inefficient . at temperatures slightly above @xmath76k the cooling function peaks due to emission from atomic hydrogen . at very low metallicities ,",
    "a second peak arises near @xmath77k due to recombination of atomic helium .",
    "metals give rise to a higher peak at @xmath78k and slightly above , due to line emission from the heavier atoms . at @xmath79k and above",
    ", the cooling is dominated by brehmstralung , and the cooling function increases slowly .",
    "we use the cooling function as derived by @xcite , and presented in their table , in the manner described in @xcite .",
    "we test the validity of the shock stability criterion using numerical simulations based on a spherical hydrodynamics code which follows the evolution of shells of dark matter and gas .",
    "since the problem we intend to examine is of global spherical symmetry , and since we need to follow the cooling and the shock with high precision , we use a one - dimensional code .",
    "most of the simulations presented here were run using @xmath80 gas shells and @xmath81 dark - matter shells .",
    "a comparable resolution in a three - dimensional code would require on the order of @xmath82 and @xmath83 particles respectively , which is impractical .",
    "we use no smoothing in the dark - matter shell - crossing scheme , we introduce small - scale smoothing at the halo centre to avoid an artificial singularity there , and we include small artificial viscosity in the hydrodynamics .",
    "tests of the code performance are described in appendix [ app : code ] .",
    "the dark - matter particles are represented by infinitely thin spherical shells of constant mass and of radii @xmath1 that vary in time .",
    "the shell of current radius @xmath1 obeys the equation of motion [ eq : darkmatter ] = -+ , where @xmath84 and @xmath85 refer respectively to the mass of dark matter and gas within the sphere of radius @xmath1 .",
    "the last term is a centrifugal acceleration , determined by the the specific angular momentum @xmath86 of the particle represented by the shell .",
    "this @xmath86 is assigned to each shell at the initial conditions and is assumed to be preserved during the simulation .",
    "the parameter @xmath87 is the smoothing length that becomes effective only near the centre ; it has been set to be @xmath88pc throughout this work .",
    "the dark - matter shells are allowed to cross each other ( and the gas shells ) .",
    "the dark - matter mass is evaluated by ( r)=_r_i < r _",
    "i + _ j ( r = r_j ) _ j , where the shell radii and masses are denoted by @xmath89 and @xmath90 respectively , @xmath91 .",
    "the second term adds half the mass of a shell when @xmath1 coincides with one of the shells .",
    "generally , this summation requires @xmath92 calculations for the dark matter alone .",
    "the particles are kept sorted by radius .",
    "when two shells cross each other , we re - sort the array by exchanging pairs which violate the order .",
    "this kind of sorting algorithm , termed ` shell s method ' in numerical recipes @xcite , is natural in cases where only a few shells cross each other in each timestep .",
    "when two shells cross , they exchange an energy of @xmath93 . in order to conserve energy , the radius",
    "at which the shells cross must be known with great precision .",
    "we therefore reduce the timestep to a small value , @xmath94 , when two shells are about to cross each other ( see below ) .",
    "the hydrodynamic part of the code is based on lagrangian finite elements in the form of spherical shells .",
    "the basic equations governing the dynamics of each shell are [ eq : force ] = -(p+)-+ , [ eq : energy ] = ^2(p+)-q , [ eq : density ] = .",
    "p=(-1)e ,    an artificial viscosity term , @xmath95 , is added to the pressure for numerical purposes , as explained below .",
    "the smoothing length effective at the center , @xmath87 , is the same as for the dark matter , . as in the model described before , the loss of internal energy due to radiative cooling is represented by the cooling rate @xmath35 .",
    "the gas is divided into discrete shells .",
    "the mass enclosed within a shell , @xmath96 , is assumed constant in time , while the inner and outer shell boundaries move independently in time .",
    "each boundary is characterized by a temporal position @xmath1 , velocity @xmath97 and specific angular momentum @xmath86 .",
    "the acceleration [ ] is evaluated at the boundary position .",
    "the variables @xmath3 , @xmath9 , @xmath10 , @xmath35 , and @xmath51 for each shell are evaluated within the shell between the boundaries .",
    "in particular , the pressure term in is evaluated at the outer boundary @xmath89 of shell @xmath98 using : -(p+)= [ ( p+)_i+1-(p+)_i ] , where @xmath99 .",
    "the boundary conditions for the outer boundary of the system are @xmath100 , and zero mass beyond the outer boundary .",
    "since gas shells can not cross each other , the gas mass in the sphere interior to each gas shell is constant throughout the simulation : ( r_i)=_j=1^i_j . for the evolution of the dark - matter shell at @xmath1",
    ", we evaluate the gas mass that appears in using ( r)=_j=1^i-1_j + _ i , where @xmath98 refers to the gas shell for which @xmath101 .",
    "the discrete integration of @xmath1 and @xmath97 is performed by a runge kutta fourth - order scheme @xcite .",
    "the state of the system at the beginning of each timestep is kept in memory until the timestep is completed , such that it is possible to return to the beginning of the timestep and retry with a smaller timestep if the convergence criteria are not met .",
    "the timesteps are set such that the position @xmath1 and velocity @xmath97 do not change by too much during a single timestep . for a given accuracy parameter @xmath102",
    ", we demand that the difference between the forth - order displacement @xmath103 and the analogous first - order displacement @xmath104 obeys @xmath105 , both for the dark - matter and the gas .",
    "the similar requirement is applied to the change in velocity over a timestep .",
    "if this condition is not fulfilled , we reduce the timestep by a certain factor and repeat the calculation over this timestep .",
    "we use here as our default @xmath106 .",
    "in addition , we make sure the timestep for each shell does not violate the courant condition , for an accuracy parameter @xmath107 .",
    "this implies @xmath108 , where @xmath109 is the speed of sound .",
    "we use here as our default @xmath110 .",
    "a third limitation on the timestep comes from the desire to conserve energy when shells cross .",
    "when two shells are about to cross each other within the current timestep @xmath111 , we set the timestep to @xmath112 , and keep it small until they actually cross .",
    "we use here as our default @xmath113gyr .    the values for @xmath114 and @xmath115",
    "were chosen empirically such that energy is conserved and the dynamics converges to our satisfaction , in the sense that it does not change by much when smaller parameters are used .",
    "we demonstrate in appendix [ app : code ] how well these requirements are met .",
    "once we have computed the new radii and velocities of the shells at the end of the timestep , we correct the energy of the gas for the @xmath116 work term using the states of the system at the beginning and at the end of the timestep .",
    "the cooling is explicitly subtracted from the internal energy after the hydrodynamic timestep is completed . once the final state of the system is ready , it is copied onto the memory array of the initial state , and the simulation is ready to execute a new timestep .",
    "the simulation starts at high redshift , @xmath117 , with a small spherical density perturbation .",
    "the initial density fluctuation profile is set to be proportional to the linear correlation function of the assumed cosmological model , representing the typical perturbation under the assumption that the random fluctuation field is gaussian ( see * ? ? ?",
    "* and appendix [ app : initial_perturbation ] ) .",
    "the amplitude of the density fluctuation at the initial time , averaged over a given mass , determines the time of collapse , as desired .",
    "the initial velocity field is assumed to follow a quiet hubble flow and the radial peculiar velocities build up in time . we assume the standard @xmath118cdm cosmology with @xmath119 , @xmath120 , @xmath121 and @xmath122 .",
    "we assume that in a real system the orbits of dark - matter particles , and the initial orbits of the gas particles , are quite elongated .",
    "cosmological n - body simulations show that the velocity distribution tends to be more radial than tangential @xcite and already for an isotropic distribution the eccentricities are about 1:6 .",
    "the processes we study in this paper occur away from the galactic disc at a radius on the order of the virial radius , namely in a regime where the centrifugal force can be expected to be negligible compared to the gravitational force and the gas pressure force .",
    "the prescribed angular momentum for the shells is thus mainly for numerical purposes , to avoid divergent densities of gas or dark matter shells when they pass through the halo centre .",
    "our results concerning the virial shock are insensitive to the actual way by which we assign angular momentum to each shells .    in the current study",
    "we practically assume that the dark - matter particles are almost on radial orbits .",
    "the angular momentum of the gas is prescribed such that the shells , once they lost their energy by radiation , would settle into an exponential disk with pure circular motions and a characteristic radius of a few kpc , smaller than the inner characteristic radius of the halo .",
    "our spherical ` disc ' thus contains gas that is cold and dense compared to the shocked gas .",
    "it is impossible to follow the discontinuous behavior across the shock using the conventional continuity equation for the density and standard conservation of energy and momentum .",
    "the jump conditions can be calculated explicitly , as in to ( [ eq : j4 ] ) ( termed ` the characteristic method ' or ` godonov s method ' ) . alternatively , as proposed by von - newman , one can slightly smear the discontinuities and then solve them within the framework of the standard hydrodynamic equations . by adding an artificial pressure term in a few shells around the shock , the differential equations become solvable and one can continue the calculation without affecting the energy and the dynamics of the shock ( while its internal structure naturally changes ) .",
    "artificial viscosity is applied when the inner and outer shell boundaries at @xmath123 and @xmath124 approach each other , @xmath125 , and when the volume of the shell decreases , @xmath126 .",
    "the artificial viscosity then takes the form [ eq : av ] = a_2(v)^2+a_1c_s|v| .",
    "the quadratic , common form of artificial viscosity smears discontinuities over about 3 shells . the linear discontinuity affects a slightly larger range , and is usually added with a smaller coefficient @xmath127 . the coefficients @xmath127 and @xmath128 are varied for different shells in the course of the simulation in order to overcome a specific numerical problem in the cold ` disc ' , where the gravitational and centrifugal forces balance each other and the pressure force is negligible . in this case",
    "the gas is not a standard hydrodynamic gas because the pressure does not regulate large discontinuities , and information is not transported because of the low sound speed . when a ` disc ' shell vibrates , it is artificially heated by the artificial viscosity in every contraction until its pressure grows and stops the process . if we are not careful to properly tune the artificial viscosity we may end up with one ` disc ' shell that has been heated to @xmath129k while the rest of the ` disc ' is at @xmath76k .",
    "this imposes an undesired drastic decrease in the corresponding timestep . in order to overcome this numerical problem",
    ", we gradually turn off the quadratic term ( @xmath128 ) of the artificial viscosity inside the ` disc ' .",
    "we define a ` disc ' radius @xmath130 to be the largest radius for which the difference between the gravitational and centrifugal forces is less than 1/4 of the gravitational force .",
    "once at @xmath131 , we continuously decrease the parameter @xmath128 in according to @xmath132 and make it completely vanish at @xmath133 .",
    "this prescription was found by trial - and - error to properly solve the numerical problem in most cases .",
    "the linear term of the viscosity , being proportional to the speed of sound , is anyway very small in the cold ` disc ' , so effectively no artificial viscosity is applied in the inner ` disc ' .",
    "appendix [ app : code ] provides tests and examples of the hydrodynamic simulations in some detail .",
    "we now investigate the formation of a virial shock using the spherical hydrodynamical simulations described above .",
    "we wish to test in particular the validity of the analytic stability criterion developed in .    in order to mimic a typical perturbation in a random gaussian field ( dekel 1981 , appendix [ app : top_hat ] ) ,",
    "the initial density - fluctuation profile was set to be proportional to the correlation function , normalized such that the mean density fluctuation in a sphere enclosing @xmath134 was @xmath135 at @xmath117 .",
    "for example , the shell encompassing @xmath136 is expected to collapse at @xmath137 , and @xmath138 is expected to collapse at @xmath139 .",
    "shows the time evolution of the radii of lagrangian shells in a simulation of the adiabatic case , with the cooling turned off .",
    "we find that a shock exists at all times .",
    "it appears as a sharp break in the flow lines , associated with a discontinuous decrease in infall velocity [ ] . shown in the figure",
    "is the shock radius , defined by the outermost shell for which the inner and outer shell boundaries approach each other and the volume of the shell decreases [ the same conditions that have been used for turning on the artificial viscosity in ]",
    ". the shock gradually propagates outwards , encompassing more gas mass and dark matter in time .",
    "the gas below the shock is pressure supported and at quasi - static equilibrium .",
    "not shown here are the dark - matter shells , which collapse , oscillate and tend to increase the gravitational attraction exerted on the gas shells .    shown in comparison",
    "is the evolution of the virial radius , computed from the simulation density as the radius within which the mean overdensity is @xmath140 times the mean cosmological background density .",
    "the virial overdensity @xmath140 is provided by the dissipationless spherical top - hat collapse model ; it is a function of the cosmological model , and it may vary with time . for the einstein - desitter cosmology , the familiar value is @xmath141 at all times .",
    ", once the final radius is assumed to be fixed at half the maximum - expansion radius but the overdensity is evaluated at the time when the top - hat sphere would have collapsed to a singularity . ] for the family of flat cosmologies ( @xmath142 ) , the value of @xmath140 can be approximated by @xcite ( 18 ^ 2 + 82x - 39x^2)/(1+x ) , [ eq : dvir ] where @xmath143 , and @xmath144 is the ratio of mean matter density to critical density at redshift @xmath145 .",
    "for example , in the  cosmological model that serves as the basis for our analysis in this paper ( @xmath146 , @xmath147 ) , the value at @xmath139 is @xmath148 .",
    "we see in that the shock radius almost coincides with the virial radius at all times .",
    "this is hardly surprising , as the shock is likely to appear at the outermost radius at which shell crossing first occurs , which is near the virial radius ( to be demonstrated in below ) .",
    "is the result of a similar simulation , but now with realistic radiative cooling for @xmath149 .",
    "we see that a stable shock does not exist in this case before @xmath150gyr . during this period ,",
    "the cooling makes the gas lose its pressure support and lets it collapse freely under gravity into the halo centre .",
    "the collapse stops by the assumed angular momentum , in a ` disc ' whose marked radius can be identified at the bottom of the plot by the abrupt change of the infalling flow lines into horizontal lines .",
    "the matter in the disc is angular - momentum supported . as is visible in the figure , a shock , in the sense of a discontinuity in velocity and density , is present at the edge of the disc . once the stability criterion is met , a shock forms and propagates outward abruptly .",
    "the propagation of the shock causes it to re - enter a regime for which @xmath32 is below the critical value .",
    "consequently , the post shock gas becomes non - supportive again and falls .",
    "the oscillatory behavior of the shock continues with an increasing period until it stabilizes at the largest radius for which the stability criterion is met .",
    "the shock never expands beyond the virial radius because shells do not tend to cross there ( below ) .",
    "shows the evolution of the total mass interior to the characteristic radii in the adiabatic and radiative simulations of and . in the adiabatic case ,",
    "the shock mass practically coincides with the virial mass , and the gas never forms a disc . in the radiative case , the shock is initially at the disc radius , and only after 3.9gyr does it start propagating outwards .",
    "we first test the assumption made in that the post - shock gas has a homologous velocity profile in the vicinity of the shock . in figures [ fig : rt_nocool ] and [ fig : rt_cool ] we see that the flow lines beneath the shock tend to be nearly parallel in the @xmath39 plane .",
    "this means that @xmath151const . ,",
    "namely homology , . a similar behavior has been found in all the simulations that we have performed .",
    "next , we use the simulations to test the validity of the stability criterion derived in , , where @xmath32 is given by . recall that the @xmath32 is expressed in terms of the pre - shock quantities . in order to map the value of @xmath32 in the different regions of the free falling gas in the forming halo , we ran the same simulation as in the previous section except that the cooling rate was set to be very high , such that the virial shock never develops .",
    ", top panel shows the flow lines in this case , on which overlaid are 4 contours of equal @xmath32 values , evaluated via with and the cooling rate from @xcite .",
    "as shells are falling into the halo , their @xmath32 is gradually increasing .",
    "also , as time progresses , the value of @xmath32 at the same radius is increasing . by following the value of @xmath32 just above the `` disc '' radius ( shown as the break at the bottom of the plot ) , in comparison with the critical value for stability @xmath152",
    ", we can therefore use our model to predict when we expect the virial shock to form .",
    "this is shown in the middle panel of .",
    "we see that at early times ( and smaller masses ) we have @xmath153 , predicting no stable shock .",
    "the system is predicted to enter the stable - shock regime at about @xmath150gyr , where @xmath32 becomes larger than @xmath152 .",
    "a comparison with the realistic radiative simulation described in yields that this model prediction is very accurate : the shock indeed starts forming at @xmath150gyr , and is globally stable thereafter .",
    "shows the actual evolution of @xmath32 at either the ` disc ' radius or the shock radius , whichever is larger , as computed directly from the pre - shock quantities in the simulation with realistic cooling .",
    "shown at the same times are the characteristic masses , already shown in .",
    "the virial shock is first generated at time @xmath150gyr , when the virial mass is @xmath8 .",
    "starting at this time , the shock is propagating outwards very rapidly . as a result of this fast expansion",
    ", the @xmath32 of the pre - shock infalling matter at the shock , which is decreasing with @xmath1 , drops below the threshold .",
    "this makes the shock lose its pressure support , it becomes temporarily unstable and its expansion slows down until it is eventually swept back on a dynamic time scale .",
    "the associated drop in total mass behind the shock , seen around @xmath154gyr , is due to the fact that the dark matter is not swept back with the gas .",
    "once the shock is shrunk to a low enough radius , @xmath32 rises again to above @xmath152 ; the shock becomes stable again and it resumes its associated expansion towards the virial radius . after the conditions for the shock stability are first met , the shock is visible most of the time . in the rest of this paper , we treat haloes at this state as ones containing a virial shock .",
    "presents results similar to for two other simulations with different initial overdensities , and therefore different masses collapsing at different times . the small difference seen in one case between the @xmath32 at which the shock actually forms and the predicted @xmath152 may be totally due to numerical inaccuracies in the simulation .",
    "such inaccuracies may occur when a dark - matter shell crosses a gaseous shell , which , near the threshold , may lead to a slightly premature shock formation .",
    "this is seen in the convergence test of our code described in appendix  [ app : code ] , when we compare the shock formation times in table [ tab : divs ] .",
    "thus , the model stability criterion is found to be valid within the accuracy of the simulations in all the cases studied , indicating that the model is not limited to a special range of masses and collapse times .",
    "the analysis of thus provides a successful criterion for shock stability , , as a function of the pre - shock properties of the infalling gas at radius @xmath1 : the density , velocity and metallicity . in order to apply this criterion to a given protogalaxy in a cosmological background , we wish to evaluate the gas density and velocity just before it hits the disc , for a gas shell initially encompassing a total mass @xmath22 that virializes at redshift @xmath155 . in this calculation",
    "we assume an einstein - desitter cosmology , as a sensible approximation at @xmath156 ( where @xmath157 ) .    we assume a given universal baryonic fraction @xmath158 , and a global spin parameter @xmath159 which determines the ratio of disc to virial radius .",
    "the initial mean density perturbation profile , @xmath160 , is given at some fiducial time in the linear regime ; it is the average profile derived from the power spectrum of initial density fluctuations , as described in appendix [ app : initial_perturbation ] . in the cosmological toy model used here we approximate the power spectrum as a power law , @xmath161 , where @xmath162 to mimic the @xmath118cdm power spectrum on galactic scales .",
    "we follow gas shells from the initial perturbation till they approach the disc using a two - stage model . during the expansion , turn - around , and until an assumed _ virialization _ at half the maximum - expansion radius , we assume no shell crossing , the total mass interior to the shell remains constant in time , and we follow the radii , density and velocity of the shell via the spherical top - hat model ( see appendix [ app : top_hat ] ) . from the virial radius inwards we assume that the gas shells , which do not cross each other , contract inside the fixed potential well of an isothermal dark - matter halo .",
    "this idealized model involves several crude approximations , such as the instantaneous transition at the virial radius , and neglecting the effect of the angular momenta of the individual gas particles at small radii , but we show using spherical simulations that this model predicts the minimum halo mass for which a stable shock first appears to an accuracy better than 25% .",
    "this allows us to use the model for exploring the critical mass as a function of cosmological parameters such as galaxy formation time , metallicity , spin parameter , fluctuation power spectrum , and baryonic fraction .      for a given shell @xmath22 and initial mean perturbation profile @xmath163 [ standing for the @xmath160 of appendix [ app : top_hat ] ] , the top - hat model [ and ]",
    "yields the implicit solution r(m,)= ( m ) ( 1- ) , [ eq : r_m_eta ] t(m,)= ( m ) ( - ) , [ eq : t_m_eta ] where the mass dependence enters via the virial quantities = m^1/3 ( m)^-1 , = /= ^3/2 g^-1/2 ( m)^-3/2 , with @xmath164 . the coefficient @xmath165 is determined by @xmath166 , the cosmological density at the initial time when @xmath163 is given , independent of @xmath22 .",
    "the velocity of the shell @xmath22 is u = = . at virialization ,",
    "@xmath167 , it is simply @xmath168 .",
    "in order to evaluate the local density , we follow the radii of two adjacent shells , encompassing masses @xmath22 and @xmath169 respectively , at a given time @xmath34 , e.g. , the time when shell @xmath22 virializes ( at half its maximum expansion radius ) . let @xmath170 correspond to shell @xmath22 at that time , and @xmath171 to shell @xmath169 . in order to express @xmath172 in terms of @xmath173 we use the fact that the time @xmath34 is the same for the two shells : @xmath174 . using this",
    "gives d= dm , [ eq : deta ] where we denote @xmath175 .",
    "expressing @xmath176 in terms of @xmath173 and @xmath172 based on , we obtain using and after some algebra = ( 1- ) .",
    "[ eq : dr_dm ] at virialization of shell @xmath22 , @xmath167 , the quantity in square brackets equals @xmath177 .",
    "not surprisingly , if the initial perturbation is of uniform density , @xmath178 , we are left with @xmath179 , the straightforward result of @xmath180 .",
    "recall that the virial radius @xmath181 of shell @xmath22 can be obtained either from the universal density at the time of virialization using , or from the initial perturbation using .",
    "the desired local density @xmath3 can be obtained from via @xmath182 .    if the initial perturbation profile is a power law , @xmath183 , using @xmath184 we have @xmath185 .",
    "so finally = ( 1 + ( n+3 ) ) .",
    "[ eq : drv_dm_n ]    [ or in the power - law case ] allows us to compute the desired radii of the two adjacent shells at the time of virialization of shell @xmath22 .",
    "given the radii of the two adjacent shells at @xmath181 , we enter the shell - crossing regime and continue to follow the shells down to the disc radius by numerical integration .",
    "the shell radius @xmath1 and velocity @xmath4 are related via energy conservation .",
    "assuming that the gas shells contract without crossing each other inside a dark - matter halo that is a fixed isothermal sphere , the total mass interior to the shell that originally encompassed a total mass @xmath22 is m(r)=m+(1-)r , and the gravitational potential at @xmath1 is ( r)=- -(1- ) ( ) .",
    "the integration is performed by advancing @xmath1 according to the velocity @xmath4 and then recalculating @xmath4 according to energy conservation : ( 1/2)u^2+(r)=(1/2)^2+()=const . we follow shell @xmath22 for the time it falls from @xmath186 to the disc radius @xmath187 , and shell @xmath169 for the same time interval . denoting the separation between the shells at the end of this time interval by @xmath176 ,",
    "we compute the desired gas density by = .",
    "the resultant values of @xmath1 , @xmath4 and @xmath3 are inserted into in order to obtain an approximation for @xmath32 and then to evaluate stability by .",
    "this allows us to check stability for the case where mass @xmath22 virializes at redshift @xmath155 , with metallicity @xmath75 , spin parameter @xmath159 , baryonic fraction @xmath158 , and a given power spectrum .      in and we compare the evolution of the quantities of a given gas shell according to the toy model described in the previous subsections and according to the spherical hydro simulation described in the earlier sections .",
    "we follow a specific shell that hits the disc at about @xmath188gyr , just before the shock starts propagating into the halo [ see ] .",
    "the quantities shown as a function of radius @xmath1 are total mass @xmath22 interior to @xmath1 , radial velocity @xmath4 , gas density @xmath3 , and the corresponding value of @xmath32 . for @xmath22 and @xmath4 the evolution starts at the top - left corner and ends at the bottom left , while for @xmath3 the upper part of the curve corresponds to the expansion phase and the lower part to the contraction phase .",
    "the evolution of @xmath11 is followed only during part of the contraction phase .    in",
    "we calibrate the toy model to match the simulation at the maximum expansion radius .",
    "we see that while the mass interior to the shell is reproduced by the model only to a limited accuracy in the last stages of the collapse , the velocity , density and the resulting value of @xmath32 are recovered very well by the model .",
    "this allows us to predict quite accurately the point where @xmath32 exceeds @xmath152 .    since we wish to use the toy model without an exact knowledge of the conditions at maximum expansion , we normalize the model evolution in based on @xmath22 and @xmath155 .",
    "the slight deviations in @xmath4 and in @xmath3 now translate into a larger error in @xmath32 .",
    "the error in the toy model originates mostly from the slight ambiguity in the definition of the virial radius . on one hand",
    "we assume it to equal half the maximum - expansion radius , and on the other hand we assume it to represent an overdensity of @xmath140 as in .",
    "these two assumptions are not fully consistent with the actual behavior of the virializing system in the simulation .",
    "nevertheless , we see below that our approximate model allows us to estimate the critical halo mass below which the shock does not form to an accuracy of better than 25% , which is quite satisfactory for our purpose here",
    ".      shows for several different cases the critical halo mass , below which a shock does not propagate into the halo , versus the redshift at which this critical mass virializes . for each case",
    "we compare the model prediction to the shock formation as actually seen in the simulation .",
    "the cases differ by the mean metallicity , @xmath149 and @xmath189 for the lower and upper sets of points respectively , and by the amplitude of the initial perturbation , corresponding to a range of shock - formation redshifts at every given @xmath75 .",
    "the assumed baryonic fraction is always @xmath190 , but the assumed spin parameter may be different for the different shells in a given simulation because we set it for each shell such that the final disc has an exponential surface density profile . however , the @xmath159 values vary in the range @xmath191 to @xmath192 , compatible with the distribution of spin parameter in cosmological simulations ( bullock 2001 ) .",
    "we see that the model predicts the critical mass with an accuracy better than 25% , such that we can use it for mapping the parameter space in more detail",
    ".    shows for several different choices of parameters the critical halo mass for shock formation versus the halo virialization redshift as predicted by the model . a virial shock does not form in haloes of masses below the line .",
    "the lines are not always monotonic due to the non - monotonic features in the cooling curves ( ) . shown in comparison",
    "is @xmath193 , the characteristic mass for haloes forming at @xmath145 according to the press - schechter approximation @xcite .",
    "the default values of the parameters , used unless specified otherwise , are @xmath149 , @xmath194 , @xmath190 and @xmath195 .",
    "the upper panel has the metallicity varying from @xmath149 to @xmath196 .",
    "the critical mass tends to be higher at higher redshifts ( especially for @xmath149 ) because the higher density implies more efficient cooling .",
    "it is striking that even for the case of zero metallicity , for which the cooling is not at its maximum efficiency , an @xmath193 halo can not produce a shock until a relative late redshift , @xmath197 .",
    "the addition of a small amount of metals , @xmath189 , increases the cooling rate significantly ( see ) such that @xmath193 haloes start producing virial shocks only after @xmath198 .",
    "the second panel has @xmath159 varying as marked .",
    "the shock forms slightly earlier if the disc is smaller ( lower @xmath159 ) , because the conditions become more favorable for shock formation closer to the centre . at high redshifts",
    "the increase in infall velocity happens to balance out the increase in density , temperature and cooling rate .",
    "the post shock temperature there is a few @xmath199k .",
    "the bottom line is that the critical mass is not too sensitive to @xmath159 .",
    "the third panel has @xmath158 varying as marked .",
    "the critical mass is monotonic with the baryonic fraction because the cooling rate is monotonic with gas density .",
    "the parameter @xmath158 can be interpreted as the fraction of the baryons that actually take part in the shock formation .",
    "this can be smaller than the universal baryonic fraction if some of the gas falls into the halo in the form of dense clumps .",
    "even with @xmath158 as low as @xmath192 , meaning that most of the gas is not participating in the cooling , an @xmath193 halo would not produce a shock until @xmath200 .",
    "the conclusion is that the critical mass is not too sensitive to @xmath158 either .",
    "the bottom panel explores three values for the initial power index @xmath201 approximating the power spectrum of @xmath118cdm on galactic scales .",
    "the dependence of the critical mass on @xmath201 in this regime is weak .",
    "the heating of the gas behind a virial shock in haloes has been a basic component in galaxy formation theory @xcite .",
    "we studied the conditions for the existence of such a virial shock in spherical haloes .",
    "we first pursued an analytic stability analysis in the presence of cooling , and then demonstrated its validity using high - resolution spherical hydrodynamical simulations .",
    "the obtained criterion for shock stability in terms of the post - shock quantities is > 10/7 . in terms of the pre - shock gas properties ,",
    "this condition reads < 0.0126 , where @xmath68 and @xmath67 are the gas density and infall velocity in front of the shock , @xmath69 is the shock radius , @xmath5 is the cooling function which depends on the metallicity @xmath75 , and @xmath202 is the post - shock temperature as a function of the pre - shock infall velocity .",
    "based on this criterion , we find that a virial shock forms only in big haloes forming at late redshifts . a virial shock does not form in smaller haloes forming early where the cooling behind the shock efficiently removes its pressure support . for example , we find that most galactic haloes that have collapsed and virialized by @xmath7 did not produce a virial shock",
    ". haloes less massive than @xmath203 never produce a shock even if the gas is of zero metallicity . if the metallicity is non - negligible ( e.g. @xmath204 ) , this lower bound to shock formation rises to @xmath205 .",
    "when a shock does not exist , the gas is not heated to the halo virial temperature until it falls all the way to the disc at the inner halo .",
    "@xcite , in an unpublished work , have pursued independently a numerical analysis along similar lines , involving a more detailed treatment of the cooling processes involved .",
    "they also find that the virial shock radius is significantly reduced due to the cooling in haloes of small masses , @xmath206 . in their case",
    "the shock never completely disappears because of a different feature in their numerical scheme ; they put all the cooled post - shock gas in one central",
    " shell \" to avoid numerical difficulties at the centre .",
    "this makes the inner boundary of the system follow the shock quite closely in cases where there is efficient cooling behind the shock , and allows the presence of a small - radius shock even in such cases .",
    "overall , our numerical results are in encouraging agreement , and our analytic model provides a natural explanation for their numerical results as well .",
    "the most severe uncertainty when attempting to apply our results to real galaxies arises from the assumed spherical symmetry in both the model and the numerical simulations .",
    "the validity of this approximation for the asymmetric halo configurations in the hierarchical clustering scenario is an open question to be addressed in future work .",
    "nevertheless , we notice that @xcite and @xcite observe in their cosmological simulations that a large fraction of the mass accreted onto haloes indeed remains cold and is never heated to the virial temperature .",
    "@xcite find in their simulations , using a similar treesph code as the one used by @xcite , that the soft x - ray radiation is mainly emitted from within the innermost @xmath207 of their haloes , well inside the virial radius , in encouraging agreement with our results . on the other hand ,",
    "it is not obvious that the resolution in these simulations is adequate for studying the shock physics involved ; our estimates indicate that three - dimensional simulations with proper resolution are not practical at present ( appendix [ app : code ] ) .",
    "another complication may arise from radiative effects .",
    "even when there is no virial shock , the kinetic energy of the gas eventually turns into radiation when the gas infall motion is brought to a halt at the disc . at such densities ,",
    "the width of the shock front is much smaller than the width of the cooling front behind the shock , @xmath208pc versus @xmath209pc .",
    "thus , the gas in a thin shell behind the shock is heated to a temperature corresponding to its kinetic energy , and it cools by radiating soft x - rays .",
    "the x - ray radiation is expected to generate an ionized @xmath210 bubble , in which the ionization rate balances the recombination rate . the strmgren radius of this bubble is relatively small , on the order of a few kiloparsecs , because the high gas density implies a high recombination rate .",
    "the recombination process then generates a flux of radiation , emitted at the inner few kpc of the halo .    a naive inspection of cross sections",
    "might indicate that the radiation would be trapped inside the halo .",
    "this could in principle affect the shock stability in three different ways : by increasing the radiation pressure , by heating up the infalling matter , and by slowing down the radiative cooling responsible for the shock instability",
    ". it has been argued by @xcite that the radiation pressure at these low temperatures must be insignificant compared to the gas pressure even if all the internal energy was drained from the baryons into the radiation field .",
    "one might add that since the radiation pressure behaves like a @xmath211 gas , it could at most make the system marginally stable . when work is done on the radiation field , any leakage of radiation out would turn the energy into cooling rather than @xmath212 , and will thus reduce the effective gamma , making the system unstable .",
    "partial heating of the infalling gas should not affect our analysis as long as the temperature of the infalling matter is significantly below the virial ( post - shock ) temperature such that the strong shock approximation remains valid .",
    "the effect of the reduced cooling rate is yet to be investigated . in practice",
    ", we do not expect the radiation trapping to be very efficient , because the effective opacity is reduced by thermal broadening and by the systematic blue shift due to the gas infall motion . when the opacity is high",
    ", the radiation heats up the gas , which enhances the thermal broadening and the collisional ionization rate .",
    "this reduces the opacity and allows for radiation escape .",
    "the system is likely to reach a steady state in which it gradually cools .",
    "this process is under current investigation .",
    "feedback effects may further complicate the picture and affect shock stability .",
    "the energy fed back to the gas from stars , supernovae and agns may heat the halo gas and expel part of it .",
    "merging substructures may have additional complicated effects .",
    "these effects can not be captured by our idealized spherical analysis , and a proper study would probably require high - resolution three - dimensional hydrodynamical simulations . while observations and certain theoretical considerations indicate that feedback effects are likely to be important in galaxies as large as @xmath213 and may thus affect the shock stability ( e.g. dekel & silk 1986 ; dekel & woo 2003 , and references therein ) , it has proven difficult for numerical simulations to reproduce such effects in any but small dwarf galaxies , indicating that feedback effects may not be so crucial for the understanding of shock stability . until the dust settles on the role of feedback effects , our preliminary conclusions based on the spherical analysis should be taken with a grain of salt .",
    "the general absence of a virial shock might have three direct implications , which we study in associated papers .",
    "first , as explained above , when the gas is heated at the disc rather than near the halo virial radius , the generated x - ray radiation serves to ionize the gas and is not emitted outwards .",
    "the result would be a suppression of the x - ray emission in the range @xmath214 to @xmath215k .",
    "this may help explaining the missing x - ray problem pointed out by @xcite and @xcite .",
    "@xcite argue that there is an order - of - magnitude discrepancy between the soft x - ray flux as observed by @xcite , after subtracting the contribution of quasars , and the predicted flux from haloes constructed by a press - schechter hierarchical model under the assumption of shock heating to the virial temperature .",
    "second , the infall energy , via the ionizing x - ray , is efficiently transformed into radiation at the inner few kpc of the halo . a related increase in the flux",
    "has indeed been seen in the cosmological simulations of @xcite .",
    "this may explain the observed high flux of emitters at high redshift ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "based on the high observed flux and the assumption that the is emitted from stars , @xcite estimate large masses for the emitters , but the much higher flux per unit mass predicted by our model may lead to significantly lower mass estimates . based on our analysis ,",
    "most of the flux is expected to be emitted from the inner few kpc of the halo , where the gas is at @xmath216k . neglecting line shifts and broadening",
    ", the halo might be opaque to , thus eventually emitting its energy from an outer photosphere where the halo becomes transparent .",
    "however , a careful study of the thermal broadening and the systematic redshifts within the halo is required in order to determine whether the system is opaque or transparent to the photons .",
    "this is a subject of an ongoing investigation .",
    "finally , the direct collapse of cold gas into the disc may have interesting theoretical consequences to be worked out .",
    "it may induce an efficient star burst in analogy to the burst originating in the shock between two colliding gas clouds . in turn",
    ", the strong inwards flow of gas may prevent an efficient gas removal by supernova - driven winds .",
    "in particular , current cosmological semi - analytic models ( sam ) of galaxy formation use the standard picture of heating behind a virial shock in their modeling .",
    "this has strong effects on the disk formation rate , star formation rate , feedback etc .",
    "other semi - analytic models @xcite also appeal to the slow gas infall rate as a mechanism that regulates the gas input into the disc .",
    "since the cooling time for a @xmath8 halo is relatively short , the sam predictions for such haloes may be only slightly affected by the inhibition of heating .",
    "however , given some metal enrichment , no heating is expected for haloes as massive as @xmath217 , for which the cooling time is longer , and the effect on the sam predictions may be more severe .",
    "shocks , when present , are also expected to alter the properties of the gas , for example - extinct dust particles .",
    "these effects can change sams that incorporate dust extinction .",
    "we acknowledge advice from z. barkat and e. livne , j. ostriker and stimulating discussions with s. balberg , e. bertschinger , t. broadhurst , d. gazit , y. hoffman , w. mathews , a. nusser , n. shaviv , and s.d.m .",
    "this research has been supported by the israel science foundation grant 213/02 , by the german - israel science foundation grant i-629 - 62.14/1999 . and by nasa atp grant nag5 - 8218 .",
    "bardeen j. m. , bond j. r. , kaiser n. , szalay a. s. , 1986 , apj , 304 , 15    benson , a.j . , bower , r.g . ,",
    "frenk , c.s . ,",
    "white , s.d.m .",
    ", 2000 , mnras , 314 , 557    bertschinger e. , 1985 , apjs , 58 , 1    bertschinger e. , 1985 , apjs , 58 , 39    de breuck c. , rottgering h. , miley g. , van breugel w.,best p. , 2000 , a&a , 362 , 519    bryan g.l .",
    ", norman m.l . , 1997 , apj 495 , 80    cole s. , aragn - salamanca a. , frenk c. , navarro j. , zepf s. , 1994 , mnras , 271 , 781    chi w. , sanders w.t . , mccammon d. , snowden s.l . , womble d.s . , 1996 , apj , 486 , 117    cox j.p . , 1980 ,",
    "theory of stellar pulsation ( princeton university press )    dekel a. , 1981 , a&a , 101 , 79    dekel a. , silk j. , 1986 , apj , 303 , 39    dekel a. , woo j. , 2002 , submitted ( astro - ph/0210454 )    efstathiou g. , 2000 , mnras , 317 , 3 , 697    efstathiou g. , bond j. r. , white , s. d. m. 1992 , mnras , 258 , 1p    m. a. , katz n. , gardner j. p. , hernquist l. , weinberg d. h. , dav r. , 2001 , apj , 562 , 605    forcada - miro m. i. , white s. d. m. , 1997 , astro - ph/9712204 ( unpublished )    ghigna s. , moore b. , governato f. , lake g. , quinn t. , stadel j. , 1998 , mnras , 300 , 146    katz n. , keres d. , dav r. , weinberg d.h .",
    ", 2001 , astro - ph/209279    kauffmann g , white s.d.m .",
    ", guiderdoni b. , 1993 , mnras , 264 , 201    kauffmann g. , colberg j. m. , diaferio a. , white s. d. m. , 1999 , mnras , 303 , 1 , 188    lacey c. , cole s. , 1993 , mnras , 262 , 627    maller a. h. , prochaska j. x. , somerville r. s.,primack j. e. 2001 , mnras 326 , 4 , 1475    peebles , p.j.e . , 1993 , principles of physical cosmology ( princeton university press )    pen u. l. , 1999 , apjl 510 , 2 , l1    pentericci l. , kurk j.d . , rottgering h.j.a , miley g.k .",
    ", van breugel w. , carilli c.l .",
    ", ford h. , heckman t. , mccarthy p. , moorwood a. , 2000 , a&a 361 , 2 , l25    pentericci l. , kurk j.d .",
    ", rottgering h.j.a . , miley g.k . ,",
    "venemans b.p . , 2001 ,",
    "asp conference series , astro - ph-0110223    press w. , h. , teukolsky s. a. , vetterling w. t. , flannery b. p. , 1997",
    ", numerical recipes is fortran 77 ( cambridge university press )    rees m.j .",
    ", ostriker j.p . , 1977 , mnras , 179 , 541    safran , m. , dekel , a. , 2003 , in preparation    somerville r.s . , primack j.r . , 1999 , mnras , 310 , 1087    sutherland r. , dopita m. , 1993 , apjs , 88 , 253    toft , s. , rasmussen , j. , sommer - larsen , j. , pedersen , k. , 2002 , mnras , 335 , 799    white s.d.m .",
    ", frenk c. , 1991 , apj , 379 , 52    zeldovich ya . b. , raiser yu .",
    ", physics of shock waves and high - temperature hydrodynamic phenomena ( academic press )",
    "the numerical code , _ hydra _ , has been developed specifically for simulating the evolution of a single spherical halo through collapse and feedback processes .",
    "a proper computation of the cooling and shock formation requires high precision . in this appendix",
    "we describe a few of the tests performed in order to verify that the code works properly . in the following three subsections we test for energy conservation , spatial convergence , and the performance of the code in a self - similar case .",
    "our numerical scheme does not use the total energy equation in the integration of the partial differential equations .",
    "furthermore , the total energy of the system is not a straightforward sum of other variables that are involved in the calculation .",
    "the requirement of energy conservation is therefore an independent test for the accuracy of the numerical scheme .",
    "energy conservation is harder to achieve than spatial convergence for several reasons .",
    "first , the error in total energy is systematic , in the sense that when dark - matter shells cross each other the energy tends to increase .",
    "second , since our system is only marginally bound , the total energy is a small difference between two large quantities .",
    "we notice that energy conservation is simpler to achieve when there is no cooling , or when dark matter is absent ( and thus there is no shell crossing ) .    the total energy of the system at time @xmath34 is the sum of terms : e = k_d+t_d + k_g+t_g+u+q , where subscripts d and g refer to dark matter and gas respectively , @xmath218 stands for kinetic energy , @xmath51 stands for potential energy , @xmath219 is the gas internal energy , and @xmath220 is the thermal energy lost to radiation by time @xmath34",
    ".    for the dark matter , these are straightforward sums over the discrete dark - matter shells : k_d= _ i _ i=1^n_d ( v_i^2 + ) , t_d= -_i=1^n_d , where @xmath221 is the total mass interior to dark - matter shell @xmath98 , as defined in .    for the gas shells , recall that the quantities @xmath1 , @xmath97 and @xmath86 are given at the inner and outer shell boundaries , @xmath222 and @xmath98 respectively , so we compute the shell energies by averaging over the two boundary values : @xmath223 t_g= -_i=1^n_g .    the internal energy is a straightforward sum u = e_i _ i . the energy radiated away , @xmath224 , is computed by q_=_j=1^n_t t^j _",
    "i=1^n_g q^j_i _ i , where @xmath225 is the length of timestep @xmath86 , and @xmath226 is the cooling rate in shell @xmath98 at timestep @xmath86 ( in units of @xmath227 ) .    in a run with 10,000 dark - matter shells and 2,000 gas shells , we require and obtain energy conservation at the level of 1% in a hubble - time , using a typical runge kutta timestep of about @xmath228",
    "( such a run takes about 10 hours on an alpha-6 dec processor ) .",
    "we check the conservation first by varying the accuracy parameters presented in , and then by varying the number of shells .",
    "the three cases presented in table [ tab : eps ] demonstrate that the results converge when the accuracy is increased .",
    "the simulations shown in this table are of the standard case with realistic cooling shown in .",
    "when cooling is shut off , energy conservation is much better . with the nominal choice of accuracy parameters",
    "the final energy is @xmath229 of the initial energy .",
    ".energy conservation [ cols=\"<,<,<,<,<,<,^\",options=\"header \" , ]     [ tab : divs ]    a proper treatment of the competition between the pressure increase due to contraction and the pressure decrease due to cooling requires high temporal and spatial resolution . in particular , when the spatial resolution is increased , the shock appears earlier .",
    "table [ tab : divs ] shows results from simulations of the case with realistic cooling ( ) , all with the same accuracy criteria ( @xmath107 , @xmath102 , and @xmath115 ) , but with different spatial resolutions . the average distance between gas shells near the center ranges from about @xmath230pc to @xmath231kpc .",
    "with the poorest resolution of 125 gas shells the virial shock appears almost immediately after the virialization of the first shells of the simulation .",
    "the energy changed by about 75% during this simulation .",
    "even if we assume that the precision of a 3d calculation is as good as that of an analogous 1d calculation ( actually sph codes converge slower than finite element schemes for problems involving shocks ) , we still need to cube the number of particles or grid points in order to achieve the same resolution .",
    "a three - dimensional simulation with @xmath215 gas particles and @xmath232 dark - matter particles , which is close to the limit of what is computationally feasible today , would correspond to the unsatisfactory case with the lowest spatial resolution in table [ tab : divs ] .",
    "when the initial conditions are scale free ( unlike the initial conditions assumed in the body of this paper , motivated by @xmath118cdm ) , and when the cooling function is also scale free ( unlike the realistic cooling function used above ) , the results should be self similar .",
    "this can provide a test for the accuracy of our numerical code .",
    "we follow @xcite in using an initial perturbation consisting of a point - mass embedded in a uniform - density background .",
    "far from the point mass , the system should be self similar .",
    "we ran a simulation of such a case using our code with gas only ( @xmath233 ) and no cooling , starting at @xmath234 with an overdensity of 10 inside the innermost @xmath231kpc .",
    "the upper panel of shows the density profile at different times .",
    "as expected , a shock appears at every time as a density jump by a factor of 4 [ @xmath235 for @xmath64 ] , and the post - shock gas settles to a complete rest after it is shocked .",
    "( the slope of the post - shock density profile is somewhat different from @xcite , because our calculation assumes a cosmology rather than the einstein - desitter assumed by bertschinger . )",
    "the lower panel shows the same profiles after they were scaled to the same time ( 5gyr ) according to the scaling relation of @xcite : @xmath237 .",
    "we see that our simulations recover the expected scaling relation almost perfectly",
    ".    shows an analogous test for the case where both gas and dark matter are present , with @xmath190 .",
    "the results are similar except for the somewhat higher noise level caused by the dark - matter component .",
    "consider a bound spherical perturbation encompassing mass @xmath22 , whose mean density fluctuation profile at some fiducial initial time in the linear regime is @xmath160 , embedded in an einstein - desitter ( eds ) cosmological background when the universal expansion factor is @xmath238 .",
    "we wish to express the shell radius @xmath1 as a function of time in terms of @xmath22 .",
    "the implicit solution for a closed  mini - universe \" , via a conformal time parameter @xmath170 specific to this perturbation , is r=(1- ) , [ eq : r_eta ] t=(- ) .",
    "[ eq : t_eta ] maximum expansion occurs when @xmath239 , and then a collapse to half this radius , which we identify with _ virialization _ , is obtained at @xmath167 , with virial radius @xmath181 and corresponding virial velocity @xmath240 .",
    "we normalize the universal expansion factor @xmath87 by identifying it at the initial time with the shell radius @xmath1 . assuming @xmath241",
    ", we have @xmath242 and @xmath243 , so @xmath244 yields @xmath245 . the eds expansion factor , @xmath246 ,",
    "can now be related using to the perturbation s @xmath170 at any time : a=(9 ^ 2/2)^1/3 t^2/3 = ( 9/2)^1/3(-)^2/3 .",
    "[ eq : a_eta ] the mean density within the perturbation relative to the universal density at the same time becomes a straightforward function of @xmath170 : = = .",
    "[ eq : rho_eta ] this is a standard result of the top - hat model .    in order to relate the density to the small initial perturbation at @xmath247 , we obtain from by a proper taylor expansion to the first non - vanishing order : |0.15 , where @xmath248 is the mean fluctuation . using",
    "this in the linear term of we obtain = ( 1/2)^2 = ( 1/0.3)| .",
    "[ eq : a_i ] this allows us to write the mean density at any @xmath170 , using , as = = .",
    "recalling that @xmath249 $ ] we finally obtain at any @xmath170 r= ( 1- ) , [ eq : r_m ] where ( ) ^1/3 . in particular , at @xmath167",
    ", we obtain for the virial radius @xmath250 .",
    "the constant @xmath251 is independent of @xmath22 ; the universal density @xmath166 [ @xmath252 is determined by the choice of the fiducial redshift @xmath253 at which @xmath160 is given .",
    "0i_0i we adopt in the linear regime the typical density fluctuation profile for the assumed power spectrum of fluctuations . for a gaussian random field , this profile is proportional to the two - point correlation function @xcite : ( r)=0i , where @xmath254 specifies the amplitude normalization . for a given power spectrum @xmath255 , the correlation function is given by ( * ? ? ?",
    "* eq .  21.40 ) ( r)=4_0^k^2 dk p(k ) , and the local variance is ( 0)=4_0^k^2 dk p(k ) .",
    "the mean density fluctuation interior to radius @xmath1 , containing mass @xmath256 when the fluctuation is small , is |(r)=_0^r r^2dr ( r ) .",
    "[ eq : bardeli ] this involves the integral ( * ? ? ? * eq .",
    "21.62 ) j_3(r)_0^r r^2 dr ( r ) = _ 0^k^2",
    "dk p(k ) w_s(kr ) , where @xmath257 is the fourier transform of the top - hat window , w_s(kr ) = 3=j_1(kr ) , with @xmath258 the spherical bessel function .",
    "we use in the simulations of this paper the @xmath118cdm power spectrum as from the fitting formula of @xcite p(k ) = akt^2(k ) , t(k)=\\{1+^}^1/ with @xmath259mpc , @xmath260mpc , @xmath261mpc , @xmath262 and @xmath263 ( the @xmath264cdm model of * ? ? ?",
    "the normalization is such that @xmath265    in the cosmological toy model we approximate the @xmath118cdm by a power - law power spectrum @xmath161 , for which the two - point correlation function is also a power law , @xmath266 , and then |(r)= ( r1i ) ^-(n+3 ) , where @xmath267 provides the normalization . in terms of mass",
    "we obtain |(m ) = ( m(4/3 ) 1i^3 ) ^-(n+3)/3 .",
    "[ eq : deli_m ] this serves as the input to , or .",
    "we normalize the initial perturbation such that a specific mass @xmath268 reaches virialization at some cosmological epoch @xmath269 . using and",
    "we obtain the linear analog to the nonlinear fluctuation growth rate : = 0.3 ( ) ^1/3 ( -)^2/3 . at virialization , this gives @xmath270 ."
  ],
  "abstract_text": [
    "<S> we investigate the conditions for the existence of an expanding virial shock in the gas falling within a spherical dark - matter halo . </S>",
    "<S> the shock relies on pressure support by the shock - heated gas behind it . when the radiative cooling is efficient compared to the infall rate the post - shock gas becomes unstable ; it collapses inwards and can not support the shock . </S>",
    "<S> we find for a monoatomic gas that the shock is stable when the post - shock pressure and density obey @xmath0 . </S>",
    "<S> when expressed in terms of the pre - shock gas properties at radius @xmath1 it reads @xmath2 , where @xmath3 is the gas density , @xmath4 is the infall velocity and @xmath5 is the cooling function , with the post - shock temperature @xmath6 . </S>",
    "<S> this result is confirmed by hydrodynamical simulations , using an accurate spheri - symmetric lagrangian code . </S>",
    "<S> when the stability analysis is applied in cosmology , we find that a virial shock does not develop in most haloes that form before @xmath7 , and it never forms in haloes less massive than a few @xmath8 . in such haloes , the infalling gas is not heated to the virial temperature until it hits the disc , thus avoiding the cooling - dominated quasi - static contraction phase . </S>",
    "<S> the direct collapse of the cold gas into the disc should have nontrivial effects on the star - formation rate and on outflows . </S>",
    "<S> the soft x - ray produced by the shock - heated gas in the disc is expected to ionize the dense disc environment , and the subsequent recombination would result in a high flux of emission . </S>",
    "<S> this may explain both the puzzling low flux of soft x - ray background and the emitters observed at high redshift .    </S>",
    "<S> [ firstpage ]    cooling flows  dark matter  galaxies : formation  galaxies : ism  hydrodynamics  shock waves </S>"
  ]
}