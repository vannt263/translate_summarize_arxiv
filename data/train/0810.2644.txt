{
  "article_text": [
    "quantum dots , nanometre - scale semiconductor devices confining a varying number of electrons , have been studied intensely in the last two decades .",
    "quantum dots are fabricated using essentially macroscopic tools , for example etching techniques , but the resulting confinement allows for quantum mechanical behaviour of the electrons .",
    "many of the parameters are directly controllable , thereby justifying the term `` artificial atoms '' or `` designer atoms '' .",
    "these considerations explain the immense research activity on these systems . for a general introduction ,",
    "see ref .",
    "@xcite and references therein .",
    "a very common model is that of a parabolic quantum dot , in which @xmath0 electrons are confined in an isotropic harmonic oscillator potential in @xmath1 spatial dimensions , where @xmath1 is determined by the semi - conductor environment .",
    "electronic structure calculations on the parabolic dot and similar systems are often carried out using the full configuration - interaction method ( fci ) , also called exact diagonalization @xcite .",
    "the hamiltonian is then projected onto a finite - dimensional subspace of the @xmath0-electron hilbert space and diagonalized .",
    "care is taken in order to exploit dynamical and discrete symmetries of the exact problem , such as conservation of angular momentum and total electron spin , in order to block - diagonalize the hamiltonian matrix and reduce the computational complexity .    in this article , we describe openfci , a recently developed open source c++ code implementing the fci method for quantum dots @xcite .",
    "the code has a generic framework in the shape of library functions , thereby allowing easy customization and extension to other systems and methods , e.g. , three - dimensional quantum dots or the nuclear no - core shell model .",
    "openfci implements a renormalization of the two - body interactions , a technique widely used in nuclear no - core shell model calculations .",
    "this allows for accelerated convergence with respect to slater determinant basis size @xcite . to the author s knowledge ,",
    "no other available code provides such effective interactions for quantum dot systems .",
    "the code can be easily modified to create effective interactions for almost many - body problem using a harmonic oscillator basis .",
    "the code is developed in a linux environment using gnu c++ , and is readily portable to other environments and compilers .",
    "the fortran 77 libraries lapack and arpack are required , but as these are available on a wide range of platforms , portability should not be affected .",
    "openfci is released under the gnu general public license ( gnu gpl ) @xcite and is documented using doxygen @xcite . as an open source project , the code can freely be used and modified .",
    "the article is organized as follows : in section [ sec : fci - method ] , the fci method is introduced in the context of the parabolic quantum dot , where we also discuss the reduction of the hamiltonian matrix by means of commuting operators and configurational state functions . in section [ sec : effective - int ] we discuss the effective two - body interaction .",
    "as the technique is likely to be unfamiliar to most readers outside the nuclear physics community , this is done in some detail . in section [ sec : code ] we discuss the organization and use of openfci .",
    "we also give some results from example runs , and in particular an analytically solvable non - trivial model due to johnson and payne is considered @xcite , where the only modification of the parabolic quantum dot is the interaction .",
    "finally , we conclude our article in section [ sec : conclusion ] .",
    "two appendices have been provided , appendix [ sec : com ] detailing the heavily - used centre - of - mass transformation and appendix [ sec : radial - method ] discussing the exact numerical solution of the two - electron quantum dot needed for the effective interaction scheme .",
    "we consider @xmath0 electrons trapped in an isotropic harmonic oscillator potential in @xmath1 spatial dimensions .",
    "the electrons interact via the coulomb potential given by @xmath2 , where @xmath3 is the inter - particle distance and @xmath4 is a constant .",
    "the quantum dot hamiltonian then reads @xmath5 where the second sum runs over all pairs @xmath6 , and where @xmath7 is the one - body hamiltonian defined by @xmath8 the interaction strength @xmath4 is given by @xmath9 where @xmath10 is the dielectric constant of the semiconductor bulk , @xmath11 ev@xmath12 nm , and @xmath13 , @xmath14 being the trap size and length unit , and @xmath15 being the effective electron mass .",
    "typical values for gaas quantum dots are @xmath16 , @xmath17 electron masses , and @xmath18 nm , yielding @xmath19 .",
    "the energy unit is @xmath20 , in this case @xmath21 mev .    choosing a complete set @xmath22 of single - particle orbitals ( where @xmath23 denotes both spatial and spin degrees of freedom , and @xmath24 denotes both generic spatial quantum numbers @xmath14 and spin projection quantum numbers @xmath25 )",
    ", @xmath26 can be written in occupation number form as @xmath27 where @xmath28 ( @xmath29 ) creates ( destroys ) a particle in the orbital @xmath30 .",
    "these operators obey the usual anti - commutation relations @xmath31 for a review of second quantization and occupation number formalism , see for example ref .",
    "the single - particle orbitals are chosen on the form @xmath32 where @xmath33 are spinless orbitals and @xmath34 are spinor basis functions corresponding to the eigenstates of the spin - projection operator @xmath35 with eigenvalues @xmath36 .",
    "it is important , that since the single - particle orbitals @xmath37 are denumerable , we may choose an ordering on the set @xmath38 , such that @xmath38 can in fact be identified with a range of integers , @xmath39 . in most",
    "_ ab initio _",
    "systems @xmath40 is infinite , since the hilbert space is infinite - dimensional .",
    "similarly , @xmath41 is identified with even integers , and @xmath42 with odd integers , creating an ordering of the single - particle orbitals @xmath30 , and @xmath43 is identified with an integer @xmath44 .",
    "the single - particle matrix elements @xmath45 and the two - particle elements @xmath46 are defined by @xmath47 and @xmath48 respectively .    the spatial orbitals @xmath49 are usually chosen as eigenfunctions of @xmath50 , so that @xmath51 .",
    "the basis functions for @xmath0-particle hilbert space are slater determinants @xmath52 defined by @xmath53 where @xmath54 is the group of permutations of @xmath0 symbols .",
    "the slater determinants are anti - symmetric with respect to permutations of both @xmath55 and @xmath56 , so that the orbital numbers @xmath56 must all be distinct to give a nonzero function .",
    "each orbital is then occupied by at most one particle .",
    "moreover , for a given set @xmath57 of orbitals , one can create @xmath58 distinct slater determinants that are linearly dependent . in order to remove this ambiguity",
    ", we choose only orbital numbers such that @xmath59 whenever @xmath60 .",
    "it follows , that there is a natural one - to - one correspondence between slater determinants with @xmath0 particles and integers @xmath61 whose binary representations have @xmath0 bits set .",
    "( if @xmath62 , the integers are limited to @xmath63 . )",
    "each bit position @xmath64 corresponds to an orbital @xmath30 through @xmath65 , and the bit is set if the orbital is occupied . creating and destroying particles in @xmath66 simply amounts to setting or clearing bits ( possibly obtaining the zero - vector if a particle is destroyed or created twice in the same orbital ) , keeping track of the possible sign change arising from bringing the set @xmath67 on ordered form using eqn .",
    "( [ eq : anticommutators ] ) .",
    "note that the vacuum @xmath68 corresponds to @xmath69 , which is _ not _ the zero vector , but the single state with zero particles .",
    "the fci calculations are done in a finite - dimensional subspace @xmath70 of the @xmath0-particle hilbert space , called the model space .",
    "the model space has a basis @xmath71 of slater determinants , and @xmath70 has the orthogonal projector @xmath72 given by @xmath73 the configuration - interaction method in general now amounts to diagonalizing ( in the sense of finding a few of the lowest eigenvalues of ) the , in general , large and sparse matrix @xmath74 .",
    "the only approximation we have made is the truncation of the @xmath0-particle hilbert space .",
    "the model space @xmath70 is seen to be a function of the single particle orbitals @xmath49 , whom we choose to be the eigenfunctions of @xmath50 , i.e. , harmonic oscillator eigenfunctions .",
    "these may be given on several equivalent forms , but it is convenient to utilize rotational symmetry of @xmath50 to create eigenfunctions of the projection of the angular momentum @xmath75 . in @xmath76 dimensions we obtain the fock - darwin orbitals defined in polar coordinates by @xmath77 here @xmath78^{1/2}l_n^k(x)$ ] is the normalized generalized laguerre polynomial .",
    "the factor @xmath79 is for convenience , see appendix [ sec : com - cartesian ] .",
    "the harmonic oscillator energy is @xmath80 and the eigenvalue of @xmath81 is @xmath82 .",
    "all eigenfunctions with the same energy @xmath83 span a single - particle _ shell_. the single - particle orbitals are illustrated in fig .",
    "[ fig : shells ] .     at each orbital .",
    "orbital @xmath84 , @xmath85 in shell @xmath86 is occupied by two electrons for illustration.[fig : shells ] ]    for a slater determinant @xmath66 , we have @xmath87 with @xmath88 where @xmath89 , and @xmath90 where @xmath91 .    to complete our definition of @xmath70 ,",
    "we let @xmath92 where @xmath93 is called the energy cut , for obvious reasons . as @xmath94",
    ", the whole hilbert space is spanned , and the eigenpairs of @xmath74 converge to those of @xmath26 .      in order to reduce the complexity of the computations , we need to exploit symmetries of @xmath26 .",
    "first of all , @xmath95=0 $ ] , and it is obvious that also @xmath96=0 $ ] , where the spin projection operator @xmath35 is given by @xmath97 the slater determinants are eigenvectors of both @xmath75 and @xmath35 with eigenvalues @xmath98 and @xmath99 , respectively .",
    "we obtain a natural splitting of the model space @xmath70 into subspaces with constant angular momentum @xmath98 and spin projection @xmath100 , viz , @xmath101 the diagonalization of @xmath26 can thus be done within each space @xmath102 separately , amounting to diagonalizing individual blocks @xmath103 .",
    "the hamiltonian ( [ eq : h - occ ] ) also commutes with total electron spin @xmath104 , @xmath105=0 $ ] , given by @xmath106 with @xmath107 so that a common basis for @xmath35 and @xmath104 would lead to even smaller matrix blocks .",
    "the eigenvalues of @xmath104 are on the form @xmath108 , where @xmath109 is an odd ( even ) integer for odd ( even ) @xmath0 . for a joint eigenfunction of @xmath35 and @xmath104 ,",
    "called a configurational state function ( csf ) , @xmath110 .",
    "the slater determinants are , however , not eigenfunctions of @xmath104 , but such can be constructed by taking linear combinations of a small number slater determinants . for details on this algorithm , see ref .",
    "suffice it to say here , that @xmath104 only couples slater determinants with identical sets of doubly occupied orbitals ( meaning that @xmath111 and @xmath112 are both occupied , as in figure [ fig : shells ] ) and singly occupied orbitals ( meaning that only one of @xmath111 and @xmath112 are occupied ) .",
    "it is easy to see that @xmath104 does not couple slater determinants in @xmath102 to another @xmath113 .",
    "thus , we obtain the splitting @xmath114 we stress that all the mentioned operators commute with each other , viz , @xmath115 = [ \\omega_i,\\omega_j ] = 0,\\ ] ] with @xmath116 .",
    "if a modified problem breaks , say , rotational symmetry , such that @xmath95\\neq 0 $ ] , we may still split the model space into to the eigenspaces of @xmath35 and @xmath104 .      the remaining ingredient in the fci method is the coulomb matrix elements @xmath46 defined in eqn .",
    "( [ eq : inter - matrix ] ) . these can be calculated by first expanding @xmath117 in powers of @xmath118 using @xmath119 and evaluating the resulting integral term - by - term by analytical methods @xcite .",
    "the resulting expression is a seven - fold nested sum , which can be quite time - consuming , especially if a large number of fock - darwin orbitals occurs in the basis @xmath71 .",
    "moreover , the terms are fractions of factorials with alternating signs , which is a potential source of loss of numerical precision .",
    "we therefore opt for a more indirect approach , giving a procedure applicable to a wide range of potentials @xmath120 in addition to the coulomb potential .",
    "moreover , it can be generalized to arbitrary spatial dimensions @xmath1 .",
    "the approach is based on directly transforming the product functions @xmath121 to the centre - of - mass system , where the interaction @xmath120 only acts on the relative coordinate , and then transforming back to the lab system .",
    "this reduces the computational cost to a doubly nested sum , as well as the pre - computation of the centre - of - mass transformation and the relative coordinate interaction matrix .",
    "both can be done exactly using gaussian quadrature .",
    "the transformations to and from the centre of mass frame are unitary transformations , which are stable and will not magnify round - off errors .    in appendix",
    "[ sec : com ] we provide the details of the centre - of - mass transformation .",
    "one then obtains the following prescription for the interaction matrix elements @xmath46 : let @xmath122 , @xmath123 , @xmath124 , and @xmath125 be the circular quantum number equivalents of the usual polar coordinate quantum numbers @xmath126 and @xmath127 . due to conservation of angular momentum",
    ", we assume @xmath128 ; otherwise , the matrix element @xmath129 .",
    "define @xmath130 , @xmath131 , @xmath132 , and @xmath133 .",
    "since @xmath46 is linear in @xmath4 , we set @xmath134 without loss of generality .",
    "now , @xmath135 where @xmath136 , @xmath137 , @xmath138 , @xmath139 .",
    "moreover , @xmath140 and @xmath141 .    here ,",
    "@xmath142 are centre - of - mass transformation coefficients defined in appendix [ sec : com ] , while the relative coordinate interaction matrix elements @xmath143 , @xmath144 , are defined by @xmath145 depending on @xmath120 , the integral is best computed using generalized half - range hermite quadrature ( see appendix [ sec : radial - method ] and ref.@xcite ) or gauss - hermite quadrature .",
    "weights and abscissa for quadratures are conveniently computed using the golub - welsch algorithm @xcite , which only depends on the ability to compute the coefficients of the three - term recursion relation for the polynomial class in question , as well as diagonalizing a symmetric tri - diagonal matrix .",
    "let @xmath146 be a polynomial , and let @xmath147 and @xmath148 be non - negative constants .",
    "then @xmath149 admit exact evaluations using generalized half - range gauss - hermite quadrature .",
    "the coulomb potential , gaussian potentials , and the parabolic interaction @xmath150 of the analytically solvable model treated in sec .",
    "[ sec : results ] belong to this class of potentials .    in the case of @xmath151 and @xmath152 ( i.e. , an even polynomial ) ,",
    "the integral is more convenient to evaluate using standard gauss - hermite quadrature .",
    "the coulomb interaction falls into this class .",
    "of course , one may let @xmath146 be a non - polynomial function as well and still obtain very good results , as long as @xmath146 is well approximated with a polynomial , e.g. , is smooth .",
    "the fci calculations converge relatively slowly as function of the model space parameter @xmath93 @xcite , as the error @xmath153 in the eigenvalue behaves like @xmath154 in general , where @xmath155 .",
    "this behaviour comes from the singular nature of the coulomb interaction .    in ref .",
    "@xcite , numerical results using an effective interaction were presented .",
    "this method is widely used in no - core shell model calculations in nuclear physics , where the nucleon - nucleon interaction is basically unknown but highly singular @xcite . this so - called sub - cluster",
    "effective interaction scheme replaces the coulomb interaction ( or another interaction ) @xmath156 with a renormalized interaction @xmath157 obtained by a unitary transformation of the two - body hamiltonian that decouples the model space @xmath70 and its complement @xcite .",
    "therefore , the two - body problem becomes _ exact _ in a _",
    "finite _ number of harmonic oscillator shells . loosely speaking",
    ", the effective interaction incorporates information about the interaction s action _ outside _ the model space . in general",
    ", @xmath157 is non - linear in @xmath4 and not a local potential .    using the renormalized @xmath157 ,",
    "the many - body system does not become exact , of course , but @xmath157 will perform better than the bare interaction in this setting as well . to the author s knowledge , there exists no rigorous mathematical treatment with respect to this , but it has nevertheless enjoyed great success in the nuclear physics community @xcite , and our numerical experiments unambiguously demonstrate that the convergence of the fci method is indeed improved drastically @xcite , especially for @xmath158 particles .",
    "we stress that the cost of producing @xmath157 is very small compared to the remaining calculations .",
    "we now describe the unitary transformation of the two - body hamiltonian ( i.e. , eqn .",
    "( [ eq : h ] ) or ( [ eq : h - occ ] ) with @xmath159 ) that de - couples @xmath70 and its complement",
    ". this approach dates back as far as 1929 , when van vleck introduced such a generic unitary transformation to de - couple the model space to first order in the interaction @xcite .",
    "let @xmath72 be given by eqn .",
    "( [ eq : projector ] ) , and let @xmath160 .",
    "the idea is to find a unitary transformation @xmath161 of @xmath26 such that @xmath162 i.e. , @xmath163 is block diagonal .",
    "this implies that @xmath164 defined by @xmath165 has eigenvalues identical to @xmath166 of those of the _ full operator _ @xmath26 .",
    "since @xmath166 is finite , @xmath164 is called an effective hamiltonian .",
    "selecting @xmath167 is equivalent to selecting a set of effective eigenpairs @xmath168 , where @xmath169 is an eigenvalue of @xmath26 and @xmath170 are the effective eigenvectors ; an orthonormal basis for @xmath70 .",
    "it is clear that @xmath167 is not unique , since there are many ways to pick @xmath166 eigenvalues of @xmath26 , and for each such selection any unitary @xmath171 matrix would yield an eigenvector set .",
    "however , some choices are more natural than others , since the eigenvectors and eigenvalues are usually continuous functions of @xmath4 .",
    "we then select the @xmath166 eigenvalues @xmath172 that develop adiabatically from @xmath173 . for the corresponding effective eigenvectors",
    "@xmath174 , we choose the orthonormal set that minimizes the distance to the exact eigenvectors @xmath175 , i.e. , @xmath176 where the minimization is taken over orthonormal sets only .",
    "the effective eigenvectors also turn out to be continuous functions of @xmath4 , so @xmath164 will also be continuous .",
    "let @xmath177 is the @xmath171 matrix whose columns contain @xmath178 in the chosen basis , and let @xmath179 be the corresponding matrix containing @xmath180 . clearly , @xmath179 is unitary , while @xmath177 only approximately so .",
    "equation ( [ eq : minimize ] ) can then be written @xmath181 , \\label{eq : minimize2}\\ ] ] where the minimum is taken over all unitary matrices .",
    "if @xmath177 has singular value decomposition given by @xmath182 the solution @xmath179 is given by @xmath183 if @xmath184 is the diagonal matrix whose elements are the chosen eigenvalues , we have @xmath185 see ref .",
    "@xcite for a thorough discussion of the above prescription for @xmath164 .",
    "having computed the two - body @xmath164 , we define the effective interaction @xmath186 by @xmath187 which gives meaning _ solely _ in the model space . in second quantization ,",
    "@xmath188 and the @xmath0-body @xmath164 becomes ( cf .",
    "( [ eq : h ] ) ) @xmath189 with occupation number formalism form ( cf .",
    "( [ eq : h - occ ] ) ) @xmath190 now , @xmath164 is well - defined in the space of @xmath0-body slater determinants where no pairs of occupied orbitals constitute a two - body state outside the two - particle model space , since then the matrix element @xmath191 would be undefined .",
    "a little thought shows us that if @xmath186 was computed in a two - body energy cut space with parameter @xmath93 , @xmath164 is well - defined on the many - body model space with the same cut @xmath93 .",
    "the two - body problem is classically integrable , i.e. , there exists @xmath192 constants of motion @xmath193 , such that their quantum mechanical observables commute with @xmath26 and each other , viz , @xmath115 = [ \\omega_i,\\omega_j ] = 0 , \\quad \\text{for all } \\ ; i , j.\\ ] ] indeed , the centre - of - mass harmonic oscillator @xmath194 defined in eqn .",
    "( [ eq : com - separation ] ) below and the corresponding centre - of - mass angular momentum provides two constants , while total angular momentum @xmath75 provides a third .    using the model space @xmath70 defined by an energy cut , we have @xmath195 = 0\\ ] ] as well , which is equivalent @xcite to @xmath196 = 0 ,    \\label{eq : heff - commutator}\\ ] ] so that @xmath164 is integrable as well .",
    "in particular , @xmath186 is block - diagonal with respect to @xmath193 .    if we consider the commonly encountered model space @xmath197 defined by the slater determinant basis @xmath198 given by @xmath199 instead of eqn",
    "( [ eq : energy - cut ] ) , we will have @xmath200 \\neq 0,\\ ] ] as is easily verified .",
    "indeed , @xmath197 is not an invariant subspace of the centre - of - mass transformation @xmath201 defined in appendix [ sec : com ] .",
    "thus , @xmath202 \\neq 0 $ ] , so that the centre - of - mass energy no longer is a constant of motion !",
    "the symmetry - breaking of the effective hamiltonian in this case is problematic , since in the limit @xmath203 , the exact eigenfunctions that develop adiabatically are not all either in the model space or in the complement .",
    "the adiabatic continuation of the eigenpairs starting out in @xmath70 is thus not well - defined .",
    "we comment , that the model space @xmath197 is often used in both no - core shell model calculations and quantum dot calculations , but the effective interaction becomes , in fact , ill - behaved in this case .",
    "what remains for the effective interaction , is the computation of the exact eigenpairs @xmath204 .",
    "we must also solve the problem of following eigenpairs adiabatically from @xmath173 .",
    "for the two - body coulomb problem , analytical solutions are available only for very special values for @xmath4 @xcite .",
    "these are useless for our purpose , so we must use numerical methods .",
    "a direct application of the fci method using fock - darwin orbitals with a large @xmath205 will converge slowly , and there is no device in the method for following eigenvalues adiabatically .",
    "as the eigenvalues may cross , selecting , e.g. , the lowest eigenvalues will not work in general .",
    "for the two - body problem , the pauli principle leads to a symmetric spatial wave function for the singlet @xmath206 spin state , and an anti - symmetric wave function for the triplet @xmath207 spin states .",
    "for the spatial part , we exploit the integrability of the system as follows .",
    "define centre - of - mass coordinates by @xmath208 and @xmath209 using these coordinates , the two - body hamiltonian becomes @xmath210 \\notag    \\\\    & = : & h_\\text{c } + h_\\text{rel } \\label{eq : com - separation}\\end{aligned}\\ ] ] where @xmath211 .",
    "we have introduced the parameter @xmath4 explicitly in the potential in this equation .",
    "@xmath26 is clearly separable , and the centre - of - mass coordinate hamiltonian @xmath194 is a trivial harmonic oscillator , while the relative coordinate hamiltonian can be written as @xmath212 where in polar coordinates @xmath213 we have @xmath214 applying separation of variables again , the eigenfunctions of @xmath215 can be written @xmath216 where @xmath217 is the nodal quantum number .",
    "@xmath218 satisfies @xmath219 where @xmath220    equation ( [ eq : radial - eqn ] ) is an eigenvalue problem in the hilbert space @xmath221 , where the measure @xmath222 is induced by the polar coordinate transformation .",
    "although it is natural to try and solve the radial problem using fock - darwin orbitals , this will converge slowly .",
    "the solution to this problem is to use a radial basis of generalized half - range hermite functions @xcite . in appendix",
    "[ sec : radial - method ] this is laid out in some detail .",
    "equation  ( [ eq : radial - eqn ] ) is a one - dimensional equation , so there will be no degeneracy in the eigenvalues @xmath223 for fixed @xmath82 . in particular , the eigenvalues as function of the interaction strength @xmath4 will not cross , and will be continuous functions of @xmath4 .",
    "we thus have @xmath224 for all @xmath217 , where @xmath217 is the nodal quantum number .    at @xmath225",
    "we regain the harmonic oscillator eigenvalues @xmath226 .",
    "correspondingly , the eigenfunctions @xmath227 approaches the fock - darwin orbitals @xmath228 , i.e. , the harmonic oscillator eigenfunctions .",
    "for the radial part , @xmath229    reintroducing spin , the full eigenfunctions @xmath230 are on the form @xmath231 where @xmath206 for odd @xmath232 , and @xmath207 for even @xmath232 , and @xmath110 is an integer .",
    "let @xmath89 be the shell numbers for the centre - of - mass coordinate and relative coordinate , respectively .",
    "the eigenvalue @xmath233 is @xmath234 with limit @xmath235 which is the harmonic oscillator eigenvalue .    as the centre - of - mass coordinate transformation conserves harmonic oscillator energy , at @xmath225 ,",
    "the eigenfunctions that are in the model space are exactly those obeying @xmath236 . turning on the interaction adiabatically ,",
    "the eigenpairs we must choose for the effective hamiltonian at a given @xmath4 are exactly those with @xmath236 .",
    "the model - space projection @xmath237 needed in eqns .",
    "( [ eq : minimize ] ) and ( [ eq : minimize2 ] ) is now given by @xmath238\\chi_{s , s_z},\\ ] ] where @xmath239 where @xmath240 is the integer part of @xmath118 .",
    "this operator thus projects onto the @xmath241 first radial basis functions with given @xmath242 .",
    "due to eqn .",
    "( [ eq : heff - commutator ] ) , the unitary operator @xmath167 can be decomposed into its action on blocks defined by tuples of @xmath243 and @xmath232 @xcite .",
    "the minimization ( [ eq : minimize ] ) can then be applied on block - per - block basis as well .",
    "each sub - problem is equivalent to the calculation of an effective hamiltonian @xmath244 of the radial problem for a given @xmath232 and @xmath245 .    to this end , let @xmath245 and @xmath246 be given .",
    "let @xmath177 be the @xmath247 matrix whose elements are given by @xmath248 i.e. , the model space projections of the exact eigenvectors with the lowest eigenvalues .",
    "let @xmath249 be the singular value decomposition , and let @xmath250 .",
    "then , @xmath251 and @xmath252 is the @xmath253-block of the effective interaction . if we return to eqn .",
    "( [ eq : interaction - elems ] ) , the effective interaction matrix elements @xmath191 are now given by replacing the matrix elements @xmath254 by the matrix elements @xmath255 , where @xmath256 where @xmath0 , @xmath98 , @xmath257 and @xmath258 are defined immediately after eqn .",
    "( [ eq : interaction - elems ] ) .",
    "the main program is called qdot , and processes a textual configuration file with problem parameters before proceeding with the diagonalization of the hamiltonian . eventually , it writes the resulting data to a matlab / gnu octave compatible script for further processing .    as a c++ library as well as stand - alone application ,",
    "openfci is organized in several namespaces , which logically separate independent units .",
    "there are three main namespaces : ` manybody ` , ` gauss ` , and ` quantumdot ` . put simply , ` manybody ` provides generic tools for many - body calculations , such as occupation number formalism , slater determinants and csfs , while ` gauss ` provides tools for orthogonal polynomials and gaussian quadrature .",
    "these namespaces are independent of each other , and are in no way dependent on the particular quantum dot model . on the other hand , ` quantumdot ` synthesizes elements from the two former into a quantum dot fci library . in qdot , the main work is thus processing of the configuration file .",
    "two other namespaces are also defined , being ` simple_sparse ` and ` simple_dense ` , which are , respectively , simple implementations of sparse and dense matrices suitable for our needs .",
    "we will not go into details in the present article",
    ".    it should be clear that extending and customizing qdot is a relatively easy task .",
    "the application qdot is provided as a tool with a minimum of functionality , and the interested will almost certainly desire to further develop this small application .    in order to help with getting started on such tasks ,",
    "some stand - alone demonstration applications are provided , all based on the core classes and functions .",
    "these include an interaction matrix element tabulator tabulate , and a simple program pairing for studying the well - known pairing hamiltonian @xcite , which we will not discuss further here .",
    "finally , there is a small interactive console - based slater determinant demonstration program slater_demo as well .",
    "these applications will also serve as indicators of the flexibility of openfci .",
    "openfci does not yet support parallel computation on clusters of computers , using for example the message passing interface @xcite .",
    "future versions will almost certainly be parallelized , but the present version in fact competes with parallel implementations of the standard fci method with respect to convergence due to the effective interaction implemented , see sec .",
    "[ sec : results ] .",
    "the simple structure of openfci also allows users with less resources to compile and run the code .",
    "the ` manybody ` namespace currently contains four main classes : ` slater ` , ` csfmachine ` , ` nchoosekbitset ` , and ` matrixmachine ` . these will probably form the backbone of any manybody computation with openfci .",
    "the class ` slater ` provides slater determinants , creation and annihilation operators , and so on .",
    "it is based on the standard template library s ( stl ) ` bitset ` class , which provides generic bit set manipulations .",
    "the class ` nchoosekbitset ` provides means for generating sets of @xmath64 objects out of @xmath217 possible represented as bit - patterns , i.e. , bit patterns corresponding to slater determinants in the basis @xmath71 or @xmath198 .",
    "this results in a stl ` vector < slater > ` object , which represent slater determinant bases in openfci .",
    "the class ` csfmachine ` is a tool for converting a basis of slater determinants into a basis of configurational state functions .",
    "these are represented as ` vector < csf_block > ` objects , where ` csf_block ` is a ` struct ` containing a few csfs associated with the same set of slater determinants @xcite .",
    "a csf basis is again input for the class ` matrixmachine ` , which is a template class , and generates a sparse matrix @xmath259 of an operator @xmath38 , where @xmath72 projects onto the basis .",
    "it also handles bases of pure slater determinants as they are trivially dealt with in the csf framework .",
    "the template parameter to ` matrixmachine ` is a class that should provide the matrix elements @xmath260 , @xmath261 , etc , of the generic operator given by @xmath262 notice , that the indices are generic orbitals , and not assumed to be on the form @xmath263 as in eqn .",
    "( [ eq : h - occ ] ) .    currently , only one- , two- , and three - body operators are implemented .",
    "the reason is , that the matrix elements are _ not _ computed by directly applying the sum of creation- and annihilation operators to slater determinants , since this approach , however natural , is very inefficient .",
    "instead , we apply wick s theorem directly @xcite on the matrix elements known to be not identically zero .    in the ` gauss ` namespace , several functions are defined which computes sequences of orthogonal polynomials via recurrence relations and weights and abscissa for gaussian quadratures based on these .",
    "the latter is done using the golub - welsh algorithm , which only depends on being able to compute the coefficients of the recurrence relation @xcite .",
    "the most important functions are perhaps ` computelaguerrepolys ( ) ` and ` computegenhalfgausshermite ( ) ` , which computes a sequence of generalized laguerre polynomials evaluated at a given set of points and quadrature rules for generalized half - range hermite functions , respectively .",
    "finally , the ` quantumdot ` namespace defines classes and functions that combined define the quantum dot problem .",
    "the class ` radialpotential ` encapsulates potentials on the form ( [ eq : pot1 ] ) .",
    "it also computes effective interaction blocks @xmath264 . the class ` qdothilbertspace ` provides means for generating the bases @xmath71 and @xmath198 , utilizing conservation of angular momentum , using a fast , custom made algorithm independent of ` nchoosekbitset ` .",
    "the class ` qdotfci ` sews everything together and is basically a complete solver for the fci method with effective interactions .      ]    a basic configuration file for qdot is shown in fig .",
    "[ fig : config ] . varying the parameters ` lambda ` , ` r ` , ` s ` and the number of particles ` a ` , the number of particles , i.e. , the atomic number .",
    "the choice of the variable name was chosen also partly because @xmath0 is used frequently for other purposes in the code . ] and running qdot each time , we produce a table of ground state energies , shown in table [ tab : results ] . by changing the parameter ` use_veff ` we turn on and off the effective interaction .",
    "the corresponding effective interaction ground states are also shown in the table .",
    "notice , that with the effective interaction we obtain the same precision as the bare interaction , but with much smaller model spaces .",
    "this indicates that openfci can produce results that in fact compete with parallel implementations of the standard fci method , even in its present serial form .",
    "d|d|d|d|d & & + & & & & + 6 & 9.02370 & 8.96523 & 13.98824 & 13.88832 + 10 & 8.97698 & 8.95555 & 13.86113 & 13.83280 + 14 & 8.96800 & 8.95465 & 13.84491 & 13.82848 + 18 & 8.96411 & 8.95444 & 13.83923 & 13.82761 + 22 & 8.96191 & 8.95435 & 13.83626 & 13.82730 + 26 & 8.96049 & 8.95430 & & + 30 & 8.95950 & 8.95428 & &    in table  [ tab : compare ] we compare the ground state energies reported in ref .",
    "@xcite with the alternative model space @xmath197 to the corresponding values produced by qdot , also using @xmath197 .",
    "this table also appears in ref .",
    "@xcite , and serves as a check of the validity of the calculations .",
    "c|ccc|dd|dd|dd & & & & & & + @xmath0 & @xmath4 & @xmath98 & @xmath265 & & & & & & + 2 & 1 & 0 & 0 & 3.013626 & & 3.011020 & & 3.009236 & + & 2 & 0 & 0 & 3.733598 & 3.7338 & 3.731057 & 3.7312 & 3.729324 & 3.7295 + & & 1 & 2 & 4.143592 & 4.1437 & 4.142946 & 4.1431 & 4.142581 & 4.1427 + 3 & 2 & 1 & 1 & 8.175035 & 8.1755 & 8.169913 & & 8.166708 & 8.1671 + & 4 & 1 & 1 & 11.04480 & 11.046 & 11.04338 & & 11.04254 & 11.043 + & & 0 & 3 & 11.05428 & 11.055 & 11.05325 & & 11.05262 & 11.053 + 4 & 6 & 0 & 0 & 23.68944 & 23.691 & 23.65559 & & 23.64832 & 23.650",
    "+ & & 2 & 4 & 23.86769 & 23.870 & 23.80796 & & 23.80373 & 23.805 + 5 & 2 & 0 & 5 & 21.15093 & 21.15 & 21.13414 & 21.13 & 21.12992 & 21.13 + & 4 & 0 & 5 & 29.43528 & 29.44 & 29.30898 & 29.31 & 29.30251 & 29.30 +    by uncommenting the lines following the definition of ` lambda ` , we override the default coulomb interaction , and produce a configuration file for the analytically solvable model given by johnson and payne @xcite , where the coulomb interaction is replaced by the parabolic interaction @xmath266 if @xmath4 is sufficiently small , all the eigenvalues of this model are on the form @xmath267 since the potential is smooth , the eigenfunctions are all smooth , implying exponential convergence with respect to @xmath93 @xcite .",
    "we therefore expect very accurate eigenvalues even with moderate @xmath93 . in table",
    "[ tab : results - johnson ] we show the first eigenvalues along with the error computed for @xmath268 electrons with @xmath269 .",
    "the computations are done in the @xmath270 model space with @xmath271 and @xmath272 .",
    "some duplicates exist , and they are included for illustration purposes .",
    "it is evident , that the eigenvalues become very accurate with increasing @xmath93 ; a clear indication of the correctness of the implementation .",
    ".results from diagonalizing the johnson and payne model .",
    "many digits are included due to comparison with exact results and high precision[tab : results - johnson ] [ cols=\"^,^,^,^ \" , ]",
    "we have presented openfci , an open source full configuration interaction implementation for quantum dots and similar systems .",
    "openfci also implements a renormalized effective interaction widely used in nuclear no - core shell model calculations , and we demonstrated that such interactions are indeed useful in the quantum dot calculations as well .",
    "openfci is easy to extend and adapt .",
    "possible applications are computations on systems with more general symmetry - breaking geometries and in @xmath273 spatial dimensions .",
    "also , a generalization of the csf part of the code to handle isobaric spin would allow us to handle nuclear systems .",
    "there is one more symmetry of the hamiltonian @xmath26 that can be exploited , namely that of conservation of centre - of - mass motion , which would further reduce the block sizes of the matrices .",
    "we exploited this symmetry for the effective interaction , but it is a fact that it is a symmetry for the full hamiltonian as well . using the energy cut model space @xmath70 we may take care of this symmetry in a way similar to the csf treatment @xcite .",
    "as mentioned , we have not parallelized the code at the time of writing , but it is not difficult to do so .",
    "a future version will almost certainly provide parallelized executables , for example using the message passing interface @xcite .",
    "in this appendix , we derive the centre - of - mass ( com ) transformation utilized in eqn .",
    "( [ eq : interaction - elems ] ) for the interaction matrix elements @xmath46 .",
    "the one - dimensional harmonic oscillator ( ho ) hamiltonian @xmath274 is easily diagonalized to yield eigenfunctions on the form @xmath275 where @xmath276 is the raising operator in the @xmath118-coordinate , and where @xmath277 . the eigenvalues are @xmath278 .    using separation of variables , the two - dimensional ho @xmath50 in @xmath279 and @xmath280",
    "is found to have eigenfunctions on the form @xmath281 and eigenvalues @xmath282 .",
    "define the raising operators @xmath283 , so that @xmath284 where the non - degenerate ground state is given by @xmath285 note that this can equally well describe two ( distinguishable and spinless ) particles in one dimension .    to this end , we introduce normalized com frame coordinates by @xmath286 the matrix @xmath287 is symmetric and orthogonal , i.e. , @xmath288 , transforming a set of cartesian coordinates into another .",
    "the operator @xmath50 is invariant under this transformation , so the eigenfunctions have the same form with respect to these coordinates , viz , @xmath289 where @xmath290 are the raising operators with respect to the com coordinates , and @xmath291 are the corresponding momentum components .",
    "define the operator @xmath201 by @xmath292 so that @xmath293 since @xmath201 maps eigenfunctions in the two frames onto each other , @xmath201 must be a unitary operator , and the invariance of @xmath50 under the coordinate transformation is the same as @xmath294=0 $ ] , i.e. , that energy is conserved .",
    "this in turn means that @xmath201 is block diagonal with respect to each shell @xmath295 , viz , @xmath296 where @xmath297 is the @xmath298 transformation matrix within shell @xmath93 .",
    "it is real , symmetric , and orthogonal .",
    "numerically , the matrix elements are conveniently computed using two - dimensional gauss - hermite quadrature of sufficiently high order , producing exact matrix elements .    in a two - dimensional setting ,",
    "the two - particle harmonic oscillator becomes a @xmath299-dimensional oscillator .",
    "let @xmath300 , @xmath301 , be the particles coordinates , and let @xmath302 and @xmath303 to compress the notation a little .",
    "an eigenfunction is now on the form @xmath304 where @xmath305 .",
    "the com coordinate transformation now acts in the @xmath118 and @xmath306 directions separately , viz , @xmath287 acts on @xmath55 and @xmath307 to yield the com coordinates @xmath308 and @xmath309 : @xmath310^t = f [ x_1,x_2]^t$ ] and @xmath311^t = f [ y_1,y_2]^t$ ] .",
    "the induced operator @xmath201 again conserves energy .",
    "let @xmath312 and @xmath313 .",
    "it is readily verifiable that the com frame transformation becomes @xmath314 note that the shell number is @xmath315 , which is conserved by @xmath201 .",
    "consider a fock - darwin orbital @xmath316 in shell @xmath317 with energy @xmath318 .",
    "it is straightforward but somewhat tedious to show that these can be written in terms of co - called circular raising operators @xmath319 and @xmath320 @xcite defined by @xmath321 letting @xmath322 and @xmath323 ( which gives @xmath324 ) one obtains @xmath325 which should be compared with eqn .",
    "( [ eq : two - dim - hermite ] ) .",
    "moreover , @xmath326 and @xmath327 , giving energy and angular momentum , respectively .",
    "we comment that this is the reason for the non - standard factor @xmath79 in the normalization of the fock - darwin orbitals in eqn .",
    "( [ eq : fock - darwin - def ] ) .",
    "let a two - particle ho state be given by @xmath328 where @xmath329 and @xmath330 , and where @xmath331 .",
    "we will now prove that , in fact , when applying the centre - of - mass transformation to eqn .",
    "( [ eq : fock - darwin-2 ] ) , we obtain an expression on the same form as eqn .",
    "( [ eqn : complete - com ] ) viz , @xmath332 where @xmath333 and @xmath334 .    to this end",
    ", we return to the raising operators @xmath335 and @xmath336 , and express them in terms of @xmath337 and @xmath338 . by using eqn .",
    "( [ eq : com - coords ] ) , we obtain @xmath339 and similarly for @xmath336 in terms of @xmath338 . in terms of the raising operators ,",
    "the com transformation becomes @xmath340 where @xmath341 and we have used eqn .",
    "( [ eq : with - ladders ] ) , but in the analogous com case . expanding the powers using the binomial formula ( and the fact that the raising operators commute ) , we obtain a linear combination of the individual eigenfunctions , which must be identical to eqn .",
    "( [ eqn : complete - com ] ) .",
    "let the com circular ladder operators be defined by @xmath342 using eqn .",
    "( [ eq : com - ladder - trafo ] ) , we obtain that the circular raising operators transform _ in the same way _ as the cartesian operators when going to the com frame , i.e. , @xmath343 and similarly for @xmath344 and terms of @xmath345 . using eqn .",
    "( [ eq : fock - darwin-2 ] ) in the com case , we obtain @xmath346 with @xmath347 eqn .",
    "( [ eq : com - raising2 ] ) is on the same form as eqn .",
    "( [ eq : com - raising ] ) . again , by expanding the powers using the binomial formula ( and that the raising operators commute ) , we obtain a linear combination with coefficients identical to those of the expansion of eqn .",
    "( [ eq : com - raising ] ) .",
    "it then follows that eqn .",
    "( [ eqn : complete - com - circ ] ) holds .",
    "we now briefly discuss the numerical method used for solving the radial problem ( [ eq : radial - eqn ] ) , i.e. , the eigenvalue problem for the operator @xmath348 defined in eqn .",
    "( [ eq : radial - ham ] ) .",
    "this is an eigenproblem in the hilbert space @xmath221 , where the measure @xmath349 is induced by the polar coordinate transformation . the inner product on this space is thus given by @xmath350 let the fock - darwin orbitals be given by @xmath351 with radial part @xmath352 thus , @xmath353 and these functions form an orthonormal sequence in @xmath354 for fixed @xmath242 .",
    "in the electronic case , @xmath355 has a singularity at @xmath356 which gives rise to a cusp in the eigenfunction @xmath357 at @xmath356 , or in one of its derivatives .",
    "away from @xmath356 , the eigenfunction is smooth .",
    "these considerations are also true for more general potentials smooth for @xmath358 .    diagonalizing the matrix of @xmath359 with respect to the truncated basis @xmath360 will give eigenpairs converging slowly with respect to increasing @xmath245 due to the non - smoothness of @xmath218 at @xmath356 .",
    "this is easily seen for the @xmath361 case and @xmath362 , which has the exact ground state @xmath363 a polynomial of odd degree multiplied by a gaussian .",
    "the cusp at @xmath356 is evident .",
    "however , @xmath364 which are all _ even _ polynomials .",
    "it is clear , that @xmath245 must be large to resolve the cusp of @xmath365 .",
    "the eigenproblem is best solved using a basis of generalized half - range hermite functions @xmath366 @xcite , which will resolve the cusp nicely .",
    "these functions are defined by @xmath367 where @xmath368 are the orthonormal polynomials defined by gram - schmidt orthogonalization of the monomials @xmath369 with respect to the weight function @xmath370 .",
    "thus , @xmath371 the fundamental difference between @xmath366 and @xmath372 is that the latter contains _ only _ even ( odd ) powers of @xmath373 for even ( odd ) @xmath242 . both sets constitute orthonormal bases , but @xmath366 will in general have better approximation properties .",
    "moreover , since @xmath374 , @xmath375 gives the fock - darwin orbitals as a _ finite _ linear combination of the generalized half - range hermite functions , while the converse is not possible .",
    "computing the matrix of @xmath359 with respect to @xmath376 and diagonalizing will give eigenpairs converging exponentially fast with respect to increasing @xmath377 .",
    "the resulting eigenfunctions expansion in @xmath378 are readily computed using eqn .",
    "( [ eq : an - expansion ] ) , whose coefficients @xmath379 can be computed numerically exactly using gaussian quadrature induced by @xmath380 , for @xmath381 sufficiently large .",
    "the basis size @xmath377 to use in the diagonalization depends on how many eigenfunctions @xmath245 we desire .",
    "we adjust @xmath377 semi - empirically , noting that @xmath382 is sufficient to resolve @xmath383 , and assuming that the exact eigenfunctions are dominated by the latter .",
    "we then add a fixed number @xmath384 to get @xmath385 , and numerical experiments confirm that this produces eigenvalues that indeed have converged within desired precision .",
    "the author wishes to thank prof .",
    "m.  hjorth - jensen ( cma ) for helpful discussions , suggestions and feedback .",
    "this work was financed by cma through the norwegian research council ."
  ],
  "abstract_text": [
    "<S> we describe openfci , an open source implementation of the full configuration - interaction method ( fci ) for two - dimensional quantum dots with optional use of effective renormalized interactions . </S>",
    "<S> the code is written in c++ and is available under the gnu general public license . </S>",
    "<S> the code and core libraries are well documented and structured in a way such that customizations and generalizations to other systems and numerical methods are easy tasks . as examples we provide a matrix element tabulation program and an implementation of a simple model from nuclear physics , in addition to the quantum dot application itself . </S>"
  ]
}