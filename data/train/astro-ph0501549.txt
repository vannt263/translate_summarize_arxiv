{
  "article_text": [
    "as bondi showed in his historical paper @xcite the occurrence of shocks in accretion phenomena on compact stellar objects is quite common .",
    "since the radial speed can become supersonic the halting of the flow at a rigid wall leads necessarily to shock formation .",
    "nevertheless the possibility of radial shock formation around black holes is less obvious since this compact object has no rigid wall .",
    "it is true that pre - heating of the infalling gas by radiation from below or other non adiabatic processes can influence the properties of the falling gas and allow shock solutions even in the spherically symmetric regime @xcite .",
    "however , if the gas is falling with some rotation , the centrifugal force can act as a `` wall '' and therefore trigger the shock formation even in the simple case of ideal gas .",
    "this fact was indeed suggested by the excellent pioneer general relativistic simulations of hawley , smarr and wilson @xcite .",
    "the question of the stability of the shock is critically related to the initial angular momentum of the gas , since for large values a standard keplerian disk will be formed , while for low values favorable conditions for standing shocks will occur .    that such shocks can effectively stay at a fixed position has been put forward by s. chakrabarti @xcite , see also @xcite .",
    "it has been successively confirmed by the analytical work of nakayama @xcite and by numerical simulation experiments by chakrabarti and molteni @xcite and following papers .",
    "the stability of the shock location is very relevant since , if it is stable , then the shock `` engine '' is always acting : it is not a transient phenomenon . further studies , based on numerical simulations in 2d , axis symmetric configurations , revealed different kinds of oscillating behavior over the basic stable regime , see the results in @xcite , @xcite , @xcite .",
    "recently the shock scenario has been shown to be very promising also to explain quasi periodic oscillation processes ( qpo ) occurring in bh candidates @xcite .",
    "since all previous studies have been performed in 2d configurations ( axial symmetric or in the z=0 plane ) , it is natural to investigate the stability of the shocks in full 3d cases .",
    "furthermore we add that this physical problem can be also considered a very critical test in the field of computational fluid dynamics .",
    "the work proceeds as follows : in section 2 we resume the basic physics leading to shock formation and derive a simple formula to obtain the physical parameters necessary to generate the shocks , in section 3 we revise the numerical method and show how a test of any numerical code can be set up and in section 4 we show and discuss the new 3d simulation results .",
    "let us resume the very basic physical ingredients of the phenomenon . we suppose that an unviscous gas is falling from very large distance onto a black hole .",
    "we will adopt the paczyski & wiita potential @xcite to mimic the schwarzschild black hole force .",
    "it is given by : @xmath0 where @xmath1 is the schwarzschild radius .",
    "the basic physical effect can be easily understood in terms of `` classical '' physics and it is well known that the paczyski & wiita force reproduces many relativistic effects with high accuracy .    to obtain the steady state solution we might integrate the differential equations for mass , momentum and energy conservations . in this case one",
    "has to start the space integration from the sonic point as explained in the work by chakrabarti @xcite .",
    "however , in the case of unviscous flow , it is easy to find an algebraic implicit solution , since the total energy is conserved ( the bernoulli theorem ) and it can be fairly exploited to close the system of equations and find the solutions .",
    "let us treat first the 1d case .",
    "this derivation already appeared in the appendix of @xcite .",
    "we repeat here the derivation pointing also to a peculiar aspect of the solution especially relevant to test code accuracy . by 1d",
    "we mean that we are in an axially symmetric situation and the disk has no vertical extension ( @xmath2 , @xmath3 ) .",
    "note that the solution is obviously valid _ also _ in 2d dimensions with @xmath3 ( i.e. in the plane xy ) if the symmetric condition is maintained . both in the case of 1d simulations in cylindrical coordinates and in 2d simulations ( but with z=0 ) the difference between the theoretical shock position and the one resulting from simulations depends only on the numerical quality of the code ; indeed there is no physical cause intervening to modify the results .",
    "instead , in the 2d or 3d cases ( with real vertical extension of the flow ) , the theoretical procedure to derive the shock position needs the assumption of vertical equilibrium , that , as we will see , is not always satisfied .",
    "we assume also that the accreting gas is ideal ( no viscosity and no cooling process is occurring )",
    ". the angular momentum per unit mass of the flow , @xmath4 , must be conserved . in steady state regime",
    "we have also conservation of mass given by the equation :    @xmath5    here @xmath6 is the surface density . in a conservative body force field with a potential @xmath7 , also the pressure plays the role of a potential and we have    @xmath8    here @xmath9 is the adiabatic gas constant , @xmath10 is the bernoulli constant ( the thermal energy at infinity ) , @xmath11 is the sound speed @xmath12 @xmath13 is the internal energy per unit mass , @xmath14 is the speed of the flow and @xmath15 is the angular momentum , so that @xmath16 .",
    "if the entropy is conserved ( no viscosity , no cooling , the presence of the shock will be taken into account few lines below ) the polytropic relations are valid , @xmath17 , so the relation between the density and sound speed @xmath18 , where @xmath19 , is also valid .",
    "we have three unknown quantities @xmath6 , @xmath20 , @xmath11 , and three equations .",
    "the solutions are functions of @xmath21 with angular momentum and bernoulli constant as parameters determining the specific shape of the solution .",
    "using the radial mach number @xmath22 , resolving @xmath11 from the bernoulli relation , and putting all terms in the continuity equation , we have the following implicit solution for the mach number : @xmath23 where @xmath24 is function only of the mach number:@xmath25^ { \\frac{\\gamma + 1}{2\\left ( \\gamma -1\\right ) } } } \\ ] ] and @xmath26 is function only of @xmath21 ( b and @xmath4 are parameters ) : @xmath27^ { \\frac{\\gamma + 1}{2\\left ( \\gamma -1\\right ) } } \\ ] ] where @xmath28 is the effective body force potential ( gravitational plus centrifugal ) .    for a given @xmath29",
    "this equation can be easily solved .",
    "the @xmath30 function has a single maximum at @xmath31 , and it can be inverted both in the subsonic @xmath32 and supersonic @xmath33 regions .",
    "the @xmath26 function has in general two local minima at @xmath34 and @xmath35 with @xmath36 , which can be determined by solving the algebraic equation @xmath37 numerically ( high @xmath4 values increase the centrifugal barrier and produce minima close to the bh ) .    at large distances from the bh ,",
    "the mach number is @xmath38 , while close to the horizon it is @xmath39 .",
    "since the @xmath40 product must be constant along the flow , the maximum of @xmath30 must be at one of the minima of @xmath41 , i.e. at @xmath34 or @xmath35 .",
    "therefore we can have two isentropic solutions @xmath42 and @xmath43 @xmath44\\ ] ]    a standing shock can occur in the solution at @xmath45 if the values @xmath46 and @xmath47 are related by the hugoniot relation @xmath48    where the hugoniot relation for an hypothetical shock at a generic radius is given by    @xmath49^{1/2}\\ ] ]    in general there can be two possible shock positions , but only the outer one is stable as shown by the numerical simulations of chakrabarti and molteni @xcite and by the analytical work of nakayama @xcite .",
    "figure 1 clarifies the procedure for a generic case .",
    "the supersonic line corresponds to the @xmath42 solution while @xmath43 corresponds to the subsonic branch .",
    "[ ansol ]      let us note that the solution depends on the a function that contains the term :    @xmath50    so , if we give to the flow an angular momentum lower than the theoretical one , but we add an equivalent centrifugal force , the resulting solution does not change .",
    "for example , we can obtain the same shock location if we give _ no real rotation _ to the flow and add to the gravitational force a fictitious force derived from the centrifugal potential @xmath51 , or viceversa , we can inject matter with an extremely fast real rotation , ( even super keplerian ! ) and , at the same time , add a centripetal force .    in this way , playing with real rotation and fictious centrifugal forces",
    "we can obtain a variety of solutions with the _ same _ radial shock position , _ same _ radial mach number , _ same _ density profile .",
    "the important point is that the algebraic sum of real and fictious forces must be equal to the force required by the theory .",
    "it means that one of the following equations must be satisfied , according to the case @xmath52    where @xmath53 is the angular momentum value required by the theory to produce a shock at some specified radius . for consistency ,",
    "if we define the real rotation as a fractio @xmath24 of the theoretical one , i.e. @xmath54 , then the fictious force to be added is given by : @xmath55    it is clear that in the fast rotational cases the real shear motion can modify the results due to the numerical viscosity and other numerical code properties : accuracy , conservative structure , etc ...    we suggest the possibility to quantify the quality , @xmath56 , of a code as the ratio of the true rotation angular momentum to the theoretical one for which the shock is stable and close to the theoretical position : @xmath57    the obvious minimum requirement is that a code has q=1 so that , for no rotation , it produces the shock at the correct position .",
    "for the 2d case ( with real z extension of the disk ) the procedure is similar .",
    "we maintain the hypothesis of axial symmetry .",
    "we assume that the gas falls down in a condition of vertical equilibrium . using the same variable names , the mass conservation equation is given by : @xmath58 where h is the half thickness of the disk .",
    "the vertical equilibrium hypothesis gives the well known expression for the half disk thickness : @xmath59    the energy equation is still given by : @xmath60    so again we have three unknown quantities @xmath6 , @xmath20 , @xmath11 , and three equations and we may find the solution exactly in the same way of the 1d case .",
    "the difference will be in the exact values of the mach function and of the geometrical function , @xmath61 ) , but the shape are very similar : two minima in the geometrical function and one maximum in the mach function .",
    "the mach function is now given by : @xmath62 ^ { \\frac{\\gamma   } { \\left ( \\gamma -1\\right ) } } } \\ ] ] and the new @xmath26 is function only of @xmath21 ( b and @xmath4 are parameters ) : @xmath63^ { \\frac{\\gamma}{\\left ( \\gamma -1\\right ) } } \\ ] ] where as previously stated @xmath28 is the effective body force potential ( gravitational plus centrifugal ) .",
    "we performed 2d and 3d time dependent simulations of the motion of an ideal gas around a schwarzschild black hole .",
    "the equations we integrate are in the lagrangian formulation ( @xmath64 is the comoving derivative ) : +    the continuity equation @xmath65    the momentum equation @xmath66    the energy equation @xmath67    the equation of state @xmath68 applying the sph formalism ( see @xcite ) , these are transformed into a set of ordinary differential equations ( odes ) .",
    "these odes are subsequently integrated numerically using standard methods .",
    "we use the usual summation form for the continuity equation : @xmath69 the momentum equation is given by : @xmath70 the energy equation is : @xmath71 where @xmath72 is the standard form of the artificial viscosity .      here",
    "we show the results of 3d time dependent simulations and add also the results of 2d ( z=0 ) simulations to clarify the item of the code accuracy testing .",
    "we focus our attention to a limited set of parameters which predicts a shock position close to the minimum radius allowed ( around @xmath73 ) @xcite .",
    "therefore we are presenting the results concerning two critical cases .",
    "however we verified that also for other parameter values the shocks are formed and are stable , in good agreement with the predicted theoretical position .",
    "the physical parameters of the cases we discuss here are given in table 1 and they are well inside the stability region analyzed by @xcite .",
    "the variables appearing in the table 1 have the following meaning : @xmath74 is the inflow radius , v@xmath75 and a@xmath76 are the radial speed and sound speed at inflow radius , @xmath10 is the bernoulli constant , @xmath4 is the angular momentum per unit mass , h is the vertical disk thickness at the inflow radius , r@xmath77 is the predicted shock position , @xmath24 is the fractio of the real rotation of the gas .    the spatial domain ( in cylindrical coordinates )",
    "is given by @xmath78 , @xmath79 , @xmath80 .",
    "the results have been obtained with a constant value of the spatial resolution @xmath81 .",
    "this choice gives better results than those ones obtained with variable @xmath81 ; we think that the space varying @xmath81 option has a larger amount of numerical viscosity due to the strong jump of @xmath81 at the shock location . for 3d",
    "runs we used @xmath82 and @xmath83 .",
    "+ the gas particles are injected ( with the physical properties given in table 1 ) from a set of injection points equally spaced onto the surface of a cylinder of radius @xmath84 and height h , which is calculated from the vertical equilibrium assumption . a new particle is injected every time a sphere of radius @xmath85 around each injector is found to be empty .      since our problem does nt contain self gravitation , we used a spatial domain decomposition to parallelize the sph code .",
    "we show here that this approach is very convenient for the kind of problem we are studying .",
    "our parallel system consists of a biprocessor workstations cluster .",
    "as our processors pool has local memory , we use the well known standard : `` _ _ message passing interface _ _ '' ( mpi ) to exchange data .",
    "our physical problem ( accretion disks around central star ) has a space domain with some degree of central symmetry , so it seems logical to divide the overall domain into sub domains having this type of symmetry .",
    "the parallelization paradigm we use is the multiple instruction multiple data one ( mimd ) . with this decomposition and paradigms , the code performing the calculations for one sub domain",
    "is the standard serial code used for one single domain , with minor modifications .",
    "information exchanges occur always between two consecutive domains .",
    "the three dimensional computational domain is decomposed into concentrically cylindrical coronae ( sub domains ) with centers coincident with the coordinate origin .",
    "figure 2 shows an horizontal cut view , in a case in which the domain is decomposed into four sub domains .",
    "all the sph particles , having vector radius projection ( in xy plane ) lying between two consecutive cylinders , are assigned to the same sub domain .",
    "the number of sub domains is equal or multiple of the number of processors in the cluster .",
    "as the sph particles have a short - range interaction , only the particles lying within a distance @xmath86 from the limiting cylinders interact with their analogue particles laying in the previous cylinder or in the next one .    in any moment",
    "each processor manages @xmath87 internal particles plus @xmath88 edge particles from the inner edge region and @xmath89 edge particles from the outer edge region .",
    "[ subdom ]    in each iteration loop the @xmath87 particle of a sub domain are evolved taking into account the presence of the all @xmath90 particles ( for density , pressure forces etc .",
    "calculation ) .",
    "instead the @xmath90 particles are evolved according to the kinematic and dynamic properties they had as internal particles of their original domain . at the end of the time step and before to start the next one a check is performed to verify if some internal particle has migrated into another domain . in this case",
    "the particles data are exchanged .",
    "we show the basic results of the simulations using one panel for each case . in each panel",
    "we have 4 figures : the figure top - left shows the number of particles versus time ; the figure top - right shows the radial mach number of all the particles folded , in @xmath91 , around the z axis ; the figure bottom - left shows the radial speed ; the figure bottom - right shows the distribution of the angular momentum of the particles , the scattering of the values is just due to the conservation of the total angular momentum ."
  ],
  "abstract_text": [
    "<S> we present the simulation of 3d time dependent flow of rotating ideal gas falling into a schwarzschild black hole . </S>",
    "<S> it is shown that also in the 3d case steady shocks are formed in a wide range of parameters ( initial angular momentum and thermal energy ) . </S>",
    "<S> we therefore highlight the stability of the phenomenon of shock formation in sub keplerian flows onto black holes , and reenforce the role of the shocks in the high luminosity emission from black hole candidates . </S>",
    "<S> the simulations have been performed using a parallelized code based on the smoothed particles hydrodynamics method ( sph ) . </S>",
    "<S> we also discuss some properties of the shock problem that allow its use as a quantitative test of the accuracy of the used numerical method . </S>",
    "<S> this shows that the accuracy of sph is acceptable although not excellent .    </S>",
    "<S> [ firstpage ]    accretion , accretion disks  black hole physics hydrodynamics  instabilities </S>"
  ]
}