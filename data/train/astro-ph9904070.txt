{
  "article_text": [
    "modeling ultra - relativistic fluid flows is a great challenge for any relativistic hydro code .",
    "numerical difficulties arise from strong relativistic shocks and from narrow physical structures ( norman & winkler 1986 ) . typical examples in astrophysics for such extreme conditions are proto - stellar jets and blast waves of supernovae explosions . in recent years , the development of numerical algorithms for relativistic fluid dynamics went mainly along two different lines .",
    "first , there are the so called high resolution shock capturing ( hrsc ) methods , which allow to obtain numerically discontinuous solutions of the relativistic hydrodynamic equations by solving local riemann problems between adjacent numerical cells .",
    "some recently developed hrsc techniques are those of font et al .",
    "( 1994 ) , falle & komissarov ( 1996 ) , romero et al .",
    "( 1996 ) , banyuls et al .",
    "( 1997 ) , wen , panaitescu , & laguna ( 1997 ) , pons et al .",
    "( 1998 ) , and komissarov ( 1999 ) . however , employing analytic solutions of the riemann shock tube problem , it is not surprising that these hrsc codes produce almost exact numerical solutions of flow structures including discontinuities . in the second type of algorithms , shocks are treated numerically not as fluid discontinuities , but are rather spread over some small length with the help of an artificial viscosity .",
    "these algorithms either solve the dynamical equations of relativistic hydrodynamics on an eulerian grid such as the finite difference schemes of hawley , smarr , & wilson ( 1984b ) and norman & winkler ( 1986 ) or by using computational nodes following the fluid motion such as the lagrangian smoothed particle hydrodynamics ( sph ) methods of kheyfets , miller , & zurek ( 1990 ) and laguna , miller , & zurek ( 1993 ) .",
    "all the latter methods seem to be limited even for mildly relativistic flows containing shocks .",
    "norman & winkler ( 1986 ) suggest that the appearance of numerical inaccuracies and instabilities is due to the time derivative of the relativistic @xmath0-factor in the energy equation of these numerical schemes .",
    "this additional time derivative of a hydrodynamic variable renders the system of evolution equations non - conservative . for non - relativistic hydrodynamics , it is well - known that a numerical method based on non - conservative equations can produce a solution which looks reasonable but is entirely wrong if shocks or other discontinuities are involved ( see leveque 1997 for a corresponding analysis of burger s equation ) .    the main intention of this paper is to present a conservation formulation of the relativistic hydrodynamic equations that is designed for numerical methods .",
    "this particular formulation allows hydro codes to resolve ultra - relativistic shocks numerically with relativistic @xmath0-factors of even @xmath1 by means of an artificial viscosity rather than using a riemann solver .",
    "the conservation form of the relativistic equations is obtained by choosing suitable lagrangian variables .",
    "unfortunately , these lagrangian dynamical variables can be expressed in terms of the generic fluid variables rest - mass density , 3-velocity , and thermodynamic pressure only through a set of nonlinear algebraic equations .",
    "however , we show that these equations can be solved analytically in a unique way .",
    "for numerical work we discretize our set of partial differential equations by the smoothed particle hydrodynamics ( sph ) method introduced by lucy ( 1977 ) and gingold & monaghan ( 1977 ) . in recent years , sph became a popular computational tool for numerically modeling complex three - dimensional fluid flows in astrophysics .",
    "this is primarily due to its computational simplicity and the absence of a computational grid .",
    "furthermore , sph is adaptive in the sense that its computational nodes follow the fluid .",
    "sph has been already applied to relativistic fluid flows .",
    "kheyfets et al .",
    "( 1990 ) developed a relativistically covariant version of the sph technique by modeling the contact interactions with spatial smoothing functions in the local comoving frame of the fluid .",
    "laguna et al .",
    "( 1993 ) applied the sph method to the so called adm formalism of general relativity due to arnowitt , deser , & misner ( 1962 ) . in their relativistic sph formulation",
    "they modified the flat space kernels of the newtonian sph method which can become anisotropic and are then no longer invariant under translations which leads to additional terms in the sph equations .",
    "in contrast to these methods , we have developed a fully three - dimensional general relativistic sph code on the basis of our set of lagrangian conservation equations .",
    "this code employs the standard sph approach as used in newtonian theory with spherically symmetric kernels for all particles .",
    "our code is restricted to ideal fluids with artificial viscosity using the ideal - gas equation of state .",
    "the influence of the fluid on the spacetime metric is neglected , therefore , we consider only a background spacetime with a given but otherwise arbitrary metric .",
    "in addition , we neglect the fluid s self - gravity and do not account for radiation or electromagnetic effects .",
    "the layout of this paper is as follows . in section [ hydroeq ]",
    "we derive the formulation of the relativistic hydrodynamic equations in lagrangian conservative form and present the equations for calculating the generic fluid properties rest - mass density , 3-velocity , and thermodynamic pressure from our suitably chosen lagrangian variables .",
    "section [ spheq ] gives a review of the standard sph method that we use , including a prescription of its application to relativistic fluid flows in curved spacetimes and the implementation of an artificial viscosity .",
    "numerical test calculations of one - dimensional ultra - relativistic flows with discontinuities are presented in section [ codetests ] . throughout this paper",
    "we set the speed of light @xmath2 and the boltzmann s constant @xmath3 to unity , i.e. , @xmath4 .",
    "latin indices @xmath5 run from @xmath6 to @xmath7 , greek indices @xmath8 from @xmath9 to @xmath7 ; the signature of the metric is @xmath10 .",
    "our starting point is the covariant formulation of the equations of relativistic hydrodynamics for a perfect fluid with artificial viscosity : the local conservation of baryon number @xmath11 and the local conservation of energy - momentum @xmath12 with the stress - energy tensor of a perfect fluid @xmath13 the semicolon denotes the covariant derivative and the einstein summation convention is used . here",
    ", @xmath14 is the rest - mass density , @xmath15 the 4-velocity of the fluid , @xmath16 the isotropic thermodynamic pressure , @xmath17 the relativistic specific enthalpy with specific internal energy @xmath18 , @xmath19 the artificial viscous pressure , and @xmath20 the spacetime metric .",
    "all thermodynamic quantities in the stress - energy tensor ( [ stressenergy ] ) are measured in the local rest frame of the fluid . the artificial viscous pressure @xmath19 , which appears in equation ( [ stressenergy ] ) ,",
    "can be introduced into the stress - energy tensor either by the substitution @xmath21 or , equivalently , from the stress - energy tensor of a viscous fluid ( misner , thorne , & wheeler 1973 ; landau & lifshitz 1991 ) by ignoring the shear viscosity and heat conduction and replacing the bulk viscous pressure by @xmath19 . an explicit expression for @xmath19 in terms of velocity gradients",
    "will be given in the subsequent section .",
    "for a lagrangian formulation of relativistic hydrodynamics suitable for sph one has to break the unity of time and space inherent in the covariant formulation .",
    "this can be accomplished by applying the adm formalism of arnowitt et al .",
    "( 1962 ) , where the spacetime is decomposed into an infinite foliation of spatial hypersurfaces @xmath22 of constant coordinate time @xmath23 by writing the line element as @xmath24 here , @xmath25 is the _ lapse _ function , @xmath26 the _ shift _ vector , and @xmath27 the spatial metric induced on @xmath22 with @xmath28 and @xmath29 . in this paper",
    "we consider only given background spacetimes , i.e. , we do not solve the einstein equations .",
    "thus , @xmath30 , @xmath25 , @xmath26 , and @xmath27 are given analytic functions of both space and time .",
    "from the definitions of @xmath25 and @xmath26 the basis vector field @xmath31 of the coordinate basis @xmath32 can be decomposed into normal and parallel components with respect to the hypersurfaces @xmath22 @xmath33 where @xmath34 is the unit time - like vector field normal to the slices @xmath22 , i.e. , @xmath35 .",
    "observers having @xmath34 as 4-velocity are at rest in the slices @xmath22  they are called _ eulerian observers_. in the basis @xmath36 the 4-velocity of a fluid has the representation @xmath37 whereas in the coordinate basis @xmath32 it follows from equation ( [ partialt ] ) @xmath38 with @xmath39 from the normalization condition of the 4-velocity @xmath40 the relativistic @xmath0-factor is given by @xmath41 in the following , we use both , the 3-velocity of the fluid @xmath42 measured by eulerian observers and the 3-velocity @xmath43 in the coordinate basis .    we now derive the lagrangian equations of relativistic hydrodynamics where the lagrangian or total time derivative @xmath44 is defined as @xmath45 from the law of baryon - number conservation  ( [ covconti ] ) we obtain @xmath46 where @xmath47 is the determinant of the spacetime metric @xmath20 , and the relativistic rest - mass density @xmath48 is defined by @xmath49 here , @xmath50 is the determinant of the spatial metric @xmath27 obeying @xmath51 . with the above definition of @xmath48 the relativistic continuity equation ( [ lagconti ] )",
    "has the same form as in the non - relativistic case .",
    "note , however , that in equation ( [ lagconti ] ) the expression for @xmath52 is not the divergence of a 3-vector on @xmath22 but rather a sum of partial derivatives .",
    "eulerian observers measure the relativistic rest - mass density @xmath53 . by rewriting equation ( [ lagconti ] ) for @xmath54",
    ", we obtain the relativistic continuity equation @xmath55 which , in contrast to equation ( [ lagconti ] ) , contains an additional source term . in this paper",
    "we will use both definitions of a relativistic rest - mass density , i.e. , @xmath54 and @xmath56 .    in order to derive our relativistic expressions for the energy and momentum equations",
    ", we first re - express the conservation law of energy - momentum ( [ covenmom ] ) by using the continuity equation ( [ covconti ] ) @xmath57_{;\\nu } + \\partial_\\mu(p+q)\\enspace .\\ ] ] one can easily show that the covariant derivative in the first term of equation ( [ covenmom2 ] ) can be written as @xmath58_{;\\nu } = \\frac{\\gamma}{\\alpha}\\frac{d}{dt}\\left[\\left(w+\\frac{q}{\\rho}\\right)u_\\mu \\right ] - \\frac{1}{2}\\left(w+\\frac{q}{\\rho}\\right)g_{\\alpha\\beta,\\mu } u^\\alpha u^\\beta \\enspace .\\ ] ] thus , equation ( [ covenmom2 ] ) becomes @xmath59 & = & -\\frac{\\alpha}{\\rho\\gamma}\\left[\\partial_\\mu(p + q ) -",
    "\\frac{1}{2}(\\rho w+q)u^\\alpha u^\\beta g_{\\alpha\\beta,\\mu}\\right]\\nonumber\\\\   & = & -\\frac{1}{d^*}\\left[\\partial_\\mu\\left[\\sqrt{-g}(p+q)\\right ] - \\frac{\\sqrt{-g}}{2}t^{\\alpha\\beta}g_{\\alpha\\beta,\\mu}\\right ] \\enspace , \\end{aligned}\\ ] ] where we have used the identity @xmath60 taking the spatial components of equation ( [ covenmom3 ] ) , i.e. , @xmath61 , and using @xmath62 we get the momentum equation @xmath63 - \\frac{\\sqrt{-g}}{2}t^{\\alpha\\beta}\\partial_i g_{\\alpha\\beta}\\right ] \\enspace , \\ ] ] with the relativistic specific momentum @xmath64 defined by @xmath65 the component @xmath66 of the stress - energy tensor field @xmath67 is the relativistic momentum density in the @xmath68-direction measured by eulerian observers . the momentum equation ( [ lagmomentum ] ) , which , in a similar form , was also used by laguna et al .",
    "( 1993 ) , can be applied immediately to the sph method because it contains only spatial derivatives on its right hand side . in the eulerian formulation",
    "an expression similar to equation ( [ lagmomentum ] ) without artificial viscosity is given by hawley , smarr , & wilson ( 1984a ) for the momentum variable @xmath69 , which is more convenient for a eulerian description .",
    "the newtonian limit yielding the non - relativistic euler equation is obvious from equation ( [ lagmomentum ] ) .    taking the @xmath70component of equation ( [ covenmom3 ] )",
    ", we obtain the relativistic energy equation @xmath71 = -\\frac{1}{d^*}\\left[\\partial_t\\left[\\sqrt{-g}(p + q)\\right ] - \\frac{\\sqrt{-g}}{2 } t^{\\alpha\\beta}\\partial_t g_{\\alpha\\beta}\\right ] \\enspace , \\ ] ] which , unfortunately , has time derivatives of hydrodynamic variables on both sides .",
    "re - expressing the left hand side of equation ( [ covenmom4 ] ) as @xmath72 with @xmath73 and rewriting the first term on the right hand side of equation ( [ covenmom4 ] ) using equation ( [ lagconti ] ) , @xmath74 & = & \\frac{1}{d^*}\\frac{d}{dt}\\left[\\sqrt{-g}(p + q)\\right ] - \\frac{v^i}{d^*}\\partial_i\\left[\\sqrt{-g}(p + q)\\right]\\nonumber\\\\ & = & \\frac{d}{dt}\\left(\\sqrt{-g}\\frac{p+q}{d^*}\\right ) - \\frac{1}{d^*}\\partial_i\\left[\\sqrt{-g}(p + q)v^i\\right ] \\enspace , \\end{aligned}\\ ] ] we obtain the relativistic energy equation @xmath75 = -\\frac{1}{d^*}\\left[\\partial_i\\left[\\sqrt{-g}(p + q)v^i\\right ] + \\frac{\\sqrt{-g}}{2}t^{\\alpha\\beta}\\partial_tg_{\\alpha\\beta}\\right ] \\enspace , \\ ] ] with the total relativistic specific energy @xmath76 defined as @xmath77 the component @xmath78 of the stress - energy tensor field @xmath67 is the total relativistic energy density measured by eulerian observers . as in the case of the relativistic momentum equation ( [ lagmomentum ] ) the right hand side of equation ( [ lagenergy ] )",
    "contains no time derivatives of hydrodynamic variables .",
    "it is , therefore , well suited for the sph method in contrast to the energy equation used by hawley et al .",
    "( 1984a , 1984b ) and laguna et al .",
    "( 1993 ) which has a non - conservative form containing two total time derivatives of hydrodynamical variables separately on both sides of the equation .",
    "norman & winkler ( 1986 ) suggest that the additional time derivative of the relativistic @xmath0-factor in the energy equation gives rise to numerical inaccuracies and instabilities .",
    "note that for the special relativistic case equation ( [ lagenergy ] ) without an artificial viscosity can also be found in monaghan ( 1992 ) . in the non - relativistic case ,",
    "equation ( [ lagenergy ] ) yields the energy equation for the total non - relativistic specific energy @xmath79 written in a form similar to our expression ( [ lagenergy ] ) @xmath80 = -\\frac{1}{\\rho_n}\\partial_i\\left[(p + q)v^i\\right ] \\enspace , \\ ] ] where the index @xmath81 denotes newtonian quantities and @xmath82 is the non - relativistic specific enthalpy .    to close our system of hydrodynamical equations ( [ lagconti ] ) , ( [ lagmomentum ] ) , and ( [ lagenergy ] )",
    ", we have to add an equation of state of the form @xmath83 , which relates the thermodynamic pressure @xmath16 to the rest - mass density @xmath14 and the specific internal energy @xmath18 .",
    "we restrict ourselves to the ideal - gas equation of state given by @xmath84 with the ideal - gas adiabatic constant @xmath85 .",
    "our system of ideal fluid equations is now complete .",
    "we have derived the relativistic hydrodynamic equations ( [ lagconti ] ) , ( [ lagmomentum ] ) , and ( [ lagenergy ] ) in lagrangian conservative form similar to their newtonian counterparts .",
    "this was achieved by choosing suitable hydrodynamic variables @xmath48 , @xmath64 , and @xmath76 defined in equations ( [ densityvar ] ) , ( [ momentumvar ] ) , and ( [ energyvar ] ) . because of the equation of state ( [ idealstateeq ] ) and the use of the 3-velocity for moving particles in the lagrangian numerical methods , we now need to calculate the generic hydrodynamic quantities @xmath14",
    ", @xmath86 , and @xmath16 from these variables by solving a highly nonlinear system of equations .",
    "if an artificial viscous pressure @xmath19 is included , a severe difficulty arises from @xmath19 being usually expressed in terms of velocity gradients . since there is no time evolution equation for @xmath19 , the character of the dynamic equations",
    "is thus changed which is the usual situation in the hydrodynamics of viscous flows . due to the coupling of @xmath86 and @xmath19",
    ", the suitably chosen dynamic variables actually have to be solved iteratively for the generic hydrodynamic variables .",
    "however , artificial viscosity operates only in the vicinity of shock transitions and is zero everywhere else . for simplicity",
    "one can calculate the generic variables in a single iteration taking @xmath19 from the previous time step .",
    "using the expression @xmath87 with @xmath88 for the total relativistic specific enthalpy , the specific energy @xmath76 from equation ( [ energyvar ] ) can be written as @xmath89 solving equation ( [ energyvar2 ] ) for the relativistic specific enthalpy @xmath90 and adding the term @xmath91 , we obtain @xmath92 where the variable @xmath93 is given by @xmath94 using @xmath95 and inserting expression ( [ hqrho ] ) , the relativistic @xmath0-factor can be determined explicitly from @xmath96 as the root of a polynomial of degree four . in the appendix",
    "we show that a solution of equation ( [ gamzeroeq ] ) exists and that it is unique for all allowed values of @xmath97 , @xmath93 , and @xmath98 . with the value of @xmath0 known",
    ", one can calculate first the rest - mass density @xmath14 from equation ( [ densityvar ] ) , then the thermodynamic pressure @xmath16 from equation ( [ hqrho ] ) and the equation of state ( [ idealstateeq ] ) , and finally the velocity @xmath86 from equation ( [ momentumvar ] ) using @xmath99 .",
    "in this section we derive the sph formalism for our set of relativistic hydrodynamic equations ( [ lagconti ] ) , ( [ lagmomentum ] ) , ( [ lagenergy ] ) , and ( [ idealstateeq ] ) .",
    "since in the previous section we have obtained the dynamic equations in an appropriate lagrangian form , we can proceed in a way that is completely analogous to the newtonian case . before we derive our relativistic sph equations",
    ", we give a brief introduction into the standard sph formalism , which was invented independently by lucy ( 1977 ) and gingold & monaghan ( 1977 ) . for a review of the sph method see monaghan ( 1992 ) .",
    "sph is a numerical method which discretizes the dynamic equations on a set of nodes , called particles , moving with the fluid .",
    "the final discrete equations are obtained in two separate steps .",
    "first , all hydrodynamic functions on @xmath22 are smoothed over a certain volume with the help of a smoothing kernel @xmath100 , i.e. , for a continuous function @xmath101 one has @xmath102 where @xmath103 is the set of spatial coordinates @xmath104 . the kernel @xmath105 is a smooth ( differentiable ) function with compact support of size @xmath106 , the so called smoothing length , it is normalized to unity @xmath107 and consequently , the smoothing error in equation ( [ intintpol ] ) is @xmath108 .",
    "the above integrals extend over a region on @xmath22 around @xmath109 that contains the support of @xmath105 .",
    "an example for @xmath105 is the cubic - spline kernel of monaghan & lattanzio ( 1985 ) , and in our simulations we use this kernel throughout .",
    "the second step consists of an approximate evaluation of the above integral ( [ intintpol ] ) at the particle positions @xmath110 @xmath111 here , @xmath112 and @xmath113 label the particles which are distributed in space with number density @xmath114 .",
    "we define @xmath115 for any function @xmath116 and @xmath117 .",
    "the important point is that , applying the smoothing and discretization operations ( [ intintpol ] ) , ( [ sumintpol ] ) , it is possible to derive approximate expressions for derivatives @xmath118 where @xmath119 , @xmath120 , and @xmath121 is the gradient of the kernel @xmath122 taken with respect to the coordinates of particle @xmath112 .",
    "with the discretization method described above we are now in the position to derive the sph equations for our system of relativistic hydrodynamic equations ( [ lagconti ] ) , ( [ lagmomentum ] ) , ( [ lagenergy ] ) , and ( [ idealstateeq ] ) , and nothing has to be changed compared to the standard ( non - relativistic ) sph method . in the equations ( [ sumintpol ] ) and ( [ sphsumgrad ] ) we replace the number density @xmath123 by the mass per particle @xmath124 , i.e. , @xmath125 .",
    "dropping the angle brackets @xmath126 from now on , equation ( [ sumintpol ] ) leads to the sph representation for the relativistic rest - mass density @xmath127 from equation ( [ lagconti ] ) and using @xmath128 we obtain the sph form of the relativistic continuity equation @xmath129 here , @xmath130 is just a shorthand notation for the set of components @xmath43 , whereas @xmath131 stands for @xmath52 and is not the divergence of a vector field @xmath132 . as a consequence",
    ", the total mass is conserved exactly . applying the lagrangian time derivative to equation ( [ sphdensity ] ) with the smoothing length being constant in space and time",
    ", one can show that the sph expression of the relativistic rest - mass density @xmath48 in equation ( [ sphdensity ] ) automatically satisfies the relativistic continuity equation .",
    "thus , in sph the relativistic rest - mass density @xmath48 can be computed either from equation ( [ sphdensity ] ) or equation ( [ sphconti ] ) .",
    "if , however , the density @xmath133 is used instead of @xmath48 , a modification of the standard sph method is required . therefore , laguna et al .",
    "( 1993 ) multiply the flat - space kernel @xmath134 of newtonian sph with @xmath135 . in a curved spacetime",
    "this factor makes the kernel anisotropic , violates its translation invariance , and leads to additional terms in the sph approximation of derivatives .",
    "applying the relation @xmath136 , the relativistic sph formulation of laguna et al .",
    "( 1993 ) can be cast into the standard sph scheme which is considerably simpler .",
    "we therefore suggest that there is no need to modify sph for given background spacetimes if the continuity equation is used in the conservative form ( [ lagconti ] ) without source terms .    in order to derive the sph form of the relativistic momentum equation we start from equation ( [ lagmomentum ] ) . rewriting the pressure gradient as @xmath137 = \\sqrt{-g}\\left[\\mbox{\\boldmath$\\nabla$}\\left(\\frac{p+q}{d^*}\\right ) + \\frac{p+q}{d^{*2}}\\mbox{\\boldmath$\\nabla$}d^*\\right ] + \\frac{p+q}{d^*}\\mbox{\\boldmath$\\nabla$}\\sqrt{-g } \\enspace , \\ ] ] we obtain @xmath138 \\enspace , \\end{aligned}\\ ] ] where @xmath139 , and the metric gradients @xmath140 and @xmath141 can be calculated analytically .",
    "thus , only the pressure gradient term in equation ( [ sphmomentumeq ] ) has to be smoothed , and it has been symmetrized to conserve linear and angular momentum in sph .",
    "next , we proceed with the relativistic energy equation ( [ lagenergy ] ) . in the expression @xmath142",
    "= \\frac{\\sqrt{-g}}{d^ * } \\mbox{\\boldmath$\\nabla\\cdot$ } \\left[(p+q)\\mbox{\\boldmath$v$}\\right ] + \\frac{p+q}{d^ * } \\mbox{\\boldmath$v\\cdot\\nabla$}\\sqrt{-g}\\ ] ] we replace the first term on the right hand side by @xmath143 & = & \\frac{1}{d^ * } \\mbox{\\boldmath$v\\cdot\\nabla$ } ( p+q ) + \\frac{p+q}{d^ * } \\mbox{\\boldmath$\\nabla\\cdot v$ } \\nonumber\\\\ & = & \\mbox{\\boldmath$v\\cdot$ } \\left [ \\mbox{\\boldmath$\\nabla$ } \\left(\\frac{p+q}{d^ * } \\right ) + \\frac{p+q}{d^{*^2 } } \\mbox{\\boldmath$\\nabla$ } d^ * \\right ] \\nonumber\\\\ & & { } + \\frac{1}{2 } \\left [ \\mbox{\\boldmath$\\nabla\\cdot$ } \\left(\\frac{p+q}{d^ * } \\mbox{\\boldmath$v$ } \\right ) - \\mbox{\\boldmath$v\\cdot\\nabla$ } \\left(\\frac{p+q}{d^*}\\right ) \\right .",
    "\\nonumber\\\\ & & \\left.{}+\\frac{p+q}{d^{*2 } } \\left [ \\mbox{\\boldmath$\\nabla\\cdot$ } ( d^ * \\mbox{\\boldmath$v$ } ) - \\mbox{\\boldmath$v\\cdot\\nabla$ } d^ * \\right ] \\right ] \\enspace .\\end{aligned}\\ ] ] with this combination of terms we obtain the sph representation of the relativistic energy equation @xmath144}_a & = & -\\frac{\\sqrt{-g_a}}{2 } \\sum_b m_b\\left(\\frac{p_a+q_a}{d^{*2}_a } + \\frac{p_b+q_b}{d^{*2}_b}\\right ) ( \\mbox{\\boldmath$v$}_a + \\mbox{\\boldmath$v$}_b ) \\mbox{\\boldmath$\\cdot\\nabla$}_a w_{ab } \\nonumber\\\\ & & { } -\\frac{\\sqrt{-g_a}}{d^*_a } \\left [ ( p_a+q_a ) \\mbox{\\boldmath$v$}_a   { \\mbox{\\boldmath$\\cdot\\nabla$}_a \\left(\\ln{\\sqrt{-g}}\\right)}_a + \\frac{1}{2 } t^{\\alpha\\beta}_a { \\left(g_{\\alpha\\beta , t}\\right)}_a \\right ] \\enspace .\\end{aligned}\\ ] ] note that equation ( [ sphenergyeq ] ) and the momentum equation ( [ sphmomentumeq ] ) contain identical symmetric factors in front of the kernel gradients .",
    "as outlined in section [ hydroeq ] , this form of the relativistic energy equation is well suited for sph because it contains no time derivatives of hydrodynamic variables on its right hand side .",
    "again , there is no need to smooth the derivatives of the metric @xmath140 and @xmath145 .",
    "the last equation that needs to be considered is the equation of state ( [ idealstateeq ] ) , and its sph formulation reads @xmath146 this completes our set of relativistic sph equations ( [ sphdensity ] ) , ( [ sphmomentumeq ] ) , ( [ sphenergyeq ] ) , and ( [ sphstateeq ] ) for computing general relativistic fluid flows in given arbitrary background spacetimes .",
    "we now focus our attention to the implementation of an artificial viscosity term which is necessary to handle shock fronts . for the use of an artificial viscosity in the standard sph method see monaghan & gingold ( 1983 ) . in our simulations , we have used the following artificial viscous pressure @xmath147 & \\mbox{if}\\enspace { \\left ( \\mbox{\\boldmath$\\nabla\\cdot v$ } \\right)}_a < 0 \\\\ 0 & \\mbox{otherwise}\\end{array}\\right.\\ ] ] with @xmath148 where @xmath149 is the relativistic sound velocity measured in the rest frame of the fluid , @xmath150 , @xmath151 and @xmath152 are numerical parameters , @xmath153 , @xmath154 stand for the differences @xmath155 , @xmath156 , and @xmath157 is the mean value of the smoothing lengths of particles @xmath112 and @xmath113 . without the enthalpy @xmath158 , the expression ( [ artvisc ] ) for @xmath19 is almost equivalent to the standard sph form of the artificial viscosity invented by monaghan & gingold ( 1983 ) . including @xmath158 into equation ( [ artvisc ] )",
    ", the parameters @xmath150 and @xmath151 can be chosen to be of order unity even for shocks with ultra - relativistic values of @xmath0 .",
    "the @xmath150-term , which is linear in the velocity differences , is similar to a physical shear and bulk viscosity , and the quadratic @xmath151-term is the standard von neumann - richtmyer ( 1950 ) artificial viscosity used in finite difference methods for handling high mach - number shocks .",
    "according to monaghan & gingold ( 1983 ) , the un - smoothed representation of the velocity divergence in equation ( [ sphdivv ] ) acts more directly on the relative motion of particle pairs and leads to a damping of irregular oscillations in shock transitions . in equation ( [ sphdivv ] ) ,",
    "the parameter @xmath152 has been introduced to avoid singularities , and a typical value is @xmath159 .    since the expression ( [ artvisc ] ) for the artificial viscosity is not lorentz invariant , we also performed calculations with a relativistically covariant formulation of the artificial viscous pressure @xmath160 & \\mbox{if}\\enspace \\theta_a<0\\\\ 0 & \\mbox{otherwise}\\end{array}\\right.\\ ] ] where @xmath161 \\enspace .\\ ] ] however , this expression contains a time derivative of the @xmath0-factor which destroys the explicit nature of the lagrangian form of the hydrodynamic equations .",
    "one possibility to circumvent this problem is to take the backward time difference approximation @xmath162/\\delta t$ ] with time step @xmath163 for the time derivative @xmath164 .",
    "since the non - covariant form ( [ artvisc ] ) turned out to be quite appropriate for the resolution of shock structures , we used this approach in all our simulations and did not pursue the covariant relation ( [ artviscrel ] ) .    to improve the local resolution of sph , we allow the smoothing length @xmath106 to vary in space according to the relativistic rest - mass density @xmath48 via @xmath165^{1/d } \\enspace , \\ ] ] where @xmath166 denotes the dimension of the spatial slices @xmath22",
    ". for particles of equal mass the scaling law ( [ varhsml ] ) indicates that the number of particles within the support of the kernel @xmath105 is approximately kept constant in time .",
    "thus , in regions where the gas is compressed , the smoothing length is increased while it is decreased in rarefaction zones . since the smoothing length is now a function of the density @xmath48 , equation ( [ sphdensity ] ) ( or eq .  [ [ sphconti ] ] ) is now a nonlinear implicit relation for the density .",
    "we solve this approximately by inserting @xmath167 from the previous time step into equation ( [ varhsml ] ) to obtain an estimate for @xmath168 .",
    "since the smoothing length is now a function of position and time , the sph form of the continuity equation contains additional terms ( monaghan 1992 )",
    ". however , no such terms appear if the relativistic rest - mass density @xmath167 is calculated from the computationally simpler equation ( [ sphdensity ] ) .",
    "although we have developed a fully three - dimensional general relativistic sph code , we restrict ourselves in this paper to the standard analytic test bed of one - dimensional special relativistic shock problems : the shock tube and the wall shock . for each simulation",
    "we show four diagrams of the numerical results together with the analytic solution for the fluid variables 3-velocity @xmath169 , rest - mass density @xmath14 , thermodynamic pressure @xmath16 , and specific internal energy @xmath18 .",
    "these variables are functions of the coordinate @xmath170 $ ] .",
    "the quality of the simulations is measured in terms of the relative error with respect to the analytic solution , i.e. , for each hydrodynamic function @xmath116 an error @xmath171 is calculated from @xmath172 where the sum is over all @xmath81 particles and @xmath173 stands for the analytic solution which has the maximum value @xmath174 .",
    "first we consider the shock tube problem , where initially a fluid at rest is divided by a diaphragm into two regions of different densities and internal energies .",
    "when the diaphragm is removed , a rarefaction wave travels into the warm and dense medium and a compression wave into the cold and lower density fluid . between the two media",
    "a so called contact discontinuity is present . for the analytic solution of the relativistic shock tube problem we refer to taub ( 1948 ) , mckee & colgate ( 1973 ) , hawley et al .",
    "( 1984a ) , and marti & mller ( 1994 ) .",
    "= 0.89    = 0.89     +    = 0.89    = 0.89    as any relativistic hydro code has to be tested for the newtonian limit , we start our series of shock tube simulations with a non - relativistic test case .",
    "figure [ fig1 ] shows the corresponding numerical and analytic solution for a gas with @xmath175 at time @xmath176 with the initial conditions @xmath177 , @xmath178 for @xmath179 , and @xmath180 , @xmath181 for @xmath182 ( note that the units are arbitrary except for the velocity which is measured in units of @xmath2 ) .",
    "the numerical calculation was performed with 1000 particles , initial smoothing length @xmath183 ( @xmath184 interactions per particle ) , and artificial viscosity parameters @xmath185 and @xmath186 . in the initial distribution",
    ", particles were placed on a uniform grid , and the particles at @xmath187 have a mass ten times smaller than the particles at @xmath188 . in the calculation of figure [ fig1 ]",
    "the largest relative error occurs in the fluid velocity where @xmath189 .",
    "= 0.89    = 0.89     +    = 0.89    = 0.89    next , a mildly relativistic shock tube is investigated with initial conditions @xmath190 , @xmath191 ( @xmath188 ) , and @xmath192 , @xmath193 ( @xmath187 ) . figure [ fig2 ] shows the numerical result and the analytic solution for a gas with @xmath194 at time @xmath195 .",
    "we used the same numerical parameters as in the non - relativistic shock tube problem , i.e. , 1000 particles , @xmath183 , @xmath185 , and @xmath186 .",
    "the largest relative error is @xmath196 .",
    "as can be seen in figure [ fig2 ] , the velocity profile of a relativistic rarefaction wave is no longer linear as in the newtonian case because of the relativistic velocity addition formula . comparing our results with the simulations of hawley et al .",
    "( 1984b ) and laguna et al .",
    "( 1993 ) for the same @xmath197 shock tube , we note that numerical inaccuracies due to the non - conservative formulation of their energy equation clearly show up in their results for the relativistic rest - mass density and specific internal energy .",
    "to investigate the convergence properties of our numerical method , we performed a calculation of the @xmath197 shock tube with @xmath198 particles and initial smoothing length @xmath199 ( @xmath200 interactions per particle ) .",
    "as can be seen in figure [ fig3 ] , the numerical calculation covers the analytic solution almost exactly , and the largest relative error is reduced to @xmath201 .",
    "= 0.89    = 0.89     +    = 0.89    = 0.89    when the relativistic @xmath0-factor of the shock tube is increased by increasing the initial specific internal energy ratio , the region between the leading shock front and the trailing contact discontinuity becomes extremely thin and dense .",
    "thus , without specially designed adaptive methods , it will be impossible to resolve these lorentz contracted shells of matter , which are typical for relativistic fluid flows .",
    "in addition , the specific internal energy at the contact discontinuity may become negative in the sph simulations . in order to avoid these difficulties , we consider now a simplified problem of a single shock front without the presence of a contact discontinuity and a nonlinear rarefaction wave .",
    "= 0.89    = 0.89     +    = 0.89    = 0.89    as a second test of our numerical method we modeled the wall shock problem of a cold relativistically moving fluid flowing towards a solid wall . as the fluid hits the wall , a shock front forms , which then travels upstream against the incoming fluid producing a hot and dense post shock region of zero velocity .",
    "= 0.89    = 0.89     +    = 0.89    = 0.89    figure [ fig4 ] shows the numerical result and the analytic solution of a mildly relativistic wall shock for a gas with @xmath202 at time @xmath203 moving to the right with the reflecting wall at @xmath204 .",
    "the uniform initial fluid properties are @xmath205 , @xmath206 with @xmath207 , and @xmath208 .",
    "initially , particles of equal mass are uniformly distributed in the simulation domain . at the location of the solid wall we use reflecting boundary conditions .",
    "the simulation of figure [ fig4 ] showing about @xmath209 particles was performed with the initial smoothing length @xmath210 ( @xmath184 interactions per particle ) and artificial viscosity parameters @xmath211 and @xmath212 . the rest - mass density @xmath14 , the thermodynamic pressure @xmath16 , and the specific internal energy @xmath18 show a spike - like feature ( see fig .  [ fig4 ] ) , which is known in the literature as `` wall heating '' ( norman & winkler 1986 )",
    ". the largest relative error appears in the specific internal energy where @xmath213 .",
    "the results of an ultra - relativistic shock simulation are shown in figure [ fig5 ] .",
    "the initial velocity @xmath214 is increased to @xmath215 which corresponds to a relativistic @xmath0-factor of @xmath216 .",
    "all other parameters are identical with those of the previous wall shock calculation . neglecting the pre - shock specific internal energy @xmath217",
    ", one can show that in the ultra - relativistic limit @xmath218 the post shock properties @xmath219 , @xmath220 , @xmath221 , and the shock velocity @xmath222 are given by @xmath223 , @xmath224 , @xmath225 , and @xmath226 . for the wall shock problem of figure [ fig5 ]",
    "we thus obtain @xmath227 , @xmath228 , @xmath229 , and @xmath230 . at the time",
    "@xmath203 the shock front has moved the distance @xmath231 to the left reaching the spatial position @xmath232 . the largest relative error in this case",
    "is @xmath233 .",
    "= 0.89    = 0.89     +    = 0.89    = 0.89    a calculation of a mildly relativistic wall shock problem ( with @xmath234 ) using artificial viscosity was also performed by hawley et al .",
    "( 1984b ) with their time - explicit eulerian finite difference code .",
    "they tried several formulations of their non - conservative energy equation by omitting and including various artificial viscous pressure terms .",
    "they found that the @xmath235 term in their energy equation is unstable even for mildly relativistic wall shocks .",
    "this is verified by the calculations of norman & winkler ( 1986 ) using an implicit adaptive - mesh finite difference method , which shows the requirement of an implicit technique to handle the @xmath235 term .",
    "the fact that our method is able to treat even ultra - relativistic shocks without problems is entirely based on our conservation formulation of the relativistic hydrodynamic equations where no additional time derivatives of hydrodynamic variables appear such as the @xmath235 term . in order to verify that this numerical stability is not restricted to the sph method",
    ", we also performed numerical simulations of the wall shock problem with a simple explicit finite difference upwind scheme .",
    "figure [ fig6 ] shows the numerical result and the analytic solution for the @xmath216 wall shock at time @xmath203 using a grid of @xmath209 zones , and the maximum relative error occurs for the specific internal energy where @xmath236 .",
    "we have derived a fully lagrangian conservative form of the general relativistic equations of hydrodynamics for a perfect fluid with artificial viscosity in a given arbitrary background spacetime .",
    "this has been achieved by choosing suitable lagrangian time evolution variables .",
    "these variables are connected to the generic fluid variables rest - mass density @xmath14 , 3-velocity @xmath86 , and thermodynamic pressure @xmath16 through a set of nonlinear algebraic equations .",
    "for an ideal gas , we have shown that these equations can be reduced to a single fourth - order equation with a unique solution which can be explicitly calculated in terms of various roots . for more complex equations of state",
    "the solution of the above algebraic equations has to be performed numerically , and the question of uniqueness is more complicated . using our lagrangian formulation ,",
    "we have developed a three - dimensional general relativistic sph code based on the standard sph approach of non - relativistic fluid dynamics .",
    "the important point is that all metric factors from covariant derivatives have been absorbed in the definition of the lagrangian variables and thus no longer appear in the fluid equations . as a result",
    ", the sph kernels remain spherically symmetric and are the same for all particles .",
    "this is an essential difference to the covariant sph approach of kheyfets et al .",
    "( 1990 ) using kernels defined in the local comoving frame of the fluid , and to the relativistic sph method of laguna et al .",
    "( 1993 ) where , in curved spacetime , the kernels are anisotropic and have no translational symmetry which leads to additional terms in the sph equations . the relativistic continuity equation ( [ lagconti ] ) , for example , contains no source term , hence we can identify the relativistic rest - mass density @xmath237 as the appropriate sph density for smoothing the equations .    in this paper",
    "we have restricted ourselves to the numerical simulation of two different one - dimensional examples , i.e. , the special relativistic shock tube and the wall shock . an empirical error estimate is obtained from a comparison of the numerical results with the corresponding analytic solutions . the sph calculations with @xmath1 particles show a typical maximum relative error of about @xmath238 , and an increase of the particle number with a decreasing smoothing length reduces this error in a uniform way .",
    "the wall - shock problem can be solved without any numerical difficulties for very large @xmath0-factors ( at least @xmath239 ) .",
    "the shock - tube case suffers from a resolution problem if @xmath0 is large because a thin shell of matter builds up between the shock front and the contact discontinuity .",
    "this can only be resolved with the help of additional adaptive methods which increase the number of particles in this zone .",
    "an important ingredient in our sph formulation is the treatment of shock structures by an artificial viscosity rather than using a riemann solver .",
    "this is very easy to implement even for the two- or three - dimensional case .",
    "introducing an artificial viscous pressure @xmath19 is considered as a purely numerical tool that acts as a filter to smear out steep gradients in the hydrodynamic functions and suppresses unphysical oscillations .",
    "thus , there is no need to use a covariant expression for @xmath19 in terms of velocity derivatives as long as the time evolution and the jump conditions of shocks are represented correctly . since the jump conditions follow from the conservation of mass , momentum , and energy across the shock , it is obvious that a conservative form of the relativistic hydrodynamic equations is important for handling discontinuities in relativistic fluid dynamics numerically .",
    "the simulation of relativistic flows with large @xmath0-factors including shocks is the traditional domain of hrsc methods .",
    "however , with our formulation of the general relativistic hydrodynamic equations it is possible to model such flows using an artificial viscosity independent of the underlying numerical method , i.e. , sph or finite difference schemes .",
    "we want to thank p. laguna for helpful discussions and for encouraging us to publish our results .",
    "this work is part of the project a7 of the sonderforschungsbereich sfb  382 funded by the deutsche forschungsgemeinschaft ( dfg ) .",
    "in section [ hydroeq ] we have derived equation ( [ gamzeroeq ] ) from which the relativistic @xmath0-factor can be calculated analytically as the root of a polynomial of degree four for given artificial viscous pressures @xmath19 . equation ( [ gamzeroeq ] )",
    "is restricted to an ideal - gas equation of state ( [ idealstateeq ] ) .",
    "we will now show the existence and uniqueness of the solution of equation ( [ gamzeroeq ] ) for all allowed values of @xmath97 , @xmath98 , and @xmath93 .",
    "first , we rewrite equation ( [ gamzeroeq ] ) by substituting @xmath240 , @xmath241 and obtain @xmath242 with the degree of freedom @xmath243 the ideal - gas adiabatic constant @xmath244 and the variable @xmath88 lie in the range @xmath245 from equations ( [ hqrho ] ) and ( [ ssquare ] ) the variables @xmath93 and @xmath98 are given by @xmath246 where we have defined @xmath247 . using the relations ( [ gammagrange ] ) and the expressions ( [ etildessquare ] ) , we obtain for the coefficient @xmath248 in equation ( [ deltazeroeq ] ) @xmath249 thus , @xmath98 is limited to the range",
    "@xmath250          to show the uniqueness of the solutions of equation ( [ deltazeroeq ] ) for @xmath253 , we investigate the changes of signs of the coefficients @xmath254 , @xmath255 , and @xmath256 depending on the variable @xmath98 : @xmath257 using @xmath258 and the relations ( [ gammagrange ] ) , one can show that @xmath259\\nonumber\\\\ & > & \\frac{\\gamma g^2}{1 + 2\\gamma}\\left[(2 - \\gamma ) + 2(\\gamma - 1 ) - \\gamma\\right ] = 0 \\enspace , \\quad",
    "\\mbox{and}\\\\ \\label{rels2s3 } s_2 ^ 2 & = & \\frac{1}{2(3 - g)}\\left(5\\tilde e^2 - 6g\\tilde e + g^2\\right)\\nonumber\\\\ & < & \\frac{1}{2(3 - g)}\\left(5\\tilde e^2 - 6g\\tilde e + g\\tilde e\\right)\\nonumber\\\\ & = & \\frac{5}{2(3 - g)}\\left(\\tilde e^2 - g\\tilde e\\right)<\\tilde e^2 - g\\tilde e < s_3 ^ 2 \\enspace .\\end{aligned}\\ ] ] the relations ( [ rels1 ] ) , ( [ rels1s2 ] ) , and ( [ rels2s3 ] ) lead to @xmath260 i ) for @xmath261 or @xmath262 , respectively , we obtain from the relations ( [ rela4 ] ) and ( [ rels1s2s3 ] ) the following table of signs for the coefficients @xmath248 , @xmath254 , @xmath255 , @xmath256 , and @xmath263 depending on @xmath98 :       for all values of @xmath264 the series of coefficients @xmath248 , @xmath254 , @xmath255 , @xmath256 , and @xmath263 has exactly one change of sign .",
    "therefore , in @xmath265 there exists only one root of equation ( [ deltazeroeq ] ) for @xmath253 .",
    "\\ii ) for @xmath266 or @xmath267 , respectively , equation ( [ deltazeroeq ] ) has the root @xmath268 . with the relations ( [ rela4 ] ) and ( [ rels1s2s3 ] ) the coefficients @xmath248 , @xmath254 , @xmath255 , and @xmath256 are all less than zero .",
    "thus , @xmath268 is the only positive root of equation ( [ deltazeroeq ] ) for @xmath253 .    to summarize , with the restriction of the ideal - gas equation of state ( [ idealstateeq ] ) a solution of equation ( [ deltazeroeq ] ) for @xmath253 or of equation ( [ gamzeroeq ] ) for @xmath0 , respectively , exists and is unique .",
    "thus , the fluid variables rest - mass density @xmath14 , 3-velocity @xmath269 , and thermodynamic pressure @xmath16 can be calculated analytically in a unique way from the variables @xmath48 , @xmath64 , @xmath76 , and @xmath19 from equations ( [ gamzeroeq ] ) , ( [ densityvar ] ) , ( [ idealstateeq ] ) , ( [ hqrho ] ) , and ( [ momentumvar ] ) ."
  ],
  "abstract_text": [
    "<S> we present a fully lagrangian conservation form of the general relativistic hydrodynamic equations for perfect fluids with artificial viscosity in a given arbitrary background spacetime . </S>",
    "<S> this conservation formulation is achieved by choosing suitable lagrangian time evolution variables , from which the generic fluid variables rest - mass density , 3-velocity , and thermodynamic pressure have to be determined . </S>",
    "<S> we present the corresponding equations for an ideal gas and show the existence and uniqueness of the solution . on the basis of the lagrangian formulation we have developed a three - dimensional general relativistic smoothed particle hydrodynamics ( sph ) code using the standard sph formalism as known from non - relativistic fluid dynamics . </S>",
    "<S> one - dimensional simulations of a shock tube and a wall shock are presented . with our method </S>",
    "<S> we can model ultra - relativistic fluid flows including shocks with relativistic @xmath0-factors of even @xmath1 . </S>"
  ]
}