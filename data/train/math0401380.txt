{
  "article_text": [
    "in this paper we consider the problem of mathematically describing impulsive motions ( impacts , collisions , reflection , refractions ) of hamiltonian systems subject to nonholonomic constraints .",
    "an impulsive behavior takes place when one or more of the basic ingredients of the hamiltonian dynamical picture undergoes a drastic change . as an example",
    ", one may consider the instant of time when the configuration space of the system collapses instantaneously because of an inelastic collision .",
    "another example is given by a ray of light that splits into reflected and refracted rays when passing from one optical media to another , and so on . in situations like these",
    ", the phase trajectory of the system becomes discontinuous and the problem of how to describe this discontinuity arises .    the problem of describing impulsive motion has been extensively studied in classical books such as  @xcite . in these references , the emphasis is put on the analysis of mechanical systems subject to impulsive forces , and in particular , the study of rigid body collisions by means of newton and poisson laws of impact .",
    "impulsive nonholonomic constraints ( i.e. constraints whose reaction force is impulsive ) are also considered in  @xcite , and , from a geometric perspective , in more recent works such as  @xcite .",
    "if impulsive constraints and impulsive forces are present at the same time , newton and poisson approaches have been revealed to be physically inconsistent in certain cases  @xcite .",
    "this surprising consequence of the impact laws is only present when the velocity along the impact surface stops or reverses during collision due to the friction .",
    "energetically consistent hypothesis for rigid body collisions with slip and friction are proposed in  @xcite . from a design point of view",
    ", the interest in systems subject to impulsive forces is linked to the emergence of nonsmooth and hybrid dynamical systems in control theory , i.e. , systems where continuous and discrete dynamics coexist , see  @xcite and references therein .",
    "hybrid mechanical systems that locomote by switching between different constraint regimes and are subject to elastic impacts are studied in  @xcite .",
    "hyper - impulsive control of mechanical systems is analyzed in  @xcite .    here",
    ", we aim at a comprehensive analysis of the various situations which can occur concerning impulsive regimes of nonholonomic hamiltonian systems .",
    "in particular , we focus on two different but complementary cases . the first one deals with a drastic change in the nonholonomic constraints imposed on the system .",
    "the second one concerns a drastic change of the hamiltonian function and includes , in particular , collisions and impacts of nonholonomic systems .",
    "the proposed solution is given in terms of a generalized version of the _",
    "transition principle_. this principle , sketched for the first time in a series of lectures of the second author  @xcite for discontinuous hamiltonians , was recently extended to other non - constrained situations in  @xcite ( see also  @xcite for a related discussion in an optimal control setting ) . by its very nature , the transition principle is a direct dynamic interpretation of the geometric data of the problem .",
    "this feature distinguishes it from other approaches .",
    "for instance , in classical mechanics , the velocity jumps caused by an impact are traditionally derived from some assumptions on the nature of the impulsive forces ( see , for instance ,  @xcite ) .",
    "however , these assumptions are not logical consequences of the fundamental dynamical principles and therefore one should really consider them as additional principles for impulsive problems .",
    "the distinguishing feature of the transition principle is that it gives full credit to the geometry of the nonholonomic hamiltonian system .",
    "this seems reasonable for the impulsive regime , keeping in mind the perfect adequacy of the hamiltonian description to the dynamical behavior of the system in the absence of impulsive motions .",
    "in addition , there are some noticeable advantages deriving from the transition principle .",
    "first of all , its application gives an exact and direct description of the post - impact state which is of immediate use for both theoretical and computational purposes .",
    "secondly , it is still valid in some situations where standard methods can be hardly applied . in particular , this is the case of hamiltonian systems describing the propagation of singularities of solutions of partial differential equations ( consider , for instance , the example of geometrical optics )  @xcite . clearly , no variational or traditional approach can be applied to this very important class of systems . a second contribution of this paper concerns the formulation of the dynamics of nonholonomic hamiltonian systems .",
    "we make use of the notion of partial symplectic structures introduced in  @xcite and relate this framework with other modern approaches to nonholonomic systems ( see  @xcite and references therein ) .",
    "one advantage of the partial symplectic formalism is that it allows us to draw clear analogies between the unconstrained and constrained situations .",
    "another advantage is that the treatment of nonlinear constraints can be easily incorporated .",
    "the paper is organized as follows .",
    "section  [ se : preliminaries ] introduces some geometric preliminaries on distributions , constraint submanifolds and partial symplectic structures . in section  [ se : dynamics - nonholonomic ] , we show how any nonholonomic hamiltonian system possesses an associated partial symplectic structure , and we use this fact to intrinsically formulate the dynamics .",
    "we also analyze systems with instantaneous nonholonomic constraints and systems exhibiting discontinuities . in section  [ se : transition - principle ] , we develop a new formulation of the transition principle for systems with constraints .",
    "we present the novel notion of focusing points with respect to a constraint submanifold and we also introduce the concept of constrained characteristic .",
    "decisive points are defined for each impulsive regime resorting to in , out and trapping points .",
    "section  [ se : mechanical - systems ] presents a detailed study of the concepts introduced in the previous sections in the case of mechanical systems .",
    "we compute the focusing points and the characteristic curves , and present various results concerning the decisive points .",
    "we also prove an appropriate version for generalized constraints of the classical carnot s theorem for systems subject to impulsive forces : if the constraints are linear , we show that the transition principle always implies a loss of energy .",
    "we conclude this section by showing that if the constraints are integrable , then our formulation of the transition principle recovers the solution for completely inelastic collisions  @xcite .",
    "finally , section  [ se : examples ] presents various examples of the application of the above - developed theory .    to ease the exposition , below we make use of the standard notation concerning differential geometry and the hamiltonian formalism without making explicit reference to any work .",
    "in particular , we denote by @xmath0 ( resp .",
    ", @xmath1 ) the @xmath2-module of @xmath3th order differential forms ( resp . , of vector fields ) on a manifold @xmath4 .",
    "we use @xmath5 to denote the pullback with respect to a smooth map @xmath6 of a function or differential form @xmath7 .",
    "if @xmath8 is a point of @xmath4 , then the subscript @xmath8 refers to the value of the corresponding geometric object at @xmath8 .",
    "for instance , @xmath9 stands for the vector field vector @xmath10 evaluated at @xmath8 .",
    "the interested reader may consult classical books such as  @xcite for further reference .",
    "we also assume smoothness of all the objects we are dealing with .",
    "in this paper we deal with hamiltonian systems defined on the cotangent bundle @xmath11 of an @xmath12-dimensional manifold @xmath4 . in the particular case of a mechanical system , @xmath4 and @xmath11",
    "are , respectively , the configuration space and the phase space of the system . as usual , @xmath13 ( or simply @xmath14 ) stands for the canonical projection from @xmath11 to @xmath4 , @xmath15 for the hamiltonian function and @xmath16 for the corresponding hamiltonian vector field . the canonical symplectic structure on @xmath11",
    "is denoted by @xmath17 . in",
    "canonical coordinates @xmath18 , @xmath19 of @xmath11 , the symplectic form reads @xmath20 .",
    "we say that the hamiltonian system @xmath21 _ comes from a lagrangian system @xmath22 on @xmath23 _ if @xmath24 , where @xmath25 is the energy function corresponding to the ( hyper - regular ) lagrangian function @xmath26 and @xmath27 is the associated legendre map .",
    "if @xmath28 is a vector field on @xmath11 , then the map @xmath29 defined by @xmath30 denotes the _ anti - legendre map associated with @xmath28_. in standard coordinates , if @xmath31 , then @xmath32 reads @xmath33 . for the hamiltonian vector field @xmath34",
    ", we write @xmath35 instead of @xmath36 , so that @xmath37 it is not difficult to see that if the hamiltonian system @xmath21 comes from a lagrangian system @xmath22 , then @xmath38 .",
    "recall that a _ distribution _ ( resp .",
    ", _ codistribution _ ) on a manifold @xmath4 is a vector subbundle of @xmath23 ( resp .",
    ", of @xmath11 ) .",
    "the _ annihilator _ of a distribution @xmath39 on @xmath4 is the codistribution @xmath40 defined by @xmath41 if @xmath39 is @xmath42-dimensional , the codistribution @xmath40 is @xmath43-dimensional .",
    "the _ dual bundle @xmath44 of @xmath39 _ is canonically identified with the cotangent bundle @xmath11 modulo @xmath45 .",
    "we will also denote by @xmath46 the orthogonal complement of a distribution @xmath39 on @xmath11 with respect to the symplectic form @xmath47 , i.e. , @xmath48    a vector field @xmath10 _ belongs _ to @xmath39 if @xmath49 for all @xmath50 .",
    "vector fields belonging to @xmath39 constitute a @xmath2-module , denoted by @xmath51 , which is a submodule of @xmath1 . in the partial symplectic formalism ( see section  [ se : partial ] below ) , they are interpreted as `` constrained '' vector fields .",
    "dually , denote by @xmath52 the @xmath2-module of sections of the bundle @xmath44 and by @xmath53 its @xmath3th exterior product .",
    "these are interpreted as `` constrained '' differential @xmath3-forms .",
    "we denote the natural restriction map from @xmath54 to @xmath53 by @xmath55 .    the geometric description of nonholonomic systems in the framework of the partial symplectic formalism  @xcite requires a slight `` affine '' generalization of these standard notions .",
    "namely , an _ affine distribution _ on a manifold @xmath4 is an affine subbundle @xmath56 of @xmath23 .",
    "this means that the fiber @xmath57 of @xmath56 over @xmath50 is an affine subspace in @xmath58 .",
    "therefore , @xmath57 can be represented in the form @xmath59 with @xmath60 and @xmath61 being the vector subspace of @xmath62 canonically associated with @xmath57 . in this representation , the _ displacement vector _",
    "@xmath63 is unique modulo @xmath61 .",
    "the union @xmath64 constitutes a linear distribution of the tangent bundle @xmath23 , denoted by @xmath65 , canonically associated with @xmath56 .",
    "it is not difficult to see that there always exist a vector field @xmath66 such that @xmath67 is a displacement vector for @xmath57 .",
    "such vector fields are called _ displacement vector fields of @xmath56_. obviously , displacement vector fields differ by another vector field belonging to @xmath68 . in coordinate terms , an @xmath42-dimensional affine codistribution is described by a system of linear equations @xmath69 with respect to the variables @xmath70 , i.e. , @xmath71 , @xmath72 .",
    "similarly , an _ affine codistribution _ on @xmath4 is an affine subbundle @xmath73 of the cotangent bundle .",
    "as above , one has @xmath74 , where @xmath75 is the unique codistribution on @xmath4 canonically associated with @xmath76 , and @xmath77 is a _",
    "displacement form_. point - wisely this means that @xmath78 , for all @xmath50 .      in the case of linear constraints ,",
    "the analogy between free and constrained systems is particularly clear .",
    "in fact , it is natural to interpret an affine distribution ( resp . ,",
    "codistribution ) on a manifold @xmath4 as the `` constrained '' tangent ( resp . ,",
    "cotangent ) bundle of @xmath4 .",
    "a linearly constrained hamiltonian system is then a triple @xmath79 , with @xmath80 and @xmath76 an affine codistribution on @xmath4 .",
    "similarly , a triple @xmath81 , with @xmath26 and @xmath68 an affine distribution on @xmath4 , is a linearly constrained lagrangian system .",
    "the anti - legendre map allows one to pass from a constrained hamiltonian system to the corresponding lagrangian system and vice versa .",
    "more precisely , if @xmath79 is a linearly constrained hamiltonian system , the map @xmath35 is linear and @xmath21 comes from a lagrangian system @xmath22 , then the corresponding linearly constrained lagrangian system is @xmath81 , with @xmath82 . to go in the opposite direction",
    ", one must use the legendre map @xmath83 instead of @xmath35 .    throughout the paper ,",
    "we distinguish the class of mechanical systems subject to linear constraints because of two reasons .",
    "first , classically they have been intensively studied .",
    "second , one can extract from them the motivations for the basic constructions which will be discussed below .      in the hamiltonian setting , the _ nonholonomic constraints",
    "_ are given by a submanifold ( not necessarily a vector subbundle ) @xmath84 .",
    "similarly , _",
    "nonholonomic lagrangian or kinematic constraints _ are given by a submanifold @xmath85 .",
    "if the hamiltonian system @xmath21 comes from a lagrangian system @xmath22 , then @xmath86 if and only if @xmath87 . in mechanics ,",
    "these two approaches correspond to two possible descriptions of nonholonomic constraints : either as limitations imposed on the momenta or as limitations imposed on the velocities , respectively .",
    "the fact that @xmath76 ( resp . , @xmath88 ) represents limitations imposed only on the momenta ( resp .",
    ", velocities ) , but not on the configurations of the system , implies that the projection @xmath14 must send @xmath76 ( resp . ,",
    "@xmath88 ) surjectively onto @xmath4 .",
    "however , the assumption of `` infinitesimal surjectivity '' of @xmath89 is more adequate in this context .",
    "this means that @xmath89 is a _ submersion _",
    ", i.e. , @xmath90 is surjective for all @xmath91 . with this motivation",
    ", we adopt the following definition .    a set of _ nonholonomic constraints _ imposed on a hamiltonian system @xmath21 is a submanifold @xmath73 such that @xmath89 is a submersion .",
    "the constrained hamiltonian system is denoted by @xmath79 .    since @xmath76 and @xmath92 are , respectively",
    ", interpreted as the constrained cotangent and tangent bundle of the system @xmath79 , we will always assume that they have equal dimensions .",
    "it is worth stressing that the above definition makes also sense for manifolds with boundary .",
    "in such a case , the boundary of @xmath11 is @xmath93 and the boundary of @xmath76 is  @xmath94 .    similarly , _",
    "nonholonomic lagrangian constraints _ are represented by submanifolds of @xmath23 that project regularly onto @xmath4 .    in what follows , @xmath95 , @xmath96 ,",
    "will denote a set of local equations defining @xmath76 .",
    "for a point @xmath50 , we denote by @xmath97 the fiber of @xmath76 at @xmath8 , @xmath98      let @xmath99 be a hypersurface in @xmath4 .",
    "consider the induced hypersurface @xmath100 of @xmath11 .",
    "let @xmath101 be a set of nonholonomic constraints on @xmath4 .",
    "instantaneous constraints may be thought as limitations on the momenta ( resp .",
    ", velocities ) of the system that are imposed only at the instant when a trajectory passes through a point of @xmath99 .",
    "therefore , they are represented by a submanifold  @xmath102 of  @xmath103 .",
    "these constraints are assumed to be additional to the ones already prescribed by @xmath76 . in order to admit an adequate mechanical interpretation",
    ", we also assume that the projection @xmath14 restricted to @xmath102 is a submersion onto @xmath99 . from the lagrangian point of view",
    ", instantaneous kinematic constraints are naturally interpreted as a submanifold @xmath104 of @xmath105 . based on these considerations , we take the following definition .    [",
    "dfn : inst - constraints ] let @xmath79 be a constrained hamiltonian system and let @xmath99 be a hypersurface of @xmath4 .",
    "a set of _ instantaneous constraints along @xmath99 _ imposed on @xmath79 is a submanifold  @xmath102 of  @xmath106 such that @xmath14 restricted to  @xmath102 is a submersion onto @xmath99 .",
    "it is worth stressing that , in some cases , a set of instantaneous constraints along @xmath99 additionally verifies the condition @xmath107 ( here @xmath105 is thought to be naturally embedded into @xmath23 ) . in an inelastic scenario , where the nonholonomic motion in @xmath4 is forced to take place in @xmath99 after the impact",
    ", this latter condition formalizes the parity between the hamiltonian and lagrangian approaches : if the hamiltonian system in question comes from a lagrangian one , then @xmath108 , with @xmath104 being the instantaneous kinematic constraints .",
    "as is well - known , in the absence of constraints , the dynamics of the hamiltonian system @xmath21 is given by the hamiltonian vector field @xmath109 , whose coordinate description is @xmath110 in the presence of constraints , the `` free '' hamiltonian vector field @xmath109 must be modified along the constraint manifold @xmath76 in order to become tangent to @xmath76 . in the traditional approach",
    "this goal is achieved by adding to @xmath109 another vector field along @xmath76 , say , @xmath111 , interpreted as the _ reaction of constraints_. from a purely geometrical point of view , the choice of a vector field that makes @xmath109 tangent to @xmath76 is far from being unique . therefore",
    ", a new principle must be invoked to select the one that merits to be called the `` reaction of constraints '' .",
    "the history of this problem ( see , for instance ,  @xcite ) shows that its solution is not straightforward . by applying , for instance , the lagrange - dalembert principle",
    "( see  @xcite ) , one gets the following equations of motion @xmath112 @xmath113 , @xmath114 , where the `` lagrange multipliers '' @xmath115 s are to be duly determined .",
    "shortcomings of such an approach are that it is not manifestly intrinsic and does not reveal clearly the geometric background of the situation .",
    "this is why in our further exposition we shall follow a purely geometric approach , which does not require any discussion of reactions of constraints .",
    "it is based on the concept of _ partial symplectic formalism _ , which also appears to be more concise from an algorithmic point of view .",
    "the following elementary facts from linear algebra will be most useful .",
    "let @xmath116 be a vector space , @xmath117 a subspace and @xmath118 a bilinear form on @xmath116 .",
    "denote by @xmath119 the @xmath120-orthogonal complement of @xmath121 , @xmath122 note that @xmath123 if and only if the restriction @xmath124 of @xmath120 to @xmath121 is nondegenerate .",
    "the form @xmath120 is said to be _ nondegenerate _ on an affine subspace @xmath125 of @xmath116 , @xmath126 , @xmath127 , if it is nondegenerate on its associated vector space @xmath121 . in such a case , @xmath125 can be uniquely represented in the form @xmath128 with @xmath129 due to the fact that @xmath130 .",
    "the vector @xmath131 is called the _ canonical displacement _ of @xmath125 with respect to  @xmath120 .",
    "consider the associated map @xmath132 in other words , @xmath133 , for all @xmath134 .",
    "obviously , @xmath135 is an isomorphism if and only if @xmath136 is nondegenerate .",
    "if @xmath120 is skew - symmetric and nondegenerate on @xmath116 , and @xmath121 is a subspace of @xmath116 with codimension one , then the kernel of the restricted form @xmath137 , @xmath138 is a 1-dimensional subspace , i.e. , a _ line _ in @xmath116 contained in @xmath121 .",
    "therefore , @xmath139 .",
    "let now @xmath56 be an affine distribution on a manifold @xmath140 .",
    "a form @xmath141 is called _ nondegenerate _ on @xmath56 if @xmath142 is nondegenerate on @xmath143 , for all @xmath144 . in such a case",
    ", there exists a unique vector field @xmath145 such that @xmath67 is the canonical displacement of @xmath57 with respect to  @xmath146 , for all @xmath144 .",
    "the vector field @xmath147 is called the _ canonical displacement _ of @xmath56 with respect to  @xmath148 .",
    "if @xmath141 is nondegenerate on @xmath56 , then one has the isomorphism of vector bundles @xmath149 passing to sections of these bundles , one gets the isomorphism of @xmath150-modules @xmath151 defined by @xmath152    [ dfn : partial - symplectic - structure ] a _ partial symplectic structure _ on a manifold @xmath140 is a pair @xmath153 consisting of an affine distribution @xmath56 on @xmath140 and a closed 2-form @xmath154 which is nondegenerate on @xmath56 .",
    "given a partial symplectic structure @xmath155 , we will use the subscript @xmath156 to denote the associated objects : @xmath157 and @xmath158 for the distribution canonically associated to @xmath56 .",
    "we also write @xmath159 in the partial symplectic formalism , the elements of @xmath150-modules @xmath160 and @xmath161 may be viewed as `` constrained '' vector fields and differential forms , respectively . the _ constrained hamiltonian vector field _ associated with a hamiltonian function @xmath162 is defined as @xmath163 the _ almost - poisson _ bracket associated to the partial symplectic structure @xmath156 is @xmath164 the wording `` almost '' here refers to the fact that this bracket does not satisfy in general the jacobi identity .",
    "however , it is still skew - symmetric and a bi - derivation .",
    "[ dfn : partial - transversal ] let @xmath165 be a partial symplectic structure on a manifold @xmath140 .",
    "a hypersurface @xmath166 is _ transversal _ to @xmath156 ( or to @xmath56 ) if the affine subspaces @xmath167 and @xmath168 of @xmath169 are transversal for any @xmath91 .    if @xmath170 is _ transversal _ to @xmath156 , then @xmath171 is of codimension @xmath172 in @xmath168 .",
    "if @xmath156 is a partial symplectic structure on @xmath101 , we shall extend this terminology by saying that @xmath156 is _ transversal _ to a hypersurface @xmath173 in @xmath11 if @xmath173 is transversal to @xmath76 , so that @xmath174 is a hypersurface in @xmath76 , and @xmath170 is transversal to @xmath156 .",
    "in this section , we formulate the dynamics of nonholonomic hamiltonian systems using the partial symplectic formalism .",
    "we show how , under some technical conditions , any hamiltonian system subject to nonholonomic constraints possesses an associated partial symplectic structure .",
    "then , we analyze the cases of systems with instantaneous nonholonomic constraints , and systems exhibiting discontinuities .",
    "let @xmath79 be a constrained hamiltonian system .",
    "our goal is to associate with it a partial symplectic structure @xmath156 on the `` constrained '' cotangent bundle @xmath76 in such a way the corresponding constrained hamiltonian field @xmath175 gives the desired nonholonomic dynamics . with this purpose , consider the _ constrained symplectic form _ defined by the restriction of the `` free '' symplectic form @xmath176 to @xmath76 @xmath177 with @xmath178 the canonical inclusion .",
    "the next step is to construct a suitable affine distribution @xmath179 on @xmath76 .",
    "a natural non - singularity requirement on @xmath76 is asking for the regularity of the map @xmath180 .",
    "this is the reason why we assume that @xmath180 is an immersion , i.e. , that the differential @xmath181 is nonsingular for any @xmath91 .",
    "since @xmath182 is fibered , this assumption implies that the map @xmath183 is an immersion for any @xmath50 and vice versa .",
    "let @xmath91 and @xmath184 .",
    "let @xmath185 be the affine subspace of @xmath186 tangent to @xmath187 at @xmath188 .",
    "since by the above assumption @xmath180 is an immersion , @xmath189 .",
    "consider the affine distribution @xmath190 on @xmath76 defined by @xmath191 since @xmath192 is surjective , the codimension of @xmath193 in @xmath194 is equal to the codimension of @xmath185 in @xmath186 , i.e. , to @xmath43 .",
    "therefore , @xmath195 .",
    "it is not difficult to see now that if the form @xmath196 is nondegenerate on the distribution  @xmath190 , then @xmath180 is an immersion .",
    "[ prop : relation ] let @xmath197 be a constrained hamiltonian system . then , @xmath180 is an immersion if the pair @xmath198 defined by equations   and   is a partial symplectic structure .    the converse , however , is in general not true . since the partial symplectic structure associated with @xmath199",
    "is determined by @xmath200 and @xmath76 , we will simply denote it by @xmath201 .    for most hamiltonian systems ( including those coming from mechanics )",
    ", the anti - legendre map @xmath35 is regular not only when restricted to @xmath76 , but on the whole space @xmath11 . in",
    "this is the case , and the hamiltonian system comes from a lagrangian system , one can indeed show that the condition of @xmath196 being nondegenerate on the distribution  @xmath190 is equivalent to the so - called _ compatibility condition _  @xcite .",
    "therefore , proposition  [ prop : relation ] establishes a link between the classical partial symplectic formalism introduced in  @xcite and more recent approaches as explained , for instance , in  @xcite .",
    "also note that the class of mechanical systems automatically verifies the compatibility condition , therefore admitting both formulations .",
    "indeed , for mechanical systems , the conditions in proposition  [ prop : relation ] are equivalent .",
    "[ dfn : nonholonomic - hamiltonian - system ] a _ nonholonomic hamiltonian system _ on a manifold @xmath4 is a constrained system @xmath79 , @xmath80 , @xmath73 such that @xmath201 is a partial symplectic structure .    the dynamics of a nonholonomic hamiltonian system is given by the constrained hamiltonian vector field @xmath202 with respect to the partial symplectic structure @xmath203 ( cf .",
    "equation  ) .",
    "this vector field will be denoted by @xmath204 . under regularity of the map @xmath35",
    ", @xmath204 reads in canonical coordinates @xmath205 where the matrices @xmath206 and @xmath207 are defined by @xmath208 observe that the _ force of reaction of nonholonomic constraints _ ( see section  [ se : dynamics ] ) in the partial symplectic framework is defined _ a posteriori _ as the difference between the constrained and the free hamiltonian vector fields , @xmath209 . also , note that the almost - poisson bracket associated with the partial symplectic structure @xmath210 coincides with the so - called nonholonomic bracket  @xcite .",
    "[ [ transversality ] ] transversality + + + + + + + + + + + + + +    it is convenient to adapt the terminology related to the notion of transversality discussed in section  [ se : partial ] to the context of nonholonomic hamiltonian systems .",
    "first , we shall say that a nonholonomic hamiltonian system @xmath199 is _ transversal _ to a hypersurface @xmath170 in @xmath11 if the underlying partial symplectic structure @xmath211 is transversal to @xmath170 .",
    "second , if @xmath99 is a hypersurface in @xmath4 , we shall say that @xmath212 is _ transversal to @xmath99 _ if @xmath212 is transversal to the hypersurface @xmath213 .",
    "the following result follows from the definition of the partial symplectic structure @xmath211 .",
    "[ prop : trans ] a nonholonomic hamiltonian system @xmath79 is transversal to a hypersurface @xmath214 if and only if @xmath215 , the affine subspace of @xmath216 tangent to @xmath217 at @xmath188 , is transversal to @xmath218 for all @xmath91 .",
    "it is intuitive to think that when a trajectory of a hamiltonian system @xmath79 crosses a _ critical _",
    "hypersurface @xmath99 in the configuration manifold @xmath4 , its phase space reduces to @xmath219 .",
    "moreover , it could possibly be subject to additional instantaneous constraints along @xmath99 . in the language of our approach ,",
    "this idea is naturally expressed by saying that all such _ critical _ states constitute a nonholonomic hamiltonian system on @xmath99 .",
    "since @xmath219 is not naturally embedded into @xmath11 , a realization of this idea is not completely straightforward .",
    "what one really needs is a partial symplectic structure on the manifold of instantaneous constraints @xmath102 which , by definition , is a submanifold of @xmath11    namely , let @xmath102 be a set of instantaneous constraints along @xmath99 imposed on @xmath79 ( cf . definition  [ dfn : inst - constraints ] ) .",
    "take @xmath220 .",
    "let @xmath184 and denote by @xmath221 the affine subspace of @xmath222 tangent to @xmath223 at @xmath224 .",
    "consider the 2-form @xmath225 and the affine distribution @xmath226 on @xmath102 defined by @xmath227 with @xmath228 the canonical inclusion .",
    "we then have the following definition .",
    "let @xmath79 be a nonholonomic hamiltonian system and let  @xmath102 be a set of instantaneous constraints along a hypersurface @xmath229 .",
    "the pair @xmath230 defined by   is called the _ instantaneous partial symplectic structure along @xmath99 _ if @xmath225 is not degenerate on @xmath226 .",
    "if this is the case ,  @xmath102 is called a _",
    "regular _ set of instantaneous constraints .",
    "note that this structure is defined by @xmath200 , @xmath102 and @xmath99 .",
    "to highlight this fact , we denote @xmath231 .",
    "accordingly , we denote by @xmath232 the constrained hamiltonian vector field @xmath233 , with @xmath234 .    in general , since @xmath235 by definition",
    ", one has that @xmath236 is an immersion . for mechanical systems",
    ", this implies that the 2-form @xmath225 is nondegenerate on @xmath226 , and therefore any set of instantaneous constraints is regular .    in what follows",
    ", we shall only deal with regular instantaneous nonholonomic constraints .",
    "a natural class of instantaneous structures arises in the following situation of particular interest .",
    "assume that the nonholonomic hamiltonian system @xmath199 is transversal to @xmath99 and that @xmath35 is regular .",
    "then @xmath237 is transversal to @xmath76 and , hence , @xmath238 is a submanifold of codimension @xmath239 in @xmath76 . note that @xmath240 is a set of instantaneous nonholonomic constraints on @xmath212 along @xmath99 . by construction ,",
    "the codimension of @xmath241 in @xmath168 is also @xmath239 and @xmath242 is nondegenerate when restricted to @xmath243 .",
    "therefore , the affine distribution @xmath244 and the 2-form @xmath245 endow @xmath240 with a partial symplectic structure , which is an instantaneous partial symplectic structure along @xmath99 .",
    "we call it the _ trace of @xmath212 on @xmath99 _ and denote it by @xmath246 . in the special case @xmath247 ,",
    "we call it the _ boundary of @xmath212 _ , and denote it by @xmath248 , i.e. , @xmath249",
    ". we will denote the constrained hamiltonian vector field with respect to the trace ( resp . , boundary ) as @xmath250 ( resp . , @xmath251 ) .",
    "an impulsive behavior of a hamiltonian system occurs when its trajectory `` tries '' to go across a _ critical _",
    "hypersurface  @xmath99 in the configuration space  @xmath4 .",
    "in such an instant , the system may be forced to drastically change its constraints , to pass under the control of another hamiltonian and/or to be eventually subject to additional instantaneous constraints .",
    "such situations may be interpreted as _",
    "discontinuities _ on both the constraints and the hamiltonian of the system .",
    "below , we formalize these concepts properly via the notion of cutting - up .",
    "[ dfn : cutting - up ] let @xmath214 be a hypersurface of @xmath4 with @xmath252 .",
    "a pair @xmath253 , @xmath254 , is called a _ cutting - up of @xmath4 along @xmath99 _ if    ( i ) : :    @xmath255 ; ( ii ) : :    @xmath256 maps @xmath257    diffeomorphically onto @xmath258 ; ( iii ) : :    @xmath259 is a double    covering of @xmath99 .",
    "note that , by definition , @xmath256 is a local diffeomorphism .",
    "cuttings - up for a given @xmath99 exist and are equivalent one to each other . if @xmath99 divides @xmath4 into two parts , say ,  @xmath260 and  @xmath261 , i.e. ,  @xmath262 , @xmath263 , then @xmath264 may be viewed as the disjoint union of  @xmath260 and  @xmath261 , and @xmath256 as the map that matches them together along the common border @xmath99 .",
    "locally any cutting - up is of this form .    for our purposes",
    ", it is important to realize that , if @xmath253 is a cutting - up of @xmath4 along @xmath99 , then @xmath265 is a cutting - up of  @xmath11 along the hypersurface @xmath213 . here , @xmath266 denotes the dual of the inverse of the isomorphism @xmath267 , for all @xmath268 . in the following definition",
    ", we introduce the class of hamiltonian systems we shall be dealing with throughout this paper .    [ dfn : discontinuous ] let @xmath214 be a hypersurface of @xmath4 with @xmath252 and let @xmath253 be a cutting - up of @xmath4 along @xmath99 .",
    "nonholonomic hamiltonian system discontinuous along @xmath99 _ , denoted @xmath269 , is the direct image with respect to @xmath266 of a nonholonomic hamiltonian system  @xmath270 .",
    "such system is called _ regular _ if @xmath270 is transversal to @xmath271 .",
    "a system of _ instantaneous nonholonomic constraints on @xmath212 along @xmath99 _ is the direct image with respect to @xmath266 of a set of instantaneous constraints  @xmath272 along @xmath271 on the associated system @xmath273 .",
    "the _ trace of @xmath212 on @xmath99 _ is the direct image with respect to @xmath266 of the trace of @xmath274 along  @xmath271 .    according to definition  [ dfn : discontinuous ]",
    ", @xmath275 is a smooth function on @xmath276 and  @xmath277 is a submanifold of @xmath276 .",
    "therefore , the _ direct image _ of @xmath275 along the matching map @xmath278 may be viewed as a function on @xmath11 , which is 1-valued and smooth outside of  @xmath279 and 2-valued and smooth on  @xmath279 .",
    "we will continue to use the notation @xmath200 for this function and will refer to it as a _ discontinuous hamiltonian along @xmath99_. similarly , the direct image  @xmath280 of  @xmath277 will be referred to as _",
    "discontinuous nonholonomic constraints along @xmath99_. outside of  @xmath279 , @xmath76 is a `` good '' smooth submanifold of @xmath11 , whose boundary is an immersed submanifold of  @xmath279 .",
    "the previous discussion becomes particularly simple when @xmath99 divides @xmath4 into two parts , @xmath260 and @xmath261 , as mentioned above .",
    "in such a case , @xmath279 also divides @xmath11 into two parts , @xmath281 and @xmath282 , whose common boundary is @xmath279 .",
    "then , a discontinuous hamiltonian @xmath200 along @xmath99 may be naturally seen as a pair of hamiltonians , say , @xmath283 and @xmath284 , defined on @xmath281 and @xmath282 , respectively .",
    "similarly , a set of discontinuous nonholonomic constraints along @xmath99 is regarded as a pair of sets of nonholonomic constraints @xmath285 .",
    "since @xmath99 always divides @xmath4 locally , this description constitutes a local picture of a discontinuous nonholonomic hamiltonian system along @xmath99",
    ".    we will continue to use the notation  @xmath102 ( resp .",
    ", @xmath286 ) for instantaneous nonholonomic constraints ( resp . , the trace of @xmath212 ) in the case of discontinuous nonholonomic systems . as before",
    ", one may interpret  @xmath102 as a 2-valued system of instantaneous nonholonomic constraints along @xmath99 . in the case when @xmath99 divides @xmath4 into two parts",
    ", we will distinguish between the two branches using the notation  @xmath287 , and write also @xmath288 ( resp . , @xmath289 ) .",
    "[ rem : boundary systems ] the impulsive behavior of a hamiltonian system is not necessarily related to some discontinuity .",
    "this type of phenomena occurs , for instance , each time that one of its trajectories `` strikes '' against the boundary @xmath290 of the configuration space @xmath4 .",
    "various kinds of collisions , impacts , etc , in mechanical systems are described in this way",
    ". otherwise said , impulsive behavior is characteristic of hamiltonian systems _ with boundary_. moreover , systems with boundary may be viewed as a `` limit '' case of discontinuous systems by dropping the requirement @xmath291 and choosing @xmath247 , @xmath292 , @xmath293 .",
    "this allows a unified approach to both situations .",
    "in this section we discuss the formulation of the transition principle for systems subject to nonholonomic constraints .",
    "we first introduce the notions of focusing points , constrained characteristics , and in , out and decisive points .",
    "the transition principle builds on these elements to prescribe the behavior of the hamiltonian system when one or more of its ingredients undergoes a drastic change .",
    "the following simple linear result will be key for the subsequent discussion .",
    "[ le : simple - linear ] let @xmath294 , and let @xmath121 be an affine subspace in @xmath295 such that @xmath242 is nondegenerate on @xmath121 ( hence , @xmath296 for certain @xmath297 ) and @xmath298 . denote by @xmath299 and @xmath300 the linear subspaces associated with the affine spaces  @xmath121 and @xmath301 , respectively",
    ". then the affine subspaces  @xmath302 and  @xmath303 in @xmath304 passing through @xmath305 are transversal .    since",
    ", by hypothesis , @xmath298 , one has @xmath306 now , the dimension of @xmath307 is  @xmath308 .",
    "moreover , @xmath309 is transversal to @xmath310 if one identifies the spaces @xmath304 and  @xmath311",
    ". the result now follows .",
    "consider now a nonholonomic hamiltonian system @xmath79 .",
    "let @xmath312 .",
    "denote by @xmath313 be the affine distribution of the corresponding partial symplectic structure @xmath211 ( cf . section  [ se : partial - ass ] ) . by definition  [ dfn : nonholonomic - hamiltonian - system ] ,",
    "the affine subspace @xmath314 satisfies the assumptions of lemma  [ le : simple - linear ] on @xmath121 ( observe that @xmath301 is precisely @xmath185 in equation  ) .",
    "therefore , the subspace @xmath315 is well - defined and we put @xmath316 moreover , it is not difficult to see that the subspace @xmath317 is identical to @xmath318 .",
    "this shows that  @xmath319 is transversal to  @xmath76 at @xmath305 , and that  @xmath320 .",
    "the _ crown of the nonholonomic hamiltonian system @xmath79 _ is the map @xmath321 where @xmath322 denotes the manifold whose elements are @xmath323-dimensional affine submanifolds contained in the fibers of the cotangent bundle @xmath11 .",
    "one can see that the graph of the crown @xmath324 , @xmath325 is a @xmath326-dimensional smooth submanifold of @xmath327 . note that @xmath328 is a fiber bundle over @xmath76 with projection @xmath329 the fiber over @xmath305 of this bundle is precisely @xmath319 .",
    "since @xmath330 , the map @xmath331 is a section of @xmath332 . since the fibers of @xmath332 are affine spaces , the bundle @xmath333 has a natural vector bundle structure whose zero section is @xmath334 .",
    "moreover , this vector bundle is canonically isomorphic to the normal bundle of @xmath76 in @xmath11 .",
    "this is due to the fact that , for any @xmath91 , the fiber @xmath319 is transversal to @xmath76 at @xmath305 .",
    "the same argument also guarantees that the map @xmath335 induces a diffeomorphism of a neighborhood of the `` zero '' section @xmath336 in @xmath328 onto its image .",
    "[ dfn : focusing ] let @xmath79 be a nonholonomic hamiltonian system .",
    "given a point @xmath337 , its @xmath338-_focusing locus _",
    "@xmath339 is the set of all points @xmath91 such that @xmath340 . in other words , @xmath341 a point in @xmath339 is called _ focusing for @xmath342_.    standard arguments show that @xmath343 is regular , i.e. , of maximal rank @xmath326 almost everywhere , that is , with the exception of a closed subset without interior points .",
    "therefore , for a generic point @xmath337 , the subset @xmath344 is discrete , and so is @xmath339 as well .",
    "note also that if @xmath345 , then @xmath346 .",
    "focusing points can be understood as _ nonintegrable _",
    "analogs of the notion of _ reducing points _ considered in  @xcite in connection with the transition principle for inelastic collisions .",
    "it is worth noticing that the concept of a focusing point makes also sense in the absence of constraints . obviously , in this case @xmath347 .",
    "therefore there is no need to distinguish between the constrained and non - constrained cases in the statement of the transition principle .",
    "if the constraints are linear , i.e. , @xmath348 with @xmath75 a linear codistribution and @xmath77 ( the displacement form ) , then for each @xmath294 , @xmath349 where @xmath350 .",
    "denote the corresponding projectors by @xmath351 and @xmath352 .",
    "given @xmath353 , one has that @xmath354 if and only if @xmath355 and  @xmath356 . since @xmath357 , one has the following result .",
    "[ prop : focusing - affine ] let @xmath79 be a nonholonomic hamiltonian system with linear constraints . then , for @xmath358 , there is a unique focusing point given by @xmath359 .",
    "we will also need an instantaneous version of the notion of a focusing point introduced in the previous section .",
    "for this purpose , it is sufficient to apply the above construction to instantaneous constraints instead of to the `` usual '' ones .",
    "namely , let @xmath102 be a system of regular instantaneous constraints along @xmath99 ( see section  [ se : inst - constraints ] ) and @xmath360 be the corresponding affine distribution ( see section  [ se : inst - partial ] ) . following the same reasoning as above",
    ", the affine subspace @xmath361 satisfies the assumptions of lemma  [ le : simple - linear ] .",
    "therefore , the affine subspace @xmath362 of @xmath295 is well - defined , and we have all the ingredients to define the notion of instantaneous crown and instantaneous focusing point of a system subject to instantaneous nonholonomic constraints . for completeness",
    ", we state the latter .",
    "[ dfn : focusing.instantaneous ] let @xmath79 be a nonholonomic hamiltonian system and let @xmath102 be a set of instantaneous constraints along a hypersurface @xmath229 .",
    "given a point @xmath363 , its @xmath364-_instantaneous focusing locus _",
    "@xmath365 is the set of all points @xmath366 such that @xmath367 .",
    "in other words , @xmath368 a point in @xmath365 is called _ instantaneous focusing for @xmath342_.    as before , if the instantaneous nonholonomic constraints are linear @xmath369 , then for each @xmath370 , @xmath371 where @xmath372 . denoting the corresponding projectors by @xmath373 and @xmath374 , one has the following result .",
    "[ prop : instantaneous - focusing ] let @xmath79 be a nonholonomic hamiltonian system and let @xmath102 be a set of instantaneous affine constraints along a hypersurface @xmath229 .",
    "then , for @xmath358 , there is a unique instantaneous focusing point given by @xmath375 .",
    "consider then a partial symplectic structure @xmath155 on a manifold @xmath76 which is transversal to a hypersurface @xmath376 ( cf .",
    "definition  [ dfn : partial - transversal ] ) .",
    "let @xmath65 denote the linear distribution associated with @xmath56 .",
    "for each @xmath377 , consider the linear space @xmath378 , the hyperplane @xmath379 of @xmath116 and the nondegenerate skew - symmetric form @xmath380 .",
    "characteristic direction at @xmath381 _ is defined as @xmath382 the proof of the following result is straightforward .    given a partial symplectic structure @xmath155 on a manifold @xmath76 and a hypersurface @xmath383 transversal to it , the distribution @xmath384 is one - dimensional .    given a partial symplectic structure @xmath155 on @xmath76 and a hypersurface @xmath383 transversal to it , @xmath384 is called the _",
    "characteristic distribution with respect to @xmath385 _ , and its integral curves , denoted by @xmath386 , are the _",
    "@xmath385-characteristics_.    we are particularly interested in the case when we have a nonholonomic hamiltonian system @xmath199 , the partial symplectic structure @xmath156 is @xmath210 , @xmath99 is a hypersurface in @xmath4 and @xmath387 , @xmath388 .",
    "we will use the terminology @xmath389- or @xmath390-_characteristic _ as a substitute for @xmath385-characteristic .",
    "it should be emphasized that @xmath390-characteristics are only defined when @xmath212 is transversal to @xmath99 ( see section  [ se : partial - ass ] ) .    in the absence of constraints ,",
    "i.e. , when @xmath391 is a symplectic manifold , and @xmath68 is the trivial distribution @xmath392 on @xmath76 , the characteristic curves are precisely the characteristics introduced in  @xcite",
    ". we will refer to _ non - constrained characteristics _ and _ constrained characteristics _ when it is necessary to distinguish between the unconstrained and the constrained cases .",
    "just as non - constrained characteristics play a key role in describing holonomic elastic collisions , and reflection and refraction phenomena of rays of light  @xcite , the constrained characteristics will be fundamental in describing the `` elastic part '' of nonholonomic impulsive phenomena .",
    "what is meant by `` elastic part '' will become clear in section  [ se : decisive ] when describing decisive points .    if the constraints @xmath76 are affine , then the @xmath390-characteristic passing through a point @xmath393 , @xmath394 , is described in a particularly simple way .",
    "namely , following proposition  [ prop : trans ] , it is not difficult to see that the @xmath390-characteristic passing through @xmath305 is given by @xmath395 with @xmath75 being the linear codistribution associated to @xmath76 .",
    "in particular , in the absence of constraints , @xmath396 and the characteristics are straight lines in @xmath397 parallel to @xmath398 , @xmath399 .      here , we first introduce some concepts concerning the behavior of a vector field in a neighborhood of the boundary of its supporting manifold .",
    "we then discuss the notions in , out and trapping points .",
    "let @xmath140 be a manifold with boundary and @xmath28 a vector field on @xmath140 .",
    "a point @xmath400 is called a _",
    "@xmath401th order in point for @xmath28 _ if there exists a trajectory of @xmath28 , @xmath402\\rightarrow q$ ] , @xmath403 such that @xmath404 and @xmath405 is @xmath401th order tangent to @xmath406 at @xmath305 .",
    "@xmath401th order out point for @xmath28 _ is a @xmath401th order in point for @xmath407 . in the dynamical context",
    "we have in mind , in and out points of @xmath408th order are the most important .",
    "it is easy to see that @xmath409 is a @xmath408th order in point ( resp .",
    ", out point ) for @xmath28 if the vector @xmath410 is transversal to @xmath406 and directed inside ( resp . ,",
    "outside ) of @xmath140 . a point that lies on a trajectory of @xmath28 which is entirely contained in @xmath406 is called a _ trapping point for @xmath28_.    let @xmath411 denote the subset of all points of @xmath406 where @xmath28 is @xmath401th order tangent to @xmath406 , and @xmath412 ( resp .",
    ", @xmath413 ) the set of all @xmath401th order in points ( resp .",
    ", out points ) for @xmath28 .",
    "note that @xmath414 and @xmath415 in a generic situation , @xmath416 is a submanifold ( with singularities ) of codimension @xmath401 in @xmath406 , which is divided by @xmath417 into two parts , @xmath418 and @xmath419 . an analytical description of the previous discussion is obtained by choosing a smooth function @xmath420 on @xmath140 with @xmath421 and @xmath422 , for all @xmath423 such that @xmath424 ( which always exists locally ) . then @xmath425 the vector field @xmath28 is said to be _ regular with respect to @xmath406 _ when the inclusion in equation   is an equality for all @xmath426 .",
    "this is a generic property of vector fields .",
    "in such a case , the chain of inclusions @xmath427 is a _ stratification _ of @xmath406 whose strata are @xmath428 and @xmath429 .",
    "note also that the set of trapping points precisely corresponds to @xmath430 .",
    "consider now a discontinuous nonholonomic hamiltonian system @xmath431 and the corresponding cutting - up @xmath253 .",
    "then we can resort to the previous discussion with the manifold @xmath432 and the vector field @xmath433 . recall that @xmath434 and @xmath435 .",
    "[ dfn : in - out ] let @xmath269 be a discontinuous nonholonomic system and denote by @xmath253 the associated cutting - up .",
    "a point @xmath436 is called an _ in point _",
    ", an _ out point _ ) of @xmath212 if there exists @xmath437 such that @xmath438 and @xmath439 is an in point ( resp .",
    ", an out point ) of @xmath440 with respect to @xmath441 .    by definition ,",
    "the map @xmath266 restricted to @xmath441 is an immersion .",
    "a point in @xmath442 may turn out to be an in and an out point at the same time . to resolve this ambiguity ,",
    "the branch of @xmath266 to which such a point belongs must be taken into consideration .",
    "this distinction is easily described in the case when @xmath99 divides @xmath4 into two parts .",
    "in fact , in this case the system @xmath431 may be viewed as a couple of nonholonomic hamiltonian systems @xmath443 , with the common boundary @xmath444 , and where @xmath445 and @xmath446 ( cf .",
    "section  [ se : discontinuity ] ) .",
    "an in ( resp . , out , or trapping ) point of the vector field @xmath447 with respect to the boundary @xmath448 is called an _ plus - in _ ( resp .",
    ", _ plus - out _ , or _ plus - trapping ) _ _ point_. analogous definitions are established for @xmath449 . in this way , the notions of plus - in point , minus - in point , etc , introduced in  @xcite for the unconstrained situation are generalized to the constrained case . finally , we observe that @xmath99 always divides @xmath4 locally , and therefore the previous discussion is always valid locally .      at this point , we are ready to introduce the key notion of decisive point corresponding to an out point .",
    "the construction of decisive points depends on two elements : first , the mode ( elastic or inelastic ) in which the system passes through the critical state and , second , the continuity and differentiability properties of the hamiltonian .",
    "below , we will limit our discussion to the two most relevant situations , just to avoid not very instructive technicalities arising in the most general context .",
    "the first one is the case when the hamiltonian is smooth and only the constraints are discontinuous along the critical hypersurface .",
    "the second one concerns discontinuous hamiltonians and not necessarily discontinuous constraints .",
    "it is worth stressing that the first situation can not be considered as a particular case of the second one , i.e. , that the notion of a decisive point is not `` continuous '' in this sense .",
    "in what follows , @xmath450 and @xmath451 stands for the opposite sign to @xmath452 . throughout the section ,",
    "instantaneous constraints are assumed to be regular .      here",
    ", we deal with a discontinuous nonholonomic system @xmath453 , where the hamiltonian function is smooth , @xmath454 .",
    "[ dfn : decisive - change - constraints ] let @xmath453 be a regular discontinuous nonholonomic system , with @xmath454 and consider a set of instantaneous constraints @xmath102 along @xmath99 .",
    "let @xmath305 be an @xmath452-out point of the system .",
    "a sequence @xmath455 , @xmath456 , with @xmath457 is called @xmath458-_admissible _ if it verifies the following conditions :    ( i ) : :    @xmath459 ; ( ii ) : :    for all @xmath460 , @xmath461 is a focusing point    for @xmath462 with respect to either    @xmath463 or , if instantaneous    constraints are absent , @xmath464 ; ( iii ) : :    @xmath462 is an @xmath465-out point for all    @xmath460 and @xmath466 is either an    @xmath467-in point or an    @xmath467-trapping point ; ( iv ) : :    the sequence of signs @xmath468 alternates ,    i.e. , @xmath469 .",
    "the _ end _ point of an @xmath458-admissible sequence , @xmath470 , is called @xmath458-_decisive _ and the constrained hamiltonian vector field @xmath471 is referred to as the vector field _ corresponding _ to it .",
    "[ rem : chattering ] the above formal description of decisive points is equivalent to the following iterative procedure .",
    "take , for instance , a plus - out point @xmath305 .",
    "then , according to definition  [ dfn : decisive - change - constraints ] , all focusing with respect to @xmath472 ( resp .",
    ", to @xmath473 ) minus - in and minus - trapping points are decisive . on the other hand",
    ", the procedure continues by restarting from any of the remaining focusing points that are minus - out points , and so on . in some situations ,",
    "this process may turn out to be infinite . at the present time , however , it is not clear whether that kind of phenomena can occur , say in propagation of singularities or similar processes .      in this case , decisive points are constructed on the basis of an iterative procedure whose single steps are either of _ reflective _ or of _ refractive _ type , as described below . consider a regular discontinuous nonholonomic system @xmath474 , which might be subject to additional instantaneous constraints @xmath102 along @xmath99 .",
    "let @xmath475 be an @xmath452-out point .",
    "[ [ reflective - step ] ] reflective step + + + + + + + + + + + + + + +    1-st move : : :    @xmath476 , where @xmath439 is a point in the    constrained characteristic    @xmath477 such that    @xmath478 .",
    "2-nd move : : :    @xmath479 , where @xmath342 is a focusing    point for @xmath439 with respect to either    @xmath480 or , if    @xmath452-instantaneous constraints are absent ,    @xmath481 .",
    "[ [ refractive - step ] ] refractive step + + + + + + + + + + + + + + +    1-st move : : :    @xmath476 , where @xmath439 is a point of the    constrained characteristic @xmath482 and such that    @xmath483 .",
    "2-nd move : : :    @xmath479 , where @xmath342 is a focusing    point for @xmath439 with respect to either    @xmath484 or , if    @xmath451-instantaneous constraints are absent ,    @xmath473 .    with a slight abuse of language",
    ", we shall say that @xmath458 is the _ initial point of the step _ and @xmath485 ( resp . , @xmath486 )",
    "end point of the step _ if the scenario is reflective ( resp . , refractive ) .",
    "[ dfn : decisive - dis - elastic ] consider a regular discontinuous nonholonomic system @xmath453 .",
    "let @xmath102 be a set of instantaneous constraints along @xmath99 .",
    "let @xmath305 be an @xmath452-out point .",
    "a sequence @xmath455 , @xmath456 , is called @xmath458-_admissible _ if    ( i ) : :    @xmath459 ; ( ii ) : :    @xmath455 and    @xmath487 are the initial and the end    points of a step , respectively ; ( iii ) : :    @xmath462 is an @xmath465-out point ,    @xmath488 , and @xmath466 is an    @xmath467-in point or an    @xmath467-trapping point .",
    "the end point @xmath489 of an admissible sequence is called @xmath458-decisive and the constrained hamiltonian vector field @xmath490 is referred to as the vector field _ corresponding _ to it .",
    "if the hamiltonian is discontinuous and the constraints are linear , i.e. , @xmath73 is a smooth linear submanifold , and the instantaneous constraints are absent , the previous definition of decisive points becomes much simpler , as the following result shows .",
    "[ prop : decisive - change - hamiltonian ] let @xmath453 be a regular discontinuous nonholonomic hamiltonian system with smooth linear constraints .",
    "let @xmath305 be an @xmath452-out point .",
    "the @xmath491-_decisive _ points are the in and the trapping points belonging to the intersection of the constrained characteristic @xmath492 passing through @xmath305 with the set @xmath493 .",
    "let @xmath305 be an @xmath452-out point and denote by @xmath494 ( resp , @xmath495 ) the points belonging to the intersection of the constrained characteristic @xmath492 passing through @xmath305 with the set @xmath496 ( resp . with @xmath497 ) . since the constraints are smooth , then @xmath498 in the @xmath239nd - move of both a reflective and a refractive step .",
    "now , for any @xmath499 , the intersection of the constrained characteristic passing @xmath500 through @xmath501 with the set @xmath502 ( resp . with @xmath503 ) is again @xmath494 ( resp , @xmath495 ) .",
    "the same observation holds for any @xmath504 , @xmath505 .",
    "the result now follows from definition  [ dfn : decisive - dis - elastic ] .",
    "[ rem : decisive - boundary ] the introduced terminology remains valid for nonholonomic systems with boundary ( cf .",
    "remark  [ rem : boundary systems ] ) .",
    "in such a case , one has to formally put @xmath506 this type of geometric data occurs in describing various collision phenomena .",
    "as in the elastic case , we first deal with the case when the hamiltonian @xmath200 is smooth . we treat an inelastic behavior of the system as the passage under the control of either the instantaneous discontinuous nonholonomic system or , if instantaneous constraints are absent , the discontinuous boundary system . in this and subsequent sections , the following shorthand notation will be used ( cf .",
    "sections  [ se : inst - partial ] and  [ se : discontinuity ] ) @xmath507 we also use this notation when the hamiltonian  @xmath200 is smooth , i.e. , @xmath508 .",
    "[ dfn : decisive - change - inelastic ] consider a regular discontinuous nonholonomic system @xmath453 .",
    "let @xmath102 be a set of instantaneous constraints along @xmath99 .",
    "let @xmath305 be an @xmath452-out point .",
    "an @xmath458-_decisive point _ is a focusing point for @xmath305 with respect to either @xmath509 or , if the instantaneous constraints are absent , @xmath510 .",
    "the constrained hamiltonian vector field @xmath511 , respectively , @xmath512 is referred to as the _ corresponding _ vector field .      as in the elastic case ,",
    "decisive points are constructed on the basis of _ reflective _ or _ refractive _ steps , as we now describe .",
    "[ [ reflected - falling - step ] ] reflected falling step + + + + + + + + + + + + + + + + + + + + + +    1-st move : : :    @xmath476 , where @xmath439 is a point of the    constrained characteristic @xmath513 such that @xmath514 .",
    "2-nd move : : :    @xmath479 , where @xmath342 is a focusing    point for @xmath439 with respect to either    @xmath515 or , if    @xmath452-instantaneous constraints are absent ,    @xmath516 .",
    "[ [ refracted - falling - step ] ] refracted falling step + + + + + + + + + + + + + + + + + + + + + +    1-st move : : :    @xmath476 , where @xmath439 is a point of the    constrained characteristic @xmath517 such that    @xmath518 .",
    "2-nd move : : :    @xmath479 , where @xmath342 is a focusing    point for @xmath439 with respect to    @xmath519 or , if    @xmath451-instantaneous constraints are absent ,    @xmath510 .",
    "we shall refer to @xmath485 ( resp .",
    ", @xmath486 ) as a _ reflected _ ( resp .",
    "_ refracted _ ) _ falling point_.    [ dfn : decisive - dis - inelastic ] consider a regular discontinuous nonholonomic system @xmath453 .",
    "let @xmath102 be a set of instantaneous constraints along @xmath99 .",
    "let @xmath305 be an @xmath452-out point .",
    "an @xmath458-_decisive _ point is a falling point for @xmath305 .",
    "the vector field @xmath520 ( resp . , @xmath521 if @xmath522 ) is called the vector field _ corresponding _ to a reflected falling point .",
    "the vector field @xmath511 ( resp .",
    ", @xmath512 if @xmath523 ) is called the vector field _ corresponding _ to a refracted falling point .      from a physical point of view",
    ", the transition principle formulated below is an explicit description of the discontinuity of a trajectory of a regular nonholonomic hamiltonian system @xmath212 that occurs when it traverses a _",
    "critical state_. such a discontinuity is interpreted as an impact , collision , reflection , refraction , etc , depending on the physical situation modeled by the system  @xmath212 . from a mathematical point of view",
    ", the transition principle corresponds to the definition of the trajectory of a regular discontinuous nonholonomic hamiltonian system .",
    "the elastic or inelastic character of the impulsive motions of an specific physical system must be taken into account when defining the trajectories . accordingly",
    ", there are two different versions of the transition principle that distinguish between the two situations .",
    "let @xmath474 stand for a regular discontinuous nonholonomic system and let @xmath102 be eventual instantaneous constraints imposed on @xmath212 along @xmath99 .",
    "let @xmath253 be the associated cutting - up of @xmath4 along @xmath99 ( cf .",
    "section  [ se : discontinuity ] ) .",
    "regular part of a trajectory of the system @xmath524 _ is the part of the trajectory of the hamiltonian vector field @xmath440 that lies outside @xmath525 .",
    "regular part of a trajectory of @xmath212 _ is the image by @xmath256 of the regular part of the corresponding trajectory of  @xmath274 .",
    "at least locally , the regular part may be viewed as a piece of the trajectory of the vector field @xmath526 that lies outside the hypersurface @xmath279",
    ".    * transition principle . * _ let @xmath474 be a regular discontinuous nonholonomic system and let @xmath102 be eventual instantaneous constraints on @xmath212 along @xmath99 . if a regular trajectory of the vector field @xmath526 , @xmath527 reaches the critical hypersurface @xmath528 at a point @xmath305 , it then continues its motion from any @xmath458-decisive point according to the chosen mode , elastic or inelastic , under the control of the corresponding constrained hamiltonian vector field .",
    "_    some features of the transition principle are worth mentioning .",
    "first of all , it prescribes a _ splitting of the trajectory _ when the number of decisive points is greater than one . of course , it is difficult to imagine that a true mechanical system `` goes into pieces '' when reaching the critical hypersurface .",
    "but it may perfectly happen when a hamiltonian system describes the propagation of singularities in a fields or a continuum media .",
    "a classical example one finds in geometrical optics when a light ray passing from one optic medium to another splits into reflected and refracted rays ( see , for instance ,  @xcite ) .",
    "the trajectory may also be _ trapped _ by the critical hypersurface .",
    "this happens when an `` impact '' state @xmath305 possesses no @xmath305-decisive points .",
    "in this section , we particularize the previous discussion to mechanical systems subject to affine constraints .",
    "let @xmath529 be a riemannian metric on @xmath4 and @xmath530 , and consider the mechanical system whose kinetic energy and potential function are @xmath531 and @xmath116 , respectively .",
    "the corresponding lagrangian function is @xmath532 and the hamiltonian one is @xmath533 where @xmath534 , and @xmath535 is the co - metric , i.e. , the metric on the cotangent bundle induced by @xmath529 . in a local chart @xmath536 on @xmath4 , the local expressions of @xmath529 and @xmath535 are @xmath537 in the mechanical case , the legendre transform @xmath538 is a linear bundle mapping whose local description is @xmath539 .",
    "consider an affine distribution @xmath540 in @xmath11 determining some nonholonomic constraints on the system @xmath21 .",
    "the linearity of @xmath541 implies that the space @xmath542 is a distribution of affine spaces on @xmath4 , or otherwise said , that @xmath543 is a linear distribution on  @xmath4 . throughout this section",
    ", we will often resort to the shorthand notation @xmath544 and @xmath545 .",
    "now , it is easy to verify that @xmath546 , with associated projectors @xmath547 let @xmath548 be 1-forms such that ( locally ) @xmath549 .",
    "define the local function @xmath550 by @xmath551 .",
    "then @xmath92 is locally defined by the equations @xmath552 now , consider the matrices @xmath553 from the discussion after proposition  [ prop : relation ] , recall that @xmath554 is a partial symplectic structure if and only if @xmath180 is an immersion , or , equivalently , if the compatibility condition is verified . following  @xcite ,",
    "the latter is equivalent to the matrix @xmath555 being invertible .",
    "a direct computation give the following local expression for the projectors @xmath556 and @xmath557 , @xmath558 finally , let @xmath229 be a hypersurface and assume that the nonholonomic system @xmath199 is transversal to @xmath99 .",
    "consider also a set of instantaneous nonholonomic linear constraints @xmath559 imposed on @xmath212 along @xmath99 .",
    "note that @xmath560 , with associated projectors @xmath561      since the mechanical system is subject to an affine distribution of constraints , proposition  [ prop : focusing - affine ] implies that for a given @xmath353 , the focusing locus is @xmath562 .",
    "regarding the instantaneous focusing points , according to proposition  [ prop : instantaneous - focusing ] one has that @xmath563 .",
    "here we give an explicit description of the characteristic curves .",
    "let @xmath99 be the critical hypersurface , and assume that ( locally ) @xmath564 , with @xmath565 verifying that @xmath566 for all @xmath567 .",
    "consider the covector field @xmath568 along @xmath99 defined as @xmath569 .",
    "the transversality assumption between @xmath76 and @xmath99 implies that @xmath570 , for all @xmath571 .",
    "clearly @xmath572 .",
    "in addition , for @xmath573 , @xmath574 and one can conclude that @xmath575 .",
    "therefore , we have the following result .    [",
    "le : characteristic - mechanical ] the constrained characteristic of a mechanical system @xmath453 passing through @xmath576 is given by @xmath577 .",
    "note that in the absence of constraints one recovers the standard non - constrained characteristic @xmath578 passing through @xmath305 .",
    "let @xmath579 be two affine constraint submanifolds .",
    "denote by @xmath580 and @xmath581 the projectors corresponding to @xmath582 and the co - metric @xmath535 .",
    "let @xmath583 be a @xmath452-out point , @xmath584 . then , according to definition  [ dfn : decisive - change - constraints ] , an @xmath305-admissible sequence , @xmath455 , @xmath456 , is necessarily of the form @xmath585 .",
    "if instantaneous constraints are present , then one has to use the projectors @xmath586 and @xmath587 instead of @xmath588 and @xmath589 , respectively .",
    "mechanical systems subject to generalized constraints are also treated in  @xcite in a somehow different context .",
    "the approach taken there makes use of generalized ( i.e. non - constant rank ) codistributions defining the nonholonomic constraints and a generalized version of newton s second law . under appropriate regularity conditions",
    ", it can be seen that the ` post - impact ' point in  @xcite is a decisive point of the hamiltonian system according to definition  [ dfn : decisive - change - constraints ] .",
    "let @xmath579 be two affine constraint submanifolds .",
    "let @xmath590 be a riemannian metric on @xmath591 and @xmath592 such that @xmath593 for simplicity , we only treat the case @xmath594 , @xmath595 .",
    "we denote by @xmath580 and @xmath581 the projectors corresponding to @xmath582 and the co - metric @xmath596 .",
    "additionally , let @xmath597 be affine constraint submanifolds corresponding to some instantaneous constraints imposed along @xmath99 .",
    "denote by @xmath598 and @xmath599 the projectors corresponding to  @xmath287 and the co - metric  @xmath596 .",
    "let @xmath600 be an @xmath452-out point .",
    "following definition  [ dfn : decisive - dis - elastic ] , we first describe the reflective and refractive steps with initial point @xmath458 . according to lemma  [ le : characteristic - mechanical ]",
    ", we have to look for points of the form @xmath601 for some @xmath602 , which in addition belong to the same @xmath200-energy level as  @xmath305 .    [",
    "[ reflective - step-1 ] ] reflective step + + + + + + + + + + + + + + +    concerning the 1-st move , note that @xmath603 and @xmath305 belong to @xmath604",
    ". then , the equality @xmath605 implies that @xmath606 .",
    "now , @xmath607 and , therefore , we have @xmath608 with solutions @xmath609    an important property of these points is contained in the following lemma .",
    "[ le : general ] let @xmath583 and @xmath610 be the constant given by  .",
    "then , @xmath611    the first statement follows by noting that if @xmath612 , then @xmath613 . for the second one ,",
    "notice that @xmath614 which gives the desired result .",
    "the 2-nd move simply consists of determining the focusing points for points   with respect to @xmath615 or , if @xmath616-instantaneous constraints are absent , with respect to @xmath617 .",
    "this is done in terms of the corresponding projectors , exactly as explained in section  [ se : focusing - mechanical ] above .",
    "[ [ refractive - step-1 ] ] refractive step + + + + + + + + + + + + + + +    concerning the 1-st move , the equality @xmath618 implies @xmath619 .",
    "now , @xmath620 therefore , one has @xmath621 with solutions @xmath622 , @xmath623    as before , the 2-nd move simply consists of computing the focusing points for the solutions   with regards to @xmath484 or , if @xmath451-instantaneous constraints are absent , @xmath473 .",
    "this is done in terms of the corresponding projectors according to section  [ se : focusing - mechanical ] .      in this situation",
    ", there is a single constraint submanifold @xmath76 , and a discontinuous hamiltonian @xmath624 on @xmath11 .",
    "denote by @xmath580 and @xmath581 the projectors corresponding to @xmath76 and the co - metrics  @xmath625 , respectively . according to proposition  [ prop : decisive - change - hamiltonian ] ,",
    "the decisive points for a given @xmath452-out point @xmath626 are simply the in and trapping points belonging to the intersection of the constrained characteristic @xmath492 passing through @xmath305 with the set @xmath627 .",
    "therefore , as candidate @xmath452-decisive points we have the solution corresponding to @xmath610 in  , and as candidate @xmath451-decisive points we have the solutions corresponding to @xmath628 , @xmath622 , in  .",
    "[ prop : duality ] let @xmath600 be a @xmath452-out point .",
    "if the constraints are linear , @xmath629 , then the solution corresponding to @xmath610 in   is a @xmath452-decisive point for @xmath305 .",
    "the basic observation is the second order character of the dynamics , both in the presence and in the absence of nonholonomic constraints .",
    "this implies that for any @xmath630 and any distribution of affine constraints @xmath76 , we have @xmath631 , since @xmath420 is only a function of the configurations .",
    "note that if @xmath200 is of mechanical type , then @xmath632 , for any @xmath633 .",
    "now , from lemma  [ le : general ] , taking @xmath634 , one gets @xmath635 since @xmath305 is a @xmath452-out point , then @xmath636 .",
    "consequently , @xmath637 has the opposite sign , and hence it is an in point .",
    "let @xmath579 be two affine constraint submanifolds and let @xmath102 be a set of instantaneous affine constraints .",
    "we denote by @xmath638 and @xmath639 the projectors corresponding to @xmath640 and the co - metric @xmath535 .",
    "if the instantaneous constraints are absent , denote by @xmath580 and @xmath581 the projectors corresponding to @xmath641 and the co - metric @xmath535 .",
    "let @xmath600 be a @xmath452-out point , @xmath584 . then , according to definition  [ dfn : decisive - change - inelastic ] , the unique @xmath305-decisive point is @xmath642 ( or , if there are no instantaneous constraints , @xmath643 ) .      as in section  [ se : mechanical - decisive - elastic - hamiltonian ] ,",
    "let @xmath579 be two affine constraint submanifolds , @xmath590 a riemannian metric on @xmath591 and @xmath644 such that equation   is verified . for simplicity , we only treat the case @xmath594 , @xmath595 .",
    "we denote by @xmath580 and @xmath581 the projectors corresponding to @xmath582 and the co - metric @xmath596 .",
    "additionally , let @xmath597 be affine constraint submanifolds corresponding to some instantaneous constraints imposed along @xmath99 .",
    "we denote by @xmath645 and @xmath646 the projectors associated with the submanifold @xmath515 and the co - metric @xmath647 . in the absence of instantaneous constraints , we denote by @xmath648 and @xmath649 the projectors associated with the submanifold @xmath650 and the co - metric @xmath647 . in case @xmath651 , we denote the latter with the superscript `` @xmath652 '' instead of `` tr '' .",
    "let @xmath653 be an @xmath452-out point .",
    "the points associated with @xmath305 resulting from the 1-st moves in a reflected or a refracted falling step are given , respectively , by equations   and  . as before , the 2-nd move simply consists of computing the focusing points for these solutions with respect to @xmath515 for a reflected falling step ( respectively , @xmath519 for a refracted falling step ) or , if the instantaneous constraints are absent , @xmath654 ( respectively , @xmath510 ) .",
    "this is done in terms of the corresponding projectors according to section  [ se : focusing - mechanical ] .",
    "according to definition  [ dfn : decisive - dis - inelastic ] , this gives all the @xmath305-decisive points .",
    "[ prop : decisive - dis - inelastic ] let @xmath653 be an @xmath452-out point and assume that the constraints are linear . for @xmath651 , the unique @xmath305-reflected falling point is given by @xmath655 ( or , in the absence of @xmath452-instantaneous nonholonomic constraints , @xmath656 ) .",
    "from the previous discussion , we know that the points in the constrained characteristic passing through @xmath305 with the same @xmath657-energy level are @xmath305 itself and @xmath658 , @xmath659 ( cf . equation  ) .",
    "now , note that @xmath660 belongs to the @xmath661-orthogonal complement of @xmath662 , i.e. @xmath663 using the equality @xmath664 , we have that @xmath665 implies @xmath666 and @xmath667 .",
    "the result is then a consequence of definition  [ dfn : decisive - dis - inelastic ] .      in this section ,",
    "we discuss the consequences regarding the energy behavior of the system that result from the application of the transition principle .",
    "[ le : simple ] given @xmath668 , let @xmath669 , @xmath670 be the associated @xmath305-focusing point with respect to a submanifold @xmath101",
    ". then @xmath671 and the equality holds if and only if @xmath305 belongs to @xmath75 .",
    "note that @xmath672 where we have used that @xmath535 is positive - definite , and the fact that @xmath75 and @xmath40 are orthogonal spaces with respect to the co - metric @xmath535 .",
    "if the equality holds , then @xmath673 , which is equivalent to @xmath674 .    as a consequence of this simple lemma",
    "we can conclude that in the case of linear constraints the transition principle always implies a loss of energy .",
    "this is a suitable generalization to constrained systems of the classical carnot theorem for systems subject to impulsive forces  @xcite .",
    "suppose that the hamiltonian system is subject to nonholonomic constraints given by a linear distribution .",
    "then the transition principle implies always a loss of energy as the result of an `` impact '' .    under linear constraints , note that @xmath675 . from lemma  [",
    "le : simple ] , we get @xmath676 with @xmath677 .",
    "the result now follows from the formulation of the transition principle and the definitions of decisive points in section  [ se : decisive ] ( cf .",
    "definitions  [ dfn : decisive - change - constraints]-[dfn : decisive - dis - inelastic ] ) .    under linear constraints ,",
    "the trajectory of the system maintains the same energy level after the application of the transition principle in the following cases :    1 .",
    "when the decisive points are determined according to definitions  [ dfn : decisive - change - constraints ] and  [ dfn : decisive - change - inelastic ] and the impact point @xmath678 belongs to @xmath679 ; and 2 .   when the constraints are smooth , and therefore the decisive points are determined according to proposition  [ prop : decisive - change - hamiltonian ] .",
    "if the decisive points are determined according to definitions  [ dfn : decisive - dis - elastic ] and  [ dfn : decisive - dis - inelastic ] , then nothing can be said in general .",
    "the refractive steps will typically imply an energy decrease .",
    "this type of energy arguments also allows to discard as follows the possibility of chattering when computing the @xmath305-decisive points if the constraints change ( see definition  [ dfn : decisive - change - constraints ] and remark  [ rem : chattering ] above ) .",
    "let @xmath680 .",
    "assume there is an infinite @xmath305-admissible sequence @xmath455 , @xmath681 .",
    "for each @xmath3 , we have that @xmath682 , since otherwise @xmath683 which together with the fact that @xmath462 is a @xmath465-out point , implies that @xmath461 is a @xmath684-in point .",
    "the latter contradicts the definition of admissible sequence . as a consequence of lemma  [",
    "le : simple ] , we then have @xmath685 the limit of this sequence is zero , which implies that the @xmath305-decisive point corresponding to such a sequence would be @xmath408 , that is , the trajectory would get ` stuck ' when reaching  @xmath99 .",
    "the integrability of the constraints simplifies the application of the transition principle .",
    "consider , for instance , the situation when the mechanical system is unconstrained on @xmath261 and is subject to some generalized linear constraints @xmath686 on @xmath260 that turn out to be holonomic , i.e. , @xmath687 is integrable .",
    "denote by @xmath688 , @xmath689 being an @xmath43-dimensional parameter , the foliation of @xmath260 induced by @xmath39 .",
    "locally this foliation is described by @xmath43 functions @xmath690 such that @xmath691 a similar situation has been treated in  @xcite in the context of totally inelastic collisions ( note , however , that in  @xcite the integrable distribution is defined only on @xmath99 , whereas here @xmath39 is defined on @xmath260 ) .",
    "the integrable constraints imposed by @xmath39 can be interpreted as an abrupt reduction of the phase space of the mechanical system .    by definition , one has that @xmath692 .",
    "the matrix @xmath693 in   is then given by @xmath694 and the projector @xmath556 is @xmath695 .",
    "let @xmath696 be the impact state of a trajectory @xmath697 coming from @xmath261 . from the discussion in section  [ se : mechanical - decisive - elastic ]",
    ", we obtain that the unique focusing point associated to @xmath305 is @xmath698 .",
    "the trajectory will continue its motion in @xmath260 , @xmath261 or @xmath99 depending on the in / out / trapping character of the focusing point @xmath8 .",
    "if it evolves in @xmath260 ( more precisely , in @xmath699 with @xmath689 such that @xmath700 ) , we call it the ` refraction ' of the original trajectory . if it evolves in @xmath261 , we call it the ` reflection ' of the original trajectory .",
    "in this section we consider four examples to illustrate the theory exposed above .",
    "they all present the example of a rolling sphere considered in various constrained situations .",
    "the first one is taken from  @xcite and is treated here in order to provide a further comparison with previous approaches .",
    "the second one combines the presence of smooth nonholonomic constraints with discontinuous hamiltonians and instantaneous constraints acting on the system along a hypersurface .",
    "the third one consists of a ball rolling on a rotating surface whose angular velocity is suddenly changed to a different value , and this is modeled via a discontinuous affine distribution of constraints .",
    "finally , the fourth one presents a two - wheeled system with a rod of variable length and illustrates the application of the transition principle in both the elastic and the inelastic modes .",
    "consider a homogeneous sphere rolling on a plane .",
    "assume it has unit mass ( @xmath701 ) and let @xmath702 be its inertia about any axis .",
    "let @xmath703 denote the position of the center of the sphere and let @xmath704 denote the eulerian angles .",
    "the configuration space is therefore @xmath705 .",
    "assume that the plane is smooth if @xmath706 and absolutely rough if @xmath707 ( see figure  [ fig : bola ] ) .",
    "on the smooth half - plane , the motion of the sphere is assumed free , that is , the sphere can slip .",
    "on the rough half - plane , the sphere should roll without slipping due to the constraints imposed by the roughness .",
    "we are interested in determining the eventual sudden changes in the trajectories of the sphere when it reaches the line separating the smooth and the rough half - planes .",
    "the kinetic energy of the sphere is @xmath708 where @xmath709 , @xmath710 and @xmath711 are the angular velocities with respect to the inertial frame , given by @xmath712    the condition of rolling without sliding of the sphere when @xmath707 implies that the point of contact of the sphere and the plane has zero velocity @xmath713 where @xmath714 is the radius of the sphere .",
    "following the classical procedure  @xcite , we introduce quasi - coordinates ` @xmath715 ' , ` @xmath716 ' and ` @xmath717 ' such that @xmath718@xmath719 , ` @xmath720'@xmath721 and ` @xmath722'@xmath723 .",
    "the latter merely have a symbolic meaning in the sense that in the present example , for instance , the partial derivative operators @xmath724 should be interpreted as linear combinations of the partial derivatives with respect to euler s angles . also to the differential forms",
    "@xmath725 one should attach the appropriate meaning , i.e. they do not represent exact differentials but , instead , we should read them as @xmath726 , etc .",
    "the singular hypersurface @xmath99 is defined by @xmath727 . in this case , the constraints are linear and the nonholonomic distribution @xmath728 on @xmath260 is given by @xmath729 here we are dealing with a single distribution which constrains the motion on  @xmath260 .    in the following",
    "we compute the decisive points for this example .",
    "let @xmath730 be a minus - out point .",
    "a direct computation shows that the expression of the projector @xmath731 in local coordinates is @xmath732 therefore , the single focusing point for @xmath733 is given by @xmath734 .",
    "if we denote @xmath735 and @xmath736 , we get @xmath737 note also that the focusing point with respect to @xmath738 associated with @xmath8 is @xmath8 itself . therefore ,",
    "if @xmath8 is a plus - out point , the only admissible sequence for @xmath739 is @xmath740 .",
    "if @xmath8 is either a plus - in or a plus - trapping point , then the only admissible sequence for @xmath739 is @xmath741 .",
    "the set of plus - trapping points for the dynamics @xmath742 is @xmath743 .",
    "consequently , the trajectory is refracted , i.e. , the sphere follows its motion on @xmath260 under the dynamics @xmath742 ( rolling without slipping ) if @xmath744 .",
    "otherwise ( i.e. , if @xmath745 ) , the trajectory is reflected by the `` roughness '' and continues in @xmath261 under the dynamics @xmath109 starting from @xmath8 .",
    "this is a classical example  @xcite that we treat here for the sake of completeness .",
    "consider again a homogeneous sphere of radius @xmath714 and unit mass .",
    "assume that the sphere rolls without sliding on a horizontal table , and that at a certain instant of time it hits a wall determined by the plane @xmath746 ( cf .",
    "figure  [ fig : ball - hitting ] ) .",
    "when this happens , the following constraint is instantaneously imposed on the system , @xmath747 therefore , we are in the situation explained in remark  [ rem : decisive - boundary ] .        the configuration space of the system is @xmath748 , with the boundary @xmath749 , and the linear constraint submanifold @xmath750 is given by @xmath751 , @xmath752 the expression for the projector @xmath731 is given by equation  .",
    "the submanifold giving the instantaneous constraints along @xmath99 is @xmath753 the projector @xmath754 is @xmath755    let @xmath756 be a plus - out point , i.e. , @xmath757 .",
    "we first consider an elastic impact .",
    "since @xmath758 , we only compute the outcome of a reflective step . according to  , the points in the constrained characteristic passing through @xmath739 within the same @xmath283-energy level are @xmath759 the associated focusing points are given by @xmath760 note that @xmath761 , and therefore the points in   belong to the same constrained characteristic and to the same @xmath283-energy level . denoting the coordinates of the point @xmath762 by @xmath763",
    ", we get @xmath764    now , notice that @xmath765 is a plus - out point , because @xmath766 . therefore ,",
    "following proposition  [ prop : duality ] , we conclude that the sequence @xmath767 is @xmath739-admissible , and @xmath768 is a decisive point .",
    "the other possible @xmath739-admissible sequence corresponds to @xmath769 but renders the same decisive point .    in the case of an inelastic impact ,",
    "proposition  [ prop : decisive - dis - inelastic ] yields that the unique @xmath739-decisive point is @xmath770 .",
    "after the impact , the ball continues its motion along the wall under the dynamics specified by the vector field @xmath771 .",
    "consider again a homogeneous sphere of radius @xmath714 and unit mass .",
    "assume that the sphere rolls without sliding on a horizontal table which is rotating with certain constant angular velocity about a vertical axis through one of its points ( see figure  [ fig : ball - rotating - table ] ) .",
    "let @xmath772 and @xmath773 be two angular velocities .",
    "here we consider the following situation : each time the sphere reaches the hypersurface @xmath774 , an impulsive force is exerted on the table to put it spinning with a different angular velocity .",
    "that is , if the angular velocity of the table was @xmath772 , the force applied on its rotation axis changes it to @xmath773 and vice versa .",
    "we assume that @xmath775 .",
    "this can be modeled as thinking of a system which is subject to two different affine constraint distributions . in order for this model to be consistent",
    ", we also assume that the surface of the table is rough enough so that sphere is rolling without slipping at all times .",
    "the lagrangian is again given by equation  .",
    "the nonholonomic constraints are now affine in the velocities , @xmath776 the constraint space @xmath92 is then described by @xmath777 where @xmath778 is the vector field defined by @xmath779 note that the projection of @xmath780 to @xmath40 is given by @xmath781 following the discussion for the case of affine constraints , given @xmath782 , the focusing point with respect to @xmath582 is given by @xmath783 where @xmath556 is the projector in  .",
    "assume that the sphere is rolling on the hyperplane @xmath784 and that the constant angular velocity of the table is @xmath772 .",
    "consider the case when the sphere `` hits '' the hypersurface @xmath785 with the impact state @xmath786 denote the coordinates of the associated focusing point by @xmath787 then @xmath788 given that @xmath739 is an minus - out point , we have that @xmath789 . if @xmath790 , then the second term in   is also positive , and @xmath791 is the unique admissible sequence for @xmath739 . in this case , @xmath8 is the @xmath739-decisive point . on the contrary , for certain values of @xmath792 , it might happen that @xmath793 is negative , i.e. , that @xmath8 is a plus - out point .",
    "now , note that the focusing point associated with @xmath8 is @xmath739 itself , since @xmath794 as a consequence , in this case there would not be any @xmath739-decisive point .",
    "this problem stems from the fact the modeling of this example as a system subject to affine constraints does not take into account that the jump in the angular velocity of the table takes place _ no matter what_. therefore , after the impact , we should really regard @xmath795 as the new set of affine constraints acting on the whole configuration manifold . with this interpretation , @xmath8 would obviously be a plus - in point ( and hence decisive ) .",
    "in other words , the trajectory of the ball gets reflected back by the blow of the greater velocity @xmath773 .",
    "consider a system composed of two wheels of different radii , @xmath796 , connected by a massless rod of variable length @xmath797 ( see figure  [ fig : wheels - with - telescopic - rod ] ) .",
    "for simplicity , assume that the two - wheeled system moves along a line , and that both the masses and the momenta of inertia of the wheels are unitary .",
    "the wheels are subject to the standard constraints of non - slipping .",
    "assume that the length @xmath797 of the rod is constrained between a minimum length @xmath798 and a maximum length @xmath120 .",
    "here we consider the following two situations : ( i ) when the length @xmath797 of the rod becomes extreme , an elastic impact occurs ; ( ii ) when the length @xmath797 of the rod becomes extreme , an arresting device fixes it , and therefore an inelastic impact occurs .",
    "the lagrangian of the system is given by the kinetic energy of the wheels @xmath799 the conditions of rolling without sliding are encoded in the constraints @xmath800 which , since we are considering the motion of the two - wheeled system only along a line , turn out to be holonomic .",
    "the constraint on the length of the rod is given by @xmath801 following remark  [ rem : decisive - boundary ] , we set @xmath802 , @xmath803 , with boundary set @xmath804 , and linear constraint submanifold @xmath805 given by @xmath806 , @xmath807 the expression for the projector @xmath731 in local coordinates is given by the following matrix @xmath808 let @xmath809 be a plus - out point with @xmath810 and @xmath811 . since @xmath758 , we only compute the outcome of a reflective step . following equation  ,",
    "the points in the constrained characteristic passing through @xmath739 with the same @xmath283-energy level are @xmath739 and @xmath812 , with @xmath813 according to proposition  [ prop : duality ] , the point @xmath814 is @xmath815-decisive .",
    "consider now an inelastic impact , i.e. , the case when the length @xmath797 of the rod becomes fixed after the impact . since there are no additional instantaneous constraints imposed on the system at the impact state , we compute the decisive points with regards to the boundary of the constraint manifold , @xmath816 as before , we only compute the outcome of a reflective step .",
    "following proposition  [ prop : decisive - dis - inelastic ] , we deduce that the unique decisive point is @xmath817 .",
    "after the inelastic impact , the length of the rod is fixed forever after , the velocities of the two wheels of the system are reset according to @xmath817 and evolve according to @xmath818 .",
    "the work of the first author was partially supported by nsf grant cms-0100162 .",
    "h. cendra , e.a .",
    "lacomba , w. reartes : the lagrange - dalembert - poincar equations for the symmetric rolling sphere . in _ proceedings of the sixth `` dr .",
    "antonio a. r. monteiro '' congress of mathematics _ , e. fernndez , a. germani , l. monteiro , h. cendra , l. piovan .",
    "eds , univ .",
    "sur dep . mat .",
    "inst . mat .",
    ", baha blanca , 2001 , pp 19 - 32 .",
    "j. corts , m. de len , d. martn de diego , s. martnez : mechanical systems subjected to generalized nonholonomic constraints .",
    "ser . a math .",
    "* 457 * ( 2007 ) ( 2001 ) , 651 - 670 ."
  ],
  "abstract_text": [
    "<S> this paper considers systems subject to nonholonomic constraints which are not uniform on the whole configuration manifold . when the constraints change , the system undergoes a transition in order to comply with the new imposed conditions . building on previous work on the hamiltonian theory of impact , we tackle the problem of mathematically describing the classes of transitions that can occur . </S>",
    "<S> we propose a comprehensive formulation of the transition principle that encompasses the various impulsive regimes of hamiltonian systems . </S>",
    "<S> our formulation is based on the partial symplectic formalism , which provides a suitable framework for the dynamics of nonholonomic systems . </S>",
    "<S> we pay special attention to mechanical systems and illustrate the results with several examples .    </S>",
    "<S> * keywords . * mechanical systems , variable nonholonomic constraints , transition principle , impulsive motion </S>"
  ]
}