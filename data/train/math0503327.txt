{
  "article_text": [
    "this is an updated preprint of a paper whose journal version has already appeared in print @xcite .",
    "the main reason for the update was to include references to the papers @xcite , which have independently obtained equivalent results using different methods .",
    "the enumeration of pattern - avoiding permutations has received a considerable amount of attention lately ( see @xcite for a survey ) .",
    "we say that a permutation @xmath4 of order @xmath5 _ contains _ a permutation @xmath6 of order @xmath7 , if there is a sequence @xmath8 such that for every @xmath9 $ ] @xmath10 if and only if @xmath11",
    ". one of the central notions in the study of pattern - avoiding permutations is the _ wilf equivalence _ : we say that a permutation @xmath12 is wilf - equivalent to a permutation @xmath13 if , for every @xmath14 , the number of permutations of order @xmath5 that avoid @xmath12 is equal to the number of permutations of order @xmath5 that avoid @xmath13 . in this paper",
    ", we consider pattern avoidance in matchings .",
    "this is a more general concept than pattern avoidance in permutations , since every permutation can be represented by a matching .",
    "a _ matching _ of size @xmath15 is a graph on the vertex set @xmath16=\\{1,2,\\dotsc,2m\\}$ ] whose every vertex has degree one .",
    "we say that a matching @xmath17 _ contains _ a matching @xmath18 if there is a monotone edge - preserving injection from @xmath19 to @xmath20 ; in other words , @xmath21 contains @xmath22 if there is a function @xmath23 such that @xmath24 implies @xmath25 and @xmath26 implies @xmath27 .",
    "let @xmath21 be a matching of size @xmath15 , and let @xmath28 be an arbitrary edge of  @xmath21 .",
    "if @xmath29 , we say that @xmath30 is an _",
    "l - vertex _ and @xmath31 is an _",
    "r - vertex _ of @xmath21 . obviously , @xmath21 has @xmath15 l - vertices and @xmath15 r - vertices .",
    "let @xmath32 and @xmath33 be two edges of @xmath21 , with @xmath34 and @xmath35 , and assume that @xmath36 .",
    "we say that the two edges @xmath37 and @xmath38 _ cross _ each other if @xmath39 , and we say that @xmath38 is _ nested _ below @xmath37 if @xmath40 .",
    "we say that a matching @xmath21 on the vertex set @xmath16 $ ] is _ permutational _ , if for every l - vertex @xmath30 and every r - vertex @xmath31 we have @xmath41 . there is a natural one - to - one correspondence between permutations of order @xmath15 and permutational matchings of size @xmath15 :",
    "if @xmath4 is a permutation of @xmath15 elements , we let @xmath42 denote the permutational matching on the vertex set @xmath16 $ ] whose edge set is the set @xmath43\\bigl\\}$ ] . in this paper , we will often represent a permutation @xmath4 on @xmath15 elements by the ordered sequence @xmath44 .",
    "thus , for instance , @xmath45 refers to the matching on the vertex set @xmath46 $ ] , with edge set @xmath47 .",
    "figure  [ fig - match ] depicts most of the matchings relevant for this paper .",
    "note that a permutational matching @xmath42 contains the permutational matching @xmath48 if and only if @xmath4 contains  @xmath6 .",
    "[ cols=\"^,^,^ \" , ]     let @xmath49 be an even number . a _",
    "dyck path _ of length @xmath5 is a piecewise linear nonnegative walk in the plane , which starts at the point @xmath50 , ends at the point @xmath51 , and consists of @xmath5 linear segments ( `` steps '' ) , of which there are two kinds : an _ up - step _ connects @xmath52 with @xmath53 , whereas a _ down - step _ connects @xmath52 with @xmath54 .",
    "the nonnegativity of the path implies that among the first @xmath7 steps of the path there are at least @xmath55 up - steps .",
    "let @xmath56 denote the set of all dyck paths of length @xmath57 .",
    "it is well known that @xmath58 , where @xmath59 is the @xmath15-th catalan number .",
    "every dyck path @xmath60 can be represented by a",
    "_ dyck word _ ( denoted by @xmath61 ) , which is a binary word @xmath62 such that @xmath63 if the @xmath30-th step of @xmath64 is an up - step , and @xmath65 if the @xmath30-th step of @xmath64 is a down - step .",
    "it can be easily seen that a word @xmath66 is a dyck word of some dyck path if and only if the following conditions are satisfied :    * the length @xmath67 is even . *",
    "the word @xmath68 has exactly @xmath69 terms equal to 1 . *",
    "every prefix @xmath70 of @xmath68 has at most @xmath71 terms equal to 1 .",
    "we will use the term dyck word to refer to any binary word satisfying these conditions .",
    "the set of all dyck words of length @xmath57 will be denoted by  @xmath72 .",
    "let @xmath73 denote the set of all matchings on the vertex set @xmath16 $ ] .",
    "for a matching @xmath74 , we define the _ base _ of @xmath21 ( denoted by @xmath75 ) to be the binary word @xmath62 such that @xmath63 if @xmath30 is an l - vertex of @xmath21 , and @xmath65 if @xmath30 is an r - vertex of @xmath21 .",
    "the base @xmath75 is clearly a dyck word ; conversely , every dyck word is a base of some matching . if @xmath63 ( or @xmath65 ) we say that @xmath30 is an _",
    "l - vertex _ ( or an _ r - vertex _ ,",
    "respectively ) _ with respect to the base @xmath68_. let @xmath76 , let @xmath77 be an arbitrary set of matchings , and let @xmath78 ; we define the sets @xmath79 and @xmath80 as follows : @xmath81    let @xmath82 and @xmath83 denote the cardinalities of the sets @xmath73 , @xmath79 and @xmath80 , respectively . the sets @xmath80 form a partition of @xmath79 . in other words , we have @xmath84 where the union and the sum range over all dyck words @xmath78 .",
    "if no confusion can arise , we will write @xmath85 instead of @xmath86 and @xmath87 instead of @xmath88 .",
    "there is an alternative way to encode ordered matchings , which uses transversals of ferrers shapes .",
    "ferrers shape _ is a left - justified array of cells , where the number of cells in a given row does not exceed the number of cells in the row directly above it .",
    "transversal _ of a ferrers shape is a subset of its cells which intersects every row and every column exactly once .",
    "a matching @xmath21 on the vertex set @xmath16 $ ] can be represented by a transversal of a ferrers shape as follows : first , consider a ferrers shape with @xmath15 rows and @xmath15 columns , in which the @xmath30-th row ( counted from the bottom ) has @xmath7 cells if and only if the @xmath30-th r - vertex of @xmath21 has @xmath7 l - vertices to the left of it .",
    "next , we define a transversal of this shape : the transversal contains the cell in row @xmath30 and column @xmath31 if and only if the @xmath30-th r - vertex is connected to the @xmath31-th l - vertex by an edge of @xmath21 . this correspondence establishes a bijection between transversals and matchings , where matchings of a given base correspond to the transversals of a given shape . in the context of pattern - avoiding transversals ,",
    "the equivalence relation @xmath89 is known as shape - wilf equivalence .",
    "note that the permutational matchings correspond to transversals of square shapes , i.e. , to permutation matrices .",
    "the correspondence between matchings and transversals , as well as the ( more general ) correspondence between ordered graphs and nonnegative fillings of ferrers shapes , has been pointed out by krattenthaler   @xcite and de mier  @xcite . using this correspondence ,",
    "it becomes clear that some previous results on pattern - avoiding graphs @xcite are equivalent to results on pattern - avoiding fillings @xcite .",
    "the aim of this paper is to study the relative cardinalities of the sets @xmath90 , with @xmath91 being a permutational matching with three edges .",
    "for this purpose , we introduce the following notation :    let @xmath92 be the quasiorder relation defined as follows : for two sets @xmath77 and @xmath93 of matchings , we write @xmath94 , if for each @xmath76 and each @xmath78 we have @xmath95 .",
    "similarly , we write @xmath96 if @xmath94 and @xmath97 , and we write @xmath98 if @xmath94 and @xmath99 .",
    "as above , we omit the curly braces when the arguments of these relations are singleton sets .",
    "note that two permutations @xmath4 and @xmath6 are wilf - equivalent if and only if for every @xmath76 the equality @xmath100 holds , where @xmath101 is the dyck word consisting of @xmath15 consecutive @xmath102-terms followed by @xmath15 consecutive @xmath103-terms .",
    "thus , if @xmath104 , then @xmath4 and @xmath6 are wilf - equivalent ; however , the converse does not hold in general : it is well known that all the permutations of order three are wilf - equivalent , whereas the results of this paper imply that the permutational matchings of size three fall into three @xmath89-classes .",
    "combining the known results on ferrers transversals and the known results on matchings , the full characterization of the @xmath89 and @xmath105 relations for patterns of size three has been obtained :    @xmath106    the equivalence @xmath107 follows from the results of stankova and west  @xcite obtained in the context of fillings of ferrers shapes . in  @xcite",
    ", the same equivalence is proved in the context of pattern - avoiding matchings as a corollary to the result presented in this paper as theorem  [ thm - bij ] .",
    "the equivalence of @xmath108 follows from the more general result @xmath109 , which was proved by chen et al .",
    "@xcite in the context of matchings , and by backelin et al .",
    "@xcite in the context of transversals .",
    "several generalizations of this result are obtained by krattenthaler  @xcite ( see also  @xcite ) .",
    "the equivalence @xmath110 follows from the general results of backelin et al .",
    "@xcite . in this paper , a different bijective argument is given ( see section  [ sec-231 ] ) .",
    "the relation @xmath111 is proved in corollary  [ cor-123 - 132 ] of this paper , and a different argument is given in a forthcoming paper by stankova  @xcite , which also contains the proof of @xmath112 , completing the classification .",
    "this paper is organized as follows : in section  [ sec-132 ] , we prove theorem  [ thm - bij ] , which simultaneously implies @xmath107 and @xmath111 . in section  [ sec-231 ]",
    ", we present a bijective argument that implies @xmath110 .",
    "since the matching @xmath45 is the mirror image of the matching @xmath113 , it is obvious that @xmath114 is equal to @xmath115 for each @xmath116 . however , there seems to be no straightforward argument demonstrating the stronger fact that @xmath117 .    for @xmath118",
    ", we define @xmath119 to be the matching with edge set @xmath120 .",
    "let @xmath121 .",
    "the goal of this section is to prove the following result :    [ thm - bij ] @xmath122 .",
    "since all the elements of @xmath123 are symmetric upon mirror reflection , this also proves that @xmath124 and @xmath117 , see corollaries  [ cor - calc ] and  [ cor - sym ] at the end of this section .    throughout this section",
    ", we consider @xmath76 and @xmath78 to be arbitrary but fixed , and we let @xmath49 . for the sake of brevity ,",
    "we write @xmath125 instead of @xmath126 and @xmath127 instead of @xmath128 . for a matching @xmath129 and an arbitrary integer",
    "@xmath130 $ ] , let @xmath131 $ ] denote the subgraph of @xmath132 induced by the vertices in @xmath133 $ ] .",
    "there are three types of vertices in @xmath131 $ ] :    * the r - vertices of @xmath132 belonging to @xmath133 $ ] . clearly",
    ", all these vertices have degree one in @xmath131 $ ] .",
    "* the l - vertices of @xmath132 connected to some r - vertex belonging to @xmath133 $ ] .",
    "these have degree one in @xmath131 $ ] as well . * the l - vertices of @xmath132 belonging to @xmath133 $ ] but not connected to an r - vertex belonging to @xmath133 $ ] .",
    "these are the isolated vertices of @xmath131 $ ] , and we will refer to them as the _ stubs _ of @xmath131 $ ] .",
    "let @xmath132 be an arbitrary graph from @xmath134 .",
    "the sequence @xmath135,\\",
    "g[2],\\ g[3 ] , \\dotsc,\\ g[n-1],\\ g[n]=g\\ ] ] will be called _ the construction _ of @xmath132 .",
    "it is convenient to view the construction of @xmath132 as a sequence of steps of an algorithm that produces the matching @xmath132 by adding one vertex in every step .",
    "two graphs @xmath136 from @xmath134 may share an initial part of their construction ; however , if @xmath131\\neq g'[k]$ ] for some @xmath7 , then obviously @xmath137\\neq g'[j]$ ] for every @xmath138 .",
    "it is natural to represent the set of all the constructions of graphs from @xmath134 by _ the generating tree _ of @xmath134 ( denoted by @xmath139 ) , defined by the following properties :    * the generating tree is a rooted tree with @xmath5 levels , where the root is the only node of level one , and all the leaves appear on level @xmath5 . *",
    "the nodes of the tree are exactly the elements of the following set : @xmath140 , \\exists g\\in{\\mathcal{g}}^{m}:\\   g'=g[k]\\}\\ ] ] * the children of a node @xmath141 are exactly the elements of the following set : @xmath142 , \\exists g\\in{\\mathcal{g}}^{m}:\\ g'=g[k ] , g''=g[k+1]\\}\\ ] ]    it follows that the level of every node @xmath141 of the tree @xmath143 is equal to the number of vertices of @xmath141 .",
    "also , the leaves of @xmath143 are exactly the elements of @xmath134 , and the nodes of the path from the root to a leaf @xmath132 form the construction of @xmath132 .",
    "the generating tree of @xmath144 , denoted by @xmath145 , is defined in complete analogy with the tree @xmath143 .",
    "our goal is to prove that the two trees are isomorphic , hence they have the same number of leaves , i.e. ,  @xmath146 .",
    "we say that a graph @xmath141 on the vertex set @xmath133 $ ] is _ consistent _ with @xmath68 , if @xmath147 $ ] for some matching @xmath148 with base @xmath68 .",
    "[ lem - t1t2 ]     \\1 .",
    "a graph @xmath141 is a node of @xmath139 if and only if @xmath141 satisfies these three conditions :    * @xmath141 is consistent with @xmath68 .",
    "* @xmath141 avoids @xmath45 .",
    "* @xmath141 does not contain a sequence of five vertices @xmath149 such that @xmath150 is a stub , while @xmath151 and @xmath152 are edges of @xmath141 .",
    "a graph @xmath153 is a node of @xmath145 if and only if @xmath153 satisfies these three conditions :    * @xmath153 is consistent with @xmath68 . *",
    "@xmath153 avoids @xmath123 . * for every @xmath154 , @xmath153 does not contain an induced subgraph isomorphic to @xmath155 $ ] ( by an order preserving isomorphism ) .",
    "in other words , for every @xmath154 , @xmath153 does not contain a sequence of @xmath156 vertices @xmath157 , where @xmath158 is a stub , and the remaining @xmath159 vertices induce the edges @xmath160 .",
    "we first prove the first part of the lemma .",
    "let @xmath141 be a node of @xmath139 .",
    "clearly , @xmath141 satisfies conditions _ a _ and _ b _ of the first part of the lemma .",
    "assume that @xmath141 fails to satisfy condition _",
    "c_. choose @xmath161 such that @xmath147 $ ] for some @xmath130 $ ] .",
    "let @xmath162 denote the r - vertex of @xmath132 connected to @xmath150 .",
    "then @xmath163 , because @xmath150 was a stub of @xmath147 $ ] , which implies that @xmath164 and the six vertices @xmath165 induce a subgraph isomorphic to @xmath45 , which is forbidden .",
    "this shows that the conditions _ a _ , _ b _ and _ c _ are necessary .    to prove the converse , assume that @xmath141 satisfies the three conditions , and",
    "let @xmath166 $ ] .",
    "we will extend @xmath141 into a graph @xmath132 with base @xmath68 , by adding the vertices @xmath167 one by one , and each time that we add a new r - vertex @xmath30 , we connect @xmath30 with the smallest stub of the graph constructed in the previous steps .",
    "we claim that this algorithm yields a graph @xmath161 . for contradiction , assume that this is not the case , and that there are six vertices @xmath168 inducing a copy of @xmath45 . by condition _",
    ", we know that these six vertices are not all contained in @xmath141 , which means that @xmath163 . also , by condition _",
    ", we know that @xmath169 . in the step of the above construction when we added the r - vertex @xmath170 , both @xmath150 and @xmath171 were stubs .",
    "since @xmath170 should have been connected to the smallest available stub , it could not have been connected to @xmath171 , which contradicts the assumption that @xmath172 induce a copy of @xmath45 .",
    "thus @xmath161 , as claimed .",
    "the proof of the second part of the lemma follows along the same lines . to see that the conditions _ a _ , _ b _ and _ c _ of the second part are sufficient , note that every graph satisfying these conditions can be extended into a graph @xmath173 by adding new vertices one by one , and connecting every new r - vertex to the biggest stub available when the r - vertex is added .",
    "we omit the details .",
    "let @xmath141 be a node of @xmath139 .",
    "we define a binary relation @xmath174 on the set of stubs of @xmath141 by the following rule : @xmath175 if and only if either @xmath176 or there is an edge @xmath177 such that @xmath178 and @xmath179 .    . here",
    "@xmath180 , assuming @xmath181 and @xmath182 are stubs . ]    let @xmath153 be a node of @xmath145 .",
    "we define a binary relation @xmath183 on the set of stubs of @xmath153 by the following rule : @xmath180 if and only if either @xmath176 or @xmath153 contains a sequence of edges @xmath184 , where @xmath185 , @xmath186 , the edge @xmath187 crosses the edge @xmath188 for each @xmath189 , and at the same time @xmath190 and @xmath191 ( see fig .",
    "[ fig - eqst ] ; note that we may assume , without loss of generality , that the edge @xmath187 does not cross any other edge of the sequence except for @xmath192 and @xmath188 , and that no two edges of the sequence are nested : indeed , a minimal sequence @xmath193 witnessing @xmath180 clearly has these properties ) .",
    "we remark that the relation @xmath183 has an intuitive geometric interpretation : assume that the vertices of @xmath153 are represented by points on a horizontal line , ordered left - to - right according to the natural order , and assume that every edge of @xmath153 is represented by a half - circle connecting the corresponding endpoints .",
    "then @xmath180 if and only if every vertical line separating @xmath181 from @xmath182 intersects at least one edge of @xmath153 .    using condition _",
    "c _ of the first part of lemma  [ lem - t1t2 ] , it can be easily verified that for every node @xmath141 of the tree @xmath139 , the relation @xmath174 is an equivalence relation on the set of stubs of @xmath141 .",
    "let @xmath194 denote the block of @xmath174 containing the stub @xmath195 .",
    "clearly , the blocks of @xmath174 are contiguous with respect to the ordering @xmath196 of the stubs of @xmath141 ; i.e. ,  if @xmath197 are three stubs of @xmath141 , then @xmath198 implies @xmath199 .",
    "similarly , @xmath183 is an equivalence relation on the set of stubs of a node @xmath153 of @xmath145 ( notice that , contrary to the case of @xmath174 , the fact that @xmath183 is an equivalence relation does not rely on the particular properties of the nodes of @xmath145 described in lemma  [ lem - t1t2 ] ) .",
    "the block of @xmath183 containing @xmath195 will be denoted by @xmath200 .",
    "these blocks are contiguous with respect to the ordering @xmath196 as well .",
    "[ lem - child ]     \\1 .",
    "let @xmath141 be a node of level @xmath201 in the tree @xmath139 .",
    "the following holds :    * let @xmath202 be an arbitrary child of @xmath141 in the tree @xmath139 .",
    "this implies that @xmath203 $ ] .",
    "if the vertex @xmath204 is an l - vertex with respect to @xmath68 , then @xmath202 is the only child of @xmath141 , and @xmath204 is a stub in @xmath202 . in this case ,",
    "@xmath205 for every stub @xmath195 of @xmath141 , and @xmath206 . on the other hand ,",
    "if @xmath204 is an r - vertex , then in the graph @xmath202 the vertex @xmath204 is connected to a vertex @xmath195 satisfying @xmath207 . in this case , we have @xmath208 whenever @xmath209 , and all the stubs @xmath210 of @xmath202 form a single @xmath211-block in @xmath202 . *",
    "if @xmath204 is an r - vertex , then for every stub @xmath195 satisfying @xmath207 , @xmath141 has a child @xmath202 which contains the edge @xmath212 .",
    "this implies , together with part a , that if @xmath204 is an r - vertex , then the number of children of @xmath141 in @xmath139 is equal to the number of its @xmath211-blocks .",
    "let @xmath153 be a node of level @xmath201 in the tree @xmath145 .",
    "the following holds :    * let @xmath213 be an arbitrary child of @xmath153 in the tree @xmath145 .",
    "this implies that @xmath214 $ ] .",
    "if the vertex @xmath204 is an l - vertex with respect to @xmath68 , then @xmath213 is the only child of @xmath153 , and @xmath204 is a stub in @xmath213 . in this case ,",
    "@xmath215 for every stub @xmath195 of @xmath153 , and @xmath216 . on the other hand ,",
    "if @xmath204 is an r - vertex , then in the graph @xmath213 the vertex @xmath204 is connected to a vertex @xmath195 satisfying @xmath217 . in this case , we have @xmath218 whenever @xmath209 and @xmath219 , and all the other stubs of @xmath213 form a single @xmath220-block in @xmath213 .",
    "* if @xmath204 is an r - vertex , then for every stub @xmath195 satisfying @xmath217 , @xmath153 has a child @xmath213 which contains the edge @xmath212 .",
    "this implies , together with part a , that if @xmath204 is an r - vertex , then the number of children of @xmath153 in @xmath145 is equal to the number of its @xmath220-blocks .",
    "we first prove part @xmath221 .",
    "the case when @xmath204 is an l - vertex follows directly from the definition of @xmath174 , so let us assume that @xmath204 is an r - vertex , and let @xmath195 be the vertex connected to @xmath204 in @xmath202 . assume , for contradiction , that @xmath222 , and choose @xmath223 such that @xmath209 .",
    "since @xmath224 , @xmath141 must contain an edge @xmath225 , with @xmath226 .",
    "then the five vertices @xmath227 form in @xmath202 a configuration that was forbidden by lemma  [ lem - t1t2 ] , part @xmath228 .",
    "this shows that @xmath207 .",
    "the edge @xmath212 guarantees that all the stubs larger than @xmath195 are @xmath211-equivalent in @xmath202 , whereas the equivalence classes of the stubs smaller than @xmath195 are unaffected by this edge .",
    "this concludes the proof of part @xmath221 .    to prove part @xmath229",
    ", it is sufficient to show that after choosing a vertex @xmath195 such that @xmath207 and adding the edge @xmath212 to @xmath141 , the resulting graph @xmath202 satisfies the three conditions of the first part of lemma  [ lem - t1t2 ] .",
    "condition @xmath221 of lemma  [ lem - t1t2 ] is satisfied automatically .",
    "if @xmath202 fails to satisfy condition @xmath229 , then @xmath141 fails to satisfy one of the conditions @xmath229 and @xmath228 of that lemma , which is impossible .",
    "similarly , if @xmath202 fails to satisfy condition @xmath228 , then either @xmath141 fails to satisfy this condition as well , or @xmath141 contains a stub @xmath230 with @xmath209 and @xmath224 , contradicting our choice of @xmath195 .",
    "the proof of the second part of this lemma follows along the same lines as the proof of the first part , and we omit it .",
    "we are now ready to state and prove the main theorem of this section .",
    "[ thm - m132 ] the trees @xmath139 and @xmath145 are isomorphic .",
    "our aim is to construct a mapping @xmath231 with the following properties :    * the mapping @xmath231 maps the nodes of @xmath139 to the nodes of @xmath145 , preserving their level . *",
    "if @xmath141 is a child of @xmath132 in @xmath143 , then @xmath232 is a child @xmath233 in @xmath234 .",
    "furthermore , if @xmath235 and @xmath236 are two distinct children of a node @xmath132 in @xmath139 , then @xmath237 and @xmath238 are two distinct children of @xmath233 in @xmath145 .",
    "* let @xmath132 be an arbitrary node of @xmath139 , and let @xmath239 .",
    "let @xmath240 , @xmath241 @xmath242 be the sequence of all the distinct blocks of @xmath174 in @xmath132 , uniquely determined by the condition @xmath243 .",
    "similarly , let @xmath244 , @xmath245 @xmath246 be the sequence of all the distinct blocks of @xmath183 in @xmath247 , uniquely determined by the condition @xmath248",
    ". then @xmath249 and @xmath250 for each @xmath251 $ ] .",
    "these conditions guarantee that @xmath231 is an isomorphism , because , thanks to lemma  [ lem - child ] , we know that the number of children of each node of @xmath139 ( or  @xmath145 ) at level @xmath7 is either equal to one if @xmath204 is an l - vertex or equal to the number of blocks of its @xmath174 relation ( or @xmath183 relation , respectively ) if @xmath204 is an r - vertex .    the mapping @xmath231 is defined recursively for nodes of increasing level .",
    "the root of @xmath139 is mapped to the root of @xmath145 .",
    "assume that the mapping @xmath231 has been determined for all the nodes of @xmath139 of level at most @xmath7 , for some @xmath252 $ ] , and that it does not violate the properties stated above .",
    "let @xmath132 be a node of level @xmath7 , let @xmath239 .",
    "if @xmath204 is an l - vertex , then @xmath132 has a unique child @xmath141 and @xmath247 has a unique child @xmath153 . in this case , define @xmath253 .",
    "let us now assume that @xmath204 is an r - vertex .",
    "let @xmath240 , @xmath241 @xmath242 be the sequence of all the distinct blocks of @xmath174 on @xmath132 , with @xmath243 .",
    "we may assume , without loss of generality , that @xmath254 for @xmath251 $ ] .",
    "by assumption , @xmath183 has @xmath255 blocks on @xmath247 .",
    "let @xmath244 , @xmath245 @xmath256 be the sequence of these blocks , where @xmath257 and @xmath258 for every @xmath259 $ ] . by lemma  [ lem - child ] , the nodes @xmath132 and @xmath247 have @xmath255 children in @xmath139 and @xmath145 .",
    "let @xmath260 be the graph obtained from @xmath132 by addition of the edge @xmath261 , let @xmath262 be the graph obtained from @xmath247 by addition of the edge @xmath263 , for @xmath259 $ ] . by lemma  [ lem - child ] , the graphs @xmath264\\}$ ] ( or @xmath265\\}$ ] ) are exactly the children of @xmath132 ( or @xmath247 , respectively ) .",
    "we define @xmath266 .",
    "the @xmath211-blocks of @xmath260 are exactly the sets @xmath240 , @xmath267 @xmath268 and @xmath269 , while the @xmath220-blocks of @xmath262 are exactly the sets @xmath244 , @xmath270 @xmath271 and @xmath272 .",
    "this implies that the corresponding blocks of @xmath260 and @xmath262 have the same number and the same size , as required ( note that if @xmath273 and @xmath274 , then the last block in the above list of @xmath211-blocks of @xmath260 is empty ; however , this happens if and only if the last entry in the list of @xmath220-blocks of @xmath262 is empty as well , so it does not violate the required properties of @xmath231 ) .",
    "this concludes the proof of the theorem .",
    "[ cor - calc ] @xmath275 .    since @xmath276 is equal to the number of leaves of the tree @xmath139 , and @xmath277 is equal to the number of leaves of the tree @xmath145 , this is a direct consequence of theorem  [ thm - m132 ] .",
    "[ cor - sym ] @xmath117 .",
    "let @xmath278 denote the dyck word defined by the relation @xmath279 if and only if @xmath280 . by inverting the linear order of the vertices of a matching @xmath21 with base @xmath68",
    ", we obtain a matching @xmath281 with base @xmath278 . since every matching @xmath282 satisfies @xmath283 , we know that a matching @xmath21 avoids @xmath123 if and only if @xmath281 avoids @xmath123 , and hence @xmath284 .",
    "note that @xmath285 .",
    "this gives @xmath286 as claimed .",
    "[ cor-123 - 132 ] @xmath287 .",
    "notice that @xmath288 , and all the other graphs in @xmath123 avoid @xmath289 .",
    "this implies that @xmath290 , and for every @xmath291 there is a @xmath78 for which this is a proper inclusion , because @xmath292 clearly belongs to @xmath293 .",
    "the claim follows , as a consequence of corollary  [ cor - calc ] .",
    "in this section , we prove that @xmath295 .",
    "this result is a special case of a more general theorem by backelin et al .",
    "the new proof we present here provides a simple bijection between @xmath294-avoiding matchings of a fixed base @xmath68 and dyck paths not exceeding the path representing the dyck word @xmath68 .",
    "we first introduce some notation : recall that @xmath296 denotes the set of all dyck paths of length @xmath57 . for two dyck paths @xmath297 and @xmath298 of length @xmath57 , we say that @xmath299 is a _ non - crossing pair _ if @xmath298 never reaches above @xmath297 .",
    "let @xmath300 denote the set of all the non - crossing pairs of dyck paths of length @xmath57 and , for a dyck word @xmath68 of length @xmath57 , let @xmath301 be the set of all the pairs @xmath302 whose first component @xmath297 is the path represented by the dyck word @xmath68 .",
    "recently , chen , deng and du @xcite have proved that @xmath108 by a bijective construction involving dyck paths .",
    "their proof in fact shows that the cardinality of the set @xmath303 is equal to the number of matchings with base @xmath68 avoiding @xmath289 , and at the same time equal to the number of matchings with base @xmath68 avoiding @xmath304 . in our notation",
    ", this corresponds to the following claim : @xmath305    in this section , we extend these equalities to the matching @xmath294 by proving @xmath306 .",
    "this shows that @xmath307 .",
    "we remark that the number of non - crossing pairs of dyck paths of length @xmath57 ( and hence the number of @xmath21-avoiding matchings of size @xmath15 , where @xmath21 is any of @xmath308 or @xmath294 ) is equal to @xmath309 , where @xmath310 is the @xmath15-th catalan number ( see @xcite ) .",
    "the sequence @xmath311 is listed as the entry a005700 in the on - line encyclopedia of integer sequences @xcite .",
    "it is noteworthy , that n. bonichon @xcite has shown a completely different combinatorial interpretation of this sequence , in terms of realizers of plane triangulations .",
    "let us fix @xmath76 and @xmath78 .",
    "let @xmath21 be a matching with base @xmath68 .",
    "let @xmath312 denote the sequence of all the l - vertices with respect to @xmath68 , and @xmath313 be the sequence of all the r - vertices with respect to @xmath68 .",
    "let @xmath314 be the neighbour of @xmath315 in @xmath21 .",
    "an edge @xmath316 of @xmath21 is called _ short _ if @xmath317 , and it is called _ long _ if @xmath318 .",
    "let @xmath319 and @xmath320 denote the set of the short edges and long edges , respectively , so that we have @xmath321 .",
    "an l - vertex @xmath322 is called _ short _ ( or _ long _ ) if it is incident with a short edge ( or a long edge , respectively ) .",
    "let @xmath21 be a matching with base @xmath68 .",
    "@xmath21 avoids @xmath294 if and only if @xmath21 satisfies the following three conditions :    * the subgraph of @xmath21 induced by the short edges avoids @xmath294 . *",
    "the subgraph of @xmath21 induced by the long edges avoids @xmath294 .",
    "* every short l - vertex precedes all the long l - vertices .",
    "the first two conditions are clearly necessary .",
    "the third condition is necessary as well , for if @xmath21 contained an edge @xmath323 and an edge @xmath324 with @xmath325 , then the six vertices @xmath326 would induce a copy of @xmath294 .    to see that the three conditions are sufficient , assume for contradiction that a graph @xmath21 satisfies these conditions but contains the forbidden configuration induced by some vertices @xmath327 .",
    "we first note that @xmath328 : indeed , it is impossible to have @xmath329 , because @xmath330 is not connected to the leftmost vertex , and the inequality @xmath331 would imply that all the three edges of the forbidden configuration are short , which is ruled out by the first condition of the lemma .",
    "thus , the edge @xmath332 is long , and hence @xmath333 is long as well , by the third condition .",
    "this implies that @xmath334 , hence @xmath335 as well , and all the three edges of the configuration are long , contradicting the second condition of the lemma .    to construct the required bijection between @xmath336 and @xmath301",
    ", we will use the intuitive notion of a `` tunnel '' in a dyck path , which has been employed in bijective constructions involving permutations in , e.g. , @xcite or @xcite .",
    "let @xmath337 be a dyck path .",
    "a _ tunnel _ in @xmath337 is a horizontal segment @xmath338 whose left endpoint is the center of an up - step of @xmath337 , its right endpoint is the center of a down - step of @xmath337 , and no other point of @xmath338 belongs to @xmath337 ( see fig .",
    "[ fig - tunnel ] ) .",
    "a path @xmath339 has exactly @xmath15 tunnels .",
    "an up - step @xmath181 and a down - step @xmath340 of @xmath337 are called _ partners _ if @xmath337 has a tunnel connecting @xmath181 and @xmath340 .",
    "let @xmath341 denote the up - steps of @xmath337 and @xmath342 denote the down - steps of @xmath337 , in the left - to - right order in which they appear on @xmath337 .",
    "let @xmath343 be the dyck path represented by the dyck word @xmath68 , let @xmath344 be a non - crossing pair of dyck paths .",
    "let @xmath345 be the unique matching with base @xmath68 satisfying the condition that @xmath316 is an edge of @xmath21 if and only if @xmath346 is the partner of @xmath347 . to see that this definition is valid , we need to check that if @xmath346 is partnered to @xmath347 in a path @xmath337 not exceeding @xmath348 , then @xmath349 in the matchings with base @xmath68 .",
    "this is indeed the case , because the horizontal coordinate of @xmath350 ( which determines the position of @xmath322 in the matching ) does not exceed the horizontal coordinate of @xmath346 , while the horizontal coordinate of @xmath347 does not exceed the horizontal coordinate of @xmath351 ( note that a half - line starting in the center of @xmath346 directed north - west intersects @xmath348 in the center of @xmath350 ; similarly , a half - line starting in the center of @xmath347 directed north - east hits the center of @xmath351 ) .",
    "see fig .",
    "[ fig - tuhr ] .     and a matching @xmath345 .",
    "a tunnel between @xmath346 and @xmath347 corresponds to an edge @xmath316 .",
    "the filled dots above the pair of paths represent the l - vertices of the matching , the empty dots represent the r - vertices . ]    [ lem - gpm231 ] if @xmath344 , then @xmath345 avoids @xmath294 .",
    "choose an arbitrary @xmath344 and assume , for contradiction , that there are six vertices @xmath327 in @xmath345 which induce the forbidden configuration .",
    "let @xmath352 and @xmath353 be the tunnels corresponding to the three edges @xmath354 , @xmath355 and @xmath356 , respectively .",
    "note that the projection of @xmath357 onto some horizontal line @xmath358 is a subset of the projections of @xmath359 and @xmath353 onto @xmath358 .",
    "thus , the three tunnels lie on different horizontal lines and there is a vertical line intersecting all of them .    since @xmath360",
    ", the tunnel @xmath359 must lie below @xmath353 , otherwise the subpath of @xmath337 between @xmath361 and @xmath362 would intersect @xmath359 .",
    "on the other hand , @xmath363 implies that @xmath359 lies above @xmath353 , a contradiction .",
    "the aim of the next lemma is to show that the mapping @xmath364 can be inverted .",
    "[ lem - indm231 ] for every @xmath365 there is a unique dyck path @xmath337 such that @xmath366 and @xmath367 .",
    "we proceed by induction on @xmath15 .",
    "the case @xmath368 is clear , so let us assume that @xmath369 and that the lemma holds for every @xmath370 and every @xmath371 .",
    "let us choose an arbitrary @xmath78 , and an arbitrary @xmath365 , and define @xmath7 such that @xmath372 is an edge of @xmath21 .",
    "let @xmath373 be the matching from @xmath374 that is isomorphic to the subgraph of @xmath21 induced by the short edges , let @xmath375 be isomorphic to the subgraph induced by the long ones , let @xmath376 and @xmath377 be the respective bases of @xmath373 and @xmath378 , and let @xmath379 and @xmath380 be the dyck paths corresponding to @xmath376 and @xmath377 . by induction , we know that @xmath381 and @xmath382 for some dyck paths @xmath383 and @xmath384 , where @xmath383 does not exceed @xmath379 , and @xmath384 does not exceed @xmath380 . let @xmath385 be the dyck word @xmath386 , and let @xmath387 be the corresponding dyck path .",
    "note that @xmath387 does not exceed @xmath348 : assume that @xmath348 has @xmath338 up - steps occurring before the @xmath7-th down - step ; then @xmath387 is obtained from @xmath348 by omitting the @xmath388 up - steps @xmath389 , and inserting @xmath388 new up - steps directly after the @xmath7-th down - step .",
    "let @xmath337 be the dyck path obtained by concatenating the following pieces :    * an up - step from @xmath50 to @xmath390 * a shifted copy of @xmath383 from @xmath390 to @xmath391 * a down - step from @xmath391 to @xmath392 * a shifted copy of @xmath384 from @xmath392 to @xmath393    since @xmath337 clearly does not exceed @xmath387 , it does not exceed @xmath348 either .",
    "let us check that @xmath367 :    * the base of @xmath21 is equal to the base of @xmath345 .",
    "thus , to see that @xmath21 is equal to @xmath345 , it suffices to check that @xmath373 and @xmath378 are isomorphic to the matchings induced by the short edges of @xmath345 and the long edges of @xmath345 , respectively . *",
    "the up - step @xmath394 is clearly partnered to the down - step @xmath395 ( which connects @xmath391 to @xmath392 ) .",
    "thus , @xmath345 contains the edge @xmath396 .",
    "it follows that @xmath345 has @xmath397 short edges , incident to the l - vertices @xmath398 and r - vertices @xmath399 . *",
    "the @xmath397 up - steps @xmath400 as well as the @xmath397 down - steps @xmath401 all belong to the shifted copy of @xmath383 .",
    "since shifting does not affect the partnership relations , we see that the short edges of @xmath345 form a matching isomorphic to @xmath381 . * similarly , the up - steps @xmath402 @xmath403 are partnered to the down - steps @xmath404 , @xmath405 according to the tunnels of @xmath384 .",
    "the corresponding long edges form a matching isomorphic to  @xmath378 .",
    "it follows that @xmath367 .",
    "we now show that @xmath337 is determined uniquely : assume that @xmath406 for some @xmath407 .",
    "since @xmath408 , the path @xmath409 must contain a down step from @xmath391 to @xmath392 , and this down - step must be the first down - step of @xmath409 to reach the line @xmath410 .",
    "this shows that the subpath of @xmath409 between @xmath390 and @xmath391 is a shifted copy of some dyck path @xmath411 .",
    "the tunnels of this path must define a matching isomorphic to @xmath412 . by induction , we know that @xmath383 is determined uniquely , hence @xmath413 . by the same argument",
    ", we see that the subpath of @xmath409 from @xmath392 to @xmath393 is a shifted copy of @xmath384 .",
    "this shows that @xmath414 , and @xmath337 is unique , as claimed .",
    "we are now ready to prove the following theorem :    [ thm - m231 ] for each @xmath76 and for each @xmath78 , @xmath415 is equal to @xmath416 .",
    "putting together lemma  [ lem - gpm231 ] and lemma  [ lem - indm231 ] , we infer that the function that maps a pair @xmath417 to the matching @xmath345 is a bijection between @xmath301 and @xmath336 .",
    "this gives the required result .",
    "@xmath295 .    this a direct consequence of theorem  [ thm - m231 ] and the results of chen , deng and du @xcite .",
    "we have introduced an equivalence relation @xmath89 on the set of permutational matchings , and we have determined how this equivalence partitions the set of permutational matchings of order 3 . however , many natural questions remain unanswered . for instance , it would be nice to have an estimate on the number of blocks of @xmath89 belonging to the set @xmath73 . also , is it possible to characterize the minimal and the maximal elements of @xmath418 ?",
    "i am grateful to martin klazar for his comments and suggestions .",
    "i would also like to thank anna de mier and zvezdelina stankova for pointing out useful references to related research ."
  ],
  "abstract_text": [
    "<S> how many matchings on the vertex set @xmath0 avoid a given configuration of three edges ? </S>",
    "<S> chen , deng and du have shown that the number of matchings that avoid three nesting edges is equal to the number of matchings avoiding three pairwise crossing edges . in this paper </S>",
    "<S> , we consider other forbidden configurations of size three . </S>",
    "<S> we present a bijection between matchings avoiding three crossing edges and matchings avoiding an edge nested below two crossing edges . </S>",
    "<S> this bijection uses non - crossing pairs of dyck paths of length @xmath1 as an intermediate step .    </S>",
    "<S> apart from that , we give a bijection that maps matchings avoiding two nested edges crossed by a third edge onto the matchings avoiding all configurations from an infinite family @xmath2 , which contains the configuration consisting of three crossing edges . </S>",
    "<S> we use this bijection to show that for matchings of size @xmath3 , it is easier to avoid three crossing edges than to avoid two nested edges crossed by a third edge .    in this updated version of this paper , we add new references to papers that have obtained analogous results in a different context . </S>"
  ]
}