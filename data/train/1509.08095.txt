{
  "article_text": [
    "urban transportation systems interweave our everyday life and although their construction is based on conscious design they appear with complex structural and dynamical features @xcite . they build up from different transportation means , which connect places in a geographical space .",
    "their most straightforward description is given by networks @xcite where stations are identified as nodes and links are the transportation connection between them . based on this representation @xcite considerable research efforts",
    "have been dedicated to address their sustainability @xcite and to optimise their efficiency @xcite , and reliability @xcite .",
    "these investigations have been accelerated lately by the availability of large open datasets describing complete multimodal transportation systems in cities , regions , countries , and even internationally .",
    "these advancements became possible due to the novel techniques of data collections , and amplified by the actual trends in urban policy propagating smart city programs and real time online user services .",
    "all transportation networks share a few common features : ( a ) they are all embedded in space , setting constraints in their structural design , ( b ) networks of different transportation means may coexist in the same space , and ( c ) they are all inherently temporally - resolved .",
    "the recent developments in data collection practices and in the corresponding fields of complex networks and human dynamics provided the opportunity to study these systems quantitively using a data - driven approach .",
    "these studies showed that geographical constraints largely determine the structure and scaling of transportation networks @xcite but for their better understanding one needs to consider the actual urban environment and development level @xcite . at the same time the emerging field of multilayer networks provided the methodology to consider their multimodal character @xcite . in this representation",
    "each layer corresponds to the network of a single transportation mean ( bus , tram , train , etc . ) , which are defined on the same set of nodes ( stations ) . this way they account for possible multiple links of different modes between the same stations @xcite .",
    "this representation can be extended to capture the temporal nature of the system by using some aggregated information extracted from the transportation schedule @xcite or , as a future challenge , by considering each time slot as a layer where journeys between stations are represented as temporal links @xcite .    in this paper",
    "we build on these contemporary advancements to analyse large transportation networks of french municipalities represented as time - resolved multilayer networks .",
    "our aim is to provide a novel user - based framework to represent public transportation systems by incorporating the minimisation of the total travel time , its variability across the schedule , and taking into account the number of transfers between lines .",
    "such framework allows to identify non - trivial connection patterns in the transportation network and to quantify the network s overall efficiency as compared to the specific demand and to the car alternative .",
    "the datasets we use are openly shared by local public transportation companies operating in the larger paris area , toulouse , nantes , and strasbourg .",
    "the collected data corpora are in general transit feed specification ( gtfs ) format and contains the geographically detailed informations about transportation trips and routes , together with travelling times , frequencies and transfer times for each service line and station .",
    "as follows first we describe the actual time - resolved multilayer network representation and introduce a methodology incorporating travel routes and times to identify efficient transportation connections as compared to travels by cars .",
    "next we apply matrix factorisation methods to extract underlying connectivity patterns to analyse them from the commuter point of view , and quantify their overall efficiency .",
    "finally we conclude our results and discuss possible applications and future directions of research .",
    "note that the implementation of the proposed methodology is openly accessible online .",
    "the proposed methodology integrates several sequential steps to detect origin - destination areas that are conveniently connected by public transportation with respect to user preferences . in the following description , first we define a user - based representation of a public transportation ( pt ) system , which limits the effect of its spatial embeddedness , but accounts for its multilayer structure , and its temporal dimension .",
    "next , we calculate shortest time paths between stops by adapting a conventional algorithm @xcite to the actual graph representation , and finally we select preferred connections , taking into account distance traveled over time .",
    "several studies revealed that the choice of users to select transportation means for commuting is mainly affected by the average travel time , and by the variability of the total travel time @xcite , in addition to the number of transfers they need to do .",
    "other less determinant factors , that we do not consider here , include travel cost and comfort .",
    "our representation of the pt network incorporates the aforementioned aspects decisive for users and minimises the effects due to the spatial embeddedness of the system . in order to do",
    "so we combine a multi - edge @xcite and a p - space representation of the transportation network @xcite to describe the pt systems .",
    "the multi - edge representation accounts for the presence of several transportation lines in the same pt network by allowing the existence of multiple labelled edges within a single pair of nodes . on the other hand ,",
    "the p - space representation takes into account that transfers between lines is time - consuming and may not be convenient for the user ; also , it considers connections between stops located at large distance thus it reduces the effect of the geographical distances .",
    "the combination of these two representations for modelling public transportation systems constitutes an ideal framework to investigate their complex features from the user perspective .",
    "a schematic example of this representation is displayed in fig .",
    "[ schemapaths ] .",
    "formally , the public transportation system is defined as a weighted , directed , edge labelled graph @xmath0 with vertex set @xmath1 with cardinality @xmath2 , corresponding to the public transportation stops , edge set @xmath3 with weight function @xmath4 , and set of transfers @xmath5 with weight function @xmath6 .",
    "if @xmath7 is defined as an ordered sequence of stops connected consecutively by a single transportation line , in the corresponding p - space graph @xmath8 there will be a direct labelled - edge @xmath9 connecting any pair of nodes @xmath10 such that stop @xmath11 proceeds stop @xmath12 in the sequence of line @xmath7 .",
    "we define @xmath13 as the total number of lines in the pt system .",
    "further , a set @xmath14 of transfers identifies triplets of two lines and one node , @xmath15 such that a transfer between lines @xmath16 and @xmath17 is possible at station @xmath12 .",
    "each edge in @xmath3 is weighted by the average travel time on the line considered , computed as follows .",
    "this average and those following are made on a selected time window of the schedule .",
    "we introduce a @xmath18 function @xmath19 , quantifying for each edge @xmath20 the time needed to get from @xmath11 to @xmath12 along the line @xmath7 averaged on the selected time window .",
    "the travel time linked to an edge @xmath9 is then calculated as the sum of the average waiting time and the average time spent on the vehicle as @xmath21 where @xmath22 is the average frequency of line @xmath7 and @xmath23 is the average time one needs to spend on line @xmath7 to go from stop @xmath11 to stop @xmath12 .",
    "this formula is designed to consider the case where a user would go blindly to a stop ( without looking at the schedule ) . that creates a bias towards lines with high frequency thus with less variability and accounts for modelling the preference of the user for small variability in the total travel time .",
    "finally the transfer time function @xmath24 quantifies for each transfer @xmath25 the time needed to change between lines @xmath26 and @xmath27 at node @xmath12 .    in such description",
    "the temporality of the system is included through the weights .",
    "the choice not to model the system as a temporal graph is motivated by the fact that in urban public transportation systems the total travel time is subject to variability and this factor matters considerably for the user when deciding to opt for public transportation service .",
    "the previously defined public transportation graph @xmath0 is used to calculate shortest time paths between stops . in the multi - edge representation a path",
    "is defined as a sequence of edges @xmath28 connecting an origin node @xmath29 to a destination node @xmath30 through a sequence of consecutive trips made on @xmath31 lines , @xmath32 . considering also",
    "the sequence of corresponding transfers between lines @xmath33 the shortest time paths between origin and destination are taken as the smallest durations measured among the different alternative paths . each time length @xmath34 is defined as the sum of the average time needed to wait , travel and transfer between lines . to calculate shortest time paths between any stops we adapt the dijkstra algorithm @xcite to multi - edge graphs . while the original version of the algorithm computes the minimal distance between any origin @xmath29 and destination @xmath30 nodes by considering the sum of link weights , the modified version accounts for the fact that not only the link weights have to be taken into consideration but also the transfer time , i.e. the cost to change between links ( see si , section 3 for more details ) .",
    "to consider the preference of users to change lines a limited number of times we allow at most two transfers in a single path , i.e. , we limit @xmath35 . after computing the shortest paths between all nodes in the graph we characterise the distribution of shortest travelling times between all nodes whose physical distance falls within a specific range .",
    "privileged connections at a specific distance range - timely speaking - can be identified by selecting the lower part of the travel time distribution ( i.e. the best times for a given distance ) , which gives the best connections at a given distance relatively to the public transportation system considered .",
    "the methodology presented above has been implemented to be applicable to transportation network informations given in gtfs format where trips , routes , travelling times , frequencies and transfer times are recorded for each service line and station in the transportation system ( for further details see si , section 1 ) . this type of data is openly accessible for several cities worldwide , from which here we consider municipal areas in france .",
    "we build the p - space multi - edge representations of larger paris , strasbourg , nantes , and toulouse by extracting the relevant information from corresponding gtfs datasets .",
    "this procedure starts by identifying a period of @xmath36 weeks such that the total number of trips per day presents only weak fluctuations . here",
    ", we are interested in trips planned between @xmath37 and @xmath38 ( note that the choice of @xmath39 , @xmath40 , and @xmath41 are adjustable parameters ) .",
    "such choice for the time window of study is motivated both because we focus on morning commuting patterns , and because during this time interval the frequency of services is considerably higher with respect to the rest of the day .",
    "typical line frequencies and trip durations are then defined as their averages over the selected time window over the four weeks .    finally , building on the multi - edge p - space representation and the estimation of the typical times and frequencies ,",
    "we compute the typical shortest time paths between any origin and destination in the city . the implementation of this methodology is available online ] and requires as input any dataset in gtfs format and parameters summarised in the si .",
    "we demonstrate one possible use of our framework through the examples of the pt systems of larger paris , strasbourg , nantes , and toulouse . after selecting privileged connections ,",
    "we apply non - negative matrix factorisation to the graph of the privileged connections to identify underlying patterns of privileged connections .",
    "finally , we compare our findings with independent measures of commuting patterns , which allow us to give an estimation about the efficiency of the pt systems .",
    "we used the method previously presented to compute the shortest time paths for each origin - destination pairs of the transportation systems of bus , train and metro ( when possible ) .",
    "based on these calculations we built a time - distance map , which assigns the physical distance @xmath42 and the shortest time path length @xmath43 to each origin ( @xmath29 ) - destination ( @xmath30 ) pair .",
    "this time - distance map was drawn as a heat - map in fig .",
    "[ fig:2dhist ] for paris and the other investigated cities , and can be used to identify patterns of privileged connections .     and",
    "@xmath44 divided into @xmath45 number of bins with equal size @xmath46 meters . in a similar way we divided the considered time range of @xmath47 hours into @xmath48 number of time bins of size @xmath49 minute .",
    "colours indicate the logarithm of the number of origin - destination pairs in a given range time - distance bin . ]    in order to focus on the most efficient connections with respect to the public transportation system of the city considered , we selected the trips responsible for the @xmath50 lower part of the time distributions for each distance . to estimate , how these connections among the best at the urban agglomeration level compare to travels by car for the same distances , we computed the travel time factor , i.e. the ratio between the travel time taken by public transportation and by car , for each urban agglomeration , as explained below .",
    "after building the histogram of shortest time paths for every distance bin , we compared the travel time of selected paths with the travel time needed to cover the same distance by car .",
    "car commuting times were extracted from the french 2008 enqute nationale transports et dplacements 2007 - 2008 dataset @xcite describing the global mobility of people living in france . to collect this",
    "data individuals were asked how far ( with resolution of 1 km ) , how long ( with resolution of 1 minute ) , and by which transportation mean they travel every day . based on this dataset we computed the median of the travel time distributions at each distance using the entire sample to measure the typical time needed to commute to a particular distance by car .",
    "similarly , we calculated the medians of the best @xmath51 of the time distribution at each distance ( i.e. shortest times for a given distance ) travelled by public transportation .",
    "this enables to compute the travel time factor as displayed in fig.[fig : selection ] for different selections of the best times taken by public transportation . by selecting the best connections responsible for the @xmath50 lower part of the time distributions for each distance , in paris agglomeration , we consider trips whose duration is at most @xmath52 times the time needed by car",
    "this is in agreement with the travel time factor tolerated by users @xcite .",
    "studies have revealed that commuters typically consider to take public transportation if the travel time factor does not exceed 1.6 @xcite .",
    "for the other agglomerations studied , the travel time factor goes above this value for distances travelled greater than @xmath53 .",
    "we remark that while in paris the travel time factor tend to saturate at large distance meaning that efficient connections exist also at the inter - city level , this is not conspicuous for the other cities ( see fig.[fig : selection].b - d ) .",
    "public transportation seems to provide an efficient alternative to car mainly for short trips .",
    "note that in the histograms and travel time factor calculations we do not use the best absolute time to travel a given distance by pt but a time estimation of a user arriving blindly at a stop in order to take into account the preferences of users for path with small variability in time .",
    "in addition , the time travelled by car for each distance is taken from the data in the whole country and may thus be underestimated for cities subject to urban congestion trafic .",
    "these two points may lead to an overestimation of time travel factors .",
    "thus , here , the travel time factor can not be used directly as a criterion to select the best connections but only gives a common metric to look at the different public transportation systems .     and @xmath54 lower part of the time distribution for each distance travelled by public transportation for the following cities ( including their surrounding areas ) ( a ) paris , ( b ) toulouse , ( c ) nantes , and ( d ) strasbourg.,scaledwidth=80.0% ]      the goal of this section is to understand whether the identified set of privileged connections reveals any higher order meaningful patterns in the design of the transportation system that will help to characterise the network and to better capture its underlying structure .",
    "we expect that some stops , like stations located in residential neighbourhoods , may have similar connectivity patterns to the rest of the network e.g. to the city centre or to working areas . in order to identify such patterns",
    ", we first built an undirected , unweighted graph @xmath55 , where @xmath56 and @xmath57 is a set of edges linking origin - destination locations identified as being well connected ( i.e. in the 1% selection ) .",
    "such a graph is displayed for paris in fig .",
    "[ fig : patt]a",
    ". then , to compare commuters travelling at particular distances we analysed subgraphs @xmath58 of @xmath59 , where edges join stops at particular distances @xmath30 such that @xmath60 .",
    "each subgraph @xmath58 is represented by an adjacency matrix @xmath61 . for the city of paris we considered intervals for distances with resolution of @xmath62 kilometer . for the other cities we considered distances with resolution of @xmath63 kilometers as the transportation network",
    "is much less dense spatially for latter cases ( see si fig.1 ) .",
    "both cohesive , and bipartite structures can exist in these subgraphs .",
    "the cohesive structures would correspond to sets of stations well connected between themselves while the bipartite structures would single out two groups of stops such that many connections exist between the two groups .",
    "the connections may not be direct but should have durations comparable to the average time taken by car by definition .",
    "the likelihood of having a link between any two stations can be expressed in term of the possible links of these stations to the same structures .",
    "formally , it means we can express each term of the adjacency matrix representing @xmath59 as @xmath64 , where @xmath65 is a value quantifying the ingoing membership of node @xmath11 to structure @xmath66 and @xmath67 a value quantifying the outgoing affiliation of the node @xmath12 to the structure . in order to find matrices @xmath68 and @xmath69 , we performed matrix factorisation , minimising numerically the distance @xmath70 , where @xmath71 is the frobenius norm of matrix @xmath72 ( for further details see si , section 2 ) .",
    "matrix factorisation was shown to be successful in detecting communities and richer structures in graphs @xcite .",
    "the number of structures to be detected was determined by the bi - cross validation ( bicv ) approach proposed in @xcite based on cross - validation , a common machine learning model validation technique .",
    "this consists of measuring an error , called @xmath73 here , between an estimation of left out entries using a low rank approximation of the retained data and the actual left out entries .",
    "this error is decreasing with respect to the number of structures extracted toward a minimum that indicates how many structures are representative of the subgraphs ( more details in the si , section 4 ) .",
    "when the network is close to random , the error does not show such a behaviour .",
    "thus , to identify whether there is a lack of structures in subgraphs , we compared the @xmath73 error with the one obtained for the corresponding null models ( fig .  [",
    "fig : patt]b ) defined for each adjacency matrix @xmath74 as its corresponding random matrices @xmath75 with the same size and density .",
    "an example of the behaviour of such a quantity for paris public transportation network is displayed on fig .",
    "[ fig : patt]b ( for other cities see si , fig.1 ) .",
    "this quantity was computed for each subgraph , i.e. subsets of shortest paths at different distance intervals .",
    "this guided us on how many structures characterise each system at each range of distance .",
    "for some distance ranges and cities , the evolution of @xmath73 is close to the random case meaning that one does not detect any strong attempt to link preferentially some areas at the considered range of distance ( see si , fig.2 ) .",
    "in several cases bipartite structures can be found , like the two examples in fig.[fig : patt]c and d detected in the paris network .",
    "the bipartite structures can be assimilated to strategical areas that are particularly well connected by pt .",
    "for example the structure shown in figure [ fig : patt]c , connects stops located around paris orly airport to stops located at the border of paris central area .",
    "in figure [ fig : patt]d , the structure reveals the existence of privileged connections the nanterre and creteil areas in one side ( both with high employment density ) , with paris center on the other side . as these structures are latent patterns extracted from the networks of priviledged connections , we consider them as the privileged origin - destination patterns representative of the transportation systems .",
    "to estimate how well the different public transportation networks are devoted to answer the needs of commuters , we compared the identified privileged origin - destination patterns to the flows of commuters . to do so",
    ", we used data of the 2010 french census @xcite including origin - destination commuter flows per transportation mean at the level of the municipality for the large areas of strasbourg , toulouse and nantes and at the level of the municipal arrondissement ( neighbourhood ) for paris agglomeration . using this dataset we compared the detected privileged origin - destination patterns to the commuting patterns by car and pt .",
    "we only consider inter - municipality trips for the comparison as the resolution provided for the commuter dataset is given at the municipality level .",
    "the number of intra - city trips is provided in si tab.s4 .    to draw a comparison , we first built the pt structural pattern network @xmath76 of each urban agglomeration as an unweighted , undirected graph .",
    "the set of nodes @xmath77 is defined as municipalities and a link @xmath78 between municipalities @xmath79 and @xmath80 exists if at least one stop located in @xmath79 and one stop in located @xmath80 appear in each side of a detected bipartite structure .",
    "in other words , the structural pattern networks are composed of links between municipalities presumably well connected by public transportation . at the same time , exploiting census data , we built a commuter flow network for each city and its surrounding area , as a weighted , directed graph @xmath81 . here",
    "@xmath82 is the set of municipalities , and a link @xmath83 with weight @xmath84 represents the flow of individuals commuting from @xmath79 to @xmath80 by mean @xmath85 ( either pt or car ) .",
    "then we compared the structural pattern graph with the commuter flow graphs both of the car and the pt of each urban agglomeration by computing a weighted jaccard index @xmath86 between the sets of links associated to each graph .",
    "this weighted index is defined as the sum of the flow graph weights of the links in common between the two graphs - structural and flow by the selected transportation mean - divided by the total flow for the transportation mean considered .",
    "the weighted jaccard index is calculated as follows : @xmath87 both for @xmath88 and @xmath89 .",
    "it represents the fraction of commuters using respectively car and pt , who have access to privileged pt connections ( i.e. for which there exists a link corresponding to their commute in the pt structural pattern ) .",
    "bar charts of fig .",
    "[ ptvscar ] show comparisons among weighted jaccard indices measured by considering the car commuting flow @xmath90 and the pt commuting flow @xmath91 for several urban agglomerations .",
    "a significant difference between the commuting practice in paris agglomeration and other urban areas is observed . for paris urban agglomeration ,",
    "the flow of inter - municipality commuters choosing pt is larger than that of people commuting by car , in contrast to the other investigated cities .",
    "this may be partly explained by a travel time factor , which increases above the tolerated value for toulouse , nantes and strasbourg ( see fig .  [",
    "fig : selection ] ) .",
    "besides , figure [ ptvscar ] indicates that the fraction of commuters having access to privileged connections ( defined as previously ) and using the pt systems is larger than the fraction of them using the car for all urban agglomerations studied .",
    "this comforts our definition of privileged connections based on commuting time with little variability and a limited transfer number .",
    "this corroborates the strong role of the latter factors in the decision making to use pt or car .",
    "furthermore , we observe that in the larger paris area only @xmath92 of car commuters have access to privileged transportation connection . instead , in other cities ,",
    "although more than @xmath93 of car drivers have access to presumably privileged connections , they still commute by car .",
    "in particular , in toulouse a large percentage of commuters have access to good services according to the criteria introduced here , as there is large overlap between privileged connections and both pt ( @xmath94 ) and car ( @xmath95 ) commuting flows , however , there is still a non - negligible amount of people commuting by car .",
    "we distinguish two main trends in commuting : there are cities where a large part of the population tend to do inter - municipality trips by car disregarding the quality of pt services based on the aforementioned factors , examples are nantes , toulouse , and strasbourg . on the other hand , in paris and its agglomeration , according to the metrics introduced , there is a good agreement between the needed and provided services of public transportations .",
    "the framework presented here along with its implementation allows us to gain insight in the structure of public transportation networks from a user point of view .",
    "it is detaching from the constraints imposed by the spatial embeddedness of this type of network and incorporates temporal variance of its schedule .",
    "it gives a way to characterise the public transportation system of different cities by identifying where some efforts have been put , not only structurally , but also in terms of the frequency of the connections . as an illustration for the use of the presented methodology we quantified the efficiency of transportation systems regarding the flow of commuters , in other words ,",
    "how well the transportation system answers the need of its users .",
    "several extensions of our methodology are possible .",
    "parameters like the periods in focus , length of observations , number of transfers , etc . can be tailored for other systems , while a further refinement is possible by considering needs of other types of users . regarding the structures extracted by the factorisation method , even though one sees that many of them are linked to commuting patterns",
    ", one can focus on their more precise interpretation in a future study .",
    "this research was supported by the lagrange project of the isi foundation funded and by the crt foundation by the fet multiplex project ( eu - fet-317532 ) funded by the european commission .",
    "la is thankful for the dante inria team and the isi foundation for funding her internship and for ens de lyon for the ampre excellence fellowship .",
    "the funding bodies had no role in study design , data collection and analysis , preparation of the manuscript , or the decision to publish .",
    "10    albeverio s , andrey d , giordano p , vancheri a. ( eds . ) 2008 the dynamics of complex urban systems : an interdisciplinary approach .",
    "physica - verlag ( heidelberg ) ( doi:10.1016/s0191 - 2615(97)00039 - 8 . )    sheffi y. 1985 urban transportation networks .",
    "prentice - hall , englewood cliffs , nj .    bell mgh , iida y. 1997 transportation network analysis .",
    "sen p , dasgupta s , chatterjee a , sreeram pa , mukherjee g , manna ss .",
    "2003 small - world properties of the indian railway network .",
    "e. _ * 67 * , 036106 ( doi/10.1103/physreve.67.036106 ) .",
    "kennedy c , miller e , shalaby a , maclean h , coleman j. 2005 the four pillars of sustainable urban transportation . _",
    "* 25*(4),393414 ( doi10.1080/01441640500115835 ) .",
    "1980 evaluation and optimization of urban public transportation networks .",
    "res . _ * 5*(6 ) , 396404 ( doi:10.1016/0377 - 2217(80)90126 - 5 )    banavar jr , maritan a , rinaldo a. 1999 size and form in efficient transportation networks .",
    "_ nature _ * 399*(6732 ) , 130132 ( doi:10.1038/20144 ) .",
    "bates j , polak j , jones p , cook a. 2001 the valuation of reliability for personal travel .",
    "e - log . _ * 37*(2 - 3):191229 ( doi : s1366 - 5545(00)00011 - 9 ) .",
    "carey m. 1998 optimizing scheduled times , allowing for behavioural response .",
    "b - meth . * 32*(5 ) , 329342 ( doi10.1016/s0191 - 2615(97)00039 - 8 ) .    niels  van oort r. 2009 regularity analysis for optimizing urban transit network design",
    "transp . _ * 1*(2 ) , 155168 ( doi:10.1007/s12469 - 009 - 0012-y ) .",
    "derrible s , kennedy c. 2009 network analysis of world subway systems using updated graph theory .",
    "record : j. transp .",
    "board _ * 2112 * , 1725 ( doi:10.3141/2112 - 03 ) .",
    "sienkiewicz j , hoyst ja .",
    "2005 statistical analysis of 22 public transport networks in poland .",
    "e. _ * 72 * , 046127 ( doi:10.1103/physreve.72.046127 ) .",
    "levinson d. 2012 network structure and city size .",
    "_ plos one _ * 7*(1 ) ( doi:10.1371%2fjournal.pone.0029721 ) .",
    "louf r , roth c , barthelemy m. 2014 scaling in transportation networks . _",
    "plos one _ * 9*(7 ) ( doi:10.1371%2fjournal.pone.0102007 ) .",
    "louf r , barthelemy m. 2014 how congestion shapes cities : from mobility patterns to scaling .",
    "rep . _ * 4 * , 5561 ( doi:10.1038/srep05561 ) .",
    "kivel m , arenas a , barthelemy m , gleeson jp , moreno y , porter ma .",
    "2014 multilayer networks .",
    "_ j. complex netw . _ * 2*(3 ) , 203271 ( doi:10.1093/comnet / cnu016 ) .",
    "boccaletti s , bianconi g , criado r , del genio ci , gmez - gardees j , romance m , et  al .",
    "2014 the structure and dynamics of multilayer networks . _ phys .",
    "rep . _ * 544*(1 ) , 1122 ( 10.1016/j.physrep.2014.07.001 ) .",
    "tsiotas d , polyzos s. 2015 decomposing multilayer transportation networks using complex network analysis : a case study for the greek aviation network .",
    "_ j. complex netw . _ * cnv003 * ( doi:10.1093/comnet / cnv003 ) .",
    "gallotti r , barthelemy m. 2015 the multilayer temporal network of public transport in great britain .",
    "_ sci . data . _ * 2 * , 140056 + ( doi:10.1038/sdata.2014.56 ) .",
    "holme p , saramki j. 2012 temporal networks .",
    "rep . _ * 519*(3 ) , 97125 ( doi:10.1016/j.physrep.2012.03.001 ) .",
    "cormen th , leiserson ce , rivest rl , stein c. 2001 introduction to algorithms , 2nd ed . the mit press .",
    "asperges t , cornelis e , steenberger t , et .",
    "2007 dterminants des choix modaux dans les chaines de dplacements .",
    "rsum , plan dappui scientifique  une politique de dveloppement durable ( padd ii ) , partie 1 .",
    "goo.gl/qf7sjx    le  jeanic t , armoogum j , bouffard - savary e , et .",
    "2010 la mobilit des franais , panorama issu de lenqute nationale transports et dplacements 2008 . paris : ministre de lcologie , du dveloppement durable , des transports et du logement .",
    "lillo  viedma fe .",
    "2011 coloured - edge graph approach for the modelling of multimodal networks .",
    "( phd thesis ) auckland university of technology .",
    "sen p , dasgupta s , chatterjee a , sreeram pa , mukherjee g , manna ss . 2003",
    "small - world properties of the indian railway network .",
    "* 67*(3 ) , 036106 ( doi:10.1103/physreve.67.036106 ) .",
    "sienkiewicz j , hoyst ja .",
    "2005 statistical analysis of 22 public transport networks in poland .",
    "e _ * 72*(4 ) , 046127 ( doi:10.1103/physreve.72.046127 ) .",
    "von  ferber c , holovatch t , holovatch y , palchykov v. 2009 public transport networks : empirical analysis and modeling .",
    "* 68*(2 ) , 261275 ( doi:10.1140/epjb / e2009 - 00090-x ) .",
    "enqute nationale transports et dplacements 2007 - 2008 . 2008 http://goo.gl/5cz6rl    psorakis i , roberts s , ebden m , sheldon b. 2011 overlapping community detection using bayesian non - negative matrix factorization .",
    "e _ * 83*(6 ) , 066114 ( doi:10.1103/physreve.83.066114 )    wang f , li t , wang x , zhu s , ding c. 2011 community discovery using nonnegative matrix factorization .",
    "_ data min .",
    "disc . _ * 22*(3 ) , 493521 ( doi:10.1007/s10618 - 010 - 0181-y )    zhang s , wang rs , zhang xs .",
    "2007 uncovering fuzzy community structure in complex networks .",
    "e _ * 76*(4 ) , 046103 ( doi:10.1103/physreve.76.046103 ) .",
    "psorakis i , roberts s , sheldon b. 2010 efficient bayesian community detection using non - negative matrix factorisation .",
    "_ arxiv:10092646_;.    zhang zy , wang y , ahn yy . 2013 overlapping community detection in complex networks using symmetric binary matrix factorization .",
    "e 87(6 ) , 062803 ( doi:10.1103/physreve.87.062803 ) .",
    "he d , jin d , baquero c , liu d. 2014 link community detection using generative model and non - negative matrix factorization .",
    "_ plos one _ * 9*(1 ) , e86899 ( doi:10.1371/journal.pone.0086899 ) .",
    "cao x , wang x , jin d , cao y , he d. 2014 the ( un ) supervised detection of overlapping communities as well as hubs and outliers via ( bayesian ) nmf .",
    "proceedings of the companion publication of the 23rd international conference on world wide web companion .",
    "p. 233234 .",
    "owen ab , perry po . 2009 bi - cross - validation of the svd and the non - negative matrix factorization . _",
    "stat . _ * 3*(2 ) , 564594 ( doi:10.1214/08-aoas227 ) .",
    "fichier mobilits professionnelles des individus : dplacements commune de rsidence / commune de travail .",
    "2010 http://goo.gl/jyjqf8 .",
    "supplementary information for + * user - based representation of time - resolved multimodal public transportation networks * + laura alessandretti , mrton karsai and laetitia gauvin@xmath96 + @xmath97corresponding author email : marton.karsai@ens-lyon.fr +",
    "with the aim of catching a comprehensive picture of the public transportation ( pt ) networks in french municipal areas we made use of datasets provided by local public transportation companies .",
    "the characteristics of the datasets used for the different cities are listed in table s[table1 ] . estimated timetable schedules for the public transport service",
    "are made publicly available online and frequently updated by the companies .",
    "l l l l * city * & * area * & * period * & * companies * + paris & 47.96n-49.45n 1.15w-3.51w & sep - oct 2013 &    .table listing the main characteristics of the data used for each of the cities [ cols= \" < , < \" , ]      in order to establish a comparison between the commuting patterns and the efficient connections of the transportation systems , we matched the insee dataset with the pt data by associating to each of the stops in the pt data its corresponding municipality ( or neighbourhood in the case of paris ) .",
    "we made use of the google maps api @xcite to assign to the latitude - longitude coordinates of each pt stop its corresponding address .",
    "then , we matched the municipality to its corresponding insee code via the file _ base communale des aires urbaines 2010 _ provided by insee .",
    "in this section , we explain non - negative factorisation was achieved in order to extract structures from the transportation system dataset .",
    "aiming at minimising the euclidean distance loss function between the original matrix and the factorized one , we implemented the standard multiplicative rule developed by lee and seung in @xcite : @xmath98      the nmf algorithm may not converge to the same solution at each run , depending on the initial conditions . to address this problem we initialise the matrices @xmath68 and @xmath69 randomly and run the algorithm 500 times . at each iteration",
    "we compute the divergence @xmath99 and we select the iteration for which the error was minimal .    in the present case ,",
    "the algorithm turns out to be stable and the results are robust for large networks , future development of this work could however include the study of a consensus clustering procedure .",
    "consensus clustering is the problem of reconciling clustering information about the same data set coming from different runs of the same algorithm . for nmf",
    ", some efforts have been done in this directions @xcite , however , as the result of the clustering is described through two different matrices and the partitioning is soft , the problem is not trivial to solve .      the results of nmf provide a soft clustering of the stops to the structures .",
    "such information is included in matrices @xmath68 and @xmath69 . for a given node @xmath11 and a given structure @xmath66 , @xmath65 is the out - going affiliation of node @xmath11 to structure @xmath66 , while @xmath100 is the in - going affiliation . as the original matrix can be very sparse , and",
    "the nmf algorithm can hardly produce zero - values , many of the values in @xmath68 and @xmath69 are positive but very close to zero . in order to overcome this problem and to make sure we are capturing only the most relevant information , we applied a method to binarise the matrices @xmath68 and @xmath69 as follows : for each structure @xmath101 , vectors @xmath102 and @xmath103 contain respectively the in - going and out - going affiliation of each node @xmath104 to the structure @xmath101 . with the goal of selecting only nodes that are strongly affiliated to @xmath101 , we applied k - means clustering on these two vectors .",
    "k - means clustering partitions the @xmath105 affiliation values into @xmath66 clusters .",
    "by choosing @xmath106 for each of the structures @xmath101 we distinguished a subset of not - affiliated nodes , whose affiliation value was very small , and a subset of affiliated nodes , whose affiliation value was significantly different from zero . using this partitioning we defined a binary matrix @xmath107 such that @xmath108 if node @xmath11 is in - going affiliated to community @xmath101 and @xmath109 if it not . in the same way , we define @xmath110 , for the out - going affiliation .",
    "as we have discussed in the main text we devised a modified version of the dijkstra algorithm allowing to compute shortest paths in a weighted , labeled - edge graph .",
    "below we present the pseudo code of the modified algorithm .",
    "the algorithm requires :    * a graph @xmath0 with vertex set @xmath1 with cardinality @xmath2 , edge set @xmath3 with weight function @xmath4 , and set of transfers @xmath5 with weight function @xmath6 *   a cut - off @xmath111(the maximal number of line changes allowed )    the algorithm returns :    * an array @xmath112 of length @xmath113 , where @xmath114 $ ] is the shortest path length between nodes @xmath86 and @xmath115 * an array @xmath116 of length @xmath113 , where @xmath117 $ ] is the _ parent node _ of node @xmath115 , that precedes it in the shortest path between the source @xmath86 and @xmath115 itself * the array of _ parent edges _",
    "@xmath116 , of length @xmath113 , where @xmath118 $ ] is the edge connecting @xmath115 and its parent node @xmath119 in the shortest path connecting @xmath115 and the source @xmath86    in the pseudo - code , the following notations are introduced : @xmath120 assigns to each vertex @xmath121 the number of edges to reach source @xmath86 , @xmath122 is a min - priority queue initialised with all nodes in @xmath123 , where priority is given to nodes that are at shortest distance from the source @xmath86 , @xmath124 is the operation of selecting and removing the node with highest priority from @xmath122 , @xmath125 is an edge in @xmath3 connecting nodes @xmath115 and @xmath121 via line @xmath7 , and @xmath115 is a neighbour of @xmath121 if at least one of such connections exists and @xmath126 is the edge connecting two nodes in the fastest way , also taking into account possible line transfers when coming from an other node , @xmath127 is the associated time .",
    "each vertex @xmath128 @xmath129 @xmath130 @xmath131 @xmath132 @xmath133    @xmath134    @xmath135 @xmath136    each @xmath121 in neighbors @xmath115 : @xmath137 : @xmath138    @xmath139    @xmath140 and @xmath141 @xmath142 @xmath143 @xmath144 @xmath145    @xmath146",
    "for the urban agglomerations of strasbourg , nantes , and toulouse we detected structural patterns by considering intervals for distances with resolution of @xmath63 kilometers .",
    "an example of structure detected for each city is shown in fig.ss[schemapaths ] .",
    "for an interval range @xmath147 , both for strasbourg and nantes , we observed that the bicross validation error computed for the adjacency matrix @xmath148 is similar to the bicross validation error of the associated random matrix @xmath149 ( fig.ss[nostructure ] ) .",
    "this suggests that there is a lack of structure in the subgraph @xmath150 .        .39     .39",
    "we further investigate commuters behaviour , by identifying each pair of municipalities such that a flow of commuters exists between them and computing the corresponding pt - car flow ratio as the fraction of commuters using pt over the total people commuting between the two cities .",
    "we then compare the cases where the two municipalities are well ( figure s[ratio ] , a , c , e , g ) or badly ( figure s[ratio ] , b , d , f , h ) connected by pt according to our definition , considering the distribution of the pt - car flow ratio . + more precisely , we consider the pt structural pattern network @xmath76 , and the commuter flow network @xmath81 , where @xmath151 or @xmath152 ; first for each edge @xmath153 , we compute the fraction of commuters using pt , @xmath154.then , we compute the same quantity for all edges @xmath155 that are not in @xmath156 . for each city , we finally look at the distribution of @xmath157 for both well and badly connected municipalities ( figure s[ratio ] ) . + in the case of paris agglomeration , there is a significant difference between the case of privileged connections , where the distribution is left - side skewed ( figure s[ratio ] a ) , and not privileged connections , where the distribution is more symmetrical ( figure s[ratio ] a ) .",
    "this indicates that when the pt provides with good transportation according to our method , commuters prefer pt with respect to car . on the other hand , for toulouse , nantes and strasbourg agglomerations , there is significantly less difference in the distribution of the pt - car flow ratios for well and badly connected pairs of cities . on the one hand",
    ", this may suggest commuters tend to use the car even where good connections are provided . on the other hand",
    ", we have to consider both that our selection was less strict for these cities , and that self loops ( inter - city connections ) may play an important contribution which could not be considered here due the resolution limit of the commuter dataset ."
  ],
  "abstract_text": [
    "<S> multimodal transportation systems can be represented as time - resolved multilayer networks where different transportation modes connecting the same set of nodes are associated to distinct network layers . </S>",
    "<S> their quantitative description became possible recently due to openly accessible datasets describing the geolocalised transportation dynamics of large urban areas . </S>",
    "<S> advancements call for novel analytics , which combines earlier established methods and exploits the inherent complexity of the data . here , our aim is to provide a novel user - based methodological framework to represent public transportation systems considering the total travel time , its variability across the schedule , and taking into account the number of transfers necessary . using this framework we analyse public transportation systems in several french municipal areas . </S>",
    "<S> we incorporate travel routes and times over multiple transportation modes to identify efficient transportation connections and non - trivial connectivity patterns . </S>",
    "<S> the proposed method enables us to quantify the network s overall efficiency as compared to the specific demand and to the car alternative . </S>"
  ]
}