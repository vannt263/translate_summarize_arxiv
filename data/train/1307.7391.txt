{
  "article_text": [
    "recent developments in numerical relativity allow for the simulation of binary compact objects , _ e.g. , _  binary neutron star ( ns ) systems , which are among the strongest sources of gravitational waves . given that less than one decade ago , even the vacuum binary black hole ( bh ) problem was still a challenge for numerical evolutions of the einstein equations , the progress is indeed remarkable .",
    "part of this rapid progress is surely due to a better understanding of the mathematical properties of the different formulations of the einstein equations and the choice of suitable gauge conditions .",
    "the most widely used formulation of the einstein equations in three - dimensional numerical simulations is given by a conformal and traceless formulation of the adm ( arnowitt - deser - misner ) 3 + 1 decomposition of the einstein equations  @xcite , and is also known as the bssnok ( or bssn ) formulation  @xcite .",
    "another conformal and traceless formulation , _",
    "i.e. , _  the ccz4 formulation , was introduced recently in ref .",
    "@xcite ( hereafter paper i ) , where we discussed in detail its structure and properties .",
    "the ccz4 formulation shares some important properties with the bssnok formulation .",
    "it allows for stable evolutions in conjunction with robust and singularity - avoiding gauges , thus eliminating the need for excision techniques , and with simple sommerfeld radiative boundary conditions .",
    "the main advantage of the ccz4 formulation over the bssnok formulation is its ability to dynamically evolve the constraints equations and to couple them with a constraint - damping scheme that leads to a rapid suppression of the violations that are inevitably produced in numerical simulations .    in paper",
    "i , we validated the properties of the ccz4 system in evolutions of single and binary bh systems .",
    "the constraint - propagating and damping properties of the system turned out be very useful in reducing the violations produced in long - term simulations and led to constraint violations that were , on average , 1 order of magnitude smaller than those with the bssnok system . in this work",
    ", we investigate the behavior of the ccz4 system also in evolutions of nonvacuum spacetimes , in particular those of single and binary nss . in paper",
    "i , the simulations were performed with both a multipatch coordinate system , where the spherical outer boundary was causally disconnected , and cartesian grids plus radiative boundary conditions . in the latter system",
    ", we noticed reflections from the outer boundary which led to an increase in the values of the constraints .",
    "however , these violations were rapidly damped , and there was no sign of instabilities produced in relation with the outer boundary . in this work ,",
    "we focus on the latter case , which is used more often in simulations of neutron star mergers .",
    "we recall that the ccz4 system contains three constant parameters , one of which ( @xmath0 , see below ) determines if the system is actually covariant or not ( throughout this paper we refer to both versions as ccz4 ) .",
    "it is obviously advantageous if the propagation equations for the constraints are covariant , since it allows one to generalize results found in a particular coordinate system . for noncovariant formulations , on the other hand ,",
    "the behavior of the constraint evolution could in principle be radically altered when going , for example , from cartesian to spherical coordinates .",
    "this is relevant in practice when comparing one - dimensional and three - dimensional evolutions or when using multipatch coordinate systems .",
    "while both covariant and noncovariant formulations were studied in paper i , we also found there that exponentially growing modes appear for the fully covariant system .",
    "an important point of this paper is the exploration of the behavior of the covariant and noncovariant versions of the ccz4 system in spacetimes containing matter .",
    "we will show that the aforementioned instabilities occur only when a bh is present in the spacetime , while simulations of nss do not show such instabilities .",
    "furthermore , we will demonstrate that even when a bh appears in the solution , _",
    "e.g. , _  in the collapse of a ns , or after the merger of two nss , a modification of the damping terms in the fully covariant ccz4 system results in stable evolutions .",
    "finally , we will also confirm that in all comparisons between the covariant and the noncovariant versions of the ccz4 system , the differences between the results are very small .    a different conformal version of the noncovariant z4 system has been presented in refs .",
    "this system , called z4c , removes source terms in order to bring the evolution equations into a form which is closer to the bssnok system .",
    "recent numerical results obtained with z4c in three - dimensional simulations of compact objects  @xcite report a reduction in the hamiltonian constraint violation between 1 and 3 orders of magnitude with respect to bssnok for nonvacuum spacetimes , and between 1 and 2 orders of magnitude for black hole spacetimes . performing a similar comparison of the z4c and bssnok systems",
    ", we could measure a reduction of constraint violations of only 1 or 2 orders of magnitude , probably because we lack the improvement associated with z4c , that comes from the use of constraint - preserving boundary conditions of the type described in ref .",
    "the direct comparison between the ccz4 and z4c systems shows that the ccz4 leads to similarly low constraint violations and allows long - term stable evolution when coupled with standard radiative boundary conditions . analytically , there are no features intrinsic to the z4c system which suggest improvement over ccz4 .",
    "the plan of the paper is as follows : section  [ sec : num_meth ] presents an overview of the ccz4 system of the einstein equations coupled with the hydrodynamic equations , as well as the numerical infrastructure of our simulations .",
    "section  [ sec : results ] is dedicated to numerical results obtained with the ccz4 system in evolutions of a stable , isolated ns , of the collapse of an unstable ns to a bh , and of binary ns systems , both with constraint - satisfying and constraint - violating initial data .",
    "in the first four subsections , we compare results obtained with the bssn and ccz4 formulations of the einstein equations , while the last two subsections are dedicated to a comparison with the z4c system and between the fully covariant and the noncovariant versions of the ccz4 system .",
    "we conclude with the summary and discussions in sec .",
    "[ sec : summary ] .",
    "throughout this paper , we use a metric signature of @xmath1 and units in which @xmath2 , unless noted otherwise .",
    "greek indices are taken to run from 0 to 3 , latin indices from 1 to 3 , and we adopt the standard convention for summation over repeated indices .",
    "the ccz4 system is a conformal and covariant formulation of the einstein equations .",
    "it is based on a conformal transformation of the z4 system ( see paper i ) , which converts the original hamiltonian and momentum adm constraints into evolution equations for a four - vector @xmath3 .",
    "this amounts to introducing two additional evolution variables , namely the projection @xmath4 along the normal direction of the four - vector @xmath3 and its spatial component @xmath5 .",
    "the system can be supplemented with damping terms  @xcite , which ensure exponential damping of the constraint violations in numerical evolutions .",
    "the steps required to convert the original z4 system into a conformal version were presented in our previous paper i. for completeness , we summarize here the main ideas behind the z4 formulation and point to refs .",
    "@xcite for more details about its properties .",
    "the ccz4 system is given by the following set of evolution equations :    @xmath6^{\\rm tf } + \\alpha \\tilde a_{ij}\\left(k- 2\\theta\\right ) \\nonumber \\\\ & & - 2\\alpha \\tilde a_{il}\\tilde a^l_j + 2\\tilde a_{k(i } \\partial_{j ) } \\beta^k -\\frac{2}{3}\\tilde a_{ij } \\partial_k \\beta^k + \\beta^k \\partial_k \\tilde a_{ij }   \\ , ,   \\label{a_eq } \\\\",
    "\\partial_t\\phi & = & \\frac{1}{3 } \\alpha \\phi k - \\frac{1}{3 } \\phi \\partial_k \\beta^k + \\beta^k \\partial_k \\phi \\ , , \\\\",
    "\\label{eq : dt_k } \\partial_t k & = & - \\nabla^i \\nabla_i \\alpha + \\alpha \\left(r + 2    \\nabla_iz^i + k^2 -2 \\theta k \\right ) + \\beta^j \\partial_j k - 3 \\alpha \\kappa_1 \\left(1 + \\kappa_2\\right ) \\theta + 4 \\pi \\alpha \\left(s - 3 \\tau\\right ) \\",
    ", , \\label{k_eq}\\\\ \\label{eq : dt_theta } \\partial_t \\theta & = & \\frac{1}{2 } \\alpha \\left(r + 2 \\nabla_i z^i - \\tilde a_{ij } \\tilde a^{ij } + \\frac{2}{3 } k^2 \\,\\textcolor{blue}{\\boxed{- 2 \\theta k } } \\right ) \\,\\textcolor{blue}{\\boxed{- z^i \\partial_i \\alpha } } + \\beta^k \\partial_k \\theta - \\alpha \\kappa_1 \\left(2 + \\kappa_2\\right ) \\theta - 8\\pi \\alpha\\,\\tau\\ , , \\\\",
    "\\partial_t \\hat\\gamma^i & = & 2\\alpha \\left(\\tilde\\gamma^i_{jk } \\tilde a^{jk } - 3 \\tilde a^{ij } \\frac{\\partial_j \\phi}{\\phi } - \\frac{2}{3 } \\tilde\\gamma^{ij } \\partial_j k",
    "\\right ) + 2\\tilde\\gamma^{ki}\\left(\\alpha \\partial_k \\theta \\,\\textcolor{blue}{\\boxed{- \\theta \\partial_k \\alpha - \\frac{2}{3 } \\alpha k z_k}}\\right ) -   2\\tilde a^{ij } \\partial_j \\alpha \\nonumber\\\\ & & + \\tilde\\gamma^{kl } \\partial_k \\partial_l \\beta^i + \\frac{1}{3}\\tilde\\gamma^{ik}\\partial_k\\partial_l \\beta^l + \\frac{2}{3 } \\tilde\\gamma^i \\partial_k \\beta^k - \\tilde\\gamma^k \\partial_k \\beta^i   \\,\\textcolor{blue}{\\boxed{+ 2 \\kappa_3 \\left(\\frac{2}{3 } \\tilde\\gamma^{ij } z_j \\partial_k \\beta^k -   \\tilde\\gamma^{jk } z_j \\partial_k \\beta^i \\right ) } } \\nonumber \\\\ & & + \\beta^k \\partial_k \\hat\\gamma^i - 2 \\alpha \\kappa_1 \\tilde \\gamma^{ij } z_j - 16 \\pi \\alpha \\tilde\\gamma^{ij } s_{j}\\ , , \\label{gamma_eq}\\end{aligned}\\ ] ]    where @xmath7 is the conformal metric with unit determinant @xmath8 , while the extrinsic curvature @xmath9 is represented by its trace @xmath10 and its trace - free components @xmath11 the three - dimensional ricci tensor @xmath12 is split into a part @xmath13 containing conformal terms and another one , @xmath14 , containing space derivatives of the conformal metric , defined as    @xmath15\\ , , \\\\ \\tilde r^{\\phi}_{ij } & = & \\frac{1}{\\phi^2}\\left[\\phi \\left(\\tilde \\nabla_i \\tilde \\nabla_j \\phi + \\tilde \\gamma_{ij } \\tilde \\nabla^l \\tilde \\nabla_l \\phi\\right ) - 2 \\tilde \\gamma_{ij } \\tilde \\nabla^l \\phi \\tilde \\nabla_l \\phi\\right]\\,.\\end{aligned}\\ ] ]    the following definitions apply for matter - related quantities @xmath16 and @xmath4 is the projection of the z4 four - vector along the normal direction , @xmath17 .",
    "we note that we here follow the definition of the normal four - vector suggested in ref .",
    "i.e. , _  @xmath18 and @xmath19 , which is different from the more traditional one in which @xmath20 and @xmath21 .",
    "these different definitions do not affect the form of the ccz4 equations .",
    "the evolution variable @xmath5 of the z4 formulation is now included in the @xmath22 variable of the ccz4 formulation @xmath23 where @xmath24 the numerical simulations presented in this paper use as gauge conditions the `` @xmath25 '' slicing @xmath26 and the gamma - driver shift condition @xmath27 where the gauge parameter @xmath28 is set to @xmath29 .",
    "we adopt the `` constrained approach '' from paper i in order to enforce the constraints of the conformal formulation ( trace cleaning ) .",
    "we also compute the constraint violations introduced by the numerical evolution in the adm constraints : @xmath30 for both the bssnok and the ccz4 systems , we compute the adm quantities from the evolved variables of the two systems .",
    "we recall that the parameters @xmath31 and @xmath32 control the damping terms and that all the constraint - related modes are damped when @xmath33 and @xmath34  @xcite .",
    "the third coefficient , @xmath0 , instead affects some quadratic terms in the evolution for @xmath22",
    "and determines the covariance of the corresponding ccz4 system .",
    "in particular , a value of @xmath35 corresponds to full covariance . while @xmath32 and @xmath0 are dimensionless , @xmath36 is the damping timescale , which we report in geometric units with @xmath37 .",
    "we also recall that in paper i we performed numerical experiments with the covariance parameter @xmath0 and concluded that a choice of @xmath38 and @xmath39 leads to unstable behavior in the context of black hole spacetimes .",
    "even though we could not fully isolate the cause of these numerical instabilities , we found that they are produced by nonlinear couplings with the damping terms , which are important for reducing the violations in the constraints . as a result ,",
    "all of the tests reported in paper i made use of @xmath40 , which , for consistency with paper i , is also the value we will use for the majority of the tests discussed here .",
    "two important remarks should , however , be made now , although they will be discussed also later on .",
    "first , in the presence of a nonsingular spacetime with matter , a fully covariant formulation ( _ i.e. , _  with @xmath41 ) does not show any of the pathologies encountered in paper i with black holes .",
    "the pathologies , however , do appear as soon as a black hole is formed .",
    "second , we have devised a new prescription for the damping term @xmath31 which couples it to the lapse function and cures these instabilities also when black holes appear in the evolution . as a result , independently of whether we are considering vacuum or nonvacuum spacetimes , our ccz4 formulation can now _ always _ be used in its fully covariant form .",
    "a more extended discussion of this point , with the presentation a series of examples , is postponed to sec .",
    "[ sec : cvsc ] .",
    "as mentioned in the introduction , another noncovariant but conformal formulation of the z4 system has been proposed recently in ref .",
    "@xcite , namely the z4c formulation .",
    "the suggestion behind the z4c formulation is that of introducing the damping features of the z4 formulation with only minimal changes to the bssnok system . as we will comment later on ,",
    "this strategy is a very reasonable one and leads to results that are comparable to those of the ccz4 formulation and whose main drawback is being noncovariant .",
    "while this aspect of the formulation may be harmless in practice , it makes it difficult to generalize the properties found in a particular coordinate system , leaving room for unexpected behavior .",
    "because the ccz4 and z4c formulations differ only in nonprincipal part terms , we have marked the terms that are missing in the z4c formulation with blue boxes within the set of evolution equations eqs .",
    "( [ gamma_eq])-([gamma_eq ] ) .",
    "in addition , the z4c system evolves the trace of the extrinsic curvature @xmath42 using an evolution equation similar to the bssnok one  @xcite @xmath43 to replace eq .",
    "( [ k_eq ] ) . this variable can be translated in ccz4 terms as @xmath44      we evolve the hydrodynamic equations in flux - conservative form as @xmath45 , \\label{rest_mass_evol}\\\\ \\begin{split } \\partial_t \\hat{\\tau }    & = -\\partial_k \\left [ w^k \\hat{\\tau } + \\phi^{-3}\\alpha p v^k \\right ]   \\\\&\\qquad       + \\alpha \\hat{s}^{lm } k_{lm } - \\hat{s}^k \\partial_k \\alpha , \\end{split } \\label{energy_density_evol}\\\\ \\begin{split } \\partial_t   \\hat{s}_i    & = -\\partial_k \\left [ w^k \\hat{s}_i + \\phi^{-3}\\alpha",
    "p \\delta^k_i \\right ]   \\\\ &       \\phantom{=}\\,\\ , + \\frac{\\alpha}{2 } \\hat{s}^{lm } \\partial_i \\gamma_{lm }        + \\hat{s}_k \\partial_i \\beta^k       - ( \\hat{\\tau } + \\hat{d } ) \\partial_i \\alpha . \\end{split } \\label{momentum_evol}\\end{aligned}\\ ] ] the evolved variables are the conserved density @xmath46 , the conserved energy density @xmath47 , and the conserved momentum density @xmath48 , whose definition is given by @xmath49 above , @xmath50 is the rest mass density , @xmath51 is the 3-velocity , @xmath52 is the lorentz factor , @xmath53 is the advection speed with respect to the coordinates , @xmath54 is the pressure , @xmath55 is the specific internal energy , and @xmath56 is the specific enthalpy .",
    "finally , the projection of the energy - momentum tensor onto the spatial hypersurfaces of the foliation leads to the spatial tensor @xmath57      to evolve the hydrodynamic equations , we rely on an improved version of the ` whisky ` code described in refs .",
    "@xcite , but without making use of the ideal mhd part or of the high - order finite difference operators .",
    "the evolution of the spacetime is performed using our ccz4 implementation within the ` mclachlan ` code  @xcite , which is part of the publicly available einstein toolkit infrastructure based on the ` cactus ` computational framework . for the time integration",
    "we are using the method of lines with an explicit fourth - order runge - kutta method .",
    "the outer boundary conditions used are the ( sommerfeld ) radiative ones provided by the ` mclachlan ` code , initially developed and well tested for the bssnok system .",
    "we employ adaptive mesh refinement ( amr ) for our numerical grid , provided via the ` carpet ` driver  @xcite . for single - star simulations , we use a fixed grid hierarchy , while for binary ns runs we follow the centers of mass of the stars with moving refined boxes . during the merger ,",
    "they are replaced by larger nonmoving refinement regions of the same resolution . shortly after",
    ", one more refinement level with doubled resolution is activated to better resolve the black hole .",
    "for the solution of the einstein equations we use finite - difference spatial differential operators of various orders , although the results presented in this paper have been obtained using fourth - order - accurate schemes .",
    "the spatial discretization of the hydrodynamic equations , on the other hand , uses a finite - volume high - resolution shock - capturing scheme adopting the parabolic reconstruction of the piecewise parabolic method ( ppm )  @xcite and the harten - lax - van leer - einfeldt ( hlle )  @xcite approximate riemann solver .",
    "in contrast to the original ` whisky ` code , we do not reconstruct the 3-velocities @xmath51 , but rather the quantities @xmath58 ( as done in ref .",
    "this guarantees that the velocities reconstructed at the cell boundaries stay subluminal even under the extreme conditions which occur at the center of a black hole . using shock tube tests",
    ", we verified that this modification does not affect the treatment of shocks .",
    "furthermore , we improved the robustness of the conversion algorithm from evolved to primitive variables , allowing a clear distinction between physical and unphysical values .",
    "the details of this algorithm have already been described in ref .",
    "for the current work , the only important aspect of the improvements is the ability to enforce a fine - grained error policy .",
    "the standard policy does not allow any unphysical values , with the exception of the internal energy falling below the zero temperature value ( zero for the ideal gas equation of state eos ) , in which case it is reset to that value .",
    "this can happen frequently when evolving cold matter , where the internal energy is exactly at the minimum value allowed by the given eos . at densities corresponding to the surface region of the star , which is a notorious source of errors in hydrodynamic simulations , we use a more lenient policy , which adjusts unphysical values of the conserved energy and momentum densities to the physically meaningful range at a given density .",
    "the same applies to a region around the center of the black hole , which we define as the region in which @xmath59 and which is always contained within the apparent horizon . in this region",
    "we also limit the lorentz factor to be @xmath60 .",
    "this adjustment , together with the aforementioned modified reconstruction , allows us to evolve a black hole without excision for the spacetime or for the hydrodynamic variables .",
    "finally , we added an option to smoothly remove all matter from the center of a black hole .",
    "we did this to investigate how the presence of matter at the center of the black hole affects the numerical errors in comparison to an evolution of a vacuum black hole .",
    "this needs to be addressed separately from the spacetime - matter coupling elsewhere , because , although our gauge is singularity avoiding , the gradients of metric and density close to the center of a bh still become so large that it is always severely under - resolved numerically . to remove the matter",
    ", we introduce a term @xmath61 to the rhs of the conserved variables @xmath62 .",
    "the baryon mass then evolves according to @xmath63 , thus leading to an exponential decay .    in simulations that form a black hole",
    ", we detect apparent horizons using the module ` ahfinderdirect `  @xcite from the einstein toolkit .",
    "we compute the mass and spin using the isolated horizon formalism  @xcite implemented in the ` quasilocalmeasures ` module . finally , the constraints in eqs .  -",
    "are computed using a standard fourth - order finite difference method .",
    "in this section , we investigate the stability of the ccz4 formulation when coupled to matter and test the convergence properties of the code .",
    "furthermore , we compare the behavior of the constraint violations , first between the ccz4 and the bssnok formulations , then between the ccz4 and the z4c formulations , and finally between the covariant and the noncovariant ccz4 versions .      .",
    "shown are the @xmath64 norms of the hamiltonian ( top panel ) and the combined momentum ( bottom panel ) constraint violations , taken over the full computational domain . ]",
    "[ cols=\"<,^,^,^,^,^,^,^,^\",options=\"header \" , ]     in contrast to the eccentric case , the dynamics of the quasicircular system agrees well between the ccz4 and bssnok formulations . to quantify this statement",
    ", we compare the mass , spin , and formation time of the bh in table  [ tab : bns_phys_quant ] .",
    "the agreement is better than @xmath65 .",
    "the differences in the bh properties are thus comparable to the numerical errors of the ccz4 simulation as determined by the convergence test .",
    "curiously , the difference in horizon formation time is an order of magnitude smaller than the numerical errors for this particular case , although we do not expect that this holds in general .",
    "since the constraint violations still differ by a factor @xmath66 between ccz4 and bssnok , one can conclude that the magnitude of constraint violations observed in the quasicircular bssnok evolution is tolerable , while the amount present in the eccentric case already leads to severe errors .",
    "this is a very useful notion since , as we discussed before , the relation between the constraint violation and error of physical quantities is largely unknown .",
    "we stress that the @xmath64 norm we use to quantify the constraint violations depends on the computational volume and the falloff behavior of the constraint violations . for different setups",
    ", one has to rescale accordingly in order to make sensible comparisons .    besides the amount of constraint violation , we are also interested in its spatial distribution .",
    "figure [ fig : qcbns_hxy ] shows the hamiltonian on a cut in the @xmath67 plane .",
    "clearly , most of the violations are produced along the orbit of the stars .",
    "also , the mesh refinement boundaries are clearly visible . in practice ,",
    "the stars leave behind a trail of constraint violations , which is more pronounced and decays more slowly for the bssnok formulation .",
    "furthermore , constraint violations travel through the computational domain and are partially reflected at each refinement boundary , for both the ccz4 and the bssnok formulations . after the formation of the bh ,",
    "when the system approaches a final state , the constraints exhibit a relatively stationary spiral pattern of slowly decreasing magnitude .",
    "finally , we should also remark that the relative difference in the constraint violations that we measure in the simulations reported here refers to _ our _ implementation of the ccz4 and bssnok formulations and should not be considered as universal . because a number of slightly different versions of the bssnok system are used by different groups , it is possible that the differences between the two formulations could also be smaller or larger when performed by other groups .",
    "one of the most important results of binary ns merger simulations is obviously the emission of gravitational wave ( gw ) signals .",
    "since prior to extraction , gws travel into the weak - field region , crossing several refinement boundaries and becoming a small perturbation due to the @xmath68 falloff , they might be affected more strongly by numerical errors than the bulk dynamics of the merger .",
    "in particular , constraint violations could affect the gws differently . in the following subsection ,",
    "we measure the numerical accuracy of the gw signal using the ccz4 convergence test and estimate the influence of constraint violations by comparing between the ccz4 and the bssnok formulations .    for this , we extract the @xmath69 component of the weyl scalar @xmath70 at a fixed radius @xmath71 .",
    "we then decompose the complex quantity @xmath70 into amplitude and phase , _",
    "@xmath72 , where @xmath73 is a continuous function of time . to compare different simulations",
    ", we measure time with respect to the time @xmath74 at which the apparent horizon forms , and introduce the phase difference @xmath75 . the amplitude and the phase",
    "are shown in the left panels of fig .",
    "[ fig : bns_gw ] for the bssnok and ccz4 results . for the ccz4 simulations ,",
    "we plot the three resolutions of the convergence test , where the lowest one is identical to the one used for the bssnok simulation .",
    "one can clearly distinguish the inspiral phase , a first peak corresponding to the merger , and a second peak corresponding to the ringdown of the bh .",
    "the usual junk radiation inherent to the initial data can also be seen at the beginning of the evolution . in the right panels of fig .",
    "[ fig : bns_gw ] , we show the residuals of amplitude and phase between different resolutions and between the ccz4 and bssnok runs when performed at the lowest resolution . for",
    "the ccz4 runs , we find errors compatible with a convergence order around @xmath76 during the inspiral . during the merger , on the other hand , the convergence decreases and is lost during the ringdown phase . from the time derivative of @xmath77 , we compute the instantaneous frequency , which increases from around @xmath78 at the end of the inspiral to @xmath79 at the maximum of the ringdown signal . unfortunately , the wavelength corresponding to the latter is resolved by only six coarsest grid points of the lowest resolution , and thus the signal from the ringdown is severely under - resolved . in order to demonstrate convergence of the high - frequency part of the signal",
    ", we would have to repeat the runs with much higher resolution in the weak - field region .",
    "norm of the hamiltonian constraint violation ( top panel ) and the momentum constraint violation ( bottom panel ) . ]    in the analysis of gw data using matched filtering techniques , the most important error is the phase shift during the inspiral . for our test case , we find that the total phase error until the merger is less than @xmath80 for the lowest resolution , and @xmath81 for the highest one . at first sight",
    ", this seems to contradict the larger relative error we obtain for the time until bh formation ( compare table  [ tab : bns_phys_quant ] ) .",
    "however , by analyzing the coordinate separation of the stars barycenter , we find that the relative error of separation is larger than the error of the gw phase ; _",
    "i.e. , _  the orbital period is more accurate than the decrease in separation per orbit .",
    "this is reflected in the relatively large amplitude error ( see fig .",
    "[ fig : bns_gw ] ) , since the gws at the same phase ( or time ) are produced at different orbital separations .",
    "figure [ fig : bns_gw ] also shows that the differences in the waveforms obtained with the ccz4 and the bssnok formulations are generally comparable to the numerical errors , even during merger and ringdown .",
    "since the constraint violations differ by 1 order of magnitude , we can conclude that their impact on the gw signal is also comparable to that due to ordinary numerical errors , or even smaller ( the differences could as well be purely due to numerical errors other than the constraint violation ) .",
    "this result is rather reassuring since , to the best of our knowledge , the impact of the constraint violations on the accuracy of the gw signal has not been measured before .",
    "norm of the hamiltonian constraint violation ( top panel ) and of the @xmath4 variable ( bottom panel ) , computed excluding the interior of the bh . ]    as anticipated in the introduction , we now present a comparison of the results obtained with another conformal formulation of the z4 system , namely the z4c formulation proposed in ref .",
    "@xcite . to reduce the computational costs ,",
    "the comparison will be carried out with the evolutions of a stable nonrotating star , of a single nonrotating bh and of an unstable ns which collapses to a bh .",
    "however , we expect that the qualitative behavior of the two formulations will extend also to binary systems either of bhs or of nss .",
    "as far as the z4c system is concerned , we have implemented the formulation described in ref .",
    "@xcite within the ` mclachlan ` code  @xcite .",
    "this requires only minor modifications in the source terms of the ccz4 system ( see sec .  [",
    "sec : ccz4 ] for details about the differences between the two systems ) . as mentioned in sec .",
    "[ sec : numsetup ] , we use the radiative boundary conditions provided by the ` mclachlan ` code .",
    "we note that both the ccz4 and the z4c formulations implement the same constraint - damping scheme  @xcite , and we use the values of the constraint - damping parameters advocated as best suited for the z4c formulation in ref .",
    "@xcite , namely @xmath82 and @xmath83 .",
    "also , for both systems we monitor the same quantities , namely the behavior of the hamiltonian and momentum constraint violations , but also of the @xmath4 function , whose time variation measures the size of the hamiltonian constraint violation and thus assesses the deviation of the numerical solution from the true einstein solution .",
    "indeed , we find this diagnostic quantity to be a very important indicator of the quality of the solution , which can be compared directly for the two conformal formulations ( we recall that the @xmath4 function is not defined for the bssnok formulation ) .",
    "the first test involves a nonrotating stable ns , as described in sec .",
    "[ sec : isolated ] .",
    "overall , in the presence of matter the two systems provide an almost identical behavior and show a 2-order - of - magnitude decrease in the constraint violations as the evolution is started .",
    "these are reported in fig .",
    "[ fig : tov_constr ] , which shows both the violations in the hamiltonian and the momentum constraints ( top and bottom panels , respectively ) .",
    "note that the z4c evolution has a slightly larger violation of the hamiltonian constraint ( top panel ) and a smaller one in the momentum constraints ( bottom panel ) .",
    "overall we find the two violations comparable .",
    "the second test involves the evolution in vacuum of a nonrotating bh .",
    "the results are again very similar for the two systems , as one can see in fig .",
    "[ fig : sbh_constr ] , which reports the violation in the hamiltonian constraint and the evolution of the @xmath4 function ( top and bottom panels , respectively ) .",
    "note that while the hamiltonian constraint is slightly smaller for the z4c formulation , the momentum constraint is smaller for ccz4 .",
    "both systems show small deviations in the final bh mass ; see table  [ tab : bh_mass ] .",
    "the third comparative test consists in the collapse of an unstable tov star , as described in sec .",
    "[ sec : collapse ] . figure  [ fig : tovcoll_constr ] shows again the violation in the hamiltonian constraint and the evolution of the @xmath4 function ( top and bottom panels , respectively ) .",
    "the only significant difference in this case is a spike in the ccz4 formulation right after collapse , which is efficiently damped after @xmath84 of evolution , so that the constraint violations return to values similar to the z4c formulation .",
    "the value of the bh mass after collapse shows larger errors for ccz4 , around @xmath85 , in comparison with only @xmath86 for z4c ( see table [ tab : bh_mass ] ) .",
    "however , this result can be improved to @xmath87 error by using a modified damping scheme with @xmath88 ( see sec .",
    "[ sec : cvsc ] ) .    based on the results presented above ,",
    "we conclude that the ccz4 and the z4c formulations yield very similar results in terms of their ability to damp the violations in the constraint equations .",
    "however , one important difference remains between the two systems that is , only the ccz4 formulation with @xmath41 represents a version of the original z4 system that is not only conformal but also _ covariant_. as a result , only for this covariant formulation should one reasonably expect that the qualitative behavior of the constraint violations will remain unchanged when evolving the same system in different coordinates .",
    "finally , given the similar behavior of the ccz4 and of the z4c formulations for the tests considered here , we expect that , when used in the evolution of binary nss , the z4c system would also yield violations that are of about 1 order of magnitude smaller than those with the bssnok formulation .      as a concluding section",
    ", we now discuss how it is possible to employ a covariant ccz4 formulation ,",
    "_ i.e. , _  with @xmath38 , also for spacetimes containing bh singularities .",
    "we recall that in cases where no singularity is present , as for example in the evolution of a tov , the fully covariant ccz4 system is stable and the standard constraint - damping prescription leads to results similar to the noncovariant ccz4 formulation as well as to the z4c systems ( _ cf . _  fig .",
    "[ fig : tov_constr ] ) .",
    "however , in those cases in which a bh is present , either initially or when it is formed during the evolution , the fully covariant ccz4 system coupled with the constraint - damping scheme has shown exponentially growing modes ( _ cf . _  fig .  4 in paper i ) .",
    "even though we could not identify the exact cause of the instability ( see discussion in sec .",
    "[ sec : ccz4 ] ) , it is clear that in eqs .   and the _ constant _ damping coefficient @xmath31 is always multiplied by the lapse function @xmath89 . because our singularity - avoiding slicing reduces considerably the value of the lapse near the singularity , it is clear that the benefits introduced by the damping term @xmath31 are severely suppressed right there where the violations are the largest .",
    "fortunately , these considerations suggest two new prescriptions for the damping terms . in detail , we replace the constant @xmath31 in eqs .",
    "( [ k_eq])-([gamma_eq ] ) with one of the following functions : @xmath90 in this way , the product @xmath91 is not approaching zero anymore near the singularity .",
    "note that the z4 damping terms , _",
    "i.e. , _  the terms containing @xmath31 , are not fully covariant anymore , but only spatially covariant , since we introduced an explicit dependency on the slicing .",
    "the main z4 evolution equations on the other hand remain unchanged and fully covariant .",
    "although the two prescriptions eqs .   and",
    "are slightly different in their local and asymptotic behavior , they yield very similar results , and we focus on the form in the following . to validate the effectiveness of the new prescription , we recompute the tests performed in the previous section and compare them with those obtained with the noncovariant version of the ccz4 formulation ( _ i.e. , _  with @xmath92 ) and with the z4c formulations .",
    "since we use the same computational infrastructure , numerical methods and gauge conditions , the only differences between the two systems are the z4 source terms , which were truncated in the noncovariant ccz4 version and are completely removed in the z4c system ( see eqs .  - ) .",
    "norm of the hamiltonian constraint violation ( top panel ) and of the @xmath4 variable ( bottom panel ) , computed excluding the interior of the bh . ]",
    "the comparison is shown in fig .",
    "[ fig : sbh_constr ] , which presents results obtained with two values of the damping parameter , namely @xmath88 and @xmath82 , in evolutions of a single nonrotating bh .",
    "the latter allows a direct comparison with the noncovariant ccz4 and z4c results , and indeed the constraint violations are very similar in this case .",
    "larger damping values lead to lower values of @xmath4 and of the violations of the momentum constraints . even though the two damping parameters are significantly different , the violations of the constraints change by less than 1 order of magnitude over the timescale of this evolution , _",
    "i.e. , _  @xmath93 . a significant effect ,",
    "however , is observed in the black hole mass , which shows deviations of @xmath94 in the first case and @xmath95 in the second case ( see table  [ tab : bh_mass ] ) .",
    "overall , the behavior of the covariant ccz4 constraints matches well the noncovariant version of the ccz4 system for the same value of the damping parameter , for example @xmath96 in fig .",
    "[ fig : tovcoll_constr ] .",
    "however , the two versions of the ccz4 formulations differ in the value of the final bh mass after collapse namely , the covariant one shows a difference of @xmath97 with respect to the initial gravitational mass of the ns , while the noncovariant one shows a @xmath87 error .",
    "a study of the influence of different damping parameters on the values of the bh mass is presented in table [ tab : bh_mass ] . in practice ,",
    "larger values of the damping lead to more reliable estimates of the mass ; for example , @xmath98 reduces the error to @xmath99 .",
    "we believe that the new prescriptions for the damping term eqs .   and are important for two distinct reasons .",
    "first , they allow for the use of a covariant ccz4 formulation also in singular bh spacetimes .",
    "this was a limitation of our approach in paper i that has been successfully overcome .",
    "second , these results shed some light on the behavior of the `` nonprincipal part '' constraint - damping terms in the ccz4 system , although a complete and closer comparison with the z4c results presented in ref .",
    "@xcite can not be performed because of the different boundary conditions employed .",
    "we have compared numerically the performance of several conformal and traceless formulations of the z4 system with the bssnok formulation in simulations of spacetimes with and without matter , in terms of the suppression of constraint violations and their impact on the accuracy of physical quantities .",
    "we successfully coupled the ccz4 system presented in paper i to matter sources , and also found that the fully covariant ccz4 version leads to stable evolutions for the case of nss , while it develops instabilities as soon as a bh is present .",
    "we created a modified ccz4 version that completely eliminates those instabilities for bh spacetimes also , and which is still covariant .",
    "in addition , we implemented the z4c formulation described in ref .",
    "@xcite in our numerical framework and compared its properties to those of the ccz4 formulation .",
    "we have found that the noncovariant ccz4 formulation introduced in paper  i is stable when coupled to matter sources in simulations of stable and unstable spherical nss , as well as of merging binary nss . in comparison to the bssnok system",
    ", the ccz4 formulation reduces the constraint violations by 1 order of magnitude for simulations of binary nss and by 2 orders for single nss .",
    "we have also demonstrated the convergence of our implementation for simulations of stable nss , as well as those of binary ns mergers , with a convergence order in the range @xmath100-@xmath101 , mainly limited by the hydrodynamic evolution scheme . by comparing the ccz4 and the bssnok evolutions , and by using the large differences in the constraint violations",
    ", we could estimate the influence of the latter on physical quantities .",
    "in particular , we could demonstrate that the impact of the constraint violations on the gw signal from the binary ns mergers is smaller than or comparable to the numerical errors .",
    "furthermore , a comparison of the different conformal z4 versions , namely the noncovariant and covariant ccz4 formulations , and the noncovariant z4c , has shown that they have an almost identical behavior in terms of constraint violations as long as no singularity is present ( _ e.g. , _",
    "stable tov ) . in evolutions of bh spacetimes , or",
    "when a bh is produced as a result of a collapse , we find that values of the constraint - damping parameter larger than the ones proposed for the z4c formulation ( _ i.e. , _",
    "@xmath102 in place of @xmath103 ) lead to lower constraint violations and do not produce late - time instabilities .",
    "finally , we have also found that the modification of the damping terms mentioned above is useful not only for a stable evolution of the covariant ccz4 system , but also for reducing the drift in the bh mass for both ccz4 versions .",
    "overall , we recommend ccz4 as the standard formulation of the einstein equations to be used in numerical relativity evolutions . in cases where constraint violations are problematic , _",
    "e.g. , _  when using constraint - violating initial data , the ccz4 formulation is clearly superior . on the other hand , when using constraint - satisfying initial data , the reduction of constraint violations is accompanied by errors that are very similar to those obtained with the bssnok formulation .",
    "no additional computational costs are needed , and simple sommerfeld radiative boundary conditions are sufficient to obtain stable evolutions . on the basis of the tests where we performed a direct comparison , the performance of z4c and ccz4 seems to be comparable .",
    "however , ccz4 has the advantage of being covariant , while z4c has been successfully tested with constraint - preserving boundary conditions ; see ref .",
    "@xcite . in simulations of binary neutron star mergers , a main limitation of the accuracy",
    "is given by the hydrodynamic part .",
    "for this application , using higher - order schemes for the hydrodynamic equations , such as those presented in ref .",
    "@xcite , might have a larger impact than the choice between ccz4 and z4c .",
    "it is a pleasure to acknowledge f. galeazzi , d. radice and k. takami for numerous useful discussions .",
    "we are grateful to carles bona and carlos palenzuela for important suggestions .",
    "partial support comes from the dfg grant sfb / transregio 7 , and from `` compstar '' , a research networking programme of the european science foundation .",
    "the calculations were performed on the supermuc cluster at the lrz and on the datura cluster at the aei ."
  ],
  "abstract_text": [
    "<S> following previous work in vacuum spacetimes , we investigate the constraint - damping properties in the presence of matter of the recently developed traceless , conformal and covariant z4 ( ccz4 ) formulation of the einstein equations . </S>",
    "<S> first , we evolve an isolated neutron star with an ideal gas equation of state and subject to a constraint - violating perturbation . </S>",
    "<S> we compare the evolution of the constraints using the ccz4 and baumgarte - shibata - shapiro - nakamura - oohara - kojima ( bssnok ) systems . </S>",
    "<S> second , we study the collapse of an unstable spherical star to a black hole . </S>",
    "<S> finally , we evolve binary neutron star systems over several orbits until the merger , the formation of a black hole , and up to the ringdown . </S>",
    "<S> we show that the ccz4 formulation is stable in the presence of matter and that the constraint violations are 1 or more orders of magnitude smaller than for the bssnok formulation . </S>",
    "<S> furthermore , by comparing the ccz4 and the bssnok formulations also for neutron star binaries with large initial constraint violations , we investigate their influence on the errors on physical quantities . </S>",
    "<S> we also give a new , simple and robust prescription for the damping parameter that removes the instabilities found when using the fully covariant version of ccz4 in the evolution of black holes . </S>",
    "<S> overall , we find that at essentially the same computational costs the ccz4 formulation provides solutions that are stable and with a considerably smaller violation of the hamiltonian constraint than the bssnok formulation . </S>",
    "<S> we also find that the performance of the ccz4 formulation is very similar to another conformal and traceless , but noncovariant formulation of the z4 system , _ </S>",
    "<S> i.e. , _  the z4c formulation . </S>"
  ]
}