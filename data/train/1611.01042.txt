{
  "article_text": [
    "during the past decades , relaying networks have attracted a great deal of research attention from both academia and industry . in multi - way relay networks ,",
    "many users simultaneously exchange their bearing information among them via the assistance of a single sharing relay at the same time - frequency resource @xcite . multi - way relay networks provide spatial diversity , and hence , they can scale - up the spectral efficiency of the system without increasing the system complexity @xcite . in @xcite ,",
    "the authors show that the spectral efficiency of multi - way relay networks is much higher than that of one - way or two - way networks for both perfect and imperfect channel state information ( csi ) .",
    "for all these reasons , there is a plethora of applications of multi - way relay networks , including wireless conference , power control in heterogeneous cellular networks , and low complexity data exchange between sensor nodes and data fusion centres in wireless sensor nodes .",
    "massive multiple - input multiple - output ( mimo ) , where a base station equipped with hundreds of antennas serves many active users in the same time - frequency resource , is considered as one of the key candidates for next - generation wireless systems @xcite . there is a large body of literature on massive mimo recently in terms of throughput , energy efficiency , and communication reliability @xcite . in @xcite ,",
    "the authors show that massive mimo can substantially reduce the effects of noise , small - scale fading and inter - user interference by using simple linear processing , including maximum - ratio ( mr ) or / and zero - forcing ( zf ) techniques .",
    "in particular , the transmit power of each user can be made inversely proportional to the number of antennas at the base station .",
    "furthermore , the performance of the system can be scaled up noticeably without increasing the system complexity .",
    "multi - way massive mimo relay networks , which combine massive mimo and multi - way relaying technologies , have received research interest only recently @xcite .",
    "these systems are expected to reap all benefits achieved from both massive mimo and multi - way relaying networks .",
    "therefore , they are considered as a strong candidate to offer an enormous improvement of spectral and energy efficiency @xcite .",
    "the works of @xcite derive the achievable rates of multi - way massive mimo systems and show that the effects of inter - user interference and noise disappear when the number of relay antennas goes to infinity .",
    "however , these works consider zf processing at the relay which involves a complicated matrix inversion . furthermore",
    ", these works assume perfect csi at the relay .",
    "in massive mimo , channel estimates acquisition is a critical problem , and hence , the issue of imperfect channel state information should be taken into account .    inspired by the above discussion , in this paper we consider a far more realistic scenario , namely a multi - way massive mimo system with mr processing and imperfect csi .",
    "we recall that the mr processing scheme is very simple and nearly optimal when the number of relay antennas is large @xcite . furthermore",
    ", maximum - ratio processing can be implemented in a distributed manner without large backhaul requirements . a complete transmission protocol under time - division duplex ( tdd ) operation is proposed .",
    "we derive a corresponding expression for the spectral efficiency in closed - form . based on this closed - form expression",
    ", the effect of the number of relay antennas , imperfect channel estimation , and the number of users is analyzed .",
    "_ notations : _ we use bold letters for matrices and vectors .",
    "the superscripts @xmath0 , @xmath1 , and @xmath2 denote the transpose , conjugate , and hermitian , respectively .",
    "the symbol @xmath3 indicates the norm of a vector .",
    "the notations @xmath4 and @xmath5ar@xmath6 are the expectation and the variance operators , respectively ; @xmath7}}_{mn}$ ] or @xmath8 denotes the @xmath9-th entry of matrix @xmath10 , and @xmath11 is the @xmath12 identity matrix .",
    "moreover , @xmath7}}_{k}$ ] or @xmath13 denotes the @xmath14-th column of matrix @xmath10 .",
    "finally , @xmath15 represents a circularly symmetric complex gaussian vector @xmath16 with zero mean and covariance matrix @xmath17 .",
    "we consider a multi - way relaying massive mimo system which consists of one relay equipped with @xmath18 antennas , and @xmath19 single - antenna users , as shown in figure  1 .",
    "the @xmath19 users exchange information with each other with the help of the relay by sharing the same time - frequency resource .",
    "each user wants to detect all @xmath20 signals transmitted from other users .",
    "we assume that all nodes operate in the half - duplex mode .",
    "furthermore , we assume that the direct links ( user - to - user links ) do not exit due to the large obstacles and/or severe shadowing . here",
    ", we consider the scenario where both @xmath18 and @xmath19 are large , and @xmath18 is much larger than @xmath19 ( @xmath21 ) .",
    "denote by @xmath22 the @xmath23 channel matrix between the relay and the @xmath19 users .",
    "in addition , @xmath22 models independent small - scale fading ( rayleigh fading ) and large - scale fading ( geometric attenuation and log - normal shadow fading ) . specifically , the @xmath24-th element of @xmath22 is the channel coefficient between the @xmath25-th antenna of the relay and the @xmath14-th user modeled as @xmath26 where @xmath27 represents the small - scale fading , and @xmath28 represents the large - scale fading . in matrix form ,",
    "@xmath29 where @xmath30 is an @xmath23 matrix , @xmath31_{mk}=h_{mk}$ ] and @xmath17 is a @xmath12 diagonal matrix , where @xmath32_{kk}=\\beta_k$ ] .",
    "the transmission leverages tdd operation , and is divided into three phases : i ) channel estimation ; ii ) multiple - access ( ma ) ; and iii ) broadcast ( bc ) phases .",
    "users shown in fig .",
    "2 implies that the system spends only one time - slot for the ma phase and @xmath33 times - slots for the bc phase . ]",
    "the relay node needs to know the channel for signal processing . to do this ,",
    "a part of coherence interval is used for channel estimation . for each coherence interval of length @xmath34 symbols , all users simultaneously transmit pilot sequences of length @xmath35 symbols to the relay .",
    "let @xmath36 be the pilot sequence sent from the @xmath14-th user .",
    "we assume that @xmath37 are unit norm vectors and pairwisely orthogonal , i.e. , @xmath38 for @xmath39 .",
    "this requires that @xmath40 .",
    "the @xmath41 received pilot matrix at relay is given by @xmath42 where @xmath43 $ ] , @xmath44 is the transmit power of each pilot symbol , @xmath45 is the @xmath14-th column of @xmath22 , and @xmath46 is the additive white gaussian noise ( awgn ) matrix with i.i.d .",
    "@xmath47 components .    at the relay , we apply the minimum mean - square - error ( mmse ) technique to estimate the channel matrix @xmath22 @xcite .",
    "the mmse channel estimate of @xmath22 is @xmath48 where @xmath49 and @xmath50 . from the property of @xmath51 ,",
    "the elements of @xmath52 are i.i.d .",
    "@xmath47 random variables ( rvs ) .",
    "let @xmath53 be the estimation error matrix .",
    "then , @xmath54 from the property of mmse estimation , @xmath55 and @xmath53 are independent .",
    "moreover , we have @xmath56 and @xmath57 , where @xmath58 and @xmath59 are diagonal matrices with @xmath60_{kk}=\\sigma^2_k=\\frac{\\tau{p_{\\text{p}}}\\beta^2_k}{\\tau{p_{\\text{p}}}\\beta_k+1},\\end{aligned}\\ ] ] and @xmath61_{kk}=\\sigma^2_{e , k}=\\beta_{k}-\\sigma^2_{k}.\\end{aligned}\\ ] ]      in this phase , data is transmitted to the relay in the same time - frequency resource from all users .",
    "the @xmath62 received vector at the relay is @xmath63 where @xmath64^t$ ] , with @xmath65 , is the @xmath66 signal vector transmitted from the @xmath19 users , @xmath67 is an @xmath62 awgn vector with i.i.d .",
    "@xmath47 components , and @xmath68 is the transmit power of each user .",
    "then , the relay uses the channel estimate in the channel estimation phase and employs the mr combining scheme as : @xmath69      in this phase , the relay spends @xmath20 time - slots to transmit all signals to @xmath19 users . the relay utilizes the mr technique to broadcast a permuted version of @xmath70 at each time - slot @xcite .",
    "the transmit signal vector at the relay for the @xmath71-th @xmath72 time - slot can be expressed as @xmath73 where @xmath74 is the permutation matrix for time slot @xmath71 given as @xcite , @xmath75 and @xmath76 in , @xmath77 is the normalization factor , chosen to satisfy a long - term power constraint at the relay , @xmath78 from , , , and the normalization factor @xmath77 can be expressed as @xmath79_{k}\\right\\|^2\\right\\}}+\\sum\\limits_{m=1}^{m}{\\mathbb{e}\\left\\{\\left\\|\\left[{\\mathbf{b}}^{(t)}\\right]_{m}\\right\\|^2\\right\\}}}.\\end{aligned}\\ ] ]    then , the @xmath66 received signal vector at the @xmath19 users in the @xmath71-th time slot can be described as follows : @xmath80 and substituting into , we obtain @xmath81",
    "in this section , we analyse the spectral efficiency of the system . more specifically , we derive a closed - form expression for the spectral efficiency . without loss of generality ,",
    "we analyze the performance of the system for the first time - slot .",
    "the performance analysis for other time - slots follows the same methodology .",
    "note that , hereafter , if @xmath82 , then we set @xmath83 and @xmath84 ; if @xmath85 , then we set @xmath86 ; and if @xmath87 , we set @xmath88 .    in the first time - slot , the @xmath14-th user wants to detect the signal @xmath89 transmitted from the @xmath90-th user . from , the received signal in the first time slot for the @xmath14-th user",
    "is described by @xmath91 where @xmath92 is considered as the effective noise and given by    @xmath93    @xmath94    from , it can be clearly seen that the  desired signal \" term is uncorrelated with the  effective noise \" term .",
    "thus , the signal - to - interference - plus - noise ratio ( sinr ) in the first time - slot for the @xmath14-th user is given by @xmath95 where @xmath96 in , @xmath97 is given by , and it can be represented in closed - form via shown at the top of the next page .",
    "the detailed derivation of is shown in appendix  [ app : alpha ] .",
    "then , the spectral efficiency of the @xmath14-th user in bit / s / hz is given by @xmath98 the pre - log factor in includes : i ) @xmath99 which comes from the fact that during a coherence interval of @xmath34 symbols , we spend @xmath35 symbols for the training ; and ii ) @xmath100 accounts for the fact that we spend @xmath19 time slots to send @xmath20 signals to a given user .",
    "we next provide a closed - form expression for the spectral efficiency given in .",
    "[ theo:1 ] the closed - form expression for the spectral efficiency is @xmath101 where @xmath102 , \\label{eq : is}\\\\ & { \\tt{an}}_k=\\alpha^{(1)}\\left(m^3\\sigma^4_{k}\\sigma^2_{k+1}+m^2\\beta_{k}\\sum_{k'=1}^{k}\\sigma^2_{k'}\\sigma^2_{k'+1}\\right),\\label{eq : ib1}\\end{aligned}\\ ] ] where @xmath103    see appendix  [ proofpro1 ] .",
    "result yields some important remarks :    * as @xmath104 , the numerator of the sinr of scales as @xmath18 while the denominator converges to a constant , and hence , the spectral efficiency grows without bound . *",
    "if the transmit power of each user is scaled with @xmath105 , i.e. @xmath106 , where @xmath107 is fixed , then as @xmath104 , the spectral efficiency converges to @xmath108 the result in implies that by utilizing very large number of antennas @xmath18 at the relay , we can cut down the transmitted power of each user proportionally to @xmath105 without reducing the system performance . *",
    "if the transmit power at the relay is scaled with @xmath105 , i.e. , @xmath109 , where @xmath110 is fixed , then as @xmath104 , we obtain @xmath111 which indicates that we can reduce the transmitted power at the relay proportionally to @xmath105 , when @xmath18 is large . *",
    "if the transmit power of the relay and each user are scaled with @xmath105 , i.e. @xmath109 , and @xmath106 , where @xmath110 and @xmath107 are fixed , then as @xmath112 , the spectral efficiency converges to @xmath113 where @xmath114 we can see that , when @xmath18 is large , the transmit power at the relay and each user can be cut down proportionally @xmath105 , while maintaining a non - zero spectral efficiency .",
    "in this section , numerical results are presented to verify our analysis . for all examples ,",
    "we choose @xmath115 , and define @xmath116 ( expressed in db ) .",
    "we examine the sum spectral efficiency as follows : @xmath117      we consider a simple case where the large - scale fading @xmath118 for all @xmath14 .",
    "figure  [ fig : spectral_efficiency10 ] shows the sum spectral efficiency versus @xmath18 for different @xmath19 .",
    "the solid and circle lines present the monte - carlo simulations using and analytical results using , respectively . from the figure",
    ", we can see that the analytical results match the simulation results which validates the correctness of our closed - form expression . as expected , when @xmath18 increases the sum spectral efficiency increases .",
    "furthermore , for low numbers of antennas , for example @xmath119 , the gaps of the sum spectral efficiency between the three cases @xmath120 , and @xmath121 are very small",
    ". however , these gaps grow considerably when the number of antennas is large , i.e. , at @xmath122 , the sum spectral efficiency with @xmath123 is nearly double compared to the one with @xmath124 .",
    "this is due to the fact that when @xmath18 increases , inter - user interference and noise effects are canceled out .    , @xmath125 , @xmath126 db , @xmath127 db , and @xmath118 .",
    "]    , @xmath123 , @xmath115 , @xmath128 db , and @xmath118 . ]",
    "m , @xmath115 , @xmath125 , @xmath129 db . ]    next , we investigate the effect of the length of training duration @xmath35 on the system performance , as shown in figure  [ fig : pilot_sequences ] .",
    "the figure shows the sum spectral efficiency versus the length of training pilot duration for different @xmath130 .",
    "when @xmath35 increases , the channel estimation is more accurate , but the channel estimation overhead increases ( which reduces the pre - log factor of ) . at short @xmath35 ( e.g. @xmath131 )",
    ", the length of information exchange duration is relatively large compared to the length of training duration , and hence , the system performance improves with @xmath35 .",
    "by contrast , when @xmath35 is large , channel estimation overhead dominates the system performance , and therefore , the sum spectral efficiency reduces when @xmath35 increases .",
    "there exist optimal values of @xmath35 so that the sum spectral efficiencies are maximal .",
    "these values increase when @xmath132 decreases .",
    "the reason is that when the @xmath132 is small , we need to use more pilot symbols to increase the channel estimation accuracy .",
    "this observation is in line with @xcite .",
    "we now examine a more practical scenario that takes into account a realistic large - scale fading model .",
    "more precisely , the large - scale fading , is modeled by path loss and shadowing , given by @xcite @xmath133 where @xmath134 is the log - normal random variable with standard deviations of @xmath135 db , @xmath136 represents the path loss exponent , @xmath137 is the distance between user @xmath14 and the relay , and @xmath138 denotes a reference distance . here , we assume that users are located uniformly at random inside a disk with a diameter @xmath139 .    for our comparison , we also consider two - way massive mimo relaying systems where the @xmath19 users are grouped into @xmath140 pairs , and each is assigned different time - slots and uses the two - way relaying scheme to exchange data .",
    "sources exchange data with @xmath19 destinations over two orthogonal time - slots ( i.e. , the number of users is always an even number ) . for this case ,",
    "the pre - log penalty is @xmath141 . compared with our multi - way relaying protocol , the multi - pair two - way relaying protocol",
    "has a smaller pre - log factor ( when @xmath142 ) , but suffers a similar interference effect since multiple users transmit their data in the same time - frequency resource .",
    "] since each pair requires two time - slots for information exchange , we need , in total , @xmath143 time - slots to exchange all information among the @xmath19 users . as a result , the spectral efficiency of the two - way massive mimo relaying system is given by @xmath144 where @xmath145 corresponds to the sinr in for @xmath146 .    in this example , we choose @xmath147 m , @xmath148 db , @xmath149 , @xmath150 m , @xmath129 db .",
    "figure  [ fig : cumulative_distribution_different_k_m ] demonstrates the cumulative distribution of the sum spectral efficiencies for two cases : @xmath151 and @xmath152 .",
    "compared to the two - way massive mimo system , the multi - way massive mimo system reduces the pre - log penalty ( from @xmath153 to @xmath100 ) , however , it exhibits more interference since many users simultaneously transmit data in the same frequency band .",
    "when @xmath18 is large , the interference is small .",
    "therefore , the multi - way massive mimo system outperforms the two - way massive mimo system , especially at large @xmath18 .",
    "we studied multi - way massive mimo relay networks with mr processing and imperfect csi .",
    "we derived a closed - form expression for the spectral efficiency .",
    "our work showed that , by using a large antenna array at the relay , many users can simultaneously exchange their information in the same frequency band without any performance degradation for each user . as a result ,",
    "multi - way massive mimo offers much higher sum spectral efficiency than conventional multi - way mimo or two - way massive mimo systems do .",
    "furthermore , as the number of relay antennas grows large , we can reduce the transmitted power at the relay and/or each user proportionally to @xmath105 , while maintaining a given quality - of - service .",
    "from and , the normalization factor @xmath97 in can be rewritten as @xmath154 where @xmath155_{k}\\right\\|^2\\right\\},\\\\ { \\tt{q_2}}_{k}&=\\mathbb{e}\\left\\{\\left\\|\\left[{\\hat{\\mathbf{g}}}^*{\\mathbf{\\pi}}^{(1)}{\\hat{\\mathbf{g}}}^h{\\mathbf{e}}\\right]_{k}\\right\\|^2\\right\\},\\\\ { \\tt{q_3}}_{m}&=\\mathbb{e}\\left\\{\\left\\|\\left[{\\hat{\\mathbf{g}}}^*{\\mathbf{\\pi}}^{(1)}{\\hat{\\mathbf{g}}}^h\\right]_{m}\\right\\|^2\\right\\}.\\end{aligned}\\ ] ] first , we compute @xmath156 .",
    "we have , @xmath157_{k}\\right\\|^2\\right\\}\\nonumber\\\\ & = \\sum_{k'=1}^{k}\\mathbb{e}\\left\\{\\left\\|{\\hat{\\mathbf{g}}}^*_{k'}{\\hat{\\mathbf{g}}}^h_{k'+1}{\\hat{\\mathbf{g}}}_{k}\\right\\|^2\\right\\}\\nonumber\\\\ & = \\mathbb{e}\\left\\{\\left\\|\\frac{{\\hat{\\mathbf{g}}}^h_{k+1}{\\hat{\\mathbf{g}}}_{k}}{\\|{\\hat{\\mathbf{g}}}_{k}\\|}\\|{\\hat{\\mathbf{g}}}_{k}\\|{\\hat{\\mathbf{g}}}_{k}^*\\right\\|^2\\right\\}+\\mathbb{e}\\left\\{\\left\\|{\\hat{\\mathbf{g}}}^*_{k-1}\\right\\|^2\\|{\\hat{\\mathbf{g}}}_{k}\\|^4\\right\\}\\nonumber\\\\ & + \\!\\!\\!\\!\\!\\!\\!\\!\\sum\\limits_{\\overset{k'=1}{k'\\neq(k , k-1)}}^{k}\\!\\!\\!\\!\\!\\!\\!\\!\\left\\{\\left\\|{\\hat{\\mathbf{g}}}^*_{k'}{\\hat{\\mathbf{g}}}^h_{k'+1}{\\hat{\\mathbf{g}}}_{k}\\right\\|^2\\right\\}\\nonumber\\\\ & = \\sigma^2_{k+1}\\mathbb{e}\\left\\{\\|{\\hat{\\mathbf{g}}}_{k}\\|^4\\right\\}+m\\sigma^2_{k-1}\\mathbb{e}\\left\\{\\|{\\hat{\\mathbf{g}}}_{k}\\|^4\\right\\}\\nonumber\\\\ & + \\!\\!\\!\\!\\!\\!\\!\\!\\sum\\limits_{\\overset{k'=1}{k'\\neq(k , k-1)}}^{k}\\!\\!\\!\\!\\!\\!\\!\\!\\left\\{\\left\\|{\\hat{\\mathbf{g}}}^*_{k'}{\\hat{\\mathbf{g}}}^h_{k'+1}{\\hat{\\mathbf{g}}}_{k}\\right\\|^2\\right\\},\\end{aligned}\\ ] ] where in the last equality we have used the fact that @xmath158 is independent of @xmath159 @xcite . by using lemma 2.9 in @xcite , becomes @xmath160 similarly , we obtain @xmath161 and @xmath162 substituting , and into , we obtain .      @xmath163",
    "compute @xmath164 : we have , @xmath165_{k+1}\\right)\\right\\}.\\end{aligned}\\ ] ]    since @xmath166 and @xmath53 are independent , we obtain    @xmath167_{k+1}\\right\\}\\nonumber\\\\ & = \\mathbb{e}\\left\\{\\|{\\hat{\\mathbf{g}}}_{k}\\|^2\\|{\\hat{\\mathbf{g}}}_{k+1}\\|^2\\right\\}+ \\sum\\limits_{\\overset{k'=1}{k'\\neq k}}^{k}\\mathbb{e}\\left\\{{\\hat{\\mathbf{g}}}^t_{k}{\\hat{\\mathbf{g}}}^*_{k'}{\\hat{\\mathbf{g}}}^h_{k'+1}{\\hat{\\mathbf{g}}}_{k+1}\\right\\}\\nonumber\\\\ & = m^2\\sigma^2_{k}\\sigma^2_{k+1}\\label{eq : ts2}.\\end{aligned}\\ ] ]    @xmath168 compute @xmath169 : from , the variance of @xmath170 is given by @xmath171 since @xmath166 and @xmath53 are independent , can be rewritten as @xmath172 where @xmath173 to compute @xmath174 , we rewrite as @xmath175 again , by using lemma 2.9 in @xcite , we get @xmath176 similarly , we obtain @xmath177       @xmath178    and @xmath179    by using , and substituting , , and into , we arrive at the desired result as in .",
    "@xmath180 compute @xmath181 and @xmath182 :    following a similar methodological approach as in 1 ) and 2 ) , we obtain @xmath181 and @xmath182 given in and , respectively .",
    "this work was supported by project no .",
    "3811/qd - ubnd , binh duong government , vietnam .",
    "the work of h. q. ngo was supported by the swedish research council ( vr ) and elliit .",
    "the work of m. matthaiou was supported in part by the epsrc under grant ep / p000673/1 .",
    "g. amarasuriya , e. g. larsson , and h. v. poor , `` wireless information and power transfer in multi - way massive mimo relay networks , '' _ ieee trans .",
    "wireless commun .",
    "15 , no . 6 , pp . 3837 - 3855 , june 2015 .",
    "f. rusek , d. persson , b. k. lau , e. g. larsson , t. l. marzetta , o. edfors , and f. tufvesson , `` scaling up mimo : opportunities and challenges with very large arrays , '' _ ieee signal process . mag .",
    "1 , pp .  40 - 60 , jan . 2013 .",
    "h. q. ngo , h. a suraweera , m. matthaiou , and e. g. larsson , `` multipair full - duplex relaying with massive arrays and linear processing , '' _ ieee j. sel .",
    "areas commun .",
    "9 , pp . 1721 - 1737 , sept .",
    "e. bjrnson , m. matthaiou , and m. debbah , `` massive mimo with non - ideal arbitrary arrays : hardware scaling laws and circuit - aware design , '' _ ieee trans .",
    "4353 - 4368 , aug . 2015 .",
    "c. kong , c. zhong , m. matthaiou , e. bjrnson , and z. zhang , `` multipair two - way half - duplex relaying with massive arrays and imperfect csi , '' _ ieee trans .",
    "inf . theory _ , jul .",
    "2016 , submitted .",
    "[ online ] .",
    "available : https://arxiv.org/abs/1607.01598 ."
  ],
  "abstract_text": [
    "<S> this paper considers a multi - way massive multiple - input multiple - output relaying system , where single - antenna users exchange their information - bearing signals with the help of one relay station equipped with unconventionally many antennas . </S>",
    "<S> the relay first estimates the channels to all users through the pilot signals transmitted from them . </S>",
    "<S> then , the relay uses maximum - ratio processing ( i.e. maximum - ratio combining in the multiple - access phase and maximum - ratio transmission in the broadcast phase ) to process the signals . </S>",
    "<S> a rigorous closed - form expression for the spectral efficiency is derived . </S>",
    "<S> the effects of the channel estimation error , the channel estimation overhead , the length of the training duration , and the randomness of the user locations are analyzed . </S>",
    "<S> we show that by deploying massive antenna arrays at the relay and simple maximum - ratio processing , we can serve many users in the same time - frequency resource , while maintaining a given quality - of - service for each user .    </S>",
    "<S> channel state information , massive mimo , multi - way relay networks . </S>"
  ]
}