{
  "article_text": [
    "let @xmath1 be a permutation .",
    "a _ block interchange _ is an operation that interchanges two blocks of consecutive entries without changing the order of entries within each block .",
    "the two blocks do not need to be adjacent . interchanging the blocks @xmath2 and @xmath3 with @xmath4 results in the permutation @xmath5 for instance , if @xmath6 , then interchanging the block of the first two entries with the block of the last three entries results in the permutation @xmath7 .    in this paper",
    ", we are going to compute the average number of block interchanges to sort a permutation of length @xmath0 .",
    "the methods used in the proof are surprising for several reasons .",
    "first , our enumeration problem will lead us to an interesting question on the symmetric group that is very easy to ask and that is of probabilistic flavor .",
    "second , this question then turns out to be surprisingly difficult to answer the conjectured answer of one of the authors has only recently been proved by richard stanley @xcite , whose proof was not elementary .      the first significant result on the topic of sorting by block interchanges is by d. a. christie @xcite , who provided a direct way of determining the number of block interchanges necessary to sort any given permutation @xmath8 .",
    "the following definition was crucial to his results .",
    "the _ cycle graph _",
    "@xmath9 of the permutation @xmath1 is a directed graph on vertex set @xmath10 and @xmath11 edges that are colored either black or gray as follows .",
    "set @xmath12 .    1 .   for @xmath13 , there is a black edge from @xmath14 to @xmath15 , where the indices are to be read modulo @xmath16 , and 2 .   for @xmath13",
    ", there is a gray edge from @xmath17 to @xmath18 , where the indices are to be read modulo @xmath16 .",
    "see figure [ christiegraphs ] for two examples .",
    "[ christiegraphs ]    it is straightforward to show that @xmath9 has a unique decomposition into edge - disjoint directed cycles in which the colors of the edges alternate . let @xmath19 be the number of directed cycles in this decomposition of @xmath9 .",
    "the main enumerative result of @xcite is the following formula . in the rest of this paper ,",
    "permutations of length @xmath0 will be called @xmath0-permutations , for shortness .",
    "[ christie ] the number of block interchanges needed to sort the @xmath0-permutation @xmath8 is @xmath20 .",
    "note that in particular this implies that @xmath16 and @xmath19 are always of the same parity .",
    "christie has also provided an algorithm that sorts @xmath8 using @xmath20 block interchanges . as the identity permutation is the only @xmath0-permutation that takes zero block interchanges to sort , it is the only @xmath0-permutation @xmath8 satisfying @xmath21 .",
    "theorem [ christie ] shows that in order to find the average number @xmath22 of block interchanges needed to sort an @xmath0-permutation , we will need the average value of @xmath19 for such permutations .",
    "the following definition @xcite will be useful .",
    "the _ hultman number _",
    "@xmath23 is the number of @xmath0-permutations @xmath8 satisfying @xmath24 .",
    "so the hultman numbers are somewhat analogous to the signless stirling numbers of the first kind that count @xmath0-permutations with @xmath25 cycles .",
    "this is a good place to point out that in this paper , we will sometimes discuss _ cycles of the permutation _",
    "@xmath8 in the traditional sense , which are not to be confused with the _ directed cycles of _ @xmath9 , counted by @xmath19 . following @xcite ,",
    "the number of cycles of the permutation @xmath8 will be denoted by @xmath26 .",
    "indeed , the cycles of a permutation @xmath8 are equivalent to the directed cycles of the graph @xmath27 in which there is an edge from @xmath17 to @xmath28 if @xmath29 .",
    "for instance , if @xmath30 , then @xmath31 , while @xmath32 .",
    "the following recent theorem of doignon and labarre @xcite brings the hultman numbers closer to the topic of enumerating permutations according to their cycle structure ( in the traditional sense ) .",
    "let @xmath33 denote the symmetric group of degree @xmath0 .",
    "[ doignon ] the hultman number @xmath23 is equal to the number of ways to obtain the cycle @xmath34 as a product @xmath35 of permutations , where @xmath36 is any cycle of length @xmath16 , and the permutation @xmath37 has exactly @xmath25 cycles , that is @xmath38 .",
    "the following immediate consequence of theorem [ doignon ] is more suitable for our purposes .",
    "the hultman number @xmath23 is equal to the number of @xmath39-cycles @xmath40 so that the product @xmath41 is a permutation with exactly @xmath25 cycles , that is , @xmath42 .    for any fixed @xmath0 ,",
    "we have @xmath43 since @xmath21 if and only if @xmath8 is the identity permutation . and indeed , there is exactly one @xmath39-cycle ( in fact , one permutation ) @xmath36 so that @xmath44 has @xmath16 cycles , namely @xmath45 .    in other words , finding the average of the numbers @xmath19 over all @xmath0-permutations @xmath8 is equivalent to finding the average of the numbers @xmath46 , where @xmath40 is an @xmath39-cycle .    let us consider the product @xmath47 , where @xmath48 is a cycle of length @xmath0 .",
    "let us insert the entry @xmath16 into @xmath48 to get the permutation @xmath49 so that @xmath16 is inserted between two specific entries @xmath50 and @xmath51 in the following sense .",
    "@xmath52 see figure [ insert ] for an illustration .    [ insert ]    the following proposition is the first step towards describing how the hultman numbers grow .",
    "[ equal ] let @xmath50 , @xmath51 , and @xmath49 be defined as above , and let @xmath53 .",
    "then we have @xmath54    let us assume first that @xmath55 , and that @xmath56 is in a cycle @xmath57 of @xmath58 , and @xmath59 is in a different cycle @xmath60 of @xmath58 .",
    "let @xmath61 and let @xmath62 .",
    "after the insertion of @xmath16 into @xmath48 , the newly obtained permutation @xmath63 sends @xmath56 to @xmath16 , then @xmath16 to @xmath59 , then leaves the rest of @xmath60 unchanged till its last entry .",
    "then it sends @xmath0 back to @xmath64 , from where it continues with the rest of @xmath57 with no change .",
    "so in @xmath65 , the cycles @xmath57 and @xmath60 are united , the entry @xmath16 joins their union , and there is no change to the other cycles of @xmath58 .",
    "see figure [ firstcase ] for an illustration .",
    "[ firstcase ]    let us now assume that @xmath55 , and that @xmath56 and @xmath59 are both in the same cycle @xmath66 of @xmath58 . then @xmath67 .",
    "after the insertion of @xmath16 into @xmath48 , the newly obtained permutation @xmath63 sends @xmath56 to @xmath16 , then @xmath16 to @xmath59 , cutting off the part of @xmath66 that was between @xmath56 and @xmath0 .",
    "so @xmath66 is split into two cycles , the cycle @xmath68 and the cycle @xmath69 .",
    "note that @xmath70 since @xmath64 .",
    "see figure [ secondcase ] for an illustration .",
    "[ secondcase ]    finally , if @xmath71 , then @xmath72 , and the rest of the cycles of @xmath58 do not change .",
    "let @xmath73 denote the set of @xmath0-permutations that can be obtained as a product of two cycles of length @xmath0 .",
    "let @xmath22 be the average number of cycles of the elements of @xmath73 .",
    "[ oddcase ] for all positive integers @xmath74 , we have @xmath75 .    we apply proposition [ equal ] , with @xmath0 replaced by @xmath76 .",
    "this means @xmath16 is an odd number .",
    "so @xmath49 is a cycle of length @xmath77 obtained from a cycle @xmath48 of length @xmath78 through the insertion of the maximal element @xmath77 into one of @xmath78 possible positions . by proposition [ equal ] ,",
    "some of these insertions increase @xmath79 by one , and others decrease @xmath79 by one , depending on whether @xmath56 and @xmath59 are in the same cycle of @xmath58 or not .",
    "the question is , of course , how many times they will be in the same cycle of @xmath58 .",
    "this question is easily seen to be equivalent to the following question .",
    "let @xmath17 and @xmath28 be two fixed elements of the set @xmath80 select an element @xmath8 of @xmath81 at random .",
    "what is the probability that @xmath8 contains @xmath17 and @xmath28 in the same cycle ?    the first author of this article has conjectured that the answer to this question was 1/2 for odd @xmath82 .",
    "this conjecture was recently proved by richard stanley @xcite , who also settled the question for even values of @xmath82 .",
    "[ stanley ] @xcite let @xmath17 and @xmath28 be two fixed , distinct elements of the set @xmath83=\\{1,2,\\cdots , h\\}$ ] , where @xmath84 .",
    "let @xmath85 and @xmath86 be two randomly selected @xmath82-cycles over @xmath83 $ ] .",
    "let @xmath87 be the probability that @xmath17 and @xmath28 are in the same cycle of @xmath88 . then @xmath89    the proof of lemma [ oddcase ] is now straightforward .",
    "if @xmath90 , then @xmath56 and @xmath59 are equally likely to be in the same cycle or not in the same cycle of @xmath58 .",
    "therefore , an increase of one or a decrease of one in @xmath79 is equally likely .",
    "if , on the other hand , @xmath71 , which occurs in @xmath91 of all cases , then @xmath79 increases by one .",
    "so @xmath92    note that the statement of lemma [ oddcase ] holds even when @xmath93 , since @xmath94 .",
    "as theorem [ stanley ] provided a formula for @xmath95 for even values of @xmath82 as well as odd values , we can state and prove the analogous version of lemma [ oddcase ] for the integers not covered there .",
    "[ evencase ] for all positive integers @xmath74 , we have @xmath96    this is very similar to the proof of lemma [ oddcase ] . if @xmath90 , which happens in @xmath97 of all cases , then the probability of @xmath56 and @xmath59 falling into the same cycle of @xmath58 is @xmath98 by theorem [ stanley ] . by proposition [ equal ] , in these cases @xmath79",
    "grows by one .",
    "if @xmath71 , which occurs in @xmath99 of all cases , @xmath79 always grows by one .",
    "so @xmath100 which is equivalent to the statement of the lemma as can be seen after routine rearrangements .",
    "we are now in position to state and prove our formula for the average number @xmath22 of cycles in elements of @xmath73 .",
    "[ average ] we have @xmath101 , and @xmath102    note that this formula produces even the correct value even for @xmath103 , that is , it produces the equality @xmath101 .",
    "( of theorem [ average ] ) the statement is now a direct consequence of lemmas [ oddcase ] and [ evencase ] if we note the telescoping sum @xmath104 obtained when summing the values computed in lemma [ evencase ] .",
    "note that it is well - known that on average , an @xmath0-permutation has @xmath105 cycles .",
    "this is the average value of @xmath106 for a randomly selected @xmath0-permutation .",
    "theorem [ average ] shows that the average value of @xmath19 differs from this by about @xmath107 .",
    "finally , our main goal is easy to achieve .    the average number of block interchanges needed to sort an @xmath0-permutation is @xmath108    by theorem [ doignon ] and theorem [ average ] , the average number value of @xmath19 over all permutations @xmath8 of length @xmath0 is @xmath109 .",
    "our claim now immediately follows from theorem [ christie ] .",
    "so the average number of block interchanges needed to sort an @xmath0-permutation is close to @xmath110 .",
    "richard stanley s proof of theorem [ stanley ] is not elementary .",
    "it uses symmetric functions , exponential generating functions , integrals , and a formula of boccara @xcite .",
    "a more combinatorial proof of the stunningly simple answer for the case of odd @xmath25 would still be interesting .    as pointed out by richard stanley @xcite",
    ", there is an alternative way to obtain the result of theorem [ average ] without using theorem [ stanley ] , but that proof in turn uses symmetric functions and related machinery .",
    "it is shown in exercises 69(a ) and 69(c ) of @xcite that @xmath111 where , as usual , @xmath112 is a signless stirling number of the first kind , that is , the number of permutations of length @xmath0 with @xmath25 cycles . now @xmath22 can be computed by considering @xmath113 , which in turn can be computed by considering the well - known identity @xmath114 and then evaluating @xmath115 .",
    "the present paper provides further evidence that the cycles of the graph @xmath9 have various enumerative properties that are similar to the enumerative properties of the graph @xmath27 , that is , the cycles of the permutation @xmath8 .",
    "this raises the question as to which well - known properties of the stirling numbers , such as unimodality , log - concavity , real zeros property , hold for the hultman numbers as well .",
    "( see for instance chapter 8 of @xcite for definitions and basic information on these properties . )",
    "a simple modification is necessary since @xmath116 if @xmath0 and @xmath25 are of the same parity .",
    "so let @xmath117      clearly , @xmath123 if @xmath0 is even , and @xmath124 if @xmath0 is odd . however , exercise 69(b ) of @xcite shows that all roots of @xmath118 have real part 0 .",
    "hence the roots of @xmath121 are all real and non - positive , from which the log - concavity and unimodality of the coefficients of @xmath121 follows .",
    "this raises the question of whether there is a combinatorial proof for the latter properties , possibly along the lines of the work of bruce sagan @xcite for the stirling numbers of both kinds .",
    "perhaps it is useful to note that ( [ stirling ] ) and theorem [ doignon ] imply that @xmath125    finally , to generalize in another direction , we point out that it is very well - known ( see , for example , chapter 4 of @xcite ) , that if we select a @xmath0-permutation @xmath8 at random , and @xmath17 and @xmath28 are two fixed , distinct positive integers at most as large as @xmath0 , then the probability that @xmath8 contains @xmath17 and @xmath28 in the same cycle is @xmath126 .",
    "theorem [ stanley ] shows that if @xmath0 is odd , then the set @xmath73 behaves just like the set @xmath33 of all permutations in this aspect .",
    "this raises the question whether there are other naturally defined subsets of @xmath0-permutations in which this phenomenon occurs .",
    "we are indebted to richard stanley for helpful discussions on various aspects of exercises 69(a - c ) of @xcite , and , most of all , for proving theorem [ stanley ] .",
    "we are also thankful to anthony labarre and axel hultman for bringing earlier results to our attention .",
    "99 g. boccara , nombres de rpresentations dune permutation comme produit de deux cycles de longueur donnes , _ discrete math . _",
    "* 29 * ( 1980 ) , 105 - 134 .",
    "m. bna , introduction to enumerative combinatorics , mcgraw - hill , 2007 .",
    "d. a. christie , sorting permutations by block interchanges , _ inform . process .",
    "* 60 * ( 1996 ) , 165 - 169 .",
    "doignon , a. labarre , on hultman numbers , _ journal of integer sequences , _ * 10 * ( 2007 ) , article 07.6.2 . b. e. sagan , inductive and injective proofs of log concavity results .",
    "_ discrete math .",
    "_ * 68 * ( 1988 ) , vol . 2 - 3 , 281292 .",
    "r. stanley , proof of a conjecture of bna on products of cycles , _",
    "preprint_. r. stanley , personal communication , october , 2008 .",
    "r. stanley , supplementary exercises ( without solutions ) for chapter 7 ( symmetric functions ) of enumerative combinatorics , volume 2 , _ cambridge university press _ , 1999 .",
    "internet resource , available at"
  ],
  "abstract_text": [
    "<S> we use an interesting result of probabilistic flavor concerning the product of two permutations consisting of one cycle each to find an explicit formula for the average number of block interchanges needed to sort a permutation of length @xmath0 .    research supported by the national science foundation , the national security agency , and the howard hughes medical institute . ]     research supported by the howard hughes medical institute . ] </S>"
  ]
}