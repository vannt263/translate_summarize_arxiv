{
  "article_text": [
    "object detection , especially at faint flux limits , has always been considered something of a `` black art '' .",
    "this is despite the fact that all techniques use the same basic steps , i.e.  filtering of the images with a psf - like kernel , clipping of the filtered data using a heuristically chosen threshold and then rejecting objects with too few connected pixels ( focas  valdes 1982 , sextractor  bertin & arnouts 1996 ) .",
    "each of these methods works well in the high signal - to - noise regime , easily detecting all objects that lie significantly above the sky noise .",
    "there is , however , a substantial difference in the efficiency of the object detection process , dependent on how we filter the images and what thresholds are applied to identify objects as the detection threshold approaches the noise level .",
    "when multiband photometry is available , the problem of how to systematically detect objects in all passbands becomes significantly more complex .",
    "there are two basic approaches that are commonly used in the astronomical literature .",
    "object detection is undertaken in a single passband ( or a co - added image ) with a matched aperture used to measure the fluxes of the object in the additional passbands or object detection is applied to each passband independently and the resulting catalogs are merged to give a master list .",
    "each of these approaches has its own set of problems .",
    "using a single image to derive a catalog can miss objects with unusual colors or objects at the limit of detection in a single passband ( e.g.  it is easy to imagine that if we set an object detection limit at @xmath1 for each pixel in a single band we will miss objects which would be a @xmath2 detection in each individual passband but if we had considered all bands together we would have accepted this pixel with a very high significance ) .",
    "detecting independently in each passband requires matching of objects that may be detected in only one passband or be resolved into a different number of components dependent on the passband the object was observed in .    in this paper",
    "we attempt to deal with these detection problems in a simple and objective fashion that segments images by taking into account all the color information available . in section 2",
    "we describe the statistical basis and the formal description of our technique .",
    "sections 3 contains the description of our technique as applied to the hubble deep field , the ultimate faint multicolor dataset that has been a challenge for advanced processing techniques . in section 4",
    "we discuss the results , and the use of optimal subspace filtering to enhance the detection of fainter objects of a specific color .",
    "consider a region on the sky that has been imaged in @xmath3 different photometric bands all of which have been registered to a common scale and size , thus every pixel contains @xmath3 numbers , the measured fluxes @xmath4 .",
    "we will further assume that the images are sky noise limited , i.e. instrumental sources of pixel noise are irrelevant compared to the photon noise of the sky background . in order to proceed",
    "further we first determine the mean @xmath5 and the gaussian dispersion @xmath6 of the sky in each band .",
    "this can be performed using standard techniques , e.g.  by studying the distribution of pixels in the vicinity of the mode of the pixel values . in the next step",
    "each image is transformed into one where the sky is a normal gaussian with zero mean and unit dispersion .",
    "each pixel is thus described by the @xmath3-dimensional vector @xmath7 if there were no objects in the image , only sky , each component of these vectors would be distributed as a normal gaussian .",
    "the probability distribution of @xmath8 , the squared length of the vector , @xmath9 is then a @xmath0 with @xmath3 degrees of freedom and each value of @xmath8 is uniquely associated with the probability density , @xmath10    since this is a monotonic function with respect to @xmath8 , we can create a new image consisting of the @xmath0 values .",
    "any value of a pixel in this image can be immediately interpreted as the cumulative probability @xmath11 of how likely this pixel is drawn from the sky distribution .",
    "this probability can be computed or read from a standard table . in the actual `` probability''-image",
    "we will just use the @xmath8 values for convenience since the mapping is monotonic .",
    "if we have performed filtering on the original images ( e.g.  with a psf - like kernel ) , the pixel values may be correlated as @xmath12 , even if the original sky pixels were not .",
    "it was shown ( adler 1981 ) , that in the special case of 2d random fields the @xmath0 field has a correlation function @xmath13 , thus in the filtered and non - filtered images we have an analytic understanding of how the statistical properties behave under our null hypothesis ( i.e.a purely sky noise image ) .      the next step is to consider the deviations from our null - hypothesis , i.e. that all pixels are drawn from a gaussian sky .",
    "this will be done by clipping the @xmath0-image at a threshold high enough that a pixel is unlikely to be drawn from the sky at a particular significance level .",
    "figure 1 shows the distribution of the @xmath14 values derived from the hubble deep field ( see section 3 ) . the long - tailed contribution due to",
    "the presence of objects within the images is clearly visible . in principle",
    "we could choose an arbitrary threshold in the @xmath8 values to separate those pixels dominated by object flux from the sky pixels . as we know the expected probability distribution for the sky pixels ( a @xmath0 distribution ) we can approach this problem in an objective fashion .    for small values of @xmath8",
    "we know that the contribution to the flux in each pixel will be due to the sky and that the distribution will be that of a @xmath0 . in figure 1",
    "the solid line shows the fitted @xmath0 distribution and the dashed line the difference between the @xmath0 and the observed distribution ( i.e.  the contribution due to the objects ) .",
    "the point where the two lines intersect determines the so called `` optimal bayes threshold '' ( fukunaga 1990 ) , resulting in the smallest possible total error , i.e.  the sum of erroneously tagging a sky pixel as an object , or missing an object pixel .",
    "if a different cost for the two kinds of errors is adopted , making one more expensive , the optimal threshold can be computed from minimizing that particular cost function .",
    "for example , we may want to set our threshold much lower , at the expense of many false detections , in order to find all the objects in the field .",
    "clipping at this threshold results in a binary mask image , where every pixel is tagged with a value of 0 , if it is consistent with sky , and 1 if it is unlikely to be sky .",
    "the next step in the processing is the creation of contiguous regions",
    ". objects which consist of too small a number of pixels need to be rejected . in principle",
    "such a distribution can be analytically calculated , at least in 2 dimensions , in the high threshold approximation ( adler 1978 ) , but we propose an empirical approach : it is easy to generate entirely gaussian random images , then apply the same filtering , thresholding and segmentation as for the data above .",
    "the region statistics computed from such images will then yield the distribution for our null hypothesis .",
    "subtracting this from the data will give us the expected distribution of the object sizes .",
    "an optimal threshold is then again determined from these two distributions , as above .",
    "in the following section we describe the application of these techniques to the multicolor @xmath15 , @xmath16 , @xmath17 and @xmath18 photometry of the hubble deep field ( hdf ; williams et al.1996 ) . to compare the @xmath0 image detection algorithm with the standard methods we restrict our analysis to a single wfpc2 chip ( chip 4 ) taken from version 2 of the drizzled hdf data .",
    "we further restrict the data we consider by excluding the outer 200 pixels from each image to remove those regions of each frame where the noise is considerably higher , due to the dithering pattern .",
    "the final frames comprise , for each of the four passbands , 1781@xmath191741 images with 0.04 arcsec pixels .    in the construction of these images they have already undergone a fairly detailed reduction process , which includes compensation for bad pixels and cosmic ray removal .",
    "they still require , however , additional processing in order to derive a pixel set with more uniform statistical properties .",
    "if the mean sky background differs from zero across the frame ( i.e.the sky has not been accurately subtracted from the images ) the @xmath8 image will not approximate a @xmath0 distribution , even without the presence of objects on a frame .",
    "in fact how well the @xmath8 image matches a @xmath0 distribution , for low values of @xmath8 , is a very sensitive test of the background subtraction technique .",
    "we know from examining the hdf data that they suffer from residual scattered light , particularly in the @xmath15 passband ( williams et al .",
    "this arises as an x pattern , due to the shadowing of the scattered light by the mirror supports , superimposed on the background sky and occurs at the few percent level .",
    "we must , therefore , fit and remove this contribution before constructing the @xmath8 image .    as this is an additive contribution ,",
    "it can be subtracted - its effect on the level of sky noise is minimal . to create a smooth sky",
    "we derive a mask , corresponding to a very generous cut of non - sky pixels .",
    "we set our threshold to select the upper 16% of pixels in a variance image measured over a 3x3 pixel neighborhood .",
    "to safely stay away from the wings of objects we grow this mask outwards by 5 pixels .",
    "these masked pixels defined the object regions .",
    "next , we grow these regions by an additional 14 pixels .",
    "this provides an annulus of sky around each object .",
    "pixels within neighboring object regions that intersect these annuli have been masked off .",
    "the mean value of the sky has been computed within these annuli and the central regions corresponding to objects filled - in with this value .",
    "finally , we smooth this background image image with a 46 pixel wide gaussian filter and subtract it from the original frame ( creating images with zero mean sky ) .",
    "the final step in preprocessing the images is to convolve with a 3 pixel wide symmetric gaussian kernel to perform the usual psf filtering .",
    "this step removes the arbitrariness of the location of pixel boundaries , and increases the s / n of the data .",
    "the hdf images have also a rather peculiar correlation due to the pattern of the drizzling . by choosing a filter slightly broader than this width , we are insensitive to the details of the drizzling .",
    "we then build a histogram of the pixel values in each of the bands and measure the dispersion of the sky .",
    "this is done by fitting an inverted parabola to the log of the pixel histogram , using only the data range around the modal value , extending slightly more to the negative .",
    "the fits were found to be excellent .",
    "the images were then divided by the dispersion , resulting in zero mean , unit dispersion gaussian images .      to build up the @xmath0 or @xmath8 image we sum the squares of the individual pixel values in the four normalized images . from this",
    "we construct the probability histogram ( see figure 1 ) . for the hdf data we choose to consider the distribution of the square root , @xmath20 of the @xmath8 values ( i.e. @xmath21 ) .",
    "we do this because r corresponds to a signal - to - noise statistic ( as opposed to the squared signal - to - noise of @xmath8 ) and can , therefore , be more naturally compared with the standard techniques of thresholding images at a given multiple of the sky noise .",
    "@xmath20 is the length of the @xmath3-dimensional pixel vector .",
    "the normalized probability distribution for r , with 4 degrees of freedom , corresponds to @xmath22    in figure 1 we show the distribution of pixel values . as noted in section 2.2 the long positive tail is due to the contribution from objects within the image frame .",
    "we fit the probability distribution given in equation 4 to the points below the peak of the histogram ( i.e. @xmath23 ) by varying the number of sky pixels as the only free parameter .",
    "the fit is shown as a dotted line within figure 1 .",
    "the difference between the fitted `` sky '' distribution and the observed histogram is given by the dashed line .",
    "this represents the probability distribution of pixels occupied by object flux .",
    "the intersection of these two lines provides the bayesian threshold ( where the incompleteness and contamination errors , at a pixel level , are equal ) .",
    "we choose this crossover point ( @xmath24 ) as the threshold used in the image detection and analysis routines , in order to demonstrate our ideas .",
    "this is a rather conservative cut , as we shall see , since this corresponds to a 2.42@xmath25 per pixel pixel detection .",
    "object detection is undertaken using sextractor v2.0.8 ( bertin & arnouts 1996 ) .",
    "this version of sextractor allows the detection and analysis algorithms to be run on separate images ( i.e.  we can detect objects on one frame and measure the photometric properties of these detected objects from a separate image ) .",
    "we , therefore , use the @xmath20 image for detection and measure the fluxes and magnitudes for a fixed set of apertures in the @xmath15 , @xmath16 , @xmath17 and @xmath18 passbands . as all detections",
    "are undertaken using a single image this procedure alleviates the task of matching catalogs from multiple passbands ( where images from different filters may be undetected in a particular passband or broken up into multiple images ) .",
    "the intersection of the sky and object distributions corresponds to an @xmath20 value of @xmath24 .",
    "this is equivalent to a probability of 0.9924 that a pixel value in the convolved image is not due to the background sky .",
    "we adopt this relatively high probability because the detected objects are unlikely to be contaminated by spurious sources and , as the goal of this paper , is to demonstrate the applicability of our new technique and to compare it with standard techniques , we do not wish to push the initial application into the noise .",
    "it should be noted that sextractor , as with most object detection packages , fits and subtracts a sky image before applying a detection threshold .",
    "as the @xmath0 image is , by definition , a positive definite quantity , subtracting a background will affect the detection threshold .",
    "we have , therefore , modified the code to exclude background subtraction for the detection image . to derive fluxes in the photometric passbands for each detected object , matched aperture photometry",
    "was then performed on the @xmath15 , @xmath16 , @xmath17 and @xmath18 images separately .",
    "of course , when searching for faint objects , one may abandon the choice of the optimal bayes classifier , rather one would set a much lower detection threshold .",
    "such a threshold will shift the balance between the two errors , in essence we detect all the real objects , at the expense of a lot of false detections .",
    "in such a case one can use some more heuristic constraints to reduce the number of these spurious sources .",
    "for example , one can require that in the detected objects all of the fluxes be non - negative , or differ from zero by less than @xmath26 , or one can require that at least one of the bands has a positive flux . since the sky noise has a symmetry around zero in each of the bands",
    ", one can subdivide our detections into @xmath27 ` hyper - quadrants ' , according to the sign of their fluxes in each of the @xmath3 bands .",
    "in the all - negative quadrant , all objects are false detections .",
    "since there should be a similar number in the other ` hyper - quadrants ' , we can use the all - negatives as an estimator of the false detections . in practice , at the limit of the @xmath24 threshold",
    ", this filtering of the catalog makes little difference to the number of detected sources .",
    "as we have shown in section 2 the @xmath0 detection algorithm provides an almost optimal use of the multicolor information .",
    "we now compare the results from the hdf data with the standard detection techniques found in the literature .",
    "specifically we consider three cases , one where the initial detection is undertaken on the i band image alone ( using matched apertures on the other 3 passbands to derive the multicolor photometry ) , second where we detect galaxies using the sum of the v and i images ( as was done for the hdf data in williams et al .",
    "( 1996 ) ) and a third case where we co - add all four passbands weighted by the inverse of their sky noise ( the weighting of the passbands is given by the vector in equation 5 ) .    to provide a direct comparison between these differing techniques we need to detect galaxies to a common threshold .",
    "the @xmath24 threshold corresponds to a probability of 0.9924 that the flux in a pixel in the convolved image exceeds that due to the sky alone ( i.e.  contains object flux ) . for a gaussian sky distribution with zero mean",
    "this is equivalent to a 2.43@xmath25 deviation .",
    "we , therefore , convolve the i and @xmath28 images with a kernel of 3 pixels fwhm ( as was done for the original images used to create the @xmath0 ) and use sextractor to derive an object catalog with a 2.43@xmath25 threshold . note that this deliberately conservative threshold is substantially higher than that applied to the hdf data by williams et al .",
    "( 1996 ) .",
    "figure 2 shows the comparison between these different approaches ( for each of the four passbands ) , with the @xmath0 technique shown as a long dashed line , the weighted image ( @xmath29 ) as a short dashed line , the @xmath28 detection as a solid line and the i detection as a long then short - dashed line . for bright galaxies ( @xmath30 )",
    "each of the three techniques find similar numbers of objects on a frame .",
    "as we move to fainter magnitude limits the numbers of objects detected in the @xmath29 , @xmath28 and @xmath0 images clearly exceed those found in the i band image .",
    "the magnitude limit for the detection of objects in the @xmath29 and @xmath28 images are approximately 0.4 magnitudes fainter than that determined from the i image .",
    "the comparable depths of the @xmath29 and @xmath28 catalogs is not surprising .",
    "the difference between the weight vector for the @xmath29 image and that for the @xmath28 image is only 17 degrees .",
    "therefore , the @xmath28 image provides essentially an optimal linear combination of the four passbands ( given the relative depths of the data ) .",
    "it differs from the @xmath29 image only in that it is not sensitive to very blue objects .",
    "the @xmath0 detection limit extends , however , 0.4 magnitudes deeper than either of the @xmath29 and @xmath28 image .",
    "the difference between the different detection techniques on the histogram is striking .",
    "since the thresholds were locked together through the pixel tail probabilities , one obvious reason could be that simply taking a lower threshold in the gaussian detections would have reproduced the result of the @xmath0 clipping .",
    "there will be obviously some differences , due to the different behavior of the excursion sets ( regions consisting of pixels above a threshold ) for gaussian and @xmath0 fields .",
    "imagine an object in a single band image consisting of @xmath31 pixels , all exactly at our selection threshold .",
    "the sky noise will statistically move half the pixels below the detection threshold , while the other half will remain above . for a @xmath0 , in the high threshold limit",
    ", approximately the same thing happens , but as we approach lower and lower fluxes , it is more and more likely that the effect of sky noise will be such , that the pixel remains above the threshold , thus the destructive interference is much smaller , at the expense of more false detections , of course .",
    "last , but not least it is also possible , that we simply detect objects with such colors , that were undetected in the single ( or co - added ) gaussian band .",
    "this can be seen in figure 3 where we show the distribution of ( @xmath32 ) colors of objects found in the @xmath29 and @xmath0 images .",
    "the solid histogram shows the color distribution for objects selected from the @xmath29 images and the open histogram the color distribution from the @xmath0 image .",
    "the weighting of the @xmath29 selection preferentially selects objects with intrinsically redder colors ( with a mean color of @xmath33 ) .",
    "the @xmath0 image , by contrast , has a more symmetric color distribution with a mean color @xmath34 .",
    "also note , that the scatter in the color distribution is considerably broader for the @xmath0 detections .",
    "we show that this is a significant effect , by splitting the objects into two categories : those detected in both the @xmath29 and @xmath20 images and those detected in @xmath20 only ( there were no objects found in @xmath29 but not in @xmath20 ) .",
    "next , we create a histogram of the number of these detections versus the peak of the @xmath20 value inside the object . in figure 4",
    "we show this distribution with those objects found in the @xmath29 and @xmath20 images shown by a solid line and those found in @xmath20 alone shown by a dashed line .",
    "we can see , that there are objects , un - detected in @xmath29 , that have a very significant value of @xmath20 .    in figure 5",
    "we show the @xmath35 , @xmath36 and @xmath37 images of 4 of those objects which had significant @xmath20 values ( @xmath38 ) but were not detected in the @xmath29 image .",
    "together with the optical passbands we show the @xmath20 image for each object .",
    "it is clear from these images that those objects selected in the @xmath20 frame but not in @xmath29 are predominantly bright in a single passband ( possibly due to strong emission lines ) . a linear combination of the available passbands (",
    "whether the @xmath28 combination or the @xmath29 weighted sum ) does not maximize the signal - to - noise of the resultant image for these galaxies with unusual colors .",
    "the @xmath20 image does , however , provide an optimal combination of the available passbands and can be used to derive a sample of galaxies that is not biased towards a specific type while maximizing the information present in the multicolor data .",
    "the @xmath0 technique we have described above is the optimal way for detecting objects within an image with no prior information . in this section",
    "we outline a possible extension to our technique given a model for the colors of the objects we expect to detect .    in our four - dimensional flux system",
    "( for the hdf ) every pixel is a 4d vector .",
    "sky pixels are uniformly scattered , all directions are equally probable . objects or pixels of a specific color on the other hand all point to the same direction , denoted by @xmath39 . since the noise with our scaling is spherically symmetric , the component of the noise in this direction is also a normal gaussian .",
    "thus by ignoring all the other components , i.e. taking a linear combination of the different images along the @xmath39 direction , we discard 3 of the 4 noise components , an effective increase in our signal - to - noise of 2 .",
    "thus we are keeping as much of the signal as possible , while including as little of the noise as possible .",
    "similarly , we can define a 2 dimensional subset , where most of the objects lie , and we can create a @xmath0 image in that 2d subset of the 4d color space .",
    "these techniques are called , for the obvious reason , `` optimal subspace filtering '' . in order to determine the optimal directions ,",
    "we have performed a principal component analysis for all the pixels which were above our threshold of @xmath40 .",
    "the resulting vector is the following : @xmath41 note , that this is quite near to the @xmath28 , the cosine of the angle is 0.95 .",
    "this would be the preferred direction to use to go after objects of ` typical ' colors , but it would have the danger of losing faint objects at the extreme ends of the color distribution .",
    "if we know colors of our preferred objects a priori , i.e. we are focusing on a narrow range of galaxy colors , we can use the linear combination along the corresponding direction to enhance our detection .",
    "in such a way one can develop particularly sensitive detections of specific classes of object .",
    "we have formulated an object detection algorithm that is capable of using all the multicolor information available in a given field . applying this algorithm to the hubble deep field",
    "we have shown that it performs substantially better than standard image analysis techniques .",
    "given a certain probability threshold , we find that the @xmath0-based detection technique can identify faint objects of unusual colors , where detections on single co - added images may fail .",
    "we outline several heuristics on how false detections can be reduced , should one adopt a very low detection threshold , using the isotropy properties of the multidimensional sky - noise and we discuss how to optimize these detections for objects of specific colors . given the increasing commonality of large multicolor photometric surveys we believe that the adoption of techniques such as we describe here would significantly improve the resulting object catalogs .",
    "we would like to thank the hdf team for making their data so rapidly available to the public .",
    "most of our image processing has been implemented using kbvision , helpful advice from pete eggleston ( aai ) is happily acknowledged in this task .",
    "adler , r.a .",
    ", 1981 , the geometry of random fields , ( new york , j. wiley ) fukunaga , k. , 1990 , introduction to statistical pattern recognition ( academic press inc , san diego ) bertin , e. , & arnouts , s. 1996 , a&a , 117 , 393 valdes , f. , 1982 , proc .",
    "spie , 331 , 465 williams , r.e .",
    "et al . , 1996 ,",
    "aj , 112 , 1335"
  ],
  "abstract_text": [
    "<S> we present a novel way to detect objects when multiband images are available . </S>",
    "<S> typically , object detection is performed in one of the available bands or on a somewhat arbitrarily co - added image . </S>",
    "<S> our technique provides an almost optimal way to use all the color information available . </S>",
    "<S> we build up a composite image of the n passbands where each pixel value corresponds to the probability that the given pixel is just sky . by knowing the probability distribution of sky pixels ( a @xmath0 distribution with n degrees of freedom ) , </S>",
    "<S> the data can be used to derive the distribution of pixels dominated by object flux . from the two distributions </S>",
    "<S> an optimal segmentation threshold can be determined . </S>",
    "<S> clipping the probability image at this threshold yields a mask , where pixels unlikely to be sky are tagged . </S>",
    "<S> after using a standard connected - pixel criterion , the regions of this mask define the detected objects . applying this technique to the hubble deep field data , we find that we can extend the detection limit of the data below that possible using linearly co - added images . </S>",
    "<S> we also discuss possible ways of enhancing object detection probabilities for certain well defined classes of objects by using various optimized linear combinations of the pixel fluxes ( optimal subspace filtering ) . </S>"
  ]
}