{
  "article_text": [
    "the most famous variational principle in classical mechanics is _",
    "hamilton s principle _ of stationary action @xcite . according to hamilton s principle",
    ", a system s path in configuration space , @xmath2 , will be a critical point of @xmath3 regarded as a functional of paths in configuration space with fixed endpoints . here",
    ", @xmath4 is the lagrangian function associated with the mechanical system in question .",
    "the closely - related _ hamilton s principle in phase space _",
    "@xcite generalizes hamilton s principle to arbitrary exact symplectic manifolds . specifically ,",
    "if the symplectic manifold @xmath5 with symplectic form @xcite @xmath6 is the phase space of a mechanical system , then the phase space variational principle asserts that a system s path in phase space , @xmath7 , will be a critical point of @xmath8 regarded as a functional of paths in phase space with fixed endpoints . here , @xmath9 is the system s hamiltonian .",
    "this pair of variational principles serves as the variational workhorse of modern treatments of mechanics .",
    "hamilton s principle is often well - suited to the formulation of a problem , as evidenced by its applications in continuum mechanics @xcite , whereas the phase space principle is naturally adapted to perturbation theory , especially in guiding center and gyrokinetic theory @xcite .    in this article",
    ", we will investigate variational discretizations @xcite of _ perturbed _ non - canonical hamiltonian systems on manifolds that obey hamilton s principle in phase space .",
    "these perturbed systems will be specified by a phase space manifold @xmath5 ; a symplectic form on @xmath5 of the form @xmath6 ; and a time - dependent hamiltonian function @xmath10 , where @xmath11 represents an unperturbed system and @xmath0 is a small parameter .",
    "trajectories of this type of system are then given as extremals of the action @xmath12 given in eq.([phase_space ] ) .",
    "a wide variety of mechanical systems fit this mold , including all perturbed canonical hamiltonian systems .",
    "notably , there are perturbed hamiltonian systems for which hamilton s principle in phase space is the only known variational formulation @xcite .",
    "the variational discretizations we will be concerned with are those that exploit the small value of @xmath0 to enhance the accuracy of the discrete euler - lagrange equations ; see refs .",
    "@xcite for generic variational discretizations of hamilton s principle in phase space and refs .",
    "@xcite for specialized methods that can be applied to hamilton s principle in phase space while working in canonical coordinates .",
    "discretizations of hamilton s principle for perturbed systems have been developed already in ref.@xcite .",
    "the discrete euler - lagrange equations associated with these discretizations are capable of recovering previously - discovered symplectic integrators @xcite that exploit the small value of @xmath0 to effectively enhance their order of accuracy .",
    "in particular , these integrators are capable of achieving up to local @xmath13 accuracy ( how to achieve greater accuracy in @xmath0 with this type of integrator is not discussed in ref.@xcite ) . on the other hand",
    ", it seems a method for finding discretizations of hamilton s principle in phase space that exploits the small value of @xmath0 has never been discussed .",
    "one might hope that the technique used in ref.@xcite could be easily extended to treat the phase space variational principle , but this is not the case .",
    "the derivation of the discretizations in ref.@xcite depends on the presence of an exact discrete lagrangian for its success .",
    "because the usual notion of exact discrete lagrangian@xcite only applies to hamilton s principle , this method can not be transcribed to produce a similar method for discretizing hamilton s principle in phase space .",
    "thus , there is currently not a method for developing variational integrators for perturbed guiding center motion , or any other perturbed system whose only known variational formulation is in the form of hamilton s principle in phase space .",
    "the purpose of this article is to formulate the first discretizations of hamilton s principle in phase space that are adapted to perturbed problems .",
    "these discretizations are contained in our eqs.([l_infinity]),([l_0]),([l_1 ] ) , and([l_2 ] ) . amongst them",
    "are discretizations whose time - advance rules are accurate to any desired order in @xmath0 while allowing for @xmath1 time steps . each discretization can be applied to any perturbed non - canonical hamiltonian system whose continuous - time trajectories are extremals of the action @xmath12 in eq.([phase_space ] ) .",
    "our method for deriving these discretizations is based on constructing an exact discrete action for hamilton s principle in phase space , a task that is fundamentally different from constructing an exact discrete action for hamilton s principle .",
    "the method is completely coordinate - independent , and therefore leads to time - advance rules that transform correctly when passing from one coordinate chart on the phase space @xmath5 to another .",
    "this coordinate - independence is achieved by introducing an arbitrary affine connection on @xmath5 .",
    "we demonstrate that by initializing these two - step integration algorithms using the smooth modified system studied in backward error analysis @xcite , the resulting discrete - time trajectories satisfy one - step algorithms that preserve symplectic forms on @xmath5 , which is a sharper result on symplecticity than that provided by the theory developed in ref .",
    "@xcite or ref .",
    "@xcite .",
    "the presentation will be organized as follows .",
    "we specify the scope of our work and precisely define the notion of a discretization of hamilton s principle in phase space in section [ sec : problem_statement ] .",
    "we derive an _",
    "exact _ discretization of hamilton s principle in phase space suitable to perturbed hamiltonian systems in section [ sec : derivation_of_l_infinity ] . using this exact discretization ,",
    "we develop approximate discretizations of hamilton s principle in phase space that can be applied to practical problems in section [ sec : truncations_of_l_infinity ] . in section [ sec : symplecticity ] , we discuss the symplecticity of the integration algorithms provided by our discretizations .",
    "section [ sec : examples ] contains two examples .",
    "we conclude with a discussion in section [ sec : discussion ] .",
    "let @xmath5 be a symplectic manifold with symplectic form @xmath6 .",
    "let @xmath14 be a time - dependent real - valued function on @xmath5 , where @xmath0 is a small parameter .",
    "the time - dependent vector field @xmath15 defined by the formula @xmath16 is known as the time - dependent hamiltonian vector field with hamiltonian @xmath17 @xcite .",
    "fix @xmath18 with @xmath19 .",
    "if @xmath20\\rightarrow m$ ] is an integral curve of @xmath15 , i.e. @xmath21 then @xmath22 is a critical point of the functional @xmath23 , where @xmath24\\rightarrow m\\,|\\,c(t_1)=z_1,\\,c(t_2)=z_2\\}\\end{aligned}\\ ] ] and @xmath25 conversely , if @xmath26 is a critical point of @xmath27 , then @xmath28 must be an integral curve of the hamiltonian vector field @xmath15 .",
    "the latter pair of facts is known as hamilton s principle in phase space @xcite .",
    "note that for many choices of @xmath29 , @xmath27 will not have _ any _ critical points ; a necessary condition for the existence of a critical point is that @xmath30 and @xmath31 can be connected by an integral curve of @xmath15 .",
    "let @xmath32 be a positive @xmath1 constant .",
    "assume @xmath33 and @xmath34 , where @xmath35 . between the continuous - time path space , @xmath36 , and the discrete - time path space with increment @xmath37 , @xmath38\\cap(\\tau\\mathbb{z})\\rightarrow m\\,|\\,\\mathbf{c}(t_1)=z_1,\\,\\mathbf{c}(t_2)=z_2\\},\\end{aligned}\\ ]",
    "] there is a natural projection map @xmath39 , where for each integer @xmath40 @xmath41 our goal is to identify a functional @xmath42 , which we will refer to as the exact discrete action , with three properties .",
    "+   + ( d1 ) if @xmath20\\rightarrow m$ ] is an integral curve of the hamiltonian vector field @xmath15 with @xmath43 and @xmath44 , then @xmath22 must be a critical point of the functional @xmath45 .",
    "+   + ( d2 ) @xmath46 must be of the form @xmath47 where @xmath48 and @xmath49 . +   +",
    "( d3 ) if the exact discrete action is replaced with its @xmath50th order maclaurin polynomial in @xmath0 , @xmath51 then the discrete euler - lagrange equations @xcite associated with @xmath52 should function as a numerical integration algorithm with local @xmath53 accuracy .",
    "remarks on such a functional are in order .",
    "note that the time step of the integration algorithm associated with @xmath52 is @xmath37 , which is not assumed to be small .",
    "the idea at work here is that integral curves of the unperturbed vector field @xmath54 can be used to approximate integral curves of @xmath15 with @xmath55 accuracy on @xmath1 time intervals .",
    "thus , when @xmath56 describes an integrable hamiltonian system , the practical limit on the size of @xmath37 for a fixed value of @xmath0 should be expected to be @xmath57 , where @xmath58 is the perturbation s characteristic bounce time .",
    "also note that because the discrete euler - lagrange equations associated with @xmath52 are given by @xmath59 they provide a _ two - step _",
    "@xcite integration algorithm for a first - order dynamical system on @xmath5 .",
    "thus , the standard theory behind variational integrators @xcite implies that this algorithm preserves a symplectic structure on @xmath60 .",
    "however , the flow of the hamiltonian vector field @xmath15 preserves a symplectic form on @xmath5 . in section [ sec : symplecticity ]",
    "we reconcile these qualitatively different notions of structure preservation using a minor modification of the  smooth modified system \" concept developed in @xcite .",
    "finally , note that by setting @xmath61 , we move into the setting of generic hamiltonian systems on @xmath5 , i.e. those without an _ a priori _ perturbative structure . thus ,",
    "when @xmath61 and @xmath37 is chosen to be small , @xmath46 can be expanded in powers of @xmath37 to yield arbitrarily accurate variational integrators for generic hamiltonian systems .",
    "in order to derive a functional @xmath46 that satisfies properties ( d1)(d3 ) , we will manipulate the functional @xmath27 into the form @xmath45 while making use of the following heuristic approximation principle .",
    "+   + * the path space approximation principle : * modifications to the functional @xmath27 can be made as long as they do not change the first variation of @xmath27 at integral curves of @xmath15 .",
    "+   + the intuitive justification of this principle is that we are mainly interested in critical points of the functional @xmath27 and a critical point of @xmath27 will also be a critical point of @xmath62 provided these two functionals agree ( modulo a constant ) in a neighborhood of the critical point .    as a convenient first step",
    ", we will pass into the  interaction picture \" .",
    "passing into the interaction picture amounts to transforming the path space in such a way that integral curves of the unperturbed vector field @xmath54 become trivially constant curves .",
    "let @xmath63 be the time - dependent flow map of the unperturbed hamiltonian vector field @xmath54 , i.e. the two - parameter family of mappings characterized by the relations @xmath64 then the interaction picture transformation from the old path space to the new path space @xmath65 , with @xmath66 , is given by @xmath67 after performing this change - of - path , the functional @xmath27 is transformed into @xmath68 , which is the pushforward of @xmath27 along the mapping @xmath69 .",
    "given @xmath70 , @xmath71 is readily found to be @xmath72 the constant term does not affect the location of critical points , and so we omit it from this point forward .",
    "also note that , by hamilton s principle in phase space , @xmath73 is a critical point of @xmath74 if and only if @xmath73 is an integral curve of the time - dependent hamiltonian vector field @xmath75 , where @xmath76    next , we decompose the time integral in @xmath74 as @xmath77 where @xmath78 and examine @xmath79 for each @xmath80 .",
    "the goal of this analysis is to devise an approximation for @xmath79 that depends on @xmath73 only through @xmath81 and @xmath82 .",
    "let @xmath83 be the time - dependent flow map of the hamiltonian vector field @xmath75 .",
    "as is readily verified , the identity @xmath84 holds , where @xmath85 and @xmath86 thus , @xmath79 could be determined using only the values of @xmath73 at @xmath87 and @xmath88 were it not for the term @xmath89 .",
    "observe that when @xmath73 is a critical point of @xmath74 , the curve @xmath90 is constant and the integral @xmath89 vanishes .",
    "when @xmath73 is infinitesimally close to a critical point , @xmath89 is given by the first variation of the functional @xmath91 , where @xmath92 to calculate the variation of @xmath93 , we first compute the variation of @xmath94 at a trivial curve @xmath95 , where @xmath96 and @xmath97 $ ] .",
    "the result is readily found to be @xmath98",
    "the chain rule then implies that the first variation of @xmath93 at a critical point of @xmath74 is given by @xmath99 here , @xmath100 denotes the tangent functor as defined in ref.@xcite .",
    "notably , the first variation of @xmath93 at a critical point of @xmath74 is completely determined by @xmath101 and @xmath73 evaluated at @xmath87 and @xmath102 .    guided by these observations and the path space approximation principle , we will now replace the term @xmath89 in @xmath79 with an approximation that can be computed using only the values of @xmath73 at @xmath87 and @xmath88 .",
    "we will choose this approximation so that it agrees with @xmath89 when @xmath73 is a critical point and when @xmath73 is infinitesimally close to a critical point .",
    "let @xmath103 be an arbitrary affine connection on @xmath5 .",
    "it is well - known @xcite that @xmath5 admits an open cover @xmath104 with two properties : ( i ) if @xmath105 , then there is a unique geodesic segment contained in @xmath106 with endpoints @xmath30 and @xmath31 , ( ii ) if @xmath105 and @xmath107 , then the geodesic segment joining @xmath108 in @xmath106 is equal to the geodesic segment joining @xmath108 in @xmath109 .",
    "thus , on the open neighborhood of the diagonal in @xmath60 , @xmath110 , we can define a real - valued function @xmath111 where @xmath112 is the unique directed geodesic segment from @xmath30 to @xmath31 contained in some @xmath106 .",
    "if @xmath113 can not be taken to be all of @xmath60 , assume that @xmath114 has been smoothly extended to all of @xmath60 . in terms of this",
    "possibly - extended @xmath114 our approximation for @xmath89 is @xmath115 where @xmath116 it is readily verified that this approximation is exact when @xmath73 is either a critical point of @xmath74 or infinitesimally close to such a critical point .",
    "when @xmath73 is a critical point , both sides of eq.([fundamental_approximation ] ) obviously vanish .",
    "likewise , regarding each side of eq.([fundamental_approximation ] ) as a functional of @xmath73 , the two sides first variations at a critical point agree . the latter assertion is easy to check using eq.([first_variation ] ) and the fact that when @xmath73 is sufficiently close to a critical point , the right hand - side of eq.([fundamental_approximation ] ) is given by @xmath117    with this approximation in place , we can now easily obtain an expression in the interaction picture for a functional @xmath118 that satisfies ( d1 ) and ( d2 ) . to see this , note that we now have @xmath119 , where @xmath120 thus , eq.([decomp ] ) implies @xmath121 where @xmath122 is given by @xmath123 this says that @xmath124 satisfies ( d2 ) .",
    "also note that , by construction , we have the following equalities when @xmath73 is a critical point of @xmath74 .",
    "@xmath125 therefore , any critical point of @xmath74 is also a critical point of @xmath126 , which says that @xmath124 satisfies ( d1 ) .",
    "in fact @xmath124 satisfies ( d3 ) in addition to ( d1 ) and ( d2 ) .",
    "the proof of this statement is not substantially different than the proof of theorem 2.3.1 in ref.@xcite .",
    "we have therefore succeeded in identifying an exact discrete action @xmath118 .",
    "however , we currently have this action expressed in the interaction picture . to remedy this , we will conclude this section by passing out of the interaction picture .    passing out of the interaction picture",
    "consists of transforming the new path space @xmath127 back into the old path space @xmath36 by applying the mapping @xmath128 . upon performing this change - of - path",
    ", the functional @xmath126 transforms into @xmath129 .",
    "after some tedious , yet straightforward algebraic manipulations , we have found this pullback is given by @xmath130 where @xmath131 and @xmath132 the notation introduced in this expression is defined as follows .",
    "the mapping @xmath133 is the time - dependent flow map of the hamiltonian vector field with time - dependent hamiltonian @xmath134 . in particular , @xmath135 the function @xmath136 is given by @xmath137 finally , @xmath138 the functional @xmath46 is therefore a valid exact discrete action , i.e. it satisfies properties ( d1)(d3 ) .",
    "note that the terms @xmath139 in @xmath140 are gauge contributions in the sense that , when summed over @xmath80 , they only contribute a constant to @xmath46 . therefore they can be omitted from @xmath140 without affecting the location of critical points .",
    "while the discrete euler - lagrange equations associated with @xmath46 are rigorously satisfied by the integral curves of @xmath15 by property ( d1 ) , they generally do not serve as a particularly useful numerical integration algorithm .",
    "this is because calculating @xmath140 is generally very difficult ; the flow maps @xmath141 and @xmath133 must be known in advance .",
    "thus , it is important to have manageable approximations for @xmath46 on hand when developing variational integrators . to this end",
    ", we will now present general expressions for the first few terms in @xmath46 s power series in @xmath0 .",
    "the utility of such expressions follows from property ( d3 ) : if @xmath46 is replaced by its @xmath50th order maclaurin polynomial in @xmath0 , the resulting discrete euler - lagrange equations will function as a two - step numerical integration algorithm with local @xmath53 accuracy .",
    "we will adopt the convention that @xmath52 denotes @xmath46 s @xmath50th order maclaurin polynomial in @xmath0 .",
    "+   + * @xmath142 : * +   + when @xmath142 , the truncated discrete action is given by @xmath143 where @xmath144 recall that the function @xmath114 is defined in eq.([f ] ) . also recall that @xmath145 is a gauge term and can therefore be omitted .",
    "the discrete euler - lagrange equations associated with @xmath146 provide a two - step integration algorithm for @xmath15 with local @xmath55 accuracy .",
    "in particular , @xmath147 serves as an exact discrete action for the unperturbed system @xmath54 .",
    "therefore , @xmath146 can be used to derive variational integrators for _ generic _ non - canonical hamiltonian systems without a perturbative structure as follows . choose @xmath37 to be a small parameter .",
    "then @xmath146 can meaningfully be expanded in a maclaurin series in @xmath37 . from the general theory developed in ref.@xcite",
    ", it follows that if @xmath146 is replaced with its @xmath148th order maclaurin series in @xmath37 , the associated discrete euler - lagrange equations will serve as an @xmath149th order integrator . +   + * @xmath150 : * +   + in order to derive an expression for @xmath151 , it is necessary to make use of the following identity .",
    "let @xmath152 . if @xmath153 is an arbitrary smooth function , then @xmath154 where @xmath155 denotes the lie derivative along the vector field @xmath156 .",
    "provided @xmath157 , this identity can be used to obtain an asymptotic expansion of the quantity @xmath158 in powers of @xmath0 .    applying this identity to eq.([l_infinity ] ) , we obtain @xmath159 where @xmath160 the discrete euler - lagrange equations associated with @xmath161 furnish a variational integrator for @xmath15 with local @xmath13 accuracy . keep in mind that the time step @xmath162 . practically speaking , for a given value of @xmath0 , @xmath37 should be significantly less than the perturbation s characteristic bounce time . if @xmath37 _ is _ chosen to be a small parameter , then these expressions can be expanded in powers of @xmath37 . if this expansion were to be performed and @xmath161 were replaced with its @xmath148th order maclaurin polynomial in @xmath37 , the resulting discrete euler - lagrange equations would yield an integration algorithm with local @xmath163 accuracy .",
    "+   + * @xmath164 : * +   + upon further application of eq.([expansion_identity ] ) , the @xmath164 result is given by @xmath165 where @xmath166 the discrete euler - lagrange equations associated with @xmath167 furnish a variational integrator for @xmath15 with local @xmath168 accuracy .",
    "fix a non - negative integer @xmath50 . in this section",
    "we will discuss the sense in which the numerical integration algorithm associated with @xmath52 is symplectic .",
    "this topic is more subtle than it may first appear because the discrete euler - lagrange equations associated with @xmath169 give a two - step integrator for a first - order dynamical system on @xmath5 .",
    "first we will illustrate the sense in which the integration algorithm associated with @xmath52 is symplectic on @xmath60 by applying the methods of ref.@xcite in a straightforward manner . recall that the discrete euler - lagrange equations associated with @xmath169 are given by @xmath170 thus",
    ", we can define a mapping @xmath171 , where @xmath172 and @xmath173 is defined implicitly by the equation @xmath174 @xmath175 allows us to parameterize the space of solutions of the discrete euler - lagrange equations by @xmath60 .",
    "in particular , it can be used to define a mapping @xmath176 , where @xmath177 is the set of mappings @xmath178\\cap ( \\tau\\mathbb{z})\\rightarrow m$ ] and @xmath179 using this parameterization , we can define the restricted action on @xmath60 , @xmath180 , where @xmath181 the exterior derivative of @xmath182 is readily found to be @xmath183 where @xmath184 and the one - forms @xmath185 are given by @xmath186 likewise , the second exterior derivative of @xmath182 is found to be @xmath187 it is clear from their definitions that the one - forms @xmath188 and @xmath189 differ by an exact differential , @xmath190 therefore we have the conservation law @xmath191 where @xmath192 .",
    "we have thus shown that the time - dependent flow map @xmath193 on @xmath60 associated with @xmath52 preserves a time - dependent symplectic form on @xmath60 .",
    "next we will demonstrate a more refined result on the symplecticity of the integration algorithm associated with @xmath52 .",
    "assume that there exists a time - dependent vector field @xmath194 on @xmath5 whose associated flow map @xmath195 satisfies the discrete euler - lagrange equations _",
    "exactly_. in other words , @xmath195 satisfies the equation @xmath196 for each @xmath40 and @xmath197 . using @xmath195",
    ", we can define a mapping @xmath198 , where @xmath199 the mapping @xmath200 then naturally leads to the introduction of the restricted action on @xmath5 , @xmath201 , where @xmath202 the identity @xmath203 then gives the conservation law @xmath204 where @xmath205 and @xmath206 note that @xmath207 .",
    "thus , we see that the smooth modified system , which is specified by @xmath194 , preserves a time - dependent symplectic form on @xmath5 .",
    "the sense in which this conservation law applies to the two - step integration algorithm specified by @xmath52 is as follows .",
    "the two step algorithm specified by the discrete euler - lagrange equations requires a pair of initial conditions in order to produce a discrete - time trajectory .",
    "if the second initial condition is supplied by flowing along @xmath194 for @xmath37 seconds starting from the first initial condition , then the discrete trajectory produced by solving the discrete euler - lagrange equations will automatically lie along an integral curve of @xmath194 . thus , provided the second initial condition for our two - step method is chosen carefully , the two - step method is equivalent to the one - step method given by the flow map associated with @xmath194 , which we have just shown preserves a time - dependent symplectic form on @xmath5 .",
    "this result is consistent with the discussions found in refs.@xcite that explain the advantages of choosing the second initial condition for a two - step integrator using the smooth modified system .    the question of whether or not the vector field @xmath194 exists seems to be incompletely resolved . using the methods of hairer , who calls @xmath194 the smooth modified system @xcite , an asymptotic series for @xmath194 in powers of @xmath0 can be developed in a straightforward manner",
    "if one assumes the ansatz @xmath208 while , in general , this series diverges , such divergence does not necessarily imply that an @xmath194 with the desired properties fails to exist .",
    "it is possible , for instance , that the series([ansatz ] ) can be resummed in the sense of borel @xcite to give @xmath194 .",
    "note that this existence question is not resolved by the result proved in ref.@xcite .",
    "indeed , two step variational integrators tend to not be absolutely stable and therefore can not be treated with the methods of ref .",
    "@xcite .",
    "regardless of the answer to the existence question , the asymptotic series in eq.([ansatz ] ) can often be computed and then truncated at some order .",
    "while this truncated vector field will not have a flow map that exactly satisfies the discrete euler - lagrange equations , by truncating at a sufficiently high order , it can be made to satisfy the discrete euler - lagrange equations with any desired level of accuracy .",
    "this fact has already been exploited to improve the stability properties of multi - step variational integration methods in @xcite .",
    "it would be interesting to also exploit the same fact to develop energy and symplecticity bounds for the discretizations of hamilton s principle in phase space developed here .",
    "we leave this to future consideration .",
    "note that existing proofs of bounded energy errors for variational integrators only apply to discretizations of hamilton s principle , and not to discretizations of hamilton s principle in phase space ; when the second initial condition supplied to a two - step discretization of hamilton s principle in phase space is not chosen to lie along an integral curve of @xmath194 , there are known examples of poor energy behavior @xcite .",
    "in this section we will illustrate the use of our discretizations of hamilton s principle in phase space to develop variational integrators for a pair of perturbed hamiltonian systems . in order to illustrate that @xmath140 gives discrete euler - lagrange equations that are exactly satisfied by the appropriate continuous - time trajectories",
    ", we will first treat the harmonic oscillator regarded as a perturbed rigid rotor . in this example , @xmath140 is simple to calculate and it is a simple matter to verify that true solutions to the harmonic oscillator differential equation satisfy @xmath140 s discrete euler - lagrange equations .",
    "we will then use the first - order ( in @xmath0 ) approximation for @xmath140 , @xmath161 , to derive a variational integrator for a non - canonical hamiltonian system that describes the nearly - integrable flow of magnetic field lines in a nominally axisymmetric geometry .",
    "this second example is less trivial than the harmonic oscillator in the sense that the field line dynamics are non - linear and @xmath140 is impossible to calculate ; the computation of @xmath161 is already an onerous task to perform without the aid of symbolic manipulation software .",
    "+   + _ example 1 : _ +   + consider the canonical hamiltonian system on @xmath209 specified by the symplectic form @xmath6 , with @xmath210 , and the hamiltonian function @xmath211 .",
    "clearly , this system describes the dynamics of a harmonic oscillator with frequency @xmath212 .",
    "equivalently , we can regard @xmath213 as describing a perturbed rigid rotor , where @xmath214 describes the unperturbed dynamics of the rotor , and @xmath215 describes the perturbation .",
    "this second interpretation allows us to employ our discretizations of hamilton s principle in phase space that are adapted to perturbed problems to develop a variational integrator for this problem .    in order to identify this integrator",
    ", we will calculate @xmath140 explicitly using eq.([l_infinity ] ) .",
    "the ingredients that enter into such a calculation are ( i ) introducing an affine connection on @xmath209 , ( ii ) finding an expression for the function @xmath216 , ( iii ) finding an expression for the unperturbed flow map @xmath141 , ( iv ) finding an expression for for @xmath133 , and ( v ) evaluating the necessary time integrals that appear in the expression for @xmath140 .",
    "we will now go through each of these steps in turn .",
    "\\(i ) we will use the obvious connection on @xmath209 associated with the standard inner product @xmath217 .",
    "relative to this connection and between any pair of points in @xmath218 , there is a unique geodesic segment equal to the convex hull of @xmath219 .",
    "the unique parameterization of this geodesic segment with parameter @xmath220 $ ] and orientation @xmath221 is given by @xmath222    \\(ii ) the connection chosen in the previous step renders the computation of @xmath216 analytically tractable .",
    "indeed , we have @xmath223    ( iii - iv ) the unperturbed flow map @xmath141 is given by @xmath224 determining this flow map is a simple matter because the hamiltonian underlying the unperturbed dynamics is merely @xmath214 .",
    "the flow map of @xmath225 , @xmath226 , is also simple to identify because the dynamics of a simple harmonic oscillator with frequency @xmath212 are very well understood .",
    "indeed , we have @xmath227 on the other hand , the flow map @xmath133 is associated with the time - dependent hamiltonian @xmath228 which is not the hamiltonian for any commonly encountered dynamical system .",
    "nevertheless , it is easy to check that @xmath133 can be expressed in terms of @xmath141 and @xmath226 according to @xmath229 thus , between eqs.([rotor_flow ] ) and ( [ sho_flow ] ) we have identified an explicit expression for @xmath133 ( that we will not display ) .",
    "\\(v ) finally , we can calculate @xmath140 by directly evaluating eq.([l_infinity ] ) .",
    "modulo gauge terms , @xmath140 is given by @xmath230 it is simple to verify the the discrete euler - lagrange equations that follow from this expression for @xmath140 are exactly satisfied by the solution to the harmonic oscillator differential equation .",
    "this is true regardless of how large or small the time step @xmath37 is chosen .    in this case , @xmath140 can technically be expanded in powers of @xmath0 regardless of the value of @xmath37 .",
    "this follows from the fact that the radius of convergence of the maclaurin series of either @xmath231 or @xmath232 is infinite . however , when @xmath233 these series converge much more rapidly than when @xmath234 .",
    "thus , we expect that truncating @xmath140 s maclaurin series in @xmath0 after only a few terms will lead to a reasonably - accurate integrator for this perturbed rigid rotor only when @xmath233 , which is precisely the condition that @xmath37 be much less than the characteristic bounce time @xmath235 .",
    "+   + _ example 2 : _",
    "+   + next , we will summarize the application of the discretizations developed in this work to a non - trivial non - canonical perturbed hamiltonian system .",
    "this system s phase space is @xmath209 equipped with the non - canonical symplectic form @xmath6 , where @xmath236 the hamiltonian , which is time - dependent and periodic , is given by @xmath237 , where @xmath238 this hamiltonian system can be regarded as a model for magnetic field line flow in a nominally axisymmetric geometry with small resonant perturbations @xcite . in this interpretation , the time variable is identified with the toroidal angle , while @xmath239 and @xmath240 are identified with a set of cartesian coordinates in the poloidal plane centered on the unperturbed magnetic axis .",
    "we will demonstrate that the variational integrators for this system given by @xmath146 and @xmath161 have local @xmath55 and @xmath13 accuracy , respectively .",
    "then we will make some qualitative remarks on the ability of the @xmath161 integrator to resolve second- and higher - order islands .",
    "the time step for the @xmath146 and @xmath161 integrators will be set equal to @xmath241 .",
    "thus , these integrators function as the zeroth and first order @xmath242 poincar maps .    in order to find an expression for @xmath161",
    ", a connection must be chosen ; @xmath216 must be calculated ; and the unperturbed flow map must be found . with knowledge of these quantities ,",
    "eq.([l_1 ] ) can be evaluated directly to find the desired expression .",
    "as in the previous example , we adopt the natural flat connection on @xmath209 .",
    "relative to this connection , the function @xmath216 is given by @xmath243 finally , the flow map of the dynamical system defined by the hamiltonian function @xmath9 is given by @xmath244 we will not display the result of using these quantities to calculate @xmath161 because the resulting expression has many terms , but we must emphasize that this tedious calculation is readily performed using a symbolic manipulation tool such as _ mathematica_. the laborious task of differentiating such a complicated discrete lagrangian can be handled by either computing the needed derivatives symbolically before running a simulation or by employing an automatic differentiation tool such as adolc@xcite at runtime . by employing automatic differentiation tools , implementation and testing of lengthy expressions appearing in the discrete euler - lagrange equations and nonlinear solve can be avoided . on the other hand ,",
    "precomputing derivatives may lead to shorter run times .",
    "figure[fig : two_rmps_poincare ] shows the results of using the discrete euler - lagrange equations associated with @xmath161 to generate the @xmath242 poincar section for the dynamical system specified by @xmath17 .",
    "notably , the @xmath161-integrator reproduced the first - order islands very well .",
    "this can be checked upon noting that the unperturbed frequency as a function of the distance @xmath245 from the origin in @xmath209 is given by @xmath246 ; first - order perturbation theory predicts an island chain at @xmath247 and another at @xmath248 . on the other hand , as the highlighted portion of the figure indicates ,",
    "higher - order island chains were not captured correctly by @xmath161 .",
    "this shortcoming is to be expected in light of the fact that the flow map associated with @xmath17 only satisfies the discrete euler - lagrange equations associated with @xmath161 up to terms second - order in @xmath0 .",
    "incoherent \" fine - scale structure present in the @xmath161 integration came as a result of the onset of parasitic modes that generally plague multistep integration methods @xcite .",
    "the same parasitic modes completely destabilized the @xmath161 integration run shown in figure[fig : two_rmps_poincare ] after several tens of thousands of iterations .",
    "smaller values of epsilon can perform larger numbers of iterations before being overtaken by parasitic modes .",
    "figure [ fig : two_rmps_convergence ] illustrates the @xmath55 and @xmath13 errors of the integrators provided by @xmath146 and @xmath161 , respectively .",
    "the @xmath161 integrator decreases in error quadratically with @xmath0 until reaching the error tolerance of the nonlinear newton - rhapson solver of @xmath249 .",
    "decreasing @xmath0 beyond @xmath250 therefore shows no further improvement in the error of @xmath161 .",
    "( a ) the @xmath242 poincar section for @xmath17 calculated using a runge - kutta integrator with very fine temporal resolution .",
    "( b ) the same poincar section computed using the discrete euler - lagrange equations associated with @xmath161 . in each case ,",
    "@xmath251 and the variables @xmath245 and @xmath252 denote the standard polar coordinates on @xmath209 .",
    "the large first - order islands are reproduced well by the @xmath161-integrator , while , as the highlighted portions of the figures indicate , higher - order islands are not properly reproduced @xcite . ]",
    " error \" denotes the distance between the predictions of a well - converged @xmath241-second runge - kutta integration and a single iteration of the @xmath146 or @xmath161 integrator .",
    "each integration method was initialized with the same initial condition . ]",
    "in the preceding sections , we presented and applied the first discretizations of hamilton s principle in phase space that are adapted to perturbed noncanonical hamiltonian systems .",
    "notably , these discretizations function as variational integrators with @xmath1 time steps and local @xmath253 accuracy , where @xmath254 is any desired nonnegative integer .",
    "moreover , for each discretization , our expression for the associated discrete lagrangian is manifestly coordinate independent .",
    "this coordinate independence has been achieved by introducing an arbitrary affine connection on the phase space .",
    "thus , our discretizations may prove to be useful for constructing variational integrators on manifolds .",
    "we have also shown that if these two - step integrators are initialized using the smooth modified system studied in backward error analysis , then they function as one - step algorithms that preserve symplectic forms on the phase space @xmath5 .",
    "we expect that this result will play an important role in the backward error analysis of the variational discretizations developed here .",
    "for instance , using the fact that the smooth modified system preserves a symplectic form on @xmath5 , it should be possible to show that the method for choosing the second initial condition for two - step methods championed in @xcite leads to better energy behavior than a more conventional runge - kutta - based initialization .",
    "while the integrators identified here formally apply to any perturbed non - canonical hamiltonian system , they are _ much easier _ to apply to nearly - integrable systems because the unperturbed flow map can often be determined analytically in these cases .",
    "when the unperturbed flow map is analytically unattainable , it would have to be determined numerically .",
    "this would entail devising some numerical scheme for evaluating ( at least in an approximate sense ) the various integrations along unperturbed orbits that appear in the discrete lagrangians presented in section [ sec : truncations_of_l_infinity ] .",
    "whether or not such a scheme exists that does not involve prohibitively large computational overhead is currently unknown to us .",
    "we leave investigating this issue to future work .",
    "a theoretical application of the integrators developed here that we will pursue in the future is _ coarse - graining _",
    "hamilton s principle in phase space .",
    "specifically , we would like to derive the stochastic action mentioned in ref.@xcite by directly manipulating hamilton s principle in phase space .",
    "our hope is that this result will follow by appropriately rescaling time and then looking at the behavior of @xmath255 ( eq . ( [ s_2 ] ) ) as @xmath256 .",
    "the authors would like to express their gratitude to a. i. zhmoginov for his help in editing this manuscript .",
    "this work was supported by the u.s .",
    "department of energy under contract de - ac02 - 09ch11466 .",
    "32 natexlab#1#1[1]`#1 ` [ 2]#2 [ 1]#1 [ 1]http://dx.doi.org/#1 [ ] [ 1]pmid:#1 [ ] [ 2]#2 , , , , .",
    ", , , . , , , ams chelsea publishing , , .",
    ", , , , ( ) . , , , ( ) .",
    ", , , ( ) . , , , ( ) .",
    ", , , ( ) . , , , , ( ) .",
    ", , , ( ) . , , , , , , ( ) . , , , ( ) .",
    ", , , ( ) . , , ( ) .",
    ", , , ( ) . , , , ( ) .",
    ", , , , , . , , , , , , .",
    ", , encyclopaedia of mathematical sciences , , . http://books.google.com/books?id=1kyuimxf8u0c .",
    ", , ( ) . , , ( ) .",
    ", , , , ( ) . , , , ( ) .",
    ", , , ( ) .",
    ", , , , ( ) ."
  ],
  "abstract_text": [
    "<S> finite - dimensional non - canonical hamiltonian systems arise naturally from hamilton s principle in phase space . </S>",
    "<S> we present a method for deriving variational integrators that can be applied to perturbed non - canonical hamiltonian systems on manifolds based on discretizing this phase - space variational principle . </S>",
    "<S> relative to the perturbation parameter @xmath0 , this type of integrator can take @xmath1 time steps with arbitrary accuracy in @xmath0 by leveraging the unperturbed dynamics . </S>",
    "<S> moreover , these integrators are coordinate independent in the sense that their time - advance rules transform correctly when passing from one phase space coordinate system to another .    </S>",
    "<S> variational integrators , geometric mechanics , perturbation theory </S>"
  ]
}