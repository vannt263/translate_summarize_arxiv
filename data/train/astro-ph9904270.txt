{
  "article_text": [
    "in order to test models for structure formation in the universe it is necessary to pinpoint galaxies within the modelled large - scale distribution of matter . as this distribution evolves in a non - linear fashion , the use of n - body methods is usually required .",
    "galaxies should form , under the influence of gravity , within an n - body simulation in a self - consistent way . however , such simulations suffer from a numerical problem : small groups of particles that represent galaxies get disrupted by numerical two - body effects within clusters ( carlberg 1994 ; van kampen 1995 ) .",
    "this can be solved by replacing each group of particles by a single ` galaxy particle ' just after they have formed into a virialised system that resembles a galactic halo , thus ensuring their survival .",
    "this should also produce galaxies at the right time and the right place , with a spectrum of masses . in van",
    "kampen ( 1995 ) such galaxy particles were only formed at a single epoch . here",
    "we extend this scheme to ` continuous ' galaxy formation by applying the algorithm several times during the evolution .",
    "this means that merging of already - formed galaxies is taken into account as well , although only in a schematic fashion .",
    "an important advantage of having a galaxy formation algorithm added to the n - body integrator is that the time normalisation is now intrinsically fixed , since one can _ directly _ compare the properties of the distribution of simulated galaxies to those of the observed galaxy distribution .",
    "for the identification of galaxies during the evolution of the large - scale matter distribution we use the _ local density percolation _ algorithm ( see also van kampen 1995 ) . instead of a fixed linking length , we modulate the linking length according to the _ local density_around each particle in such a way that the linking length is shorter in high - density environments .",
    "this partly resolves the cloud - in - cloud problem .",
    "we form ( and merge ) galaxies several times during the evolution , so we have to consider percolation of _ unequal _  mass particles . in the following @xmath0 and @xmath1",
    "are _ comoving _ variables .      in the local density percolation scheme particles",
    "are linked together if they are separated by a certain fixed fraction @xmath2 of the poissonian average nearest neighbour distance @xmath3^{-1/3}$ ] , where @xmath4 is the mean number density of particles , modulated by the local number density @xmath5 , which is @xmath6 gaussian smoothed at the scale @xmath7 .",
    "thus , @xmath2 and @xmath8 are the ( dimensionless ) free parameters of the algorithm .",
    "all models in this paper have @xmath9mpc@xmath10 , so @xmath11mpc . for unequal mass particles we need an extra modulation according to their masses .",
    "initially , all particles have mass @xmath12 .",
    "as galaxies form , particles arise with masses @xmath13 that are integer multiples of @xmath12 .",
    "galaxy particles with mass @xmath13 that are put @xmath14 times further away will exert the same gravitational force as dark particles with mass @xmath12 .",
    "so we should take the factor @xmath14 as the second modulation factor .",
    "this gives a local percolation length @xmath15^{-{1/3}}\\     .\\eqno(1)\\ ] ] since each particle has its own linking length , we use their mean to test pairs of particles .",
    "furthermore , to prevent excessive percolation lengths , we adopt an absolute maximum of @xmath16 for the pair linking lengths ( after taking the mean of the individual ones ) , i.e.  a lower limit for the local particle density which is equal to eight times the background particle density .",
    "in addition , we require pairs to have a relative pairwise velocity @xmath17 of less then 800 km s@xmath18 .",
    "this is twice the relative pairwise velocity dispersion at separations around @xmath19 for the field , and somewhat smaller than found for a sample including the coma cluster ( mo , jing & brner 1993 ) .",
    "it is also twice the maximum internal velocity dispersion we allow for a group .",
    "we include this velocity linking length to exclude fast - moving particles which are geometrically linked to a group .",
    "this often occurs within the potential wells of galaxy clusters .",
    "one should see this criterion as the velocity equivalent of a ( constant ) spatial linking length , so that we actually find groups in phase - space . however , the velocity linking length is less restrictive than the spatial linking length since it serves a different purpose , as said .",
    "a group of particles should only be transformed into a single , soft galaxy particle if it forms a physical system roughly in virial equilibrium .",
    "this ` virial criterion ' is a necessary addition to the local density percolation algorithm for the purpose of defining galaxies .",
    "we will use a virial equilibrium criterion in a simplified form using the half - mass radius @xmath20 , motivated by spitzer ( 1969 ) who found that for many equilibrium systems the virial equilibrium equation can be written as ( where @xmath21 is now the proper velocity ) @xmath22 if galaxies are identified only once , one has to deal with equal mass particles , and @xmath20 can simply be calculated by obtaining the median of the distances of all particles with respect to the centre of the group being tested . for groups",
    "where the masses of the member particles can differ a few orders of magnitude , the half - mass radius will often exactly coincide with a galaxy particle .",
    "this makes the median ( i.e.  the half - mass radius ) a rather noisy estimater for the total gravitational energy of a group of unequal mass particles .",
    "because for many probability distributions the mean and the median are almost identical , we use the mass - weighted mean distance from the centre of the group as an estimator for @xmath20 .",
    "this is a more smoothly - defined and well - behaved quantity than the median distance .",
    "the new galaxy particle has a softening parameter corresponding to the @xmath23 of the original group , which certifies a reasonable conservation of energy ( see van kampen 1995 ) .",
    "discreteness noise will cause some scatter in the group quantities , so we should allow for some tolerance in the difference between the estimated virial mass and the true mass of the group .",
    "the allowed tolerance determines the ` reach ' the criterion has in time : larger permitted deviations from virial equilibrium result in the acceptance of groups that are still collapsing .",
    "we accept groups as real when the virial mass is within 25 per cent of the true mass .      for the ( dimensionless ) local density percolation parameters we choose @xmath24 and @xmath25 .",
    "the maximum percolation length is @xmath16 , which is @xmath26mpc for our simulations .",
    "we set the upper mass limit for galaxy particles to be @xmath27 m@xmath28 .",
    "this ensures that possible cd galaxies are _ not",
    "_  modelled by single galaxy particles , since that would produce undesirable numerical problems , and galaxies that massive are not ( numerically ) disrupted anyway .",
    "we add an extra limit on the internal galaxy velocity dispersion of @xmath29 km s@xmath18 , the maximum value found for typical ellipticals ( de zeeuw & franx 1991 ) and comfortably within the velocity dispersion of haloes around spirals given their typical circular velocities of 200 - 300 km s@xmath18 .",
    "finally , we need to adopt a lower limit of seven particles in a group because of discreteness noise that causes an artificially large scatter in the virial mass estimate .",
    "we have run eight simulations of average patches of universe , and 99 cluster models .",
    "this latter set forms a catalogue of galaxy clusters , and is discussed extensively in van kampen & katgert ( 1997 ) .",
    "the actual n - body code we use is the barnes & hut ( 1986 ) treecode , slightly adapted for our purposes and supplemented with the galaxy formation algorithm .",
    "we ran the models up to @xmath30 , which is sufficiently beyond the time that is expected to be the present epoch for the @xmath31 cdm scenario adopted : @xmath32 was found to be significantly smaller than unity in most earlier work ( e.g.  davis et al .",
    "1985 ; frenk et al .  1990 ; bertschinger & gelb 1991 ) . from a comparison of the galaxy - galaxy autocorrelation function obtained for the field models to that observed ,",
    "we find @xmath32 to be in the range 0.46 to 0.56 ( van kampen 1997 ) , while a similar comparison of the statistical properties of clusters gives roughly the same range ( van kampen & katgert 1997 ) .",
    "as a first check how our modelling of the formation and merging of galaxies compares to other techniques , notably hydrodynamical simulations , we look at the galaxy formation and merger number density rates as a function of time .",
    "these are plotted in figure  [ fig-1 ] for @xmath33 , where @xmath34 is the present epoch .",
    "the formation rate peaks at @xmath35 , whereas the merger rate does not show a clear peak .",
    "the merging of small objects into galaxies with masses that are included in the formation rate is not included in the merger rate .",
    "the shapes and amplitudes of both rates compare remarkably well with those found from hydrodynamical simulations performed by summers ( 1993 ) , also shown in figure  [ fig-1 ] , if we triple his time - scale .",
    "this can be justified quantitatively as follows : summers ( ibid . ) has a higher mass resolution and forms galaxies down to a lower mass cut - off .",
    "the smallest galaxy masses in his simulations are roughly a hundred times smaller than our lowest mass galaxies .",
    "the cdm spectrum on galactic scales is a power - law with index -2 .",
    "we can then use the scaling law @xmath36 which applies for such a spectrum to find that this mass difference gives a factor of three difference in the formation time .",
    "summers ( ibid . ) used a full - fledged hydro code ( and identified galaxies with the ordinary friends - of - friends algorithm ) .",
    "the fact that we find similar shapes and amplitudes for the rates means that the use of a galaxy formation recipe with an ordinary collisionless n - body code can give comparible results to more advanced simulation techniques that incorporate more ( but certainly not all ) physical processes .      for our cluster simulations",
    ", we study the luminosity function within the projected abell radius . since we know",
    "only the masses of the galaxies we need to assume a constant mass - to - light ratio @xmath37 to obtain a luminosity function . for the @xmath38 magnitude , @xmath39 for an @xmath31 universe . because on average 25 per cent of the mass is locked into our galaxies ( including dark haloes ) , @xmath40 for the galaxies .",
    "the joint luminosity function for our cluster models is plotted in figure  [ fig-2 ] for all galaxies ( all symbols ) , and for the @xmath41 m@xmath28 ones ( filled symbols only ) , along with a fitted schechter ( 1976 ) luminosity function for each of them ( dashed line for all galaxies , solid line for the limited set ) , with slope @xmath42 and characteristic magnitude @xmath43 as free parameters .",
    "the fit for all galaxies is quite good but not perfect : @xmath44 .",
    "we find that the fit gets better for the limited set of massive galaxies : @xmath45 .",
    "this means that we either do not model low - mass galaxies very well , or that the mass - to - light ratio is not constant .",
    "the first option is probably true anyway since we can not model merging of galaxies with masses below our lower limit towards the low - mass end of the mass function that we try to fit .    with this in mind",
    "it is fair to say that the schechter function does fit rather well for the limited set .",
    "we find @xmath46 for this set , which corresponds remarkably well with the value that colless ( 1989 ) found for a sample of 14 observed clusters .",
    "it compares less well with @xmath47 found by vink & katgert ( 1994 ) for a sample of 80 clusters , corresponding to @xmath48 .",
    "still we can say that the modelling performes reasonably well given the uncertainties in both the fits and the assumption of a constant mass - to - light ratio .",
    "joshua barnes and piet hut are gratefully acknowledged for allowing use of their treecode , edmund bertschinger and rien van de weygaert for their code to generate initial conditions , and eric deul for allowing me to use the computer systems that are part of the denis project .",
    "i acknowledge eelcosoft software services for partial financial support during the early stages of the project , and an european community research rellowship as part of the hcm programme during its final stages .",
    "barnes j.e . , hut p. , 1986 ,",
    "nat , 324 , 446 bertschinger e. , gelb , j.m .",
    ", 1991 , computers in physics , 5 , 164 carlberg r.g . , 1994 , apj , 433 , 468 colless m. , 1990 , mnras , 237 , 799 davis m. , efstathiou g. , frenk c.s .",
    ", white s.d.m .",
    ", 1985 , apj , 292 , 371 de zeeuw p.t . , franx m. , 1991 , araa , 29 , 239 frenk c.s .",
    ", white s.d.m . , efstathiou g. , davis , m. , 1990 , apj , 351 , 10 mo h.j . , jing y.p . ,",
    "brner g. , 1993 , mnras , 264 , 825 schechter p.l . , 1976 ,",
    "apj , 203 , 297 spitzer jr .",
    "l. , 1969 , apj , 158 , l139 summers f.j .",
    ", 1993 , ph.d .",
    "thesis , university of california at berkeley van kampen e. , 1995 , mnras , 273 , 295 van kampen e. , 1997 , submitted to mnras van kampen e. , katgert p. , 1997 ,",
    "mnras , in press vink j. , katgert p. , 1994"
  ],
  "abstract_text": [
    "<S> we present a method of including galaxy formation in dissipationless n - body simulations . </S>",
    "<S> galaxies that form during the evolution are identified at several epochs and replaced by single massive soft particles . </S>",
    "<S> this allows one to produce two - component models containing galaxies and a background dark matter distribution . </S>",
    "<S> we applied this technique to obtain two sets of models : one for field galaxies and one for galaxy clusters . </S>",
    "<S> we tested the method for the standard cdm scenario for structure formation in the universe . </S>",
    "<S> a direct comparison of the simulated galaxy distribution to the observed one sets the amplitude of the initial density fluctuation spectrum , and thus the present time in the simulations . </S>",
    "<S> the rates of formation and merging compare very well to simulations that include hydrodynamics , and are compatible with observations . </S>",
    "<S> we also discuss the cluster luminosity function . </S>"
  ]
}