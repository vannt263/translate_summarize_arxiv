{
  "article_text": [
    "removal of the smallest eigenvalues of a matrix can significantly improve the performance of iterative methods .",
    "this is important for lattice qcd where stochastic methods for disconnected diagrams and new matter formulations such as overlap fermions are computationally intensive .",
    "in addition , there is often a need for these systems to be shifted to take account of multiple quark masses or other parameters .",
    "we think that it is important for any iterative method we develop to be applicable to general non - hermitian systems , for this is often the case for lattice systems .",
    "gmres  @xcite is an iterative method that can be used in lattice studies with stochastic noise methods .",
    "convergence can be improved by deflating eigenvalues .",
    "two years ago it was shown that deflating eigenvalues  @xcite can be especially helpful for lattice problems with multiple right - hand sides  @xcite . here",
    "we report on generalizations of these techniques .",
    "first we show how deflated restarted gmres can accomodate multiple shifts .",
    "we give numerical results for a wilson matrix with very small eigenvalues .",
    "we then consider the case of combining multiple shifts with multiple right - hand sides . finally we also discuss and give numerical results on the possibility of combining deflated gmres for the first system with a bicgstab algorithm which uses those deflated eigenvalues for the subsequent solutions .",
    "the shifted systems are expressed by @xmath1 where the s(i ) are the numerical shifts . the method proposed in @xcite",
    "is based upon keeping the residual vectors for the shifted systems parallel to one another .",
    "that is , one uses only a single krylov subspace to solve all the systems .",
    "this is possible for gmres only by forcing the residuals to be parallel to one another after a restart and thus the minimum residual condition is applied to only the unshifted ( most difficult ) system .",
    "we find that this also results in an almost optimal solution for the shifted systems .",
    "= 2.9 in -.1 cm    -.5 cm    our method for deflating gmres ( called gmres - dr  @xcite ) simulataneously solves linear equations and computes eigenvalues .",
    "this is possible because it has a krylov subspace for solving the linear equations as well as krylov subspaces designed for solving the eigenvalue equation .",
    "these approximate eigenvectors are refined and improved as the gmres - dr cycles proceed . we have determined that gmres - dr can be efficiently applied to multiply shifted systems because of its krylov properties .",
    "fig.1 shows the result of a shifted run of gmres - dr(50,30 ) , i.e. , the subspace is 50-dimensional and includes 30 approximate eigenvectors .",
    "it is compared to the residual norm for regular gmres(50 ) .",
    "one can see the deflation start to take place around 200 matrix - vector products ( the approximate eigenvectors are accurate enough by then ) .",
    "typically , many right - hand sides are used to do stochastic estimates of matrix elements .",
    "it would be beneficial if the deflated eigenvalues and eigenvectors calculated for the first right - hand side could be reused .",
    "then deflation could begin from the start instead of having to wait for the required eigenvectors to be recalculated , with more dramatic results than in fig.1 .",
    "a method to accomplish this called gmres - proj was given in  @xcite .",
    "gmres - proj alternates cycles of gmres with projections over the approximate eigenvectors .",
    "next we consider using this for the case of multiple shifts for each of the multiple right - hand sides .    gmres - dr can deflate eigenvalues and handle multiple shifts at the same time for the first right - hand side ( the right - hand sides for each shifted system can be kept parallel ) .",
    "however , for the second and subsequent right - hand sides there is no way to deflate eigenvalues by projecting over the previously computed approximate eigenvectors and still keep the right - hand sides for the different shifted systems parallel .",
    "if the eigenvectors were exact , this would be possible .",
    "so one approach is to use only fairly accurate approximate eigenvectors and do a correcting iteration at the end for each shifted system separately .",
    "we now propose a better fix for this problem which does not require accurate eigenvectors . gmres - dr produces approximate eigenvectors that are represented in the form of an arnoldi - like recurrence relation : @xmath2 where the columns of @xmath3 span the space of approximate eigenvectors , @xmath4 has one extra column added to @xmath3 , and @xmath5 is a @xmath6 by @xmath7 matrix . using this",
    ", we can perform the projection over the approximate eigenvectors so that the right - hand sides for the different shifted systems are all multiples of each other , except for error in the direction of @xmath8 , the last column of @xmath4 .",
    "this error can be easily corrected at the end , if we are willing to solve one additional right - hand side , namely @xmath8 .",
    "there is also potential to develop a deflated version of bicgstab for multiply shifted systems using this idea .",
    "this will be reported later , but for now we will look at deflating bicgstab for multiple right - hand sides in the non - shifted case .",
    "the deflation on the additional right - hand sides can employ other methods after the initial eigenvalue generation by gmres - dr .",
    "we have looked at bicgstab , a non restarted method popular in the lattice community , in this context .",
    "we again combine a projection over approximate eigenvectors with the iterative method .",
    "however , the projection can only be performed once before the bicgstab iteration begins .",
    "therefore this projection must reduce the critical eigencomponents to a low enough level that no further reduction is needed during the bicgstab iteration .",
    "the minimal residual projection is the best possible one in the sense that it minimizes the norm of the residual vector .",
    "however , it can be shown that even if one knows the exact eigenvectors , the corresponding component in the residual vector will not generally be zeroed out ( unless the matrix is hermitian ) . to deal with this problem , we will give a projection that is better for this task .",
    "it uses both left and right approximate eigenvectors .",
    "left - right projection for deflating eigenvectors :    \\1 .",
    "let the current approximate solution be @xmath9 and the current system of equations be @xmath10 .",
    "let @xmath11 be orthonormal with columns spanning the subspace of approximate right eigenvectors .",
    "let @xmath12 similarly be orthonormal with columns from approximate left eigenvectors .",
    "solve @xmath13 , where @xmath14 .",
    "the new approximate solution is @xmath15 .",
    "this projection can reduce the small eigenvector components better than minimum residual and in the case of exact left and right eigenvectors , the components can be zeroed out . of course , it is necessary to compute left eigenvectors .",
    "however , for many lattice problems , including the wilson - dirac matrix , there is a simple relationship between the left and right eigenvectors .",
    "= 2.9 in -.1 cm    -.5 cm    fig.2 above shows a run on a smaller @xmath16 lattice ( using matlab ) of the deflated bicgstab algorithm using eigenvectors calculated from an initial gmres - dr solution of the first right - hand side .",
    "the deflated solutions take a smaller number of iterations than the nondeflated implementation .",
    "notice that deflation does not care about the nature of the right - hand sides used , so these may be noise vectors or units vectors , as one desires .",
    "this applies to all techniques used .",
    "this material is based upon work supported by the national science foundation under grants no .",
    "0070836 ( theoretical physics ) and 0310573 ( computational mathematics ) and ncsa and utilized the sgi origin 2000 system at the university of illinois .",
    "rm acknowledges the baylor university summer sabbatical program .",
    "y. saad and m. h. schultz , gmres : a generalized minimum residual algorithm for solving nonsymmetric linear systems `` , siam j. sci .",
    "comput . 7 , 856 ( 1986 ) .",
    "r. b. morgan , gmres with deflated restarting '' , siam j. sci . comput .",
    "24 , 20 ( 2002 ) .",
    "r. b. morgan and w. wilcox , nuclear physics b ( proc .",
    "suppl . ) 106 , 1067 ( 2002 ) .",
    "a. frommer , restarted gmres for shifted linear systems \" , siam j. sci . comput .",
    "53 , 15 ( 1998 ) ."
  ],
  "abstract_text": [
    "<S> work on generalizing the deflated , restarted gmres algorithm , useful in lattice studies using stochastic noise methods , is reported . </S>",
    "<S> we first show how the multi - mass extension of deflated gmres can be implemented . </S>",
    "<S> we then give a deflated gmres method that can be used on multiple right - hand sides of @xmath0 in an efficient manner . </S>",
    "<S> we also discuss and give numerical results on the possibilty of combining deflated gmres for the first right hand side with a deflated bicgstab algorithm for the subsequent right hand sides . </S>"
  ]
}