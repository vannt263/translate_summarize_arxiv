{
  "article_text": [
    "* sample and setup . *",
    "we use a naturally occurring nitrogen - vacancy ( nv ) in high - purity type iia chemical - vapour - deposition ( cvd ) grown diamond with a @xmath12 natural abundance of @xmath10c and a @xmath50 crystal orientation ( element six ) . to enhance the collection efficiency",
    "a solid - immersion lens was fabricated on top of the nv centre [ 17,37 ] ( fig .",
    "1b ) and a single - layer aluminium - oxide anti - reflection coating was deposited [ 34,38 ] .",
    "the sample temperature is @xmath51 k and a magnetic field of 403.553(3 ) g is applied along the nv symmetry axis .",
    "the ancilla nv electron spin is characterized by a rabi frequency of 4.3 mhz , a dephasing time @xmath17=4.6(2 ) @xmath19s , a hahn echo time @xmath52 ms and a longitudinal relaxation time of 0.43(6 ) s ( due to microwave noise and laser background ) .",
    "the coherence time of the ancilla under dynamical decoupling exceeds 25 ms and does not limit the experiments ( supplementary fig .",
    "1 ) . we initialize and readout the ancilla through resonant excitation of the zero - phonon transitions of the nv centre ( supplementary fig .",
    "2 ) . prior to every experiment",
    "the @xmath53n nuclear spin is initialized by measurement with a fidelity of @xmath54 = 0.94(3 ) in @xmath55 [ 17 ] .",
    "no external electric fields are applied : the gates in fig .",
    "1b are grounded .",
    "* nuclear spin qubit control .",
    "* the hyperfine interactions for the three nuclear spins are estimated by dynamical decoupling spectroscopy [ 9 ] ( supplementary table 1 ) .",
    "building on previous gate designs [ 9 ] , nuclear gates are realized by applying sequences of @xmath56-pulses on the electron spin of the form @xmath57 . the number of pulses @xmath58 sets the rotation angle .",
    "the inter - pulse delay @xmath59 determines which qubit is controlled and whether the rotation is conditional on the ancilla state .",
    "in contrast to previous work [ 9 ] we allow the gates to be detuned , providing greater flexibility to optimize @xmath60 and @xmath58 for gate selectivity and minimal discretization errors .",
    "the gate parameters are listed in supplementary table 1 and 2 .",
    "the nuclear spins are initialized by swapping with the ancilla electron spin ( supplementary fig .",
    "3 ) and are read out by mapping the required correlation to the ancilla before reading it out ( supplementary fig .",
    "4 ) . to obtain best estimates for the actual states ,",
    "the results are corrected for the fidelity of the gates used in the final readout ( tomography ) ( details in supplementary note 3 ) .",
    "uncorrected data is shown in supplementary fig .",
    ".    * feedback . *",
    "real - time feedback is implemented through a programmable microprocessor ( adwin pro ii ) that controls the experimental sequence ( supplementary fig . 5 ) .",
    "we exploit feedback in four different ways .",
    "first , detected phase errors are corrected directly after the stabilizer measurements .",
    "note that analysing errors over multiple rounds [ 14 ] would additionally enable real - time correction of ancilla readout errors , but that this is not implemented here .",
    "second , dependent on the ancilla measurement outcome the qubits pick up a deterministic phase shift due to the hyperfine interaction , which is corrected in the same way .",
    "third , for an odd number of + 1 outcomes the operations in the stabilizer measurements imprint a bit flip on the logical qubit , which we correct by transforming the logical qubit basis in real time .",
    "fourth , to start each measurement sequence with the ancilla in @xmath18 it is flipped back to @xmath18 when the previous measurement returned @xmath22 .",
    "importantly , we perform real - time feedback either by adapting the qubit bases for all subsequent gates and measurements ( for correcting @xmath9 errors and for the logical qubit ) or by absorbing the feedback operations into the next gate acting on the same qubit ( for the ancilla ) . therefore the physical control sequence is directly adapted based on the measurement outcomes without introducing unnecessary gate operations that would cause additional errors . in the circuit diagrams we sometimes display the gates for the feedback separately for clarity .",
    "* quantum error correction analysis . *",
    "the process fidelity with the identity is given by @xmath61 , with @xmath62 the six fidelities of the final states @xmath63 with the ideal states @xmath64 . the results of fig",
    ". 3 are analysed by fitting to @xmath65 , with @xmath66 and @xmath67 .",
    "@xmath68 and @xmath69 account for the experimental fidelities ( supplementary note 1 ) .",
    "the state fidelities for multiple rounds of error correction and incoherent errors ( fig .",
    "4b ) are fitted to the same equation using @xmath70 , with @xmath44 the number of rounds , @xmath71{1 - 2p_e}$ ] the error per round , and @xmath72 .",
    "the error per round @xmath73 is obtained as follows .",
    "an error process with total error probability ( @xmath33 ) reduces the expectation value by a factor of @xmath74 . for incoherent errors",
    ", a process can be divided in @xmath44 equal rounds using @xmath75 , which results in @xmath76{1 - 2p_e})/2 $ ] ( for @xmath77 ) . in fig . 3c and fig .",
    "4b , @xmath68 depends on the error - probability @xmath33 , because we optimize the effective readout fidelity by associating the most likely error syndrome to the best ancilla readout ( supplementary note 1 ) .",
    "see supplementary information for further details on all theoretical analysis , including the error syndrome probabilities and numerical simulations of fig . 4d .",
    "[ 1 ] b. m. terhal , quantum error correction for quantum memories . _",
    "phys . _ * 87 * , 307 ( 2015 ) .",
    "[ 2 ] s. b. bravyi and a. yu .",
    "kitaev , quantum codes on a lattice with boundary .",
    "arxiv : 9811.052 ( 1998 ) .",
    "[ 3 ] r. raussendorf , j. harrington , fault - tolerant quantum computation with high threshold in two dimensions . _",
    "lett . _ * 98 * , 190504 ( 2007 ) .",
    "[ 4 ] d. nigg _ et al . _ ,",
    "quantum computations on a topologically encoded qubit .",
    "_ science _ * 345 * , 302 - 305 ( 2014 ) .",
    "[ 5 ] e. knill , r. laflamme , r. martinez , c. negrevergne , benchmarking quantum computers : the five - qubit error correcting code . _",
    "lett . _ * 86 * , 5811 - 5814 ( 2001 ) .",
    "[ 6 ] j. chiaverini _ et al .",
    "_ , realization of quantum error correction .",
    "_ nature _ * 432 * , 602 - 605 ( 2004 ) .",
    "[ 7 ] p. schindler _ et al .",
    "_ , experimental repetitive quantum error correction .",
    "_ science _ * 332 * , 1059 - 1061 ( 2011 ) .",
    "[ 8 ] m. d. reed _",
    "et al . _ , realization of three - qubit quantum error correction with superconducting circuits .",
    "_ nature _ * 482 * , 382 - 385 ( 2012 ) .",
    "[ 9 ] t. h. taminiau , j. cramer , t. van der sar , v. v. dobrovitski , r. hanson , universal control and error correction in multi - qubit spin registers in diamond .",
    "_ nature nanotech . _",
    "* 9 * , 171 - 176 ( 2014 ) .",
    "[ 10 ] g. waldherr _",
    "et al . _ ,",
    "quantum error correction in a solid - state hybrid spin register .",
    "_ nature _ * 506 * , 204 - 207 ( 2014 ) .",
    "[ 11 ] b. p. lanyon _",
    "et al . _ , measurement - based quantum computation with trapped ions . _",
    "lett . _ * 111 * , 210501 ( 2013 ) .",
    "[ 12 ] a. d. crcoles _ et al .",
    "_ , demonstration of a quantum error detection code using a square lattice of four superconducting qubits .",
    "commun . _ * 6 * , 6979 ( 2015 ) .    [ 13 ] d. rist _ et al . _ , detecting bit - flip errors in a logical qubit using stabilizer measurements .",
    "commun . _ * 6 * , 6983 ( 2015 ) .",
    "[ 14 ] j. kelly _ et al .",
    "_ , state preservation by repetitive error detection in a superconducting quantum circuit .",
    "_ nature _ * 519 * , 66 - 69 ( 2015 ) .",
    "[ 15 ] l. sun _ et al .",
    "_ , tracking photon jumps with repeated quantum non - demolition parity measurements",
    ". _ nature _ * 511 * , 444 - 448 ( 2014 ) .",
    "[ 16 ] g. d. fuchs , v. v. dobrovitski , d. m. toyli , f. j. heremans , d. d. awschalom , gigahertz dynamics of a strongly driven single quantum spin",
    ". _ science _ * 326 * , 1520 - 1522 ( 2009 ) .",
    "[ 17 ] l. robledo _ et al .",
    "_ , high - fidelity projective read - out of a solid - state spin quantum register .",
    "_ nature _ * 477 * , 574 - 578 ( 2011 ) .",
    "[ 18 ] n. bar - gill , l. m. pham , a. jarmola , d. budker , r. walsworth , solid - state electronic spin coherence time approaching one second .",
    "commun . _ * 4 * , 1743 ( 2013 ) .",
    "[ 19 ] g .- q .",
    "liu , h. c. po , j. du , r .- b .",
    "liu , x .- y .",
    "pan , noise - resilient quantum evolution steered by dynamical decoupling .",
    "commun . _ * 4 * , 2254 ( 2013 ) .",
    "[ 20 ] l. jiang _ et al .",
    "_ , coherence of an optically illuminated single nuclear spin qubit .",
    "lett . _ * 100 * , 073001 ( 2008 ) .",
    "[ 21 ] w. pfaff _ et al .",
    "_ , demonstration of entanglement - by - measurement of solid - state qubits",
    ". _ nature phys . _ * 9 * , 29 - 33 ( 2013 ) .    [ 22 ] g. wolfowicz _",
    "_ , @xmath78si nuclear spins as a resource for donor spin qubits in silicon . arxiv:1505.02057 ( 2015 ) .    [",
    "23 ] m. s. blok _",
    "et al . _ , manipulating a qubit through the backaction of sequential partial measurements and real - time feedback . _",
    "nature phys . _",
    "* 10 * , 189 - 193 ( 2014 ) .",
    "[ 24 ] j. t. barreiro _ et al .",
    "_ , an open - system quantum simulator with trapped ions .",
    "_ nature _ * 470 * , 486 - 491 ( 2011 ) .",
    "[ 25 ] d. rist _ et al .",
    "_ , deterministic entanglement of superconducting qubits by parity measurement and feedback .",
    "_ nature _ * 502 * , 350 - 354 ( 2013 ) .",
    "[ 26 ] p. london , _ et al .",
    "_ , detecting and polarizing nuclear spins with double resonance on a single electron spin .",
    "lett . _ * 111 * , 067601 ( 2013 ) .",
    "[ 27 ] m. d. shulman _",
    "et al . _ , suppressing qubit dephasing using real - time hamiltonian estimation . _ nat .",
    "commun . _ * 5 * , 5156 ( 2014 ) .",
    "[ 28 ] p. c. maurer _ et al .",
    "_ , room - temperature quantum bit memory exceeding one second . _ science _ * 336 * , 1283 - 1286 ( 2012 ) .",
    "[ 29 ] g. balasubramanian , _ et al .",
    "_ , ultralong spin coherence time in isotopically engineered diamond .",
    "_ nature mater .",
    "_ * 8 * , 383 - 387 ( 2009 ) .",
    "[ 30 ] k. saeedi _ et al .",
    "_ , room - temperature quantum bit storage exceeding 39 minutes using ionized donors in silicon-28",
    ". _ science _ * 342 * , 830 - 833 ( 2013 ) .    [ 31 ] j. t. muhonen _",
    "et al . _ , storing quantum information for 30 seconds in a nanoelectronic device . _",
    "nature nanotech . _",
    "* 9 * , 986991 ( 2014 ) .    [ 32 ] l. li _",
    "et al . _ ,",
    "coherent spin control of a nanocavity - enhanced qubit in diamond .",
    "commun . _ * 6 * , 6173 ( 2015 ) .    [ 33 ] f. dolde _",
    "_ , high - fidelity spin entanglement using optimal control .",
    "* 5 * , 3371 ( 2014 ) .",
    "[ 34 ] w. pfaff _",
    "et al . _ , unconditional quantum teleportation between distant solid - state quantum bits .",
    "_ science _ * 345 * , 532 - 535 ( 2014 ) .",
    "[ 35 ] b. hensen _",
    "et al . _ , loophole - free bell inequality violation using electron spins separated by 1.3 kilometres .",
    "_ nature _ * 526 * , 682 - 686 ( 2015 ) .",
    "[ 36 ] n. h. nickerson , y. li , s. c. benjamin , topological quantum computing with a very noisy network and local error rates approaching one percent .",
    "commun . _ * 4 * , 1756 ( 2013 ) .",
    "[ 37 ] j. p. hadden _",
    "_ , strongly enhanced photon collection from diamond defect centers under microfabricated integrated solid immersion lenses .",
    "lett . _ * 97 * , 241901 ( 2010 ) .",
    "[ 38 ] t. k. yeung _",
    "et al . _ , anti - reflection coating for nitrogen - vacancy optical measurements in diamond . _",
    "* 100 * , 251111 ( 2012 ) .",
    "we thank l. dicarlo , l. m. k. vandersypen , a. g. fowler and v. v. dobrovitski for discussions and comments .",
    "we acknowledge support from the dutch organization for fundamental research on matter ( fom ) , the netherlands organization for scientific research ( nwo ) , the defense advanced research projects agency quasar program , the european union s3nano programs , and the european research council through a starting grant .",
    "tht is supported by an nwo veni grant .     and on - chip lines for microwave control .",
    "ancilla : the optically addressable electronic spin of a nitrogen vacancy ( nv ) centre .",
    "qubits : three @xmath10c nuclear spins that are controlled and measured through the hyperfine coupling to the ancilla ( methods ) .",
    "* c , * free induction decay ( ramsey ) experiments .",
    "gaussian fits yield dephasing times @xmath79 = 12.0(9 ) , 9.1(6 ) and 18.2(9 ) ms for qubits 1 , 2 and 3 , respectively .",
    "* d , * deterministic entanglement of two qubits by @xmath24 stabilizer measurement and feedback .",
    "the @xmath80 gates are @xmath81 rotations around @xmath82 with the sign controlled by the ancilla state .",
    "the final operations reset the ancilla and account for an additional flip for the + 1 outcome ( methods ) .",
    "* e , * state tomography of the generated entangled state for qubits 2 and 3 .",
    "the fidelity with the ideal state is @xmath27 ( see supplementary fig .",
    "6 for other qubit combinations and post - selected results ) . ]     prepared on the ancilla into @xmath0 .",
    "successful encoding is heralded by outcome @xmath18 .",
    "* b , * characterization of the logical states @xmath83 , @xmath84 and @xmath29 . only the logical qubit operators and stabilizers are shown ( see supplementary fig . 7 for complete tomography of all 6 logical basis states ) .",
    "the fidelities with the ideal three - qubit states are @xmath85 , @xmath86 and @xmath87 , respectively , demonstrating three - qubit entanglement [ 10 ] .",
    "the logical state fidelities are @xmath88 , @xmath89 and @xmath90",
    ". ideally , all the encoded states are + 1 eigenstates of the stabilizers @xmath7 and @xmath8 .",
    "the fidelity to this code space , @xmath91 , is @xmath92 averaged over all states and gives the probability that the starting state is free of detectable errors . ]     with probability @xmath33 .",
    "errors are detected by measuring @xmath7 and @xmath8 and subsequently corrected by @xmath9 operations through feedback .",
    "finally we measure the process fidelity with the identity .",
    "* b , * process fidelities for : an unencoded qubit , the logical qubit without stabilizer measurements , the error - corrected logical qubit , and the logical qubit without feedback ( i.e. errors are detected but not corrected ) .",
    "we average over the logical qubit permutations , e.g. @xmath93 , @xmath94 and @xmath95 , and the four ways to assign the ancilla states to the error syndromes ( see supplementary fig . 8 for individual curves ) .",
    "inset : probabilities for the error syndromes with theoretically predicted curves based on the state tomography in fig .",
    "2b ( supplementary note 2 ) .",
    "* c , * comparison between the error - corrected logical qubit and the logical qubit with the stabilizer measurements replaced by an equivalent idle time ( 2.99 ms ) . compared to b , the effective readout fidelity is optimized by associating syndrome + 1,+1 ( no error ) to obtaining @xmath22 for both stabilizer measurements .",
    "curves in * b * and * c * are fits described in the methods . ]     and @xmath96 as a function of total error probability @xmath33 for @xmath44 = 1 , 2 and 3 rounds of error correction compared to an unencoded qubit .",
    "the errors per round @xmath97 occur with probability @xmath73 .",
    "inset : probabilities that no error is detected ( @xmath98 ) .",
    "the similarity of the results for rounds a and b confirms that errors are corrected in between rounds .",
    "* c , * correcting natural dephasing .",
    "the storage time is defined from the end of the encoding until the start of the final measurements .",
    "* d , * dephasing of the logical qubit : without stabilizer measurements , with quantum error correction and without feedback , compared to the best unencoded qubit .",
    "the dashed lines indicate the times between which the actively error - corrected logical qubit gives the highest fidelity . the data without feedback ( detecting errors without correcting ) isolates the suppression of coherently evolving errors by projecting them .",
    "for long times , applying error correction lowers the fidelity because the stabilizer measurements extract no useful information about errors , but nevertheless preferentially suppress evolutions that result in phase errors at the end of the sequence ( see supplementary fig .",
    "10 for a detailed analysis ) .",
    "see supplementary fig . 9 for error syndrome probabilities .",
    "curves in * b * and * d * are fits described in the methods and supplementary notes 1&2 . ]",
    "for ideal error correction the process fidelity to the identity as a function of error probability @xmath33 for a single round of quantum error correction ( qec ) is f_qec(p_e)=o+a(1 - 3p_e^2 + 2p_e^3 ) .",
    "[ eq : fqec ] the offset @xmath69 and amplitude @xmath68 account for the finite experimental state fidelities .",
    "note that the value at @xmath99 , @xmath100 , is determined by the fidelity of the logical states @xmath29 and @xmath30 , which are insensitive to phase errors . without error correction a linear function f_linear = o+a(1-p_e ) [ eq : fn ]",
    "is expected .",
    "the experimental data can be fitted to a weighted sum of the two functions by : f_p = wf_qec+(1-w)f_linear .",
    "[ eq : qec ] the shape of the curve is set by @xmath42 , which gives the relative weights of the equations for ideal error correction and for no error correction .      in our experiment ,",
    "the ancilla readout fidelity is asymmetric : @xmath22 has a higher readout fidelity ( @xmath21 ) than @xmath18 ( @xmath20 ) . the effective measurement fidelity for error correction @xmath101 is therefore determined by the probabilities to obtain @xmath18 or @xmath22 , which depend on the assignment of the ancilla states ( @xmath18 or @xmath22 ) to each stabilizer measurement outcome ( + 1 or -1 ) and the probabilities for different errors to occur",
    ". there are four different ways to assign the ancilla states to the error syndromes : the + 1,+1 outcome ( no error ) can be set to result in @xmath102 , @xmath103 , @xmath104 or @xmath105 .",
    "the probability to obtain outcome + 1,+1 ( no error ) ideally is @xmath106 , while the probability to detect an error on a given qubit is @xmath107 . with these probabilities",
    ", we obtain the effective qec measurement fidelity as function of error probability : f _ = f^(1 - 3p_e+3p_e^3)+(f^+f^+f^)(p_e - p_e^2)=f^+(f^+f^+f^-3f^)(p_e - p_e^2 ) , [ eq : ed ] with @xmath108 , @xmath109 , @xmath110 and @xmath111 , the readout fidelities for 0 errors , an error on qubit 1 , an error on qubit 2 and an error on qubit 3 , respectively . for example , for assignment @xmath105 to stabilizer outcomes + 1,+1 ( no error ) , these readout fidelities are @xmath112 in a similar way , the fidelities for the other three assignments can be calculated .",
    "+   + finally , if we assume that an erroneous ancilla readout decoheres the logical state , the dependence of the effective readout fidelity on @xmath33 can be taken into account by setting : a = a f _ [ eq : p_dependence_of_a ] in eqs .",
    "[ eq : fqec]@xmath113[eq : fn ] for the process fidelity , with @xmath114 a constant .      in fig .",
    "3b , the ancilla readout is symmetrized by averaging over all four assignments , so that @xmath101 equals the average readout fidelity 0.939(2 ) and is independent of @xmath33 .",
    "we can therefore simply fit the data in fig .",
    "[ eq : qec ] , with @xmath68 constant .",
    "we find @xmath115 , corresponding to an average probability to successfully correct single - qubit errors of @xmath116 [ 1 ] .",
    "we obtain @xmath117 and @xmath118 . for the unencoded qubit , the encoded qubit without stabilizer measurements , and the encoded qubit without feedback , we find a linear function and @xmath119 ( @xmath120 ) as expected without error correction ( exact values : @xmath121 and @xmath122 , @xmath123 and @xmath124 , and @xmath125 and @xmath126 , respectively for the three cases ) . in fig .",
    "[ fig : syn ] the separate process fidelities for the different assignments are shown .",
    "switching between assignments is done by adding or omitting a @xmath56-pulse before the ancilla readout . +   + in fig .",
    "3c , we assign the ancilla state @xmath22 to the + 1 outcome for all stabilizer measurements .",
    "this assignment is optimal because it associates the best readout fidelity with the most likely outcome : + 1,+1 ( no error , inset in fig .",
    "we fit the data in fig . 3c and fig .",
    "[ fig : syn ] to eq .",
    "[ eq : qec ] , with @xmath68 now error - dependent according to eq .",
    "[ eq : p_dependence_of_a ] and obtain @xmath127 , corresponding to @xmath128 ( @xmath129 and @xmath130 ) .",
    "the values for @xmath42 and @xmath131 are in good agreement with the result of fig .",
    "3b , indicating that the treatment in eqs .",
    "[ eq : ed]&[eq : p_dependence_of_a ] is accurate .      for multiple rounds of qec with incoherent errors and",
    "with the total error with probability @xmath33 equally distributed over @xmath44 rounds , the error - probability per round is @xmath132{1 - 2p_e})$ ] , for @xmath133 .",
    "ideally , the ( average ) state fidelity is then described by : f = 1+(1 - 6p_n^2 + 4p_n^3)^n . as before we fit the data to a weighted sum of the equations for ideal error correction and for a linear error - dependence ( no error correction ) .",
    "we use the optimal ancilla state assignment ( @xmath134 from eq .",
    "[ eq : ed ] ) . for two rounds of error correction",
    "we obtain f_2 = w1+af_(1 - 6p_2 ^ 2 + 4p_2 ^ 3)^2+(1-w)1+af_(1 - 2p_e ) , giving @xmath135 and @xmath136 . for three rounds it becomes f_3 = w1+af^2_(1 - 6p_3 ^ 2 + 4p_3 ^ 3)^3+(1-w)1+af^2_(1 - 2p_e ) , giving @xmath137 and @xmath138 .",
    "importantly , the data for multiple rounds can not be accurately described by the expected shape for a single round of error correction ( eq . [ eq : qec ] ) .",
    "the experiments for the best unencoded qubit and logical qubit ( majority vote only ) are fitted to a general exponentially decaying function : f = ( 1+ae^-(t / t)^n ) .",
    "[ eq : decay ] here , we obtain for the best qubit : @xmath139 ms and @xmath140 , while for the encoded qubit with majority voting we obtain : @xmath141 ms and @xmath142 .",
    "+   + to understand the interplay of quantum error correction and the projection of errors in the experiments with stabilizer measurements at half the free evolution time in fig .",
    "4d we turn to numerical monte carlo simulations , see fig .",
    "[ fig10 ] for details and results .",
    "the probability to detect no error ( @xmath143 ) is the sum of the probability to have no error ( no qubits flipped ) or three errors ( all qubits flipped ) and is described by : p^(0)=(1-p_^)(1-p_^)(1-p_^)+p_^p_^p_^ , [ eq : no ] where @xmath144 is the error probability for qubit @xmath145 . the probability to detect an error on one of the three qubits ( @xmath146 ) is the probability to have an error on qubit @xmath145 , or an error on both of the other qubits , which for example for qubit 1 is described by : p^(1 ) = p_^(1-p_^)(1-p_^)+(1-p_^)p_^p_^. [ eq : e ] with finite input error probability @xmath147 for qubit @xmath145 ( errors already present in the initially prepared state ) , the total error as function of the applied error probability @xmath33 , becomes : p_^(i)=p_^(i)+p_e-2p_^(i)p_e [ eq : ptot ] + finally we can take imperfect ancilla readout into account and obtain the probability to detect one of the error outcomes @xmath148 ( @xmath145=0 for no detected error ) as function of the applied error @xmath33 : @xmath149 +   + the @xmath24 stabilizers in the encoded state tomography ( fig .",
    "2 ) detect errors present in the encoded state , we obtain : @xmath150 which are uncorrected for qubit readout .",
    "these results can be translated to the input errors , as these outcomes refer to eqs .",
    "[ eq : no]&[eq : e ] with no additional applied error @xmath33 , giving @xmath151 , @xmath152 , @xmath153 . +   + using these values we estimate the expected total error detection probabilities @xmath154 , @xmath155 , @xmath156 and @xmath157 as function of applied error probability @xmath33 according to eqs .  [ eq : no]-[eq : pd3 ] .",
    "the expected error - dependent qec measurement outcomes are shown by the solid lines in the inset of fig .",
    "3b .      for the different error assignments ,",
    "the asymmetry in the ancilla readout complicates the error detection curves : the qec measurement fidelity is dependent on the error probability .",
    "if , for instance , both stabilizer measurements giving + 1 are assigned to @xmath105 , eqs .",
    "[ eq : pd0]-[eq : pd3 ] become : @xmath158 all error detection curves for the four error assignments using similar equations are plotted in fig .",
    "[ fig : syn ] .      for multiple rounds we now calculate the average input error @xmath159 from the detection probability for no additional applied error ( @xmath160 ) .",
    "we simplify eq .",
    "[ eq : no ] to p^(0 ) = 1 - 3p_^()+3(p_^())^2 and use eq .",
    "[ eq : no_11 ] to obtain the following average input error for round 1 : @xmath161 and for round 2 : @xmath162 .",
    "the resulting curves according to eq .",
    "[ eq : no_11 ] are shown in the inset of fig . 4b .      to obtain best estimates for the actual states ,",
    "the results are corrected for the fidelity of the gates used in the final readout ( tomography ) .",
    "we distinguish between reading out single- two- and three - qubit expectation values .",
    "+   + for a single qubit @xmath145 that is initialized and readout immediately , the measured expectation value @xmath163 is set by the initialization fidelity of the nitrogen spin ( @xmath164 ) and by factors due to the initialization ( @xmath165 ) and readout ( @xmath166 ) of the qubit .",
    "because the initialization and readout consist of the same set of gates , we assume that @xmath167 for this experiment and obtain : @xmath168 from which a readout correction factor @xmath169 can be determined .",
    "+   + to calibrate the multi - qubit readouts we initialize the three qubits in separable states .",
    "for example , for state @xmath170 , the measured three - qubit expectation value @xmath171 is set by the nitrogen initialization @xmath54 , by factors @xmath165 due to the individual initialization fidelities of the three - qubits and by a factor @xmath172 due to the three - qubit readout : @xmath173=f_nc_,q1c_,q2c_,q3c_q_1,q_2,q_3 c_q_1,q_2,q_3 = .",
    "this equation assumes that the initialization errors , other than those due to the nitrogen initialization , are uncorrelated .",
    "the initialization fidelities are obtained using the single - qubit expectation values and single qubit @xmath166 for the corresponding qubit , i.e. for qubit 1 : @xmath174=f_nc_,q1c_q_1 c_,q1 = with @xmath175 from eq .",
    "[ eq:1qev ] . in a similar way",
    ", the two - qubit readout is calibrated using two - qubit expectation values of two- and three - qubit states .",
    "we obtain the following values : @xmath176 which are used to calibrate the final readouts for tomography .",
    "note that the uncertainty in the readout calibration potentially creates a small systematic error ( a rescaling of all y - axes ) .",
    "for this reason we also provide all raw ( uncalibrated ) data for the error correction in fig .",
    "[ fig : fig3_uncorrected ] .",
    ".*qubit and gate parameters . *",
    "@xmath177 and @xmath178 are the estimated hyperfine interaction components parallel and perpendicular to the applied magnetic field . @xmath179 and @xmath180 are the nuclear precession frequencies for @xmath181 ( @xmath18 ) and @xmath182 ( @xmath22 ) .",
    "@xmath60 is half the inter pulse delay , @xmath58 the number of pulses and @xmath183 the total duration for the conditional @xmath80-gates .",
    "these values vary slightly over the experiment as they are calibrated every @xmath184 hours .",
    "@xmath17 is the ( natural ) dephasing time and @xmath185 the longitudinal relaxation time . [",
    "cols=\"^,^,^,^ \" , ]"
  ],
  "abstract_text": [
    "<S> reliable quantum information processing in the face of errors is a major fundamental and technological challenge . </S>",
    "<S> quantum error correction protects quantum states by encoding a logical quantum bit ( qubit ) in multiple physical qubits . to be compatible with universal fault - tolerant computations , it is essential that the states remain encoded at all times and that errors are actively corrected . </S>",
    "<S> here we demonstrate such active error correction on a continuously protected qubit using a diamond quantum processor . we encode a logical qubit in three long - lived nuclear spins , </S>",
    "<S> repeatedly detect phase errors by non - destructive measurements using an ancilla electron spin , and apply corrections on the encoded state by real - time feedback . </S>",
    "<S> the actively error - corrected qubit is robust against errors and multiple rounds of error correction prevent errors from accumulating . </S>",
    "<S> moreover , by correcting correlated phase errors naturally induced by the environment , we demonstrate that encoded quantum superposition states are preserved beyond the dephasing time of the best physical qubit used in the encoding . </S>",
    "<S> these results establish a powerful platform for the fundamental investigation of error correction under different types of noise and mark an important step towards fault - tolerant quantum information processing .    </S>",
    "<S> large - scale quantum information processing requires the correction of errors during computations . in quantum error correction a logical quantum bit ( qubit ) </S>",
    "<S> is encoded in a subspace of multiple physical qubits so that errors can be actively corrected without affecting the encoded information . </S>",
    "<S> a promising way to correct errors in encoded quantum states is to perform feedback based on multi - qubit measurements known as stabilizer measurements [ 1 - 3 ] ( see fig . </S>",
    "<S> 1a ) . </S>",
    "<S> these measurements are performed non - destructively using extra qubits ( ancillas ) and are frequently repeated to detect errors before they accumulate . </S>",
    "<S> the measurement outcomes are then processed in classical logic that identifies the error syndrome , and , in order to enable universal computations [ 1 ] , active feedback is applied to the encoded system to correct errors where needed . </S>",
    "<S> the key experimental challenge is to perform such complete error - correction cycles including non - destructive stabilizer measurements and real - time feedback well within the coherence time .    </S>",
    "<S> quantum - error - correction protocols have been explored across a range of platforms [ 4 - 14 ] . </S>",
    "<S> pioneering experiments bypassed stabilizer measurements by reversing the encoding to correct errors , thus leaving the quantum state unprotected [ 5 - 11 ] . </S>",
    "<S> recent breakthroughs have enabled the use of stabilizer measurements to passively track errors in quantum states and retrieve stored information afterwards through post processing [ 12 - 15 ] . here </S>",
    "<S> we realize complete rounds of active quantum error correction on a continuously encoded qubit by exploiting newly - developed stabilizer measurements based on an electron spin ancilla with high - fidelity non - demolition readout , encoding in long - lived nuclear spins and real - time correction of errors through fast classical logic .    </S>",
    "<S> the three - qubit code considered here corrects a single phase error on any one of the physical qubits . </S>",
    "<S> the logical qubit is encoded as @xmath0 with @xmath1 , @xmath2 and @xmath3 . </S>",
    "<S> the logical qubit operators are @xmath4 , @xmath5 and @xmath6 ( or their permutations ) . </S>",
    "<S> errors are detected by measuring the stabilizer generators @xmath7 and @xmath8 via an ancilla . </S>",
    "<S> for an uncorrupted state both measurements yield outcome + 1 ( no error ) , but for a phase error ( a @xmath9 operation ) on just one of the qubits the two measurements give a unique syndrome of -1 outcomes that identifies the error . </S>",
    "<S> * results *    * stabilizer measurements and real - time feedback . * </S>",
    "<S> our qubits are three @xmath10c nuclear spins ( @xmath11 , @xmath12 abundance ) surrounding a single nitrogen - vacancy ( nv ) centre in diamond , whose electronic spin we use as ancilla ( @xmath13 ; @xmath14 and @xmath15 ) ( fig . </S>",
    "<S> 1b ) . at 4 k , </S>",
    "<S> the ancilla combines fast control [ 16 ] , optical single - shot readout [ 17 ] and long coherence times [ 18 ] ( @xmath16 ms , methods ) . </S>",
    "<S> we use relatively remote nuclear qubits ( coupling to the ancilla 20 - 50 khz ) that are robust against optical excitation of the ancilla and design decoherence - protected gates to control them [ 9,19 ] ( methods ) . </S>",
    "<S> all three qubits show long dephasing times @xmath17 ( fig . </S>",
    "<S> 1c ) with the dominant natural errors being phase errors .    </S>",
    "<S> the key challenge for implementing stabilizer measurements in this system is that the ancilla - qubit interaction is always present : imperfect knowledge of the ancilla state during or after readout dephases the qubits [ 20 - 22 ] . to minimize this dephasing </S>",
    "<S> , we implement quantum non - demolition measurements of the ancilla by resonant optical excitation of @xmath18 and stopping the excitation within 2 @xmath19s upon photon detection ( outcome @xmath18 ) to minimize spin flips in the optically excited state [ 23 ] ( methods ) . </S>",
    "<S> the resulting readout fidelities are @xmath20 for @xmath18 and @xmath21 for @xmath22 ( average : @xmath23 ) . </S>",
    "<S> crucially , the post - measurement fidelity after correctly assigning @xmath18 is 0.992 , demonstrating the desired non - demolition character .    to benchmark the stabilizer measurements and real - time feedback , we deterministically entangle two qubits by projecting into a bell state , i.e. a simultaneous eigenstate of @xmath24 and @xmath25 [ 21,24,25 ] </S>",
    "<S> first , the qubits are initialized in @xmath26 , an eigenstate of @xmath25 , with fidelity 0.910(6 ) . </S>",
    "<S> then a @xmath24 stabilizer measurement projects the qubits onto one of two bell states ( fig . </S>",
    "<S> 1d ) . </S>",
    "<S> we interpret the -1 outcome as an error in the desired state and correct it through feedback before performing two - qubit tomography . </S>",
    "<S> the deterministically generated entangled state , with fidelity @xmath27 ( fig . </S>",
    "<S> 1e ) , demonstrates the non - destructive nature of the measurement ; coherence within the subspaces is maintained throughout the measurement and feedback cycle . </S>",
    "<S> the complete cycle can be repeated up to 6 times within the shortest qubit @xmath17 .    * active quantum error correction on a logical qubit . </S>",
    "<S> * we now turn to quantum error correction by stabilizer measurements . </S>",
    "<S> the logical qubit is encoded by taking an arbitrary state @xmath28 prepared on the ancilla to the three - qubit state @xmath0 ( fig . </S>",
    "<S> 2a ) . </S>",
    "<S> we characterize the encoding by preparing six basis states @xmath29 , @xmath30 , @xmath31 and @xmath32 and performing three - qubit state tomography . the fidelities with the ideal states </S>",
    "<S> confirm successful encoding and genuine three - qubit entanglement ( fig . </S>",
    "<S> 2b ) .    </S>",
    "<S> we first investigate the recovery of arbitrary logical qubit states from phase errors . to emulate a general process causing dephasing , </S>",
    "<S> uncorrelated incoherent errors are applied with variable probability @xmath33 to each physical qubit simultaneously ( fig . </S>",
    "<S> 3a ) ; for each qubit the error process is @xmath34 , with @xmath35 the single - qubit density matrix . by controllably </S>",
    "<S> applying such errors we characterize the effectiveness of the error correction for any process causing uncorrelated errors with equal probability to the qubits . </S>",
    "<S> we then measure the stabilizers @xmath7 and @xmath8 , identify potential errors and correct them through feedback . the probabilities to obtain the four different error syndromes ( inset in fig . </S>",
    "<S> 3b ) show the expected symmetry around @xmath36 and match the theoretical prediction based on the errors present in the initial states ( fig . </S>",
    "<S> 2b ) and the average ancilla readout fidelity .    </S>",
    "<S> the protection of the logical qubit is characterized by the process fidelity with the identity ( fig . </S>",
    "<S> 3b ) ( methods ) . </S>",
    "<S> we quantitatively analyse the results by fitting to @xmath37 , where @xmath38 and @xmath39 are the theoretical curves with and without error correction ( @xmath40 indicates ideal robustness against applied single - qubit errors ) . when no error correction is applied we observe the expected linear dependence on the error probability : @xmath41 . </S>",
    "<S> in contrast , with quantum error correction @xmath42 is @xmath43 , and a non - linear curve shape that is characteristic for robustness against single - qubit errors is obtained . </S>",
    "<S> this result demonstrates that the entropy associated to the applied errors is successfully removed from the system .    </S>",
    "<S> comparisons to an unencoded qubit and the logical qubit without error correction reveal that adding quantum error correction on top of a computation does not yet provide a net improvement ( fig . </S>",
    "<S> 3b ) , due to additional errors introduced by the initialization , encoding and stabilizer measurements ( total of 13 two - qubit gates , 488 ancilla refocusing pulses and 6 ancilla readouts / resets ) . to isolate the errors due to the stabilizer measurements </S>",
    "<S> , we compare the error - corrected logical qubit to the logical qubit left idle . </S>",
    "<S> we further optimize the error correction , by assigning the ancilla state with the best readout fidelity ( @xmath22 , @xmath21 ) to the most likely error syndrome ( + 1 , + 1 - no error , inset fig . </S>",
    "<S> 3b ) , instead of averaging over all assignments as in fig . </S>",
    "<S> 3b . with this improvement , error correction outperforms idling for a range of @xmath33 ( fig . </S>",
    "<S> 3c ) ; once the logical qubit is encoded , quantum error correction can be beneficial .    * multiple rounds of active error correction . </S>",
    "<S> * because a complete round of error correction ( 2.99 ms ) fits well within the dephasing time of the physical qubits , we can concatenate multiple rounds to improve the coherence of continuously encoded quantum superpositions by preventing the accumulation of errors ( fig . </S>",
    "<S> 4a ) . </S>",
    "<S> three new elements are introduced . </S>",
    "<S> first , the total error probability @xmath33 is distributed over @xmath44 rounds , so that the error probability per round is @xmath45{1 - 2p_e})/2 $ ] ( methods ) . </S>",
    "<S> this error model corresponds to errors occurring incoherently , for example with a constant rate in time . </S>",
    "<S> second , to investigate dephasing we consider only the protection of the two states @xmath46 ( i.e. a classical bit stored in the phase of a quantum superposition ) . </S>",
    "<S> third , we exploit the intrinsic robustness of the logical qubit to single @xmath9 errors by redefining @xmath47 which is equivalent to performing a round of error correction by majority voting at the end of the experiment [ 13,14 ] .    for a single round of error correction ( </S>",
    "<S> majority vote only ) the average fidelity is higher than for an unencoded qubit for any @xmath33 ( fig . </S>",
    "<S> 4b ) ; adding more ( identical ) qubits is always beneficial in the repetition code . for @xmath48 , </S>",
    "<S> additional rounds of quantum error correction can only introduce errors , reducing the fidelity ( fig . </S>",
    "<S> 4b ) . for larger </S>",
    "<S> @xmath33 , however , multiple rounds prevent errors from accumulating by dividing the error process in parts that are more likely to contain only single errors , which are corrected . </S>",
    "<S> in addition , unlike error detection with post - processing [ 13,14 ] , active correction between rounds keeps the probability to obtain + 1 ( no error ) high ( inset fig . </S>",
    "<S> 4b ) and thus maintains the advantage of assigning the highest - fidelity ancilla readout to that outcome . </S>",
    "<S> as a result , for @xmath49 , multiple rounds outperform a single round of error correction .    * correcting natural dephasing . * finally , as an example of suppressing errors naturally present in the environment , we let the qubits evolve naturally instead of applying errors ( fig . </S>",
    "<S> 4c ) . </S>",
    "<S> the error probabilities are now different for each qubit because their intrinsic @xmath17 differ due to their local environments ( fig . </S>",
    "<S> 1c ) . </S>",
    "<S> in addition , the errors arise from quasistatic detunings due to the fluctuating @xmath10c spin bath , so that they are correlated in time and can evolve coherently . like most environmental errors , such errors might also be suppressed by other methods than quantum error correction , for example by polarizing the spin environment [ 26,27 ] , by refocusing pulses [ 28 ] or by isotopic purification [ 28 - 31 ] .    </S>",
    "<S> the fidelity for the logical qubit with majority voting again starts above the best unencoded qubit , but drops below it for larger evolution times ( fig . </S>",
    "<S> 4d ) . because the error probabilities vary between qubits , an error detected on the best qubit becomes more likely to actually correspond to errors on both other qubits and the wrong correction is made . </S>",
    "<S> an additional round of quantum error correction in the middle of the evolution time now not only prevents errors from accumulating by intermediately correcting them , but also interrupts any coherent build - up by projecting the errors , thus suppressing them ( fig . </S>",
    "<S> 4d ) . due to this combination </S>",
    "<S> , the logical qubit with error correction yields the highest average fidelity for total evolution times between 5 and 19 ms ( fig . </S>",
    "<S> 4d ) . </S>",
    "<S> this result demonstrates an actively error - corrected logical qubit with an improved dephasing time over the best qubit used in the encoding . </S>",
    "<S> * discussion *    the presented non - destructive measurements and real - time feedback on encoded quantum states are the key primitives for universal computations on logical qubits and for error - correcting codes that correct both phase and bit - flip errors . </S>",
    "<S> to reach scalability thresholds , readout and gate fidelities can be further improved , for example through optical cavities [ 32 ] , the implantation [ 33 ] or selective growth of defects and isotopes [ 28,29 ] , and optimal control [ 33 ] . in a wider perspective </S>",
    "<S> , our results can be combined with recently demonstrated entanglement between distant nv centres [ 34,35 ] to form quantum networks with error - corrected nodes for entanglement purification , quantum communication and networked quantum computation [ 36 ] . </S>",
    "<S> therefore , these results establish a promising platform to experimentally investigate protocols for fault - tolerant quantum information processing under different types of noise and error correlations in diverse settings . </S>"
  ]
}