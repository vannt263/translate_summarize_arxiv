{
  "article_text": [
    "recall that an automorphism @xmath6 of a group @xmath1 is said to be _ normal _ if @xmath7 for every normal subgroup @xmath8 of @xmath1 .",
    "the subset of normal automorphisms , denoted by @xmath3 , is clearly a subgroup of @xmath9 .",
    "obviously every inner automorphism is normal . throughout this paper",
    "we denote by @xmath10 the quotient group @xmath11 .",
    "the study of normal automorphisms originates from the result of lubotzky stating that @xmath10 is trivial for any non - abelian free group @xcite .",
    "since then similar results have been proved for many other classes of groups .",
    "for example , @xmath12 for non - trivial free products @xcite , fundamental groups of closed surfaces of negative euler characteristic @xcite , non - abelian free burnside groups of large odd exponent @xcite , non - abelian free solvable groups @xcite , and free nilpotent group of class @xmath13 ( for @xmath14 this is not true ) @xcite . on the other hand",
    ", every group can be realized as @xmath15 for a suitable simple group @xmath1 @xcite . since",
    "every automorphism of a simple group is normal , every group appears as @xmath10 for some @xmath1 .",
    "furthermore , every countable group can be realized as @xmath10 for some finitely generated group @xmath1 @xcite .",
    "the main goal of this paper is to study normal automorphisms of relatively hyperbolic groups .",
    "the notion of a relatively hyperbolic group was originally suggested by gromov @xcite and has been elaborated in many papers since then @xcite .",
    "the class of relatively hyperbolic groups includes ( ordinary ) hyperbolic groups , fundamental groups of finite - volume complete riemannian manifolds of pinched negative curvature @xcite , groups acting freely on @xmath16-trees @xcite ( in particular , limit groups arising in the solutions of the tarski problem @xcite ) , non - trivial free products and their small cancellation quotients @xcite , groups acting geometrically on @xmath17 spaces with isolated flats @xcite , and many other examples .    in this paper",
    "we neither assume relatively hyperbolic groups to be finitely generated nor the collection of peripheral subgroups to be finite .",
    "( the reader is referred to the next section for the precise definition . )",
    "however we do assume that all peripheral subgroups are proper to exclude the case of a group hyperbolic relative to itself .",
    "further on , we will say that a group @xmath1 _ non - elementary _ , if it is not virtually cyclic .    in general @xmath10 is not necessarily trivial even for ordinary hyperbolic groups .",
    "indeed , it is known ( see @xcite ) that certain finite groups @xmath18 possess non - inner automorphisms which map every element to its conjugate .",
    "one can therefore construct many hyperbolic groups @xmath1 with non - trivial @xmath10 by taking any hyperbolic group @xmath19 and considering the direct product @xmath20 .",
    "the first result of our paper shows that non - trivial finite normal subgroups are essentially the only sources of non - inner normal automorphisms .",
    "more precisely , every relatively hyperbolic group @xmath1 contains a unique maximal finite normal subgroup ( see corollary [ kg ] ) .",
    "we denote it by @xmath21 .",
    "further let @xmath22 denote the centralizer of @xmath21 in @xmath1 .",
    "[ main ] suppose that @xmath1 is a non - elementary relatively hyperbolic group and @xmath23 .",
    "then there exist an element @xmath24 and a set map @xmath25 such that @xmath26 and @xmath27 for every @xmath28 .",
    "in fact , theorem [ main ] is a particular case of a more general result about normal automorphisms of subgroups of relatively hyperbolic groups ( see theorem [ normautsubgr ] ) .",
    "the corollary below follows easily from theorem [ main ] and the observation that @xmath22 has finite index in @xmath1 being the centralizer of a finite normal subgroup .",
    "[ cor1 ] suppose that @xmath1 is a relatively hyperbolic group . then the following hold .    1 .",
    "@xmath10 is finite .",
    "2 .   if @xmath1 is non - cyclic and contains no non - trivial finite normal subgroups , then @xmath12 .",
    "this corollary generalizes the results about free groups @xcite , free products @xcite , and surface groups @xcite cited above .",
    "it also implies the result of metaftsis and sykiotis @xcite stating that for every non - elementary finitely generated relatively hyperbolic group @xmath1 , @xmath2 has finite index in the group @xmath29 of pointwise inner automorphisms of @xmath1 . recall that an automorphism of @xmath1 is _ pointwise inner _ , if it preserves conjugacy classes .",
    "clearly @xmath30 .",
    "thus finiteness of @xmath10 implies that of @xmath31 .",
    "the converse is not true in general .",
    "for instance , if @xmath1 is free nilpotent of class at least @xmath32 , we have @xmath33 while @xmath34 @xcite .",
    "it is also worth noting that our methods are quite different from those of @xcite .",
    "indeed we use the group - theoretic version of dehn surgery introduced in @xcite and ` component analysis ' developed in @xcite , while metaftsis and sykiotis employed the bestvina - paulin approach @xcite based on ultralimits and group actions on @xmath35-trees .    in order to prove theorem [ main ] , we introduce a new subclass of automorphisms of any given group , and investigate it in the case of relatively hyperbolic groups .",
    "let @xmath1 be a group .",
    "we say that an automorphism @xmath36 is _ commensurating _ if for every @xmath28 there exist @xmath37 and @xmath38 such that @xmath39 .",
    "in other words , @xmath40 is commensurating if for each @xmath41 , @xmath42 is _ commensurable _ to @xmath43 in @xmath1 ( see definition [ def : commensurability ] ) .",
    "it is clear that the subset @xmath44 of commensurating automorphisms of @xmath1 forms a subgroup of @xmath45 and @xmath46 .    in section [ sec : comm - aut ]",
    "we study commensurating automorphisms of relatively hyperbolic groups and obtain a complete description of them :    [ cor : descr_comm_aut ] let @xmath1 be a non - elementary relatively hyperbolic group and @xmath36 .",
    "the following conditions are equivalent :    1 .",
    "@xmath47 is commensurating ; 2 .",
    "there is a set map @xmath48 , whose restriction to @xmath22 is a homomorphism , and an element @xmath49 such that for every @xmath41 , @xmath50 .    in particular , if @xmath51 , then every commensurating automorphism of @xmath1 is inner .    in section [ sec : dehn_surgery ] , using the algebraic version of dehn filling , we show that each normal automorphism of a relatively hyperbolic group must be commensurating .",
    "after this , theorem [ main ] follows quite quickly from the above description of commensurating automorphisms .",
    "our methods can also be used to prove residual finiteness of some outer automorphism groups . a well - known theorem of baumslag states that the automorphism group of a finitely generated residually finite group is residually finite @xcite .",
    "in general , the analogous property does not hold for the group of outer automorphisms .",
    "indeed , bumagina and wise showed that every finitely presented group is realized as @xmath15 for a suitable finitely generated residually finite group @xmath1 @xcite .",
    "however we prove that baumslag s theorem does have an ` outer ' analogue for groups with more than one end .",
    "we refer to @xcite for the geometric definition of ends , and recall that the number of ends of a finitely generated group can be either @xmath52 , @xmath53 , @xmath54 or infinity .",
    "[ infends ] let @xmath1 be a finitely generated residually finite group with more than one end .",
    "then @xmath15 is residually finite .",
    "an infinite finitely generated group @xmath1 has two ends if and only if it is virtually cyclic ; and @xmath1 has infinitely many ends if and only if it splits non - trivially as an amalgamated free product @xmath55 or an @xmath56-extension @xmath57 over a finite group @xmath58 @xcite .",
    "note that the condition demanding residual finiteness of @xmath1 in theorem [ infends ] can not be removed . indeed , if @xmath19 is any finitely generated group that has trivial center and is not residually finite , then the group @xmath59 has infinitely many ends and @xmath19 is embedded into @xmath5 ( @xmath19 acts on itself by conjugation and trivially on @xmath60 , which gives rise to an action of @xmath19 by outer automorphisms on the free product @xmath61 ) .",
    "thus @xmath5 is not residually finite .",
    "the standard way of proving residual finiteness of @xmath5 is based on the following result of grossman @xcite : if a group @xmath1 is finitely generated and conjugacy separable , then @xmath62 is residually finite . in particular , @xmath15 is residually finite whenever @xmath1 is finitely generated , conjugacy separable , and @xmath63 .",
    "recall that a group @xmath1 is said to be _ conjugacy separable _ if for any two non - conjugate elements @xmath64 there exists a homomorphism @xmath65 , where @xmath66 is finite , such that @xmath67 and @xmath68 are not conjugate in @xmath66 .",
    "this approach has been successfully used to prove residual finiteness of @xmath5 , where @xmath1 is a free group of finite rank @xcite , the fundamental group of a closed surface @xcite , the fundamental group of a seifert manifold with non - trivial boundary @xcite , etc .",
    "if @xmath1 is a finitely generated conjugacy separable non - elementary relatively hyperbolic group , the above mentioned result from @xcite implies that every virtually torsion - free subgroup of @xmath5 is residually finite ( * ? ? ?",
    "* theorem 1.1 ) .",
    "however there is no hope to use grossman s idea to prove theorem [ infends ] since we only assume the group @xmath1 to be residually finite , which is much weaker than conjugacy separability .",
    "indeed there are many examples of finitely generated residually finite groups that are not conjugacy separable ( e.g. , the group of unimodular matrices @xmath69 for @xmath70 , see @xcite ) .",
    "to construct such an example with infinitely many ends , we can simply take @xmath71 , where @xmath19 is finitely generated , residually finite , but not conjugacy separable .",
    "it is easy to show that @xmath1 will also be finitely generated , residually finite , but not conjugacy separable .",
    "our approach is different and is based on the following observation .",
    "let @xmath72 denote the group of automorphisms of @xmath1 that stabilize every normal subgroup of finite index ( setwise ) .",
    "then @xmath73 is residually finite for every finitely generated group @xmath1 .",
    "the following result plays the crucial role in the proof of theorem [ infends ] .",
    "it also seems to be of independent interest .",
    "its proof essentially uses the fact that free products are hyperbolic relative to their free factors , which allows us to employ the techniques developed in the proof of theorem [ main ] .",
    "[ fp ] suppose that @xmath74 , where @xmath75 are non - trivial residually finite groups",
    ". then @xmath76 .",
    "* acknowledgments .",
    "* we are grateful to a. klyachko and v. yedynak for useful discussions , and to the anonymous referee for his comments .",
    "* notation . * given a group @xmath1 generated by a subset @xmath77 , we denote by @xmath78 the cayley graph of @xmath1 with respect to @xmath58 and by @xmath79 the word length of an element @xmath28 .",
    "if @xmath80 is a ( combinatorial ) path in @xmath78 , @xmath81 denotes its label , @xmath82 denotes its length , @xmath83 and @xmath84 denote its starting and ending vertex .",
    "the notation @xmath85 will be used for the path in @xmath78 obtained by traversing @xmath80 backwards . by saying that @xmath86 is a cycle in @xmath78 we will mean that @xmath87 is obtained as a consecutive concatenation of paths @xmath88 such that @xmath89 for @xmath90 and @xmath91 .    for a word @xmath92 written in the alphabet @xmath58",
    ", @xmath93 will denote its length . for two words",
    "@xmath94 and @xmath95 we shall write @xmath96 to denote the letter - by - letter equality between them . the normal closure of a subset @xmath97 in a group @xmath1 ( i.e. , the minimal normal subgroup of @xmath1 containing @xmath66 ) is denoted by @xmath98 , or simply by @xmath99 if omitting @xmath1 does not lead to a confusion . for any group elements @xmath43 and @xmath100 , @xmath101 denotes @xmath102 . if @xmath103 then @xmath104 . for a subgroup @xmath105 , @xmath106 denotes the normalizer of a @xmath19 in @xmath1",
    ". that is , @xmath107 . similarly by @xmath108",
    "we denote the centralizer of @xmath19 in @xmath1 , that is , @xmath109 finally for two subsets @xmath75 of @xmath1 , their product is the subset @xmath110 .",
    "[ [ relatively - hyperbolic - groups . ] ] * relatively hyperbolic groups .",
    "* + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    in this paper we use the notion of relative hyperbolicity which is sometimes called strong relative hyperbolicity and goes back to gromov @xcite .",
    "there are many equivalent definitions of ( strongly ) relatively hyperbolic groups @xcite .",
    "we recall the isoperimetric characterization suggested in @xcite , which is most suitable for our purposes .",
    "that relative hyperbolicity in the sense of @xcite implies relative hyperbolicity in the sense of definition [ def : rel_hyp_gp ] stated below is essentially due to rebbechi @xcite .",
    "( indeed it was proved in @xcite under the additional technical condition that the groups under consideration are finitely presented . ) in the full generality this implication and the converse one were proved in @xcite .",
    "let @xmath1 be a group , @xmath111  a collection of _ proper _ subgroups of @xmath1 , @xmath112  a subset of @xmath1 .",
    "we say that @xmath112 is a _ relative generating set of @xmath1 with respect to @xmath111 _ if @xmath1 is generated by @xmath112 together with the union of all @xmath113 .",
    "( in what follows we always assume @xmath112 to be symmetric . ) in this situation the group @xmath1 can be regarded as a quotient group of the free product @xmath114 where @xmath115 is the free group with the basis @xmath112 .",
    "if the kernel of the natural homomorphism @xmath116 is the normal closure of a subset @xmath117 in the group @xmath118 , we say that @xmath1 has _ relative presentation _",
    "@xmath119 if @xmath120 and @xmath121 , the relative presentation ( [ g ] ) is said to be _ finite _ and the group @xmath1 is said to be _ finitely presented relative to the collection of subgroups @xmath111 .",
    "_    set @xmath122 given a word @xmath92 in the alphabet @xmath123 such that @xmath92 represents @xmath53 in @xmath1 , there exists an expression @xmath124 with the equality in the group @xmath118 , where @xmath125 and @xmath126 for @xmath127 .",
    "the smallest possible number @xmath128 in a representation of the form ( [ prod ] ) is called the _ relative area _ of @xmath92 and is denoted by @xmath129 .",
    "[ def : rel_hyp_gp ] a group @xmath1 is _ hyperbolic relative to a collection of proper subgroups _",
    "@xmath111 if @xmath1 is finitely presented relative to @xmath111 and there is a constant @xmath130 such that for any word @xmath92 in @xmath131 representing the identity in @xmath1 , we have @xmath132 the constant @xmath133 in ( [ isop ] ) is called an _ isoperimetric constant _ of the relative presentation ( [ g ] ) and @xmath111 is called the collection of _ peripheral ( or parabolic ) subgroups _ of @xmath1 . in particular , @xmath1 is an ordinary ( gromov ) _ hyperbolic group _ if @xmath1 is hyperbolic relative to the trivial subgroup .",
    "later on by saying that a group @xmath1 is _ relatively hyperbolic _",
    ", we will mean that there exists a collection of proper subgroups @xmath134 such that @xmath1 is hyperbolic relative to @xmath111 .",
    "this definition is independent of the choice of the finite generating set @xmath112 and the finite set @xmath117 in ( [ g ] ) ( see @xcite ) .",
    "[ maln ] let @xmath1 be a group hyperbolic relative to a collection of subgroups @xmath111 .",
    "then the following conditions hold .    1 .   for every @xmath135 , @xmath136 , and every @xmath28",
    ", we have @xmath137 .",
    "2 .   for every @xmath138 and @xmath139",
    ", we have @xmath140 .    [ [ components . ] ] * components . * + + + + + + + + + + + + +    let @xmath1 be a group hyperbolic relative to a family of proper subgroups @xmath111 .",
    "we recall some auxiliary terminology introduced in @xcite , which plays an important role in our paper .",
    "let @xmath141 be a path in the cayley graph @xmath142 .",
    "a ( non - trivial ) subpath @xmath80 of @xmath141 is called an _ @xmath113-component _ ( or simply a _ component _ ) ,",
    "if the label of @xmath80 is a word in the alphabet @xmath143 and @xmath80 is not contained in a longer subpath of @xmath141 with this property .",
    "two @xmath113-components @xmath144 of a path @xmath141 in @xmath142 are called _ connected _ if there exists a path @xmath145 in @xmath142 that connects some vertex of @xmath146 to some vertex of @xmath147 , and @xmath148 is a word consisting of letters from @xmath149 . in algebraic terms",
    "this means that all vertices of @xmath146 and @xmath147 belong to the same coset @xmath150 for a certain @xmath28 .",
    "note that we can always assume that @xmath145 has length at most @xmath53 , as every non - trivial element of @xmath151 is included in the set of generators .",
    "[ [ loxodromic - elements - and - elementary - subgroups . ] ] * loxodromic elements and elementary subgroups . * + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    recall that an element @xmath28 is called _ parabolic _ if it is conjugate to an element of one of the subgroups @xmath113 , @xmath138 .",
    "an element is said to be _ loxodromic _ if it is not parabolic and has infinite order . if @xmath19 is a subgroup of @xmath1 , by @xmath152 we will denote the set of all elements of @xmath19 that are loxodromic in @xmath1 .    recall also that a group is _ elementary _ if it contains a cyclic subgroup of finite index .",
    "the next result was obtained in @xcite . the first part of the lemma is well known in the context of convergence groups @xcite .",
    "in particular , it follows from @xcite and @xcite in case @xmath1 is finitely generated .",
    "( the latter assumption is only essential for @xcite . )",
    "[ eg ] suppose a group @xmath1 is hyperbolic relative to a collection of subgroups @xmath111 .",
    "let @xmath43 be a loxodromic element of @xmath1 .",
    "then the following conditions hold .    1 .",
    "there is a unique maximal elementary subgroup @xmath153 containing @xmath43 .",
    "2 .   @xmath154 .",
    "the group @xmath1 is hyperbolic relative to the collection @xmath155 .    for finitely generated relatively hyperbolic groups , a lemma similar to lemma [ eg ] ( c )",
    "was also stated in @xcite .",
    "namely it was claimed that if @xmath1 is a ( finitely generated ) relatively hyperbolic group and @xmath156 is an infinite cyclic subgroup of @xmath1 such that @xmath156 coincides with its normalizer , then @xmath156 can be joined to the collection of peripheral subgroups of @xmath1 ( * ? ? ?",
    "* lemma 4.4 ) .",
    "we note that this is wrong even in case @xmath1 is an ordinary hyperbolic group .",
    "the simplest counterexample is given by the group @xmath157 and the subgroup @xmath158 .",
    "obviously @xmath1 splits as @xmath159 , where @xmath160 . in particular",
    "@xmath1 is hyperbolic ( or , equivalently , hyperbolic relative to the trivial subgroup ) .",
    "it is straightforward to check that @xmath156 coincides with its own normalizer in @xmath1 .",
    "indeed every element @xmath28 has the form @xmath161 , where @xmath162 and @xmath163 . if @xmath164 , we have @xmath165 similarly @xmath166 if @xmath167 . on the other hand , @xmath1 is not hyperbolic relative to @xmath156 .",
    "indeed @xmath168 and hence @xmath169 is infinite .",
    "this contradicts part ( b ) of lemma [ maln ] .",
    "similarly for every ( finitely generated ) group @xmath19 , the free product @xmath170 is hyperbolic relative to @xmath19 , and the subgroup @xmath156 provides a counterexample .",
    "note that @xmath171 , so applying lemma [ eg ] ( c ) yields the correct result .",
    "[ [ finite - normal - subgroups ] ] * finite normal subgroups * + + + + + + + + + + + + + + + + + + + + + + + + +    the following result was proved in ( * ? ? ?",
    "* lemma 3.3 ) .",
    "[ eh ] let @xmath19 be a non - elementary subgroup of a relatively hyperbolic group @xmath1 .",
    "suppose that @xmath172 .",
    "then the subgroup @xmath173 is the ( unique ) maximal finite subgroup of @xmath1 normalized by @xmath19 .",
    "[ kg ] let @xmath1 be a relatively hyperbolic group .",
    "then @xmath1 possesses a unique maximal finite normal subgroup @xmath21 .",
    "if @xmath1 is finite then the statement is trivial .",
    "if @xmath1 contains an infinite normal cyclic subgroup @xmath133 of finite index , then denote by @xmath66 the union of all finite normal subgroups of @xmath1 .",
    "it is easy to see that @xmath66 is a torsion normal subgroup of @xmath1 ( because a product of two finite normal subgroups is itself a finite normal subgroup ) .",
    "since @xmath174 , @xmath66 injects into the finite quotient @xmath175 , hence @xmath66 is finite .    finally ,",
    "if @xmath1 is non - elementary , then @xmath176 by ( * ? ?",
    "4.5 ) ( if @xmath1 is finitely generated , this also follows from @xcite and @xcite ) . it remains to apply lemma [ eh ] to the case @xmath177",
    "let @xmath1 be a relatively hyperbolic group and let @xmath19 be a non - elementary subgroup of @xmath1 containing at least one loxodromic element .",
    "we say that an element @xmath178 is @xmath19-_special _ if @xmath179 is loxodromic in @xmath1 and @xmath180 .",
    "the set of all @xmath19-special elements will be denoted by @xmath181 .",
    "note that , by definition , any @xmath182 belongs to the centralizer @xmath183 .",
    "the result below was obtained in ( * ? ? ?",
    "* lemma 3.8 ) .",
    "[ sg ] if @xmath1 is a relatively hyperbolic group and @xmath184 is a non - elementary subgroup such that @xmath185 , then @xmath181 is non - empty .",
    "special elements play a significant role in our approach to study automorphisms of relatively hyperbolic groups .",
    "they represent a useful tool that helps to deal with the technical problems which may arise when the group under consideration contains torsion .",
    "the main goal of this section is to prove the following important statement :    [ fi ] suppose that @xmath1 is a relatively hyperbolic group and @xmath184 is a non - elementary subgroup with @xmath185 .",
    "then @xmath186 is generated by the set @xmath181 .",
    "in particular , @xmath187 has finite index in @xmath19 .",
    "observe that the statement after ` in particular ' follows from the fact that the centralizer of a finite subgroup of @xmath1 , normalized by @xmath19 , necessarily has finite index in @xmath19 .",
    "we begin with some auxiliary results .",
    "let @xmath1 be a group hyperbolic relative to a family of proper subgroups @xmath111 .",
    "if @xmath1 is infinite , it always contains a loxodromic element ( * ? ? ?",
    "* corollary 4.5 ) .",
    "the next lemma provides us with a tool for constructing such elements .",
    "it was proved in ( * ? ? ?",
    "* lemma 4.4 ) .",
    "[ ah ] let @xmath1 be a group hyperbolic relative to a collection of subgroups @xmath111 .",
    "for any @xmath138 and @xmath188 , there exists a finite subset @xmath189 such that if @xmath190 , then @xmath191 is loxodromic .",
    "suppose that @xmath192 is a finite subset of @xmath1 .",
    "define @xmath193 to be the set of all words @xmath92 over the alphabet @xmath194 that have the following form : @xmath195 where @xmath196 , @xmath197 ( if @xmath198 then @xmath92 is the empty word ; if @xmath199 then @xmath200 ) , @xmath201 and @xmath202 are considered as single letters and    * @xmath203 , @xmath204 , and for each @xmath205 , there exists @xmath206 such that @xmath207 ; * if @xmath208 then @xmath209 for each @xmath210 ; * @xmath211 , @xmath205 .",
    "the statement below was proved in ( * ? ? ?",
    "* lemmas 6.3 , 6.5 ) .",
    "[ lem : conseq - conn ] there is a finite subset @xmath192 of @xmath1 such that the following holds .",
    "suppose that @xmath212 is a cycle in @xmath213 with @xmath214 .",
    "set @xmath215 .",
    "* if @xmath216 is the number of components of @xmath141 , then at least @xmath217 of components of @xmath141 are connected to components of @xmath218 ; and two distinct components of @xmath141 can not be connected to the same component of @xmath218 .",
    "similarly for @xmath218 .",
    "* for any @xmath219 there exists a constant @xmath220 such that if @xmath221 then there are @xmath222 consecutive components @xmath223 of @xmath141 and @xmath224 of @xmath225 , so that @xmath226 is connected to @xmath227 for each @xmath228 .",
    "proposition [ fi ] is an easy consequence of lemma [ lem : spec - mod ] below . in the case when @xmath1 is an ordinary word hyperbolic group it was proved in ( * ? ? ?",
    "* lemma 4.3 ) .",
    "[ lem : spec - mod ] suppose that @xmath182 and @xmath229 .",
    "then there exists @xmath230 such that @xmath231 for any @xmath232 with @xmath233 .    by part ( 3 ) of lemma [ eg ]",
    ", @xmath1 is hyperbolic relative to the collection of subgroups @xmath234 .",
    "denote @xmath235 . after adding @xmath236 and @xmath237 to the finite relative generating set of @xmath1 , if necessary",
    ", we can assume that @xmath238 .",
    "let @xmath239 and @xmath192 be the finite subsets of @xmath1 given by lemmas [ ah ] and [ lem : conseq - conn ] respectively . since @xmath43 has infinite order , there exists @xmath240 such that @xmath241 for any @xmath232 with @xmath233 .",
    "choose an arbitrary @xmath242 such that @xmath233 .",
    "by lemma [ ah ] , the element @xmath243 is loxodromic in @xmath1 .",
    "suppose that @xmath244 . by part ( 2 ) of lemma [ eg ] ,",
    "there are @xmath245 and @xmath246 such that @xmath247    let @xmath95 be the letter from @xmath248 representing @xmath249 in @xmath1 , let @xmath92 be the letter from @xmath112 representing @xmath236 , and let @xmath94 be the shortest word over the alphabet @xmath250 representing @xmath251 .",
    "set @xmath252 and @xmath253 .",
    "now we apply lemma [ lem : conseq - conn].(b ) to find the constant @xmath254 from its claim .",
    "evidently we can assume that the number @xmath255 from equation is larger than @xmath18 .",
    "consider a cycle @xmath212 in @xmath256 where @xmath257 , @xmath258 , @xmath259 , @xmath260 . by construction ,",
    "the cycle @xmath87 satisfies the assumptions of lemma [ lem : conseq - conn].(b ) , hence some components @xmath80 of @xmath141 and @xmath261 of @xmath225 must be connected in @xmath256 .",
    "that is , there is a path @xmath262 with @xmath263 , @xmath264 and @xmath265 ( see figure [ pic:1 ] ) .",
    "note that @xmath266 , @xmath267 .",
    "let @xmath268 be the subpath of @xmath141 starting at @xmath269 and ending at @xmath270 ; let @xmath271 be the subpath of @xmath218 starting at @xmath264 and ending at @xmath272 . considering the cycle @xmath273 in the case when @xmath274 we get the following equality in @xmath1 : @xmath275 similarly , in the case when @xmath276 , we get @xmath277    observe that by lemma [ eg ] , the group @xmath1 is hyperbolic relatively to @xmath278 , hence , by lemma [ maln ] , the intersection @xmath279 is finite . since @xmath43 is @xmath19-special , any finite subgroup of @xmath280",
    "is contained in @xmath281 .",
    "therefore @xmath282 .",
    "thus , whatever @xmath246 is , we always have @xmath283 , implying that @xmath284 because @xmath285 . by part ( 2 ) of lemma [ eg ] , @xmath286 and @xmath281 are both contained in @xmath287 ; consequently @xmath288 .    by lemma [ sg ] we can find an element @xmath182 .",
    "note that for any @xmath289 , the element @xmath290 is also @xmath19-special .",
    "since @xmath291 , we have @xmath292 .",
    "it is easy to see that @xmath293 , hence @xmath294 .",
    "now , if @xmath295 , then by lemma [ lem : spec - mod ] , @xmath296 for some @xmath297 .",
    "consequently , @xmath298 .",
    "our main goal here is to prove several auxiliary lemmas , which will be used in the next section to give an algebraic description of automorphisms preserving commensurability classes of elements in relatively hyperbolic groups .",
    "we begin with a definition .",
    "[ def : commensurability ] let @xmath1 be a group .",
    "two elements @xmath299 , are said to be _",
    "commensurable _ if there are @xmath300 , @xmath38 such that @xmath301 in @xmath1 . if the elements @xmath236 and @xmath251 are commensurable in @xmath1 , we will write @xmath302 ; otherwise , we will write @xmath303 .    [ rem : lox - comm ] obviously any two elements of finite order are commensurable .",
    "further , if @xmath43 and @xmath179 are commensurable elements of a relatively hyperbolic group @xmath1 and @xmath43 is loxodromic , then @xmath179 is loxodromic too .",
    "indeed , evidently @xmath179 has infinite order .",
    "suppose that @xmath179 is parabolic .",
    "since @xmath304 , there are @xmath305 , @xmath306 and @xmath245 such that @xmath307 . since @xmath43 is loxodromic , @xmath308 and the intersection @xmath309 contains an infinite order element @xmath310 .",
    "the latter contradicts claim ( 2 ) of lemma [ maln ] .    throughout the rest of this section",
    ", @xmath1 will denote a group hyperbolic relative to a collection of peripheral subgroups @xmath111 , and @xmath184 will denote a non - elementary subgroup with @xmath311 .    [",
    "lem : non - comm ] let @xmath41 be a loxodromic element and @xmath312 . for any finite subset @xmath313 of @xmath1",
    "there is @xmath314 such that @xmath315 is loxodromic and is not commensurable with any @xmath316 whenever @xmath317 .    in view of lemma [ eg].(3 )",
    ", we can assume that @xmath280 belongs to the family of peripheral subgroups @xmath111 of @xmath1 and each infinite order element @xmath316 is parabolic .",
    "now we can apply lemma [ ah ] , to find @xmath314 such that for any @xmath232 with @xmath318 , the element @xmath319 is loxodromic .",
    "therefore , so is @xmath320 .",
    "suppose that @xmath179 is commensurable with some @xmath316",
    ". then @xmath251 must also be loxodromic ( by remark [ rem : lox - comm ] ) , which contradicts our assumption above .",
    "[ lem : general ] let @xmath321 , @xmath322 , be a finite set of pairwise non - commensurable loxodromic elements in a relatively hyperbolic group @xmath1 . for any finite subset @xmath323",
    "there exists @xmath324 such that for any permutation @xmath325 of @xmath326 and arbitrary elements @xmath327 , @xmath328 , of infinite order , the following hold .    *",
    "the element @xmath329 is loxodromic for any @xmath330 and @xmath331 with @xmath332 , @xmath328 . *",
    "suppose that @xmath333 is conjugate to @xmath334 in @xmath1 , for some @xmath330 , @xmath335 , @xmath336 , @xmath332 , @xmath337 for all @xmath328 .",
    "then @xmath338 , there is @xmath339 such that @xmath325 is a cyclic shift by @xmath128 , that is @xmath340 for all @xmath341 , and @xmath342 when @xmath343 , @xmath344 .    by lemma [ eg ] and because @xmath345 when @xmath346 , @xmath1 is hyperbolic relative to the extended collection of subgroups @xmath347",
    "also , the finite relative generating set @xmath112 can be replaced by the bigger finite set @xmath348 retaining the relative hyperbolicity of @xmath1 .",
    "denote @xmath349 .",
    "let @xmath192 be the finite subset of @xmath1 given by lemma [ lem : conseq - conn ] .",
    "take any @xmath350 . by part ( 1 ) of lemma [ eg ]",
    ", we have @xmath351 , hence any infinite order element @xmath352 belongs to the elementary subgroup @xmath353 clearly , the center of @xmath354 has finite index in it , hence all finite order elements of @xmath355 form the maximal torsion subgroup @xmath356 .",
    "let @xmath357 be the natural epimorphism .",
    "the image @xmath358 is infinite cyclic ( because it is virtually cyclic and torsion - free ) , therefore there exists @xmath359 such that for every non - trivial element @xmath360 , one has @xmath361 whenever @xmath362 , where @xmath363 is a finite subset of @xmath358 .",
    "set @xmath364 . by construction , for every @xmath365 and each infinite order element @xmath352 , we have @xmath366 whenever @xmath367",
    ".    choose any elements @xmath330 and integers @xmath368 with @xmath332 , @xmath369 .",
    "let @xmath370 and @xmath371 be the letters from @xmath248 and from @xmath372 representing the elements @xmath373 and @xmath374 , @xmath369 , respectively .",
    "proving claim ( i ) by contradiction , suppose that the element @xmath43 is not loxodromic .    if @xmath43 has finite order @xmath375 , then set @xmath376 , @xmath253 and choose @xmath254 according to lemma [ lem : conseq - conn].(b ) . in the cayley graph",
    "@xmath377 consider the cycle @xmath212 , where @xmath378 , and @xmath379 and @xmath218 are trivial paths consisting of single vertex @xmath380 .",
    "since @xmath381 , it follows from lemma [ lem : conseq - conn].(b ) that some component of @xmath141 must be connected to a component of @xmath225 .",
    "but @xmath225 has no components at all .",
    "a contradiction .",
    "therefore @xmath43 must have infinite order and must be parabolic , i.e. , @xmath382 for some @xmath383 and @xmath384 .",
    "let @xmath385 , @xmath386 and @xmath254 be given by lemma [ lem : conseq - conn].(b ) .",
    "since @xmath179 has infinite order ( as a conjugate of @xmath43 ) , there is @xmath297 such that @xmath387 and @xmath388 .",
    "choose a shortest word @xmath389 over @xmath390 representing @xmath391 in @xmath1 , and let @xmath94 be the letter from @xmath248 corresponding to @xmath392 .",
    "consider a cycle @xmath212 in @xmath377 such that @xmath393 , @xmath394 , @xmath395 , @xmath396 , @xmath397 , @xmath398 , @xmath399 .",
    "since @xmath400 , @xmath401 , we can apply lemma  [ lem : conseq - conn].(b ) to @xmath87 , claiming that two distinct components of @xmath141 must be connected to two distinct components of @xmath225 .",
    "but @xmath225 has only one component by definition .",
    "this contradiction concludes the proof of claim ( i ) .    to establish claim ( ii ) ,",
    "assume that @xmath402 in @xmath1 , for some infinite order elements @xmath327 , @xmath403 , @xmath335 , @xmath336 , @xmath332 , @xmath337 for @xmath328 .",
    "then for every @xmath404 we have @xmath405 let @xmath370 and @xmath371 be as before .",
    "choose a letter @xmath406 from @xmath248 corresponding to @xmath407 , @xmath369 , and a shortest word @xmath408 over @xmath390 representing @xmath409 in @xmath1 .",
    "set @xmath410 , @xmath411 and let @xmath412 be the constant given by lemma [ lem : conseq - conn].(b ) . take @xmath404 so that @xmath413 and @xmath414 .    in the cayley graph",
    "@xmath377 equation gives rise to a cycle @xmath212 , in which @xmath415 , @xmath394 , @xmath416 , @xmath396 , @xmath417 , @xmath398 , @xmath418 .    by construction ,",
    "the paths @xmath141 and @xmath218 have exactly @xmath419 and @xmath420 components respectively .",
    "suppose that @xmath421 .",
    "by lemma [ lem : conseq - conn].(a ) , at least @xmath422 components of @xmath141 must be connected to components of @xmath218 , hence two distinct components of @xmath141 will have to be connected to the same component of @xmath218 , contradicting lemma [ lem : conseq - conn].(a )",
    ". hence @xmath423 .",
    "a symmetric argument shows that @xmath424 .",
    "consequently @xmath338 .",
    "since @xmath425 , we can apply lemma [ lem : conseq - conn].(b ) to find @xmath426 consecutive components of @xmath141 that are connected to @xmath426 consecutive components of @xmath225 .",
    "therefore there are consecutive components @xmath427 of @xmath141 and @xmath428 of @xmath225 such that @xmath429 is connected to @xmath430 for each @xmath431 , and @xmath432 for @xmath369 , @xmath433 ( figure [ pic:2 ] ) .",
    "therefore @xmath434 , @xmath369 , @xmath435 . from the form of @xmath436",
    "it follows that there is @xmath437 such that @xmath438 for @xmath439 ( indices at @xmath94 are taken modulo @xmath216 ) .",
    "thus @xmath440 . on the other hand",
    ", @xmath441 has infinite order .",
    "hence the intersection @xmath442 must be infinite , which yields ( by lemma [ maln ] ) that @xmath443 for all @xmath431 .",
    "therefore @xmath325 is a cyclic shift ( by @xmath444 ) of @xmath445 .",
    "the subpath @xmath446 of @xmath225 between @xmath447 and @xmath448 is labelled by @xmath449 . as we showed , the vertex @xmath450 is connected to @xmath451 by a path @xmath452 with @xmath453 , and to @xmath454 by a path @xmath455 with @xmath456 , @xmath457 ( here we use the convention that @xmath458 ) . considering the cycle @xmath459 we achieve the desired inclusion : @xmath460 , @xmath369 .",
    "this concludes the proof .",
    "[ lem : prod_of_three ] suppose that @xmath461 is a homomorphism such that @xmath462 for all @xmath463 .",
    "then for any @xmath464 , satisfying @xmath465 for @xmath346 , there exists @xmath466 such that for arbitrary @xmath467 , with @xmath468 , @xmath469 , and for @xmath470 , one has @xmath471 and @xmath472 , for some @xmath473 and @xmath474 .    according to the assumptions , there exist @xmath475 and @xmath476 such that @xmath477 , @xmath469 .",
    "denote @xmath478 , @xmath469 .",
    "then @xmath479 , hence @xmath480 ( by part ( 2 ) of lemma [ eg ] ) and @xmath201 has infinite order , @xmath469 .",
    "set @xmath481 , @xmath482 and @xmath483 , and let @xmath466 be the number @xmath484 from the claim of lemma [ lem : general ] applied to the set of loxodromic elements @xmath485 and the finite set @xmath486 . take any @xmath487 with @xmath468 , @xmath469 . by part ( i ) of lemma [ lem : general ] , @xmath488 .",
    "hence there are @xmath489 and @xmath473 such that @xmath490 .",
    "since @xmath40 is a homomorphism , we get @xmath491 @xmath492    without loss of generality we can assume that @xmath493 .",
    "suppose that @xmath494 .",
    "then @xmath495 is conjugate to @xmath496 in @xmath1 and @xmath497 .",
    "applying part ( ii ) of lemma [ lem : general ] to this situation , we get a contradiction with the fact that the transposition @xmath498 is not a cyclic shift of @xmath499 .",
    "therefore , @xmath500 and we can apply part ( ii ) of lemma [ lem : general ] to , achieving the required equality @xmath338 .    [",
    "lem : first_step ] let @xmath501 be non - commensurable loxodromic elements and let @xmath502 .",
    "there exists @xmath503 such that the following holds .",
    "suppose that @xmath504 for some integers @xmath505 with @xmath506",
    ". then @xmath507 and @xmath508 .",
    "choose @xmath509 to be the number @xmath484 arising after an application of lemma [ lem : general ] to @xmath510 and @xmath511 .",
    "choose any @xmath512 satisfying @xmath506 .",
    "assume that there is @xmath473 , @xmath474 and @xmath513 for which @xmath514 . if @xmath500 then the statement immediately follows from part ( ii ) of lemma [ lem : general ] .",
    "so , suppose that @xmath515 .",
    "then @xmath516 and @xmath517 is conjugate to @xmath518 in @xmath1 .",
    "again , by part ( ii ) of lemma [ lem : general ] , @xmath507 , @xmath508 .",
    "[ lem : spec - image ] assume that @xmath182 and @xmath519 is a homomorphism satisfying @xmath520 for some @xmath297 and @xmath521 .",
    "then there is @xmath522 such that @xmath523 .    after replacing @xmath524 with @xmath525",
    ", we can further assume that @xmath526 , because @xmath527 .",
    "now , note that @xmath528 , hence @xmath529 by part ( 2 ) of lemma [ eg ] .",
    "since @xmath43 is @xmath19-special , there is @xmath530 and @xmath522 such that @xmath531 .",
    "denote @xmath532 .",
    "then @xmath533 , implying that @xmath534 , as required .    [",
    "lem : lox_non - comm ] suppose that for an automorphism @xmath535 there is @xmath471 satisfying @xmath536",
    ". then there exists an element @xmath537 such that both @xmath391 and @xmath538 are loxodromic in @xmath1 and @xmath539 .",
    "if @xmath540 , there is nothing to prove .",
    "thus , we can assume that @xmath541 is parabolic in @xmath1 , i.e. , there exists a peripheral subgroup @xmath542 and elements @xmath543 , @xmath544 such that @xmath545 .",
    "denote @xmath546 .",
    "if @xmath547 , then @xmath548 is infinite ( by lemma [ eg].(b ) ) , hence @xmath549 is infinite . thus @xmath550 is infinite , which implies , by lemma [ maln ] , that @xmath551 , contradicting the loxodromicity of @xmath43 .",
    "therefore @xmath552 .",
    "since both @xmath43 and @xmath541 have infinite order and @xmath553 , we can apply lemmas [ lem : non - comm ] and [ ah ] to find @xmath554 such that for any integer @xmath555 , the elements @xmath315 and @xmath556 are loxodromic in @xmath1 .",
    "note that @xmath557 .",
    "suppose , first , that @xmath558 by lemma [ eg ] , @xmath1 is hyperbolic relative to @xmath234 . without loss of generality , we can also assume that @xmath236 and @xmath251 belong to the finite relative generating set @xmath112 of @xmath1 .",
    "let @xmath559 be the finite set from lemma [ lem : conseq - conn ] .",
    "evidently there is an integer @xmath555 such that @xmath560 .",
    "our assumption implies that there is @xmath403 , @xmath561 such that @xmath562 .",
    "choose a word @xmath408 in the alphabet @xmath563 representing @xmath409 in @xmath1 , where @xmath564 , and let @xmath565 , @xmath566 , @xmath567 be the letters corresponding to @xmath568 respectively .",
    "set @xmath253 , @xmath410 and let @xmath254 be the constant provided by part ( b ) of lemma [ lem : conseq - conn ] . without loss of generality we can assume that @xmath569 .    consider a cycle @xmath212 in the cayley graph @xmath570 , where @xmath571 , @xmath269 , @xmath572 , @xmath573 , @xmath574 , @xmath575 and @xmath576 .",
    "it is easy to see that @xmath87 satisfies all the conditions of lemma [ lem : conseq - conn ] , hence some component of @xmath141 must be connected to a component of @xmath225 in @xmath570 .",
    "however , according to the construction , @xmath141 has only @xmath280-components , and @xmath225 has only @xmath542-components .",
    "thus the assumption yields a contradiction .",
    "hence , there exists @xmath555 such that for the element @xmath577 we have @xmath578 , @xmath579 and @xmath539 .",
    "the purpose of this section is to study automorphisms of relatively hyperbolic groups preserving commensurability classes . recall that @xmath106 denotes the normalizer of a subgroup @xmath19 in a group @xmath1 .",
    "further , let @xmath19 be a non - elementary subgroup of a relatively hyperbolic group @xmath1 such that @xmath185 .",
    "we denote by @xmath580 the product @xmath581 .",
    "this is clearly a subgroup of @xmath1 .",
    "[ thm : comm - aut ] let @xmath1 be a relatively hyperbolic group , let @xmath184 be a non - elementary subgroup and let @xmath582 .",
    "suppose that @xmath172 and @xmath583 for every @xmath584 .",
    "then there is a set map @xmath585 , whose restriction to @xmath183 is a homomorphism , and an element @xmath586 such that for every @xmath587 , @xmath588 .    below is them main technical lemma of this section .",
    "it demonstrates how to construct the element @xmath589 and the restriction of the map @xmath590 to @xmath183 from the statement of theorem [ thm : comm - aut ] .",
    "[ lem : comm - aut - centralizer ] suppose that @xmath1 is a relatively hyperbolic group , @xmath184 is a non - elementary subgroup and @xmath582 .",
    "assume that @xmath172 and @xmath583 for every @xmath584 .",
    "then there is a homomorphism @xmath591 and an element @xmath49 such that for every @xmath592 , @xmath593 .    by lemma [ sg ]",
    ", @xmath19 contains an @xmath19-special element @xmath594 . since @xmath19 is non - elementary and @xmath183 has finite index in it , @xmath183 is also non - elementary .",
    "the subgroup @xmath595 is elementary ( by part ( 1 ) of lemma [ eg ] ) , thus there is an element @xmath596 . by lemma [ lem : non - comm ] , there is @xmath597 such that @xmath598 is loxodromic and @xmath599 . using the same lemma again we can find @xmath600 such that @xmath601 is loxodromic and @xmath602 , @xmath603 .",
    "in particular , @xmath604 .    choose @xmath466 according to an application of lemma [ lem : prod_of_three ] to @xmath40 , @xmath605 , and let @xmath606 . by lemma [ lem : non - comm ] , there is @xmath607 such that @xmath608 is not commensurable with @xmath594 in @xmath1 .",
    "therefore @xmath609 , and by lemma [ lem : spec - mod ] there is @xmath230 such that the element @xmath610 is @xmath19-special for any @xmath611 . denote @xmath612 and apply lemma [ lem : non - comm ] to find @xmath245 such that the elements @xmath613 and @xmath614 are not commensurable with each other in @xmath1 . in view of lemma [ lem : prod_of_three ]",
    "one can conclude that the elements @xmath615 are @xmath19-special and there exist @xmath616 , @xmath617 such that @xmath618 , @xmath619 .",
    "let @xmath620 be the monomorphism , defined by @xmath621 for all @xmath587 .",
    "then @xmath622 , @xmath623 .",
    "note that @xmath624 for every @xmath463 . by part ( i ) of lemma [ lem : general ] , @xmath625 for every sufficiently large @xmath626 .",
    "therefore @xmath627 consequently , by lemma [ lem : first_step ] , @xmath628 , thus @xmath629 for some @xmath630 , @xmath522 .",
    "hence @xmath631 because @xmath632 .",
    "denote @xmath633 and let @xmath519 be the monomorphism defined by the formula @xmath634 for all @xmath178 . by construction , we have @xmath635    choose any element @xmath182 .",
    "we will show that there is @xmath522 such that @xmath523 .    if @xmath636 then there is @xmath297 such that @xmath637 because @xmath638 .",
    "hence @xmath639 and by lemma [ lem : spec - image ] , @xmath523 for some @xmath522 .",
    "suppose , now , that @xmath640 .",
    "since @xmath641 and @xmath391 is @xmath19-special , we can use lemmas [ lem : spec - mod ] and [ lem : non - comm ] to find @xmath642 such that the element @xmath643 is @xmath19-special and is not commensurable with @xmath391 and @xmath409 in @xmath1 .",
    "arguing as in the beginning of the proof ( using lemmas [ lem : spec - mod ] , [ lem : non - comm ] and [ lem : prod_of_three ] ) we can find @xmath644 such that @xmath645 , @xmath646 , @xmath647 and @xmath648 for some @xmath474 and @xmath473 .    by part ( i ) of lemma [ lem : general ] , @xmath649 for every sufficiently large @xmath626 .",
    "hence @xmath650 whenever @xmath128 is sufficiently large .",
    "applying lemma [ lem : first_step ] we see that @xmath651 . as before , this implies that @xmath652 for some @xmath653 .    similarly , there is @xmath654 such that @xmath655 .",
    "hence @xmath656 , yielding that @xmath657 .",
    "suppose that @xmath658 and @xmath659 .",
    "then the element @xmath660 must have infinite order ( otherwise we would have @xmath661 since @xmath145 is @xmath19-special , hence @xmath662 contradicting to @xmath663 ) .",
    "this implies that @xmath664 for some @xmath665 and @xmath666 .",
    "recalling , we can apply lemma [ lem : spec - image ] to find @xmath667 such that @xmath668 and @xmath669 .",
    "since @xmath615 we obtain @xmath670 then for @xmath671 we get @xmath672 , implying that @xmath673 , which contradicts to @xmath674 .    therefore either @xmath675 or @xmath676 , thus @xmath677 . by lemma [ lem : spec - image ] , there is @xmath678 such that @xmath679 . since @xmath680 , we can use to get @xmath681 . applying lemma [ lem : spec - image ] again , we find @xmath682 such that @xmath683 .",
    "finally , since @xmath643 , in view of we achieve @xmath684 , as needed .",
    "to finish the proof , we observe that by proposition [ fi ] , @xmath183 is generated by @xmath181 , therefore for each @xmath685 there is @xmath686 such that @xmath687 .",
    "since @xmath688 is a homomorphism , the map @xmath689 will be a homomorphism too . by construction",
    ", we have @xmath690 .",
    "now we are ready to prove the main result of this section .",
    "let @xmath49 and @xmath689 be as in the claim of lemma [ lem : comm - aut - centralizer ] .",
    "let @xmath691 be the monomorphism that is defined according to the formula @xmath692 for all @xmath587 .",
    "denote @xmath693 , @xmath694 and @xmath695 .    since @xmath183 is a normal subgroup of @xmath19 , for any @xmath696 we have @xmath697 and @xmath698 .",
    "fix an arbitrary @xmath587 . for any @xmath471",
    "we see that @xmath699 , therefore @xmath700 , implying that @xmath701 .",
    "thus , @xmath702 . after defining @xmath703 for each @xmath587 , one immediately sees that @xmath704 is a map with the required properties .",
    "obviously , the restriction of @xmath590 to @xmath183 coincides with @xmath705 .",
    "it remains to prove that @xmath706 .",
    "we will first show that @xmath707 .",
    "consider any element @xmath522 . since @xmath40 is an automorphism of @xmath19 , for any @xmath471",
    "there is @xmath587 such that @xmath708 . then @xmath709 and @xmath710 because @xmath711 .",
    "now we observe that @xmath712 hence , @xmath713 for every @xmath471 ; consequently @xmath714 .",
    "the latter implies that @xmath715 and since @xmath281 is finite , we conclude that @xmath707 .",
    "now , for any @xmath587 we have @xmath716 thus @xmath717 .",
    "since @xmath718 and @xmath582 , one gets @xmath719 . therefore @xmath720 , @xmath721 , i.e. , @xmath706 .",
    "we are now in a position to prove corollary [ cor : descr_comm_aut ] mentioned in the introduction .",
    "we establish it in a more general form :    [ cor : comm_aut_def ] let @xmath1 be a non - elementary relatively hyperbolic group and @xmath36 .",
    "the following conditions are equivalent :    1 .",
    "@xmath47 is commensurating ; 2 .",
    "@xmath722 for every loxodromic @xmath28 ; 3 .",
    "there is a set map @xmath48 , whose restriction to @xmath22 is a homomorphism , and an element @xmath49 such that for every @xmath41 , @xmath50 .",
    "in particular , if @xmath51 , then every commensurating automorphism of @xmath1 is inner .",
    "\\(a ) implies ( b ) by definition , and ( b ) implies ( c ) by theorem [ thm : comm - aut ] .",
    "it remains to show that ( c ) implies ( a ) .",
    "indeed , let @xmath43 be an arbitrary element of @xmath1 , and let the automorphism @xmath47 satisfy ( c ) . if @xmath43 is of finite order , then so is @xmath42 , and in this case evidently @xmath722 .",
    "thus , we can suppose that @xmath43 has infinite order in @xmath1 .",
    "by our assumptions , @xmath723 for some @xmath24 and @xmath724 .",
    "since @xmath21 is finite and normal in @xmath1 , @xmath725 has finite index in the subgroup @xmath726 .",
    "hence there exists a non - zero integer @xmath128 such that @xmath727 for some @xmath728 . and",
    "since the order of @xmath729 is infinite , we can conclude that @xmath730 .",
    "therefore @xmath731 is commensurable with @xmath43 in @xmath1 .",
    "thus @xmath47 in commensurating .",
    "recall that a result of metaftsis and sykiotis ( * ? ? ?",
    "* lemma @xmath732 ) states that for any relatively hyperbolic group @xmath1 , one has @xmath733 , where @xmath734 is the group of all _ pointwise inner automorphisms _ of @xmath1 .",
    "theorem [ thm : comm - aut ] allows one to generalize their result to all non - elementary subgroups :    [ cor : conj_aut ] suppose that @xmath19 is a non - elementary subgroup of a relatively hyperbolic group @xmath1 , with @xmath735 . then @xmath736 . if , in addition , @xmath737 , then @xmath738 .    by theorem",
    "[ thm : comm - aut ] , for any automorphism @xmath739 , there exist @xmath49 and a map @xmath704 such that @xmath740 for each @xmath587 .",
    "take any element @xmath741",
    ". then @xmath179 commutes with @xmath742 , and , consequently , @xmath743 where @xmath744 .",
    "now , since @xmath40 is a pointwise inner automorphism of @xmath19 , there is @xmath745 such that @xmath746 .",
    "hence @xmath747 , i.e. , @xmath748 .",
    "thus @xmath749 for some @xmath750 and @xmath521 , and @xmath751 because @xmath179 is @xmath19-special .",
    "consequently , we have @xmath752 , which implies that @xmath753 .",
    "since the latter holds for any @xmath741 , it follows from proposition [ fi ] that @xmath754 , where @xmath755 .",
    "note that @xmath756 , hence there are @xmath757 such that @xmath758 . for any @xmath759",
    "there are @xmath760 and @xmath761 such that @xmath762 .",
    "one has @xmath763 hence @xmath764 , i.e. , the map @xmath590 is uniquely determined by the images of @xmath765 .",
    "thus , @xmath766 , implying that the automorphism @xmath739 , up to composition with an inner automorphism of @xmath19 , is completely determined by the finite collection of elements @xmath767 , and since @xmath281 is finite , we can conclude that @xmath736 .",
    "now , if @xmath737 we obtain @xmath768 and @xmath769 for all @xmath759 , that is @xmath770 .",
    "in the context of relatively hyperbolic groups , the algebraic analogue of dehn filling is defined as follows .",
    "suppose that @xmath111 is a collection of ( peripheral ) subgroups of a group @xmath1 .",
    "to each collection @xmath771 , where @xmath772 is a normal subgroup of @xmath113 , we associate the quotient - group @xmath773    [ def : periph_fill ] let @xmath1 and @xmath111 be as described above .",
    "we say that some assertion holds for _ most peripheral fillings of @xmath1 _ , if there exists a finite subset @xmath239 of non - trivial elements of @xmath1 such that the assertion holds for @xmath774 for any collection @xmath775 of normal subgroups @xmath776 satisfying @xmath777 for all @xmath138 .",
    "the theorem below was proved in @xcite . in the particular case",
    "when @xmath1 is torsion - free , this theorem was independently proved in @xcite .",
    "[ fill ] suppose that a group @xmath1 is hyperbolic relative to a collection of subgroups @xmath111 .",
    "then for most peripheral fillings of @xmath1 , the following holds .    1 .   for each @xmath778 ,",
    "the natural map @xmath779 is injective .",
    "the quotient - group @xmath774 is hyperbolic relative to the collection @xmath780 .",
    "the following statement plays a key role in our paper .",
    "[ conj ] let @xmath1 be a relatively hyperbolic group , @xmath19  a subgroup of @xmath1 and @xmath535 .",
    "suppose that there exists a loxodromic element @xmath781 such that @xmath782 is not conjugate to an element of @xmath280 in @xmath1 .",
    "then @xmath783 does not preserve some normal subgroup of @xmath19 .",
    "suppose that @xmath1 is hyperbolic relatively to @xmath111 .",
    "there are two cases to consider .",
    "* assume first that @xmath784 is loxodromic .",
    "using lemma [ eg ] twice we obtain that @xmath1 is hyperbolic relatively to @xmath785 .",
    "since @xmath725 has finite index in @xmath280 , there is @xmath786 such that @xmath787 ( and each of its subgroups ) is normal in @xmath280 .",
    "let @xmath239 be the finite set provided by theorem [ fill ] for the peripheral system @xmath788 .",
    "taking @xmath80 to be a sufficiently large multiple of @xmath255 , we can ensure the condition @xmath789 .",
    "we now consider the filling of @xmath1 with respect to the collection of subgroups @xmath790 consisting of the trivial subgroups of @xmath542 s , the trivial subgroup of @xmath791 , and @xmath792 . by theorem [ fill ] elements @xmath43 and @xmath782 have orders @xmath80 and @xmath793 , respectively , in @xmath794 .",
    "hence @xmath783 does not induce an automorphism on the natural image of @xmath19 in @xmath795 , i.e. , it does not preserve @xmath796 .    * case 2 .",
    "* now suppose that @xmath784 is parabolic , i.e. , it is conjugate to an element of some peripheral subgroup @xmath113 . again , by lemma [ eg ] , @xmath1 is hyperbolic relatively to @xmath797 .",
    "the rest of the proof is identical to that in case 1 .",
    "the only difference is that theorem [ fill ] is applied to the collection of subgroups @xmath790 consisting of trivial subgroups of @xmath542 s and @xmath792 for some @xmath798 .",
    "theorem [ main ] is a particular case of the following result .",
    "( recall that @xmath799 . )",
    "[ normautsubgr ] let @xmath1 be a relatively hyperbolic group and let @xmath184 be a non - elementary subgroup such that @xmath172 .",
    "then for any @xmath800 there exists a map @xmath585 , whose restriction to @xmath183 is trivial , and an element @xmath801 such that for every @xmath587 , @xmath802 .    by lemma [ conj ] , @xmath47 maps every loxodromic element @xmath178 to a conjugate of an element of @xmath803 .",
    "as @xmath804 has finite index in @xmath803 , every element of infinite order in @xmath803 is commensurable with @xmath179 in @xmath1 . in particular , @xmath583 for every @xmath584 .",
    "hence by theorem [ thm : comm - aut ] there is a map @xmath585 , whose restriction to @xmath183 is a homomorphism , and an element @xmath586 such that for every @xmath587 , @xmath805 .",
    "it remains to show that @xmath753 for every @xmath806 .    by proposition [ fi ] , it suffices to show that @xmath753 for all @xmath807 .",
    "suppose that @xmath808 for some @xmath809 .",
    "take any integer @xmath810 , where @xmath811 denotes the ( finite ) order of @xmath812 in @xmath1 . note that @xmath179 commutes with @xmath812 as @xmath807 .",
    "thus @xmath813 .",
    "since @xmath40 should preserve @xmath814 , we obtain @xmath815 . on the other hand , @xmath816 . by lemma [ eg ]",
    "we can join @xmath803 to the collection of the peripheral subgroups . without loss of generality",
    "we may assume that @xmath817 so that the normal subgroup @xmath818 of @xmath803 satisfies the requirement @xmath819 from theorem [ fill ] ( and definition [ def : periph_fill ] ) .",
    "then by the first part of theorem [ fill ] we have @xmath820 .",
    "hence @xmath821 , which contradicts @xmath822 .",
    "[ outn ] let @xmath19 be a non - elementary subgroup of a relatively hyperbolic group @xmath1 such that @xmath172 .",
    "then the following hold .    1 .",
    "if @xmath19 has finite index in @xmath823 , then @xmath824 is finite .",
    "2 .   if @xmath19 does not normalize any non - trivial finite subgroup of @xmath1 , and @xmath825 , then @xmath826 .",
    "the argument is similar to the one used to prove corollary [ cor : conj_aut ] .",
    "observe that by lemma [ eh ] , @xmath281 is a finite subgroup of @xmath1 normalized by @xmath19 .",
    "therefore @xmath19 acts on @xmath281 by conjugation , and @xmath827 has a finite index in @xmath19 as a kernel of this action .",
    "let @xmath828 be elements of @xmath19 such that @xmath758 . by theorem [ normautsubgr ]",
    "we can argue as in the proof of corollary [ cor : conj_aut ] to conclude that every normal automorphism @xmath40 of @xmath19 is uniquely determined by the images @xmath829 of @xmath201 , @xmath830 , and by the conjugating element @xmath706 . as @xmath281 is finite , for each @xmath365 there are only finitely many possibilities for @xmath829 , and since @xmath831 , we can deduce that @xmath832 .",
    "furthermore , if @xmath825 and @xmath19 does not normalize any finite normal subgroup of @xmath1 , we obtain @xmath737 , @xmath833 , and @xmath834 .",
    "hence @xmath835 by theorem [ normautsubgr ] .",
    "this completes the proof .",
    "the next lemma shows that corollary [ cor1 ] holds for elementary groups .",
    "[ vc ] let @xmath1 be a virtually cyclic group .",
    "then @xmath5 is finite .",
    "if @xmath1 is finite the claim is trivial , so assume that @xmath1 is infinite . recall that every elementary group is ether finite - by - cyclic or finite - by-(infinite dihedral ) ( see , for example , ( * ? ? ?",
    "* lemma 2.5 ) ) .",
    "more precisely , as @xmath1 is infinite , the quotient @xmath836 ( where @xmath21 is the maximal finite normal subgroup of @xmath1 given by corollary [ kg ] ) is either infinite cyclic or infinite dihedral . in both cases we have",
    "@xmath837    every automorphism @xmath838 induces an automorphism @xmath839 .",
    "this gives rise to a homomorphism @xmath840 .",
    "if @xmath841 , then for every @xmath842 there is @xmath843 such that @xmath844 . by our assumptions , @xmath1 is generated by a finite set of elements @xmath845 and the automorphism @xmath0 is uniquely determined by the images @xmath846 , @xmath847 . since @xmath848 , for each @xmath365 there are only finitely many possibilities for @xmath849 .",
    "therefore the kernel of @xmath850 is finite .",
    "evidently @xmath851 , and by we get @xmath852 yielding that @xmath853 .",
    "let us apply theorem [ normautsubgr ] to the case @xmath177 .",
    "then @xmath854 , @xmath855 , @xmath856 , and the claim of theorem [ main ] follows immediately .",
    "first , suppose that @xmath1 is elementary . in this case the first part of the corollary follows from lemma [ vc ] .",
    "to derive the second claim of the corollary , we observe that since @xmath1 is non - cyclic and does not have non - trivial finite normal subgroups , it must be infinite dihedral ( this follows from the structure of an elementary group  see the proof of lemma [ vc ] ) .",
    "hence @xmath857 and , by neshchadim s theorem @xcite , @xmath858 .",
    "thus we may assume that @xmath1 is non - elementary .",
    "in this case the corollary follows from theorem [ main ] in the same way as corollary [ outn ] from theorem [ normautsubgr ] .",
    "alternatively it follows immediately from corollary [ outn ] applied to the case when @xmath177 .",
    "in order to prove theorem [ fp ] we need two more statements below .",
    "[ noncom ] assume that @xmath1 is a relatively hyperbolic group and @xmath859 are two non - commensurable loxodromic elements",
    ". then @xmath43 and @xmath179 are non - commensurable and loxodromic in most peripheral fillings of @xmath1 .",
    "suppose that @xmath1 is hyperbolic relative to a collection of subgroups @xmath111 . applying lemma [ eg ]",
    "twice we obtain that @xmath1 is hyperbolic relative to the new collection @xmath860 , where @xmath861 , @xmath862 .",
    "let @xmath863 and @xmath864 be the finite subsets provided by theorem [ fill ] for the collections of peripheral subgroups @xmath111 and @xmath860 , respectively . set @xmath865 .",
    "consider any collection of subgroups @xmath866 such that @xmath867 , @xmath305 . by theorem",
    "[ fill ] , the filling of @xmath1 with respect to the collection of normal subgroups @xmath790 , consisting of @xmath866 for @xmath138 and the trivial subgroups of @xmath868 , @xmath869 , is hyperbolic relative to @xmath870 as well as relative to @xmath871 .",
    "( we keep the same notation for the isomorphic images of @xmath872 in @xmath774 and the elements @xmath859 . )    in particular , @xmath873 is finite for every @xmath874 .",
    "clearly this implies that @xmath43 and @xmath179 are not commensurable in @xmath1 . similarly @xmath43 and @xmath179 are not conjugate to any elements of the subgroups @xmath875 , @xmath876 , of @xmath774 .",
    "thus @xmath43 and @xmath179 are loxodromic in @xmath774 with respect to the peripheral collection @xmath877 . as @xmath239 is finite , @xmath43 and @xmath179",
    "are non - commensurable and loxodromic in most peripheral fillings of @xmath1 ( with respect to the peripheral structure @xmath111 ) .",
    "the proof of theorem [ fp ] uses the following lemma , which is an immediate corollary of ( * ? ? ?",
    "* lemma 3 ) .",
    "( recall that the _ cartesian subgroup _ of a free product @xmath878 is , by definition , the kernel of the natural epimorphism @xmath879 . )",
    "[ yed ] let @xmath74 , where @xmath389 and @xmath408 are finite groups .",
    "let @xmath880 , @xmath881 be non - commensurable elements of the cartesian subgroup @xmath133 of @xmath1 .",
    "suppose that @xmath882 , @xmath883 for some positive integers @xmath884 , where @xmath391 , @xmath409 are not proper powers .",
    "assume also that @xmath885 ( respectively , @xmath886 ) is the smallest non - zero power of @xmath391 ( respectively , @xmath409 ) that belongs to @xmath133 .",
    "then there exists a finite quotient - group @xmath795 of @xmath1 such that the images of @xmath880 and @xmath881 have different orders in @xmath795 .",
    "let @xmath1 be a non - trivial free product , i.e. , @xmath74 , where both @xmath389 and @xmath408 are non - trivial .",
    "then @xmath1 is hyperbolic with respect to @xmath887 ( the finite sets @xmath112 and @xmath888 , from the definition of relative hyperbolicity in section [ sec : prelim ] , can be taken to be empty ; the isoperimetric constant @xmath133 for the corresponding relative presentation of @xmath1 will then be equal to zero ) . in what follows",
    ", we will fix this as a system of peripheral subgroups of @xmath1 .    if @xmath889 , the proof is an easy exercise .",
    "it also follows from the main result of @xcite , stating that every normal automorphism of a non - trivial free product is inner , and the observation that every non - trivial normal subgroup of the infinite dihedral group is of finite index .",
    "thus we may assume that @xmath1 is non - elementary .",
    "suppose that there exists an automorphism @xmath890 .",
    "note that @xmath891 because @xmath1 , as a non - trivial free product , can not contain non - trivial finite normal subgroups .",
    "since @xmath0 is not an inner automorphism of @xmath1 , it follows from corollary [ cor : descr_comm_aut ] that @xmath783 is not commensurating .",
    "therefore , by corollary [ cor : comm_aut_def ] and lemma [ lem : lox_non - comm ] ( applied to the case when @xmath892 ) , there is a loxodromic element @xmath28 such that @xmath893 is also loxodromic and is not commensurable with @xmath43 .",
    "further , by lemma [ noncom ] there exist finite index normal subgroups @xmath894 and @xmath895 such that the natural images @xmath896 , @xmath897 of @xmath43 and @xmath179 , respectively , are not commensurable in @xmath898 . without loss of generality",
    "we may assume that @xmath899 is non - elementary .",
    "since @xmath899 is a free product of two finite groups , it is residually finite .",
    "therefore the kernel @xmath66 of the natural homomorphism @xmath900 is an intersection of finite index normal subgroups of @xmath1 . as @xmath901 , @xmath902 stabilizes @xmath66 .",
    "hence @xmath783 induces an automorphism @xmath903 of @xmath899 .",
    "let @xmath904 , where @xmath128 is a positive integer and @xmath391 is not a proper power .",
    "clearly @xmath905 is not a proper power as well and @xmath906 .",
    "evidently @xmath907 is not commensurable to @xmath908 for any non - zero integer @xmath80 .",
    "let @xmath133 denote the cartesian subgroup of @xmath899 .",
    "then @xmath909 , and replacing @xmath896 with another positive power of @xmath391 , if necessary , we may assume that @xmath910 and @xmath904 is the smallest non - zero power of @xmath391 that belongs to @xmath133 .",
    "again , since @xmath911 , @xmath912 preserves @xmath133 . in particular , @xmath913 is the smallest power of @xmath409 that belongs to @xmath133 .",
    "by lemma [ yed ] there exists a finite index normal subgroup @xmath66 of @xmath899 such that the images of @xmath896 and @xmath897 have different orders in @xmath914 .",
    "therefore @xmath903 does not induce an automorphism on @xmath914 .",
    "obviously this means that @xmath783 does not preserve the full preimage of @xmath66 in @xmath1 , which contradicts our assumption that @xmath901 .",
    "[ outnormsub ] suppose that @xmath1 is a finitely generated group and @xmath8 is a centerless normal subgroup of finite index in @xmath1 .",
    "then some finite index subgroup of @xmath15 is isomorphic to a quotient of a subgroup of @xmath915 by a finite normal subgroup .",
    "in particular , if @xmath916 is residually finite , then @xmath15 is residually finite .        given @xmath28 , let @xmath918 be an element such that @xmath919 .",
    "then the natural map from @xmath1 to the symmetric group on the orbit of @xmath262 provides us with a finite quotient of @xmath1 , where the image of @xmath43 is non - trivial .      by stallings s theorem ( @xcite )",
    "there is a finite group @xmath58 such that @xmath1 splits as an amalgamated free product @xmath920 or an @xmath56-extension @xmath921 , where @xmath922 in the first case and @xmath923 , @xmath603 , in the second case ( where @xmath924 and @xmath925 are the two associated isomorphic copies of @xmath58 in @xmath389 ) .",
    "since @xmath1 is residually finite and @xmath58 is finite , there exists a finite index normal subgroup @xmath926 such that @xmath927 if @xmath928 , or @xmath929 for @xmath603 , if @xmath930 .",
    "note that the quotient of the bass - serre tree for @xmath1 modulo the action of @xmath8 is finite and the edge stabilizers in @xmath8 are trivial .",
    "the bass - serre structure theorem for groups acting on trees ( see @xcite ) yields a splitting of @xmath8 into a non - trivial free product .",
    "in particular , @xmath8 is centerless .",
    "the group @xmath931 naturally acts on the set @xmath917 of finite index normal subgroups of @xmath8 and @xmath932 is the kernel of this action . by theorem [ fp ] , @xmath933 .",
    "therefore , @xmath934 acts on @xmath917 faithfully .",
    "since @xmath8 is finitely generated , there are only finitely many subgroups of a given finite index in @xmath8 , thus all orbits of the action of @xmath916 on @xmath917 are finite .",
    "hence @xmath916 is residually finite by lemma [ finorb ] .",
    "the claim of the theorem is now a consequence of lemma [ outnormsub ] ."
  ],
  "abstract_text": [
    "<S> an automorphism @xmath0 of a group @xmath1 is normal if it fixes every normal subgroup of @xmath1 setwise . </S>",
    "<S> we give an algebraic description of normal automorphisms of relatively hyperbolic groups . </S>",
    "<S> in particular , we prove that for any relatively hyperbolic group @xmath1 , @xmath2 has finite index in the subgroup @xmath3 of normal automorphisms . </S>",
    "<S> if , in addition , @xmath1 is non - elementary and has no non - trivial finite normal subgroups , then @xmath4 . as an application , we show that @xmath5 is residually finite for every finitely generated residually finite group @xmath1 with more than one end . </S>"
  ]
}