{
  "article_text": [
    "the smoothed particle hydrodynamics ( sph ) numerical method was initially introduced in order to solve the equations of astrophysical flows .",
    "in the course of time it found application to the solution of equations describing a plethora of physical processes ( for its diverse applications , see @xcite ) .",
    "these processes predominantly involve continua and the equations refer to systems with infinite degrees of freedom .",
    "the central idea of the sph method is to set up a relation between the continuum and a particle system , in which the continuum is loosely considered to be the limit case in which the number of particles tends to infinity . here",
    ", the term ` particle ' should _ not _ be interpreted as a physical object of any scale ( like an atom , molecule or grain ) but rather as a numerical entity attributed with mass , position , velocity and other properties of the medium it represents .",
    "+   + it is well - established that the classical sph scheme can be derived formally by applying the _ principle of least action _ to the particle system , where the sph density approximation acts as a constraint ; see e.g.  @xcite .",
    "the importance of the particle system s lagrangian function was already recognized in the first articles describing sph ; cf .",
    "a subtlety lies in the fact that in the derivation of the sph equations , the action of the particle system is minimized rather than the action of the continuum .",
    "the minimization of the action at the continuum level and the subsequent discretization of the motion equation in terms of particles does not necessarily yield the same equation .",
    "+   + the main achievement of this paper is twofold :    * we introduce a systematic procedure for deriving measure - valued and particle formulations of continuum mechanics equations .",
    "we obtain two different schemes depending on the stage at which a regularization of the density is introduced .",
    "see section  [ sec : derivation ] .",
    "* we prove the convergence of both schemes using the wasserstein distance on the space of probability measures ; cf .",
    "section  [ sec : conv ] .",
    "we now describe the two parts of our paper in more detail . +   + in the first part ( section [ sec : derivation ] ) , we aim at clarifying the exact difference in outcome between minimizing the action of the particle system and minimizing the action at the continuum level . to achieve this ,",
    "we introduce a systematic procedure consisting of the following three steps :    1 .",
    "formulation in terms of measures and , simultaneously , the regularization of the density ; 2 .",
    "introduction of a particle formulation ; 3 .",
    "application of the principle of least action .",
    "these three steps are introduced in more detail in section [ sec : 3 proc ] .",
    "it turns out that the order in which these steps are executed , determines the equation that comes out . to be more precise ,",
    "the classical sph scheme ( as described e.g.  in @xcite ) is obtained , whenever the regularization of the density takes place before applying the principle of least action .",
    "that is , whenever the steps are executed in the order [ enum : stepa]-[enum : stepb]-[enum : stepc ] or [ enum : stepa]-[enum : stepc]-[enum : stepb ] .",
    "both procedures are presented here ; see sections [ sec : eqns motion abc ] and [ sec : eqns motion acb ] .",
    "if we apply the principle of least action ( to the action at the continuum mechanics level ) before regularizing the density then we obtain a scheme that appears in di lisio _ et al . _",
    "@xcite and also is elaborated again in the very recent paper @xcite . however , this variant of the scheme is studied far less in literature .",
    "the procedure to obtain this scheme follows the order [ enum : stepc]-[enum : stepa]-[enum : stepb ] .",
    "its distinct characteristic is that it requires the gradient of the pressure field to be expressed analytically , while the pressure itself does not appear in the numerical scheme , in contrast to the commonly used sph schemes .",
    "we underline that although both schemes arrive from the principle of least action , the latter can also be derived directly from newtonian mechanics and introduction of the density regularization .",
    "the details of our rational derivation and the mutual relation between the two schemes have , to our knowledge , never been described in literature before .",
    "+   + in any case , regularization of the density practically means that the original problem is deliberately turned into a regularized one , which is afterwards solved by means of some variant of an sph scheme .",
    "hence , by choosing sph as solution method one is automatically bound to studying a different problem than the original one at the continuum level .",
    "thus , two questions naturally rise :    * does the solution of the regularized problem converge to the solution of the original problem ?",
    "* does the particle solution of the regularized problem converge ( in a certain sense ) to the solution of the regularized continuum problem ?    the former is out of the scope of the present study ( @xcite has dealt with it ) , while the latter is the topic of the current work s second part .",
    "+   + measure theory provides a framework to study the limiting behaviour as the number of particles goes to infinity ( cf .",
    "also e.g.  @xcite ) . both the particle system , and the limiting continuum setting can be formulated in terms of measures .",
    "hence , a distance between measures is a natural tool to characterize convergence ; in this work we take the wasserstein distance on the space of probability measures .",
    "this particular distance has the advantage that it can be formulated as the _ infimum _ over a set of joint representations ( more details follow in definitions [ def : coupling ] and [ def : wass ] ) .",
    "this is convenient , since one can thus obtain an upper bound ( needed to prove convergence ! ) by choosing any admissible joint representation .",
    "see also @xcite , chapter 6 , for more discussion . +   + we prove the convergence of measure - valued solutions , as the initial measure is approximated ; cf .  section  [ sec : conv ] .",
    "the line of arguments is similar to the one followed by di lisio _ et al . _  in @xcite , who first employed measures in combination with the wasserstein distance to prove the convergence of the sph method ,",
    "but the result obtained in the present work is more general .",
    "it should be mentioned that in the earlier work @xcite convergence of the _ empirical measure _ representing the particle system was proven , but using a different technique . moreover ,",
    "the only forces considered were mutual interactions between particles .",
    "other approaches to obtain convergence are given e.g. by @xcite using maximum local entropy estimates , @xcite employing estimates for the truncation error , and @xcite .",
    "+ nonetheless , the scheme treated in @xcite is not the aforementioned traditional scheme .",
    "our proof applies both to traditional sph and to the scheme covered by @xcite .",
    "moreover we allow for a much more general class of force fields , including external and internal conservative forces , as well as friction and non - local interactions . + previous work in the framework of measures by the authors of the current paper can be found in @xcite , where apart from the aforementioned force terms also random noise is treated . in @xcite",
    "measure - valued evolutions are treated in the scope of equations of motion that are first - order in time .",
    "the link between first - order and second - order models is discussed in @xcite .",
    "+   + the theoretical result of this paper regarding the order of convergence is supported numerically in section [ sec : num ] for one and two - dimensional illustrative examples , which involve different force fields .",
    "+   + in section [ sec : concl and future ] concluding remarks are given about sections [ sec : derivation ] and [ sec : conv ] . also , some attention is given to possible future research directions .",
    "in this section we derive equations of motion from hamilton s principle of least action , which involves the lagrangian function posed in a continuum mechanics setting .",
    "we describe an explicit ` recipe ' , hence avoiding the need to introduce approximations in an _ ad hoc _ manner .",
    "this ` recipe ' consists of three building blocks ( coined [ enum : stepa ] , [ enum : stepb ] and [ enum : stepc ] ; see section [ sec : 3 proc ] ) .",
    "the order in which these blocks are executed , influences the final outcome . as such , the systematic procedure",
    "we describe here also shows exactly how different formulations / schemes arise from the same basic principles .",
    "assume that for fixed time @xmath0 a mass density @xmath1 on a spatial domain @xmath2 is given .",
    "we define the _ lagrangian density _ of our system as @xmath3 where @xmath4 and @xmath5 are independent eulerian coordinates , and @xmath6 denotes the internal energy density . to obtain the _ lagrangian _ @xmath7",
    ", we integrate @xmath8 over the spatial domain @xmath2 : @xmath9 for this integration to make sense , we assume now that @xmath5 is actually a velocity field , defined as a function of @xmath0 and @xmath4 : @xmath10 .",
    "let there be a coordinate transform @xmath11 such that @xmath12 for some initial domain @xmath13 .",
    "we call the family of transformations @xmath14 a _ motion mapping _ and transform the integral above according to @xmath15 with @xmath16 : @xmath17(t ) = { \\int_{\\omega_0}^{}\\ ! \\left(\\dfrac12 |u(t,\\phi_t(x))|^2 - e(\\rho_t(\\phi_t(x)),\\phi_t(x))\\right)\\rho_t(\\phi_t(x))\\,\\left|j\\phi_t(x)\\right| \\ , dx}.\\ ] ] the _ functional dependence _ of @xmath7 on the motion mapping is indicated by explicitly including @xmath18 in square brackets . the expression @xmath19 denotes the determinant of the jacobian matrix of the transformation , consisting of the derivatives of the components of @xmath11 with respect to the components of @xmath20 .",
    "now we assume that the density @xmath1 relates to the density @xmath21 defined on the original domain @xmath13 by the same transformation @xmath11 , which is mathematically described by a _ push - forward _",
    "definition [ def : push - forward ] ) .",
    "in particular , the densities relate in the following way ( see e.g.  @xcite , p.  90):@xmath22",
    "combined , and yield @xmath23(t ) = { \\int_{\\omega_0}^{}\\ ! \\left(\\dfrac12 |u(t,\\phi_t(x))|^2 - e(\\rho_t(\\phi_t(x)),\\phi_t(x))\\right)\\rho_0(x ) \\ , dx}.\\ ] ] in the above we fixed @xmath0 , but obviously all arguments can be repeated for every @xmath0 in some interval @xmath24 $ ] . in particular , we are interested in those motion mappings that are continuous and differentiable in time , and we wish to obtain their equation of motion .",
    "the introduction of the motion mapping @xmath25}$ ] has taken us from pure eulerian coordinates in towards lagrangian ( material ) coordinates in .",
    "the crucial and final step to complete this procedure is now to specify what the velocity field @xmath5 is . in order to remain consistent with the motion mapping we introduced , there is only one option : we should identify @xmath5 with the time derivative of @xmath11 .",
    "more precisely , we postulate the relation : @xmath26 the velocity @xmath5 at time @xmath0 at position @xmath27 is the velocity at time @xmath0 of a material point that started in @xmath20 at time @xmath28 , and  in words  means that this velocity is equal to the time derivative at time @xmath0 of the position of that particular material point . by connecting the eulerian velocity @xmath5 to the lagrangian velocity @xmath11",
    ", we obtain the lagrangian functional @xmath29(t ) = { \\int_{\\omega_0}^{}\\ ! \\left(\\dfrac12 |\\dot{\\phi}_t(x))|^2 - e(\\rho_t(\\phi_t(x)),\\phi_t(x))\\right)\\rho_0(x ) \\",
    ", dx}.\\ ] ] we define the _ action _ of our system by @xmath30 : = { \\int_{0}^{t}\\ !",
    "l[\\phi](t ) \\ , dt}.\\ ] ]      the aim of this part of our paper is to derive equations of motion from the action , by means of the euler - lagrange equations ( we will see that these appear in different shapes ) .",
    "moreover , we wish to derive these equations of motion for a particle system ( which naturally induces a numerical scheme ) . a methodological way to go from the continuum ( section [ sec : deriv action ] ) to a particle system , is via a measure - valued formulation .",
    "our motivation to do so is the fact that we need a framework that incorporates the ` real physics ' , i.c .",
    "the density @xmath1 , and an approximating particle system to establish the convergence of the particle scheme to the continuum .",
    "+   + to get the transition from the continuous action to equations of motion for the particle positions , three steps are necessary :    1 .",
    "introduction of measures : replace @xmath31 by @xmath32 and where needed approximate @xmath1 by some @xmath33 that depends on @xmath34;[enum : stepa ] 2 .   substituting for @xmath34 a discrete measure @xmath35;[enum : stepb ] 3 .",
    "derive the euler - lagrange equations ( either classically or in variational sense).[enum : stepc ]    the steps are here described in a somewhat simplistic and unprecise way ; their true meaning will become clear in sections [ sec : eqns motion abc ] , [ sec : eqns motion acb ] and [ sec : eqns motion cab ] .",
    "step [ enum : stepa ] takes us to a regularized version of the problem , which is a problem different from the original one .",
    "step [ enum : stepb ] can not happen before [ enum : stepa ] , but we have the freedom to choose the further ordering .",
    "this gives rise to three different derivations :    [ enum : stepa][enum : stepb][enum : stepc ] : :    this procedure discretizes the lagrangian and derives the    corresponding equations of motion afterwards ; see section [ sec : eqns    motion abc ] .",
    "[ enum : stepa][enum : stepc][enum : stepb ] : :    this procedure derives the equations of motion from the measure - valued    lagrangian and discretizes these equations afterwards ; see section    [ sec : eqns motion acb ] .",
    "[ enum : stepc][enum : stepa][enum : stepb ] : :    this procedure derives the equations of motion from the continuum    lagrangian , writes them in measure - valued form and discretizes    afterwards ; see section [ sec : eqns motion cab ]",
    ".    procedures [ enum : stepa][enum : stepb][enum : stepc ] and [ enum : stepa][enum : stepc][enum : stepb ] eventually yield the same particle scheme .",
    "this is the scheme traditionally used in the sph community ( cf .",
    "procedure [ enum : stepc][enum : stepa][enum : stepb ] is the one that yields the equations used in @xcite and @xcite .        in section [ sec : deriv action ] we introduced ( for each @xmath0 ) the density @xmath1 as the push - forward of the initial density @xmath21 under the mapping @xmath11 . in this section",
    "we lift the evolution of @xmath1 to the space of ( time - dependent ) measures .",
    "let @xmath36 and @xmath34 be the measures associated to the densities @xmath21 and @xmath1 .",
    "hence , @xmath37 . in",
    " we can substitute @xmath38 by @xmath39 . afterwards",
    ", there is one more aspect that we need to ` repair ' before we are completely in a measure formulation . the internal energy density @xmath6 depends on @xmath1 itself , via pointwise evaluation at @xmath27 .",
    "an approximation of @xmath1 is needed to obtain a general expression that is even well - defined for measures that have no density ( w.r.t .  the lebesgue measure ) .",
    "we propose to introduce a regularization via convolution @xmath40 for all @xmath41 . here , the smoothing function @xmath42 is nonnegative and even , @xmath43 is a small parameter , and @xmath44 in the narrow topology as @xmath45 ( i.e.  tested against bounded continuous functions ) .",
    "a typical example is the gaussian with zero mean and variance @xmath46 . if @xmath34 has a density @xmath1 then the convergence @xmath47 holds _ in some sense and under certain mathematical conditions_. e.g. if @xmath1 is continuous and bounded , then by definition of @xmath44 , @xmath48 converges to @xmath49 for all @xmath50 .",
    "in any case , the convolution regularizes the solution , introducing an artificial ` density ' @xmath33 , such that pointwise evaluation and the gradient are defined even when @xmath1 does not exist or is not differentiable . in this work we do not consider the limit @xmath45 , but we stick to the subscript @xmath43 in @xmath42 in agreement with the common notation in sph literature . +   +",
    "note that @xmath33 can also be written as @xmath51 by definition of the push - forward .",
    "hence , we should keep in mind that @xmath52 has either a functional dependence on @xmath34 , or an extra dependence on @xmath53 ( depending on which formulation we choose ) , but we do not write this dependence explicitly . +   + in @xmath6 , we substitute @xmath33 for @xmath1 in the sequel and redefine the lagrangian ( in a measure - formulation ) such that the action becomes @xmath54 = { \\int_{0}^{t}\\ !",
    "l[\\phi](t ) \\ , dt } = { \\int_{0}^{t}\\ ! { \\int_{\\omega_0}^{}\\ ! \\left(\\dfrac12 |\\dot{\\phi}_t(x)|^2 - e(\\tilde{\\rho}_t(\\phi_t(x)),\\phi_t(x))\\right ) \\ , \\mu_0(dx ) } \\ , dt}.\\ ] ] the new , generalized formulation in terms of measures does allow to consider more types of solutions , simply by allowing more general initial conditions .",
    "this is exactly what we exploit in the following step , doing a particle approximation .      in this step ,",
    "we substitute for @xmath36 a discrete measure of the form @xmath55 . under push - forward ,",
    "the measure remains a discrete measure with positions of the diracs @xmath56 evolving under the motion mapping : @xmath57 .",
    "we emphasize that the equation for @xmath11 is yet unknown and is to be derived in the next step .",
    "+   + the lagrangian takes the form @xmath58(t ) = \\sum_{i=1}^n m_i\\,\\left(\\dfrac12 |\\dot{x}_i(t)|^2 - e(\\tilde{\\rho}_t(x_i(t)),x_i(t))\\right),\\ ] ] with @xmath59      the equations of motion are obtained via the ` classical ' euler - lagrange equations , applied to the lagrangian @xmath23(t ) = \\sum_{i=1}^n m_i\\,\\left(\\dfrac12 |u_i|^2 - e\\left(\\sum_{j=1}^n m_j\\,\\wh(y_i - y_j),y_i\\right)\\right),\\ ] ] cf .  .",
    "the corresponding euler - lagrange equations are @xmath60(\\phi_t(x_{k,0}),\\dot{\\phi}_t(x_{k,0})),\\end{gathered}\\ ] ] for each @xmath61 , where @xmath62 is the force density ( per unit mass ) of nonconservative forces .",
    "the functional dependence in square brackets denotes that @xmath62 incorporates a nonlocal interaction term .",
    "more details will follow later ; cf .  .",
    "the subscript `` @xmath63 '' should be read as performing this substitution for all @xmath64 .",
    "+   + after calculating the derivatives @xmath65 and @xmath66 in , we obtain @xmath67(\\phi_t(x_{k,0}),\\dot{\\phi}_t(x_{k,0})).\\end{gathered}\\ ] ] we denote by @xmath68 the gradient of @xmath6 only in the explicit spatial coordinate ; that is , the second variable of @xmath6 .",
    "we divide all terms by @xmath69 ( which is nonzero without loss of generality ) . if in the second line we take @xmath70 inside the sum and we use in the third line that @xmath71 is an odd function , then the corresponding terms in can be combined , and we obtain @xmath72 \\\\ - \\nabla_y e\\left(\\tilde{\\rho}_t(\\phi_t(x_{k,0})),\\phi_t(x_{k,0})\\right ) + q[\\bar{\\mu}^n_t](\\phi_t(x_{k,0}),\\dot{\\phi}_t(x_{k,0})),\\label{eqn : eqn motion discrete abc}\\end{gathered}\\ ] ] for each @xmath61 . for brevity of notation ,",
    "we use @xmath52 again in the argument of @xmath6 .",
    "this step is exactly the same as in section [ sec : proc abc step a ] .",
    "we start from the action given in . instead of using the classical euler - lagrange equations ,",
    "we employ here a generalized form of the principle of least action:@xmath73(\\psi)= -q[\\phi](\\psi),\\ ] ] for all test functions @xmath74 . here ,",
    "@xmath75(\\psi)$ ] denotes the variational derivative of @xmath76 in the direction of @xmath77 , and @xmath78(\\psi)$ ] is the work done along @xmath77 .",
    "it is defined as @xmath79(\\psi ) : = { \\int_{0}^{t}\\ ! { \\int_{\\omega_0}^{}\\ !",
    "q[\\mu_t](\\phi_t(x),\\dot{\\phi}_t(x))\\cdot\\psi_t(x ) \\ , \\mu_0(dx ) } \\ , dt},\\ ] ] where @xmath62 is the force density as in . for @xmath80",
    "we have : @xmath81(\\psi ) : = \\left.\\dfrac{d}{d\\eps}s[\\phi+\\eps\\psi]\\right|_{\\eps=0}.\\label{eqn : var der s}\\ ] ] note that @xmath82_{\\eps=0}\\\\ \\nonumber = & \\dfrac{\\partial e}{\\partial \\rho}\\left({\\int_{\\omega_0}^{}\\ !",
    "\\wh(\\phi_t(x)-\\phi_t(y ) \\ , \\mu_0(dy)},\\phi_t(x)\\right ) { \\int_{\\omega_0}^{}\\",
    "! \\nabla \\wh(\\phi_t(x)-\\phi_t(y))\\cdot ( \\psi_t(x)-\\psi_t(y ) ) \\ , \\mu_0(dy)}\\\\ & + \\nabla_y e\\left({\\int_{\\omega_0}^{}\\ !",
    "\\wh(\\phi_t(x)-\\phi_t(y ) \\ , \\mu_0(dy)},\\phi_t(x)\\right)\\cdot\\psi_t(x).\\label{eqn : var der e}\\ ] ] to avoid lengthy notation , we denote here by @xmath83(\\psi)(x)$ ] the expression in .",
    "the variational derivative of @xmath76 can be expressed as : @xmath84(\\psi ) = & { \\int_{0}^{t}\\ ! { \\int_{\\omega_0}^{}\\ !",
    "\\left(\\dot{\\phi}_t(x)\\cdot\\dot{\\psi}_t(x ) - e'[\\phi](\\psi)(x)\\right ) \\ , \\mu_0(dx ) } \\ , dt}\\\\ = & { \\int_{0}^{t}\\ ! { \\int_{\\omega_0}^{}\\ !",
    "\\left(-\\ddot{\\phi}_t(x)\\cdot\\psi_t(x ) - e'[\\phi](\\psi)(x)\\right ) \\ , \\mu_0(dx ) } \\ , dt},\\label{eqn : var der s}\\end{aligned}\\ ] ] where the last step follows from integration by parts and the boundary terms disappear because @xmath77 has compact support within @xmath85 .",
    "+   + we rewrite the part involving @xmath86 in as follows : @xmath87 by subsequently interchanging the order of integration , using that the function @xmath88 is odd , and replacing @xmath20 by @xmath4 and _ vice versa_. a combination of , , , and gives us for @xmath75(\\psi)+q[\\phi](\\psi)$ ] an integral of the form @xmath89\\cdot\\psi_t(x ) \\ , \\mu_0(dx ) } \\ , dt},\\ ] ] where we deliberately do not explicitly write the integrand in square brackets .",
    "since this integral equals @xmath28 for all @xmath74  cf .    the theorem of du bois - reymond yields that the integrand should vanish for almost all @xmath90 $ ] and for @xmath36-almost every @xmath20 .",
    "hence , we obtain @xmath91 \\ , \\mu_0(dy)}\\\\ - \\nabla_y e\\left(\\tilde{\\rho}_t(\\phi_t(x)),\\phi_t(x)\\right )   + q[\\mu_t](\\phi_t(x),\\dot{\\phi}_t(x)).\\label{eqn : eqn motion acb}\\end{gathered}\\ ] ]      the transition to a particle system takes place by substituting @xmath92 for @xmath36 in .",
    "moreover , in @xmath33 and @xmath62 we replace @xmath34 by @xmath93 .",
    "note that , after substitution , holds @xmath94-a.e .  and should therefore ( only ) be evaluated at @xmath95 for all @xmath61 .",
    "we obtain exactly .        at the continuum level , deriving the euler - lagrange equations resembles considerably what was done in section [ sec : proc acb step c ] .",
    "note however that the action as defined in  is used . in @xmath96",
    "the dependence on @xmath11 that is explicitly written down , corresponds to the position at which @xmath1 is evaluated .",
    "however , if @xmath11 is varied , also the function @xmath1 itself changes .",
    "this is somewhat confusing , as this is an implicit , ` hidden ' dependence of @xmath1 on the motion mapping @xmath11 .",
    "however , the exact relation is given by , which we therefore substitute in .",
    "the variational derivative becomes @xmath97(\\psi ) = \\\\",
    "! { \\int_{\\omega_0}^{}\\ ! \\left(\\dfrac12 |\\dot{\\phi}_t(x)+\\eps\\,\\dot{\\psi}_t(x)|^2 - e\\left(\\dfrac{\\rho_0(x)}{\\left|j(\\phi_t+\\eps\\,\\psi_t)(x)\\right|},\\phi_t(x)+\\eps\\,\\psi_t(x)\\right)\\right)\\,\\rho_0(x ) \\ , dx } \\ , dt}\\right)\\right|_{\\eps=0},\\end{gathered}\\ ] ] cf .  .",
    "some effort is needed to deal with the @xmath98-dependence in the jacobian matrix .",
    "we refer here to section 2 of @xcite , where the equation of motion is derived from the action , for the case where @xmath6 has no explicit dependence on the spatial coordinate ; i.e. @xmath99 .",
    "the determinant of the jacobian matrix is a polynomial of the entries of that matrix .",
    "the basic idea in @xcite is that the chain rule has to be applied with respect to every element of the jacobian matrix . to avoid having to introduce a considerable amount of extra notation",
    ", we only state the result of @xcite here : @xmath100 on the right - hand side the gradient of the pressure @xmath101 appears , due to the thermodynamic relation @xmath102 .",
    "the reader should note that the notation used in @xcite differs substantially from ours , but that the philosophy of deriving the equations of motion is the same .. ] +   + if @xmath103 , and moreover , we include nonconservative forces , then instead of we obtain @xmath104(\\phi_t(x),\\dot{\\phi}_t(x)).\\label{eqn : eqn motion seliger with extra terms}\\end{gathered}\\ ] ] the additional terms follow from similar steps as the ones leading to .",
    "we omit further details .",
    "note that , in correspondence with @xmath62 as introduced before , the dependence on @xmath1 in square brackets indicates the presence of a nonlocal term ; cf .  .",
    "in the next step , this will become a dependence on the measure @xmath34 like before .",
    "in this step , we formulate in terms of measures .",
    "the only place where the measure @xmath34 can be incorporated directly , is in the nonconservative force density .",
    "we write @xmath105(\\phi_t(x),\\dot{\\phi}_t(x))$ ] instead of @xmath106(\\phi_t(x),\\dot{\\phi}_t(x))$ ] .",
    "all the other occurrences of @xmath1 in we approximate by @xmath33 as defined in .",
    "we obtain @xmath107(\\phi_t(x),\\dot{\\phi}_t(x)).\\label{eqn : eqn motion cab}\\end{gathered}\\ ] ]      we take @xmath108 and replace @xmath34 by @xmath93 in @xmath33 and @xmath62 that appear in .",
    "we evaluate the resulting equation at @xmath95 for all @xmath61 to obtain @xmath109(\\phi_t(x_{k,0}),\\dot{\\phi}_t(x_{k,0})),\\label{eqn : eqn motion discrete cab}\\end{gathered}\\ ] ] where each appearance of @xmath33 denotes a sum over all particle positions .",
    "namely , @xmath110      procedures [ enum : stepa][enum : stepb][enum : stepc ] and [ enum : stepa][enum : stepc][enum : stepb ] yield the same equations of motion , namely . as anticipated already in section [ sec : 3 proc ] , the equation resulting from procedure [ enum : stepc][enum : stepa][enum : stepb ] is different ; see . this difference between the two final equations arose because we introduced the regularization via @xmath52 at different stages .",
    "in fact , contains an extra regularization in space , as we will show now .",
    "+   + note that only the term involving @xmath70 and @xmath111 is different . in",
    ", we have @xmath112,\\ ] ] while the corresponding part in is @xmath113 note that both of them contain a part @xmath114 , hence let us consider in only @xmath115 to obtain this equality , we have assumed that @xmath116 ; this assumption anticipates the choice we make in .",
    "let us even go back one more step and consider this term before the introduction of @xmath52 , i.e.  as in . to see how this term relates to the corresponding one in , we take the convolution with @xmath42 , and proceed as follows : @xmath117 in the first step , we performed integration by parts , with vanishing boundary terms on @xmath118 .",
    "this is because @xmath119 and hence @xmath1 vanishes on its boundary .",
    "now replace @xmath120 by @xmath121 and approximate @xmath1 by @xmath33 .",
    "take @xmath122 and evaluate at @xmath123 and obtain @xmath124 this expression exactly appears in .",
    "to summarize : the connection between and is that in the former during the derivation procedure an extra regularization in space was introduced for _ a part of _ the right - hand side .",
    "+   + note that , if we only consider the part involving @xmath125 , is the same as equation ( 3.8 ) in @xcite .",
    "the notation used therein shows the direct dependence on the pressure . in equation ( 3.5 ) of @xcite",
    ", the equivalent of is given .",
    "the reason why is the one traditionally used in the sph community is given in @xcite : it does conserve linear and angular momentum exactly , as opposed to .",
    "having derived the schemes , we are now able also to elaborate on the remark already made in the introduction :  requires the gradient of the pressure field to be expressed analytically , while the pressure itself does not appear in the numerical scheme \" .",
    "the first part on the right - hand side of is  anticipating  of the form @xmath126 .",
    "hence we need an analytical expression for @xmath127 .      in sections [ sec : eqns motion abc ] , [ sec : eqns motion acb ] and [ sec : eqns motion cab ] we derived particle - based schemes .",
    "to establish their convergence ( as @xmath128 ) we use a measure - valued framework .",
    "such framework incorporates both the limit and the approximating sequence .",
    "hence , we focus on the measure - formulations and , without the specific choice @xmath129 .",
    "our convergence proof is applicable to a much broader class of approximating measures .",
    "the sph - inspired particle approach is a special case ; see corollary [ cor : particle system ] .",
    "+   + although and are different ( cf .  section [ sec : compare eqns motion ] ) , we wish to establish the convergence proof for both formulations simultaneously .",
    "hence , we introduce a switching parameter @xmath130 to unify both variants in a single equation of motion .",
    "first , we assume that @xmath6 is of the form @xmath131 in agreement with the remark we already made underneath . here ,",
    "@xmath132 and @xmath133 , where @xmath134 .",
    "note that @xmath135 and @xmath136 .",
    "we introduce an auxiliary function @xmath137 , @xmath130 , that is defined by @xmath138 we choose @xmath62 to be of the form @xmath139(y , u ) : = -\\eta(y)\\,u + ( k*\\mu)(y),\\label{eqn : q = eta + k}\\ ] ] with @xmath140 and @xmath141 .",
    "+   + we assign the value @xmath142 to the formulation in , and @xmath143 to .",
    "both equations are now simultaneously written as @xmath144)(\\phi_t(x))\\\\ - \\nabla v\\left(\\phi_t(x)\\right )   - \\eta(\\phi_t(x))\\,\\dot{\\phi}_t(x ) + ( k*\\mu_t)(\\phi_t(x)).\\end{gathered}\\ ] ] here we use the shorthand notation @xmath145)(\\xi)={\\int_{\\omega_t}^{}\\ ! \\nabla\\wh(\\xi - y)f_\\theta(\\tilde{\\rho}_t(y ) ) \\ , \\mu_t(dy)}.\\ ] ] in we slightly abuse notation , and the equation should be read as follows : whenever @xmath142 we disregard the complete term @xmath146)(\\phi_t(x))$ ] , irrespective of whether the convolution term is well - defined , bounded etc .",
    "we emphasize that @xmath147 and @xmath148 are physically different objects in the sense that @xmath147 contains all contributions of @xmath149 to the flow , while @xmath148 only contains part of that influence .",
    "hence , although the notation might suggest so , by setting @xmath143 we are not _ adding _ terms .",
    "we use one function @xmath137 to smoothen the presentation in the sequel .",
    "however , @xmath147 and @xmath148 do have the same physical dimension and e.g.  if @xmath149 is given by @xmath150 for some @xmath151 , then both @xmath152 .",
    "now we arrive at the central evolution problem we will consider in the rest of this paper . fix a final time @xmath153 . let @xmath154 be the space of probability measures on @xmath155 .",
    "assume that @xmath156 and that there is an @xmath157 such that @xmath158 let @xmath159 and @xmath130 be fixed .",
    "we consider the system @xmath160)(\\phi_t(x))\\\\      \\hspace*{5cm}- \\nabla v\\left(\\phi_t(x)\\right )   - \\eta(\\phi_t(x))\\,\\dot{\\phi}_t(x ) + ( k*\\mu_t)(\\phi_t(x));\\\\      \\tilde{\\rho}_t:=\\wh*\\mu_t;\\\\      \\mu_t=\\phi_t\\#\\mu_0;\\\\      \\phi_0(x)=x,\\ , \\dot{\\phi}_0(x)=v_0(x ) ,    \\end{array } \\right.\\ ] ] for all @xmath161 and all @xmath162 $ ] .",
    "we remark that this condition implies the one with ; that equation is required to hold for almost all @xmath90 $ ] and for @xmath36-almost every @xmath20 .",
    "we might have taken @xmath163 for some @xmath164 , instead of @xmath165 , to comply with the pressure term ( i.e.  the one involving @xmath137 ) that only depends on the _ regularized _ density @xmath33 .",
    "we prefer the shorter form @xmath165 .",
    "this choice can be made without loss of generality if we take @xmath166 .",
    "it is not _ a priori _ clear whether the term @xmath165 is a conservative or a nonconservative force density , hence whether it should be part of @xmath62 or be related to @xmath6 .",
    "assume there is a @xmath164 such that @xmath167 .",
    "then both ways give the same equations of motion .",
    "indeed , if we include the energy density @xmath168 in @xmath6 instead of including @xmath165 in @xmath62 , we also obtain .",
    "in this section we introduce some preliminary notions , and summarize the required assumptions together with the convergence result ( theorem  [ thm : main thm ] ) .",
    "the theorem provides a general result , of which the convergence of sph schemes is a special case ; see corollary  [ cor : particle system ] . the proof of the theorem in given in section [ sec : proof ] .      fix a constant integer @xmath169 .",
    "[ def : push - forward ] the _ push - forward _ of a probability measure @xmath170 by a mapping @xmath171 , notation @xmath172 , is defined by @xmath173 for all measurable @xmath174 .",
    "equivalently , we can define @xmath172 as the push - forward of @xmath175 by @xmath18 if @xmath176 for all measurable , bounded functions @xmath177 on @xmath155 .",
    "[ def : coupling ] a _ joint representation _ of two measures @xmath178 is a measure @xmath179 on @xmath180 such that @xmath181 for all @xmath182 and @xmath183 in the borel @xmath184-algebra of @xmath155 .",
    "we denote by @xmath185 the set of all joint representations of @xmath186 and @xmath187 .",
    "joint representations are also called _",
    "couplings_.    a useful property of a joint representation @xmath188 is that for each @xmath189 @xmath190 for all measurable , bounded functions @xmath177 on @xmath155 .",
    "in fact , this is an alternative definition .",
    "[ def : wass ] the _ wasserstein distance _ between two probability measures @xmath178 is defined as @xmath191    note that , to be more precise , we should call this the _",
    "@xmath192-wasserstein distance _ , as a special case of the _",
    "@xmath193-wasserstein distance _ for which the cost function @xmath194 is used in the integral .",
    "the @xmath192-wasserstein distance is usually written as @xmath195 , but we will stick to @xmath196 to avoid confusion with the smoothing function @xmath42 . the particular choice @xmath197 is made because it is compatible with the lipschitz properties of the functions and the motion mapping that we use .",
    "this is what section [ sec : conv ] hinges on . for an exposition on the wasserstein distance and the related concept of _ optimal transport _",
    ", we refer to @xcite and @xcite .      throughout the paper ,",
    "we assume the following :    [ ass : v eta k ] the functions @xmath198 , @xmath199 and @xmath200 satisfy @xmath132 , @xmath140 and @xmath141 .",
    "note in particular that the above assumption implies that @xmath201 and @xmath200 are lipschitz continuous .",
    "we denote their lipschitz constants by @xmath202 and @xmath203 , respectively .    for @xmath137 and @xmath42",
    "we have requirements that depend on the value of @xmath204 .",
    "recall that @xmath134 and define @xmath205 .",
    "[ ass : wh ] the function @xmath206 is even and satisfies @xmath207 .",
    "[ ass : f w theta=0]we require that @xmath208 .",
    "moreover , we assume that there is a constant @xmath209 such that for all @xmath170 @xmath210 and we define @xmath211 such that @xmath212 where @xmath213 cf .  .    under these assumptions",
    ", @xmath147 may have singularities at the origin , but _ only _ if @xmath42 is strictly positive everywhere in @xmath214 .",
    "such @xmath147 and @xmath42 are used in @xcite ; see also section [ sect : discussion ] . +   + if @xmath143 we need the following assumption :    [ ass : f w theta=1 ] we require that @xmath215 .",
    "moreover , let @xmath211 be such that @xmath216}\\left|f_1(u)\\right|&\\leqslant m_2,\\,\\,\\,\\text{and}\\\\ \\displaystyle\\sup_{u\\in\\left[0,\\|\\wh\\|_\\infty\\right]}\\left|f'_1(u ) \\right|&\\leqslant m_3.\\end{aligned}\\ ] ] we define @xmath217 .",
    "we use the same letters for the constants , to ease notation in the sequel .    the assumption is needed to get an _ a priori _ bound on the propagation speed in lemma [ lem : bound motion map ] .",
    "hence , we can restrict ourselves to measures with bounded support afterwards ; cf .",
    "corollary [ cor : bdd support solution ] . to achieve lemma [ lem : bound motion map ]",
    "if @xmath143 , we need assumption [ ass : f w theta=1 ] , which does not allow for singularities in @xmath148 around zero . + we demonstrate now why a weaker assumption for @xmath148 , resembling is not feasible",
    "assume that @xmath218 with @xmath219 .",
    "this is the case also considered in @xcite .",
    "to bound the first term on the right - hand side of , in @xcite it is assumed that @xmath220 for some @xmath221 .",
    "we would need an estimate on @xmath222)(x)\\right|.\\ ] ] let @xmath42 be strictly positive everywhere . since @xmath223 , @xmath224 .",
    "let @xmath42 satisfy the aforementioned condition @xmath220 . then also @xmath225 . under these ( not very strict ) conditions",
    "one can show that is unbounded ; to see this , use e.g.  the sequence of measures @xmath226 defined by @xmath227 , where @xmath228 is the first unit vector in @xmath155 .",
    "note in particular that is unbounded for a gaussian @xmath42 .",
    "the gaussian however is one of the standard choices for @xmath42 that we do want to allow for .",
    "let @xmath229 , and assume that @xmath230 where @xmath157 is the same constant as in .",
    "for each @xmath231 we associate to the measure @xmath232 a system of equations analogous to : @xmath233)(\\phi^n_t(x))\\\\      \\hspace*{4.5cm}- \\nabla v\\left(\\phi^n_t(x)\\right )   - \\eta(\\phi^n_t(x))\\,\\dot{\\phi}^n_t(x ) + ( k*\\mu^n_t)(\\phi^n_t(x));\\\\      \\tilde{\\rho}^n_t:=\\wh*\\mu^n_t;\\\\      \\mu^n_t=\\phi^n_t\\#\\mu^n_0;\\\\      \\phi^n_0(x)=x,\\ , \\dot{\\phi}^n_0(x)=v_0(x ) ,    \\end{array } \\right.\\ ] ] for all @xmath234 and all @xmath90 $ ] .",
    "note that the only difference with lies in the initial distribution @xmath232 versus @xmath36 ; the initial velocity @xmath235 is the same . +   + for any @xmath236 ,",
    "define @xmath237 .",
    "+   + the main result of the present paper is the following .",
    "[ thm : main thm ] assume that @xmath159 , and that assumptions [ ass : v eta k ] and [ ass : wh ] hold .",
    "let moreover ( depending on the value of @xmath204 ) assumption [ ass : f w theta=0 ] or [ ass : f w theta=1 ] be satisfied , and take the sequence @xmath238 such that @xmath239 for some @xmath240 .",
    "then :    1 .   there is a unique pair @xmath241;\\p_{r(t)}(\\r^d))\\times c^2([0,t];\\{{\\phi:{\\operatorname*{supp}}\\mu_0\\to\\r^d}\\})$ ] that satisfies ; [ thm : part1 ] 2 .   if , for all @xmath231 , the pair @xmath242;\\p_{r(t)}(\\r^d))\\times c^2([0,t];\\{{\\phi:{\\operatorname*{supp}}\\mu_0\\to\\r^d}\\})$ ] is a solution of , then @xmath243}\\mathcal{w}(\\mu^n_t,\\mu_t)\\stackrel{n\\to\\infty}{\\longrightarrow}0.\\]][thm : part2 ]    as a corollary , we obtain the following convergence of the sph scheme with @xmath244 particles .    [ cor : particle system ] fix @xmath130",
    ". for each @xmath245 ,",
    "let @xmath246 for some @xmath247 such that @xmath248 , and for some @xmath249 .",
    "assume that @xmath250 for some @xmath240 .",
    "then the discrete measure @xmath251 associated to the particle scheme defined for each @xmath61 by : @xmath252 \\\\ - \\nabla v\\left(\\phi_t(x_{k,0})\\right ) - \\eta(\\phi_t(x_{k,0}))\\,\\dot{\\phi}_t(x_{k,0 } ) + ( k*\\bar{\\mu}^n_t)(\\phi_t(x_{k,0})),\\end{gathered}\\ ] ] converges to the solution @xmath34 of in the following sense : @xmath253}\\mathcal{w}(\\bar{\\mu}^n_t,\\mu_t)\\stackrel{n\\to\\infty}{\\longrightarrow}0.\\label{eqn : conv result wass to zero}\\ ] ]      before proving the main result , theorem  [ thm : main thm ] , we need two auxiliary lemmas concerning the properties of the motion mapping @xmath11 .",
    "the first lemma is an upper estimate for @xmath11 .",
    "[ lem : bound motion map ] let assumptions [ ass : v eta k ] , [ ass : wh ] and [ ass : f w theta=0 ] or [ ass : f w theta=1 ] ( depending on the value of @xmath204 ) be satisfied . then for any * given * @xmath254;\\p(\\r^d))$ ] the mapping @xmath11 in , completed with @xmath255 , @xmath256 and @xmath257 , satisfies @xmath258 and all @xmath90 $ ] .    for @xmath175 fixed , and for each @xmath259 ,",
    "the ode is well - posed on @xmath24 $ ] , given the assumptions on @xmath198 , @xmath199 , @xmath137 , @xmath42 and @xmath200 , and the fact that @xmath175 is continuous in time .",
    "the well - posedness follows from the picard - lindelf theorem ; further details are omitted .",
    "+ using an integrating factor @xmath260 , we deduce from that @xmath261 we estimate @xmath262 in the inner integral , take this factor outside the integral where it cancels against @xmath263 . it follows that @xmath264)(\\phi_r(x ) ) ) \\bigg]\\,dr\\,ds\\bigg| .",
    "\\label{eqn : est bound phi eqn motion filled in}\\end{gathered}\\ ] ] in the case @xmath142 , the following estimate holds due to assumption [ ass : f w theta=0 ] : @xmath265)(\\phi_r(x)))\\right|\\\\ = \\left|f_0\\left((\\wh*\\mu_r)(\\phi_r(x))\\right)\\nabla(\\wh*\\mu_r)(\\phi_r(x))\\right| \\leqslant m_1.\\end{gathered}\\ ] ] note that for any @xmath170 it holds that @xmath266 .",
    "hence , in the case @xmath143 : @xmath267)(\\phi_r(x)))\\right|\\\\ \\leqslant m_2\\,\\|\\nabla\\wh\\|_\\infty + \\|\\nabla\\wh\\|_\\infty\\,m_2 = m_1,\\end{gathered}\\ ] ] where the bounds of assumption [ ass : f w theta=1 ] are used . +   + a combination of , and yields that for each @xmath130 @xmath268 by which the statement of the lemma follows .",
    "[ cor : bdd support solution ] let @xmath240 , and let assumptions [ ass : v eta k ] , [ ass : wh ] and [ ass : f w theta=0 ] or [ ass : f w theta=1 ] ( depending on the value of @xmath204 ) be satisfied",
    ". then any solution of must satisfy @xmath269 for each @xmath90 $ ] , where @xmath270    the next lemma provides a lipschitz - like estimate on @xmath11 .",
    "[ lem : lipsch like ] let @xmath271;\\p_{r(t)}(\\r^d))$ ] be given . consider the motion mappings corresponding to @xmath272 ( @xmath189 ) : @xmath273)(\\phi^{\\nu^i}_t(\\xi))\\\\ -\\nabla v(\\phi^{\\nu^i}_t(\\xi))-\\eta(\\phi^{\\nu^i}_t(\\xi))\\dot{\\phi}^{\\nu^i}_t(\\xi)+(k*\\nu^i_t)(\\phi^{\\nu^i}_t(\\xi))\\end{gathered}\\ ] ] for all @xmath274 and all @xmath90 $ ] , with initial conditions @xmath275 , @xmath276 .",
    "then , for all @xmath90 $ ] , @xmath277 and @xmath278 , it holds that @xmath279\\,|\\phi^{\\nu^1}_s(x)-\\phi^{\\nu^2}_s(y)| \\ , ds}+ m_5\\,{\\int_{0}^{t}\\ ! ( t - s){\\int_{}^{}\\ ! \\left|z - w\\right| \\ , \\tilde{\\pi}_s(dz , dw ) } \\ , ds},\\label{eqn : finalestimategeneral}\\end{gathered}\\ ] ] where @xmath280 for all @xmath281 $ ] , @xmath282 is an arbitrary element of @xmath283 .",
    "+    note that , by the fubini s theorem , for any integrable function @xmath177 , we have @xmath284 integration of in time together with yields that @xmath285)(\\phi^{\\nu^1}_s(x))\\right.\\\\ \\nonumber & \\hspace{3cm}\\left.- ( \\nabla \\wh*[(f_\\theta\\circ(\\wh*\\nu^2_s))\\nu^2_s])(\\phi^{\\nu^2}_s(y))\\right|\\,ds\\\\ & + { \\int_{0}^{t}\\ ! ( t - s)\\left| ( k*\\nu^1_s)(\\phi^{\\nu^1}_s(x ) ) - ( k*\\nu^2_s)(\\phi^{\\nu^2}_s(y ) )",
    "\\right| \\ , ds}.\\label{eqn : estimate1}\\end{aligned}\\ ] ] furthermore , we have @xmath286 and @xmath287 \\ , ds } \\ ,",
    "dr}\\right|\\\\ = \\left|{\\int_{0}^{t}\\ !",
    "\\eta(z ) \\ , dz}-{\\int_{y}^{x}\\ !",
    "\\eta(z ) \\ , dz}\\right ] \\ , dr}\\right| \\leqslant\\ , \\|\\eta\\|_\\infty{\\int_{0}^{t}\\ ! |\\phi^{\\nu^1}_r(x)-\\phi^{\\nu^2}_r(y)| \\ , dr}+\\|\\eta\\|_\\infty\\,t\\,|x - y|.\\label{eqn : estterm3}\\end{gathered}\\ ] ] regarding the term involving @xmath137 on the third and fourth line of , we proceed as follows @xmath288 we only consider @xmath289 and @xmath290 .",
    "this implies that @xmath291 . for each @xmath292",
    ", we have the following estimates : @xmath293 ( since @xmath294 is a probability measure ) , and @xmath295 thus we get @xmath296 .",
    "we proceed the estimation of : @xmath297 where we used that @xmath298 , @xmath299 and the fact that @xmath300 for any differentiable function @xmath301 .",
    "note that : @xmath302 where @xmath303 is arbitrary .",
    "we stress that the bound is independent of the choice of @xmath304 .",
    "analogously , @xmath305 for an arbitrary @xmath306 .",
    "we choose @xmath307 .",
    "it follows that @xmath308 if @xmath143 , similar estimates as in the first term on the right - hand side of , and as in and yield @xmath309)(\\xi_1 ) - ( \\nabla \\wh*[(f_\\theta\\circ(\\wh*\\nu^2_s))\\nu^2_s])(\\xi_2)\\right| \\\\ \\leqslant \\ , m_2 \\,\\|d^2\\wh\\|_\\infty\\,\\left|\\xi_1-\\xi_2\\right|+ m_3\\,\\|\\nabla\\wh\\|^2_\\infty\\,{\\int_{}^{}\\ ! \\left|z - w\\right| \\",
    ", \\tilde{\\pi}_s(dz , dw)}\\\\ + m_2 \\,\\|d^2\\wh\\|_\\infty\\,{\\int_{}^{}\\ ! \\left|z - w\\right| \\ , \\tilde{\\pi}_s(dz , dw)},\\label{eqn : estmappingtriangle theta}\\end{gathered}\\ ] ] where again the same @xmath303 as in is chosen .",
    "+   + the last term in we treat as follows : @xmath310 the estimate of the second term is obtained like in . +   + we combine , , , , and to get @xmath311\\,|\\phi^{\\nu^1}_s(x)-\\phi^{\\nu^2}_s(y)| \\ , ds } + m_5\\,{\\int_{0}^{t}\\ !",
    "( t - s){\\int_{}^{}\\ ! \\left|z - w\\right| \\ , \\tilde{\\pi}_s(dz , dw ) } \\ , ds } , \\ ] ] with @xmath312 and @xmath313 as defined in the statement of the lemma .",
    "now we have all ingredients to prove the main theorem , theorem [ thm : main thm ] .",
    "+   + * proof of part [ thm : part1 ] of theorem [ thm : main thm ] . *",
    "+ if @xmath314 then the well - posedness of is straightforward . in that case ,",
    "@xmath315 on @xmath316 for all @xmath0 and moreover @xmath200 must be constant , so the first equation in is independent of @xmath34 .",
    "the picard - lindelf theorem guarantees , for each @xmath161 , existence and uniqueness of the motion mapping ( as mentioned before ) . the solution @xmath317 is uniquely defined by the push - forward @xmath37 .",
    "+   + if @xmath318 , the well - posedness proof is based on a fixed - point argument ( banach s fixed point theorem ) .",
    "let @xmath153 be fixed .",
    "choose @xmath319 large enough , such that @xmath320 satisfies @xmath321 let @xmath322 be fixed .",
    "suppose that @xmath323 and @xmath324 are given .",
    "consider a mapping @xmath325 from @xmath326;\\p_{r(jt^*)}(\\r^d ) ) : \\nu|_{t=0}=\\mu^{(j)}_0\\right\\}\\ ] ] to itself , defined by @xmath327^\\nu\\#\\mu^{(j)}_0 ,   \\hbox { for all $ t\\in[0,t^*]$,}\\ ] ] where the motion mapping @xmath328^\\nu : \\r^+\\times \\r^d\\rightarrow\\r^d$ ] solves the following ode @xmath329^{\\nu}(x ) = -f_\\theta\\left(\\tilde{\\rho}_t([\\phi^{(j)}_t]^\\nu(x))\\right)\\nabla\\tilde{\\rho}_t([\\phi^{(j)}]^\\nu_t(x ) ) - \\theta\\,(\\nabla \\wh*[(f_\\theta\\circ\\tilde{\\rho}_t)\\nu_t])([\\phi^{(j)}_t]^\\nu(x))\\\\      \\hspace*{2.5cm}-\\nabla v\\left([\\phi^{(j)}_t]^\\nu(x)\\right)-\\eta\\left([\\phi^{(j)}_t]^\\nu(x)\\right)\\,[\\dot{\\phi}^{(j)}_t]^\\nu(x ) + ( k*\\nu_t)([\\phi^{(j)}_t]^\\nu(x));\\\\      \\tilde{\\rho}_t:=\\wh*\\nu_t;\\\\      \\phi^\\nu_0(x)=x,\\ , \\dot{\\phi}^\\nu_0(x)=v^{(j)}_0(x ) ,    \\end{array } \\right.\\ ] ] for all @xmath330 and all @xmath331 $ ] .",
    "the space @xmath332 is complete for arbitrary @xmath322 due to theorem [ thm : completenessappendix ] in appendix [ app : completeness ] .",
    "note that a fixed point @xmath333 of this mapping together with the corresponding motion mapping @xmath334 is a solution of on @xmath335 $ ] with initial data @xmath336 and @xmath337 .",
    "we create a hierarchy of the mappings @xmath338 for @xmath339 by defining @xmath340 , @xmath341 , @xmath342 and @xmath343 .",
    "such definition only makes sense if mapping @xmath344 actually has a unique fixed point and thus @xmath345 and @xmath346 are well - defined .",
    "moreover , we are aware of the fact that we have only defined @xmath347 on the support of @xmath348 .",
    "this is however sufficient .",
    "if we insist , we might just define it to be zero outside .",
    "in view of the to be constructed hierarchy , @xmath349 should be satisfied for each @xmath344 .",
    "+   + for any @xmath350 the image @xmath351 exists , and actually is an element of @xmath332 .",
    "well - posedness of the motion mapping ( for given @xmath352 and for each @xmath330 ) follows from picard - lindelf ( see before ) and guarantees the existence and uniqueness of @xmath175 .",
    "+ the support of the image measure , @xmath316 , is contained in a ball of radius @xmath353 this is easily checked by use of and a recursive relation involving @xmath354^\\nu\\|_\\infty=\\|v^{(j+1)}_0\\|_\\infty$ ] for each @xmath355 .",
    "thus , the image @xmath175 of our mapping @xmath338 is an element of @xmath332 .",
    "+ consider two measures @xmath356 and their corresponding images @xmath357 and @xmath358 .",
    "let @xmath359 be arbitrary .",
    "for an arbitrary fixed @xmath360 $ ] define @xmath361 by @xmath362^{\\nu^1},[\\phi^{(j)}_t]^{\\nu^2}\\right)\\#\\pi_0.\\ ] ] note that this @xmath363 is indeed a joint representation of @xmath364 and @xmath365 for each @xmath0 .",
    "we drop the dependence on @xmath344 of @xmath366 and @xmath363 since no ambiguity appears . by definition of the push - forward and of the wasserstein distance",
    "( see definitions [ def : push - forward ] and [ def : wass ] ) , we have @xmath367^{\\nu^1}(x)-[\\phi^{(j)}_t]^{\\nu^2}(y)\\right| \\ , \\pi_0(dx , dy)}\\ ] ] holds for each @xmath360 $ ] .",
    "applied to , a version of gronwall s lemma is bounded .",
    "one can show this using estimates similar to those in the proof of lemma [ lem : bound motion map ] . ]",
    "yields that for each @xmath368 @xmath369^{\\nu^1}(x)-[\\phi^{(j)}_t]^{\\nu^2}(y)\\right| \\leqslant\\ , \\bigg[(1+t\\,\\|\\eta\\|_\\infty)\\,|x - y| + t\\,|v^{(j)}_0(x)-v^{(j)}_0(y)|\\\\ \\hspace{1cm}+   m_5\\,{\\int_{0}^{t}\\ !",
    "( t - s){\\int_{}^{}\\ ! \\left|z - w\\right| \\ ,",
    "\\tilde{\\pi}_s(dz , dw ) } \\ , ds } \\bigg]\\,\\exp\\left(\\|\\eta\\|_\\infty\\ , t + \\frac12\\,m_4\\,t^2   \\right).\\label{eqn : estgronwall}\\end{gathered}\\ ] ] now we combine and @xmath370\\,\\exp\\left(\\|\\eta\\|_\\infty\\ , t + \\frac12\\,m_4\\,t^2   \\right).\\end{gathered}\\ ] ] the integral with respect to @xmath371 disappeared for the third term inside the square brackets , since it is independent of @xmath20 and @xmath4 , and moreover @xmath372 .",
    "recall furthermore that @xmath303 is arbitrary ( and in particular independent of @xmath373 ) .",
    "thus , choosing a specific @xmath373 on the right - hand side does not affect the third term .",
    "we take @xmath374 which is the measure concentrated on the diagonal @xmath375 with marginals both @xmath376 . with some abuse of notation",
    "it can also be written as @xmath377 for this choice of @xmath373 , we have that @xmath378 only the third term in square brackets on the right - hand side of remains . within the integral",
    "we take the infimum over @xmath303 for each @xmath379 independently ( which is allowed by the dominated convergence theorem ) and further estimate:@xmath380}\\mathcal{w}(\\nu^1_s,\\nu^2_s)\\,\\frac12 t^2.\\ ] ] finally , we take the supremum over @xmath360 $ ] : @xmath381}\\nonumber \\mathcal{w}(\\mu^1_t,\\mu^2_t ) \\leqslant & \\frac12\\,(t^*)^2\\,m_5\\,\\exp\\left(\\|\\eta\\|_\\infty\\ , t^ * + \\frac12\\,m_4\\,(t^*)^2   \\right)\\,\\sup_{t\\in[0,t^*]}\\mathcal{w}(\\nu^1_t,\\nu^2_t).\\end{aligned}\\ ] ] by the specific choice of @xmath382 , @xmath338 is a contraction mapping for each @xmath344 , since @xmath381}\\nonumber \\mathcal{w}(\\mu^1_t,\\mu^2_t ) \\leqslant & \\,\\kappa_{t^*}\\,\\sup_{t\\in[0,t^*]}\\mathcal{w}(\\nu^1_t,\\nu^2_t),\\end{aligned}\\ ] ] where @xmath383 by assumption ; cf .  .",
    "as mentioned before , the space @xmath332 is complete for each @xmath344 due to theorem [ thm : completenessappendix ] in appendix [ app : completeness ] .",
    "banach s fixed point theorem then guarantees the existence of a unique fixed point of @xmath338 for each @xmath344 .",
    "+ having the construction of @xmath384 for @xmath339 , we define a couple @xmath385 of a measure and a motion mapping as follows @xmath386,\\ ] ] for @xmath322 . + by our construction @xmath241;\\p_{r(t)}(\\r^d))\\times c^2([0,t];\\{{\\phi:{\\operatorname*{supp}}\\mu_0\\to\\r^d}\\})$ ] and it uniquely satisfies with initial data @xmath36 and @xmath235 .",
    "+   + * proof of part [ thm : part2 ] of theorem [ thm : main thm ] . *",
    "+ note that part [ thm : part1 ] implies that for each initial measure @xmath36 and @xmath232 ( for each @xmath231 ) there is a corresponding unique solution @xmath385 , @xmath387 , respectively .",
    "fix @xmath231 and let @xmath388 be arbitrary .",
    "we use , taking @xmath389 and @xmath390 .",
    "thus @xmath391 and @xmath392 .",
    "first of all , we estimate @xmath393 for all @xmath394 and all @xmath395 .",
    "this is possible is part of the solution and only defined on @xmath396 .",
    "in general , @xmath397 might not even be defined . ] , since @xmath159 is given , is defined on the whole of @xmath155 and has bounded derivative . using this lipschitz estimate and integrating against @xmath371",
    ", we obtain @xmath398\\,{\\int_{}^{}\\ ! |\\phi^n_s(x)-\\phi_s(y)| \\ , \\pi_0(dx , dy ) } \\ , ds } + m_5\\,{\\int_{0}^{t}\\ ! ( t - s){\\int_{}^{}\\ ! \\left|z - w\\right| \\ , \\tilde{\\pi}_s(dz , dw ) } \\ , ds},\\label{eqn : integratedestimatebeforegronwall}\\end{gathered}\\ ] ] where we used that the last term is independent of @xmath20 and @xmath4 , and the fact that @xmath373 is a probability measure on @xmath399 .",
    "recall that @xmath400 is arbitrary and in general does not depend on @xmath373 .",
    "we now _ introduce _ an explicit relation between @xmath282 and @xmath373 by choosing @xmath401 for each @xmath402 $ ] .",
    "we substitute this in and apply gronwall s lemma to obtain @xmath403\\exp\\left(\\|\\eta\\|_\\infty\\ , t + \\frac12\\left(m_4+m_5\\right ) t^2   \\right).\\label{eqn : estbeforewass}\\end{gathered}\\ ] ] using the already defined joint representation @xmath404 , we obtain an estimate like in . together with this yields @xmath405\\,\\exp\\left(\\|\\eta\\|_\\infty\\ , t + \\frac12\\left(m_4+m_5\\right ) t^2   \\right).\\end{gathered}\\ ] ] we take the infimum over @xmath406 on the right - hand side : @xmath407 finally , we take the supremum over @xmath90 $ ] on both sides of the inequality and obtain @xmath408}\\mathcal{w}(\\mu^n_t,\\mu_t ) \\leqslant ( 1+t\\,\\left(\\|\\nabla v_0\\|_\\infty+\\|\\eta\\|_\\infty\\right))\\,\\exp\\left(\\|\\eta\\|_\\infty\\ , t + \\frac12\\left(m_4+m_5\\right ) t^2   \\right)\\,\\mathcal{w}(\\mu^n_0,\\mu_0).\\ ] ] hence @xmath409 implies @xmath410}\\mathcal{w}(\\mu^n_t,\\mu_t)\\stackrel{n\\to\\infty}{\\longrightarrow}0 $ ] .",
    "this finishes the proof .",
    "@xmath411      we comment on the assumptions needed to state the main theorem , theorem [ thm : main thm ] . +   + _ assumptions on @xmath137 and @xmath42 _ : we remark here that in @xcite only @xmath142 is used , and furthermore @xmath412 , @xmath413 and @xmath414 .",
    "all possible @xmath147 and @xmath42 treated in @xcite satisfy assumption [ ass : f w theta=0 ] :    1 .",
    "@xmath415 , for @xmath416 , satisfies the assumptions for all choices of @xmath206 ; 2 .",
    "@xmath415 , for @xmath417 , satisfies the assumptions if @xmath42 is an element of @xmath418 and satisfies the extra condition @xmath419 for all @xmath20 , for some constant @xmath221 .",
    "we remark that the class of admissible pairs @xmath420 covered by assumption [ ass : f w theta=0 ] is more general than in @xcite , where only @xmath147 of the form @xmath415 is treated .",
    "for instance , in our work any @xmath421 ( bounded and with bounded derivative ) is allowed in combination with an arbitrary @xmath206 .",
    "+   + _ assumption on convergence of initial data _ : given the initial probability measure @xmath36 supported in the ball @xmath422 , we demonstrate here two ways of constructing an approximating sequence of measures @xmath423 .",
    "+   + the first way of constructing @xmath232 is deterministic and has been used in  @xcite . for simplicity of presentation , we assume @xmath424 and @xmath425 $ ] . for each @xmath245 , define @xmath426 where @xmath427 , for each @xmath428 , and @xmath429}\\mu_0(dx)$ ] . +",
    "it follows that @xmath430 and @xmath431 .",
    "define a map @xmath432\\to\\{\\frac{i}{n}-\\frac{1}{2n}:1\\leq i\\leq n\\}}$ ] by @xmath433 if @xmath434 and @xmath435 . for every measurable and bounded function @xmath177 ,",
    "defined on @xmath436 $ ] it holds that @xmath437}f(x)\\mu_0^n(dx)&=\\sum_{i=1}^n m_i\\,f\\left(\\frac{i}{n}-\\frac{1}{2n}\\right)\\\\ & = \\sum_{i=1}^{n-1}\\int_{[\\frac{i-1}{n},\\frac{i}{n})}\\mu_0(dx)\\ , f\\left(\\frac{i}{n}-\\frac{1}{2n}\\right)+\\int_{[1-\\frac{1}{n},1]}\\mu_0(dx)\\ , f\\left(1-\\frac{1}{2n}\\right)\\\\ & = \\int_{[0,1]}f(\\psi(x))\\,\\mu_0(dx).\\end{aligned}\\ ] ] hence , @xmath438 . note that @xmath439 for every @xmath440 $ ]",
    "therefore , @xmath441}|x-\\psi(x)|\\,\\mu_0(dx ) \\leq \\frac{1}{2n}\\int_{[0,1]}\\mu_0(dx ) = \\frac{1}{2n},\\ ] ] where we obtain the first inequality by taking @xmath442 to be @xmath443 .",
    "this implies that @xmath409 .",
    "+ this procedure generalizes to the case @xmath444 ( but with more involved notation ) .",
    "let @xmath425^d$ ] and let @xmath445 . dividing the hypercube @xmath436^d$ ] into @xmath244 equal subcubes , we obtain analogously that the convergence rate is @xmath446{n})$ ] .",
    "+   + the second way of constructing @xmath232 is probabilistic and is based on the law of large numbers as already pointed out in  @xcite .",
    "suppose that the points @xmath447 are independent identically distributed random variables with the same distribution @xmath448 .",
    "let @xmath232 be the empirical measure , defined by @xmath449 note that in fact there is an underlying probability space @xmath450 and @xmath451 .",
    "hence @xmath232 is , strictly speaking , not a mere probability measure , but a mapping from @xmath450 to @xmath452 ; i.e.  @xmath453 . according to @xcite , theorem 11.4.1",
    ", the sequence @xmath454 converges _ almost surely _ to @xmath36 .",
    "this implies that for _ almost every _",
    "realization @xmath455 the corresponding sequence of measures @xmath456 given by @xmath457 , converges in the narrow topology to @xmath36 : @xmath458 the term ` almost every realization ' refers to the fact that the set ( in @xmath450 ) on which the narrow convergence does _ not _ hold , has zero probability ( with respect to the probability distribution on @xmath450 ) . in layman",
    "s terms , this means that if we draw a random sample @xmath455 , it is ` unlikely ' that the corresponding sequence @xmath459 does not converge narrowly .",
    "+   + assume that our random sample did yield such narrowly converging sequence @xmath459 .",
    "since all @xmath460 are probability measures on a bounded domain @xmath422 , their first moments are uniformly integrable ( i.e.  uniformly in @xmath244 ) .",
    "thus , theorem 7.1.5 in @xcite implies that @xmath461      we illustrate the theoretical convergence result of theorem [ thm : main thm ] by two simple numerical examples .",
    "the first one involves only the hydrodynamical force , as described by the first term on the right - hand side of .",
    "we consider both schemes derived ( @xmath462 and @xmath463 ) , in dimension @xmath424 and @xmath464 . in the second example only the non - local interaction term and a drag force in are present and we take @xmath464 . first , in problems of bounded domains , it is common to use the differential form of mass conservation equation , thus the time variation of the measure - valued equation for mass in is evolved in time along with the momentum equation , via a leapfrog algorithm with a constant time step . the leapfrog algorithm is a second - order symplectic integrator with the property of preserving the momentum of the system .",
    "the gaussian function , defined by @xmath465 for all @xmath466 , is used for the regularization of the mass measure in the one - dimensional case . for @xmath464 , the cubic wendland function is used , whence for all @xmath467 : @xmath468 these choices are made to illustrate that we can handle both bounded and unbounded support of @xmath42 .",
    "+ in order for the regularized equations of hydrodynamics to approximate the real physics well , @xmath43 should be sufficiently small .",
    "let @xmath469 denote a representative volume assigned to each particle based on the initial configuration . in a bounded domain , typically @xmath469 scales as @xmath470 .",
    "it is common practice to achieve ",
    "@xmath43 sufficiently small \" by taking @xmath471{v_0}$ ] , with parameter @xmath472 , cf .",
    "@xcite . however , the convergence result in theorem [ thm : main thm ] holds for @xmath43 fixed , and the dependence of @xmath43 on @xmath244 is not investigated .",
    "numerically , we investigate both cases .",
    "that is , we take both @xmath473 fixed and @xmath474{v_0}$ ] , which hence varies with the number of particles .    , density @xmath52 at final time @xmath475 , with @xmath476 particles and convergence @xmath477 .",
    "red and blue plots refer to the schemes for @xmath462 and @xmath463 , respectively .",
    "upper plots present results for @xmath478 fixed , while lower plots to variable @xmath479.,width=556 ]    we assume that the initial measure @xmath36 has a density @xmath21 such that @xmath480 for all @xmath440^d$ ] and @xmath481 otherwise . we construct the measure @xmath482 , corresponding to the @xmath244-particle approximation , according to or its @xmath483-dimensional counterpart .",
    "hence , the initial particle configuration is realized for @xmath424 by equipartitioning the initial domain @xmath436 $ ] into @xmath244 volumes .",
    "for the two - dimensional examples , the initial domain is the square @xmath436 ^ 2\\subset\\r^2 $ ] and particles are placed in the center of each square incremental volume partition @xmath469 .",
    "masses are assigned as @xmath484 for each @xmath485 .",
    "note that in case of more complicated initial domains , an equipartitioning may be obtained with a centroidal voronoi tessellation . + as argued underneath , the sequence @xmath486 constructed in this way converges to @xmath36 and the convergence rate is @xmath446{n})$ ] .",
    "hence , the corresponding solutions @xmath487 converge at the same rate ; see the last lines of the proof of part [ thm : part2 ] of theorem [ thm : main thm ] .",
    "+   +    , density @xmath52 at final time @xmath475 , with @xmath476 particles and convergence @xmath477 .",
    "red and blue plots refer to the schemes for @xmath462 and @xmath463 , respectively .",
    "upper plots present results for @xmath478 fixed , while lower plots to variable @xmath479.,width=556 ]    the hydrodynamical problem considers the spontaneous expansion of a gas cloud until time @xmath475 , governed by the equation of state @xmath488 , where @xmath489 is a parameter and @xmath490 the so - called _ polytropic",
    "exponent_. we recall that @xmath101 relates to @xmath6 via @xmath102 . in dimension @xmath424",
    ", we examine the cases @xmath491 , using a constant time step @xmath492 , and the gaussian function .",
    "note that the case @xmath493 is not covered by the convergence proof ( cf .",
    "assumption [ ass : f w theta=0 ] and section [ sect : discussion ] ) .",
    "it is a limit case ( the proof does hold for any @xmath494 ) and we include it for generality . we perform the calculations for @xmath495 particles , where @xmath496 , and compute the supremum in time of the wasserstein distance between subsequent solutions ; cf .  .",
    "we compute the wasserstein distance by solving a linear programming problem based on a formulation in terms of optimal transportation . due to the high computational cost ( for large @xmath497 ) , we use the following approximation @xmath498}\\mathcal{w}(\\mu^{2^k}_t,\\mu^{2^{k+1}}_t ) \\approx \\max_{\\tau\\in i } \\mathcal{w}(\\mu^{2^k}_\\tau,\\mu^{2^{k+1}}_\\tau ) = : w_{k , k+1},\\ ] ] to reduce the number of evaluations of @xmath196 . here ,",
    "@xmath499 and we take @xmath500",
    ". it should be noted , however that for the vast majority of the computations , the maximum distance is observed at the final time step . +   +    , density @xmath52 at final time @xmath475 , with @xmath476 particles and convergence @xmath477 .",
    "red and blue plots refer to the schemes for @xmath462 and @xmath463 , respectively .",
    "upper plots present results for @xmath478 fixed , while lower plots to variable @xmath479.,width=556 ]    the convergence rate for @xmath424 is approximated by @xmath501 and based on the theoretical prediction that the convergence rate is @xmath502 if @xmath424 , we expect that @xmath503 tends to the value @xmath504 .",
    "+   + in figures [ plot_1d - gamma1]-[plot_1d - gamma7 ] , results are shown for the three different values @xmath491 respectively .",
    "red graphs correspond to the scheme for @xmath462 and blue graphs to the scheme @xmath463 . in these figures ,",
    "the upper plots refer to computations using @xmath473 for all resolutions and the lower plots depict computations with @xmath43 varying with the number of particles used .",
    "the left plots show the result for density @xmath52 at @xmath475 , as obtained with the highest resolution @xmath505 .",
    "additionally , the convergence of @xmath506 is plotted in the right plots .",
    "+   + there are several points to be mentioned about the plots .",
    "first , note that in all figures solutions , for @xmath478 fixed and @xmath43 varying , do converge to a solution by increasing the number of particles .",
    "the convergence is evident by the rate @xmath506 approaching its theoretical value @xmath504 .",
    "second , although convergent , solutions for @xmath478 fixed and @xmath43 varying are not the same for the same value of @xmath490 .",
    "third , in figure [ plot_1d - gamma2 ] where @xmath507 , the solutions obtained with the two schemes coincide .",
    "this effect is expected since for this value of @xmath490 the two schemes are identical . on the other hand ,",
    "this is not true for the the cases @xmath493 and @xmath508 .",
    "fourth , interestingly enough , even though the proof only covers cases for @xmath509 , the case @xmath493 converges . in the same case ,",
    "it is unclear why a spike is present in the convergence graph for @xmath462 and varying @xmath43 .",
    "fifth , for fixed value of @xmath43 all cases converge from below sharply towards the theoretical value @xmath510 , while for @xmath43 varying with the resolution they converge from above .",
    "finally , for fixed @xmath478 , this large value does not permit local effects to appear on the free boundaries of the domain .",
    "these effects are exhibited in the cases of varying @xmath43 as discontinuities of the density profile and therefore seem to be related to problems of applying regularization over small @xmath43-sized regions in bounded domains .",
    "+   + in two spatial dimensions , the hydrodynamic problem examined is the expansion of an initially square gas cloud , until time @xmath475 . in order to show that the results also hold for non - static initial conditions , an rotation described by the initial velocity field @xmath511 is applied .",
    "the same equation of state as in the one dimensional computation is used , with @xmath512 . the wendland function and a constant time step of @xmath492",
    "are employed .",
    "note that we omit the case @xmath513 , hence do not need to ` mimic ' assumption [ ass : f w theta=0 ] , and do allow for bounded support in @xmath42 .",
    "+   +    c | c c c c c c + & @xmath497 & 2&3&4&5 & + [ 0.5ex ] + @xmath514 & @xmath142 & -0.51&-0.50&-0.50&-0.50 + @xmath43 fixed & @xmath143 & -0.51&-0.50&-0.50&-0.50 + [ 0.5ex ] + @xmath514 & @xmath142 & -0.44&-0.47&-0.49&-0.44 + @xmath43 varying & @xmath143 & -0.44&-0.47&-0.49&-0.44 + [ 0.5ex ] + @xmath515 & @xmath142 & -0.51&-0.50&-0.50&-0.50 + @xmath43 fixed & @xmath143 & -0.50&-0.50&-0.50&-0.50 + [ 0.5ex ] + @xmath515 & @xmath142 & -0.37&-0.45&-0.48&-0.48 + @xmath43 varying & @xmath143 & -0.41&-0.43&-0.52&-0.51 + [ 1ex ]    [ tab : conv2d ]    for @xmath464 , we approximate the rate of convergence by @xmath516 note that this definition is different from @xmath503 , since in @xmath424 we took @xmath244 of the form @xmath517 , while in @xmath464 we have @xmath518 , for @xmath519 . here , the definition of @xmath520 is modified accordingly to approximations by @xmath521 and @xmath522 particles , respectively . the computational effort for the calculation of the wasserstein distance",
    "makes the investigation of higher @xmath244 extremely lengthy . in the case @xmath464",
    ", theory predicts that the convergence rate is @xmath523 , whence we expect that @xmath524 tends to the value @xmath525 .    , particle configurations at final time @xmath526 for the two - dimensional hydrodynamic experiment of a rotating square ; on the left - hand side with @xmath462 and on the right - hand side with @xmath527 .",
    "the upper plots present results for @xmath478 and @xmath528 particles , while the lower row refers to variable @xmath529 and @xmath528 particles . in this case",
    "( @xmath514 ) , the schemes for @xmath462 and @xmath527 are the same.,width=556 ]    in table [ tab : conv2d ] , the convergence rates of the two - dimensional hydrodynamic problems are shown .",
    "the theoretical value is indeed approached , but strong oscillations around this value appear in the case @xmath507 with varying @xmath43 . in figures",
    "[ plot_2d - gamma2]-[plot_2d - gamma7 ] , particle configurations at final time @xmath526 are presented for the cases @xmath530 respectively .",
    "the upper plots refer to fixed @xmath473 independent of the resolution @xmath244 ( a choice in agreement with the convergence proof ) , while lower plots are obtained by @xmath43 varying with the number of particles as @xmath531 . for the plots on the left - hand side the scheme with @xmath462",
    "is used , while for the plots on the right - hand side @xmath463 is employed . similarly to the one - dimensional results , the corresponding solutions for @xmath507 are identical for the schemes employing @xmath462 or @xmath527 . on the contrary ,",
    "they differ for @xmath508 .",
    "finally , it should be mentioned that the instabilities of the density profile on the boundaries of the domain , which were observed in the one - dimensional computations , have now translated into the nonhomogeneous distribution of particles .",
    "+   + the second numerical example considers the nonlocal force and the drag term , for which the numerical scheme corresponding to does not depend on @xmath204 .",
    "moreover , does not depend on @xmath33 , hence @xmath43 is only relevant if we wish to plot @xmath33 , and not for the computations themselves .",
    "+ the wendland function and a constant time step of @xmath532 are used . for the interactions , we take @xmath200 such that it is the gradient of the _ morse potential _ , see e.g.  @xcite , with parameters @xmath533 .",
    "in fact , we included a short - range regularization around the origin to the potential to enforce the required @xmath534-regularity of @xmath200 .",
    "a side - effect is that automatically self - interactions are cancelled .",
    "two cases for the drag coefficient are examined : @xmath535 and @xmath536 , for final time @xmath537 . in both these cases ,",
    "an equilibrium has been reached .",
    "similarly to the hydrodynamical problem , is used with @xmath538 particles , where @xmath539 .",
    "particle configurations and convergence rates are plotted in figure [ plot_nonlocal ] , with the upper plots referring to @xmath536 and the lower plots to @xmath535 .",
    "the value of the convergence in this case rapidly tends to the theoretically predicted value .    , particle configurations at final time @xmath526 for the two - dimensional hydrodynamic experiment of a rotating square ; on the left - hand side with @xmath462 and on the right - hand side with @xmath527 .",
    "the upper plots present results for @xmath478 and @xmath528 particles , while the lower row refers to variable @xmath529 and @xmath528 particles.,width=556 ]     ( left plots ) and the convergence rates ( right plots ) .",
    "drag coefficients @xmath540 ( upper plot ) and @xmath541 ( lower plot ) are used.,width=556 ]",
    "apart from the remarks already made , there are two issues that are important to point out .",
    "one could call them shortcomings in our approach , in the sense that these are cases to which our proof of convergence does not apply .",
    "the result of theorem [ thm : main thm ] does not state :    * whether the approximations corresponding to @xmath142 and @xmath143 , respectively , actually converge to the same limit solution .",
    "our computations show that this is certainly not the case for @xmath478 and ( although the difference is smaller ) neither for varying @xmath43 , except for the trivial case @xmath514 in which the schemes coincide . *",
    "whether the limit @xmath128 in any of the two cases @xmath142 or @xmath143 is actually like the ` real physics ' . to investigate this , in principle one",
    "would need to consider the limit @xmath45 . as said before , this is beyond the scope of the current paper .",
    "the latter point refers to a situation in which first the limit @xmath128 is taken and afterwards the limit @xmath45 .",
    "a more favourable approach ( also from a numerical point of view ) would be to have @xmath43 depend on @xmath244 in such a way that @xmath542{n})$ ] as @xmath128 , and hence @xmath128 and @xmath45 simultaneously . in section [ sec : num ] , we anticipated this following what is already typically done in the literature of sph and the numerical results there support the hope that solutions converge in the case of @xmath43 varying with the number of particles . +   +",
    "nevertheless , our combined theoretical - computational results establish the convergence of the classical and most - used sph scheme and also show that the corresponding equation of motion is a true discretized version of the equation of motion of a regularized continuous medium .",
    "we thank adrian muntean , mark peletier and fons van de ven ( tu eindhoven , the netherlands ) for fruitful discussions and useful comments . j.h.m .",
    "evers is a member of the institute for complex molecular systems ( icms ) at tu eindhoven , and this work is financially supported by the netherlands organisation for scientific research ( nwo ) , graduate programme 2010 . for i.a .",
    "zisis , this research was carried out under project number m11.4.10412 in the framework of the research program of the materials innovation institute m2i ( www.m2i.nl ) . for b.j .",
    "van der linden it is a research activity of the laboratory of industrial mathematics in eindhoven lime bv ( www.limebv.nl ) .",
    "the arguments in this appendix lead to the statement of theorem [ thm : completenessappendix ] .",
    "this theorem implies that the space @xmath332 defined in is a complete metric space for every @xmath322 .",
    "this result is needed to be able to apply banach s fixed point theorem in the proof of part [ thm : part1 ] of theorem [ thm : main thm ] .",
    "since @xmath547 is complete , it follows from @xcite , proposition 7.1.5 , that @xmath548 is complete . here , @xmath549 is the space of probability measures with bounded first moment .",
    "the statement of the lemma follows from the observation that @xmath550 the inclusion @xmath551 is trivial .",
    "the other inclusion follows from the fact that the first moment of each @xmath552 is bounded by @xmath553 .",
    "the proof mainly follows the lines of the proof of theorem 1.5 - 5 in @xcite ( which treats real - valued continuous functions ) .",
    "+ let @xmath557 denote a cauchy sequence in @xmath558;\\p(b(r)))$ ] .",
    "fix @xmath559 .",
    "there is a @xmath200 such that for all @xmath560 @xmath556}\\,\\mathcal{w}(\\mu_m(\\tau),\\mu_n(\\tau))<\\eps.\\ ] ] for any fixed @xmath90 $ ] , @xmath561}\\,\\mathcal{w}(\\mu_m(\\tau),\\mu_n(\\tau))<\\eps\\ ] ] holds , so @xmath562 is a cauchy sequence in @xmath544 .",
    "it follows from lemma [ lem : pbrcomplete ] that @xmath544 is complete and thus @xmath562 converges to some @xmath563 .",
    "this pointwise limit exists for every @xmath90 $ ] , and we construct a mapping @xmath175 from @xmath24 $ ] to @xmath544 by defining @xmath564 for all @xmath90 $ ] .",
    "+ there is an @xmath565 such that @xmath566}\\,\\mathcal{w}(\\mu_m(\\tau),\\mu_n(\\tau))<\\eps/2\\ ] ] for all @xmath567 ( with the same @xmath98 as before ! ) . in particular , for fixed @xmath90 $ ] , @xmath568 holds for all @xmath567 .",
    "thus , for each fixed @xmath90 $ ] and for each @xmath569 , @xmath570 for sufficiently large @xmath244 . here",
    "we use to estimate the first term on the right - hand side . due to the fact that @xmath571 is defined as the pointwise limit of @xmath572",
    ", the second term can be made arbitrarily small by increasing @xmath244 .",
    "we conclude from that @xmath573 for all @xmath569 . due to , this estimate holds with the same @xmath98 and @xmath565 for all @xmath90 $ ] , whence @xmath243}\\mathcal{w}(\\mu_m(t),\\mu(t))\\leqslant\\eps\\ ] ] for all @xmath569 , which proves the convergence of @xmath574 to @xmath175 .",
    "+ the limit @xmath575\\to\\p(b(r))$ ] is continuous since it is the uniform limit of continuous mappings ( cf .",
    "@xcite thm .",
    "8.3.1 for a proof for real - valued functions that can be extended trivially to our situation ) , hence @xmath576 converges in @xmath558;\\p(b(r)))$ ] .",
    "let @xmath579 be a cauchy sequence .",
    "since @xmath580 and @xmath581 is complete , there is a @xmath582 such that @xmath583 because @xmath584 is a sequence in @xmath577 and @xmath577 is closed , @xmath50 must be an element of @xmath577 .",
    "thus , @xmath577 is complete .",
    "[ thm : completenessappendix ] define for each @xmath543 @xmath585 fix @xmath586 and @xmath153 , and define @xmath587;\\p_r(\\r^d)):\\nu(0)=\\nu_0\\}.\\ ] ] then the following holds : endowed with the metric @xmath556}\\,\\mathcal{w}(\\mu_1(\\tau),\\mu_2(\\tau)),\\ ] ] the space @xmath588 is a complete metric space .    note",
    "that there is a one - to - one correspondence between elements of @xmath589 and elements of @xmath544 .",
    "since lemma [ lem : c0tpbrcomplete ] states that @xmath558;\\p(b(r)))$ ] is complete , the same must hold for @xmath558;\\p_r(\\r^d))$ ] , because convergence in one of these spaces implies convergence in the other .",
    "we omit further details .",
    "+ clearly , @xmath590;\\p_r(\\r^d))$ ] .",
    "we now show that @xmath588 is closed .",
    "let @xmath591 be a sequence that converges to @xmath254;\\p_r(\\r^d))$ ] : @xmath592}\\mathcal{w}(\\mu(t),\\mu_n(t))=0.\\ ] ] we note that @xmath593}\\mathcal{w}(\\mu(t),\\mu_n(t)).\\ ] ] since the left - hand side is independent of @xmath244 , while the right - hand side tends to @xmath28 as @xmath128 , @xmath594 must hold , so @xmath595 . we conclude that @xmath596 and thus @xmath588 is closed .",
    "it follows from lemma [ lem : closedsubsetcomplete ] that @xmath588 is complete ."
  ],
  "abstract_text": [
    "<S> in this paper , we employ measure theory to derive from the principle of least action the equation of motion for a continuum with regularized density field . </S>",
    "<S> the eventual equation of motion depends on the order in which regularization and the principle of least action are applied . </S>",
    "<S> we obtain two different equations , whose discrete counterparts coincide with the scheme used traditionally in the smoothed particle hydrodynamics ( sph ) numerical method , and with the equation treated by di lisio _ et al . _  in @xcite , respectively . additionally , we prove the convergence in the wasserstein distance of the corresponding measure - valued evolutions , moreover providing the order of convergence of the sph method . </S>",
    "<S> the convergence holds for a general class of force fields , including external and internal conservative forces , friction and non - local interactions . </S>",
    "<S> the proof of convergence is illustrated numerically by means of one and two - dimensional examples . </S>",
    "<S> +   + * keywords : *  smoothed particle hydrodynamics , principle of least action , wasserstein distance , measure - valued equations , </S>",
    "<S> convergence rate + * 2010 mathematics subject classification : *  70h25 ; 28a33 ; 65m12 ; 35q70 ; 46e27 ; 70fxx ; 76m25    [ section ] [ theorem]lemma [ theorem]claim [ theorem]proposition [ theorem]postulate [ theorem]definition [ theorem]assumption [ theorem]corollary [ theorem]remark     </S>"
  ]
}