{
  "article_text": [
    "classical and _ ab initio _ molecular dynamics ( aimd ) simulations are among the most common methods for theoretical studies of complex systems at the atomistic level . in the former approach ,",
    "the interatomic forces are usually given explicitly by a sum of pair interactions in analytic form , while the latter approach requires quantum - mechanical calculations to evaluate the forces @xcite .",
    "aimd is gaining popularity in the last decades , because the accuracy of aimd is generally higher than the classical approach . on the other hand , aimd is orders of magnitude more expensive , which poses a serious obstacle to its wide use in industry .    in both approaches ,",
    "the equations of motion for the atoms are typically integrated numerically using the symplectic integrators .",
    "this is because these integrators possess the volume - preserving property in phase space , thus leading to the long - term stability of the simulations @xcite . in classical molecular dynamics simulations , symplectic integrators",
    "are often implemented in the form of a multiple time step algorithm @xcite .",
    "this algorithm allows us to use large time steps for computationally expensive long - range interactions , while inexpensive short - range ones are integrated with small time steps .",
    "in contrast , single time step symplectic integrators , such as the verlet method @xcite , are most commonly used in aimd simulations , because the interatomic forces from _ ab initio _ calculations can not be divided into short- and long - range components exactly .",
    "theoretical analysis reveals that the time step @xmath1 must satisfy @xmath2 in the verlet method @xcite , where @xmath3 is the period of the fastest motion in the system . in many of the classical and",
    "_ ab initio _ studies on real - world problems , however , the time step satisfies @xmath4 , which is significantly smaller than @xmath5 .",
    "this is mainly because the use of a too large time step leads to artifacts such as large fluctuations in the total energy and violation of the equipartition theorem @xcite .",
    "nevertheless , it is empirically known that molecular dynamics simulations using large time steps often yield surprisingly accurate results @xcite .",
    "researchers are making constant efforts to understand and exploit the robustness of various time integrators at large time steps @xcite .    in this paper , we investigate a simple extension of symplectic integrators called the processing technique .",
    "this algorithm was originally developed by mathematicians several decades ago @xcite , but has received little attention to date in spite of its solid theoretical background . as will be shown below",
    ", the processing technique allows us to increase the size of time steps by a factor of two at no extra cost , while keeping the accuracy , and thus significantly extends the applicability of aimd simulations @xcite .",
    "the rest of the paper is organized as follows . in sec.[theosec ] , we present the basic theory of the processed integrator , and estimate the computational costs associated with processing .",
    "numerical examples demonstrate the effectiveness of this algorithm for realistic simulations in sec.[testsec ] . in sec.[dissec ] , we discuss several possible extensions of the algorithm , and present our conclusions .",
    "the classical hamiltonian for a system of @xmath6 atoms is given by @xmath7 where @xmath8 and @xmath9 are vectors of dimension @xmath10 , representing atomic positions and momenta , @xmath11 is the mass matrix , and @xmath12 is the potential energy .",
    "then , the time evolution of any function @xmath13 is given by @xmath14 where the liouville operator @xmath15 is defined by @xcite @xmath16 in particular , @xmath17 and @xmath18 satisfy the equations of motion , @xmath19 a formal solution of these equations is given by @xcite @xmath20 it is easy to prove that the total energy @xmath21 is conserved along the trajectory @xmath22 , i.e. , @xmath23 in general , eq.([exsol ] ) can not be calculated analytically , and thus must be evaluated numerically . to this end , @xmath15 is first divided into two parts ; the kinetic term @xmath24 and the potential term @xmath25 where the force is defined by @xmath26 .",
    "then , using the suzuki - trotter decomposition , we obtain @xmath27 where @xmath1 is the time step , and @xmath28 is given by @xmath29 if the @xmath30 terms are neglected , the time evolution of @xmath31 can be written as @xmath32 where the subscript denotes the time - step number , i.e. , @xmath33 . the right - hand side of eq.([timeevol ] )",
    "can be calculated explicitly @xcite , which leads to the ( velocity ) verlet method : @xmath34 this integrator is both symplectic and time - reversible .",
    "these properties are crucial for long - term stability of the simulations @xcite . moreover ,",
    "only one force evaluation is required per step in the verlet method .",
    "it is also possible to use higher - order integration schemes @xcite , which require multiple force evaluations per step .",
    "these integrators can significantly improve the accuracy for small time steps .",
    "however , the verlet method is more robust at large time steps @xcite which are commonly used in aimd to minimize the computational cost .",
    "therefore , the verlet method is still the method of choice for aimd . in the following ,",
    "we focus on the verlet method , and assume the use of the microcanonical ensemble unless otherwise noted .",
    "extensions to more general cases will be discussed in sec.[dissec ] .",
    "when the verlet method is used to follow the time evolution of the system , the hamiltonian is no longer a constant of motion , because eq.([eqdhdt ] ) holds only approximately .",
    "however , any symplectic integrator , including the verlet method , is known to possess a conserved quantity called the shadow ( or modified ) hamiltonian @xmath35 @xcite .",
    "while the explicit form of @xmath36 is not known in general , a series expansion in powers of @xmath1 is valid under mild assumptions @xcite : @xmath37 in particular , the lowest - order term @xmath38 corresponding to the verlet method is given by @xcite @xmath39 where the hessian matrix @xmath40 is defined by @xmath41 , and the hessian - vector product ( @xmath42 ) can be calculated according to appendix [ hvsec ] .",
    "higher - order terms are also available in the literature @xcite .    in fig.[shdfig ]",
    ", we show the time evolution of the original and shadow hamiltonians for a classical model of water .",
    "the expansion of the shadow hamiltonian truncated at @xmath43 shows much better conservation than the original hamiltonian .",
    "further improvement is observed if the @xmath44 term is included . as is evident from this example , higher - order expansion of the shadow hamiltonian is essentially a constant of motion if the interatomic forces are sufficiently accurate .",
    "therefore , the shadow hamiltonian is often used to detect the errors in forces @xcite caused by , e.g. , inappropriate truncation of interactions .",
    "alternatively , the shadow hamiltonian can be used to improve the performance of the hybrid monte carlo method @xcite . however , as will be shown below , we can go a step further and take advantage of the shadow hamiltonian to construct an integrator which provides a more accurate trajectory for a given time step .      if we invert eq.([hseq ] ) , we obtain @xmath45 which implies that the fluctuations of the total energy are dominated by @xmath38 . here",
    "we show how to construct an accurate integrator by direct optimization of @xmath46 through the introduction of pre- and postprocessing @xcite .",
    "this approach allows us to minimize the effect of time - step size , while the computational cost per time step remains the same . in this approach",
    ", the time evolution of @xmath47 is calculated in three steps :    1 .",
    "preprocessing is defined by a symplectic transformation of the form @xmath48 where @xmath49 and @xmath50 is the auxiliary hamiltonian to be described later . @xmath51 and @xmath52 are intermediate variables with no physical meaning . 2 .",
    "time integration is performed as follows : @xmath53 where @xmath28 is a symplectic approximation to @xmath54 , given , e.g. , by eq.([l2l1l2 ] ) .",
    "postprocessing is the inverse of preprocessing : @xmath55    the entire propagator @xmath56 can be expressed as @xmath57 which also preserves the symplectic structure .",
    "then , we can easily show that @xmath58 when an initial set of @xmath59 is given , we first calculate @xmath60 according to eq.([prepro1 ] ) .",
    "then , we follow the time evolution of @xmath60 by repeatedly applying eq.([sinteg ] ) , which yields @xmath61 for @xmath62 . only when output is required , we calculate @xmath63 using eq.([postpro1 ] ) .",
    "the flow of the algorithm is shown in fig.[fchart ] .    at this point , we discuss the choice of @xmath50 which appears in the definition of pre- and postprocessing . assuming that the verlet method is used for time integration , we adopt the form @xcite @xmath64 where @xmath65 is an arbitrary constant @xcite .",
    "then , the lowest - order term of the shadow hamiltonian corresponding to the processed verlet method of eq.([psieq ] ) is given by @xcite @xmath66 the value of @xmath65 should be chosen to minimize the fluctuations of @xmath67 . to this end , we assume that @xmath12 is a quadratic function of @xmath8 , @xmath68 where @xmath69 is a constant matrix . then , using @xmath70 and @xmath71 , we can prove that @xmath72 thus , if we choose @xmath73 , @xmath74 will hold , which is considered the optimal choice in terms of total energy conservation @xcite . in the following",
    ", the same value of @xmath65 will be used for more general potential functions , including aimd simulations .      by construction ,",
    "the processed integrator presented in the previous section improves the conservation of the total energy for a given time step , or , alternatively , allows the use of a larger time step for a given accuracy .",
    "however , this advantage would be lost if the overhead of processing were significant . here",
    "we compare the computational costs of the verlet method with and without the processing .",
    "when the standard verlet method is used to integrate the equations of motion , we obtain @xmath63 and the corresponding values of @xmath75 at the expense of one force evaluation per step . at first glance",
    ", it may appear a significantly more complicated task to calculate the values of @xmath63 and @xmath76 at each step of the processed verlet method .",
    "as will be shown below , however , these values can be obtained without additional effort if the postprocessing is carefully implemented .",
    "we first note that the cost of the time - stepping procedure , eq.([sinteg ] ) , is equal to the underlying integrator , i.e. , one force evaluation ( @xmath77 ) .",
    "moreover , the preprocessing , eq.([prepro1 ] ) , needs to be performed only once to calculate @xmath60 at the beginning of the simulation , and is canceled out by the postprocessing in subsequent steps .",
    "therefore , the computational cost of preprocessing can be safely ignored .",
    "the numerical implementation of the preprocessing is presented in appendix [ prepsec ] .",
    "we also note that when we start from random initial conditions , preprocessing may even be omitted altogether @xcite .    at variance with preprocessing",
    ", the postprocessing is required much more frequently , and thus the numerical integration of eq.([postpro1 ] ) is prohibitive . instead",
    ", we rely on a truncated series expansion in powers of @xmath1 @xcite : @xmath78 while this procedure preserves the symplectic structure only approximately , the errors in @xmath63 do not accumulate with @xmath79 , as is evident from fig.[fchart ] . therefore , the use of eqs.([qpost ] ) and ( [ ppost ] ) does not affect the long - term stability of the integrator .",
    "moreover , the error terms of @xmath44 are smaller than those of the verlet method .",
    "we also note that the cost of evaluating eq.([qpost ] ) is negligible , since @xmath77 has already been calculated in the time - stepping procedure .",
    "therefore , the values of @xmath80 are available at no extra cost , which may be used to calculate various properties such as the radial distribution functions .    in contrast , a hessian - vector product is required to calculate @xmath81 using eq.([ppost ] ) .",
    "the cost of this procedure is comparable to one force evaluation , as explained in appendix [ hvsec ] , which offsets the gain from the use of a larger time step .",
    "a simple solution to this problem is to use an alternative expression based on the finite - difference approximation @xcite : @xmath82 which has larger @xmath44 errors , but may be calculated at negligible cost .",
    "as will be shown in sec.[testsec ] , eq.([ppost2 ] ) is sufficiently accurate for _ a posteriori _ analysis of the trajectories obtained from microcanonical simulations .    in order to obtain the values of @xmath83 at each time step with minimal overhead",
    ", we propose to use an expansion of the form @xmath84 this method is similar in spirit to the work of zhang @xcite . in",
    "what follows , eqs.([ppost2 ] ) and ( [ upost ] ) will be referred to as the cheap approximations .    in summary ,",
    "the processed verlet method allows us to generate a trajectory ( @xmath85 , and @xmath86 ) at the expense of only one force evaluation per step if eqs.([qpost ] ) , ( [ ppost2 ] ) , and ( [ upost ] ) are used .",
    "the accuracy of this method is compared with that of the original method in sec.[testsec ] .",
    "we first explore the basic properties of the processed verlet method using a one - dimensional harmonic oscillator which has been studied extensively in the past @xcite .",
    "the hamiltonian is given by @xmath87 where @xmath88 and @xmath89 denote the mass and frequency , respectively .",
    "then , from eq.([ppdef ] ) , we obtain @xmath90 the corresponding preprocessing can be written as @xmath91 similarly , the postprocessing is given by @xmath92 moreover , the verlet integrator is given by @xmath93 with @xmath94 now the entire propagator @xmath95 can be written as @xmath96 with @xmath97 which also preserves the symplectic structure @xcite .",
    "the exact shadow hamiltonian corresponding to @xmath95 is also available : @xmath98 with @xmath99 if we choose @xmath73 , the @xmath43 terms of @xmath100 vanish , regardless of the value of @xmath89 , thus minimizing the violation of energy equipartition arising from the use of a finite time step . on the other hand , if @xmath101 is used , eq.([hs1d ] ) reduces to the well - known formula for the standard verlet method @xcite . in fig.[hofig](a ) , we compare the trajectories in phase space with and without the processing .",
    "the trajectory of the processed verlet method is nearly indistinguishable from the exact solution .",
    "we now turn to the dynamical behavior of @xmath102 generated by the processed verlet method .",
    "the eigenvalues of @xmath95 can be written as @xmath103 , where the modified frequency @xmath104 is defined by @xmath105 this result is the same as that for the standard verlet integrator @xcite .",
    "in particular , @xmath104 does not depend on @xmath65 , which implies that the use of processing does not improve the dynamics @xcite .",
    "this is also evident from fig.[hofig](b ) , where the errors in the amplitude are significantly reduced , while the phase errors remain uncorrected .",
    "we note in passing that eq.([transomg ] ) imposes a limit on the maximum size of @xmath1 , as mentioned in sec.[introsec ] .",
    "since @xmath104 is a real number , @xmath1 must satisfy @xmath106 , or , equivalently , @xmath107 where the period @xmath3 is defined by @xmath108 .      to demonstrate the effectiveness of the processing technique in more realistic problems , we have performed classical molecular dynamics simulations of liquid water under various conditions .",
    "liquid water was modeled by 125 water molecules in a cubic supercell of length 15.67  , which corresponds to the density at 353 k. the molecular interaction was described by the spc / fw force field @xcite , which is based on a flexible point - charge water model .",
    "all interactions were truncated beyond a cutoff distance of 14 bohr using a quintic switching function @xcite .",
    "the equations of motion were integrated with the standard and processed verlet methods using time steps of 0.3 , 0.6 , ... , 2.1 fs .",
    "the simulation was also marginally stable at @xmath109 2.4 fs , which corresponds to one - quarter of the period of the o - h stretching motion ( 9 - 10 fs ) .",
    "however , this case was excluded from the analysis , because the total energy exhibited a significant drift as well as large fluctuations .",
    "we also note that the use of processing has no effect on the maximum stability limit , which is dominated by the underlying integrator , i.e. , the verlet method .",
    "all simulations were started from the same initial conditions @xmath59 , which were obtained after equilibration , and lasted for 1.2 ns in the microcanonical ensemble .",
    "preprocessing was performed numerically exactly , while the postprocessing was approximated as discussed in sec.[costsec ] .",
    "we first investigate the accuracy of numerical integration with and without the processing . in fig.[naclwfig",
    "] , we show the fluctuations of the total energy , average potential energies , and average temperatures , each as a function of time step . the fluctuations were calculated as the standard deviation from a linear fit to the total energy .",
    "the drift was negligibly small in all runs .",
    "figure [ naclwfig ] suggests that the numerical accuracy of the verlet method using a time step of @xmath1 is comparable to that of the processed verlet method using @xmath110 .",
    "moreover , the effect of cheap approximation is found to be small for both atomic momentum ( eq.([ppost2 ] ) ) and potential energy ( eq.([upost ] ) ) .",
    "therefore , the processed verlet method is more efficient than the original method by about a factor of two , in agreement with previous studies @xcite .",
    "now we compare the structural properties obtained from each run . in table",
    "[ bondtbl1 ] , we show the average lengths of covalent o - h bonds , together with their fluctuations .",
    "the average values are found to be insensitive to @xmath1 , while the fluctuations show an increase of 10 % at large time steps for the verlet method .",
    "in contrast , all results from the processed verlet method agree within statistical errors .",
    "the intermolecular structure is described by @xmath111 , @xmath112 , and @xmath113 , representing oxygen - oxygen , oxygen - hydrogen , and hydrogen - hydrogen radial distribution functions , respectively .",
    "the error caused by the finite size of the time step is defined by @xmath114 where we set @xmath115 = 7.5  , and the reference values ( @xmath116 , @xmath117 , and @xmath118 ) are the results for @xmath119 fs without processing .",
    "the residual errors shown in fig.[rdffig](a ) suggest that although the processed verlet method is more accurate than the standard verlet method , the improvement is relatively small , being comparable to a time step reduction of only 0.3 fs . to make this point more explicit , we compare @xmath111 for @xmath120 fs with and without the processing in fig.[rdffig](b ) .",
    "this figure indicates that the intermolecular structure of this system can be described with reasonable accuracy using large time steps near the stability limit , even if no processing is applied .",
    "this is mainly because the intermolecular structure of liquid water is relatively insensitive to the intramolecular vibrations , as demonstrated by the success of rigid water models @xcite .",
    "we now turn to the dynamical properties of this system . to this end , we have calculated the power spectra and self - diffusion coefficients , as shown in figs.[psfig ] and [ dselffig ] . the power spectrum @xmath121 is defined by @xmath122 where @xmath123 is the velocity of atom @xmath124 at time @xmath125 , and",
    "the angle brackets denote the autocorrelation function .",
    "the self - diffusion coefficient @xmath126 is given by @xcite @xmath127 as already mentioned in sec.[harmsec ] , there is no reason to expect that the dynamical properties are improved by the use of processing .",
    "our results for @xmath121 and @xmath126 are consistent with this observation .",
    "in particular , the high - frequency part of the spectra shown in fig.[psfig](a ) exhibits a substantial blue shift at large time steps regardless of the use of processing , while the low - frequency part ( below 1000 @xmath128 ) remains the same in all cases .",
    "we have found , however , that the peak positions of the spectra in the limit of zero time step can be accurately estimated by a simple correction formula , @xmath129 which corresponds to the inverse of eq.([transomg ] ) .",
    "here @xmath130 denotes the frequency at zero time step .",
    "we compare the power spectra with and without the correction in fig.[psfig](b ) , where the corrected results show excellent agreement with each other .",
    "we also note that eq.([transomg2 ] ) is valid whether or not the processing is applied .",
    "therefore , this procedure is also useful for estimating the correct peak positions in conventional molecular dynamics simulations . as is evident from fig.[dselffig ]",
    ", the self - diffusion coefficient remains nearly constant at small time steps ( @xmath131 fs ) , and grows slowly with @xmath1 at larger time steps in both methods .",
    "these results are consistent with the claim that the use of processing has no apparent effect on the dynamical properties @xcite .      in principle , the processing technique should be equally valid for aimd simulations . however , we are not aware of any previous work in this direction . here",
    "we study the effect of processing on the performance of aimd simulations for liquid water .",
    "liquid water at 423 k was modeled by 64 molecules in a cubic supercell of length 13.92 @xcite .",
    "atomic forces were calculated within the density functional theory @xcite , and norm - conserving pseudopotentials were employed @xcite . only the @xmath132-point was used to sample the brillouin zone .",
    "the electronic orbitals were expanded by the finite - element basis functions @xcite with an average cutoff energy of 58 ryd , while the resolution was enhanced by about a factor of 2 near the oxygen atoms by adaptation of the grid @xcite .",
    "the electronic states were quenched to the born - oppenheimer surface at each time step with the limited - memory bfgs method in mixed precision arithmetic @xcite .",
    "the equations of motion for the atoms were integrated using the verlet method with and without the processing .",
    "after several preliminary runs , the verlet method was found to be stable up to @xmath133 1.2 fs , while a significant drift in the total energy was observed at @xmath134 fs .",
    "these values are somewhat smaller than the corresponding values for the classical model , even though the highest frequency is nearly the same in both cases .",
    "this discrepancy is explained by the strong anharmonicity of the potential energy surface obtained from _ ab initio _",
    "calculations @xcite .",
    "after equilibration , production runs of 30 ps were carried out in the microcanonical ensemble using @xmath133 0.3 , 0.6 , 0.9 , and 1.2 fs @xcite .",
    "we used the same initial conditions @xmath59 and experimental masses for all atoms in these runs . for comparison",
    ", we also include the results for the processed verlet method using the optimized masses ( @xmath135 4.5 , @xmath136 9 ) @xcite and @xmath133 1.0 , 1.5 , and 2.0 fs . when going from the experimental to the optimized masses , the highest - frequency peak moves from 3600 @xmath128 to 2100 @xmath128 .",
    "therefore , the value of @xmath137 for @xmath133 1.2 fs in the former case is comparable to that for @xmath133 2.0 fs in the latter case .",
    "the initial conditions for @xmath31 were adjusted to give the same total energy as for the experimental masses , and after re - equilibration , data were collected for 30 ps .    in fig.[aimd1fig ]",
    ", we show the fluctuations of the total energy for all runs .",
    "although the results show some scatter , the processed verlet method is approximately twice as efficient as the verlet method , in agreement with the classical case .",
    "an additional gain is obtained by the mass scaling method @xcite . in particular , the accuracy of the processed verlet method using @xmath133 2.0 fs and the optimized masses is comparable to that of the standard verlet method using @xmath133 0.6 fs . moreover , the use of cheap approximations results in only small changes in accuracy .",
    "figure [ pv2enefig ] shows the time evolution of the total and potential energies with and without the processing .",
    "we now compare the average lengths of covalent o - h bonds from aimd simulations in table [ bondtbl2 ] .",
    "similar to the classical case , the average values are insensitive to the size of time steps , while the fluctuations are clearly improved by the use of processing .",
    "the probability distributions of o - h bond length are also shown in fig.[ohprobfig ] .",
    "all curves except that of the standard verlet method using @xmath138 fs are nearly identical .",
    "figure [ dftgoofig ] shows the oxygen - oxygen radial distribution functions in selected cases .",
    "unfortunately , the statistical errors due to the limited length of our simulations are found to be larger than the systematic errors due to the finite time step , particularly at large distances .",
    "however , all runs give very similar results for the first peak at 2.8  .",
    "this is not surprising considering the small errors in the classical case shown in fig.[rdffig ] .",
    "thus far , we have focused on the implementation of the processed verlet method in the microcanonical ensemble . however , the use of a thermostat is often desired in real applications to generate the canonical ensemble @xcite .",
    "unfortunately , many of the standard thermostats require the values of instantaneous temperature @xcite , and thus we need to calculate @xmath81 on - the - fly using eq.([ppost ] ) at each time step .",
    "the performance gain from the processed verlet method is offset by the computational overhead of this procedure .",
    "one possible solution to this problem is to use the stochastic thermostat originally developed by heyes @xcite . in this approach",
    ", the temperature needs to be evaluated and updated less frequently , say every 10 steps , and during each interval , the equations of motion are integrated in the microcanonical ensemble .",
    "therefore , the cost of calculating the instantaneous temperature is reduced to an acceptable level .",
    "the temperature is updated by scaling all atomic momenta by a common factor @xmath139 .",
    "after the update , we do not need to preprocess the new momenta explicitly thanks to eq.([pscale_eq ] ) .",
    "the overhead is further reduced if eq.([ppost2 ] ) is used for calculating @xmath81 , because the update is often skipped in the heyes thermostat @xcite .",
    "preliminary results suggest that the canonical ensemble can actually be generated with an overhead of 5 - 10 % .",
    "another possible extension of the present algorithm is the higher - order integrator which was first introduced by rowlands @xcite , and later reformulated by lpez - marcos _ et al .",
    "this integrator also consists of three steps , as already mentioned in sec.[pintsec ] .",
    "the time integration step corresponding to eq.([sinteg ] ) is given by @xmath140_n \\\\",
    "\\label{rwlds2 } { { \\bf q}}_{n+1 }        & = & { { \\bf q}}_n + h m^{-1 } { { \\bf p}}_{n+\\frac12 } \\\\ \\label{rwlds3 } { { \\bf p}}_{n+1 }        & = & { { \\bf p}}_{n+\\frac12 } + \\frac{h}{2 } \\ ,   \\left [ { { \\bf f}}- \\alpha h^2 { \\cal h } m^{-1 } { { \\bf f}}\\right]_{n+1 } \\end{aligned}\\ ] ] with @xmath141 @xcite .",
    "the auxiliary hamiltonian of eq.([ppdef ] ) should also be extended to include @xmath30 terms @xcite . in order to evaluate the performance of this algorithm ,",
    "several test calculations have been carried out .",
    "the results indicate significant improvement of accuracy for a given time step compared to the processed verlet method .",
    "moreover , the maximum stability limit is increased by a factor of @xmath142 1.5 . on the other hand ,",
    "the computational cost per time step is about twice as expensive as that of the processed verlet method , because we need to calculate a hessian - vector product at each step .",
    "therefore , the increase in time - step size is insufficient to compensate for the overhead , and thus the processed verlet method should be preferred in terms of total performance . if , however , a highly accurate trajectory is required , this approach would be a viable option .    in summary ,",
    "the processed verlet method is about twice as efficient as the standard verlet method if the cheap approximation to the postprocessing is applied .",
    "we have also shown how to generate the canonical ensemble with only a small overhead .",
    "this algorithm would be particularly useful for aimd simulations which are not easily compatible with the multiple time step algorithm @xcite .",
    "it is also straightforward to use this algorithm in conjunction with other methods which accelerate the electronic structure calculations @xcite , as well as efficient sampling of the phase space @xcite .",
    "this work has been supported by the strategic programs for innovative research ( spire ) and a kakenhi grant ( 22104001 ) from the ministry of education , culture , sports , science & technology ( mext ) , the japan - us cooperation project for research and standardization of clean energy technologies from the ministry of economy , trade , and industry ( meti ) , and the computational materials science initiative ( cmsi ) , japan .",
    "part of the calculations were carried out using the computer facilities at research institute for information technology , kyushu university .",
    "evaluation of a hessian - vector product ( @xmath143 ) for any given vector @xmath144 is required , e.g. , in eqs.([h2eq ] ) , ( [ ppost ] ) , and ( [ rwlds1 ] ) .",
    "each element of @xmath145 can be written as @xmath146 where @xmath8 denotes the current atomic positions .",
    "when @xmath12 is given by a sum of pair interactions , @xmath145 can be calculated analytically , and its computational cost is comparable to that of @xmath147 @xcite . a more complicated procedure is required for aimd , because the explicit form of @xmath148 is unknown .",
    "let us assume that @xmath148 , @xmath147 , and the corresponding ground - state orbitals @xmath149 have already been calculated .",
    "then , @xmath145 can be evaluated in either of the two ways : by the density functional perturbation theory @xcite or by the finite - difference method .    in the density functional perturbation theory ,",
    "we first obtain the change of @xmath149 induced by an infinitesimal displacement of atoms along @xmath144 , denoted by @xmath150 , from the iterative solution of the sternheimer equation @xcite .",
    "then , @xmath145 can be calculated analytically using @xmath149 and @xmath150 @xcite .",
    "the computational cost of this procedure is comparable to that of calculating @xmath147 @xcite .",
    "we note , however , that the numerical implementation of the density functional perturbation theory requires significant programming efforts .",
    "alternatively , if we calculate the forces at @xmath151 , @xmath145 may be evaluated by the finite - difference method : @xmath152 where @xmath153 is a small positive constant . at first glance",
    ", the second approach may look twice as expensive as the first .",
    "however , the calculation of @xmath154 is much cheaper than that of @xmath155 , because an extremely good initial guess for @xmath156 is available from eq.([exteq1 ] ) @xcite .",
    "therefore , the total cost of this approach is also comparable to one force evaluation . for simplicity",
    ", we have adopted the finite - difference approach throughout this study .    in either case , the directional derivative ,",
    "@xmath157 is obtained as a by - product , which may be utilized to enhance the initial guess , as explained in appendix [ extsec ] .",
    "here we show how to perform the preprocessing of eq.([prepro1 ] ) explicitly for @xmath158 , @xmath159 the right - hand side of eq.([prepro_app ] ) can be calculated by integrating the equations of motion for @xmath160 , @xmath161 from @xmath162 to @xmath163 , assuming that @xmath164 and @xmath50 is given by eq.([ppdef ] ) . the hessian - vector product appearing in eq.([dpdteq ] )",
    "can be calculated according to appendix [ hvsec ] .",
    "these equations can be integrated numerically by any standard method @xcite . a fully converged solution @xmath165 is typically obtained at the expense of 10 - 20 force evaluations .",
    "it is worth noting that when eq.([prepro_app ] ) holds , so does @xmath166 for any constant @xmath167 , because eqs.([dqdteq ] ) and ( [ dpdteq ] ) are separable .",
    "this property is useful for scaling the atomic momenta when the temperature is controlled by a thermostat .",
    "the computational cost of aimd simulations is dominated by an iterative procedure for calculating the ground - state orbitals @xmath168 for each @xmath79 @xcite .",
    "therefore , it is important to start from a good initial guess for @xmath169 to minimize the computational effort . to this end",
    ", we present several possible approximations to @xmath170 , denoted by @xmath171 . for simplicity ,",
    "we limit ourselves to non - metallic systems here , and @xmath31 should be replaced by @xmath172 when necessary . assuming that @xmath173 with @xmath174 and @xmath175 , we can show that @xmath176 where @xmath177 and @xmath178 are given by eq.([phidrv ] ) .",
    "the simplest choice , @xmath179 is sometimes useful , but far from satisfactory @xcite .",
    "a more reasonable initial guess is given by @xmath180 which is robust and more efficient .",
    "similarly , higher - order extrapolation formulae can be derived by using @xmath181 @xcite .",
    "while these formulae give better performance at small time steps , instabilities occur at large time steps @xcite .",
    "therefore , we usually use eq.([exteq1 ] ) in our aimd simulations .",
    "if , however , the derivatives of @xmath182 are available , we can derive another set of formulas which works well for large time steps .",
    "for instance , when the postprocessing for atomic momenta is performed on - the - fly using eq.([ppost ] ) , we need to calculate @xmath183 explicitly .",
    "then , we can eliminate the @xmath43 term by making use of @xmath184 which is obtained as a by - product : @xmath185 alternatively , when eqs.([rwlds1]-[rwlds3 ] ) are used to integrate the equations of motion , we need to calculate @xmath186 at each time step .",
    "then , we can exploit @xmath187 to estimate the initial guess with reduced @xmath43 errors : @xmath188 when these advanced extrapolation schemes are used , the number of iterations required for electronic structure calculations is reduced by 10 - 30 % compared to eq.([exteq1 ] ) .",
    "a similar approach may also be useful for geometry optimization problems @xcite .                                                        in recent years",
    ", much effort has been made to perform accurate aimd simulations using noisy forces @xcite , in the spirit of car - parrinello fictitious dynamics @xcite . at variance with these approaches , we focus on the born - oppenheimer molecular dynamics using a small tolerance in this work .    a.  m.  n.  niklasson , c.  j.  tymczak , and m.  challacombe , phys .",
    "lett . * 97 * , 123001 ( 2006 ) . f.  r.  krajewski and m.  parrinello , phys .",
    "b * 73 * , 041105(r ) ( 2006 ) .",
    "t.  d.  khne , m.  krack , f.  r.  mohamed , and m.  parrinello , phys .",
    "lett . * 98 * , 066401 ( 2007 ) .",
    "j.  l.  alonso , x.  andrade , p.  echenique , f.  falceto , d.  prada - gracia , and a.  rubio , phys .  rev .",
    "* 101 * , 096403 ( 2008 ) .",
    "a.  m.  n.  niklasson , p.  steneteg , a.  odell , n.  bock , m.  challacombe , c.  j.  tymczak , e.  holmstrm , g.  zheng , and v.  weber , j.  chem .  phys . *",
    "130 * , 214109 ( 2009 ) .",
    "j.  dai and j.  yuan , europhys .  lett .",
    "* 88 * , 20001 ( 2009 ) .",
    "r.  p.  steele , m.  head - gordon , and j.  c.  tully , j.  phys .",
    "a * 114 * , 11853 ( 2010 ) .",
    "l.  lin , j.  lu , and s.  shao , entropy * 16 * , 110 ( 2014 ) .",
    "a.  m.  n.  niklasson and m.  j.  cawkwell , j.  chem .  phys . * 141 * , 164123 ( 2014 ) .",
    "r.  car and m.  parrinello , phys .",
    ".  lett . *",
    "55 * , 2471 ( 1985 ) .",
    "s.  duane , a.  d.  kennedy , b.  j.  pendleton , and d.  roweth , phys .",
    "b * 195 * , 216 ( 1987 ) .",
    "j.  a.  izaguirre and s.  s.  hampton , j.  comput",
    ".  phys . * 200 * , 581 ( 2004 ) .",
    "e.  akhmatskaya and s.  reich , j.  comput",
    ".  phys . *",
    "227 * , 4934 ( 2008 ) . c.  r.  sweet , s.  s.  hampton , r.  d.  skeel , and j.  a.  izaguirre , j.  chem",
    ".  phys . * 131 * , 174106 ( 2009 ) .                                                                                             , ( b ) @xmath190 , and ( c ) @xmath191 , for a classical model of water using a time step of 1 fs ( see sec.[clmdsec ] ) .",
    "@xmath192 is chosen as the origin , and only up to the second derivatives of @xmath148 are taken into account when calculating @xmath193.,width=302 ]       and @xmath194 , @xmath195 .",
    "( a ) trajectories in phase space for the standard verlet method ( @xmath196 ) and the processed verlet method ( p - verlet , @xmath197 ) .",
    "( b ) time evolution of @xmath198 .",
    "dashed lines denote the theoretical minimum / maximum values ( @xmath199).,width=302 ]                 1.2 fs : ( a ) total energy obtained from the standard verlet method , ( b ) total energy from the processed verlet method , and ( c ) potential energy from the processed verlet method .",
    "the inset is a magnification of the total energies.,width=302 ]"
  ],
  "abstract_text": [
    "<S> in _ ab initio _ molecular dynamics simulations of real - world problems , the simple verlet method is still widely used for integrating the equations of motion , while more efficient algorithms are routinely used in classical molecular dynamics . </S>",
    "<S> we show that if the verlet method is used in conjunction with pre- and postprocessing , the accuracy of the time integration is significantly improved with only a small computational overhead . </S>",
    "<S> the validity of the processed verlet method is demonstrated in several examples including _ ab initio _ molecular dynamics simulations of liquid water . </S>",
    "<S> the structural properties obtained from the processed verlet method are found to be sufficiently accurate even for large time steps close to the stability limit . </S>",
    "<S> this approach results in a 2@xmath0 performance gain over the standard verlet method for a given accuracy . </S>"
  ]
}