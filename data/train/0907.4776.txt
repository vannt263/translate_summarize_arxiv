{
  "article_text": [
    "path - ensemble averages play a central role in nonequilibrium statistical mechanics , akin to the role of configurational ensemble averages in equilibrium statistical mechanics .",
    "expectations of various functionals over processes where a system is driven out of equilibrium by a time - dependent external potential have been shown to be related to equilibrium properties , including free energy differences @xcite and thermodynamic expectations .",
    "@xcite the latter relationship , between equilibrium and nonequilibrium expectations , has been applied to several specific cases , such as : the potential of mean force ( pmf ) along the pulling coordinate @xcite ( or other observed coordinates @xcite ) in single - molecule pulling experiments ; rna folding free energies as a function of a control parameter ; @xcite the root mean square deviation from a reference structure ; @xcite the potential energy distribution @xcite and average ; @xcite and the thermodynamic length .",
    "@xcite    compared to equilibrium sampling , nonequilibrium processes may be advantageous for traversing energetic barriers and accessing larger regions of phase space per unit time .",
    "this is useful , for example , in reducing the effects of experimental apparatus drift or increasing the sampling of barrier - crossing events .",
    "thus , there has been interest in calculating equilibrium properties from nonequilibrium trajectories collected in simulations or laboratory experiments . indeed , single - molecule pulling data has been used to experimentally verify relationships between equilibrium and nonequilibrium quantities .",
    "@xcite    while many estimators for free energy differences @xcite and equilibrium ensemble averages can be constructed from nonequilibrium relationships , they will differ in the efficiency with which they utilize finite data sets , leading to varying amounts of statistical bias and uncertainty .",
    "characterization of this bias and uncertainty is helpful for comparing the quality of different estimators @xcite and assessing the accuracy of a particular estimate . the statistical uncertainty of an estimator is usually quantified by its variance in the asymptotic , or large sample , limit , where estimates from independent repetitions of the experiment often approach a normal distribution about the true value due to the central limit theorem .",
    "it is an important goal to find an optimal estimator which minimizes this asymptotic variance .    although numerical estimates of the asymptotic variance may be provided by bootstrapping ( e.g.  ref .",
    "@xcite ) , closed - form expressions can provide computational advantages in the computation of confidence intervals , allow comparison of asymptotic efficiency , @xcite and facilitate the design of adaptive sampling strategies to target data collection in a manner that most rapidly reduces statistical error .",
    "@xcite in the asymptotic limit , the statistical error in functions of the estimated parameters can be estimated by propagating this variance estimate via a first - order taylor series expansion .",
    "while this procedure is relatively straightforward for simple estimators , it can be difficult for estimators that involve arbitrary functions ( e.g. nonlinear or implicit equations ) of nonequilibrium path - ensemble averages .",
    "fortunately , the extended bridge sampling ( ebs ) estimators , @xcite a class of equations for estimating the ratios of normalizing constants , are known to have both minimal - variance forms and associated asymptotic variance expressions .",
    "recently , shirts and chodera @xcite applied the ebs formalism to generalize the bennett acceptance ratio , @xcite producing an optimal estimator combining data from multiple equilibrium states to compute free energy differences , thermodynamic expectations , and their associated uncertainties . here , we apply the ebs formalism to estimators utilizing nonequilibrium trajectories .",
    "we first construct a general minimal - variance path - average estimator that can use samples collected from multiple nonequilibrium path - ensembles .",
    "we then show that some existing path - average estimators using uni- and bidirectional data are special cases of this general estimator , proving their optimality .",
    "this also allows us to develop asymptotic variance expressions for estimators based on jarzynski s equality @xcite and the hummer - szabo expressions for the pmf .",
    "@xcite we then demonstrate them on simulation data from a simple one - dimensional system and comment on their applicability .",
    "suppose that we sample @xmath0 paths ( trajectories ) from each of @xmath1 path - ensembles indexed by @xmath2 .",
    "the path - ensemble average of an arbitrary functional @xmath3 $ ] in path - ensemble @xmath4 is defined by @xmath5 \\ ,",
    "\\rho_i[x ] , \\label{eq : path_average}\\ ] ] where @xmath6 $ ] is a probability density over trajectories , @xmath7 = c_i^{-1 } q_i[x ] \\:\\ : ; \\:\\ : c_i = \\int dx \\ , q_i[x ] , \\label{eq : path_density}\\end{aligned}\\ ] ] with unnormalized density @xmath8 > 0 $ ] and the normalization constant @xmath9 ( a path partition function ) .",
    "the above integrals , in which @xmath10 is an infinitesimal path element , are taken over all possible paths , @xmath11 .",
    "extended bridge sampling estimators provide a way of estimating ratios of normalization constants @xmath12 , which will prove useful in estimating free energies and thermodynamic expectations .",
    "to construct these estimators , we first note the importance sampling identity , @xmath13 \\right ] \\frac { \\int dx \\ , \\alpha_{ij}[x ] \\ , q_i[x ] \\ , q_j[x ] } { \\int dx \\ , q_i[x ] } \\nonumber \\\\ & = & \\left [ \\int dx \\ , q_j[x ] \\right ] \\frac { \\int dx \\ , \\alpha_{ij}[x ] \\ , q_i[x ] \\ , q_j[x ] } { \\int dx \\ , q_j[x ] } \\nonumber \\\\ & = & c_j \\left < \\alpha_{ij } \\ , q_i \\right>_j , \\label{equation : importance - sampling - identity}\\end{aligned}\\ ] ] where @xmath14 is another path - ensemble index , @xmath15 $ ] is an arbitrary functional of @xmath11 , and all normalization constants are nonzero .    summing over the index @xmath14 in eq .  [ equation : importance - sampling - identity ] and using the sample mean , @xmath16 $ ] , as an estimator for @xmath17 , we obtain a set of @xmath1 estimating equations , @xmath18 \\ , q_j[x_{in } ] =   \\sum_{j=1}^{k } \\frac{\\hat{c}_j}{n_i } \\sum_{n=1}^{n_j } \\alpha_{ij}[x_{jn } ] \\",
    ", q_i[x_{jn } ] , \\label{eq : ext_bridge}\\end{aligned}\\ ] ] whose solutions yield estimates @xmath19 for the normalization constants @xmath9 , up to an irrelevant scalar multiple .",
    "each path , @xmath20 , is indexed by the ensemble @xmath4 from which it is sampled , and the sample number @xmath21 .",
    "this coupled set of nonlinear equations defines a _ family _ of estimators parameterized by the choice of @xmath15 $ ] , all of which are asymptotically consistent , but whose statistical efficiencies will vary . @xcite    with the choice , @xmath22 = \\frac{n_j \\hat{c}_j^{-1 } } { \\sum\\limits_{k=1}^k n_k \\ , \\hat{c}_k^{-1 } \\ , q_k[x]},\\ ] ] eq .  [",
    "eq : ext_bridge ] simplifies to the optimal ebs estimator , @xmath23}{q_i[x_{jn } ] } \\right]^{-1}. \\label{eq : opt_bridge}\\ ] ] this choice for @xmath15 $ ] is optimal in that the asymptotic variance of the ratios @xmath24 is minimal .",
    "@xcite these equations may be solved by any appropriate algorithm , including a number of efficient and stable methods suggested by shirts and chodera .",
    "@xcite    the asymptotic covariance of eq .",
    "[ eq : opt_bridge ] is estimated by , @xmath25 where the elements of @xmath26 are the covariances of the logarithms of the estimated normalization constants , @xmath27 , and @xmath28.@xcite the superscript @xmath29 denotes an appropriate generalized inverse , such as the moore - penrose pseudoinverse , @xmath30 is the @xmath31 identity matrix ( where @xmath32 is the total number of samples ) , @xmath33 is the diagonal matrix of sample sizes , and @xmath34 is the @xmath35 weight matrix with elements , @xmath36 } { \\sum\\limits_{k=1}^k n_k \\ , \\hat{c}_k^{-1 } \\ , q_k[x_n ] } .",
    "\\label{eq : weight_elements}\\ ] ] in this matrix , the distribution from which samples are drawn from is irrelevant , and @xmath11 is only indexed by @xmath37 .",
    "we note that the sum over each column , @xmath38 , is one .    for arbitrary functions of the logarithms of the normalization constants , @xmath39 and @xmath40 ,",
    "the asymptotic covariance @xmath41 can be estimated from @xmath42 according to , @xmath43 through first - order taylor series expansion of @xmath44 and @xmath45 .",
    "following previous work , @xcite we estimate nonequilibrium expectations by defining additional path - ensembles with `` unnormalized densities '' @xmath46 = \\mathcal f[x ] \\ , q_i[x ] \\:\\ : ; \\:\\ : c_{\\mathcal f_i } = \\int dx \\ , q_{\\mathcal f_i}[x ] .",
    "\\label{eq : functional_density}\\ ] ] using eqs .",
    "( [ eq : path_average ] ) , ( [ eq : path_density ] ) , and ( [ eq : functional_density ] ) , we can express nonequilibrium expectations as a ratio of the appropriate normalization constants , @xmath47 notably , this can be estimated _ without _ actually sampling path - ensembles biased by some function of @xmath3 $ ] ( although it is sometimes possible to do so in computer simulations @xcite via transition path sampling @xcite ) . if no paths are drawn from the path - ensemble corresponding to @xmath48 $ ] , then @xmath49 and it is no longer required that @xmath48 > 0 $ ] .",
    "@xcite    for each defined path - ensemble , the weight matrix @xmath34 is augmented by one column with elements , @xmath50 \\ , q_i[x_n ] } { \\sum\\limits_{k=1}^k \\ , n_k \\ , \\hat{c}_k^{-1 } \\ , q_k[x_n ] } .",
    "\\label{eq : f_weight_elements}\\ ] ] the estimator for the path - ensemble average , @xmath51 , can be expressed in terms of weight matrix elements , @xmath52 , \\ ] ] and its uncertainty estimated by @xmath53",
    "the above formalism is fully general , and may be applied to _ any _ situation where the ratio @xmath8 / q_j[x]$ ] can be computed . for arbitrary path - ensembles , unfortunately , calculating this ratio is only possible in computer simulations unless certain assumptions are made about the dynamics .",
    "@xcite in a few special path - ensembles , however , we can use the crooks fluctuation theorem @xcite to estimate this ratio , allowing us to apply the ebs estimator to laboratory experiments .",
    "we examine these here .",
    "first , consider a _",
    "forward process _ , in which a system , initially in equilibrium , is propagated under some time - dependent dynamics for a time @xmath54 which may cause it to be driven out of equilibrium .",
    "the time - dependence of the evolution law ( e.g.  hamiltonian dynamics in a time - dependent potential ) is the same for all paths sampled from this ensemble .    for a sample of paths only drawn from this ensemble",
    ", the optimal ebs estimator of @xmath55 reduces to the sample mean estimator , which we call the _ unidirectional _ path - ensemble average estimator @xmath56 , \\label{equation : unidirectional - path - estimator}\\end{aligned}\\ ] ] and the associated asymptotic variance from eq .",
    "[ eq : cov ] reduces to the variance of the sample mean ( see appendix [ sec : uni - var ] ) @xmath57 - \\bar{\\mathcal f}_f \\right)^2 \\right]\\end{aligned}\\ ] ]    the forward process has a unique counterpart known as the _",
    "reverse process_. here , the system moves via the opposite protocol in thermodynamic state space ; after initial configurations are drawn from the final thermodynamic state of the forward path - ensemble , they are driven towards the initial state . if the dynamical law satisfies detailed balance when the control parameters are held constant at each fixed time @xmath58 , the path probabilities in the conjugate forward and reverse path - ensembles are related according to the crooks fluctuation theorem : @xcite @xmath59}{\\rho_r[\\tilde{x } ] } = \\frac { q_f[x ] } { q_r[\\tilde{x } ] } \\frac { c_r } { c_f } = e^{w_\\tau[x ] - \\delta f_\\tau } \\equiv e^{\\omega[x ] } , \\label{eq : cft}\\ ] ] in which @xmath60 is the time - reversal , or _ conjugate twin _ ,",
    "@xcite of @xmath11 , @xmath61 is the dimensionless free energy difference between thermodynamic states at times @xmath62 and @xmath58 ( with @xmath54 being the fixed total trajectory length ) and @xmath63 $ ] is the appropriate dimensionless work . in hamiltonian dynamics , for example , this work is @xmath63 = \\beta \\int_0^t dt ' \\ , ( \\partial h/\\partial t')$ ] . for convenience ,",
    "we define the total _ dissipative work _ as @xmath64 \\equiv w_\\tau[x ] - \\delta f_\\tau$ ]",
    ".    we will refer to data sets which only include realizations from the forward path - ensemble as ` unidirectional ' , and those with paths from both path - ensembles as ` bidirectional ' .",
    "notably , sampling paths from these conjugate ensembles and calculating the associated work @xmath63 $ ] is possible in single - molecule pulling experiments as well as computer simulations ( c.f .",
    "@xcite ) . to combine bidirectional data to estimate @xmath55",
    ", we apply the crooks fluctuation theorem @xcite to eq .",
    "[ eq : opt_bridge ] and divide by @xmath65 , leading to , @xmath66 } { n_f + n_r \\ , e^{-\\hat{\\omega}[x_{fn } ] } } +   \\sum_{n=1}^{n_r } \\frac { \\mathcal f[x_{rn } ] } { n_f + n_r \\ , e^{-\\hat{\\omega}[x_{rn } ] } } \\label{equation : bidirectional - path - estimator}\\ ] ] which is bidirectional path - average estimator of minh and adib , @xcite derived here by a different route which demonstrates its optimality .",
    "( the asymptotic variance estimator for this equation is written in a closed form in appendix [ sec : bi - var ] . ) in these bidirectional expressions , samples drawn from the reverse path - ensemble are time - reversed to obtain the paths @xmath67 . the dissipated work estimate ,",
    "@xmath68 \\equiv w_\\tau[x ] - \\delta \\hat{f}_\\tau$ ] , requires an estimate of @xmath69 . a method for obtaining this estimate",
    "will be described next .",
    "jarzynski s equality , @xcite @xmath70 relates nonequilibrium work and free energy differences . to facilitate the use of ebs in jarzynski s equality , we define a path - ensemble by choosing @xmath3 = e^{-w_t[x]}$ ] in eq .",
    "[ eq : functional_density ] , leading to @xmath71 =   e^{-w_t[x ] } \\ , q_f[x ] \\:\\ : ; \\:\\ : c_{w_t } = \\int dx \\ , e^{-w_t[x ] } \\ , q_f[x ] .\\ ] ]    when only unidirectional data is available , the optimal ebs estimator for jarzynski s equality is @xmath72 } \\label{equation : unidirectional - ft}\\end{aligned}\\ ] ] and its asymptotic variance is straightforwardly given by error propagation .",
    "@xcite estimators @xcite and asymptotic variances @xcite have also been developed for unidirectional _ importance sampling _ forms of the equality .    when bidirectional data is available , the same choice of @xmath3 $ ] in eq .",
    "[ equation : bidirectional - path - estimator ] gives the estimator @xmath73 } } { n_f + n_r \\ , e^{-\\hat{\\omega}[x_{fn } ] } } +   \\sum_{n=1}^{n_r } \\frac { e^{-w_t[x_{rn } ] } } { n_f + n_r \\ , e^{-\\hat{\\omega}[x_{rn } ] } } \\label{equation : bidirectional - ft}\\end{aligned}\\ ] ] in this equation , choosing @xmath74 or @xmath75 leads to an implicit function mathematically equivalent to the bennett acceptance ratio method , @xcite as previously explained .",
    "@xcite the asymptotic variance of @xmath76 is calculated by augmenting the matrices @xmath34 and @xmath42 and using @xmath77 in eq .",
    "[ eq : cov ] , such that , @xmath78",
    "building on jarzynski s equality , hummer and szabo developed expressions for the pmf , @xcite the free energy as a function of a _ reaction coordinate _ rather than a thermodynamic state , that may be used to interpret single - molecule pulling experiments . in these experiments , a molecule is mechanically stretched by a force - transducing apparatus , such as an laser optical trap or atomic force microscope tip ( c.f .",
    "the hamiltonian governing the time evolution in these experiments , @xmath79 , is assumed to contain both a term corresponding to the unperturbed system , @xmath80 , and a time - dependent ( typically harmonic ) external bias potential imposed by the apparatus , @xmath81 , which acts along a pulling coordinate , @xmath82 .",
    "as the coordinate @xmath83 is observed at fixed intervals @xmath84 over the course of the experiment , we will henceforth use @xmath85 as an integer time index .",
    "we calculate the work with a discrete sum as @xmath86 $ ] , where @xmath87 .    while the expressions in section [",
    "sec : fe ] provide an estimate of relative free energies of the equilibrium thermodynamic states defined by @xmath88 , they are not immediately useful as an estimate for the pmf along @xmath89 .",
    "@xcite by applying the nonequilibrium estimator for thermodynamic expectations , @xcite it was shown that the pmf in the absence of an external potential is given by @xcite @xmath90 where the dimensionless pmf , @xmath91 , is defined in relation to the normalized density as @xmath92 . in this equation",
    ", @xmath93 is a time - independent constant , @xmath94.@xcite    this theorem can be used to develop estimators for the pmf by replacing the delta function using a kernel function of finite width , such as , @xmath95 the width @xmath96 must be small so that @xmath97 does not vary substantially across it .    as this theorem is valid at all times , it is possible to obtain an asymptotically unbiased density estimate @xmath98 from each time slice .",
    "it is far more efficient , however , to estimate the pmf using _ all _ recorded time slices .",
    "while any linear combination of time slices will lead to a valid estimate , certain choices will be more statistically efficient ( leading to lower variance ) than others .",
    "one way to combine time slices is to use the asymptotic covariance matrix in the method of control variates,@xcite leading to a generalized least - squares optimal estimate of the pmf .",
    "unfortunately , we empirically found this approach to be numerically unstable . a more numerically stable approach , which was proposed by hummer and szabo , @xcite is based on the weighted histogram analysis method , @xcite @xmath99 while this weighting scheme is optimal , in a minimal - variance sense , for independent samples from multiple _ equilibrium _ distributions",
    ", these assumptions do not hold for time slices from nonequilibrium trajectories .",
    "however , oberhofer and dellago did not observe substantial improvement in pmf estimates when using other time - slice weighting schemes .",
    "@xcite    by defining the path - ensemble , @xmath100 = \\delta(z - z_t ) \\ , e^{-w_t[x ] } \\ , q_f[x ] \\:\\ : ; \\:\\ :",
    "c_{z_t } = \\int dx \\ , q_{z_t}[x]\\ ] ] and making use of jarzynski s equality ( eq .",
    "[ eq : je ] ) for @xmath101 , we can write hummer and szabo s pmf estimator as @xmath102 which can be readily analyzed in terms of ebs . while hummer and szabo proposed using the unidirectional path average estimator ( eq .  [ equation : unidirectional - path - estimator ] ) to estimate the expectations in eq",
    ".  [ eq : hs ] , minh and adib later applied a bidirectional estimator ( eq .",
    "[ equation : bidirectional - path - estimator ] ) , leading to significantly improved statistical properties .",
    "@xcite    the asymptotic variance of these estimators can be determined by choosing @xmath103 in eq .",
    "[ eq : cov ] . for the bidirectional estimator , the matrices @xmath34 and @xmath42 will contain one column each for the @xmath104 and @xmath105 path - ensembles , and @xmath106 columns each for the path - ensembles associated with @xmath107 and @xmath108 .",
    "the relevant partial derivatives are , @xmath109 where @xmath110 , @xmath111 is the numerator of eq .",
    "[ eq : hs ] , and @xmath112 is its denominator .",
    "these lead to an estimate for @xmath113 .",
    "finally , the asymptotic variance in the pmf is given by the error propagation formula , @xmath114 .",
    "we demonstrate these results with brownian dynamics simulations on a one - dimensional potential with @xmath115 , which were run as previously described .",
    "@xcite a time - dependent external perturbation , @xmath116 , with @xmath117 is applied , such that the total potential is @xmath118 .",
    "after 100 steps of equilibration at the initial @xmath119 , @xmath119 is linearly moved over 750 steps from @xmath120 to @xmath121 in forward processes and @xmath121 to @xmath120 in the reverse .",
    "the position at each time step is calculated using the equation @xmath122 , where the diffusion coefficient is @xmath123 , the time step is @xmath124 , and @xmath125 is a random number from the standard normal distribution .",
    "as previously noted , @xcite unidirectional sampling leads to significant apparent bias in estimates of @xmath126 ( fig .",
    "[ fig : ft ] ) .",
    "in addition to the increased bias as the system is driven further from equilibrium , we further observe that the estimated variance also increases .",
    "bidirectional sampling , on the other hand , leads to a significant reduction in bias and variance , @xcite such that free energy estimate is within error bars of the actual free energy . because @xmath76 represents the estimated free energy difference with respect to @xmath58 , the estimated @xmath127 increases with @xmath58 , becoming equal to the well - known bennett acceptance ratio asymptotic variance estimate @xcite when @xmath128 .",
    "comparison of estimators for @xmath126 : this figure is similar to fig . 1 of ref .  @xcite , except that error bars are now included and the sample size is halved .",
    "the unidirectional estimator ( eq .  [ equation : unidirectional - ft ] ) is applied to 250 forward ( rightward triangles ) or reverse ( leftward triangles , time reversed ) sampled paths , and the bidirectional estimator ( eq .  [ equation : bidirectional - ft ] ) to 125 paths in each direction ( upward triangles ) .",
    "the exact @xmath126 is shown as a solid line .",
    "error bars ( sometimes smaller than the markers ) denote one standard deviation of @xmath129 , estimated using the expressions presented here .",
    "the vertical dashed lines are at the times considered in fig .",
    "( [ fig : error_validation ] ) . ]",
    "similar trends are observed with the hummer - szabo pmf estimates ( fig .",
    "[ fig : pmf ] ) . for unidirectional sampling ,",
    "the finite - sampling bias and estimated variance increases when the pmf is far from the region sampled by the initial state . with bidirectional sampling ,",
    "the bias is significantly reduced ; the pmf estimate is largely within error bars of the actual pmf .",
    "comparison of pmf estimators : this figure is similar to fig 2 of ref .",
    "@xcite , except that error bars are now included and the sample size is halved . in the left panel ,",
    "the unidirectional hummer and szabo estimator is applied to ( a ) 250 forward ( rightward triangles ) or 250 reverse ( leftward triangles ) sampled paths . in the right panel ,",
    "the bidirectional estimator is applied to 125 sampled paths in each direction ( upward triangles ) .",
    "the exact pmf is shown as a solid line in both panels .",
    "error bars ( sometimes smaller than the markers ) denote one standard deviation of @xmath130 , estimated using the expressions presented here .",
    "the vertical dashed lines are at the positions considered in fig .",
    "( [ fig : error_validation ] ) . ]    to analyze these trends more quantitatively , we repeated the experiment 1000 times . for both @xmath126 and @xmath91 , we calculated the bias as @xmath131 and the standard deviation as @xmath132 , where @xmath133 is the number of replicates .",
    "the results from these more extensive simulations support our described trends ( fig .",
    "[ fig : bias_vs_variance ] ) . for unidirectional sampling ,",
    "the bias in both @xmath126 and @xmath134 appear to significantly increase around the barrier crossing . in the bidirectional free energy estimate , however , the bias is small relative to the variance at all times .",
    "notably , in the bidirectional pmf estimate , there is a small spike in the bias near the barrier , potentially due to reduced sampling in the region .",
    "ratio of estimator bias to standard deviation : this ratio is calculated for the ( a ) free energy and ( b ) pmf , using 1000 independent estimates . each estimate is obtained and the type of path sample is indicated as in figs .",
    "( [ fig : ft ] ) and ( [ fig : pmf ] ) .",
    "the vertical dashed lines are at the times / positions considered in fig .",
    "( [ fig : error_validation ] ) . ]    while in the large sample limit , the bias in the unidirectional estimate is expected to be small compared to the variance , @xcite our distribution of unidirectional @xmath135 estimates is significantly skewed and does not resemble a gaussian distribution expected by the central limit theorem ( data not shown ) .",
    "hence , the asymptotic limit has not been reached and the large relative bias is caused by insufficient sampling of rare events with low work values that dominate the exponential average .",
    "@xcite larger sample sizes would be necessary for the distribution of estimates to be normally distributed and for the error to be dominated by the variance ( which we estimate here ) rather than the bias .    the accuracy of variance estimates may be assessed by comparing predicted and observed confidence intervals .",
    "if the estimates are indeed normally distributed about the true value , about 68% of estimates from many independent replicates of the experiment should be within one standard deviation of the true value , 95% within two , and so forth .",
    "( [ fig : error_validation ] ) compares confidence intervals predicted using the described asymptotic variance estimators and the actual fraction of estimates within the interval .",
    "validation of asymptotic variance estimators : predicted vs. observed fraction of 1000 independent estimates that are within an interval of the true value for ( a)-(c ) @xmath126 and ( d)-(f ) @xmath91 at the indicated times or positions .",
    "each estimate is obtained and the type of path sample is indicated as in figs .",
    "( [ fig : ft ] ) and ( [ fig : pmf ] ) .",
    "error bars on these fractions are 95% confidence intervals calculated using a bayesian scheme described in appendix b of chodera et .",
    "@xcite except that , for numerical reasons , the confidence interval was estimated from the variance of the beta distribution assuming approximate normality , rather than from the inverse beta cumulative distribution function . ]",
    "we observe that the accuracy of our asymptotic variance estimate in characterizing the confidence interval largely depends on the presence of bias . in the bidirectional @xmath76 estimate , where there is little bias ,",
    "the asymptotic variance estimate works very well . for the unidirectional @xmath76 estimates",
    ", it works well near the initial state but underestimates the error as the system is driven further away from equilibrium , concurring with the bias trend . in the bidirectional pmf estimate ,",
    "the asymptotic variance estimate accurately describes the confidence interval except near the barrier , where it slightly underestimates the uncertainty , probably due to the small spike in bias .    in the regime where the bias is much smaller than the variance , @xmath136 ,",
    "the asymptotic variance estimate provides a good estimate of the actual statistical error in the estimate .",
    "this also permits us to model the posterior distribution of quantity being estimated as a multivariate normal distribution with mean @xmath137 and covariance @xmath42 .",
    "doing so provides a route to combining estimates from independent datasets collected from different path ensembles  such as different pulling speeds or from equilibrium and nonequilibrium path ensembles  without knowledge of path probability ratios .",
    "this is achieved by maximizing the product of these posterior distributions in a manner similar to the bayesian approach for estimating @xmath69 described in ref .",
    "we thank attila szabo and zhiqiang tan for helpful discussions , and christopher calderon for useful comments on the manuscript .",
    "d.m . thanks artur adib for supporting a postdoctoral fellowship .",
    "this research was supported by the intramural research program of the nih , niddk .",
    "in this appendix , we show that given unidirectional data , the optimal ebs estimate is the sample mean and its variance simplifies to the variance of a sample mean .",
    "first , consider the application of the optimal ebs estimator , eq .",
    "[ eq : opt_bridge ] , to estimating a nonequilibrium path - ensemble average from a unidirectional data set , @xmath138}{q_{\\mathcal f_f}[x_{fn } ] } \\right]^{-1 } \\\\ & = & \\sum_{n=1}^{n_f } \\frac { \\mathcal f[x_{fn } ] \\hat{c}_f } { n_f}.\\end{aligned}\\ ] ] dividing both sides by @xmath65 , we obtain the sample mean estimator , @xmath139.\\end{aligned}\\ ] ]    we shall now simplify the asymptotic variance estimate by closely following the procedure of shirts and chodera .",
    "@xcite when @xmath34 has full column rank , @xmath42 can be written as ( eq .  d7 of ref .",
    "@xcite ) , @xmath140^{-1},\\end{aligned}\\ ] ] where @xmath141 is an arbitrary multiplicative factor and @xmath142 is a @xmath143 matrix of ones .",
    "the weight matrix @xmath34 consists of two columns , @xmath144 } { n_f \\hat{c}_f^{-1 } q_f[x_{fn } ] } = \\frac{1}{n_f } \\\\",
    "m_{n \\mathcal f_f } & = &   \\frac { \\hat{c}_{\\mathcal f_f}^{-1 } q_{\\mathcal f_f}[x_{fn } ] } { n_f \\hat{c}_f^{-1 } q_f[x_{fn } ] } = \\frac{\\mathcal f[x_{fn } ] } { n_f \\bar{\\mathcal f}_f } , \\end{aligned}\\ ] ] obtained by applying eqs .",
    "[ eq : weight_elements ] and [ eq : f_weight_elements ] .",
    "this leads to , @xmath145 \\equiv \\left [ \\begin{array}{cc } a_{11 } & a_{12 } \\\\",
    "a_{21 } & a_{22 } \\end{array } \\right].\\end{aligned}\\ ] ]",
    "the matrix @xmath146 has the determinant , @xmath147 which allows us to write the inverse covariance matrix as , @xmath148.\\end{aligned}\\ ] ] by applying the same steps as appendix e of shirts and chodera , @xcite we then obtain the determinant @xmath149 .",
    "we then obtain the asymptotic covariance estimate , @xmath150\\end{aligned}\\ ] ]    to estimate the variance , we apply eq .",
    "[ eq : path_average_variance ] , leading to @xmath151 ^ 2 } { n_f^2 } - \\frac{\\bar{\\mathcal f}_f^2}{n_f }   \\\\ & = & \\frac{1}{n_f } \\left [ \\frac{1}{n_f } \\sum_{n=1}^{n_f }   \\mathcal f[x_{fn}]^2 - \\left ( \\frac{1}{n_f } \\sum_{n=1}^{n_f } \\mathcal f[x_{fn } ] \\right)^2 \\right ]   \\\\ & = & \\frac{1}{n_f } \\left [ \\frac{1}{n_f } \\sum_{n=1}^{n_f } \\left ( \\mathcal f[x_{fn } ] - \\bar{\\mathcal f}_f \\right)^2 \\right],\\end{aligned}\\ ] ] which is the variance of a sample mean estimate .",
    "in this appendix , we obtain a closed - form expression for the asymptotic variance of the optimal ebs estimate for @xmath152 , given bidirectional data .",
    "we will follow a similar procedure as in appendix [ sec : uni - var ] .",
    "for the bidirectional case , the weight matrix @xmath34 consists of three columns , @xmath153 $ ] , where @xmath154 is a column matrix of weights from eqs .",
    "[ eq : weight_elements ] and [ eq : f_weight_elements ] corresponding to path - ensemble @xmath4 .",
    "the elements of @xmath34 are , @xmath155 } { n_f \\hat{c}_f^{-1 } q_f[x_n ] + n_r \\hat{c}_r^{-1 } q_r[\\tilde{x}_n ] }   = \\frac { 1 } { n_f   + n_r e^{-\\hat{\\omega}[x_n ] } }   = n_f^{-1 } \\epsilon(l_n ) \\\\",
    "m_{nr } & = & \\frac { \\hat{c}_r^{-1 } q_r[\\tilde{x}_{fn } ] } { n_f \\hat{c}_f^{-1 } q_f[x_n ] + n_r \\hat{c}_r^{-1 } q_r[\\tilde{x}_n ] }   = \\frac { 1 } { n_f e^{\\hat{\\omega}[x_n ] } + n_r } = n_r^{-1 } \\epsilon(-l_n ) \\\\",
    "m_{n \\mathcal f_f } & = &   \\left ( \\frac{\\mathcal f[x ] } { \\bar{\\mathcal f}_f } \\right ) \\frac { 1 } { n_f   + n_r e^{-\\hat{\\omega}[x_n ] } } = \\left ( \\frac{\\mathcal f[x ] } { \\bar{\\mathcal f}_f } \\right ) n_f^{-1 } \\epsilon(l_n),\\end{aligned}\\ ] ] where @xmath156 is defined as the fermi function , @xmath157 , and we define @xmath158 - \\delta \\hat{f}_t + \\ln \\left ( \\frac{n_f}{n_r } \\right)$ ] .",
    "this allows us to write @xmath146 as , @xmath159 } { \\bar{\\mathcal f}_f } \\right ) \\epsilon(l_n)^2 \\\\",
    "\\frac{1}{n_f n_r }",
    "\\epsilon(l_n ) \\epsilon(-l_n ) & \\frac{1}{n_r^2 } \\epsilon(-l_n)^2 & \\frac{1}{n_f n_r } \\left ( \\frac{\\mathcal f[x ] } { \\bar{\\mathcal f}_f } \\right )",
    "\\epsilon(l_n ) \\epsilon(-l_n ) \\\\   \\frac{1}{n_f^2 } \\left ( \\frac{\\mathcal f[x ] } { \\bar{\\mathcal f}_f } \\right ) \\epsilon(l_n)^2 & \\frac{1}{n_f n_r } \\left ( \\frac{\\mathcal f[x ] } { \\bar{\\mathcal f}_f }",
    "\\right ) \\epsilon(l_n ) \\epsilon(-l_n ) & \\frac{1}{n_f^2 } \\left ( \\frac{\\mathcal f[x ] } { \\bar{\\mathcal f}_f } \\right)^2 \\epsilon(l_n)^2 \\end{array } \\right ] \\nonumber \\\\ & \\equiv &   \\left [ \\begin{array}{ccc } a_{ff } & a_{fr } & a_{f \\mathcal f_f } \\\\ a_{fr } & a_{rr } & a_{r \\mathcal f_f } \\\\",
    "a_{\\mathcal f_f \\mathcal f } & a_{r \\mathcal f_f } & a_{\\mathcal f_f \\mathcal f_f } \\\\ \\end{array } \\right].\\end{aligned}\\ ] ] using the determinant , @xmath160 we write the inverse covariance matrix estimator as , @xmath161.\\end{aligned}\\ ] ]"
  ],
  "abstract_text": [
    "<S> existing optimal estimators of nonequilibrium path - ensemble averages are shown to fall within the framework of extended bridge sampling . using this framework </S>",
    "<S> , we derive a general minimal - variance estimator that can combine nonequilibrium trajectory data sampled from multiple path - ensembles to estimate arbitrary functions of nonequilibrium expectations . </S>",
    "<S> the framework is also applied to obtaining asymptotic variance estimates , which are a useful measure of statistical uncertainty . in particular , we develop asymptotic variance estimates pertaining to jarzynski s equality for free energies and the hummer - szabo expressions for the potential of mean force , calculated from uni- or bidirectional path samples . </S>",
    "<S> lastly , they are demonstrated on a model single - molecule pulling experiment . in these simulations , </S>",
    "<S> the asymptotic variance expression is found to accurately characterize the confidence intervals around estimators when the bias is small . </S>",
    "<S> hence , it does not work well for unidirectional estimates with large bias , but for this model it largely reflects the true error in a bidirectional estimator derived by minh and adib . </S>"
  ]
}