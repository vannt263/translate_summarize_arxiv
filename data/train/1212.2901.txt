{
  "article_text": [
    "this is the conclusion of a series of papers  @xcite about the development of a formulation of general relativity ( gr ) , called z4c , that attempts to combine the strengths of two popular evolution systems for applications in free - evolution numerical relativity .",
    "here we summarize the logical development of the formulation .    in the bssnok formulation  @xcite",
    "there is a zero - speed characteristic variable in the constraint subsystem , which can result in large hamiltonian constraint violations in numerical applications ; the removal of this mode is one of the key advantages of the generalized harmonic formulation  @xcite over bssnok .",
    "the generalized harmonic formulation also possesses a constraint damping scheme  @xcite , which exponentially damps away small , high - frequency constraint violations at the continuum level .",
    "furthermore the trivial wave - like nature of the generalized harmonic subsystem allows for the convenient construction of constraint preserving boundary conditions  @xcite . on the other hand ,",
    "the key advantages in the bssnok formulation are the choice of conformal variables , and the fact that the formulation does not come tied to a particular gauge , which allows for the selection of the moving puncture gauge  @xcite .",
    "the combination of these two strengths allows for the evolution of black holes represented by coordinate singularities on the grid without severe numerical difficulties . for bssnok radiation controlling constraint preserving boundary conditions",
    "have been proposed  @xcite , but to our knowledge have not been successfully used in numerical applications . with these considerations in mind a conformal decomposition of the z4 formulation  @xcite",
    "was proposed in  @xcite .",
    "because of the close relationship between the z4 and generalized harmonic formulations , this conformal decomposition inherits all of the strengths outlined in the previous discussion . in",
    "@xcite a set of spherically symmetric ( 1d ) tests involving single black hole and neutron star spacetimes demonstrated that , indeed , the z4c formulation guarantees the robustness of , and better constraint preservation than bssnok , especially for non - vacuum spacetimes . it was also found that the main advantage of z4c in the bulk of the computational domain , namely the propagating constraint violations , presents problems at the outer boundary if the constraints are not absorbed but rather reflected .",
    "a first attempt to tackle this problem was presented in  @xcite , in which high derivative order constraint preserving boundary conditions based on those of  @xcite were proposed for z4c .",
    "well - posedness of the z4c constraint subsystem initial boundary value problem was demonstrated , and numerical results in explicit spherical symmetry demonstrated the efficacy of the constraint preserving boundary conditions . in this work we use constraint preserving boundary conditions , motivated by a forthcoming study  @xcite , in which well - posedness of high order boundary conditions that are constraint preserving and control incoming gravitational radiation  @xcite , is analyzed .    in  @xcite ,",
    "the performance of the z4 constraint damping scheme of  @xcite applied to z4c in black hole and neutron star spacetimes was studied in detail in spherical symmetry .",
    "the constraint damping scheme is effective , as expected , in the non - linear system provided that the constraint violation is sufficiently small and resolved on the numerical grid ; in the case of grid noise the combination of artificial dissipation and damping helps to suppress constraint violations .",
    "but it was found that care should be taken in the choice of damping parameters .",
    "success in spherical tests does not necessarily guarantee that of 3d simulations .",
    "preliminary simulations with z4c and sommerfeld bcs in 3d with pure box in box mesh refinement showed poor behavior at the outer boundaries in long evolutions . therefore to try and bridge the gap between the evolutions in spherical symmetry and full applications in astrophysical spacetimes , numerical stability of z4c in 3d evolutions was studied in  @xcite , where numerical stability of the linearized z4c system coupled to the puncture gauge with a novel discretization was shown , and numerical evidence from the apples - with - apples  @xcite tests was presented with both the standard and the novel discretization .",
    "the importance of algebraic constraint projection was highlighted , and limitations of the puncture gauge for applications in cosmology were observed .",
    "the first application of z4c was the study of the end - state of a collapsing neutron star with the puncture gauge  @xcite in 1d and 3d simulations of spherical configurations .",
    "the puncture gauge handles collapsing matter without the need for ( matter or metric ) excision because , during the process , the shift condition pushes the spatial coordinates off of the matter region .",
    "this study was followed up with a similar discussion of dust collapse in  @xcite .",
    "a variation of the conformal decomposition , ccz4 , was proposed in  @xcite .",
    "the difference between z4c and ccz4 is that ccz4 includes parametrized constraint addition that , for some choice , correspond to the original four - covariant z4 formulation . in the generalized harmonic formulation",
    "it is known that the inclusion of these non - principal terms can be problematic in some test cases  @xcite , but constraint growth can be mitigated by the use of constraint damping , which is the approach of  @xcite . for a particular choice of the constraint addition parameters _",
    "not _ corresponding to the four - covariant z4 system , evolutions of binary black hole spacetimes were presented and shown to reduce hamiltonian constraint violation , by a factor of around four or five ( see fig .",
    "4 of  @xcite ) , relative to such simulations for the bssnok formulation . on the other hand ,",
    "in the z4c system non - principal constraint addition that makes the equations of motion as close as possible to those of the bssnok formulation whilst still obtaining the desired pde properties in the constraint subsystem is chosen .",
    "it would be interesting to know in more generality how the addition of non - principal constraints affects their evolution .",
    "in this paper we present the first long - term 3d evolutions of black hole and neutron star binaries with the z4c formulation . in section  [ sec : z4c ] the z4c equations of motion and boundary conditions are presented .",
    "we then discuss , in section  [ sec : numerics ] , changes to the bam numerical code since  @xcite .",
    "in particular we describe the implementation of spherical patches for the wave zone  @xcite and the radiation controlling constraint preserving conditions of  @xcite . in sections  [ sec : single ] and  [ sec :",
    "bin ] we present our simulations of single and binary compact objects , respectively .",
    "appendices  [ app : shells ] and  [ app : teukolsky ] contain , respectively , descriptions of the spherical patch implementation and evolution of teukolsky waves , the latter of which we use for code validation .",
    "we conclude in section  [ sec : conc ] .",
    "we use units  @xmath0 throughout , unless otherwise stated .",
    "in this section we summarize for completeness the z4c equations of motion , constraints , and boundary conditions .",
    "the evolved quantities of the formulation are the conformal spatial metric  @xmath1 , the lapse  @xmath2 , the shift vector  @xmath3 , the conformal tracefree part of the extrinsic curvature  @xmath4 , the constraint  @xmath5 and , up to constraint addition , the trace of the extrinsic curvature  @xmath6 .",
    "finally we evolve the the conformal contracted christoffel symbols  @xmath7 , which are initially set according to  @xmath8 .",
    "[ [ evolution - equations . ] ] evolution equations .",
    "+ + + + + + + + + + + + + + + + + + + +    the equations of motion for the z4c formulation are @xmath9\\,,\\\\ \\p_t \\tilde{\\gamma}_{ij } & = -2\\,\\alpha\\,\\tilde{a}_{ij}+\\beta^k\\p_k \\tilde{\\gamma}_{ij}+2\\,\\tilde{\\gamma}_{k(i}\\p_{j)}\\beta^k\\nonumber\\\\ & \\quad-\\frac{2}{3}\\,\\tilde{\\gamma}_{ij}\\p_k\\beta^k\\,,\\end{aligned}\\ ] ] for the metric components , @xmath10\\nonumber\\\\ & + 4\\,\\pi\\,\\alpha\\,\\left[s+\\rho\\,\\right ] + \\alpha\\,\\kappa_1\\,(1-\\kappa_2)\\,\\theta+\\beta^i\\p_i\\hat{k}\\,,\\\\ \\p_t \\tilde{a}_{ij } & = \\chi[-d_id_j\\alpha + \\alpha\\,(r_{ij}-8\\,\\pi\\,s_{ij})]^{\\textrm{tf}}\\nonumber\\\\ & + \\alpha\\,\\left[(\\hat{k}+2\\,\\theta)\\tilde{a}_{ij}- 2\\,\\tilde{a}^k{}_i\\tilde{a}_{kj}\\right]\\nonumber\\\\ & + \\beta^k\\,\\p_k\\tilde{a}_{ij}+2\\,\\tilde{a}_{k(i}\\,\\p_{j)}\\beta^k -\\frac{2}{3}\\,\\tilde{a}_{ij}\\,\\p_k\\beta^{k}\\,,\\end{aligned}\\ ] ] for the extrinsic curvature components and @xmath11 + \\tilde{\\gamma}^{jk}\\,\\p_j\\p_k\\beta^i\\nonumber\\\\ & + \\frac{1}{3}\\,\\tilde{\\gamma } ^{ij}\\p_j\\p_k\\beta^k+\\beta^j\\,\\p_j\\tilde{\\gamma}^i -(\\tilde{\\gamma}_{\\textrm{d}})^j\\,\\p_j\\beta^i\\nonumber\\\\ & + \\frac{2}{3}\\,(\\tilde{\\gamma}_{\\textrm{d}})^i\\,\\p_j\\beta^j -2\\,\\alpha\\,\\kappa_1\\,\\big[\\tilde{\\gamma}^i -(\\tilde{\\gamma}_{\\textrm{d}})^i\\big]\\,,\\\\ \\p_t\\theta & = \\frac{1}{2}\\,\\alpha\\,\\big[r -   \\tilde{a}_{ij}\\,\\tilde{a}^{ij } + \\frac{2}{3}\\,(\\hat{k}+2\\,\\theta)^2\\big]\\nonumber\\\\ & -\\alpha\\,\\big[8\\,\\pi\\,\\rho+\\kappa_1\\,(2+\\kappa_2)\\ , \\theta\\big]+\\beta^i\\p_i\\theta\\,,\\end{aligned}\\ ] ] for the remaining variables . here the intrinsic curvature associated with the adm metric  @xmath12 is written as @xmath13 and we employ the shorthand @xmath14 the derivative operator  @xmath15 is that compatible with the adm metric .",
    "numerical evolutions are performed with a particular flavor of the puncture gauge  @xcite @xmath16    [ [ constraints . ] ] constraints .",
    "+ + + + + + + + + + + +    the system is subject to constraints @xmath17 of which the latter two , the algebraic constraints , are explicitly imposed in numerical integration .    [ [ boundary - conditions . ] ] boundary conditions",
    ". + + + + + + + + + + + + + + + + + + + +    when the spacetime manifold has a smooth boundary with spacelike unit ( with respect to the adm metric ) normal  @xmath18 we choose for the trace of the extrinsic curvature the boundary condition @xmath19 where  @xmath20 denotes equality only in the boundary , we use the shorthand  @xmath21 and we use upper case latin indices  @xmath22 to denote those that have been projected with the operator  @xmath23 .",
    "we can alternatively write this as a second order derivative boundary condition on the lapse . note that in the expressions for the boundary conditions we _ never _ commute the unit normal , projection operator  @xmath24 , or physical projection operator  @xmath25 through any derivative operator .",
    "for example , @xmath26 .",
    "so we have @xmath27 for vectors  @xmath28 and symmetric tensors  @xmath29 , respectively .",
    "we refer to the various components of the time derivative under this  @xmath30 decomposition as the scalar , vector and tensor sectors in the obvious way .",
    "if we are given conformally flat initial data with  @xmath31 and  @xmath32 is constant , as is always the case for the data evolved in this work , we choose the boundary conditions @xmath33\\p_j\\beta^s -\\frac{\\eta^2}{\\alpha^2\\mu_s}\\beta^i\\p_i\\beta^s\\ , , \\label{eq : long_shift_bc}\\end{aligned}\\ ] ] for the longitudinal part of the shift .",
    "we take @xmath34 -\\frac{1}{3}\\,\\chi\\,\\p_a\\left[\\tilde{\\gamma}^a -(\\tilde{\\gamma}_{\\textrm{d}})^a\\right ] \\nonumber\\\\ & \\left.+\\frac{1}{3}\\,r_{qq}-3\\,\\tilde{d}^i(\\ln\\chi)\\tilde{a}_{is } -\\kappa_1\\,\\left[\\tilde{\\gamma}_s-(\\tilde{\\gamma}_{\\textrm{d}})_s \\right]\\right\\ } \\nonumber\\\\ & + \\alpha\\,\\left[\\tilde{a}_{ss}\\,(\\hat{k}+2\\,\\theta ) -2\\,\\tilde{a}^i{}_{s}\\,\\tilde{a}_{is}\\right ] -\\frac{2}{3}\\,\\chi\\,d_sd_s\\alpha\\nonumber\\\\ & + \\frac{1}{3}\\,\\chi\\,d^ad_a\\alpha+\\lie_\\beta\\tilde{a}_{ss}\\,,\\end{aligned}\\ ] ] for constraint preservation in the scalar sector , where for example  @xmath35 when acting on scalars , so that the tilde denotes that the conformal metric was used in the contraction . in the vector sector",
    "we have @xmath36 + \\tilde{\\p}^b\\p_b\\beta^a\\nonumber\\\\ & + \\frac{4}{3}\\,\\tilde{\\p}^a\\p_s\\beta^s+\\frac{1}{3}\\ , \\tilde{\\p}^a\\p_b\\beta^b-\\frac{2}{3}\\,\\alpha\\ , \\tilde{\\p}^a(2\\hat{k}+\\theta ) \\nonumber\\\\ & + \\beta^j\\p_j\\tilde{\\gamma}^a\\,,\\end{aligned}\\ ] ] for the gauge , and @xmath37 \\nonumber\\\\ & \\left .- r_{sa}+\\frac{1}{2}\\chi\\,q_{ai}\\ , \\p_s\\left[\\tilde{\\gamma}^i -(\\tilde{\\gamma}_{\\textrm{d}})^i\\right]\\right\\}-\\chi\\ , d_ad_s\\alpha\\nonumber\\\\ & + \\alpha\\,\\left[\\tilde{a}_{sa}\\,(\\hat{k}+2\\,\\theta ) -2\\,\\tilde{a}^i{}_a\\tilde{a}_{is}\\right ] + \\lie_\\beta\\tilde{a}_{sa}\\ , , \\label{eq : psi0_bc}\\end{aligned}\\ ] ] for the constraints , where we denote projected indices by upper case characters starting from the beginning of the alphabet . here",
    "we denote  @xmath38 .",
    "finally we take @xmath39^{\\textrm{tf } } \\nonumber\\\\ & -\\chi\\,d_ad_b^{\\textrm{tf}}\\alpha + \\lie_\\beta\\tilde{a}_{ab}^{\\textrm{tf}}\\,,\\label{eqn : bc_last}\\end{aligned}\\ ] ] for the tensor sector . the boundary conditions in the scalar and vector sectors",
    "are designed to absorb outgoing constraint violations .",
    "the last of the conditions   are equivalent to the requirement that  @xmath40 ( see  @xcite for more details ) .",
    "this condition could also be used with the bssnok formulation , but for constraint preservation more work may be needed to adapt the other conditions . in the development of this work",
    "we have tried alternative conditions on  @xmath41 and  @xmath7 with only small differences in the outcome .",
    "we do not claim that these gauge boundary conditions are optimal . in our numerical experiments",
    "we sometimes also employ the more naively constructed sommerfeld conditions @xmath42 note that since the trace constraint on  @xmath4 is constantly imposed , the last of these conditions   constitute only five boundary conditions . since the z4c formulation coupled to the puncture gauge has ten incoming characteristics in the weak field region , these conditions are not overdetermined , in contrast to the standard conditions used with bssnok with box - in - box mesh refinement .",
    "regardless of the formulation , or whether sommerfeld conditions are taken for every evolved field or just the subset  @xmath43 , they are not constraint preserving and do not control incoming gravitational radiation .",
    "in this section we describe the numerical technique employed in this work .",
    "we use the bam code  @xcite , a cartesian - based adaptive mesh refinement ( amr ) infrastructure optimized for the evolution of bbh and bns spacetimes in 3 + 1 gr . vacuum spacetime evolutions have also been performed with the amss - ncku code  @xcite , which employs the same methods but with an independent implementation .",
    "[ [ amss - ncku - and - bam - basics . ] ] amss - ncku and bam basics .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + +    before discussing the upgrades to the codes used in this work , we summarize the main points of the numerical methods used by amss - ncku and bam .",
    "the evolution algorithm is based on the method - of - lines with explicit runge - kutta ( rk ) time integrators ( in this work we employed fourth order rk for vacuum spacetimes and third order rk for non - vacuum spacetimes ) and finite differences approximation of the spatial derivatives .",
    "the numerical domain is made of a hierarchy of cell - centered nested cartesian grids ( nested boxes centered on the punctures  @xcite ) .",
    "the hierarchy consists of @xmath44 levels of refinement labeled by  @xmath45 .",
    "a refinement level consists of one or more cartesian grids with constant grid spacing  @xmath46 on level  @xmath47 .",
    "a refinement factor of two is used such that  @xmath48 .",
    "the grids are properly nested in that the coordinate extent of any grid at level  @xmath47 , @xmath49 , is completely covered by the grids at level  @xmath50 . some of the mesh refinement levels can be dynamically moved and adapted during the time evolution according to the technique of  `` moving boxes '' .",
    "the berger - oliger algorithm is employed for the time stepping  @xcite , though only on the inner levels  @xcite .",
    "interpolation in berger - oliger time stepping is performed at second order .",
    "a courant - friedrich - lewy factor of  @xmath51 is employed in all the runs .",
    "we refer the reader to  @xcite for more details .",
    "[ [ numerical - treatment - of - the - field - equations . ] ] numerical treatment of the field equations .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    the bssnok and z4c equations of motion are implemented numerically in the same way .",
    "fields derivatives are approximated by centered finite difference expressions ( fourth order in this work ) , except for the shift advection terms which are instead computed with lop - sided expressions  @xcite .",
    "algebraic constraints are enforced after every time step in bam and after every runge - kutta substep in amss - ncku .",
    "the gauge parameters in our numerical simulations are fixed to  @xmath52 ,  @xmath53 and  @xmath54 , unless otherwise stated .",
    "note that this is _ not _ a choice of parameters for which the calculations of  @xcite are expected to guarantee well - posedness of the initial boundary value problem because we have not carefully taken  @xmath55 in such a way as to avoid either some generically distinct speeds in the system clashing , or sets of measure zero on which the evolution equations may be only weakly hyperbolic . in earlier studies  @xcite the choice  @xmath56 with  @xmath57 was not found to greatly affect the behavior of the scheme in applications .",
    "as highlighted in appendix a of  @xcite it is challenging to identify problems caused by weak hyperbolicity in applications , even if the system is weakly hyperbolic everywhere in space .",
    "if the degeneracy happens on sets of measure zero we therefore expect that in practical applications it will be nearly impossible to identify as the cause of any concrete numerical problem , although in principle such degeneracy should of course be avoided . in the z4c simulations presented in this work the constraint damping scheme with the values  @xmath58 and @xmath59 is used .",
    "these values have been suggested in the detailed 1d numerical analysis of  @xcite .",
    "preliminary exploratory runs in 3d indicated the combined use of artificial dissipation and constraint damping terms is important ( in some cases essential ) to avoid instabilities at the interfaces between boxes and spherical patches , thus confirming some of the expectations from the 1d runs ( see also the discussion in appendix  [ app : shells ] ) .",
    "openmp support in terms of a hybrid openmp / mpi implementation has been added inside bam to key functions with high computational cost , such as evolution equations , interpolation and wave extraction , which improves the efficiency of memory management of the code .    [ [ hydrodynamics - treatment - bam - only . ] ] hydrodynamics treatment ( bam only ) .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    the algorithm implemented for the general relativistic hydrodynamics ( grhd , referred to hereafter as `` matter '' for brevity ) is a robust high - resolution - shock - capturing ( hrsc ) method  @xcite based on primitive reconstruction and the local - lax - friedrichs ( llf ) central scheme for the numerical fluxes , see e.g.  @xcite .",
    "metric variables are interpolated in space by means of sixth order lagrangian polynomials , while matter ones by a fourth order weighted - essentially - non - oscillatory scheme .",
    "primitive reconstruction is performed here with the 5th order weno scheme of  @xcite , which has been found important for long term accuracy  @xcite .",
    "[ [ spherical - patches - for - the - wave - zone . ] ] spherical patches for the wave zone .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    both the amss - ncku and bam codes have been upgraded for this work . the cartesian box - in - box mesh refinement has been extended with spherical patches ( `` cubed spheres '' )  @xcite for the wave zone .",
    "they provide us with adapted coordinates for waves , and , as demonstrated in appendix  [ app : shells ] , improved accuracy in gw extraction .",
    "the presence of a spherical outer boundary furthermore allows a straightforward implementation of bcs ( either sommerfeld or cp ) due to the absence of corners . when the spherical patches are being used the cartesian moving boxes , as previously implemented , are employed only in the strong - field region for the simulation of the binary orbital motion , or a collapsing star , while the propagation of gravitational and possibly also electromagnetic waves distant from the source is simulated on cubed spheres  @xcite",
    "( see also  @xcite ) .",
    "the technique is based on the covering of the sphere by six patches , each patch having local coordinates that are then mapped to cartesian ones in such a way to avoid pathologies associated with standard spherical polar coordinates . as opposed to the box - in - box setup ,",
    "spherical patches allow constant radial resolution with linear scaling in the number of grid points , while the boxes result in effectively constant angular resolution as well . in practice",
    ", the  @xmath60 cartesian box is substituted with six patches overlapping with the cartesian box at level  @xmath61 and among themselves .",
    "the resolution of  @xmath62 is also the radial resolution employed in the patches .",
    "a grid configuration is specified by the number of : i )  levels  @xmath44 , ii )  grid points in each non - moving box per direction  @xmath63 , iii )  grid points in each moving box per direction  @xmath64 , iv )  the coarsest box per direction  @xmath65 , v )  grid points in each patch ,  @xmath66 and  @xmath67 , which are typically chosen as  @xmath68 .",
    "more details on the implementation are given in appendix  [ app : shells ] ) .",
    "finally , gws are extracted using the newman - penrose formalism , in particular by computing the  @xmath69 scalar on coordinate spheres in the wave zone ( see sec .",
    "iii of  @xcite ) .",
    "mode decomposition of  @xmath69 is performed by projections onto spin weighted spherical harmonics and integration on the spheres with a simpson algorithm .",
    "[ [ boundary - conditions.-1 ] ] boundary conditions .",
    "+ + + + + + + + + + + + + + + + + + + +    the radiation controlling , constraint preserving boundary conditions  ( [ eq : lapse_bc]-[eqn : bc_last ] ) are implemented according to the following simple recipe . inside every runge - kutta substep lagrange extrapolation , of sixth order in our experiments ,",
    "is used to populate enough ghostzones in a neighborhood of the boundary , so that the same finite difference and dissipation operators used in the bulk may be evaluated at the boundary .",
    "the metric components  @xmath70 are updated at the boundary with their standard equations of motion from the bulk , whereas the boundary conditions  ( [ eq : lapse_bc]-[eqn : bc_last ] ) are used in place of the standard equations of motion for  @xmath43 . since the evolution system is not symmetric hyperbolic , at least inside a large class of symmetrizers  @xcite , with the standard puncture gauge",
    ", we can not rely on a discrete energy method to guarantee numerical stability , even in the linear constant coefficient approximation .",
    "we will see however that this implementation of the boundary conditions is numerically well - behaved in the experiments we perform .",
    "sommerfeld boundary conditions are implemented in a similar way ; instead of replacing the equations of motion for  @xmath71 by  ( [ eq : lapse_bc]-[eqn : bc_last ] ) we choose  ( [ eqn : sommerfeld_first]-[eqn : sommerfeld_last ] ) and likewise for bssnok , but without the  @xmath5 boundary condition .",
    "in this section we present 3d evolutions of single isolated compact objects and compare systematically bssnok and z4c runs .",
    "the main focus is on the behavior of the hamiltonian constraint violation , due to truncation and artificial bcs errors .",
    "we assess long term stability of the z4c formulation in 3d evolutions of puncture black holes ( both non - spinning and rapidly spinning ) and compact stars , and demonstrate an overall improvement in constraint preservation and in some instances accuracy of physical quantities ( absolute numerical errors at finite resolution ) when the z4c formulation is employed .",
    "the spurious effect of sommerfeld bcs and the improvement obtained with the new bcs are discussed in detail .",
    "our results for spherically symmetric spacetimes are interpreted in view of previous results obtained in  @xcite by means of 1d simulations .",
    "the use of z4c does not significantly improve the computation of the gravitational radiation emitted by a rapidly spinning bowen - york puncture  @xcite .",
    "in particular we find that in both cases we do not obtain a clear pointwise convergence of the waves at the resolutions used in these tests .",
    "this result is possibly related to a lack of resolution , or to the use of punctures in the black hole description , rather than to deficiencies in either formulation .",
    "evolutions of a non - spinning puncture of mass  @xmath72 with bssnok and z4c and sommerfeld and constraint preserving bcs are compared .",
    "we confirm qualitatively the results obtained with 1d simulations  @xcite .",
    "in particular the new bcs reduce significantly the spurious constraint violation incoming from the boundary in the case of z4c .",
    "the largest single constraint violation however occurs at the puncture , where both formulations give similar results .",
    "constraint violations in space at  @xmath73 ( upper panel ) and  @xmath74 ( lower panel ) in an evolution of a schwarzschild puncture . at  @xmath73",
    "we see an incoming pulse of hamiltonian constraint violation in both the bssnok and z4c evolutions .",
    "the fact that the violation propagates in the bssnok evolution test is not in contradiction with the pde properties of the bssnok constraint subsystem , because the hamiltonian constraint itself is not a zero - speed characteristic variable of the constraint subsystem . at this resolution ,",
    "the incoming constraint violation with the z4c constraint preserving boundary conditions is roughly three times smaller than that of z4c with the sommerfeld boundary condition , but the violations with the constraint preserving boundary conditions converge away with resolution whilst those of the sommerfeld conditions do not . in the lower panel",
    "we can see the effect that the zero - speed mode of the bssnok constraint subsystem has on the hamiltonian constraint violation at the outer boundary at late times .",
    ", scaledwidth=49.0% ]    [ [ setup . ] ] setup .",
    "+ + + + + +    we employ five levels of box - in - box mesh refinement , and attach the shells at  @xmath75 .",
    "each box has  @xmath76 , and the resolution of level  @xmath77 is  @xmath78 per direction .",
    "we choose  @xmath79 angular and  @xmath80 radial points in each spherical patch so that the outer boundary is located at  @xmath81 .",
    "no symmetries are imposed .",
    "the puncture is evolved with a precollapsed lapse as discussed in  @xcite . in real applications the outer boundary",
    "is typically placed further out , perhaps at  @xmath82 or  @xmath83 .",
    "although this does not solve issues caused by the boundary in principle , and is not an efficient treatment , in practice it reduces some of the features we will encounter here . by design however , in these tests , we aim to see the behavior of the constraint preserving conditions .",
    "[ [ constraint - violation - in - the - strong - field - region . ] ] constraint violation in the strong - field region .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    in each test we find that the hamiltonian constraint violation in a neighborhood of the puncture is large , taking a maximum value , at this resolution of @xmath84 at around @xmath85 , before being rapidly suppressed to @xmath86 .",
    "these values should not be taken particularly seriously because of the finite regularity of the solution at the puncture . since much of the physics",
    "is concentrated around the puncture large numerical error and therefore large constraint violation are to be expected in this region .",
    "these violations converge away more slowly than others in the simulations .",
    "the z4c evolutions do not reduce this violation . as observed in spherical symmetry ( see fig .",
    "10 of  @xcite ) we see small amounts of the puncture constraint violation propagating out of the horizon with either formulation",
    ". unsurprisingly , the rectangular mesh - refinement boundaries in the 3d evolutions obscure the feature . the z4c evolutions do not qualitatively affect this behavior , which seems to improve with resolution .    [ [ constraint - violation - at - large - radii . ] ] constraint violation at large radii",
    ". + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    in fig .  [",
    "fig : po : ham_d ] the hamiltonian constraint violation on the spherical shells in space at times @xmath87 and @xmath88 is plotted .",
    "we find that the incoming constraint violation of the z4c sommerfeld evolution is comparable to that of the bssnok evolution , although at late times most of the constraint violation caused by the outer boundary has been absorbed by the boundary ; the problem is that the constraint violation induced by the sommerfeld boundary condition , with either bssnok or z4c , does not converge away with resolution .",
    "note that comparing the bssnok sommerfeld evolution with the z4c cpbc data is not entirely fair , because there is every possibility that constraint preserving boundary conditions for bssnok , see for example  @xcite , could also be implemented . in any case",
    ", it is evident that the z4c constraint preserving boundary conditions are helpful in reducing this violation .",
    "it is possible to reduce further the constraint violation by using a large constraint damping term , as for example in  @xcite , but in spherical symmetry we found that values of  @xmath89 can adversely affect the dynamics of the evolutions with z4c at late times .",
    "we are therefore wary of using large damping parameters , but make no claim about the effect of such damping terms on other conformal decompositions of z4 .",
    "our comparison of the new three dimensional numerics with earlier findings in spherical symmetry is completed by the evolution of a single stable neutron star .",
    "we find z4c advantageous in reducing constraint violation that accumulates in grid regions occupied by the matter .",
    "in particular the @xmath90 norm of the hamiltonian constraint is found to be three orders of magnitude smaller for standard resolutions .",
    "the spurious ringing effect due to sommerfeld bcs pointed out in spherical symmetry is visible also in 3d simulations , but does not dominate the error budget at typical resolutions . in our earlier study",
    "@xcite we also evolved an unstable single star in a so - called migration test .",
    "we suppress such an experiment here ; our tests of strong field dynamics are instead performed with binary spacetimes in section  [ sec : bin ] .",
    "[ [ setup.-1 ] ] setup .",
    "+ + + + + +    we use three levels of box mesh refinement , and attach the spherical grids at  @xmath91 .",
    "the lowest resolution runs use  @xmath92 , the star is completely covered by the innermost grid level @xmath93 with a resolution of @xmath94 per direction .",
    "we choose @xmath95 angular and  @xmath96 radial points in each spherical patch so that the outer boundary is located at  @xmath97 .",
    "additional runs at twice the resolution  ( @xmath98 ) are performed .",
    "no symmetries are imposed .",
    "the star is described by a  @xmath99 polytropic eos with gravitational mass  @xmath100 and radius  @xmath101 which is exactly the same model evolved in  @xcite in bespoke spherical symmetry .",
    "the evolutions are characterized by oscillations triggered by truncation errors .",
    "[ [ constraint - violation - and - truncation - error - dynamics . ] ] constraint violation and truncation error dynamics .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    the key findings of the earlier numerical experiments in spherical symmetry were : ( i )  in the bssnok region containing matter , the hamiltonian constraint inside the star grows throughout the evolution , whereas in the z4c evolution it does not ; ( ii )  the bssnok simulations have larger oscillations ( larger truncation errors ) than z4c ; ( iii )  if sommerfeld bcs and sufficient resolution are employed , incoming modes from the boundary perturb the star amplifying unphysically the oscillations ( see fig .  1  @xcite ) . in 3d simulations we find some similar features",
    "the growth of the hamiltonian constraint is the dominant one , because of lack of resolution the oscillations are not significantly affected , and the effect of sommerfeld bcs is less pronounced but visible .",
    "the norm of the hamiltonian constraint is plotted as a function of time in the left panel of fig .",
    "[ fig : ss : rho_ham ] . by the end of the simulation",
    "the constraint violation in the z4c evolution is about two orders of magnitude smaller than the bssnok violation and interestingly smaller even than the initial violation .",
    "the behavior is similar to that shown in fig .  5 of  @xcite .",
    "we will demonstrate the growth of the hamiltonian constraint also pointwise on the grid in section  [ sec : bin ] , in the case of binary spacetimes .",
    "considering momentum constraint violations one finds , as in spherical symmetry , that the differences are far less dramatic .",
    "the main difference in this case is that the momentum constraint violations with bssnok are more dynamical , and slightly larger , although this is probably just because of reflections from the sommerfeld outer boundary condition , which propagate many times over the computational domain . with either bssnok or z4c ,",
    "the largest persistent violation in the momentum constraint occurs at the surface of the star . in the right panel of fig .",
    "[ fig : ss : rho_ham ] we show the oscillations of the central density during the simulation time .",
    "it is not possible to distinguish significant differences , probably because of the low resolution employed .",
    "the large effect seen in  @xcite was with a resolution ten times higher than here .",
    "[ [ the - sommerfeld - boundary - kick . ] ] the sommerfeld boundary kick .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + +    in the left panel of fig .",
    "[ fig : ss : rho_ham ] one sees the effect of the sommerfeld bcs with z4c on the norm of the hamiltonian constraint . as in the single puncture evolution , roughly when the outer boundary becomes causally connected to the central body , there is a large incoming pulse of constraint violation .",
    "this pulse perturbs the central object , but unlike in the spherical case ( see fig .",
    "1 of  @xcite ) , the violation is not the dominating effect on the dynamics . in the right panel of fig .",
    "[ fig : ss : rho_ham ] we do not see a significant jump in the central density .",
    "a blow - up of the central density plot is however shown in fig .",
    "[ fig : ss : rho_kick ] , together with data from a shorter run at twice the resolution .",
    "the figure demonstrates that at approximately  @xmath102 the star is slightly perturbed by the sommerfeld bcs .",
    "more importantly , the figure shows that the size of the perturbation is not converging away with resolution , whereas the amplitude of the oscillations does , so we expect this error to be dominant at higher resolutions .",
    "by contrast cpbcs are characterized by smaller reflections .",
    "the hamiltonian constraint violations propagating out from the star appear to converge at approximately second order , in line with our expectation for our hydrodynamics scheme .",
    "this rate of convergence is maintained by the constraint preserving boundary conditions ( see also fig .  5 of  @xcite ) .     a closer inspection of the oscillation of the central density at early times , both at the original and twice the resolution , for the z4c evolutions .",
    "the constraint violation from the sommerfeld boundary causes a jump in the central density , as observed in earlier work  @xcite .",
    "this effect does not converge away with resolution , but at these resolutions is not the dominant effect .",
    ", scaledwidth=49.0% ]      here we compare the evolutions of a single bowen - york spinning puncture  @xcite with spin  @xmath103 .",
    "we choose such a comparatively large value of the spin parameter ( see also  @xcite ) to test performance for large values of the conformal factor .",
    "for  @xmath104 the puncture contributes only  @xmath105 of the mass , while the remainder is in the brill wave contribution of the conformal factor .",
    "both formulations give comparable results in terms of stability , the norms of the constraint violation , the majority of which occurs at a few points near the puncture , and gravitational waves . with either system",
    "we observe that pointwise fourth order convergence is _ not _ achieved in the gws at the resolutions at which we performed the tests , although global errors scale between third and fourth order .",
    "we expect that this behavior is related to inaccuracies caused either by lack of resolution , or intrinsic to the puncture description of the black hole .",
    "[ [ setup.-2 ] ] setup .",
    "+ + + + + +    we use five levels of box mesh refinement , and attach the spherical grids at  @xmath106 . in the lowest resolution runs each box has  @xmath92 points per direction , and the resolution of level  @xmath77 is  @xmath107 .",
    "we choose  @xmath95 angular and  @xmath96 radial points in each spherical patch so that the outer boundary is located at  @xmath108 .",
    "runs at resolutions  @xmath109 ( with the grid spacing scaled in order to maintain the same grid setup ) are performed .",
    "bitant symmetry is imposed .",
    "the initial data for this test is constructed in with an ad - hoc method , used elsewhere in the literature , in which the bam spectral binary puncture initial data solver is applied to a single puncture with large spin and another , unboosted and unspinning , located very close by with a relative uncorrected mass of  @xmath110 .",
    "there is no sign of the second puncture on the grid .",
    "problems with convergence do however make this construction a point to address .",
    "[ [ basic - features - of - the - dynamics . ] ] basic features of the dynamics .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    the  @xmath111 multipolar mode of  @xmath112 emitted during the evolution of this initial data are shown in fig .",
    "[ fig : sp : wav ] , for the lowest resolution runs .",
    "the waves lie on top of each other ; as resolution is increased they converge to each other . at late times ,  @xmath113 , a boundary effect is visible in the bssnok data .",
    "the bcs of z4c improves this behavior significantly .",
    "note that  @xmath113 corresponds roughly to the time needed by a wave initially near the puncture to propagate to the outer boundary , be reflected from the strong field region and travel out once again to the extraction sphere at  @xmath114 .",
    "no feature is visible as the wave passes from the outer boundary at around  @xmath115 , perhaps because  @xmath116 is by construction insensitive to incoming gravitational radiation .",
    "we computed the adm mass integral ( see eq .",
    "later ) and find that in the bssnok runs a drift begins exactly when the outer boundary becomes causally connected with each observer , although this drift is then swamped by the effect of the outgoing gravitational waves .",
    "the effect of the sommerfeld boundary condition on physical quantities is discussed in more detail for binary neutron star simulations later .",
    "comparison of the waves with z4c and bssnok from the single spinning puncture .",
    "the upper panel shows the  @xmath111 multipole mode of the real part of  @xmath117 emitted during the evolution .",
    "the data is taken from the lowest resolution  ( @xmath118 points per direction ) test .",
    "the z4c and bssnok waves agree extremely well until about  @xmath119 , roughly the time when the incoming constraint violation from the bssnok sommerfeld boundary condition is reflected from the central body and reaches the extraction sphere at  @xmath120 .",
    "the lower two panels show the difference between the same quantity for the  @xmath121 ( @xmath122 ) and  @xmath122 ( @xmath123 ) point runs , respectively .",
    "the two systems are almost perfectly comparable . ,",
    "scaledwidth=49.0% ]    [ [ constraint - violation . ] ] constraint violation .",
    "+ + + + + + + + + + + + + + + + + + + + +    as in the non - spinning case the largest hamiltonian constraint violation is at the puncture . the evolution of the  @xmath90 norm of the hamiltonian constraint is shown in the top panel of fig .",
    "[ fig : sp : ham ] , for the lowest resolution runs .",
    "the results from z4c and bssnok are comparable . at time",
    "@xmath124 bssnok data are affected by the sommerfeld boundary conditions .",
    "the bottom panel of fig .",
    "[ fig : sp : ham ] shows the hamiltonian violation in space at  @xmath124 .",
    "the largest violation is at the puncture and of similar magnitude , but far from the grid origin z4c violation behaves better .",
    "hamiltonian constraint violation for the spinning puncture evolution . as in the upper panel of  fig .",
    "[ fig : sp : wav ] data is taken from the lowest resolution  ( @xmath92 points per direction ) test .",
    "the upper panel shows the  @xmath90 norm of the constraint as a function of time .",
    "the jump in violation at around  @xmath125 in the bssnok data appears to be caused by the sommerfeld boundary conditions , and does not converge away with resolution . the bottom panel shows the hamiltonian violation in space at time  @xmath126 , approximately at the peak of the jump in the upper plot , in the near - field  ( @xmath93 box ) region.,scaledwidth=49.0% ]    [ [ convergence . ] ] convergence .",
    "+ + + + + + + + + + + +    we looked at self convergence of the waves presented in the upper panel of fig .",
    "[ fig : sp : wav ] . at early times , up to  @xmath127 , only second order pointwise convergence is observed with either bssnok or z4c .",
    "later , the errors scale at third - to - fourth order rate in magnitude ( norm ) but pointwise convergence is lost .",
    "the use of either more resolution , properly constructed initial data , or simply more refinement levels , i.e.  high resolution at the puncture , might improve this behavior . in  @xcite similar convergence tests were performed but with a lower spin  @xmath128 , with two more , a total of seven , levels of mesh refinement , but with a smaller range in resolutions , and a lower maximum resolution in a neighborhood of the puncture . although the plots presented in  @xcite ( see fig .",
    "6 ) are scaled for fourth order convergence , the difference in resolutions makes it hard to distinguish between different convergence factors with confidence .",
    "the earlier study also found pointwise convergence is not maintained in the gravitational waves , thus our findings are consistent . a detailed discussion of spin and higher order finite differencing can be found in  @xcite .",
    "in this section we assess the performance of the z4c formulation in the simulation of the merger of two compact objects .",
    "two standard initial configurations are studied , with a set of approximately  @xmath129 simulations , in detail : an equal - mass , non spinning , black hole binary ( bbh ) , and an equal - mass , irrotational neutron star binary ( bns ) .",
    "we discuss evolutions of about three orbits and compare systematically the results from several convergence series with the corresponding ones obtained with bssnok .",
    "[ [ presentation - rubric . ] ] presentation rubric .",
    "+ + + + + + + + + + + + + + + + + + + +    in the presentation of the results , we describe the main features of the dynamics , then the hamiltonian constraint violations are compared and finally the accuracy of the gws and other physical quantities are discussed in relation with the hamiltonian constraint violations . for brevity we discuss only the main emission channel , the  @xmath130 multipole of the radiation .",
    "as is standard , the ( complex )  @xmath116 projection  @xmath131 , extracted on a coordinate sphere @xmath132 of radius  @xmath133 , is decomposed into amplitude and phase according to @xmath134 on the same coordinate sphere we compute the integral @xmath135 the spatial metric  @xmath12 which approximately represents the adm energy .",
    "the adm energy ( or mass ) of the system is given by @xmath136 and it is a conserved quantity . on a given sphere in the wave zone ,",
    "however , @xmath137 is expected to deviate from  @xmath138 due to the gravitational energy radiated away from the sphere , @xmath139 note that the outer integral in eq .",
    "is performed by a simple riemann sum .",
    "the angular momentum is computed with similar adm - like integrals , see e.g.  @xcite and references therein , but note that this quantity remains ambiguously defined ( gauge dependent ) also in the asymptotic limit @xmath140 for a generic asymptotically flat spacetime .",
    "we stress that the observed differences , up to outer boundary effects , seem to converge to the same continuum solution .",
    "they are however significant at fairly high resolutions in most of the cases we studied . particularly relevant",
    "are the differences in hamiltonian constraint violation in the evolution of non - vacuum spacetimes .",
    "we show evidence that these violations are correlated with the quality of the numerical waveforms .",
    "[ [ convergence - tests . ] ] convergence tests .",
    "+ + + + + + + + + + + + + + + + + +    standard three level self - convergence tests are performed using simulations at different grid resolutions .",
    "these tests can be biased by the choice of the triplet .",
    "as discussed in  @xcite we consider only triplets in which i )  the ratios between the low and medium and medium and high resolutions are  @xmath141 ( ideally  @xmath142 ) ; and ii )  the scaling factor is at least of order two , @xmath143 , where  @xmath144 is the convergence rate .",
    "we find that if these criteria are not met then the measured convergence order from different triplets is not consistent .",
    "additionally , in our experience we found it important to verify that the use of different triplets gives consistent results .",
    "even when the criteria above are satisfied , different triplets can give differing convergence factors .",
    "the result is acceptable if the rates consistently improve as higher resolution triplets are taken .",
    ".[tab : gridsetup ] summary of the grid configurations and of the runs .",
    "columns : name of the configuration , maximum refinement level , moving levels are those with @xmath145 , number of points per direction in the moving levels , resolution in the level @xmath146 , number of points per direction in the non - moving levels , resolution in the levels @xmath61 ( radial resolution in the shells ) , number of radial points in the shells , number of angular points in the shells , outer boundary . note that the resolution is given in units of @xmath147 for bbh runs , but in units of @xmath148 for bns runs .",
    "runs marked with `` * '' were reproduced with the amss - ncku code . [ cols=\"^,^,^,^,^,^,^,^,^,^,^\",options=\"header \" , ]     [ [ initial - data . ] ] initial data .",
    "+ + + + + + + + + + + + +    before discussing the results we summarize the initial data and grids employed .",
    "initial data for bbhs are conformally flat puncture initial data constructed using the brandt - brgmann puncture method  @xcite with the bam implementation of the spectral puncture initial data solver  @xcite .",
    "the holes have equal mass , an initial separation of  @xmath149 and are placed in a quasi - circular configuration , on which the pad resummed eccentricity reduction algorithm of  @xcite was applied .",
    "the initial data are interpolated onto the amss - ncku and bam grids by eighth order lagrangian barycentric interpolation .",
    "initial data for bns assume a conformally flat metric and irrotational flow .",
    "the initial separation is  @xmath150 , adm mass and angular momentum are  @xmath151 and  @xmath152 , respectively .",
    "the stars are described by a  @xmath99 polytropic eos , each has baryonic mass of  @xmath153 .",
    "these initial data have been produced with the lorene  @xcite library and have been already evolved in several places  @xcite .",
    "the data are interpolated onto the bam grid by spectral interpolation .",
    "[ [ grid - setup . ] ] grid setup .",
    "+ + + + + + + + + + +    all of the runs performed at different resolutions are listed in tab .",
    "[ tab : gridsetup ] , together with details of the grid setup .",
    "note that several of the bbh simulations , those marked with a  `` @xmath154 '' in tab .",
    "[ tab : gridsetup ] , have been performed with both the bam and amss - ncku codes , indicating , at least for the chosen grid settings , the robustness of our findings .",
    "note that our lowest resolution vacuum setup bbh0 has maximum resolution comparable to that of the highest resolution in the earlier bam calibration paper  @xcite , although the boxes in  @xcite were larger which also affects accuracy .",
    "the resolutions of the setups bbh2 and bbh3 are comparable to the ones of recent bbh simulations  @xcite that required only moderate accuracy , while the maximum bbh9 resolution is similar to what was used to obtain some of the bam waveforms for the ninja-2 catalog  @xcite .",
    "the highest resolution in the matter simulations bns6 , bns6r approaches those in the accurate runs of  @xcite .",
    "other details about gauge conditions , damping parameters , etc . have been already given in sec .",
    "[ sec : numerics ] .",
    "[ [ basic - features - of - the - dynamics.-1 ] ] basic features of the dynamics .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    let us discuss the evolution of bbh initial data .",
    "the black holes evolve for about  @xmath155 orbits before merging , radiating energy and angular momentum in gravitational waves . in fig .",
    "[ fig : bbh : tracks ] the puncture tracks are plotted for the grid bbh2 in tab .",
    "[ tab : gridsetup ] .",
    "the gravitational waves have exactly the same basic profile , but unlike in the evolution of a single spinning puncture ( see fig .",
    "[ fig : sp : wav ] ) they _ are _ visually distinguishable , with the absolute maximum of the  @xmath130 multipole mode of the real part of  @xmath117 occurring , approximately  @xmath156 , earlier in the bssnok data , in accordance with the expectation from fig .",
    "[ fig : bbh : tracks ] .",
    "the differences that accumulate over the evolution converge away with resolution . in the bbh4 data",
    "the delay is only  @xmath157 .",
    "also in contrast to the single spinning puncture case , presumably because the outer boundary is placed so far out at  @xmath158 , no boundary feature is visible in the bssnok waves , at least up to a radius of  @xmath159 within the run - time of the simulation .",
    "tracks of the punctures for binary black hole inspiral for the configuration bbh2 in tab .",
    "[ tab : gridsetup ] . in the continuum limit , upto outer boundary effects",
    ", the tracks should agree perfectly because we are evolving the same data with the same gauge choice regardless of the formulation . at finite resolution",
    "however different formulations and discretizations may give different results .",
    "initially the tracks agree , but a difference accumulates ; the bssnok punctures merge slightly sooner than the z4c ones .",
    "this plot does not indicate either set of numerical data is better than the other , only that there is qualitative agreement between the results.,scaledwidth=49.0% ]         [ [ constraint - violation.-1 ] ] constraint violation .",
    "+ + + + + + + + + + + + + + + + + + + + +    in fig .  [",
    "fig : bbh : ham2d ] the hamiltonian constraint  @xmath160 is plotted in space for the bbh1 runs on the orbital plane at a simulation time @xmath161 ( roughly 1.5 orbits ) on refinement levels @xmath162 . as in case of the single puncture evolution the hamiltonian constraint violation is dominated by the punctures and , for this data , at this time , has a maximum absolute value of  @xmath163 regardless of the formulation .",
    "however , the hamiltonian constraint violation differs in the strong field region depending on the formulation . in the bssnok case",
    "a significant hamiltonian violation extends to level  @xmath164 with an almost spherical pattern . in the z4c case",
    "the violation is mainly restricted to the highest level around the puncture .",
    "note the effect of cartesian mesh refinement in the plot .",
    "for the same data the momentum constraint away from the puncture is also roughly an order of magnitude smaller in the z4c data .",
    "the highest resolution runs , bbh9 , have the smallest constraint violation even in the strong field region , but the violation there is dominated by that of the puncture .",
    "the difference between the hamiltonian constraint violation of the bbh1 and the bbh9 data in this region is at most a factor of three for either formulation despite the difference in resolution .",
    "[ [ gravitational - wave - accuracy . ] ] gravitational wave accuracy .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + +    quantitative differences are observed in the gravitational radiation computed in bssnok and z4c simulations .",
    "the differences can be appreciated in self - convergence tests for phase and amplitude .",
    "typical results are presented in fig .",
    "[ fig : bbh : conv ] .",
    "the phase errors accumulated to merger  ( @xmath165 ) are shown in bottom panels . when the z4c simulation is employed we observe a factor three of improvement .",
    "this behavior is common to all of the simulations performed .",
    "similarly , the amplitude error improves by a factor two - to - three , as can be appreciated from the top panel of the figure .",
    "the results obtained with the z4c are not only characterized by smaller errors , but also by the fact that convergence is maintained for longer time , in particular in phase errors .",
    "all the errors are observed to converge with increasing resolution .",
    "the z4c and bssnok data sets also appear to converge to each other , suggesting the same continuum limit is approached .",
    "we conclude that at finite resolution the use of z4c results in the computation of more accurate waveforms .             [",
    "[ convergence - issues . ] ] convergence issues .",
    "+ + + + + + + + + + + + + + + + + + +    for the converge tests presented in fig .  [",
    "fig : bbh : conv ] third order convergence is obtained , despite the use of fourth order operators for the bulk derivatives ( see below ) . in our experiments with the described grid settings we find it difficult to achieve fourth order convergence in gws from orbiting puncture runs , regardless of the formulation employed . on the other hand",
    "clearer ( order approximately 3.5 ) convergence is demonstrated in appendix  [ app : teukolsky ] for the teukolsky wave , a simpler problem which however retains some of the important features , namely , nonlinearity , in the sense that we evolve with the full bam z4c infrastructure , constraint violation , because the wave only satisfies the constraints to linear order in perturbation theory , present in the bbh calculations . on the other hand",
    "the teukolsky wave test has neither moving boxes or punctures .",
    "we were unable to identify the precise reason for the behavior in presence of punctures , however we point out the following well - known facts : i )  punctures have finite regularity , which can obviously affect the formal order of convergence of high - order finite - differencing stencils ; ii )  moving box simulations have several source of errors ( second order time interpolation , regridding , the number of mesh refinement buffer zones , 3d interpolation , data between boxes and shells , spheres and mode projection ) , a clearly defined error budget is very complicated to construct ( for a discussion see e.g.  @xcite ) ; iii )  simulations have several freely specifiable parameters ( grid parameters and/or gauge parameters ) , and systematically tuning all of them is beyond the aim of this work ; iv )  the convergence order observed actually depends on the triplets chosen in the self - converge test .",
    "the experimentally measured convergence factors lie between two and four for both the formulations during the inspiral . around the time of the merger the bssnok convergence rate drifts up to five or six .",
    "the drift is on average smaller for higher resolution triplets .",
    "this does not mean that the bssnok data are converging at a high order , but rather that the errors in the simulation do not allow us to judge the rate in a meaningful way with a simple error model .",
    "we do not claim that waveforms from either formulation are unreliable , but we are reluctant to estimate the absolute errors by richardson extrapolation , which assumes a certain rate of convergence .    [ [ amss - ncku - bam - comparison . ] ] amss - ncku - bam comparison .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + +    the qualitative features of these results have also been observed in simulations with the amss - ncku code . starting with the puncture tracks as in fig .",
    "[ fig : bbh : tracks ] , we find that the bssnok also merge slightly earlier at a given resolution , roughly  @xmath166 for bbh0 and  @xmath167 for bbh2 , in the same ball - park as the values obtained with bam .",
    "note that we do not expect to obtain identical values from the two codes , because although they share many ingredients , some specifics , for example the shells implementation and grid placement , differ .",
    "as in fig .  [",
    "fig : bbh : ham2d ] the hamiltonian constraint appears to be smaller in the z4c data when using amss - ncku . to test the robustness of this finding we have made a number of experiments with different precollapsed initial profiles for the lapse .",
    "we also tried different constraint damping factors for  @xmath168 , up to  @xmath169 .",
    "neither change seems to make a significant difference ; the z4c hamiltonian constraint is always smaller .",
    "note that in the earlier stability work  @xcite , the hamiltonian constraint was computed directly from the conformal variables .",
    "now , as in bam , we compute it by transforming first to the adm variables .",
    "the two versions of the calculation differ by additions of  @xmath5 and  @xmath170 , and obviously the finite difference approximation .",
    "the amss - ncku code appears to produce slightly larger errors at mesh refinement boundaries than those of bam .",
    "the reason for this is currently unclear , but may be the cause of the larger errors that we find in the amss - ncku wave - forms .",
    "nevertheless we still find , as in fig .",
    "[ fig : bbh : conv ] that the z4c wave forms are roughly twice as accurate in phase and amplitude .",
    "+      +     @xmath90 norm of the hamiltonian constraint computed in the strong field , level  @xmath93 , region , with the grid setup bns6 from tab .",
    "[ tab : gridsetup ] as in fig .",
    "[ fig : bns : rho2d ] . at this resolution",
    "the z4c violation is between one and two orders of magnitude smaller throughout the evolution . , scaledwidth=49.0% ]         [ [ basic - features - of - the - dynamics.-2 ] ] basic features of the dynamics .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    let us discuss the evolution of bns .",
    "the binary evolves approximately two orbits before contact , then merges forming a hypermassive neutron star ( hmns ) which finally collapses on dynamical timescales .",
    "dynamics and related gravitational wave emission were described in detail in our previous work  @xcite so we do not repeat them here .",
    "we only mention that the gravitational emission is characterized by approximately six cycles during which the gw frequency increases monotonically ( even after contact ) , the merger time is defined conventionally at peak of the amplitude s",
    "@xmath130 mode , nonlinear ( quasi - radial and non - axisymmetric ) oscillations of the hmns generate the post - merger signal which decays exponentially after collapse .",
    "figure  [ fig : bns : rho2d ] shows snapshots of the rest - mass density on the orbital plane around merger for a typical simulation obtained with the two formulation ( and same setup ) .",
    "there are visible differences in the `` dynamics '' , and in the z4c run the contact and merger happens at a later simulation time . as in the case of the bbh puncture tracks , these plots are gauge dependent but they refer to the same gauge choice up to truncation errors and so they can be compared . in this respect ,",
    "note that the centroids of the stars are offset , this is a coordinate effect due to the choice  @xmath171 in the shift condition and was studied in detail in  @xcite .    [ [ constraint - violation.-2 ] ] constraint violation .",
    "+ + + + + + + + + + + + + + + + + + + + +    the  @xmath90 norm of the hamiltonian constraint violation during the evolution is reported in fig .",
    "[ fig : bns : ham_norm ] . on the refinement level  @xmath93",
    "one can observe an improvement of a factor  @xmath172 during the whole evolution if z4c is employed .",
    "by contrast the norms of each component of the momentum constraint agree for both evolutions , an almost constant violation around  @xmath173 is observed . the hamiltonian violation on the orbital plane around merger time is shown in fig .  [ fig : bns : ham2d ] , which includes now refinement levels  @xmath93 and  @xmath164 . even using the highest resolution run ( bns6 ) we register a two - to - three order magnitude difference in the absolute value of the hamiltonian constraint .",
    "it is noteworthy that the violation has an almost spherical pattern on and around the strong field region of the binary , which suggests that the violation is _ not _ dominated by rectangular mesh refinement boundaries .",
    "[ [ gravitational - wave - accuracy.-1 ] ] gravitational wave accuracy .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + +    the differences at finite resolution between bssnok and z4c described so far have an impact on the computation of physical quantities : gravitational waves and adm mass . figure  [ fig : bns : conv ] shows the result of a standard three - level self - convergence test for phase and amplitude of the  @xmath130 mode of the gravitational radiation emitted . for the particular triplet shown bssnok data cease converging before contact .",
    "an analogue result was already found at similar resolutions in  @xcite ( see also the detailed discussion in  @xcite ) . on the other hand",
    "the z4c data are found to converge at approximately second order rate _ beyond _ contact and up to merger ( @xmath174 ) .",
    "similarly to the bbh case , z4c waveforms are found to be more accurate by a factor three - to - four in accumulated phase and amplitude to merger time .",
    "we relate this behavior with the improvement obtained in hamiltonian constraint preservation . because truncation errors and the hamiltonian violation ( especially in the matter region ) in bns simulations are generically larger , the use of z4c makes a significant difference for the accuracy of these simulations .",
    "[ [ mass - and - angular - momentum - conservation . ] ] mass and angular momentum conservation .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    as in the case of a single spinning puncture we consider the adm mass integral , eq .  , and the energy radiated in gws , eq .  .",
    "in fig .  [",
    "fig : bns : madm ] we show that z4c permits a reliable computation of @xmath137 . when corrected for the gw energy , the conservation of the adm mass",
    "is of order of @xmath175 .",
    "by contrast bssnok data do not even allow for a reliable estimate of @xmath176 .",
    "note that the adm mass can be also estimated by means of a volume integral rather than a surface integral , see e.g.  @xcite .",
    "the more expensive volume integral computation can be more accurate and is found to give better results for bssnok in the case of black hole binaries  @xcite .",
    "figure  [ fig : bns : jadm ] shows the adm angular momentum integral , both with and without a correction by radiated angular momentum , at an extraction radius of  @xmath177 , for both bssnok and z4c with cpbcs . the outer boundary for this run ( bns2a in tab .",
    "[ tab : gridsetup ] ) is at approximately  @xmath178 .",
    "evidently at either radius the bssnok data is very poorly behaved , and has large error .",
    "in contrast in the z4c evolution the corrected angular momentum are well conserved until the merger signal , which we expect to be much less accurate , reaches the extraction sphere .",
    "early in the simulation the bssnok data are also conserved , but there is a jump at _ exactly _ the time  @xmath179 when the outer boundary becomes causally connected to the extraction radius .",
    "we checked that this feature holds on every extraction sphere .",
    "this demonstrates clearly that the sommerfeld boundary condition has an effect on the behavior of physical quantities inside bssnok simulations .",
    "one way to avoid the feature would be to place the outer boundary further away , which , depending on the physics of interest , may not be prohibitively expensive with the spherical shells for the wave zone , but it is not desirable to discard every extraction sphere as soon as it becomes causally connected to the outer boundary , because a larger domain would ideally be used for more reliable wave extraction , rather than as a buffer for poor boundary conditions .",
    "for comparison it would be very interesting to see data from bssnok simulations , where there is still a zero - speed mode in the constraints , with an implementation of the constraint preserving conditions of  @xcite .",
    "it is natural to compare the early times in figures  [ fig : bns : madm ] and  [ fig : bns : jadm ] to fig .",
    "@xmath180 of  @xcite , a similar plot , computed with the spectral einstein code , for inspiralling black hole neutron star binary data .",
    "the z4c results are competitive , although it remains to be seen if they will continue to be so over many orbits .",
    "this paper is the conclusion of a series  @xcite , the aim of which was to bring the advantages of the generalized harmonic formulation to the moving puncture method .",
    "we presented here for the first time 3d numerical relativity simulations of compact binaries performed with z4c , a conformal decomposition of the z4 formulation .",
    "we started with evolutions of single compact objects and found that the expectations obtained by earlier work in spherical symmetry are largely borne out in the 3d numerics .",
    "the most striking feature in these tests is that , in the evolution of a single stable star by  @xmath88 at the resolutions used in our tests , is that the norm of the hamiltonian constraint is approximately three orders of magnitude smaller in the z4c data .",
    "for the first time we have presented results which combine radiation controlling , constraint preserving outer boundary conditions with the moving puncture method .",
    "these boundary conditions removed a perturbation to the central rest mass density of the star which is present when using sommerfeld boundary conditions . at the resolutions of our tests",
    "however the outer boundary is typically not the leading order contribution to numerical error . in evolutions of a single spinning puncture we found that the z4c with the new outer boundary conditions remove certain constraint violating features present in the bssnok data , but at least at early times the qualitative physical picture is unaltered .",
    "we then compared evolutions of compact binary spacetimes . in these tests we placed the outer boundary much farther away from the central body so as to simplify the discussion . throughout the evolution of binary neutron star initial data",
    ", we find that at the same resolutions the z4c formulation has between one and two orders of magnitude less hamiltonian constraint violation in the norm .",
    "interestingly the hamiltonian constraint violation in the z4c tests in this case stays at or below the level in the initial data , at least until the stars merge , and the simulations may therefore even be competitive with those of a constrained formulation .",
    "we find similar , albeit much less pronounced effects in the constraint violation in binary black hole simulations , but the change of formulation does nothing to cure the dominant constraint violation at the punctures themselves . the higher quality of the z4c data is also apparent in physically meaningful quantities . in terms of gravitational wave accuracy",
    "we find that with any triplet , satisfying certain criteria , for either binary neutron star or binary black hole data , the absolute error in either amplitude or phase of the extracted gravitational waves is between two and four times smaller in the z4c evolutions .",
    "the difference , in the evolution of compact binaries , between conservation of the adm mass integral with the two formulations is remarkable . in the bssnok simulations one can not reliably correct the integral with the radiated gravitational wave energy to arrive at a constant . in the z4c simulations near perfect conservation",
    "is achieved . furthermore , despite placing the outer boundary at a large coordinate radius , we find that the bssnok data are corrupted , for example in the angular momentum , by the sommerfeld boundary condition , whereas the z4c data are free of this problem . if nothing else this motivates the use of constraint preserving boundary conditions with the bssnok formulation .",
    "in summary we have presented a large suite of numerical experiments in which the z4c formulation was shown to give more accurate results than bssnok , both in terms of constraint violation and extracted physical quantities .",
    "we therefore expect that the z4c formulation will become a standard tool for numerical relativity .",
    "the authors are grateful to roman gold , mark hannam , sascha husa , nathan johnson - mcdaniel , doreen mller , milton ruiz and andreas weyhausen for helpful discussions .",
    "we are especially grateful to denis pollney for his patient explanation of the llama multi - patch communication algorithm .",
    "we are grateful to tim dietrich for providing the initial data for the spinning puncture evolutions .",
    "this work was supported in part by dfg grant sfb / transregio  7 `` gravitational wave astronomy '' as well as by nsf grants phy-0855315 and phy-1204334 .",
    "computations were performed primarily on juropa ( jsc , jlich ) , lrz ( munich ) , and louhi ( csc ) cluster .",
    "computer time on louhi is granted under prace - tier-1 2011 .",
    "2d scheme of the spherical patches .",
    "the darker regions denote the physical grids , the translucent numerical ghostzones .",
    "see the text for details of the various radii and how the color scheme relates to the numerical method.,scaledwidth=49.0% ]    in this appendix the implementation of the spherical patches in the bam and amss - ncku codes is described .",
    "we follow closely  @xcite , to whom we refer for further details .",
    "we describe first the bam implementation and then highlight the differences in the amss - ncku code .",
    "[ [ the - grid - structure . ] ] the grid structure .",
    "+ + + + + + + + + + + + + + + + + + +    the bam grid is made of a hierarchy of nested cartesian grid boxes , each level is labeled by the integer  @xmath181 .",
    "the level  @xmath60 ( outermost box ) is replaced with six patches with local coordinates @xmath182 .",
    "the grid of each patch is uniformly spaced in local coordinates .",
    "the maps between the local coordinates and the cartesian coordinates are @xmath183 where  @xmath184 .",
    "the local radial coordinate  @xmath185 is a fisheye coordinate  @xcite @xmath186 as function of the radius @xmath187 .",
    "the particular function function @xmath188 implemented is @xmath189 \\\\",
    "\\p_r f(r ) & = & a \\tanh[(r - r)/\\epsilon ] + b \\ , \\end{aligned}\\ ] ] where the parameters  @xmath190 and  @xmath191 determine the stretching of the coordinate and @xmath192 the transition region .",
    "the condition @xmath193 at interface between spherical patches and the boxes is important to avoid a step behavior and minimize interpolation errors . in this work",
    "we did not employ the fisheye coordinate , i.e.  we set @xmath194 , @xmath195 .    [ [ spatial - derivatives . ] ] spatial derivatives .",
    "+ + + + + + + + + + + + + + + + + + + +    field derivatives at a grid point inside the patches are calculated by finite differences on the uniformly spaced local grid .",
    "the derivatives in cartesian coordinates are obtained using the chain rule and the jacobian of the transformation  @xmath196 , @xmath197 note that the last term in these equations fixes a typo in equation  ( 5b ) in  @xcite .",
    "[ [ grid - schematic . ] ] grid schematic .",
    "+ + + + + + + + + + + + + + +    the grid structure is sketched in fig .",
    "[ fig : shells ] .",
    "the dark solid lines represent the physical grid , the lighter lines denote the ghost points which are needed for the finite differences .",
    "the green shaded regions denote the ghost zones populated by inter - patch interpolation , and overlap with the neighbor patches .",
    "the other colored areas overlap with the  @xmath60 level , and the resolution of the cartesian box is the same as the one of the radial one in the patch .",
    "the number of grid points in all the ghost zones ( cyan , green , yellow ) is equal .",
    "the distance between the points  @xmath198 and  @xmath199 is equal to that between  @xmath199 and  @xmath200 .",
    "[ [ data - communication . ] ] data communication .",
    "+ + + + + + + + + + + + + + + + + + +    spherical patches overlap on ghosts zones .",
    "two neighboring patches share the radial coordinate and the angular coordinate perpendicular to the mutual boundary .",
    "therefore only a 1d interpolation parallel to the boundary has to be performed in the green regions of fig .",
    "[ fig : shells ] . a lagrange interpolation ( sixth order in this work ) which uses the most centered possible stencil is employed .",
    "interpolation between patches and the  @xmath60 level is performed with lagrangian polynomial interpolation in 3d ( colored regions of fig .",
    "[ fig : shells ] ) .",
    "the various interpolations are done in the following order : i )  interpolate from box to shell ( yellow region ) , ii )  interpolate between shells ( green region ) , iii )  interpolate from shell to box ( cyan and red regions ) , iv )  set symmetries in box . for simplicity ,",
    "grid symmetries are not applied in the shells during evolution .",
    "each patch is evolved entirely and only afterward values at symmetry points are overwritten by copying them .",
    "we note that because the interpolation of the red region in fig .",
    "[ fig : shells ] depends on points in the cyan region , the ordering of the different interpolation can give , in principle , different results . on the other hand ,",
    "not interpolating the red region results in a `` double evolution '' , which we find leads to high frequency oscillations .",
    "[ [ dissipation . ] ] dissipation .",
    "+ + + + + + + + + + + +    artificial dissipation is necessary for numerical stability during the evolution . in particular to maintain stable box - shell interface regions .",
    "experimentally we found it important to apply different amounts of dissipation in box and spherical patches .",
    "in particular we use a _ lower _ dissipation on the spherical patches than in the box . for this work we tested only sixth order",
    "kreiss - oliger dissipation operators , using artificial dissipation coefficients  @xmath201 in the bulk and  @xmath202 in the shells ( see  @xcite for our terminology ) .",
    "the number of angular points has been chosen according to the size of the  @xmath60 box ,  @xmath203 .",
    "placing the box - shell interface close to the strong field region may also cause large growth of the error , even causing the code to crash , or affect the choice of the dissipation parameters required for stability .",
    "[ [ parallelization . ] ] parallelization .",
    "+ + + + + + + + + + + + + + + +    in order to reduce global mpi communication during shells synchronization , we use an optimized parallelization .",
    "the computations on the patches are distributed only in the radial direction .",
    "every processor has six patch parts with the same radial extension , hence the synchronization in the angular directions is performed locally by each mpi job .",
    "note that this method implies a minimum number of radial points is necessary for a given number of processors .",
    "in some early tests we found that avoiding interpolation in this way can result in computations that are an order of magnitude faster in the shells .",
    "[ [ variations - of - the - numerical - method - in - the - amss - ncku - code . ] ] variations of the numerical method in the amss - ncku code .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    there are several differences in the implementation of shells in amss - ncku with respect to bam . in amss - ncku",
    "there is no option to use a radial fish - eye coordinate .",
    "relating to the interpolation between box and shell , the scheme is somewhat different to bam .",
    "we set the length between the point  @xmath198 and  @xmath199 as the length of six points and we take these points as buffer points .",
    "we set the distance between  @xmath199 and  @xmath200 larger than the distance between  @xmath198 and  @xmath199 .",
    "we take this part of region as the double cover region of both box and shell .",
    "we set six points for the box outside of  @xmath200 and take them as buffer points .",
    "similar to the treatment of the mesh refinement interface , we fill the buffer points for box and shell only at the end of a full rk4 step .",
    "as opposed to bam we do not interpolate the points between  @xmath199 and  @xmath200 . due to this double cover region , we can interpolate between box and shell in parallel fashion .",
    "but before that we have to synchronize the data between different shell patches . in the mpi communication , we divide the data in both radial direction and angular directions but try to make resulting blocks as cubic as possible for minimization of inter processor data change .",
    "+        [ [ box - shell - comparison . ] ] box - shell comparison .",
    "+ + + + + + + + + + + + + + + + + + + + +    let us briefly discuss code performance and waveform quality by comparing runs which employ spherical patches ( `` shell runs '' hereafter ) in the wave zone to those that do not ( `` box runs '' hereafter ) . for shell runs ,",
    "radial and angular resolution can be adjusted separately , at linear scaling in the number of grid points in radius and quadratic scaling for both angular directions .",
    "nested boxes imply effectively constant angular resolution for increasing radius and decreasing radial resolution . increasing radial resolution leads to a cubic scaling in the number of grid points , because angular resolution increases simultaneously .",
    "this can be partially compensated by choosing larger boxes in the wave zone , which are comparatively cheap in run - time because of berger - oliger time adaptivity , and typical runs are limited by run - time rather than memory .",
    "constant radial resolution is helpful for tracking waves traveling to infinity , on the other hand decreasing radial resolution is a recipe sometimes employed deliberately for filtering features going to and coming from the outer boundary .",
    "an entirely different type of filter is effectively in use when extracting only @xmath130 modes .",
    "features due to rectangular outer boundaries and rectangular refinement boundaries ( cmp .",
    "[ fig : ss : rho_ham ] ) are not visible at @xmath93 , but start to show at @xmath204 .",
    "a spherical outer boundary has the advantage that a unique normal vector to the boundary exists , in fact our early ( and incomplete ) experiments with the new z4c boundary conditions failed for a cubical outer boundary .",
    "however , a spherical boundary can also lead to a focused inward reflection of outgoing waves , while a rectangular boundary scatters spherical waves leading to a diffuse reflection .",
    "for example , the back - reflection feature in fig .",
    "[ fig : sp : wav ] is much smaller for cubical outer boundaries , as are oscillations of a neutron star induced by boundary reflections .",
    "a clean treatment of a spherical boundary is nevertheless preferable since the reflections can be minimized , and even though a constraint violation from a cubical outer boundary may not be as visible , it is still present in the inner domain .",
    "the choice between box or shell runs actually depends on the waveform accuracy goal , and requires a balance between accuracy and computational cost .",
    "we discuss two examples employing the bssnok formulation .",
    "[ [ bam - example . ] ] bam example . + + + + + + + + + + + +    as a first example , we find that bam bbh box runs with  @xmath205 , @xmath206 ,  @xmath207 , @xmath208 , and  @xmath209 , give results comparable to shell runs with  @xmath210 , @xmath211 , @xmath207 , @xmath208 , @xmath212 , @xmath213 , and @xmath214",
    ". both series of simulations have the same resolution in the cartesian boxes and a similar computational cost .",
    "the resolution in the wave zone differs a factor two in the wave zone ( lower in the box runs ) .",
    "the waveform errors and convergence properties are the same in both series .",
    "[ [ amss - ncku - example . ] ] amss - ncku example .",
    "+ + + + + + + + + + + + + + + + + +    as a second example we compare amss - ncku bbh box runs with  @xmath215 ,  @xmath216 ,  @xmath217 , @xmath218 and  @xmath219 . with shell runs when the four coarsest levels are substituted by spherical patches that approximately extend to the same outer radius .",
    "the computational cost of the shell runs is approximately twice the box runs . using this triplet ,",
    "third order self - convergence is achieved in the shell runs at all the extraction radii , while in the box runs self - convergence is lower than three at small radii and progressively degrades when the extraction is performed on coarser levels .",
    "the waveform in box runs is more noisy .",
    "phase and amplitude of the waveform can be extrapolated according to @xmath220 where  @xmath221 is the quantity to extrapolate extracted at radius  @xmath185 , @xmath222 is a retarded time , and @xmath185 the schwarzschild radius , see e.g.  @xcite .",
    "a measure of the extrapolation error is the difference between the extrapolated function and the last radius values .",
    "this error is reported in the upper row of fig .",
    "[ fig : extrapolation_boxshell ] for box runs and the lower row for shell runs , using the radii @xmath223 and different values of  @xmath224 , i.e.  different polynomials . as evident from the figures",
    "the extrapolation for shell runs is more accurate , and results for different @xmath224 are consistent with each other ( no oscillations and overshooting ) .",
    "the `` zig - zag '' behavior in the left panel of the lower row of fig .  [ fig : extrapolation_boxshell ] is due to the limited number of digits used in the output . for these data",
    "the choice  @xmath225 seems to be optimal .",
    "in this appendix we evolve , for code validation , teukolsky s wave solution with the bam code .      the codes used in this work have sources of error of different polynomial order in the grid spacing , but the operations performed most often , finite differencing and time integration , are performed at fourth order .",
    "it is perhaps not surprising that we never find clear fourth order convergence in our evolutions of compact binaries .    for the hydrodynamics simulations this behavior",
    "can be excused because the hrsc scheme we employ is only second order accurate .",
    "but for our vacuum simulations the situation is less clear .",
    "we therefore also studied the evolution of teukolsky s solution  @xcite to the linearized einstein equations .",
    "this solution represents a weak gravitational wave propagating on a flat background .",
    "it satisfies the constraint equations of general relativity at linear order .",
    "we use this solution as initial data and then evolve forward in time with the bam code .",
    "note that extensive convergence testing demonstrating fourth order convergence , in test cases , was shown for the amss - ncku code in  @xcite .",
    "the metric has the form @xmath226 where we have @xmath227 and also @xmath228 with @xmath229 this corresponds to an outgoing wave that is a pure  @xmath230 mode .",
    "the generating function @xmath231 is given by @xmath232 derivatives of order  @xmath63 of  @xmath231 are denoted by  @xmath233 . apart from choosing a",
    "different generating function our wave is very similar to what was used in  @xcite . for our runs",
    "we have chosen  @xmath234 , @xmath235 and @xmath236 .",
    "we have evolved such a wave with an initial lapse of one and a shift of zero . for the evolution , as in the rest of the work , we have chosen the standard 1+log and gamma driver evolution equation for lapse and shift  ( [ eqn : bmlapse]-[eqn : gamdriver ] ) with @xmath237 .",
    "we use four levels of box mesh refinement , and attach the spherical grids at  @xmath238 . in the lowest resolution",
    "runs each box has  @xmath92 points per direction , and the resolution of level  @xmath204 is  @xmath239 .",
    "we choose  @xmath68 angular and  @xmath240 radial points in each spherical patch so that the outer boundary is located at  @xmath241 .",
    "runs at resolutions  @xmath242 ( with the grid spacing scaled in order to maintain the same grid setup ) are performed .",
    "we find that both the bssnok and the z4c system can successfully be used to evolve these waves .",
    "for z4c we have set @xmath58 and @xmath59 . since there are no strong gravitational fields we can extract the waves at any radius .",
    "figure  [ fig : teukwav1 ] shows a convergence plot for waves extracted at a radius of @xmath243 .",
    "the solid lines shows the difference between @xmath116 at low and medium resolution ( @xmath244 ) , while the dash dotted lines show the difference between medium and high resolution ( @xmath245 ) .",
    "when scaled with the proper factor of 3.66 for fourth order convergence , we see that @xmath245 coincides approximately with @xmath244 . for this data set",
    "the observed order of convergence is around  @xmath246 .",
    "the left panel shows the results for bssnok , the right panel shows those for z4c ."
  ],
  "abstract_text": [
    "<S> numerical relativity simulations of compact binaries with the z4c and bssnok formulations are compared . </S>",
    "<S> the z4c formulation is advantageous in every case considered . in simulations of non - vacuum spacetimes the constraint violations due to truncation errors are between one and three orders of magnitude lower in the z4c evolutions . </S>",
    "<S> improvements are also found in the accuracy of the computed gravitational radiation . for equal - mass irrotational binary neutron star evolutions </S>",
    "<S> we find that the absolute errors in phase and amplitude of the waveforms can be up to a factor of four smaller . </S>",
    "<S> the quality of the z4c numerical data is also demonstrated by a remarkably accurate computation of the adm mass from surface integrals . for equal - mass non - spinning binary puncture black hole evolutions we find that the absolute errors in phase and amplitude of the waveforms can be up to a factor of two smaller . in the same evolutions we find that away from the punctures the hamiltonian constraint violation is reduced by between one and two orders of magnitude . </S>",
    "<S> furthermore , the utility of gravitational radiation controlling , constraint preserving boundary conditions for the z4c formulation is demonstrated . </S>",
    "<S> the evolution of spacetimes containing a single compact object confirm earlier results in spherical symmetry . </S>",
    "<S> the boundary conditions avoid spurious and non - convergent effects present in high resolution runs with either formulation with a more naive boundary treatment . </S>",
    "<S> we conclude that z4c is preferable to bssnok for the numerical solution of the 3 + 1 einstein equations with the puncture gauge . </S>"
  ]
}