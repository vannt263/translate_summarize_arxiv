{
  "article_text": [
    "chemical potential is an important thermodynamic quantity that regulates many phenomena , such as phase transitions , reaction equilibria and electro - chemistry @xcite .",
    "the ability to calculate it via a reliable and fast technique is therefore of great value .",
    "several numerical methods have been proposed , ranging from widom test - particle insertion @xcite to grand - canonical monte - carlo approaches @xcite .",
    "extensive reviews on the efficiency and reliability of these and other techniques can be found in the literature @xcite . however , despite these efforts , chemical potential calculations still remain a difficult challenge for many real systems , such as dense fluids and solids .    at constant volume and temperature",
    "the chemical potential is equal to the helmoltz free - energy difference associated to the addition of an extra molecule .",
    "the most common approach to calculate this quantity , namely the widom insertion method , consists in sampling the insertion energy of a test - particle . in this method",
    "the largest contribution comes from those configurations in which the insertion of an extra molecule is energetically favorable .",
    "this occurs if a cavity sufficiently large to accommodate the extra particle is present . in a low density system",
    "many such cavities are present , and widom method is efficient . on the contrary , in dense systems",
    "the formation of a particle - sized cavity is unlikely , and the calculation becomes inefficient .",
    "thus elaborate methods , based on voronoi tessellation , have been suggested as a way to look for the appropriate cavities in a dense system @xcite .",
    "further suggestions have been among others the introduction of energy - biased sampling of the insertion space @xcite , the use of external potentials to generate controlled inhomogeneities within the system @xcite or the application of an adaptive resolution simulation scheme @xcite .    in the present paper",
    "we shall focus on the calculation of the chemical potential for an homogeneous liquid , and extend the range of densities at which the particle insertion method can be applied by using well - tempered ( wt ) metadynamics @xcite . here",
    "the role of metadynamics is to enhance fluctuations in a controlled manner , promoting those rare configurations in which particle insertion is favored .",
    "this leads to an efficient and reliable calculation method , even in those cases in which widom s method fails .",
    "the paper is organized as follows : in sec .",
    "[ meta ] metadynamics main features are recalled , while its application to chemical potential calculation is described in sec .",
    "the implementation of our technique for the selected test case , namely the binary lennard - jones ( lj ) fluid , is addressed in sec .",
    "[ impl ] , while the results of our calculations are reported in sec .",
    "[ results ] .",
    "finally the conclusions and perspectives of present work are reported in sec .",
    "[ conclusions ] .",
    "before discussing the chemical potential calculation , we recall some of the features of wt metadynamics . for a more detailed description",
    "we refer to the by now vast literature on the subject ( see e.g.  ) .",
    "metadynamics introduces a bias potential to enhance the sampling of rare but important fluctuations .",
    "this bias potential is taken to be a function of the so called collective variables ( cv ) , a set of order parameters that depend on the atomic coordinates @xmath0 .",
    "the cvs are built to describe the degrees of freedom of the system whose sampling we want to enhance .",
    "let us restrict for simplicity to the case of a single collective variable @xmath1 .",
    "the equilibrium distribution of @xmath2 is given by : @xmath3p(\\mathbf{r}),\\ ] ] where @xmath4 is the boltzmann distribution defined by potential energy function @xmath5 .",
    "@xmath6 is the inverse temperature and @xmath7 is the partition function of the system . introducing the free - energy surface @xmath8 , where @xmath9 is a constant that plays an inessential role , eq .",
    "( [ pofs ] ) can be rewritten as @xmath10 if a bias potential @xmath11 is introduced , a different distribution @xmath12 is sampled : @xmath13p_{v}(\\mathbf{r } ) = \\frac{\\mathrm{e}^{-\\beta [ f(s)+v(s)]}}{\\int\\mathrm{d}s'\\mathrm{e}^{-\\beta [ f(s')+v(s')]}},\\ ] ] where @xmath14}/z_{v}$ ] is the boltzmann distribution of the biased ensemble .",
    "@xmath15}$ ] is the corresponding partition function .    in wt metadynamics the bias",
    "is periodically updated by adding a small repulsive potential , that usually takes the form of a gaussian of height @xmath16 and width @xmath17 : @xmath18 @xmath19 is centered on @xmath20 , that is the value of the cv at the moment of the update . during the simulation the height of the deposited gaussians",
    "is modified in a way that can be described by the following iterative equation : @xmath21,\\ ] ] where @xmath22 indicates the iteration and @xmath23 is the so called biasing factor , a key parameter in wt metadynamics .",
    "after the @xmath22-th iteration the system evolves under the combined action of @xmath5 and of @xmath24 .",
    "it has been shown rigorously @xcite that the bias constructed as in eq .",
    "( [ vn ] ) converges asymptotically to : @xmath25 as a consequence , the biased distribution @xmath12 is related to the unbiased one by the relation : @xmath26^{1/\\gamma}}{\\int\\mathrm{d}s'\\left[p(s')\\right]^{1/\\gamma } } .\\ ] ] this result is central to the present paper .",
    "in fact eq .  ( [ reweight ] ) shows that narrow peaks in @xmath27 can be made broader in @xmath12 by increasing @xmath28 . thus rare but important fluctuations , that are hidden in the tails of @xmath27 are more likely to occur in the biased ensemble .",
    "furthermore , the theory of metadynamics allows to calculate the unbiased ensemble average @xmath29 of any position dependent variable @xmath30 via the reweighting @xcite procedure described by : @xmath31}\\rangle_v,\\ ] ] where the suffix @xmath32 indicates that the average is performed under the action of the time varying metadynamics bias potential @xmath33 .",
    "the position independent constant @xmath34 is given by @xcite : @xmath35}{\\int \\mathrm{d}s\\,\\exp\\left[\\frac{1}{\\gamma-1}\\beta v(s , t)\\right]}.\\ ] ]",
    "we now define the proper cv that will be used to calculate the chemical potential via metadynamics .",
    "let us begin by considering a system of @xmath36 particles with coordinate vector @xmath37 .",
    "as pointed out by widom @xcite , the excess chemical potential , that is the chemical potential from which the free particle contribution has been subtracted , can be written as : @xmath38\\mathrm{d}\\mathbf{r}^{*}\\right\\rangle,\\ ] ] where @xmath39 is the system volume and @xmath40 where @xmath41 is the potential energy of the system with an extra particle in @xmath42 .",
    "the average @xmath29 in eq .  ( [ widom ] )",
    "is performed over the boltzmann distribution defined by the @xmath36 particle interaction potential @xmath5 .",
    "widom suggested to estimate @xmath43 by evolving the system and periodically computing @xmath44 at a randomly generated set of positions @xmath42 .",
    "also in other methods , first the coordinate vector @xmath0 is sampled and later insertions are attempted @xcite .",
    "here we take an alternative route and first we fix a number of insertion points @xmath45 and later we let @xmath0 adjust around them so that the sampling of @xmath46 is enhanced . in order to see how this",
    "is done we restrict to the case of an homogeneous fluid , in which the average @xmath47\\rangle$ ] is @xmath42 independent .",
    "it follows that one can choose a set of @xmath48 @xmath49 s and rewrite the chemical potential as : @xmath50\\right\\rangle.\\ ] ] this form of @xmath43 suggests the introduction of the following cv : @xmath51\\right).\\ ] ] in principle even the choice @xmath52 , namely that of using a single insertion point @xmath53 , leads to the correct result , however it requires much longer sampling times . in this paper",
    "the insertion points @xmath54 will be arranged on a regular grid , but other choices are possible .",
    "a consequence of this cv definition is that the chemical potential can be rewritten as the expectation value of a function of @xmath2 : @xmath55 or , in terms of the free energy associated to @xmath2 , as : @xmath56}\\mathrm{d}s}{\\int\\mathrm{e}^{-\\beta f(s)}\\mathrm{d}s}.\\ ] ] from eqs .",
    "( [ muofs ] ) or ( [ muofs2 ] ) it follows that the largest contribution to @xmath43 comes from those configurations for which @xmath2 has a negative value .",
    "this choice of cv has a practical drawback .",
    "in fact in most models the atoms interact at short distances via a highly repulsive and rapidly varying potential .",
    "thus , if any of the insertion points @xmath45 comes close to the atomic positions , @xmath1 varies very rapidly and can even diverge .",
    "this can be remedied by modifying the insertion potential at short distances using a regularized potential @xmath57 in the definition of a new and more smoothly behaved cv : @xmath58\\right).\\ ] ] the idea is that @xmath59 should be large but finite when @xmath42 is close to one of the atomic positions , so that the derivatives @xmath60 are of manageable size .",
    "one can then use @xmath61 to bias the metadynamics simulation and calculate @xmath62 using the reweighting procedure in eq .",
    "( [ reweight2 ] ) @xcite .",
    "however , in the test case that will be discussed below , we define @xmath57 so that the change of cv has no practical effect on the calculation of @xmath43 , and the reweighting is not necessary ( see also the supporting information ( si ) ) .",
    "in order to test the method we shall consider a binary lennard - jones ( lj ) fluid . in particular we consider the system studied by kob and andersen @xcite for its glass forming properties , that it is known to remain fluid at low temperature and high density . thus it provides a challenging test for our method .",
    "the system is composed by two atomic species , @xmath63 and @xmath64 , of equal atomic mass .",
    "the interaction potential is : @xmath65,\\ ] ] where @xmath66 is the atom - atom distance and @xmath67 . in such",
    "a system one defines an excess chemical potential @xmath68 for each species , and generalizes eq .",
    "( [ widom2 ] ) : @xmath69\\right\\rangle,\\ \\alpha={a , b}.\\ ] ] where @xmath70 where @xmath71 and @xmath72 are the coordinates of the @xmath73 atoms and @xmath0 indicates the ensemble of the two combined sets of coordinates .",
    "@xmath74 is the number of @xmath75 specie particles .",
    "each species will have its own @xmath2 , therefore eq .  ( [ sform ] )",
    "generalizes to : @xmath76\\right),\\ \\alpha={a , b}.\\ ] ] analogously , eq .",
    "( [ muofs ] ) becomes : @xmath77 and eq .",
    "( [ muofs2 ] ) becomes : @xmath78}\\mathrm{d}s_{\\alpha}}{\\int\\mathrm{e}^{-\\beta f(s_{\\alpha})}\\mathrm{d}s_{\\alpha}},\\ \\alpha={a , b}.\\ ] ] as mentioned before , in order to avoid divergences and the appearance of a large bias , we shall use the regularized version @xmath79 of the cv , defining the following modified potential : @xmath80 where @xmath81 is the distance below which @xmath82 and @xmath83 differ .",
    "+    kob and andersen model @xcite is a mixture of @xmath84 @xmath63 particles and @xmath85 @xmath64 particles . in units of @xmath86 and @xmath87",
    "the other potential parameters are @xmath88 , @xmath89 , @xmath90 and @xmath91 . in our simulations the potentials",
    "@xmath83 are cut and shifted at @xmath92 , while the distance parameter of the regularized potential @xmath82 is set at @xmath93 .",
    "the simulated system is composed of @xmath94 atoms in a cubic box of length @xmath95 and periodic boundary conditions ( pbc ) are applied .",
    "the temperature is kept at @xmath96 by using the stochastic velocity rescaling thermostat @xcite . at these thermodynamic conditions the system is in the liquid phase .",
    "the md simulations were carried out using the gromacs @xcite software , equipped with a private version of the plumed2 plug - in @xcite .",
    "the integration time - step was chosen to be @xmath97 ( which corresponds to @xmath98 for the lj parameters of argon : @xmath99 , @xmath100 and @xmath101  ) .",
    "the widom s calculations were performed using the appropriate gromacs subroutines .",
    "one advantage of using this particular binary system is that the majority of atoms ( @xmath63 ) have a larger radius , leaving sufficient interstices to place the smaller @xmath64 atoms .",
    "this makes the calculation of @xmath102 relatively easy and accessible to widom s method , providing a testing ground for our technique . on the other hand",
    "the calculation of @xmath103 is challenging and its successful completion demonstrates the usefulness of our approach .",
    "we performed two separate calculations , for @xmath104 and @xmath105 .",
    "the gaussian initial height was chosen to be of @xmath106 and the width is equal to @xmath107 .",
    "new gaussians were deposited every @xmath108 and the @xmath28 parameter was @xmath109 .",
    "we experimented with different values of number of insertion points @xmath48 ( see eq .",
    "( [ sbin ] ) ) .",
    "they all lead to the same results within statistical error . however , the speed of convergence of @xmath43 was different , with the limiting @xmath52 case being particularly slow ( see the si ) . here",
    "we present the results for a regular mesh of @xmath110 points .",
    "while @xmath48 was not carefully optimized , this choice seemed to yield a good compromise between speed of convergence and computational cost .",
    "we note that the calculations can be easily parallelized and it pays to distribute wisely the load among the concurrent processors , thus the determination of the optimal @xmath48 depends also on the computational platform .",
    "as discussed earlier we expect the chemical potential calculation to be easier for the smaller atoms ( @xmath64 ) and more challenging for the large component ( @xmath63 ) .",
    "this is brought out in fig .",
    "[ fsab ] , where the @xmath111 resulting from metadynamics simulations is compared to the @xmath111 calculated in an unbiased md run . in the @xmath64 case ( fig .",
    "[ fsab]a ) , even without applying the bias potential , the range of spontaneously occurring fluctuations , indicated in figure by the domain of the unbiased @xmath111 , is large enough to overlap with the negative @xmath112 region .",
    "this region yields the more substantial contribution to the numerator of eq .",
    "( [ muofsbin ] ) , and thus to the @xmath105 value ( see si for further details ) . thus @xmath105 can be reliably computed with unbiased sampling .",
    "note however that even in this favorable case the spontaneous fluctuations do not cover entirely the tail of the distribution . as noted in ref .",
    "@xcite this leads to a systematic error .",
    "in contrast , no such problem is present in the metadynamics calculation , where the fluctuations of @xmath112 cover thoroughly all the important region .    in the case of the larger atoms ( fig .  [",
    "fsab]b ) the situation is much more dramatic and the unbiased results show little or no overlap between the fluctuations of @xmath113 and the region that contributes the most to @xmath104 .",
    "in contrast , our metadynamics calculations explore in detail the important region of @xmath114 .",
    "this is reflected by the convergence of @xmath104 and @xmath105 calculations , shown in fig .",
    "[ muab ] , where we compare metadynamics results ( obtained with eq .",
    "( [ reweight2 ] ) ) to standard widom calculations . in the @xmath64 case ( fig .  [ muab]a ) the agreement between metadynamics and standard widom method is within the statistical error . in the @xmath63 case however ( fig .",
    "[ muab]b ) widom s method faces severe difficulties and convergence is jumpy and very slow , even with a very large number of insertion points sampled . on the contrary",
    "our method converges to an accuracy of @xmath115 using only @xmath110 insertion points .",
    "this underlines the necessity of metadynamics to visit the extreme tails of the @xmath2 distribution and calculate @xmath43 accurately .",
    "in conclusion we have shown that this new approach can be very competitive with previous ones .",
    "three features should be noted : the use of the homogeneity of the system , the change of paradigm from an atom position - centric to an insertion - centric point of view and the use of metadynamics to enhance fluctuations .",
    "the calculation is no more difficult than a standard wt metadynamics one , and can be performed using any of the codes with which the plumed2 plug - in can be integrated .",
    "the recently developed variationally enhanced sampling @xcite , in its wt version @xcite , could be also profitably applied to perform these calculations and lead to further improvement in the efficiency of chemical potential evaluations .",
    "although here our method has been developed for homogeneous systems , its extension to non - homogeneous situations is possible and it is currently under study . a relatively straightforward application of this method is the calculation of the solvation energy of molecules in liquids , another quantity of great practical interest . moreover ,",
    "if properly adapted , these ideas could be extended to free energy perturbation calculations @xcite .",
    "the authors are pleased to acknowledge m.  nava , b.  smit and o.  valsson for the useful discussions .",
    "the computational resources were provided by the swiss center for scientific computing , and the brutus cluster at eth zurich .",
    "the authors acknowledge also the varmet european union grant erc-2014-adg-670227 and the national centres of competence in research `` materials revolution : computational design and discovery of novel materials '' project for funding ."
  ],
  "abstract_text": [
    "<S> the calculation of chemical potential has traditionally been a challenge in atomistic simulations . </S>",
    "<S> one of the most used approaches is widom s insertion method in which the chemical potential is calculated by periodically attempting to insert an extra particle in the system . in dense systems </S>",
    "<S> this method fails since the insertion probability is very low . in this paper </S>",
    "<S> we show that in a homogeneous fluid the insertion probability can be increased using metadynamics . </S>",
    "<S> we test our method on a supercooled high density binary lennard - jones fluid . </S>",
    "<S> we find that we can obtain efficiently converged results even when widom s method fails . </S>",
    "<S> +    _ eur .  </S>",
    "<S> phys .  j.  spec .  </S>",
    "<S> top .  </S>",
    "<S> doi : 10.1140/epjst / e2016 - 60094-x _ </S>"
  ]
}