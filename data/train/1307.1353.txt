{
  "article_text": [
    "_ conjunctive queries _ are basic and heavily studied database queries , and can be viewed logically as formulas consisting of a sequence of existentially quantified variables , followed by a conjunction of atomic formulas . since the 1977 article of chandra and merlin  @xcite ,",
    "complexity - theoretic aspects of conjunctive queries have been a research subject of persistent and enduring interest which continues to the present day ( as discussed and evidenced , for example , by the works  @xcite ) . in this article , we study _ conjunctive query evaluation _ , which is the problem of evaluating a conjunctive query on a relational structure .",
    "conjunctive query evaluation is indeed equivalent to a number of well - known problems , including the homomorphism problem on relational structures , the constraint satisfaction problem , and conjunctive query containment  @xcite .",
    "that this problem appears in many equivalent guises attests to its fundamental , primal nature , and this problem has correspondingly been approached and studied from a wide variety of perspectives and motivations .    as has been eloquently articulated in the literature",
    ", the employment of classical complexity notions such as polynomial - time tractability to grade the complexity of conjunctive query evaluation is not totally satisfactory : a typical scenario  for example , in the database context  is the evaluation of a relatively short query on a relatively large structure .",
    "this asymmetry between the two parts of the input suggests that one might employ a notion of complexity wherein one relaxes the dependence on the query .",
    "for example , in measuring time complexity , one might allow a non - polynomial dependence on the query while enforcing a polynomial dependence on the structure .",
    "_ parameterized complexity theory _",
    "@xcite is a comprehensive framework for studying problems where each instance has an associated parameter , and arbitrary dependence in the parameter is permitted ; in the query evaluation setting , the query ( or the query length ) is naturally and typically taken to be the parameter .",
    "we use and focus on this viewpoint in the present article , and hence in this discussion .",
    "conjunctive query evaluation is known to be computationally intractable in general , and consequently a recurring theme in the study of this problem is the identification of structural properties of conjunctive queries that provide tractability or other computationally desirable behaviors . a convenient framework in which to seek such properties is the family of parameterized homomorphism problems @xmath1 , for classes of relational structures @xmath0",
    ": the problem @xmath1 is to decide , given a relational structure @xmath2 from @xmath0 and another relational structure @xmath3 , whether there is a homomorphism from @xmath2 to @xmath3 ; the parameter here is the first structure @xmath2 . studying this problem family amounts to studying conjunctive query evaluation on various sets of conjunctive queries , as it is a classical fact that each boolean conjunctive query @xmath4 can be bijectively represented as a structure @xmath2 in such a way that , for any structure @xmath3 , it holds that @xmath4 is true on @xmath3 if and only if @xmath2 admits a homomorphism to @xmath3  @xcite .",
    "our primary interest is in understanding the interplay between structural properties on the classes @xmath0 and the complexity behavior of @xmath1 .",
    "( we will focus on the case where @xmath0 has bounded arity , and assume this property throughout this discussion . )",
    "* known classifications . * an exact description of the tractable problems of the form @xmath1 was presented by grohe  @xcite .",
    "in particular , a known sufficient condition for fixed - parameter tractability of @xmath1 was that the _ cores _ of @xmath0 have _ bounded treewidth _  @xcite ; grohe completed the picture by showing that for any class @xmath0 not satisfying this condition , the problem @xmath1 is w[1]-complete .",
    "fixed - parameter tractability is a parameterized relaxation of polynomial - time tractability , and w[1]-hardness plays , in parameterized complexity , a role similar to that played by np - hardness in classical complexity .",
    "intuitively , the _ core _ of a structure is an equivalent structure of minimal size ; _ bounded treewidth _ is a graph - theoretical property that one might conceive of as tree - likeness .",
    "later , a classification of the tractable @xmath1 problems was presented  @xcite .",
    "this classification is exhaustive up to parameterized logarithmic space reductions ; parameterized logarithmic space ( _ para - l _ ) relaxes logarithmic space in a way analogous to that in which fixed - parameter tractability relaxes polynomial time .",
    "let @xmath5 denote the class of all trees , let @xmath6 denote the class of all paths , and for a class of structures @xmath0 , let @xmath7 be the class of structures obtainable by taking a structure @xmath2 in @xmath0 and adding each element of @xmath2 as a relation .",
    "the classification states that each tractable @xmath1 problem is para - l equivalent to @xmath8 , para - l equivalent to @xmath9 , or decidable in para - l .",
    "the properties determining which of the three behaviors occurs are _ bounded pathwidth _ and _ bounded tree depth _ , established graph - theoretical properties . in that work  @xcite , it is also shown how the problems @xmath8 and @xmath9 can be characterized as complete problems for machine - defined complexity classes .      in this article , we present a significantly refined complexity classification of the homomorphism problems @xmath1 which is exhaustive up to an extremely simple and computationally weak notion of reduction based on quantifier - free interpretations from first - order logic .",
    "our classification generalizes the just - described known classifications , and indeed provides a uniform , modular , and self - contained treatment thereof .",
    "we now give an overview of the contributions and obtained results ; we refer the reader to the technical sections for precise statements and more information .    * a graph - theoretic hierarchy . * to derive our classification , we first focus on graphs . previous work  @xcite related the complexity of conjunctive queries to the named graph - theoretic properties by showing that certain relationships on graph classes implied reductions for the corresponding homomorphism problems , for example :    * if @xmath10 is a graph class and @xmath11 is the class of minors of graphs in @xmath10 , then @xmath12 reduces to @xmath13 .",
    "* if the members of a graph class @xmath10 have bounded width tree decompositions whose trees lie in a graph class @xmath14 , then @xmath13 reduces to @xmath15 .    we give a unified explanation for these reductions by defining a relation @xmath16 on graph classes .",
    "this relation has the key property that    @xmath17 implies that @xmath13 reduces to @xmath15 ,    and this key property is shown to imply the two just - named results .",
    "the definition of the relation @xmath16 is simple and is based on a notion which we call _ graph deconstruction _ and which is strongly related to and inspired by the notion of tree decomposition .",
    "when @xmath18 and @xmath19 are graphs , we define an @xmath19-deconstruction of @xmath18 to be a family @xmath20 of subsets of the vertex set of @xmath18 which is indexed by the vertex set @xmath21 of @xmath19 and which satisfies properties similar to those in the definition of tree decomposition ( definition  [ def : deconstruction ] ) ; note that here , the graph @xmath19 is not restricted to be a tree , as it is in the definition of tree decomposition .",
    "each such deconstruction @xmath20 has associated with it a measure called its _ width _ which is based on the sizes of the subsets @xmath22 . for graph classes @xmath10 and",
    "@xmath14 , we define @xmath17 if and only if there is a constant @xmath23 where for each graph @xmath18 in @xmath10 , there is a graph @xmath19 in @xmath14 such that @xmath18 has a @xmath19-deconstruction of width at most @xmath23 . for a computer scientist",
    ", this relation @xmath16 can be intuitively thought of as a notion of reduction between graph classes , and indeed some of its properties are akin to those of complexity - theoretic reductions ; for example , any graph set is equivalent to a finite variation thereof . is a _ finite variation _ of a set @xmath10 if the symmetric difference of @xmath10 and @xmath14 is finite .",
    "] however , since the definition of the @xmath16 relation is purely graph - theoretic , we are able to unconditionally derive a complete hierarchy of graph classes with respect to this relation .",
    "define @xmath24 to be the class of trees of height at most  @xmath25 ; @xmath26 to be the class of forests of height at most @xmath25 ; and @xmath27 to be the class of all graphs .",
    "we present the following hierarchy of graph classes ( theorem  [ thm : graph - hierarchy ] ) : @xmath28 we prove that this hierarchy is strict and _ comprehensive _ in that every single graph class is equivalent to one of the sets in the hierarchy . to understand the upper levels of the hierarchy ,",
    "we make use of known _ excluded minor theorems_. note indeed that these upper levels are highly related to established , already - mentioned conditions : as examples , a graph class @xmath10 has bounded treewidth if and only if @xmath29 , and bounded pathwidth if and only if @xmath30 ( proposition  [ prop : bounded - characterizations ] ) . to determine the lower part of the hierarchy ( below @xmath6 ) , we introduce a new complexity measure on graph classes which we call _ stack depth_.    * a complexity - theoretic hierarchy . *",
    "having understood the introduced relation @xmath16 on graph classes , we then turn to study homomorphism problems . as mentioned , we prove that @xmath17 implies @xmath13 reduces to @xmath15 ( theorem  [ theo : dechom ] ) ; this property was indeed a primary motivation for the definition of @xmath16 .",
    "we prove this with respect to a computationally weak notion of reduction that we call _ quantifier - free after a precomputation ( qfap)_. this notion of reduction naturally unifies and incorporates two modes of computation that have long been studied . for each parameter",
    ", this reduction provides a quantifier - free , first - order _ interpretation _ that defines the output instance in the input instance ; interpretations as reductions have a tradition in descriptive complexity  @xcite , and dawar and he studied a type of quantifier - free interpretation in the parameterized setting  @xcite .",
    "in addition , our reduction allows for _ precomputation _ on the parameter of an input instance .",
    "this follows an established schema in the definition of parameterized modes of computation : for example , fixed - parameter tractability can be defined as polynomial time after a precomputation , and para - l can be defined as logarithmic space after a precomputation  @xcite .",
    "note that it is readily verified that our reduction is finer than para - l reduction ( lemma  [ lem : plred ] ) .    since by the comprehensiveness of our graph hierarchy every graph class @xmath10 is equivalent ( under @xmath16 ) to a class @xmath14 from the hierarchy , we obtain the following :    for every graph class @xmath10 , the problem @xmath13 is equivalent under qfap - reduction to a problem @xmath15 , + where @xmath14 is a graph class in the above graph hierarchy .",
    "let @xmath0 denote an arbitrary class of bounded - arity structures .",
    "we proceed to show that _ every _ problem of the form @xmath1 is equivalent under qfap - reduction to a problem @xmath13 , where @xmath10 is a set of graphs ( precisely , the graphs of the cores of the structures in @xmath0 ) .",
    "this implies the following strengthening of the just - given statement on graph classes ( theorem  [ theo : coregraphhom ] ) :    each problem of the form @xmath1 is equivalent under qfap - reduction to a problem @xmath15 , + where @xmath14 is a graph class from the graph hierarchy .",
    "this interestingly implies that , with respect to qfap - reduction , the complexity degrees attained by problems @xmath1 are linearly ordered according to the classes in our graph hierarchy , in particular , linearly ordered in a sequence of order type  @xmath31 .    in brief",
    ", our approach for understanding the problems @xmath1 is to present a graph hierarchy and then show that this hierarchy induces a complexity hierarchy for these problems .",
    "we wish to emphasize the unifying nature , the modularity , and the conceptual claenliness of this approach .",
    "our definition and presentation of the graph hierarchy cleanly and neatly encapsulates the graph - theoretic content needed to present the complexity hierarchy .",
    "we obtain a uniform and self - contained derivation of the mentioned known classifications  @xcite , which derivation we find to be clearer and simpler than those of the original works .",
    "our treatment also strengthens the known classifications , since the problems classified as being computationally equivalent are here shown to be so under qfap - reductions ; in particular , it follows from our treatment that all of the w[1]-complete problems from grohe s theorem  @xcite are pairwise equivalent under qfap - reductions and hence in a very strong sense .",
    "* consistency , pebble games , and logarithmic space . * the study of so - called consistency algorithms has a long tradition in the study of constraint satisfaction and homomorphism problems .",
    "such algorithms are typically efficient and simple heuristics that can detect inconsistency ( that is , that an instance is a _ no _ instance ) and are based on local reasoning .",
    "identifying cases of these problems where such algorithms provide a sound and complete decision procedure has been a central theme in the tractability theory of these problems ( see for example  @xcite )",
    ".    seminal work of koalitits and vardi  @xcite showed that certain natural consistency algorithms could be viewed as determining the winner in certain ehrenfeucht - frass type pebble games  @xcite .",
    "since this work , there has been sustained effort devoted to presenting pebble games that solve cases @xmath1 of the homomorphism problem . in general , this is determined by the class @xmath10 of graphs of cores of structures from @xmath0 .",
    "for example , there is study of pebble games that solve @xmath1 when @xmath10 has bounded treewidth ( that is , when @xmath29 ) @xcite , and also when @xmath10 has bounded pathwidth ( that is , when @xmath32 ) @xcite .",
    "we complete the picture by presenting natural pebble games that are shown to solve @xmath1 when @xmath10 has bounded tree depth ( section  [ sect : pebble - games ] ) .",
    "our pebble games are finite - round games that can be thought of as homomorphism variants of the classical ehrenfeucht - frass game .",
    "we develop the theory of our games , showing for example that it is decidable , given a structure @xmath2 , whether or not a particular game solves the homomorphism problem on @xmath2 ( theorem  [ thm : char - v - game - solves ] ) .",
    "we also show strong correspondences between the number of pebbles needed to solve @xmath1 and the tree depth of @xmath10 ; and , between the number of rounds needed to solve @xmath1 and the stack depth of @xmath10 ( section  [ subsect : game - resources ] ) .    as a fruit of our development of pebble games ,",
    "we obtain a characterization of the classical homomorphism problems @xmath33 decidable in classical logarithmic space : these are precisely those where the cores of structures from @xmath0 have bounded tree depth . this result is conditional on a certain hypothesis from parameterized complexity theory",
    ".    * outlook . * motivated by the desire to understand the complexity of homomorphism problems , we defined a relation on graph classes and then analyzed the resulting hierarchy .",
    "we then showed that the resulting graph hierarchy can be used to derive a complexity hierarchy on the problems @xmath1 which generalizes existing classification results .",
    "this uniform derivation is a testament to the relevance of the graph hierarchy , and we view the simple definition of the relation @xmath16 , as well as the development of its basic theory , as conceptual contributions . the graph hierarchy presented here is strongly reminiscent of a hierarchy given by blumensath and courcelle  @xcite , and this situation naturally suggests the possibility of establishing connections between this work and theirs .",
    "our results show that the given hierarchies along with the notion of qfap - reduction provide a clean and comprehensive understanding of the complexity degrees of parameterized homomorphism problems .",
    "we expect that the given hierarchies can be meaningfully used to obtain a fine - grained understanding of the complexity of other problems of independent interest . as an indication favoring this perspective",
    ", we show , in the final section of the article , that the hierarchy can be used to classify the complexity of model - checking existential sentences having bounded quantifier rank .",
    "for @xmath34 we let @xmath35 $ ] denote @xmath36 and understand @xmath37=\\emptyset$ ] .      a _ vocabulary _ is a finite set of relation symbols , where each symbol @xmath38 has an associated arity @xmath39 .",
    "structure with vocabulary @xmath40 _ , for short , a _ @xmath40-structure _",
    "@xmath3 is given by a non - empty set @xmath41 called its _ universe _ together with an _ interpretation _",
    "@xmath42 of @xmath38 for every @xmath43 .",
    "we only consider finite structures , i.e. structures with finite universe .",
    "when @xmath3 is a @xmath40-structure and @xmath44 a non - empty subset of @xmath41 , we let @xmath45 denote the @xmath40-structure _ induced _ in @xmath2 on @xmath44 : it has universe @xmath44 and interprets every @xmath43 by @xmath46 . the class of all @xmath40-structures is denoted by @xmath47 $ ] , and the class of all structures by @xmath48 .    for a vocabulary @xmath40 ,",
    "a ( first - order ) @xmath40-formula @xmath49 is built from _",
    "atoms _ @xmath50 and @xmath51 where @xmath52 and the @xmath53 are variables and @xmath54 , by means of boolean combinations @xmath55 and existential and universal quantification @xmath56 .",
    "we write @xmath57 for @xmath49 to indicate that the free variables of @xmath49 are among the components of @xmath58 ; for a @xmath40-structure , and @xmath59 we write @xmath60 to indicate that @xmath61 satisfies @xmath57 in @xmath2 , further we write @xmath62 .",
    "formulas without free variables are _ sentences_. the _ quantifier rank _ @xmath63 of a formula @xmath49 is defined as follows : @xmath64 for atoms @xmath49 ; @xmath65 ; @xmath66 ; @xmath67 .    two structures @xmath2 and @xmath3 interpreting the same vocabulary are called _",
    "similar_. in this case , a _ homomorphism _ from @xmath2 to @xmath3 is a function @xmath68 such that for every @xmath43 and every tuple @xmath69 , it holds that @xmath70 .",
    "we write @xmath71 to indicate that such a homomorphism exists .",
    "a _ partial homomorphism _",
    "@xmath72 from @xmath2 to @xmath3 is either @xmath73 or a homomorphism from @xmath74 to @xmath3 ; by @xmath75 we denote the domain of @xmath72 and by @xmath76 its image .",
    "a structure @xmath2 is a _ core _ if all homomorphisms from @xmath2 to itself are injective .",
    "the _ core of a structure _ @xmath2 is a structure @xmath3 such that there is a homomorphism from @xmath2 to @xmath3 , @xmath3 is a core , @xmath77 , and @xmath78 for each symbol @xmath38 .",
    "it is well - known that each finite structure has at least one core , and that all cores of a finite structure are isomorphic ; for this reason , one often speaks of _ the _ core of a finite structure @xmath2 , which we denote here by @xmath79 .",
    "for example , all structures of the form @xmath80 are cores . here , @xmath80 is the expansion obtained from @xmath2 by interpreting for each @xmath81 a new unary relation symbol @xmath82 by @xmath83 . for a class of structures",
    "@xmath0 we let @xmath84      in this article , a _ graph _ is a @xmath85-structure @xmath18 for a binary relation symbol @xmath86 such that @xmath87 is irreflexive and symmetric .",
    "a graph @xmath18 is a _",
    "subgraph _ of another graph @xmath19 if @xmath88 and @xmath89 .",
    "given a graph @xmath18 we write @xmath90 when @xmath2 is a @xmath40-structure , we let @xmath91 be the graph with universe @xmath92 and an edge between @xmath93 if @xmath94 and there are @xmath95 and a tuple @xmath96 such that @xmath97 are components of @xmath61 .",
    "we call @xmath2 _ connected _ if so is the graph @xmath91",
    ". a _ ( connected ) component _ of @xmath2 is a structure induced in @xmath2 on a ( connected ) component of @xmath91 .",
    "a _ path _ is a graph isomorphic to the graph with universe @xmath35 $ ] and edges @xmath98 for some @xmath99 .",
    "a _ grid _ is a graph that is isomorphic to an _",
    "@xmath25-by-@xmath25 grid _ for some @xmath34 ; this is the graph with universe @xmath35 \\times [ n]$ ] and edges @xmath100 \\times [ n])^2 \\mid    acyclic . by a _ rooted tree _",
    ", we mean a tree that interprets a unary relation symbol @xmath101 by a set containing a single element , called the _ root _ of the tree . by a _ rooted forest _ ,",
    "we mean a graph @xmath18 where , for each component @xmath102 , the graph @xmath103 is a rooted tree .",
    "when @xmath104 and @xmath105 are elements of a rooted tree , we say that @xmath104 is an _ ancestor _ of @xmath105 and that @xmath105 is a _ descendent _ of @xmath104 if @xmath104 lies on the unique path from the root to @xmath105 ; if in addition @xmath106 , we say that @xmath104 is a _ proper ancestor _ of @xmath105 and that @xmath105 is a _ proper descendent _ of @xmath104 .",
    "height _ of a rooted tree is the maximum length of a path from the root to some vertex .",
    "the height of a tree @xmath107 is the minimum height of all rootings of @xmath107 .",
    "the height of a forest @xmath108 is the maximum height of a ( connected ) component of @xmath108 .",
    "we use the following notation .",
    "let @xmath109 ;    * @xmath27 denotes the class of all graphs ; * @xmath110 denotes the class of all grids ; * @xmath5 denotes the class of all trees ; * @xmath6 denotes the class of all paths ; * @xmath111 denotes the class of all trees of height at most @xmath105 ; * @xmath112 denotes the class of all forests of height at most @xmath105 .",
    "the _ tree depth _ of a connected graph @xmath18 is the minimum @xmath113 such that there exists a rooted tree @xmath107 with universe @xmath114 of height @xmath115 such that @xmath116 is contained in the closure of @xmath107 .",
    "the _ closure _ of @xmath107 is the set of edges @xmath117 such that either @xmath118 is an ancestor of @xmath119 in @xmath107 or vice versa . for an arbitrary graph ,",
    "its tree depth is defined to be the maximum tree depth taken over all components of @xmath18 .",
    "a _ tree decomposition _ of a graph @xmath18 is a tree @xmath19 along with an @xmath21-indexed family @xmath20 of subsets of @xmath120 satisfying the following conditions :    * for every pair @xmath121 , there exists @xmath122 such that @xmath123 . *",
    "( connectivity ) for each element @xmath124 , the set @xmath125 is connected in @xmath19 .",
    "the _ width _ of a tree decomposition is @xmath126 .",
    "a _ path decomposition _ of a graph is a tree decomposition where the tree @xmath19 is a path .",
    "the _ treewidth _ of a graph @xmath18 is the minimum width over all tree decompositions of @xmath18 ; likewise , the _ pathwidth _ of @xmath18 is the minimum width over all path decompositions of @xmath18 .",
    "a class @xmath10 of graphs has _",
    "bounded treewidth _ if there exists a constant @xmath23 such that each graph @xmath127 has treewidth @xmath128 ; the properties of _ bounded pathwidth _ and _ bounded tree depth _ are defined similarly .",
    "a graph @xmath129 is a _ minor _ of a graph @xmath18 if there exists a _ minor map _ from @xmath129 to @xmath18 , which is a map @xmath130 defined on @xmath131 where    * for each @xmath132 , it holds that @xmath133 is a non - empty , connected subset of @xmath120 ; * the sets @xmath133 are pairwise disjoint ; and , * for each @xmath134 there exist @xmath135 and @xmath136 such that @xmath137 .",
    "when @xmath18 is a graph , we use @xmath138 to denote the class of all minors of @xmath18 , and we extend this notation to a class @xmath10 setting @xmath139 .",
    "the following theorem is known ; the first two parts are due to robertson and seymour s graph minor series ( see  @xcite ) and the third is due to blumensath and courcelle  @xcite .    [",
    "thm : excluded ] let @xmath10 be a set of graphs .    1 .   ( excluded grid theorem ) @xmath10 has bounded treewidth if and only if there exists a grid that is not contained in @xmath140 .",
    "( excluded tree theorem ) @xmath10 has bounded pathwidth if and only if there exists a tree that is not contained in @xmath140 .",
    "( excluded path theorem ) @xmath10 has bounded tree depth if and only if there exists a path that is not contained in @xmath140 .",
    "we will make use of the following known , readily verified fact .",
    "[ prop : depth - gives - decomposition ] let @xmath18 be a connected graph , and suppose that @xmath107 is a rooted tree with height @xmath72 witnessing that @xmath18 has tree depth @xmath115 , i.e. @xmath107 it has height @xmath115 and its closure contains @xmath87 . then the tree @xmath141 together with @xmath142 is a tree decomposition of @xmath18 of width @xmath72 where @xmath143 .    to prove proposition  [ prop : depth - gives - decomposition ] , the key observation is the following .",
    "for any two vertices @xmath144 connected by an edge in @xmath18 , one is an ancestor of the other in @xmath107 , and if , say , @xmath119 is an ancestor of @xmath118 , then @xmath145 .",
    "[ def : deconstruction ] when @xmath18 and @xmath19 are graphs , an _ @xmath19-deconstruction of @xmath18 _ is an @xmath21-indexed family @xmath20 of subsets of @xmath120 that satisfies the following two conditions :    * ( coverage ) for each pair @xmath121 , there exists a pair @xmath146 such that @xmath147 . * ( connectivity ) for each element @xmath124 , the set @xmath125 is connected in @xmath19 .",
    "the _ width _ of a @xmath19-deconstruction @xmath20 is defined as @xmath148 .",
    "we will refer to the subsets @xmath22 as _",
    "bags_.    note that the definition of an @xmath19-deconstruction is similar to that of a tree decomposition , but one important difference is that , in the definition of @xmath19-deconstruction , it is not required that an edge @xmath137 lie inside a single bag @xmath22 , but rather , may lie inside the union @xmath149 of two bags where @xmath150 .",
    "[ ex : grid ] let @xmath151 .",
    "when @xmath19 is the @xmath25-by-@xmath25 grid ( defined in section  [ subsect : graphs ] ) , any graph @xmath18 on @xmath25 vertices has an @xmath19-deconstruction of width @xmath152 .",
    "assume without loss of generality that @xmath153 $ ] .",
    "the desired deconstruction is @xmath154 defined by @xmath155 .",
    "coverage holds , since each pair @xmath156 ^ 2 $ ] has @xmath157 .",
    "connectivity holds , since for each @xmath158 $ ] , the set @xmath159 forms a cross in the grid .",
    "[ ex : self - deconstruction ] for any graph @xmath18 , the family @xmath160 defined by @xmath161 is a @xmath18-deconstruction of @xmath18 having width at most  @xmath162 .",
    "[ prop : inheriting - connectivity ] let @xmath163 be graphs , @xmath164 connected in @xmath18 and @xmath165 an @xmath19-deconstruction of @xmath18 . then @xmath166 is connected in @xmath19 .",
    "suppose that @xmath137 , and define @xmath167 and @xmath168 .",
    "it suffices to show that @xmath169 is connected in @xmath19 . by coverage , there exists @xmath146 such that @xmath147 .",
    "if there exists such a pair @xmath170 with @xmath171 , then the sets @xmath172 and @xmath173 share the vertex @xmath72 in common ; otherwise , there is a pair @xmath150 with @xmath174 and @xmath175 , so @xmath176 and @xmath177 , implying connectedness of the union @xmath169 in @xmath19 .",
    "let @xmath10 and @xmath14 be sets of graphs .",
    "* we write that @xmath10 has @xmath14-deconstructions of width @xmath178 if for each graph @xmath127 , there exists a graph @xmath179 such that @xmath18 has an @xmath19-deconstruction of width @xmath178 .",
    "* we write that @xmath10 has @xmath14-deconstructions of bounded width if there exists @xmath180 such that @xmath10 has @xmath14-deconstructions of width @xmath178 .",
    "we will employ analogous terminology to discuss , for example , _ nice deconstructions _ which will be defined later .",
    "we define the binary relation @xmath16 on sets of graphs as follows : @xmath17 if and only if @xmath10 has @xmath14-deconstructions of bounded width .",
    "we write @xmath181 if @xmath17 and @xmath182 , and we write @xmath183 if @xmath17 and @xmath184 .",
    "we now present some basic properties of the relation @xmath16 .",
    "[ prop : preorder ] the relation @xmath16 is reflexive and transitive .",
    "reflexivity of @xmath16 follows directly from example  [ ex : self - deconstruction ] .",
    "note that throughout , we will tacitly use the fact that , if @xmath185 , then @xmath17 .",
    "transitivity of @xmath16 follows immediately from the following lemma .",
    "[ lemma : compose - deconstructions ] let @xmath18 , @xmath19 , and @xmath186 be graphs ; suppose that @xmath18 has an @xmath19-deconstruction of width @xmath187 , and that @xmath19 has an @xmath186-deconstruction of width @xmath128 .",
    "then , @xmath18 has an @xmath186-deconstruction of width @xmath188 .",
    "suppose that @xmath18 has the @xmath19-deconstruction @xmath20 of width @xmath187 , and that @xmath19 has the @xmath186-deconstruction @xmath189 of width @xmath128 .",
    "define the family @xmath190 by @xmath191 .",
    "we claim that @xmath190 is an @xmath186-deconstruction of @xmath18 , which suffices .    to verify coverage , let @xmath121 . by coverage of @xmath192",
    ", there exists @xmath146 such that @xmath147 . by coverage of @xmath193",
    ", there exists @xmath194 such that @xmath195 . by definition of @xmath196",
    ", we have that @xmath197 , from which it follows that @xmath198 .    to verify connectivity ,",
    "let @xmath124 be an arbitrary element .",
    "by connectivity of @xmath192 , it holds that @xmath199 is connected in @xmath19 .",
    "it follows from proposition  [ prop : inheriting - connectivity ] that @xmath200 is connected in @xmath186 .",
    "we claim that @xmath201 .",
    "this is because @xmath202    it is an immediate consequence of proposition  [ prop : preorder ] that @xmath203 is an equivalence relation .",
    "[ prop : equivalence - with - minors ] for any set of graphs @xmath10 , it holds that @xmath204 .",
    "it is clear that @xmath205 , since @xmath206 . to show that @xmath207 , we prove that when a graph @xmath129 is a minor of a graph @xmath18 , it holds that @xmath129 has a @xmath18-deconstruction of width @xmath208 .",
    "let @xmath130 be a minor map from @xmath129 to @xmath18 , and define , for all @xmath124 , the set @xmath209 to be @xmath210 .",
    "clearly , for each @xmath124 , it holds that @xmath211 .",
    "we claim that @xmath160 is a @xmath18-deconstruction of @xmath129 . for each @xmath132 , since @xmath133 is non - empty , there exists @xmath124 such that @xmath212 . for each @xmath134 , by definition of minor , there exists @xmath137 with @xmath135 and @xmath213 ; it thus holds that @xmath214 . for each @xmath132 , the set",
    "@xmath215 is equal to @xmath133 , and is hence connected since @xmath130 is a minor map .",
    "we now generalize the notion of tree decomposition to arbitrary graphs , and then compare the resulting notion with the presented notion of @xmath19-deconstruction .",
    "when @xmath18 and @xmath19 are graphs , define an _",
    "@xmath19-decomposition _ of @xmath18 to be an @xmath21-indexed family @xmath20 of subsets of @xmath120 satisfying the following conditions :    * for each pair @xmath121 , there exists @xmath216 such that @xmath123 .",
    "* connectivity ( as defined in definition  [ def : deconstruction ] )    this is a natural generalization of the definition of _ tree decomposition _ :",
    "a tree decomposition is precisely a @xmath19-decomposition where @xmath19 is required to be a tree .",
    "[ prop : decomposition - vs - deconstruction ] let @xmath18 and @xmath19 be graphs , and let @xmath217 .    1 .",
    "when @xmath20 is an @xmath19-decomposition of @xmath18 , it holds that @xmath20 is also an @xmath19-deconstruction of @xmath18 .",
    "if @xmath19 is a tree such that @xmath18 has an @xmath19-deconstruction of width @xmath128 , then @xmath18 has an @xmath19-decomposition of width @xmath218 .",
    "consequently , when @xmath14 is a set of trees , it holds that @xmath17 if and only if @xmath10 has @xmath14-decompositions of bounded width .",
    "\\(1 ) is straightforwardly verified . for ( 2 ) ,",
    "suppose that @xmath20 is an @xmath19-deconstruction of @xmath18 where each bag has size @xmath128 .",
    "root the tree @xmath19 , and define @xmath219 as follows : if @xmath72 is the root of @xmath19 , define @xmath220 , and otherwise define @xmath221 to be the parent of @xmath72 . define @xmath222 by @xmath223 ; it is straightforward to verify that @xmath222 is an @xmath19-decomposition of @xmath18 , and each of its bags has size @xmath224 .",
    "we find that working with the notion of @xmath19-deconstruction is cleaner than working with the notion of @xmath19-decomposition ; this is a primary reason for our focus on the notion of @xmath19-deconstruction . indeed ,",
    "note that while reflexivity of the @xmath16 relation is straightforward to prove , we do not know of a simple proof of reflexivity of the analogous relation defined via @xmath19-decomposition . note that while there exists a constant @xmath23 such that each graph @xmath18 has a @xmath18-deconstruction of width @xmath128 ( in particular , one can take @xmath225 ) , there does not exist a constant @xmath23 such that each graph @xmath18 has a @xmath18-decomposition of width @xmath128 : the bags of a @xmath18-decomposition of width @xmath128 can cover at most a number of edges that is linear in the number of vertices ( @xmath226 many ) , but graphs in general may have quadratically many edges .",
    "recall that @xmath111 denotes the class of all trees of height @xmath227 . for @xmath228 , @xmath180 , define @xmath229 to be the tree with universe @xmath230^{\\leq h}$ ] and with @xmath231^{<h } , i \\in [ k ] \\}$ ] .",
    "here , @xmath230^{\\leq h}$ ] and @xmath230^{<h}$ ] denote the sets of strings over alphabet @xmath230 $ ] of length @xmath115 and of length @xmath232 , respectively .",
    "define the _ stack depth _ of a set @xmath10 of graphs to be @xmath233 ; let it be understood that this maximum should be considered @xmath234 if the set is infinite .",
    "( note , though , that in this article we generally only measure the stack depth of sets of graphs for which it is finite . )",
    "[ thm : stack - depth - decomps ] suppose that @xmath235 are constants and that @xmath10 is a set of trees having stack depth @xmath105 and where each tree has height @xmath236 .",
    "then @xmath237 .",
    "let @xmath129 , @xmath18 be rooted trees .",
    "let us say that an @xmath129-deconstruction of @xmath18 is _ nice _ if it is of the form @xmath238 such that the following hold :    * @xmath130 is a minor map from @xmath131 to @xmath120 .",
    "* @xmath239 , where @xmath240 and @xmath241 denote the roots of @xmath18 and @xmath129 , respectively . *",
    "if @xmath242 is a child of @xmath243 , @xmath135 , @xmath136 , and @xmath137 , then @xmath119 is a child of @xmath118 .",
    "[ lemma : transitivity - niceness ] suppose that @xmath244 , @xmath129 , and @xmath18 are rooted trees , that @xmath245 is a nice @xmath244-deconstruction of @xmath129 , and that @xmath238 is a nice @xmath129-deconstruction of @xmath18 .",
    "then @xmath246 is a nice @xmath244-deconstruction of @xmath18 , where here @xmath247 denotes @xmath248 .",
    "it is straightforward to verify that @xmath249 is a minor map from @xmath244 to @xmath18 .",
    "it follows from the proof of lemma  [ lemma : compose - deconstructions ] that @xmath246 is an @xmath244-deconstruction of @xmath18 .",
    "we verify that this deconstruction is nice , as follows . by the niceness of @xmath250 and @xmath251 , we have that @xmath239 and @xmath252 , so @xmath253 ( here , we use @xmath240 , @xmath241 , and @xmath254 to denote the roots of @xmath18 , @xmath129 , and @xmath244 , respectively ) .",
    "next , suppose that @xmath255 is a child of @xmath25 in @xmath244 , that @xmath256 , that @xmath257 , and that @xmath137 .",
    "there exist @xmath258 such that @xmath135 , @xmath259 , @xmath136 , and @xmath260 . since @xmath261 , we have @xmath262 ; as @xmath137 , we then have @xmath134 , and from the niceness of @xmath251 , we have that @xmath242 is a child of @xmath243 in @xmath129 .",
    "it then follows from the niceness of @xmath250 that @xmath119 is a child of @xmath118 .    for @xmath263 and @xmath180 , let us say that a node @xmath264 of a rooted tree has property @xmath265 if @xmath266 or if @xmath267 and @xmath264 has @xmath268 pairwise incomparable descendents each having property @xmath269 .",
    "we consider two nodes @xmath270 to be incomparable if neither is an ancestor of the other . )",
    "let us say that a rooted tree has property @xmath271 if its root has property @xmath265 .",
    "observe that if a rooted tree has property @xmath271 , then the tree contains @xmath272 as a minor .",
    "[ lemma : property - transfer ] suppose that @xmath129 and @xmath18 are rooted trees and that @xmath238 is a nice @xmath129-deconstruction of @xmath18 .",
    "for @xmath263 and @xmath180 , if @xmath129 has property @xmath265 , then @xmath18 has property @xmath265 .    for each @xmath132",
    ", since @xmath133 is connected , it has a unique highest element , by which we mean the element with shortest distance to the root ; denote this element by @xmath273 .",
    "suppose that @xmath242 is a child of @xmath243 in @xmath129 ; the parent of @xmath274 must , by the definition of deconstruction , lie in @xmath275 where @xmath276 is adjacent to @xmath242 ; but it must be that @xmath277 by the niceness of @xmath250 .",
    "we thus have that , when @xmath242 is a child of @xmath243 in @xmath129 , it holds that @xmath274 is a descendent of @xmath273 ; it can then be verified ( by induction on @xmath105 ) that if a node @xmath132 has property @xmath265 in @xmath129 , then @xmath273 has property @xmath265 in @xmath18 .",
    "( theorem  [ thm : stack - depth - decomps ] ) let @xmath278 be a constant .",
    "suppose that @xmath10 is a set of rooted trees of height @xmath236 which do not have property @xmath279 ; we prove that @xmath10 has nice @xmath111-deconstructions of bounded width .",
    "( this suffices , since the assumption that @xmath10 has stack depth @xmath105 implies that there is a constant @xmath278 such that @xmath280 , which in turn implies that the trees in @xmath10 do not have property @xmath279 . )    we proceed by induction on @xmath105 .    [ [ case - d-0 ] ] case @xmath266 + + + + + + + + + + + + + + + + + + + + + + + +    we have that the trees in @xmath10 do not have property @xmath281 .",
    "consider a rooted tree from @xmath10 .",
    "the number of leaves is bounded above by @xmath282 ; since each node is the ancestor of a leaf , the total number of nodes is bounded above by @xmath283 .",
    "thus @xmath10 has nice @xmath284-deconstructions of width @xmath285 .",
    "[ [ case - d-0 - 1 ] ] case @xmath267 + + + + + + + + + + + + + + + + + + + + + + + +    we argue by induction on @xmath286 .",
    "if @xmath287 , then we have that @xmath288 and we are done ( for each @xmath127 , use the @xmath18-deconstruction of @xmath18 discussed in conjunction with reflexivity in proposition  [ prop : preorder ] ) .",
    "so suppose that @xmath289 .",
    "define a set of trees @xmath290 as follows : for each tree @xmath18 in @xmath10 , and for each child @xmath291 of the root of @xmath18 , if @xmath291 does not have property @xmath292 , then place the subtree of @xmath18 rooted at @xmath291 in @xmath290 .",
    "the trees in @xmath290 have bounded height and do not have property @xmath292 ; so , by induction , we have that there is a constant @xmath23 such that @xmath290 has nice @xmath293-deconstructions of width @xmath128 .",
    "let @xmath18 be a tree in @xmath10 .",
    "let @xmath294 denote the children of the root that have property @xmath292 , and let @xmath295 denote the remaining children of the root . since the root of @xmath18 does not have property @xmath296 , we have that @xmath297 .",
    "let @xmath298 denote the subtrees of @xmath18 rooted at @xmath295 , respectively .",
    "each tree @xmath299 is contained in @xmath290 , and so for each @xmath300 $ ] , there is a tree @xmath301 such that @xmath299 has a nice @xmath302-deconstruction @xmath303 of width @xmath128 .",
    "now define the tree @xmath19 to be the minor of @xmath18 obtained from @xmath18 by contracting together the vertices @xmath304 to obtain @xmath305 , and by replacing each @xmath299 with @xmath302 .",
    "observe that the height of @xmath19 is @xmath306 .",
    "the following map @xmath130 is a minor map from @xmath19 to @xmath18 : @xmath307 , @xmath308 is equal to @xmath309 if @xmath310 , and @xmath311 for all other vertices @xmath312 .",
    "it is straightforward to verify that @xmath313 gives a nice @xmath19-deconstruction of @xmath18 having width @xmath314 .",
    "let @xmath14 denote the set of all trees @xmath19 obtained from @xmath315 in this way .",
    "we just saw that @xmath10 has nice @xmath14-deconstructions of bounded width .",
    "since @xmath14 has height @xmath306 and does not have property @xmath279 by lemma  [ lemma : property - transfer ] , by induction , @xmath14 has nice @xmath316-deconstructions of bounded width . as a consequence of lemma  [ lemma : transitivity - niceness ]",
    ", we obtain that @xmath10 has nice @xmath111-deconstructions of bounded width .",
    "recall that @xmath317 denote the classes of graphs , trees and paths respectively , and @xmath318 denote the classes trees respectively forest of height at most @xmath105 ( cf .",
    "section  [ subsect : graphs ] ) .",
    "( hierarchy theorem ) [ thm : graph - hierarchy ] the hierarchy @xmath319 presents correct relationships , and is comprehensive in that each set of graphs is equivalent ( under @xmath203 ) to one of the sets therein .",
    "we give in this section a sequence of lemmas , and then show how the theorem follows . at the end of the section .",
    "we begin by observing that the established conditions of bounded treewidth , bounded pathwidth , and bounded tree depth can be formulated using the @xmath16 relation and the defined graph sets .",
    "[ prop : bounded - characterizations ] let @xmath10 be a set of graphs .    1 .   @xmath10 has bounded treewidth if and only if @xmath29 .",
    "@xmath10 has bounded pathwidth if and only if @xmath30 .",
    "3 .   @xmath10 has bounded tree depth if and only if there exists @xmath263 such that @xmath320 .    the first two claims follow immediately from proposition  [ prop : decomposition - vs - deconstruction ] . for the third claim , we reason as follows . for the forward direction ,",
    "let @xmath105 be an upper bound on the tree depth of @xmath10 , and let @xmath18 be a graph in @xmath10 ; proposition  [ prop : depth - gives - decomposition ] ( along with proposition  [ prop : decomposition - vs - deconstruction ] ) implies that each component of @xmath18 has a @xmath111-deconstruction of width @xmath227 . to establish the backward direction , proposition  [ prop : decomposition - vs - deconstruction ] yields that there exists a constant @xmath23 such that @xmath10 has @xmath112-decompositions of width @xmath321 , which implies that @xmath10 has tree depth @xmath322 ( see  ( * ? ? ?",
    "* remark 4.3(a ) ) ) .    in the next two lemmas , we present the negative results needed to give the hierarchy , showing that various pairs of graph classes are not related by @xmath16 .",
    "[ lemma : top - hierarchy ] the following relationships hold .",
    "1 .   @xmath323 2 .",
    "@xmath324 3 .",
    "@xmath325 , for all @xmath263    immediate from theorem  [ thm : excluded ] and proposition  [ prop : bounded - characterizations ] .",
    "[ lemma : bounded - td - hierarchy ] for each @xmath263 , the following hold :    1 .",
    "@xmath326 2 .",
    "@xmath327    we prove this by induction on @xmath105 . when @xmath266 , the claim that @xmath326 is clear , since @xmath284 contains only one - vertex trees , but @xmath328 contains graphs with arbitrarily many vertices .",
    "the claim that @xmath327 always follows from @xmath326 , as follows : the assumption @xmath329 immediately implies that @xmath330 by proposition  [ prop : inheriting - connectivity ] ; this in turn implies that @xmath331 .",
    "let @xmath267 ; we need to prove that @xmath326 .",
    "suppose for a contradiction that @xmath23 is a constant such that @xmath112 has @xmath111-deconstructions of width @xmath128 .",
    "we show that @xmath332 , which contradicts the induction hypothesis .",
    "given an arbitrary tree @xmath107 in @xmath111 , create @xmath333 copies of it ; the resulting graph has a @xmath19-deconstruction @xmath20 of width @xmath128 , with @xmath334 .",
    "root @xmath19 with a vertex @xmath305 to witness that its height is @xmath335 .",
    "since the bag @xmath336 has size @xmath128 , there must be a copy of @xmath107 that is disjoint from @xmath336 ; call this the _ key copy _ and denote its universe by @xmath282 . by proposition  [ prop : inheriting - connectivity ]",
    ", it is possible to take a subtree @xmath337 of @xmath19 that excludes @xmath305 such that @xmath338 gives an @xmath337-deconstruction of the key copy .",
    "the graph @xmath337 has height @xmath339 .",
    "we thus showed that @xmath111 has @xmath293-deconstructions of width @xmath128 , implying that @xmath332 , as desired .",
    "[ lemma : placing - g ] let @xmath10 be a set of graphs .    1 .   if @xmath340 , then @xmath29 .",
    "2 .   if @xmath341 , then @xmath30 .",
    "3 .   if @xmath342 , then @xmath10 has bounded tree depth .",
    "we begin with the third claim .",
    "suppose that @xmath342 .",
    "it holds by proposition  [ prop : equivalence - with - minors ] that @xmath343 , from which it follows that @xmath344 and hence , by theorem  [ thm : excluded ] , @xmath10 has bounded tree depth .    to establish the second claim , we reason in an analogous way .",
    "if @xmath341 , it follows from proposition  [ prop : equivalence - with - minors ] and theorem  [ thm : excluded ] that @xmath10 has bounded pathwidth , and it follows from proposition  [ prop : bounded - characterizations ] that @xmath30 .",
    "we can also prove the first claim in an analogous way , but in order to use theorem  [ thm : excluded ] , we need to prove that @xmath345 , where @xmath110 denotes the set of all grids ; it follows from this that @xmath340 implies @xmath346 .",
    "that @xmath345 follows from example  [ ex : grid ] : each graph has @xmath110-deconstructions of width @xmath208 .",
    "[ lemma : graphs - to - forests ] let @xmath10 be a set of graphs .",
    "if @xmath10 has bounded tree depth , then there exists a set @xmath14 of forests of bounded height such that @xmath181 and such that @xmath10 and @xmath14 have the same stack depth .",
    "( namely , one can take @xmath14 to be the set of all forests that are minors of @xmath10 . )",
    "let @xmath14 be as described .",
    "the set @xmath14 has bounded height , as @xmath10 has bounded tree depth .",
    "the sets @xmath10 and @xmath14 have the same tree minors , so they have the same stack depth",
    ". we have @xmath182 by proposition  [ prop : equivalence - with - minors ] .",
    "we prove @xmath17 as follows .",
    "the proof is along the lines of that of  ( * ? ? ?",
    "* lemma 4.8 ) ; we provide a proof here for completeness . for each graph @xmath127 ,",
    "let @xmath19 be a forest that contains a depth - first search tree of each component of @xmath18 ( for precise details , we refer to diestel  @xcite , who speaks of _ normal spanning trees _ ; see proposition 1.5.6 ) .",
    "since @xmath19 is a subgraph of @xmath18 , we have @xmath179 .",
    "each component of @xmath18 is contained in the closure of its corresponding component in @xmath19 ( in the sense of the definition of tree depth ) , so proposition  [ prop : depth - gives - decomposition ] and the fact that @xmath14 has bounded height imply that @xmath17 .",
    "[ lemma : stack - depth - in - hierarchy ] let @xmath10 be a set of forests having bounded height , and let @xmath105 denote the stack depth of @xmath10 .",
    "it holds either that @xmath347 or that @xmath348 .",
    "let @xmath349 be the set of connected graphs that appear as components of graphs in @xmath10 ; note that @xmath105 is the stack depth of @xmath349 .    for each @xmath180 and each graph @xmath127",
    ", define @xmath350 to be the number of components of @xmath18 having the tree @xmath272 as a minor .",
    "we consider two cases .",
    "* case 1 : * suppose that , for all @xmath180 , the set @xmath351 has infinite size .",
    "we claim that @xmath348 .",
    "it follows directly from theorem  [ thm : stack - depth - decomps ] that @xmath320 . for each @xmath180 , let us use @xmath352 to denote the graph consisting of @xmath268 disjoint copies of @xmath272 . by assumption , we have @xmath353 . we also have that ( up to isomorphism ) each graph in @xmath112 is a subgraph of a graph of the form @xmath354 ; hence , by proposition  [ prop : equivalence - with - minors ] , it holds that @xmath355 .    *",
    "case 2 : * when the assumption of the first case does not hold , one can choose a sufficiently large @xmath278 such that , for all @xmath127 , it holds that @xmath356 .",
    "we claim that @xmath347 .",
    "that @xmath357 follows from the hypothesis that @xmath105 is the stack depth of @xmath349 .",
    "we show that @xmath237 .",
    "let @xmath14 be the subset of @xmath349 that contains a graph @xmath358 if and only if @xmath359 is not a minor of @xmath19 . by theorem  [ thm : stack - depth - decomps ]",
    ", it holds that @xmath360 ; let @xmath217 be such that @xmath14 has @xmath293-deconstructions of width @xmath128 .",
    "let @xmath127 ; let @xmath361 be the components of @xmath18 having @xmath359 as a minor , and let @xmath362 be the other components of @xmath18 . by the choice of @xmath282 , it holds that @xmath363 . since @xmath364",
    ", there exists @xmath365 such that @xmath349 has @xmath111-deconstructions of width @xmath187 .",
    "let @xmath366 be a sufficiently large tree so that each @xmath367 has a @xmath107-deconstruction @xmath368 of width @xmath187 ; then , the disjoint union of the @xmath367 has a @xmath107-deconstruction of width @xmath369 , namely , @xmath370 .",
    "each @xmath371 has a @xmath372-deconstruction of width @xmath128 , where @xmath373 .",
    "let @xmath374 be equal to @xmath107 but augmented so that the root of each @xmath372 is a child of the root of @xmath107 ; we have that the depth of @xmath374 is @xmath105 .",
    "the graph @xmath18 has a @xmath374-deconstruction where each bag is defined as it was in the respective @xmath107-deconstruction or @xmath372-deconstruction ; this @xmath374-deconstruction has width @xmath375 .",
    "the following is a consequence of the previous two lemmas .",
    "[ lemma : stack - depth - placement ] let @xmath10 be a set of graphs having bounded tree depth , and let @xmath376 .",
    "the set @xmath10 has stack depth @xmath105 if and only if @xmath347 or @xmath348 .",
    "we first prove the forward direction .",
    "suppose that @xmath10 has stack depth @xmath105 .",
    "by lemma  [ lemma : graphs - to - forests ] , there exists a set of forests @xmath14 having bounded height and stack depth @xmath105 such that @xmath181 . by lemma  [ lemma : stack - depth - in - hierarchy ]",
    ", we have that @xmath377 or @xmath378 , implying that @xmath347 or @xmath348 .",
    "for the backward direction , suppose that @xmath347 or @xmath348 .",
    "by lemma  [ lemma : bounded - td - hierarchy ] , it holds that @xmath379 .",
    "if @xmath10 does not have stack depth @xmath105 , then we have a contradiction to the forward direction .",
    "( proof of theorem  [ thm : graph - hierarchy ] ) it is clear that @xmath380 from which it follows that @xmath381 lemmas  [ lemma : top - hierarchy ] and  [ lemma : bounded - td - hierarchy ] imply that @xmath382    to prove that the hierarchy is comprehensive , let @xmath10 be an arbitrary set of graphs . consider the first of the following conditions that holds .    * if @xmath383 , then clearly @xmath384 . + otherwise , by lemma  [ lemma : placing - g ] , it holds that @xmath29 . * if @xmath385 , then @xmath386 .",
    "+ otherwise , by lemma  [ lemma : placing - g ] , it holds that @xmath30 . * if @xmath387 , then @xmath388 . + otherwise , by lemma  [ lemma : placing - g ] , @xmath10 has bounded tree depth . *",
    "if @xmath10 has bounded tree depth , it follows from lemma  [ lemma : stack - depth - placement ] that either @xmath347 or @xmath348 , where @xmath105 is the stack depth of @xmath10 .",
    "a _ parameterized problem @xmath389 _ is a subset of @xmath390 . given an instance @xmath391 of @xmath389 we refer to @xmath268 as its _",
    "parameter_. the _",
    "@xmath268th slice _ of @xmath389 is the classical problem @xmath392 ; here we are refering to subsets of @xmath393 as _ classical problems_.    following flum and grohe  @xcite , we say @xmath389 is in l _ after a pre - computation _ if there exists a computable function @xmath394 and a classical problem @xmath395 in l such that for all @xmath396 @xmath397 where @xmath398 is some standard pairing function for binary strings .",
    "equivalently , this means that @xmath399 is decidable in space @xmath400 for some computable @xmath401 .",
    "the class of such problems is denoted _ para - l_. this mode of speech makes sense not only for l but for any classical complexity class , and we refer to @xcite for the corresponding theory .",
    "e.g. fpt is the class of parameterized problems which are in p after a pre - computation .",
    "a _ parameterized reduction _ from a parameterized problem @xmath389 to another @xmath402 is a function @xmath403 such that there is a computable @xmath404 such that for all @xmath396 we have for @xmath405 that @xmath406 and : @xmath407 .",
    "if there is a comptable @xmath408 such that @xmath409 is computable in space @xmath410 ( on a turing machine with write - only output tape ) , then we speak of a @xmath411_-reduction_.    in descriptive complexity one considers classical problems as isomorphism closed classes of ( finite ) structures of some fixed vocabulary . in the parameterized",
    "setting we are led to consider the slices of parameterized problems as such classes of structures .",
    "[ def : paramprobl ] a _ parameterized problem _ is a subset @xmath412 such that for every @xmath413 there is a vocabulary @xmath414 such that the _ @xmath268-the slice of @xmath389 _ , i.e.  @xmath415 , is an isomorphism closed class of @xmath414-structures . if there is @xmath416 such that @xmath417 for all @xmath418 , we say that @xmath389 has bounded arity.s are assumed to be pairwise equal and only _ ordered _ structures are considered . ]",
    "this definition is not in conflict with the mode of speech above if one views binary strings as structures in the usual way .",
    "flum and grohe  @xcite transferred capturing results ( cf .",
    "* chapter  7 ) ) of classical descriptive complexity to the parameterized setting via the concept of _ slicewise definability_. for example , a parameterized problem @xmath389 is _ slicewise fo - definable _ if there exists a computable function @xmath105 mapping every @xmath413 to a first - order sentence @xmath419 defining the @xmath268-th slice of @xmath389 ( cf .",
    "if one additionally assumes that there is a constant @xmath420 bounding the quantifier rank of all @xmath421 then it follows by standard means that slicewise fo - definable probelms are in para - l .",
    "in fact , in @xcite flum and grohe gave a characterization of para - l along these lines via slicewise definability in deterministic transitive closure logic .",
    "many parameterized classes could be characterized in this way @xcite .    in this section",
    "we study the complexity of the parameterized homomorphism problems associated to classes of structures @xmath0 : @xmath422 here , @xmath423 is a natural number coding the structure @xmath2 in some natural way .",
    "the goal of this section is to show that the complexities of homomorphism problems are captured in a strong sense by the hierarchy from section  [ sec : hierarchy ] .",
    "we start by carefully defining a very weak notion of reduction .",
    "central to descriptive complexity are first - order reductions which take a structure @xmath2 to the structure @xmath424 where @xmath425 is a first - order interpretation ( see e.g.  ( * ? ? ?",
    "* chapter  12.3 ) ) .",
    "we recall the definition ( see e.g.  ( * ? ? ?",
    "* chapter  11.2 ) ) .",
    "[ df : interpetation ] let @xmath426 be ( finite , relational ) vocabularies and @xmath427 be a unary relation symbol outside  @xmath428 .",
    "an _ interpretation ( of @xmath428 in @xmath40 ) _ is a sequence @xmath429 of @xmath40-formulas such that there exists @xmath420 such that for all @xmath430 we have @xmath431 where every @xmath432 is a tuple of @xmath23 variables .",
    "the number @xmath23 is the _ dimension _ of @xmath425 .",
    "the vocabularies @xmath40 and @xmath428 are the _ input _ and _ output vocabulary of _ @xmath425 , respectively .",
    "an interpretation is _ quantifier - free _ if all its formulas are .",
    "the @xmath428-structure @xmath424 is defined only if @xmath2 is a @xmath40-structure such that @xmath433 . in this case",
    "it has universe @xmath434 and interprets @xmath435 by @xmath436 ; here we view @xmath437 as a subset of @xmath438 .",
    "the following is well - known and easy to see ( see e.g.  ( * ? ? ?",
    "* exercises  12.3.2 , 11.2.4 ) ) .",
    "[ lem : int ] there is a computable function mapping a pair of interpretations @xmath439 to an interpretation @xmath440 such that for every structure @xmath2 with @xmath424 and @xmath441 both defined , also @xmath442 is defined and @xmath443 .",
    "if both @xmath444 are quantifier - free , then so is @xmath440 . if @xmath425 has dimension @xmath23 and @xmath445 has dimension @xmath446 , then @xmath440 has dimension @xmath447 .",
    "we need to agree upon a way how to consider pairs of structures as a single structure .",
    "here is a straightforward way to do this :    given a pair @xmath448 of a @xmath40-structure @xmath2 and a @xmath428-structure @xmath3 , define the structure @xmath449 by taking the disjoint union of @xmath2 and @xmath3 and interpreting two new unary relation symbols @xmath450 and @xmath451 by the ( copies of the ) universes of @xmath2 and @xmath3 respectively .",
    "naturally here , the disjoint union of @xmath2 and @xmath3 has universe @xmath452 and interprets @xmath453 by @xmath454 where @xmath455 if @xmath456 and else @xmath457 ; @xmath458 is defined analogously . for @xmath459 many structures",
    "@xmath460 we inductively set @xmath461 .",
    "it is well - known that np contains problems that are complete under quantifier - free reductions , i.e. reductions computed by a quantifier - free interpretation @xmath425 as above .",
    "dawar and he  @xcite transferred the notions to the parameterized setting and asked whether central completeness results for the classes of the w - hierarchy exhibit a similar robustness .",
    "more precisely , dawar and he defined a parameterized reduction @xmath462 from @xmath389 to @xmath402 to be _ slicewise quantifier - free definable _ if there exists @xmath463 and a computable function @xmath105 that maps every @xmath413 to some quantifier - free interpretation @xmath419 each of whose formulas has at most @xmath23 variables such that @xmath464 ; here , one views the pair @xmath465 in some suitable way as a single structure .",
    "[ df : qfred ] let @xmath466 be parameterized problems ( definition  [ def : paramprobl ] )",
    ". for @xmath413 let @xmath414 denote the vocabulary of the @xmath268-th slice of @xmath389 .",
    "a parameterized reduction @xmath462 from @xmath389 to @xmath402 is _ quantifier - free after a pre - computation _ if there are @xmath463 and computable functions    * @xmath467 * @xmath468 * @xmath105 mapping @xmath413 to a quantifier - free interpretation @xmath419 of dimension @xmath23 ,    such that for all @xmath469\\times{\\mathbb{n}}$ ] the structure @xmath470 is defined and @xmath471 .",
    "we write @xmath472 to indicate that such a reduction exists , and we write @xmath473 to indicate that both @xmath472 and @xmath474 .",
    "note the new _",
    "p_arameter @xmath475 is computed by @xmath476 from @xmath268 alone , @xmath104 is the pre - computation providing an _",
    "a_uxiliary structure , and @xmath105 provides the _ d_efinition of the new structure @xmath477 . to compare definition  [ df : qfred ] with dawar and he s notion , observe that if @xmath402 has arity bounded by @xmath462 , then the formulas in @xmath419 have at most @xmath478 many variables .",
    "we shall only be interested in problems satisfying this assumption .",
    "has size @xmath479 for @xmath462 the arity of the @xmath475-th slice of @xmath402 . ]",
    "[ lem : plred ] let @xmath466 be parameterized problems and assume @xmath402 has bounded arity .",
    "if @xmath472 , then @xmath480 .",
    "let @xmath462 be quantifier - free after a pre - computation and choose @xmath481 witnessing this .",
    "given @xmath465 we need to explain how to compute @xmath482 in parameterized logarithmic space .",
    "note the computation of @xmath483 and @xmath419 requires an amount of space that depends on the parameter @xmath268 only .",
    "it thus suffices to show that @xmath477 can be computed from @xmath484 and @xmath419 in parameterized logarithmic space . to compute @xmath477",
    "one needs to check for every @xmath485 from @xmath419 and for each length @xmath486 tuple @xmath61 from the universe of @xmath484 whether @xmath61 satisfies @xmath57 in @xmath484 .",
    "this can be done in space @xmath487 if @xmath243 is the size of the universe of @xmath484 : note that if @xmath23 is the dimension of @xmath419 and @xmath462 bounds the arity of @xmath402 , then @xmath49 has at most @xmath488 many variables @xmath489 , and this is an absolute constant .",
    "[ lem : trans ] let @xmath490 be parameterized problems . if @xmath472 and @xmath491 , then @xmath492 .",
    "let @xmath481 and @xmath493 witness @xmath472 and @xmath491 respectively .",
    "we define @xmath494 witnessing @xmath492 as follows .",
    "we set @xmath495 and @xmath496 .",
    "to define @xmath497 write @xmath498 , and @xmath499 .",
    "we have to explain how to compute from @xmath444 a ( quantifier - free ) interpretation @xmath440 such that @xmath500 .",
    "let @xmath23 be the dimension of @xmath501 .",
    "we construct an interpretation @xmath502 of dimension @xmath23 such that @xmath503 .",
    "let @xmath504 be a quantifier - free formula defining the universe of ( the copy of ) @xmath505 in @xmath506 .",
    "write @xmath507 and @xmath508 for @xmath509 and set @xmath510}\\neg \\psi(x_i))\\vee(\\psi(x_1)\\wedge \\bigwedge_{i\\in[w]}x_i = x_1),\\\\ \\psi_{p_1}(\\bar x)&:=&\\psi(x_1),\\\\ \\psi_{p_2}(\\bar x)&:=&\\neg\\psi(x_1),\\\\ \\psi_r(\\bar x_1,\\ldots,\\bar x_{{\\mathrm{ar}}(r)})&:=&\\textstyle(\\varphi_r(\\bar x_1,\\ldots,\\bar x_{{\\mathrm{ar}}(r)})\\wedge\\bigwedge_{j\\in[{\\mathrm{ar}}(r ) ] } \\neg\\psi(x_{j1}))\\vee ( rx_{11}x_{21}\\cdot x_{{\\mathrm{ar}}(r)1}\\wedge\\bigwedge_{j\\in[{\\mathrm{ar}}(r)]}\\psi(x_{j1})),\\end{aligned}\\ ] ] for @xmath38 appearing in both , the output vocabulary of @xmath425 and the vocabulary of @xmath505 ; if @xmath38 does not appear in the former ( latter ) , we omit the former ( latter ) disjunct in @xmath511 .",
    "then @xmath512 is as required . from @xmath513",
    "compute @xmath440 according to  lemma  [ lem : int ] . then @xmath514 .",
    "[ [ convention ] ] convention + + + + + + + + + +    for technical reasons we need to consider homomorphism problems @xmath1 also for classes @xmath0 which are not necessarily decidable .",
    "in such a case we slightly abuse notation and write @xmath515 for a parameterized problem @xmath389 to mean that there are _ partially _ computable functions @xmath516 whose domain contains @xmath517 such that for all @xmath518 and similar @xmath3 we have that @xmath519 is defined and : @xmath520      let @xmath521 be computably enumerable classes of graphs . in this subsection we show that the associated homomorphism problems @xmath13 and @xmath15 are @xmath522-equivalent if the graph classes @xmath10 and @xmath14 are @xmath203-equivalent :    [ theo : dechom ] if @xmath17 , then @xmath523    choose @xmath23 such that graphs in @xmath10 have @xmath14-deconstructions of width at most @xmath23 . using that @xmath14 is computably enumerable , it is not hard to see that there is an algorithm that computes given @xmath524 a graph @xmath525 and an @xmath19-deconstruction @xmath165 of @xmath18 of width at most @xmath23 .",
    "given an instance @xmath526 of @xmath13 with @xmath524 and @xmath3 similar to @xmath527 the reduction outputs @xmath528 where @xmath525 is as above and @xmath529 is defined as follows .",
    "assume first that all bags @xmath530 are nonempty .",
    "for @xmath531 let @xmath532 denote the set of pairs @xmath533 such that @xmath534 is a partial homomorphism from @xmath527 to @xmath3 . for each @xmath535",
    "choose a tuple @xmath536 that lists the elements of @xmath22 . define @xmath537    we claim that @xmath538    if @xmath408 is a homomorphism from @xmath527 to @xmath3 , then @xmath539 is a homomorphism from @xmath540 to @xmath529 .",
    "conversely , suppose that @xmath541 is a homomorphism from @xmath540 to  @xmath529 .",
    "if @xmath541 maps @xmath535 to @xmath542 , let @xmath543 be the map @xmath544 .",
    "any two such maps @xmath543 and @xmath545 are compatible in the sense that they agree on arguments on which they are both defined : indeed , if @xmath546 then @xmath547 and @xmath548 , so there is a path in @xmath19 from @xmath72 to @xmath549 ; if @xmath550 then there exists neighbors @xmath551 on this path such that @xmath552 ; then @xmath553 is not a function , and in particular @xmath554 ; as @xmath555 this contradicts @xmath541 being a homomorphism . therefore and since every @xmath556 appears in some @xmath22 , @xmath557 is a function from @xmath120 to @xmath41 . to verify",
    "it is a homomorphism we show that it preserves @xmath86 ; that is preserves the colours @xmath558 can be seen similary .",
    "so , given an edge @xmath559 we have to show @xmath560 .",
    "choose @xmath561 such that @xmath562 .",
    "then @xmath563 is a partial homomorphism from @xmath527 to @xmath3 : this is clear if @xmath564 ; otherwise @xmath565 , so @xmath566 and is follows by definition of @xmath567 that @xmath568 is a partial homomorphism . but @xmath568 is defined on @xmath569 , so @xmath568 and hence @xmath408 maps @xmath117 to an edge in @xmath570 .",
    "we are left to show that there is a quantifier - free interpretation producing @xmath529 from @xmath571 for some structure @xmath572 computable from  @xmath527 .",
    "for @xmath572 we take the expansion of @xmath527 that interprets for every @xmath535 a @xmath23-ary relation symbol @xmath22 by @xmath573 . for @xmath23-tuples of variables @xmath574 and @xmath575 consider the formula @xmath576 }   p_1x_i\\wedge \\bigwedge_{i\\in[w ] }   p_2y_i\\wedge\\bigwedge_{(i , i')\\in[w]^2 } ( x_i = x_{i'}\\to y_i = y_{i ' } ) \\wedge\\bigwedge_{(i , i')\\in[w]^2 } ( ex_ix_{i'}\\to ey_iy_{i'})\\ ] ] and let @xmath577 be similarly defined for @xmath578-tuples",
    ". set @xmath579 this is a quantifier - free interpretation @xmath425 of dimension @xmath578 such that @xmath580 .",
    "this finishes the proof for the case that the bags @xmath530 are nonempty .    in the general case",
    "we can assume that any @xmath22 is nonempty whenever there exists @xmath581 in the connected component of @xmath72 in @xmath19 such that @xmath582 .",
    "thus we can assume @xmath19 is the disjoint union of @xmath583 and @xmath584 such that @xmath585 for all @xmath586 and @xmath587 for all @xmath588 .",
    "as seen above we get a @xmath529 such that @xmath589 define @xmath590 as follows using a new vertex @xmath591 : @xmath592 it is straightforward to check that @xmath529 can be defined by a quantifier - free interpretation as above : e.g. as formula @xmath593 one may now take @xmath594}(c_{g_0}x_i\\wedge c_{g_0}y_i),\\ ] ] for some fixed vertex @xmath595 . furthermore , it is easy to see that @xmath596 from and we see that @xmath597 is a reduction from @xmath13 to @xmath15 as desired .",
    "let @xmath0 be a computably enumerable class of structures .",
    "we show :    [ theo : coregraphhom ] suppose @xmath0 has bounded arity .",
    "let @xmath10 denote the class of graphs from the hierarchy  ( [ eq : hierarchy ] ) such that @xmath598",
    ". then @xmath599",
    "thus , the complexity of @xmath1 is determined in a strong sense by the level @xmath600 takes in our hierarchy .",
    "for example , because the reductions are weaker than fpt - reductions it is the level @xmath600 takes in our hierarchy what determines whether @xmath1 is w[1]-complete or fixed - parameter tractable ( cf .",
    "@xcite ) , and because it is weaker than pl - reductions ( cf .",
    "@xcite ) , this level determines e.g.  whether @xmath1 is in para - l or path ( cf .",
    "@xcite ) .",
    "we devide the proof into a sequence of lemmas .",
    "the first two of them build on two lemmas from  @xcite .",
    "recall that the _ direct product _",
    "@xmath601 of two @xmath40-structures @xmath2 and  @xmath3 has universe @xmath602 and interprets @xmath95 by @xmath603    suppose @xmath0 is a class of cores .",
    "then @xmath604    let @xmath605 with @xmath606 be an instance of @xmath607 .",
    "let @xmath608 be the restriction of @xmath3 to the vocabulary @xmath40 of @xmath2 .",
    "set @xmath609    using that @xmath0 is a class of cores , it is proved in ( * ? ? ? * lemma  3.9 ) that @xmath610    to see that the reduction @xmath611 is quantifier - free after a pre - computation , we define @xmath481 witnessing this .",
    "set @xmath612 and @xmath613 .",
    "recall the interpretation @xmath614 is meant to produce @xmath529 from @xmath615 .",
    "it has dimension @xmath162 and is given by @xmath616    [ cor : core ] @xmath617    by lemma  [ lem : trans ] it suffices to establish the following sequence of reductions : @xmath618 to see @xmath619 , map an instance @xmath620 with @xmath606 to @xmath621 where @xmath529 expands @xmath3 interpeting @xmath622 by @xmath623 .",
    "it is easy to see that this is quantifier - free after a pre - computation .",
    "that @xmath624 follows from the previous lemma . finally , to see @xmath625 we use ( here and only here ) that @xmath0 is computably enumerable",
    ": this ensures that there exists a partially computable function @xmath476 such that for all @xmath626 we have that @xmath627 is the code of a structure in @xmath0 whose core is @xmath2 ; the reduction then maps @xmath620 to @xmath628 .",
    "again it is clear that this is quantifier - free after a pre - computation .",
    "@xmath629    because @xmath0 is computably enumerable there is a partially computable function @xmath476 that maps any @xmath630 with @xmath631 to ( the code of ) a structure @xmath80 with @xmath606 and @xmath632 ; in particular , @xmath633 and we write @xmath634 . from a further given structure @xmath3",
    "similar to @xmath527 define the following structure @xmath529 : @xmath635:\\textup { if } a_i\\neq a_j , \\textup { then } ( b_i , b_j)\\in e^{{\\mathbf{b } } }    \\big\\},\\end{aligned}\\ ] ] for @xmath38 in the vocabulary @xmath40 of @xmath2 .",
    "this structure is produced from @xmath615 by the following interpretation @xmath425 of dimension 2 : @xmath636 ^ 2}(x_i= x_j\\vee ey_iy_j),\\end{aligned}\\ ] ] for @xmath95 .",
    "clearly , @xmath425 is computable from @xmath630 . setting @xmath637 and @xmath638 we get a reduction as desired provided @xmath639",
    "this has been proved in ( * ? ? ?",
    "* lemma  3.8 ) .",
    "next , we show a partial converse to the previous lemma .",
    "[ lem : classtograph ] suppose @xmath0 has bounded arity .",
    "then @xmath640    we consider two cases depending on whether or not @xmath0 has bounded treewidth .",
    "[ [ case-1 ] ] case 1 + + + + + +    suppose @xmath0 has unbounded treewidth",
    ". then @xmath641 by the hierarchy theorem . by theorem  [ theo : dechom ]",
    "we get @xmath642 . since trivially @xmath643 for every class of graphs @xmath14 it suffices to show @xmath644 for some class of graphs @xmath14 .",
    "in fact , we show that for every @xmath0 with bounded arity ( not necessarily of the form @xmath7 ) there exists a class of graphs @xmath14 such that @xmath645 .",
    "let @xmath40 be a vocabulary and @xmath2 be a @xmath40-structure .",
    "we define the following graph @xmath646 , reminiscent of the incidence graph .",
    "its universe has `` left '' vertices @xmath647\\big\\}\\ ] ] together with `` right '' vertices @xmath648 ; for notational simplicity we assume that @xmath649 .",
    "its edges @xmath650 are also devided into two kinds , namely we have edges `` on the left '' between @xmath651 and @xmath652 for @xmath653 together with `` left to right '' edges between @xmath654 and @xmath655 .    given @xmath606 and a structure @xmath3 ,",
    "say both of vocabulary @xmath40 , define the following structure @xmath529 .",
    "it expands @xmath656 to a structure interpreting the language of @xmath657 .",
    "namely , @xmath658\\}\\subseteq l({\\mathbf{b } } ) ,   \\qquad\\textup { for } ( r,\\bar a , i)\\in l({\\mathbf{a}}),\\\\ c_{a}^{{\\mathbf{b}}'}&:= & r({\\mathbf{b}})=b ,   \\qquad\\textup { for } a\\in r({\\mathbf{a}}).\\end{aligned}\\ ] ]    we claim that @xmath659    to see the forward direction , assume @xmath72 is a homomorphism from @xmath2 to @xmath3",
    ". define @xmath660 setting @xmath661 for @xmath662 and @xmath663 for @xmath651 .",
    "note that indeed @xmath664 because @xmath665 as @xmath72 is a homomorphism .",
    "it also follows that @xmath549 preserves the colours @xmath666 ; that it preserves the colours @xmath82 is clear .",
    "it is also clear that it preserves edges `` on the left '' . finally consider a `` left to right '' edge , say between @xmath654 and @xmath655 . then @xmath667 and this is in @xmath668 .",
    "conversely , let @xmath549 be a homomorphism from @xmath657 to @xmath529 and let @xmath72 be its restriction to @xmath669 .",
    "since @xmath549 preserves the colours @xmath622 the function @xmath72 takes values in @xmath670 .",
    "we claim @xmath72 is a homomorphism from @xmath2 to @xmath3 .",
    "let @xmath671 for @xmath95 .",
    "for each @xmath672 $ ] there exists a tuple @xmath673 such that @xmath674 because @xmath549 preserves the colour @xmath666 .",
    "but , in fact , @xmath675 does not depend on @xmath676 : if there would be @xmath677 $ ] such that @xmath678 , then @xmath549 would not preserve the edge `` on the left '' between @xmath679 and @xmath680 .",
    "it now suffices to show that @xmath681 , that is , @xmath682 for all @xmath672 $ ] ( where we write @xmath683 ) . if this would fail for @xmath672 $ ] , then @xmath684 while @xmath685 , contradicting that @xmath549 is a homomorphism .",
    "thus , @xmath686 defines a parameterized reduction from @xmath1 to @xmath687 where @xmath688 is a class of graphs .",
    "we are left to show that this reduction is quantifier - free after a pre - computation .",
    "it is here where we are going to use the assumption that @xmath0 has bounded arity .",
    "it suffices to show that some isomorphic copy of @xmath529 can be produced from @xmath689 by a suitable interpretation @xmath425 where @xmath477 is some auxiliary structure .",
    "it will be clear that @xmath425 and @xmath477 are computable from @xmath423 .",
    "the dimension of @xmath425 is @xmath690 where @xmath691 bounds the arity of @xmath0 .",
    "if @xmath2 has vocabulary @xmath40 , the auxiliary structure @xmath477 is @xmath692))^*$ ] , i.e. take the @xmath73-structure with universe @xmath693)$ ] and add colours for the elements .",
    "the interpretation produces the isomorphic copy of @xmath529 where @xmath694 is replaced by @xmath695 where @xmath696 is a @xmath697-tuple of @xmath698s .",
    "similarly , @xmath699 is replaced by @xmath700 with an @xmath462-tuple of @xmath698s .",
    "recall , @xmath529 has vocabulary @xmath701 . letting @xmath58 and @xmath702 be @xmath462-tuples of variables ,",
    "the interpretation @xmath425 reads as follows .",
    "abbreviate for @xmath703 $ ] @xmath704\\setminus[{\\mathrm{ar}}(r)]}(p_1x_j\\wedge c_0x_j),\\\\ \\textit{right}(z\\bar x)&:=&\\textstyle p_2z\\wedge \\bigwedge_{j\\in[r]}(p_1x_j\\wedge c_0x_j),\\end{aligned}\\ ] ] and define @xmath705 } \\textit{left}_{r , i}(z\\bar x)\\vee \\textit{right}(z\\bar x),\\\\ \\varphi_{c_{(r,\\bar a , i)}}(z\\bar x)&:=&\\textit{left}_{r , i}(z\\bar x),\\\\ \\varphi_{c_a}(z\\bar x)&:=&\\textit{right}(z\\bar x),\\\\ \\varphi_e(z\\bar x , z'\\bar x')&:= & \\varphi'_{e}(z\\bar x , z'\\bar x')\\vee \\varphi'_{e}(z'\\bar x',z\\bar x),\\end{aligned}\\ ] ] where @xmath706}\\big(\\big(\\textit{left}_{r , i}(z\\bar x)\\wedge   \\bigvee_{i'\\in[r]\\setminus\\{i\\}}\\textit{left}_{r , i'}(z'\\bar x')\\wedge\\bigwedge_{j\\in[r]}x_j = x'_j\\big)\\\\ & & \\qquad\\qquad\\qquad\\qquad\\textstyle \\ \\vee\\ \\big(\\textit{left}_{r , i}(z\\bar x)\\wedge\\textit{right}(z'\\bar x ' ) \\wedge z'=x_i\\big)\\big).\\end{aligned}\\ ] ]    [ [ case-2 ] ] case 2 + + + + + +    suppose @xmath0 has bounded treewidth . then @xmath707 and by the hierarchy theorem there exists a class of forests @xmath14 such that @xmath708 .",
    "moreover , we can assume that @xmath14 is computably enumerable and closed under deleting proper ( connected ) components since so are the classes of graphs listed in this theorem .",
    "theorem  [ theo : dechom ] implies that @xmath709 , so it suffices to show @xmath644 .",
    "the proof of this is similar to the proof of theorem  [ theo : dechom ] .",
    "there is a @xmath23 such that for every @xmath606 there exists @xmath525 such that @xmath2 has an @xmath19-decomposition .",
    "given an instance @xmath605 of @xmath607 with @xmath710 compute @xmath525 and a @xmath19-decomposition @xmath165 of @xmath2 of width @xmath23 .",
    "as in the proof of theorem  [ theo : dechom ] we can assume that each component of @xmath19 either has all its bags empty or all its bags nonempty .",
    "we can even assume that all bags are nonempty - otherwise use the above closure assumption on @xmath14 and throw away all components with empty bags .",
    "define @xmath529 as in the proof of theorem  [ theo : dechom ] , now with @xmath80 replacing @xmath527 there .",
    "we show @xmath711 the direction from left to right is seen as in the proof of theorem  [ theo : dechom ] .",
    "conversely , let @xmath541 be a homomorphism from @xmath540 to @xmath529 and let @xmath712 be a component of @xmath2 . choose a component , i.e. a tree , @xmath583 of @xmath19 such that @xmath713 is a tree decomposition of @xmath712",
    ". for @xmath586 define @xmath714 as in the proof of theorem  [ theo : dechom ] .",
    "again we show that @xmath715 is a homomorphism from @xmath712 to @xmath3 . to see this ,",
    "let @xmath38 be a relation symbol in the vocabulary of @xmath2 and @xmath716 .",
    "then the components of @xmath61 form a clique in @xmath717 .",
    "it is well - known for tree decompositions , that cliques are contained in some bag ( see e.g. ( * ? ? ?",
    "* lemma  4 ) ) , that is , there is @xmath586 such that @xmath22 contains all components of @xmath61 . as @xmath714 is a partial homomorphism from @xmath712 to @xmath3 and contains @xmath61 in its domain",
    ", we get @xmath718 as desired .    that @xmath719 is quantifier - free after a pre - computation is seen as in the proof of theorem  [ theo : dechom ] .",
    "the last two lemmas imply :    [ cor : graph ] suppose @xmath0 has bounded arity .",
    "then @xmath720    ( theorem  [ theo : coregraphhom ] ) note that with @xmath0 also @xmath721 is computably enumerable .",
    "we thus get @xmath722 by corollaries  [ cor : core ] and [ cor : graph ] , respectively .",
    "this shows the first equivalence in theorem  [ theo : coregraphhom ] .",
    "the second follows from theorem  [ theo : dechom ] .",
    "a _ game vector _ is a tuple @xmath723 where @xmath724 .",
    "we say @xmath725 has @xmath462 _ rounds _ and @xmath726}p_i$ ] _",
    "pebbles_. let @xmath2 , @xmath3 be similar structures .",
    "duplicator winning strategy for the @xmath725-game on @xmath727 _ is a sequence @xmath728 of partial homomorphisms from @xmath2 to @xmath3 satisfying the following conditions :    * for each @xmath729 with @xmath730 , the set @xmath731 contains a mapping with domain @xmath44 .",
    "* for each @xmath676 with @xmath732 , if @xmath733 , @xmath44 is a superset of @xmath734 with @xmath735 , then @xmath736 contains an extension @xmath119 of @xmath118 with domain @xmath44 .",
    "we write @xmath737 to indicate that such a winning strategy exists .",
    "[ prop : transitivity - of - strategy ] the @xmath738 relation is transitive , that is , when @xmath2 , @xmath3 , and @xmath739 are similar structures , if @xmath737 and @xmath740 , then @xmath741 .",
    "let @xmath728 be a duplicator winning strategy for the @xmath725-game on @xmath727 , and let @xmath742 be a duplicator winning strategy for the @xmath725-game on @xmath743 .",
    "for each @xmath744 $ ] , define @xmath745 to be the set @xmath746 .",
    "it is straightforward to verify that @xmath747 is a duplicator winning strategy for the @xmath725-game on @xmath748 .",
    "let @xmath749 be a game vector .",
    "a _ @xmath725-decomposition _ of a structure @xmath2 is an @xmath19-decomposition @xmath20 such that :    * @xmath19 is a rooted forest of height @xmath750 , * for each node @xmath72 of @xmath19 at level @xmath751 , it holds that @xmath752 , and * when @xmath150 and @xmath753 are at levels @xmath676 and @xmath754 , respectively , it holds that @xmath755 and @xmath756 .    by the _ level _ of a node in a rooted forest",
    ", we refer to the number of vertices in the unique path from the root ( of the node s component ) to the node .",
    "so , roots are considered to be at level @xmath751 .    [ prop : hom - gives - strategy ] if @xmath2 and @xmath3 are structures such that there exists a homomorphism @xmath72 from @xmath2 to @xmath3 , then for any game vector @xmath725 , there is a duplicator winning strategy for the @xmath725-game on @xmath727 .    such a strategy is given by taking @xmath757 to be the set containing each restriction of @xmath72 to a subset @xmath729 with @xmath758 .",
    "[ thm : strategy - to - hom ] let @xmath749 be a game vector , and let @xmath759 be similar structures and assume that @xmath107 has a @xmath725-decomposition .",
    "if there exists a duplicator winning strategy for the @xmath725-game on @xmath760 , then there is a homomorphism from @xmath107 to @xmath3 .",
    "let @xmath19 be a forest such that @xmath20 gives a @xmath725-decomposition of @xmath107 .",
    "for each @xmath312 , we define a map @xmath761 from @xmath22 to @xmath3 that is a partial homomorphism from @xmath107 to @xmath3 , in the following inductive manner .",
    "let @xmath728 be a duplicator winning strategy for the @xmath725-game . for each root @xmath305 of @xmath19",
    ", define @xmath762 to be a map in @xmath731 that is defined on @xmath336 .",
    "when node @xmath549 is the child ( in @xmath19 ) of a node @xmath72 at level @xmath676 having @xmath761 defined , we define @xmath763 to be a map in @xmath736 that is defined on @xmath764 and that extends @xmath761 ; such a map exists by the definition of duplicator winning strategy and by the definition of @xmath725-decomposition . for every element @xmath765 , by the definition of @xmath19-decomposition",
    ", there exists an @xmath312 such that @xmath766 .",
    "if for an element @xmath765 it holds that @xmath767 where @xmath72 is the parent of @xmath549 in @xmath19 , by the way in which we defined the mappings @xmath761 , @xmath763 , it holds that @xmath768 .",
    "it follows by the connectivity condition of a decomposition that for any @xmath769 such that @xmath770 , one has @xmath768 .",
    "hence the @xmath761 together naturally define a mapping @xmath408 from @xmath771 to @xmath41 , namely , the mapping given by @xmath772 .",
    "this mapping @xmath408 is a homomorphism from @xmath107 to @xmath3 , since for any tuple of a relation of @xmath107 , its entries are contained in a bag @xmath22 , and @xmath408 extends @xmath761 , which is a partial homomorphism from @xmath107 to @xmath3 defined on @xmath22 .      for each structure",
    "@xmath2 and each game vector @xmath749 , we define the structure @xmath773 as follows .",
    "let us say that a tuple @xmath774 is a _ set vector _",
    "( of @xmath725 ) if @xmath775 , @xmath776 , @xmath777 , and for each @xmath778 $ ] , it holds that @xmath779 . let @xmath44 be the set of all set vectors of @xmath725 .",
    "for a set vector @xmath780 of @xmath725 , when @xmath781 , define @xmath782 to be the smallest prefix of @xmath783 with @xmath784 ( equivalently , with @xmath785 ) , and define @xmath786 to be the set @xmath787 .",
    "the universe @xmath788 of @xmath773 is @xmath789 , and every symbol @xmath38 from the vocabulary of @xmath2 is interpreted by @xmath790    we now present two basic facts on the structure @xmath773 .",
    "[ prop : tva - has - v - decomp ] for every game vector @xmath725 and every structure @xmath2 , the structure @xmath773 has a @xmath725-decomposition .",
    "we use the notation in the definition of @xmath773 above .",
    "one can naturally define a rooted forest with vertices @xmath44 ( the set of all set vectors of @xmath725 ) by making two vectors @xmath791 adjacent if and only if @xmath792 extends @xmath783 by one entry ( or vice - versa ) ; the roots are the length @xmath751 elements of @xmath44 . with respect to this rooted forest",
    ", @xmath793 gives the desired @xmath725-decomposition .",
    "[ prop : hom - from - tva - to - a ] for each game vector @xmath725 and each structure @xmath2 , there is a homomorphism from @xmath773 to @xmath2 .    the homomorphism is the projection onto the first coordinate , that is , the mapping that sends an element @xmath794 of @xmath788 to @xmath104 .",
    "[ thm : char - strategy ] let @xmath795 be similar structures with vocabulary @xmath40 , and let @xmath749 be a game vector .",
    "the following are equivalent .    1 .",
    "there exists a duplicator winning strategy for the @xmath725-game on @xmath727 .",
    "2 .   for each structure",
    "@xmath107 on @xmath40 that has a @xmath725-decomposition , if there is a homomorphism from @xmath107 to @xmath2 , then there is a homomorphism from @xmath107 to @xmath3 .",
    "3 .   there exists a homomorphism from @xmath773 to @xmath3 .",
    "( 1 @xmath796 2 ) : we have that @xmath797 and that @xmath737 . by proposition  [ prop :",
    "hom - gives - strategy ] , we have @xmath798 . by proposition",
    "[ prop : transitivity - of - strategy ] , we have @xmath799 . we obtain @xmath800 by theorem  [ thm : strategy - to - hom ] .",
    "( 2 @xmath796 3 ) : this is immediate from propositions  [ prop : tva - has - v - decomp ] and  [ prop : hom - from - tva - to - a ] .",
    "( 3 @xmath796 1 ) : let @xmath72 be a homomorphism from @xmath773 to @xmath3 . for each @xmath744 $ ] , define @xmath801 where @xmath802 is the map defined on @xmath803 that takes @xmath804 to @xmath805 . by the definition of @xmath773 , each @xmath757 contains only partial homomorphisms .",
    "we verify that the @xmath757 give a duplicator winning strategy , as follows .",
    "first , when @xmath806 and @xmath807 , we have that @xmath731 contains a map defined on @xmath102 , via the set vector @xmath808 .",
    "next , suppose that @xmath809 $ ] , that @xmath733 , and that @xmath102 is a superset of @xmath734 with @xmath810 .",
    "by the definition of @xmath757 , there exists a set vector @xmath783 of length @xmath676 such that @xmath811 .",
    "let @xmath792 be equal to the length @xmath812 set vector that extends @xmath783 with @xmath102 .",
    "the mapping @xmath813 has domain @xmath102 , and extends @xmath814 because for each @xmath815 , it holds that @xmath816 .",
    "let @xmath2 be a structure , and let @xmath725 be a game vector .",
    "let @xmath817 denote the classical problem @xmath818 .",
    "we say that _ the @xmath725-game solves _",
    "@xmath817 if for every structure @xmath3 similar to @xmath2 , the existence of a duplicator winning strategy for the @xmath725-game on @xmath727 implies that there is a homomorphism from @xmath2 to @xmath3 . for a class of structures @xmath0 , we say that _ the @xmath725-game solves _",
    "@xmath1 if , for each @xmath518 , the @xmath725-game solves @xmath817 .",
    "[ thm : char - v - game - solves ] let @xmath2 be a structure , and let @xmath749 be a game vector .",
    "the following are equivalent .    1 .",
    "the @xmath725-game solves @xmath817 .",
    "there exists a homomorphism from @xmath2 to @xmath773 .",
    "3 .   the structure @xmath79 has a @xmath725-decomposition .",
    "( 1 @xmath796 2 ) : by the equivalence of 1 and 3 in theorem  [ thm : char - strategy ] , and the fact that @xmath819 we have @xmath820 . then @xmath821 by the assumption that the @xmath725-game solves @xmath822 .    ( 2 @xmath796 3 ) : if @xmath821 then there is a homomorphism @xmath72 from @xmath79 to @xmath773 . by proposition  [ prop :",
    "hom - from - tva - to - a ] @xmath823 , and clearly @xmath824 , so there is a a homomorphism @xmath549 from @xmath773 to @xmath79 .",
    "it follows that @xmath825 is a homomorphism from @xmath79 to itself and thus has to be injective .",
    "hence @xmath72 is injective . by proposition  [ prop :",
    "tva - has - v - decomp ] , we know that @xmath773 has a @xmath725-decomposition @xmath826 .",
    "it is straightforward to verify that @xmath827 defined by @xmath828 is a @xmath725-decomposition of @xmath79 ; here , @xmath829 denotes the universe of @xmath79 .",
    "( 3 @xmath796 1 ) : suppose that @xmath737 ; we want to show that @xmath71 . since @xmath830",
    ", we have @xmath831 ( by proposition  [ prop : hom - gives - strategy ] ) . by the transitivity of @xmath738 ( proposition  [ prop : transitivity - of - strategy ] )",
    ", we have @xmath832 , and by theorem  [ thm : strategy - to - hom ] , we obtain @xmath833 . as @xmath824 , we may conclude that @xmath71 .      [ thm : pebbles - td ] ( correspondence between number of pebbles and tree depth ) let @xmath0 be a set of structures , let @xmath10 denote @xmath600 , and let @xmath151 .",
    "the following are equivalent .    1 .",
    "there exists a game vector @xmath725 with @xmath25 pebbles such that the @xmath725-game solves @xmath1 .",
    "2 .   the @xmath834-game solves @xmath1 .",
    "3 .   the set @xmath10 has tree depth @xmath835 .",
    "( 1 @xmath836 2 ) : the implication from 2 to 1 is immediate .",
    "to prove that 1 implies 2 , let @xmath749 be a game vector with @xmath726 } p_i = n$ ] ; it suffices to show that if there is a duplicator winning strategy @xmath837 for the @xmath838-game , then there is a duplicator winning strategy for the @xmath725-game .",
    "the sequence @xmath839 is straightforwardly verified to be a duplicator winning strategy for the @xmath725-game .",
    "( 2 @xmath836 3 ) : by appeal to theorem  [ thm : char - v - game - solves ] , it suffices to show that each graph in @xmath10 has a @xmath838-decomposition if and only if condition 3 holds . for the forward direction ,",
    "let @xmath20 be a @xmath838-decomposition of a graph @xmath127 with respect to the rooted forest @xmath19 . by removing any vertex @xmath312 with @xmath840 and by contracting together adjacent vertices @xmath769 with @xmath841",
    ", we obtain that each root of @xmath19 has @xmath842 and that each node @xmath549 having a parent @xmath72 satisfies @xmath843 and @xmath844 .",
    "rename each root @xmath845 by the unique element in @xmath764 and rename each @xmath845 with a parent @xmath72 by the unique element that is in @xmath846 ; then , it holds that the new @xmath19 has height @xmath835 , and witnesses that the tree depth of @xmath18 is @xmath835 . for the backward direction ,",
    "let @xmath107 be a rooted tree of height @xmath835 witnessing that a component @xmath102 of a graph @xmath847 has tree depth @xmath835 .",
    "the component @xmath102 has a @xmath838-decomposition given by @xmath142 defined by @xmath848 ; this is straightforwardly verified . combining the @xmath838-decompositions of the components of @xmath18",
    ", we obtain the desired decomposition of @xmath18 .    note that in particular , theorem  [ thm : pebbles - td ] implies that for a single structure @xmath2 , the number of pebbles needed to solve @xmath849 is equal to the tree depth plus one .",
    "we now study the number of rounds needed to solve a problem @xmath1 .",
    "note that this question has an asymptotic nature : in the case that @xmath0 consists of a single structure , one can solve @xmath1 in one round , that is , by the @xmath725-game where @xmath725 is the one - round vector @xmath850 .",
    "( correspondence between number of rounds and stack depth ) let @xmath0 be a set of structures , let @xmath10 denote @xmath600 , and let @xmath851 .",
    "the following are equivalent .    1 .",
    "there exists a game vector @xmath725 with @xmath690 rounds such that the @xmath725-game solves @xmath1 .",
    "2 .   @xmath852 .",
    "3 .   the set @xmath10 has bounded tree depth and stack depth @xmath853 .",
    "( 1 @xmath836 2 ) : by appeal to theorem  [ thm : char - v - game - solves ] , it suffices to show that each graph in @xmath10 has a @xmath725-decomposition if and only if @xmath852 . for the forward direction , denote @xmath725 by @xmath854 .",
    "we have by definition that a @xmath725-decomposition is a @xmath19-decomposition for a rooted forest @xmath19 of height @xmath853 .",
    "also , it follows from definition that each bag @xmath22 has size @xmath855 .",
    "thus @xmath10 has @xmath856-decompositions of bounded width , and by proposition  [ prop : decomposition - vs - deconstruction ] , we obtain @xmath852 . for the backward direction , by proposition  [ prop : decomposition - vs - deconstruction ] , we have that there exists @xmath217 such that @xmath10 has @xmath856-decompositions of width @xmath321",
    ". when @xmath857 and @xmath20 is a @xmath19-decomposition of width @xmath321 for a graph @xmath18 , define @xmath858 by @xmath859 where the union is over all ancestors @xmath104 of @xmath72 .",
    "it is readily seen that @xmath858 is a @xmath860-decomposition of @xmath18 .",
    "( 2 @xmath836 3 ) : by proposition  [ prop : bounded - characterizations ] , whenever condition 2 holds , @xmath10 has bounded tree depth .",
    "hence , the desired equivalence follows from lemma  [ lemma : stack - depth - placement ] .",
    "for a class of structures @xmath0 consider the classical problem @xmath861 in this section we prove the following .",
    "[ thm : logchar ] assume @xmath862 and let @xmath863 have bounded arity .",
    "then the following are equivalent .    1 .",
    "@xmath600 has bounded tree depth .",
    "2 .   @xmath864 .",
    "this result characterizes the classical homomorphism problems in logarithmic space .",
    "the characterization is conditional on the hypothesis @xmath862 , an hypothesis from parameterized complexity theory .",
    "the class path has been discovered by elberfeld et al .",
    "@xcite and is defined as follows .    a parameterized problem @xmath865 is in if and only if there are a computable @xmath401 and a nondeterministic turing machine @xmath866 that accepts @xmath389 and for all inputs @xmath391 and all runs on it uses space @xmath867 and performs at most @xmath868 many nondeterministic steps .",
    "one can argue that path is a natural and important parameterized class , e.g.  there are some fundamental problems which turn out to be complete for path under @xmath869 .",
    "the above characterization further underlines its importance .",
    "we refer to @xcite for more information . here , we just mention the following result .    [ prop : pathcomplete ] @xmath9 is complete for under @xmath869 .",
    "[ lem : vgame - in - l ] for each game vector @xmath725 , the problem there exists a logarithmic space algorithm that , given as input a pair @xmath727 of similar structures , decides if there exists a duplicator winning strategy for the @xmath725-game .",
    "write @xmath870 and @xmath871 } p_i$ ] .",
    "for an instance @xmath448 of @xmath33 consider the following boolean formula in the variables @xmath872 for @xmath873 : @xmath874 further , consider the assignment evaluating @xmath875 by 1 or 0 depending on whether @xmath876\\}$ ] is a partial homomorphism from @xmath2 to @xmath3 or not .",
    "this assignment satisfies the formula if and only if @xmath737 .",
    "both the formula and the assignment are computable from @xmath448 in logarithmic space , and so is the truth value .",
    "( theorem  [ thm : logchar ] ) ( 1 @xmath796 2 ) let @xmath877 bound the tree depth of @xmath600 . by theorem  [ thm",
    ": pebbles - td ] , the @xmath725-game solves @xmath33 where @xmath878 .",
    "it follows that @xmath879 .",
    "this problem is in l by lemma  [ lem : vgame - in - l ] and the assumption @xmath863 .",
    "( 1 @xmath796 2 ) first observe that @xmath880 : this follows from our assumption @xmath862 and proposition  [ prop : pathcomplete ] because path is @xmath869-closed .",
    "we assume that @xmath600 has unbounded tree depth and claim @xmath881 .",
    "lemma  [ lemma : placing - g ] implies that @xmath882 . by theorem  [ theo : dechom ]",
    "( and lemma  [ lem : plred ] ) we get @xmath883 . but",
    "the latter problem is @xmath884 by theorem  [ theo : coregraphhom ] . since @xmath880 we conclude @xmath885 .",
    "this clearly implies that the classical problem @xmath33 is not in l.",
    "in this section we study the complexity of the parameterized model - checking problems associated with sets of ( first - order ) sentences @xmath886 , namely @xmath887 here , @xmath888 is a natural number coding in some straightforward sense the sentence @xmath49 .",
    "existential _ sentence is one in which the quantifier @xmath889 does not occur and negation symbols @xmath890 appear only in front of atoms .",
    "a _ primitive positive _ sentence is one built from atoms by means of @xmath891 and  @xmath892 . for @xmath893 let @xmath894 $ ] and @xmath895}$ ] denote the sets of existential and , respectively , primitive positive sentences of quantifier rank at most @xmath896 where all appearing relation symbols have arity at most @xmath462 .",
    "the proof proceeds by standard means defining a `` canonical query ''  @xcite .",
    "details follow . given a tree @xmath901 and @xmath902",
    "we define a primitive positive formula @xmath903 such that for every structure @xmath2 similar to @xmath904 and every @xmath81 @xmath905 moreover , @xmath906 for @xmath72 the height of @xmath107 when rooted at @xmath462 .",
    "we give the definition by induction on @xmath72 .",
    "for @xmath907 the tree @xmath107 consists of one node @xmath462 , and we set @xmath908 . otherwise , let @xmath909 list the neighbors of @xmath462 in @xmath107 . for @xmath910 $ ] let @xmath911 denote the connected component of @xmath912 containing  @xmath913",
    ". then @xmath911 rooted at @xmath913 has height at most @xmath914 , so @xmath915 is defined and we can set @xmath916 } \\exists y(exy\\wedge \\varphi_{{\\mathbf{t}}_i , t_i}(y)).\\ ] ]    given an instance @xmath917 of @xmath918 , the forest @xmath108 is the disjoint union of , say , @xmath291 many trees @xmath919 . for @xmath920",
    "$ ] choose a root @xmath921 witnessing that @xmath922 has height at most @xmath923 and set @xmath924}\\exists x\\varphi_{{\\mathbf{t}}_i , r_i}(x)$ ] .",
    "then @xmath925 is a reduction as desired .",
    "given an instance @xmath927 of @xmath928)}$ ] , let @xmath428 denote the vocabulary of @xmath49 .",
    "for each @xmath435 choose a new relation symbol @xmath929 of the same arity .",
    "the reduction maps @xmath927 to @xmath930 where @xmath477 expands @xmath2 interpreting every new symbol @xmath929 by @xmath931 .",
    "the sentence @xmath932 is obtained from @xmath49 by replacing every subformula of the form @xmath933 by @xmath934 , and then moving disjunctions out using the equivalence @xmath935 and de morgan rules .",
    "this preserves the quantifier rank .",
    "it is easy to see that @xmath936 is a reduction as desired .",
    "given an instance @xmath939 of @xmath940})}$ ] we can assume that the existential quantifiers in @xmath49 quantify pairwise distinct variables .",
    "following a known construction of @xcite define a structure @xmath941 interpreting the vocabulary @xmath428 of @xmath49 as follows .",
    "its universe is the set of variables of @xmath49 and a relation @xmath435 is interpreted by those tuples @xmath489 such that the atom @xmath942 appears in @xmath49 .",
    "then @xmath943 this shows @xmath940})}{\\le_{\\mathit{qfap}}}{p\\textsc{-hom}({\\mathcal{a}})}$ ] where @xmath944 } \\big\\}$ ] . note that @xmath0 is decidable and of bounded arity .",
    "we claim that @xmath945 .",
    "we argue similarly as in  ( * ? ? ?",
    "* theorem  3.12 ) . define a graph on the universe of @xmath941 , i.e.  the variables of @xmath49 , by putting an edge between @xmath950 and @xmath951 if an only if @xmath952 and @xmath953 are consecutive quantifiers in the formula tree of @xmath49 .",
    "this graph is a forest @xmath954 of height at most @xmath923 when we root each component by the first - quantified variable in it , i.e. the variable which is closest to the root in the formula tree of @xmath49 .",
    "the closure of @xmath954 contains @xmath955 : if @xmath956 then there exists @xmath435 and a tuple @xmath489 of variables containing @xmath950 and @xmath951 such that @xmath942 appears in @xmath49 ; since @xmath49 is a sentence every variable in @xmath489 and especially @xmath950 and @xmath951 are quantified in @xmath49 , so @xmath952 and @xmath953 appear on some branch in the formula tree of @xmath49 ; this means there is a path from @xmath950 to @xmath951 in @xmath954 , so @xmath957 is in the closure of @xmath954 .",
    "let an instance @xmath960 of @xmath961})}$ ] be given , where @xmath268 is a positive natural and @xmath962}$ ] for all @xmath963 $ ] .",
    "for @xmath963 $ ] let @xmath964 be the output of the reduction of the previous lemma . then @xmath965 , so @xmath966 is a disjoint union of , say , @xmath967 many trees @xmath968 .",
    "then @xmath969:{\\mathbf{b}}\\models\\varphi_i\\\\\\nonumber & \\longleftrightarrow&\\exists i\\in[k ] : { \\mathbf{f}}^*_i{\\stackrel{h}{\\to}}{\\mathbf{b}}_i\\\\\\nonumber & \\longleftrightarrow&\\exists i\\in[k]\\ \\forall j\\in[c_i ] : { \\mathbf{t}}^*_{ij}{\\stackrel{h}{\\to}}{\\mathbf{b}}_i\\\\\\label{eq : skolemtuple } & \\longleftrightarrow&\\textstyle \\forall\\bar\\jmath\\in\\prod_{i\\in[k]}[c_i]\\ \\exists i\\in[k]:{\\mathbf{t}}^*_{ij_i}{\\stackrel{h}{\\to}}{\\mathbf{b}}_i,\\end{aligned}\\ ] ] where we write @xmath970 .",
    "we can assume that the @xmath971 s are pairwise disjoint and for each of them a root is chosen witnessing that it has height at most @xmath923 .",
    "fix some @xmath972}[c_i]$ ] .",
    "define the tree @xmath973 as follows : take the ( disjoint ) union of the trees @xmath974 and then merge their roots to a new node @xmath462 .",
    "then @xmath462 witnesses that @xmath975 and all @xmath976,$ ] are subtrees of @xmath973 pairwise intersecting precisely in @xmath462 .",
    "we define a structure @xmath977 such that @xmath978:{\\mathbf{t}}^*_{ij_i}{\\stackrel{h}{\\to}}{\\mathbf{b}}_i&\\longleftrightarrow&{\\mathbf{t}}^*_{\\bar\\jmath}{\\stackrel{h}{\\to}}{\\mathbf{b}}^{\\bar\\jmath}.\\end{aligned}\\ ] ] the structure @xmath977 is the disjoint union of the structures @xmath979,$ ] defined next . to ensure  ( [ eq : bigt ] ) it suffices that @xmath980 satisfies @xmath981 indeed , assuming ( [ eq : bibarj ] ) for every @xmath963 $ ] we derive ( [ eq : bigt ] ) as follows .",
    "if @xmath982 for some @xmath676 , then @xmath983 for such an @xmath676 by  ( [ eq : bibarj ] ) and , clearly , this implies @xmath984 .",
    "conversely , assume @xmath984 .",
    "since @xmath985 is connected , any homomorphism from @xmath985 to @xmath977 has image in some @xmath980 , i.e.  @xmath986 for some @xmath676 ; for such an @xmath676 then ( [ eq : bibarj ] ) implies @xmath982 .",
    "given @xmath987 it is not hard to define @xmath980 such that ( [ eq : bibarj ] ) is satisfied .",
    "first forget all interpretations of symbols outside the vocabulary of @xmath985 : these are all colours @xmath988 for @xmath989 as well as @xmath990 where @xmath991 is the root chosen for @xmath992 . to get a structure in the vocabulary of @xmath985",
    ", we add interpretations of @xmath988 for @xmath993 : all these @xmath988 are interpreted by @xmath994 . finally , we add loops to the elements in @xmath994 , i.e. set @xmath995 then ( [ eq : bibarj ] ) is straightforwardly verified , and thus we know  ( [ eq : bigt ] ) .",
    "finally , let @xmath108 be the disjoint union of the trees @xmath996}[c_i]$ ] , that is , make disjoint copies of the @xmath973 s and then take the union .",
    "for every @xmath997 every node @xmath998 has a copy @xmath999 in @xmath1000 .",
    "we adapt @xmath977 by renaming @xmath988 by @xmath1001 , more precisely , let @xmath1002 be the structure with universe @xmath1003 interpreting @xmath86 by @xmath1004 and @xmath1001 by @xmath1005 for @xmath998 .",
    "this structure is the disjoint union of @xmath1006,$ ] where @xmath1007 is obtained by analoguous renaming applied to @xmath1008 .",
    "then the disjoint union @xmath529 of the @xmath1009}[c_i],$ ] is similar to @xmath1010 , and @xmath1011}[c_i ] : { \\mathbf{t}}^*_{\\bar\\jmath}{\\stackrel{h}{\\to}}{\\mathbf{b}}^{\\bar\\jmath}\\\\ & \\longleftrightarrow & { \\mathbf{f}}^*{\\stackrel{h}{\\to}}{\\mathbf{b } } ' . \\end{aligned}\\ ] ] the first equivalence follows from ( [ eq : bigt ] ) and ( [ eq : skolemtuple ] ) , and the second is trivial .",
    "it is clear that @xmath1012 can be computed from @xmath1013 .",
    "we show how to get a structure isomorphic to @xmath529 by a suitable interpretation from @xmath1014 where @xmath2 is a suitable auxiliary structure .",
    "choose @xmath481 for the reduction used above , i.e.  the one producing @xmath964 from @xmath1015 .",
    "choose @xmath420 such that @xmath105 maps numbers to interpretations of dimension @xmath23 .",
    "for @xmath963 $ ] write @xmath1016 and note @xmath1017 .",
    "we define our auxiliary structure to be @xmath1018)^*\\ , \\",
    "( \\prod_{i\\in[k]}[c_i])^*\\ \\big\\rangle.\\ ] ] note @xmath1019)$ ] is the @xmath73-structure with universe @xmath230 $ ] .",
    "there is a quantifier - free formula @xmath1020 that defines in @xmath449 the union of ( the copies of ) the universes of @xmath1021 and the universe of @xmath3 let @xmath1022 be obtained from @xmath1023 by replacing each formula @xmath1024 in @xmath1023 by @xmath1025 . then @xmath1026 .    in the following",
    "we understand that @xmath676 ranges over @xmath230 $ ] and @xmath997 over @xmath1027}[c_i]$ ] .",
    "it is easy to construct an interpretation of dimension 1 producing @xmath980 from @xmath987 .",
    "combining this interpretation with @xmath1022 according to lemma  [ lem : int ] gives a quantifier - free interpretation @xmath1028 of dimension @xmath23 such that @xmath1029 .",
    "as @xmath980 is obtained by renaming colours we get @xmath1030 with @xmath1031 .",
    "the structure we want to produce is the disjoint union of @xmath1032 .",
    "let @xmath1033 be @xmath23-tuples of variables and let @xmath1034 and @xmath1035 be the formulas in @xmath1030 .",
    "define an interpretation @xmath502 of dimension @xmath1036 as follows .",
    "@xmath1037 where @xmath676 is the unique index such that @xmath1038",
    ". then @xmath1039 is isomorphic to the disjoint union of the family @xmath1040 , i.e.@xmath1041 as desired .",
    "( theorem  [ theo : modcheck ] ) applying lemmas  [ lem : oed ] , [ lem : mainmc ] and [ lem : canquery ] in row , we get @xmath898)}{\\le_{\\mathit{qfap}}}{p\\textsc{-mc}({\\textsc{dpp}^{q}[r ] } ) } { \\le_{\\mathit{qfap}}}{p\\textsc{-hom}({\\mathcal{f}}^*_{q-1})}{\\le_{\\mathit{qfap}}}{p\\textsc{-mc}({\\textsc{pp}^{q}[2]})}.\\ ] ] noting @xmath1042})}\\subseteq { p\\textsc{-mc}(\\sigma^q_1[r])}$ ] , theorem  [ theo : modcheck ] follows .",
    "a.  atserias and m.  weyer .",
    "decidable relationships between consistency notions for constraint satisfaction problems . in _ proc .",
    "18th annual conference of the european association for computer science logic ( csl ) _",
    ", pages 102116 , 2009 .",
    "hubie chen and vctor dalmau .",
    "beyond hypertree width : decomposition methods without decompositions . in _ eleventh international conference on principles and practice of constraint programming _ ,",
    "pages 167181 , 2005 .",
    "nicole schweikardt , thomas schwentick , and luc segoufin .",
    "database theory : query languages . in mikhail",
    "j. atallah and marina blanton , editors , _ algorithms and theory of computation handbook _ , volume 2 : special topics and techniques , chapter  19 .",
    "crc press , second edition , nov 2009 ."
  ],
  "abstract_text": [
    "<S> we study the problem of conjunctive query evaluation over sets of queries ; this problem is formulated here as the relational homomorphism problem over a set of structures @xmath0 , wherein each instance must be a pair of structures such that the first structure is an element of @xmath0 . </S>",
    "<S> we present a comprehensive complexity classification of these problems , which strongly links graph - theoretic properties of @xmath0 to the complexity of the corresponding homomorphism problem . </S>",
    "<S> in particular , we define a binary relation on graph classes and completely describe the resulting hierarchy given by this relation . </S>",
    "<S> this binary relation is defined in terms of a notion which we call graph deconstruction and which is a variant of the well - known notion of tree decomposition . </S>",
    "<S> we then use this graph hierarchy to infer a complexity hierarchy of homomorphism problems which is comprehensive up to a computationally very weak notion of reduction , namely , a parameterized form of quantifier - free reductions . </S>",
    "<S> we obtain a significantly refined complexity classification of homomorphism problems , as well as a unifying , modular , and conceptually clean treatment of existing complexity classifications . </S>",
    "<S> we also present and develop the theory of pebble games which solve the homomorphism problems where the cores of the structures in @xmath0 have bounded tree depth ; as a fruit of this development , we characterize the homomorphism problems solvable in logarithmic space . </S>",
    "<S> we also use our framework to classify the complexity of model checking existential sentences having bounded quantifier rank .    </S>",
    "<S> [ section ] [ theorem]conjecture [ theorem]corollary [ theorem]example [ theorem]examples [ theorem]proposition [ theorem]proposition [ theorem]lemma [ theorem]definition [ theorem]remark </S>"
  ]
}