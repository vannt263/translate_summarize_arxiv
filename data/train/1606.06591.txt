{
  "article_text": [
    "a histogram with @xmath0 bins for a given probability density function ( pdf ) @xmath1 is used to estimate the probabilities @xmath2 that a random event belongs to bin @xmath3 : @xmath4 integration in ( [ p1 ] ) is carried out over the bin @xmath5 and @xmath6 .",
    "a histogram can be obtained as a result of a random experiment with the pdf @xmath1 .",
    "a frequently used technique in data analysis is to compare two distributions through comparison of histograms .",
    "the hypothesis of homogeneity states that two histograms represent random values with identical distributions @xcite .",
    "it is equivalent to the existing @xmath0 constants @xmath7 , such that @xmath8 , and the probability of belonging to the @xmath3@xmath9 bin for some measured value in both experiments is equal to @xmath2 .",
    "let us denote the numbers of random events belonging to the @xmath3@xmath9 bin of the first and second histogram as @xmath10 and @xmath11 , respectively .",
    "the total number of events in the histograms is equal to @xmath12 , where @xmath13 .",
    "it has been shown by pearson @xcite that the goodness of fit test statistic @xmath14 has approximately a @xmath15 distribution . for two statistically independent histograms with probabilities @xmath7 ,",
    "the statistic @xmath16 has approximately a @xmath17 distribution .",
    "if the probabilities @xmath7 are not known , the estimation of @xmath2 is carried out by the following expression : @xmath18 as shown in @xcite . by substituting expression ( [ phat1 ] ) in ( [ basic2 ] ) , the statistic @xmath19 is obtained .",
    "this statistic has approximately a @xmath15 distribution because @xmath20 parameters are estimated @xcite .",
    "the statistic ( [ xsquar1 ] ) was first proposed in @xcite and is widely used to test the hypothesis of homogeneity .    a weighted histogram or a histogram with weighted events @xcite is used to estimate the probabilities @xmath2 ( [ p1 ] ) as well .",
    "the sum of weights of events for the bin @xmath3 is defined as : @xmath21 where @xmath22 is the number of events in the bin @xmath3 and @xmath23 is the weight of the @xmath24@xmath9 event in the @xmath3@xmath9 bin .",
    "the statistic @xmath25 is used to estimate @xmath2 , where @xmath26 is a total number of events for the histogram with @xmath0 bins .",
    "weights of events are chosen in such a way that the estimate ( [ west ] ) is unbiased : @xmath27=p_i.\\ ] ]    because of the condition @xmath28 , we will further call the above defined weights ",
    "normalized \" as opposed to the unnormalized weights @xmath29 which are @xmath30 .",
    "comparison of two weighted histograms and comparison of weighted and unweighted histograms as well as fitting weights of simulated random events to an experimental histogram are all important parts of data analysis .",
    "tests for comparing weighted histograms have been developed in @xcite while tests for poisson weighted histograms have been proposed in @xcite .",
    "this paper is organized as follows . in section [ hom_test_norm ]",
    "generalization of the chi - square homogeneity test is discussed and improvements for the test are proposed .",
    "a test for histograms with unnormalized weights as well as improvements of that test are discussed in section [ hom_test_unnorm ] .",
    "tests for comparison of two poisson weighted histograms are discussed in section [ hom_pois ] .",
    "restrictions for chi - square test application are discussed in section [ rest ] .",
    "applications and verification of the tests are demonstrated using numerical examples in section [ examples ] .",
    "let us consider two histograms with normalized weights , and the subindex @xmath31 will be used to differentiate them . a total sum of weights of events @xmath32 in the @xmath3@xmath9 bin of the @xmath31@xmath9 histogram @xmath33 ;",
    "@xmath34 can be considered as a sum of random variables @xmath35 where the number of events @xmath36 is also a random value and the weights @xmath37 are independent random variables with the same pdf for a given bin @xcite .",
    "let us introduce a variable @xmath38/\\textrm e [ \\ , w_{ji}^2 ] , \\label{rati}\\ ] ] which is the ratio of the first moment to the second moment of the distribution of weights in the bin @xmath3 .",
    "let us estimate @xmath39 using @xmath40 as shown in @xcite the statistic @xmath41 where sums extend over all the bins @xmath3 , except for the bin @xmath24 , which has approximately a @xmath15 distribution and is a generalization of the pearson s statistic ( [ basic ] ) @xcite .",
    "it should be noted that it is only valid for the case when @xmath42 .",
    "the last inequality means that estimation of a covariance matrix for variables @xmath43 is positive definite .",
    "the better power of test , as was shown in @xcite , was achieved for @xmath44 , where @xmath45      following @xcite , for two statistically independent histograms with probabilities @xmath7 the statistic has approximately a @xmath15 distribution : @xmath46 the probabilities @xmath2 are not known and estimators @xmath47 can be determined by minimizing ( [ stma ] ) under the following constraints : @xmath48    the problem to determine the estimators of the probabilities @xmath49 by minimizing ( [ stma ] ) has been solved numerically by coordinate - wise optimization in @xcite . for every step , the minimum for one probability with others fixed ones can be found using the brent algorithm @xcite .    a test statistic obtained as a median value of the formula ( [ stma ] ) for a different choice of the excluded bin @xmath50",
    "was proposed in @xcite and has approximately a @xmath15 distribution if the hypothesis of homogeneity is valid .",
    "the median is calculated for the set of statistically dependent random variables @xmath51 , with each variable having approximately @xmath15 distribution @xcite . the median statistic ( [ stdavu ] )",
    "coincides with the statistic ( [ xsquar1 ] ) in case of two histograms with unweighted entries .",
    "numerical investigations of the median tests ( see section 6.1 and ref .",
    "@xcite ) show that the size of the test ( [ stdavu ] ) exceeds slightly its nominal value making it the main disadvantage of this approach .",
    "the question , what deviation from the nominal size is acceptable for chi - square methods , has different answers .    in the classical work dedicated to chi - square tests",
    "@xcite disturbance is regarded as unimportant when the nominal size of a test is @xmath52 , with the exact size lying between @xmath53 and @xmath54 , and when the nominal size of a test is @xmath55 , with the exact size lying between @xmath56 and @xmath57 . according to this criteria the disturbance of the median test can be considered unimportant .    however , according to @xcite , the disturbance of the median statistics is important .",
    "the authors of @xcite have proposed tests for comparison of histograms of an _ equivalent number of unweighted events _ with false interpretation of these tests as tests for histograms with weighted entries .",
    "the methods from @xcite are discussed in section 4 with numeric evaluation shown in subsection 6.2.1 .",
    "the median test ( [ stdavu ] ) can be improved by using the results for goodness of fit test for weighted histograms @xcite .",
    "the new test statistic is    @xmath58    the estimation of the probabilities @xmath59 is determined by minimizing ( [ stdd3 ] ) under the following constraints : @xmath60 where @xmath44 is defined as @xmath45 the test statistic asymptotically has a @xmath15 distribution and a size closer to its nominal value than the test ( [ stdavu ] ) if the hypothesis of homogeneity is valid .    the bin @xmath44 with the lowest information content is excluded to get the robust statistic @xmath61 and it is plausible that the test ( [ stdd3 ] ) has higher power than the median test ( [ stdavu ] ) .",
    "detail explanation of this choice is presented in subsection 2.3 of @xcite .",
    "in practice one is often confronted with cases when a histogram is defined up to an unknown normalization constant .",
    "let us denote bin content of histograms with unnormalized weights as @xmath62 , then @xmath63 , and the test statistic ( [ stddu ] ) can be written as @xmath64 with @xmath65 .",
    "an estimator @xmath66 for the constant @xmath67  is found in @xcite by minimizing ( [ stddc ] ) and is equal to @xmath68 substituting ( [ const ] ) for ( [ stddc ] ) and replacing @xmath69 with the estimate @xmath70 we get the test statistic    @xmath71    the estimate @xmath70 in ( [ stddc4 ] ) is calculated in the same way as the estimate @xmath72 in ( [ rat4 ] ) .",
    "the statistic ( [ stddc4 ] ) has approximately a @xmath73 distribution .",
    "following @xcite , for two statistically independent histograms with probabilities @xmath74 , the statistic @xmath75 has approximately a @xmath73 distribution .",
    "an estimation of the probabilities @xmath47 can be found by minimizing ( [ st5 ] ) under the following constraints : @xmath76 the probabilities @xmath77 can be calculated numerically in the same way as described in section [ hom_test_norm ] . a test statistic that is  invariant \" to the choice of the excluded bin",
    "can be obtained again as a median value of ( [ stdav2 ] ) for all possible choices of the excluded bin @xmath78 the statistic @xmath79 for the case of comparing two histograms with normalized and unnormalized weights can be given by the same formulas ( [ st5][stdav2 ] ) with @xmath80 .",
    "both statistics @xmath81 and @xmath79 have approximately a @xmath73 distribution if the hypothesis of homogeneity is valid",
    ".      the median test ( [ stdav2 ] ) can be improved by using the results for goodness of fit test for weighted histograms @xcite .",
    "a new test statistic is @xmath82 estimation of the probabilities @xmath77 can be determined by minimizing ( [ stddc5 ] ) under the following constraints : @xmath83 where @xmath44 is defined as @xmath84    the test statistic asymptotically has a @xmath73 distribution and a size closer to its nominal value .",
    "it is plausible that the test ( [ stddc5 ] ) has higher power than the test ( [ stdav2 ] ) .",
    "the statistic @xmath85 for the case of comparing two histograms with normalized and unnormalized weights can be given by the same formulas ( [ stddc5][cho ] ) with @xmath86 .",
    "both statistics @xmath87 and @xmath85 have approximately a @xmath73 distribution if the hypothesis of homogeneity is valid .",
    "a poisson histogram @xcite is defined as a histogram with multi - poisson distributions of a number of events for bins : @xmath88 where @xmath89 is a free parameter .",
    "the probability distribution function ( [ pooo ] ) can be represented as a product of two probability functions : a poisson probability distribution function for a number of events @xmath90 with the parameter @xmath89 and a multinomial probability distribution function of a number of events for bins of the histogram , with a total number of events equal to @xmath90 @xcite : @xmath91    a poisson histogram can be obtained as a result of two random experiments , namely when a first experiment with a poisson probability distribution function gives us a total number of events in the histogram @xmath90 and then a histogram is obtained as a result of a random experiment with a pdf @xmath1 and with a total number of events equal to @xmath90 .    the concept of an _ equivalent number of unweighted events _ has been introduced in @xcite . an _ equivalent number of unweighted events _ for @xmath3@xmath9 bin of weighted histogram is @xmath92 .",
    "the authors proposed two test statistics for comparison of histograms with _",
    "equivalent number of unweighted events _ contents of bins .",
    "these statistics were interpreted in @xcite as statistics for comparison of original poisson weighted histograms .",
    "the first statistic @xmath93 , in our notation , can be written as @xmath94 the parameter @xmath95 @xcite is taken equal to @xmath96 the statistic ( [ pois ] ) according to @xcite has a @xmath97 distribution if the hypothesis of homogeneity is valid .",
    "+      the parameter @xmath95 can also be estimated @xcite . here",
    "an estimator @xmath98 was found by minimizing ( [ pois ] ) and is equal to @xmath99    the second statistic @xmath100 has a @xmath15 distribution if the hypothesis of homogeneity is valid @xcite .",
    "the use of the chi - square test @xmath101 ( [ xsquar1 ] ) for the histograms with unweighted entries is inappropriate if any expected frequency @xmath102 or @xmath103 or if the total number of bins with the expected frequency @xmath102 or @xmath104 exceeds @xmath105 of the total number @xmath106 of bins @xcite .",
    "restrictions for weighted histograms can be obtained by replacing the above mentioned expected frequencies with expected frequencies of the _ equivalent number of unweighted events_. for the test @xmath61([stdd3 ] ) they must be replaced with @xmath107 and @xmath108 , while for the test @xmath87 ( [ stddc5 ] ) with @xmath109 and @xmath110 .",
    "the hypothesis of homogeneity @xmath111 is rejected if the value of the test statistic @xmath61 is above a given threshold .",
    "the threshold @xmath112 for a given nominal size of the test @xmath113 can be defined from the equation @xmath114 where @xmath115 .",
    "let us define the test size @xmath116 for a given nominal size of the test @xmath113 as the probability @xmath117 i.e.  the probability that the hypothesis @xmath111 will be rejected if the distribution of the weights @xmath32 , @xmath118 , for the bins of the histograms satisfies the hypothesis @xmath111 .",
    "the deviation of a test size from its nominal value is an important test characteristic .",
    "a second important characteristic of the test is its power @xmath119 @xmath120 i.e.   the probability that the hypothesis of homogeneity @xmath111 will be rejected if the distributions of the weights @xmath32 , @xmath33 ; @xmath121 of the compared histograms do not satisfy the hypothesis @xmath111 .    the same definitions with @xmath122 in the formula ( [ kalfa ] )",
    "can be used for the test statistic @xmath123 ( [ stddc5 ] ) .",
    "let us consider an example of a weighted histogram for estimation of the probability @xmath2 ( [ p1 ] ) for a given pdf @xmath1 in the form @xmath124 where @xmath125 is a weight function and @xmath126 is some other pdf .",
    "the function @xmath126 must be @xmath127 for the points @xmath128 , where @xmath129 .",
    "the weight is equal to 0 if @xmath130 @xcite .",
    "a weighted histogram is a histogram obtained from a random experiment with the pdf @xmath126 , and the weights of the events are calculated according to ( [ fweightg ] ) .    to evaluate a size and power of the tests",
    "let us take the distribution @xmath131 defined on the interval @xmath132 and represented by two breit - wigner peaks @xcite .",
    "three cases of the pdf @xmath126 can be considered ( fig .",
    "1 ) : @xmath133 @xmath134 @xmath135    the distribution @xmath136 ( [ prc ] ) results in a histogram with unweighted entries , while the distribution @xmath137 ( [ flat ] ) is a uniform distribution on the interval @xmath132 . the distribution @xmath138 ( [ real ] ) has the same form of parametrization as @xmath1 ( [ weight ] ) , but with different values of the parameters .",
    "sizes of the tests for histograms with a number of bins equal to 5 and different weighted functions were calculated for the nominal size @xmath113 equal to 0.05 .",
    "calculations of the test sizes @xmath116 were carried out using the monte carlo method with 10000 runs , therefore it is reasonable to test the hypothesis @xmath139 against the alternative @xmath140 .",
    "for this purpose @xmath141 statistics can be used @xcite @xmath142 where @xmath143 is an estimated value of @xmath116 .",
    "if the null hypothesis is true then this test statistic has a standard normal distribution .",
    "for the standard normal distribution , 2.5% of the values lie below the critical value of @xmath144 , and 2.5% lie above 1.959964 . therefore ,",
    "if a 2-sided hypothesis test is conducted with a significance level equal to 0.05 , @xmath145 is accepted when @xmath146 or @xmath147 .",
    "the results of calculation for a pair of histograms with either normalized weights or unnormalized weights as well as for two histogram with normalized and unnormalized weights are presented in tables  [ tab : result1][tab : result3c ] for different weight functions , and different total number of events . to calculate sizes of tests two",
    "statistically independent weighted histograms were simulated .",
    "the distribution @xmath1 ( [ weight ] ) was used for simulation of the first weighted histogram and the same distribution @xmath1 for simulation of the second one .",
    "weights @xmath148 where used for histograms with normalized weighted entries as well as weights @xmath149 and @xmath150 for histograms with unnormalized weighted entries .",
    "powers of the tests were investigated for slightly different values of the amplitude of the second peak of the specified probability distribution function ( fig .",
    "2 ) : @xmath151      a size of the tests was calculated for a different total number of events @xmath152 and @xmath153 in five bin histograms . in the following , numerical examples demonstrate applications of :    * the median test @xmath154([stdavu ] ) and the new test @xmath61([stdd3 ] ) for comparison of weighted histograms with normalized weights ( table  [ tab : result1 ] ) ; * the median test @xmath81 ( [ stdav2 ] ) and the new test @xmath87([stddc5 ] ) for comparison of weighted histograms with unnormalized weights ( table  [ tab : result2 ] ) ; * the median test @xmath79 ( [ stdav2 ] ) and the new test @xmath85([stddc5 ] ) for comparison of a weighted histogram with normalized weights and a histogram with unnormalized weights ( table  [ tab : result3 ] ) .     +     +    .",
    "sizes @xmath155 of the test @xmath156 ( [ stdavu ] ) for comparison of two histograms with normalized weighted entries ( left panel ) and sizes of the new test @xmath61 ( [ stdd3 ] ) ( right panel ) for different pairs of weights ( last column ) and numbers of events @xmath152 , @xmath153 .",
    "sizes of the tests that do not satisfy the hypothesis @xmath157 with a significance level equal to @xmath158 ( @xmath159 or @xmath160 ) are highlighted with gray . [ cols=\">,>,>,>,>,>,>,>,>,>,>,>,>,^ \" , ]     _ conclusions to subsection 6.2.2 _    * tables 7 - 9 + in general , the powers of the new tests @xmath61 ( [ stdd3 ] ) , @xmath87 , @xmath85 ( [ stddc5 ] ) are greater than the power of the test @xmath161 ( [ pois2 ] ) @xcite developed for poisson histograms .",
    "* @xmath161 ( [ pois2 ] ) @xcite is a test for comparing _",
    "equivalent number of unweighted events _ histograms and it can not be directly interpreted as a test for comparison of original weighted histograms .    as a summary ,",
    "the numerical examples demonstrate superiority of the new tests for comparison of weighted histograms under existing tests @xcite including test applications for poisson weighted histograms .",
    "a review of the chi - square homogeneity tests for comparison of weighted histograms is presented in this work .",
    "bin content of a weighted histogram is considered as a random sum of random variables that permit generalization of the classical homogeneity chi - square test for histograms with weighted entries .",
    "improvements of the chi - square tests with better statistical properties are proposed .",
    "evaluation of the size and power of tests is done numerically for different types of weighted histograms with a different number of events and different weight functions . in general , the size of the new tests is closer to its nominal value and it is plausible that the power is greater than their power of currently available tests .",
    "the presented numerical examples demonstrate the superiority of the new tests over the previously proposed tests for poisson weighted histograms .    the proposed tests can be used to fit monte carlo data to experimental data , to compare experimental data with monte carlo data and to compare two monte carlo data sets as well as to solve the unfolding problem by reweighting the events .",
    "00 h.  cramer , mathematical methods of statistics , princeton university press , princeton , 1999 .",
    "k.  pearson , phil . mag .",
    "50 ( 1900 ) 157 - 175 .",
    "r.  a.  fisher , j. roy .",
    "87 ( 1924 ) 442 - 450 . n.  d.  gagunashvili , nucl .",
    "a596 ( 2008 ) 439 - 445",
    ". n.  d.  gagunashvili , comput .",
    "phys . commun .",
    "183,(2012 ) 418 . n.  d.  gagunashvili , journal of instrumentation 10 , ( 2015 ) p05004 .",
    "n.  d.  gagunashvili , nucl .",
    "instrum . meth .",
    "a 614,(2010 ) 287 . n.  d.  gagunashvili , comput .",
    "183 , ( 2012 ) 193 .",
    "g.  bohm , g.  zech , nucl .",
    "instr . meth .",
    "a691 ( 2012 ) 171 - 177 .",
    "h.  robbins , bull . am .",
    "54 ( 12 ) ( 1948 ) 1151 .",
    "r.  p.  brent , algorithms for minimization without derivatives , chapter 4 .",
    "prentice - hall , englewood cliffs , nj , 1973 .",
    "m.  g.  kendall , a.  s.  stuart , the advanced theory of statistics , vol .",
    "2 , ch . 30 , sec .",
    "30.9 , griffin publishing company , london , 1973 . s.  baker , r.  d.  cousins , nucl .",
    "instr . meth .",
    ". i.  m.  sobol , numerical monte carlo methods , ch.5 , nauka , moscow , 1973 .",
    "g.  breit , e.  wigner , capture of slow neutrons , phys .",
    "49 ( 1936 ) 519 - 531 .",
    "d.  s.  moore , g.  p.  mccabe , introduction to the practice of statistics , w.  h.  freeman publishing company , new york , 2005 .",
    "w.  g.  cochran ( 1952 ) , ann . of math .",
    "( 1952 ) 315 - 345 ."
  ],
  "abstract_text": [
    "<S> histograms with weighted entries are used to estimate probability density functions . </S>",
    "<S> computer simulation is the main application of this type of histograms . </S>",
    "<S> a review on chi - square tests for comparing weighted histograms is presented in this paper . </S>",
    "<S> improvements to these tests that have a size closer to its nominal value are proposed . </S>",
    "<S> numerical examples are presented for evaluation and demonstration of various applications of the tests .    </S>",
    "<S> homogeneity test , random sum of random variables , fit weighted histogram , monte - carlo simulation . </S>",
    "<S> 02.50.-r , 02.50.cw , 02.50.le , 02.50.ng </S>"
  ]
}