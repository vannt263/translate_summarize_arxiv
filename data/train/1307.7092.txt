{
  "article_text": [
    "the relation in the title is given by a canonical pseudofunctorial map @xmath5 between  twisted inverse image \" pseudofunctors with which grothendieck duality theory is concerned .",
    "these pseudofunctors on the category @xmath6 of essentially - finite.5pt - type separated maps of noetherian schemes take values in bounded - below derived categories of complexes with quasi - coherent homology , see [ ^ ! ] and  [ ^times ] .",
    "the map @xmath7 , derived from the pseudofunctorial  fake unit map \" @xmath8 of proposition  [ fake unit ] , is specified  in corollary  [ relation ] .",
    "a number of concrete examples appear in  [ section : examples ] .",
    "for instance , if @xmath0 is a map in  @xmath6 , then @xmath9 is an isomorphism if @xmath0 is proper ; but if @xmath0 is , say , an open immersion , so that @xmath3 is the usual inverse image functor  @xmath4 whereas @xmath1 is right - adjoint to @xmath10 , then @xmath9 is usually quite far from being an isomorphism ( see e.g. ,  [ affine locimm ] ,  [ vargm ] and  [ affine / k ] ) .    after some preliminaries are covered in ",
    "[ prelims ] , the definition of the pseudofunctorial map @xmath7 is worked out at the beginning of  [ basic map ] .",
    "its good behavior with respect to flat base change is given by proposition  [ base change ] .",
    "the rest of section  [ basic map ] shows that under suitable  compact support \" conditions , various operations from duality theory take @xmath7 to an isomorphism . to wit :    let @xmath11 be the derived category of @xmath12-complexes with quasi - coherent homology , and let @xmath13 be the internal hom in the closed category @xmath11 (  1.5 ) .",
    "proposition  [ gampsi ] says :    _ if @xmath14 is a map in @xmath6 , if @xmath15 is a union of closed subsets of  @xmath16 to each of which the restriction of  @xmath0 is proper , and if @xmath17 has support contained in  @xmath18 then each of the functors @xmath19 @xmath20 and @xmath21 takes the map @xmath22 to an isomorphism .",
    "_    the proof uses properties of a bijection between subsets of @xmath16 and  localizing tensor ideals \" in @xmath11 , reviewed in appendix  [ support ] .",
    "a consequence is that even for nonproper  @xmath0 , @xmath3  still  has dualizing properties for complexes having support in such a @xmath15 ( corollary  [ supports ] ) ; and there results , for @xmath23 and @xmath24 a relative dualizing sheaf , a  generalized residue map\"=-1 @xmath25    proposition  [ pullback1 ] says that _ for @xmath6-maps of noetherian schemes such that @xmath26 is proper , and any @xmath27 @xmath28 the functors @xmath29 and @xmath30 both take the map @xmath31 to an isomorphism . _",
    "section 3 gives some concrete realizations of @xmath7 .",
    "besides the examples mentioned above , one has that if @xmath32 is a noetherian ring , @xmath33 a flat essentially - finite.5pt - type @xmath32-algebra , @xmath34 the corresponding scheme.5pt - map , and @xmath35 an @xmath32-module , with sheafification @xmath36 , then with @xmath37 , the map @xmath38 is the sheafification of a simple @xmath39-map @xmath40 described in proposition  [ r1.1.3.5 ] .",
    "so if @xmath41 is an @xmath32-algebra map with @xmath42 module.5pt - finite over  @xmath32 , then , as above , the functors @xmath43 and @xmath44 take to an isomorphism .    in the case where @xmath32 is a field , more information about",
    "the map   appears in proposition  [ affine / k].5pt : the map is represented by a split @xmath33-module surjection with an enormous kernel .    in  4",
    ", there are two applications of the map @xmath7 .",
    "the first is to a  reduction theorem \" for the hochschild homology of flat @xmath6-maps that was stated in ( * ? ? ?",
    "* theorem 4.6 ) in algebraic terms ( see below ) , with only an indication of proof . the scheme.5pt - theoretic version appears here in  [ global4.6 ] .",
    "the paper @xcite also treats the nonflat algebraic case , where @xmath45 becomes a derived tensor product .",
    "in fact , we conjecture that the natural home of the reduction theorems is in a more general derived - algebraic - geometry setting .",
    "the special case [ affreldual ] of gives a canonical description of the relative dualizing sheaf @xmath46 of a flat @xmath6-map @xmath14 between affine schemes .",
    "the proof is based on the known theory of @xmath3 , which is constructed using arbitrary choices , such as a compactification of @xmath0 or a factorization of @xmath0 as smooth@xmath47finite ; but the choice.5pt - free formula [ affreldual ] might be a jumping - off point for a choice.5pt - free redevelopment of the underlying theory .",
    "the second application is to a simple formula for the _ fundamental class _ of a flat map @xmath0 of affine schemes .",
    "the fundamental class of a flat @xmath6-map a globalization of the grothendieck residue map  goes from the hochschild complex of @xmath48 to the relative dualizing complex  @xmath49 .",
    "this map is defined in terms of sophisticated abstract notions from duality theory ( see ) .",
    "but for maps @xmath50 as above , theorem  [ explicit fc ] says that , with @xmath51 the @xmath45-homomorphism taking @xmath52 to multiplication by @xmath53 , _ the fundamental class is isomorphic to the sheafification of the natural composite map _",
    "[ ^ ! ] for a scheme @xmath55 , @xmath56 is the derived category of @xmath12-modules , and @xmath11 ( @xmath57 ) is the full subcategory spanned by the complexes with quasi - coherent cohomology modules ( vanishing in all but finitely many negative degrees ) . we will use freely some standard functorial maps , for instance the projection isomorphism associated to a map @xmath14 of noetherian schemes ( see , e.g. , @xcite ) : @xmath58    denote by @xmath6 the category of _ separated essentially - finite.5pt - type maps of noetherian schemes .",
    "_ by ( * ? ?",
    "* and 5.3 ) , there is a contravariant pseudofunctor @xmath59 over @xmath6 , determined up to isomorphism by the properties:2    \\(i ) the pseudofunctor @xmath59 restricts over the subcategory of proper maps in @xmath6 to a right adjoint of the derived direct - image pseudofunctor.1    \\(ii ) the pseudofunctor @xmath59 restricts over the subcategory of formally tale maps in @xmath6 to the usual inverse.5pt - image pseudofunctor  @xmath60.1    \\(iii ) for any fiber square in @xmath612 @xmath62 with @xmath63 proper  and @xmath64 formally tale , the base.5pt - change map @xmath65 , defined to be the adjoint of the natural composition @xmath66 is equal to the natural composite isomorphism @xmath67    there is in fact a family of base - change _ isomorphisms _ @xmath68 indexed by _",
    "all _ commutative @xmath6-squares @xmath62 that are such that in the associated diagram ( which exists in @xmath6 , see @xcite)=-1 @xmath69 it holds that @xmath70 is a fiber square , @xmath71 and @xmath72 , the map @xmath73 is flat and @xmath74 is formally tale , a family that is the unique such one that behaves transitively with   respect to vertical and horizontal composition of such @xmath75 ( cf .",
    "* ( 4.8.2)(3 ) ) ) , and satisfies:3    \\(iv ) if @xmath75 is a fiber square with @xmath0 proper then the map @xmath65 is adjoint to the composite map ; 2    \\(v ) if @xmath0hence @xmath48is formally tale , so that @xmath76 and @xmath77 then @xmath65  is the natural isomorphism @xmath78 ; and2    \\(vi ) if @xmath73hence @xmath79is formally tale , so that @xmath80 and @xmath81 then @xmath65  is the natural isomorphism .3    ( for further explanation see ( * ? ? ? * thm.4.8.3 ) and @xcite.)4    _ remark .",
    "_ with regard to ( vi ) , if @xmath75 is _ any _ commutative @xmath6-diagram with @xmath73 and @xmath79 formally tale , then in the associated diagram @xmath74 is necessarily formally tale ( ( * ? ? ? * ( 17.1.3(iii ) and 17.1.4 ) ) , so that @xmath65 exists 1 ( and can be identified with the canonical isomorphism @xmath82 ) .    [ ^times ]    for _ any _",
    "@xmath6-map @xmath83 , there exists a functor @xmath84 that is bounded below and right - adjoint to @xmath85 .",
    "there results a @xmath86.5pt - valued pseudofunctor @xmath87 on @xmath6 , for which the said adjunction is pseudofunctorial ( * ? ? ?",
    "* corollary ( 4.1.2 ) ) . obviously , the restriction of  @xmath87 to @xmath88 over proper maps in @xmath6 is isomorphic to that of  @xmath59 .",
    "accordingly , we will identify these two restricted pseudofunctors .",
    "[ locimm ] nayak s construction of @xmath59 is based on his extension ( * ? ? ?",
    "* , thm.4.1 ) of nagata s compactification theorem , to wit , that any map  @xmath0 in  @xmath6 factors as @xmath89 where @xmath90 is proper and @xmath73 is a localizing immersion ( see below ) .",
    "such a factorization is called a _ compactification of _",
    "@xmath0.2    a _ localizing immersion _ is an @xmath6-map @xmath91 for which every   has a neighborhood @xmath92 such that @xmath93 for some multiplicatively closed subset @xmath94 , see @xcite .",
    "for example , _",
    "finite.5pt - type _ localizing immersions are1 just open immersions @xcite .",
    "any localizing immersion @xmath73 is formally tale , so that @xmath95.1    [ cosa : localizing - immersion ] any localizing immersion @xmath91 is a flat monomorphism , whence _ the natural map @xmath96 is an isomorphism _ : associated to the fiber  square=-1 @xmath97 there is the flat base.5pt - change isomorphism @xmath98 , and since @xmath73 is a monomorphism , @xmath99 and @xmath100 are equal isomorphisms , so that @xmath101 .",
    "that @xmath102 is an isomorphism means that the natural map is an isomorphism @xmath103 which implies that the natural map @xmath104 is an isomorphism .",
    "conversely , _ any flat monomorphism @xmath0 in @xmath6 is a localizing immersion , _ which can be seen as follows . using @xcite and ( *",
    "* and 17.6.1 ) one reduces to where @xmath0 is a map of affine schemes , corresponding to a composite ring map @xmath105 with @xmath106 tale and @xmath35 a multiplicative submonoid of  @xmath107 .",
    "the kernel of multiplication @xmath108 is generated by an idempotent @xmath109 , and @xmath110 is an isomorphism , so @xmath109 is annihilated by an element of the form @xmath111 .",
    "consequently , @xmath112\\otimes b[1/m]\\to b[1/m]$ ] is an isomorphism , and so replacing  @xmath113 by @xmath112 $ ] reduces the problem further to the case where @xmath114 is a finite.5pt - type algebra .",
    "finally , localizing @xmath115 with respect to its submonoid of elements that are sent to units in @xmath113 , one may assume further that @xmath0 is surjective , in which case @xcite gives that @xmath0 is an isomorphism .",
    "[ rhom^qc ] for a noetherian scheme @xmath55 , the functor @xmath116 specified in   [ ^times ] is right - adjoint to the inclusion @xmath117 .",
    "it is sometimes called the _ derived quasi - coherator . _    for any @xmath118 , the unit map is an isomorphism @xmath119 .    for any complexes @xmath115 and @xmath107 in @xmath11 , set @xmath120    then for @xmath115 in @xmath11 , the functor @xmath121 is right - adjoint to the endofunctor @xmath122 of @xmath123 .",
    "thus , @xmath11 is a closed category with multiplication given by @xmath124 and internal hom given by @xmath125 .",
    "as above , the canonical @xmath56-map @xmath126 is an _ isomorphism _ whenever @xmath127for example",
    ", whenever @xmath128 and the cohomology sheaves @xmath129 are coherent for all @xmath74 , vanishing for @xmath130 @xcite .",
    "[ conjugate ] for categories @xmath131 and @xmath132 , let fun@xmath133 be the category of functors from @xmath131 to @xmath132 , and let fun@xmath134 ( resp .",
    "fun@xmath135 be the full subcategory spanned by the objects that have right ( resp .",
    "left ) adjoints .",
    "there is a contravariant isomorphism of categories @xmath136 that takes any map of functors to the _ right - conjugate _ map between the respective right adjoints ( see e.g. , @xcite ) .",
    "the image under @xmath137 of a map of functors is its _ left - conjugate _ map .",
    "the functor @xmath138 ( resp .",
    "@xmath137 ) takes isomorphisms of functors to isomorphisms .",
    "for instance , for any @xmath6-map @xmath139 there is a bifunctorial _ sheafified duality _ isomorphism , with @xmath17 and @xmath140 : @xmath141 right - conjugate , for each fixed  @xmath142 , to the projection isomorphism @xmath143    likewise , there is a functorial isomorphism @xmath144 right - conjugate to the projection isomorphism @xmath145",
    "in this section we construct a pseudofunctorial map @xmath5 .",
    "the construction is based on the following  fake unit \" map .",
    "[ fake unit ] over @xmath6 there is a unique pseudofunctorial map @xmath146 whose restriction to the subcategory of proper maps in @xmath6 is the unit of the adjunction between @xmath147 and @xmath148 and such that if @xmath73 is a localizing immersion then @xmath149 is inverse to the isomorphism @xmath150 in  [ cosa : localizing - immersion].=-1    the proof uses the next result  in which the occurrence of  @xmath65 is justified by the remark at the end of  [ ^ ! ] .",
    "as we are dealing only with functors between derived categories , we will reduce clutter by writing @xmath151 for @xmath152 ( @xmath153  any map in @xmath6 ) .",
    "[ compat ] let @xmath75 be a commutative square in @xmath154 @xmath62 with @xmath63 proper  and @xmath64 localizing immersions .",
    "let @xmath155 be the functorial map adjoint to the natural composite map then the following natural diagram commutes .",
    "@xmath156       \\node(11 ) at ( 1,-1){\\2 } ;     \\node(12 ) at ( 2,-1){{\\mathbf{1 } } } ;        \\node(13 ) at ( 3,-1){\\3 } ;          \\node(22 ) at ( 2,-2){\\4 } ;         \\node(32 ) at ( 2,-3){\\6 } ;         \\node(41 ) at ( 1,-3){\\5 } ;     \\node(43 ) at ( 3,-3){\\7 } ;       \\node(51 ) at ( 1,-4){\\8 } ;     \\node(52 ) at ( 1.66,-4){\\9 } ;     \\node(53 ) at ( 2.33,-4){\\ten } ;     \\node(54 ) at ( 3,-4){\\lvn } ;           \\draw[<- ] ( 11)--(12 ) node[above=1pt , midway , scale=.75]{$\\iso$ } ;     \\draw[- > ] ( 12)--(13 ) node[above=1pt , midway , scale=.75]{\\textup{unit } } ;      \\draw[- > ] ( 41)--(32 ) node[above=1pt , midway , scale=.75]{$\\iso$ } ;    \\draw[- > ] ( 32)--(43 )   node[above=1pt , midway , scale=.75]{$\\iso$ }                                    node[below=1pt , midway , scale=.75]{$\\beta_{{\\mkern1mu}\\xi}$ } ;           \\draw[- > ] ( 51)--(52 ) node[above , midway , scale=.75]{$\\iso$ } ;     \\draw[double distance=2pt ] ( 52)--(53 ) ;     \\draw[- > ] ( 53)--(54 ) node[above , midway , scale=.75]{$\\iso$ } ;        \\draw[- > ] ( 11)--(41 ) node[left=1pt , midway , scale=.75]{$v^*\\textup{unit}$ } ;          \\draw[- > ] ( 22)--(32 ) node[left=1pt , midway , scale=.75]{$v^*\\phi^{}_{{\\mkern1mu}\\xi}$ } ;         \\draw[double distance=2pt ] ( 41)--(51 ) ;     \\draw[- > ] ( 13)--(43 ) node[right=1pt , midway , scale=.75]{$\\simeq$ } ;      \\draw[double distance=2pt ] ( 43)--(54 ) ;         \\draw[- > ] ( 11)--(22 )   node[above=-6pt , midway , scale=.75]{\\rotatebox{-16.5}{$\\mkern43mu v^*v_*\\textup{unit}$ } } ;    \\draw[<- ] ( 22)--(13 )   node[above=-1pt , midway , scale=.75 ] { $ \\rotatebox{16.5}\\iso$ } ;      \\node at ( 2,-1.5)[scale=.9]{{\\textcircled{\\scriptsize{1 } } } } ;     \\node at ( 1.5,-2.35)[scale=.9]{{\\textcircled{\\scriptsize{2 } } } } ;     \\node at ( 2.5,-2.35)[scale=.9]{{\\textcircled{\\scriptsize{3 } } } } ;        \\node at ( 2,-3.56)[scale=.9]{{\\textcircled{\\scriptsize{4 } } } } ;                                                                                                                    { \\end{tikzpicture}}\\ ] ]    commutativity of subdiagram 1 is clear .    for commutativity of subdiagram 2 ,",
    "drop @xmath157 and note the obvious commutativity of the following adjoint of the resulting diagram : @xmath158       \\node(11 ) at ( 1,-1){{\\mathbf{1 } } } ;     \\node(12 ) at ( 2,-1){\\2 } ;          \\node(22 ) at ( 2,-2){\\3 } ;             \\node(31 ) at ( 1,-3){{\\mathbf{1 } } } ;     \\node(32 ) at ( 2,-3){\\4 } ;           \\draw[- > ] ( 11)--(12 ) ;     \\draw[- > ] ( 31)--(32 ) ;        \\draw[double distance=2pt ] ( 11)--(31 ) ;        \\draw[- > ] ( 12)--(22 ) node[right=1pt , midway , scale=.75]{$\\simeq$ } ;      \\draw[- > ] ( 22)--(32 ) ;            { \\end{tikzpicture}}\\ ] ]    showing commutativity of subdiagram 3 is similar to working out ( * ? ? ?",
    "* exercise 3.10.4(b ) ) .",
    "( details are left to the reader . )",
    "commutativity of subdiagram 4 is given by ( vi ) in section  [ ^ ! ] .",
    "as before , for any map  @xmath153 in @xmath6 we abbreviate @xmath152 to @xmath151 .",
    "let @xmath0 be a map in @xmath6 , and @xmath159 a compactification .",
    "if @xmath160 exists , then @xmath161 must be given by the natural composition @xmath162 so that uniqueness holds .",
    "let us show now that this composite map does not depend on the choice of compactification .",
    "a morphism @xmath163 from one compactification of @xmath0 to another is a commutative diagram of scheme.5pt - maps @xmath164       \\node(12 ) at ( 2,-1){$\\bullet$ } ;            \\node(21 ) at ( 1,-2){$\\bullet$ } ;      \\node(23 ) at ( 3,-2){$\\bullet$ } ;             \\node(32 ) at ( 2,-3){$\\bullet$ } ;           \\draw[- > ] ( 21)--(12 ) node[above=1pt , midway , scale=.75]{$v$ } ;      \\draw[- > ] ( 12)--(23 ) node[above=1pt , midway , scale=.75]{$q$ } ;        \\draw[- > ] ( 21)--(32 ) node[below=1pt , midway , scale=.75]{$u$ } ;      \\draw[- > ] ( 32)--(23 ) node[below=1pt , midway , scale=.75]{$p$ } ;        \\draw[- > ] ( 12)--(32 ) node[left=1pt , midway , scale=.75]{$r$ } ;           { \\end{tikzpicture}}\\endcd\\ ] ] if such a map @xmath165necessarily proper  exists , we say that the compactification @xmath166 _ dominates _ @xmath159 .",
    "_ any two compactifications @xmath167 @xmath168 of a given @xmath14 are dominated by a third one_. indeed , let @xmath169 be the map corresponding to the pair @xmath170 , let @xmath171 be the schematic closure of @xmath79so that @xmath172 has schematically dense image.5pt  and let @xmath173 be the maps induced by the two canonical projections . since @xmath174 is a localizing immersion , therefore , by @xcite , so is  @xmath79 .",
    "thus @xmath175 is a compactification , not depending on @xmath74 , mapped by @xmath176 to the compactification @xmath177 .",
    "so to show that gives the same result for any two compactifications of  @xmath0 , it suffices to do so when one of the compactifications dominates the  other .",
    "thus with reference to the diagram , and keeping in mind that @xmath80 and @xmath178 , one need only show that the following natural diagram commutes .",
    "@xmath179       \\node(12 ) at ( 2,-1){{\\mathbf{1 } } } ;           \\node(21 ) at ( 1,-2){\\2 } ;     \\node(22 ) at ( 2,-2){\\3 } ;     \\node(23 ) at ( 3,-2){\\4 } ;         \\node(31 ) at ( 1,-3){\\5 } ;     \\node(32 ) at ( 2,-3){\\6 } ;     \\node(33 ) at ( 3,-3){\\7 } ;         \\node(42 ) at ( 2,-4){\\8 } ;                \\draw[- > ] ( 21)--(22 ) ;     \\draw[- > ] ( 23)--(22 ) ;            \\draw[- > ] ( 31)--(32 ) ;     \\draw[- > ] ( 33)--(32 ) ;           \\draw[- > ] ( 21)--(31 ) ;         \\draw[- > ] ( 22)--(32 ) ;     \\draw[- > ] ( 32)--(42 ) ;       \\draw[- > ] ( 23)--(33 ) ;             \\draw[- > ] ( 12)--(21 ) node[right=1pt , midway , scale=.75]{$ $ } ;      \\draw[- > ] ( 12)--(23 ) ;            \\draw[- > ] ( 31)--(42 ) node[right=1pt , midway , scale=.75]{$ $ } ;       \\draw[- > ] ( 33)--(42 ) ;               \\node at ( 2,-1.55)[scale=.9]{{\\textcircled{\\scriptsize{1 } } } } ;     \\node at ( 1.5,-2.5)[scale=.9]{{\\textcircled{\\scriptsize{2 } } } } ;     \\node at ( 2.5,-2.5)[scale=.9]{{\\textcircled{\\scriptsize{3 } } } } ;        \\node at ( 1.75,-3.4)[scale=.9]{{\\textcircled{\\scriptsize{4 } } } } ;      \\node at ( 2.25,-3.4)[scale=.9]{{\\textcircled{\\scriptsize{5 } } } } ;                { \\end{tikzpicture}}\\ ] ]    commutativity of subdiagram 1 is given by lemma  [ compat ] , with @xmath180 and @xmath181 .",
    "commutativity of 2 is clear .",
    "commutativity of 3 holds because over proper maps , @xmath59 and @xmath182 are _ pseudofunctorially _ adjoint ( see ( * ? ? ?",
    "* corollary ( 4.1.2 ) ) .",
    "commutativity of 4 and 5 results from the pseudofunctoriality of @xmath59 and @xmath182.1    thus is indeed independent of choice of compactification , so that @xmath183 is well - defined.4    finally , it must be shown that @xmath160 is pseudofunctorial , i.e. , for any composition @xmath184 in @xmath6 , the next diagram commutes : @xmath185    consider therefore a diagram @xmath186       \\node(31 ) at ( 1,-3){$\\bullet$ } ;           \\node(21 ) at ( 1,-2){$\\bullet$ } ;     \\node(22 ) at ( 2,-2){$\\bullet$ } ;             \\node(11 ) at ( 1,-1){$\\bullet$ } ;     \\node(12 ) at ( 2,-1){$\\bullet$ } ;     \\node(13 ) at ( 3,-1){$\\bullet$ } ;              \\draw[- > ] ( 11)--(12 ) node[above=1pt , midway , scale=.75]{$u$ } ;     \\draw[- > ] ( 12)--(13 ) node[above=1pt , midway , scale=.75]{$w$ } ;         \\draw[- > ] ( 21)--(22 ) node[above , midway , scale=.75]{$v$ } ;              \\draw[- > ] ( 11)--(21 ) node[left=1pt , midway , scale=.75]{$f$ } ;     \\draw[- > ] ( 21)--(31 ) node[left=1pt , midway , scale=.75]{$g$ } ;         \\draw[- > ] ( 12)--(21 ) node[right=5pt , midway , scale=.75]{$p$ } ;      \\draw[- > ] ( 13)--(22 ) node[right=5pt , midway , scale=.75]{$r$ } ;         \\draw[- > ] ( 22)--(31 ) node[right=5pt , midway , scale=.75]{$q$ } ;       { \\end{tikzpicture}}\\ ] ] where @xmath89 is a compactification of @xmath0 , @xmath187 of @xmath48 , and @xmath188 of @xmath189so that @xmath190 is a compactification of @xmath191 .",
    "the problem then is to show commutativity of ( the border of ) the following natural diagram . @xmath192",
    "\\node(11 ) at ( 1,-1){{\\mathbf{1 } } } ;        \\node(12 ) at ( 2.29,-1){\\2 } ;     \\node(13 ) at ( 3.23,-1){\\3 } ;           \\node(21 ) at ( 1,-2){\\5 } ;     \\node(22 ) at ( 2.29,-2){\\lvn } ;     \\node(24 ) at ( 3.9,-2){\\4 } ;           \\node(31 ) at ( 1.4,-3){\\thn } ;     \\node(32 ) at ( 2.29,-3){\\twv } ;     \\node(33 ) at ( 3.23,-3){\\ffn } ;           \\node(41 ) at ( 1.4,-4){\\svn } ;     \\node(42 ) at ( 2.29,-4){\\frn } ;        \\node(43 ) at ( 3.23,-4){\\egn } ;              \\node(51 ) at ( 1,-5){\\6 } ;     \\node(52 ) at ( 2.29,-5){\\6 } ;     \\node(53 ) at ( 3.23,-5){\\sxn } ;     \\node(54 ) at ( 3.9,-5){\\ten } ;            \\node(62 ) at ( 2.29,-6){\\7 } ;     \\node(63 ) at ( 3.17,-6){\\8 } ;     \\node(64 ) at ( 3.85,-6){\\9 } ;                         \\draw[- > ] ( 11)--(12 ) ;         \\draw[- > ] ( 12)--(13 ) ;                              \\draw[- > ] ( 21)--(22 ) ;            \\draw[<- ] ( 31)--(32 ) ;         \\draw[- > ] ( 32)--(33 ) ;                  \\draw[- > ] ( 41)--(42 ) ;         \\draw[- > ] ( 42)--(43 ) ;               \\draw[double distance=2pt ] ( 51)--(52 ) ;              \\draw[- > ] ( 52)--(53 ) node[below=1pt , midway , scale=.75]{$\\operatorname{{\\textup{via}}}\\eta(g)$ } ;          \\draw[- > ] ( 53)--(54 ) ;             \\draw[- > ] ( 62)--(63 ) ;         \\draw[- > ] ( 63)--(64 ) ;                      \\draw[- > ] ( 11)--(21 ) ;         \\draw[- > ] ( 21)--(51 ) ;                 \\draw[double distance=2pt ] ( 31)--(41 ) ;                 \\draw[- > ] ( 12)--(22 ) ;         \\draw[- > ] ( 22)--(32 ) ;         \\draw[- > ] ( 32)--(42 ) ;             \\draw[- > ] ( 42)--(52 ) ;         \\draw[- > ] ( 52)--(62 ) ;                     \\draw[- > ] ( 13)--(33 ) ;         \\draw[- > ] ( 33)--(43 ) ;         \\draw[- > ] ( 43)--(53 ) ;               \\draw[- > ] ( 24)--(54 ) ;         \\draw[- > ] ( 3.9,-5.78)--(3.9 , -5.22 ) ;             \\draw[- > ] ( 13)--(24 ) ;         \\draw[- > ] ( 21)--(31 ) node[above=-3pt , midway , scale=.75]{$\\mkern45mu\\eta(vp)$ } ;                        \\node at ( 1.65,-1.55)[scale=.9]{{\\textcircled{\\scriptsize{1 } } } } ;         \\node at ( 1.85,-2.55)[scale=.9]{{\\textcircled{\\scriptsize{2 } } } } ;         \\node at ( 1.85,-3.55)[scale=.9]{{\\textcircled{\\scriptsize{3 } } } } ;            \\node at ( 1.65,-4.55)[scale=.9]{{\\textcircled{\\scriptsize{4 } } } } ;          \\node at ( 2.76,-2)[scale=.9]{{\\textcircled{\\scriptsize{5 } } } } ;                   \\node at ( 2.76,-3.55)[scale=.9]{{\\textcircled{\\scriptsize{6 } } } } ;         \\node at ( 3.565,-3.55)[scale=.9]{{\\textcircled{\\scriptsize{7 } } } } ;            \\node at ( 2.76,-4.55)[scale=.9]{{\\textcircled{\\scriptsize{8 } } } } ;          \\node at ( 3.23,-5.55)[scale=.9]{{\\textcircled{\\scriptsize{9 } } } } ;         { \\end{tikzpicture}}\\ ] ]    that subdiagram 1 commutes is shown , e.g. , in ( * ? ? ?",
    "* , up to ( 3.6.5 ) ) .",
    "( in other words , the adjunction between @xmath60 and @xmath182 is pseudofunctorial , see _",
    "ibid_. , ( 3.6.7)(d ) . )",
    "commutativity of 2 is the definition of @xmath193 via the compactification  @xmath188 .",
    "commutativity of 3 holds by definition of the vertical arrow on its right .",
    "commutativity of 4 ( omitting @xmath194 and @xmath195 ) is the case @xmath196 of lemma  [ compat ] .",
    "commutativity of 5 holds because of pseudofunctoriality of the adjunction between @xmath182 and @xmath59 over _ proper _ maps ( see  [ ^times ] ) .",
    "commutativity of 6 is clear .",
    "commutativity of 7 results from pseudofunctoriality of @xmath59 and  @xmath182 .",
    "commutativity of 8 is the definition of @xmath197 via the compactification  @xmath187 .",
    "commutativity of 9 is simple to verify .",
    "this completes the proof of proposition  [ fake unit ] .",
    "[ relation ] there is a unique pseudofunctorial map @xmath198 whose restriction over the subcategory of proper maps in @xmath6 is the identity , and such that for every localizing immersion @xmath199 @xmath200 is the natural composition @xmath201    let @xmath0 be an @xmath6-map , and @xmath159 a compactification .",
    "if @xmath7 exists , then @xmath22 must be given by the natural composition @xmath202 \\tag{\\ref{relation}.1}\\ ] ] so that uniqueness holds .",
    "as for existence , using [ fake unit ] we can take @xmath9 to be the natural composition @xmath203 this is as required when @xmath0 is proper or a localizing immersion , and it behaves pseudofunctorially , because both @xmath160 and the counit map @xmath204 do .",
    "[ eta from psi ] conversely , one can recover @xmath160 from @xmath7 : it is simple to show  that for any @xmath6-map @xmath14 and @xmath17 , and with @xmath205 the unit map of the adjunction @xmath206 , one has @xmath207 ( _ notation _",
    ": @xmath208 signifies that the functor @xmath209 is left - adjoint to the functor  @xmath210 . )",
    "if @xmath91 is a localizing immersion , then the map @xmath211 is an _ isomorphism , _ inverse to the isomorphism @xmath212 in  [ cosa : localizing - immersion ] .",
    "( a proof is left to the reader . )    [ l1.1.25 ] _ the map @xmath213 is equal to the composite _",
    "@xmath214 where @xmath215 is the counit of the adjunction @xmath216 and @xmath217 is the unit of the adjunction @xmath218 .    indeed , by ",
    "[ cosa : localizing - immersion ] the counit @xmath102 of the adjunction @xmath218 is an isomorphism ; and since the composite @xmath219 is the identity map , therefore @xmath220 , as both are the ( unique ) inverse of  @xmath221 ; so the next diagram commutes , giving the assertion : @xmath222    also , using the isomorphism @xmath223 ( resp .",
    ", its right conjugate  @xmath224 ) , one can recover  @xmath225 from  @xmath226 by applying the functor @xmath194 ( resp .",
    "@xmath227 ) , thereby obtaining definitions of @xmath225 .",
    "the next proposition asserts compatibility of @xmath7 with the flat base - change maps for @xmath59 ( see ) and for @xmath228    [ base change ] let @xmath139 and @xmath229 be maps in @xmath230 with @xmath48 flat .",
    "let @xmath231 and @xmath232 be the projections .",
    "let @xmath233 be the map adjoint to the natural composite map @xmath234 then the following diagram commutes .",
    "let @xmath236 be a compactification , so that there is a composite cartesian diagram ( with @xmath153 flat and with @xmath237 a compactification of @xmath238 ) : @xmath239 in view of the pseudofunctoriality of @xmath7 , what needs to be shown is commutativity of the following natural diagram .",
    "@xmath240       \\node(10 ) at ( 0,-1){\\9 } ;      \\node(11 ) at ( 1,-1){{\\mathbf{1 } } } ;        \\node(12 ) at ( 2,-1){\\2 } ;     \\node(13 ) at ( 3,-1){\\3 } ;           \\node(21 ) at ( 1,-2){\\4 } ;     \\node(22 ) at ( 2,-2){\\5 } ;       \\node(30 ) at ( 0,-3){\\0 } ;         \\node(31 ) at ( 1,-3){\\6 } ;     \\node(32 ) at ( 2,-3){\\7 } ;     \\node(33 ) at ( 3,-3){\\8 } ;             \\draw[- > ] ( 10)--(11 ) node[above=1pt , midway , scale=.75]{$\\iso$ } ;         \\draw[- > ] ( 11)--(12 ) ;         \\draw[- > ] ( 12)--(13 ) node[above=1pt , midway , scale=.75]{$\\iso$ } ;                              \\draw[- > ] ( 21)--(22 ) ;                 \\draw[- > ] ( 30)--(31 ) node[above=1pt , midway , scale=.75]{$\\iso$ } ;         \\draw[- > ] ( 31)--(32 ) ;         \\draw[- > ] ( 32)--(33 ) node[above=1pt , midway , scale=.75]{$\\iso$ } ;                         \\draw[- > ] ( 10)--(30 ) ;           \\draw[- > ] ( 11)--(21 ) ;         \\draw[- > ] ( 21)--(31 ) ;                     \\draw[- > ] ( 12)--(22 ) ;         \\draw[- > ] ( 22)--(32 ) ;                      \\draw[- > ] ( 13)--(33 ) ;            \\node at ( 1.5,-1.51)[scale=.9]{{\\textcircled{\\scriptsize{1 } } } } ;         \\node at ( 1.5,-2.51)[scale=.9]{{\\textcircled{\\scriptsize{2 } } } } ;    { \\end{tikzpicture}}\\ ] ]    commutativity of each of the unlabeled subdiagrams is an instance of transitivity of the appropriate base.5pt - change map ( see e.g. , ( * ? ? ?",
    "* thm.(4.8.3 ) ) ) .",
    "commutativity of 2 is straightforward to verify .",
    "subdiagram 1 , without @xmath241 , expands naturally as follows ( where we have written @xmath195 ( resp .",
    "@xmath242 ) for @xmath243 ( resp .",
    "@xmath244 ) ) : @xmath245       \\node(10 ) at ( 0,-1){{\\mathbf{1 } } } ;      \\node(12 ) at ( 2,-1){\\2 } ;     \\node(13 ) at ( 3,-1){\\3 } ;        \\node(21 ) at ( 1,-2){\\4 } ;     \\node(22 ) at ( 2,-2){\\5 } ;       \\node(30 ) at ( 0,-3){\\6 } ;     \\node(32 ) at ( 2,-3){\\7 } ;     \\node(33 ) at ( 3,-3){\\8 } ;             \\draw[<- ] ( 10)--(12 ) node[above=1pt , midway , scale=.75]{$$ } ;         \\draw[- > ] ( 12)--(13 ) node[above=1pt , midway , scale=.75]{$$ } ;                              \\draw[<- ] ( 21)--(22 ) ;                 \\draw[<- ] ( 30)--(32 ) node[above=1pt , midway , scale=.75]{$$ } ;         \\draw[- > ] ( 32)--(33 ) node[above=1pt , midway , scale=.75]{$$ } ;                   \\draw[- > ] ( 10)--(30 ) ;           \\draw[- > ] ( 12)--(22 ) ;         \\draw[- > ] ( 13)--(33 ) ;            \\draw[<- ] ( 10)--(21 ) ;         \\draw[- > ] ( 21)--(32 ) ;                      \\draw[- > ] ( 22)--(33 ) ;            \\node at ( 1.3,-1.51)[scale=.9]{{\\textcircled{\\scriptsize{3 } } } } ;         \\node at ( 2,-2.51)[scale=.9]{{\\textcircled{\\scriptsize{4 } } } } ;    { \\end{tikzpicture}}\\ ] ]    here the unlabeled diagrams clearly commute .",
    "commutativity of 3 results from the fact that the natural isomorphism @xmath246 is adjoint to the natural composition ( see @xcite ) ) .",
    "commutativity of 4 results from the fact that the base.5pt - change map @xmath247 is adjoint to @xmath248 .",
    "thus 1 commutes ; and proposition  [ base change ] is proved .    [ proper - support ]",
    "next we treat the interaction of the map @xmath7 with standard derived functors .",
    "our approach involves the notion of _ support , _ reviewed in appendix  [ support ] .",
    "[ l1.1 ] let @xmath249 be a localizing immersion , the counit of the adjunction @xmath250 and @xmath251 the unit of the adjunction @xmath252",
    ". for all @xmath17 and @xmath253 the maps @xmath254 and  @xmath255 are isomorphisms .",
    "projection isomorphisms make the map @xmath256 isomorphic to=-1 @xmath257 since @xmath258 is an isomorphism ( with inverse the isomorphism @xmath259 from [ cosa : localizing - immersion ] ) , therefore so is @xmath256.1    similarly , to show that @xmath260 is an isomorphism , one can use the duality isomorphism to reduce to noting that @xmath261 is an isomorphism because it is right - conjugate to the inverse of the isomorphism @xmath262 .    [ gampsi ]",
    "let @xmath14 be a map in @xmath230 @xmath15 a union of closed subsets of @xmath263 to each of .5ptwhich the restriction of @xmath264 is proper , and a complex with support @xmath265 contained in @xmath15 .",
    "then the functors @xmath266 , @xmath20 and @xmath21 take @xmath22 to an isomorphism.=-1    by  [ hom and tensor 0](ii ) , it is enough to prove that proposition  [ gampsi ] holds for one  @xmath142 with like1 @xmath267 ( see  [ supprg ] ) .",
    "for such an  @xmath142 , [ hom and tensor 0 ]  shows it enough to prove that @xmath268 is an isomorphism.1    let @xmath269 be a compactification of @xmath0 (  [ locimm ] ) . in view of",
    ", we need only treat the case @xmath270 . in this case",
    "it suffices to show , with @xmath271 and @xmath272 as in remark  [ l1.1.25 ] , that @xmath273 is an isomorphism .",
    "lemma  [ l1.1 ] gives that @xmath274 is an isomorphism .",
    "it remains to be shown that @xmath275 is an isomorphism .",
    "the localizing immersion @xmath73 maps @xmath16 homeomorphically onto @xmath276 @xcite , so we can regard @xmath16 as a topological subspace of  @xmath277 . let @xmath278 be the inclusion into @xmath16 of a subscheme such that the restriction @xmath279 is proper .",
    "then @xmath280 is proper , and so @xmath281 is a closed subset of @xmath282 .",
    "thus @xmath283 ( see remark  [ supp u _ * ] ) is a union of subsets of  @xmath16 that are closed in @xmath277 .",
    "so proposition  [ hom and tensor 0 ] can be applied to show that , since , by lemma  [ l1.1 ] , @xmath256 is an isomorphism , therefore @xmath275 is an isomorphism , as required .",
    "let @xmath284 be as in proposition  [ gampsi ] .",
    "let @xmath285 be the essential image of @xmath286the full subcategory spanned by the complexes that are exact outside @xmath287 .",
    "by lemma  [ supp ] , any @xmath288 satisfies @xmath289 . arguing as in @xcite one finds that the two natural maps from @xmath290 to @xmath291 are _ equal isomorphisms ; _ and deduces that the natural map is an isomorphism @xmath292 with inverse the natural composition @xmath293    [ supports ] with the preceding notation",
    ", @xmath294 has as right adjoint the functor @xmath295 .",
    "when restricted to @xmath296 this right adjoint is isomorphic to @xmath297 .    for @xmath298 and @xmath299 ,",
    "there are natural isomorphisms @xmath300    [ barint ] the preceding corollary entails the existence of a counit map @xmath301 factoring @xmath0 over suitable affine open subsets @xmath302 as @xmath303 where @xmath304 is finite and @xmath305 is essentially smooth , one gets that @xmath306 is of the form @xmath307)$ ] for some @xmath308 such that the sheaf @xmath309 of relative @xmath310-forms is free of rank 1 ; and hence local depth considerations imply that there is an integer @xmath3111 such that @xmath312 for all @xmath313 , while @xmath314 .",
    "this @xmath315 , determined up to isomorphism by @xmath316 , is a _ relative dualizing sheaf _ ( or _ _ relative canonical sheaf__.5pt ) of @xmath0 .",
    "there results a natural composite map of @xmath317-modules @xmath318)\\\\[-5pt ] & { \\longrightarrow}h^0({{\\mathsf r}f^{}_{{\\mkern-1mu}{\\mkern-1mu}*}}{\\mathsf r}{\\vargamma}^{}_{\\!w } f^!{\\mathcal o_y } ) { \\xrightarrow}{\\operatorname{{\\textup{via}}}\\!\\!\\bar{\\,\\,{\\mkern1mu}\\int^{}_{{\\mkern-1mu}w } } } h^0{\\mathcal o_y}={\\mathcal o_y},\\end{aligned}\\ ] ] that generalizes the map denoted  @xmath319 \" in @xcite .    a deeper study of this map involves the realization of @xmath320 , for certain  @xmath316 , in terms of regular differential forms , and the resulting relation of  @xmath321 with residues of differential forms , cf .",
    "@xcite and @xcite .",
    "see also  [ intres ] below .",
    "[ pullback1 ] let @xmath322 be @xmath6-maps such that @xmath323 is proper.1 for any @xmath324 and @xmath28 the maps @xmath325 @xmath326 @xmath327 are isomorphisms",
    ".    since @xmath328 , therefore is an isomorphism if and only if so is [ via psi  ] .",
    "( recall that @xmath329 . ) 1    as for and , note first that the proper map @xmath48 induces a surjection @xmath330 of  @xmath331 onto a closed subscheme @xmath281 of  @xmath55 ; so @xmath332 with @xmath333 a closed  immersion and @xmath330 surjective . 1",
    "let @xmath334 be a compactification of @xmath0 .",
    "since @xmath335 is proper , so is @xmath336 , whence @xmath337 maps @xmath338 homeomorphically onto a closed subset of @xmath277 , and for each @xmath339 the natural map @xmath340 is a surjection ( see @xcite ) ; thus @xmath337 is a closed immersion , and therefore @xmath341 is of finite type , hence , by @xcite , proper ( since @xmath342 is).1    since @xmath343 and @xmath344 , it suffices that the proposition hold when @xmath345 i.e. , we may assume that @xmath346 _ is a closed immersion .",
    "_ it s enough then to show that and become isomorphisms after application of the functor @xmath347 .    via projection isomorphisms ,",
    "the map @xmath348 is isomorphic to the map @xmath349 and making the substitution @xmath350 in the isomorphism leads to an isomorphism between the map @xmath351 and the map3 @xmath352 via adjunction and projection isomorphisms , is isomorphic to @xmath353 by lemma  [ supp ] , @xmath354 , so [ gampsi ] gives that is an isomorphism , whence so is .",
    "thus is an isomorphism .",
    "also , so  [ hom and tensor 0 ] shows that is an isomorphism , whence so is .",
    "[ for ftd ] ( added in proof . ) for an @xmath6-map @xmath0 , with compactification @xmath159 , set @xmath355 it is shown in ( * ? ? ?",
    "* section 4 ) that @xmath356 depends only on @xmath316 , in the sense that up to canonical isomorphism @xmath356 is independent of the factorization @xmath159 .",
    "( when this paper was written it was known only that @xmath357 is canonically isomorphic to @xmath358 when @xmath359 . ) likewise , for all @xmath299 the functorial map",
    "@xmath360 depends only on @xmath0 ( * ? ? ?",
    "* section 8) .",
    "so one may set @xmath361 and @xmath362 ; and then the preceding proof of proposition  [ pullback1 ] works for _ all _ @xmath299 .",
    "corollaries [ psi via rhom][vargm ] provide concrete interpretations of the map   @xmath225 for certain localizing immersions @xmath73 .",
    "proposition  [ r1.1.3.5 ] gives a purely algebraic expression for @xmath9 when @xmath0 is a _ flat _",
    "@xmath6-map between affine schemes .",
    "an elaboration for when the target of @xmath0 is the spec of a field is given in proposition  [ affine / k ] .",
    "the scheme.5pt - theoretic results  [ relation ] , [ base change ] and  [ pullback1 ] tell us some facts about the pseudofunctorial behavior of @xmath9 ; but how to prove these facts by purely algebraic arguments is left open .",
    "[ rhom ] let @xmath139 be an @xmath6-map , and let @xmath363 .",
    "the functorial isomorphism  @xmath364 inverse to that gotten by setting @xmath365 in   makes the following , otherwise natural , functorial diagram commute@xmath366 @xmath367       \\node(11 ) at ( 1,-1){\\3 } ;        \\node(12 ) at ( 2,-1){{\\mathbf{1 } } } ;         \\node(31 ) at ( 1,-3){\\4 } ;       \\node(32 ) at ( 2,-3){\\5 } ;            \\draw[- > ] ( 11)--(12 ) node[above=1pt , midway , scale=.75 ] { $ \\zeta(f{\\mkern1mu})$ } ;             \\draw[- > ] ( 31)--(32 ) node[above=1pt , midway , scale=.75 ] { $ \\iso$ } ;              \\draw[- > ] ( 11)--(31 ) ;         \\draw[- > ] ( 12)--(32 ) ;                 { \\end{tikzpicture}}\\ ] ]    abbreviating @xmath368 to @xmath369 and @xmath370 to @xmath371 , one checks that the diagram in question is right - conjugate to the natural diagram , functorial in @xmath372 , @xmath373       \\node(11 ) at ( 1,-1){{\\mathbf{1 } } } ;        \\node(12 ) at ( 2,-1){\\2 } ;        \\node(13 ) at ( 3,-1){\\3 } ;        \\node(21 ) at ( 1,-2){\\5 } ;       \\node(23 ) at ( 3,-2){\\4 } ;            \\draw[<- ] ( 11)--(12 ) node[above=1pt , midway , scale=.75 ] { $ \\textup{projection}$ } ;        \\draw[<- ] ( 12)--(13 ) node[above=1pt , midway , scale=.75 ] { $ \\iso$ } ;         \\draw[<- ] ( 21)--(23 ) node[above=1pt , midway , scale=.75 ] { $ \\iso$ } ;              \\draw[<- ] ( 11)--(21 ) ;         \\draw[<- ] ( 13)--(23 ) ;              { \\end{tikzpicture}}\\ ] ] whose commutativity is given by @xcite ) .",
    "[ psi via rhom ] for any localizing immersion @xmath249 and @xmath253 the map @xmath374 from   is isomorphic to the natural composite map @xmath375    this is immediate from [ rhom ] ( with @xmath270 ) .    for the next corollary recall that , when @xmath376 , the sheafification functor @xmath377 is an isomorphism from @xmath378 to the derived category of quasi - coherent @xmath379-modules , whose inclusion into @xmath380 is an equivalence of categories @xcite .",
    "[ affine locimm ] in if @xmath381 and @xmath376 are affine  so that @xmath73 corresponds to a flat epimorphic ring homomorphism @xmath382and @xmath383 then @xmath384 is the sheafification of the natural @xmath39-map @xmath385    use the following well - known facts:2    \\1 .",
    "@xmath386.2    this results from the sequence of natural isomorphisms , for any @xmath387 : @xmath388    -8pt 2 .",
    "@xmath389.1    \\3 .",
    "@xmath3901    \\4 . for any @xmath391 ,",
    "the natural @xmath392-map @xmath393 is the sheafification of the natural @xmath39-map @xmath394 .",
    "[ vargm ] let @xmath32 be a noetherian ring that is complete with respect to the topology defined by an ideal   @xmath395 let @xmath396 be a proper map , and let @xmath397 be the inclusion . for any @xmath363 whose cohomology modules are all coherent , @xmath398 .    since @xmath399 (  [ cosa : localizing - immersion ] )",
    ", it suffices that @xmath400 , that is , by  [ psi via rhom ] , that @xmath401 .",
    "set @xmath402 .",
    "there is a natural triangle @xmath403 it is enough therefore to show that @xmath404 is an isomorphism .",
    "let @xmath405 be the formal completion of @xmath277 along @xmath287 .",
    "for any @xmath379-module @xmath406 let @xmath407 be the completion of @xmath406an @xmath408-module ; and let @xmath409 be the functor given objectwise by @xmath410 . the composition of @xmath404 with the  greenlees.5pt - may \" isomorphism @xmath411 given by @xcite is , by _",
    "loc.cit._ , the map   @xmath412 , where @xmath413 is the unique map whose composition with the canonical map @xmath414 is the completion map @xmath415 .",
    "so we need @xmath412 to be an isomorphism . hence , the isomorphisms @xmath416 in @xcite ) ( where @xmath417 is denoted @xmath418 ) and @xmath419 in @xcite ( which requires coherence of the cohomology of @xmath420 ) reduce the problem to showing that _ _ the natural composite map__=-1 @xmath421 _ is the completion map . _    by the description of @xmath422 preceding @xcite ,",
    "this amounts to commutativity of the border of the following natural diagram : @xmath423       \\node(11 ) at ( 1,-1){{\\mathbf{1 } } } ;        \\node(12 ) at ( 2,-1){\\6 } ;        \\node(13 ) at ( 3,-1){\\5 } ;         \\node(21 ) at ( 1,-2){\\2 } ;        \\node(22 ) at ( 2,-2){\\3 } ;          \\node(23 ) at ( 3,-2){\\4 } ;              \\draw[- > ] ( 11)--(12 ) node[above=1pt , midway , scale=.75 ] { $ $ } ;        \\draw[double distance = 2pt ] ( 12)--(13 ) ;          \\draw[- > ] ( 21)--(22 ) node[above=1pt , midway , scale=.75 ] { $ $ } ;        \\draw[double distance = 2pt ] ( 22)--(23 ) ;               \\draw[- > ] ( 11)--(21 ) ;         \\draw[- > ] ( 12)--(22 ) ;                 \\draw[<- ] ( 2.97,-1.8)--(2.97,-1.2 ) ;       \\draw[- > ] ( 3.03,-1.8)--(3.03,-1.2 ) ;      { \\end{tikzpicture}}\\ ] ] verification of the commutativity is left to the reader .",
    "[ sigma , sigma ] next we generalize corollary  [ affine locimm ] , replacing @xmath73 by an arbitrary flat map @xmath424 in @xmath6 , corresponding to a flat ring - homomorphism @xmath425 .",
    "lemma  [ l1.1.1 ] gives an expression for @xmath9 for an _ arbitrary _ flat @xmath6-map @xmath0 , that in the foregoing affine case implies , as shown in lemma  [ l1.1.3 ] , that for @xmath426 , and @xmath37 , @xmath427 is ( naturally isomorphic to ) the sheafification of the natural composite @xmath39-map @xmath428 or , more simply , ( see proposition  [ r1.1.3.5 ] ) , @xmath429 ( the expanded notation in  [ l1.1.3 ] and  [ r1.1.3.5 ] indicates the @xmath33-actions involved . )",
    "so let @xmath430 be a _ flat _",
    "@xmath6-map , let @xmath431 be the diagonal , and let @xmath432 be the projections from to @xmath16 .",
    "there is a base - change isomorphism @xmath433 , as in   [ bch ] .",
    "there is also a base - change map @xmath434 as in proposition  [ base change]1 ( with @xmath435 ) ; this @xmath436 need not be an isomorphism.2    the next lemma concerns functors from @xmath437 to @xmath57 .",
    "[ l1.1.1 ] with preceding notation , there is an isomorphism of functors @xmath438 such that the map @xmath439 from   is the composite @xmath440    consider the diagram , where @xmath441 and @xmath442 are the natural isomorphisms , @xmath443 the left square obviously commutes , and the right square commutes by proposition  [ base change ] . since @xmath444 is proper , proposition  [ pullback1 ] guarantees that @xmath445 is an isomorphism , while @xmath446 is an isomorphism since @xmath447 is .    the lemma results , with @xmath448    [ r1.1.1.5 ] the map @xmath9 in lemma   factors as @xmath449 where the maps labeled @xmath160 are induced by units of adjunction , and the isomorphism obtains because @xmath450 .    by lemma  [ l1.1.1 ] it suffices that the following diagram commute .",
    "@xmath451       \\node(11 ) at ( 1,-1){{\\mathbf{1 } } } ;         \\node(12 ) at ( 2,-1){\\2 } ;        \\node(13 ) at ( 3,-1){\\3 } ;          \\node(21 ) at ( 1,-2){\\4 } ;        \\node(22 ) at ( 2,-2){\\5 } ;       \\node(23 ) at ( 3,-2){\\6 } ;               \\node(32 ) at ( 2,-3){\\7 } ;            \\draw[- > ] ( 11)--(12 ) node[above , midway , scale=.75 ] { $ \\eta$ } ;        \\draw[- > ] ( 12)--(13 ) node[above , midway , scale=.75 ] { $ { \\mathsf r}\\pi_{2{\\mkern1mu}*}\\beta$ } ;             \\draw[- > ] ( 21)--(22 ) node[above=1pt , midway , scale=.75 ] { $ $ } ;       \\draw[- > ] ( 22)--(23 ) node[above=1pt , midway , scale=.75 ] { $ \\operatorname{{\\textup{via}}}\\beta$ } ;                  \\draw[- > ] ( 11)--(21 ) node[left=1pt , midway , scale=.75 ] { $ \\simeq$ } ;                \\draw[- > ] ( 12)--(22 ) node[left=1pt , midway , scale=.75 ] { $ \\eta$ } ;                      \\draw[- > ] ( 13)--(23 ) node[right=1pt , midway , scale=.75 ] { $ \\eta$ } ;          \\draw[- > ] ( 21)--(32 ) node[below=-1pt , midway , scale=.75 ]                                           { $ { \\mathsf l}\\delta^*\\beta\\mkern40mu$ } ;        \\draw[- > ] ( 32)--(23 ) node[below=1pt , midway , scale=.75 ] { $ $ } ;              \\node at ( 1.43,-1.51)[scale=.9]{{\\textcircled{\\scriptsize{1 } } } } ;       { \\end{tikzpicture}}\\ ] ] commutativity of the unlabeled subdiagrams is clear .",
    "subdiagram  1 ( without @xmath1 ) expands as @xmath452       \\node(11 ) at ( 1,-1){{\\mathbf{1 } } } ;         \\node(13 ) at ( 3,-1){\\2 } ;           \\node(21 ) at ( 1,-2){\\9 } ;        \\node(22 ) at ( 2,-2){\\0 } ;           \\node(31 ) at ( 1,-3){\\4 } ;      \\node(32 ) at ( 2,-3){\\8 } ;     \\node(33 ) at ( 3,-3){\\5 } ;           \\draw[- > ] ( 11)--(13 ) node[above , midway , scale=.75 ] { $ \\eta$ } ;              \\draw[double distance=2pt ] ( 21)--(22 ) ;           \\draw[double distance=2pt ] ( 31)--(32 ) ;         \\draw[- > ] ( 32)--(33 ) node[above , midway , scale=.75 ] { $ \\iso$ } ;                     \\draw[double distance=2pt ] ( 11)--(21 ) ;               \\draw[- > ] ( 21)--(31 ) node[left=1pt , midway , scale=.75 ] { $ \\simeq$ } ;       \\draw[- > ] ( 22)--(32 ) node[right=1pt , midway , scale=.75 ] { $ \\simeq$ } ;                      \\draw[- > ] ( 13)--(33 ) node[right=1pt , midway , scale=.75 ] { $ \\eta$ } ;          \\draw[- > ] ( 11)--(22 ) node[above=-2pt , midway , scale=.75 ]                                           { $ \\mkern20mu\\eta$ } ;              \\node at ( 2.5,-2)[scale=.9]{{\\textcircled{\\scriptsize{2 } } } } ;       { \\end{tikzpicture}}\\ ] ] commutativity of subdiagram 2 is given by ( * ? ? ?",
    "* ( 3.6.2 ) ) .",
    "verification of commutativity of the remaining two subdiagrams is left to the reader .",
    "[ rem : affine - case ] we now concretize the preceding results in case @xmath453 and @xmath454 are affine , so that the flat map @xmath139 corresponds to a flat homomorphism @xmath425 of noetherian rings .    first , some notation . for a ring @xmath131",
    ", @xmath455 will denote the category of @xmath131-modules .",
    "forgetting for the moment that @xmath456 is flat , let @xmath457 be a flat ring - homomorphism . if @xmath458 is the obvious functor such that @xmath459 then , since ( by flatness of @xmath460 ) any k - injective @xmath42-complex is k - injective over  @xmath32 , there is a derived functor @xmath461 such that , with @xmath462 a family of k - injective @xmath42-resolutions , and @xmath463 , @xmath464    set @xmath465.1    let @xmath466 be the @xmath32-algebra homomorphism with @xmath467 .",
    "there is a natural functorial isomorphism in @xmath468 : @xmath469 ( for this , just replace @xmath420 by a k - injective @xmath42-resolution . )    let @xmath470 be the @xmath32-algebra map with @xmath471 .",
    "let @xmath472 be the restriction - of - scalars functor induced by   @xmath460 ; and define @xmath473 analogously .",
    "then , in @xmath39 , @xmath474 there results a  multiplication \" map in @xmath475 : @xmath476 and hence a natural composition in @xmath39 @xmath477    now , assuming @xmath456 to be flat , we derive algebraic expressions for @xmath1 and  @xmath3 .",
    "application of the functor @xmath478 to item 1 in the proof of corollary  [ affine locimm ] , gives @xmath479 .",
    "since @xmath480 is an equivalence of categories @xcite , it results from the canonical isomorphism ( with @xmath463 , @xmath426 and @xmath481 the functor given by restricting scalars ) @xmath482 that there is a functorial isomorphism @xmath483 such that @xmath484 is the isomorphism @xmath485 in lemma  [ rhom].1    next , let @xmath486 be the projection maps , and let be the diagonal map",
    ". set @xmath37 .",
    "note that if @xmath106 is a homomorphism of rings , corresponding to @xmath487 , and if @xmath488 , then @xmath489 this follows easily from the fact that the functor @xmath490 preserves both quasi - isomorphisms and k - flatness of complexes .",
    "[ l1.1.3 ] there is a natural functorial isomorphism of the map @xmath491 with the sheafification of the natural composite @xmath39-map @xmath492    using and  , and the fact that sheafification is an equivalence of categories from @xmath39 to   @xmath493 ( @xcite ) , one translates the definition of the base.5pt - change map  @xmath436 in  [ base change ] to the commutative.5pt - algebra context , and finds that @xmath494 is naturally isomorphic to the sheafification of the natural composite @xmath495-map @xmath496 where the isomorphism comes from   ( with @xmath497 ) .",
    "lemma  [ l1.1.1 ] gives that @xmath9 is naturally isomorphic to the composite @xmath498 whence the conclusion .",
    "here is a neater description of @xmath499and hence of @xmath500 .",
    "[ r1.1.3.5 ] the map @xmath499 in   factors as @xmath501 where @xmath502 is induced by the natural @xmath378-map @xmath503 .",
    "note that @xmath502 is the natural composite @xmath39-map @xmath504 recall the description in the proof of  [ l1.1.3 ] of the map @xmath436 , refer to the factorization of @xmath500 coming from  , and fill in the details .    from [ r1.1.3.5 ] and",
    "it follows easily that :    for any @xmath505 , the map @xmath506 from sheafifies the natural composite @xmath39-map @xmath507 where @xmath508 takes @xmath509 to the map @xmath510 .",
    "@xmath511    using proposition  [ gampsi ] , we now develop more information about the above map @xmath499 when @xmath512 is an essentially - finite.5pt - type algebra over a field @xmath513 , and @xmath514 .    for any @xmath515 , let @xmath516 be the injective hull of the residue field @xmath517",
    "let @xmath518 be a _",
    "normalized residual complex , _ thus a complex of the form @xmath519 where for each integer @xmath520 , @xmath521 is the direct sum of the @xmath516 as @xmath522 runs through the primes such that @xmath523 has dimension @xmath520 .",
    "the sheafification of @xmath524 is @xmath525 where @xmath526 and where we identify @xmath513 with the structure sheaf of @xmath527 , see ( * ? ? ?",
    "* chapter  vi ,  1 ) .",
    "[ affine / k ] under the preceding circumstances , there exists a split exact sequence of @xmath33-modules @xmath528{${\\scriptstyle}{{\\mathfrak p}}\\textup { nonmaximal}$}}j({{\\mathfrak p } } ) { \\longrightarrow}\\operatorname{hom}_\\sigma(s , k ) { \\xrightarrow}{\\,\\psi^0\\ , } i{\\mkern1mu}^0{\\longrightarrow}0,\\ ] ] such that for each nonmaximal prime @xmath529 @xmath530 is a direct sum of uncountably many copies of  @xmath531 and in @xmath532 @xmath533 is the composition @xmath534    since @xmath535 is an injective @xmath33-module , there is a decomposition @xmath536 -2pt where , @xmath537 being the natural composite map @xmath538 , @xmath539 is the dimension of the @xmath540-vector space @xmath541    in particular , if @xmath522 is maximal ( so that @xmath542 ) then @xmath543 .",
    "thus @xmath535 has a direct summand @xmath544 isomorphic to @xmath545 .",
    "( this @xmath544 does not depend on the foregoing decomposition : it consists of all @xmath546 such that the @xmath33-submodule @xmath547 has finite length . )    now since @xmath524 is a bounded injective complex , the @xmath39-map @xmath548 is represented by an ordinary map of @xmath33-complexes @xmath549 , that is , by a map of @xmath33-modules @xmath550 . by  [ l1.1.3 ] ,",
    "the sheafification of  @xmath548 is @xmath551 , and hence proposition  [ gampsi ] implies that @xmath552  maps  @xmath544 isomorphically onto @xmath545 .",
    "thus @xmath552 has a right inverse , unique up to automorphisms of @xmath545 ; and @xmath535 is the direct sum of @xmath544 and   @xmath553 , whence @xmath554{${\\scriptstyle}{{\\mathfrak p}}\\textup",
    "{ nonmaximal}$}}i({{\\mathfrak p}})^{\\mu({{\\mathfrak p}})}.\\ ] ] last , in ( * ? ?",
    "* theorem 1.11 ) it is shown that for nonmaximal  @xmath522 , @xmath555 with equality if @xmath33 is finitely generated over @xmath513 .",
    "( reduction theorems . ) at least for flat maps , @xmath198 can be used to prove one of the main results in @xcite , namely theorem 4.6 ( for which only a hint of a proof is given there ) . with notation as in  [ sigma , sigma ] , and again , @xmath37 , that theorem  4.6 asserts the  existence of a complex @xmath518 , depending only on @xmath556 , and for all @xmath456-perfect @xmath557 ( i.e. , @xmath35 is isomorphic in @xmath378 to a bounded complex of flat @xmath32-modules , the cohomology modules of @xmath35 are all finitely generated over @xmath33 , and all but finitely many of them vanish ) , and all @xmath391 , a functorial @xmath39-isomorphism4 @xmath558 in particular , @xmath559 this explicit description is noteworthy in that the sheafification is a _ relative dualizing complex _",
    "@xmath46 , where @xmath560 ( see ( * ? ? ?",
    "* example 2.3.2 ) or lemma  [ l1.1.3 ] above ) ; and otherwise - known definitions of @xmath3 involve choices , of which @xmath3 must be proved independent.2    the present proof will be based on the isomorphism in lemma below , which is similar to ( and more or less implied by ) the isomorphism in @xcite.2    let @xmath139 be an arbitrary map in @xmath6 .",
    "let @xmath561 , and let @xmath562   and  @xmath563 be the projections from @xmath564 to @xmath16 .",
    "for @xmath565 there  are natural maps2 @xmath566    the first of these is the unique one making the following otherwise natural diagram ( whose top left entry is in @xmath567 ) commute:2 @xmath568    in @xcite it is shown that for _ perfect _",
    "@xmath6-maps @xmath569 ( that  is , @xmath109  has finite flat dimension ) , the functor @xmath570 extends pseudofunctorially to a functor  still denoted @xmath571from @xmath380 to @xmath11 such that 1 @xmath572    for proper @xmath109 , the extended @xmath571 is still right - adjoint to @xmath573 ( see ( * ? ? ? * proof of prop.5.9.3 ) ) .",
    "the complex @xmath574 is _ perfect relative to _ @xmath0 ( or simply @xmath0-_perfect _ ) if @xmath35  has coherent cohomology and has finite flat dimension over @xmath277 .",
    "in particular , the map  @xmath0 is perfect if and only if @xmath12 is @xmath0-perfect .",
    "[ gmap ] if the @xmath6-map @xmath139 is flat and @xmath574 is @xmath316-perfect , then for all the composite map   is an isomorphism .",
    "it holds that @xmath575 and @xmath576 ( see proof of  @xcite ) ; and so the vertical arrows in are isomorphisms .",
    "so is the bottom arrow in ( see e.g. , ( * ? ? ?",
    "* ( 4.6.6 ) ) ) .",
    "hence the first map in is an isomorphism .    as for the second",
    ", from the flatness of @xmath0 it follows that @xmath577 is @xmath578-perfect , and that there is a base.5pt - change isomorphism ( cf .  )",
    "@xmath579 the conclusion follows then from  @xcite ( with @xmath580 , @xmath581 , @xmath582 , and with @xmath583 replaced throughout by @xmath584 ) , in whose proof we can replace the duality isomorphism  ( 5.9.1 ) there by in this paper , and use the definition of @xmath571 for any finite.5pt - flat - dimensional map @xmath109 in  @xmath6 ( for instance @xmath48 , @xmath153 and @xmath74 in _ loc.cit._ ) , thereby rendering unnecessary the boundedness condition in _ loc.cit . _ on  the complex  @xmath585 .",
    "( in this connection , note that if @xmath586 with @xmath153 smooth and @xmath74 a closed immersion then @xmath74 is perfect . )    for @xmath139 a flat @xmath6-map and @xmath587 set @xmath588 and consider the composite map , with @xmath589 @xmath590 where the first map is induced by @xmath591 , and the isomorphism on the right is gotten by inverting the one given by [ gmap ] and then replacing by the isomorphic object @xmath592 ( see and ) .",
    "remark 6.2 in @xcite authorizes replacement in ( [ setup2].5pt ) of @xmath35 by @xmath593 , and recalls that the natural map is an isomorphism @xmath594 ; thus one gets the composite map @xmath595    [ global4.6 ] if @xmath587 is @xmath0-perfect , and @xmath589 then application of   @xmath596 @xmath597resp .",
    "@xmath598 to the composite @xmath597resp .",
    "@xmath5991 produces an isomorphism @xmath600    by  [ pullback1 ] , application of @xmath601 to the first map in  ( [ setup2].5pt ) produces an isomorphism . similarly , in view of , applying @xmath602 ( @xmath603 ) to the first map in  ( [ setup2].5pt)@xmath604 produces an isomorphism .    using remark  [ for ftd ] for the first map in ( [ setup2].5pt )",
    ", _ one can extend theorem  [ global4.6 ] to all _ @xmath605 .",
    "this results immediately from the fact , given by ( * ? ? ?",
    "* proposition 7.11 ) , that _",
    "if @xmath606 is a compactification of a perfect @xmath6-map then the following natural map is an isomorphism _ : @xmath607    [ globalization ] the first isomorphism in theorem  [ global4.6 ] is a globalization ( for flat @xmath0 and cohomologically bounded - below @xmath608 ) of ( * ? ? ?",
    "* theorem4.6 ) .",
    "let @xmath425 be an essentially - finite - type flat homomorphism of noetherian rings , @xmath609 , @xmath37 and @xmath610 the canonical maps .",
    "let @xmath611 , where @xmath35 is and @xmath524 is  a relative dualizing complex , sheafifying to ( * ? ? ?",
    "* example 2.3.2 ) . set @xmath612 , @xmath613 , @xmath561 , and let @xmath614 be the diagonal . then",
    "( as the cohomology of @xmath35 is bounded and finitely generated over @xmath33 ) @xmath615 sheafifies @xmath616 , and , with notation as in  [ sigma , sigma ] , @xmath617 sheafifies @xmath618 thus in this situation , application of @xmath619 to gives the existence of a functorial isomorphism ( that should be closely related to  if not identical with  the one in @xcite ) .",
    "[ redn - iso ] let @xmath0 be as in [ gmap ] , and let @xmath620 be the diagonal map .",
    "keeping in mind the last paragraph of section  [ rhom^qc ] above , one checks that the reduction isomorphism ( * ? ? ?",
    "* corollary 6.5 ) @xmath621 \\tag{\\ref{redn - iso}.1}\\ ] ] is inverse to the second isomorphism in  [ global4.6 ] .",
    "( in @xcite , see the proof of corollary  6.5 , and the last four lines of the proof of theorem  6.1 with @xmath622 , @xmath623 , and @xmath624 , so that @xmath625 . )    in the affine case , with assumptions on @xmath456 , @xmath35 and @xmath608 as above ,  desheafification \" of ( i.e. , applying derived global sections to ) produces a functorial isomorphism @xmath626 with the same source and target as the one in ( * ? ? ?",
    "* , theorem 1 ) .",
    "( we suspect , but do nt know , that the two isomorphisms are the same  at least up to sign . )",
    "[ intres ] in this section we review , from the perspective afforded by results in this paper , some known basic facts about _ integrals , residues and fundamental classes . _ the description is mostly in abstract terms .",
    "what will be new is a direct _ concrete _ description of the fundamental class of a flat essentially - finite.5pt - type homomorphism @xmath425 of noetherian rings ( theorem  [ explicit fc]).2    let @xmath627 be an ideal such that @xmath628 is a finite @xmath32-module , and let @xmath629 be the subfunctor of the identity functor on @xmath33-modules  @xmath35 given objectwise by @xmath630 there is an obvious map from the derived functor @xmath631 to the identity functor on @xmath39 .    in view of the isomorphism",
    ", one can apply derived global sections in to get , in the present context , the following diagram , whose rectangle commutes . in this diagram",
    ", @xmath481 is the functor given by restricting scalars ; and @xmath632 is a canonical module of  @xmath456 ( that is , an @xmath33-module whose sheafification is a relative dualizing sheaf of @xmath526 , as in remark  [ barint ] , where the integer @xmath311 is defined as well ) ; and @xmath524 is , as in  [ globalization ] , a relative dualizing complex.4 @xmath633 $ } \\def\\4{${\\mathsf r}{\\mkern-1mu}{\\mkern-1mu}\\operatorname{hom}_r(s , r)$ } \\def\\5{${\\mathsf r}{\\mkern-1mu}{\\mkern-1mu}\\operatorname{hom}_r(r , r)$ } \\def\\6{$r$ } \\def\\7{$\\sigma_{{\\mkern-1mu}{\\mkern-1mu}*}{\\mathsf r}{\\mkern-1mu}{\\mkern-1mu}\\operatorname{hom}_\\sigma(s , r)$ } { \\begin{tikzpicture}}[xscale=4.7 , yscale=2.5 ]       \\node(11 ) at ( 1,-1 ) { { \\mathbf{1 } } } ;          \\node(12 ) at ( 2.3,-1){\\2 } ;        \\node(13 ) at ( 2.92,-1){\\3 } ;          \\node(151 ) at ( 1,-1.5){\\7 } ;        \\node(21 ) at ( 1,-2){\\4 } ;         \\node(215 ) at ( 1.75,-2){\\5 } ;        \\node(22 ) at ( 2.3,-2){\\6 } ;           \\draw[- > ] ( 11)--(12 ) node[above , midway , scale=.7]{$\\iso$ }                                      node[below=1pt , midway , scale=.7]{$\\operatorname{{\\textup{via}}}\\psi$ } ;      \\draw[<- ] ( 12)--(13 ) ;        \\draw[- > ]   ( 21)--(215 ) node[below=1pt , midway , scale=.7]{$\\operatorname{{\\textup{via}}}\\sigma$ } ;      \\draw[double distance=2pt ] ( 215)--(22 ) ;      \\draw[- > ] ( 11)--(151 ) ;      \\draw[double distance=2pt ] ( 151)--(21 ) ;        \\draw[- > ] ( 12)--(22 ) node[right=2pt , midway , scale=.7]{$\\bar{\\!\\int^{}}_{\\!\\!i}$ } ;        { \\end{tikzpicture}}\\ ] ] if @xmath456 is cohen - macaulay and equidimensional , the natural map is an isomorphism @xmath634{{\\mkern8mu\\longrightarrow \\mkern-25.5mu{}^\\sim\\mkern17mu}}d^\\sigma$ ] ; and application of @xmath635 to the preceding diagram produces a commutative diagram of @xmath32-modules3 @xmath636       \\node(11 ) at ( 1,-1 ) { { \\mathbf{1 } } } ;          \\node(13 ) at ( 2.3,-1){\\3 } ;          \\node(21 ) at ( 1,-2){\\4 } ;         \\node(22 ) at ( 2.3,-2){\\6 } ;          \\draw[- > ] ( 11)--(13 ) node[above , midway , scale=.7]{$\\iso$ }                                      node[below=1pt , midway , scale=.7]{$\\operatorname{{\\textup{via}}}\\psi$ } ;        \\draw[- > ]   ( 21)--(22 ) node[below=1pt , midway , scale=.7]{$\\textup{evaluation at 1}$ } ;        \\draw[- > ] ( 11)--(21 ) ;        \\draw[<- ] ( 22)--(13 ) node[midway , right=1pt , scale=.7]{$\\int_i$ } ;     { \\end{tikzpicture}}\\ ] ] this shows that _ an explicit description of @xmath637 1 is more or less the same as an explicit description of @xmath638and so , when @xmath639 is a maximal ideal , of residues .",
    "_  explicit \" includes the realization of the relative canonical module  @xmath632 in terms of regular differential forms ( cf .",
    "remark  [ barint ] ) .",
    "such a realization comes out of the theory of the _ fundamental class _ @xmath640 of a flat @xmath6-map @xmath0 , as indicated below .",
    "this @xmath640 is a key link between the abstract duality theory of @xmath0 and its canonical reification via differential forms .",
    "it may be viewed as an orientation , compatible with essentially tale base change , in a suitable bivariant theory on the category of flat @xmath6-maps @xcite.2    given a flat @xmath6-map @xmath139 , with @xmath562 and @xmath563 the projections from @xmath641 to @xmath16 , and @xmath614 the diagonal map , let @xmath642 be , as in ( * ? ? ?",
    "* example 2.3 ) , the natural composite @xmath56-map4 @xmath643    let @xmath644 be the kernel of the natural surjection @xmath645 . using a flat @xmath317-resolution of @xmath646 one",
    "gets a natural isomorphism of @xmath12-modules @xmath647 whence a map of graded - commutative @xmath12-algebras , with @xmath648 , @xmath649    in particular one has , with @xmath311 as above , a natural composition @xmath650 ( in the literature , the term  fundamental class \" often refers to this @xmath651 rather than to @xmath652 . )",
    "when @xmath0 is essentially smooth , this map is an isomorphism , as is @xmath653 .",
    "( the proof uses the known fact that there exists an isomorphism @xmath654 , but does not reveal the relation between that isomorphism and  @xmath651 , see @xcite . ) it follows that if @xmath0 is just _ generically _ smooth , then @xmath651 is a generic isomorphism . for example , if @xmath16 is a reduced algebraic variety over a field @xmath513 , of pure dimension @xmath311 , with structure map @xmath655 , then one deduces that @xmath656 is canonically represented by a coherent sheaf of meromorphic @xmath311-forms  the sheaf of regular @xmath311-forms  containing the sheaf  @xmath657 of holomorphic @xmath311-forms , with equality over the smooth part of  @xmath55 .",
    "from @xmath651 and the above @xmath638 one deduces a map @xmath658 that generalizes the classical residue map .",
    "theorem  [ explicit fc ] below provides a direct concrete definition of the fundamental class of a flat essentially - finite - type homomorphism @xmath425 of noetherian rings .",
    "first , some preliminaries . as",
    "before , set @xmath37 , let @xmath659 be the homomorphism such that for @xmath52 , @xmath660 , and @xmath661 such that @xmath471 .",
    "let @xmath662 be the scheme.5pt - map corresponding to  @xmath456 .",
    "let @xmath562 and  @xmath563 be the projections ( corresponding to @xmath99 and @xmath100 ) from @xmath663 to @xmath55.1    let @xmath664 and @xmath665 be as in  [ rem : affine - case ] .    for an @xmath33-complex @xmath420 , considered as an @xmath45-complex via the multiplication map @xmath666 , let @xmath667 be the @xmath45-homomorphism taking @xmath668 to the map @xmath669 .    for an @xmath33-complex @xmath142",
    ", there is an obvious @xmath45-isomorphism @xmath670 taking @xmath142 to be a k - injective resolution of @xmath420 ( over @xmath33 , and hence , since @xmath456 is flat , also over @xmath32 ) , one gets the isomorphism in the following statement .",
    "[ l3.2.3 ] let @xmath671 have sheafification @xmath672 .",
    "the sheafification of the natural composite @xmath495-map @xmath673 is the natural composite @xmath674with @xmath271 the counit map@xmath675 @xmath676",
    "the sheafification of @xmath677 is @xmath678 , see .",
    "likewise , with @xmath679 the multiplication map , and @xmath680 , one has that @xmath681 is the sheafification of @xmath682 ; and lemma  [ rhom ] implies that @xmath271 is the sheafification of the  evaluation at 1 \" map@xmath683    moreover , one checks that the isomorphism @xmath684 is the sheafification of the natural isomorphism1 @xmath685 .    under the allowable assumption that @xmath420 is k - injective",
    ", one finds then that is the sheafification of the map @xmath686 that takes @xmath668 to the map @xmath687 $ ] .",
    "it is simple to check that @xmath688 .",
    "[ explicit fc ] let @xmath425 be a flat essentially - finite - type map of noetherian rings , and @xmath34 the corresponding scheme - map .",
    "let  @xmath689 be the @xmath45-homomorphism taking @xmath52 to multiplication by @xmath53 .",
    "then the fundamental class @xmath690 given by   is naturally isomorphic to the sheafification of the natural composite map @xmath691    it suffices to show that the map in theorem  [ explicit fc ] sheafifies to a map isomorphic to the canonical composite map @xmath692 ( see , in which the last two maps are isomorphisms ) . 1    applying pseudofunctoriality of @xmath7 ( corollary  [ relation ] ) to @xmath693 , one sees that the map in factors as @xmath694 where the isomorphism is from proposition  [ pullback1 ] .",
    "thus the conclusion follows from lemma   [ l3.2.3 ] .",
    "let @xmath42 be a finite tale @xmath32-algebra .",
    "the ( desheafified ) fundamental class @xmath695 is the @xmath696-isomorphism from @xmath697 to  @xmath698 taking 1 to the trace  map .",
    "* example 2.6).)1    if @xmath33 is an essentially tale @xmath42-algebra ( for instance , a localization of @xmath42 ) , then there is a canonical identification of @xmath699 with @xmath700 .",
    "( this fact results from ( * ? ? ?",
    "* and 3.1 ) , but can be proved more directly . )",
    "however ,  @xmath699 depends only on @xmath382 , not on @xmath42 .",
    "the goal of this appendix is to establish some basic facts  used repeatedly in   [ proper - support]about the relation between subsets of a noetherian scheme @xmath16 and  localizing tensor ideals \" in @xmath11.2    _ notation _ : let @xmath16 be a noetherian scheme . for any @xmath701,1 let @xmath702 be the stalk @xmath703 , let @xmath704 be the residue field of @xmath702 , let @xmath705 be the corresponding sheaf on @xmath706a  quasi - coherent , _ flasque _ sheaf , let @xmath707 be the canonical ( flat ) map  a localizing immersion,1 and let @xmath708 a quasi - coherent flasque @xmath12-module whose stalk at a point @xmath709 is @xmath704 if @xmath709 is a specialization of @xmath710 , and 0 otherwise.1      let @xmath714 ( @xmath715 ) be the full subcategory of @xmath56 spanned by the complexes with coherent cohomology modules ( vanishing in all but finitely many negative degrees )",
    ". for affine @xmath16 and @xmath716 the next lemma appears in  ( * ? ? ?",
    "* top of page 158 ) .      for @xmath17 , there is a projection isomorphism @xmath720 -1ptapplying @xmath721 to this isomorphism , and recalling from  [ cosa : localizing - immersion ] that @xmath722 is isomorphic to the identity , we get @xmath723 these two isomorphisms tell us that @xmath724 vanishes in @xmath11 if and only if @xmath725 vanishes in @xmath726 .",
    "now suppose @xmath719 and @xmath736 , i.e. , @xmath737.1 let  @xmath738 be the koszul complex on a finite set of generators for the maximal ideal of the local ring @xmath739 .",
    "it is easy to check that the full subcategory of @xmath740 consisting of complexes @xmath741 such that @xmath742 is a thick subcategory .",
    "it contains @xmath704 , and hence also @xmath738 , since the @xmath739-module @xmath743 has finite length , see @xcite .",
    "thus1 @xmath744 in @xmath740 ; and since the cohomology of @xmath745 is finitely generated in all degrees , @xcite ) gives   thus , @xmath746 ; and so @xmath747 .",
    "the next proposition is proved in @xcite in the affine case ; and in @xcite ( where localizing tensor ideals are called _ rigid localizing subcategories _ )",
    "the proof is extended to noetherian schemes .",
    "( use e.g. , _ ibid . ,",
    "_ corollary  4.11 and the bijection in theorem 4.12 , as described at the beginning of its proof.)1            let @xmath748 ( resp .",
    "@xmath759 be the full subcategory spanned by the complexes @xmath741 such that @xmath760 ( resp .",
    "@xmath761 ) .",
    "it is clear that @xmath752 is a localizing tensor ideal ; and using the natural isomorphisms ( with @xmath762 ) , @xmath763 \\end{aligned}\\tag{\\ref{hom and tensor 0}.1}\\ ] ] -2ptone sees that @xmath764 is a localizing tensor ideal too .",
    "we claim that when @xmath142 is in @xmath752 it is also in @xmath764 . for this",
    "it s enough ,  by proposition  [ ideals ] , that for any @xmath765 , @xmath753 be in @xmath764 . by ( * ? ? ?",
    "* lemma  3.4 ) , there is a perfect @xmath12-complex @xmath741 such that @xmath766 is the closure @xmath767 .",
    "we have=-1 @xmath768 where the first equality holds by lemma  [ supp ] and the inclusion holds because @xmath15 is a union of closed sets . thus [ ideals ] yields @xmath769 ; and the dual complex @xmath770 is in  @xmath764 , because @xmath771 .",
    "since @xmath772 -1pttherefore [ ideals ] gives that , indeed , @xmath773 .",
    "the same argument holds with @xmath125 in place of @xmath776 .",
    "( after that replacement , the isomorphisms   still hold if @xmath777 is prefixed by @xmath778 : this can be checked by applying the functors @xmath779 for all @xmath780.)2    as for the rest , recall that @xmath781 : when @xmath15 itself is closed , this results from the standard triangle ( with @xmath782 the inclusion ) @xmath783\\ ] ] ( or from the local representation of @xmath784 by a @xmath785 of koszul complexes ) ; and then for the general case , use that @xmath786 where @xmath277 runs through all closed subsets of @xmath287 .      the last part of ( i ) results then from the standard isomorphism @xmath791 ( for which see , e.g. , @xcite or 3.2.5(i))1 when @xmath15 itself is closed , then pass to the general case using @xmath792 and applying ( i ) to the third vertex of a triangle based on @xmath793 gives ( ii ) .",
    "as seen a few lines back , @xmath796 for as @xmath753 is flasque , the canonical map @xmath797 is an isomorphism .",
    "the assertion is then that @xmath798 ( i.e. , @xmath799 , which is easily verified since @xmath753 is constant on @xmath767 and vanishes elsewhere .",
    "next , if @xmath807 then @xmath808 : to see this , one reduces easily to the case in which @xmath73 is the natural map @xmath809 , where @xmath35 is a multiplicatively closed subset of the noetherian ring @xmath115 ( see  [ locimm ] ) .",
    "since @xmath753  vanishes outside @xmath767 , it follows that @xmath810 whenever @xmath807 . using the projection isomorphism",
    "@xmath811 one  sees then that ( iii)@xmath806(i ) .",
    "the complexes @xmath324 satisfying ( i ) span a localizing tensor ideal .",
    "so do those @xmath420 satisfying ( iii ) : the full subcategory spanned by them is triangulated , as one finds by applying @xmath812 to a triangle based on a @xmath11-map @xmath813 ; @xmath814 is closed under direct sums ( since @xmath243 respects direct sums , see ( * ? ? ? *",
    "lemma 1.4 ) , whose proof  in view  of the equivalence of categories mentioned above just before [ affine locimm]applies to @xmath815 ; and @xmath814 is a tensor ideal since @xmath816 for all @xmath17 .",
    "so [ ideals ] shows that for the implication ( i)@xmath806(iii ) we need only treat the case @xmath817 .    since @xmath818 ( see , e.g. , @xcite ) , it suffices now to note that if @xmath819 then @xmath820 so the canonical map1 in the definition of @xmath753 ( near the beginning of this appendix ) factors as @xmath821 , whence  @xmath822 satisfies ( iii ) .    [ supp u _ * ] with @xmath73 as in [ l1.-1 ] , one checks that if @xmath819 then ( with self - explanatory notation ) @xmath823 . also , as above , if  @xmath807 then @xmath824 . so for @xmath825 , @xmath826 and since for @xmath827 , @xmath828\\iff [ { \\mathsf r}u_*f=0{\\mkern1mu}]$ ] , therefore @xmath829\\ ] ]                            , s.b .  iyengar , depth and amplitude for unbounded complexes .",
    "_ commutative algebra and its interaction with algebraic geometry ( grenoble - lyon , 2001 ) _ , contemp .",
    "vol . * 331 * , amer .",
    "soc . , providence , r.i .",
    "( 2003 ) , 119137 .",
    ", j.  dieudonn , _ elments de gomtrie algbrique ii , tude gobale lmentaire de quelques classes de morphisme .",
    "_ publications mathmatiques , * 8 * , institut des hautes tudes scientifiques , paris , 1961 .    , j.  dieudonn , _ elments de gomtrie algbrique iv , tude locale des schmas et des morphismes of schmas .",
    "_ publications mathmatiques , * 28 * , * 32 * , institut des hautes tudes scientifiques , paris , 1966 , 1967 .",
    "j.  lipman , notes on derived categories and grothendieck duality .",
    "_ foundations of grothendieck duality for diagrams of schemes .",
    "_ lecture notes in math . , * 1960 * , springer - verlag , berlin - new york , 2009 , 1259"
  ],
  "abstract_text": [
    "<S> grothendieck duality theory assigns to essentially - finite - type maps   @xmath0 of noetherian schemes a pseudofunctor @xmath1 right - adjoint to @xmath2 , and a pseudofunctor @xmath3 agreeing with @xmath1 when @xmath0 is proper , but equal to the usual inverse image @xmath4 when @xmath0 is tale . </S>",
    "<S> we define and study a canonical map from the first pseudofunctor to the second . </S>",
    "<S> this map behaves well with respect to flat base change , and is taken to an isomorphism by  compactly supported \" versions of standard derived functors . </S>",
    "<S> concrete realizations are described , for instance for maps of affine schemes . </S>",
    "<S> applications include proofs of reduction theorems for hochschild homology and cohomology , and of a remarkable formula for the fundamental class of a flat map of affine schemes . </S>"
  ]
}