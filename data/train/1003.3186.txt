{
  "article_text": [
    "_ the nebulae are so numerous that they can not be studied individually .",
    "therefore , it is necessary to know whether a fair sample can be assembled from the most conspicuous objects and , if so , the size of the sample required _",
    "* chapter ii ) . even though these arguments are from the outset of extragalactic astronomy , and they refer to the morphological classification of galaxies , the reasons put forward by hubble remain valid today .",
    "the need to sort out and simplify justify all recent efforts to classify the spectra of galaxies (   [ intro.intro ] ) , including the present work .",
    "such attempts are now more significant than ever since we have never had the large catalogs of galaxy spectra available today .",
    "the seventh and final sloan digital sky survey data release ( sdss / dr7 ) provides spectra of some 930000 galaxies ( * ? ? ?",
    "* ; * ? ? ?",
    "* and also the sdss web site ) . this uniform data set offers a unique opportunity to comprehensively classify the different spectra existing among nearby galaxies",
    "our paper presents the results of an unsupervised spectral classification of all the catalog .",
    "unsupervised implies that the algorithm does not have to be trained .",
    "it is autonomous and self - contained , with minimal subjective influence .",
    "thus , we deliberately avoid the use of physical constraints , or other a priori knowledge .",
    "we classify all galaxies simultaneously , requesting that galaxies with similar rest - frame spectra belong to the same class .",
    "this approach is in the vein of the rules for a good classification discussed by @xcite , where he points out that physics must not drive a classification .",
    "otherwise the arguments become circular when the classification is used to drive physics .",
    "the _ k - means _",
    "algorithm that we implement is commonly employed in data mining , machine learning , and artificial intelligence ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ) , but it has been seldom applied in astronomy ( see , however , * ? ? ?",
    "* ) . from the point of view of the algorithm ,",
    "the galaxy spectra are vectors in a high - dimensional space , where they are distributed among a number of cluster centers .",
    "each vector is assigned to the cluster whose center is nearest , and the center is the average of all the points in the cluster .",
    "it works iteratively .",
    "starting from guess cluster centers , the spectra are assigned to their nearest centers , and then the centers are re - computed until convergence is reached .",
    "( further details are given in ",
    "[ algorithm ] . )",
    "we choose it because of its extreme computational simplicity , as required to deal with large data sets (   [ algorithm ] ) , and because it turned out to work very well in the first case we attempted . to our surprise ,",
    "the algorithm managed to separate spectra of galaxies in the _ green valley _ within a collection of dwarf galaxies encompassing the full range of spectral types @xcite .",
    "therefore , we found it natural to test the ability of _ k - means _",
    "to distinguish among all kinds of galaxy spectra , and the success of this follow - up exercise is precisely the work reported here .",
    "in addition to the above virtues , the _ k - means _  method provides a prototypical high signal - to - noise spectrum for each class of galaxy , being the spectra of the galaxies in a class similar to the associated prototypical spectrum .",
    "these few representative spectra can be studied and characterized in detail as if they were individual galaxies , and then their properties can be attributed to all class members (   [ applications ] ) .",
    "other popular classification methods lack this powerful and convenient feature ( see   [ intro.intro ] ) .",
    "the acronym ask stands for automatic spectroscopic k - means - based , and it is used throughout the text to denote our classification . the paper is structured as follows . ",
    "[ intro.intro ] provides an overview of the main spectral classification methods employed so far .",
    "it also summarizes systematic trends resulting from the application of those methods .",
    "our _ k - means _  classification algorithm is examined in ",
    "[ algorithm ] , where we test the class recovery upon known classes (   [ test_qbcd ] ) , we analyze the repeatability of the classification (   [ recovery ] ) , and we assign probabilities to class membership (   [ assigning ] ) .",
    "the sdss / dr7 dataset is briefly introduced in   [ data_set ] .",
    "the actual classification of sdss / dr7 is described in   [ final_imp ] .",
    "the askclassification   is compared with principal component analysis ( pca ) classification in   [ pca_class ] ( see also   [ intro.intro ] ) .",
    "the self - consistency of the askclassificationis discussed in various sections dealing with specific results ; relationship between ask class and hubble type (   [ ask_class_vs_morph ] ) , ask class and color sequence (   [ colorscolors ] ) , ask class and agn activity (   [ ask_vs_agn ] ) , and ask class and redshift (   [ ask_vs_redshift ] ) . further applications of the classification procedure are sketched in   [ applications ] . the askclassification  is publicly available as we explain in   [ conclusions ] .",
    "this section also outlines ongoing works based on ask .",
    "the first spectral classifications of galaxies are almost coeval with the discovery of the hubble sequence .",
    "@xcite discusses how the spectral types and colors systematically vary within the morphological sequence , being ellipticals the reddest and open spirals the bluest ( see also * ? ? ?",
    "one of the early attempts to set up an spectroscopic classification of galaxies is that by @xcite .",
    "they assign the blue part of the visible spectrum ( 3850  ",
    "4100 ) to stellar classes from a to k. they find a clear relationship between spectral class and shape , with the most concentrated galaxies ( e , s0 ) belonging to class k , and the most diffuse galaxies ( sc , irr ) included in class a. the relationship applies to some 80% of the galaxies , a percentage probably larger for the targets of highest luminosity .",
    "@xcite shows how the visible and ir colors of galaxies along the hubble sequence can be understood as a one parameter family , in terms of the superposition of spectra of a0v dwarf stars and m0iii gigant stars .",
    "@xcite points out that a simple model consisting of two stellar spectral types can reproduce the observed broad band colors , but only if the spectral types are allowed to vary .",
    "five primary spectral types result from this modeling .",
    "similar conclusions are also reached by @xcite using stellar spectrum fitting .    principal component analysis ( pca ) is probably the most popular classification method employed so far .",
    "each spectrum is decomposed as a linear superposition of a small number of eigenspectra , so that a few coefficients in this expansion ( eigenvalues ) fully describe the spectrum .",
    "it is fairly fast and robust , and a solid mathematical theory supports it @xcite . to the best of our knowledge",
    ", the first applications of pca in this field have to do with stellar classification ( e.g. , * ? ? ?",
    "* ) , then moved to quasar spectra ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ) , and finally arrived to the spectral classification of regular galaxies ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "pca is the method of reference , and we compare it in   [ pca_class ] with our _ k - means_. two general results are common to all pca analyses .",
    "spectrumwise , galaxies can be characterized and distinguished by means of a single parameter that links the coefficients of the two or three first eigenspectra",
    ". then different classes are obtained by splitting ( somewhat artificially ) this 1-dimensional family into pieces .",
    "the approach holds for 2df galaxies @xcite , for galaxies in @xcite @xcite , for las campanas redshift survey galaxies @xcite , for deep2 galaxies @xcite , for iue galaxies @xcite , and for sdss @xcite .",
    "the second common result is the correspondence between spectral sequence and hubble type .",
    "even though ellipticals tend to be red and spirals tend to be blue , such relationship has a large intrinsic scatter @xcite , which augments towards the uv @xcite .",
    "sometimes elliptical galaxies with blue colors are found in the local universe ( e.g. , * ? ? ?",
    "* ) , and this deviation from the trend is expected to grow even further with increasing redshift if , as @xcite argues , it is a coincidence that hubble types correlate with colour in the nearby universe . at higher redshifts",
    "morphologically classified ellipticals are often blue in colour and actively forming stars @xcite .    despite the advantages mentioned above",
    ", pca presents a clear drawback .",
    "it does not provide prototypical spectra to characterize the classes .",
    "the pca eigenspectra do not resemble any member of the data to be classified and , in general , eigenspectra are of difficult physical interpretation ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "the advantage of having classes characterized by prototypical spectra is clear .",
    "these few spectra can be studied in detail using standard diagnostic techniques developed for individual galaxies through the years .",
    "then the attributes of the prototypical spectra can be passed on to the class members , or they can be used as intermediate grid - points to interpolate the properties of the class members ( see   [ applications ] ) .",
    "moreover , the differences between a particular galaxy and its class prototype allow for precise relative measurements . in an attempt to complement pca with this feature",
    ", @xcite developed an _ archetypal analysis _ algorithm .",
    "as the authors explain , it is like pca but the eigenspectra are required to be members or mixtures of members of the input data set .",
    "however , by construction , the eigenspectra are extreme data points lying on the data set outskirts . although physically meaningful , the eigenspectra are outliers , and it may be difficult to connect their physical properties with those of typical galaxy spectra .",
    "other improvements on the basic pca technique are local linear embedding @xcite , and ensemble learning independent component analysis @xcite .",
    "these extensions are computationally expensive , and so far they have been introduced only as proof - of - concept works .",
    "in addition to the superposition of stellar spectra and the pca techniques described above , galaxies have been classified using neuronal networks @xcite , massive lostless data compression @xcite , information bottleneck @xcite , and probably others .",
    "the algorithms have flourished in response to the availability of new large spectral databases .",
    "we are still in an expanding phase , which should lead to a final convergence of the various techniques .",
    "the different methods seem to roughly coincide in the global picture , but it is so far unclear whether they agree in the details .",
    "in the context of classification algorithms , galaxy spectra are vectors in a high dimensional space , with as many dimensions as the number of wavelengths in use .",
    "the galaxy catalog to be classified is a set of vectors in this space , and so the ( euclidean ) distance between any pair of them is well defined .",
    "vectors ( i.e. , spectra ) are assumed to be clustered around a number of cluster centers .",
    "the classification problem consists in ( a ) finding the number of clusters , ( b ) finding the cluster centers , and ( c ) assigning each galaxy in the catalog to one of these centers .",
    "we employ the _ k - means _",
    "algorithm to carry out this classification ( see , e.g. , chapter  5 in * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) . in the standard formulation ,",
    "it begins by selecting at random from the full data set a number @xmath1 of template spectra .",
    "each template spectrum is assumed to be the center of a cluster , and each spectrum of the data set is assigned to the closest cluster center ( i.e. , that of minimum distance or , equivalently , closest in a least squares sense ) .",
    "once all spectra in the dataset have been classified , the cluster center is re - computed as the average of the spectra in the cluster .",
    "this procedure is iterated with the new cluster centers , and it finishes when no spectrum is re - classified in two consecutive steps .",
    "the number of clusters @xmath1 is arbitrarily chosen but , in practice , the results are insensitive to such selection since only a few clusters possess a significant number of members , so that the rest can be discarded . on exit ,",
    "the algorithm provides a number of clusters , their corresponding cluster centers , as well as the classification of all the original spectra now assigned to one of the clusters .    the algorithm is simple and fast , as required to treat large data sets .",
    "it assures that galaxies with similar spectra end up in the same cluster , and provides cluster centers , i.e. , prototypical spectra representative of all the galaxies in a cluster .",
    "in addition , it seems to work very well separating galaxy spectra , as inferred from the first test ( see   [ intro ] ) , and from this work .",
    "unfortunately , it has a major drawback .",
    "it yields different clusters with each random initialization . after pondering pros and cons",
    ", we decided to carry on with the algorithm , but not without evaluating the impact of the initialization on the classification .",
    "the impact is quantified and controlled through three complementary methods : ( 1 ) carrying out different random initializations and comparing their results , ( 2 ) assigning galaxies to several classes , each one with its own probability , and ( 3 ) trying alternative methods of initialization .",
    "the first point is dealt with in   [ test_qbcd ] and   [ final_imp ] , leading to classifications whose classes share some 70% of the galaxies .",
    "it is not 100% because of spectra lying in between classes .",
    "this difficulty is to some extent cured by the second point , treated in   [ assigning ] , which allows us to assign galaxies to several classes and , therefore , to identify galaxies in class borders .",
    "the third point is treated in the next paragraph , concluding that the scatter in the classification is not significantly modified by the mode of initialization .",
    "it does modify the timing , though .",
    "we tried several initialization methods , including the standard one , that by @xcite , and others @xcite .",
    "none of them seem to reduce the scatter due to the initial random seed (   [ test_qbcd ] and   [ final_imp ] ) .",
    "this behavior can be understood in terms of the existence of borderline galaxies , as argued in appendix  [ change_center ] .",
    "a proper initialization , however , reduces the iterations required to converge , and speeds up the procedure .",
    "we have adopted our own method , which is simple and fast , and it starts off with a reduced number of classes .",
    "it tries to select initial cluster centers according to the clusters that exist in the data set .",
    "if initial centers are purely chosen at random , then the clusters having the largest number of elements are overrepresented , and minor clusters may be even absent .",
    "the procedure works as follows : ( step 1 ) choose at random a small set of initial cluster centers ( say , 10 ) .",
    "( step 2 ) run one iteration of the standard _ k - means _ , and select as initial cluster center the cluster center with the largest number of elements .",
    "( step 3 ) remove from the set of galaxies to be classified those belonging to the selected cluster center .",
    "( step 4 ) go to step 1 if galaxies are still left ; otherwise end .",
    "in addition to this particular initialization , we tuned the standard _ k - means _  described above with one extra ingredient .",
    "the iteration loop ends when the classifications in two successive steps are sufficiently close one another , i.e. , when 99% of the assignations do not vary between two iterations .",
    "this simplification speeds up the convergence since the classification of the remaining 1% takes a long time , and does not help finding the main galaxy classes , already well characterized by 99% of the sample .",
    "two classifications of the same data set are identical if they include the same galaxies in each class . with this criterion in mind ,",
    "we compare two different classifications by pairing their two sets of classes according to the number of galaxies that they have in common .",
    "we compute the number of galaxies in common between each pair of classes formed by one class from one classification and the second class from the second classification .",
    "the two classes sharing the largest number of galaxies are assumed to be _",
    "equivalent_. the same criterion is repeated until all the classes of one of the classifications have been paired . since the number of classes in the two classifications are not necessarily the same",
    ", some classes remain unpaired .",
    "this procedure tries to maximize the number of galaxies sharing the same class in the two classifications .",
    "we use the percentage of galaxies in equivalent classes as a measurement of the agreement between the two classification , dubbing it coincidence rate .",
    "a first series of tests to check repeatability has been carried out using the 21493 quiescent blue compact dwarf galaxies ( qbcd ) selected by @xcite from sdss / dr6 .",
    "here we employ the same wavelength windows used in @xcite  ( @xcite ; they are labeled as qbcd in table  [ tab1 ] ) .",
    "thirty independent classifications of this data set yield a coincidence rate of @xmath2  % , with the error bar being the standard deviation .",
    "we think that the origin of these fluctuations in the number of common galaxies is due to the random initialization coupled with the large number of variables defining the spectra ; see appendix  [ change_center ] .",
    "this 70% coincidence has two consequences .",
    "( 1 ) a galaxy chosen at random from the sample has a 70% chance of appearing in equivalent classes in two different runs of the classification .",
    "( 2 ) the cluster centers are very well defined since , independently of the initialization , they share 70% of the galaxies that define them .",
    "the coincidence of the final classification of sdss / dr7 is similar ( but a bit smaller ) , as it is discussed in detail in ",
    "[ final_imp ] .",
    "we construct a set of mock observations to see whether the algorithm is able to recover clusters imposed on the data . to a data set of 21493 spectra ( same number as in   [ test_qbcd ] ) , we add different amounts of pixel - to - pixel uncorrelated random noise .",
    "the 21493 spectra were randomly selected among three real spectra representative of galaxies along the color sequence in the blue cloud , the red sequence , and the green valley ( see   [ colorscolors ] ) .",
    "this 3-class mock observation encompasses the full range of spectra to be expected .",
    "when no noise is added , the algorithm returns 3 classes , with 100  % coincidence between the original and the classified spectra .",
    "as the noise increases , the number of recovered classes increases too .",
    "the fact that new classes have appeared does not mean that the algorithm is malfunctioning . actually , the algorithm seems to be classifying the noise .",
    "when the signal - to - noise ratio per pixel is @xmath310 , which is typical of sdss spectra , one retrieves some 10 classes .",
    "however , the spectra of the different original classes are never mixed up , i.e. , they end up in separate classes .",
    "the noise artificially increases the number of classes , but it does not wash them out . moreover , it is easy to figure out which classes are faked by this kind of random noise because , being pixel - to - pixel uncorrelated , it does not modify global properties of the spectra such as colors .",
    "different classes with different colors are not artifacts created by noise .",
    "given a collection of galaxy spectra , the _ k - means_algorithm infers a small set of classes or clusters , and assigns each spectrum to one of them . a number of reasons advice addressing the inverse problem too , i.e. , assigning classes to individual spectra once the classes are known .",
    "this alternative is required to classify spectra not used in the classification , which turns out to be a practical case of major interest ( e.g. ,   [ final_imp ] ,   [ ask_class_vs_morph ] ) .",
    "in addition , the classification does not provide unique sharp classes .",
    "the results in   [ test_qbcd ] suggest that a significant number of galaxies are in between classes , and this fact could be easily acknowledged and quantified with a procedure to estimate the probability that a given galaxy belongs to each one of the known classes .",
    "borderline galaxies must fit in several classes with similar probabilities . a general procedure to carry out such multiple assignation",
    "is worked out in this section .",
    "the distance of spectrum @xmath4 to class center @xmath5 is defined as , @xmath6^{1/2 } , \\label{def_dispersion}\\ ] ] where @xmath7 and @xmath8 are the values of the spectrum and the cluster center in the @xmath9th wavelength pixel .",
    "the weights @xmath10 allow one to select a subset among the pixels defining the spectra , i.e. , @xmath11 with @xmath12 the total number of pixels where @xmath13 . _",
    "k - means _  selects as class center the average of all the spectra belonging to the class .",
    "each one of these spectra has its own distance to the cluster center , so that the full set defines a distribution of distances to the cluster center for the spectra in the class .",
    "let us call @xmath14 the probability density function ( pdf ) of such distribution , i.e. , @xmath15 is the probability of finding a galaxy in cluster * c * with a distance to the cluster center between @xmath16 and @xmath17 .",
    "the chances that galaxy * s * belongs to cluster * c * can be estimated as the probability of finding galaxies in the cluster with distances equal or larger than @xmath18 , i.e. , @xmath19 unfortunately , sorting the classes according to their @xmath20 may be inconsistent with the assignation of classes made by _ k - means_. given a galaxy spectrum , _ k - means _  assigns to it the class of minimum distance , i.e. , the class @xmath21 where @xmath22 . however , there is no guarantee that the class of minimum distance coincides with the class of maximum probability , i.e. , in general @xmath23 with @xmath24 defined so that @xmath25 .",
    "consequently , the sorting of classes according to their probabilities can not be used to order classes in a way that agrees with _ k - means_. we circumvent the problem defining a merit function , based on probabilities , that can be used to judge the membership of a given galaxy to the various classes . as a main constraint",
    ", the class of minimum distance must have the largest merit , so that the ordering provided by this merit function agrees with the assignation made by the _ k - means _  algorithm .",
    "we call such merit function _",
    "quality_. for a spectrum * s * , assigned by _ k - means _   to class @xmath21 ,",
    "the quality of class @xmath26 is defined as , @xmath27 given a spectrum , its membership to various classes is judged according to @xmath28 , with the class of largest @xmath28 the main affiliation , the one of second largest @xmath28 , the second main , and so on .",
    "the sorting according to quality is actually a sorting according to distance to the cluster centers since , @xmath29 this property guarantees that the class of minimum distance has the largest quality and , therefore , the main class attending to its quality agrees with the _ k - means _  assignation .",
    "equation  ( [ ecu1 ] ) follows from eq .",
    "( [ prop1 ] ) because @xmath30 is always positive , and so , @xmath28 is a monotonic decreasing function of @xmath31 .",
    "in addition to conforming to _ k - means _ , the quality @xmath28 has a number of practical properties .",
    "due to the normalization of the pdfs , @xmath32 the quality is always comprised between zero , for no match , and one , for perfect match , @xmath33 the best quality , i.e. , that of the class of minimum distance , admits a simple interpretation .",
    "it is just the probability that the galaxy belongs to this class because , @xmath34 if the best quality is large , then there are high chances that the galaxy is part of the class .",
    "if the best quality is similar to the second best quality , then the galaxy is in between classes .",
    "if the best quality is very small ( @xmath35 ) , then the galaxy is an outlier , meaning that it does not fit into any of the main classes .",
    "computing qualities as explained above requires estimating the pdf for the distribution of distances within a class .",
    "this can be derived from the histogram of distances to the cluster center among the galaxies that _ k - means _",
    "has included within the class .",
    "after several trials , we found out that the observed cumulative distribution of distances can be very well approximated as , @xmath36 ^ 2\\big],\\ ] ] where the five free coefficients @xmath37 are determined by a non - linear least - squares fit of the empirical cumulative histogram of observed distances .",
    "figure  [ cumula ] shows one of such fits .",
    "real qualities are represented in fig .",
    "[ set_quality1 ] , which includes the results in one of the test classifications in   [ test_qbcd ] .",
    "figure  [ set_quality1 ] , top , shows scatter plots of the 2nd - best quality versus the best quality ( top left ) , and the 3rd - best quality versus the best quality ( top right ) .",
    "a significant number of galaxies appear not far from the border where the best and 2nd - best qualities are equal and , therefore , many galaxies lie in between classes .",
    "figure  [ set_quality1 ] , bottom , shows the histograms of those qualities .",
    "note how the best quality has a rather flat distribution peaking at , say , 0.6 .",
    "note also how the number of galaxies with very small best quality is also very small .",
    "these are outliers whose spectra differ significantly from the characteristic spectra of the main classes .",
    "the sdss / dr7 is the final major data realease of the sdss project .",
    "details about sdss and the dr7 can be found in , e.g. , @xcite , @xcite , and also in the thorough sdss  website .",
    "the spectroscopic part of the survey contains some 930000 galaxy spectra , and this full set is classified in our work .",
    "the basic properties of spectrograph and spectra will be summarized here , but we refer to the references given above for further details .",
    "the sdss spectrograph has two independent arms , with a dichroic separating the blue beam and the red beam at 6150  .",
    "it simultaneously renders a spectral range from 3800  to 9250 , with a spectral resolution between 1800 and 2200 .",
    "the sampling is linear in logarithmic wavelength , with a mean dispersion of 1.1pix@xmath38 in the blue and 1.8pix@xmath38 in the red .",
    "repeated 15 min exposure spectra are integrated to yield a s / n per pixel @xmath39 when the apparent magnitude in the @xmath0-band is 20.2 .",
    "the spectrograph is fed by fibers which subtend about 3on the sky .",
    "most galaxies are larger than this size therefore the fibers tent to sample their central regions ( e.g. , 88% of the galaxies have effective radii larger than half the fiber diameter ) .",
    "two adjustments are made on the original spectra before classification .",
    "first , they are brought to restframe wavelengths using the redshifts provided by sdss .",
    "this wavelength shift involves an interpolation , and we take advantage of this need to bring to a common wavelength scale all spectra , as required by the classification algorithm .",
    "the common scale has the same number of pixels as the original spectra ( 3850 ) , and it is equispaced in logarithmic wavelength from 3800  to 9250 . obviously , the ir part of the spectrum is missing as the redshift increases , and we extrapolate it with a constant .",
    "note , however , that this missing part is not used for classification ( see below and   [ final_imp ] ) .",
    "the second manipulation is a global scaling applied after the resframe correction .",
    "the spectra are normalized to the flux in the @xmath0  color filter ( effective wavelength @xmath40 4825 ) , a normalization factor that we compute for each spectra using the transmission curve provided by sdss .",
    "this re - scaling automatically corrects for the flux dimming associated with the redshift ( e.g. , * ? ? ?",
    "* ) , but the original motivation was allowing comparison between galaxies of different absolute magnitudes .",
    "if the global scaling is not removed , the flux of the galaxy completely dominates the classification , and galaxies are split in bins of equal luminosity , rather than in spectral classes .",
    "no further correction has been applied to the data .",
    "we do not correct for extinction , seeing , galaxy size , aperture bias , etc .",
    "this apparent sloppiness actually results from a deliberate attitude towards classification , following the guidelines by @xcite mentioned in   [ intro ] .",
    "if these corrections are important and the classification is working properly , then the spectra of the same type of galaxy with and without an uncorrected bias should appear in separate bins .",
    "it is then a matter of a posteriori physical interpretation to infer what causes the different classes , and eventually join some of them when appropriate .",
    "the spectra to be classified by _ k - means _   must share the same wavelength scale , i.e. , the same sampling interval and the same wavelength range .",
    "sdss / dr7 has a significant number of galaxies up to redshift 0.5 ( see fig .",
    "[ scatter1 ] ) . at this redshift",
    "the reddest restframe wavelength that sdss provides is 6200 , therefore , in order to use the full data set for classification , one should restrict the range of wavelengths down to 6200 .",
    "alternatively , one can restrict the range of redshifts of the galaxies .",
    "we have chosen the second possibility to avoid overlooking in the classification lines as important as h@xmath41 .",
    "the full set of spectra described in   [ data_set ] has been divided into a low redshift part ( redshift @xmath42 , with 788677 spectra ) and a high redshift part ( redshift @xmath43 , with 138649 spectra ) .",
    "the low redshift part is classified by means of the _ k - means _",
    "algorithm , which provides the classes .",
    "then the high redshift part is classified according to the classes derived from the low redshift part using the tools developed in   [ assigning ] .",
    "the reason for choosing 0.25 as the dividing redshift is twofold .",
    "first , the distribution of redshifts in sdss / dr7 seems to present a discontinuous behavior at roughly this redshift ( see fig .",
    "[ scatter1 ] , and also the discussion in   [ ask_vs_redshift ] ) .",
    "second , and most important , 0.25 is the largest redshift that allows us to include for classification the near - ir tio bands characteristic of m stars  the reddest restframe wavelength at this redshift is some 7500 .     magnitude ( left ) and absolute @xmath0 magnitude ( right ) versus redshift for the galaxies in the sdss / rd7 .",
    "the plots include only a fraction of the galaxies chosen at random to avoid overcrowding . , scaledwidth=50.0% ]    in addition to removing the reddest part of the spectrum missed by the redshift of the galaxies , several reasons advice using only selected bandpasses to carry out the classification . including too much continuum does not add information but dilutes the signals contained in the spectral lines .",
    "the number of wavelengths in the spectra sets the dimensions of the vectors to be classified .",
    "the larger the number of wavelengths the more computationally demanding the classification , which makes it advisable limiting the number of wavelengths . keeping these caveats in mind",
    ", we use for classification only the bandpasses shown as dotted lines in the bottom of fig .  [ classification ] , which are also listed in table  [ tab1 ] . except for a near - ir window between 8400  and 8800 ,",
    "they include all the bandpasses employed by @xcite in the classification that triggered the present work ( see   [ intro ] ) .",
    "these bandpasses contain the main emission lines that trace activity ( star formation and agn activity ) .",
    "since they are distributed along the visible spectrum , they also provide sensitivity to the colors of the galaxies .",
    "in addition , we include all the bandpasses of the lick indexes , which were selected because they depend on the age and metallicity of the stellar content of the galaxies@xcite . finally , we include two windows at the location of tio bands characteristic of m stars and early type galaxies ( at 7150and 7600 ) .",
    "these bandpasses are sensitive to the level of the near - ir continuum , and are tracers of old stellar populations .",
    "cl 4000  4420 & qbcd blue , h@xmath44 , h@xmath45 , cn@xmath46 , cn@xmath47 , + & ca4227 , g4300 , h@xmath48 , h@xmath49 , fe4383 + 4452  4474 & ca4455 + 4514  4559 & fe4531 + 4634  4720 & fe4668 + 4800  5134 & qbcd green , h@xmath50 , fe5015 , mg@xmath46 + 5154  5196 & mg@xmath47 , mg@xmath51 + 5245  5285 & fe5270 + 5312  5352 & fe5335 + 5387  5415 & fe5406 + 5696  5720 & fe5709 + 5776  5796 & fe5782 + 5876  5909 & na  d + 5936  5994 & tio@xmath46 + 6189  6272 & tio@xmath47 + 6500  6800 & qbcd red + 7000  7300 & tio band + 7500  7700 & tio band [ tab1 ]    initially , the computer resources needed to carry out the classification were unclear .",
    "the procedure is iterative (   [ algorithm ] ) , and the timing is mostly set by the number of iterations , which scales in a unknown fashion with the number of spectra and wavelengths ( @xmath52 ) .",
    "an exploratory procedure was written in interactive data language ( idl ) , and it turned out to be faster than expected since convergence occurs in , typically , less than 50 iterations . using a 8-core intel xeon 2.66ghz machine with 32 gb of ram , 50 iterations last less than 300 minutes .",
    "( the access to sufficient ram was critical , since the array with the spectra to be classified occupies some 11.6 gb . )",
    "even if fast , the idl code does not allow us to carry out the battery of classifications required to study the dependence of the classification on the random initialization (   [ algorithm ] ) .",
    "fortunately , the _ k - means _",
    "algorithm can be parallelized , and we developed a second parallel version of the code using fortran and the mpi ( message passing interface ) library .",
    "the performance of the parallel version is good .",
    "the algorithm scales very well , so that adding more cpus implies a near to linear reduction in the execution time .",
    "a hundred executions of the parallel code using a cluster of 48 intel xeon cpus ( 2.4ghz ) takes of the order of 1 hour .",
    "this figure outperforms the idl code by a factor of 500 .",
    "aided with the parallel version of _ k - means _ , we carry out 150 independent classifications of the data set . because of the random initialization , each one of these classifications differs (   [ algorithm ] ) .",
    "each run of the algorithm groups similar spectra in clusters so , in principle , all of them provide valid classifications .",
    "then the problem arises as to which one of these classifications is best , i.e. , which one should be chosen as _ the _ classification .",
    "ideally , one would like to choose a classification ( 1 ) with a small number of classes , ( 2 ) being representative of all classifications , and ( 3 ) having small dispersion within the classes .",
    "condition ( 1 ) is obvious and will not be discussed further . according to condition ( 2 )",
    ", we would like the classification to be as representative as possible of any other classification .",
    "condition ( 3 ) demands that the spectra employed in deriving the classification are as close as possible to a class center spectrum .",
    "figure  [ compare_chi2 ] shows scatter plots of three numerical coefficients that we devised to quantify the three requirements above .",
    "figure  [ compare_chi2]a and [ compare_chi2]c include the average percentage of galaxies that a particular classification has in common with the other 149 classifications ",
    "it is just the percentage of galaxies in equivalent classes as defined in ",
    "[ test_qbcd ] , and it is labeled in the figures as _ coincidence_. it spans between 62% and 71% .",
    "the coincidence is represented in fig .",
    "[ compare_chi2]a versus the average dispersion of the classification , which is just the mean of distance between galaxies and class centers defined in equation  ( [ def_dispersion ] ) .",
    "the dispersion admits a simple interpretation : it is the typical difference per pixel between a spectrum in its class .",
    "( because of the normalization , the spectra have their continuum at about one , therefore , dispersion 0.1 corresponds to differences of the order of 10% . )",
    "note that there is no obvious correlation between the two parameters , but the classifications seem to cluster around two dispersions , the smallest being of the order of 0.16 .",
    "figure  [ compare_chi2]b shows the scatter plot between the number classes in a classification ( classes altogether containing 99% of the galaxies ) and the dispersion",
    ". classifications having between 11 and 22 classes exist , with a typical value between 15 and 19 . again",
    "no obvious relationship between number of classes and dispersion is observed .",
    "finally , fig .",
    "[ compare_chi2]c shows the scatter plot of coincidence versus number of classes .",
    "attending to the three requirements above , we select those classifications having    1 .   less than 18 classes , 2 .   coincidence larger than 70% , 3 .   dispersion smaller than 0.17 .    .",
    "( a ) percentage of galaxies common to all other classifications ( coincidence ) versus typical scatter of the spectra with respect to the class spectrum ( dispersion ) .",
    "( b ) number of major classes versus dispersion .",
    "( c ) coincidence versus number of major classes .",
    "we select classifications having coincidence  @xmath53 , dispersion  @xmath54 , and 17  classes or less .",
    "scaledwidth=45.0% ]    four classifications fulfill these requirements .",
    "lacking a better criterion , we choose one of them at random .",
    "the chosen classification turns out to have a coincidence of 70.8% , a dispersion of 0.16 , and it has 28 classes , but 17 of them contain 99% of the galaxies .",
    "these 17 classes are denoted in the paper as _ major _ classes .",
    "the spectra of the major classes are shown in fig .",
    "[ classification ] .",
    "they have been labeled according to the @xmath55 color , from the reddest , ask0 , to the bluest , ask27 . by using numbers to label the classes we are not implicitly assuming that the spectra represent a one dimensional family .",
    "the numbers are only tags to name the classes .",
    "figure  [ sorting]a shows the colors characteristic of the ask classes . the number of elements corresponding to each class is included in fig .",
    "[ sorting]b .",
    "the horizontal dotted line in this figure indicates the threshold for major class , i.e. , classes with a number of elements above this threshold contain 99% of the classified galaxies .",
    "their spectra are those shown in fig .  [ classification ] .",
    "the main properties of all classes are summarized in table  [ tab2 ] .",
    "color of the template spectra , which explains the monotonous decrease of this color with class number .",
    "the larger the class number the bluer the galaxy .",
    "colors @xmath56 and @xmath57 are also included as indicated by the inset .",
    "( b ) histogram of the number of galaxies existing in each class .",
    "the horizontal dotted line shows the threshold that separates major classes from the rest ( i.e. , classes having altogether 99% of the classified galaxies ) .",
    "the colors and number of members shown in these figures are listed in table  [ tab2 ] .",
    ", scaledwidth=80.0% ]    a blow up with the bluest part of fig",
    ".  [ classification ] is included in fig .",
    "[ classificationc ] , where some of the characteristic emission and absorption features are labeled .",
    "note how the spectra vary gradually with the class number .",
    "even the smallest ripples in these average spectra are real . upon averaging",
    ", the signal - to - noise ratio is expected to increase as the square root of the number of class members .",
    "the major class with less members still has @xmath585000 elements ( fig .",
    "[ sorting]b ) , which sets a lower limit to the s / n per pixel of @xmath59 .",
    "the systematic change of global properties along the sequence is important to constrain the effects of noise on the number of classes (   [ test_qbcd ] ) .",
    "altough noise artificially increases the number of classes , it does not change in a systematic way global spectral properties such as colors . except",
    "perhaps at the blue end of the classification , the colors of classes vary systematically along the sequence ( fig  [ sorting ] ; see also   [ colorscolors ] ) , which discard any significant influence of the random pixel - to - pixel uncorrelated noise on the number of classes .",
    "clccccccccr 0@xmath60 & 111447 & 1.59 & 0.91 & 0.44 & -0.3 & 0.7 & 0.9 & 2.0 & 9&neutral 1@xmath60 & 18032 & 1.57 & 1.05 & 0.53&0.3 & 1.1 & 2.9 & 3.2 & 29&neutral 2@xmath60 & 213936 & 1.57 & 0.84 & 0.39&-0.4 & 0.4 & 0.1 & 1.3 & 2&good 3@xmath60 & 80530 & 1.37 & 0.75 & 0.35&-0.7 & 0.6 & 0.7 & 1.6 & 8&neutral 4@xmath60 & 20456 & 1.20 & 0.91 & 0.45&2.7 & 2.3 & 13.9 & 8.2 & 95&bad 5@xmath60 & 68626 & 1.18 & 0.80 & 0.38&1.5 & 1.6 & 8.5 & 5.3 & 78&neutral 6@xmath60 & 4669 & 1.17 & 0.77 & 0.34&3.5 & 29.6 & 14.2 & 10.9 & 98&good 7 @xmath61 & 1089 & 1.11 & 0.71 & 0.29&8.7 & 84.7 & 22.5 & 15.2&100&good 8 @xmath61 & 211 & 1.06 & 0.59 & 0.18&22.8&233.1 & 36.0 & 15.5 & 95&good 9@xmath60 & 71671 & 1.00 & 0.68 & 0.32&2.4 & 1.6 & 12.0 & 5.8 & 89&neutral10@xmath60 & 32227 & 0.95 & 0.72 & 0.34&5.1 & 2.7 & 24.2 & 11.1 & 99&neutral11@xmath60 & 6369 & 0.91 & 0.78 & 0.33&9.7 & 5.4 & 42.2 & 19.8&100&good12@xmath60 & 51314 & 0.83 & 0.58 & 0.26&5.4 & 3.0 & 24.5 & 9.3 & 98&good13@xmath60 & 26705 & 0.81 & 0.50 & 0.24&2.6 & 3.0 & 11.2 & 3.9 & 81&bad14@xmath60 & 25026 & 0.72 & 0.52 & 0.21&10.2 & 6.1 & 45.7 & 16.1 & 99&good15 @xmath61 & 68 & 0.70&-0.23&-0.57&176.4&743.5&715.3 & 14.1 & 25&good16@xmath60 & 26504 & 0.67 & 0.40 & 0.17&7.1 & 8.8 & 30.4 & 7.1 & 99&neutral17 @xmath61 & 134 & 0.65&-0.15&-0.51&161.7&630.1&549.9 & 16.4 & 35&good18@xmath60 & 5687 & 0.61 & 0.48 & 0.13&19.5 & 18.5 & 83.9 & 24.9&100&good19@xmath60 & 12808 & 0.61 & 0.36 & 0.13&13.0 & 21.6 & 54.6 & 9.8&100&good20 @xmath61 & 238 & 0.56&-0.03&-0.31&105.5&492.9&408.2 & 17.6 & 81&good21 @xmath61 & 179 & 0.55&-0.03&-0.29&97.1&461.5&356.7 & 16.6 & 69&good22@xmath60 & 4781 & 0.55 & 0.28 & 0.08&19.8 & 48.3 & 82.5 & 9.7&100&good23 @xmath61 & 2366 & 0.54 & 0.34 & 0.04&31.5 & 61.1&130.7 & 22.8 & 89&neutral24",
    "@xmath61 & 1910 & 0.51 & 0.22 & 0.00&34.5&106.6&148.5 & 12.9 & 98&good25 @xmath61 & 488 & 0.51 & 0.08&-0.16&72.3&253.8&302.7 & 18.5 & 94&good26 @xmath61 & 986 & 0.50 & 0.19&-0.07&51.7&159.9&219.3 & 19.6&100&good27 @xmath61 & 199 & 0.48 & 0.13&-0.16&67.4&230.7&278.8 & 19.7 & 85&good [ tab2 ]    as we explained in the first paragraph of the section , the full set of galaxies was split into two parts .",
    "the low redshift part has been used to derive spectral classes , which automatically leads to its classification as explained above .",
    "based on these classes , and using the procedure developed in   [ assigning ] , we extended the classification to the high redshift subset .",
    "the use of the same classes is an assumption which , however , seems to be secure since the properties of the galaxies thus classified do not show any systematic difference with respect to the low redshift subset ( see   [ ask_vs_redshift ] ) .",
    "moreover , the procedure in   [ assigning ] has been also applied to the low redshift part , already classified by _",
    "k - means_. it provides qualities for all classes , which permits identifying borderline galaxies and outliers , and it allows us deriving physical parameters by interpolation (   [ applications ] ) .    the success of _ k - means _   does not imply the existence of well defined clusters in the 1637-dimensional classification space . as we discuss above",
    ", the separation between classes is not sharp .",
    "galaxies are often close to the borders , which explains the variability between different realizations of the classification (   [ test_qbcd ] ) .",
    "the presence of many borderline galaxies seems to imply a rather continuous distribution of points in the classification space , that _ k - means _  astutely partakes assuring the elements of each class to be similar .",
    "generally speaking , classes should not be associated with true clusters in the classification space . however , some of the classes seem to represent genuine clusters as judged from the distribution of _ qualities_. qualities were introduced in   [ assigning ] to characterize the membership of each galaxy to the classes .",
    "galaxies next to class borders have similar best quality and 2nd - best quality . therefore ,",
    "if the galaxies in a class are of this kind , then the class can not portray a clear cluster .",
    "conversely , classes corresponding to well defined clusters have their members separated from the other classes , i.e. , their galaxies tend to have a best quality larger than the 2nd - best quality .",
    "this condition is met by some of the classes , indicating clustering .",
    "thus we use the ratio between best and 2nd - best qualities to assign a degree of grouping to the different classes .",
    "figure  [ membership ] shows histograms of the ratio between the best quality and the 2nd best quality for the major classes .",
    "some of the histograms have a clear peak at a ratio significantly smaller than one , implying clustering ( e.g. , ask  2 ) .",
    "other histograms present a flat distribution ( e.g. , ask  0 ) , whereas a minority of classes show most of their members having similar best and 2nd - best qualities ( e.g. , ask  13 ) .",
    "attending to the shape of these histograms , the clustering of each class has been labeled as good , neutral or bad ; see the last column of table  [ tab2 ] .",
    "note that the clustering tends to be good or neutral rather than bad .",
    "sdss / dr7 already provides a spectral classification based on pca , which is a linear expansion of each spectrum in terms of a small number of eigenspectra (   [ intro ] ) .",
    "the eigenspectra for the sdss expansion were derived from a subset of approximately 200000 galaxies , as explained by @xcite . following @xcite and others , @xcite use a diagnostic plot to separate spectral classes based on the three first eigenvalues , @xmath62 and @xmath63 .",
    "extreme emission galaxies , early type galaxies , and late type galaxies can be distinguished in the @xmath64 versus @xmath65 plane , where the two mixing angles are defined as @xmath66 figure  [ ask_vs_pca ] shows this diagnostic plot for all sdss / dr7 galaxies , and for the major ask classes separately .",
    "we have used the pca eigenvalues directly provided by sdss / dr7 .",
    "the ask classes occupy well defined places in the pca diagnostic plot , which implies that the pca classification and the ask classification are consistent .",
    "given the ask class of a galaxy , one can predict its location in the pca plane .",
    "the opposite does not hold since some ask classes overlap in the pca diagnostic plot ( cf .",
    "ask  9 and ask  10 ) .",
    "the ask classification is more refined ; it simply includes more classes than pca , therefore , the two classifications are consistent but not equivalent . the location of early type galaxies , late type galaxies , and extreme emission galaxies made by @xcite is also included in fig .  [ ask_vs_pca ] ( top left panel , symbols et , lt , and ee , respectively ) .",
    "one can see how this rough pca based separation is also consistent with the ask classes .",
    "there is a systematic trend to go from the location of the early types to the late types as the ask class number increases .",
    "this behavior coincides with the trend to be derived from the morphological classification in   [ ask_class_vs_morph ] .",
    "the region of extreme emission galaxies deserves a separate comment .",
    "note that the galaxies appearing in this region do not show up among the galaxies in the major classes included in fig .",
    "[ ask_vs_pca ] .",
    "these extreme galaxies belong to the minor classes with high ask class number ( not shown ) , i.e. , the bluest among the ask classes .",
    "the points clearly outside the contour in fig .",
    "[ ask_vs_pca ] are partly included in the ask classes next to them , and partly in additional minor classes ( not shown ) . ask  2 seems to be the only exception .",
    "it includes a few galaxies in the extreme emission region , and we have not been able to pin down the cause",
    ". however , the fact that ask  2 shows more outliers then other classes is probably an artifact due to ask  2 being the most common class ( table  [ tab2 ] ) .",
    "if all classes include a similar fraction of outliers , they will be more conspicuous in scatter plots of ask  2 . in short , although ask is more refined , ask and pca seem to agree with small internal scattering .",
    "moreover , the scatter between these two purely spectroscopic classifications is much smaller than the scatter in the ask versus morphological classification analyzed in the next section .",
    "the morphological type of a galaxy ( hubble type ) is closely related to its spectrum , a relationship known for long ( see   [ intro ] ) .",
    "the analysis of such relationship in the case of ask is mandatory , and we will do it in a follow - up work where the morphology of a large number of galaxies is derived automatically (   [ conclusions ] ) .",
    "however , in order to show the consistency of the ask classification , we include here a preamble based on a limited number of galaxies which shows how early types are associated with small ask numbers , and vice - versa .",
    "we have ask - classified the galaxies in the spectral atlas of @xcite .",
    "he provides spatially integrated spectra ( from 3650to 7100 ) of a set of 55 nearby galaxies with known hubble types .",
    "the set contains all hubble types , from gigant ellipticals ( cd , ngc1275 ) to dwarf irregulars ( di , mkr35 ) .",
    "we assign each galaxy to the ask class whose spectrum is closest to the galaxy spectrum as explained in   [ assigning ] .",
    "the match between ask template spectra and @xcite spectra is illustrated in fig .",
    "[ assign_kennicutt_other ] , which contains representative spectra of an early type galaxy and a late type galaxy .",
    "these particular fits ignore the spectral regions with emission lines ( see the weights shown as a dotted line in the figures ) .        the scatter plot of the assignation is shown in fig .",
    "[ assign_kennicutt ] .",
    "it displays the hubble type given by @xcite versus the ask class for the galaxies in the atlas .",
    "( actually , for 53 out of the 55 original galaxies , since mrk3 is not in the electronic catalog , and ngc3303 has no clear hubble type ",
    "it presents two nuclei undergoing a major merger . )",
    "note the clear trend for the small ask numbers to be associated with early types and vice - versa .",
    "the dividing line between early types ( e,  s0 ) and late types ( sa , sba, ",
    "i ) seems to be about ask6 , so that numbers smaller than this limit correspond to early types .",
    "the trend is even more clear if one ignores those galaxies classified as peculiar by @xcite , which are shown in the figure as asterisks .",
    "however , one can not ignore the large scatter in the figure  there is no one - to - one relationship between spectroscopic class and morphological class .",
    "the conclusion that there is a general trend with large scatter is very much in the vein of all previous studies comparing spectroscopic and morphological classifications ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* and   [ intro.intro ] ) .",
    "actually , the relationship between morphological and spectroscopic types gets fuzzier with increasing lookback time , and perhaps it disappears in the early universe @xcite .",
    "we have repeated the above exercise using the eye - bold morphological classification presented by @xcite .",
    "it is based on bright galaxies in a north equatorial stripe from sdss / dr3 , visually classified by three different observers based on @xmath0-band images .",
    "the catalog contains 2253 galaxies , but only 1866 targets have spectra and so overlap with our classification .",
    "we have also used this set to compare the morphological hubble type and the ask classification , with results similar to those for @xcite galaxies .",
    "there is a global trend with significant scatter .",
    "the size of the set allowed us to discard several observational bias that may cause the scatter .",
    "it is not due to misclassifications .",
    "the scatter is not reduced upon using only high quality ask class determinations ( quality @xmath67 ;   [ assigning ] ) , or when i m and peculiar galaxies are excluded from the sample .",
    "the scatter remains considering only small galaxies contained within the spectroscopic fiber ( @xmath68 1.5  effective radius ) .",
    "the last test assures that the scatter is not produced by large spirals misclassified because the sdss spectrum just samples their ( red ) bulge .",
    "the colors of the galaxies follow a bimodal distribution ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) , with a red population ( the red sequence ) , a blue population ( the blue cloud ) , and the so - called _ green valley _ in between ( e.g. , * ? ? ?",
    "the two main populations are believed to represent passively evolving red galaxies and blue star - forming galaxies , with galaxies in transition forming the green valley . as we explain in",
    "  [ intro ] , this work was partly triggered by the ability of _ k - means _   to distinguish green valley spectra @xcite .",
    "therefore , we found it necessary to discuss the location of the ask  classes in a plot where the red and the blue populations show up separately ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ) .    figure  [ classificationh ] ( top left panel ) shows the distribution of all sdss / dr7 galaxies in a @xmath55 versus @xmath56 plot .",
    "the image represents the 2-dimensional histogram of the distribution of colors .",
    "the concentrated spot at @xmath69 and @xmath70 corresponds to the red sequence .",
    "the blue cloud appears in this representation as an extended tail .",
    "the other panels in fig .",
    "[ classificationh ] show the different classes separately , and they all include the 2-dimensional histogram for reference .",
    "an inspection to fig .",
    "[ classificationh ] reveals a number of properties .",
    "first , the ask  classification separates galaxies into well located positions of the color - color plane .",
    "the red cloud is characterized by the most numerous class , ask2 .",
    "ask0 and ask1 also belong to the red sequence , but to its outskirts .",
    "the blue cloud is split into several classes , starting with ask9 and continuing with higher ask classes . in between these two groups ,",
    "ask3 , ask5 and ask6 populate the green valley ",
    "ask4 seems to be made of outliers of the main relationhip .",
    "as we originally presumed , the ask classification separates galaxies in colors with a finesse to automatically pinpoint classes in the green valley .",
    "an in - depth analysis of the galaxies in these classes will be carried out in a follow - up work ( see   [ conclusions ] ) .",
    "we have studied the position of our classes on the bpt diagram ( named after * ? ? ? * ) , which is commonly used to separate active galactic nucleus ( agn ) activity from normal star formation activity in galaxies with emission lines ( e.g. , * ? ? ?",
    "the diagnostic diagram consists of a scatter plot of the ratio of fluxes [ oiii]@xmath71 versus [ nii]@xmath72 .",
    "the two pairs of emission lines are so close in wavelength that the bpt diagram is almost insensitive to extinction and other systematic photometric miscalibrations .",
    "figure  [ bpt1 ] , top left panel , contains the bpt diagram for the full set of galaxies with emission lines .",
    "the fluxes of the lines have been directly taken from sdss / dr7 .",
    "the figure includes a curved solid line dividing star - forming galaxies ( below the line ) and agns ( above the line ) .",
    "this separation was worked out by @xcite , where they also distinguish between different types of agns .",
    "the straight line separates the regions occupied by seyfert galaxies , and liners , as indicated by the insets .",
    "the figure also shows bpt plots for the galaxies belonging to the individual ask classes  see the class in the label on top of each plot .",
    "the panels for the classes include box symbols at the positions where class template spectra show up .",
    "they are barely visible because they always appear in the center of the cloud of points corresponding to the individual galaxies .",
    "( ask 0 , 2 , and 3 do not have such boxes since they present h@xmath50 in absoption ; see table  [ tab2 ] . )",
    "only a small fraction of red galaxies have emission lines that can be used to place them in the bpt diagram ( 2% for ask2 ; see table  [ tab2 ] ) , however , when they do , their emission corresponds to agn activity ( fig .",
    "[ bpt1 ] , ask02 ) .",
    "this result is very much in agreement with the current views that host galaxies of agns are preferentially early type galaxies ( * ? ? ?",
    "* and references therein ) .",
    "conversely , blue galaxies correspond to star - forming galaxies , with little sign ( if any ) of undergoing agn activity ( from ask9 on ; see fig .",
    "[ bpt1 ] ) .",
    "the galaxies that seems to be in the green valley ( ask3 , ask5 and ask6 ;   [ colorscolors ] ) , also appear in the bpt diagrams in the region of agns .",
    "this is again consistent with the current wisdom that agn activity quenches star formation , and so it may be responsible for the transit of galaxies across the green valley @xcite the case of ask6 deserves special attention . according to the position in the bpt diagram , there is little doubt that it is formed by seyfert galaxies .",
    "this is consistent with the shape of h@xmath41 in the class template spectrum , with very broad wings that extend up to 2000  kms@xmath38 .",
    "moreover the only galaxy in the catalog by @xcite classified as ask6 is a well known cd elliptical with a seyfert nucleus ( ngc  1275 ; see fig .",
    "[ assign_kennicutt ] ) .",
    "cone diagrams ( or _ pie plots _ ) are polar plots where radius is redshift and azimuth is right ascension ( e.g. , * ? ? ?",
    "figure  [ cone_diagram1 ] shows cone diagrams for four representative classes , i.e. , a red galaxy class ( ask2 ) , an agn class ( ask6 ) , and two blue galaxy classes ( ask9 and ask16 ) .",
    "the range of declinations is limited between @xmath73 and @xmath74 .",
    "declination @xmath75 , and redshift @xmath76 ( see the labels on the rings ) .",
    "we are representing only a small fraction of all galaxies to avoid cluttering .",
    ", scaledwidth=45.0% ]    from fig .",
    "[ cone_diagram1 ] and similar plots considering other classes , other range of redshifts , and other declinations , we draw the following conclusions . ask 0 , 1 , 2 , and 3 are observed at higher redshifts than the rest of the classes .",
    "this effect is partly due to the luminous red galaxy ( lrg ) extension of the main sdss spectroscopic sample @xcite .",
    "the lrg search has been designed to detect passively evolving red galaxies , and it includes galaxies fainter than the main flux - limited portion of the sdss galaxy spectroscopic sample ( down to @xmath77 19.5 , rather than the regular cutoff at @xmath77 17.8 ) .",
    "however , a part of the separation in redshift between blue galaxies and red galaxies is believed to be real .",
    "dwarf galaxies can not be observed at high redshift , but dwarf field galaxies tend to be starforming ( e.g. , * ? ? ?",
    "* ) , and so included among the bluest ask classes .",
    "it is therefore understandable why blue ask classes are biases towards lower redshifts .",
    "proper motions induced by the large gravitational potential of galaxy clusters lead to the so - called _ fingers of god _ in the cone diagrams , i.e. , elongated clumps with the major axis pointing toward the observer ( e.g. , * ? ? ?",
    "we find them preferentially in ask2 cone diagrams , which we interpret as an inclination for the red galaxies to be in clusters .",
    "ask6 is formed by seyfert galaxies , and it seems to be more spreadout than the other classes ( see fig .",
    "[ cone_diagram1 ] ) . finally , we find not distinct or sharp change of properties at redshift 0.25 , i.e. , at the divide used to split the classification ( see   [ final_imp ] ) .",
    "galaxies at redshifts larger than this value were not used to derive the classes .",
    "the featureless transition at this special redshift indicates no obvious systematic difference between the galaxies that define the classes , and the rest .",
    "one can foresee several applications of the classification , in particular , it can be used to derive non - trivial physical parameters of individual galaxies by interpolation of the properties of the classes .",
    "we want to measure the parameter @xmath78 for the galaxy @xmath79 .",
    "assume that the parameter @xmath78 varies systematically along the ask sequence , being @xmath80 in the @xmath81-th class .",
    "then , one can approximate @xmath78 for galaxy * s * as , @xmath82 where @xmath83 represent the qualities assigned to the galaxy as explained in   [ assigning ] , except that we have shorten the notation so that , @xmath84 in practice , the series  ( [ cutre_approx ] ) can be truncated to consider only a few terms where the quality is large enough .",
    "regardless of the complications to estimate a given parameter , by having the classification and the value of the physical parameter in the ask classes , equation  ( [ cutre_approx ] ) trivially provides the parameter for all sdss / dr7 .",
    "we have used the star formation rate ( sfr ) to illustrate the procedure ( fig .",
    "[ fig_interpol ] ) . the equivalent width of h@xmath41 is a proxy for specific sfr ( or ssfr ) ( e.g. * ? ? ?",
    "* ) , and it varies systematically along the ask sequence ( table  [ tab2 ] ) . using the empirical relationship between h@xmath41 flux and sfr as calibrated by @xcite , fig .",
    "[ fig_interpol ] shows a scatter plot with the sfrs obtained directly and by interpolation based on equation  ( [ cutre_approx ] ) .",
    "the figure considers only starforming galaxies , i.e. , ask@xmath85 according to   [ ask_vs_agn ] .",
    "we truncate the series using only the three classes of highest qualities .",
    "figure  [ fig_interpol ] shows that interpolated sfrs are correct within a factor of two for sfrs varying four orders of magnitude .",
    "unfortunately , the interpolation does not work in all cases .",
    "we failed to estimate metallicities by interpolation .",
    "the oxygen metallicity has a large dispersion within each ask class and , therefore , it does not meet the condition of varying systematically along the ask sequence .    ) .",
    ", scaledwidth=45.0% ]    the interpolation may be specially useful when dealing with high redshift objects for which only noisy spectra are available .",
    "once each spectrum is assigned to a particular class , one can assign all the properties of the class to the spectrum . in this sense",
    ", one can use the spectra of the different classes as templates for redshift determinations ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "they represent a unique set able to reproduce all kinds of local galaxies .",
    "unfortunately , the available redshift range is limitted since the bluest wavelength of the templates is as red as 3800 , and galaxies with redshift @xmath86 will not overlap in any wavelength with the templates .",
    "however , one could overcome this problem classifying galaxies at various redshift ranges in various steps , very much in the vein of the classification for galaxies with redshift @xmath43 explained in ",
    "[ final_imp ] . after classification ,",
    "the blue part of the average high redshift spectra can be used to provide blue parts for the templates .",
    "new templates with extended blue wavelengths would be available , which can be used to extend the range even further by repeating the previous step .",
    "one can also use the classification to carry out relative measurements .",
    "for example , even if we ignore the metallicity of a galaxy , one can infer whether it is metal rich or poor with respect to the class mates using simple tools like the ratio between the fluxes of [ nii]@xmath876583 and h@xmath41 ( e.g. , * ? ? ? * ) .",
    "all the systematic errors involved in such comparison would be greatly reduced within a class ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ) . moreover , if the absolute metallicity of the class template is known , these simple recipes for relative measurements yield absolute metallicities using the class spectrum for reference .",
    "we present an automatic unsupervised classification of all the galaxies with spectra in the final sdss data release ( dr7 ) .",
    "it uses the _ k - means _",
    "algorithm , which separates the 930000 galaxies into 17 major classes containing 99% of the galaxies , plus another 11 minor classes with the rest .",
    "the algorithm guarantees that the galaxies in a class have similar spectra , independently of their luminosities .",
    "the algorithm does guarantees that the classes represent true clusters in the classification space , nor that all existing clusters are identified .",
    "each ask class is characterized by an extra - low noise spectrum resulting from averaging all the spectra in the class .",
    "these template spectra vary smoothly and systematically among the classes , labeled according to their @xmath56 color from ask  0 , the reddest , to ask  27 , the bluest ( fig .",
    "[ classification ] and table  [ tab2 ] ) .",
    "the classes are well separated in the color sequence , with a class that collects most of the red sequence galaxies ( ask  2 ) , a set of classes lying along the blue cloud ( ask 9 and larger ) , and a class that seems to be characteristic of the green valley ( ask  5 ) ; see   [ colorscolors ] . usually the classes of red galaxies do not present emission lines , however , when they do , their excitation is characteristic of agn activity .",
    "in contrast , all the galaxies in the classes on the blue cloud seem to present emission lines , but they are typical of star formation regions .",
    "the classes in between ( i.e. , in the green valley ) show agn activity ( see   [ ask_vs_agn ] ) .",
    "the ask classification has been compared with the morphological hubble type .",
    "although the number of galaxies involved in this comparison is rather limited , it clearly shows how the red classes tend to have early morphological types , whereas the blue classes are morphologically late types ( fig .",
    "[ assign_kennicutt ] and   [ ask_class_vs_morph ] ) .",
    "the relationship has a large intrinsic scatter , as previous studies also find ( see   [ intro.intro ] ) .",
    "we have confronted the ask classes with the pca - based spectroscopic classification also existing for sdss / dr7 (   [ pca_class ] ) .",
    "the two of them are consistent in the sense that ask classes have well defined pca eigenvalues . however , the ask classes are finer .",
    "we note that the scatter between these two purely spectroscopic classifications is much smaller than the scatter in the relationship with hubble type (   [ ask_class_vs_morph ] ) .",
    "the distribution of classes with redshifts is studied in   [ ask_vs_redshift ] , and it reveals that the bluer classes contain galaxies of lower redshift , indicating that they are made of galaxies less luminous ( and so smaller ) than the red classes .",
    "the same preliminary analysis also suggests a trend for the red classes to be more clustered than the blue classes .",
    "all the above properties prove the consistency of the ask classification .",
    "we have not found obvious contradictions between the physical properties of the classes , and the present understanding of galaxy properties .",
    "however , one should not forget the limitations of the analysis .",
    "the classification is not unique .",
    "we know that the borders between classes are not well defined , and that the actual number of classes is somewhat arbitrary (   [ final_imp ] ;   [ test_qbcd ] ) . the galaxy spectra seem to have a continuous distribution of properties , and we still ignore the reasons why _ k - means _  puts the borders between classes where it does .",
    "moreover , the classification rely on a number of reasonable but otherwise subjective hypotheses ( e.g. , the spectral bandpasses entering into the classification , or the normalization to the g - band ; see   [ data_set ] and table  [ tab1 ] ) .",
    "alternative hypotheses would render classifications differing from ask in a way difficult to foretell .",
    "all these caveats notwithstanding , the classes inferred by ask have different spectra that reflect a systematic difference in the gas and stars present in the galaxies .",
    "understanding the physical reasons causing the systematic differences between spectra would help understanding the classification itself .",
    "the study of the physical causes responsible for the observed diversity represents a major task that clearly goes beyond the scope of our introductory paper .",
    "however , a number of follow - up works dealing with the physical interpretation of classes are underway .",
    "as a result , some of the classes may need to be joined or split .",
    "for example , spectra of similar objects with different degrees of extinction may have ended up in different classes ( remember that we do not correct for extinction to attain a purely empirical classification ;   [ data_set ] ) .",
    "similarly , some of the classes may contain unidentified clusters .",
    "sub - divisions can be achieved by applying _",
    "k - means _  to selected spectral windows ( e.g. , the region around h@xmath41 may help us separating emission line galaxies according to their metallicity ; * ? ? ?",
    "deriving the star formation history of the classes is fundamental to understand whether the differences between spectra are tracing different star formation histories , agn activities , merging histories , or something else .",
    "( is the ask classification revealing some sort of evolutive sequence for galaxies ? ) fortunately , inversion codes able to constrain the star formation history are available ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ) , and we plan to use them .",
    "we are also carrying out a comparison between morphological types and spectroscopic types in a way that completes the introductory exercise in   [ ask_class_vs_morph ] .",
    "we try to understand what causes the scatter in the relationship between morphology and spectroscopy .",
    "is it the different characteristic time of evolution of morphological changes ( on short timescales ) and spectroscopic changes ( on long timescales ) ?",
    "is it the environment ?",
    "the morphological classification will be based on the automatic procedure by @xcite using support vector machines , which will allow us to afford comparing morphology and spectral type for a sizeable fraction of the sdss / dr7 spectroscopic catalog .",
    "work to derive the luminosity function for the classes is pending , i.e. , to characterize the number density of galaxies of each luminosity and class .",
    "it is needed to quantify the tendency for high ask classes to contain dwarf galaxies , as suggested in   [ ask_vs_redshift ] .",
    "in addition to understanding the physical mechanisms responsible for the diversity among spectra , we foresee other applications of the ask classification .",
    "it provides a crude but fast way of estimating some physical properties of a galaxy once its ask ascription is known (   [ applications ] ) .",
    "the classification is also useful as target selection .",
    "for example , ask  6 is formed by seyfert galaxies .",
    "this class provides an ideal homogeneous sample of some 5000 seyferts with similar spectra for in - depth agn studies ( e.g. , extending to low mass the relationship between supermassive black - hole mass and bulge mass ; see * ? ? ?",
    "* and references therein ) .",
    "the classification supplies classes of galaxies in the green valley ( ask  5 ) .",
    "these targets allow us addressing the question of what characterizes a green valley galaxy , and one can do it in a statistically significant way .",
    "is the green valley a short period during the life of any galaxy , or does it represent a genuine class of galaxies separated from the rest ? the qualities assigned to each galaxy provide a simple way to find unusual objects .",
    "low quality galaxies are outliers of the classification and , therefore , abnormal objects that deserve specific follow - up work . the average spectra of the classes can be used as template for redshift determinations .",
    "they represent a unique set comprising all spectral types .",
    "this application of ask requires extending the template spectra to the uv , but this upgrade can be done in successive steps as outlined in   [ applications ] .    in order to facilitate these and possibly other applications ,",
    "we have made the ask classification freely available though the ftpsite ftp://ask : galaxy@ftp.iac.es/. we explain how it can be directly employed in sql queries that use the casjob facility of sdss / dr7 .",
    "we also provide it as ascii csv tables suitable for uses external to sdss .",
    "in addition , the template spectra are included .",
    "* acknowledgments .",
    "* we are indebted to j.  betancort , i. g.  de la rosa , and m.  moles , that contributed with discusions on their area of expertise .",
    "thanks to an anonymous referee we include the discussion on the degree of clustering of the classes at the end of   [ final_imp ] .",
    "the work has been partly funded by the spanish ministries of science , technology and innovation , projects aya  2007 - 67965 - 03 - 1 , aya  2007 - 67752-c03 - 01 , and csd2006 - 00070 .",
    "funding for the sloan digital sky survey ( sdss ) and sdss - ii has been provided by the alfred p. sloan foundation , the participating institutions , the national science foundation , the u.s .",
    "department of energy , the national aeronautics and space administration , the japanese monbukagakusho , and the max planck society , and the higher education funding council for england .",
    "the sdss is managed by the astrophysical research consortium ( arc ) for the participating institutions .",
    "the participating institutions are the american museum of natural history , astrophysical institute potsdam , university of basel , university of cambridge , case western reserve university , the university of chicago , drexel university , fermilab , the institute for advanced study , the japan participation group , the johns hopkins university , the joint institute for nuclear astrophysics , the kavli institute for particle astrophysics and cosmology , the korean scientist group , the chinese academy of sciences ( lamost ) , los alamos national laboratory , the max - planck - institute for astronomy ( mpia ) , the max - planck - institute for astrophysics ( mpa ) , new mexico state university , ohio state university , university of pittsburgh , university of portsmouth , princeton university , the united states naval observatory , and the university of washington .",
    "the random initialization of _ k - means _  leads to small uncertainties in the properties of the clusters which , however , produce a significant variation on the actual galaxies assigned to each cluster (   [ algorithm ] ,   [ final_imp ] ) .",
    "this amplification can be understood by considering that clusters are defined by regions in a space of many dimensions . a small uncertainty in the center of the cluster produces large ( relative ) variations of the region of space that the cluster samples .",
    "below we compute this boost factor under the simplifying assumption that the clusters are defined by hyper - spheres .",
    "such simplification should not affect the conclusion we draw since the scaling relationship between volume and area is a general property of the space , rather then specific to a particular shape .",
    "assume that the galaxies belonging to a class are those within a sphere of radius @xmath88 centered in the class center .",
    "assume that the galaxies are uniformly distributed around this center .",
    "two different runs of the _ k - means _  clustering algorithm yield slightly different centers for the class , separated by a distance @xmath89 .",
    "how many galaxies will be shared by the two classifications ? under the previous hypotheses , it is just the overlapping volume of two @xmath90dimensional hyper - spheres of radius @xmath88 when their centers are separated @xmath89 .",
    "when @xmath91 , such volume is the volume of one of the original hyper - spheres minus the volume of a cylinder of height @xmath89 and base the corresponding @xmath90dimensional hyper - disk ( i.e. , an hyper - sphere in @xmath92 dimensions ) . using the expression for the volume of a sphere in @xmath93 dimensions , the number of common galaxies , @xmath94 , normalized to the number of galaxies in the class , @xmath95 , turns out to be ,",
    "@xmath96 equation  ( [ sphere ] ) shows how a small relative error in the position of the cluster center gets amplified as @xmath97 when affecting the drop in the number of common galaxies . since @xmath98 ,",
    "the drop is very large .",
    "for example , if @xmath99 , a minute @xmath100% produces @xmath101 65% .",
    "variations induced by cluster radius changes are even more dramatic . in this case",
    "the boost factor scales with @xmath93 rather than @xmath102 ."
  ],
  "abstract_text": [
    "<S> using the _ k - means _  cluster analysis algorithm , we carry out an unsupervised classification of all galaxy spectra in the seventh and final sloan digital sky survey data release ( sdss / dr7 ) . except for the shift to restframe wavelengths , and the normalization to the @xmath0-band flux , </S>",
    "<S> no manipulation is applied to the original spectra . </S>",
    "<S> the algorithm guarantees that galaxies with similar spectra belong to the same class . </S>",
    "<S> we find that 99% of the galaxies can be assigned to only 17 major classes , with 11 additional minor classes including the remaining 1% . </S>",
    "<S> the classification is not unique since many galaxies appear in between classes , however , our rendering of the algorithm overcomes this weakness with a tool to identify borderline galaxies . </S>",
    "<S> each class is characterized by a template spectrum , which is the average of all the spectra of the galaxies in the class . </S>",
    "<S> these low noise template spectra vary smoothly and continuously along a sequence labeled from 0 to 27 , from the reddest class to the bluest class . </S>",
    "<S> our automatic spectroscopic k - means - based ( ask ) classification separates galaxies in colors , with classes characteristic of the red sequence , the blue cloud , as well as the green valley . </S>",
    "<S> when red sequence galaxies and green valley galaxies present emission lines , they are characteristic of agn activity . </S>",
    "<S> blue galaxy classes have emission lines corresponding to star formation regions . </S>",
    "<S> we find the expected correlation between spectroscopic class and hubble type , but this relationship exhibits a high intrinsic scatter . </S>",
    "<S> several potential uses of the ask classification are identified and sketched , including fast determination of physical properties by interpolation , classes as templates in redshift determinations , and target selection in follow - up works ( we find classes of seyfert galaxies , green valley galaxies , as well as a significant number of outliers ) . </S>",
    "<S> the ask classification is publicly accessible through various websites . </S>"
  ]
}