{
  "article_text": [
    "[ [ background - and - motivation . ] ] background and motivation .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + +    fault - tolerant subgraphs are subgraphs designed to maintain a certain desirable property in the presence of edge or vertex failures .",
    "this paper focuses on the property of containing a bfs tree with respect to some source @xmath8 .",
    "a _ fault tolerant bfs structure _ ( or _  structure _ ) resistant to a single edge failure is a subgraph @xmath26 satisfying that @xmath27 for every vertex @xmath5 and edge @xmath28 .    to motivate our interest in such structures ,",
    "consider a situation where it is required to lease a subnetwork of a given network , which will provide short routes from a source @xmath8 to all other vertices . in a failure - free environment",
    "one can simply lease a bfs tree rooted at @xmath8 .",
    "however , if links might disconnect , then one must prepare by leasing a larger set of links , and specifically an  structure .",
    "moreover , taking costs into account , this example also motivates our interest in constructing _",
    "sparse _  structure .",
    "this question has recently been studied by us in @xcite .",
    "formally , a spanning graph @xmath26 is an _",
    "@xmath12 edge ( resp . ,",
    "vertex ) fault - tolerant bfs ( ) structure _ for @xmath2 with respect to the source @xmath29 iff for every @xmath5 and every set @xmath30 ( resp . , @xmath31 ) , @xmath32",
    ", it holds that @xmath33 it is shown in @xcite that for every graph @xmath2 and source @xmath8 there exists a ( poly - time constructible ) 1-edge  structure @xmath1 with @xmath34 edges .",
    "this result is complemented by a matching lower bound showing that for every sufficiently large integer @xmath7 , there exist an @xmath7-vertex graph @xmath2 and a source @xmath29 , for which every 1-edge structure is of size @xmath35 . hence _ exact",
    "_  structures may be rather expensive .",
    "this last observation motivates the approach of resorting to _ approximate _ distances , in order to allow the design of a sparse subgraph with properties resembling those of an  structure .",
    "the current paper aims at exploring this approach , focusing mainly on subgraphs that contain _ approximate _ bfs structures and are resistant to a single edge failure .",
    "formally , given an unweighted undirected @xmath7-vertex graph @xmath36 and a source @xmath29 , the subgraph @xmath26 is an @xmath12-edge ( resp .",
    ", vertex ) @xmath0  structure with respect to @xmath8 if for every vertex @xmath5 and every set @xmath30 ( resp . , @xmath31 ) , @xmath32 , @xmath37 ( an @xmath0  structure is a fault - tolerant bfs ( ) structure if @xmath38 and @xmath39 . )",
    "we show that this relaxed requirement allows structures that are sparser than their exact counterparts .",
    "approximate bfs tree structures can also be compared against a different type of structures , namely , fault - tolerant _",
    "spanners_. given an @xmath7-vertex graph @xmath36 , the subgraph @xmath26 is an _",
    "@xmath12-edge fault - tolerant @xmath0 spanner _ of @xmath2 if for every two vertices @xmath40 and every set @xmath30 , @xmath32 , we have @xmath41 .",
    "observe that the union of @xmath0  structures with respect to every source @xmath29 forms an ( all - pairs ) fault tolerant @xmath0 spanner for @xmath2 .",
    "in fact ,  structures can be viewed as _ single source spanners_. algorithms for constructing an @xmath12-vertex fault tolerant @xmath42 spanner of size @xmath43 and an @xmath12-edge fault tolerant @xmath44 spanner of size @xmath45 for a given @xmath7-vertex graph @xmath2 were presented in @xcite . a randomized construction attaining an improved tradeoff for vertex fault - tolerant spanners was then presented in @xcite .",
    "for the case of @xmath12 edge failures for constant @xmath46 , we show ( in sec .",
    "[ subsec : spanner_ub ] ) that there exists a poly - time algorithm that for every @xmath7-vertex graph constructs a @xmath14  structure @xmath1 with @xmath15 edges overcoming up to @xmath12 edge faults . for the special case of a single edge failure ( @xmath47 )",
    ", we get a somewhat stronger result , namely , that for every @xmath7-vertex graph @xmath2 and source @xmath8 , there is a ( poly - time constructible ) @xmath9  structure with at most @xmath10 edges , thus improving on the near - tight construction of @xcite by a @xmath11 factor for the special case of @xmath48 and edge failures .",
    "this result is to be contrasted with two different structures : the ( single - source ) fault tolerant exact  structure of @xcite , and the ( all - pairs ) fault tolerant @xmath9 spanner of @xcite , which both contain @xmath49 edges .",
    "this implies that using  structures is more efficient than using fault - tolerant spanners even if it is necessary to handle not a single source @xmath8 but a set @xmath50 of sources where @xmath51 for @xmath52 ; a collection of approximate @xmath0  structures rooted at each of the sources @xmath53 will still be cheaper than a fault - tolerant spanner .    _ additive _ fault tolerant @xmath54 spanners were recently defined and studied by @xcite , establishing the following general result . for a given @xmath7-vertex graph @xmath2 ,",
    "let @xmath55 be an ordinary additive @xmath54 spanner for @xmath2 and @xmath56 be a fault tolerant @xmath6 spanner for @xmath2 resilient against up to @xmath12 edge faults .",
    "then @xmath57 is a @xmath58 additive fault tolerant spanner for @xmath2 ( for up to @xmath12 edge faults ) for @xmath59 . in particular , fixing the number of @xmath1 edges to be @xmath25 and the number of faults to @xmath47 yields an additive stretch of @xmath60 ( see @xcite ; cor .",
    "1 ) .    when considering  structures with an _ additive",
    "_ stretch , namely , @xmath54  structures , the improvement is less dramatic compared to the size of the single - source exact or the all - pairs approximate variants . in sec .",
    "[ sec : lowerbound_add ] , we show that for every additive stretch @xmath61 $ ] , there exists a superlinear lower bound on the size of the  structure with additive stretch @xmath62 , i.e. , @xmath18 .",
    "these new lower bound constructions are independent of the correctness of erds conjecture .",
    "importantly , our results reveal an interesting dichotomy between _ multiplicative _ @xmath63 and _ additive _",
    "@xmath54  structures :",
    "whereas every graph @xmath2 contains a ( poly - time constructible ) @xmath9  structure rooted at @xmath29 of size @xmath64 , there exist an @xmath7-vertex graph @xmath2 and a source @xmath29 for which every @xmath16  structure contains a _ super - linear _ number of edges .",
    "for example , for additive stretch @xmath65 , we have a lower bound construction with @xmath21 edges .    on the positive side , in sec . [",
    "sec : upperbound_add ] we complement those results by presenting a ( rather involved ) poly - time algorithm that for any given @xmath7-vertex graph @xmath2 and source @xmath8 constructs a @xmath24  structure with @xmath25 edges ( hence improving the additive stretch of the ( all - pairs ) fault tolerant additive spanner with @xmath25 edges of @xcite from 38 to 4 ) . this algorithm is inspired by the ( non - fault - tolerant ) additive spanner constructions of @xcite .",
    "the main technical contribution of our algorithm is in adapting the path - buying strategy used therein to failure - prone settings .",
    "so far , the correctness and size analysis of this strategy heavily relied on having a fault - free input graph @xmath2 .",
    "we show that by a proper construction of the sourcewise replacement paths , the path - buying technique can be extended to support the construction even in the presence of failures .",
    "[ [ related - work . ] ] related work .",
    "+ + + + + + + + + + + + +    structures are closely related to the notion of _ replacement paths_. for a source @xmath8 , a target vertex @xmath66 and an edge @xmath67 , a _",
    "replacement path _ is the shortest @xmath68 path @xmath69 that does not go through @xmath70 .",
    "an  structure is composed of a collection consisting of a replacement path @xmath69 for every target @xmath5 and edge @xmath28 .",
    "analogously , the notion of  structures is closely related to the problem of constructing _ approximate replacement paths _",
    "@xcite , and in particular to its _ single source _",
    "variant studied in @xcite .",
    "that problem requires to compute a collection @xmath71 consisting of an approximate @xmath72 replacement path @xmath73 for every @xmath74 and every failed edge @xmath70 that appears on the @xmath72 shortest - path in @xmath2 , such that @xmath75 . in the resulting _ fault tolerant distance oracle",
    "_ , in response to a query @xmath76 consisting of an @xmath72 pair and a set @xmath3 of failed edges or vertices ( or both ) , the oracle @xmath77 must return the distance between @xmath8 and @xmath78 in @xmath79 .",
    "such a structure is sometimes called an _",
    "@xmath3-sensitivity distance oracle_. the focus is on both fast preprocessing time , fast query time and low space .",
    "an approximate _ single source fault tolerant distance oracle _ has been first studied at @xcite , which proposed an @xmath80 space data structure that can report a @xmath81 approximate shortest path for any @xmath82 .",
    "an additional by - product of the data structure of @xcite is the construction of an @xmath83  structure with @xmath84 edges .",
    "setting @xmath85 , this yields a @xmath9  structure with @xmath86 edges .",
    "hence our @xmath9  structure construction with at most @xmath87 edges improves that construction by a factor of @xmath11 for the case of single edge failure ( the construction of @xcite supports the case of vertex failures as well ) .",
    "it is important to note that the literature on approximate replacement paths ( cf .",
    "@xcite ) mainly focuses on _ time - efficient _ computation of the these paths , as well as their efficient maintenance within distance oracles .",
    "in contrast , the main concern in the current paper is with optimizing the _ size _ of the resulting fault tolerant structure that contains the collection of approximate replacement paths .",
    "moreover , this paper considers both multiplicative and additive stretch , whereas the long line of existing approximate distance oracles concerned mostly multiplicative ( and not additive ) stretch , with the exception of @xcite . to illustrate the dichotomy between the additive and multiplicative setting ,",
    "consider the issue of lower bounds for additive  structures .",
    "in the all - pairs fault - free setting , the best known lower bound for additive spanners is based on the _ girth conjecture _ of erds @xcite , stating that there exist @xmath7-vertex graphs with @xmath88 edges and girth ( minimum cycle length ) @xmath89 for any integer @xmath90 . removing any edge in such",
    "a graph increases the distance between its endpoints from @xmath91 to @xmath92 , hence any @xmath54 spanner with @xmath93 must have @xmath88 edges .",
    "this conjecture is settled only for @xmath94 ( see @xcite ) . in @xcite , woodruff presented a lower bound for additive spanners matching the girth conjecture bounds but independent of the correctness of the conjecture .",
    "more precisely , he showed the existence of graphs for which any spanner of size @xmath95 has an additive stretch of at least @xmath44 , hence establishing a lower bound of @xmath96 on the size of additive spanners .",
    "the lower bound constructions of @xcite are formed by appropriately gluing together certain complete bipartite graphs . since for every @xmath7-vertex graph @xmath2",
    "there exists a ( poly - time constructible ) multiplicative spanner of size @xmath97 and stretch @xmath98 , so far there has been no theoretical indication for a dichotomy between additive and multiplicative spanners .",
    "such a dichotomy is believed to exist mainly based on the existing gap between the current upper and lower bounds for additive spanners ( the current additive lower bounds match the lower bounds of its multiplicative counterpart ) . perhaps surprisingly",
    ", such a dichotomy is revealed by our current results , obtained for the most basic setting of fault tolerance , namely , single edge fault and sourcewise distances .",
    "upper bounds for constant stretch ( non - fault - tolerant ) additive spanners are currently known for but a few stretch values .",
    "a @xmath99 spanner with @xmath34 edges is presented in @xcite , a @xmath100 spanner with @xmath25 edges is presented in @xcite , and a @xmath24 spanner with @xmath101 edges is presented in @xcite .",
    "the latter two constructions use the _ path - buying _ strategy , which is adopted in our additive upper bound in sec .",
    "[ sec : upperbound_add ] .",
    "recently , the path - buying strategy was employed in the context of pairwise spanners , where the objective is to construct a subgraph @xmath26 that satisfies the bounded additive stretch requirement only for a _ subset _ of pairs @xcite .",
    "[ [ preliminaries . ] ] preliminaries .",
    "+ + + + + + + + + + + + + +    given a graph @xmath36 and a source @xmath8 , let @xmath102 be a shortest paths ( or bfs ) tree rooted at @xmath8 .",
    "let @xmath103 be the ( unique ) @xmath104 path in @xmath105 .",
    "let @xmath106 be the set of edges incident to @xmath66 in the graph @xmath2 and let @xmath107 denote the degree of vertex @xmath66 in @xmath2 .",
    "when the graph @xmath2 is clear from the context , we may omit it and simply write @xmath108 .",
    "let @xmath109 denote the _ depth _ of @xmath66 in the bfs tree @xmath105 .",
    "when the source @xmath8 is clear from the context , we may omit it and simply write @xmath110 and @xmath111 .",
    "let @xmath112 be the _ depth _ of @xmath105 .",
    "for a subgraph @xmath113 ( where @xmath114 and @xmath115 ) and a pair of vertices @xmath116 , let @xmath117 denote the shortest - path distance in edges between @xmath118 and @xmath66 in @xmath119 . for a path",
    "@xmath120 $ ] , let @xmath121 denote the last edge of @xmath122 , let @xmath123 denote the length of @xmath122 and let @xmath124 $ ] be the subpath of @xmath122 from @xmath125 to @xmath126 . for paths @xmath127 and @xmath128 where the last vertex of @xmath127 equals the first vertex of @xmath128 , let @xmath129 denote the path obtained by concatenating @xmath128 to @xmath127 . assuming an edge weight function @xmath130 ,",
    "let @xmath131 be the set of @xmath132 shortest - paths in @xmath2 according to the edge weights of @xmath133 .",
    "( when the graph is unweighted , the parameter @xmath133 is omitted . ) throughout , the edges of these paths are considered to be directed away from the source @xmath8 .",
    "given an @xmath72 path @xmath122 and an edge @xmath134 , let @xmath135 be the distance ( in edges ) between @xmath8 and @xmath70 on @xmath122 .",
    "in addition , for an edge @xmath136 , define @xmath137 if @xmath138 and @xmath139 . for a subset @xmath114 ,",
    "let @xmath140 be the induced subgraph on @xmath141 .",
    "let @xmath142 be the least common ancestor of all the vertices in @xmath141 .",
    "a _ replacement path _",
    "@xmath143 is a shortest path in @xmath144 .",
    "note that if @xmath145 then the replacement path @xmath143 is simply the shortest - path @xmath146 .",
    "let @xmath147 define @xmath148 as the minimum over all @xmath0 structure @xmath149 for @xmath8 .",
    "fix the source @xmath29 . for an edge @xmath150 ,",
    "denote the set of vertices in @xmath151 , the subtree of @xmath111 rooted at @xmath66 , by @xmath152).\\ ] ] note that the vertices of @xmath153 are precisely those sensitive to the failure of the edge @xmath70 , i.e. , the vertices @xmath154 having @xmath70 on @xmath155 , their @xmath156 path in @xmath105 , hence also @xmath157",
    "this section describes algorithms for constructing  structures for unweighted undirected graphs .      we establish the following .",
    "[ thm : multbfs ] there exists a poly - time algorithm that for every @xmath7-vertex graph @xmath2 and source @xmath8 constructs a 1-edge @xmath9  structure with @xmath22 edges .",
    "we begin by providing an informal intuition for the algorithm .",
    "the construction is based on starting from a bfs tree @xmath111 and adding edges to it until it satisfies the requirement .",
    "specifically , the algorithm constructs a collection of replacement paths , @xmath158 for every vertex - edge pair @xmath159 , satisfying that @xmath160 . from each such path @xmath143",
    ", only the first new edge @xmath161 , i.e. , the new edge closest to @xmath8 , is taken into the spanner .",
    "the correctness analysis shows that the construction of the @xmath143 collection guarantees that the endpoint @xmath162 of the first new edge @xmath70 , as well as the path endpoint @xmath125 , are both sensitive to the failure of the edge @xmath163 , namely , @xmath164 .",
    "therefore , the @xmath165 path @xmath166 in the bfs tree @xmath111 is free of the failing edge @xmath167 and hence provides a safe alternative path to the segment @xmath168 $ ] , which possibly might contain many edges that are missing in @xmath111 .",
    "then , by employing the triangle inequality , we also get that the alternative @xmath132 path @xmath169 \\circ \\pi(y , u_i)$ ] is not much longer than the optimal counterpart @xmath143 .",
    "perhaps the more surprising part is the _ size _ analysis , where we show that every vertex @xmath162 can appear as the endpoint of the _ first _ new edge of at most three replacement paths .",
    "this should be contrasted with @xcite , where it is shown that a vertex can be the endpoint of the _ last _ new edge of @xmath170 replacement paths .",
    "hence , taking the last edge of every replacement path results in an exact  structure with @xmath49 edges , while taking the first new edge of every replacement path results in an approximate @xmath9  structure with at most @xmath87 edges .",
    "we now provide some intuition explaining why a vertex might be the endpoint of the _ first _ new edge of at most _ three _ replacement paths .",
    "let @xmath171 be the replacement paths in which the endpoint of the first new edge is @xmath162 , i.e. , @xmath172)\\notin t_0 $ ] and @xmath173\\setminus \\{\\widehat{e}_{\\ell}\\}\\subseteq t_0 $ ] for every @xmath174 . we then show that upon a proper construction of the replacement paths , the fact that @xmath175 implies that @xmath176 ( otherwise the original shortest path @xmath177 could be used in @xmath178 instead of the segment @xmath173 $ ] ) and letting @xmath179 be sorted in increasing distance from @xmath8 on @xmath177 , it also holds that the truncated replacement paths are monotonically decreasing , i.e. , @xmath180|>\\ldots > |p^*_{i_k , j_k}[s , y]|$ ]",
    "let @xmath181 be such that @xmath182 .",
    "since @xmath183=\\pi(s , x_{\\ell})$ ] , we have that @xmath162 is connected by an edge to @xmath90 vertices @xmath184 of distinct distances from @xmath8 , @xmath185 , hence by the triangle inequality , necessarily @xmath186 .",
    "[ [ algorithm - description . ] ] algorithm description .",
    "+ + + + + + + + + + + + + + + + + + + + + +    we next formally describe the algorithm . for a path @xmath122 in the constructed structure ,",
    "let @xmath187 be the set of new edges in @xmath122 , namely , edges that were added to @xmath111 during the construction process .",
    "let @xmath188 be the first ( from @xmath8 ) new edge on @xmath143 that is not in @xmath111 .",
    "[ fig : figprotecting ] for an illustration of these definitions .",
    "protects @xmath125 against the failure of the edge @xmath167 . here",
    "@xmath189 and @xmath190 .",
    "the algorithm will add @xmath191 to @xmath192 and subsequently to the output structure @xmath1 because @xmath193 is also a new edge , so @xmath143 is new - ending . [",
    "fig : figprotecting ] ]    the @xmath9  structure @xmath1 is constructed by adding to @xmath111 only new edges that appear as the first edges on _ some _ of the replacement paths .",
    "the algorithm operates as follows .",
    "fix an ordering on the edges @xmath194 and on the vertices @xmath195 . in round @xmath196 ,",
    "the vertex @xmath125 is considered .",
    "the round consists of @xmath197 iterations . in iteration",
    "@xmath198 , consider @xmath160 and define the path protecting @xmath125 against the failure of @xmath167 to be @xmath199 , where @xmath200 is a weight assignment for the edges of @xmath201 defined by @xmath202 where @xmath203 , @xmath204 and @xmath205 . call a replacement path @xmath143 _ new - ending _ if its last edge is new , namely , @xmath206 .",
    "for every vertex @xmath207 , define @xmath208 let @xmath209   and   @xmath210 .",
    "[ [ correctness . ] ] correctness .",
    "+ + + + + + + + + + + +    we now prove the correctness of the algorithm and establish thm .",
    "[ thm : multbfs ] , by showing that taking into the constructed @xmath1 merely the first new edge from each new - ending replacement path @xmath143 is sufficient in order to guarantee the existence of an approximate @xmath132 replacement path in the surviving structure @xmath211 , for every @xmath125 and @xmath160 .",
    "let us start by explaining the specific weight assignment chosen .",
    "the role of @xmath212 is to enforce a unique @xmath132 shortest - path in @xmath144 .",
    "this is important for both the correctness and the size analysis of the @xmath9  structure .",
    "( in other words , carelessly taking the first edge of an arbitrary replacement path might result in a dense subgraph which is also not a @xmath9  structure . )",
    "the weight assignment achieves this as follows . for every @xmath207 ,",
    "let @xmath213 be the weighted cost of @xmath122 , i.e. , the sum of its edge weights . then given paths @xmath214 , the weight assignment @xmath215 has the following properties , implying that @xmath216 can in some sense be viewed as based on @xmath123 , @xmath217 and @xmath218 lexicographically .",
    "[ obs : weigh : prop ] for every two paths @xmath214 and @xmath207 ,    [ desc : weight ]    ( a)[desc : q1 ] if @xmath219 , then @xmath220 .",
    "\\(b ) [ desc : q2 ] if @xmath221 and @xmath222 , then @xmath223 .",
    "( c)[desc : q3 ] if @xmath221 , @xmath224 and @xmath225 , then @xmath223 .",
    "( d)[desc : q4 ] if @xmath221 , @xmath224 and @xmath226 , then @xmath223 iff @xmath227 .",
    "conversely we also have the following .    if @xmath220 , then necessarily one of the following four conditions holds :    \\(a ) @xmath228 ,    \\(b ) @xmath222 ,    \\(c ) @xmath225 ,    \\(d ) @xmath227 .",
    "the following key observation is used repeatedly in what follows .",
    "[ cl : sp_edge ] for every replacement path @xmath229 and every new edge @xmath230 on it , @xmath231 ( or @xmath232 ) .",
    "assume , towards contradiction , that @xmath230 and yet @xmath233 .",
    "since @xmath230 is a new edge , it holds that @xmath234 \\neq \\pi(s , y)$ ] .",
    "consider an alternative @xmath132 replacement path @xmath235 $ ] .",
    "since @xmath236|$ ] but @xmath237 and @xmath238)|\\geq 1 $ ] ( since @xmath111 contains only one @xmath239 path , @xmath240 ) .",
    "it follows by obs .",
    "[ desc : weight ] , that @xmath241)$ ] and thus also @xmath242 , in contradiction to the fact that @xmath243 .",
    "the observation follows .",
    "we next provide the following claim , showing that if a bfs edge @xmath244 fails , then adding the first new edge @xmath245 of a new - ending replacement path @xmath143 to the bfs tree @xmath111 , recovers its connectivity . in order words",
    ", @xmath246 is a connected spanning tree of the graph @xmath2 .",
    "moreover , we show that the @xmath132 path in @xmath247 has low stretch compared to the @xmath132 shortest - path in @xmath248 .",
    "[ cl : first_edge ] let @xmath143 be a new - ending replacement path , let @xmath249 and let @xmath250",
    ". then @xmath251 .",
    "let @xmath252 ; see fig .",
    "[ fig : figsp ] for illustration .",
    "note that by obs .",
    "[ cl : sp_edge ] , @xmath253 is in @xmath254 , hence both @xmath255 , the subtree of @xmath111 rooted at @xmath256 .",
    "therefore the path between @xmath253 and @xmath125 , @xmath257 , does not use @xmath167 , hence it exists in @xmath258 .",
    "let @xmath259 be the least common ancestor of @xmath125 and @xmath253 in @xmath111 .",
    "then @xmath260 . let @xmath261 , b = \\pi(s , x ) , c=\\pi(x , w_2 ) , d = p^*_{i , j}[w_2 , u_i]$ ] and @xmath262 .",
    "consider an alternative @xmath132 replacement path @xmath263 that uses the @xmath264 path in @xmath111 ( see fig . [",
    "fig : figsp ] ) . note that since @xmath265 is the first new edge on @xmath143 , it follows that @xmath266 .",
    "since @xmath267 is a replacement path for @xmath125 in @xmath247 , it remains to bound its length .",
    "note that @xmath268 and @xmath269 .",
    "first , since @xmath270 is a shortest @xmath271 path in @xmath248 but @xmath272 is an @xmath271 shortest - path in @xmath2 , it follows that @xmath273 .",
    "next , consider the two @xmath274 paths @xmath275 and @xmath276 . since @xmath275 is a shortest @xmath274 path",
    ", it follows that @xmath277 .",
    "therefore @xmath278 .",
    "the lemma follows .    ]",
    "[ lemma : correctness ] @xmath1 is a @xmath9  structure",
    ".    assume , towards contradiction , that @xmath1 is not a @xmath9  structure .",
    "let @xmath279 be the set of  bad pairs , \" namely , vertex - edge pairs @xmath159 for which the length of the replacement @xmath132 path in @xmath211 is greater than @xmath280 .",
    "( by the contradictory assumption , @xmath281 . ) for each bad pair @xmath282 , define @xmath283 to be the set of `` bad edges , '' namely , the set of @xmath229 edges that are missing in @xmath1 . by definition ,",
    "@xmath284 for every bad pair @xmath282 .",
    "let @xmath285 be the maximal depth of a missing edge in @xmath286 , and let @xmath287 denote that `` deepest missing edge '' , i.e. , the edge @xmath70 on @xmath229 satisfying @xmath288 .",
    "finally , let @xmath289 be the pair that minimizes @xmath290 , and let @xmath291 be the deepest missing edge on @xmath292 , namely , @xmath293 .",
    "note that @xmath193 is the _",
    "_ `` deepest missing edge '' over all bad pairs @xmath282 . by obs .",
    "[ cl : sp_edge ] , @xmath294 .",
    "consider the @xmath295 replacement path @xmath296 .",
    "note that there are two @xmath295 replacement paths , @xmath297 $ ] and @xmath298 , and by their optimality we have that @xmath221 ( these paths might - but do not have to - be the same ) .",
    "we distinguish between two cases : ( c1 ) @xmath299 and ( c2 ) @xmath300 .",
    "begin with case ( c1 ) . by construction , @xmath301 , so @xmath302 . by lemma [ cl : first_edge ]",
    ", there exists an @xmath295 replacement path @xmath267 in @xmath303 such that @xmath304 and @xmath305 .",
    "consider the @xmath306 replacement path @xmath307.\\ ] ] note that since @xmath193 is the deepest missing edge in @xmath308 , it holds that @xmath309 \\subseteq h$ ] and by the previous argument @xmath310 , concluding that @xmath311 is an @xmath306 replacement path in @xmath312 moreover , its length is bounded by @xmath313| ~\\leq~ 3|p^*_{i_1,j'}|,\\end{aligned}\\ ] ] contradicting the fact that @xmath289 is a bad pair .",
    "now consider case ( c2 ) where @xmath300 .",
    "we show that in this case @xmath314 .",
    "assume , towards contradiction , that @xmath315 is a bad pair .",
    "this implies that @xmath316 . since @xmath221 , @xmath317 but @xmath318 , it holds that the `` deepest missing edge '' @xmath319 in @xmath128 is such that @xmath320 ( or @xmath321 ) in contradiction to the selection of @xmath322",
    "hence , we conclude that @xmath314 , which guarantees the existence of an @xmath295 replacement path @xmath323 such that @xmath324 . finally , the @xmath306 path @xmath325 $ ] exists in @xmath326 and @xmath327|\\leq 3|p^*_{i',j'}|$ ] , in contradiction to the fact that @xmath289 .",
    "the lemma follows .    [",
    "[ size - analysis . ] ] size analysis .",
    "+ + + + + + + + + + + + + +    [ lem : bfsspanner_sizebound ] @xmath328 .",
    "we show that every vertex @xmath125 can have at most 3 of its incident edges in @xmath329 .",
    "assume , towards contradiction , that there exists some @xmath125 with ( at least ) 4 edges in @xmath329 , @xmath330 for @xmath331 , that appear as first new edges in the replacement paths @xmath332 respectively . by obs .",
    "[ cl : sp_edge ] , it holds that the 4 failed edges @xmath333 , @xmath331 appear on @xmath334 and by definition , @xmath335 , for every @xmath331 . without loss of generality , assume that @xmath336 for every @xmath337 , namely , that the edges @xmath338 occur on @xmath146 in that order . for illustration see fig .",
    "[ fig : sizebound ] .",
    "are the first new edges .",
    "new edges are represented in red .",
    "[ fig : sizebound ] ]    consider the 4 truncated @xmath132 paths @xmath339 $ ] for @xmath340 .",
    "note that since @xmath341 is the only new edge in @xmath342 , i.e. , @xmath343 has no new edges , or , @xmath344 let @xmath345 be the first divergence point of @xmath342 from @xmath334 , namely , the last vertex on that @xmath334 for which @xmath346 $ ] .",
    "let @xmath347=\\pi[s , b_k]=p_k[s , b_k]$ ] ( where the equality is by the definition of @xmath345 ) be the maximal common prefix of the paths @xmath342 and @xmath348 , for @xmath349 .",
    "when @xmath90 is clear from the context , we may omit it and simply write @xmath350 .",
    "let @xmath351=p_k[b_k , u_i]$ ] .",
    "we now show that @xmath345 is the _ only _ divergence point of @xmath342 and @xmath334 , or in other words , the paths meet again only at @xmath125 .",
    "formally , we show the following .",
    "[ cl : uniqe_div ] @xmath352 ) \\cap v(\\pi(s , u_i ) ) \\right)\\setminus \\{b_k , u_i\\}=\\emptyset$ ] for @xmath349 .",
    "assume , towards contradiction , that the paths intersect again at some vertex @xmath353 ) \\cap v(\\pi(s , u_i))\\right ) \\setminus \\{b_k , u_i\\}.\\ ] ] recall that @xmath354 was considered in round @xmath355 and let @xmath356 be the iteration in this round in which the edge @xmath357 was considered . let @xmath358 , q_1=p_{k}[b_k , w ] , q'_1=\\pi(b_k , w ) , q_2=p_{k}[w , u_i ] , q'_2=\\pi(w , u_i)$ ] . for illustration ,",
    "[ fig : figunique ] .",
    "we distinguish between two cases concerning the faulty edge @xmath359 : ( c1 ) @xmath360 or ( c2 ) @xmath361 .    in case ( c1 ) ,",
    "@xmath362 , and as it is part of the bfs tree , it holds that @xmath363 .",
    "since @xmath364 is free of new edges but @xmath365 is new , it holds that @xmath366 , in contradiction to the fact that @xmath367 .    in case ( c2 ) , @xmath368 , and as it is part of the bfs tree , it holds that @xmath369 . since @xmath111 contains a single @xmath370 path corresponding to @xmath371 , it must hold that @xmath372 ( @xmath373 has at least one new edge ) and therefore @xmath374 , in contradiction again to the fact that @xmath367 .",
    "and the dashed line depicts @xmath351=p_k[b_k , u_i]$ ] .",
    "the divergence point is unique .",
    "the red @xmath375 is the new edge of @xmath125 .",
    "the faulty edge @xmath359 can occur in either @xmath371 or @xmath364 .",
    "[ fig : figunique ] ]    it follows from cl . [ cl : uniqe_div ] , that @xmath376 $ ] .",
    "we now focus on the edge - set intersections @xmath377 and establish the following auxiliary claim , showing that the same holds also for the complete path @xmath378 , for the @xmath379 values needed later .",
    "[ cl : pathinter ] @xmath380 $ ] + ( a ) for every @xmath381 , and + ( b ) for every @xmath382 such that @xmath383 .",
    "recall that @xmath384 \\circ q_{suff}[k]$ ] and let @xmath385 and @xmath386 .",
    "we prove parts ( a ) and ( b ) in two steps .",
    "we first show that @xmath347 \\subseteq \\pi(s , u_{i_{\\ell}})$ ] and then show that @xmath351 $ ] and @xmath387 are edge disjoint for @xmath379 satisfying ( a ) or ( b ) .",
    "we begin by showing that @xmath347=\\pi(s , b_k ) \\subseteq \\pi(s , u_{i_\\ell})$ ] .",
    "let @xmath381 .",
    "since @xmath388 , by the ordering of the edges @xmath359 , it holds that also @xmath389 . since @xmath390 , the divergence point @xmath345 of @xmath342 and @xmath334 occurred above @xmath391 , hence @xmath392",
    "next , let @xmath382 be such that @xmath383 .",
    "by part ( a ) , @xmath393 . since the divergence point @xmath345 occurred not after @xmath394 ( and both @xmath345 and @xmath395 are in @xmath334 ) , it holds that also @xmath392 .",
    "next , we consider @xmath351 $ ] and show that it is edge disjoint from @xmath378 for @xmath381 . by the above argumentation , @xmath396 . by cl .",
    "[ cl : uniqe_div ] , the paths @xmath351 $ ] and @xmath334 are edge disjoint and hence the two paths @xmath397 and @xmath351 $ ] are edge disjoint .",
    "it remains to show that @xmath398 and @xmath351 $ ] are edge disjoint .",
    "since by eq .",
    "( [ eq : newedgelast ] ) the path @xmath399 exists in @xmath400 , it holds that @xmath401 however , @xmath402 .",
    "hence @xmath267 does not intersect with @xmath378 . finally , let @xmath382 be as in ( b ) , i.e. , such that @xmath383 . by cl .",
    "[ cl : uniqe_div ] , @xmath351 $ ] and @xmath334 are edge disjoint and hence @xmath403 and @xmath351 $ ] are edge disjoint .",
    "it remains to show that @xmath404 and @xmath351 $ ] are edge disjoint .",
    "since @xmath345 diverged from @xmath334 not after @xmath394 , it holds that @xmath345 is above @xmath405 hence @xmath406 .",
    "therefore @xmath407 , but @xmath408 , hence @xmath404 and @xmath351 $ ] are edge disjoint as required .",
    "the claim follows .    .",
    "black edges represent the original bfs tree @xmath111 .",
    "the red edge is a new edge .",
    "[ figure : approxcases],title=\"fig:\",width=288 ]   .",
    "black edges represent the original bfs tree @xmath111 .",
    "the red edge is a new edge .",
    "[ figure : approxcases],title=\"fig:\",width=288 ] + ( a ) ( b )    [ cl : depth ] @xmath409 for every @xmath337 .    towards contradiction , assume that @xmath410 for some @xmath411 .",
    "we first claim that in this case both @xmath412 .",
    "recall that @xmath413 \\circ q_{suff}[k]$ ] and @xmath414 \\circ q_{suff}[k+1]$ ] .",
    "note that by cl .",
    "[ cl : uniqe_div ] , the paths @xmath351 , q_{suff}[k+1]$ ] are edge disjoint with @xmath334 and therefore @xmath351 , q_{suff}[k+1 ] \\subseteq g \\setminus \\{e_{j_k},e_{j_{k+1}}\\}$ ] . in addition , by the fact that @xmath342 diverged from @xmath146 before the faulty edge @xmath359 ( and by ordering also before @xmath415 ) it holds that @xmath347 \\subseteq g \\setminus \\{e_{j_k},e_{j_{k+1}}\\}$ ] . since @xmath410 , it holds that @xmath416 diverged from @xmath334 not after @xmath345 , hence @xmath351 , q_{suff}[k+1 ] \\subseteq g \\setminus \\{e_{j_k},e_{j_{k+1}}\\}$ ] .",
    "overall , we get that @xmath412 .",
    "we thus have two alternative replacement @xmath417 ( resp .",
    ", @xmath418 ) paths given by @xmath419 $ ] and @xmath420 $ ] respectively .",
    "we now derive a contradiction by analyzing the costs of @xmath421 and @xmath422 and showing that all costs components ( see eq .",
    "( [ eq : well_multis_onef ] ) ) are equal except the last . by the optimality of @xmath421 and @xmath422 in round @xmath423 and @xmath424 respectively , i.e. , by the fact that @xmath425 and @xmath426 , it follows that @xmath427 .",
    "in addition , since @xmath342 is a subpath of @xmath421 and its last edge is the first new edge of @xmath421 ( i.e. , @xmath428 ) , it follows that @xmath429 . by a similar argument , since @xmath430 , we also have that @xmath431 . by the optimality of @xmath432 according to weight assignments @xmath433 ( see fact [ obs : weigh : prop](c ) ) we get that @xmath434 in the same manner , by the optimality of @xmath435 according to weight assignments @xmath436 , we get that @xmath437 applying cl .",
    "[ cl : pathinter](a ) with @xmath438 we have that @xmath439 applying cl .",
    "[ cl : pathinter](a ) with @xmath440 we have that @xmath441 and @xmath442 by",
    "[ cl : pathinter](b ) , we also have that @xmath443 combining eq .",
    "( [ eq : wineq ] ) with eq .",
    "( [ eq : k_depth_a ] ) and ( [ eq : k_depth2_b ] ) , we get that @xmath444 . combining eq .",
    "( [ eq : wineq2 ] ) with eq .",
    "( [ eq : k_depth_b ] ) and ( [ eq : k_depth2_a ] ) , we get the opposite inequality , @xmath445 .",
    "it follows that @xmath446 , hence inequalities ( [ eq : wineq ] ) and ( [ eq : wineq2 ] ) are in fact equalities .",
    "as we have shown that the paths @xmath447 and @xmath448 have the same length , the same number of new edges and the same number of joint edges with the shortest - path , by fact [ obs : weigh : prop](d ) their relative costs are determined by @xmath449 and @xmath450 . hence , by the optimality of @xmath421 under @xmath451 it follows that @xmath452 , and by the optimality of @xmath448 under @xmath453 we get that @xmath454 , contradiction .",
    "claim [ cl : depth ] implies that the vertices @xmath455 are distinct , and moreover , they appear in this order on @xmath146 .",
    "in addition , note that for every @xmath337 , @xmath456 ( since @xmath457 is below @xmath345 on @xmath146 ) .",
    "[ cl : length ] @xmath458|>|p_{k+1}[b_{k},u_i]|$ ] for every @xmath337 .    by the uniqueness of the divergence point @xmath345 of @xmath146 and @xmath342 ( cl .",
    "[ cl : uniqe_div ] ) and by cl .",
    "[ cl : depth ] , @xmath459 for every @xmath460 .",
    "since @xmath342 is a replacement path in @xmath461 for @xmath462 , but @xmath342 was nevertheless not chosen as part of the replacement path @xmath448 , it follows that @xmath463 .",
    "let us now analyze which cost component accounts for this difference . by cl .",
    "[ cl : pathinter](a ) , @xmath464 and @xmath465 . hence , since due to cl .",
    "[ cl : depth ] , @xmath466 ( and thus @xmath467 ) and @xmath468 , it follows by the optimality of @xmath469 for @xmath424 ( see fact [ obs : weigh : prop](c ) ) that @xmath470 . as @xmath471=p_{k+1}[s , b_k]=\\pi(s , b_k)=q_{pref}[k]$ ]",
    ", the claim follows .",
    "let @xmath472 and let @xmath473 for @xmath474 . combining cl .",
    "[ cl : depth ] and [ cl : length ] , we get that @xmath475 , and as these are integers , necessarily @xmath476 .",
    "now consider the edges @xmath477 for @xmath474 .",
    "the existence of these edges in @xmath2 , implies that @xmath478 for every @xmath474 , implying that @xmath479 , contradiction .",
    "lemma [ lem : bfsspanner_sizebound ] follows .      in this section ,",
    "we consider the case of @xmath12 edge failures for constant @xmath46 , and establish the following .",
    "[ thm : multbfsmultf ] there exists a poly - time algorithm that for every @xmath7-vertex graph constructs    \\(1 ) a @xmath14  structure with @xmath15 edges and    \\(2 ) a @xmath480  structure with @xmath481 edges ,    overcoming up to @xmath12 edge faults , for every @xmath482 .    for an edge set @xmath483 , let @xmath484 be the @xmath132 replacement path upon the failure of @xmath3 in @xmath2 . to avoid complications due to shortest - paths of the same length , we assume all shortest - path",
    "are computed with a weight assignment @xmath133 that guarantees the uniqueness of the shortest - paths .",
    "[ [ algorithm - description.-1 ] ] algorithm description .",
    "+ + + + + + + + + + + + + + + + + + + + + +    the algorithm consists of three phases .",
    "the first phase constructs a ( possibly dense ) @xmath12-edge  structure @xmath485 with respect to @xmath8 by using alg .",
    "@xmath486 to be defined later .",
    "the second phase constructs an @xmath12-edge @xmath487  structure @xmath488 by carefully sparsifying the edges of @xmath485 .",
    "however , @xmath489 might still be dense .",
    "finally , the last phase obtains a _ sparse _ @xmath490  structure @xmath491 where @xmath492 .",
    "we rely on the following fact .",
    "[ fc : pairwise_ftspanner]@xcite there exists an algorithm @xmath493 that given an @xmath7-vertex graph @xmath2 constructs an @xmath12 _ edge _ fault tolerant @xmath6 spanner @xmath494 such that @xmath495 .",
    "[ desc : upmultif ]    * algorithm * @xmath496 * - overview *    \\(1 ) invoke alg .",
    "@xmath486 to generate an @xmath12-edge  structure @xmath485 with respect to @xmath8 .",
    "\\(2 ) sparsify the new edges of @xmath485 to obtain an @xmath487 structure @xmath488 .",
    "\\(3 ) set @xmath497 .",
    "\\(4 ) @xmath498 .",
    "algorithm @xmath486 of phase ( 1 ) operates in a ",
    "brute - force \" manner . for every @xmath207 , and every subset @xmath483 ,",
    "@xmath499 , it constructs an @xmath132 replacement path @xmath500 of minimal length .",
    "the @xmath12-edge  structure @xmath485 is then given by @xmath501 . in phase ( 2 ) , each of these replacement paths @xmath502 is considered and at most @xmath503 of the set of new edges @xmath504 are taken into @xmath489 at the expense of introducing a stretch .",
    "to choose these edges from @xmath504 for a given replacement path @xmath502 , the algorithm labels the vertices @xmath505 according to their sensitivity to the set of failed edges @xmath3 , where vertices are given the same label iff they appear in the same connected tree in the surviving forest @xmath506 . since vertices @xmath507 of the same label remain connected in @xmath506 , the algorithm exploits their path in @xmath506 as a replacement to the path @xmath508 $ ] used by the optimal replacement path .",
    "the benefit of these bypasses is that they use only edges of the original bfs , allowing us to save the new edges that occur on @xmath508 $ ] .",
    "the potential drawback is that these bypasses might be longer than their counterparts in @xmath122 . in the analysis",
    "we argue that the stretch introduced by these replacements is bounded by @xmath509 .",
    "hence phase ( 2 ) turns the _ exact _ ft - bfs structure @xmath485 to an _ approximate _",
    "ft - bfs structure @xmath489 with bounded multiplicative stretch .",
    "we now describe formally the construction of @xmath489 , beginning with the labeling scheme @xmath510 .",
    "let @xmath511 be the set of connected components ( subtrees ) of the forest @xmath506 . for pictorial illustration ,",
    "[ fig : multibfsbrakes ] .",
    "then the label @xmath512 of every vertex @xmath513 is set to @xmath514 iff @xmath515 .",
    "the procedure for selecting at most @xmath503 new edges of @xmath122 using the labels @xmath512 , @xmath513 is as follows .",
    "let @xmath516 be the sorted set of new edges @xmath517 according to their order of appearance on the replacement path @xmath122 ( from @xmath8 ) .",
    "pair the vertices @xmath518 by matching @xmath518 with the farthest @xmath519 for @xmath520 of the same label @xmath521 , setting @xmath522 and @xmath523 .",
    "initialize @xmath524 and @xmath525 .",
    "now , repeatedly ( until @xmath526 ) add the new edge @xmath527 to @xmath489 and set @xmath528 .",
    "finally , we describe phase ( 3 ) of the algorithm .",
    "given the @xmath487  structure @xmath489 , a subgraph @xmath529  structure @xmath530 of @xmath22 edges is constructed as follows .",
    "let @xmath531 be the subgraph obtained by removing all original bfs edges of @xmath111 from @xmath489 .",
    "let @xmath532 be an @xmath12-edge fault tolerant @xmath533 spanner for @xmath119 .",
    "the resulting structure is @xmath534     ( dotted lines ) , the bfs tree @xmath111 is decomposed into @xmath535 components , denoted @xmath536 .",
    "[ fig : multibfsbrakes ] ]    [ [ analysis . ] ] analysis .",
    "+ + + + + + + + +    we first provide an auxiliary claim regarding the labeling scheme @xmath537 , @xmath483 .",
    "[ obs : pathinfgraph ]    \\(1 ) @xmath538 for every pair of vertices @xmath539 such that @xmath540 .",
    "\\(2 ) latexmath:[$|\\bigcup \\{\\lab_{f}(u ' ) ~\\mid~ u ' \\in v\\}| =     part ( 1 ) follows by definition , since two vertices are assigned the same label for a given edge fault @xmath3 iff they belong to the same tree in the forest @xmath506 .",
    "part ( 2 ) is proven by induction .",
    "let @xmath542 be the faulty edges in @xmath111 .",
    "we claim that @xmath543 .",
    "since @xmath544 , this would establish the observation .",
    "for the base of the induction , @xmath545 , note that every faulty edge @xmath546 disconnects the tree @xmath111 into two nonempty components , one containing @xmath547 and one containing @xmath162 , hence @xmath548 .",
    "assume this holds for every @xmath549 and consider @xmath550 . by the induction assumption ,",
    "the number of components in @xmath551 is @xmath552 .",
    "let @xmath553 be the connected tree in @xmath247 that contains @xmath554 . by the definition of @xmath555 , such @xmath556 exists .",
    "then by the induction base , @xmath557 , since @xmath556 is broken into two components upon the removal of the edge @xmath554 .",
    "we get that @xmath558 .",
    "the observation follows .",
    "fix a vertex @xmath118 , edge faults @xmath483 , @xmath499 , and a replacement path @xmath559 .",
    "let @xmath560 , where @xmath527 for @xmath561 be the set of new edges in order of appearance on @xmath122 ( from @xmath8 ) and let @xmath562 be the corresponding ordered set taken into @xmath489 .",
    "let @xmath563 the set of new edges not included in @xmath489 .",
    "the following observation is immediate by the structure of the algorithm .",
    "[ obs : multifnewedge_prop ]    \\(1 ) @xmath564 .",
    "\\(2 ) @xmath565)\\setminus \\{v_{i_{y'}}\\}$ ] for every @xmath566 .",
    "\\(3 ) @xmath567 \\subseteq t_2 \\setminus f$ ] .",
    "\\(4 ) @xmath568 for every @xmath569 .",
    "parts ( 1 ) and ( 2 ) follow by the description of the algorithm . to see ( 3 ) , note that @xmath570 is the first new edge that appears after @xmath571 , i.e. , @xmath572)$ ] .",
    "hence , @xmath573)=\\{e_{i_y}\\}$ ] .",
    "in addition , since @xmath567 $ ] appeared on the replacement path @xmath574 , it holds that @xmath575 ) \\cap f=\\emptyset$ ] . since @xmath570 ( the only new edge of @xmath576 $ ]",
    "is taken to @xmath489 , ( 3 ) follows . finally , consider part ( 4 ) .",
    "assume towards contradiction that there exists some @xmath577 such that @xmath578 . by part ( 2 ) , @xmath565 ) \\setminus \\{v_{i_{y'}}\\}$ ] . since @xmath578 and @xmath579 appears _ after _",
    "@xmath580 , we get a contradiction to the selection of @xmath580 .",
    "the observation follows .",
    "we proceed by showing that the multiplicative stretch introduced by excluding @xmath581 from the intermediate structure @xmath489 is at most @xmath509 . for @xmath582 , define the corresponding @xmath583 replacement path @xmath584 .",
    "let @xmath585\\circ \\pi(v_{i_1 } , m(v_{i_1}))$ ] and @xmath586\\circ \\pi(v_{i_y } , m(v_{i_{y+1}}))$ ] for every @xmath587 . then @xmath588.\\ ] ] for pictorial illustration , see fig .",
    "[ fig : multifbypass ] .    .",
    "black lines correspond to bfs edges .",
    "shown is the @xmath582 replacement path where new edges @xmath589 are marked in red .",
    "the dashed lines correspond to the bfs path used to bypass segments in @xmath590 .",
    "the replacement @xmath583 path @xmath591 with at most @xmath503 new edges is marked in green .",
    "[ fig : multifbypass ] ]    we state that @xmath584 is an @xmath583 replacement path in @xmath592 and it is longer than the optimal replacement path @xmath582 by a factor of at most @xmath509 .    [ lemma : multspt2 ]    \\(1 ) @xmath593 .",
    "\\(2 ) @xmath594 .",
    "let @xmath595 .",
    "we begin with ( 1 ) .",
    "note that the missing new edges @xmath596 appear on @xmath122 between some two vertices of the same label .",
    "specifically , @xmath597 $ ] . since @xmath598 , by obs .",
    "[ obs : pathinfgraph ] , it holds that @xmath599 and hence also @xmath600 .",
    "formally , by obs .",
    "[ obs : multifnewedge_prop](1 ) @xmath601 hence @xmath602 . by obs .",
    "[ obs : multifnewedge_prop](3 ) the subpath @xmath603 \\in t_2 \\setminus f$ ] for every @xmath587 . finally , by cl .",
    "[ obs : pathinfgraph ] , @xmath604 for every @xmath605 , since @xmath606 .",
    "it follows that @xmath607 .",
    "we now turn to ( 2 ) and show that @xmath608 . for every @xmath609 , we define the following in order to be able to bound the length of the bypass .",
    "let @xmath610 , @xmath611 , b_y=\\pi(s , \\chi_y ) , c_y=\\pi(\\chi_y , v_{i_y } ) , d_y = p[v_{i_y } , m(v_{i_y})]$ ] and @xmath612 .",
    "let @xmath613 and @xmath614 $ ] .",
    "[ cl : aux_multif3 ] @xmath615 for every @xmath609 .",
    "note that since @xmath616 , the alternative @xmath617 path @xmath618 satisfies @xmath619 .",
    "in addition , since @xmath620 is an alternative @xmath621 path and @xmath612 is the @xmath621 shortest - path , it holds that @xmath622 .",
    "hence , @xmath623 .",
    "we now claim that the replacement @xmath624 path @xmath625 satisfies @xmath626 .",
    "this is proved by induction on @xmath162 . for the base of the induction consider @xmath627 . in this case",
    "hence , the claim follows by cl .",
    "[ cl : aux_multif3 ] and @xmath629 .",
    "assume the claim holds up to @xmath630 and consider @xmath162 .",
    "@xmath631|+|c_y \\circ r_y| \\\\ & \\leq & 3(y-1)|p[s , v_{i_y}]|+|c_y \\circ r_y| \\\\&= & 3(y-1)|a_{y}|+|c_y \\circ r_y| \\leq 3(y-1)|a_{y}|+3|a_y \\circ d_y| \\\\&\\leq & 3y \\cdot |p_y|~,\\end{aligned}\\ ] ] where the first inequality follows by the induction assumption , as @xmath632 , and the third inequality follows by cl .",
    "[ cl : aux_multif3 ] . since by obs .",
    "[ obs : multifnewedge_prop](4 ) and obs .",
    "[ obs : pathinfgraph](2 ) , @xmath633 , we get that @xmath634 and @xmath635|\\leq 3(f+1)|p_{\\ell'}|+|p[m(v_{i_{\\ell ' } } ) , u]|\\leq 3(f+1)|p|$ ] .",
    "the lemma follows .",
    "we therefore have the following .",
    "[ cor : t_2_prop ] for every @xmath118 and @xmath483 , there exists a replacement path @xmath636 such that    \\(1 ) @xmath637 and    \\(2 ) @xmath638 .",
    "hence @xmath489 is an @xmath12-edge @xmath639  structure .    finally , we prove the correctness of the last phase and show the following .",
    "[ cl : multspt3 ]    \\(1 ) @xmath1 is an @xmath12-edge @xmath640  structure with respect to @xmath8 .",
    "\\(2 ) @xmath641 .",
    "let @xmath559 be the optimal replacement path and let @xmath642 be the corresponding replacement path in @xmath489 obtained by using at most @xmath503 bypasses between vertices of the same label on @xmath122 .",
    "then , by cor . [ cor : t_2_prop ] , @xmath643 and @xmath644 .",
    "let @xmath531 and @xmath645 be the @xmath12-edge ft @xmath533 spanner for @xmath119 ( see fact [ fc : pairwise_ftspanner ] ) .",
    "let @xmath646 be the set of new edges in @xmath647 that are missing in the final @xmath1 .",
    "hence , @xmath648 .",
    "since @xmath649 , it holds that @xmath650 .",
    "we now claim that for every missing edge @xmath651 there exists an @xmath104 path in the surviving structure @xmath652 of length at most @xmath653 . by the fact that @xmath654 is an @xmath12-edge @xmath533 spanner for @xmath119",
    ", it holds that @xmath655 , where the last equality follows by the fact that @xmath546 appears on the replacement path @xmath647 , hence @xmath656 , so @xmath657 .",
    "we therefore have that @xmath647 contains at most @xmath503 missing edges , and for each there exists a path in @xmath658 of length at most @xmath653 .",
    "overall , @xmath659 .",
    "part ( 1 ) is established .",
    "we now consider part ( 2 ) .",
    "by fact [ fc : pairwise_ftspanner ] , @xmath660 , hence @xmath661 has @xmath15 edges as well .",
    "the claim follows .",
    "this completes the proof of thm .",
    "[ thm : multbfsmultf](1 ) .",
    "we now consider part ( 2 ) of the theorem asserting that it is possible to get rid of the additive factor , albeit at the expense of considerably increasing the size of the  structure . for a given @xmath482",
    ", we first construct the collection of all replacement paths @xmath662 for every @xmath483 and every @xmath207 .",
    "let @xmath663 .",
    "the @xmath480  structure @xmath1 is constructed in two steps .",
    "a replacement path @xmath582 is _ short _ iff @xmath664 . in the first step",
    ", a subgraph @xmath665 is constructed containing the set of all short replacement paths , i.e. , @xmath666 . in the second step ,",
    "an @xmath667  structure @xmath56 is constructed by employing the algorithm of thm .",
    "[ thm : multbfsmultf](1 ) with one minor modification ; in step ( 3 ) of the algorithm we construct an @xmath668 spanner instead of @xmath533 spanner , i.e. , step ( 3 ) is given by @xmath669 for the given @xmath90 ( while @xmath670 in the original algorithm ) .",
    "by fact [ fc : pairwise_ftspanner ] and the proof of cl .",
    "[ cl : multspt3 ] , it holds that @xmath671 .",
    "we next bound the size of @xmath55 .",
    "[ cl : h1_size ] @xmath672 .",
    "let @xmath673 be the collection of @xmath132 replacement paths .",
    "define @xmath674 and @xmath675 for @xmath676 as the collection of @xmath132 replacement paths supporting a sequence of @xmath677 edge faults .",
    "hence , @xmath678 .",
    "we prove that for every @xmath679 if holds that @xmath680 .",
    "to see this , observe that every replacement path @xmath681 protects an edge failure @xmath70 in some @xmath682 .",
    "hence , @xmath683 .",
    "since @xmath684 contains only short replacement paths , it holds that each short @xmath132 replacement path @xmath682 has at most @xmath379 replacement paths of the form @xmath685 in @xmath686 that protect against the failure of @xmath687 . concluding that @xmath680 .",
    "overall , @xmath688 and @xmath689 . the claim follows .",
    "finally , we show that @xmath57 is an @xmath480  structure .",
    "consider a vertex edge - set pair @xmath690 corresponding to a vertex @xmath207 and edge set @xmath483 .",
    "there are two cases .",
    "case ( a ) is where the replacement path @xmath691 is short , i.e. , @xmath692 . by the same argumentation as in lemma [ lemma : correctness ]",
    "it holds that @xmath693 ( since @xmath55 contains the last edges of these replacement paths , which was shown to be sufficient ) . the complementary case is where the replacement path is long , @xmath694 . by the proof of thm .",
    "[ thm : multbfsmultf](1 ) , it holds that @xmath695 . the claim follows",
    "in this section we provide lower bound constructions for @xmath54  structures for various values of the additive stretch @xmath62 . the starting point for these constructions",
    "is the lower bound construction for the exact  structures in @xcite . in this construction ,",
    "the bulk of the edges was due to a complete bipartite graph @xmath696 where @xmath697 and @xmath698 .",
    "when relaxing to additive stretch @xmath699 , it is no longer required to include @xmath700 entirely in the spanner ; in fact , one can show that it suffices to include in the @xmath99  structure only a subgraph @xmath701 of @xmath22 edges .",
    "this subgraph @xmath702 is obtained by connecting an arbitrary vertex @xmath703 to every vertex @xmath704 and connecting an arbitrary vertex @xmath705 to every vertex @xmath706 .",
    "thus our goal is to replace @xmath700 with a dense subgraph of high girth .",
    "constructions of this type are known , but our requirement is in fact more stringent . note that an essential characteristic of the construction of @xcite is that the @xmath275 layer consists of at most @xmath707 vertices , for some constant @xmath708 .",
    "a larger layer could not be supported since the upper bound analysis of @xcite implies that every vertex in @xmath709 requires at most @xmath710 edges in every  structure .",
    "since the known lower bound on the number of edges in a @xmath711 bipartite graph with high girth ( greater than 4 ) is @xmath22 , such graphs are not good candidates for replacing the bipartite graph @xmath700 in the construction , as using them results in graphs of @xmath22 rather than @xmath712 edges . instead",
    ", our constructions replace the complete _ unbalanced _ bipartite graph @xmath700 by a _ multiple _ copies of _ balanced _ @xmath713 bipartite graphs with high girth .",
    "hence , the lower bound constructions of @xmath54  structure rely on known construction of balance bipartite graphs with high girth . the desired construction is achieved by carefully inserting multiple copies of these graphs .",
    "[ [ sec : add1 ] ] additive stretch @xmath714 .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    by a proof very similar to that of the exact case ( see @xcite ) one can show the following ( details are omitted ) .",
    "[ thm : lowerbound_edgeonef ] there exists an @xmath7-vertex graph @xmath715 and a source @xmath29 such that any @xmath716  structure rooted at @xmath8 has @xmath35 edges .",
    "[ [ additive - stretch-3-leq - beta - leq - olog - n . ] ] additive stretch @xmath717 .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    the _ girth _ of a graph @xmath2 is the minimum number of edges on any cycle in @xmath2 .",
    "let @xmath718 be a bipartite graph , where @xmath719 , the girth is at least @xmath720 and the number of edges is @xmath721 for some function @xmath722 .",
    "removing any edge @xmath723 in such a graph @xmath724 increases the distance between its endpoints @xmath118 and @xmath66 from @xmath91 to @xmath725 , which implies that any ( strict ) subgraph of @xmath724 has additive stretch @xmath726 .    in what follows ,",
    "we embed copies of @xmath727 graphs for some parameters @xmath728 and @xmath720 in order to achieve a lower bound for the case of a @xmath16  structure with _",
    "edge faults_. we show the following .    [ thm : lowerbound_additive ] for every integer @xmath7 and constant integer @xmath62 , there exists an @xmath7-vertex graph @xmath729 and a source @xmath29 such that any @xmath16  structure with respect to @xmath8 , @xmath1 , has :    \\(1 ) @xmath730 , if @xmath731 .",
    "\\(2 ) @xmath732 , if @xmath733 .",
    "\\(3 ) @xmath734 , if @xmath735 .",
    "\\(4 ) @xmath736 , if @xmath737 .    given integers @xmath7 and @xmath62 , the graph @xmath738 consists of the following main components ( illustrated in fig .",
    "[ fig : lowerbound1f ] ) :    \\(1 ) a path @xmath739 $ ] of length @xmath728 , for an integer parameter @xmath728 fixed later .",
    "our focus in the analysis is on what happens when some edge on this path fails .",
    "\\(2 ) a set @xmath740 of @xmath741 vertices organized in @xmath728 sets @xmath742 each of size @xmath728 , where @xmath743 for every @xmath744 .",
    "\\(3 ) a set of @xmath741 vertex disjoint paths of length @xmath745 each , @xmath746 $ ] , for every @xmath747 connecting the vertex @xmath748 to the vertices of @xmath749 .",
    "\\(4 ) a set @xmath750 of @xmath741 vertices organized in @xmath728 sets @xmath751 each of size @xmath728 , where @xmath752 for every @xmath744 .",
    "\\(5 ) a vertex set @xmath753 , where vertex @xmath754 is connected by @xmath728 vertex disjoint paths @xmath755 of length-@xmath745 to the @xmath728 vertices @xmath756 .",
    "altogether there exist @xmath741 vertex disjoint paths @xmath757 $ ] , one for every @xmath747 .",
    "\\(6 ) a collection of @xmath728 vertex disjoint paths of decreasing length , @xmath758 , where for @xmath759 , @xmath760 $ ] connects @xmath761 with @xmath754 and its length is @xmath762    \\(7 ) @xmath728 copies of the bipartite graph @xmath763 , where @xmath764 connects @xmath765 to @xmath766 for every @xmath744 .",
    "this graphs contribute most of the edges in @xmath2 ( with all the other components containing only @xmath22 edges ) .",
    "\\(8 ) a path @xmath767 $ ] for @xmath768 to be defined later , added in order to complete the number of vertices in @xmath2 to exactly @xmath7 .",
    "( this path has no special role in the construction . )",
    "overall , the vertex set of @xmath769 is @xmath770 and its edge set is @xmath771 set @xmath772 , and let @xmath773 .     length path .",
    "the edges of the bipartite graphs @xmath774 are required in every @xmath16  structure with respect to @xmath8 .",
    "for example the red edge @xmath775 is necessary upon the fault of @xmath776 .",
    "[ fig : lowerbound1f ] ]    we now turn to prove the correctness of the construction and establish thm . [ thm : lowerbound_additive ] .",
    "note that without the path @xmath275 , the rest of @xmath769 contains fewer than @xmath7 vertices , as @xmath777 , @xmath778 , @xmath779 , @xmath780 and @xmath781 .",
    "hence overall , @xmath782 . fix @xmath783 to complete the size of @xmath769 to @xmath7 , i.e. , set @xmath773 .",
    "[ cl : numbervertices_lbaddtive ] @xmath784 .",
    "the bulk of the edges is due to the bipartite graphs @xmath774 .",
    "since there are @xmath728 such graphs , each with @xmath785 edges , we get that @xmath786 .",
    "the claim follows .",
    "we now show the following .",
    "[ cl : lb_alledges ] every @xmath16  structure @xmath1 for @xmath2 with respect to @xmath8 , must contain all the edges of @xmath787 for every @xmath744 .",
    "let @xmath788 . assume , towards contradiction , that there exists some @xmath744 and an @xmath16  structure @xmath1 for @xmath2 such that @xmath789 .",
    "let @xmath790 for every @xmath791 .",
    "let @xmath792 , where @xmath793 and @xmath794 , be a missing edge in @xmath1 .",
    "note that for @xmath795 , the shortest @xmath796 path in @xmath303 is @xmath797 \\circ p_{j ' } \\circ q_{i',j'}$ ] .    upon the failure of the edge @xmath798 ,",
    "the unique shortest @xmath799 path in @xmath800 is @xmath801 .",
    "since @xmath802 and therefore also @xmath803 , the @xmath804 distance in @xmath805 is strictly larger than that in @xmath800 .",
    "let @xmath806 be the @xmath799 shortest - path in @xmath805 . by construction , @xmath267 must traverse the @xmath807 vertices ( as the path @xmath808 is disconnected ) .",
    "let @xmath809 be the first @xmath807 vertex occurring on @xmath267 .",
    "there are three cases to consider .",
    "+ case ( c1 ) @xmath810 and @xmath811 .",
    "since the faulty edge disconnects the shortest - path of @xmath2 between @xmath8 and @xmath812 for every @xmath810 , the shortest - path between @xmath8 and @xmath809 in @xmath800 must visit another @xmath807 vertex , in contradiction to the fact that @xmath809 is the first @xmath807 vertex on @xmath267 .",
    "+ case ( c2 ) @xmath813 and @xmath811 . in this case ,",
    "the shortest - path between @xmath8 and @xmath809 in @xmath303 is @xmath814 . since @xmath815 for every @xmath816",
    ", it holds that @xmath817 , in contradiction to the fact that @xmath1 is a @xmath54  structure .",
    "+ case ( c3 ) @xmath818 .",
    "this case is further divided into two cases .",
    "+ subcase(c3a ) : @xmath819 .",
    "the shortest - path @xmath267 must be of the form @xmath820 where @xmath821 .",
    "since any path connecting vertex @xmath822 and @xmath823 is of length at least @xmath745 , it holds that @xmath824 , and we end with contradiction again .",
    "+ subcase ( c3b ) : @xmath825 .",
    "since the edge @xmath826 is missing , @xmath827 is the first @xmath807 vertex on @xmath267 , and the distance between @xmath828 and @xmath823 for @xmath819 , is of length at least @xmath745 , it follows that @xmath829 is connected to @xmath830 via vertices in @xmath774 , i.e. , @xmath831 where @xmath832 is an @xmath833 shortest path in @xmath1 .",
    "since the girth of @xmath774 is @xmath834 , it holds that @xmath835 , hence @xmath836 and @xmath837 , contradiction .",
    "[ cor : lb ] every @xmath16  structure @xmath1 for @xmath2 must contain at least @xmath838 edges .    to establish the theorem we now make use of the following fact concerning the existence of graphs with `` many '' edges and high girth .",
    "[ cl : bipartite_densegirth ] for every sufficiently large @xmath7 there exists a connected bipartite graph @xmath839 , @xmath719 such that    \\(1 ) @xmath840 for @xmath841 , lemma 5.1.1 of @xcite ,    \\(2 ) @xmath842 for @xmath843 @xcite    \\(3 ) @xmath844 for @xmath845 @xcite and    \\(4 ) @xmath846 for every @xmath847 , @xcite .",
    "[ thm : lowerbound_additive ] follows by cor .",
    "[ cor : lb ] and by applying fact [ cl : bipartite_densegirth ] .",
    "in this section , we establish the following .      as usual ,",
    "the starting point of our construction is the shortest path tree @xmath111 , and this tree should be fortified against possible failure of any of its edges , by adding edges and augmenting @xmath111 into @xmath1 .",
    "the construction of @xmath1 consists of 3 main stages and revolves around the following key observation .",
    "let @xmath850 be a subset of edges .",
    "a replacement path @xmath851 is  missing - ending \" with respect to @xmath852 if the last edge of @xmath143 does not belong to @xmath852 , i.e. , @xmath853 . let @xmath854 be the collection of all @xmath855 replacement paths for every @xmath856 ) and consider its partition @xmath857 into missing - ending paths @xmath858 and non missing - ending paths @xmath859 .",
    "clearly , a subgraph @xmath1 containing all replacement paths @xmath860 is an exact  structure , however by @xcite such a subgraph might contain @xmath35 edges .",
    "one of the key observations in our analysis is that it is sufficient to `` take care '' only of the missing ending path collection @xmath861 .",
    "[ obs : only_new_h ] let @xmath26 be a subgraph containing @xmath852 and satisfying @xmath862 for every @xmath863 and @xmath864 such that @xmath865 . then @xmath1 is a @xmath54  structure , i.e. , @xmath862 also holds for non missing - ending paths @xmath866",
    ".    observation [ obs : only_new_h ] provides the basis for the general structure of the algorithm .",
    "its proof is based on ideas resembling those appearing in the proof of lemma [ lem : correct_add_up_clust ] ) .",
    "a vertex - edge pair @xmath159 , representing a vertex @xmath518 and an edge @xmath864 , is _ satisfied _ by a subgraph @xmath26 if there exists a replacement path @xmath867 whose last edge @xmath121 is in @xmath1 , otherwise it is _",
    "unsatisfied_. for a subgraph @xmath26 , let @xmath868 be the collection of unsatisfied pairs in @xmath1 . starting with the collection of all pairs @xmath869 that are required to be satisfied in @xmath1 ,",
    "the algorithm consists of three stages , aiming towards increasing the set of satisfied pairs by adding a suitable collection of edges to the constructed  structure @xmath1 .",
    "specifically , in each stage @xmath90 , the algorithm is given a ",
    "partial \"  structure @xmath870 and a list of pairs @xmath871 that might not be satisfied yet in @xmath870",
    ". essentially , the pairs @xmath872 are satisfied in @xmath870 .",
    "the algorithm then defines a subset of target pairs @xmath873 and a corresponding collection of edges @xmath874 that aim to satisfy @xmath875 in the final spanner . at the end of this stage",
    ", the algorithm sets @xmath876 and the updated list of unsatisfied pairs is reduced to @xmath877 . to compute a sparse @xmath874",
    ", the algorithm considers for every pair @xmath878 , a _",
    "specific _ replacement path @xmath879 .",
    "only the last edge @xmath880 is added to @xmath874 .",
    "hence , @xmath881 finally , in the last stage 3 , the replacement paths of the yet unsatisfied pairs in the current  structure @xmath882 are considered to be added _ entirely _ to @xmath1 , by employing a modified path - buying procedure .",
    "we now describe these stages in more detail . for a schematic illustration of the scheme ,",
    "[ figure : ubstages ] .     construction .",
    "stage s1.1 : clustering in the graph @xmath883 .",
    "stage s1.2 : segmentation of the shortest - path @xmath884 into three segments : near , mid and far .",
    "stage s2 : handling with the near and far edge faults by adding the last edge of their corresponding replacement paths @xmath885 .",
    "stage s3 : handling with mid edge faults by applying a path buying procedure on the detour segments @xmath886 of the corresponding replacement paths @xmath143 .",
    "a candidate detour is not added to @xmath1 if there exists an alternative `` safe '' and short path between some clusters representatives .",
    "[ figure : ubstages],title=\"fig:\",width=288 ]   construction .",
    "stage s1.1 : clustering in the graph @xmath883 .",
    "stage s1.2 : segmentation of the shortest - path @xmath884 into three segments : near , mid and far .",
    "stage s2 : handling with the near and far edge faults by adding the last edge of their corresponding replacement paths @xmath885 .",
    "stage s3 : handling with mid edge faults by applying a path buying procedure on the detour segments @xmath886 of the corresponding replacement paths @xmath143 .",
    "a candidate detour is not added to @xmath1 if there exists an alternative `` safe '' and short path between some clusters representatives .",
    "[ figure : ubstages],title=\"fig:\",width=288 ]    at the first stage s1 of subsec .",
    "[ s1:cluster ] , the algorithm clusters some of the vertices of @xmath887 , resulting in a clustered graph @xmath888 which is shown to have @xmath25 edges and a set @xmath889 of @xmath890 clusters . for this",
    "we use the clustering algorithm of @xcite , where not all the vertices of @xmath887 are clustered but the only @xmath2 edges missing in @xmath891 are those incident to clustered vertices . hence , letting @xmath892 , the edge set @xmath893 satisfies @xmath894 in the current spanner @xmath895 .",
    "it therefore follows that it remains to handle only pairs @xmath896 for clustered vertices",
    "at the end of stage s1 ( sec .",
    "[ append : sp_segment ] ) , the algorithm uses the clustering to divide the shortest path @xmath884 of every clustered vertex @xmath518 into three consecutive segments @xmath897 where the breakpoints depend on the clustering .",
    "let @xmath898 be the cluster of @xmath518 and @xmath899 be the least common ancestor in @xmath111 of the members of @xmath900 .",
    "then , our segmentation satisfies that @xmath901 and that @xmath902 , and the vertices of @xmath903 are at distance at least @xmath904 from @xmath518 .    equipped with this segmentation , the algorithm now handles separately edge failures @xmath905 in each of these three segments . specifically , stage s2 ( in sec .",
    "[ s2:nearfar ] ) deals with failures of @xmath906 , and stage s3 ( in sec .",
    "[ sec : pathbuyingproc ] ) deals with failures of @xmath907 by employing a modified path - buying procedure .    generally speaking , the edge faults in the far and near segments are handled by adding the collection of all last edges of the corresponding replacement paths . for a suitable construction of the replacement paths ,",
    "this last edge collection is shown to be small .",
    "in contrast , the edge faults in the mid segments are handled by considering every replacement path @xmath851 satisfying that @xmath907 and adding it _ entirely _ to @xmath1 if it satisfies some _ cost _ to _ value _ balance . to efficiently handle the faults , either in the near and far sections or in the mid section , a ( nontrivial ) preprocessing step of replacement path construction is required .",
    "let @xmath908 . in stage s2",
    ", the algorithm defines , for every @xmath909 , @xmath910   and   @xmath911 .",
    "+ the goal of this stage is to satisfy the pairs of @xmath912  and   @xmath913 in the constructed  structure @xmath1 .",
    "this stage consists of two substages . in substage",
    "s2.1 , a collection of replacement path @xmath885 is constructed . in substage s2.2",
    ", the algorithm creates a sparse set @xmath914 ( resp . ,",
    "@xmath915 ) containing the last edges of some replacement paths @xmath916 for every @xmath917 ( resp . , @xmath918 ) .",
    "due to some nice properties of the @xmath885 collection , the analysis shows that @xmath919 . in particular , the size of the set @xmath920 , consisting of the new edges appearing as last edges on @xmath916 satisfying that @xmath921 , is bounded by a constant ( which will be shown to follow from fact .",
    "[ fc : clustering ] that diameter of the clusters is constant ) .",
    "in addition , the number of last edges @xmath922 appearing on paths @xmath879 that protect against failures @xmath167 in the far segment @xmath903 , is bounded by @xmath923 for every clustered vertex @xmath518 , and as there are @xmath7 vertices , in total there are @xmath25 edges in @xmath915 .",
    "this holds since one can show that the detours of the replacement paths for every clustered vertex @xmath518 are _ long _ , _ vertex disjoint _ , and fully contained in the graph @xmath2 .",
    "hence , the remaining pairs @xmath159 that should be handled in the subsequent steps such that @xmath518 is clustered and @xmath907 .",
    "the fact that the length of @xmath924 is bounded plays an important role in the subsequent steps .",
    "the remaining set of replacement paths are handled in stage s3 .",
    "this stage consists of two substages as well . in substage",
    "s3.1 , a collection of replacement paths @xmath925 that satisfies some key properties is constructed . then , in substage s3.2 , the algorithm employs a modified path - buying procedure , first developed by baswana et al .",
    "@xcite and recently revisited by cygan et al .",
    "this modified path - buying procedure heavily exploits the key properties of the paths @xmath143 constructed in substage s3.1 .",
    "[ fc : clustering ] there is a poly - time algorithm @xmath926 that given a parameter @xmath927 $ ] and a graph @xmath36 constructs a collection @xmath889 of at most @xmath928 vertex - disjoint clusters , each of size @xmath929 , and a subgraph @xmath930 of @xmath2 with @xmath931 edges , such that        note that the clustering does not necessarily form a partition of @xmath933 , i.e. , the set @xmath934 may be nonempty .",
    "however , in that case , all edges connecting vertices of @xmath935 among themselves or to vertices of one of the clusters belong to @xmath891 . also , the clusters are not guaranteed to be connected .",
    "invoke the algorithm @xmath936 on @xmath883 and @xmath937 , getting the subgraph @xmath938 and let @xmath939 be the clusters of @xmath891 .",
    "define @xmath940 by fact [ fc : clustering ] , @xmath941 and the number of clusters is @xmath942 . for",
    "a clustered vertex @xmath943 , denote by @xmath944 its cluster in @xmath891 . for every cluster @xmath945 ,",
    "let @xmath946 be the least common ancestor of all @xmath947 vertices in @xmath111 .",
    "formally , @xmath948 is the vertex @xmath949 of maximal depth satisfying that @xmath950 for every @xmath951 .",
    "for every clustered vertex @xmath953 , divide its shortest path @xmath954 into 3 segments @xmath955 in the following manner .",
    "define @xmath956 to be the upmost vertex on @xmath957 ( closest to @xmath8 ) satisfying that @xmath958 .",
    "then , let @xmath959 , @xmath960 and @xmath961 .",
    "note that for every two vertices @xmath962 in the same cluster it holds that @xmath963 and also @xmath964 .",
    "for an illustration of the segmentation of @xmath954 , see part s1.2 of fig .",
    "[ figure : ubstages ] ; the vertex @xmath965 is used to draw the line between the near segment @xmath966 and the rest of the @xmath954 path . by the definition of @xmath956 , it holds that @xmath967 .",
    "note that @xmath973 is the same for every @xmath953 and also @xmath974 is the same for every @xmath953 , therefore the common shortest - path section @xmath975 can be divided into two segments @xmath976 and @xmath977 such that @xmath978        to guarantee that @xmath979 and @xmath980 are sufficiently sparse , the replacement paths are required to be _ nice _ as defined below . for a collection of replacement paths @xmath981 , let @xmath982 be the first divergence point of @xmath983 from @xmath884 ( i.e. , the first vertex on @xmath885 such that the vertex @xmath984 appearing after it on @xmath885 is not on @xmath884 ) . for every clustered vertex @xmath518 ,",
    "define @xmath985                  with the collection of replacement path @xmath143 at hand , we are now ready to present the last step of the algorithm , a modified path - buying procedure , where the replacement path is added entirely to the spanner if it satisfies a particular cost to value balance .    generally speaking ,",
    "the high level approach of the path - buying technique is as follows .",
    "recall that in the preliminary clustering sub - stage s1 , the graph was condensed into clusters .",
    "there is a collection of @xmath994 paths , whose distance in the final @xmath1 is required to approximate the distance in @xmath2 by an additive factor .",
    "these paths are examined sequentially , where at step @xmath995 , a particular candidate path @xmath996 is considered to be added to the current spanner @xmath997 , resulting in @xmath998 .",
    "the decision is made by assigning each candidate path @xmath996 a _",
    "@xmath999 , corresponding to the number of path edges not already contained in the spanner @xmath997 , and a _ value _",
    "@xmath1000 , measuring how much adding the path would help to satisfy the considered set of constraints on the pairwise distances .",
    "the candidate path @xmath996 is added to @xmath997 if its _ value to cost ratio _ is sufficiently large .",
    "informally , if a path @xmath996 is added , then it implies that each of at least some fraction of its new edges @xmath1001 _ contributes _ to improving the inter - cluster distances in the current spanner @xmath997 . in the context of stage s3.4 of our algorithm for  structures",
    ", we are given a collection of replacement paths @xmath143 where @xmath1002 and some preliminary sparse subgraph @xmath1003 consisting of ( at least ) the edges of the bfs tree @xmath111 , the edges of clustering graph @xmath891 and the set @xmath1004 , containing the last edges of replacement paths @xmath308 protecting against the failure of @xmath1005 . by the preliminary explanation above",
    "( see obs .",
    "[ obs : only_new_h ] ) it is sufficient to consider only replacement paths @xmath143 whose last edge is missing in @xmath1003 .",
    "these paths have a special structure .",
    "in particular , there is a unique divergence point @xmath982 where @xmath143 diverges from @xmath884 and does not meet it again ( i.e. , @xmath1006 $ ] and @xmath1007 are edge disjoint ) . since the common prefix @xmath1008=\\pi(s , b_{i , j})$ ] is contained in @xmath111 , the buying procedure restricts attention only to the  detour \" segment @xmath1009 $ ] .",
    "the properties of the partial spanner @xmath882 constructed so far guarantee that this detour @xmath886 is restricted to @xmath2 , i.e. , @xmath1010 , hence the size of the resulting construct would be bounded as a function of @xmath1011 as desired .    to gain some intuition regarding our modified path - buying technique , we review some of its principles and draw some differences between our setting and that of @xcite and @xcite",
    ". the analysis of the path - buying technique has two main ingredients .",
    "the first is the correctness ingredient ( a1 ) , where it is required to show that if an @xmath994 path @xmath1012 was _ not _ added to the current spanner @xmath1013 at time @xmath78 , then there exists an alternative @xmath994 path @xmath267 in @xmath1013 satisfying that @xmath1014 for some constant integer @xmath1015 .",
    "the second is the size ingredient ( a2 ) , where it is required to show that the number of edges added due to the paths that were bought by the procedure is bounded .    in the 6-additive construction of @xcite , the correctness ingredient ( a1 )",
    "was based upon the fact that if a path @xmath1012 was not added , then there exists a vertex @xmath1016 such that the pairwise @xmath1017 and @xmath1018 distances between clusters in @xmath1013 is smaller than that in @xmath1012 , namely , than @xmath1019 and @xmath1020 respectively .",
    "similarly , in the subsetwise construction of @xcite , ( a1 ) was established by noting that if a path @xmath1012 was not added , then there exists a vertex @xmath1016 such that the vertex to cluster @xmath1021 distance as well as the @xmath1022 distance in @xmath1013 are smaller than @xmath1019 and @xmath1020 respectively . in our setting , this argument becomes more delicate due to the possibility of failures which might render the existing bypasses already available in @xmath1013 useless .",
    "hence , when considering a detour @xmath886 of a replacement path @xmath143 that was not added to the current spanner @xmath1013 , it is required to show that the inter - cluster bypasses in @xmath1013 do not contain the failed edge @xmath167 and hence can safely be used in the surviving structure @xmath1023 .",
    "we now consider the second ingredient of the analysis ( a2 ) .",
    "let @xmath1024 be the set of paths added to the spanner by the path - buying procedure . in both @xcite and @xcite , ( a2 ) is established based on the fact that if @xmath1025 , then its value satisfies @xmath1026 for some constant @xmath1027 .",
    "this implies that each of at least a constant fraction of the newly added edges on @xmath1012 contributes by decreasing some specific inter - cluster distances in the given spanner .",
    "specifically , the value of @xmath1012 is the number of pairs @xmath1028 where @xmath1029 is a cluster and there exists a vertex @xmath1030 such that by adding @xmath1012 to the current spanner @xmath1013 , @xmath1031 is improved compared to that in @xmath1013 . in the setting of @xcite , @xmath547 is a cluster ( i.e. , @xmath1032 ) and in the setting of @xcite , @xmath547 is a vertex ( i.e. , @xmath1033 ) . for every @xmath1025 ,",
    "its value ( total number of @xmath1028 pairs ) is proportional to its cost @xmath1034 .",
    "therefore , to bound the number of edges , it is sufficient to bound the number of @xmath1028 pairs .",
    "this involves two steps : ( a2.1 ) showing that the contribution due to a fixed pair @xmath1028 is bounded ( or in other words , that a given pair @xmath1028 can contribute only a bounded number of times to the value of the paths in @xmath1024 ) and ( a2.2 ) showing that the number of distinct @xmath1028 pairs is bounded .",
    "the combination of ( a2.1 ) and ( a2.2 ) bounds the size of the spanner .",
    "we now consider ( a2.1 ) and ( a2.2 ) separately . in both @xcite and @xcite , ( a2.1 )",
    "is established by the cluster diameter property of fact [ fc : clustering ] , which implies in this context , that every given pair @xmath1028 can contribute at most a constant number of times to the values of the paths in @xmath1024 .",
    "turning to ( a2.2 ) , in @xcite , the total number of distinct pairs corresponds to @xmath1035 since @xmath1036 . in comparison , in @xcite , since @xmath1037 , there are a total of @xmath1038 pairs .",
    "overall , the spanner size is bounded since the number of clusters @xmath889 , as well as the cardinality of @xmath1039 in the subsetwise variant of @xcite , are bounded .",
    "we now contrast this with the situation in our setting of  structures .",
    "part ( a2.1 ) is no longer straightforward , since every replacement path @xmath143 added to the current spanner exists in a _ different _",
    "graph @xmath248 , and therefore , in contrast to @xcite and @xcite , the bounded diameter of the clusters is not sufficient , by itself , to establish ( a2.1 ) . considering ( a2.2 ) , the approach of @xcite can be adopted to bound to number of distinct pairs @xmath1028 , by letting @xmath1040 , but this would result in an additive stretch of 6 . to improve the additive stretch to @xmath848 ,",
    "it is necessary to employ some _ intermediate _ compromise .",
    "we first impose a _ direction _ on the candidate paths , hence breaking the symmetry between the path endpoints .",
    "the direction is imposed by the source @xmath8 . in particular , the two endpoints @xmath982 and @xmath518 of each detour @xmath886 are treated in an asymmetric manner .",
    "the endpoint @xmath518 is treated as a _ cluster _ in a similar manner to that of @xcite , that is",
    ", the value of @xmath886 counts the improvement of the inter - cluster distances between @xmath900 and some @xmath1041 for @xmath1042 .",
    "in contrast , the @xmath982 endpoint is treated as a _",
    ", as in @xcite .",
    "overall , the pairs @xmath1028 that contribute to the value of @xmath886 are of two types , where @xmath1043 . in the analysis section , it is shown that the number of contributions of each fixed pair @xmath1028 is bounded , and moreover , that for every cluster @xmath1044 , the number of distinct pairs in which it appears ( of both types ) is bounded by @xmath25 .",
    "the main challenge in this context is to bound the number of distinct contributions of the type @xmath1045 .",
    "( note that the second type of contribution , where @xmath1036 is a cluster , is easily bounded , since there are only @xmath890 clusters ) .",
    "the replacement paths constructed earlier are designed so that for every cluster @xmath1029 there are at most @xmath890 distinct divergence point @xmath982 that can be paired with @xmath1029 and contribute to the value of some detour @xmath1046 .",
    "this establishes the sparsity of our  structure .",
    "let us note that in our application of the path - buying procedure , paths with a sufficiently large value to cost ratio are added _",
    "entirely _ to the current spanner , and adding just the last edge of each of these paths will not suffice",
    ". this does not contradict obs .",
    "[ obs : only_new_h ] , for the following reason .",
    "consider step @xmath995 and the current candidate path @xmath1047 with a sufficiently large value to cost ratio with respect to @xmath997 .",
    "if one adds solely the last edge of @xmath996 to @xmath997 , then although the pair @xmath159 would be satisfied in @xmath1048 , this would distort the value and cost functions of the subsequent candidate paths in a way that would force us to add many new last edges to the spanner . specifically , since only the last edge of @xmath1049 was added to @xmath998 , the subgraph @xmath998 enjoys almost none of the value of @xmath1049 in improving the pairwise distances , and as a result , many subsequent paths would have a larger value ( and hence might be suitable for purchasing ) in comparison to their value when the path @xmath1049 is added in its entirety to @xmath998 .",
    "[ fig : pb ] illustrates the high level distinctions between the three constructions of additive spanners based on the path - buying technique : ( a ) the 6-additive construction of @xcite , ( b ) the 2-additive subsetwise construction of @xcite , where the stretch constraint is imposed only on a set of vertex pairs @xmath1050 for a given @xmath50 , and ( c ) the 4-additive  structure presented here .",
    "is the failed edge . missing edges on the missing - ending path @xmath143 are drawn in red .",
    "only the detour segment @xmath1009 $ ] of the path is a candidate for buying .",
    "the edges of @xmath518 appearing on @xmath1051 for @xmath1052 are already included in the preliminary subgraph constructed prior to the path - buying procedure .",
    "the shortest inter - cluster paths in @xmath1 are indicated by dashed curves , where @xmath1 is the current subgraph at the time when @xmath886 is considered to be bought . for each cluster @xmath1053 , with a vertex @xmath1054 ending with a missing edge , the branching point ( first vertex on the detour ) belongs to @xmath1055 . since the size of @xmath1055",
    "is bounded by @xmath890 , the contribution of pairs @xmath1056 is bounded in a similar manner to the subsetwise case of @xcite .",
    "in addition , since the endpoint @xmath518 of the detour is treated as a cluster , @xmath900 , the contribution of pairs @xmath1057 is bounded by the number of clusters , @xmath890 . [",
    "fig : pb ] ]    recall that @xmath968 is the maximal shortest path segment shared by all the members of the cluster . for every @xmath905 ,",
    "define @xmath1058 by lemma [ lem : rep_new](c ) , it then holds that @xmath1059 for every @xmath1060 . for",
    "every missing ending path @xmath143 ( i.e. , @xmath1061 ) let @xmath1062 $ ] be the detour segment starting from the unique divergence point @xmath982 .",
    "let @xmath1063 be the candidate paths to be bought and added to @xmath882 .",
    "the benefit of considering these detours is that by the definition of @xmath882 , we are guaranteed that @xmath1010 and in addition , each of these detours @xmath886 is edge disjoint with @xmath1064 for every cluster @xmath1065 that has a vertex @xmath1066 with missing edge @xmath1067 ) \\notin \\currspanner_3 $ ] .",
    "the property is heavily exploited in both the size and correctness analysis of the path - buying procedure .",
    "the path - buying scheme is as follows .",
    "starting with @xmath1068 , the paths of @xmath1069 are considered in an arbitrary order . at step @xmath78 , we are given @xmath1070 and consider the @xmath1071 detour @xmath1072 . to decide whether @xmath886 should be added to @xmath1013 ,",
    "the cost and value of @xmath886 are computed as follows .",
    "let @xmath1073 be the number of edges of @xmath886 that are missing in the current subgraph @xmath1013 .",
    "@xmath1074 thus represents the increase in the size of the current  structure @xmath1013 if the procedure adds @xmath886 .",
    "let @xmath1075 and let @xmath1076 be the edges in @xmath1077 directed away from @xmath982 where @xmath1078 .",
    "define @xmath1079 be the endpoints of the missing edges on @xmath886 .",
    "hence , it holds that @xmath1080 ) \\notin h_t \\mbox{~for every~ } \\nonumber z_{\\ell } \\in z_{i , j } \\mbox{~and~ } { \\mbox{\\rm dist}}(z_{\\ell } , z_{\\ell ' } , p^-_{i , j})&\\geq & 3~\\end{aligned}\\ ] ] for every @xmath1081 .",
    "let @xmath1082 be the set of pairs @xmath1083 such that the distance between @xmath982 and @xmath947 is improved by adding @xmath886 to @xmath1084 .",
    "similarly , let @xmath1085 be the cluster of @xmath1086 and define @xmath1087 as the set of pairs @xmath1088 such that the distance between @xmath1089 and @xmath1090 is improved by adding @xmath886 to @xmath1013 .",
    "define @xmath1091 the path - buying strategy is as follows .",
    "if @xmath1092 then we `` buy '' the path @xmath886 , namely , set @xmath1093 . otherwise , we do not buy @xmath886 and set @xmath1094 .",
    "the final spanner is given by @xmath1095          recall that by fact [ fc : clustering](2 ) , the diameter of each cluster is at most @xmath699 .",
    "as the distance between different @xmath1098 s in @xmath1099 is at least @xmath1100 , it follows that @xmath1098 and @xmath1101 belong to distinct clusters . to establish the correctness of the construction , we show the following .",
    "the proof is by contradiction .",
    "let @xmath1104 and @xmath1105 be the set of  bad pairs , \" namely , vertex - edge pairs @xmath159 whose additive stretch in @xmath1 is greater than 4 .",
    "assume , towards contradiction , that @xmath281 .",
    "for each bad pair @xmath282 , it holds that @xmath864 ( since @xmath1106 ) . for every bad pair @xmath1107 define @xmath879 to be the replacement path whose last missing edge in @xmath1 , @xmath1108 , is the shallowest among all @xmath855 replacement paths in @xmath248 .",
    "let @xmath1109 .",
    "finally , let @xmath1110 be the pair that minimizes @xmath290 , and let @xmath1111 .",
    "note that @xmath1112 is the _",
    "_ `` deepest missing edge '' over all bad pairs @xmath282 .",
    "[ fig : addcorrect ] for an illustration .",
    "assume towards contradiction that @xmath1114 and let @xmath1115 .",
    "hence , since @xmath1114 , it holds that @xmath1116|+4 .",
    "\\nonumber\\end{aligned}\\ ] ] we now consider the following @xmath1117 replacement path @xmath1118 $ ] . by definition of @xmath1119 , @xmath1120 .",
    "in addition , @xmath1121 ) .",
    "this contradicts the fact that @xmath1122 .",
    "in particular , we have that @xmath1123 , hence @xmath1124 is defined .",
    "assume towards contradiction that @xmath1126 .",
    "then since @xmath1122 it holds that there exists at least one missing edge in @xmath1124 which is strictly above @xmath1127 . since @xmath1128|$ ] , we get that @xmath1129 , contradiction to the definition of @xmath1130 .",
    "since the last edge of @xmath1124 is missing , it holds that ( a ) @xmath1131 is clustered ( by fact [ fc : clustering ] ) and ( b ) that the last edge of every @xmath1132 replacement path is missing in @xmath1 as well . in particular , for the replacement path @xmath1133 constructed by algorithm , @xmath1134 is missing in @xmath1 .",
    "hence , it holds that @xmath1135 .",
    "it then holds by eq .",
    "( [ eq : paths_to_buy ] ) , that @xmath1136 \\in \\mathcal{p}$ ] , i.e. , @xmath1137 is in the collection of detours considered to be purchased in the path - buying procedure .",
    "let @xmath1138 and @xmath78 be the iteration where @xmath267 was considered to be added to @xmath1139 .",
    "we now consider two cases .",
    "if @xmath267 was bought , then @xmath1140 hence we get a contradiction to the fact that @xmath1113 .",
    "hence , it remains to consider the case where @xmath267 was not bought .",
    "let @xmath1141 and @xmath1142 for @xmath1143 be the corresponding vertices in @xmath267 with a missing edges that satisfy eq .",
    "( [ eq : z_up_add ] ) . by obs .",
    "[ obs : z_in_diffclus ] , each @xmath1144 belongs to a distinct cluster @xmath1089 .",
    "hence there are at least @xmath1145 distinct clusters on @xmath267 .",
    "let @xmath1146 be the cluster of @xmath1131 ( since @xmath1131 is incident to a missing edge in @xmath1147 , by fact [ fc : clustering](1 ) , @xmath1131 is indeed clustered ) .",
    "a cluster @xmath1089 with @xmath1148 is a _ contributor _ if adding @xmath267 to @xmath1013 improves either the @xmath1149 distance or the @xmath1150 distance in @xmath1013 .",
    "i.e. , if it satisfies either @xmath1151 ( hence @xmath1152 ) , or @xmath1153 ( hence @xmath1154 ) .",
    "otherwise , @xmath1089 is _",
    "neutral_. that is , @xmath1089 is neutral if @xmath1155 and in addition , @xmath1156 .",
    "there are two cases to consider .",
    "if all clusters are contributors ( i.e. , there is no neutral cluster ) then all the @xmath1145 clusters contribute to @xmath1157 ( either with @xmath1158 or with @xmath1131 or both ) .",
    "it then holds that @xmath1159 .",
    "hence , by eq .",
    "( [ eq : cost_value ] ) , we get a contradiction to the fact that @xmath267 was not added to @xmath1013 . in the other case ,",
    "there exists at least one neutral cluster @xmath1089 having a unique vertex @xmath1098 in @xmath267 such that @xmath1160 let @xmath1161 be the closest vertex in the cluster @xmath1089 to the divergence point @xmath1158 in the graph @xmath1162 and define @xmath1163 such that @xmath1161 , hence @xmath1164 .",
    "let @xmath1165 , @xmath1166 be the closest pair of vertices in the cluster @xmath1089 and @xmath1146 repetitively in the graph @xmath1167 .",
    "define @xmath1168 , then @xmath1169 .",
    "let @xmath1170 and @xmath1171 .",
    "since @xmath1172 and @xmath1173 , it holds that @xmath1174 .",
    "consider the following @xmath1175 replacement path @xmath1176 .",
    "we first claim that @xmath1177 . first note that since @xmath1178 , it holds that the intra cluster paths @xmath1179 and @xmath1180 are free of the failed edge @xmath1181 .",
    "in addition , since @xmath1182)\\notin \\currspanner_3 $ ] , by lemma [ lem : rep_new](c ) , it holds that @xmath1183 .",
    "in addition , by the definition of @xmath1184 , it holds that @xmath1185 .    finally , we bound the length of @xmath1184 .",
    "@xmath1186 ) .",
    "we therefore have that the path @xmath1187 exists in @xmath1188 and in addition , @xmath1189|+|p^{-}_{i_1,j_0}|+4=|p^*_{i_1,j_0}|+4.\\ ] ] this contradicts the assumption that @xmath1113 .",
    "the lemma follows .",
    "let @xmath1191 be the set of paths that were bought in the path - buying procedure .",
    "since @xmath1192 , it remains to bound the number of edges added due to the paths in @xmath1024 .",
    "note that for @xmath937 , it holds by fact [ fc : clustering ] , that there are @xmath890 clusters .",
    "in addition , recall that for every cluster @xmath1065 , it holds that @xmath1193 .",
    "we have the following .",
    "@xmath1194 where the inequality follows by eq .",
    "( [ eq : cost_value ] ) , and the last equality follows by eq .",
    "( [ eq : value ] ) .",
    "our counting strategy is as follows .",
    "we fix a cluster @xmath1089 , and bound the number of times it appears in either @xmath1195 or @xmath1196 over all @xmath1197 .",
    "the following definition is useful in our analysis .",
    "define the multisets @xmath1198 note that certain pairs might appear several times in both @xmath1199 and @xmath1200 .",
    "hence , we do not bound the number of unique pairs but also take into account the possible reappearance of the same pair in these expressions . eq .",
    "( [ eq : nmiss_val ] ) can now be written equivalently as @xmath1201 we now show the following .",
    "we begin by showing that for @xmath1046 , if @xmath1203 then @xmath1204 . to see that , let @xmath78 be the iteration in which @xmath886 was added to @xmath1139 .",
    "it then holds that there exists @xmath1205 that satisfies eq .",
    "( [ eq : contx ] ) . by the definition of @xmath1099",
    ", we have that @xmath1206 ) \\notin \\currspanner_3 $ ] .",
    "hence , by lemma [ lem : rep_new](c ) it holds that @xmath1204 .",
    "we proceed by showing that for every fixed @xmath1204 , the pair @xmath1207 can appear at most 3 times in the multiset @xmath1208 .",
    "formally , define the set of paths in which @xmath982 contributes with the cluster @xmath1089 as @xmath1209      let @xmath1212 be sorted according to the time @xmath1213 they were bought and added to the graph @xmath1214 .",
    "hence , @xmath1215 . we claim that @xmath1216 . for each @xmath1217 , considered at time @xmath1213 where @xmath1218 , there exists a vertex @xmath1219 such that @xmath1220 ) \\notin h_{t_k}$ ] and @xmath1221 .",
    "this holds as by definition , @xmath1222 for every @xmath1223 and by eq .",
    "( [ eq : contx ] ) .",
    "we now show that , denoting @xmath1224 we have @xmath1225 for every @xmath1226 .    at each time @xmath1213 , since a contribution is made , and by the fact that @xmath1227 , we have that @xmath1228 where the first inequality holds as @xmath1229 was bought at time @xmath1213 and hence @xmath1230 . by obs .",
    "[ obs : z_in_diffclus ] , @xmath1231 are the unique vertices in @xmath1089 in the sets @xmath1232 and @xmath1233 respectively .",
    "the equality of ( [ eq : pb_zineq ] ) holds since @xmath1234 ) \\notin \\currspanner_3 $ ] and hence by [ lem : rep_new](b ) , @xmath1229 is edge disjoint with @xmath1235 . since by obs .",
    "[ obs : path_pi_cluster ] , @xmath1236 , it holds that @xmath1229 and @xmath1237 are edge disjoint as well . the strict inequality in ( [ eq : pb_zineq ] ) follows by eq . ( [ eq : contx ] ) and by the fact that the pair @xmath1238 contributes to the value of @xmath1229 i.e. , @xmath1239 .",
    "the last inequality follows by the fact that @xmath1240 . hence , letting @xmath1241 we have @xmath1242 conversely , we also have the following .",
    "@xmath1243 where eq .",
    "( [ eq : cor11 ] ) follows by the fact that @xmath1244 , @xmath1245)\\notin \\currspanner_3 $ ] and hence by lemma [ lem : rep_new](a ) , @xmath1246 .",
    "( [ eq : cor12 ] ) follows by the fact that @xmath1247 and by fact [ fc : clustering](2 ) .",
    "( [ eq : cor13 ] ) follows by the fact that @xmath1248 .",
    "( [ eq : cor14 ] ) follows by the fact that @xmath1249 and @xmath1250=p^*_{i_1,j_1}[b_{i , j } , z_1]$ ] . to see eq .",
    "( [ eq : cor15 ] ) , note that by lemma [ lem : rep_new](b ) , it holds that @xmath1250 $ ] and @xmath1251 are edge disjoint .",
    "in addition , by obs .",
    "[ obs : path_pi_cluster ] , @xmath1252 , hence @xmath1250 $ ] and @xmath1252 are edge disjoint as well .",
    "finally , eq . ( [ eq : cor16 ] ) follows as @xmath1253 since @xmath1254 was bought at time @xmath1255 .",
    "we therefore have that @xmath1256 , combining with eq .",
    "( [ eq : ad_up_u1 ] ) , we have @xmath1257 . since @xmath1258 only if @xmath1204 , it follows from cl .",
    "[ cl : bound_aij ] that @xmath1259 the lemma follows .",
    "we now turn to consider the second type of contribution of the form @xmath1260 .      for",
    "every cluster @xmath1262 define the multiset @xmath1263 note that the pair @xmath1264 can contribute several times to @xmath1265 with the same @xmath518 .",
    "hence , we do not count only unique pairs as the same pair might contribute several times .",
    "in fact , we count the number of all times in which a path @xmath1197 was bought , and the pair @xmath1266 such that @xmath1267 contributes to the value of the path @xmath267 . since missing edges in @xmath891 are between vertices of different clusters , we have that @xmath1268 .",
    "we now show that each @xmath1269 which concludes the proof since there are overall @xmath1270 clusters in @xmath891 .",
    "we do not assume that the @xmath1274 s are distinct .",
    "let @xmath1275 be the unique vertex of @xmath1089 in @xmath1276 that contributes by adding its path @xmath1229 to @xmath1277 to @xmath1214 .",
    "we then have that @xmath1278 ) \\notin h_{t_k}$ ] and hence by lemma [ lem : rep_new](a ) , @xmath1279 .",
    "in addition , since @xmath1280 , by lemma [ lem : rep_new](a ) it also holds that @xmath1281 as @xmath1282 .",
    "hence , @xmath1283 we next show that , denoting @xmath1284 we have @xmath1285 for every @xmath1286 .",
    "note the each @xmath1287 belongs to the same cluster @xmath1146 and every @xmath1288 for @xmath1223 belongs to the same cluster @xmath1089 .",
    "each time a contribution is made at time @xmath1213 , it implies that @xmath1289 where eq .",
    "( [ eq : adub_1 ] ) follows by the fact that @xmath1230 , eq .",
    "( [ eq : adub_2 ] ) follows by the fact that @xmath1290 , and hence by lemma [ lem : rep_new ] , @xmath1291 $ ] and @xmath1292 are edge disjoint .",
    "in addition , by obs .",
    "[ obs : path_pi_cluster ] , @xmath1293 , hence @xmath1294 and @xmath1229 are edge disjoint as well .",
    "( [ eq : adub_3 ] ) follows by eq .",
    "( [ eq : conty ] ) and the fact that @xmath1295 and finally , eq . ( [ eq : adub_4 ] ) follows by the fact that @xmath1296 and @xmath1240 . therefore , letting @xmath1297 we have that @xmath1298 conversely , we have that @xmath1299 where eq .",
    "( [ eq : up_t01 ] ) follows as @xmath1248 .",
    "( [ eq : up_t02 ] ) follows by the fact that @xmath1300 and @xmath1301 and by fact [ fc : clustering](b ) .",
    "( [ eq : up_t03 ] ) follows by the fact that @xmath1302=q_1[z_1,v_{i_1}]$ ] and @xmath1249 .",
    "in addition , by lemma [ lem : rep_new ] , since @xmath1303 , it holds that @xmath373 and @xmath1304 are edge disjoint . by obs .",
    "[ obs : path_pi_cluster ] , @xmath1305 , hence @xmath373 and @xmath1294 are edge disjoint as well . finally , eq . ( [ eq : up_t04 ] ) , follows as @xmath1306 since @xmath1254 was added to @xmath1307 at time @xmath1255 .    combining with eq .",
    "( [ eq : up_srtect1 ] ) , we get that @xmath1308 and hence @xmath1261 .",
    "the claim follows .",
    "overall , by lemma [ contb_clust ] and lemma [ contv_clust ] , we have that @xmath1309 for every @xmath1089 .",
    "hence , by plugging into eq .",
    "( [ eq : up_add_cluster_cont ] ) , as there are @xmath890 clusters , we have that @xmath1310 as required . the lemma follows",
    ".          s.  baswana and n.  khanna .",
    "approximate shortest paths avoiding a failed vertex : optimal size data structures for unweighted graph . in _ proc .",
    "27th symp . on theoret .",
    "aspects of computer sci .",
    "_ , 513524 , 2010 .",
    "a.  bernstein .",
    "a nearly optimal algorithm for approximating replacement paths and k shortest simple paths in general graphs . in _ proc .",
    "21st acm - siam symp . on discrete algorithms _ , 2010 .",
    "g.  braunschvig , s.  chechik and d.  peleg . in _ proc .",
    "38th workshop on graph - theoretic concepts in computer science _",
    ", 206214 , 2012 .",
    "r.  wenger .",
    "extremal graphs with no @xmath1312 s , @xmath1313 s , or @xmath1314 s . , 52:113116 , 1991 .",
    "d.p  woodruff .",
    "lower bounds for additive spanners , emulators , and more . in _ proc .",
    "47th symp . on foundations of computer science _ , 389398 , 2006 ."
  ],
  "abstract_text": [
    "<S> a _ fault - tolerant _ structure for a network is required to continue functioning following the failure of some of the network s edges or vertices . </S>",
    "<S> this paper addresses the problem of designing a _ fault - tolerant _ </S>",
    "<S> @xmath0 approximate bfs structure ( or _  structure _ for short ) , namely , a subgraph @xmath1 of the network @xmath2 such that subsequent to the failure of some subset @xmath3 of edges or vertices , the surviving part of @xmath1 still contains an _ approximate _ bfs spanning tree for ( the surviving part of ) @xmath2 , satisfying @xmath4 for every @xmath5 .    </S>",
    "<S> we first consider _ multiplicative _ </S>",
    "<S> @xmath6  structures resilient to a failure of a single edge and present an algorithm that given an @xmath7-vertex unweighted undirected graph @xmath2 and a source @xmath8 constructs a @xmath9  structure rooted at @xmath8 with at most @xmath10 edges ( improving by an @xmath11 factor on the near - tight result of @xcite for the special case of edge failures ) . assuming at most @xmath12 edge failures , </S>",
    "<S> for constant integer @xmath13 , we prove that there exists a ( poly - time constructible ) @xmath14  structure with @xmath15 edges . </S>",
    "<S> we then consider _ additive _ </S>",
    "<S> @xmath16  structures . </S>",
    "<S> in contrast to the linear size of @xmath6  structures , we show that for every @xmath17 $ ] there exists an @xmath7-vertex graph @xmath2 with a source @xmath8 for which any @xmath16  structure rooted at @xmath8 has @xmath18 edges , for some function @xmath19 . in particular , @xmath20  structures admit a lower bound of @xmath21 edges . </S>",
    "<S> these lower bounds demonstrate an interesting dichotomy between multiplicative and additive spanners ; whereas @xmath6  structures of size @xmath22 exist ( for @xmath23 ) , their additive counterparts , @xmath16  structures , are of super - linear size . </S>",
    "<S> our lower bounds are complemented by an upper bound , showing that there exists a poly - time algorithm that for every @xmath7-vertex unweighted undirected graph @xmath2 and source @xmath8 constructs a @xmath24  structure rooted at @xmath8 with at most @xmath25 edges . </S>"
  ]
}