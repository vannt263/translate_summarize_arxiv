{
  "article_text": [
    "optical cross phase modulation ( xpm ) is a specific variant of nonlinear optical phenomena of kerr type in which the refractive index @xmath0 of light in pulse 1 varies linearly with the intensity @xmath1 of another light field , so that @xmath2 , with @xmath3 the permittivity of the medium , @xmath4 the linear , and @xmath5 the nonlinear xpm susceptibility , respectively . in ordinary optical media",
    "this effect is small and requires large intensities , but the proposal by schmidt and imamolu @xcite to generate giant nonlinearities using electromagnetically induced transparency ( eit ) @xcite has made very large kerr coefficients possible @xcite and may even lead to nonlinear effects at the single - photon level @xcite .",
    "xpm is a strong candidate for the design of optical quantum controlled - phase gates ( cpg ) for photonic quantum information processing  @xcite , in which two single - photon pulses would become entangled . for sufficiently high fidelity",
    ", xpm would allow the construction of deterministic gates , as opposed to the non - deterministic optical cpg that are based on linear optics @xcite and establish entanglement through measurements  @xcite .",
    "it has been suggested that double eit ",
    "eit for both pulses with matched group velocities  would generate the maximal xpm phase shift because matched group velocities for both photons would maximize their interaction time @xcite .",
    "however , xpm based on double eit still faces some challenges : ( i ) to achieve sufficiently high intensities at the two - photon level , the photon pulses must be tightly confined in the transversal direction ; ( ii ) if the nonlinear medium has a finite response time , the matter - light interaction unavoidably induces noise .",
    "it was shown by shapiro @xcite that for a large class of xpm models this would limit the fidelity of a cpg to only about 65% .",
    "further theoretical studies on this topic confirmed these results @xcite .",
    "( iii ) for matched co - propagating pulses , each point of the pulse will experience a different xpm phase shift because the intensity , and hence the refractive index @xmath0 , varies over the shape of the pulse .",
    "this would severely affect the entanglement between the pulses .",
    "in this paper we will address the third problem and do not deal with problem ( i ) and ( ii ) , i.e. , we will assume that transverse confinement of the photon pulses can be achieved by some means , such as hollow core fibers @xcite or nano wires @xcite , and that the medium s response time is so short that the polarizability of the medium reacts instantaneously to a photon s electric field .",
    "the omission of the noise associated with a finite response time is also made for clarity because , despite that we are working in the instantaneous regime , we will show that very similar effects may appear if the two light pulses have different group velocities .",
    "scheme to achieve uniform xpm : two light pulses @xmath6 travel at different group velocities @xmath7 through an xpm medium such that @xmath8 can overtake @xmath9 .",
    "@xmath10 denotes the initial distance between the two pulses .",
    ", width=302 ]    to solve problem ( iii ) we extend an idea of rothenberg @xcite who demonstrated a uniform xpm phase shift for classical pulses in birefringent fibers : two light pulses travel through a xpm medium with different group velocities @xmath11 , see fig .  [ initmodes ] .",
    "pulse 2 ( blue ) reaches the kerr medium first but pulse 1 ( green ) is faster and leaves it first .",
    "while the pulses overlap they interact via the kerr effect , which is proportional to the pulse intensity .",
    "because pulse 1 overtakes pulse 2 the acquired phase shift will be averaged over the pulse shape and thus be nearly uniform .",
    "here we generalize this idea to characterize the propagation of quantized light pulses and show that a uniform phase shift can also be achieved for quantum interference effects .",
    "we will show that quantizing the classical xpm equations is generally a subtle problem which may make the introduction of noise terms similar to those in problem ( i ) necessary .",
    "we exploit our results to suggest experiments for quantum non - demolition ( qnd ) measurement of photon numbers and cpg .",
    "this paper is organized as follows . in sec .",
    "[ sec : pulseprop ] we will present a phenomenological quantum model for xpm between two pulses with different group velocities and discuss the two cases of unitary and non - unitary dynamics in this model . in sec .",
    "[ sec : xpmunitary ] we present proposals for qnd measurement of photon numbers and cpg and show that they can have a high fidelity in this case .",
    "the analysis of these proposals for the non - unitary case is presented in sec .",
    "[ sec : nonunitary ] .",
    "several appendices contain details of our derivation .",
    "we consider two quantized light pulses that travel through an xpm medium with different group velocities @xmath11 .",
    "we assume that the light pulses are transversally confined so that we can restrict the model to one spatial dimension . in classical fiber optics",
    "this situation is commonly described by the set of equations @xcite @xmath12 with imaginary unit @xmath13 . here",
    "@xmath14 is the field amplitude of pulse @xmath15 , @xmath16 is proportional to the intensity , and @xmath17 is the self phase modulation ( spm ) coefficient .",
    "the xpm coefficient is given by @xmath18 .",
    "this model is local and instantaneous ; i.e. , the light field @xmath19 is only affected by @xmath20 and vice versa .    in the context of spm , joneckis and shapiro",
    "have shown that in a local and instantaneous quantum model , where @xmath14 represents a field operator , infinite zero - point fluctuations do occur @xcite .",
    "they suggested taking a finite response time of the medium into account to avoid singularities .",
    "we instead propose a model in which the medium s response is still instantaneous but spatially nonlocal , i.e. , @xmath19 can be affected by @xmath21 . the most general macroscopic model that describes such an instantaneous interaction between two light pulses of different group velocities is then given by @xmath22 here and henceforth @xmath23 denotes the field operator and @xmath24 the intensity operator .",
    "the quantities @xmath25 are spatially nonlocal interaction potentials between the two pulses generated by the atomic medium . to avoid causality violation",
    "its support must be much smaller than the wavelength of light .",
    "we will assume that @xmath25 is essentially zero if the distance between @xmath26 and @xmath27 is much larger than the bohr radius .",
    "one can consider the introduction of nonlocal potentials as a regularization of the classical theory ( [ xpmeqnclass ] ) by smearing out the point interaction . in the limit of sharp potentials ,",
    "@xmath28 , the regularized model reduces to eq .",
    "( [ xpmeqnclass ] ) for xpm coefficient @xmath29 .",
    "multi - photon pulse dynamics should account for spm , but we omit this effect here in order to focus on xpm . when xpm is placed in the context of interferometry , which gives phase an operational meaning , pairs of nonlinear media in both paths",
    "can offset spm @xcite .",
    "alternatively spm is not present for single - photon pulses because a single photon can not induce spm on itself .",
    "the multi - mode field operators @xmath30 satisfy the commutation relations @xmath31&=\\frac{\\hbar",
    "\\omega_i}{2 \\epsilon_0 a } \\delta_{ij } \\delta(z - z ' )    \\equiv \\eta \\delta_{ij }   \\delta(z - z ' ) , \\end{aligned}\\ ] ] with @xmath32 the central frequency of pulse @xmath33 and @xmath34 the transverse area of the pulses .",
    "the field is assumed to be in a single mode with the @xmath35 longitudinal mode function given by @xmath36 .",
    "photons in this mode are annihilated by the operator @xmath37 & = \\frac{1}{\\sqrt{\\eta}}\\int_{-\\infty}^{\\infty } dz\\ , \\psi^{*}_i(z - u)\\ , \\hat { \\cal{e}}_i(z,0 ) \\ ; , \\label{eq : amodeop}\\end{aligned}\\ ] ] for later use we have included a possible shift @xmath38 of the wavefunction . if the shift is zero we will sometimes suppress this notation and write @xmath39 $ ] .    if eq .",
    "( [ xpmeqn ] ) is taken to be the dynamical equation of the quantum fields @xmath23 one has to be careful with its interpretation .",
    "it can be shown that eq .",
    "( [ xpmeqn ] ) can be expressed as @xmath40 $ ] for some hamiltonian @xmath41 if and only if @xmath42 .",
    "in other words , a unitary evolution of the quantum fields will only occur if the two interaction potentials are proportional to each other , with the proportionality factor given by the ratio of the group velocities . in absence of absorption or other decohering processes",
    "one therefore would assume that in the quantum model this relation must be fulfilled .",
    "however , in the corresponding classical models for xpm pulse propagation this is generally not the case @xcite .    in our subsequent analysis",
    "we will therefore first assume that the evolution is unitary and analyze our proposals within this framework . in sec .",
    "[ sec : nonunitary ] we then will develop a consistent phenomenological quantum model for non - unitary evolution using techniques of open quantum systems and reassess the proposals for this case @xcite .",
    "to devise a scheme for cpg and qnd measurements of the photon number we will assume that the dynamics is unitary ; in this case the interaction potentials can generally be written as @xmath43 , with @xmath44 a hamiltonian interaction potential .",
    "however , we will make use of this relation only after deriving general results in order to facilitate the extension to non - unitary dynamics .    the solution of eq .",
    "( [ xpmeqn ] ) for the propagation of light in an infinitely extended xpm medium is @xmath45 t \\right ) dz ' \\bigg ) , \\label{eq : u1}\\\\    \\theta_i ( z_1,z_2 ) & \\equiv    \\int_0^{z_2 } dz ' \\ , v_i(z_1-z ' ) \\ ; .\\end{aligned}\\ ] ] the function @xmath46 will play a central role in determining the kerr phase shift .",
    "one important property is that for a symmetric potential , @xmath47 , we have @xmath48 .",
    "as a first application we consider a qnd measurement of the number of photons @xcite in mode 2 . this can be accomplished by sending a strong classical pulse in mode 1 , which can be described by a coherent state @xmath49 , together with an @xmath50 photon pulse @xmath51 in mode 2 through the xpm medium .",
    "single - mode treatments predict that in this case the phase of the classical pulse will be shifted by an amount that is proportional to @xmath50 . here",
    "we show that the uniform cross phase shift that we suggest will accomplish precisely this .",
    "the initial state of the two light pulses before they start to interact takes the form @xmath52 this can be expressed as @xmath53 the complex amplitude of the classical pulse at time @xmath54 and position @xmath26 is given by @xmath55 .",
    "its phase can be measured using homodyne detection @xcite , for instance , which more specifically measures the observable @xmath56 .",
    "using eq .",
    "( [ eq : comm1 ] ) it is easy to see that @xmath57 exploiting this and solution ( [ solu ] ) we get @xmath58   ) ^n |0 \\rangle , \\label{eq : qndresult1}\\end{aligned}\\ ] ] where we have used eq .",
    "( [ eq : unitransa ] ) and introduced an xpm - modified annihilation operator @xmath59 & \\equiv      \\frac{1}{\\sqrt{\\eta}}\\int_{-\\infty}^{\\infty } dz'\\ ,    \\psi^{*}_i(z'-u)\\ ,    \\hat { \\cal{e}}_i(z',0 )   \\nonumber \\\\ &",
    "\\times    e^ {      -{\\rm i}\\eta \\frac { v_{3-i}}{v_i - v_{3-i } }      \\theta_{3-i}(z - z ' -v_{3-i } t , ( v_i - v_{3-i } ) t )    } \\ ; .",
    "\\label{eq : atilde}\\end{aligned}\\ ] ] the physical interpretation of eq .",
    "( [ eq : atilde ] ) is that the wavepacket @xmath60 is multiplied by a spatially varying phase factor that is given by the exponential in eq .",
    "( [ eq : atilde ] ) and incorporates the effect of xpm on the light pulses .    the expectation value for field 2 in eq .",
    "( [ eq : qndresult1 ] ) can then be reduced to @xmath61     ) ^n |0 \\rangle   & =    n !   [ a_2 ,   \\tilde{a}_2^\\dagger[0;z , t]\\ , ] ^n,\\end{aligned}\\ ] ] so that @xmath62 with @xmath63 .    to better understand the physical implications of eq .",
    "( [ eq : qndresult ] ) we consider the specific configuration depicted in fig .  [ initmodes ] .",
    "the classical mode @xmath8 is initially centered around the origin while the @xmath50-photon pulse in mode @xmath9 is a distance @xmath10 to the right of it @xcite .",
    "both pulses are moving to the right , but pulse 1 is faster . the first line in eq .",
    "( [ eq : qndresult ] ) is basically the amplitude of the classical pulse @xmath8 at time @xmath54 in absence of the xpm medium .",
    "the pulse is centered around @xmath64 . hence , to achieve an maximum phase contrast , we should observe the field at this point .",
    "the exponential in eq .",
    "( [ eq : qndresult ] ) is then proportional to @xmath65 .    in appendix [ app : phaseshift ]",
    "it is shown that for any potential @xmath66 that is consistent with causality , the function @xmath65 is nearly constant between the lines @xmath67 and @xmath68 and zero outside of this range .",
    "the support of the initial wavepacket @xmath69 is in the area @xmath70 and peaked around @xmath71 . for sufficiently large times , such that @xmath72 , the support of @xmath69 is therefore completely inside the domain where @xmath73 , with the constant @xmath74 this condition corresponds to the requirement that the classical pulse 1 had enough time to overtake the @xmath50-photon pulse 2 . because the mode function @xmath9 is normalized",
    "we thus find @xmath75 we remark that @xmath76 for unitary dynamics .",
    "( [ eq : qndresult2 ] ) is precisely the result that one would obtain in a single - mode treatment .",
    "hence , for unitary dynamics a mismatch in the group velocities of two pulses that allows one pulse to overtake the other in a kerr medium will result in a uniform phase shift for qnd measurements of the photon number . in practice , overtaking will impose a minimum requirement on the length of the kerr medium and spm will lead to a distortion of the signal .",
    "our proposal to build a cpg extends previous designs to build quantum gates using xpm @xcite by ensuring a uniform xpm phase shift . in a controlled phase gate , two qubits with logical basis states @xmath77",
    "are manipulated in such a way that the state acquires a phase shift @xmath78 only if both qubits are in the logical state @xmath79 . in other words ,",
    "a cpg is a unitary operator that maps the basis states @xmath80 to @xcite @xmath81    [ cols=\"^,^ \" , ]     with the uniform cross phase shifter discussed above , such a gate can be implemented for time - bin encoded photonic qubits as indicated in fig .",
    "[ setup ] . in this case",
    "each optical field @xmath82 carries one photon . for each photon",
    "the logical basis states are encoded in two wavepackets , one of which is delayed compared to the other .",
    "the logical state @xmath83 for qubit @xmath50 ( @xmath84 ) can be encoded in wavepackets @xmath85 so that photons in this state are annihilated by operator @xmath86 $ ] .",
    "the logical state @xmath87 can be encoded in wavepackets that are shifted to the right , @xmath88 ; photons in this state are annihilated by the operators @xmath89 $ ] .",
    "a cpg can then be constructed by arranging the initial distances between the wavepackets in such a way that the only states that do overlap inside the xpm medium are state @xmath87 of the first qubit and state @xmath83 of the second qubit . for all other logical states",
    "the wavepackets in the two field modes never overlap so that there is no xpm effect .",
    "the logical basis states for two time - bin encoded qubits at time @xmath54 are given by the set @xmath90\\ , a_2^\\dagger[\\delta z^{(2)}_j+v_2 t]\\ , |0 \\rangle , \\label{eq : logstates}\\ ] ] for @xmath91 for @xmath92 , respectively .",
    "the factors @xmath93 represent an explicit time dependence in the definition of the logical states such that they are co - moving with the wavepackets at group velocity @xmath94 .",
    "we consider the case that the two photons are initially prepared in a pure two - qubit state @xmath95 . to characterize the performance of the cpg we need to obtain the logical components @xmath96 of the density matrix @xmath97 at time @xmath54 .",
    "a somewhat tedious calculation that can be found in app .",
    "[ app : rhounitaryderivation ] leads to @xmath98 with @xmath99 the phase factor in eq .",
    "( [ xij2a ] ) determines the xpm effect .",
    "we now prove that it is only nontrivial for the logical state @xmath100 because only in this case the associated wavepackets overtake each other .",
    "the phase factor is proportional to the function @xmath101 which , according to appendix [ app : phaseshift ] , is nearly constant for a given range of its two variables . ignoring the variables @xmath102 for the moment we consider @xmath103 instead .",
    "for the four states @xmath104 the first argument takes the values @xmath105 , and @xmath10 respectively .",
    "if we choose the time @xmath54 for which the photons are interacting such that @xmath106 then @xmath107 for @xmath108 and @xmath109 for @xmath110 .",
    "hence only the latter combination will experience an xpm phase shift .",
    "this conclusion also holds if we re - introduce the variables @xmath102 because they only vary over the support of the two wavepackets , which is smaller than @xmath111 ; the value of @xmath112 therefore does not change .",
    "thus we arrive at @xmath113 and the density matrix elements become @xmath114    let us now work out the performance of the cpg by calculating the concurrence @xcite of the density matrix ( [ eq : rhot ] ) for a specific initial product state @xmath115 , which corresponds to @xmath116 for all @xmath117 .",
    "the concurrence @xmath118 of the density matrix ( [ eq : rhot ] ) then evaluates to @xmath119 .",
    "this indicates a perfect cpg because the initial product state is transformed into a maximally entangled state provided one can achieve a large phase shift @xmath120 .",
    "in the previous section we have devised a scheme to create uniform xpm for quantized light pulses for the special case of unitary dynamics for which @xmath121 .",
    "the theory behind this scheme corresponds to a regularized quantization of the classical theory ( [ xpmeqnclass ] ) for the case that the xpm coefficients are related by @xmath122 .",
    "however , in classical optics this relation between the two xpm coefficients is not generally adopted . in this section",
    "we therefore study the quantization of the classical model with @xmath123 and its implications for quantum information processing . because the model needs to be regularized , we consider the general case with two non - local interaction potentials that fulfill @xmath124 .    the discussion in sec .",
    "[ sec : pulseprop ] has revealed that the quantum dynamics in this case must be non - unitary because there is no hamiltonian that can generate the equations of motion . as eq .",
    "( [ xpmeqn ] ) is based on a phenomenological model that does not explicitly include absorption or dissipation , the origin for this non - unitarity can not be identified in an unambiguous way",
    ". there might be implicit absorption processes hidden in the model , although we strongly doubt that this is the case because the dynamics does not have a structure that is comparable to the lindblad form @xcite .",
    "another possibility is that the external fields that usually are needed for eit - based xpm media may induce energy fluctuations that lead to non - hamiltonian dynamics .",
    "yet another possibility is that the direct quantization of the classical theory ( [ xpmeqnclass ] ) ignores the averaging processes that are associated with a macroscopic decription of electrodynamics @xcite .",
    "such averaging procedures lead to loss of information , which may induce decoherence in a quantum system .    despite this ambiguity with respect to the cause of non - unitary dynamics",
    "it is worthwhile studying this situation because one can gain a better understanding of the quantization of a new class of classical models .",
    "furthermore , even if the theory that we develop below can not include the microscopic details behind the xpm interaction it nevertheless should help to estimate the effects of a mismatch between the xpm coefficients .    in the case",
    "@xmath124 , eq .  ( [ solu ] ) still provides an exact solution to the dynamical equation of motion",
    ". however , this solution is inconsistent with basic requirements of quantum field theory . to illustrate this point we consider the equal - time commutation relations between the heisenberg field operators , which should agree with the commutation relations between the respective schrdinger operators . in our case",
    "this principle is violated because @xmath125 despite @xmath126=0 $ ] .",
    "the conventional way to deal with non - hamiltonian dynamics in the heisenberg picture is to introduce langevin noise operators . in the context of nonlinear optics",
    "this has first been done by boivin _",
    "@xcite in the case of time - dependent self - phase modulation .",
    "we now show that a similar approach can also be made for instantaneous xpm between two light pulses with different group velocities .",
    "following ref .",
    "@xcite we introduce hermitian decoherence operators @xmath127 such that the dynamical equations are modified to @xmath128 the decoherence operators commute with all field operators .",
    "we adopt the frequently used assumption of @xmath129-correlated decoherence , @xmath130 = { \\rm i}\\eta \\left (     \\textstyle { \\frac{v_i(z - z')}{v_j}- \\frac { v_j(z - z')}{v_i } } \\right ) \\delta(t - t ' ) .",
    "\\label{noisecom}\\ ] ] the solution of eq .",
    "( [ xpmeqn2 ] ) can be written as @xmath131 using the commutation relations ( [ noisecom ] ) it is not hard to show that @xmath132 as a consequence , solution ( [ sol2 ] ) fulfills the equal - time commutation relations . introducing the decoherence term in eq .",
    "( [ xpmeqn2 ] ) has thus led to a consistent quantum field theory of xpm for light pulses with different group velocities .      to characterize the performance of a cpg in the case of non - unitary dynamics we can repeat the steps discussed in sec .  [ sec : cpgunitary ] with solution ( [ solu ] ) replaced by eq .",
    "( [ sol2 ] ) . finding the logical density matrix elements",
    "must then be done within an open system approach that is described in app .",
    "[ app : rhononunitary ] . as a result ,",
    "the factors @xmath133 become operators on the hilbert space of the environment ( on which the decoherence operators act ) and eq .",
    "( [ eq : xij3 ] ) is replaced by @xmath134 the logical density matrix elements take the form @xmath135 with @xmath136 indicating the trace over the environment degrees of freedom and @xmath137 the initial state of the environment .    to keep the discussion concise we assume that the photon pulses are very sharp .",
    "we then can replace the squares of the wavefunctions by @xmath129 distributions and get @xmath138 the density matrix elements then become @xmath139 with the hermitian decoherence matrix @xmath140 in app .",
    "[ app : nijkl ] ) we show that it can be written as @xmath141 hence the influence of decoherence in our model can be described by four complex parameters @xmath142 , @xmath143 , and @xmath144 .",
    "this is a consequence of the approximation of very short pulses . for extended pulses",
    "additional decoherence contributions are anticipated .",
    "we again calculate the concurrence of density matrix ( [ eq : rhota ] ) for the initial product state @xmath116 for all @xmath117 .",
    "the specific values of the parameters @xmath142 , @xmath143 , and @xmath144 depend on the detailed decoherence model that one employs so that the predictions may vary substantially depending on the assumptions behind the model .",
    "we present one particular decoherence model in appendix [ app : noisemodel ] .",
    "however , all decoherence models must be consistent with all eigenvalues of the density matrix ( [ eq : rhot ] ) taking values between 0 and 1 .    to simplify the discussion we consider the special case @xmath120 for the oft - used assumption that the two interaction potentials @xmath66 are equal and independent of the group velocities @xcite so that @xmath145 . the phase factor that appears in the decoherence matrix ( [ noisemat ] ) is then @xmath146 .",
    "for a given value of @xmath147 we can derive a `` minimal decoherence model '' by finding those values of the parameters @xmath142 , @xmath143 , and @xmath144 which maximize the concurrence @xmath118 for a consistent density matrix .",
    "[ fig : concurrence ] shows the concurrence for this minimal decoherence model as a function of @xmath147 .",
    "the dots are found through a random search for the parameters @xmath142 , @xmath143 , and @xmath144 of the minimal decoherence model .",
    "each dot is based on a sample of typically @xmath148 random events .",
    "the error in each value is estimated to be about 5% .",
    "the concurrence decreases with @xmath149 and becomes zero for @xmath150 . in this case",
    "decoherence completely destroys the entangling capacity of the xpm interaction .",
    "the numerically determined density matrix then corresponds to a nearly equal mixture of two highly entangled states .",
    "concurrence as a function of the xpm phase shift for minimal decoherence ( dots ) and the decoherence model presented in appendix [ app : noisemodel ] ( solid line ) .",
    ", width=226 ]    realistic decoherence models would typically predict a less than optimal performance .",
    "for instance , the blue line in fig .",
    "[ fig : concurrence ] shows @xmath118 for the decoherence model of app .",
    "[ app : noisemodel ] under the fairly optimistic assumption @xmath151 , where @xmath152 is the width of a gaussian potential @xmath153 . for more realistic values",
    "@xmath154 @xcite the concurrence would be non - zero only in a very narrow range around @xmath76 .",
    "our phenomenological model therefore suggests that a cpg may not be achievable with xpm unless @xmath155 is very close to @xmath156 . in most proposals for xpm based on double eit",
    "this could be achieved by a suitable preparation of the atomic gas , although it may require fine tuning of parameters like magnetic fields or pump field intensities . a better way to achieve",
    "@xmath157 would be to find a system in which this is guaranteed through microscopic symmetries .",
    "the scheme for a qnd measurement of the photon number discussed in sec .",
    "[ sec : qndunitary ] can easily be extended to the non - unitary case by calculating the measurement signal @xmath158 using solution ( [ sol2 ] ) instead of ( [ solu ] ) .",
    "the only change is that the measurement result ( [ eq : qndresult2 ] ) is multiplied by @xmath159 .",
    "this factor depends strongly on the specific decoherence model but generally will lead to a decrease in the contrast of the phase measurement .    to give a rough estimate we consider the decoherence model of app .",
    "[ app : noisemodel ] in which the noise is generated by an environment consisting of a harmonic oscillator field with a flat frequency distribution .",
    "we then have @xmath160 the decoherence amplitude @xmath161 can vary between the optimal value 1 , if the interaction potential @xmath162 vanishes at the origin , and very small values for a sharply peaked potential .",
    "we remark that this result also demonstrates the necessity of a non - local potential to avoid the diverging quantum fluctuations in the case @xmath163 @xcite .",
    "it is instructive to evaluate this for a gaussian potential @xmath164 where @xmath165 and the width @xmath152 should be not substantially larger than an atom .",
    "we then find @xmath166 so that @xmath167 the first factor is proportional to the xpm phase shift difference .",
    "the last factor @xmath168 is typically much larger than one because the length @xmath169 must be larger than the width of the light pulses ( @xmath54 is the time needed for one pulse to overtake the other ) .",
    "hence , for very short ( femtosecond ) pulses the exponential may be of the same size as the xpm phase shift .",
    "typically , however , it will be much larger .",
    "we therefore conjecture that for the qnd measurement to be successful the xpm phase shifts @xmath170 in the two light pulses must also be nearly equal .",
    "in this paper we have devised a scheme to generate a uniform xpm for quantum information processing and applied it to characterize the fidelity of a qnd measurement of the number of photons in a light pulse and the performance of a deterministic cpg .",
    "the analysis is based on a regularized quantization ( [ xpmeqn ] ) of a common phenomenological model for the classical xpm effect between two light pulses with different group velocities .",
    "when the pulses overtake each other while traveling through a nonlinear medium the induced xpm phase shift @xmath171 is uniform over each pulse . for @xmath157 the dynamics is unitary and predicts perfect fidelities for qnd measurement and cpg . for @xmath172",
    "a decoherence effect must be introduced to keep the model consistent , and this decoherence significantly affects the fidelity of the gate and the qnd measurement .",
    "we thank a.  i.  lvovsky for helpful discussions . this work has been supported by nserc , icore , and quantumworks .",
    "b.  c.  s.  is a cifar associate .",
    "s.  a.  m.  acknowledges support from the russian foundation of basic research under grant # 08 - 07 - 00449 .",
    "in this appendix we will summarize a number of commutation relations that will be useful in deriving our main results .",
    "the effect of xpm on the pulse propagation is governed by the action of the unitary operators @xmath173 of eq .",
    "( [ eq : u1 ] ) on the field operators , @xmath174    the effect of xpm on the annihilation operator for photons in mode @xmath33 can be derived from the commutation relations @xmath175 , \\mathcal{e}_i^{\\dagger}(z,0)]&= \\sqrt{\\eta } \\psi_i^{*}(z - u ) , \\label{eq : comm1}\\end{aligned}\\ ] ] and @xmath176 u_i(z , t ) = \\tilde{a}_i[u ; z , t ] , \\label{eq : unitransa}\\ ] ] with @xmath177 $ ] of eq .",
    "( [ eq : atilde ] ) .",
    "if the potential @xmath66 has a finite range @xmath178 , so that it vanishes for @xmath179 , then @xmath46 has generally a shape similar to fig .  [ thetar ] .",
    "the function @xmath46 for a gaussian potential @xmath66 of width @xmath178 .",
    ", width=151 ]    it is essentially zero outside the `` edges '' depicted in the figure and has an extended plateau between the lines @xmath180 and @xmath181 .",
    "the value on the plateau is given by @xmath182 , with @xmath183 defined in eq .",
    "( [ calvidef ] ) .",
    "the only region where @xmath46 varies significantly are bands of width @xmath184 around the lines @xmath180 and @xmath181 , and only this transition region depends on the details of the potential . if the range @xmath178 is much smaller than the optical wavelength we can ignore the transition region so that @xmath46 can be replaced by the plateau value between the lines , @xmath185 with @xmath186 the step function .",
    "the evolution of the density matrix @xmath187 can be expressed with the aid of a unitary operator @xmath188 such that @xmath189 , with @xmath190 the logical matrix elements of the density matrix can then be expressed as @xmath191 . using the definition ( [ eq : logstates ] ) of the logical basis states",
    "we are then led to consider the expression @xmath192\\ ,     a_2[\\delta z^{(2)}_j+v_2 t]\\ , u(t ) .",
    "\\label{eq : step1}\\end{aligned}\\ ] ] we here inserted an additional factor @xmath193 which does not change the result because @xmath194 .",
    "the operators @xmath195 $ ] are defined using the schrdinger operator @xmath196 , see eq .",
    "( [ eq : amodeop ] ) .",
    "the effect of @xmath197 is now to replace the schrdinger operator by the respective heisenberg operator @xmath198 so that @xmath199\\ ,     a_2[\\delta z^{(2)}_j+v_2 t , t ] , \\label{eq : step2 } \\\\     a_i[z , t ] & \\equiv \\frac{1}{\\sqrt{\\eta}}\\int_{-\\infty}^{\\infty } dz\\ , \\psi^{*}_i(z - u)\\ , \\hat { \\cal{e}}_i(z , t ) \\ ; .\\end{aligned}\\ ] ] we thus find for the logical matrix elements @xmath200    a_1^\\dagger [ \\delta z^{(1)}_k+v_1 t , t]\\ ,       |0 \\rangle     \\nonumber \\\\ & \\times    \\langle 0|     a_1[\\delta z^{(1)}_i+v_1 t , t]\\ ,      a_2[\\delta z^{(2)}_j+v_2 t , t ] |\\psi ( 0 ) \\rangle .",
    "\\label{eq : step3}\\end{aligned}\\ ] ] we now concentrate on the factor @xmath201\\ ,      a_2[\\delta z^{(2)}_j+v_2 t , t ] |\\psi ( 0 ) \\rangle \\nonumber \\\\ & \\hspace{-3mm}=      \\frac{1}{\\eta}\\int   dz_1\\ , dz_2\\ ,      \\psi^{*}_1(z_1-v_1 t-\\delta z^{(1)}_i)\\ ,   \\nonumber \\\\ & \\times",
    "\\psi^{*}_2(z_2-v_2 t-\\delta z^{(2)}_j)\\ ,       \\langle 0|       u_2(z_1,t )   \\hat { \\cal{e}}_1(z_1-v_1t,0 )   \\nonumber \\\\ & \\times    u_1 ( z_2,t ) \\hat { \\cal{e}}_2(z_2-v_2 t,0 )     |\\psi(0 ) \\rangle",
    "\\nonumber \\\\ & \\hspace{-3mm}=      \\frac{1}{\\eta}\\int   dz_1\\ , dz_2\\ ,        \\psi^{*}_1(z_1-v_1 t-\\delta z^{(1)}_i)\\ ,   \\nonumber \\\\ & \\times      \\psi^{*}_2(z_2-v_2 t-\\delta z^{(2)}_j)\\ ,       \\langle 0|      u_1^\\dagger   ( z_2,t )   \\hat { \\cal{e}}_1(z_1-v_1t,0 )   \\nonumber \\\\ & \\times     u_1 ( z_2,t ) \\hat { \\cal{e}}_2(z_2-v_2 t,0 )     |\\psi(0 ) \\rangle",
    "\\nonumber \\\\ & \\hspace{-3mm}=      \\frac{1}{\\eta}\\int   dz'_1\\ , dz'_2\\ ,        \\psi^{*}_1(z'_1 ) \\ ,",
    "\\psi^{*}_2(z'_2+d ) \\nonumber \\\\ & \\times     e^ {   -{\\rm i}\\eta \\frac { v_{2}}{\\delta v }     \\theta_2 ( z'_2-z'_1+d + \\delta z^{(2)}_j-\\delta z^{(1)}_i , \\delta vt ) } \\nonumber \\\\ & \\times      \\langle 0|     \\hat { \\cal{e}}_1(z'_1+\\delta z^{(1)}_i , 0 )     \\hat { \\cal{e}}_2(z'_2+d+\\delta z^{(2)}_j , 0 )     |\\psi(0 ) \\rangle . \\label{xij1}\\end{aligned}\\ ] ] the expectation value in the last line can be considerably simplified .",
    "a_2^\\dagger [ \\delta z^{(2)}_l ]      |0\\rangle   \\nonumber \\\\ & \\hspace{-3mm}=    \\eta \\sum_{k , l } c_{kl }   \\psi_1(z'_1+\\delta z^{(1)}_i -\\delta z^{(1)}_k ) \\nonumber \\\\ & \\times    \\psi_2(z'_2+d+\\delta z^{(2)}_j - \\delta z^{(2)}_l ) .",
    "\\label{ijklfactor}\\end{aligned}\\ ] ] the wavefunctions in eq .",
    "( [ xij1 ] ) imply that @xmath203 because @xmath204 can only vary over the support of the wavefunctions .",
    "this in turn implies in eq .",
    "( [ ijklfactor ] ) that @xmath205 and @xmath206 because otherwise the argument of the wavefunctions would be outside of their support . hence , @xmath207 from which eq .",
    "( [ xij2a ] ) follows .",
    "the derivation of the logical density matrix elements for non - unitary evolution follows essentially the same steps as in the unitary case described in app .",
    "[ app : rhounitaryderivation ] .",
    "however , because the decoherence operators act on a different hilbert space @xmath208 associated with the environment , the calculations have to be made on an enlarged hilbert space @xmath209 that includes our system of photon pulses as well as the environment .",
    "the dynamics on this enlarged hilbert space is described by a unitary operator @xmath188 and we assume that initially system and environment are uncorrelated , @xmath210 , with @xmath211 of eq .",
    "( [ initrho ] ) .",
    "the logical matrix elements are then given by @xmath212 with @xmath213 the trace over the environment .",
    "we again start the derivation with term ( [ eq : step1 ] ) , but now @xmath214 refers to the unitary evolution on the total hilbert space . if @xmath214 leaves the ground state invariant , in the sense that @xmath215 for any state @xmath216 of the environment and a fixed unitary map @xmath217 that acts on the environment , then we can again make the transition to heisenberg operators as in eq .",
    "( [ eq : step2 ] ) .",
    "the logical matrix elements then can be written in the form ( [ eq : rhoxxnoise ] ) with the environment operators @xmath218\\ ,       a_2[\\delta z^{(2)}_j+v_2 t , t ] |\\psi ( 0 ) \\rangle \\nonumber \\\\ & =     \\frac{1}{\\eta}\\int   dz_1\\ , dz_2\\ ,   r_1(z_1,t ) r_2(z_2,t )      \\psi^{*}_1(z_1-v_1 t-\\delta z^{(1)}_i)\\ ,   \\nonumber \\\\ & \\times",
    "\\psi^{*}_2(z_2-v_2 t-\\delta z^{(2)}_j)\\ ,   e^ {   -{\\rm i}\\eta \\frac { v_{2}}{\\delta v }   \\theta_2 ( z_2-z_1+\\delta v t , \\delta vt ) } \\nonumber \\\\ & \\times      \\langle 0|     \\hat { \\cal{e}}_1(z_1-v_1t,0 )     \\hat { \\cal{e}}_2(z_2-v_2 t,0 )     |\\psi(0 ) \\rangle . \\label{xij1a}\\end{aligned}\\ ] ] this expression corresponds to eq .",
    "( [ xij1 ] ) . the argument that leads to eq .",
    "( [ ijklfactor2 ] ) can be repeated , resulting in @xmath219 which corresponds to eq .",
    "( [ xij2a ] ) .",
    "the discussion of the phase factor that leads to eq .",
    "( [ eq : xij3 ] ) is unaffected by the decoherence terms so that eq .",
    "( [ xij2a ] ) can be deduced .",
    "the decoherence matrix can be evaluated without further assumptions in a number of cases . because @xmath220 it is easy to see that the diagonal elements are equal to one .",
    "this also guarantees trace preservation . for the same reason , whenever @xmath221 the decoherence operators simplify to @xmath222 furthermore , for @xmath223 @xmath224 and @xmath225 have the same argument so that we can make use of eq .",
    "( [ noisetrans ] ) : @xmath226",
    "the following model is inspired by the decoherence model for time - dependent kerr nonlinearities of ref .",
    "@xcite and restricted to the case @xmath227 . the reservoir that produces the decoherence",
    "is composed out of harmonic oscillators in their ground state .",
    "the decoherence operators are given by @xmath228 with @xmath229 & =      [ c(z,\\omega ) , c^\\dagger ( z',\\omega ' ) ]   \\nonumber \\\\ & = v(z - z ' ) \\delta(\\omega-\\omega').\\end{aligned}\\ ] ] the operators @xmath230 fulfill the commutation relations ( [ noisecom ] ) . using the baker - campbell - hausdorff equation to separate the annihilation part @xmath231 and the creation part @xmath232 in the exponent eq .",
    "( [ eq : meanr1 ] ) can be proven . with",
    "the same method a straightforward but tedious calculation yields @xmath233    00 h.  schmidt and a.  imamolu , `` giant kerr nonlinearities obtained by electromagnetically induced transparency '' , opt .",
    "* 21 * , 1936 - 1938 ( 1996 ) .",
    "s.  e.  harris , `` electromagnetically induced transparency '' , phys .  today *",
    "52*(6 ) , 36 - 42 ( 1997 ) .",
    "boller , a.  imamolu and s.  e.  harris ,  observation of electromagnetically induced transparency  , * 66 * , 2593 - 2596 ( 1991 ) . m.  d.  lukin , m.  fleischhauer , a.  s.  zibrov , h.  g.  robinson , v.  l.  velichansky , l.  hollberg , and m.  o.  scully , `` spectroscopy in dense coherent media : line narrowing and interference effects '' , * 79 * , 2959 - 2962 ( 1997 ) .",
    "s.  e.  harris and l.  v.  hau , `` nonlinear optics at low light levels '' , * 82 * , 4611 - 4614 ( 1999 ) . l.  v.  hau , s.  e.  harris , z.  dutton , and c.  h.  behroozi , `` light speed reduction to 17 metres per second in an ultracold atomic gas '' , nature ( lond . ) * 397 * , 594 - 598 ( 1999 ) .",
    "m.  bajcsy , a.  s.  zibrov and m.  d.  lukin , `` stationary pulses of light in an atomic medium '' , nature * 426 * , 638 - 641 ( 2003 ) .",
    "h.  kang and y.  zhu , `` observation of large kerr nonlinearity at low light intensities '' , * 91 * , 093601 ( 2003 ) .",
    "m.  d.  lukin and a.  imamolu , `` nonlinear optics and quantum entanglement of ultraslow single photons '' , * 84 * , 1419 - 1422 ( 2000 ) .",
    "d.  petrosyan and g.  kurizki , `` symmetric photon - photon coupling by atoms with zeeman - split sublevels '' , * 65 * , 033833 ( 2002 ) .",
    "a.  b.  matsko , i.  novikova , g.  r.  welch , and m.  s.  zubairy , `` enhancement of kerr nonlinearity by multiphoton coherence '' , opt .",
    "* 28 * , 96 - 98 , ( 2003 ) . c.  ottaviani , d.  vitali and p.  tombesi , `` polarization qubit phase gate in driven atomic media '' , * 90 * , 197902 ( 2003 ) .",
    "d.  petrosyan and y.  p.  malakyan , `` magneto - optical rotation and cross - phase modulation via coherently driven four - level atoms in a tripod configuration '' , * 70 * , 023822 ( 2004 ) .",
    "s.  rebi , d.  vitali , c.  ottaviani , p.  tombesi , m.  artoni , f.  cataliotti , and r.  corbalan , `` polarization phase gate with a tripod atomic system '' , phys .",
    "a * 70 * , 032317 ( 2004 ) .",
    "wang , k .-",
    "marzlin , and b.  c.  sanders , `` large cross - phase modulation between slow copropagating weak pulses in @xmath234rb '' , * 97 * , 063901 ( 2006 ) . i.  l.  chuang and y.  yamamoto , `` simple quantum computer '' , * 52 * , 3489 - 3496 ( 1995 ) .",
    "k.  nemoto and w.  j.  munro , `` nearly deterministic linear optical controlled - not gate '' , * 98 * , 250502 ( 2005 ) .",
    "w.  j.  munro , k.  nemoto , and t.  p.  spiller , `` weak nonlinearities : a new route to optical quantum computation '' , new j.  phys .",
    "* 7 * , 137 ( 2005 ) .",
    "k.  sanaka , t.  jennewein , j .- w .  pan , k.  resch , and a.  zeilinger , `` experimental nonlinear sign shift for linear optics quantum computation '' , * 92 * , 017902 ( 2004 ) .",
    "e.  knill , r.  laflamme , and g.  j.  milburn , `` a scheme for efficient quantum computation with linear optics '' , nature * 409 * , 46 - 52 ( 2001 ) .",
    "j.  h.  shapiro , `` single - photon kerr nonlinearities do not help quantum computation '' , phys .",
    "a * 73 * , 062305 ( 2006 ) .",
    "j.  h.  shapiro and r.  s.  bondurant , `` qubit degradation due to cross - phase - modulation photon - number measurement '' , phys .",
    "a * 73 * , 022301 ( 2006 ) .",
    "j.  h.  shapiro , and m.  razavi , `` continuous - time cross - phase modulation and quantum computation '' , new j.  phys .  * 9 * , 16 ( 2007 ) .",
    "k.  koshino , `` transitional behavior between self - kerr and cross - kerr effects by two photons '' , phys .",
    "a * 75 * , 063807 ( 2007 ) .",
    "p.  leung , t.  ralph , w.  j.  munro , and k.  nemoto , `` spectral effects of fast response cross kerr non - linearity on quantum gate '' , arxiv.org:0810.2828 ( 2008 ) .",
    "m.  j.  renn , d.  montgomery , o.  vdovin , d.  z.  anderson , c.  e.  wieman , and e.  a.  cornell , `` laser - guided atoms in hollow - core optical fibers '' , phys .",
    "* 75 * , 3253 - 3256 ( 1995 ) .",
    "g.  m.  gehring , r.  w.  boyd , a.  l.  gaeta , d.  j.  gauthier , and a.  e.  willner , `` fiber - based slow - light technologies '' , j.  lightwave technol .",
    "* 26 * , 3752 - 3762 ( 2008 ) .",
    "m.  bajcsy , s.  hofferberth , v.  balic , t.  peyronel , m.  hafezi , a.  s.  zibrov , v.  vuletic and m.  d.  lukin , `` efficient all - optical switching using slow light within a hollow fiber '' , phys .  rev .",
    "lett .  * 102 * , 203902 ( 2009 ) .",
    "p.  londero , v.  venkataraman , a.  r.  bhagwat , a.  d.  slepkov , and a.  l.  gaeta , `` ultralow - power four - wave mixing with rb in a hollow - core photonic band - gap fiber '' , phys .",
    "103 * , 043602 ( 2009 ) .",
    "d.  e.  chang , a.  s.  srensen , p.  r.  hemmer and m.  d.  lukin , `` strong coupling of single emitters to surface plasmons '' , phys .",
    "b * 76 * , 035420 ( 2007 ) .",
    "j.  e.  rothenberg , `` complete all - optical switching of visible picosecond pulses in birefringent fiber '' , opt .",
    "lett .  * 18 * , 796 - 798,(1993 ) .",
    "g.  p.  agrawal , _ nonlinear fiber optics _ , 4th edition , academic press , burlington ( u.s.a . ) 2007 .",
    "t .- k .  chiang , n.  kagi , t.  k.  fong , m.  e.  marhic and l.  g.  kazovsky , `` cross - phase modulation in dispersive fibers : theoretical and experimental investigation of the impact of modulation frequency '' , phot .  tech .",
    "ieee * 6 * , 733 - 736 ( 1994 ) .",
    "f.  m.  abbou , c.  c.  hiew , h.  t.  chuah , d.  s.  ong and a.  abid , `` a detailed analysis of cross - phase modulation effects on ook and dpsk optical wdm transmission systems in the presence of gvd , spm , and ase noise '' , j.  russ .",
    "laser res .  *",
    "29 * , 57 - 70 ( 2008 ) .",
    "l.  g.  joneckis and j.  h.  shapiro , `` quantum propagation in a kerr medium : lossless , dispersionless fiber '' , j.  opt .",
    "b * 10 * , 1102 - 1120 ( 1993 ) .",
    "b.  c.  sanders and g.  j.  milburn , `` quantum limits to all - optical switching in the nonlinear mach ",
    "zehnder interferometer '' , j.  opt",
    ".  soc .",
    "b * 9 * , 915 - 924 ( 1992 ) . answering the question whether the case @xmath235 of this phenomenological model describes a real physical system may require an ab - initio quantum description of a medium that supports xpm . this is a formidable task and beyond the aim of our work to propose schemes for qnd measurements of the photon number and to generate a cpg .",
    "b.  c. sanders and g.  j.  milburn , `` complementarity in a quantum nondemolition measurement '' , * 39 * , 694 - 702 ( 1989 ) .",
    "t.  tyc and b.  c.  sanders , `` operational formulation of homodyne detection '' , j.  phys .",
    "a * 37 * , 7341 - 7357 ( 2004 ) .",
    "s. rebi , c. ottaviani , g. di giuseppe , d. vitali and p. tombesi , `` assessment of a quantum phase - gate operation based on nonlinear optics '' , phys .",
    "a * 74 * , 032301 ( 2006 ) . strictly speaking",
    ", @xmath10 denotes the initial distance between the pulses _ inside _ the medium .",
    "usually the state in which the phase shift is acquired is taken to be @xmath236 , but we consider @xmath100 to simplify the discussion . both gates are related by a single - qubit not operation that acts on the second qubit .",
    "w.  k.  wootters , `` entanglement of formation of an arbitrary state of two qubits '' , phys .",
    "lett .  * 80 * , 2245 - 2248 ( 1998 ) .",
    "g.  lindblad , `` on the generators of quantum dynamical semigroups '' , comm .",
    "phys .  * 48 * , 119 - 130 ( 1976 ) .",
    "j.  d.  jackson , _ classical electrodynamics _ ,",
    "3rd edition , wiley , new york ( 1999 ) .",
    "l.  boivin , f.  x.  krtner and h.  a.  haus , `` analytical solution to the quantum field theory of self - phase modulation with a finite response time '' , phys .",
    "lett .  * 73 * , 240 - 243 ( 1994 ) .",
    "for instance , for giant nonlinearities based on eit we would have @xmath154 because the light pulses would have a duration in the order of @xmath237s ."
  ],
  "abstract_text": [
    "<S> we propose a scheme to achieve a uniform cross phase modulation ( xpm ) for two nonclassical light pulses and study its application for quantum non - demolition measurements of the photon number in a pulse and for controlled phase gates in quantum information . </S>",
    "<S> we analyze the scheme by quantizing a common phenomenological model for classical xpm . </S>",
    "<S> our analysis first treats the ideal case of equal cross - phase modulation and pure unitary dynamics . </S>",
    "<S> this establishes the groundwork for more complicated studies of non - unitary dynamics and difference in phase shifts between the two pulses where decohering effects severely affect the performance of the scheme . </S>"
  ]
}