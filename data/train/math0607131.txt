{
  "article_text": [
    "[ sec:1 ] random graphs have been used to analyze percolation in some infinite systems ( e.g. , @xcite and references therein ) . on the other hand ,",
    "hierarchical structures have been used in applications in physics , biology ( in particular , genetics ) , etc . , where an underlying ultrametric distance plays a basic role ( e.g. , @xcite and references therein ) .",
    "hence it is natural to consider infinite random graphs embedded in hierarchical structures , with the probability of connection between two vertices depending on an ultrametric distance between them . in this paper we study percolation in an infinite random graph , @xmath1 , embedded in an ultrametric group , @xmath4 , called hierarchical group of order @xmath2 , as @xmath5 .",
    "the structure of @xmath1 is a cascade of ( approximate ) erd@xmath6s - rnyi random subgraphs at consecutive hierarchical distances , and this allows using results from the classical theory of random graphs @xcite .",
    "however , we use them only as a technical tool . as we shall see , for @xmath1 there are different results from the classical ones . an essential feature of @xmath1 is that , due to the tree - type form of @xmath4 , any path connecting two vertices must contain an edge ( or 1-step connection ) of size equal to the hierarchical distance between them . in order to prove that percolation occurs along giant components in the cascade at consecutive distances , we introduce a family of random graphs whose vertices have an internal structure involving giant components at the previous hierarchical levels . in these `` doubly stochastic '' random graphs",
    "the connection probabilities between vertices are random variables which are highly dependent , but asymptotically deterministic as @xmath7 .",
    "there are papers that consider random graphs with connection probabilities depending on a distance between vertices or some function of pairs of vertices ( e.g. , @xcite ) , and/or involving hierarchical structures or ultrametrics ( e.g. , @xcite ) , but we have not seen the setup we consider here .",
    "[ d1.1 ] the _ hierarchical group of order @xmath2 _ ( integer @xmath8 ) is defined as @xmath9 with addition componentwise mod @xmath2 , i.e. , @xmath4 is the direct sum of a countable number of copies of the cyclic group of order @xmath2 .",
    "the _ hierarchical distance _ on @xmath4 is given by @xmath10    note that @xmath11 is translation - invariant , and it is an ultrametric , i.e. , it satisfies the strong ( or non - archimedean ) triangle inequality : for any @xmath12 , @xmath13 and for each integer @xmath14 , a _ @xmath15-ball _ in @xmath4 ( i.e. , a set of points at distance at most @xmath15 from each other ) contains @xmath16 points , and it is the union of @xmath2 @xmath17-balls which are at distance @xmath15 from each other ( a @xmath18-ball is a single point ) .",
    "the group @xmath4 has been used as a state space for stochastic models in several applications ( e.g. , @xcite and references therein ) .",
    "we are interested in studying percolation properties on @xmath4 , and to this end we consider a random graph @xmath19 whose vertex set is @xmath4 , with connection probabilities depending on the hierarchical distance between points .",
    "we parameterize the connection probabilities so as to characterize the critical regime for percolation .",
    "the random graph @xmath1 is defined as follows .",
    "[ d1.2 ]    we define an infinite random graph @xmath19 with the points of @xmath4 as vertices , and for each @xmath20 the probability of connection between @xmath21 and @xmath22 such that @xmath23 is given by @xmath24 where @xmath25 is a positive constant ( independent of @xmath2 ) , all connections being independent",
    ".    in this paper we do not investigate percolation for fixed @xmath2 , we obtain a result for large @xmath2 , i.e. , asymptotic percolation as @xmath0 , by means of the theory of random graphs .",
    "this method is natural for the framework of the hierarchy of random graphs which constitutes @xmath1 .",
    "recall that in the classical theory of erd@xmath3s - rnyi ( _ er _ ) random graphs @xmath26 with @xmath2 vertices and connection probability @xmath27 , the right parameterization for existence of giant components as @xmath7 is @xmath28 , @xmath29 .",
    "analogously , the choice of connection probabilities ( [ eq:1.4 ] ) will allow us to characterize percolation in @xmath1 as @xmath30 in terms of the sequence @xmath31 with all @xmath32 .",
    "one of our main tools is the _ er _ theory , which we will apply recursively along consecutive hierarchical distances . since a @xmath15-ball has @xmath16 points , the _ er _ theory would require connection probabilities @xmath33",
    "the fact that percolation in @xmath1 can occur with connection probabilities of the form ( [ eq:1.4 ] ) is due to the internal hierarchical structure of @xmath15-balls .",
    "we shall see in section 3.2 that the average length of shortest paths between randomly chosen points in the giant component of a @xmath15-ball is of order @xmath34 , which should be compared with @xmath35 in the classical case .    to begin , we observe why the theory of _ er _ random graphs can be used to investigate @xmath1 . by ( [ eq:1.4 ] ) ,",
    "two different @xmath17-balls in a given @xmath15-ball are connected within the @xmath15-ball with probability @xmath36 hence @xmath37 as @xmath7 .",
    "more precisely , using the elementary inequality @xmath38 < \\biggl(\\frac{m}{n}\\biggr)^2\\frac{y^2}{2},\\quad 0<y < n , \\quad m\\geq 2,\\ ] ] with @xmath39 , @xmath40 , @xmath41 , we have from ( [ eq:1.5 ] ) @xmath42 two @xmath17-balls in a @xmath15-ball can also be connected through points outside the @xmath15-ball .",
    "however , as we shall see , this does not add more than @xmath43 to the probability of connection between the @xmath17-balls . on the other hand ,",
    "we are interested in what happens inside the @xmath15-ball . therefore we will disregard connections through points outside the @xmath15-ball . by ( [ eq:1.7 ] ) , for any @xmath14",
    ", a @xmath15-ball with its @xmath44-balls as vertices is a random graph @xmath45 which approximates the _ er _ random graph @xmath46 as @xmath5 .",
    "note that ( [ eq:1.4 ] ) is equal to @xmath47 with a norming which is the product of the sizes of two @xmath17-balls .",
    "( see remark 2.4 ) .",
    "the tree representation of @xmath4 ( see figure 1 ) shows @xmath1 as a cascade of random subgraphs @xmath48 , where the form ( 1.4 ) of the connection probabilities is inherited throughout the hierarchy .",
    "note that the hierarchical distances @xmath15 are the same for all @xmath2 .    ]",
    "we consider asymptotic percolation in @xmath1 , meaning that , as @xmath7 , there exists a path going from @xmath49 to infinity , i.e. , to points at arbitrarily large hierarchical distances , with positive probability .",
    "this is made precise in the following definition .",
    "[ d1.3]we say that there is _ asymptotic percolation _ in @xmath19 if @xmath50\\nonumber\\\\&&>0.\\end{aligned}\\ ] ]    in theorem [ t2.1 ] we give a criterion for asymptotic percolation in @xmath1 , and we show that percolation occurs along giant components of giant components at the previous level in the cascade of subgraphs @xmath45 for all hierarchical distances @xmath15 .",
    "this involves replacing the connection probabilities @xmath51 , given by ( [ eq:1.5 ] ) , by random connection probabilities between giant components , which generates a hierarchy of doubly stochastic random graphs .",
    "although we use the basic results on the sizes of components in @xmath52 random graphs , most of the work in the proof of the theorem consists in formulating the problem in such a way that those results can be employed to obtain upper and lower bounds for the probability of percolation .",
    "another part of the proof consists in showing that percolation occurs along the cascade of giant components at consecutive hierarchical levels .",
    "we will also discuss the possible form of percolation paths , and comment on approximate scale - free degree sequences in the graphs @xmath46 for large @xmath15 .",
    "in a final section we make some heuristic comments regarding doubly stochastic random graphs of the type used for the proof of theorem [ t2.1 ] and their application , in particular referring to average distance and central limit theorem for the cascade of giant components .",
    "these random graphs give rise to questions that suggest further research which would be of independent interest .",
    "we will use the following fundamental result on _ er _ random graphs @xmath53 ( see , e.g. , @xcite , theorem 5.4 ; recall that `` a.a.s . '' for a graph property means that the probability that the random graph possesses the property tends to @xmath54 as @xmath7 @xcite ) :    \\(a ) if @xmath29 , then a.a.s .",
    "@xmath55 has a unique giant component , its size is @xmath56 , where @xmath57 satisfies @xmath58 , and all the other components have sizes at most @xmath59 .    for each @xmath20 and each @xmath15-ball , we have a random graph @xmath60 whose vertices are the @xmath61-balls contained in the @xmath15-ball , with connection probability @xmath51 given by ( [ eq:1.5 ] ) .",
    "we assume that @xmath62 for all @xmath15 , hence , because of ( [ eq:1.7 ] ) and ( a ) , each @xmath60 has a unique giant component a.a.s .. we may assume that @xmath2 is large enough so that the giant components have emerged in all @xmath15-balls for all @xmath15 .",
    "note that , by ( [ eq:1.6 ] ) , @xmath63 , where @xmath64 for @xmath65 , therefore unique giant components emerge in @xmath60 for all @xmath15 as @xmath7 .",
    "since percolation involves @xmath66 as @xmath67 , our method is restricted to the limiting situation @xmath5 .    if @xmath68 is a non - empty set of vertices of @xmath69 , we denote by @xmath70 the number of its elements ( hence @xmath71 ) , and by @xmath72 the number of points of @xmath4 contained in @xmath68 , thus @xmath73 .",
    "it is reasonable to consider percolation with connections along giant components in the subgraphs @xmath45 at consecutive hierarchical distances @xmath15 .",
    "indeed , it may happen that @xmath74 is in the giant component of the @xmath54-ball it belongs to , and that this @xmath54-ball is in the giant component of the @xmath75-ball it belongs to , but it may also happen that @xmath74 is not in the giant component of the @xmath54-ball it belongs to , but that it is connected to the giant component of the @xmath75-ball , which may still be good for percolation .",
    "however , by ( a ) , the second possibility is negligible with respect to the first one as @xmath7 .",
    "the same argument can be made for the vertices of the subgraphs @xmath45 and any two consecutive values of @xmath15 .",
    "in addition , if @xmath76 denotes the number of 1-step connections from a point to points at distance @xmath15 from it , we shall see that @xmath77\\sim c_k n^{-(k-1)}$ ] as @xmath5 for each @xmath20 , so , the probability of connections at distance @xmath15 is negligible w.r.t",
    ". the probability of connections at distance @xmath78 , and all external connections from a @xmath15-ball will be at distance @xmath79 from it for all @xmath15 as @xmath5 .",
    "therefore we will look at asymptotic percolation along giant components at consecutive distances @xmath15 .",
    "moreover , we will consider asymptotic percolation along the cascade of giant components of giant components at the previous level for all hierarchical distances @xmath15 .",
    "this precisely means that @xmath74 is in the giant component of the 1-ball it belongs to ; this giant component is connected to other giant components of @xmath54-balls in the @xmath75-ball in they belong to , forming a level @xmath75 giant component ; and so on for every hierarchical distance @xmath15 . for brevity ,",
    "we call _ cascade percolation _ this special form of percolation .    in order to study cascade percolation ,",
    "for each @xmath14 and large @xmath2 we consider a random graph @xmath80 whose vertices are the @xmath17-balls that are the vertices of @xmath81 , but now each vertex has an internal structure which involves all the components in the @xmath82-balls , @xmath83 , in the @xmath17-ball .",
    "clearly , the giant components are the ones that will determine percolation .",
    "these random graphs are described in the proof of theorem 2.2 , and their composition is reformulated after the proof in terms of giant components alone .    for each @xmath20 ,",
    "let @xmath84 satisfy @xmath85 where @xmath86 .",
    "we will show that the probability of asymptotic percolation @xmath87 is given by @xmath88 .",
    "hence we need a condition for positivity of this product in terms of the @xmath25 , which are the data of the graph @xmath1 .",
    "this is given in the following lemma ( proved in the appendix ) .",
    "[ l2.1 ] assume @xmath89 as @xmath90 , @xmath91 and @xmath92 . then @xmath93    and @xmath94    the main result in this paper is the following theorem .",
    "[ t2.1 ] assume @xmath89 as @xmath95 , @xmath91 , @xmath92 .",
    "then there is asymptotic percolation in @xmath1 if and only if @xmath96 , asymptotic percolation occurs in the form of cascade percolation , and the probability of percolation ( [ eq:1.8 ] ) is given by    @xmath97    * proof .",
    "* let us assume that percolation takes places only with connections along consecutive pairs of hierarchical distances @xmath15 . in the last part of the proof we will show that this is so .",
    "we prove first that @xmath98 implies there is no percolation in @xmath1 along consecutive hierarchical distances . by the left - hand inequality in ( [ eq:1.6 ] ) , the connection probability @xmath51 given by ( [ eq:1.5 ] ) satisfies @xmath99 hence it suffices to show that there is no percolation along the random graphs @xmath100 at distance @xmath15 for every @xmath15 in the weaker sense that @xmath74 is in the giant component of the @xmath54-ball it belongs to , this @xmath54-ball is in the giant component of the @xmath75-ball it belongs to , and so on .",
    "the probability of percolation along the graphs @xmath101 is given by @xmath102 ( connections at different distances are independent ) , where , by ( a ) , @xmath103 satisfies @xmath104 for each @xmath20 .",
    "now , @xmath98 implies @xmath105 , since all @xmath106 , which by ( [ eq:2.6 ] ) implies @xmath107 , and therefore @xmath108 . hence there is no percolation .",
    "so , percolation along consecutive hierarchical distances implies @xmath109 .",
    "note that if for some @xmath15 the vertex ( @xmath17-ball ) in @xmath110 containing @xmath74 is not in the giant component of the @xmath15-ball , then by ( a ) the corresponding @xmath111 in @xmath112 is @xmath18 .",
    "more precisely , if the @xmath17-ball containing @xmath74 is not in the giant component in the @xmath15-ball , then , by ( a ) , @xmath74 is connected to at most @xmath113 points within the @xmath15-ball . but the probability of connection between a set of @xmath114 points in the @xmath15-ball and points in the @xmath115-ball outside the @xmath15-ball is , by ( [ eq:1.4 ] ) , @xmath116 therefore there is no percolation .",
    "this observation allows us to omit non - giant components in the proofs .",
    "now we assume @xmath109 , hence @xmath117 by lemma [ l2.1 ] .",
    "we denote by @xmath118 the probability of cascade percolation .",
    "we will show that @xmath119 this obviously implies that there is asymptotic percolation in @xmath1 .",
    "we prove first that @xmath120 we proceed by steps .    for @xmath121 , a given @xmath75-ball and large @xmath2 , the graph @xmath122 has @xmath2 vertices , which are the @xmath54-balls in the @xmath75-ball , and the internal structure of a @xmath54-ball is the family of its components .",
    "although only the giant component @xmath123 will be relevant for percolation , the other ones complete the size of the @xmath54-ball , and this plays a role in the proof . by ( [ eq:1.4 ] ) ,",
    "two giant components @xmath124 ( which are at distance @xmath75 from each other ) are connected with conditional probability ( given the sizes @xmath125 , @xmath126 ) @xmath127 we write @xmath128 as @xmath129 where @xmath130    by ( [ eq:1.6 ] ) , @xmath131 and @xmath132 since @xmath133 .",
    "hence @xmath134    we take @xmath135 and delete from @xmath136 the vertices ( @xmath54-balls ) with giant components @xmath137 such that @xmath138 ) with @xmath139 , except the one that contains @xmath74 if it happens to be in this case . for a pair @xmath140 of giant components that do not satisfy ( [ eq:2.13n ] ) we have , by ( [ eq:2.11n ] ) and ( [ eq:2.13n ] ) , @xmath141 then , from ( [ eq:2.9n ] ) , ( [ eq:2.12n ] ) and ( [ eq:2.14n ] ) , for the remaining giant components we have @xmath142    since @xmath143 , by lemma 2.1 , for any @xmath144 such that @xmath145 we can take @xmath146 small enough and @xmath147 large enough so that , from ( [ eq:2.15n ] ) , @xmath148 for all @xmath149 , for all pairs @xmath140 of giant components which do not satisfy ( [ eq:2.13n ] ) .    let @xmath150 denote the number of @xmath54-balls of @xmath122 whose giant components satisfy ( [ eq:2.13n ] ) .",
    "@xmath150 is distributed bin@xmath151)$ ] ( the @xmath125 are i.i.d . ) .",
    "hence , for any @xmath152 , @xmath153 & \\leq & \\frac{1}{n\\eta } em^{n,2}= \\frac{1}{\\eta}p[|g^{(1)}|\\leq \\beta_1(1-\\delta_2)n]\\\\ & & \\rightarrow 0\\quad \\hbox{\\rm as}\\quad n\\rightarrow \\infty,\\end{aligned}\\ ] ] by ( [ eq:2.2 ] ) for @xmath139 and ( a ) for the _ er _ graph @xmath154 ( see also @xcite , p.167 ) .",
    "so , @xmath155 as @xmath7 ( @xmath156 in the notation of @xcite , p.11 ) .",
    "therefore , deleting from @xmath122 the @xmath54-balls whose giant components satisfy ( [ eq:2.13n ] ) does not impair the emergence of a giant component in @xmath136 , which actually emerges due to ( [ eq:2.16n ] ) .",
    "the giant component of @xmath136 is a _ level 2 _ giant component , whose elements are @xmath54-balls with their internal structures .    for @xmath157 , a given @xmath158-ball and large @xmath2 , the graph @xmath159 has @xmath2 vertices , which are the @xmath75-balls in the @xmath158-ball , and the internal structure of a @xmath75-ball is the family of its components , in particular the giant component of the corresponding graph @xmath136 , as described above .",
    "having deleted from each @xmath75-ball an @xmath160 number of @xmath54-balls as above , we are left only with @xmath54-balls whose connection probabilities between their giant components @xmath128 satisfy ( [ eq:2.16n ] ) ( and the @xmath54-ball containing @xmath161 ) .",
    "we now connect these @xmath54-balls with the smaller probability @xmath162 ( recall that we are looking for a lower bound for @xmath163 ) , and we consider the resulting level 2 giant components @xmath164 .    by ( [ eq:1.4 ] ) ,",
    "two giant components @xmath165 ( which are at distance @xmath158 from each other ) are connected with probability @xmath166 where @xmath167 ( each @xmath54-ball in @xmath164 contains @xmath2 points ) , and , by ( a ) , @xmath168 satisfies @xmath169    now we are in a similar situation as in the previous step @xmath170 , with @xmath54-balls playing the role of points and @xmath171 playing the role of @xmath172 . the fact that @xmath160 @xmath54-balls have been deleted from each @xmath75-ball has no effect , and in any case it helps towards a lower bound .",
    "so , proceeding as above with ( [ eq:2.17 ] ) , ( [ eq:2.18 ] ) , ( [ eq:2.19 ] ) , we take @xmath173 and delete from @xmath174 the @xmath75-balls with giant components @xmath164 such that latexmath:[\\[\\label{eq:2.17n}%(2.20 )    the one containing @xmath74 ) .",
    "choosing @xmath176 small enough and @xmath177 large enough ( and larger than @xmath147 ) , we have that the connection probabilities @xmath178 for the remaining giant components satisfy @xmath179 with small enough @xmath180 , for all @xmath181 .",
    "note that since @xmath182 as @xmath183 , then , form ( [ eq:2.19 ] ) , @xmath184 as @xmath185 , where @xmath186 satisfies ( [ eq:2.2 ] ) with @xmath121 , and since @xmath187 by lemma 2.1 , then @xmath188 and @xmath180 can be taken small enough so that @xmath189 .    since @xmath190 ( see ( [ eq:2.6 ] ) ) , we have as above that the number of deleted @xmath75-balls from @xmath174 is @xmath160 as @xmath30 , and we connect the remaining ones with the smaller probability @xmath191 .",
    "iterating this scheme , for each @xmath15 , each given @xmath15-ball and large @xmath2 , we have a graph @xmath80 whose @xmath2 vertices are the @xmath17-balls in the @xmath15-ball with their internal structures , which involve the level ( @xmath78 ) giant components in the corresponding graphs @xmath192 .",
    "a number @xmath160 of vertices of @xmath80 are deleted , as above , the remaining ones are connected with the smaller probability @xmath193 , where @xmath194 and @xmath195 satisfies @xmath196    clearly , because of the deletions we have made and the use of smaller connection probabilities , we have @xmath197 ( connections at different distances are independent ) .",
    "letting @xmath198 ( in this order ) , we have from ( [ eq:2.20n ] ) and ( [ eq:2.21n ] ) : @xmath199 , hence @xmath184 , where @xmath186 satisfies ( [ eq:2.2 ] ) for @xmath121 , hence @xmath200 , hence @xmath201 , where @xmath202 satisfies ( [ eq:2.2 ] ) for @xmath157 , and so on . therefore , we obtain ( [ eq:2.7n ] ) from ( [ eq:2.22n ] ) .",
    "note that the cascade of giant components containing @xmath74 will always remain , and in any case it would not be deleted according to ( [ eq:2.13n ] ) , ( [ eq:2.17n ] ) , etc . , a.a.s ..    we now prove that @xmath203 the approach is analogous to the one used for proving ( [ eq:2.7n ] ) , but now we replace the random connection probabilities between giant components by upper bounds . since non - giant components in @xmath15-balls have no effect on percolation , we consider only the connections between giant components .    for @xmath121 , from ( [ eq:2.9n ] ) , ( [ eq:2.11n ] ) , ( [ eq:2.12n ] ) , and ( a ) for the _ er _ graph @xmath204 we have @xmath205 for any @xmath206 .",
    "now we connect the @xmath54-balls in a @xmath75-ball with probability @xmath207 , and we consider the resulting level @xmath75 giant components @xmath164 in @xmath75-balls ( we keep the notation @xmath164 used before , but now the connection probabilities are different ) .    for @xmath157 , two giant components @xmath208 , @xmath209 , in a @xmath158-ball are connected , by ( [ eq:1.4 ] ) , as above , with probability @xmath210 where @xmath167 , and , by ( a ) , @xmath211 satisfies @xmath212 with @xmath213 proceeding the same way as above , it follows from ( [ eq:2.26])-([eq:2.29 ] ) that @xmath214 for any @xmath215 .",
    "iteration of this scheme leads to @xmath216 and @xmath217 as @xmath218 , where @xmath219 satisfies ( [ eq:2.2 ] ) .",
    "we then obtain ( [ eq:2.25 ] ) from ( [ eq:2.30 ] ) .",
    "since @xmath163 refers to a special form of percolation , we have @xmath220 . in order to see that cascade percolation is equivalent to asymptotic percolation , and therefore @xmath221 , which proves ( [ eq:2.5 ] ) by ( [ eq:2.7 ] ) ,",
    "it remains only to show that , as we assumed at the beginning of the proof , for each @xmath15 all @xmath54-step connections from a @xmath15-ball are in the @xmath115-ball it belongs to a.a.s .. this is done later on in lemma 2.5 .",
    "@xmath222    in the proof of theorem 2.2 the random graph @xmath80 has @xmath2 vertices which are the @xmath17-balls in a @xmath15-ball , and each @xmath17-ball has an internal structure which contains the giant and the other components in it .",
    "we replaced the connection probabilities between @xmath17-balls by the random connection probabilities between their giant components because they determine percolation , and then we replaced these random connection probabilities by upper and lower ( deterministic ) connection probabilities in order to obtain upper and lower bounds for @xmath118 .",
    "the non - giant components have no part in percolation , but still each @xmath17-ball contained all its @xmath223-balls ( with their internal structures ) , and this was relevant in the proof of the theorem ( see remark 2.4 ) .",
    "the random graphs @xmath80 can be redefined so that their vertices contain only giant components at previous levels , with random connection probabilities between the vertices . in this sense",
    "the graphs @xmath80 are `` doubly stochastic '' .",
    "this way the _ cascade of giant components in a @xmath15-ball _ is more clearly depicted : all the points of @xmath4 in a vertex of @xmath80 are connected , and for each @xmath224 , the giant component at level @xmath82 consists of connected giant components at level @xmath225 .",
    "we denote by @xmath226 the size of the cascade of giant components in a @xmath15-ball ( i.e. , the number of points of @xmath4 in the cascade ) .",
    "the growth of @xmath226 is given in the following corollary .",
    ".25 cm * corollary 2.3 * _ @xmath227 where the @xmath228 satisfy ( [ eq:2.2 ] ) . _",
    ".15 cm * proof . * for @xmath139 and a giant component @xmath123 of a @xmath54-ball",
    ", we have latexmath:[\\[\\label{eq:2.32 ' }     for @xmath121 and a level 2 giant component @xmath230 ( with the true connection probabilities , not upper and lower bounds as before ) in a @xmath75-ball , we have similarly , by ( a ) , on the one hand , @xmath231 satisfies ( [ eq:2.19 ] ) , and on the other hand , @xmath232 satisfies ( [ eq:2.28 ] ) .",
    "since @xmath188 and @xmath146 are both arbitrarily small , we have from ( [ eq:2.33 ] ) and ( [ eq:2.34 ] ) , latexmath:[\\[\\label{eq:2.35 ' }     now , each vertex of @xmath230 contains @xmath234 points a.a.s .",
    "( not all @xmath2 points , as in the proof of theorem 2.2 ) , therefore , from ( [ eq:2.35 ] ) , @xmath235    by induction we obtain ( [ eq:2.31 ] ) .",
    "@xmath222 .5 cm * remark 2.4 * we could consider the random graphs @xmath80 with giant components alone in the proof of theorem 2.2 , but then , instead of ( [ eq:1.4 ] ) , which is @xmath236 , by corollary 2.3 we would use connection probabilities @xmath237 between points @xmath21 and @xmath22 such that @xmath238 , in order to restrict the internal structures to the cascades of giant component in the @xmath17-balls containing the points . the approach we have taken is more natural .    to complete the proof of theorem 2.2 it remains to prove the following lemma .",
    ".5 cm * lemma 2.5 * _ for each @xmath239 , all external 1-step connections from a given @xmath15-ball are at distance @xmath79 from it a.a.s .",
    "_    the proof of lemma 2.5 is a special case of the following calculations , which are intended to give some idea of what percolation paths might look like as @xmath0 .",
    "let @xmath76 denote the number of @xmath54-step connections from @xmath240 to points at hierarchical distance @xmath20 ( or from any given point of @xmath4 to points at distance @xmath15 from it ; recall that @xmath11 is translation - invariant ) . since @xmath76 is distributed bin@xmath241 , then    @xmath242    and @xmath243    in the case @xmath14 , @xmath244\\sim \\frac{c_k } { n^{k-1 } } \\quad { \\rm as}\\quad n\\rightarrow \\infty,\\ ] ] and @xmath245\\rightarrow \\left\\{\\begin{array}{llc } 1 , & n=1 \\\\ 0 , & n>1 \\end{array}\\right.{\\rm as}\\quad n\\to \\infty.\\ ] ] indeed , using @xmath246 as @xmath247 , @xmath248 & = & 1-\\biggl(1-\\frac{c_k}{n^{2k-1}}\\biggr)^{n^k - n^{k-1}}\\\\ & \\sim & -(n^k -n^{k-1})\\log \\biggl(1-\\frac{c_k}{n^{2k-1}}\\biggr),\\end{aligned}\\ ] ] and now using @xmath249log@xmath250 as @xmath251 , @xmath252 , @xmath253 & \\sim & -(n^{2k-1}-n^{2k-2})\\log \\biggl(1-\\frac{c_k}{n^{2k-1}}\\biggr)\\\\ & \\sim & c_k,\\end{aligned}\\ ] ] which proves ( [ eq:2.23n ] ) . for the proof of ( [ eq:2.24n ] ) we have @xmath254 = \\frac{p[y^{(k)}=n]}{p[y^{(k)}>0]},\\ ] ] and @xmath255&= & \\biggl({n^k - n^{k-1}\\atop n}\\biggr ) \\biggl(\\frac{c_k}{n^{2k-1}}\\biggr)^n \\biggl(1-\\frac{c_k}{n^{2k-1}}\\biggr)^{n^k - n^{k-1}-n}\\\\ & \\sim & \\frac{(n^k - n^{k-1})!}{n!(n^k - n^{k-1}-n)!}\\biggl(\\frac{c_k}{n^{2k-1}}\\biggr)^n,\\end{aligned}\\ ] ] hence , by ( [ eq:2.23n ] ) ,    @xmath256}{p[y^{(k)}>0]}&\\sim & \\frac{(n^k - n^{k-1})!}{n!(n^k - n^{k-1}-n)!}\\frac{n^{k-1}}{c_k } \\biggl(\\frac{c_k}{n^{2k-1}}\\biggr)^n\\\\ & \\rightarrow & \\left\\ { \\begin{array}{cc } 1 , & n=1\\\\ 0 , & n>1 \\end{array}\\right . { \\rm as}\\quad n\\rightarrow \\infty.\\end{aligned}\\ ] ]",
    "the results ( [ eq:2.36])-([eq:2.24n ] ) show that a.a.s .",
    "almost all 1-step connections from @xmath74 will be at distance 1 and the degree of @xmath74 , and of any point , will be distributed @xmath257 .",
    "also , for each @xmath14 the probability of 1-step connections from @xmath74 to points at distance @xmath15 is negligible w.r.t .",
    "the probability of connections to points at distance @xmath78 , and given that it has connections at distance @xmath15 , there is only one such connection , as @xmath5 . in a similar way it can be shown that the number of points in the giant component of any @xmath54-ball which have external @xmath54-step connections at distance @xmath75 from it is asymptotically pois@xmath258 as @xmath5 .    similarly , let @xmath259 denote the number of 1-step connections from a given @xmath15-ball to @xmath15-balls at distance @xmath260 from it .",
    "@xmath259 is distributed bin@xmath261 , where @xmath262 is the probability of 1-step connections between two @xmath15-balls at distance @xmath82 from each other .    in the same way as above",
    "we have @xmath263 and it follows that @xmath264 and for @xmath265 , @xmath266\\sim \\frac{c_j}{n^{j - k-1}}\\quad{\\rm as}\\quad n\\to \\infty,\\ ] ] and @xmath267\\to\\left\\{\\begin{array}{ll } 1,&n=1\\\\ 0,&n>1\\end{array}\\right .",
    "{ \\rm as}\\quad n\\to \\infty.\\ ] ]    analogous results can be obtained , using @xmath268 , for the number of 1-step connections between a giant component in a @xmath15-ball and other such giant components at distance @xmath260 from it , with @xmath269 replaced by @xmath270 in ( [ eq:2.26n ] ) , ( [ eq:2.27n ] ) , ( [ eq:2.29 ] ) .",
    "it can also be shown that the number of points in the cascade of giant components in a @xmath15-ball with external @xmath54-step connections at distance @xmath79 is asymptotically pois@xmath271 as @xmath5 .    from ( [ eq:2.36])-([eq:2.24n ] ) and ( [ eq:2.27n])-([eq:2.30 ] )",
    ", we see that the same pattern described above for connections between individual points is repeated for connections between giant components of giant components at the previous level in @xmath15-balls for all @xmath15 . in particular",
    ", for each @xmath15 all the external 1-step connections from the giant component in a given @xmath15-ball are at distance @xmath79 from it a.a.s .",
    "note that these arguments also prove lemma 2.5 .    with these results",
    "one can also see that connections between @xmath17-balls in a @xmath15-ball through points outside the @xmath15-ball have probability @xmath43 , as stated in the introduction .",
    "these results suggest the following picture for the most likely form of cascade percolation paths : @xmath74 is in the giant component of the 1-ball it belongs to .",
    "a pois@xmath258 number of points in this giant component have external single 1-step connections to points at distance 2 in such a way that the giant component is connected to the giant components of the other 1-balls , forming the level 2 giant component of the 2-ball they belong to .",
    "this level @xmath75 giant component has a pois @xmath272 number of points with external single @xmath54-step connections to other level 2 giant components in the 3-ball they belong to , forming a level 3 giant component .",
    "and so on along the cascade of giant components for every distance @xmath15 . each path starting from @xmath74 and going to infinity this way is a percolation path . .25 cm * example . *",
    "let @xmath273 for large @xmath15 , @xmath252 .",
    "then there is asymptotic percolation if and only if @xmath274 .",
    ".5 cm * remarks 2.6 *    * 1 . *",
    "each of the following is a sufficient condition for percolation : @xmath275    * 2 .",
    "* the degree sequence of @xmath52 random graphs has an approximate poisson distribution .",
    "on the other hand , the random graphs of @xcite have scale - free degree distributions . a rigorous study of scale - free random graphs , including a coupling with @xmath52 random graphs , is contained in @xcite .",
    "we will see that in the graphs @xmath45 the degrees in a neighborhood of @xmath25 have an approximate scale - free behavior with exponent @xmath276 , for large @xmath15 .",
    "recall that in the random graph @xmath277 the vertices are the @xmath278-balls in a @xmath15-ball with @xmath51 given by ( [ eq:1.5 ] ) .",
    "neglecting the term @xmath43 in ( [ eq:1.7 ] ) , we consider @xmath46 .",
    "let @xmath279 denote the number of vertices in @xmath280 of degree @xmath281 .",
    "then the proportion @xmath282 has an approximate poisson distribution @xcite ( theorem 3 ) , i.e. , for each @xmath82 and any @xmath283 , @xmath284\\rightarrow 1 \\;\\;{\\rm as}\\;\\;n\\rightarrow \\infty.\\ ] ]    let @xmath285 for some constant @xmath286 .",
    "recall that @xmath287 as @xmath90 . using the stirling formula ( in the form in @xcite , p.52 ) , and",
    "the standard inequalities @xmath288 it is easy to show that for any @xmath289 , @xmath290 for all @xmath291 and sufficiently large @xmath15 .    combining ( [ eq:2.31 ] ) and ( [ eq:2.32 ] ) we have , for any @xmath283 , @xmath292\\rightarrow 1\\;\\;{\\rm as}\\;\\;n\\rightarrow \\infty\\ ] ] for all @xmath291 and sufficiently large @xmath15 .",
    "the essence of the proof of theorem 2.2 is that the random dependent connection probabilities @xmath293 between giant components of @xmath17-balls in a @xmath15-ball obey @xmath294 in the sense that @xmath295 a.a.s . for each @xmath15 and arbitrary @xmath296 ( such that @xmath297 ) . therefore asymptotic percolation in @xmath1 is as if it took place along the giant components of the _ er _ random graphs @xmath298 instead of @xmath60 , considering only connections between @xmath17-balls .",
    "this suggests the study of `` doubly stochastic '' random graphs of the form @xmath299 with vertices @xmath300 and connection probabilities @xmath301 for the vertices @xmath302 and @xmath303 , where the @xmath301 are random variables which may be dependent , such that @xmath304 , for all @xmath140 a.a.s .. a natural question is which results of the theory of _ er _ random graphs @xmath305 can be extended to this more general class of random graphs .",
    "let @xmath306 denote the ( graph ) distance between two points @xmath249 and @xmath307 ( i.e. the length of the shortest path connecting the two points ) chosen at random in the cascade of giant components in a given @xmath15-ball , @xmath14 .",
    "if the two points are at hierarchical distance @xmath54 from each other ( i.e. , they belong to the giant component of the same @xmath54-ball ) , then @xmath306 grows like @xmath308 as @xmath7 , according to theorem 2.4.1 in @xcite and ( 1.1 ) .",
    "if the hierarchical distance between the two points is larger , say @xmath15 ( i.e. , they are in different @xmath17-balls ; note that this is the most likely outcome of the random choice of points , with probability @xmath309 ) , then the expected result would be that @xmath306 grows like @xmath310 where the @xmath311 satisfy ( [ eq:2.2 ] ) and ( [ eq:2.3 ] ) , provided that theorem 2.4.1 in @xcite could be extended to the random graphs with random connection probabilities @xmath293 obeying ( [ eq:3.1 ] ) .",
    "heuristically , the reasoning is as follows .",
    "starting from a given point in the giant component of a @xmath54-ball , the shortest path to one of the points in the @xmath54-ball that have external connections at distance @xmath75 grows like @xmath308 ( these points are chosen at random in the giant component of the @xmath54-ball and all the shortest paths grow the same way ) .",
    "this happens in every @xmath54-ball .",
    "next , in the giant component in the @xmath75-ball the shortest path from a given level @xmath54 giant component to one of the level @xmath54 giant components that have connections at distance @xmath158 should grow like @xmath312 , according to ( [ eq:3.1 ] ) , if the extended result holds . hence the ( graph ) distance between two points chosen at random in the level @xmath75 giant component of level @xmath54 giant components in a @xmath75-ball grows like the product @xmath313 .",
    "in contrast , the average distance in the giant component of the _ er _ random graph @xmath314 , grows like @xmath315 .",
    "hence , although the sizes of the giant clusters in a @xmath15-ball of @xmath4 ( which has @xmath16 points ) and in the _ er _ graph @xmath316 are both of order @xmath16 ( by ( a ) and corollary 2.3 ) , the typical length of paths is longer in the hierarchical case ( of order @xmath317 ) .",
    "this happens because two points chosen at random in the cascade in a @xmath15-ball are most likely hierarchical distance @xmath15 apart , and the paths connecting them have to go consecutively through @xmath15 hierarchical levels ( by cascade percolation ) .",
    "the following central limit theorem is proved in @xcite for the fluctuation of the size @xmath318 of the giant component @xmath319 of a @xmath52 random graph @xmath320 @xmath321 where @xmath322 denotes convergence in distribution , and @xmath323 is the normal distribution with mean @xmath18 and variance @xmath324 , where @xmath325 satisfies @xmath326 , and @xmath327 is the slope of @xmath328 at @xmath329 ( see also @xcite , theorem 2.5.3 ) .",
    "if this result could be extended to random graphs with random connection probabilities obeying ( [ eq:3.1 ] ) , we would have the following central limit result . recall that @xmath226 denotes the size of the cascade of giant components in a @xmath15-ball ( see corollary 2.3 ) .",
    "let @xmath330 then @xmath331 for each @xmath15 , where @xmath332 satisfies ( [ eq:2.2 ] ) , @xmath333 , and @xmath334 is the slope of @xmath335 at @xmath336 .",
    "we argue by induction . for @xmath139 the result",
    "is obtained directly by the c.l.t . of @xcite .",
    "now we assume the result is true for @xmath78 and consider the case @xmath15 .",
    "note that @xmath337 , where @xmath338 is the size of the giant component of @xmath339 , hence @xmath338 grows like @xmath340 .",
    "we write @xmath341 as @xmath342 where @xmath343 , @xmath344 , are the sizes of the cascades in the @xmath17-balls forming the giant component of @xmath345 .",
    "the @xmath346 are i.i.d , and by the induction assumption , @xmath347 for each @xmath82 , as @xmath7 .",
    "it is easy to show from ( [ eq:3.4 ] ) that the first term on the r.h.s . of ( [ eq:3.6.1 ] )",
    "converges to @xmath18 in probability as @xmath7 .",
    "the result then follows from the second term in the r.h.s . of ( [ eq:3.6.1 ] ) , if the extended central limit theorem for the random graph with connection probabilities @xmath301 obeying ( [ eq:3.1 ] ) holds .",
    ".25 cm * appendix * .15 cm * proof of lemma 2.1 * ( [ eq:2.2 ] ) with @xmath139 and @xmath348 imply @xmath349",
    ". then @xmath350 log@xmath75 , which by ( [ eq:2.2 ] ) with @xmath121 implies @xmath351 , and so on , so @xmath352 for all @xmath15",
    ".          * acknowledgement .",
    "* lgg thanks the laboratory for research in statistics and probability , carleton university , ottawa , and the swiss federal institute of technology ( eth ) , zrich , for their hospitality .",
    "99 alon , n. and spencer , j.h . : _ the probabilistic method _ , wiley , ( 2000 ) .",
    "albert , r. and barabsi , a.l .",
    ": emergence of scaling in random networks , _ science _ 286 ( 1999 ) , 509 - 512 .",
    "barabsi , a.l . and",
    "ravaz , e : hierarchical organization in complex networks , phys .",
    "e. 67 , 026112 ( 2003 ) .",
    "barraez , d. , boucheron , s. and fernndez de la vega , w. : on the fluctuations of the giant component , _ comb . ,",
    "probab . and comput .",
    "_ 9 ( 2000 ) , 287 - 304 .",
    "benjamini , i. and berger , n. : the diameter of long - range percolation clusters on finite cycles , _ random structures algorithms _ 19 , no . 2 ( 2001 ) , 102 - 111 .",
    "benjamini , i. , lyons , r. and peres , y : group - invariant percolation on graphs , _ geom .",
    "_ 9 , no . 1 ( 1999 ) , 29 - 66 .",
    "benjamini , i. and schramm , o. : percolation beyond @xmath361 , many questions and a few answers , _ elect .",
    "_ 1 ( 1996 ) , 71 - 82 .",
    "biskup , m. : on the scaling of chemical distance in long - range percolation models , _ ann .",
    "_ 32 , no . 4 ( 2004 ) , 2938 - 2977 .",
    "bollobs , b. : _ random graphs _ ,",
    "edition , cambridge univ .",
    "press , ( 2001 ) .",
    "bollobs , b. , janson , s. and riordan , o.m . : the phase transition in inhomogeneous random graphs , _",
    "random structures and algorithms _",
    "( to appear ) .",
    "bollobs , b. and riordan , o.m . : mathematical results on scale - free random graphs , in _ handbook of graphs and networks _ , 1 - 34 , wiley , ( 2003 ) .",
    "bollobs , b. and riordan , o.m .",
    ": coupling scale - free and classical random graphs , _ internet math .",
    ". 2 , ( 2004 ) , 215 - 255 .",
    "coppersmith , d. , gamarnik , d. and sviridenko , m. : the diameter of a long - range percolation graph , _ random structures algorithms _ 21 , no . 1 ( 2002 ) , 1 - 13 .",
    "cox , j.t . ,",
    "dawson , d.a . and greven , a. :",
    "mutually catalytic super branching random walks : large finite systems and renormalization analysis , _ mem .",
    "math . soc .",
    "_ 171 , no . 809 ( 2004 ) .",
    "dawson , d.a .",
    ", gorostiza , l.g . and wakolbinger , a. : hierarchical random walks , in _ asymptotic methods in stochastics _ , ( l.  horvth and b.  szyszkowicz , eds . ) , fields institute communications 44 ( 2004 ) , 173 - 193 .",
    "dawson , d.a .",
    "gorostiza , l.g . and wakolbinger , a. : hierarchical equilibria of branching populations , _ elect",
    ". j. probab .",
    "_ 9 ( 2004 ) , paper no . 12 , 316 - 381 .",
    "durrett , r. : _ random graph dynamics _ , cambridge univ .",
    "press , ( 2006 ) .",
    "erd@xmath6s , p. and rnyi , a. : on the evolution of random graphs , _ publ .",
    "_ 5 ( 1960 ) , 17 - 61 .",
    "feller , w. : _ an introduction to probability theory and its applications _",
    "edition , wiley , ( 1962 ) .",
    "hambly , b.m . and jordan , j. : a random hierarchical lattice : the series parallel graph and its properties , _ adv .",
    "_ 36 , no . 3 ( 2004 ) , 824 - 838 .",
    "hogg , t. : refining the phase transition in combinatorial search , _ artificial intelligence _ 81 , no . 1 - 2 ( 1996 ) , 127 - 154 .",
    "janson , s. , uczak , t. and ruciski , a. : _ random graphs _ , wiley , ( 2000 ) .",
    "kleinberg , j. : small - world phenomena and the dynamics of information , in _ advances in neural information processing systems ( nips ) _ 14 ( 2001 ) , 431 - 438 .",
    "kleinberg , j. : complex networks and decentralized search algorithms , _ proc .",
    "icm , 2006 , _ volume 3 , 1019 - 1044 , european mathematical society , zurich , 2006 .",
    "ravasz , e. , somera , a.l . ,",
    "mongru , d.a . ,",
    "oltvai , z.n . and",
    "barabsi , a.l . : hierarchical organization of modularity in metabolic networks , _ science _ 297 ( 2002 ) , 1551 - 1554 .",
    "sawyer , s. and felsenstein , j. : isolation by distance in a hierarchically clustered population , _ j.  app .",
    "_ 20 ( 1983 ) , 1 - 10 .",
    "van custem , b. and ycart , b. : indexed dendograms on random dissimilarities , _ j.  classification _ 15 , no . 1 ( 1998 ) , 93 - 127 ."
  ],
  "abstract_text": [
    "<S> we study asymptotic percolation as @xmath0 in an infinite random graph @xmath1 embedded in the hierarchical group of order @xmath2 , with connection probabilities depending on an ultrametric distance between vertices . </S>",
    "<S> @xmath1 is structured as a cascade of finite random subgraphs of ( approximate ) erd@xmath3s - rnyi type . </S>",
    "<S> however , the results are different from those of classical random graphs , e.g. , the average length of paths in the giant component of an ultrametric ball is much longer than in the classical case . </S>",
    "<S> we give a criterion for percolation , and show that percolation takes place along giant components of giant components at the previous level in the cascade of subgraphs for all consecutive hierarchical distances . </S>",
    "<S> the proof involves a hierarchy of `` doubly stochastic '' random graphs with vertices having an internal structure and random connection probabilities . </S>"
  ]
}