{
  "article_text": [
    "in 1991 e.  witten formulated two conjectures relating to the intersection theory of moduli spaces of curves  @xcite , motivated by two dimensional gravity .",
    "the first conjecture involves moduli spaces of stable curves and the tautological 2-cohomology classes on them ( also called @xmath1-classes ) .",
    "the intersection numbers of powers of the @xmath1-classes can be arranged into a generating series that is claimed to be a solution of the korteweg  de  vries ( or kdv ) hierarchy of partial differential equations .",
    "this conjecture was first proved by m.  kontsevich in  @xcite . at present",
    "there are several alternative proofs :  @xcite ,  @xcite ,  @xcite ,  @xcite .",
    "the second conjecture is still open , and even giving a precise formulation required joint work by several people ( references are given below ) .",
    "it involves a more complicated moduli space , called the _ space of @xmath0-spin structures_. apart from the @xmath1-classes , one considers one more cohomology class , called the _",
    "witten top chern class _ , or just _",
    "witten s class _ for shortness .",
    "we are interested in the intersection numbers of witten s class with powers of the @xmath1-classes .",
    "these intersection numbers can , once again , be arranged into a generating series , and this series is claimed to give a solution of the @xmath0th gelfand - dikii ( or the @xmath0-kdv ) hierarchy .",
    "the precise definition of witten s top chern class is rather involved ; however it is known to satisfy quite simple factorization rules .    in  @xcite",
    "the first author found an `` almost - algorithm '' for computing some of the intersection numbers arising in witten s second conjecture _ using only the factorization rules for the witten class_. more precisely , the factorization rules allow one to express more complicated intersection numbers via simpler ones , until one arrives at unsimplifiable cases .",
    "these can be of two types .",
    "( i )  integrals of witten s class ( with no @xmath1-classes ) over genus  @xmath2 moduli spaces .",
    "these numbers are well - known .",
    "( ii )  integrals of witten s class ( with no @xmath1-classes ) over some special divisors on genus  @xmath3 moduli space .",
    "( these divisors have a rather cumbersome name of _ double ramification divisors _ - see below . ) when numbers of second type appeared in the course of computations the algorithm blocked without giving an answer .",
    "the purpose of this note it twofold .",
    "first , compute the integrals of witten s class over the double ramification divisors in genus  1 .",
    "it turns out that a simple closed formula exists for these integrals .",
    "second , complete and give a coherent exposition of the algorithm for computing witten s intersection numbers .",
    "our computation uses only factorization rules for witten s class .",
    "therefore , we obtain the following theorem .",
    "[ thm : algorithm ] the intersection numbers of witten s class with powers of the @xmath1-classes are entirely determined by ( i ) genus  @xmath2 intersection numbers involving no @xmath1-classes , and ( ii ) the factorization rules for witten s class .",
    "@xmath4 is the moduli space of smooth complex genus  @xmath5 curves with @xmath6 distinct numbered marked points .",
    "@xmath7 is its deligne - mumford compactification , in other words , the moduli space of stable curves .",
    "over @xmath7 we define @xmath8 holomorphic line bundles @xmath9 .",
    "the fiber of @xmath9 over a point @xmath10 is the cotangent line to the corresponding stable curve @xmath11 at the @xmath12th marked point .",
    "the first chern classes @xmath13 of these line bundles are called the _",
    "tautological classes_.      chose an integer @xmath14 and pick @xmath8 integers @xmath15 in such a way that @xmath16 is divisible by  @xmath0 .",
    "the numbers @xmath17 are assigned to the marked points @xmath18 . on a smooth curve",
    "@xmath19 one can find @xmath20 different line bundles @xmath21 with an identification @xmath22 the space of smooth curves endowed with such a line bundle @xmath21 is called the _ space of @xmath0-spin structures _ and denoted by @xmath23 .",
    "it is an unramified @xmath20-sheeted covering of @xmath4 .",
    "a compactification of this space , denoted by @xmath24 , was constructed in  @xcite and  @xcite ( see also  @xcite for a slightly simplified version ) .",
    "it is a smooth orbifold ( or stack ) , and there is a finite projection mapping @xmath25 the construction uses the so - called _ jarvis - vistoli twisted curves _ ,",
    "i.e. , curves that are themselves endowed with an orbifold structure .",
    "the stabilizers of the marked points and the nodes are equal to @xmath26 , while the stabilizer of any other point is trivial .",
    "@xmath21 is then an @xmath0th root of @xmath27 _ in the orbifold sense_. alternatively , we can forget about the orbifold structure of the curve and consider only the sheaf of invariant sections of  @xmath21 .",
    "we then obtain a rank one torsion - free sheaf rather than a line bundle .",
    "the rank one torsion - free sheaf ( of invariant sections of ) @xmath21 is defined on the universal curve @xmath28 over @xmath24 .",
    "consider its push - forward to the space @xmath29 itself .",
    "first assume that for each curve @xmath19 we have @xmath30 .",
    "then the spaces @xmath31 form a vector bundle @xmath32 over @xmath24 .",
    "we denote by @xmath33 the dual vector bundle and define witten s class as @xmath34 in other words : take the top chern class of @xmath33 , push it from @xmath35 to @xmath7 , and divide by @xmath36 . by the riemann - roch formula ,",
    "the ( complex ) degree of witten s class is @xmath37    unfortunately , in general @xmath21 has both @xmath2- and @xmath3-cohomologies .",
    "the definition of witten s class @xmath38 in this case is much more involved .",
    "there exist two algebro - geometric constructions : see  @xcite and  @xcite .",
    "( note that the definition of @xmath38 is special to our situation and uses the identification of @xmath39 with the canonical bundle .",
    "no general constructions from algebraic geometry are expected to work . )",
    "witten s class satisfies the following vanishing property , that we will use as an axiom :    * if one of the @xmath40 s equals @xmath41 then @xmath42*.      we are interested in the restriction of witten s class to the boundary components of the moduli space @xmath7 .",
    "there are two types of boundary components ( see figure  [ fig : degeneration ] ) : those isomorphic to @xmath43 , @xmath44 , @xmath45 and the unique component isomorphic to @xmath46 .    in the first case ,",
    "assume for simplicity that the the marked points @xmath47 are on the first component of the curve , while @xmath48 are on the second component .",
    "there is a unique choice of @xmath49 such that @xmath50 are both divisible by  @xmath0 .",
    "we have @xmath51 or @xmath52 .",
    "for the second type of boundary component , we have to sum over all choices of @xmath53 such that @xmath51 .",
    "now we can formulate the factorization rules .    * the restriction of witten s class to the first type boundary component equals @xmath54 *    the restriction of witten s class to the second type boundary component equals @xmath55    the vanishing property and the factorization rules ( for the polishchuk - vaintrob construction ) are proved in  @xcite .",
    "we use the standard notation for the intersection numbers of witten s class with powers of the @xmath1-classes : @xmath56 although the genus @xmath5 is determined by the elements of the bracket by @xmath57 we will sometimes recall it in a subscript .",
    "the integer @xmath14 is supposed to be fixed once and for all throughout the paper .    since double ramification cycles on genus  @xmath3",
    "moduli spaces will play a special role , let us introduce them here ( this is a particular case of definition  [ def : dr - cycle ] ) .",
    "choose @xmath8 integers @xmath58 satisfying @xmath59 .",
    "we assume that at least one of the @xmath60 s is different from  @xmath2 .",
    "we will usually assume that the list @xmath61 starts with the positive integers and ends with the negative ones , the zeroes being in the middle .",
    "we will sometimes use the notation @xmath62 with only nonnegative integers instead of @xmath63    to this list of integers assign the set @xmath64 of smooth genus  1 curves @xmath65 such that @xmath66 is the divisor of a function . let the cycle @xmath67 be the closure of @xmath64 .",
    "[ def : divisor ] we call @xmath67 a _ double ramification cycle_. the integral of witten s class over this cycle is denoted by @xmath68 @xmath69    [ thm : formula ] we have @xmath70      this work was completed during the second author s visit to the stockholm university .",
    "we would like to thank the university for its hospitality and the members of the mathematical seminar for their interest .",
    "consider a map @xmath71 from a smooth curve @xmath19 to the sphere @xmath72 .",
    "mark all ramification points on @xmath73 and all their preimages on  @xmath19 . now choose several disjoint simple loops on @xmath73 , that do not pass through the marked points .",
    "suppose that if we contract these loops we obtain a stable genus  0 curve @xmath74 .",
    "now contract also all the preimages of the loops in  @xmath19 to obtain a nodal curve @xmath75 that turns out to be automatically stable .",
    "we have obtained a map @xmath76 from a nodal curve of genus  @xmath5 to a stable curve of genus  0 .",
    "it has the same degree over every component of @xmath74 .",
    "moreover , at each node of @xmath75 , the projection @xmath76 has the same local multiplicity on both components meeting at the node .",
    "[ def : admcov ] a map from a stable curve of genus  @xmath5 to a stable curve of genus  0 topologically equivalent to a map described above is called an _",
    "admissible covering_.    the space of all admissible coverings with prescribed ramification types over the marked points is very useful for the study of moduli spaces ( see  @xcite ) .",
    "it is not normal but can be normalized , and thus one can study its intersection theory .",
    "we refer to ionel s work  @xcite for detailed definitions",
    ". this construction can be slightly extended by allowing additional marked points on the curve  @xmath19 .",
    "their images on the genus  0 curve will also be marked ( although they are not ramification points ) .",
    "all the other preimages on  @xmath19 of these new marked points on  @xmath73 should also be marked .",
    "we will be particularly interested in the space of admissible covering with multiple ramifications only over  2 points labeled with @xmath2 and  @xmath77 , the other ramification points being simple .",
    "[ def : dr - space ] consider the space of admissible coverings of some given genus  @xmath5 with prescribed ramification types @xmath78 and @xmath79 , @xmath80 , over two points labeled @xmath2 and @xmath77 , and with simple ramifications elsewhere . we also suppose that there are @xmath81 additional marked points on @xmath19 .",
    "the normalization of this space is called a _ double ramification space _ or a _ dr - space_. it is denoted by @xmath82 we do not include the genus  @xmath5 in our notation , although , of course , the space of coverings does depend on  @xmath5 .",
    "if @xmath83 is the total number of marked points on the curve  @xmath19 , we can consider the forgetful map @xmath84 that forgets the admissible covering retaining only its source curve .",
    "since the curve  @xmath19 is automatically stable , the map  @xmath85 is actually an injection and an isomorphism with its image .",
    "the pull - backs by @xmath85 of the @xmath1-classes on @xmath86 coinside with the @xmath1-classes naturally defined on  @xmath87 .",
    "another forgetful map @xmath88 , @xmath89 takes an admissible to its image genus  0 curve .",
    "this map satisfies the following crucial property .",
    "[ ionel s lemma , see  @xcite ] [ lem : ionel ] the map @xmath90 sends the fundamental homology class of @xmath87 to ( a multiple of ) the fundamental homology class of @xmath91 .",
    "we have @xmath92 in other words , a @xmath1-class on @xmath87 at a marked zero or pole of the admissible covering coincides , up to a constant , with the pull - back of the @xmath1-class at @xmath2 or @xmath77 of the genus  0 moduli space .",
    "finally , let us define double ramification cycles .",
    "for a given moduli space @xmath7 choose an integer @xmath93 , @xmath94 and @xmath95 integers @xmath60 .",
    "we suppose that @xmath59 and that none of the @xmath96 vanishes .",
    "[ def : dr - cycle ] consider the set of smooth curves @xmath97 such that there exist @xmath93 more marked points @xmath98 and a meromorphic function on @xmath19 with no zeroes or poles outside of @xmath99 , the orders of zeroes or poles being prescribed by the list @xmath100 ( @xmath101 for the zeroes , @xmath102 for the poles , and @xmath103 for the marked points that are neither zeroes nor poles ) .",
    "the closure of this set in @xmath7 is called the _ double ramification cycle _ or a _ dr - cycle_.    by a generalization of mumford s argument in  @xcite , one can show that the codimension of a dr - cycle is equal to @xmath104 whenever there is at least one positive and one negative number among @xmath58 . assuming that this condition is satisfied we see that for @xmath105 the dr - cycle coincides with the moduli space @xmath7 .",
    "faber and pandharipande  @xcite proved that the cohomology classes poincar dual to any dr - cycle belongs to the tautological ring of the moduli space of curves .",
    "their proof may be used to obtain new relations for intersection numbers with witten s class .",
    "it follows that the forgetful map @xmath106 sends the fundamental comology class of @xmath107 to ( a multiple of ) the fundamental homology class of the dr - cycle .",
    "[ [ conventions . ] ] conventions .",
    "+ + + + + + + + + + + +    figure  [ fig : diagramma ] represents a dr - space @xmath108 it also shows the corresponding maps @xmath85 , @xmath90 and @xmath109 . in this figure , as well as in the subsequent figures and in the text we follow the following conventions .",
    "a * cross * represents a critical point or a ramification point of an admissible covering . * round black dots * represent the marked points @xmath18 ( they are not forgotten under the map  @xmath109 ) .",
    "the images of these points under the maps @xmath85 , @xmath90 , and @xmath109 are also represented as round black dots .",
    "* square black dots * represent the points @xmath98 ( they are forgotten under the map  @xmath109 ) . finally , * white dots * represent all the marked points on the curve  @xmath19 different from the critical points and from @xmath99 .",
    "we will not show them in the figures when it is not necessary .      in our computations we will need the value of the bracket @xmath110 for @xmath111 . the _ topological recursion relation _ expresses @xmath112 as a sum of divisors :    @xmath113{toprec.eps } \\ ; .\\ ] ]    we must integrate witten s class over each of these divisors .",
    "the first divisor contributes @xmath2   over this divisor includes as a factor the integral of @xmath38 over a genus  1 moduli space , which vanishes for reasons of dimension . ]",
    "[ snoska ] while the second one contributes @xmath114 this is a combination of integrals of witten s class ( without @xmath1-classes ) over genus  0 moduli spaces , and we are now going to determine its value . for simplicity , in this section we will use nonstandard notation for the bracket : @xmath115 instead of @xmath116 .",
    "[ prop : loop ] for any @xmath117 and for any @xmath18 , @xmath118 , @xmath119 , we have @xmath120    [ [ proof . ] ] proof .",
    "+ + + + + +    the proof uses the known initial values of the bracket : @xmath121 and the wdvv equation .",
    "first note that the proposition is true for @xmath122 ( it says that @xmath123 ) .",
    "now we assume @xmath124 and proceed by induction on  @xmath125 .    if @xmath126 then the only possible bracket is @xmath127 .",
    "suppose that the proposition is true up to some @xmath125 .",
    "let us apply the wdvv equation to the correlators containing @xmath128 , the four distinguished points being @xmath3 , @xmath129 , @xmath130 , and  @xmath131 .",
    "in other words , we consider all possible degenerations of the sphere into two components such that @xmath3 and @xmath129 lie on one component , while @xmath130 and @xmath131 lie on the other one , and then we swap the four points .",
    "we obtain the following equality .",
    "( the summation over @xmath132 is implicitly assumed ; a hat means that the symbol is skipped ; underlined symbols are not in the original list , they appear at the node of the degenerate sphere in the wdvv formula . )",
    "@xmath133 @xmath134 @xmath135 @xmath136 @xmath137    the term @xmath138 is the sum over @xmath139 that we want to determine .",
    "the missing case @xmath140 does not matter , because for @xmath141 a single zero entry makes a bracket vanish .",
    "the term @xmath142 can be evaluated by the induction assumption .",
    "it vanishes if @xmath143 , while for @xmath144 we obtain a sum over @xmath145 .",
    "thus we have @xmath146    the term @xmath147 can , once again , be evaluated by the induction assumption : @xmath148    the last term @xmath149 vanishes if @xmath150 .",
    "luckily , it turns out that for any @xmath151 , we have @xmath152 . indeed , if @xmath153 and @xmath154 , then the sum of the @xmath155 remaining terms equals @xmath156 , which is impossible since each of them equals at most @xmath157 .",
    "therefore we have @xmath158 \\prod_{j \\not= 1,i } ( r-1-x_j).\\ ] ] we deduce that @xmath159    by looking through the proof carefully one can check that the formula given in the proposition actually holds for @xmath160 , except if @xmath122 .",
    "in this section we prove theorem  [ thm : formula ] . by algebro - geometric arguments we find several relations binding the values of the brackets involved in the theorem . in section  [ ssec : relations ] we write down these relations and prove that they suffice to determine the values of the bracket in all cases .",
    "we prove the relations in section  [ ssec : proofrel ] .",
    "denote by @xmath161 ( see section  [ ssec : genus0 ] ) .    then the following relations hold .",
    "[ [ relation-1 . ] ] relation 1 .",
    "+ + + + + + + + + + +    @xmath162 @xmath163 @xmath164 @xmath165    [ [ relation-2 . ] ] relation 2 .",
    "+ + + + + + + + + + +    @xmath166 @xmath167    [ [ relation-3 . ] ] relation 3 .",
    "+ + + + + + + + + + +    @xmath168    to these relations we may add the simple observation that the brackets are invariant under renumberings of the marked points and under a simultaneous change of sign of all @xmath60 s .",
    "one can check by direct computations that these relations are compatible with the expression of the bracket given in theorem  [ thm : formula ] .",
    "relations  1 , 2 , and  3 determine the values of all brackets unambiguously .    [ [ proof.-1 ] ] proof .",
    "+ + + + + +    the lemma is proved by induction on the number of nonzero entries @xmath169 in a bracket , the base of induction being given by relation  3 .",
    "consider a bracket whose value we would like to determine .",
    "first case : suppose that one of the @xmath170 s is equal to  1 and one of the @xmath60 s is greater than  1 ( or vice versa )",
    ". then we take our bracket to be the last term in relation  2 and replace it by the first term ( plus a know multiple of  @xmath171 ) .",
    "we have decreased the number of nonzero @xmath60 s in the bracket to be computed .",
    "second case : suppose that all the ( nonzero ) @xmath60 s and @xmath170",
    "s equal  1 .",
    "in particular , @xmath172 .",
    "if @xmath173 the bracket vanishes by relation  3 .",
    "if @xmath174 , we take our bracket to be the first term in relation  1 .",
    "our bracket is than replaced by a sum of brackets in which one of the @xmath60 s and one of the @xmath170 s are equal to  2 , while all the others are equal to  1 .",
    "such brackets fall into the first case .",
    "third case : suppose that all of the @xmath60 s and @xmath170 s are greater than  1",
    ". then we take our bracket to be the first term of the second sum in relation  1 and replace it by the sum of the other terms . as a result",
    "we obtain a combination of brackets in all of which the number @xmath175 is smaller than in the initial bracket . repeating the same operation for each bracket we are sure that @xmath175 will decrease by  1 with every step . thus after a finite number of steps we will end up with a collection of brackets all of which fall into the first two cases .",
    "thus the relations determine the values of the brackets unambiguously .",
    "since they are compatible with the expression of theorem  [ thm : formula ] , the theorem will be completely proved once we will have proved the relations .",
    "first of all , note that relation  3 is obvious .",
    "the bracket in this relation denotes an integral over an empty space , therefore it vanishes .",
    "thus we only need to prove relations  1 and  2 .",
    "consider the commutative diagram involving four moduli spaces shown in figure  [ fig : diagramma ] .",
    "( 11,9)(0,-4 ) ( 0,0)@xmath176 ( .5,6)@xmath87 ( 1,5.3)(0,-1)3.5 ( 6.5,0)@xmath177 ( 6.5,6)@xmath178 ( 7.2,5.3)(0,-1)3.5 ( 2.5,6.4)(1,0)3 ( 2.5,5.3)(1,-1)3.5 ( 0,3.5)@xmath90 ( 4.5,3.5)@xmath109 ( 4,6.8)@xmath85 ( 7.7,3.5)@xmath179    here @xmath180 is the dr - space of genus  1 admissible coverings with ramification types @xmath181 and @xmath182 over @xmath2 and @xmath77",
    ". there are also @xmath81 additional marked points on the source curve .",
    "the projection @xmath179 forgets all marked points except the round black dots and stabilizes the curve .    in this example , the dr - cycle coincides with the whole moduli space @xmath177 .",
    "the main technique of this section is to compute the integral @xmath183 by three different methods and to use the relations thus obtained .",
    "the three methods can be summarized as follows .",
    "* a. * express the @xmath1-class on @xmath176 as a sum of boundary divisors . by ionel s lemma ( lemma  [ lem : ionel ] )",
    ", the preimages under @xmath90 of these boundary divisors represent the class  @xmath112 on  @xmath87 .",
    "the images of these divisors under  @xmath109 turn out to to be dr - cycles .",
    "therefore the integrals of witten s class over these divisors are some values of the bracket of definition  [ def : divisor ] .",
    "* b. * same as ( a ) with another expression of the @xmath1-class in terms of boundary divisors .    * c. * in section  [ ssec : genus0 ] we computed the integral @xmath184 analogous to @xmath185 .",
    "now , the classes @xmath112 on @xmath177 and on @xmath87 differ by a sum of boundary divisors .",
    "the images of these divisors under  @xmath109 turn out , once again , to be dr - cycles , and integrating witten s class upon them we obtain a linear combination of brackets .",
    "[ [ a. ] ] a. + +    on the space @xmath176 in figure  [ fig : diagramma ] , consider the class @xmath1 at the point labeled by @xmath2 .",
    "this class is equal to a sum of boundary divisors that we will represent as @xmath186{psi1.eps } .\\ ] ]    the picture represents a sum of boundary divisors where the sphere splits into two components .",
    "the point labeled by @xmath2 is on the first component , while the point labeled by @xmath77 together with some _ chosen _ critical value ( say , the first one ) is on the second component .",
    "the other marked points on the sphere can be distributed arbitrarily between the components .",
    "consider the preimages under @xmath90 of these boundary strata .",
    "[ lem : adiv ] among the preimages in @xmath87 of the divisors  ( [ eq : psi1 ] ) consider those on which the integral of @xmath187 does not vanish .",
    "these divisors are @xmath188 , @xmath189 , and @xmath190 in figure  [ fig : div ] .    it should be understood that each picture actually represents a _",
    "admissible covering lying in the divisor .",
    "in other words , the divisor is the closure of the set of admissible coverings with the topological structure shown in the figure .",
    "lll & & +   + & &    [ [ proof - of - the - lemma . ] ] proof of the lemma .",
    "+ + + + + + + + + + + + + + + + + + +    we consider an irreducible component of the preimage of  ( [ eq : psi1 ] ) and reason in terms of the generic admissible covering @xmath191 in this component .",
    "first suppose that the curve @xmath19 does not have a toric component .",
    "then it looks as a ring of spheres with several `` tails '' :    each sphere of the ring contains at least  2 nodes .",
    "thus the restriction of @xmath71 to any such sphere is of degree at least  2 . which implies that there is at least one round black dot on each sphere of the ring ( there is at least one preimage of @xmath2 or @xmath77 on each component , and the square black dot alone , being a simple preimage , is not enough for @xmath71 to have degree  2 ) .",
    "it follows that none of the spheres of the ring is contracted under the map  @xmath109 to @xmath177 .",
    "now , the number of spheres in the ring is even ( those that contain a preimage of  0 alternate with those that contain a preimage of  @xmath77 ) .",
    "thus the curve @xmath19 retains at least  2 nodes after the projection to @xmath177 . which means that the codimension of the image of the corresponding divisor under  @xmath109 is at least  2 , so the integral of witten s class on it vanishes .",
    "the conclusion is that we only need to consider curves  @xmath19 with a toric component .",
    "suppose @xmath19 has a toric component with several `` tails '' :    if one of the tails contains more than one round black dot , than the projection @xmath109 of such a curve to @xmath177 looks like :    the integral of witten s class over the divisor of such curves vanishes .",
    "the conclusion is that each `` tail '' contains at most one round black dot .",
    "note that every component of @xmath19 contains at least one black dot ( round or square ) : either a preimage of  0 or of  @xmath77 .",
    "it follows that each tail ( except perhaps one ) is composed of exactly  1 sphere containing exactly  1 black dot .",
    "the exceptional tail can be composed of  1 or  2 spheres containing a round black dot and a square black dot . on each simple tail the function",
    "@xmath71 has the form @xmath192 for some positive integer  @xmath193 .",
    "actually , an exceptional tail is bound to exist . indeed , suppose there is no exceptional tail , i.e. , every tail is composed of  1 sphere with a unique black dot .",
    "the image curve  @xmath73 has  2 components , and in the case we consider , the preimage of one of them is the toric component of @xmath19 , while the preimage of the other is the union of the tails .",
    "then the latter component of  @xmath73 contains no marked points except @xmath2 or @xmath77 .",
    "this is impossible , because  @xmath73 is stable .",
    "if the exceptional tail is composed of  1 sphere , then this sphere contains the black square dot and some dot @xmath170 .",
    "this gives the divisor @xmath190 .",
    "if the exceptional tail is composed of  2 spheres , then one of them contains the square black dot , and the other one some dot @xmath60 or @xmath194 .",
    "the sphere with the square dot can contain at most one node because the degree of  @xmath71 on it equals  1 .",
    "thus we obtain the divisors @xmath188 and @xmath189 .",
    "the lemma is proved .",
    "now , the integral @xmath185 is the sum of integrals of witten s class over the divisors @xmath188 , @xmath189 , and @xmath190 , which we will now determine .",
    "[ lem : acoefs ] the contributions to @xmath185 of the divisors",
    "@xmath188 , @xmath189 , and @xmath190 equal @xmath195 respectively , where @xmath196 .",
    "[ [ proof.-2 ] ] proof .",
    "+ + + + + +    the fundamental classes of the divisors @xmath188 , @xmath189 , and @xmath190 project to multiples of double ramification divisors in @xmath177 under the map  @xmath109 .",
    "thus we can integrate witten s class over these double ramification divisors , which explains the brackets that appear in the answers .",
    "the coefficients in front of these brackets arise as products of three factors : ( i )  the transversal multiplicity of the map @xmath90 on the divisor ( because we need pull - backs under  @xmath90 of homology classes rather than geometric pull - backs ) ; ( ii )  the degree of @xmath109 on the divisor ; ( iii )  the factor @xmath197 coming from ionel s lemma .",
    "for example , for @xmath189 , these factors are :    @xmath198 these factors come from the number of ways to resolve the nodes of the source curve . @xmath199",
    "the factor @xmath200 is the number of ways to number the ramification points on the two - component genus  0 image curve , taking into account that the first ramification point lies on the component of @xmath77 .",
    "@xmath201 is the number of ways to number the white ( noncritical ) preimages of the ramification points .",
    "@xmath202 is the number of ways to number the white preimages of the black marked points different from @xmath2 and  @xmath77 .",
    "the denominator comes from the spheres on the left of the picture of @xmath189 : the restriction of the admissible covering map @xmath71 on these spheres has the form @xmath203 , and thus @xmath204 gives a renumbering of the white dots on such a sphere equivalent to the initial numbering .    multiplying these factors ( without forgetting @xmath197 ) we obtain the coefficient for @xmath189 as claimed in the lemma .",
    "the computations for the other divisors are analogous .",
    "[ [ b. ] ] b. + +    the second way of computing the integral  @xmath185 is not very different from the first one .",
    "this time we start with a different presentation of the @xmath1-class at the point labeled by  @xmath2 on @xmath176 : @xmath205{psi2.eps } .\\ ] ]    the picture represents a sum of boundary divisors where the sphere splits into two components . the point labeled by  @xmath2 is on the first component , while the point labeled by  @xmath77 together with another _ chosen _ black marked point ( say , the first one ) is on the second component .",
    "[ lem : bdiv ] among the preimages in @xmath87 of the divisors  ( [ eq : psi2 ] ) consider those on which the integral of @xmath38 does not vanish .",
    "these divisors are @xmath188 , @xmath189 , and @xmath206 in figure  [ fig : div ] .",
    "[ [ proof.-3 ] ] proof .",
    "+ + + + + +    first suppose there are no points marked with crosses on the component of  @xmath77 on the image curve .",
    "this means that the preimages of this component are spheres containing only black marked points .",
    "however , all these components must be contracted under the map  @xmath109 .",
    "( otherwise the integral of @xmath38 over this divisor vanishes . )",
    "therefore , actually , every sphere contains exactly one black point , except one sphere that contains a round black dot and a square black dot .",
    "this is the divisor @xmath206 .",
    "if the component of @xmath77 in the image curve contains at least one cross - marked point , then we have reduced the problem to the situation of lemma  [ lem : adiv ] .",
    "thus the only divisors that can give a nonzero contribution are @xmath188 , @xmath189 , and @xmath190",
    ". however , actually the divisors @xmath190 do not appear as preimages of the divisors  ( [ eq : psi2 ] ) because in this case the component of @xmath77 in the image contains no black dots other than @xmath77 .",
    "[ lem : bcoefs ] the contributions to @xmath185 of the divisors @xmath188 , @xmath189 , and @xmath206 equal @xmath207 respectively , where @xmath196 .",
    "the proof is analogous to that of lemma  [ lem : acoefs ] .",
    "[ [ c. ] ] c. + +    now we are going to evaluate @xmath208 using the value @xmath209 if the class @xmath112 on @xmath87 were a pull - back of the class @xmath112 on @xmath177 , then we would simply have @xmath210 .",
    "however this equality is actually incorrect , because there is difference between @xmath211 and @xmath212 .",
    "[ lem : cdiv ] the difference @xmath213 can be represented as the sum of divisors @xmath214 ( the divisors being shown in figure  [ fig : div ] ) and , in addition , some other divisors on which the integral of @xmath38 vanishes .    [ [ proof.-4 ] ] proof .",
    "+ + + + + +    there is a subtlety in finding the difference @xmath213 .",
    "first consider the difference @xmath215 in the upper right moduli space in figure  [ fig : diagramma ] .",
    "it is given by the divisor @xmath216 of all stable curves on which the first black marked point ( @xmath194 ) is situated on a component contracted by  @xmath179 .",
    "now we consider the intersection of this divisor with the image @xmath217 .",
    "it turns out that this intersection is not necessarily transversal , and its multiplicity gives the coefficients that appear in the formulation of the lemma .",
    "now we take the pull - back of the intersection by  @xmath85 .",
    "let us consider an irreducible component of this pull - back @xmath218 and a generic admissible covering @xmath71 in this component .",
    "the image curve of @xmath71 in @xmath176 has a unique node ( otherwise the codimension of such a component in @xmath87 would be at least  2 ) .",
    "moreover , this node separates  @xmath2 and  @xmath77 .",
    "indeed , otherwise the component containing the point @xmath194 also contains some preimage of @xmath77 .",
    "since this component is contracted by @xmath109 , the only possible preimage is the square black dot ( and there are no other preimages of @xmath77 ) .",
    "thus the degree of @xmath71 on this component equals  1 . but this implies @xmath219 , which is impossible .    on the component of @xmath77",
    "there exists at least one cross marked point .",
    "indeed , otherwise there is no ramification over this component , so all the ramification is over the component containing  0 .",
    "then the point @xmath194 lies on the torical component , which is impossible , since this component should be contracted by  @xmath109 .",
    "thus we have reduced the problem to the situation of lemma  [ lem : adiv ] with the additional restriction that the component containing the point @xmath194 should be contracted by  @xmath109 .",
    "this restriction excludes the divisors @xmath190 but allows the divisors @xmath188 and @xmath189 .",
    "it remains to find the multiplicity of the intersection @xmath220 along @xmath221 and @xmath222 .",
    "this multiplicity is easily seen to be equal to the product of indices of the nodes that are desingularized as a generic point of the intersection moves to a generic point of  @xmath216 .",
    "such products of indices are precisely the coefficients stated in the lemma .",
    "[ lem : ccoefs ] the contributions to @xmath185 of the integral @xmath171 and that of the divisors @xmath188 and @xmath189 equal @xmath223 respectively , where @xmath196 .",
    "[ [ proof.-5 ] ] proof .",
    "+ + + + + +    the coefficient of @xmath171 is just the degree of  @xmath109 .",
    "the coefficients of the other two brackets are obtained as products of two factors : ( i )  the coefficients of the divisors appearing in lemma  [ lem : cdiv ] , ( ii )  the degree of @xmath109 on the divisor .",
    "for instance , for @xmath189 these factors equal : @xmath224 @xmath225 the case of the divisor @xmath188 is analogous .",
    "thus we have established three expressions , a , b , and  c for the integral  @xmath185 .",
    "writing @xmath226 and @xmath227 we obtain relations  1 and  2 .",
    "here we present an algorithm for computing any number @xmath228 .",
    "this algorithm is rather hard to implement on a computer because it involves enumerating all possible degenerations of an admissible covering satisfying some given properties .",
    "thus this section is best viewed as a constructive proof of theorem  [ thm : algorithm ] .",
    "suppose we are given @xmath8 nonnegative integers @xmath229 .",
    "choose an integer @xmath93 , @xmath94 and @xmath8 numbers @xmath58 large enough ( we will use the explicit bound @xmath230 ) such that @xmath231 .",
    "consider the dr - space @xmath232 , where the list ends with @xmath93 numbers  @xmath233 so that the total sum is  0 as it should be .",
    "while the class @xmath238 on @xmath7 is , in general , not representable by boundary divisors , its pull - back to @xmath87 can be easily represented as a sum like that . at each step",
    "we will consider one @xmath1-class and replace it by a sum of divisors .",
    "thus we will be reduced to computing the integral of a product @xmath239 over some divisors , the number of @xmath1-classes having decreased by  1 . using the factorization rules for witten s class",
    ", we will be able to represent each integral over a boundary divisor as a product of analogous integrals over simpler dr - spaces .",
    "consider the class @xmath242 on @xmath7 and the corresponding class @xmath243 on @xmath87 .",
    "the pull - back @xmath241 to @xmath87 can be represented as a sum of divisors in the following way .",
    "first , the class @xmath244 can , by ionel s lemma ( lemma  [ lem : ionel ] ) , be replaced by the pull - back of the @xmath1-class at @xmath2 or at @xmath77 on @xmath245 .",
    "the latter class is easy to represent by a sum of divisors , see equation  ( [ eq : psi1 ] ) .",
    "second , the difference @xmath246 is equal to the sum ( with certain coefficients ) of divisors @xmath247 formed by the admissible coverings for which the component of the source curve containing the @xmath12th marked point is contracted by  @xmath109 ( cf .",
    "lemma  [ lem : cdiv ] ) .",
    "let us consider an irreducible component of one of the above divisors and a generic admissible covering @xmath71 in this component .",
    "the image curve of @xmath71 in @xmath245 has a unique node because otherwise the codimension of such a component in @xmath87 would be at least  2 .",
    "let us prove that this node separates  @xmath2 and  @xmath77 .",
    "indeed , this is obvious by construction for the divisors involved in the expression of @xmath244 . as for the divisors representing the difference @xmath246",
    ", suppose that the node on the image curve does not separate @xmath2 and @xmath77 .",
    "consider the component of the source curve @xmath19 containing the @xmath12th black round marked point .",
    "this compounent must contain both a preimage of @xmath2 and a preimage of  @xmath77 . on the other hand , it is , by construction , contracted by @xmath109 .",
    "thus the only possibility is that it contains a unique round black dot ( a preimage of @xmath2 ) and one or several square black dots ( since these are forgotten by  @xmath109 ) .",
    "but then the degree of @xmath71 on this component is equal to @xmath248 and , at the same time , to the number of square black dots . since we assumed that @xmath230 this is impossible .",
    "since a generic admissible covering in @xmath249 can have nontrivial ramifications only over @xmath2 , @xmath77 , and the node of the image curve , we see that there are at most 2 multiple ramification points on each component of the image curve .",
    "thus , we can split the admissible covering according to the components of the source curve and obtain several simpler admissible coverings lying in simpler dr - spaces .",
    "this is shown in figure  [ fig : split ] ( the meaning of various markings will be explained later ) .",
    "we will call the components of the source curve in a generic admissible covering _ parts_. in figure  [ fig : split ] the parts are denoted by @xmath250 , @xmath171 , @xmath19 , @xmath251 , and  @xmath252 .",
    "the smaller admissible coverings will have a lot of unnecessary white marked points .",
    "consider , for instance , a critical point ( a cross ) on the part  @xmath251 in figure  [ fig : split ] .",
    "its image is a ramification point ( a cross ) in the image curve .",
    "this cross has several simple ( white ) preimages on the parts  @xmath171 and  @xmath252 .",
    "once we have separated the parts we would like to forget these useless white points .",
    "this is done in the following way : ( i )  forget those marked points on the image curve that have only white preimages ( together with these white preimages ) , ( ii )  contract the unstable components of the image curve and their preimages in the source curve .",
    "if the image curve happens to have only marked points , then we simply ignore the corresponding part .",
    "for example , in figure  [ fig : split ] the part @xmath171 will be ignored .",
    "denote by @xmath253 the number of parts that remain after that ( @xmath254 in our example ) , and denote by @xmath255 the corresponding dr - spaces .",
    "we have constructed a map @xmath256 this map sends the fundamental homology class of @xmath249 to a ( multiple of ) the fundamental homology class of the product in the image .",
    "indeed , @xmath257 is an isomorphism on the open part of @xmath249 where ramification points do not coincide .",
    "recall that the map @xmath109 takes the source curve in figure  [ fig : split ] , forgets all the marked points except the round black dots and stabilizes the curve .",
    "we are interested in the preimages of the @xmath1 classes under @xmath109 . during the stabilization",
    "the marked points from certain parts can land on some other parts .",
    "in the figure , the @xmath1-class assigned to the point labeled with @xmath193 ( on the part  @xmath250 ) will land on the part  @xmath251 .",
    "similarly , the @xmath1-class assigned to the round black dot of the part  @xmath252 will land on the part  @xmath19 . indeed , for _",
    "any _ admissible covering lying in the boundary divisor represented in the figure , the parts @xmath250 , @xmath171 , and @xmath252 are contracted by  @xmath109 .",
    "once we have re - assigned the @xmath1-classes in that way , the preimages @xmath241 on @xmath249 coincide with the classes @xmath241 defined separately for each part .",
    "indeed , for instance , in our example , stabilizing the source curve is equivalent to contracting the parts @xmath250 , @xmath171 , and @xmath252 and then stabilizing the parts  @xmath19 and  @xmath251 .              *",
    "a ) * the condition @xmath230 is easily seen to be still satisfied for the smaller dr - spaces . indeed , an index @xmath193 of a zero or a pole can decrease only by `` annihilating '' one or several black squares . for instance , in figure  [ fig : split ] the initial index @xmath193 has become equal to @xmath261 on the component @xmath251 by annihilating one square black dots .    *",
    "b ) * the restriction of witten s class ( more precisely , of @xmath187 ) on the components is obtained by using the factorization rules .",
    "this involves some choices or remainders modulo  @xmath0 .",
    "for example , in figure  [ fig : split ] , we will have to sum over @xmath41 possibilities of the remainders at the nodes connecting @xmath19 to  @xmath251 .",
    "the remainders assigned to the sqaure dots are equal to  0 since they are forgotten under the map  @xmath109 .",
    "assume we want to find the value of an integral over @xmath7 involving witten s class and powers of the @xmath1-classes .",
    "first , using the above lemmas we can get rid of the @xmath1-classes and reduce the problem to computing the integral of witten s class over dr - spaces . comparing the degree of witten s class @xmath262 to the dimension of a dr - cycle",
    "@xmath263 we see that such an integral can be nonzero only in 2 cases : either for genus  0 or for dr - cycles of codimension  1 in genus  1 .",
    "the genus zero integrals are well - known , while the case of double ramification divisors in genus  1 was treated in section  [ sec : formula ] .",
    "our first goal was to compute the integral of @xmath264 over the moduli spaces @xmath7 , but we actually computed such integrals over all dr - cycles satisfying the strange - looking condition @xmath230 .",
    "this generalization is unavoidable if we want to make the algorithm work .",
    "it is easy to see that even if we start with an integral over a moduli space the integral can immediately lead us to integrals over dr - cycles ."
  ],
  "abstract_text": [
    "<S> witten s top chern class is a particular cohomology class on the moduli space of riemann surfaces endowed with @xmath0-spin structures . </S>",
    "<S> it plays a key role in witten s conjecture relating to the intersection theory on these moduli spaces .    </S>",
    "<S> our first goal is to compute the integral of witten s class over the so - called double ramification cycles in genus  1 . </S>",
    "<S> we obtain a simple closed formula for these integrals .    </S>",
    "<S> this allows us , using the methods of  @xcite , to find an algorithm for computing the intersection numbers of the witten class with powers of the @xmath1-classes ( or tautological classes ) over any moduli space of @xmath0-spin structures , in short , all numbers involved in witten s conjecture . </S>"
  ]
}