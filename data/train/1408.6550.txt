{
  "article_text": [
    "mesh - construction is a fundamental step in the process of solving sets of partial differential equations numerically .",
    "although a mesh itself is an  extraneous \" element to the underlying equations of hydrodynamics ( i.e. , there is nothing in the theory that can tell us the  correct \" way to discretize space ) , a given choice of mesh can have a significant impact on the results of a numerical simulation .",
    "this is of particular importance in simulations where the hydrodynamical flows are under - resolved . in this case , the outcome on large scales can be very sensitive to the numerical and physical behavior at the resolution scale .",
    "the choice of the mesh can have as much of an impact on the numerical result as other elements of the computational methodology , such as the adequacy of the coordinate frame used , the order - of - accuracy of the scheme , or even the additional sub - resolution models implemented .",
    "given the degeneracy between the mesh and other  features \" of a numerical code , the choice of an optimal discretization approach ( whether it is through a grid - approach or a particle - based approach ) tends to depend on the problem being studied .",
    "recently , moving - mesh methods for computational hydrodynamics ( @xcite ; but see also @xcite ) , as well as novel mesh - less approaches like that of @xcite , have been shown to be an interesting and powerful tool for studying high - mach - number , large - dynamical - range astrophysical flows .",
    "high - mach - number flows are computationally challenging for several reasons .",
    "the most common complication is the so - called  high - mach number problem \" @xcite .",
    "this problem manifests itself when the kinetic energy density is much larger than the internal / thermal energy density .",
    "consequently , a small fractional error in the velocity can translate into large fractional error in temperature , eventually distorting the thermodynamic evolution of the gas .",
    "another problem is the strict limitation that the courant time - step condition imposes on high - velocity flows , which may extend the computation time beyond practicality , with the additional peril of excessive numerical noise accumulated over a large number of integration time - steps .",
    "accretion discs are an example of high - mach number flows that present serious computational difficulties . in these systems ,",
    "extremely small courant - limited time - steps are one of the greatest barriers to high - resolution simulations .",
    "in addition , interesting phenomena in these systems often evolve over many dynamical / orbital times , making numerical studies extremely expensive .",
    "the mach number of a disc is roughly the keplerian speed divided by the local sound speed @xmath0 , where the aspect ratio @xmath1 of a thin disc is @xmath2 .",
    "thus , mach numbers can reach values of 10 - 100 .",
    "the importance and ubiquitousness of accretion discs in astrophysics has propelled the development of several ( magneto- ) hydrodynamics codes specifically written to handle global models of discs .",
    "global disc simulations with grid codes over hundreds or thousands of orbits became commonplace when the fargo ( fast advection in rotating gaseous objects ; * ? ? ? * )",
    "algorithm was introduced . in this scheme ,",
    "the logic of the shearing - sheet approximation is applied to global simulations ; i.e. , the euler equations are solved in a non - inertial rotating frame .",
    "to first order , the disc is rotating at keplerian speed , thus the equations can be written in a local non - inertial frame rotating at rate @xmath3 . as a result",
    ", the courant criterion is thus based on the deviation from the background velocity in this frame , and not on the highly supersonic speed as measured in the inertial frame . besides the fargo code , schemes like rh2d @xcite , rodeo @xcite , rapid @xcite , and disco @xcite , among others , have been tailored specifically for the euler equations in cylindrical / polar coordinates for supersonic keplerian flow .",
    "some of these cylindrical - coordinate codes ( e.g. , rodeo ) were specifically designed to target the problem of planet - disc or satellite - disc interaction , namely , the tidal interaction between a disc and an embedded planet in keplerian rotation .",
    "this gravitational coupling between a planet and a gas disc has been studied in detail theoretically ( @xcite and more recently @xcite and @xcite ) as well as computationally ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "planet - disc interaction is particularly relevant for the early dynamical evolution of protoplanets and proto - planetary systems , since it is the mechanism behind disc - induced planet migration ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "the fully nonlinear integration of this problem through numerical simulation is essential for understanding the gravitational coupling between the planet and the surrounding disc , especially if the planet is massive enough to open a gap .",
    "gaps are not only important for the dynamics of planet migration , but they may also provide morphological clues about the presence of young planets around stars in observations of circumstellar discs .",
    "evidence from imaging and infrared spectroscopy showing central cavities @xcite and even narrow gaps ( e.g. , * ? ? ?",
    "* ) in gas discs opens the tantalizing possibility to infer the existence of embedded planets in gas discs ( see , for example * ? ? ?",
    "* for ongoing efforts in direct detection of these hypothetical planets ) .",
    "although the process of gap - opening by a single planet on a circular orbit embedded in a two - dimensional , isothermal disc is far too idealized to be a realistic model for planet - disc interaction , it remains an important basic test for hydrodynamic codes .",
    "the complexity of the non - linear interaction between a planet and a disc does not allow for traditional code _ verification _",
    "( ithere is no known exact solution ) , but the number of numerical experiments available in the literature allow for the very important task of code _ benchmarking_. most notably , @xcite carried out an extensive comparison of different grid - based and particle - based codes , identifying similarities and disagreements between different numerical schemes of widespread use in computational astrophysics . along the lines of this code comparison project , we apply a new numerical scheme to the problem of planet - disc interaction in the gap - opening regime .    in this work",
    ", we use the code arepo @xcite for the first time in numerical experiments of planet - disc interaction .",
    "this problem has been studied in the low - planet mass case by @xcite using the structured moving - mesh code disco .",
    "to our knowledge , an entirely freely moving mesh based on a voronoi tessellation has however not been applied successfully to this problem before .",
    "moving - mesh methods share some of the spirit of the fargo scheme , which is to solve the euler equations in a frame moving with the local flow in order to bypass the restrictions imposed by the courant criterion .",
    "however , one important difference is that arepo does not assume a priori a certain geometry and magnitude of the underlying density and velocity fields . instead",
    ", the dynamics of the mesh automatically respond to whatever evolution those fields follow .",
    "the code enables cells to move self - consistently and freely with the flow by moving a set of mesh - generating points with the local gas velocity , with the mesh defined at every instance as the voronoi tessellation of the points .",
    "this allows for a quasi - lagrangian interpretation of the tessellation : at high resolution , each cell is a parcel of gas that follows the lagrangian trajectories of the flow with a minimal change of its gas content .",
    "recently , concerns about the use of a freely - moving mesh for the planet - disc interaction problem have been raised @xcite . however",
    ", the observed limitations may well depend on details of the specific hydrodynamical scheme explored and may not necessarily appear in other tessellation codes .",
    "indeed , in this work we find that arepo is qualitatively competitive with polar grid codes in simulations of planet - disc interaction , and that there is no reason to consider the moving - mesh approach as fundamentally ill - suited to accurately capture differentially rotating flows .",
    "we begin in section  [ sec : num_exp ] by describing the numerical models and explaining the primary features of the moving - mesh approach applied to circumstellar disc dynamics . in section  [ sec : results ] , we present the main properties of our planet - disc interaction simulations , describing the results for the evolution of the density field , the vortensity and the net gravitational torque .",
    "we also compare our results to the literature . in section  [ sec : discussion ] , we discuss the implications of our implementation with respect to concerns raised in the literature about applying the moving - mesh approach to this problem .",
    "finally , in section  [ sec : summary ] , we summarize our findings and present our conclusions .",
    "[ cols= \" < , < , < , < \" , ]      all the simulations presented in this paper are carried out in units where @xmath4 and thus @xmath5 , where @xmath6 is the mass of the central object , @xmath7 is the planet mass , @xmath8 gives the planet semi - major axis , and @xmath9 the planet s orbital period .",
    "the planet - to - total mass ratio is @xmath10 .",
    "in addition , we choose @xmath11 , such that the star and the planet masses are @xmath12 and @xmath13 , respectively .",
    "this choice of units reduces the relevant physical parameters of our simulations to two : the mass ratio @xmath13 and the shearing viscosity @xmath14 . in these units ,",
    "the value of the @xmath15-viscosity coefficient @xcite at the planet s position ( @xmath16 ) is @xmath17  .",
    "table  [ tab : simulations ] lists the different physical parameters explored in this work , as well as the spatial resolution of each numerical run .",
    "[ [ surface - density - profile . ] ] surface density profile .",
    "+ + + + + + + + + + + + + + + + + + + + + + + +    typically , the surface density in circumstellar discs is modelled with a power - law profile ( i.e. @xmath18  ) .",
    "we choose our discs to have a constant surface density ( @xmath19 ) of @xmath20 , such that the enclosed mass at the planet position is @xmath21 of the mass of the star ( the disc is assumed to extend all the way to the star , beyond the inner boundary ) .",
    "note that real discs have steeper density profiles , @xmath22 @xcite .",
    "[ [ planet - mass ] ] planet mass + + + + + + + + + + +    in the units used here , the planet and star masses are determined by the single parameter @xmath13 .",
    "we have explored two values of @xmath13 : @xmath23 and @xmath24 ( table  [ tab : simulations ] ) . for a stellar mass of @xmath25 , these mass ratios correspond approximately to the planet masses of jupiter and neptune , respectively . since",
    "simulations have been shown to develop numerical artifacts if planets are added impulsively into the disc , we increase the planet mass from zero up to @xmath7 slowly in time as ( e.g. * ? ? ?",
    "* ) : @xmath26    [ [ orbital - velocity - profile ] ] orbital velocity profile + + + + + + + + + + + + + + + + + + + + + + + +    our disc simulations are started from centrifugal equilibrium and axial symmetry . from the euler equations in cylindrical coordinates ,",
    "the equilibrium and axisymmetry condition implies an azimuthal velocity that satisfies @xmath27 where the keplerian term @xmath28 is modified by a  pressure buffer \" term , resulting in an orbital velocity that is slightly sub - keplerian ( for @xmath29 ) @xmath30 where the pressure buffer term comes from the initial temperature and density gradients : @xmath31 . because in this work we use an initially constant surface density and a globally isothermal equation of state , @xmath32 , the initial rotation curve is strictly keplerian .",
    "[ [ initial - mesh ] ] initial mesh + + + + + + + + + + + +    the setup of the initial mesh is flexible and can be chosen according to the needs of the problem being simulated . in this work",
    ", we position the mesh - generating points as a series of concentric , unaligned rings , with constant separation @xmath33 in the radial direction .",
    "the same separation is imposed between points in the azimuthal direction ( i.e. , @xmath34 ) , thus keeping the cell size and cell aspect radio nearly constant throughout the computational domain . unlike polar - like meshes ( e.g. figure  [ fig : sheared_mesh ] ) , which have constant azimuthal resolution at all radii",
    ", a constant cell size implies a varying azimuthal resolution with radius .",
    "the effective resolution at the inner and outer radius , and at the planet location @xmath35 are listed in table  [ tab : simulations ] .",
    "the hill radii of the planets are @xmath36 and @xmath37 for @xmath38 and @xmath23 , respectively .",
    "this means that , for the three resolutions explored here , the hill sphere of the neptune - mass planet is 1.8 , 3.7 and 7.4 cells across , while for the jupiter - mass planet , the hill sphere is 4 , 8 and 16 cells across .",
    "the perturbed surface density profile of the disc provides a qualitative means to asses the relative performance of different numerical schemes . the key features on which we base our comparison are the overall shape of the tidal wake launched by the planet , its location with respect to the predictions from linear theory @xcite , and how far from the planet the wake is damped . for the jupiter - mass simulations ,",
    "the shape of the gap carved by the local deposition of angular momentum is an important diagnostic for the accuracy and numerical diffusivity of the code .",
    "our analysis is guided by the code comparison project of @xcite , although their model setup is not entirely identical to the one presented in section  [ sec : num_exp ] . in",
    "said comparison project , the different numerical schemes differed on the sharpness of the gap , its degree of axisymmetry , its depth , the smoothness of the remaining material , and the amount of gas retained around the orbit s lagrange points after 100 or more orbital periods .",
    "figure  [ fig : density_polar ] ( top panels ) shows the surface density field of the two inviscid fiducial simulations ( 128 radial zones ) for mass ratios of @xmath38 ( neptune - mass planet ) and @xmath39 ( jupiter - mass planet ) after 100 orbits . for easier comparison with earlier work",
    ", we have applied a coordinate transformation to the cell coordinates and converted the density field from the @xmath40-@xmath41 plane into the @xmath42-@xmath43 plane .",
    "the surface density field also includes an overlay of the shape and location of the planetary wake derived in the linear regime by @xcite , is given by @xmath44 with @xmath45 , where @xmath46 .",
    "in addition , in figure  [ fig : density_polar ] ( bottom panels ) we show equivalent runs using the fargo code @xcite with @xmath47 and @xmath48 .",
    "initial conditions and temperature structure ( globally isothermal ) are the same for the arepo and the fargo runs , as well as the location of the inner and outer boundaries and the implementation of absorbing boundary conditions . besides the obvious difference in the hydrodynamic solver , the arepo and fargo runs differ in the distribution of resolution elements .",
    "the arepo cells are initially of roughly the same size , implying a radially varying azimuthal resolution ( see table  [ tab : simulations ] .",
    "the fargo grid consists of linearly spaced radial zones and constant number azimuthal zones per radial bin , implying that cells do not have a constant aspect ratio and have area that grows proportionally to @xmath42 . at the location of the planet ( @xmath16 )",
    "both setups roughly contain the same number of azimuthal zones .",
    "after 100 planetary orbits , both the neptune - mass and jupiter - mass simulations have cleared  to different degrees  a gap in the coorbital region .",
    "arepo and fargo runs roughly agree on the width and depth of the gap , although the arepo results feature a sharper transition at the edge of the gap and slightly deeper gaps ( see section  [ sec : gap_opening ] below ) .",
    "the jupiter - mass runs retain similar amount of gas in the lagrange @xmath49 points , although the minimum density within the gap close the to planet is lower in the arepo case .    outside the gap , there is very good agreement between arepo and fargo for the neptune - mass run .",
    "the background flow in this case is solely disturbed by the spiral wake launched by the planet ; the averaged density field , in turn , barely differs from the initial condition .",
    "the jupiter - mass planet , on the other hand , does alter the background mean flow significantly , in part owing to the larger amplitude of the spiral wake ( in the linear regime , the amplitude of the wake is proportional to @xmath7 ) and to the density bump caused by material being displaced from the coorbital region .",
    "indeed , a significant part of the mass in the coorbital region is relocated right outside the gap edge .",
    "this gas pile - up is more pronounced in the fargo simulations ( very significantly in the jupiter - mass case , but also to some degree in the neptune - mass case ) .",
    "the deviations from a uniform density field in the @xmath39 simulations are largest outside the edge of the gap , and exhibit time variability ( in both fargo and arepo ) .",
    "this is in contrast with the @xmath38 simulations , in which , aside from a gradually carved shallow gap , the density field is nearly stationary for 100 orbits .",
    "the jupiter - mass fargo run seems more violently unstable than its arepo equivalent .",
    "the large amplitude density fluctuation in this case are attributed to  edge instabilities \" and vortices in the disc ( e.g. , @xcite ; see section  [ sec : vortensity ] below ) , which have been previously observed in numerical simulations by @xcite , @xcite and @xcite .",
    "we have confirmed that the appearance of these transient features is favored by higher resolution , and eventually it even takes place for the neptune - mass simulation with both arepo and fargo .",
    "the tidal wake launched in a disc is a result of waves excited by a perturber moving at supersonic speeds and its shape arises as the superposition of all harmonics . in the linear regime , the wake shape asymptotically reaches a stationary profile @xcite and its amplitude is proportional to the planet mass ( e.g. * ? ? ? * ; * ? ? ?",
    "these waves carry angular momentum , and unless they remain non - dispersive ( i.e. the in linear regime ) throughout the computational domain and for the full extent of the integration time , some damping process will couple these waves to the disc fluid , triggering the transfer of angular momentum to the gas , resulting in the evolution of the background density field .",
    "well into the non - linear regime , the deposition of angular momentum into the disc is expected to open a gap in the coorbital region if the planet is massive enough .",
    "one of the gap - opening criterions found in the literature is the",
    " thermal criterion \" of @xcite .",
    "this criterion states that a planet of mass @xmath7 will open a gap in the disc if @xmath50 which roughly corresponds to the case in which the planet s hill radius is comparable to the disc scale height .    for the parameters used in the present work , the so - called thermal mass @xmath51 is @xmath52 , which is slightly above the neptune - mass planet ( @xmath53 ) , and eight times smaller than the jupiter - mass planet ( @xmath54 ) , thus our results in shown in figure  [ fig : density_polar ] fall within expectations according to this criterion . for a further discussion of gap - opening and its dependence on resolution and viscosity coefficient , see section  [ sec : gap_opening ] below .",
    "note that once there is a gap present , the gravitational coupling between the disc and the planet can not be calculated in the linear regime assuming a uniform background density , since this will lead to erroneous estimates of the tidal torque density @xcite .",
    "not only does the torque density profile in gapped systems differ from the original calculation of @xcite but also the shape of the tidal wake differs . while in the neptune - mass simulations",
    "the gap is not deep enough to significantly alter the shape of the wake compared to the theoretical results in the linear regime ( figure  [ fig : density_polar ] , left panel ) , the jupiter - mass runs ( figure  [ fig : density_polar ] , right panel ) show an evident mismatch between the theoretical wake position and the actual density maxima of the wake .     at three different times ( 10 , 50 and 100 orbits ) .",
    "thick lines correspond to the arepo run ( top left panel of figure  [ fig : density_polar ] ) and thin lines correspond to the equivalent fargo ( bottom left panel of figure  [ fig : density_polar ] ) .",
    "bottom panel : same as top panel but with @xmath39 .",
    "[ fig : gap_profile],title=\"fig:\",scaledwidth=48.0% ]   at three different times ( 10 , 50 and 100 orbits ) .",
    "thick lines correspond to the arepo run ( top left panel of figure  [ fig : density_polar ] ) and thin lines correspond to the equivalent fargo ( bottom left panel of figure  [ fig : density_polar ] ) .",
    "bottom panel : same as top panel but with @xmath39 .",
    "[ fig : gap_profile],title=\"fig:\",scaledwidth=48.0% ]    figure  [ fig : gap_profile ] presents the evolution of the ( azimuthally averaged ) surface density profile for the neptune - mass ( top panel ) and jupiter - mass ( bottom panel ) planets at three different times for each numerical integration , showing how a shallow gap is carved in the former case , and a deep gap in the latter .",
    "thick lines correspond to our fiducial arepo runs , and thin lines to the equivalent fargo runs ( same simulations as in figure  [ fig : density_polar ] ) . in the neptune - mass case ,",
    "the density field features a dip within the coorbital region of about @xmath55 of its initial value after 100 orbits .",
    "this deficit increases to over @xmath56 in the jupiter - mass case .",
    "although the width and depth of the gap are roughy consistent between the arepo and fargo runs , these seem to diverge with respect to each other in time , as can be readily noticed for the @xmath38 simulations at 100 orbits .    as mentioned above , the most striking difference between arepo and fargo is the magnitude of the density bumps at the edges of the gap .",
    "this disagreement is more pronounced for the inner edge .",
    "the in / out asymmetry suggests that resolution may be to blame because the number of azimuthal zones increases with radius ( table  [ tab : simulations ] ) .",
    "figure  [ fig : gap_profile ] demonstrates that the mass deficit in the inner edge of the gap grows with time .",
    "this growth might be related to the lack of angular momentum conservation or angular momentum diffusion combined with an absorbing boundary condition .",
    "as the inner density bump starts to develop ( e.g. , red curves in figure  [ fig : gap_profile ] , bottom panel ) , it is already wider in the arepo case , ending at the edge of the wave absorbing region .",
    "this can lead to a  leakage \" of mass through the boundary , since over - densities will be damped out , in turn violating mass conservation ( see * ? ? ?",
    "thus , the disagreement in the density profile of the inner disc can only worsen with time .",
    "mass loss seems to take place in our low resolution jupiter - mass run , but higher - resolution runs do reveal a local density maximum in the inner disc close to the edge of the wave - absorbing region ( see section  [ sec : viscosity_resolution ] below ) .",
    "local non - conservation of angular momentum resulting from certain type of integrators can be the cause of spurious evolution of gaps in disc simulations ( see e.g. , * ? ? ?",
    "we know that arepo does not conserve angular momentum exactly because of two reasons : ( 1 ) owing to the solving of the euler equations in a cartesian formulation , and ( 2 ) owing to the inclusion of the gravitational acceleration as a source term evaluated at the cell centers .",
    "since the cells bulk velocities are updated via a well - validated leapfrog algorithm , we expect the second of these effects to non cumulative and therefore of lesser importance .",
    "the first effect however , can produce artifacts at low resolution .",
    "in practice , a cell s bulk angular momentum can be lost to the cell s inner circulation or  cell spin \" , which can not be properly captured by the linear reconstruction of the velocity field .",
    "this is obviously a function of resolution , but also a function of the shear rate ( and , to a lesser extent , the local density gradient ) .",
    "since our radial resolution is nearly constant , we expect local shear rate ( @xmath57 ) to be responsible for the inner region of the disc suffering from angular momentum loss most significantly .",
    "the fact that the shear is set almost entirely by the keplerian potential , means that this effect has a constant sign and will act cumulatively .",
    "this might explain why material in the inner region is smoothly transported to the absorbing boundary ( figure  [ fig : gap_profile ] ) .",
    "@xcite discussed the numerical creation and destruction of angular momentum for disc simulations using rotating - frame , cylindrical - coordinates schemes in which the coriolis term is included as a source term rather than as a a flux divergence in the angular momentum conservation equation .",
    "although an entirely different numerical scheme , the numerical bias identified by @xcite in some integration schemes bears some resemblance to what we have called cell spin , in the sense that it arises due to the evaluation of angular momentum source terms at the center of cells , rather than calculating how much angular momentum enters and leaves a cell through its interfaces . although not considered within the present work , we explore this effect in further depth in @xcite , suggesting alternatives to better deal with angular momentum trapped as cell spin . for now , we confirm that this effect is indeed resolution dependent , and that the deficit in the density bump is significantly diminished by using moderately higher resolution ( section  [ sec : viscosity_resolution ] ) .",
    "qualitatively , our results are in agreement with the thermal criterion of equation  ( [ eq : gap_opening ] ) , which states that our jupiter - mass simulations should open a gap while the neptune - mass runs should not .",
    "however , the thermal criterion has been questioned by recent evidence of planets with masses smaller than the thermal mass being able to open gaps ( e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "objections to the thermal criterion were raised by @xcite ( see also * ? ? ?",
    "* ; * ? ? ?",
    "* ) , whose calculations showed that deposition of angular momentum from the launched waves onto the disc leading to clearing of the gap can happen for planet mass smaller than @xmath51 if these waves steepen into shocks at a finite distance from the planet @xmath58 : latexmath:[\\[\\label{eq : shock_distance }    after breaking , the wave s angular momentum is gradually transferred to the disc , which in turns leads to density evolution and the possibility of clearing a gap , even for planet masses below @xmath51 @xcite    evidently , wave steepening depends on grid resolution , thus for inviscid simulations , the gap shape and depth will depend on whether the angular momentum is injected into the disc by shock dissipation or by a viscous - like dissipation onto the computational grid .",
    "this is why high - resolution simulations are required @xcite for gaps to be seen at small values of @xmath13 ( @xmath60 ) , since otherwise numerical diffusivity can mimic the gap - filling consequence of physical viscosity .    for the isothermal ( @xmath61 ) examples shown here , and recalling",
    "that the planet mass in the neptune case is @xmath62 , the shock distance given by equation  ( [ eq : shock_distance ] ) is @xmath63 . for the jupiter case ( @xmath64 )",
    ", we have @xmath65 . note",
    "that , in the vicinity of the planet , the radial extent of a voronoi cell at @xmath66 is @xmath67 , @xmath68 and @xmath69 , for @xmath70 and @xmath71 , respectively .",
    "therefore , the shock distance is not resolved at all for the lowest resolution runs .",
    "furthermore , the shock distance for the jupiter - mass case is smaller than @xmath72 , the gravitational softening used in our simulations ( as in * ? ? ?",
    "* ) since this value gives 2d torque magnitudes closer to their corresponding 3d values ( see * ? ? ?",
    "] , thus the precise gap - opening mechanism can not be adequately captured in these simulations .",
    "orbits with @xmath38 .",
    "in addition to the azimuthal means ( solid curves ) , 1-@xmath73 ( one standard deviation ) shaded areas are added to quantify deviations from axial symmetry .",
    "top panel : profiles for inviscid simulations at three different resolutions , with @xmath47 ( red ) , 256 ( blue ) and 512 ( green ) .",
    "bottom panel : profiles for viscous simulations ( @xmath74 ) at the same 3 resolutions .",
    "[ fig : nep_gap_profile],title=\"fig:\",scaledwidth=45.0% ]  orbits with @xmath38 .",
    "in addition to the azimuthal means ( solid curves ) , 1-@xmath73 ( one standard deviation ) shaded areas are added to quantify deviations from axial symmetry .",
    "top panel : profiles for inviscid simulations at three different resolutions , with @xmath47 ( red ) , 256 ( blue ) and 512 ( green ) .",
    "bottom panel : profiles for viscous simulations ( @xmath74 ) at the same 3 resolutions .",
    "[ fig : nep_gap_profile],title=\"fig:\",scaledwidth=45.0% ]     but for a mass ratio of @xmath39 .",
    "[ fig : jup_gap_profile],title=\"fig:\",scaledwidth=45.0% ]   but for a mass ratio of @xmath39 .",
    "[ fig : jup_gap_profile],title=\"fig:\",scaledwidth=45.0% ]      the surface density field in polar coordinates emphasizes the departure from axial symmetry of the density gap cleared by the jupiter - mass planet ( figure  [ fig : density_polar ] , right panel ) .",
    "this is something to be aware of in moving - mesh codes , which are known to develop morphological asymmetries somewhat faster than fixed grid codes ( c.f .",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "the early development of asymmetries during the growth of instabilities can be seeded by  grid noise \" arising even in initially symmetric initial conditions . in moving - mesh codes",
    ", grid noise tends to have a greater influence because it is not only composed of round - off errors in the flux calculation in different directions , but also of truncation errors in the mesh - drifting algorithm .",
    "the finite accuracy with which the locations of the mesh - generating points are evolved propagates to the geometry calculation of cell face centers , ultimately affecting the evolution of the fluid quantities .",
    "this problem is absent in structured mesh codes , especially since they often implement  symmetric sweeping \" of the grid faces to preserve the symmetries of the flow to greater accuracy ( cf .",
    "the examples of oblique 2-d shock tubes in athena ; see also @xcite ) . for discussions on symmetric sweeping",
    "we refer the reader to @xcite and @xcite .",
    "although the amplification of asymmetries in the flow can be favored by a moving - mesh , they are _ not generated _ by the mesh itself in our planet - disc interaction simulations . to test this",
    ", we compare the density field in our fiducial inviscid simulations ( @xmath38 and @xmath39 ) at different times , looking for transients . aside from a gradually carved shallow gap ,",
    "the background density in the neptune - mass case is nearly stationary over a period of 100 orbits , with no sign of instabilities or transient over - densities . in the jupiter - mass simulation ,",
    "on the other hand , the density field outside the gap shows variations that can be of the order of the density peaks associated with the spiral wake .",
    "thus , the development of strong density bumps and vortices outside the gap in the jupiter - mass case is not a feature of arepo but a consequence of the large gap carved out by the planet , corresponding to the  edge instabilities \" previously observed in numerical simulations by @xcite , @xcite and @xcite .",
    "these edge effects are usually associated with vortices right outside the gap @xcite , which are present in our jupiter - mass simulations , but absent in the neptune - mass runs ( see section  [ sec : vortensity ] below ) .",
    "as seen from the right panels of figure  [ fig : density_polar ] , the jupiter - mass arepo runs are at most as unstable as the fargo runs .",
    "we have confirmed that this effect increases with resolution and eventually happens even for the neptune - mass simulation with both arepo and fargo .",
    "therefore , we conclude that the sensitivity to the development of asymmetries does not arise spontaneously in arepo , but only in hydrodynamically unstable regimes . the importance of the preservation of symmetries ( which do not occur in nature ) well into the non - linear regime in an unstable configuration is a matter of debate among researchers ( e.g. , * ? ? ?",
    "although we do not believe it is a critical component of a hydrodynamical scheme , future work should address pathological cases in which grid noise might affect the convergence rate in a code like arepo .",
    "+      +      +              +      +      +          viscosity ( or viscosity - like numerical diffusivity ) not only affects the mechanism by which gaps form , but also the long term balance between the tidal torque and the viscous torque @xcite . balancing the angular momentum flux of these two competing effects , @xcite",
    "find a  viscous criterion \" for gap formation of the form @xmath75 which , for the disc parameters of this work , reduces to @xmath76 .",
    "this inequality means that the critical mass ratio @xmath77 should be above @xmath78 for a viscosity coefficient of @xmath74 ( @xmath79 at the planet position ) ; i.e. , the neptune - mass case is again border - line capable of opening a gap .",
    "figure  [ fig : nep_gap_profile ] shows the azimuthally - averaged surface density field for the inviscid ( top panel ) and the viscous ( bottom panel ) neptune simulations after 100 orbits for three different resolutions : @xmath47 , 256 and 512 .",
    "the surface density profiles include a 1-@xmath73 contour to quantify the degree of axisymmetry in the disc .",
    "there is no convergence in the inviscid simulations , while very good consistency is found in the viscous runs across the different resolutions , in addition to uniformity in the azimuthal direction .",
    "similarly , figure  [ fig : jup_gap_profile ] shows the azimuthally - averaged surface density profile for the jupiter - mass simulations for three different resolutions . in the inviscid case , the edge instabilities cause much wilder variations than in the neptune analog , and grow in amplitude as resolution is increased , eventually affecting both inner and outer edges of the gap . in the viscous case ,",
    "the flow is smoother and deviations from the azimuthal mean are smaller , although the 1-@xmath73 contours still show broader scatter than in the neptune - mass case .",
    "this lack of a converging trend is probably due to the fact that the edge instabilities are not entirely suppressed by a viscosity of @xmath74 , and that the gap is deep enough to make the instability effective .",
    "a grid of models with varying resolution ( @xmath47 , 256 and 512 ) and viscosity coefficient ( @xmath80 , @xmath81 , @xmath82 and @xmath24 ) is shown in figures  [ fig : neptune_density_frames ] and  [ fig : jupiter_density_frames ] . according to the viscous gap - opening criterion of equation  ( [ eq : viscous_criterion ] ) , we find that the critical mass ratio @xmath83 is @xmath84 and @xmath85 , for @xmath86 and @xmath87 , respectively . therefore , with @xmath86 ( @xmath88 at @xmath16 ) ,",
    "gap formation should be suppressed for the neptune - mass planet and significantly affected for the jupiter - mass planet .",
    "these very viscous runs ( bottom rows of figures  [ fig : neptune_density_frames ] and  [ fig : jupiter_density_frames ] ) show a high degree of smoothness , and no evident dependence on resolution , even for the jupiter - mass case .    for @xmath87 ( @xmath89 at @xmath16 ) , both the neptune - mass and the jupiter - mass planets should be able to open partial or full gaps , provided numerical diffusion is less important than physical viscosity .",
    "this is easily satisfied by the jupiter - mass run at all explored resolutions ( second row from top in figure  [ fig : jupiter_density_frames ] ) , but not so clearly for the neptune - mass case , for which the @xmath47 run is indistinguishable from the inviscid run , while the @xmath90 version is able to open a sharp gap .",
    "the quasi - lagrangian nature of our scheme can be seen in the very high density of gas at the planet position ( figure  [ fig : jup_gap_profile ] ) .",
    "this effect appears to be enhanced with increasing viscosity . since high - viscosity ( e.g. second row from the top in figure  [ fig : jupiter_density_frames ] ) suppresses the formation of deep gaps , the gas supply onto the planet is not halted and thus sustained accretion can proceed .",
    "this accretion of gas translates to a high concentration of cells within the planet s hill sphere ( figure  [ fig : planet_wmesh ] ) .",
    "interestingly , this property of moving - mesh schemes opens up new possibilities to overcome the strict resolution requirements imposed by the detailed hydrodynamics of gap clearing .",
    "for example , figure  [ fig : planet_wmesh ] shows a high concentration of cells close to the planet , which allows for the study of circumplanetary discs within _ global _ circumstellar disc simulations , combining a coarse large - scale disc with a very high resolution hill sphere region , thus concentrating all the computational power in the regions of interest ; this provides an alternative to attempts to implement adaptive mesh refinement in cylindrical coordinates , which has resulted to be very difficult in the past .",
    "recently , adaptive refinement has been successfully implemented in cylindrical codes by @xcite , allowing for unprecedentedly detailed , high - resolution studies of circumplanetary flow .",
    "of course , a refined polar grid at the scales of the planet s hill sphere is still nearly cartesian , a restriction that does not exist for the moving mesh .",
    "similarly , figure  [ fig : planet_wmesh ] shows how the spiral wakes also concentrate a larger number of cells than the background flow .",
    "this property of moving - mesh methods can provide an alternative to the extremely high resolution studies that have been carried out by @xcite and @xcite , concentrating the resolution elements specifically on the wake .",
    "( in units where @xmath35 ) , centered on the planet position at @xmath91 orbits .",
    "bottom panel : zoomed - in region of side length equal to @xmath92 , roughly twice the planet s hill sphere . the concentration of cells toward the potential well minimum increases the resolution within the hill sphere roughly by a factor of @xmath93-@xmath94 with respect to the initial cell spacing . in this case , the hill radius is @xmath95 , corresponding to 4 , 8 and 16 cells across at @xmath66 for the runs with @xmath47 , 256 and 512 , respectively .",
    "however , after 100 orbits , the hill sphere can have up to 200 cells across the disc in the viscous run with @xmath74 and @xmath90 .",
    "if the entire simulation had been run with a globally uniform cell size like that obtained within the hill sphere , the number of radial zones would have been @xmath96 , a resolution comparable to the one used by @xcite and @xcite .",
    "[ fig : planet_wmesh],title=\"fig:\",scaledwidth=48.0% ]   ( in units where @xmath35 ) , centered on the planet position at @xmath91 orbits .",
    "bottom panel : zoomed - in region of side length equal to @xmath92 , roughly twice the planet s hill sphere .",
    "the concentration of cells toward the potential well minimum increases the resolution within the hill sphere roughly by a factor of @xmath93-@xmath94 with respect to the initial cell spacing . in this case",
    ", the hill radius is @xmath95 , corresponding to 4 , 8 and 16 cells across at @xmath66 for the runs with @xmath47 , 256 and 512 , respectively .",
    "however , after 100 orbits , the hill sphere can have up to 200 cells across the disc in the viscous run with @xmath74 and @xmath90 .",
    "if the entire simulation had been run with a globally uniform cell size like that obtained within the hill sphere , the number of radial zones would have been @xmath96 , a resolution comparable to the one used by @xcite and @xcite .",
    "[ fig : planet_wmesh],title=\"fig:\",scaledwidth=48.0% ]                                  the vorticity field provides another powerful numerical diagnostic in planet - disc interaction simulations .",
    "in particular , we are interested in the vortensity ( or `` potential vorticity '' ) field @xmath97 , defined as @xmath98 , where @xmath99 , since the radial variability of this quantity is what is the source of edge instabilities observed in gap - opening simulations .",
    "@xcite and @xcite found that a keplerian disc is unstable to azimuthal perturbations when the following quantity reaches a local extremum @xmath100 in a barotropic disc , @xmath101 , where @xmath102 is the orbital angular velocity and @xmath103^{1/2}$ ] is the epicyclic frequency , which can be related to the @xmath104-component of the vorticity for _ axisymmetric flow _ by @xmath105 .",
    "therefore , for the globally isothermal case ( i.e. , @xmath61 ) , @xmath106 equation  ( [ eq : rwi ] ) implies that local extrema in the radial vortensity profile can trigger the rossby wave instability @xcite , which saturates into vortices that are efficient at destroying the extremum in vortensity ( e.g. * ? ? ?",
    "however , the presence of a massive planet can sustain the density bump , enabling a sustained production of vortices @xcite .",
    "thus , a numerical scheme s capability of producing steep vortensity gradients at the edge of a planet - carved gap translates directly into the production of the edge instabilities observed in the surface density field .",
    "since our simulations are run using an inertial reference frame , we obtain the _ absolute _ vorticity @xmath107 directly from the interpolated velocity field . in order to obtain the _ relative _ vorticity ( i.e.",
    ", the vorticity as seen in the frame rotating with the planet ) we simply subtract @xmath108 , i.e. , the vorticity associated with the background flow .",
    "the relative vortensity @xmath109 is then @xmath110 which we normalize by @xmath111 .",
    "we calculate @xmath112 for three different resolutions in the inviscid neptune , the viscous neptune , the inviscid jupiter and the viscous jupiter cases .",
    "the normalized vortensity fields are shown in figure  [ fig : neptune_vortensity ] for neptune , and figure  [ fig : jupiter_vortensity ] for jupiter . as discussed in section  [ sec : gap_opening ] , the inviscid runs should be expected to converge slowly , since higher resolution runs will be effectively less diffusive , and the appearance of vortices should increase with increasing resolution , as a consequence of sharper gaps . indeed , both inviscid examples ( top rows in figures  [ fig : neptune_vortensity ] and  [ fig : jupiter_vortensity ] ) show an increase in the number of vortices every time the resolution is improved .",
    "the inviscid neptune runs at @xmath113 and @xmath90 show the vortensity rings described by @xcite .",
    "the different vortensity fields for the viscous runs are nearly indistinguishable from each other , confirming that a viscosity of @xmath74 is enough to suppress the shock - induced generation of vortensity .",
    "we do expect the viscous runs to show some degree of convergence .",
    "interestingly , there is consistency between the @xmath113 and @xmath90 run , for both the neptune and jupiter cases , but the @xmath47 case clearly stands out as unconverged .",
    "this confirms our previous observation that 128 radial zones might not be enough to capture the global flow properly , especially if vortices are expected to develop .",
    "some of the sharp vortensity features obtained by other cylindrical grid codes can not be reproduced entirely here at the fiducial resolution of @xmath47 ( left panels in figures  [ fig : neptune_vortensity ] and  [ fig : jupiter_vortensity ] ) .",
    "indeed , the vortensity peaks found near the edges of the partial gap in the neptune simulations are shallower in our example . in addition , we see less structure within the gap .",
    "the jupiter run , on the other hand , does show a sharp transition in vortensity across the edge of the gap , and succeeds in capturing the vortensity  islands \" at the @xmath49 lagrange points , which is not achieved by all codes ( see , for example , * ? ? ?",
    "also , the vortensity field is devoid of reflections from the boundaries , which shows that our absorbing boundary condition is effective at eliminating such artifacts .",
    "the vortensity features in inviscid runs with @xmath114 ( for both neptune and jupiter examples ) are significantly sharper and richer than those of @xcite .",
    "therefore , we believe that to achieve results comparable to those of well established codes for planet - disc interaction , we would need a number of radial zones lower than 256 but higher than 128 .",
    "we also point out the effective azimuthal resolution at @xmath115 in our fiducial runs is @xmath116 , still below the @xmath48 used in the fargo simulations we have included for comparison , as well as in the simulations of @xcite .     at three different resolutions : @xmath47 ( top panel ) , 256 ( mid panel ) and 512 ( bottom panel ) , corresponding to runs ` jup - visc - b_128 ` ,",
    "` jup - visc - b_256 ` and ` jup - visc - b_512 ` , respectively .",
    "the total torque at @xmath91 orbits is consistent across all resolutions , although the magnitude of the inner and outer torques of the highest resolution run differs from the rest .",
    "the transient stage of the torque calculation ( up to @xmath117 orbits ) shows no hints of convergence .",
    "material within the hill sphere of the planet has been excluded in the measurement .",
    "[ fig : jup - visc_torque],title=\"fig:\",scaledwidth=38.0% ]   at three different resolutions : @xmath47 ( top panel ) , 256 ( mid panel ) and 512 ( bottom panel ) , corresponding to runs ` jup - visc - b_128 ` , ` jup - visc - b_256 ` and ` jup - visc - b_512 ` , respectively .",
    "the total torque at @xmath91 orbits is consistent across all resolutions , although the magnitude of the inner and outer torques of the highest resolution run differs from the rest .",
    "the transient stage of the torque calculation ( up to @xmath117 orbits ) shows no hints of convergence .",
    "material within the hill sphere of the planet has been excluded in the measurement .",
    "[ fig : jup - visc_torque],title=\"fig:\",scaledwidth=38.0% ]   at three different resolutions : @xmath47 ( top panel ) , 256 ( mid panel ) and 512 ( bottom panel ) , corresponding to runs ` jup - visc - b_128 ` , ` jup - visc - b_256 ` and ` jup - visc - b_512 ` , respectively .",
    "the total torque at @xmath91 orbits is consistent across all resolutions , although the magnitude of the inner and outer torques of the highest resolution run differs from the rest .",
    "the transient stage of the torque calculation ( up to @xmath117 orbits ) shows no hints of convergence .",
    "material within the hill sphere of the planet has been excluded in the measurement .",
    "[ fig : jup - visc_torque],title=\"fig:\",scaledwidth=38.0% ]     but for a neptune - mass planet ( runs ` nep - visc - b_128 ` , ` nep - visc - b_256 ` and ` jup - visc - b_512 ` , from top to bottom ) .",
    "the net torque toward the end of the simulation is @xmath118 .",
    "convergence is achieved with resolution , albeit slowly for separate inner and outer torques .",
    "there is a trade - off in comparison to the jupiter - mass case : since the density fluctuations due to the planet wake are weaker , the smaller the planet mass , the higher the resolution is needed to recover the theoretically expected negative net torque ; on the upside , the smoother variation of this configuration ( there is no gap opening ) guarantees that a consistent solution can be reached with high enough resolution , as opposed to the transient - plagued torque evolution of figure  [ fig : jup - visc_torque ] .",
    "[ fig : nep - visc_torque],title=\"fig:\",scaledwidth=35.0% ]   but for a neptune - mass planet ( runs ` nep - visc - b_128 ` , ` nep - visc - b_256 ` and ` jup - visc - b_512 ` , from top to bottom ) .",
    "the net torque toward the end of the simulation is @xmath118 .",
    "convergence is achieved with resolution , albeit slowly for separate inner and outer torques .",
    "there is a trade - off in comparison to the jupiter - mass case : since the density fluctuations due to the planet wake are weaker , the smaller the planet mass , the higher the resolution is needed to recover the theoretically expected negative net torque ; on the upside , the smoother variation of this configuration ( there is no gap opening ) guarantees that a consistent solution can be reached with high enough resolution , as opposed to the transient - plagued torque evolution of figure  [ fig : jup - visc_torque ] .",
    "[ fig : nep - visc_torque],title=\"fig:\",scaledwidth=35.0% ]   but for a neptune - mass planet ( runs ` nep - visc - b_128 ` , ` nep - visc - b_256 ` and ` jup - visc - b_512 ` , from top to bottom ) .",
    "the net torque toward the end of the simulation is @xmath118 .",
    "convergence is achieved with resolution , albeit slowly for separate inner and outer torques .",
    "there is a trade - off in comparison to the jupiter - mass case : since the density fluctuations due to the planet wake are weaker , the smaller the planet mass , the higher the resolution is needed to recover the theoretically expected negative net torque ; on the upside , the smoother variation of this configuration ( there is no gap opening ) guarantees that a consistent solution can be reached with high enough resolution , as opposed to the transient - plagued torque evolution of figure  [ fig : jup - visc_torque ] .",
    "[ fig : nep - visc_torque],title=\"fig:\",scaledwidth=35.0% ]      finally , we consider the measurement of the tidal torques . ultimately , a successful planet - migration simulation will be determined by the accurate calculation of the tidal torques , since these determine the rate of change of the planet s angular momentum .",
    "the tidal torque exerted by the disc onto the planet is @xmath119 , \\end{split}\\ ] ] where @xmath120 and @xmath121 is the spline - softened gravitational force function @xcite , which evaluates to the exact keplerian value of @xmath122 for @xmath123 , with @xmath124 being the traditional plummer softening parameter .",
    "we discretize equation  ( [ eq : torque_formula1 ] ) as @xmath125,\\ ] ] summing over all gas cells of masses @xmath126 , and using @xmath127 , where @xmath128 is the cell centroid .",
    "the cells within the planet s hill sphere , i.e. , @xmath129 , are excluded from the sum in equation  ( [ eq : torque_formula2 ] ) . for a globally isothermal disc with constant background density profile ,",
    "the linear theory net torque ( lindblad plus corotation torques ) in two dimensions is given by @xcite @xmath130 which equals @xmath131 for @xmath39 and @xmath132 for @xmath38 , implying type - i migration timescales @xmath133 of @xmath134 and @xmath135 , respectively .",
    "we have computed the torque time series according to equation  ( [ eq : torque_formula2 ] ) for all our simulations . to faciliate the analysis of the torque over long timescales , we have created smoothed versions of these time series by applying a hamming filter with window length of 2 and 10 orbits . at the end of the simulations , the smoothed torque is consistently slightly negative , consistent with an inward migration of the planet .",
    "the measured torque toward the end of the jupiter - mass run is @xmath136 in units where @xmath5 and @xmath137 , which is about one order of magnitude smaller than the total torque value predicted by equation  ( [ eq : torque_theory ] ) . on the other hand ,",
    "the torque value for the neptune - mass run is @xmath138 , roughly consistent with the value from linear theory .",
    "the significant discrepancy between the measured torque and linear theory in the @xmath39 case ( equation  [ eq : torque_theory ] gives a torque value of @xmath139 ) is not surprising due to the strong non - linearity of the simulation , but also because the carved out gap is sufficiently deep to drastically change the gravitational coupling to the disc @xcite , decreasing the magnitude of the lindblad torque .",
    "as discovered by @xcite , the total lindblad torque of a gapped disc with minimum gap density @xmath140 is closer to the lindblad torque of a density disc with background density @xmath141 rather than @xmath142 in equation  ( [ eq : torque_theory ] ) .",
    "this partially explains why the measured torque in our runs is an order of magnitude smaller than the value predicted by equation  ( [ eq : torque_theory ] ) .    despite the consistently negative _",
    "smoothed _ tidal torques measured toward the end of our simulations , _ raw _ torque time series may tell a different story . for the jupiter - mass simulations , the small scale asymmetric features observed in the density field ( section  [ sec : density_field ] )",
    "are large enough that they can alter the torque onto the planet significantly , even to the point of changing its sign on timescales comparable with the planet s orbital period .",
    "these fluctuations , identified as vortices in our simulations , are a phenomenon observed previously by @xcite , @xcite and @xcite . in some cases",
    ", the planet - disc torque can be dominated by planet - vortex scattering @xcite triggering a runaway migration sometimes referred to as type iii migration ( see also * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "since this type of migration depends sensitively on the vortensity field within the coorbital region , the exclusion of the hill sphere from the torque calculation might produce drastically different results compared to a fully consistent , self - gravitating planet - disc interaction ( e.g. * ? ? ?",
    "although this behavior is not observed in the fiducial inviscid neptune - mass run , edge instabilities do appear as resolution is increased ( see density fields in the top panels of figure  [ fig : neptune_density_frames ] ) , a result that we have confirmed with fargo runs .",
    "thus , torque calculations as a mean to assess numerical convergence may not produce conclusive results , unless the variability can be suppressed by a physical mechanism such as viscosity .",
    "another source of fluctuations in the measured torque is provided if the hill sphere material is included in the calculation of equation  [ eq : torque_formula2 ] .",
    "the fluctuating density in this region can produce significant noise in the torque measurement for the jupiter - mass simulations .",
    ", on the other hand , the inclusion of the hill sphere has little effect on the measured torque in the neptune - mass simulations ; in fact , its inclusion results in smaller fluctuations on the net torque calculation .    in order to assess the reliability of the torque calculation",
    ", we measure @xmath143 at three different resolutions ( @xmath47 , 256 and 512 ; see table  [ tab : simulations ] ) .",
    "since we do not expect the inviscid runs to converge given the high sensitivity of this problem to diffusion ( whether it is of numerical or physical origin ) , we explore the convergence of the torque evolution for the viscous runs with @xmath74 .",
    "figure  [ fig : jup - visc_torque ] shows the torque evolution for the viscous jupiter - mass runs at the three different resolutions listed in table  [ tab : simulations ] .",
    "although the qualitative torque evolution is very consistent across the different resolutions , the transient period ( @xmath144  orbits ) shows a non - converging behavior .",
    "note that the location and shape of this variability , which does not vanish after applying a time - series smoothing , is not entirely inconsistent across the different panels .",
    "however , the amplitude of these transients grows with resolution , indicating that a viscosity of @xmath74 is not high enough to suppress vorticity generation near the coorbital region that can generate chaotic variations in the net torque .",
    "note that the net torque at @xmath91  orbits is very consistent across all resolutions , showing a robust convergence of the planet s migration rate . in the near - stationary regime ( @xmath145  orbits ) , the individual components of the torque ( the inner and outer contributions ) are independently consistent with each other for the @xmath47 and @xmath113 runs . however , and despite a consistent net torque , the individual components show a discrepancy at @xmath90 .",
    "still higher resolution runs are hence required to settle whether these simulations are converged in all relevant aspects .",
    "figure  [ fig : nep - visc_torque ] shows better convergence than figure  [ fig : jup - visc_torque ] .",
    "the smaller perturbation exerted on the disc by a neptune - mass planet implies that the torque magnitude can be more easily  buried \" by the noise than in the jupiter - mass case since now the outer and inner torques are fractionally much closer in value than in the jupiter - mass cases .",
    "the separation between inner and outer torques might prove ambiguous in a moving - mesh code , since cells centers can switch from the inner to the outer region and vice - versa from one time step to the next .",
    "similarly , cells can enter and leave the hill sphere , introducing fluctuations in the inferred gravitational torque if it is computed by treating cells as point masses .",
    "this explains in great part the fluctuations in the torque calculation .",
    "as opposed to the wildly varying density field in the jupiter - mass calculation , the quasi - stationarity of the neptune case provides more reassurance that convergence can be reached . indeed , although a resolution of @xmath90 is needed to beat down the fluctuations , convergence can be observed in figure  [ fig : nep - visc_torque ] , showing that a slight asymmetry between the inner and outer torques will cause an inward migration of the planet .       and a temperature profile of @xmath146 using arepo ( upper panel ) and fargo ( lower panel ) .",
    "the torque averaged over the interval between 175 and 200 orbits is @xmath147 ( internal units ) in the arepo run and @xmath148 ( internal units ) using fargo .",
    "although the total torque toward the end of the run is roughly consistent in both calculations ( within a factor of two ; see table  [ tab : torque_results ] ) , the inner and outer torques differ by about a factor of three ( outer torque ) to six ( inner torque ) between the two numerical schemes .",
    "[ fig : arepo_fargo_torque],title=\"fig:\",scaledwidth=48.0% ]   and a temperature profile of @xmath146 using arepo ( upper panel ) and fargo ( lower panel ) .",
    "the torque averaged over the interval between 175 and 200 orbits is @xmath147 ( internal units ) in the arepo run and @xmath148 ( internal units ) using fargo .",
    "although the total torque toward the end of the run is roughly consistent in both calculations ( within a factor of two ; see table  [ tab : torque_results ] ) , the inner and outer torques differ by about a factor of three ( outer torque ) to six ( inner torque ) between the two numerical schemes .",
    "[ fig : arepo_fargo_torque],title=\"fig:\",scaledwidth=48.0% ]    in the numerical experiments described above , we have used a globally isothermal equation of state to model the circumstellar disc .",
    "this choice enables an easier comparison to some analytic calculations ( e.g. , * ? ? ? * ) and is simpler computationally , since there is no need to solve an energy evolution equation . evidently , this model is oversimplified , since it is known that protoplanetary discs exhibt radial temperature gradients ( e.g. * ? ? ?",
    "there is a wealth of examples in the numerical astrophysics literature where discs are modeled with temperature gradient of the form @xmath146 .",
    "although this specific temperature profile does not necessarily reflect the structure of real circumstellar discs ( see , e.g. * ? ? ?",
    "* ; * ? ? ?",
    "* ) , it is a popular approximation because it confers discs with a degree of self - similarity , since then the aspect ratio is independent of radius .",
    "the stockholm code comparison project of @xcite imposed this temperature profile for all of the experiments in their simulation suite .",
    "we have added to our experiments a small set of runs that include a temperature gradient to facilitate a comparison with the results of @xcite .",
    "we have modified the hydrodynamic solver used in the previous sections to include a temperature gradient ( @xmath146 ) such that at each cell interface , a local sound speed is used in the iterative isothermal riemann solver .",
    "the additional cost of computing this space - varying sound speed is minimal , because the centroid of each face is already calculated since it is needed to carry out the spatial extrapolation in the muscl - hancock scheme @xcite .",
    "since arepo is a finite - volume scheme and , by default , it solves the non - radiative energy equation of the gas , we have attempted to run a simulation with the adiabatic riemann solver but using @xmath149 ( @xmath150 ) as suggested by @xcite for finite - volume codes .",
    "however , we remain skeptical about the validity of this approach , unless it is used for planet - disc interaction simulations well within the linear regime or for very small planet masses ( e.g. * ? ? ?",
    "the reason why this shortcut is not entirely applicable is that in gap - opening simulations there is significant radial motion near the coorbital region .",
    "it can be shown that using @xmath149 ensures isothermality of gas parcels in time in the lagrangian sense , i.e. , gas retains its initial temperature regardless of its spatial trajectory . therefore ,",
    "unless gas motion is very close to azimuthal , using this approximation can produce results that differ significantly from the strictly isothermal solutions .",
    "interestingly , low resolution arepo runs using this prescription ( not shown ) reproduce the density bumps inside and outside the gaps better than the those with a strictly isothermal riemann solver .",
    "however , since the resulting sound speed  defined as @xmath151  is departs in time from the initial @xmath152 , we have obtained seemingly correct results for the wrong reasons .",
    "part of analysis of the previous sections carried with globally isothermal gas remains qualitatively unchanged and will not be repeated for the locally isothermal runs ( namely , the morphological analysis of surface density and vortensity ) .",
    "however , a detailed discussion of the torque calculation for this set of additional runs is justified , as it was one of the main objectives of the stockholm code comparison .",
    "the torque per unit mass is calculated in the same manner as in section  [ sec : torques ] , this time setting @xmath153 in equation  ( [ eq : torque_formula2 ] ) .",
    "figure  [ fig : arepo_fargo_torque ] shows a comparison of the raw ( thick light - colored curves ) and smoothed ( thin dark - colored curves ) between arepo ( upper panel ) and fargo ( lower panel ) simulations of a locally isothermal disc with a jupiter - mass planet . despite a rough agreement between these runs during the first @xmath117 orbits , after some time",
    "the instantaneous torque is stronger in the fargo case .",
    "the inner and outer torques are between a factor or two and five in smaller in the arepo run than in the fargo equivalent .",
    "this can be explained by the weaker density bumps formed in the arepo case , which get further depleted in time .",
    "the difference in amplitude of the high - frequency oscillations in the torque is also due to these shallower density bumps . as discussed in section  [ sec : viscosity_resolution ] , a moderate increment in resolution can solve this discrepancy , but as we have seen in our globally isothermal simulations , the unstable configuration of a planet - disc interaction with open gaps can not provide a testbed for the convergence of quantities such as the torque .",
    "higher resolution runs do not exhibit a consistent torque evolution in relation to that shown in figure  [ fig : arepo_fargo_torque ] , sometimes even showing a reversals in torque sign after 200 orbits .",
    "we have confirmed this type of outcome with fargo , experimenting with 128 , 256 , 512 and 1024 radial zones , finding that even after an apparent saturation of the torque is reached at @xmath154 orbits , edge instabilities can change this quantity at later times .",
    "however , viscous runs do show a more consistent behavior .",
    "table  [ tab : torque_results ] lists the total planet - disc tidal torque averaged over 25 orbital periods between 175 and 200 orbits for viscous runs ( @xmath155 in the neptune - mass ( @xmath38 ) and the jupiter - mass ( @xmath39 ) cases for locally isothermal discs ( constant aspect ratio @xmath156 ) using arepo and fargo at two different resolutions .",
    "in addition , we include the simple average of the stockholm simulation suite . for each configuration ,",
    "the two fargo runs at different resolutions are consistent with each other to within @xmath157 to @xmath158 .",
    "the arepo torques , on the other hand , show a significant increase in absolute magnitude when increasing the number of radial zones from 128 to 256 , still lying at @xmath159-@xmath73 below from the stockholm average , while the fargo torques have values of only @xmath160-@xmath73 below the stockholm averages . as suggested by figures  [ fig : jup - visc_torque ] and  [ fig : nep - visc_torque ] , a number of radial zones closer @xmath71 would be necessary to capture a converged saturated torque with arepo .",
    "l | c | c & @xmath161 & resolution +   + & @xmath162 & 128 radial zones + arepo & @xmath163 & 256 radial zones + fargo & @xmath164 & @xmath47 , @xmath48 + fargo & @xmath165 & @xmath113 , @xmath166 + stockholm suite & @xmath167 &  +   + & @xmath168 & 128 radial zones + arepo & @xmath169 & 256 radial zones + fargo & @xmath170 & @xmath47 , @xmath48 + fargo & @xmath171 & @xmath113 , @xmath166 + stockholm suite & @xmath172 &  +    @xmath173 simple average and standard deviation of the torque results obtained with the 11 - 12 different codes included in the stockholm code comparison project @xcite .",
    "applying arepo to an idealized version of the planet - disc interaction problem provides a very important opportunity to benchmark the moving - mesh method in a setup which we anticipate as challenging for this type of code .",
    "reassuringly , we have obtained results that are very consistent with simulation results in the literature .",
    "this invalidates recent suggestions that a code like arepo would have severe intrinsic limitations for problems requiring a high - degree of symmetry , especially with a supersonic shearing flow @xcite .",
    "however , we do agree that in situations where the flow is very close to axisymmetric , arepo can at best be competitive with static grid methods , since here its advantages in the form of reduced advection errors are wiped out by the additional grid noise due to the moving mesh . in this regime , a freely moving mesh scheme will naturally be less efficient , given the additional computational expense of reconstructing the tessellation at every time - step .",
    "we have observed that even higher resolution will be needed in future work to assess the convergence of the torque calculation for neptune - mass planets , let alone for earth - mass planets .",
    "we attribute the noise component of the net torque evolution observed in the neptune case to fluctuations in mass and position of the cells .",
    "future work should explore new ways to drift the mesh under a point - mass potential .",
    "an interesting possibility is to drift the mesh - generating points using an integrator of higher order than the leapfrog but with similar conservative properties , such as the wisdom - holman mapping used for planetary systems @xcite .",
    "in addition , new algorithms to regularize the mesh should be explored . at this point ,",
    "mesh regularization has  unsurprisingly",
    " degrees of freedom that do not necessarily depend on the flow evolution . moving toward parameter - free regularization techniques",
    "would be highly desirable .",
    "it is known that the so - called  false diffusion \" ( or  numerical viscosity \" or  advection error \" ) on the grid arises from four different sources .",
    "the most obvious one is the grid spacing .",
    "the least obvious one is grid noise .",
    "the other two are ( 1 ) the fluid velocity _ with respect to the grid _ , and ( 2 ) the angle between the flow direction and the coordinate axis used to discretize the domain @xcite ; i.e. the alignment of the grid with the flow .",
    "although these last two features are interrelated , they are not quite equivalent .",
    "the first aspect of numerical diffusion lies at the heart of moving - mesh codes like arepo or advection - subtracted codes like fargo : eliminating the velocity of the fluid with respect to the grid reduces the errors since these are proportional to the velocity field .",
    "the second aspect is why cylindrical grid codes are favored for accretion disc simulations . in these schemes ,",
    "the equations are first written in their cylindrical components and then discretized , and space is discretized by binning in a `` cartesian fashion '' the axes of a orthorgonal coordinate system ( in this case @xmath42 and @xmath43 ) . in an orthogonal .",
    "this subtlety in distingushing between the discretized equations of motion and discretized coordinates has special relevance in a scheme like arepo , in which the equations of motion are always in cartesian coordinates , but rotated constantly throughout the mesh to match the local geometry and orientation of the cell faces .",
    "however , by the properties of the tessellation geometry , voronoi - based schemes can produce _ some _ cell faces that align along or perpendicular to the flow , but the very nature of the tessellation forbids this to happen for every interface",
    ".    in a voronoi topology , alignment of the mesh in one direction might come at the expense of misalignment in another direction .",
    "as briefly discussed by @xcite , a supersonic shearing flow might not be ideal for a voronoi mesh since contiguous cells at different speeds will share a rapidly rotating interface that will not be parallel to the direction of the flow at that point , thus eliminating the benefit that meshes that are aligned with the flow have in reducing numerical diffusivity .",
    "we illustrate this schematically in figure  [ fig : mesh_shear ] .",
    "consider a velocity field @xmath174 .",
    "cells moving along the same line ( equal @xmath41 ) and at the same speed are simply advected ( and so is the interface between them ) , and thus exchange a negligible amount of mass .",
    "cells moving in the same direction but along different lines ( different @xmath41 ) and at different speeds will share a face that will be rotating as a result of this velocity gradient .",
    "this will cause a misalignment between the face and the background velocity field ( see figure  [ fig : mesh_shear ] , bottom panel ) and thus the cells on both sides of the interface will exchange mass .",
    "in contrast , if the mesh topology remained to be composed of square cells at all times ( see figure  [ fig : mesh_shear ] , top ) , the projected mass flux onto the  shearing face \" would be zero .",
    "therefore , the locally misaligned mesh adds noise to the numerical solution . in",
    "well - resolved , stationary flows , the total mass exchange of a given cell should cancel out ( some faces will have positive mass flux , and others negative flux ) . however , in complex and time - dependent flows",
    ", truncation errors can deteriorate the face - extrapolated quantities , producing additional numerical diffusion .",
    "note , however , that for most resolutions used in astrophysical disc simulations , the change in velocity in the direction of the shear ( the @xmath41-direction in figure  [ fig : mesh_shear ] ) will be much smaller than the bulk velocity of the cells ( along the @xmath40-direction in figure  [ fig : mesh_shear ] ) , and thus the reduction of advection error due to this motion is in general more critical than the reduction of the advection error due to shear .",
    "therefore , although the rotating face due to shear adds numerical noise , the subtraction of this cell s bulk motion should still provide a significant improvement with respect to a fully static grid .",
    "codes like fargo and disco aim to solve both issues : bulk motion and mesh alignment , at the expense of having no resolution flexibility .",
    "in contrast , a mesh comprised of a _",
    "static _ tessellation would fail to improve numerical diffusion on both fronts , thus being the worst choice for disc simulations , for this given order of accuracy , along with a static cartesian grid .",
    "the unavoidable misalignment of voronoi faces with respect to the azimuthal flow led @xcite to revert to a structured grid approach in which , although cells are indeed moving , their motion is restricted to be along the azimuthal direction , in a technique highly reminiscent of the original fargo scheme . however , as we have stated above , the shear - induced noise is only secondary to the bulk motion - induced error . in order to properly bypass this type of error ,",
    "the fluid equations must be solved in a frame moving with the fluid , and this requires a boosted riemann solver .",
    "still , an even more important benefit of a conveniently structured grid is that is always accompanied by a corresponding choice coordinates ( cylindrical coordinate equations plus cylindrical - coordinate grid . )     there are now two codes in the literature , arepo and tess , that use voronoi tessellation .",
    "there are notable difference between the two hydrodynamics schemes .",
    "arepo takes into account the motion of the mesh by adding the respective godunov fluxes at each interface assuming the mesh is _ at rest _ at any given time , allowing in effect the subtraction of an advection flux that compensates for the fact that the face is moving .",
    "a crucial detail in the arepo scheme is how the godunov fluxes are obtained in the first place : the riemann problem is solved in a _ boosted _ frame ( i.e. , the flow velocity to the left and right of the interface is always small ) , and the resulting primitive variables are boosted back into the lab frame .",
    "only then are the godunov fluxes calculated and the quantities updated . on the other hand , for a tessellation code like that solves the riemann problem directly in the lab frame an exact riemann solver is a necessity , since the velocity flow to the left and right of the interface can be very large . for approximate ,",
    "lab - frame solvers , even if the posterior subtraction of the advection flux reduces the mass exchange between two contiguous cells , the truncation error has already done its damage and the scheme will be diffusive .",
    "as long as the riemann problem is properly boosted to the face rest frame , the use of an approximate riemann solver is of secondary importance , as demonstrated by @xcite ,",
    "we have presented results for low - resolution simulations of planet disc interaction using the moving - mesh code arepo for two different planet - to - star mass ratios exploring the dependence of the result on resolution and viscosity .    1 .",
    "we have shown that arepo can perform adequately on problems with a high degree of symmetry like that of planet disc interactions , even though this is not what a code like this is expected to excel at . although concerns about the numerical noise associated with faces that are misaligned with the flow is well - founded , this does not affect the overall performance of the code significantly .",
    "we argue that the riemann solver ( exact or approximate ) should always be boosted to the frame of the face . from a practical point of view , this allows for much longer time steps , since lab frame riemann solvers must use a clf criterion based on the lab frame speed of the flow .",
    "2 .   among the different sources of noise ,",
    "we conjecture that grid noise is the main concern in moving mesh simulations due to its sensitivity to the development of instabilities .",
    "3 .   we have found that proper convergence of the simulations is a function of planet mass .",
    "this is not surprising since the perturbations exerted on the disc are proportional to the planet mass ( in the linear regime ) , and thus it is easier to overcome numerical fluctuations with larger planetary masses .",
    "however , the moving mesh introduces some degree of uncertainty when separating the torque into different components and when excluding the contribution from within the hill sphere . for low resolution ,",
    "the hill sphere is barely resolved , meaning that cells entering and leaving this region can introduce a degree of stochasticity that may not be present if cells were not considered as point particles for torque calculation purposes .",
    "ultimately , fully consistent migration simulations ( e.g. with self - gravity ; see @xcite ) are necessary to elucidate the importance of material within the hill sphere for the orbital evolution of the planet in our arepo simulations .",
    "the quasi - lagrangian nature of a code like arepo opens new possibilities to the high - resolution study of planet - disc interaction .",
    "the possibility of a very flexible increment of resolution around areas of interest presents an efficient alternative to uniformly increasing the resolution globally , allowing one to avoid the computational costs this entails .",
    "although the merit and success of fargo and fargo - like codes is indisputable for this kind of problem , we believe there is still room for moving - mesh codes as well , especially for tackling the adaptive mesh refinement difficulties that arise in cylindrical coordinates , but that are straightforward for arepo . for example , in arepo the increased resolution within the hill sphere can allow for high - resolution studies of the circumplanetary environments embedded in global disc simulations .",
    "furthermore , the increased resolution along the planetary wakes ( see figure  [ fig : planet_wmesh ] ) enables the capture of sharper features . along these lines ,",
    "future work will assess the minimum resolution requirement to reproduce the negative torque density observed at very high ( but uniform ) resolution by @xcite and @xcite .",
    "the research presented here was carried out as part of djm s phd thesis at harvard university .",
    "the simulations in this paper were run on the odyssey cluster supported by the fas science division research computing group at harvard university .",
    "we are thankful to ramesh narayan , cristval petrovich , mark vogelsberger , chris hayward and dylan nelson for helpful discussions .",
    "djm would like to thank dimitar sasselov , matthew holman , ruth murray - clay and james stone for insightful feedback and support throughout the development of this work .",
    "vs acknowledges support by the european research council under erc - stg grant exagal-308037 ."
  ],
  "abstract_text": [
    "<S> general - purpose , moving - mesh schemes for hydrodynamics have opened the possibility of combining the accuracy of grid - based numerical methods with the flexibility and automatic resolution adaptivity of particle - based methods . due to their supersonic nature , </S>",
    "<S> keplerian accretion discs are in principle a very attractive system for applying such freely moving mesh techniques </S>",
    "<S> . however , the high degree of symmetry of simple accretion disc models can be difficult to capture accurately by these methods , due to the generation of geometric grid noise and associated numerical diffusion , which is absent in polar grids . to explore these and other issues , </S>",
    "<S> in this work we study the idealized problem of two - dimensional planet - disc interaction with the moving - mesh code arepo . </S>",
    "<S> we explore the hydrodynamic evolution of discs with planets through a series of numerical experiments that vary the planet mass , the disc viscosity and the mesh resolution , and compare the resulting surface density , vortensity field and tidal torque with results from the literature . </S>",
    "<S> we find that the performance of the moving - mesh code in this problem is in accordance with published results , showing good consistency with grid codes written in polar coordinates . </S>",
    "<S> we also conclude that grid noise and mesh distortions do not introduce excessive numerical diffusion . </S>",
    "<S> finally , we show how the moving - mesh approach can naturally increase resolution in regions of high density around planets and planetary wakes , while retaining the background flow at low resolution . </S>",
    "<S> this provides an alternative to the difficult task of implementing adaptive mesh refinement in conventional polar - coordinate codes .    </S>",
    "<S> hydrodynamics  methods : numerical  planet - disc interactions  protoplanetary discs . </S>"
  ]
}