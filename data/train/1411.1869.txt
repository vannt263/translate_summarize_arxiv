{
  "article_text": [
    "there are classical statistical models in the literature for regression and prediction with spatial continuous data for which parameter estimation and inference are straightforward .",
    "these models are based on the multivariate normal ( mvn ) distribution , applied to a possibly transformed response ( for a thorough review see @xcite ) . but",
    "applications of these models are invalid for discrete spatial categorical and count response data .",
    "these data occur in several disciplines such as epidemiology , ecology , agriculture , to name just a few .",
    "flexible models for such data are not widely available and usually hard to fit due to the fact that available multivariate discrete distributions can have only certain properties , as for example they provide limited dependence or they can have marginal distributions of a given form .",
    "most of the existing literature is concerned with the generalized linear mixed model proposed by @xcite .",
    "this model was initially proposed for the analysis of correlated count data by",
    ". limitations of this model are that the marginal distributions belong to a specific parametric family , and , because the correlation structure come from a continuous multivariate mixing distribution , the possible choices are very limited .",
    "thus , it seems that there is a lack of flexible models appropriate for spatial discrete data or flexible marginal choices .    in this paper",
    ", we use copulas ( distributions with uniform margins on the unit interval ) to overcome this problem .",
    "the power of copulas for dependence modelling is due to the dependence structure being considered separate from the univariate margins ; see , for example , section 1.6 of @xcite .",
    "a discrete regression spatial model through copulas is not new .",
    "a copula approach was recently proposed and studied by @xcite , , @xcite and @xcite who explored the use of mvn copulas to describe the distribution of geostatistical and spatially aggregated data , respectively .",
    "our empirical experience is that the mvn copula model with discrete margins provides the best or nearly the best fit .",
    "however , implementation of the mvn copula for discrete data is possible , but not easy , because the mvn distribution as a latent model for discrete response requires rectangle probabilities based on multidimensional integrations .",
    "@xcite , influencing other authors ( e.g. @xcite , @xcite ) , acknowledged that the probability mass function ( pmf ) can be obtained as a finite difference of the copula cumulative distribution function ( cdf ) . generally speaking ,",
    "this is an imprecise statement , since calculating the finite difference among @xmath0 ( where @xmath1 is the dimension ) numerically computed orthant probabilities may result in negative values .",
    "the pmf can be alternatively obtained by computing a mvn rectangle probability .",
    "the randomized quasi monte carlo methods proposed by @xcite and can be used for that purpose .",
    "if one computes the rectangle mvn probabilities via simulation based on the methods in @xcite and , then one is using a simulated likelihood method .",
    "@xcite has studied the asymptotic and small - sample efficiency of this simulated likelihood method and has shown it is as good as maximum likelihood for dimension 10 or lower .",
    "@xcite and proposed a different simulated likelihood method to  approximate \" the likelihood , by using the continuous extension ( ce ) of a discrete random variable developed in and applied the method to geostatistical and longitudinal discrete data , respectively .",
    "also used the simulated likelihood method based on the ce for longitudinal and multivariate insurance claim counts .",
    "and @xcite proposed and studied respectively a fast surrogate likelihood method , by approximating the rectangle probability with a copula density using the distributional transform ( dt ) ; see @xcite for an early appearance .",
    "both the simulated likelihood method based on the ce and the surrogate likelihood method based on the dt have the advantage that the likelihood can be derived conveniently under the theory for copula models with continuous margins .",
    "@xcite recommended the simulated likelihood method based on the ce and the surrogate likelihood method based on the dt along with the composite likelihood ( cl ) method @xcite for modelling spatially aggregated discrete ( areal ) data and used the simulated likelihood method based on the ce to  judge \" the dt and cl approaches .",
    "it came as somewhat of a surprise to us , because ( a ) asymptotic and small - sample efficiency calculations in @xcite have shown that the simulated likelihood method based on the ce is a very inefficient approach ; it leads to substantial downward bias for the estimates of the latent correlation and the univariate marginal parameters that they are not regression coefficients for fully specified multivariate normal copula - based models , and , ( b ) cl methods are well established as an alternative of maximum likelihood when the joint probability is too difficult to compute ; they lead to unbiased estimating equations @xcite .",
    "note in passing that they have been studied for copula modelling by .",
    "the surrogate likelihood method based on the dt can not be recommended until its properties have been studied and compared to efficient existing methods .",
    "the dt method has been previously used in copula literature , e.g. to prove stochastic ordering results and construct tests of dependence properties in @xcite and @xcite , respectively . although its application to copula dependence modelling for discrete data is novel , its asymptotic properties has yet to be established in that context .",
    "the contribution in this paper is ( a ) to examine thoroughly the accuracy and the adequacy of the surrogate likelihood method based on the dt using asymptotics and small - sample efficiency studies ; ( b ) to study the estimation of the mvn copula model with discrete responses via the simulated likelihood method proposed by @xcite in a high - dimensional / spatial context .    the remainder of the paper proceeds as follows .",
    "section [ sec - model ] has a brief overview for mvn copula models .",
    "likelihood estimation methods are provided in section [ sec - estimation ] .",
    "section [ sec - asym ] and section [ sec - sim ] contain theoretical ( asymptotic properties of the estimators ) and small - sample efficiency calculations , respectively , to assess the accuracy of the discussed likelihood estimation methods .",
    "section [ sec - app ] presents applications of the likelihood estimation methods to two areal data sets . in these examples , it turns out that the surrogate likelihood method based on the dt could lead to invalid inference .",
    "we conclude with some discussion in section [ sec - disc ] .",
    "a copula is a multivariate cdf with uniform @xmath2 margins @xcite .",
    "if @xmath3 is a @xmath1-variate cdf with univariate margins @xmath4 , then sklar s ( 1959 ) theorem implies that there is a copula @xmath5 such that @xmath6 the copula is unique if @xmath4 are continuous , but not if some of the @xmath7 have discrete components .",
    "if @xmath3 is continuous and @xmath8 , then the unique copula is the distribution of @xmath9 leading to @xmath10 where @xmath11 are inverse cdfs . in particular ,",
    "if @xmath12 is the mvn cdf with correlation matrix @xmath13 and n(0,1 ) margins , and @xmath14 is the univariate standard normal cdf , then the mvn copula is @xmath15    consider a multivariate discrete regression setup in which @xmath16 dependent discrete random variables @xmath17 are observed together with a vector @xmath18 of explanatory variables .",
    "if @xmath19 is the mvn copula ( or any other parametric family of copulas ) and @xmath20 , where @xmath21 is a function of @xmath22 and the @xmath23-dimensional regression vector @xmath24 , and @xmath25 is the @xmath26-dimensional vector of univariate parameters that are not regression coefficients , is a parametric model for the @xmath27th univariate margin then @xmath28 is a multivariate parametric model with univariate margins @xmath4 . for copula models , the response vector @xmath29 can be discrete .",
    "in this section , we discuss the simulated likelihood method proposed by @xcite and the surrogate likelihood method based on the dt . the simulated likelihood method based on the ce",
    "is not discussed / used in the sequel since its inefficiency has been shown in @xcite and should be avoided for copula dependence modelling with multivariate / longitudinal discrete data .      for a sample of size @xmath30 with data",
    "@xmath31 , the joint log - likelihood of a mvn copula model is @xmath32 where @xmath33 is the joint pmf of the multivariate discrete response vector @xmath34 .",
    "the pmf can be obtained by computing the following rectangle probability , @xmath35}^{\\phi^{-1}[f_{1}(y_1;\\nu_1,\\gbf)]}\\cdots \\int_{\\phi^{-1}[f_{d}(y_d-1;\\nu_d,\\gbf)]}^{\\phi^{-1}[f_{d}(y_d;\\nu_d,\\gbf ) ] }   \\phi_\\r(z_1,\\ldots , z_d ) dz_1\\ldots dz_d,\\nonumber\\end{aligned}\\ ] ] where @xmath36 denotes the standard mvn density with latent correlation matrix @xmath37 .",
    "there are several papers in the literature that focus on the computation of the mvn rectangle probabilities .",
    "the dominant of the methods is a quasi monte carlo method proposed by @xcite and .",
    "the method achieves error reduction of monte carlo methods with variance reduction methods as ( a ) transforming to a bounded integrand , ( b ) using antithetic variates , and ( c ) using a randomized quasi monte carlo method .",
    "the test results in show that the method is very efficient , compared to other methods in the literature .",
    "note in passing that the implementation of the proposed algorithms in is available in the _ mvtnorm _ package in r @xcite .",
    "this advance in computation of mvn probabilities can be used to implement high - dimensional mvn copula models with discrete response data .",
    "@xcite proposed a simulated likelihood ( hereafter sl ) method , where the rectangle mvn probabilities in ( [ mllik ] ) are computed based on the methods in .",
    "the estimated parameters can be obtained by maximizing the simulated log - likelihood in ( [ mllik ] ) over the univariate and copula parameters @xmath38 . since the estimation of the parameters of the mvn copula - based models",
    "is obtained using a quasi - newton routine @xcite applied to the log - likelihood in ( [ mllik ] ) , the use of randomized quasi monte carlo simulation to four decimal place accuracy for evaluations of integrals works poorly , because numerical derivatives of the log - likelihood with respect to the parameters are not smooth . in order to achieve smoothness , the same set of uniform random variables",
    "should be used for every rectangle probability that comes up in the optimization of the sl .",
    "the method was initially proposed for the analysis of discrete longitudinal data @xcite .",
    "we refer the interested reader to this paper for more details .",
    "copula models were originally developed for continuous responses where the density is obtained using partial derivatives of the multivariate copula cdf , and hence the numerical calculations are much simpler .",
    "and @xcite proposed and studied respectively a surrogate likelihood method , by approximating the rectangle probability in ( [ mvnpmf ] ) with a copula density using the dt @xcite .",
    "the surrogate likelihood takes the form @xmath39 where @xmath40 and @xmath41 are the univariate marginal pmfs . since the mvn copula has a closed form density @xmath42,\\ ] ] where @xmath43 with @xmath44 and @xmath45 is the @xmath1-dimensional identity matrix , the authors avoid the multidimensional integration , and hence the numerical calculations are much simpler and faster .",
    "the estimated parameters can be obtained by maximizing the surrogate log - likelihood in ( [ kalik ] ) over the univariate and copula parameters @xmath38 .",
    "in this section , we study the asymptotics of the surrogate likelihood method based on the dt , along with the asymptotics of the sl in @xcite , and we assess the accuracy based on the limit ( as the number of clusters increases to infinity ) of the maximum surrogate likelihood estimate ( dtmle ) and the maximum sl estimate ( msle ) .",
    "we restrict ourselves to a mvn copula model with a positive exchangeable dependence structure , i.e. , we took @xmath37 as @xmath46 , where @xmath47 is the @xmath48 matrix of 1s . for positive exchangeable correlation structures ,",
    "the @xmath1-dimensional integrals conveniently reduce to 1-dimensional integrals .",
    "hence , mvn rectangle probabilities can be quickly computed to a desired accuracy that is @xmath49 or less , because 1-dimensional numerical integrals are computationally easier than higher - dimensional numerical integrals .",
    "if one computes the rectangle mvn probabilities in ( [ mllik ] ) with the 1-dimensional integral method in , then one is using a numerically accurate likelihood method that is valid for any dimension @xcite .    by varying factors such as dimension @xmath1 , the amount of discreteness ( binary versus count response ) , and latent correlation for exchangeable structures , we demonstrate patterns in the asymptotic bias of the dtmle and msle , and assess the performance of the surrogate and simulated likelihood .",
    "note that the performance of the sl method has been already assessed in @xcite and it is shown that it is good as maximum likelihood for dimension 10 or lower . for the cases where we compute the probability limit , we will take a constant dimension @xmath1 that increases . for marginal models we use bernoulli@xmath50 , poisson@xmath50 , and negative binomial ( nb ) .",
    "for the latter model , we use both the nb@xmath51 and nb@xmath52 parametrization in ; the nb@xmath53 parametrization is that used in @xcite .",
    "for ease of exposition , we also consider the case that @xmath54 is common to different univariate margins and does not depend on covariates .",
    "let the @xmath55 distinct cases for the discrete response be denoted as @xmath56 in a random sample of size @xmath30 , let the corresponding frequencies be denoted as @xmath57 and @xmath58 be the limit in probability of @xmath59 as @xmath60 .",
    "for the sl in ( [ mllik ] ) , we have the limit @xmath61 where @xmath62 is computed using the method in .",
    "the limit of the msle ( as @xmath60 ) is the maximum of ( [ limitslik ] ) ; we denote this limit as @xmath63 .",
    "note in passing that the limit of the standard mle ( as @xmath60 ) is the maximum of ( [ limitslik ] ) where @xmath62 is computed with the 1-dimensional integral method in . for the surrogate log - likelihood in ( [ kalik ] )",
    ", we have the limit @xmath64 where @xmath65 .",
    "the limit of the dtmle ( as @xmath60 ) is the maximum of ( [ limitlik ] ) ; we denote this limit as @xmath66 .",
    "we will compute these limiting msle and dtmle in a variety of situations to show clearly if the simulated and surrogate likelihood methods are good . by using these limits",
    ", we do not need monte carlo simulations for comparisons , and we can quickly vary parameter values and see the effects .",
    "the @xmath58 in ( [ limitslik ] ) and ( [ limitlik ] ) are the model based probabilities @xmath62 , and computed with the 1-dimensional integral method in . for a count response",
    ", we get a finite number of @xmath67 vectors by truncation .",
    "the truncation point is chosen to exceed @xmath68 for total probabilities .",
    ".[be - bias ] limiting dtmle for mvn copula - based models with bernoulli@xmath50 margins . [ cols=\"^,^,^,^,^,^,^,^,^,^ \" , ]     because there is much discretization in the data , the dispersion parameter @xmath69 and parameter @xmath70 of the car precision matrix are ( substantially under the assumption of an nb1 margin ) over - estimated .",
    "this was expected for overdispersed count data as shown in the studies of the properties of the surrogate likelihood estimates in section [ sec - asym ] and section [ sec - sim ] .",
    "in particular for areal data applications an interesting advantage of the car copula modelling over the classic areal glm modelling is the ability to recover @xmath70 ; see @xcite and the references therein .",
    "so an efficient estimation of @xmath70 is highly desirable in this context ; hence the dt method performs poorly in this example .    based on our analysis ,",
    "the ses show the gender effect to be highly significant , and the gender by race interaction insignificant .",
    "however , for the dt analysis with poisson regression , the gender by race interaction is statistically significant . generally speaking",
    ", this implies that misspecifying the model or using the surrogate likelihood method based on the dt could lead to invalid conclusions .",
    "the latter was actually the case for the analysis of the data for year 1974 in table [ ohio2 ] .",
    "the dt method resulted a statical significant ( @xmath23-value=0.041 ) rather than the true marginal statistical significant ( @xmath23-value=0.071 ) gender by race interaction under the best model ( nb2 ) via the penalized likelihood principle ( aic ) .",
    "in this paper we have studied high - dimensional mvn copula models with discrete margins for analysing spatial discrete response data .",
    "we discussed simulated and surrogate ( based on the dt ) likelihood estimation methods .",
    "for the binary , poisson , and negative binomial regression models with the mvn / car copula , we have shown that the surrogate likelihood method based on the dt leads to substantial upward bias for the estimates of the latent correlation / parameter of the precision matrix of the car model and the univariate marginal parameters when there is more discretization , that is large individual discrete probabilities .",
    "we have shown that the sl method proposed by @xcite , is highly efficient for a high - dimensional discrete response up to dimension @xmath71 .",
    "although there is an issue of computational burden as the dimension and the sample size increase , this will subside , as computing technology is advancing rapidly .",
    "any comparison of the methods in terms of computing time is a digression .",
    "it is obvious that the dt method is much faster then the sl method , since a numerically more difficult high - dimensional mvn rectangle probability calculation is replaced with a much simpler computationally mvn density value .",
    "however , theoretically there are still problems for large individual probabilities , since the dt approximation of ` large steps ' in the cdf is poor .",
    "in fact , we novelty propose simple diagnostics ( descriptive statistics such as a histogram ) to judge if the dt method is reliable and reduce by its use the computational burden when it is possible ( i.e. , for small individual probabilities ) .",
    "it is worth mentioning that the range of possible applications of these tools goes beyond biometric / disease / health data and is of interest also in other fields such as hydrometeorology .",
    "a typical example are the binary vectors describing the rainfall occurrence at multiple sites , or the occurrence of simultaneous exceedance of given threshold values in extreme value analysis of floods , droughts , and storms over specified areas .",
    "note also in passing the dt method deteriorates for such ( binary ) response data .",
    "finally , the results will be similar for other structured latent correlation structures such as the matrn isotropic structure used for example in @xcite and @xcite . as previously emphasized",
    "the idea of the dt transform is to replace a numerically more difficult mvn rectangle probability calculation with a simpler mvn density value , and hence it is discrete responses that matter and not the type of the structured correlation structure .",
    "nikoloulopoulos , a.  k. ( 2013a ) .",
    "copula - based models for multivariate discrete response data . in durante , f. , hrdle , w. , and jaworski , p. , editors , _",
    "copulae in mathematical and quantitative finance _ , pages 231249 . springer ."
  ],
  "abstract_text": [
    "<S> the distributional transform ( dt ) is amongst the computational methods used for estimation of high - dimensional multivariate normal copula models with discrete responses . </S>",
    "<S> its advantage is that the likelihood can be derived conveniently under the theory for copula models with continuous margins , but there has not been a clear analysis of the adequacy of this method . </S>",
    "<S> we investigate the small - sample and asymptotic efficiency of the method for estimating high - dimensional multivariate normal copula models with univariate bernoulli , poisson , and negative binomial margins , and show that the dt approximation leads to biased estimates when there is more discretization . for a high - dimensional discrete response , we implement a maximum simulated likelihood method , which is based on evaluating the multidimensional integrals of the likelihood with randomized quasi monte carlo methods . </S>",
    "<S> efficiency calculations show that our method is nearly as efficient as maximum likelihood for fully specified high - dimensional multivariate normal copula models . </S>",
    "<S> both methods are illustrated with spatially aggregated count data sets , and it is shown that there is a substantial gain on efficiency via the maximum simulated likelihood method . </S>",
    "<S> +   + _ keywords : _ areal data ; distributional transform , generalized quantile transform ; rectangle probabilities ; simulated likelihood ; spatially aggregated data .     </S>"
  ]
}