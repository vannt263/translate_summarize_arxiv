{
  "article_text": [
    "abelian equivalence of words has long been a subject of great interest ( see for instance erds problem , @xcite ) . given a finite non - empty set @xmath30 let @xmath5 denote the set of all finite words over @xmath31 two words @xmath3 and @xmath4 in @xmath5 are _ abelian equivalent , _ denoted @xmath32 if and only if @xmath33 for all @xmath34 where @xmath35 and @xmath36 denote the number of occurrences of @xmath37 in @xmath3 and @xmath38 respectively .",
    "it is readily verified that @xmath39 defines an equivalence relation ( in fact a congruence ) on @xmath40    we consider the following natural generalization : fix @xmath0 two words @xmath3 and",
    "@xmath4 in @xmath5 are said to be @xmath6-_abelian equivalent _ , written @xmath41 if @xmath42 for each non - empty word @xmath9 with @xmath43 ( where @xmath44 denotes the length of @xmath45 and @xmath46 and @xmath47 denote the number of occurrences of @xmath9 in @xmath3 and @xmath38 respectively ) .",
    "we note that @xmath48 if and only if @xmath49 while @xmath50 corresponds to the usual notion of abelian equivalence @xmath51 thus one may regard the notion of @xmath6-abelian equivalence as gradually bridging the gap between abelian equivalence ( @xmath13 ) and equality ( @xmath14 it is readily verified that @xmath11 defines an equivalence relation ( in fact a congruence ) on @xmath40 clearly , if @xmath41 then @xmath52 and @xmath53 for each positive integer @xmath54    the notion of @xmath6-abelian equivalence was first introduced by the first author in @xcite in connection with formal languages and decidability questions of various fundamental problems .",
    "it was shown that the well known parikh theorem on the equivalence of parikh images of regular and context - free languages does not hold for @xmath6-abelian equivalence .",
    "in contrast various highly nontrivial decidability questions including the d0l sequence equivalence problem @xcite or the post correspondence problem @xcite , turned out to be easily decidable in the context of @xmath6-abelian equivalence .",
    "recently @xmath6-abelian equivalence has been studied in the context of avoidance of repetitions in words ( see the discussion at the beginning of  [ last ] on @xmath6-abelian powers ) . in this paper",
    "we undergo an investigation of the complexity of infinite words in the framework of @xmath6-abelian equivalence .",
    "as is the case with various other notions of complexity of words , we will see that @xmath6-abelian complexity is intimately linked with periodicity and can be used to detect the presence of repetitions .",
    "let @xmath2 be a finite non - empty set .",
    "for each infinite word @xmath55 with @xmath56 we denote by @xmath57 the set of all _ factors _ of @xmath19 of length @xmath58 that is , the set of all finite words of the form @xmath59 with @xmath60 we set @xmath61 the function @xmath62 is called the _ factor complexity function _ of @xmath63 analogously , for each @xmath1 we define @xmath64 the function @xmath65 which counts the number of @xmath6-abelian equivalence classes of factors of @xmath19 of length @xmath58 is called the @xmath6-_abelian complexity _ of @xmath63 in case @xmath66 we have that @xmath67 while if @xmath68 @xmath69 denoted @xmath70 corresponds to the usual abelian complexity of @xmath63    most word complexity functions , including factor complexity @xcite , maximal pattern complexity @xcite , permutation complexity @xcite , abelian complexity @xcite , and abelian maximal pattern complexity @xcite , may be used to detect ( and in some cases characterize ) ultimately periodic words .",
    "for instance , a celebrated result due to morse and hedlund @xcite states that an infinite word @xmath71 is ultimately periodic if and only if @xmath72 for some @xmath73 the third author together with t. kamae proved a similar result in the context of maximal pattern complexity with @xmath15 replaced by @xmath74 ( see @xcite ) . furthermore ,",
    "amongst all aperiodic ( meaning non - ultimately periodic ) words , sturmian words generally have the lowest possible complexity .",
    "we show that these same results hold in the framework of @xmath6-abelian complexity . in order to formulate the precise link between aperiodicity and @xmath6-abelian complexity , we define , for each @xmath75 an auxiliary function @xmath76 by    @xmath77 we prove that for @xmath71 , if @xmath78 for some @xmath1 and @xmath79 then @xmath19 is ultimately periodic .",
    "this result is already well known in the special cases @xmath66 and @xmath13 ( see @xcite and @xcite respectively ) . by the morse - hedlund result mentioned earlier",
    ", this condition gives a characterization of ultimately periodic words in the special case @xmath80 in contrast , @xmath6-abelian complexity does not yield such a characterization .",
    "indeed , both sturmian words and the ultimately periodic word @xmath81 have the same constant @xmath82 abelian complexity .",
    "more generally , we shall see that the ultimately periodic word @xmath83 has the same @xmath6-abelian complexity as a sturmian word .",
    "nevertheless @xmath6-abelian complexity gives a complete characterization of sturmian words amongst all aperiodic words .",
    "more precisely , we prove that for an aperiodic word @xmath17 the following conditions are equivalent :    * @xmath19 is a balanced binary word , that is , _",
    "sturmian_. * @xmath84 for each @xmath1 and @xmath85    again , the special cases of @xmath66 and @xmath13 were already known ( see @xcite and @xcite respectively ) .",
    "finally we investigate the question of avoidance of @xmath6-abelian @xmath28 powers : by a @xmath6-abelian @xmath28 power we mean a word @xmath86 of the form @xmath87 such that @xmath88 for all @xmath89 using szemerdi s theorem @xcite , we show that if @xmath19 has bounded @xmath6-abelian complexity , then for every @xmath26 with positive upper density and for every positive integer @xmath27 there exists a @xmath6-abelian @xmath28 power occurring in @xmath19 at some position @xmath29    the paper is organized as follows : in  [ back ] we recall some basic definitions and notation and establish various basic properties of @xmath6-abelian equivalence of words . also in  [ back ]",
    "we compute the rate of growth of the number of @xmath6-abelian equivalence classes of words in @xmath90 in  [ periodicity ] we develop the link between @xmath6-abelian complexity and periodicity of words . in  [ sturmwords ] we compute the @xmath6-abelian complexity of sturmian words and show that it completely characterizes sturmian words amongst all aperiodic words . finally in ",
    "[ last ] we study @xmath6-abelian complexity in the context of repetitions in words .",
    "given a finite non - empty set @xmath30 we denote by @xmath5 the set of all finite words over @xmath2 including the empty word , denoted by @xmath91 by @xmath92 the set of all finite non - empty words over @xmath30 by @xmath93 the set of ( right ) infinite words over @xmath30 and by @xmath94 the set of bi - infinite words over @xmath31 given a finite word @xmath95 with @xmath96 and @xmath97 we denote the length @xmath15 of @xmath3 by @xmath98 ( by convention we set @xmath99 for each @xmath100 we let @xmath46 denote the number of occurrences of @xmath9 in @xmath101 for @xmath102 we denote by @xmath103 the reverse of @xmath101    a factor @xmath3 of @xmath104 is called _ right special _",
    "( respectively _ left special _ ) if there exists distinct symbols @xmath105 such that both @xmath106 and @xmath107 ( respectively @xmath108 and @xmath109 ) are factors of @xmath63 we say @xmath3 is _ bispecial _ if @xmath3 is both left and right special .",
    "an infinite word @xmath110 is said to be _ periodic _ if there exists a positive integer @xmath111 such that @xmath112 for all indices @xmath113 it is said to be _ ultimately periodic _ if @xmath112 for all sufficiently large @xmath114 .",
    "it is said to be _ aperiodic _ if it is not ultimately periodic .",
    "sturmian words are the _ simplest _ aperiodic infinite words ; sturmian words are infinite words over a binary alphabet having exactly @xmath115 factors of length @xmath15 for each @xmath116 their origin can be traced back to the astronomer j. bernoulli iii in 1772 . a fundamental result due to morse and hedlund @xcite states that each aperiodic ( meaning non - ultimately periodic ) infinite word must contain at least @xmath115 factors of each length @xmath117 thus sturmian words are those aperiodic words of lowest factor complexity .",
    "they arise naturally in many different areas of mathematics including combinatorics , algebra , number theory , ergodic theory , dynamical systems and differential equations .",
    "sturmian words are also of great importance in theoretical physics and in theoretical computer science and are used in computer graphics as digital approximation of straight lines .",
    "if @xmath118 is sturmian , then for each positive integer @xmath15 there exists a unique right special ( respectively left special ) factor of length @xmath58 and one is the reversal of the other . in particular , if @xmath9 is a bispecial factor , the @xmath9 is a _ palindrome _ , i.e. , @xmath119 for more on sturmian words , we refer the reader to @xcite .",
    "[ df]let @xmath0 we say two words @xmath120 are @xmath6-_abelian equivalent _ and write @xmath41 if @xmath42 for all words @xmath9 of length @xmath121    we note that if @xmath120 and @xmath122 then @xmath123 if and only if @xmath124    the words @xmath125 and @xmath126 are @xmath127-abelian equivalent but not @xmath128-abelian equivalent since the prefix @xmath129 of @xmath3 does not occur in @xmath10 the words @xmath130 and @xmath131 are not @xmath82-abelian equivalent ( since they are not abelian equivalent ) yet for every word @xmath9 of length @xmath82 we have @xmath132    the next lemma gives different equivalent ways of defining @xmath6-abelian equivalence .",
    "for example , item corresponds to the definition  [ df ] and item corresponds to another common definition : words @xmath3 and",
    "@xmath4 of length at least @xmath133 are @xmath6-abelian equivalent if they share the same prefixes and suffixes of length @xmath133 and if @xmath134 for every word @xmath135 of length @xmath6 .",
    "[ prefixsuffix ] let @xmath3 and @xmath4 be words of length at least @xmath133 and let @xmath136 for every word @xmath135 of length @xmath6 .",
    "the following are equivalent :    1 .",
    "[ item : lessk ] @xmath137 for all @xmath138 , 2 .",
    "[ item : k-1 ] @xmath137 for all @xmath139 , 3 .",
    "[ item : prefsuff ] @xmath140 and @xmath141 , 4 .",
    "[ item : pref ] @xmath140 , 5 .",
    "[ item : suff ] @xmath141 , 6 .",
    "[ item : prefsuffi ] @xmath142 and @xmath143 for some @xmath144 .",
    "@xmath145 : clear .",
    "@xmath145 : let @xmath146 be the multiset of factors of @xmath3 ( and of @xmath4 ) of length @xmath6 .",
    "the multiset of factors of @xmath3 of length @xmath133 is @xmath147 and the multiset of factors of @xmath4 of length @xmath133 is @xmath148 these multisets must be the same , so @xmath140 .",
    "similarly , @xmath141 .",
    "@xmath145 , : clear .    or @xmath145 : clear .",
    "@xmath145 : let @xmath146 be the multiset of factors of @xmath3 ( and of @xmath4 ) of length @xmath6 .",
    "every @xmath149 appears in the multiset @xmath150 @xmath151 times .",
    "a word @xmath152 appears @xmath153 times if @xmath154 , and @xmath155 times if @xmath156 .",
    "similarly , every @xmath157 appears @xmath158 times , and a word @xmath159 appears @xmath160 times if @xmath161 , and @xmath162 times if @xmath163 .",
    "if some words appear an odd number of times in , then these must be @xmath164 and @xmath165 , and they must also be @xmath166 and @xmath167 . if follows that @xmath137 for every @xmath139 .",
    "( in this case the assumption was not needed . )    if all words appear an even number of times in , then necessarily @xmath156 and @xmath163 . from it",
    "follows that @xmath140 and @xmath141 , and thus @xmath137 for every @xmath139 .",
    "the fact that @xmath137 also for every @xmath168 of length less than @xmath133 can be proved in a similar way .    the next lemma lists some basic facts on @xmath6-abelian equivalence :    [ lem : basic ] let @xmath169 and @xmath170 .    * if @xmath171 and @xmath172 , then @xmath173 . * if @xmath172 , then @xmath174 for all @xmath175 . * if @xmath176 and @xmath177 , then @xmath178 .",
    "the bound @xmath179 in lemma  [ lem : basic ] is optimal as for each positive integer @xmath6 there exist words @xmath180 of length @xmath181 such that @xmath182 for example , the words @xmath183 and @xmath184 of length @xmath181 are readily verified to be @xmath6-abelian equivalent ( see proposition  [ simplificationprop ] ) .",
    "[ centralword ] fix @xmath185 suppose @xmath186 with @xmath187 and @xmath188 then @xmath189    let @xmath7 with @xmath190 we can assume that @xmath191 for otherwise @xmath192 if @xmath9 is neither a prefix nor a suffix of @xmath193 then by lemma  [ prefixsuffix ] @xmath9 is neither a prefix nor suffix of @xmath194 and hence @xmath195 if @xmath9 is either a prefix of @xmath196 or a suffix of @xmath196 but not both , the @xmath197 finally if @xmath9 is both a prefix and a suffix of @xmath196 then @xmath198      the next theorem gives a complete classification of pairs of @xmath6-abelian equivalent words of length @xmath181 and establishes a first link to sturmian words :    [ 2k ] fix a positive integer @xmath8 and let @xmath199 be distinct words of length @xmath200 then @xmath201 if and only if there exist distinct letters @xmath202 a sturmian word @xmath118 and a right special factor @xmath9 of @xmath19 of length @xmath203 ( or empty in case @xmath204 such that @xmath205 in particular @xmath3 and @xmath4 are both factors of the same sturmian word @xmath63",
    "[ bispecial]it follows that if @xmath3 and @xmath4 are distinct @xmath6-abelian equivalent words of length @xmath206 then both @xmath3 and @xmath4 are on a binary alphabet and in fact factors of the same sturmian word @xmath63 in fact , if @xmath207 is a bispecial factor of @xmath19 then both @xmath208 and @xmath209 are factors of @xmath63 also , if @xmath9 is a right special factor of @xmath210 then there exists a bispecial factor @xmath207 of @xmath19 with @xmath9 a suffix of @xmath207 and @xmath211 a prefix of @xmath212 thus both @xmath213 and @xmath214 are factors of @xmath63    we will need the next result applied to sturmian words , but we prove it more generally for episturmian words .",
    "we refer the reader to @xcite for the definition and basic properties of episturmian words .",
    "[ simplificationprop ] fix a positive integer @xmath215 let @xmath3 and @xmath4 be factors of the same episturmian word @xmath19",
    ". then @xmath3 and @xmath4 are @xmath6-abelian equivalent if and only if @xmath3 and @xmath4 are @xmath216-abelian equivalent and share a common prefix and a common suffix of length @xmath217 thus , @xmath3 and @xmath4 are @xmath6-abelian equivalent if and only if @xmath3 and @xmath4 are abelian equivalent and share a common prefix and a common suffix of length @xmath217    one direction follows immediately from lemma  [ prefixsuffix ] .",
    "next suppose that @xmath3 and @xmath4 are @xmath216-abelian equivalent factors of the same episturmian word @xmath210 and that @xmath3 and @xmath4 share a common prefix and a common suffix of length @xmath218 to prove that @xmath219 it suffices to show that whenever @xmath220 ( with @xmath221 and @xmath222 we have @xmath223 first let us suppose that @xmath224 is not a right special factor of @xmath19 so that every occurrence in @xmath19 of @xmath224 is a occurrence of @xmath225 then , if @xmath224 is not a suffix of @xmath3 ( and hence not a suffix of @xmath226 we obtain @xmath227 on the other hand if @xmath224 is a suffix of @xmath3 ( and hence also a suffix of @xmath226 we have @xmath228 similarly , in case @xmath229 is not a left special factor of @xmath19 we obtain @xmath223 thus it remains to consider the case when @xmath224 is right special in @xmath19 and @xmath229 is left special in @xmath63 in this case @xmath9 is bispecial and @xmath230 for each @xmath231 let @xmath232 and @xmath233 we must show that @xmath234 however we know that @xmath235 for all @xmath236 since @xmath237 is not left special in @xmath63 now , if @xmath224 is not a suffix of @xmath3 ( and hence not a suffix of @xmath226 we have @xmath238 whence @xmath234 on the other hand if @xmath224 is a suffix of @xmath3 ( and hence a suffix of @xmath226 then @xmath239 whence @xmath240 as required .",
    "the following example illustrates that the assumption in proposition  [ simplificationprop ] that @xmath3 and @xmath4 are factors of the same sturmian word is necessary : let @xmath241 and @xmath242 the @xmath3 and @xmath4 are abelian equivalent and share a common prefix and suffix of length @xmath243 yet they are not @xmath82-abelian equivalent .    we start by showing that if @xmath118 is a sturmian word , and @xmath9 a right special factor of @xmath19 of length @xmath244 then @xmath245 and @xmath246 are @xmath6-abelian equivalent .",
    "this follows from proposition  [ simplificationprop ] since @xmath3 and @xmath4 share a common prefix and a common suffix of lengths @xmath203 and are abelian equivalent .",
    "next we suppose that @xmath3 and @xmath4 are distinct @xmath6-abelian equivalent words of length @xmath181 and show that both @xmath3 and @xmath4 have the required form .",
    "we proceed by induction on @xmath16 in case @xmath68 we have that @xmath3 and @xmath4 are distinct abelian equivalent words of length @xmath82 whence @xmath3 and @xmath4 may be written in the form @xmath247 and @xmath248 for some @xmath249 in @xmath31    next suppose the result of theorem  [ 2k ] is true for @xmath203 and we shall prove it for @xmath16 so let @xmath3 and @xmath4 be distinct @xmath6-abelian equivalent words of length @xmath181 with @xmath250 then by lemma  [ prefixsuffix ] we can write @xmath251 and @xmath252 for some @xmath253 and @xmath254 where @xmath255 since @xmath3 and @xmath4 are distinct , it follows that @xmath256 also , by lemma  [ centralword ] it follows that @xmath257 thus by induction hypothesis , there exist distinct letters @xmath105 and a sturmian word @xmath118 such that @xmath258 and @xmath259 are both factors of @xmath19 of the form @xmath260 and @xmath261 for some right special factor @xmath9 of @xmath19 of length @xmath262    thus we can write @xmath263 and @xmath264 since @xmath265 @xmath266 and @xmath249 it follows that @xmath267 must occur in @xmath259 and hence @xmath268 similarly we deduce that @xmath269    let us first suppose that @xmath270 then @xmath271 must occur in @xmath259 and @xmath272 must occur in @xmath273 hence both @xmath271 and @xmath274 are factors of @xmath63 moreover , since @xmath275 it follows that @xmath9 is not left special in @xmath19 and @xmath211 is not right special in @xmath63 hence every occurrence of @xmath9 in @xmath19 is preceded by @xmath276 and every occurrence of @xmath211 is @xmath19 is followed by @xmath277 since the factors of @xmath19 are closed under reversal , we deduce that @xmath278 and @xmath267 is a right special factor of @xmath63 moreover , since @xmath258 and @xmath259 are both factors of @xmath19 beginning in @xmath9 and ending in @xmath279 it follows that @xmath280 and @xmath281 are both factors of @xmath63    finally suppose @xmath282 so that @xmath9 is a bispecial factor of @xmath63 we may write the increasing sequence of bispecial factors @xmath283 so that @xmath9 is the @xmath15th bispecial factor of @xmath63 we recall that associated to @xmath19 is a sequence @xmath284 ( called the _ directive word _ of @xmath285 defined by @xmath286 is right special in @xmath63 ( see for instance @xcite ) .    without loss of generality",
    "we can suppose that @xmath287 we claim @xmath288 suppose to the contrary that @xmath289 then both @xmath290 and @xmath291 are factors of @xmath259 contradicting that @xmath19 is balanced .",
    "hence we must have @xmath292 and so @xmath293 and @xmath294 now @xmath9 is a bispecial factor of the sturmian word @xmath63 if @xmath224 is a right special factor of @xmath19 then we are done by remark  [ bispecial ] .",
    "otherwise , if @xmath295 is a right special factor of @xmath210 then this means that @xmath296 where @xmath297 is the @xmath15th entry of the directive word of @xmath63 let @xmath298 be a sturmian word whose directive word @xmath299 is defined by @xmath300 for @xmath301 and @xmath302 then @xmath9 is a bispecial factor of @xmath298 and @xmath224 is a right special factor of @xmath303 it follows from remark  [ bispecial ] that both @xmath3 and @xmath4 are factors of @xmath303    as an immediate consequence of theorem  [ 2k ] we have :    let @xmath304 be of the form @xmath305 where @xmath9 is a right special factor of length @xmath203 of a sturmian word .",
    "set @xmath306 then @xmath307      here we shall estimate the number of @xmath6-abelian equivalence classes of words in @xmath90 fix @xmath170 and let @xmath309 be the cardinality of the set @xmath31    [ lem : increasing ] the number of @xmath6-abelian equivalence classes of @xmath310 is at least as large as the number of @xmath6-abelian equivalence classes of @xmath311 .",
    "if @xmath312 or @xmath313 , then the claim is clear . otherwise , let @xmath207 be a set of representatives of the @xmath6-abelian equivalence classes of @xmath308 .",
    "the set @xmath314 has @xmath315 times as many words as @xmath207 . to prove the theorem",
    ", we will show that there can be at most @xmath315 words in @xmath314 that are @xmath6-abelian equivalent .",
    "let @xmath316 and let @xmath317 be @xmath6-abelian equivalent .",
    "it needs to be shown that some of these words are equal .",
    "two of these words must have the same @xmath6th letter , let these be @xmath108 and @xmath318 . because also @xmath319 , it follows that @xmath320 . if @xmath321 , then either @xmath322 ( if @xmath323 ) , or @xmath324 ( if @xmath325 ) .",
    "thus @xmath3 and @xmath4 are @xmath6-abelian equivalent and , by the definition of @xmath207 , @xmath173 .",
    "this proves the claim .",
    "let @xmath326 and let @xmath327 be the set of words of length @xmath15 that start with @xmath328 and end with @xmath329 . for every word @xmath330 we can define a function @xmath331 if @xmath332 , then @xmath172 if and only if @xmath333 . to count the number of @xmath6-abelian equivalence classes , we need to count the number of the functions @xmath334 .",
    "not every function @xmath335 is possible .",
    "it must be @xmath336 and there are also other restrictions , which are determined in lemma [ lem : euler ] .",
    "if a function @xmath337 is given , then a directed multigraph @xmath338 can be defined as follows : the set of vertices is @xmath339 , and if @xmath340 , where @xmath341 , then there are @xmath342 edges from @xmath328 to @xmath329 . if @xmath343 , then this multigraph is related to the rauzy graph of @xmath344 . in the next lemma , @xmath345 denotes the indegree and @xmath346 the outdegree of a vertex in @xmath338 .",
    "[ lem : euler ] for a function @xmath337 and words @xmath326 , the following are equivalent :    a.   [ euler1 ] there is a number @xmath15 and a word @xmath330 such that @xmath343 , b.   [ euler2 ] there is an eulerian path from @xmath328 to @xmath329 in @xmath338 , c.   [ euler3 ] the underlying graph of @xmath338 is connected , except possibly for some isolated vertices , and @xmath347 for every vertex @xmath168 , except that if @xmath348 , then @xmath349 and @xmath350 , d.   [ euler4 ] the underlying graph of @xmath338 is connected , except possibly for some isolated vertices , and @xmath351 where @xmath352    @xmath353 : @xmath354 and @xmath343 if and only if @xmath355 is an eulerian path in @xmath338 .",
    "@xmath353 : this is well known .",
    "@xmath353 : is just a reformulation of in terms of the function @xmath356 .    in the next lemma",
    "we consider the independence of homogeneous systems related to the equations and .",
    "[ lem : degrsyst ] let @xmath357 , where @xmath321 , be @xmath358 unknowns .",
    "the system of equations @xmath359 is not independent , but all of its proper subsystems are .",
    "if we add the equation @xmath360 to one of these independent systems , then the system remains independent .",
    "the sum of the equations is a trivial identity @xmath361 so every one of these equations follows from the other @xmath362 equations .",
    "if @xmath363 are two different words , then @xmath364 for all @xmath135 is a solution of all the equations , except those with @xmath365 or @xmath366 .",
    "this proves that all subsystems are independent .",
    "addition of keeps them independent , because @xmath367 for all @xmath135 is a solution of the system but not of .",
    "let @xmath368 and @xmath309 be fixed numbers and let @xmath2 be an @xmath315-letter alphabet .",
    "the number of @xmath6-abelian equivalence classes of @xmath308 is @xmath369    let @xmath370 , @xmath371 and @xmath372 . by lemma [ lem : euler ] , there is a word @xmath373 such that @xmath343 only if @xmath356 satisfies and .",
    "consider the system formed by these equations .",
    "the function @xmath334 satisfies the equations for every @xmath373 , so the system has a solution . by lemma [ lem : degrsyst ] ,",
    "the rank of the coefficient matrix of the system is @xmath374 , so the general solution of this system is of the form @xmath375 where the words @xmath376 and @xmath377 form the set @xmath378 and @xmath379 are rational numbers . because @xmath380 there are @xmath381 possible functions @xmath356 .",
    "let @xmath382 and consider the system of equations .",
    "by lemma [ lem : degrsyst ] , the general solution of this homogeneous system is of the form @xmath383 where the words @xmath376 and @xmath377 form the set @xmath378 and @xmath384 are rational numbers .",
    "the coefficients @xmath384 do not depend on @xmath15 .",
    "let @xmath385 and let @xmath386 be the least common multiple of the denominators of the numbers @xmath384 .",
    "every constant function @xmath356 satisfies the system of equations .",
    "in particular , @xmath387 for all @xmath135 is a solution of the system . if we let @xmath388 then the numbers @xmath389 given by are integers and @xmath390 for all @xmath321 .",
    "because @xmath391 for all @xmath135 , the underlying graph of @xmath338 is connected , so by lemma [ lem : euler ] there is a word @xmath392 such that @xmath343 .",
    "because @xmath393 for all @xmath135 , we get @xmath394 there are @xmath395 ways to choose the numbers @xmath396 .",
    "every choice gives a different function @xmath343 for some @xmath392 such that @xmath397 .",
    "let these words be @xmath398 .",
    "no two of them are @xmath6-abelian equivalent . among these words",
    "there are at least @xmath399 words of equal length . by lemma [",
    "lem : increasing ] , there are at least @xmath399 words of length @xmath15 such that no two of them are @xmath6-abelian equivalent , and @xmath400 .",
    "in this section we prove that if @xmath401 for some @xmath402 and @xmath79 then @xmath19 is ultimately periodic ( see corollary  [ evperiodic ] below ) . for this purpose",
    "we introduce an auxiliary family of equivalence relations @xmath403 on @xmath5 defined as follows : let @xmath404 give @xmath405 we write @xmath406 if and only if @xmath407 ( i.e. , @xmath408 ) and @xmath3 and @xmath4 share a common prefix and a common suffix of lengths @xmath409 in case @xmath410 then @xmath411 means @xmath124    it follows immediately from lemma  [ prefixsuffix ] that    @xmath412    in general the converse is not true : for example , taking @xmath413 and @xmath414 we see that @xmath415 yet @xmath3 and @xmath4 are not @xmath82-abelian equivalent .",
    "however , in view of proposition  [ simplificationprop ] we have :    let @xmath3 and @xmath4 be two factors of a sturmian word @xmath19 , and @xmath404 then @xmath416 if and only if @xmath417    let @xmath418 associated to the relation @xmath403 is a complexity function , denoted @xmath419 which counts the number of distinct @xmath403 equivalence classes of factors of @xmath19 of length @xmath20 it follows from ( [ imp ] ) above that for each @xmath15 we have    @xmath420    we recall the function @xmath76 ( @xmath421 defined by    @xmath77    [ theoremevperiodic2 ] let @xmath104 and @xmath0 if @xmath422 for some @xmath79 then @xmath19 is ultimately periodic .",
    "the result is well known in case @xmath66 ( see @xcite ) .",
    "for @xmath423 we proceed by induction on @xmath16 in case @xmath68 then @xmath424 is simply the usual notion of abelian equivalence and the result follows from @xcite .",
    "now suppose @xmath425 and that @xmath422 for some @xmath426 it follows immediately from the definition of @xmath427 that if @xmath428 and @xmath429 then @xmath124 thus , if @xmath430 where @xmath431 then @xmath432 and so @xmath19 is ultimately periodic by the well known result of morse and hedlund in @xcite .",
    "thus we suppose that @xmath433 for some @xmath434 we claim that @xmath19 must be ultimately periodic .",
    "suppose to the contrary that @xmath19 is aperiodic .",
    "we shall show that this implies that @xmath435 where @xmath436 denotes the first shift of @xmath210 i.e. , the word obtained from @xmath19 by removing the first letter of @xmath63 since @xmath437 we deduce that @xmath438 but then by induction hypothesis on @xmath8 it follows that @xmath439 ( and hence @xmath285 is ultimately periodic , a contradiction .",
    "consider the map @xmath440    defined by @xmath441_k ) = [ u]_{k-1}\\ ] ] where @xmath202 and @xmath304 of length @xmath442 here @xmath443_k$ ] denotes the @xmath403 equivalence class of @xmath101 to see that @xmath444 is well defined , suppose @xmath445 then since @xmath446 it follows that @xmath447 and @xmath448 and thus that @xmath449 moreover as @xmath196 and @xmath450 share a common prefix and suffix of length @xmath8 it follows that @xmath3 and @xmath4 share a common prefix and suffix of length @xmath409 thus @xmath451 as required .",
    "clearly the mapping @xmath444 is surjective , in fact for each @xmath452 there exist @xmath105 such that @xmath453 this is the reason for replacing @xmath19 by @xmath454    we now show that either there exist distinct classes @xmath455_{k-1},[v]_{k-1}\\in { \\mathcal f}_{\\nu}(n_0 - 2)/\\mathcal { r}_{k-1}$ ] for which @xmath456_{k-1})\\right ) , \\mbox{card}\\left(\\psi^{-1}([v]_{k-1})\\right)\\}\\geq 2,\\ ] ] or there exists a class @xmath455_{k-1}\\in { \\mathcal f}_{\\nu}(n_0 - 2)/\\mathcal { r}_{k-1}$ ] for which @xmath457_{k-1})\\right)\\geq 3.\\ ] ] in either case it follows that @xmath458    since @xmath19 is assumed to be aperiodic , @xmath19 contains both a left special factor of the form @xmath459 and a right special factor of the form @xmath460 of lengths @xmath461 for some choice of @xmath462 and @xmath188 thus there exist distinct letters @xmath221 such that @xmath463 and @xmath464 are factors of @xmath63 moreover since @xmath465 it follows that @xmath466_k\\neq [ buc]_k.$ ] thus @xmath467_{k-1})\\right)\\geq 2.$ ] similarly , there exist distinct letters @xmath468 such that @xmath469 and @xmath470 are factors of @xmath210 and since @xmath471 it follows that @xmath472_k\\neq [ dvb']_k.$ ] thus @xmath473_{k-1})\\right)\\geq 2.$ ] in case @xmath455_{k-1}\\neq [ v]_{k-1},$ ] we obtain the desired inequality  ( [ ( * ) ] ) . in case @xmath455_{k-1}= [ v]_{k-1},$ ] since @xmath249 and @xmath474",
    "it follows that @xmath475_k , [ buc]_k , [ dua']_k,[dub']_k\\}\\geq 3\\ ] ] which yields the inequality  ( [ ( * * ) ] ) this completes the proof of theorem  [ theoremevperiodic2 ]    [ evperiodic ] let @xmath71 and @xmath0 if @xmath401 for some @xmath476 then @xmath19 is ultimately periodic .    as a consequence of the inequality ( [ comps ] ) , if @xmath401 then @xmath477 whence by theorem  [ theoremevperiodic2 ] it follows that @xmath19 is ultimately periodic .",
    "the same method of proof of theorem  [ theoremevperiodic2 ] can be used to prove the following :    [ theoremperiodic ] let @xmath478 be a bi - infinite word over the alphabet @xmath2 and @xmath0 if @xmath401 for some @xmath79 then @xmath19 is periodic .",
    "we conclude this section with a few remarks :     in the special case @xmath479 the condition given in corollary  [ evperiodic ] gives a characterization of ultimately periodic words by means of factor complexity : @xmath71 is ultimately periodic if and only if @xmath480 for some @xmath481 however , @xmath6-abelian complexity does not yield such a characterization . indeed",
    ", both sturmian words and the ultimately periodic word @xmath81 have the same abelian complexity .",
    "more generally , the ultimately periodic word @xmath482 has the same @xmath6-abelian complexity as a sturmian word ( see theorem  [ thm : factcompl ] below ) .",
    "the result of corollary  [ theoremperiodic ] is already known to be true in the special cases @xmath66 ( see @xcite ) and @xmath13 ( see remark 4.07 in @xcite ) . in these special cases ,",
    "the converse is also true .",
    "but for general @xmath483 the converse is false .",
    "for instance , let @xmath484 and let @xmath3 be a word containing at least one occurrence of every @xmath485 let @xmath19 be the periodic word @xmath486 then @xmath487 for every @xmath85",
    "in this section we determine the @xmath6-abelian complexity of sturmian words and show that for each @xmath8 the complexity function @xmath21 completely characterizes sturmian words amongst all aperiodic words .",
    "more precisely :    [ thm : factcompl ] fix @xmath404 let @xmath71 be an aperiodic word .",
    "the following conditions are equivalent :    * @xmath19 is a balanced binary word , that is , _",
    "sturmian_. *   _ ^(k)(n ) = q^(k)(n ) = + n + 1 & + 2k & + .",
    "our proof of theorem  [ thm : factcompl ] will make use of the following functions @xmath488 , which transform binary words by changing the letters around a specific point . for words",
    "@xmath489 we define @xmath490 as follows : @xmath491    [ lem : facttrans ] let @xmath96 and let @xmath492 be sturmian .",
    "there is a word @xmath493 and a permutation @xmath494 of @xmath495 such that if @xmath496 for @xmath497 , then @xmath498 are the factors of @xmath344 of length @xmath15 .",
    "let @xmath499 be the factors of @xmath344 of length @xmath15 in lexicographic order .",
    "if follows from theorem 1.1 . in @xcite that for every @xmath114 there is an @xmath315 such that @xmath500 .",
    "it needs to be proved that the @xmath315 s are all different .",
    "let @xmath500 and @xmath501 .",
    "for every @xmath502 @xmath503 and for @xmath504 @xmath505 if @xmath506 , then @xmath507 which contradicts the balance property of sturmian words .",
    "the factors of the fibonacci word of length six are @xmath508 we have @xmath509 and @xmath510 .",
    "there are no other 2-abelian equivalences between these factors .",
    "first let us suppose @xmath511 is sturmian and let @xmath512 let @xmath513 by lemma  [ lem : basic ] two factors @xmath3 and @xmath4 of @xmath19 of length @xmath15 are @xmath6-abelian equivalent if and only @xmath124 thus @xmath514 as required .",
    "next let @xmath515 and let @xmath498 and @xmath494 be as in lemma [ lem : facttrans ] . if @xmath516 , then there are words @xmath517 and @xmath518 and letters @xmath519 so that @xmath520 and @xmath521 .",
    "we prove that @xmath522 .",
    "the prefixes and suffixes of @xmath523 and @xmath524 of length @xmath203 are the same .",
    "the factors of @xmath523 of length @xmath6 are the factors of @xmath525 , @xmath526 and @xmath527 of length @xmath6 , and the factors of @xmath524 of length @xmath6 are the factors of @xmath525 , @xmath528 and @xmath527 of length @xmath6 . because @xmath526 and @xmath528 are factors of @xmath344",
    ", it follows that @xmath3 is right special and @xmath4 is left special and hence equal to the reversal of @xmath3 . by theorem  [ 2k ] , @xmath526 and @xmath528 are @xmath6-abelian equivalent .",
    "this proves that @xmath529 if @xmath516 .",
    "thus the words @xmath498 are in at most @xmath181 different @xmath6-abelian equivalence classes and @xmath530 . by corollary [ evperiodic ] , @xmath531 .",
    "next let @xmath532 and let @xmath71 be aperiodic and @xmath533    taking @xmath534 we see that @xmath19 is binary , ( say @xmath535 we must show that @xmath19 is balanced .",
    "we first recall some basic facts concerning factors of sturmian words ( see for instance @xcite ) : let @xmath536 be a sturmian word , and let @xmath537 denote the factors of @xmath538 of length @xmath20 the set @xmath539 is completely determined from the set @xmath537 unless @xmath538 has a bispecial factor @xmath207 of length @xmath540 in which case both @xmath541 and @xmath542 are factors of @xmath538 and exactly one of the two is right special .",
    "if @xmath541 is right special , then every occurrence of @xmath542 in @xmath538 is an occurrence of @xmath543 if @xmath4 is a factor of @xmath538 and @xmath3 a prefix of @xmath38 we write @xmath544 if every occurrence of @xmath3 in @xmath538 is an occurrence of @xmath10 thus if @xmath541 is right special , then @xmath545 and similarly if @xmath542 is right special , then @xmath546    now suppose to the contrary that the aperiodic binary word @xmath19 is not sturmian .",
    "then there exists a smallest positive integer @xmath547 and a sturmian word @xmath538 such that @xmath548 but @xmath549 for every choice of sturmian word @xmath550 this means that @xmath19 has a bispecial factor @xmath207 of length @xmath540 and both @xmath541 and @xmath542 are in @xmath57 and one of the following must occur : i ) neither @xmath541 nor @xmath542 is right special in @xmath551 ii ) there exists a unique @xmath552 such that @xmath553 is right special , and @xmath554 iii ) both @xmath541 and @xmath542 are right special in @xmath63 we will show that since @xmath19 is aperiodic , only case iii ) is in fact possible .",
    "clearly , if neither @xmath541 nor @xmath542 were right special , then @xmath555 whence @xmath19 is ultimately periodic , a contradiction .",
    "next suppose case ii ) occurs .",
    "we may suppose without loss of generality that @xmath541 is right special and @xmath556 if @xmath557 ( and hence @xmath558 then we would have @xmath559 for every @xmath547 from which it follows that the tail of @xmath19 corresponding to the first occurrence of @xmath560 on @xmath19 is periodic .",
    "thus if @xmath561 then there exists a bispecial factor @xmath562 of @xmath19 with @xmath563 such that @xmath564 is right special and @xmath565 and hence @xmath566 writing @xmath567 we have @xmath568 we next show by induction on @xmath15 that @xmath569 is a palindrome for each @xmath85 clearly this is true for @xmath534 since @xmath570 next suppose @xmath569 is a palindrome .",
    "then @xmath571 having established that @xmath569 is a palindrome , it follows that @xmath572 is a suffix of @xmath569 and hence @xmath573 for each @xmath117 whence as before @xmath478 is ultimately periodic .",
    "thus if @xmath19 is not sturmian , case iii ) must occur .",
    "this implies that @xmath574 and @xmath575 since @xmath538 is sturmian , the number of @xmath6-abelian classes of factors of @xmath538 of length @xmath115 is equal to @xmath576 but the additional factor @xmath577 of @xmath19 of length @xmath115 introduces a new @xmath6-abelian class since it is not even abelian equivalent to any other factor of @xmath538 ( and hence @xmath285 of length @xmath578 thus @xmath579 a contradiction .",
    "thus @xmath19 is sturmian .    in view of corollary  [ evperiodic ] , within the class of aperiodic words , sturmian words have the lowest possible @xmath6-abelian complexity .",
    "see @xcite for other instances in which sturmian words have the lowest complexity amongst all aperiodic words .",
    "there is great interest in avoidability of repetitions in infinite words .",
    "this originated with the classical work of thue @xcite and @xcite , in which he established the existence of an infinite binary ( resp .",
    "ternary ) word avoiding cubes ( resp .",
    "squares ) .",
    "it was later shown that to avoid abelian cubes or abelian squares , one needs @xmath127-letter or @xmath128-letter alphabets respectively ( see @xcite and @xcite ) .",
    "the corresponding problems for @xmath6-abelian repetitions turned out to be quite nontrivial .",
    "it follows easily that the smallest alphabet where @xmath6-abelian cubes can be avoided is either @xmath82 or @xmath580 and similarly the smallest alphabet where @xmath6-abelian squares can be avoided is either @xmath127 or @xmath581 in the latter case for @xmath582 a computer verification revealed that the correct value is @xmath583 as in the case of abelian repetitions : each ternary @xmath82-abelian square - free word is of length at most @xmath584 @xcite . in the former case computer verification",
    "shows that there exist binary words of length @xmath585 which are @xmath82-abelian cube - free @xcite .",
    "it is still unknown whether there exists an infinite binary word which is @xmath82-abelian cube - free .",
    "for some larger values of @xmath6 such infinite words exist . in the case of binary alphabets and",
    "cubes it was shown in a sequence of papers that an infinite word avoiding @xmath6-abelian cubes can be constructed for @xmath586 , @xmath587 and for @xmath588 ( see @xcite , @xcite and @xcite respectively ) .",
    "so only the value @xmath582 remains open .",
    "it would be extremely surprising if no such infinite words exist . for avoiding @xmath6-abelian squares in a ternary alphabet",
    "the situation is equally challenging .",
    "we know that for @xmath588 there exist words of length @xmath585 avoiding @xmath127-abelian squares .",
    "the avoidability in infinite words of @xmath6-abelian squares in a ternary alphabet is only known for large values of @xmath6 ( @xmath589 ( see @xcite ) .    in this section",
    "we prove that @xmath6-abelian repetitions are unavoidable in words having bounded @xmath6-abelian complexity . for each positive integer @xmath6",
    "we set @xmath590 given an infinite word @xmath591 for each @xmath592 we denote by @xmath593 $ ] the factor @xmath594    let @xmath6 and @xmath207 be positive integers and @xmath418",
    "we say @xmath19 is @xmath595-balanced if and only if for all factors @xmath3 and @xmath4 of @xmath19 of equal length , and for all @xmath596 we have @xmath597 we say @xmath19 is arbitrarily @xmath6-imbalanced if @xmath19 is not @xmath595-balanced for any positive integer @xmath212        clearly if @xmath598 is bounded , say by @xmath599 then @xmath19 is @xmath600-balanced .",
    "conversely , if @xmath19 is @xmath595-balanced , then for each positive integer @xmath15 and for each @xmath7 with @xmath43 we have",
    "@xmath601 it follows that @xmath602 where @xmath603    fix a positive integer @xmath16 it follows from theorem  [ thm : factcompl ] and lemma  [ balance ] that each sturmian word is @xmath595-balanced for some positive integer @xmath207 ( depending on @xmath604 actually , i. fagnot and l. vuillon proved in @xcite that every sturmian word is @xmath605-balanced .",
    "[ kabpowers ] fix @xmath404 let @xmath608 be an infinite word on a finite alphabet @xmath2 having bounded @xmath6-abelian complexity .",
    "let @xmath609 be a set of positive upper density , that is @xmath610 then , for every positive integer @xmath28 , there exist @xmath114 and @xmath611 such that @xmath612 and the @xmath28 consecutive blocks @xmath613)_{0\\leq j\\leq n-1}$ ] of length @xmath614 are pairwise @xmath6-abelian equivalent .",
    "in particular , @xmath19 contains arbitrarily high @xmath6-abelian powers .",
    "it is known that a sturmian word @xmath19 contains an @xmath28-power for each positive integer @xmath28 if and only if the sequence of partial quotients in the continued fraction expansion of the slope of @xmath19 is unbounded .",
    "so , a sturmian word whose corresponding slope has bounded partial quotients ( e.g. , the fibonacci word ) will not contain @xmath28-powers for @xmath28 sufficiently large ( e.g. , the fibonacci word contains no @xmath128-powers @xcite ) .",
    "however , every sturmian word will contain arbitrarily high @xmath6-abelian powers .",
    "let @xmath609 be a set of positive upper density .",
    "first we consider the case @xmath80 by assumption @xmath618 is bounded .",
    "this is equivalent to saying that @xmath19 has bounded factor complexity .",
    "it follows by morse - hedlund that @xmath19 is ultimately periodic , i.e. , @xmath619 for some @xmath620 for each @xmath621 set @xmath622 pick @xmath623 such that the set @xmath624 has positive upper density .",
    "then an arithmetic progression of length @xmath625 in @xmath624 ( guaranteed by szemerdi s theorem ) determines the @xmath28th power of some cyclic conjugate of @xmath626    next let us fix positive integers @xmath6 and @xmath28 and assume that @xmath627 is bounded .",
    "it follows by lemma  [ balance ] that @xmath19 is @xmath595-balanced for some positive integer @xmath212 we recall the following lemma proved in @xcite    [ la][lemma  5.4 in @xcite ] let @xmath6 and @xmath207 be positive integers .",
    "there exist positive integers @xmath628 for each @xmath629 and a positive integer @xmath630 such that whenever @xmath631 for integers @xmath632 with @xmath633 for each @xmath634 then @xmath635 for each @xmath636      where @xmath641 and @xmath630 are as in lemma  [ la ] .",
    "note that the second coordinate of @xmath642 is the suffix of length @xmath181 of @xmath643.$ ] we note also that if @xmath644 for some @xmath645 then by considering the first coordinate of @xmath646 one has          @xmath646 defines a finite partition of @xmath638 where two elements @xmath650 and @xmath168 in @xmath638 belong to the same class of the partition if and only if @xmath651 clearly at least one class of this partition of @xmath638 has positive upper density .",
    "thus by szemerdi s theorem , there exist positive integers @xmath650 and @xmath135 with @xmath652 such that @xmath653 and @xmath654    we now claim that the @xmath28 consecutive blocks of length @xmath135 @xmath655\\omega[r+t+1,r+2t]\\omega[r+2t+1,r+3t]\\ldots \\omega[r+(n-1)t+1 , r+nt]\\ ] ] are pairwise @xmath6-abelian equivalent .",
    "this would prove that @xmath19 contains a @xmath6-abelian @xmath28-power in position @xmath656          but since @xmath665|= |\\omega[r+jt-|x|+2,r + ( j+1)t]|=|x|+t-1\\ ] ] and @xmath19 is @xmath595-balanced , it follows that @xmath666|_x-|\\omega[r+jt-|x|+2,r + ( j+1)t]|_x\\rvert\\leq b\\ ] ] whence by lemma  [ la ] we deduce that for each @xmath629 @xmath667|_x=|\\omega[r+jt-|x|+2,r + ( j+1)t]|_x.\\end{aligned}\\ ] ]    since @xmath668 the second coordinate of @xmath646 gives @xmath669=\\omega[r+jt -k + 1 , r+jt+k].\\ ] ] together with ( [ phew ] ) we deduce that for each @xmath636 @xmath670|_x=|\\omega[r+jt+1,r + ( j+1)t]|_x.\\ ] ]                                          v.  kernen .",
    "abelian squares are avoidable on @xmath128 letters . in w.",
    "kuich , editor , _ proceedings of icalp1992 ( international conference on automata , languages and programming - vienna 1992 ) _ , volume 623 of _ lecture notes in comput .",
    "_ , pages 4152 .",
    "springer , berlin , 1992 ."
  ],
  "abstract_text": [
    "<S> in this paper we introduce and study a family of complexity functions of infinite words indexed by @xmath0 let @xmath1 and @xmath2 be a finite non - empty set . </S>",
    "<S> two finite words @xmath3 and </S>",
    "<S> @xmath4 in @xmath5 are said to be @xmath6-abelian equivalent if for all @xmath7 of length less than or equal to @xmath8 the number of occurrences of @xmath9 in @xmath3 is equal to the number of occurrences of @xmath9 in @xmath10 this defines a family of equivalence relations @xmath11 on @xmath12 bridging the gap between the usual notion of abelian equivalence ( when @xmath13 ) and equality ( when @xmath14 we show that the number of @xmath6-abelian equivalence classes of words of length @xmath15 grows polynomially , although the degree is exponential in @xmath16 given an infinite word @xmath17 we consider the associated complexity function @xmath18 which counts the number of @xmath6-abelian equivalence classes of factors of @xmath19 of length @xmath20 we show that the complexity function @xmath21 is intimately linked with periodicity . </S>",
    "<S> more precisely we define an auxiliary function @xmath22 and show that if @xmath23 for some @xmath1 and @xmath24 the @xmath19 is ultimately periodic . </S>",
    "<S> moreover if @xmath19 is aperiodic , then @xmath25 if and only if @xmath19 is sturmian . </S>",
    "<S> we also study @xmath6-abelian complexity in connection with repetitions in words . using szemerdi s theorem </S>",
    "<S> , we show that if @xmath19 has bounded @xmath6-abelian complexity , then for every @xmath26 with positive upper density and for every positive integer @xmath27 there exists a @xmath6-abelian @xmath28 power occurring in @xmath19 at some position @xmath29    abelian equivalence , complexity of words , sturmian words , szemerdi s theorem </S>",
    "<S> . 68r15 </S>"
  ]
}