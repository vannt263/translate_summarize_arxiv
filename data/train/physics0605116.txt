{
  "article_text": [
    "the study of multivariate data recorded by monitoring a wide class of physical @xcite , biological @xcite and economic systems @xcite is an interesting and challenging task in the investigation of complex systems .",
    "many efforts have been done in the analysis of multivariate time series , several of them focusing on the study of pair cross - correlation between elements of the system . in the analysis of cross - correlation one",
    "faces with statistical uncertainty due to the finite length of time series , with the noise due to the interaction of the system with the environment and also with the intrinsic complexity of interactions among elements of the system .",
    "attempts to overcome these problems may require to filter out statistically reliable information from the correlation matrix .",
    "classical spectral methods @xcite and related refinements @xcite , clustering @xcite and graph theory @xcite revealed to be fruitful approaches to the analysis of empirical data of correlation based systems @xcite . in this paper we exploit the deep relation between the single linkage cluster analysis ( slca ) @xcite which is a classical technique of hierarchical clustering , and the minimum spanning tree ( mst ) @xcite which is a classical concept of graph theory @xcite , to introduce a new tree that we name average linkage minimum spanning tree ( almst ) .",
    "this graph is deeply related to another classical technique of hierarchical clustering , namely the average linkage cluster analysis ( alca ) @xcite .",
    "this method is widely used in phylogenetic analysis where it is known as  unweighted pair group method using arithmetic averages \" ( upgma ) @xcite . the motivation for introducing the almst as a counterpart in graph theory of alca bears both on the relevance of the alca in the study of correlation based systems such as gene expression data @xcite and stock returns @xcite and on the extra information carried by the mst ( almst ) with respect to the slca ( alca ) . in our investigation",
    "we have observed that the mst and almst are sharing information usually accounted by a significant percentage of common links .",
    "it is then worth to understand and measure the reliability of links accounting for both the finite length of time series and the data distribution .",
    "we propose here to measure such a reliability with the bootstrap technique .",
    "this technique is widely used in phylogenetic analysis as a measure of phylogenetic reliability but it has never been applied to correlation based graphs to our knowledge .",
    "striking advantages of the bootstrap approach to test the link reliability are ( i ) that it does not need to introduce assumptions about the data distribution and ( ii ) that it naturally takes into account the length of time series .",
    "the only disadvantage that we can recognize is that the procedure is rather computationally time consuming for large networks .",
    "the paper is organized as follows . in section [ review ]",
    "we review some of the most popular tools used to filter out information in correlation based systems . in section [ methods ]",
    "we discuss both the construction of almst and the bootstrap approach we introduce to measure the link reliability . in section [ empirical ]",
    "we apply the tools introduced in section [ methods ] to daily price returns of the 300 most capitalized stocks traded at new york stock exchange ( nyse ) during the time period 2001 - 2003 . finally in section [ conclusions ] we draw our conclusions .",
    "in the introduction we have briefly discussed the necessity of filtering robust information in correlation based systems . the tools used to extract such an information can be divided essentially in three branches , specifically spectral methods , clustering methods and correlation based graphs .",
    "+ spectral methods are used to deal with multivariate systems since the beginning of 20th century .",
    "the most famous technique is the principal component analysis ( pca ) @xcite .",
    "the idea behind pca is to evaluate eigenvalues of the correlation matrix of the system , retain the @xmath0 greatest eigenvalues and project the empirical multivariate signal onto the sub - space generated by the corresponding @xmath0 eigenvectors .",
    "this approach allows one to reduce the complexity of the system .",
    "indeed by indicating with @xmath1 the dimensionality of the system , usually @xmath2 . at the same time",
    ", taking the first @xmath0 eigenvalues guarantees that the percentage of variance explained by the @xmath0 eigenvectors is the maximum value allowed by a @xmath0 mode projection of the data set @xcite .",
    "finally , a factor model @xcite explaining the filtered correlation matrix can be constructed .",
    "the factor model allows one to simulate multivariate time series of arbitrary length @xmath3 such that , when t approaches infinity , the correlation matrix of simulated time series approaches exactly the correlation matrix filtered by pca .",
    "a problematic aspect of pca is that the number @xmath0 of retained eigenvalues is a free parameter of the method .",
    "the random matrix theory gives the spectral distribution of the correlation matrix obtained from @xmath1 time series of length @xmath3 of independent gaussian variables asymptotically over @xmath3 and @xmath1 with fixed ratio @xmath4 @xcite .",
    "the random matrix theory indicates the maximum eigenvalue @xmath5 consistent with the hypothesis of independent random variables .",
    "this result can be applied to empirical correlation matrices to select the number @xmath0 of retained eigenvalues .",
    "all the eigenvalues greater than @xmath5 should be retained @xcite .",
    "such an approach has been fruitfully applied to the analysis of financial markets @xcite .",
    "the main findings relate to the interpretation of retained eigenvalues and corresponding eigenvectors .",
    "usually the eigenvector associated to the greatest eigenvalue has components roughly degenerate , meaning that all stocks participate almost in the same way to the first eigenvalue .",
    "this fact suggested to interpret the first eigenvector as the so called  market mode \" @xcite .",
    "other eigenvalues beside the greatest one resulted to be incompatible with the hypothesis of independent variables .",
    "usually the corresponding eigenvectors have many near - zero components and then they should reveal communities of stocks in the market .",
    "such communities involve stocks belonging to one or a few economic sectors @xcite .",
    "clustering techniques are used to reveal communities of elements in correlation based systems .",
    "the idea is that elements belonging to the same community share more information than elements belonging to different communities .",
    "the shared information is evaluated in terms of a similarity measure such as , for example , the correlation coefficient .",
    "the aim of clustering is to group together similar elements to get a significant partition of the system into communities ( clusters ) . for a review of the most used techniques",
    "see for instance ref .",
    "newer techniques are for instance the superparamegnetic clustering of data @xcite , which has been applied to financial data in ref .",
    "@xcite , the maximum likelihood data clustering @xcite , the sorting points into neighborhoods @xcite .",
    "clustering procedures can also be used to identify a skeleton of interactions in the system .",
    "this is provided for instance by hierarchical clustering procedures in which communities are overlapping .",
    "specifically , they are organized in a nested hierarchical structure @xcite .",
    "the idea of hierarchical clustering is that elements are sharing information according to the communities they belong to and communities are organized in a nested structure .",
    "we shall clarify this point with a simple example of nested communities .",
    "consider two very important corporations like microsoft corp .",
    "and intel corp .. according to a standard economic classification both stocks belong to the economic sector of technology , i.e. they belong to the same community at the level of economic sector .",
    "further specification of the activity of stocks is possible .",
    "microsoft corp .",
    "is belonging to the economic sub - sector of  software & programming \" whereas intel corp .",
    "is belonging to the economic sub - sector of  semiconductors \" .",
    "this means that at the hierarchical level of sub - sectors microsoft corp . and intel corp .",
    "belong to different communities .",
    "+ in this paper we shall concentrate on two hierarchical clustering techniques , i.e. the slca and the alca .",
    "the slca has been widely used to analyze the correlation between stocks in financial markets since the study of ref . @xcite .",
    "such an approach revealed that stocks belonging to specific economic sectors ( e.g. the sector of energy ) cluster together at a high correlation level whereas stocks belonging to sectors such as conglomerates never identify a community .",
    "intermediate behavior has also been observed @xcite .",
    "the alca is widely used in the analysis of microarray data @xcite . in the study of multivariate biological systems this clustering procedure",
    "is usually preferred to other classical techniques of hierarchical clustering because of its property of averaging interactions .",
    "it has also been shown in ref .",
    "@xcite that a comparative usage of slca , alca and random matrix theory is suitable for the investigation of financial markets .",
    "+ graph theory is now widely used in the analysis of complex systems .",
    "many physical , biological and social systems are suitably described by networks .",
    "examples are internet @xcite , social networks @xcite , food webs @xcite , scientific citations @xcite and sexual contacts among individuals @xcite .",
    "+ graph theory is also useful to extract information in correlation based systems .",
    "consider a system of @xmath1 elements .",
    "the pair correlation coefficient between elements can be interpreted as the strength of the link connecting pairs of elements . in other words",
    "the system can be described by a complete network , i.e. a network of elements all connected one with each other , with weights associated to links according to the correlation coefficients .",
    "the topological structure of such a network is so simple ( complete graph ) that no information can be directly extracted from the topology .",
    "the idea is then to extract a subgraph from the complete network accounting for the weights of links .",
    "this procedure aims to translate the information contained in the correlation matrix of the system into the topological structure of the subgraph and then exploiting techniques of graph theory @xcite to analyze such an information . +",
    "a widely used subgraph of the complete network is the mst which is the spanning tree of shortest length @xcite . a discussion about the properties of the mst and an illustrative algorithm for its construction is given in section [ methods ] .",
    "it is known @xcite that the mst is deeply related to the slca ( see next section ) .",
    "the number of links retained in the mst is @xmath6 for a system of @xmath1 elements and the tree is a connected graph .",
    "it has been shown that the mst is a powerful method to investigate financial systems @xcite . in ref .",
    "@xcite the mst has been used to analyze the system of the 100 most capitalized stocks traded in us equity markets .",
    "the aim of such a study was to understand how the structure of the correlation matrix changes when stock returns are evaluated at different time horizons .",
    "the result is that at short time horizons ( 5 min ) the mst has a star like shape , the center of the star being the most capitalized stock of the system , i.e general electric .",
    "when the time horizon is increased the star - like shape progressively disappears and branches of stocks mostly corresponding to specific economic sectors appear .",
    "these results suggest that at short time horizons the system is dominated by the  market mode \" , whereas at longer time horizons the information about economic sectors becomes relevant .",
    "another interesting result obtained by investigating the mst properties is related to the behavior of the market in proximity of a crash , such as the black monday , where a topological change of the tree is observed @xcite . + a generalization of the mst construction procedure relaxing the topological constraint that the resulting graph is a tree has been proposed in ref .",
    "the first level of generalization requires that the resulting graph is topologically planar , i.e. the graph can be drawn on a plane without crossing of links .",
    "such a graph , named planar maximally filtered graph , allows topological structures forbidden in the mst such as loops and cliques @xcite that can be relevant for the analysis of correlation based systems .",
    "specifically , the introduction of the  connection strength \" @xcite allows one to estimate the strength of connections of elements belonging to the same community and to investigate the structure of connections between communities such as , for example , stocks belonging to the same economic sector @xcite .",
    "another way to construct a subgraph from the complete network is to introduce a correlation threshold and then to remove those links with a correlation coefficient smaller than the threshold . despite of its simplicity",
    "this method has shown to be useful in the study of economic @xcite and biological @xcite systems . in ref .",
    "@xcite authors study how graph changes when one reduces the value of the correlation threshold .",
    "the results of such an analysis are compared with those obtained for random graphs .",
    "one of the main results is that the formation of connected components in the empirical graph is incompatible with the corresponding formation in random graphs .",
    "a characteristic of this approach is that it is highly improbable to obtain a filtered network connecting all elements via some path by retaining a number of links of the same order of the number @xmath1 of elements .",
    "then with a number of links of order @xmath1 it is rather difficult to describe interactions between any pair of elements of the system because the resulting graph is disconnected .",
    "in subsection [ almstmet ] we outline the algorithm producing the almst whereas in subsection [ bootstrap ] we describe the measure of link reliability obtained by exploiting bootstrap replicas of data .      in order to show how it is possible to associate a spanning tree to the alca it is useful to consider first an algorithm that generates the mst and performs at the same time the slca of the system . consider a system of @xmath1 elements with estimated correlation matrix @xmath7 of elements @xmath8 . to describe the algorithm it is necessary to recall the concept of connected component of a graph @xmath9 containing a given vertex @xmath10",
    ". the connected component of @xmath9 containing the vertex @xmath10 is the maximal set of vertices @xmath11 ( with @xmath10 included ) such that there exists a path in @xmath9 between all pairs of vertices belonging to @xmath11 .",
    "when the element @xmath10 has no links to other vertices then @xmath11 reduces just to the element @xmath10 .",
    "the starting point of the procedure is an empty graph @xmath9 with @xmath1 vertices .",
    "the algorithm can be summarized in 6 steps :    \\(i ) set @xmath12 as the matrix of elements @xmath13 such that @xmath14 .",
    "\\(ii ) select the maximum correlation @xmath15 between elements belonging to different connected components @xmath16 and @xmath17 in @xmath9 .",
    "are coinciding with single vertices . ]",
    "\\(iii ) find elements @xmath18 , @xmath19 such that @xmath20    \\(iv ) add to @xmath9 the link between elements @xmath18 and @xmath19 with weight @xmath21 .",
    "once the link is added to @xmath9 , @xmath18 and @xmath19 will belong to the same connected component @xmath22 .",
    "\\(v ) redefine the matrix @xmath12 :    @xmath23    \\(vi ) if @xmath9 is still a disconnected graph then go to step ( ii ) else stop . +",
    "the resulting graph @xmath9 is the mst of the system and the matrix @xmath12 results to be the correlation matrix associated to the slca .",
    "specifically the matrix @xmath24 of elements @xmath25 is the subdominant ultrametric distance matrix of the system @xcite .",
    "the presented algorithm is not the most popular or the simplest algorithm for the construction of the mst but it clearly reveals the relation between slca and mst .",
    "indeed connected components progressively merging together during the construction of @xmath9 are nothing else but clusters progressively merging together in the slca . + by replacing eq .",
    "( [ singleadjust ] ) with    @xmath26    in the step ( v ) of the above procedure one obtains an algorithm performing the alca , being @xmath12 the correspondent correlation matrix .",
    "the resulting tree @xmath9 that we call almst is the tree associated to such a clustering procedure .",
    "+ the choice of the link at step ( iii ) of the almst construction algorithm does not affect the clustering procedure .",
    "more precisely by selecting any link between nodes @xmath27 the matrix @xmath12 representing the result of alca remains the same .",
    "this degeneracy allows one to consider different rules to select the link between elements @xmath18 and @xmath19 at the step ( iii ) of the construction protocol .",
    "different rules at step ( iii ) give rise to different correlation based trees .",
    "the same observation holds true for the algorithm that generates the mst .",
    "this fact implies that in principle one can consider spanning trees which are different from the mst and are still associated with the slca .",
    "however , it is worth recalling that the mst is unique in the sense that it is the spanning tree of shortest length @xcite .",
    "the bootstrap technique invented by efron ( 1979 ) @xcite is widely used in phylogenetic analysis since the paper by felsestein ( 1985 ) @xcite as a phylogenetic hierarchical tree evaluation method ( see for instance @xcite ) . the basic idea behind",
    "the technique is simple .",
    "consider a system of @xmath1 elements and suppose to collect data in a matrix @xmath28 with @xmath1 columns and @xmath3 rows .",
    "@xmath3 is the number of collected samples , e.g. the length of time series .",
    "the process is assumed to be stationary .",
    "the correlation matrix @xmath7 of the system is estimated from the matrix @xmath28 by evaluating the pair correlation coefficient . by applying the procedures described in the previous subsection to @xmath7",
    "one can construct the mst and almst of the system .",
    "the bootstrap technique requires to construct a number @xmath29 of replicas @xmath30 , @xmath31 of the data matrix @xmath28 .",
    "usually in phylogenetic analysis @xmath32 is considered a sufficient number of replicas .",
    "each replica @xmath30 is constructed by randomly selecting @xmath3 rows from the matrix @xmath28 allowing repetitions .",
    "this procedure implies that some rows of the original data matrix are included in the replica more then once whereas other rows are missed in the replica . for each replica",
    "@xmath30 the correlation matrix is evaluated and the mst and almst are extracted . the result is a collection of msts @xmath33 and almsts @xmath34 . to associate",
    "the so called _ bootstrap value _ to a link of the original mst ( almst ) one evaluates the number of @xmath35 ( @xmath36 ) in which the link is appearing and normalizes such a number with the total number of replicas , e.g. @xmath32 .",
    "the bootstrap value gives information about the reliability of each link of a graph .",
    "+ it is to note first that the bootstrap approach does not require the knowledge of the data distribution and then it is particularly useful to deal with high dimensional systems where it is difficult to infer the joint probability distribution from data .",
    "second , the average of bootstrap values in a graph can be considered as a global measure of the reliability of the graph itself and then can be used to compare different filtered graphs . in case of normally distributed random variables the error associated to the correlation coefficient @xmath37 roughly scales like @xmath38 . one",
    "might then be tempted to expect that the higher is the correlation associated to a link in a correlation based network the higher is the reliability of the link .",
    "we shall show in the following section that such a conjecture can not explain empirical results for the system of stock returns we consider .",
    "finally the graph weighted with bootstrap values can be helpful in the search for significant communities in the system .",
    "we perform an empirical investigation by considering the 300 most capitalized stocks traded at nyse during the time period 2001 - 2003 .",
    "we consider the capitalization of stocks at december 2003 .",
    "the return time series are sampled at daily time horizon by computing the logarithm of the ratio of closure to open price and the series length is @xmath39 .",
    "stocks are classified in terms of the economic sector and sub - sector they belong to , according to the classification scheme used in the website http://finance.yahoo.com .",
    "economic sub - sectors are giving a further specification of the activity of firms belonging to the same economic sector .",
    "for instance , stocks belonging to the sector of transportation are partitioned in stocks belonging to the railways sub - sector and in stocks belonging to the economic sub - sector of airlines .",
    "the total number of economic sectors involved in our set of stocks is 12 whereas the number of sub - sectors is 78 .",
    "the list of the 300 stocks considered with their economic sector and sub - sector is available at http://lagash.dft.unipa.it/ijbc.html .    in figs .",
    "[ mst ] and [ almst ] the mst and almst of the system are shown respectively .",
    "links are drawn using a grey scale with 10 levels selected according to the bootstrap value .",
    "the bootstrap value is evaluated over @xmath32 replicas .",
    "the higher is the bootstrap value associated to a link the darker is the line representing the link .",
    "vertices are drawn with different colors to highlight the economic sector each stock belongs to .",
    "specifically these sectors are basic materials ( violet , 24 stocks ) , consumer cyclical ( tan , 22 stocks ) , consumer non cyclical ( yellow , 25 stocks ) , energy ( blue , 17 stocks ) , services ( cyan , 69 stocks ) , financial ( green , 53 stocks ) , healthcare ( gray , 19 stocks ) , technology ( red , 34 stocks ) , utilities ( magenta , 12 stocks ) , transportation ( brown , 5 stocks ) , conglomerates ( orange , 8 stocks ) and capital goods ( light green , 12 stocks ) . for the sake of readability of the pictures ,",
    "the tick symbol is reported only for stocks with degree greater than 5 in at least one of the graphs . +",
    "a comparison of the graphs shows a number of similarities .",
    "indeed the @xmath40 of links are common to both the mst and almst .",
    "in fact the intra - sector structures are similar in the mst and almst .",
    "moreover the degree of highly connected stocks ( degree greater than 5 ) is similar in both graphs .",
    "there are also differences between the graphs .",
    "these differences are mostly observed in the connections between groups of stocks of different economic sectors .",
    "for instance the consumer non cyclical economic sector shows a star like shape with wwy as hub in both graphs but the path connecting this sector to others is different . in the mst",
    "the sector of consumer non cyclical is connected via a high reliable link to the sector of energy and then , following a path traversing the sectors of services , financial and conglomerates , it is connected to the healthcare sector .",
    "differently , in the almst the sector of consumer non cyclical is directly connected to the healthcare sector and far from the energy sector .",
    "also the position of the sector of basic materials is different in the two graphs . specifically in the mst",
    "this sector is two steps far from the financial sector whereas in the almst a path as long as 9 steps is necessary to connect stocks of basic materials to the financial sector . +                in fig .",
    "[ bootvsccmax ] we report the scatter plot of the bootstrap value against the correlation coefficient associated to links of both the almst and mst .",
    "black circles refer to the almst and open triangles refer to the mst .",
    "the figure clearly shows that the reliability of links can not be straightforwardly explained in terms of the correlation coefficient value associated to links .",
    "in fact a large dispersion of points is evident , although we observe a significant positive correlation between the link bootstrap reliability and the correlation coefficient value .",
    "indeed we observe links associated with a quite small correlation , e.g. 0.4 , having a very high reliability in terms of the bootstrap value , e.g. 1 . on the contrary",
    "some links with correlation as high as 0.7 show a small reliability of only 0.3 in terms of the bootstrap value .",
    "this result suggests that the strength of a link and its reliability in correlation based networks are carrying partially different information . in order to assess the ability of mst and almst in detecting communities defined in terms of economic sectors and sub - sectors , we have counted the number of intra - sector links and intra - subsector links in both the graphs . in the mst",
    "223 links connect stocks of the same economic sector and 139 links are intra - sub - sector links . in the almst",
    "we have counted 227 intra - sector links and 144 intra - sub - sector links .",
    "these results suggest that almst detects communities defined in terms of economic sectors and sub - sectors slightly better than the mst , for the specific system we are dealing with .    [ averboottab ]     all links & @xmath41 & @xmath42 + intra - sector & @xmath43 & @xmath44 + inter - sector & @xmath45 & @xmath46 + intra - sub - sector & @xmath47 & @xmath48 + inter - sub - sector & @xmath49 & @xmath50 + inter - sub - sec . & intra - sec . & @xmath51 & @xmath52 +    in table i we report results obtained by averaging the bootstrap value of links grouped in different classes for both mst and almst . by comparing the column of values corresponding to the mst with the one corresponding to the almst we note that links belonging to the mst are in average more reliable than links belonging to the almst .",
    "we also observe that the average bootstrap value of links connecting stocks belonging to the same economic sub - sector is greater than @xmath53 in both the graphs and it is immediately followed by the average bootstrap value of intra - sector links , which is 0.657 in the almst and 0.680 in the mst .",
    "both the average bootstrap values of intra - sector links and intra - sub - sector links are greater than the average bootstrap value evaluated over all links in the graphs .",
    "this evidence suggests that sectors and sub - sectors are significant communities in both networks .",
    "such an indication is also supported by simulations . indeed the stronger reliability of intra - sector links and intra - sub - sector links with respect to inter - sector links and inter - sub - sector links has been also observed in data simulations based on a 3-level hierarchically nested factor model @xcite . in this model",
    "each stock is depending on 3 factors , the first one being associated to the economic sub - sector , the second one being relative to the economic sector and the last one to the market .",
    "we shall discuss this investigation in a forthcoming paper .",
    "we have introduced a technique allowing to extract a correlation based tree named almst associated with the alca .",
    "we have also introduced a new measure of the reliability of links based on the bootstrap technique .",
    "we have applied both techniques to the system of daily returns of the 300 most capitalized stocks traded at nyse . for this system",
    "a comparison with the mst indicates a slightly greater capability of the almst in recognizing economic sectors and sub - sectors in market return data , whereas links of the mst are in average more reliable in terms of the bootstrap value than links belonging to the almst .",
    "we have also shown that the reliability of links can not be explained just in terms of the strength of connections and that intra - sector and intra - sub - sector connections are in average more reliable , with respect to the bootstrap technique , than inter - sector and inter - sub - sector links in both mst and almst .",
    "such a result suggests to interpret economic sectors and sub - sectors as significant communities in the market .",
    "authors acknowledge support from the research project miur 449/97  high frequency dynamics in financial markets \" , the research project miur - firb rbne01cw3 m  cellular self - organizing nets and chaotic nonlinear dynamics to model and control complex systems \" and from the european union strep project n. 012911  human behavior through dynamics of complex social networks : an interdisciplinary approach \" ."
  ],
  "abstract_text": [
    "<S> we introduce a new technique to associate a spanning tree to the average linkage cluster analysis . </S>",
    "<S> we term this tree as the average linkage minimum spanning tree . </S>",
    "<S> we also introduce a technique to associate a value of reliability to links of correlation based graphs by using bootstrap replicas of data . </S>",
    "<S> both techniques are applied to the portfolio of the 300 most capitalized stocks traded at new york stock exchange during the time period 2001 - 2003 . </S>",
    "<S> we show that the average linkage minimum spanning tree recognizes economic sectors and sub - sectors as communities in the network slightly better than the minimum spanning tree does . </S>",
    "<S> we also show that the average reliability of links in the minimum spanning tree is slightly greater than the average reliability of links in the average linkage minimum spanning tree . </S>"
  ]
}