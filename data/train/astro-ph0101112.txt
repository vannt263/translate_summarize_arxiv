{
  "article_text": [
    "as cosmology enters the era of `` precision '' , it enters simultaneously the era of massive data sets .",
    "this has in turn showed the need for new data processing algorithm .",
    "present and future cmb experiments in particular face some new and interesting challenges @xcite .",
    "if we accept the now classical point of view of a four steps data analysis pipeline : i/ from _ time - ordered data _",
    "( tod ) to maps of the sky at a given frequency , ii/ from frequency maps to ( among others ) a temperature map , iii ) from a temperature map to its power spectrum @xmath3 , iv/ from the power spectrum to cosmological parameters and characteristics of the primordial spectrum of fluctuation , the ultimate quantities to be measured in a given model .",
    "the work we are presenting focus on the first of these issues , namely the map - making step .    up to the most recent experiments , maps could be made by a brute force approach amounting to solve directly a large linear problem by direct matrix inversion .",
    "nevertheless the size of the problem , and the required computing power , grows as a power law of the data set size , and the limits of this kind of method have now been reached @xcite . whereas the most efficient development in this massive computing approach , the madcap package @xcite has been applied to the recent boomerang and maxima experiments @xcite some faster and less consuming solutions based on iterative inversion algorithms have now been developed and applied too @xcite .",
    "this is in the same spirit as @xcite , and we definitely follow this latter approach .",
    "design goals are to use memory sparingly by handling only columns or rows instead of full matrixes and to increase speed by minimising the number of iterations required to reach the sought convergence of the iterative scheme .",
    "we fulfill these goals by an iterative multi - grid jacobi algorithm .",
    "as recalled below , an optimal method involves using the noise power spectrum .",
    "we have thus investigated the possibility of a joint noise ( and signal ) evaluation using this algorithm .",
    "section [ method ] presents in detail the method and its implementation , while section [ application ] demonstrates its capabilities by using simulations of two on - going balloon cmb experiments , archeops@xcite and tophat .",
    "the results are discussed in section [ discussion ] , together with the problem of the evaluation of the noise properties , as well as possible extensions .",
    "the relation between the sky map we seek and the observed data stream may be cast as a linear algebra system @xcite .",
    "let @xmath4 and @xmath5 indices denote quantities in the temporal and spatial domains , and group as a data vector , @xmath6 , and a noise vector the temporal stream of collected data and the detector noise stream , both of dimension @xmath0 .",
    "we then have d_t = a_tpx_p + n_t , where @xmath7 is the signal vector given by the observation of the unknown pixelised sky map , @xmath8 , which has been arranged as a vector of dimension @xmath9 .",
    "the @xmath10 `` observation '' matrix @xmath11 therefore encompasses the scanning strategy and the beam pattern of the detector .    in the following ,",
    "we restrict to the case when the beam pattern is symmetrical .",
    "we can therefore take @xmath8 to be a map of the sky which has already been convolved with the beam pattern , and @xmath11 only describes how this sky is being scanned .",
    "for the total power measurement ( non - differential measurement ) we are interested in here , the observation matrix @xmath11 then has a single non - zero element per row , which can be set to one if @xmath12 and @xmath13 are expressed in the same units .",
    "the model of the measurement is then quite transparent : each temporal datum is the sum of the pixel value to which the detector is pointing plus the detector noise .",
    "the map - making step then amounts to best solve for @xmath13 given @xmath12 ( and some properties of the noise ) .",
    "we shall seek a _ linear _ estimator of @xmath8 , _",
    "p = w_pt d_t  . to motivate a particular choice of the @xmath14 matrix @xmath15 ,",
    "a bayesian approach is convenient .",
    "indeed we are seeking the optimal solution to this inversion problem which maximises the probability of a deduced set of theory parameters ( here the map @xmath16 ) given our data ( @xmath17 ) by maximising @xmath18 .",
    "bayes theorem simply states that ( x|d ) = . if we _ do not assume any theoretical prior _ , then @xmath13 follows a uniform distribution as well as @xmath12 .",
    "therefore , ( x|d ) & & ( d|x ) .",
    "if we further assume that _ the noise is gaussian _ , we can write ( x|d ) & & exp(- n^t_tn^-1_ttn_t/2 ) + & & exp(-(d - ax)_t^t n^-1_tt ( d - ax)_t/2 ) + & & exp(-^2/2 ) where @xmath19 is the noise covariance matrix . in this particular case ,",
    "maximising @xmath20 amounts to find the least square solution which was used to analyse the `` cobe '' data @xcite , [ likelihood ] w = ^-1 a^t n^-1 .",
    "[ eq : noprior ] in this paper we will actually deal only with this estimator .",
    "nevertheless as a next iteration in the analysis process , we could incorporate various theoretical priors by expliciting @xmath21 .",
    "for example , it is often assumed _ a gaussian prior _ for the theory , @xmath22 where @xmath23 is the signal covariance matrix . in that case",
    "the particular solution turns out to be the wiener filtering solution @xcite : w = ^-1 a^t n^-1  . but this solution may always be obtained by a further ( wiener ) filtering of the cobe solution , and we do not consider it further .",
    "the prior - less solution demonstrates that as long as the ( gaussian ) instrumental noise is not white , a simple averaging ( co - addition ) of all the data points corresponding to a given sky pixel is not optimal .",
    "if the noise exhibits some temporal correlations , as induced for instance by a low - frequency @xmath24 behavior of the noise spectrum which prevails in most cmb experiments , one has to take into account the full time correlation structure of the noise .",
    "additionally this expression demonstrates that even if the noise has a simple time structure , the scanning strategy generically induces a non - trivial correlation matrix @xmath25^{-1}$ ] of the noise map .",
    "even if the problem is well posed formally , a quick look at the orders of magnitude shows that the actual finding of a solution is non trivial task . indeed a brute force method aiming at inverting the full matrix @xmath25^{-1 } \\displaystyle$ ] , an operation scaling as @xmath26 , is already hardly tractable for present long duration balloon flights as maxima , boomerang , archeops or tophat where @xmath27 and @xmath28 .",
    "it appears totally impractical for planck since for a single detector ( amid @xmath29s ) @xmath30 and @xmath31 !",
    "one possibility may be to take advantage of specific scanning strategies , and actually solve the inverse of the convolution problem as detailed in @xcite .",
    "this amounts to deduce the map coefficients @xmath32 in the spherical harmonic basis through a rotation of a fourier decomposition of the observed data .",
    "the map will then be a simple visualisation device , while the @xmath32 would be ready to use directly for a component separation ( as in @xcite ) and the cmb power spectrum estimate .",
    "while potentially very interesting , this approach will not be generally applicable ( at least efficiently ) , and we now turn to a practical ( general ) solution of equation  ( [ eq : noprior ] ) by iterative means .",
    "we solve the map - making problem by adapting to our particular case the general `` multi - grid method '' @xcite .",
    "multi - grid methods are commonly used to speed up the convergence of a traditional relaxation method ( in our case the jacobi method , as in @xcite ) defined at resolution @xmath33 ( see below ) .",
    "a set of recursively defined coarser grids ( @xmath34 ) are used as temporary computational space , in order to increase the convergence rate of the relaxation process . to be fully profitable",
    ", this algorithm implies for each resolution both a rebinning in space ( resolution change ) and in time ( resampling ) .    in this paper",
    ", we use the healpix pixelisation of the sphere @xcite . in this scheme , the sphere is covered by 12 basic quadrilaterals , further divided recursively into pixels of equal area .",
    "the map resolution is labeled by @xmath35 : the number of pixels along the side of one basic quadrilateral .",
    "hence , @xmath36 means that the sphere is covered by 12 large pixels only . the number of pixels is given by @xmath37 .",
    "@xmath38 corresponds to a pixel size of @xmath39 arcmin . for practical reasons ,",
    "we need to define the _ resolution _ @xmath40 of a healpix map as n_side=2^k the `` nested''pixel numbering scheme of healpix @xcite allows an easy implementation of the coarsening ( @xmath41 ) and refining ( @xmath42 ) operators that we use intensively in our multigrid scheme .",
    "let us now get into the details of our implementation and discuss successively the exact system we solve , the way we solve it and the actual steps of the multi - grid algorithm .",
    "we aim at solving for the optimal map @xmath44 at a given spatial resolution @xmath40 using [ start ] a_k^t n^-1 a_k  _ k = a_k^t n^-1  d , where @xmath45 is the `` observation '' operator ( from spatial to temporal domain ) and @xmath46 is the `` projection '' operator ( from temporal to spatial domain ) . in a noise - free experiment , the optimal map would be straightforwardly given by the co - added map ( introducing the `` co - addition '' operator @xmath47 ) _ k = p_k d ( a_k^t a_k)^-1 a_k^t  d the time line is given by @xmath48 where @xmath49 is the sky map at `` infinite '' resolution ( @xmath50 in our notations ) . in order to check the accuracy of this trivial noise - free map making ,",
    "it is natural to compute the residual _ in the time domain _ with @xmath51 p_k = a_k _ k - d = a_k_k - a _ x _ which will be non - zero in practice , as soon as one works with finite spatial resolution .",
    "we call this residual the _ pixelisation noise_. since we assume here that the instrumental beam is symmetric , the sky map is considered as the true sky convolved by , say , a gaussian beam of angular diameter @xmath52 .",
    "this introduces a low - pass spatial filter in the problem . in other words , as the resolution increase , the pixelisation noise should decrease towards zero .",
    "we have estimated that the order of magnitude of the pixelisation noise can be approximated by p_k x _ the norms used in the above formula can be either the maximum over the time line ( a very strong constraint ) or the variance over the time line ( a weaker constraint ) . since the pixelisation noise is strongly correlated with the sky signal , point sources or galaxy crossings are potential candidates for large and localised bursts of pixelisation noise .",
    "the correct working resolution @xmath43 is set by requiring that the pixelisation noise remains low compared to the actual instrumental noise , or equivalently _",
    "k_max most of the cmb experiments are noise dominated along the time line , constraining the effective map resolution to be of the order of the instrumental beam or even larger .",
    "note however that the pixelisation noise is strongly non gaussian ( point sources or galaxy crossings ) and can be always considered as a potential source of residual stripes in the final maps .      instead of solving for @xmath53",
    "we perform the change of variable = - p  d [ noisedef ] and solve instead for @xmath54 which obeys [ eqchgt ] p n^-1 a   = p n^-1 ( d - a p d )",
    "m = b where we have multiplied each side of equation  ( [ start ] ) by @xmath55 , the pixel hit counter . from now on",
    ", we also assume that the noise in the timestream is stationary and that its covariance matrix is normalised so that @xmath56 .",
    "the previous change of variable allows us to subtract the sky signal from the data : since we have chosen a resolution high enough to neglect the pixelisation noise , we have indeed @xmath57 and , consequently , @xmath58 . the map making consists in two step : first compute a simple co - added map from the time line , and second , solve equation  ( [ eqchgt ] ) for the _ stripes map _ @xmath54 .",
    "the final optimal map is obtained by adding these two maps .",
    "it is worth mentioning that the stripes map is completely independent of the sky signal , as soon as the pixelisation noise can be ignored .",
    "it depends only on the scanning strategy through the matrix @xmath11 and on the noise characteristics through the matrix @xmath59 .",
    "even if in principle this change of variable is irrelevant since it does not change the matrix to be inverted , it does in practice since @xmath60 is free from the fast variations of @xmath12 ( up to the pixelisation noise ) , as the galaxy crossings , which are numerically damaging to the quality of the inversion .    to solve for equation [ eqchgt ]",
    ", we follow the ideas of @xcite and apply an approximate jacobi relaxation scheme .",
    "the jacobi method consists in the following relaxation step to solve for our problem ^n+1 = r y^n + d^-1 b  y^0 = 0 where @xmath61 is the diagonal part of the matrix @xmath62 and @xmath63 is the residual matrix @xmath64 . computing the diagonal elements of @xmath65 is rather prohibitive .",
    "the idea of prunet et al .",
    "( 2000 ) is to approximate @xmath66 by neglecting the off - diagonal elements of @xmath67 .",
    "the residual matrix then simplifies greatly and writes r = p(i - n^-1)a the approximate jacobi relaxation step is therefore defined as ^n+1 = r y^n + b  y^0 = 0 one clearly sees that if this iterative scheme converges , it is towards the full solution of equation [ eqchgt ] . to perform these successive steps , it is extremely fruitful to remember the assumed stationarity of the noise . indeed",
    "whereas this assumption implies a circulant noise covariance matrix in real space , it translates in fourier space in the diagonality of the noise covariance matrix .",
    "this is naturally another formulation of the convolution theorem , since a stationary matrix acts on a vector as a convolution , and a diagonal matrix acts as a simple vector product , thus a convolution in real space is translated as a product in fourier space .",
    "the point is that the manipulation of the matrix @xmath67 is considerably lighter and will be henceforth performed in fourier space .",
    "applying the matrix @xmath63 to a map reduces then to the following operations in order    1 .",
    "`` observe '' the previous stripes map @xmath68 2 .   fourier transform the resulting data stream 3 .",
    "apply the low - pass filter @xmath69 4 .",
    "inverse fourier transform back to real space 5 .",
    "co - add the resulting data stream into the map @xmath70 .    assuming that the normalised noise power spectrum can be approximated by @xmath71 , the low - pass filter associated to each relaxation step is given by w(f)= since both @xmath11 and @xmath72 are norm - preserving operators , the norm of the increment @xmath73 between step @xmath74 and @xmath75 decreases as @xmath76 , where @xmath77 is a minimal frequency in the problem . since @xmath78 , we see that the approximate jacobi relaxation scheme will converge in every case , which is good news . on the other hand , since @xmath79 , the actual convergence rate of the scheme is likely to be very , very slow , which is bad news ( cf .",
    "figure  [ jacobi - residu ] for a graphical illustration ) .",
    "the fact that this algorithm is robust , but dramatically slow is a well - known property of the jacobi method .",
    "the multi - grid method is also well known to solve this convergence speed problem .",
    "note that if the convergence is reached , the solution we get is the optimal solution , similar to the one that would be obtained by a full matrix inversion .      the multi - grid method for solving linear problems is described in great details in @xcite . at each relaxation step at level @xmath80 , our target resolution",
    ", we can define the error @xmath81 and the residual @xmath82 .",
    "both are related through [ eqres ] m_k e_k^n = r_k^n if we are able to solve exactly for equation ( [ eqres ] ) , the overall problem is solved .",
    "the idea of the multi - grid algorithm is to solve approximately for equation ( [ eqres ] ) using a coarser `` grid '' at resolution @xmath83 , where the relaxation scheme should converge faster .",
    "we thus need to define a fine - to - coarse operator , in order to define the new problem on the coarse grid and solve for it .",
    "we also need a coarse - to - fine operator in order to inject the solution onto the fine grid .",
    "the approximation to the error @xmath84 is finally added to the solution .",
    "the coarse grid solver is usually applied after a few iterations on the fine level have been performed ( in practice we perform 3 to 5 iterations ) .",
    "naturally , since the solution to the problem on the coarse level relies also on the same relaxation scheme , it can be itself accelerated using an even coarser grid .",
    "this naturally leads to a recursive approach of the problem .",
    "we defined our fine - to - coarse operator to be an averaging of the values of the 4 fine pixels contained in each coarse pixel .",
    "the coarse - to - fine operator is just a straight injection of the value of the coarse pixel into the 4 fine pixels .",
    "the most important issue is the temporal rebinning of the data stream since the speed of the iterative scheme at a given level is actually set by the two fourier transforms .",
    "we performed that resampling by simply taking each time we go up one level one point out of two . at the lower resolutions , this reduction is such",
    "that the iteration cost is negligible when compared to that at higher @xmath40 ; it allows fast enough iterations that full convergence may be reached . in practice",
    "we choose a minimal level @xmath85 defined by @xmath86 and iterate a few hundred times to reach exact convergence .",
    "finally the navigation through levels allows several options to be taken .",
    "either we go up and down through all the levels successively ( the so - called `` v - cycle '' ) or we follow more intricate paths ( the `` w - cycle '' where at a given level we go down and up all the lower levels before going up and vice - versa ) . since it turns out that levels are relatively disconnected in the sense that the scales well solved at a given resolution are only slightly affected by the solution at a higher level , the `` v - cycle '' is appropriate and is the solution we adopt in the two following configurations .",
    "we now aim at demonstrating the capabilities of this algorithm with simulated data whose characteristics are inspired by those of the archeops and tophat experiments .",
    "the archeops and tophat experiments are very similar with respect to their scanning strategy .",
    "indeed both use a telescope that simply spins at a constant rate ( respectively @xmath87 and @xmath88 rpm ) about its vertical axis .",
    "thus due to earth rotation the sky coverage of both is performed through scan circles whose axis slowly drifts on the sky . nevertheless , because of the different launch points ( respectively on the arctic circle ( kiruna , sweden ) and in antarctica ( mcmurdo ) ) and their different telescope axis elevation ( respectively @xmath89 or @xmath90 ) they do not have the same sky coverage .",
    "otherwise the two experiments do not use the same bolometers technology , neither the same bands nor have the same number of bolometers .",
    "but even if we try to be fairly realistic , our goal though is _ not _ to compare their respective performances but rather to demonstrate two applications of our technique in different settings .",
    "we then simulate for each a data stream of @xmath91 duration with respectively a sampling frequency of @xmath92 and @xmath93 .",
    "the tods contain realistic cmb and galactic signal for a band at @xmath94 .",
    "note that this is a one day data stream for tophat ( out of 10 expected ) and that this frequency choice is more appropriate for archeops than for tophat ( whose equivalent band is around @xmath95 ) , but this is realistic enough for our purpose .",
    "we generated a gaussian noise time stream with the following power spectrum @xmath96 with @xmath97 and @xmath98 , and @xmath99 and @xmath100 .",
    "the noise amplitude per channel is choosen so that it corresponds for archeops ( 24 hours ) and tophat ( 10 days of flight ) to @xmath101 on average per @xmath102 pixel , with a beam fwhm of @xmath103 / @xmath102 .",
    "we introduced @xmath104 distinct levels of resolution defined by their @xmath35 parameter in the healpix package @xcite .",
    "the higher resolution level is imposed by the pixelisation noise level requirement ( section [ mgaspect ] ) to @xmath105 ( pixel size @xmath106 ) whereas the lower one is @xmath86 ( pixel size @xmath107 ) .",
    "therefore these two configurations each offer an interesting test since they differ by the sky coverage and the noise power spectrum .",
    "we iterate @xmath87 times at each level except at the lowest one where we iterate @xmath108 times .",
    "the algorithm is as efficient in both situations .",
    "whereas for archeops whose timeline is longer due to the higher sampling frequency it took 2.25 hours on a sgi origin 2000 single processor , it took around 1.5 hours for the tophat daily data stream .    in figures [ rec_kir ] and [ rec_top ]",
    "we depict from top to bottom and from left to right the initial co - added data , the reconstructed noise map , the hit map , the number of hit per pixels at the highest worked out resolution , the initial signal map as well as the reconstructed signal map and the error map .",
    "we see that the destriping is excellent in both situations and the signal maps recovered only contain an apparently isotropic noise .",
    "we note the natural correlation between the error map and the hit map .",
    "finally , we stress that no previous filtering at all has been applied .",
    "figure [ level_compil ] shows how the noise map is reconstructed at various scales .",
    "this is a mere illustration of our multi - grid work .      at this point , some tests are required to cautiously validate our method .",
    "first , as was stated below , as soon as the iterative algorithm has converged , the solution is by construction the optimal solution , similar to the one that would be obtained by the full matrix inversion . as a criterium for convergence we required the @xmath109-norm of residuals to be of the order of the machine accuracy .",
    "we initially have a gaussian random noise stream fully characterised by its power spectrum .",
    "therefore an important test is to check wether the deduced noise stream ( by `` observing '' the stripe map , see   [ noise_eval ] for further details definition ) is gaussian and has the same power spectrum . on figure [ pdf ]",
    "we ensure that the evaluated noise time stream is indeed gaussian . as depicted on figure [ spec_rec ] , where we plot in the archeops case both the analytical expression of the spectrum",
    "according to which we generate the timeline and its recovered form , the agreement is excellent .",
    "we recall that we assumed at the beginning a perfect knowledge of the noise in order to define the filters .",
    "this is naturally unrealistic but the issue of noise evaluation is discussed in section [ noise_eval ] below .",
    "we plotted as well the probability distribution function ( pdf ) of the final error map , the recovered noisy signal map minus the input signal map ( figure [ pdf ] ) .",
    "this pdf is well fitted by a gaussian whose parameters are given in figure [ pdf ] .",
    "the pdf of the error map displays some non - gaussian wings .",
    "let us recall here that this is no surprise here because of the non - uniform sky coverage as well as the slight residual stripping , both due to the non - ideal scanning strategy , that produces a non - uniform white noise in pixel space .",
    "another particularly important test consists in checking the absence of correlation between the recovered noise map and the initial signal map .",
    "we could not find any which is no surprise since we are iterating on a noise map ( see   [ noiseiter ] ) which does not contain any signal up to the pixelisation noise , that is ensured to be negligible with regards to the instrumental noise by choice of the resolution @xmath110 ( see   [ lmax ] ) .",
    "the efficiency of such a method can be intuitively understood .",
    "indeed , although the jacobi method is known to converge very safely it suffers intrinsically from a very slow convergence for large - scale correlations ( which originate mainly in the off diagonal terms of the matrix to be inverted ) @xcite .",
    "this is illustrated on figure [ jacobi - residu ] : there we show the maps of residuals after solving this system using a _ standard _ jacobi method on simulated data with @xmath111 , @xmath108 , @xmath112 , and @xmath113 iterations .",
    "we used the same simulation and therefore the same sky coverage .",
    "obviously the largest structures are the slowest to converge ( implying observed large scale residual patterns ) . as a consequence",
    "it seems very natural to help the convergence by solving the problem at larger scales . whereas large - scale structures will not be affected by a scale change",
    ", smaller structures will converge faster .",
    "we have found that this multi - grid algorithm translates naturally in _ a speed up greater than @xmath29 _ as compared to a standard jacobi method .",
    "this is illustrated in figure ( [ conv - rate ] ) where we plotted the evolution of the 2-norm of residuals for the two methods in terms of the number of iterations in cycle units. one cycle corresponds to 8 iterations at level @xmath43 for a standard jacobi method whereas it incorporates addionally going up and down all the lowest levels in the multi - grid case .",
    "thus the cycle timing is not exactly the same but the difference is negligible since the limiting stages are definitely the iterations performed at maximum resolution .",
    "note the fact that the efficiency of the multi - grid method allows us to solve exactly the system up to the machine accuracy ( small rebounds at the bottom of the curve ) in approximately @xmath114 for @xmath115 on a sgi origin 2000 single processor .",
    "since the limiting stages are the fft s at the higher levels , this algorithm scales as @xmath1 . in terms of memory storage",
    "it scales naturally as @xmath116 since one crucial feature of this iterative method is to handle only vectors and never an explicit matrix .",
    "the scaling of this problem is formally independent of the number of pixels @xmath9 .",
    "the estimation of the statistical properties of the noise in the timestream is an important issue for this kind of algorithm . indeed , whereas till now we have assumed a perfect prior knowledge of the noise power spectrum in order to define the filters , it might not be that easy in practice since we can not separate the signal from the noise .",
    "we will therefore aim at making a joint estimation of the signal and the noise .",
    "this has been pioneered recently by @xcite and implemented independently by @xcite .",
    "the latter implementation is rather straightforward in our particular case since it just implies reevaluating the filters after a number of iterations , given the ( current ) estimation of the signal map and thus of the signal data stream .",
    "nevertheless its non - obvious convergence properties have to be studied carefully through simulations . making use of ( [ noisedef ] )",
    "our evaluation of the noise timeline @xmath117 at the @xmath118 iteration and at level max is ^n = d -a(^  n_k _ max + p d )",
    ". then we compute its spectrum and ( re- ) define the required filters .",
    "we then go through several multi - grid cycles ( 5 in the above demonstrated case ) before re - evaluating the noise stream .",
    "very few evaluations of the noise are needed before getting a converged power spectrum ( around 2 ) .",
    "in such an implementation , no noise priors at all are assumed .",
    "this is illustrated on one particular worked out example in the case of a 4 hours archeops like flight ( more detailed considerations will be discussed somewhere else ) . to reduce the number of degrees of freedom we bin the evaluated noise power spectrum using a constant logarithmic binning ( @xmath119 in our case ) for @xmath120 and a constant linear binning ( @xmath121 in our case ) for higher frequency .",
    "the figure [ noise_eval_1 ] shows the genuine and evaluated noise power spectrum .",
    "the initial noise power spectrum was a realistic one @xmath122 to which we added some small perturbations ( the two visible bumps ) to test the method .",
    "note the small bias around the telescope spin frequency at @xmath123 : this is illustrative of the difficulties we fundamentally face to separate signal and noise at this particular frequency through equation  ( [ noisedef ] ) .",
    "naturally , this bias was not present in the case demonstrated on figure [ spec_rec ] where we assumed a prior knowledge of the spectrum .",
    "this possible bias forced us to work with a coarser binning ( @xmath124 ) in the @xmath24 part of the spectrum till the convergence is reached , we evaluate the noise power spectrum with the previously mentioned binning only at the last step . proceeding this way , the convergence towards the correct spectrum is both fast ( @xmath87 noise evaluations ) and stable .",
    "second , the output of any map - making should contain as well an evaluation of the map noise covariance matrix @xmath125 .",
    "given such a fast algorithm and given an evaluation of the power spectrum , it is natural to obtain it through a monte - carlo algorithm fueled with various realizations of the noise timeline generated using the evaluated power spectrum .",
    "this part will be presented in a future work",
    ". however we illustrate it very briefly by a very rough @xmath3 determination ( which is in no way an appropriate @xmath3 estimate ) . to this purpose",
    "we perform a one day tophat like simulation including only the cmb signal plus the noise . from this data stream",
    "we obtain an `` optimal '' signal map as well as an evaluation of the noise power spectrum using the previously described algorithm . with the help of the ` anafast ` routine of the healpix package we calculate this way a rough @xmath126 . using the estimated noise power spectrum we generate @xmath29 realisations of the noise and get consequently @xmath29 `` optimal '' noise maps . for each of them",
    "we measure as before @xmath3 and average them to obtain @xmath127 . in order to debiase the signal power spectrum recovered in this way",
    ", we substract @xmath127 to @xmath126 .",
    "the power spectrum obtained in this manner includes as well some spatial correlations due to some light residual stripping and thus does not correspond to white noise ( at least in the low @xmath128 part ) .",
    "for the aim of comparison we compute the power spectrum of the input signal measured the same way , @xmath129 , and plotted both @xmath129 as well as @xmath130 averaged in linear bands of constant width @xmath131 .",
    "the agreement is obviously very good as illustrated on figure [ cl_mc ] .",
    "the error bars take into account both the sampling induced variance as well as the beam spreading @xcite . a few comments need to be made at this point .",
    "this is in no way an appropriate @xmath3 measurement since we are not dealing properly here with the sky coverage induced window function which triggers some spurious correlations within the @xmath3s .",
    "we thus do not take into account the full - structure of the map noise covariance matrix .",
    "nevertheless , the efficiency of such a rough method is encouraging for more detailed implementation and a full handling of the noise covariance matrix .",
    "the application to genuine data could be problematic if our key hypothesis were not to be fulfilled thus we have to discuss them . concerning the noise , we assumed that it is gaussian in order to derive our map estimator and stationary in order to exploit the diagonality of its noise covariance matrix in fourier space .",
    "both hypothesis are reasonable for a nominal instrumental noise , at least partially on ( sufficiently long ) pieces of timeline .",
    "if not , we would have to cut the bad parts and replace them by a constrained realization of the noise in these parts .",
    "concerning the signal , no particular assumptions are needed in the method we are presenting . at this level",
    ", we neglected as well the effect of the non perfect symmetry of the instrumental beam .",
    "this effect should be quantified for a real experiment @xcite .",
    "another technical hypothesis is the negligibility of the pixelisation noise with respect to the instrumental noise but since this is fully under control of the user it should not be a problem .    in this paper , we have presented an original fast map - making method based on a multi - grid jacobi algorithm .",
    "it naturally entails the possibility of a joint noise / signal estimation .",
    "we propose a way to generate the noise covariance matrix and illustrate its ability on a simple @xmath3 estimation .",
    "the efficiency of this method has been demonstrated in the case of two coming balloon experiments , namely archeops and tophat but it naturally has a more general range of application .",
    "this tool should be of natural interest for planck and this will be demonstrated somewhere else .",
    "furthermore , due to the analogy of the formalisms , this should have some applications as well in the component separation problem .",
    "we would like to acknowledge eric hivon for fruitful remarks , lloyd knox for stimulating discussions and information on the tophat experiment and the developers of the healpix @xcite package which has considerably eased this work .",
    "borrill j.,`madcap : the microwave anisotropy dataset computational analysis package ' julian borrill in `` proceeedings of the 5th european sgi / cray mpp workshop '' ( 1999 ) , astro - ph/9911389 , see also http://cfpa.berkeley.edu/  borrill / cmb / madcap.html                            prunet , s. and netterfield , c.  b. and hivon , e. and crill , b. p.,``iterative map - making for scanning experiments '' , to be published in the proceedings of the xxxvth rencontres de moriond , energy densities in the universe , editions frontieres ( 2000 ) , astro - ph/0006052"
  ],
  "abstract_text": [
    "<S> the data analysis of current cosmic microwave background ( cmb ) experiments like boomerang or maxima poses severe challenges which already stretch the limits of current ( super- ) computer capabilities , if brute force methods are used . in this paper </S>",
    "<S> we present a practical solution to the optimal map making problem which can be used directly for next generation cmb experiments like archeops and tophat , and can probably be extended relatively easily to the full planck case . </S>",
    "<S> this solution is based on an iterative multi - grid jacobi algorithm which is both fast and memory sparing . </S>",
    "<S> indeed , if there are @xmath0 data points along the one dimensional timeline to analyse , the number of operations is of @xmath1 and the memory requirement is @xmath2 . </S>",
    "<S> timing and accuracy issues have been analysed on simulated archeops and tophat data , and we discuss as well the issue of the joint evaluation of the signal and noise statistical properties . </S>"
  ]
}