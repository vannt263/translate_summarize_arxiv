{
  "article_text": [
    "switched - mode hybrid dynamical systems often are characterized by the following equation , @xmath0 where @xmath1 is the state variable , @xmath2 with @xmath3 being a given finite set , and @xmath4 is a suitable function .",
    "suppose that the system evolves on a horizon - interval @xmath5 $ ] for some @xmath6 , and that the initial state @xmath7 is given for some @xmath8 .",
    "the input control of this system , @xmath9 , is discrete since @xmath3 is a finite set , and we assume that the function @xmath9 changes its values a finite number of times during the horizon interval @xmath5 $ ] .",
    "such systems have been investigated in the past several years due to their relevance in control applications such as mobile robotics @xcite , vehicle control @xcite , switching circuits @xcite and references therein , telecommunications @xcite , and situations where a controller has to switch its attention among multiple subsystems @xcite or data sources @xcite .",
    "of a particular interest in these applications is an optimal control problem where it is desirable to minimize a cost functional ( criterion ) of the form @xmath10 for a given @xmath6 , where @xmath11 is a cost function defined on the state trajectory .",
    "this general nonlinear optimal - control problem was formulated in @xcite , where the particular values of @xmath2 are associated with the various modes of the system . as well as a discrete control @xmath12 .",
    "in this paper we focus only on the discrete control since it captures the salient points of switched - mode systems , and we defer discussion of the general case to a forthcoming publication . ]",
    "several variants of the maximum principle were derived for this problem in @xcite , and subsequently provably - convergent optimization algorithms were developed in @xcite .",
    "we point out that two kinds of problems were considered : those where the sequence of modes is fixed and the controlled variable consists of the switching times between them , and those where the controlled variable is comprised of the sequence of modes as well as the switching times between them .",
    "we call the former problem the _ timing optimization problem _ , and the latter problem , the _ scheduling optimization problems_.    the timing optimization problem generally is simpler than the scheduling optimization problem since essentially it is a nonlinear - programming problem ( albeit with a special structure ) having only continuous variables , while the scheduling problem has a discrete sequencing - variable as well",
    ". furthermore , scheduling problems generally are np hard , and computational techniques have to search for solutions that are suboptimal in a suitable sense .",
    "thus , while the algorithms that were proposed early focused on the timing optimization problem , several different ( and apparently complementary ) approaches to the scheduling - optimization problem have emerged as well .",
    "zoning algorithms that compute ( iteratively ) the mode sequences based on geometric properties of the problem have been developed in @xcite , needle - variations techniques were presented in @xcite , and relaxation methods were proposed in @xcite . in contrast , the algorithm considered in this paper computes its iterations directly in the schedule space without resorting to relaxations , and as argued later in the sequel , may compute optimal ( or suboptimal ) schedules quite effectively .",
    "our stating point is the algorithm we developed in @xcite which alternates between the following two steps : ( 1 ) . given a sequence of modes ,",
    "compute the switching times among them that minimize the functional @xmath13 .",
    "( 2 ) . update the mode - sequence by inserting to it a single mode at a ( computed ) time that would lead to the greatest - possible reduction rate in @xmath13 .",
    "then repeat step 1 , etc .",
    "the second step deserves some explanation .",
    "fix a time @xmath14 $ ] , and let us denote the system s mode at that time by @xmath15 .",
    "now suppose that we replace this mode by another mode , denoted by @xmath16 , over the time - interval @xmath17 $ ] for some given @xmath18 , and denote by @xmath19 the cost functional @xmath13 defined by ( 2 ) as a function of @xmath20 .",
    "we call the one - sided derivative @xmath21 the _ insertion gradient _ , and we note that if @xmath22 then inserting @xmath16 for a brief amount of time at time @xmath23 would result in a decrease in @xmath13 , while if @xmath24 then such an insertion would result in an increase in @xmath13 . now",
    "the second step of the algorithm computes the time @xmath25 $ ] and mode @xmath16 that minimize the insertion gradient , and it performs the insertion accordingly .",
    "we mention that if the insertion gradient is non - negative for every mode @xmath16 and time @xmath14 $ ] then the schedule in question satisfies a necessary optimality condition and no insertion is performed .",
    "the aforementioned algorithm has a peculiar feature in that it solves a timing optimization problem between consecutive mode - insertions .",
    "this feature appears awkward and suggests that the algorithm can be quite inefficient , but it is required for the convergence - proof derived in @xcite .",
    "in fact , that proof breaks down if the insertions are made for schedules that do not necessarily comprise solution points of the timing optimization problem for their given mode - sequences .",
    "the reason seems to be in the fact that the insertion gradient is not continuous in the time - points at which the insertion of a given mode @xmath16 is made .",
    "however , this lack of continuity can be overcome by other properties of the problem at hand , and this leads to the development of the algorithm that is proposed in this paper , which appears to be more efficient than the one in @xcite .",
    "the algorithm we describe here computes its iterations directly in the space of mode - schedules without having to solve any timing optimization problems .",
    "furthermore , at each iteration it switches the mode not at a finite set of times , but at sets comprised of unions of positive - length intervals in the time - horizon @xmath5 $ ] .",
    "the algorithm is based on the idea of the armijo step size used in gradient - descent techniques @xcite , and it uses the lebesgue measure of sets where the modes are to be changed as the step - size parameter .",
    "to the best of our knowledge this idea has not been used in extant algorithms for optimal control problems , and while it appears natural in the setting of switched - node systems , it may have extensions to other optimal - control settings as well .",
    "we prove the algorithm s convergence and its convergence - rate , which we show to be independent of the number of intervals where the modes are changed at a given iteration .    the rest of the paper is organized as follows .",
    "section ii sets the mathematical formulation of the problem and recounts some established results .",
    "section iii carries out the analysis , while section iv presents a simulation example .",
    "finally , section v concludes the paper .",
    "consider the state equation ( 1 ) and recall that the initial state @xmath26 and the final time @xmath6 are given .",
    "we make the following assumption regarding the vector field @xmath27 and the state trajectory @xmath28 .",
    "( i ) . for every @xmath2 ,",
    "the function @xmath27 is twice - continuously differentiable ( @xmath29 ) throughout @xmath30 .",
    "the state trajectory @xmath31 is continuous at all @xmath14 $ ] .",
    "every mode - schedule is associated with an input control function @xmath32\\rightarrow v$ ] , and we define an admissible mode schedule to be a schedule whose associated control function @xmath33 changes its values a finite number of times throughout the interval @xmath14 $ ] .",
    "we denote the space of admissible schedules by @xmath34 , and a typical admissible schedule by @xmath35 . given @xmath35 , we define the length of @xmath36 as the number of consecutive different values of @xmath12 on the horizon interval @xmath5 $ ] , and denote it by @xmath37 . furthermore , we denote the @xmath38 successive value of @xmath12 in @xmath36 by @xmath39 , @xmath40 , and the switching time between @xmath39 and @xmath41 will be denoted by @xmath42 . further defining @xmath43 and @xmath44 , we observe that the input control function is defined by @xmath45 @xmath46 , @xmath40 .",
    "we require that @xmath47 but impose no upper bound on @xmath37 .",
    "given @xmath35 , define the costate @xmath48 by the following differential equation , @xmath49 with the boundary condition @xmath50 .",
    "fix time @xmath51 , @xmath52 , and @xmath18 , and consider replacing the value of @xmath9 by @xmath53 for every @xmath54 .",
    "this amounts to changing the mode - sequence @xmath36 by inserting the mode associated with @xmath53 throughout the interval @xmath55 . denoting by @xmath19 the value of the cost functional resulting from this insertion",
    ", the insertion gradient is defined by @xmath21 .",
    "of course this insertion gradient depends on the mode - schedule @xmath36 , the inserted mode associated with @xmath52 , and the insertion time @xmath56 , and hence we denote it by @xmath57 .",
    "we have the following result ( e.g. , @xcite ) : @xmath58 as mentioned earlier , if @xmath59 then inserting to @xmath36 the mode associated with @xmath53 on a small interval starting at time @xmath56 would reduce the cost functional . on the other hand , if @xmath60 for all @xmath52 and @xmath61 $ ] then we can think of @xmath36 as satisfying a local optimality condition .",
    "formally , define @xmath62 , and define @xmath63\\}$ ] .",
    "observe that @xmath64 since @xmath65 is associated with the same mode at time @xmath56 and hence @xmath36 is not modified , and consequently , by definition , @xmath66 and @xmath67 as well .",
    "the condition @xmath68 is a natural first - order necessary optimality condition , and the purpose of the algorithm described below is to compute a mode - schedule @xmath36 that satisfies it .",
    "our algorithm is a descent method based on the principle of the armijo step size .",
    "given a schedule @xmath35 , it computes the next schedule , @xmath69 , by changing the modes associated with points @xmath61 $ ] where @xmath70 .",
    "the main point of departure from existing algorithms ( and especially those in @xcite ) is that the set of such points @xmath56 is not finite or discrete , but has a positive lebesgue measure .",
    "moreover , the lebesgue measure of this set acts as the parameter for the armijo procedure .",
    "now one of the basic requirements of algorithms in the general setting of nonlinear programming is that every accumulation point of a computed sequence of iteration points satisfies a certain optimality condition , like stationarity or the kuhn - tucker condition .",
    "however , in our case such a convergence property is meaningless since the schedule - space @xmath34 is neither finite dimensional nor complete , the latter due to the requirement that @xmath47 @xmath71",
    ". consequently convergence of our algorithm has to be characterized by other means , and to this end we use polak s concept of minimizing sequences @xcite .",
    "accordingly , the quantity @xmath72 acts as an _ optimality function _",
    "@xcite , namely the optimality condition in question is @xmath68 , while @xmath73 indicates an extent to which @xmath36 fails to satisfy that optimality condition .",
    "convergence of an algorithm means that , if it computes a sequence of schedules @xmath74 then , @xmath75 in some cases the stronger condition @xmath76 applies . in either case , for every @xmath77 the algorithm yields an admissible mode - schedule @xmath35 satisfying the inequality @xmath78 .",
    "our analysis will yield equation ( 5 ) by proving a uniformly - linear convergence rate of the algorithm .",
    "that will be discussed later .",
    "we will argue that the stronger form of convergence applies except for pathological situations .",
    "furthermore , we will define an alternative optimality function and prove the stronger form of convergence for it .",
    "the choice of the most - suitable optimality function is largely theoretical and will not be addressed in this paper . ]",
    "since the armijo step - size technique will play a key role in our algorithm , we conclude this section with a recount of its main features .",
    "consider the general setting of nonlinear programming where it is desirable to minimize a @xmath79 function @xmath80 , and suppose that the hessian @xmath81 is bounded on @xmath30 .",
    "given @xmath1 , a steepest descent from @xmath82 is any vector in the direction @xmath83 ; we normalize the gradient by defining @xmath84 , and call @xmath85 the steepest - descent direction",
    ". let @xmath86 denote the step size so that the next point computed by the algorithm , denoted by @xmath87 , is defined as @xmath88 the armijo step size procedure defines @xmath89 by an approximate line minimization in the following way ( see @xcite ) : given constants @xmath90 and @xmath91 , define the integer @xmath92 by @xmath93 and define @xmath94 now the _ steepest descent algorithm with armijo step size",
    "_ computes a sequence of iteration points @xmath95 , @xmath96 by the formula @xmath97 ; @xmath98 is called the armijo step size at @xmath95 .",
    "the main convergence property of this algorithm @xcite is that every accumulation point @xmath99 of a computed sequence @xmath100 satisfies the stationarity condition @xmath101 .",
    "several results concerning convergence rate have been derived as well , and the one of interest to us is given by proposition 1 below .",
    "its proof is contained in the arguments of the proof of theorem 1.3.7 and especially equation ( 8b ) in @xcite , but since we have not seen the result stated in the same way as in proposition 1 , we provide a brief proof in the appendix .",
    "suppose that @xmath102 is @xmath79 , and that there exists a constant @xmath103 such that , for every @xmath1 , @xmath104 , where @xmath105",
    ". then the following two statements are true : ( 1 ) . for every @xmath1 and for every @xmath106 such that @xmath107 , @xmath108 ( 2 ) . for every @xmath1 ,",
    "@xmath109    this implies the following convergence result :    ( 1 ) .",
    "there exists @xmath110 such that @xmath111 , @xmath112 ( 2 ) .",
    "if the algorithm computes a bounded sequence @xmath100 then @xmath113    ( 1 ) .",
    "define @xmath114 . then ( 11 ) follows directly from equations ( 9 ) and ( 10 ) .",
    "( 2 ) . follows immediately from part ( 1 ) and the fact that the sequence @xmath115 is monotone non - increasing .",
    "to simplify the notation and analysis we assume first that the set @xmath3 consists only of two elements , namely the system is bi - modal .",
    "this assumption incurs no significant loss of generality , and at the end of this section we will point out an extension to the general case where @xmath3 consists of an arbitrary finite number of points . let us denote the two elements of @xmath3 by @xmath116 and @xmath117 . a mode - schedule @xmath36 alternates between these two points , and we denote by @xmath118 the sequence of values of @xmath12 associated with the mode - sequence comprising @xmath36 . denoting by @xmath119 the complement of @xmath12",
    ", we have that @xmath120 for all @xmath121 .",
    "consider a mode - schedule @xmath35 that does not satisfy the necessary optimality condition , namely @xmath122 .",
    "define the set @xmath123 as @xmath124\\ : \\",
    "d_{\\sigma , s}<0\\}$ ] , and note that @xmath125 . recall that @xmath65 denotes the value of @xmath12 at the time @xmath56 .",
    "then for every @xmath126 which is not a switching time , an insertion of the complementary mode @xmath127 at @xmath56 for a small - enough period would result in a decrease of @xmath13 .",
    "our goal is to flip the modes ( namely , to switch them to their complementary ones ) in a large subset of @xmath123 that would result in a substantial decrease in @xmath13 , where by the term `` substantial decrease '' we mean a decrease by at least @xmath128 for some constant @xmath129 .",
    "this `` sufficient descent '' in @xmath13 is akin to the descent property of the armijo step size as reflected in equation ( 11 ) .",
    "this sufficient - descent property can not be guaranteed by flipping the mode at every time @xmath126 .",
    "instead , we search for a subset of @xmath123 where , flipping the mode at every @xmath56 in that subset would guarantee a sufficient descent .",
    "this subset will consist os points @xmath56 where @xmath130 is `` more negative '' than at typical points @xmath126 .",
    "fix @xmath131 and define the set @xmath132 by @xmath133\\ : \\",
    "d_{\\sigma , s}\\leq\\eta d_{\\sigma}\\big\\}.\\ ] ] obviously @xmath134 since @xmath122 .",
    "let @xmath135 denote the lebesgue measure of @xmath132 , and more generally , let @xmath136 denote the lebesgue measure on @xmath137 . for every subset @xmath138 ,",
    "consider flipping the mode at every point @xmath139 , and denote by @xmath140 the resulting mode - schedule . in the forthcoming",
    "we will search for a set @xmath138 that will give us the desired sufficient descent .",
    "fix @xmath131 .",
    "let @xmath141\\rightarrow   2^{s_{\\sigma,\\eta}}$ ] ( the latter object is the set of subsets of @xmath132 ) be a mapping having the following two properties : ( i ) @xmath142 $ ] , @xmath143 is the finite union of closed intervals ; and ( ii ) @xmath144 $ ] , @xmath145 .",
    "we define @xmath146 to be the mode - schedule obtained from @xmath36 by flipping the mode at every time - point @xmath147 . for example , @xmath144 $ ] define @xmath148\\cap s_{\\sigma,\\eta})=\\lambda\\}$ ] , and define @xmath149\\cap s_{\\sigma,\\eta}$ ] .",
    "then @xmath146 is the schedule obtained from @xmath36 by flipping the modes lying in the leftmost subset of @xmath132 having lebesgue - measure @xmath20 , and it is the finite union of closed intervals if so is @xmath132 .",
    "we next use such a mapping @xmath143 to define an armijo step - size procedure for computing a schedule @xmath69 from @xmath36 . given constants @xmath90 and @xmath91 , in addition to @xmath131 . consider a given @xmath35 such that @xmath122 . for every @xmath150 ,",
    "define @xmath151 , and define @xmath152 by @xmath153 finally , define @xmath154 , and set @xmath155 .",
    "observe that the armijo step - size procedure is applied here not to the steepest descent ( which is not defined in our problem setting ) but to a descent direction defined by a gteaux derivative of @xmath13 with respect to a subset of the interval @xmath5 $ ] where the modes are to be flipped .",
    "generally this gteux derivative is not necessarily continuous in @xmath20 and hence the standard arguments for sufficient descent do not apply .",
    "however , the problem has a special structure guaranteeing sufficient descent and the algorithm s convergence in the sense of minimizing sequences .",
    "furthermore , the sufficient descent property depends on @xmath135 but is independent of both the string size @xmath37 and the particular choice of the mapping @xmath141\\rightarrow 2^{s_{\\sigma,\\eta}}$ ] .",
    "this guarantees that the convergence rate of the algorithm is not reduced when the string lengths of the schedules computed in successive iterations grows unboundedly .",
    "we next present the algorithm formally .",
    "given constants @xmath90 , @xmath91 , and @xmath131 .",
    "suppose that for every @xmath35 such that @xmath122 there exists a mapping @xmath141\\rightarrow 2^{s_{\\sigma,\\eta}}$ ] with the aforementioned properties .",
    "_ step 0 : _ start with an arbitrary schedule @xmath156 . set @xmath157 .",
    "+ _ step 1 : _ compute @xmath158 .",
    "if @xmath159 , stop and exit ; otherwise , continue .",
    "+ _ step 2 : _ compute @xmath160 as defined in ( 13 ) , namely @xmath161\\ : \\",
    "d_{\\sigma_{k},s}\\leq\\eta d_{\\sigma_{k}}\\}$ ] .",
    "+ _ step 3 : _ compute @xmath162 as defined by ( 14 ) , namely @xmath163 with @xmath164 , and set @xmath165 .",
    "+ _ step 4 : _ define @xmath166 , namely the schedule obtained from @xmath167 by flipping the mode at every time - point @xmath168 .",
    "set @xmath169 , and go to step 1 .",
    "it must be mentioned that the computation of the set @xmath160 at step 2 typically requires an adequate approximation .",
    "this paper analyzes the algorithm under the assumption of an exact computation of @xmath160 , while the case involving adaptive precision will be treated in a later , more comprehensive publication .",
    "the forthcoming analysis is carried out under assumption 1 , above .",
    "it requires the following two preliminary results , whose proofs follow as corollaries from established results on sensitivity analysis of solutions to differential equations @xcite , and hence are relegated to the appendix .",
    "given @xmath35 , consider an interval @xmath170\\subset [ 0,t]$ ] of a positive length , such that the modes associated with all @xmath171 are the same , i.e. , @xmath172 @xmath173 .",
    "denote by @xmath174 the mode - sequence obtained from @xmath36 by flipping the modes at every time @xmath175 $ ] , and consider the resulting cost function @xmath176 as a function of @xmath177 $ ] .",
    "there exists a constant @xmath178 such that , for every @xmath35 , and for every interval @xmath179 $ ] as above , the function @xmath180 is twice - continuously differentiable @xmath181 on the interval @xmath182 $ ] ; and for every @xmath182 $ ] , @xmath183 ( `` prime '' indicates derivative with respect to @xmath184 .",
    "please see the appendix .",
    "we remark that the @xmath29 property of @xmath180 is in force only as long as @xmath172 @xmath185 $ ] .",
    "the second assertion of the above lemma does not quite follow from the first one ; the bound @xmath186 is independent of the specific interval @xmath187 $ ] .",
    "lemma 1 in conjunction with corollary 1 ( above ) can yield sufficient descent only in a local sense , as long as the same mode is scheduled according to @xmath36 . at mode - switching times",
    "@xmath130 is no longer continuous in @xmath56 , and hence lemma 1 can not be extended to intervals where @xmath33 does not have a constant value .",
    "nonetheless we can prove the sufficient - descent property in a more global sense with the aid of the following result , whose validity is due to the special structure of the problem .    there exists a constant @xmath178 such that for every @xmath35 , for every interval @xmath179 $ ] as above ( i.e. , such that @xmath36 has the same mode throughout @xmath188 ) , for every @xmath189 , and for every @xmath190 , @xmath191    please see the appendix .    to explain this result , recall that @xmath174 is the mode - schedule obtained from @xmath36 by flipping all the modes on the interval @xmath192 $ ] .",
    "thus , equation ( 16 ) provides an upper bound on the magnitude of the difference between the insertion gradients of the sequences @xmath36 and @xmath193 at the same point @xmath56 .",
    "furthermore , lemma 2 implies a uniform lipschitz continuity of the insertion gradient at every point @xmath194 with respect to the length of the insertion interval @xmath195 .",
    "this is not the same as continuity of @xmath130 with respect to @xmath56 , which we know is not true .",
    "recall the following terminology : given @xmath35 and @xmath196 $ ] , @xmath140 denotes the schedule obtained by flipping the mode of @xmath36 at every @xmath197 .",
    "there exists @xmath178 such that , for every @xmath35 , for every subset @xmath196 $ ] comprised of a finite number of intervals , and for every @xmath198 , @xmath199    let @xmath178 be the constant given by lemma 2 .",
    "fix @xmath35 , a subset @xmath196 $ ] comprised of a finite number of intervals , and @xmath198 .",
    "we can assume without loss of generality that each one of the intervals comprising @xmath200 contains its lower - boundary point but not its upper - boundary point .",
    "denote these intervals by @xmath201 , @xmath202 for some @xmath203 , so that @xmath204 .",
    "furthermore , by subdividing these intervals if necessary , we can assume that @xmath205 has a constant value throughout each interval @xmath206 , namely all the modes in @xmath206 are the same according to @xmath36 .",
    "note that these intervals need not be contiguous , i.e. , it is possible to have @xmath207 for some @xmath208 .",
    "define @xmath209 , @xmath202 , and note that @xmath210 .",
    "furthermore , @xmath211 .",
    "next , we have that @xmath212 by lemma 2 , @xmath213 , and for every @xmath214 , @xmath215 . by ( 16 ) @xmath216 , and since @xmath211 , ( 17 ) follows .",
    "we now can state the algorithm s property of sufficient descent .",
    "fix @xmath131 , @xmath91 , and @xmath217 .",
    "there exists a constant @xmath110 such that , for every @xmath35 satisfying @xmath122 , and for every @xmath218 $ ] such that @xmath219 , @xmath220    consider @xmath35 and an interval @xmath221 such that @xmath36 has the same mode throughout @xmath188 . by lemma 1",
    ", @xmath176 is @xmath29 in @xmath189 , and by ( 4 ) , @xmath222 .",
    "fix @xmath223 .",
    "suppose that @xmath224 . by proposition 1 ( equation ( 9 ) )",
    "there exists @xmath225 such that , for every @xmath226 satisfying @xmath227 , @xmath228 furthermore , @xmath229 does not depend on the mode - schedule @xmath36 or on the interval @xmath188 .",
    "next , by corollary 2 there exists a constant @xmath178 such that , for every @xmath35 , for every set @xmath196 $ ] consisting of the finite union of intervals , and for every point @xmath198 , @xmath199    fix @xmath110 such that @xmath230 we next prove the assertion of the proposition for this @xmath231 .",
    "fix @xmath35 such that @xmath122 , and consider a set @xmath138 consisting of the finite union of disjoint intervals . by subdividing these intervals if necessary",
    "we can ensure that the length of each one of them is less than @xmath232 .",
    "denote these intervals by @xmath201 , @xmath202 ( for some @xmath233 ) , define @xmath234 , and define @xmath235 .",
    "since @xmath236 we have that @xmath237 , and we recall that @xmath238 @xmath239 .",
    "next , we define the mode - schedules @xmath240 , @xmath202 , in the following recursive manner . for @xmath241 , @xmath242 ; and for every @xmath214 , @xmath243 . in words , @xmath244 is obtained from @xmath36 by flipping the mode at every time @xmath245 ; and for every @xmath214 , @xmath246 is obtained from @xmath247 by flipping the mode at every time @xmath248 .",
    "observe that @xmath246 is also obtained from @xmath36 by flipping the mode at every time @xmath249 .",
    "in particular , @xmath250 is obtained from @xmath36 by flipping the modes at every time @xmath139 . since by assumption @xmath251",
    ", we will use the notation @xmath252 .",
    "suppose that @xmath253 ; we next establish equation ( 19 ) , and this will complete the proof .",
    "consider the difference - term @xmath254 for @xmath202 .",
    "for @xmath241 , @xmath255 ( by ( 20 ) ) ; and since @xmath236 , @xmath256 , and hence @xmath257 nest , consider @xmath214 . an inequality like ( 23 ) does not necessarily hold since @xmath246 is obtained from @xmath36 by flipping the mode at every @xmath258 and @xmath259 may be larger than @xmath260 , and therefore an inequality like ( 20 ) can not be applied . a different argument is needed .",
    "consider the term @xmath254 . subtracting and adding @xmath261 we obtain , @xmath262 now @xmath246 is obtained from @xmath247 by flipping the mode at every time @xmath248 and hence @xmath263 , while @xmath264 since in the latter term no mode is being flipped .",
    "therefore , @xmath265 we next show that @xmath266 in order to be able to use equation ( 20 ) . by ( 17 ) , @xmath267 by definition @xmath268 ; by assumption @xmath219 ; and by ( 22 ) @xmath269 ; consequently , and by ( 26 ) , @xmath270 .",
    "but @xmath236 and hence @xmath256 , and this implies that @xmath271 .",
    "an application of ( 20 ) to ( 25 ) now yields that @xmath272 we do not know whether or not @xmath273 , but we know that @xmath274 ( since @xmath275 . applying ( 26 ) to ( 27 ) we obtain that @xmath276 but @xmath256 ( since @xmath236 ) , and hence , @xmath277 . using this inequality in ( 24 )",
    "yields the following one , @xmath278 apply ( 29 ) repeatedly and recursively with @xmath202 to obtain , after some algebra , the following inequality : @xmath279 but @xmath280 , @xmath281 , and @xmath282 , and hence , @xmath283 by assumption @xmath253 , and by ( 22 ) @xmath284 , and this , together with ( 31 ) , implies ( 19 ) .",
    "the proof is now complete .",
    "general results concerning sufficient descent , analogous to proposition 2 , provide key arguments in proving asymptotic convergence of nonlinear - programming algorithms ( see , e.g. , @xcite ) . in our case",
    ", the optimality function has the peculiar property that it is discontinuous in the lebesgue measure of the set where a mode is flipped . to see this , recall that @xmath285 ( see equation ( 4 ) ) , and hence a change of the mode at time @xmath56 would flip the sign of @xmath286",
    "this can result in situations where @xmath73 is `` large '' while @xmath132 is `` small '' , and for this reason , convergence of algorithm 1 is characterize by equation ( 5 ) with the @xmath287 rather than with the stronger assertion with @xmath288 .",
    "this is the subject of the following result .",
    "suppose that algorithm 1 computes a sequence of schedules , @xmath74 .",
    "then equation ( 5 ) is in force , namely @xmath289 .",
    "suppose , for the sake of contradiction , that equation ( 5 ) does not hold .",
    "then the sufficient - descent property proved in proposition 2 implies that @xmath290 , for otherwise equation ( 19 ) would yield @xmath291 which is impossible .",
    "next , by the definition of @xmath292 ( step 3 of the algorithm ) , there exists @xmath293 such that @xmath294 , @xmath295 , and hence @xmath296 . in this case",
    ", @xmath297 is obtained from @xmath167 by flipping the modes at every @xmath298 . by the perturbation theory of differential equations ( e.g. , proposition 5.6.7 in @xcite ) , @xmath82 and @xmath299",
    "are lipschitz continuous in their @xmath300 norms with respect to the lebesgue measure of the sets where the modes are flipped , i.e. @xmath301 . therefore , and by ( 4 ) and the definition of @xmath160",
    ", there exist @xmath302 and @xmath303 such that @xmath304 , @xmath305 , implying that @xmath306 .",
    "however this is a contradiction to the assumption that ( 5 ) does not hold , thus completing the proof .",
    "alternative optimality functions can be considered as well , like the term @xmath307 , where it is apparent equation ( 19 ) that @xmath308 .",
    "the choice of the `` most appropriate '' optimality function is an interesting theoretical question that will be addressed elsewhere , while here we consider the simplest and ( in our opinion ) most intuitive optimality function @xmath72 , despite its technical peculiarities .",
    "finally , a word must be said about the general case where the set @xmath3 consists of more than two points .",
    "the algorithm and much of its analysis remain unchanged , except that for a given @xmath35 , at a time @xmath56 , the mode associated with @xmath65 should be switched to the mode associated with the point @xmath52 that minimizes the term @xmath57 .",
    "we tested the algorithm on the double - tank system shown in figure 1 .",
    "the input to the system , @xmath12 , is the inflow rate to the upper tank , controlled by the valve and having two possible values , @xmath309 and @xmath310 . @xmath311 and @xmath312 are the fluid levels at the upper tank and lower tank , respectively , as shown in the figure . according to toricelli s law ,",
    "the state equation is @xmath313 with the ( chosen ) initial condition @xmath314 .",
    "notice that both @xmath311 and @xmath312 must satisfy the inequalities @xmath315 , and if @xmath316 indefinitely than @xmath317 , while if @xmath318 indefinitely then @xmath319 , @xmath320 .",
    "+    the objective of the optimization problem is to have the fluid level in the lower tank track the given value of 3.0 , and hence we chose the performance criterion to be @xmath321 for the final - time @xmath322 .",
    "the various integrations were computed by the forward - euler method with @xmath323 . for the algorithm we chose the parameter - values @xmath324 and @xmath325 , and we ran it from the initial mode - schedule associated with the control input @xmath326 $ ] and @xmath327 $ ] .",
    "results of a typical run , consisting of 100 iterations of the algorithm , are shown in figures 2 - 5 .",
    "figure 2 shows the control computed after 100 iterations , namely the input control @xmath12 associated with @xmath328 .",
    "the graph is not surprising , since we expect the optimal control initially to consist of @xmath318 so that @xmath312 can rise to a value close to 3 , and then to enter a sliding mode in order for @xmath312 to maintain its proximity to 3 .",
    "this is evident from figure 2 , where the sliding mode has begun to be constructed .",
    "figure 3 shows the resulting state trajectories @xmath329 and @xmath330 , @xmath14 $ ] , associated with the last - computed schedule @xmath328 .",
    "the jagged curve is of @xmath311 while the smoother curve is of @xmath312 .",
    "it is evident that @xmath312 climbs towards 3 initially and tends to stay there thereafter .",
    "figure 4 shows the graph of the cost criterion @xmath331 as a function of the iteration count @xmath332 .",
    "the initial schedule , @xmath333 , is far away from the minimum and its associated cost is @xmath334 , and the cost of the last - computed schedule is @xmath335 .",
    "note that @xmath331 goes down to under 8 after 3 iterations .",
    "figure 5 shows the optimality function @xmath158 as a function of the iteration count @xmath336 .",
    "initially @xmath337 while at the last - computed schedule @xmath338 , and it is seen that @xmath158 makes significant climbs towards 0 in few iterations .",
    "we also ran the algorithm for 200 iterations from the same initial schedule @xmath333 , in order to verify that @xmath331 and @xmath158 stabilize .",
    "indeed they do , and @xmath13 declined from @xmath335 to @xmath339 , while the optimality functions continues to rise towards 0 , from @xmath338 to @xmath340 .",
    "+     +     +     +",
    "this paper proposes a new algorithm for the optimal mode - scheduling problem , where it is desirable to minimize an integral - cost criterion defined on the system s state trajectory as a function of the modes schedule .",
    "the algorithm is based on the principle of gradient descent with armijo step sizes , comprised of the lebesgue measures of sets where the modes are being changed .",
    "asymptotic convergence is proved in the sense of minimizing sequences , and simulation results support the theoretical developments .",
    "future research will refine the proposed algorithmic framework and apply it to large - scale problems .",
    "the purpose of this appendix is to provide proofs to proposition 1 , and lemmas 1 and 2 .",
    "the main argument is based on the following form of the second - order taylor series expansion : for every @xmath1 and @xmath341 , @xmath342 where @xmath343 denotes inner product in @xmath30 .",
    "apply this with @xmath344 to obtain , @xmath345 add @xmath346 to both sides of this equation , and use the fact that @xmath347 , to obtain ( after some algebra ) that @xmath348 now if @xmath349 then the right - hand side of ( 36 ) is non - positive , hence equation ( 9 ) is satisfied .",
    "the proofs of lemma 1 and lemma 2 follow as corollaries from established results on sensitivity analysis of solutions to differential equations , presented in section 5.6 of @xcite .",
    "in fact , the results of interest here involve mode - insertions via needle variations , which is a special case of the setting in @xcite where general variations in the control are considered .",
    "furthermore , the perturbations here are parameterized by a one - dimensional variable and hence the results are in terms of derivatives in the usual sense , while those in @xcite are in terms of gteaux or frchet derivatives .",
    "_ proof of lemma 1 .",
    "_ by proposition 5.6.5 in @xcite and the bellman - gronwall lemma , the terms @xmath350 are uniformly bounded over the space of controls @xmath12 associated with every @xmath35 . the costate equation ( 3 )",
    "yields a similar result for @xmath351 .",
    "next , recall that @xmath33 has a constant value throughout the interval @xmath187 $ ] , and hence the differentiability assumptions of theorem 5.6.10 in @xcite are valid .",
    "this theorem implies that @xmath352 exists and is expressed in terms of the hamiltonian and its first two derivatives , hence it is uniformly bounded .",
    "_ proof of lemma 2 . _",
    "since @xmath33 has a constant value throughout the interval @xmath187 $ ] , the assumptions made in the statement of lemma 5.6.7 in @xcite are in force .",
    "this implies a uniform lipschitz continuity of @xmath82 and @xmath299 with respect to variations in @xmath195 . in the setting of lemma 2",
    ", the needle variations is made at the same point @xmath190 for both mode - schedules @xmath36 and @xmath174 , and hence , and by equation ( 4 ) , equation ( 16 ) follows .",
    "attia , m. alamir , and c. canudas de wit .",
    "sub optimal control of switched nonlinear systems under location and switching constraints .",
    "16th ifac world congress _ ,",
    "prague , the czech republic , july 3 - 8 , 2005 .",
    "h. axelsson , y. wardi , m. egerstedt , and e. verriest .",
    "a gradient descent approach to optimal mode scheduling in hybrid dynamical systems .",
    "_ journal of optimization theory and applications _ ,",
    "167 - 186 , 2008 .",
    "d. hristu - varsakelis .",
    "feedback control systems as users of shared network : communication sequences that guarantee stability . _ ieee conference on decision and control _ , pp .",
    "36313631 , orlando , fl , 2001 .",
    "shaikh and p.e .",
    "optimality zone algorithms for hybrid systems computeation and control : from exponential to linear complexity .",
    "ieee conference on decision and control / european control conference _",
    "1403 - 1408 , seville , spain , december 2005 .",
    "wang , a. beydoun , j. cook , j. sun , and i. kolmanovsky .",
    "optimal hybrid control with applications to automotive powertrain systems . in _ control using logic - based switching _",
    "222 of lncis , pp . 190 - 200 , springer - verlag , 1997 ."
  ],
  "abstract_text": [
    "<S> this paper considers the problem of computing the schedule of modes in a switched dynamical system , that minimizes a cost functional defined on the trajectory of the system s continuous state variable . </S>",
    "<S> a recent approach to such optimal control problems consists of algorithms that alternate between computing the optimal switching times between modes in a given sequence , and updating the mode - sequence by inserting to it a finite number of new modes . </S>",
    "<S> these algorithms have an inherent inefficiency due to their sparse update of the mode - sequences , while spending most of the computing times on optimizing with respect to the switching times for a given mode - sequence . </S>",
    "<S> this paper proposes an algorithm that operates directly in the schedule space without resorting to the timing optimization problem . </S>",
    "<S> it is based on the armijo step size along certain gteaux derivatives of the performance functional , thereby avoiding some of the computational difficulties associated with discrete scheduling parameters . </S>",
    "<S> its convergence to local minima as well as its rate of convergence are proved , and a simulation example on a nonlinear system exhibits quite a fast convergence . </S>"
  ]
}