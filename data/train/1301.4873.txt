{
  "article_text": [
    "the aim of this paper is to derive operator approximations of the matrix computations used to estimate the fixed and the random effects in a mixed - effects model , where @xmath0 samples @xmath1 of temporal curves have been observed at @xmath2 predefined time points @xmath3 .",
    "the main technical contribution of this paper , making it practically possible to solve the estimation problem as a functional estimation problem , is that the proposed operator approximations have linear computational complexity in the sample length @xmath2 .",
    "consequently , the mixed - effects inference becomes feasible in the realm of functional data analysis , where @xmath2 can be large .",
    "concatenating the samples @xmath4 into an observation vector @xmath5 with dimension @xmath6 the statistical model we use is given by @xmath7 in this linear mixed - effects model the design matrices @xmath8 and @xmath9 are known and assumed to have full ranks @xmath10 and @xmath11 , respectively , and the fixed effects @xmath12 and the random effects @xmath13 may be shared by the @xmath0 samples . the random component @xmath14 is partitioned in the same way as the observation vector @xmath15 and consists of discretized readings @xmath16 of unobserved ( latent ) random functions @xmath17 \\to { \\mathbb{r}}$ ] .",
    "we assume that the random functions @xmath18 are independent and identically distributed gaussian processes with zero mean .",
    "the covariance matrix @xmath19 will be specified below appealing to the smoothing splines methodology often used in functional data analysis . due to the i.i.d .",
    "assumption there exists a covariance matrix @xmath20 such that @xmath21 , where @xmath22 is the kronecker tensor product , and @xmath23 is the identity matrix of dimension @xmath0 .",
    "the last component in the mixed - effects model is the measurement noise @xmath24 .",
    "our objective is to derive computationally efficient formulae for the maximum likelihood estimate of the fixed effects @xmath25 , the best linear unbiased predictions of the random effects @xmath26 and of the latent random functions @xmath17 \\to { \\mathbb{r}}$ ] , and for the restricted likelihood function .",
    "the latter allow for restricted likelihood inference on the variance parameters @xmath27 , @xmath28 and @xmath20 .",
    "the methodology presented in this paper has two notable differences as compared to the penalized likelihood approach to functional data analysis ; see , for example , the books by ramsay and silverman @xcite . from the viewpoint of computations",
    "we devise methods that work directly on the data vector @xmath15 and , for example , provide predictions @xmath29 $ ] of the temporal derivatives of the latent functional parameters .",
    "in particular , there is no basis representation of the functional object @xmath30 $ ] .",
    "this is by contrast with the standard technology used in functional data analysis , where functional parameters are given a finite dimensional representation , for example , in a spline basis , and the sparseness of the associated covariance matrices is invoked to achieve feasible computations . as an alternative to this we use analytically tractable operator approximations of the matrix equations . from the viewpoint of statistical modeling we model the functional parameters @xmath31 as random effects . whether this is preferable over the fixed effect interpretation underlying the penalized likelihood depends on the particular application at hand .",
    "the distinction between random and fixed effects is here the same as for classical mixed - effects models ; see @xcite for a thorough discussion of the issue and @xcite for a comparison of the associated inference methodologies .    in the simplified version @xmath32 of model equation ( [ eqmodel ] )",
    ", the sample @xmath33 may be understood as a noisy observation of the function @xmath17 \\to { \\mathbb{r}}$ ] taken at the sample points @xmath3 . in the penalized likelihood approach to functional data analysis the functional parameters @xmath31 are treated as fixed effects .",
    "the penalized negative log likelihood is given by @xmath34 where @xmath35 is a differential operator of some order @xmath36 measuring the roughness of a function @xmath37 ; { \\mathbb{r}})$ ] .",
    "the so - called smoothing parameter @xmath38 quantifies the trade - off between a close fit of the observations and the roughness of the functional parameters .",
    "since the space of functions is infinite - dimensional , such a trade - off is required to avoid overfitting of the finite number of data points .    in this paper",
    "we avoid the curse of dimensionality by providing the theoretical solution in the function space before plugging in the observed grid readings to compute the solution .",
    "this is done using the operator @xmath39 , which is of order @xmath40 and defined on @xmath41 ; { \\mathbb{r}})$ ] . to ensure positive definiteness of @xmath42 we impose boundary conditions .",
    "let @xmath43 for @xmath44 be fixed , and let the function space @xmath45 be defined by @xmath46 ; { \\mathbb{r } } )     \\vert \\theta^{(a_i)}(a ) = \\theta^{(b_i)}(b ) = 0    \\mbox { for $ i=1,\\ldots , k$ }   \\bigr\\},\\ ] ] where @xmath47 denotes the @xmath48th order derivative of @xmath49 . applying integration by parts @xmath36 times the penalty terms in equation ( [ eqnlogpenalizedlikelihood ] )",
    "may be rewritten via @xmath50 this identity also implies that @xmath42 is a positive semidefinite operator on @xmath45 . a condition ensuring @xmath42 to be invertible is given in section  [ secexplicit ] .",
    "in the affirmative case the inverse operator is given by a so - called green s function @xmath51 via @xmath52 .",
    "since @xmath42 is positive definite it follows that @xmath51 is positive definite .",
    "in particular , the matrix defined by @xmath53 is positive definite and may be used as the variance of the serially correlated effects @xmath54 .",
    "this specification establishes a link between the covariance matrix @xmath55 of the discretized readings @xmath54 in the model equation  ( [ eqmodel ] ) and the penalized likelihood equation ( [ eqnlogpenalizedlikelihood ] ) .",
    "the proposed methodology can be slightly generalized taking @xmath42 as the sum of squares @xmath56 of operators measuring different aspects of roughness .",
    "the operator @xmath42 may be interpreted as a precision and used in the parameterization of a statistical model .",
    "this is by contrast with standard software for mixed - effects models such as the nlme - package @xcite in r or the mixed procedure in sas , where the parameterization is done in terms of variances . in @xcite",
    "a similar approach was taken for the analysis of longitudinal data , and further references may be found in @xcite , chapter 8.4 .",
    "the remainder of this paper is organized as follows .",
    "section  [ secinference ] reviews inference techniques for the model equation ( [ eqmodel ] ) .",
    "in particular , we present the matrix formulae that will be approximated by their operator equivalents .",
    "section  [ secmath ] provides the mathematical contributions of the paper . in this section",
    "the operator approximation is introduced and refined for the case of equidistant observations , that is , @xmath57 . in particular , we derive semi - explicit and numerically stable formulae for the needed computations in the case of equidistant observations . in section  [ secstatistics ]",
    "the operator approximation is applied on the matrix formulae from section  [ secinference ] .",
    "this leads to concrete algorithms that have been implemented in an r - package named fdamixed @xcite .",
    "this section reviews estimation and inference techniques for the model equation ( [ eqmodel ] ) .",
    "since the derivations of the matrix formulae stated below are standard ( see , e.g. , @xcite ) , no proofs will be given .",
    "the dimensions are given by @xmath58 where @xmath6 .",
    "based on the covariance matrices @xmath59 and @xmath60 we define the matrices @xmath61 , @xmath62 , and @xmath63 the matrix formulae will be stated such that for moderately sized @xmath10 and @xmath11 the computational obstacle of their practical implementation lies in the initialization and inversion of the @xmath2-dimensional matrix @xmath64 . the circumvention of this obstacle is the topic of section  [ secmath ] .    for known variance parameters @xmath65 , @xmath59 , @xmath66",
    ", the best unbiased estimate for the fixed effects is given by the maximum likelihood estimate @xmath67 the best linear unbiased predictions ( blups ) for the random effects @xmath68 and the serially correlated effects @xmath69 are given by the conditional means @xmath70",
    "= c_u z^\\top a^{-1 }   ( y - \\gamma\\hat{\\beta }   ) ,    \\qquad    { \\mathrm{e}}[x \\vert y ]   = r a^{-1 }   ( y - \\gamma\\hat{\\beta } -    z { \\mathrm{e}}[u \\vert y ]   ) .\\ ] ]    it is generally agreed ( see , e.g. , @xcite and @xcite , chapter 5.3 ) that the variance parameters may be estimated as the maximizers of the restricted likelihood .",
    "one of the factors in the likelihood is the determinant of @xmath71 . to derive the operator approximation of this factor we use the representation @xmath72 where the vectors @xmath73 for @xmath74 constitute an orthonormal basis for @xmath75 . using this representation and introducing the conditional residuals @xmath76 - { \\mathrm{e}}[x \\vert y]$ ] ,",
    "the double negative log restricted likelihood is given by @xmath77^\\top g^{-1 } { \\mathrm{e}}[u \\vert y ] + { \\mathrm{e}}[x \\vert y]^\\top r^{-1 } { \\mathrm{e}}[x \\vert y ]   ) , \\nonumber\\end{aligned}\\ ] ] where it should be kept in mind that @xmath78 , @xmath79 , @xmath80 $ ] , @xmath81 $ ] depend on @xmath59 and @xmath66 .",
    "the profile estimate for the error variance @xmath65 has an explicit form , @xmath82^\\top g^{-1 } { \\mathrm{e}}[u \\vert y ] + { \\mathrm{e}}[x \\vert y]^\\top r^{-1 } { \\mathrm{e}}[x \\vert y ]   ) .\\ ] ]    we conclude this section by reviewing some theoretical results on the inference techniques described above .",
    "the errors @xmath83 , @xmath80-u$ ] , @xmath81-x$ ] follow a joint gaussian distribution , and their joint covariance may be derived using @xcite , section 2.4 .",
    "kackar and harville @xcite show that if the estimators for the variance parameters are translation - invariant and even functions of @xmath15 , then @xmath84 , @xmath80 $ ] , @xmath81 $ ] remain unbiased when the estimates are inserted in place of the unknown variance parameters . as explained by welham and thompson @xcite inference on @xmath25",
    "may be done as @xmath85-tests on twice the log ratio between the maximum restricted likelihoods , where the design matrix under the null hypothesis is used in the definition of the restricted likelihood under the model .",
    "simulation studies done by morrell @xcite suggest that inference on the variance parameters may be done as @xmath85-tests on twice the log ratio between the maximum restricted likelihoods , but here the formal asymptotic theory appears to be less developed .",
    "functional data consist of observations of continuous curves at discrete sample points . as an alternative to computations based on spline representations and sparse matrix computations we embed the discrete observations into the continuous setting and",
    "approximate the matrix computations by their operator counterparts . in order to describe this operator approximation",
    "we first introduce some notation .    by a discretization of size @xmath2 of the time interval @xmath86 $ ] we mean a set of points @xmath87 with @xmath88 .",
    "such a discretization is said to be equidistant if @xmath89 , and in that case we associate the mesh length given by @xmath90 .",
    "to ease notation we implicitly adjoin the points @xmath91 and @xmath92 to any discretization of size @xmath2 .",
    "given a vector @xmath93 we denote by @xmath94 the piecewise linear embedding of @xmath95 into @xmath96 ; { \\mathbb{r}})$ ] , that is , the function that is linear on the segments @xmath97 $ ] for @xmath98 with @xmath99 , @xmath100 and @xmath101 for @xmath102 .",
    "we also introduce the multiplication operator @xmath103 on @xmath96 ; { \\mathbb{r}})$ ] defined by @xmath104 ; { \\mathbb{r}}),\\ ] ] where @xmath105 is given from the discretization @xmath106 via @xmath107 in particular , if @xmath106 is equidistant , then @xmath108 .",
    "[ propapproximation ] let a discretization @xmath106 of the interval @xmath86 $ ] , @xmath109 $ ] and @xmath110 \\times [ a , b ] ; { \\mathbb{r}})$ ] be given",
    ". assume that @xmath111 is twice differentiable on the segments @xmath97 $ ] with continuous derivatives @xmath112 .",
    "for @xmath95 there exists @xmath113 for @xmath98 and @xmath114 , @xmath115 such that @xmath116 equals @xmath117 where @xmath118 is given by equation  ( [ eqmu ] ) .",
    "the _ trapezoidal rule _ of integration @xcite , section 7.2 , gives intermediate points @xmath119 such that @xmath120 equals @xmath121 & & \\quad { } + \\frac{b - t_n}{2 } { \\mathcal{g}}(t , b ) { \\mathscr{e}}_\\mu(b ) { \\mathscr{e}}_z(b ) - \\frac{1}{12 } \\sum_{n=0}^n ( t_{n+1}-t_n)^3   ( { \\mathcal{g}}(t,\\cdot )    { \\mathscr{e}}_\\mu { \\mathscr{e}}_z   ) ^{(2)}(\\xi_n).\\end{aligned}\\ ] ] the result follows inserting the piecewise linear functions @xmath122 and @xmath94 , the first - order taylor expansions at some intermidiate points @xmath114 , @xmath115 , @xmath123 by expanding the second - order derivative and by rearranging the terms .",
    "[ corrapproximation ] if the discretization @xmath106 is equidistant , then there exists @xmath124 for @xmath102 such that the approximation error equation ( [ eqerror ] ) equals @xmath125 & & \\quad { } + \\frac{b - a}{12 n } \\sum_{n=1}^n ( t_{n+1}-\\xi_n )   \\bigl ( { \\mathcal{g}}^{(2)}(t,\\xi_n ) - { \\mathcal{g}}^{(2)}(t , t_n )   \\bigr ) z_n   \\nonumber\\\\[-2pt ] & & \\quad { } - \\frac{b - a}{6 n } \\sum_{n=1}^n ( \\xi_n-\\xi_{n-1 } )   \\bigl ( { \\mathcal{g}}^{(2)}(t,\\widetilde{\\xi}_n ) - { \\mathcal{g}}^{(2)}(t , t_n )   \\bigr ) z_n \\\\[-2pt ] & & \\quad { } + \\frac{b - a}{12 n } \\sum_{n=1}^n ( \\xi_{n-1}-t_{n-1 } )   \\bigl ( { \\mathcal{g}}^{(2)}(t,\\xi_{n-1 } ) - { \\mathcal{g}}^{(2)}(t , t_n )   \\bigr ) z_n \\nonumber\\\\[-2pt ] & & \\quad { } + \\frac{(b - a)^2}{8 n^2 } { \\mathcal{g}}^{(1)}(t,\\zeta_1 ) \\mu_1 z_1 - \\frac{(b - a)^2}{8 n^2 } { \\mathcal{g}}^{(1)}(t,\\zeta_n ) \\mu_n z_n .",
    "\\nonumber\\end{aligned}\\ ] ]    equidistant spacing implies that the factors @xmath126 defined in equation ( [ eqmu ] ) are constant , and the approximation error equation ( [ eqerror ] ) reduces to @xmath127 & & \\quad { } + \\sum_{n=0}^n \\frac{b - a}{12 n } \\biggl ( \\frac{b - a}{n }    { \\mathcal{g}}^{(2)}(t,\\xi_n ) { \\mathscr{e}}_z(\\xi_n ) +    2 { \\mathcal{g}}^{(1)}(t,\\xi_n )   ( z_{n+1}-z_n   )   \\biggr).\\end{aligned}\\ ] ] the last sum equals @xmath128 by taylor s theorem there exists @xmath129 such that this equals @xmath130 the corollary follows centering the terms @xmath131 around @xmath132 .",
    "if the matrix @xmath133 and the integral operator @xmath134 on @xmath96 ; { \\mathbb{r}})$ ] are defined by @xmath135 and @xmath136 , then the preceding results suggest the approximation @xmath137 green s functions usually possess sufficient smoothness for proposition  [ propapproximation ] to apply ( see , e.g. , @xcite ) , and hence the approximation error in equation ( [ eqapprox ] ) vanishes as @xmath138 goes to zero . in case of equidistant discretizations",
    "this property is refined in corollary  [ corrapproximation ] .",
    "the first term in equation ( [ eqerror2 ] ) is of size @xmath139 and the other terms are of size @xmath140 .",
    "perhaps the first term can be used to derive and correct a bias arising from the proposed operator approximation , but we will leave this to be studied in future work .      to motivate the derivations done in this section we may consider the model equation ( [ eqmodel ] ) without the fixed and the random effects , that is , @xmath141 . in this case equation ( [ eqapprox ] ) implies the approximation of the prediction equation ( [ eqblup ] ) of the @xmath142th serially correlated effect given by @xmath143 = r_0 a_0^{-1 } y_m =   ( { \\mathbb{i}}_n + r_0^{-1 }     ) ^{-1 } y_m \\approx   \\ {   ( { \\mathbb{i}}+ { \\mathscr{m}}_{\\mathcal{t}}^{-1 }    { \\mathscr{l}})^{-1 } { \\mathscr{e}}_{y_m}(t_n )   \\}_{n=1,\\ldots , n}\\ ] ] and the approximation of the logarithmic determinant equation ( [ eqlogdet ] ) given by @xmath144   \\\\[-9pt ] & \\approx & \\int_0 ^ 1 \\sum_{j=1}^n   ( v{\\mathbb{i}}+ { \\mathscr{m}}_{\\mathcal{t}}^{-1 } { \\mathscr{l}})^{-1 } { \\mathscr{e}}_{e_j}(t_j)\\ , { \\mathrm{d}}v \\approx \\int_0 ^ 1 \\int_a^b { \\mathcal{g}}_v(t , t)\\ , { \\mathrm{d}}t\\ , { \\mathrm{d}}v , \\nonumber\\end{aligned}\\ ] ] where @xmath145 is the green s function for @xmath146 .",
    "as shown in section  [ secstatistics ] the matrix formulae used for inference in the full mixed - effects model equation ( [ eqmodel ] ) may be similarly approximated . in order to develop our computational methodology",
    "we derive semi - explicit and numerically stable inversion formulae for differential operators of the type @xmath147 .",
    "if the discretization @xmath106 is equidistant with mesh length @xmath148 , and the differential operator @xmath42 has constant coefficients , then @xmath149 may be inverted using theorem  [ thmgreen ] stated below .",
    "boundary conditions play an essential role in this theorem , and the reader may want to refresh the definition of the space @xmath45 given in equation ( [ defh ] ) .",
    "[ thmgreen ] consider a differential operator @xmath150 on @xmath45 given by @xmath151 with @xmath152 .",
    "let @xmath153 , with @xmath154 , be the jordan canonical form of the companion matrix @xmath155 let @xmath156 be a non - trivial solution of the matrix equation @xmath157 , and let @xmath158 be the decomposition of the first row of @xmath0 along the jordan blocks @xmath159 .",
    "let @xmath160 , @xmath161 , and let @xmath162 be given by @xmath163 let @xmath164 , and let @xmath165 be defined by @xmath166 if the matrix @xmath167 is invertible , then @xmath150 is invertible . in the affirmative case",
    "the inverse operator is an integral operator @xmath168 , where the green s function @xmath169 is given by @xmath170    the proof follows specializing and condensing @xcite , theorem 3 .",
    "the signs of  @xcite , equation ( 3.15 ) , equation ( 3.24 ) , should be changed due to a mistake of sign in @xcite , equation ( 3.9 ) . we allow for leading coefficient @xmath171 and",
    "have interchanged the indices @xmath36 and @xmath10 to align with the notation used in the present paper .",
    "formula ( [ eqgreen ] ) is explicit and most satisfactory from a theoretical point of view .",
    "but from a practical point of view the formula can be numerically unstable since the exponentials @xmath172 , @xmath173 and @xmath174 are weighted against similar exponentials in the definition of the matrix @xmath175 . imposing symmetry of the jordan matrix it is , however , possible to remove the potential numerical instabilities .",
    "[ propnumericalstable ] suppose that the characteristic polynomial @xmath176 for the differential operator ( [ eqlop ] ) has @xmath40 distinct roots @xmath177 such that the real values of the @xmath36 eigenvalues @xmath178 are non - positive and the real values of the @xmath36 eigenvalues @xmath179 are non - negative .",
    "then the jordan canonical form of the companion matrix equation ( [ eqcompanion ] ) is diagonal with block diagonals consisting of eigenvalues with non - positive and non - negative real values , respectively , @xmath180 and the matrix @xmath181 may be decomposed via @xmath182 defined by @xmath183 furthermore , define @xmath184 , @xmath185 , @xmath186 via @xmath187 , and the vectors @xmath188 for @xmath109 $ ] and @xmath189 by @xmath190 and @xmath191 then the @xmath118th partial derivative @xmath192 of the green s function defined in equation ( [ eqgreen ] ) may be rewritten as the numerically stable expression @xmath193    from equation ( [ eqgreen ] ) we have that @xmath192 equals @xmath194 the crux of the reformulation of this representation lies in the inversion of the matrix @xmath195 . to this end",
    ", we write @xmath196 and @xmath197 as block matrices with @xmath198-blocks , @xmath199 using elementary matrix algebra we find that @xmath200 for general @xmath201 equals @xmath202   \\\\[-8pt ]   & \\displaystyle \\bigl ( f_a w_- { \\mathrm{e}}^{(a - t ) j_- } - f_a w_+ { \\mathrm{e}}^{-(b - a ) j_+ } ( f_b w_+)^{-1 }    f_b w_- { \\mathrm{e}}^{(b - t ) j_- }   \\bigr)^{-1}. & \\nonumber\\end{aligned}\\ ] ] inserting this above we have that @xmath192 for @xmath203 equals @xmath204 which equals @xmath205 combining equations ( [ eqgreennum4 ] ) and ( [ eqgreennum5 ] ) and rearranging the exponential factors we arrive at equation ( [ eqgreennum1 ] ) for @xmath203 . the reformulation is done similarly for @xmath206 .    from the viewpoint of statistical modeling , the results in @xcite are more general in two valuable ways .",
    "firstly , the boundary conditions separately given at the end - points of the sample interval via the matrices @xmath207 , @xmath208 in theorem  [ thmgreen ] may be given in form of linear combinations of the curve and its derivatives at @xmath209 and @xmath210 via general @xmath211 and @xmath212 .",
    "in particular , boundary conditions enforcing periodicity may be stated . but to derive the numerically stable formulae stated in proposition  [ propnumericalstable ] , we have refrained from this possibility .",
    "secondly , the results in @xcite are given for matrix - valued functions .",
    "this generalization allows our methods to be extended to multivariate functional data analysis .    in the following theorem the explicit inversion formula is applied to derive a simultaneous computation of @xmath213 for @xmath102 , where @xmath95 , that easily may be implemented with computational complexity @xmath214 .",
    "furthermore , the inner integral in the approximation equation ( [ eqapprox2 ] ) of the logarithmic determinant may be explicitly computed for lebesgue almost all @xmath215 $ ] . in the statement of the theorem",
    "we denote by @xmath216 the element - wise multiplication of matrices or vectors of the same dimension . unless specified otherwise the @xmath216 operation is performed after ordinary matrix multiplications .",
    "[ thmfda ] suppose the discretization @xmath106 is equidistant with mesh length @xmath90 , and assume that the operator in equation ( [ eqlop ] ) given by @xmath149 satisfies the conditions of proposition  [ propnumericalstable ] .",
    "denote by @xmath169 the green s function for @xmath150 , let @xmath217 , @xmath218 , @xmath219 , @xmath220 , @xmath221 , @xmath222 , @xmath223 , @xmath224 be as defined in proposition  [ propnumericalstable ] , and let @xmath225 be defined by @xmath226    \\xi_-^0 & = & \\biggl\\ { \\frac{1 - ( 1-\\delta\\eta_i^- ) \\exp(\\delta",
    "\\eta_i^-)}{\\delta ( \\eta_i^-)^2 } \\biggr\\}_{i=1,\\ldots , k } , \\qquad    \\xi_+^0 = \\biggl\\ { \\frac{\\exp(-\\delta \\eta_i^+ ) - 1 +    \\delta \\eta_i^+}{\\delta ( \\eta_i^+)^2 }    \\biggr\\}_{i=1,\\ldots , k } , \\\\[-2pt ]    \\xi_-^1 & = & \\biggl\\ { \\frac{\\exp(\\delta\\eta_i^- ) - 1 -    \\delta\\eta_i^-)}{\\delta ( \\eta_i^-)^2 } \\biggr\\}_{i=1,\\ldots , k } ,    \\hspace*{10pt}\\qquad    \\xi_+^1 = \\biggl\\ { \\frac{1 - ( 1+\\delta \\eta_i^+ )    \\exp(-\\delta \\eta_i^+)}{\\delta ( \\eta_i^+)^2 }    \\biggr\\}_{i=1,\\ldots , k}.\\end{aligned}\\ ] ] for @xmath227 the @xmath118th derivative @xmath228 taken at the sample point @xmath229 is given by @xmath230 & & \\quad{}+ \\phi_\\mu(t_n )   \\sum_{j=1}^n { \\mathrm{e}}^{(t_n - t_j ) j_- }   \\bigl(v_- \\odot ( 1_{j=1 } \\xi_- + 1_{j > 1 } \\xi_-^1 )   \\bigr ) z_j   \\\\[-2pt ] & & \\quad{}- \\psi_\\mu(t_n )   \\sum_{j = n}^n { \\mathrm{e}}^{-(t_j - t_n ) j_+ } \\bigl ( v_+ \\odot    ( 1_{j <",
    "n } \\xi_+^0 + 1_{j = n } \\xi_+ )   \\bigr ) z_j \\\\[-2pt ] & & \\quad{}- \\psi_\\mu(t_n ) 1_{n < n }   \\sum_{j = n+1}^n { \\mathrm{e}}^{-(t_{j-1}-t_n ) j_+ } ( v_+    \\odot \\xi_+^1 ) z_j \\\\[-2pt ] & & \\quad{}+ \\phi_\\mu(t_n ) { \\mathrm{e}}^{(t_n - a ) j_- } ( f_a w_-)^{-1 } f_a w_+ 1_{n > 1 }   \\sum_{j=1}^{n-1 } { \\mathrm{e}}^{-(t_j - a ) j_+ } ( v_+ \\odot \\xi_+^0 ) z_j \\\\[-2pt ] & & \\quad{}+ \\phi_\\mu(t_n ) { \\mathrm{e}}^{(t_n - a ) j_- } ( f_a w_-)^{-1 } f_a w_+   \\sum_{j=1}^n { \\mathrm{e}}^{-(t_{j-1}-a ) j_+ } \\bigl ( v_+ \\odot ( 1_{j=1 } \\xi_+ + 1_{j > 1 } \\xi_+^1 )   \\bigr ) z_j \\\\[-2pt ] & & \\quad{}- \\psi_\\mu(t_n ) { \\mathrm{e}}^{-(b - t_n ) j_+ } ( f_b w_+)^{-1 } f_b w_-   \\sum_{j = n}^n { \\mathrm{e}}^{(b - t_{j+1 } ) j_- } \\bigl ( v_- \\odot ( 1_{j < n } \\xi_-^0",
    "+ 1_{j = n } \\xi_- )   \\bigr ) z_j \\\\[-2pt ] & & \\quad{}- \\psi_\\mu(t_n ) { \\mathrm{e}}^{-(b - t_n ) j_+ } ( f_b w_+)^{-1 } f_b w_- 1_{n < n }   \\sum_{j = n+1}^n { \\mathrm{e}}^{(b - t_j ) j_- } ( v_- \\odot \\xi_-^1 ) z_j.\\end{aligned}\\ ] ]    concerning the log determinant assume that the operator in equation ( [ eqlop ] ) given by @xmath231 for fixed @xmath215 $ ] satisfies the conditions of proposition  [ propnumericalstable ] .",
    "let the matrices @xmath232 be defined by @xmath233    a_{++ } & = & \\biggl\\ { 1_{i = j } n { \\mathrm{e}}^{-(b - a ) \\eta_i^+ }    + 1_{i \\neq j } \\frac{{\\mathrm{e}}^{-(b - a ) \\eta_i^+ } - { \\mathrm{e}}^{-(b - a )    \\eta_j^+}}{\\delta ( -\\eta_i^+ + \\eta_j^+ ) }    \\biggr\\}_{i , j=1,\\ldots , k } , \\\\[-2pt ]    a_{-+ } & = & \\biggl\\ { \\frac{1 - { \\mathrm{e}}^{(b - a)(\\eta_i^- -    \\eta_j^+)}}{\\delta ( -\\eta_i^- + \\eta_j^+ ) }    \\biggr\\}_{i , j=1,\\ldots , k } , \\\\[-2pt ]    a_{+- } & = & \\biggl\\ { \\frac{1 - { \\mathrm{e}}^{-(b - a)(\\eta_i^+ -    \\eta_j^-)}}{\\delta ( \\eta_i^+ - \\eta_j^- ) }    \\biggr\\}_{i , j=1,\\ldots , k},\\end{aligned}\\ ] ] and let the matrix @xmath234 be defined by @xmath235 denoting by @xmath236 the leading coefficient of @xmath42 , then the integral @xmath237 equals the sum of the following 8 terms : @xmath238    since the characteristic polynomial has distinct roots @xmath239 , the jordan canonical form of the companion matrix is diagonal , and equation ( [ eqgreen ] ) implies that @xmath240 equals @xmath241 & & \\quad { } - \\alpha_{2k}^{-1 } \\bar{v}_1 j^\\mu \\exp(t j ) h^{-1 } \\bar{f}_b w \\exp(b j ) \\biggl \\ { \\int_t^b { \\mathrm{e}}^{-s \\eta_i } { \\mathscr{e}}_z(s)\\ , { \\mathrm{d}}s \\cdot   ( w^{-1 } v_2   ) _ i   \\biggr\\}_{i=1,\\ldots,2k}.\\end{aligned}\\ ] ] since the function @xmath94 is piecewise linear , the above integrals can be explicitly evaluated over the intervals @xmath242 $ ] . for @xmath243 , we have @xmath244    \\int_{t_n}^b { \\mathrm{e}}^{-s \\eta_i } { \\mathscr{e}}_z(s)\\ , { \\mathrm{d}}s & = & { \\mathrm{e}}^{-t_n    \\eta_i } \\frac{1-\\exp(-\\delta \\eta_i / 2)}{\\eta_i } z_n,\\end{aligned}\\ ] ] and for @xmath245 , we have @xmath246 & & \\quad = \\int_0^\\delta { \\mathrm{e}}^{-t_j \\eta_i - \\eta_i s }     \\bigl (   ( 1-s\\delta^{-1 } ) z_j + s \\delta^{-1 } z_{j+1 }   \\bigr)\\ ,    { \\mathrm{d}}s \\\\[-2pt ] & & \\quad = { \\mathrm{e}}^{-t_j \\eta_i } \\int_0^\\delta { \\mathrm{e}}^{-\\eta_i s } ( 1-\\delta^{-1 } s)\\ , { \\mathrm{d}}s   z_j + { \\mathrm{e}}^{-t_j \\eta_i } \\int_0^\\delta { \\mathrm{e}}^{-\\eta_i s }   \\delta^{-1 }",
    "s\\ , { \\mathrm{d}}s   z_{j+1 } \\\\[-2pt ] & & \\quad = { \\mathrm{e}}^{-t_j \\eta_i } \\frac{\\exp(-\\delta \\eta_i ) - 1 + \\delta    \\eta_i}{\\delta ( \\eta_i)^2 } z_j + { \\mathrm{e}}^{-t_j \\eta_i } \\frac{1 - ( 1 + \\delta",
    "\\eta_i ) \\exp(-\\delta    \\eta_i)}{\\delta ( \\eta_i)^2 } z_{j+1}.\\end{aligned}\\ ] ] arranging the eigenvalues as @xmath247 and inserting the definition of @xmath248 , @xmath249 , @xmath250 , @xmath251 , @xmath252 , @xmath253 , we have that @xmath254 equals @xmath255 & & \\quad { } + \\sum_{j=1}^n \\alpha_{2k}^{-1 } \\bar{v}_1 j^\\mu { \\mathrm{e}}^{t_n j } h^{-1 }    \\bar{f}_a w { \\mathrm{e}}^{(a - t_{j-1 } ) j } \\pmatrix { v_- \\odot ( 1_{j=1 }    { \\mathrm{e}}^{-\\delta j_-/2 } \\xi_- + 1_{j > 1 } { \\mathrm{e}}^{-\\delta j_- } \\xi_-^1 )",
    "\\cr    v_+ \\odot ( 1_{j=1 } \\xi_+ + 1_{j > 1 } \\xi_+^1 ) } z_j \\\\[-2pt ] & &   \\quad    { } - \\sum_{j = n}^n \\alpha_{2k}^{-1 } \\bar{v}_1 j^\\mu { \\mathrm{e}}^{t_n j } h^{-1 }    \\bar{f}_b w { \\mathrm{e}}^{(b - t_j ) j } \\pmatrix { v_- \\odot ( 1_{j < n }    { \\mathrm{e}}^{-\\delta j_- } \\xi_-^0 + 1_{j = n } { \\mathrm{e}}^{-\\delta j_-/2 } \\xi_- ) \\cr v_+    \\odot ( 1_{j < n } \\xi_+^0 + 1_{j = n } \\xi_+ ) } z_j \\\\[-2pt ] & & \\quad     { } - 1_{n < n } \\sum_{j = n+1}^n \\alpha_{2k}^{-1 } \\bar{v}_1 j^\\mu { \\mathrm{e}}^{t_n j }    h^{-1 } \\bar{f}_b w   { \\mathrm{e}}^{(b - t_{j-1 } ) j } \\pmatrix { v_- \\odot    { \\mathrm{e}}^{-\\delta j_- } \\xi_-^1 \\cr v_+ \\odot \\xi_+^1 } z_j.\\end{aligned}\\ ] ] the exponential factors on the terms @xmath248 , @xmath250 , @xmath252 may be assimilated in the exponential factors before the large parenthesis using @xmath256 for @xmath74 and @xmath257 .",
    "thereafter the terms in these sums are of the same type as in equation ( [ eqgreennum5 ] ) with @xmath221 , @xmath222 replaced by @xmath258 , @xmath259 etc . , and the formula for @xmath260 follows by invoking the same reformulations as used in the proof of proposition  [ propnumericalstable ] .    finally , we consider the green s function @xmath169 for @xmath261 .",
    "the differential operator @xmath150 has leading coefficient @xmath262 , and inserting @xmath263 in the first part of equation ( [ eqgreennum1 ] ) , we find that @xmath264 equals @xmath265   & \\displaystyle \\bigl ( i_{k \\times k } - { \\mathrm{e}}^{(b - a ) j_- } ( f_a w_-)^{-1 } f_a w_+ { \\mathrm{e}}^{-(b - a ) j_+ } ( f_b w_+)^{-1 } f_b w_-   \\bigr)^{-1 } & \\\\[-2pt ] & \\displaystyle \\bigl ( { \\mathrm{e}}^{(b - t ) j_- } v_- + { \\mathrm{e}}^{(b - a ) j_- } ( f_a w_-)^{-1 }",
    "f_a w_+    { \\mathrm{e}}^{-(t - a ) j_+ } v_+   \\bigr).&\\end{aligned}\\ ] ] to remove the possibly exploding exponential factor @xmath266 in the first factor , we invoke the matrix formula @xmath267 on the second factor and rearranging the exponential factors .",
    "doing this @xmath264 is rewritten as the numerically stable expression @xmath268   & \\displaystyle \\bigl ( v_- + { \\mathrm{e}}^{(t - a ) j_- } ( f_a w_-)^{-1 } f_a w_+ { \\mathrm{e}}^{-(t - a ) j_+ } v_+     \\bigr ) & \\\\[-2pt ] & \\displaystyle { } + \\delta^{-1 } \\tau^{-1 }   \\bigl ( v_1 { \\mathrm{e}}^{(t - a ) j_- } - v_1    { \\mathrm{e}}^{-(b - t ) j_+ } ( f_b w_+)^{-1 } f_b w_- { \\mathrm{e}}^{(b - a ) j_- }   \\bigr ) & \\\\[-2pt ] & \\displaystyle ( f_a w_-)^{-1 } f_a w_+ { \\mathrm{e}}^{-(b - a ) j_+ } ( f_b w_+)^{-1 } f_b w_- & \\\\[-2pt ] & \\displaystyle\\bigl ( i_{k \\times k } - { \\mathrm{e}}^{(b - a ) j_- } ( f_a w_-)^{-1 } f_a w_+   { \\mathrm{e}}^{-(b - a ) j_+ } ( f_b w_+)^{-1 } f_b w_-   \\bigr)^{-1 } & \\\\[-2pt ] & \\displaystyle \\bigl ( { \\mathrm{e}}^{(b - t ) j_- } v_- + { \\mathrm{e}}^{(b - a ) j_- } ( f_a w_-)^{-1 } f_a w_+    { \\mathrm{e}}^{-(t - a ) j_+ } v_+   \\bigr).&\\end{aligned}\\ ] ] this expression is expanded into the sum of 8 terms , which all may be explicitly integrated over the interval @xmath86 $ ] .",
    "for instance is the integral over the second term given by @xmath269 which equals @xmath270 .",
    "the predictors @xmath271 $ ] may be seen as the predictors @xmath272 $ ] for the functional parameters @xmath31 evaluated at the sample points @xmath229 .",
    "the formulae stated in theorem  [ thmfda ] may be extended to functional representations for @xmath272 $ ] .",
    "doing this the predictions between sample points will be given as linear combinations of exponential functions .",
    "if the kernel @xmath51 is constant , say @xmath273 , then the operator approximation @xmath274 gives the exact log determinant of @xmath275 .",
    "the particular construction of the embedding operator @xmath94 was chosen to achieve this property .    a fundamental difference between our operator methods and the smoothing spline technology lies in our dependence on boundary conditions .",
    "whether boundary conditions are desirable in statistical modeling depends on the data situation at hand .",
    "if we have additional knowledge implying particular boundary conditions , then this may be used in the statistical model . however , in many data situations such additional knowledge is not available , and the requirement to specify boundary conditions may be disturbing . here",
    "our advice is to use neumann - type conditions .",
    "although the covariance function @xmath51 is not defined for neumann conditions as noted in the following example , this is possible due to the regularization induced by the measurement noise ; that is , @xmath276 is non - singular by construction .",
    "[ exambrownian ] for @xmath277 we have @xmath278 .",
    "consider the following two sets of boundary conditions : @xmath279 we have @xmath280 with @xmath281 thus , the laplace operator with boundary conditions ( b1 ) leads to the brownian motion , and the laplace operator with boundary conditions ( b2 ) leads to the brownian bridge . the laplace operator with neumann boundary conditions",
    "@xmath282 is not positive definite .",
    "even so , this operator can be used in a statistical model , where it implies an improper prior for the serially correlated effects in terms of a brownian motion with a free level .    to compute the approximative log likelihood we find the green s function @xmath145 for @xmath283 . in case of the brownian , motion equation ( [ eqgreennum1 ] )",
    "gives in case of the brownian bridge , equation ( [ eqgreennum1 ] ) gives in both cases the double integrals @xmath284 can be computed giving explicit formulae for the operator approximation of the matrix determinants . in case of an equidistantly sampled brownian motion",
    ", we have @xmath285 and in case of an equidistantly sampled brownian bridge , we have @xmath286",
    "in this section we combine the matrix formulae listed in section  [ secinference ] with the operator approximation developed in section  [ secmath ] .",
    "the obstacle in the matrix computations is the inversion of the matrix @xmath287 . here",
    "@xmath288 is defined via a discretization @xmath87 and the green s function @xmath289 for a differential operator @xmath290 .",
    "the maximum likelihood estimator and the blups given in equations ( [ eqmle ] ) and ( [ eqblup ] ) are approximated using the block structure @xmath291 , the identity @xmath292 for @xmath95 and the approximation @xmath293 note that this approximation is applied both on the individual sample vectors @xmath294 and on the sections of the columns of the design matrices @xmath295 and @xmath296 .",
    "the approximation of the logarithmic determinant equation ( [ eqlogdet ] ) in the restricted likelihood equation ( [ eqnlogrelikelihood ] ) has already been stated in equation ( [ eqapprox2 ] ) , and the quadratic form of the serially correlated effects is approximated by @xmath297^\\top r^{-1 } { \\mathrm{e}}[x \\vert y ] \\approx    \\sum_{m=1}^m \\sum_{n=1}^n { \\mathrm{e}}[x_m(t_n ) \\vert y]^\\top    { \\mathscr{m}}_{\\mathcal{t}}^{-1 } { \\mathscr{l}}{\\mathrm{e}}[x_m(t_n ) \\vert y].\\ ] ] furthermore , for an equidistant discretization with mesh length @xmath148 , we have @xmath297^\\top r^{-1 } { \\mathrm{e}}[x \\vert y ] \\approx \\delta    \\sum_{l=1}^l \\sum_{m=1}^m \\sum_{n=1}^n   ( { \\mathscr{k}}_l { \\mathrm{e}}[x_m(t_n ) \\vert y ]     ) ^\\top   ( { \\mathscr{k}}_l { \\mathrm{e}}[x_m(t_n ) \\vert y ]   ) .\\ ] ]    if the discretization @xmath106 is equidistant , then semi - explicit and numerically stable formulae for the above approximations are given in section  [ secexplicit ] .",
    "for general discretizations the operator approximations may be found as numerical solutions to ordinary differential equations ; for example , the function @xmath298 obeys to the differential equation @xmath299 .",
    "i am grateful to ib skovgaard and anders tolver for encouragement during the development of this work ."
  ],
  "abstract_text": [
    "<S> functional data analysis in a mixed - effects model framework is done using operator calculus . in this approach </S>",
    "<S> the functional parameters are treated as serially correlated effects giving an alternative to the penalized likelihood approach , where the functional parameters are treated as fixed effects . </S>",
    "<S> operator approximations for the necessary matrix computations are proposed , and semi - explicit and numerically stable formulae of linear computational complexity are derived for likelihood analysis . </S>",
    "<S> the operator approach renders the usage of a functional basis unnecessary and clarifies the role of the boundary conditions . </S>"
  ]
}