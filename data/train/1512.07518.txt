{
  "article_text": [
    "the aim of this paper is to study discrete analogues of operators of radon type . a wide class of interesting questions at the interface of harmonic analysis ,",
    "number theory and ergodic theory that arise when discrete averaging operators or singular integrals modeled on polynomial mappings are studied .",
    "the approach undertaken in this paper has the merit of unifying results of two major streams of the theory , the bourgain maximal theorems , and the theorem of ionescu ",
    "wainger for singular radon transforms .",
    "in particular , we obtain analogous results for the maximal truncated singular radon transforms , and for both not only in the scalar - valued case but also in a vector - valued version .    to begin , assume that @xmath2 is a caldern  zygmund kernel satisfying the differential inequality @xmath3 for all @xmath4 with @xmath5 and the cancellation condition @xmath6 let @xmath7 be a polynomial mapping where for each @xmath8 the function @xmath9 is an integer - valued polynomial of @xmath10 variables with @xmath11 .",
    "we are interested in discrete truncated singular radon transforms @xmath12 defined for a finitely supported function @xmath13 , where @xmath14 .",
    "our starting was the proof of the following theorem .",
    "[ thm:0 ] for every @xmath15 there is @xmath16 such that for all @xmath17 @xmath18 moreover , the constant @xmath19 is independent of the coefficients of the polynomial mapping @xmath20 .",
    "theorem [ thm:0 ] generalizes recent result of ionescu and wainger @xcite , where it was proven that the discrete singular radon transform @xmath21 is bounded on @xmath22 for any @xmath1 .",
    "once this theorem was proved , it became clear that the approach used gave a different proof of the bourgain theorem , and ultimately the vector - valued versions given in theorems b and c below .",
    "the bourgain - type theorems deal with the radon averaging operators @xmath23 defined for any finitely supported function @xmath24 , where @xmath25 .",
    "bourgain , being motivated by some questions in the pointwise ergodic theory , studied intensively the maximal radon transforms associated with @xmath26 .",
    "specifically , in @xcite it was proven , in one dimensional case with @xmath27 , that @xmath28 is bounded on @xmath29 for any @xmath30 . for higher dimensional cases with general @xmath31 and @xmath32 we refer to @xcite , quasi - invariant analogues of , with polynomials of degree at most two ,",
    "were also considered in @xcite .",
    "we extend bourgain s celebrated theorems from @xcite , @xcite and @xcite and provide some vector - valued estimates for the sequence @xmath33 .",
    "let @xmath34 the main results of this article will be theorem [ thm:10 ] and theorem [ thm:11 ] .",
    "[ thm:10 ] for every @xmath15 there is @xmath35 such that for all @xmath36 @xmath37 moreover , the constant @xmath19 is independent of the coefficients of the polynomial mapping @xmath20 .",
    "in fact theorem [ thm:0 ] will be a corollary of the following vector - valued estimates .",
    "[ thm:11 ] for every @xmath15 there is @xmath35 such that for all @xmath36 @xmath38 moreover , the constant @xmath19 is independent of the coefficients of the polynomial mapping @xmath20 .",
    "the @xmath39-variation versions of these theorems will be the subject of the second paper of this series @xcite .",
    "we next want to highlight three main tools that are used :    a.   a variant of a key idea of ionescu ",
    "wainger @xcite : a suitable @xmath40 estimate for projection operators which are made up of sums corresponding to fractions @xmath41 whose denominators @xmath42 have appropriate limitation in terms of their prime power factorization ( see and inequality below as well as theorem [ th:3 ] ) . b.   a maximal estimate in terms of  dyadic \" sub - blocks ( see ) .",
    "it is a consequence of a numerical maximal estimate ( see lemma [ lem:6 ] ) , which in turn is an outgrowth of the idea implicit in the proof of the classical rademacher ",
    "menshov theorem ( see @xcite ) .",
    "c.   a refinement of the estimates for multi - dimensional weyl sums in @xcite , where the previous limitations @xmath43 are replaced by the weaker restrictions @xmath44 for suitable @xmath45    the proof of theorem [ thm:10 ] and theorem [ thm:11 ] will be based on analysis of the fourier multipliers corresponding to operators @xmath46 and @xmath47 respectively . in order to describe the key points of our approach",
    "let us focus our attention on @xmath48 which is the multiplier associated with @xmath46 , i.e. @xmath49 . assume , for simplicity , that we are in the scalar case , furthermore , @xmath50 and our polynomial mapping is a moment curve @xmath51 for some @xmath52 .",
    "as in the previous papers in the subject we will employ the circle method of hardy and littlewood .",
    "these techniques will be used implicitly in analysis of relevant partition of unity which allows us to distinguish between asymptotic or highly oscillatory behaviour of @xmath48 . in the asymptotic part one",
    "approximates the multiplier by sums corresponding to the continuous analogue , multiplied by gauss sums .",
    "the highly oscillatory part is controlled by weyl sums .",
    "in particular , let @xmath53 be a smooth cut - off function with a small support , fix @xmath54 and define for each @xmath55 the following projections @xmath56 where @xmath57 is a diagonal @xmath58 matrix with positive entries @xmath59 such that @xmath60 and @xmath61 for some family @xmath62 such that @xmath63 , we refer to section [ sec:6 ] for detailed constructions .",
    "the projections @xmath64 will play an essential role in our further studies of @xmath48 . on the one hand , following the ideas of ionescu and wainger @xcite , we will be able to prove that for every @xmath1 there is a constant @xmath65 such that @xmath66 on the other hand , @xmath67 localizes asymptotic behaviour of @xmath68 , whereas @xmath69 corresponds to the highly oscillatory part .",
    "the last piece in view of a variant of weyl s inequality with logarithmic decay , see theorem [ thm:3 ] , can be nicely controlled giving @xmath70 the first part requires more sophisticated investigations .",
    "namely , for every @xmath71 @xmath72 where @xmath73 is the gaussian sum and @xmath74 is an integral version of @xmath48 , see at the end of section [ sec:3 ] and the beginning of section [ sec:4 ] respectively for relevant definitions .",
    "this observation allows us to reduce the problem to showing that for each @xmath75 the maximal function associated with the multiplier @xmath76 is bounded on @xmath77 and has a decay given by @xmath78 the last bound is summable in @xmath75 and so if we prove that we will be done .",
    "the idea lying behind the estimates for is based on proving @xmath79 estimates with bound @xmath80 , where @xmath81 is an exponent from the bound for the gaussian sums @xmath82 . for general @xmath83",
    "we obtain much worse bound @xmath84 , but still satisfactory to obtain the desired conclusion from , since @xmath85 can be arbitrary large and interpolation does the job .",
    "technically , in either case ( @xmath79 case theorem [ thm:2 ] or @xmath0 case for @xmath83 theorem [ thm:7 ] and theorem [ thm:8 ] ) this will be achieved by partitioning the supremum in into two pieces @xmath86 and @xmath87 for some integer @xmath88 .",
    "the second case is quite straightforward and follows by appealing to the transference principle described in section [ sec:5 ] , where discrete @xmath89 norm of the maximal function associated with multiplier from is controlled by the continuous @xmath90 norm of a maximal function closely related with the multiplier @xmath74 , which is _ a priori _ bounded on @xmath91 , see theorem [ thm:8 ] .",
    "the first case where the supremum is restricted to @xmath86 is much more challenging , see theorem [ thm:7 ] .",
    "for this purpose we shall apply a simple numerical inequality , see lemma [ lem:6 ] , which ensures @xmath92 the advantage of application lemma [ lem:6 ] is that the supremum norm is controlled by a sum of square functions which is more convenient to deal with .",
    "following now the ideas of ionescu and wainger @xcite via khintchine s inequality we will be able to show that @xmath0 norm of the inner square function on the right - hand side in is bounded by @xmath93 for each @xmath94 .",
    "finally there are @xmath95 elements thus the left hand side of with the supremum restricted to @xmath96 is bounded by @xmath97 for all @xmath1 and we are done . loosely speaking this illustrates a general scheme which lies behind the proofs of all theorems in this paper .",
    "one of the most important aspects of this approach is that it allows us to treat with maximal functions associated with operators with signs and we can do it , unlike the previous approaches , in a fairly unified way .",
    "we describe now more precisely the outline of this paper and ingredients in the proofs of theorem [ thm:10 ] and theorem [ thm:11 ] . in section [ sec:2 ]",
    "we introduce a lifting procedure ( see lemma [ lem:1 ] ) which allows us to replace any polynomial mapping @xmath20 by the canonical polynomial mapping @xmath98 which has all coefficients equal to 1 . as a result our bounds will be independent of coefficients of the underlying polynomial mapping .",
    "the rest of this section is devoted to proving lemma [ lem:6 ] which is critical in bounding the supremum norm by square functions , as we have seen in .",
    "in @xcite it has been recently shown that lemma [ lem:6 ] can be treated as a counterpart or replacement of bourgain s logarithmic lemma ( * ? ? ?",
    "* lemma 4.1 , page 17 ) , which was essential tool in analysis of maximal functions corresponding to radon averages .",
    "although logarithmic lemma found many applications in harmonic analysis , especially in the time - frequency analysis , in the discrete harmonic analysis turned out to be limited to averaging operators .",
    "fortunately , lemma [ lem:6 ] is more flexible and permits to circumvent all difficulties while operators with signs are considered .",
    "it is worth emphasizing that lemma [ lem:6 ] is an invaluable ingredient allowing for the unification in the discrete analogues of operators of radon type .    in section [ sec:3 ]",
    "we present the variant of multidimensional weyl s sum estimates with logarithmic decay , see theorem [ thm:3 ] .",
    "it was known that for weyl s sums @xmath99 defined at the beginning of section [ sec:3 ] that @xmath100 for some @xmath81 provided that for at least one coefficient @xmath101 of a phase polynomial @xmath102 there are integers @xmath103 and @xmath42 such that @xmath104 , @xmath105 and @xmath106 for some @xmath107 . in the sequel proceeding as in @xcite we will be able to prove that @xmath108 with arbitrary large @xmath109 provided that @xmath110 for some large @xmath111 .",
    "this logarithmic decay has great importance for our further analysis of multipliers in highly oscillatory regime .",
    "a one dimensional variant of weyl s inequality with logarithmic decay is known in number theory for a long time , see for instance @xcite and the references therein .    in section [ sec:5 ]",
    "we gather some basic tools which allow us to efficiently compare discrete @xmath89 norms with continuous @xmath90 norms .    in section [ sec:6 ]",
    "we prove theorem [ th:3 ] which is a key ingredient in the all steps of our proofs , especially in the proof of boundedness .",
    "this theorem was proven by ionescu and wainger in @xcite with @xmath112 loss where @xmath113 is a large power .",
    "this is a deep result which uses the most sophisticated tools developed to date in the area of discrete analogues in harmonic analysis .",
    "the main new idea of ionescu and wainger uses diophantine approximation of the coefficients of the underlying polynomial like in the circle method , but unlike previous arguments , the authors exploit strongly their strong almost orthogonality properties . here",
    "we improve their result and show that @xmath114 is sufficient . moreover @xmath115 loss is sharp for the method of proof which will be used .",
    "we also present a slightly different approach , based on properties of some square functions , see , lemma [ lem:13 ] and lemma [ lem:14 ] , which explains the nature of strong orthogonality properties between distinct rational fractions .",
    "sections [ sec:4 ] and section [ sec:7 ] complete the proofs of theorems [ thm:10 ] and [ thm:11 ] respectively . to understand more quickly",
    "the structure of the proofs , the reader may begin by looking at sections [ sec:4 ] and [ sec:7 ] first .",
    "these sections can be read independently , assuming the results in the previous sections .    in the appendix [ sec:8 ] , which is",
    "self - contained , we collect vector - valued estimates for the maximal functions of radon type in the continuous settings .",
    "the proofs of theorem [ thm:17 ] and theorem [ thm:18 ] can be found in @xcite .",
    "however , we provided short proofs of these results and for the convenience of the reader we present the details .    finally , let us comment that theorem [ thm:0 ] also finds its applications in pointwise ergodic theory .",
    "namely , let @xmath116 be a @xmath117-finite measure space with a family of invertible commuting and measure preserving transformations @xmath118 .",
    "let @xmath119 where @xmath120 . here instead of condition we need somewhat stronger condition @xmath121 for every @xmath122 , where @xmath123 is the euclidean ball in @xmath124 with radius @xmath125 centered at the origin .",
    "then we can establish the following    [ thm:1 ] assume that @xmath15 .",
    "for every @xmath126 there exists @xmath127 such that @xmath128 @xmath129-almost everywhere on @xmath130 .",
    "theorem [ thm:1 ] can be treated as an extension of cotlar s ergodic theorem @xcite .",
    "the proof of theorem [ thm:1 ] follows in view of the caldern transference principle from theorem [ thm:0 ] and estimates of oscillation inequality on @xmath131 for @xmath132 .",
    "however we will not present the details , since we are going to provide much more general @xmath39-variational estimates for @xmath133 and @xmath134 in @xcite , and then the pointwise convergence will immediately follow .",
    "there is also an ongoing project to obtain theorems [ thm:0 ] , [ thm:10 ] and [ thm:11 ] for discrete operatos of radon type modeled on thin subsets of integers , for example prime numbers .      throughout the whole article ,",
    "unless otherwise stated , we will write @xmath135 ( @xmath136 ) if there is an absolute constant @xmath137 such that @xmath138 ( @xmath139 ) . moreover , @xmath140 will stand for a large positive constant whose value may vary from occurrence to occurrence .",
    "if @xmath135 and @xmath141 hold simultaneously then we will write @xmath142",
    ". we will also write @xmath143 ( @xmath144 ) to indicate that the constant @xmath137 depends on some @xmath145 .",
    "let @xmath146 .",
    "for @xmath147 we set @xmath148 for a vector @xmath149 we will use the following norms @xmath150 if @xmath151 is a multi - index from @xmath152 then @xmath153 .",
    "although we use @xmath154 for the length of a multi - index @xmath155 and the euclidean norm of @xmath156 , their meaning will be always clear from the context and it will cause no confusions in the sequel . finally , let @xmath157 denote the set of dyadic numbers .",
    "the authors thank the hausdorff research institute for mathematics in bonn for hospitality during the trimester program `` harmonic analysis and partial differential equations '' in 2014 .",
    "we thank wojtek samotij for explaining a probabilistic argument which simplified the proof of lemma [ lem:31 ] .",
    "let @xmath158 be a polynomial mapping whose components @xmath159 are integer valued polynomials on @xmath160 such that @xmath11 .",
    "we set @xmath161 it is convenient to work with the set @xmath162 with the lexicographic order .",
    "then each @xmath159 can be expressed as @xmath163 for some @xmath164 .",
    "let us denote by @xmath165 the cardinality of the set @xmath166 .",
    "we identify @xmath91 with the space of all vectors whose coordinates are labeled by multi - indices @xmath167 .",
    "let @xmath168 be a diagonal @xmath169 matrix such that @xmath170 for @xmath171 we set @xmath172 i.e. @xmath173 for every @xmath156 .",
    "next , we introduce the _ canonical _ polynomial mapping @xmath174 where @xmath175 and @xmath176 .",
    "the coefficients @xmath177 define a linear transformation @xmath178 such that @xmath179 .",
    "indeed , it is enough to set @xmath180 for each @xmath181 and @xmath182 .",
    "let @xmath183 denote a seminorm defined on sequences of complex numbers , i.e. a non - negative function such that for any two sequences @xmath184 and @xmath185 where @xmath186 satisfies @xmath187 and for any @xmath188 @xmath189 moreover , we assume that @xmath190 and for any @xmath191 we have @xmath192 for the future reference the tools presented in this and further sections are stated and proved in higher generality than needed . for the first reading one may think that @xmath193 let @xmath194 be a measurable space and fix @xmath195 and @xmath196 $ ] .",
    "we say that a sequence of complex - valued functions @xmath197 if @xmath198 with obvious modifications when @xmath199 or @xmath200 .",
    "we will write @xmath201 when @xmath202 and @xmath203 when @xmath204 . in our case @xmath194",
    "will be usually @xmath91 with the lebesgue measure or @xmath205 with the counting measure .",
    "the next lemma , inspired by the continuous analogue ( see @xcite or ( * ? ? ?",
    "* section 11 ) ) reduces the proof of theorem [ thm:0 ] to the canonical polynomial mapping .",
    "[ lem:1 ] let @xmath206 be one of the operators @xmath133 or @xmath134 .",
    "suppose that for some @xmath207 $ ] there is a constant @xmath208 such that @xmath209 then @xmath210    let @xmath211 and @xmath212 be fixed .",
    "let @xmath17 . in the proof we let @xmath213 , @xmath214 and @xmath215 .",
    "for any @xmath213 we define a function @xmath216 on @xmath205 by @xmath217 if @xmath218 and @xmath219 then @xmath220 .",
    "therefore for each @xmath213 @xmath221 where @xmath222^k}}}}(y ) & \\text { if } r_n^{\\mathcal{p}}=m_n^{\\mathcal{p } } , \\\\              { { \\mathds{1}_{{[-n , n]^k\\setminus\\{0\\}}}}}(y)k(y ) & \\text { if } r_n^{\\mathcal{p}}=t_n^{\\mathcal{p}}.          \\end{cases}\\ ] ] hence , @xmath223\\big)^r\\big)^{1/r }          \\big\\rvert_{\\ell^p({\\mathbb{z}}^{d_0})}^p \\\\          & \\qquad\\qquad =          \\frac{1}{(2m+1)^{d } }          \\sum_{x \\in { \\mathbb{z}}^{d_0 } }          \\sum_{{{\\left\\lvert u \\right\\rvert}}_\\infty \\leq m } \\big(\\sum_{t\\in\\mathcal z }          \\mathcal n\\big(r_n^{\\mathcal{p}}f_t(x+lu ) : n \\in [ 1 , \\lambda]\\big)^r\\big)^{p / r}\\\\          & \\qquad \\qquad=          \\frac{1}{(2m+1)^{d } }          \\sum_{x \\in { \\mathbb{z}}^{d_0 } }          \\sum_{{{\\left\\lvert u \\right\\rvert}}_\\infty \\leq m } \\big(\\sum_{t\\in\\mathcal z }          \\mathcal n\\big(r_n^{\\mathcal{q}}f^x_t(u ) : n \\in [ 1 , \\lambda]\\big)^r\\big)^{p / r}\\\\          & \\qquad \\qquad \\leq          \\frac{c^p}{(2m+1)^d }          \\sum_{x \\in { \\mathbb{z}}^{d_0 } }          \\sum_{u \\in { \\mathbb{z}}^d}\\big(\\sum_{t\\in\\mathcal z }           |f^x_t(u)|^r\\big)^{p / r }      \\end{aligned}\\ ] ] where in the last inequality we have used .",
    "since @xmath224 we get @xmath225\\big)^r\\big)^{1/r }          \\big\\rvert_{\\ell^p({\\mathbb{z}}^{d_0})}^p\\leq      c^p      \\bigg(1 + \\frac{\\lambda^{kn_0}}{m}\\bigg)^d      \\big\\|\\big(\\sum_{t\\in\\mathcal z}|f_t|^r\\big)^{1/r}\\big\\|_{\\ell^p({\\mathbb{z}}^{d_0})}^p.\\ ] ] taking @xmath226 approaching infinity we conclude @xmath227\\big)^r\\big)^{1/r }      \\big\\rvert_{\\ell^p({\\mathbb{z}}^{d_0})}^p      \\leq      c^p      \\big\\|\\big(\\sum_{t\\in\\mathcal z}|f_t|^r\\big)^{1/r}\\big\\|_{\\ell^p({\\mathbb{z}}^{d_0})}^p\\ ] ] which by monotone convergence theorem implies .",
    "in the rest of the article by @xmath228 or @xmath229 we denote the operator defined for the canonical polynomial mapping @xmath98 , i.e. @xmath230 and @xmath231 .",
    "we finish this section with the following simple observation which will be essential in the sequel .",
    "[ lem:6 ] for any sequence @xmath232 of complex numbers we have @xmath233 for any @xmath234 .",
    "we claim that any interval @xmath235 for @xmath236 such that @xmath237 , is a finite disjoint union of dyadic subintervals , i.e. intervals belonging to some @xmath238 for @xmath239 where @xmath240 and such that each length appears at most twice . for the proof",
    ", we set @xmath241 .",
    "having chosen @xmath242 we select @xmath243 in such a way that @xmath244 is the longest dyadic interval starting at @xmath242 and contained inside @xmath245 .",
    "if the lengths of the selected dyadic intervals increase then we are done .",
    "otherwise , there is @xmath246 such that @xmath247 .",
    "we show that this implies @xmath248 .",
    "suppose for a contradiction that , @xmath249 . then @xmath250 therefore , it is enough to show that @xmath251 divides @xmath243 .",
    "it is clear in the case when @xmath252 .",
    "if @xmath253 then , by maximality of @xmath244 , @xmath251 can not divide @xmath242 , thus divides @xmath243 .",
    "let us fix @xmath234 .",
    "if @xmath254 we may write @xmath255 for some @xmath256 and where each interval @xmath257 is dyadic .",
    "then @xmath258 we notice that the inner sum contains at most two terms .",
    "hence , @xmath259 which is bounded by the right - hand side of .",
    "similar argument covers the case when @xmath260 belongs to @xmath261 .",
    "let @xmath102 be a polynomial in @xmath124 of degree @xmath262 such that @xmath263 given @xmath264 , let @xmath265 be a convex set such that @xmath266 for some @xmath267 and @xmath268 , where @xmath269 .",
    "we define @xmath270 the function @xmath271 is assumed to be a @xmath272 function which for some @xmath137 satisfies @xmath273 assume that there is a multi - index @xmath274 such that @xmath275 and @xmath276 for some integers @xmath277 such that @xmath278 and @xmath279 .",
    "then for any @xmath109 there is @xmath280 so that , for any @xmath281 , if @xmath282 then there is a constant @xmath137 @xmath283 the implied constant @xmath284 is independent of @xmath285 .    we need the following .    [ prop:201 ] fix @xmath286 .",
    "suppose that @xmath287 is a convex set contained in a ball with radius @xmath288 . if @xmath289 , then the number of lattice points @xmath290 in @xmath291 of distance @xmath292 from the boundary of @xmath291 is @xmath293 .",
    "if we additionally assume that @xmath294 contains a ball @xmath295 for some @xmath296 and @xmath297 , then the number of lattice points @xmath290 in @xmath291 of distance @xmath292 from the boundary of @xmath291 is @xmath298 if @xmath299 .    if @xmath300 , then there is nothing to do since by davenport s result @xcite we know that @xmath301 where @xmath302 is the volume of @xmath291 .",
    "assume that @xmath303 .",
    "then by a simple integration argument for each @xmath304 there is a segment @xmath305 in direction @xmath306 , and @xmath307 .",
    "thus there is a ball @xmath308 with radius @xmath309 for some @xmath297 contained in the convex set @xmath310 generated by all segments @xmath311 with @xmath312 being the barycenter of @xmath310 .",
    "since the number of lattice points is invariant under translations we may assume that @xmath313 .",
    "observe that @xmath314 .",
    "for any @xmath315 , let @xmath316 so that @xmath317 with some @xmath318 .",
    "if @xmath319 is the convex set generated by @xmath320 and @xmath321 , then the angle of the aperture at the vertex @xmath320 is @xmath322 , with some @xmath323 uniformly for @xmath315 .",
    "then there exists @xmath324 such that for all @xmath315 we get @xmath325    define @xmath326 and observe that for every @xmath327 we have @xmath328 which is equivalent to @xmath329 since @xmath330 and @xmath331 so @xmath332    suppose now that @xmath333 for some @xmath334 and @xmath297 . again without of loss of generality we may assume that @xmath313 , and @xmath295 and @xmath291 are not tangent at any point , otherwise it suffices to take @xmath335 instead of @xmath336 .",
    "if @xmath319 is the convex set generated by @xmath320 and @xmath337 , then the angle of the aperture at the vertex @xmath320 is @xmath322 , with some @xmath338 uniformly for @xmath315 .",
    "then there exists @xmath324 such that for all @xmath315 we get @xmath339 define @xmath340 and observe that for every @xmath327 we have @xmath341 thus @xmath342 and arguing in a similar way as above we obtain @xmath343 the proof of proposition [ prop:201 ] is completed .",
    "this proposition is needed as a replacement for ( * ? ? ?",
    "* proposition 9 ) , since the latter proposition contains an error .",
    "while the present version is weaker than the one in @xcite , it is sufficiently strong for our purposes , and also to establish the weyl sum estimates in @xcite .",
    "@xmath344 will be constants that appear below .",
    "their value will be adjusted several times , ( but finitely many times ) depending on the backward induction we use .",
    "the constants @xmath345 , and the constants implicit in the @xmath346 notation , may depend on @xmath347 , @xmath348 , the dimension @xmath10 , the degree @xmath165 of the polynomial @xmath102 , but are independent of @xmath285 .",
    "also sometimes we shall have the weaker hypothesis @xmath349 with @xmath350 instead of .",
    "this can be reduced to by taking @xmath351 , and using with @xmath352 instead . since @xmath353 except for finitely many @xmath285 , and for those finitely many @xmath285 ,",
    "the result is subsumed if the constant @xmath284 in is taken sufficiently large .",
    "now the proof will proceed in four steps .",
    "* step 1 . *",
    "suppose @xmath354 , @xmath355 and @xmath356 .",
    "we are reduced to proving that @xmath357 for all @xmath358 , where @xmath359 there are two cases @xmath360 and @xmath361 .",
    "the short sums are trivial because then @xmath362 it suffices to consider @xmath361 .",
    "the desired bound in the second case follows by applying the weyl estimates with logarithmic loss ( see ( * ? ? ?",
    "* remark after theorem 1.5 ) ) .",
    "namely , if @xmath363 for some integers @xmath277 such that @xmath364 and @xmath104 then there is @xmath137 such that @xmath365 therefore , for any @xmath366 if @xmath367 we can immediately conclude @xmath368 we show next how to pass to a general function @xmath369 satisfying .",
    "indeed , summing by parts we obtain @xmath370 therefore , we apply the conclusion of the special case to @xmath371 , and we are done .",
    "* step 2 . *",
    "we assume that @xmath354 , @xmath372 .",
    "we will argue by the backward induction on @xmath373 .",
    "we consider the case when @xmath374 and assume that the desired bounds hold when @xmath375 and @xmath376 .",
    "the result from step 1 establishes the first step of the backward induction .",
    "we write @xmath377 , and we assume that @xmath378 for some integers @xmath277 such that @xmath379 and @xmath380 , with @xmath381 we want to prove @xmath382 for @xmath383 , if @xmath384 is large enough .",
    "we examine the coefficients @xmath385 in the polynomial @xmath102 and play with the dichotomy of major / minor arcs .",
    "we fix @xmath386 , to be determined later , and apply dirichlet s principle , obtaining @xmath387 , with @xmath388 and @xmath389 , so that @xmath390 for all @xmath376 .",
    "there are two cases :    * _ the minor arc _",
    "case , when for some @xmath376 we have @xmath391 , * _ the major arc _ case , when for all @xmath376 we have @xmath392 .    in the first case",
    "we make the choice of @xmath386 to be so large that the inductive hypothesis applies , giving us the conclusion for the given @xmath383 .    for the case when @xmath392 for all @xmath376 , we need the following lemma .    [ lem:11 ] suppose @xmath393 and @xmath394 .",
    "let @xmath395 be an integer , @xmath396 with @xmath351 .",
    "if @xmath397 then there is @xmath398 so that @xmath399 and @xmath400 with @xmath401 .",
    "let us assume the lemma and see how it completes step 2 .",
    "we will take @xmath402 . write @xmath403 , for each @xmath376 then implies @xmath404 and @xmath405 .",
    "we then decompose @xmath406 modulo @xmath407 , and write @xmath408 , with @xmath409 . thus @xmath410 where @xmath411 , since @xmath412 involves at most @xmath407 terms .",
    "now , @xmath413 hence , @xmath414 thus @xmath415 where @xmath416 with @xmath417 being a polynomial in @xmath418 of order @xmath419 .",
    "we estimate the inner sum in by writing it as @xmath420 with @xmath421 .",
    "we start by bounding @xmath422 .",
    "since @xmath423 by , we obtain @xmath424 to estimate @xmath425 we are going to apply lemma [ lem:11 ] . recall that @xmath386 has been fixed in the minor case , we now set @xmath426 and @xmath427 . since @xmath405 , we have @xmath428 .",
    "let @xmath429 and @xmath430 be determined by @xmath431 as in step 1 , and take @xmath432 then , for @xmath433 we have , @xmath351 and @xmath434 and @xmath435 , thus by lemma [ lem:11 ] , we obtain @xmath436 for some @xmath398 such that @xmath437 and @xmath438 . hence , by step 1 applied to the polynomial @xmath439 , we get @xmath440 therefore , all together @xmath441 since @xmath442 hence , @xmath443 and gives us the desired conclusion .",
    "we now turn to the proof of lemma [ lem:11 ]    we apply dirichlet s theorem to @xmath444 . thus there exists @xmath398 , such that @xmath399 , with @xmath445 and @xmath446 .",
    "we must see that @xmath447 .",
    "there are two cases .",
    "first , @xmath448 , then @xmath449 , and we are done .",
    "second , we suppose @xmath450 . then @xmath451 but @xmath452 , and @xmath453 , so by @xmath454 that is @xmath455 since , @xmath394 , and @xmath396 .",
    "thus @xmath456 this proves the lemma .",
    "* step 3 . *",
    "we assume @xmath457 , @xmath458 and for some @xmath274 such that @xmath459 we have @xmath460 for some @xmath41 with @xmath461 and @xmath462 .",
    "we need the following lemma .",
    "[ lem:16 ] for each @xmath274 such that @xmath459 , there exist @xmath463 linear transformations @xmath464 of @xmath124 that have integer coefficients and determinant 1 ( so that each @xmath465 is an automorphism of @xmath160 ) and integers @xmath466 , with @xmath467 , so that if @xmath468 is the coefficient of @xmath469 of @xmath470 , and @xmath471 is the coefficient of @xmath472 of @xmath473 , then @xmath474 the operators @xmath475 , and integers @xmath476 , depend only on @xmath10 , @xmath165 , and @xmath274 .",
    "moreover , @xmath463 is the dimension of the vector space of polynomials in @xmath124 which are homogeneous of degree @xmath165",
    ".    we shall apply lemma [ lem:16 ] with @xmath477 .",
    "now , for @xmath386 sufficiently large , determined below , apply dirichlet s principle to each @xmath471 to get @xmath387 so that @xmath388 and @xmath478 and @xmath479 , for @xmath480 .",
    "there are two cases .",
    "the first case , the minor case , that is when @xmath481 for at least one @xmath482 . in that case",
    "we write @xmath483 and @xmath484 , @xmath485 and @xmath486 $ ] .",
    "we observe @xmath487 and since @xmath488 we have @xmath489 for some @xmath490 .",
    "next , for each @xmath491 , write @xmath492 where @xmath493 and @xmath494 . then the sum @xmath495 thus it suffices to have @xmath496 with the @xmath346 term independent of @xmath497",
    ". this will give the desired result for , since there are at most @xmath498 terms that appear in the first summation in as @xmath499 .",
    "now , apply step 1 to the one - dimensional polynomial @xmath500 .",
    "observe that @xmath501 .",
    "we choose any @xmath502 as in step 1 and we obtain which leads to the desired result .    the second case , the major case , where @xmath503 for all @xmath504 , will be seen to be empty , where @xmath386 has been fixed and @xmath348 is chosen large enough .    in fact , by lemma [ lem:16 ]",
    "@xmath505 so if we write @xmath506 , with @xmath399 , then @xmath507 , with @xmath508 since @xmath509 for all @xmath510 .",
    "now there are two subcases : @xmath511 and @xmath512 .",
    "the first is not possible , except for finitely many @xmath285 , since @xmath513 and we may take @xmath514 . in the second ,",
    "we write @xmath515 in account of and .",
    "thus @xmath516 since @xmath517 .",
    "thus , it is enough to take @xmath518 to make this impossible , since @xmath519 and @xmath520 .",
    "this concludes step 3 .",
    "* step 4 . *",
    "we assume that @xmath457 and @xmath521 .",
    "this combines ideas of both step 2 and step 3 .",
    "the argument is by backward induction on the degree of @xmath522 .",
    "the result from step 3 establishes the first step of the backward induction for @xmath523 .",
    "assume that theorem [ thm:3 ] holds for all @xmath524 such that @xmath376 .",
    "our aim now is to deduce it holds for @xmath525 .",
    "write @xmath526 , with @xmath527 on @xmath528 we apply lemma [ lem:16 ] and argue as in step 3 .",
    "this gives us an automorphism @xmath529 of @xmath160 , so that if @xmath530 , @xmath531 , @xmath532 , then @xmath533 , where @xmath417 is a polynomial of degree @xmath534 , but of degree @xmath419 in @xmath535 .",
    "also @xmath536 with @xmath537 , @xmath538 as long as @xmath539 where @xmath540 is the dimension of the space of homogeneous polynomials of degree @xmath541 in @xmath124 .",
    "let us emphasize that the parameter @xmath542 in plays the role of @xmath386 from the previous step .",
    "next , we choose @xmath543 whose value will be determined later , and apply dirichlet s principle to all the coefficients @xmath544 of @xmath545 with @xmath546 .",
    "thus we can find @xmath547 , so that @xmath548 with @xmath549 and @xmath550 .",
    "we also set @xmath551 . if @xmath552 , for some @xmath151 such that @xmath553 , then by the induction hypothesis , we obtain provided that @xmath386 is sufficiently large , and we are done .",
    "we fix this @xmath386 .",
    "now let us define @xmath554 where @xmath555 , and @xmath556 and @xmath430 be determined by @xmath431 as in step 1 , and take @xmath557    suppose now that @xmath558 , for all @xmath151 such that @xmath559 .",
    "let @xmath560 .",
    "then @xmath561 . set @xmath562 , then @xmath396 .",
    "next , we choose @xmath563 then @xmath564 and @xmath565 and @xmath566 thus we can we apply lemma [ lem:11 ] to get @xmath398 so that @xmath567 with @xmath399 , @xmath568 .",
    "we break the summation @xmath569 into essentially a sum of disjoint boxes of side - length @xmath570 as follows",
    ". we will write @xmath492 with @xmath493 , @xmath494 .",
    "set @xmath571 so if we write @xmath572 , then @xmath573 the residual set of points @xmath574 are lattice points in @xmath575 whose distance from the boundary of @xmath575 is @xmath576 for any @xmath577 .",
    "hence , by proposition [ prop:201 ] there are @xmath578 such points .",
    "thus that sum contributes @xmath578 which is @xmath579 , for every @xmath580 .",
    "so we are reduced to considering @xmath581 let us fix @xmath582 and @xmath583 , and consider first one - dimensional sum @xmath584 where @xmath585 and @xmath586 and @xmath417 is a polynomial in @xmath587 of degree @xmath419 , depending on @xmath39 and @xmath588 .",
    "now , by summation by parts we get @xmath589 with @xmath590 . but @xmath591 however , @xmath592 by the one - dimensional result applied to @xmath444 , with @xmath593 . by summation by parts",
    "@xmath594 thus when we also sum in @xmath588 and @xmath39 we get that our sum is @xmath595    so by taking into account , and , we need only to take @xmath348 large enough , to make @xmath542 large enough , to then make @xmath596 large enough to get our desired conclusion .",
    "let @xmath597 denote the fourier transform on @xmath91 defined for any function @xmath598 as @xmath599 if @xmath600 we set @xmath601 to simplify the notation we denote by @xmath602 the inverse fourier transform on @xmath91 or the inverse fourier transform on the torus @xmath603 ( fourier coefficients ) , depending on the context .",
    "let @xmath604 be a smooth function such that @xmath605 and @xmath606    [ rem:1 ] we may additionally assume that @xmath53 is a convolution of two non - negative smooth functions @xmath607 and @xmath608 with compact supports contained inside @xmath609 .",
    "let @xmath610 be a sequence of multipliers on @xmath91 with a property that for each @xmath15 there is a constant @xmath611 such that for any @xmath612 @xmath613 where @xmath183 is a seminorm defined for sequences of complex numbers as in section [ sec:2 ] .",
    "our aim is to prove from this its discrete analogue .",
    "see also the discussion of sampling in ( * ? ? ?",
    "* proposition 2.1 and corollary 2.5 ) . throughout this section",
    "we will assume that @xmath614 is a diagonal @xmath58 matrix with positive entries @xmath615 such that @xmath616 for some @xmath617 .",
    "the next two lemmas are multi - dimensional analogues of lemma 1 and lemma 2 from @xcite .",
    "[ lem:5 ] for any @xmath618 and @xmath619 @xmath620 @xmath621 the same result remains true if the euclidean norm @xmath154 is replaced by @xmath622 .",
    "recall that @xmath623 for any @xmath156 .",
    "we only show the inequality since the proof of is almost identical .",
    "let us observe , in view of remark [ rem:1 ] , that @xmath624 where @xmath625 , and @xmath626 .",
    "for @xmath627 we have @xmath628 by cauchy ",
    "schwarz inequality and plancherel s theorem @xmath629 moreover , since @xmath630 @xmath631 and the support of @xmath608 is contained inside @xmath609 we obtain @xmath632 which finishes the proof of since @xmath633 .",
    "let @xmath194 be a measure space and suppose we are given @xmath634 and a family @xmath635 of bounded linear operators @xmath636 .",
    "moreover , for each @xmath637 $ ] we define @xmath638 where @xmath639 is the sequence of rademacher functions on @xmath640 $ ] .",
    "in connection with this we have the following vector - valued analogue of marcinkiewicz  zygmund inequality .    [ lem:30 ]",
    "suppose that for every @xmath1 there is a constant @xmath641 such that for all @xmath637 $ ] and @xmath642 @xmath643 then there is a constant @xmath137 such that for every sequence @xmath644 @xmath645 in particular , if @xmath646 for each @xmath647 then implies the marcinkiewicz ",
    "zygmund result @xmath648 summation over @xmath649 in the inner sum of can be replaced by any other countable set and the result remains valid .",
    "let @xmath650 where @xmath651 is the sequence of rademacher functions on @xmath640 $ ] .",
    "then by the double khinchine s inequality we obtain @xmath652 however , @xmath653 for each @xmath654 $ ] by .",
    "now @xmath655 by khinchine s inequality and this proves the lemma .    from now on , unless otherwise stated , we assume that every function @xmath656 is finitely supported .    [ prop:2 ] under assumption for each @xmath657 there is a constant @xmath658 such that for every @xmath659 we have @xmath660    let @xmath661 . since @xmath662 , by hlder s inequality we have @xmath663 next , we note that @xmath664 and @xmath665 which is uniformly bounded with respect to @xmath614 . thus we obtain @xmath666 where the last inequality is a consequence of .",
    "the proof will be completed if we show @xmath667 for this purpose , using from lemma [ lem:5 ] , we observe that @xmath668 therefore , in view of , we obtain @xmath669^d}\\big(\\sum_{t\\in\\mathcal z }          \\big\\lvert          { \\mathcal{f}}^{-1}\\big(\\eta_{\\mathcal r } \\hat{f_t } \\big)(x+u ) - { \\mathcal{f}}^{-1 } \\big(\\eta_{\\mathcal r } \\hat{f_t } \\big)(x )          \\big\\rvert^2\\big)^{p/2 }          { \\:\\rm d}u\\\\          & \\qquad \\qquad = \\int_{[0 , 1]^d}\\bigg\\|\\big(\\sum_{t\\in\\mathcal z}\\big|\\int_{{\\mathbb{t}}^d }          e^{-2\\pi i { { \\xi \\cdot x } } } \\big(1 - e^{-2\\pi i { { \\xi \\cdot u}}}\\big )          \\eta_{\\mathcal r/2}(\\xi)\\eta_{\\mathcal r}(\\xi)\\hat{f_t}(\\xi )          { \\:\\rm d}\\xi\\big|^2\\big)^{1/2 }          \\bigg\\|_{\\ell^p(x)}^p\\\\          & \\qquad \\qquad \\leq          \\int_{[0 , 1]^d }          \\big\\lvert\\big(\\sum_{t\\in\\mathcal z }      \\big|{\\mathcal{f}}^{-1 } \\big(\\eta_{\\mathcal r } \\hat{f_t }   \\big)\\big|^2\\big)^{1/2 }      \\big\\rvert_{\\ell^p}^p { \\:\\rm d}u \\\\          & \\qquad \\qquad \\lesssim          \\big\\lvert\\big(\\sum_{t\\in\\mathcal z }      \\big|{\\mathcal{f}}^{-1 } \\big(\\eta_{\\mathcal r } \\hat{f_t }   \\big)\\big|^2\\big)^{1/2 }      \\big\\rvert_{\\ell^p}^p .      \\end{aligned}\\ ] ] hence , @xmath670^d}\\big(\\sum_{t\\in\\mathcal z }      \\big\\lvert      { \\mathcal{f}}^{-1}\\big(\\eta_{\\mathcal r } \\hat{f_t } \\big)(x+u )      \\big\\rvert^2\\big)^{p/2 }      { \\ : \\rm d}u\\\\      & \\lesssim      \\big\\lvert\\big(\\sum_{t\\in\\mathcal z }      \\big|{\\mathcal{f}}^{-1 } \\big(\\eta_{\\mathcal r } \\hat{f_t }   \\big)\\big|^2\\big)^{1/2 }      \\big\\rvert_{\\ell^p}^p .",
    "\\end{aligned}\\ ] ] this finishes the proof .",
    "[ lem:3 ] let @xmath671 , then for each @xmath672 and @xmath673 and any @xmath674 we have @xmath675 moreover , the implicit constants in are independent of @xmath395 , @xmath676 and @xmath418 .",
    "let @xmath661 as before .",
    "for each @xmath674 we set @xmath677 and @xmath678 .",
    "then @xmath679 since @xmath680 , by minkowski s inequality we obtain @xmath681 where in the last step we have used lemma [ lem:5 ]",
    ". hence , for all @xmath682 @xmath683 thus @xmath684 therefore , @xmath685 by the assumptions @xmath686 hence , we obtain @xmath687 .",
    "for the converse inequality , we use again to get @xmath688 and the proof of lemma [ lem:3 ] is completed .",
    "[ prop:4 ] under assumption for each @xmath657 there is a constant @xmath140 such that for each @xmath672 and @xmath689 and any @xmath690 we have @xmath691    let @xmath692 .",
    "for each @xmath674 we define @xmath693 then , by proposition [ prop:2 ] , @xmath694 if @xmath682 then we may write @xmath695 since @xmath680 , by lemma [ lem:5 ] and the last expression may be dominated by @xmath696 thus @xmath697 raising to the @xmath246th power and summing up over @xmath698 we get @xmath699 and lemma [ lem:3 ] finishes the proof .",
    "this section is intended to prove theorem [ th:3 ] , which is inspired by the ideas of ionescu and wainger from @xcite .",
    "before we precisely formulate theorem [ th:3 ] we need some portion on notation .",
    "let @xmath700 and for every @xmath701 define @xmath702 where @xmath703 .",
    "let @xmath704 denote the set of all prime numbers and @xmath705 $ ] .",
    "for any @xmath706 we define @xmath707 where for any @xmath708 @xmath709 therefore , @xmath710 if @xmath711 and @xmath712 is the set of all products of primes factors from @xmath713 of length at most @xmath714 , at powers between @xmath715 and @xmath714 .",
    "now we introduce the sets @xmath716 it is not difficult to see that every integer @xmath717 can be uniquely written as @xmath718 where @xmath719 and @xmath720 . moreover ,",
    "if @xmath721 for some @xmath722 then we obtain @xmath723 thus we have @xmath724 . furthermore , if @xmath725 then @xmath726 .    for a subset @xmath727",
    "we define @xmath728 where for each @xmath729 @xmath730 finally , for each @xmath701 we will consider @xmath731 it is easy to see , if @xmath725 then @xmath732 .",
    "we will assume that @xmath733 is a multiplier on @xmath91 and for every @xmath1 there is a constant @xmath734 such that for every @xmath735 we have @xmath736    for each @xmath147 we define new periodic multipliers @xmath737 where @xmath738 and @xmath739 is a diagonal @xmath58 matrix with positive entries @xmath740 such that @xmath741 .",
    "the main result is the following .",
    "[ th:3 ] let @xmath733 be a multiplier on @xmath91 obeying .",
    "then for every @xmath700 and @xmath1 there is a constant @xmath742 such that for any @xmath701 and @xmath743 @xmath744    the main constructing blocks have been gathered in the next four subsections .",
    "theorem [ th:3 ] is a consequence of theorem [ thm:5 ] and proposition [ prop:5 ] proved below .",
    "the main idea of the proof of theorem [ th:3 ] is very simple , we find some @xmath722 and disjoint sets @xmath745 such that @xmath746 and we show that @xmath747 with the summation restricted to @xmath748 is bounded on @xmath0 for every @xmath1 .",
    "this decomposition will be possible thanks to a suitable partition of integers from the set @xmath749 , see also @xcite . throughout this section",
    "we assume that @xmath750 has a finite support .",
    "let us introduce the definition of sets with @xmath751 property .",
    "[ def:1 ] a subset @xmath752 has @xmath751 property if there is @xmath708 and there are sets @xmath753 with the following properties :    1 .   for each @xmath304",
    "there is @xmath754 such that @xmath755 ; 2 .   for every @xmath756",
    "there are @xmath757 and @xmath758 such that @xmath759 ; 3",
    ".   for every @xmath760 there are unique numbers @xmath761 such that @xmath762 ; 4 .   if @xmath763 then @xmath764 .",
    "now three comments are in order .",
    "* firstly , we will assume that the set @xmath765 has @xmath751 property corresponding to @xmath766 .",
    "* secondly , if @xmath767 has @xmath751 property , then each subset @xmath768 has @xmath751 property as well . *",
    "thirdly , the most important remark is that , if a set @xmath767 has @xmath751 property then each element of @xmath767 has the same number of prime factors @xmath769 .",
    "the main result is the following .",
    "[ lem:12 ] for every @xmath700 there exists a constant @xmath722 such that for every @xmath701 the set @xmath770 can be written as a disjoint union of at most @xmath771 sets @xmath772 where @xmath773 and @xmath774 has @xmath751 property for each integer @xmath775 .",
    "the proof of lemma [ lem:12 ] will be based on the following .",
    "[ lem:31 ]    suppose @xmath776 are given with @xmath777",
    ". then there exists a constant @xmath778 independent of @xmath285 , and a family @xmath779 of partitions of @xmath780 into @xmath10 non - empty subsets with the following properties :    a.   for every @xmath781 each @xmath782 consists of pairwise disjoint subsets of @xmath780 and @xmath783 ; b.   for every @xmath784 with at least @xmath10 elements there exists @xmath785 such that @xmath786 for every @xmath304 .",
    "the same conclusion holds for each @xmath787 with cardinality at least @xmath10 .",
    "we know that every surjection @xmath788 determines a partition @xmath789 : 1\\le m\\le k\\}$ ] of @xmath780 into @xmath10 non - empty subsets .",
    "therefore , we shall work with surjective mappings @xmath790 from the set @xmath780 onto the set @xmath791 rather than with partitions of @xmath780 into @xmath10 non - empty subsets .",
    "let @xmath792 and let @xmath793 denote the set of all surjections @xmath788 . using inclusion - exclusion principle we can give the explicit formula for @xmath794 , but it is not important here .",
    "let @xmath784 with cardinality @xmath10 and note that @xmath795|=k\\}|=k!k^{n - k}\\ge \\frac{k!}{k^k}|s(n , k)|\\ ] ] since @xmath796 .",
    "the proof will be competed if we show that for @xmath797 we have @xmath798|=k\\big\\}\\not=\\emptyset .",
    "\\end{aligned}\\ ] ] this means that it is possible to find among at most @xmath799 surjections at least one @xmath800 such that @xmath801|=k$ ] .",
    "then the set @xmath789 : 1\\le m\\le k\\}$ ] is a partition of @xmath780 and @xmath802\\not=\\emptyset$ ] for every @xmath803 as desired .",
    "suppose for a contradiction that the set in is empty",
    ". then @xmath804|<k\\big\\}\\big|\\\\      & \\le \\sum_{e\\subseteq { \\mathbb{n}}_n:\\ : |e|=k}\\big|\\big\\{(f_1,\\ldots , f_r)\\in s(n , k)^r :       \\forall_{1\\le m\\le r}\\ |f_m[e]|<k\\big\\}\\big|\\\\      & = \\sum_{e\\subseteq { \\mathbb{n}}_n:\\ : |e|=k }       \\big|\\big\\{f\\in s(n , k ) : |f[e]|<k\\big\\}\\big|^r \\\\      & \\le \\sum_{e\\subseteq { \\mathbb{n}}_n:\\ : |e|=k }      \\bigg(1-\\frac{k!}{k^k}\\bigg)^r|s(n , k)|^r\\\\      & = \\binom{n}{k}\\bigg(1-\\frac{k!}{k^k}\\bigg)^r|s(n , k)|^r   \\\\      & \\le      \\bigg(\\frac{en}{k}\\bigg)^ke^{-r\\frac{k!}{k^k}}|s(n , k)|^r \\\\      & = e^{k\\log(\\frac{en}{k})-r\\frac{k!}{k^k}}|s(n , k)|^r\\end{aligned}\\ ] ] and this is impossible since @xmath805 , due to the fact @xmath806 .",
    "we have to prove that for every @xmath807 the set @xmath712 can be written as a disjoint union of at most @xmath799 sets with @xmath751 property .",
    "fix @xmath708 , let @xmath808 be a multi - index and observe that @xmath809 where @xmath810 since there are @xmath811 possible choices of exponents @xmath812 when @xmath708 , it only suffices to prove that every @xmath813 can be partitioned into a union ( not necessarily disjoint ) of at most @xmath799 sets with @xmath751 property .    according to lemma [ lem:31 ] for each integer @xmath814 there is a constant @xmath778 and a family @xmath815 with the following properties :    a.   for every @xmath816 each @xmath817 consists of pairwise disjoint subsets of @xmath713 and @xmath818 ; b.   for every @xmath819 with at least @xmath10 elements there exists @xmath820 such that @xmath821 for every @xmath304 .",
    "then one sees that for a fixed @xmath822 we have @xmath823 where @xmath824 and @xmath825 .",
    "indeed , the sum on the right - hand side of is contained in @xmath813 since each @xmath826 is . for the opposite inclusion take @xmath827 and let @xmath828 , then property ( ii ) for the family @xmath829 ensures that there is @xmath820 such that @xmath821 for every @xmath304",
    "therefore , @xmath830 .",
    "furthermore , we see that for each @xmath831 the sets @xmath826 have @xmath751 property .",
    "this completes the proof of lemma [ lem:12 ] .      for each @xmath775",
    "we define @xmath832 with @xmath748 as in lemma [ lem:12 ] , and we see that @xmath833 therefore , the proof of theorem [ th:3 ] will be completed if we show that for every @xmath1 and @xmath700 , there is a constant @xmath137 such that for any @xmath701 and @xmath834 we have @xmath835 for every @xmath836 .",
    "in fact we show a slightly stronger result with no extra effort , which will imply inequality from . for this purpose ,",
    "let @xmath837 be a set with @xmath751 property , see definition [ def:1 ] .",
    "moreover , we define @xmath838 and @xmath839 .",
    "finally we introduce @xmath840 our aim is to show that for every @xmath1 and @xmath700 , there is a constant @xmath137 such that for any @xmath841 and for any set @xmath767 as in and for every @xmath836 we have @xmath842 for @xmath843 the bound in is obvious , since we allow the constant @xmath137 to depend on @xmath246 and @xmath844 .",
    "moreover , by the duality and interpolation , it suffices to prove for @xmath845 where @xmath846 . if @xmath847 as in lemma [ lem:12 ] for some @xmath848 , then we see that @xmath849 and @xmath850 , and consequently implies as desired .",
    "for the proof of we expect to use the strong orthogonality between the supports of the functions @xmath851 in the multiplier @xmath852 when @xmath41 varies over @xmath853 with the set @xmath767 as in .",
    "we will achieve this by exploiting @xmath751 property for the set @xmath767 .",
    "for do so , further reductions are necessary .    the function @xmath854 is regarded as a periodic function on @xmath855 , thus @xmath856 in the last line we have used the fact , that if @xmath857 then for every @xmath858 , there are unique @xmath859 , such that @xmath860 and @xmath861 since @xmath767 has @xmath751 property then according to definition [ def:1 ] there is an integer @xmath862 and there are sets @xmath863 such that for any @xmath864 we have @xmath865 for some @xmath866 .",
    "now for each @xmath864 we introduce @xmath867 and for any @xmath868 let @xmath869 for any sequence @xmath870 determined by the set @xmath226 , let us define @xmath871 note that @xmath872 is a subset of @xmath873 with fixed denominators @xmath874 .",
    "if @xmath875 then we have @xmath876 .",
    "let @xmath877 then again by we obtain @xmath878 where for @xmath879 @xmath880    for the simplicity of notation we will write from now on , for every @xmath881 , that @xmath882 with @xmath883 and @xmath846 . therefore , @xmath884 and the proof of inequality will follow from the following .",
    "[ thm:500 ] suppose that @xmath700 and @xmath846 are given .",
    "then there is a constant @xmath885 such that for any @xmath886 and for any set @xmath767 as in and for every @xmath883 we have @xmath887 moreover , the integer @xmath708 , the set @xmath888 and consequently the sets @xmath889 are determined by the set @xmath767 as it was described above .",
    "we have reduced the matters to proving theorem [ thm:500 ] .",
    "the bound will follow from theorem [ thm:5 ] and proposition [ prop:5 ] formulated below .",
    "theorem [ thm:5 ] , which is the main result of this subsection , shows that one can control the left - hand side of by a sum of @xmath890 norms of appropriate square functions corresponding to some subsums of @xmath891 , see .",
    "the idea of proof with square function estimates originates in ionescu and wainger s paper @xcite , see lemma 2.1 and lemma 2.2 given there .",
    "the proof of theorem [ thm:5 ] consists of two steps , see lemma [ lem:13 ] and lemma [ lem:14 ] below , which applied recursively will result in .",
    "we now introduce a suitable square function which will be useful in bounding . for",
    "any @xmath892 and @xmath893 and any sequence @xmath894 determined by the set @xmath529 let us define the following square function @xmath895 associated with the sequence @xmath896 of complex - valued functions as in , by setting    @xmath897    where @xmath898 .",
    "we will use the convention that for some @xmath899 @xmath900 and defines some function which depends on @xmath901 and on each @xmath902 .",
    "as it was mentioned above , for we have to exploit the fact that the fourier transform of @xmath903 is defined as a sum of disjointly supported smooth cut - off functions .",
    "this observation suggests that appropriate subsums of @xmath904 should be strongly orthogonal to each other . to extract these strong orthogonality properties efficiently we have to introduce , as in @xcite , the definition of sequences with the uniqueness property .",
    "[ def:2 ] a finite sequence @xmath905 has the uniqueness property if there is @xmath906 such that @xmath907 for any @xmath908 .",
    "now fix @xmath909 and let @xmath910 . for any @xmath911 determined by the set @xmath529 we define for @xmath912 @xmath913 and @xmath914 note that @xmath915 and @xmath916 are appropriate pieces in the definition of the square function from .",
    "namely , @xmath917 and @xmath918 the next lemma with definition [ def:2 ] will explain their orthogonality properties .",
    "[ lem:15 ] under the assumptions of theorem [ thm:500 ] , suppose that @xmath919 and @xmath920 .",
    "fix @xmath909 and let @xmath910 and let @xmath915 and @xmath916 be the functions defined in and respectively .",
    "if @xmath921 is a sequence with the uniqueness property then @xmath922 for every @xmath911 determined by the set @xmath529 and every @xmath923 .",
    "additionally , if @xmath924 is a sequence with the uniqueness property then @xmath925 for every @xmath911 determined by the set @xmath529 , every @xmath923 and @xmath926 .",
    "fix @xmath911 and @xmath923 .",
    "we firstly prove .",
    "let @xmath927 be the sequence with the uniqueness property . by definition [ def:2 ]",
    "we can assume , without of loss of generality , that @xmath928 for any @xmath929 .",
    "set @xmath930 .",
    "let @xmath931 be a cube and note that , generally , we have @xmath932 moreover , each @xmath933 in the sum above defines a rational fraction in @xmath934 with a denominator bounded by @xmath935 from above .",
    "now we see that @xmath936 is supported in the algebraic sum of @xmath937 sets as on the right - hand side of determined by @xmath938 .",
    "thus @xmath939 where @xmath940 varies over some subset of @xmath934 with the property that all denominators @xmath941 are relatively prime with @xmath942 and @xmath943 .",
    "we are going to prove that @xmath944 .",
    "suppose for a contradiction that there is @xmath945 and there are @xmath946 and @xmath947 associated with @xmath948 and @xmath949 respectively such that @xmath950 , @xmath951 and @xmath952 since @xmath953 for every @xmath954 .",
    "since @xmath955 , there is @xmath954 such that @xmath956 .",
    "indeed , @xmath957 for some @xmath958 such that @xmath959 . if @xmath960 , then @xmath961 but this is impossible .",
    "thus for some @xmath954 we have @xmath962 and consequently @xmath963 , but we have assumed that @xmath964 , hence @xmath965 which gives contradiction . we have proven that @xmath966 and plancherel s theorem yields .    in order to prove we will proceed in a similar way as above .",
    "namely , assume that the sequence @xmath967 has the uniqueness property and assume that @xmath968 for any @xmath929 .",
    "let us define @xmath969",
    ". generally , note that @xmath970 each @xmath971 in the sum above defines a rational fraction in @xmath934 with a denominator bounded by @xmath935 from above .",
    "furthermore , @xmath972 is supported in the algebraic sum of @xmath937 sets as on the right - hand side of determined by @xmath973 .",
    "thus @xmath974 where @xmath975 varies over some subset of @xmath934 with the property that @xmath943 .",
    "now we show that @xmath976 .",
    "if not then there is @xmath977 and there are @xmath978 associated with @xmath948 and @xmath949 respectively such that @xmath979 , @xmath980 , @xmath981 , @xmath982 , @xmath983 and for every @xmath954 @xmath984 thus , since @xmath979 , we obtain that @xmath985 . indeed , if @xmath986 then @xmath987 but it is impossible since @xmath988 .",
    "therefore , there is @xmath989 @xmath990 which implies that @xmath991 .",
    "this contradiction shows that @xmath944 and consequently by plancherel s theorem follows and the proof of lemma [ lem:15 ] is completed .    in lemma [ lem:13 ] and lemma [ lem:14 ]",
    "we shall establish two fundamental properties of the square function @xmath992 which will be critical for the proof of theorem [ thm:5 ] .",
    "however , we begin with a simple combinatorial lemma .",
    "[ lem:17 ] let @xmath846 and @xmath993 be a subset of a finite set @xmath130 such that @xmath994 .",
    "suppose we are given a sequence of complex numbers @xmath995 .",
    "then for every sequence @xmath996 which does not have the uniqueness property and @xmath997 we have the following inequality @xmath998    we begin with the following claim . for every set @xmath993 with at most @xmath39 elements",
    "if the sequence @xmath996 does not have the uniqueness property and satisfies then there are two functions @xmath999 such that @xmath1000 and @xmath1001 we describe some algorithm which will be essential to establish the claim . for this purpose",
    "let us consider a quadruple @xmath1002 , which consists of two subsets @xmath1003 of @xmath1004 , a set @xmath1005 of pairs of positive integers and @xmath1006 we begin with a construction of a loop @xmath1007 which will map quadruples @xmath1008 to new quadruples @xmath1009 with the properties as above , i.e. @xmath1010 .    indeed , fix a quadruple @xmath1011 as above .",
    "let @xmath1012 be the minimal number for which @xmath1013 for some @xmath1014 , then we define @xmath1015 and @xmath1016 .",
    "suppose that we have constructed @xmath1017 distinct numbers and the functions @xmath1018 and @xmath1019 with the properties that @xmath1020 is the smallest number for which @xmath1021 for each @xmath1022 .",
    "we stop the loop @xmath1023    * when we reach the first @xmath31 such that @xmath1024 , or * when we reach @xmath31 such that @xmath1025 does not appear as the element of any pair in the set @xmath1026    now we define the sets @xmath1027 from the first case follows @xmath1028 the second case yields that @xmath1029 and @xmath1030 moreover , if @xmath1025 appears in the sequence @xmath1031 at least twice , then it must have been selected in @xmath1032 .",
    "hence @xmath1033 where @xmath1034    now we can describe the algorithm which will consists of three steps",
    ".    * step 1 .",
    "* let @xmath1035 be the set of pairs corresponding to the sequence @xmath1036 , and @xmath1037 we apply the loop @xmath1007 to the quadruple @xmath1038 with @xmath1039 , which will result in a new quadruple @xmath1040 , where @xmath1041 @xmath1042 and the sets @xmath1043 the first application of the loop @xmath1007 to the quadruple @xmath1038 always results in @xmath1044 , ( see the case a ) above ) , since the set @xmath102 corresponds to the sequence @xmath1036 , whose each element appears at least twice .",
    "therefore , if @xmath1045 we obtain the desired partition of the sequence @xmath1036 .    * step 2 .",
    "* otherwise , we have @xmath1046 , and then we apply the loop @xmath1007 with the data @xmath1040 , then we obtain a new quadruple @xmath1047 , where @xmath1048 and @xmath1049 and the sets @xmath1050 observe if @xmath1051 and @xmath1052 then we are done .",
    "if @xmath1053 then we repeat the algorithm described in the step 2 . with the data @xmath1054 instead of @xmath1055",
    "assume now that @xmath1056 , this corresponds to the case b ) described above with @xmath1057 . if @xmath1058 then @xmath1059 , since @xmath1060 is that @xmath1061 does not appear as the element of any pair in the set @xmath1062 , therefore @xmath1063 as well as @xmath1064 , since every element in the sequence @xmath1036 appears at least twice .",
    "in this situation if @xmath1052 we obtain the claim . otherwise , we repeat the step 2 . with the data @xmath1065 instead of @xmath1040",
    ".    * step 3 . *",
    "suppose now that @xmath1056 , and @xmath1066 , then it is easy to see that @xmath1067 , since arguing in a similar way as above we show that @xmath1063 and @xmath1068 , due to the construction of the loop @xmath1007 , see the case b ) above .",
    "so far we have applied the loop @xmath1007 to quadruples which have the first two sets being equal .",
    "now we apply @xmath1007 with @xmath1069 to the quadruple @xmath1070 with interchanged order of the sets @xmath1071 , i.e. @xmath1072 must be the first and @xmath1073 the second .",
    "we obtain a new quadruple @xmath1074 with @xmath1075 and @xmath1076 and the sets @xmath1077 observe that @xmath1078 since @xmath1079 has not been considered in @xmath1080 and every element in the sequence @xmath1036 appears at least twice .",
    "moreover , by the construction we have @xmath1081 and we see that @xmath1082 hence , if @xmath1083 then we have @xmath1084 .",
    "if @xmath1085 we are in the case b ) with @xmath1086 in the construction of @xmath1007 , thus @xmath1087 must have been chosen before the choice @xmath1087 , since every element in the sequence @xmath1036 appears at least two times .",
    "this proves that @xmath1088 and consequently @xmath1084 .",
    "therefore , if @xmath1089 we obtain the desired partition of the sequence @xmath1036 . otherwise , we restart our algorithm in the step 2 . with the quadruple @xmath1090 instead of @xmath1091 .    the advantage of the algorithm described in step 1.-step 3 .",
    "is that after each iteration we obtain a quadruple @xmath1092 such that @xmath1093 and the cardinality is of @xmath1094 is smaller than the cardinality of the set of pairs @xmath102 associated with the sequence @xmath1036 .",
    "thus after at most @xmath1095 iterations we obtain two sets @xmath1096 so that @xmath1097 and @xmath1098 . furthermore , for every pair @xmath1099 we obtain @xmath1100 and @xmath1101 for some @xmath1102",
    ". then @xmath1103 with the functions @xmath348 and @xmath151 as desired .",
    "having constructed the functions @xmath348 and @xmath151 we see @xmath1104 therefore , @xmath1105 the proof of lemma [ lem:17 ] is completed .",
    "[ lem:13 ] under the assumptions of theorem [ thm:500 ] , there is a constant @xmath1106 such that for any @xmath919 and @xmath920 and @xmath909 and for any @xmath1107 determined by the set @xmath529 we have @xmath1108 where @xmath1109 is the sequence determined by the set @xmath1110 .",
    "fix @xmath911 determined by the set @xmath529 and @xmath909 .",
    "the set @xmath1111 is regarded as a subset of @xmath1112 .",
    "thus @xmath1113 let us introduce for any set @xmath1114 with @xmath1115 @xmath1116 where the summation is taken over all sequences @xmath1117 which do not have the uniqueness property and @xmath1118 .",
    "if the sequence @xmath1119 has the uniqueness property then holds .",
    "therefore , @xmath1120 the summation in the last sum is taken over all @xmath1121 such that @xmath994 , since by the uniqueness property , @xmath1122 unless @xmath994 . by lemma [ lem:17 ]",
    "we see that for each term in the sum from we have @xmath1123 thus @xmath1124 since for any @xmath1121 the sum in contains at most @xmath1125 terms .    therefore , combining , and we obtain @xmath1126 this completes the proof of lemma [ lem:13 ] .",
    "[ lem:14 ] under the assumptions of theorem [ thm:500 ] , there is a constant @xmath1106 such that for any @xmath919 and @xmath920 and @xmath909 and for any @xmath911 determined by the set @xmath529 we have @xmath1127 where @xmath1109 is the sequence determined by the set @xmath1110 .",
    "recall form @xcite , lemma 2.3 , that there is a constant @xmath1106 such that for any @xmath55 and arbitrary numbers @xmath1128 we have @xmath1129 according to lemma [ lem:13 ] and inequality we have @xmath1130 the task now is to estimate the last double sum in . recall that @xmath1131 and note that for any @xmath1132 , and @xmath1133 we have @xmath918 therefore , @xmath1134 likewise in the previous lemma let us introduce for any set @xmath1135 with @xmath1115 @xmath1136 where the summation is taken over all sequences @xmath1137 which do not have the uniqueness property and @xmath1138 .",
    "if the sequence @xmath1137 has the uniqueness property then holds .",
    "therefore , @xmath1139 the summation in the last sum is taken over all @xmath1140 such that @xmath994 , since by the uniqueness property , @xmath1122 unless @xmath994 . by lemma [ lem:17 ]",
    "we see that for each term in the sum from we have @xmath1141 thus @xmath1142 since for any @xmath1121 the sum in contains at most @xmath1125 terms .    combining , and we obtain that @xmath1143 the proof of lemma [ lem:14 ] is completed .",
    "theorem [ thm:500 ] will be proved as a consequence of theorem [ thm:5 ] and proposition [ prop:5 ] below .",
    "[ thm:5 ] suppose that @xmath700 and @xmath846 are given .",
    "then there is a constant @xmath885 such that for any @xmath886 and for any set @xmath767 as in and for every @xmath883 we have @xmath1144 moreover , the integer @xmath708 , the set @xmath888 and consequently the sets @xmath889 are determined by the set @xmath767 as it was described above the formulation of theorem [ thm:500 ] .",
    "observe that for any @xmath919 and @xmath1145 and @xmath909 and for any @xmath1146 determined by the set @xmath529 , by lemma [ lem:13 ] combined with lemma [ lem:14 ] we obtain that @xmath1147 therefore , applying recursively we obtain @xmath1148 the proof of is completed .",
    "now theorem [ thm:5 ] reduces the proof of inequality to showing @xmath1149 for any @xmath883 which is a characteristic function of a finite set in @xmath205 .",
    "firstly , we prove the following .",
    "[ prop:5 ] under the assumptions of theorem [ thm:500 ] , there exists a constant @xmath885 such that for any @xmath1150 any @xmath1151 determined by the set @xmath226 and @xmath883 we have @xmath1152    we assume , without of loss of generality , that @xmath701 is large .",
    "let @xmath1153 and observe that according to the notation from , we have @xmath1154 where @xmath1155 by proposition [ prop:4 ] , with the sequence of multipliers @xmath1156 for all @xmath701 and @xmath733 as in , we have @xmath1157 since @xmath1158 for sufficiently large @xmath701 .",
    "therefore , combining with we obtain that @xmath1159 this completes the proof of proposition [ prop:5 ] .",
    "now we are able to finish the proof of theorem [ thm:500 ] .",
    "it remains to show that there exists a constant @xmath885 such that for any @xmath1150 any @xmath1151 determined by the set @xmath226 and @xmath883 we have @xmath1160 since there are @xmath1161 possible choices of sets @xmath892 and @xmath708 then will follow and the proof of theorem [ thm:500 ] will be completed . if @xmath1162 then plancherel s theorem does the job since the functions @xmath1163 are disjointly supported for all @xmath1164 , @xmath1165 , @xmath1166 and @xmath1151 . for general @xmath1167 , since @xmath1168 because we have assumed that @xmath790 is a characteristic function of a finite set in @xmath205 , it suffices to prove for any @xmath901 that @xmath1169 in fact , since @xmath1170 , it is enough to show @xmath1171 for any sequence of complex numbers @xmath1172 such that @xmath1173 computing the fourier transform we obtain @xmath1174 if @xmath1175 for some @xmath1176 where @xmath1177 then @xmath1178 where @xmath1179 , @xmath1180 and @xmath1181 .",
    "the identity shows that the function on the left hand side of can be written as a sum of @xmath1182 functions @xmath1183 where possible values of @xmath395 are products of @xmath1184 and @xmath1185 or @xmath1186 for @xmath1187 .",
    "therefore , the proof of will be completed if we show that @xmath1188 for any integer @xmath1189 such that @xmath1190 , for all @xmath1191 and @xmath1192 .",
    "recall that , according remark [ rem:1 ] , in our case @xmath1193 for some two smooth functions @xmath1194 supported in @xmath609 .",
    "therefore , by the cauchy ",
    "schwarz inequality we only need to prove that @xmath1195 and @xmath1196 since @xmath1190 , for all @xmath1191 and @xmath1192 then @xmath1197 for any @xmath912 and its denominator is bounded by @xmath1198 .",
    "we can assume , without of loss of generality , that @xmath1199 by the periodicity of @xmath1200 .",
    "inequality easily follows from plancherel s theorem . in order to prove observe that by the change of variables one has @xmath1201 therefore , plancherel s theorem and the last identity yield @xmath1202 the first sum on the right - hand side of is bounded in view of .",
    "the second one vanishes since the function @xmath608 is supported in @xmath609 and @xmath1203 , for sufficiently large @xmath285 .",
    "the proof of theorem [ thm:500 ] is completed .",
    "for any function @xmath1204 with a finite support we have @xmath1205 where @xmath1206 is a kernel defined by @xmath1207 and @xmath1208 denotes dirac s delta at @xmath214 and @xmath98 is the canonical polynomial , see section [ sec:2 ] .",
    "let @xmath1209 denote the discrete fourier transform of @xmath1206 , i.e. @xmath1210 finally , we define @xmath1211^k } e^{2\\pi i { { \\xi \\cdot { \\mathcal{q}}(n y ) } } } { \\ : \\rm d}y.\\ ] ] using a multi - dimensional version of van der corput lemma ( see @xcite ) we may estimate @xmath1212 where @xmath168 is the @xmath58 diagonal matrix as in section [ sec:2 ] . additionally , we have @xmath1213 for @xmath729 let us define @xmath730 next , for @xmath1214 and @xmath1215 we define the _ gaussian sum _ @xmath1216 let us observe that , by the multi - dimensional variant of weyl s inequality ( see ( * ? ? ?",
    "* proposition 3 ) ) , there exists @xmath81 such that @xmath1217    we shall prove that for every @xmath1 there is a constant @xmath1218 such that for every sequence @xmath1219 of non - negative functions with finite supports we have @xmath1220 we begin with proving the following .",
    "[ pr:0 ] there is a constant @xmath137 such that for every @xmath701 and for every @xmath1221 satisfying @xmath1222 for all @xmath167 , where @xmath1223 , @xmath1224 , @xmath1225 and @xmath1226 we have @xmath1227    let @xmath1228 . for any @xmath1229 , if @xmath1230 then for each @xmath167 @xmath1231 thus @xmath1232 therefore , @xmath1233^k } } } }      e^{2\\pi i { { \\theta \\cdot { \\mathcal{q}}(qy+r)}}}\\big).\\ ] ] if @xmath1234 then @xmath1235 thus @xmath1236^k } } } }      e^{2\\pi i { { \\theta \\cdot { \\mathcal{q}}(qy)}}}+\\mathcal o\\big(qn^{-1}+l_2l_3n^{-1}\\sum_{\\gamma \\in \\gamma}\\big(n / l_1\\big)^{|\\gamma|}\\big).\\ ] ] again by the mean value theorem one can replace the sum on the right - hand side by the integral . indeed , we obtain @xmath1237^k }      e^{2\\pi i { { \\theta \\cdot { \\mathcal{q}}(qy)}}}-\\int_{[0 , n / q]^k}e^{2\\pi i \\theta\\cdot{\\mathcal{q}}(qt ) } { \\ : \\rm d}t\\big|\\\\      & \\qquad \\qquad = \\big|\\sum_{y\\in(0 , \\lfloor n / q\\rfloor]^k } e^{2\\pi i        { { \\theta \\cdot { \\mathcal{q}}(qy)}}}-\\sum_{y\\in(0 , \\lfloor        n / q\\rfloor-1]^k}\\int_{y+(0 , 1]^k}e^{2\\pi i        \\theta\\cdot{\\mathcal{q}}(qt)}{\\ : \\rm d } t\\big|+\\mathcal o\\big((n / q)^{k-1}\\big)\\\\      & \\qquad \\qquad = \\big|\\sum_{y\\in(0 , \\lfloor n / q\\rfloor-1]^k } \\int_{(0 , 1]^k}e^{2\\pi i        \\theta\\cdot{\\mathcal{q}}(qy)}-e^{2\\pi i        \\theta\\cdot{\\mathcal{q}}(q(t+y))}{\\ : \\rm d } t\\big|+\\mathcal      o\\big((n / q)^{k-1}\\big)\\\\      & \\qquad \\qquad   = \\mathcal o\\big((n / q)^{k-1}+(n / q)^kl_2l_3n^{-1}\\sum_{\\gamma \\in \\gamma}\\big(n / l_1\\big)^{|\\gamma|}\\big ) .",
    "\\end{aligned}\\ ] ] this completes the proof of proposition [ pr:0 ] .",
    "let @xmath1238 and @xmath85 be the numbers whose precise values will be specified later .",
    "let us introduce for every @xmath1239 the multipliers @xmath1240 with @xmath1241 defined as in . from theorem [ th:3 ] we know that for every @xmath1 @xmath1242 the implicit constant in depends on the parameter @xmath700 , which was fixed , see section [ sec:6 ] .",
    "however , from now on we will assume that @xmath700 and the integer @xmath1243 are related by the equation @xmath1244 observe that @xmath1245      replacing the supremum norm by @xmath1246 norm we see that @xmath1247 therefore , it suffices to show @xmath1248 which in view of holds , if we prove @xmath1249 indeed , by we have for every @xmath1250 that @xmath1251 in fact we show that it is possible to improve the estimate for @xmath1252 .",
    "namely , we will show that for big enough @xmath109 , which will be specified later , and for all @xmath1239 we have @xmath1253 this estimate will be a consequence of theorem [ thm:3 ] .",
    "for do so , by dirichlet s principle we have for every @xmath954 @xmath1254 where @xmath1255 . in order to apply theorem [ thm:3 ] we must show that there exists @xmath954 such that @xmath1256 .",
    "suppose for a contradiction that for every @xmath167 we have @xmath1257 then for some @xmath1258 we have @xmath1259 where @xmath1260 .",
    "hence , taking @xmath1261 we have @xmath1262 provided that @xmath1263 . on the other hand , if @xmath1264 then for every @xmath1262 there exists @xmath954 such that @xmath1265 therefore , one obtains @xmath1266 but this gives a contradiction , for sufficiently large @xmath55 .",
    "we have already shown that there exists @xmath954 such that @xmath1256 and consequently theorem [ thm:3 ] yields @xmath1267 provided that @xmath1264 and this proves and we obtain    @xmath1268    interpolating with we obtain @xmath1269 for some @xmath1270 . choosing @xmath109 and @xmath85 appropriately large one obtains .",
    "note that for any @xmath1271 so that @xmath1272 for every @xmath989 with @xmath1273 we have @xmath1274 where @xmath1275 these two properties and follow from proposition [ pr:0 ] with @xmath1276 , @xmath1277 and @xmath1278 , since @xmath1279 which holds for sufficiently large @xmath55 , when @xmath1238 is sufficiently small .",
    "let us introduce for every @xmath1239 new multipliers @xmath1280 and note that by @xmath1281 and consequently by plancherel s theorem @xmath1282 moreover , by theorem [ th:3 ] we have @xmath1283 and @xmath1284 thus @xmath1285 interpolating now with we can conclude that for some @xmath1270 @xmath1286 for every @xmath1287 define multipliers @xmath1288 and note that by we have @xmath1289 since @xmath1290 , provided that @xmath1291 .",
    "the estimate combined with plancherel s theorem implies that @xmath1292 moreover , since @xmath1293 we have @xmath1294 interpolating with one immediately concludes that for some @xmath1270 @xmath1295 in view of and and it suffices to prove that for every @xmath1296 we have @xmath1297      our aim will be to prove @xmath1299 for do so , we only need to prove the following .",
    "[ thm:2 ] there is @xmath140 such that for any @xmath1300 and @xmath1301 @xmath1302 with @xmath85 defined in and @xmath81 as in .    for @xmath1300 we set @xmath1303 and @xmath1304 .",
    "firstly , we estimate the supremum over @xmath1305 . by lemma [ lem:6 ]",
    "we have @xmath1306 where @xmath1307 .",
    "for any @xmath1308 , by plancherel s theorem we get @xmath1309 where @xmath1310 and @xmath1311 , since the supports are effectively disjoint . using and",
    "we conclude @xmath1312 therefore , by we may estimate @xmath1313 since if @xmath1314 then @xmath1315 . in the last step",
    "we have used disjointness of supports of @xmath1316 while @xmath41 varies over @xmath1317 .",
    "we have just proven @xmath1318 next , we consider the case when the supremum is taken over @xmath1319 . for any @xmath1320 we define @xmath1321 and @xmath1322 by plancherel s theorem , for any @xmath1323 and @xmath1314 we have @xmath1324 since , by , @xmath1325 therefore , @xmath1326 because the set @xmath1327 contains at most @xmath1328 elements and @xmath1329 for sufficiently large @xmath1330 .",
    "thus we obtain @xmath1331 in particular , @xmath1332 let us observe that the functions @xmath1333 and @xmath1334 are @xmath1335-periodic . therefore , by double change of variables we get @xmath1336 where in the second equality periodicity has been used .",
    "next by proposition [ prop:2 ] we obtain @xmath1337 in the last step we have used and the disjointness of supports of @xmath1316 while @xmath41 varies over @xmath1317 .",
    "therefore , @xmath1338 which together with concludes the proof .",
    "for @xmath1296 let @xmath1339 and @xmath1340 be as in the proof of theorem [ thm:2 ] . we show that for every @xmath1 there is a constant @xmath1218 such that for every @xmath1296 and all @xmath1341 @xmath1342 then interpolation with will immediately imply .",
    "the proof of will consist of two parts .",
    "we shall bound separately the supremum when @xmath1343 and when @xmath1344 , see theorem [ thm:7 ] and theorem [ thm:8 ] respectively .",
    "[ thm:7 ] let @xmath1 then there is a constant @xmath1218 such that for any @xmath1296 and @xmath1345 we have @xmath1346    we set @xmath1347 and define @xmath1348 where @xmath1349 .",
    "we see that @xmath1350 is the multiplier corresponding to the averaging operator , i.e. @xmath1351 . thus , we easily note that for each @xmath1352 $ ] we have @xmath1353 since @xmath1354 , where @xmath1355 is the kernel of the operator @xmath1356 , see .",
    "moreover , if @xmath1357 is such that @xmath1358 for every @xmath954 with some @xmath1359 and @xmath1215 , then @xmath1360 indeed , by proposition [ pr:0 ] with @xmath1361 , @xmath1362 , @xmath1363 and @xmath1364 we see that the error term is dominated by @xmath1365 therefore , @xmath1366 since @xmath1367 let us define the multipliers @xmath1368 and observe that by we have @xmath1369 hence , by and plancherel s theorem we have @xmath1370 moreover , for every @xmath1 we have a trivial bound @xmath1371 interpolating now with one has for some @xmath1270 that @xmath1372 thus in view of and we obtain @xmath1373 since @xmath1374 .",
    "the proof of theorem [ thm:7 ] will be completed if we show @xmath1375 appealing to inequality we see that @xmath1376 where @xmath1377 . in view of lemma [ lem:30 ]",
    "if suffices to show that for every @xmath1378 and @xmath637 $ ] we have @xmath1379 for any sequence @xmath1380 with @xmath1381 .",
    "let us consider the operator @xmath1382 with @xmath1383 we notice that the multiplier @xmath733 corresponds to a continuous singular radon transform .",
    "thus @xmath733 defines a bounded operator on @xmath1384 for any @xmath1385 with the bound independent of the sequence @xmath1386 ( see ( * ? ? ?",
    "* section 11 ) or @xcite ) .",
    "hence , by theorem [ th:3 ] @xmath1387 and consequently we obtain and the proof of theorem [ thm:7 ] is completed .    for each @xmath147 and @xmath1296 we define multipliers @xmath1388 where @xmath1389 and @xmath1390 is the sequence of multipliers on @xmath91 obeying .    [ th:1 ] let @xmath15 then there exists @xmath1391 such that for any @xmath1392 and @xmath1393 we have @xmath1394    let us observe that @xmath1395 therefore , @xmath1396 where @xmath1397",
    "now , by proposition [ prop:4 ] and we get @xmath1398 in view of it suffices to prove @xmath1399 where @xmath1400 observe that arguing in a similar way as in the proof of theorem [ thm:7 ] we obtain by that @xmath1401 where @xmath1402 therefore , combined with plancherel s theorem yields @xmath1403 we can conclude by interpolation with that @xmath1404 since by theorem [ th:3 ] we have @xmath1405 and by the trivial bound @xmath1406 this establishes the bound in and the proof of theorem [ th:1 ] is finished .",
    "[ thm:8 ] let @xmath1 then there is a constant @xmath1218 such that for any @xmath1296 and @xmath1407 we have @xmath1408    theorem [ thm:17 ] guarantees that the sequence @xmath1409 satisfies .",
    "thus in view of theorem [ th:1 ] with @xmath1410 and it only suffices to prove that for any @xmath1344 we have @xmath1411 for some @xmath1412 .",
    "obviously we have @xmath1413 next , we observe that @xmath1414 implies that @xmath1415 for some @xmath167 .",
    "therefore , for @xmath1319 we have @xmath1416 since @xmath1417 for sufficiently large @xmath1296 . thus using , we obtain @xmath1418 hence , by @xmath1419 thus , by plancherel s theorem we obtain @xmath1420 interpolating now with we obtain and this completes the proof of theorem [ thm:8 ] .",
    "the purpose of this section is to prove theorem [ thm:11 ] however we begin with some useful reductions . in view of lemma [ lem:1 ] , to prove theorem [ thm:11 ] it is enough to consider @xmath1421 where @xmath98 is the canonical polynomial as in section [ sec:2 ] .    given a kernel @xmath1422 satisfying and there are functions @xmath1423 and a constant @xmath140 such that for @xmath1424 @xmath1425 where for each @xmath1426 the kernel @xmath1427 is supported inside @xmath1428 , satisfies @xmath1429 for all @xmath1430 such that @xmath1431 , and has integral @xmath1432 , provided @xmath1433 ( for the proof see ( * ? ? ?",
    "* chapter 6 ,  4.5 , chapter 13 ,  5.3 ) ) .",
    "next , we define a sequence @xmath1434 of functions on @xmath855 by @xmath1435 then for any finitely supported function @xmath790 on @xmath205 @xmath1436 for @xmath1426 we set @xmath1437 using multi - dimensional version of van der corput s lemma ( see ( * ? ? ? * propositon 2.1 ) ) we obtain @xmath1438 where @xmath168 is the @xmath58 diagonal matrix as in section [ sec:2 ] . moreover ,",
    "if @xmath1433 we have @xmath1439 finally , let @xmath1440 .",
    "now instead of theorem [ thm:11 ] we prove the following dyadic version .",
    "[ thm:12 ] for every @xmath1441 there is @xmath35 such that for all @xmath1442 @xmath1443    it is easy to see that theorem [ thm:12 ] combined with theorem [ thm:10 ] implies theorem [ thm:11 ] , since for any @xmath1444 we have the following pointwise bound @xmath1445    the strategy of the proof of theorem [ thm:12 ] is much the same as for the proof of the result for averaging operators from section [ sec:4 ] . however , there are some subtle changes which could cause some confusions . therefore ,",
    "for the convenience of the reader we provide all details .",
    "[ prop:1 ] there is a constant @xmath137 such that for every @xmath1446 and for every @xmath1447 satisfying @xmath1222 for all @xmath167 , where @xmath1448 , @xmath1224 , @xmath1449 and @xmath1226 we have @xmath1450    let @xmath1228 .",
    "for any @xmath1229 , if @xmath1230 then for each @xmath167 @xmath1231 thus @xmath1232 therefore , @xmath1451 if @xmath1452 then @xmath1453 and @xmath1454 thus @xmath1455 again by the mean value theorem one can replace the sum on the right - hand side by the integral . indeed , we obtain @xmath1456 this completes the proof of proposition [ prop:1 ]",
    ".    as in section [ sec:4 ] let @xmath1238 and @xmath85 be the numbers whose precise values will be chosen later . for every @xmath1457",
    "we define the multipliers @xmath1458 with @xmath1241 defined as in section [ sec:6 ] .",
    "theorem [ th:3 ] guarantees that for every @xmath1 @xmath1459 the implicit constant in depends on the parameter @xmath700 , which was fixed , see section [ sec:6 ] .",
    "however , from now on we will assume that @xmath700 and the integer @xmath1243 are related by the equation @xmath1460 observe , with the aid of , that @xmath1461      we see that @xmath1462 therefore , in a similar way as in the subsection concerning the estimates for the second norm in it is possible to show , using theorem [ thm:3 ] , that @xmath1463      note that for any @xmath1271 so that @xmath1464 for every @xmath989 with @xmath1465 we have @xmath1466 where @xmath1467 these two properties and follow from proposition [ prop:1 ] with @xmath1468 , @xmath1469 and @xmath1470 , since @xmath1471 which holds for sufficiently large @xmath1446 , when @xmath1238 is sufficiently small .",
    "let us introduce for every @xmath1457 new multipliers @xmath1472 in a similar way as in the previous section ( see ) one can conclude that for some @xmath1270 @xmath1473 for every @xmath1474 define multipliers @xmath1475 arguing as in the proof of estimate we see that for some @xmath1270 @xmath1476 therefore in view of and and it suffices to prove that for every @xmath1296 we have @xmath1477      we shall prove @xmath1478 for the proof of it suffices to show the following .",
    "[ thm:14 ] there is @xmath140 such that for any @xmath1300 and @xmath1301 @xmath1479 with @xmath85 defined in and @xmath81 as in",
    ".    we shall proceed analogously to the proof of theorem [ thm:2 ] . for this purpose for @xmath1300",
    "we set @xmath1303 and @xmath1304 .",
    "firstly , we estimate the supremum over @xmath1305 . by lemma [ lem:6 ]",
    "we have @xmath1480 where @xmath1481 $ ] . for any @xmath1308 , by plancherel s",
    "theorem we get @xmath1482 where @xmath1483 , since the supports are effectively disjoint . using and",
    "we conclude @xmath1484 therefore , by we may estimate @xmath1485 where in the last step we have used disjointness of supports of @xmath1316 while @xmath41 varies over @xmath1486 and the fact that if @xmath1487 then @xmath1315 .",
    "we have just proven @xmath1488 next , we consider the case when the supremum is taken over @xmath1319 . for any @xmath1320 we define @xmath1489 and @xmath1490 by plancherel s theorem , for any @xmath1323 and @xmath1487 we have @xmath1491 since , by , @xmath1492 therefore , @xmath1493 because the set @xmath1486 contains at most @xmath1328 elements and @xmath1494 for sufficiently large @xmath1330 .",
    "hence , we obtain @xmath1495 in particular , @xmath1496 let us observe that the functions @xmath1333 and @xmath1334 are @xmath1335-periodic .",
    "next , by double change of variables and periodicity we get @xmath1497 thus , using proposition [ prop:2 ] and , we have @xmath1498 in the last step we have also used the disjointness of supports of @xmath1316 while @xmath41 varies over @xmath1486 .",
    "therefore , @xmath1499 which together with concludes the proof .",
    "recall from the proof of theorem [ thm:2 ] or theorem [ thm:14 ] , that for @xmath1296 @xmath1339 and @xmath1500 we show that for every @xmath1 there is a constant @xmath1218 such that for any @xmath1296 and @xmath1345 we have @xmath1501 then interpolation with will immediately imply .",
    "the proof of will consist of two parts .",
    "we shall bound separately the supremum when @xmath1343 and when @xmath1344 , see theorem [ thm:15 ] and theorem [ thm:16 ] respectively .",
    "[ thm:15 ] let @xmath1 then there is a constant @xmath1218 such that for any @xmath1296 and @xmath1341 we have @xmath1502    we set @xmath1347 and define @xmath1348 where @xmath1349 .",
    "recall that @xmath1350 is the multiplier corresponding to the averaging operator , i.e. @xmath1503 .",
    "thus we note that for each @xmath1352 $ ] we have @xmath1504 moreover , if @xmath1357 is such that @xmath1358 for every @xmath954 with some @xmath1359 and @xmath1215 , then @xmath1505 due to proposition [ pr:0 ] .",
    "we refer to the proof of theorem [ thm:7 ] for more details .",
    "let us define the multipliers @xmath1506 and observe that by we have @xmath1507 hence , arguing as in the previous section we obtain that for some @xmath1270 @xmath1508 thus in view of and we obtain @xmath1509 since @xmath1374 .",
    "the proof of theorem [ thm:15 ] will be completed if we show @xmath1510 appealing to inequality we see that @xmath1511 where @xmath1512 $ ] . in view of lemma [ lem:30 ] if suffices to show that for every @xmath1378 and @xmath637 $ ] we have @xmath1513 for any sequence @xmath1380 with @xmath1381 .",
    "let us consider the operator @xmath1382 with @xmath1514 we notice that the multiplier @xmath733 corresponds to a continuous singular radon transform .",
    "thus @xmath733 defines a bounded operator on @xmath1384 for any @xmath1385 with the bound independent of the sequence of signs @xmath1386 ( see ( * ? ? ?",
    "* section 11 ) or @xcite ) .",
    "hence , by theorem [ th:3 ] @xmath1515 and consequently we obtain and the proof of theorem [ thm:7 ] is completed .",
    "[ thm:16 ] let @xmath1 then there is a constant @xmath1218 such that for any @xmath1296 and @xmath1345 we have @xmath1516    the proof of theorem [ thm:18 ] guarantees that the sequence @xmath1517 with @xmath1518 satisfies .",
    "therefore theorem [ th:1 ] with @xmath1519 yields @xmath1520 thus in view of it only suffices to prove that for any @xmath1521 we have @xmath1522 for some @xmath1412 , where @xmath1523 and we have @xmath1524 .",
    "now observe that @xmath1525 next , we observe that @xmath1414 implies that @xmath1415 for some @xmath167 .",
    "therefore , for @xmath1526 we have @xmath1527 since @xmath1528 for sufficiently large @xmath1296 . using , we obtain @xmath1529 hence , by @xmath1530 thus , by plancherel s theorem we obtain @xmath1531 interpolating now with we obtain and this completes the proof of theorem [ thm:16 ] .",
    "this section is devoted to provide some vector - valued estimates in the continuous settings for maximal operators of radon type . to fix notation",
    "let @xmath1532 be a polynomial mapping whose components @xmath159 are real valued polynomials on @xmath124 such that @xmath11 .",
    "one of the main objects of our interest will be @xmath1533 where @xmath1534 is the euclidean ball centered at the origin with radius @xmath1535 .",
    "we prove the following .    [ thm:17 ] assume that @xmath1 then there is a constant @xmath1218 such that for every @xmath1536 we have @xmath1537 moreover , the implied constant is independent of the coefficients of the polynomial mapping @xmath20 .",
    "suppose that @xmath1538 is a caldern  zygmund kernel satisfying the differential inequality @xmath1539 for all @xmath1540 and the cancellation condition @xmath1541 we will be also interested in truncated singular radon transform @xmath1542 for @xmath1543 .",
    "[ thm:18 ] assume that @xmath1 then there is a constant @xmath1218 such that for every @xmath1536 we have @xmath1544 moreover , the implied constant is independent of the coefficients of the polynomial mapping @xmath20 .",
    "we set @xmath161 it is convenient to work with the set @xmath162 with the lexicographic order .",
    "then each @xmath159 can be expressed as @xmath163 for some @xmath1545 .",
    "let us denote by @xmath165 the cardinality of the set @xmath166 .",
    "we identify @xmath91 with the space of all vectors whose coordinates are labeled by multi - indices @xmath167 .",
    "let @xmath168 be a diagonal @xmath169 matrix such that @xmath170 for @xmath171 we set @xmath172 i.e. @xmath1546 for every @xmath156 .",
    "next , we introduce the _ canonical _ polynomial mapping @xmath174 where @xmath175 and @xmath176 .",
    "the coefficients @xmath177 define a linear transformation @xmath178 such that @xmath179 .",
    "indeed , it is enough to set @xmath180 for each @xmath181 and @xmath182 .",
    "now in view of @xcite or ( * ? ? ?",
    "* section 11 ) we can reduce the matters to the canonical polynomial mapping .",
    "thus for simplicity of notation we will write @xmath1547 and @xmath1548 .        for this purpose let @xmath1550 with compact support such that @xmath1551 and define for any @xmath1535 @xmath1552 where @xmath1553 .",
    "then it is known from the classical vector - valued maximal estimates ( see @xcite ) that      thus thanks to it remains to prove that @xmath1555 appealing to lemma [ lem:30 ] the proof of will be completed if we show that for every @xmath1 and @xmath1556 we have @xmath1557 for every @xmath1558 where @xmath1559 $ ] and @xmath1560 .    in order to prove we can assume without of loss of generality that @xmath1561 .",
    "define @xmath1562 .",
    "let @xmath1563 be a littlewood  paley projection @xmath1564 associated with @xmath1565 a smooth partition of unity of @xmath1566 such that for each @xmath1567 we have @xmath1568 and @xmath1569 and for @xmath1570 @xmath1571 note that @xmath1572 now we show that there is a constant @xmath1573 such that @xmath1574 we set @xmath1575 and @xmath1576 , where @xmath1577 and @xmath1578 is the adjoint operator to @xmath1579 and @xmath1580 respectively .",
    "now let @xmath1581 such that @xmath1582 and @xmath1583 , where @xmath1584 , and observe that by the cauchy ",
    "schwarz inequality @xmath1585 since for all @xmath1586 there is a constant @xmath1587 such that @xmath1588 for all @xmath1589 .",
    "thus we have proven that @xmath1590 now we refine the estimate and we show that there is @xmath81 such that @xmath1591 then interpolation of with will imply and the proof of theorem [ thm:17 ] will be completed .",
    "let @xmath1592 be the multipliers associated with the averages @xmath1593 and @xmath1594 respectively .",
    "then one sees that @xmath1595 hence , by plancherel s theorem and the assumption on the supports for @xmath1596 we obtain @xmath1597 as desired .      for each kernel @xmath1422 satisfying and there are functions @xmath1598 and a constant @xmath140 such that for @xmath1599 @xmath1600 where for each @xmath1567 the kernel @xmath1427 is supported inside @xmath1601 , satisfies @xmath1602 for all @xmath4 , and has integral @xmath1432 .",
    "we refer to ( * ? ? ?",
    "* chapter 6 ,  4.5 , chapter 13 ,  5.3 ) for more details .",
    "theorem [ thm:17 ] and reduce the matters to proving that for every @xmath1 there exists a constant @xmath1218 such that for every @xmath1536 we have @xmath1605 let @xmath1606 we know from @xcite that @xmath1607 let @xmath1550 with compact support such that @xmath1608 as in @xcite we decompose @xmath1609 we now observe that by and we have @xmath1610 the function @xmath1611 defines a schwartz function and for every @xmath1612 @xmath1613 thus by the classical vector - valued estimates @xcite we get @xmath1614 it remains to prove that there exists @xmath1573 such that @xmath1615 for @xmath1 , due to theorem [ thm:17 ] and we have @xmath1616 for @xmath1252 we show that there exists @xmath81 such that @xmath1617 then interpolation with will establish and the proof of theorem [ thm:18 ] will be completed .",
    "it suffices to show @xmath1618 by plancherel s theorem we see @xmath1619 as claimed , since @xmath1620 and @xmath1621 the proof of theorem [ thm:18 ] is completed ."
  ],
  "abstract_text": [
    "<S> we show @xmath0 boundedness , for @xmath1 , of discrete maximal functions corresponding to averaging operators and truncated singular integrals of radon type . we shall present a new approach which allows us to handle these operators in a unified way . </S>",
    "<S> our methods will be robust enough to provide vector - valued estimates for these maximal functions as well . </S>"
  ]
}