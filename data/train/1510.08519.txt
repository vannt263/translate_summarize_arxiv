{
  "article_text": [
    "first - principles descriptions of quasiparticle excitations in extended and large confined molecular systems are prerequisite for understanding , developing and controlling molecular electronic , optoelectronic and light - harvesting devices . in search of reliable theoretical frameworks , it is tempting to use kohn - sham density functional theory ( dft),@xcite which provides accurate predictions of the structure and properties of molecular , nanocrystal and solid state systems .",
    "however , kohn - sham dft ( ks - dft ) approximations predict poorly quasiparticle excitation energies both in confined and in extended systems,@xcite even for the frontier occupied orbital energy , for which ks - dft is expected to be exact.@xcite this has led to the development of two main first - principles alternative frameworks for quasiparticle excitations : many - body perturbation theory , mainly within the so - called gw approximation@xcite on top of dft ,  @xcite and generalized ",
    "ks dft.@xcite    recently , range - separated hybrid ( rsh ) functionals  @xcite combined with an optimally - tuned range parameter @xcite were shown to very successfully predict quasiparticle band gaps , band edge energies and excitation energies for a range of interesting _ small _ molecular systems , well matching both experimental results and gw predictions.@xcite the key element of the range parameter tuning is the minimization of the deviation between the highest occupied orbital energy and the ionization energy@xcite or the direct minimization of the energy curvature.@xcite    the use of gw and the optimally - tuned rsh ( ot - rsh ) approaches for describing quasiparticle excitations in _ extended _ systems is hampered by high computational scaling .",
    "the computational bottleneck in gw is in the calculation of the screened potential within the random phase approximation ( rpa ) while in ot - rsh it is the application of non - local exchange to each of the molecular orbitals . ot - rsh",
    "is a self - consistent method and should therefore be compared to self - consistent gw calculations ; however , the latter are extremely expensive as the self - energy operator must be applied to all dyson orbitals .",
    "recently , we proposed a stochastic formulation limited to the @xmath1 approach , where the computational complexity was reduced by combining stochastic decomposition techniques and real - time propagation to obtain the expectation value of the self - energy within the @xmath2 approximation.@xcite the stochastic gw ( _ _ s__gw ) was used to describe charge excitations in very large silicon nanocrystals ( ncs ) with @xmath3 ( @xmath4 is the number of electrons ) , with computational complexity scaling nearly linearly with the system size .",
    "similar stochastic techniques have been developed by us for dft,@xcite for embedded dft,@xcite and for other electronic structure problems.@xcite    here we develop a stochastic formalism suitable for applying the ot - rsh functionals for studying quasiparticle excitations in _ extended _ systems .",
    "the approach builds on our previous experience with the exchange operator,@xcite but several new necessary concepts are developed here for the first time .",
    "we start with a brief review of the ot - rsh approach , then move on to describe the specific elements of the stochastic approach , and finally present results .",
    "we dedicate this paper to prof .",
    "ronnie kosloff from the hebrew university to acknowledge his important contributions to the field of computational / theoretical chemistry .",
    "kosloff has been our teacher and mentor for many years and his methods , such as the chebyshev expansions and fourier grids,@xcite are used extensively in our present work as well .",
    "for a systems of @xmath4 electrons in an external one - electron potential @xmath5 having a total spin magnetization @xmath6 in the @xmath7 direction , the ot - rsh energy is a functional of the spin - dependent density matrix ( dm ) @xmath8 given in atomic units as : @xmath9 & = & tr\\left[\\rho\\left(-\\frac{1}{2}\\hat{\\mathbf{\\nabla}}^{2}+v_{ext}\\left(\\hat{\\mathbf{r}}\\right)\\right)\\right]\\\\   & + & e_{h}\\left[n\\right]+e_{xc}^{\\gamma}\\left[n\\right]+k_{x}^{\\gamma}\\left[\\rho_{\\uparrow},\\rho_{\\downarrow}\\right],\\nonumber \\end{aligned}\\ ] ] where @xmath10 is the range - parameter , discussed below , while @xmath11=\\frac{1}{2}\\iint u_{c}\\left(\\left|\\mathbf{r}-\\mathbf{r}'\\right|\\right)n\\left(\\mathbf{r}\\right)n\\left(\\mathbf{r}'\\right)d\\mathbf{r}d\\mathbf{r}'\\ ] ] is the hartree energy functional of the density @xmath12 and @xmath13 is the coulomb potential energy .",
    "@xmath14 $ ] is the unknown @xmath10dependent exchange - correlation energy functional which in practical applications is approximated .",
    "the non - local exchange energy functional is given by @xmath15=-\\frac{1}{2}\\sum_{\\sigma=\\uparrow,\\downarrow}\\iint u_{c}^{\\gamma}\\left(\\left|\\mathbf{r}-\\mathbf{r}'\\right|\\right)\\left|\\rho_{\\sigma}\\left(\\mathbf{r},\\mathbf{r}'\\right)\\right|^{2}d\\mathbf{r}d\\mathbf{r}',\\ ] ] where @xmath16 .",
    "this choice of @xmath17 accounts for long - range contributions to the non - local exchange energy and thus dictates a complementary cutoff in the _ local _ exchange - correlation energy , @xmath14 $ ] , to avoid over - counting the exchange energy.@xcite    when the exact @xmath14 $ ] functional is used , minimizing @xmath18 $ ] with respect to @xmath19 under the constraints specified below leads to the exact ground - state energy and electron density @xmath20 . for approximate @xmath14 $ ] approximate estimates of these quantities are obtained . to express the constraints we first require the spin - dependent dm to be hermitian and thus expressible as : @xmath21 where @xmath22 and @xmath23 are its eigenvalues and orthonormal eigenfunctions .",
    "the constraints are then given in terms of the eigenvalues @xmath24 as : @xmath25    @xmath26    @xmath27    the necessary conditions for a minimum of @xmath18 $ ] is that @xmath23 obey the generalized ks equations : @xmath28 where @xmath29 are the spin - dependent eigenvalues of the generalized ks hamiltonian ( @xmath30 and @xmath31 ) given by : @xmath32 note that the dm and its eigenstates minimizing the energy functional @xmath18 $ ] are themselves @xmath10dependent and are thus denoted by @xmath33 , @xmath34 ; the dm eigenvalues are not @xmath10dependent , as shown below .",
    "the one - electron hamiltonian @xmath35 contains the kinetic energy , a local potential in _ @xmath36_space @xmath37 and a non - local exchange operator @xmath38 .",
    "the local @xmath36space potential is further decomposed into three contributions : @xmath39 where @xmath40}{\\delta n\\left(\\mathbf{r}\\right)}=\\int n\\left(\\mathbf{r}\\right)u_{c}\\left(\\left|\\mathbf{r}-\\mathbf{r}'\\right|\\right)d\\mathbf{r}'$ ] is the hartree potential and @xmath41}{\\delta\\rho_{\\sigma}\\left(\\mathbf{r},\\mathbf{r}\\right)}$ ] is the short - range exchange - correlation potential .",
    "the non - local exchange operator @xmath42}$ ] is expressed by its operation on a wave function @xmath43 of the same spin as : @xmath44    in this work we consider closed shell systems where @xmath45 and @xmath46 where @xmath47 is the number of electron pairs , i.e. , the level number of the highest occupied orbital . in this case , as in hartree  fock theory and dft , the dm eigenvalues @xmath24 which minimize @xmath18 $ ] are @xmath48 if @xmath49 and 0 otherwise.@xcite hence , these conditions are used _ a - priori _ as constraints during the minimization of @xmath18 $ ] .",
    "however , for the tuning process the ensemble partial ionization of an up - spin ( or down - spin ) electron needs to be considered .",
    "thus , these values for @xmath22 are still used except for @xmath50 and @xmath51 where @xmath52 is fixed to be a _ _ positive fraction ( i.e. , the negative of the overall charge of the system , @xmath53 ) during the minimization of the gks ensemble energy @xmath18 $ ] ( for clarity , we abbreviate @xmath54 for the frontier orbital energy ( @xmath55 ) and occupation ( @xmath56 ) ) .",
    "we note in passing that tuning is often done by combining a linearity condition from the @xmath57 electron system.@xcite we leave this for future work , and state that it can be done along the same lines as described here for the @xmath58 electron system .",
    "the optimally - tuned range - parameter @xmath10 is determined from the requirement that the highest occupied generalized ks orbital energy @xmath59 is independent of its occupancy @xmath60 : @xmath61 through janak s theorem  @xcite this equation implies that the energy curvature @xmath62 is zero . in practical terms , eq .",
    "is solved by a graphical root search as shown in fig .",
    "[ fig : gamma ] and discussed below .",
    "in real - space or plane - waves implementations the application of the hamiltonian @xmath63 on a single particle wave function involves a pair of fast fourier transforms ( fft ) to switch the wave function between @xmath64space where the kinetic energy is applied and @xmath36space for applying the potential energy.@xcite therefore , for a grid of @xmath65 grid - points the operational cost is @xmath66 .",
    "the ks hamiltonian operation scales quasi linearly with system size .",
    "the scaling is much steeper for the rsh hamiltonian because the non - local exchange operator @xmath38 applies @xmath4 coulomb convolution integrals , each of which is done using an fft of its own thus involving @xmath67 operations .",
    "therefore , the gks hamiltonian operation which scales quasi - quadratically is much more time consuming than the ks hamiltonian .",
    "our approach , described next , reduces significantly the operation cost and even lowers the scaling due to the reduction of @xmath68 as the system size grows .",
    "we first express the occupations in the dm in eq .   as a combination of a occupations of a closed - shell density matrix and a remnant due to the overall charge of the molecule , @xmath69 ( assuming @xmath70 ; this separation reduces the stochastic error later when the charge of the system is continuously varied , as needed for the optimal tuning .",
    "thus :    @xmath71    where @xmath72 is the frontier orbital being charged and @xmath69 is the amount of charge .",
    "when tuning the neutral system @xmath73 is the homo and it is being positively charged ( electrons removed from homo ) so @xmath74 .",
    "when tuning for the anion @xmath75 is the lumo and the system being negatively charged ( electrons are added to the lumo ) so @xmath76 .",
    "we assume without loss of generality that the spin of the charge frontier orbital is up .",
    "next we evaluate the first term on the rhs of eq .   using stochastic orbitals : @xmath77",
    "where @xmath78 is a projected - stochastic orbital described in terms of the eigenstates of @xmath79 ( which can be alternatively obtained using a chebyshev expansion of the relevant projection operator  @xcite ) : @xmath80 and @xmath81 is a stochastic orbital with a random sign ( @xmath82 ) at each grid - point .",
    "( note that application of eq .",
    "is itself a quadratic step however it is a `` cheap '' step as it is done only once in each scf iteration . ) with this , eq .",
    "is rewritten as : @xmath83 @xmath84 next , we address the convolution in the random part of the above expression , by rewriting the range - separated coulomb potential as @xmath85 where @xmath86 , @xmath87 is the fourier transform of @xmath88 , and @xmath89 is a random phase between @xmath90 and @xmath91 at each @xmath64space grid point .",
    "this can be seen by inserting the definition of @xmath92 into eq .   and using the identity @xmath93}\\right\\rangle _ { \\varphi}=\\left(2\\pi\\right)^{3}\\delta\\left(\\mathbf{k}-\\mathbf{k}'\\right)$ ] .",
    "( see appendix  [ sec : the - k=00003d0-term ] for the treatment of the @xmath94 term ) .",
    "the non - local exchange operation is finally written as :    @xmath95    @xmath96    in actual applications we use a finite number @xmath97 of pairs of stochastic orbitals @xmath98 and thus : @xmath99 the @xmath92 s are calculated once and stored in memory while the @xmath78 s are generated on the fly .",
    "the computational scaling of the non - local exchange operation on @xmath43 is thus @xmath100 ( vs. @xmath67 for the deterministic case ) .",
    "typically , @xmath101 and @xmath102 and thus , the operation of the stochastic non - local exchange becomes comparable in terms of computational effort to that of operating with the kinetic energy , so the computational cost of applying the gks hamiltonian is similar to that of the ks hamiltonian .",
    "the new method has been implemented using the bnl functional  @xcite for a series of hydrogen passivated silicon nanocrystals of varying sizes : @xmath103 , @xmath104 @xmath105 , @xmath106 and @xmath107 with real - space grids of @xmath108 , @xmath109 , @xmath110 , @xmath111 and @xmath112 grid - points , respectively .",
    "we solve the generalized ks equations fully self - consistently using the chebyshev  filtered subspace acceleration  @xcite to obtain the occupied and low lying unoccupied eigenfunctions and eigenvalues .",
    "the curvature for the different ncs , estimated from a forward difference formula @xmath113 with @xmath114 , is plotted as a function of @xmath10 in fig .",
    "[ fig : gamma ] .",
    "the curvature is a decreasing function of @xmath10 and has a node at the optimal value of the range parameter @xmath68 . for each",
    "nc the curvature results are shown for several values of the number of stochastic orbitals @xmath97 .",
    "we find that the statistical fluctuations near @xmath68 become smaller as the system grows and can be reduced with proper choice of @xmath97 .",
    "for example , for the larger system the results near @xmath68 can be converged with only @xmath115 compared to the total number of occupied states for this system which is @xmath116 .",
    "the reduction of these fluctuations is partially due to the decrease of @xmath68 itself as the nc size increases ( this decrease is shown in the right panel of fig .  [",
    "fig : gamma ] ) , leading to a smaller contribution of the non - local exchange to the orbital energies .",
    "the results in the right panel of the figure also show that @xmath68 closely follows a linear function of @xmath117 .",
    "we expect that for larger ncs with @xmath118 , this linear relation will break down and the optimal range parameter will converge to the bulk value , which through reverse engineering  @xcite can be estimated as @xmath119 ( shown as a horizontal dotted line ) . such a localization - induced by the exchange has been seen for 1d conjugated polymers  @xcite but not for bulk solids like silicon , likely due to the enormity of the calculation .    in fig .",
    "[ fig : nchi ] we plot the highest occupied molecular orbital ( homo , left panel ) and lowest unoccupied molecular orbital ( lumo , right panel ) energies obtained from the relations  @xcite @xmath120}{\\partial c}\\right|_{c\\to0^{+}}\\nonumber \\\\ \\varepsilon_{l,\\uparrow } & = & -\\left.\\frac{\\partial e_{rsh}^{\\gamma}\\left[\\rho_{\\uparrow},\\rho_{\\downarrow}\\right]}{\\partial c}\\right|_{c\\to0^{-}}\\label{eq : orbital - energies}\\end{aligned}\\ ] ] respectively , as a function of @xmath97 at @xmath68 .",
    "we find that determining the homo and lumo energies using the above first derivative relations reduces the noise compared to obtaining their values directly from the eigenvalues .",
    "clearly @xmath121 and @xmath122 converge as @xmath97increases",
    ". moreover , as the system size increases the fluctuations in @xmath121 and @xmath122 decreases for a given value of @xmath97 , consistent with the discussion above .",
    "this is evident from the plot of the differences between the frontier orbital energies at adjacent values of @xmath97 .",
    "= lower panel : comparison of the homo and lumo energies obtained using the _ _",
    "s__gw approach ( black triangles ) and the stochastic rsh within the bnl functional ( red asterisk ) for a series of silicon nanocrystals .",
    "the cyan diamond represent the deterministic rsh within the bnl functional .",
    "upper panel : the corresponding quasiparticle band gaps .",
    "also shown is the dft result within the lda ( blue circles ) .",
    ", title=\"fig:\",width=302 ]    in the lower panel of fig .",
    "[ fig : qp ] we plot the converged ( with respect to @xmath97 ) homo and lumo energies at @xmath68 for the series of silicon ncs . for the smallest system ( @xmath123 )",
    "we compare the stochastic approach developed here with a deterministic rsh calculation using a non - local exchange with all occupied orbitals and obtaining the coulomb convolution integrals with ffts , thereby eliminating any source of statistical error . the purpose it to show that when the stochastic results are converged the agreement with a deterministic calculations is perfect on a relevant magnitude of energy .",
    "we find that the homo energy increases and the lumo energy decreases with the size of the nc .",
    "this is consistent with our recent calculations on silicon ncs using the stochastic gw approach , albeit the fact that there is a small shift in the quasi - particle energies obtained from the stochastic rsh approach compared to the _ _ s__gw .",
    "indeed , a similar shift has been reported previously for much smaller silicon ncs.@xcite however , the source of this discrepancy is not clear , particularly , since the gw calculations were done within the so called _",
    "@xmath124 _ limit , and",
    "the ot - rsh often provides better quasiparticle energies in comparison to experiments.@xcite in the upper panel of fig .",
    "[ fig : qp ] we plot the fundamental ( quasiparticle ) gaps . here , the agreement with the _ _",
    "s__gw approach is rather remarkable , especially compared to the lda results which significantly underestimate the quasiparticle gap across all sizes studied .",
    ".[tab : convergence - with-]optimally - tuned bnl frontier orbital energies and computational times @xmath125 vs. number of stochastic orbitals @xmath97 for two ( medium and large ) silicon clusters .",
    "values for lda are also given for comparison .",
    "as the system size grows , @xmath125 for the optimally - tuned bnl decreases relative to the lda timings due to decrease of @xmath68 . [ cols=\"^,^,^,^,^,^,^\",options=\"header \" , ]     \\(a ) @xmath126    \\(b ) @xmath127    \\(c ) in cpu - hrs    in table  [ tab : convergence - with- ] we provide numerical details of the calculations for the smallest and largest nc studied .",
    "we report the results for the homo and lumo orbital energies for two different choices of @xmath128 comparing these two values we can conclude that the statistical errors for the lumo are very small ( @xmath129  ev ) for the largest nc and even the homo has small errors of around @xmath130  ev .",
    "moreover , similar or even larger statistical errors are observed for the smaller nc for much larger values of @xmath97 , indicating that for a given accuracy the number of stochastic orbitals decreases with the system size .",
    "this is partially correlated with the reduction of @xmath68 with the system size , as discussed above .",
    "we have developed a stochastic representation for the non - local exchange operator in order to combine real - space / plane - waves methods with optimally - tuned range - separated hybrid functionals within the generalized kohn - sham scheme .",
    "our formalism uses two principles , one is a stochastic decomposition the coulomb convolution integrals and the other is the representation of the density matrix using stochastic orbitals . combining these two ideas leads to a significant reduction of the computational effort and , for the systems studied in this work , to a reduction of the computational scaling of the non - local exchange operator , at the price of introducing a statistical error .",
    "the statistical error is controlled by increasing the number of stochastic orbitals and is also found to reduce with the system size applications to silicon ncs of varying sizes show relatively good agreement for the band - edge quasiparticle excitations in comparison to a many - body perturbation approach within the _ _ s__gw approximation and excellent agreement for the fundamental band gap .",
    "the stochastic approach has a major advantage over the @xmath131gw by providing a self - consistent hamiltonian which is central for post - processing , for example in conjunction with a real - time bethe ",
    "salpeter approach.@xcite the results shown here for @xmath3 and @xmath132 are the largest reported so far for the optimally - tuned range - separated generalized kohn - sham approach .",
    "r. b. and e. r. gratefully thank the israel science foundation ",
    "first program ( grant no .",
    "1700/14 ) .",
    "r.b . gratefully acknowledges support for his sabbatical visit by the pitzer center and the kavli institute of the university of california , berkeley .",
    "d. n. and e. r. acknowledge support by the nsf , grants che-1112500 and che-1465064 , respectively .",
    "for accelerating convergence , it turns out to be better to remove the @xmath133 term from the the random vector expression representing the interaction , i.e. , @xmath134 this is because in practice the @xmath135term is very large .",
    "analytically , this term is easily shown to commute with the fock hamiltonian and simply contribute a constant ( times the occupation ) to the eigenvalues and to the total energy , so it can be added a - posteriori : @xmath136"
  ],
  "abstract_text": [
    "<S> we develop a stochastic formulation of the optimally - tuned range - separated hybrid density functional theory which enables significant reduction of the computational effort and scaling of the non - local exchange operator at the price of introducing a controllable statistical error . </S>",
    "<S> our method is based on stochastic representations of the coulomb convolution integral and of the generalized kohn - sham density matrix . </S>",
    "<S> the computational cost of the approach is similar to that of usual kohn - sham density functional theory , yet it provides much more accurate description of the quasiparticle energies for the frontier orbitals . </S>",
    "<S> this is illustrated for a series of silicon nanocrystals up to sizes exceeding @xmath0 electrons . </S>",
    "<S> comparison with the stochastic gw many - body perturbation technique indicates excellent agreement for the fundamental band gap energies , good agreement for the band - edge quasiparticle excitations , and very low statistical errors in the total energy for large systems . </S>",
    "<S> the present approach has a major advantage over one - shot gw by providing a self - consistent hamiltonian which is central for additional post - processing , for example in the stochastic bethe - salpeter approach . </S>"
  ]
}