{
  "article_text": [
    "historically , the design and optimization of ion optical systems has been performed by means of computer programs in which the precise specification of the system is entered and its optical properties , such as beam envelopes or transfer matrix coefficients , are obtained as output .",
    "probably the most famous software of this kind is the program transport @xcite , which is still widely used nowadays .",
    "these tools have been developed over many years , and although several of them have been modernized to follow the evolution of computer environments , they often retain legacy features of the early days . the lack of interactivity in particular , due to the mode of entering the description of the system via a file , makes the process of exploration and optimization very tedious .    for all but",
    "the most simple systems , finding an optical solution fulfilling a set of predefined constraints is equivalent to a multi - dimensional minimization problem .",
    "this type of problem often displays multiple local minima in which a minimization algorithm can easily get trapped , depending on the variational path or method used .",
    "this means practically that the solution found by the algorithm is often highly dependent on the initial conditions at the start of the minimization process . as a result ,",
    "finding a configuration close enough to the desired solution becomes a crucial task , which can not be performed by the machine .",
    "the program tuner was designed to make this task more effective as well as more intuitive , by taking advantage of the computing power and graphic tools available today .",
    "therefore , this program is intended as a design tool used to try out new ideas or explore new optical solutions of an existing design , rather than a simulation tool trying to calculate the characteristics of an optical system as accurately as possible .",
    "several programs are already available for this last task , such as cosy infinity @xcite for instance , that can be used to optimize and simulate a design once its gross characteristics have been laid out , from an accurate knowledge of the elements involved and the possibility to calculate high order terms of the transfer matrix .",
    "the next section presents the calculations as well as the framework on which the program is based , followed by a description of how to perform the design and optimization processes of an optical system .",
    "finally , some examples of existing systems and how to explore their optical possibilities are given , prior to the conclusion .",
    "the program tuner was developed and written within the framework of the data analysis and visualization software igor pro@xmath0 ( wavemetrics , inc . ,",
    "oregon , usa ) @xcite .",
    "the choice of this particular environment is motivated by several features offered by this package .",
    "the first and foremost is the ability to create interactive graphics to display the characteristics of the system programmatically .",
    "since all features and functions offered by igor pro@xmath0 can be used to build customized macros , displaying the configuration and characteristics of the system can be done easily in a few lines of code . as an example ,",
    "[ envelopes ] shows a typical envelope plot obtained for a quadrupole triplet tuned in point - to - point focussing .",
    "the graphics tools provided in igor pro@xmath0 are well adapted to the generation of such a plot , not only because they allow to easily draw the envelopes themselves as well as the elements present in the system , but also because all graphs are dynamically updated whenever the underlying data is changed .",
    "this feature is essential to this application , to provide an instant visual feedback to the user while adjusting parameters .    secondly , the library of mathematical and data processing functions provided in igor pro@xmath0 greatly simplified and shortened the development time of this program . of the numerous functions available , the tuner program uses extensively the matrix algebra and manipulation functions , as well as the optimization and minimization algorithms .",
    "since these functions are already compiled in machine code in igor pro@xmath0 , the speed of execution is the maximum possible .",
    "this means for instance that the envelope and ray plots can be recalculated instantly whenever any parameter of the system is changed , providing a `` live '' mode essential when looking for an approximate solution manually .",
    "thirdly , the possibility to create customized graphical user interfaces ( gui ) means that users do nt need to learn how to use igor pro@xmath0 itself , because all necessary actions are available from the customized tuner control panel .",
    "this feature gives great flexibility to tailor the interface for the particular needs of the application , and shortens the learning curve of the users .",
    "finally , the software igor pro@xmath0 is available for both macintosh@xmath0 and windows@xmath0 platforms , covering the majority of personal computers .",
    "users are required to purchase a license in order to use this program , and academic pricing is available for scholars and students ( see http://www.wavemetrics.com[www.wavemetrics.com ] ) .",
    "the coordinate system used in tuner is the usual 6-dimensional space defined as horizontal position @xmath1 and angle @xmath2 , and their vertical counterparts @xmath3 and @xmath4 , path length @xmath5 and fractional momentum deviation @xmath6 . although @xmath7 and @xmath8 are called angles , strictly speaking they are in fact the tangents of these angles , but for the small angles usually under consideration in optical systems the difference is negligible .",
    "the units of these coordinates are meters and radians for positions and angles respectively , meters for the path length and parts or 1 for the fractional momentum deviation .",
    "this last unit simply means that a fractional momentum deviation of 1% corresponds to 0.01 in parts .    at the design and early optimization stages of an optical system , only first order optics",
    "are usually considered , because they determine the gross characteristics of the system .",
    "the first order transfer matrix of the most common elements found in beam lines are well known @xcite .",
    "these include drift space , magnetic quadrupoles and dipoles , as well as solenoids .",
    "the program calculates the first order transfer and envelope ( also called beam or sigma ) matrices along the optical system , by multiplying the individual matrices of each element .",
    "more formally , the coordinate vector @xmath9 at location @xmath10 is obtained from the coordinate vector @xmath11 at location @xmath12 following the relation : @xmath13 where the 6x6 transfer matrix @xmath14 is obtained from the multiplication of all matrices from a to b : @xmath15 assuming there are @xmath16 elements between @xmath12 and @xmath10 .",
    "similarly , the beam matrix @xmath17 is obtained following the relation : @xmath18 from the set of transfer and beam matrices rays and envelopes can be plotted along the optical system .",
    "in addition , particular locations along the beam line can be specified and are labeled viewers .",
    "these viewers are typically located at dispersive or focal planes , and allow the user to inspect the characteristics of the optical system , such as the transfer and envelope matrices , or the shapes of the beam ellipses .",
    "finally , fitting constraints can be inserted anywhere in the system , and are used to define the desired properties of the optical system at various locations . although not required , it is usually desirable to group fitting constraints close - by viewers , so that the properties of the system can be inspected upon attempting to satisfy the fitting conditions .",
    "finally , the characteristics of the beam propagated into the system is always defined as the first element of a given system .",
    "the program allows the user to specify the sizes of the beam ellipse in all dimensions , as well as the value of the magnetic rigidity ( denoted as @xmath19 ) of the reference particle , and optionally the orientation of the beam ellipse in both horizontal and vertical planes .",
    "these parameters are denoted @xmath20 and @xmath21 for these two planes respectively , and correspond to the off - diagonal elements @xmath22 and @xmath23 of the beam matrix .",
    "in addition , it is possible to use the last beam matrix of a given system as the start of another .",
    "this feature gives the user the flexibility to divide a large system into smaller sub - systems , thereby easier to display and optimize , while retaining the full calculation .",
    "the design of an optical system can be thought of as an iterative process , during which the designer goes back and forth between altering the design and fitting the required constraints of the system .",
    "the most common parameters that are used to fit the constraints are the strengths of the lenses . however , and especially in the early phases of a design , it is often desirable to be able to vary other parameters , such as the length of quadrupoles or pole face angle of dipoles , in order to attain the desired characteristics of the system .",
    "the program tuner allows the user to vary most of the parameters of the supported elements .",
    "fitting locations can be defined along the system , and are usually placed right after a set of constraints . these can be enabled or disabled , so that the elements for which varying parameters enter in the fitting function go only until an enabled fit location is encountered .",
    "this feature can greatly reduce the cpu time spent in the fitting by limiting the fitting iteration to a partial section of beam line .",
    "individual varying parameters and constraints can also be enabled or disabled to the same effect , but using the fitting locations is much more convenient and keeps the choices of varying parameters and constraints in the sections unaffected by the fit untouched .",
    "the fitting function is formed from the sum of all enabled constraints , each of them being specified by a desired target value and a tolerance .",
    "the tolerance is used to specify the desired weight and directly affects the level of accuracy obtained in the fit .",
    "both transfer and beam matrix elements can be used to define the constraints .",
    "the fitting function is similar to a @xmath24 minimization function and has the form : @xmath25 where the @xmath26 and @xmath27 are the matrix elements and their desired target values respectively , and the @xmath28 are the tolerances .",
    "several fitting algorithms are available in igor pro@xmath0 , both to calculate the next step and the matrix of second derivatives ( also called hessian ) .",
    "the default algorithms are the line search and secant methods for the next step and second derivatives , respectively .",
    "other possibilities are the dogleg and more - hebdon algorithms for the next step determination , and the finite differences algorithm for the second derivatives .",
    "the fitting of multivariate functions is a notoriously difficult task in computing .",
    "most problems arise when the function is either under - constrained or over - constrained .",
    "when under - constrained , the minimization function usually exhibits a large number of minima , which makes it difficult to find the lowest minimum as the algorithm will tend to fall into the local minimum closest to the starting point . on the other extreme , when over - constrained the algorithm fails to find a",
    "minimum and usually diverges . in principle choosing a number of constraints equal to the number of varying parameters should ensure proper behavior of the minimization function .",
    "however , in all but the simplest cases both parameters and constraints can be correlated within their own spaces and it becomes very difficult to track the real dimensionality of the two spaces and make them more or less equal",
    ". a good example of such correlation could be the length and pole tip field of a quadrupole magnet , both of which directly affect the focusing length in almost the same way .",
    "add to this the possibility to adjust the tolerance of each fitted parameter , and very quickly the best method to find a particular solution mostly relies on trial - and - error combined with experience . having a tool such as",
    "the program described in this paper which allows users to quickly change the starting point and try various fitting combinations becomes a great asset .",
    "although the goal of this article is not a comprehensive description of the program ( a manual is available for that purpose ) , a short description of the key features is necessary to illustrate its capabilities and the advantages of using this tool for optics design and optimization .",
    "the subsequent sections will follow the steps taken by a typical user in designing and entering a particular beam line , study its behavior and optimize some of its parameters for a particular purpose .",
    "figure [ maingui ] shows the main setup panel used to manage beam line designs .",
    "it is possible to enter a design either manually using the simple editing tools provided in the panel ( ) , or by importing an already existing transport file ( ) . in this latter case",
    ", the program will parse the file and create the appropriate elements in the beam line . some additional editing",
    "might be necessary depending on the information contained in the original transport file .",
    "the beam line configuration currently selected as indicated in is displayed in the list box , which lists the various elements starting from the beam definition .",
    "the detailed parameters of each element are displayed in .",
    "note that several contiguous elements can be selected and used with the editing tools .",
    "this facilitates the entering of configurations composed of identical sections , as is often the case . the `` live '' button in",
    "can be used to disable the automatic updating of the envelope or ray plots while entering or adjusting the parameters of the various elements , which can cause calculation errors when they are not defined properly .",
    "the alternative method is to close all windows displaying dynamically the current configuration .",
    "apart from the standard elements found in beam lines , the program tuner introduces `` viewer '' and `` fit '' elements that can be placed anywhere within the configuration .",
    "a viewer element is used to visualize the transfer , beam and inverse matrices as well as the beam ellipses and their parameters .",
    "the fit elements break the configuration into subsections that can be fitted separately .",
    "it is usually placed after a set of constraints that define the fitting criteria , although any enabled constraint located between two enabled fit elements is taken into the minimization function as well .",
    "figure [ a1900 ] shows the envelope plot obtained from reading the standard transport file of the a1900 fragment separator @xcite , and adding the fit elements at the appropriate locations ( a viewer element is automatically created for each drift found in the transport file with its length set to zero ) .",
    "figure [ a1900 ] also shows the top panel located above the envelope plot , that is used to control lens elements ( quadrupoles or solenoids ) , open viewer displays or trigger fitting .",
    "a = @xmath29 50 mrad , @xmath30b = @xmath29 40 mrad , and @xmath30d = @xmath29 3 % . ]",
    "sliders corresponding to lens elements appear in the top panel whenever they are selected in the element list ( see in fig .",
    "[ maingui ] ) .",
    "they can be used to manually adjust each selected lens to alter the optics of the beam line .",
    "the main purpose of this functionality is to enable an easy manual exploration of optical configurations .",
    "as the sliders are moved , the envelope and ray plots are updated , as are any viewer displays currently open .",
    "the variation range of the sliders is taken from the variation limits imposed on the strength of the lens elements ( see section [ varlim ] ) . note in the figure that the sliders for quadrupole triplets 5 , 6 and 7 are grayed out , indicating that these lenses are coupled to others located upstream .",
    "the standard a1900 optics uses a symmetric configuration for all quadrupole triplets but the first and last ones , due to the shorter length on the production target side .",
    "the symmetry around the dispersive focal plane at viewer z59 is readily visible on fig .",
    "[ a1900 ] .",
    "as the strength is moved on a lens , any other that is coupled to it tracks its value simultaneously .    while adjusting individual lenses , it is often helpful to watch the evolution of the transfer or beam matrices .",
    "this is easily done by opening any of the viewer displays .",
    "an example of a viewer display of the transfer matrix at the dispersive image ( z59 ) is shown in fig .",
    "[ a1900matrices ] .",
    "this matrix shows the double focus conditions as well as the dispersion of -5.91 cm/% at this location .",
    "the numbers are dynamically updated as the optical configuration is being altered .",
    "the viewer displays also feature tabs to view the sigma and inverse matrices , as well as plots of the horizontal and vertical emittances , together with their associated parameters .",
    "in addition , a menu located at the top left corner of the envelope plot top panel can be used to plot matrix elements along the beam line .",
    "although only one matrix element can be displayed at a time , a direct visualization of its evolution as optical elements in the beam line are being adjusted is often a better guide than the numbers displayed in the matrix .      as an illustration of the possibilities of this program",
    ", one could imagine tuning the a1900 fragment separator in a configuration in which the horizontal and vertical angular sizes of the beam can be constrained using slits at locations z59 and z37 .",
    "the standard configuration can not be used for this purpose because both z37 and z59 are dispersive images where focussing conditions are realized in both horizontal and vertical planes , and momentum dispersion is non - zero . the procedure used to achieve",
    "a particular optical configuration involves an iterative process in which the user goes back and forth between manual adjustment of the lenses , and fitting of their strengths to fulfill a number of constraints . in the particular case of an angle - cutting configuration ,",
    "the goal is to configure the optics to leave only the angle dependent position matrix elements ( y / b ) and ( x / a ) non - zero at z37 and z59 , respectively .",
    "when these conditions are realized , the horizontal and vertical positions are determined by the respective angles at the object , and any position cut translates directly into a cut in angle .",
    "the constraints used for this particular configuration are listed in table [ constraints ] .",
    ".list of constraints used in the optimization of the angle cutting configuration calculated for the first two sections of the a1900 fragment separator .",
    "the locations correspond to labeled viewers along the beam line .",
    "the vertical and horizontal angle cutting slits are located at z37 and z59 , respectively , with a coefficient of -1 mm / mrad .",
    "the horizontal dispersion is set to 0 at z37 , and the third triplet is a mirror image of the second , in order to achieve a doubly achromatic condition at z59 ( both ( x / d ) and ( a / d ) equal to 0 ) . [ cols=\"^,^,^\",options=\"header \" , ]     the constraints located in the middle of the first dipole d1 are meant to control the envelope in both horizontal and vertical planes , in particular with regards to the vertical gap .",
    "the vertical angle cutting condition is realized at z37 by setting ( y / y ) to 0 , and fixing the angle cutting coefficient ( y / b ) to -1 mm / mrad .",
    "this choice is of course arbitrary , and other solutions with a different coefficient are possible . the horizontal dispersion ( x / d ) is constrained to 0 in order to realize a doubly achromatic condition at z59 ( both ( x / d ) and ( a / d ) equal to 0 ) . together with the third triplet which is a mirror image of the second",
    ", this constraint effectively cancels the dispersions after the second dipole d2 .",
    "this is necessary in order to setup good conditions for the horizontal angle cutting at z59 , for which no horizontal dispersion should be present .",
    "there are six quadrupole lenses available to adjust the five constraints between the object and the z37 location , therefore several solutions are possible , making the fitting highly dependent on the starting conditions . however , not all solutions may be acceptable , in particular with regards to the angular and momentum acceptances .",
    "this is where the manual adjustment of lenses can be efficiently guided by the direct feedback provided by the program .",
    "it is possible to approach an approximate solution in this way , that is suitable as a starting point for the fitting of the required constraints .",
    "using the save sets , the user can easily store and recall configurations before and after fitting in case the fit failed or found a minimum that is not satisfactory .",
    "different starting conditions can be stored in different save sets . as it is both an exploratory and iterative process , different ideas",
    "can easily be attempted to achieve the configuration goals . as the number of iterations is limited to 100 in the minimization algorithm , it is possible , in particular when fitting in large dimensional space such as the 6 quadrupole strengths in this example , that the fitting stops before reaching a minimum .",
    "the minimization might also stop if no gradient is found , indicating that a local minimum was reached .",
    "to escape this type of situation , a noise parameter is provided that will nudge the starting values before attempting the next minimization .",
    "this parameter as well as the value of the fitting function are displayed in the fit element details , therefore the user can quickly assess the quality of the fit and restart the minimization until it reaches a satisfactory minimum .    the control of which parameters of optical elements are allowed to vary during the fitting procedure is illustrated in fig .",
    "[ elementsetting ] , for the case of a quadrupole lens .    ) .",
    "checkboxes are used to select which parameter(s ) are varied by the minimization algorithm .",
    "they also control which parameter(s ) are varying when the selected element is coupled to an other one upstream .",
    "entries and are the lower and upper limits for each parameter , used both as soft boundaries by the fitting algorithm , and as limits for the sliders .",
    "the radio buttons are used to select the parameter controlled by the slider , allowing parameters other than the strength in lenses to be adjusted graphically . ]",
    "note that the parameters that can be adjusted are not limited to the strength of lenses , which is the usual choice when exploring optical possibilities of an existing beam line , but to others as well . with this capability",
    "this program can be used in the design phase of ion optical systems as well , and options or limitations related to the sizes and dimensions of elements used in the design can be explored in a very straightforward way .",
    "the envelope plot of a possible angle cutting configuration of the a1900 fragment separator , based on the constraints listed in table [ constraints ] and the symmetries built into the configuration , is displayed in fig .",
    "[ a1900angle ] .",
    "also drawn is the horizontal dispersion ( x / d ) along the beam line , its scale being displayed on the right hand side of the plot .",
    "the mirror symmetry of the a1900 is used from the z59 location to set the remaining quadrupole triplets , with the exception of the last one for which a slightly different tune is calculated to achieve double focussing at the focal plane fp .",
    "a = @xmath29 40 mrad , @xmath30b = @xmath29 20 mrad , and @xmath30d = @xmath29 3 % . ]",
    "the first order transfer matrices calculated at z37 and z59 for this configuration are @xmath31\\ ] ] and @xmath32\\ ] ] respectively .",
    "this type of optics could be used for instance in an attempt to produce secondary beams with a large proportion of spin polarization , by selecting a particular region of the transverse momentum distribution produced by the projectile fragmentation process .",
    "earlier studies have shown that significant spin polarization can be observed on the tails of these distributions @xcite .",
    "this paper presents a short overview of the program tuner , a new computing tool aimed at facilitating and accelerating the design and optimization of ion optical systems .",
    "this program calculates first order optics of beam line configurations dynamically , taking advantage of present - day computing speed and graphical interface frameworks .",
    "its main advantage is the possibility to quickly explore the usually vast parameter space typically found in ion optical systems , and select the best design or tuning parameters for achieving its goals .",
    "this can be achieved thanks to the ability to easily select a particular starting point before letting the optimization algorithm search for the closest minimum corresponding to a set of constraints .",
    "although the primary use of this program is to explore configurations of existing ion optical systems , it can also be used as a design tool to optimize the physical parameters of conceptual systems , a first and necessary step before full simulation programs can be used to further characterize the performances and limitations . at the other end of the user spectrum",
    ", this program can also be an efficient educational tool for students or individuals learning beam optics . as a complementary material to textbooks and courses",
    ", the program tuner allows users to experience directly the effect of beam line elements on the optics of a system , giving them a more intuitive feel on how to tune them correctly and achieve particular configurations .",
    "one could even envision using this tool for problem assignments in a class .",
    "the features demonstrated in this paper correspond to the version available at the time of this writing , however further improvements and future additional features are envisioned .",
    "probably the most useful feature would be the addition of second order effects that can be calculated analytically .",
    "together with the addition of sextupoles , this improvement would enable more realistic calculations of the envelopes , as well as the possibility to minimize the effects of these aberrations .",
    "other important characteristics of ion optical systems are their acceptances .",
    "even though the program tuner gives an overall measure of the acceptances by tracing the beam envelope along the beam line and showing where it intercepts any of the physical limits of the elements , a more rigorous approach should use a random simulation of rays , keeping only those that can pass through the system .",
    "this type of monte - carlo simulation can easily be implemented in tuner using the igor pro@xmath0 framework .",
    "finally , this tool could be used as an online visualization of the optics of a running device , using for instance the widely used epics protocol to communicate real field values from the magnets to the program .",
    "an epics driver for igor pro@xmath0 is already available for that purpose .",
    "a set of theory - to - reality ratios could be used to normalize the calculation to a known tune of the device , in order to compensate for inaccuracies in the physical definition of the beam line , as well as effects not included in the calculation .",
    "the program tuner is available from the following web page : http://www.nscl.msu.edu/~bazin//tuner[www.nscl.msu.edu/@xmath33bazin/tuner ] .",
    "the tuner package contains a data file containing the predefined beam line configurations shown in this article , and that can be used as examples , as well as a detailed manual and the igor pro@xmath0 procedure files themselves . keeping these procedure files",
    "separate from the data files ensures that any update of the code is carried over to all data files . as with any kind of software , bugs and unforeseen error conditions always happen , and it is the hope of the author that users can report their findings and voice their suggestions so that the program can improve over time .",
    "users that want to be notified of new versions or updates should send a brief email to the author ."
  ],
  "abstract_text": [
    "<S> designing and optimizing ion optical systems is often a complex and difficult task , which requires the use of computational tools to iterate and converge towards the desired characteristics and performances of the system . </S>",
    "<S> very often these tools are not well adapted for exploring the numerous degrees of freedom , rendering the process long and tedious , as well as somewhat random due to the very large number of local minima typically found when looking for a particular optical solution . </S>",
    "<S> this paper presents a novel approach to finding the desired solution of an optical system , by providing the user with an instant feedback of the effects of changing parameters . </S>",
    "<S> the process of finding an approximate solution by manually adjusting parameters is greatly facilitated , at which point the final tune can be calculated by minimization according to a number of constraints .    </S>",
    "<S> ion optics , beam line design , numerical optimization , graphical interface 42.15.eq , 41.85.-p , 41.75.-i , 41.85.lc </S>"
  ]
}