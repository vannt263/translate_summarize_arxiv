{
  "article_text": [
    "development of state - of - the - art numerical methods in plasma physics is set firmly on a course towards structure - preserving algorithms , and for an important reason .",
    "it is well known that integration of hamiltonian systems with non - structure - preserving methods leads to numerical dissipation and , possibly , to false interpretation of the simulation results .",
    "for example , non - structure - preserving discretization of ideal mhd can lead to solutions that display reconnection , and tracing the full larmor motion of charged particles with standard runge - kutta methods can lead to false changes in the orbit topologies .",
    "naturally , one would prefer the discretizations to preserve the properties the continuous systems posses .    for many of the purely hamiltonian or variational systems in plasma physics , recent research",
    "has indeed provided structure - preserving discretization methods  @xcite . yet",
    "dissipative effects reside on a largely uncharted territory : the _ structure _ , as it is understood for hamiltonian or variational systems , is not that well understood for general dissipative systems .",
    "exceptions do exist and , considering coulomb collisions , the landau collision integral  @xcite can , in fact , be described in terms of a symmetric _ metric _ bracket  @xcite .",
    "unfortunately , it is not clear yet how this specific bracket should be discretized to preserve the underlying structural properties .    until an appropriate discretization of the metriplectic formulation",
    "is discovered , one could consider using a discrete version of the _ lagrange - dalembert principle _ to embed a discrete landau collision integral into structure preserving discretizations of the vlasov - maxwell system .",
    "furthermore , as finite - element and discontinuous galerkin methods are receiving increasing attention for addressing the vlasov - maxwell part of the kinetic system , we find it appealing to study how these two methods would adapt to the landau collision integral .    the result we provide in this paper is a proof that discretization of the nonlinear landau collision integral , either with the standard finite - element or discontinuous galerkin method , indeed guarantees exact discrete conservation laws for density , momentum , and energy . as we shall show , the only requirement is to retain the landau s original integral formulation and not resort to the rosenbluth - macdonald - judd potential formulation  @xcite : while the potential formulation is efficient in decreasing the numerical burden of evaluating the collision integral from @xmath0 down to @xmath1 , it simultaneously destroys numerical conservation laws so that artificial modification of the collision integral is necessary  @xcite .",
    "although we focus purely on formulating an algorithm that delivers machine - precision conservation laws , we also note that the @xmath0 part of the algorithm belongs to the class of _ embarassingly parallel problems_. we thus expect our algorithm to scale well on highly vectorized platforms and , indeed , the feasibility of a ( different ) @xmath0-algorithm has already been demonstrated  @xcite .",
    "the rest of the paper is following : the landau collision integral and its properties are reviewed in section  [ sec : collision_integral ] .",
    "the discretization , together with an algebraic proof of the related conservation laws , is detailed in section  [ sec : discretization ] . in section  [ sec : axial_symmetry ] , the claimed properties are demonstrated numerically for an axially symmetric relaxation problem , and a summary of the results is given in section  [ sec : summary ] .",
    "for clarity , we consider the like - species collisions , while the results generalize for multi - species collisions as well .",
    "next , we review the explicit form of the collision integral , normalize it to dimensionless variables , and discuss the collisional invariants .      under small - angle dominated coulomb collisions , the evolution of the distribution function @xmath2 in velocity space @xmath3 is determined by the integro - differential equation  @xcite @xmath4 here @xmath5 can be considered a reference collision frequency , @xmath6 is the coulomb logarithm , @xmath7 and @xmath8 are the charge and mass , and @xmath9 is the momentum - per - rest - mass .",
    "the quantities with an overbar are evaluated at @xmath10 .    the landau tensor @xmath11 , valid at non - relativistic energies , is a scaled projection matrix of the relative velocity @xmath12 between the colliding particles : @xmath13 in the relativistic case , the correct expression for the tensor @xmath11 was derived by beliaev and budker  @xcite @xmath14",
    "where @xmath15 , @xmath16 , @xmath17 , @xmath18 , and @xmath19 is the speed of light . in the limit @xmath20",
    ", the beliaev - budker tensor @xmath21 reduces to landau tensor and the relativistic momenta , normalized to the rest mass , reduce to the non - relativistic expressions for velocities .",
    "although the focus of this paper is the nonrelativistic limit , we will show that standard finite - element or discontinuous galerkin discretization of the relativistic collision integral will lead to exact density and momentum conservation while exact energy conservation would require development of a completely new set of basis functions .      in numerical applications",
    ", one should always work in dimensionless variables to prevent accumulation of floating point errors .",
    "this is achieved by defining @xmath22 and @xmath23 with @xmath19 some positive constant denoting a reference velocity . in the relativistic case @xmath19",
    "would naturally denote the speed of light but for the nonrelativistic case , it can be considered arbitrary , e.g. , the thermal velocity .",
    "obviously , @xmath24 , @xmath25 are not to be misunderstood as the configuration space variables .",
    "the velocity - space gradients and differential volume elements transfrom according to @xmath26 while the tensor @xmath27 transforms according to @xmath28 further , we normalize time according to @xmath29 so that the normalized landau integral equation becomes @xmath30      without loss of generality , we define a domain @xmath31 and require that @xmath32 vanishes at the boundary @xmath33 . additionally , the normal component of the velocity - space flux @xmath34 is required to vanish at the boundary @xmath33 , to satisfy density conservation",
    ". obviously , both these conditions are true if @xmath31 is chosen to be @xmath35 . in numerical implementations",
    "the domain @xmath31 must , however , be finite and , thus , we use @xmath31 as an arbitrary domain for now .    if we now multiply eq.([eq : landau ] ) with a function @xmath36 , and integrate over the domain @xmath31 and apply the boundary conditions , we find @xmath37 upon rearranging the integration order , one obtains @xmath38 for @xmath39 , the above expression obviously vanishes .",
    "further , @xmath40 vanishes for both the non - relativistic energy @xmath41 ( with @xmath27 the landau tensor ) and the relativistic energy @xmath42 ( with @xmath27 the beliaev - budker tensor @xmath21 ) , due to the properties of the tensor @xmath27 .",
    "thus , the quantities @xmath43 for @xmath44 are referred to as _ collisional invariants_.",
    "one of the challenges in discretizing the landau operator is to preserve the collisional invariants that exist for the continuous operator .",
    "here we prove that discretization of the weak formulation @xmath45 with either finite - element or discontinuous galerkin methods succeeds in this feat . while we provide the explicit proof for the full three - dimensional velocity - space operator , the result holds true also for the axisymmetric or spherically symmetric cases .",
    "we also note that weak discretization of the multispecies collision operator similarly satisfies the related conservation laws .",
    "finite_-dimensional vector space @xmath46 spanned by the set @xmath47 and approximate @xmath48 according to @xmath49 denote also @xmath50 for convenience .",
    "define the vector- and tensor - valued functionals @xmath51(\\tau,\\bm{x})&=\\sum_{\\ell}f_{\\ell}(\\tau)\\bm{k}_{\\ell}(\\bm{x}),\\\\ \\mathbf{d}[f](\\tau,\\bm{x})&=\\sum_{\\ell}f_{\\ell}(\\tau)\\mathbf{d}_{\\ell}(\\bm{x})\\end{aligned}\\ ] ] in terms of the vectors @xmath52 and the tensors @xmath53 @xmath54 substitute @xmath55 and @xmath56 into eq .",
    "( [ eq : normalized - weak - form ] ) to obtain the discretized time - continuous weak formulation @xmath57\\;f_{j},\\ ] ] where the coefficients matrices are defined @xmath58&=\\int_{\\omega } d\\bm{x}\\;\\nabla\\lambda_i\\cdot\\left(\\bm{k}[f]\\;\\lambda_j-\\mathbf{d}[f]\\cdot\\nabla\\lambda_j\\right),\\end{aligned}\\ ] ] since the discrete weak form  ( [ eq : fem_weak_nonlinear ] ) is to hold for arbitrary functions @xmath59 , we obtain the following nonlinear system of ordinary differential equations for the degrees - of - freedom @xmath60 @xmath61\\;f_{j},\\qquad \\forall i.\\ ] ]      if the vector space @xmath46 is chosen so that the functions @xmath62 are included in @xmath46 exactly , i.e. , @xmath63 , the weak discretization will automatically satisfy the conservation laws .",
    "consider the time rate of change of @xmath36-moment of the numerical distribution function @xmath55 .",
    "as long as @xmath36 belongs to @xmath46 exactly , we can write @xmath64\\;f_{j}.\\ ] ] let us then assume that a quadrature rule is used to approximate integrals over the domain @xmath31 , with weights @xmath65 and points @xmath66",
    ". the vector @xmath67f_j$ ] can then be evaluated as @xmath68f_j=\\sum_{j , q}w_qf_j\\nabla\\lambda_i(\\bm{\\xi}_q)\\cdot\\big(\\bm{k}[f](\\bm{\\xi}_q)\\lambda_j(\\bm{\\xi}_q)\\\\-\\mathbf{d}[f](\\bm{\\xi}_q)\\cdot\\nabla\\lambda_j(\\bm{\\xi}_q)\\big).\\end{gathered}\\ ] ] the expressions for @xmath69 $ ] and @xmath70 $ ] at the points @xmath66 are obtained using the same quadrature rule @xmath51(\\bm{\\xi}_q)&=\\sum_{\\ell , p}\\;w_p\\;\\mathbf{u}(\\bm{\\xi}_q,\\bm{\\xi}_p)\\cdot\\nabla\\lambda_{\\ell}(\\bm{\\xi}_p)f_{\\ell},\\\\ \\mathbf{d}[f](\\bm{\\xi}_q)&=\\sum_{\\ell , p}\\;w_p\\;\\mathbf{u}(\\bm{\\xi}_q,\\bm{\\xi}_p)\\lambda_{\\ell}(\\bm{\\xi}_p)f_{\\ell},\\end{aligned}\\ ] ] and , when substituted to the expression for @xmath67f_j$ ] , we find @xmath71f_{j}\\nonumber\\\\ & = \\sum_{j\\ell , pq}\\;w_pw_qf_{\\ell}f_j\\nabla\\lambda_i(\\bm{\\xi}_q)\\cdot\\mathbf{u}(\\bm{\\xi}_q,\\bm{\\xi}_p)\\nonumber\\\\ & \\qquad\\cdot\\big(\\nabla\\lambda_{\\ell}(\\bm{\\xi}_p)\\lambda_j(\\bm{\\xi}_q)-\\lambda_{\\ell}(\\bm{\\xi}_p)\\nabla\\lambda_j(\\bm{\\xi}_q)\\big).\\end{aligned}\\ ] ] since this expression is antisymmetric with respect to changing @xmath72 and @xmath73 , we obtain @xmath74f_{j}\\nonumber\\\\ & = \\frac{1}{2}\\sum_{ij\\ell , pq}\\;w_pw_qf_{\\ell}f_j\\phi_i\\big(\\nabla\\lambda_i(\\bm{\\xi}_q)-\\nabla\\lambda_i(\\bm{\\xi}_p)\\big)\\nonumber\\\\ & \\qquad\\cdot\\mathbf{u}(\\bm{\\xi}_q,\\bm{\\xi}_p)\\cdot\\big(\\nabla\\lambda_{\\ell}(\\bm{\\xi}_p)\\lambda_j(\\bm{\\xi}_q)-\\lambda_{\\ell}(\\bm{\\xi}_p)\\nabla\\lambda_j(\\bm{\\xi}_q)\\big).\\end{aligned}\\ ] ] the exact conservation laws then follow trivially since @xmath75 vanishes identically for @xmath76 .    here",
    "we wish to note that , in the nonrelativistic limit , the energy @xmath41 is a polynomial , and can be exactly expressed with piecewise polynomials of order 2 .",
    "thus a standard finite - element or discontinuous galerkin method will have no trouble satisfying the conservation laws . in the relativistic case ,",
    "the energy @xmath42 is , however , not a polynomial and can not be exactly presented by piecewise polynomials of any order .",
    "thus , standard finite - element or discontinuous galerkin method will not achieve exact energy conservation in the relativistic case , although one could still expect the error to converge at the order of the basis functions .",
    "although our purpose is not to focus on the time discretization  it should be chosen consistently with the discretization of the vlasov - maxwell part  the ordinary differential equation for the degrees - of - freedom will be nonlinear and stiff due to the presence of both advective and diffusive components , necessitating implicit time discretization and iterative methods . here",
    "we comment on the importance of solving the nonlinear time - discrete equation exactly .",
    "consider eq .",
    "( [ eq : dofs ] ) and assume we solve it using implicit euler .",
    "denote @xmath77 so that @xmath78 the time discrete equation for the degrees - of - freedom then becomes @xmath79\\;f^{(k)}_{j},\\qquad \\forall i.\\ ] ] assume then that the iterative method provides us with a solution vector @xmath80 that satisfies @xmath81\\tilde{f}_{j}+\\epsilon_i , \\quad \\forall i\\ ] ] where @xmath82 is the residual from the iteration .",
    "for the collisional invariants @xmath83 , we then have @xmath84 the exactness of the conservation properties for the discretized collision operator thus depends only on the accuracy of the nonlinear solve .",
    "for demonstration purposes we consider the relaxation of a nonrelativistic axially symmetric bi - maxwellian distribution function @xmath85,\\end{gathered}\\ ] ] using cylindrical coordinates @xmath86 that relate to cartesian coordinates according to @xmath87 . for the computational domain",
    "we choose @xmath88 with @xmath89 .",
    "the parameter @xmath90 is chosen so that the initial distribution @xmath32 can be considered negligible at the dirichlet boundary @xmath91 .",
    "for the velocity - space discretization , we choose quadratic p2-lagrange elements , while time is discretized with the crank - nicolson method .",
    "the resulting nonlinear system is solved with newton iteration , using a numerical estimate for the system jacobian matrix . because we do not have an exact linearization of the jacobian we only observe linear convergence in the newton iteration , with a residual reduction rate of 0.16 for this specific problem .",
    "the mesh is generated with the open - source ` gmsh `  @xcite software , and the rest of the implementation is carried out within the ` petsc `  @xcite framework , using ` petsc plex ` for the finite - element operations and ` petcs snes ` for the nonlinear solver .",
    "the axially symmetric weak formulation is detailed in the appendix and the source code for the test problem , written in ` c ` , will be made available online through ` git ` .",
    "the time evolution of the distribution function is illustrated in fig .",
    "[ fig : evolution ] , for six different time instances , while the evolution of momentum and energy are quantified in tables  [ tbl : momentum ] and  [ tbl : energy ] for different nonlinear solver tolerances .",
    "the bi - maxwellian distribution relaxes towards an equilibrium state in a qualitatively correct manner and , if the tolerance for the nonlinear solve is set to machine precision , energy and momentum are conserved to machine precision .",
    "otherwise the errors in energy and momentum accumulate through time with a rate that correlates with the nonlinear solver tolerance .    [",
    "cols=\"<,<,<,<\",options=\"header \" , ]",
    "we have presented an algorithm for conservative discretization of the nonlinear landau collision integral .",
    "we have provided both algebraic and numerical proof for achieving exact numerical conservation laws using either discontinuous galerkin or standard finite - element method .",
    "our method is not constrained by details of the discretization , admitting the use of structurized as well as unstructurized meshes .",
    "we have also argued that in the relativistic case , a polynomial basis of any order is not able to guarantee exact conservation of energy while density and momentum would be conserved even with linear basis functions .",
    "future study will investigate the embedding of our discrete landau operator to the vlasov - maxwell system using either the concept of lagrange - dalembert principle or extended lagrangians  @xcite .",
    "another future study will focus on performance demonstrations .",
    "the work presented here was carried out as part of the simulation center for runaway electron mitigation and avoidance efforts .",
    "eh was supported by the department of energy contract no .",
    "de - ac02 - 09ch11466 .",
    "the authors feel greatful for the patience prof .",
    "matthew knepley sustained while providing answers to all of our questions related to the use of ` petsc ` .",
    "using cylindrical coordinates @xmath86 , that relate to cartesian coordinates according to @xmath87 , and assuming axially symmetric vector space @xmath46 , i.e. , @xmath92 and @xmath93 , the weak formulation can be written @xmath94 where the friction and diffusion coefficients are @xmath95 and the coefficients @xmath96 and @xmath97 are defined @xmath98 the expressions @xmath99 are the contravariant basis vectors for the curvilinear coordinate system .",
    "for the nonrelativistic case , the angular integrals of @xmath100 are easily computed . defining a parameter @xmath101",
    "the exact expressions are @xmath102 where the integrals @xmath103 are defined @xmath104 and can be expressed in terms of the complete elliptic integrals @xmath105 $ ] and @xmath106 $ ] according to @xmath107-(1+s)e\\left[\\frac{2s}{1+s}\\right]\\right),\\\\ { \\cal i}_2(s)&=\\frac{2}{(1-s)\\sqrt{1+s}}e\\left[\\frac{2s}{1+s}\\right],\\\\ { \\cal i}_3(s)&=\\frac{2}{(1-s)s\\sqrt{1+s}}\\left(e\\left[\\frac{2s}{1+s}\\right]-(1-s)k\\left[\\frac{2s}{1+s}\\right]\\right)\\end{aligned}\\ ] ]              hong qin , jian liu , jianyuan xiao , ruili zhang , yang he , yulei wang , yajuan sun , joshua  w. burby , leland ellison , and yao zhou .",
    "canonical symplectic particle - in - cell method for long - term large - scale simulations of the vlasov - maxwell equations .",
    ", 56(1):014001 , 2016 .",
    "satish balay , shrirang abhyankar , mark  f. adams , jed brown , peter brune , kris buschelman , lisandro dalcin , victor eijkhout , william  d. gropp , dinesh kaushik , matthew  g. knepley , lois  curfman mcinnes , karl rupp , barry  f. smith , stefano zampini , hong zhang , and hong zhang .",
    "c web page .",
    "http://www.mcs.anl.gov/petsc , 2016 .",
    "satish balay , shrirang abhyankar , mark  f. adams , jed brown , peter brune , kris buschelman , lisandro dalcin , victor eijkhout , william  d. gropp , dinesh kaushik , matthew  g. knepley , lois  curfman mcinnes , karl rupp , barry  f. smith , stefano zampini , hong zhang , and hong zhang .",
    "c users manual . technical report anl-95/11 - revision 3.7 , argonne national laboratory , 2016 ."
  ],
  "abstract_text": [
    "<S> we describe a density , momentum , and energy conserving discretization of the nonlinear landau collision integral . our algorithm is suitable for both the finite - element and discontinuous galerkin methods and does not require structured meshes . </S>",
    "<S> the conservation laws for the discretization are proven algebraically and demonstrated numerically for an axially symmetric nonlinear relaxation problem . </S>"
  ]
}