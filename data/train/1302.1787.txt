{
  "article_text": [
    "solar flares are the most extravagant examples of rapid energy release in the solar system , with the largest releasing around @xmath2 on a timescale of hours @xcite .",
    "this energy , imparted to the plasma confined along coronal magnetic loops of active regions , is distributed between kinetic , thermal , and radiative process in some way that may vary from flare to flare .",
    "while the ultimate source of this energy is likely stresses introduced by convective motion of the plasma at and below the photosphere , we believe the direct source is the conversion of free magnetic energy : magnetic energy in excess of the active region s potential magnetic field energy .    as has been clear for many decades , active regions consist of bundles of flux tubes , concentrated prior to their emergence through the photosphere @xcite .",
    "the free energy builds up as the flux tubes forming an active region are stressed at the photospheric boundary , where plasma forces dominate field evolution ( plasma @xmath3 , with @xmath4 the gas pressure ) . moving outward from the solar surface into the corona",
    ", the plasma pressure rapidly diminishes and magnetic forces dominate , until a third regime is reached where plasma forces once again dominate . as noted by @xcite , even within an active region",
    ", the high @xmath5 portion of the upper corona may occur as low as @xmath6 above the solar surface .",
    "we are primarily concerned with lower laying loops and magnetic domains and so will assume a low @xmath5 regime . barring any reconfiguration of the coronal field , the active region s",
    "magnetic domains are pushed into a highly nonpotential state .",
    "relaxation towards a potential field configuration through magnetic reconnection then allows for the conversion of magnetic free energy into kinetic and thermal energy through , e.g. , field line shortening , shock formation , electron acceleration , or ( possibly ) ion acceleration @xcite",
    ".    the number of quantitative estimates of this energy buildup using observations has recently increased , but results remain varied .",
    "nonlinear force  free models ( nlff : * ? ? ?",
    "* ; * ? ? ?",
    "* ) have received much attention during the past decade , strongly driven by both increases in computing power and the arrival of vector magnetograms from space  based telescopes onboard hinode ( sot / sp ) and sdo ( hmi ) .",
    "while these models are a promising avenue of research , they come with their own set of problems , as discussed in @xcite .",
    "the lower boundary conditions are , in general , incompatible with the force ",
    "free assumption @xcite .",
    "several methods exist to overcome this difficulty @xcite , leading to different energy estimates for a single vector magnetogram , even when using a single extrapolation code@xcite .",
    "a further problem is that the models amount to a series of independent fields at consecutive timesteps . at each time",
    ", a new nlff field is generated from the boundary data , uninformed by the solution from the previous timestep .",
    "contrasting with this are flux transport and magneto  frictional models , which do include a memory @xcite .",
    "these methods primarily focus on the global coronal response to active region emergence , destabilization , and eruption as opposed to the detailed analysis of processes within an active region , which is the topic of this investigation @xcite .",
    "one reason for this is that the coronal portion of these models evolve the large  scale mean field using an induction equation with an effective magnetic diffusivity @xcite , so that the formation of fine  scale current sheets is beneath their resolution .",
    "most dynamical simulations without magnetic diffusion show a tendency toward fine layers @xcite .",
    "we describe the coronal field using the magnetic charge topology ( mct ) model @xcite at each time .",
    "the system is described by a set of unipolar regions .",
    "the distribution of magnetic flux between each pair of oppositely signed regions defines the system s connectivity . as the active region evolves its connectivity will generally change . to relate each time with the next ,",
    "we employ the minimum current corona model ( mcc : * ? ? ?",
    "* ; * ? ? ?",
    ". by itself , mct describes only potential fields , which contain no current .",
    "the mcc introduces currents , and the resulting energetics , into the mct model by asserting that the coronal field move through a series of flux constrained equilibria ( fce ) . in that case",
    ", the connectivity of the real field will be different from the potential field s connectivity .",
    "one shortcoming of the mcc method as currently used is its inability to account for violation of these flux constraints , which are the topological manifestations of reconnection and the resulting energy release .",
    "previous studies @xcite have therefore only reported the total free energy difference between the mcc and a potential field configurations .",
    "our goal here is to relax those flux constraints at any timestep , while also allowing the system to continue evolving thereafter . in this way , we may model multiple reconnection events for a single active region .",
    "we present here a method for identifying the magnetic domains activated in successive flares based on observations of flare ribbons in the aia 1600  channel .",
    "this allows us to separately calculate the free energy available to each successive , nonhomologous flare .",
    "if we further assume that all magnetic flux topologically capable of transferring during a reconnection event does transfer , then we may also estimate the actual energy release during a flare .    in the following sections",
    ", we will describe the data used (  [ sec : data ] ) , our methods for modeling the photospheric and coronal fields (  [ sec : model ] ) , how one may estimate the mcc free energy based on those models (  [ sec : energy ] ) , and the use of observations of flare ribbons to determine those domains activated in successive flares (  [ sec : ribbons ] ) .",
    "we will conclude with a discussion of the results of our analysis (  [ sec : disc ] ) .",
    "to construct the mcc model of magnetic field evolution we use a series of 250 line  of  sight ( los ) magnetograms taken by the helioseismic and magnetic imager ( hmi : * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) onboard the solar dynamics observatory ( sdo ) .",
    "the data are at a 24 minute cadence between feb .",
    "11 2011 08:10:12 ut and feb .",
    "15 11:46:12 ut , and are taken from the jsoc ( level @xmath7 ) data series .",
    "the region considered , noaa ar11158 , produced the first goes x  class flare of solar cycle 24 , and has therefore already been analyzed in a variety of ways by numerous authors ( see * ? ? ? * and references therein ) .",
    "in addition we have used images of flare ribbons observed with atmospheric imaging assembly ( sdo / aia ) in the 1600  channel @xcite .",
    "we obtained three sets of 1600  images via the ssw cutout service maintained by lockheed martin for @xmath8 during each flare with peak magnitude greater the m1.0 : an m6.6 flare peaking at feb 13 , 17:28 ; m2.2 peaking at feb 14 , 17:20 ; and x2.2 flare peaking at feb 15 , 01:44 .",
    "all aia data were prepared to level @xmath7 using the standard routine in solarsoftwareidl .",
    "we coalign each set of aia 1600  images to the magnetogram closest to the peak time of each flare . to do so , we rotate the first aia image in a sequence to the time of the magnetogram .",
    "it so happens that the 75 g contour of hmi los magnetograms ( after assuming a radial field and correcting for pixel foreshortening , discussed below ) outlines the bright network patches in the 1600  band .",
    "we shift the aia image , by eye , until the contour and bright network patches align .",
    "this could be automated by a cross  correlation between the magnetogram contour and a corresponding contour in aia , but we have not yet implemented this procedure .",
    "the aia timesets are internally aligned , so we apply the same by  eye offset to each image in the sequence , after shifting each by solar rotation to the time of the chosen magnetogram .",
    "the hmi magnetograms contain known ( but as yet unmodeled ) diurnal variations , due to the velocity of the spacecraft s orbit @xcite .",
    "the amplitude of the variations is around @xmath9 of the unsigned flux within an active region .",
    "we are concerned with flux emergence trends over the course of days , over which time the effects of these variations should largely cancel .",
    "we simply accept this as an additional source of error in our model .",
    "we apply the methods described in @xcite and references therein to generate the magnetic modeling for this series of events .",
    "the analysis splits into two sections , detailed below .",
    "first , we characterize the photospheric field by partitioning the observed magnetograms into a set of unipolar regions .",
    "pairs of oppositely  signed regions @xmath10 may be linked through emergence when each region s flux increases between two timesteps .. algorithmically , there is no distinction between these processes .",
    "if any of a pole s flux change between two timesteps can not be paired with another region , it is formally paired with a source of opposite sign located at infinity .",
    "] at each time @xmath11 , the amount of flux change of each pairing is recorded in a photospheric  field  change matrix @xmath12 .",
    "this set of matrices is therefore a time history of the flux with which each region emerged with every other region .    in the second part of our analysis",
    ", we develop a topological model of coronal domains immediately prior to each major flare .",
    "our flux emergence matrix discussed above is the real flux in each coronal domain , which we may compare to the flux in each domain in a potential field extrapolation .",
    "the difference between the two is the nonpotentiality of each domain .",
    "the equilibrium with minimum magnetic energy that still includes this difference in domain fluxes , called the flux constrained equilibrium ( fce ) , contains current sheets on each of its separators @xcite .",
    "our topological model determines the location of all current sheets within the active region complex , the strength of each related to the nonpotentiality of its associated domains .",
    "finally , this provides us with an estimate of the energy in the fce , which is itself a lower bound on the magnetic free energy stored in the actual magnetic field .      to characterize the photospheric field , we first convert each line of sight ( los ) pixel to vertical by assuming a radial field and account for reduced flux due to pixel foreshortening dividing the flux in each pixel by @xmath13 , where @xmath14 is the polar angle from disk center .",
    "we smooth our data by extrapolating the vertical field to a height of @xmath15 as detailed in @xcite , and reduce noise by ignoring any pixels below a @xmath16 threshold .",
    "pixels above this threshold are partitioned using the downhill tessellation algorithm of @xcite , creating a _",
    "mask_. each pixel is assigned an integer , and contiguous groups of like  signed pixels of the same integer compose a _",
    "region_. pixels below our threshold belong to no region and are assigned a mask value of 0 .",
    "this tessellation scheme can generate thousands of small regions at each timestep , so adjacent regions of like polarity are merged when the saddle point value of the magnetic field between them is less than @xmath17 .",
    "finally , we exclude any region whose total flux is less than @xmath18 .",
    "this process is carried out at each timestep , independently .",
    "we call the resulting set of masks a _ mask array_. regions in one timestep are associated with those in the surrounding timestep first by a bidirectional association between timesteps , and then applying the and algorithms , described in detail in @xcite .    the focus of these methods is to distinguish between regions of flux that emerge from below the photosphere at different times and in different places , and to keep track of these individual regions as they undergo shear motion on the solar surface after emergence . to this end , after the automatic algorithms listed above have run to convergence , we manually shift the boundaries between regions to ensure we consistently track flux emergence and migration over the entire timeseries .",
    "we allow individual regions to emerge , submerge , change shape , translate , split , and merge . to further reduce the number of regions , we exclude regions which have non  zero flux for fewer than 5 timesteps ( @xmath19 ) .",
    "number of distinct positive , negative , and total mask regions at each time.,scaledwidth=48.0% ]    figure [ fig : sources ] shows the number of mask regions of each polarity over the entire timeseries . in our final analysis",
    ", we track 118 regions for @xmath20 hrs .",
    "the number of distinct regions at any time varies between 10 and 35 , generally growing at a steady rate as the active region complex emerges between 2011 - 02 - 11t08:10:12 and 2011 - 02 - 14t16:10:12 , then dropping slightly as the fully emerged system continues to concentrate shows that for ar11158 , neither polarity is consistently or significantly more fragmented than the other .",
    "this contrasts with observations of most other active regions , where the leading polarity is substantially more concentrated than the trailing .",
    "this can show up in mct models as the leading polarity s flux distributed amongst fewer poles than that trailing polarity .",
    "this does not seem to be the case for ar11158 , which we find curious , although it does not affect our analysis . ] .",
    "four examples of the los magnetogram overlaid with masks are shown in figure [ fig : partition ] .",
    "the top four images are each a single frame from an animation of the full 250 timesteps viewable in supporting media in the online journal .",
    "arrows indicate the chronological sequence .",
    "below the magnetograms is a full  disk integrated goes x  ray curve @xmath21 over the course of the time series , with vertical lines showing the times of the four magnetograms .        in preparation for the transition to an mct  mcc analysis of the system , we represent each distinct region as a magnetic point source , or _ pole _",
    ", in the local tangent plane at each timestep . for consistency from timestep to timestep",
    ", our point of tangency at each time is taken as the center of charge at the initial timestep , migrated through solar rotation to the present timestep .",
    "pole @xmath22 at time @xmath11 is defined by its associated region s total flux @xmath23 and flux  weighted centroid @xmath24 : @xmath25 the vertical magnetic field @xmath26 accounts for both line  of  sight effects , by assuming a radial field , and pixel foreshortening , as described above . to reduce the effects of noise in our masking algorithms , we additionally smooth the flux in each region over the four day series by convolution with a 9 timestep ( 3.2 hour ) boxcar function , using edge truncation . for instance",
    ", pole @xmath22 s flux at time @xmath27 is averaged to @xmath28 .",
    "the resulting smoothed fluxes are shown in figure [ fig : sflux ] for regions that have @xmath29 at any timestep in the series .",
    "discontinuous jumps , for instance around 65 hrs , indicate merging , in this case p37 into p3 .",
    "this occurs when the distinction between separately emerged regions becomes ambiguous .",
    "smoothed flux in each region having at least @xmath30 at some time.,scaledwidth=50.0% ]    it is evident from viewing the full animation associated with magnetograms in figure [ fig : partition ] that the active region complex emerges in several distinct episodes .",
    "the complex has two distinct primary locations of flux emergence : one to the north , which leads another to the south by about @xmath31 .",
    "the first emergence episode is ongoing at the beginning of our timeseries , at which point several smaller emerged regions are still consolidating ( eg . , n3/n5 in the south ; n1/n2/n6 , and p1/p6 in the north ) .",
    "the second episode begins around our 60th timestep ( 30 hrs from t=0 ) , on feb .",
    "12th at 16:00ut , and continues very steadily until timestep 80 ( t=60 hrs , feb .",
    "13th , 20:00 ) . at this time , the northern emergence ceases , while it appears that the southern emergence continues , possibly in repeated @xmath32 bursts . these bursts may be an artifact of the daily variations in hmi s reported flux , noted above .",
    "signed flux in the northern ( solid blue ) and southern ( solid black ) emergence zones .",
    "dashed lines show total signed flux in north ( black ) , south ( blue ) , and all ( red ) regions , as well as the combination of northern negative with southern positive regions .",
    "this readily shows the northern and southern emergence regions undergo two distinct emergence patterns.,scaledwidth=50.0% ]    figure [ fig : f - imbal ] shows the evolution of signed flux in those regions belonging to the northern emergence ( blue ) , southern emergence ( black ) , and a set of surrounding quiet sun ( network ) regions that drifted above our thresholds at various times ( purple ) .",
    "of the 118 regions tracked over the timeseries , 54 belonged to the north ( 36 positive , 18 negative ) , 37 the south ( 13 positive , 24 negative ) , and 27 external to the active region complex ( 13 positive , 14 negative ) .",
    "dashed lines in the figure show the flux imbalance for each of the three sets , and also the flux imbalance of the total system ( green ) .",
    "note that qualitatively , the northern regions undergo a very different emergence evolution compared to the southern regions .",
    "this is easily seen with the dashed red line , which shows the total signed flux of the complex s central region : northern negative flux summed with southern positive flux .",
    "the system s connectivity is defined by the amount of flux connecting each pole to every other pole @xcite .",
    "this constitutes a _ graph _ , where each pole is a vertex and each domain an edge , with the weight of each edge given by the domain flux .",
    "the total flux of a single pole is the summed weight of all edges connected to it , and the total flux of the system of poles is the summed weight of all edges in the graph .",
    "if there is an overall imbalance of flux , the remainder must be connected to a source located ( formally ) at infinity .",
    "in general , a pair of vertices may be connected by more than one edge , and are then called multiply connected .",
    "we have found several such instances of multiply connected vertices in ar11158 , though we show below that , in this case , their effect on the system s energetics is negligible .",
    "in determining the distribution of flux emergence within the active region , we use the method of @xcite to define a connectivity graph for the flux difference between consecutive timesteps .",
    "this change must come in pairs , as positive and negative poles emerge and submerge together .",
    "the total flux change between times @xmath11 and @xmath33 for a single pole @xmath22 is given by eq .",
    "( 4 ) of @xcite @xmath34 where @xmath35 describes any shift in the boundary between like  signed region @xmath36 adjacent to @xmath22 and @xmath12 describes any change in the photospheric field itself .",
    "the former is a graph with edges connecting like signed regions of opposite flux change ( flux that one region loses , another gains ) , while the latter is a graph connecting opposite signed regions with same sensed flux change . the algorithms for determining these are fully described in @xcite . to accurately deal with the two regions of emergence",
    ", we first calculate the matrix @xmath37 for northern and southern regions separately , then combine the two resulting connectivity graphs .",
    "finally , we allow for connections between north and south using any remaining flux change .",
    "we may quantify our success at capturing the flux ",
    "change processes by reconstructing the total flux of a region using its initial flux and elements of the surface change matrix . at time @xmath11",
    ", we estimate a region @xmath22 s flux as @xmath38 . summing these reconstructed fluxes over a set of like  signed regions connected by internal boundaries , say all the positive flux in the southern emergence zone , should represent the total emergence of the collected regions .",
    "we find that our method always underestimates this emergence . over the entire time series",
    ", we find a maximum discrepancy of between @xmath39 and @xmath40 , depending on the group we reconstruct ( northern positive , northern negative , southern positive , southern negative ) .",
    "we believe this conservative attribution of flux change to emergence or submergence processes stems from a greedy boundary  change algorithm , asymmetries in the concentration of newly emerged positive and negative flux , and the diurnal variations due spacecraft motion , noted above .",
    "this forces the attribution of @xmath41 of flux change to emergence ( or submergence ) with sources formally at infinity .",
    "finally , we note that there is quite a bit of variation in our underestimate of emerging flux .",
    "our algorithm has the greatest underestimate when reconstructing the northern positive flux emergence regions .",
    "while at one point it is only able to pair up @xmath42 of the actual flux change , it spends fully half of all timesteps able to pair at least @xmath43 of the flux change .",
    "the flux change formally paired with sources at infinity generally rises over the timeseries , and peaks at @xmath44 of the total instantaneous unsigned flux 12 hours before the m6.6 flare , then varies between @xmath45 for the rest of the series , ending 10 hours after the x2.2 flare .",
    "this variation is consistent with the @xmath46 daily variation in unsigned flux found by @xcite .",
    "the flux change assigned to sources at infinity at the times of the m6.6 , m2.2 , and x2.2 flares are @xmath47 , @xmath48 , and @xmath49 of the instantaneous unsigned flux , respectively .",
    "having quantified the connectivity graph for flux change , we may use the topological methods of @xcite to calculate the free energy stored in coronal fields . at every timestep we determine the potential field connectivity matrix , @xmath50 , using the monte carlo method of @xcite . at the timesteps immediately preceding each m and x class flare , we calculate the system s potential field topology in terms of poles , nulls , and separators @xcite . in our analysis ,",
    "deviations from a potential field configuration take the form of differences in the amount of flux ( either more or less ) in the real field s domains versus the potential field s domains . in the mcc model ,",
    "the departure of a domain from a potential field configuration gives rise to currents in associated separators .",
    "every domain that is topologically linked by a separator contributes to that separator s current . to determine which domains each separator links we use the gauss linking number method of @xcite .",
    "completing the free energy estimate for each separator , we use the direct connection between currents flowing along separators and free magnetic energy given by @xcite .",
    "as shown in @xcite , the self  flux of a separator ( current ribbon ) , generated by currents flowing along it , is equal to the difference between the linked  domain fluxes in the real and potential fields : @xmath51 here , @xmath52 is the real domain flux of a domain @xmath53 at time @xmath11 , given by the initial potential field flux and the summation over time of the surface flux change matrix , defined above :    @xmath54    the difference between the real and potential field fluxes at each time gives @xmath55 , the total amount of flux which may be redistributed between domains in a reconnection event .",
    "the sum of @xmath55 over all times up to @xmath11 , and over all linked domains @xmath53 , results in equation .",
    "we may extend this model to include reconnection by considering the effect of reconnection at some time @xmath56 on the connectivity matrices described above .",
    "the potential connectivities @xmath57 do not change , as they are uniquely determined by the photospheric boundary at any time .",
    "the only effect is to transfer flux between domains in the real field .",
    "we accomplish this by adding some flux transfer matrix @xmath58 to @xmath59 at time @xmath56 , so that @xmath60 the total flux through the photosphere does not change during a flare , so the potential field @xmath57 also does not change . according to equations [ eq : fce ] and [ eq : totfcr ]",
    ", then , there is an opposite assignment of flux in the redistribution matrix @xmath61 .",
    "we may model the effect of multiple reconnections by adding / subtracting flux transfer matrices @xmath62 as necessary .",
    "therefore , the separator self ",
    "flux at any time @xmath11 , including all past reconnection events , is given by @xmath63 where @xmath64 is the heaviside step function . in the following section",
    ", we will propose a minimization scheme for estimating the reconnection matrix @xmath65 at the time of a flare .",
    "having thus determined each separator s self  flux at any time , we follow @xcite to relate that self  flux to the separator current by @xmath66 with @xmath67 allows us to represent the current in terms of the fluxes .",
    "finally , from @xcite equation ( 4 ) we can calculate the energy in the mcc model in excess of the potential field magnetic energy , @xmath68 which , via equation , is a function of the calculated separator fluxes @xmath69 .",
    "we determine the coronal topology for the m6.6 flare at 17:22 on feb .",
    "13 , 6 minutes before flare onset , and 16 minutes before goes peak intensity . at this time , our model consists of 27 sources ( 16 negative , 12 positive ) and 26 nulls .",
    "following @xcite , these numbers satisfy both the 2d and 3d euler characteristics , so we believe we have found all nulls .",
    "every null is prone , and there are no coronal nulls .",
    "one null is asymptotic in the sense of @xcite , laying along the direction of the region s dipole moment computed about the center of unsigned flux , @xmath70 , at a distance @xmath71 , where @xmath72 is the net charge .",
    "this null s separatrix surface forms a boundary between the region s closed flux and surrounding open flux . 7 additional source  null pairs are part of unbroken fans : p57/b22 , p52/b21 , n51/a20 , n45/a18 , n43/a16 , n42/a25 , and n38/a26 . using these values and the equation between ( 26 ) and ( 27 ) of @xcite , we expect to find 17 separators in the corona ( along with 17 mirror separators ) , which we do find .",
    "we therefore believe we have completely specified the system s topology on the eve of the flare .",
    "we perform a similar analysis just prior to the m2.2 and x2.2 flares . while we do not find every topological element in these later flares , we believe we find all that play a significant role in each case .    for the 17 separators at the time of the m6.6 flare , we find 90 linked domains .",
    "two of the separators have the same endpoints , nulls a07/b01 , and therefore enclose multiply connected source pairs @xcite .",
    "these are known as redundant separators . in this case , the two separators lay nearly along the same path , implying a slight wrinkle in the intersecting fan surfaces .",
    "this creates one additional flux domain enclosed by the two separators . because the cross  sectional area in this case is small , the enclosed flux is small relative to the total flux enclosed by each separator , and the corresponding energy due to the redundant separator is negligible .",
    "the monte carlo estimate of fluxes enclosed by the different separators used 500 field lines .",
    "there was no difference in the number linked by the separators , so we conclude that the fluxes they link are identical to a fraction of a percent .",
    "we use only one of the two in our calculation , and arrive at the same result independent of this choice .",
    "as stated above , one shortcoming of current mct / mcc analyses are their inability to account for violation of the flux constrains . as such , they have no way to account for reconnection .",
    "we here present a method for relaxing those constraints at any timestep , while allowing the system to continue evolving after reconnection .    during reconnection",
    ", flux is exchanged across the field s separators .",
    "each separator lies at the boundary of four flux domains , and the separators involved in the flare identify the set of domains which exchange flux .",
    "some of these domains are flux superficient , containing more flux than in a potential field , and some deficient .",
    "not every separator needs to be involved in every flare , and not all flux is necessarily transferred in every flare , even within the subset of involved domains .",
    "reconnection does not simply involve the transfer of flux from superficient to deficient domains .",
    "two domains on opposite sides of a separator ( x  point in 2d ) reconnect fieldlines , transferring flux to the remaining two domains .",
    "there is no physical reason why opposing domains must both have more ( or less ) flux than a potential field configuration .",
    "instead , the state of the current domain depends on the history of its poles : where and with whom they emerged , who they reconnected with in the past , and what their current geometric orientation is .",
    "the only requirement for reconnection is that the two flux  donating domains contain some flux ( nonzero elements of @xmath59 in equation ) . in such cases",
    ", this poses the interesting question of whether the potential field configuration is always attainable through reconnection , or if there exists some local minima in configuration space .",
    "we briefly consider this below , but leave a more detailed analysis of the question for another investigation .",
    "we use a simple iterative minimization algorithm to model the redistribution of flux across a set of separators involved in a particular event . for each separator",
    ", we propose a small transfer of flux between the four surrounding domains .",
    "each domain is specified by the indices of its two poles in a connectivity matrix , and reconnection is described by the transfer of flux @xmath73 from two elements of our redistribution matrix to two others .",
    "supposing that the two flux  donating domains are @xmath10 and @xmath74 , while the two receiving domains are @xmath75 and @xmath76 , then the 4 involved elements of redistribution matrix change as follows : @xmath77 .",
    "we then calculate the total energy drop over the entire system ( the summation of equation for every separator ) .",
    "we apply the small reconnection resulting in the largest total free energy drop .",
    "we then calculate the next set of energy drops for each small reconnection , and this process continues until one of two conditions is met : either 1 ) no flux transfer is possible because no pair of opposing domains both have nonzero elements of the connectivity matrix @xmath59 ; or 2 ) any small reconnection increases the total free energy .",
    "the sum of every small reconnection @xmath73 then fills out the flux ",
    "transfer matrix @xmath58 for the flare at time @xmath56 .",
    "having determined how to model reconnection , we now turn our attention to determining when to apply a minimization . at present",
    "we have no model for the mechanism in the actual corona which initiates reconnection at a current sheet .",
    "all we can infer , from observations of actual flares , is that at some instant the reconnection does begin at certain separators .",
    "we therefore rely on observations of this kind to determine the separators undergoing reconnection , and when this reconnection occurs .    for the present study",
    ", we perform a minimization for every flare associated with ar11158 with goes class of m1.0 or greater .",
    "this pares the number of separate minimizations down to a manageable amount for a proof of concept , while still allowing us to understand some of the large scale processes at work in the active region s evolution .",
    "we employ chromospheric data to select a subset of coronal domains involved in each flare .",
    "we associate the chromospheric flare ribbons observed in the 1600  channel of aia data with specific spine field lines of the topological skeleton .",
    "while the spine lines do not always geometrically match the ribbons , there is a topological correspondence @xcite .",
    "the spines are the photospheric footpoints of reconnecting loops , and therefore indicate which flux domains are involved in each flare .",
    "magnetic reconnection across a separator couples the flux redistribution in the corona to the photospheric spines of the separator s null points .",
    "the highlighting of spine lines by flare ribbons thus indicates those separators involved in each flare . to make use of this information , we relax flux constraints ( allow for reconnection between four domains ) using only those separators associated with the highlighted ribbons .",
    "log  scaled aia 1600  image during the goes class m6.6 flare , with coordinates given in arcseconds from disk center .",
    "the grayscale saturates at 6000 counts , roughly half the pre ",
    "flare maximum pixel value .",
    "the potential field skeleton is overlaid : pluses and crosses are positive and negative poles , respectively ; triangles are positive ( @xmath78 ) and negative ( @xmath79 ) nulls ; thin solid white lines depict spines .",
    "the energy calculation only attempts reconnection across those separators having two boxed nullpoints as footpoints .",
    "these seven separators displayed as thick solid blue lines .",
    "the remaining ten separators are displayed as green dashed lines.,scaledwidth=80.0% ]    figure [ fig:143ribbon ] shows the aia 1600  data for a selected timestep during the m6.6 flare .",
    "the aia image is displayed in a logarithmic grayscale , and shows a relatively simple two ribbon flare .",
    "overplotted are contours of the magnetogram at + 75 g ( yellow ) and -75 g ( blue ) , as well as the topological skeleton ( see caption for details , and online material for an animation covering the time of the flare ) .",
    "clearly visible are the two primary flare ribbons , located on either side of the central polarity inversion line ( pil between southern",
    " emerged positive flux and northern negative flux ) .",
    "evident in the online animation are several other , smaller flare ribbons , located in the southern negative and northern positive regions .",
    "there are spine fieldlines associated with each ribbon .",
    "the northern primary ribbon corresponds to the spine lines of null a06 , between poles n2 and n26 , near @xmath80 .",
    "the southern ribbon is only morphologically similar the potential field mct model .",
    "we separate the more diffuse p59 region from the more concentrated p3 and p37 , which forces the creation of two null points ( b23 , b10 ) with associated spine lines , near @xmath81,-250)^{\\prime\\prime}$ ] , respectively .",
    "we believe the real field likely has a null directly between p3 and p37 , creating a more direct spine line between the two .",
    "the spines involved in this flare have the red  boxed nullpoints in figure [ fig:143ribbon ] as their spine sources .",
    "this indicates that flux is transferred only across those separators connecting two of the boxed nulls .",
    "the projection onto the photosphere of seven such separators in this flare are shown as thick blue lines .",
    "the remaining separators are shown as dashed green lines .",
    "the free energy of these other separators may still change during the flare despite have no reconnection across them , provided the gauss linking number between the separator field line and any domain which does participate in reconnection is nonzero , as indicated by equation .",
    "figures [ fig:202ribbon ] and [ fig:224ribbon ] are similar to figure [ fig:143ribbon ] , during the m2.2 and x2.2 flares , respectively .",
    "we have left off the contours of the magnetogram in these figures for clarity .",
    "the x class flare in particular is more complex than previous flares , involving more and disparate parts of the active region complex .",
    "this increased activity is likely influenced by the creation of a coronal null point just prior to the m2.2 flare , whose fan surface effectively separates the northern and southern emergence zones .",
    "the energy buildup prior to the m6.6 flare is particularly dependent on the emergence of n26 in the north .",
    "this generates the null point in the north to which the four northern involved separators attach . in the 25 hours between n26 s emergence at 2011 - 02 - 12 16:00 ut and the m6.6 flare",
    ", we calculate an increase in free energy due to currents along these four separators of @xmath82 , about one third of the total mcc free energy in the system at this time .",
    "these separators link domains n26/p37 , n26/p59 , n26/p31 , n26/p39 , n26/p44 , n28/p31 , n37/p3 , and n37/p39 .",
    "same as figure [ fig:143ribbon ] , for the m2.2 flare .",
    "solid blue and green lines show separators connected to nulls with spines laying approximately along paths of flare ribbons observed in aia 1600  channel . locations of other separators are shown as dashed green lines.,scaledwidth=50.0% ]    the 1600  flare ribbons indicate that 6 separators are involved in the m2.2 flare ( figure [ fig:202ribbon ] ) .",
    "four connect to null a14 between regions n25 and n56 , and 2 connect through the coronal null a33 ; their projections in the photospheric plane are shown as solid blue solids , with the remaining separators shown as dashed green lines .",
    "same as figure [ fig:143ribbon ] , for the x2.2 flare.,scaledwidth=50.0% ]        figure [ fig : m66min ] illustrates the result of the free energy minimization for the m6.6 flare .",
    "thick orange lines show the projections of separators across which flux was transferred by the minimization process .",
    "note that this involves three separators of the six identified via flare ribbons in figure [ fig:143ribbon ] , which are themselves a subset of the 17 total separators at this time .",
    "the dashed lines overlaid on the magnetogram , mask , and topological footprint background show those domains that exchanged flux during minimization ",
    "these are not fieldlines , just identifications of the involved domains .",
    "the amount of flux loss or gain is indicated by the colorbar , with white to green indicating increasing amounts of flux gain , and black to red increasing flux donation .",
    "it is immediately apparent that the minimization does not exactly match our expectation from the flare ribbons , despite our specification of `` involved separators . ''",
    "in particular , the four domains involving n2 , n26 , p37 , and p59 are essentially nonparticipants in modeled flare , whereas they are clearly the dominant players in the actual flare . in our model of emergence , these domains are not simply flux deficient relative to the potential field , but have _ zero _ initial flux .",
    "we will discuss this in more detail in ",
    "[ sec : disc ] .    in total for the m6.6 flare minimization",
    ", we find that @xmath83 of flux was exchanged between @xmath84 domains across @xmath85 separators .",
    "this exchange took @xmath86 iterative minimization steps , resulting in a total drop of @xmath87 , @xmath9 of the pre ",
    "minimization mcc free energy ( @xmath88 ) and @xmath89 of the potential field energy ( @xmath90 ) .",
    "these results are summarized in table[tab : minimize ] , together with those for the m2.2 and x2.2 flares , and we discuss them in more detail in the next section .    lccccccc flare & flux ( @xmath91 ) & domains & separators & steps & initial @xmath92 & @xmath93 & @xmath94 + m6.6 & 4.2 & 10 & 3 & 1922 & @xmath95 & @xmath96 & @xmath97 + m2.2 & 2.0 & 15 & 8 & 327 & @xmath98 & @xmath99 & @xmath100 + x2.2 & 21.0 & 17 & 10 & 29504 & @xmath101 & @xmath102 & @xmath103 +",
    "this investigation builds on @xcite in adding the observational history of an active region s flux evolution , in particular its flux emergence , to the mcc model . here",
    "we have relied on line  of  sight magnetograms provided by sdo / hmi and generated our flux histories by assuming a radial field . with the arrival of the hmi active region patches ( harps ) dataseries to jsoc",
    ", future investigations can use the actual vertical flux determined by hmi s vector magnetograms .",
    "we were fortunate in the present case to have hmi observe the entire history of ar11158 from its emergence around @xmath104 solar east on feb .",
    "10th , 2011 , to its rotation off - disc some 9 days later . in the more common case where we do not observe the entire emergence of an active region , we could use a nlfff extrapolation to generate an initial connectivity state , which would then be updated in time via the methods of  [ sec : mod - phot ] .",
    "we have gone several steps further than previous energy estimates using the mct / mcc framework , such as @xcite or @xcite .",
    "most importantly , we now allow for violation of the no  reconnection flux constraints of the mcc .",
    "this enables us to not only consider energy storage due to currents along a subset of separators in a flare , but also allows for an estimate of flux transfer and energy conversion during a flare .",
    "further work may yield an interesting comparison between the flux transferred in our minimization to estimates of reconnected flux based on analysis of flare ribbons , as was done in @xcite .    for each flare",
    ", we choose a subset of separators that are allowed to transfer flux during our minimization based on observations of chromospheric flare ribbons .",
    "each separator bounds 4 domains , though some of these domains are bounded by more than one separator .",
    "thus , the number of domains which may exchange flux via reconnection is typically less than 4 times the number of involved separators .",
    "it is interesting that the minimization scheme we have proposed does not utilize every allowed domain . as mentioned above , in order to undergo reconnection , two domains on opposite sides of a separator must both contain flux ( have nonzero elements in the connectivity matrix @xmath59 ) .",
    "focusing again on the m6.6 flare , the two separators that connect to null a06 , between poles n2 and n26 , and have pole p59 as a spine source of their b  type nulls ( nulls b10 and b23 ) contain very strong currents and border flux domains with highly nonpotential connectivities . and",
    "yet , they do not participate in the minimization . in this case",
    ", there is no pathway of free energy loss that results in donatable flux on opposite sides of these separators . the lack of any flux in the p59/(n2 , n26 , n28 ) domains effectively cuts off any involvement of p37 in our model of this flare .    between poles",
    "n2 , n25 , p37 , and p59 , flux transfer may occur in either of two directions .",
    "domains n2/p59 and n26/p37 may donate flux , with n2/p37 and n26/p59 receiving , or n2/p37 and n26/p59 may donate flux with n2/p59 and n26/p37 receiving . in either case , one of p59 s domains must donate flux . since both the p59/n2 and p59/n26 domains have _ no _ flux in our model ( not to be confused with having less than the potential field configuration ) , this reconnection can not occur .    we do , however , observe the primary flare ribbons involving just these domains .",
    "so , where has our model of this active region gone awry ?",
    "first , we note that there are many small flare events smaller than m1.0 prior to the first flare we consider .",
    "any of these events may transfer flux into the domain necessary for the m6.6 event .",
    "second , it is likely that a great deal of reconnection takes place that is unassociated with any goes class flare .",
    "this may be a `` steady '' reconnection , as is observable in euv and x  ray images of emerging magnetic regions .",
    "for instance , in our previous study @xcite of ar11112 from october 2011 , we saw that newly emerged flux steadily reconnected with surrounding preexisting flux , as evidenced by the encroachment of the bright xrt kernel into the surrounding flux .",
    "this is discussed in detail in @xcite .",
    "although the region did produce several flares later in its evolution , this steady reconnection occurred independently of any observable flares .",
    "we believe that a similar process is ongoing in ar11158 s evolution .",
    "in particular , we believe this type of steady reconnection occurs along the central pil , where southern emerged positive flux has collided with and sheared relative to northern emerged negative flux .",
    "such a steady , low  level reconnection would populate these central domains with flux .",
    "the free energy of this portion would increase as these domains continued to shear , culminating in the series of explosive reconnections observed at later times .",
    "one may see evidence of this in euv images from aia , showing low laying loops that cross the central pil , together with very high loops apparently connecting the most westward positive flux to the most eastward negative flux concentrations .",
    "another interesting point is that , in our minimizations , no separator expelled all of its current and thereby reached the potential field state , as one might expect to be the case in an mcc model . instead , in each of the three reconnection events modeled here , the system reaches a state where reconnection across on separator reduces one domain s flux to zero .",
    "reconnection across a second separator can repopulate the zero  flux domain , allowing further reconnection across the first separator .",
    "however , it often happens that the two separators each require flux donation from that same domain , and so no further reconnection is possible across either one .",
    "@xcite also found that the total free energy derived from the mcc model was greater than their calculated energy losses observed during the feb .",
    "24 , 2004 x class flare .",
    "they attributed this to incomplete relaxation through reconnection , but had no way to assess why this might be the case , as we have developed here .     the potential energy ( solid line ) and mcc free energies both before ( triangles ) and after ( diamonds ) each minimization , the times of which are indicated by vertical lines .",
    "there is no way to calculate a potential energy in the mct / mcc model , so the free energy has been plotted above the potential energy derived from a fourier transform method.,scaledwidth=50.0% ]    we may compare the energies associated with each event in a variety of ways .",
    "the solid line in figure [ fig : eplot ] shows the potential energy calculated from each magnetogram using the fourier transform method of @xcite .",
    "this is similar to , but not directly comparable with , the potential energy shown in figure 4(c ) of ( * ? ? ?",
    "* ( hereafter s12 ) ) . when not stated explicitly in the text , we have determined approximate values for potential and free energies from their figure 4 .    because s12 use the vertical flux determined from the hmi vector magnetograms whereas we use the los field , deprojected assuming a radial field at every pixel",
    ", we have different lower boundaries for determining the potential energy , so that our calculated values differ .",
    "our potential energy appears consistently lower than that of s12 , and also seems to have more substantial variations .",
    "these variations become more pronounced after @xmath105 , when the northern region ceases substantial emergence and the active region crosses disk center .",
    "the free energies of the mcc model @xmath92 are shown in figure [ fig : eplot ] as red triangles at the time of each flare and blue diamonds after minimization .",
    "we have added the mcc values to the calculated potential field energies at each time in order to emphasize that these are energies in excess of the potential field . however",
    ", this addition should be taken with caution , because the free and potential energies are calculated using two incompatible boundary conditions : the former using the point sources of the mct model with an imposed fce constraint , the later using continuously distributed magnetograms .",
    "the potential energy of a point source is infinite , and the mcc is only able to determine the difference between energies of the fce and potential fields . even given these issues , it is still a useful comparison to make .",
    "the initial free energy of the mcc increases from flare to flare , while the calculated energy drop due to flux exchange during minimization scales with the size of each flare .",
    "this is most easily seen in the @xmath93 column of table[tab : minimize ] .",
    "the general trend of the amount of flux exchange , and resulting energy drop , in each flare follows our expectations given the goes class .",
    "an order of magnitude more flux is exchanged for the x2.2 flare compared to the m flares , yet this leads to a two order of magnitude greater free energy drop .",
    "this highlights the important point that free energy does not scale linearly with flux ",
    "difference from potential , even for a given separator .",
    "s12 made extensive use of hmi s vector magnetograms to present a detailed discussion of magnetic energy in ar11158 , so it is useful to compare the results of that nlfff model to ours .",
    "those authors extrapolate a nlff field at a 12 second cadence using the hmi vector magnetogram as a lower boundary .",
    "each extrapolation is independent of the others , maintaining no memory of previous magnetic flux or connectivity",
    ". it can therefore be difficult to ascribe any rise or drop in the free energy from one time to the next to any particular event .",
    "they state a spectropolarimetric noise of @xmath106 , but acknowledge that errors due to extrapolation are unknown and possibly greater .",
    "we note that a persistent change from before to after is more likely to be a manifestation of change in the actual solar field .    for the x2.2 flare",
    ", s12 find an initial free energy of @xmath107 , and a persistent free energy drop from before to after the flare of @xmath108 .",
    "this may be compared to our model , which sets the initial free energy at @xmath109 and a pre  to  post minimization drop of @xmath110 . that both of these results are greater than those of s12 is a little surprising because mcc provides a lower bound on the free energy of linear force free fields evolving quasistatically @xcite .",
    "while it is not necessary that a lfff have greater free energy than a nlfff derived from the same boundary , one often assumes it to be the case .    at the same time , the mct / mcc model does not involve an extrapolation , except to determine the topological structure of the region .",
    "the non  potentiality of the region is determined simply by using observations emergence to fix the regions connectivity .",
    "our minimization scheme only determines the total amount of energy loss provided that all possible free energy minimizing reconnections take place .",
    "not only may the algorithm terminate in a local free energy minimum , as discussed above , there is no physical reason why all possible reconnections need to take place in a single event .",
    "it is much more difficult to make such a comparison between these two models for the m6.6 and m2.2 flares . from figure 4(d ) of s12",
    ", we estimate initial free energies of @xmath111 and @xmath112 for these flares , respectively , compared to our results of @xmath113 and @xmath114 .",
    "our minimization gives pre  to  post reconnection drops of @xmath115 and @xmath116 in each case , which is the approximate level of the spectropolarimetic noise in the nlfff extrapolations .",
    "indeed , again looking at figure 4(d ) of s12 , neither the m6.6 or m2.2 flare appears cotemporal with a decrease in free energy , and certainly not with a persistent decrease , as is the case with the x2.2 flare .    as a final energetic comparison",
    ", we calculate the energy loss due to radiation in each flare using the goes light curves via the method of @xcite . for the m6.6 , m2.2 , and x2.2 flares we find radiative losses of @xmath117 , @xmath118 , and @xmath119 , respectively .",
    "the above mentioned papers show that other energetic losses , such as thermal conduction and enthalpy flux , tend to dominate the radiative losses during flares .",
    "the total energetic loss is difficult to precisely quantify , but may exceed the goes estimated radiative loss by a factor of @xmath120 . given that , the results of our minimization for the m6.6 and m2.2 compare favorably with the goes estimates . however , our estimation for energy loss during the x  class flare may be greater than the observed energetic losses by an order of magnitude .",
    "this is not surprising because the great extent of the x  class flare ribbons encompassed more separators and more domains , ultimately allowing more pathways for energy minimizing reconnection .",
    "this allowed the minimization algorithm to exchange much more flux before halting in a local minimum .",
    "graham barnes provided code for producing the potential field connectivity matrices using a monte carlo algorithm with bayesian estimates , as described in @xcite .",
    "development of the code was supported by the air force office of scientific research under contract fa9550 - 06-c-0019 .",
    "we would like to acknowledge our use of nasa s astrophysics data system .",
    "this work is supported by nasa under contract sp02h3901r from lockheed  martin to msu ."
  ],
  "abstract_text": [
    "<S> it is well known that photospheric flux emergence is an important process for stressing coronal fields and storing magnetic free energy , which may then be released during a flare . the _ helioseismic and magnetic imager _ ( hmi ) onboard the _ solar dynamics observatory _ ( sdo ) captured the entire emergence of noaa ar 11158 . </S>",
    "<S> this region emerged as two distinct bipoles , possibly connected underneath the photosphere , yet characterized by different photospheric field evolutions and fluxes . </S>",
    "<S> the combined active region complex produced 15 goes c  class , 2 m  class , and the x2.2 valentine s day flare during the four days after initial emergence on february 12th , 2011 . </S>",
    "<S> the m and x class flares are of particular interest because they are nonhomologous , involving different subregions of the active region . </S>",
    "<S> we use a magnetic charge topology together with the minimum current corona model of the coronal field to model field evolution of the complex . combining this with observations of flare ribbons in the 1600  channel of the _ atmospheric imaging assembly _ ( aia ) onboard sdo </S>",
    "<S> , we propose a minimization algorithm for estimating the amount of reconnected flux and resulting drop in magnetic free energy during a flare . </S>",
    "<S> for the m6.6 , m2.2 , and x2.2 flares , we find a flux exchange of @xmath0 , respectively , resulting in free energy drops of @xmath1 . </S>"
  ]
}