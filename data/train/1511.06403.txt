{
  "article_text": [
    "accurate astrometry is essential for measuring parallaxes for stars in the solar neighborhood ( @xmath330  pc ) and proper motions for members of nearby open clusters and star - forming regions ( 100300  pc ) .",
    "the coldest brown dwarfs near the sun and the more obscured members of young clusters can be difficult to detect with the optical and near - infrared ( ir ) instruments that are normally used for such measurements , but they are much brighter at mid - ir wavelengths .",
    "the best available mid - ir instrument for astrometry of this kind is the infrared array camera ( irac ; * ? ? ?",
    "* ) on the _ spitzer space telescope _",
    "irac has already contributed to the measurement of parallaxes for most of the coldest known brown dwarfs @xcite . meanwhile ,",
    "irac observations at multiple epochs spanning a decade are now available for several nearby star - forming regions , making it possible to search for new members via their proper motions ( e.g. , program 90071 ; a. kraus ) .    in the two most sensitive bands of irac for stars and brown dwarfs ( 3.6 and 4.5  @xmath0 m ) , the largest sources of uncertainty in astrometry are ( 1 ) systematic offsets in the measured pixel coordinates of stars due to varying intra - pixel sensitivity combined with an under - sampled point spread function ( psf ) , ( 2 ) @xmath2100 mas systematic errors in the pipeline s 3@xmath4 order distortion corrections , and ( 3 ) random errors in the measured pixel coordinates of stars , which can depend significantly on the algorithm adopted for measuring those positions , especially at lower signal to noise ( s / n ) . to date , the first source has been addressed primarily in the context of high - precision photometry of single objects rather than astrometry of multiple sources across the irac arrays ( see @xcite ) . meanwhile , the pipeline distortion corrections have been greatly improved upon with newly developed 5@xmath1 order corrections @xcite , although these new corrections are not yet publicly available . finally , comparisons of algorithms that estimate stellar positions in irac images have been performed only with synthetic data @xcite or at high s / n ratios @xcite .    in this paper , we seek to more fully realize irac s capabilities for high - precision astrometry .",
    "we begin by describing the sets of archival irac data that we have selected for our analysis ( section 2 ) . using these data ,",
    "we characterize the systematic offsets due to varying intra - pixel sensitivity and compare the astrometric errors produced by several algorithms for measuring stellar positions ( section 3 ) .",
    "we then measure accurate , high - order distortion corrections for the 3.6 and 4.5  @xmath0 m bands and quantify the astrometric errors produced by combining the new corrections and our preferred algorithm ( section  4 ) .",
    "the irac camera is described in detail by @xcite . in summary , it contains four 256 @xmath5 256 arrays that have plate scales of @xmath6 pixel@xmath7 , resulting in fields of view of @xmath8 .",
    "the arrays collect images at 3.6 , 4.5 , 5.8 , and 8.0 @xmath0 m , which are denoted as [ 3.6 ] , [ 4.5 ] , [ 5.8 ] , and [ 8.0 ] .",
    "the images produced by the camera exhibit a fwhm of @xmath9 . _",
    "spitzer _ was cooled with liquid helium from its launch in august 2003 until the depletion of the helium in may 2009 , which is known as the cryogenic mission .",
    "it has continued to operate in a post - cryogenic phase with the [ 3.6 ] and [ 4.5 ] bands of irac .",
    "the ideal dataset for simultaneously measuring both the distortion and the potential biases in algorithms for estimating stellar positions would have the following characteristic : it would contain a sufficiently large number of images of moderately dense fields of stars such that each pixel in the array experiences the detection of a star on many occasions .",
    "given the data available in the archive , we have selected post - cryogenic observations of dense fields within the galactic plane from program 70157 ( l. allen ) .",
    "these images contain 0.3 million stars with 3.8 million detections at s /",
    "n @xmath10 15 , resulting in an average of 29 detections per pixel in each band . to test the validity of applying the distortion corrections derived from those data to images obtained in other years during the mission , we also have made use of data from programs 104 ( t. soifer ) , 146 ( e. churchwell ) , 20201 ( e. churchwell ) , 40184 ( j. hora ) , 60101 ( r. arendt ) , 70072 ( b. whitney ) , 80074 ( b. whitney ) , and 90071 ( a. kraus ) , all of which are comparable in density of detections to the dataset of the galactic plane .",
    "in addition , to compare the accuracies of different algorithms for measuring stellar positions , we need observations designed to maintain point sources at the same positions on the array among many images . for this purpose , we have selected the time - series photometric monitoring data from program 80179 ( s. metchev ) .",
    "the sensitivity of an individual irac pixel varies from the center to the edge .",
    "because the psfs in the [ 3.6 ] and [ 4.5 ] images are under sampled , the varying sensitivity leads to correlated noise in irac photometry and systematic offsets in the measured positions @xcite .",
    "in addition , the astrometric uncertainties can vary significantly among different algorithms for measuring positions . to correct for the effect of intra - pixel sensitivity and to identify the optimum choice of algorithm ,",
    "we have compared five commonly used routines : the idl functions cntrd , gcntrd , and box_centroider , which use first derivatives , gaussian fitting , and flux - weighted means ( i.e. , the first moment ) , respectively ; the iraf routine ofilter , which employs optimum filtering and a triangular weighting function ; and the point response function ( prf ) fitting routine implemented by the astronomical point source extractor ( apex ; * ? ? ?",
    "* ) , which is the extractor for the mosaicking and point source extraction package developed by the science center ( ssc ) .",
    "although location - dependent prfs are available from the ssc , we use only the central prf for extraction since the use of multiple prfs produces discontinuities in the distortion .",
    "we performed prf - fitting throughout this study using a 5  @xmath5  5 pixel box around each source , which is three times larger than the fwhm .",
    "due to systematic offsets in the calculated positions between some of the algorithms ( see section 4 ) , we began by measuring separate preliminary distortion corrections with post - cryogenic data from program 70157 for the five algorithms we considered .",
    "we then computed the deviations between the  true \" positions ( see section [ sec : meth ] ) and the measured positions of stars . in figure",
    "[ fig : phase ] , we show the x deviations in [ 3.6 ] as a function of x pixel phase , which is defined as the distance of the measured position from the center of the pixel in the x direction . the residuals are qualitatively similar for the y pixel phase in [ 3.6 ] and the two components in [ 4.5 ] .",
    "we find that the positions from cntrd , gcntrd , box_centroider , and ofilter exhibit large systematic errors ( @xmath10 100 mas ) , which is a reflection of the varying intra - pixel sensitivity .",
    "those x deviations are also correlated with the y pixel phase . for gcntrd",
    ", we note that the offsets near the edge of the pixel form two distinct sequences separated by @xmath270 mas . the large scatter in the residuals of box_centroider is a reflection of that algorithm s low precision ( see figure  [ fig : prec ] ) .",
    "for the same post - cryogenic data analyzed with the other four algorithms , prf fitting with apex produces much smaller systematic offsets in the measured positions , as shown in figure [ fig : phase ] .",
    "we also tested prf fitting on the various sets of cryogenic data from section 2 , arriving at the same result , as illustrated with the data from program 40184 in figure [ fig : phase ] .",
    "the [ 3.6 ] cryogenic data do show a small systematic offset ( @xmath210 mas ) , which can be fit with a third - order function in each pixel direction ( see section [ sec : con ] ) .",
    "an offset of this kind was not found in [ 4.5 ] .",
    "it is unclear why a bias should be present only in the [ 3.6 ] cryogenic data .    to quantify the precision of the five methods for measuring positions",
    ", we make use of the data from program 80179 because they consist of many images taken at the same position on the sky without dithering . for the four algorithms with large systematic errors due to the varying intra - pixel sensitivity ( figure [ fig : phase ] )",
    ", we applied a two - dimensional correction to the measured positions .",
    "we computed the median absolute deviation ( mad ) of the corrected positions for each star .",
    "we plot the resulting mads for the x direction in [ 3.6 ] as a function of s / n in figure [ fig : prec ] . although all of the methods exhibit similar precisions at high s / n ( @xmath220 mas at s / n = 100 ) , prf fitting produces the smallest errors at lower s / n ( @xmath2100 mas at s / n = 3 ) .    because prf fitting with apex produces the smallest systematic offsets due to intra - pixel sensitivity variations and the highest precision , we used it for deriving our distortion correction , and recommend its use when precision irac astrometry is required .",
    "however , ofilter is a reasonable alternative since its systematic errors can be corrected and its precision is only slightly worse than that of apex .",
    "we define our distortion correction in a way that is compatible with the simple imaging polynomial ( sip ) convention ( @xcite ) , which was developed for early in its mission . following the syntax of @xcite ,",
    "we define @xmath11 and @xmath12 to be the positions measured by apex after subtracting 128 .",
    "@xmath11 and @xmath12 are converted to world coordinates ( right ascension and declination ) in the following manner :    1 .   if the positions are measured from [ 3.6 ] cryogenic images , @xmath11 and @xmath12 are corrected for varying intra - pixel sensitivity as follows : @xmath13 where @xmath14 and @xmath15 are defined as @xmath16 the values of @xmath17 and @xmath18 are provided in an r package described at the end of section 4.3 . as discussed in section 3",
    ", positions from [ 3.6 ] post - cryogenic images and [ 4.5 ] images do not require such corrections ( i.e. , @xmath19 and @xmath20 ) .",
    "2 .   @xmath21 and @xmath22 are converted to intermediate coordinates @xmath23 and @xmath24 by @xmath25 where @xmath26 is the position angle of the y axis , @xmath27 is a time - dependent scale factor applied to the distortion correction ( see section [ sec : time ] ) , and @xmath28 and @xmath29 contain the distortion correction defined in the following manner : @xmath30 as with @xmath17 and @xmath18 , the values of @xmath31 and @xmath32 are found in the r package in section 4.3 .",
    "finally , world coordinates are computed by following the gnomonic projection as described by @xcite , which takes @xmath23 , @xmath24 , and a frame s central world coordinates as input .",
    "we also use the inverse of these steps ( i.e. , the conversion from world coordinates into any of the intermediate steps ) in our measurement of @xmath17 , @xmath18 , @xmath31 , and @xmath32 .",
    "the second and third steps have analytic inversions , while the distortion corrections themselves do not , which introduces an insignificant error ( @xmath30.01 pixel ) to the conversion .      to measure distortion corrections with the data from program 70157 ( section 2 )",
    ", we could either adopt an independent catalog of high - precision astrometry or apply self calibration ( i.e. , simultaneously measure an astrometric catalog , distortion corrections of [ 3.6 ] and [ 4.5 ] , and relative offsets and orientations among images ) .",
    "we choose to employ the latter because any independent catalog would have different resolution and sensitivity than the irac images .",
    "because self - calibration involves millions of parameters that depend on each other nonlinearly , we derived initial distortion corrections and measured relative offsets and orientations using astrometry from the two micron point source catalog ( 2mass , * ? ? ? * ) and then we refined the distortion corrections iteratively in the following manner .",
    "( 1 ) we constructed an astrometric catalog by calculating the mean position for each star from individual detections with s / n @xmath10 15 using our current distortion correction and relative offsets and orientations .",
    "( we refer to the mean position as a star s  true \" position , and the detections as the star s  measured \" positions . ) to quantify the goodness of fit for the current corrections and offsets , we calculated the rms of all measured positions relative to the true positions .",
    "( 2 ) we alternated solving for new distortion corrections and the relative offsets using least - squares algorithms defined in r ( an open source statistical software package ; * ? ? ?",
    "( 3 ) we continued iterating these two steps until the rms declined to a roughly constant value . in the second step , after applying the appropriate partial inverse transformations to the true positions , we used the linear modeling function lm in r to evaluate the distortion - corrections coefficients .",
    "meanwhile , we measured the relative orientations and offsets between frames using the nonlinear r algorithm optim . after completing an initial series of iterations and converging on a solution , we identified and removed detections on bad pixels and on the edges of the arrays where apex produces erroneous positions and then repeated the iterative process .",
    "to determine the optimum orders for equations ( 6 ) and ( 7 ) , we considered a wide range of orders ( 3 to @xmath1020 ) when analyzing the data from program 70157 .",
    "we then applied the solution derived for each order to the subset of observations from program 90071 that encompassed the taurus star - forming region . for comparison",
    ", we also applied the pipeline s 3@xmath4 order corrections to those data as well .",
    "we measured the relative orientations and offsets between images using the same self - calibration method as before , except with the distortion corrections fixed . to quantify the errors for each set of distortion corrections , we calculated the median deviation of measured positions from true positions in taurus data for 4@xmath54 pixel bins across the [ 3.6 ] and [ 4.5 ] arrays . in figure",
    "[ fig : comp ] , we show the median deviations in the y direction of the [ 4.5 ] array produced by ( 1 ) the pipeline correction and ofilter positions , ( 2 ) the pipeline correction and apex positions , ( 3 ) our 5@xmath1 order correction and apex positions , and ( 4 ) our 8@xmath1 order correction and apex positions .",
    "a time - dependent scale factor described in section [ sec : time ] was applied to our distortion corrections .",
    "the pipeline correction produces residuals ranging from @xmath3380 to 120 mas and @xmath331000 to 450 mas when applied to ofilter and apex positions , respectively .",
    "the difference between the residuals produced by the two algorithms is a reflection of offsets in the measured pixel positions between apex and ofilter , which are likely due to variations of the psf as a function of array location .",
    "this comparison demonstrates that the systematic astrometric errors can depend significantly on the adopted algorithm used to measure positions for a given distortion correction . _ indeed , our distortion corrections are only valid when used in conjunction with apex prf fitting . _",
    "the bayesian information criterion @xcite indicated an optimum order of @xmath220 for our distortion corrections when applied to the dataset used to measure the distortion .",
    "however , when we examined residual maps like those in the top panel in figure [ fig : comp ] for different orders on an independent dataset , we found that the improvements beyond orders of @xmath27 for [ 3.6 ] and @xmath28 for [ 4.5 ] were much smaller than the minimum errors in the measurements of pixel coordinates ( @xmath220  mas , fig .",
    "[ fig : prec ] ) .",
    "therefore , we adopted 7@xmath1 order corrections for [ 3.6 ] and 8@xmath1 order corrections for [ 4.5 ] . to illustrate the improvement of 8@xmath1 order relative to lower orders , we show in figure [ fig : comp ] the residual maps using 5@xmath1 and 8@xmath1 order corrections . in figure",
    "[ fig : resids ] , we plot the median x and y deviations for both bands in the taurus data produced by our adopted corrections .",
    "the large residuals near the edges in figure [ fig : resids ] are due to the fact that they were omitted from the fitting process because of the erroneous positions from apex at those locations , as noted earlier .",
    "we investigated whether our adopted distortion corrections are valid throughout the mission by applying them to the datasets selected in section 2 .",
    "for each dataset , we found a systematic low - order offset in the residual maps .",
    "as an illustration , in the top panel of figure [ fig : scalecorec ] we show the residual maps for the y component of [ 4.5 ] for programs 20201 , 80074 , and 90071 , which have epochs of 2008.33 , 2012.50 , and 2013.91 , respectively . at each epoch , there are two or three sections of the array with distinctly different median residuals , which range from about @xmath3325 to 25 mas . similar trends in the x direction are seen in the residual maps of the x component of [ 4.5 ] . the [ 3.6 ] residual maps also show offsets of this kind , except with a smaller range .",
    "this pattern is likely a reflection of the tiling of images in a given dataset .",
    "we find that these offsets can be can be eliminated by multiplying the distortion correction by a scale factor , as demonstrated in the bottom panel of figure [ fig : scalecorec ] .",
    "we plot these scale factors for all of the datasets that we have analyzed as a function of epoch in figure [ fig : scale ] .",
    "the value of the factor appears to vary on a time scale of several months with the largest change occurring at the transition between the cryogenic and post - cryogenic phases of the mission .",
    "the sizes of the scale factors are equivalent to changes of a few millimeters in the focal length of the telescope .",
    "the scale factor for an epoch not represented in our selected datasets can be interpolated from the scale factors in figure [ fig : scale ] or measured independently in the way that we have done if the dataset is large enough . in figure",
    "[ fig : final ] , we show maps of the magnitude and direction of the distortion implied by our adopted corrections for [ 3.6 ] and [ 4.5 ] at epoch 2013.91 .    because the number of coefficients within a single distortion correction is high ( @xmath270 ) and our corrections were measured with r , we have created an r package  iracpm \" that contains functions and instructions for applying the corrections .",
    "although the formalism of section 4.1 is compatible with sip , we do not recommend simply updating the headers of images with our distortion correction because [ 3.6 ] cryogenic images benefit from a correction for varying intra - pixel sensitivity prior to the application of the distortion and our corrections are only applicable to positions measured by apex ( see figure [ fig : comp ] ) .",
    "to illustrate the astrometric accuracy that can be achieved by using our new distortion corrections , we applied them to archival multi - epoch images of the chamaeleon i star - forming region ( t. esplin , in preparation ) .",
    "we present the mads as a function of s / n for the final epoch of observations ( program 90071 ) in figure [ fig : cham ] .",
    "the median positional errors are @xmath270  mas at s / n = 10 ( 90% of the errors are between 25 and 230  mas ) and @xmath220  mas at s / n = 100 ( 90% between 7 and 42  mas ) .",
    "most of the error at low s / n is likely introduced in the measurement of the pixel coordinates of a star ( see fig .  [",
    "fig : prec ] ) with only minor contributions from the relative offsets and orientations between images and the distortion corrections .",
    "we have sought to characterize and correct for the largest sources of uncertainty in astrometry in the [ 3.6 ] and [ 4.5 ] bands of irac .",
    "we began by comparing five commonly used routines for measuring the pixel coordinates of stars that implement flux - weighted means , gaussian fitting , triangular weighting , first derivatives , and prf fitting .",
    "we have found that prf fitting with apex produces the smallest systematic errors from varying intra - pixel sensitivity . after correcting for those systematic errors for each algorithm",
    ", apex provides the greatest precision in the pixel coordinates of sources at all values of s / n . for these reasons , we recommend the use of prf fitting with apex for irac analysis that requires precise astrometry ( e.g. , photometric monitoring for transits or variability and proper motion surveys ) .    by applying self - calibration",
    "to irac data in the galactic plane , we have derived 7@xmath34 and 8@xmath34 order distortion corrections for the [ 3.6 ] and [ 4.5 ] arrays , respectively . to test these distortion corrections ,",
    "we have applied them to datasets spanning the mission of _ spitzer_. the resulting residual maps contain low - order systematic offsets that are well - fit by a time - dependent scale factor that is multiplied by the distortion correction . after correcting for this effect , these datasets exhibited residuals that have a range of roughly @xmath3510 mas , which reflects the accuracy of our distortion corrections .",
    "when analyzing data in the chamaeleon i star - forming region by combining apex prf fitting with our new distortion corrections , we have achieved total astrometric errors of @xmath220 and 70 mas at s / n = 10 and 100 , respectively . to promote the use of irac for precision astrometry , we have made our distortion corrections publicly available in a new r package called  iracpm \" .",
    "we note that our corrections are only valid when used in conjunction with positions measured with apex prf fitting .",
    "we acknowledge support from grant ast-1208239 from the national science foundation .",
    "we thank patrick lowrance and john stauffer for helpful discussions regarding the distortion correction for irac .",
    "2mass is a joint project of the university of massachusetts and the infrared processing and analysis center at caltech , funded by nasa and the nsf .",
    "the center for exoplanets and habitable worlds is supported by the pennsylvania state university , the eberly college of science , and the pennsylvania space grant consortium ."
  ],
  "abstract_text": [
    "<S> the infrared array camera ( irac ) on the _ spitzer space telescope _ currently offers the greatest potential for high - precision astrometry of faint mid - ir sources across arcminute - scale fields , which would be especially valuable for measuring parallaxes of cold brown dwarfs in the solar neighborhood and proper motions of obscured members of nearby star - forming regions . to more fully realize irac s astrometric capabilities , we have sought to minimize the largest sources of uncertainty in astrometry with its 3.6 and 4.5  @xmath0 m bands . by comparing different routines that estimate stellar positions , we have found that point response function ( prf ) fitting with the _ spitzer _ science center s astronomical point source extractor produces both the smallest systematic errors from varying intra - pixel sensitivity and the greatest precision in measurements of positions . in addition </S>",
    "<S> , self - calibration has been used to derive new 7@xmath1 and 8@xmath1 order distortion corrections for the 3.6 and 4.5  @xmath0 m arrays of irac , respectively . </S>",
    "<S> these corrections are suitable for data throughout the mission of _ spitzer _ when a time - dependent scale factor is applied to the corrections . to illustrate the astrometric accuracy that can be achieved by combining prf fitting with our new distortion corrections , we have applied them to archival data for a nearby star - forming region , arriving at total astrometric errors of @xmath220 and 70 mas at signal to noise ratios of 100 and 10 , respectively . </S>"
  ]
}