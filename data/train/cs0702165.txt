{
  "article_text": [
    "in the financial world , individual companies are usually linked together via economic conditions , so default correlation , defined as the risk of multiple companies default together , has been an important area of research in credit analysis with applications to joint default , credit derivatives , asset pricing and risk management .",
    "nevertheless , the development of efficient computational tools for modeling default correlation is lagging behind its practical needs .",
    "currently , there are two dominant groups of theoretical models used in default correlation .",
    "one is a reduced form model , such as in @xcite that uses a copula function to parameterize the default correlation .",
    "recently , chen et al @xcite have translated the joint default probability into bivariate normal probability function .",
    "the second group of models for default correlation is a structural form model .",
    "zhou @xcite and hull et al @xcite are the first to incorporate default correlation into the black - cox first passage structural model .",
    "they got similar closed form solutions for two assets . however , their models can not easily be extended to more than two assets . furthermore , the developed models do not include jump - diffusion processes .",
    "as demonstrated in @xcite , jump risk becomes an important factor in credit risk analysis .",
    "it is now widely acknowledged that the standard brownian motion model for market behavior falls short of explaining empirical observations of market returns and their underlying derivative prices @xcite .",
    "the ( multivariate ) jump - diffusion model that provides a convenient framework for investigating default correlation with jumps becomes more readily accepted in the financial world .",
    "one of the major problems in default analysis is to determine when a default will occur within a given time horizon , or in other words , what the default rate is during such a time horizon .",
    "this problem is reduced to a first passage time ( fpt ) problem that can be formalized on a basis of a certain stochastic differential equations ( sde ) .",
    "it concerns the estimation of the probability density of the time for a random process to cross a specified threshold level .",
    "unfortunately , after including jumps , only special cases have analytical solutions",
    ". for most practical cases , closed form solutions are unavailable and we can only turn to the numerical procedures .",
    "monte carlo simulation is such a candidate for solving the sde , arising in the context of fpt problem . in conventional monte",
    "carlo methods , we need to discretize the time horizon into small enough intervals in order to avoid discretization bias @xcite , and we need to evaluate the processes at each discretized time which is very time - consuming .",
    "many researchers have contributed to the field and enhanced the efficiency of monte carlo simulation .",
    "atiya and metwally @xcite have developed a fast monte carlo - type numerical method to solve the fpt problem .",
    "recently , we have reported an extension of this fast monte carlo - type method in the context of multiple non - correlated jump - diffusion processes @xcite .    in this contribution",
    ", we develop a methodology for solving the fpt problem in the context of multivariate jump - diffusion processes .",
    "in particular , we have generalized the reported fast monte - carlo method ( non - correlated jump - diffusion cases ) for multivariate ( and correlated ) jump - diffusion processes .",
    "the paper is organized in the following way : section [ model ] details the description of our model .",
    "the algorithms are described in section [ methodology ] .",
    "section [ application ] contains the simulation results and discussions , followed by the conclusions given in section [ conclusion ] .",
    "in the market economy , individual companies are inevitably linked together via dynamically changing economic conditions .",
    "take two firms a and b as an example , whose probabilities of default are @xmath0 and @xmath1 , respectively .",
    "then the default correlation can be defined as @xmath2 where @xmath3 is the probability of joint default .",
    "now , we can write @xmath3 as @xmath4 .",
    "if we assume @xmath5 , then we have @xmath6 .",
    "thus it is apparent that the default correlation @xmath7 plays a key role in the joint default with important implication in the field of credit analysis .",
    "zhou @xcite and hull et al @xcite were the first to incorporate default correlation into the black - cox first passage structural model .    in @xcite zhou",
    "has proposed a first passage time model to describe default correlations of two firms under the `` bivariate diffusion process '' : @xmath8=    \\left[\\begin{array}{cc }     \\mu_1\\\\     \\mu_2     \\end{array}\\right]dt+     \\omega\\left[\\begin{array}{cc }     dz_1\\\\     dz_2     \\end{array}\\right ] ,    \\label{zhou : two : assets}\\ ] ] where @xmath9 and @xmath10 are constant drift terms , @xmath11 and @xmath12 are two independent standard brownian motions , and @xmath13 is a constant @xmath14 matrix such that @xmath15.\\ ] ] the coefficient @xmath16 reflects the correlation between the movements in the asset values of the two firms . based on eq .",
    "( [ zhou : two : assets ] ) , zhou has deduced the closed form solution of default correlations of two assets @xcite . however",
    ", none of the above models has included possible jumps .",
    "apparently , jumps have more significant importance in the default correlation than often perceived .",
    "indeed , simultaneous jumps may enhance the chance of simultaneous defaults which increases the correlation defaults .",
    "let us consider a more general case . in a complete probability space @xmath17 with information filtration @xmath18 .",
    "suppose that @xmath19 is a markov process in some state space @xmath20 , solving the stochastic differential equation @xcite @xmath21 where @xmath22 is an @xmath18-standard brownian motion in @xmath23 ; @xmath24 , @xmath25 , and @xmath26 is a pure jump process whose jumps have a fixed probability distribution @xmath27 on @xmath23 such that they arrive with intensity @xmath28 , for some @xmath29 . under these conditions ,",
    "the above model is reduced to an affine model if @xcite : @xmath30 where @xmath31 , @xmath32 , @xmath33 .",
    "if we assume that ,    1 .   each @xmath34 in eq .",
    "( [ ajd : diffeq ] ) is independent ; 2 .",
    "@xmath35 , @xmath36 and @xmath37 in ( 4 ) that means the drift term , the diffusion process ( brownian motion ) and the arrival intensity are independent with state vector @xmath38 ; 3 .",
    "the distribution of jump - size @xmath39 is also independent with respect to @xmath38 .    in this scenario",
    ", we can rewrite eq .",
    "( [ ajd : diffeq ] ) as @xmath40 where @xmath41    at first sight , eq .",
    "( [ jdp : multi ] ) is similar to eq .",
    "( [ zhou : two : assets ] ) , but eq . ( [ jdp : multi ] ) is a much more general model that can be applied to multiple firms , and where jumps have been taken into account .",
    "let us consider a firm @xmath42 , as described by eq .",
    "( [ jdp : multi ] ) , such that its state vector @xmath43 satisfies the following sde : @xmath44 where @xmath45 is a standard brownian motion and @xmath46 is : @xmath47    we assume that in the interval @xmath48 $ ] , total number of jumps for firm i is @xmath49 times of jumps . let the jump instants be @xmath50 .",
    "let @xmath51 and @xmath52 .",
    "the quantities @xmath53 equal to interjump times , which is @xmath54 .",
    "let @xmath55 be the process value immediately before the @xmath56th jump , and @xmath57 be the process value immediately after the @xmath56th jump .",
    "the jump - size is @xmath58 , we can use such jump - sizes to generate @xmath57 sequentially .    in a structural model , a firm defaults when the firm assets value @xmath59 falls below a threshold level @xmath60 . in this contribution",
    ", we use an exponential form , defining the threshold level by @xmath61 as proposed in @xcite , where @xmath62 can be interpreted as the growth rate of firm s liabilities .",
    "coefficient @xmath63 , in front , captures the liability structure of the firm , which is usually defined as a firm s short - term liability plus 50% of the firm s long - term liability .",
    "as mentioned before , @xmath19 , then the threshold of @xmath38 is @xmath64 .",
    "atiya et al @xcite have deduced a one - dimensional first passage time distribution in time horizon @xmath48 $ ] . in order to evaluate multi - firms ,",
    "we obtain multi - dimensional formulas and reduce them to computable forms .",
    "first , let us define @xmath65 as the event that process crossed the threshold level @xmath66 for the first time in the interval @xmath67 $ ] .",
    "then we have @xmath68    if we only consider one interval @xmath69 $ ] , we can obtain @xmath70^{2}}{2(t_{j}-t)\\sigma_{i}^{2}}\\right)\\nonumber\\\\    & & * \\exp\\left(-\\frac{[x_i(t_{j-1}^{+})-d_{i}(t)+\\mu_{i}(t - t_{j-1})]^{2}}{2(t - t_{j-1})\\sigma_{i}^{2}}\\right ) ,    \\label{fptd : condition}\\end{aligned}\\ ] ] where @xmath71^{2}}{2\\tau_{j}\\sigma_{i}^{2}}\\right).\\ ] ]    after getting these results in one interval , we combine the results to obtain the density for the whole interval @xmath48 $ ] .",
    "let @xmath72 be a brownian bridge in the interval @xmath69 $ ] with @xmath73 and @xmath74 .",
    "then the probability that the minimum of @xmath75 is always above the boundary level is @xmath76[x_i(t_{j}^{-})-d_{i}(t)]}{\\tau_{j}\\sigma_{i}^{2}}\\right ) , & \\mathrm{if}\\;x_i(t_{j}^{-})>d_{i}(t),\\\\         0 , & \\mathrm{otherwise}.       \\end{array}\\right .",
    "\\label{bm : default}\\end{aligned}\\ ] ]    this implies that @xmath75 is below the threshold level , which means the default happens or already happened , and its probability is @xmath77 .",
    "let @xmath78 denote the index of the interjump period in which the time @xmath79 falls in @xmath80 $ ] .",
    "also , let @xmath81 represent the index of the first jump , which happened in the simulated jump instant : @xmath82    if no such @xmath81 exists , then we set @xmath83 .    by combining eq .",
    "( [ fptd : condition ] ) , ( [ bm : default ] ) and ( [ index_first_jump ] ) , we get the probability of @xmath43 crossing the boundary level in the whole interval @xmath48 $ ] is @xmath84 where @xmath85 is the dirac s delta function .      for each firm , after generating a series of first passage times",
    "@xmath79 , we use a kernel density estimator with gaussian kernel to estimate the first passage time density ( fptd ) @xmath86 . as described in @xcite , the kernel density estimator",
    "is based on centering a kernel function of a bandwidth as follows : @xmath87 where @xmath88    the optimal bandwidth in the kernel function @xmath89 can be calculated as @xcite : @xmath90 where @xmath91 is the number of generated points and @xmath92 is the true density . here",
    "we use the approximation for the distribution , as a gamma distribution as proposed in @xcite : @xmath93    so the integral in eq .",
    "( [ estamate : hopt ] ) becomes , @xmath94 where @xmath95 and @xmath96    from eq .",
    "( [ eq : hopt2 ] ) , follows that in order to get a nonzero bandwidth , we have constraint @xmath97 to be at least equal to 3 .    after obtaining the estimated first passage time density @xmath98 ,",
    "the cumulative default rates can be written as , @xmath99",
    "in section [ model ] , we have reduced the solution of the original problem to a multivariate jump - diffusion model as described in eq .",
    "( [ jdp : one ] ) .",
    "the first passage time distribution was obtained in section [ subsection : fptd ] .",
    "as we have already noted , once jumps are included in the process , only for very basic applications closed form solutions are available @xcite , which in most practically interesting cases we have to resort to the numerical procedures .",
    "let us recall the conventional monte - carlo procedure in application to the analysis of the evaluation of firm @xmath43 within the time horizon @xmath48 $ ] .",
    "we divide the time horizon into @xmath100 small intervals @xmath101 $ ] , @xmath102 $ ] , @xmath103 , @xmath104 $ ] as displayed in fig .",
    "[ fig : method](a ) . in each monte carlo run , we need to calculate the value of @xmath43 at each discretized time @xmath105 . as usual in order to exclude discretization bias , the number @xmath100 must be large .",
    "this procedure exhibits substantial computational difficulties when applied to jump - diffusion process .    indeed , for a typical jump - diffusion process , as shown in fig .",
    "[ fig : method](a ) , let @xmath106 and @xmath107 be any successive jump instants , as described above . then , in the conventional monte carlo method , although there is no jump occurring in the interval @xmath108 $ ] , yet we need to evaluate @xmath43 at each discretized time @xmath105 in @xmath108 $ ] .",
    "this very time - consuming procedure results in serious shortcoming of the conventional monte carlo methodology .",
    "to remedy the situation , two modifications of the conventional procedure were recently proposed by atiya and metwally @xcite that allow us a potential speed - up of the conventional methodology in 10 - 30 times .",
    "one of the modifications , the uniform sampling method , involves sampling method . the other , inverse gaussian density sampling ,",
    "is based on the inverse gaussian density method for sampling .",
    "both methodologies were developed for the univariate case .    in this article , we focus on the further development of uniform sampling ( unif ) method and extend it to multivariate jump - diffusion processes . the major improvement of the uniform sampling method is based on the fact that it only evaluates @xmath43 at generated jump instants while between each two jumps the process is a brownian bridge ( see fig . [",
    "fig : method](b ) ) .",
    "hence we just consider the probability of @xmath43 defaults in @xmath109 instead of evaluating @xmath43 at each discretized time @xmath105 .",
    "more precisely , in the uniform sampling method , we assume that the values of @xmath110 and @xmath111 are known as two end points of the brownian bridge , we generate a variable @xmath79 with uniform distribution and by using eq .",
    "( [ bm : default ] ) we verify whether @xmath112 is smaller than the threshold level .",
    "if it is , then we have successfully generated a first passage time @xmath79 and can neglect the other intervals and perform another monte carlo run .    in order to implement the unif method for our multivariate model as described in eq .",
    "( [ jdp : one ] ) , we need to consider several points as follows :    1 .   here , we focus on the firms rated in the same way , that is we assume that the arrival rate @xmath113 for the poisson jump process and the distribution of @xmath114 are the same for each firm . as for the jump - size , we generate them by a given distribution , which can be different for different firms to reflect specifics of the jump process for each firm .",
    "we exemplify our description by considering an exponential distribution ( mean value @xmath115 ) for @xmath114 and a normal distribution ( mean value @xmath116 and standard deviation @xmath117 ) for the jump - size .",
    "we can use any other distribution when appropriate .",
    "3 .   an array ` isdefault ` ( whose size is the number of firms denoted by @xmath118 ) was used to indicate whether firm @xmath42 has defaulted in this monte carlo run . if the firm defaults , then we set ` isdefault`@xmath119 , and will not evaluate it during this monte carlo run .",
    "4 .   most importantly , in order to reflect the correlations of multiple firms , we need to generate correlated @xmath79 . as deduced in @xcite , the joint probability of firm @xmath42 to default before @xmath79 and firm @xmath56 to default before @xmath120 satisfies the bivariate inverse gaussian distribution .",
    "we approximate the correlation between @xmath79 and @xmath120 , denoted further by @xmath121 as the default correlation of firm @xmath42 and @xmath56 .",
    "then , we employ the sum - of - uniforms method @xcite to generate correlated uniform numbers @xmath79 .",
    "our algorithm for multivariate jump - diffusion processes can be described as follows .",
    "it is an extension of the one - dimensional case , described in @xcite .",
    "consider @xmath118 firms in the interval @xmath48 $ ] .",
    "first , we generate the jump instant @xmath122 by generating interjump times @xmath123 , and set all the ` isdefault`@xmath124 to indicate that no firm defaults at first .    from fig .",
    "[ fig : method](b ) and eq .",
    "( [ jdp : one ] ) , we can conclude that ,    1 .   if no jump occurs , as described in eq .",
    "( [ jdp : one ] ) , the interjump size @xmath125 follows a normal distribution of mean @xmath126 and standard deviation @xmath127 .",
    "we get @xmath128 where the initial state is @xmath129 .",
    "if jump occurs , we simulate the jump - size by a normal distribution or other distribution when appropriate , and compute the postjump value : @xmath130    after generating beforejump and postjump values @xmath131 and @xmath132 . as before , @xmath133 where @xmath134 is the number of jumps for all the firms",
    ", we can compute @xmath135 according to eq .",
    "( [ bm : default ] ) . to recur the first passage time density ( fptd ) @xmath136",
    ", we have to consider three possible cases that may occur for each non - default firm @xmath42 :    1 .",
    "* first passage happens inside the interval .",
    "* we know if @xmath137 and @xmath138 , then the first passage happened in the time interval @xmath69 $ ] .",
    "to evaluate when the first passage happened , we introduce a new viable @xmath139 , as @xmath140 , so that @xmath141 . by using the sum - of - uniforms method , we generate several correlated uniform numbers @xmath79 in the interval of @xmath142 $ ] , and if @xmath79 also belongs to interval @xmath69 $ ] , then the first passage time occurred in this interval .",
    "we set ` isdefault`@xmath119 to indicate firm @xmath42 that has defaulted .",
    "then , we can compute the conditional boundary crossing density @xmath143 according to eq .",
    "( [ fptd : condition ] ) . to get the density of the entire interval @xmath48 $ ] , we use @xmath144 , where @xmath100 is the iteration number of the monte carlo cycle .",
    "2 .   * first passage does not happen in the current interval . *",
    "if @xmath79 does nt belong to interval @xmath69 $ ] , then the first passage time has not yet occurred in this interval .",
    "* first passage happens at the right boundary of interval . * if @xmath145 and @xmath146 ( see eq .",
    "( [ index_first_jump ] ) ) , then @xmath147 is the first passage time and @xmath148 .",
    "we evaluate the density function using kernel function @xmath149 , and set ` isdefault`@xmath119 .",
    "next , we increase @xmath56 and examine the next interval and analyze the above three cases for each non - default firm again . after running @xmath91 times the monte carlo cycle",
    ", we get the fptd of firm @xmath42 as @xmath150 , as well as the cumulative default rates @xmath151 .",
    "in this section , we will demonstrate how our model describes the default correlations of the firms , rated in the same way , via studying the historical data .",
    "we provide details on the calibration of the models we apply for this description .      in fig .",
    "[ fig : default : one ] , the black line of square is a set of historical default data of a - rated firm taken from @xcite .    first , if we do not consider jumps , as assumed in , the firm defaults at time @xmath105 with probability : @xmath152 where @xmath153 is the standardized distance of firm @xmath42 to its default point and @xmath154 denotes the cumulative probability distribution function for a standard normal variable .",
    "if historical default rates are given , we can estimate @xmath155 as follows : @xmath156 where @xmath157 are the theoretical default probabilities ( as determined by eq .",
    "( [ default : zhou : model ] ) ) and @xmath158 are the historical default rates . for the a - rated firm considered here ,",
    "the optimized @xmath155 value was evaluated in @xcite as @xmath159 . by feeding the optimized @xmath155-value into eq .",
    "( [ default : zhou : model ] ) , we get the theoretical cumulative default rates without jumps , given in fig . [",
    "fig : default : one ] by the line of circles .    ) .",
    "all the simulations were performed with monte carlo runs @xmath160 , besides , for conventional monte carlo method , the discretization size of time horizon is @xmath161.,width=529 ]    now , let us consider the unif method , developed in section [ subsection : estimation ] and [ methodology ] .",
    "first , the developed monte carlo simulation allows us to obtain the estimated density @xmath162 by using kernel estimator method .",
    "we get also the default rate @xmath163 for firm @xmath42 .",
    "then we minimize the difference between our model and the historical default data to obtain the optimized parameters in our model : @xmath164    for convenience , we reduce the number of optimizing parameters by :    1 .   setting @xmath165 and @xmath166 .",
    "2 .   setting the growth rate @xmath62 of debt value equivalent to the growth rate @xmath167 of the firm s value @xcite ,",
    "so the default of firm is non - sensitive to @xmath167 . setting @xmath168 in our computation",
    "reported next .",
    "3 .   the interjump times @xmath114 satisfy an exponential distribution with mean value equals to 1 .",
    "the arrival rate for jumps satisfies the poisson distribution with intensity parameter @xmath113 , where the jump size is a normal distribution @xmath169 .    as a result",
    ", we only need to optimize @xmath170 , @xmath113 , @xmath171 , @xmath172 for this firm , this is done by minimizing the differences between our simulated default rates and the given historical data .",
    "the minimization was performed by using quasi - newton procedure implemented as a scilab program .",
    "the optimized parameters for the a - rated firm are @xmath173 , @xmath174 , @xmath175 , and @xmath176 .",
    "then , by using these optimized parameters , we carried out a final simulation with monte carlo runs @xmath160 .",
    "the simulated cumulative default rates by using the unif method are shown in fig .",
    "[ fig : default : one ] by the dash line . for comparison ,",
    "we have carried out the conventional monte carlo simulation with the same optimized parameters .",
    "the resulting simulated default rates are displayed by dotted line in fig .",
    "[ fig : default : one ] .",
    "all the simulations reported here were carried out on a 2.4 ghz amd opteron(tm ) processor . the optimal bandwidth and cpu time",
    "are given in table [ tab : hopt ] .",
    ".the optimal bandwidth @xmath177 , and cpu time per monte carlo run of the simulations .",
    "all the simulations were performed with monte carlo runs @xmath160 ; the discretization size of time horizon for the conventional monte carlo method was @xmath161 . [ cols=\"<,^,^\",options=\"header \" , ]     [ simulate : corr ]    in order to implement the unif method , we use assumptions , similar to the ones before , in order to reduce the number of optimized parameters :    1 .",
    "setting @xmath165 and @xmath166 for all firms .",
    "2 .   setting @xmath178 and @xmath168 for all firms .",
    "since we are considering two same rated firms ( a , a ) , we choose @xmath170 as : @xmath179,\\ ] ] where @xmath180 such that @xmath181,\\ ] ] and @xmath182 in ( [ eq : brownian : corr ] ) , @xmath183 reflects the correlation of diffusion parts of the state vectors of the two firms .",
    "the arrival rate for jumps satisfies the poisson distribution with intensity parameter @xmath113 for all firms , and we use the parameters optimized based on a single a - rated firm , i.e. , @xmath174 for all the firms . 5 .   as before",
    ", we generate the same interjump times @xmath114 that satisfies an exponential distribution with mean value equals 1 for all firms .",
    "furthermore , the jump size is a normal distribution @xmath184 , and we use the parameters optimized from a single a - rated firm , i.e. , @xmath185 and @xmath186 for all the firms .    as a result",
    ", there are only 4 parameters left to optimize : @xmath187 , @xmath188 , @xmath189 and @xmath190 .",
    "the optimization was carried out by using the quasi - newton procedure implemented as a scilab program .",
    "the resulting optimized parameters are @xmath191 , @xmath192 , @xmath193 and @xmath194 .",
    "we can easily get @xmath195 , @xmath196 and @xmath197 .",
    "the parameter @xmath183 represents the correlation between diffusion parts of the state vectors of two firms .",
    "the simulated default correlations are displayed in the 3rd column of table [ simulate : corr ] . observe that , the unif method gives a little larger default correlation compared to the theoretical predicted by eq .",
    "( [ default : zhou : model ] ) .",
    "this is mainly because our optimized @xmath183 is larger than @xmath198 used in @xcite , and we have used the same interjump times @xmath114 for all the firms .",
    "nevertheless , the unif method gives the correct default correlation trend , as the default correlation becomes larger with increasing time .",
    "we analyzed the first passage time problem in the context of multivariate and correlated jump - diffusion processes by extending the fast monte carlo - type numerical method ",
    "the unif method  to the multivariate case .",
    "we provided an application example of simulating default correlations confirming the validity of our model and the developed algorithm .",
    "finally , we note that the developed methodology provides an efficient tool for further practical applications such as in credit analysis and barrier option pricing .",
    "this work was supported by nserc .",
    "zhang , d. , melnik , r.v.n . : first passage time for multivariate jump - diffusion stochastic models with applications in finance . presented at the",
    "sixth aims international conference on dynamical systems and differential equations , university of poitiers , poitiers , france , 2006"
  ],
  "abstract_text": [
    "<S> evaluation of default correlation is an important task in credit risk analysis . in many practical situations , </S>",
    "<S> it concerns the joint defaults of several correlated firms , the task that is reducible to a first passage time ( fpt ) problem . </S>",
    "<S> this task represents a great challenge for jump - diffusion processes ( jdp ) , where except for very basic cases , there are no analytical solutions for such problems . in this contribution </S>",
    "<S> , we generalize our previous fast monte - carlo method ( non - correlated jump - diffusion cases ) for multivariate ( and correlated ) jump - diffusion processes . </S>",
    "<S> this generalization allows us , among other things , to evaluate the default events of several correlated assets based on a set of empirical data . </S>",
    "<S> the developed technique is an efficient tool for a number of other applications , including credit risk and option pricing .    </S>",
    "<S> _ keywords _ : default correlation , first passage time problem , monte carlo simulation    * jel classification : * c15    * mathematics subject classification ( 2000 ) : * 65c05 , 60j10 , 60j75 </S>"
  ]
}