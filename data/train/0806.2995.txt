{
  "article_text": [
    "after the great success of elliptic curves in public - key cryptography , researchers have naturally been drawn to their higher - dimensional generalizations : jacobians of higher - genus curves .",
    "curves of genus  @xmath5 ( elliptic curves ) ,  @xmath2 , and  @xmath0 are widely believed to offer the best balance of security and efficiency .",
    "this article is concerned with the security of curves of genus  @xmath0 .",
    "there are two classes of curves of genus  @xmath0 : hyperelliptic and non - hyperelliptic .",
    "each class has a distinct geometry : the canonical morphism of a hyperelliptic curve is a double cover of a curve of genus  @xmath6 , while the canonical morphism of a non - hyperelliptic curve of genus  @xmath0 is a birational map to a nonsingular plane quartic curve",
    ". a hyperelliptic curve can not be isomorphic ( or birational ) to a non - hyperelliptic curve . from a cryptological point of view",
    ", the discrete logarithm problem ( dlp ) in jacobians of hyperelliptic curves of genus  @xmath0 over  @xmath7 may be solved in  @xmath8 group operations , using the index calculus algorithm of gaudry , thom , thriault , and diem  @xcite .",
    "jacobians of non - hyperelliptic curves of genus  @xmath0 over  @xmath7 are amenable to diem s index calculus algorithm  @xcite , which requires only  @xmath9 group operations to solve the dlp ( for comparison , pollard / baby - step - giant - step methods require  @xmath10 group operations to solve the dlp in jacobians of genus  @xmath0 curves over  @xmath7 ) .",
    "the security of non - hyperelliptic genus  @xmath0 curves is therefore widely held to be lower than that of their hyperelliptic cousins .",
    "our aim is to construct explicit homomorphisms to provide a means of efficiently translating instances of the dlp from jacobians of hyperelliptic curves of genus  @xmath0 to jacobians of non - hyperelliptic curves , where faster index calculus is available . in the context of dlp - based cryptography",
    ", we may assume that our jacobians are absolutely simple .",
    "in this situation , every nontrivial homomorphism of jacobians of curves of genus  @xmath0 is an _ isogeny _ : that is , a surjective homomorphism with finite kernel .    to be specific ,",
    "suppose we are given a hyperelliptic curve  @xmath11 of genus  @xmath0 over a finite field  @xmath7 , together with an instance  @xmath12q$ ] of the dlp in  @xmath13 ; our task is to recover  @xmath14 given  @xmath15 and  @xmath16 .",
    "after applying the standard pohlig  hellman reduction  @xcite , we may assume that  @xmath15 and  @xmath16 have prime order .",
    "we want to solve this dlp instance by solving an equivalent dlp instance in a non - hyperelliptic jacobian .",
    "suppose we have an isogeny  @xmath17 , where  @xmath18 is a non - hyperelliptic curve of genus  @xmath0 .",
    "further , suppose that  @xmath19 is explicit ( that is , we have equations for  @xmath18 and an efficient map on divisor classes representing  @xmath19 ) and defined over  @xmath7 , so it maps  @xmath13 into  @xmath20 .",
    "provided  @xmath21 , we can recover  @xmath14 by solving the dlp instance  @xmath22\\phi(q)$ ] in  @xmath20 with diem s algorithm .",
    "the approach outlined above is conceptually straightforward ; the difficulty lies in computing explicit isogenies of jacobians of genus  @xmath0 curves .",
    "automorphisms , integer multiplications , and frobenius maps aside , we know of no explicit and general formulae for isogenies from jacobians of hyperelliptic curves of genus  @xmath0 apart from those presented below .    in   [ section : kernel ] through   [ section : equations - for - the - isogeny ]",
    ", we derive explicit formulae for isogenies whose kernels are generated by differences of weierstrass points , following the construction of donagi and livn  @xcite .",
    "the key step is making recillas trigonal construction  @xcite completely explicit .",
    "this gives us a curve  @xmath23 of genus  @xmath0 and an explicit isogeny  @xmath24 .",
    "while  @xmath23 may be hyperelliptic , nave moduli space dimension arguments suggest ( and experience confirms ) that  @xmath23 will be non - hyperelliptic with an overwhelming probability , and thus explicitly isomorphic to a nonsingular plane quartic curve  @xmath18 .",
    "we can therefore compute an explicit isogeny  @xmath25 ; if  @xmath19 is defined over  @xmath7 , then we can use it to reduce dlp instances .",
    "we note that the trigonal construction ( and hence our formulae ) does not apply in characteristics  @xmath2 and  @xmath0 .",
    "we show in  [ section : probabilities ] that , subject to some reasonable assumptions , given a uniformly randomly chosen hyperelliptic curve  @xmath11 of genus  @xmath0 over a sufficiently large finite field  @xmath7 of characteristic at least  @xmath26 , our algorithms succeed in constructing an explicit isogeny defined over  @xmath7 from  @xmath27 to a non - hyperelliptic jacobian with probability  @xmath28 . in particular , instances of the dlp can be solved in  @xmath9 group operations for around  @xmath4 of all jacobians of hyperelliptic curves of genus  @xmath0 over finite fields of characteristic at least  @xmath26 .",
    "we discuss more general isogenies in   [ section : other - isogenies ] . given explicit formulae for these isogenies , we expect that most , if not all , instances of the dlp in jacobians of hyperelliptic curves of genus  @xmath0 over any finite field could be reduced to instances of the dlp in non - hyperelliptic jacobians .",
    "our results have a number of interesting implications for curve - based cryptography , at least for curves of genus  @xmath0 .",
    "first , the difficulty of the dlp in a subgroup  @xmath29 of  @xmath27 depends not only on the size of the subgroup  @xmath29 , but upon the existence of other rational subgroups of  @xmath27 that can be used to form quotients .",
    "second , the security of a given hyperelliptic genus  @xmath0 curve depends significantly upon the factorization of its hyperelliptic polynomial .",
    "neither of these results has any parallel in genus  @xmath5 or  @xmath2 .",
    "the constructions of  [ section : kernel ] through  [ section : equations - for - the - isogeny ] and  [ section : other - isogenies ] require some nontrivial algebraic geometry .",
    "we have included enough mathematical detail here to enable the reader to compute examples , to justify our claim that the construction is efficient , and to support our heuristics .",
    "this article presents an extended version of work that appeared in the proceedings of the eurocrypt 2008 conference  @xcite .",
    "the chief results are the same ; we have made some ( minor ) changes to our notation , expanded the derivation in   [ section : equations - for - the - isogeny ] , given further details and proofs throughout , and added an appendix with algorithms to compute sets of tractable subgroups .",
    "we will work over  @xmath7 throughout this article , and   [ section : equations - for - the - isogeny ] are valid over fields of characteristic not  @xmath2 or  @xmath0 .",
    "] where @xmath30 is a power of a prime  @xmath3 .",
    "we let  @xmath31 denote the galois group  @xmath32 , which is ( topologically ) generated by the  @xmath33 power frobenius map .",
    "suppose we are given a hyperelliptic curve  @xmath11 of genus  @xmath0 over  @xmath7 .",
    "we will use both an affine model @xmath34 where  @xmath35 is a squarefree polynomial of degree  @xmath36 or  @xmath37 , and a weighted projective plane model @xmath38 for  @xmath11 ( here  @xmath39 ,  @xmath40 , and  @xmath41 have weights  @xmath5 ,  @xmath5 , and  @xmath42 , respectively ) .",
    "the coordinates of these models are related by @xmath43 and  @xmath44 .",
    "the polynomial  @xmath45 is squarefree of total degree  @xmath37 , with @xmath46 and  @xmath47 .",
    "we emphasize that  @xmath35 need not be monic . by a _",
    "randomly chosen hyperelliptic curve _",
    ", we mean the hyperelliptic curve defined by  @xmath48 , where  @xmath45 is a uniformly randomly chosen squarefree homogenous bivariate polynomial of degree  @xmath37 over  @xmath7",
    ". the canonical _ hyperelliptic involution _",
    "@xmath49 of  @xmath11 is defined by @xmath50 in the affine model , @xmath51 in the projective model , and induces the negation map  @xmath52 $ ] on  @xmath27 .",
    "the quotient  @xmath53 sends  @xmath54 to  @xmath55 in the projective model , and  @xmath56 to  @xmath57 in the affine model ( where it maps onto the affine patch of  @xmath58 where  @xmath59 ) .    to compute in  @xmath27",
    ", we fix an isomorphism from  @xmath27 to the group of degree-@xmath6 divisor classes on  @xmath11 , denoted  @xmath60 . recall that divisors are formal sums of points in  @xmath61 , and if @xmath62 is a divisor , then  @xmath63 is the _ degree _ of  @xmath64 .",
    "we say  @xmath64 is _ principal _ if @xmath65 for some function  @xmath66 on  @xmath11 , where  @xmath67 denotes the number of zeroes ( or the negative of the number of poles ) of  @xmath66 at  @xmath15 . since  @xmath11 is complete , every principal divisor has degree  @xmath6 .",
    "the group  @xmath60 is defined to be the group of divisors of degree  @xmath6 modulo principal divisors ; the equivalence class of a divisor  @xmath64 is denoted by  @xmath68 $ ] .",
    "we let  @xmath69 $ ] denote the  @xmath70-torsion subgroup of  @xmath27 : that is , the kernel of the multiplication - by-@xmath70 map .",
    "if  @xmath70 is prime to  @xmath30 , then  @xmath69({{\\overline{\\mathbb{f}}}}_{q})$ ] is isomorphic to  @xmath71 .",
    "the eight points of  @xmath72 where  @xmath73 are called the _ weierstrass points _ of  @xmath11 .",
    "each weierstrass point  @xmath74 corresponds to a linear factor @xmath75 of  @xmath45 , which is defined up to scalar multiples .",
    "if  @xmath76 and  @xmath77 are weierstrass points , then @xmath78 , so  @xmath79 = 0 $ ] ; hence  @xmath80 $ ] represents an element of  @xmath81({{\\overline{\\mathbb{f}}}}_{q})$ ] .",
    "in particular ,  @xmath80 = [ ( w_2 ) - ( w_1)]$ ] , so the divisor class  @xmath80 $ ] corresponds to the pair  @xmath82 of weierstrass points , and hence to the quadratic factor  @xmath83 of  @xmath45 ( up to scalar multiples ) .",
    "[ proposition : partitions - and - tractable - subgroups ] to every  @xmath31-stable partition of the eight weierstrass points of  @xmath11 into four disjoint pairs , we may associate an  @xmath7-rational subgroup of @xmath81({{\\overline{\\mathbb{f}}}}_{q})$ ] isomorphic to  @xmath1 .",
    "let @xmath84 be a partition of the set of weierstrass points of  @xmath11 into four disjoint pairs .",
    "each pair  @xmath85 corresponds to the  @xmath2-torsion divisor class @xmath86 $ ] in  @xmath81({{\\overline{\\mathbb{f}}}}_{q})$ ] .",
    "we associate the subgroup @xmath87 : 1 \\le i \\le 4}\\right\\rangle}}$ ] to the partition .",
    "observe that @xmath88           =           \\big[\\mathrm{div}\\big(w/\\prod_{i=1}^4 l_{w_i''}\\big)\\big ]           =           0          ; \\ ] ] this is the only relation on the classes  @xmath86 $ ] , so  @xmath89 .",
    "the action of  @xmath31 on  @xmath81({{\\overline{\\mathbb{f}}}}_{q})$ ] corresponds to its action on the weierstrass points , so if the partition is  @xmath31-stable , then the subgroup  @xmath90 is  @xmath31-stable .    by `` an  @xmath7-rational subgroup of  @xmath81({{\\overline{\\mathbb{f}}}}_{q})$ ] isomorphic to  @xmath1 '' , we mean a  @xmath31-stable subgroup that is isomorphic to  @xmath1 over  @xmath91 .",
    "we emphasize that the subgroup need _ not _ be contained in  @xmath13 .    requiring the pairs of weierstrass points in proposition  [ proposition : partitions - and - tractable - subgroups ] to be disjoint ensures that the associated subgroup is isotropic with respect to the @xmath2-weil pairing .",
    "we will see in   [ section : other - isogenies ] that this is necessary for the quotient by the subgroup to be an isogeny of principally polarized abelian varieties , and hence for the quotient to be an isogeny of jacobians .",
    "we call the subgroups corresponding to partitions of the weierstrass points of  @xmath11 as in proposition  [ proposition : partitions - and - tractable - subgroups ] _",
    "tractable subgroups_. we let  @xmath92 denote the set of all  @xmath7-rational tractable subgroups of  @xmath81({{\\overline{\\mathbb{f}}}}_{q})$ ] .    not every subgroup of  @xmath81({{\\overline{\\mathbb{f}}}}_{q})$ ] that is the kernel of an isogeny of jacobians is a tractable subgroup .",
    "for example , if  @xmath93 are the weierstrass points of  @xmath11 , then the subgroup @xmath94          :              ( i , j , k ) \\in \\ { ( 2,3,4 ) , ( 2,5,6 ) , ( 3,5,7 ) \\ }          } \\right\\rangle}}\\ ] ] is a maximal  @xmath2-weil isotropic subgroup of @xmath95 , and hence is the kernel of an isogeny of jacobians ( see   [ section : other - isogenies ] ) .",
    "however , this subgroup contains no nontrivial differences of weierstrass points , and therefore can not be a tractable subgroup .    computing  @xmath92 is straightforward if we identify each tractable subgroup with its corresponding partition of weierstrass points .",
    "recall that each pair of weierstrass points  @xmath96 corresponds to a quadratic factor of  @xmath45 ( up to scalar multiples ) . since the pairs are disjoint , the corresponding quadratic factors are pairwise coprime , so we may take them to form a factorization of  @xmath45 .",
    "we therefore have a correspondence of tractable subgroups , partitions of weierstrass points into pairs , and sets of quadratic polynomials ( up to scalar multiples ) : @xmath97 the action of  @xmath31 on  @xmath81({{\\overline{\\mathbb{f}}}}_{q})$ ] corresponds to its action on the set of weierstrass points , so the action of  @xmath31 on a tractable subgroup  @xmath90 corresponds to the action of  @xmath31 on the corresponding set  @xmath98 ( assuming the @xmath99 have been scaled appropriately ) . in particular , @xmath90 is  @xmath7-rational precisely when  @xmath98 is fixed by  @xmath31 .",
    "the factors  @xmath99 are themselves defined over  @xmath7 precisely when the corresponding points of  @xmath90 are  @xmath7-rational .",
    "we can use this information to compute  @xmath92 .",
    "the set of pairs of weierstrass points contains a  @xmath31-orbit @xmath100 if and only if ( possibly after exchanging some of the  @xmath101 with the  @xmath102 ) either both  @xmath103 and  @xmath104 are  @xmath31-orbits or @xmath105 is a  @xmath31-orbit .",
    "every  @xmath31-orbit of weierstrass points corresponds to an  @xmath7-irreducible factor of  @xmath35 , so the size of  @xmath92 depends only on the factorization of  @xmath35 . a table relating the size of  @xmath92 to the factorization of  @xmath45 appears in lemma  [ lemma : number - of - tractable - subgroups ] below ; this will be useful for our analysis in   [ section : probabilities ] .",
    "for completeness , we have included a nave algorithm for enumerating  @xmath92 in appendix  [ appendix : computing - sh ] .",
    "[ lemma : number - of - tractable - subgroups ] let  @xmath106 be a hyperelliptic curve of genus  @xmath0 over  @xmath7 .",
    "the cardinality of the set  @xmath92 depends only on the degrees of the  @xmath7-irreducible factors of  @xmath45 , and is described by the following table :    [ cols=\"^,^\",options=\"header \" , ]     this is a routine combinatorial exercise after noting that every  @xmath31-orbit of pairs of weierstrass points corresponds to either an even - degree factor of  @xmath35 , or a pair of factors of  @xmath35 of the same degree .",
    "we will now briefly outline the theoretical aspects of constructing isogenies with tractable kernels . we will make the construction completely explicit in  [ section : computing - trigonal - maps ] and   [ section : equations - for - the - isogeny ] .",
    "suppose  @xmath107 : 1 \\le i \\le 4}\\right\\rangle}}$ ] is a tractable subgroup .",
    "we say that a morphism  @xmath108 is a _",
    "trigonal map for  @xmath90 _ if @xmath109 has degree  @xmath0 and  @xmath110 for  @xmath111 .",
    "given a trigonal map  @xmath109 for some tractable subgroup  @xmath90 , recillas trigonal construction  @xcite specifies a curve  @xmath23 of genus  @xmath0 and a map  @xmath112 of degree  @xmath42 .",
    "is an tale double cover ; the trigonal construction we apply here is in fact the flat limit of recillas construction ( see  @xcite for details ) . ]",
    "the isomorphism class of  @xmath23 depends only on  @xmath90 , and is independent of the choice of  @xmath109 ( see recillas  @xcite , donagi  ( * ? ? ?",
    "2.11 ) , and remark  [ remark : trigonal - map - descent ] below ) .",
    "theorem  [ theorem : isogeny - from - trigonal - construction ] , due to donagi and livn , states that if  @xmath109 is a trigonal map for  @xmath90 , then  @xmath90 is the kernel of an isogeny from  @xmath27 to  @xmath113 .",
    "[ theorem : isogeny - from - trigonal - construction ] let  @xmath90 be a tractable subgroup in  @xmath92 , and let  @xmath108 be a trigonal map for  @xmath90 . if  @xmath23 is the curve formed from  @xmath109 by recillas trigonal construction , then there is an isogeny  @xmath114 ( defined over  @xmath91 ) with kernel  @xmath90 .",
    "we will give only a brief description of the geometry of  @xmath23 here , concentrating instead on its explicit construction ; we refer the reader to recillas  @xcite , vakil  @xcite , donagi  @xcite , and birkenhake and lange  @xcite for proofs and further detail . the isogeny of theorem  [ theorem : isogeny - from - trigonal - construction ] is analogous to the well - known richelot isogeny in genus  @xmath2 ( see bost and mestre  @xcite , and donagi and livn  @xcite for details ) , and to the explicit isogeny described by lehavi and ritzenthaler in  @xcite for jacobians of non - hyperelliptic genus @xmath0 curves .    in abstract terms ,",
    "if  @xmath115 is the subset of the codomain of  @xmath109 above which  @xmath116 is unramified , then  @xmath23 is by definition the closure of the curve over  @xmath115 representing the pushforward to  @xmath115 of the sheaf of sections of  @xmath117 ( in the tale topology ) .",
    "this means in particular that the  @xmath91-points of  @xmath23 over an  @xmath91-point  @xmath15 of  @xmath115 represent partitions of the six  @xmath91-points of  @xmath118 into two sets of three exchanged by the hyperelliptic involution .",
    "the fibre product of  @xmath11 and  @xmath23 over  @xmath58 with respect to  @xmath116 and  @xmath66 is the union of two isomorphic curves ,  @xmath119 and  @xmath120 , which are exchanged by the involution on  @xmath121 induced by the hyperelliptic involution .",
    "the natural projections induce coverings  @xmath122 and  @xmath123 of degrees  @xmath2 and  @xmath0 , respectively , so  @xmath119 is a  @xmath124-correspondence between  @xmath11 and  @xmath23 .",
    "the maps  @xmath125 and  @xmath126 induce homomorphisms  @xmath127 ( the _ pullback _ ) and  @xmath128 ( the _ pushforward _ ) . in terms of divisor classes , the pullback is defined by @xmath129\\big )       =       \\big [ \\sum_{p \\in h}n_p\\!\\!\\!\\!{\\sum_{q",
    "\\in \\pi_h^{-1}(p)}}\\!\\!\\!\\!(q ) \\big],\\ ] ] with appropriate multiplicities where  @xmath125 ramifies ; the pushforward is defined by @xmath130\\big )       =       \\big [ \\sum_{q\\in r}m_q(\\pi_x(q ) ) \\big ]      .\\ ] ] composing  @xmath131 with  @xmath132 , we obtain an isogeny  @xmath114 with kernel  @xmath90 .",
    "if we replace  @xmath119 with  @xmath120 in the above , we obtain an isogeny isomorphic to  @xmath133 .",
    "thus , up to isomorphism , the construction of the isogeny depends only on the subgroup  @xmath90 . the curves and jacobians described above form the commutative diagrams shown in  figure  [ table : curve - diagram ] .",
    "@xmath134 & r&&&{\\ensuremath{{j}_{r}}}\\\\ h&&x&{\\ensuremath{{j}_{h}}}&&{\\ensuremath{{j}_{x}}}\\\\ { \\ensuremath{\\mathbb{p}^{1}_{{}}}}\\\\ & { \\ensuremath{\\mathbb{p}^{1 } _ { { } } } } \\ncline[nodesep=3pt]{->}{1,2}{2,1}^{\\pi_h}_2 \\ncline[nodesep=3pt]{->}{1,2}{2,3}^{\\pi_x}_3 \\ncline[nodesep=3pt]{->}{2,1}{3,1}<{\\pi}>2 \\ncline[nodesep=3pt]{->}{3,1}{4,2}^{3}_g \\ncline[nodesep=3pt]{->}{2,3}{4,2}^{4}_f \\ncline[nodesep=3pt]{->}{2,4}{2,6}_{\\phi } \\ncline[nodesep=3pt]{->}{2,4}{1,5}<{\\pi_h^ * } \\ncline[nodesep=3pt]{->}{1,5}{2,6}>{(\\pi_x ) _ * } \\end{psmatrix}\\ ] ]    the hyperelliptic jacobians form a codimension-@xmath5 subspace @xmath135 of the moduli space of @xmath0-dimensional principally polarized abelian varieties  which , by the theorem of oort and ueno  @xcite , is also the moduli space @xmath136 of jacobians of genus  @xmath0 curves .",
    "the weil hypotheses imply that @xmath137 for sufficiently large @xmath30 ( cf .",
    "* theorem 1 ) ) .",
    "in particular , for cryptographically relevant sizes of  @xmath30 , the probability that a uniformly randomly chosen curve @xmath23 of genus @xmath0 over @xmath7 should be hyperelliptic is negligible .",
    "we will suppose that the same is true for the curve @xmath23 constructed in theorem  [ theorem : isogeny - from - trigonal - construction ] for a uniformly randomly chosen @xmath11 and @xmath90 in @xmath92 .",
    "this is consistent with our experimental observations , so we postulate hypothesis  [ hypothesis : hyperellipticity ] .    [ hypothesis : hyperellipticity ] the probability that the curve  @xmath23 constructed by the trigonal construction for a randomly chosen  @xmath138 and  @xmath90 in  @xmath92 is hyperelliptic is negligible for sufficiently large @xmath30 .",
    "suppose we are given a tractable subgroup @xmath90 of  @xmath81({{\\overline{\\mathbb{f}}}}_{q})$ ] , corresponding to a partition  @xmath139 of the weierstrass points of  @xmath11 into pairs .",
    "the first step in the explicit trigonal construction is to compute a trigonal map  @xmath109 for  @xmath90 .",
    "we will compute polynomials  @xmath140 and  @xmath141 such that the rational map @xmath142 defines a trigonal map for  @xmath90 .",
    "the derivation is an exercise in classical geometry ; we include it here to demonstrate its efficiency and to justify hypothesis  [ hypothesis : trigonal - map - rationality ] , which will be important in determining the expectation of success of our reduction in   [ section : probabilities ] .",
    "the reader prepared to admit the existence of efficiently computable trigonal maps in the form of   may skip the remainder of this section on first reading .    by definition",
    ", @xmath108 is a degree-@xmath0 map with @xmath143 for  @xmath111",
    ". we will express  @xmath109 as a composition @xmath144 , where  @xmath145 is the rational normal embedding defined by @xmath146 and  @xmath147 is the projection defined as follows .",
    "for each  @xmath111 , we let  @xmath148 denote the line in  @xmath149 passing through  @xmath150 and  @xmath151",
    ". there exists at least one line  @xmath152 intersecting all four of the  @xmath148 ( in fact there are two , though they may coincide ; we will compute them below ) .",
    "we take  @xmath153 to be the projection away from  @xmath152 ; then @xmath154 for  @xmath111 , so @xmath155 is a trigonal map for  @xmath90 .",
    "given linear equations for  @xmath152 in the coordinates  @xmath156 , we can use gaussian elimination to compute elements  @xmath157 ,  @xmath158 ,  @xmath159 , and  @xmath160 of  @xmath7 such that @xmath161 the projection  @xmath147 away from  @xmath152 is then defined by @xmath162 so our trigonal map  @xmath155 is defined by @xmath163 therefore , if we set  @xmath164 and  @xmath165 , then  @xmath109 will be defined by the rational map @xmath166 .    to compute equations for  @xmath152",
    ", we will use the classical theory of _",
    "grassmannian varieties_. the elementary lemmas  [ lemma : grassmannian - correspondence ] and  [ lemma : hyperplane ] will be stated without proof ; we refer the reader to griffiths and harris  @xcite and harris  ( * ? ? ?",
    "* lecture 6 ) for details .",
    "the set of lines in  @xmath149 has the structure of an algebraic variety  @xmath167 , called the grassmannian .",
    "there is a convenient model for  @xmath167 as a quadric hypersurface in  @xmath168 : if  @xmath169 are coordinates on  @xmath168 , then we may take @xmath170    [ lemma : grassmannian - correspondence ] there is a bijection between points of  @xmath171 and lines in  @xmath149 , defined as follows .    1",
    ".   the point of  @xmath171 corresponding to the line through @xmath172 and  @xmath173 in  @xmath149 has coordinates @xmath174 2 .",
    "the line in  @xmath149 corresponding to a point @xmath175 of  @xmath171 is defined  by @xmath176 ( two of the equations will be redundant linear combinations of the others ) .",
    "[ lemma : hyperplane ] let  @xmath152 be the line in  @xmath149 corresponding to a point @xmath175 of  @xmath171",
    ". the points in  @xmath171 corresponding to lines in  @xmath149 that intersect nontrivially with  @xmath152 are precisely the points lying in the hyperplane defined by @xmath177 ( where the subscripts are taken modulo  @xmath178 ) .",
    "suppose  @xmath90 is represented by a set  @xmath179 of quadratic factors of  @xmath45 ( as in   [ section : kernel ] ) , with each factor @xmath99 corresponding to a pair  @xmath180 of weierstrass points .",
    "applying lemma  [ lemma : grassmannian - correspondence ] , we see that the line  @xmath148 through  @xmath150 and  @xmath151 corresponds to the point @xmath181 on  @xmath167 .",
    "if  @xmath175 in  @xmath171 corresponds to a candidate for  @xmath152 , then by lemma  [ lemma : hyperplane ] we have  @xmath182 , where @xmath183 the kernel of  @xmath184 is two - dimensional , corresponding to a line  @xmath185 in  @xmath168 . the kernel is independent of the ordering of the  @xmath99 , and does not change if we replace the  @xmath99 by scalar multiples ; hence ,  @xmath185 depends only on the subgroup  @xmath90 .",
    "let @xmath186 be a basis for  @xmath187 , writing  @xmath188 and  @xmath189 .",
    "if  @xmath90 is  @xmath7-rational , then so is  @xmath187 , so we may take the  @xmath190 and  @xmath191 to be in  @xmath7 ( see cartier  @xcite ) .",
    "we want to find a point @xmath192 where  @xmath185 intersects with  @xmath167 .",
    "the points  @xmath193 on the line  @xmath152 in  @xmath149 corresponding to  @xmath194 satisfy @xmath195 , where @xmath196 by part  ( 2 ) of lemma  [ lemma : grassmannian - correspondence ] , the rank of  @xmath197 is  @xmath2 . using the expression @xmath198 ( where the subscripts are taken modulo  @xmath178 ) , we see that  @xmath197 has rank  @xmath2 precisely when @xmath199 : we can therefore solve @xmath199 to determine a value for  @xmath200",
    ". finally , we use gaussian elimination to compute  @xmath157 ,  @xmath158 ,  @xmath159 , and  @xmath160 in  @xmath201 such that  @xmath202 and  @xmath203 generate the rowspace of @xmath204 .",
    "we then take @xmath205 , and compute  @xmath153 , @xmath206 , and the trigonal map  @xmath155 as above .",
    "since  @xmath152 is defined over  @xmath201 , so is the projection  @xmath153 and the trigonal map  @xmath109 .",
    "but  @xmath200 satisfies a quadratic equation with coefficients in  @xmath7 , so @xmath201 is at most a quadratic extension of  @xmath7 .",
    "computing the discriminant of  @xmath207 , we obtain a criterion for existence of trigonal maps over  @xmath7 for a given tractable subgroup .",
    "[ proposition : trigonal - map - rationality - criterion ] suppose  @xmath90 is a tractable subgroup , and let @xmath208 be any  @xmath7-rational basis of the nullspace of the matrix  @xmath184 defined in .",
    "there exists an  @xmath7-rational trigonal map for  @xmath90 if and only if @xmath209 is a square in  @xmath7 , where the subscripts are taken modulo  @xmath178 .",
    "from the derivation above , we see that there exists an @xmath7-rational trigonal map for @xmath90 if and only if we can find a @xmath200 in @xmath7 such that @xmath210 . by equation",
    ", we can find such a @xmath200 if and only if the quadratic polynomial @xmath211 has two roots in @xmath7 .",
    "this occurs precisely when the discriminant of this polynomial  the expression in   above  is a square in @xmath7 .",
    "proposition  [ proposition : trigonal - map - rationality - criterion ] shows that the rationality of a trigonal map for a tractable subgroup  @xmath90 depends only upon whether an element of  @xmath7 depending only on  @xmath90 is a square .",
    "it seems reasonable to assume that these field elements are uniformly distributed for uniformly random choices of  @xmath11 and  @xmath90 , and indeed this is consistent with our experimental observations . since a uniformly randomly chosen element of  @xmath7 is a square with probability  @xmath212 , we propose hypothesis  [ hypothesis : trigonal - map - rationality ] .    [",
    "hypothesis : trigonal - map - rationality ] the probability that there exists an  @xmath7-rational trigonal map for a subgroup @xmath90 uniformly randomly chosen from @xmath92 , where @xmath11 is a randomly chosen hyperelliptic curve over  @xmath7 , is  @xmath213 .",
    "suppose we have a hyperelliptic curve  @xmath11 of genus  @xmath0 , a tractable subgroup  @xmath90 in  @xmath92 , and a trigonal map  @xmath109 for  @xmath90 .",
    "we will now perform an explicit trigonal construction on  @xmath109 to compute a curve  @xmath23 and an isogeny  @xmath114 with kernel  @xmath90 .",
    "we assume that  @xmath109 has been derived as in  [ section : computing - trigonal - maps ] , and in particular that  @xmath214 is defined by a rational map in the form @xmath215 observe that  @xmath109 maps the point at infinity to the point at infinity ( that is ,  @xmath216 ) .",
    "for notational convenience , we define @xmath217 unless otherwise noted , we will view  @xmath218 as an element of  @xmath219[x]$ ] .",
    "we have @xmath220 we also define  @xmath221 ,  @xmath222 , and  @xmath223 to be the elements of  @xmath219 $ ] such that @xmath224    let  @xmath115 be the subset of  @xmath225 above which  @xmath116 is unramified . with the notation above , @xmath226)\\setminus{\\ensuremath{v\\!\\left ( {          ( f_1 ^ 2 - 4f_2f_0)(4g_2 ^ 3g_0 - g_2 ^ 2g_1 ^ 2 - 18g_2g_1g_0 + 4g_1 ^ 3 + 27g_0 ^ 2 )      } \\right ) } }      .\\ ] ]",
    "we will derive equations for an affine model  @xmath227 of  @xmath228  that is , the open subset of  @xmath23 over  @xmath115 .",
    "we will not prove here that the normalization of  @xmath227 is isomorphic to the curve  @xmath23 specified by recillas , but we will exhibit a bijection on geometric points . if  @xmath23 is not hyperelliptic , then taking the canonical map of  @xmath227 into  @xmath229 will give us a nonsingular plane quartic curve  @xmath18 isomorphic to  @xmath23 .    by definition ,",
    "every point  @xmath15 in  @xmath230 corresponds to a pair of unordered triples of points in  @xmath72 , exchanged by the hyperelliptic involution , with each triple supported on the fibre of  @xmath116 over  @xmath231 . to be more explicit ,",
    "suppose  @xmath16 is a generic point of  @xmath115 .",
    "since  @xmath116 is unramified above  @xmath16 , we may choose three preimages @xmath232 ,  @xmath233 , and  @xmath234 of  @xmath16 such that @xmath235 viewing unordered triples of points as effective divisors of degree  @xmath0 ( that is , as formal sums of three points ) , we have @xmath236 note that  @xmath237 and  @xmath238 never appear in the same divisor for any  @xmath239 .",
    "there is a one - to - one correspondence between effective divisors of degree  @xmath0 on  @xmath11 satisfying this condition , and ideals @xmath240 where  @xmath241 is a monic cubic polynomial and @xmath242 is a quadratic polynomial satisfying  @xmath243 ( this is the well - known _ mumford representation _  ( * ? ? ? *  iiia ) ) .",
    "for example , @xmath244 corresponds to the ideal  @xmath245 where  @xmath246 and  @xmath242 satisfies  @xmath247 for  @xmath239 ( with appropriate multiplicities ) ; we may compute  @xmath242 using the lagrange interpolation formula .",
    "a divisor is defined over  @xmath248 if and only if  @xmath241 and  @xmath242 are defined over  @xmath248 .",
    "the ideal @xmath245 corresponds to  @xmath249 if and only if @xmath250 corresponds to  @xmath251 ; so each point of  @xmath23 over  @xmath115 corresponds to a pair  @xmath252 of ideals .",
    "we will construct a curve parametrizing these pairs of ideals , and take this as a model for  @xmath227 .",
    "suppose  @xmath253 is a pair of ideals corresponding to one of the preimages of  @xmath16 on  @xmath227 .",
    "the product of the two ideals is equal to the principal ideal  @xmath254 ; but products of ideals correspond to sums of divisors , so  @xmath254 must cut out the divisor @xmath255 on  @xmath11 .",
    "this divisor is just  @xmath256 , which we know is cut out by  @xmath257 ; so we conclude that @xmath258 for every pair of ideals  @xmath253 corresponding to a point in  @xmath259 . in particular , the generic point of  @xmath227 corresponds to a pair of ideals of the form @xmath260 , where  @xmath261 ,  @xmath262 , and  @xmath263 are algebraic functions of  @xmath264 such that @xmath265 viewing  @xmath261 ,  @xmath262 , and  @xmath263 as coordinates on  @xmath266 ( over  @xmath7 ) , we expand both sides of   modulo  @xmath218 and equate coefficients to obtain a variety  @xmath267 in  @xmath268 parametrizing ideals : @xmath269 where @xmath270    the ideals in each pair  @xmath271 are exchanged by the involution @xmath272 defined by @xmath273 the curve  @xmath227 is therefore the quotient of  @xmath267 by  @xmath274 . to make this quotient explicit ,",
    "let  @xmath275 be the map defined by @xmath276 observe that @xmath277 we have  @xmath278 , so @xmath279 where  @xmath280 ,  @xmath281 , and  @xmath282 are the polynomials defined by @xmath283 observe that  @xmath227 is defined over the field of definition of  @xmath109 .",
    "it remains to derive a correspondence  @xmath119 between  @xmath11 and  @xmath227 inducing the isogeny  @xmath19 .",
    "we know that  @xmath119 is a component of the fibre product @xmath284 ( with respect to  @xmath285 and  @xmath66 ) .",
    "we may realise the open affine subset @xmath286 as the subvariety  @xmath287 of  @xmath288 ; decomposing the ideal  @xmath289 will therefore give us a model for  @xmath119 .",
    "[ lemma : square - root - of - s ] let  @xmath290 be the polynomial in  @xmath219 $ ] defined by @xmath291{l }              f_0 ^ 3 - f_0 ^ 2f_1g_2 - 2f_0 ^ 2f_2g_1 + f_0 ^ 2f_2g_2 ^ 2               + f_0f_1 ^ 2g_1 + 3f_0f_1f_2g_0 - f_0f_1f_2g_1g_2           \\\\ { }              - 2f_0f_2 ^ 2g_0g_2 + f_0f_2 ^ 2g_1 ^ 2 - f_1 ^ 3g_0",
    "+ f_1 ^ 2f_2g_0g_2 - f_1f_2 ^ 2g_0g_1 + f_2 ^ 3g_0 ^ 2          ,          \\end{array}\\ ] ] and let  @xmath292 be its leading coefficient .",
    "then  @xmath290 has a square root in  @xmath293 $ ] .",
    "the polynomial  @xmath290 is a square in  @xmath293 $ ] if and only if each of its roots in  @xmath91 occur with multiplicity  @xmath2 . in the notation of",
    ", we have @xmath294 so  @xmath295 if and only if  @xmath296 for some  @xmath239  that is , if and only if at least one of the  @xmath237 is a weierstrass point of  @xmath11 .",
    "but the trigonal map  @xmath109 was constructed precisely so that the weierstrass points of  @xmath11 appear in pairs in the fibres of  @xmath109 : hence exactly two of the  @xmath237 must be weierstrass points , and so  @xmath297 and  @xmath295 with multiplicity  @xmath2 .    [",
    "proposition : b22-t - equation ] let  @xmath290 be the polynomial of lemma  [ lemma : square - root - of - s ] , and let  @xmath298 ,  @xmath299 ,  @xmath300 , and  @xmath301 be the polynomials in  @xmath302 $ ] defined by @xmath303 on the curve  @xmath227 , we have @xmath304    consider again the fibre of  @xmath112 over the generic point  @xmath305 of  @xmath115 ( as in  ) .",
    "if  @xmath306 is a pair of divisors corresponding to one of the points in the fibre , then by the lagrange interpolation formula the value of  @xmath307 at the corresponding point of  @xmath267  is @xmath308 where the sum is taken over the cyclic permutations  @xmath309 of  @xmath310 .",
    "after interpolating for each pair of divisors in the fibre , an elementary but involved symbolic calculation shows that @xmath307 satisfies @xmath311 where @xmath312 with @xmath313 for each cyclic permutation  @xmath309 of  @xmath310 , and where @xmath314 .",
    "now  @xmath315 ,  @xmath316 ,  @xmath317 , and  @xmath318 are symmetric functions with respect to permutations of the points in the fibre  @xmath319 .",
    "they are therefore polynomials in the homogeneous elementary symmetric functions @xmath320 which are polynomials in  @xmath264 .",
    "indeed , the  @xmath321 are given by the coefficients of @xmath218 : @xmath322 expressing @xmath315 ,  @xmath316 ,  @xmath317 , and  @xmath318 in terms of  @xmath221 ,  @xmath222 ,  @xmath223 ,  @xmath323 ,  @xmath324 , and  @xmath325 , and substituting the resulting expressions into  , we obtain .",
    "equation   gives us a ( singular ) affine plane model for  @xmath23 .",
    "we can also use   to compute a square root for  @xmath307 on  @xmath227 : we have @xmath326 returning to  , we observe that @xmath307 is a unit on  @xmath227 , since its zeroes and poles occur only at points  @xmath16 where  @xmath116 is ramified over  @xmath327 , and these points were excluded from  @xmath115 . since  @xmath328 is the square root of  @xmath307 , it must also be a unit on  @xmath227 .    given a point  @xmath329 of  @xmath227 , the corresponding pair of divisors of degree @xmath0 on  @xmath11 is cut out by the pair of ideals @xmath330 this is precisely the decomposition of  @xmath289 that we need to compute the correspondence from  @xmath331 to  @xmath227 : we have @xmath332 , where @xmath333 and @xmath334 on the level of divisor classes , the isogeny  @xmath114 is made explicit by the map @xmath335 where @xmath122 and  @xmath336 are the natural projections defined by @xmath337 and @xmath338 , respectively . in terms of ideals cutting out effective divisors , @xmath19 is realized by the map @xmath339      .\\ ] ] taking  @xmath120 in place of  @xmath119 in the above gives an isogeny equal to  @xmath133 .",
    "it remains to determine the field of definition of  @xmath19 .",
    "[ proposition : x - rationality - criterion ] if  @xmath90 is a subgroup in  @xmath92 with an  @xmath7-rational trigonal map  @xmath109 defined over  @xmath7 , and  @xmath340 is the polynomial defined in lemma  [ lemma : square - root - of - s ] .",
    "then the explicit trigonal construction on  @xmath109 described above yields an isogeny defined over  @xmath7 if and only if the leading coefficient of  @xmath340 is a square in  @xmath7 .",
    "we noted earlier that  @xmath227 is defined over the field of definition of  @xmath109 .",
    "the correspondence  @xmath119 , and hence the induced isogeny  @xmath19 , are both defined over the field of definition of  @xmath328 , which is the field of definition of @xmath341 , @xmath342 , and @xmath343 . but @xmath301 , @xmath301 , and @xmath298 are all defined over @xmath7 ( cf .",
    "proposition  [ proposition : b22-t - equation ] ) , while @xmath299 is defined over @xmath344 where @xmath292 is the leading coefficient of @xmath290 by lemma  [ lemma : square - root - of - s ] .",
    "if  @xmath19 is not defined over  @xmath7 , then the jacobian  @xmath113 is in fact a quadratic twist of the quotient  @xmath345 ( see   [ section : other - isogenies ] ) .",
    "in fact , when  @xmath19 is not  @xmath7-rational , frobenius exchanges  @xmath328 and  @xmath346 , hence  @xmath119 and  @xmath120 , and therefore @xmath19 and  @xmath133 .",
    "this is a concrete realization of the galois cohomology referred to in the proof of proposition  [ proposition : kernels ] below : the obstruction to the existence of an isomorphism from  @xmath345 to  @xmath113 over  @xmath7 is in fact the interaction of  @xmath31 with  @xmath347 $ ] on  @xmath113 .",
    "if we assume that the leading coefficients of the polynomials  @xmath340 are uniformly distributed for randomly chosen  @xmath11 ,  @xmath90 , and  @xmath109 , then the probability that @xmath290 is a square in  @xmath219 $ ] is  @xmath213 .",
    "indeed , it is easily seen that @xmath340 is a square for  @xmath11 if and only if it is not a square for the quadratic twist of  @xmath11 .",
    "suppose  @xmath106 is a hyperelliptic curve .",
    "let  @xmath348 be a non - square in  @xmath7 , and let  @xmath349 be the quadratic twist of  @xmath11 .",
    "suppose  @xmath90 in  @xmath92 is a tractable subgroup , represented by a set  @xmath98 of quadratic factors of  @xmath45 .",
    "the set  @xmath350 is a factorization of  @xmath351 , so it represents a tractable subgroup  @xmath352 in  @xmath353 .",
    "we noted in   [ section : computing - trigonal - maps ] that scalar multiples of quadratic polynomials do not affect the construction of trigonal maps ; so if  @xmath90 has a trigonal map  @xmath109 defined over  @xmath7 , then  @xmath109 is also a trigonal map for  @xmath352 .",
    "let  @xmath290 be the polynomial computed from  @xmath109 and  @xmath90 in lemma  [ lemma : square - root - of - s ] , and let  @xmath354 be the corresponding polynomial computed for  @xmath109 and  @xmath352 .",
    "looking at the form of  , we see that  @xmath355 .",
    "therefore , the leading coefficient of  @xmath354 is a square if and only if the leading coefficient of  @xmath290 is _ not _ a square . in particular , if  @xmath90 has a trigonal map defined over  @xmath7 , then so does  @xmath352 , and we can construct an isogeny of jacobians with kernel  @xmath90 if and only if we can not construct an isogeny of jacobians with kernel  @xmath352 .",
    "this suggests that the probability that we can compute an isogeny defined over  @xmath7 given a randomly chosen  @xmath11 and  @xmath90 in  @xmath92 with a trigonal map defined over  @xmath7 is  @xmath213  since we have a  @xmath356 chance of being on the `` right '' quadratic twist of  @xmath11 .",
    "this hypothesis is consistent with our experimental observations .    [",
    "hypothesis : rationality ] for a randomly chosen hyperelliptic curve  @xmath11 and a uniformly randomly chosen subgroup  @xmath90 in  @xmath92 with a trigonal map  @xmath109 defined over  @xmath7 , the probability that we can compute an @xmath7-rational isogeny  @xmath19 with kernel  @xmath90 is  @xmath213 .",
    "now we will put the ideas above into practice .",
    "suppose we are given a hyperelliptic curve  @xmath11 of genus  @xmath0 over  @xmath7 , and a dlp instance in  @xmath13 to solve .",
    "our goal is to compute a nonsingular plane quartic curve  @xmath18 and an explcit isogeny  @xmath357 defined over  @xmath7 , so that we can solve our dlp instance in  @xmath20 .",
    "we begin by computing the set  @xmath92 of  @xmath7-rational tractable subgroups of the  @xmath2-torsion subgroup  @xmath81({{\\overline{\\mathbb{f}}}}_{q})$ ] ( see appendix  [ appendix : computing - sh ] below ) . for each  @xmath90 in  @xmath92",
    ", we apply proposition  [ proposition : trigonal - map - rationality - criterion ] to determine whether there exists an  @xmath7-rational trigonal map  @xmath109 for  @xmath90 .",
    "if so , we use the formulae of   [ section : computing - trigonal - maps ] to compute  @xmath109 ; if not , we move on to the next  @xmath90 .",
    "having computed  @xmath109 , we apply proposition  [ proposition : x - rationality - criterion ] to determine whether we can compute an isogeny over  @xmath7 .",
    "if so , we use the formulae of   [ section : equations - for - the - isogeny ] to compute equations for  @xmath23 and the isogeny  @xmath114 ; if not , we move on to the next  @xmath90 .",
    "the formulae of   [ section : equations - for - the - isogeny ] give an affine model of  @xmath23 in  @xmath358 . in order to apply diem s algorithm to the dlp in  @xmath113",
    ", we need a nonsingular plane quartic model of  @xmath23 : that is , a nonsingular curve  @xmath359 isomorphic to  @xmath23 , cut out by a quartic form .",
    "such a model exists if and only if  @xmath23 is not hyperelliptic . to find  @xmath18 ,",
    "we compute a basis  @xmath360 of the riemann  roch space of a canonical divisor of  @xmath23 .",
    "this is a routine geometrical calculation ; hess  @xcite describes an efficient approach . in practice ,",
    "the algorithms implemented in magma  @xcite compute  @xmath361 very quickly .",
    "the three functions in  @xmath361 define a map  @xmath362 , mapping  @xmath15 to  @xmath363 .",
    "up to automorphisms of  @xmath229 , the map  @xmath364 is independent of the choice of basis  @xmath361 , and depends only on  @xmath23 . if the image of  @xmath364 is a conic ( that is , if the  @xmath365 satisfy a quadratic relation ) ,",
    "then  @xmath23 is hyperelliptic ; in this situation we move on to the next  @xmath90 , since we will gain no advantage from index calculus on  @xmath23 .",
    "otherwise , the image of  @xmath364 is a nonsingular plane quartic  @xmath18 , and  @xmath364 restricts to an isomorphism  @xmath366 .",
    "if the procedure outlined above succeeds for some  @xmath90 in  @xmath92 , then we have computed an explicit  @xmath7-rational isogeny  @xmath367 .",
    "we can then map our dlp from  @xmath368 into  @xmath369 , and solve it using diem s algorithm .",
    "we emphasize that the entire procedure is very fast : the curve  @xmath23 and the isogeny can be constructed using just a few low - degree polynomial operations and some low - dimensional linear algebra ( and hence the procedure is polynomial - time in @xmath370 , the size of the base field ) . for a rough idea of the computational effort involved , given a random  @xmath11 over a  @xmath371-bit prime field with a tractable subgroup  @xmath90 in  @xmath92 , a nave implementation of our algorithms in magma computes the trigonal map  @xmath109 , the curve  @xmath23 , the nonsingular plane quartic  @xmath18 , and the isogeny  @xmath17 in a few seconds on a 1.2ghz laptop . since the difficulty of the construction depends only upon the difficulty of arithmetic in  @xmath7 ( and _ not _ upon the size of the dlp subgroup of  @xmath13 ) , we may conclude that instances of the dlp in  @xmath371-bit jacobians chosen for cryptography may also be reduced to instances of the dlp in non - hyperelliptic jacobians in very little time .    we will give an example over a small field .",
    "let  @xmath11 be the hyperelliptic curve over  @xmath372 defined by @xmath373 using the ideas in  [ section : kernel ] , or the algorithms in appendix  [ appendix : computing - sh ] , we find that @xmath27 has one  @xmath372-rational tractable subgroup : @xmath374 where  @xmath375 is an element of  @xmath376 satisfying  @xmath377 , and  @xmath378 . applying the methods of   [ section : computing - trigonal - maps ] ,",
    "we compute a trigonal map  @xmath379 for  @xmath90 , taking @xmath380 clearly  @xmath109 is defined over  @xmath372 .",
    "the formulae of   [ section : equations - for - the - isogeny ] give us a curve  @xmath381 of genus  @xmath0 , defined by @xmath382 the map on divisors inducing an isogeny from @xmath27 to  @xmath113 with kernel  @xmath90 is induced by the correspondence  @xmath119 defined as in   with @xmath383 computing the canonical morphism of  @xmath23 , we find that  @xmath23 is non - hyperelliptic , and isomorphic to the nonsingular plane quartic curve @xmath384 composing the isomorphism with the isogeny  @xmath24 , we obtain an explicit isogeny @xmath17 .",
    "we can verify that  @xmath27 and  @xmath385 are isogenous by checking that the zeta functions of  @xmath11 and  @xmath18 are identical : indeed , direct calculation with magma shows that @xmath386 let  @xmath387 $ ] and  @xmath388 $ ] be divisor classes on  @xmath11 ; we have @xmath389d$ ] . applying  @xmath19",
    ", we find that @xmath390          \\text{\\quad   and}\\\\          \\phi(d ' )           &          \\left [               ( 7 : 23 : 1 ) + ( 6 : 13 : 1 )              - ( 13 : 15 : 1 ) - ( 7 : 18 : 1 )          \\right ]          ;      \\end{array}\\ ] ] direct calculation verifies that  @xmath391\\phi(d)$ ] , as expected .",
    "our aim in this section is to estimate the proportion of genus  @xmath0 hyperelliptic jacobians over  @xmath7 for which the methods of this article produce an  @xmath7-rational isogeny  and thus for which the dlp may be solved using diem s algorithm  as  @xmath30 tends to infinity .",
    "we will assume that if we are given a selection of  @xmath248-rational tractable subgroups of a given jacobian , then the probabilities that each will yield a rational isogeny are mutually independent .",
    "this hypothesis appears to be consistent with our experimental observations .",
    "[ hypothesis : independence ] for a randomly chosen hyperelliptic curve @xmath11 , the probabilities that we can compute an @xmath7-rational isogeny with kernel @xmath90 for each @xmath90 in @xmath92 are mutually independent .",
    "[ theorem : success - probability ] assume hypotheses  [ hypothesis : hyperellipticity ] , [ hypothesis : trigonal - map - rationality ] , [ hypothesis : rationality ] , and  [ hypothesis : independence ] . as  @xmath30 tends to infinity , the expectation that the algorithms in this article will give a reduction of the dlp in a subgroup of  @xmath13 for a randomly chosen hyperelliptic curve  @xmath11 of genus  @xmath0 over  @xmath7 to a subgroup of  @xmath20 for some nonsingular plane quartic curve  @xmath18 is @xmath392 where @xmath393 denotes the set of integer partitions of  @xmath37 and @xmath394 denotes the multiplicity of an integer  @xmath14 in a partition  @xmath395 , and  @xmath396 , where  @xmath11 is _ any _ hyperelliptic curve over  @xmath7 such that the multiset of degrees of the  @xmath7-irreducible factors of its hyperelliptic polynomial coincides with  @xmath395 .",
    "suppose  @xmath11 is a randomly chosen hyperelliptic curve of genus  @xmath0 over  @xmath7 .",
    "hypotheses  [ hypothesis : hyperellipticity ] , [ hypothesis : trigonal - map - rationality ] , and [ hypothesis : rationality ] together imply that for each  @xmath90 in  @xmath92 , the probability that we can compute an isogeny with kernel  @xmath90 defined over  @xmath7 is @xmath397 .",
    "hypothesis  [ hypothesis : independence ] implies that we have an equal chance of constructing an isogeny from each  @xmath90 in  @xmath92 , so the probability that we can compute an isogeny over  @xmath7 from  @xmath27 is @xmath398 . the expectation that we can compute an isogeny over  @xmath7 given",
    "a curve over  @xmath7 is therefore @xmath399 where  @xmath11 is the curve defined by  @xmath48 , and  @xmath45 ranges over the set of all homogeneous squarefree polynomials of degree  @xmath37 over  @xmath7 .",
    "lemma  [ lemma : number - of - tractable - subgroups ] implies that  @xmath400 depends only on the degrees of the  @xmath7-irreducible factors of  @xmath45 , so the map  @xmath401 is well - defined .",
    "for each  @xmath395 in  @xmath393 , let  @xmath402 denote the number of homogeneous squarefree polynomials over  @xmath7 whose multiset of degrees of  @xmath7-irreducible factors coincides with  @xmath395 .",
    "we can now rewrite   as @xmath403 there are @xmath404 monic irreducible polynomials of degree  @xmath14 over  @xmath7 ( here @xmath405 is the mbius function ) .",
    "clearly @xmath406 , so @xmath407 and @xmath408 .",
    "therefore , as  @xmath30 tends to infinity , we have @xmath409 the result follows upon explicitly computing this sum , using the values for  @xmath410 listed in lemma  [ lemma : number - of - tractable - subgroups ] .",
    "theorem  [ theorem : success - probability ] gives the expectation of our ability to construct an explicit isogeny for a randomly selected hyperelliptic curve .",
    "however , looking at the table in lemma  [ lemma : number - of - tractable - subgroups ] , we see that we can be sure that a particular curve has no isogenies with tractable kernels defined over  @xmath7 if we use only curves whose hyperelliptic polynomials have an irreducible factor of degree  @xmath26 or  @xmath36 ( or a single irreducible factor of degree  @xmath0 )",
    ". it may be difficult to efficiently construct a curve in this form if we are using a cm construction , for example , to ensure that the jacobian has a large prime - order subgroup . in any case , it is interesting to note that the security of genus  @xmath0 hyperelliptic jacobians depends significantly upon the factorization of their hyperelliptic polynomials .",
    "this observation has no analogue for elliptic curves or jacobians of curves of genus  @xmath2 .",
    "of course , if  @xmath411 is an elliptic curve and  @xmath35 is completely reducible , then  @xmath412 is divisible by  @xmath42 , and in particular  @xmath412 can not be prime ; but this does not reduce the security of  @xmath413 to the extent that a completely reducible hyperelliptic polynomial does for a curve of genus  @xmath0 .    [",
    "remark : trigonal - map - descent ] we noted in  [ section : trigonal - construction ] that the  @xmath91-isomorphism class of the curve  @xmath23 in the trigonal construction is independent of the choice of trigonal map .",
    "if there is no trigonal map defined over  @xmath7 for a given subgroup  @xmath90 in  @xmath92 , then the methods of   [ section : computing - trigonal - maps ] construct a pair of galois - conjugate trigonal maps  @xmath324 and  @xmath325 ( corresponding to the roots of  ) instead . applying the trigonal construction to  @xmath324 and  @xmath325 , we obtain curves  @xmath414 and  @xmath415 over  @xmath416 .",
    "if the isomorphism between  @xmath414 and  @xmath415 were made explicit , then we could descend it to compute a curve  @xmath23 over  @xmath7 in the  @xmath91-isomorphism class of  @xmath414 and  @xmath415 , and hence a nonsingular plane quartic  @xmath18 over  @xmath7 and an isogeny  @xmath357 .",
    "we note that the isogeny may not be defined over  @xmath7 , but this approach could still allow us to replace the  @xmath417 in   and   with  @xmath213 , raising the expectation of success in theorem  [ theorem : success - probability ] to  @xmath418 .",
    "let @xmath419 .",
    "note that @xmath153 is a 60-bit prime ; if @xmath11 is a hyperelliptic curve of genus @xmath0 over @xmath420 such that @xmath421 has a large prime - order subgroup and if gaudry ",
    "thom  thriault ",
    "diem index calculus is the fastest algorithm for solving dlp instances in @xmath421 , then @xmath27 has roughly the same security level as an elliptic curve over a 160-bit field .",
    "we generated one million random hyperelliptic curves of genus  @xmath0 over  @xmath420 using magma .",
    "for each curve @xmath11 , we computed the set @xmath92 of tractable subgroups ; then , for each @xmath90 in @xmath92 we determined whether there was an @xmath420-rational trigonal map for @xmath90 , and if so whether there was an @xmath420-rational isogeny with kernel  @xmath90 .",
    "of these curves , @xmath422 ( that is , @xmath423 ) had at least one rational tractable subgroup . between them ,",
    "the @xmath424 curves had @xmath425 rational tractable subgroups , of which @xmath426 had a rational trigonal map ( that is , @xmath427 , which is close to the @xmath356 predicted by hypothesis  [ hypothesis : trigonal - map - rationality ] ) . of these subgroups",
    ", @xmath428 led to a rational isogeny ( that is , @xmath429 , which is close to the @xmath356 predicted by hypothesis  [ hypothesis : rationality ] ) .",
    "we found that @xmath430 of the curves had at least one @xmath420-rational isogeny , none of which had a hyperelliptic codomain ( this is compatible with hypothesis  [ hypothesis : hyperellipticity ] ) .",
    "in particular , we could move a discrete logarithm problem for @xmath431 of these curves ( recall that theorem  [ theorem : success - probability ] predicts a success rate of about @xmath4 ) .",
    "so far , we have concentrated on using isogenies with kernels generated by differences of weierstrass points to move instances of the dlp from hyperelliptic to non - hyperelliptic jacobians .",
    "more generally , we could use isogenies with other kernels .",
    "there are two important issues to consider here : the first is a theoretical restriction on the types of subgroups that can be kernels of isogenies of jacobians , and the second is a practical restriction on the isogenies that we can currently compute .    let  @xmath11 be a hyperelliptic curve of genus  @xmath0 .",
    "we want to characterize the subgroups  @xmath90 of  @xmath27 that are kernels of isogenies of jacobians , combining standard results from the theory of abelian varieties with some special results on curves of genus  @xmath0 . for our purposes , it is enough to know that the  @xmath70-_weil pairing _ is a nondegenerate , bilinear pairing on the  @xmath70-torsion of an abelian variety , which can be efficiently evaluated in the case where the abelian variety is the jacobian of a hyperelliptic curve ; for further detail , we refer the reader to  ( * ? ? ?",
    "a.7.8 ) .",
    "let  @xmath432 be an abelian variety over @xmath7 , and let  @xmath70 be a positive integer coprime with @xmath30 .",
    "we say a subgroup  @xmath90 of  @xmath433 $ ] is _",
    "maximal  @xmath70-isotropic _ if    1 .",
    "the  @xmath70-weil pairing on  @xmath433 $ ] restricts trivially to  @xmath90 , and 2 .",
    "@xmath90 is not properly contained in any other subgroup of  @xmath433 $ ] satisfying  ( 1 ) .",
    "if  @xmath70 is a prime not dividing @xmath30 , then every maximal  @xmath70-isotropic subgroup of  @xmath434 $ ] is isomorphic to  @xmath435 .",
    "the situation is more complicated when  @xmath70 is not prime : for example ,  @xmath81 $ ] is a maximal  @xmath42-isotropic subgroup of  @xmath436 $ ] , but it is isomorphic to @xmath437 and not @xmath438 .    [ proposition : kernels ] let  @xmath11 be a hyperelliptic curve of genus  @xmath0 over  @xmath7 such that  @xmath27 is absolutely simple .",
    "let  @xmath90 be a finite , nontrivial ,  @xmath7-rational subgroup of  @xmath95 .",
    "there exists a curve  @xmath23 of genus  @xmath0 over  @xmath7 , and an isogeny  @xmath114 with kernel  @xmath90 , if and only if @xmath90 is a maximal  @xmath70-isotropic subgroup of  @xmath69 $ ] for some positive integer  @xmath70 .",
    "the isogeny  @xmath19 is defined over  @xmath416 .",
    "the quotient  @xmath439 always exists as an isogeny of abelian varieties , and is defined over  @xmath7 ( see serre  @xcite ) . for the quotient to be an isogeny of jacobians , there must be an integer  @xmath70 such that  @xmath90 is a maximal  @xmath70-isotropic subgroup ( see proposition  16.8 of milne  @xcite ) : this ensures that the canonical polarization on  @xmath27 induces a principal polarization on the quotient  @xmath345 .",
    "the theorem of oort and ueno  @xcite therefore guarantees that there will be an isomorphism of principally polarized abelian varieties over  @xmath91 from  @xmath345 to the jacobian  @xmath113 of some irreducible curve @xmath23 ( irreducibility of  @xmath23 follows from the fact that  @xmath27 , and hence  @xmath345 , is absolutely simple ) . composing this isomorphism with the quotient map gives an isogeny of jacobians from @xmath27 to @xmath113 with kernel @xmath90 .",
    "standard arguments from galois cohomology ( see serre  @xcite , for example ) show that the isomorphism is defined over either  @xmath7 or  @xmath416 , and it follows that the isogeny @xmath24 must be defined over @xmath7 or @xmath416 .",
    "proposition  [ proposition : kernels ] does _ not _ hold in higher genus : for every  @xmath440 , there are  @xmath109-dimensional abelian varieties that are not isomorphic to jacobians .",
    "indeed , this is the generic situation : for @xmath441 the moduli space of @xmath109-dimensional abelian varieties is  @xmath442-dimensional , with the jacobians occupying a subspace of dimension  @xmath443  which is strictly less than @xmath442 for @xmath440 .",
    "we should not therefore expect an arbitrary quotient of a jacobian to be isomorphic to a jacobian in genus @xmath440 .",
    "proposition  [ proposition : kernels ] does hold in genus  @xmath5 and  @xmath2 , and in these cases the isogenies are always defined over  @xmath7 .",
    "we can expect the curve  @xmath23 of proposition  [ proposition : kernels ] to be non - hyperelliptic . to compute an  @xmath7-rational isogeny from  @xmath27 to a non - hyperelliptic jacobian ,",
    "therefore , the minimum requirement is an  @xmath7-rational  @xmath70-isotropic subgroup of  @xmath95 isomorphic to  @xmath435 for some prime  @xmath70 .",
    "we emphasize that this subgroup need _ not _ be contained in  @xmath13 . indeed",
    ", there may be isogenies from  @xmath27 to non - hyperelliptic jacobians over  @xmath7 even when  @xmath13 has prime order ( which would be the desirable situation in cryptological applications ) .",
    "the major obstruction to using more general isogenies to move dlp instances is the lack of general constructions for explicit isogenies in genus  @xmath0 .",
    "apart from integer multiplications , automorphisms , frobenius isogenies , and the construction for isogenies with tractable kernels exhibited above , we know of no constructions for explicit isogenies of general jacobians of genus  @xmath0 hyperelliptic curves . in particular",
    ", while we know that the curve @xmath23 of proposition  [ proposition : kernels ] exists , we generally have no means of computing a defining equation for it , let alone equations for a correspondence between @xmath11 and @xmath23 that would allow us to move dlp instances from @xmath27 to @xmath113 .",
    "this situation stands in marked contrast to the case of isogenies of elliptic curves , which have been made completely explicit by vlu  @xcite .",
    "deriving general formulae for explicit isogenies in genus  @xmath0 ( and  @xmath2 ) remains a significant problem in computational number theory .",
    "the greater part of this work was completed in the department of mathematics at royal holloway , university of london , where the author was supported by epsrc grant ep / c014839/1 .",
    "the author gratefully acknowledges roger oyono and christophe ritzenthaler for discussions which inspired this research , and steven galbraith and the anonymous referees for their helpful suggestions .",
    "xx birkenhake , c. , lange , h. : complex abelian varieties ( 2e ) , grundlehren der mathematischen wissenschaften 302 .",
    "springer ( 2004 )    bosma , w. , cannon , j. , playoust , c. : the magma computational algebra system .",
    "i. the user language .",
    "j.  symbolic comp . 24(3 - 4 ) , 235265 ( 2006 )    bost , j .- b .",
    ", mestre , j .- f .",
    ": moyenne arithmtico - gomtrique et priodes des courbes de genre 1 et 2 .",
    "france 38 , 3664 ( 1988 )    cartier , p. : isogenies and duality of abelian varieties , annals of mathematics 71 no .  2 , 315351 ( 1960 )    diem , c. : an index calculus algorithm for plane curves of small degree .",
    "in : hess , f. , pauli , s. , pohst , m. ( eds . ) ants - vii .",
    "lncs , vol .  4076 , pp .",
    "springer ( 2006 )    donagi , r. : the fibres of the prym map . in : curves , jacobians , and abelian varieties ( amherst , ma , 1990 ) .",
    "contemp .",
    "136 , 55125 ( 1992 )    donagi , r. , livn , r. : the arithmetic - geometric mean and isogenies for curves of higher genus .",
    "ann .  scuola norm .",
    "pisa cl .",
    "( 4 )  28 no .  2 , 323339 ( 1999 )    gaudry , p. , thom , e. , thriault , n. , diem , c. : a double large prime variation for small genus hyperelliptic index calculus . math .  comp .",
    "76 , 475492 ( 2007 )    griffiths , p. , harris , j. : principles of algebraic geometry .",
    "wiley and sons ( 1978 )    harris , j. : algebraic geometry : a first course .",
    "springer ( 1992 )    hess , f. : computing riemann - roch spaces in algebraic function fields and related topics .",
    "j.  symbolic computation  33 v.4 425445 ( 2002 )    hindry , m. , silverman , j. : diophantine geometry : an introduction .",
    "graduate texts in mathematics 201 .",
    "springer ( 2000 )    lang , s. , weil , a. , number of points of varieties in finite fields .",
    "am . j. math .",
    ", lxxvi no .",
    "4 819827 ( 1954 )    lehavi , d. , ritzenthaler , c. : an explicit formula for the arithmetic geometric mean in genus 3 . experimental math . 16 421440 ( 2007 )    the magma computational algebra system , ` http://magma.maths.usyd.edu.au/ `    milne , j.  s. : abelian varieties . in : arithmetic geometry ( storrs ,",
    "conn . , 1984 ) ,",
    "springer ( 1986 )    mumford , d. : tata lectures on theta ii .",
    "birkhuser ( 1984 )    oort , f. , ueno , k. : principally polarized abelian varieties of dimension two or three are jacobian varieties .",
    "j.  fac .",
    "tokyo sect .",
    "ia math .",
    "20 , 377381 ( 1973 )    pohlig , g. , hellman , m. : an improved algorithm for computing logarithms over  @xmath444 and its cryptographic significance .",
    "ieee trans .",
    "theory 24 , 106110 ( 1978 )    recillas , s. : jacobians of curves with  @xmath445 s are the prym s of trigonal curves .",
    "soc .  mat .",
    "mexicana ( 2 )  19 , no .  1 913 ( 1974 )    serre , j .-",
    ": algebraic curves and class fields . graduate texts in mathematics 117 .",
    "springer ( 1988 )    serre , j .-",
    ": galois cohomology .",
    "springer ( 2002 )    smith , b. : isogenies and the discrete logarithm problem in jacobians of genus  @xmath0 hyperelliptic curves . in : smart , n. ( ed . ) eurocrypt 2008 .",
    "lncs vol .  4965 , pp .",
    "springer ( 2008 )    vakil , r. : twelve points on the projective line , branched covers , and rational elliptic fibrations .",
    "320 no .  1 , 3354 ( 2001 ) .    vlu , j. : isognies entre courbes elliptiques . c.  r.  acad .",
    "paris , sries  a 273 , 305347 ( 1971 )",
    "given a hyperelliptic curve @xmath11 of genus @xmath0 over @xmath7 , we want to compute the set  @xmath92 of  @xmath7-rational tractable subgroups of  @xmath27 . algorithm  [ algorithm : subgroup - enumeration ] splits the hyperelliptic polynomial of @xmath11 into galois orbits of factors , before calling the recursive subroutine algorithm  [ algorithm : subgroup - subroutine ] to enumerate @xmath92 .",
    "this algorithm is included only for completeness , and is not particularly efficient ( we suggest some optimisations in remark  [ remark : tractable - implementation ] below . )",
    "[ algorithm : subgroup - enumeration ] given a hyperelliptic curve  @xmath11 of genus  @xmath0 over  @xmath7 , enumerates the set  @xmath92 of  @xmath7-rational tractable subgroups of  @xmath81({{\\overline{\\mathbb{f}}}}_{q})$ ] .",
    "each subgroup in  @xmath92 is represented by a set of four coprime quadratic factors of  @xmath45 .",
    "input : :    the hyperelliptic    polynomial  @xmath446    of  @xmath11 .",
    "output : :    the set  @xmath92 .",
    "step 1 : :    let  @xmath447 be the set of irreducible factors    of  @xmath45 over its splitting    field , +    scaled so    that  @xmath448 ,    and set  @xmath449 .",
    "step 2 : :    choose a polynomial  @xmath152 from  @xmath447 .    set  @xmath450 ,    set  @xmath451 , +    and set  @xmath452 .",
    "step 3 : :    set  @xmath453 , where  @xmath454 denotes    the  @xmath33 power frobenius map .",
    "+    if  @xmath455 , then append  @xmath152    to  @xmath456 ,    set  @xmath451 , and go to    * step  3*. +    if  @xmath457 , then    set  @xmath458 ;    if  @xmath459 , then go to * step  2*. step 4 : :    return the result of algorithm  [ algorithm : subgroup - subroutine ] applied    to  @xmath460 .",
    "input : :    a set  @xmath460 of disjoint sequences of distinct    linear polynomials .",
    "each sequence  @xmath461    in  @xmath460 must    satisfy  @xmath462    and  @xmath463 for  @xmath464 ,    where  @xmath454 denotes    the  @xmath33-power frobenius map .",
    "output : :    the set  @xmath465    of  @xmath31-stable sets of coprime    quadratic polynomials such that @xmath466 .",
    "step 1 : :    if  @xmath460 is empty , then    return  @xmath467 .",
    "step 2 : :    choose a sequence  @xmath456 from  @xmath460 , and    set  @xmath468 .",
    "+    if  @xmath469 is even , then let  @xmath393 be the    result of algorithm  [ algorithm : subgroup - subroutine ] applied    to  @xmath470 , +    and set @xmath471 . +    if  @xmath469 is odd , then    set  @xmath472 .",
    "step 3 : :    for each  @xmath15    in  @xmath473 such    that  @xmath474 ,    +    step 3i ; ;      set @xmath475 .",
    "step 3ii ; ;      let  @xmath476 be the result of      algorithm  [ algorithm : subgroup - subroutine ] applied      to  @xmath477 .",
    "step 3iii ; ;      set @xmath478 .",
    "step 4 : :    return  @xmath465 .",
    "[ remark : tractable - implementation ] as we noted above , algorithms @xmath42 and @xmath26 are not particularly efficient : for conceptual simplicity we worked over the splitting field of the hyperelliptic polynomial , and this can be extremely slow in practice . a number of simple optimizations will significantly improve the performance of this algorithm : the key is to avoid field extensions where possible , and to minimize their degree in any case . before factoring  @xmath45 over its splitting field we should factor it over  @xmath7 , and then work on a case - by - case basis depending on the degrees of the  @xmath7-irreducible factors .",
    "for example , if  @xmath45 has an odd number of odd - degree factors , then @xmath92 is empty by lemma  [ lemma : number - of - tractable - subgroups ] , and we can simply return the empty set .",
    "if  @xmath45 is  @xmath7-irreducible , then it is not necessary to factor @xmath45 over its splitting field ( which is  @xmath479 ) : there is one tractable subgroup , and it corresponds to the four quadratic factors of @xmath45 that we obtain by factoring @xmath45 over @xmath480 . making similar modifications for the cases where @xmath45 has factors of degree @xmath178 , we can avoid working over any extensions of degree greater than @xmath42 .",
    "if desired , we can further avoid some field extensions in the case where @xmath45 has only low - degree factors .",
    "these modifications resulted in a factor - of-@xmath481 speedup for our experiments with @xmath482-bit prime fields ; the unmodified algorithms  [ algorithm : subgroup - enumeration ] and  [ algorithm : subgroup - subroutine ] should _ not _ be used in practice ."
  ],
  "abstract_text": [
    "<S> we describe the use of explicit isogenies to translate instances of the discrete logarithm problem  ( dlp ) from jacobians of hyperelliptic genus  @xmath0 curves to jacobians of non - hyperelliptic genus  @xmath0 curves , where they are vulnerable to faster index calculus attacks . we provide explicit formulae for isogenies with kernel isomorphic to  @xmath1 ( over an algebraic closure of the base field ) for any hyperelliptic genus  @xmath0 curve over a field of characteristic not  @xmath2 or  @xmath0 . </S>",
    "<S> these isogenies are rational for a positive fraction of all hyperelliptic genus  @xmath0 curves defined over a finite field of characteristic  @xmath3 . </S>",
    "<S> subject to reasonable assumptions , our constructions give an explicit and efficient reduction of instances of the dlp from hyperelliptic to non - hyperelliptic jacobians for around  @xmath4 of all hyperelliptic genus  @xmath0 curves over a given finite field . </S>",
    "<S> we conclude with a discussion on extending these ideas to isogenies with more general kernels . a condensed version of this work appeared in the proceedings of the eurocrypt 2008 conference .    [ definition]algorithm </S>"
  ]
}