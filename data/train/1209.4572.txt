{
  "article_text": [
    "while temperature is usually computed from the kinetic energy , it can also be measured from derivatives of the potential energy @xmath0 with respect to coordinates @xmath1 @xcite . in terms of the inverse temperature @xmath2 ,",
    "with @xmath3 being the boltzmann constant , we have @xmath4 where @xmath5 denotes an ensemble average , and @xmath6 is the logarithmic derivative of the density of states @xmath7 in the microcanonical ensemble : @xmath8 @xcite , or the parameter in the canonical ensemble , etc . except in the canonical ensemble @xcite , the last expression in eq .",
    "( [ eq : ctemp ] ) has an @xmath9 error in a system of @xmath10 degrees of freedom @xcite ( see also appendix [ apd : ctemp ] ) .",
    "( [ eq : ctemp ] ) defines the so - called _ configuration temperature _",
    ", for it depends only on coordinates .",
    "it has been used in verifying a monte carlo simulation @xcite , constructing equilibrium @xcite and non - equilibrium @xcite microcanonical sampling , and building a thermostat @xcite , etc .    as eq .",
    "( [ eq : ctemp ] ) requires a continuous system with up to the second derivatives of the potential energy , it is inapplicable if the molecular potential is discontinuous @xcite , or if the second derivatives are difficult to compute .",
    "here we show that one can avoid the derivatives by computing the potential - energy change caused by a virtual perturbation , and obtain formulas of the configuration temperature that remain valid for irregular potential energy functions .",
    "we begin with a mechanical translation of eq .",
    "( [ eq : ctemp ] ) by a random perturbation . given a configuration @xmath1 ,",
    "a small perturbation @xmath11 in coordinates changes the potential energy by @xmath12 .",
    "now consider a random @xmath13 that satisfies ( a ) the distribution of @xmath13 is symmetric with equal probabilities for any @xmath13 and @xmath14 ; ( b ) the components of @xmath13 are independent : @xmath15 , where the overline denotes an average over the perturbation @xmath13 , and @xmath16 is the standard deviation of any @xmath17 .",
    "on average , we get @xmath18 and @xmath19 to the leading order . further averaging over @xmath20 ( denoted by @xmath21 )",
    "yields @xmath22 the above perturbation need not to cover all coordinates , since eq .",
    "( [ eq : mechtrans ] ) holds for a single coordinate : @xmath23 .",
    "the second step follows from a generalized formula @xmath24",
    "@xcite with @xmath25 .",
    "( [ eq : mechtrans ] ) shows that the temperature can be obtained from the statistical moments , or , equivalently , the distribution , of the energy change @xmath26 .",
    "note that a positive temperature @xmath6 demands an asymmetry @xmath27 from the symmetric perturbation .",
    "this reflects the fact that the entropy increases with the energy , which induces , on average , a convex potential - energy surface @xcite that favors a positive @xmath26 .    as eq .",
    "( [ eq : mechtrans ] ) requires no derivative of the potential energy function @xmath28 , we expect it to be applicable to a discontinuous @xmath28 .",
    "nonetheless , the perturbation still needs to be rather small , @xmath29 .",
    "below we derive more practical integral relations for an @xmath26 as large as @xmath30 .",
    "consider a canonical ensemble .",
    "if each configuration @xmath20 is shifted by @xmath13 to @xmath31 , then the potential - energy change @xmath32 satisfies @xcite @xmath33 where @xmath34 is the partition function .",
    "thus , the equation @xmath35 has a nontrivial root at @xmath36 .",
    "( [ eq : canon ] ) yields the same @xmath6 value as eq .",
    "( [ eq : mechtrans ] ) in the limit of small perturbation .",
    "first , since @xmath37 , where @xmath38 , we have @xmath39 which is reduced to eq .",
    "( [ eq : mechtrans ] ) after averaging over perturbations : @xmath40 is @xmath41 , while @xmath26 is @xmath42 , so @xmath43 . as eq .",
    "( [ eq : gaussian ] ) is also exact for a gaussian @xmath26 distribution , a perturbation involving many similar degrees of freedom can assume a larger @xmath26 .",
    "we can replace the above continuous configuration @xmath20 by a discrete one @xcite , and/or the perturbation @xmath44 by an invertible transformation from @xmath20 to @xmath45 with a unit jacobian : @xmath46 @xcite .",
    "some generalizations of eq .",
    "( [ eq : canon ] ) are discussed in appendix [ apd : fluc ] , and verified on a harmonic oscillator ( appendix [ apd : ho ] ) .",
    "the requirement for a unit jacobian should , however , be relaxed in the non - equilibrium case ( appendix [ apd : langevin ] ) .",
    "we now adapt eq .",
    "( [ eq : canon ] ) to a constant potential - energy ensemble , or a @xmath47 ensemble below , which collects configurations with the same potential energy @xmath47 .",
    "the ensemble is commonly used to build a multicanonical ensemble of a flat potential - energy distribution @xcite .",
    "configurations of the @xmath47 ensemble sum to the density of potential - energy states @xmath48\\ , d{\\mathbf{q}}$ ] , and the temperature of potential energy is defined as @xmath49 .",
    "we will show @xmath50 for a nonnegative integer @xmath51 , where @xmath52 denotes an average over the surface @xmath53 .",
    "particularly , @xmath54 .    if the perturbation @xmath13 is symmetric ( i.e. , @xmath44 and @xmath14 are equally likely ) , then for each @xmath13 that carries @xmath20 to @xmath31 , the inverse @xmath14 that carries @xmath45 back to @xmath20 shares the same probability . without any _ a priori _ bias of the start - point configuration , the overall flux @xmath55 , or the total number of @xmath13 that reach the @xmath56 ensemble from the @xmath47 ensemble , therefore , equals the reverse flux @xmath57 , or @xmath58 . but",
    "@xmath55 is the product of the density of states @xmath59 and the @xmath26 distribution @xmath60 for perturbations that start from the @xmath47 ensemble ; so @xmath61 if @xmath60 changes slowly with @xmath47 : @xmath62 , then @xmath63 and @xmath64 for any @xmath65 . by taking derivatives with respect to @xmath65 , and then setting @xmath66 , we get eq .",
    "( [ eq : expu ] ) .",
    "alternatively , we can integrate eq .",
    "( [ eq : probrev ] ) with the metropolis acceptance probability as @xmath67 for a nonnegative @xmath51 .",
    "the @xmath68 version shows that the energy change after a metropolis step from the @xmath47 ensemble averages to zero if the parameter @xmath6 in the acceptance probability @xmath69 roughly matches @xmath70 . besides , the function @xmath71 is roughly even at @xmath72 .",
    "thus , for a nonnegative @xmath51 @xmath73    eq .",
    "( [ eq : expu ] ) has an @xmath9 error , and can be corrected as @xmath74 where @xmath75 is the @xmath76 value determined from eq .",
    "( [ eq : expu ] ) ( as an equality ) .",
    "the correction reduces the error of @xmath76 to @xmath77 if @xmath26 is @xmath30 , such that the error of @xmath78 , integrated over an @xmath79 domain , is @xmath9 .",
    "( [ eq : expuc ] ) is also exact for any @xmath10 in the limit of small @xmath26 ( appendix [ apd : series ] ) .",
    "the derivatives with respect to @xmath47 are readily computed in a usual simulation that allows the potential energy to fluctuate . the corrections for eqs .",
    "( [ eq : symu ] ) and ( [ eq : halfu ] ) can be found in appendix [ apd : series ] .",
    "the temperature @xmath80 in the microcanonical ensemble can be obtained by substituting the total energy @xmath81 for the potential energy @xmath47 in the formulas for the @xmath47 ensemble ; e.g. , eq .",
    "( [ eq : expu ] ) becomes @xmath82 .",
    "the perturbations can still be limited to a subset of degrees of freedom , which can be made of only coordinates , but not momenta .",
    "the limit @xmath83 , however , eliminates the @xmath9 corrections in , e.g. , eq .",
    "( [ eq : expuc ] ) .",
    "thus , eqs .",
    "( [ eq : expu ] ) , ( [ eq : probrev])-([eq : halfu ] ) are exact if the interaction is weak compared to the kinetic energy , or if the system is embedded in a much larger isolated reservoir , which constitutes a canonical ensemble ( see also appendix [ apd : fluc ] ) .",
    "we may therefore interpret the relations as virtual `` thermometers '' gauged in the canonical ensemble , e.g. , the average @xmath84 invariably reads 1.0 in the canonical ensemble of the correct @xmath6 for any uniform perturbation , but not so in other ensembles .",
    "it is , however , possible to construct an exact thermometer gauged in the microcanonical ensemble .",
    "the momenta - averaged weight for a configuration , whose potential energy is @xmath47 , is @xmath85 for a system of @xmath10 degrees of freedom @xcite .",
    "thus , the total energy @xmath81 can be estimated from the root of @xmath86^{n/2 - 1 } { \\rangle}\\approx 1 $ ] ; then @xmath87 @xcite .",
    "the extension to pressure @xmath88 is straightforward . for a virtual volume move",
    "@xcite induced by the scaling of coordinates @xmath89 ( the dimension @xmath90 ) , we have @xcite @xmath91 { \\rangle}= 1 , \\label{eq : pressure}\\ ] ] where @xmath92{v'/v}{\\mathbf{q } } ) - u({\\mathbf{q}})$ ] , and @xmath93 .",
    "the @xmath94 is computed from either the jacobian of the coordinate scaling as @xmath95 , or from the kinetic energy change as @xmath96 \\ , \\beta \\ , { \\mathbf{p}}^2/(2m)$ ] of the conjugate momentum scaling @xmath97 @xcite . here , @xmath10 is the number of degrees of freedom , not the number of particles . for an infinitesimal volume change , we have @xmath98 , where @xmath99/(dv)$ ] or @xmath100 with @xmath101 .    eq . ( [ eq : pressure ] ) holds for a fixed @xcite or variable @xmath102 . for a hard - core system , only negative @xmath102",
    "should be used @xcite ( similar to widom s method @xcite for estimating the chemical potential , in which particles are inserted , but not removed ) .",
    "if @xmath103 is changed on an exponential scale as @xmath104 @xcite , then an additional factor @xmath105 should be inserted into the brackets @xmath106 .",
    "the advantage of using a variable volume change is that the virtual volume move is identical to a generalized ( or possibly optimized @xcite ) mc volume trial in an isothermal - isobaric @xcite or gibbs - ensemble @xcite mc simulation , and thus can be realized simultaneously .",
    "the formulas are exact in the isothermal - isobaric ensemble , but approximate in general .",
    "the formulas for temperature can be generalized to compute the logarithmic derivative , or the mean force , of a distribution @xmath107 of an extensive quantity @xmath108 @xcite : @xmath109 \\ , w({\\mathbf{q } } ) \\ ,",
    "d{\\mathbf{q } } , \\label{eq : distr1d}\\ ] ] where @xmath110 is the ensemble weight for a configuration @xmath20 , e.g. , @xmath111 $ ] in the canonical ensemble .",
    "we wish to find @xmath112 , whose integral yields the free energy @xcite @xmath113 .",
    "we define an _ adjusted _ perturbation @xmath114 as a symmetric perturbation @xmath13 adjusted by the metropolis acceptance probability : @xmath115 thus , @xmath114 is equal to @xmath13 if the unadjusted perturbation @xmath13 is accepted , or * 0 * if rejected . like",
    "an mc move @xcite , the @xmath116 satisfies detailed balance : @xmath117 , where @xmath118 .",
    "summing over @xmath20 and @xmath45 under @xmath119 and @xmath120 leads to @xmath121 here , @xmath107 replaces @xmath59 in eq .",
    "( [ eq : dbu ] ) .",
    "the temperature @xmath122 is then mapped to the mean force @xmath123 , and @xmath124 { \\rangle}_x \\approx 1 , \\label{eq : expx}\\ ] ] where @xmath125 denotes the @xmath110 weighted configuration average at a fixed @xmath126 .",
    "note that @xmath26 is the change of @xmath126 after the adjustment , which is 0 for a rejected perturbation .",
    "similarly , the counterparts of eqs .",
    "( [ eq : symu ] ) and ( [ eq : halfu ] ) [ and the @xmath127 corrections ( [ eq : expuc ] ) , ( [ eq : symuc ] ) and ( [ eq : halfuc ] ) ] can be obtained by @xmath128 and @xmath129 .",
    "the above mc - type adjusted perturbation can be replaced by a reversible time evolution @xcite , as long as the latter also satisfies eq .",
    "( [ eq : dbx ] ) .",
    "we can therefore treat a short segment of such a trajectory as an adjusted perturbation , and use eq .",
    "( [ eq : expx ] ) with @xmath130 ( @xmath131 is the segment length ) .",
    "further , since eq .",
    "( [ eq : expx ] ) does not require the potential energy , it can be readily applied to trajectories of colloidal particles monitored by microscopy experiments @xcite .",
    "we now consider a multidimensional distribution @xmath132 \\",
    ", w({\\mathbf{q } } ) \\ , d{\\mathbf{q } } \\label{eq : distrmd}\\ ] ] of @xmath133 extensive quantities @xmath134 , @xmath135 . to find all @xmath136 , we can extend , e.g. , eq .",
    "( [ eq : expu ] ) with @xmath68 , as @xmath137 where @xmath138 is the change of @xmath139 by the adjusted perturbation , and @xmath140 denotes an average in the ensemble at a fixed set of @xmath141 .",
    "( [ eq : expxmd ] ) offers @xmath133 equations , all components @xmath142 can be determined .",
    "thus , @xmath143 to the first order , and the @xmath9 correction [ cf .",
    "( [ eq : expuc ] ) ] is @xmath144 where @xmath145 is the inverse of the matrix @xmath146 .",
    "the small - perturbation limit of eqs .",
    "( [ eq : expxmd ] ) and ( [ eq : expxmdc ] ) is free from the @xmath9 error , and identical to the exact relation given by eqs .",
    "( [ eq : mfmd ] ) and ( [ eq : mfmd2 ] ) . first , according to the definition of the adjusted perturbation eq .",
    "( [ eq : adjpert ] ) , we have @xmath147 ( cf . sec . [ sec : mechtrans ] ) .",
    "thus , @xmath148 ( the acceptance probability only affects half of the perturbations that point against the gradient of @xmath149 ) and @xmath150 to the leading order [ we have averaged over symmetric perturbations and used eq .",
    "( [ eq : mfmd2 ] ) ] . for small @xmath151 ,",
    "( [ eq : expxmd ] ) becomes @xmath152 , or @xmath153 .",
    "( [ eq : expxmdc ] ) is then reduced to @xmath154 , which is eq .",
    "( [ eq : mfmd ] ) [ the @xmath155 term is @xmath156 , hence negligible ] .",
    "we show some results for the temperature formulas .",
    "we use eqs .",
    "( [ eq : expu ] ) , ( [ eq : symu ] ) or ( [ eq : halfu ] ) , etc . , in an mc / md simulation in this way : once every few steps along the trajectory , we perturb the current configuration @xmath20 by a random @xmath13 ( which is conducted as a virtual displacement so as not to disturb the real trajectory ) , and register the resulting change @xmath157 in the potential energy ; the formulas then estimate the temperature @xmath6 from the accumulated distribution @xmath158 . for the ising model",
    ", @xmath20 is a spin configuration , and @xmath44 means to flip a random spin .",
    "four @xmath26-distributions @xmath158 from simulations on the 108-particle lennard - jones ( lj ) fluid at @xmath159 and @xmath160 are shown in fig .",
    "[ fig : basic](a ) .",
    "the first simulation used a regular md ( in the microcanonical - like ensemble ) , while the others used the metropolis mc ( in the canonical ensemble ) .",
    "the pair potential was switched smoothly from the standard form @xmath161 $ ] ( @xmath162 ) at @xmath163 to a 7th order polynomial @xcite that vanishes at @xmath164 to avoid artifacts . in the first three cases ,",
    "each coordinate of a random particle was displaced by a random number in @xmath165 , with @xmath166 ( the first two cases ) or 0.1 ( the third ) . in the last case ,",
    "the perturbation was applied to all particles with @xmath167 .",
    "the number of perturbations was @xmath168 in each case .",
    "( [ eq : symu ] ) and ( [ eq : halfu ] ) were adapted to the md or canonical ensemble in the sense of @xmath169 .",
    "a comparison of the first two cases shows that the distribution was not very sensitive to the ensemble type in this case .",
    "the distributions from the single - particle perturbations peaked at @xmath170 [ cf .",
    "( [ eq : hope ] ) ] .",
    "the distribution from the all - particle perturbation , however , was gaussian - like [ cf .",
    "( [ eq : hogaussian ] ) ] .",
    "the integral relations applied to all cases , e.g. , the @xmath6 given by eq .",
    "( [ eq : canon ] ) were 1.0077 , 0.9990 , 1.0160 , and 0.9997 , respectively .    the solution process of eq .",
    "( [ eq : canon ] ) is illustrated in fig .",
    "[ fig : basic](b ) : if we plot @xmath171 against @xmath6 , its intersection with 1.0 then gives the desired @xmath6 .",
    "three systems , the lj fluid ( with both single- and all - particle perturbations ) , square - well @xcite fluid and @xmath172 ising model were simulated in the canonical ensemble at @xmath160 using the metropolis algorithm .",
    "the square - well potential of two particles is infinity if their distance @xmath173 , or @xmath174 if @xmath175 , or 0 otherwise ( @xmath176 , @xmath177 , and @xmath178 ) .",
    "perturbations that produced clashes , hence infinite @xmath26 , were excluded from entering eq .",
    "( [ eq : canon ] ) .    in fig .",
    "[ fig : basic](c ) , the temperatures computed from eqs .",
    "( [ eq : ctemp])-([eq : gaussian ] ) , ( [ eq : symu ] ) and ( [ eq : halfu ] ) , were plotted against @xmath179 , the size of the single - particle perturbation .",
    "all formulas worked well with a small @xmath179 , but with a large @xmath179 , eq .",
    "( [ eq : mechtrans ] ) and ( [ eq : gaussian ] ) quickly lost accuracy , while the integral formulas were little affected .",
    "the effect of the potential truncation @xcite was studied using a set of mc simulations ( @xmath166 ) with the lj potential deliberately truncated at small @xmath180 . the discontinuity rendered eq .",
    "( [ eq : ctemp ] ) approximate @xcite . as shown in fig .",
    "[ fig : basic](d ) , a small @xmath180 indeed affected eq .",
    "( [ eq : ctemp ] ) , but not eqs .",
    "( [ eq : canon ] ) , ( [ eq : symu ] ) , and ( [ eq : halfu ] ) .",
    "the temperature profile @xmath70 along the potential energy was computed on the @xmath172 ising model . to cover the entire energy range , we ran a multicanonical simulation @xcite using the exact density of states @xmath181 @xcite in the sampling weight for @xmath168 mc steps per site .",
    "as shown in fig .",
    "[ fig : isent](a ) , the temperature from eqs .",
    "( [ eq : mechtrans ] ) and ( [ eq : gaussian ] ) behaved badly except around @xmath182 or @xmath183 , while the integral relations ( [ eq : expu ] ) , ( [ eq : symu ] ) and ( [ eq : halfu ] ) agreed with the reference @xmath184 .",
    "this is expected , as the smallest energy change is 4 in the system , @xmath185 rarely holds , while @xmath26 is still @xmath186 to justify the use of the integral relations .",
    "but even in the latter case , there was an @xmath186 difference between the integral @xmath187 and the exact @xmath188 [ fig .",
    "[ fig : isent](b ) ] , showing that the temperature from eqs .",
    "( [ eq : expu ] ) , ( [ eq : symu ] ) and ( [ eq : halfu ] ) had an @xmath9 systematic error without the corrections , as the entire potential - energy range was @xmath79 .",
    "the corrections ( [ eq : expuc ] ) , ( [ eq : symuc ] ) and ( [ eq : halfuc ] ) , however , effectively removed the remaining errors ( except around the ground states , where the density of states was intrinsically irregular ) .",
    "as an application , eq .",
    "( [ eq : canon ] ) can be used to help a simplified potential - energy function emulate a more complex or realistic one @xcite . in the following example , the simplified function is the hard - sphere potential @xmath189 , and the more realistic one is the lj potential @xmath190 .",
    "we first run a simulation using @xmath191 as the potential energy . from the trajectory , we evaluate the effective temperature @xmath192 , by seeking the solution of @xmath193 , with @xmath194 being the change caused by a virtual perturbation .",
    "we repeat the process with a modified @xmath191 until the @xmath192 matches the simulation temperature @xmath6 : @xmath195 thus , eq .",
    "( [ eq : tmatchlj ] ) calibrates the hard - sphere system by the virtual thermometer gauged in the lj system ( cf .",
    "appendix [ apd : relentropy ] ) .    similar to eq .",
    "( [ eq : tmatchlj ] ) , one can also match the potential energy as @xmath196 or pressure as @xmath197 .",
    "another alternative is to minimize the relative entropy @xcite @xmath198          w_{{\\mathrm{hs}}}({\\mathbf{q } } ) \\",
    ", d{\\mathbf{q } } , \\label{eq : relentlj}\\ ] ] which measures the difference between the distributions @xmath199 and @xmath200 .",
    "although eq .",
    "( [ eq : tmatchlj ] ) and the conditions of matching the potential energy and pressure can all be derived from minimizing @xmath201 regarding virtual variations @xcite of @xmath202 ( appendix [ apd : relentropy ] ) , they do not necessarily find the exact optimal @xmath191 that minimizes @xmath201 .",
    "the methods were tested on a fluid system of 108 particles .",
    "the diameter @xmath203 of the hard - sphere system was varied to match the lj system under three conditions .",
    "the ratio of the partition functions @xmath204 , required for computing @xmath201 , were obtained by bennett s acceptance ratio method @xcite from independent simulations on the two systems .",
    "table [ tab : tmatch ] shows that the obtained @xmath203 from the above methods were generally close in the gaseous phase .",
    "it was , however , not always possible to find solutions for all methods , e.g. , matching the potential energy failed in the second case , while the relative entropy was hard to compute in the third case .",
    "thus , the methods can be complementary . like the force - matching method @xcite",
    ", the temperature matching requires simulation in only one ( hard - sphere ) system .",
    "one may also treat the configuration temperature as a special thermal force , and thus add a restraint to the force - matching method .",
    "also note that eq .",
    "( [ eq : tmatchlj ] ) allows a local perturbation with cheap local energy calculations .",
    "* 7y @xmath205 & @xmath206 & @xmath207 & @xmath208 & @xmath209 & @xmath210 & @xmath211 +   + 0.900 & 15.2 & 0.24 & @xmath212 & @xmath213 & 1.620 & 0.728 + 0.952 & * 7.1 * & 0.62 & @xmath214 & @xmath213 & * 0.729 * & * 0.729 * + 0.970 & 8.4 & 0.86 & @xmath215 & @xmath215 & 0.532 & 0.728 + 0.978 & 9.4 & * 1.00 * & @xmath216 & @xmath213 & 0.459 & 0.727 + 1.000 & 13.6 & 1.52 & @xmath217 & @xmath213 & 0.289 & 0.728 +   + 0.900 & 13.4 & 0.23 & @xmath218 & @xmath219 & 0.065 & 0.036 + 0.981 & @xmath220 & @xmath221 & @xmath222 & @xmath219 & 0.038 & 0.036 + 0.993 & 8.8 & 1.27 & @xmath222 & @xmath219 & * 0.036 * & * 0.036 * + 1.000 & 9.0 & 1.40 & @xmath222 & @xmath219 & 0.035 & 0.036 +   + 0.900 & 180 & 0.28 & @xmath223 & @xmath224 & 9.88 & @xmath225 + 0.970 & 37 & * 1.00 * & @xmath226 & @xmath224 & 1.89 & @xmath227 + 0.999 & - & 1.74 & @xmath228 & @xmath229 & @xmath230 & @xmath231 + 1.000 & - & 1.77 & @xmath232 & @xmath232 & @xmath233 & @xmath225 +   +   +   +   +   +    [ tab : tmatch ]",
    "to sum up , temperature can be extracted from the distribution @xmath158 of the potential - energy change @xmath26 caused by configuration perturbations , as the nontrivial root of eqs .",
    "( [ eq : expu ] ) , ( [ eq : symu ] ) or ( [ eq : halfu ] ) .",
    "the formulas can be understood as virtual thermometers gauged in a corresponding canonical ensemble . when used in the constant potential - energy ensemble ,",
    "the formulas have an @xmath9 error , but can be corrected systematically .",
    "the approach can be extended to the mean force of a multidimensional distribution @xmath234 by an ensemble - adjusted perturbation .",
    "the adjusted perturbation is equivalent to a short trajectory of a reversible dynamics , making the mean force formulas ( [ eq : expx ] ) and ( [ eq : expxmd ] ) readily usable in simulations and experiments @xcite .",
    "the computer code of the examples can be found in ref .",
    "i thank dr .",
    "m. w. deem , dr . b. m. pettitt , and the referees for helpful discussions and comments .",
    "i am especially indebted to the second referee for various insightful suggestions on , among others , the non - equilibrium extensions , connections with coarse - graining methods , and verifications on experiments and exact models .",
    "following refs .",
    "@xcite , we show that the temperature @xmath235 in the constant potential - energy ensemble ( cf . sec .",
    "[ sec : uensemble ] ) satisfies @xmath236 where @xmath237 is a vector field that satisfies @xmath238 @xcite .",
    "the second term on the right is @xmath9 .",
    "we first define @xcite @xmath239 \\ , d{\\mathbf{q } } = { \\langle}{\\mathbf{b } } \\cdot \\nabla u { \\rangle}_u \\ , g(u).\\ ] ] then @xmath240 on the other hand , integration by parts yields @xmath241 d { \\mathbf{q } } \\notag \\\\ & = \\int ( \\nabla \\cdot { \\mathbf{b } } ) \\delta[u({\\mathbf{q } } ) - u ] d { \\mathbf{q } }    = { \\langle}\\nabla \\cdot { \\mathbf{b } } { \\rangle}_u g(u ) .",
    "\\label{eq : dgdub}\\end{aligned}\\ ] ] equating eqs .",
    "( [ eq : dgdua ] ) and ( [ eq : dgdub ] ) gives ( [ eq : ctempu ] ) .",
    "( [ eq : ctemp ] ) represents two special cases . with @xmath242 , @xmath243 , and @xmath244 where the second term is @xmath9 . with @xmath245 , we get @xmath246    we can show eq .",
    "( [ eq : ctemp ] ) from the equation of motion @xcite : @xmath247 where @xmath131 is the length of a long trajectory .",
    "we have assumed a thermostat @xcite that makes momenta @xmath248 independent : @xmath249 , and uncorrelated with @xmath250 and @xmath251 .",
    "this derivation has the advantage of replacing the strong assumption of global ergodicity in the ensemble theory by a weaker condition of sufficiently randomized momenta ( which requires only local equilibration ) .",
    ". ( [ eq : canon ] ) can be generalized by several fluctuation theorems @xcite . for any @xmath65",
    ", we have @xmath252 { \\rangle}_\\beta   = { \\langle}\\exp(-\\beta ' { \\varepsilon}^ * ) { \\rangle}_\\beta,\\ ] ] where @xmath26 and @xmath253 are the energy changes caused by a pair of uniform perturbations @xmath44 and @xmath14 , respectively @xcite , because @xmath254 } \\ ,      e^{-\\beta u({\\mathbf{q}})}/z(\\beta ) \\ , d{\\mathbf{q } }",
    "\\\\ = \\int e^ {      -\\beta ' \\ , [ u({\\mathbf{q}}'-{\\mathbf{u } } ) - u({\\mathbf{q } } ' ) ] } \\ ,      e^{-\\beta u({\\mathbf{q}}')}/z(\\beta ) \\ , d{\\mathbf{q}}',\\end{aligned}\\ ] ] where @xmath255 . for a symmetrically randomized perturbation ,",
    "the distributions of @xmath26 and @xmath253 are identical , and @xmath252 { \\rangle}_\\beta = { \\langle}\\exp(-\\beta ' { \\varepsilon } ) { \\rangle}_\\beta .",
    "\\label{eq : canonbp}\\ ] ] the @xmath26 distribution can be found from the exponential average @xmath256 @xcite as @xmath257 . by taking the fourier transform of eq .",
    "( [ eq : canonbp ] ) , we get @xmath258 assuming that @xmath259 has no singularity in the strip @xmath260 of the complex plane .",
    "note that while eqs .",
    "( [ eq : canonbp ] ) and ( [ eq : canondb ] ) require a symmetric perturbation , eq .",
    "( [ eq : canon ] ) does not .",
    "( [ eq : canon ] ) has a few other generalizations . for a hamiltonian @xmath261 parameterized by @xmath262 , we can treat a circular switch of @xmath263 starting from the canonical equilibrium state at @xmath264 as an elaborate perturbation",
    ". then the jarzynski equality states @xmath265 for the non - equilibrium work",
    "@xmath266 over a period @xmath131 @xcite .",
    "similarly , we have @xmath267 for the work @xmath268 derived from a time - dependent driving force @xmath269 ( excluding the component from the conservative potential ) @xcite .",
    "these relations can also be used to extract the equilibrium temperature @xmath6 of the initial equilibrium state .",
    "we verify a few formulas for the canonical ensemble on a @xmath270-dimensional harmonic oscillator with the potential energy @xmath271 . for a gaussian perturbation @xmath272 applied to a fixed @xmath20 , the average @xmath273 } p_{\\mathbf{u } } ( { \\mathbf{u } } ) \\ , d{\\mathbf{u } } \\\\ & = ( 1+\\alpha b)^{-d/2 } \\exp[\\alpha b^2 u /(1+\\alpha",
    "b)],\\end{aligned}\\ ] ] where @xmath274 . averaging @xmath275 over @xmath20 yields @xmath276^{-d/2}. \\label{eq : hogenf}\\end{aligned}\\ ] ] eq .",
    "( [ eq : hogenf ] ) satisfies eqs .",
    "( [ eq : canon ] ) and ( [ eq : canonbp ] ) , i.e. , @xmath277 .",
    "since @xmath278 gives the moment generating function @xcite , the @xmath26 distribution @xmath279 is @xmath280^{(d-1)/2}}{(\\alpha/\\beta)^{d/2 } } \\dfrac { k_{(d-1)/2}(\\gamma |{\\varepsilon}| ) } { \\sqrt\\pi \\gamma(d/2 ) } e^{\\beta { \\varepsilon}/2 } , \\label{eq : hope}\\ ] ] where @xmath281 , @xmath282 is the modified bessel function of the second kind , and @xmath283 is the gamma function .",
    "( [ eq : hope ] ) satisfies eq .",
    "( [ eq : canondb ] ) , and shows that @xmath158 at @xmath170 depends critically on the dimension @xmath270 : it diverges if @xmath284 ; it has a finite cusp if @xmath285 ; and it is differentiable if @xmath286 . in the limit of @xmath287 and @xmath288 ,",
    "the distribution is gaussian : @xmath289 , \\label{eq : hogaussian}\\ ] ] where @xmath290 .",
    "we derive the corrections for eqs .",
    "( [ eq : expu ] ) , ( [ eq : symu ] ) and ( [ eq : halfu ] ) from @xmath291 \\sum_{m = 0}^{+\\infty } \\dfrac{(-{\\varepsilon})^m}{m ! } \\dfrac{d^m p_u({\\varepsilon } ) } { du^m } , \\label{eq : series}\\end{aligned}\\ ] ] where @xmath292 .",
    "( [ eq : expu ] ) seeks the root @xmath293 of @xmath294 \\ ,      { \\varepsilon}^k \\,d { \\varepsilon}.\\ ] ] using eq .",
    "( [ eq : series ] ) for @xmath295 yields : @xmath296      { \\varepsilon}^{k+m } \\right\\rangle_u ,   \\label{eq : expuav}\\ ] ] where @xmath297 denotes a differentiation that applies only to the moments of @xmath26 , but not to the @xmath75 or @xmath298 .",
    "( [ eq : expuav ] ) can be solved by successive approximations : @xmath299 with @xmath300 . to the first order , we use @xmath301 in eq .",
    "( [ eq : expuav ] ) , and @xmath302 which yields @xmath303 .",
    "next , we set @xmath304 , and @xmath305 which yields @xmath306/ { { \\langle}{\\varepsilon}^{k+1 } { \\rangle}_u}$ ]",
    ". we reach eq .",
    "( [ eq : expuc ] ) by @xmath307 .",
    "( [ eq : expuc ] ) is exact for any @xmath10 in the limit of small @xmath26 . for an even @xmath51 in this limit , it becomes ( cf .",
    "[ sec : mechtrans ] ) @xmath308 with @xmath309 . to show this",
    ", we use @xmath310 partial integration yields @xmath311 = 2 { \\langle}{\\varepsilon}^{k+1 } { \\rangle}_u \\ , g(u)$ ] , which is eq .",
    "( [ eq : expucsmalle ] ) . for an odd @xmath51 ,",
    "the @xmath76 value is identical to that from the @xmath312 case in the small @xmath26 limit .",
    "the correction for eq .",
    "( [ eq : symu ] ) can be constructed from @xmath313\\ , d{\\varepsilon}.\\ ] ] using eq .",
    "( [ eq : series ] ) for @xmath60 yields @xmath314 where latexmath:[$m_l \\equiv \\int_{-\\infty}^{+\\infty }     to correct the @xmath75 value determined from eq .",
    "( [ eq : halfu ] ) , we use @xmath316\\ , d{\\varepsilon},\\ ] ] which yields @xmath317 eq .",
    "( [ eq : halfuc ] ) lacks the @xmath318 term in eqs .",
    "( [ eq : expuc ] ) and ( [ eq : symuc ] ) , as it has been included in differentiating the @xmath293 in the @xmath319 .",
    "for the @xmath133-dimensional distribution @xcite @xmath320 defined by eq .",
    "( [ eq : distrmd ] ) , we have @xmath321 where @xmath322 is the @xmath133 by @xmath133 matrix with @xmath323 ( the @xmath324 are vector fields such that the matrix has an inverse @xmath325 ) , and @xmath326 particularly , if @xmath327 , @xmath328 which is similar to eq .",
    "( [ eq : ctempu ] ) . to show eq .",
    "( [ eq : mfmd ] ) , we observe @xmath329 w({\\mathbf{q}})\\,d{\\mathbf{q}}.\\ ] ] then partial integration gives @xmath330 \\",
    ", \\textstyle\\prod_{\\gamma }      \\delta[x_\\gamma({\\mathbf{q } } ) - x_\\gamma ] \\ ,      d { \\mathbf{q } } \\\\ & = \\textstyle\\sum_\\gamma   \\partial{(w_{\\alpha\\gamma}\\,\\rho)}/{\\partial x_\\gamma } = \\textstyle\\sum_\\gamma   \\left ( w_{\\alpha \\gamma } f_\\gamma +   \\partial{w_{\\alpha\\gamma}}/ { \\partial x_\\gamma } \\right)\\ , \\rho.\\end{aligned}\\ ] ] multiplying @xmath331 to both sides yields eq .",
    "( [ eq : mfmd ] ) .    if @xmath324 is constructed by the gram - schmidt orthonormalization such that @xmath332 @xcite , then @xmath333 the resulting @xmath334 can be quite complex @xcite , e.g. , for @xmath335 , @xmath336 we can alternatively set @xmath337 , and @xmath338 which limits the second derivatives to the laplacians , but requires the corrections @xmath339 from numerical differentiation .",
    "we show below that the temperature matching condition eq .",
    "( [ eq : tmatchlj ] ) locally minimizes the relative entropy @xcite @xmath340 \\ , w_b({\\mathbf{q } } ) \\ , d{\\mathbf{q}},\\ ] ] of two distributions @xmath341 and @xmath342 ( @xmath343 ) along the force .",
    "if @xmath344 , the minimum is located at @xmath345 [ use @xmath346 with @xmath347 @xcite ] . if , however , @xmath348 is minimized along an infinitesimal coordinate transformation @xmath349 , then @xmath350 , or @xmath351 . in the canonical ensemble ,",
    "@xmath352 for @xmath353 $ ] . particularly , with @xmath354 , we have @xmath355 , which is eq .",
    "( [ eq : tmatchlj ] ) in the small - perturbation limit .",
    "generally , eq . ( [ eq : beteff ] ) defines a distinct effective temperature @xmath356 for each vector field @xmath250 , reflecting the fact that one can define different effective temperatures @xcite in a non - equilibrium state ( @xmath357 : equilibrium , @xmath358 : non - equilibrium ) .",
    "the conditions for matching the potential energy and pressure can be similarly obtained by varying @xmath357 with respect to the temperature and volume , respectively .",
    "normally , we set @xmath357 as the model distribution , and optimize its parameters to match the reference @xmath358 @xcite ; thus , the averages should be performed in the reference @xmath359 system .",
    "this is , however , inconvenient , for the example in sec .",
    "[ sec : tmatch ] , since @xmath360 , when averaged over configurations produced by the reference lj potential , can be infinite , due to the hard - sphere potential @xmath361 .",
    "we therefore set @xmath362 and @xmath363 .",
    "we use a driven system in constant contact with a heat bath as a model to study the temperature in a non - equilibrium steady state .",
    "we will show below that , to correctly extract the presumably constant heat bath temperature , eq .",
    "( [ eq : canon ] ) should be applied to a nonuniform perturbation .",
    "consider the overdamped langevin equation @xcite : @xmath364 , where the total force @xmath365 is the conservative component @xmath366 plus a driving @xmath367 , @xmath368 is the viscosity , and @xmath369 is a gaussian white noise satisfying @xmath370 .",
    "the steady - state distribution @xmath149 satisfies @xmath371 where @xmath372 is the constant current , and the ratio @xmath373 is the average local velocity @xcite .",
    "the equilibrium case @xmath374 is recovered if @xmath375 .",
    "consider a perturbation @xmath376 generated by a flow from the vector field @xmath377 , @xmath378 $ ] , over a period of `` virtual time '' @xmath379 , such that @xmath380 and @xmath381 . we then have , by eq .",
    "( [ eq : fp ] ) , @xmath382 where @xmath383 \\cdot    { \\mathbf{u}}[{\\mathbf{q}}(\\tau ) ] \\ , d\\tau$ ] is the change of the local effective potential @xcite or the absorbed heat , @xmath384 \\cdot { \\mathbf{v}}[{\\mathbf{q}}(\\tau ) ] \\ , d\\tau$ ] is the housekeeping heat @xcite , and @xmath385 \\ , d\\tau \\right ) =     eq .",
    "( [ eq : expnej ] ) can be made to locally resemble the equilibrium version [ eq . ( [ eq : canon ] ) ] as @xmath386 by a constraint @xmath387 .",
    "the constraint can be satisfied by the vector field @xmath388 , where @xmath389 is a constant and @xmath390 satisfies @xmath391 .",
    "the @xmath392 induces a nonuniform perturbation in the steady state with nonzero current . in this way",
    ", we get an energy - based reading of the temperature in the non - equilibrium steady state , just as in the equilibrium state , such that the same @xmath6 value can be obtained for perturbations of different sizes and directions .",
    "similarly , if the perturbation is a short trajectory that follows the langevin equation , or one that satisfies @xmath393 , then @xmath394 @xcite yields the same @xmath6 .",
    "b. a. berg and t. neuhaus , phys .",
    "lett . * 68 * , 9 ( 1992 ) ; j. lee , phys . rev . lett .",
    "* 71 * , 211 ( 1993 ) ; f. g. wang and d. p. landau , phys .",
    "lett . * 86 * , 2050 ( 2001 ) ; j. kim , j. e. straub , and t. keyes , phys .",
    "lett . * 97 * , 050601 ( 2006 ) .",
    "g. m. wang , e. m. sevick , e. mittag , d. j. searles , and d. j. evans , phys .",
    "lett . * 89 * , 050601 ( 2002 ) ; y. han and d. g. grier , phys .",
    "lett . * 92 * , 148301 ( 2004 ) ; v. blickle , t. speck , l. helden , u. seifert , and c. bechinger , phys .",
    "* 96 * , 070603 ( 2006 ) ; d. andrieux , p. gaspard , s. ciliberto , n. garnier , s. joubaud , and a. petrosyan , phys .",
    "* 98 * , 150601 ( 2007 ) .",
    "a. p. lyubartsev and a. laaksonen , phys .",
    "e * 52 * , 3730 ( 1995 ) ; w. g. noid , j .- w .",
    "chu , g. s. ayton , v. krishna , s. izvekov , g. a. voth , a. das , and h. c. andersen , j. chem .",
    "* 128 * , 244114 ( 2008 ) .",
    "f. ercolessi and j. b. adams , europhys . lett .",
    "* 26 * , 583 ( 1994 ) ; s. izvekov , m. parrinello , c. j. burnham , and g. a. voth , j. chem . phys .",
    "* 120 * , 10896 ( 2004 ) ; s. izvekov and g. a. voth , j. phys .",
    "b * 109 * , 2469 ( 2005 ) .",
    "r. p. feynman , _ statistical mechanics : a set of lectures _ ( w. a. benjamin , reading , ma , 1972 ) ; h. b. callen , _ thermodynamics and an introduction to thermostatistics _ ( wiley , new york , 1985 ) ; p. m. chaikin and t. c. lubensky , _ principles of condensed matter physics _ ( cambridge university press , cambridge , uk , 1995 ) .",
    "g. j. martyna , m. l. klein , and m. tuckerman , j. chem . phys . *",
    "97 * , 2635 ( 1992 ) ; g. bussi , d. donadio , and m. parrinello , j. chem .",
    "126 * , 014101 ( 2007 ) ; d. j. evans , w. g. hoover , b. h. failor , b. moran , and a. j. c. ladd , phys .",
    "a * 28 * , 1016 ( 1983 ) ; h. mori , prog .",
    "phys . * 34 * , 399 ( 1965 ) ; r. zwanzig , j. stat . phys . * 9 * , 215 ( 1973 ) ."
  ],
  "abstract_text": [
    "<S> the notion of configuration temperature is extended to discontinuous systems by identifying the temperature as the nontrivial root of several integral equations regarding the distribution of the energy change upon configuration perturbations . </S>",
    "<S> the relations are generalized to pressure and a distribution mean force . </S>"
  ]
}