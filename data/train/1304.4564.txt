{
  "article_text": [
    "a commonly encountered problem in modern genetic research , geological imaging , signal processing , astrometry and finance is that of comparing the mean vectors of two populations . in many of today",
    "s applications , the data averts analysis by classic statistical methods as the data dimension @xmath0 typically is larger than the sample size @xmath1 , which causes most standard procedures to break down . when @xmath2 , comparisons of this type are usually done using hotelling s @xmath3 test . in the high - dimensional setting",
    "where @xmath4 , the sample covariance matrix is not invertible , meaning that hotelling s test no longer can be used .    in this paper",
    "we discuss two - sample tests in a high - dimensional setting where the variables have a non - negligible dependence structure .",
    "while the tests are discussed in the context of gene - set testing , we stress that they are equally applicable to other fields in which high - dimensional data occur .    in genetic research , one is often interested in identifying differentially expressed genes between two groups of patients based on data from a microarray experiment .",
    "genes , however , do not function in isolation .",
    "rather , they work together in complex networks .",
    "it is therefore often of greater interest to search for sets of genes , rather than individual genes , that are differentially expressed @xcite .",
    "these gene - sets are determined a priori , typically by utilizing databases such as gene ontology or kyoto encyclopedia of genes and genomes or by grouping genes with similar chromosomal locations together .",
    "a common approach to finding differentially expressed gene - sets is to use a two - step procedure , starting by performing individual tests for each gene .",
    "these gene - level tests are then aggregated into a single test for the entire gene set .",
    "much , if not all , of the multivariate structure of the data set is lost when gene - level test are used .",
    "@xcite , @xcite and @xcite demonstrated several problems with common tests based on this approach , including very high rates of false positives .",
    "the empirical bayes methods applied e.g. by @xcite suffer from similar issues , caused by correlations between gene expressions @xcite .",
    "whereas the blue crosses have population mean vector @xmath5 .",
    "the shifts are difficult to detect by looking at the marginal distributions , but become evident when comparing the joint distributions . ]    by using a truly multivariate test for the gene set , it is possible not only to take the multivariate dependence structure of the gene expressions into account , but to gain more power from these dependencies , as illustrated in figure [ fig0 ] .",
    "there are three approaches to modifying the covariance estimator in hotelling s test statistic to allow for high - dimensional inference .",
    "the first approach is to use prior information about the covariance structure to estimate the covariance matrix .",
    "@xcite presented such a test in the setting where location shift between the two populations is related to a known graph structure describing the dependence between the genes .",
    "the second approach is to assume that the covariance matrix has a simple diagonal structure .",
    "the tests proposed by @xcite , @xcite , @xcite , @xcite , @xcite rely on imposing this particular structure on the covariance matrix , assuming the expressions of different genes to be independent .",
    "this is an unrealistic assumption for gene expressions , where genetic regulatory networks tend to cause the expression to be highly correlated .",
    "the assumption is equally unrealistic in many other biomedical problems . as a further example ,",
    "the prevalence of an allele is typically highly correlated with the prevalence of other alleles on neighbouring loci .",
    "the third approach is to use an estimator that allows for dependence , but that can be used in the absence of prior information .",
    "recently , @xcite proposed a test in which the data is randomly pseudo - projected into several lower - dimensional spaces .",
    "hotelling s @xmath3 statistic is computed for each pseudo - projection , and the result is then averaged over all pseudo - projections .",
    "lopes et al . showed by asymptotic arguments and a simulation study that their test has substantially higher power than competing tests when",
    "the variables are correlated .",
    "there are however two downsides to their proposed method .",
    "first , it relies on an asymptotic null distribution derived under the assumption of normality . for finite sample sizes ,",
    "this often leads to far too conservative p - values .",
    "second , the test statistic is not invariant under linear transformations of the marginal distributions .",
    "this is a serious drawback , as it is common for genetic data to be rescaled by dividing the marginal distributions by their respective standard deviations .    in this paper , we show how accurate p - values for the lopes et al .",
    "test can be obtained by using random permutations .",
    "we then propose a modified test statistic , which uses random subspaces instead of random pseudo - projections .",
    "the new test statistic is , conditioned on the random subspaces chosen , invariant under linear transformations of the marginal distributions .",
    "a common problem in gene - set testing is that of identifying gene - sets , or pathways , that are related to cancer . for a pathway to induce cancer ,",
    "a mutation must have occurred in at least one of its genes . depending on where in this pathway the gene is located ,",
    "the mutation can cause changes in the expressions of only a handful of genes or in all genes in the pathway . motivated by this problem setting",
    ", we perform a monte carlo comparison of four multivariate two - sample tests and two tests based on gene - level @xmath6-tests .",
    "we compare the type i error rates and powers of the tests under different models for pathway dependencies and mutation locations . some tests that require normality",
    "are modified so that p - values are computed using permutations rather than asymptotic null distributions , resulting in better type i error rates as well as higher power .",
    "we also contrast the invariance properties of the test statistics . while invariance properties tend to be overlooked in the biomedical literature , they are of great importance in multivariate testing and need to be taken into account when choosing which test to use .",
    "high - dimensional permutation tests are heavily computer - intensive . for that reason ,",
    "we discuss some computational aspects of such tests , and show how to efficiently implement the proposed test in r.    methods based on random projections and random subspaces have not been studied to a great extent in the statistical literature , but are common in machine learning , where these techniques mainly have been been used for clustering and classification .",
    "see @xcite and @xcite for reviews and some applications and @xcite for applications in chemometrics .",
    "most authors have used only a single random projection or subspace , although there are a few exceptions , including the the recent paper by @xcite .",
    "@xcite used multiple random projections for goodness - of - fit testing but did not find the increase in power to be large enough to motivate the added computational complexity .",
    "@xcite used multiple random projections for clustering , in a manner that bears resemblance to the algorithms presented in this paper , and found that it improved the performance of their clustering algorithms .",
    "recently , @xcite proposed a subspace method for outlier detection in high - dimensional data sets that is somewhat similar to the random subspaces test presented in the present paper .",
    "their method differs from ours in several ways , the most important difference being that their goal is to give an anomaly score _ to each observation _ , rather than to compute a statistic that can be used for inference about the underlying population .",
    "also worth mentioning is a recent paper by @xcite , who described a general hypothesis testing framework based on a non - random projection to the real line , determined by a linear classifier .",
    "the rest of the paper is organised as follows . in section [ projection ]",
    "we review the lopes et al .",
    "test and discuss its drawbacks . in section [ projection2 ] we propose a new test based on random subspaces . in section [ comp ]",
    "we compare several gene - set tests in terms of invariance , type i error rates and power . in section [ comput ]",
    "we discuss the computational aspects of the new test .",
    "the text concludes with a discussion in section [ disc ] and an appendix with implementations and examples in r.",
    "we consider two random samples of size @xmath7 and @xmath8 from independent @xmath0-dimensional random variables @xmath9 and @xmath10 , with mean vectors @xmath11 and @xmath12 and covariance matrices @xmath13 .",
    "we assume that @xmath14 .",
    "our aim is to test whether @xmath15 .",
    "one could argue that when testing the hypothesis @xmath15 for two groups of patients , say a control group and a group of cancer patients , we should not expect the covariance matrices of the two groups to coincide .",
    "@xcite proposed a solution to this high - dimensional behrens  fisher problem .",
    "the hypothesis that we wish to test using mean vectors is however often not strictly speaking @xmath15 , but rather that the two multivariate distributions agree : @xmath16 .",
    "if the genes under consideration have no connection to cancer , there is no reason to expect the covariance matrix for their expressions to be any different from that of the control group . under the null hypothesis that the two distributions are equal",
    "we should therefore assume that @xmath17 .",
    "@xcite proposed a two - sample test of @xmath15 that uses random projections to @xmath18-dimensional subspaces .",
    "formally , assume that samples @xmath19 and @xmath20 are given . for @xmath21 , let @xmath22 be a @xmath23 random matrix with i.i.d .",
    "@xmath24 elements , independent of the data .",
    "the lopes et al .",
    "statistic is computed by averaging the hotelling s @xmath3 statistics over several random projections @xmath25 .",
    "the algorithm is as follows .",
    "it should be noted that `` projection '' is used in a loose sense here , since @xmath22 usually is nt a projection matrix .",
    "lopes et al .",
    "derived the asymptotic null distribution and power function of their test under normality and derived conditions under which the test is asymptotically more powerful than the tests of @xcite and @xcite .",
    "in the following sections , we outline two drawbacks to this test and how the test procedure can be modified to account for these .",
    "the first drawback is that the asymptotic null distribution of the test statistic is a poor approximation of the null distribution for small sample sizes , such as the @xmath26 , @xmath27 setting studied in section [ comp ] .",
    "two examples of this phenomenon are given in figure [ fig2 ] .",
    "the p - values obtained from the asymptotic null distribution are highly conservative . for this reason ,",
    "we instead propose using the permutation distribution of the data to compute the p - values .     for 500 samples simulated under the null hypothesis .",
    "the asymptotic null distribution is shown in red . ]",
    "let @xmath28 denote the entire sample .",
    "the number of permutations is usually too large for it to be computationally feasible to use the exact permutation distribution of @xmath29 . we can however obtain approximate p - values by using random permutations to approximate the permutation distribution .",
    "the algorithm is as follows .",
    "the second drawback is that the statistic @xmath30 lacks desirable invariance properties .",
    "ideally , the result of a statistical test should not depend on the location and scale on which the measurements have been obtained .",
    "unfortunately , when @xmath31 , no two - sample test statistic that is a function of the sample can be affine invariant @xcite , i.e. invariant under all linear transformations .",
    "it is however possible for a test statistic to be invariant under a smaller group of linear transformations .    in order to facilitate interpretability ,",
    "gene expression data is often rescaled so that all variables have standard deviation 1 , meaning that @xmath32 is a correlation matrix .",
    "this rescaling is a linear transformation of the marginal distributions , @xmath33 , with @xmath34 being a diagonal matrix with diagonal elements @xmath35 , where @xmath36 is the @xmath37:th standard deviation . in practice",
    "these standard deviations are almost invariably estimated .",
    "invariance under such linear transformations of the marginal distributions is arguably the most important invariance property for a high - dimensional gene - set test .",
    "@xmath30 is not invariant under this kind of linear transformations , even if we condition on the random projections @xmath22 .",
    "some r code that illustrates this is given in appendix [ appinvar ] .",
    "using the data given in the appendix , for which @xmath38 and @xmath39 , we obtained the p - value @xmath40 when computing @xmath30 for the raw data with @xmath41 and @xmath42 .",
    "we then standardized the data by dividing by the marginal sample standard deviations . keeping the random projections and permutations fixed ,",
    "the p - value was @xmath43 after standardization .",
    "for the lopes et al .",
    "test , standardization can turn a non - significant gene - set into a significant one .    in section [ projection2 ]",
    "we propose a modification of the lopes et al .",
    "test that leads to a test statistic that is invariant under linear transformations of the marginal distributions .",
    "the invariance properties of several two - sample test statistics are compared in section [ comp1 ] .",
    "now , let @xmath44 and @xmath45 , @xmath46 , denote the @xmath18-dimensional subvectors of @xmath9 and @xmath10 , with @xmath21 . if @xmath15 then @xmath47 for all @xmath37",
    ". tests of the hypothesis @xmath15 can therefore be based on tests of the hypotheses @xmath47 .",
    "@xmath48 is usually extremely large in the high - dimensional setting and studying all @xmath18-dimensional subvectors of @xmath9 and @xmath10 is not feasible . as with the lopes et al .",
    "test , we can however randomly select @xmath49 @xmath18-dimensional subvectors and compute @xmath3 for each subvector , after which a conclusion about the @xmath0-dimensional hypothesis can be drawn by averaging the test statistics for the different subvectors .",
    "random subspace methods have previously been successfully applied to machine learning problems , e.g. by @xcite and @xcite .",
    "the heuristic motivation for this procedure is that if the deviations from the null hypothesis are spread out over many variables , they will likely be detected in many subvectors . on the other hand ,",
    "if the deviations are concentrated in just a few variables , those variables are likely to be investigated if @xmath50 is large enough .",
    "the algorithm for computing the random subspaces test statistic , denoted @xmath51 , is described below . in the rest of the paper",
    "the test statistic @xmath52 will be hotelling s statistic , but the test can also be carried out using other statistics .    to compute the p - value for the test , we propose using the permutation distribution , i.e. using algorithm 2 with the statistic @xmath51 .      while lopes et al .",
    "proposed using @xmath22 with i.i.d .",
    "@xmath24 elements , in their theoretical investigations they studied a more general test procedure , where @xmath22 can be generated by some other distribution .",
    "@xmath51 is a special case of the general random projections test studied in @xcite .    to see this , let @xmath53 be a @xmath0-vector with @xmath54 . if @xmath55 are drawn uniformly at random from @xmath56 without replacement and if @xmath57 then the projected sample is simply the part of the sample that resides in the @xmath18-dimensional subspace given by the indices @xmath55 .",
    "thus the random subspaces test and the general random projections test coincide for this particular choice of @xmath22 .    the asymptotic results of @xcite hold for any random matrices @xmath22 that have full rank with probability 1 . since the @xmath22 described above always has full rank , we have the following result .",
    "@xmath51 and @xmath30 are asymptotically equivalent .    consequently , the asymptotic relative efficiency of the random subspaces test with respect to the chen ",
    "qin test is given in theorem 3 of @xcite and the asymptotic relative efficiency with respect to the srivastava ",
    "du test is given in theorem 4 of said paper .    while asymptotically equivalent , @xmath30 and @xmath51 differ in their finite - sample properties , in particular regarding invariance :    let @xmath34 be a diagonal @xmath58 real matrix with nonzero diagonal elements and let @xmath59 .",
    "conditioned on the random subspaces chosen , @xmath51 is invariant under the linear transformations @xmath60 .    unlike e.g. orthogonal transformations , linear transformations of this type are linear in all @xmath18-dimensional subspaces , so that the invariance of @xmath51 follows from the fact that hotelling s statistic is invariant under linear transformations in the @xmath18-dimensional subspaces .",
    "the choice of @xmath18 affects the performance of the @xmath51 test .",
    "if @xmath18 is too close to @xmath62 the test loses power , since hotelling s @xmath3 performs poorly in this setting @xcite .",
    "if @xmath18 is too small , much of the multivariate structure of the data set is lost .",
    "@xcite found analytically that the asymptotic power of their test was maximized when @xmath63 .",
    "we have verified numerically that this seems to be a good choice for @xmath51 for finite sample sizes , although our simulation results indicate that the power is quite insensitive to small changes in @xmath18 , as illustrated in section [ comp3 ] . for large @xmath7 and @xmath8 , one may for purely computational reasons have to use a smaller @xmath18 , as the permutation step may be computationally unfeasible when @xmath18 is too large .",
    "the power of the test increases slightly with @xmath49 and @xmath61 , but is relatively stable for @xmath64 . in the simulation study below , we used @xmath65 and @xmath66 .",
    "in order to evaluate the performance of the random subspaces test and the random permutations version of the @xcite test , we compared them to other two - sample tests .",
    "@xcite proposed a hotelling - type test utilizing the trace of the sample covariance matrix .",
    "more recently , @xcite proposed a modification of the bai ",
    "saranadasa test , which has higher power in most situations .",
    "we therefore excluded the bai ",
    "saranadasa test from the study , choosing instead to focus our attention on the chen ",
    "we decided to use the asymptotic null distribution of the chen ",
    "qin statistic in our simulation , since using random permutations for computing the chen ",
    "qin p - value was extremely computer - intensive , at least using our implementation of the test .",
    "@xcite proposed using the moore - penrose inverse of the sample covariance matrix @xmath67 when computing hotelling s test statistic . in a small pilot study , we found the srivastava test to be computationally expensive and to have lower power than the competing tests .",
    "it was therefore excluded from the larger study .",
    "@xcite proposed replacing the sample covariance matrix @xmath67 in hotelling s statistic by a diagonal estimator .",
    "their test statistic is asymptotically standard normal under certain conditions , but convergence to normality appears to be slow .",
    "we used random permutations to compute the p - values of the srivastava  du - test in our comparison .",
    "compared to using the asymptotic null distribution , we found that the permutation procedure provided better type i error rates and resulted in higher power .    finally , we considered test based on combined multiple @xmath6-tests . for such tests ,",
    "the multivariate null hypothesis is rejected if at least one of the marginal null hypotheses is rejected .",
    "we used two methods for combining the tests : bonferroni correction , controlling the family - wise error rate , and the @xcite procedure , controlling the false discovery rate .",
    "when choosing between different tests , we are usually concerned with how well they attain their nominal type i error rates and how high their power is . in the high - dimensional setting",
    ", we must also take invariance properties into account , as discussed in section [ pro05 ] .",
    "we assume that both samples are transformed analogously .",
    "in section [ pro05 ] we argued that invariance under linear transformations of the marginal distributions is the most desirable invariance property in the gene expression setting .",
    "these are transformations of the type @xmath68 , where @xmath34 is a real diagonal @xmath58 matrix with nonzero diagonal elements and @xmath59 . among the tests considered here , only the marginal @xmath6-tests , the srivastava ",
    "du test and the random subspaces test ( conditioned on the random subspaces chosen ) are invariant under such transformations .",
    "saranadasa , chen  qin and srivastava tests are invariant under orthogonal transformations , i.e. transformations @xmath69 , where @xmath70 is a nonzero constant and @xmath71 is a real @xmath58 orthogonal matrix .",
    "this invariance property is arguably less attractive in the gene expression setting , as rotations of the coordinate system are of little interest",
    ".    the lopes et al .",
    "test is only invariant if the same scaling is applied to all marginal distributions , that is , under transformations of the type @xmath72 , where @xmath73 is the @xmath58 identity matrix and @xmath70 is a non - zero constant .",
    "all tests under consideration are based on either asymptotic or random permutation estimates of the null distribution .",
    "they do therefore in general not attain the nominal type i error rates exactly . to evaluate the actual type i error rates for the tests in a few interesting settings ,",
    "a monte carlo study was performed under the null hypothesis @xmath15 for @xmath26 and @xmath27 .",
    "two families of distributions of @xmath9 and @xmath10 and three different covariance structures were evaluated in the simulations .",
    "let @xmath74 denote a covariance matrix with unit variances and 8 equal - sized blocks , where @xmath75 is @xmath76 if @xmath77 and @xmath78 belong to the same block and @xmath79 otherwise .",
    "the first three distributions were multivariate normal , with covariance matrices @xmath80 , @xmath81 and @xmath82 . to study the impact of heavy - tailed distributions , the last two were multivariate @xmath6-distributions with 4 degrees of freedom and the covariance matrices @xmath80 and @xmath81 .    for each distribution ,",
    "@xmath83 samples were generated under the null hypothesis .",
    "the tests were then applied to each sample , using @xmath84 , @xmath65 and @xmath66 for @xmath51 and @xmath30 .",
    "the point estimates of the tests type i error rates are given along with 95 % confidence intervals ( not adjusted for multiplicity ) in table [ htabell3 ] .",
    "all hotelling - type tests have acceptable type i error rates , whereas the multiple @xmath6-tests have too low rates in some circumstances .      ,",
    "@xmath27 and @xmath85 . ]    to study the power of the tests in the cancer pathway setting described in section [ introduction ] , we performed simulations under the assumptions of normality and the covariance matrices @xmath81 and @xmath82 described in the previous section . for the @xmath10 variable , we shifted the means of 20 out of 25 genes evenly in each of @xmath86 out of the 8 blocks , for @xmath87 .",
    "the powers of the tests as functions of the resulting euclidean distance @xmath88 are shown in figure [ fig1 ] .    in the simulations ,",
    "1,000 samples were generated from each distribution .",
    "for the lopes et al . and random subspaces tests , @xmath65 , @xmath66 and @xmath84 were used .",
    "we also performed comparisons for other @xmath0 , @xmath7 and @xmath8 , as well as settings where @xmath89 and where the shifts were unevenly distributed among the variables .",
    "the resulting plots were not qualitatively different from those in figure [ fig1 ] and are therefore not shown here .    in our comparison , the lopes et al .",
    "test and the random subspaces tests were the only tests that _ gained _ power as the correlation between the variables was increased .",
    "for all the other tests , the power became lower when the variables became more dependent . for a fixed covariance matrix ,",
    "the power of the hotelling - type tests are relatively stable when the number of variables in which there is a difference change .",
    "the multiple @xmath6-tests are much more sensitive to this type of changes : their power decreases as the number of shifted variables increases .",
    "in figure [ fig3 ] we plot the power of @xmath51 for different choices of @xmath18 for one of the alternatives from figure [ fig1 ] .",
    "the plots for other alternatives are similar .",
    "while @xmath90 gives the highest power , the test is surprisingly insensitive to changes in @xmath18 . in the @xmath26 ,",
    "@xmath27 setting , where @xmath84 is asymptotically optimal , there is little difference in power when @xmath91 . under this particular alternative ,",
    "the test is on a par with the chen  qin and srivastava  du tests even when @xmath92 ( cf .",
    "figure [ fig1 ] ) .",
    "when @xmath26 , @xmath27 and @xmath85 . ]",
    "the random subspaces test quickly becomes very computer - intensive as @xmath18 increases , as we must invert @xmath93 matrices of size @xmath94 in order to obtain the p - value . in this section",
    "we discuss some ways to speed up the computations and compare the performances of different implementations in r.    small gains in speed can be achieved by avoiding repeating the same calculations more than once , e.g. by computing @xmath95 only once .",
    "moreover , when using the permutation distribution instead of the asymptotic null distribution , there is for instance no need to rescale the test statistic by the sample size .",
    "the most important tool for improving the computational speed , however , is parallelization , i.e. running the repetitions of steps 1 - 2 of algorithm 2 simultaneously instead of sequentially .",
    "an efficient parallel r implementation of the random subspaces test is given in appendix [ appr ] .",
    "the choice of @xmath18 impacts not only the power of the test , as shown in figure [ fig3 ] , but also the computational cost of the algorithm .",
    "there is therefore a trade - off between computational speed and power ; @xmath63 yields the highest power , but smaller @xmath18 will give improved computational performance .",
    "similarly , larger @xmath49 and @xmath61 are preferable from a statistical viewpoint , but lead to increased computational costs .    in figure [ fig4 ]",
    "the performances of two implementations of the test are compared for different choices of @xmath18 when @xmath26 and @xmath27 .",
    "the first is a naive sequential implementation in r. the second is a parallel implementation in r , using the ` domc ` package .",
    "the implementations were executed on a 64-core 2.2 ghz amd processor with 128 gb ram and r 2.15.2 , using different numbers of cores .",
    "the difference between the sequential and parallel r implementations is quite striking : when @xmath96 , the sequential implementation needed 61 second to perform the test , whereas the parallel implementation only needed 15.7 seconds using 4 cores and 3.0 seconds using 32 cores .     when @xmath26 and @xmath27.,scaledwidth=50.0% ]",
    "non - negligible dependence structures are present in virtually all genetic datasets and tests for differentially expressed gene - sets should therefore take such dependencies into account .",
    "most high - dimensional two - sample tests , as well as multiple @xmath6-tests , do not do this to a sufficient degree . the lopes et al . and random subspaces tests do account for dependencies , and consequently outperform their competitors in settings with non - negligible dependence structures .",
    "the powers of the two tests closely mimic each other . unlike the lopes et al .",
    "test however , the random subspaces test has the additional benefit of invariance under linear transformations of the marginals .",
    "judging from the simulation results in section [ comp ] , we therefore recommend the random subspaces test as the default high - dimensional two - sample test .      in most studies ,",
    "one wishes to perform tests for a large number of gene - sets and not just for a single set .",
    "it is generally agreed upon that one should use some sort of adjustment for multiplicity in such investigations , in order to lower the number of false discoveries .",
    "methods for doing such adjustments include bonferroni corrections for controlling the family - wise error rate ( e.g. * ? ? ?",
    "* ) , the @xcite false discovery rate procedure and resampling methods @xcite .",
    "the latter class of methods seems especially promising when dependent gene - sets are tested , as resampling methods to a greater extent can account for such dependencies . when used with test procedures that use random permutations to compute p - values , such methods can however become extremely computer - intensive .",
    "it should also be noted that research on multiple testing in genetic research mostly has focused on gene - level @xmath6-tests and that recommendations for univariate test need not carry over to the multivariate setting .",
    "how to adjust high - dimensional tests for multiplicity remains an open problem .",
    "the author wishes to thank elisabeth thulin and silvelyn zwanzig for helpful discussions .",
    "miles lopes kindly provided r code for computing the lopes et al .",
    "statistic , allowing the author to compare their implementation of the test to his own .",
    "99 bai , z. , saranadasa , h. ( 1996 ) .",
    "effect of high dimension : by an example of a two sample problem .",
    "_ statistica sinica _ ,",
    "* 6 * , 311329 .",
    "barry , w. , nobel , a. , wright , f. ( 2005 ) .",
    "significance analysis of functional categories in gene expression studies : a structured permutation approach .",
    "_ bioinformatics _ , * 21 * , 19431949 .",
    "barry , w. , nobel , a. , wright , f. ( 2008 ) . a statistical framework for testing functional categories in microarray data . _",
    "annals of applied statistics _ , * 2 * , 286315 .",
    "benjamini , y. , hochberg , y. ( 1995 ) . controlling the false discovery rate : a practical and powerful approach to multiple testing .",
    "_ journal of the royal statistical society series b _ , * 57 * , 289300 .",
    "bertoni , a. , folgiere , r. , valentini , g. ( 2005 ) .",
    "bio - molecular cancer prediction with random subspace ensembles of support vector machines .",
    "_ neurocomputing _ , * 63 * , 535539 .",
    "bingham , e. , mannila , h. ( 2001 ) .",
    "random projection in dimensionality reduction : applications to image and text data , in _ proceedings of the seventh acm sigkdd international conference on knowledge discovery and data mining ( kdd01)_.    chen , s.x .",
    ", qin , y.l . ( 2010 ) . a two - sample test for high - dimensional data with applications to gene - set testing . _ annals of statistics _",
    ", * 38 * , 808835 .",
    "cuesta - albertos , j.a .",
    ", fraiman , r. , ransford , t. ( 2006 ) .",
    "random projections and goodness - of - fit tests in infinite - dimensional spaces . _ bulletin of the brazilian mathematical society _ , * 37 * , 477501 .",
    "dudoit , s. , shaffer , j.p . ,",
    "boldrick , j.c .",
    "multiple hypothesis testing in microarray experiments .",
    "_ statistical science _ , * 18 * , 71103 .",
    "dudoit , s. , van der laan , m.j .",
    "_ multiple testing procedures with applications to genomics _ , springer , new york .",
    "durand , j. , atkison , t. ( 2011 ) . using randomized projection techniques to aid in detecting high - dimensional malicious applications , in _ proceedings of the 49th annual southeast regional conference ( acm - se11)_.    efron , b. , tibshirani , r. , storey , j. , tusher , v. ( 2001 )",
    ". empirical bayes analysis of a microarray experiment .",
    "_ journal of the american statistical association _ , * 96 * , 11511160",
    ".    efron , b. ( 2007 ) .",
    "correlation and large - scale simultaneous significance testing .",
    "_ journal of the american statistical association _ , * 102 * , 93103",
    ".    efron , b. , tibshirani , r. ( 2007 ) .",
    "on testing the significance of sets of genes . _ annals of applied statistics _ , * 1 * , 107129 .",
    "fern , x.z , brodley , c.e .",
    "random projection for high dimensional data clustering : a cluster ensemble approach , in _ proceedings of 20th international conference on machine learning ( icml2003)_.    gatti , d.m . ,",
    "barry , w.t . ,",
    "nobel , a.b . ,",
    "rusyn , i. , wright , f.a .",
    "heading down the wrong pathway : one the influence of correlation within gene sets .",
    "_ bmc genomics _ , * 11 * , 574 .",
    "ge , y. , dudoit , s. , speed , t. ( 2003 ) .",
    "resampling - based multiple yesting for microarray data analysis . _ test _ , * 12 * , 177 .",
    "goeman , j.j . ,",
    "bhlmann , p. ( 2007 ) . analyzing gene expression data in terms of gene sets : methodological issues .",
    "_ bioinformatics _ , * 23 * , 980987 .",
    "henrion , m. , mortlock , d.j . , hand , d.j . , gandy , a. ( 2011 ) . subspace methods for anomaly detection in high dimensional astronomical databases , in _ proceedings of the 58th world statistics congress of the international statistical institute ( isi11)_.    holm , s. ( 1979 ) .",
    "a simple sequentially rejective multiple test procedure . _ scandinavian journal of statistics _ , * 6 * , 6570 .",
    "jacob , l. , neuival , p. , dudiot , s. ( 2012 ) .",
    "more power via graph - structured tests for differential expression of gene networks .",
    "_ annals of applied statistics _ , * 6 * , 561600 .",
    "lai , c. , reinders , m.j.t . , wessels , l. ( 2006 ) .",
    "random subspace method for multivariate feature selection . _ pattern recognition letters _ , * 27 * , 10671076 .    lehmann , e.l .",
    "_ testing statistical hypotheses _ , john wiley & sons , new york .",
    "lopes , m.e . , jacob , l.j . , wainwright , m.j .",
    "( 2012 ) . a more powerful two - sample test in high dimensions using random projection , arxiv:1108.2401v2 .",
    "nettleton , d. , recknor , j. , reecy , j. ( 2008 ) .",
    "identification of differentially expressed gene categories in microarray studies using nonparametric multivariate analysis .",
    "_ bioinformatics _ , * 24 * , 192201 .",
    "newton , m. , quintana , f. , den boon , j. , sengupta , s. , ahlquist , p. ( 2007 ) .",
    "random - set methods identify distinct aspects of the enrichment signal in gene - set analysis .",
    "_ annals of applied statistics _ , * 1 * , 85106 .",
    "qui , x. , klebanov , l. , yakovlev , a. ( 2005 ) .",
    "correlation between gene expression levels and limitations of the empirical bayes methodology in microarray data analysis .",
    "_ statistical applications in genetics and molecular biology _ ,",
    "* 4 * , 34 .",
    "sohn , i. , owzar , k. , lim , j. , george , s.l . , mackey cushman , s. , jung , s .- h .",
    "multiple testing for gene sets from microarray experiments .",
    "_ bmc bioinformatics _ , * 12 * , 209 .",
    "srivastava , m.s .",
    "multivariate theory for analyzing high dimensional data .",
    "_ journal of the japan statistical society _ , * 37 * , 5386 .",
    "srivastava , m.s . ,",
    "du , m. ( 2008 ) . a test for the mean vector with fewer observations than the dimension .",
    "_ journal of multivariate analysis _ ,",
    "* 99 * , 386402 .",
    "srivastava , m.s .",
    ", katayarna , s. , kano , y. ( 2013 ) . a two sample test in high dimensional data .",
    "_ journal of multivariate analysis _ ,",
    "* 114 * , 349358 .",
    "varmuza , k. , filzmoser , p. , liebmann , b. ( 2010 ) .",
    "random projection experiments with chemometric data .",
    "_ journal of chemometrics _ , * 24 * , 209217",
    ".    vempala , s.s .",
    "( 2004 ) . _",
    "the random projection method _",
    ", dimacs series in discrete mathematics and theoretical computer science , american mathematical society , isbn 0 - 8218 - 3793 - 1 .",
    "wei , s. , lee , c. , wichers , l. , li , g. , marron , j.s .",
    "direction - projection - permutation for high dimensional hypothesis tests , arxiv:1304.0796v1 .",
    "+ contact information : + mns thulin , department of mathematics , uppsala university , box 480 , 751 06 uppsala , sweden + e - mail : thulin@math.uu.se",
    "an implementation of the random subspaces statistic in r is given below . in order to speed up the computation of the statistic",
    ", the ` .internal ` versions of ` mean ` and ` cov ` are used .",
    "this means that the function avoids error handling , such as checking whether the data contains ` na ` values .",
    "the outer loop used in the computation is parallelized using the ` foreach ` and ` domc ` packages .    .... # load required packages :",
    "library(compiler ) # compilation - for better performance library(domc )      # parallelization - for better performance registerdomc ( )    # hotellings t^2 statistic t2.func<-function(x,y,n1,n2,p ) {      mdiff<-.internal(colmeans(x , n1,p , na.rm = false))-             .internal(colmeans(y , n2,p",
    ", na.rm = false ) )      spool<-((n1 - 1)*.internal(cov(x , null , 1 , false))+(n2 - 1 ) *                    .internal(cov(y , null , 1 , false)))/(n1+n2 - 2 )      return(t(mdiff ) % * % solve((1/n1 + 1/n2)*spool ) % * % mdiff ) } t2.func<-cmpfun(t2.func )    # random subspaces subspacest2<-function(x , y , n1,n2,p , b=100,k = floor((n1+n2 - 2)/2 ) ) {      res<-vector(length = b )      for(j in 1:b )      {        x.cols<-sample(p,k )        x.new<-x[,x.cols ]        y.new<-y[,x.cols ]        res[j]<-t2.func(x.new , y.new , n1,n2,k )     }     return(.internal(mean(res ) ) ) } subspacest2<-cmpfun(subspacest2 )    subspaces.test<-function(x,y,n1,n2,p,b1=100,b2=100,k=floor((n1+n2-2)/2 ) ) {      z<-rbind(x , y ) # big matrix to resample from      zsize<-n1+n2           # permutations      rs<-data.frame(foreach(i = 1:b1 ) % dopar%      {        x.rows<-sample(zsize,n1 )        x.new<-z[x.rows , ]        y.new<-z[-x.rows , ]        subspacest2(x.new , y.new , n1,n2,p , b2,k )      } )           rs.obs<-subspacest2(x,y,n1,n2,p )        # return p - value :      return(sum(rs>=as.numeric(rs.obs))/b1 ) } subspaces.test<-cmpfun(subspaces.test )    # example of usage : library(mass )     # used to generate multivariate normal data    # set parameters : p<-200 n1<-n2<-50",
    "mu1<-rep(1,p ) mu2<-rep(1.02,p ) sigma1<-matrix(0.25,p , p ) diag(sigma1)<-1    # generate example data : x<-mvrnorm(n1 , mu1 , sigma1 ) y<-mvrnorm(n2 , mu2 , sigma1 )    # apply test : subspaces.test(x,y,n1,n2,p,b1=100,b2=500,k=49 ) ....",
    "the example below illustrates the lack of invariance of the lopes et al .",
    "test , discussed in section [ pro05 ] .",
    "it uses the function ` t2.func ` from the previous section .",
    "# compute the random projections statistic projectiont2<-function(x , y ,",
    "n1,n2,p , b=100,k = floor((n1+n2 - 2)/2),matrixlist ) {     res<-vector(length = b )     for(j in 1:b )     {        p<-as.matrix(data.frame(matrixlist[j ] ) )        x.new<-x % * % p        y.new<-y % * % p        res[j]<-t2.func(x.new , y.new , n1,n2,k )     }     return(.internal(mean(res ) ) ) } projectiont2<-cmpfun(projectiont2 )      # import data : x<-matrix(c(1.46,-2.28,0.73,0.02,0.39,0.75,-0.43,1.9,1.23,-0.15,1.31,2.37 , 5.37,-2.03,-1.48,5.16,-2.72,-2.67,3.9,-0.97,0.84,-2.55,1.37,-1.53,1.7 , 4.03,-0.1,0.97,4.24,0.43,3.13,-5.38,0.13,4.67,6.01,2.75,-1.71,3.52,2.17 , -2.93,2.45,2.59,-1.59,5.64,4.8,5.01,3.15,4.36,5.27,-0.53,1.58,0.53,1.39 , 1.67,0.16,1.32,0.61,1.54,1.81,0.59,1.4,2.17,1.8,0.34,0.74,0.06,1.24,1.44 , 0.91,0.55,0.22,1.32,0.36,0.94,1.34,1.87,0.69,0.65,1.62,0.16,0.28,-0.3,0.84 , 1.28,1.33,2.3,1.55,1.54,1.87,1.29,2.2,0.9,1.44,2.02,1.34,1.73,1.92,0.31 , 0.81,0.75),5,20 )    y<-matrix(c(1.57,2.03,0.58,3.2,2.03,4.18,3.04,0.4,1.73,2.3,3.2,2.84,3.39 , 4.17,2.84,1.26,2.88,-1.07,4.4,-0.71,-5.21,-2.07,2.7,6.02,-1.38,-0.03,3.06 , 0.29,4.15,2.02,3.07,3.86,5.81,2.62,0,4.66,3.3,0.37,2.57,4.57,3.86,3.46,-1 , 2.72,-1.58,2.06,6.09,6.88,1.36,0.07,2.33,-0.17,2.37,1.85,1.15,3.77,1.1 , 2.15,2.5,1.52,3.31,-0.2,2.7,1.89,1.8,2.61,1.34,2.55,3.87,1.58,3.29,2.97 , 2.33,2.6,2.65,2.32,1.23,2.22,2.83,1.52,1.85,1.84,1.8,1.75,1.96,1.31,0.47 , 1.3,2.69,2.01,3.41,1.03,1.44,0.65,1.76,1.72,0.85,3.58,1.2,2.2),5,20 )          # permutations : z<-rbind(x , y ) z2<-rbind(x2,y2 ) zsize<-n1+n2       rs<-data.frame(foreach(i = 1:b2 ) % dopar% {     matrixlist2<-foreach(j = 1:b ) % dopar%     {        matrix(rnorm(k*p),p ,",
    "k )             }     x.rows<-sample(zsize,n1 )     x.new<-z[x.rows , ]     y.new<-z[-x.rows , ]     x2.new<-z2[x.rows , ]     y2.new<-z2[-x.rows , ]     c(raw = projectiont2(x.new , y.new , n1,n2,p , b , k , matrixlist2 ) ,     stand = projectiont2(x2.new , y2.new , n1,n2,p , b , k , matrixlist2 ) ) } )"
  ],
  "abstract_text": [
    "<S> a common problem in genetics is that of testing whether a set of highly dependent gene expressions differ between two populations , typically in a high - dimensional setting where the data dimension is larger than the sample size . </S>",
    "<S> most high - dimensional tests for the equality of two mean vectors rely on naive diagonal or trace estimators of the covariance matrix , ignoring dependencies between variables . a test recently proposed by @xcite </S>",
    "<S> implicitly incorporates dependencies by using random pseudo - projections to a lower - dimensional space . </S>",
    "<S> their test offers higher power when the variables are dependent , but lacks desirable invariance properties and relies on asymptotic p - values that are too conservative . </S>",
    "<S> we illustrate how a permutation approach can be used to obtain p - values for the lopes et al . </S>",
    "<S> test and how modifying the test using random subspaces leads to a test statistic that is invariant under linear transformations of the marginal distributions . the resulting test does not rely on assumptions about normality or the structure of the covariance matrix . we show by simulation that the new test has higher power than competing tests in realistic settings motivated by microarray gene expression data . </S>",
    "<S> we also discuss the computational aspects of high - dimensional permutation tests and provide an efficient r implementation of the proposed test .     </S>",
    "<S> + * keywords : * computational statistics ; gene expression data ; gene - set testing ; high - dimensional data ; large @xmath0 small @xmath1 ; permutation test ; random subspace ; test about the mean ; two - sample problem . </S>"
  ]
}