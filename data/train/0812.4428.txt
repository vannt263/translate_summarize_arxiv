{
  "article_text": [
    "inhomogeneous time - dependent schrdinger equations , @xmath0 arise in many formal solutions of quantum dynamics .",
    "in particular they have been employed in a time dependent treatment of reactive scattering @xcite and in optimal control theory using time - dependent targets @xcite or state - dependent constraints @xcite . in reactive scattering , the inhomogeneity results from the application of a projection operator @xcite .",
    "this projector divides the hilbert space of the reactive system into subspaces corresponding , respectively , to the reactants and to the products .",
    "a reduced description for only the products can be derived where the time - dependent schrdinger equation contains an inhomogeneity , i.e. a source term that corresponds to the creation of the products @xcite .    in optimal control theory ( oct )",
    ", the inhomogeneity may be caused by a projection operator as well .",
    "for example , a partitioning of the hilbert space is implemented by a projection operator in order to suppress population in a forbidden subspace @xcite .",
    "this leads to a formulation of oct with a state - dependent constraint containing the projection operator . as a result",
    "the backward propagation of the oct equations includes an inhomogeneity in the schrdinger equation .",
    "this term corresponds to the suppression of probability amplitude in the forbidden subspace .",
    "generally , an inhomogeneous schrdinger equation arises in oct if a time - dependent target or a state - dependent constraint are utilized . in the common versions of oct ,",
    "see e.g. refs .",
    "@xcite , the target is not explicitly time - dependent , it depends only on some final time @xmath1 .",
    "the constraints enforce the schrdinger equation and a minimization of the field energy .",
    "but for explicitly time - dependent targets @xcite or for a state - dependent constraint @xcite the optimization functional contains a contribution of the form @xmath2 dt\\,,\\ ] ] where the state @xmath3 of the system enters at each time @xmath4 .    for the solution of the standard homogeneous time - dependent schrdinger equation ,",
    "a number of numerical propagation schemes exist @xcite .",
    "the chebychev propagator @xcite offers the advantage of a numerically exact solution .",
    "the accuracy of the calculation is then determined by the machine precision of the computer and the error is uniformly distributed .",
    "the propagator is based on approximating the formal solution of the homogeneous time - dependent schrdinger equation , @xmath5 by a series of chebychev polynomials .",
    "time - dependent _ inhomogeneous _ schrdinger equations have been solved to date with split - propagator schemes @xcite or via a full diagonalization of the hamiltonian @xcite . while the latter method is numerically expensive and",
    "quickly becomes unfeasible with increasing system size , the first is of only limited accuracy .",
    "here , we derive a formal solution of the time - dependent inhomogeneous schrdinger equation and we adapt it to the chebychev propagation scheme .",
    "we apply this new propagator to the optimal control with a state - dependent constraint and with a time - dependent target .",
    "the paper is organized as follows : section  [ sec : formalsol ] presents the formal solution of eq .",
    "( [ eq : inhtdse ] ) .",
    "propagation schemes for the formal solution are derived in section  [ sec : cheby ] .",
    "the chebychev propagation scheme is applied to oct with a state - dependent constraint where the system is forced to remain in a subspace of the total hilbert space in section  [ sec : appl1 ] . in this case",
    "the operator @xmath6 in eq .",
    "( [ eq : inhtdse ] ) is independent of time , @xmath7 . in section  [ sec :",
    "appl2 ] , a second application , oct with a time - dependent target , is studied keeping the full time - dependence , @xmath8 . in both applications ,",
    "the convergence of the new chebychev propagator is analyzed in detail .",
    "section  [ sec : concl ] concludes .",
    "the inhomogeneous schrdinger equation , eq .",
    "( [ eq : inhtdse ] ) , is treated as an ordinary differential equation .",
    "it can be rewritten ( setting @xmath9 ) @xmath10 where @xmath11 .",
    "( [ eq : inhse ] ) is solved subject to the boundary conditions @xmath12 @xmath13 is known globally in the propagation time interval , @xmath14 $ ] , for example by a numerical representation on @xmath15 sampling points .",
    "@xmath13 is assumed to be analytic , so that it can be interpolated to any arbitrary point within @xmath14 $ ] .",
    "the representation of @xmath13 on @xmath15 sampling points corresponds to an expansion in @xmath15 basis functions .",
    "choosing equidistant sampling points yields a fourier representation . a high - order ( usually @xmath16 ) polynomial expansion",
    "is obtained when the sampling points are chosen as roots of polynomials , implying non - equidistant time steps .",
    "the optimal representation treating correctly the boundaries is obtained by choosing chebychev polynomials .",
    "the basic idea consists in devising a short - time integration scheme for the interval @xmath17 $ ] ( or , more generally @xmath18 $ ] with @xmath19 ) by taking the following polynomial expansion of the inhomogeneous term , @xmath20 here , @xmath21 denotes the chebychev polynomial of order @xmath22 with expansion coefficient @xmath23 , and @xmath24 is a rescaled time , @xmath25 , for @xmath26 $ ] . note that the sum on the right - hand side of eq .",
    "( [ eq : taylor ] ) is only of the form of a taylor expansion for later manipulations but the approach itself is not based on a taylor expansion .",
    "the chebychev expansion coefficients @xmath23 can be obtained e.g. by a cosine transformation ( cf .",
    "@xcite and section  [ sec : inhomcheby ] below ) .",
    "once the coefficients @xmath23 are known they are used to generate the coefficients @xmath27 in the second sum of eq .",
    "( [ eq : taylor ] ) , cf .",
    "appendix [ app : trafo ] .",
    "this procedure has the advantage of employing a uniform approximation of @xmath27 in the interval @xmath17 $ ] .",
    "however , if the function @xmath13 is not known analytically , it needs to be interpolated at sampling points @xmath26 $ ] in order to calculate the expansion coefficients @xmath23 . as a simpler alternative",
    ", the function @xmath27 is expanded in a taylor series in the time interval @xmath17 $ ] .",
    "then the coefficients @xmath28 become the @xmath22th derivative of @xmath13 , at the beginning of the interval . at this point",
    "the properties of the global @xmath15 interpolation function of @xmath13 are used to calculate @xmath28 as numerical derivatives at the beginning of each interval .    based on eq .",
    "( [ eq : taylor ] ) , the solution of eq .",
    "( [ eq : inhse ] ) can be written as @xmath29 in eq .",
    "( [ eq : formalsol ] ) , the subscript @xmath30 denotes the order of the solution .",
    "the @xmath31 are obtained iteratively , @xmath32 and @xmath33 is a function of @xmath34 given by @xmath35 equations  ( [ eq : formalsol])-([eq : fm ] ) represent the formal solution to the inhomogeneous schrdinger equation .    in order to verify that eq .",
    "( [ eq : formalsol ] ) is indeed a solution to eq .",
    "( [ eq : inhse ] ) , let s take the derivative of eq .",
    "( [ eq : formalsol ] ) ,    @xmath36    inserting eq .",
    "( [ eq : lambdas ] ) in the first term and resumming with an upper limit @xmath37 , one obtains @xmath38    recognizing @xmath33 , cf .",
    "( [ eq : fm ] ) , as part of the last term and inserting @xmath39 , cf .",
    "( [ eq : lambdas ] ) , in the second term , which then cancels with the second summand of the last term , this can be rewritten @xmath40 the expression in parenthesis corresponds to @xmath41 , cf .",
    "( [ eq : formalsol ] ) . finally , replacing the second term by @xmath13 , cf .",
    "( [ eq : taylor ] ) , the inhomogeneous schrdinger equation , eq .",
    "( [ eq : inhse ] ) , is obtained .",
    "therefore eq .",
    "( [ eq : formalsol ] ) presents indeed a solution to eq .",
    "( [ eq : inhse ] ) .",
    "the formal solution , eq .",
    "( [ eq : formalsol ] ) , is subjected to a spectral approximation , @xmath42 where @xmath43 is a polynomial of order @xmath44 approximating @xmath45 .",
    "for example , to first order , @xmath46 , the formal solution is given by @xmath47 in principle one might seek a spectral approximation for each of the terms . however , it is numerically more efficient to rewrite the first order solution , @xmath48 with @xmath49 , such that only a single chebychev expansion plus one extra application of the hamiltonian are required .",
    "similarly , to second and third order the formal solutions can be written @xmath50 with @xmath51 and @xmath52 given by eq .",
    "( [ eq : fm ] ) and @xmath31 by eq .",
    "( [ eq : lambdas ] ) .",
    "the strategy is then to seek a polynomial approximation for the functions @xmath53 . for @xmath54 ,",
    "this corresponds to the standard chebychev propagator for the homogeneous schrdinger equation @xcite .",
    "it will be briefly reviewed for clarity , followed by a discussion of the polynomial approximation of the new functions .",
    "the chebychev propagator is based on treating the formal solution as a function of an operator which is applied to some state vector , @xmath55 and to approximate this function by an expansion in chebychev polynomials @xmath56 , @xmath57 since the chebychev polynomials are defined within the range @xmath58 $ ] , the hamiltonian has to be renormalized , @xmath59 where @xmath60 denotes the smallest eigenvalue of @xmath61 and @xmath62 the spectral range of @xmath61 .",
    "the wavefunction propagated from time zero to @xmath4 is then obtained by @xmath63 where the phase factor in front of the sum is due to the renormalization .    the algorithm to estimate @xmath64 proceeds as follows :    1 .",
    "calculate the expansion coefficients @xmath65 , @xmath66 for the function @xmath67 , the integrals can be solved analytically resulting in the bessel functions @xcite .",
    "2 .   calculate @xmath68 using the recursion relation of the chebychev polynomials , @xmath69 3 .",
    "accumulate the result , taking into account the phase factor due to renormalization , @xmath70    task 1 has to be performed only once , while 2 and 3 are repeated for each propagation step . the number @xmath44 of chebychev polynomials",
    "is chosen such that the coefficient @xmath71 becomes smaller than some specified error @xmath72 .",
    "since the coefficients can be determined analytically , @xmath72 may correspond to the machine precision of the computer .      according to eqs .",
    "( [ eq : firstorder]-[eq : thirdorder ] ) a single chebychev expansion plus a few applications of the hamiltonian are required to solve the inhomogeneous schrdinger equation .",
    "in particular , the application of a function @xmath73 to a state vector @xmath74 has to be considered , @xmath75 where @xmath74 is obtained recursively by eq .",
    "( [ eq : lambdas ] ) .",
    "the chebychev propagation scheme now consists in calculating @xmath76 and performing tasks 13 for @xmath77 instead of @xmath78 and the approximation of @xmath79 .",
    "\\(i ) for @xmath80 , the integrals required to calculate the expansion coefficients @xmath65 , eq .  ( [ eq : an ] ) , can not be solved analytically anymore .",
    "they can , however , be obtained numerically with sufficient efficiency and accuracy @xcite .",
    "the approach of ref .",
    "@xcite is repeated here for completeness : applying a gaussian quadrature to the chebychev polynomials , the integral in eq .",
    "( [ eq : an ] ) is rewritten , @xmath81 where the sampling points @xmath82 correspond to the @xmath44 roots of the polynomial @xmath43 , @xmath83 since the chebychev polynomials can be expressed in terms of cosines , @xmath84 with @xmath85 , eq .",
    "( [ eq : an_general ] ) corresponds to a cosine transformation , @xmath86 the expansion coefficients are thus most easily evaluated by fast cosine transformations .",
    "special care is , however , required for small values of the argument of @xmath87 since @xmath87 involves division by the @xmath30th power of @xmath61 .",
    "it is recommended to employ the definition of @xmath87 , eq .",
    "( [ eq : fm ] ) , only if the argument is larger than some small value @xmath88 and to use a taylor expansion of @xmath87 , @xmath89 for arguments smaller than @xmath88 .",
    "\\(ii ) as explained in section  [ sec : formalsol ] , a taylor expansion of @xmath13 for each integration interval @xmath17 $ ] is most easily used if the inhomogeneous term is represented numerically at sampling points .",
    "recursive calculation of @xmath74 then requires numerical evaluation of the time derivatives of the inhomogeneous state vector , @xmath13 .",
    "second order @xmath90 requires the first derivative which can be obtained with sufficient accuracy by fast fourier transformation ( fft ) and multiplication in frequency domain .",
    "however , an error is introduced due to finite values of @xmath13 at the boundaries of the grid , i.e. @xmath91 and @xmath92 .",
    "this error is increased and propagated throughout the time interval in the calculation of higher order derivatives by fft and multiplication in frequency domain .",
    "higher order schemes require therefore a different method for the evaluation of the derivatives .",
    "a suitable choice represents @xmath13 by an expansion into chebychev polynomials .",
    "the derivatives are then calculated recursively based on the analytical properties of the chebychev polynomials @xcite .",
    "note that this implies a non - equidistant time grid since the roots of the chebychev polynomials need to be taken as sampling points , @xmath93 where the time interval @xmath94 $ ] is scaled to @xmath95 $ ] and @xmath15 denotes the number of sampling points .",
    "a non - equidistant time grid requires calculation and storage of the chebychev expansion coefficients of the propagator for each @xmath96 .",
    "this additional effort is well paid off since a higher order scheme allows for larger time steps , i.e. smaller @xmath15 .",
    "the algorithm to solve the inhomogeneous time - dependent schrdinger equation is summarized in order to outline the flow chart of the numerical implementation :    1 .",
    "set the time grid @xmath97 and determine the inhomogeneous term @xmath98 .",
    "2 .   calculate the chebychev expansion coefficients of @xmath45 , cf .",
    "( [ eq : fm ] ) .",
    "this needs to be done for each time step size that occurs in a time grid with non - equidistant steps or only once if an equidistant time grid is employed .",
    "3 .   determine all @xmath99 required in eqs .",
    "( [ eq : formalsol ] ) and ( [ eq : lambdas ] ) .",
    "this is done differently whether the uniform approximation or the taylor expansion over the short - time interval @xmath17 $ ] is employed .",
    "+ uniform approximation ( chebychev expansion ) : 1 .",
    "determine chebychev sampling points @xmath100 within each short - time interval @xmath17 $ ] ( or , generally , @xmath18 $ ] ) , cf .",
    "( [ eq : xk ] ) , and determine the value of @xmath101 analytically or by numerical interpolation .",
    "2 .   calculate the chebychev expansion coefficients @xmath23 of @xmath101 by cosine transformation analogously to eq .",
    "( [ eq : an_cos ] ) with @xmath102 replaced by @xmath103 .",
    "3 .   derive @xmath28 for all @xmath97 from @xmath23 using the transformation between a chebychev and a taylor expansion given in appendix  [ app : trafo ] , i.e. employing the recursive relations given in eqs .",
    "( [ eq : coeffb0 ] ) and ( [ eq : coeffbi ] ) .",
    "+ taylor expansion : + calculate @xmath28 as time derivatives of @xmath98 either by fft for equidistant time grid or by numerical differentiation based on the analytical properties of chebychev polynomials @xcite for non equidistant time steps .",
    "4 .   perform the time propagation , i.e. for each time step from 0 to @xmath4 ( or , generally , @xmath104 to @xmath105 ) , 1 .",
    "determine @xmath39 according to eq .",
    "( [ eq : lambdas ] ) , 2 .",
    "obtain @xmath106 by chebychev recursion , cf .",
    "( [ eq : chebyrec ] ) , 3 .   evaluate @xmath107 ( or , generally , @xmath108 ) according to eq .",
    "( [ eq : formalsol ] ) .    in order to avoid storage of the chebychev expansion coefficients , step 2 in the case of a non - equidistant time grid and step 3 in the case of the uniform approximation",
    "may also be performed during the time propagation in step 4 .",
    "the algorithm to solve the inhomogeneous time - dependent schrdinger equation requires adjustment of two parameters  the order of the algorithm , @xmath30 , and the propagation time step , i.e. the size of the short - time interval .",
    "the latter can also be specified in terms of the overall number of time steps , @xmath15 , which is particularly useful for non - equidistant time steps .",
    "the two parameters are linked to each other : employing a higher order @xmath30 allows for taking larger time steps , or , equivalently , reducing @xmath15 .",
    "a detailed discussion how the two parameters should be chosen is presented for the applications in sections  [ sec : appl1 ] and [ sec : appl2 ] below .      a simplified version of the algorithm is devised by approximating the formal solution explicitly by a taylor expansion .",
    "this yields a standard chebychev propagator plus additional terms involving derivatives of @xmath13 .",
    "an existing chebychev propagation code then needs little modification to be adapted to an inhomogeneous schrdinger equation .",
    "the accuracy of the simplified algorithm is , however , limited by the taylor expansion .",
    "as shown in appendix  [ app : approx ] , the formal solution , eq .",
    "( [ eq : formalsol ] ) , can be written as @xmath109 with @xmath110 taking the taylor expansion of the exponential in @xmath111 up to order @xmath112 , @xmath113 one obtains an approximation of eq .",
    "( [ eq : formalsolbis ] ) , @xmath114 to all orders , only the standard chebychev propagation scheme plus calculation and storage of the derivatives of the inhomogeneous term , @xmath28 , are required .",
    "for example , the approximate solution to second order reads @xmath115    unlike the propagator described in sections  [ sec : inhomcheby ] and [ sec : summaryalgorithm ] , this scheme is explicitly based on a taylor expansion .",
    "it is therefore expected to be valid only for small time steps . in that case , a low order scheme ( e.g. @xmath90 ) is sufficient .",
    "the necessary derivatives can then be calculated by fft and multiplication in frequency domain .",
    "the validity of this approximation is discussed in detail in section  [ subsec : test ] .",
    "in our first example , the operator occuring in the inhomogeneous term is not time - dependent , @xmath7 .",
    "a simplified model of the vibrations in a rb@xmath116 molecule is considered taking into account three electronic states @xcite .",
    "the corresponding hamiltonian reads @xmath117 where @xmath118 denotes the vibrational hamiltonians , @xmath119 , @xmath120 the transition dipole operator , assumed to be independent of @xmath121 , and @xmath122 the electric field .",
    "the electronic states are associated to @xmath123 , @xmath124 and @xmath125 , with the potentials found in ref .",
    "@xcite .",
    "oct is tested for the objective of population transfer from the vibrational ground state of the electronic ground surface to a particular vibrationally excited state via raman transitions between the ground and the second electronic surface . for strong laser fields @xmath122 , such as those found by oct algorithms , population at intermediate times",
    "will be excited not only to the second but also to the third electronic surface .",
    "this is particularly the case for the electronic states of our example , where transition frequencies and franck - condon factors for transitions between @xmath126 and @xmath127 are very similar to those for transitions between @xmath127 and @xmath128 . assuming that the third electronic state corresponds to a loss channel , e.g. an intermediate state in resonantly enhanced multi - photon ionization or an autoionizing state , population transfer into this state should be avoided at all times .",
    "this can be communicated to the oct algorithm by formulating a state - dependent constraint which maximizes the projection onto the allowed subspace @xcite , i.e. onto electronic states 1 and 2 .",
    "the complete functional for optimization is then given by @xcite @xmath129 =    j_0[\\varphi_t,\\varphi_t^*]\\,+\\,j_a[\\epsilon ] \\,+\\,j_b[\\varphi,\\varphi^*]\\ ] ] with @xmath130&=&\\lambda_0\\ , \\langle\\varphi(t)|{\\boldsymbol{\\mathsf{\\hat{d}}}}|\\varphi(t)\\rangle \\ , , \\\\",
    "j_a[\\epsilon ] & = & \\int_0^t \\lambda_a(t)\\,[\\epsilon(t)-\\epsilon_r(t)]^2 \\ , dt \\,,\\\\",
    "j_b[\\varphi,\\varphi^\\dagger]&=&\\int_0^t \\lambda_b\\langle\\varphi(t)|{\\boldsymbol{\\mathsf{\\hat{p}}}}_\\mathrm{allow}|\\varphi(t)\\rangle \\,dt \\,.\\end{aligned}\\ ] ] the operator @xmath131 in @xmath132 is given by the projector onto the target level in the electronic ground state",
    ". the state - dependent constraint contains the projector onto the allowed subspace , @xmath133 . in ref .",
    "@xcite , propagation via full diagonalization of the hamiltonian was employed and only 11 vibrational levels in each electronic state were considered . representing the vibrational hamiltonians on a fourier grid @xcite and utilizing the inhomogeneous chebychev propagator , the full potentials can be taken into account ( @xmath134 ) .      in order to test the new chebychev propagator , our numerical results are compared to those obtained by the symmetrical method for the hamiltonian comprising of 11 levels in each electronic state @xcite .",
    "the details of the symmetrical method are reviewed in appendix  [ app : symm_method ] .",
    "the inhomogeneous schrdinger equation reads @xcite @xmath135\\ ,    with the `` initial '' condition latexmath:[\\[\\label{eq : chi_t }    in oct , @xmath41 is the backward propagated wavefunction which is coupled to @xmath137 obtained by forward propagation , @xmath138    @xmath139 .",
    "the convergence with respect to the time step @xmath140 and the order @xmath30 of the chebychev method will be discussed in section  [ subsec : conv1 ] .",
    "we start by propagating the initial state , @xmath141 of the electronic ground state , forward with a gaussian pulse given by eq .",
    "( 33 ) of ref .",
    "the inhomogeneous schrdinger equation is then propagated backward with the same field .",
    "all parameters are taken to be equal to those of ref .",
    "@xcite .",
    "figure [ fig : cheb_symm ] shows the expectation value of the projector onto the forbidden subspace , @xmath142 , for normalized @xmath41 .",
    "results for the symmetrical method and the first order chebychev propagators based on eq .",
    "( [ eq : formalsol ] ) and on eq .",
    "( [ eq : approxformalsol ] ) ( taylor ) are compared . a good agreement between the chebychev propagators and",
    "the symmetrical scheme is found .",
    "the time step needed to obtain converged results with the approximate solution is , however , smaller by a factor of ten .",
    "this is not surprising since the approximate solution is based on a taylor expansion which requires a very small @xmath140 .",
    "our main motivation for the development of the modified chebychev propagator lies in its application in oct with a state - dependent constraint or a time - dependent target .",
    "therefore the new propagator is also tested in an iterative solution of the control equations .",
    "the control problem is that of ref .",
    "however , in the present work the full vibrational hamiltonians are employed .",
    "convergence of the oct algorithm is measured by the normalized functional , @xmath143 , approaching one as the control equations are iteratively solved , cf .",
    "[ fig : oct_result ] . the symmetrical scheme ( @xmath144a.u . , black solid line )",
    "is compared to the chebychev propagator in first order ( orange dashed line ) and to the chebychev propagator based on the taylor approximation , eq .",
    "( [ eq : approxformalsol ] ) , ( blue dotted line ) in second order .",
    "an overall good agreement is found .",
    "the difference between the results at intermediate iterations is attributed to the different models , the full vibrational hamiltonian in the case of the chebychev propagators and the hamiltonian consisting of 33 levels in the case of the symmetrical method .",
    "application of the chebychev propagator based on the taylor approximation , eq .",
    "( [ eq : approxformalsol ] ) , in first order failed : the inhomogeneous schrdinger equation is solved with insufficient accuracy and the property of monotonic convergence of the krotov method @xcite is lost during the iterative solution of the control equations .",
    "this is easily rationalized in terms of the very fast oscillations occuring in the optimized field .",
    "they require either a very small time step or a higher order in the approximation of the exponential , @xmath145 , by a taylor expansion .",
    "the complexity of the pulse and hence the time variation of the inhomogeneous term determine the required order of the taylor approximation .",
    "the convergence and the efficiency of the inhomogeneous chebychev propagator are analyzed with respect to the number of time steps @xmath15 and the order @xmath30 of the solution .",
    "the main numerical effort is required for the application of the hamiltonian and the calculation of the derivatives . for a given propagation time @xmath1 one would like to identify optimum values of @xmath15 and @xmath30 that yield a mininum computation time for a specified accuracy . in general , decreasing the number of time steps @xmath15 or , respectively , increasing @xmath140 will require a larger number of chebychev polynomials in the expansion of the function @xmath146 , but also a higher order @xmath30 of the solution .",
    "the recursive calculation of the chebychev polynomials in the expansion of @xmath146 implies continued application of the hamiltonian .",
    "moreover , higher order solutions require additional applications of the hamiltonian , cf .",
    "( [ eq : firstorder]-[eq : thirdorder ] ) , and determination of derivatives of the inhomogeneous term up to degree @xmath37",
    ".    we consider first equidistant time steps and evaluate the time derivatives by fft .",
    "figure [ fig : convergence ] traces the population in the forbidden subspace to illustrate the convergence behavior for dynamics under a gaussian pulse .    in first order , cf .",
    "[ fig : convergence]a , the dynamics are found to be converged for time steps @xmath147a.u . at larger time steps , deviations",
    "are observed , in particular at short times ( occuring late for backward propagation ) .",
    "dynamics with the largest possible time step at each order are shown in fig .",
    "[ fig : convergence]b .    .cpu time required for one backward propagation to obtain converged solutions in first , second and third order for a total propagation time of @xmath148ps with equidistant time steps @xmath140 .",
    "also listed are the number of time steps , @xmath15 , the number of times the hamiltonian is applied and the number of terms in the chebychev expansion , @xmath149 . [ cols=\"^,^,^,^,^,^\",options=\"header \" , ]     the same conclusion is obtained as in section  [ sec : appl1 ] , i.e it is more efficient to employ a higher order scheme .",
    "overall , no difference in the convergence behavior for time - dependent and time - independent operators in the inhomogeneous term , @xmath8 is found .",
    "this can be rationalized as follows : the convergence is determined by the fastest timescale of the dynamics , i.e. by the rapid oscillations of the field .",
    "the time - dependence of the projection operator introduces a time - dependence which is much slower and hence does not affect convergence .",
    "a formal solution to the time - dependent inhomogeneous schrdinger equation was derived based on an expansion of the inhomogeneous term",
    ". three levels of chebychev approximations are involved .",
    "* the first one yields the chebychev propagator where the argument of the chebychev polynomials is the hamiltonian . truncating the expansion at the desired order @xmath30",
    ", the formal solution is subjected to a spectral representation with chebychev polynomials . a propagation scheme similar to the standard chebychev propagator for homogeneous schrdinger equations",
    "is then obtained : instead of @xmath150 a function @xmath146 is expanded in chebychev polynomials . for the exponential function",
    ", the expansion coefficients can be calculated analytically , for the function @xmath102they need to be obtained numerically .",
    "this is achieved by fast cosine transformations , utilizing the definition of chebychev polynomials in term of cosines . *",
    "the second level expands the inhomogeneous state vector @xmath13 in chebychev polynomials within each short - time integration interval @xmath17 $ ] .",
    "the argument of this expansion is the rescaled time @xmath151 covering the interval .",
    "this chebychev approximation is easily applied only if @xmath13 is known analytically .",
    "if @xmath13 is determined numerically on sampling points covering the global propagation time interval @xmath14 $ ] , there are two choices .",
    "@xmath13 needs to be interpolated to sampling points within @xmath17 $ ] . in a simpler alternative ,",
    "the chebychev expansion is replaced by a taylor expansion based on numerical derivatives at the beginning of each time step .",
    "this has been done for the present applications . *",
    "the numerical calculation of the derivatives requires a third level of chebychev approximation where the argument is the time @xmath4 covering the global propagation time interval @xmath14 $ ] .",
    "this implies a non - equidistant time grid where the derivatives are evaluated according to the procedure described in ref .",
    "this expansion overcomes the numerical error introduced by non - zero boundary values of the inhomogeneous state vector @xmath13 at @xmath91 and @xmath92 .",
    "an alternative based on equidistant time steps employs fast fourier transforms and multiplication in frequency domain .",
    "however , in that case the errors introduced at the boundary of the time grid build up",
    ". therefore this scheme is limited to low order where only first or second derivatives are required .",
    "an even more approximate solution to the time - dependent inhomogeneous schrdinger equation is obtained by rewriting the formal solution explicitly in terms of a taylor expansion .",
    "the propagator then consists of the standard exponential term plus time derivatives of the inhomogeneous terms .",
    "this approximation is numerically less efficient than the propagator for the full formal solution .",
    "moreover , it may become instable in optimal control applications where the inhomogeneous term often is highly oscillatory and the numerical evaluation of derivatives by fft becomes difficult .",
    "the main advantage of this propagation scheme lies in the fact that it requires very little modification of existing standard chebychev propagation codes .",
    "both chebychev propagation schemes were tested in two optimal control applications .",
    "oct with a state - dependent constraint @xcite , e.g. maximizing population in an allowed subspace of the hilbert space , yields a time - independent operator in the inhomogeneous term while an explicitly time - dependent operator is obtained in oct with a time - dependent target @xcite .",
    "convergence of the propagation schemes was demonstrated for both applications .",
    "the convergence behavior was studied in detail as a function of the order of the solution and the required number of time steps for a given overall propagation time . for applications with a fast time - dependence such as oct , a low order scheme with a small time step and evaluation of the time derivatives by fft",
    "was found to be the best choice . for applications with a slow time - dependence or time - independent hamiltonians such as reactive scattering calculations where large time steps are permissible",
    ", a high - order scheme is numerically most efficient .",
    "this reflects that the propagation scheme is based on a global representation of the inhomogeneous term .",
    "it is this regime where the new propagator can best unfold its power .",
    "the new chebychev propagator provides a stable and accurate numerical solution to the time - dependent inhomogeneous schrdinger equation .",
    "it is most efficient for high order and large time steps .",
    "ideally an inherent time - dependence of the hamiltonian should also be incorporated into the chebychev scheme .",
    "this is the subject of a further study .",
    "we would like to thank jos palao for stimulating discussions .",
    "financial support from the deutsche forschungsgemeinschaft within the emmy - noether grant ko 2302/1 - 1 ( cpk ) and within sfb 450 ( mn , rk ) is gratefully acknowledged .",
    "the fritz haber center is supported by the minerva gesellschaft fr die forschung gmbh mnchen , germany .",
    "when the solution of the inhomogeneous schrdinger equation is based on the uniform approximation , a transformation linking the chebychev expansion coefficients , @xmath23 , to the coefficients of the taylor expansion , @xmath99 , cf .",
    "( [ eq : taylor ] ) , is required . in other words ,",
    "given a vector @xmath153^t$ ] we want to compute the vector @xmath154^t$ ] such that @xmath155 i.e. we identify @xmath156 and @xmath99 to @xmath157 and @xmath158 respectively .",
    "let @xmath159 since chebychev polynomials obey the recursion relation , @xmath160 we obtain @xmath161 or @xmath162 hence , the @xmath163 coefficients satisfy @xmath164 based on this result we can compute the @xmath165 coefficients recursively , @xmath166 for @xmath167 with @xmath168",
    "it is shown by induction that the formal solution , eq .",
    "( [ eq : formalsol ] ) , and eq .  ( [ eq : formalsolbis ] ) are equivalent . writing eqs .",
    "( [ eq : formalsol ] ) and ( [ eq : formalsolbis ] ) for @xmath169 , one obviously obtains in both cases the equation of the first order , eq .",
    "( [ eq : firstorder ] ) .",
    "we assume that eqs .",
    "( [ eq : formalsol ] ) and ( [ eq : formalsolbis ] ) are equivalent in order @xmath37 ,",
    "i.e ,    @xmath170    let us now prove that they are equivalent in order @xmath30 .",
    "@xmath171 we continue by showing that @xmath172 , @xmath173 equation ( [ eq : proofm ] ) thus becomes @xmath174 making use of our assumption , eq .",
    "( [ eq : proofm-1 ] ) , we obtain @xmath175 this concludes the proof .",
    "the symmetrical method of ref .",
    "@xcite is based on the formal integration of the inhomogeneous time - dependent schrdinger equation , eq .",
    "( [ eq : inhse ] ) , @xmath176 assuming @xmath177 to be constant in @xmath17 $ ] and taking its value to be @xmath178 \\ , , \\label{eq : phiconst}\\ ] ] the integral in eq .",
    "( [ eq : formalsolsymm ] ) can easily be computed and we obtain @xmath179 this solution is formally equivalent to the first order of the chebychev propagator , cf . eq  ( [ eq : firstorder ] )",
    ". however , the evaluation of @xmath41 proceeds differently in the symmetrical method and the first order chebychev propagator .",
    "the latter subjects eq .",
    "( [ eq : formalsolsymmbis ] ) to a spectral approximation .",
    "it only requires a representation of the hamiltonian such that its action on a state vector can be evaluated .",
    "a numerically very efficient representation is based on the fourier grid where evaluation of @xmath180 scales as @xmath181 with @xmath44 the number of grid points .",
    "the symmetrical method diagonalizes @xmath182 at each time step in order to directly employ eq .",
    "( [ eq : formalsolsymmbis ] ) .",
    "since diagonalization scales as @xmath183 , where @xmath44 is the dimension of the hilbert space , this is feasible only for sufficiently small @xmath44 ."
  ],
  "abstract_text": [
    "<S> a propagation scheme for time - dependent inhomogeneous schrdinger equations is presented . </S>",
    "<S> such equations occur in time dependent optimal control theory and in reactive scattering . </S>",
    "<S> a formal solution based on a polynomial expansion of the inhomogeneous term is derived . </S>",
    "<S> it is subjected to an approximation in terms of chebychev polynomials . </S>",
    "<S> different variants for the inhomogeneous propagator are demonstrated and applied to two examples from optimal control theory . convergence behavior and numerical efficiency </S>",
    "<S> are analyzed . </S>"
  ]
}