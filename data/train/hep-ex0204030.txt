{
  "article_text": [
    "a time of flight ( tof ) detector@xcite system using plastic scintillation counters is very powerful for particle identification ( pid ) in @xmath1 collider detectors  @xcite .",
    "a tof system with @xmath2 time resolution is effective for particle momenta below about @xmath3 , which encompasses 90% of the particles produced in @xmath4 decays",
    ". it can provide clean and efficient flavor tagging for cp violation studies in b meson decays in a b - factory experiment .",
    "a reliable monte carlo ( mc ) simulator is a good tool to understand the detector system and is important for minimizing experimental systematic uncertainties for physics analysis .",
    "although one simple simulation method is a parametrization based on real data , it does nt provide precise simulation for complex experimental situations , such as multi - track hits , hadronic interactions in the tof counter , and shower leakage from the calorimeter outside of the tof system .",
    "we have developed a full detector simulator for the tof system . based on geant3  @xcite ,",
    "it includes the simulation of all physics processes involving scintillation light production and its propagation in the tof counters , the production of signal pulses in the photomultiplier tubes ( pmt ) , the electronics process in the discriminator and the charge to time converter ( qtc ) , and the effects of beam background .    in this report",
    ", we describe the belle tof detector simulation . in section  [ sec : tof ] , we briefly introduce the belle tof system . in section  [ sec : simulation ] we describe the simulation model and the main algorithm for each process . finally , we compare the simulation results with experimental data in section  [ sec : result ] .",
    "section  [ sec : conclusion ] contains conclusions .",
    "the belle detector is a large solid - angle spectrometer based on a @xmath5 superconducting solenoid magnet ; a detailed description can be found elsewhere  @xcite . figure  [ fig : belle ] shows the belle detector .",
    "the tof system consists of 64 tof / tsc modules located at a radius of @xmath6 from the interaction point , which cover a polar angle of @xmath7 .",
    "the design of one tof module is shown in figure  [ fig : tof_counter ] .",
    "a module consists of two tof counters of @xmath8 thickness , viewed at both ends by pmts , and one @xmath9 thick tsc counter , viewed only at the backward ( i.e. large angle ) end .    in order to get sufficient gain in a @xmath5 field , a fine mesh photomultiplier ( fm - pmt )  @xcite",
    "this tube has 24 fine mesh dynodes of @xmath10 , and its size is @xmath11 in length and 5.08 cm in diameter .",
    "its bialkali photocathode covers 50% of the end area of each tof counter .",
    "the pmt gain is adjusted to be about @xmath12 , which requires a high voltage of about @xmath13 in the @xmath5 field .",
    "the fm - pmts are attached to the tof counter ends with an air gap of @xmath14 that selectively passes early arrival photons and reduces the pmt anode current . for the tsc counters ,",
    "the tubes are glued to light guides that are attached to the sintillator .",
    "table  [ tb : tofpmt ] lists the characteristic parameters of the tof scintillator and the fm - pmt used in this simulation .",
    "figure  [ fig : toffee ] shows a block diagram of the tof front end electronics ( toffee ) .",
    "each pmt signal is split in two .",
    "one half is sent to a charge - to - time - converter ( qtc ) for charge measurement .",
    "the other half goes to generate two output signals by application of different threshold levels .",
    "the high level ( hl ) signal is used to provide a gate to the qtc , and the low level ( ll ) signal is fed to a time stretcher ( ts ) for time measurement .",
    "figure  [ fig : outline ] shows the outline of the belle tof simulation program .",
    "it consists of the geant part , the main tof simulation part including the scintillator , the pmt and discriminator processes , and the beam background merge .",
    "geant provides the hit information for a particle passing through the scintillator , including the four vector , hit position , time , and energy loss .    using the hit information from geant",
    ", scintillation light is produced .",
    "the light is then propagated in the tof scintillator until it arrives at a pmt and makes a signal pulse .",
    "finally , a pulse larger than the hl threshold makes a gate to measure the charge and timing of the signal .",
    "the main detector characteristics , such as the time resolution , are simulated in this part .    in order to take into account the effect of beam background ,",
    "real data taken with random triggers , which represent the beam background , are merged into the mc output .",
    "the inefficiency due to the dead time of the qtc is simulated here .",
    "the geometrical and material configuration of the belle detector is implemented in the belle geant full simulator  @xcite .",
    "not only all sub - detector components , but also materials for the support , cooling structures , and readout cables are included .",
    "these allow realistic simulation of a primary particle that goes through the inner sub - detector ( and materials ) up to the tof scintillator and of secondary particles that are produced in the inner and outer materials .",
    "the material of the tof / tsc scintillator is defined as a mixture of hydrogen and carbon .",
    "the atomic ratio is assumed to be 1:1 .",
    "the density of this material is 1.032 .",
    "the geant hit information for a particle traversing the scintillator volume is recorded at discrete steps along the particle trajectory . for a particle with a given energy , the step size is automatically calculated by geant depending on particle species and on the characteristics of the current medium  @xcite .",
    "figure  [ fig : step ] shows the time at the first step and energy loss distributions for @xmath15 @xmath16 which enter perpendicular to the tof counter .      using the step information from geant , we reconstruct a continuous path connecting each step in the scintillator volume .",
    "scintillation light is uniformly emitted along this path .",
    "the time @xmath17 on this path for each light emission event is calculated by using the four vector of the particle .",
    "the number of photons is proportional to the energy loss of the particle , at a rate assumed to be one photon per @xmath18 @xcite .",
    "the angular distribution of the emitted light is isotropic .",
    "the time profile of scintillation emission is simulated by using the emission time ( @xmath19 ) probability function  @xcite ,    @xmath20    where @xmath21 and @xmath22 are two fast decay time constants , @xmath23 is the decay time of the slow component , and r is the ratio of the slow to fast components . since the signal timing is determined at the leading edge in the discriminator , @xmath21 and @xmath22 are the most important parameters for tof simulation .",
    "we use @xmath24 and @xmath25 ; these values are chosen so that this function has the same rise time as the bc408 scintillator light output .",
    "the values @xmath26 and @xmath27 are given in reference  @xcite .",
    "figure  [ fig : scintillation ] shows the @xmath28 distribution .",
    "the scintillation light is propagated by total internal reflection and arrives at the pmts located at the ends of the scintillator .",
    "we assume that light which has an emission angle within the trapping angle ( @xmath29 ) can traverse the air gap to reach the pmt , while the remaining light escapes from the scintillator volume without total reflection or is lost during the endless total reflection between the two ends of the tof scintillator ( see figure  [ fig : propagation]-(1 ) ) .",
    "the angle @xmath29 is given by @xmath30 where @xmath31 and @xmath32 are the refractive indices of the air and scintillator , respectively .    by assuming perfect internal reflection on each of the four surfaces of the tof counter , the light propagation length in the counter is calculated",
    "( see figure  [ fig : propagation]-(2 ) ) as @xmath33 where @xmath34 is the distance from the light emission position to the end surface of the scintillator and @xmath35 is the polar angle of the emitted light .",
    "this technique effectively reduces the cpu time , while the result is equivalent to a full simulation of light propagation .",
    "figure  [ fig : lightlength ] shows the path length distribution of light which is produced at @xmath36 and reaches the forward pmt .",
    "the light propagation time in the scintillator is obtained by @xmath37 where @xmath38 is the velocity of light in the scintillator .",
    "attenuation in the tof counter is simulated according to @xmath39 where @xmath40 is the attenuation length in the scintillator material .",
    "we use @xmath41 , which is measured with real data .",
    "the mismatch of the rectangular cross section of the tof counter to the round pmt results in light loss ( see figure  [ fig : propagation]-(3 ) ) . in the simulation ,",
    "the number of photons is reduced by the ratio of the tof end area to the effective area of the pmt photocathode .",
    "we consider the angular response ( @xmath42 ) of pmt sensitivity , which is a dependence on the angle of incident light on the photocathode  @xcite ,    @xmath43    where @xmath44 is the light incident angle at the pmt front glass .",
    "we find 0.66 for the efficiency averaged over all arrival directions at the pmt .",
    "the number of photons is reduced by this factor .    at the pmt photocathode , photoelectrons are produced with a probability which is called the quantum efficiency .",
    "the average quantum efficiency of the photocathode is calculated to be 0.21 for the spectrum from the bc408 scintillator .",
    "also , the number of photoelectrons is reduced by a factor of 0.6 , called the collection factor , due to the fine mesh dynode structure .",
    "we reduce the number of generated photoelectrons by these factors .",
    "the transit time of a single photoelectron signal in a fm - pmt , @xmath45 , is modeled by a transit time(tt ) of @xmath46 and a r.m.s .",
    "transit time spread ( tts ) of @xmath47 , which are measured for the r6680 fm - pmt . by adding the smeared transit time to the photon timing information described in the previous section , the pivot time of single photoelectron signal at the anode is obtained ,    @xmath48    figure  [ fig : time_and_pulse]-(1 ) shows the time distribution of the photoelectrons at the anode for a typical event , a @xmath15 @xmath16 incident on a tof counter at @xmath36 .    to simulate the time walk effect due to the leading edge discrimination scheme used for the belle tof , a time response function @xmath49 for a single photoelectron",
    "is introduced .",
    "using this response function , the pmt output signal is obtained by summing all the single photoelectron signals in the pmt for an event , @xmath50 where @xmath51 here @xmath52 is the gain of pmt , @xmath53 is the conversion factor for charge to voltage , and @xmath54 is the time constant .",
    "we use @xmath55 so that the rise time of this function is the same as that of an r6680 pmt , and @xmath56 time bin size which is the same as the least count of the belle tof readout system  @xcite .    figure  [ fig : time_and_pulse]-(2 ) shows a typical pmt output signal for the same event as shown in figure  [ fig : time_and_pulse]-(1 ) .",
    "the simulated signal is consistent with actual signals observed in the belle tof counters in both pulse height and rise time .",
    "each pmt signal is examined by readout electronics using double thresholds . a signal larger than the high level ( hl ) threshold provides a gate to measure the signal timing ( tdc ) which is given at the moment when the pmt pulse crosses the low level ( ll ) threshold in the discriminator simulation .",
    "we use the same ll threshold as the real experiment ( @xmath57 ) .",
    "a hl value 50% higher than that in the real experiment ( @xmath58 ) is used for fine tuning of the hit inefficiency , which is caused by pmt - to - pmt gain variation in the real experiment .",
    "finally , we introduce a timing uncertainty , parametrized by a gaussian with a width of @xmath59 , which is due to the uncertainty of the beam crossing time ( @xmath60 ) determination , the time jitter caused by electronic noise in the discriminators , and the time jitter in the ts readout .",
    "figure  [ fig : tdc]-(1 ) shows the tdc distribution for perpendicular incidence on a tof counter , and figure  [ fig : tdc]-(2 ) shows tdc values as a function of particle hit position ( @xmath61-hit ) along the counter .",
    "the @xmath61-hit value is obtained by extrapolating the particle s trajectory using tracking information from the central drift chamber ( cdc )  @xcite .",
    "the filled circles in figure  [ fig : tdc ] are data and the open circles are mc .",
    "there is good agreement .",
    "the charge output ( adc ) is given by the time integral of the @xmath62 divided by the impedance of the pmt circuit .",
    "the width of the simulated charge distribution is narrower than that of the real data .",
    "possible sources of the difference include statistical gain variations of the pmts  @xcite ( the simulation assumes a constant gain for a single photoelectron ) , gain variation among individual pmts , and the imperfection of the simplified model of light propagation . to better represent the data ,",
    "we adjust the charge distribution by introducing a scaled poisson distribution ,    @xmath63    where adc is the corrected charge , @xmath64 is the width scale parameter , @xmath65 is a random number given by a poisson distribution generator which has mean @xmath66 and @xmath67 is the original charge from the @xmath62 integration . in a comparison between @xmath67 and real data",
    ", we found that a value @xmath68 gives the best agreement .",
    "figure  [ fig : adc]-(1 ) shows the resulting charge distribution compared with the real data .",
    "figure  [ fig : adc]-(2 ) shows the mean adc value as a function of the @xmath61-hit position .",
    "all points are in good agreement . by fitting @xmath69 as a function of @xmath61-hit ( see figure  [ fig : adc]-(3 ) ) to a linear function , we obtain good agreement for the effective light attenuation length ( @xmath70 ) along the @xmath61 direction  @xcite .",
    "one of the main parameters in the tof calibration and reconstruction is a time walk correction coefficient that is used to remove a pulse height dependence  @xcite of the digitized time .",
    "it is the coefficient of a @xmath71 term , and is sensitive to the rise time of the pmt signal .",
    "figure  [ fig : twc ] shows the ( uncorrected ) tdc versus @xmath71 for data and mc . they are in good agreement .",
    "the effect of the beam background is simulated by merging beam background data into the mc signal output .",
    "the background data are taken by random triggers during the real experiment .",
    "the typical hit rate of a single tof pmt is @xmath72 . because of its greater scintillator width , the tsc counter hit rate is more than 2 times higher than the tof rate .",
    "the hit rates are expected to increase in the higher luminosity environment in the near future .",
    "figure  [ fig : addbg ] presents a flow chart of the beam background merging . for each pmt , mc and background",
    "are merged on an event - by - event basis .",
    "first , we consider the overlapping of two pmt signals . according to the algorithm in the readout electronics ,",
    "if two signals are closer than the adc gate width ( @xmath73 ) , we take only the earlier signal tdc and the charge of the later signal is added to the earlier one .",
    "otherwise , both signals are recorded . then the qtc dead time and the number of edges",
    "are taken into account .",
    "the major effect of the beam background is to increase the inefficiency caused by the qtc dead time , due to signal conversion and recovery times .",
    "it is simulated by discarding the later tdc signal in the case that the mc and beam background times are closer than the qtc dead time , which is found to be @xmath74 per adc count ( each adc count corresponds to a charge of @xmath75 . ) in real data .",
    "another source of inefficiency is the limit on the number of records in the tdc1877 system  @xcite .",
    "the limit is 8 edge records for each pmt in an event . because the ts system produces 4 edges for one pmt signal  @xcite , a maximum of 2 pmt signals can be recorded for an event . in our simulation , we count the number of edges for the individual tdc channels , and remove the signal(s ) after the 8th edge in the merged data .",
    "since we do nt use the ts for the tsc counters , this inefficiency is not present for them .",
    "figure  [ fig : tofineff ] shows the tof and tsc hit inefficiencies in @xmath76-pair events @xmath77 as a function of the tof trigger rate , which is defined as the rate for at least one tof - tsc coincidence among the 64 tsc counters .",
    "the tof pmt singles rate is about @xmath78 of this tof trigger rate , and the tsc singles rate is about two times the tof singles rate . here",
    "the hit inefficiency is defined as the fraction of muons predicted to hit a tof counter for which there is no associated counter signal . in the figure ,",
    "the solid circles are for data and the open circles are for mc with beam background .",
    "the hatched part indicates the inefficiency given by the original mc without beam background .",
    "this intrinsic inefficiency is due to the dead space between counters .",
    "the higher tsc inefficiency is due to the higher background rate .",
    "the hit inefficiencies for mc and data agree to within 0.3% .",
    "figure  [ fig : dt ] shows the @xmath79 distribution for all available tof hits in a @xmath76-pair event sample . here",
    "@xmath80 is the time of flight predicted using the track path length calculated from the fit to hits in the cdc , and @xmath81 is the weighted average of the observed times in the forward and backward pmts after correction for the @xmath61-hit position and time walk  @xcite .",
    "the distribution is fitted to a symmetric gaussian to determine the time resolution . the overall time resolution ( @xmath2 ) is well represented by the mc .",
    "figure  [ fig : resolution ] shows the time resolutions for forward and backward pmts and for the weighted average time as a function of @xmath61-hit .",
    "the pid from the belle tof system is based on a ratio of likelihoods for two particle hypotheses . for @xmath82 separation ,",
    "a particle is identified as a kaon using the likelihood ratio @xmath83 , where the @xmath84 are the pid likelihoods for the particle hypotheses in the subscripts .",
    "the pid performance is evaluated using the charm decay @xmath85 , followed by @xmath86 .",
    "figure  [ fig : kid ] shows the measured @xmath87 i d efficiency and @xmath88 fake rate as a function of momentum , where @xmath89 is required to identify a kaon .",
    "the mc reproduces the @xmath87 i d efficiency and fake rate as functions of momentum with maximum deviations of 0.7% and 1.8% , respectively .",
    "in this report we describe the full detector simulation for the belle tof system .",
    "we developed a geant - based simulator for the processes in the scintillator and the pmt , the readout electronics of the discriminator and the qtc , and the effect of beam background .",
    "scintillation light is produced using the hit information from geant . using simple models for light propagation in the tof scintillator and for the pmt response",
    ", we accurately reproduce the real pmt signals .",
    "the simulation represents the detector characteristics of the tof system such as light attenuation , the adc distribution , the effective light velocity , the tdc distributions and the time resolution . through a beam background merging process , the qtc dead time and the limit on the number of records in the tdc1877 system is simulated , so that the tof hit inefficiency dependence on the background rate is accurately modeled .",
    "since the dependence on pulse height and on @xmath61-hit is well reproduced , the simulation is a good tool for the investigation and development of calibration and reconstruction methods .",
    "the @xmath87 i d efficiency and its momentum dependence are in good agreement with the data .",
    "the tof simulation provides an important component of the belle mc used for physics analysis .",
    "we wish to thank the belle collaboration and kekb accelerator group . we acknowledge support from the ministry of education , culture , sports , science , and technology of japan and the japan society for the promotion of science ;",
    "the bk21 program of the ministry of education of korea and the center for high energy physics sponsored by the kosef ; and the u.s .",
    "department of energy .",
    "c c + base & polyvinyltoluene + density & 1.032 + refractive index & 1.58 + rise time & 0.9 ns + decay time & 2.1 ns + pulse width & @xmath90 2.5 ns + light attenuation length & @xmath90 300 cm + wavelength of maximum emission & 425 nm +     + effective photocathode diameter & 39 mm + transit time spread & 320 ps ( r.m.s ) + quantum efficiency & @xmath90 0.21 + electron collection factor & 0.6 + rise time & 3.5 ns + fall time & 4.5 ns + pulse width & 6 ns ( fwhm ) +"
  ],
  "abstract_text": [
    "<S> we have developed a detailed monte carlo simulation program for the belle tof system . based on geant simulation , it takes account of all physics processes in the tof scintillation counters and readout electronics . </S>",
    "<S> the simulation reproduces very well the performance of the belle tof system , including the @xmath0 response , the time walk effect , the time resolution , and the hit efficiency due to beam background . in this report </S>",
    "<S> , we will describe the belle tof simulation program in detail .    </S>",
    "<S> detector simulation , time of flight 07.05.tp , 29.40.mc </S>"
  ]
}