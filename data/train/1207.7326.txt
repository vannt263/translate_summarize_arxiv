{
  "article_text": [
    "the sloan digital sky survey iii ( sdss - iii , @xcite ) is the third phase of the sdss @xcite . within the sdss - iii ,",
    "the baryon oscillation spectroscopic survey ( boss , @xcite ) is currently mapping a larger volume of the universe than any previous spectroscopic survey .",
    "the ninth data release of the sdss - iii ( dr9 , @xcite , released publicly on 2012 july 31 ) is the first sdss - iii data release to include boss spectroscopic data , and comprises good observations of 831 unique plate - pluggings of 813 unique tilings ( plates worth of targets ) on the sky .",
    "each plate delivers simultaneous spectroscopic observations of 1000 lines of sight with optical fibers that feed a pair of two - arm spectrographs , giving a total of 831,000 boss dr9 spectra .",
    "the main science goal of boss is to trace the large - scale mass structure of the universe using massive galaxies and quasar ly@xmath3 absorption systems , in order to measure the length scale of the `` baryon acoustic oscillation '' feature in the spatial correlation function of these objects ( e.g. , * ? ? ?",
    "* ) , and thereby to constrain the nature of the dark energy that drives the accelerated expansion of the present - day universe . to meet this goal , the boss project has specified a series of scientific requirements , including : ( 1 ) an rms galaxy redshift precision better than 300 kms@xmath2 ; ( 2 ) a galaxy redshift success rate of at least 94% , including both targeting inefficiency and spectroscopic redshift failure ; ( 3 ) a catastrophic galaxy redshift error rate of less than 1% ; and ( 4 ) spectroscopic confirmation of at least 15 quasars at @xmath4 per degree@xmath5 from among no more than 40 targets per degree@xmath5 . to satisfy these requirements within such a large survey , automated spectroscopic calibration , extraction , classification , and redshift measurement methods are essential .",
    "this paper , one of a series of technical papers describing sdss - iii dr9 in general and the boss data set in particular , presents the automated classification and redshift measurement software for the main galaxy and quasar target samples implemented for the boss project .",
    "this software is written in the idl language , and is titled ` idlspec2d ` .",
    "earlier versions of this code were used to analyze sdss - i / ii data ( see @xcite ) , alongside the complementary and independently developed pipeline software ` spectro1d ` ( see @xcite and @xcite ) ; for the boss project , the ` idlspec2d ` software has been adopted as the primary code , due to its robust error estimation methods and its tight integration of redshift measurement and classification with the lower - level operations of raw data calibration and extraction .",
    "the code has also been upgraded with new redshift - measurement templates and several new algorithms in order to meet the scientific requirements of the boss project .",
    "the tagged software version ` v5_4_45 ` was used to process all boss spectroscopic data for dr9 , and the classification and redshift results delivered by this code have been used for recently published boss dr9-sample cosmological analyses @xcite .",
    "an overview of the boss project , including experimental design , scientific goals , observational operations , and ancillary programs , is given in @xcite .",
    "a description of the ` idlspec2d ` calibration and extraction methods which transform raw ccd pixel data into one - dimensional object spectra will be presented in @xcite .",
    "the organization of this paper is as follows .",
    "section  [ sec : data ] presents an overview of the spectroscopic data sample of boss dr9 .",
    "section  [ sec : pipeline ] describes the classification and redshift pipeline algorithms and procedures , including the core redshifting algorithm (  [ subsec : zmeasure ] ) , special classification handling for the galaxy target samples (  [ subsec : z_noqso ] ) , measured spectroscopic parameters (  [ subsec : params ] ) , and output files (  [ subsec : outfiles ] ) .",
    "section  [ sec : templates ] describes the templates constructed for the automated spectroscopic identification and redshift analysis of boss galaxies (  [ subsec : galtemp ] ) , quasars (  [ subsec : qsotemp ] ) , and stars (  [ subsec : startemp ] ) .",
    "section  [ sec : performance ] analyzes the completeness , purity , accuracy , and precision of the samples classified and measured by the ` idlspec2d ` pipeline .",
    "section  [ sec : issues ] documents known issues in the dr9 release of boss data , and  [ sec : summary ] provides a summary and conclusions .",
    "the main boss survey program consists of two galaxy target samples @xcite and a quasar target sample including both color - selected candidates and known quasars @xcite .",
    "the galaxy samples are designated cmass ( for `` constant mass '' ) and lowz ( for `` low - redshift '' )",
    ". the lowz galaxy sample is composed of massive red galaxies spanning the redshift range @xmath6 .",
    "the cmass galaxy sample is composed of massive galaxies spanning the redshift range @xmath7 .",
    "both samples are color - selected to provide near - uniform sampling over the combined volume .",
    "the faintest galaxies are at @xmath8 for lowz and @xmath9 for cmass .",
    "colors and magnitudes for the galaxy selection cuts are corrected for galactic extinction using @xcite dust maps .",
    "the boss quasar sample is selected to recover as many objects as possible in the redshift range @xmath4 for the purposes of measuring the 3d structure in the ly@xmath3 forest .",
    "a variety of selection algorithms are employed to select the quasar sample , which lies close to the color locus of f stars .",
    "the faint - end magnitude limits of the quasar target sample are extinction - corrected psf magnitudes of @xmath10 and @xmath11 .",
    "a summary of the dr9 boss spectroscopic data set ( observed between 2009 december and 2011 july ) is given in table  [ table : dr9summary ] , along with performance metrics that will be discussed in detail further below .",
    "representative boss survey spectra are shown in figure  [ fig : mosaic ] .",
    "the automated classification and measurement software described here is applied to all spectra obtained by the boss spectrographs @xcite , including spectra targeted under ancillary programs described in @xcite . in this work",
    "we focus on the analysis of the main boss galaxy and quasar survey targets , since the performance on these samples is the primary scientific driver of the design , development , and verification of the pipeline .",
    ".[table : dr9summary ] boss dr9 summary spectrum totals [ cols=\"<,>\",options=\"header \" , ]     approximately 8% of boss spectra are repeat observations of previously observed targets , due both to re - observations of entire plates and to re - targeting of a number of objects on more than one plate ( see @xcite ) . of particular note within the summary files , the best spectroscopic observation of each object ( defined by a 2@xmath12 positional match ) in the survey",
    "is defined according to the following rules :    1",
    ".   prefer spectra with positive median s / n per spectroscopic pixel within the @xmath13-band wavelength range over other observations .",
    "2 .   prefer spectra with ` zwarning `  @xmath14 over other spectra ( or ` zwarning_noqso `  @xmath14 for galaxy - sample targets . )",
    "3 .   prefer spectra with higher median s / n per spectroscopic pixel within the @xmath13-band wavelength range .",
    "the best observation for each object is designated by setting the parameter ` specprimary ` equal to 1 in the ` spall ` file , while setting it equal to zero for all other spectroscopic observations of a given object that may be present within the survey data set .",
    "in order to compare and select among galaxy , quasar , and stellar models objectively and with the highest statistical significance , the boss pipeline requires redshift and classification measurement templates that span both the full space of physical object types within the survey and the full wavelength range of the spectrograph .",
    "boss expands on sdss - i / ii in both regards , and hence requires a new set of pipeline templates , which we now describe .",
    "the ` idlspec2d ` galaxy redshifts for sdss - i / ii were measured using templates generated from 480 galaxies observed on sdss plate 306 , mjd 51690 .",
    "redshifts for this training set were established by modeling each spectrum across a range of trial redshifts as a linear combination of ( 1 ) the leading two components of a pca analysis of 10 velocity - standard stars in m67 observed by sdss - i plate 321 on mjd 51612 , ( 2 ) a set of common optical emission lines modeled as narrow gaussian profiles , and ( 3 ) a low - order polynomial .",
    "the adopted redshift for each galaxy was taken from the location of the minimum-@xmath15 value localized to sub - grid accuracy , in the same manner described in  [ subsec : zmeasure ] above . using these redshifts ,",
    "the training - sample spectra were transformed to a common rest - frame baseline , and input to an iterative pca procedure that accounts for measurement errors and missing data ( e.g. , @xcite and references therein ) .",
    "the leading four `` eigenspectra '' from this procedure were taken to define the galaxy redshift template basis for sdss - i / ii .",
    "for the commissioning analysis of boss spectra , these same templates were used for measuring galaxy redshifts , despite their lack of @xmath16 coverage redward of 9300  and their under - representation of post - starburst galaxies ( which appear with more frequency in the boss cmass sample than in sdss - i / ii ) .    to generate a new redshift template set for use in automated analysis of boss spectra , we select a set of boss galaxies with redshifts over the interval @xmath17 that are well - measured by the original sdss templates . to increase s / n and flatten the coverage of galaxy parameter space before performing a pca to generate the template set",
    ", we bin together galaxies with similar 4000break strengths ( @xmath18 , @xcite ) and redshifts , for the purposes of stacking their spectra .",
    "we use a @xmath18 range from 1.0 to 2.2 with a binning interval of 0.2 , and a redshift binning interval of 0.05 . in some @xmath18redshift bins",
    ", we further subdivide the galaxies into several h@xmath19 sub - bins .",
    "the number of sub - bins depends on the number of galaxies in each @xmath18redshift bin : if the total number is smaller than 600 , we do not divide further into h@xmath19 sub - bins ; if the number is in the range 6001200 , we divide into two sub - bins ; and if there are greater than 1200 , we divide into three sub - bins .",
    "we also select a set of `` post - starburst '' galaxies from the boss galaxy sample , defined by having either @xmath20 or @xmath21.\\ ] ] this criterion leads to a sample of about 2400 post - starburst galaxies , which we divide into five bins in redshift with equal numbers of galaxies per bin .",
    "we then stack the rest - frame spectra of all galaxies in each bin , to generate a set of high - s / n stacked spectra across the range of parameters indicated .",
    "once all these stacked spectra are in hand , we fit stellar continuum models to them @xcite using simple stellar population ( ssp ) models .",
    "our ssp models are taken from @xcite and @xcite , and are based on a combination of theoretical and observational stellar library data from @xcite , @xcite , and @xcite . in the rest - frame wavelength range 19009900 , we patch the stacked spectra with the fitted continuum models for pixels with s / n smaller than 10 , pixels where the difference between models and stacks is larger than 30% , and pixels where there are no observations .",
    "we also add h@xmath3 , [ nii ] , and [ sii ] emission lines for cases where these lines fall outside the range of observed wavelengths used to generate the stacked spectra .",
    "this is accomplished by selecting galaxies with similar @xmath18 , h@xmath19 , and dust extinction as the galaxies used to make the stacks , and computing the median values of @xmath22 , @xmath23 , @xmath24}/\\sigma_{\\rm [ o\\textsc{iii}]}$ ] , @xmath25}/f_{\\rm [ o\\textsc{iii}]}$ ] , @xmath26}/\\sigma_{\\rm [ o\\textsc{iii}]}$ ] , and @xmath27}/f_{\\rm [ o\\textsc{iii}]}$ ] for these comparison samples ( here , @xmath28 is gaussian line dispersion and @xmath29 is line flux ) . by multiplying these ratios with the appropriate line width or flux of h@xmath30 or [ oiii ] from the stacks",
    ", we predict the line widths and fluxes for h@xmath3 , [ nii ] and [ sii ] to be added to the stacked spectra , which we do using a gaussian model for each line .    at the end of this process , we have 160 stacked and patched spectra .",
    "we augment these data with a sample of 28 type - ii quasars ( e.g. , @xcite ) identified within the boss spectroscopic data set ( see the discussion in  [ sec : issues ] ) .",
    "this full set of spectra is then used as input to the rest - frame spectrum pca algorithm to generate the four - component boss galaxy redshift template basis , which is shown in the top panel of figure  [ fig : templates ] .",
    "quasar redshift templates are generated from a training sample of targets selected from the sdss dr5 quasar catalog @xcite and targeted for re - observation with the boss spectrographs .",
    "the targets were chosen from the catalog at random , while enforcing as uniform a distribution as possible in redshift . as of 2011 june 10 ,",
    "571 objects from this sample had been observed by boss .",
    "removal of three spectra for localized cosmetic defects gives a training sample of 568 boss quasars .",
    "the distribution in redshift of the targeted sample and the observed sample is shown in figure  [ fig : qsohist ] .",
    "the observed sample is weighted more heavily above redshift @xmath31 , in accordance with overlapping boss quasar sample priorities .",
    "we keep this weighting in the training set , since we want our redshifting performance to be particularly well tuned for the redshift range of interest to the boss ly@xmath3 forest program .    using the redshifts given by @xcite",
    ", we shift these training spectra to their rest frames and perform a pca of the sample , with iterative replacement to fill in missing data .",
    "the top four principal components are retained and used as the linear basis set for our automated redshift and classification measurements , and are shown in the middle panel of figure  [ fig : templates ] .",
    "we do not employ the redshift estimates of @xcite for the quasar - template training sample because the current boss pipeline is not configured to incorporate the absolute - magnitude information that would be necessary to take advantage of the increased precision afforded by these redshifts .",
    "future boss pipeline versions may incorporate the @xcite approach .",
    "we note that the primary criterion for boss spectroscopic pipeline performance on quasar targets is to minimize catastrophic redshift failures .",
    "several detailed approaches to maximizing quasar redshift precision are being investigated within the boss quasar science working group , but all of these rely on having essentially correct initial quasar redshifts from the ` idlspec2d ` pipeline and/or visual inspection procedures @xcite .",
    "although stellar science is not a primary goal of boss , the redshift pipeline must successfully flag stars from within the galaxy and quasar target samples of the survey .",
    "there is currently no comprehensive library of observed stellar spectra covering the full usable wavelength range of the boss spectrograph and the full h - r diagram . to assemble a set of stellar templates suitable to boss spectrum classification",
    ", we use a hybrid approach that extends data from the indo - us observational stellar spectrum library @xcite , selected to provide uniform coverage of the space of stellar atmosphere parameters @xmath32 , @xmath33 , and [ fe / h ] ) using theoretical atmosphere models computed using the marcs ( * ? ? ?",
    "* for cool stars ) , atlas ( * ? ? ?",
    "* for intermediate stars ) , and cmfgen ( * ? ? ?",
    "* for hot stars ) codes , obtained via the curated pollux spectrum database @xcite .",
    "we start with the full database of 1273 indo - us stellar spectra , which have a resolution of approximately 1 , a reduced pixel scale of 0.4 , spectral coverage over 3400@xmath349500 , and good flux calibration for most stellar types .",
    "the original radial - velocity zeropoints for the library were established either from literature or from velocity - standard cross - correlations . since classification is the primary function of these spectra within the boss pipeline , we do not attempt any further refinement of these velocity zeropoints .",
    "we initialize a `` bad pixel '' mask for each indo - us spectrum based upon the zero - value indo - us pixel mask convention .",
    "furthermore , we define the following telluric absorption bands , and mask all pixels within them : 68506950 , 71507350 , 75607720 , 81058240 , @xmath358900 .",
    "we then select the subset of spectra that meet the conditions of ( 1 ) wavelength coverage from at least 3500  to 8900 , ( 2 ) good data over at least 75% of their pixels , ( 3 ) flux calibration with a non - flat ( i.e. , stellar ) standard , and ( 4 ) no single gap within the spectrum larger than 200  ( the largest adopted telluric band width ) .",
    "these cuts result in a sample of 879 spectra covering spectral types from o6 to m8 , but exclude carbon stars ( which are fluxed with a flat sed in the indo - us library ) .",
    "we then take the 1040 model atmosphere spectra from the pollux database ranging in temperature from 3000k to 49000k , convolved and binned to the resolution and sampling of the indo - us spectra . for each indo - us",
    "spectrum in our subset , we loop over all model atmospheres and determine the multiplicative scaling of the model that minimizes the sum of squared data - minus - model residuals over non - masked pixels . we adopt the model spectrum that gives the overall minimum sum of squared residuals as being the `` best fit '' for a particular data spectrum .",
    "the `` best fit '' model spectrum for each data spectrum is used to extend the data wavelength coverage and interpolate over the data gaps as follows .",
    "we define a running window of @xmath36 pixels ( @xmath37 ) about an output pixel of interest , and determine the multiplicative scale and tilt to apply to the model over that window in order to give the best ( least squares ) fit to the non - masked data pixels over that same range .",
    "the scaled and tilted model is evaluated at the central pixel to define the new , locally scaled model spectrum , and the process is repeated over the entire spectrum by sliding the window .",
    "for pixels centered outside the outermost pixel of data coverage on the red and blue ends , the scale and tilt at the outermost data - covered pixel are used .",
    "the data and `` sliding - scaled '' model spectra are combined into a single output spectrum by assigning 100% model in pixels where the data have no coverage , defining a 100-pixel ( 40 ) transition region on either side of data gaps where the output spectrum is a weighted combination of the data and the sliding - scaled model , and varying the weight linearly from 0% model @xmath38 100% data to 100% model @xmath38 0% data over the transition region .",
    "finally , we convolve and bin these output spectra down to the typical resolution ( about 3  fwhm ) and reduced - spectrum sampling ( @xmath39 per pixel ) of the boss data , also transforming from air to vacuum wavelengths to match the boss spectrum convention .      from these",
    "879 patched and extended stellar spectra , our goal is to select a representative subset of `` archetypes '' that provide sufficient coverage of stellar parameter space to perform automated spectroscopic star ",
    "galaxy and star  quasar separation , while not attempting overly detailed stellar analysis that is beyond the scope of the boss science mission ( cf .",
    "@xcite ) .",
    "we first visually inspect the template database and remove a single spectrum with noticeable data quality issues in an unmasked data region ( indo - us id#33111 , 5450  @xmath40 6000 ) .",
    "we also select the 12 template spectra that have significant emission lines , and retain each of them for our final archetype set .",
    "this leaves 866 spectra from which to select the remainder of our archetype sample .    to select a subset of archetypes from the remaining set of templates , we wish to make use of a measure of the degree of similarity or difference between any two spectra .",
    "we first restrict our attention to the wavelength range 340011000 , corresponding to @xmath41 pixels at the processed 69kms@xmath2 boss spectrum pixel scale .",
    "we then re - normalize all the template spectra to satisfy @xmath42 where @xmath43 is the flux density ( in the @xmath44 sense ) in pixel @xmath45 .",
    "we define a statistic @xmath46 measuring the quality of spectrum @xmath47 , scaled by a factor @xmath48 , as a model for spectrum @xmath29 : @xmath49 with our normalization convention , the best - fit ( minimum-@xmath46 ) scaling is simply given by @xmath50 and the value of @xmath46 at this best scaling is given by @xmath51 note that @xmath52 and @xmath53 are symmetric under the interchange of @xmath29 and @xmath47 : the amplitude and fit quality of one template to another does not depend upon which one is taken as the `` data '' and which one as the `` model '' . thus @xmath53 can be regarded as a measure of how different two templates are from one another .",
    "we compute the matrix of @xmath53 between all pairs of templates in our set , and determine our archetype list in an iterative procedure .",
    "we set a threshold of 7.5 for the maximum @xmath53 allowable between two spectra in order for one spectrum to be an acceptable representative for the other .",
    "this threshold was selected heuristically to tune the size and diversity of the final sample .",
    "we then identify the single template spectrum within the sample that has the most @xmath54 matches to the rest of the sample .",
    "this spectrum and all the spectra that it matches are removed from further consideration , and the process is iterated until all spectra have been accounted for in this manner . for our chosen threshold ,",
    "this process identifies 105 archetypes out of 866 analyzed templates .",
    "when added to the 12 emission - line templates , this yields a set of 117 stellar templates for our automated spectrum classification algorithm .",
    "spectra fit by these templates are tagged with the stellar subclass listed in the indo - us database , along with the library identification number of the archetype spectrum .",
    "several subclasses of star appear with some frequency in the boss target sample , but are not represented in the ( flux - calibrated ) indo - us library .",
    "for these subclasses , representative training samples from within the boss data set are identified based upon classification using sdss - i / ii stellar templates .",
    "new templates are derived by averaging the spectra of these training sets within a pca framework .",
    "the six subclasses and the number of training spectra for each of them are : ( 1 ) 47 carbon stars ; ( 2 ) 50 `` hotter '' white dwarfs with @xmath55 ; ( 3 ) 50 `` cooler '' white dwarfs with @xmath56 ; ( 4 ) 19 calcium white dwarfs ; ( 5 ) 31 magnetic white dwarfs ; and ( 6 ) 50 l dwarfs .",
    "in addition , a sample of 18 cataclysmic variable stars ( cvs ) with prominent emission lines is used to define a cv star eigenbasis of 3 pca modes , which is shown in the bottom panel of figure  [ fig : templates ] . because of the use of multiple eigenvectors rather than a single average spectrum , cv stars are treated as an object class separate from other stars in the automated classification analysis .",
    "table  [ table : dr9summary ] provides a summary of the boss dr9 spectroscopic data set analyzed by the redshift and classification pipeline described in this work , along with a number of summary performance statistics that we now examine .",
    "additional checks on the ` idlspec2d ` pipeline performance for galaxy targets in comparison with the ` zcode ` cross - correlation redshift software described by @xcite are presented in @xcite , and additional discussion of pipeline quasar classification and redshift performance is found in @xcite .",
    "the boss dr9 sample contains 831,000 spectra . of these",
    ", about 0.2% are lost to unplugged fibers and spectra falling along bad ccd columns .",
    "approximately 92% of the boss dr9 spectra are of unique objects ( as defined by a 2@xmath12 positional match ) .",
    "the remaining 8% are repeat spectra from overlapping plates or repeat observations of the same plate .      using the ` z_noqso ` redshift measurement convention as described in  [ subsec : z_noqso ]",
    ", we achieve an automated completeness ( i.e. , ` zwarning_noqso = = 0 ` rate ) of 98.7% for the cmass sample and 99.9% for the lowz sample ( from table  [ table : dr9summary ] ) .",
    "restricting further to objects that are spectroscopically classified as galaxies ( ` class_noqso = = galaxy ` ) , we find combined targeting and measurement completeness percentages of 95.4% for cmass and 99.2% for lowz .",
    "these percentages satisfy the boss science requirement of at least 94% overall galaxy redshift success . for the cmass sample , about 70% of the ( small ) survey inefficiency is due to targeting stars and star ",
    "galaxy superpositions rather than galaxies , and about 30% arises from known redshift measurement failures .    to verify the completeness and quantify the purity of the automated galaxy redshifting and classification , we make use of a `` truth table '' generated by the first author from the visual inspection of 4864 galaxy spectra taken on eight plates observed during 2010 march .",
    "we focus primarily on the cmass sample , as this higher - redshift ( and thus lower s / n ) sample poses the greatest challenge to the software . of the inspected spectra ,",
    "3666 are cmass targets that are above the fiber - magnitude threshold , not unplugged , and not falling on bad ccd columns . from among these 3666 galaxy - sample spectra , 3627 have confidently measured pipeline redshifts and classifications , giving an automated completeness of 98.9% , consistent with the completeness of the full dr9 cmass sample from above . of this subset ,",
    "3500 are classified as galaxies ( as opposed to stars ) by the pipeline , giving a 95.5% overall sample completeness including target - selection efficiency , which is also consistent with the sample - wide value .    to quantify the purity of the cmass spectroscopic redshift sample ,",
    "we first search for `` catastrophic '' impurities in the cmass redshift sample , defined as spectra for which the pipeline reports a confident galaxy classification and redshift , but for which the visual inspection yields a confident classification ( of any class ) with a redshift that differs by greater than @xmath57 .",
    "this search yields three such spectra out of 3500 : two are definite galaxy  m - star superpositions , and the other is a possible galaxy - galaxy superposition ( for which the pipeline redshift is more convincing in retrospect than the inspection redshift ) .",
    "we next check for less clearly defined impurities , defined as spectra for which the pipeline reports a confident galaxy classification and redshift , but for which the visual inspection does not yield a confident result .",
    "this search identifies 10 such spectra , six of which are plausible pipeline redshifts with subjective visual judgments of low s / n , and the remaining four of which are due to artifacts associated with spectrum combination across the spectrograph dichroic at 6000(see item  [ item : crosstalk ] in  [ sec : issues ] ) . taking the three superposition spectra and the four artifact spectra as genuine contaminants",
    ", we find a cmass sample impurity rate of about 0.2% , satisfying the 1% maximum catastrophic redshift failure rate specified as the scientific requirement for boss .",
    "to check for the possibility of recoverable incompleteness , we examine cmass spectra for which the visual inspections yield a confident galaxy classification and redshift , but for which the automated pipeline yields either no confident result ( i.e. , ` zwarning_noqso > 0 ` ) , or a classification as a star .",
    "there are 26 such spectra , which break down as follows : 11 low - s / n spectra for which the pipeline s lack of confidence is statistically defensible ; 5 definite or possible galaxy  galaxy superpositions ; 4 definite or possible star  galaxy superpositions ; 3 spectra with artifacts ; 2 broadline agn mistaken for stars ( but with correct quasar - class redshifts that are excluded by the ` z_noqso ` convention ) ; and 1 narrow - line agn for which the pipeline confuses [ oiii ] 5007 and h@xmath3 . taking the 11 noisy but visually convincing redshifts and the three agn spectra to represent the recoverable sample",
    ", we find an excess incompleteness of about 0.4% relative to the maximum attainable given the data .    to further assess the effects of star ",
    "galaxy superpositions ( for which the pipeline takes no special approach ) , we search a set of 57910 cmass spectra from 150 plates for instances of a best - fit non - quasar class of galaxy and a next - best non - quasar class of star , and examine these spectra visually for the presence of significant stellar features . from this sample ,",
    "we find 103 possible and 58 probable star ",
    "galaxy superpositions , indicating a total cmass star  galaxy superposition rate of between 0.1% and 0.2% .",
    "these star ",
    "galaxy superpositions that are given a spectroscopic class of galaxy are a source of sample impurity , as the galaxies are typically neither bright enough nor of the correct color to fall within the cmass color ",
    "magnitude selection cuts on their own .",
    "galaxy superpositions classified as star by the pipeline are excluded from the large - scale structure analysis and contribute only to target - selection inefficiency .",
    "our visual inspection set also contains 568 lowz galaxies brighter than the fiber - magnitude threshold .",
    "all of these spectra are confidently classified and redshifted by both the pipeline and the visual inspection , with three classified as stars .",
    "this is consistent with the automated completeness and stellar contamination rate for the full lowz sample , with no detectable incidence of catastrophic failures .",
    "redshift errors are calculated from the curvature of the @xmath15 function in the vicinity of the minimum value that is used to determine the best - fit redshift measurement . to assess the accuracy of these statistical error estimates , we make use of a set of 27170 repeat observations of cmass targets and 7503 repeat observations of lowz targets within the dr9 data set .",
    "we reference all repeat observations to the ` specprimary ` observation of a given object , and scale the redshift difference between the two observations by the quadrature sum of the error estimates from the two epochs .",
    "we then construct a histogram of these scaled velocity differences and fit it with a gaussian function .",
    "if the estimated errors accounted for all the statistical uncertainty , these fitted gaussians would have a dispersion parameter of unity .",
    "figure  [ fig : z_err_hist ] shows the results of this analysis , with fitted dispersions of @xmath58 for the lowz sample and @xmath59 for the cmass sample .",
    "thus , while slightly underestimated , the redshift errors are impressively close to being statistically accurate . the greater scatter ( relative to the statistical error estimates ) for the lowz sample suggests that systematic effects become more important at higher s / n .",
    "this analysis of repeat spectra also yields 44 cmass re - observations that have absolute redshift differences @xmath60 between the two epochs .",
    "these are primarily due to galaxy  galaxy superpositions at distinct redshifts , un - masked spectrum artifacts , and a number of type ii quasars for which broad [ oiii ]  5007 emission is confused with h@xmath3 in one epoch but not the other ( see item  [ item : type2 ] in  [ sec : issues ] ) .",
    "the implied 0.16% cmass redshift impurity rate is consistent with the value found from the truth - table tests of  [ subsec : galcomp ] . for the lowz repeat observations , two spectra yield @xmath60 , both of which are galaxy  galaxy superpositions .    for all cmass and lowz targets",
    ", we also compute the distribution of estimated redshift errors as a function of redshift .",
    "these distributions are shown in figure  [ fig : v_err_hist ] .",
    "in all cases , typical errors are a few tens of kms@xmath2 even when scaled up to reflect the super - statistical scatter displayed in figure  [ fig : z_err_hist ] .",
    "these errors are well below the 300kms@xmath2 redshift precision requirement of the boss galaxy large - scale structure science analyses .      as in any redshift survey , spectroscopic s / n is the primary determinant of redshift success in boss . figure  [ fig : sdss_snr_zrate ] shows the dependence of the cmass galaxy redshift failure rate as a function of the median spectroscopic signal - to - noise ratio over the sdss @xmath13 , @xmath45 , and @xmath61 bandpass ranges , which represent the most relevant regions of the spectrum for measuring continuum redshifts of passive galaxies over the redshift interval @xmath620.8 .",
    "failure is defined in the sense of ` zwarning_noqso > 0 ` , so that targets confidently identified as stars are counted as a success for the pipeline even though they represent a failure in the larger sense of galaxy targeting and redshift measurement .",
    "we see a decrease in the failure rate as a function of @xmath13-band s / n up to s / n@xmath63 , where an asymptotic minimum of @xmath64 is reached",
    ". for cmass spectra with s / n@xmath65 , the typical value for both s / n@xmath66 and s / n@xmath67 is approximately 6 , consistent with the s / n values in those bands at which the asymptotic failure rate is reached in figure  [ fig : sdss_snr_zrate ] .    galaxy magnitude correlates strongly with spectroscopic s / n and hence with redshift success",
    ": this is the motivation for the formal cmass sample limit of @xmath45-band magnitude brighter than 21.5 within a 2@xmath68-diameter boss fiber . to gauge the dependence of redshift completeness on this limit",
    ", figure  [ fig : ifibrate ] shows the cmass sample redshift failure rate as a function of @xmath69 , selecting the best single observation of each target .",
    "targets fainter than @xmath70 are available from a more permissive cmass cut applied during commissioning observations . at the formal cmass cutoff ,",
    "the marginal failure rate is about 7% .",
    "the characteristics of the boss spectrograph optics and ccd detectors produce a weak dependence of redshift success rate on fiber identification number along the linear spectrograph slit - heads .",
    "figure  [ fig : fiberid ] presents this dependence for the cmass sample .",
    "this figure is generated only for targets brighter than the @xmath71 cut , but includes all survey spectra of each target ( i.e. , no ` specprimary ` cut ) so as to give an unbiased picture of performance versus fiber number .",
    "the upturns near fiber numbers 1 , 500 , and 1000 are associated with the edges of the spectrograph camera fields of view , and are described further in item  [ item : badfiber ] in  [ sec : issues ] below .",
    "the effects of isolated bad ccd columns are also evident , and are described in item  [ item : badcol ] in  [ sec : issues ] .",
    "the failure rate is slightly higher on average for fibers above 500 , corresponding to a lower end - to - end survey - averaged throughput for the optics and ccds of spectrograph 2 as compared to those of spectrograph 1 .    in principle",
    ", variations in the quality of sky foreground subtraction can also affect spectroscopic redshift success . in practice",
    ", we do not see this effect in boss .",
    "figure  [ fig : skyres ] shows the spectrum of systematic sky - subtraction residual flux measured from the sky - subtracted blank - sky fibers of a representative boss plate , calculated by subtracting statistical spectrum pixel error estimates in quadrature from the root - mean - square ( rms ) residual spectrum across all sky fibers on the plate . at the positions of bright oh air - glow lines , the systematic residuals are generally at or below 1% of the sky flux . to test whether the redshift failure rate is affected significantly by variations in sky - subtraction quality",
    ", we quantify the level of residual flux from the sky - subtraction process in each plate as the rms flux in all sky - subtracted blank - sky fibers over the wavelength range 8300  to 10400 , where the effects of oh air - glow lines are particularly pronounced .",
    "figure  [ fig : sky_zrate ] displays the results of this test , with rms residual flux expressed both in units of estimated statistical significance and in units of specific flux . in both cases , there is no discernible correlation between sky - subtraction residual scale and redshift failure rate .",
    "the two conclusions we draw are that ( 1 ) the quality of boss sky subtraction is uniformly high , and ( 2 ) residual variations in the quality of this sky subtraction do not significantly affect redshift measurement for the passive , continuum - dominated cmass galaxies .      unlike the boss galaxy samples , the boss quasar sample does not have a stated requirement on automated classification and redshift success .",
    "the entire quasar target sample is being manually inspected to provide a catalog of visually verified classifications and redshifts @xcite , for which the automated boss pipeline redshifts provide the initial default value . from table  [",
    "table : dr9summary ] , we find that the ` idlspec2d ` pipeline reports a confident classification and redshift ( i.e. , ` zwarning = = 0 ` ) for about 79% of the unique spectra of the boss quasar target sample .",
    "the majority of the remaining 21% of the quasar sample observations are low - s / n spectra of faint targets .",
    "approximately 51.5% of the unique observed quasar sample targets are spectroscopically confirmed as quasars ; most of the confidently classified non - quasar spectra are stars ( typically of spectral type f ) occupying the same region of color space as quasars in the targeted redshift range .",
    "however , only 33.6% of the unique target sample are confirmed quasars at the redshifts @xmath4 which are the focus of the boss ly@xmath3 forest analysis @xcite .",
    "figure  [ fig : qso_conf_rate ] presents the spectroscopic confirmation rate for quasars in this redshift range @xmath4 , as a function of median s / n per pixel over the @xmath72-band wavelength range .",
    "the full comparison of visual redshifts and pipeline redshifts for boss quasar - sample targets is presented in @xcite , and is beyond the scope of this current work .",
    "we note two particular statistics here .",
    "first , the visual inspections provide a 1.7% increase in the sample of @xmath4 quasars beyond those that are confidently identified by the automated pipeline .",
    "second , 0.6% of the quasars identified confidently by the pipeline at @xmath4 either have redshifts in disagreement by @xmath73 with the visual - inspection values , or do not have confident visual identification despite having been inspected .",
    "the latter are due mostly to extremely broad absorption - line quasars and to line mis - identifications . the overall conclusion , however , is that the completeness and purity of the automated quasar classification and redshift measurement is quite high .",
    "figure  [ fig : z_err_hist_qso ] shows the distribution of error - scaled redshift differences for 1464 repeat boss observations of confirmed quasars , as well as the redshift - dependent distributions of statistical single - epoch redshift error estimates , analogous to figures  [ fig : z_err_hist ] and [ fig : v_err_hist ] for galaxies . for quasars ,",
    "the _ statistical _ pipeline redshift errors are underestimated by a factor of approximately two , although the true errors in the pipeline quasar redshifts are likely dominated by systematic effects .",
    "eight of the repeat observations , or about 0.5% , give a redshift difference of @xmath73 , consistent with the rate of catastrophic errors found by the comparison with the visual inspections .",
    "the redshift range 1.02.0 is particularly difficult since the observed optical spectra do not have either the narrow [ oiii ] 5007 line or the strong ly@xmath3 line to guide the template fit .",
    "we now briefly examine the precision and accuracy of boss stellar radial velocities based on stellar repeat observations .",
    "specifically , we identify 8174 repeat observations of objects classified as ` star ` with ` zwarning `  @xmath74 for both epochs . in figure",
    "[ fig : starvdiff ] , we plot the velocity difference between the two epochs of these repeats against the quadrature sum of their statistical error estimates .",
    "we see that the distribution becomes tighter at higher s /",
    "n as expected , with reasonably good agreement between estimated statistical error and actual velocity differences above approximately 15kms@xmath2 in combined statistical error ( or approximately 10kms@xmath2 in single - epoch error ) .",
    "subtracting the statistical error estimates in quadrature from the half - difference between the 84@xmath75 and 16@xmath75 percentile velocity differences , and dividing by a factor of @xmath76 to convert to a single - epoch value , we find a systematic radial - velocity floor of approximately 4.5kms@xmath2 at the high s / n end , comparable to the 4kms@xmath2 precision attained for bright stars by the segue project in sdss - i / ii @xcite .",
    "in order to freeze a set of reductions for collaboration analysis and public release , we have accepted the presence of a number of known outstanding issues in the software that either were deemed small enough in a statistical sense within the survey , or were discovered after the software freeze deadline .",
    "these issues are documented in the following list , and several are illustrated in figure  [ fig : crappo ] .    1 .",
    "pca fits of the ` galaxy ` and ` qso ` classes can sometimes yield unphysical basis combinations at low s / n . this effect is part of the motivation for the ` z_noqso ` redshifts described in  [ subsec : z_noqso ] , and is illustrated in panel `` a '' of figure  [ fig : crappo ] . in order to enable a targeting - blind spectroscopic classification of the sort used in sdss - i / ii , this effect could be remedied by priors on physical pca coefficient combinations , or by non - negativity requirements on archetype - based models such as are used for non - cv stellar classifications in ` idlspec2d ` .",
    "these alternatives are the subject of ongoing development for future boss data releases .",
    "[ item : type2 ] a small number of type ii quasars ( e.g. , * ? ? ?",
    "* ) at redshift @xmath77 are selected by the cmass cuts due to their colors , but their obscured - agn spectra are not typical of the majority of galaxies used to train the galaxy redshift templates .",
    "the inclusion of several such systems in the galaxy - template training set has addressed this issue partially , but a number of these objects have a best - fit galaxy - template redshift that confuses broad [ oiii ]  5007 for h@xmath3 .",
    "their quasar - template redshifts are generally correct , but due to the ` z_noqso ` redshift strategy employed for the boss galaxy samples (  [ subsec : z_noqso ] ) , their adopted redshifts are often in error ( see panel `` b '' of figure  [ fig : crappo ] . ) since these objects represent such a small percentage of the boss galaxy target samples , these errors were deemed acceptable for dr9 galaxy - clustering analyses .",
    "+ the fundamental problem is that the spectra of type ii quasars are sufficiently different from the spectra of most boss galaxies that we can not span the space of both categories with the current number of pca templates ( four ) in the single ` galaxy ` basis set . in future boss data releases , we anticipate addressing this issue through either higher - dimensional basis sets with physical coefficient priors , sub - division of the ` galaxy ` class into several subclasses each with its own basis set , or an archetype - based galaxy redshifting algorithm .",
    "[ item : crosstalk ] a small number of spectra are affected by cross - talk from bright stars ( generally spectrophotometric standards ) in neighboring fibers .",
    "this is often manifested in a strong break feature at the dichroic transition around 6000(see panel `` c '' of figure  [ fig : crappo ] ) , due to different levels of cross - talk between the red and blue arms of the spectrograph @xcite .",
    "these effects appear to occur less frequently at later survey dates , presumably because of improvements in the operating focus of the boss spectrographs .",
    "we intend to address these effects in future boss data releases through improvements in the extraction codes , and to flag any spectra that remain compromised .",
    "no masking of this effect is implemented for boss dr9 data , however , except to the extent that it sometimes triggers a ` zwarning ` flag .",
    "[ item : badfiber ] as discussed in  [ subsec : zfaildepend ] and shown in figure  [ fig : fiberid ] , the boss redshift success rates are somewhat dependent on fiber number in the sense that fibers near the edge of the spectrograph camera fields of view ( ` fiberid ` values near 1 , 500 , and 1000 ) have lower success rates .",
    "longer - term development of new extraction codes based on the 2d psf - modeling approach of @xcite is ongoing , and may mitigate this problem to a significant extent .",
    "[ item : badcol ] a few columns in the boss ccds are bad only in a transient sense , and are not included in the bad - column masks applied to the ccd frames .",
    "these columns lead to occasional spectrum artifacts concentrated near particular fiber numbers ( see panel `` d '' of figure  [ fig : crappo ] ) that are not masked or flagged .",
    "white - dwarf , l - dwarf , carbon - star , and cataclysmic - variable star subclasses have less accurate template radial - velocity zero - points in comparison to the stellar archetypes derived from the indo - u.s . library .",
    "this issue may be rectified in future data releases , although the primary role of stellar templates in boss will remain to correctly classify and set aside non - galaxies and non - quasars .",
    "spectra showing superpositions of two objects are not systematically identified and flagged by the pipeline .",
    "while the majority of boss spectra are of single objects , superpositions are occasionally found to occur . in some cases ,",
    "the inclusion of the polynomial terms in the redshift model fitting leads to fits of almost equal quality for the two components individually , leading to a ` small_delta_chi2 ` flag in the ` zwarning ` ( or ` zwarning_noqso ` ) mask .",
    "in other cases , one component is dominant and is identified by the pipeline as the confident classification and redshift , but with the second component typically identified by one of the lower - quality fits reported in the ` spzall ` file .",
    "various examples of superposition spectra are displayed in figure  [ fig : crappo ] , including star ",
    "star ( panel `` e '' ) , star  galaxy ( panel `` f '' ) , and galaxy  galaxy ( panel `` g '' ) . a systematic search for superposition spectra in the boss data set by",
    "the boss emission - line lens survey ( bells , @xcite ) has discovered a large sample of strong gravitational lens galaxies .",
    "we have described the `` 1d '' component of the ` idlspec2d ` pipeline that provides automated redshift measurement and and classification for the sdss - iii boss dr9 data set , which comprises 831,000 optical spectra .",
    "this software is substantially similar to the ` idlspec2d ` redshift analysis code used for sdss - i / ii data , but has been upgraded with new templates and several new algorithms for application to the boss project , and has been presented in great detail for the first time in this work .",
    "the pipeline also provides additional parameter measurements , including emission - line fits for all objects , and velocity - dispersion likelihood curves for objects classified as galaxies .",
    "the redshift success rate of the ` idlspec2d ` pipeline is well in excess of the scientific requirements of the boss project .",
    "the software provides first - principles estimates of statistical redshift errors that are gaussian distributed and accurate to within small correction factors .",
    "the `` 2d '' component of the ` idlspec2d ` pipeline that extracts spectra from raw ccd pixels is the subject of @xcite .",
    "full data - model information for both the 2d and 1d boss pipeline outputs can be found at the sdss - iii dr9 website ( http://www.sdss3.org/dr9/ ) .",
    "development work continues on data - reduction software for boss , both in the calibration and extraction of spectra , and in the classification and redshift analysis procedures .",
    "subsequent boss data releases will be accompanied by similar documentation of the implemented results of this ongoing development .",
    "funding for sdss - iii has been provided by the alfred p. sloan foundation , the participating institutions , the national science foundation , and the u.s .",
    "department of energy office of science .",
    "the sdss - iii web site is http://www.sdss3.org/.    sdss - iii is managed by the astrophysical research consortium for the participating institutions of the sdss - iii collaboration including the university of arizona , the brazilian participation group , brookhaven national laboratory , university of cambridge , carnegie mellon university , university of florida , the french participation group , the german participation group , harvard university , the instituto de astrofisica de canarias , the michigan state / notre dame / jina participation group , johns hopkins university , lawrence berkeley national laboratory , max planck institute for astrophysics , max planck institute for extraterrestrial physics , new mexico state university , new york university , ohio state university , pennsylvania state university , university of portsmouth , princeton university , the spanish participation group , university of tokyo , the university of utah , vanderbilt university , university of virginia , university of washington , and yale university .",
    ", m. , frieman , j. , bernardi , m. , loveday , j. , nichol , b. , castander , f. , & meiksin , a. 2002 , in society of photo - optical instrumentation engineers ( spie ) conference series , vol .",
    "4847 , society of photo - optical instrumentation engineers ( spie ) conference series , ed .",
    "starck & f.  d. murtagh , 452460"
  ],
  "abstract_text": [
    "<S> we describe the automated spectral classification , redshift determination , and parameter measurement pipeline in use for the baryon oscillation spectroscopic survey ( boss ) of the sloan digital sky survey iii ( sdss - iii ) as of the survey s ninth data release ( dr9 ) , encompassing 831,000 moderate - resolution optical spectra . </S>",
    "<S> we give a review of the algorithms employed , and describe the changes to the pipeline that have been implemented for boss relative to previous sdss - i / ii versions , including new sets of stellar , galaxy , and quasar redshift templates . for the color - selected `` cmass '' sample of massive galaxies at redshift @xmath0 targeted by boss for the purposes of large - scale cosmological measurements </S>",
    "<S> , the pipeline achieves an automated classification success rate of 98.7% and confirms 95.4% of unique cmass targets as galaxies ( with the balance being mostly m stars ) . based on visual inspections of a subset of boss galaxies , we find that approximately 0.2% of confidently reported cmass sample classifications and redshifts are incorrect , and about 0.4% of all cmass spectra are objects unclassified by the current algorithm which are potentially recoverable . </S>",
    "<S> the boss pipeline confirms that @xmath151.5% of the quasar targets have quasar spectra , with the balance mainly consisting of stars and low signal - to - noise spectra . </S>",
    "<S> statistical ( as opposed to systematic ) redshift errors propagated from photon noise are typically a few tens of kms@xmath2 for both galaxies and quasars , with a significant tail to a few hundreds of kms@xmath2 for quasars . </S>",
    "<S> we test the accuracy of these statistical redshift error estimates using repeat observations , finding them underestimated by a factor of 1.19 to 1.34 for galaxies , and by a factor of 2 for quasars . </S>",
    "<S> we assess the impact of sky - subtraction quality , signal - to - noise ratio , and other factors on galaxy redshift success . </S>",
    "<S> finally , we document known issues with the boss dr9 spectroscopic data set , and describe directions of ongoing development . </S>"
  ]
}