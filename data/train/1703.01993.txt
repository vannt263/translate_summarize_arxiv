{
  "article_text": [
    "dirichlet s exposition @xcite of gauss reduction theory for indefinite binary quadratic forms is still the essence of the standard treatment .",
    "the core idea is to prove the main theorems by translating reduction into the regular continued fraction expansion of a quadratic irrationality . in 1981",
    ", zagier published an alternative reduction theory @xcite ; his exposition is similar to dirichlet s , replacing regular continued fractions with negative continued fractions , but it omits an important piece .",
    "this article fills in the gap .",
    "let us review some terminology .",
    "a binary quadratic form is a polynomial @xmath0 , and we assume throughout that the coefficients are rational integers .",
    "we will typically represent a form with the shorter notation @xmath1 .",
    "its discriminant is @xmath2 , and we will only consider _ indefinite _ forms  those with positive , nonsquare discriminant . a matrix @xmath3 $ ] in @xmath4 acts on a form @xmath5 as @xmath6 through this right - action , the set of binary quadratic forms is partitioned into equivalence classes .",
    "all forms in a class have the same discriminant .",
    "[ d : reduced ] an indefinite form @xmath1 is * g - reduced * if @xmath7    these are the reduced forms of gauss and zagier .",
    "the definition of g - reduced forms is not the most common one , but its equivalence with gauss s definition goes back at least to frobenius @xcite .",
    "we now define a map that is already in dirichlet ( @xcite , or see section 83 of _ vorlesungen ber zahlentheorie _ ) . but first , we recall that every rational number @xmath8 can be expanded in two ways as a finite regular continued fraction @xmath9\\ ] ] with positive integer _ partial quotients _ @xmath10 . the numbers of quotients appearing in the two expansions have opposite parities : if @xmath11 , then the second expansion has partial quotients @xmath12 .",
    "we recall also that if @xmath13 is a positive , nonsquare integer , then the pellian equation @xmath14 always has solutions in positive integers @xmath15 .",
    "the _ fundamental solution _ is that with minimal @xmath16 .",
    "let @xmath17 be the set of of all gauss - reduced forms @xmath1 with @xmath18 and @xmath19 , and let @xmath20 be the set of nonempty * natural strings * ( i.e. , finite sequences of natural numbers ) . define @xmath21 as follows .",
    "suppose @xmath22 has discriminant @xmath13 .",
    "let @xmath15 be fundamental solution of the pellian equation @xmath14 .",
    "set @xmath23 ( an integer ) and expand the rational number @xmath24 in a finite continued fraction , choosing between the two possible expansions by requiring that the parity of the number of partial quotients be odd if @xmath25 and even otherwise .",
    "define @xmath26 to be the resulting sequence of partial quotients .",
    "let @xmath27 , which has discriminant 17 .",
    "the equation @xmath28 is solvable with fundamental solution @xmath29 .",
    "we compute @xmath30 and expand @xmath31 in a continued fraction of odd length to obtain @xmath32 .",
    "the foremost property of @xmath33 is that if @xmath34 has discriminant @xmath13 and relatively prime coefficients , then the quadratic irrationality @xmath35 has a purely periodic continued fraction and the natural string @xmath26 gives the minimal period . for instance , continuing the example above , we may compute @xmath36 dirichlet works with a slightly less general map than the one given above , but a proof of this property of @xmath33 as we have stated it is already in weber s _ lehrbuch der algebra _ , volume 1 ( or see ( * ? ? ? * proof of theorem 2.2.9 ) ) .",
    "theorem [ t : gammanatural ] gives a different proof .",
    "we now introduce an analogue of @xmath33 defined on zagier - reduced forms .",
    "let :    * @xmath37 be the set of all zagier - reduced forms , * @xmath38 be the set of natural strings of length @xmath39 , and * @xmath40 be the set of binary strings with at least one 1 .    actually , we define two maps : @xmath41    [ d : beadseq ] suppose @xmath42 has discriminant @xmath13 .",
    "let @xmath15 be the fundamental solution of the pellian equation @xmath14 .",
    "set @xmath23 ( an integer ) and expand the rational number @xmath43 into a continued fraction , choosing between the two possible expansions by requiring that the parity of the number of partial quotients be even if @xmath25 and odd otherwise .",
    "define @xmath44 to be the resulting sequence of partial quotients .",
    "we call @xmath44 the * bead sequence * of @xmath45 .    the differences with dirichlet s map are that the input form @xmath45 is z - reduced instead of g - reduced , the fraction expanded in a continued fraction has denominator @xmath46 instead of @xmath47 , and the parity of the number of quotients is switched .",
    "above , we indicated that the image @xmath48 is contained in @xmath38 , i.e. , no bead sequence has a single element .",
    "proposition [ p : formfrombeads ] shows that in fact @xmath49 surjects onto @xmath38 .    before defining @xmath50 ,",
    "a notational remark is in order .",
    "we will refer to natural strings as `` strings '' , but we mostly use the more common sequence notation @xmath51 .",
    "we will also use binary strings and write them with the standard juxtaposition notation @xmath52 .",
    "we define now a `` stars - and - bars '' map @xmath53 . given @xmath54 , we arrange a sequence of @xmath55 stars in a row , then place @xmath56 bars in gaps between the stars so that the stars are divided into bunches of size @xmath57 ,  , @xmath58 as we move left to right . beginning with an empty string",
    ", we traverse the stars from left to right , examining the gaps between stars and appending @xmath59 at each empty gap and @xmath60 at each bar .",
    "the resulting binary string is @xmath61 .    if @xmath62 , define @xmath63 .",
    "let @xmath64 , which has discriminant @xmath65 .",
    "the equation @xmath28 is solvable with fundamental solution @xmath66 .",
    "we compute @xmath67 and expand @xmath68 into a continued fraction of even length to obtain the bead sequence @xmath69 .",
    "the stars and bars are @xmath70 and the resulting binary string is @xmath71    let us scale the form in the previous example by @xmath72 , giving @xmath73 of discriminant @xmath74 . considering the equation @xmath75 modulo 16 shows that it is not solvable .",
    "the fundamental solution of @xmath76 is @xmath77 .",
    "we compute @xmath78 and expand @xmath79 into a continued fraction of odd length to obtain @xmath80 , and then @xmath81    it is striking that the string @xmath82 in example 3 is obtained by concatenating the string @xmath83 in example 2 with itself . theorem [ t : scaledform ] will show that scaling a z - reduced form generally corresponds to self - concatenating the corresponding binary string .",
    "let @xmath84 be the set of all g - reduced forms .",
    "the map @xmath85 with @xmath86 sends forms to equivalent forms .",
    "there are infinitely many z - reduced forms outside the image of @xmath87 , such as @xmath88 .",
    "on the other hand , restricting @xmath87 to forms with @xmath18 gives an injective map , as does restricting it to forms with @xmath89 , so the preimage of each form in z has size @xmath90 . if @xmath91 is a class of indefinite forms , then @xmath92 is finite and corollary [ c : zgdifference ] determines the difference @xmath93 .",
    "let @xmath94 be the map that prepends ` 1 ' to a string in @xmath20 .",
    "theorem [ t : xi ] shows that the following diagrams commute : @xmath95{r}{\\mu } \\arrow{d}{\\gamma } & z \\arrow{d}{\\beta } \\\\",
    "s_1 \\arrow[hookrightarrow]{r}{\\eta } & s_2    \\end{tikzcd } \\qquad     \\begin{tikzcd }      g \\arrow[hookrightarrow]{r}{\\mu } \\arrow{d}{\\gamma } & z \\arrow{d}{\\sigma } \\\\",
    "s_1 \\arrow[hookrightarrow]{r}{\\mathrm{sb } \\ , \\circ \\ , \\eta } & b_1    \\end{tikzcd}\\ ]",
    "]    in these diagrams , @xmath87 , @xmath96 , and @xmath97 are all injections .",
    "this allows quick proofs of properties of @xmath33 from corresponding properties of @xmath49 and @xmath50 . because the injections are not bijections , it is difficult to go the other way and deduce general properties of @xmath49 and @xmath50 from the well - known corresponding properties of @xmath33 .",
    "for this reason , most of this article ( sections [ s : construction ] to [ s : qi ] ) is occupied with developing the properties of @xmath49 and @xmath50 without reference to known properties of @xmath33 .",
    "section [ s : gzcompare ] then proves that the above diagrams commute , which then allows deducing the corresponding properties of @xmath33 .",
    "theorem [ t : reductionrelation ] shows how gauss - reduction translates through the map @xmath87 .",
    "the take - away is that we may view a single zagier - reduction as a `` fraction of a gauss - reduction '' .",
    "combining this with the above commutative diagrams , zagier s reduction theory becomes a refinement of gauss s .",
    "we will now describe the main properties of @xmath33 and their analogues for @xmath49 and @xmath50 .",
    "* transport of operators .",
    "* both @xmath33 and @xmath50 transport reduction operations on forms to cyclic permutation of the corresponding strings ( theorems [ t : rotation ] and [ t : reductionrelation ] ) .",
    "zagier - reduction also transports through @xmath49 to a simple operation on @xmath38 ( lemma [ l : beading ] ) .",
    "scalar multiplication on forms transports through @xmath33 and @xmath50 to self - concatenation of the corresponding strings , and",
    "the solution of a pellian equation determines the number of concatenations ( theorems [ t : scaledform ] and [ t : gscaledform ] ) .",
    "* necklaces . *",
    "a combinatorial necklace over an alphabet @xmath98 is an equivalence class of finite strings over @xmath98 under cyclic permutation .",
    "the name arises from the depiction , as in figure [ f : stringnecklace ] , of the necklace represented by the string @xmath99 as a sequence of * beads * evenly spaced around a circle .",
    "we will consider * natural necklaces * , which have natural number beads , and * binary necklaces * , whose beads are 0 s and 1 s .    [",
    "f : stringnecklace ]    because @xmath33 and @xmath50 transport reduction operations on forms to cyclic permutation of strings , they induce maps that send classes of indefinite forms to natural and binary necklaces respectively .",
    "we can view gauss- and zagier - reduction as rotating these necklaces , and a rotation of the binary necklace of a class is a `` fractional rotation '' of the natural necklace .",
    "figure [ f : necklacesdisc17 ] shows the binary and natural necklaces for the unique class of discriminant 17 , obtained from examples 1 and 2 above .",
    "[ f : necklacesdisc17 ]    in the context of eventually periodic continued fractions , moving from the natural string @xmath26 to a natural necklace is intuitive  when we arrange the minimal period of a continued fraction expansion in a necklace , the circular arrangement reflects the infinitely repeating nature of the continued fraction .",
    "the natural string @xmath44 does not generally represent this natural necklace , but our development of the properties of @xmath49 and @xmath50 culminates in the proof that @xmath44 can be `` tied - off '' to obtain the minimal period necklace ( theorem [ t : qinecklace ] ) .",
    "once again , the corresponding property of @xmath33 follows quickly ( theorem [ t : gammanatural ] ) , but not conversely .",
    "the map @xmath50 enjoys a similar relationship to denjoy continued fractions .",
    "these are continued fractions with all quotients equal to 0 or 1 and such that two 0 s never occur as consecutive quotients .",
    "every irrational number expands uniquely in a denjoy continued fraction , and quadratic irrationalities are precisely the numbers with eventually periodic denjoy expansions .",
    "the binary necklace represented by @xmath83 gives the minimal period of the denjoy continued fraction expansion of a quadratic irrationality associated with @xmath45 ( theorem [ t : denjoy ] ) .",
    "* transport of invariants . *",
    "the induced maps from classes of indefinite forms connect certain class invariants with corresponding necklace invariants .",
    "the * content * of a form is the greatest common divisor of its coefficients , and a form is * primitive * if it has content @xmath60 .",
    "content is a class invariant , and a * primitive class * is one whose forms are all primitive .",
    "the * g - caliber * of a class is the number of g - reduced forms in the class that have positive first coefficient .",
    "the * z - caliber * is the number of z - reduced forms in the class .",
    "( the g - caliber is usually defined to be the number of g - reduced forms  this is twice as big as the definition we use .",
    "our alternative definition cleans up some of the exposition and is in line with the definition of dirichlet s map above . )",
    "a string of length @xmath100 is a * primitive string * if the cyclic group of order @xmath100 acts freely upon it .",
    "a * primitive necklace * is one whose associated strings are primitive .",
    "equivalently , a primitive necklace is one with no nontrivial rotational symmetry when its beads are evenly spaced around a circle .",
    "the * length * and * weight * of a binary necklace are the number of beads and the number of @xmath60s in the necklace .    through the induced map from form classes to binary necklaces , we have rough correspondences : @xmath101 primitive classes are sent to primitive necklaces , and the first relation is a bijection if we restrict to classes of discriminant @xmath13 such that the pellian equation @xmath25 is solvable ( theorem [ t : primitivity ] ) .",
    "it is two - to - one on the remaining classes .",
    "the first map induces the second and third relations , with the following caveat : when we restrict to discriminants such that @xmath25 , they are equalities  the calibers of primitive classes equal the corresponding weight and length of the binary necklaces . for the remaining discriminants ,",
    "the weight or length of a primitive necklace equals the sum of the g - calibers or z - calibers of the two classes that map to it .",
    "the discriminant of a class does not correspond with a simple invariant of the corresponding binary necklace .",
    "however , the parity of the necklace weight determines whether the pellian equation @xmath25 is solvable or not ( proposition [ p : weightparity ] ) , and @xmath102 gives an upper bound for the necklace length ( corollary [ c : lengthbound ] ) .",
    "recently , uluda , zeytin , and durmu ( uzd ) gave another construction of binary necklaces attached to classes of indefinite forms @xcite .",
    "with each class , they associate a graph called a _",
    "ark_. a _ ark _ is a quotient of a conway topograph @xcite , formed in such a way that the periodic river in the topograph becomes a cycle in the ark .",
    "we can assign an edge on the cycle to each gauss - reduced form in the form class of the ark .",
    "beginning at such an edge and traveling around the cycle , we encounter branches splitting off to the right and left .",
    "uzd construct a natural string by counting runs of consecutive branches that all split off in the same direction and recording a natural number for each count .",
    "it turns out that the uzd natural necklace is essentially the minimal period necklace described above .",
    "indeed , upon translating their construction into arithmetic , one sees that it begins the same as dirichlet s map but expands @xmath103 in a negative continued fraction rather than a regular one .",
    "the rest of the uzd algorithm then amounts to performing the standard conversion from a negative continued fraction expansion of to its regular continued fraction @xcite . ultimately , the uzd construction is a graphical version of dirichlet s map .",
    "the maps @xmath49 and @xmath50 have thus already proven themselves useful , forming the basis of three forthcoming works :    * theorem [ t : rotation ] allows a simplification of a formula of hirzebruch and zagier for the value at zero of the partial zeta function of a form class .",
    "it has several interesting consequences : * * new congruences between zagier - calibers of form classes , * * an analogue of dirichlet s inequality that if @xmath104 is prime , there are more quadratic residues than nonresidues in the interval @xmath105 $ ] , and * * a conjectural new analogue of brumer s conjecture . *",
    "a simple condition ensures that the composition of two z - reduced forms is again z - reduced .",
    "we apply @xmath50 to such trios of forms and use the resulting necklaces to study the class group * we give a new characterization of the famous classes of markoff  they are those whose necklaces have a line of symmetry and another line of `` near - symmetry '' of a certain type .",
    "we also show that moving down the binary tree of z - reduced markoff forms is accomplished by concatenating the corresponding binary strings .",
    "in this section , we show that @xmath50 induces a map from form classes to binary necklaces and deduce some consequences",
    ".    zagier s reduction algorithm @xcite proceeds by iterating the operator that sends the form @xmath106 with discriminant @xmath13 to the equivalent form @xmath107 , where @xmath100 is the `` reducing number '' , defined using ceiling notation @xmath108    recall the definition of z - reduced forms from definition [ d : reduced ] .",
    "( zagier , @xcite ) the orbit of an indefinite form under zagier - reduction is eventually periodic .",
    "a form is z - reduced if and only if its orbit is purely periodic , hence forms a cycle .",
    "there are finitely many z - reduced forms of given discriminant , and each class of indefinite forms contains a unique cycle of z - reduced forms .",
    "our first theorem concerning the map @xmath50 is that it transports zagier - reduction to cyclic permutation of the corresponding binary string .",
    "let us denote the zagier - reduction operator by @xmath109 .",
    "[ t : rotation ] suppose that @xmath45 is a z - reduced form .",
    "the string @xmath110 is obtained from @xmath83 by cycling as follows :    1 .",
    "if @xmath83 begins with a ` 0 ' , then the initial ` 0 ' is removed from the front and appended to the back .",
    "if @xmath111 has just one initial ` 1 ' and the succeeding characters are all ` 0 ' , then the initial 1 is removed from the front and appended to the back .",
    "3 .   if @xmath111 begins with a ` 1 ' and contains at least two  1 s , then the string is cycled so that the second ` 1 ' is moved to the final position .",
    "we delay the proof until the end of this section and turn first to further understand the implications of the theorem .",
    "foremost , it shows that @xmath50 induces a well - defined map from classes of indefinite forms to binary necklaces .",
    "recall that the number of 1 s in a binary necklace is its _ weight _ , and the number of beads ( i.e. , characters ) is its _",
    "length_.    if @xmath45 is a z - reduced form or @xmath91 is a class of indefinite forms , the * length * and * weight * of @xmath45 or @xmath91 are the length and weight of the corresponding binary necklace .    from the definition of @xmath50 , we have :    [ p : weightparity ] the parity of the weight of a class of indefinite forms depends only on the discriminant of the class .",
    "a class @xmath91 of discriminant @xmath13 has odd weight if @xmath25 is solvable and even weight if it is not solvable .    when the string @xmath83 begins with a @xmath60 , theorem [ t : rotation ] shows that reducing @xmath45 will rotate the string in such a way that it `` skips a 1 ''",
    "that is , if we iteratively cycle @xmath83 with the operation described in the theorem , the next @xmath60 to appear at the beginning of a string will be the third @xmath60 appearing in @xmath83 . if @xmath112 has odd weight , the strings @xmath113 for @xmath114 , @xmath115 ,  ( the exponent denoting iteration ) will eventually pass through every cyclic permutation of @xmath83 .",
    "but if it has even weight , we miss some permutations . for such discriminants , the induced map from form classes to necklaces is two - to - one . to obtain a bijection",
    ", we must impose more structure on the necklaces .",
    "an * alternating string * ( resp .",
    "* alternating necklace * ) is a binary string ( resp .",
    "binary necklace ) of even weight with @xmath60 s that come in two colors ( we will use green and blue ) .",
    "the @xmath60 s alternate colors as you move along the string or necklace .",
    "two alternating strings represent the same alternating necklace only if they can be cycled to have @xmath60s and @xmath59 s coincide with matching colors . the binary necklace obtained by ignoring the colors in an alternating necklace is the * underlying necklace*. an alternating necklace is * primitive * if the underlying necklace is primitive .",
    "the * length * and * weight * of an alternating necklace are that of the underlying binary necklace .",
    "we will use an overbar to denote forming equivalence classes , both of forms and of strings .",
    "thus , @xmath116 and @xmath117 will both denote classes of forms , while @xmath118 and @xmath119 are necklaces represented by the strings @xmath120 and @xmath121 .",
    "if @xmath121 is a binary string of even weight , we assume further that @xmath119 is an alternating necklace and make the convention that when traversing the string @xmath121 from the left , the first ` 1 ' encountered is colored @xmath122 .",
    "we denote by @xmath123 the map from classes of forms to necklaces defined as follows : @xmath124 is the necklace @xmath125 , where @xmath45 is an arbitrary z - reduced form in @xmath91 .",
    "the restriction of @xmath123 to classes of odd weight maps to the set of binary necklaces of odd weight .",
    "it maps classes of even weight to the set of alternating necklaces .",
    "thus , in example 2 above , we have @xmath126    we now consider the relationship between certain class invariants and the corresponding necklaces . recall from section [ s : intro ] the definitions of primitive forms / classes and of primitive strings / necklaces .    [",
    "t : primitivity ] if @xmath45 is a primitive z - reduced form , then @xmath83 is a primitive string , and @xmath50 restricts to a bijection between the set of primitive z - reduced forms and the set of primitive binary strings of nonzero weight .",
    "the induced map @xmath123 restricts to a bijection between the set of primitive classes of odd weight and the set of primitive binary necklaces of odd weight .",
    "it also restricts to a bijection between the set of primitive classes of even weight and the set of primitive alternating necklaces of nonzero weight .",
    "this theorem will be proved immediately following the proof of theorem [ t : scaledform ] .",
    "[ d : zcaliber ] if @xmath91 is a class of indefinite forms , then the * z - caliber * of the class is the number of z - reduced forms in the class , denoted @xmath127 .",
    "we can define a map @xmath128 that takes an alternating necklace and excises all 1 s colored 1 as well as the runs of zeroes immediately preceding those 1 s . from theorems [ t : rotation ] and [ t : primitivity ] , we immediately obtain :    [ c : zcaliber ] if @xmath91 is a primitive class of odd weight with length @xmath129 , then @xmath130 . if the weight is even , then the @xmath127 is the length of the necklace @xmath131 .",
    "( corollary [ c : calibercompare ] shows that the length of a class of even weight is generally the sum of the calibers of two classes . )",
    "the remainder of this section is devoted to the proof of theorem [ t : rotation ] .",
    "let @xmath132 be the endomorphism on the set of sequences of finite integers of length at least @xmath115 that operates as : @xmath133    [ l : beading ] if @xmath45 is a z - reduced form , then @xmath134 and @xmath135 .    before we take up the proof of lemma [ l : beading ] , let us note that theorem [ t : rotation ] is an immediate consequence of it .",
    "recall that @xmath136 , where @xmath97 is the `` stars - and - bars '' map .",
    "it is readily checked that applying @xmath132 to @xmath137 transports through @xmath97 to the operation described in theorem [ t : rotation ] , the three cases arising when @xmath138 , when @xmath139 and @xmath140 , and when @xmath139 and @xmath141 respectively .",
    "we also make an observation that will be used frequently in what follows .",
    "[ l : reducetouf ] suppose @xmath45 is z - reduced of discriminant @xmath13 . if @xmath15 is the fundamental solution of @xmath14 , then @xmath142 , @xmath143 , and @xmath144 .",
    "this follows by examining the constructions of @xmath49 and @xmath33 and observing that the fundamental solution of the pellian equation @xmath145 is @xmath146 .",
    "we defer the proof that @xmath44 has length @xmath39 to the proof of proposition [ p : formfrombeads ] .",
    "we can reduce the other statement to the case where @xmath45 has discriminant @xmath13 of the form @xmath147 .",
    "indeed , lemma [ l : reducetouf ] shows @xmath142 with @xmath15 the fundamental solution of @xmath14 .",
    "zagier s reduction operation commutes with scalar multiplication , so if the lemma holds for @xmath148 , then @xmath149 .",
    "then @xmath150 and the reduction is complete .",
    "the lemma might now be proved directly using properties of continued fractions , but we will instead use a result from an earlier work @xcite .",
    "suppose the z - reduced form @xmath151 has discriminant @xmath152 , with @xmath153 or @xmath60 . the pellian equation @xmath14 then has fundamental solution @xmath154 , so to compute @xmath44 we set @xmath155 .",
    "we recall the definition of @xmath44 and also define a modification @xmath156 :    * @xmath44 is the sequence of length parity @xmath157 obtained by expanding @xmath158 as a simple continued fraction .",
    "* @xmath156 is the sequence of length parity @xmath157 obtained by expanding @xmath159 as a simple continued fraction .",
    "( we say a sequence has length parity @xmath157 if its length has the same parity as @xmath157 . )",
    "let us say we * pinch * the left end of a finite sequence of positive integers by transforming it through the rule @xmath160 we pinch the right end similarly .",
    "we also make the convention that the sequence ` @xmath161 ' and the empty sequence are pinched by doing nothing .",
    "we _ knead _ a finite sequence of positive integers by    1 .   removing the leftmost entry , then 2 .   pinching both ends of what remains , then 3 .   placing the removed entry on the right end of the result .",
    "theorem 2 of @xcite shows that zagier - reduction transports through the map @xmath162 to kneading the corresponding sequence .",
    "we claim that pinching both ends of @xmath156 produces @xmath44 . comparing the first few steps of the euclidean algorithm with @xmath163 and @xmath164 and",
    "then with @xmath163 and @xmath165 quickly reveals that one sequence of quotients is obtained from the other by pinching the left end .",
    "pinching just the left end switches the length parity of the sequence of quotients , so to compute @xmath166 from @xmath156 , we must change the parity again by switching to the other of the two simple continued fraction expansions of @xmath167 . since switching between the two continued fraction expansions is accomplished by pinching the right end of the sequence of quotients , the claim follows . to conclude",
    ", we must see that acting with @xmath132 on a sequence @xmath51 with @xmath168 has the same effect as performing the three steps    1 .",
    "pinch both ends , 2 .",
    "knead the result , then 3 .",
    "pinch both ends again .",
    "there are several cases to consider .",
    "first , we assume @xmath138 and @xmath169 . if @xmath170 , then depending on whether @xmath171 or @xmath172 , the above three steps look as follows : @xmath173",
    "if @xmath140 , then depending on whether @xmath171 or @xmath172 , the steps are instead @xmath174 if instead @xmath138 and @xmath175 , we have in the cases @xmath171 or @xmath172 @xmath176 it remains to consider when @xmath139 .",
    "first let us consider when @xmath177 .",
    "if @xmath178 and @xmath169 , then we have , depending on whether @xmath179 or @xmath180 , either of the following : @xmath181 if instead @xmath182 and @xmath169 , we have @xmath183 if @xmath178 and @xmath175 , we have @xmath184 finally , if @xmath182 and @xmath175 , we have @xmath185    when @xmath186 , we have , when @xmath187 or @xmath182 respectively @xmath188 and finally , when @xmath140 , we have @xmath189 in every case , the net result is the operation @xmath132 .",
    "let us consider what it takes to invert the string map @xmath190 .",
    "the stars - and - bars map @xmath97 is invertible , so from a given binary string @xmath121 , we can produce a unique bead sequence .",
    "the map @xmath49 from z - reduced forms to bead sequences is generally many - to - one , but we can find a section using continuants .",
    "we introduce these now , as well as the fundamental identities that will be used heavily through the rest of the paper .",
    "let @xmath191 $ ] and @xmath192 denote , respectively , the numerator and denominator when the regular continued fraction with quotients @xmath193 is simplified to a reduced fraction .",
    "then @xmath194}{\\left\\langle q_1 , \\ldots , q_l \\right\\rangle } = q_1 + \\frac{1}{\\frac{\\left [ q_2 , \\ldots , q_l \\right]}{\\left\\langle q_2 , \\ldots , q_l \\right\\rangle } } = \\frac{q_1 \\left [ q_2 , \\ldots , q_l \\right ] + \\left \\langle q_2 , \\ldots , q_l \\right\\rangle}{\\left [ q_2 , \\ldots , q_l \\right]}\\ ] ] since @xmath195 $ ] and @xmath196 are relatively prime , the fraction on the right is reduced . generally , then , @xmath197 $ ] and @xmath191 $ ] and @xmath198 $ ] are coprime .",
    "a * continuant * is a number attached to a natural string , denoted by @xmath199\\ ] ] and computed as the numerator when the regular continued fraction with partial quotients @xmath57  , @xmath58 is simplified to a reduced fraction . from",
    ", the corresponding denominator is then @xmath198 $ ] .",
    "frequently , we will encounter identities that specialize to involve continuants of the form @xmath200 $ ] and @xmath201 $ ] .",
    "we make the convention that the former equals @xmath60 and the latter equals @xmath59 .",
    "equation gives the recursion @xmath191 = q_1 \\left [ q_2 , \\ldots , q_l \\right ] + \\left [ q_3 , \\ldots , q_l \\right]$ ] for @xmath202 .",
    "this recursion shows that @xmath57 is the quotient and @xmath203 $ ] is the remainder when dividing @xmath191 $ ] by @xmath198 $ ] .",
    "consequently , if @xmath204 $ ] and @xmath205 $ ] , then @xmath206 expands in a continued fraction with quotient sequence @xmath51 .    from the above recursion , we find by induction the matrix identity @xmath207 & \\left [ q_1 , \\ldots , q_{l-1 } \\right]\\\\ \\left [ q_2 , \\ldots , q_{l } \\right ] & \\left [ q_2 , \\ldots , q_{l-1 } \\right ] \\end{bmatrix}\\ ] ]    transposing , we find @xmath208 = \\left [ q_1 , \\ldots , q_l \\right],\\ ] ] taking determinants instead , we have @xmath209 \\left [ q_2 , \\ldots , q_{l-1 } \\right ] - \\left [ q_1 , \\ldots , q_{l-1 } \\right ]",
    "\\left [ q_2 , \\ldots , q_l \\right ] = ( -1)^l.\\ ] ]    from , we find there are two recursions : @xmath210 & = q_1 \\left [ q_2 , \\ldots , q_l \\right ] + \\left [ q_3 , \\ldots , q_l \\right],\\\\      \\left [ q_1 , \\ldots , q_l \\right ] & = q_l \\left [ q_1 , \\ldots , q_{l-1 } \\right ] + \\left [ q_1 , \\ldots , q_{l-2 } \\right ] , \\end{aligned}\\ ] ] which have the useful consequences @xmath211 & = \\left [ q_1 , \\ldots , q_l \\right ] + q\\left [ q_2 , \\ldots , q_l \\right],\\\\       \\left [ q_1 , \\ldots , q_{l-1 } , q_l + q \\right ] & = \\left [ q_1 , \\ldots , q_l   \\right ] + q \\left [ q_1 , \\ldots , q_{l-1 } \\right ] , \\end{aligned}\\ ] ] and @xmath212 & = \\left [ q_2 + 1 , \\ldots , q_l \\right ] , \\\\      \\left [ q_1 , \\ldots , q_{l-1 } , 1 \\right ] & = \\left [ q_1 , \\ldots , q_{l-1 } + 1 \\right ] . \\end{aligned}\\ ] ]    we will find it useful to define a continuant with @xmath59 as an entry .",
    "we set @xmath213 = 0 $ ] and @xmath214 = \\left [ q_3 , \\ldots , q_l \\right ] , \\qquad \\left [ q_1 , \\ldots , q_{l-1 } , 0 \\right ] = \\left [ q_1 , \\ldots , q_{l-2 } \\right]\\ ] ] for @xmath168 . identities through then remain true with continuants having @xmath59 as an end entry .",
    "we now return to considering a section of @xmath49 . given a finite sequence of positive integers @xmath51 with @xmath168 , we produce a form @xmath1 by setting @xmath215\\\\      c & = \\left [ q_1 , \\ldots , q_{l-1 } , q_l - 1 \\right]\\\\      b & = \\left [ q_1 , \\ldots , q_l \\right ] + \\left [ q_{1 } -1 , q_2 , \\ldots , q_{l-1 } , q_l - 1 \\right],\\end{aligned}\\ ] ] ( a continuant with end entry equal to @xmath59 is defined as in . )",
    "let us denote the form with these coefficients by @xmath216 recall that @xmath38 is the set of natural strings with length @xmath39 .",
    "let @xmath217 be the set of z - reduced forms with discriminant of the form @xmath147 .",
    "[ p : formfrombeads ] the map @xmath218 is a bijection from @xmath38 to @xmath217 , with inverse given by the restriction of @xmath49 to @xmath217 .",
    "in fact , the discriminant of @xmath219 is @xmath220 - \\left [ q_1 - 1 , q_2 , \\ldots , q_{l-1 } , q_l - 1 \\right ] \\right)^2 + ( -1)^l \\cdot 4\\ ] ]    [ c : sigmasurjects ] the map @xmath190 is a surjection from the set of z - reduced forms to the set of binary strings of nonzero weight .",
    "the map @xmath221 is a section of @xmath50 whose image is the set of z - reduced forms with discriminants of the form @xmath147 .",
    "the following identity follows by using @xmath222 $ ] in place of @xmath223 $ ] in and then applying : @xmath224 \\left [ q_1 - 1 , q_2 , \\ldots , q_{l-1 } , q_l - 1 \\right ]   - \\left [ q_1 , \\ldots , q_{l-1 } , q_{l } - 1 \\right ]   \\left [ q_1 - 1 , q_2 , \\ldots , q_{l } \\right ] = ( -1)^l\\ ] ] using it , we compute the discriminant of @xmath219 to be @xmath225 & + [ q_1 - 1 , q_2 , \\ldots , q_{l-1 } , q_l - 1 ] ) ^2 - 4 \\left [ q_1 - 1 , q_2 , \\ldots , q_l \\right ] \\left [ q_1 , \\ldots , q_{l-1 } , q_l - 1 \\right]\\\\          & = ( [ q_1 , \\ldots , q_l ] - [ q_1 - 1 , q_2 , \\ldots , q_{l-1 } , q_l - 1 ] ) ^2 + 4 \\cdot ( -1)^l.\\end{aligned}\\ ] ]    now suppose we have a sequence @xmath51 with @xmath168 , and set @xmath226 .",
    "the above discriminant is positive since , using , @xmath227 - \\left [ q_1 - 1 , q_2 \\ldots , q_{l-1 } , q_l - 1 \\right ] & > \\left [ q_1 , \\ldots , q_l \\right ] - \\left [ q_1 , \\ldots , q_{l-1 } , q_l - 1 \\right]\\\\      & = \\left [ q_1 , \\ldots , q_{l-1 } \\right ] \\geq 2.\\end{aligned}\\ ] ] to check that @xmath1 is z - reduced , we note that @xmath164 , @xmath89 . using again , @xmath228 + \\left [ q_1 - 1 , q_2 , \\ldots , q_{l-1 } , q_l - 1 \\right ] - \\left [ q_1 - 1 , q_2 , \\ldots , q_l \\right ] - \\left [ q_1 , \\ldots , q_{l-1 } , q_l - 1 \\right]\\\\      & = [ q_1 , \\ldots , q_{l-1 } ] - \\left [ q_1 - 1 , q_2 , \\ldots , q_{l-1 } \\right ] = \\left [ q_2 , \\ldots , q_{l-1 } \\right ] > 0.\\end{aligned}\\ ] ] we may thus apply @xmath49 to @xmath219 .    using the discriminant of @xmath219 found above ,",
    "@xmath229 is computed by expanding @xmath230}{[q_1 , \\ldots , q_l ] - \\left [ q_1 - 1 , q_2 , \\ldots , q_l \\right ] } = \\frac{[q_1 , \\ldots , q_l]}{[q_2 , \\ldots , q_l]}\\ ] ] in a continued fraction of length parity @xmath129 .",
    "thus , @xmath231 .",
    "suppose now that @xmath1 is z - reduced of discriminant @xmath232 with @xmath233 ( using @xmath234 and @xmath235 when @xmath236 ) .",
    "the sequence @xmath237 is found by setting @xmath238 and expanding @xmath158 as a continued fraction with quotients @xmath51 chosen so that @xmath129 and @xmath157 have the same parity .",
    "we suppose , for now , that @xmath168 .",
    "we will see at the end of the proof that @xmath239 can not happen .",
    "we have @xmath240 so @xmath241 and @xmath163 are coprime .",
    "it follows that @xmath242 $ ] and @xmath243 $ ] .",
    "thus , @xmath244 $ ] , and in particular , @xmath245 .",
    "we also have @xmath246 if the inequality is strict , then @xmath247 , and so from we have @xmath248 and then @xmath249 .",
    "were it true that @xmath250 , we would have @xmath251 and @xmath252 then @xmath253 and @xmath254 , but this can not happen since @xmath255 in a z - reduced form .",
    "thus , @xmath256 .",
    "otherwise , when is an equality , then @xmath257 , @xmath258 , and @xmath129 is even , so shows @xmath259 .",
    "thus , @xmath260 , and so @xmath256 .    equation also shows that @xmath261 , so @xmath262 c \\equiv ( -1)^{l+1 } \\pmod{[q_1 , \\ldots , q_l]}.\\ ] ] we obtain from the congruence @xmath263 \\pmod{z}$ ] . since @xmath264",
    ", we conclude @xmath265 $ ] .",
    "our expressions for @xmath164 and @xmath266 now show that @xmath267 has the form @xmath268 with some middle coefficient @xmath269 . from and",
    ", we also find that @xmath270 $ ] , and hence @xmath271 - \\left [ q_1 - 1 , q_2 , \\ldots , q_{l-1 } , q_l - 1 \\right.\\ ] ] our determination of the discriminant of @xmath219 then gives @xmath272 so @xmath273 .",
    "reworking the above argument assuming @xmath239 , we find @xmath274 , @xmath275 , then @xmath276 , and finally @xmath277",
    ". then @xmath278 , contradicting @xmath279 .",
    "it follows that @xmath49 is a bijection , with inverse @xmath218 , between @xmath217 and @xmath38 .",
    "we will call the string obtained by concatenating together @xmath100 copies of a string @xmath121 the * @xmath100-fold self - concatenation of @xmath121*. the two theorems in this section describe the behavior of @xmath221 under self - concatenating the input string and of @xmath50 upon scaling the input form .",
    "the precise statements of the theorems involve solutions of pellian equations , and we briefly review what we need to know . if @xmath280 is nonsquare , then the equation @xmath25 may or not have solutions , but the equation @xmath281 always has solutions with positive @xmath16 .",
    "the pairs @xmath15 of positive integers satisfying the pellian equation @xmath14 form an infinite sequence @xmath282 with @xmath283 and @xmath284 for @xmath285 .",
    "the pair @xmath286 is the _",
    "fundamental solution_. every pair in the sequence is determined from the fundamental solution by the identity @xmath287 ( proved , for instance , by modifying the line of reasoning in barbeau ( * ? ? ?",
    "* section 4.2 ) ) .",
    "if @xmath25 has solutions , then @xmath288 satisfies the equation @xmath289 .",
    "the main theorems of this section are the following :    [ t : periodicstring ] suppose that @xmath290 is the @xmath100-fold self - concatenation of a primitive string @xmath291 of nonzero weight .",
    "let @xmath13 be the discriminant of @xmath292 , and let @xmath282 be the sequence of positive solutions of @xmath14 .",
    "then there is an equality of forms @xmath293    the proof is technical , so it will be deferred until the end of the section .",
    "[ t : scaledform ] suppose that @xmath45 is a primitive z - reduced form of discriminant @xmath13 .",
    "let @xmath282 be the sequence of positive solutions of @xmath14 .",
    "for every positive integer @xmath294 , there exists an @xmath100 such that @xmath294 divides @xmath295 .",
    "if @xmath296 is the minimal positive such @xmath100 , then @xmath297 is the @xmath296-fold self - concatenation of the primitive string @xmath83 . in particular",
    ", @xmath50 maps primitive forms to primitive strings .",
    "theorem [ t : scaledform ] is obtained proved using another observation about pellian equations :    [ l : u1divides ] let @xmath13 and @xmath298 be as in theorem [ t : scaledform ]",
    ". then @xmath299 , where @xmath300 is the sequence of positive solutions of @xmath301 .",
    "for every positive integer @xmath100 , we have @xmath302 , so multiplication by @xmath303 is an injection from @xmath304 into @xmath305 . to see that the map is onto , we check first that @xmath303 divides @xmath295 for all @xmath100 . we know that @xmath306 is given by .",
    "if @xmath13 is divisible by 4 , then @xmath307 is even .",
    "the coefficient of @xmath308 when expanding @xmath309 is then divisible by @xmath303 . thus @xmath303 divides the coefficient of @xmath310 when the right side of is expanded , and comparing with the left side , @xmath303 divides @xmath295 .",
    "if @xmath13 is odd , then @xmath307 and @xmath303 have the same parity .",
    "if @xmath311 and @xmath312 are integers , the check that @xmath303 divides @xmath295 is similar .",
    "if instead @xmath307 and @xmath303 are odd , then an inductive argument shows @xmath303 divides @xmath295 .    setting @xmath313 , we have @xmath314",
    ". then @xmath315 for some @xmath294 , and @xmath316 .",
    "multiplication by @xmath303 is thus an order - preserving bijection from @xmath304 to @xmath305 , so the lemma is proved .",
    "we begin by proving the case @xmath317 , which just says @xmath83 is primitive .",
    "lemma [ l : reducetouf ] shows @xmath318 .",
    "suppose that @xmath319 is obtained by concatenating @xmath320 copies of a primitive string @xmath121 with itself .",
    "set @xmath321 .",
    "note that @xmath322 has discriminant @xmath323 , and we may write the discriminant of @xmath324 in the form @xmath325 for some integer @xmath326 . let @xmath327 be the sequence of positive solutions of @xmath328 .",
    "corollary [ c : sigmasurjects ] and theorem [ t : periodicstring ] then imply that @xmath329 since @xmath45 is primitive , it follows that @xmath330 divides @xmath303 . considering discriminants in the above equation",
    ", we find that @xmath331 is a solution to @xmath14 .",
    "since @xmath286 is the fundamental solution , we must have @xmath332 , that is , @xmath333 .",
    "thus , @xmath319 is primitive and the theorem holds when @xmath317 .",
    "next , let @xmath294 an arbitrary positive integer . if @xmath334 is the fundamental solution of @xmath335 , then @xmath336 for some positive integer @xmath296 .",
    "we claim that @xmath296 is the minimal positive @xmath100 such that @xmath294 divides @xmath295 .",
    "suppose @xmath320 is a positive integer such that @xmath337 , with @xmath338 an integer .",
    "it follows from lemma [",
    "l : u1divides ] that if @xmath339 is the sequence of positive solutions of @xmath340 , then @xmath341 .",
    "thus , @xmath342 is a solution of @xmath335 .",
    "since @xmath343 is the fundamental solution , we have @xmath344 .",
    "then @xmath345 , so @xmath346 . thus , @xmath296 is minimal as claimed .",
    "using lemma [ l : u1divides ] again , we have @xmath347 . from above , we can write @xmath348 for a primitive string @xmath121 , and theorem [ t : periodicstring ] shows that @xmath349 is the @xmath296-fold self - concatenation of @xmath350 .",
    "now , as promised in section [ s : construction ] , we prove theorem [ t : primitivity ] .",
    "suppose @xmath121 is a primitive binary string , set @xmath351 , and let @xmath352 be the content of @xmath324 .",
    "theorem [ t : scaledform ] shows that @xmath353 is a self - concatenation of the primitive string @xmath354 with itself .",
    "since @xmath121 is primitive , it equals @xmath354 .",
    "thus , the map @xmath50 from primitive forms to primitive strings is surjective",
    ".    if @xmath355 and @xmath356 are primitive forms with @xmath357 , lemma [ l : reducetouf ] shows there are integers @xmath16 and @xmath358 such that @xmath359 and @xmath360 and @xmath361 and @xmath362 have discriminants of the form @xmath147 . from this",
    ". then @xmath355 and @xmath356 are primitive forms with a common scalar multiple , so they are the same .",
    "this proves that @xmath50 restricts to a bijection between the sets of primitive z - reduced forms and primitive strings .",
    "the rest of theorem [ t : primitivity ] follows from theorem [ t : rotation ] .",
    "let us now prepare for the proof of theorem [ t : periodicstring ] with some background on chebyshev polynomials .    for each positive integer @xmath100 , we define * chebyshev polynomials * of the first and second kinds @xmath364 and @xmath365 through the recurrences @xmath366    [ l : chebsolutions ] let @xmath153 or @xmath60 and let @xmath100 and @xmath326 be positive integers with @xmath367 when @xmath235 .",
    "set @xmath368 .",
    "let @xmath369 denote a primitive @xmath72th root of unity , and set @xmath370 when @xmath157 is even and @xmath371 when @xmath157 is odd .",
    "with @xmath372 and @xmath295 defined by @xmath373 the sequence @xmath298 comprises all solutions in positive integers to the pellian equation @xmath374 .",
    "it is hard to find a reference for this result , so we sketch a proof .",
    "observe that @xmath375 is the fundamental solution to @xmath374 .",
    "let us first consider when @xmath157 is even . from , we have @xmath376 the identities @xmath377 are readily checked , and from them follows the identity @xmath378 we thus find that @xmath379    turning now to when @xmath157 is odd , we find that @xmath380 once again using , it is readily checked that @xmath381 and so @xmath382    let us call a finite sequence @xmath51 _ periodic _ if there exists a positive integer @xmath383 such that @xmath384 for @xmath385 .",
    "thus , a sequence like @xmath386 is periodic even though the final repeating block is incomplete .",
    "given nonnegative integers @xmath320 , @xmath338 with @xmath387 , let us use the shorthand @xmath388 to denote the periodic sequence obtained by forming the @xmath320-fold self - concatenation of @xmath51 and then appending @xmath389 .",
    "we will also embed this shorthand to indicate periodic subsequences , and we will use it in continuants , e.g. , we would write @xmath390 $ ] for the continuant @xmath391 $ ] .",
    "our study of periodic binary necklaces leads to periodic continuants , which have been studied by rzsa @xcite and elsner and redheffer @xcite .",
    "[ l : periodiccontinuant ] let @xmath392 be a sequence of positive integers , and set @xmath370 if @xmath294 is even and @xmath371 if @xmath294 is odd . set",
    "also @xmath393 + \\left [ c_2 , \\ldots , c_{m-1 } \\right ]   \\right).\\ ] ] denote with @xmath365 the @xmath100th chebyshev polynomial of the second kind",
    ". then @xmath394 & = ( -1)^{mn } \\xi^{n } u_{n } ( \\mathfrak{t } ) - ( -1)^{m(n-1 ) } \\xi^{n-1 } \\left [ c_2 , \\ldots , c_{m-1 } \\right ] u_{n-1 } ( \\mathfrak{t})\\\\      \\left [ ( c_1 , \\ldots , c_m)^{(n , m-1 ) } \\right ] & =   ( -1)^{mn}\\xi^{n } \\left [ c_1 , \\ldots , c_{m-1 } \\right ] u_{n } ( \\mathfrak{t } ) , \\end{aligned}\\ ] ] and for @xmath395 ,  , @xmath396 , @xmath397      & = ( -1)^{mn+r } \\xi^{n+1 } \\left [ c_{r+2 } , \\ldots , c_{m-1 } \\right ] u_{n+1 } ( \\mathfrak{t } ) \\\\      & -",
    "( -1)^{m(n+1)+r } \\xi^n \\left [ c_{r+2 } , \\ldots , c_m , c_1 , \\ldots , c_{m-1 } \\right ] u_{n } ( \\mathfrak{t}).\\end{aligned}\\ ] ]    it is well - known that the continuant @xmath398 $ ] is the determinant of the tridiagonal matrix with @xmath399 ,  , @xmath400 down the main diagonal , @xmath401 s in the diagonal just below , and @xmath60s in the diagonal just above .",
    "elsner and redheffer ( * ? ? ?",
    "* remark 5 ) compute the characteristic polynomials of general tridiagonal matrices whose number of rows has the form @xmath402 or @xmath403 when the entries down the diagonals have period @xmath294 .",
    "the identities for @xmath404 $ ] and @xmath405 $ ] follow by specializing the matrices to those with -1 s and 1 s below and above the diagonal , then taking the constant term of the characteristic polynomial .",
    "from , we have @xmath406 = \\left [ ( c_1 , \\ldots , c_m)^{(n+1,0 ) } \\right ] - c_m \\left [ ( c_1 , \\ldots , c_m)^{(n , m-1 ) } \\right].\\ ] ] substituting with the first two identities of the lemma , we obtain the final identity with @xmath396 .",
    "this forms the base case for an inductive proof of the general identity , working down from @xmath407 to @xmath395 .",
    "the inductive step uses the identity @xmath408 = \\left [ ( c_1 , \\ldots , c_m)^{(m , r+1 ) } \\right ] - c_{r+1 } \\left [ ( c_1 , \\ldots , c_m)^{(n , r ) } \\right]\\ ] ] for @xmath409 , but the details are left to the reader .",
    "suppose @xmath410 , and and set @xmath370 when @xmath129 is odd and @xmath371 when @xmath129 is even .",
    "we assume that @xmath177 and set @xmath411 + \\left [ q_2 , \\ldots , q_{l-2 } \\right ] \\right)\\\\",
    "\\mathfrak{t}_2 & = \\frac{\\xi}{2 } \\left ( \\left [ q_2 , \\ldots , q_{l-1 } , q_1 + q_l - 1 \\right ] + \\left [ q_3 , \\ldots , q_{l-1 } \\right ] \\right)\\\\      \\mathfrak{t}_3 & = \\frac{\\xi}{2 } \\left ( \\left [ q_3 , \\ldots , q_{l-1 } , q_1 + q_l - 1 , q_2 \\right ] + \\left [ q_4 , \\ldots , q_{l-1 } , q_1 + q_l - 1 \\right ] \\right).\\end{aligned}\\ ] ] ( the proof of the theorem when @xmath140 or @xmath412 is similar to what follows and will be omitted . )",
    "proposition [ p : formfrombeads ] shows the discriminant @xmath13 of @xmath413 is @xmath414 with @xmath415 - \\left [ q_1 - 1 , q_2 , \\ldots , q_{l-1 } , q_l - 1 \\right]\\ ] ]    we note that @xmath416 the equality @xmath417 follows from the computation , using , @xmath418 + \\left [ q_2 , \\ldots , q_{l-2 } \\right ] \\\\      & = ( q_1 + q_l - 1 ) \\left [ q_2 , \\ldots , q_{l-1 } \\right ] + \\left [ q_2 , \\ldots , q_{l-2 } \\right ] + \\left [ q_3 , \\ldots , q_{l-1 } \\right ] \\\\      & = \\left [ q_2 , \\ldots , q_{l-1 } , q_1+q_l - 1\\right ] + \\left [ q_3 , \\ldots , q_{l-1 } \\right].\\end{aligned}\\ ] ] then @xmath419 follows from @xmath417 , noting that the latter actually expresses a general identity for continuants . for the final equality , and show that @xmath420 - \\left [ q_1 - 1 , q_2 , \\ldots , q_{l-1 } , q_l - 1 \\right ] + \\left [ q_2 , \\ldots , q_l \\right ] \\\\      & = \\left [ q_1 - 1 , q_2 , \\ldots , q_{l-1 } \\right ] + q_l \\left [ q_2 , \\ldots , q_{l-1 } \\right ] + \\left [ q_2 , \\ldots , q_{l-2 } \\right ] \\\\      & = ( q_1 + q_l - 1 ) \\left [ q_2 , \\ldots , q_{l-1 } \\right ] + \\left [ q_2 , \\ldots , q_{l-2 } \\right ] + \\left [ q_3 , \\ldots , q_{l-1 } \\right]\\\\      & = \\left [ q_2 , \\ldots , q_{l-1 } , q_1 + q_l - 1 \\right ] + \\left [ q_3 , \\ldots , q_{l-1 } \\right ] = \\frac{2}{\\xi } \\mathfrak{t}_2.\\end{aligned}\\ ] ]    the @xmath100th solution @xmath306 of @xmath14 is given by .",
    "we must show that @xmath421 .",
    "we have @xmath422 let @xmath423 . +",
    "* the first coefficient . * if @xmath424 , then @xmath425 $ ] , and the first coefficient of @xmath426 is @xmath427 & = ( -1)^{(n-1)(l+1 ) } \\xi^{n-1 } u_{n-1 } ( \\mathfrak{t}_3 ) \\left [ q_3 , \\ldots , q_l \\right ]       = u_n \\cdot a\\end{aligned}\\ ] ] by lemmas [ l : chebsolutions ] and [ l : periodiccontinuant ] and .    if instead @xmath138 , then @xmath428 $ ] .",
    "recursions show that the first coefficient of @xmath429 is @xmath430 \\\\      & = ( q_1 - 1 ) q_l \\left [ ( q_2 , \\ldots q_{l-1 } , q_1 + q_l - 1)^{(n-1,l-2 ) } \\right ] + ( q_1 - 1 ) \\left [ ( q_2 , \\ldots , q_{l-1 } , q_1 + q_l - 1)^{(n-1 , l-3 ) } \\right]\\\\      & \\mathrel{\\phantom{= } } \\mathrel+ q_l \\left [ ( q_3 , \\ldots , q_{l-1 } , q_1 + q_l-1 , q_2)^{(n-1,l-3 ) } \\right ] + \\left [ ( q_3 , \\ldots , q_{l-1 } , q_1 + q_l - 1 , q_2)^{(n-1,l-4 ) } \\right]\\end{aligned}\\ ] ] we may rewrite the first two terms , using lemma [ l : periodiccontinuant ] and , as @xmath431 u_{n-1 } ( \\mathfrak{t}_2 ) \\notag \\\\      & \\mathrel{\\phantom{= } } \\mathrel+ ( q_1 - 1 ) \\left [ ( -1)^{nl+n } \\xi^{n } u_{n } ( \\mathfrak{t}_2 ) - ( -1)^{nl+n+l+1 } \\xi^{n-1 } \\left [ q_1 + q_l - 1 , q_2 , \\ldots , q_{l-1 } \\right ] u_{n-1 } ( \\mathfrak{t}_2 )   \\right ] \\notag\\\\      & = ( q_1 - 1 ) \\left [ ( -1)^{nl+n } \\xi^{n } u_{n } ( \\mathfrak{t}_2 ) -   ( -1)^{nl+n+l+1 } \\xi^{n-1 } \\left [ q_1 - 1 , q_2 , \\ldots , q_{l-1 } \\right ] u_{n-1 } ( \\mathfrak{t}_2 ) \\right].\\end{aligned}\\ ] ] we may rewrite the second two terms as @xmath432 u_{n-1 } ( \\mathfrak{t}_3 ) \\right)\\notag \\\\      & \\mathrel{\\phantom{= } } \\mathrel+ ( -1)^{nl+n+1 } \\xi^{n } ( q_1 + q_l - 1 ) u_{n } \\left ( \\mathfrak{t}_3 \\right ) \\notag \\\\      & \\mathrel{\\phantom{= } } \\mathrel- ( -1)^{nl+n+l } \\xi^{n-1 } \\left [ q_1 + q_l - 1 , q_2 , \\ldots , q_{l-1 } , q_1 + q_l - 1 \\right ] u_{n-1 } \\left ( \\mathfrak{t}_3 \\right).\\end{aligned}\\ ] ]    combining , , and , we obtain @xmath430 \\\\      & = ( -1)^{nl+n+l+1 } \\xi^{n-1 } \\left ( \\left [ q_1 + q_l - 1 , q_2 , \\ldots , q_{l-1 } , q_1 + q_l -1 \\right ] - q_l \\left [ q_2 , \\ldots , q_{l-1 } , q_1 + q_l - 1 \\right ] \\right.\\\\      & \\mathrel{\\phantom{= } } \\mathrel- \\left .",
    "( q_1 - 1 ) \\left [ q_1 - 1 , q_2 , \\ldots , q_{l-1 } \\right ]   \\right ) u_{n-1 } \\left ( \\tfrac{\\xi}{2 } a \\right)\\\\      & = ( -1)^{nl+n+l+1 } \\xi^{n-1 } \\left ( \\left [ q_1 - 1 , q_2 , \\ldots , q_{l-1 } , q_1 + q_l - 1 \\right ] - ( q_1 - 1 ) \\left [ q_1 - 1 , q_2 , \\ldots , q_{l-1 } \\right ] \\right ) u_{n-1 } ( \\tfrac{\\xi}{2 } a)\\\\      & = ( -1)^{nl+n+l+1 } \\xi^{n-1 } u_{n-1 } \\left(\\tfrac{\\xi}{2 } a \\right ) \\left [ q_1 - 1 , q_2 , \\ldots , q_l \\right].\\end{aligned}\\ ] ] this shows that the first coefficient of the form @xmath433 is @xmath434 . + * the last coefficient . *",
    "the symmetry shows that reversing the strings @xmath291 and @xmath435 switches the first and last coefficients of @xmath436 and @xmath437 , so this follows from the case done above . + * the discriminant . * since the middle coefficient of a form , when positive , is determined by the discriminant and the other two coefficients , we can finish the proof that @xmath438 by checking that both forms have the same discriminant .",
    "when @xmath57 and @xmath58 are greater than @xmath60 , we must then show that @xmath439 - \\left [ q_1 - 1 ,   ( q_2 , \\ldots , q_{l-1 } , q_1 + q_l - 1)^{(n-1,l-2 ) } , q_l-1 \\right ] \\right)^2 \\\\      & \\mathrel{\\phantom{= } } \\mathrel- ( -1)^{(l-1)n } \\cdot 4 \\\\      & = u_n^2   \\cdot \\delta = t_{n}^2 - ( -1)^{(l-1)n } \\cdot 4.\\end{aligned}\\ ] ] that is , we must show @xmath440 - \\left [ q_1 - 1 ,   ( q_2 , \\ldots , q_{l-1 } , q_1 + q_l - 1)^{(n-1,l-2 ) } , q_l-1 \\right ] \\\\      & = t_n = ( -1)^{nl+n } 2 \\xi^{n } t_{n } \\left ( \\tfrac{\\xi}{2 } a \\right).\\end{aligned}\\ ] ]    using , , and , if either of @xmath57 or @xmath58 is @xmath60 , we have @xmath440 - \\left [ q_1 - 1 ,   ( q_2 , \\ldots , q_{l-1 } , q_1 + q_l - 1)^{(n-1,l-2 ) } , q_l-1 \\right ] \\\\      &",
    "=   ( q_1 + q_l - 1 ) \\left [   ( q_2 , \\ldots , q_{l-1 } , q_1 + q_l - 1)^{(n-1,l-2 ) } \\right ] + \\left [ ( q_3 , \\ldots , q_{l-1 } , q_1 + q_l - 1 , q_2)^{(n-1,l-3 ) } \\right ] \\\\      & \\mathrel{\\phantom{= } } \\mathrel+ \\left [ ( q_2 , \\ldots , q_{l-1 } , q_1 + q_l - 1)^{(n-1,l-3 ) } \\right ] \\\\      & = \\left [ ( q_2 , \\ldots , q_{l-1 } , q_1 + q_l - 1)^{(n,0 ) } \\right ] + \\left [ \\left(q_1 + q_l - 1 , q_2 , \\ldots , q_{l-1 } \\right)^{(n,0 ) } \\right ] \\\\      & \\mathrel{\\phantom{= } } \\mathrel- ( q_1 + q_l - 1 ) \\left [   ( q_2 , \\ldots , q_{l-1 } , q_1 + q_l - 1)^{(n-1,l-2 ) } \\right].\\end{aligned}\\ ] ] at this point , even if @xmath139 or @xmath169 , the continuants here have only positive entries .",
    "lemma [ l : periodiccontinuant ] and then show the above expression is equal to @xmath441 + \\left [ q_2 , \\ldots , q_{l-2 } \\right ] + ( q_1 + q_l - 1 )   \\left [ q_2 , \\ldots , q_{l-1 } \\right ] \\right)\\\\      & = 2 \\cdot ( -1)^{nl+n } \\xi^{n } u_{n } \\left(\\tfrac{\\xi}{2 } a \\right ) - ( -1)^{nl + n +",
    "l + 1 } \\xi^{n-1 } u_{n-1 }   \\left ( \\tfrac{\\xi}{2 } a \\right ) \\left ( \\left [ q_1 , \\ldots , q_l \\right ] - \\left [ q_1 - 1 , q_2 , \\ldots , q_{l-1 } , q_l - 1 \\right ] \\right)\\\\      & = ( -1)^{nl+n}2\\xi^{n } \\left ( u_{n } \\left(\\tfrac{\\xi}{2 } a\\right ) - \\frac{\\xi}{2 } a u_{n-1 } \\left(\\tfrac{\\xi}{2 } a\\right ) \\right)\\\\      & = ( -1)^{nl+n}2\\xi^{n } t_{n } \\left(\\tfrac{\\xi}{2 } a\\right).\\end{aligned}\\ ] ] ( the final equality uses the first relation of . ) putting everything together , we have shown that @xmath440 - \\left [ q_1 - 1 ,   ( q_2 , \\ldots , q_{l-1 } , q_1 + q_l - 1)^{(n-1,l-2 ) } , q_l-1 \\right ] \\\\      & = ( -1)^{nl+n } 2 \\xi^{n } t_{n } \\left ( \\tfrac{\\xi}{2 } a \\right ) = t_n,\\end{aligned}\\ ] ] and the theorem is proved .",
    "recall that the stars - and - bars map @xmath97 sends the set of nonempty natural strings bijectively to the set of binary strings . in a moment",
    ", we will define a very similar map , also denoted @xmath97 , that sends the set of nonempty natural necklaces to the set of binary necklaces of weight @xmath442 . from theorem [ t : rotation ]",
    "we know @xmath50 induces a map that assigns such a binary necklace to each class of forms , so through @xmath443 we also have a way to assign a natural necklace to each class . in this section , we prove that this natural necklace is the same as that discussed in the introduction , that is , the necklace arising from the minimal period of a quadratic irrationality associated with a form in the class .",
    "we then show that the binary necklace of a class also has an interpretation as the minimal period of a denjoy continued fraction .    to define @xmath97 on a nonempty natural necklace , we sum the beads in the necklace and arrange that number of stars around a circle . insert bars between stars so they are bunched into groups whose sizes match the sequence of necklace beads .",
    "replace each bar with ` 1 ' and each empty gap between stars with ` 0 ' , then remove all the stars to obtain a binary necklace .",
    "the number of beads is the number of bars , so the binary necklace will have weight @xmath442 .",
    "it is readily checked that this is a bijection .",
    "we have the diagram +    & [ -10pt ] & + & &     + here , @xmath50 and @xmath123 are the string and necklace constructions from section [ s : construction ] ; @xmath443 reverses the stars - and - bars construction , either on a string on a necklace ; and `` connect '' indicates looping around the two ends of a binary string into a circle and connecting them .",
    "note that @xmath444 .",
    "( the results of this section do not use the coloration of alternating necklaces ; we will ignore colors until section [ s : gzcompare ] . )    to compute @xmath445 , we arrange beads labeled @xmath57 , ",
    ", @xmath58 around a circle and then replace the adjacent @xmath57 and @xmath58 beads with the single bead @xmath446 .    throughout this section ,",
    "if @xmath447 is a form , we set @xmath448    [ t : qinecklace ] let @xmath447 be a primitive z - reduced form of discriminant @xmath13 .",
    "if @xmath121 is the minimal period of the regular continued fraction expansion of @xmath449 , we have an equality of natural necklaces @xmath450    the theorem follows immediately from the following proposition    [ p : qinecklace ] let @xmath447 be a primitive z - reduced form of discriminant @xmath13 .",
    "suppose that the regular continued fraction expansion of @xmath449 has sequence of quotients of the form @xmath451 with minimal period @xmath452 .    if @xmath138 , then @xmath453 , @xmath454 , and @xmath455 z - reducing @xmath45 transports to the following operation on the continued fraction expansion : @xmath456 if @xmath139 , then @xmath140 , @xmath457 , and @xmath458 z - reducing @xmath45 transports to the following operation on the continued fraction expansion : @xmath459    these transformation rules reflect the action of the operator @xmath132 described just before lemma [ l : beading ] .",
    "the proof of theorem [ t : qinecklace ] will require the standard lemma :    [ l : hwlemma ] if @xmath460 where @xmath461 and @xmath462 , @xmath463 , @xmath464 , and @xmath465 are integers such that @xmath466 then @xmath467 and @xmath468 are two consecutive convergents to the simple continued fraction whose value is @xmath469 . if @xmath467 is the @xmath470th convergent , and @xmath468 the @xmath100th , then @xmath471 is the @xmath472 * complete quotient * ( i.e. , the number whose continued fraction is that of @xmath469 with the first @xmath100 partial quotients removed . )    we verify some special cases first .",
    "when @xmath473 , we have @xmath474 . for @xmath475 , we have @xmath476 .",
    "it is readily checked that the continued fraction expansions of @xmath449 and @xmath477 have quotient sequences @xmath478 and @xmath479 .",
    "zagier reduction sends @xmath45 to @xmath480 , and the continued fraction expansion of @xmath481 has quotient sequence @xmath482 ( or @xmath483 , when @xmath253 ) .",
    "also , @xmath324 is fixed under zagier - reduction . from these observations",
    "we see that the proposition holds when @xmath484 and @xmath485 or when @xmath486 .",
    "we assume from now on that we are not in either of these cases .",
    "in particular , @xmath487 .",
    "the bead sequence @xmath44 is computed by solving @xmath14 for the fundamental solution and then expanding @xmath488 in a continued fraction .",
    "suppose first that @xmath138 . to show that @xmath44 begins with a @xmath60",
    ", we will show that @xmath489 .",
    "since @xmath138 , we have @xmath490 . since @xmath487 , @xmath491",
    "since @xmath492 is an integer , we have @xmath493 .",
    "thus , @xmath494 observe that @xmath47 and @xmath495 are coprime since @xmath496 thus , if @xmath497 , then @xmath257 , and @xmath498 , so @xmath236 and @xmath499 , contradicting our hypothesis .",
    "conversely , if @xmath44 begins with a @xmath60 , then @xmath500 .",
    "since @xmath501 and @xmath502 , it follows that @xmath503 .",
    "thus , @xmath490 and @xmath504 .",
    "let us continue to suppose that @xmath138 and see that @xmath505 has a purely periodic continued fraction expansion .",
    "we apply lemma [ l : hwlemma ] with @xmath506 , @xmath507 , @xmath508 , @xmath509 , and @xmath510 .",
    "we first check that @xmath511 that is , @xmath512 since @xmath513 , the trace is right , and we readily check that @xmath514    next , we note that @xmath515 is equivalent to @xmath516 .",
    "this follows from since we are assuming @xmath517 .",
    "furthermore , @xmath518 since @xmath45 is z - reduced , @xmath519 , so @xmath520 , and thus , @xmath521 .",
    "equality can only happen if @xmath522 and @xmath258 , which we assumed is not the case .",
    "thus , @xmath523 .",
    "all of the assumptions of the lemma are met , and we conclude that the continued fraction expansion of @xmath96 is purely periodic .",
    "further , the partial quotients of a period are given by the quotients in the continued fraction expansion of @xmath524 .",
    "that is , if @xmath525 , then the sequence @xmath526 forms a period of the continued fraction expansion of @xmath96 . by theorem [ t : primitivity ] , the binary necklace @xmath527 is primitive , and it is readily checked that then the natural necklace @xmath528 is too .",
    "hence , the sequence @xmath526 actually gives the fundamental period of @xmath96 .",
    "the expression for @xmath44 in the case @xmath138 has now been verified .    to verify the transformation rules , we begin by computing the form obtained by z - reducing @xmath45 .",
    "it is @xmath529 it is readily checked that @xmath530 the identity @xmath531 then shows @xmath532 furthermore , @xmath533 this latter is the second complete quotient of @xmath449 .",
    "it has already been shown that this tail is a purely periodic continued fraction expansion with sequence of quotients @xmath534 .",
    "the transformation rules for the case @xmath138 are then readily checked .",
    "let us consider now the case @xmath139 in the theorem .",
    "assume for now that we know the continued fraction expansion of @xmath449 has quotients of the form @xmath535 .",
    "the right side of then has continued fraction expansion with quotients @xmath536 , the work above still applies , and the transformation rules are readily checked .",
    "lemma [ l : beading ] shows that every cycle of z - reduced forms contains a form @xmath45 such that @xmath44 begins with @xmath60 , and we have already proved the theorem for this @xmath45 . we will now check that the theorem holds for every form in the cycle of @xmath45 , proceeding inductively , and the proof will be complete .",
    "suppose that @xmath537 is obtained from @xmath45 by reducing @xmath100 times and that the theorem holds for @xmath538 , @xmath539 .",
    "we have checked that the continued fraction expansion of @xmath540 transforms as in the theorem into the continued fraction expansion of @xmath541 .",
    "lemma [ l : beading ] tells us how to compute @xmath542 from @xmath543 .",
    "we may quickly check that if @xmath544 , then in each of the four cases @xmath138 , @xmath545 ; @xmath546 ; @xmath547 ; @xmath139 , @xmath504 , the bead sequence of @xmath542 is related to the continued fraction expansion of @xmath541 in the form specified in the theorem .",
    "thus , the theorem holds for every z - reduced form in the cycle , and the proof is complete .",
    "if @xmath45 is a z - reduced form , theorem [ t : qinecklace ] gives us a way to view @xmath44 as giving the minimal period of the continued fraction of @xmath449 .",
    "there is also a way to view @xmath83 as a minimal period , but of a denjoy continued fraction @xcite , @xcite .",
    "a * denjoy continued fraction * is an expression @xmath548 in which all quotients are @xmath59 or @xmath60 and such that the quotient sequence does not include two consecutive zeroes .",
    "if @xmath549 is an irrational number , then @xmath550 expands uniquely in a denjoy continued fraction as follows .",
    "set @xmath551 . for @xmath552 , we define @xmath553 and @xmath554 recursively by setting @xmath555 and @xmath556",
    ".    we can deal with convergents whose final quotient is @xmath59 by making the replacement @xmath557    the replacement rule @xmath558 lets us transform the sequence of quotients of a denjoy continued fraction into the sequence of quotients of the regular continued fraction .",
    "a denjoy continued fraction whose quotient sequence has the tail @xmath559 converges to a rational number .",
    "thus , when considering the denjoy expansion of an irrational number , every @xmath59 after the initial term is contained in a maximal subsequence of the form @xmath560 . replacing each such subsequence by @xmath326 , where @xmath561 is the number of zeroes in the subsequence , gives the corresponding regular continued fraction . inverting this process",
    "lets us go from a regular continued fraction back to a denjoy continued fraction .    from the criterion for periodicity of a regular continued fraction ,",
    "we obtain :    the sequence of quotients of the denjoy continued fraction of an irrational number @xmath550 is eventually periodic if and only if @xmath550 is a quadratic irrational .",
    "the rest of this section takes up the analogue of theorem [ t : qinecklace ] for the map @xmath50 .",
    "[ t : denjoy ] if @xmath447 is a z - reduced form of discriminant @xmath13 , then the quotient sequence of the denjoy continued fraction of @xmath562 is purely periodic .",
    "the minimal period is the binary string obtained from @xmath83 by replacing each 0 by 01 .",
    "it may have been better to define @xmath50 to be the map that produces the string in the theorem , but simplifying theorem [ t : denjoy ] did not by itself seem a compelling reason to introduce this complication .",
    "it is known @xcite that the quotient sequence of the negative continued fraction of @xmath449 is purely periodic if and only if @xmath45 is z - reduced , and that these conditions are equivalent to @xmath563 , @xmath564 , where @xmath481 is the conjugate of @xmath550 .    for convenience ,",
    "let us write @xmath565 .",
    "then @xmath566 and the theorem says that these conditions are sufficient for the denjoy continued fraction expansion of @xmath33 to be purely periodic with minimal period ending in @xmath60 .",
    "the surjectivity of @xmath50 shows that the conditions are also necessary .",
    "suppose now that @xmath550 has a denjoy continued fraction that is purely periodic with minimal period ending in zero .",
    "prepending a @xmath59 gives the sequence of quotients of another purely periodic denjoy continued fraction , this time with minimal period ending in @xmath60 . from this follows the inequalities @xmath567 and @xmath568 .",
    "combined with the earlier inequalities , we find the criterion : a quadratic irraitonality @xmath550 has purely periodic denjoy continued fraction expansion if and only if @xmath569    from proposition [ p : qinecklace ] , the quotient sequence of the regular continued fraction expansion of @xmath562 has one of the forms @xmath570 let us call these `` case 1 '' and `` case 2 '' respectively . in the first case , we have @xmath571 , and in the second case , @xmath572 with @xmath573 .",
    "thus @xmath83 has one of the forms @xmath574 in which @xmath575 indicates a run of @xmath576 zeroes .    in case 1 , the denjoy continued fraction expansion of @xmath577 is purely periodic with minimal period @xmath578 where @xmath579 represents the @xmath326-fold self - concatenation of the string @xmath580 .",
    "excising the 1 following every 0 gives the first of the strings . in case 2 , the denjoy continued fraction is purely periodic with minimal period @xmath581 excising the 1 following every 0 then gives the second of the strings .",
    "this section clarifies the simple relationship between the beading map @xmath49 and dirichlet s map @xmath33 and justifies the statement that zagier - reduction refines gauss - reduction .",
    "we also deduce the main properties of @xmath33 from the analogous properties of @xmath49 and @xmath50 .",
    "our presentation of gauss - reduction is a modification of the usual algorithm , moving through the cycle of reduced forms in the reverse direction .",
    "this puts the algorithm in a form parallel to zagier s algorithm , which is necessary for the statement of theorem [ t : reductionrelation ] .",
    "we will only apply gauss s reduction algorithm to g - reduced forms . recall that these forms were defined in definition [ d : reduced ] .",
    "so , suppose @xmath447 is g - reduced .",
    "compute @xmath582 such that @xmath583 with the sign of @xmath582 chosen so that @xmath584 .",
    "our version of gauss s reduction operator sends @xmath45 to the form @xmath585 .",
    "this switches the sign of @xmath164 .",
    "* @xmath20 be the set of nonempty natural strings , * @xmath38 be the set of natural strings of length @xmath39 , * @xmath40 be the set of binary strings of weight @xmath442 , * @xmath17 be the set of all gauss - reduced forms , * @xmath586 , * @xmath587 , and * @xmath37 be the set of all z - reduced forms .",
    "recall that @xmath588 is the domain of @xmath33 . in every indefinite class ,",
    "the number of g - reduced forms is even , and half have @xmath18 .",
    "the restriction @xmath18 arises naturally in the following context : z - reduced forms are in bijection with quadratic irrationalities having purely - periodic negative continued fraction expansion .",
    "the corresponding statement about gauss - reduced forms is only true if we restrict to forms with @xmath18 .",
    "* @xmath591 , which prepends a @xmath60 to @xmath592 , * @xmath593 , which appends a @xmath60 to @xmath592 , * @xmath594 , defined so that @xmath595 , * @xmath596 , defined so that @xmath597 , * @xmath598 defined by . * @xmath599 defined by , * @xmath600 , defined so that @xmath601 , * @xmath602 , the gauss - reduction operator , * @xmath603 , the zagier - reduction operator .",
    "we also define an operator @xmath604 on the set of all binary quadratic forms by @xmath605 .",
    "the reader should note from context whether @xmath604 is being applied to a string or to a form .",
    "please note as well    * @xmath604 , @xmath606 , and @xmath607 induce maps @xmath608 and @xmath609 ( which we denote also with @xmath604 , @xmath606 , and @xmath607 ) , * @xmath45 and @xmath610 are equivalent forms , * @xmath45 and @xmath611 are equivalent if @xmath45 is in a class of odd weight , but otherwise are in different classes , * @xmath45 and @xmath612 are in inverse classes in the class group .",
    "let @xmath616 have discriminant @xmath13 , and let @xmath15 be the fundamental solution of @xmath14 .",
    "if @xmath23 , then @xmath617 is the sequence of partial quotients when expanding @xmath618 in a continued fraction .",
    "since @xmath619 we have @xmath620 , @xmath621 , and @xmath622 , so also @xmath623 $ ] and @xmath624 $ ] . from , we then have @xmath625 = ( -1)^{l+1 } \\pmod{z}$ ] , and it follows that @xmath626 \\pmod{z}.\\ ] ]    we show now that @xmath627 and @xmath628 $ ] are both between @xmath60 and @xmath163 .",
    "this is clear for the latter , and @xmath629 since @xmath613 .",
    "let us suppose that @xmath630",
    ". then implies @xmath631 , so @xmath632 .",
    "squaring both sides and simplifying , we deduce @xmath633 since @xmath613 , we know the right side is positive .",
    "then @xmath281 and we have equality , so @xmath634 and @xmath635 .",
    "also , @xmath253 , @xmath636 , so @xmath637 and @xmath638 .",
    "then @xmath639 , contradicting the assumption that @xmath630 .",
    "we now know that @xmath627 and @xmath628 $ ] are both between @xmath60 and @xmath163 . in light of",
    ", they are equal . from , @xmath640 $ ] and @xmath641 $ ] .",
    "to compute @xmath642 , we expand @xmath643 in a continued fraction with quotient sequence of length parity @xmath129 .",
    "thus , @xmath644 , and the proof of ( i ) is complete .",
    "we omit the details of the very similar argument that proves ( ii ) .",
    "[ t : xi ] the following diagrams commute @xmath645{r}{\\mu } \\arrow{d}{\\gamma } & z \\arrow{d}{\\beta } & \\\\ s_1 \\arrow[hookrightarrow]{r}{\\eta^+ } & s_2 \\arrow[hookrightarrow]{r}{\\mathrm{sb } } & b_1    \\end{tikzcd } \\qquad     \\begin{tikzcd }      g^- \\arrow[hookrightarrow]{r}{\\mu } \\arrow{d}{\\gamma \\circ \\rho } & z \\arrow{d}{\\beta } & \\\\",
    "s_1 \\arrow[hookrightarrow]{r}{\\eta^- } & s_2 \\arrow[hookrightarrow]{r}{\\mathrm{sb } } & b_1    \\end{tikzcd}\\ ] ] the maps drawn with horizontal arrows are injections , and the ones drawn with vertical arrows are surjections ( @xmath97 is a bijection ) . also , @xmath646 a section of @xmath49 is the map @xmath218 of , while a section of @xmath33 is the map @xmath647 with @xmath648\\\\      b & = \\phantom{- } \\left [ q_1 , q_2 , \\ldots , q_l \\right ] - \\left [ q_2 , \\ldots , q_{l-1 } \\right]\\\\      c & = - \\left [ q_1 , \\ldots , q_{l-1 } \\right]\\end{aligned}\\ ] ] the form @xmath1 has discriminant @xmath220 + \\left [ q_2,\\ldots , q_{l-1 } \\right ] \\right)^2 + ( -1)^{l+1 } \\cdot 4,\\ ] ] and the image of @xmath550 is the set of forms in @xmath588 with discriminants of the form @xmath147 .    it is readily checked that if @xmath649 , then @xmath650 , so @xmath651 is defined .",
    "let us consider how to compute @xmath652",
    ". if @xmath45 has discriminant @xmath13 , we first compute the fundamental solution of @xmath14 , then set @xmath653 , and expand @xmath654 in a continued fraction  use the quotient sequence of even length if @xmath25 and odd if @xmath281 . if the resulting string is @xmath51 , we find @xmath655 .",
    "to compute @xmath656 , since @xmath657 also has discriminant @xmath13 , we set @xmath658 , then expand @xmath659 in a continued fraction with quotient sequence of length parity @xmath660 . as observed in the proof of lemma",
    "[ l : beading ] , the quotient sequence of the expansion of @xmath659 is obtained by pinching both ends of the quotient sequence of the expansion of @xmath661 . comparing @xmath662 and @xmath163",
    ", we see that @xmath661 expands as a continued fraction with quotient sequence @xmath663 .",
    "thus , @xmath651 is found by pinching both ends of @xmath663 , or it would be except that the length parity is wrong .",
    "changing the length parity is accomplished by switching between the two continued fraction expansions of @xmath659 , and that is done by pinching the right end of the quotient sequence .",
    "thus , @xmath664 and the diagram commutes .      it is easily verified that @xmath670 , and @xmath671 are injections and that restricting @xmath87 to @xmath588 or @xmath672 gives an injection .",
    "proposition [ p : formfrombeads ] states that @xmath49 is a surjection with section @xmath218 .",
    "let us now verify that that @xmath673 .",
    "suppose @xmath674 is a nonempty natural string and that @xmath447 is a z - reduced form such that @xmath675 then @xmath45 is in @xmath676 if and only if @xmath677 is g - reduced .",
    "since @xmath45 is z - reduced , we have @xmath678 .",
    "we must check also that @xmath679 . since @xmath89",
    ", it suffices to show @xmath680 .",
    "since @xmath45 is z - reduced , we have @xmath681 , so @xmath682 is immediate if @xmath683",
    ". we may thus assume @xmath684 .",
    "if @xmath45 has discriminant @xmath13 and @xmath15 is the fundamental solution of @xmath14 , then @xmath44 is computed by setting @xmath23 and expanding @xmath43 in a continued fraction . from , the first quotient is @xmath60 , so either @xmath685 or @xmath686 . if @xmath685 , then @xmath687 and @xmath688",
    "otherwise , @xmath689 and we have assumed the left side is nonnegative . squaring both sides and using the definition of @xmath15 , we find @xmath690 but @xmath691 , and @xmath45 can not take the value @xmath59 since its discriminant is nonsquare .",
    "the desired inequaltiy @xmath680 follows , and we have shown @xmath692 .",
    "the reverse inclusion follows from the commutativity of the first diagram .",
    "if instead @xmath693 , then proposition [ p : reversal ] shows @xmath694 . since @xmath695 , we have @xmath696 for some @xmath697 , hence @xmath698 , hence @xmath699 .",
    "thus , @xmath700 , and the reverse inclusion again follows by commutativity .",
    "we now check that @xmath550 is a section of @xmath33 .",
    "if @xmath674 is in @xmath20 , then @xmath701 with @xmath702,\\\\      b ' & = \\left [ q_1 + 1 , q_2 , \\ldots , q_l \\right ] + \\left [ q_2 , \\ldots , q_{l-1 } , q_l - 1 \\right ] , \\\\",
    "c ' & = \\left [ q_1 + 1 , q_2 , \\ldots , q_{l-1 } , q_l - 1 \\right ] .",
    "\\end{aligned}\\ ] ] this is in @xmath703 , so equals @xmath704 for @xmath705 a few applications of shows that @xmath324 is the form @xmath706 in the theorem .",
    "diagram chasing then proves @xmath707 .",
    "this also shows that @xmath33 is a surjection .",
    "proposition [ p : formfrombeads ] shows that @xmath708 has discriminant @xmath709 - \\left [ q_2 , \\ldots , q_l - 1 \\right])^2 + ( -1)^{l+1 } \\cdot 4.\\ ] ] but @xmath710 has the same discriminant , and the formula for the discriminant of @xmath706 in the theorem appears with a couple applications of .",
    "this shows that @xmath711 is contained in the set of forms in @xmath588 with discriminant of the form @xmath147 .",
    "conversely , if @xmath45 is such a form , we have just shown @xmath712 is the unique form in @xmath697 with @xmath713 .",
    "but @xmath714 so @xmath715",
    ".      suppose @xmath45 has discriminant @xmath13 and let @xmath15 be the fundamental solution of @xmath14 .",
    "since @xmath607 commutes with scalar multiplication , lemma [ l : reducetouf ] shows that it suffices to prove the lemma when @xmath634 and @xmath45 has discriminant @xmath719 .    from theorem",
    "[ t : xi ] , we have @xmath720 , @xmath721 + \\left [ q_2 , \\ldots , q_{l-1 } \\right]$ ] , and thus @xmath722 , \\qquad       \\frac{t+b}{2 } = \\left [ q_1 , \\ldots , q_l \\right ] , \\qquad \\frac{t - b}{2 } = \\left [ q_2 , \\ldots , q_{l-1 } \\right].\\ ] ]    we verify that @xmath723 when @xmath453 , this reduces to @xmath724 , so let us assume that @xmath168 .",
    "we readily check that @xmath725 - \\left [ q_3 , \\ldots , q_l \\right]$ ] , and then @xmath726 < ( q_1 + 1 ) ( a(q_1 + 1 ) - b).\\ ] ] multiplying through by @xmath727 $ ] and using , we obtain @xmath728 and follows . the discriminant of @xmath45 is @xmath729 , so since @xmath730 , we have @xmath731 and the lemma follows .",
    "let @xmath45 have discriminant @xmath13 and let @xmath15 be the fundamental solution of @xmath14 .",
    "noting that @xmath607 and @xmath606 commute with scalar multiplication , we find using lemma [ l : reducetouf ] that @xmath734 and @xmath735 .",
    "thus , in proving the first relation , we may assume without loss of generality that @xmath45 has discriminant @xmath719 and @xmath736 .",
    "suppose that @xmath447 and @xmath717 .",
    "theorem [ t : xi ] shows that @xmath720 , @xmath721 + \\left [ q_2 , \\ldots , q_{l-1 } \\right]$ ] , and thus @xmath722 , \\qquad       \\frac{t+b}{2 } = \\left [ q_1 , \\ldots , q_l \\right ] , \\qquad \\frac{t - b}{2 } = \\left [ q_2 , \\ldots , q_{l-1 } \\right].\\ ] ]    from lemma [ l : firstcoefficient ] , we have @xmath737 .",
    "this form has discriminant @xmath719 , so we compute @xmath738 by setting @xmath739 + q_1 \\left [ q_2 , \\ldots , q_l \\right ] = \\left [ q_2 , \\ldots , q_{l } , q_1 \\right]\\ ] ] and expanding @xmath740 in a continued fraction .",
    "this denominator equals @xmath741 + q_1 \\left [ q_1 , \\ldots , q_l \\right ] - q_1 \\left [ q_2 , \\ldots , q_{l-1 } \\right ] + \\left [ q_1 , \\ldots , q_{l-1 } \\right ] \\\\      & = q_1 \\left [ q_3 , \\ldots , q_l \\right ] + \\left [ q_3 , \\ldots , q_{l-1 } \\right ] = \\left [ q_3 , \\ldots , q_l , q_1 \\right].\\end{aligned}\\ ] ] thus , @xmath742        on the other hand , the third relation and lemma [ l : beading ] give @xmath747 it follows from theorem [ t : primitivity ] that @xmath49 is a bijection between the set of all z - reduced forms with discriminants of the form @xmath147 and @xmath38 , and the final two relations follow .    [",
    "c : munotinjective ] if @xmath45 and @xmath324 are g - reduced forms such that @xmath748 , then one of @xmath45 and @xmath324 is in @xmath588 and the other is in @xmath672 .",
    "if @xmath749 , then @xmath750 conversely , if @xmath749 and @xmath751 , then @xmath748 .    as in the proof of theorem [ t : reductionrelation",
    "] , we reduce immediately to the case when @xmath45 and @xmath324 have discriminants of the form @xmath719 . to verify the first statement",
    ", we examine and observe that @xmath87 is injective when restricted to either @xmath588 or @xmath672 .",
    "so suppose @xmath749 and @xmath649 and @xmath748 .",
    "we apply @xmath49 and use theorem [ t : xi ] to obtain @xmath752 there exists then a natural string @xmath121 such that @xmath753 and @xmath754 , so @xmath755 theorem [ t : xi ] shows that @xmath33 is a bijection when restricted to forms with discriminants of the form @xmath719 , so @xmath756 .",
    "let @xmath757 . since @xmath758 , lemma [ l : firstcoefficient ] shows that @xmath759 , and @xmath760 follows .",
    "the corollary can be proved directly . if @xmath106 , @xmath761 and @xmath762 , @xmath763 , then @xmath748 leads to the relations @xmath764 , @xmath765 , and @xmath766 .",
    "these readily imply @xmath767 , and from this , @xmath751 .",
    "it can then be shown that @xmath768 .",
    "the corollary is visually evident from the conway topograph of @xmath91 once we learn how to see g- and z - reduced forms : g - reduced forms correspond to `` riverbends '' @xcite and z - reduced forms correspond to `` positive confluences '' , i.e. , inlets to the river from the side with positive numbers .",
    "every riverbend is adjacent to exactly one positive confluence , and @xmath87 maps the corresponding g - reduced form to the corresponding z - reduced form .",
    "pairs of forms that have the same image under @xmath87 correspond to adjacent riverbends , and being adjacent forces the conditions of the corollary .",
    "if @xmath769 , theorem [ t : xi ] shows that @xmath770 .",
    "the quadratic irrationality corresponding to @xmath610 is @xmath771 .",
    "proposition [ p : qinecklace ] shows that this has continued fraction expansion of the form @xmath772 , and subtracting @xmath60 , the theorem follows .",
    "[ t : gscaledform ] suppose that @xmath773 is primitive of discriminant @xmath774 .",
    "let @xmath298 be the sequence of positive solutions of @xmath14 .",
    "let @xmath294 be a positive integer and let @xmath296 be the smallest positive integer such that @xmath294 divides @xmath775 . then @xmath776 is the @xmath296-fold self - concatenation of the primitive string @xmath26 .    by theorem [ t : xi ] , @xmath777 then @xmath610 is primitive of discriminant @xmath13 , so theorem [ t : scaledform ] shows @xmath778 is the @xmath296-fold self - concatenation of the primitive binary string @xmath779 , which begins with a @xmath60 .",
    "undoing @xmath780 , we can check that @xmath776 is the @xmath296-fold self - concatenation of @xmath781 .",
    "it is readily checked that @xmath121 is an imprimitive natural string if and only if @xmath782 is an imprimitive binary string , so @xmath26 is primitive .",
    "an * alternating natural string * is a natural string of even length written in two colors , with colors alternating as you traverse the sequence .",
    "an * alternating natural necklace * is an equivalence class of alternating natural strings under cyclic permutation .",
    "the * underlying necklace * is the natural necklace obtained by ignoring bead colors .",
    "a necklace of @xmath100 beads is * primitive * if the underlying necklace is primitive .",
    "suppose now that the class @xmath117 has even weight . in section [ s :",
    "construction ] , we made the convention that the output of @xmath527 has @xmath60s colored alternately so that when reading across @xmath83 from the left , the first @xmath60 encountered is colored @xmath122 .",
    "recall the map @xmath783 from section [ s : qi ] , which ties off a natural sequence to form a necklace . if @xmath121 is a binary string of even weight , then @xmath784 is a natural string of even length .",
    "we make the convention that when @xmath121 is an alternating binary string , then @xmath785 is an alternating natural necklace .",
    "we assume that the special bead formed by combining the two end beads of @xmath786 has the same color as the first @xmath60 in @xmath121 . when @xmath787 for some @xmath62 , the special bead is then colored @xmath788 .",
    "the relation @xmath789 implies that @xmath33 induces a map @xmath790 from classes of indefinite forms to natural necklaces .",
    "we make the convention that @xmath790 sends classes of even weight to alternating natural necklaces . for consistency with the above convention",
    ", the first bead of @xmath790 must be colored @xmath788 .",
    "[ t : gammaprimitivity ] if @xmath45 is a primitive form in @xmath588 , then @xmath26 is a primitive string , and @xmath33 restricts to a bijection between the set of primitive forms in @xmath588 and the set of ( nonempty ) primitive natural strings .",
    "there is an induced map @xmath790 from classes of indefinite forms to necklaces that restricts to a bijection between the set of primitive classes of odd weight and the set of natural necklaces of odd length and to a bijection between the set of primitive classes of even weight and the set of ( nonempty ) alternating natural necklaces .",
    "theorem [ t : gscaledform ] shows that @xmath33 maps primitive forms to primitive strings .",
    "let @xmath791 and @xmath792 be the sets of primitive forms in @xmath588 and @xmath37 , and let @xmath793 and @xmath794 be the sets of primitive strings in @xmath20 and @xmath40 . because content is a class invariant , @xmath87 maps @xmath791 into @xmath792 .",
    "for the rest of this proof , we restrict our maps as follows : @xmath795 theorem [ t : primitivity ] shows that @xmath50 is a bijection .",
    "the injectivity of @xmath33 follows from the first of diagrams and the injectivity of @xmath87 ( restricted to @xmath588 ) , @xmath670 , and @xmath50 .",
    "we now check that @xmath33 is surjective . if @xmath796 , then @xmath782 is primitive , and the surjectivity of @xmath50 lets us produce @xmath797 with @xmath798 .",
    "theorem [ t : xi ] implies @xmath799 , so there is @xmath697 with @xmath800 . then @xmath324 and @xmath45 are equivalent , so @xmath324 is primitive , and diagram chasing shows @xmath801 .",
    "the statements about @xmath790 follow immediately .",
    "we will now use theorem [ t : gammaprimitivity ] to draw conclusions about ideal classes and their necklaces .",
    "all forms @xmath802 of given discriminant @xmath13 are equivalent .",
    "let us call their equivalence class @xmath803 .",
    "recall that gauss s composition operation turns the primitive classes of discriminant @xmath13 into an abelian group .",
    "it can be shown that the order of @xmath803 in the class group is @xmath60 if @xmath803 has odd weight and @xmath115 if @xmath803 has even weight .",
    "it can also be shown that if @xmath91 is a primitive class of discriminant @xmath13 and @xmath804 , then @xmath805 , where the dot denotes composition . from the relation @xmath806 of theorem [ t : reductionrelation ] , we now obtain immediately    [ t : jdelta ] let @xmath91 denote a primitive class of indefinite forms of discriminant @xmath13 and even weight . then switching bead colors in the alternating necklace @xmath807 produces the necklace @xmath808 .",
    "choose @xmath813 . theorem [ t : gammaprimitivity ] and the relation @xmath814 from theorem [ t : reductionrelation ] immediately imply that @xmath33 restricts to a bijection @xmath815 the cardinality of the set on the left is @xmath816 .",
    "examining the stars and bars map , we see that the length of @xmath26 is the weight of @xmath91 . because @xmath91 is primitive , and hence @xmath817 is primitive , the cardinality of the set on the right is @xmath818 if @xmath818 is odd , and @xmath819 if @xmath818 is even .",
    "also , @xmath820 follows from theorem [ t : jdelta ] , and the proof of the formula for the weight is complete .",
    "now let @xmath821 .",
    "theorem [ t : primitivity ] implies that there is a bijection @xmath822 the cardinality of the set on the left is @xmath127 .",
    "let @xmath823 be the operator on binary strings defined in theorem [ t : rotation ] .",
    "the cardinality of the set on the right is the same as the cardinality of @xmath824 .",
    "if @xmath91 has odd weight , then @xmath825 passes through every cyclic permutation of @xmath826 for @xmath827 .",
    "if it has even weight , and if @xmath828 , then theorem [ t : xi ] shows @xmath829 , and from theorem [ t : jdelta ] we have @xmath830 the formula for @xmath129 follows .",
    "choose @xmath833 and let @xmath828 .",
    "then @xmath834 .",
    "also @xmath144 , and theorem [ t : xi ] shows that @xmath835 + [ q_2 , \\ldots , q_{l-1}]$ ] . by induction",
    ", one may prove the property of continuants @xmath836 \\geq \\sum_{i=1}^t a_i$ ] , so @xmath831 with strict inequality unless @xmath837 = 0 $ ] , that is , unless @xmath395 .",
    "but @xmath338 is the weight of @xmath91 , and the corollary now follows from proposition [ p : weightparity ] .",
    "corollary [ c : munotinjective ] shows that preimages of elements under @xmath87 have cardinality at most @xmath115 and that @xmath352 is the number of forms @xmath841 for which @xmath760 .",
    "if @xmath324 is such a form and @xmath842 , then @xmath843 and lemma [ l : firstcoefficient ] shows that @xmath844 . then @xmath845 implies that @xmath846 .",
    "conversely , if @xmath847 and @xmath848 , then @xmath760 .",
    "thus , @xmath352 is the number of forms @xmath849 for which @xmath850 .",
    "we then obtain the formulas in the corollary using the bijection .",
    "we conclude by proving the conjectures in @xcite .",
    "that paper introduced the map @xmath162 from the end of section [ s : construction ] and proved that if @xmath45 is z - reduced , then the sum of the entries of @xmath156 is invariant upon reducing @xmath45 .",
    "this new class invariant was called the `` sum invariant '' .",
    "the paper conjectured the following :    1 .   if @xmath91 is a class of discriminant @xmath851 with sum invariant @xmath100 and z - caliber @xmath852 , then @xmath853 for some odd integer @xmath854 .",
    "2 .   if @xmath855 , then the class is imprimitive .",
    "3 .   fix positive integers @xmath320 and @xmath157 such that @xmath856 is an odd integer .",
    "the number of classes with discriminant of the form @xmath857 that have caliber @xmath320 and sum invariant @xmath157 is equal to the number of primitive binary necklaces of length @xmath320 and odd weight .",
    "let @xmath91 be a primitive class of discriminant @xmath858 , and let @xmath803 be the class of the form @xmath859 of discriminant @xmath13 .",
    "then * @xmath91 and @xmath860 have the same sum @xmath861 ( here , the classes are being combined using gauss composition ) . *",
    "@xmath862 .",
    "let us denote the sum invariant , weight , and length of a class @xmath91 by @xmath863 , @xmath809 , and @xmath810 .",
    "if @xmath45 is a z - reduced form in @xmath91 , then since @xmath44 is obtained from @xmath156 by `` pinching '' both ends , we can compute @xmath863 as the sum of the entries of @xmath44 . through the stars and bars construction",
    ", we then see that @xmath864 .    _",
    "( i ) : _ let the length and weight of @xmath91 be @xmath129 and @xmath818 . choose a z - reduced form @xmath45 in @xmath91 and denote its content by @xmath100 .",
    "let @xmath865 be the class of the primitive form @xmath866 , and let @xmath867 and @xmath868 be its length and weight . by theorem [ t : primitivity ]",
    ", the necklace @xmath869 is primitive . by theorem [ t : scaledform ]",
    ", there is an @xmath338 such that @xmath83 is the @xmath338-fold self - concatenation of @xmath870 , so @xmath871 and @xmath872 .",
    "since @xmath91 has discriminant @xmath857 , @xmath818 is odd , hence @xmath338 is odd .        _",
    "( iii ) : _ let @xmath266 be the set of classes with discriminant of the form @xmath851 , caliber @xmath320 , and sum invariant @xmath157 , and let @xmath878 be the set of primitive binary necklaces of length @xmath320 and odd weight .",
    "suppose @xmath879 . from the proof of ( i ) ,",
    "if @xmath880 , then @xmath83 is the @xmath856-fold self - concatenation of a unique primitive binary string @xmath121 of odd weight and length @xmath320 .",
    "we therefore have a map from the set of z - reduced forms contained in classes in @xmath266 to primitive binary strings of length @xmath320 .",
    "it induces a well - defined map from @xmath266 to @xmath878 .",
    "this map is invertible . to define the inverse",
    ", we take a string representing a necklace in @xmath878 , form the @xmath856-fold self - concatenation of this string to obtain a string @xmath121 , and then compute the z - reduced form @xmath881 .",
    "this induces a well - defined map from @xmath878 to @xmath266 , which is readily checked to be the inverse of the other .    _",
    "( iv ) : _ first observe that @xmath882 , so the class @xmath803 is that from theorem [ t : jdelta ] .",
    "choose a form @xmath813 .",
    "theorems [ t : qinecklace ] and [ t : gammanatural ] show that the strings @xmath883 and @xmath26 represent the same natural necklace . if @xmath717 , then @xmath884 . if @xmath885 , then theorem [ t : jdelta ] shows that @xmath26 and @xmath886 represent the same natural necklace .",
    "we find arguing as above that @xmath887 .",
    "corollary [ c : zcaliber ] then shows @xmath888 .",
    "the inequality @xmath889 follows from corollary [ c : lengthbound ] .",
    "99 e. barbeau , _ pell s equation _ , springer - verlag , 2003 .",
    "j. conway , _ the sensual quadratic form _ , maa , 1997 .",
    "a. denjoy , complment a la notice publie en 1934 sur les travaux scientifiques de m. arnaud denjoy , hermann , paris 1942 .",
    "p. g. l. dirichlet , vereinfachung der theorie der binren quadratischen formen von positiver determinante , _ abh",
    ". k. akad .",
    "berlin _ , 1854 , 99115 .",
    "l. elsner and r. m. redheffer , remarks on band matrices , _ numer .",
    "_ * 10 * , 1967 , 153161 .",
    "g. frobenius , ber die reduktion der indefiniten binren quadratischen formen , _ sitz .- ber",
    ". d. k. pr .",
    "berlin _ , 1913 , 202211 .",
    "f. halter - koch , _",
    "quadratic irrationals : an introduction to classical number theory _ , crc press , 2013",
    ". g. h. hardy and e. m. wright , _ an introduction to the theory of numbers _",
    ", 6th edition , oxford university press , 2008 .",
    "m. iosifescu and c. kraaikamp , on denjoy s canonical continued fraction expansion , _ osaka j. math .",
    "_ , * 40 * no.1 , 2003 , 235244 .",
    "p. rzsa , on periodic continuants , _ linear algebra appl .",
    "_ * 2 * no . 2 , 1969 , 267274 .",
    "b. smith , reducing quadratic forms by kneading sequences , _",
    "* 17 * , 2014 , article 14.11.8",
    ". m. stern , ber die eigenschaften der periodischen negativen kettenbrche , welche die quadratwurzel aus einer ganzen positiven zahl darstellen , _ abh",
    ". der k. ges .",
    "zu gttingen _ * 12 * , 1864 , 348 . a. uluda , a. zeytin , m. durmu , binary quadratic forms as dessins , preprint , 22 pages .",
    "m. weissman , _ illustrated theory of numbers _",
    ", american mathematical society , 2017 .",
    "d. zagier , _ zetafunktionen und quadratische krper : eine einfhrung in die hhere zahlentheorie _ , springer - verlag , 1981 ."
  ],
  "abstract_text": [
    "<S> dirichlet s version of gauss s reduction theory for indefinite binary quadratic forms includes a map from gauss - reduced forms to strings of natural numbers . </S>",
    "<S> it attaches to a form the minimal period of the continued fraction of a quadratic irrationality associated with the form . </S>",
    "<S> when zagier developed his own reduction theory , parallel to dirichlet s , he omitted an analogue of this map . </S>",
    "<S> we define two new maps on zagier - reduced forms that together serve as this analogue . </S>",
    "<S> we also define a map from the set of gauss - reduced forms into the set of zagier - reduced forms that gives a near - embedding of the structure of gauss s reduction theory into that of zagier s . from this perspective </S>",
    "<S> , zagier - reduction becomes a refinement of gauss - reduction , and all of the important properties of dirichlet s map readily follow from the corresponding properties of the new maps . </S>"
  ]
}