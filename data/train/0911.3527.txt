{
  "article_text": [
    "exploring the high - dimensional conformational space of molecular systems has long been the focus of computer simulation studies .",
    "two challenges exist under this topic , _ i.e. _ , how to thoroughly sample the conformational space , and how to understand the equilibrium ( and dynamic ) properties based on lots of simulation data in hand .",
    "although standard monte - carlo ( mc ) and molecular - dynamics ( md ) simulation methods have been widely applied to sample the equilibrium conformational distribution , for many complex systems , such as glassy systems , phase - transition systems , and solvated biopolymers , sufficient sampling is by no means an easy task . with increased degrees of freedom and finite ( low ) temperature ,",
    "the potential energy landscapes of these systems are characterized by exponentially growing local energy minimums that are separated by large energy barriers ( compared to thermal energy @xmath0 , where @xmath1 is the boltzmann s constant and @xmath2 is the temperature ) .",
    "a rough energy landscape frequently traps the simulation trajectories in a small area of the conformational space , disapproving the thorough exploration of the whole space within limited simulation time .",
    "once this happens , the ergodicity of the simulation data is effectively broken , _",
    "e.g. _ , the time average of some physical quantities can not converge to their average values within the equilibrium ensemble . to overcome these difficulties , beyond the standard md and mc sampling algorithms , various advanced techniques  @xcite have been developed to more efficiently sample systems with rugged energy ( or free - energy ) surface .",
    "reviews of the advanced simulation techniques can be found in reference  @xcite .",
    "these methods can prominently accelerate the exploring in conformational spaces , while preserving the ability to reproduce the correct equilibrium distributions . despite the success already achieved ,",
    "it is still difficult to thoroughly investigate a practically interesting system even based on these advanced techniques .",
    "based on multiple parallel generated trajectories , the ensemble dynamics ( ed ) method  @xcite provides an alternative way for abridging the gap between simulation power and practical interest .",
    "benefiting from the growing power of massively distributed computation , the ed method can reduce the wall - clock time required for data production . furthermore ,",
    "if the ed trajectories were spawned from dispersively selected conformations , then compared to single - trajectory simulations , larger area in conformational space might be covered by the ed simulations within the same cpu time . besides , the multiple simulation trajectories that start from different conformational regions enable the ergodicity test of the simulation data .",
    "for example , the measure of ergodicity could be defined as  @xcite , @xmath3 where , @xmath4 denotes a set of physical quantities that are able to differentiate the possibly disconnected conformational regions . @xmath5 and @xmath6 are the time average of @xmath7 over the beginning @xmath8 time length of the trajectories that respectively start from conformation @xmath9 and @xmath10 . for ergodicity - broken simulations , @xmath11 will converge to a non - zero value without prominent decreasing in a limited simulation time , while for an ergodic and converged simulation , this function will relax to zero .    the proper analysis and understanding of the simulation data",
    "may be as important as the data sampling itself , particularly for complex systems with lots of degrees of freedom .",
    "except for testing the ergodicity of simulation data , the major purpose in data analyzing is to search for a coarse - grained description of the conformational space . in the traditional way , a few ( usually only one or two ) knowledge - based reaction coordinates ( or order parameters ) are first defined , then the equilibrium ( and dynamic ) properties of the system are achieved by mapping sampled conformations in the low - dimensional space spanned by the presumed reaction coordinates . however , this method may suffer from the arbitrariness in the selection of the reaction coordinates , and the oversimplified description of the system  @xcite .",
    "recently , a more systematic , conformation - network - based view of dynamics brings prominent improvement  @xcite . in the kinetic network models",
    ", the conformational space is divided into some meta - stable regions .",
    "if the transition events between these regions were approximated with first - order reactions , the whole system could be coarse - grained into a markov transition network  @xcite .",
    "more works about markov network can be found in the current review  @xcite .",
    "being theoretically transparent and inclusive of nearly all the useful information , the network model has received much attention .",
    "the three aspects of sufficient sampling , ergodicity testing , and data mining are quite relevant to each other .",
    "to establish such a network , it is necessary to thoroughly sample the conformational space and to suitably analyze the simulation data .",
    "the understanding of metastable states is definitely helpful for guarding more efficiently sampling . in the previous work  @xcite ,",
    "we have proposed a general method , weighted ensemble dynamics ( we d ) , as an integrated view of these challenges .",
    "we d is based on multiple short md ( or mc ) simulation trajectories , which are started from dispersively - chosen initial conformations , and generated under the same simulation condition ( such as the same hamiltonian , temperature , pressure , in one word , the same equations of motion ) .",
    "some of these trajectories may reach local equilibrium within metastable states , the other may happen transition between these states .",
    "although each single trajectory is too short to reach the global equilibrium , the trajectories as a whole may have covered whole the conformational space , and should be able to be combined to reproduce the equilibrium distribution of the system .",
    "the combined analysis of parallel trajectories already exists , such as the weighted histogram analysis method ( wham )  @xcite . in wham ,",
    "the energetic density of state ( dos ) of the simulation system is first estimated by analyzing several trajectories simulated at different temperatures , then the physical properties are derived out with the dos . for trajectories simulated under the same condition",
    ", we d provides a simpler way for combining trajectories , _ i.e. _ , specifying each trajectory a statistical weight .",
    "besides , we d is capable to establish the network of metastable states , as well as to test the ergodicity of simulation data .    in current paper , we will further improve and validate the we d method by : ( i ) discussing the approximations in we d and providing a practical scheme to select the unique adjustable parameter in we d ; ( ii ) providing an improvement of we d to depress the statistical errors ; ( iii ) illustrating the application of we d to some more extremal examples , such as , a system with a transition network among multiple states , a system with an entropic state ( _ i.e _ , a state with large entropy and long intrastate equilibration time ) , and the solvated alanine dipeptide simulated both at room temperature and at low temperature .",
    "we find that we d can correctly detect the topology of the transition network , predict the diffusion - like dynamical property for both the system with an entropic state and the dipeptide simulated at low temperature .",
    "more importantly , we apply we d to separately analyze effects of different aspects ( degrees of freedom , interactions etc . ) in metastable states and dynamics of complex systems , such as the solvent effects in the solvated dipeptide .",
    "these examples will serve as the references for the application of we d to more complicated systems .",
    "the article is organized as follows . in sect .",
    "[ sec : theory ] , we re - derive the central results of we d which was briefly presented in our previous paper  @xcite . in sect .",
    "[ sec : improve ] , we discuss approximations of we d , such as , the completeness of basis functions , the effects of the unique free parameter , and present some tactics for facilitating applications of we d to improve statistical errors . in sect .",
    "[ sec : results ] , we discuss the application of we d in solved dipeptide at room temperature and low temperature . a short conclusion",
    "is given in sect .",
    "[ sec : conclud ] .",
    "finally , different trajectory re - weighting methods , and application of we d in a system with multiple - state transition network and a system with entropic - dominated states are presented in the appendix .",
    "most of the simulation algorithms can fit into the framework of probability evolution , @xmath12 here @xmath13 is the probability density function of the system at time @xmath8 , with @xmath14 ( and @xmath15 ) denoting the generalized conformational coordinates .",
    "@xmath16 is the propagator of the system under the applied simulation algorithm .",
    "the initial probability density function , @xmath17 , is propagated to @xmath13 by @xmath16 , and will reach the stationary distribution , @xmath18 , with long enough @xmath8 .",
    "for instance , @xmath19 can be written as @xmath20 for a single - trajectory md simulation . here",
    "@xmath20 denotes a dirac @xmath21-function , and @xmath22 is the initial conformation of the simulation .",
    "if the trajectory is simulated in the canonical ensemble with temperature @xmath2 , the stationary distribution turns out to be the canonical equilibrium distribution @xmath23 $ ] . here",
    "@xmath24 , and @xmath25 is the potential energy of the system . in",
    "we d , multiple md ( or mc ) trajectories are independently generated from different initial conformations , @xmath26 , and with the same simulation condition , the initial distribution should be expressed as @xmath27 . in the following , we will focus on reconstructing the canonical equilibrium distribution @xmath28 with multiple md trajectories that are all with the @xmath29time length and are generated with the same equations of motion but arbitrarily chosen different initial conformations .",
    "except for the possible effect of insufficient sampling , the difference between the conformational distribution of all the multiple short trajectories and the equilibrium distribution @xmath28 solely comes from the particular selection of the initial conformations .",
    "since every trajectory is generated by the same simulation algorithm that keeps the desired equilibrium distribution , different conformations in a trajectory should contribute equally to the final stationary property .",
    "thus , we may specify each trajectory @xmath30 a statistical weight @xmath31 to mimic the equilibrium samples .",
    "then , the average of any physical quantity @xmath32 over the equilibrium distribution can be written as @xmath33 here @xmath34 and @xmath35 denote the average of @xmath32 over the @xmath30th trajectory and the equilibrium ensemble , respectively .",
    "summation is over all the trajectories . in practice",
    ", it is reasonable to discard the initial short ( local equilibrating ) segment of each trajectory in calculating averages in trajectories . with this scheme ,",
    "it is possible to estimate equilibrium properties of the system without demanding the equilibration of each trajectory . when distributed computation facility is available",
    ", we can independently generate lots of short trajectories in different computer at the same time , thus the wall - clock time required for converged results greatly decrease .",
    "of course , the examination of the convergence and ergodicity of simulation data , and a proper estimation of @xmath36 are crucial in application .    while the length of simulation trajectories , @xmath37 , is not very short , the conformational space could be divided into a few meta - stable regions , wherein a single @xmath29length trajectory could reach local ( inner - region ) equilibrium . in other words , a @xmath29length trajectory may visits one or more conformational regions , but it always reach local equilibrium in each of its visited regions , the inter - region equilibrium may not be reached due to the not long @xmath37 .",
    "thus , for trajectories that started from the same meta - stable region , the specified weights - although dependent on the initial conformations - should be approximately identical when reproducing the equilibrium properties . therefore , we could write @xmath38 where @xmath39 denotes the meta - stable region , in which the @xmath30th trajectory is started . instead of explicitly using eq .",
    "( [ eq : state - weight1 ] ) , we simply construct a new ensemble of conformations @xmath40 in practice .",
    "@xmath41 is constituted by the conformations in the initial @xmath42length of all the simulation trajectories . within short enough @xmath43 (",
    "compared to @xmath37 ) , each trajectory is supposed to be still exploring the same meta - stable conformational region which it started from , leading to the quite plausible conclusion that @xmath44 for all the meta - stable regions . here , @xmath45 denotes the meta - stable region in consideration ; @xmath46 denotes the probability density function of the conformations in @xmath41 .",
    "consequently , @xmath46 , instead of @xmath19 , could be used to estimate the trajectory weights as follows , @xmath47 here @xmath48 , @xmath49 denotes the average over the initial @xmath50length segment of the @xmath30th trajectory , _ i.e. _ , @xmath51 for any conformational function @xmath32 . here",
    "@xmath52 denotes the conformation at @xmath53 time in the @xmath30th trajectory .",
    "heuristically , by averaging @xmath54 over the initial short segment of each trajectory , we are calculating @xmath55 according to the initial regions of the trajectories , rather than solely by the initial conformations or explicitly by metastable region which the trajectory start from .",
    "although the analytical expression of @xmath46 is unknown , considering the general relation @xmath56 for any conformational function @xmath32 , we could linearly expand @xmath54 with a complete set of conformational functions ( also referred to as basis functions in the following ) @xmath57 , as @xmath58 with the expanded coefficients as @xmath59 due to the non - orthogonalization of basis functions @xmath60 , @xmath61 , which is the inverse of the variance - covariance matrix @xmath62 with @xmath63 denoting the average over @xmath41 samples , should be included . in eq .",
    "( [ eq : expand1 ] ) , the equilibrium ensemble average @xmath64 actually relies on the trajectory weights @xmath36 through eq .",
    "( [ eq : aver_w ] ) .",
    "thus , substituting eq .",
    "( [ eq : expand1 ] ) into eq .",
    "( [ eq : realw1 ] ) gives out the following self - consistent linear equations of @xmath36 , @xmath65 here @xmath66 , which can be thought a vector mapped from the @xmath30th trajectory , @xmath67 , and @xmath68 where @xmath69 , and @xmath70 .",
    "@xmath71 is the vector of trajectory weights .",
    "all the parameters in eq .",
    "( [ eq : asym_lin_eq ] ) could be calculated simply by averaging basis functions over simulation trajectories .",
    "since the current formulation is exempted from any information about @xmath19 , initial conformations could be arbitrarily selected from different sources , such as coarse - grained simulation , high - temperature simulation , experimental knowledge , or even theoretical conjecture ( possibly with short local - relaxation running before using as initial conformations of we d ) , then the conformational space could be more efficiently traversed and structured .    by minimizing the residual term @xmath72 , eq .",
    "( [ eq : asym_lin_eq ] ) can be written in a symmetric form , which is better for analytical treatment , @xmath73 thus , @xmath74 is the variance - covariance matrix of the trajectory - mapped vectors @xmath75 , with at least one zero - eigenvalue as the ground state of @xmath76 , since @xmath77 .",
    "if the ground state of @xmath76 is non - degenerate , @xmath78 is uniquely determined by eq .",
    "( [ eq : sym_lin_eq ] ) , and can be subsequently applied to reconstruct the equilibrium distribution of the system .",
    "however , it is possible the ground state of @xmath76 is degenerate , it indicates non - unique weights of trajectories for reconstructing equilibrium distribution .",
    "if the simulation trajectories separately visit some separated conformational regions , and there is not any trajectory connect with different regions by transition , the relative weights of the separated regions will be indeterminable from the trajectories .",
    "it is indeed the reason the weights of trajectories are non - unique .",
    "thus it is easy to know that the degree of degeneracy of the ground state equals to the number of the kinetically separated states of the system under the current simulation timescale . in practice",
    ", we usually align the eigenvectors of @xmath76 in terms of their corresponding eigenvalues with an increasing order .",
    "the eigenvalues of @xmath76 will grow from zero to @xmath79 , and the number of the eigenvalues that are obviously smaller than @xmath79 gives the number of kinetically isolated ( or partial - isolated ) states in the system under the timescale of the individual trajectory .",
    "the eigenvalues closed to @xmath79 corresponds to the statistical fluctuations of these simulation trajectories . by projecting the vectors , @xmath80 , to the @xmath76 eigenvectors with zero ( or near zero ) eigenvalues ,",
    "the trajectories are mapped into a low - dimensional space , where the non - transition trajectories in different states and the transition trajectories between these states can be identified easily .",
    "although the expansion in eq .  ( [ eq : expand1 ] ) is exact only while the basis set is complete , it is not necessary to include too many basis functions in we d .",
    "this is because only the mean values of @xmath54 over a large number of conformations rather than whole the high - dimensional function @xmath54 itself are required in eq .",
    "( [ eq : sym_lin_eq ] ) . in practice ,",
    "only physically relevant and important quantities of the system need to be selected as basis functions so that the different meta - stable conformational states are effectively distinguished .",
    "the selection does not demand much foreknowledge . for biological macromolecules ,",
    "the important inner coordinates , such as dihedral angles and some interesting atomic pair distances , could be chosen as basis functions to characterize the conformational motion .",
    "various physical quantities , such as the potential energy of the system , solute - solvent interactions , could also be included for the searching of related kinetic or thermodynamic phenomena .",
    "the variance - covariance matrix @xmath81 will ensure the consistent consideration of different classes of basis functions , and provide the measure of their relative importance ( after orthogonalizing the basis functions based on @xmath81 ) .",
    "in addition , the number of independent basis functions is also limited by the finite size of @xmath41 , thus more selected basis functions will be discarded after considering the matrix @xmath82 , then do not significantly contribute to final results .",
    "therefore , the errors due to finite basis functions might be relevant to the statistical errors of the finite samples . in principle",
    ", @xmath54 is a ( high - dimensional ) continuous function in the conformational space @xmath14 , in practice , it should be thought as discrete values of the function in the finite - size @xmath41 sample , @xmath83 , where @xmath84 , are conformations in the @xmath41 sample with the size @xmath85 .",
    "if supposing the conformational space can be divided into some meta - stable regions , since both @xmath46 and @xmath28 are proportion to the equilibrium distribution inside each meta - stable region , @xmath54 is almost a step function , which is constant inside each meta - stable conformational region .",
    "therefore , even no many basis functions in expansion of @xmath86 still may provide a correct estimate of weights of trajectories based on eq .",
    "( [ eq : sym_lin_eq ] ) .",
    "the difference between two samples ( or the corresponding probability density functions ) , such as @xmath87 and @xmath28 , can be measured as @xmath88 here the difference @xmath89 is non - negative .",
    "a nearly zero @xmath89 indicates the equivalence between @xmath87 and @xmath28 , and a larger @xmath89 claims the further necessity for re - weighting the simulation trajectories .",
    "it is worth to mention , since @xmath89 is asymmetric between @xmath87 and @xmath28 , it is not a normal distance between the two probability density functions ( or samples )  @xcite .",
    "considering eq .",
    "( [ eq : expand1 ] ) , an approximation of @xmath89 can be written as @xmath90 with a finite - size set of basis functions @xmath91 . with enough basis functions",
    "included , @xmath92 will approach @xmath93 , but will never exceed it . since @xmath93 is usually undeterminable , the reasonable method to assess the completeness of basis functions is to observe the behavior of @xmath92 itself .",
    "if enough basis functions in certain class , such as the functions of the dihedral angles of a protein molecule , have been included in calculation , @xmath92 should no longer increase with the number of basis functions , showing a saturation behavior .",
    "the reasoning is the same when multiple classes of basis functions are included . to calculate @xmath92 , the sample for equilibrium distribution @xmath28 , thus the trajectory weights @xmath36 , are necessary .",
    "we propose two methods to bypass this difficulty .",
    "first , before re - weighting , @xmath28 can be approximated by the trajectories with equally weighting , _",
    "i.e. _ , all @xmath36 are set to @xmath94 at this stage . with this approximation , we roughly select basis functions .",
    "second , after re - weighting , @xmath92 can be calculated with the resulting trajectory weights .",
    "this procedure can be used to test the former selection .",
    "if the rigorously calculated @xmath92 has reached its saturation region with previously roughly selected basis functions , the results should be satisfiable .",
    "however , this posterior examination is restricted to the cases that the trajectory weights can be uniquely determined . in practice , the distribution by equally weighting trajectories , denotes as @xmath95 , has the same local equilibrium characteristics in each meta - stable region as @xmath96 and @xmath97 , @xmath98 is similarly a step function , which is also constant in each meta - stable region , only the constant values are different from those of @xmath86 .",
    "thus we believe the a priori test is already enough , and the following results are all calculated by setting @xmath36 to @xmath94 .",
    "since the statistical errors exist due to the finite sample sizes , @xmath92 would not strictly stop growing with the number of basis functions , it just increases slowly compared to the initial growing phase with increasing basis functions .",
    "similarly , when large error occurs , @xmath92 may abnormally increase within the saturation region . to prevent large statistical errors , we design a scheme to get rid of the statistically unreliable basis functions .",
    "we can orthogonalize the functions @xmath99 , leading to the explicitly identifiable value and error contribution from the orthogonalized basis functions to @xmath92 . in current paper , we implement the gram - schmidt orthonogalization method to one - by - one derive out the set of orthogonalized basis functions @xmath100 , thus @xmath101 where @xmath102 to estimate the error of @xmath92 , we approximately estimate the error of @xmath103 , and combine them by @xmath104 here , @xmath105 denotes the statistical error of the quantity in brackets .",
    "@xmath106 can be estimated from @xmath107 and @xmath108 , which are the standard error of sample averaged quantities , and can be estimated by normal statistical methods .",
    "for each orthogonalized basis function , @xmath109 , if @xmath106 is larger than @xmath110 , _",
    "i.e. _ , the relative error of @xmath103 is larger than @xmath79 , this basis function will not be selected in expansion .",
    "one - by - one selection will give out the final basis function set and the estimated error of the completeness measure @xmath92 .    the scheme introduced here",
    "provides us the knowledge about how many basis functions are enough for we d calculation .",
    "after orthogonalization , the contribution of the basis functions to @xmath92 clearly reflect their relative importance in trajectory re - weighting .",
    "the basis functions that contribute more are more important for portraying the difference between @xmath46 and @xmath28 , and the ones that contribute quite small can be linearly expanded by other existing basis functions .",
    "furthermore , various kinds of basis functions can be safely added to investigate the related phenomena . for illustration",
    ", we will show that the basis functions of dihedral angles and those of inter - atomic distances can be consistently treated in calculation , and the effect of solvent on the conformation of biological macromolecules can be studied by additional basis functions characterizing the solute - solvent relation .",
    "there is only one free parameter in we d method , @xmath111 , for collecting the @xmath41 samples .",
    "large @xmath112 may bring systematical error to the estimated equilibrium properties , and small @xmath112 will reduce the sample number in @xmath41 , leading to a larger statistical uncertainty .",
    "@xmath113 is usually applied in the current work with satisfiable results obtained .",
    "we also point out that , for the purpose of discovering the states in conformational space , the results are not very sensitive to @xmath112 .",
    "@xmath43 actually reflects the timescale of the process that we are interested in . if it were set to the single trajectory length @xmath37 , then the trajectory weights solved by eq .",
    "( [ eq : sym_lin_eq ] ) will be equal to each other . in this case",
    ", we are focusing on the processes with a timescale much longer than @xmath37 , thus all the trajectories are still in the relaxation to local equilibrium , and should have the same weight . usually , if a system can be divided into several metastable states under the focused timescale , @xmath43 should be selected comparable to or smaller than the smallest life time of these states .",
    "given that the kinetic states of the system are frequently unknown , @xmath43 should be selected relatively short .",
    "at the zero limit of @xmath43 , the we d method turns into the classical method described by eq .",
    "( [ eq : weight_simp ] ) with larger weight fluctuation . in practice ,",
    "it is possible to use shorter and shorter @xmath43 and check the convergence of the re - weighted free energy surface . thus , a proper @xmath43 may be found as a compromise between correctness and statistical reliability ( small fluctuation of trajectory weights ) .",
    "another practical consideration is that , a few percent of @xmath37 would be the safe choice for @xmath43 .",
    "this is because the transition events with timescales prominently smaller than @xmath37 have reached equilibrium in single trajectory ( thus do not need re - weighting ) , we only need to focus on the ones with time - scales similar to or slightly smaller to @xmath37 . in here and former applications , we usually choose @xmath114 in the interval of @xmath115 $ ] , and the results are satisfiable",
    ". supposing the longest @xmath29comparable inter - state transition time is @xmath116 , if @xmath117 by a large margin , the simulation time would be longer than necessary , thus , the trajectories can be shortened to realize the considered case ( although it is not necessary ) .",
    "if @xmath118 by a large margin , it is quite possible that the conformational space is disconnected somewhere . with current simulation data , we can only obtain the knowledge of the state structure in conformational space , instead of the intact equilibrium properties of the system .",
    "the considered case will be true for connected sub - regions in the conformational space .",
    "we also notice that the state structure of the system is directly reflected from the eigenvalues of @xmath76 matrix , which is not sensitive to @xmath43 selection .",
    "thus , to detect the kinetic states of the system , @xmath43 need not to be very small .",
    "for this purpose , we can generate a few trajectories from each initial conformation , and specify the same weight to the trajectories from the same initial conformation .",
    "suppose there are @xmath119 initial conformations ( denoted as @xmath120 in the following ) , and @xmath121 trajectories initiated respectively from these initial conformations ( the total number of trajectories is still @xmath122 ) , eq .",
    "( [ eq : asym_lin_eq ] ) can be rewritten as @xmath123 where @xmath124 is the weight for all the @xmath125 trajectories initiated from @xmath126 , @xmath127 is a @xmath122-by-@xmath119 matrix with zero and unity elements .",
    "@xmath128 is unity only if the @xmath129th trajectory starts from the @xmath130th initial conformation .",
    "since the number of equations is more than the number of trajectory weights , we estimate eq .",
    "( [ eq : sym_mult_eq ] ) by minimizing @xmath131 .",
    "the vector of trajectory weights , @xmath78 , corresponds to the ground state of matrix @xmath132 .",
    "the eigenvalue of the ground state should be zero in principle , but in practice , it might be a small positive value due to statistical errors .",
    "for the newly defined @xmath76 matrix , the number of the degenerated ground states still corresponds to the number of disconnected metastable states under the timescale of the individual trajectory .",
    "the existence of a small fraction of transition trajectories can slightly split the ground state of @xmath76 .",
    "we name this method as si1 in the following of this paper .",
    "alternatively , we can merge the trajectories with the same initial conformations to a single one , and perform the standard we d analysis .",
    "concretely speaking , we can calculate the average of certain variable in the initial - segment sample set , @xmath41 , by , @xmath133 where @xmath134 means the average of @xmath9 over the initial segments of all the trajectories with the initial conformation @xmath135 . by doing so , more samples",
    "are included in calculation , and effectively , both the initial region and the whole area in the conformational space which the trajectory explores become statistically more reliable .",
    "this method is named as si2 in the following .",
    "we will illustrate the application of si1 and si2 for depressing the statistical noise in the systems with entropic states , where the inter - trajectory difference in the same metastable state is large .",
    "for the system of explicitly solvated alanine dipeptide , we generated @xmath136 md trajectories at @xmath137 k temperature , each with @xmath138 ps length in the namd package@xcite with charmm27 force field .",
    "in the simulations , a few potential barriers were added on the dihedral energy terms of the standard force field to kinetically separate the conformational space at room temperature ( about @xmath137 @xmath139 ) .",
    "the detailed simulation settings can be found in ref .",
    "@xcite . the alanine dipeptide molecule , together with the initial conformations of simulation are shown in fig .  [ fig : alad_desc ] , where various notations of the atoms , dihedral angles and free energy wells of this molecule are introduced . here ,",
    "by selecting different classes of basis functions , we will focus on the effects of different physical variables on the observed substate structure of the system and the improvement of statistical errors .      with thorough investigation , the two dihedral angles @xmath140 and @xmath141 have been recognized as the major coordinates that characterize the conformational motion of alanine dipeptide molecule .",
    "we adopted the first - to - fourth order two - dimensional trigonometrical functions of @xmath140 and @xmath141 as the basis functions in our we d analysis . calculating with this set of basis functions , the @xmath142 smallest eigenvalues of @xmath76",
    "are shown in fig .",
    "[ fig : bond_angle](a ) .",
    "the smallest zero eigenvalue is intrinsic due to the construction of @xmath76 .",
    "the second eigenvalue corresponds to the kinetic separation between the region with @xmath143 ( containing @xmath144 and @xmath145 ) and the region with @xmath146 ( containing @xmath147 and @xmath148 ) .",
    "consequently , by projecting vectors @xmath149 to the second eigenvector of @xmath76 ( _ i.e. _ , through @xmath150 ) , the trajectories can be clearly classified into the above mentioned two regions .",
    "the third eigenvalue of @xmath76 corresponds to the partially kinetic connection between the @xmath147 and @xmath148 states .",
    "only a fraction of the trajectories in @xmath147 can climb over the free energy barriers to the @xmath148 state , and _",
    "vice versa_. thus , we may use the @xmath151 values to classify the trajectories that are confined in the super - state involving @xmath152 and @xmath153 into three groups , _",
    "i.e. _ , the non - transition trajectories in the two potential wells , and the transition trajectories between them .",
    "since the two potential wells are well defined with their internal relaxation time smaller than the transition timescale , we can manipulate the trajectories to predict the transition times and locate the transition state ensemble  @xcite .",
    "the fourth smallest eigenvalue of @xmath76 is also smaller than @xmath79 .",
    "although it no longer indicates new state in the conformational space and should be taken as the reflection of statistical difference between trajectories , we recently find that , by observing @xmath154 , two trajectories that transiently walk into the @xmath145 region can be picked out .",
    "one of the two trajectories initially located in the @xmath145 region , then quickly moved into @xmath144 , another just occasionally visited @xmath145 .",
    "actually , at the temperature of @xmath137 @xmath139 , the @xmath145 region seems not very stable with the applied force field .",
    "the other eigenvalues of @xmath76 are very close to @xmath79 without observable meaningful information . in the previous paper  @xcite",
    ", we also pointed out that the results here can be reproduced only with the twelve first - to - second order two - dimensional trigonometrical functions , _",
    "i.e. _ , the trigonometrical functions of @xmath141 and @xmath140 ( without multiplication to any integer ) , and the one - time multiplication between these functions of the two adjacent dihedral angles .      after introducing the major results obtained by analyzing with the functions of dihedral angles , we can begin to test the case that the inter - atomic distances of alanine dipeptide are taken as the basis functions .",
    "we will compare two aspects , _",
    "i.e. _ , the eigenvalues of @xmath76 and the manipulations on @xmath155 for extracting the kinetic information between @xmath147 and @xmath148 .",
    "there are @xmath142 non - hydrogen heavy atoms in alanine dipeptide . except for the directly bonded atoms ,",
    "@xmath156 inter - atomic distances exist between the non - hydrogen heavy atoms . together with the two distances for the possible intramolecular hydrogen bonds ( see table  [ tab : basis ] )",
    ", we select @xmath157 distances as basis functions .",
    "the resulting eigenvalues of @xmath76 are shown in fig .",
    "[ fig : bond_angle](a ) .",
    "while the three smallest eigenvalues are almost the same with the results obtained with the functions of dihedral angles , the fourth eigenvalue is prominently lifted to a value closer to @xmath79 . however , the discrimination of the two @xmath145-visited trajectories is still possible .",
    "we plot the @xmath158 values calculated with the trajectories truncated to @xmath159-percent length ( _ i.e. _ , the @xmath160 ending segment of the trajectories are discarded in analysis ) versus the ones calculated with full trajectories  @xcite in fig .",
    "[ fig : bond_angle](d ) . for comparison ,",
    "the same figure generated with the first - to - second order two - dimensional trigonometrical functions are shown in fig .",
    "[ fig : bond_angle](c ) .",
    "the two figures have quite similar structure .",
    "the points corresponding to the non - transition trajectories in @xmath148 and @xmath147 are plotted as upward and downward ( black ) triangles , respectively .",
    "the points corresponding to the transition trajectories that start from @xmath148 and @xmath147 are plotted as ( red ) squares and ( blue ) circles , respectively .",
    "the points along the inclined dashed lines correspond to the trajectories with only one time transition , and the points along the horizontal dotted lines correspond to the trajectories that do not happen transition within the initial @xmath161 .",
    "thus the intersection between the dotted and dashed lines correspond to a single - transition trajectory with its transition happened exactly at @xmath161 .",
    "these points can be used to predict the transition times of the single - transition trajectories , consequently the transition state ensemble can be constructed .",
    "all the other points correspond to the trajectories with even number of transitions which all happen within @xmath162 , or with early transitions occurred within @xmath43 , or the multiple transition trajectories with transition happened both within @xmath162 and after @xmath162 .",
    "more details about detecting transition time thus transition conformation ensemble from the truncated - trajectory plots are presented in ref .",
    "the similarity between fig .",
    "[ fig : bond_angle](c ) and fig .",
    "[ fig : bond_angle](d ) suggests that the inter - atomic distances can also be applied as basis functions for the current system .      when the functions of dihedral angles and the inter - atomic distances are both included as basis functions , we get similar results on the eigenvalues of @xmath76 and the projection values .",
    "this property can be predicted by @xmath163 .",
    "the @xmath163 calculated with different number of basis functions are plotted in fig .",
    "[ fig : bond_angle](b ) .",
    "two curves are shown . in one of the two curves , the first - to - fourth order trigonometrical functions are taken into account before the @xmath157 distances , the order between these two classes of basis functions is reversed in another curve . as can be seen , the two curves reach the same @xmath163 within statistical error . apparently , before changing to the other group of basis functions ,",
    "the functions of dihedral angles account for larger value of @xmath163 than the inter - atomic distances .",
    "this is because the inter - atomic distances are not the intrinsic coordinates of the system , although they can also be adopted to detect the various states in the conformational space , but the characterization is not so definite as the dihedral angles do .",
    "thus , even the distances has been taken into account , there is still independent and informative part in the trigonometrical functions , leading to the further increase of @xmath163 . instead ,",
    "when the trigonometrical functions have been considered , the distances become non - informative ( due to the orthogonalization process ) , this explains the fact that lots of basis functions are discarded by error analysis in this case [ see the different number of basis functions in the two curves in fig .",
    "[ fig : bond_angle](b ) ] . from fig .",
    "[ fig : bond_angle](b ) , we also find that either with the first @xmath164 basis functions of dihedral angles ( first - to - second two dimensional trigonometrical functions of @xmath140 and @xmath141 ) or the first @xmath164 inter - atomic distances ( the distances between main chain heavy atoms separated by two atoms , the distances between main chain and side chain heavy atoms separated by two atoms , and the distances between side chain heavy atoms ) , @xmath163 has already entered into the phase with slower increase .",
    "this explains why the results obtained by @xmath164 trigonometrical functions are similar with the results with @xmath165 ones .",
    "we also plot the eigenvalues of @xmath76 calculated by @xmath164 inter - atomic distances in fig .",
    "[ fig : bond_angle](a ) .",
    "the fourth eigenvalue is further lifted , consequently the identification of @xmath145-visited trajectories by @xmath154 is not possible .",
    "however the behavior of @xmath166 and @xmath155 is qualitatively similar to the previous results ( data not shown ) .",
    "we also try to add the dihedral angle @xmath167 ( see fig .",
    "[ fig : alad_desc ] ) into analysis , which has been found to occasionally happen cis - trans transition at high temperature  @xcite . by adding the sine and cosine functions of @xmath167 itself and its correlation to @xmath140 ,",
    "no difference is found in analysis .",
    "indeed , in our simulation , the conformations are all found to have trans-@xmath167 angles .    as a summary ,",
    "we have compared the results of the we d analysis with basis functions either of the dihedral angles or the inter - atomic distances .",
    "the previous results obtained with dihedral angles can be reproduced with inter - atomic distances . however , both from the spectral properties of @xmath76 and from the @xmath163 term , we conclude that the distances are not as accurate as the dihedral angles for describing the structure of current model system .",
    "the results obtained with the inter - atomic distances may get worse when studying larger protein molecules , since the selection of characteristic inter - atomic distance becomes more complicated .",
    "thus , for the application of we d method to proteins , we suggest to use the functions of the dihedral angles as the preferential basis functions . for two adjacent main chain dihedral angles ,",
    "the first - to - second order two - dimensional trigonometrical functions are the proper choice .",
    "if only the correlation between adjacent dihedral angles were taken into account , the number of basis functions would be proportional to the chain length of the simulated molecule , which is practical for implementation .      for solvated biological macro - molecules ,",
    "the conformational change is sometimes correlated to the surrounding solvent molecules . in we d , since the solvent - related properties can also be selected as basis functions , it becomes possible to systematically one - by - one check and filter out the variables that may affect the thermodynamic and kinetic properties of the solvated molecule . here ,",
    "for illustration , we study the solvated alanine dipeptide system with 91 basis functions to search for the solvent - related effects .",
    "these basis functions are classified into three groups , which respectively reflect the internal freedom of alanine dipeptide ( denoted as p ) , the solute - solvent relation ( denoted as pw ) and the structure of bulk solvent ( denoted as w ) .",
    "the details of these basis functions are listed in table  [ tab : basis ] .",
    "the eigenvalues of @xmath76 are shown in fig .",
    "[ fig : temp_eigval](a ) . as can be seen , at @xmath168 temperature",
    ", the inclusion of the solvent - related basis functions does not affect the spectral property of @xmath76 .",
    "particularly , the eigenvalues that are prominently smaller than @xmath79 do not change , reflecting the unchanged physical division of the conformational space .",
    "only a few eigenvalues pretty close to @xmath79 are slightly lowered due to the added basis functions .",
    "the above results suggest that , for the current system , the solvent related properties have almost reached equilibrium in single trajectory .",
    "consequently , these properties contribute quite a little to the inter - trajectory difference , and are unlikely to be strongly coupled with the dynamic process of the solute molecule under the simulated timescale .",
    "we also apply the we d method to the low - temperature simulations of the solvated alanine dipeptide .",
    "first , the @xmath136 conformations selected from a @xmath169 @xmath170 simulation in the namd package@xcite are first relaxed by simulating at @xmath171 @xmath170 for @xmath172 @xmath173 , then continuously simulate @xmath174 , and collect conformations every @xmath175 @xmath173 for subsequent analysis .",
    "standard charmm27 force field is adopted in all the simulations .",
    "we note that , at this temperature , the physical phenomena are quite complicated ; the force field and the simulation procedure that we adopt may not reflects the physical reality . here , we are only meant to illustrate the application of the we d method in the extreme condition , instead of providing physical insight into the system .",
    "the eigenvalues of the @xmath76 matrix are calculated with the @xmath176 basis functions listed in table  [ tab : basis ] , and are plotted in fig .",
    "[ fig : temp_eigval](b ) .",
    "different from the results at @xmath177 , at @xmath178 , there are lots of eigenvalues deviating from @xmath79 , which gradually grows from zero to larger values .",
    "besides , the solvent - related quantities do affect the eigenvalues of @xmath76 now , leading to even more small eigenvalues . correspondingly , the @xmath163 , as shown in fig .",
    "[ fig : temp_eigval](d ) , almost always increases with the number of basis functions .",
    "at such a low temperature , the free energy surface becomes quite rough , the diffusive dynamics  @xcite in the conformational space slows down seriously . as a result",
    ", the simulation trajectories may only explore a small region in the conformational space .",
    "some degrees of freedom , like the solvent motion around the solute molecule and the conformational motion perpendicular to the @xmath140-@xmath141 plane , are no longer equilibrated in single trajectory .",
    "thus , the inter - trajectory difference becomes larger , more states are detected automatically , and more basis functions are required to expand the rugged distribution of the samples , leading to the abnormal behavior of the eigenvalues of @xmath76 and @xmath163 .",
    "manipulating the eigenvectors of @xmath76 can provide further information of the simulation data .",
    "the projections of @xmath149 to the second and the third eigenvectors of @xmath76 pick out two completely separated states , @xmath179 and the super - state containing @xmath153 and @xmath152 [ fig .",
    "[ fig : low_temp](a ) , at current temperature , the @xmath140 and @xmath141 angles may not be enough to characterize the conformational motion , thus the notations , @xmath179 , @xmath153 and @xmath152 , are used mainly for the purpose of illustration ] . by the aid of the histogram of @xmath158",
    "[ see fig .",
    "[ fig : low_temp](a ) , inset ] , we can roughly classify the trajectories inside the super - state into three groups , _",
    "i.e. _ , the trajectories in the leftmost two bins , in the rightmost two bins and the remaining ones .",
    "the conformational distribution of trajectories in different groups are shown in fig .",
    "[ fig : low_temp](c ) .",
    "the two groups of the leftmost or rightmost bins both possess single peak distribution , either in @xmath152 region or @xmath153 region , just like the non - transition trajectories identified in the simulations at higher temperature . in contrast , the trajectories in the remaining group have a significant occupation in the intermediate region between @xmath152 and @xmath153 .",
    "obviously , these trajectories are trapped at the intermediate region due to slow dynamics , and are different from the transition trajectories identified with the similar procedure at @xmath177 .",
    "we plot the @xmath158 calculated with @xmath159 percent trajectory length with the ones with full trajectory length in fig .",
    "[ fig : low_temp](c ) . the behaviors presented in fig .",
    "[ fig : bond_angle ] no longer exist .",
    "in terms of kinetics , the transition between the two regions , @xmath148 and @xmath147 , can neither be approximated as markovian process nor described with first - order rate constant any more .",
    "consequently , with the current simulation data , it is only possible to reconstruct the intrastate equilibrium distribution in the local regions of conformational space , or to study the more localized kinetic behavior .    due to the numerous local minimums at the low temperature ,",
    "the @xmath148 and @xmath147 regions are just like two entropic states .",
    "we also test the statistics improvement method in this system . with one - fifth initial conformations and five trajectories from each conformation , the inter - trajectory difference , thus the statistical noise ,",
    "is indeed suppressed as shown in fig .",
    "[ fig : low_temp](d ) .",
    "in the current paper , we apply the we d method to a few extremal model systems , including a system with multiple - state transition network , a system with entropy - dominated state , and the solvated alanine dipeptide system . the solvent - related basis functions and the low - temperature properties of the dipeptide molecule",
    "are also studied . for the first two examples , we d can correctly resolve the topology of the transition network .",
    "for the alanine dipeptide system simulated at @xmath137 @xmath170 with modified potential , we find the redundant basis functions ( including functions of both the dihedral angles and the inter - atomic distances ) are consistently treated in the we d analysis , and the inclusion of the solvent - related basis functions gives out the expected results . at pretty low temperature of @xmath171 @xmath170 , the roughness of the free energy surface is reflected in the results of we d .",
    "the conformational space can still be roughly divided into parts , however , the kinetics becomes too complicated to be unambiguously characterized . as a systematic method for exploring the conformational space , we d does not require much priori knowledge and approximation ,",
    "thus its results can honestly reflect the thermodynamic and kinetic information of the system . for biological macromolecules ,",
    "the usually expected hierarchical structure can be extracted out step - by - step . for these complex systems ,",
    "the structure of the conformational space may be much more complicated , these examples studied here become quite relevant for physically interpreting the results .",
    "along with the applications , we design the @xmath163 quantity for checking the completeness of the selected basis functions , and the schemes for statistics improvement .",
    "these tactics are also proved to be helpful for portraying the conformational space .",
    "[ appendix ]",
    "suppose we already know the initial distribution , @xmath19 , of the simulation trajectories , it is possible to assign each trajectory a weight @xmath180 where @xmath181 is the initial conformation of the @xmath30th trajectory . if @xmath19 is the summation of a finite number of @xmath21-functions , this method leads to trajectory weights with singular value .",
    "however , if the initial conformations are selected from a known distribution @xmath182 , @xmath19 can be approximated by @xmath182 to avoid the singularity .",
    "for example , suppose the simulation system has the potential energy @xmath25 , and the initial conformations are selected from the simulation with the potential energy @xmath183 , which might be a more flat version of @xmath25 for improving the sampling efficiency , then the weight of the @xmath30th trajectory should be @xmath184 $ ] .",
    "this weighting scheme is actually proper for trajectories with arbitrary length @xmath37 . in the limit of @xmath185",
    ", it reduces to the classical scheme for regenerating the desired distribution from a simulation with a modified potential@xcite .",
    "however , since the energy fluctuation for a system with particle number @xmath186 is approximately proportional to @xmath187 , for large systems , the weights in eq .",
    "( [ eq : weight_simp ] ) suffer from huge fluctuation .",
    "it is quite possible that the weights of a few trajectories prominently outweigh the others , then only the samples in these trajectories contribute to the final results , while the significance of the other trajectories has been depressed to nearly zero .",
    "besides , the substitution of the initial distribution function combined by @xmath21-functions by an analytical distribution is only valid when a large number of trajectories are generated for analysis .",
    "one should notice that there are actually more than one appropriate weighting schemes for the same set of simulation trajectories .",
    "taking the long time limit of the trajectory length @xmath37 to ensure that every trajectory has been in equilibrium over the whole conformational space , then the trajectories should be assigned with equal weights .",
    "this choice brings the largest effective sample size , thus is better than eq .",
    "( [ eq : weight_simp ] ) .",
    "when the simulation time is neither zero nor long enough , it is plausible to expect that the proper weights for the trajectories will gradually relax from the ones in eq .",
    "( [ eq : weight_simp ] ) to the case of equal weights as simulation time increases .",
    "this conjecture can be explained with probability evolution . as we all know , the relaxation from @xmath19 to @xmath28 is a process with multiple timescales , some events may relax faster than the others .",
    "usually , the temporal hierarchy is highly correlated to the conformational degrees of freedom , _",
    "i.e. _ , the relaxation processes with short timescales are related to local conformational adjustment , and the ones with long timescales are related to global conformational transformation .",
    "consequently , if each @xmath37-length trajectory is able to reach local equilibrium within certain conformational region ( metastable state ) , then only the overall difference between @xmath19 and @xmath28 in each local state need to be considered in weight estimation , making it possible to reduce the fluctuation of trajectory weights .    in practice , within a short time @xmath43 at the beginning of a simulation trajectory , some fast degrees of freedom of conformational motion may have relaxed , thus , intuitively , the trajectory has approximately reached equilibrium within certain local area , @xmath45 , around its initial conformation .",
    "if the initial conformations of two trajectories are so close in the conformational space , that both of the two trajectories explore the same area within @xmath43 , then the difference between the two trajectories in terms of the initial conformation should be almost wiped off , leaving the two trajectories contributing nearly the same to the equilibrium properties . generally speaking , for the trajectories that start and stay in the same area within short @xmath43 ,",
    "similar trajectory weights should be assigned with prominently reduced fluctuation .",
    "the number of trajectories that start in a local area @xmath45 is actually proportional to @xmath188 , _",
    "i.e. _ , the integration of the initial distribution over @xmath45 . however , if the initial conformations are selected from the desired equilibrium distribution , the number of trajectories that start in this region should be proportional to @xmath189 .",
    "consequently , we can specify the weight @xmath190 to all the trajectories from @xmath45 region . here",
    ", @xmath191 denotes the average over the equilibrium distribution restricted in the @xmath45 region . considering the plausible local equilibration of trajectories , eq.([eq : weight_aver_area ] ) can be reformulated to a time - average form as below , @xmath192 where @xmath193 is the weight of the @xmath30th trajectory , @xmath194 is the conformation in the @xmath30th trajectory at time @xmath8 .",
    "interestingly , the time - average formula does not refer to the assumed local areas any more .",
    "the trajectory weights can be calculated by averaging the ratio of the two distribution functions over the initial @xmath43-length of each trajectory , and the trajectories will automatically detect the local areas . usually , @xmath43 should be short compared to @xmath37 to guarantee , as far as possible , that the trajectories initially close to each other are exploring the same local area which is a local equilibrium meta - stable state in the @xmath37 time scale .",
    "we will further discuss this issue in sec .",
    "[ sec : tildet ] .    in eq .",
    "( [ eq : weight_aver_time ] ) , due to the average over a few samples in each trajectory , the fluctuation of @xmath36 will be lowered to certain extent . however , for large systems",
    ", this is still not enough . because the reduction of fluctuation is approximately proportional to @xmath195 , where @xmath196 is the number of frames within @xmath43 time , which is incomparable with the exponentially expanded fluctuation of @xmath197 .      in view of the above",
    ", we propose additional scheme to further reduce the fluctuation of trajectory weights . for systems like solvated biological macromolecules ,",
    "the large fluctuation usually does not come from the physically important degrees of freedom .",
    "for example , the solvent molecules account for most of the energetic fluctuation of the system . in the same time",
    ", the physically interesting degrees of freedom , say the conformation of a macromolecule , are determined by its own internal coordinates , such as dihedral angles , inter - atomic distances and so on .",
    "thus , we can expand the term @xmath198 only by quantities that are physically interesting to get rid of the irrelevant fluctuations . to fulfill this aim",
    ", we define an inner product between two conformational functions , @xmath32 and @xmath199 , as @xmath200 considering the general relation @xmath201 for any conformational function @xmath32 [ where @xmath202 denotes the ensemble average of @xmath32 under the probability density @xmath203 , a set of physical quantities @xmath57 ( also named as basis functions in the follows of the paper ) are selected to approximate @xmath198 as @xmath204 here @xmath205 is the inverse of the covariance matrix of the basis functions , @xmath206 , and @xmath207 . substituting eq .",
    "( [ eq : expand ] ) into eq .",
    "( [ eq : weight_aver_time ] ) , the trajectory weights are found to satisfy the following self - consistent equations .",
    "@xmath208 here , the time average of the function @xmath209 over the initial @xmath43-length segment of the @xmath30th trajectory has been written as @xmath210 . for any function of conformational coordinates",
    ", the average over the distribution function , @xmath19 , can be calculated with the samples that are adopted for selecting the initial conformations . the average over distribution @xmath28 ,",
    "however , relies on the trajectory weights through eq .",
    "( [ eq : aver_w ] ) .",
    "consequently , an iterative method should be invoked to calculate @xmath211 .",
    "since @xmath198 is now projected to the hyperplane spanned by the selected basis functions @xmath212 , the calculated trajectory weights can be used to reconstruct the free energy surface along the selected degrees of freedom .",
    "( [ eq : weight_iter ] ) is already practical for getting reasonable trajectory weights with small fluctuation .",
    "however , there are still two drawbacks of this method .",
    "first , we need enough samples of the distribution @xmath19 .",
    "if the initial conformations are chosen from high temperature simulation , then all of the conformations in the high temperature trajectory can be utilized . however , if the initial conformations are chosen from coarse - grained simulation , or simply from arbitrary selection , the estimation of @xmath213 might be insufficient if @xmath214 ( the number of trajectories ) is not large , leading to problematic application of eq .",
    "( [ eq : weight_iter ] ) .",
    "second , the iterative calculation hampers the in - depth analysis of the simulation system .",
    "when the conformational space has been separated into different free - energy wells without any inter - communication within the finite simulation time , the iterative method may still provide an incorrect answer without pointing out the broken ergodicity .",
    "considering the shortcomings of eq .",
    "( [ eq : weight_iter ] ) , we design the final framework of we d , which , to a large extent , solves the above mentioned problems , and is still able to find out the fluctuation - reduced trajectory weights . here , instead of using the sample of @xmath19",
    ", we artificially construct a new sample set @xmath41 with its distribution symbolically denoted as @xmath87 .",
    "@xmath41 consists of the initial @xmath43-length segments of all the trajectories . if @xmath43 is short enough ( compared to @xmath37 )",
    ", the trajectories only explore their local area within @xmath43 .",
    "thus , the number of conformations in each local area , @xmath45 , does not change after the @xmath43 relaxation , _",
    "i.e. _ , @xmath215 then , substituting @xmath19 with @xmath87 in calculation , the expression of the trajectory weights will become @xmath216 since the sample set @xmath41 is supposed to reach local equilibrium in each @xmath45 region ( but may not reach equilibrium among these regions ) , we are able to get eq .",
    "( [ eq : weight_linear ] ) without the inverse sign in eq .",
    "( [ eq : weight_aver_time ] ) . after redefining the inner product between two conformational functions as @xmath217 the @xmath218 term in eq .",
    "( [ eq : weight_linear ] ) can be expanded by a set of basis functions similar to eq .",
    "( [ eq : expand ] ) .",
    "@xmath219    finally , similar to eq .",
    "( [ eq : weight_iter ] ) , substituting eq .",
    "( [ eq : linear_expand ] ) into eq .",
    "( [ eq : weight_linear ] ) , and considering the reliance of the average over equilibrium ensemble on the trajectory weights , we have the following set of linear equations , @xmath220 where @xmath70 .",
    "it is direct to derive the central equation of we d , eq .  ( [ eq : sym_lin_eq ] ) , from eq .",
    "( [ eq : weight_linear_eq ] ) .",
    "we also provide a heuristic derivation of the spectral property of the @xmath76 matrix .",
    "we define the element of a matrix @xmath221 as , @xmath222 where @xmath223 ( or @xmath224 ) represents the short initial segments ( @xmath43-length ) in the @xmath30th ( or @xmath129th ) simulation trajectory .",
    "if @xmath43 is short enough that most of the trajectories are still confined in their local area , and in another sense long enough that local equilibrium is almost obtained , the elements of the matrix @xmath221 can be expressed as @xmath225 here @xmath226 is the distribution function of the @xmath41 sample set , @xmath227 represents the state in which the initial segment of the @xmath30th trajectory locates , and @xmath228 is defined as @xmath229 where @xmath230 is the characteristic function of state @xmath227 , which is non - vanishing with value @xmath94 only inside the @xmath227 region .",
    "thus , @xmath231 is not zero only if @xmath227 and @xmath232 are the same state .",
    "suppose that there are @xmath233 states in the system , _",
    "i.e. _ , @xmath234 , and there are @xmath235 trajectories initially locating in these states , respectively .",
    "the matrix @xmath221 becomes a block diagonalized matrix with proper numbering of the trajectories .",
    "@xmath236    the dimension of the sub - matrix with elements @xmath237 is @xmath238 . for this matrix ,",
    "the eigenvalue @xmath79 is @xmath233 fold degenerate and the eigenvalue @xmath239 is @xmath240 fold degenerate .",
    "the matrix defined as @xmath241 has @xmath233 eigenvalues equal to @xmath239 ( equal to the number of states ) and @xmath240 eigenvalues equal to @xmath79 . where @xmath242 is a @xmath122-dimensional unit matrix .",
    "another matrix @xmath243 is defined as @xmath244 the only difference between @xmath243 and @xmath221 is that the average over the initial segments of trajectory @xmath129 has been substituted into the average over the whole trajectory .",
    "consequently , the possible transition events in trajectory @xmath129 will be reflected in the matrix elements , and @xmath243 is a non - symmetric matrix now . for the simplicity in derivation , we suppose that there are two states , @xmath245 and @xmath246 , in the system , with @xmath247 and @xmath248 trajectories initially locating in these two states , and there are @xmath249 ( or @xmath250 ) transition ones amid the @xmath247 ( or @xmath248 ) trajectories . then the matrix @xmath243 should be written as    @xmath251    here , @xmath252 ( or @xmath253 ) denotes the time proportion of the @xmath245 ( or @xmath246)-started trajectory @xmath30 in state @xmath246 ( or @xmath245 ) . for the trajectories that start from the same state , the row vectors of @xmath243 are the same .",
    "thus , the transition and non - transition trajectories can not be differentiated by the row vectors of @xmath243 .",
    "for systems with multiple states , the conclusion is similar . in we",
    "d , the matrix @xmath254 is directly related to @xmath243 as @xmath255 hence , the row vectors for the trajectories from the same initial state are no longer the same , the deviation of the transition trajectories from the non - transition ones are linearly related to the distribution of the transition trajectories in different states . for the matrix @xmath256 ,",
    "considering the perturbation of the transition trajectories to the matrix @xmath257 , the number of the eigenvalues that are obviously smaller than @xmath79 should still be the same with the number of the disconnected states in the conformational space .",
    "the value of these eigenvalues should deviate from zero due to the transition trajectories .",
    "the other interesting properties can also be rationalized by this heuristic proof .",
    "we illustrate the application of we d in two exterme model systems , one with a transition network among multiple states , the other with an entropy - dominated state .",
    "the first model system which with two - dimension - quad - well(tdqw ) potential has four degenerate states [ four potential wells with exactly the same shape , see fig .",
    "[ fig:2d_pot](a ) ] , and four potential barriers of equal height separating them apart .",
    "the second system which with mexican - hat(mhat ) potential has two states [ see fig .",
    "[ fig:2d_pot](b ) ] .",
    "the outer state has large entropy , thus , its intrastate relaxation time may be comparable to the time - scale of inter - state transition .",
    "we will first analyze the we d trajectories of these two systems under different temperatures .",
    "then , we will discuss the topics about basis function selection , @xmath43 selection and statistics improvement .",
    "for the two - dimensional systems , tdqw and mhat , simulations are restricted in the square region of @xmath258\\times[-2,2]$ ] . reflecting boundary condition",
    "is imposed .",
    "the over - dampened langevin equations @xmath259 is adopted to generate the dynamical trajectories . where @xmath260 is the frictional coefficient",
    ", @xmath261 is the boltzmann constant , @xmath2 is the simulation temperature , @xmath262 and @xmath263 are the white noises satisfying @xmath264 with @xmath265 denoting the ensemble average of noise .",
    "we simply take @xmath261 and @xmath260 as unity to get the dimension - reduced units for time , position and temperature .          for both systems , @xmath268",
    "initial conformations are randomly selected if not further mentioned , then we d simulation are performed , with each trajectory simulated for @xmath269 dimensionless time units .",
    "the coordinates are recorded every @xmath270 time units .",
    "the @xmath114 is selected as @xmath271 , if not further mentioned .      for tdqw system ,",
    "we d simulations are performed at three temperatures of @xmath272 , @xmath273 and @xmath274 .",
    "@xmath268 trajectories with @xmath275 dimensionless time units are generated in each set of we d simulation .",
    "the eigenvalues of @xmath76 are plotted in fig .",
    "[ fig : vecval_mdmw](a ) . as expected , there are four zero eigenvalues at temperature @xmath276 , implying the four disconnected states in tdqw system . at higher simulation temperatures ,",
    "the second to fourth eigenvalues of @xmath76 deviate from zero to larger values due to the increasing fraction of the inter - state transition trajectories .",
    "more illustrative perspective can be obtained from fig .",
    "[ fig : vecval_mdmw](b ) , ( c ) , and ( d ) , where the trajectories are mapped into the three - dimensional space by projecting @xmath149 to the second , third and fourth eigenvectors of @xmath76 ( the projection to the first eigenvector is always zero ; the projection values are denoted by @xmath277 , where @xmath278 is the @xmath45th eigenvector of h ) . at temperature @xmath276 ,",
    "the trajectories agglomerate into four disconnected clusters that locate respectively at the four vertexes of a tetrahedron . inside each cluster",
    "are the trajectories isolated in the same potential well . at temperature @xmath273 ,",
    "part of the trajectories can climb over the potential barriers to the other states . as a result ,",
    "the points corresponding to the transition trajectories are found to gather along the straight lines that shoot out of the vertexes , and the ones corresponding to the non - transition trajectories are still locating on the vertexes .",
    "the transition trajectories along a straight line are found to connect the same two states .",
    "these two states respectively correspond to the vertex that emits the line and the vertex that the line approximately points to .",
    "thus , between the two trajectory - connected vertexes ( states ) , there are two parallel lines , respectively corresponding to the transition trajectories that start from different states . in fig .  [",
    "fig : vecval_mdmw](c ) , each vertex only connects to two neighboring vertexes , correctly reflecting the topology of the transition network of tdqw system . at temperature @xmath279",
    ", it is relatively easier for the trajectories to transfer between different states .",
    "the tetrahedron structure is still preserved , and its interior is filled by multiple - transition trajectories which transition among more than two states .",
    "the eigenvalues of @xmath76 actually provide clues for the preserving of the tetrahedron structure . since the second to fourth eigenvalues are still not close to @xmath79 , _",
    "i.e. _ , the conformational space can not be sufficiently explored by single trajectory , the difference between trajectories in terms of their initial conformations still exists , leading to the structure in the projection space . at higher temperature ,",
    "the inter - trajectory difference will further reduce , leading to the diminishing of the tetrahedron structure . in that case , it is more proper to assert that there is almost only one state in the conformational space in the current simulation timescale ( however , each single trajectory might be not sufficient to reach the global equilibrium and the weights of trajectories are still necessary to reproduce the global equilibrium due to the fact that exists three eigenvalues in the ( 0,1 ) interval ) . in shorter time scales , _",
    "e.g. _ , when each of the trajectories is shortened , the substate structure could emerges .    considering the tetrahedron structure and the straight lines in fig .",
    "[ fig : vecval_mdmw](c ) , and the small second to fourth eigenvalues of @xmath76 , various kinetic information can be directly extracted from the simulation data of tdqw at @xmath280",
    ". the procedure can be ( 1 ) arbitrarily picking out the non - transition and transition trajectories in two neighboring states from fig .",
    "[ fig : vecval_mdmw](c ) , ( 2 ) analyzing these trajectories with the we d method ( constructing @xmath76 and analyzing its spectral properties ) , ( 3 ) projecting the trajectories into low - dimensional space and manipulating the projection values . in the paper , we just focus on the abilities of we d in detecting meta - stable structure , the construction of equilibrium properties of the system based on the obtained weights of trajectories is directed  @xcite .",
    "some interesting information , such as the transition state ensemble , the first order kinetic rates , and the transition times of single trajectories , can be obtained .",
    "the proposed kinetic analysis  @xcite is based on the assumption that most of the transition trajectories only climb the potential barriers a few times .",
    "if , in each single trajectory , the transition events that we are interested in can happen for many times ( _ i.e. _ , a single trajectory almost already reached equilibrium ) , we directly treat whole the visited region as a super states , or perform a shortening of the simulation trajectories ( for example , dividing each trajectory into a few shorter ones ) to analyze the detailed kinetics in shorter time scales .",
    "the we d method provides much flexibility for such manipulations .      for mhat system ,",
    "we d simulations are performed at four temperatures of @xmath281 , @xmath272 , @xmath273 , and @xmath274 , with the same settings as the tdqw system .",
    "the @xmath282 smallest eigenvalues of @xmath76 are shown in fig .",
    "[ fig : vecval_mhat](a ) .",
    "different from tdqw , the eigenvalues of @xmath76 gradually increase from zero at the temperature of @xmath281 , and lots of small eigenvalues exist .",
    "the number of the eigenvalues that obviously deviate from @xmath79 are always more than the number of physical states in mhat system , till the temperature is high enough that there is only one zero - eigenvalue apparently different from @xmath79 .",
    "this behavior simply reflects the entropic nature of the outer potential well . at low temperature ,",
    "a single trajectory can not reach local equilibrium in that entropic state , consequently a few small eigenvalues exist due to the inter - trajectory difference ( it looks like there are many sub - states ) . at higher temperature ,",
    "the trajectories that start from the outer potential well usually climb over the potential barrier before reaching equilibrium in the whole state , thus the inter - trajectory difference will not be extinguished , until the two states in mhat kinetically become one state at high enough temperature .",
    "the projections of @xmath283 onto the second , third and fourth eigenvectors of @xmath76 are shown in fig .",
    "[ fig : vecval_mdmw](b ) , ( c ) , and ( d ) . at both temperatures @xmath281 and @xmath272 , the trajectories are divided into two groups . in one group ,",
    "the trajectories dispersively locate on the same plane which is perpendicular to the @xmath284 axis .",
    "these trajectories are found to be isolated in the outer potential well . in the other group ,",
    "the trajectories concentrate to nearly one point .",
    "they are found to be isolated in the inner potential well .",
    "these two groups of trajectories are clearly differentiated by the projections along the second eigenvector of @xmath76 , _",
    "i.e. _ , the one indicating the most important contribution to ergodicity broken . at temperature @xmath281 , each trajectory only explore very limited region in the entropic state , leading to the distribution on the perimeter of a circle . at temperature",
    "@xmath272 , since each trajectory can explore larger area , the circle has been filled with points . at temperature @xmath273 ,",
    "the trajectories are found to locate in a cone .",
    "the points in the bottom surface and the vertex of the cone correspond to the non - transition trajectories inside the outer and inner potential wells , respectively , and the other points are transition trajectories between the two states . once again , the trajectory - projected space clearly provides the topological information of the transition network of this system .",
    "interestingly , due to the symmetry of the outer state of mhat , we can even extract the kinetic information of the transition between the inner and the outer states ( data not shown ) , although it might not be general for other systems with entropy - dominated states .      at temperature @xmath273",
    ", the @xmath163 analysis is performed for the two - dimensional systems .",
    "we apply the following two - dimensional trigonometrical functions @xmath285,\\cos[(m+n)x],&\\nonumber\\\\ & \\sin{}[(m+n)y],\\cos[(m+n)y],&\\nonumber\\\\ & m+n>0&\\nonumber\\\\ & \\sin{}(mx)\\sin{}(ny),\\sin{}(mx)\\cos{}(ny),&\\nonumber\\\\ & \\cos{}(mx)\\sin{}(ny),\\cos{}(mx)\\cos{}(ny),&\\nonumber\\\\ & m\\geq{}1,n\\geq{}1&\\end{aligned}\\ ] ] as basis functions .",
    "where , @xmath286 are the two - dimensional cartesian coordinates multiplied by a transformation factor @xmath287 , @xmath288 and @xmath233 are non - negative integers .",
    "we define the summation of @xmath288 and @xmath233 in eq .",
    "( [ eq : hd_base ] ) as the order of these functions , and adopt the first - to - fourth order functions ( totally @xmath165 basis functions ) in our analysis . based on the error analysis mentioned in sec.[subsec : basis ] ,",
    "three and two basis functions are discarded in the tdqw and mhat systems , respectively .",
    "for both of the two systems , @xmath163 initially grows fast with increasing number of basis functions , then the growth slows down and shows a saturation behavior of @xmath163 as expected [ see figs .",
    "[ fig : s2_tt_is](a ) and ( b ) ] .",
    "once @xmath163 has approximately reached the platform region , more basis functions will not change the calculation results any more ( data not shown ) .",
    "thus , for tdqw and mhat systems , about @xmath289 basis functions , _",
    "i.e. _ , the first - to - third order two - dimensional trigonometrical functions , are already enough .",
    "we study the effect of @xmath43 with the simulation data of mhat at temperature @xmath273 .",
    "since there is only one zero eigenvalue of @xmath76 , the whole free energy surface can be reconstructed .",
    "the whole conformational space is uniformly divided into small pieces , @xmath290 ( @xmath291 is selected as @xmath292 here , _",
    "i.e. _ , @xmath165 segments along each dimension ) , and the distribution probability in each piece is reconstructed with different @xmath293 .",
    "we define the function @xmath294 as @xmath295 to measure the difference between the reconstructed probability distribution and the theoretical distribution . here",
    "@xmath296 is the distribution probability in the @xmath130th piece which is reproduced by we d method using @xmath297 .",
    "@xmath298 is the theoretical distribution probability in the @xmath130th piece .",
    "as shown in fig .",
    "[ fig : s2_tt_is](c ) , @xmath294 indeed decreases with shorter @xmath297 in calculation . for @xmath297 in the @xmath299 $ ] interval ,",
    "the @xmath294 values are almost the same , and are prominently smaller then the value of the non - weighted distribution of the simulation data .",
    "in the non - weighted ( all @xmath193 is unity ) distribution , the major deviation from theoretical distribution resides in the inner potential well of mhat , where the distribution probability is too high for the non - weighted data . in the re - weighting process , the trajectories that start from the inner potential well are usually specified lower weights [ see fig .",
    "[ fig : s2_tt_is](c ) , inset ] , thus the over occupation in the inner state can be offset .",
    "the other variation in trajectory weights further adjust the intrastate distribution for both the inner and the outer states .",
    "we also test the statistics improvement methods , si1 and si2 . in here and below , we always randomly select one - fifth of the initial conformations , then five trajectories are spawned from each conformation to test the improvement . at @xmath280 , we apply both si1 and si2 to reconstruct the energy surface of mhat . from fig .",
    "[ fig : s2_tt_is](c ) , it can be seen that both methods correctly reproduce the energy surface with even smaller deviation from the theoretical one , as compared to the standard we d method . at @xmath300 ,",
    "the eigenvalues of the @xmath76 matrix are calculated with si2 method . as shown in fig .",
    "[ fig : s2_tt_is](d ) , no matter one trajectory or multiple trajectories are generated from one initial conformation , the eigenvalues calculated by the standard we d method are almost the same . however , analyzing by si2 method significantly alters the structure of eigenvalues . by generating more trajectories from single initial conformation , and combining these trajectories together in analysis ,",
    "the statistics of single trajectory is prominently improved , and the inter - trajectory difference for trajectories in the same state ( or near in conformational space ) are reduced to large extent . as a result , some of the eigenvalues increases , in particular for the ones deviating but close to @xmath79 . in other words ,",
    "the si2 method has depressed the statistical noise in the spectral analysis of @xmath76 , leaving the physically relevant states recognized .",
    "g.  bolhuis , d.  chandler , c.  dellago , and p.  l. geissler , ann .",
    "phys . chem . *",
    "53 * , 291 ( 2002 ) .",
    "r.  elber , a.  ghosh , and a.  cardenas , acc .",
    "35 * , 396 ( 2002 ) .",
    "weinan  e , w.  ren , and e.  vanden - eijnden , j. phys .",
    "b * 109 * , 6688 ( 2005 ) .",
    "a.  k.  faradjian and r.  elber , j. chem . phys .",
    "* 120 * , 10880 ( 2004 ) .",
    "a.  f. voter , phys .",
    "b * 57 * , 13985(r ) ( 1998 ) .",
    "m.  r.  shirts and v.  s.  pande , phys .",
    "lett . * 86 * , 4983 ( 2001 ) .",
    "x.  huang , g.  r.  bowman , and v.  s.  pande , j. chem .",
    "phys . * 128 * , 205106 ( 2008 ) .",
    "d.  thirumalai , r.  d.   mountain , and t.  r.  kirkpatrick , phys .",
    "a * 39 * , 3563 ( 1989 ) .",
    "f.  no , s.  fischer , curr .",
    "18 * , 154 ( 2008 ) .",
    "o.  m.  becker and m.  karplus , j. chem .",
    "* 106 * , 1495 ( 1997 ) .",
    "d.  j. wales , science * 293 * , 2067 ( 2001 ) .",
    "s.  v. krivov and m.  karplus , proc .",
    "usa * 101 * , 14766 ( 2004 ) .",
    "f.  rao and a.  caflisch , j. mol . biol . * 342 * , 299 ( 2004 ) .",
    "d.  gfeller , p.  d.  l. rios , a.   caflish , and f.  rao , proc .",
    "usa * 104 * , 1817 ( 2007 ) .",
    "f.  no , i. horenko , c. schtte , and j. c. smith , j. chem",
    "126 * , 155102 ( 2007 ) .",
    "the four atoms @xmath301 , @xmath302 , @xmath303 and @xmath304 are labelled in fig .",
    "[ fig : alad_desc ] , left panel .",
    "@xmath305(@xmath306 ) is the hydrogen atom bonded to @xmath303(@xmath304 ) . @xmath301-@xmath303 and @xmath302-@xmath304 may form intra - molecule hydrogen bonds , or may be connected by water bridge  @xcite ."
  ],
  "abstract_text": [
    "<S> based on multiple short molecular dynamics simulation trajectories that start from dispersively selected initial conformations , we have designed the weighted ensemble dynamics ( we d ) method [ phys rev . </S>",
    "<S> e 80 , 026707 ( 2009 ) ] to robustly and systematically explore complex conformational spaces through the spectral analysis of covariance matrix of trajectory - mapped vectors . </S>",
    "<S> in we d , the non - degenerate ground state of the covariance matrix directly predicts the ergodicity of simulation data , and the ground state can be adopted as the statistical weights of trajectories to correctly reconstruct equilibrium properties , even though each trajectory only explores part of the conformational space . </S>",
    "<S> otherwise , the degree of degeneracy simply provides the number of the kinetically isolated meta - stable states of the system under the time scale of the individual trajectory . </S>",
    "<S> manipulations on the eigenvectors of the matrix with the first a few small eigenvalues leads to the classification of trajectories into non - transition ones within the metastable states and transition ones between these states . </S>",
    "<S> the transition state ensemble may also be predicted only based on these eigenvectors without a priori knowledge of the system . </S>",
    "<S> here , we have further improved the we d method . </S>",
    "<S> several schemes have been designed respectively for depressing the statistical error , systematically selecting the physical variables in analysis , and determining the only adjustable parameter of we d . </S>",
    "<S> besides , we illustrate the application of we d in more complicated examples , including a system with a transition network among multiple states , a system with entropy - dominated states , and a solvated alanine dipeptide system at low temperature . </S>",
    "<S> we d is found to correctly capture the topology of the transition network . </S>",
    "<S> it can also identify the solvent effect for the solvated alanine dipeptide system , as well as the diffusion - like dynamical behavior both in the entropy - dominated system and in the low - temperature solvated alanine dipeptide . </S>",
    "<S> these examples will serve as the references for the application of we d to more complicated biological macromolecules . </S>"
  ]
}