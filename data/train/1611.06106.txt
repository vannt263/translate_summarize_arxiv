{
  "article_text": [
    "in this paper we connect the study of magnetohydrodynamic ( mhd ) waves between two mostly separate fields of inquiry : propagation through stellar atmospheres and propagation near magnetic null points .",
    "mhd waves serve as both a source of observed phenomena ( e.g. , periodic shocks , acoustic halos : * ? ? ?",
    "* ; * ? ? ?",
    "* ) and an effect of other phenomena ( e.g. , magnetic reconnection , convective buffeting : * ? ? ?",
    "* ; * ? ? ?",
    "understanding how waves propagate through the highly inhomogeneous solar atmosphere is therefore essential both for interpreting solar observations and for predicting the consequences of processes we wish to study on the sun .",
    "a detailed study of wave propagation can also be used as a diagnostic for determining the properties of the plasma , for instance through coronal seismology ( see review by * ? ? ? * ) or modeling that reproduces temporal and spectral characteristics of spectral lines @xcite .    in a homogeneous plasma ,",
    "mhd waves come in three basic types , alfvn , slow , and fast @xcite . these correspond to the six roots , one positive and one negative for each wave type , of a single wave equation derived by combining the linearized mhd equations @xcite .",
    "the alfvn wave is always incompressible ; the fast and slow modes may be compressible or incompressible , depending on the situation , and are generically termed magnetoacoustic waves . in an inhomogeneous plasma , three types of waves still typically exist in some modified forms which reduce to the three basic types in appropriate limits .",
    "the modes may also be degenerate in certain locations throughout the plasma @xcite and may therefore exchange wave energy from one type to another in a process termed mode conversion @xcite .",
    "gravity creates a natural inhomogeneity by stratifying the density in the direction of the gravitation force .",
    "decades of studies of mhd waves in atmospheres have used parameters with gradients only in that direction @xcite .",
    "more recently , numerical solutions to the mhd equations have made it much easier to study systems containing gradients in two or three dimensions , usually through a spatially varying magnetic field ( * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "? * ; * ? ? ?",
    "* to name a few ) . however , most of this work has focused on regions where gradients in the magnetic field are small compared to other length scales , for example , in simplified sunspot models @xcite . rapidly varying ( in space )",
    "magnetic fields have received less attention in the context of stratified atmospheres .",
    "in contrast , near a magnetic null point ( where the magnetic field @xmath5 ) the field necessarily has strong gradients , and this greatly affects the behavior of waves propagating nearby . because the phase speed of mhd waves is proportional to the magnetic field strength and traveling waves refract towards regions of low phase speed , mhd waves will tend to be guided towards nulls as they propagate .",
    "the plasma properties are such that the mhd waves become degenerate near nulls , and this allows for mode conversion between the wave types at these locations .",
    "null points are expected to be rather common in the low solar atmosphere ( roughly one per supergranual cell , by multiple estimates : * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ) , so it is vital to understand this fundamental plasma process in the solar context",
    ".    mhd wave propagation near nulls has been extensively studied , especially over the past decade in a series of papers by mclaughlin and coauthors ( * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* where the last two are recent review articles ) .",
    "waves exhibit complex behavior near nulls , and many approximations may be used to reduce that complexity : a cold plasma limit ( @xmath6 , where @xmath7 is the ratio of plasma @xmath8 to magnetic pressure ) , uniform density and temperature backgrounds , linear and/or symmetric nulls , and solving for the linearized instead of full mhd equations , are all common .",
    "the references above have each used combinations of these approximations , and this has greatly informed our understanding of how waves travel through a strongly inhomogeneous plasma . with that background ,",
    "we are in a position to analyze the effects of gravitational stratification and of a magnetic null topology in combination in a single simulation that will adhere much more closely to the inhomogeneous environment spanning from the photosphere to low corona on the sun .",
    "the stratified atmosphere with magnetic field that we will study is described in detail in ",
    "[ sec : strat ] and  [ sec : bini ] and illustrated in figure [ fig : initial - atmo ] .",
    "the atmosphere contains a single null point .",
    "important for now is the fact that the sound speed and alfvn speed ( @xmath9 and @xmath10 , defined in  [ sec : initial ] ) both vary throughout the domain .",
    "the ratio of the two is a key parameter in both stellar atmosphere and finite @xmath11 null point investigations . as explained in  [ sec : ray ] , at locations where @xmath12 there is near equipartition between pressure and magnetic forces , and it is possible for mode conversion to take place ( note that @xmath13 for @xmath14 ) .     (",
    "a ) temperature and density profiles for the initial stratified atmosphere .",
    "dashed line designates the height of the null point , solid line the height of the transition region .",
    "( b ) top : initial magnetic field configuration , with a selection of field lines ( contours of @xmath15 ) .",
    "arrows indicate magnetic direction , and the thick red lines are separatrix field lines connected to the null point at @xmath16 .",
    "equipartition contours , along which @xmath17 , are shown in magenta .",
    "the minus and plus symbols indicate the location of the negative and positive flux sources .",
    "( b ) bottom : vertical field strength along @xmath18,title=\"fig:\",scaledwidth=49.0% ]   ( a ) temperature and density profiles for the initial stratified atmosphere .",
    "dashed line designates the height of the null point , solid line the height of the transition region .",
    "( b ) top : initial magnetic field configuration , with a selection of field lines ( contours of @xmath15 ) .",
    "arrows indicate magnetic direction , and the thick red lines are separatrix field lines connected to the null point at @xmath16 .",
    "equipartition contours , along which @xmath17 , are shown in magenta .",
    "the minus and plus symbols indicate the location of the negative and positive flux sources .",
    "( b ) bottom : vertical field strength along @xmath18,title=\"fig:\",scaledwidth=49.0% ]    there are two equipartition contours in our simulation domain , shown in magenta in figure [ fig : initial - atmo](b ) : the first running horizontally near the lower boundary , the second roughly circular surrounding the null .",
    "the region around the first of these contours has been studied extensively in the case of an isothermally stratified atmosphere and uniform , arbitrarily directed magnetic field ( * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "* see also references in the last of these ) . in that case , the mhd wave equation can be solved analytically . for a concise presentation of the analytic theory , see @xcite and references therein .",
    "the angle of attack between the wavevector @xmath19 and the inclined magnetic field direction determines the coefficients of transmission , reflection , and mode conversion at this layer .",
    "according to equation ( 26 ) of @xcite , the transmission coefficient @xmath20 is @xmath21 where @xmath22 is the total wavenumber , @xmath23 is the attack angle between the wavevector and the ( uniform ) magnetic field direction , and @xmath24 is the scale height of the equipartition region , defined as the derivative along a path @xmath25 of the ratio @xmath26 , evaluated at the equipartition point : @xmath27 .",
    "transmission peaks for @xmath28 and decreases for increasing attack angles .",
    "equation shows how observations of atmospheric oscillations should have a strong dependence on the local magnetic field orientation . despite the simplifications , the analytic theory @xcite captures the essential wave behavior , as verified by numerical simulations and recent observations of acoustic shocks , active region halos , sunspot oscillations , small fluxtube oscillations , running penumbral waves , and many other phenomena @xcite .",
    "@xcite in particular was able to explain the enhanced power around sunspots known as acoustic halos in terms of mode conversion at the @xmath17 layer ( their model contains only a single such layer ) .",
    "recent numerical simulations show how the dependence on formation height of spectral lines , peak frequency of oscillatory power at each location , the surface of equipartition , and the magnetic field direction all combine to fit the conclusions drawn from the analytic models @xcite .",
    "although the magnetic field in our model varies all along the lower equipartition curve of figure [ fig : initial - atmo](b ) , and substantially more than in the slowly varying sunspot models of , e.g. , @xcite and @xcite , the major difference between it and these other models is the presence of the null .",
    "surrounding the null point in figure [ fig : initial - atmo](b ) is the second equipartition curve along which @xmath17 .",
    "wave dynamics at nulls have been studied before , but are not well studied in the context of the low solar atmosphere , where finite plasma @xmath11 , partial ionization , and stratification are all important .    linear nulls with",
    "@xmath6 have received the most attention @xcite . for a linear null , @xmath29 , the radial distance from the null . as the pressure forces are set to zero the equipartition curve surrounding the null shrinks to zero , and the slow magnetoacoustic wave",
    "is no longer a solution to the mhd wave equation ; mode conversion is thus precluded for @xmath6 . for linearized mhd",
    ", the fast mode velocity decreases to zero at the null , so that the fast mode can not pass through the null and instead becomes trapped .",
    "this can be visualized using a wentzel ",
    "kramers  brillouin ( wkb * ? ? ?",
    "* ) method to trace rays for the mhd waves , in analogy to geometric optics ( see  [ sec : ray ] and appendix [ sec : wkb ] ) .",
    "the radial increase in the phase speed ( and hence index of refraction ) causes incident rays to spiral inwards @xcite .",
    "the wavelength of the incoming waveform decreases , causing an exponential increase in the current density at the null in the limit of no resistivity .",
    "these results generalize to linear nulls in three dimension @xcite .",
    "departures from ( i ) zero resistivity , ( ii ) linearized mhd , ( iii ) a linear null , or ( iv ) zero @xmath11 will substantially alter the behavior described above .",
    "( i ) finite resistivity causes partial reflection of an incident wave from the null point , even in a @xmath6 plasma @xcite : wave energy is neither perfectly ohmically dissipated nor perfectly reflected at the null .",
    "( ii ) nonlinear mhd effects create shocks , which allows the fast wave to pass through the null @xcite .",
    "( iii ) for more realistic magnetic fields , at some radius the linear null approximation is no longer valid .",
    "examples are the quadrupolar fields studied by @xcite and @xcite , the double null system of @xcite , or any field extrapolated from a photospheric magnetogram @xcite . in these cases ,",
    "inflection points in the spatial variation of the phase speed will cause a wave front to split , so that a portion of the wave refracts towards the null while other portions refract away .",
    "refraction is thus very important for the propagation of fast waves because they travel nearly isotropically relative to the magnetic field , and this is true even for @xmath6 .",
    "\\(iv ) a finite @xmath11 produces more dramatic changes than relaxing assumputions ( i ) , ( ii ) , and ( iii ) by reintroducing the slow mode and allowing a coupling between the fast and slow waves @xcite . the phase speeds of the fast and slow waves are now everywhere nonzero and it is possible for linear waves ( or rays in the wkb approximation ) to pass through a null .",
    "the wave speed still varies substantially near the null and causes a focusing effect .",
    "this can lead to shock formation and the collapse of the null into a current sheet , both of which dissipate to heat the plasma .",
    "the general conclusion is that including pressure forces does not simply allow wave energy to pass smoothly through a null @xcite .    the finite @xmath11 wave ",
    "null interaction studies referenced above have all used ad hoc initial conditions , such as an initially circular pulse that fully surrounds the null .",
    "we will study the more realistic situation where a wave is introduced by boundary driving , mimicking a convective process , and is allowed to propagate self ",
    "consistently into the null point region .",
    "we will focus our study on the properties of the waves in the vicinity of the null point , with particular emphasis on how they are affected by the equipartition region surrounding the null and the nontrivial topology of the null .",
    "we will answer several questions : how much of the initial energy of the wave packet is incident upon the null ?",
    "what is the efficiency of mode conversion around the null ?",
    "how much of the initial energy makes it to the coronal portion of the domain ?",
    "answering these questions will serve two purposes . first , to advance the study of mhd wave behavior around magnetic null points , which is a fundamental process in plasma physics ; and second , to understand how an inhomogeneous magnetic field affects wave propagation in stellar atmospheres .",
    "we use a combination of ray tracing , for the linearized mhd equations , and numerical simulations of the full , nonlinear equations to study the propagation of a wavepacket through the domain .",
    "we find that mode conversion between branches of the dispersion relation plays a dominant role in the resulting dynamics .",
    "we identify the locations of mode conversion , and quantify both the amount of conversion surrounding the null point and the amount of dissipation near the null point .",
    "the remainder of the paper is outlined as follows : in  [ sec : initial ] we describe the numerical code , lare2d @xcite , and discuss the initial atmosphere and magnetic equilibrium .",
    "the same background atmosphere is used for both the ray tracing and numerical analyses . ",
    "[ sec : ray ] describes the ray tracing procedure and important energy densities associated with the different types of waves .",
    "we briefly compare our ray tracing results to those of others , particularly mclaughlin and coauthors .",
    " [ sec : driver ] describes the time ",
    "dependent boundary condition and  [ sec : results ] presents the results of the resistive mhd simulation .",
    "we show how the wave pulse propagates through the atmosphere and quantify the amount of mode conversion between branches of the dispersion relation at topologically important locations .",
    "we find that mode conversion strongly influences the propagation of wave energy density through the system .",
    "we determine the amount of energy that escapes into the corona and note the accumulation and dissipation of current density at the null and along the separatrices . in  [ sec : driver - distribution ] we return to the ray tracing analysis to model the wavepacket s propagation .",
    "we estimate the amount of energy expected to arrive at the null and compare that to the numerical simulation results .",
    "we discuss our results in a broader context in ",
    "[ sec : discussion ] , and finally summarize and conclude in  [ sec : conclusion ] .",
    "we solve the resistive magnetohydrodynamic equations in 2.5 dimensions in cartesian coordinates using the lare2d code @xcite .",
    "the horizontal and vertical directions are @xmath30 and @xmath31 , and the out  of  plane direction is @xmath32 .",
    "we notate spatial points by @xmath33 and velocities by @xmath34 .",
    "individual components may also be referenced in the standard way by a subscript @xmath35 or @xmath36 : @xmath37 . in order ,",
    "the equations describe mass , momentum , and energy conservation , and the magnetic induction : @xmath38 @xmath39 is the advective derivative . owing to the translational invariance in @xmath32 ,",
    "all derivatives in the out  of  plane direction are zero .",
    "our primitive variables are mass density , specific internal energy , plasma velocity , and magnetic field , @xmath40 , respectively .",
    "the current density is defined through @xmath41 where @xmath42 is the permeability of free space .",
    "the stress tensor has components @xmath43 with @xmath44 , and we use a uniform viscosity @xmath45 .",
    "we set the resistivity to @xmath46 the viscosity and resistivity are such that the reynolds number @xmath47 and the lundquist number @xmath48 , which we discuss in more depth below .",
    "temperature , internal energy , and pressure are related through the ideal gas law @xmath49 with @xmath50 boltzmann s constant and @xmath51 the ratio of specific heats .",
    "gravitational acceleration is set to the solar value of @xmath52 , with @xmath53 .",
    "we use the fully ionized limit of mhd , but set the reduced mass to the average ion mass , @xmath54 .",
    "this choice more correctly reproduces coronal densities ( see discussion in * ? ? ?",
    "the factor @xmath55 models the effect of heavy ions .",
    "we normalize the governing equations - by writing each variable as a constant multiplying a normalized coordinate : @xmath56 and so on .",
    "we set @xmath57 and @xmath58 .",
    "@xmath59 is the photospheric density , and @xmath60 approximately the scale height at the photosphere .",
    "all other variables may be defined through these three .",
    "the velocity normalization , for instance , is @xmath61 the photospheric alfvn speed for unit magnetic field .",
    "time normalization is @xmath62 .",
    "the viscosity is normalized to @xmath63 .",
    "we define the reynolds number @xmath64 using the photospheric alfvn speed and scale height . using this",
    ", we set the normalized viscosity to @xmath65 resulting in the value @xmath66 quoted above . from here on we take all variables to be normalized unless explicitly stated , and suppress the star notation .",
    "our domain extends from the photosphere at the lower boundary up to the low corona .",
    "the initial thermodynamic equilibrium is set to be invariant in @xmath30 , so that @xmath67 ( a subscript @xmath68 will be used to refer to initial state for all variables ) .",
    "we model a low temperature photosphere , steep transition region , and isothermal corona as a hyperbolic tangent function : @xmath69 the parameters are @xmath70 , @xmath71 , @xmath72 , and @xmath73 .",
    "the initial density profile is determined by numerical integration of the hydrostatic equation , @xmath74 , with @xmath75 as a boundary condition .",
    "figure [ fig : initial - atmo](a ) shows the initial hydrostatic equilibrium for temperature ( left axis ) and density ( right axis ) on a log scale .",
    "we use a uniform staggered grid of @xmath76 cells , with @xmath77 and @xmath78 defined at cell centers , @xmath79 at cell vertices , and @xmath80 at cell faces ( see * ? ? ?",
    "* for details ) .",
    "the cell width is @xmath81 which sets the size of our domain to @xmath82 and @xmath83 .",
    "finally , we estimate the magnitude of numerical diffusion caused by the finite difference scheme using the method of @xcite .",
    "we consider the 1d analog to , @xmath84 , taylor expand the second order finite difference equation , and isolate the error term , whose coefficient is the effective numerical resistivity , @xmath85 .",
    "we find that @xmath86 , where @xmath87 is a typical length of the dynamic evolution and @xmath88 the fastest wave speed .",
    "for a worst case scenario corresponding to a shock across three cells , @xmath89 .",
    "if @xmath90 at locations where shocks form , we find that @xmath91 in the normalized units defined below .",
    "we have run multiple simulations varying only the explicit resistivity and checking the solution in regions of strong gradients ( there is little discernible effect outside these regions ) .",
    "we found that explicit resistivity begins to dominate over the numerical resistivity at the expected value @xmath92 , confirming our approximate calculations .",
    "we therefore use this value of resistivity for our simulations .",
    "this ensures that resistive effects are due to the explicit term in equations and , while simultaneously keeping the resistive effects as small as possible , for the chosen grid resolution .",
    "resistivity is normalized to @xmath93 , so that @xmath94 is the lundquist number defined using the pressure scale height at the lower boundary .",
    "the results are the values of resistivity and lundquist number stated above .      to the hydrostatic background we add an initial magnetic field derived from a flux function , @xmath95 , @xmath96 while @xmath97 and @xmath98 are both zero .",
    "as figure [ fig : initial - atmo](b ) shows , the flux function includes three sources of flux ( per ignorable length ) @xmath99 , each located at depth @xmath100 , and having horizontal locations @xmath101 the inner source @xmath102 has the opposite sign of flux of the outer two , @xmath103 .",
    "the resulting magnetic field contains one null point , located at @xmath104 we choose @xmath105 which sets @xmath106 and @xmath107 , creating a maximum vertical field at the lower boundary of @xmath108 for each source . the field strength along the lower boundary is shown in the bottom panel of figure [ fig : initial - atmo](b ) .",
    "the magnetic field generated by is a potential field , whose @xmath32 component analytically satisfies laplace s equation @xmath109 , and @xmath110 as well .",
    "however , the second order finite difference scheme used by lare2d results in spurious currents , as may be found by substituting the taylor series expansion of eq   into the finite difference scheme .",
    "all odd order derivative terms cancel numerically , the second derivative term correctly reproduces the laplacian , but even order derivative terms of order @xmath111 and higher do not cancel in general .",
    "the initial condition is therefore slightly out of force balance .",
    "we allow the system to come to equilibrium during an initial relaxation period for each simulation .",
    "the resulting changes are minimal , though the largest changes are near the x  point .",
    "the change in @xmath112 is everywhere",
    "@xmath113 and less than @xmath114 for more than @xmath115 of the domain ; the change in internal energy density is everywhere less than @xmath114 . for the remainder of this paper",
    ", we refer to @xmath116 as the end of this initial relaxation , and only discuss dynamics for @xmath117 .",
    "subscripted variables @xmath118 therefore refer to this background initial condition .",
    "lare2d requires two ghost cells surrounding the domain to implement the boundary conditions . in the convection zone",
    ", the increasing sound speed will eventually cause waves to refract upwards at a depth that depends on the horizontal wavelengths of the waves .",
    "we therefore use a reflective lower boundary , and add to it a time dependent driver , as described in  [ sec : driver ] .",
    "the phase of the waves reflected from our lower boundary will not be accurate , but this does not affect our analysis in  [ sec : results ] , which focuses on the region near the null before any reflections reach it .",
    "the side boundaries are line tied and the top boundary is zero gradient .",
    "linear damping regions are implemented for both , and these reduce the velocities in a cell based on distance to the boundary .",
    "this has the effect of removing kinetic energy from the system .",
    "the amount of reduction starts at @xmath68 at @xmath119 or @xmath120 and increases towards the appropriate boundary ( left , right , or top ) .",
    "if @xmath121 is the size of the damping region @xmath122 in @xmath31 , @xmath123 in @xmath30 ) and @xmath124 is the distance from a cell within the damping region to the the start of the region , then at each time step the velocities in that cell are reduced by a factor @xmath125 , where @xmath126 is the numerical time step .",
    "our analysis will focus on dynamics near the null point and magnetic dome , and testing has shown that the damping regions prevent the majority of reflections , leading to a small contribution to the dynamics at locations of interest .",
    "( a ) variation of the sound speed ( grayscale ) and alfvn speed ( thin blue contour lines ) within the domain .",
    "the contours are in steps of @xmath127 between @xmath128 and @xmath129 ( several indicated ) .",
    "thick red lines mark the locations of separatrices , and the thick magenta lines show where @xmath130 ( b ) the value of @xmath131 throughout the domain ( solid black ) , and @xmath132 along two vertical slices : @xmath133 ( dashed ) and @xmath134 ( red).,scaledwidth=50.0% ]    an important aspect for wave propagation is the structure of the sound and alfvn speed throughout the domain .",
    "hydrostatic stratification creates a sound speed that varies vertically only : @xmath135 .",
    "this vertical sound speed stratification is shown as grayscale in figure [ fig : csva](a ) and as the solid black line in figure [ fig : csva](b ) .",
    "the sound speed ranges from @xmath136 within the domain .",
    "the alfvn speed is structured horizontally as well as vertically : @xmath137 .",
    "thin solid blue lines in figure [ fig : csva](a ) show contours of the alfvn speed , in steps of @xmath138 , with the value indicated at several levels .",
    "the function has a minimum at the null point where @xmath139 , and a maximum of @xmath140 in the two lobes on either side at @xmath141 .",
    "there are two saddle points along @xmath142 , at @xmath143 and @xmath144 , though these are not on the same contour level .",
    "figure [ fig : csva](b ) shows the alfvn speed along two vertical slices , one passing through the null at @xmath134 ( red ) , the other passing near the left maximum at @xmath145 ( dashed line ) .",
    "we will use lare2d to solve the full , nonlinear set of equations to .",
    "however , we will also use linear theory to determine the form of a wave packet injected into the system , approximate its propagation through the ( stationary ) background , and help interpret the simulation output . for this linear analysis",
    ", we set the viscous and resistive terms to zero , and add a perturbation to each background quantity : @xmath146 , and @xmath147 .",
    "the linearized ideal mhd equations are then @xmath148 we have assumed an adiabatic relation between the perturbed pressure and density , @xmath149 .",
    "these equations may be combined to yield a conservation relation for wave energy density and energy flux ( * ? ? ?",
    "appendix [ sec : waveflux ] ) : @xmath150 + { \\nabla}\\cdot\\bigl[p_1{\\mathbf{v}}_1+\\frac{1}{{{\\mu_0}}}({\\mathbf{b}}_0\\times{\\mathbf{v}}_1)\\times{\\mathbf{b}}\\bigr]=0 .",
    "\\intertext{we can identify each term in \\eqref{eq : wave - conservation } in order : the energy densities are kinetic ( $ e_k$ ) , acoustic $ ( e_a)$ , magnetic ( $ e_m$ ) , and gravitational $ ( e_g)$ , while the energy fluxes are acoustic $ ( { \\mathbf{f}}_a)$ and magnetic ( poynting , $ { \\mathbf{f}}_m$ ) : }    \\label{eq : wave - cons - short}\\partial_te = \\partial_t(e_{k}+e_{a}+e_m+e_g ) = -{\\nabla}\\cdot{\\mathbf{f}}=-{\\nabla}\\cdot({\\mathbf{f}}_{a}+{\\mathbf{f}}_{m}).\\end{gathered}\\ ] ] we can further group the energy density terms into kinetic ( @xmath151 ) and potential ( @xmath152 ) parts . in the gravitational term , @xmath153 is the vertical displacement of a fluid element . for frequencies greater than a few times",
    "the brnt  visl frequency ( @xmath154 ) , the gravitational term becomes increasingly less important than the other terms @xcite .",
    "we will focus on frequencies of @xmath155 , and therefore drop this term from our analysis .",
    "the above equation involves real quantities that may be directly calculated from the output of the simulation at each time @xmath156 : @xmath157 , and so on .",
    "this will be useful for determining the amount and type of wave energy at various locations in the simulation .",
    "on the other hand , how the wave energy propagates through the system should be controlled by the properties of the background state . to determine wave propagation , we first combine the linearized equations - into a single wave equation for the velocity perturbations by taking the time derivative of the momentum equation and substituting in the continuity , energy , and induction equations .",
    "the result is @xmath158\\bigr\\}\\times{\\mathbf{b}}_0 + { \\mathbf{g}}(\\gamma-1){\\nabla}\\cdot{\\mathbf{v}}_1+{\\nabla}({\\mathbf{g}}\\cdot{\\mathbf{v}}_1 ) \\\\    & + ( { \\mathbf{g}}\\cdot{\\mathbf{v}}_1)\\bigl[\\frac{{\\nabla}c_s^2}{c_s^2}+\\frac{c_s^2}{\\rho_0}{\\nabla}(\\frac{\\rho_0}{c_s^2})-\\frac{{\\mathbf{g}}}{c_s^2}\\bigr]\\notag.\\end{aligned}\\ ] ] we assume each perturbed quantity varies in space and time only by a common phase term : @xmath159 .",
    "next we apply the wkb approximation @xcite that the phase function varies much more rapidly than any background quantity : @xmath160 , where @xmath161 represents any spatial scale of the background .",
    "we again drop the explicit gravitational terms from consideration , though note that part of the stratification s effect is implicit through the spatial dependence of @xmath9 and @xmath162 . after applying these assumptions , we can write the wave equation in dyadic notation ( c.f . * ? ?",
    "? * ; * ? ? ?",
    "* who kept the explicit gravitational term ) : @xmath163\\cdot{\\mathbf{v}}_1,\\ ] ] where @xmath164 is the unit dyad . setting the determinant of this equation to zero",
    ", we find the dispersion relations for alfvn ( @xmath165 ) and fast and slow ",
    "magnetoacoustic waves ( @xmath166 ) : @xmath167\\biggr)=0.\\ ] ] the angle between the propagation direction and the magnetic field ( the attack angle or phase angle ) is defined through @xmath168 .",
    "equation has the same form as the standard relation for a homogeneous compressible plasma @xcite .",
    "the wkb approximation we have used simply takes @xmath169 and @xmath131 to be spatially varying functions rather than uniform .",
    "the determinant factors into @xmath170 , which describe separate conditions on @xmath19 for a given frequency @xmath171 for the alfvn , fast , and slow mode , respectively ( we will generically apply the subscripts @xmath172 to indicate solutions for each branch ) .",
    "note that in each case the relation between frequency and wavenumber is linear , of the form @xmath173 .",
    "this is the relation for dispersionless waves , where each frequency wave propagates in the same way , just as for mhd waves in a homogeneous plasma . retaining the gravitational terms in introduces dispersion at low frequencies near the brnt  visl frequency .",
    "our first order wkb approximation therefore includes the effect of refraction but excludes dispersion , which is unimportant for high frequency waves .",
    "each mode will propagate through the system along a different path .",
    "as explained in more detail in appendix [ sec : wkb ] , we can trace the path of a ray ( say the fast ray ) @xmath174 , where @xmath25 parametrizes the distance along the ray , by picking an initial condition @xmath175 and solving for @xmath176 and @xmath174 subject to the constraint that the correct condition is satisfied , i.e. , @xmath177 for the fast ray ) .",
    "the result is that the ray satisfies hamilton s equations @xmath178 where @xmath171 comes from the condition @xmath179 .",
    "we give explicit expressions for these equations for the fast and slow ray in appendix [ sec : wkb ] ; the alfvn waves simply follow field lines .",
    "note that @xmath180 , the wave s group velocity .",
    "this is the velocity at which energy is transferred along the ray , and is equal to @xmath181 from .",
    "the energy relation is true up to the assumption that there is no dissipation and that the wave stays on a single branch of this dispersion relation , a point that we will return to repeatedly in the following .",
    "the fast and slow branches of the dispersion relation change their characters as the plasma shifts between pressure and magnetically dominated regions .",
    "the fast mode is increasingly acoustic ( potential energy dominated by @xmath182 ) for @xmath183 and magnetic ( dominated by @xmath184 ) for @xmath185 , while the opposite is true for the slow mode .",
    "mode coupling is allowed under certain conditions @xcite , where the essential requirement is that the gradient of the phase function @xmath186 for each mode be similar in a region of space , so that , for example , @xmath187 .",
    "this can occur where the phase speeds ( @xmath188 ) of the two modes are approximately equal , along the equipartition curves where @xmath189 .",
    "@xcite and @xcite explain the typical terminology used in the helioseismic literature for mode conversion and transmission .",
    "physically this depends on which term dominates , @xmath190 or @xmath184 , and if that changes as a wave propagates .",
    "conversion refers to waves whose energy shifts from the magnetic to acoustic term ( or vice versa ) while staying on the same branch of the dispersion relation ; transmission refers to a wave whose dominant potential energy term remains nearly the same as it propagates .",
    "thus , an acoustic fast wave originating from below the equipartition height may continue propagating as a magnetic fast wave above the equipartition height , and mode conversion is said to have taken place . because the ray theory is a solution along a single branch of the dispersion relation , it assumes perfect conversion .",
    "these definitions depend only the properties of the wave , can be determined directly from the full mhd simulation presented in ",
    "[ sec : results ] , and are therefore to be preferred .     fast ray paths through the domain .",
    "( a ) a ray bundle , with each ray ( rainbow colors ) traced for an initially vertically propagating disturbance , initiated at intervals of 5 pixels along the lower boundary .",
    "( b ) 6 rays indicating boundaries in the domain for rays launched for @xmath191 .",
    "rays launch from the lower boundary between the two yellow paths refract in towards the null point , while rays launched outside of the outer two green paths refract back down to the photosphere .",
    "rays launched from the small areas between these curves reach the side or top boundaries without passing close to the null .",
    "the pattern has reflection symmetry about @xmath134.,title=\"fig:\",scaledwidth=48.0% ]   fast ray paths through the domain .",
    "( a ) a ray bundle , with each ray ( rainbow colors ) traced for an initially vertically propagating disturbance , initiated at intervals of 5 pixels along the lower boundary .",
    "( b ) 6 rays indicating boundaries in the domain for rays launched for @xmath191 .",
    "rays launch from the lower boundary between the two yellow paths refract in towards the null point , while rays launched outside of the outer two green paths refract back down to the photosphere .",
    "rays launched from the small areas between these curves reach the side or top boundaries without passing close to the null .",
    "the pattern has reflection symmetry about @xmath134.,title=\"fig:\",scaledwidth=48.0% ]      figure [ fig : ray - paths ] shows the trajectories for bundles of fast magnetoacoustic rays , which are solutions for the @xmath192 branch of the dispersion relation . the slow waves ( solutions to @xmath193 ) simply follow the field lines to a high degree of accuracy , and we do not show them here .",
    "the thick red and magenta lines again show the separatrices and the two contours where @xmath17 , while select contours of the alfvn speed from figure [ fig : csva ] are shown as thin blue lines , for easy comparison . over this background , panel ( a ) shows the paths for a bundle of fast rays initialized from the lower boundary as vertically propagating ( @xmath194 ) fronts between @xmath195 $ ] , with each ray depicted in a different color .",
    "clearly visible is the importance of refraction due to the inhomogeneous background : rays refract away from ( towards ) regions of high ( low ) phase speed in an amount that depends on the angle between their propagation direction and the local magnetic field direction . from left to right in the figure , the rays refract back down towards the photosphere ( purple  to  yellow rays ) , escape through the side or upper boundaries without passing near the @xmath17 region surrounding the null ( yellow  to  orange ) , and pass near the conversion region surrounding the null point ( orange  to  red ) .",
    "an important feature of the ray solution is that some rays propagate directly through the @xmath17 region surrounding the null point .",
    "this is because @xmath196 and in the wkb approximation the fast ray describes a wave that transitions smoothly from magnetically dominated to acoustically dominated perturbations .",
    "these rays cross each other multiple times , forming multiple sets of caustics . @xcite",
    "have studied similar caustics both analytically and visually by determining ray trajectories near a linear 2d null point for a @xmath196 plasma with uniform density and temperature . in our case , tracing the paths of many rays which pass near the null point ( not shown here ) results in a very similar pattern of caustics as those in figure 3 of @xcite .",
    "the differences arise because of the stratification : near the null , our magnetic field is fairly linear in the horizontal direction , but not in the vertical direction .",
    "in contrast , for a @xmath197 plasma the slow mode solution vanishes from the dispersion relation , and the wave speed of the fast rays decreases to zero at the null . in that case , the ray paths form logarithmic spirals focused on the null point ( * ? ? ? * ; * ? ? ? * in particular , see figure 7 of the former ) , accumulating strong currents at the null which can then dissipate .",
    "as has been noted before , the existence of a finite plasma pressure term thus makes focusing of wave energy on a null point more difficult than it otherwise would be .",
    "we will explore this in more detail below by direct numerical simulation .",
    "figure [ fig : ray - paths](b ) depicts a connectivity graph via a set of bounding rays for initially vertically propagating fast rays initialized in the left half of the domain , between @xmath198 and @xmath199 .",
    "the two leftmost green rays are traced from the centers of adjacent computational cells , and illustrate how quickly ray paths may diverge .",
    "rays traced further to the left of these , ( initial location @xmath200 ) all have turning points and close back down at the photosphere .",
    "this is the typical behavior for low @xmath11 fast modes when the alfvn speed increases with height .",
    "rays traced to the right of @xmath201 display a much different behavior , and increasingly refract towards the null point .",
    "the two yellow lines are bounding curves for rays that refract strongly toward the null point .",
    "rays launched between the rightmost green ray and the center of the domain ( between @xmath202 ) again exhibit a turning point and refract back downward to the photosphere .",
    "the pattern repeats in mirror ",
    "image for rays launched from the positive @xmath30 side of the domain , due to the reflectional symmetry of the system .",
    "fast ray paths for a single initial location @xmath203{\\ensuremath{\\ , \\mathrm{mm}}}$ ] and a range of initial propagation directions @xmath204 , up to @xmath205 to the vertical .",
    "plusses are spaced at travel times of @xmath206,scaledwidth=48.0% ]    the path of a ray depends on its initial propagation direction , @xmath207 , in addition to its initial location .",
    "figure [ fig : ray - angles ] shows the paths of fast rays launched from a single initial position near the lower boundary , @xmath208{\\ensuremath{\\ , \\mathrm{mm}}}$ ] , and initial propagation directions @xmath209 up to @xmath205 to the vertical ( @xmath210 ) , in steps of @xmath211 .",
    "these values correspond to the center of the wavepacket we use to drive the numerical simulation , described in  [ sec : driver ] , and its initial range of propagation angles , as determined in ",
    "[ sec : driver - distribution ] .",
    "the plus marks along each ray are equally spaced in units of travel time , at intervals of @xmath212 , or , equivalently , through the phase distance @xmath25 .",
    "each set of equal time points thus traces out a front of constant phase @xmath213 .",
    "the phase fronts are more closely spaced in the lower portion of the figure , where both the sound and alfvn speeds are small , and more widely spaced higher up where the phase speeds are greater .",
    "the set of all phase fronts fills in the phase function throughout the domain .",
    "rays passing close to the null equipartition region again display complex trajectories . a steady prograde change in initial angle of propagation does not lead to a steady prograde change in the direction of the outgoing ray . instead , outgoing rays jump from prograde to retrograde change several times .",
    "the rays cross , and so the phase function is , in general , multivalued throughout the domain .",
    "we can combine the ray tracing results to try to predict how an initial , localized disturbance will propagate through the system . a spatially localized wavepacket launched from the lower boundary will exhibit a combination of the behaviors illustrated by the ray paths of figures [ fig : ray - paths ] and [ fig : ray - angles ] . at each spatial location",
    ", the packet will be best described by a range of propagation directions . in  [ sec : driver - distribution ] we will need to know the range of initial propagation angles that pass through the null point s equipartition layer . to determine this",
    ", we initialized fast rays between @xmath145 and @xmath214 with propagation directions @xmath215 in steps of @xmath216 .",
    "we recorded each ray s closest approach , @xmath217 , to the centroid of the equipartition layer , located at @xmath218{\\ensuremath{\\ , \\mathrm{mm}}}$ ] ( note that the equipartition centroid is shifted slightly above the null point , due to the stratification ) .",
    "the null s equipartition curve is approximately circular , with a radius @xmath219 .",
    "figure [ fig : ray - ca](a ) shows the result for angles between @xmath220 , with the closest approach distance for each ray displayed in logarithmic scale as a function of the initial ray location ( abscissa ) and initial propagation angle ( ordinate ) .",
    "the distribution is nearly flat outside of this angle range , as seen in figure [ fig : ray - ca](b ) .",
    "rays with positive ( negative ) angles initially propagate in the positive ( negative ) @xmath30 direction .",
    "the red , green , and blue contours correspond to @xmath221 and @xmath222 times @xmath223 .",
    "we take @xmath224 to define a region of influence for the null .",
    "this region is based on the equipartition scale height , @xmath225 , so that @xmath226 .",
    "therefore , rays initialized at the lower boundary with initial propagation angles falling between the green curves are strongly influenced by the null point .",
    "the three vertical lines in figure [ fig : ray - ca](a ) show the location of slices through the contour plot , and are displayed as line plots in figure [ fig : ray - ca](b ) .",
    "the range of angles for which rays pass near the null reaches a maximum for rays initialized near @xmath227 and a minimum around @xmath228 and @xmath229 , where the separatrices intersect the lower boundary ( squares in top panel ) .",
    "the actual range of angles undergoes significant variation , is typically not centered on @xmath230 , and has multiple inflection points .",
    "only two sets of vertically propagating rays , one between @xmath231 and @xmath199 , and the other in a narrow range around @xmath232 , pass close to the null .",
    "the first of these corresponds to the region between the yellow rays of figure [ fig : ray - paths](b ) .",
    "several dark bands run through the entire @xmath233 plot and indicate rays that pass very close to the center of the interaction region , almost directly through the null .",
    "there are typically multiple distinct dark bands for a given @xmath234 .",
    "this is a manifestation of the prograde  retrograde  prograde behavior of outgoing rays discussed for figure [ fig : ray - angles](b ) .",
    "the angles at which the behavior changes for a given @xmath234 are located at the minima along vertical slices through the plot ( see , e.g. , the slices plotted in figure [ fig : ray - ca](b ) ) .",
    "interestingly , the dark band that arises around @xmath235 bifurcates at @xmath236 . moving further right ,",
    "the three distinct bands at that point remain distinct across @xmath237 which can be seen as the three small dips in the solid curve of figure [ fig : ray - ca](b ) .",
    "we have found the ray tracing analysis to be a useful tool for understanding the properties of our model atmosphere , and , as will become apparent , for analyzing and interpreting the mhd simulation presented in the next two sections . here , we summarize our results from the ray theory and point out several important differences from previous ray tracing investigations .",
    "we used a wkb method to estimate how a fast mode wavepacket crossing the lower boundary will propagate through the background field .",
    "the wkb theory assumes that a ray stays on a single branch of the dispersion relation .",
    "a wavepacket is a spatially localized disturbance with a distribution of wave vectors @xmath19 .",
    "thus , to see how a wavepacket will propagate , we traced rays from multiple initial positions and using multiple initial phase angles , with several examples show in figures [ fig : ray - paths ] and [ fig : ray - angles ] .",
    "we found that some rays will refract towards the null point , while most will refract back downwards towards the photosphere .",
    "a small segment between these two regions appears able to propagate to the top of our domain ( and hence to infinity ) , as shown by figure [ fig : ray - paths](b ) for initially vertically propagating rays . for rays that refract back downward",
    ", the height of the turning point depends on the gradient of the phase velocity along each ray path ( we have not attempted to analytically derive the turning point for our horizontally inhomogeneous background ) .",
    "rays reaching the interaction region surrounding the null exhibit complex behavior , with some eventually refracting back towards the lower boundary , some reaching the top and side boundaries , and many adjacent rays crossing paths , some at multiple locations .",
    "the set of fast rays that pass near the null is a function of both the initial ray location and propagation direction .",
    "we did not discuss solutions for the slow waves using @xmath238 in any detail .",
    "the properties of slow mhd waves are well known for homogeneous plasmas and can be found , for instance , in  5.3.2 of @xcite . in that case , the maximum departure of the group velocity from the magnetic field direction , the return angle @xmath239 , is @xmath240 .",
    "it occurs for @xmath13 and for a phase angle @xmath241 . for different phase angles and different values of the ratio @xmath26 ,",
    "the return angle is much smaller , typically @xmath242 . to check that this carries over to the inhomogeneous case , we initialized slow rays at several hundred initial locations and wave vectors . for a given ray ,",
    "the maximum departure from the magnetic field direction is typically less than @xmath243 , and less than @xmath244 for all rays , as in the homogeneous case . for most of the distance along each ray",
    "we find departures of @xmath245 .",
    "rays that do make a substantial angle to the magnetic field typically do so only for small portions of their trajectories near the @xmath17 boundaries , after which they closely follow the field .",
    "our analysis differs from ray tracing used in studies of sunspots with slowly varying magnetic fields @xcite .",
    "they typically focus on the low frequency dispersion and the variation of the cutoff frequency due to the magnetic field , which we ignore .",
    "these are very important effects for the interpretation of phase relations determined from observations ( see * ? ? ?",
    "* and references therein ) .",
    "other authors have performed ray tracing through magnetic configurations containing nulls @xcite . here",
    ", the focus is typically quite different compared to the sunspot studies , and addresses whether wave energy is reflected by the null or accumulated at the null , how to determine characteristic damping timescales , etc .",
    "we will consider these studies more in the discussion ,  [ sec : discussion ] .",
    "it is important to keep in mind how altering our initial condition would modify the ray behavior ( the ease with which this is accomplished is one of the main advantages of the wkb method ) .",
    "suppose the magnetic field is everywhere reduced to zero , but the stratification is kept the same .",
    "then upward propagating fast rays , now degenerate to purely hydrodynamic sound waves , still refract off the increasing sound speed , and eventually reflect from a height where their frequency divided by wavenumber matches the local sound speed .",
    "if instead we keep the magnetic field the same but set the density and temperature to uniform values , we find that a set of rays spiral in towards the null , as has been found many times before for both linear and more complicated nulls @xcite .",
    "comparison with figures [ fig : ray - paths ] and [ fig : ray - angles ] demonstrates that the vertical stratification breaks the radial symmetry close to the null and prevents the logarithmic inspiral .",
    "these difference arise just from the linear ( wkb ) theory , and are in addition to any shock formation or mode conversion that may arise when solving the nonlinear mhd equations , as we will do in  [ sec : results ] .",
    "the combination of stratified atmosphere , compressive waves , and nontrivial topology has not been well studied , and represents one significant advance of this present work .",
    "not included in our wkb analysis is the rate of mode conversion between fast and slow modes .",
    "so , although many fast ray paths do pass through the interaction region around the null , as shown in figure [ fig : ray - ca ] , it remains to determine how much energy stays on the @xmath192 branch and how much converts to the @xmath238 branch .",
    "slow waves thus generated will ultimately have different trajectories upon exiting the conversion region compared to the fast waves .",
    "we now turn our attention to the numerical solution of equations to to answer this question .",
    "ccrlrlcc f_d & _ d/2 & 6.0/2 & t_n^-1 & 40 & @xmath246 & ( 25.42@xmath247 ) & central frequency + k_y & _ d / c_s & 4.533 & l_n^-1 & 30 & @xmath248 ^ -1 & (= 0.2@xmath248 ) & central wavenumber + w_x &  & 1.977 & l_n & 0.297 & @xmath248 &  & width ( x ) + w_y &  & 0.4567 & l_n & 0.069 & @xmath248 &  & width ( y ) + t_d & _ dw_y / c_s & 2.07 & t_n & 50.25 & @xmath247 &  & driver duration + v_d &  & 0.1 & v_n & 0.6177 & @xmath249@xmath247 ^ -1 &  & driver amplitude +    to study energy propagation and dissipation through our system , we use a time dependent lower boundary to introduce acoustic wave packets and mimic a wave generation mechanism in the solar atmosphere .",
    "the driver properties are summarized in table [ tab : driver ] .",
    "the perturbations are defined through a spatially dependent vertical velocity , @xmath250 , with amplitude @xmath251 : @xmath252\\sin\\bigl[k_y(y - y_d)-\\omega_d t\\bigr].\\ ] ] for a homogeneous plasma , the density and energy perturbations consistent with the velocity perturbation are @xmath253 the form of the above variation ignores components in the @xmath30 direction , but nevertheless primarily excites a fast acoustic wavepacket at the lower boundary , as discussed below .",
    "similar functional forms have been used to model , for instance , p  mode excitation in sunspot umbra @xcite .",
    "we do not introduce any perturbations to the out  of  plane variables . because our initial condition has @xmath254 , and",
    "because all out  of  plane derivatives are zero in 2.5d , it is clear from the momentum and induction equation that no out  of  plane component can later be generated .",
    "this decouples the alfvn mode from our simulation ( both numerically and analytically ) , and hereafter we focus only on the fast and slow magnetoacoustic modes .",
    "lare2d does update @xmath255 and @xmath256 , and we have verified that they remain zero throughout the computation , as expected .    equation describes a 2d gaussian wavepacket advected upwards at the local sound speed @xmath9 .",
    "we set the angular driving frequency @xmath257 ( physical frequency @xmath258 ) .",
    "the vertical wavenumber is set using the driving frequency and the sound speed at the lower boundary , @xmath259 .",
    "the packet has horizontal and vertical widths @xmath260 , and an initial centroid location @xmath261 .",
    "the widths were set so that the wavepacket amplitude falls to @xmath262 of its maximum value within @xmath263 horizontally and 1 wavelength vertically . as might be ascertained by considering figure [ fig : ray - ca](a ) , and as we describe in more detail in  [ sec : driver - distribution ] , choosing an initial position for the wavepacket of @xmath264 maximizes its interaction with the null .",
    "we have chosen the packet s parameters to make this the case , and to break the symmetry of the system by localizing the packet to one side of the central separatrix field line .",
    "we drive our simulations by adding the above velocity , density , and energy perturbations into the lower boundary ghost cells .",
    "we do not add a perturbation to the magnetic field in the ghost cells so that , in the ghost cells , the perturbation is purely acoustic .",
    "the acoustic wave thus introduced immediately couples to a magnetoacoustic fast wave and generates perturbations ( of low amplitude ) to the magnetic field in the domain .",
    "this is done for simplicity in implementing the boundary conditions .",
    "our topology does not permit us to write down the global normal modes of the system , but the adiabatic condition does enforce the self  consistent relation between the perturbed velocity , density , and internal energy described by , at least up to the approximation that there is a single vertical wavenumber @xmath265 . near the lower boundary ,",
    "the acoustic energy and flux are the dominant terms of equation and the acoustic wavepacket approximation is good .",
    "advection of the packet upward at speed @xmath9 means the vertical width of the wavepacket , @xmath266 , sets the duration of driving , @xmath267 .",
    "the effective temporal envelope produces a range of frequencies peaked about the driving frequency .",
    "the vertical wavenumber is set explicitly through @xmath265 , but horizontal modes @xmath268 will also be excited due to the horizontal gradients in our wavepacket amplitude and the background field .",
    "their existence leads to a range of initial propagation angles , @xmath269 . we will estimate the distribution of @xmath268 and its effect on the dynamics in detail in  [",
    "sec : discussion ] , but for now we simply note that the final result of the boundary driving is a distribution of waves in propagation direction , frequency , and total wavenumber @xmath270 , introduced at the lower boundary .",
    "properties of the driver are summarized in table [ tab : driver ] .",
    "our analysis of the simulation will focus on the energy density and flux terms of equation .",
    "figure [ fig : en - time ] contains twelve frames from a movie showing the interaction of the introduced perturbation with the null point .",
    "the images consist of three color channels  red , green , and blue  whose intensities correspond to the acoustic , kinetic , and magnetic energy density terms from equation .",
    "the color channels are additive , e.g. , green+red = yellow , as shown by the color wheels in the upper left panel .",
    "each color wheel is scaled linearly between zero ( black ) at the center and @xmath271 at the radii where the disks overlap .",
    "the outer @xmath272 of each disk is of uniform intensity to most effectively show the overlap of each energy term with the others .",
    "overlap of all three terms shows up as white in the figure .",
    "the energy density terms correspond to the energy carried by the waves , and together with the fluxes @xmath273 they satisfy a conservation relation for wave energy , independent of the system s total energy .",
    "because the wavepacket greatly expands and breaks into many individual pieces , no level of saturation for depicting the energy densities is entirely satisfactory .",
    "the saturation level of @xmath271 in figure [ fig : en - time ] was chosen to fairly accurately depict the energy densities after the wavepacket has rapidly expanded .",
    "early in the simulation , say at @xmath274 , the peak energy density of the wavepacket is around @xmath275 , and the figure is highly saturated .",
    "the energy density at the peak of the wavepacket ( @xmath276 ) is proportioned @xmath277 , @xmath278 , and @xmath279 between acoustic , kinetic , and magnetic terms , and the kinetic and potential terms are in equipartition .",
    "later on , the pulse expands into the low @xmath11 regions and breaks into multiple packets .",
    "the peak energy densities of the yellow pulses at @xmath280 , near @xmath281 , are @xmath282 , and here the energy density is divided @xmath283 , and @xmath284 between the acoustic , kinetic , and magnetic terms .",
    "thus , the saturation level does a fairly accurate job at depicting the ratios the energy terms at later times , after around @xmath285 .",
    "cyan portions of the figure correspond to regions with roughly equal parts kinetic and magnetic energy densities ( blue plus green ) , the partition of energy associated with fast magnetoacoustic waves in a low @xmath11 plasma and slow waves in a high @xmath11 plasma . in the same way ,",
    "yellow regions have equal parts kinetic and acoustic energy densities , and correspond to slow magnetoacoustic waves in the low @xmath11 case and fast waves in the high @xmath11 case . in the following , we will use `` magnetic '' or `` acoustic '' waves to indicate which of these energy density terms from dominates the other . in many circumstances , each type of wave for an ideal magnetohydrodynamic fluid exhibits equipartition of energy between its kinetic and potential terms @xcite . depending on the properties of the wave ( standing or traveling , short or long wavelength ) and the background medium ( static , slowly varying , or turbulent fluctuations about an average equilibrium )",
    ", equipartition may hold only weakly ( in a spatially and/or temporally averaged sense ) , strongly ( at each space  time point ) , or not at all .",
    "our simulation uses a high frequency wave , and the ohmic dissipation term is only important in regions of strong gradients . as a result , for most locations in our simulation , we should find that the kinetic energy is in equipartition with the sum of acoustic and magnetic terms .",
    "we can think of allotting fractions of the kinetic term between the fast and slow wave in proportion to the magnetic and acoustic terms to get the total energy for each type of wave .",
    "this approach is only an approximation , and will work best at locations where the two waves are strongly distinct ( very high or low @xmath11 regions ) .",
    "however , it will still prove useful in understanding the propagation of energy through the system .",
    "( for a discussion of important cases where strong equipartition does _ not _ hold , and implications for the interpretation of observations , see * ? ? ?",
    "* ) .    below the lower equipartition height ,",
    "the wavepacket is predominantly acoustic ( recall the color saturation , discussed above ) .",
    "the first several panels of figure [ fig : en - time ] , up to @xmath286 , show the slow upward propagation of the wavepacket .",
    "as the pulse crosses the lower equipartition layer , the wave energy mostly remains on the fast branch of the dispersion relation : it converts from an acoustically dominated ( yellow ) high @xmath11 fast wave to a magnetically dominated ( cyan ) low @xmath11 fast wave .",
    "the ongoing conversion is apparent in the division of energy at time @xmath287 quoted above , resulting in @xmath288 of the energy in magnetic perturbations .",
    "the pulse rapidly expands in size as it reaches the higher phase speed portions of the domain , starting around @xmath289 . between @xmath290 and @xmath291 , the outer portions of the wavefront turn over and",
    "become downward propagating .",
    "the rapid expansion and the turnover are in agreement with the properties of the constant phase fronts from figure [ fig : ray - angles ] . in the region surrounding the null , but still outside the magenta contour ( e.g. , still low @xmath11 ) , a portion of the wavepacket refracts towards the null , and a portion refracts back downwards towards the photosphere .",
    "some of the initial wavefront passes around the null to reach the upper boundary , and therefore escapes the system .",
    "these results again agree qualitatively with the results of the ray ",
    "tracing analysis of  [ sec : ray ] .",
    "note that this is very different from what would happen if the magnetic field were uniform .",
    "then , the phase speed always increases with height , and the fast wave will refract back towards the photosphere .",
    "the strong inhomogeneity in the field due to the presence of the null is responsible for the radically different wave behavior .    around the null",
    "we see a continuous transfer of energy from the fast to the slow branch of the dispersion relation , and from magnetic to acoustic energy densities , starting when the wave approaches the @xmath17 region surrounding the null , around @xmath292 .",
    "this is visible in the animation of figure [ fig : en - time ] as the appearance of the yellow colored pulses propagating away from the null .",
    "they are first visible at @xmath293 , in regions outside the equipartition layer where the plasma @xmath11 is still less than , but close to , the equipartition value of @xmath294 .",
    "energy transfer continues in the region spanning the equipartition contour .",
    "at least part of this behavior does not neatly fit into either of the currently used categories of transmission or mode conversion , as it involves , purely in the low @xmath11 region , a jump from one branch of the dispersion relation to the other and a change from magnetically to acoustically dominated energy density at the same time .    while the fast mode may propagate in any direction relative to the magnetic field lines , the slow mode is heavily guided along the field . in figure",
    "[ fig : en - time ] , this shows up in the low @xmath11 regions as the yellow portions of wave energy density guided along the four separatrix field lines leaving the null .",
    "if one had a detector sitting on the separatrix at , say , @xmath295{\\ensuremath{\\ , \\mathrm{mm}}}$ ] , one would see a fast magnetic wave headed towards the null , and a time later a slow acoustic wave headed away from the null . because the magnetic field lines concentrate moving away from the null and back toward the photosphere , the energy leaving in the slow mode becomes increasing concentrated around the separatrix field lines as it propagates downwards towards the magnetic foot points .    in summary",
    ", the simulation shows that the initial wavepacket splits up into numerous sub  packets as it propagates .",
    "a small portion remains acoustic ( transmits across the lower @xmath17 boundary as a slow wave ) and is confined to low lying field lines in the low @xmath11 region .",
    "this accounts for @xmath296 of the injected energy .",
    "most of the initial packet remains a fast wave when crossing the lower equipartition height and subsequently refracts either left or right and returns to the lower boundary .",
    "however , a part of the upward propagating fast wave is further refracted in towards the null point .",
    "this portion appears to mode convert near the null , and largely leaves the null region as slow acoustic waves confined to field lines near each of the null s four separatrices .",
    "the next two subsections will cover the mode conversion process near the null in more detail .      according to @xcite ,",
    "the amount of wave mode conversion depends on the angle of propagation relative to the magnetic field and the equipartition layer scale height @xmath24 ( see equation ) . in  [ sec : wkb - solutions ] we found that @xmath297 for the equipartition layer surrounding the null .",
    "because the equipartition curve is approximately circular with radius @xmath298 , we defined a radius of influence for the null as @xmath299 .",
    "these distances are indicated in figure [ fig : phase ] .",
    "based on equation , we expect mode conversion to become important as waves reach this distance from the null .     phase distance along two curves near the null point : a fast ray ( green ) , a slow ray ( red ) . also indicated",
    "are the reference slice at @xmath227 ( blue ) , the point at which the two rays are joined ( triangle , see text ) , and the lengths of the equipartition scale height @xmath24 and the null s region of influence @xmath300.,scaledwidth=40.0% ]    the general description of mode conversion reported in the previous section is supported by combining the ray tracing and numerical approaches .",
    "figure [ fig : phase ] shows several curves in the vicinity of the null , with the separatrices shown in black .",
    "the blue vertical line located at @xmath227 passes through the initial center of the introduced wavepacket .",
    "the green curve is the path of a fast ray initialized at the lower boundary , with crosses showing equal phase distances @xmath301 or , equivalently , equal time differences in units of @xmath302 , as the position of a phase point moves at the group velocity along the curve : @xmath303 , where @xmath304 is defined below equation .",
    "the red curve is the path of a slow ray , with crosses indicating a phase point moving at the slow speed ; it closely follows a magnetic field line .",
    "the slow ray was initialized from a location along the fast ray path , indicated by the triangle at @xmath305 ( @xmath306{\\ensuremath{\\ , \\mathrm{mm}}})$ ] .",
    "this is where the fast ray reached one conversion ",
    "height @xmath24 away from the equipartition contour .",
    "the lengths of @xmath24 and @xmath300 are also indicated in the figure .",
    "energy densities along the 3 curves from figure [ fig : phase ] : ( a ) vertical slice along @xmath227 ( blue curve , figure [ fig : phase ] ) .",
    "( b ) fast ray ( green curve , figure [ fig : phase ] ) passing near the null point .",
    "( c ) fast  to  slow conversion ray path , each ray traced using wkb approximation , then joined together ( green then red curves , figure [ fig : phase ] ) .",
    "the color scheme and scale are the same as in figure [ fig : en - time ] .",
    "the right axis of ( b ) and ( c ) show distance in physical units along each ray , while the left axes show the phase distance.,scaledwidth=41.0% ]    energy densities along the 3 curves from figure [ fig : phase ] : ( a ) vertical slice along @xmath227 ( blue curve , figure [ fig : phase ] ) .",
    "( b ) fast ray ( green curve , figure [ fig : phase ] ) passing near the null point .",
    "( c ) fast  to  slow conversion ray path , each ray traced using wkb approximation , then joined together ( green then red curves , figure [ fig : phase ] ) .",
    "the color scheme and scale are the same as in figure [ fig : en - time ] .",
    "the right axis of ( b ) and ( c ) show distance in physical units along each ray , while the left axes show the phase distance.,scaledwidth=48.0% ]    energy densities along the 3 curves from figure [ fig : phase ] : ( a ) vertical slice along @xmath227 ( blue curve , figure [ fig : phase ] ) .",
    "( b ) fast ray ( green curve , figure [ fig : phase ] ) passing near the null point .",
    "( c ) fast  to  slow conversion ray path , each ray traced using wkb approximation , then joined together ( green then red curves , figure [ fig : phase ] ) .",
    "the color scheme and scale are the same as in figure [ fig : en - time ] .",
    "the right axis of ( b ) and ( c ) show distance in physical units along each ray , while the left axes show the phase distance.,scaledwidth=48.0% ]    we extract the energy densities displayed in figure [ fig : en - time ] along the blue , green , and red curves shown in figure [ fig : phase ] at each simulation output time to generate the time  distance plots shown in figure [ fig : enrays ] .",
    "the color scheme and scaling is the same as in figure [ fig : en - time ] . in each of the panels , the abscissa measures time in units of @xmath302 , and the ordinate measures distance along the curve . for panel",
    "( a ) , distance is measured in @xmath307 , but for ( b ) and ( c ) , distance is measured in phase coordinates . for reference ,",
    "the thick colored line at @xmath116 in each panel indicates the line  color of the line in figure [ fig : phase ] along which the energy densities were extracted .",
    "figure [ fig : enrays ] ( a ) is the time  distance diagram of energy density along the blue vertical line at @xmath227 of figure [ fig : phase ] .",
    "the initial shallow sloped portion at the bottom of the panel shows the upward propagating initial pulse ( magnetoacoustic fast wave ) , moving at the relatively slow sound speed below the equipartition height at @xmath308 .",
    "some of the energy remains acoustically dominated , switching from the fast to the slow branch of the dispersion relation .",
    "this behavior is visible as the shallow sloped green / red / yellow ridges beyond @xmath309 , which shows that a portion of the wave refracts and becomes downward propagating around @xmath310 .",
    "however , most of the energy remains on the fast branch and converts to a magnetically dominated disturbance .",
    "this energy streams upward at a much faster speed starting around @xmath311 , due to the increasing alfvn speed . as the upward propagating pulse approaches the separatrix layer , indicated by the horizontal dashed line , we again see two distinct portions . the cyan ( magnetic , low@xmath11 fast wave ) portion passes across this topological barrier , while the yellow ( acoustic , low@xmath11 slow wave ) portion is confined to field lines close to but underneath the separatrix .",
    "note that little of the behavior seen in panel ( a ) directly represents the physical energetics of the plasma .",
    "the velocities are mostly phase velocities caused by different portions of the wavefront refracting across the vertical slice at different times . in particular",
    ", the relation between the apparently upward propagating magnetic energy and the acoustic energy confined near the separatrix is unclear . on the other hand , vertical integration of the different energy channels of panel ( a ) would most closely approximate line  of  sight observations .",
    "this illustrates the care required to interpret observations when one can not assume the field is nearly homogeneous .",
    "in contrast , figure [ fig : enrays ] ( b ) shows the energy densities as a function of time along the curved , fast  ray path shown in green in figure [ fig : phase ] .",
    "distance is now measured as a phase through the time  integral of the group velocity along the curve , the @xmath312 defined above .",
    "the white region at the top of the panel is due to this fast ray exiting the computational domain , and is included to keep a consistent scaling between panels ( b ) and ( c ) .",
    "the location of the start of the conversion region , @xmath313 ( the triangle here and in figure [ fig : phase ] ) , and the null point are each indicated by horizontal dashed lines .",
    "there are two immediately obvious and important differences compared to panel ( a ) .",
    "i ) almost all the energy is confined to straight line paths with a slope equal to the local fast  wave group velocity ( slope of 1 in the figure s units , diagonal dashed line ) .",
    "ii ) almost none of the energy makes it beyond the null point .",
    "the second point is true even though energy propagation past the null is allowed due to the finite plasma @xmath11 , because , unlike for a cold plasma , the group velocity of the fast ray does not drop to zero .",
    "even so , it is evident that little energy actually follows this trajectory beyond the null .",
    "figure [ fig : enrays ] ( c ) shows the energy density time ",
    "distance plot for a hybrid curve of figure [ fig : phase ] , where the slow ray ( red ) has been stitched on to the fast ray ( green ) at the phase position where the fast ray crosses the interaction region surrounding the null ( triangle ) .",
    "the lower portion of the plot , up to @xmath314 ( horizontal dashed line ) , is the same for panels ( b ) and ( c ) , with distance measured as phase position along the fast ray . above this",
    ", distance is measured in phase position along the slow ray .",
    "each portion is indicated by the red and green lines on the left of the plot .",
    "the magnetically dominated energy propagating along the fast ray transitions smoothly to acoustically dominated energy propagating along the slow ray , starting around @xmath315 . in both cases",
    "the slope is 1 ( compare again to the diagonal dashed line ) , indicating that the energy propagates at the fast group velocity in the bottom portion and at the slow group velocity in the top portion of this plot . near",
    "the @xmath316 label is a steep sloped region of magnetically dominated energy density , also starting around @xmath315 .",
    "it is fully contained in the slow ray portion of the diagram and is due to a separate portion of the fast wave front that refracts across the slow ray path .",
    "it has a high phase speed as it crosses the red path because the phase front is expanding and crosses the slow ray line at a high angle ( compare with the animation of figure [ fig : en - time ] ) .",
    "this is the outer portion of the fast  mode pulse that refracts back downwards towards the photosphere .",
    "the panels of figure [ fig : enrays ] only show the energy density along a select number of paths through the domain . however , the fact that the rate of propagation all along the fast  joined  to  slow ray is precisely the local group velocity is a strong indication that at least some energy follows this approximate path .",
    "this is , again , in sharp contrast to the first panel , which shows differences in propagation between the acoustically and magnetically dominated regions , and to the middle panel , which shows energy propagating along the fast ray originally , then abruptly vanishing at the null point .",
    "energy densities extracted along other ray paths ( not shown ) all show similar results .",
    "for instance , energy densities extracted for the 31 rays traced in figure [ fig : ray - angles ] each show propagation of energy along the entire path , except those that pass within @xmath300 of the center of the null equipartition region . instead , the time  distance plots along those latter rays look similar to figure [ fig : enrays](b ) .",
    "this suggests that wave energy enters the region around the null as a fast mode , but it does not exit the region as a fast mode . the energy must either convert to the slow mode or dissipate locally . we will now attempt to determine the fate of this energy .",
    "spatially integrated wave energy densities ( solid curves ) , and temporally integrated fluxes ( dashed curves ) , each as a function of time and normalized to the total energy of the initial wavepacket .",
    "red , blue , green , and black show acoustic , magnetic , kinetic , and total integrated quantities .",
    "( a ) integrated energy fluxes across and energy densities within the equipartition curve surrounding the null",
    ". dashed positive curves show inward flux ( e.g. , inward acoustic flux is positive dashed red ) , and negative dashed curves show outward flux .",
    "the net flux of acoustic and magnetic terms through boundary is shown in black , and is positive .",
    "( b ) integrated energy fluxes across and energy densities above the height @xmath317 .",
    "the dashed curves are net fluxes for each term , including both upward and downward .",
    "the downward fluxes are @xmath318 of the upward fluxes at all times .",
    "note the difference in scale between ( a ) and ( b ) .",
    "see text for details.,title=\"fig:\",scaledwidth=48.0% ]   spatially integrated wave energy densities ( solid curves ) , and temporally integrated fluxes ( dashed curves ) , each as a function of time and normalized to the total energy of the initial wavepacket .",
    "red , blue , green , and black show acoustic , magnetic , kinetic , and total integrated quantities .",
    "( a ) integrated energy fluxes across and energy densities within the equipartition curve surrounding the null",
    ". dashed positive curves show inward flux ( e.g. , inward acoustic flux is positive dashed red ) , and negative dashed curves show outward flux .",
    "the net flux of acoustic and magnetic terms through boundary is shown in black , and is positive .",
    "( b ) integrated energy fluxes across and energy densities above the height @xmath317 .",
    "the dashed curves are net fluxes for each term , including both upward and downward .",
    "the downward fluxes are @xmath318 of the upward fluxes at all times .",
    "note the difference in scale between ( a ) and ( b ) .",
    "see text for details.,title=\"fig:\",scaledwidth=48.0% ]    we can estimate the total amount of mode conversion in the region surrounding the null by integrating each term of .",
    "the energy inside a region @xmath319 is given by the integral of the energy density terms at each time , @xmath320    plots of @xmath321 and @xmath322 for two different areas are shown in figure [ fig : flux - null ] . in panel ( a ) , @xmath319 is taken to be the circle of radius @xmath300 centered on the centroid of the @xmath17 region , resulting in @xmath321 displayed as the solid black line in figure [ fig : flux - null](a ) , normalized to the total wave energy introduced through the lower boundary , @xmath1 .",
    "a fiducial at @xmath323 is marked by the dotted line .",
    "we decompose the net flux into inward and outward terms , with inward magnetic ( acoustic ) shown as positive dashed blue ( red ) and outward shown as negative . about @xmath0 of the injected wavepacket s total",
    "energy crosses the null s equipartition boundary ( blue and red positive dashed curves ) . as expected",
    ", most of the energy arrives as a poynting flux , consistent with the wave being predominantly a fast  mode wave in the @xmath185 region . however , most of the energy leaving the null area is acoustic in nature , and slightly lags the inward directed poynting flux , showing that mode conversion has taken place .",
    "the conversion is fairly efficient , with a ratio of @xmath324 between the net acoustic flux and net poynting flux across the boundary . of the energy that passes into the conversion region",
    ", @xmath3 appears to exit in a form consistent with how it entered .",
    "the remaining @xmath4 is energy that enters the region but never exits : this energy heats the plasma through ohmic and shock dissipation , or is lost due to uncaptured numerical diffusion .",
    "we briefly describe the current accumulation at the end of this section .",
    "we can also calculate the energy that continues propagating upward into the corona by considering a region @xmath319 in the upper portion of our domain . in figure",
    "[ fig : flux - null](b ) , we show the results of computing the net flux across and energy above @xmath325 , which is above the transition region but below the upper damping region . here , solid lines show energy density terms integrated over the entire domain above @xmath326 at each time , and dashed lines show the temporally integrated net fluxes across that boundary , up to each time .",
    "the downward fluxes are @xmath327 of the upward fluxes , which is why we do not independently display them here , as we did in panel ( a ) .",
    "spatially integrated acoustic , kinetic , and magnetic energy densities are shown in solid red , green , and blue , respectively , while the poynting and acoustic fluxes are shown in dashed blue and red , respectively .    as briefly discussed in ",
    "[ sec : sim - gen ] , we do indeed find that the kinetic energy is typically in equipartition with the sum of the acoustic and magnetic energies , i.e. , the solid green curve is roughly the sum of the solid red and blue curves .",
    "the exception is when the wavepackets begin to interact with the boundaries , causing the matched oscillations seen around times @xmath328 in figure [ fig : flux - null](b ) .",
    "the kinetic energy also appears proportionally allotted between the acoustic and magnetically dominated waves . in other words",
    ", each type of wave appears to be in equipartition , independently .",
    "for instance , the poynting flux ( dashed blue ) accounts for both the magnetic energy density and its associated kinetic energy , so that the dashed blue line is essentially double the solid blue line ; the same is true for the acoustic terms in red .",
    "then , the second half of the dashed blue and red lines come from the allotted proportions of the solid green line .",
    "because these are integrated fluxes , this plot only demonstrates equipartition between kinetic and potential energies in a spatially averaged sense .",
    "the integrated flux across the boundary and energy above the boundary are two independent measures of the total wave energy above @xmath329 .",
    "these are shown in black , and match very well until they begin to diverge around @xmath330 .",
    "this is expected , as at that point the waves reach the damping regions at the edges of our computational domain and eventually begin to exit the domain through the upper boundary . because the alfvn and sound speeds are fairly uniform above this height , the waves undergo little additional refraction .",
    "the total integrated flux across the height @xmath329 is thus the total proportion of energy from the initial wavepacket that we estimate continues propagating upward into the model corona .",
    "this accounts for @xmath331 of the initial energy of the wavepacket , with @xmath332 associated with a slow magnetoacoustic wave and @xmath333 with a fast magnetoacoustic wave .",
    "essentially all of the acoustic flux across @xmath329 originated from mode conversion at the null point .",
    "figure [ fig : flux - null](a ) shows that @xmath334 of the total energy left the null point region as an acoustic wave .",
    "it appears that , at least for this simulation , the converted energy that leaves the null is roughly equally distributed along each of the null s four separatrices , with perhaps a slight bias towards the upward leg .",
    "the animation of figure [ fig : en - time ] appears to qualitatively support this conclusion .    on the other hand , the poynting flux leaving the null accounts for just @xmath335 of the total energy , while @xmath333 was found to cross @xmath329 .",
    "at least @xmath336 must therefore be due to a portion of the fast mode wave that refracts around the null but does not enter the null s mode conversion region",
    ". this would be the portion of the wave front discussed in  [ sec : ray ] , such as rays initiated between the green and yellow curves of figure [ fig : ray - paths](b ) .",
    "that figure only shows rays initiated with @xmath337 .",
    "an analysis similar to one resulting in figure [ fig : ray - ca ] could be made to determine the distribution of rays initiated at the lower boundary that exit the top of the system .",
    "we will not perform that analysis here , but simply note that a structured magnetic field can allow some fast wave energy to propagate into the corona whereas for a uniform field it would eventually refract back to the photosphere .          in the previous section we found that @xmath4 of the energy that enters the null point region is never measured to exit it .",
    "this is likely due to the localization of currents to the null point and separatrices and the subsequent dissipation of those currents .",
    "figure [ fig : current - time ] shows a time sequence of the out  of  plane current density ( grayscale ) around the null .",
    "white shows positive ( out of page ) and black negative ( into page ) currents .",
    "blue lines are magnetic field lines , red lines are the approximate locations of the separatrix field lines , and the magenta curve again marks the @xmath17 equipartition contour .",
    "the grayscale is saturated at @xmath338 .",
    "the maximum current density is @xmath339 at @xmath340 , marked in the figure by the green cross ( this is the greatest current density for a larger field of view than shown in the figure , as well ) .",
    "the first pulse of the wavepacket passes through the null point region around @xmath341 .",
    "this stresses the field and leads to regions of current density localized along each separatrix , forming a set of current ribbons by @xmath342 .",
    "the second pulse of the wavepacket steepens to form a shock as it approaches the null , around @xmath343 .",
    "this appears to be the fast oblique magnetic shock reported by @xcite , and is accompanied by a strong spike in the current density , as found by @xcite and @xcite and references in those papers .",
    "we will defer details of shock formation and the development of the current sheet to a later paper .",
    "the null point collapses to form a current sheet originally oriented at @xmath344 to the separatrices .",
    "next , a further accumulation of current density is evident in the ribbons which form along each of the separatrices .",
    "the transverse ( cross  field ) length scale of each ribbon decreases until it reaches the diffusion scale , @xmath345 , at which point the ribbons ohmically dissipate .",
    "this is most easily seen for @xmath346 .",
    "the reduction in current density is not associated with plasma flows or energy fluxes .",
    "this dissipation accounts for the @xmath4 of the energy that enters the equipartition region but does not leave , quoted above .",
    "the current sheet later collapses again at @xmath347 to the separatrices , rotated by @xmath348 to the original collapse direction .",
    "the process repeats itself , with apparent oscillatory reconnection at the null .",
    "this type of behavior has been observed in other studies @xcite .",
    "a more detailed discussion of the formation of the current sheet , its dissipation , the oscillatory reconnection , and how each depends on the initial properties of the wavepacket , will be presented in a future work .",
    "as we have noted above , the total energy introduced to the system by our wavepacket is distributed over a range of initial propagation angles at each initial spatial location .",
    "we would like to estimate the total power carried by the wavepacket in each of these directions , and see how the wkb estimate of where the energy ends up , determined by following sets of rays , compares to the results of the numerical simulation .",
    "this approach has recently gained traction for understanding propagation through model sunspots ( see * ? ? ? * and references therein ) when the field gradients are small enough that the analytic predictions may approximately apply .",
    "however , it has also been used to interpret observations from regions with more complex topologies where the homogeneous theoretical predictions may apply less well @xcite .",
    "our work allows a critical comparison to be made .",
    "the nominal wavevector of the wavepacket described by equation is @xmath349 .",
    "however , any horizontal gradients will produce nonzero horizontal modes with finite values of @xmath268 .",
    "we can approximate the distribution by fourier transforming in the @xmath30 direction ( this approach ignores the effect of horizontal variations in the background magnetic field ) .",
    "the resulting spectrum is simply a gaussian in @xmath268 , @xmath350 where we have combined the amplitude and temporal / vertical behavior into @xmath351 . as",
    "always , a more localized pulse ( smaller @xmath352 ) requires larger horizontal wavenumbers .",
    "parseval s theorem relates the signal power to the spectral power , @xmath353 .",
    "@xmath354 is the power spectral density and @xmath355 denotes complex conjugation . inserting equation and normalizing so that @xmath356 , we find that the power spectral density in each horizontal mode is @xmath357 .",
    "this is our estimate of the distribution of @xmath268 due to the finite horizontal width of our wavepacket . in order to relate this to an initial range of ray propagation directions ,",
    "we change variables to @xmath358 using the relation @xmath359 with @xmath265 fixed .",
    "doing so , we find that the power into @xmath360 at angle @xmath358 is @xmath361 this distribution differs from a gaussian peaked at @xmath362 by the factor @xmath363 , and has the effect of shifting power to angles slightly away from the vertical , relative to a gaussian distribution . for our parameters ,",
    "the difference is extremely small : approximately @xmath364 of the total power is redistributed to greater angles . substituting the values of our wavepacket , @xmath365 and @xmath366 , shows that the @xmath367 level of the distribution is @xmath368 about the vertical .",
    "next , we use these distributions to model a wavepacket as a bundle of rays and estimate the proportion of the wavepacket s initial energy that reaches the null point region .",
    "the estimation depends on three factors : i ) the distribution of the wavepacket s power in initial location @xmath30 ; ii ) the distribution of the wavepacket s power in initial propagation angle @xmath358 ; and iii ) the range of angles at a given initial location @xmath30 for which rays pass within @xmath300 of the null . for i ) and ii ) , we assume the wavepacket s power is separable in @xmath30 and @xmath358 , i.e. , @xmath369 , so that it has the same distribution of @xmath358 for each @xmath30 , and only the relative amplitude varies in @xmath30 .",
    "@xmath370 is given by equation , and @xmath371 .",
    "again , each power density function is normalized so that @xmath372 . for iii ) we use the green contours of figure [ fig : ray - ca ] to define the position ",
    "dependent limits @xmath373 and @xmath374 . the total power directed towards the null is then @xmath375dx,\\end{gathered}\\ ] ] where @xmath376 is the error function .",
    "note that @xmath377 is , implicitly , a function of the wavepacket parameters @xmath378 , @xmath352 , and @xmath265 .",
    "solid curve : proportion of wave energy at each @xmath30 that passes within one interaction distance @xmath300 of the null ( see text ) .",
    "dashed curve : estimate of the wave packet energy that approaches the null , as a function initial injection location , assuming no conversion .",
    "dash  dot : estimate of wave packet energy that approaches the null as a function of injection location , assuming conversion at the lower @xmath17 location . dotted : conversion fraction ( right axis ) estimated using eq .",
    "( 26 ) of @xcite.,scaledwidth=48.0% ]    the solid curve of figure [ fig : power - th ] plots @xmath379 as a function of @xmath30 for the wavepacket parameters ( @xmath380 ) described in  [ sec : driver ] . it shows , for each @xmath30 , the total proportion of the energy in the range of propagation angles that pass within one @xmath300 of the null .",
    "the function is symmetric about @xmath142 , and we only plot @xmath381 here . by multiplying this function by the spatial power distribution of the wavepacket and integrating over the lower boundary",
    ", we can estimate the proportion of the total injected energy that makes it to the interaction region surrounding the null , @xmath377 . performing the calculation when @xmath382 , we find @xmath383 , which is the value of the dashed line in figure [ fig : power - th ] at @xmath227 .",
    "the entire dashed line is the result of repeating the integration for different values of the initial wavepacket centroid location @xmath378 to create the function @xmath384 .",
    "it is therefore a convolution of the solid curve with the gaussian describing our wavepacket , and it shows the fraction a wavepacket s energy that will reach the null point as a function of the packet s initial centroid location .    in  [ sec",
    ": en - den - flux ] we found that @xmath385 of the initial wavepacket s energy reached the region surrounding the null , less than half of the ray theory estimate .",
    "however , the wkb estimate that @xmath386 of the injected energy should reach the region around the null represents an upper limit for two reasons : it assumes that ( i ) all of the energy remains on the fast  mode branch of the dispersion relation , and ( ii ) that only the impact parameter @xmath217 of the ray to the null matters , not the angle of approach .",
    "relaxing each assumption potentially reduces our estimate for the amount of energy that can either reach the null or mode convert in its vicinity .",
    "we begin by accounting for our imperfect boundary driving . as mentioned in ",
    "[ sec : driver ] , part of the wavepacket driver immediately couples to the high @xmath11 slow mode . actually determining how much is complicated by the fact that the magnetic energy tends to `` pile up '' relative to the acoustic energy , due to the difference in the fast and slow group velocities .",
    "this makes a simple ratio of the two quantities misleading at the driving location . by studying the energy densities and fluxes near the injection site",
    ", we estimated that @xmath387 of the energy goes into the fast mode . to be conservative",
    ", we will therefore reduce our estimates by @xmath388 at the end of this calculation , to account for this .",
    "we use the transmission formula equation to estimate the amount of conversion from the fast to the slow mode at the lower equipartition region .",
    "applied here , @xmath24 refers to the scale height of the lower equipartition layer , measured along each ray path .",
    "this formula has recently enjoyed broad application in interpreting observations of photospheric and chromospheric oscillations and their relation to the local magnetic field @xcite .",
    "the formula is for the transmission of a high@xmath11 fast acoustic wave to a low@xmath11 slow acoustic wave .",
    "its complement , @xmath389 , gives the conversion coefficient for a high@xmath11 fast acoustic wave to a low@xmath11 fast magnetic wave , under the assumption that there are no reflections .",
    "we take @xmath390 , @xmath391 the inclination of the magnetic field along the lower boundary , and @xmath392 the equipartition scale height measured separately for each vertical column .",
    "the conversion coefficient calculated for each @xmath30 is shown as the dotted line in figure [ fig : power - th ] .",
    "performing the integration for our standard wavepacket parameters , we find that @xmath393 , so that @xmath394 less of the initial wavepacket s energy is expected to reach the null , compared to the case of full conversion . including the initial @xmath388 loss to the slow mode due to imperfect driving , we find @xmath395 .",
    "the new estimate for the ray theory is about @xmath396 greater than the amount of energy to reach the null found from direct numerical simulation .",
    "finally , we repeat the above calculation to account for conversion for wavepackets introduced at any location @xmath378 .",
    "the result shown as the dash  dotted line of figure [ fig : power - th ] .",
    "for example , by this estimate , a packet initiated directly underneath the null point ( @xmath397 ) will have @xmath398 . in that case",
    ", the field at the lower equipartition region is nearly vertical , and from @xcite equation ( 26 ) we expect a high degree of acoustic transmission .",
    "the transmitted rays are slow rays in the low @xmath11 portion of the domain and are strongly constrained to follow sets of field lines that diverge from the null point .",
    "we therefore expect little energy to reach the region around the null .",
    "conversion at the lower equipartition layer therefore has a significant effect on the amount of energy that reaches the null , but even when conditions are most unfavorable we still expect some of the injected energy ( @xmath399 in the case just discussed ) to reach the upper conversion region .",
    "we repeated the numerical simulation described in  [ sec : results ] using @xmath400 for the centroid of the injected wavepacket and found that the numerical results qualitatively support the conclusions from the ray theory .",
    "furthermore , a set of simulations in which we varied @xmath378 reproduced the general trends of figure [ fig : power - th ] .",
    "however , a detailed comparison between the full set of simulations is outside the scope of the present work .",
    "we have combined a numerical simulation with a wkb method to study wave propagation in a stratified atmosphere containing a magnetic null .",
    "the presence of the null creates strong gradients in the field that substantially modifies wave behavior compared to more slowly varying fields @xcite . on the other hand , our stratified atmosphere , finite @xmath11 , and boundary driving distinguishes our simulations from most studies of mhd waves near null points ( see review by * ? ? ?",
    "we therefore studied how two previously known effects , refraction and mode conversion , combine to modify the wave behavior in the low solar atmosphere .",
    "crucially , we were able to quantify each effect in terms of the energy of a wave packet .",
    "our quantification of mode conversion at the null in terms of wave energy is a novel result .",
    "we found that conversion at the null between incident magnetic fast waves and exiting acoustic slow waves was very efficient , at about @xmath2 .",
    "this result leads to important differences with wave ",
    "null interaction studies based on the linear theory .",
    "those studies rely on reflection and refraction of the fast wave back towards the null point to dissipate energy at the null in logarithmic time @xcite . based on our result",
    ", we expect that extending the linear analysis of @xcite to include pressure forces and mode conversion will show that reflected waves are dominated by slow waves of azimuthal mode @xmath401 , concentrated to the four separatrices .",
    "this may substantially reduce the amount of wave energy dissipated at the null , depending on the size of the equipartition region .",
    "several details of the present and related simulations are beyond the scope of the current paper , but are worth summarizing here .",
    "we have run similar simulations with different numerical resolutions , transition region heights , and wavepacket properties ( @xmath402 ) , that collectively support the conclusions reached in this paper .",
    "perhaps the most striking is that when the packet s injection location is varied , the energy that reaches the null follows the pattern from the ray theory shown in figure [ fig : power - th ] .",
    "the combination of mode conversion at the lower @xmath17 height , refraction towards the null due to the varying fast mode speed , and subsequent conversion near the null is responsible for this effect .",
    "the wavepacket we studied in this investigation was situated to maximally refract towards the null , as determined by the wkb method .",
    "therefore , the direct dissipation at the null is likely an upper bound , at least for the high frequency ( @xmath403 ) waves treated here .",
    "a fuller accounting of the shock formation , current accumulation and dissipation , and how the energetics vary with the parameters of our system will be presented in a follow up paper ( tarr et .",
    "2017 , in preparation ) .",
    "a natural question is how often one expects a low lying null , so critical to our investigation , to arise on the sun .",
    "current estimates for the number of nulls , and the strong gradients in the alfvn speed that come with them , give roughly one per supergranular cell above @xmath404 @xcite , and likely more below that height .",
    "@xcite , for instance , used a spectral method to determine that about 19000 nulls with a height above @xmath404 are present due to the quiet sun field at any given time , about 1 null per @xmath405 .",
    "roughly half of these occur between @xmath406 and @xmath407 , and the statistics vary only by some @xmath388 over the two solar minima and 550 magnetograms considered . since high moments drop off more rapidly with height , they expect more nulls below @xmath404 , but the noise threshold of mdi magnetograms , the basis of their analysis , prevents estimates below that height .",
    "@xcite provided an observational study of the corona using aia data to determine the distribution of nulls with height , and found rough agreement with the work cited above , for the heights they were able to observe .",
    "the presence of many nulls between the photosphere and the transition region makes it likely that the physical processes we describe in this paper are rather common , namely , that convectively driven waves pass through multiple conversion sites as they propagate .",
    "this idea is supported by other simulations .",
    "@xcite simulated a convectively unstable network region that did not contain , _ a priori _ , a null point .",
    "they found that multiple overlaying equipartition regions form self consistently . some even have the roughly circular shape that may indicate a null , though the authors did not specifically check for the presence of one ( see their figure 3 , panel @xmath408 ) .",
    "they found evidence for multiple conversions between fast and slow , acoustic and magnetic pulses at each of the equipartition regions , and found that a slow mode acoustic wave is able to propagate outward beyond the chromosphere , as did we .",
    "we therefore expect the processes we describe in this paper to be applicable to regions of plage , network , and quiet sun .",
    "we anticipate that the relative importance of refraction and mode conversion will vary based on the relevant length scales : the height of the null , distance between magnetic concentrations , and the size of the null s equipartition region .",
    "future studies are required to determine which effects dominate in different atmospheric regions .",
    "the present simulation corresponds most nearly to a 2d cut through a small ephemeral region or strongly enhanced network flux .",
    "active regions present a different challenge .",
    "the wave fields in quiescent active regions with highly symmetric umbra and penumbra are likely well described by slowly varying sunspot models , as evidenced by the good agreement between observations and simulations of acoustic halos @xcite .",
    "strong gradients in the magnetic field in general , and nulls points in particular , probably play a more important role in active regions with more complicated structure .",
    "nulls are found above the photosphere in some active regions , but not the majority ; at the same time , active regions with nulls are much more likely to flare than those without @xcite .",
    "coronal nulls have separators connected to them , and photospheric driving will localize currents to these separators @xcite .",
    "focusing of wave energy at these locations may provide a way to destabilize these current sheets , accounting for the increased rate of flares , or even sympathetic eruptions @xcite .",
    "energy leaving the reconnection site as a slow mode will be guided and focused along the separatrices to the photospheric foot points , the flare ribbons , which we will briefly consider below .",
    "our analysis is most closely related to other studies of mhd waves near nulls , and here we review those results related to our own .",
    "the key properties for comparison are that our magnetic field is nonlinear , our plasma has finite @xmath11 , and our density is nonuniform .",
    "the most well  studied situation is a linear null for which @xmath6 and the density is uniform . in that case , wave energy accumulates at the null because of refraction , as seen , for instance , by the inward spiral of rays @xcite .",
    "focusing of the wave causes an enhancement in current density at the null , which then dissipates to locally heat the plasma . by repeated reflections between the null and an external conducting boundary ,",
    "all of a wave s initial energy is dissipated at the linear null @xcite .",
    "when the field around the null is nonlinear , saddle points and extrema in the phase speed will cause the phase front of an incoming plane wave to split , as reported by @xcite and seen in our work for the rays ( figure [ fig : ray - paths ] ) and simulation output ( figure [ fig : en - time ] ) .",
    "@xcite determined the energetic consequences of this for a @xmath6 , uniform density , quadrupolar field , and found that only @xmath409 of the energy dissipated at the null , while the rest propagated away to infinity as a fast wave .",
    "note that those authors studied a wave initiated at the null , rather than one initially propagating towards the null ; later reflections carried only part of the wave back to the null .",
    "the difference between the quadrupole and linear null is the introduction of a new length scale , the distance over which the linear term in the taylor series expansion of the magnetic field about the quadrupole null is valid .",
    "an incoming wave that is planar on that scale will refract towards the null , and the rays describing it will form the usual logarithmic inspirals .",
    "waves on larger scales will split and partially refract away , taking energy with them .",
    "finite @xmath11 introduces the slow mode wave and allows a coupling between the fast and slow modes .",
    "@xcite is the only other study we are aware of that attempted to quantify conversion near a null , so it is worth discussing their work in detail .",
    "they studied a linear null and varied a parameter @xmath410 that set the size of the equipartition region surrounding their null . as they point out , because the field of the linear null has no inherent length scale , by changing @xmath410 they effectively changed the distance between equipartition layer and the initial fast plane wave launched from the boundary . when @xmath411 , the equipartition region is small compared to the extent of the wave front ( or size of the computational box ) , and this mimics the @xmath6 case : the wave refracts and the rays spiral inwards . as @xmath410 increases , the size of the equipartition region increases , and the wave is initiated closer to it .",
    "once @xmath410 is large enough , @xmath412 everywhere in their domain , which corresponds to the wave being initiated inside the equipartition layer .    to estimate the amount of conversion , @xcite initiated a strictly fast wave pulse in the @xmath413 region and noted where it completely separated into two pulses ( fast and slow ) within the @xmath17 contour .",
    "they calculated the integral of the perpendicular velocity inside the slow wave pulse , which is a quantity related to the wave momentum ( assuming the wave is completely polarized transverse to the field ) .",
    "they found the ratio of this quantity to the integral of the perpendicular velocity over the initial pulse for different values of @xmath410 .",
    "the ratio is roughly proportional to @xmath410 .",
    "this is because increasing @xmath410 effectively initiates the wave closer to the null , so that a larger fraction of the wave refracts into the equipartition region where it can convert .",
    "they could therefore identify the competing effects of refraction and conversion , but not study them further .",
    "the most conversion @xcite report is @xmath414 for @xmath415 , which gives the maximum size their equipartition region can be while still fitting inside the domain .",
    "a peak conversion for this case is somewhat surprising , since conversion should begin roughly one scaleheight @xmath24 outside the equipartition boundary , and their initial pulse is inside that region .",
    "it is possible that their use of the perpendicular velocity is no longer a good approximation for this case .",
    "their estimate is difficult to directly compare to our own because they used a momentum  related quantity and only calculated it when the waves entered the @xmath17 boundary , not when they exited .",
    "in contrast , our estimate uses wave energy and relates the total incoming to total outgoing energy of each type .",
    "we feel our approach is more physical , and allows us to quantify local dissipation . considering their results for different",
    "@xmath410 suggests that we should perform a set of our own experiments in which the height of the transition region is varied while the magnetic field and wavepacket parameters are held fixed .",
    "this will change the size of the equipartition region at the null , but not the total initial wave energy , and can therefore be used to determine the relative importance of refraction and mode conversion for a given driver .",
    "refraction clearly dominates when @xmath185 , and its dominance in much of the corona as has led multiple authors @xcite , including @xcite , to argue that an azimuthally symmetric pulse will be a good approximation for waves approaching nulls .",
    "however , we did not find this to be the case in our simulation , as can be seen around @xmath315 in figure [ fig : en - time ] and the animation of that figure .",
    "this is because our wave front was of comparable size to the null s equipartition region , and because the density and temperature are not uniform around the null , so that the wave fronts do not simply spiral inward . for nulls high in the corona where the scale height is large , and the equipartition contour is small ,",
    "the approximation is more appropriate . on the other hand , based on the statistics reviewed in ",
    "[ sec : null - presence ] we expect most nulls on the sun to arise in locations where stratification is important .    from the discussion in this section , it seems that there are two important length scales .",
    "( i ) the first is global , and is caused by local extrema in the wave phase speeds .",
    "this will determine the spatial portion of an arbitrary wave that will refract in towards a null .",
    "( ii ) the second is the size of the equipartition region around the null relative to the spatial extent of the wavefront that refracts towards the null . the second scale will affect mode conversion , current accumulation , and dissipation at the null . combining our results with those of @xcite",
    "shows that the combination of these two lengths will determine how much wave energy refracts towards a null , and how much of that mode converts at the null , for a given driver .",
    "they can be combined to define an overall `` region of influence '' for nulls .      in our simulation",
    ", we found that slow mode energy leaving the null is concentrated near each separatrix field line .",
    "figure [ fig : flux - null](b ) shows that @xmath416 of the slow mode energy leaving the null travels upward , so the remaining @xmath2 propagates back to the photosphere and becomes increasingly concentrated around each of the other three separatrices .",
    "this is a focusing effect due to the converging magnetic field which acts as a waveguide for the slow waves . in total",
    ", we found that @xmath417 of the initial upward propagating wave packet becomes concentrated in the three downward propagating patches .",
    "this study therefore shows that mode conversion near the null can take a distributed upward wave flux and create localized patches of downward wave flux , focused specifically on the separatrix foot points .",
    "a similar effect has been reported by @xcite for alfvn waves in a zero @xmath11 plasma .",
    "they introduced a transverse velocity perturbation at the apex of a model arcade in order to mimic a reconnection event .",
    "the resulting pure alfvn waves focus as they propagate downwards , mostly due to the converging field lines , although phase mixing also plays a role .",
    "in contrast , when they introduced a fast wave above an arcade , they found that the energy density became more diffuse as it propagated towards their lower boundary .    in our case ,",
    "the fast waves that convert near the null are not necessarily generated by the convective processes that we modeled .",
    "for instance , a reconnection induced fast wave will be refracted towards any nulls in the chromosphere or corona . near the nulls",
    ", fast mode energy will partially convert to a set of slow modes , each of which will focus on null s separatrix foot points .",
    "the effect is especially important in the partially ionized chromosphere , which modifies the slow mode propagation and introduces frequency dependent damping @xcite . focused alfvn and slow waves could therefore contribute to the enhanced emission seen in flare ribbons .",
    "this has been argued before @xcite , and our simulations at least show how focused wave energy could arrive at flare foot points .",
    "the topic seems to deserve further consideration .",
    "we chose to isolate and analyze the dynamics of a single wave pulse .",
    "this approach makes direct comparison with most other studies on atmospheric waves difficult , as they typically rely on time averaged properties of long lasting wave trains or stochastic fluctuations @xcite .",
    "some more recent efforts have included either short or instantaneous pulses @xcite , but were analyzed by fourier transform of , say , the velocity signal , which is still a time  averaged approach .",
    "an exception is @xcite , whose primary focus was dissipation due to ambipolar diffusion in a small , 3d flux tube .",
    "they introduced a similar perturbation to ours and found that it converts to fast and slow waves , as well as alfvnic waves due to the 3d geometry .",
    "they found strong heating due to dissipation of currents associated with the alfvnic waves , but did not attempt to quantify the conversion process .    in a complementary simulation to our own , @xcite studied low frequency @xmath418 waves in a stratified atmosphere spanning the upper convection zone to low corona which also included a null point .",
    "they considered both horizontally and vertically driven waves .",
    "for the vertically driven case they found little time  averaged poynting flux above the height of the transition region , but did find significant low@xmath11 acoustic flux confined to nearly vertical flux tubes at the edge of their domain .",
    "that mechanism is distinct from the one we describe , where a fast mode propagates towards a null , converts at the equipartition region , and exits the null point as a slow acoustic wave confined to the separatrix field lines .",
    "however , in their @xmath419 they appear to mention the mode conversion process near the null that we describe in much more detail . in their case",
    ", conversion arises due to horizontal driving at the lower boundary .",
    "yet , by the time the wave reaches the photospheric level it contains substantial vertical oscillations in the regions of strongly inclined ( near horizontal ) field and therefore produces a similar type of driving to what we have implemented .",
    "indeed , one can see that some acoustic power is localized near the separatrices in their figure 9 , which would indicate the presence of slow mode waves generated by conversion near the null .",
    "their simulations therefore suggest that our results will carry over to lower frequency waves , closer to the brnt  visl frequency , but we caution that at those frequencies dispersion will play a strong role that we did not consider in our work .",
    "a limitation of the present study is the 2d geometry .",
    "a 3d simulation will allow for the coupling of the alfvn mode to the fast and slow modes discussed here , as @xcite found .",
    "@xcite and @xcite demonstrated that the alfvn mode coupling will show a second strong dependence on the relative orientation of the wave vector and the magnetic and gravitational fields .",
    "these studies used slowly varying ( or simply uniform ) sunspot fields with no strong gradients .    for null point studies",
    ", @xcite performed a wkb analysis for a linear 3d null and found that fast wave energy accumulates at the null as a current density .",
    "@xcite performed a 3d numerical simulation and identified a coupling between the alfvn and fast mode , though they did not attempt to quantify the amount of conversion . both of these 3d null point studies had @xmath6 , so that the only form energy accumulation could take is an increase in current density as the wave contracts and the gradient across the wave front increases .",
    "@xcite performed a @xmath196 , 3d simulation ( see next section ) and found that currents localized to a null and separatrix surface , but did not describe the dynamics in terms of waves .",
    "determining the proportions of energy in each of the three modes is nontrivial in 3d .",
    "our 2d geometry allowed us to identify with relative ease the fast and slow modes based on their energy densities and propagation with respect to the field .",
    "distinguishing between the fast and alfvn mode will require more care , and , we anticipate , either a greater reliance on the space ",
    "time diagrams like figure [ fig : enrays ] or building up a statistical version of the local dispersion relation by studying oscillations of local parameters . this latter approach has been used to analyze observational data @xcite but could be applied in three dimensions to simulation output .",
    "a third approach is to project the energy density and flux terms onto characteristic directions of the magnetic field as @xcite has done for the 3d sunspot simulation , @xcite did for a 3d numerical simulation , and @xcite did for a 3d null in a wkb ray ",
    "tracing investigation .",
    "@xcite had some success using this method to determine the energy flux associated with several modes of a 3d expanding flux tube , but the presence of multiple propagation velocities at a given height in their phase diagrams ( see , e.g. , their figure 7(a ) ) , suggests that the decomposition is not exact .",
    "it is clear that no single method can currently robustly distinguish between modes in 3d .",
    "the best approach is probably to combine or compare multiple types of analysis , as we have done in two dimensions in the present investigation .      in agreement with other studies ,",
    "our simulations show that currents accumulate at topologically important locations : the null and the separatrices . @xcite",
    "considered a 3d magnetic dome topology , similar to what would result if our initial magnetic field was spun around the axis passing through the null . in that case , the two separatrices leaving our 2d null in the vertical direction become 3d spine lines , while the other two separatrices form a single dome  like separatrix surface .",
    "@xcite s initial condition had a uniform density and temperature , as opposed to our stratified atmosphere .",
    "they applied an incompressible shear flow around the spine foot point inside the dome and observed an accumulation of current at the separatrix and around the null ( see their figure 9 ) . other work on 3d nulls",
    "has also found that incompressible perturbations cause current accumulation @xcite , where the details depend on whether the area around the spine or the fan is perturbed , and if the perturbation is of rotational or shear type .",
    "our simulations show that current accumulation also occurs for compressive waves , even when @xmath413 and waves can travel through the null .",
    "this situation is not well studied .",
    "@xcite provide one of the most detailed analyses to date , but set @xmath6 in their initial condition .",
    "they rely on current accumulation , shock formation , and the resulting ohmic and shock dissipation to heat the plasma and raise @xmath11 above zero . in their case , asymmetry in the heating about the null creates a pressure gradient which must be balanced by a lorentz force , hence the persistence of the current density at the null after the wave has passed . mode conversion may play a role in their simulation , though they do not consider it in their paper . @xcite",
    "( discussed at length above ) found that most current accumulates close to a linear null , but their simulation solved the linearized mhd equations , whereas the nonlinear effects are clearly important .",
    "@xcite demonstrated that nonlinear effects substantially alter wave behavior near the null and allow fast waves to pass even for the @xmath6 case .",
    "they studied both @xmath6 and finite @xmath11 cases , and used a modified wkb method that accounts for weak shocks .",
    "their method does not apply when one shock is downstream of another , e.g. , when rays cross , which prevented them from studying current sheet formation .",
    "however , we demonstrated in figures [ fig : ray - paths][fig : ray - ca ] that this occurs frequently .",
    "@xcite also studied the nonlinear evolution of a fast wave near a linear null and for an initially @xmath6 plasma .",
    "they noted the shock formation and strong cospatial spikes in the current density , but stopped their simulations before the pulse reached the null in order to stay in the low @xmath11 regime .",
    "they were thus unable to note if any current persisted at the null or along its separatrices .",
    "so it is clear that more work on how currents localize to nulls , particularly for finite @xmath11 , is necessary .",
    "we found that the current sheet which forms at the null oscillates between @xmath420 , which is evidence for oscillatory reconnection ( see figure [ fig : current - time ] ) .",
    "this finding is also not new @xcite , but has recently received renewed attention , especially in connection with observations of quasi ",
    "periodic pulsations associated with flares @xcite .",
    "oscillatory reconnection is found in the null point studies @xcite , in simulations of flux emergence in a stratified atmosphere @xcite , and now in our simulation modeling convection  induced waves . in short , oscillatory",
    "reconnection appears to be a rather robust feature of reconnection , at least in 2d , and it remains to determine its importance in 3d .",
    "we have studied the propagation of an initially acoustic wavepacket through a stratified solar  type atmosphere with an inhomogeneous magnetic field . we were able to quantify the energy to reach the null ( @xmath421 ) , mode conversion around a null ( @xmath422 ) , and dissipation at the null and along separatrix field lines ( @xmath423 ) , in terms of the initial energy of the wavepacket , @xmath1 .",
    "some wave energy was able to escape into the corona @xmath424 .",
    "most of the escaping fast mode energy ( @xmath425 ) was due to refraction around the null , while escaping slow mode energy ( @xmath426 ) was due only to mode conversion at the null ; the remainder of the escaped energy was due to fast mode energy leaving the null .",
    "several details and extensions of the present work have not been fully reported here , but are in preparation .",
    "these include a discussion of the current accumulation at the null and along the separatrices ( including substantially increasing the numerical resolution and thereby changing the effective lundquist number ) , varying the initial location of the wavepacket , changing the height of the transition region and null point relative to each other , and varying the central frequency of the driver . finally , including the effect of partial ionization , already implemented for the lare code as described in @xcite ,",
    "will bring the simulations into much closer agreement with the environment low in the solar atmosphere .",
    "wkb solutions provide insight into the very complex dynamics apparent in the numerical solutions .",
    "the methods have been broadly applied and much discussed , so we will only give a brief description for reference , here .",
    "we will justify the terms used in the dispersion relation equation and write out the equations that were solved to produce the rays used throughout this work . the general wkb theory and the derivation of the ray equations",
    "can be found in various forms in @xcite .",
    "analytic solutions to the ray equations can be found in @xcite and @xcite : the former is representative of the helioseismic literature and is applied to an isothermally stratified atmosphere with uniform , arbitrarily directed magnetic field ; the latter is representative of the null point literature and is applied to a 3d linear magnetic null in a cold plasma .",
    "the wave equation describes the evolution of a perturbation to the system .",
    "note that , and the following discussion , are valid in 3d .",
    "we will specialize to 2d at the end of this appendix . as in the main text",
    ", we here assume the perturbation is of the form @xmath427 , where now we have introduced a small parameter @xmath428 that will shortly be absorbed into @xmath186 .",
    "taking the derivatives , we get @xmath429 + \\mathcal{o}(\\frac{1}{\\lambda } ) = { \\mathbf{0}}.\\end{gathered}\\ ] ] with @xmath430 , the @xmath431 terms dominate , and this justifies dropping the terms that explicitly involve gravity and derivatives of the background field from equation , which are @xmath432 or @xmath433 .",
    "we now absorb @xmath428 into the definition of @xmath186 . letting @xmath434 and @xmath435 , so that @xmath436 , the above equation can be rewritten in the form given by equation , which is a set of coupled equations for the phase function @xmath186 .",
    "it has nontrivial solution when the determinant of the coefficients is zero , given by equation .",
    "we rewrite the dispersion relation here in a more general form , allowing it to have explicit dependence on @xmath156 and @xmath186 : @xmath437 this equation is solved by finding a characteristic curve @xmath174 and @xmath438 which satisfies the four equations @xmath439 we want to determine how @xmath19 and @xmath171 vary along this curve .",
    "the method is to rewrite the derivatives of @xmath440 along the characteristic curve .",
    "the total derivatives of @xmath440 are @xmath441 the dot product on the first line is between the two @xmath19s , one in the denominator and one in the numerator .",
    "but , @xmath19 is a gradient so its curl is zero , @xmath442 , and this allows us to rewrite the dot product as a contraction between @xmath19 and @xmath443 , both in the denominator .",
    "the space and time derivatives of @xmath186 are just @xmath19 and @xmath444 .",
    "we substitute these expressions and rewrite the above equations as @xmath445 next we substitute the definitions for the characteristic curve , equation , into the left hand side ( lhs ) : @xmath446 the mixed second order derivatives of @xmath186 must be equal : @xmath447 .",
    "the lhs of each equation is therefore a total derivative along the curve : @xmath448 equations , , and fully describe the solution given an initial @xmath171 and @xmath19 that satisfy the dispersion relation at location @xmath443 .",
    "our dispersion relation , equation , has no explicit @xmath186 or @xmath156 dependence , so those terms on the right hand side ( rhs ) of the equations are zero . in particular , @xmath449 , and the frequency is constant along the ray .",
    "further , the second equation of allows us to use the physical time @xmath156 as the parameter along the curve . the result for @xmath443 and @xmath19",
    "are @xmath450 the above equations are the ray equations , and demonstrate that @xmath19 and @xmath443 , constructed along the rays , obey hamilton s equations @xcite , with @xmath171 taking the place of the hamiltonian , @xmath443 the generalized coordinates , and @xmath19 their conjugate momentum densities .",
    "we now turn to our specific case of the dispersion relation for the fast and slow rays in 2d , equation , which has a solution when @xmath451^{1/2 } = \\vert k\\vert v_{\\phi\\pm},\\end{gathered}\\ ] ] where @xmath452 is the phase velocity . @xmath453 and @xmath454 depend only on space , while the ray direction @xmath23 depends on @xmath19 through @xmath455 . applying to the dispersion relation",
    "gives @xmath456 the group velocity is found through the derivatives : @xmath457^{-\\frac{1}{2}}(-4b)\\bigr(2\\cos\\theta\\frac{\\partial \\cos\\theta}{\\partial k_i}\\bigl)\\hat{{\\mathbf{x}}}_i,\\\\    \\intertext{where the cosine term is }    \\frac{\\partial \\cos\\theta}{\\partial { \\mathbf{k } } } = \\frac{d}{d{\\mathbf{k}}}\\frac{{\\mathbf{k}}\\cdot\\hat{{\\mathbf{b}}}}{\\sqrt{k^2 } } = -\\frac{{\\mathbf{k}}}{\\vert k\\vert^3}({\\mathbf{k}}\\cdot\\hat{{\\mathbf{b}}})+\\frac{1}{\\vert k\\vert}\\hat{{\\mathbf{b } } } = \\frac{1}{\\vert k\\vert}\\bigl[\\hat{{\\mathbf{b}}}-\\hat{{\\mathbf{k}}}\\cos\\theta\\bigr ] .",
    "\\intertext{after substitution for $ a$ and $ b$ , we write the group velocity as }    \\label{eq : vgroup}{\\mathbf{v}}_{g\\pm } = \\frac{\\partial\\omega}{\\partial{\\mathbf{k } } } = v_{\\phi\\pm}\\hat{{\\mathbf{k}}}\\mp\\frac{c_s^2v_a^2\\cos\\theta}{v_{\\phi\\pm}\\sqrt{(c_s^2+v_a^2)^2 - 4c_s^2v_a^2\\cos^2\\theta}}\\bigl[\\hat{{\\mathbf{b}}}-\\hat{{\\mathbf{k}}}\\cos\\theta\\bigr].\\end{gathered}\\ ] ] equivalently , we may determine the group velocity from the jacobian : @xmath458 with @xmath459 , we see that the above equation is equivalent to .    for each ray with initial values",
    "@xmath460 and @xmath204 , we solve the set of equations and for @xmath461 and @xmath462 , together with the expressions for the phase and group velocities , by numerical integration with an explicit update . note , for a particular ray we typically suppress the @xmath460 and @xmath204 notation .",
    "values for each relevant quantity ( @xmath463 ) are found at each lare2d grid point and linearly interpolated to the ray point @xmath174 .",
    "several authors have cited @xcite for the derivation of conservation of wave energy density found at equation .",
    "their derivation results from taking the linearized equations , multiplying each by a first order quantity , and summing to obtain the desired conservation law .",
    "however , in that case it is possible that some second order quantities have already been abandoned that may be important .",
    "we show below that the expression may also be derived starting with the expression for total energy conservation and keeping all terms up to @xmath464 in perturbed quantities ; c.f .",
    "@xcite , who discusses possible pitfalls for numerous ways of deriving a wave  energy conservation relation , and @xcite  4 , who compares the total energy flux to wave energy flux determined in a simulation .",
    "total energy conservation for a system like the solar surface where plasma motions do not affect the gravitational field ( labeled in this appendix by a constant , uniform @xmath465 ) may be expressed as @xcite @xmath466     + { \\nabla}\\cdot\\bigl[\\rho\\epsilon{\\mathbf{v } } + \\frac{1}{2}\\rho{\\lvert{\\mathbf{v}}\\rvert}^2{\\mathbf{v}}+p{\\mathbf{v}}+\\frac{{\\mathbf{b}}\\times({\\mathbf{v}}\\times{\\mathbf{b}})}{\\mu_0}+\\rho\\phi{\\mathbf{v}}\\bigr ] = 0,\\end{gathered}\\ ] ] where @xmath465 is the gravitational potential , @xmath467 .",
    "we begin by following  65 of @xcite .",
    "we consider an adiabatic perturbation , so that @xmath468 is a function of @xmath77 ; through , @xmath78 is also a function of @xmath77 .",
    "we assume a stationary background with no flows , so that @xmath469 for all quantities , and @xmath470 .",
    "first , we expand the internal energy to second order , at constant entropy @xmath471 we have @xmath472 .",
    "the first law of thermodynamics in terms of specific energy @xmath78 , specific entropy @xmath473 , and specific volume @xmath474 is @xmath475 .",
    "the specific volume is just @xmath476 , so @xmath477 , and @xmath478 for an adiabatic process .",
    "the derivative of @xmath78 with respect to @xmath77 is therefore @xmath479 .",
    "thus , @xmath480 , and @xmath481 , so that to second order @xmath482 the other terms inside the time derivative in equation have straightforward expansions , and altogether , up to second order , are @xmath483.\\ ] ] we expand the divergence term in the same way , keeping terms to second order : @xmath484{\\mathbf{v}}_1 + p_0{\\mathbf{v}}_1+p_1{\\mathbf{v}}_1 + \\frac{1}{\\mu_0}({\\mathbf{b}}_0+{\\mathbf{b}})\\times\\bigl [ { \\mathbf{v}}_1\\times ( { \\mathbf{b}}_0+{\\mathbf{b}})\\bigr]+\\rho_0\\phi{\\mathbf{v}}_1+\\rho_1\\phi{\\mathbf{v}}_1.\\ ] ] combining the first and third terms in the above expression through @xmath485 , and dropping the @xmath486 term because it is @xmath487(3 ) , we find that the full conservation equation up to second order is @xmath488\\\\ \\shoveright{+{\\nabla}\\cdot\\bigl [    \\frac{\\gamma p_0}{\\gamma-1}{\\mathbf{v}}_1+\\frac{c_s^2\\rho_1}{\\gamma -1}{\\mathbf{v}}_1 + p_1{\\mathbf{v}}_1+\\frac{{\\mathbf{b}}_0\\times({\\mathbf{v}}_1\\times{\\mathbf{b}}_0)}{\\mu_0}+\\frac{{\\mathbf{b}}_0\\times({\\mathbf{v}}_1\\times{\\mathbf{b}})}{\\mu_0}+\\frac{{\\mathbf{b}}_0\\times({\\mathbf{v}}_1\\times{\\mathbf{b}}_0)}{\\mu_0 } + \\rho_0\\phi{\\mathbf{v}}_1+\\rho_1\\phi{\\mathbf{v}}_1\\bigr ] = 0 . }",
    "\\end{gathered}\\ ] ] there are several first order quantities in the above expression .",
    "the first terms under the time derivative and divergence cancel . to see this ,",
    "multiply the continuity equation by @xmath489 , and integrate by parts : @xmath490 = 0 \\\\   \\rightarrow \\partial_t\\bigl[\\frac{c_s^2\\rho_1}{\\gamma-1}\\bigr]+{\\nabla}\\cdot\\bigl[\\frac{c_s^2\\rho_0}{\\gamma-1}{\\mathbf{v}}_1+\\frac{c_s^2\\rho_1}{\\gamma-1}{\\mathbf{v_1}}\\bigr]-\\frac{\\rho_0+\\rho_1}{\\gamma-1}{\\mathbf{v}}_1\\cdot{\\nabla}c_s^2 = 0.\\end{gathered}\\ ] ] subtract this from equation , and , noting that @xmath491 , we get : @xmath492\\\\    \\shoveright{+{\\nabla}\\cdot\\bigl [        p_1{\\mathbf{v}}_1+\\frac{{\\mathbf{b}}_0\\times({\\mathbf{v}}_1\\times{\\mathbf{b}}_0)}{\\mu_0}+\\frac{{\\mathbf{b}}_0\\times({\\mathbf{v}}_1\\times{\\mathbf{b}})}{\\mu_0}+\\frac{{\\mathbf{b}}\\times({\\mathbf{v}}_1\\times{\\mathbf{b}}_0)}{\\mu_0 } + \\rho_0\\phi{\\mathbf{v}}_1+\\rho_1\\phi{\\mathbf{v}}_1\\bigr ]    } \\\\",
    "\\hfill\\shoveright {      + \\frac{(\\rho_0 + \\rho_1){\\mathbf{v}}_1}{\\gamma-1}\\cdot{\\nabla}c_s^2   = 0 .    } \\end{gathered}\\ ] ] next , we are assuming the gravitational field is unaffected by the plasma motions .",
    "this allows us to write @xmath493 after using the continuity equation .",
    "the last term here cancels the gravitational term under the time derivative of .",
    "we have @xmath494   + { \\nabla}\\cdot\\bigl[p_1{\\mathbf{v}}_1+\\frac{{\\mathbf{b}}_0\\times({\\mathbf{v}}_1\\times{\\mathbf{b}}_0)}{\\mu_0}+\\frac{{\\mathbf{b}}_0\\times({\\mathbf{v}}_1\\times{\\mathbf{b}})}{\\mu_0}+\\frac{{\\mathbf{b}}\\times({\\mathbf{v}}_1\\times{\\mathbf{b}}_0)}{\\mu_0}\\bigr ]    \\\\",
    "\\label{eq : wave - cont - c}\\hfill\\shoveright {      + ( \\rho_0 + \\rho_1){\\mathbf{v}}_1\\cdot{\\nabla}\\bigl[\\phi +   \\frac{c_s^2}{\\gamma-1}\\bigr ] = 0 .    } \\end{gathered}\\ ] ] to rewrite the gravitational term , we note that the derivative of the sound speed is @xmath495 after using the hydrostatic equation and the fact that @xmath162 varies only in the direction of gravity .",
    "next , we substitute for @xmath496 and combine terms to write the gradient from line two of as @xmath497 = { \\mathbf{g}}\\bigl[\\frac{1}{\\gamma-1}+\\frac{c_s^2}{g}\\partial_y\\ln\\rho_0\\bigr].\\ ] ] finally , we pull out a factor @xmath498 and recombine @xmath499 to write the full gravitational term from as @xmath500.\\ ] ] the term in brackets is @xmath501 , where @xmath502 is the brnt  visl frequency , and is related to buoyant oscillations of the plasma .    to deal with the magnetic terms under the divergence , we take the scalar product of the induction equation with @xmath503 , @xmath504 = 0 .    \\intertext{using $ { \\nabla}\\cdot\\bigl[{\\mathbf{b}}_0\\times({\\mathbf{v}}_1\\times{\\mathbf{b}})\\bigr ] = ( { \\mathbf{v}}_1\\times{\\mathbf{b}})\\cdot{\\nabla}\\times{\\mathbf{b}}_0-{\\mathbf{b}}_0\\times({\\mathbf{v}}\\times{\\mathbf{b}})$ to rewrite the triple product and then integrating by parts , we find }    \\label{eq : induction - b}\\partial_t\\bigl(\\frac{{\\mathbf{b}}_0\\cdot{\\mathbf{b}}}{\\mu_0}\\bigr ) + { \\nabla}\\cdot\\bigl [      \\frac{{\\mathbf{b}}_0}{\\mu_0}\\times({\\mathbf{v}}_1\\times{\\mathbf{b_0}})+\\frac{{\\mathbf{b}}_0}{\\mu_0}\\times({\\mathbf{v}}_1\\times{\\mathbf{b}})\\bigr ] - ( { \\mathbf{v}}_1\\times{\\mathbf{b}})\\cdot\\cancelto{0}{{\\nabla}\\times{\\mathbf{b}}_0 } = 0,\\end{gathered}\\ ] ] where in the last term we now make the assumption that our background state is curl free .",
    "subtract from to obtain @xmath505 + { \\nabla}\\cdot\\biggl[p_1{\\mathbf{v}}_1 + \\frac{{\\mathbf{b}}\\times({\\mathbf{v}}_1\\times{\\mathbf{b}}_0)}{\\mu_0}\\biggr ] +   \\frac{c_s^2}{(\\gamma-1)g}\\rho{\\mathbf{v}}_1\\cdot{\\mathbf{g}}\\bigl[\\frac{g}{c_s^2}+\\partial_y\\ln\\rho_0\\bigr]= 0.\\ ] ] equation agrees with the second order conservation relation from @xcite , but comes directly from the full equations expanded to second order .",
    "the final term results from the stratification , and gives rise the gravitational term in after writing @xmath506 , where @xmath507 is the lagrangian displacement of the fluid , and @xmath77 in terms of the displacement field , and then integrating by parts .",
    "the gravitational terms are important for low frequencies , around and below the visl frequency of @xmath508 in the solar atmosphere .",
    "the derivation above requires a potential field , @xmath509 .",
    "bray and loughhead assumed a uniform field , but this is actually not required by their argument , and a potential field is acceptable for their derivation , as well . as a final note , dividing the flux term by the energy density term returns an expression for the group velocity of a wave , @xmath304 , which may be compared to the group velocity , for instance , from appendix [ sec : wkb ] .",
    "this is most easily checked case by case for a specific wave with appropriate simplifications ( e.g. , a shear alfvn wave , an acoustic wave in an isothermally stratified atmosphere , etc . ) .",
    "this work is supported by the the chief of naval research .",
    "jel was supported by nasa s hsr program .",
    "the simulations were performed under a grant of computer time from the dod hpc program .",
    "this research has made use of nasa s astrophysics data system .",
    "landau , l.  d. , & lifshitz , e.  m. 1987 , fluid mechanics , second edition : volume 6 ( course of theoretical physics ) , 2nd edn .",
    ", course of theoretical physics / by l. d. landau and e. m. lifshitz , vol . 6",
    "( butterworth - heinemann )"
  ],
  "abstract_text": [
    "<S> we perform nonlinear mhd simulations to study the propagation of magnetoacoustic waves from the photosphere to the low corona . </S>",
    "<S> we focus on a 2d system with a gravitationally stratified atmosphere and three photospheric concentrations of magnetic flux that produce a magnetic null point with a magnetic dome topology . </S>",
    "<S> we find that a single wavepacket introduced at the lower boundary splits into multiple secondary wavepackets . a portion of the packet refracts towards the null due to the varying alfvn speed . </S>",
    "<S> waves incident on the equipartition contour surrounding the null , where the sound and alfvn speeds coincide , partially transmit , reflect , and mode convert between branches of the local dispersion relation . </S>",
    "<S> approximately @xmath0 of the wavepacket s initial energy ( @xmath1 ) converges on the null , mostly as a fast magnetoacoustic wave . </S>",
    "<S> conversion is very efficient : @xmath2 of the energy incident on the null is converted to slow modes propagating away from the null , @xmath3 leaves as a fast wave , and the remaining @xmath4 ( 0.036@xmath1 ) is locally dissipated . </S>",
    "<S> the acoustic energy leaving the null is strongly concentrated along field lines near each of the null s four separatrices . </S>",
    "<S> the portion of the wavepacket that refracts towards the null , and the amount of current accumulation , depends on the vertical and horizontal wavenumbers and the centroid position of the wavepacket as it crosses the photosphere . </S>",
    "<S> regions that refract towards or away from the null do not simply coincide with regions of open versus closed magnetic field or regions of particular field orientation . </S>",
    "<S> we also model wavepacket propagation using a wkb method and find that it agrees qualitatively , though not quantitatively , with the results of the numerical simulation . </S>"
  ]
}