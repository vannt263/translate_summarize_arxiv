{
  "article_text": [
    "the famous image of rntgen s wife hand , where the ring and bones could easily be identified , gave rise to a century of ever more impressive x - ray imaging deeds .",
    "x - ray absorption contrast imaging has become an essential tool for the development of human knowledge in area such as medical applications , material science , historical heritage and even security screening .",
    "further progress is now requiring a greater level of sophistication , x - ray phase contrast imaging being one of these advances that fostered a boost in the x - ray imaging domain . within the last two decades ,",
    "supported by the advent of coherent x - ray sources and the wish to image objects with ever higher contrast , sensitivity together with a better resolution , scientists devoted some of their efforts to map the refractive part @xmath0 of the optical index @xmath1 in samples @xcite .",
    "being order of magnitude larger than its counterpart absorption factor @xmath2 , the contrast induced by the @xmath0 factor permits to obtain information that was unreachable before .    within a couple of decades",
    "a few approaches arose from the early demonstration of phase contrast imaging in the late 90s concomitant with the advent of modern synchrotrons and laboratory sources . roughly speaking ,",
    "the available methods can be split into two categories with , on one hand , the ones sensitive to the laplacian of the x - ray beam phase @xcite and , on the other hand , the ones sensitive to the beam phase gradient @xcite .",
    "the techniques of this second category benefit from a high sensitivity to slowly varying electronic density and from a moderate need of _ a priori _ assumptions on the sample composition .",
    "they are also less demanding in term of source size , making them more adaptable to laboratory sources .    among",
    "the repertoire of x - ray phase gradient sensitive methods , the interest for near - field speckle based ones is growing very rapidly due to their easiness of implementation and suitability to sources presenting moderate transverse coherence @xcite .",
    "these methods rely on the modulation of the x - ray light with a random objet , either with an absorption mask or by the near - field speckle effect when using a coherent beam and weakly absorbing objects @xcite . due to the nature of this random object or diffusor ,",
    "e.g. a piece of sandpaper or a filtering membrane , such a wavefront modulator is available at a negligible cost .",
    "besides , the identification of various processing schemes provided options to best tune the method in term either of sensitivity , resolution or experimental requirements @xcite .",
    "the near - field speckle based processing methods differ by their numerical processing and by the mode of data acquisition they require to recover the phase from a sample image . with simple setups ,",
    "the x - ray speckle tracking ( xst ) @xcite and speckle vector tracking ( xsvt ) @xcite approaches demonstrated the possibility of 3d numerical volume reconstruction @xcite within a ct process .",
    "nonetheless , it is the x - ray speckle scanning ( xss ) method that offers the best performance combination in terms of sensitivity and resolution .",
    "this method was shown to be a generalization of the grating interferometer used in the phase stepping mode @xcite . whilst the angular sensitivity of xss can approach the single nanoradian ,",
    "the spatial resolution can be pushed down to a scale smaller than the imaging detector pixel size .",
    "this is possible when using setups with x - ray magnifying optics or with source presenting large divergence .",
    "such aspect makes the method greatly valuable at laboratories where large pixel detectors are used in combination with compact x - ray sources possessing a large solid angle emission , the setups often generating a large magnification ratio . yet",
    ", the main current drawback of the xss method lies in the large number of exposures to the x - ray beam necessary for each projection to recover the phase gradient induced by the sample presence . using a 2d approach , more than 100 images are usually required in each projection scan while a 1d approach providing a high sensitivity in only one direction requires about 40 exposures per projection @xcite .    in this article",
    ", we demonstrate the recovery of the full two - dimensional x - ray differential phase gradient induced by a sample with high accuracy with as little as 25 sample exposures . in a ct process , this number is even reduced further by using suitable interlaced schemes , as we experimentally demonstrate it .",
    "such levels of sophistication make the data acquisition time readily ct - compatible . in a first theoretical part",
    "we explain the approach and its numerical implementation and provide ways of simplifying the data acquisition and processing .",
    "then , in the experimental part , applications of the methods on real samples are presented , including both radio - projection imaging and 3d ct .",
    "the fundamental principle of the speckle based techniques is very much the same as the one employed to understand a shearing interferometer @xcite or a coded aperture system @xcite . in all of these techniques ,",
    "the wavefront is modulated in intensity with a phase or a transmission object located upstream or downstream a sample . as a matter of fact ,",
    "the method explained further can also be seen as a coded aperture system in which the coding object is a random mask .",
    "this was experimentally applied for instance in @xcite where absorption contrast instead of interference contrast was used .",
    "a random wavefront modulating mask can be made of small absorbing features or of the interference generated by grains placed in a coherent beam , known as speckle .",
    "the _ sine qua non _ condition for x - ray speckle visibility is the use of a coherent light source such as a synchrotron or a microfocus source .",
    "the main asset of the speckle modulator lies in the very efficient modulation it can produce with little or no photon absorption .",
    "moreover , in the hard x - ray regime , the extent of the speckle near - field region is much greater than with longer wavelength light , typically up to several meters .",
    "this means that the speckle pattern distortion upon propagation will be ruled only by the wavefront deformation over such distances @xcite . in parallel",
    ", simulations showed that usable x - ray near - field speckle could be obtained with spectral bandwidths as large as 20% @xcite .",
    "let s consider a wavefront modulator , here a diffusor or a membrane , movable upon time and located at the position @xmath3 and we note @xmath4 and @xmath5 the intensities collected on the detector at the pixel position @xmath6 respectively in presence of a sample ( sample scan ) into the beam and in absence of it ( reference scan ) .    in projection imaging ,",
    "the transmission and phase shift induced by the sample on the photon beam are respectively : @xmath7 and phase @xmath8 with @xmath9 the wavenumber , and @xmath10 the wavelength . whilst @xmath11 is the signal directly recorded with an imaging detector and used in absorption contrast based x - ray imaging , the access to the quantity @xmath12 is more subtle .    using the derivation of munro @xcite for a coded aperture system , or using simplifications of the transport of intensity equation",
    ", we have the relationship : @xmath13 where @xmath14 is the distance from the sample to the detector , and @xmath15 the setup magnification .",
    "this equation holds true for a monochromatic beam or for a system that can be defined by an equivalent energy for a beam with a broader spectrum .",
    "the methods exposed in the literature concerning x - ray grating interferometry operating in phase shifting mode , some coded aperture approaches as well as the speckle scanning approach differ from each other in the way they invert this last relation for extracting @xmath11 and @xmath12 from data collected whilst scanning the modulator .    already , from eq .",
    "[ eq : princ ] , one can see that upon pixel wise normalization of @xmath16 and @xmath17 to @xmath18 and @xmath19 , and noting @xmath20 the del operator , we have : @xmath21 which is equivalent to @xmath22 if we choose to move @xmath23 at a constant speed @xmath24 @xcite .",
    "thus , the principle common to all scanning phase gradient sensitive techniques is to recover @xmath25 to then be able to derive the quantity @xmath26",
    ".      here we present applications of the xss technique based on two dimensional scans . in previous papers devoted to the description and explanation of the method ,",
    "dozens of images were recorded for the phase recovery of a single projection .",
    "herein , a much sparser sampling during data acquisition with the sample inserted in the beam allows a valuable optimization of the exposure time to x - rays .",
    "this reduction on the number of acquisitions necessary for correct high resolution phase recovery is possible through a wise selection of the diffusor scanning positions .",
    "[ fig : concept ] ]    figure  [ fig : concept].(a ) sketches the setup of the xss method .",
    "therein , a sample is placed into the x - ray beam at a close distance from a movable diffusor , generally a membrane . the latter , mounted either upstream or downstream the sample , generates small random intensity features recorded by the detector .",
    "the diffusor can be scanned transversally to the x - ray beam propagation direction . during the xss data acquisition",
    ", the diffusor is translated according to a mesh grid of positions with a regular micrometer step noted @xmath24 while an image is acquired at each position @xmath27 .",
    "next , a reference data set is generated by repeating the same acquisition scan , this time with the sample away from the beam . as a result , for each pixel @xmath28 , two data arrays @xmath29 and @xmath30 are available",
    ".    the rigid shift in position @xmath31 between these two similar patterns acquired in @xmath28 can be recovered after normalization as : @xmath32 wich can be tracked with a substep accuracy @xcite .",
    "this vector is directly proportional to the local wavefront gradient @xmath33 and differential phase @xmath34 through the relationship induced by eq .",
    "[ eq : tau ] : @xmath35 noting @xmath36 the distance from the source to the diffusor or the sample , whichever is the closest and , @xmath37 the distance from the diffusor to the sample , we have @xcite : @xmath38    in previous works , both patterns @xmath29 and @xmath30 were built following the most basic sampling : @xmath39\\ ! ] } ( \\delta_x-\\eta q , \\delta_y-\\eta q)\\ ] ] where @xmath40 and @xmath41 denote in this case the dirac distribution .",
    "such sampling makes the requirement on the number of images relatively high and more importantly unnecessary since we aim at recovering an injective function through eq .",
    "[ eq : corr ] . hence , to reduce the number of sample exposures , we suggest to build the correlated signal @xmath29 from a much sparser sampling scheme than for @xmath30 .",
    "figures  [ fig : concept ] ( b ) and ( c ) show schematically the dissimilar sampling of the two signals .",
    "whilst @xmath42 is built from the images collected as usual over a fine mesh scan of the diffusor , @xmath43 is built from fewer points along a mesh with the following sparser grid : @xmath44\\ ! ] } \\left(\\delta_x-\\varrho_1\\eta q , \\delta_y-\\varrho_2\\eta q\\right)\\ ] ] for further processing , the pixel signal collected for @xmath45 is then interpolated by the factors @xmath46 using a bilinear method in order to generate a virtual mesh sampling grid that matches the one recorded for @xmath42 . at this stage eq .",
    "[ eq : corr ] can be applied for @xmath47 to be recovered .",
    "in fact , the sparsity of the sampling performed during the acquisition of @xmath45 permits the incorporation of sufficient independent statistics into the cross - correlation process to ensure the accurate recovery of the displacement vectors .",
    "meanwhile , the sampling of outer points in the reference scans warrants the existence of a correlation peak by the recording of patterns with a matching portion in the two scans .      for a more reliable wavefront recovery ,",
    "the xss method provides the possibility of accessing the laplacian of the wavefront .",
    "although it requires a greater number of sample exposures than for the method described in section b , this processing mode is of interest when imaging samples generating very turbid wavefronts . as the setup is still involving a sample and a scattering membrane located in front of the imaging detector with a pixel size @xmath48 , we keep the notation @xmath29 and @xmath30 as before .",
    "formula  [ eq : princ ] permits the recovery of @xmath49 with a good accuracy especially when the wavefront distortion is smooth and continuous . for strongly varying wavefronts",
    ", artefacts may occur upon the 2d integration of @xmath49 . henceforth , the inclusion into the integration step of the wavefront second derivative through a taylor expansion helps the algorithm to deal with phase jumps .    for a pair of neighboring pixels @xmath50 and @xmath51 with an interdistance @xmath52 ,",
    "we note @xmath53 and @xmath54 the delay for which the pixel @xmath51 registers the same signal as the one measured in @xmath50 when scanning the diffusor .",
    "the absolute wavefront curvatures of the x - ray beam for each state , i.e. with and without the sample inserted into the beam , can be recovered through the relations @xcite : @xmath55 by linearization in the small angle approximation , the differential second wavefront derivative becomes : @xmath56 using the taylor expansion : @xmath57 we can operate the wavefront integration using a matrix inversion @xcite , i.e. we use : @xmath58 such processing implies that @xmath59 and @xmath60 contain partially similar signals , putting hence requirements on the scanning range . during the data collection , the scan length must be long enough ; at least many times @xmath61 .",
    "the xss method of the previous sections could be further reduced , both conceptually and numerically , to lighten up the computational processing routine . whilst an interpolation step was used in sec .",
    "[ sec : sparse ] , we show here an approach based on vectors , as in the case of the xsvt method @xcite .    ]    as sketched in fig .",
    "[ fig : gensch ] , a set of @xmath62 membrane positions randomly distributed and called `` sample points '' are defined ; these positions , marked with yellow dots in the figure , correspond to the points where data is collected for the scan with the sample present in the beam . for pixel @xmath28",
    ", we build a vector @xmath63 from the intensities @xmath64 .",
    "next , the idea is again to solve eq .",
    "[ eq : tau ] by finding @xmath25 such that @xmath65 . for this , we built apart a set of reference vectors by scanning the membrane with mesh scans using a fine regular step @xmath24 around each diffusor position previously defined as sample positions",
    ". thus , by collecting 2d arrays of intensity values for each sample point , we can reorganize these data using the specific order of the sample points and construct a set of reference vectors @xmath66 .",
    "in discrete space , they correspond to the locations @xmath67\\!]^2 $ ] which are the coordinates of the fine mesh grid points in the referential of a sample points .",
    "as for xsvt , we make use of the pearson correlation coefficient @xmath68 @xcite to track with a sub - step accuracy the vector @xmath63 across the reference stack of reference vectors : @xmath69\\label{eq : disp}\\ ] ]    the location @xmath70 of the reference vector providing maximum correlation with the sample vector eventually provides the phase gradient since @xmath71 .",
    "]    the experimental setup we used , shown in fig .",
    "[ fig : setup ] , is mounted in the second experimental hutch of the beamline bm05 of the esrf @xcite .",
    "it involves a tomography stage located at @xmath36 = 55 m from the bending magnet source , that generates x - ray photons by synchrotron radiation from a 0.85 t field magnet on the 6.02 gev electrons of the storage ring .",
    "often , the parameters for speckle based imaging must follow some recommendations if one does not want to encounter limitations @xcite .",
    "for the experiments , pieces of sandpaper with a p220 grit ( 68 @xmath72 m average particle diameter ) were stacked and mounted on a piezoelectric translation stage placed at a distance l = 440 mm upstream the sample position .",
    "the piezo actuators allow the displacement of the scattering object with a nanometer accuracy over a range of 100 @xmath72 m .",
    "two configurations were tested for the following experiments : one using a monochromatic beam , the other one using a filtered white beam . to generate a monochromatic beam ,",
    "the beamline double - crystal si(111 ) monochromator was used to select photons with an energy of 17 kev and a bandwidth selectivity of @xmath73 . for this configuration ,",
    "the detector was a frelon camera coupled to a scintillator and a magnifying optics rendering an effective pixel size of 5.8 @xmath72 m .",
    "in this case the distance from the sample to the detector was @xmath74 m.    the second operating mode consisted of the continuous spectrum of the bm05 bending magnet source filtered by transmission through the following combination of foils : 0.3 mm of tungsten and 6 mm of aluminum .",
    "the detector was a frelon 2k camera with an optics rendering a final pixel size of 7.5 @xmath72 m .",
    "the scintillator was a 200 @xmath72 thick lu : ag crystal grown by chemical vapor deposition .",
    "such filtering of the bending magnet source spectrum combined with the luminescence efficiency of the scintillator provided a detected beam spectrum centered around 60 kev with a 25 % bandwidth . at this energy 20 sheets of sandpaper had to be stacked up together for the interference contrast to be observable .",
    "the distance from the sample to the detector was @xmath75 m.    speckle could be generated thanks to the beam transverse coherence of the beam at the diffusor position which is of @xmath76 m horizontally by @xmath77 m vertically for e=17 kev . in the filtered beam configuration these values",
    "are much decreased due to the smaller light wavelength and the bulk of filters traversed .      ]",
    "the samples displayed here consist of a blackberry and a crocodile bone .",
    "while the blackberry is interesting for the light elements it is made of with varying densities , the trabecular part of the crocodile bone is composed of harder material and contains many high frequency patterns .    before any phase recovery processing",
    "the images undergo a normalization operation to account for the varying detector response function and the intensity beam variation .",
    "the normalized images @xmath78 are calculated from the recorded images @xmath17 by @xmath79 where @xmath80 and @xmath81 denote respectively the mean and standard deviations of the image pixel intensities taken over the full image considered .",
    "such process greatly improves the robustness and accuracy of the phase calculation .",
    "it should be pointed out that neither flat nor dark corrections were further applied .",
    "spikes in the images were removed using morphological processing . the calculation was implemented and tested under matlab@xmath82 .",
    "then , this code was compiled using the software compiler to run the routine in parallel for the ct .",
    "projection imaging is the first step before tomography reconstruction .",
    "the results of these calculations are shown below .",
    "the wavefront gradient images shown in fig .",
    "[ fig : projmure ] for the blackberry sample were obtained with the interpolation based methods of sec .",
    "[ sec : sparse ] . a mesh scan of 5@xmath83 images with @xmath84 m was realized to collect the data when the sample was in the beam . for the reference data a mesh scan with a step @xmath85 times smaller was performed .",
    "the inset on the right shows the high quality of the data in terms of both sensitivity and resolution . with the xss mode",
    ", the angular sensitivity @xmath86 can be approximated with @xmath87 . while nanoradian sensitivity could be achieved through a high magnification ratio and a large propagation distance",
    ", the collimated beam we used in our experiments did not allow such high sensitivity .    ]    for comparison purpose , the phase gradients of this projection were recovered using the previous algorithm with a large number of sample exposures as well as with the two schemes described above , i.e. the one with sparse regular sampling and the other using the random membrane position with matching reference vectors . in an area with no sample , the standard deviation of the phase gradient obtained with 25 exposures and the interpolated scheme of sec .  [ sec : sparse ] was of 0.81 @xmath72rad and of 0.91 @xmath72rad when using the scheme of sec .",
    "[ sec : gen ] . with 36 sample exposures , these figures fell below 0.30 @xmath72rad , a value that is very near the one achieved with the scheme based on many sample exposures presented in ref .",
    "@xcite with 25@xmath88 25 images and a stability of 0.24 @xmath72rad .",
    "hence , the sparse sampling treatment described above proves to not generate any drastic loss in sensitivity and to provide 2d phase gradient with less sample exposures than it is required to perform 1d xss .",
    "the same blackberry and crocodile bone samples were then imaged at higher energy using the bending magnet filtered beam configuration .",
    "figure  [ fig : pinkbeam ] shows the images calculated with 36 sample exposures and with the generic method of sec .  [ sec : gen ] . for both samples and without any a priori assumption on the object material ,",
    "the method was able to accurately retrieve the phase gradient generated by the presence of the sample in the beam .",
    "[ fig : pinkbeam].(g ) shows the detected spectrum , product of the source spectrum by the scintillator and the filters inserted along the beam . while such phase gradient maps were previously obtained using absorption mask @xcite , the results presented here prove that speckle - based methods are still usable at medium or high energy .      ]",
    "the samples were then reconstructed using a ct process for volume visualization .",
    "although around 25 images are necessary for accurate recovery of the full 2d wavefront gradient for each projection ( cf .",
    "[ sec : proj ] ) , the data acquisition could be hastened by applying an interlaced scheme equivalent to the treatment presented in ref .",
    "it consists of using images of neighboring projections to calculate the one at the angle under consideration . with @xmath89 being the number of angular projection , the top five sample points marked in red in fig .",
    "[ fig : setup ] were collected only every five projection @xmath90 .",
    "the following five blue points placed underneath on the acquisition grid were similarly collected every @xmath91 and so on . eventually , this permitted for each projection to use twenty - five images with twenty - five different illuminations .",
    "considering the detector field of view width of @xmath92 pixels , @xmath93 projections were necessary to sample correctly an angular range of 180 degrees around the sample .",
    "after recovery of the phase images , a standard filtered - back projection was applied within the radon transform inversion for ct .",
    "figure  [ fig : mureslice ] shows slices of the blackberry reconstruction from the phase and absorption contrasts . the line cut in fig .",
    "[ fig : mureslice].(d ) shows the higher contrast rendered for the different grain densities parts obtained with phase contrast imaging as compared to the absorption modality .",
    "the crocodile bone was also reconstructed from images scans collected using higher energy photons .",
    "figure  [ fig : boneslice ] shows volume and slice reconstructions of the sample .",
    "the normalized histograms of the two images in fig .",
    "[ fig : boneslice].(d ) show a larger distribution spread of the voxel value for the phase image which eventually makes the segmentation easier .",
    "these two sample reconstructions demonstrate the benefits of the method for ct .",
    "the moderate number of sample exposures makes the method already very competitive in regards to grating interferometry @xcite and coded aperture approaches @xcite . besides",
    ", the reconstructions displayed here necessitated 5 images per projection while , in contrast , 40 images were used in the 1d xss scheme of ref .",
    "in addition , the method presented here offers the advantage of a better sensitivity in the direction collinear to the rotation axis and results in a more accurate phase recovery .",
    "this aspect turns out to be essential when one is operating a laboratory source with a moderate flux .",
    "indeed the refraction sensitivity available with the xst , xsvt and 1d xss techniques is here hampered by the use of photon counting detectors with a large pixel size .",
    "we applied the 2d xss method with a sparser sampling data collection scheme , thus reducing the overall number of images and making the process compatible with ct .",
    "the method was shown to work at both medium and high energy with large spectral bandwidth and provided high angular sensitivity and resolution .",
    "the implementation of the method within a setup involving magnifying optics is expected to achieve the full potential of this full field imaging approach .",
    "its application at laboratory low coherence sources will provide non - invasive ways to better depict the matter at the microscale . at synchrotrons",
    "it will eventually permit to achieve nanometer resolution phase contrast imaging as we intend to demonstrate it in future work .",
    "the next developments around the method will also aim at investigating ways of reducing the noise to ultimately optimize the number of sample exposures and define laws for the selection of the method parameters .",
    "as already performed with xsvt @xcite one could for instance envisage the consideration of information in neighboring pixel to reduce the number of images .    finally , as the speckle pattern is nothing but a random modulator , it could be replaced by any phase or absorption pattern , such as a pseudo - random mask or coded - apertures . in this context ,",
    "such processing method is applicable to other instruments based on wavefront modulation .",
    "30ifxundefined [ 1 ] ifx#1 ifnum [ 1 ] # 1firstoftwo secondoftwo ifx [ 1 ] # 1firstoftwo secondoftwo `` `` # 1''''@noop [ 0]secondoftwosanitize@url [ 0 ]",
    " + 12$12  & 12#1212_12%12@startlink[1]@endlink[0]@bib@innerbibempty @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * , ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * , ( ) @noop * * ,   ( ) @noop * * , ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * ,   ( ) @noop * * , ( ) @noop * * ( ) @noop * * , ( )"
  ],
  "abstract_text": [
    "<S> we previously demonstrated near - field speckle scanning based x - ray imaging to be an easy - to - implement phase sensing method capable of providing both high sensitivity and high resolution . yet , this performance combination could only be achieved at the cost of a significant number of sample exposures and of extensive data acquisition time , thus tempering its implementation for tomography applications . </S>",
    "<S> herein , we show ways of drastically lowering the number of exposures for the speckle scanning method to become attractive for computed tomography ( ct ) imaging . as the method presented </S>",
    "<S> can cope with a high divergence beam , it is also expected to attract the attention of the laboratory sources community . </S>"
  ]
}