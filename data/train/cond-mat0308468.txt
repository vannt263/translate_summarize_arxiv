{
  "article_text": [
    "building upon the results of part  i @xcite , _ q.  v. _ , and maintaining the notational and semantic conventions introduced there , we now turn to the numerical solution of the hrt  pde@xcite @xmath1 in order to determine the type of behavior that actually occurs in practical applications of the theory for thermodynamic states of diverging isothermal compressibility @xmath0 . to this end",
    "we consider two simple model potentials @xmath2 , _ viz .",
    "_ , the hard - core yukawa ( hcy ) system , @xmath3 and square wells ( sws ) , @xmath4 to illustrate the types of behavior encountered and to test the predictions furnished by the relevant scenarios . in both of these potentials @xmath5 coincides with the negative of the contact value of the interaction , @xmath6 , and",
    "so sets the energy scale of the problem .",
    "the potential range is given by @xmath7 and @xmath8 , respectively . unless stated otherwise , @xmath9 , the value of @xmath10 inside the core , coincides with @xmath5 , a choice shared with the implementation by the authors of hrt  and their coworkers referred to as the original one in refs .",
    "@xcite , _ q.  v._. a short summary of the parameter sets and sample isotherms considered in this study can be found in tab .",
    "[ tab : params ] . in the numerical work",
    "we employ an unconditionally stable implicit predictor - corrector scheme shortly characterized in section  [ sec : numerics ] .",
    "a more extensive discussion of the implementation can be found in refs .",
    "@xcite , where default settings for the most important customization parameters are also documented .",
    "even further technical information is available with the source distribution itself @xcite .",
    ".overview of systems and sample isotherms : @xmath11 and @xmath12 give the location of the critical point , @xmath13 and @xmath14 the extent of the two - phase region at the inverse temperature @xmath15 considered in the tables and figures to follow .",
    "the numbers have been obtained from hrt  calculations not imposing the core condition .",
    "all of the digits indicated for @xmath11 are significant . [ cols=\"<,<,<,^,^,^,^,^,^,^\",options=\"header \" , ]     again , these predictions compare favorably with the numerical results for a sw  potential of range @xmath16 obtained on the same discretization grids as the hcy  data of section  [ sec : smooth : rho : q ] .",
    "the most prominent feature , barely compabitle with genuine smoothness , _ viz .",
    "_ , near - discontinuities of @xmath17 can actually be found in the numerical data underlying tabs .",
    "[ tab : qdrho : sw3:100 ] and  [ tab : qdrho : sw3:2000 ] at the locations marked with arrows in fig .",
    "[ fig : f : sw ] ; indeed , several of them can be seen clearly even on the logarithmic scale of the graph .",
    "all the other consequences of stiffness with @xmath18 are also in agreement with the data of tabs .",
    "[ tab : qdrho : sw3:100 ] and  [ tab : qdrho : sw3:2000 ] : in particular , a pronounced @xmath19 dependence of @xmath20 is accompanied by only a very modest effect as @xmath21 is varied , even though the relative change in @xmath22 is much larger than that in @xmath19 . excluding the pathological data with negative @xmath17 ( _ v .",
    "i. _ ) , the final forms of @xmath17 are mostly @xmath19 independent , and the forms obtained on the two density grids differ but slightly . only the isotherm with @xmath23 in tab .",
    "[ tab : qdrho : sw3:2000 ]  presents a somewhat different shape than those at smaller @xmath24 .",
    "the differences in the numbers given under the heading @xmath25 are , however , still in accordance with the stiff scenario as discrepancies appear only close to the edge of the density range of large @xmath17 . as for the first entry of tab .",
    "[ tab : qdrho : sw3:100 ]  ( @xmath26 ) , negative @xmath17 corresponds to exceedingly small values of @xmath27 .",
    "this is found to be the result of a downward jump from @xmath28 ( @xmath29 ) at only slightly higher cutoff where the form of @xmath17 again corresponds to that of the other isotherms . clearly , even a minor perturbation of the numerical process might easily have led to negative @xmath30 and hence to a numerical exception ; in this case our implementation would have discarded the last step , and the final results would once more conform with those of the remainder of tab .",
    "[ tab : qdrho : sw3:100 ] .",
    "let us shortly return once more to the most salient feature of the numerical solution , _ viz .",
    "_ , its near - discontinuities . disregarding the analytical considerations of part  i @xcite  it might be tempting to imagine that , for @xmath31 , the pde  generates a shock front approximately symmetrically moving outward towards the densities @xmath13 and @xmath14 of the coexisting phases as @xmath32 approaches zero . in this view of the numerical process",
    "the jumps occur when the shock reaches the corresponding density .",
    "such an interpretation is not consistent with the data : according to fig .",
    "[ fig : f : sw ]  the near - discontinuities of @xmath17 occur repeatedly at the same density ( most conspicuously for @xmath33 ) , and rapid change at one density is generally accompanied by similar behavior at other densities .",
    "neither of these observations is compatible with the idea of a moving shock front , nor is there any reason why the binodal should be linked to a shock front in sws  but not in the hcy  fluid , _ cf .",
    "_  section  [ sec : smooth : rho : q ] .      summarizing the numerical evidence presented",
    "so far we find that of the three scenarios found in part  i @xcite  only the possibility of a merely logarithmic singularity of @xmath17 can be ruled out with certainty .",
    "we are then faced with the two alternatives of genuine smoothness of the pde  on the one hand , and effective smoothness as a result of an fd  approximation to a stiff pde  on the other hand .",
    "as shown in the preceding subsections  [ sec : smooth : rho : q ] and  [ sec : smooth : q : rho ] , neither of them is in direct contradiction with the numerical data .",
    "the crucial difference is their respective specificity and testability : the genuinely smooth scenario does not make any predictions beyond the smallness of the discretization grid dependence of the numerical results , nor does it offer any of the detailed understanding of the computational process that is necessary for accurate and reliable interpretation of the fd  results . by way of contrast",
    ", stiffness of the pde  in part of its domain provides a consistent framework for the interpretation of the numerics and furthermore entails a number of concrete and numerically testable consequences , all of which are in excellent agreement with our data once the correct ordering of the @xmath34 has been chosen . in combination with the analytical considerations of part  i @xcite  and our earlier statements regarding the importance of the formulation of the hrt  pde  employed , the specificity and great number of these predictions provide ample , although necessarily indirect evidence in favor of the stiff scenario .    from this point on we",
    "will therefore take it for granted that the hrt  pde  does , indeed , turn stiff in part of its domain for subcritical temperatures .",
    "on this basis we now aim to further enhance our understanding of the hrt  numerics , shedding some light on the location of @xmath35 ( section  [ sec : heuristics ] ) , extending our findings in the asymptotic region to intermediate @xmath32 ( section  [ sec : beyond ] ) , and finally clarifying the outstanding numerical properties of the hcy  potential _ vis -  - vis _ other physical systems ( section  [ sec : hcy ] ) .",
    "considering the great importance of the relative order of the @xmath34 for the numerical process , it is natural to inquire into their typical values .",
    "as the exponents @xmath36 and @xmath37 are non - zero by assumption , these cutoffs may only weakly depend on the discretization grid and so are largely determined by the perturbational part of the potential alone . whereas the onset of smoothing in @xmath38 eludes simple reasoning so far , some heuristic arguemnts point to a simple connection between the likelihood of finding @xmath35 at some cutoff and the form of the fourier transform @xmath39 :    let us consider a thermodynamic state of diverging isothermal compressibility at a cutoff that is low enough for smoothing in @xmath32 to have set in at least partially , @xmath40 : in view of the gradual transition between the smoothing and non - smoothing regimes , the effective exponent @xmath41 may not vanish exactly yet ; nevertheless it seems safe to assume @xmath42 .",
    "of course we expect @xmath43 so that reasoning based on the asymptotic behavior for large @xmath44 is applicable , and due to the monotonicity of the exponential function the likelihood of finding @xmath35 close to some cutoff @xmath32 increases with the slope @xmath45 of @xmath17 . at the same time , for a hard - sphere reference system @xmath35 can only depend on the form of the fourier transform of the perturbational part of the interaction potential , _",
    "i.  e. _ , on @xmath46 rather than on @xmath47 itself : the temperature @xmath48 enters the calculation only as a pre - factor to the interaction potential , _ viz .",
    "_ , through @xmath49 so that the normalization of @xmath47 only fixes an energy or temperature scale .    with this in mind",
    "we define an auxiliary quantity @xmath50 , corresponding to @xmath51 in the notation of our earlier work on hrt  @xcite , through @xmath52 solving this relation for @xmath53 and differentiating with respect to @xmath32 we obtain @xmath54 which is valid at all cutoffs except close to the zeros @xmath55 of @xmath47 and @xmath56 where eq .",
    "( [ def : psi ] ) can not be inverted .",
    " an alternative expression for @xmath57 can be obtained from the pde  ( [ pde : f ] ) and the compressibility sum rule : following section  2.4.1 of ref .",
    "@xcite , for density independent potential we easily find @xmath58 equating these two expressions for @xmath59 , solving for @xmath60 , and inserting the result into the pde  ( [ pde : f ] ) yields @xmath61 for @xmath32 away from the @xmath55 . both @xmath62 and @xmath63 are negative in the case under consideration @xcite .    of the expressions appearing on the right hand side of eq .",
    "( [ heur : dqf ] ) the one involving the @xmath32 derivative of @xmath64 is of order @xmath65 and so can be neglected if @xmath66 as assumed .",
    "as we are looking for an effect triggered by the form of @xmath47 alone we do not have to consider the derivatives of the properties of the hard sphere reference system encoded in @xmath67 either .",
    "it is then the term involving the @xmath32 derivative of @xmath56 that is of interest : the ideal gas contribution @xmath68 to @xmath67 ensures positive @xmath69 so that this term is the product of @xmath70 and manifestly positive factors .",
    "now assume that @xmath35 is less than the position of the first minimum of @xmath56 so that only the monotonous growth of @xmath56 towards its global maximum at @xmath71 remains to be covered by the solution of the pde : clearly , as the calculation proceeds in the negative @xmath32 direction , the steeper this rise of @xmath56 , the more the @xmath70 term counteracts the growth of @xmath17 , thereby effectively further delaying the onset of smoothing in @xmath32 .",
    "most likely , @xmath35 will thus be found at cutoffs so low that @xmath56 already levels off towards its limiting value of unity .",
    "for the two potentials considered earlier , _ viz .",
    "_  sws  and the hcy  system with @xmath72 , fig .",
    "[ fig : heuristics ] shows that @xmath56 levels off when @xmath32 ( or @xmath73 , in the case of sws ) is no more than about @xmath74 , which is well compatible with the estimate of section  [ sec : smooth : rho : q ] .",
    "in addition , figs .",
    "[ fig : f : hcy ] and  [ fig : f : sw ] demonstrate that the transition to the regime where @xmath17 mostly grows like @xmath75 , corresponding to vanishing @xmath41 , occurs at similar values of the cutoff .",
    "all in all , our arguments , heuristic as they are , do indeed allow us to estimate @xmath35 in a satisfactory way .",
    "as for smoothing in @xmath38 , on the other hand , actual numerical solution of the pde  currently is the only way of locating and studying @xmath76 .",
    "on the basis of the results presented so far one might expect numerical difficulties to first surface close to @xmath34 , _",
    "i.  e. _ , around @xmath77 for the potentials considered earlier",
    ". however , the monitoring variant of our code @xcite that must be credited with first highlighting the stiffness of the equations clearly signals the inadequacy of the discretization grid already at much higher cutoff , _ viz .",
    "_ , typically for @xmath78 : indeed , the asymptotic region of large @xmath44 can never even be reached without renouncing control of the local truncation error in solving the fdes , _ cf .",
    "_  section  iiie of ref .",
    "@xcite .    in combination with the observed patterns of the evolution of @xmath17 at intermediate and small @xmath32 illustrated in figs .",
    "[ fig : f : hcy ] , [ fig : f : sw ] , and  [ fig : f : contour ] , our experience with the numerics of hrtleads us to propose that stiffness is not confined to that part of @xmath79 where the final build - up of infinite @xmath0 takes place . indeed , fig .",
    "[ fig : f : contour ] shows that there are several regions of large @xmath17 at higher cutoff , some of which may give rise to transient stiffness of the pde : even though the analysis of part  i @xcite does not apply directly  @xmath17 being bounded , asymptotic reasoning is not guaranteed to be valid , nor does large @xmath17 imply large @xmath44 any longer due to the smallness of @xmath80  , from the expressions given in part  i @xcite  we can still deduce that @xmath63 is negative and appreciable for all @xmath32 in the relevant cutoff range except very close to the @xmath55 , and that @xmath62 is likely to be rather large in modulus for @xmath81 due to the terms linear in @xmath17 . depending on the sign of @xmath62 , large @xmath17 may well prompt rapid further growth when @xmath32 proceeds to smaller values . just as in section",
    "[ sec : smooth : q : rho ] , such a rapid growth of @xmath17 almost certainly induces an accompanying growth of @xmath82 on the grid , and any oscillations of the density curvature will carry over to @xmath83 . qualitatively the situation is then quite similar to that in the asymptotic region , and it seems reasonable to see this transient stiffness at intermediate cutoff as preventing computations insisting on local convergence on a dynamically adjusted discretization mesh to ever proceed to @xmath84 .    without the backing of more formal arguments much of the above line of thought may seem insubstantial . there are , however , a number of numerical effects that provide at least indirect evidence for the point of view just laid out . among those already discussed in our earlier work on hrt , the plummeting step sizes observed when determining the discretization grid from the local curvature of appropriate components of the solution vector @xcite are the most direct sign of stiffness at intermediate @xmath32 .",
    "further support comes from our study of sws  of varying range @xcite : there the peculiar shifts in the critical temperature whenever @xmath85 is close to a simple fraction have been linked to the modulation of @xmath44 by the interference of @xmath86 and @xmath47 ; and considering our remarks on the effect of extending the solution vector ( section  [ sec : numerics ] ) it is significant that the critical point is accessible in a wider @xmath85 range when coupling the pde  to a smaller number of expansion terms for taking into account the core condition , _ cf . _  section  i ve of ref .",
    "@xcite and appendix  e of ref .",
    "transient stiffness also explains why the lowest temperature attainable numerically , denoted @xmath87 in refs .",
    "@xcite , may well be higher than @xmath88 even though stiffness in the asymptotic region is a problem only for @xmath89 , and that the isotherms show no sign of phase separation for @xmath90 , the critical temperature being known independently from related computations or by other methods .",
    " there are also some more intricate issues related to the interplay of the @xmath55 ( where @xmath62 vanishes as @xmath91 ) with the boundaries of the cutoff ranges where the step sizes @xmath19 are inappropriate , as well as to the @xmath38 dependence of the onset of smoothing in the presence of a local density grid refinement .",
    "discussion of these subtle effects and their numerical manifestations requires a detailed presentation of appropriate methods of data analysis on non - uniform high - resolution density grids and so falls outside the scope of the present report .",
    "in conjunction with our earlier analyses of the issues surrounding initial and high density boundary conditions , implementation of the core condition , and the peculiarities of discontinuous potentials @xcite , assertion of stiffness at low and intermediate @xmath32 below a certain temperature provides us with a detailed understanding of the numerical process of solving the hrt  pdethroughout @xmath79 and has proved invaluable in interpreting numerical raw data .",
    "we close this short series of reports with a generally relevant sample of the kind of insight that can be gained on this basis , _ viz .",
    "_ , a clarification of the unusually benign computational properties of the hcy  potential :    throughout our numerical work we consistently found that hcy  fluids of moderate inverse screening length like , _ e.  g. _ , the one with @xmath92 repeatedly used here and in ref .",
    "@xcite exhibit the symptoms of stiffness only in a rather mild form , both for @xmath93 where this follows from the low value of @xmath35 , and at intermediate cutoff .",
    "this can be understood by noting , firstly , that the temperature enters the calculation only through @xmath94 , the global normalization of which is accessible only in the limit @xmath95 . at any cutoff @xmath32 ,",
    "the variation of @xmath96 for @xmath97 is then the only measure of the temperature available to the pde ; at the same time , for every one of the patches of large @xmath17 , stiffness arises only below some characteristic temperature , coinciding with the critical one for the final build - up of infinite @xmath0 at @xmath71 . secondly ,",
    "recalling that @xmath98 , a look at fig .",
    "[ fig : heuristics ] and the numbers quoted in its caption shows that the local extrema at @xmath99 of @xmath100 with the default choice of @xmath101 are substantially smaller in modulus than those for sws ; only for much higher @xmath102 do the extrema of @xmath103 approach the sw  values which they reach in the infinite-@xmath102 limit .",
    "it is easily checked that these observations also hold in comparison with other short - ranged potentials like , _",
    "e.  g. _ , the lennard - jones one : the main difference relative to sws  concerns the phase rather than the amplitude of the oscillations . taken together , the smallness of the local extrema of @xmath100 and the _ rle _  the temperature plays readily explain the especially attractive numerical properties of this potential : for @xmath93 , the slope of @xmath56 relative to the scale set by the oscillations at higher @xmath32 is particularly steep , as per section  [ sec : smooth : rho : q ] leading to especially small @xmath35 and suppression of near - discontinuities of @xmath17 . at intermediate cutoff , on the other hand , the smallness of the local extrema _ vis -  - vis _ the global maximum at @xmath104 renders the numerics there similar to what would be seen at much higher @xmath105 in other systems , and transient stiffness poses less of a problem . at the same time",
    ", the @xmath102-dependence of @xmath106 immediately explains the deteriorating accuracy of the results for very short hcy  screening length @xcite .",
    "support for this view comes from the numerical properties following from a different choice of @xmath107 inside the hard core , which affects the fourier transform @xmath47 and hence @xmath17 and all other properties of the @xmath32 system at all cutoffs except in the limits @xmath108 and @xmath93 .",
    "( independence of the final results from the precise choice of @xmath109 is confirmed in a rather satisfactory way in some preliminary calculations on the girifalco description of fullerenes @xcite . )",
    "the simplest such modification of @xmath109 consists in a non - default setting of @xmath9 in eq .",
    "( [ pot : hcy ] ) , exemplified by the dot - dashed curve in fig .",
    "[ fig : heuristics ] ( @xmath110 ) : just as in ref .",
    "@xcite , even a modest discontinuity of @xmath107 at @xmath111 strongly affects the form of @xmath47 and renders the local extrema similar to those of the sw  case ; as expected , this is accompanied by numerical difficulties at intermediate @xmath32 similar to those discussed for sws  in refs .",
    "in contrast , extension of the yukawa form all the way to the origin  hardly unproblematic as it entails diverging direct correlation function at @xmath112 and invalidates the expansion method of taking into account the core condition @xcite  yields the non - oscillatory form @xmath113 ( dotted curve in fig .",
    "[ fig : heuristics ] ) and prevents numerical solution of the fdeseven at high temperatures .",
    "the exceptionally attractive numerical properties of the potential  ( [ pot : hcy ] ) are therefore merely the result of a particular choice , shared with the original implementation , of @xmath107 inside the core and so no genuine trait of the hcy  fluid .",
    "this finding nevertheless does not invalidate the special standing of the hcy  system that must be taken into account in interpreting a comparison with other thermodynamically consistent liquid state theories on the basis of hcy  results for @xmath114 @xcite . on the other hand",
    ", the above considerations also point to the possibility of tuning the computational properties of some given potential by optimizing @xmath107 inside the core to reduce the local extrema at intermediate cutoff , an avenue largely unexplored to date the merit of which we are currently in no position to assess .",
    "the preceding clarification regarding the hcy  system _ vis -  - vis _ other potentials is but one application of the detailed understanding of the hrt  numerics presented here as well as in our earlier hrt  related work .",
    "other aspects of the numerics where this understanding has proved invaluable in interpreting the computational process and the results it yields concern the limits of the resolution in @xmath38 when using extremely fine density grids , the interplay between non - uniform discretization grids and the location of the binodal , the local behavior of the solution close to the zeros @xmath115 of @xmath47 , or questions of data analysis .",
    "all in all , we feel that we have amassed a considerable amount of numerical experience and arrived at a rather detailed self - consistent perception of the computational process throughout all of @xmath79 even below the critical temperature .",
    "given the precarious nature of the hrt  numerics and the not altogether unproblematic relation between the pde  and its fd  approximation such an understanding is of prime importance if systematic mistakes are not to be introduced into the results unknowingly .",
    "the authors gratefully acknowledge financial support from _ fonds zur frderung der wissenschaftlichen forschung _ ( _ austrian science fund _ , fwf ) under projects  p14371-tph , p15758-n08 , and  j2380-n08 .",
    "m.  tau , a.  parola , d.  pini , l.  reatto , _ differential theory of fluids below the critical temperature : study of the lennard - jones fluid and of a model of c@xmath116 _ , phys .",
    "e  * 52 * , 26442656 ( 1995 ) .",
    "a.  reiner , _ the hierarchical reference theory .",
    "an application to simple fluids _ , phd  thesis , technische universitt wien ( 2002 ) .",
    "available on the world wide web from http://purl.oclc.org / net / a - reiner / dr - thesis/."
  ],
  "abstract_text": [
    "<S> continuing our investigation into the hierarchical reference theory of fluids for thermodynamic states of infinite isothermal compressibility @xmath0 we now turn to the available numerical evidence to elucidate the character of the partial differential equation : of the three scenarios identified previously , only the assumption of the equations turning stiff when building up the divergence of @xmath0 allows for a satisfactory interpretation of the data . </S>",
    "<S> in addition to the asymptotic regime where the arguments of part  i  directly apply , a similar mechanism is identified that gives rise to transient stiffness at intermediate cutoff for low enough temperature . </S>",
    "<S> heuristic arguments point to a connection between the form of the fourier transform of the perturbational part of the interaction potential and the cutoff where finite difference approximations of the differential equation cease to be applicable , and they highlight the rather special standing of the hard - core yukawa potential as regards the severity of the computational difficulties .    </S>",
    "<S> keywords : liquid - vapor transitions , non - linear partial differential equations , numerical analysis , finite differences , stiffness . </S>"
  ]
}