{
  "article_text": [
    "it is possible that a population of black holes may have been formed during the radiative era of the early universe by means of gravitational collapse of cosmological perturbations .",
    "this was first proposed by zeldovich & novikov ( 1969 ) @xcite and then by hawking ( 1971 ) @xcite .",
    "( note that throughout this paper , we use the word `` perturbation '' to refer to generic deviations away from the uniform background solution for the universe .",
    "these deviations are only being considered as small or linear where that is explicitly stated . )",
    "the idea of these primordial black holes ( pbhs ) has subsequently attracted continuing attention , even if they have sometimes been regarded as uninteresting on the grounds that perturbations with amplitudes sufficiently large to form them are likely to have been extremely rare . following the initial proposals ,",
    "the possible formation process was then investigated further by carr @xcite using an ingenious simplified model in which he considered an overdense spherical region , described as part of a closed friedmann - robertson - walker ( frw ) universe , surrounded by a spatially - flat frw expanding background .",
    "results from this simplified model suggested that pbh formation would occur if the perturbation amplitude @xmath0 , defined as the relative mass excess inside the overdense region measured when it had the same scale as the cosmological horizon , is greater than a threshold value of about 1/3 .",
    "a more precise determination of this threshold value , usually referred to as @xmath1 , requires a numerical computation and this was first done by nadezhin , novikov & polnarev ( 1978 ) @xcite and by bicknell & henriksen ( 1979 ) @xcite . in the 1980s , attention shifted mainly to the cosmological consequences that a population of pbhs would have , and this was extensively studied in various scenarios ( see , for example , the recent review by carr @xcite ) . in 1999",
    "niemeyer & jedamzik @xcite returned to the issue of making numerical calculations of the pbh formation process , and they were subsequently followed in this by other groups @xcite including ourselves @xcite .",
    "all of these studies confirmed the overall picture of pbh formation , showing that the precise value of @xmath1 depends on the initial perturbation profile .    in practice , the main perturbations of interest here are ones coming from inflation which then re - enter the cosmological horizon at later times",
    ". for understanding the cosmological impact of pbhs , it is necessary to determine the probabilities of different types of perturbation profile ( see hidalgo & polnarev @xcite , and references therein ) and the corresponding values of @xmath1 .",
    "however it is also necessary to have a consistent understanding of the collapse process and of the dependence of the pbh mass on the perturbation amplitude .",
    "an important contribution to this was made by niemeyer & jedamzik @xcite who showed that the masses of pbhs produced in the radiative era by perturbations with a given profile type , follow the scaling - law behaviour of critical collapse , first discovered for idealized conditions by choptuik @xcite , i.e. the masses of the black holes produced follow a power law @xmath2 if @xmath0 is close enough to @xmath1 . if one considers a perfect fluid with an equation of state of the form @xmath3 ( where @xmath4 is the pressure and @xmath5 is the energy density ) , then the value of the critical exponent @xmath6 depends on the value of @xmath7 @xcite .",
    "niemeyer & jedamzik found a scaling law with @xmath8 for the models which they studied , agreeing with the value of @xmath6 already found for idealized critical collapse in a radiation fluid ( having @xmath9 ) @xcite .",
    "however , their code was only able to handle cases with a fairly small range of @xmath10 ( and hence of pbh masses ) , leaving open the question of whether the scaling law would continue down to very low values of @xmath11 . in 2002 this issue",
    "was taken up by hawke & stewart @xcite who used a sophisticated purpose - built code which was able to handle a much wider range of values of @xmath10 and deal with the strong shocks that they found arising for cases near to the critical limit ( @xmath12 ) .",
    "they too found a scaling law over a certain range of pbh masses ( spanning a factor of @xmath13 ) but with deviations away from this for higher and lower masses .",
    "in particular , for the perturbations having amplitudes closest to the critical limit , they found that the relationship levelled off at a minimum mass of @xmath14 of the cosmological horizon mass at their initial time .",
    "an issue with all of these calculations concerns the specification of initial conditions .",
    "niemeyer & jedamzik used non - linear horizon - scale perturbations as their initial conditions , while hawke & stewart used non - linear perturbations at a sub - horizon - scale .",
    "while completely self - consistent , these were importantly different from the type of perturbation coming from inflation in that , as pointed out by shibata & sasaki @xcite , they included a decaying component which would have been absent in perturbations coming from inflation .",
    "bearing this in mind , we ourselves then made calculations in 2005 ( @xcite , hereafter referred to as paper 1 ) for which the initial conditions were linear supra - horizon - scale perturbations of the energy density . during the subsequent evolution ,",
    "the decaying component of the perturbation had time to become negligible before the perturbation passed inside the cosmological horizon ( at the `` horizon - crossing '' time ) and started its non - linear evolution , making the treatment of the eventual black - hole formation a better representation of what would happen for perturbations coming from inflation .",
    "( with this , we again demonstrated a scaling - law , over a rather small range , but found different values of @xmath1 from before . ) however , the best thing to do is clearly to specify from the beginning perturbations containing only a growing component .",
    "we addressed this in a subsequent paper in 2007 @xcite , where the initial conditions were again specified as linear supra - horizon - scale perturbations of the fluid parameters , but now using an asymptotic quasi - homogeneous solution @xcite , which gives a consistent pure growing behaviour .",
    "when the perturbation length - scale is much larger than the cosmological horizon , the curvature perturbation commonly denoted by @xmath15 can be non - linear ( as necessary in order to subsequently produce a black hole ) while the perturbations of the hydrodynamical quantities are still in the linear regime .",
    "in this situation , the coupled system of einstein and hydrodynamical equations can be solved analytically , and one finds that the small perturbations in energy density , velocity , etc are generated uniquely by the curvature profile , which is then the only quantity that needs to be specified . in @xcite ( hereafter referred to as paper 2 ) the numerical scheme developed in paper 1 was modified so as to use initial data coming from this quasi - homogeneous solution .",
    "the present paper is continuing this line of work , probing much more deeply into the nearly - critical regime , using an updated version of our previous computer code implementing an adaptive mesh refinement scheme .",
    "we investigate the behaviour occurring in the nearly - critical regime with particular reference to a possible breaking of the scaling law .",
    "after this introduction , section 2 gives a brief summary of the equations used and of the method for specifying the initial conditions ; section 3 describes the numerical method used for the simulations , with particular focus on the new modifications to include the adaptive mesh refinement .",
    "results are then presented in section 4 and section 5 contains conclusions . throughout",
    ", we use units for which @xmath16 except where otherwise stated . in appendix",
    "a , we list some typographical errors in paper 2 which have come to light and in appendix b , we present a convergence test of the code .",
    "for the calculations described here , we have followed the same basic methodology as described in papers 1 and 2 .",
    "we give a brief summary of it here ; full details are contained in the previous papers .",
    "we use two different formulations of the general relativistic hydrodynamic equations : one for setting the initial conditions and the other for studying the black hole formation . throughout",
    ", we are assuming spherical symmetry and that the medium can be treated as a perfect fluid ; we use a lagrangian formulation of the equations with a radial coordinate @xmath17 which is co - moving with the matter .    for setting the initial conditions",
    ", it is convenient to use a diagonal form of the metric , with the time coordinate @xmath18 reducing to the standard frw time in the case of a homogeneous medium with no perturbations .",
    "( this sort of time coordinate is therefore often referred to as `` cosmic time '' ) .",
    "we write this metric in the form given by misner & sharp ( ms ) @xcite , whose approach we follow here in writing the gr hydrodynamic equations : ds^2=-a^2dt^2+b^2dr^2+r^2d^2+^2d^2 , [ sph_metric ] with the coefficients @xmath19 , @xmath20 and @xmath21 being functions of @xmath17 and @xmath18 and @xmath21 playing the role of an eulerian radial coordinate . using the definitions d_t , [ d_t ] d_r , [ d_r ]",
    "one defines the quantities u d_t r , [ u ] and d_r r , [ gamma1 ] where @xmath22 is the radial component of four - velocity in the `` eulerian '' frame and @xmath23 is a generalized lorentz factor .",
    "the metric coefficient @xmath20 can then be written as b , for a radiative medium where rest - mass makes a negligible contribution to the energy density , the basic gr hydrodynamic equations can then be written in the following form ( where we use the notation that @xmath5 is the energy density , @xmath4 is the pressure , @xmath24 is the compression factor , and @xmath25 is the mass contained inside radius @xmath21 ) : d_tu =- d_rp++4rp , [ euler1 ] d_t =- d_r(r^2u ) , [ d_trho ] d_t e = d_t,[d_te ] d_t m=-4r^2 pu , [ d_tm ] d_r a =- d_r p,[d_ra ] d_r m=4r^2 e , [ d_rm ] plus a constraint equation ^2=1+u^2- .",
    "[ gamma ] we also have the equation of state for a radiative fluid : p = e. [ eq_state ]    the initial conditions are set by introducing a perturbation of the otherwise uniform medium representing the cosmological background solution , with the length - scale of the perturbation @xmath26 being much larger than the cosmological horizon @xmath27 . under these circumstances ,",
    "the perturbations in @xmath5 and @xmath22 can be extremely small while still giving a large amplitude perturbation of the metric ( as is necessary if a black hole is eventually to be formed ) and the above system of equations can then be solved analytically to first order in the small parameter @xmath28 . a full discussion of this has been given in paper 2 .",
    "the result , called the `` quasi - homogeneous solution '' , gives formulae for the perturbations of all of the metric and hydrodynamical quantities in terms only of a curvature perturbation .",
    "when @xmath29 , the curvature perturbation commonly denoted by @xmath15 is time - independent @xcite , and it is convenient to represent it in terms of another quantity @xmath30 similar to the constant @xmath31 appearing in the standard form of the frw metric but now depending on @xmath17 .",
    "the perturbed form of the metric coefficient @xmath20 is then written as b = ( 1+b ) , [ b_def ] where here , and in the following , the tilde denotes a perturbation quantity and the prime denotes a derivative with respect to @xmath17 .",
    "( note that throughout this discussion of the initial conditions , we are working to first order in @xmath32 , but in our computations of the subsequent evolution we use the full set of hydrodynamical equations with no linearization . ) the energy density and all of the other variables of the ms equations are perturbed in the following way , which we show explicitly for the energy density : e = e_b(1+e ) [ perts ] where @xmath33 represents the background unperturbed solution and @xmath34 gives the perturbation profile .",
    "inserting the perturbed quantities into ( 7 ) - ( 13 ) and performing a linearization in @xmath32 , one can obtain time - independent analytical solutions for all of the tilde - quantities . and @xmath18 . ] with the equation of state ( [ eq_state ] ) , @xmath35 is given by e = r^3k(r)^r_0 ^ 2 [ e_tilda ] where @xmath36 is the comoving length - scale of the overdense region of the perturbation , determined by the particular expression used for @xmath30 .",
    "the time variation within the quasi - homogeneous solution is given by @xmath37 , which follows the standard relation for a cosmological growing mode ( in the present case , @xmath38 ) .",
    "to characterize the amplitude of the perturbation , we use the integrated quantity @xmath0 , which measures the relative mass excess within the overdense region , as frequently done in the literature . in the quasi - homogeneous solution , this is given by ( t ) r_0 ^ 3 ^ -1 ( t)k(r_0)r_0 ^ 2 [ delta_s ] which also has the familiar linear growth with cosmic time .",
    "for discussing the scaling law , we need to have a measure of the perturbation amplitude defined consistently for different cases , and for this we use @xmath0 as given by expression ( [ delta_s ] ) with @xmath32 set equal to @xmath39 .",
    "this gives very similar values to those actually calculated at horizon crossing , with non - linear evolution taken into account , but it can be calculated with greater precision since it is given analytically .    in the present work ,",
    "we make the choice of using a gaussian profile for @xmath30 , normalized to be equal to @xmath39 at the centre : k(r ) = .",
    "[ curv_profile ] substituting this into ( [ e_tilda ] ) , one obtains r_0 ^ 2 1 - .",
    "[ e_tilda2 ] since @xmath40 at the outer edge of the overdensity ( where @xmath41 ) , one then has @xmath42 and so ( [ e_tilda2 ] ) can be rewritten as 2 ^2 1 - ^2 , [ e_tilda3 ] or 2 ^2 1 - ^2 , [ mex_hat ] in terms of the radial coordinate @xmath43 of the unperturbed background solution , given by @xmath44 where @xmath45 is the cosmological scale factor .",
    "this expression is that for the well - known mexican - hat profile , as used in previous calculations by niemeyer & jedamzik @xcite and ourselves @xcite . inserting the expression for @xmath36 into ( [ delta_s ] ) gives = 2 ^ 2 ( - ) when @xmath46 and so the perturbation amplitude can be characterized alternatively by @xmath47 . in papers 1 and 2 , the @xmath1 for this profile was found to be @xmath48 , which corresponds to @xmath49 . for further details about setting initial conditions using the quasi - homogeneous solution , the reader is referred to paper 2 .",
    "the ms approach using cosmic time slicing is convenient for setting initial conditions but has a well - known drawback for calculations of black hole formation in that singularities are formed rather quickly when using it and then further , potentially observable , evolution can not be followed unless an excision procedure is used .",
    "various slicing conditions can be used to avoid this difficulty but for calculations in spherical symmetry it is particularly convenient to use null slicing . in our work",
    "we have used the `` observer time '' null - slicing formulation of hernandez & misner @xcite where the time coordinate is taken as the time at which an outgoing radial light ray emanating from an event reaches a distant observer .",
    "( in the original formulation , this observer was placed at future null infinity but for calculations in an expanding cosmological background we use an frw fundamental observer sufficiently far from the perturbed region so as to be unaffected by the perturbation . )",
    "we use the ms approach for setting up initial data and for evolving it so as to produce data on a null slice .",
    "this is then used as input for our observer - time code with which we follow the black hole formation .    for the observer - time calculation ,",
    "the metric ( [ sph_metric ] ) is re - written as ds^2=-f^2du^2 - 2fbdrdu+r^2(d^2+^2 d^2 ) , [ nullmetric ] where @xmath50 is the observer time and @xmath51 is the new lapse function .",
    "the operators equivalent to ( [ d_t ] ) and ( [ d_r ] ) are now d_t ( ) , d_k ( ) , where @xmath52 is the radial derivative in the null slice and the corresponding derivative in the misner - sharp space - like slice is given by d_r = d_k - d_t .",
    "the hydrodynamic equations can then be formulated in an analogous way to what was done in cosmic time .",
    "we will not repeat this here but refer the reader to our discussion in @xcite .",
    "as in our previous work , the present calculations have been made with an explicit lagrangian hydrodynamics code based on that of miller & motta ( 1989 ) @xcite but with the grid organized in a way similar to that in the code of miller & rezzolla ( 1995 ) @xcite which was designed for calculations in an expanding cosmological background .",
    "the code has a long history and has been carefully tested in its various forms .",
    "full details of the methods used have been given in the above papers , in papers 1 and 2 , and in other papers cited there .",
    "some further information about tests of the code , including a new convergence test , is given in appendix b.    the code uses a staggered grid and the co - moving coordinate is a mass - type coordinate which we will refer to as @xmath53 in the discussion below .",
    "the basic grid has logarithmic spacing , allowing it to reach out to very large radii while giving finer resolution at small radii .",
    "the initial data for our present calculations was derived from the quasi - homogeneous solution and was specified on a space - like slice ( at constant cosmic time ) with @xmath54 , giving @xmath55 .",
    "the outer edge of the grid was placed at @xmath56 , which is far enough away so that there is no causal contact between it and the perturbed region during the time of the calculations .",
    "the initial data was then evolved using the ms equations ( [ euler1]-[gamma ] ) , so as to generate a second set of initial data on a null slice ( at constant observer time ) . to do this ,",
    "an outgoing spherical light pulse was traced out from the centre , and parameter values were noted as it passed each grid zone .",
    "it is not necessary to continue to evolve the solution significantly behind the wave front in this part of the calculation , since that region ( within which singularities might form ) does not have causal contact with the wave front . the null - slice initial data , constructed in this way ,",
    "was then evolved using the observer - time equations @xcite . from here on , we will refer to the observer - time coordinate as @xmath18 rather than @xmath50 .    in the present work ,",
    "our aim was to study pbh formation for much smaller values of @xmath57 than was possible with our previous version of the code .",
    "the particular problem which needed to be overcome is that as the pbh is forming , a semi - void appears around it and this becomes progressively deeper as @xmath0 gets closer to @xmath1 . for a lagrangian code with a co - moving grid , this means that the eulerian widths of zones in the semi - void region become very large , producing truncation errors that crash the code .",
    "the situation is made worse by the fact that a highly - relativistic wind blows matter across this region and this needs good resolution in order to be well - represented . as mentioned above",
    ", the basic code was already using a logarithmically - spaced grid in order to be able to simultaneously treat both the small scales on which the pbh was forming and also the large scales necessary for representing the surrounding expanding universe up to scales much larger than the cosmological horizon . for dealing with the problem of the semi - void region",
    ", we introduced an adaptive mesh refinement scheme ( amr ) on top of the existing logarithmic grid .",
    "this has allowed us to follow pbh formation for values of @xmath58 up to eight orders of magnitude smaller than we could do before .",
    "our amr uses a fully - threaded - tree algorithm , making its refinement on the basis of the eulerian width of the zone @xmath59 ( which then , in turn , impacts on the truncation error ) .",
    "the outline of the procedure is as follows .",
    "every 20 time - steps , a check is made to see whether the fractional zone spacing @xmath60 is greater than 10% for any zone . if it is , that zone is subdivided introducing a new grid point at its centre ( in terms of the co - moving radial coordinate @xmath53 ) and quantities at the new grid - point and in the two newly - created zones to either side of it are calculated by means of cubic interpolation . only one zone is subdivided at a time , allowing the solution to relax before performing any subsequent sub - division .",
    "doing this , we have not found it necessary to introduce any artificial viscosity into the code for suppressing numerical noise , an important point for interpreting the appearance or absence of shocks . also every 20 time steps",
    "( but offset by 10 time steps ) , we carry out a check to see whether @xmath60 has become less than 4% across any zone resulting from a previous subdivision .",
    "if so , then it is merged with the zone from which it was previously separated if that zone has the same @xmath61 .",
    "again , only one merging is carried out at a time to allow relaxation .",
    "other grid - management routines are used so as to maintain a good overall grid structure .",
    "we have successfully used the scheme with more than thirty levels of refinement and its performance can be judged from the results which we present in the next section .",
    "all of the features shown have been fully resolved with the amr .",
    "scaling behaviour for @xmath11 as function of @xmath62 calculated for a radiative perfect fluid . for @xmath63 ,",
    "the points are well - fitted by a scaling law with @xmath64 and @xmath65.,width=302 ]    in this section we discuss the numerical results which we have obtained for pbh formation in the radiative era , going closer to @xmath66 than we have done before . the main result is shown in figure [ fig.1 ] where the log of the black - hole mass @xmath11 normalized with @xmath67 ( the mass inside the cosmological horizon at the moment of horizon crossing ) is plotted against the log of @xmath57 .",
    "note that the cosmological horizon mass continues to increase after the horizon - crossing time , and so it is not inconsistent to have @xmath68 .",
    "we find that for @xmath63 ( which corresponds to @xmath69 ) , the points for different cases rather accurately follow a scaling law = k(-_c)^ [ scaling ] with @xmath64  close to the expected value for a perfect fluid of radiative particles @xcite . for larger values of the masses ,",
    "the curve steepens slightly , as seen also in the past @xcite but there is no sign of divergence from the scaling law at lower masses , even though we have now covered a range of masses in the scaling - law region of more than one thousand .",
    "the most extreme case shown has @xmath70 and gives a black hole mass of @xmath71 .",
    "these results are in contrast with those seen by hawke & stewart @xcite , where the scaling - law behaviour persisted for a range of masses of @xmath13 but terminated at low masses with the curve flattening out at a minimum value of @xmath72 .",
    "however , we want to stress that great care needs to be taken in making a comparison .",
    "firstly , in order to compare our results in figure [ fig.1 ] quantitatively with those in figures 7 & 8 of @xcite , we need to relate the two different mass normalizations used .",
    "the value of @xmath67 appearing in ( [ scaling ] ) depends on the moment when it is measured . in common with much of the literature",
    ", we have evaluated it at the time of horizon crossing , whereas in @xcite the perturbation was started already well inside the horizon and @xmath67 was evaluated at that initial time . making a direct comparison is then difficult . also , the profiles used for the perturbations were quite different .",
    "to get some idea , one can compare the upper part of the plots , where one sees a deviation away from the scaling law at large masses . in @xcite ,",
    "this deviation occurs at @xmath73 while we observe it occurring at @xmath74 .",
    "this indicates that the results in @xcite probably need to be rescaled upwards in mass by about one order of magnitude in order to make the comparison ( this has been confirmed in discussion with one of the previous authors ) , putting their plateau at @xmath75 in our units , with a divergence from the scaling behaviour at the low - mass end beginning at @xmath76 using our measure of perturbation amplitude .",
    "their explanation for the minimum mass seen in their calculations was related to the occurrence of strong shocks in the lower - mass cases . with our initial conditions",
    ", we do not see these shocks ( hence the continuation of the scaling law ) but if we impose more general non - linear initial conditions within the cosmological horizon scale , then we _ do _ often see shocks which are consistent with those reported in @xcite ( although our code is not equipped to handle the strong shock conditions which they saw and so we can see only the beginnings of this behaviour ) .",
    "we therefore attribute the difference in results to the different initial conditions used .    in our simulations , we start with supra - horizon - scale perturbations derived from the quasi - homogeneous solution , which are still well within the linear regime as far as the hydrodynamical variables are concerned ( although they are non - linear in the curvature , as mentioned previously ) .",
    "these perturbations , with only a growing component , have a very special relationship between the density profile and the velocity field .",
    "if we imposed as our initial conditions , at the same supra - horizon - scale , a perturbation of density but not of velocity ( as we did in @xcite ) , then the perturbation would reconfigure as it evolved , going back to this special relationship between the density profile and the velocity field before horizon crossing .",
    "( comparing with a similar perturbation which is linear in _ all _ quantities , including the curvature , one can think there of it as being a superposition of growing and decaying modes : as it evolves , the decaying mode dies away , leaving only the growing mode . )",
    "when this special type of perturbation becomes non - linear in the fluid quantities as well as in the curvature , it still holds together and does not produce shocks in collapses producing black holes , as a general perturbation set up at late times can do .",
    "shibata & sasaki @xcite who used a similar type of initial perturbation to ours , but formulated in a completely different way , also did not mention seeing shock formation in their collapses producing black holes .",
    "the top two frames show the behaviour of @xmath77 and the radial four - velocity @xmath22 for a nearly - critical case ( @xmath78 , plotted against @xmath79 at different time levels , with the dashed curve representing the initial conditions used by the observer - time code .",
    "@xmath80 is the horizon scale at the moment of horizon crossing .",
    "the bottom frame shows the equivalent plot of @xmath77 for a sub - critical case with @xmath81 which does not produce a black hole .",
    "some information about timing is given later , in figure [ fig.5].,title=\"fig:\",width=226 ] the top two frames show the behaviour of @xmath77 and the radial four - velocity @xmath22 for a nearly - critical case ( @xmath78 , plotted against @xmath79 at different time levels , with the dashed curve representing the initial conditions used by the observer - time code .",
    "@xmath80 is the horizon scale at the moment of horizon crossing .",
    "the bottom frame shows the equivalent plot of @xmath77 for a sub - critical case with @xmath81 which does not produce a black hole .",
    "some information about timing is given later , in figure [ fig.5].,title=\"fig:\",width=226 ] the top two frames show the behaviour of @xmath77 and the radial four - velocity @xmath22 for a nearly - critical case ( @xmath78 , plotted against @xmath79 at different time levels , with the dashed curve representing the initial conditions used by the observer - time code .",
    "@xmath80 is the horizon scale at the moment of horizon crossing .",
    "the bottom frame shows the equivalent plot of @xmath77 for a sub - critical case with @xmath81 which does not produce a black hole .",
    "some information about timing is given later , in figure [ fig.5].,title=\"fig:\",width=226 ]    we next present some further results from our simulations of pbh formation near to the critical limit which give further insight into the nature of the process . the critical case @xmath82 separates cases which collapse to give a black hole from ones which bounce and merge back into the ambient medium . in figure [ fig.2 ]",
    "we show some plots for a nearly - critical case and a subcritical one .",
    "the top two frames show results from a run which was too close to critical for us to tell whether it would produce a black hole or not by the time that it terminated . here",
    "one can see an important characteristic feature of nearly - critical collapse .",
    "the quantity @xmath77 is a key diagnostic of the behaviour , going to 1 at horizons , both the cosmological horizon and the apparent horizon of the forming black hole . in the top left - hand frame , @xmath77 is plotted as a function of @xmath79 at different time levels , where @xmath80 is the horizon scale at the moment of horizon crossing .",
    "the dashed curve represents the initial conditions used by the observer - time code .",
    "this plot is showing just the inner part of the solution where the collapse occurs : the outer part where @xmath77 rises to 1 again at the cosmological horizon is at far larger radii .",
    "as time proceeds , the maximum of @xmath77 initially decreases to around @xmath83 , moving outwards in radius , but then it moves towards the centre , maintaining an almost constant value but with a very slow decrease towards an eventual value of @xmath84 .",
    "this marks a `` critical surface '' that separates cases giving collapse to a black hole from ones which do not @xcite .",
    "super - critical and sub - critical cases eventually deviate away from this .",
    "the right - hand frame shows the corresponding behaviour of the radial four velocity @xmath22 ( note that these profiles look rather different when viewed in observer - time from the familiar picture in cosmic - time ) .",
    "initially the velocity is positive everywhere with the general cosmological expansion just being slowed somewhat in the region of the perturbation .",
    "as time goes on , the expansion is progressively slowed down both because the universe as a whole is decelerating and because the effect of the perturbation becomes progressively greater in the central regions .",
    "after the dashed curve marking the initial time , the maximum in the velocity profile becomes progressively less pronounced and eventually the expansion reverses into a collapse in the central regions . as time proceeds further , the maximum infall velocity increases but the size of the collapsing region shrinks , eventually tending towards zero . outside the collapsing region",
    ", one sees increasing positive velocities , representing a wind which takes matter away from the central condensation .",
    "we will analyse this in more detail when we consider a super - critical collapse which produces a black hole . during the `` equilibrium phase '' , when the maximum of @xmath77 ( which from now on we will refer to as @xmath85 ) remains roughly constant , the location of this maximum corresponds to that where the velocity goes to zero , separating the collapsing region from that of the outgoing wind . at the location of @xmath85 ,",
    "there is a continuing close balance between gravitational forces and pressure gradients which is a key feature of critical collapse .",
    "as the collapsing region shrinks , a balance is kept all the way down to zero size in the special critical case @xmath66 . for sub - critical cases , with @xmath86 , pressure eventually wins over gravity : the remaining material in the collapsing region bounces , with a consequent decrease of @xmath85 ( see the bottom frame of figure [ fig.2 ] ) , and disperses into the surrounding medium . for nearly - critical cases , this is a surprisingly violent process , as has been described in @xcite . for super - critical cases , with @xmath87",
    ", gravity eventually wins over pressure , @xmath85 then grows towards 1 and a black hole is formed .",
    "the rest of the present section contains a detailed discussion of some of the features of this , as seen in the simulations .",
    "these plots , for a representative but fairly extreme case where a black hole is formed , show different views of the behaviour of @xmath77 as a function of @xmath79 or @xmath88 at different time levels with the dashed curve representing the initial conditions used by the observer - time code .",
    "the perturbation has @xmath89 and the collapse gives rise to a black hole with a mass @xmath90 . in the top two frames , @xmath77 is plotted against @xmath79 with the right - hand frame being an enlargement of the inner parts of the left - hand one .",
    "the bottom two frames show the same data plotted as a function of @xmath88 .",
    "some information about timing is given later , in figure [ fig.5].,title=\"fig:\",width=226 ] these plots , for a representative but fairly extreme case where a black hole is formed , show different views of the behaviour of @xmath77 as a function of @xmath79 or @xmath88 at different time levels with the dashed curve representing the initial conditions used by the observer - time code .",
    "the perturbation has @xmath89 and the collapse gives rise to a black hole with a mass @xmath90 . in the top two frames ,",
    "@xmath77 is plotted against @xmath79 with the right - hand frame being an enlargement of the inner parts of the left - hand one .",
    "the bottom two frames show the same data plotted as a function of @xmath88 .",
    "some information about timing is given later , in figure [ fig.5].,title=\"fig:\",width=226 ] these plots , for a representative but fairly extreme case where a black hole is formed , show different views of the behaviour of @xmath77 as a function of @xmath79 or @xmath88 at different time levels with the dashed curve representing the initial conditions used by the observer - time code .",
    "the perturbation has @xmath89 and the collapse gives rise to a black hole with a mass @xmath90 . in the top two frames ,",
    "@xmath77 is plotted against @xmath79 with the right - hand frame being an enlargement of the inner parts of the left - hand one .",
    "the bottom two frames show the same data plotted as a function of @xmath88 .",
    "some information about timing is given later , in figure [ fig.5].,title=\"fig:\",width=226 ] these plots , for a representative but fairly extreme case where a black hole is formed , show different views of the behaviour of @xmath77 as a function of @xmath79 or @xmath88 at different time levels with the dashed curve representing the initial conditions used by the observer - time code .",
    "the perturbation has @xmath89 and the collapse gives rise to a black hole with a mass @xmath90 . in the top two frames ,",
    "@xmath77 is plotted against @xmath79 with the right - hand frame being an enlargement of the inner parts of the left - hand one .",
    "the bottom two frames show the same data plotted as a function of @xmath88 .",
    "some information about timing is given later , in figure [ fig.5].,title=\"fig:\",width=226 ]    for this discussion of super - critical collapse , we will focus on a particular representative case which is typical of those fairly close to the critical limit .",
    "this case has @xmath91 and forms a black hole with mass @xmath92 .",
    "figure [ fig.3 ] shows various views of the @xmath77 profiles . in the top two frames ,",
    "@xmath77 is plotted against @xmath79 with the right - hand frame being an enlargement of the inner parts of the left - hand one .",
    "the top left - hand frame is the counterpart of the plots which we have shown for the critical and sub - critical cases and one can see the `` intermediate state '' with its almost - constant value of @xmath85 and the eventual precipitous rise of this towards 1 as the black hole forms .",
    "( note that in observer time , the black hole only fully forms asymptotically , when the time as measured by a distant observer tends to infinity , but we terminated the calculation when the central value of the lapse @xmath51 had fallen below @xmath93 . ) the top right - hand frame is an enlargement of the central part , showing how the solution diverges away from the intermediate state and enters the final black - hole collapse phase .",
    "the bottom two frames show the same data plotted as a function of @xmath88 .",
    "this is useful for showing in a clear way that when the collapsing region reaches the intermediate state , it then evolves by losing material to the outside while maintaining almost the same compactness until the final precipitous collapse .",
    "again , the right - hand frame is an enlargement of the central part of the left - hand one , showing more detail of the departure from the intermediate state .",
    "this figure shows further details for the same case as in figure [ fig.3 ] .",
    "the top two frames show the profiles of radial four velocity @xmath22 and energy density @xmath5 at two key moments : the time when the wind away from the central region reaches its maximum strength ( solid line ) and the moment when the void starts to refill from the outside ( dot - dashed line ) .",
    "note that the black hole is at a very small scale on the left - hand side of these plots .",
    "the bottom frame shows the mass profiles in the very central regions at different time levels , with the dashed curve representing the initial conditions used by the observer - time code and the dotted lines marking the mass and radius of the eventual black hole.,title=\"fig:\",width=226 ] this figure shows further details for the same case as in figure [ fig.3 ] .",
    "the top two frames show the profiles of radial four velocity @xmath22 and energy density @xmath5 at two key moments : the time when the wind away from the central region reaches its maximum strength ( solid line ) and the moment when the void starts to refill from the outside ( dot - dashed line ) .",
    "note that the black hole is at a very small scale on the left - hand side of these plots .",
    "the bottom frame shows the mass profiles in the very central regions at different time levels , with the dashed curve representing the initial conditions used by the observer - time code and the dotted lines marking the mass and radius of the eventual black hole.,title=\"fig:\",width=226 ] this figure shows further details for the same case as in figure [ fig.3 ] .",
    "the top two frames show the profiles of radial four velocity @xmath22 and energy density @xmath5 at two key moments : the time when the wind away from the central region reaches its maximum strength ( solid line ) and the moment when the void starts to refill from the outside ( dot - dashed line ) .",
    "note that the black hole is at a very small scale on the left - hand side of these plots .",
    "the bottom frame shows the mass profiles in the very central regions at different time levels , with the dashed curve representing the initial conditions used by the observer - time code and the dotted lines marking the mass and radius of the eventual black hole.,title=\"fig:\",width=226 ]    as material is shed from the central condensation when it is in the intermediate state , this forms a strong relativistic wind ( as mentioned earlier ) which excavates a deep semi - void around it .",
    "this is shown in the top two frames of figure [ fig.4 ] where the profiles of radial four velocity and energy - density are plotted .",
    "two times are shown .",
    "the first ( marked by the solid curves ) is when the wind reaches its maximum strength , here with the maximum of @xmath94 being around 50 ( for more extreme cases , we see values of more than 100 ) . by this stage , a substantial semi - void",
    "has already formed around the central condensation and this then proceeds to deepen further as more material is blown outwards by the wind which is being accelerated by the steep pressure gradient at its inner edge .",
    "the second time shown ( marked with the dot - dashed curves ) is when the outward velocity has dropped to zero at the outer edge of the void and it then starts to refill . at this stage ,",
    "the amr scheme used for our simulations has reached 23 levels of refinement ( a factor of almost @xmath95 ) .",
    "when we follow the subsequent refilling of these voids , we find that it proceeds very gently and takes place on a timescale which is long compared to the dynamical timescale of the final collapse producing the black hole but short in cosmological terms .",
    "we then expect that further accretion onto the central black hole would proceed in a standard way .",
    "the bottom frame of figure [ fig.4 ] shows the profiles for the mass at successive times , with the dashed curve again marking the initial data for the observer - time code .",
    "initially , when all of the medium is expanding , @xmath96 is , of course , decreasing at all values of @xmath21 but later , when the collapse starts , @xmath96 increases for the values of @xmath21 inside the collapsing region , giving asymptotically the final mass of the black hole , evaluated where @xmath85 tends to @xmath39 and the lapse @xmath51 tends to 0 ( this location is marked by the dotted lines ) .",
    "the effect of the void can be seen in the very flat profile of @xmath96 outside this point ( the last curve shown corresponds to the same time as the dot - dashed curves in the top two frames ) .",
    "the left - hand frame shows @xmath85 plotted against the time @xmath18 ( given in units of the horizon - crossing time @xmath97 ) for seven different cases of collapse forming a black hole . the right - hand frame shows a second scaling behaviour for the same cases as in figure [ fig.1 ] : plotting @xmath98 as function of @xmath57 .",
    "the time @xmath18 used here is measured when @xmath85 becomes larger than 0.5 , 0.6 , 0.7 and 0.8 respectively ( the larger values corresponding to lower sets of points ) .",
    "each of the four sets of data is fitted by a scaling law with @xmath8.,title=\"fig:\",width=226 ] the left - hand frame shows @xmath85 plotted against the time @xmath18 ( given in units of the horizon - crossing time @xmath97 ) for seven different cases of collapse forming a black hole .",
    "the right - hand frame shows a second scaling behaviour for the same cases as in figure [ fig.1 ] : plotting @xmath98 as function of @xmath57 .",
    "the time @xmath18 used here is measured when @xmath85 becomes larger than 0.5 , 0.6 , 0.7 and 0.8 respectively ( the larger values corresponding to lower sets of points ) .",
    "each of the four sets of data is fitted by a scaling law with @xmath8.,title=\"fig:\",width=226 ]    considering now the range of collapse models , it is interesting to plot @xmath85 as function of time and we do this , in the left - hand frame of figure [ fig.5 ] , for seven representative cases from the set shown in figure [ fig.1 ] .",
    "( the time @xmath18 is given here in units of the horizon - crossing time @xmath97 .",
    "we recall that @xmath18 is the time as measured by a comoving observer at the outer edge of our grid ) . at the early times , just after the start of the observer - time calculation , the values of @xmath85 are almost identical for the different cases due to the rather small range of values of @xmath0 , but differences grow as the evolution proceeds .",
    "( the values of @xmath58 decrease going from top to bottom of the curves on the left - hand side of the plot . )",
    "the time spent in the intermediate state at almost constant @xmath85 increases as @xmath0 tends to @xmath1 but reaches a finite limit .",
    "when gravity wins against pressure , causing departure from the intermediate state , the increase of @xmath85 towards 1 occurs with progressively steeper gradients as @xmath0 tends to @xmath1 , becoming vertical in the limit .",
    "one can see that the curves all intersect at a particular point having @xmath99 and whose time coordinate is that of the vertical rise seen in the limit .",
    "we refer to this as the critical time @xmath100 and its value here is given by @xmath101 .",
    "it is the time that would be taken in the critical limit @xmath102 for all of the matter to be shed from the central condensation .    as noted previously , when using observer time , a black hole is fully formed only asymptotically as @xmath103 and so one can not speak of a finite time for black - hole formation .",
    "however , there is no problem in measuring the time at which @xmath85 rises through any particular threshold value between 0.5 and slightly less than 1 during the final approach to the black - hole state . as can be seen from the left - hand frame of figure [ fig.5 ]",
    ", this time gets progressively closer to @xmath100 as @xmath12 . defining @xmath18 now to be the time at which a particular threshold is crossed",
    ", one finds that the values of @xmath104 satisfy scaling laws in @xmath57 for @xmath0 sufficiently close to @xmath1 , as can be seen in the right - hand frame of figure [ fig.5 ] where we have plotted data for all of the cases shown in figure [ fig.1 ] .",
    "the four sets of points are for thresholds of @xmath85 equal to 0.5 , 0.6 , 0.7 and 0.8 respectively , going from top to bottom .",
    "each of the scaling laws has @xmath8 , in close agreement with that for the black hole masses .",
    "this is consistent with what one would expect if this process is genuinely an example of the critical collapse phenomenon .",
    "the @xmath77 evolution for the critical case , shown in figure [ fig.2 ] , is re - plotted using @xmath105\\cdot[t_h / r_h]$ ] on the x - axis so as to look for self - similar behaviour.,width=226 ]    another characteristic feature of critical collapse is that it is related to a self - similar behaviour ( see the review in @xcite ) .",
    "this means that it should be possible to write the solution in terms of suitable variables in such a way that it remains the same , independent of time , sufficiently close to the critical limit . in figure",
    "[ fig.6 ] , we plot @xmath77 for the critical case , as shown in figure [ fig.2 ] , against @xmath106 .",
    "once again , the dashed curve represents the initial time .",
    "when the solution reaches the intermediate state , the inner parts do get progressively closer to reaching an unchanging profile as time goes on .",
    "the self similarity is not exact , but this is understandable since the collapse is occurring within an outer expanding medium with which there is a continuing interaction because of the shedding of matter from the central condensation .",
    "we have only a local approximate self - similar behaviour , but this is enough for having an associated scaling - law behaviour .",
    "in this paper , we have presented results from our investigation of the extent to which primordial black hole formation in the radiative era of the early universe can be considered as a manifestation of the critical collapse phenomenon . for doing this",
    "we have made numerical simulations including both the collapse producing the black hole and the continuing expansion of the surrounding universe , focusing on the behaviour of initial perturbations of a type which could have come from inflation , having only a growing component and no decaying component . implementing an amr scheme within our lagrangian code ,",
    "we have been able to follow formation of black holes over a range of more than a thousand in mass . for the type of perturbation that we are studying , we find that scaling - law behaviour persists down to the smallest masses that we are able to follow , with no sign of a levelling - off such as had been reported in earlier work .",
    "we attribute this difference to the different type of initial conditions used ; the present ones do not lead to the formation of shocks during collapses giving rise to black holes , which were a key feature of previous work .    for cases near to the critical limit",
    ", we observe formation of a rather long - lived intermediate state with a central condensation having compactness @xmath77 about half that of a black hole .",
    "this central condensation progressively sheds material in the form of an ultra - relativistic wind , excavating a semi - void between it and the surrounding matter of the universe , until it eventually either collapses to form a black hole or disperses into the surrounding medium . in cases where a black hole does form , we find that the void eventually refills rather gently , and we expect that subsequent accretion would then proceed in a standard way .",
    "in addition to the scaling law for the black hole mass as a function of the closeness of the perturbation amplitude to the critical limit , we have also observed other features characteristic of critical collapse : existence of a critical surface , another associated scaling law with the same exponent , and an approximate similarity solution . taken together ,",
    "all of this leads us to conclude that we genuinely have here a potential physical realization of the critical collapse phenomenon . for perturbations of the type coming from inflation",
    ", we have not seen any evidence to make us think that there would be a deviation away from the scaling law at lower masses until either there is a change in the matter model or the quantum regime is reached .",
    "we gratefully acknowledge helpful discussions with a number of colleagues during the course of this work , including bernard carr , carsten gundlach , ian hawke and karsten jedamzik .",
    "we have noted typographical errors in some of the equations in paper 2 .",
    "we list the corrected forms below .",
    "the formulae used in the numerical calculations presented in paper 2 were correct and there is no change in the results .",
    "eq.(95 ) : k^(r ) = - 1 +    eq.(100 ) : 3 0    eq.(101 ) : & ( z ) ( ) f ( ) 1 + -z^2 - ^2 z^4 + &    eq.(103 ) : ( z ) 2 ^ 2 1 - z^2",
    "as noted in section 3 , our code has a long history and has been carefully tested in its various forms .",
    "its approach and basic structure are very similar to those of the code for which extensive test - bed calculations were presented by baumgarte , shapiro & teukolsky @xcite and we mentioned a number of other tests ourselves in paper 2 . in this appendix",
    ", we describe a convergence test which we have carried out with our updated version of the code . in our view",
    ", more stringent tests are provided by carefully considering internal consistency features of the results , which we have done over a range of more than ten orders of magnitude in ( @xmath107 ) , but having a convergence test is nevertheless useful in telling more about the behaviour of the code and in estimating error bars .",
    "performing a convergence test presents some unusual aspects with the kind of code being used here , which has a non - uniform lagrangian grid as its basic one , rather than an eulerian grid , and which then has amr on top of this .",
    "however , it is straightforward to proceed by dividing each zone of our standard grid into two equal parts and halving the refinement criteria on @xmath60 , mentioned in section 3 , so as to produce a `` double resolution '' version of the code with which the calculation can then proceed as before . similarly , a further subdivision can be made so as to produce a `` quadruple resolution '' version .",
    "making a convergence test by comparing calculations done in this way is somewhat imperfect but it has the merit of being a test of the full code as it actually runs .",
    "a particular point requiring care is in ensuring that the models being compared at different resolutions are genuinely equivalent .",
    "as discussed in section 4 , the hydrodynamic behaviour depends sensitively on the value of @xmath58 , and we are going down as low as @xmath108 in this quantity . when calculating the threshold @xmath1 with our three different resolutions , one finds values that vary in the fourth significant figure ( although they are converging rapidly with increasing resolution - by about one extra significant figure with each halving of the grid ) . since it is the difference between the actual @xmath0 and the threshold @xmath1 which determines the hydrodynamical behaviour , it is important that the models being compared at the different resolutions should all have the same @xmath58 , but with the @xmath1 being subtracted from the @xmath0 always being calculated at the same resolution as the @xmath0 . for seeing the convergent behaviour",
    ", it is necessary to have a sufficient number of reliable significant figures in the results .",
    "the higher resolutions give very precise results but do not allow calculations to be made for values of @xmath58 as small as those possible with the standard resolution , mainly because of running into cancellation errors in the calculation of the pressure gradients . with the quadruple resolution , we can determine @xmath1 correct to nine significant figures but no more .",
    "this , then , determines the accuracy to which we can say that the models being compared at the different resolutions have the same @xmath58 . in order",
    "that the models being compared have the same @xmath58 correct to five significant figures ( as necessary for making the convergence test ) , we can not then use a case with @xmath109 .",
    "convergence test for the code : profiles are shown of @xmath25 against @xmath21 for @xmath110 , as calculated with the standard resolution used for the calculations presented in this paper ( solid line ) , double resolution ( dotted line ) and quadruple resolution ( dashed line ) . note the very expanded vertical scale.,width=230 ]    in figure [ fig.b1 ] , we show the results of a convergence test made with @xmath110 , plotting @xmath25 against @xmath21 at the three resolutions , with the standard resolution being shown with the solid line , the double resolution with the dotted line , and the quadruple resolution with the dashed line .",
    "note that the vertical scale in this plot has been greatly expanded so that the differences can be easily seen .",
    "the curves are clearly converging with an order of convergence of around two although it is not quite uniform , as expected with the way in which the test is being done .",
    "the resulting error bars are at a fraction of one percent , so that the difference between results with the different resolutions would just barely be visible on the other plots presented in this paper .",
    "the main noticeable effect is that the curves become slightly smoother .",
    "the case used for the test is not one of the most extreme ones ( for the reason given above ) but the amr is still going through eleven levels of refinement and so the test is a serious one .",
    "the region shown in figure [ fig.b1 ] is the one where the differences with resolution can be most clearly seen .",
    "the behaviour of the scaling law is the same at all of the resolutions ."
  ],
  "abstract_text": [
    "<S> following on after two previous papers discussing the formation of primordial black holes in the early universe , we present here results from an in - depth investigation of the extent to which primordial black hole formation in the radiative era can be considered as an example of the critical collapse phenomenon . </S>",
    "<S> we focus on initial supra - horizon - scale perturbations of a type which could have come from inflation , with only a growing component and no decaying component . in order to study perturbations with amplitudes extremely close to the supposed critical limit </S>",
    "<S> , we have modified our previous computer code with the introduction of an adaptive mesh refinement scheme . </S>",
    "<S> this has allowed us to follow black hole formation from perturbations whose amplitudes are up to eight orders of magnitude closer to the threshold than we could do before . </S>",
    "<S> we find that scaling - law behaviour continues down to the smallest black hole masses that we are able to follow and we see no evidence of shock production such as has been reported in some previous studies and which led there to a breaking of the scaling - law behaviour at small black - hole masses . </S>",
    "<S> we attribute this difference to the different initial conditions used . </S>",
    "<S> in addition to the scaling law , we also present other features of the results which are characteristic of critical collapse in this context . </S>"
  ]
}