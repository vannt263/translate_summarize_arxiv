{
  "article_text": [
    "the implicit particle in cell ( pic ) method was developed as a general plasma simulation tool based on a fully kinetic approach  @xcite that did not rely on any physical approximation but only on the use of advanced numerical methods to reduce the cost of large scale kinetic simulations .    in its simplest form",
    "the pic method uses explicit time discretization methods  @xcite .",
    "the equations of motion need the fields acting on the computational particles and the field equations need the moments computed from the particles .",
    "the great majority of pic codes in use today address this problem relying on a explicit method .    in the explicit method",
    ", the field equations are discretized with one in a number of different explicit methods available ( see  @xcite for a review ) and the equations of motion are usually discretized with the leap - frog algorithm  @xcite .",
    "the key point is that in the explicit method , the field equations need only the sources from the previous time cycle and the equations of motions need only the fields from the previous time cycle .",
    "even though the equations remain coupled , no iteration is needed and the cycle becomes a simple marching order where each block is applied after its predecessor and needs only information already available .",
    "this choice makes the explicit pic very simple .",
    "as can be imagined this simplicity comes at a price .",
    "the explicit pic approach is subject to three very restrictive stability constraints .",
    "first , the explicit discretization of the field equations requires that a courant condition must be satisfied on the speed of light : @xmath0    second , the explicit discretization of the equations of motion introduces a constraint related to the fastest electron response time , the electron plasma frequency : @xmath1 note that , instead , thanks to the boris algorithm for the motion in a magnetic field , the gyromotion introduces no stability constraints  @xcite .    finally , the interpolation between grid and particles causes a loss of information and an aliasing instability called finite grid instability that results in an additional stability constraint : @xmath2 that requires the grid spacing to be of the order of the debye length or smaller , the proportionality constant @xmath3 being of order one and dependent on the details of the scheme used  @xcite .    thanks to ever faster computers ,",
    "the explicit pic method has been able to achieve remarkable results .",
    "but there are problems where multiple scales still prevent its use .",
    "when the interest is on large scales and slow processes other approaches are needed .",
    "the implicit pic approach provides a viable alternative in such cases .",
    "the implicit pic method has been developed along two different lines of investigation : the direct implicit method  @xcite and the implicit moment method  @xcite . here",
    "we consider the implicit moment method . in the last few years , we have published a number of papers on the application of celeste3d and a full description of the methods used has been provided by  @xcite . in the present work , we summarize the latest status of the implicit moment method as implemented in celeste3d .",
    "we consider first the time discretization .",
    "the solution is advanced in time with discrete steps , @xmath4 , from the initial time , @xmath5 to the final time @xmath6 .",
    "the generic quantity @xmath7 at time step @xmath8 ( @xmath9 ) , is denoted with @xmath10 .",
    "the equations of motion are discretized as @xcite : @xmath11 where all quantities evaluated at intermediate levels are computed as : @xmath12 .",
    "note that the velocity equation is more conveniently rewritten as : @xmath13 where @xmath14 ( independent of the particle weight and unique to a given species ) . for convenience ,",
    "we have introduced hatted quantities obtained by explicit transformation of quantities known from the previous computational cycle : @xmath15 the transformation tensor operators @xmath16 are defined as : @xmath17 and represent a scaling and rotation of the velocity vector .",
    "the semi  discrete ( continuous in space ) temporal discretization to maxwell s equations is written as : @xmath18    the parameter @xmath19 $ ] is chosen in order to adjust the numerical dispersion relation for electromagnetic waves ( for @xmath20 , the algorithm is shown to be unstable @xcite ) .",
    "we note that for @xmath21 the scheme is second - order accurate in @xmath4 ; for @xmath22 the scheme is first - order accurate .",
    "the sources in maxwell s equations necessitate information from the particles : @xmath23 where the species is labelled by @xmath24 and the sums are carried over all particles of a species @xmath25 .",
    "the coupling with the particle equations of motion is evident .",
    "the fundamental problem to address in developing an implicit pic method is the coupling between the equations of motion and the field equations for the presence of the time advanced electric field ( but not magnetic field , that is used from the previous cycle , as no instability is introduced ) in the equations of motion and for the appearance of the particle properties in the sources of the maxwell equations . in both cases",
    "the coupling is implicit , so that the new particle properties need to be known before the fields can be computed and likewise the new fields need to be available before the new particle properties can be computed .",
    "the implicit moment method removes the need for iterative methods and provides a direct method to compute the advanced fields without first having to move the particles .",
    "the implicit moment method reduces the number of equations that must be solved self - consistently to a set of coupled fluid moment and field equations .",
    "the solution of these equations implicitly , and the subsequent solution of the particle equations of motion in the resulting fields , is stable and accurate .",
    "the coupling due to the implicit discretization of both field and particle equations is approximated , representing the sources of the field equations using the moment equations instead of the particle equations directly .",
    "once the field equations are solved within this approximation , the rest of the steps can be completed directly without iterations : with the new fields , the particle equations of motion can be solved and the new current and density can be computed for the next computational cycle .    the implicit moment method formulation used here is described in details by @xcite .",
    "the key step is to derive a suitable set of moment equations that can approximate the particle motion over a computational cycle .",
    "the approach followed in the present implementation is based on a series expansion of the interpolation functions used to transfer information between grid and particles .",
    "the details of the simple but demanding algebraic manipulations are provided by  @xcite , the final answer being : @xmath26 where the following expressions were defined : @xmath27 with the obvious meaning , respectively , of current and pressure tensor based on the transformed hatted velocities .",
    "an effective dielectric tensor is defined to express the feedback of the electric field on the plasma current and density : @xmath28    the expression ( [ momentimplicit ] ) for the sources of the maxwell s equations provide a direct and explicit closure of maxwell s equations . when eq .",
    "( [ momentimplicit ] ) is inserted in eq .",
    "( [ differencedmax ] ) , the maxwell s equations can be solved without further coupling with the particle equations .",
    "this is the key property of the moment implicit method and allows the implicit moment pic method to retain the once - through approach typical of explicit methods and eliminates the need for expensive iteration procedures that would require to move the particles multiple times per each computational cycle .",
    "the stability properties of the method described above have been studied extensively in the past  @xcite .",
    "all the stability constraints discussed above for the explicit method are removed .",
    "the implicit particle mover removes the need to resolve the electron plasma frequency , and the implicit formulation of the field equations removes the need to resolve the speed of light .",
    "the time step constraints are replaced by an accuracy limit arising from the derivation of the fluid moment equations using the series expansion .",
    "this limit restricts the mean particle motion to one grid cell per time step  @xcite , i.e. @xmath29 the finite grid instability limit for the explicit method , @xmath30 is replaced by  @xcite @xmath31 that allows large grid spacings to be used when large time steps are taken . the gain afforded by",
    "the relaxation of the stability limits is two - fold .",
    "first , the time step can far exceed the explicit limit . in a typical plasma",
    "the electron plasma frequency is far smaller than the time scales of interest and its accurate resolution is not needed . within the current approach ,",
    "the processes developing at the sub-@xmath4 scale are averaged and their energy is damped by a numerically - enhanced landau damping .",
    "in other approaches , such as the gyrokinetic or hybrid approach  @xcite , such processes are completely removed and the energy channel towards them is interrupted , removing for example the possibility to exchange energy between sub-@xmath4 fluctuations and particles . in the implicit approach , instead , the sub-@xmath4 scales remain active and the energy channel remains open .",
    "this is a crucial feature to retain a full kinetic approach .",
    "furthermore , when additional resolution of the smallest scales is needed , the implicit method can access the same accuracy of the explicit method simply using a smaller time step and grid spacing .",
    "this feature is not accessible to reduced models , e.g. gyroaveraged methods , that remove the small scales entirely .",
    "second , the grid spacing can far exceed the debye length .",
    "often the scales of interest are much larger than the debye length .",
    "the ability to retain a full kinetic treatment without the need to resolve the debye length results in a much reduced cost for the implicit pic method .",
    "the implicit moment pic method described above is implemented in the celeste3d code .",
    "the celeste3d code was originally conceived for the numerical tokamak project  @xcite but has found its main application in space physics .",
    "four types of tests have been conducted to verify and validate celeste in full 3d cartesian geometry and in reduced geometries in 2d and 1d : 1 ) well known benchmarks including shocks , the weibel instability , landau damping and ion acoustic waves  @xcite ; 2 ) the gem challenge  @xcite and the newton challenge  @xcite ; 3 ) study of reconnection in systems with low betas , investigating the reconnection process both at the macroscopic and microscopic level obtaining agreement with the explicit pic code npic  @xcite ; 4 ) 3d stability study of a current sheet equilibrium , compared with satellite observations obtained from the cluster and geotail mission  @xcite .",
    "as an example of this last case , we show here the results of an actual simulation conducted in 3d of a system initially in the magnetotail equilibrium described by  @xcite .",
    "the physics developing in the simulation includes first the growth and saturation of the lower hybrid drift instability , followed by the onset of reconnection and current flapping leading to the macroscopic restructuring of the topological configuration of the magnetotail .",
    "the physics steps of the process are described in deatils by @xcite .",
    "the fundamental consideration of interest here is the efficacy of the simulation approach . in a typical explicit run",
    ", the time step would have to be selected according to the stability constraint of @xmath32 . in a typical magnetotail case ,",
    "the electron plasma frequency is of the order of @xmath33s@xmath34 , and the ion plasma frequency is of the order of @xmath35s@xmath34 , both smaller than the smallest scale of interest for this problem which is the lower hybrid frequency range of @xmath36s@xmath34 . in a implicit simulation",
    ", we can select the time step to the ion plasma frequency , still resolving accurately the lower hybrid range , but saving two orders of magnitude compared with the explicit case that instead is needlessly resolving the electron plasma scale .",
    "a similar gain occurs in each spatial direction . in a explicit simulation , for stability",
    "the grid spacing needs to satisfy @xmath37 .",
    "the debye length in the magnetotail is of the order of 100 m .",
    "but the smallest scales of interest in the present case are in the range between the electron ( 10 km ) and the ion ( 100 km ) inertial scales or gyroscales . in our simulation",
    "we set the resolution at 10 km , saving two orders of magnitude in each spatial direction but still resolving the important scales .",
    "counting all savings , we have saved 2 orders of magnitude in each spatial direction and in time ( in total 8 orders of magnitude ) , without loosing the deatils of the scales of interest .",
    "the savings means that on the same computer , an implciti simulation can compute in one day what an explicit simulation would require nearly 800,000 years .",
    "the author is very grateful to jerry brackbill and paolo ricci for the collaboration in all the work summarized here .",
    "the present work is supported by the _ onderzoekfonds k.u .",
    "( research fund ku leuven ) , by the european commission through the solaire network ( mrtn - ct-2006 - 035484 ) , by the nasa sun earth connection theory program and by the ldrd program at the los alamos national laboratory .",
    "work performed in part under the auspices of the national nuclear security administration of the u.s .",
    "department of energy by the los alamos national laboratory , operated by los alamos national security llc under contract de - ac52 - 06na25396 .",
    "simulations conducted in part on the hpc cluster vic of the katholieke universiteit leuven ."
  ],
  "abstract_text": [
    "<S> we discuss the fundamentals of the implicit moment method for particle in cell ( pic ) simulation as presently implemented in the celeste3d code . </S>",
    "<S> we present the method in its fully electromagnetic and fully kinetic version . </S>",
    "<S> the application of the method is to problems with multiple temporal and spatial scales , common in all space , astrophysical and laboratory plasmas . </S>"
  ]
}