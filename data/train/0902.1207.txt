{
  "article_text": [
    "the goal of this paper is two - fold ; the first goal is to present an algorithm for developing reduced - order models of the input - output dynamics of _ unstable _ high - dimensional linear state - space systems ( such as linearized navier - stokes equations with actuation and sensing ) , while the second goal is to demonstrate the algorithm by developing estimation - based controllers to stabilize unstable steady states of a two dimensional low - reynolds - number flow past a flat plate at a large angle of attack .      development of feedback control strategies based on linearized navier - stokes equations is attractive due to the ready availability of a large class of control techniques , and there has been substantial progress in this direction in the past decade , reviewed in detail by  @xcite .",
    "however , many of these techniques are limited to relatively small dimensional systems  @xmath0 , while the numerical discretization of fluid flows invariably result in huge dimensional systems , typically  @xmath1 .",
    "thus , model reduction has played an important role in making these tools further accessible to fluid flows .",
    "extensive research effort in model reduction has focused on the method of proper orthogonal decomposition  ( pod ) and galerkin projection , developed first by  @xcite .",
    "the main disadvantage of this technique is that , although the pod modes capture the energetically important structures of the flow , the reduced - order models obtained by the subsequent galerkin projection of the governing equations onto these modes often do not faithfully represent the dynamics .",
    "various modifications to improve this method have been proposed and used for flow control ; refer to the introduction of  @xcite for a review of these techniques .",
    "the pod / galerkin methods have been applied for flow control in various contexts , such as bluff - body wake suppression ( @xcite , @xcite , @xcite , @xcite ) , noise reduction in cavity flow  ( @xcite , @xcite ) , and drag reduction in turbulent boundary layers  ( @xcite , @xcite ) .",
    "another model - reduction technique , based on projection onto the global ( stable or unstable ) eigenmodes of the flow linearized about steady states , has been used by  @xcite and  @xcite in the context of spatially developing flows such as separated boundary layers . in this paper , we focus on an approximate balanced truncation method developed by  @xcite as an approximation to the original method of  @xcite .",
    "this technique captures the dynamically important modes of the system , and the non - approximate version provides rigorous bounds for the resulting reduced - order models .",
    "the method , sometimes called balanced pod , was used to obtain models of the linearized channel flow by  @xcite and the blasius boundary layer by  @xcite , and was shown to accurately capture the control actuation and also to outperform the pod / galerkin models .",
    "the balanced truncation method of  @xcite is applicable only to systems linearized about _",
    "stable _ steady states .",
    "an extension to _ unstable _ linear systems was proposed by  @xcite , by introducing frequency - domain definitions of controllability and observability gramians .",
    "reduced - order models were obtained by first decoupling the dynamics on the stable and unstable subspaces , and then truncating the relatively uncontrollable and unobservable modes on each of the two subspaces . in this paper , we present an approximation algorithm for balanced truncation of linear unstable systems , which results in models that are equivalent to those of  @xcite on the _ stable _ subspace .",
    "the dynamics on the unstable subspace is treated _ exactly _ by a projection onto the global eigenmodes , as in  @xcite .      as a proof - of - concept study ,",
    "the modeling procedure is applied to the problem of two dimensional low - reynolds - number flow past a flat plate at a large angle of attack .",
    "we develop reduced - order models and design controllers that stabilize the unstable steady states of this flow .",
    "our motivation for the choice of this problem comes from our interest in regulating vortices in separated flows behind low aspect - ratio wings , which is of importance in design of micro air vehicles  ( mavs ) .",
    "recently , design of mavs has been inspired from experimental observations in insect and bird flights of a stabilizing leading edge vortex ( see  @xcite and  @xcite ) , which remains attached throughout the wing stroke and provides enhanced lift .",
    "so , it could be beneficial to design controllers that can manipulate the wake of mavs to enhance lift and achieve better maneuverability in presence of wind gusts .",
    "recent studies in this direction , using open - loop control of the flow past low - aspect - ratio wings using steady or periodic blowing , were performed computationally by  @xcite and experimentally by  @xcite .",
    "these studies explored different forcing amplitudes and frequencies , locations and directions .",
    "however , the design of feedback controllers remains a challenge , due to the large dimensionality of the problem and complex flow physics .",
    "we present computational tools , that we hope can at least pave a direction and provide techniques towards addressing some of these challenges .",
    "we consider the 2-d flow past a flat plate , actuated by a localized body force close to the leading edge , with two near - wake velocity sensors .",
    "we design a reduced - order compensator and show that it is able to suppress vortex shedding at high angles of attack .",
    "many previous studies have focused on the control of flow past a cylinder , which is qualitatively similar to the flow past a flat plate at large angle of attack , with the natural flow in both the cases being periodic vortex shedding . for the cylinder ,",
    "the flow undergoes a transition from steady state to periodic shedding with increasing reynolds number , while a similar transition occurs in the flat plate with increasing angle of attack .",
    "there has been considerable research effort on suppression of this shedding in cylinder and other bluff body wakes , using passive and active , open - loop and feedback control , as reviewed by  @xcite . among those ,",
    "some techniques are based on reduced - order models ; for instance , @xcite developed models using artificial neural networks and a pod basis , @xcite modified the pod / galerkin method to account for actuation by means of cylinder - rotation , while  @xcite developed a double pod method to account for changes in the wake structure during transients .",
    "some earlier efforts in the control of a _ flat - plate _ wake include those by  @xcite , @xcite who used vortex - based methods to model the flow past a vertical plate  ( angle of attack  =  @xmath2 ) ; vortex - based models form their own class of modeling techniques reviewed recently by  @xcite .",
    "lagrangian coherent structures were used by  @xcite to enhance mixing in flow past a bluff body with the trailing surface similar to the vertical flat plate .",
    "one of the few efforts towards control of flat plate at an angle of incidence was by @xcite , who used a passive leading - edge suction control along with a potential flow vortex model .",
    "@xcite also used reduced - order vortex models for drag reduction on an elongated d - shaped bluff body .",
    "this paper is organized as follows : in section  [ sec : model_red ] , we first briefly describe the balanced truncation method for unstable systems as developed by  @xcite , and the approximate balanced truncation procedure called balanced pod of  @xcite for large dimensional stable systems",
    ". then , we present an algorithm for approximate balanced truncation of large dimensional _ unstable _",
    "systems , assuming that the dimension of unstable subspace is small and the corresponding global eigenmodes can be computed . in section  [ sec : numerics_ibfs ] , we briefly describe the numerical technique of  @xcite using a fast immersed boundary method , and present the linearized and adjoint formulations of this numerical method . in section  [ section : model_results ] , we present numerical results , using the model example of two - dimensional flow past a flat plate at a large angle of attack and a low reynolds number  @xmath3 .",
    "first , we perform a steady - state analysis and compute the branch of steady states in the entire range of angles of attack ,  @xmath4 .",
    "we also compute the left and right global eigenmodes of the flow linearized about the unstable steady state at  @xmath5 .",
    "we present reduced - order models of the linearized dynamics and use linear optimal control techniques to design controllers that stabilize this steady state .",
    "full - state feedback and more practical near - wake velocity - measurement based feedback controllers are derived , implemented in the nonlinear equations , and shown to suppress vortex shedding .",
    "the paper concludes with a brief discussion in section  [ sec : discussion ] .",
    "we briefly describe a model reduction procedure using the balanced truncation method for unstable systems developed by  @xcite . consider the state - space system @xmath6 where  @xmath7 is the state , @xmath8  is the input , and @xmath9 is the output of the system ; the dot over  @xmath10 represents differentiation with respect to time .",
    "the eigenvalues of  @xmath11 are assumed to be anywhere on the complex plane , except on the imaginary axis .",
    "the standard balanced truncation procedure developed by  @xcite , valid only for stable systems , starts with defining the controllability and observability gramians of the system  ( [ ss ] ) as follows : @xmath12 where asterisks are used to denote adjoint operators .",
    "a co - ordinate transformation is then obtained such that the gramians  ( [ gramians_stable ] ) of the transformed system are equal and diagonal .",
    "the diagonal entries of the transformed gramians , called hankel singular values  ( hsvs ) , decrease monotonically and are directly related to the controllability and observability of the corresponding states .",
    "a reduced - order model is obtained by truncating the states with relatively small hsvs , that is , the states which are almost uncontrollable and unobservable .    for unstable systems ,",
    "the integrals in  ( [ gramians_stable ] ) are unbounded and hence the gramians are ill - defined .",
    "a modified technique was proposed by  @xcite based on the following frequency - domain definitions of the gramians : @xmath13 by using parseval s theorem , it can be shown that for stable systems , the frequency - domain definitions  ( [ gram_freq ] ) are equivalent to the time - domain definitions  ( [ gramians_stable ] ) .",
    "the model - reduction procedure of  @xcite begins by first transforming the system  ( [ ss ] ) to coordinates in which the stable and unstable dynamics are decoupled .",
    "that is , let @xmath14  be a transformation such that if  @xmath15 , the system  ( [ ss ] ) transforms to @xmath16 here , @xmath17  and  @xmath18 are such that all their eigenvalues are in the right- and left - half complex planes respectively , while  @xmath19 and  @xmath20 are the corresponding states .",
    "next , denote the controllability and observability gramians corresponding to the set  @xmath21 describing the stable dynamics by @xmath22  and  @xmath23 respectively .",
    "similarly , denote the gramians corresponding to the set  @xmath24 by  @xmath25  and  @xmath26 .",
    "the gramians of the original system are then related to those corresponding to the subsystems by : @xmath27 a system is said to be balanced if its gramians defined by  ( [ gramians_general ] ) are equal and diagonal , in which case the diagonal entries are called the _",
    "generalized _ hankel singular values .",
    "a reduced - order model is obtained by truncating the states with small generalized hsvs .      for systems of large dimension  @xmath28 such as those encountered here , the gramians  ( [ gramians_general ] ) are huge matrices which can not be easily computed or stored .",
    "a computationally tractable procedure was introduced by  @xcite for obtaining an approximate balancing transformation .",
    "we first briefly describe this method , valid only for stable systems , and then present an extension to unstable systems .",
    "the procedure consists of computing the impulse responses of the system  ( [ ss ] ) and stacking the resulting snapshots of the state  @xmath10 as columns of a matrix  @xmath29 .",
    "it also requires state - snapshots of the impulse responses of the adjoint system @xmath30 which are stacked as columns of a matrix  @xmath31 .",
    "then , the gramians  ( [ gramians_stable ] ) can be approximated as @xmath32 the approximate gramians  ( [ gramians_approx ] ) are not actually computed due to the large storage cost , but the leading columns ( or modes ) of the transformation that balances these gramians are computed using a cost - efficient algorithm .",
    "it involves computing the singular value decomposition of @xmath33 where  @xmath34 is a diagonal matrix of the most significant hsvs greater than a cut - off which is a modeling parameter , while  @xmath35 is a diagonal matrix of smaller and zero hsvs .",
    "note that @xmath36 is a small matrix , where  @xmath37 and  @xmath38 are the number of snapshots of the impulse responses of systems  ( [ ss ] ) and  ( [ ss_adj ] ) respectively .",
    "for fluid systems that we are interested in , the typical number of snapshots is  @xmath39 , thus resulting in a reasonable computational cost , and typically  @xmath40 .",
    "the leading columns and rows of the balancing transformation and its inverse are obtained using : @xmath41 where  @xmath42 , and the two sets of modes are bi - orthogonal ; that is ,  @xmath43 .",
    "the reduced - order model of  ( [ ss ] ) is then obtained by expressing  @xmath44 , @xmath45 , and using the bi - orthogonality of  @xmath46  and  @xmath47 : @xmath48      when the number of outputs of the system ( rows of  @xmath49 ) is large , the algorithm described in section  [ sec : approx_baltrunc_stable ] can become intractable .",
    "the reason for this is that it involves one simulation of the adjoint system  ( [ ss_adj ] ) for each component of  @xmath50 , the dimension of which is the same as the number of outputs .",
    "this number is often large in fluids systems where a good model needs to capture the response of the entire system  ( @xmath51 ) to a given input . to overcome this problem ,",
    "@xcite proposed a technique called  _ output projection _ , which involves projecting the output  @xmath52 of  ( [ ss ] ) onto a small number of energetically important modes obtained using proper orthogonal decomposition  ( pod ) .",
    "let the columns of  @xmath53 consist of the first @xmath54  pod modes of the dataset consisting of outputs obtained from an impulse response of  ( [ ss ] ) .",
    "then , for the purpose of obtaining a reduced - order model , the output of  ( [ ss ] ) is approximated by @xmath55 where  @xmath56 is an orthogonal projection of the output onto the first @xmath54  pod modes .",
    "the resulting output - projected system is optimally close ( in the @xmath57sense ) to the original system , for an output of fixed rank  @xmath54 . with this approximation ,",
    "only  @xmath54 adjoint simulations are required to approximate the observability gramian ; refer to  @xcite for details .",
    "the number of pod modes  @xmath54 for output projection is a design parameter and is typically chosen to capture more than @xmath58 of the output energy . in the rest of this paper , the models resulting from this approximation of the output are referred to as _ @xmath59mode output projected models . _      the approximate balancing procedure described in the previous section , which is essentially a snapshot - based method , does not extend to unstable systems since the impulse responses of  ( [ ss ] ) and  ( [ ss_adj ] ) are unbounded .",
    "we could consider applying the algorithm to the two sub - systems given in  ( [ decouple_ss ] ) , but the transformation  @xmath14 that decouples  ( [ ss ] ) itself is not available .",
    "however , when the dimension of the unstable sub - system is small , we show that it is not necessary to compute the entire transformation  @xmath14 and it is still possible to obtain an approximate balancing transformation . here",
    ", we present an algorithm for computing such a transformation and also show that it essentially results in a method that is a slight variant of the technique of  @xcite presented in section  [ sec : unstable_baltrunc ] .",
    "the idea behind the algorithm is to project the original system  ( [ ss ] ) onto the stable subspace of  @xmath11 .",
    "then , one obtains a reduced - order model of the projected system using the snapshot - based procedure described in section  [ sec : approx_baltrunc_stable ] .",
    "the dynamics projected onto the unstable subspace can be treated exactly on account of its low dimensionality .",
    "we assume that the number of unstable eigenvalues  @xmath60 is  @xmath61 and can be computed numerically , say using the computational package arpack developed by  @xcite .",
    "we further assume that the bases for the right and the left unstable eigenspaces  @xmath62 can be computed .",
    "for the algorithm , we need the following projection operator onto the stable subspace of  @xmath11 : @xmath63 where  @xmath64 and  @xmath65 have been scaled such that  @xmath66 .",
    "we use the operator  @xmath67 to obtain the dynamics of  ( [ ss ] ) restricted to the stable subspace of  @xmath11 as follows : @xmath68 where  @xmath69 the adjoint of  ( [ ss_stable ] ) is the same as the dynamics of  ( [ ss_adj ] ) restricted to the stable subspace of  @xmath70 using  @xmath71 , and is given by @xmath72 where  @xmath73 .",
    "we compute the state - impulse responses of  ( [ ss_stable ] ) and  ( [ ss_adj_stable ] ) and stack the resulting snapshots  @xmath74 and  @xmath75 in matrices  @xmath76 and  @xmath77 respectively . as in  ( [ svd ] ) , we compute the singular valued decomposition of  @xmath78 and use the expressions  ( [ bal_transf ] ) to obtain the balancing modes  @xmath79 and the adjoint modes  @xmath80 , where again  @xmath81 .",
    "the reduced - order modes are obtained by expressing the state  @xmath10 as @xmath82 where  @xmath83 and  @xmath84 . substituting  ( [ modal_exp ] ) in  ( [ ss ] ) and pre - multiplying by  @xmath85 and  @xmath86",
    ", we obtain @xmath87 now , since  range@xmath88  span@xmath89 , we can write  @xmath90 for some  @xmath91 , and using the properties of eigenvectors , we have  @xmath92 .",
    "similarly , it can be shown that  @xmath93 .",
    "thus , the cross terms in  ( [ roma ] ) are zero and the reduced - order model is @xmath94 the procedure described so far to obtain the reduced - order model  ( [ rom ] ) is related to the procedure of  @xcite described in section  [ sec : unstable_baltrunc ] .",
    "it can be shown that the transformation that balances the gramians defined by  ( [ gramians_general ] ) results in a system in which the unstable and stable dynamics are decoupled .",
    "furthermore , the resulting stable dynamics are the same as those given by the equations describing the @xmath95-dynamics of  ( [ rom ] ) . that is , balancing the stable part of the gramians  @xmath96 and  @xmath97 defined in  ( [ gramians_general ] ) ( balancing  @xmath22 and  @xmath23 )  is the same as balancing the gramians of the stable subsystem  ( [ ss_stable ] )",
    "; a proof is outlined in appendix  [ sec : app : baltrunc ] . in our algorithm , the unstable dynamics are not balanced , while they are by  @xcite . a disadvantage of zhou s approach is that an unstable mode might be truncated resulting in a model which does not capture the instability , which is undesirable for control purposes .      for systems with a large number of outputs , the number of adjoint simulations  ( [ ss_adj_stable ] ) can become intractable ;",
    "however , the output projection of section  [ sec : outproj ] can readily be extended to unstable systems . instead of projecting the entire output  @xmath52 onto pod modes , we first express the state  @xmath98 , where  @xmath99 and  @xmath100 are projections on the unstable and stable subspaces of  @xmath11 respectively .",
    "we similarly express the output as  @xmath101 .",
    "we then project the component  @xmath102 onto a small number of pod modes , of the data set consisting of the outputs from an impulse response of  ( [ ss_stable ] ) .",
    "if the pod modes are represented as columns of the matrix  @xmath103 , the output of  ( [ ss ] ) is approximated by @xmath104 x = cx_u + \\theta_s \\theta_s^\\ast c x_s . \\label{yapprox_unstable}\\end{aligned}\\ ] ] finally , with the state  @xmath10 expressed by the modal expansion  ( [ modal_exp ] ) , the output of the reduced - order model  ( [ rom ] ) is given by @xmath105      the steps involved in obtaining reduced - order models of  ( [ ss ] ) , for the case where the output is the entire state  ( @xmath51 ) , can now be summarized as follows :    1 .",
    "[ primal_step ] project the original system  ( [ ss ] ) onto the subspace spanned by the stable eigenvectors of  @xmath11 in the direction of the unstable eigenvectors of  @xmath11 to obtain  ( [ ss_stable ] ) . compute the ( state ) response to an impulse on each input of  ( [ ss_stable ] ) and stack the snapshots in a matrix  @xmath76 .",
    "2 .   assemble the resulting snapshots , and compute the pod modes  @xmath106 of the resulting data - set .",
    "these pod modes are stacked as columns of  @xmath107 .",
    "3 .   choose the number of pod modes one wants to use to describe the output of  ( [ ss_stable ] ) .",
    "for instance , if @xmath108 error is acceptable , and the first  @xmath54  pod modes capture @xmath58 of the energy , then the output is the velocity field projected onto the first @xmath54  modes .",
    "thus , the output is represented as  @xmath109 .",
    "[ adjoint_step ] project the adjoint system  ( [ ss_adj ] ) onto the subspace spanned by the stable eigenvectors of  @xmath70 in the direction of the unstable eigenvectors of  @xmath70 to obtain  ( [ ss_adj_stable ] ) .",
    "compute the ( state ) response of  ( [ ss_adj_stable ] ) , starting with each pod mode  @xmath106 as the initial condition ( one simulation for each of the first @xmath54  modes ) . stack the snapshots in a matrix  @xmath77",
    "5 .   compute the singular value decomposition of  @xmath110 , where  @xmath111 , and  @xmath112 rank(@xmath113 ) .",
    "define balancing modes  @xmath114 and the corresponding adjoint modes  @xmath115 as columns of the matrices  @xmath79 and  @xmath80 , where @xmath116 7 .",
    "obtain the reduced - order model using  ( [ rom ] ) , which can be written as @xmath117 alternatively , the outputs can be considered to be simply the coefficients of the unstable modes  @xmath118 and the coefficients of the pod modes  @xmath107 of the stable subspace . with this choice , the output can be represented as @xmath119 finally , if the initial state  @xmath120 is known , the initial condition of  ( [ rom_compact ] ) can be obtained using @xmath121    in the remainder of this paper , we demonstrate the algorithm developed in this section by obtaining reduced order models of the 2-d uniform flow past a flat plate , and develop controllers based on these models to stabilize the unstable steady states that exist at high angles of attack .",
    "the numerical scheme used is a fast immersed boundary method developed by  @xcite , and is briefly described here .",
    "the method is then used to develop the linearized and adjoint formulations .",
    "consider the following form of the incompressible navier - stokes equations , based on the continuous analog of the immersed boundary formulation introduced by  @xcite : @xmath122 where  @xmath123 ,  @xmath124 and  @xmath125 are the appropriately non - dimensionalized fluid velocity , pressure and surface force respectively .",
    "the force  @xmath125  acts as a lagrange multiplier that imposes the no - slip boundary condition on the lagrangian points  @xmath126 , which arise from the discretization of a body moving with velocity  @xmath127 .",
    "we consider the body to be a stationary flat plate at an angle of attack  @xmath128 ; that is , here  @xmath129 .",
    "the reynolds number is defined as @xmath130 where @xmath131  is the free - stream velocity , @xmath132  is the chord - length and @xmath133  is the kinematic viscosity .",
    "equations  ( [ navier1]-[navier3 ] ) are discretized in space using a second - order finite - volume scheme on a staggered grid , and a discrete curl operation  @xmath134 is introduced to eliminate the pressure and obtain a semi - discrete formulation in terms of the circulation  @xmath135 : @xmath136 the incompressibility condition  ( [ navier2 ] ) is implicitly satisfied by an appropriate construction of  @xmath49 .",
    "the discrete laplacian is represented by  @xmath137 , using the identity  @xmath138 ; the constant @xmath139 , where @xmath140  is the uniform grid spacing . the operator  @xmath141 smears the dirac delta function of  ( [ navier1 ] ) over a few grid points .",
    "the nonlinear term  @xmath142 is the spatial discretization of  @xmath143 , where @xmath144  is the discrete velocity flux , in turn related to the discrete stream function  @xmath145 and circulation  @xmath135 as : @xmath146 a uniform grid and a choice of simple boundary conditions result in a _",
    "fast _ algorithm . with a uniform grid ,",
    "the discrete poisson equation  ( [ stream ] ) is solved by means of the efficient discrete sine transform .",
    "the boundary conditions specified are dirichlet and neumann for the velocity components normal and tangential to the domain boundaries , which for the flow past a flat plate imply a uniform - flow in the far - field .",
    "these boundary conditions are however valid for only a sufficiently large domain , and are imposed by employing a computationally efficient multi - domain approach .",
    "the domain is considered to be embedded in a series of domains , each twice - as - large as the preceding , with a uniform but a _ coarser _ grid having the same number of grid points .",
    "the poisson equation , with zero boundary conditions , is solved on the largest domain and the stream function is interpolated on the boundary of the smaller domain , which are in turn used to solve the poisson equation on the smaller domain . for the flow past a flat plate considered here ,",
    "the typical size of the largest domain is around 40  chord lengths in each direction .",
    "finally , the time - integration is performed using the implicit crank - nicolson scheme for the viscous terms and the second - order accurate , adams - bashforth scheme for the convective terms .      for deriving reduced - order models useful for control design , we first linearize equation  ( [ semidisc ] ) about a pre - computed steady state  ( @xmath147 ,  @xmath148 ) .",
    "the linearized equations are the same as equations  ( [ semidisc],[constraint ] ) with the nonlinear term  @xmath142 replaced by its linearization about the steady state , and is denoted by @xmath149 where the flux  @xmath144 is related to  @xmath135 by  ( [ stream ] ) . thus , the linearized equations are : @xmath150 the boundary conditions for the linearized equations are  @xmath151 on the outer boundary of the largest computational domain .    in order to derive the reduced - order models using the procedure described earlier , we need to perform adjoint simulations . in order to derive the adjoint equations , we define the following inner - product on the state - space : @xmath152 that is , the inner - product defined on the state - space is the standard @xmath153-inner product weighted with the inverse - laplacian operator . this choice is convenient as it results in the adjoint equations which differ from the linearized equations only in the nonlinear term .",
    "a derivation is outlined in appendix  [ sec : app : adjoint ] and the resulting equations are : @xmath154 where the variables  @xmath155 ,  @xmath126 and  @xmath156 are the duals of the discrete circulation  @xmath135 , stream function  @xmath145 and body force  @xmath157 , respectively , and  @xmath158 is the dual of flux  @xmath144 .",
    "the adjoint of the linearized nonlinear term is  @xmath159 , which can be shown to be a spatial discretization of  @xmath160 .",
    "since equation  ( [ adj1 ] ) differs from  ( [ linear ] ) only in the last term on the right hand side , the numerical integrator for the adjoint equations can be obtained by a small modification to the linearized equations solver .    the nature of the multi - domain scheme used to approximate the boundary conditions of the smallest computational domain , results in a multi - domain discrete laplacian which is not exactly self - adjoint to numerical precision . as a result ,",
    "the adjoint formulation given by  ( [ adj1],[adj2 ] ) which also uses the same multi - domain approach , is not precise and results in small , rather insignificant , errors in the computation of the reduced - order models .    .",
    "vorticity contours are plotted , with negative contours shown by dashed lines .",
    "the velocity - sensor locations are marked by solid circles.,height=192 ]",
    "we apply the model reduction techniques developed in the previous sections to the uniform flow past a flat plate in two spatial dimensions , at a low reynolds number , @xmath3 .",
    "we obtain reduced - order models of a system actuated by means of a localized body force near the leading edge of the flat plate ; the vorticity contours of the flow field obtained on an impulsive input to the actuator are shown in fig .",
    "[ fig : actuator_sensor ] . using these reduced - order models ,",
    "we develop feedback controllers that stabilize the unstable steady state at high angles of attack .",
    "we first assume full - state feedback , but use output projection described in section  [ sec : outproj ] to considerably decrease the number of outputs in order to make the model computation tractable .",
    "later , we relax the full - state feedback assumption , and develop a more practical observer - based controller which uses a few velocity measurements in the near - wake of the flat plate  ( shown in fig .  [ fig : actuator_sensor ] ) to reconstruct the entire flow .      the grid size used is @xmath161 , with the smallest computational domain given by  @xmath162\\times[-2.5,2.5]$ ] , where lengths are non - dimensionalized by the chord of the flat plate , with its center located at the origin .",
    "we use 5 domains in the multiple - grid scheme , resulting in an effective computational domain  @xmath163 times larger the size of the smallest domain ; thus the largest domain is given by  @xmath164\\times[-40,40]$ ] .",
    "the timestep used for all simulations is  @xmath165 .      since our approach is to obtain reduced - order models of the flow linearized about a given steady state ,",
    "we first need to compute these steady states .",
    "the model - reduction of unstable systems involves projecting the dynamics onto a stable subspace , for which we also need to compute the right and left eigenvectors of the linearized dynamics .",
    "this section concerns this steady - state analysis , using a `` timestepper - based '' approach as outlined in  @xcite and  @xcite .",
    "a simple way of computing stable steady states is by simply evolving the time - accurate simulation to stationarity .",
    "however , unstable steady states can not be found in this manner , and stable steady states near a bifurcation point could take very long to converge .",
    "instead , we use a timestepper - based approach which involves writing a computational wrapper around the original computational routine to compute the steady states using a newton iteration .",
    "if the numerical timestepper advances a circulation field  @xmath166 at a timestep  @xmath167 to a circulation field @xmath168 after @xmath14  timesteps , the steady state is given by the field  @xmath147 that satisfies @xmath169 the steady states are given by zeros of  @xmath170 , which could , in principle , be solved for using newton s method .",
    "however , the standard newton s method involves computing and inverting jacobian matrices at each iteration , which is computationally infeasible due to the large dimension of fluid systems . instead of computing the jacobian",
    ", we use a krylov - space based iterative solver called generalized minimal residual method  ( gmres ) developed by  @xcite to compute the newton update ( see  @xcite and  @xcite for a description of the method ) .",
    "this method requires computation of only jacobian - vector products  @xmath171 , which can be approximated using finite differences as  @xmath172/\\epsilon$ ] , for  @xmath173 .",
    "so , the jacobian - vector products can also be computed by invoking the appropriately - initialized timestepper .",
    "a nice feature of gmres is relatively fast convergence to the steady state when the eigenvalues of the jacobian  @xmath174 occur in clusters ; see @xcite and @xcite for details . for systems with multiple time - scales , such as navier - stokes ,",
    "most of the eigenvalues of the continuous jacobian lie in the far - left - half of the complex plane .",
    "thus , the corresponding eigenvalues of the discrete jacobian  @xmath175 , for a sufficiently large value of  @xmath14 , cluster near the origin .     and at  @xmath3 , showing a transition from a stable equilibrium to periodic vortex shedding at  @xmath176 . shown are the force coefficients corresponding to the stable  ( @xmath177 ) and unstable  ( @xmath178 ) steady states , and the maximum and minimum  ( @xmath179 ) , and the mean  ( @xmath180 ) values during periodic vortex shedding . also shown",
    "are the vorticity contours ( negative values in dashed lines ) of steady states at  @xmath181 and the flow fields corresponding to the maximum and minimum force coefficients at  @xmath182 .",
    ", title=\"fig:\",height=134 ]   and at  @xmath3 , showing a transition from a stable equilibrium to periodic vortex shedding at  @xmath176 . shown",
    "are the force coefficients corresponding to the stable  ( @xmath177 ) and unstable  ( @xmath178 ) steady states , and the maximum and minimum  ( @xmath179 ) , and the mean  ( @xmath180 ) values during periodic vortex shedding . also shown",
    "are the vorticity contours ( negative values in dashed lines ) of steady states at  @xmath181 and the flow fields corresponding to the maximum and minimum force coefficients at  @xmath182 .",
    ", title=\"fig:\",height=134 ]   and at  @xmath3 , showing a transition from a stable equilibrium to periodic vortex shedding at  @xmath176 . shown",
    "are the force coefficients corresponding to the stable  ( @xmath177 ) and unstable  ( @xmath178 ) steady states , and the maximum and minimum  ( @xmath179 ) , and the mean  ( @xmath180 ) values during periodic vortex shedding . also shown",
    "are the vorticity contours ( negative values in dashed lines ) of steady states at  @xmath181 and the flow fields corresponding to the maximum and minimum force coefficients at  @xmath182 .",
    ", title=\"fig:\",height=182 ]    \\(a ) ( b ) + .",
    "( b ) @xmath183 vs.  time , with the steady state as an initial condition.,title=\"fig:\",height=144 ] .",
    "( b ) @xmath183 vs.  time , with the steady state as an initial condition.,title=\"fig:\",height=144 ]    the procedure described above is used to compute the branch of steady states for the angles of attack  @xmath184 ; the parameter  @xmath14 in  ( [ newton ] ) is fixed to 50  timesteps .",
    "the lift and drag coefficients ,  @xmath183 and  @xmath185 , and their ratio  @xmath186 with changing  @xmath128 are plotted in fig .",
    "[ fig : bifurc ] . as with flow past bluff bodies with increasing reynolds number ( for example",
    ", see  @xcite ) , the flow undergoes a hopf bifurcation from a steady flow to periodic vortex shedding as the angle of attack  @xmath128 is increased beyond a critical value  @xmath187 , which in our computations is  @xmath188 .",
    "also plotted in the figure are the maximum , minimum , and mean values of the forces during shedding for  @xmath189 .",
    "we see that the ( unstable ) steady state values of the lift coefficient are smaller than the minimum for the periodic shedding till  @xmath190 , after which they are slightly higher , but still smaller than the mean lift for the periodic shedding .",
    "the ( unstable ) steady state drag is much lower than the minimum value for periodic shedding .",
    "the ratio  @xmath186 of the ( unstable ) steady state is close to the mean value for shedding .",
    "thus , if the large fluctuations in the forces are undesirable at high angles of attack , it would be useful to stabilize the unstable state .",
    "the steady state at  @xmath5 is shown in fig .",
    "[ fig : ss](a ) , and a time history of the lift coefficient",
    "@xmath183 with this steady state as an initial condition is shown in fig .  [ fig : ss](b ) .",
    "since the steady state is unstable , the numerical perturbations excite the instability , and the flow eventually transitions to periodic vortex shedding .",
    "+        we also compute a basis spanning the right and left unstable eigenspaces  ( @xmath64 and  @xmath65 ) of the flow linearized about the unstable steady states , which are required in our model reduction procedure , for restricting dynamics onto the stable subspace .",
    "as the flow undergoes a hopf bifurcation , a complex pair of eigenvalues crosses the imaginary axis from the left half of the complex plane ; thus the dimension of the unstable subspace is two . here",
    ", we obtain the basis spanning this subspace by a numerical implementation of the power method  ( see page  191 of  @xcite ) .",
    "we begin the linearized simulation with a very small random noise to excite the instability . after a sufficiently long time , the stable modes decay , and the dynamics lies close to the unstable subspace .",
    "any two independent snapshots of the remaining dynamics gives a good approximation of the basis spanning the unstable eigenspace .",
    "similarly , a basis spanning the left unstable eigenspace can be computed by initializing the adjoint equations with a small random noise . a basis spanning the right and left unstable eigenspaces of the flow linearized about the steady state at  @xmath5 is plotted in fig .",
    "[ fig : evec ] .",
    "these modes are qualitatively similar to the structures during periodic vortex shedding , but have different spatial wavelengths , as reported in earlier studies by @xcite and  @xcite .",
    "\\(a ) + , projected onto the stable subspace , and ( b , c ) the first- and fifth - most energetic pod modes of the impulse response , restricted to the stable subspace.,title=\"fig:\",height=124 ] + ( b ) ( c ) + , projected onto the stable subspace , and ( b , c ) the first- and fifth - most energetic pod modes of the impulse response , restricted to the stable subspace.,title=\"fig:\",height=124 ] , projected onto the stable subspace , and ( b , c ) the first- and fifth - most energetic pod modes of the impulse response , restricted to the stable subspace.,title=\"fig:\",height=124 ]      we now describe the process involved in deriving reduced - order models of the input - output response of  ( [ ss ] ) , which in this example are the linearized incompressible navier - stokes equations  ( [ linear ] , [ lin_constraint ] ) .",
    "the actuator used is a localized body force close to the leading edge of the flat plate , plotted in fig .",
    "[ fig : actuator_sensor ] .",
    "the models are derived using the procedure outlined in section  [ sec : approx_baltrunc_unstable ] . as seen in equation  ( [ rom ] ) , the output of the system is considered to be the entire velocity field , observed as a projection onto ( a ) the unstable eigenspace , and ( b ) the span of the leading pod modes of the impulse response restricted to the stable subspace .",
    "the first step in computing the reduced - order models is to project the flow field  @xmath191 onto the stable subspace of  ( [ linear ] , [ lin_constraint ] ) using the projection operator  @xmath67 defined in equation  ( [ proj_stable ] ) ; the unstable eigenvectors computed in section  [ sec : steady_states ] are used to define  @xmath67 numerically .",
    "the vorticity contours of the corresponding flow field  @xmath192 are plotted in fig .",
    "[ fig : actuator]a .",
    "the next step is to compute the impulse response of  ( [ ss_stable ] ) . instead , for practical reasons , we compute the impulse response of @xmath193 that is , at each timestep of integration",
    ", we project the state  @xmath74 onto the stable subspace of  @xmath11 .",
    "because the stable subspace is an invariant subspace for the linearized dynamics  ( [ linear ] ) , theoretically , the impulse responses of equations  ( [ ss_stable ] ) and  ( [ ss_stable_numerical ] ) are exactly the same , and they are the same as that obtained by restricting the impulse response of  ( [ ss ] ) to its stable subspace . however , due to the ( small )  numerical inaccuracy of the projection  @xmath67 ( which is a result of the numerical inaccuracy of the unstable eigenspaces  @xmath64 and  @xmath65 ) , the dynamics of  ( [ ss_stable ] ) is not strictly restricted to the stable subspace and , in the long term , grows without bound in the unstable direction .",
    "next , we compute the pod modes  @xmath194 of the impulse response of  ( @xmath195 ) , and consider the output of  ( [ ss_stable_numerical ] ) to be the state  @xmath74 projected onto a certain number of these pod modes . here , 200 snapshots spaced every 50  timesteps were used to compute the pod modes .",
    "the leading 4 and 10 pod modes contain  @xmath196 and  @xmath197 of the energy respectively and , as it has been observed in previous studies ( see @xcite and @xcite ) , these modes come in pairs in terms of their energy content , a characteristic of traveling structures ; the leading first and third pod modes are shown in fig .",
    "[ fig : actuator ] .",
    "+        the next step is to compute the adjoint snapshots , with the pod modes of the impulse response ( projected onto the stable subspace of the adjoint ) as the initial conditions . as the linearized impulse response",
    ", these simulations are also restricted to the stable subspace .",
    "again , instead of computing the response of  ( [ ss_adj_stable ] ) , we compute that of the following system : @xmath198 the snapshots of the impulse responses of systems  ( [ ss_stable_numerical ] ) and  ( [ ss_adj_stable_numerical ] ) are stacked as columns of  @xmath29 and  @xmath31 , and using the expressions  ( [ svd ] ) and  ( [ bal_transf ] ) , we obtain the balancing modes  @xmath199 and the adjoint modes  @xmath200 .",
    "we used 200  snapshots of the linearized simulation and 200 snapshots of each adjoint simulation , with the spacing between snapshots fixed to 50  timesteps , to compute the balancing transformation .",
    "these number of snapshots and the spacing were sufficient to accurately compute the modes ; further reduction in the spacing did not significantly change the singular values from the svd computation  ( [ svd ] ) .",
    "we considered the outputs to be a projection onto 4 , 10 and 20  pod modes ( corresponding to 4 , 10 and 20  mode _ output - projections _ , as introduced in section  [ sec : outproj ] ) .",
    "using these modes , we use the expressions in equation  ( [ rom_compact],[output_compact2 ] ) to obtain the matrices  @xmath201 defining the reduced - order model of the stable - subspace dynamics .",
    "the vorticity contours of the balancing and the adjoint modes , for a 10-mode output projected system , are plotted in  fig .",
    "[ fig : modes ] .",
    "the adjoint modes provide a direction for projecting the linearized equations onto the subspace spanned by the balancing modes .",
    "since these modes are quite different from the pod and the balancing modes , the resulting models are also quite different from those obtained using the standard pod - galerkin technique wherein an orthogonal projection is used . since the models obtained using balanced truncation are known to perform better than the pod - galerkin models , as reported by @xcite , the better performance could be attributed to a better choice of projection using the adjoint modes .    ) and the diagonal elements of the controllability  ( @xmath178 ,  @xmath202 ) and observability  ( @xmath203 ,  @xmath204 ) gramians of a 25-mode model with a 4 , 10 , and 20-mode output projection , for the unstable steady state at  @xmath205.,height=230 ]    since the reduced - order models of the stable - subspace dynamics are approximately balanced , the controllability and observability gramians of the @xmath95-dynamics of  ( [ rom_compact ] ) , given by expressions  ( [ gramians_stable ] ) , are approximately equal and diagonal .",
    "further , their diagonal values are approximately the same as the hankel singular values  @xmath206 obtained by the svd  ( [ svd ] ) .",
    "the diagonal values of the gramians and the singular values for different output projections are plotted in fig .",
    "[ fig : unstable_hsv ] for a 30-state reduced - order model . with",
    "increasing order of output projection , the hsvs converge to the case with full - state output , and the number of converged hsvs is roughly equal to the order of output projection , as was observed by  @xcite .",
    "we see that the diagonal elements of both the gramians are very close to the hsvs for the first 20 modes . for higher modes ,",
    "the observability gramians are inaccurate , which is due to a small inaccuracy of the adjoint formulation mentioned in section  [ sec : lin_adjoint ] . for controller design ,",
    "we use models of order  @xmath207 , for which these gramians are sufficiently accurate .    , @xmath202 )",
    "are compared with predictions of models with 4  ( @xmath203 , @xmath204 ) , 10  ( @xmath178 , @xmath208 ) , and 20  ( @xmath180 , @xmath209 )  modes.,title=\"fig:\",height=163 ] , @xmath202 ) are compared with predictions of models with 4  ( @xmath203 , @xmath204 ) , 10  ( @xmath178 , @xmath208 ) , and 20  ( @xmath180 , @xmath209 )  modes.,title=\"fig:\",height=163 ]    finally , to test the accuracy of the reduced - order models , we compare the impulse responses of system  ( [ ss_stable_numerical ] ) ( that is , restricted to the stable subspace ) with that of the model  ( [ rom_compact ] ) , restricting  @xmath210 .",
    "in particular , we compare the outputs of the two systems , which are the projection onto the pod modes ; a representative case in fig .",
    "[ fig : outputs_stable_oproj10 ] shows the results of 4 , 10 and 20 mode models of a system approximated using a 20-mode output projection ( the outputs are projection onto the leading 10  pod modes ) .",
    "the first output , which is a projection onto the first pod mode , is well captured by all the models until  @xmath211 , while the 20-mode model performs well for all time . also shown is the eleventh output , which is well captured only by the 20-mode model . as we will see later",
    ", it is important to capture the higher - order outputs for design of observers .    .",
    "the state is then multiplied by the gain  @xmath212 , computed based on the reduced - order model using lqr , to obtain the control input  @xmath123.,height=124 ]    .",
    "comparison of the outputs  @xmath213 and  @xmath214 of a 12-mode reduced - order model ( @xmath215 ) with the projection of data from the linearized simulation ( @xmath216).,title=\"fig:\",height=134 ] .",
    "comparison of the outputs  @xmath213 and  @xmath214 of a 12-mode reduced - order model ( @xmath215 ) with the projection of data from the linearized simulation ( @xmath216).,title=\"fig:\",height=134 ]      the resulting models can now be used along with standard linear control techniques to obtain stabilizing controllers .",
    "we use linear quadratic regulator  ( lqr ) to compute the gain  @xmath212 so that the eigenvalues of  @xmath217 ( where the matrices were defined in  ( [ rom_compact ] ) ) are in the left - half of the complex plane , and the input  @xmath218 minimizes the cost @xmath219 = \\int_0^\\infty \\ , ( a^\\ast q a + u^\\ast r u ) \\",
    ", dt ,   \\label{lqr_cost}\\end{aligned}\\ ] ] where  @xmath220 and  @xmath221 are positive weights computed as follows .",
    "we choose  @xmath220 such that the first term in the integrand of  ( [ lqr_cost ] ) represents the energy , that is , we use  @xmath222 , with  @xmath223 defined in  ( [ output_compact ] ) .",
    "the weight  @xmath221 is chosen to be a multiple of the identity  @xmath224 , and typically  @xmath132 is chosen to be a large number  @xmath225 , to avoid excessively aggressive controllers .",
    "the control implementation steps are sketched in fig .",
    "[ fig : cartoon_fullstate_control ] ; first compute the reduced - order state  @xmath226 , using the expression  ( [ init_model ] ) , then the control input is given by  @xmath227 . here",
    ", we derive the gain  @xmath212 based on a 12-mode reduced - order model ( with 2 unstable and 10 stable modes ) , using  @xmath228 , and include the same in the original linearized and nonlinear simulations .",
    "the output is approximated using a 4-mode output projection .",
    "the difference between the linear and nonlinear simulations is that , in the latter , the steady state field  @xmath120 is subtracted from the state  @xmath10 , before projecting onto the modes to compute the reduced - order state  @xmath226 .",
    "[ fig : contlin ] compares the model predictions with the projection of data from the simulations of the linearized system  ( [ linear ] , [ lin_constraint ] ) , with a control input .",
    "the initial condition used is the flow field obtained from an impulsive input to the actuator .",
    "both the states shown in the figure eventually decay to zero , which implies that the perturbations decay to zero , thus stabilizing the unstable steady state .",
    "more importantly , the model predicts the outputs accurately for the time horizon shown in the plots .     vs. time  @xmath229 , for full - state feedback control , with control turned on at different times in the base uncontrolled simulation .",
    "the base case with no control ( @xmath178 ) has the unstable steady state as the initial condition , and transitions to periodic vortex shedding .",
    "the control is tested for different initial conditions , corresponding to  @xmath230 of the base case , and stabilizes the steady state in all the cases ( @xmath177).,title=\"fig:\",width=432 ]    we now use the same controller in the full nonlinear simulations and test the performance of the model for various perturbations of the steady state . a plot of the lift coefficient  @xmath183 vs.  time  @xmath229 , with the control turned on at different times of the base simulation , is shown in fig .",
    "[ fig : cont_fullfback_lift ] .",
    "the initial condition for the base case ( no control ) is the unstable steady state ; eventually , small numerical errors excite the unstable modes and the flow transitions to periodic vortex shedding . in separate simulations ,",
    "control is turned on at times  @xmath231 corresponding to the base case . as the figure shows , the control is effective and is able to stabilize the steady state in each case , even when the flow exhibits strong vortex shedding .",
    "we remark that the latter two of these perturbations are large enough to be outside the range of validity of the linearized system , but the control is still effective , implying a large basin of attraction of the stabilized steady state .",
    "we also compare the output of the reduced - order model with the outputs of the nonlinear simulation ; the plots are shown in fig .",
    "[ fig : outputs_control_oproj4 ] .",
    "the models perform well for the initial transients , but for longer times fail to capture the actual dynamics .",
    "this is not surprising as these perturbations are outside the range of validity of the linear models . for control purposes",
    ", it appears to be sufficient to capture the initial transients ( approximately one period ) , during which the instability is suppressed to a great extent .",
    "we remark that one could possibly compute nonlinear models by projecting the full nonlinear equations onto the balancing modes , or enhance the model subspace by adding pod modes of vortex shedding and the shift modes as proposed by  @xcite to account for the nonlinear terms .     of the uncontrolled case plotted in fig .",
    "[ fig : cont_fullfback_lift ] .",
    "comparison of the outputs  @xmath213 and  @xmath232 of a 12-mode ( 2  unstable and 10  stable modes ) reduced - order model ( @xmath215 ) with the projection of data from the full nonlinear simulation ( @xmath216).,title=\"fig:\",height=134 ]   of the uncontrolled case plotted in fig .",
    "[ fig : cont_fullfback_lift ] .",
    "comparison of the outputs  @xmath213 and  @xmath232 of a 12-mode ( 2  unstable and 10  stable modes ) reduced - order model ( @xmath215 ) with the projection of data from the full nonlinear simulation ( @xmath216).,title=\"fig:\",height=134 ]    finally , we note that the reduced - order model  ( [ rom_compact ] ) decouples the dynamics on the stable and unstable subspaces , and also , the dynamics on the unstable subspace can be computed only using the unstable eigen - bases  @xmath64 and  @xmath65 .",
    "thus , we could derive a control gain  @xmath233 , based only on the two - dimensional unstable part of the model , such that the eigenvalues of  @xmath234 are in the left half complex plane .",
    "that is , we can obtain a stabilizing controller _ without _ modeling the stable subspace dynamics .",
    "we have performed simulations to test such a controller and found that it also is capable of suppressing the periodic vortex shedding and thus results in a large basin of attraction for the stabilized steady state .",
    "the choice of weight matrices  @xmath220 and  @xmath221 in the lqr cost  ( [ lqr_cost ] ) needs to be different to obtain a comparable performance .",
    "however , as shown in the next section , it is essential to model the stable subspace dynamics to design a practical controller based on an observer that reconstructs the entire flow field using a few sensor measurements .",
    "the full - state feedback control of section  [ sec : fullstatefb ] is not practical since it is not possible to measure the entire flow field . here",
    ", we consider a more practical approach of measuring certain flow quantities at a small number of sensor locations .",
    "we assume that we can measure the velocities at the sensors shown in fig .",
    "[ fig : actuator_sensor ] , in the near - wake of the plate .",
    "we remark that , even though these sensors are not experimentally realizable , they serve as a good testing ground for our models .     and the sensor measurements  @xmath52 are used as inputs to the observer , which reconstructs the reduced - order state  @xmath235 .",
    "this state is then multiplied by the gain  @xmath212 , to obtain the control input  @xmath123 .",
    "both , the controller and observer gains  @xmath212 and  @xmath236 are computed based on the reduced - order model using lqr and lqg respectively.,height=144 ]      using the reduced - order models derived as outlined in section  [ sec : models ] , we design observers that dynamically estimate the entire flow field . since the models  ( [ rom_compact ] ) have a different output ( projection onto certain modes )",
    ", we modify the output equation so that it appropriately represents the sensor measurements . we replace the output equation of  ( [ rom_compact ] ) with @xmath237 where  @xmath238 and  @xmath145 is the number of sensor measurements .",
    "the matrix  @xmath113  is sparse and extracts the values of the output of  ( [ rom_compact ] ) at the sensor locations ; thus , each row of  @xmath113 is filled with 0s except for the entry corresponding to a sensor measurement , which is  1 . with the output equation  ( [ observer_output ] ) , we design an observer using a linear quadratic gaussian ( lqg ) estimation .",
    "this method assumes that the errors in representing the state  @xmath226 and and the measurement  @xmath52 ( due to the inaccuracies of the model ) are stochastic gaussian processes , and results in an estimate  @xmath235 of the state  @xmath226 that is optimal in the sense that it minimizes the mean of the squared error ; refer to  @xcite for details .",
    "we now discuss briefly our procedure for modeling these noises ; consider the reduced - order model  ( [ rom_compact ] ) , but with process noise  @xmath239 and sensor noise  @xmath50 which enter the dynamics as follows : @xmath240 a key source of the process ( state ) noise  @xmath239 arises from model truncation , and second , from ignoring the nonlinear terms in the reduced - order model .",
    "the nonlinearity of the dynamics is important , for instance , when the model is used to suppress vortex shedding .",
    "a source of the sensor noise arises from two sources ; first , the state  @xmath10 is approximated as a sum of a finite number of modes  ( [ modal_exp ] ) , and second , in the output projection step , the output is considered as a projection of the ( approximated ) state  @xmath10 onto a finite number of pod modes  ( [ yrom_unstable_outproj ] ) . here ,",
    "we approximate these two noises as gaussian processes whose variances are @xmath241 and  @xmath242 gives the expected value . here ,  @xmath243 is the operator obtained by projecting the nonlinear navier - stokes equations  ( [ navier1 ] ) onto the balancing modes  @xmath46 , using the adjoint modes  @xmath47 .",
    "the state  @xmath244 is obtained by projecting the snapshots , obtained from a representative simulation of the full nonlinear system , onto the balancing modes .",
    "the representative simulation we used here is the base case , with no control , shown in fig .",
    "[ fig : cont_fullfback_lift ] , which includes the transient evolution from the steady state to periodic vortex shedding .",
    "the resulting estimator is of the form : @xmath245 where  @xmath235 is the estimate of state  @xmath226 , @xmath246 is the estimated output , and  @xmath236  is the observer gain .",
    "the estimator is then used along with the full - state feedback controller designed in section  [ sec : fullstatefb ] to determine the control input ; a schematic is shown in fig .",
    "[ fig : cartoon_obsv_control ] .    norm ) obtained from an impulse response  ( @xmath177 ,  @xmath202 ) of  ( [ ss_stable_numerical ] ) , and the energy captured by 4  ( @xmath178 , @xmath204 ) , 10  ( @xmath179 , @xmath208 ) , and 20  ( @xmath180 ,  @xmath247 ) leading pod modes.,height=192 ]    ,  @xmath202 ) , of an impulse response of  ( [ ss_stable_numerical ] ) , compared with the reconstruction using 10  ( @xmath179 ,  @xmath208 ) and 20  ( @xmath178 ,  @xmath204 ) leading pod modes.,height=259 ]    since the observability gramian corresponding to the pair  @xmath248 is different from that for the pair  @xmath249 , the model  ( [ rom_compact ] ) with the output represented by  ( [ observer_output ] ) , is not balanced . in principle , it is possible to construct reduced - order models of a system with the sensor measurements as the outputs , using the procedure of section  [ sec : approx_baltrunc_unstable ] . since the number of outputs will be typically small , the output projection step would not be required for such models . however ,",
    "if this were done , the cost function  ( [ lqr_cost ] ) , based on total kinetic energy in the perturbation , would not be captured well by the model and the model would not be as effective for control design .",
    "vs. time  @xmath229 , for estimator - based feedback control , with control turned on at different times in the base uncontrolled simulation .",
    "the base case  ( @xmath178 ) is the same as in fig .",
    "[ fig : cont_fullfback_lift ] , and the control is tested for different initial conditions , corresponding to  @xmath230 of the base case  ( @xmath177 ) . in both the cases , the controller stabilizes the flow to a small neighborhood of the steady state.,title=\"fig:\",width=432 ]    ,  @xmath204 ) by a 22-mode observer quickly converge to the actual states  ( @xmath177 ,  @xmath202 ) .",
    "the initial conditions used are those corresponding to  @xmath250  ( top and bottom ) of the uncontrolled case shown in fig .",
    "[ fig : cont_obsvfback_lift].,title=\"fig:\",height=134 ] ,  @xmath204 ) by a 22-mode observer quickly converge to the actual states  ( @xmath177 ,  @xmath202 ) .",
    "the initial conditions used are those corresponding to  @xmath250  ( top and bottom ) of the uncontrolled case shown in fig .",
    "[ fig : cont_obsvfback_lift].,title=\"fig:\",height=134 ] + ,  @xmath204 ) by a 22-mode observer quickly converge to the actual states  ( @xmath177 ,  @xmath202 ) .",
    "the initial conditions used are those corresponding to  @xmath250  ( top and bottom ) of the uncontrolled case shown in fig .",
    "[ fig : cont_obsvfback_lift].,title=\"fig:\",height=134 ] ,  @xmath204 ) by a 22-mode observer quickly converge to the actual states  ( @xmath177 ,  @xmath202 ) .",
    "the initial conditions used are those corresponding to  @xmath250  ( top and bottom ) of the uncontrolled case shown in fig .",
    "[ fig : cont_obsvfback_lift].,title=\"fig:\",height=134 ]    the models used in section  [ sec : fullstatefb ] for full - state feedback were those of a system whose stable - subspace output was the velocity field projected onto the leading 4  pod modes .",
    "these 4  pod modes capture only about  @xmath251 of the energy , but the resulting models were effective in suppressing vortex shedding .",
    "however , for observer design , this representation of the output is inadequate , as the energy content of the flow at the sensor locations is very small , while the pod modes capture the energetically dominant modes .",
    "hence , a greater number of pod modes is required to accurately represent the velocity at the sensor locations .",
    "the temporal evolution of the energy content of the flow , obtained from an impulse response of the system restricted to evolve on the stable subspace , is plotted in figure  [ fig : l2norm ] .",
    "also plotted is the energy content of the same flow , but projected onto the leading 4 , 10  and 20  pod modes ; thus , a 4-mode projection leads to noticeable errors , while both 10-  and  20-mode projections accurately represent the energy .",
    "the velocity field at the sensor locations , reconstructed by 10  and 20  pod modes , plotted in figure  [ fig : sensor_reconst ] , shows that a 10-mode projection does not accurately represent the velocities at the sensor locations . since 20 pod modes are sufficient to represent these velocities ,",
    "we derive models using a _ 20-mode output projection _ , and use the same for observer design .",
    "the models obtained using the modified output  ( [ observer_output ] ) are used to design dynamic observers based on the vertical  ( @xmath50- ) velocity measurements at the sensor locations .",
    "a 22-mode reduced - order model , with 2  and 20  modes describing the dynamics on the unstable and stable subspaces respectively , is used to design a kalman filter for producing an optimal estimate of the velocity field based on gaussian approximations of error terms  ( [ process_noise_model ] , [ sensor_noise_model ] ) .",
    "this estimate is then used along with reduced - order model controller to determine the control input , as shown in fig .",
    "[ fig : cartoon_obsv_control ] . the results of this observer - based controller ( or compensator )",
    "are shown in figs .",
    "[ fig : cont_obsvfback_lift ] ,  [ fig : states_obsvcontrol_oproj20 ] .",
    "the compensator again stabilizes the unstable operating point , and furthermore , the observer reconstructs the reduced - order model states accurately .",
    "initially , the observer has no information about the states ( the initial condition is zero ) , but it quickly converges to and follows the actual states .",
    "there is a key difference from the full - state feedback control , that the compensator does not exactly stabilize the unstable operating point but converges to its small neighborhood .",
    "the reason is that the observer design is based on the velocities at the sensor locations projected onto the leading 20  pod modes , rather than the exact velocities at these locations .",
    "these small errors enter into the observer s dynamics in the same way that sensor noise enters , resulting in small errors in the state estimate .",
    "we presented an algorithm for developing reduced - order models of the input - output dynamics of high - dimensional linear unstable systems , extending the approximate balanced truncation method developed by  @xcite for stable systems .",
    "we assumed that the dimension of the unstable eigenspace is small and the corresponding global eigenmodes can be numerically computed .",
    "the modeling procedure treats the dynamics on the unstable subspace exactly and obtains a reduced - order model of the dynamics on the stable subspace .    in a proof - of - concept study ,",
    "the procedure was applied to control the 2-d  low - reynolds - number flow past a flat plate at a large angle of attack  @xmath128 , where the natural flow state is periodic vortex shedding .",
    "we first performed a continuation study at  @xmath3 and computed the branch of steady states with  @xmath128 varying from  @xmath252 to  @xmath2 ; we show that the flow undergoes a hopf bifurcation from steady state to periodic shedding at  @xmath253 .",
    "we developed reduced - order models of the linearized dynamics at  @xmath5 actuated by a localized body force close to the leading edge of the plate .",
    "the outputs were considered to be the entire flow field , projected onto the unstable eigenmodes and the leading pod modes of the impulse response simulation ( restricted to the stable subspace ) .",
    "we developed stabilizing controllers based on the reduced - order models to stabilize the unstable steady state and showed that the models agreed well with the actual simulations .",
    "we also included the controllers in the full nonlinear simulations , and showed that they had a large - enough basin of attraction to even suppress the vortex shedding .",
    "for such large perturbations , however , the model agreement with the full simulation was good only for short times .",
    "a natural step towards improving these models would be to project the full nonlinear equations onto the balancing modes to obtain nonlinear models .",
    "alternately , the balanced models , which accurately capture the transient dynamics , could be combined with the pod - based models using shift - modes of  @xcite which accurately capture vortex shedding and some of the transient dynamics .",
    "an interesting future direction is development of algorithms to compute _ nonlinear _ balanced models , for instance based on the theoretical work of  @xcite .    instead of computing nonlinear models , here we pursued a step towards more practical controllers by considering an observer - based control design , in which the outputs were modified to be just two near - wake velocity measurements .",
    "the nonlinear terms in the equations , which our models do not capture , were treated as process noise , and the error in modeling the outputs was treated as sensor noise .",
    "we designed a 22-mode reduced - order observer which reconstructed the flow field accurately , and along with the controllers , suppressed vortex shedding and stabilized the flow in a small neighborhood of the unstable steady state .",
    "we remark that the actuator and sensors considered here are not practically realizable , but the methodology presented here can be extended to a more practical actuation such as blowing and suction through the plate and measurements using surface pressure sensors .",
    "furthermore , the choice of sensor locations in this study was ad hoc , and an interesting problem is of finding the optimal sensor locations , for a given actuator .",
    "the controllers present here are designed to operate at a fixed set of parameters  ( such as  @xmath254 and  @xmath128 ) , and it would be interesting to test their performance at off - design parameter values ; the study on the performance of models of the linearized channel flow at off - design  @xmath254 by  @xcite shows promise in that direction .    a motivation for the choice of our model problem was to develop tools towards manipulating wakes of micro - air vehicles .",
    "recently ,  @xcite performed a numerical study of flow past low - aspect - ratio plates , and a future direction we intend to undertake is to perform a detailed continuation study of the same flow to explore the existence and stabilization of high - lift unstable steady states in this 3-d flow .",
    "the authors would like to thank tim colonius and kunihiko taira for their tremendous help in adopting their immersed boundary solver .",
    "the authors would also like to thank ioannis g. kevrekidis , sung joon moon and liang qiao for their help with the timestepper - based steady - state analysis .",
    "this work was funded by the u.  s. air force office of scientific research grant fa9550 - 05 - 1 - 0369 and this support is gratefully acknowledged .",
    "without loss of generality , a transformation  @xmath14 ( and its inverse ) that decouples the stable and unstable dynamics of  ( [ ss ] ) can be written as : @xmath255 where the columns of  @xmath256 and  @xmath257 span the unstable and stable _ right _ eigenspaces of  @xmath11 , while the columns of  @xmath258 and  @xmath259 span the unstable and stable _ left _ eigenspaces of  @xmath11 .",
    "further , these matrices are scaled such that  @xmath260 and  @xmath261 .",
    "the transformation  ( [ transf ] ) decouples the dynamics of  ( [ ss ] ) as given in  ( [ decouple_ss ] ) with the various matrices defined as follows : @xmath262 using  ( [ transf ] ) in  ( [ gramians_general ] ) , the gramians of the original system  ( [ ss ] ) are @xmath263 where , @xmath22 and  @xmath23 are the gramians corresponding to the system defined by  @xmath21 , while @xmath25 and  @xmath26 are the gramians corresponding to the system defined by  @xmath24 .",
    "let  @xmath264 be the transformation that balances the gramians  @xmath25 and  @xmath26 , while  @xmath265 be the transformation that balances  @xmath22 and  @xmath23 .",
    "then , it can be verified that the transformation that balances the gramians  @xmath96 and  @xmath97 is given by @xmath266 thus , the balancing transformation consists of two parts  @xmath64 and  @xmath79 which respectively balance the dynamics on the unstable and stable subspaces of  @xmath11 . as per the technique of  @xcite , a reduced - order model can be obtained by truncating the columns of  @xmath46 that correspond to the relatively uncontrollable and unobservable states .",
    "as we will show now , the algorithm outlined in section  [ sec : approx_baltrunc_unstable ] essentially computes the leading columns of  @xmath79 ( and the corresponding rows of its inverse ) . we show that the controllability gramian of the stable dynamics of  ( [ ss ] ) , which are defined by  ( [ ss_stable ] ) , is the same as the `` stable '' part of the gramian defined in  ( [ gramians_general_expand ] ) .",
    "note that using  ( [ transf ] ) and the definition  ( [ proj_stable ] ) , the projection operator  @xmath67 can be written as @xmath267 using the definition  ( [ gramians_stable ] ) , the controllability gramian of  ( [ ss_stable ] ) is @xmath268 which is the same as the stable part of  @xmath96 .",
    "similarly , it can be shown that the observability gramian  @xmath269 of  ( [ ss_stable ] ) is the same as the `` stable '' part of the observability gramian  @xmath97 : @xmath270 thus , balancing the gramians  @xmath269 and  @xmath271 is identical to balancing the parts of the gramians  @xmath96 and  @xmath97 of the original system  ( [ ss ] ) that are related to the dynamics on the stable subspace of  @xmath11 .",
    "in this appendix , we derive the adjoint of the linearized semi - discrete equations  ( [ linear],[lin_constraint ] ) .",
    "let  @xmath272 be the weighting functions corresponding to  @xmath273 . then , using the inner product defined in equation  ( [ ip ] ) , the weak form of  ( [ linear],[lin_constraint ] ) is : @xmath274 integrating by parts with respect to  @xmath229 and rearranging terms , @xmath275 for linearization about stable steady states ,  @xmath276 , as  @xmath277 , and if the adjoint equations are integrated backwards in time , @xmath278 .",
    "so , the last term on the left hand side of equation  ( [ weak2 ] ) vanishes identically .",
    "if equation  ( [ weak2 ] ) is to hold for all values of  @xmath135 and  @xmath157 , we get the following adjoint equations hold : @xmath279 where  @xmath280 and @xmath158 can be thought of as the weighting functions corresponding to the streamfunction  @xmath145 and the flux  @xmath144 respectively .",
    "now , equations  ( [ adjoint1],[adjoint2 ] ) have the same form as  ( [ linear],[lin_constraint ] ) except for the nonlinear term .",
    "thus , the same time - integration scheme can be used for both , with the appropriate ( linearized ) nonlinear terms ."
  ],
  "abstract_text": [
    "<S> we present an estimator - based control design procedure for flow control , using reduced - order models of the governing equations , linearized about a possibly unstable steady state . </S>",
    "<S> the reduced - order models are obtained using an approximate balanced truncation method that retains the most controllable and observable modes of the system . </S>",
    "<S> the original method is valid only for stable linear systems , and in this paper , we present an extension to unstable linear systems . </S>",
    "<S> the dynamics on the unstable subspace are represented by projecting the original equations onto the global unstable eigenmodes , assumed to be small in number . </S>",
    "<S> a snapshot - based algorithm is developed , using approximate balanced truncation , for obtaining a reduced - order model of the dynamics on the stable subspace .    </S>",
    "<S> the proposed algorithm is used to study feedback control of two - dimensional flow over a flat plate at a low reynolds number and at large angles of attack , where the natural flow is vortex shedding , though there also exists an unstable steady state . for control design </S>",
    "<S> , we derive reduced - order models valid in the neighborhood of this unstable steady state . </S>",
    "<S> the actuation is modeled as a localized body force near the leading edge of the flat plate , and the sensors are two velocity measurements in the near - wake of the plate . </S>",
    "<S> a reduced - order kalman filter is developed based on these models and is shown to accurately reconstruct the flow field from the sensor measurements , and the resulting estimator - based control is shown to stabilize the unstable steady state . for small perturbations of the steady state , the model accurately predicts the response of the full simulation . </S>",
    "<S> furthermore , the resulting controller is even able to suppress the stable periodic vortex shedding , where the nonlinear effects are strong , thus implying a large domain of attraction of the stabilized steady state . </S>"
  ]
}