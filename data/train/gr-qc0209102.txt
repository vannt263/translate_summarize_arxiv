{
  "article_text": [
    "with the availability of unprecedented observational data , the physics of compact object is entering a particularly exciting phase .",
    "new instruments , including x - ray and @xmath0-ray satellites and neutrino observatories , are detecting signals from highly relativistic events in regions of strong gravitational fields around neutron stars and black holes . a new generation of gravitational wave interferometers is promising to open a completely new window for the observation of compact objects .",
    "the ground - based gravity wave observatories ligo and tama are already operational and are collecting data , geo and virgo will be completed soon , and a space - based interferometer lisa is currently under design .    given the small signal - to - noise ratio in these new gravitational wave detectors , theoretical models of likely sources are needed for the positive identification of the signal as well as for its physical interpretation @xcite .",
    "one promising technique for the identification of signals in the noise output of the detector is matched filtering , which requires accurate theoretical gravitational wave templates @xcite .",
    "the need for such templates has driven a surge of interest in developing reliable techniques capable of their construction .",
    "compact binaries , i.e.  binaries consisting of either black holes or neutron stars , are among the most promising sources of gravitational radiation .",
    "much progress has been made in refining post - newtonian point - mass approximations .",
    "these are suitable for large binary separations for which relativistic effects are sufficiently small and any internal structure can be neglected  @xcite . at small binary separations ,",
    "the most promising technique for modeling the inspiral , coalescence and merger is numerical relativity .",
    "several other observed phenomena involving compact objects require numerical relativity for their modeling .",
    "one such example is gamma ray bursts ( grbs ) . while it is not yet known what the origin of grbs is , the central source is almost certainly a compact object  @xcite .",
    "most scenarios involve a rotating black hole surrounded by a massive magnetized disk , formed by a supernova , or the coalescence of binary neutron stars @xcite . to confirm or refute any grb scenario requires numerical studies in full 3 + 1 relativistic magnetohydrodynamics .",
    "another astrophysical scenario requiring numerical treatment is the formation of supermassive black holes ( smbhs ) . among the scenarios proposed to explain smbh formation are the collapse of a relativistic cluster of collisionless matter , like a relativistic star cluster @xcite or self - interacting dark matter halo @xcite , or the collapse of a supermassive star  @xcite .",
    "depending on the details of the collapse , smbh formation may generate a strong gravitational wave signal in the frequency band of the proposed space - based laser interferometer lisa .",
    "understanding the smbh formation route may shed key insight into structure and galaxy formation in the early universe .",
    "solving the coupled einstein field and hydrodynamics equations is a challenging computational task , requiring the simultaneous solution of a large number of coupled nonlinear partial differential equations .",
    "in addition to all of the usual problems of numerical hydrodynamics  handling advection , shock discontinuities , etc  one encounters the problems inherent to numerical relativity .",
    "the latter include identifying a suitable formulation of einstein s field equations , enforcing a well - behaved coordinate system , and , if black holes are formed , dealing with spacetime singularities .",
    "the construction of self - consistent numerical solutions to the coupled equations of relativistic hydrodynamics and gravitation dates back to the pioneering work of may and white in spherical symmetry @xcite ( see also @xcite for a review ) . in one of the first attempts to perform numerical integrations in three spatial dimensions , wilson , mathews , and marronetti  @xcite ( see @xcite for later corrections ) tackled the binary neutron star problem .",
    "they simplified einstein s field equations by assuming that the spatial metric remains conformally flat at all times .",
    "their implementation of relativistic hydrodynamics was based on earlier work by wilson @xcite and used upwind differencing to handle advection and artificial viscosity to capture shocks .",
    "the first fully self - consistent relativistic hydrodynamics code , which treats the gravitational fields without approximation , was developed by shibata @xcite .",
    "this code , based on earlier work by shibata and nakamura  @xcite , adopts a van leer hydrodynamics scheme  @xcite and also employs artificial viscosity for shocks .",
    "this code has been used in various astrophysical applications , including the coalescence and merger of binary neutron stars @xcite and the stability of single , rotating neutron stars @xcite . in an alternative approach ,",
    "font _ et al _",
    "@xcite implemented a more accurate high - resolution shock - capturing technique to solve the equations of relativistic hydrodynamics .",
    "this code has been used to study pulsations of relativistic stars @xcite .    in this paper",
    ", we report on the status and some astrophysical applications of our new 3 + 1 general relativistic hydrodynamics code .",
    "our code , based on the so - called baumgarte - shapiro - shibata - nakamura ( bssn ) formulation of einstein s equations @xcite , has several novel features , including an algorithm that does not require the addition of a tenuous , pervasive atmosphere that is commonly used in eulerian hydrodynamical codes , both newtonian and relativistic .",
    "this `` no atmosphere '' algorithm proves to be very robust and eliminates many problems associated with the traditional atmospheric approach @xcite .",
    "we treat 1d shocks , spherical dust collapse to black holes , and relativistic spherical equilibrium stars to demonstrate the ability of our code to accurately evolve the coupled field and hydrodynamic equations in relativistic scenarios .",
    "we then use the evolution of stable and unstable uniformly rotating polytropes as a testbed to determine which gauge conditions are best - behaved in the presence of strong - field matter sources with significant angular momentum .",
    "we introduce rotating coordinate systems and show that these can yield more accurate simulations of rotating objects than inertial frames .",
    "we demonstrate the ability of our code to hold accurately stable differentially rotating stars in equilibrium .",
    "we also show that our code can follow the collapse of rapidly differentially rotating stars reliably until an apparent horizon appears , by which time the equatorial radius has decreased from its initial value by more than a factor of ten .",
    "we then turn to simulations of binary neutron stars .",
    "we adopt initial data describing corotating @xmath1 polytropes in quasi - equilibrium circular orbit , and evolve these data for over two orbital periods . in this paper we present results for one particular binary and discuss the effect of corotating frames as well as the outer boundaries . an extended study , including binary sequences up to the dynamically identified innermost stable circular orbit ( isco ) ,",
    "will be presented in a forthcoming paper @xcite .",
    "this paper is organized as follows .",
    "[ fields ] and [ hydro ] describe our method of evolving the field and hydrodynamic equations , respectively .",
    "[ gauge_choices ] summarizes the various gauge choices with which we experiment .",
    "[ diag ] lists the diagnostics used to gauge the reliability of our simulations .",
    "[ tests ] describes several tests of our algorithm .",
    "[ iso_stars ] applies our formalism to evolve non - rotating , uniformly rotating , and differentially rotating polytropes . in sec .",
    "[ bin ] sketches our binary neutron star calculations .",
    "our results are summarized in sec .",
    "[ summary ] .",
    "some details of our hydrodynamic scheme and the rotating frame formalism are presented in the appendices .",
    "we write the metric in the form @xmath2 where @xmath3 , @xmath4 , and @xmath5 are the lapse , shift , and spatial metric , respectively . the extrinsic curvature @xmath6 is defined by @xmath7 where @xmath8 is the lie derivative with respect to @xmath4 .",
    "we choose geometrized units with @xmath9 throughout , so einstein s field equations are @xmath10 we use greek letters to denote spacetime indices , and latin letters for spatial indices . using the above variables , the field equations ( [ einstein ] ) split into the usual 3 + 1 adm equations @xcite . these consist of the hamiltonian constraint @xmath11 the momentum constraint @xmath12 and the evolution equation for @xmath6 @xmath13 in addition to ( [ kij ] ) . here",
    "@xmath14 , @xmath15 and @xmath16 are the covariant derivative operator , the three - dimensional ricci tensor and the scalar curvature associated with @xmath5 .",
    "the matter source terms @xmath17 , @xmath18 , and @xmath19 are projections of the stress - energy tensor with respect to the unit normal @xmath20 on the time slice @xmath21 since numerical implementations of the adm equations typically develop instabilities after very short times , we use a reformulation of these equations that is now often referred to as the bssn formulation  @xcite .",
    "this reformulation consists of evolving the conformally related metric @xmath22 , the conformal exponent @xmath23 , the trace of the extrinsic curvature @xmath24 , the conformal traceless extrinsic curvature @xmath25 , and the conformal connection functions @xmath26 defined by @xmath27 where @xmath28 and @xmath29 . in terms of these variables , eqs .",
    "( [ kij ] ) and ( [ evolve_adm ] ) become @xmath30 and @xmath31 ( see @xcite for the computation of the lie derivatives . )    in terms of the bssn variables , the constraint equations ( [ hamiltonian_adm ] ) and ( [ momentum_adm ] ) become , respectively , @xmath32 where @xmath33 . while the two constraints are identically zero for analytical solutions , they vanish only approximately in numerical calculations .",
    "thus , the hamiltonian and momentum constraint residuals @xmath34 and @xmath35 can be monitored as a code test during numerical evolution calculations . in the bssn formulation",
    ", we also monitor the new constraint @xmath36      like any other hyperbolic system , the einstein field equations must be supplemented by initial conditions and boundary conditions to have a unique evolution .",
    "we adopt boundary conditions that follow from the assumption of asymptotic flatness , i.e. @xmath37 . in the asymptotic domain ,",
    "monopole terms dominate in the longitudinal variables , so @xmath38 . the transverse fields will be dominated by outgoing gravitational waves , so @xmath39 and @xmath40 , where @xmath41 and @xmath42 are unknown functions of retarded time .",
    "note that @xmath43 is a special case of @xmath44 , so that @xmath23 , @xmath22 , and @xmath45 all satisfy outgoing wave boundary conditions .",
    "the appropriate boundary conditions for @xmath24 and @xmath26 depend on the gauge conditions used in the interior .",
    "we evolve eqs .",
    "( [ evolve_gamma])-([evolve_gamma ] ) using an iterative crank - nicholson scheme with one predictor step and two corrector steps @xcite . in this algorithm a function @xmath41 with time derivative @xmath46 is updated from its value @xmath47 at timestep @xmath48 to its value @xmath49 at the next timestep @xmath50 a time @xmath51 later . in the explicit predictor step @xmath52 , where @xmath53 is computed from quantities on timestep @xmath48 ,",
    "a `` predicted '' new value @xmath54 is found . in the following two corrector steps , @xmath55 and @xmath56 , these predicted values",
    "are `` corrected '' .",
    "the final value @xmath49 converges quadratically in @xmath57 .",
    "@xmath57 is set by the courant factor : @xmath58 , where @xmath59 is the coordinate distance between adjacent gridpoints .",
    "we typically use @xmath60 .",
    "the code implementing this evolution scheme has been discussed elsewhere @xcite , so we will highlight here only the new features of our code .",
    "we enforce the algebraic constraints @xmath61 and @xmath62 as described in  @xcite . also following @xcite",
    ", we replace the term @xmath63 in eq .",
    "( [ evolve_gamma ] ) with the analytically equivalent @xmath64 .",
    "these changes have little effect on the evolutions described in this paper , but lead to significant improvements when treating black holes by excision boundary conditions @xcite .",
    "we use second order centered differencing for all spatial derivatives in the field equations .",
    "we have not found it necessary to use upwind differencing for any derivatives .",
    "we did find , however , that the addition of some dissipation in the evolution equation for @xmath23 increases the stability of the code .",
    "this can be supplied by upwind differencing of the term which advects @xmath23 along the shift , and we have confirmed that this will indeed improve the stability .",
    "however , we have chosen instead to add the hamiltonian constraint to the evolution equation for @xmath23 , as follows @xmath65 here the parameter @xmath66 is set between @xmath67 and @xmath68 .",
    "@xmath69 is a diffusive term , with courant condition given @xcite by @xmath70 , so making @xmath66 proportional to @xmath57 is necessary in order to avoid an instability at high resolutions .",
    "it also provides dimensional consistency in ( [ phi_nevolve ] ) . using eq .",
    "( [ phi_nevolve ] ) offers the advantage of significantly decreasing the growth in the error of the hamiltonian constraint ( see sec .",
    "[ bin ] for an example of this . )",
    "we note that the above is similar to one of the modifications of bssn suggested in @xcite .",
    "as discussed in section ( [ bc_analytic ] ) , we use sommerfeld boundary conditions for most of the field variables .",
    "that is , the value of a quantity @xmath41 on the boundary at time @xmath71 and distance @xmath72 from the origin is @xmath73 where @xmath57 is the timestep and @xmath74 .    for the functions @xmath26 we have experimented with several boundary conditions .",
    "we find little sensitivity to the condition used ; the best choice seems to be fixing @xmath26 at their initial values ( zero , for most of the applications here ) .",
    "we describe the matter source of the einstein equations as a perfect fluid so that the stress - energy tensor can be written @xmath75 here @xmath76 , @xmath77 , @xmath78 , and @xmath79 are the rest - mass density , specific internal energy , pressure , and fluid four - velocity , respectively .",
    "we adopt a @xmath80-law equation of state @xmath81 where @xmath80 is a constant . for isentropic flow , this is equivalent to the polytropic relation @xmath82 where @xmath83 is a constant . in our simulations we encounter non - isentropic flow ( due to shocks ) , and hence use equation ( [ ideal_p ] ) .",
    "the equations of motion follow from the continuity equation @xmath84 and the conservation of stress - energy @xmath85 following  @xcite , these equations can be brought into the form @xmath86 where @xmath87 , @xmath88 , @xmath89 , @xmath90 , @xmath91 , and @xmath92 is the 3-velocity .",
    "the quantity @xmath93 is determined by the normalization condition @xmath94 , which can be written @xmath95^{-2}\\ .\\ ] ]    the perfect fluid given by eq .",
    "( [ perfect_fluid ] ) generates the following source terms for the adm equations @xmath96    we will only be considering systems where there is vacuum everywhere outside the star or stars .",
    "therefore , the appropriate boundary condition on the matter flow is that no material should be flowing into the grid through the outer boundaries .",
    "we evolve the hydrodynamic variables using an iterative crank - nicholson scheme .",
    "this scheme is slightly different from the one used to update the field variables . in the corrector steps , instead of weighting @xmath53 and @xmath97 equally ( i.e.  @xmath98 )",
    ", we make the evolution more implicit by setting @xmath99 .",
    "this makes the code slightly more stable .",
    "as is often done in hydrodynamics codes  @xcite , the updating of the fluid variables onto a new timestep is divided into two steps ( `` operator splitting '' ) : the advection step ( accounting for the advective terms on the left - hand sides of eqs .",
    "( [ evolve_rhostar])-([evolve_stilde ] ) ) , and the source step ( accounting for the right - hand sides of eqs .  ( [ evolve_rhostar])-([evolve_stilde ] ) ) .",
    "each step of a crank - nicholson update consists of applying first an advection substep and then a source substep .",
    "our scheme for carrying out the advection substep is similar to the van leer scheme , and is discussed in detail in appendix [ advection_appendix ] . since eq .",
    "( [ evolve_rhostar ] ) has no sources , @xmath100 is completely updated after it is advected . following  @xcite , we then use the updated @xmath100 to complete the updating of @xmath101 and @xmath102 .",
    "it is shown in @xcite that this gives improved behavior in newtonian simulations of binary polytropes .",
    "we handle shocks by adding quadratic artificial viscosity .",
    "this consists of adding a viscous pressure @xcite @xmath103 where @xmath104 is defined as @xmath105 and @xmath106 .",
    "shock heating causes an increase in the local internal energy . following  @xcite ,",
    "we change equation ( [ evolve_estar ] ) to @xmath107    we have also implemented linear artificial viscosity terms @xcite that can be used to dissipate radial oscillations triggered in stars by the truncation error associated with finite differencing .",
    "the corresponding addition to the pressure is @xmath108    linear viscosity can be used at the beginning of a run to drive the initial data to dynamical equilibrium and later switched off .",
    "figure [ bin_lin_vis ] shows an example of how the radial oscillations can be quenched by linear viscosity .",
    "for this particular example , the @xmath109 was active only where the rest mass density exceeded a particular threshold value , to force this dissipative effect only deep inside the neutrons stars .",
    "the ( small ) dissipated kinetic energy goes into thermal energy .",
    "we typically use @xmath110 .",
    "linear artificial viscosity is not used in the runs described below .",
    "= 2.8 in      numerical work in eulerian hydrodynamics , both newtonian and relativistic , has typically required the presence of a pervasive tenuous `` atmosphere '' that covers the computational grid outside the stars . to our knowledge ,",
    "most published codes to date need to keep a minimum nonzero density that is usually set to be several orders of magnitude smaller than the maximum stellar density .",
    "such an atmosphere has been necessary to prevent overflows arising from dividing by density in cells devoid of matter .",
    "this artificial atmosphere has to be small enough not to affect the true dynamical behavior of the system .",
    "however , very small values will propagate the round - off numerical error very quickly every time a division by the density is performed .",
    "a problem with the presence of this atmosphere is that as soon as the time evolution starts the material begins to fall onto the star , creating accretion shocks .",
    "@xcite solved this problem by adding a non - zero temperature to the atmosphere to restore some sort of equilibrium that would counterbalance the infall .",
    "also , in order to avoid the bow shocks generated in the atmosphere by two stars in circular orbital motion , these authors provide the atmosphere with initial angular velocity . these are some of the typical problems present in the traditional artificial atmosphere approach found in many eulerian hydrodynamics schemes .    in this paper",
    "we present a very simple algorithm that does not require the presence of atmospheric material .",
    "it consists of two ingredients .",
    "the first is the use of the spatial components of the linear momentum variable @xmath111 as our hydrodynamical variable @xcite instead of the traditional fluid four - velocity spatial components @xmath112 used in most hydrodynamical codes ( see for instance @xcite ) .",
    "in the latter case , the euler equation is used to update the flux @xmath113 .",
    "once this update is completed , the dynamical field @xmath112 is recovered by dividing by the density @xmath100 . using @xmath111 as a variable",
    ", we avoid these divisions .",
    "the only time when the variable @xmath112 needs to be calculated explicitly is when we need the three - velocity @xmath114 that appears in every advection term on the left hand side of eqs .",
    "( [ evolve_rhostar]-[evolve_stilde ] ) . to avoid doing this calculation for very low values @xmath100 , we add the second ingredient : the introduction of a threshold value @xmath115 below which all the hydrodynamical fields are set to vacuum values ( i. e. @xmath116 ) .",
    "a typical value for @xmath115 is @xmath117 times the maximum initial value of @xmath100 .",
    "however , as the time evolution progresses , a tenuous shell of material typically drifts away from the stars and creates regions of very low density outside our stars .",
    "if nothing special is done about them , small shocks will heat this low - density region to very high temperatures and will generate large velocities .",
    "although this low - density region has a negligible effect on our stars and spacetimes , it can cause the code to crash .",
    "therefore , we impose a heating limit outside the star @xmath118 where @xmath119 is a constant that is determined empirically for a given physical scenario .",
    "we generally choose values between @xmath120 and @xmath121 , where the larger values of @xmath119 were only needed in simulations of collapsing stars with a strong bounce .",
    "we note that this is similar to the technique used in  @xcite , in which the polytropic equation of state ( [ polytrope ] ) is applied in the low - density region outside the star or stars .",
    "since matter often diffuses outward , albeit in minute quantities , from the surface of the star(s ) to the boundaries , we need to impose boundary conditions on the matter at the outer grid points . in algorithms where an artificial atmosphere is present , it is crucial to choose boundary conditions which do not lead to a continuous inflow from the boundary , or to bad behavior in the atmosphere . by eliminating such an atmosphere , however , all reasonable boundary conditions yield the same behavior so long as the boundaries are placed far enough from the star(s ) that little matter ever reaches them .",
    "we usually use an outflow boundary condition . for example , if the @xmath122-coordinate of gridpoints is indexed by an integer @xmath123 with @xmath124 , this boundary condition at the outer-@xmath122 boundary @xmath125 is implemented as @xmath126    we have experimented with other boundary conditions as well .",
    "we have tried fixing @xmath100 , @xmath101 , and @xmath102 at their initial values .",
    "we have also tried simply copying the adjacent gridpoint onto the boundary with no outflow restrictions ( _ copy _ ) .",
    "these conditions produce similar results to those of the outflow condition for all applications , while being somewhat less computationally expensive .",
    "we experiment with several time slicing conditions .",
    "first , we try maximal slicing , which enforces @xmath127 @xmath128 this slicing condition has the advantages of controlling @xmath24 and avoiding singularities . unfortunately , it is a computationally expensive gauge choice , since it involves solving an elliptic pde every timestep .",
    "therefore , we also try a slicing condition which approximates maximal slicing , the so - called `` k - driver '' proposed by balakrishna _",
    "the idea is to convert the elliptic equation ( maximal slicing ) into a parabolic evolution equation @xmath129 where @xmath77 and @xmath130 are positive constants .",
    "the equation @xmath131 , corresponding to exponential decay in @xmath24 , is the solution of equation ( [ k_driver ] ) as @xmath132 .",
    "however , setting @xmath77 at too large a value in our code will produce a numerical instability .",
    "( see the discussion of @xmath66 in sec .",
    "[ field_implementation ] . )",
    "fortunately , this limitation can be overcome .",
    "we are able to effectively evolve with larger @xmath77 by breaking up each timestep into several substeps and evolve eq.([k_driver ] ) using a smaller @xmath57 than that used by the other variables . on each substep",
    ", we use the values of the metric on the destination time level , so the process is equivalent to solving the elliptic equation @xmath133 by relaxation , except that we do not carry the process to convergence .",
    "instead , we typically use 5 substeps per step , with @xmath134 and @xmath135 .",
    "an even less computationally expensive lapse condition is harmonic slicing , which for vanishing shift reduces to @xmath136 we apply this condition unchanged for vanishing and non - zero shift , and find that it often gives behavior similar to that obtained by using the above two slicings .",
    "we also experiment with different spatial gauge choices . the simplest admissible shift choice , which turns out to be surprisingly good for collapsing star applications , is to keep the shift `` frozen '' at its initial values @xmath137 at each grid point .",
    "we also try the approximate minimal distortion ( amd ) gauge introduced by shibata  @xcite @xmath138 where @xmath139 is the flat - space laplacian and @xmath140 this gauge condition was designed to approximate the smarr and york minimal distortion shift condition @xcite , which in turn was constructed to minimize gauge - related time variation in the spatial metric .",
    "as shibata points out  @xcite , the amd condition must be modified in the event of a collapse in order to prevent a `` blowing out '' of coordinates on the black hole throat , which manifests itself by a growth in the proper 3-volume element , i.e. by growth in @xmath23 .",
    "the blowing out can be controlled by preventing the radial component of the shift from becoming large and positive @xmath141 where @xmath142 is the solution of equation ( [ amd ] ) , @xmath143 is the value of @xmath23 at the coordinate origin , @xmath144 , and @xmath145 where @xmath16 is a constant .",
    "this correction is only useful in configurations with near spherical symmetry , so that the collapse is nearly radial at the center .",
    "it is disabled for simulations of binary systems .",
    "finally , we try approximating the `` gamma - freezing '' condition @xmath146 using a `` gamma - driver '' , which enforces controls @xmath26 in the same way that the k - driver controls @xmath24 @xmath147 here @xmath148 and @xmath149 are positive constants , and , as with the k - driver , we can effectively make @xmath148 larger than would otherwise be possible by breaking up each step into multiple substeps .",
    "this shift condition has been used successfully in black hole evolution calculations  @xcite .",
    "the gamma - freezing condition is closely related to minimal distortion ( and hence approximate minimal distortion ) , and it is hence not surprising that the modification ( [ mamd ] ) must also be applied to the gamma - driver shift .",
    "typical values for the gamma - driver s parameters are @xmath150 and @xmath151 , using 10 substeps per step .",
    "we have also implemented of the full gamma freezing condition ( @xmath146 ) . however , applying this condition requires solving three coupled elliptic equations each timestep ( see eq .",
    "( [ evolve_gamma ] ) ) , and we have found gamma freezing to be too computationally expensive to be worth solving exactly .      rotating coordinate frames possess superior angular momentum conservation capability over inertial frames in many applications , such as the hydrodynamical evolution of binaries systems . in transforming from an inertial frame with",
    "coordinates @xmath152 to a rotating frame with coordinates @xmath153 and constant angular frequency @xmath154 , we apply the following relations @xmath155 where the barred variables will represent quantities in the inertial frame in the remainder of this section .",
    "it is convenient to compare variables in the two frames at an instant @xmath156 at which the two frames are aligned . at this instant ,",
    "the line element transforms from @xmath157 to @xmath158 where @xmath159 . from this equation",
    ", we see that the following transformation rules apply at @xmath156 : @xmath160 eq .",
    "( [ rot_fields ] ) provides the transformation rules for the initial metric data from the inertial frame ( where it is usually derived ) to the rotating frame .",
    "the only change is the addition of a new term in the shift . at later times , vectors and tensors in the two frames",
    "will also differ by a rotation .",
    "however , we note that at all times there will be some inertial frame , related to @xmath152 by a rotation matrix , which has axes aligned with the rotating frame and whose metric is related to that of the rotating frame by eq .",
    "( [ rot_fields ] ) . using the coordinate transformations ( [ transf_law ] ) we can derive the relation between all the fields in both frames , for example @xmath161 where @xmath114 is the fluid three - velocity @xmath162 . at @xmath163 ,",
    "the components of any spatial tensor are unchanged under this transformation , for example @xmath164 and equivalently for @xmath165 and @xmath6 .",
    "the relation ( [ spatial_tensor ] ) implies @xmath166 , since the inverse of a tensor is unique , so that we also find @xmath167 . to complete our introduction of rotating frames in general relativity , we refer the reader to appendix [ newt_limit ] , where we show that the newtonian limit of the relativistic euler equation with a shift vector of the form of equation ( [ rot_fields ] ) reduces to the familiar newtonian form of the euler equation in rotating frames . in appendix [ adm_rotating ] , we show that the integrands used to evaluate @xmath168 , @xmath169 , and @xmath170 in eqs .",
    "( [ mfin ] ) , ( [ jfin ] ) , and ( [ m0fin ] ) , respectively , remain unchanged when expressed in terms of rotating frame variables .",
    "we always choose initial data which satisfy maximal slicing ( [ maximal_slicing ] ) and gauge choices which approximately maintain this slicing .",
    "far from the source , equation ( [ maximal_slicing ] ) becomes the laplace equation , and its solution can be written as a sum of multipole moment fields . in the presence of matter",
    ", the source will always have a nonzero monopole moment , so the asymptotic form of the lapse is @xmath171    all of our spatial gauge choices resemble one another , so we will just derive the shift boundary condition for the amd shift ( [ amd ] ) , which is the easiest .",
    "the three components of eq .",
    "( [ amd ] ) can be decoupled by decomposing @xmath4 as in  @xcite @xmath172,\\ ] ] where @xmath173 are the cartesian coordinates . eq .",
    "( [ amd ] ) then becomes @xmath174 to lowest order , @xmath175 .",
    "we will be studying systems with azimuthal velocity fields , for which @xmath176 , and hence @xmath177 .",
    "the lowest nonvanishing moment of @xmath178 , from the monopole piece of @xmath17 , is @xmath179 , @xmath180 .",
    "we can solve the laplace equation ( outside the star ) assuming asymptotic flatness to get the boundary conditions @xmath181 , @xmath182 , and , to this order , @xmath183 . a nonzero boundary condition for",
    "@xmath184 must come from a higher - order term , but , since @xmath184 will be very small , our simulations are insensitive to it .",
    "we use @xmath185 the @xmath184 condition is obtained by ignoring @xmath149 and solving ( [ amd_p ] ) subject to the lowest - order moment of the @xmath186 term in @xmath178 ( see eq .",
    "( [ amd_source ] ) . )",
    "note that the coordinate - rotation component of a shift , @xmath187 , is a homogeneous solution of equation ( [ amd ] ) .",
    "it was eliminated in ( [ shift_bc ] ) by the assumption of asymptotic flatness .",
    "when working in a rotating frame , the shift does not obey an asymptotic flatness condition .",
    "indeed , one can think of a coordinate rotation as a boundary condition imposed on the shift .",
    "in such frames , the asymptotic form of the shift is @xmath188 _ plus _ a piece which behaves like ( [ shift_bc ] ) , and the boundary conditions must be set accordingly .",
    "in order to gauge the accuracy of our simulations , we monitor the l2 norms of the violation in the constraint equations .",
    "these are the hamiltonian constraint @xmath34  ( [ hamiltonian_bssn ] ) , the momentum constraint @xmath189 ( [ momentum_bssn ] ) , and the gamma constraint ( [ gamma_bssn ] ) .",
    "we normalize the hamiltonian and momentum constraint violation by their l2 norm by @xmath190 and @xmath191\\right)^{1/2}\\right\\|_2.\\nonumber\\end{aligned}\\ ] ] the two terms in the gamma constraint ( [ gamma_bssn ] ) often vanish individually , so that a similar normalization is not meaningful for this constraint .",
    "related to the hamiltonian and momentum constraints are mass and angular momentum conservation . in cartesian",
    "coordinates , the adm mass @xmath168 and the angular momentum @xmath192 are defined by the behavior of the metric on a closed surface at asymptotically flat spatial infinity @xmath193 since eq .",
    "( [ jdef ] ) is computed at spatial infinity , @xmath194 is the flat - space levi - civita tensor .",
    "using gauss law , we transform the surface integrals into volume integrals @xmath195 ( see , for example , appendix a in @xcite for a derivation ) .",
    "note that since @xmath194 is outside the integral , it is still the flat - space levi - civita tensor .",
    "baryon conservation @xmath196 implies that the rest mass @xmath197 is also conserved . due to the finite differencing in our hydrodynamic scheme , @xmath169",
    "is conserved identically except for matter flow off the computational grid .",
    "we therefore monitor @xmath169 only as a diagnostic of how much matter flows through the outer boundaries .",
    "( [ mfin ] ) and ( [ jfin ] ) are only valid in asymptotically flat spatial hypersurfaces and thus are not suited for use in rotating reference frames .",
    "however , the problem can be sidestepped quite easily by calculating the mass and angular momentum in the inertial frame , as functions of the dynamical variables of the rotating frame . in appendix [ adm_rotating ]",
    "we show that the integrals for these conserved quantities are exactly the same when expressed in terms of the rotating frame fields .",
    "another useful quantity to monitor is the circulation . according to the kelvin - helmholtz theorem @xcite",
    ", the relativistic circulation @xmath198 is conserved in isentropic flow along an arbitrary closed curve @xmath130 when evaluated on hypersurfaces of constant proper time . here",
    "@xmath199 is the specific enthalpy , @xmath200 is a parameter which labels points on @xmath130 , and @xmath201 is the tangent vector to the curve @xmath130 .",
    "since @xmath202 is only conserved for isentropic flow , checking conservation of circulation along a few curves will measure the importance of numerical and artificial viscosity on an evolution .",
    "we do not monitor circulation in this paper , although such a check has been implemented elsewhere  @xcite .",
    "finally , we check for the existence of apparent horizons using the apparent horizon finder described in  @xcite .",
    "all our algorithms have been implemented in a parallel , distributed - memory environment using dagh software  @xcite developed as part of the binary black hole grand challenge alliance . when we need to solve elliptic equations ( to construct initial data or to impose elliptic gauge conditions ) , we use the computational toolkit petsc  @xcite .",
    "= 2.8 in    due to our large number of variables , the memory needed by our code is considerable ( for example , a run with @xmath203 spatial zones may require up to 2 gbytes of memory ) .",
    "thus , it is crucial that we exploit any symmetries present in a given problem to minimize the number of gridpoints needed .",
    "we have implemented reflection symmetry across a coordinate plane ( equatorial symmetry ) and reflection symmetry across three coordinate planes ( octant symmetry ) , which cut the size of our grids by factors of two and eight .",
    "our code also allows us to enforce @xmath204-symmetry , which assumes symmetry under a rotation of @xmath204 radians about a given axis . unlike equatorial and octant symmetry ,",
    "the implementation of @xmath204-symmetry is not trivial on distributed - memory parallel systems .",
    "this is because grid points needed to generate the proper boundary conditions at a given location of the outer grid boundary will usually be located in the memory of a different processor , as seen in the diagram of fig .",
    "[ pi_symm ] where the value of the field at the white circle needed by point @xmath78 in processor @xmath205 must be provided by a black circle on processor number @xmath206 .",
    "we fix this problem by creating a two dimensional array for each field that stores the values of the field on all the grid points outside the boundary ( white circles ) needed to calculate the derivatives of the field at the grid points at the boundaries ( first row of black points ) .",
    "each processor is responsible for updating the array values corresponding to grid points within its domain by a @xmath204-radian rotation .",
    "updated values are broadcast via mpi , and each processor has a copy of the complete two - dimensional array from which to draw the corresponding boundary values .",
    "the algorithm for evolving the field equations was first tested in the context of small amplitude gravitational waves  @xcite . with harmonic slicing",
    ", the system could be accurately evolved for over 100 light crossing times without any sign of instability .",
    "the results also showed second - order convergence to the analytic solution when resolution was increased . in a forthcoming paper  @xcite",
    ", it will be demonstrated that this same code can stably evolve isolated black holes , with and without rotation , in kerr - schild coordinates .",
    "next , it was demonstrated that this field evolution scheme is stable when predetermined matter sources are present  @xcite .",
    "this was done by inserting the matter sources from known solutions of the einstein equations and then evolving the gravitational field equations . using this `` hydro - without - hydro '' approach , @xcite evolved the oppenheimer - volkoff solution for static stars without encountering any instability , and the oppenheimer - snyder solution for collapse of homogeneous dust spheres well past horizon formation .",
    "the same hydro - without - hydro approach was later used to model the quasi - equilibrium inspiral of binary neutron star systems and calculate the complete late - inspiral gravitational wavetrain outside the isco @xcite .",
    "= 2.8 in    every hydrodynamic algorithm must demonstrate some ability to handle shocks . in fig .",
    "[ shock ] , we compare the output of our code for a simple one - dimensional shock tube problem with the exact result , which is known analytically in special relativity  @xcite . in order to compare with this result , the metric functions are held at their minkowski values throughout this test . at @xmath207",
    ", we set @xmath208 everywhere .",
    "for @xmath209 we set @xmath210 , @xmath211 initially , and for @xmath212 we set @xmath213 , @xmath214 .",
    "we output data at @xmath215 . in figure 1",
    ", we use artificial viscosity parameters @xmath216 , @xmath217 ( see sec .  [ art_vis ] ) and a grid with 400 points .",
    "the shock is resolved quite well , and the only disturbing feature of our results is the `` overshoot '' in variables at the rarefaction wave .",
    "norman and winkler  @xcite have shown that these overshoots are present in the solution to the finite difference equations of artificial viscosity schemes even in the limit of the grid spacing going to zero .",
    "this problem therefore represents a fundamental limitation of artificial viscosity schemes , and points to the need for more sophisticated high - resolution - shock - capturing techniques when strong shocks are present ( see , e.g. , @xcite ) .",
    "however , for many of our astrophysical applications ( e.g.  binary inspiral ) we anticipate at most very weak shocks , so that the use of artificial viscosity schemes is adequate .    our results are completely insensitive to @xmath218 when it is within the range @xmath219 .",
    "we find the optimal behavior around @xmath220 , at which point the effects of artificial viscosity are small but noticeable . for @xmath221 or greater ,",
    "the viscosity is too large , and we are unable to evolve accurately",
    ".    note that in the above example @xmath222 everywhere , so @xmath101-limiting ( [ elimit ] ) is never used .",
    "more extreme shocks can be created by increasing the density ratio @xmath223 .",
    "we find that we can treat shocks reasonably accurately for ratios of up to about twenty .",
    "= 2.8 in    = 2.8 in    as a second simulation which can be tested against exact results , we model oppenheimer - snyder ( os ) collapse of a homogeneous dust sphere to a black hole  @xcite .",
    "the analytic solution for os collapse can be transformed into maximal slicing and isotropic coordinates following  @xcite .",
    "we use the analytic solution at @xmath207 , when the matter is at rest , as initial data for all variables .",
    "we then evolve the gravitational and hydrodynamic fields with our 3 + 1 code and compare the result with the exact solution . at each timestep",
    ", we determine the lapse by solving the maximal slicing condition from the fields on our 3d grid . for the shift we insert the analytic values corresponding to isotropic",
    "we evolve on a @xmath224 grid and a @xmath203 grid , utilizing octant symmetry to treat only the upper octant .",
    "our outer boundaries are placed at @xmath225 in the isotropic coordinates of our grid .",
    "the initial schwarzschild radius of the dust sphere is @xmath226 .    in fig .",
    "[ os_phi ] , we show the convergence of the central conformal exponent @xmath143 to the exact value . in fig .",
    "[ os_prof ] , we compare the density profiles at several times for the @xmath203 grid to their analytical values . throughout the evolution ,",
    "we search for apparent horizons . at @xmath227",
    ", we locate an apparent horizon with irreducible mass @xmath228 .",
    "( see fig .",
    "[ os_phi ] . )",
    "this mass remains constant to within 3% until the end of the simulation ( @xmath229 later ) .",
    "as is known analytically , all of the mass falls inside the black hole .",
    "this test is similar to the `` hydro - without - hydro '' oppenheimer - snyder test performed on our code in  @xcite , except that here the matter fields and the lapse are determined numerically rather than set to their analytic values .",
    "in this section we study isolated stars , both non - rotating and rotating .",
    "the initial data , constructed from the ov solution for non - rotating equilibrium stars and with the code of @xcite for equilibrium rotating stars , are summarized in table  [ star_table ] ( see also fig .",
    "[ sequences ] . )",
    "we use the same coordinates as used in @xcite ( except transformed from spherical to cartesian ) . for spherical , nonrotating systems ( ov stars ) , these are the familiar isotropic coordinates . in these coordinates ,",
    "the 3-metric for stationary spherical stars is conformally flat , and the event horizon of a schwarzschild black hole is located at @xmath230 . all stars are @xmath1 , @xmath231 polytropes ( see eq .",
    "( [ polytrope ] ) ) , and are dynamically evolved with the gamma - law equation of state  ( [ ideal_p ] ) .",
    "the nondimensional units throughout are set by requiring @xmath232 .    .isolated equilibrium star configurations ( @xmath233 ) . [ cols=\"^,^,^,^,^,^,^,^,^\",options=\"header \" , ]     @xmath234 adm mass    @xmath235 rest ( baryonic ) mass    @xmath236 coordinate equatorial radius    @xmath237 areal radius at the equator    @xmath238 ratio of angular momentum to @xmath239    @xmath240 ratio of kinetic to gravitational potential energy    @xmath241 ratio of central to equatorial angular velocity    @xmath242 ratio of polar to equatorial coordinate radius    = 2.8 in      the stability properties of non - rotating @xmath231 polytropes are known analytically and can be used as a test of our code .",
    "we use the ov  @xcite solution describing equilibrium polytropes in spherical symmetry as initial data , and evolve the matter and fields dynamically .",
    "an ov star is characterized by one parameter , which can be taken to be the central rest density @xmath243 .",
    "( we will henceforth drop the subscript `` 0 '' on the rest density when referring to central rest density . ) along the sequence of increasing @xmath243 , the mass @xmath168 takes a maximum value @xmath244 at a critical central density @xmath245 .",
    "( see fig .",
    "[ sequences ] . ) stars with @xmath246 are dynamically stable , while stars with @xmath247 are unstable and collapse to black holes on a dynamical timescale .",
    "the dynamical timescale is given by the free - fall time @xmath248 .",
    "to verify that our code can distinguish stable and unstable configurations we evolve two very similar models on either side of the critical point at @xmath245 .",
    "= 2.8 in    = 2.8 in    in our units , @xmath249 and @xmath250 .",
    "star a  has an initial central rest density @xmath251 and is therefore stable .",
    "we set our outer boundaries at @xmath252 and evolve this star with three different resolutions @xmath253 , @xmath224 , and @xmath203 , once again utilizing octant symmetry . in fig .",
    "[ converge ] , we show the central density evolution for the three resolutions using harmonic slicing and the gamma - driver shift . we see that our code does converge to the exact ( stationary ) solution .",
    "there are three sources of the deviations from exact second - order convergence ( see also @xcite ) .",
    "first , there are components of the error which scale with a higher power of the grid width ( e.g. @xmath254 ) .",
    "second , there is the noise caused by discontinuities at the surface of the star .",
    "finally , errors are generated by imposing outer boundary conditions at finite distance .    in fig .",
    "[ tov_gauge ] , we evolve on a @xmath224 grid with several gauge choices .",
    "already we see that the choice of gauge is important . even in this static case ,",
    "where the shift in the ov solution vanishes , it is necessary to use a dynamic shift for long term stability . with the gamma - driver ,",
    "we evolve to @xmath255 ( @xmath256 ) and never encounter an instability .",
    "we have stably evolved star a  on the @xmath224 grid for many fundamental radial oscillation periods , which have a period of about @xmath257  @xcite .",
    "however , we find that high - frequency , high - amplitude oscillations appear in @xmath243 after a few periods and persist thereafter",
    ". the onset of these oscillations can be delayed and their amplitude diminished by increasing grid resolution .",
    "they can be removed altogether by making the hydrodynamic algorithm more implicit , i.e. by increasing the weight on the new timestep in the corrector step ( see section [ hydro_avd ] ) .",
    "this adversely affects our ability to handle shocks , though .",
    "the problem may also be resolved by the use of a more sophisticated hydrodynamics scheme ( see , e.g. , @xcite ) .",
    "for the less relativistic stellar model used by @xcite our code produces non - physical high - frequency oscillations after about 6 radial oscillation periods @xmath258 .",
    "for the applications discussed here , these late - time problems are not relevant .",
    "star b  has an initial central density of @xmath259 and is dynamically unstable .",
    "we evolve this star with harmonic lapse and frozen shift , imposing outer boundaries at 1.2 @xmath168 , on two different grids ( @xmath224 and @xmath203 ) . in fig  [ tov_collapse ] , we plot the central density and lapse as a function of time .",
    "the collapse is induced solely by the perturbations caused by putting the star on a discrete grid . since these perturbations become smaller as grid resolution",
    "is increased , it is not surprising that the star on the lower - resolution grid collapses before the one on the higher - resolution grid . since both collapse",
    ", it appears that @xmath224 zones are sufficient to distinguish stable from unstable stars .",
    "eventually , the star collapses to a point at which there are too few grid points across the star s",
    "diameter for the evolution to remain accurate .",
    "we terminate our evolutions when the error in the adm mass exceeds 15% of the original mass .",
    "the @xmath224 grid turns out to be too coarse for an apparent horizon to be located .",
    "we do locate an apparent horizon in the @xmath203 run shortly before the simulation is terminated . at this point",
    "the central lapse has collapsed to @xmath260 , and , as a measure of error , the adm mass deviates by 10% from its initial value .",
    "the horizon mass agrees well with the adm mass @xmath261 .",
    "also included in fig .",
    "[ tov_collapse ] is a @xmath203 simulation using harmonic lapse and the gamma - driver .",
    "similar behavior is seen in these coordinates .",
    "we will investigate the performance of various gauge choices in more detail in the following section .",
    "= 2.8 in        = 2.8 in    = 2.8 in    simulations of systems with non - zero angular momentum are very sensitive to the choice of coordinates , which makes them very good test cases for comparing the numerical behavior of different gauges and slicings .",
    "most of these effects can be seen when we evolve uniformly rotating stars .",
    "we consider two uniformly rotating stars , stars c  and d , on one constant angular momentum sequence @xmath262 ( see fig .  [ sequences ] ) .",
    "the @xmath262 sequence has a turning - point at @xmath263 , @xmath264 . for a sequence of uniformly rotating stars",
    ", this turning point marks the onset of secular , not dynamical , radial instability  @xcite .",
    "it is possible for a star on the secularly unstable branch to be stabilized temporarily if the star begins to rotate differentially , so that no instability will develop on a dynamical timescale .",
    "however , prior numerical studies  @xcite have found the point of onset of dynamical instability to be very close to the point of onset of secular instability , which we confirm with our simulations here .",
    "we again pick two similar stars on either side of the onset of secular instability : star c  with @xmath265 on the stable branch and star d  with @xmath266 on the unstable branch .",
    "we dynamically evolve these two stars with different choices for the slicing and gauge .",
    "all simulations are performed on @xmath267 grids , utilizing equatorial and @xmath204-symmetry to evolve only half of a hemisphere .",
    "the outer boundaries are placed at @xmath268\\times [ 0,1.5]^2 $ ] .",
    "there are now two relevant timescales  the free - fall time @xmath269 and the orbital period @xmath78  and a reliable code must be able to stably evolve stable rotating stars for several of both timescales .",
    "results for star c with @xmath270 and @xmath271 in our units , are plotted in figures  [ lapse ] and  [ shift ] . in fig .",
    "[ lapse ] we compare the evolution for maximal slicing ( [ maximal_slicing ] ) , harmonic slicing ( [ harmonic ] ) and the k - driver ( [ k_driver ] ) , all with the gamma - driver shift condition ( [ gamma_driver ] ) .",
    "we find that there is little sensitivity to the lapse choice except for small oscillations in @xmath170 which are only present with harmonic slicing .    in fig .",
    "[ shift ] where we compare the frozen shift condition ( [ frozen ] ) , the amd shift ( [ amd ] ) and the gamma driver ( [ gamma_driver ] ) , all evolved with the k - driver ( [ k_driver ] ) for the lapse .",
    "this comparison demonstrates the great importance of choosing an appropriate shift condition for controlling @xmath26 .",
    "amd is dramatically better than frozen shift in this regard , and the gamma driver is dramatically better than amd .",
    "the behavior with amd shift does not change significantly when the criteria for convergence of ( [ amd ] ) is made stricter .",
    "note that the modification ( [ mamd ] ) to amd and the gamma - driver is not activated for this application .",
    "= 2.8 in    = 2.8 in    figures  [ rcoll1 ] and  [ rcoll2 ] show the behavior of the radially unstable star d  under different coordinate choices .",
    "once again , perturbations are induced solely by the finite difference error of the grid .",
    "we terminate simulations when mass conservation is violated by 10% or the code crashes .",
    "the singularity avoidance property of the k - driver , which approximates maximal slicing , is manifest : with the lapse collapsing to very small values , the proper time between time slices at the star s center becomes very small , which effectively `` freezes '' all quantities there . with harmonic slicing",
    ", @xmath3 decreases more slowly , and we are able to reach higher central densities , corresponding to later proper times , before the code crashes",
    ". given their qualitatively different behavior , it is difficult to compare meaningfully the different lapse choices for this scenario . if one wants to see the central region reach the farthest stage of collapse before violation of mass conservation becomes unacceptable , harmonic lapse and gamma - driver shift seem to be the optimal combination .",
    "one possible reason for this is the behavior of @xmath143 , the conformal exponent at the stellar center . for the gauge choices which are best suited to probing the central region , @xmath143 decreases significantly from its initial value .",
    "inverting shibata s reasoning for modifying the amd gauge , we infer that this corresponds to choosing a gauge with infalling coordinates .",
    "this effectively increases the grid coverage of the collapsing star , resulting in a more accurate evolution .",
    "we are only able to locate an apparent horizon in the harmonic lapse / gamma driver simulation , and only in the last few timesteps , at which point @xmath260 , @xmath272 , and the error in adm mass is about 2% .",
    "it seems that @xmath267 zones are barely sufficient resolution for locating horizons for rotating stars reliably .",
    "= 2.8 in    we compare results for uniformly rotating star c  in the inertial frame to results in the corotating frame in figure [ rns_ivsr ] . in the corotating frame , @xmath273 at @xmath274 .",
    "the light cylinder , where points of fixed coordinate label are moving on null paths , is at @xmath275 , well outside our outer boundaries at @xmath276 .",
    "all coordinate observers are therefore timelike everywhere on our grid .",
    "we see a dramatic improvement in angular momentum conservation in the corotating frame .",
    "this indicates that the loss of @xmath170 in the inertial frame is caused by error in the advection of fluid quantities along @xmath114 .",
    "mass conservation is also better in the rotating frame , but not dramatically .",
    "other quantities show qualitatively the same behavior in both frames .",
    "we have redone the evolution of collapsing star d  with harmonic lapse and gamma - driver shift in the corotating frame , and our results were almost identical to those in the inertial frame .",
    "= 2.8 in    we now test the ability of our code to handle differential rotation .",
    "differential rotation in neutron stars is relevant in several important astrophysical phenomena .",
    "simulations in both newtonian hydrodynamics  @xcite and full general relativity @xcite indicate that binary neutron star coalescence may well lead , at least temporarily , to a differentially rotating remnant , which can support significantly more rest mass than uniformly rotating stars  @xcite .",
    "core collapse in a supernova may also result in a differentially rotating neutron star .",
    "= 2.8 in    we construct axisymmetric equilibrium initial data , again following @xcite , with @xmath277 chosen as the axis of symmetry . for the rotation profile , we choose @xmath278 where @xmath279 is the angular velocity of the fluid , @xmath280 is the value of @xmath279 on the rotation axis , @xmath281 is the equatorial coordinate radius , and @xmath104 is a parameter that measures , in units of @xmath281 , the scale over which @xmath279 changes . in the newtonian limit this profile reduces to @xmath282 for @xmath283",
    "one recovers uniform rotation .    in fig .",
    "[ estarf ] we present results for star e  with @xmath284 , @xmath285 , @xmath286 , @xmath287 , and @xmath288 .",
    "this star s rest mass of @xmath289 exceeds the maximum allowed rest - mass of non - rotating @xmath233 polytropes by 70 percent .",
    "we evolve this star on a @xmath267 grid , using @xmath204-symmetry , with outer boundaries at @xmath290\\times [ 0,2]^2 $ ] .",
    "the same star was evolved dynamically by  @xcite , and we confirm their finding that the star is stable over several central rotation periods .",
    "we found that simulations of differentially rotating stars are very sensitive tests of hydrodynamic advection schemes .",
    "in particular , when we used time - averaging instead of crank - nicholson to treat the advection terms ( see appendix [ advection_appendix ] ) , we found that the angular momentum is conserved very poorly .",
    "the decrease in @xmath170 also causes the central density to rise , and the numerical model to drift further and further from the true solution .",
    "this suggests that for differential rotation , the ability to successfully conserve angular momentum depends strongly on the finite difference algorithm used for the hydrodynamics .    in fig .",
    "[ pdep ] we show results for star f , with @xmath291 , @xmath292 , @xmath293 , @xmath294 , and @xmath295 .",
    "this model is identical to star i in table ii of @xcite , where this star was evolved in axisymmetry .",
    "star f  is radially stable , but , as in @xcite , we make the situation dynamic by depleting pressure from the star by artificially reducing the polytropic constant @xmath83 ( which requires us to re - solve the hamiltonian and momentum constraints ) .",
    "removing pressure support causes the star to implode . for small depletion factors ,",
    "this collapse is halted and the star bounces and finds a new , more compact , stable equilibrium configuration .",
    "when @xmath83 is reduced to a low enough value , the star will collapse to a black hole .",
    "thus , there is a critical polytropic constant @xmath296 separating these two outcomes . in @xcite ,",
    "this critical value was found to be @xmath297 .",
    "= 2.8 in    we evolve star f  on a grid of @xmath298 zones , with the outer boundaries located at 2 , or equivalently 40.8 @xmath168 . in this simulation",
    "we use only equatorial symmetry so that non-@xmath204-symmetric perturbations can grow .",
    "we evolve three different cases ; one without pressure depletion with @xmath299 , a supercritical case with @xmath300 , and a subcritical case with @xmath301 . both the second and third case present unique challenges . in the second case ,",
    "the collapse is halted by a strong shock which must be handled accurately . in the third case",
    ", we must follow the collapse from a radius of @xmath302 to a radius of @xmath303 .",
    "our results are consistent with those of @xcite , even though our 3d simulations have a much poorer resolution than the axisymmetric simulations of @xcite . in particular",
    ", our resolution is insufficient to follow the final stages of the @xmath304 collapse and prove that a black hole is formed .    in order to overcome this problem",
    ", we redo the @xmath304 collapse on a @xmath305 grid .",
    "this grid is still too sparse to resolve a black hole with radius of approximately @xmath306 if the outer boundaries are imposed at 40.8 @xmath168 . in order to resolve the black hole",
    ", we rezone our grid several times during the implosion , halving the boundaries and halving the grid spacing , so that the total number of gridpoints remains constant ( compare  @xcite . )",
    "we present results for a simulation that was carried out on four different grids with outer boundaries at 2 , 1 0.5 and 0.25 .",
    "we use the k - driver and the gamma - driver without the modification  ( [ mamd ] ) . with the modification , the functions @xmath26 grow very rapidly and cause the code to crash well before the radius reaches @xmath168 . turning off",
    "the modification means that @xmath143 will grow , and the coordinates will blow outward .",
    "we count on the grid rezoning to counter this effect . also , we switch to frozen shift on the last and finest grid of the evolution",
    ". the gamma - driver does not perform well on this segment , perhaps because the grid boundaries have been moved in to a point where the shift does not have its asymptotic form ( [ shift_bc ] ) .",
    "= 2.0 in = 2.0 in + = 2.0 in = 2.0 in    the results of this simulation are shown in figs .",
    "[ collhr1 ] and  [ coll_contour ] .",
    "@xmath168 and @xmath170 remain within 10% of their initial values throughout ( we terminate the calculation when this ceases to be true . ) in our coordinates , the equatorial radius decreases from 1.24 ( 25.3@xmath168 ) to 0.04 ( 0.8@xmath168 ) .",
    "since @xmath143 is growing , part of this decrease in radius is a coordinate effect .",
    "the coordinate - independent circumferential radius at the equator ( computed from @xmath307 ) decreases from 27@xmath168 to 1.7@xmath168 . at @xmath308",
    ", we locate an apparent horizon with surface area @xmath309 0.0804 corresponding to an `` irreducible '' mass of @xmath310 .",
    "is this a reasonable value ?",
    "the existence of rotation and of mass outside of the black hole mean that we can no longer expect the irreducible mass of the hole to be equal to the adm mass of the entire system .",
    "the area of the event horizon of a kerr black hole with this system s total @xmath168 and @xmath170 would be @xmath309 0.109 . by breaking up the rest mass integral into pieces inside and outside the horizon",
    ", we find that 82% of the baryonic mass is inside the apparent horizon .",
    "if we assume that the values of @xmath168 and @xmath311 for the black hole are 82% of those of the total system , we arrive at the very crude estimate @xmath309 0.0732 , which is within 10% of the value determined from the apparent horizon . we terminate our simulation 2.5@xmath168 after the horizon is located , during which time its area does not change appreciably .",
    "our agreement with  @xcite indicates that nonaxisymmetric perturbations are not important in the collapse of this star .",
    "we confirm this in fig .",
    "[ coll_contour ] . as",
    "one can see , the density profiles remain axisymmetric throughout .",
    "= 2.6 in = 2.6 in + = 2.6 in = 2.6 in + = 2.6 in = 2.6 in    = 3.0 in    binary neutron stars are among the most promising sources of gravitational radiation for the new generation of gravitational wave interferometers .",
    "this makes the numerical simulation of such systems one of the most important goals of a fully relativistic hydrodynamics code and provides one of the most demanding tests for any such code .",
    "a binary system allows us to uncover potential problems that may not be evident in axisymmetric scenarios .",
    "previous simulations have focused on the coalescence and merger of binary neutron stars @xcite . in this section",
    "we demonstrate that our code can stably evolve binaries in stable , quasi - circular orbits for over two periods ( compare @xcite ) .    as initial data for these simulations we adopt the data of @xcite , describing two equal mass polytropes in co - rotating , quasi - circular orbit .",
    "these data have been constructed using the conformal `` thin - sandwich '' decomposition of the constraint equations @xcite together with maximal slicing and spatial conformal flatness .    in this section",
    "we focus on one particular case and postpone a more complete presentation for a forthcoming paper @xcite .",
    "we model the neutron stars as @xmath233 polytropes with an individual rest mass of @xmath312 in our nondimensional units ( recall that the polytropic index @xmath83 is set to unity ) . at infinite separation",
    ", this corresponds to an individual gravitational mass of @xmath313 .",
    "the compaction of @xmath314 implies that the gravitational fields are moderately relativistic ( the maximum compaction for @xmath233 polytropes is @xmath315 ) .",
    "we adopt initial data for a binary separation of @xmath316 , where @xmath317 is the ratio between the coordinate separation from the center of mass to the nearest point on the star s surface to the farthest point ( see @xcite ) , meaning that the separation between the stellar surfaces is about @xmath318 of a stellar diameter .",
    "this separation is well outside the innermost stable circular orbit ( isco ) as determined by the analysis of initial data sets ( see @xcite ) . at this separation ,",
    "the total binary adm mass is @xmath319 and the total angular momentum is @xmath320 .",
    "we evolve these initial data on three different grids .",
    "two `` small grid '' simulations are evolved on @xmath321 gridpoints , with a resolution of @xmath322 ( the binary is symmetric across the equatorial plane , and , for equal mass stars , @xmath204-rotation symmetric around the center of mass ) .",
    "the individual stars are resolved by @xmath323 gridpoints across the stellar diameter ( compare @xcite where much larger grids are used ) .",
    "one of these small grid evolutions is performed in the inertial frame , the other in a rotating frame . on these small ( uniform ) grids ,",
    "the outer boundaries are imposed very close to the stars ( at a separation of two stellar diameters ) , which we found to introduce numerical noise .",
    "we therefore repeated these simulations on a `` large grid '' , performed in a rotating frame , where we doubled the number of gridpoints and the separation to the outer boundary , while keeping the grid resolution constant .",
    "this corresponds to a numerical grid covering a cubic coordinate volume of side [ -66,66 ] in the units of fig .",
    "[ bin_contour ] .",
    "the size of this grid is such that the corner points almost `` touch '' the surface of the light cylinder , the cylinder with coordinate radius @xmath324 , where @xmath279 is the rotating frame angular frequency .",
    "the possibility of evolution in rotating frames with grids that extend beyond the light cylinder will be studied in a future article .",
    "we used courant factors of 0.30 and 0.46 for the small and large grid runs respectively , resulting in about 3,000 timesteps per orbit for the latter case .",
    "we adopt the k - driver ( [ k_driver ] ) for the lapse ( using @xmath325 , @xmath326 , and 5 substeps per step ) and the gamma - driver ( [ gamma_driver ] ) for the shift ( using @xmath151 , @xmath327 and 10 substeps ) .",
    "we used sommerfeld type boundary conditions for the gravitational fields ( see section [ fields_bcs ] ) and _ copy _ type for the hydrodynamical fields ( see section [ hydro_bcs ] ) . for the artificial viscosity we used @xmath328 and @xmath217 ( see section [ art_vis ] ) .",
    "we also used @xmath329 in ( [ phi_nevolve ] ) .",
    "for the small , rotating frame grid , this choice led to the code crashing after about a period and a half .",
    "however , we found that restarting the code just before that with @xmath330 allowed us to continue the evolution . for the large grid ,",
    "no such adjustment was necessary .",
    "for both small grid simulations we found that the stars quickly drift apart . to compensate for this we reduced the orbital angular velocity @xmath279 by 2% for these two cases .",
    "again , no such adjustment was required for the large grid .    in fig .",
    "[ bin_contour ] we show contour plots of the rest density @xmath76 at half period intervals for the large grid simulation in the rotating frame .",
    "the three - velocity of the fluid is represented by the arrows .",
    "the fact that the different panels look almost identical indicates how well the binary remains in its circular orbit .    imposing the outer boundaries at smaller separations",
    "we were unable to keep the binary in circular orbit . in fig .",
    "[ bin_sep ] we plot the coordinate separation @xmath331 between the two points of maximum density for all three simulations as a function of time  @xcite . for the small grid in the inertial frame ,",
    "the two stars start to drift apart after a very short time . when performing the same simulation in a rotating frame , the stars remained in binary orbit for about two periods , but ultimately merge .",
    "this merger is triggered by the development of orbital eccentricity .",
    "when we compare this small grid run with the large grid simulation , we see that the eccentricity is greatly reduced @xcite .",
    "this result seems to validate the quasi - equilibrium approach to obtaining reasonable initial data for corotating neutron star binaries in circular equilibrium and underlies the importance of the boundary proximity effect in these simulations .",
    "= 3.0 in    = 3.0 in    we show more diagnostics of these runs in figs .",
    "[ bin_adm ] through [ bin_gamma ] . in fig .",
    "[ bin_adm ] we show the rest mass @xmath169 , gravitational mass @xmath168 , and angular momentum @xmath170 for the three different simulations .",
    "the use of a rotating frame , which minimizes fluid advection through the numerical grid , leads to large improvements , especially in the conservation of angular momentum .",
    "close outer boundaries lead to considerable numerical error .",
    "the system loses mass and angular momentum through the emission of gravitational radiation , but at a rate that should lead to smaller deviations than we find in our simulations .",
    "the maximum variation of the rest mass , gravitational mass , and angular momentum for the large grid run over the first two orbits was @xmath332 , @xmath332 , and @xmath333 respectively .",
    "= 3.0 in    = 3.0 in    in fig .",
    "[ bin_rho ] we show the maximum rest density @xmath76 and the minimum value of the lapse @xmath3 as functions of time .",
    "the small oscillations correspond to the fundamental mode of the individual neutron stars , which are induced by the truncation error of the finite grid resolution .",
    "the period of the oscillations @xmath334 agrees well with the theoretical value of @xmath335 ( see fig .  32 in @xcite ) .",
    "these oscillations are not damped , since for these runs we switched off the linear viscosity terms ( @xmath336 ) .",
    "= 3.0 in    we monitor the hamiltonian ( [ hamiltonian_bssn ] ) , momentum ( [ momentum_bssn ] ) , and gamma ( [ gamma_bssn ] ) constraints in figs .",
    "[ bin_constr]-[bin_gamma ] .",
    "we show the l2 norms of the corresponding constraint violations . for the hamiltonian and momentum constraint , these violations are normalized with respect to @xmath337 and @xmath338 evaluated at @xmath274 ( see eqs .",
    "( [ hnorm ] ) and ( [ mnorm ] ) ) . in figure [ bin_ch ]",
    "we show the small - grid rotating - frame result for the hamiltonian constraint violation ( solid line ) , as well as the result from a similar small - grid evolution in which we set @xmath339 ( dashed line )  @xcite .",
    "the difference between these two lines illustrates the effect of the addition of this particular term in eq .",
    "( [ phi_nevolve ] ) on the conservation of the hamiltonian constraint .",
    "the constraint deviations @xmath340 , which are particularly sensitive to the choice of spatial gauge , remain well behaved during the first two orbits in these evolutions with the gamma - driver .    as this example demonstrates , our code is able to stably evolve binaries in stable , quasi - circular orbits for over two orbital periods . in a forthcoming paper @xcite",
    "we will use this code to systematically study binary sequences , both to dynamically locate the isco and to test how accurately currently available quasi - equilibrium initial data represent binaries in quasi - circular orbit .",
    "we have tested our 3 + 1 relativistic hydrodynamics code on a variety of problems .",
    "we find that our current algorithm , supplemented by driver gauge conditions , is rather robust .",
    "the grid resources required for stable evolution and reasonable accuracy are modest .",
    "we accurately evolve shock tubes , spherical dust collapse , and relativistic spherical polytropes .",
    "we also evolved uniformly and differentially rotating equilibrium polytropes , and maintained stable configurations stationary for several rotational periods .",
    "two applications carried out with our code are particularly significant .",
    "first , we examined the collapse from large radius of a star with significant spin to a kerr black hole .",
    "second , we evolved stable binary neutron stars for several orbits , maintaining quasi - circular equilibrium .",
    "the first application indicates that we can study the effects of angular momentum on gravitational collapse and on the resulting waveform , an effort already initiated in @xcite .",
    "the second application indicates that we can identify and evolve dynamically stable quasi - circular neutron star binaries .",
    "this ability can be used to locate the isco dynamically and to follow the transition from an inspiral to a plunge trajectory . in addition",
    ", dynamic simulation allows us to improve binary initial data , for example by allowing initial `` junk '' gravitational radiation to propagate away .",
    "we also hope to compute detailed gravitational waveforms form these binaries , refining the wavetrains reported in @xcite .",
    "we note that several challenges remain to be addressed before there exists a code capable of modeling all the gravitational wave sources of current astrophysical interest .",
    "one problem is the need to maintain adequate grid coverage of the collapsing star or inspiralling binary while still keeping the outer boundaries sufficiently distant , i.e. the problem of dynamic range .",
    "adaptive mesh techniques far more sophisticated than the crude rezoning used here may be necessary .",
    "a related problem concerns gravitational wave extraction , as it currently is not possible to place outer boundaries in the wave zone .",
    "finally , the formation of black hole singularities in hydrodynamic collapse scenarios remains an additional challenge to determining the late - term behavior of such systems .",
    "special singularity - handling techniques , such as excision , need to be developed further .",
    "it is a pleasure to thank masaru shibata and hwei - jang yo for useful discussions .",
    "most of the calculations were performed at the national center for supercomputing applications at the university of illinois at urbana - champaign ( uiuc ) .",
    "this paper was supported in part by nsf grants phy-0090310 and phy-0205155 and nasa grant nag 5 - 10781 at uiuc and nsf grant phy 01 - 39907 at bowdoin college .",
    "solving eqs .  ( [ evolve_rhostar])-([evolve_stilde ] ) requires solving equations of the form @xmath341 let us finite difference this equation .",
    "let @xmath342 be the value of @xmath343 at gridpoint @xmath123 on time level @xmath48 .",
    "let @xmath59 be the coordinate distance between neighboring gridpoints , and @xmath57 be the timestep .",
    "the courant factor is @xmath58",
    ". then we difference ( [ advection_eq ] ) , say for the predictor step , as @xmath344\\ ] ] where @xmath345 in ( [ q_iface ] ) , @xmath346 where @xmath347 . in many van leer schemes , the term @xmath348 in eq .",
    "( [ q_iface ] ) is replaced by the time - averaging expression @xmath349 .",
    "since we use a predictor - corrector method , we do nt need to time average .",
    "here we recover the newtonian euler equation in a rotating frame , as given for instance in @xcite , taking the weak - field limit of the general relativistic euler equation .",
    "all variables and differential operators are given in the rotating frame , with the exception of `` barred '' quantities that reside in the inertial frame .",
    "for simplicity , we will work with the general relativistic euler equation written as a function of the variable @xmath350 , defined as @xmath351 accordingly , we have @xmath352 where @xmath100 and @xmath353 are defined in sec .",
    "( [ hydro_equations ] ) .",
    "using the continuity equation ( [ continuity ] ) we can re - write the lhs of equation ( [ greuler ] ) as @xmath354 to obtain the newtonian limit , we expand the different terms in equation ( [ greuler ] ) to first order in the newtonian potential @xmath355 and the square of the fluid velocity @xmath356 . for instance : @xmath357 where @xmath358 is the shift vector in a inertial frame , @xmath359 is the angular velocity of the rotating frame with respect to the inertial frame , and @xmath159 is the position vector .",
    "the limits ( [ limits_1 ] ) combined with equation ( [ ulk ] ) give @xmath360    we proceed now to take the newtonian limit of the rhs of eq .",
    "( [ eq0 ] ) . to do so",
    ", we note that @xmath361 since @xmath362 , and @xmath363 these conditions together with equation give ( [ eq0 ] ) give the newtonian limit of the lhs of equation ( [ greuler ] ) @xmath364    to work on the rhs of equation ( [ greuler ] ) to newtonian order , we derive the following limits using eqs .",
    "( [ limits_1 ] ) , again keeping only the first order terms in @xmath355 and @xmath365 : @xmath366 the final term is composed using ( [ ulkn ] ) : @xmath367 we rewrite the first term above as @xmath368 and the second term as @xmath369    combining ( [ eq0_lhs ] ) , ( [ eq3 ] ) , ( [ eq4 ] ) , and ( [ eq5 ] ) , yields @xmath370 rearranging terms and replacing @xmath371 by its limit the mass density @xmath17 yields the newtonian limit of the general relativistic euler equation ( [ greuler ] ) : @xmath372 where the last two terms of the rhs correspond to the familiar coriolis and centrifugal force terms .",
    "in this appendix , the `` barred '' fields represent variables in the inertial frame , while the non - barred ones are quantities in rotating frames . in sec .",
    "[ diag ] , we defined the total mass and angular momentum of an asymptotically flat spacetime by two surface integrals ( eqs .",
    "( [ mdef ] ) and ( [ jdef ] ) respectively ) which characterize the asymptotic behavior of the metric on a time slice .",
    "these surface integrals were transformed into the volume integrals ( [ mfin ] ) and ( [ jfin ] ) according to the calculation described in  @xcite .",
    "these volume integrals are numerically evaluated in our code on the computational grid . when working in rotating frames",
    ", one might worry that these integrals do not apply , since the 4-metric is not asymptotically flat due to the @xmath373 term in the shift .",
    "it turns out that this is not a problem , since the surface integral formulae for @xmath168 and @xmath170 can be obtained assuming only that the 3-metric and extrinsic curvature are asymptotically flat  @xcite .",
    "therefore , we can evaluate the volume integrals ( [ mfin ] ) and ( [ jfin ] ) in the rotating frame and be sure that the @xmath168 and @xmath170 that we find at a given time will be the same as what we would have found by transforming into an inertial frame and then computing the integrals . we can see this explicitly by transforming the integrands from an inertial to a rotating frame .",
    "for example , the mass ( [ mfin ] ) written in terms of the `` barred '' inertial frame quantities is @xmath374 for simplicity , we take the inertial coordinate system to be the one which is instantaneously aligned with our rotating frame at the time that we are computing @xmath168 and @xmath170",
    ". then the transformation is given by eqs .",
    "( [ rot_fields ] ) , ( [ rot_matter ] ) , and ( [ spatial_tensor ] ) .",
    "( from eq .",
    "( [ rho_def ] ) , we see that @xmath17 is an invariant . )",
    "applying these rules , we see that every term in the integrand is identical in the inertial and rotating frames . the same is true of the integrands for @xmath170 and @xmath169 .                ya .",
    "b. zeldovich and m. a. podurets , sov",
    ". astron . *",
    "18 * , 17 ( 1965 ) ; s. l. shapiro and s. a. teukolsky , astrophys . j. lett . * 292 * , l41 ( 1985 ) ; g. d. quinlan and s. l. shapiro , astrophys . j. * 343 * , 725 ( 1989 ) .",
    "m. j. rees , in _ black holes in binaries and galactic nuclei _ , eds . l.  kaper , e.  p.  j.  van den heurel , and p.  a.  .woudt ( new york : springer - verlag , 2001 ) ; m. saijo , t. w. baumgarte , s. l. shapiro , and m. shibata , astrophys . j. * 569 * , 349 ( 2002 ) ; m. shibata and s. l. shapiro , astrophys . j. lett .",
    "* 572 * , l39 ( 2002 ) .",
    "m. parashar and j. c. brown , in _ proceedings of the international conference for high performance computing _ , eds . s. sahni , v. k. prasanna and v. p. bhatkar ( tata mcgraw - hill , new york , 1995 ) , also www.caip.rutgers.edu/@xmath376parashar / dagh/.    s. balay , w. d. gropp , l. c. mcinnes , and b. f. smith , `` efficient management of parallelism in object oriented numerical sofware libraries '' , in _ modern software tools in scientific computing _ , edited by e. arge , a. m. bruaset and h. p. langtangen , p.  163",
    ", birkhauser press , 1997 ; see also the petsc home page http://www.mcs.anl.gov/petsc .",
    "j. w. york , jr .",
    "lett . * 82 * , 1350 ( 1999 ) . g. b. cook , living rev . rel . * 5 * , 1 ( 2000 ) . t. w. baumgarte , g. b. cook , m. a. scheel , s. l. shapiro , and s. a. teukolsky , phys .",
    "d * 57 * , 6181 ( 1998 ) .",
    "t. mora and c. m. will ( gr - qc/0208089 ) show that a small eccentricity may be present in some binary black hole initial data sets .",
    "our results seem to indicate that for our binary neutron star simulations , the dominant source of spurious eccentricity is an insufficiently distant outer boundary .",
    "this comparison run was performed in a small grid due to the huge computational resources consumed by large grid runs .",
    "however , the difference between the two curves is similar to the one obtained when comparing two small grid runs ."
  ],
  "abstract_text": [
    "<S> we solve einstein s field equations coupled to relativistic hydrodynamics in full 3 + 1 general relativity to evolve astrophysical systems characterized by strong gravitational fields . </S>",
    "<S> we model rotating , collapsing and binary stars by idealized polytropic equations of state , with neutron stars as the main application . </S>",
    "<S> our scheme is based on the bssn formulation of the field equations . </S>",
    "<S> we assume adiabatic flow , but allow for the formation of shocks . </S>",
    "<S> we determine the appearance of black holes by means of an apparent horizon finder . </S>",
    "<S> we introduce several new techniques for integrating the coupled einstein - hydrodynamics system . </S>",
    "<S> for example , we choose our fluid variables so that they can be evolved without employing an artificial atmosphere . </S>",
    "<S> we also demonstrate the utility of working in a rotating coordinate system for some problems . </S>",
    "<S> we use rotating stars to experiment with several gauge choices for the lapse function and shift vector , and find some choices to be superior to others . </S>",
    "<S> we demonstrate the ability of our code to follow a rotating star that collapses from large radius to a black hole . </S>",
    "<S> finally , we exploit rotating coordinates to evolve a corotating binary neutron star system in a quasi - equilibrium circular orbit for more than two orbital periods . </S>"
  ]
}