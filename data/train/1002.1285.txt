{
  "article_text": [
    "image registration is an essential operation in a variety of medical imaging applications including disease diagnosis , longitudinal studies , data fusion , image segmentation , image guided therapy , volume reconstruction , pathology detection , and shape measurement  ( @xcite ) .",
    "it is the process of finding a geometric transformation between a pair of scenes , the _ source scene _ and the _ target scene _ , such that the similarity between the transformed source scene ( _ registered source _ ) and target scene becomes optimum .",
    "there are many challenges in the registration of medical images . among these ,",
    "those that stem from the artifacts associated with images include the presence of noise , interpolation artifacts , intensity non - uniformities , and intensity non - standardness .",
    "although considerable research has gone into addressing the effects of noise  ( @xcite ) , interpolation  ( @xcite ) , and non - uniformity in image registration  ( @xcite ) , little attention has been paid to study the effects of image intensity standardization / non - standardness in image registration .",
    "this aspect constitutes the primary focus of this paper .",
    "mr image intensities do not possess a tissue specific numeric meaning even in images acquired for the same subject , on the same scanner , for the same body region , by using the same pulse sequence  ( @xcite ) .",
    "not only a registration algorithm needs to capture both large and small scale image deformations , but it also has to deal with global and local image intensity variations . the lack of a standard and quantifiable interpretation of image intensities may cause the geometric relationship between homologous points in mr images to be affected considerably .",
    "current techniques to overcome these differences / variations fall into two categories .",
    "the first class of methods uses intensity modelling and/or attempts to capture intensity differences during the registration process .",
    "the second group constitutes post processing methods that are independent of registration algorithms .",
    "notable studies that have attempted to solve this problem within the first class are  ( @xcite ) .",
    "while global intensity differences are modelled with a linear multiplicative term in  ( @xcite ) , local intensity differences are modelled with basis functions . in  ( @xcite ) ,",
    "a locally affine but globally smooth transformation model has been developed in the presence of intensity variations which captures intensity variations with explicitly defined parameters . in  ( @xcite ) , intensities of one image are mapped into those of another via an adaptive transformation function . although incorporating intensity modelling into the registration algorithms improves the accuracy , simultaneous estimation of intensity and geometric changes can be quite difficult and computationally expensive .    the papers that belong to the second group of methods are  ( @xcite ) in which a two - step method is devised for standardizing the intensity scale in such a way that for the same mri protocol and body region , similar intensities achieve similar tissue meaning .",
    "the methods transform image intensities non - linearly so that the variation of the overall mean intensity of the mr images within the same tissue region across different studies obtained on the same or different scanners is minimized significantly .",
    "furthermore , the computational cost of these methods is considerably small in comparison to methods belonging to the first class .",
    "once tissue specific meanings are obtained , quantification and image analysis techniques , including registration , segmentation , and filtering , become more accurate .",
    "the non - standardness issue was first demonstrated in  ( @xcite ) where a method was proposed to overcome this problem .",
    "the new variants of this method are studied in  ( @xcite ) .",
    "numerical tissue characterizability of different tissues is achieved by standardization and it is shown that this can significantly facilitate image segmentation and analysis in  ( @xcite ) . combined effects of non - uniformity correction and standardization",
    "are studied in  ( @xcite ) and the sequence of operations to produce the best overall _ image quality _ is studied via an interplaying sequence of non - uniformity correction and standardization methods . in",
    "( @xcite ) , an improved standardization method based on the concept of generalized scale is presented . in  ( @xcite ) , the performance of standardization methods is compared with the known tissue characterizing property of magnetization transfer ratio ( mtr ) imaging and it is demonstrated that tissue specific intensities may help characterizing diseases .",
    "the motivation for the research reported in this paper is the preliminary indication in  ( @xcite ) of the potential impact that intensity standardization may have on registration accuracy .",
    "currently no published study exists that has examined how intensity non - standardness alone may affect registration .",
    "the goal of this paper is , therefore , to study the effect of non - standardness on registration in isolation . toward this goal , first intensity non",
    "- uniformities are corrected in a set of images , and subsequently , they are standardized to yield a `` clean set '' of images .",
    "different levels of non - standardness are then introduced artificially into these images which are then subjected to known levels of affine deformations .",
    "the clean set is also subjected to the same deformations .",
    "the deformed images with and without non - standardness are separately registered to clean images and the differences in their registration accuracy are quantified to express the influence of non - standardness .",
    "the underlying methods are described in section ii and the analysis results are presented in section iii .",
    "section iv presents some concluding remarks .",
    "we represent a 3d image , called _ scene _ for short , by a pair @xmath0 where @xmath1 is a finite 3d array of voxels , called _ scene domain _ of @xmath2 , covering a body region of the particular patient for whom image data @xmath2 are acquired , and @xmath3 is an intensity function defined on @xmath1 , which assigns an integer intensity value to each voxel @xmath4 .",
    "we assume that @xmath5 for all @xmath4 and @xmath6 if and only if there are no measured data for voxel @xmath7 .    in dealing with standardization issues ,",
    "the body region and imaging protocol need to be specified .",
    "all images that are analyzed for their dependence on non - standardness for registration accuracy are assumed to come from the same body region @xmath8 and acquired as per the same acquisition protocol @xmath9 .",
    "the non - standardness phenomenon is predominant mainly in mr imaging .",
    "hence , all image data sets considered in this paper pertain to mri .",
    "however , the methods described here are applicable to any modality where this phenomenon occurs ( such as radiography and electron microscopy ) .",
    "there are six main components to the methods presented in this paper : ( 1 ) intensity non - uniformity correction , referred to simply as _ correction _ and denoted by an operator @xmath10 ; ( 2 ) intensity standardization denoted by an operator @xmath11 ; ( 3 ) an affine transformation of the scene , denoted by @xmath12 used for the purpose of creating mis - registered scenes ; ( 4 ) introduction of artificial intensity non - standardness denoted by the operator @xmath13 ; ( 5 ) an affine scene transformation that is intended to register a scene with its mis - registered version ; ( 6 ) evaluation methods used to quantify the goodness of scene registration .    super scripts @xmath14 and @xmath15 are used to denote , respectively , the scenes resulting from applying correction , standardization , introduction of non - standardness , mis - registration , and registration operations to a given scene .",
    "examples : @xmath16 .",
    "when a registration operation @xmath17 is applied to a scene @xmath2 , the target scene to which @xmath2 is registered will be evident from the context .",
    "the same notations are extended to sets of scenes .",
    "for example , if @xmath18 is a given set of scenes for body region @xmath8 and protocol @xmath9 , then @xmath19 , where @xmath20    our approach to study the effect of non - standardness on registration is as follows :    ( s1 ) take a set @xmath18 of scenes , pertaining to a fixed @xmath8 and @xmath9 , but acquired from different subjects in routine clinical settings .",
    "( s2 ) apply correction followed by standardization to the scenes in @xmath18 to produce the set @xmath21 of _ clean scenes_. @xmath21 is as free from non - uniformities , and more importantly , from non - standardness , as we can practically make . as justified in  ( @xcite ) , the best order and sequence of these operations to employ in terms of reducing non - uniformities and non - standardness is @xmath10 followed by @xmath22 .",
    "this is mainly because any correction operation introduces its own non - standardness .",
    "( s3 ) apply different known levels of non - standardness to the scenes in @xmath21 to produce the set @xmath23 .",
    "( s4 ) apply different known levels of affine deformations @xmath12 to the scenes in @xmath23 to form the scene set @xmath24 .",
    "apply the same deformations to the clean scenes in the set @xmath21 to create @xmath25 . in this manner for any scene @xmath26",
    ", we have the same scene after applying some non - standardness and the same deformation @xmath12 , namely @xmath27 .",
    "( s5 ) register each scene @xmath26 to @xmath28 and determine the required affine deformation @xmath29 ( the subscript s indicates  standardized \" ) . similarly register each @xmath26 to @xmath30 and determine affine deformation @xmath31 ( ns for  not standardized \" ) needed .",
    "( s6 ) analyze the deviations of @xmath29 and @xmath31 from the true applied transformation @xmath12 over all scenes and as a function of the applied level of non - standardness and affine deformations .",
    "in the rest of this section , steps s1-s6 are described in detail .    _",
    "s1 : data sets _ + two separate sets of image data ( i.e. , two sets @xmath18 ) are used in this study , both brain mr images of patients with multiple sclerosis , one of them being a t2 weighted acquisition , and the other , a proton density ( pd ) weighted set , with the following acquisition parameters : fast spin echo sequence , 1.5 t ge signa scanner , tr=2500 _ msec _ , voxel size 0.86x0.86x3 @xmath32 . each of the two sets is composed of 10 scenes .",
    "since the two data sets for each patient are acquired in the same session with the same repetition time but by capturing different echos @xmath33 , the t2 and pd scenes for each patient can be assumed to be in registration .    _",
    "non - uniformity correction , standardization _",
    "+ for non - uniformity correction , we use the method based on the concept of local morphometric scale called g-_scale _",
    "( @xcite ) . built on fuzzy connectedness principles , the g-_scale _ at a voxel @xmath7 in a scene",
    "@xmath2 is the largest set of voxels fuzzily connected to @xmath7 in the scene such that all voxels in this set satisfy a predefined homogeneity criterion .",
    "since the g-_scale _ set represents a partitioning of the scene domain @xmath1 into fuzzy connectedness regions by using a predefined homogeneity criterion , resultant g-_scale _ regions are locally homogeneous , and spatial contiguity of this local homogeneity is satisfied within the g-_scale _ region .",
    "g-_scale _ based non - uniformity correction is performed in a few steps as follows .",
    "first , g-_scale _ for all foreground voxels is computed .",
    "second , by choosing the largest g-_scale _ region , background variation is estimated .",
    "third , a correction is applied to the entire scene by fitting a second order polynomial to the estimated background variation .",
    "these three steps are repeated iteratively until the largest g-_scale _ region found is not significantly larger than the previous iteration s largest g-_scale _ region .",
    "standardization is a pre - processing technique which maps non - linearly image intensity gray scale into a standard intensity gray scale through a training and a transformation step . in the training step ,",
    "a set of images acquired for the same body region @xmath8 as per the same protocol @xmath9 are given as input to _",
    "learn _ histogram - specific parameters . in the transformation step ,",
    "any given image for @xmath8 and @xmath9 is standardized with the estimated histogram - specific landmarks obtained from the training step . in the data sets considered for this study , @xmath34 and @xmath9 represents two different protocols , namely t2 and pd .",
    "the training and transformation steps are done separately for the two protocols .",
    "the basic premise of standardization methods is that , in scenes acquired for a given @xmath35 , certain tissue - specific landmarks can be identified on the histogram of the scenes .",
    "therefore , by matching the landmarks , one can standardize the gray scales .",
    "median , mode , quartiles , and deciles , and intensity values representing the mean intensity in each of the largest few g-_scale _ regions have been used as landmarks . additionally , to handle outliers , a `` low '' and `` high '' intensity value ( selected typically at 0 and 99.8 percentiles )",
    "are also selected as landmarks .    in the training step ,",
    "the landmarks are identified for each training scene specified for @xmath36 and intensities corresponding to the landmarks are mapped into an assumed standard scale .",
    "the mean values for these mapped landmark locations are computed . in the transformation step ,",
    "the histogram of each given scene @xmath2 to be standardized is computed , and intensities corresponding to the landmarks are determined .",
    "sections of the intensity scale of @xmath2 are mapped to the corresponding sections of the standard scale linearly so that corresponding landmarks of scene @xmath2 match the mean landmarks determined in the training step .",
    "( the length of the standard scale is chosen in such a manner that the overall mapping is always one - to - one and no two intensities in @xmath2 map into a single intensity on the standard scale . )",
    "note that the overall mapping is generally not a simple linear scaling process but , indeed , a non - linear ( piece - wise linear ) operation ; see  ( @xcite ) for details . in the present study ,",
    "standardization is done separately for t2 and pd scenes .    _",
    "s3 . applying non - standardness _",
    "+ to artificially introduce non - standardness into a _ clean scene _",
    "@xmath37 , we use the idea of the inverse of the standardization mapping described in  ( @xcite ) .",
    "a typical standardization mapping is shown in figure  [ img : mapping ] . in this figure , only three landmarks are considered - `` low '' and `` high '' intensities @xmath38 and @xmath39 and the median @xmath40 corresponding to the foreground object .",
    "there are two linear mappings : the first from @xmath41 $ ] to @xmath42 $ ] and the second from @xmath43 $ ] to @xmath44 $ ] .",
    "@xmath45 $ ] denotes the standard scale .",
    "the horizontal axis denotes the non - standard input scene intensity and vertical axis indicates the standardized output scene intensity . in inverse mapping ,",
    "since @xmath46 has already been standardized , the vertical axis can be considered as the input scene intensity , @xmath47 , and the horizontal axis can be considered as the output scene intensity , @xmath48 , where mapping the _ clean scene _ through varying the slopes @xmath49 and @xmath50 results in non - standard scenes . by using the values of @xmath49 and @xmath50 within the range of variation observed in initial standardization mappings of corrected scenes ,",
    "the non - standard scene intensities can be obtained by @xmath51 where @xmath52 converts any number y@xmath53 to the closest integer y , and @xmath54 denotes the median intensity on the standard scale .    [ cols=\"^ \" , ]     \\(a ) ( b ) ( c )    based on the fact that similarity of a pair of registered _",
    "clean scenes _ is higher than the similarity of a pair of registered non - standard scenes , it can be deduced that substantially improved uniformity of tissue meaning between two scenes of the same subject being registered improves registration accuracy .",
    "our experimental results demonstrate that scenes are registered better whenever the same tissues are represented by the same intensity levels .",
    "we note that , in both tables , most of the entries are less than 1 .",
    "this indicates that in both accuracy and consistency tests , the standardized scene registration task wins over the registration of non - standard scenes .",
    "table  [ table : goodness ] on its own does not convey any information about what the actual accuracies in the winning cases are , or about whether the win happens for t2 scenes only , pd only , or for both .",
    "the fact that a majority of the corresponding cells in these tables both indicate wins suggests that accuracy - based wins happen for both t2 and pd scenes .",
    "conversely , a favorable @xmath55 value in table  [ table : goodness2 ] does not convey any information about whether the high consistency indicated also signals accuracy .",
    "thus , accuracy and consistency are to some extent independent factors , and they together give us a more complete picture of the influence of non - standardness on registration .",
    "we described a controlled environment for determining the effects of intensity standardization on registration tasks in which the best image quality ( _ clean scene _ ) was established by the sequence of correction operation followed by standardization .",
    "we introduced several different levels of non - standardness into the _ clean scenes _ and performed nearly 20,000 registration experiments for small , medium and large scale deformations .",
    "we compared the registration performance of _ clean scenes _ with the performance of scenes with non - standardness and summarized the resulting goodness values . from overall accuracy and consistency test results in tables  [ table : goodness ] and",
    "[ table : goodness2 ] , we conclude that intensity variation between scenes degrades registration performance . having tissue specific numeric meaning in intensities maximizes the similarity of images which is the essence of the optimization procedure in registration .",
    "standardization is therefore strongly recommended in the registration of images of patients in any longitudinal and follow up study , especially when image data come from different sites and different scanners of the same or different brands .    in this paper",
    ", we introductorily addressed the problem of the potential influence of intensity non - standardness on registration .",
    "this is indeed a small segment of the much larger full problem : unlike the specific intra - modality ( or intra protocol ) registration task considered here , there are many situations in which the source and the target images may be from different modalities or protocols ( e.g. , ct to mri , pet to mri , and t1 to t2 registration etc . ) , and each such situation may have its own theme of non - standardness .",
    "further , these themes may depend on the body region , the scanner , and its brand .",
    "we determined that a full consideration of these aspects was just beyond the scope of this paper . since the sum of squared differences is one of the most appropriate similarity metrics for intra - modality registration , we focused on this metric in our study .",
    "but , clearly , more studies of this type in the more general settings mentioned above are needed .",
    "thus far , we controlled the computational environment via two factors : standardization and correction .",
    "a third important factor , noise , can be also embedded into the framework .",
    "it is known that correction itself introduces non - standardness into the scenes and it also enhances noise .",
    "investigating the interrelationship between correction and noise suppression algorithms and determining the proper order for these operations has been studied recently  ( @xcite ) .",
    "a question immediately arises as to how standardization affects registration accuracy for different orders of correction and noise filtering . based on the study in  ( @xcite )",
    ", we may conclude that non - uniformity correction should precede noise suppression and that standardization should be the last operation among the three to obtain best image quality .",
    "however , it remains unclear as to how a combination of deterministic methods ( standardization and correction ) affects a random phenomenon like noise .",
    "it is thus important to study these three phenomena in the future on their own or in relation to how they may influence the registration process , especially in multi - center studies wherein data come from different scanners and brands of scanners .",
    "this paper is presented in spie medical imaging - 2010 .",
    "the complete version of this paper is published in elsevier pattern recognition letters , vol(31 ) , pp.315323 , 2010 .",
    "baci , u. , bai , l. , 2007 .",
    "multiresolution elastic medical image registration in standard intensity scale . in : sibgrapi 07 : proceedings of the xx brazilian symposium on computer graphics and image processing ( sibgrapi 2007 ) , pp .",
    "305312 .",
    "ge , y. , udupa , j. , nyul , l. , wei , l. , grossman , r. , november 2000 . numerical tissue characterization in ms via standardization of the mr image intensity scale . journal of magnetic resonance imaging 12  ( 5 ) , pp",
    ". 715721 .",
    "guimond , a. , roche , a. , ayache , n. , meunier , j. , january 2001 .",
    "three - dimensional multimodal brain warping using the demons algorithm and adaptive intensity corrections .",
    "ieee transactions on medical imaging 20  ( 1 ) , pp",
    ". 5869 .",
    "holden , m. , hill , d. , denton , e. , jarosz , j. , cox , t. , rohlfing , t. , goodey , j. , hawkes , d. , february 2000 .",
    "voxel similarity measures for 3-d serial mr brain image registration .",
    "ieee transactions on medical imaging 19  ( 2 ) , pp . 94102 .",
    "knops , z. , maintz , j. b.  a. , viergever , m.  a. , pluim , j. p.  w. , june 2006 .",
    "normalized mutual information based registration using k - means clustering and shading correction .",
    "medical image analysis 10  ( 3 ) , pp .",
    "432439 .",
    "madabhushi , a. , udupa , j. , moonis , g. , 2006 .",
    "comparing mr image intensity standardization against tissue characterizability of magnetization transfer ratio imaging .",
    "journal of magnetic resonance imaging 24  ( 3 ) , pp .",
    "667675 .",
    "madabhushi , a. , udupa , j. , souza , a. , february 2005 .",
    "generalized scale : theory , algorithms , and application to image inhomogeneity correction . computer vision and image understanding 101  ( 2 ) , pp . 100121 .",
    "udupa , j.k . ,",
    "odhner , d. , samarasekera , s. , goncalves , r.j . ,",
    "iyer , k. , venugopal , k.p . ,",
    "furuie , s.s . , 1994 .",
    "3dviewnix : an open , transportable , multidimensional , multi - modality , multi - parametric imaging software system . in : proceedings of spie : medical imaging .",
    "2164 . pp ."
  ],
  "abstract_text": [
    "<S> acquisition - to - acquisition signal intensity variations ( non - standardness ) are inherent in mr images . </S>",
    "<S> standardization is a post processing method for correcting inter - subject intensity variations through transforming all images from the given image gray scale into a standard gray scale wherein similar intensities achieve similar tissue meanings . </S>",
    "<S> the lack of a standard image intensity scale in mri leads to many difficulties in tissue characterizability , image display , and analysis , including image segmentation . </S>",
    "<S> this phenomenon has been documented well ; however , effects of standardization on medical image registration have not been studied yet . in this paper , we investigate the influence of intensity standardization in registration tasks with systematic and analytic evaluations involving clinical mr images . </S>",
    "<S> we conducted nearly 20,000 clinical mr image registration experiments and evaluated the quality of registrations both quantitatively and qualitatively . </S>",
    "<S> the evaluations show that intensity variations between images degrades the accuracy of registration performance . </S>",
    "<S> the results imply that the accuracy of image registration not only depends on spatial and geometric similarity but also on the similarity of the intensity values for the same tissues in different images . </S>"
  ]
}