{
  "article_text": [
    "scintillators are a key component of many neutrino and dark matter experiments due to their relatively low cost and high light yield . in addition",
    ", many scintillators can be used for particle identification when the time profile of the scintillation light is sensitive to the energy loss characteristics of different particles .",
    "experiments that require low energy thresholds , high energy resolution , and/or high levels of background rejection often combine a scintillating target medium with an array of photomultiplier tubes ( pmts ) and a data acquisition system with sensitivity to individual photoelectrons . in order to fully capture the scintillation time profile ,",
    "the pmt pulses are typically recorded using a waveform digitizer .",
    "many common scintillators produce light on at least two characteristic time scales .",
    "particle identification in such scintillation detectors employs two related features : the scintillation time scales , and the probability of populating the different time scales , which depends on the particle s energy loss characteristics",
    ". the canonical approach ( examples include microclean @xcite , deap-1 @xcite , xmass @xcite , xenon-10 @xcite , gerda @xcite , kamland @xcite ) to time - based particle identification with a digitized time - dependent voltage waveform @xmath0 is to estimate the fraction of the light produced on a fast timescale relative to the total amount of light produced in the event .",
    "this particle discriminant we refer to as the prompt - fraction , or @xmath1 , and is defined as @xmath2 where @xmath3 is some time before the prompt peak , @xmath4 is the time defined by the end of the event window , and @xmath5 depends on the timing characteristics of the scintillator . typically the @xmath1parameter is used to place a cut or perform some likelihood - based analysis in order to select a certain class of interactions in the scintillator . in later sections ,",
    "we refer to @xmath1 _ leakage _ as the probability of events from a certain class of background leaking into the @xmath1signal region of interest .",
    "although particle identification with @xmath1is robust in the sense that it is fairly insensitive to fluctuations in the scintillation light production or pmts , its discrimination power breaks down at low energies beyond statistical effects because it loses information about the precise timing and charge of individual photoelectrons created by photons produced in the scintillator .",
    "the best strategy to count photoelectron ( pe ) pulses in a waveform depends on the intensity and time structure of the light , as well as the characteristics of the pmt electronics . a typical single photoelectron pulse from a large area pmt , shown for cryogenic measurements of a hamamatsu photonics r5912 - 02-mod 8 \" pmt in figure  [ fig : pmt_pulse ] , spans 20  ns or more  @xcite . additionally , there are large pulse - to - pulse variations in the amplification of a single photoelectron , resulting in a fairly broad charge distribution , shown again for the r5912 - 02-mod in figure  [ fig : charge_dist ] .",
    "if the light intensity observed by a pmt is very low or the time constant for scintillation light is very long ( hundreds of nanoseconds or more ) compared to the duration of a single photoelectron pulse , then overlap of pulses is improbable .",
    "photoelectrons can be counted by searching for peaks in the waveform , thus eliminating the impact of the pmt charge distribution on the counting procedure .",
    "single photoelectron pulse from a hamamatsu r5912 - 02-mod pmt , as digitized by a 10 ghz oscilloscope .",
    "]    however , if multiple photoelectrons are likely to be detected by a pmt in a time much shorter than the single photoelectron pulse duration , such as from cherenkov or fast scintillation light , peak finding is a poor photoelectron counting strategy .",
    "peaks from different photoelectrons may not be clearly resolved in the waveform , resulting in a systematic bias toward under - counting . a simple and unbiased technique for photoelectron counting in this case would be to integrate the waveform and divide by the mean charge of a single photoelectron . due to the broad charge distribution of most pmts , this normalized integral charge procedure in a waveform with pulse pileup will have more variance than peak counting in a waveform without pileup .",
    "fundamentally , information is lost in the pileup that is difficult to recover .    the single photoelectron charge distribution of the hamamatsu photonics r5912 - 02-mod cryogenic 8 \" pmt at a gain of @xmath6 .",
    "as described in  @xcite , the charge distribution is populated using only pulses which are adequate fits to a pulse shape model , so no assumptions about the shape of the ` pedestal ' near zero are required . ]",
    "realistic detectors typically span both of these extreme cases .",
    "many experiments observe both cherenkov or fast scintillation _ and _ slow scintillation light .",
    "moreover , the light intensity observed by a given pmt can vary dramatically depending on the energy of the event and its location in the detector . to cover all these cases ,",
    "we have designed a photoelectron counting method that combines both peak finding and normalized charge integration by using bayes theorem to incorporate our external knowledge of how likely photoelectron pileup is for different events , pmts , and times in the waveform .",
    "the method also outputs an estimated photoelectron production time for each pulse , which can be analyzed for particle identification purposes in many scintillators .    to make the discussion concrete , we focus the photoelectron identification procedure specifically on liquid argon scintillation light , primarily in the miniclean dark matter experiment , but the general approach can be easily adapted to the constraints of other experiments . in section",
    "[ sec : fp_model ] we use a gpu - based fast monte carlo simulation of the miniclean detector to motivate the need for improvement in the canonical prompt - fraction particle identification technique .",
    "the bayesian photoelectron counting method is described in section  [ sec : spe_counting ] , and improved particle identification test statistics are defined in section  [ sec : stat_tests ] .",
    "we then demonstrate the effectiveness of the bayesian photoelectron counting method in section  [ sec : results ] with gamma simulation and calibration data collected from the deap-1 detector underground at snolab . in section  [ sec : miniclean ] , we describe the miniclean dark matter experiment and motivate the need for improved particle identification specifically in large liquid argon dark matter detectors .",
    "finally , section  [ sec : sim ] applies the bayesian techniques to a complete monte carlo simulation of miniclean .",
    "laboratory searches for dark matter in the form of weakly - interacting massive particles ( wimps ) require sensitivity to nuclear recoils with tens of kev of kinetic energy .",
    "wimp - induced recoils need to be distinguished from other sources of low energy particle tracks , such as fast neutrons and radioactive decay in detector materials .",
    "dark matter experiments must simultaneously achieve very low levels of natural radioactivity and very high rejection factors for remaining sources of backgrounds .",
    "liquid argon offers a promising target for wimp detection due to its combination of extremely low cost , moderate cryogenic requirements ( similar to liquid nitrogen ) , straightforward purification techniques , and a reasonably high density and atomic number .",
    "argon is a very efficient scintillator , producing approximately 40 uv photons per kev  @xcite of deposited energy from an electron track .",
    "although very low levels of chemical impurities can be achieved with liquid argon , atmospheric argon contains 1  bq / kg of @xmath7  @xcite , a beta decay isotope with an endpoint energy of 565  kev and half - life of 269  years .",
    "the @xmath7background must be mitigated either through the acquisition of argon depleted of @xmath7 , through highly efficient identification and rejection of electronic recoils in the data , or both .",
    "`` single - phase '' liquid argon experiments search for nuclear recoil events using only scintillation light , in the absence of an electric field  @xcite .",
    "prototype detectors , such as microclean  @xcite and deap-1  @xcite , have demonstrated the performance characteristics of liquid argon scintillation detectors at the several kilogram scale .",
    "the larger scale dark matter experiments , miniclean  @xcite and deap-3600  @xcite , are currently under construction with fiducial masses of 150 kg and 1000 kg , respectively . given the exponential energy distribution of nuclear recoils from wimps , the ultimate sensitivity of these experiments will depend in part on how effectively @xmath7events can be rejected at energies of tens of kev or lower .",
    "argon scintillation is produced by the de - excitation of dimer states created by the ionization track of a particle  @xcite .",
    "there is both a short - lived singlet state , @xmath8 with a lifetime of @xmath9  ns , and a longer - lived triplet state , @xmath10 with a lifetime of @xmath11  ns  @xcite .",
    "the relative amounts of singlet and triplet states produced by a charged particle depend on both the type of recoiling particle and the energy deposited , as measured in  @xcite .",
    "this , along with the large separation of the singlet and triplet time constants , offers excellent particle identification in liquid argon as described in  @xcite . using a full simulation of the miniclean detector ( see sections  [ sec : deap1sim ] and  [ sec : sim ] ) with the above liquid argon scintillation characteristics , we have optimizedintegral bound optimization minimizes the number of electronic recoils leaking into the @xmath12 nuclear recoil acceptance region in miniclean monte - carlo . ]",
    "the integration bounds in equation  [ eq : fp ] , and we take @xmath13  ns , @xmath14  ns , and @xmath15  ns in the following sections .    the scintillation light yield of nuclear recoils in liquid argon at energies above 20  kev is @xmath16% of the light yield for electronic recoils  @xcite . we refer to energies of all types of recoils in units of _ electron equivalent _ kev ( kevee ) , where this 25% quenching factor has already been applied to energies for nuclear recoils .",
    "when referring to the full recoil energy , without quenching , we use units of kevr .",
    "in this section , we highlight the mechanisms in scintillator detectors which contribute to @xmath1leakage to motivate the potential improvement in a more sophisticated approach . in order to treat a wide variety of detector contributions to @xmath1leakage in a consistent manner",
    ", we take a predominantly monte carlo approach , assuming no functional form for any of the @xmath1distributions , except at the stage of the initial statistical fluctuations in the number of states produced .    as shown in the following",
    ", realistic detector effects can degrade the achievable @xmath1discrimination between background and signal by many orders of magnitude relative to the fundamental limit , which is set by the statistical fluctuations in the scintillation states produced .",
    "for the case considered here , 12.5  kev apparent energy liquid argon scintillation events in miniclean , the @xmath1leakage fraction with 50% signal acceptance is increased from @xmath17 with only fluctuations in the scintillation states produced to @xmath18 once all realistic detector effects are included . in this section ,",
    "we describe each of the factors that contribute to this lost rejection efficiency . in the following sections , we develop a new method that regains some of the lost rejection .    for the results in this section",
    ", we use a gpu - based fast monte carlo simulation to sample and fluctuate the properties of individual photoelectrons from thousands of events in parallel .",
    "this highly parallel approach allows us to reliably sample the tails of the @xmath1distributions over many orders of magnitude , without having to rely on extrapolation of a phenomenological model .",
    "detector optics and full simulation of the data acquisition system are bypassed in this simplified model . in sections  [ sec : results ] and",
    "[ sec : sim ] , we will present results from our full detector simulations of deap-1 and miniclean , that use a more complete model including detector optics and daq .",
    "we consider a general two - exponential scintillation model that is equivalent to , but parametrized slightly differently than , that presented in @xcite .",
    "the assumed probability density function for the production times of argon scintillation photons is @xmath19 where @xmath20 is the fraction of states produced with the short - lived time constant is sometimes called the `` prompt - fraction , '' it is not equal to the test statistic @xmath1 .",
    "] , @xmath8 , and the remaining states are produced with the longer lived time constant , @xmath10 .",
    "generally all three of these parameters depend on the energy and type of the scintillating particle . for concreteness ,",
    "we focus on scintillation in liquid argon detectors .",
    "however , this model and conclusions drawn from it are applicable to a wide range of scintillators .    for further concreteness in the fast monte carlo model",
    ", we assume the properties of the miniclean dark matter detector .",
    "the detector is described in detail in section  [ sec : miniclean ] , but its relevant scintillation characteristics are summarized in table  [ tab : detector_param ] . for the purposes of the fast monte carlo simulation , the miniclean detector is considered to be a 500  kg liquid argon target surrounded by 92 optical cassettes . each optical cassette houses a hamamatsu photonics 8  r5912 - 02-mod pmt and a 10  cm thick acrylic plug .",
    "the acrylic plug acts as a substrate for the tpb layer that converts the extreme uv argon scintillation light  @xcite to a wavelength regime where the pmts are sensitive .",
    ".basic scintillation and detector parameters for 12.5  kevee events in the miniclean detector . [ cols=\"^,^\",options=\"header \" , ]     table  [ tab : leakage ] shows the increasing leakage from an @xmath1cut as more detector effects are included in the fast monte carlo model . clearly , energy resolution is a significant factor in the leakage due to the increased singlet fraction at lower event energies .",
    "the detector energy resolution comes from a mixture of photon counting statistics , which can only be improved by increasing the light yield of the detector , and the pmt and waveform digitizer response , which can be improved with better waveform analysis techniques , as shown in the next section .",
    "several of the detector effects described in the previous section that increase the @xmath1leakage fraction can be mitigated with an analysis that can extract individual photoelectron times from the pmt waveforms .",
    "however , rather than solve a general deconvolution problem , we have instead developed an analysis that assumes the pmt waveform is produced by argon scintillation from a single recoiling particle .",
    "this prior can be incorporated into bayes theorem in order to estimate the number of photoelectrons in the waveform , and then assign times to each of the photoelectrons based on the waveform shape .",
    "the event analysis algorithm has 5 stages :    1 .",
    "time / voltage calibration of waveforms .",
    "2 .   identification of regions that contain pulses .",
    "bayesian identification of photoelectrons .",
    "4 .   reconstruction of the event position and energy .",
    "repeat of bayesian identification of photoelectrons with improved priors .",
    "these steps are explained in each of the following subsections .      with the pmt waveforms in a zero - suppressed voltage - time series , the absolute time offset of the waveforms in the event",
    "are adjusted so that the summed waveform reaches a maximum amplitude at @xmath21 . due to the shortness of the singlet time constant ,",
    "aligning based on the peak removes most of the jitter caused by the latching of the trigger , which can often be several digitizer samples or more .",
    "the voltage of each pmt waveform is separately corrected to remove any baseline offset .",
    "for this first stage of analysis , the first 4  pre - samples from each block of samples in a given channel are averaged to estimate a constant baseline that is subtracted from all the blocks in the channel . after voltage calibration , @xmath1can also be calculated for the summed pmt waveform , as it is used in the bayesian photoelectron identification stage .",
    "single photoelectron pulses from the 8 \" r5912 - 02-mod pmts typically span 20 ns , as shown in figure  [ fig : pmt_pulse ] .",
    "we scan the calibrated waveforms for each pmt separately with a sliding 12  ns ( 3 sample ) integration window and extract a _ pulse region _ whenever the integral exceeds 5 times the rms of noise samples times the square root of the number of samples in the window .",
    "once that detection threshold has been crossed , the boundaries of the pulse region are the times where the sliding window integral drops to below the rms divided by the square root of the number of samples .",
    "figure  [ fig : sliding_window ] shows the sliding window calculation applied to a pulse from 5 photoelectrons .    a typical voltage waveform from a single pmt in miniclean monte carlo simulation .",
    "the top panel shows the waveform normalized by 5 times the rms of the electronics noise profile ( black , solid ) compared to the sliding integral value normalized by the corresponding threshold ( blue , dashed ) .",
    "the sliding integration window enhances the right - skew pmt pulses relative to threshold while providing a filter for high frequency electronics noise .",
    "the bottom panel shows the pulse regions identified by the pulse finder .",
    "green shaded regions are the regions where threshold is crossed , and the gray regions indicate a buffer region that extends the pulse boundaries . if threshold is crossed again within the buffer , the pulse boundary is further extended as in the right most pulse region . ]",
    "we find that the sliding window integration method is much more sensitive to low charge pmt pulses without significantly increasing the number of false positive detections .",
    "the width and right skew of the pulses make it difficult to efficiently discriminate low charge pulses from background noise with a simple voltage threshold .",
    "an integration window , however , effectively filters out the high frequency noise while retaining the relatively low frequency pmt signal .",
    "once the samples corresponding to pulses have been identified , they are removed from the waveform , and the remaining baseline - only samples are used to estimate a local baseline for each block of samples in the original waveform . unlike in the calibration stage , the baseline computed in this stage is allowed to vary with time , thus removing any lower frequency components , for example under- or over - shoot in pmt base electronics .",
    "the new baseline is subtracted from the waveform and the entire pulse finding procedure is repeated .",
    "after two passes , the results are stable and robust against low - frequency baseline variations .      once pulse regions have been extracted from each pmt waveform , the next task is to identify how many separate photoelectron pulses are contained in each pulse region , and what their arrival times were . as discussed in section  [ sec : intro ] , two natural techniques to apply are normalized integral charge , where the integral of each pulse region is divided by the average single photoelectron charge , or peak counting , where the number of local maxima in the pulse region are counted after some filtering .",
    "charge integration is a good strategy to apply at early times , where pileup will likely make multiple peaks indistinguishable , and a poor strategy at late times , where a pulse region will almost always contain a single photoelectron , but the variance in the single photoelectron charge distribution will create large fluctuations in the estimate .",
    "conversely , peak counting is a poor strategy at early times , where it will generally undercount photoelectrons , but a good strategy at late times , where it is insensitive to charge fluctuations in single photoelectrons .",
    "bayes theorem provides a quantitative way to incorporate our knowledge of the time structure of argon scintillation light . for each pulse identified in each pmt waveform",
    "we would like to know the most probable number of photoelectrons in the pulse , @xmath22 , given that the pulse spans time @xmath23 to @xmath24 ( where @xmath23 and @xmath24 are defined by the pulse finding procedure in section  [ sec : pulse_finding ] ) and has an integrated charge of @xmath25 .",
    "the probability mass function for @xmath22 is @xmath26 where @xmath27 is used to denote a probability mass function for the number of photoelectrons , and @xmath28 denotes a probability density function for integrated charge .    the function @xmath29 is the @xmath22-photoelectron charge distribution for the pmt , which is assumed to have no dependence on the time of the pulse",
    ". the charge distribution of noise , @xmath30 , can be found by applying the pulse finding algorithm to a sample of waveforms with electronics noise only .",
    "the single photoelectron charge distribution , @xmath31 , can be measured for each pmt using a triggered , low intensity light source , as in figure  [ fig : charge_dist ] . for @xmath32 ,",
    "@xmath29 is the convolution of @xmath31 with itself @xmath22 times .",
    "our knowledge of the distribution of scintillation photons ( and therefore the probability of pileup ) enters into the equation via @xmath33 , the probability mass distribution for the number of photons in the given pulse .",
    "suppose that events of a particular class produce @xmath34 detected photoelectrons in the pmt on average with a photoelectron detection time probability density function ( pdf ) of @xmath35 .",
    "the probability mass function of observing @xmath22 photoelectrons in the time interval @xmath36 $ ] is then @xmath37 where @xmath38 is the poisson probability of observing @xmath39 photoelectrons in the entire waveform given the expected value @xmath34 , @xmath40 is the binomial probability of detecting @xmath22 photoelectrons given @xmath39 photoelectrons in the waveform , and the probability , @xmath41 , of @xmath39 photoelectrons falling in the time interval @xmath42 $ ] is defined by @xmath43 the pmt timing response ( including dark hits , double pulsing , late pulsing , etc  @xcite ) and the effects of detector optics are convolved with the scintillation time structure , equation  [ eq : scint_time ] , to include realistic detector effects in the photoelectron detection time pdf , @xmath35 .",
    "figure  [ fig : time_pdf ] shows sample time pdfs for nuclear and electronic recoils at energies of 5 and 25  kevee in the miniclean monte carlo simulation ( described in detail in section  [ sec : miniclean ] ) .",
    "the integration bounds of equation  [ eq : i ] , @xmath44 and @xmath45 , depend on the hypothesized number of photoelectrons , @xmath39 , due to finite width of the pmt pulses .",
    "for the hypothesis of a single photoelectron spanning the pulse bounds , @xmath46 to @xmath24 , the known pulse shape can be used to narrow the integration bounds in equation  [ eq : i ] to the time interval in which the scintillation photon may have been produced , @xmath47 $ ] .",
    "however , in the limit of many photoelectrons spanning the same time interval , the scintillation photons may have been produced over the entire range of the pulse , @xmath42 $ ] . in practice , we compute the cumulative distribution function of the time pdf , @xmath35 , and determine the @xmath48 and @xmath49 @xmath50-quantiles , @xmath51 and @xmath52 respectively . letting @xmath53 represent the finite width of the digitization sampling , we then take @xmath54 and @xmath55 .",
    "this gives a robust estimation of the correct integration boundaries for @xmath39 photoelectrons without requiring exact knowledge of the pmt pulse shape with @xmath39 photoelectrons piling up with random time offsets . by inserting equation  [ eq : i ] into equation  [ eq : p_n ] and equation  [ eq : p_n ] into equation  [ eq : p_n_q ]",
    ", @xmath56 can be evaluated .",
    "the selection of @xmath34 and @xmath35 for each pmt ( see figure  [ fig : time_pdf ] ) depends on our hypothesis of the particle type , position and energy , but estimating those quantities in turn requires the results of photoelectron counting . in order to bootstrap the process",
    ", we perform this first pass of the analysis assuming that @xmath34 for each pmt is equal to the total integrated charge observed by the pmt divided by the average single photoelectron charge . the time distribution for photoelectrons is estimated by using the prompt - fraction test statistic , @xmath1 , which is computed using all the pmt waveforms .",
    "separate time pdfs for the singlet and triplet photons generated with the monte carlo simulation are linearly combined to create @xmath35 according to the singlet fraction calculated from @xmath1 .",
    "a flat time distribution for pmt dark hits is then added into @xmath35 based on the relative magnitudes of the expected number of pmt dark hits and @xmath34 .",
    "as described in section  [ sec : wave_cal ] , @xmath21 for each event is defined as the peak in the waveform summed over all pmts in order to be consistent with the definition of @xmath57 as the maximum of the time pdf .",
    "photoelectron detection time pdfs for electronic and nuclear recoils at 5  kevee and 25  kevee observed energies from miniclean monte - carlo simulation ( described in detail in section  [ sec : miniclean ] ) .",
    "the peak near 60  ns is due to pmt double and late pulsing  @xcite .",
    "the energy dependence of the mean triplet fraction  @xcite is included in construction of the pdfs .",
    "the flat component in time , due to pmt dark hits , contributes a larger fraction to the signal at low energies resulting in convergence to a higher probability at late times . in the bayesian photoelectron counting procedure ,",
    "the pdfs are constructed by linear combination of the singlet and triplet components with a bootstrapped prior to using the @xmath1test statistic . ]    with these bootstrap priors , the most probable number of photoelectrons in each pulse region can be estimated as the integer @xmath22 which has maximal @xmath58 from equation  [ eq : p_n_q ] . in order to assign times to the photoelectrons , the cumulative distribution function ( cdf ) of the waveform in the region is used . for a pulse region with most probable @xmath22 photoelectrons , we determine the @xmath59-quantiles of the model cdf . each photoelectron is assigned a unique detection time equal to one of these quantiles .",
    "interpolation is used so that the quantiles can be between samples .",
    "this procedure is demonstrated in figure  [ fig : quantiles ] for a pulse region with 14 photoelectrons .",
    "0.45     0.45       given counts and times for photoelectrons detected by every pmt in the detector , more event properties can be reconstructed . with a radius of 43.7  cm ,",
    "the miniclean detector is small enough that time is a weak handle on event position , so only the number of photoelectrons observed by each pmt is used by a maximum likelihood algorithm to estimate the event position and energy .",
    "the likelihood function contains a fast , monte carlo - derived optical model of the detector ( which approximates the detailed optics of the optical cassettes ) that can predict the expected number of photoelectrons for each pmt given a hypothesized position and energy .",
    "once the fit has found the most likely event position and energy , a final set of expected numbers of photoelectron are calculated for each pmt and passed to the next stage of the analysis .      for second pass of the bayesian photoelectron calculation , we repeat the calculation described in section  [ sec : bayes_1st_pass ] , but with an estimate of @xmath34 for each pmt derived from the position and energy reconstruction stage .",
    "the estimate of the time pdf , @xmath35 , is left unchanged , except for the pmt dark hit contribution could be computed for each pmt that includes the distribution of photon propagation times for an event at the reconstructed position . ] . by replacing the crude bayesian prior from the first pass with a much more accurate one based on event reconstruction , the second pass of the algorithm can reduce the energy bias and improve the energy resolution . in principle ,",
    "additional iterations of position / energy reconstruction and bayesian photoelectron counting could be performed , but we generally find no significant improvement after 2 passes .",
    "with a set of detected photoelectron times for an event , @xmath60 , we can compute a variety of different test statistics .",
    "the simplest test statistic is a discrete version of @xmath1 , @xmath61 where @xmath5 sets the prompt window , just as in the definition of @xmath1 .",
    "the @xmath62test statistic removes some of the variance induced by the pmt charge distribution on @xmath1 , but does not take full advantage of the scintillation time structure .    a more powerful approach to separating electronic and nuclear recoils is a likelihood ratio test statistic , as was also briefly described in @xcite . by evaluating the likelihood of the observed photon detection times using time pdfs for a nuclear recoil hypothesis and an electronic recoil hypothesis , one can make better use of the full timing information from each photon .",
    "we define this second test statistic , @xmath63 , as a normalized log - likelihood difference , comparing the nuclear recoil hypothesis to the electronic recoil hypothesis .",
    "specifically , we define the test statistic to be : @xmath64 where @xmath65 , @xmath66 is the time pdf for the nuclear recoil hypothesis given an event energy @xmath67 , and @xmath68 is the time pdf for the electronic recoil hypothesis given an event energy @xmath67 .",
    "sample distributions for @xmath66 and @xmath68 are shown in figure  [ fig : time_pdf ] at 5 and 25  kevee . due to the sign convention adopted in the definition of @xmath63 , positive values are more nuclear recoil - like and negative values are more electronic recoil - like .",
    "the division by @xmath69 is a convenience to keep the range of @xmath63similar for events with different numbers of photoelectrons .",
    "the time pdfs @xmath66 and @xmath68 are computed using separate monte carlo simulations of singlet and triplet scintillation photons , which are then linearly combined according to the measured energy ( including the quenching factor where appropriate ) and particle dependence of the singlet fraction .    finally , it is always important to pair a likelihood ratio with a goodness - of - fit metric to reject events that do not conform to either hypothesis . given the time pdfs @xmath66 and @xmath68 used to compute @xmath63 , we can compute a kolmogorov - smirnov test statistic for the nuclear recoil ( @xmath70 ) and electron recoil ( @xmath71 ) hypotheses , respectively .",
    "to demonstrate the effectiveness of the bayesian photoelectron counting technique , we apply it here to data collected by the deap-1 detector between november 28 and december 9 , 2011 .",
    "deap-1 is a cylindrical detector containing 7.6 kg of liquid argon that has been operated underground at snolab since 2007 .",
    "the detector has had various configurations as an r&d platform as described in  @xcite , but the configuration in november - december 2011 is shown in figure  [ fig : deap1 ] .",
    "the central target volume is defined by a 28  cm long and 15  cm diameter acrylic cylinder that has been coated on the inside with tpb which converts 128  nm extreme uv light  @xcite into 440  nm visible light  @xcite that can be transmitted through acrylic light guides which are coupled to pmts through a layer of mineral oil .",
    "the tpb thickness on each acrylic end cap is 0.9  @xmath34 m and is coupled via a kodial glass window and acrylic light guide to a high quantum efficiency ( hqe ) model r5912 8 \" pmt manufactured by hamamatsu photonics . the tpb coating on the inside of the acrylic barrel is 4 - 5  @xmath34 m thick , and the outside of the barrel is wrapped with a ptfe reflector .    in this configuration ,",
    "deap-1 digitizes full 16  @xmath34s waveforms with no zero - suppression using a caen v1720 250 mhz digitizer . zero - suppression is applied in software to be consistent with the zero - length encoding assumed in the fast monte carlo simulation in section  [ sec : fp_model ] and the full miniclean simulation in section  [ sec : sim ] .",
    "a rendering of the deap-1 detector from the geant4 simulation .",
    "the 7.6 kg liquid argon volume is coupled to acrylic light guides via tpb coated glass windows .",
    "each light guide is coupled through a layer of mineral oil to hamamatsu photonics r5912 pmt . ]",
    "the deap-1 data set used for this analysis comes from a tagged , 10 @xmath34ci @xmath72naradioactive source placed just outside the acrylic vacuum vessel , centered along the axis of the target volume .",
    "the dominant @xmath72nadecay mode produces a positron that annihilates into back - to - back 511  kev gamma rays followed within ps by a 1274  kev de - exitation gamma ray .",
    "a small nai crystal is placed behind the source to tag one of the 511  kev gamma rays in order to constrain the other 511  kev gamma to be within a 9@xmath73 cone aimed directly at the center of the argon volume .",
    "the @xmath72nasource geometry and trigger configuration used in this data is very similar to that described in @xcite , but the trigger only requires a coincidence between the two main pmts facing the argon and the small pmt attached to the back nai crystal .",
    "the 1274  kev gamma ray is untagged and uncorrelated in direction with the 511  kev gamma ray that enters the deap-1 target volume .",
    "the light yield of the detector in this configuration was measured to be 4.5  pe / kev using the full energy peak from the 511  kev calibration gammas , and this is incorporated into the bayesian counting procedure to include the energy dependence of the mean singlet fraction in liquid argon scintillation . from test bench measurements , for approximately 5% of photoelectrons , the hqe r5912 pmts in deap-1 produce ionic after - pulses over timescales of several  @xmath34s after the primary pulse .",
    "the time pdfs used in the bayesian photoelectron counting , and in the calculation of @xmath63 , include these effects with pdfs generated in the simulation described in the next section . with only 2 pmts ( rather than 92 as in the fast monte carlo simulation of miniclean in section  [ sec : fp_model ] ) , there is significant pileup of photoelectron pulses which provides a good test of the bayesian photoelectron counting transitioning from pileup of multiple photoelectrons in the prompt region to isolated pulses at late times as described in section  [ sec : bayes_1st_pass ] .",
    "deap-1 is not capable of 3d position reconstruction , but can reconstruct the position ( @xmath74 ) of the event along the axis of the target cylinder .",
    "the @xmath74 position is also used to cut background that occurs at the windows where the pmt light guides are coupled to the liquid argon target volume ( see  @xcite for details ) .",
    "only events reconstructing within 10  cm of the @xmath74 center of the detector are included in the analysis . as a data quality cut and to remove pileup of multiple recoils in the detector , we also apply a cut using the ks test statistics @xmath71 and @xmath70 described in section  [ sec : stat_tests ] .",
    "the bottom panels of figure  [ fig : deap1_2d ] show the distributions of the three test statistics , @xmath1 , @xmath62 , and @xmath63 , as a function of the number of detected photoelectrons as output by the bayesian photoelectron counting procedure .",
    "events at low number of photoelectrons and high values of @xmath1which could leak into the nuclear recoil region are due in part to the effects described in section  [ sec : fp_model ] .",
    "however , an additional class of high @xmath1events are also present in the region of 25 to 150 pe .",
    "the presence of this class of events is enhanced with the bayesian photoelectron counting procedure and the @xmath62test statistic . using the @xmath63statistic , which takes full advantage of the scintillation time profiles ,",
    "these events are especially well identified at positive values of @xmath63 . as described in the next section ,",
    "simulations suggest that these events are due to the untagged 1274  kev gamma from the @xmath72nadecays producing cherenkov light in the large acrylic light guides in coincidence with the 511  kev gamma producing scintillation light in the liquid argon .",
    "the fast cherenkov light produces an additional prompt component which the @xmath1test statistic is relatively insensitive to . the separation of these events from the scintillation only events highlights the improved particle identification capabilities of the bayesian photoelectron counting technique and the @xmath63test statistic .    a one - dimensional slice of the distributions at 30  pe , or 6.67  pe / kevee , is shown in figure  [ fig : deap1_1d_compare ] . for the purposes of comparison , the @xmath63values have been linearly transformed to match the median values for electronic and nuclear recoils for @xmath1 .",
    "this keeps a fixed 50% nuclear recoil acceptance for each test statistic .",
    "the reduction in the @xmath63tail relative to @xmath1on the nuclear recoil side shows that @xmath63is a superior background rejection tool for low energy events . integrating above @xmath1of 0.7",
    ", the bayesian photoelectron counting and the @xmath63test statistic reduce the leakage of 30  pe events into the nuclear recoil 50% acceptance region by a factor of @xmath75 .",
    "distribution of @xmath1 , @xmath62 , and @xmath63test statistics for electronic recoils for @xmath72nacalibration events in deap-1 with 30 pe .",
    "the vertical dashed line indicates 50% nuclear recoil acceptance at 6.7  kevee .",
    "the @xmath63values have been linearly transformed such that the median values for the electron and nuclear recoil distributions match those for @xmath1 .",
    "the shift in the @xmath62peak relative to @xmath1is due to the discrete nature of the test statistic . ]         as in  @xcite , a well - motivated model can be constructed to extrapolate the tails of the @xmath1distribution at a particular energy .",
    "however , we lack such a model for the normalized likelihood ratio discriminant @xmath63 . for this reason ,",
    "we avoid comparison of the leakage for the particle identification parameters @xmath1and @xmath63except where there is sufficient statistics in the data to make a direct comparison .      to further test the bayesian photoelectron counting technique and the test statistics @xmath1 , @xmath62 , and @xmath63",
    ", we apply the complete procedure described in section  [ sec : spe_counting ] to simulated deap-1 @xmath72nacalibration data in this section and to @xmath7events in miniclean in section  [ sec : sim ] .",
    "the simulation and analysis framework used for both analyses , called _ rat _ , was originally developed by the braidwood collaboration  @xcite and is now maintained cooperatively by the deap / clean collaborations and the sno+  @xcite collaboration .",
    "rat brings together the electromagnetic and hadronic physics simulation provided by geant4 , the data storage and processing tools provided by root , and parts of the scintillation and pmt simulation from glg4sim , an open source package released by the kamland collaboration .",
    "rat simulates the following detector effects :    * propagation of primary particles , such as electrons , gamma rays , nuclear recoils , and neutrons through detector materials using geant4 .",
    "* production of extreme uv ( euv ) scintillation light by charged particles in the liquid argon .",
    "this includes the energy and particle dependence measured in @xcite . *",
    "propagation of individual euv photons and wavelength - shifted photons through the detector with geant4 , including both bulk and surface optical processes of liquid argon , tpb , glass , and metal surfaces .",
    "* detection of photons at pmts and the production of realistic pulses including time , charge and shape variations , as well as pre - pulsing , late - pulsing , double - pulsing , and after - pulsing . * detector triggering , waveform digitization , zero suppression , and data packing for readout .",
    "the output of the simulation stage is formatted identically to real detector data , allowing for the development of analysis algorithms that can directly operate on both simulated and real events .",
    "a detailed geometry of the deap-1 detector in the configuration described above was used to generate events simulating the @xmath72nacalibration data .",
    "the source configuration is modeled on the physical location of the source and trigger pmt with 511  kev gamma rays produced towards the center of the detector in a 9@xmath73 cone coincident with a directionally uncorrelated 1274  kev gamma ray .",
    "the distributions of the @xmath1 , @xmath62 , and @xmath63test statistics for simulated @xmath72nacalibration data is shown in figure  [ fig : deap1_2d ] along with the mean profile for simulated nuclear recoils for comparison .",
    "the simulated @xmath72natest statistic distributions broadly reproduce the basic shape of the distributions found in the data , although with limited statistics .",
    "in particular , the nuclear recoil - like events begin to emerge at positive values of @xmath63as in the calibration data .",
    "the miniclean detector  @xcite , shown in figure  [ fig : miniclean_render ] , is a cryogenic scintillation detector capable of operating with liquid argon or liquid neon .",
    "the 500  kg central volume is surrounded by a spherical array of 92 light guides each viewed by a hamamatsu photonics cryogenic 8 \" r5912 - 02-mod pmt .",
    "the conceptually simple , scalable design with maximal pmt coverage is similar to the approaches taken by other large dark matter and neutrino detectors ( for example deap-3600  @xcite , sno+  @xcite , kamland  @xcite , etc ) . unlike the smaller two - pmt deap-1 , miniclean",
    "s 92 pmts allow 3d position reconstruction . with a complete 3d vertex",
    ", miniclean is able to apply a strict fiducial volume cut , significantly reducing backgrounds from the tpb surfaces and pmts .",
    "the large array of pmts , relative to deap-1 , with maximal coverage also reduces the pileup of scintillation photons and leads to a higher expected light yield in the miniclean design . both effects",
    "contribute to improved particle identification as described in section  [ sec : fp_model ] .",
    "each of miniclean s pmts is fully immersed in the liquid and mounted in a cassette assembly that optically couples the pmt to a central target volume with a reflective tube capped by a 10  cm thick acrylic plug .",
    "the acrylic plug acts as a neutron shield and a supporting substrate for a 2  @xmath34 m layer of tpb that directly faces the argon volume to convert the extreme uv scintillation photons to the visible .",
    "the tpb - coated acrylic blocks are suspended inside the detector by the cassette bodies to create a polyhedral approximation of a sphere at an approximate radius of 43.7  cm with 97% of the surface area covered with tpb . when filled with liquid argon ,",
    "the total target mass is 500  kg , and after a nominal fiducial volume cut of 29.5  cm , the fiducial mass is 150  kg .",
    "the data acquisition system is similar to the deap-1 design , employing 13 caen v1720 250  mhz , 12-bit digitizers that compress 16  @xmath34s waveforms into non - contiguous blocks of samples by applying zero - suppression .",
    "each block of samples contains some number of pre- and post - samples that extend beyond the samples exceeding the zero - suppression threshold . in a typical configuration ,",
    "the minimum size of a block containing at least one photoelectron pulse is 32 samples .",
    "the caen v1720 digitizers have been observed in the lab to have a noise rms of 0.41  mv per sample when connected to a full length coaxial cable and pmt .",
    "a 3d rendering of the miniclean detector .",
    "the optical modules have tpb - coated acrylic at the innermost radius and pmts at the outermost radius . ]",
    "a sample of 84 million @xmath7decays were simulated and processed through the entire analysis sequence as described in section  [ sec : spe_counting ] .",
    "the events have been limited to be within the fiducial radius , where the energy scale has no radial dependence . for 75 - 100 pe ( 12.5 - 16.7 kevee ) events ,",
    "figure  [ fig : bayes_2pass ] shows the fractional error in the number of photoelectrons estimated using the bayesian photoelectron counter on the first pass with bootstrapped priors compared to the second pass where the priors , @xmath34 from equation  [ eq : p_n ] , are updated using position reconstruction . although the updated bayesian priors can induce small chennel - to - channel correlations , the second pass of the algorithm is an overall improvement .",
    "the second pass of bayesian photoelectron counting reduces the energy bias from 3.0% to 0.5% and improves the energy resolution from 4.1% to 3.9% .    the fractional error in estimation of the number of photoelectrons in simulated electron events in the miniclean detector between 75 and 100 pe . the second pass of bayesian photoelectron counting , which replaces the bootstrapped bayesian prior with a prior derived from the reconstructed position and energy of the event , reduces the energy bias from 3.0% to 0.5% , reduces the energy resolution from 4.1% to 3.9% , and reduces the rms of the @xmath63distribution by 5% .",
    "]    figure  [ fig : eres_miniclean ] compares the apparent event energy from normalized charge integration , where the number of photoelectrons is estimated from the total charge divided by the mean single photoelectron charge , to the number of photoelectrons estimated using the two - pass bayesian photoelectron counter .",
    "since events are restricted to a region where the energy scale has no radial dependence , the improvement in photoelectron counting resolution is a direct measure of the improvement of the energy resolution .",
    "the energy resolution is reduced from 4.3% with the charge integration method to 3.1% with the bayesian photoelectron counting .    the ratio of estimated number of photoelectrons divided by the true number of photoelectrons for simulated @xmath7decays in the miniclean .",
    "only events between 75 and 100 pe , and radius less than 295 mm are shown . ]",
    "the improved energy resolution offered by the bayesian photoelectron counting reduces the number of low energy background events entering the energy region of interest .",
    "lowering of the threshold with reduced background in the presence of a wimp - like signal can dramatically improve the sensitity to signal which increases rapidly at low energies .",
    "the 2d distributions of the @xmath1 , @xmath62 , and @xmath63test statistics as a function of reconstructed number of photoelectrons are shown in figure  [ fig : mini_2d ] for simulated events in the miniclean detector .",
    "the @xmath63test statistic significantly tightens up the distributions of electrons and nuclear recoils at very low numbers of photoelectrons , which is precisely where a wimp signal will show increasing rate .",
    "we do not have enough cpu resources to fully simulate the number of events required to estimate the background leakage for each of these test statistics directly , as we did with the fast simulation in section  [ sec : fp_model ] .",
    "however , we can linearly transform @xmath63into the same [ 0,1 ] range as @xmath1and @xmath62so the median @xmath63value for electrons is the same as the median @xmath1 , and the same is true for nuclear recoil distributions .",
    "this allows the tails of the distributions to be compared more easily , as is shown in figure  [ fig : miniclean_1d_compare ] .",
    "electrons with only 40  pe ( 6.67  kevee as in figure  [ fig : deap1_1d_compare ] for deap-1 given the respective light yields ) show a significantly smaller tail in the @xmath63distribution compared to @xmath1and @xmath62 .",
    "above @xmath1of 0.7 , the @xmath63tail is reduced by a factor of @xmath76 compared to the @xmath1distribution .",
    "distribution of @xmath1 , @xmath62and @xmath63test statistics for electronic recoils for simulated miniclean events at 40 pe .",
    "the vertical dashed line indicates 50% nuclear recoil acceptance at 6.67  kevee .",
    "the @xmath63values have been linearly transformed such that the median values for the electron and nuclear recoil distributions match those for @xmath1 . ]",
    "many current and future neutrino and dark matter experiments depend on the detection of scintillation light with pmts .",
    "the ability to both count and identify the times of individual photoelectrons in a pmt waveform directly impacts energy resolution and particle identification with timing . when scintillation light with both short and long time constants is present , simple strategies for photoelectron counting will alternately introduce biases or large variance in different situations . we have resolved this difficulty by showing how to apply a bayesian prior assumption about the intensity and time structure of the light to the counting process . by iterating the procedure , a crude , bootstrapped prior can be refined with the addition of reconstructed observables , such as event energy and position .",
    "although the canonical prompt - fraction , @xmath1 , particle identification parameter often offers excellent discrimination , realistic detector effects can degrade the discrimination power significantly with the extent depending on the scintillator and detector properties . using the times output by the bayesian photoelectron counting procedure , improved test statistics , such as @xmath62and @xmath63 ,",
    "can be constructed to better utilize the known time structure of the scintillation light .",
    "although this is applicable to a wide range of scintillator detectors , here we have demonstrated the improved particle identification test statistics in the deap-1 @xmath72nacalibration data and miniclean @xmath7simulation . with improved energy resolution and improved particle identification test statistics , scintillator experiments looking for rare events can improve sensitivity to the signal of interest through the reduction of backgrounds and lowering of the energy threshold .",
    "this work has in part been supported by the united states department of energy , office of high energy physics .",
    "support for deap-1 has been provided by the canadian foundation for innovation and the natural sciences and engineering research council .",
    "the high performance computing virtual laboratory ( hpcvl ) has provided us with cpu time , data storage , and support .",
    "we would also like to thank the snolab staff for on - site support . the work of our co - op and summer students , including christopher stanford who operated deap-1 during the data - taking in this paper , is gratefully acknowledged .",
    "contributions by staff of nist , an agency of the us government , are not subject to copyright in the us ."
  ],
  "abstract_text": [
    "<S> many current and future dark matter and neutrino detectors are designed to measure scintillation light with a large array of photomultiplier tubes ( pmts ) . </S>",
    "<S> the energy resolution and particle identification capabilities of these detectors depend in part on the ability to accurately identify individual photoelectrons in pmt waveforms despite large variability in pulse amplitudes and pulse pileup . </S>",
    "<S> we describe a bayesian technique that can identify the times of individual photoelectrons in a sampled pmt waveform without deconvolution , even when pileup is present . to demonstrate the technique , we apply it to the general problem of particle identification in single - phase liquid argon dark matter detectors . using the output of the bayesian photoelectron counting algorithm described in this paper , </S>",
    "<S> we construct several test statistics for rejection of backgrounds for dark matter searches in argon . </S>",
    "<S> compared to simpler methods based on either observed charge or peak finding , the photoelectron counting technique improves both energy resolution and particle identification of low energy events in calibration data from the deap-1 detector and simulation of the larger miniclean dark matter detector .    </S>",
    "<S> dark matter , neutrino , pulse - shape discrimination , liquid argon </S>"
  ]
}