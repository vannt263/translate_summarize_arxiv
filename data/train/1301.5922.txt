{
  "article_text": [
    "in this work we propose and validate a computational approach to the reconstruction of material properties in complex multiphysics phenomena based on incomplete and possibly noisy measurements .",
    "the material properties we are interested in here are the transport coefficients characterizing diffusion processes such as the viscosity or the thermal conductivity , and we focus on problems in which these coefficients depend on the state variables in the system . by the `` multiphysics '' aspect we mean situations in which the material property used in one conservation equation is a function of a state variable governed by a different conservation equation , e.g. , reconstruction of the temperature dependence of the viscosity coefficient used in the momentum equation , where the temperature is governed by a separate energy equation , which is the specific model problem investigated in this study .",
    "this research is motivated by questions arising in the computational analysis and optimization of advanced welding processes which involves modelling complex alloys in the liquid phase at high temperatures @xcite .",
    "inverse problems of parameter estimation for partial differential equations ( pdes ) have received significant attention in the literature , both regarding theoretical @xcite and practical aspects @xcite . however , most of the attention focused on problems in which the material properties are functions of the space variable ( i.e. , the independent variable in the problem ) .",
    "such problems are , at least in principle , relatively well understood and represent the foundation of , for example , numerous imaging techniques in medicine @xcite and earth sciences @xcite .",
    "the problem considered here is in fact different , in that the material properties are sought as functions of the state ( dependent ) variables in the system which gives rise to a number of computational challenges absent in the `` classical '' parameter estimation problem .",
    "other than the seminal work of chavent and lemonnier @xcite , our earlier study @xcite concerning a simplified model problem and a few investigations of fully discrete formulations surveyed in @xcite , there does not seem to be much literature concerning computational methods for this type of parameter estimation problems .",
    "one way to solve such inverse problems is to formulate them as optimization problems and this is the approach we will follow focusing on the `` optimize  then  discretize '' paradigm in which the optimality conditions are formulated at the continuous ( pde ) level and only then discretized .",
    "the goal of this investigation is to extend the approach formulated in @xcite for a simple model to a realistic multiphysics problem involving time ",
    "dependent fluid flow in a two  dimensional ( 2d ) domain . as will be shown below",
    ", a number of computational difficulties will need to be overcome in order to achieve this goal .    as a key contribution of this work",
    ", we address a number of computational challenges related to accurate and efficient evaluation of cost functional gradients which are critical to the implementation of the proposed approach .",
    "more specifically , these gradients are given in terms of integrals of expressions involving state and adjoint variables defined on a grid over contours given by the level sets of the temperature field .",
    "a number of techniques have been proposed for the numerical evaluation of integrals defined over manifolds defined by level  set functions .",
    "some of them rely on regularized dirac delta and heaviside functions @xcite , or discretization of the dirac delta function @xcite .",
    "similar approaches , based on approximations of the dirac delta functions obtained using the level  set function and its gradient , were developed by towers @xcite .",
    "the family of geometric approaches proposed by min and gibou in @xcite relies on a decomposition of the entire domain into simplices .",
    "we emphasize that the problem discussed in this work is in fact more complicated , as the computation of our cost functional gradients requires evaluation of the corresponding integrals for the level  set values spanning the entire state space of interest , hence there are also additional issues related to the discretization of the state space which were outside the scope of references @xcite .",
    "thus , in order to address these questions and assess the different trade  offs in the choice of the numerical parameters we will compare the computational performance of three different methods for the evaluation of cost functional gradients .",
    "the structure of this paper is as follows : in the next section we formulate our model problem , in the following section we cast the problem of parameter estimation as an optimization problem , an adjoint  based gradient  descent algorithm is formulated in section [ sec : grad_adj ] , in section [ sec : reg ] we outline some regularization strategies needed in the presence of measurement noise , whereas in section [ sec : grad_eval ] we analyze three different numerical approaches to the evaluation of the cost functional gradients ; extensive computational results are presented in section [ sec : results ] with discussion and conclusions deferred to section [ sec : final ] .",
    "let @xmath2 , @xmath3 , be the spatial domain on which our model problem is formulated . to fix attention , but without loss of generality , in the present investigation we focus on the problem of a reconstruction of the temperature dependence @xmath4 of the viscosity coefficient @xmath5 in the momentum equation ( navier - stokes equation ) , where the temperature @xmath6 is governed by a separate energy equation    [ eq : coupled_pdes ] @xmath7 \\right ] & = & 0 \\qquad & \\textrm{in } \\",
    "\\omega , \\label{eq : coupled_ns } \\\\",
    "\\bnabla \\cdot \\u & = & 0 \\qquad & \\textrm{in } \\",
    "\\omega , \\label{eq : coupled_incompress } \\\\",
    "\\partial_t t + ( \\u \\cdot \\bnabla ) t - \\bnabla \\cdot [ k \\bnabla t ] & = & 0 \\qquad & \\textrm{in } \\",
    "\\omega , \\label{eq : coupled_heat}\\end{aligned}\\ ] ]    subject to appropriate dirichlet ( or neumann ) boundary and initial conditions    [ eq : coupled_bc ] @xmath8    the specific inverse problem we address in this investigation is formulated as follows .",
    "given a set of time ",
    "dependent `` measurements '' @xmath9 of the state variable ( temperature ) @xmath6 at a number of points @xmath10 in the domain @xmath11 ( or along the boundary @xmath12 ) and obtained within the time window @xmath13 $ ] , we seek to reconstruct the constitutive relation @xmath4 such that solutions of problem - obtained with this reconstructed function will fit best the available measurements .    in regard to reconstruction of constitutive relations in general ,",
    "it is important that such relations be consistent with the second principle of thermodynamics @xcite .",
    "there exist two mathematical formalisms , one due to coleman and noll @xcite and another one due to liu @xcite , developed to ensure in a very general setting that a given form of the constitutive relation does not violate the second principle of thermodynamics . in continuous thermodynamical and mechanical systems",
    "this principle is expressed in terms of the clausius  duhem inequality @xcite which in the case of our present model problem  reduces to the statement that @xmath14 for all possible values of @xmath6 .    in our discussion below we will also need definitions of the following intervals , cf .  figure [ fig : domains ] :    * @xmath15 \\triangleq [ \\min_{\\x \\in      \\overline{\\omega } } t(\\x ) , \\max_{\\x \\in \\overline{\\omega } } t(\\x)]$ ] which represents the temperature range spanned by the solution of problem ; thus , following @xcite , we will refer to the interval @xmath16 $ ] as the _ identifiability interval _",
    ", * @xmath17 $ ] , where @xmath18 and @xmath19 ; this will be the temperature interval on which we will seek to obtain a reconstruction of the material property ; we note that in general the interval @xmath20 will be larger than the identifiability interval , i.e. , @xmath21 , and * @xmath22 $ ] which defines the temperature range spanned by the measurements @xmath23 ; this interval is always contained the identifiability interval @xmath24 , i.e. , @xmath25 ; we will refer to the interval @xmath26 as the _ measurement span_.     at some fixed time @xmath27 and ( right ) the corresponding constitutive relation @xmath28 defined over their respective domains , i.e. , @xmath29 and the identifiability region @xmath24 .",
    "the thick dotted line represents an extension of the constitutive relation @xmath28 from @xmath24 to the interval @xmath20 . in the figure on the right",
    "the horizontal axis is to be interpreted as the ordinate.,scaledwidth=100.0% ]",
    "it is assumed that the constitutive relations @xmath28 are differentiable functions of the state variable ( temperature ) and belong to the following set @xmath30 where @xmath31 .",
    "we will also assume that the set @xmath32 consisting of constitutive relations @xmath28 defined on @xmath20 is embedded in a hilbert ( function ) space @xmath33 to be specified below .",
    "solving our parameter estimation problem is therefore equivalent to finding a solution to the operator equation @xmath34 where @xmath35 ) \\right)^m$ ] is the map from the constitutive relations to the measurements .",
    "an approach commonly used to solve such problems consists in reformulating them as least  squares minimization problems which in the present case can be done by defining the cost functional @xmath36 as @xmath37 ^ 2 d\\tau , \\label{eq : j0}\\ ] ] where the dependence of the temperature field @xmath38 on the form of the constitutive relation @xmath4 is given by governing system . the optimal reconstruction @xmath39 is obtained as a minimizer of cost functional , i.e. , @xmath40 we recall that the constitutive property is required to satisfy the positivity condition @xmath14 for all @xmath41 , cf .  .",
    "therefore , the optimal reconstruction @xmath39 should in fact be obtained as an _ inequality_constrained minimizer of cost functional , i.e. , @xmath42 we add that in problems involving constitutive relations depending on several state variables the inequality constraint @xmath14 will be replaced with a more general form of the clausius  duhem inequality @xcite .",
    "different computational approaches for converting inequality  constrained optimization problems to unconstrained formulations are surveyed in @xcite . here",
    "we follow a straightforward approach based on the so - called `` slack '' variable @xcite .",
    "we define a new function @xmath43 such that @xmath44 where @xmath45 is a lower bound for @xmath28 , cf .  .",
    "this change of variables allows us to transform the _",
    "inequality_constrained optimization problem to a new unconstrained one @xmath46 where the constraint @xmath14 is satisfied automatically when minimization is performed with respect to the new variable @xmath47 . in view of",
    ", we note that the new optimization variable @xmath48 belongs to the following set @xmath49 the governing pde system can thus be rewritten in the form    [ eq : coupled_pdes_slack ] @xmath50 \\right ] & = & 0 \\qquad & \\textrm{in } \\",
    "\\omega , \\label{eq : coupled_ns_slack } \\\\",
    "\\bnabla \\cdot \\u & = & 0 \\qquad & \\textrm{in } \\",
    "\\omega , \\label{eq : coupled_incompress_slack } \\\\",
    "\\partial_t t + ( \\u \\cdot \\bnabla ) t - \\bnabla \\cdot [ k \\bnabla t ] & = & 0 \\qquad & \\textrm{in } \\",
    "\\omega , \\label{eq : coupled_heat_slack}\\end{aligned}\\ ] ]    subject to dirichlet boundary and initial conditions .",
    "the new problem requires redefining cost functional in terms of the new variable @xmath51 ^ 2 \\ , d\\tau .",
    "\\label{eq : j0_slack}\\ ] ] problem is characterized by the first ",
    "order optimality condition which requires the gteaux differential of cost functional , defined as @xmath52 $ ] , to vanish for all perturbations @xmath53 @xcite , i.e. , @xmath54 the ( local ) optimizer @xmath55 can be computed with the following gradient descent algorithm as @xmath56 , where @xmath57 in which @xmath58 represents the gradient of cost functional @xmath59 with respect to the control variable @xmath48 ( we will adopt the convention that a subscript on the operator @xmath60 will be used when differentiation is performed with respect to variables other than @xmath61 ) , @xmath62 is the length of the step along the descent direction at the @xmath63th iteration , whereas @xmath64 is the initial guess taken , for instance , corresponding to a constant @xmath65 , or some other appropriate initial approximation . for the sake of clarity",
    ", formulation represents the steepest  descent algorithm , however , in practice one typically uses more advanced minimization techniques , such as the conjugate gradient method , or one of the quasi  newton techniques @xcite .",
    "we note that , since minimization problem is in general nonconvex , condition characterizes only a _",
    ", rather than _ global _ , minimizer .",
    "the key ingredient of minimization algorithm is computation of the cost functional gradient @xmath58 .",
    "we emphasize that , since @xmath66 is a continuous variable , the gradient @xmath58 represents in fact the infinite  dimensional sensitivity of @xmath59 to perturbations of @xmath47 .",
    "this gradient can be determined based on suitably defined _ adjoint variables _ ( lagrange multipliers ) obtained from the solution of the corresponding _",
    "adjoint system_. since this derivation differs in a number of imported technical details from analogous derivations in `` standard '' pde  constrained optimization problems , it will be reviewed in section [ sec : grad_adj ] .",
    "the expression for the gradient is then validated for consistency in section [ sec : kappa ] .",
    "since the new variable @xmath47 belongs to set @xmath67 , cf .  , we will seek to reconstruct @xmath47 as elements of the sobolev space @xmath68 , so that the gradient @xmath69 will need to be obtained with respect to the corresponding inner product .",
    "however , in order to make the derivation procedure easier to follow , we will first obtain an expression for the gradient in the space @xmath70 , and only then will obtain the sobolev gradients which will be eventually used in the solution of optimization problem . in all these steps",
    "our transformations will be formal .",
    "we begin by computing the directional ( gteaux ) differential of cost functional which yields @xmath71 \\",
    ", t'(\\tau,\\x_i ; \\theta , \\theta ' ) \\ , d\\tau , \\label{eq : dj2_coupled}\\ ] ] where the perturbation variable @xmath72 satisfies the perturbation system obtained from .",
    "next , we invoke the riesz representation theorem @xcite for the directional differential @xmath73 which yields @xmath74 where @xmath75 represents an inner product in the hilbert space @xmath33 ( we will first set @xmath76 and afterwards change this to @xmath77 ) .",
    "we note that the expression on the right  hand side ( rhs ) in is not consistent with riesz representation , since , as will be shown below , the perturbation variable @xmath78 is hidden in the system defining @xmath79 .",
    "however , this expression can be transformed to riesz form with the help of a suitably  defined adjoint variable , a result which is stated in theorem [ thm : riesz ] below .",
    "the main aspect in which this derivation differs from the standard adjoint analysis @xcite is that the inner product in riesz identity is defined using the state variable ( temperature ) as the integration variable , whereas the variational formulation of  is defined using integration with respect to the independent variables ( @xmath61 and @xmath80 ) .",
    "let @xmath11 be a sufficiently regular open bounded domain and @xmath81 .",
    "we assume that the solutions @xmath82 and @xmath6 of system  are sufficiently smooth .",
    "then , the riesz representation of directional differential has the form @xmath83 : \\bnabla \\u^ *   \\ , d\\tau \\right ] \\ , \\theta'(s ) \\ , d\\x \\ , ds , \\label{eq : rrgt}\\ ] ] where @xmath84 denotes dirac delta function and the adjoint state @xmath85 is defined as the solution of the system    [ eq : adjoint_coupled ] @xmath86 + 2\\theta(t)\\,\\dfrac{d\\theta}{dt}(t ) \\,[\\bnabla \\u + ( \\bnabla \\u)^t ] : \\bnabla^ * \\u \\nonumber &",
    "\\\\ = \\sum_{i=1}^m [ t(\\x_i;\\theta ) - \\tilde{t}_i ] \\delta ( \\x - \\x_i ) & \\qquad & \\mathrm{in } \\ \\omega , \\label{eq : adjoint_coupled_c}\\end{aligned}\\ ] ]    where @xmath87 $ ] , with the following boundary and terminal conditions @xmath88 [ thm : riesz ]    we will denote the stress tensor @xmath89 \\right]$ ] and rewrite the governing system as @xmath90 & = & 0 \\qquad & \\textrm{in } \\ \\omega \\end{aligned}\\ ] ] with the boundary and initial conditions . perturbing the state variables",
    "@xmath82 , @xmath91 and @xmath6 , which are functions of time and space , we get @xmath92 so that the corresponding expansion of the constitutive relation @xmath47 will have the following form @xmath93 where the subscript `` @xmath94 '' is used to denote the unperturbed ( reference ) material property and the state variable , whereas the prime denotes the corresponding perturbations .",
    "we also have @xmath95 substituting and into , collecting terms corresponding to @xmath96 in different powers and denoting @xmath97 , \\\\ \\tilde \\bsigma & \\triangleq \\left ( 2\\theta(t ) \\ , \\dfrac{d\\theta}{dt}(t ) \\ , t'(\\theta_0;\\theta ' ) + 2\\theta(t ) \\ , \\theta'(t ) \\right ) \\left [ \\bnabla \\u + ( \\bnabla \\u)^t \\right ] , \\end{aligned}\\ ] ] we obtain the perturbation ( sensitivity ) system corresponding to    [ eq : perturb ] @xmath98 & = & 0 \\qquad & \\textrm{in } \\",
    "\\omega   \\label{eq : perturb_c}\\end{aligned}\\ ] ]    with the following boundary and initial conditions    [ eq : bc_perturb ] @xmath99    then , integrating equation against @xmath100 , equation against @xmath101 , and equation against @xmath102 over the space domain @xmath11 and time @xmath103 $ ] , integrating by parts and factorizing @xmath104 , @xmath105 and @xmath106 , we arrive at the following relation @xmath107 \\cdot \\u ' \\ , d\\x \\ , d\\tau\\\\ - & \\int^{t_f}_0 \\int_{\\omega } ( \\bnabla \\cdot \\u^ * ) p ' \\ , d\\x \\ , d\\tau\\\\ + & \\int^{t_f}_0 \\int_{\\omega } \\left[- \\partial_t t^ * - ( \\u \\cdot \\bnabla ) t^ * - \\bnabla \\cdot ( k \\bnabla t^ * ) + 2\\theta(t)\\dfrac{d\\theta}{dt}(t ) [ \\bnabla \\u + ( \\bnabla \\u)^t ] : \\bnabla \\u^ * \\right ] t ' \\ , d\\x \\ , d\\tau\\\\ + & \\int^{t_f}_0 \\int_{\\omega } 2\\theta(t)\\theta'(t ) [ \\bnabla \\u + ( \\bnabla \\u)^t ] : \\bnabla \\u^ * \\ , d\\x \\ , d\\tau = 0 .",
    "\\end{aligned}\\ ] ] we now require that the adjoint variables @xmath100 , @xmath101 and @xmath102 satisfy system . we also note that owing to the judicious choice of the rhs term in , the last term in relation is in fact equal to the directional differential @xmath108 , so that we have @xmath109 : \\bnabla \\u^*(\\x,\\tau ) \\,d\\x \\ , d\\tau , \\label{eq : rrgd}\\ ] ] where , for emphasis , we indicated the integration variables as arguments of the state and adjoint variables .",
    "we note that this expression is still not in riesz form , where integration must be performed with respect to the state variable ( temperature @xmath6 ) .",
    "thus , we proceed to express for any given function @xmath110 its pointwise evaluation at @xmath111 through the following integral transform .",
    "it is defined using a `` change  of  variable '' operator , denoted @xmath112 , such that for given functions @xmath113 and @xmath114 , we have @xmath115 using this transform to express @xmath116 in and changing the order of integration ( fubini s theorem ) , we obtain expression which is the required riesz representation of directional differential .",
    "we remark that we were able to prove an analogous result using a simpler approach based on the kirchhoff transform in @xcite , where both the constitutive relation and the state variable were governed by the same equation ( i.e. , the problem was not of the `` multiphysics '' type ) .    with the riesz representation established in ,",
    "we now proceed to identify expressions for the cost functional gradient @xmath117 according to using different spaces @xmath33 . while this is not the gradient that we will use in actual computations ,",
    "we analyze first the `` simplest '' case when @xmath76 , i.e. , the space of functions square integrable on @xmath118 $ ] , as it already offers some interesting insights into the structure of the problem .",
    "the @xmath119 gradient of the cost functional hence takes the form @xmath120 : \\bnabla \\u^ * \\ d\\x \\ , d\\tau.\\ ] ] as was discussed at length in @xcite , the @xmath119 gradients are not suitable for the reconstruction of material properties in the present problem , because in addition to lacking necessary smoothness , they are not defined outside the identifiability region ( other than perhaps through a trivial extension with zero ) .",
    "given the regularity required of the constitutive relations , cf .",
    ", the cost functional gradients should be elements of the sobolev space @xmath68 of functions with square ",
    "integrable derivatives on @xmath20 . using ,",
    "now with @xmath77 , we obtain @xmath121 \\ , ds \\end{aligned } \\label{eq : dj4}\\ ] ] in which @xmath122 is a parameter with the meaning of a `` temperature  scale '' [ we note that the @xmath119 inner product is recovered by setting @xmath123 in ] . performing integration by parts with the assumption that the sobolev gradient @xmath124 satisfies the homogeneous neumann boundary conditions at @xmath125 , and noting that relation must be satisfied for any arbitrary @xmath78 , we conclude that the sobolev gradient can be determined as a solution of the following inhomogeneous elliptic boundary  value problem where the state variable ( temperature ) acts as the independent variable    [ eq : helm ] @xmath126    we recall that by changing the value of the temperature  scale parameter @xmath127 we can control the smoothness of the gradient @xmath128 , and therefore also the relative smoothness of the resulting reconstruction of @xmath47 , and hence also the regularity of @xmath28 . more specifically ,",
    "as was shown in @xcite , extracting cost functional gradients in the sobolev spaces @xmath129 , @xmath130 , is equivalent to applying a low  pass filter to the @xmath119 gradient with the quantity @xmath127 representing the `` cut - off '' scale .",
    "there are also other ways of defining the sobolev gradients in the present problem which result in gradients characterized by a different behavior outside the identifiability region .",
    "these approaches were thoroughly investigated in @xcite , and since they typically lead to inferior results , they will not be considered here .",
    "we finally conclude that iterative reconstruction of the constitutive relation @xmath28 involves the following computations    1 .",
    "solution of direct problem with boundary and initial conditions , 2 .",
    "solution of adjoint problem  , 3 .",
    "evaluation of expression for the cost functional gradient , 4 .",
    "computation of the smoothed sobolev gradient by solving .",
    "while steps ( 1 ) , ( 2 ) and ( 4 ) are fairly straightforward , step ( 3 ) is not and will be thoroughly investigated in section [ sec : grad_eval ] .",
    "as we discussed in detail in @xcite , while the sobolev gradient @xmath124 may be defined on an arbitrary interval @xmath131 , the actual sensitivity information is essentially available only on the identifiability interval @xmath24 ( see figure [ fig : domains ] ) .",
    "in other words , extension of the gradient outside @xmath24 via does not generate new sensitivity information .",
    "since , as demonstrated by our computational results reported in @xcite , such techniques are not capable of accurately reconstructing the relation @xmath28 on an interval @xmath20 much larger than the identifiability region @xmath24 , here we mention a different method to `` extend '' the identifiability region , so that the relation @xmath28 can be reconstructed on a larger interval .",
    "this can be done in a straightforward manner by choosing appropriate time ",
    "dependent boundary conditions for temperature @xmath132 in which will result in a suitable identifiability region @xmath24 and the measurement span @xmath26 .",
    "computational results illustrating the performance of our approach with different identifiability regions obtained using this method will be presented in section [ sec : estim ] .",
    "we remark that extending the identifiability region in this way is not possible in time ",
    "independent problems where an iterative approach has to be used involving solution of a sequence of reconstruction problems on shifted identifiability regions @xcite .",
    "in this section we discuss the important issue of reconstruction in the presence of noise in the measurements . as can be expected based on the general properties of parameter estimation problems @xcite , and as will be confirmed in section [ sec : noise ] , incorporation of random noise into the measurements leads to an instability in the form of small  scale oscillations appearing in the reconstructed constitutive relations . in the optimization framework a standard approach to mitigate this problem is tikhonov regularization @xcite in which original cost functional is replaced with a regularized expression of the form @xmath133 where @xmath134 is an adjustable regularization parameter , @xmath135 represents a constitutive relation which our reconstruction @xmath47 should not differ too much from , whereas @xmath136 is the hilbert space norm in which we measure the deviation @xmath137 .",
    "thus , the regularization term in , i.e. , the second one on the rhs , involves some additional information which needs to be specified a priori , namely , the choice of the reference relation @xmath135 and the space @xmath138 . as regards the reference function @xmath135 , one natural possibility is to consider a constant value corresponding to a constant material property , and this is the solution we will adopt below .",
    "we recall here that @xmath47 is in fact a `` slack '' variable and is related to the actual constitutive relation via .",
    "as regards the choice of the space @xmath138 , we will follow the discussion in @xcite and consider a regularization term involving derivatives , namely @xmath139 , where @xmath140 denotes the sobolev space equipped with the semi  norm @xmath141 , @xmath142 ; the regularization term in then becomes @xmath143 yielding the following @xmath119 gradient of the regularized cost functional @xmath144 : \\bnabla \\u^ * \\ d\\x \\ , d\\tau \\\\ & + \\lambda \\left\\ { \\dfrac{d\\theta}{ds } \\left[\\delta(s - t_{\\beta } ) - \\delta(s - t_{\\alpha})\\right ] - \\dfrac{d^2\\theta}{ds^2 } \\right\\}. \\end{aligned } \\label{eq : djregh1}\\ ] ] we remark that in obtaining integration by parts was applied to the directional derivative of the regularization term .",
    "expression can now be used to compute the sobolev gradients as discussed in section [ sec : grad_adj ] .",
    "we add that penalty term is defined on the identifiability interval @xmath24 which is contained in the interval @xmath20 on which the sobolev gradients are computed . computational tests illustrating the performance of the tikhonov regularization on a problem with noisy data will be presented in section [ sec : noise ] . in that section",
    "we will also briefly analyze the effect of the regularization parameter @xmath145 .",
    "we add that the stability and convergence of tikhonov regularization using the sobolev norm @xmath146 in the regularization term and applied to an inverse problem with similar mathematical structure , but formulated for a simpler pde than , was established rigorously in @xcite .",
    "without loss of generality , hereafter we will focus our discussion on the 2d case . for some technical reasons we will also assume that @xmath147 } \\quad \\textrm{meas } \\left\\ { \\x \\in \\omega , \\    | \\bnabla t(t,\\x ) | = 0 \\right\\ } = 0 , \\label{eq : dt0}\\ ] ] i.e. , that the temperature gradient may not vanish on subregions with finite area .",
    "( this assumption is naturally satisfied when the temperature evolution is governed by an equation of the parabolic type such as . )",
    "a key element of reconstruction algorithm is evaluation of the cost functional gradients given , in the @xmath119 case , by expression .",
    "the difficulty consists in the fact that at every instant of time @xmath148 $ ] and for every value of @xmath149 ( i.e. , the dependent variable ) , one has to compute a line integral defined on the level set @xmath150 of the temperature field @xmath151 . to focus attention on the main issue , the time dependence will be omitted in the discussion below . the integrand expression in such integrals",
    "is given in terms of solutions of the direct and adjoint problems  and  which are approximated on a grid .",
    "as will be shown below , this problem is closely related to approximation of one  dimensional dirac measures in @xmath152 , an issue which has received some attention in the literature @xcite .",
    "we will compare different computational approaches to this problem , and in order to better assess their accuracy , we will first test them on the generic expression @xmath153 for which the actual formula for the cost functional gradient is a special case ( except for the time integration ) . in the function @xmath154",
    "represents the field whose @xmath149-level sets define the contours of integration @xmath155 , whereas the function @xmath156 represents the actual integrand expression .",
    "we note that by setting @xmath157 , @xmath158 : \\bnabla \\u^*(\\x)$ ] and adding time integration in , we recover the original expression for the cost functional gradient .",
    "we emphasize , however , that the advantage of using with some simple , closed  form expressions for @xmath159 and @xmath160 as a testbed is that this will make our assessment of the accuracy of the proposed methods independent of the accuracy involved in the numerical solution of the governing and adjoint pdes ( needed to approximate @xmath82 , @xmath6 and @xmath100 ) .    in anticipation of one of the proposed numerical approaches , it is useful to rewrite explicitly as a line integral @xmath161 which is valid provided @xmath162 for every @xmath163 , cf .",
    "assumption ( proof of the equivalence of expressions and may be found , for example , in @xcite ) .",
    "formula makes it clear that for a fixed value of @xmath149 expression for the cost functional gradient can be interpreted as a sum of line integrals defined on the instantaneous @xmath149level sets of the temperature field @xmath151 .    the problem of accurate numerical evaluation of the expressions given by either or has received much attention , especially since the invention of the level - set approach by osher and sethian @xcite .",
    "traditionally , the problem of integration over codimension1 manifolds defined by a level  set function @xmath164 is studied in terms of the numerical evaluation of either the left ",
    "hand side ( lhs ) or right  hand side ( rhs ) expression in the following relation , analogous to  , @xmath165 where , by absorbing the factor @xmath166 into the definition of the function @xmath167 , one bypasses the problem of the points @xmath168 where @xmath169 , cf .  .",
    "these approaches fall into two main groups : +    * reduction to a _ line ( contour ) integral _ , cf .  , or the lhs of , and * evaluation of an _ area integral _ , cf .  , or the rhs of .",
    "+ in the context of this classification , the methods of geometric integration developed by min and gibou @xcite fall into the first category .",
    "this approach is based on decomposing the domain @xmath11 into simplices , which in the simplest 2d case can be achieved via a standard triangulation , and then approximating the level sets given by @xmath170 with piecewise splines inside each simplex .",
    "expression then breaks up into a number of definite integrals which can be evaluated using standard quadratures .    in practice , however , area integration techniques ( b ) seem to have become more popular . one family of such techniques relies on regularization @xmath171 of the dirac delta function with a suitable choice of the regularization parameter @xmath96 which characterizes the size of the support . while in the simplest case in which the parameter @xmath96 is determined based on the mesh size the error is @xmath172 @xcite , recently developed approaches @xcite achieve better accuracy by adjusting @xmath96 based on the local gradient @xmath173 of the level  set function .",
    "another family of area integration approaches is represented by the work of mayo @xcite further developed by smereka @xcite where a discrete approximation @xmath174 of the dirac delta function was obtained .",
    "this approach can also be regarded as yet another way to regularize delta function @xmath175 using a fixed compact support in the one  dimensional ( 1d ) space of values @xmath176 . in the second group of approaches",
    "we also mention consistent approximations to delta function obtained by towers in @xcite using the level  set function and its gradient computed via finite differences .    in our present reconstruction problem",
    ", we have to evaluate the gradient expression for the whole range of @xmath41 , hence the discretization of the interval @xmath20 will also affect the overall accuracy of the reconstruction , in addition to the accuracy characterizing evaluation of the gradient for a particular value of @xmath6 .",
    "this is an aspect of the present problem which is outside the scope of earlier investigations concerning evaluation of the contour integrals of grid  based data @xcite .",
    "thus , we need to understand how the interplay of the discretizations of the physical space @xmath11 with the step size @xmath177 and the state space @xmath20 with the step size @xmath178 affects the accuracy of the reconstruction . in principle , one could also consider the effect of discretizing the time interval @xmath103 $ ] , however , the corresponding step size is linked to @xmath177 via the cfl condition , hence this effect will not be separately analyzed here .",
    "there are also questions concerning the computational complexity of the different approaches .",
    "we will consider below the following three methods to evaluate expression , or equivalently , which are representative of the different approaches mentioned above    1 .",
    "line integration over approximate level sets which is a method from group a based on a simplified version of the geometric integration developed by min and gibou in @xcite , 2 .",
    "approximation of dirac delta measures developed by smereka in @xcite which is an example of a regularization technique and utilizes the area integration strategy from group b , and 3 .",
    "approximation of contour integrals with area integrals , a method which also belongs to group b and combines some properties of regularization and discretization of dirac delta measures discussed above @xcite ; more details about this approach , including an analysis for its accuracy , are provided in section [ sec : domain_int ] .    to fix attention ,",
    "we now introduce two different finite  element ( fem ) discretizations of the domain @xmath11 based on    * triangular elements @xmath179 , @xmath180 , such that @xmath181 * quadrilateral elements @xmath182 , @xmath183 , such that @xmath184    where @xmath185 and @xmath186 are the total numbers of the elements for each type of discretization ( in case of uniform triangulation one has @xmath187 ) . in our computational tests we will assume that the functions @xmath159 and @xmath160 are given either analytically , or in terms of the following fem representations @xmath188 @xmath189 where @xmath190 and @xmath191 are the given nodal values of the functions @xmath159 and @xmath160 , whereas @xmath192 are the basis functions ( linear in and bilinear in @xcite ) .",
    "we also discretize the reconstruction interval ( solution space ) @xmath193 $ ] with the step size @xmath178 as follows @xmath194      this approach is a variation of the geometric integration technique developed by min and gibou @xcite .",
    "the main idea behind both methods is decomposition of the domain @xmath11 into simplices , which in our simplest 2d case is represented by triangulation , and then approximating the level sets given by @xmath195 with piecewise linear splines inside each simplex ( triangle ) . while in the geometric integration approach of min and gibou one uses linear interpolation to refine locally the finite elements which contain the level sets @xmath195 and then the second  order midpoint rule for approximating line integrals over the selected simplices , in the present method we employ analogous approximations of the level sets , but without local refinement , to reduce line integral to a 1d definite integral which is then evaluated using standard quadratures .",
    "the starting point for this approach is formula . for a fixed value of @xmath149",
    "the corresponding level set can be described as @xmath196 where @xmath197 and @xmath198 is the total number of the finite elements containing segments of the level set @xmath155 .",
    "we thus need to approximate @xmath199 , i.e. , the line integral over the part of the level  set curve contained in the @xmath200-th finite element @xmath201 . in view of",
    ", the integrand expression @xmath202 can be approximated as @xmath203 where @xmath204 are the known nodal values of the function @xmath205 .",
    "an approximation @xmath206 of the part of the level set @xmath207 belonging to the @xmath200-th finite element can be obtained in an explicit form @xmath208 , @xmath209 $ ] , or a parametric form @xmath210 , @xmath211 with @xmath212 $ ] , based on representation of the level  set function @xmath213 .",
    "this leads to the following two possible reductions of the line integral to a definite integral    [ eq : int ] @xmath214    which can be evaluated using standard quadratures for 1d definite integrals .",
    "we then have @xmath215 we note that the accuracy of this approach is mainly determined by the order of interpolation used to represent the level set @xmath216 and the integrand expression @xmath217 which depend on the type of the finite elements used @xcite .",
    "( the error of the quadrature employed to evaluate does not have a dominating effect . ) as was mentioned in @xcite , the use of triangulation together with linear interpolation of @xmath159 and @xmath218 results in the overall second  order accuracy of this method .",
    "this approach has formula for its starting point and relies on a discrete approximation of the dirac delta function obtained by smereka in @xcite .",
    "it is derived via truncation of the discrete laplacian of the corresponding green s function .",
    "suppose the domain @xmath11 is covered with a uniform cartesian grid corresponding to , i.e. , with nodes @xmath219 , @xmath220 , where @xmath221 are integer indices , @xmath222 and @xmath177 is the step size . the first ",
    "order accurate approximation of the discrete dirac delta function at the node @xmath223 is @xmath224 where @xmath225 where for the discretized level  set function @xmath226 we have the following definitions @xmath227 and @xmath228 in which @xmath229 is used for regularization @xcite .",
    "the expressions @xmath230 , @xmath231 , @xmath232 are defined analogously . using the definition of the discrete delta function from",
    ", the value @xmath233 in can be thus approximated in the following way @xmath234 where @xmath235 are the nodal values of the function @xmath160 .",
    "we note that this method was validated in @xcite exhibiting the theoretically predicted first order of accuracy only in cases in which the level sets @xmath155 do not intersect the domain boundary @xmath12 , a situation which may occur in the present reconstruction problem .      our third method ,",
    "in which the level  set integral is approximated with an area integral defined over a region containing the level set @xmath155 , cf .  , appears to be a new approach and will be presented in some detail here .",
    "it consists of the following three steps    1 .   for a fixed value of the state variable",
    "@xmath236 we define the interval @xmath237 = [ s - \\frac{1}{2}h_t , s +    \\frac{1}{2}h_t ] \\subset \\l$ ] ; then , we have @xmath238 2 .",
    "now we define a subdomain @xmath239 which contains all the points of @xmath11 that lie between the two level  set curves @xmath240 and @xmath241 @xmath242 \\right\\ } ,      \\label{eq : omega_cont}\\ ] ] see figure [ fig : dom_int]a ; we then approximate @xmath243 with the region @xmath244",
    "\\right\\ } ,      \\label{eq : omega_fem}\\ ] ] see figure [ fig : dom_int]b , which consists of the quadrilateral finite elements @xmath245 , @xmath246 , with the center points @xmath247 satisfying the condition @xmath248 $ ] , 3 .   in view of , expression is approximated with an area integral over the region contained between the level  set curves @xmath240 and @xmath241 , which is in turn approximated by the fem region @xmath249 given by ; finally , the integral over this region is approximated using the standard 2d compound midpoint rule as @xmath250    as regards the accuracy of this approach , we have the following    formula is second order accurate with respect to the discretization of the space domain and first order accurate with respect to the discretization of the state domain , i.e. , @xmath251 [ thm : m3 ]    we start by integrating both sides of over the interval @xmath252 = [ s - \\frac{1}{2}h_t ;    s + \\frac{1}{2}h_t]$ ] obtaining @xmath253 g(\\x ) \\",
    "d\\x =      \\int_{\\omega } \\chi_{[s - \\frac{1}{2}h_t , s + \\frac{1}{2}h_t ] }      ( t(\\x ) ) \\",
    "g(\\x ) \\ d\\x ,      \\label{eq : dom_int_int}\\ ] ] where the characteristic function @xmath254 } ( t(\\x ) ) = \\left\\ {      \\begin{alignedat}{2 }      & 1\\quad & & \\textrm{for } \\",
    "t(\\x ) \\in [ t ' , t '' ] , \\\\      & 0 & & \\textrm{for } \\",
    "t(\\x ) \\notin [ t ' , t '' ]      \\end{alignedat }      \\right.\\ ] ] describes the subdomain @xmath255 introduced earlier in , cf .",
    "figure [ fig : dom_int]a .",
    "now , using a second  order accurate midpoint rule for 1d integration , we can express the lhs of as @xmath256 approximation of the rhs in takes place in two steps .",
    "in the first step we approximate the actual integration domain @xmath243 with the union of the finite elements @xmath249 , cf .  .",
    "in order to estimate the error @xmath257 of this step , we divide the set of cells @xmath258 into two subsets , see figure [ fig : dom_int]b , @xmath259 where @xmath260 consists of the cells with all 4 vertices @xmath261 satisfying the condition @xmath262 $ ] . the subregion @xmath263 , defined as the compliment of @xmath260 in @xmath258 , represents the union of `` truncated '' cells , i.e. , cells which have at least one node outside @xmath255 .",
    "this subregion is in turn further subdivided into two subsets , i.e. , @xmath264 where @xmath265 \\right\\},\\ ] ] @xmath266 \\right\\}.\\ ] ] we have to define one more set @xmath267 which consists of the cells with at least one vertex @xmath261 satisfying the condition @xmath262 $ ] , but whose center points @xmath247 lie outside @xmath243 .",
    "we also further subdivide this set into two subsets @xmath268 where @xmath269 \\right\\},\\ ] ] @xmath270 \\right\\}.\\ ] ] we thus have @xmath271 @xmath272 so that the domain approximation error can be estimated as follows @xmath273 where @xmath274 .",
    "the second error in the approximation of the rhs of is related to the accuracy of the quadrature applied to @xmath275 and for the 2d compound midpoint rule is @xmath276 , so that we obtain @xmath277 comparing with and dividing both sides into @xmath178 we finally obtain which completes the proof .",
    "so far , we have considered the discretizations of the physical and state spaces , @xmath11 and @xmath20 , as independent .",
    "we remark that using the relationship @xmath278 one could link the corresponding discretization parameters @xmath177 and @xmath178 to each other .",
    "in this section we discuss the accuracy and efficiency of the three methods for evaluation of expression presented in sections [ sec : line_int ] , [ sec : smereka_int ] and [ sec : domain_int ] . in order to assess their utility for the parameter reconstruction problem studied in this work , we will consider the following three test cases    1 .",
    "single ( fixed ) value of @xmath149 with @xmath159 and @xmath160 given analytically , 2 .",
    "parameter @xmath149 varying over a finite range with @xmath159 and @xmath160 given analytically , 3 .",
    "parameter @xmath149 varying over a finite range with @xmath159 and @xmath160 given in terms of solutions of the direct and adjoint problem .",
    "tests ( ii ) and ( iii ) with @xmath149 spanning the entire interval @xmath20 are particularly relevant for the present reconstruction problem , as they help us assess the accuracy of the cost functional gradients over their entire domains of definition , including the values of @xmath149 for which the level sets @xmath155 intersect the domain boundary @xmath12 .",
    "results of tests ( i)(iii ) are presented below .",
    "here we employ our three methods to compute numerically the value of a line integral over the circle @xmath279    1 .   in domain @xmath280 ^ 2 $ ] which contains the entire curve @xmath281 ( this test problem is actually borrowed from @xcite ) , 2 .   and in domain",
    "@xmath282 ^ 2 $ ] which contains only a part of the curve in the first quadrant @xmath283    the main difference between test cases ( a ) and ( b ) is that while in ( a ) the contour is entirely contained in the domain @xmath284 , it intersects the domain boundary @xmath285 in case ( b ) . as shown in figure [ fig : test1 ] , methods # 1 ( line integration ) and # 3 ( area integration ) in both cases show the expected accuracy of @xmath286 , where @xmath287 , @xmath288 , while method # 2 ( delta function approximation ) is @xmath289 accurate in case ( a ) and only @xmath290 accurate in case ( b ) .",
    "we also add that the line integration method exhibits the smallest constant prefactor characterizing the error .      in order to analyze this case",
    "we will introduce a new diagnostic quantity .",
    "we begin with the integral transform formula applied to some perturbation @xmath291 @xmath292 where @xmath157 . multiplying both sides of by @xmath160 , integrating over the domain @xmath11 and changing the order of integration we obtain the following useful identity @xmath293 with @xmath233 defined in , where the rhs has the structure of the riesz identity for the gteaux differential of the cost functional , cf .  , whereas the lhs is a simple area integral which can be easily evaluated using high  accuracy quadratures .",
    "given the formal similarity of the rhs of and the riesz formula , this test is quite relevant for the optimization problem we are interested in here .",
    "we will thus use our three methods to evaluate the rhs of and compared it to the lhs , which is evaluated with high precision on a refined grid in @xmath11 , so that it can be considered `` exact '' .",
    "our tests are based on the following data    * spatial domain @xmath294 ^ 2 $ ] discretized with @xmath295 , @xmath296 , * state domain @xmath193 $ ] , where @xmath297 , @xmath298 , discretized using @xmath299 points for methods # 2 and # 3 and @xmath300 points for method # 1 ; @xmath301 , * @xmath302 , @xmath303 , @xmath304 , * perturbations used @xmath305 , @xmath306 and @xmath307 , @xmath308 $ ] .    as is evident from figure [ fig : test2a ] ,",
    "all three methods show similar qualitative behavior , namely , the error decreases with decreasing @xmath177 until it saturates which is due to the error terms depending on @xmath178 becoming dominant .",
    "the saturation value of the error depends on the state space resolution @xmath178 and is different for the different methods .",
    "method # 3 ( area integration ) reveals accuracy @xmath286 , whereas method # 2 ( delta function approximation ) is again only of accuracy about @xmath309 for the same discretization of the interval @xmath20 .",
    "method # 1 ( line integration ) performs better and shows accuracy up to @xmath310 , but requires much finer resolution in the state space , namely @xmath311 ( @xmath312 ) is needed for this behavior to be visible . on the other hand , method # 3 ( area integration ) leads to the smallest errors for all the cases tested .",
    "analogous data is plotted in figure [ fig : test2b ] now as a function of the state space resolution @xmath178 with @xmath177 acting as a parameter .",
    "similar trends are observed as in figure [ fig : test2a ] , namely , the errors decrease with @xmath178 until they eventually saturate when the error terms depending on @xmath177 become dominant .",
    "methods # 1 and # 2 reveal accuracy @xmath313 , whereas method # 3 has accuracy @xmath314 which is actually better than stipulated by theorem [ thm : m3 ] , cf .  .",
    "method # 3 is also characterized by the smallest value of the constant prefactor leading to the smallest overall errors .",
    "we now repeat the test described in section [ sec : test_2 ] using @xmath157 and @xmath315 : \\bnabla \\u^*(\\x)$ ] , where the fields @xmath82 , @xmath6 and @xmath100 come from the solutions of the direct and adjoint problem  and  at some fixed time @xmath80 , see figure [ fig : test3_fields ] ( details of these computations will be given in section [ sec : estim ] ) . as before , we discretize the domain @xmath294 ^ 2 $ ] with the step @xmath316 , @xmath296 , and the state space @xmath193 $ ] , @xmath297 and @xmath298 , with the step @xmath317 ( @xmath318 ) .    the data shown in figure [ fig : test3 ] confirms our findings from sections [ sec : test_1 ] and [ sec : test_2 ] , namely , that in this case as well the error of all three methods decreases with @xmath177 until it eventually saturates when the errors depending on @xmath178 become dominant .",
    "method # 3 is again characterized by the smallest prefactor and hence leads to much smaller overall errors than in methods # 1 and # 2 .",
    "the computational complexity of our three approaches is addressed in figure [ fig : cpu_time ] , where @xmath319 is defined as a number of computational elements , i.e. , @xmath320 , or @xmath321 , using or , respectively .",
    "we see that , while the complexity of methods # 1 and # 2 scales as @xmath322 , method # 3 exhibits the scaling of @xmath323 . on the other hand , however , method # 3 has the smallest prefactor and , at least in the range of resolutions considered here , results in the shortest execution time .    in conclusion , these observations make the area integration approach ( method # 3 ) the method of choice for the present parameter reconstruction problem , and this is the approach we will use in all subsequent computations .     of computational elements used in the different approaches , namely , ( triangles ) finite elements @xmath179 in the line integration approach ( method # 1 ) , ( circles ) grid nodes in the method of the delta function approximation ( # 2 ) and ( asterisks ) finite elements @xmath182 in the area integration approach ( # 3 ) .",
    "the data shown corresponds to the estimation of the rhs in for @xmath324 using the same discretization of the state space with @xmath318 , @xmath325 and @xmath326 : \\bnabla \\u^ *    $ ] obtained by solving  and .,scaledwidth=50.0% ]      for validation purposes one needs an algebraic expression to represent the dependence of the viscosity coefficient on temperature which could serve as the `` true '' material property we will seek to reconstruct .",
    "the dynamic viscosity in liquids is usually approximated by exponential relations @xcite and one of the most common expression for the coefficient of the dynamic viscosity is the law of andrade ( also referred to as the nahme law ) which is given in the dimensional form valid for @xmath6 expressed in kelvins in below @xmath327 where @xmath328 are constant parameters . as regards the thermal conductivity @xmath329 , since it typically reveals a rather weak dependence on the temperature , for the sake of simplicity we will treat it as a constant setting @xmath330 in all computations presented in this paper .      to validate the accuracy and performance of the proposed approach to reconstruct @xmath28",
    ", we use a simple 2d lid  driven ( shear  driven ) cavity flow , cf .",
    "figure [ fig : cavity ] , as our model problem . due to the simplicity of its geometry and boundary conditions , the lid  driven cavity flow problem has been used for a long time to validate novel solution approaches and codes @xcite .",
    "numerical results are available for different aspect ratios and the problem was solved in both laminar and turbulent regimes using different numerical techniques .",
    "thus , this problem is a useful testbed as there is a great deal of numerical data that can be used for comparison .",
    "our code for solving direct problem  and adjoint problem  has been implemented using freefem++ @xcite , an open  source , high  level integrated development environment for the numerical solution of pdes based on the the finite element method .",
    "the direct solver has been thoroughly validated against available benchmark data from @xcite , and all details are reported in @xcite .        to solve numerically the direct problem we discretize system  in time using a second  order accurate semi - implicit approach .",
    "spatial discretization is carried out using triangular finite elements and the p2 piecewise quadratic ( continuous ) representations for the velocity @xmath82 and the temperature @xmath6 fields , and the p1 piecewise linear ( continuous ) representation for the pressure @xmath91 field .",
    "the system of algebraic equations obtained after such discretization is solved at every time step with umfpack , a solver for nonsymmetric sparse linear systems @xcite .",
    "we add that incompressibility is ensured by an implicit treatment of equation .",
    "stability is enforced by choosing the time step @xmath331 so that it satisfies the following cfl condition @xmath332 the same technique is used for the numerical solution of adjoint problem .",
    "all our computations are performed using a 2d square domain @xmath333 ^ 2 $ ] shown in figure [ fig : cavity ] .",
    "governing system  and adjoint system  are discretized on a uniform mesh with @xmath334 grid points in every direction using triangular finite elements combined with the cubic spline interpolation of the function @xmath335 .",
    "the rather modest spatial resolution used is a consequence of the fact that in a single reconstruction problem the governing and adjoint systems need to be solved @xmath336 times , hence there are limitations of the computational time . unless stated otherwise , the interval @xmath337 $ ] is discretized using an equispaced grid with @xmath338 points .",
    "the actual constitutive relation @xmath339 we seek to reconstruct is given by andrade law with @xmath340 and @xmath341 .",
    "in the computational tests reported below we used @xmath342 measurement points distributed uniformly inside the cavity ( figure [ fig : cavity ] ) . to mimic an actual experimental procedure , first relation is used in combination with governing system  to obtain pointwise temperature measurements @xmath343 .",
    "relation is then `` forgotten '' and is reconstructed using gradient  based algorithm . in terms of the initial guess in , unless stated otherwise , we take a constant approximation @xmath65 to , given by @xmath344 which translates into the following expression for the new optimization variable @xmath48 , cf .  ,",
    "@xmath64 , where @xmath345 .",
    "since in the present problem the viscosity @xmath28 is a function of the temperature , the reynolds number is defined locally ( both in space and in time ) and varies in the range @xmath346 .    unless stated otherwise , the boundary conditions for the temperature are @xmath347 and @xmath348 which results in the identifiability region @xmath349 $ ] .",
    "the velocity boundary conditions @xmath350^t$ ] are given by @xmath351 , @xmath352 and @xmath353 on the top boundary segment and @xmath354 on the remaining boundary segments .",
    "their time ",
    "dependent character ensures that the obtained flow is unsteady at the values of the reynolds number for which self  sustained oscillations do not spontaneously occur ( the study of higher reynolds numbers was restricted by the numerical resolution used , see comments above ) .",
    "the initial conditions @xmath355 used in the reconstruction problem correspond to a developed flow obtained at @xmath356 from the following initial and boundary conditions @xmath357 , @xmath358 and @xmath359 ,",
    "@xmath353 , @xmath354 , @xmath360 , @xmath361 .",
    "we emphasize that adjoint system  is in fact a terminal ",
    "value problem which needs to be integrated backwards in time , and its coefficients depend on the solution @xmath362 of the direct problem around which linearization is performed at the given iteration .",
    "our reconstructions are performed using the following time windows @xmath363 $ ] , @xmath364 which correspond to a fraction of , or a full , forcing cycle in the boundary conditions described above .",
    "these time windows are all discretized with the time step @xmath365 in both the direct and adjoint problems .",
    "this choice of the time step @xmath331 ensures stability by satisfying the cfl condition .      in this section we present results demonstrating the consistency of the cost functional gradients obtained with the approach described in section [ sec : grad_adj ] . in figure",
    "[ fig : grads ] we present the @xmath119 and several sobolev @xmath146 gradients obtained at the first iteration . in the first place",
    ", we observe that , as was anticipated in section [ sec : grad_adj ] , the @xmath119 gradients indeed exhibit quite irregular behaviour lacking necessary smoothness which makes them unsuitable for the reconstruction of constitutive relations with required properties , cf .  . on the other hand ,",
    "the gradients extracted in the sobolev space @xmath146 are characterized by the required smoothness and therefore hereafter we will solely use the sobolev gradients . next , in figure [ fig : kappa_test ] we present the results of a diagnostic test commonly employed to verify the correctness of the cost functional gradient @xcite .",
    "it consists in computing the directional gteaux differential @xmath108 for some selected perturbations @xmath78 in two different ways , namely , using a finite  difference approximation and using which is based on the adjoint field , and then examining the ratio of the two quantities , i.e. , @xmath366 } { \\int_{-\\infty}^{+\\infty } \\bnabla_{\\theta } \\j ( s ) \\ , \\theta'(s ) \\ , ds } \\label{eq : kappa}\\ ] ] for a range of values of @xmath96 .",
    "if the gradient @xmath367 is computed correctly , then for intermediate values of @xmath96 , @xmath368 will be close to the unity .",
    "remarkably , this behavior can be observed in figure [ fig : kappa_test ] over a range of @xmath96 spanning about 6 orders of magnitude for three different perturbations @xmath369 .",
    "furthermore , we also emphasize that refining the time step @xmath331 used in the time ",
    "discretization of  and  yields values of @xmath370 closer to the unity .",
    "the reason is that in the `` optimize  then  discretize '' paradigm adopted here such refinement of discretization leads to a better approximation of the continuous gradient .",
    "we add that the quantity @xmath371 plotted in figure [ fig : kappa_test]b shows how many significant digits of accuracy are captured in a given gradient evaluation . as can be expected",
    ", the quantity @xmath368 deviates from the unity for very small values of @xmath96 , which is due to the subtractive cancellation ( round  off ) errors , and also for large values of @xmath96 , which is due to the truncation errors , both of which are well  known effects .",
    "gradient @xmath372 and the sobolev gradients @xmath373 defined in for different values of the smoothing coefficient ( thick dashed line ) @xmath374 , ( thick dash  dotted line ) @xmath375 and ( thick solid line ) @xmath376 at the first iteration with the initial guess @xmath377 .",
    "the vertical dashed lines represent the boundaries of the identifiability interval @xmath24 and the vertical scale in the plot is arbitrary.,scaledwidth=80.0% ]      we solve minimization problem using the steepest descent ( sd ) , conjugate gradient ( cg ) and bfgs algorithms @xcite and , unless indicated otherwise , using sobolev gradients computed with @xmath378 which was found by trial  and  error to result in the fastest rate of convergence of iterations .",
    "the termination condition used was @xmath379 .",
    "the behavior of the cost functional @xmath380 as a function of the iteration count @xmath63 is shown in figure [ fig : cf]a for all three minimization algorithms ( sd , cg and bfgs ) .",
    "we note that in all cases a decrease over several orders of magnitude is observed in just a few iterations .",
    "since the three descent methods tested reveal comparable performance , our subsequent computations will be based on the steepest descent method as the simplest one of the three .",
    "the effect of the different initial guesses @xmath65 on the decrease of the cost functional is illustrated in figure [ fig : cf]b .",
    "again , a substantial decrease of the cost functional corresponding to about 56 orders of magnitude is observed for all the initial guesses tested .",
    "reconstructions @xmath381 of the constitutive relation obtained using the initial guess @xmath382 and the optimization time windows with @xmath383 are shown in figure [ fig : base_t-4 ] . comparing the accuracy of the reconstruction obtained for these different time windows , we can conclude that better results are achieved on shorter time windows @xmath384 .",
    "given considerations of the computational time , hereafter we will therefore focus on the case with @xmath385 . in figure",
    "[ fig : new_guess ] we show the reconstructions @xmath381 of the constitutive relation obtained from different initial guesses already tested in figure [ fig : cf]b such as constant values of @xmath65 , @xmath386 varying linearly with the temperature @xmath6 and @xmath65 given as a rescaling of the true relationship @xmath387 .",
    "as expected , the best results are obtained in the cases where some prior information about the true material property is already encoded in the initial guess @xmath65 , such as the slope , cf .",
    "figure [ fig : new_guess]c , or the exponent , cf .",
    "figure [ fig : new_guess]d . we may also conclude that",
    ", since all the reconstructions shown in figures [ fig : base_t-4 ] and [ fig : new_guess ] are rather different , the iterations starting from different initial guesses converge in fact to different local minimizers .",
    "however , it should be emphasized that in all cases the reconstructions do capture the main qualitative features of the actual material property with differences becoming apparent only outside the measurement span interval @xmath26 . in order to make our tests more challenging , in the subsequent computations we will use the initial guess @xmath388 ( cf .",
    "figure [ fig : base_t-4 ] ) which contains little prior information about the true material property .    in figure",
    "[ fig : shift_combo ] we show the results of the reconstruction performed with a larger identifiability region @xmath389 = \\l$ ] which is done by adopting the corresponding values for temperature boundary conditions , i.e. , @xmath390 and @xmath391 .",
    "we note that in this case the target interval for the reconstruction @xmath20 has been chosen to coincide with identifiability interval @xmath24 . fairly accurate",
    "reconstruction can be observed in this problem as well , and we emphasize that this is also the case for values of the temperature outside the identifiability interval studied in the previous case .",
    "this example demonstrates that accurate reconstruction on different intervals @xmath20 can in fact be achieved by adjusting the identifiability region via a suitable choice of temperature boundary conditions .",
    "this process can be interpreted as adjusting the conditions of the actual experiment used to obtain the measurements @xmath392 .      in this section",
    "we first assess the effect of noise on the reconstruction without the tikhonov regularization and then study the efficiency of the regularization techniques introduced in section [ sec : reg ] . in figure",
    "[ fig : noise_tikh]a , b we revisit the case already presented in figure [ fig : base_t-4]a ( reconstruction on the interval @xmath393 $ ] with the identifiability region @xmath394 $ ] ) , now for measurements contaminated with 0.05% , 0.1% , 0.3% , 0.5% and 1.0% uniformly distributed noise and without tikhonov regularization . to incorporate noise , say of @xmath395 , into the measurements @xmath9 , we replace these measurements at every discrete time step @xmath396 $ ] with a new set @xmath397 , where the independent random variables @xmath398 have a uniform distribution with the mean @xmath399 and the standard deviation @xmath400 . unless stated otherwise , in order to be able to directly compare reconstructions from noisy measurements with different noise levels , the same noise realization is used after rescaling to the standard deviation @xmath401 . as expected , in figure [ fig : noise_tikh]a , b we see that increasing the level of noise leads to oscillatory instabilities developing in the reconstructed constitutive relations @xmath381 .",
    "we note that the reconstructions become poor already for relatively low noise levels , i.e. , on the order of @xmath402 .",
    "one reason for this seems to be the time - dependent nature of the problem in which independent noise is added to the measurements at every ( discrete ) time instant leading to accumulation of uncertainty .",
    "indeed , such loss of information was not observed in the case of the _ steady _ problem studied in @xcite where reliable reconstructions could be obtained with noise levels an order of magnitude larger than in the present investigation . in regard to the results shown in figure [ fig : noise_tikh]a , b , we add that the pattern introduced by the noise in the reconstructions depends on the specific noise sample used ( which was the same for all the reconstructions shown in the figure ) .",
    "reconstructions performed using different realizations of the noise produce distinct patterns in the reconstructed constitutive relations @xmath381 . in our computational experiments",
    "we also observe that inclusion of noise in the measurements tends to replace the original minimizers with perturbed ones ( this is evident from the uniform , with respect to @xmath6 , convergence of the perturbed minimizers to the noise - free reconstructions as the noise level goes to zero in figure [ fig : noise_tikh]a , b ) .",
    "the effect of the tikhonov regularization is studied in figure [ fig : noise_tikh]c , d , where we illustrate the performance of the technique described in section [ sec : reg ] , cf .",
    ", on the reconstruction problem with 1.0% noise in the measurement data ( i.e. , the `` extreme '' case presented in figures [ fig : noise_tikh]a , b ) . in terms of the ( constant ) reference function",
    "we take @xmath403 , where @xmath404 .",
    "we note that by increasing the values of the regularization parameter @xmath145 in from 0 ( no regularization ) to 2500 we manage to eliminate the instabilities caused by the presence of noise in the measurements and obtain as a result smoother constitutive relations , cf .",
    "figure [ fig : noise_tikh]c , d .",
    "we add that , while after introducing the tikhonov regularization the reconstructed solutions converge in fact to different local minimizers ( in comparison with the reconstructions without noise ) , this does not prevent the reconstructions from capturing the main qualitative features of the actual material property .",
    "systematic methods for determining the optimal values of regularization parameters are discussed for instance in @xcite .",
    "finally , in figure [ fig : noise_avr ] we present the relative reconstruction errors @xmath405 obtained using the approach described earlier in section [ sec : reg ] for data with different noise levels and averaged over 10 different noise samples . from figure [ fig : noise_avr ] we conclude that larger values of the regularization parameter @xmath145 are required for more noisy measurements .",
    "we close this section by concluding , in agreement with our earlier results reported in @xcite , that tikhonov regularization performs as expected in problems with noise present in the measurement data .",
    "reconstruction errors @xmath406 obtained in the presence of noise with the amplitude indicated and averaged over 10 samples : ( dash  dotted line ) reconstruction with sobolev gradients and without tikhonov regularization , and ( solid line ) reconstruction with @xmath407 tikhonov regularization term [ ( circles ) @xmath408 , ( triangles ) @xmath409 . the thick dashed line represents the `` error '' in the exact material property obtained by adding noise to @xmath6 and averaging over time steps.,scaledwidth=50.0% ]",
    "we developed an optimization  based approach to the problem of reconstructing temperature  dependent material properties in complex thermo  fluid systems .",
    "as a model problem we considered two  dimensional unsteady flows in a lid  driven cavity involving also heat transfer .",
    "a key element of this approach is the gradient of the cost functional which is computed based on a suitably  defined adjoint system , and is shown to have mathematical structure different than in most problems involving adjoint  based pde optimization .",
    "we discussed three different numerical approaches to evaluation of these cost functional gradients which are given in terms of integrals defined on the level sets of the temperature field .",
    "as compared to earlier work on the numerical approximation of such expressions @xcite , we also addressed at length the question of the discretization of the solution space which is specific to our reconstruction problem .",
    "evidence is shown for the superior performance with respect to the discretizations of the physical and the solution space , as well as the computational time , of a new approach to evaluation of gradients which is proposed in this study .",
    "the reconstruction results obtained demonstrate good performance of the algorithm , in particular , it is shown that by suitably adjusting the boundary conditions in the governing system we can extend the identifiability region .",
    "there are two comments we wish to make concerning these results .",
    "as regards the data shown in figure [ fig : base_t-4 ] , it might appear somewhat surprising that reconstructions on longer time windows ( which use more information from the measurements ) do not necessarily lead to better results .",
    "a probable reason is that such reconstruction problems defined on longer time windows tend to be harder to solve numerically , hence the solutions found may not be global minimizers ( or even `` good '' local ones ) .",
    "another comment we have concerns the relatively modest noise levels for which stable reconstructions could be obtained in section [ sec : noise ] .",
    "we note that inclusion of even a small amount of noise could alter the nature of the reconstructed constitutive relations . on the other hand",
    ", we also remark that reconstructions performed based on a steady - state problem and reported in @xcite did allow for significantly higher noise levels .",
    "we therefore conjecture that the sensitivity to noise in the present problem is related to its time - dependent character , as here the effect of instantaneously small noise levels may be compounded by its continuous accumulation over the entire time window .",
    "since the flow problem studied here was admittedly very simple , this issue may certainly limit the applicability of the proposed method to problems characterized by higher reynolds numbers and therefore merits a more thorough study in the future ( this is not the question of the numerical resolution alone , but rather of the interplay between this resolution and the complexity of the underlying optimization problem ) .",
    "experience with other data assimilation problems may suggest that acquiring the measurements less frequently in time may actually help mitigate this effect .",
    "the approach developed in the present study was recently successfully applied to the problem of system identification involving a dynamical system in the phase - space representation .",
    "more precisely , in @xcite we used this method to reconstruct an invariant manifold in a realistic reduced - order model of a hydrodynamic instability .",
    "our future work will involve extensions of the present approach to more complicated problems involving systems of coupled pdes depending on time and defined on domains in three dimensions . in the context of such systems",
    "an interesting issue is the reconstruction of anisotropic constitutive relations .",
    "a more challenging problem is related to reconstruction of constitutive relations in systems involving phase changes .",
    "in addition to the governing pde in the form of a free  boundary problem , one would also have to deal with constitutive relations with distinct functional forms in each of the phases .",
    "interesting questions also arise in the reconstruction of material properties defined on the interfaces between different phases , such as for example the temperature  dependent surface tension coefficient playing an important role in marangoni flows . in the study of such more complicated problems close attention will need to be paid to the question of ensuring consistency of the reconstructed constitutive relation with the second principle of thermodynamics , which can be done by including a form of the clausius  duhem inequality @xcite in the optimization formulation .",
    "in such more general problems it is not obvious whether this additional constraint can be eliminated by introducing a slack ",
    "variable formulation similar to the one used in this study , and one may have to perform numerical optimization in the presence of inequality constraints .",
    "these questions are left for future research .",
    "the authors wish to acknowledge generous funding provided for this research by the natural sciences and engineering research council of canada ( collaborative research and development program ) , ontario centres of excellence  centre for materials and manufacturing , and general motors of canada .",
    "the authors are also thankful to professor j.  sesterhenn for bringing to their attention the slack ",
    "variable approach to ensuring the positivity of the reconstructed material property .",
    "v.  bukshtynov , _ computational methods for the optimal reconstruction of material properties in complex multiphysics systems _ , ph.d .",
    "dissertation , mcmaster university , open access dissertations and theses .",
    "paper 6795 .",
    "+   http://digitalcommons.mcmaster.ca/opendissertations/6795 , ( 2012 ) .",
    "c.  e.  prez , j .-",
    "thomas , s.  blancher and r.  creff , `` the steady navier ",
    "stokes / energy system with temperature  dependent viscosity ",
    "part 1 : analysis of the continuous problem '' , _ international journal for numerical methods in fluids _ * 56 * , 6389 , ( 2007 ) ."
  ],
  "abstract_text": [
    "<S> we develop an optimization  based approach to the problem of reconstructing temperature  dependent material properties in complex thermo  fluid systems described by the equations for the conservation of mass , momentum and energy . </S>",
    "<S> our goal is to estimate the temperature dependence of the viscosity coefficient in the momentum equation based on some noisy temperature measurements , where the temperature is governed by a separate energy equation . </S>",
    "<S> we show that an elegant and computationally efficient solution of this inverse problem is obtained by formulating it as a pde  constrained optimization problem which can be solved with a gradient  based descent method . </S>",
    "<S> a key element of the proposed approach , the cost functional gradients are characterized by mathematical structure quite different than in typical problems of pde  constrained optimization and are expressed in terms of integrals defined over the level sets of the temperature field . </S>",
    "<S> advanced techniques of integration on manifolds are required to evaluate numerically such gradients , and we systematically compare three different methods . as a model system </S>",
    "<S> we consider a two  dimensional unsteady flow in a lid  driven cavity with heat transfer , and present a number of computational tests to validate our approach and illustrate its performance . </S>",
    "<S> + * keywords : * parameter estimation , material properties , optimization , adjoint analysis , integration on level sets .    </S>",
    "<S> @xmath0school of computational science and engineering , mcmaster university + 1280 main street west , hamilton , ontario , canada l8s 4k1 + e - mail : bukshtu@math.mcmaster.ca + @xmath1department of mathematics and statistics , mcmaster university + 1280 main street west , hamilton , ontario , canada </S>",
    "<S> l8s 4k1 + e - mail : bprotas@mcmaster.ca </S>"
  ]
}