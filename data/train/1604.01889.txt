{
  "article_text": [
    "since many medical tasks are based on non - rigid image registration , the trustworthiness of registered images , which is also known as the registration uncertainty , is considered critical . due to factors such as the high degree of freedom in the non - rigid transformation model , the presence of homogeneous intensity regions and the variability of human anatomy , it is insufficient to only report a unique transformation for non - rigid registration . in order to characterize the registration uncertainty ,",
    "recent non - rigid registration methods have been adapted to a probabilistic framework that estimates the posterior distribution of transformation @xcite@xcite@xcite@xcite@xcite@xcite .",
    "probabilistic non - rigid registration methods can be broadly categorized into discrete probabilistic registration ( dpr ) and continuous probabilistic registration ( cpr ) .",
    "the transformation posteriors estimated by dpr and cpr have different forms .",
    "dpr discretizes the transformation space into a set of displacement vectors .",
    "then it uses discrete optimization techniques , such as a graph - based approach , to compute a categorical distribution as the transformation posterior @xcite@xcite@xcite@xcite .",
    "cpr is essentially a bayesian registration framework , with the estimated transformation posterior given by a multivariate continuous distribution @xcite@xcite .",
    "the conventional way of interpreting the transformation posterior is to use the mode as the most likely transformation and assign its corresponding intensity to the registered voxel .",
    "subsequently , summary statistics of the posterior are employed to evaluate the registration uncertainty .",
    "various summary statistics have been used in the probabilistic registration literature .",
    "the shannon entropy was used to measure the registration uncertainty of dpr @xcite .",
    "meanwhile , the variance @xcite , standard deviation @xcite , inter - quartile range @xcite and covariance frobenius norm @xcite of the transformation posterior were used to quantify the registration uncertainty of cpr . in order to visually assess the registration uncertainty ,",
    "each of these summary statistics was either mapped to a color scheme , or an object overlaid on the registered image . by inspecting the color or the object s geometry",
    ", clinicians can infer the trustworthiness of the appearance for the registered image .    in the past few years , researchers almost exclusively used the above convention to interpret the transformation posterior . despite the wide acceptance , this convention has never been justified .",
    "is it appropriate to assign the corresponding intensity of the posterior mode to the registered voxel ?",
    "do those summary statistics truly give insight on the trustworthiness of the registered image ? in the following sections , based on illustrative examples , we question the correctness and usefulness of conventional methods . in order to faithfully translate the transformation posterior , we propose to encode the variability of values by a novel data type called _",
    "ensemble fields_. ensemble fields can serve as a valuable complement to the registered image and a foundation for developing advanced methods to characterize the uncertainty in registration - based tasks .",
    "we also demonstrate its potential using pilot examples .",
    "conventional methods interpret the transformation posterior by : ( 1 ) using the posterior mode as the most likely transformation and assigning its corresponding intensity to the registered voxel . ( 2 ) employing summary statistics of the transformation posterior to evaluate the registration uncertainty . based on illustrative examples ,",
    "we question the correctness of ( 1 ) and the usefulness of ( 2 ) .    for the convenience of illustration , we use rwir as the probabilistic registration scheme in all examples @xcite@xcite@xcite . in the rwir setting , let @xmath0 and @xmath1 respectively be the fixed and moving image @xmath2 .",
    "rwir discretizes the transformation space into a set of @xmath3 displacement vectors @xmath4 .",
    "these displacement vectors radiate from voxels on @xmath0 and point to their candidate corresponding locations on @xmath1 . for every voxel @xmath5",
    ", the algorithm computes a unity - sum probabilistic vector @xmath6 as the transformation posterior .",
    "@xmath7 is the corresponding probability of displacement vector @xmath8 .",
    "the most likely transformation @xmath9 for @xmath5 is the displacement in @xmath10 that has the highest probability in @xmath11 .",
    "probabilistic registration methods estimate a transformation posterior .",
    "conventionally , researchers impose the intensity corresponding to the most likely transformation , which is the posterior mode , on the registered voxel as the most likely intensity . however , does the corresponding intensity of the most likely transformation always equal to the most likely intensity estimated by the posterior ?        in a hypothetical setting , assuming @xmath12 on @xmath13 is the voxel we want to register . as shown in fig.1(a ) , the transformation @xmath14 is a set of 8 displacement vectors .",
    "@xmath15 is the posterior of @xmath10",
    ". the corresponding intensity values , which are intensities of those corresponding locations on @xmath1 , of all displacement vectors in @xmath10 are stored in @xmath16 . for clarity , suppose that there are only two different intensity values in @xmath17 , one is 50 , and the other is 200 .",
    "the color of squares in fig.1(a ) indicates the appearance of that intensity value .",
    "fig.1(b ) is a bar chart illustrating the transformation posterior .",
    "we can observe that @xmath18 is the most likely transformation @xmath19 .",
    "conventionally , the corresponding intensity of the most likely transformation @xmath20 will be assigned to the registered @xmath12 .    .",
    "the color of each bar indicates the appearance of @xmath21 ; ( b)intensity histogram of the registered @xmath12.,height=124 ]    [ fig : correct2 ]    the probability of @xmath18 is considerably higher than that of other displacement vectors .",
    "based on the common sense , the intensity of registered @xmath12 should be trustworthy .",
    "however , if we take into account the intensity value @xmath21 associated with each @xmath22 , and form an intensity distribution from the transformation posterior , as shown in fig.2 , it is clear that @xmath23 is not the most likely intensity .",
    "displacement vectors in @xmath24 are not the most likely transformation , yet their combined corresponding intensities outweigh @xmath25 .",
    "this counter intuitive result implies that the corresponding intensity of the most likely transformation can differ from the most likely intensity estimated by the posterior .",
    "extreme cases like the above example may not happen in practice , yet we can still question this convention whether it is reasonable to disregard the intensity value associated with the transformation posterior .",
    "more precisely , in a probabilistic registration setting , the transformation @xmath26 and the intensity value @xmath27 are both regarded as random variables .",
    "imposing the corresponding intensity of the most likely transformation on the registered voxel is equivalent to regarding the mode of @xmath26 as if it is the mode of @xmath27 .",
    "even @xmath26 and @xmath27 are intuitively correlated to each other , this slightly reckless approach is questionable .      after assigning the intensity of the most likely transformation to every registered voxel ,",
    "it is again a convention to employ summary statistics of the transformation posterior to evaluate the registration uncertainty , that is the trustworthiness of the registered image . in most cases ,",
    "these summary statistics are mapped to a color scheme and overlaid on the registered image . by interpreting colors of registered voxels",
    ", clinicians can infer the trustworthiness of the registration result .",
    "such a convention is useful in a sense that it can quickly draw clinicians attention to regions with high transformation uncertainty .",
    "however , does high transformation uncertainty always indicate high registration uncertainty ?    in another hypothetical setting , assuming @xmath28 on @xmath13 is the voxel we want to register . as shown in fig.3(a ) , the transformation @xmath29 is a set of 4 displacement vectors .",
    "@xmath30 is the posterior of @xmath10 .",
    "the corresponding intensity values of all displacement vectors in @xmath10 are stored in @xmath31 .",
    "since @xmath18 is the most likely transformation , @xmath32 will be assigned to the registered @xmath28 . for a categorical posterior ,",
    "the conventional way of evaluating the transformation uncertainty is using the shannon entropy . in this example , the shannon entropy @xmath33 . given the size of @xmath34 , @xmath35 is a considerably large entropy , hence the registration uncertainty of @xmath28 is suggested high by the conventional method . however , once again , we take into account the intensity value @xmath21 associated with each displacement vector @xmath22 . as shown on fig.3(b ) , even @xmath36 and @xmath37 are different displacement vectors , they correspond to the same intensity value . by the generated intensity histogram in fig.3(c ) , we can see the only possible intensity value for @xmath28 is in fact equal to @xmath32 .",
    "therefore , the appearance of the registered voxel is quite trustworthy which contradicts with the outcome of the conventional method .    .",
    "the color of each bar indicates the appearance of @xmath21 ; ( c)intensity histogram of the registered @xmath28.,height=105 ]    [ fig : useful ]    the above example implies that high transformation uncertainty does not guarantee high registration uncertainty . in practice , homogeneous intensity regions , such as the center of a tumor ,",
    "sometimes can `` fool '' the registration algorithm to estimate diverse transformation . due to using transformation uncertainty to evaluate the registration uncertainty , conventional methods are prone to false results for those regions @xcite@xcite . in a probabilistic registration setting , since the transformation @xmath26 and the intensity value @xmath27 are considered random variables , employing shannon entropy @xmath38 of the transformation posterior to indicate the trustworthiness of the intensity is similar to using the @xmath38 of @xmath26 to infer the variance of @xmath39 , which is obviously ineffective .",
    "the conventional interpretation of the transformation posterior has two drawbacks : ( 1 ) using summary statistics to give a quick and simple description of the transformation posterior and therefore disregarding the rich information that may impact the subsequent registration - base tasks ; ( 2 ) inferring the registration uncertainty solely by the transformation uncertainty and overlooking the influence of other variables , such as the intensity .    in order to faithfully translate the transformation posterior and",
    "eventually characterize the uncertainty of registration - based tasks , we reinterpret the transformation posterior by encoding the variability of values into a novel data type called _",
    "ensemble fields_.      ensemble fields are a special type of volume data that is used to store possible outcomes of a numerical simulation @xcite .",
    "[ fig : compare ]    let @xmath40 be the type of values that can be @xmath41 as well as categorical .",
    "in an ensemble field , each voxel corresponds to a random variable @xmath42 . to account for variability , @xmath43 realizations of @xmath44 , forming a distribution ,",
    "are stored in every voxel of an ensemble field . based on the type of stored values ,",
    "ensemble fields can be categorized into scalar ensemble fields , vector ensemble fields , etc .",
    "if a volume data stores intensity distribution , like those in fig.2(b ) and fig.3(c ) , then it is a scalar ensemble field .",
    "fig.4 illustrates the difference between a voxel of regular volume data and that of a scalar ensemble field . at the current stage ,",
    "we construct ensemble fields by aggregating the probability over each realization . in the future",
    ", we can also add regularization to meet higher level demands .",
    "the goal of this paper is to introduce ensemble fields so that researchers can use it as a foundation and develop advanced method to characterize the uncertainty of registration - based tasks . in this section ,",
    "we give four pilot examples explaining scenarios when utilizing ensemble fields is useful .     and",
    "@xmath45 ; ( c ) intensity distributions of @xmath46 and @xmath45 being stored in the scalar ensemble.,height=188 ]    [ fig : compare ]    [ [ estimating - the - trustworthiness - of - registered - images ] ] estimating the trustworthiness of registered images + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    estimating the registration uncertainty is the most straightforward application of ensemble fields .",
    "this task can be done by measuring the variance of the generated scalar ensemble fields . in an example with synthetic 2d images , we registered a circle to an ellipse by a rwir having 121 displacement vectors . to give more insight",
    ", we take a close look at two voxels , @xmath46 near the edge of the eclipse on the registered moving image @xmath47 , and @xmath45 at the center of the eclipse . as can be seen from fig.5(b ) , the transformation posteriors of @xmath45 is more uniformly distributed than that of @xmath46 .",
    "conventionally , @xmath45 is likely to be reported having higher registration uncertainty than @xmath46 .",
    "however , once we construct a scalar ensemble field and measure the intensity variance , which can be inferred from fig.5(c ) , it turns out that the registered @xmath46 is less trustworthy than @xmath45 .",
    "in fact , as shown in fig.5(a ) , voxels with high registraton unceratinty are all located near the edge of the ellipse .    [",
    "[ computer - aided - diagnosis ] ] computer aided diagnosis + + + + + + + + + + + + + + + + + + + + + + + +    accurate segmentation labels are important for computer aided diagnosis ( cad ) .",
    "one viable automatic segmentation strategy is the probabilistic atlas - image registration , by which the labels on the atlas are propagated to voxels on the image . using label ensemble fields , we can account the uncertainty of label propagation , and thus efficiently capture the subject variability . in the example shown in fig.6(a )",
    ", we propagate the ventricle label from @xmath1 to @xmath0 . by rwir",
    ", we can obtain a label distribution for every voxel on @xmath0 and compute a probability map of the ventricle label .",
    "results are presented in fig.6(b ) and fig.6(c ) respectively .",
    "brighter colors indicate higher probabilities .     and the distorted image @xmath0 ; ( b)intensity iso - contours as the possible tumor boundaries.,title=\"fig : \" ] [ fig : prob1_6_2 ]     and the distorted image @xmath0 ; ( b)intensity iso - contours as the possible tumor boundaries.,title=\"fig : \" ] [ fig : prob1_6_1 ]    [ [ visualization ] ] visualization + + + + + + + + + + + + +    visualization is another promising field to utilize ensemble fields .",
    "for instance , when clinicians investigate the boundary of a tumor on the registered image , they often focus on voxels near the tumor boundary .",
    "if the conventional color coding of these voxels indicates low uncertainty , then the boundary they are currently seeing is trustworthy . in case",
    "these voxels uncertainty is suspected high , it should be made clear that how the tumor boundary may vary according to transformation posterior .",
    "conventional summary statistics based visualization methods discard the intensity information and can not depict possible appearance changes of the image .",
    "one way to achieve this is using scalar ensemble fields . in fig.7(a ) , we distorted the image @xmath1 and set it to @xmath0 . after generating the scalar ensemble field , we thresholded on a manually set intensity value and displayed its iso - contours as the possible boundaries of the registered tumor .",
    "in practice , this method is not quite feasible .",
    "alternatively , researchers in @xcite@xcite would outline the tumor on @xmath1 and build a histogram volume by sampling the posterior .",
    "their method is essentially transforming @xmath1 into a binary labeled image , and thresholding on a disguised label ensemble field .",
    "in addition , if we are interested in visualizing the uncertainty of derived features , such as the possible trajectories of registered fiber tracks , generating a vector ensemble field may be the right start .",
    "[ [ validation ] ] validation + + + + + + + + + +    some research have reported it was beneficial to utilize information in the transformation posterior .",
    "however , additional findings from our experiments revealed that the information in the posterior is not always useful . in the circle ellipse example shown in fig.5",
    ", we found some voxels whose most likely intensity does not equal to the corresponding intensity of the posterior mode @xmath48 .",
    "unexpectedly , @xmath48 is the one that is closer to the ground truth .",
    "how did the posterior give worse result ?",
    "by ensemble fields , the transformation posterior is exposed , we can investigate the correlation between variables , such as the transformation and intensity , and develop some standards to evaluate the credibility of the transformation posterior .",
    "with the advance of technologies and the increasing complexity of medical tasks , utilizing the full transformation posterior will become more prevalent . in order to develop a principled way to interpret the result of probabilistic registration",
    ", we feel it is necessary to share our findings and introduce assets , such as ensemble fields , to the research community .",
    "based on pilot examples , we demonstrate the usefulness of ensemble fields in various registration - based tasks . in the future , we will investigate the credibility of the transformation posterior and develop learning schemes that take ensemble fields as input for cad .",
    "cobzas , d. , sen , a. : random walks for deformable registration . in : miccai .",
    "lncs , vol .",
    "6892 , pp .",
    "springer , toronto ( 2011 ) simpson , i.j.a . ,",
    "schnabel , j.a . ,",
    "norton , i. , groves , a.r . ,",
    "andersson , j.l.r .",
    ", woolrich , m.w . : probabilistic inference of regularisation in non - rigid registration .",
    "59 , 2438 - 2451 ( 2012 )      popuri , k. , cobzas , d. , jagersand , m. : a variational formulation for discrete registration . in : miccai .",
    "lncs , vol .",
    "8151 , pp .",
    "springer , nagoya ( 2013 ) andrews , s. , tang , l. , hamarneh , g. : topology preservation and anatomical feasibility in random walker image registration . in : miccai .",
    "lncs , vol .",
    "8673 , pp .",
    "springer , boston ( 2014 ) heinrich , m.p . ,",
    "simpson , i.j.a .",
    ", papiez , b.w . ,",
    "brady , m. : deformable image registration by combining uncertainty estimates from supervoxel belief propagation .",
    "image anal .",
    "27 , 57 - 71 ( 2016 )    simpson , i.j.a . ,",
    "cardoso , m.j . ,",
    "norton , i. , modat , m. , woolrich , m.w . ,",
    "andersson , j.l.r , schnabel , j.a .",
    ", ourselin , s. : probabilistic non - linear registration with spatially adaptive regularisation .",
    "image anal .",
    "26 , 203 - 216 ( 2015 )    lotfi , p. , tang , l. , andrews , s. , hamarneh , g. : improving probabilistic image registration via reinforcement learning and uncertainty evaluation . in : mlmi .",
    "lncs , vol . 8184 , pp .",
    "springer , nagoya ( 2013 ) wasserman , d. , toews , m. , niethammer , m , wells iii , w.m .",
    ": probabilistic diffeomorphic registration : representing uncertainty . in : wbir .",
    "lncs , vol . 8545 , pp .",
    "springer , london ( 2014 ) risholm , p. , balter , j. , wells iii , w.m . :",
    "estimation of delivered dose in radiotherapy : the influence of registration uncertainty . in : miccai .",
    "lncs , vol . 6891 , pp .",
    "springer , toronto ( 2011 )"
  ],
  "abstract_text": [
    "<S> _ probabilistic image registration methods estimate the posterior distribution of transformation . the conventional way of interpreting the transformation posterior is to use the mode as the most likely transformation and </S>",
    "<S> assign its corresponding intensity to the registered voxel . </S>",
    "<S> meanwhile , summary statistics of the posterior are employed to evaluate the registration uncertainty , that is the trustworthiness of the registered image . despite the wide acceptance , this convention has never been justified . in this paper , based on illustrative examples , </S>",
    "<S> we question the correctness and usefulness of conventional methods . in order to faithfully translate the transformation posterior </S>",
    "<S> , we propose to encode the variability of values into a novel data type called ensemble fields . </S>",
    "<S> ensemble fields can serve as a complement to the registered image and a foundation for developing advanced methods to characterize the uncertainty in registration - based tasks . </S>",
    "<S> we demonstrate the potential of ensemble fields by pilot examples . _    </S>",
    "<S> uncertainty , ensemble fields </S>"
  ]
}