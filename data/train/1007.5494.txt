{
  "article_text": [
    "positive definite matrices have become fundamental computational objects in many areas of engineering and applied mathematics .",
    "they appear as covariance matrices in statistics , as variables in convex and semidefinite programming , as unknowns of important matrix ( in)equalities in systems and control theory , as kernels in machine learning , and as diffusion tensors in medical imaging , to cite a few .",
    "these applications have motivated the development of a difference and differential calculus over positive definite matrices . as a most basic operation",
    ", this calculus requires the proper definition of a mean .",
    "in particular , much research has been devoted to the matrix generalization of the geometric mean @xmath0 of two positive numbers @xmath1 and @xmath2 ( see for instance chapter 4 in @xcite for an expository and insightful treatment of the subject ) .",
    "the further extension of a geometric mean from two to an arbitrary number of positive definite matrices is an active current research area @xcite .",
    "it has been increasingly recognized that from a theoretical point of view @xcite as well as in numerous applications @xcite , matrix geometric means are to be preferred to their arithmetic counterparts for developing a calculus in the cone of positive definite matrices .",
    "the fundamental and axiomatic approach of ando @xcite ( see also @xcite ) reserves the adjective  geometric \" to a definition of mean that enjoys all the following properties :    * consistency with scalars : if @xmath3 and @xmath4 commute , then @xmath5 . *",
    "joint homogeneity @xmath6 * permutation invariance @xmath7 * monotonicity . if @xmath8 ( i.e. ( @xmath9 ) is a positive matrix ) and @xmath10 , the means are comparable and verify @xmath11 . * continuity from above .",
    "if @xmath12 and @xmath13 are monotonic decreasing sequence ( in the lowner matrix ordering ) converging to @xmath3 , @xmath4 then @xmath14 .",
    "* congruence invariance . for any @xmath15 we have @xmath16 .",
    "* self - duality @xmath17 .",
    "the present paper seeks to extend geometric means defined on the open cone @xmath18 to the the set of positive semi - definite matrices of fixed rank @xmath19 , denoted by @xmath20 , which lies on the boundary of @xmath18 .",
    "our motivation is primarily computational : with the growing use of low - rank approximations of matrices as a way to retain tractability in large - scale applications , there is a need to extend the calculus of positive definite matrices to their low - rank counterparts .",
    "the classical approach in the literature is to extend the definition of a mean from the interior of the cone to the boundary of the cone by a continuity argument . as a consequence ,",
    "this topic has not received much attention .",
    "this approach has however serious limitations from a computational viewpoint because it is not rank - preserving .",
    "for instance ando s geometric mean of two semi - definite matrices having rank @xmath21 is almost surely null with this definition .",
    "we depart from this approach by viewing a rank @xmath19 positive semi - definite matrix as the projection of a positive definite matrix in a @xmath19-dimensional subspace .",
    "our proposed mean lies in the mean subspace , a well - defined and classical concept .",
    "the proposed mean is rank - preserving , and it possesses all the properties listed above , modulo a few adaptations imposed by a rank - preserving concept : ( p1 ) is impossible unless the rank of @xmath22 is equal to the rank of @xmath3 and @xmath4 . indeed , as the mean must preserve the rank , it can not be equal to @xmath23 if the latter condition is not satisfied .",
    "also ( p6 ) will be shown to be impossible to retain when the rank is preserved .",
    "indeed it is this property that causes ando s geometric mean of two matrices of sufficiently small rank to be almost surely null . in",
    "( p7 ) inversion must obviously be replaced with pseudo - inversion . letting @xmath24 denote the desired mean in @xmath20",
    ", we suggest to replace those three properties with :    * consistency with scalars : if @xmath25 commute and @xmath22 has rank @xmath19 , @xmath26 .",
    "* invariance to scalings and rotations .",
    "for @xmath27 we have @xmath28 .",
    "* self - duality @xmath29 , where @xmath30 is the pseudo - inversion .    in the recent work @xcite",
    ", we used a riemannian framework to introduce a geometric mean of two matrices in @xmath20 that was shown to satisfy those properties .",
    "the present paper further develops the concept by providing an inutitive characterization and a closed formula for its calculation .",
    "furthermore , we show that the concept extends to the definition of a geometric mean for an arbitrary number of matrices , thereby providing the low - rank counterpart of recent work on positive definite matrices @xcite .",
    "the structure of the paper is as follows .",
    "section 2 and 3 are mainly expository . in section 2 ,",
    "we review the theory of ando in the cone of positive definite matrices and we illustrate the shortcomings of the continuity argument for a rank - preserving mean to be defined on the boundary of the cone . in section 3",
    ", we review the riemannian interpretation of ando s mean of two matrices @xmath3 and @xmath4 as the midpoint of the geodesic joining @xmath3 and @xmath4 for the affine invariant metric of the cone and introduce the riemannian concept of karcher mean .",
    "section 4 develops the proposed geometric mean for an arbitrary number of matrices in the set @xmath20 .",
    "the geometric properties of this mean are characterized in section 5 .",
    "finally , section 6 illustrates the relevance of a rank - preserving mean in the context of filtering .",
    "preliminary results can be found in @xcite .",
    "* @xmath18 is the set of symmetric positive definite @xmath31 matrices .",
    "* @xmath32 is the set of symmetric positive semidefinite @xmath31 matrices of rank @xmath33 . *",
    "@xmath34 is the vector space of symmetric @xmath31 matrices .",
    "* @xmath35 is the stiefel manifold ; i.e. , the set of @xmath36 matrices with orthonormal columns : @xmath37 .",
    "* @xmath38 is the grassman manifold , that is , the set of @xmath19-dimensional subspaces of @xmath39 .",
    "it can be represented by the equivalence classes @xmath40 .",
    "* span(@xmath3 ) is the subspace of @xmath39 spanned by the columns of @xmath41 .",
    "* @xmath42 is the tangent space to the manifold @xmath43 at @xmath44 .",
    "for positive scalars , the homogeneity property ( p2 ) implies @xmath47 with @xmath48 a monotone increasing continuous function . in a non - commutative matrix setting ,",
    "one can write [ geometricmean ] m(a_1,a_2)=a_1 ^ 1/2f(a_1 ^ -1/2a_2a_1 ^ -1/2)a_1 ^ 1/2 . with @xmath48",
    "a matrix monotone increasing function .",
    "several geometric means can be defined in this way ( see , e.g. , @xcite ) .",
    "the well - established geometric mean of two full - rank matrices popularized by ando @xcite corresponds to the case @xmath49 , generalizing the scalar geometric mean .",
    "it writes [ ando ] a_1#a_2=a_1 ^ 1/2(a_1 ^ -1/2a_2a_1 ^ -1/2)^1/2a_1 ^ 1/2 .",
    "it satisfies all the propositions ( p1-p7 ) listed above .",
    "there are many equivalent definitions of the ando geometric mean in the literature .",
    "a geometric mean satisfying ( [ geometricmean ] ) is defined for positive definite matrices , that is , for elements in the open cone of positive definite matrices .",
    "rank - deficient matrices lie on the closure of the cone . as a consequence ,",
    "the natural idea to extend a geometric mean on the boundary is to use a continuity argument .",
    "the resulting mean satisfies all the properties above ( except for ( p7 ) that must be formulated using pseudo - inversion ) , but it is not rank - preserving .",
    "indeed , let @xmath50 and @xmath51 where the term @xmath52 .",
    "these two matrices belong to @xmath53 , and their geometric mean is @xmath54diag(@xmath55 , @xmath56 ) . in the limit ( rank - deficient ) situation @xmath57 ,",
    "the mean becomes the null matrix diag(@xmath58 .",
    "the following proposition shows that this example is not pathological .",
    "if ( p6 ) is satisfied , the geometric mean of two matrices of @xmath20 is almost surely null if @xmath21 .    in @xcite ,",
    "it is proved ( theorem 3.3 ) that ( p6 ) implies that the range of the geometric mean of @xmath45 and @xmath46 is the intersection of the subspaces @xmath59 and @xmath60 ( this can be proved letting a sequence of matrices of @xmath61 converge to the orthoprojector on ker @xmath45 ) . since the intersection of two random subspaces of dimension @xmath19 is almost surely empty as long as @xmath62 , the range of @xmath63 is almost surely the null space , which proves the claim .",
    "a rank - preserving mean thus requires a different approach .",
    "we seek to retain most of the properties ( p1-p7 ) , but we will see that three of them must be relaxed to define a rank - preserving mean .",
    "the major relaxation consists in choosing a smaller invariance group in ( p6 ) , replacing the general linear group @xmath64 with the smaller but meaningful group of scaling and rotations @xmath65 .",
    "a geometric mean of an arbitrary number of matrices , that extends the geometric mean of two matrices is not very well - established .",
    "indeed the definitions based on equations for instance , are not easily generalized .",
    "several possible definitions have appeared in the literature and we shall not review all of them . in any case , it seems natural to reserve the adjective geometric , to a mean that satisfies the following properties ( pp1-pp7 ) .",
    "they are a natural extension of ( p1-p7 ) to the case of three matrices , and the extension to an arbitrary number of matrices is straightforward . ( pp1 ) if a , b , c commute @xmath67 . ( pp2 ) @xmath68 ( pp3 ) @xmath69 for any permutation @xmath70 .",
    "( pp4 ) the map @xmath71 is monotone . ( pp5 ) if @xmath12 , @xmath13 , @xmath72 are monotonic decreasing sequences converging to @xmath73 then @xmath74 .",
    "( pp6 ) for any @xmath15 we have @xmath75 .",
    "( pp7 ) @xmath76 .",
    "this axiomatic approach has been proposed in @xcite , and the authors have defined a mean we shall denote @xmath77 , adopting the notation of @xcite .",
    "this mean is defined as the common limit of a converging sequence of matrices , and it was proved to preserve properties ( p1-p7 ) as well as their extension ( pp1-pp7 ) to three or more matrices .",
    "ando s mean ( [ ando ] ) has the alternative riemannian interpretation of the midpoint of a geodesic connecting the matrices @xmath3 and @xmath4 .",
    "this connection appears for instance in @xcite .",
    "because this riemannian interpretation is at the root of our proposed rank - preserving mean , it is reviewed in this section .",
    "the arithmetic mean of @xmath78 positive numbers in @xmath79 is defined as @xmath80 .",
    "it has the variational property of being the unique minimizer of the sum of squared distances @xmath81 where @xmath82 is the euclidean distance in @xmath83 . in the same way",
    ", the geometric mean of @xmath84 positive scalars minimizes the same sum if one works with the hyperbolic distance @xmath85 .",
    "this variational approach allows to define candidate means of an arbitrary number of matrices on any connected riemannian manifold @xmath43 .",
    "such manifolds carry the structure of a metric space whose distance function is the arclength of a minimizing path between two points .",
    "indeed the mean of @xmath86 on @xmath43 , can be defined as the minimizer of the sum of squares @xmath87 where @xmath82 is the geodesic distance on @xmath43 .",
    "such a mean is known as the riemannian barycenter , of karcher or frchet mean .",
    "when only two points are involved , the karcher mean is the midpoint of the minimizing geodesic connecting those two points and it is usually called the riemannian mean .",
    "the main advantage of the karcher mean is to readily extend any mean that can be defined as a geodesic midpoint , to an arbitrary number of points .",
    "unfortunately the mean can rarely be given in closed form , and is typically computed by an optimization algorithm on the manifold ( see e.g. @xcite for more information on this branch of optimization ) . in @xcite it has been shown that the karcher mean is uniquely defined on manifolds with non - positive curvatures . on arbitrary manifolds with",
    "upper bounded sectional curvature , the karcher mean exists and is unique in geodesic balls with sufficiently small radius @xcite .",
    "any positive definite matrix admits the factorization @xmath88 , @xmath89 , and the factorization is invariant by rotation @xmath90 . as a consequence",
    ", the cone of positive definite matrices has a homogeneous representation @xmath91 .",
    "the space is reductive and thus admits a @xmath64-invariant metric called the natural metric of the cone of positive definite matrices @xcite . if @xmath92 are two tangent vectors at @xmath93 , the metric is given by @xmath94 . with this definition ,",
    "a geodesic ( path of shortest length ) at arbitrary @xmath95 is @xcite : @xmath96 and the corresponding geodesic distance is @xmath97where @xmath98 are the generalized eigenvalues of the pencil @xmath99 , i.e. , the roots of @xmath100 .",
    "the distance is invariant with respect to action by congruence of @xmath64 and matrix inversion .",
    "the geodesic characterization provides a closed - form expression of the riemannian mean of two matrices @xmath101 .",
    "the geodesic @xmath102 linking @xmath3 and @xmath4 is @xmath103 where @xmath104 . the midpoint is obtained for @xmath105 : @xmath106 and it corresponds to the definition ( [ ando ] ) .      for @xmath107 viewed as a riemannian manifold endowed with the natural metric ,",
    "the karcher mean is defined as a minimizer of @xmath108 , i.e. a least squares solution that we shall denote @xmath109 as in @xcite .",
    "the manifold @xmath18 endowed with the natural metric is complete , simply connected , and has everywhere a negative sectional curvature . as a consequence ,",
    "the karcher mean is uniquely defined .",
    "it has been proposed by @xcite as a natural candidate for generalizing the ando mean to @xmath78 matrices , and studied by @xcite .",
    "it can mainly be calculated via a simple newton method on @xmath18 , or by a stochastic gradient algorithm @xcite . however , finding a closed - form expression of the karcher mean of three or more matrices of @xmath18 remains an open question .",
    "several recent papers adress the issue of approximating the karcher mean via simple algorithms @xcite .      the riemmanian approach to the definition of means provides a natural definition for the mean of @xmath19-dimensional projectors in @xmath39 , which forms a subset of @xmath20 : @xmath110 this set is in bijection with the grassman manifold of @xmath19-dimensional subspaces gr(p , n ) ( e.g. @xcite ) .",
    "this manifold can be endowed with a natural riemannian structure .",
    "the squared distance between two subspaces is merely the sum of the squares of the principal angles between those two @xmath19-planes .",
    "the riemannian mean of two subspaces is uniquely defined as soon as all the principal angles between those subspaces are stricly smaller than @xmath111 . in other words ,",
    "the injectivity radius at any point , i.e. roughly speaking the distance at which the geodesics cease to be minimizing , is equal to @xmath111 on this manifold .",
    "the karcher mean of @xmath78 subspaces @xmath112 of @xmath113 is defined as the least squares solution that minimizes @xmath114 .",
    "this latter quantity is equal to @xmath115 where @xmath116 is the @xmath117-th principal angle between @xmath44 and @xmath118 . for @xmath119",
    ", there is no closed - form solution for the mean subspace @xmath44 . for this reason ,",
    "the riemannian mean is often approximated by the chordal mean @xcite , see section [ filtering : sec ] . as it is well - known the sectional curvature of the grassman manifold does not exceed 2 , and the injectivity radius is @xmath111 , we have guarantees that the karcher mean exists and is uniquely defined in a geodesic ball of radius less than @xmath120 , see @xcite .",
    "the karcher mean of projectors in @xmath113 is a natural rank - preserving rotation - invariant mean that is well - defined on a subset of the boundary of the cone .",
    "we will use this mean subspace as a basis for the mean of @xmath78 matrices of @xmath20 .",
    "the extension of the mean from projectors to arbitrary matrices of @xmath20 is based on the decomposition @xmath121 of any matrix @xmath122 , with @xmath123 an orthonormal matrix in @xmath124 and @xmath125 a positive definite matrix in @xmath126 .",
    "this matrix decomposition emphasizes the geometric interpretation of elements of @xmath20 as _ flat @xmath19-dimensional ellipsoids in @xmath39_. the flat ellipsoid belongs to a @xmath19-dimensional subspace spanned by the columns of @xmath123 , which form an orthonormal basis of the subspace , whereas the @xmath127 positive definite matrix @xmath125 defines the shape of the ellipsoid in the low rank cone @xmath126 .",
    "the matrix decomposition @xmath128 is defined up to an orthogonal transformation @xmath129with @xmath130 since @xmath131 the orthogonal transformation does not affect the grassman riemannian mean but does affect , in general , the mean of the low - rank factors since @xmath132 where @xmath133 is the ando mean .",
    "principal difficulties for defining a proper geometric mean stem from this ambiguity .",
    "let @xmath134 and @xmath135 be elements of @xmath20 .",
    "the representatives of the two matrices @xmath136 are defined up to an orthogonal transformation @xmath137all the bases @xmath138 correspond to the same @xmath19-dimensional subspace @xmath139 ( figure [ fig1 ] ) .",
    "note that , this representation of a @xmath19-dimensional subspace as the set of bases @xmath140 is at the core of the definition of the grassman manifold @xmath38 as a quotient manifold @xcite@xmath141 the equivalence classes @xmath138 are called the  fibers \" .",
    "we will systematically assume that the principal angles between span(@xmath142 ) and span(@xmath143 ) are less than @xmath111 , which is almost surely true if the subspaces span(@xmath142 ) and span(@xmath143 ) are picked randomly . in the case of two matrices ,",
    "this is sufficient to ensure their karcher mean in gr(p , n ) is unique . to remove the ambiguity in the definition of a mean of two psd matrices , we propose to pick two particular representatives @xmath144 and @xmath145 in the fibers @xmath146 and @xmath147 by imposing",
    "that their distance in @xmath124 does not exceed the grassman distance between the fibers they generate : @xmath148 because the projection from @xmath124 to gr(p ,",
    "n ) is a riemannian submersion @xcite , and riemannian submersions shorten the distances @xcite , this condition admits the equivalent formulation @xmath149 which is illustrated by the picture of figure [ fig1 ] : a geodesic in the grasmman manifold admits the representation of a _ horizontal _ geodesic in @xmath124 , that is , in the present case , a geodesic whose tangent vector points everywhere to a direction normal to the fiber .",
    "are two bases of the subspaces spanned by the columns of @xmath142 and @xmath143 ( the fibers ) that minimize the distance in @xmath124 .",
    "the dashed line represents the shortest path between those two fibers , thus its horizontal lift ( i.e. its projection ) in @xmath150 viewed as a quotient manifold , is a geodesic . ]",
    "the following proposition solves equation .",
    "[ representatives ] the compact svd of @xmath151 writes @xmath152where @xmath153 is a diagonal matrix whose entries are the principal angles between the @xmath19 dimensional subspaces @xcite .",
    "if the pair @xmath154 is defined via , it is a solution of .",
    "we use a well - known result in the grassman manifold : the shortest path between two fibers in @xmath124 concides with the geodesic path linking these two fibers in @xmath38 , as the projection on the grassman manifold is a riemannian submersion , and thus shortens the distances ( see @xcite for results on quotient manifolds ) .",
    "if two bases @xmath155 and @xmath156 of the fibers @xmath157 and @xmath158 are the endpoints of a geodesic in the grassman manifold , they must minimize .",
    "it is thus sufficient to prove that @xmath159 and @xmath160 where @xmath161 are defined via are the endpoints of a grassman geodesic .    a geodesic in the grassman manifold with @xmath155 as starting point and @xmath162 as tangent vector admits the general form @xcite @xmath163 where @xmath164 is the compact svd of @xmath162 .",
    "we thus propose to define the curve @xmath165 to define @xmath44 we first assume all principal angles , i.e. , all diagonal entries of @xmath153 are strictly positive",
    ". then we let @xmath166 .",
    "the curve @xmath167 is a geodesic , as it is of the form with @xmath168 which is a tangent vector as @xmath169 ( since @xmath170 ) , and @xmath171 is a compact svd as @xmath172 .",
    "this is because @xmath173 where we used the fact that @xmath174 .",
    "@xmath155 and @xmath156 are its endpoints indeed as @xmath175 .",
    "if there are null principal angles , it is clear that @xmath167 is a geodesic , where @xmath176 along the directions corresponding to non - zero principal angles , and where @xmath44 can be completed arbitrarily with orthonormal vectors along the directions corresponding to null principal angles . indeed , along those directions @xmath155 and @xmath156 , and thus @xmath167 coincide , and the value of @xmath44 does not play any role in the definition of @xmath167 .    the following result allows to understand why the choice of the specific bases @xmath177 is relevant for defining a geometric mean , as explained in the end of this subsection .",
    "it proves the rotation of minimal energy ( i.e. the closest to identity ) mapping the subspace span(@xmath45 ) to span(@xmath46 ) maps @xmath155 to @xmath156 .",
    "[ energy : prop ] let @xmath178 and @xmath179 with @xmath180 a solution of ( [ ou ] ) .",
    "then the rotation @xmath181 that maps the basis @xmath155 to the basis @xmath182 is a rotation of minimal energy , that is , it minimizes @xmath183 among all rotation matrices that map @xmath155 to the subspace @xmath184 .",
    "one can assume without loss of generality that @xmath185 $ ] where @xmath186 is the canonical basis of @xmath39 .",
    "moreover , the search space can then be restricted to the rotations whose @xmath187 first columns are of the form @xmath188 , whereas the @xmath189 remaining columns coincide with the identity matrix , as the rotation seeked must minimize the distance to identity .",
    "any such rotation mapping @xmath155 to @xmath188 has its first columns equal to @xmath188 and coincides with identity on the last @xmath189 columns .",
    "thus we have for any such rotation @xmath190 .",
    "but as @xmath191 and the metrics also coincide , we have @xmath192 .",
    "thus the problem boils down to and is solved taking @xmath193 .",
    "having identified representatives as endpoints of a geodesic in gr(p ,",
    "n ) , their riemannian mean in the stiefel manifold ( and in the grassman manifold ) is now easily written as the midpoint of the geodesic : @xmath194 note that a weighted mean can be also computed using the geodesic parameterization : @xmath195where the weight given to @xmath155 is @xmath196 and the weight given to @xmath156 is @xmath197 .",
    "once @xmath155 and @xmath156 have been computed , @xmath198 and @xmath199 are given by the corresponding representatives@xmath200 the proposed mean of two matrices @xmath45 , @xmath46 is then given by @xmath201 where @xmath202 is the riemannian mean of @xmath155 and @xmath156 and @xmath203 is the ando mean of @xmath204 and @xmath205 in @xmath126 .",
    "proposition [ energy : prop ] provides a simple geometrical intuition underlying the definition of the mean : the mean of two flat ellipsoids @xmath45 and @xmath46 is defined in the mean subspace as the geometric mean of two full @xmath19-dimensional ellipsoids @xmath204 and @xmath205 .",
    "there are several ways to rotate the ellipsoid @xmath45 into the subspace spanned by @xmath46 .",
    "different rotations will yield different respective positions of the two final ellipsoids .",
    "the choice is made univoque and sensible by selecting the minimal rotation .",
    "the rotated ellipsoid then merely writes @xmath206 .",
    "thus @xmath204 and @xmath205 define the shape of the ellipsoids expressed in the same basis @xmath156 .",
    "figure [ elli ] illustrates the proposed mean of two flat ellipsoids of @xmath207 .    .",
    "the proposed mean is such that both ellipsoids are brought to the mean subspace via a rotation of minimal energy , and then averaged .",
    "the resulting mean is a flat ellipsoid that lives in the mean subspace . ]",
    "the construction presented in the previous section for two matrices is now extended to an arbitrary number of matrices .",
    "the main idea is to define a mean @xmath19-dimensional subspace and to bring all flat ellipsoids @xmath209 to this mean subspace by a minimal rotation . in the common subspace ,",
    "the problem boils down to compute the geometrical mean of @xmath78 matrices in @xmath210 the construction is achieved through the following three steps :    1 .",
    "let @xmath128 for @xmath211 .",
    "suppose that the subspaces spanned by the columns of the @xmath212 s are enclosed in a geodesic ball of radius less than @xmath213 in gr(p , n ) .",
    "then define the projector @xmath214 st(p , n ) as a basis of their unique karcher mean .",
    "2 .   for each @xmath215 , compute two bases @xmath216 and @xmath217 of ( respectively ) span@xmath218 and span@xmath219 such that @xmath220 i.e. solve problem .",
    "this is illustrated on figure [ fig2 ] .",
    "let @xmath221 .",
    "the ellipsoid @xmath212 rotated to the mean subspace writes @xmath222 +   of the fibers and the bases @xmath223 of the mean subspace fiber are such that @xmath224 are the endpoints of a geodesic in the grassman manifold . ]",
    "let @xmath133 denote the geometric mean alm or ls on @xmath126",
    ". for each @xmath211 let @xmath225 where @xmath226 is a fixed basis of the mean subspace .",
    "the geometric mean of the matrices @xmath227 is defined the following way : @xmath228w_0^t\\ , .\\end{aligned}\\ ] ]    the approach can summarized as follows : in 1 .",
    "a mean subspace is computed , in 2 .",
    "the ellipsoids are rotated to this subspace , in 3 .",
    "they are all expressed in a common basis @xmath229 so that their geometric mean can be computed in the small dimensional cone .",
    "an algorithmic implementation is proposed in section 6.1 .",
    "throughout this section    * @xmath133 will systematically denote one of the two geometric means @xmath230 or @xmath231 on @xmath126 .",
    "* it will be systematically assumed the subspaces spanned by the columns of @xmath232 belong to a geodesic ball of radius less than @xmath213 in gr(p , n ) , so that the karcher mean of these subspaces is well - defined and unique . * with a slight abuse of notation , any projector @xmath233 where @xmath234st(p , n ) will systematically be considered as an element of gr(p , n ) , i.e. as a subspace .",
    "[ prop2 ] on the set of rank @xmath19 projectors , the mean coincides with the grassman riemannian mean . on the other hand , when the matrices in @xmath20 all have the same range , coincides with the geometric mean induced by the geometric mean @xmath133 on the common range subspace of dimension @xmath19 .",
    "more generally coincides with @xmath133 on the intersection of the ranges .",
    "the first two properties are obvious .",
    "the last one is linked to the special choice of a minimal energy rotation .",
    "indeed , on the intersection of the ranges , the rotation of minimal energy is the identity .",
    "the next proposition proves that the proposed mean inherits the several properties of a geometric mean in the cone . for the reasons explained in the introduction of the paper , properties ( pp1 ) and ( pp6-pp7 ) , defined for the mean of three or more matrices in subsection [ multmean : sec ] , must be adapted as follows : ( pp1 ) if @xmath73 commute and @xmath235 has rank @xmath19 , then @xmath236 .",
    "( pp6 ) for @xmath27 we have @xmath237 .",
    "( pp7 ) @xmath238 .",
    "[ prop3 ] the mean with @xmath239 is well - defined , and deserves the appellation  geometric \" as it satisfies the properties ( pp1 ) , ( pp2-pp5 ) , and ( pp6-pp7 ) .",
    "the result also holds with @xmath240 , except that ( pp4 ) can only be conjectured in this case .",
    "( pp1 ) : if @xmath241 has rank @xmath19 , and @xmath66 commute , then all @xmath212 s span the same @xmath19-dimensional subspace . as a result",
    ", they all have the same range . on this common range ,",
    "the mean has been proved to coincide with @xmath133 , see proposition [ prop2 ] .",
    "it thus inherits the ( pp1 ) property .",
    "@xmath133 satisfies ( pp2 ) and so does . to prove permutation invariance ( pp3 ) it suffices to note that both grassman mean and @xmath133",
    "are unvariant by permutation . to prove ( pp4 ) , suppose @xmath242 for each @xmath215",
    ". then @xmath212 s and @xmath243 have the same range and they all admit a factorization of the type @xmath244 .",
    "( pp4 ) is then a mere consequence of the monotonicity of @xmath133 .",
    "this property was proved for @xmath133=alm in @xcite and it was conjectured for @xmath133=ls in @xcite .",
    "using the same arguments , one can prove continuity from above of the mean is a consequence of continuity of @xmath133 .",
    "( pp7 ) can be easily proved noting that for each @xmath215 the pseudo - inverse writes @xmath245 .",
    "thus the calculation of the mean of the pseudo - inverse yields the inverse @xmath246 s of the @xmath247 s and ( pp7 ) is the consequence of self - duality of @xmath133 .",
    "( pp6 ) : as for all @xmath248 and @xmath215 we have @xmath249 invariance with respect to scaling is a mere consequence of the invariance of @xmath133 .",
    "let @xmath250 .",
    "the mean subspace in grassman of the rotated ranges @xmath251 s is the rotated mean subspace of the range of the @xmath212 s .",
    "proposition [ representatives ] says that @xmath252 but for every @xmath215 we have @xmath253 .",
    "thus the matrices are transformed according to @xmath254 and the @xmath255 are unchanged .",
    "the mean of the rotated matrices is thus @xmath256 .      in the recent work @xcite , the authors proposed an extension of the affine - invariant metric of the cone to @xmath20 . in this subsection",
    ", we explore the links between the karcher mean in the sense of this metric and the proposed mean .",
    "we underline the fact that the proposed mean is _ not _ the karcher mean in the cone . yet , we prove that both means coincide in the meaningful case where all the matrices are rank @xmath19 projectors .",
    "the metric introduced in @xcite is as follows .",
    "if @xmath257 represents @xmath122 , the tangent vectors of @xmath258 are represented by the infinitesimal variation @xmath259 , where @xmath260 such that @xmath261 , @xmath262 , and @xmath263 .",
    "vectors of the form constitute a subset of tangent vectors to the total space @xmath264 .",
    "this subset is called the horizontal space , and is defined such that each tangent of the horizontal space defines a unique tangent vector in the quotient @xmath20 ( i.e. the horizontal space is transverse to the fibers ) .",
    "the chosen metric of @xmath20 needs only be defined on the horizontal space , and is merely the weighted sum of the infinitesimal distance in @xmath38 and in @xmath126 : @xmath265generalizing @xmath266 in a natural way .",
    "the space @xmath267 endowed with the metric is a riemannian manifold , and the metric is invariant to orthogonal transformations , scalings , and pseudo - inversion .",
    "[ geo : prop ] consider @xmath78 rank @xmath19 projectors @xmath268 .",
    "then the mean is the karcher mean of @xmath269 in the sense of metric .",
    "the proof of this propostion is based on two lemmas .",
    "indeed , this result stems from the fact that is of the form @xmath270 , where this latter projector is the karcher mean of the @xmath78 projectors in the sense of the gr(p , n ) natural metric .",
    "this means @xmath270 is the minimizer of the cost @xmath271 .",
    "but the karcher mean in @xmath20 is defined as the minimizer of the cost @xmath272 .",
    "the first following lemma , proves that @xmath273 for all @xmath274 .",
    "thus for all @xmath44 we have @xmath275 .",
    "but the second following lemma proves that @xmath276 . as a result",
    ", @xmath277 minimizes @xmath278 .",
    "[ lem1 ] the distance between arbitrary @xmath279 in @xmath20 is lower bounded by the distance between their ranges in the grassman manifold : @xmath280    a horizontal curve @xmath281 has length @xmath282 . for two matrices @xmath283 ,",
    "consider the horizontal lift @xmath281 of the geodesic linking @xmath45 and @xmath46 in @xmath20 in the sense of metric .",
    "as the horizontal vector @xmath284 has a shorther norm in the tangent space than the horizontal vector @xmath285 , we have @xmath286 .",
    "besides , @xmath287 defines a curve in @xmath124 linking span(@xmath45 ) and span(@xmath46 ) . as the projection from the stiefel manifold to the grassman manifold viewed as",
    "a quotient space @xmath288 is a riemannian submersion , it shortens the distances@xcite , i.e. @xmath289 .",
    "this proves the result .    in the particular case where @xmath279 in @xmath20are two projectors , the geodesic joining them in @xmath20 coincides with the geodesic joining their ranges in @xmath38 .",
    "it implies @xmath290 .",
    "one can find a horizontal curve in @xmath20 whose length is @xmath291 , by choosing representatives in @xmath124 as in proposition [ representatives ] .",
    "it is thus a geodesic in grassman , but also in @xmath20 because of lemma [ lem1 ] .    beyond the particular case of projectors",
    ", it must be emphasized that the mean is not the karcher mean in the sense of metric .",
    "this is because a horizontal curve @xmath281 that is made of a geodesic @xmath287 in grasmman and of a geodesic @xmath292 in the cone does not define a geodesic in @xmath124 .",
    "for instance , it is possible to construct a geodesic joining matrices having the same range , and such that the mid - point does not have the same range ( see @xcite , proposition 1 ) .",
    "this counter - example shows proposition [ prop2 ] , although very natural , is not satisfied by the karcher mean , as the mean of matrices having the same range does not boil down to their geometric mean within this range . even if the metric seems natural , and has been successfully used in several applications ( e.g. , @xcite ) , the resulting karcher mean lacks elementary expectable properties that the mean possesses .",
    "here we recap the basic steps for an implementation of the mean .",
    "the calculation of the mean has a numerical complexity of order @xmath293 .",
    "this cost is linear with respect to @xmath84 , a very desirable feature in large - scale applications where @xmath294 .    1 .   for @xmath211 let @xmath295 be any orthonormal basis of the span of @xmath212 .",
    "2 .   let @xmath202 be an orthonormal basis of the subspace that is the karcher mean in the grassman manifold between the associated subspaces . instead of minimizing @xmath115 ,",
    "an interesting alternative is to minimize @xmath296 , which corresponds to approximate the angular distance by a chordal distance .",
    "both definitions are asymptotically equivalent for small principal angles . in this case",
    ", the solution was shown in @xcite to be the @xmath19-dimensional dominant subspace of the centroid @xmath297 , which can easily be found by truncated svd .",
    "3 .   for @xmath211",
    "* the svd of @xmath298 yields two orthogonal matrices @xmath299 such that @xmath300 is a diagonal matrix .",
    "* let @xmath301 and @xmath302 .",
    "let @xmath221 .",
    "let @xmath303 .",
    "4 .   compute the geometric mean in the low - rank cone @xmath304 using methods in the literature @xcite .",
    "the geometric mean is : @xmath305      filtering on @xmath306 with the metric ( which is the gl(n)-invariant metric of the cone @xmath18 ) was studied extensively for diffusion tensor images ( dti ) filtering in @xcite .",
    "it was also applied to signal processing in @xcite , and also seems to be promising in radar processing @xcite .",
    "one of the main benefits of this metric is its invariance with respect to scalings which makes it very robust to outliers , i.e. large noise , as the effect of a large eigenvalue is mitigated by the geometric mean .",
    "this very property , which is desirable for means in the interior of the cone , yields a great lack of robustness to ( even small ) noises as soon as some matrices are rank - deficient .",
    "the mean inherits the invariance to scalings property , which yields robustness to outliers , without being subject to the same problems in case of rank deficiency , as illustrated by the following proposition .",
    "let @xmath122 , and @xmath307 be a rotation of magnitude @xmath56 . if @xmath308 , which can be the case with arbitrary small @xmath309 as soon as @xmath21 , the ando mean of @xmath3 and @xmath310 is the null matrix according to propostion 1 . on the other hand , @xmath311 when @xmath312 .",
    "this proposition shows that the ando mean of a stream of noisy measurements @xmath310 of the matrix @xmath3 , is generally the null matrix , even with arbitrarily small noises , whereas it should be close to a. on the other hand , it is indeed the case when the rank - preserving metric proposed in this paper is used .",
    "this appears to be a fundamental feature in filtering applications .      in continuous - time",
    ", a first - order filter meant to filter a constant noisy signal @xmath313 writes @xmath314 in discrete - time , using a semi - implicit numerical scheme , it becomes @xmath315 which is a weighted mean between the measured signal @xmath316 and the filtered signal @xmath317 .",
    "thus a weighted version of the mean proposed in this paper can be used to do filtering .",
    "indeed if the usual matrix arithmetic mean is used , the rank is not preserved .    for the sake of illustration",
    ", we apply this idea to a weighted version of the mean proposed in this paper applied to the filtering of a constant matrix @xmath318 of @xmath319 , where @xmath320 is a constant vector .",
    "let @xmath321 where @xmath322 is a gaussian white noise of magnitude @xmath323 of the signal . the filtering algorithm based on a weighted mean corresponding to the metric writes : @xmath324 where the current estimated matrix is @xmath325 with @xmath326 , and @xmath327 where @xmath328 .",
    "the grassman mean was computed using .",
    "the result is represented on figure [ fig:1 ] .",
    ": plot of the 3 coefficients of the measured matrix ( dashed line ) and the filtered matrix ( plain line ) with a @xmath323 measurement noise , and @xmath329 .",
    "the filter allows to denoise the measured rank-1 symmetric matrix . ]",
    "as mentioned earlier , the geometric mean in the cone has proved useful in several filtering applications due to its remarkable robustness to outliers . here",
    ", it is easy to see for instance in the @xmath330 case looking at update , that an outlier having a very large amplitude will be crushed thanks to the logarithm function .",
    "such a property is inherited by the metric for filtering on @xmath20 .",
    "see figure [ fig:2 ] for an experimental illustration of the property .",
    "but an outlier is inserted at each 10 steps .",
    "below : zoom on the filtered signals ( to be compared to figure [ fig:1 ] ) .",
    "the filter shows good robustness properties to outliers . ]",
    "this paper presents research results of the belgian network dysco ( dynamical systems , control , and optimization ) , funded by the interuniversity attraction poles programme , initiated by the belgian state , science policy office .",
    "the scientific responsibility rests with its authors ."
  ],
  "abstract_text": [
    "<S> the generalization of the geometric mean of positive scalars to positive definite matrices has attracted considerable attention since the seminal work of ando . </S>",
    "<S> the paper generalizes this framework of matrix means by proposing the definition of a rank - preserving mean for two or an arbitrary number of positive semi - definite matrices of fixed rank . </S>",
    "<S> the proposed mean is shown to be geometric in that it satisfies all the expected properties of a rank - preserving geometric mean . </S>",
    "<S> the work is motivated by operations on low - rank approximations of positive definite matrices in high - dimensional spaces . </S>"
  ]
}