{
  "article_text": [
    "in recent years , the possibility of detecting the moons of extrasolar planets , so - called `` exomoons '' , has received increased attention @xcite .",
    "extrasolar moons may be frequent , temperate abodes for life and a determination of their prevalence would mould our understanding of the abundance of life in the universe . although many techniques have been proposed , it is the transit method which seems to offer the greatest potential to detect habitable - zone moons in the near - future @xcite .    in general , there are two ways in which a moon can be identified using transits .",
    "the first of these is the moon s own transit light curve @xcite and the second is the family of techniques known as `` transit timing effects '' .",
    "this includes both transit timing variations ( ttv ) @xcite and transit duration variations ( tdv ) .",
    "further , tdv has two different components ; one due to velocity variations ( tdv - v ) @xcite and one due to transit impact parameter variations ( tdv - tip ) @xcite .",
    "ttv and tdv - tip are both due to the position of the planet varying in response to the moon s presence ( positional wobble ) . in contrast , tdv - v is due to velocity variation of the host planet in response to the moon s presence ( velocity wobble ) .",
    "combining all of these effects allows for a unique solution ( see @xcite @xcite for details ) for the moon - to - planet mass ratio and exomoon period ( and therefore orbital semi - major axis through kepler s third law ) .    to perform the observations , highly precise",
    ", continuous photometry is required and the _ kepler mission _ is thought to be the best instrument currently available to conduct such a search @xcite .",
    "so far , two searches for exomoons have been conducted using the _ kepler _ photometry , utilizing the transit timing techniques on kepler-4b through 8b @xcite and tres-2b @xcite . despite null - results ( which was expected as all of these planets are hot - jupiters ) , the studies indicate sensitivity into the sub - earth mass regime , as predicted by @xcite .",
    "the transit timing equations are all built around the premise of a constant planet - star separation and constant planetary velocity during the timescale of the transit . whilst this is generally a good approximation except for moons on very short periods , there is an obvious desideratum to make the expressions dynamic .",
    "a possible problem with the current technique is that if the moon s light curve is detectable directly , then not only is this an extra piece of data we are ignoring but also it could fundamentally invalidate many of the transit timing methods . the ideal solution would be to simulate both the planet and moon transit light curves , including limb darkening which is critical for _ kepler_. in addition , these light curves could be computed with the ttv and tdv effects inherently built into the model in a dynamic way . not only",
    "would this improve upon the static approximations made in the ttv / tdv equations , but it would also bring in ttv / tdv of the moon itself .    before constructing such an algorithm , one must keep the purpose of such a routine in mind .",
    "this algorithm will be used to search for exomoons which will be done by fitting light curves with the new algorithm . given the large number of free parameters and inevitable intricate inter - parameter dependencies , a monte carlo based method seems required . since such methods",
    "are inherently computationally expensive making often millions of calls to the simulation routine , then it is clear that any algorithm we design must be very fast to execute .",
    "this essentially excludes methods based upon pixelating the star or other numerical methods .",
    "the clear requirement then , is a completely analytic algorithm .",
    "the list of requirements are :    * analytic ( absolutely no numerical components ) * dynamic ( inherently accounts for all timing effects ) * limb darkening incorporated ( including non - linear laws ) * all orbital elements accounted for ( e.g. eccentricity , longitude of the ascending node , etc )    in summary , such an approach would not only offer many advantages over the previous timing methods , but would also be highly practical for conducting a batch - style search for exomoons in archival data . in this paper , we introduce the fundamental equations needed to construct this algorithm , known as luna , and apply it in some hypothetical examples .    in  [ sec :",
    "lightcurves ] , we describe the framework for computing the transit light curves of a planet with a moon and outline the assumptions made . accompanying details on the model used for the sky - projected motions of the planet and moon can be found in the appendix (  [ sec : motion ] ) . in  [ sec : areas ] , we provide expressions for the eclipsing area of the moon in front of the star in all 27 possible principal configurations . in  [ sec : examples ] , example transits light curves are generated and re - fitted for habitable - zone exomoons detectable with _",
    "kepler_-class photometry .",
    "finally , we discuss comparison to previous methods proposed in the literature and provide concluding remarks in  [ sec : conclusions ] .",
    "to generate a light curve , the relative positions of the star , planet and moon must be calculated at every time stamp in the photometric data set in question .",
    "in particular , one requires the sky - projected separation between the planet and star , @xmath2 , the moon and the star , @xmath3 and the planet and the moon , @xmath4 .",
    "we direct the reader to the appendix (  [ sec : motion ] ) for details on the derivation of the expressions for these terms , where we employ an analytic approximation for the three - body problem which we dub as the nested two - body model @xcite .",
    "the coordinate system employed throughout is also defined in the appendix (  [ sec : motion ] ) .",
    "it can be shown that these three @xmath5 terms are a function of @xmath6 and @xmath7 which may be written , in general , as a function of time alone .",
    "note that we define @xmath6 as the true anomaly of the planet - moon barycentre around the star and @xmath7 as the true anomaly of the satellite around the planet - moon barycentre .",
    "therefore , a necessary prerequisite is to convert time stamps to true anomalies .",
    "let us begin with considering the standard practice for a planet by itself .",
    "the planet - only case is a very familiar one .",
    "however , we will cover the conversion of time to true anomaly carefully .",
    "writing out the steps explicity will allow us to identify the necessary procedure for the more complicated planet - moon case we will soon face .",
    "typically , we have a time series running from an initial time stamp of @xmath8 up to @xmath9 ( where @xmath10 is the total number of measurements ) with the time of transit minimum occurring at @xmath11 .",
    "our first task is to convert the time array into an @xmath12 array . to accomplish this",
    "we must define a reference point in time at which the true anomaly is known .",
    "whilst we are free to use any reference point we so desire , a typical choice is the time of transit minimum , @xmath11 . in the example above , this choice it will change our array to run from @xmath13 ) @xmath14 @xmath15 with the transit centred at time @xmath16",
    ". the true anomaly at the time of transit minimum can be found by solving d@xmath5/d@xmath17 for @xmath12 . for even a planet - only case ,",
    "this is non - trivial and leads to a bi - quartic equation @xcite .",
    "the solution may be found by a series expansion about the point of inferior conjunction @xmath18 , where @xmath19 represents a perturbation term , which is given up to @xmath20-order in @xcite .",
    "the third and final step is the application of kepler s equation . with the reference true anomaly known ,",
    "this is converted to a reference mean anomaly via the usual relations @xcite .",
    "then , the mean anomalies at all times may be calculated since this parameter scales linearly with time .",
    "finally , the mean anomalies are converted into true anomalies using kepler s equation .",
    "so to summarize we have three steps : i ) subtract the time of transit minimum from all times ii ) define the reference anomaly as the time of transit minimum iii ) assign mean anomalies for all times , which are then converted to true anomalies using kepler s equation .    for data spanning multiple transits , the reference time should be close to the weighted mean transit number .",
    "this selection typically minimizes the correlation between the orbital period and reference time . in such a case , the range of allowed values for the fitting routine to explore vary from @xmath21 .",
    "moving outside of this range would cause the fitting routine to assign a different transit epoch as the reference transit instead",
    ".      now consider a planet with a moon .",
    "the barycentre of the planet - moon system essentially behaves in the same way which was used to describe the planet - only case .",
    "the observed time of transit minimum of the planet is displaced from a linear ephemeris by a small time @xmath22 , due to transit timing variations @xcite .",
    "however , the barycentre behaves identically to before and still passes the star at a minimum when @xmath23 .",
    "therefore , there is no need to change anything here except that it is understood that the @xmath11 value we fit for is not the time of transit minimum of the planet but the time of transit minimum of the planet - moon barycentre across the star , and thus we denote it as @xmath24 .    for the moon",
    ", an analogous logic may be followed .",
    "there must exist a second time shift , @xmath25 , to account for the phasing between the moon in its orbit around the barycentre .",
    "it also seems clear that this phase time has a range of @xmath26 ( orbital period of the moon around the barycentre ) , in analogy to the @xmath24 case .",
    "let us imagine we have subtracted @xmath24 from all of our times so are left with times running from , say , @xmath27 .",
    "the obvious deduction is that we must now subtract a value @xmath25 to get to a new time frame @xmath28 , just as we did for @xmath24 .",
    "a natural choice for @xmath25 is the instant when d@xmath29/d@xmath30 . in analogy to the previous case , this occurs at @xmath31 , where @xmath32 is the perturbation term .",
    "because this parameter is a phasing term , we prefer to use @xmath33 as a definition , to decrease the correlations with the orbital period .",
    "a unique problem with luna  is that exomoons can be either prograde or retrograde .",
    "whilst for planets this is also true , it actually makes no difference to the transit light curve ( although the rossiter - mclaughlin phenomenon is affected ) .",
    "however , for a moon the sense of motion is distinguishable via the ttv and tdv effects @xcite , meaning it does affect the transits and so can not be neglected .",
    "we tackle this by treating retrograde moons as having @xmath34 and prograde moons as having @xmath35 .",
    "it is shown in @xcite that this definition produces the correct retrograde behaviour for the selected coordinate system ] .",
    "we point out that the asymmetry between prograde and retrograde moons is small .",
    "the source of the asymmetry comes from the relative phase difference between the tdv - v and tdv - tip effects , which is @xmath36 for prograde moons and @xmath37 for retrograde @xcite .",
    "therefore , the determination of the sense of orbital motion is only generally possible if both tdv - v and tdv - tip effects are observable .      from a naive perspective",
    ", one might start by considering that the transit light curve of a planet and a moon can be computed by calculating the light curve of both separately and then simply adding the signals together .",
    "however , there exists numerous scenarios where this would break down .",
    "for example , the moon could be eclipsing the star but fully inside the planetary disc and thus the change in flux caused by the moon would be zero .    to overcome this , we start by generating the planetary light curve in the normal way .",
    "this can be done using the @xcite routine with any limb darkening law we wish and not making any size approximations .",
    "having computed this curve , we need to add on the contribution from the moon . what really matters is what part of the moon is `` actively '' transiting the star .",
    "we define this as the area of the moon which overlaps the star but does not overlap the planet .",
    "if we can find this area , then we could compute a light curve for a planet + moon without any limb darkening effects immediately , which is a necessary first step .",
    "the subject of the moon s actively transiting area will be derived later in ",
    "[ sec : areas ] .    for now , let us assume we know what this area is and continue to think about how the limb darkened light curve of the actively transiting moon can be computed . in general , we are interested in achieving two things i ) focussing on moons rather than , say , binary - planets ii ) actually detecting such signals .",
    "the first of these means we are dealing with small objects such that @xmath38 in all cases and most likely @xmath39 in most cases ( where @xmath40 is the ratio of the satellite - to - star radii ) .",
    "the second point means that we need to be able to perform fits of transit light curves including all of the planet and moon properties .",
    "the inevitably large amount of parameter space necessitates computationally efficient and expedient algorithms .",
    "putting these two arguments together indicates that the best way forward is to employ the small - planet approximation case used in @xcite .",
    "this will ensure accurate modelling of the limb darkening but very fast algorithms .",
    "we stress that the planet is still modelled using the full equations since the host planet could be a jupiter sized object , yielding @xmath41 ( where @xmath42 is the ratio of the planet - to - star radii ) .",
    "therefore , we assume the moon is small and the planet is not .",
    "one limitation of this assumption is `` binary - jupiters '' .",
    "if we have a binary - planet system for which the smaller body satisfies @xmath43 then the algorithm we develop here will be limited in accuracy .",
    "however , the current focus of luna  is solely to detect small bodies .",
    "let us assume that the component of the moon s area which actively transits the star is known and equals @xmath44 . before we can compute the resulting limb darkened light curve from this component",
    ", we must first consider the case for a uniform source .",
    "we start by assuming the actively transiting component of the moon is equal to that which would transit in the absence of a planet . in other words ,",
    "we here ignore the planet and will re - introduce it later .",
    "we follow the methodology of @xcite , where the ratio of obscured to unobscured flux is given as @xmath45 ( replacing the appropriate symbols for the exomoon case ) :",
    "@xmath46 &   |1-s| < s_{s * }   \\le 1+s \\\\",
    "s^2 & s_{s * } \\le 1-s\\\\ 1   &   s_{s * } \\le s-1,\\\\ \\end{array}\\right.\\ ] ]    where @xmath47 $ ] , @xmath48 $ ] and @xmath49 .",
    "the most interesting case is clearly @xmath50 , where only a portion of the moon transits the star .",
    "the area of the moon which transits the star may be denoted as @xmath51 where the subscript indicates @xmath5 is transiting @xmath52 .    in this case ,",
    "@xmath53 , but @xmath54 really generally describes the area of intersection between any two circles .",
    "we prefer to generalize the equations at this stage , which will prove useful later .",
    "therefore , the area of intersection caused by object of radius @xmath55 transiting object of radius @xmath56 , with separation @xmath5 , is :    @xmath57 \\\\ \\kappa_1(r , r , s ) & = \\arccos\\big[\\frac{s^2+r^2-r^2}{2 s r}\\big ] \\\\ \\kappa_2(r , r , s ) & = \\sqrt{\\frac{4 s^2 r^2 - ( r^2+s^2-r^2)^2}{4 } } \\label{eqn : alpha}\\end{aligned}\\ ] ]    let us now re - introduce the planet .",
    "the consequences are that in various circumstances the portion of the moon s shadow which actively transits the star is diminished due to overlap between the planet and the moon .",
    "we will discuss the derivation of the actively transiting lunar area in  [ sec : areas ] , but for now it is sufficient to say that for a uniform source the loss of light due to the lunar component is :    @xmath58    as an example , in the case of no overlap between the planet and the moon , but the moon fully inside the stellar disc , @xmath59 and thus we recover the expected form shown in equation  [ eqn : uniform ] .      looking at the equations for a uniform source ( equation  [ eqn : uniform ] ) , one may identify three distinct cases : i ) moon fully outside the stellar disc ii ) moon partially inside the stellar disc iii ) moon fully inside the stellar disc .",
    "the first of these is trivial ; there is no transit occurring .",
    "the third is also trivial for a uniform source but not so for a limb darkened one . for reasons which become clearer later , it is necessary to separate ii ) into two different cases dependent upon whether the moon overlaps the stellar centre or not ( cases iii and ix in the original @xcite assignment ) . to summarize the different cases of interest , we direct the reader to table  [ tab : mandel ] .",
    ".list of cases identified by @xcite .",
    "we use the same case notation in this work , but modifying them to emphasise the focus on moons . [ cols=\"<,^,^ \" , ]     [ tab : nepm2none ]      the simulations above are all for m2 stars with habitable - zone neptune - like planets and earth - like moons .",
    "these parameters were chosen as @xcite have shown that such cases are optimally detectable for habitable - zone scenarios .",
    "we also tried the same configurations but using a k5 dwarf ( @xmath60@xmath61 and @xmath62@xmath63 ) but the longer period of the habitable - zone ( half as many transits in the same time window ) combined with lower radius and mass ratios for both the planet and moon meant we were unable to find convergent fits .",
    "this is not surprising and echoes the motif of the _ mearth _ project @xcite and the predictions in @xcite .    in reviewing our fits",
    ", we find that for quantities such as @xmath64 and @xmath40 , which are positive definite , an overestimation of their value is common due to the boundary condition that they are greater than zero and the generally low signal - to - noise .",
    "this is similar to the situation for orbital eccentricity in radial velocity fits @xcite .",
    "other works in the scientific literature have made use of algorithms to simulate exomoon transit light curves . to our knowledge",
    ", there exists several previous uses of such routines .",
    "figure  4 of @xcite presents four simulations of planet - moon combined transits , although details on the methods use to produce these simulations are sparse .",
    "similarly , @xcite and @xcite present figures with simulated combined transits , although the focus is on a custom definition of transit timing in the former and the effects of the rossiter - mclaughlin effect in the latter ( i.e. few details on the methods use to generate the light curves are provided ) .",
    "finally , @xcite present perhaps the most detailed account of a method to generate planet - moon transit light curves but specifically negate the longitude of the ascending node , orbital inclination of the barycentre , orbital eccentricity of the moon , limb darkening effects and use constant velocity approximations to model the planet / moon motion .    in all cases , there is no reference to the @xcite solution and we therefore assume this was not utilized in those works .",
    "therefore , all of the previous models must be at least partially numerical in nature since the solution of @xcite is the first instance of an analytic solution for the area of common overlap between three circles .",
    "in contrast , luna  is fully analytic and we indeed find no appreciable computational time difference between using luna  versus the usual @xcite routine",
    ".      visual examination of the simulations presented in  [ sec : examples ] , in particular figure  [ fig : nepm2close_big ] , reveals that mutual events ( i.e. when the planet and moon eclipse one another , during the stellar eclipse ) bear a close resemblance to the morphology of a starspot crossing ( i.e. when a planet eclipses a starspot on the surface of the star , during the stellar eclipse ) . examples of starspot crossing events can be found in @xcite and @xcite .",
    "this observation leads to the question as to how one could distinguish between a bona - fide moon and a starspot .",
    "although a detailed study of this question remains beyond the scope of this work , we suggest here that there are several tools at our disposal to make such a determination .",
    "firstly , starspots are expected to co - rotate with the stellar rotation period , @xmath65 , which can be found by , for example , tracking the long - term flux variation of the target star ( e.g. see @xcite @xcite ) .",
    "application of a spot model to the light curve can test whether the spots are consistent with a rotation period determined through other means @xcite .",
    "a second method we can use is to employ the expressions of @xcite , which make use of the system dynamics to measure the mass and radius of the host star for exomoon systems .",
    "if the determined mass and radius are inconsistent other methods , such as spectroscopy combined with stellar evolution modelling , then it is likely the putative exomoon signal is in fact due to starspots . whilst a dynamically - determined stellar mass and radius consistent with the spectroscopic value is not a proof of an exomoon",
    ", one may evaluate the false - alarm - probability of a starspot coincidentally inducing features which when modelled with luna  cause precisely the correct stellar mass and radius to be determined .",
    "also , a moon may induce transit timing effects which give rise a derived lunar density which can be compared to expectation .    a third method",
    "we suggest is that starspot crossing events will vary in amplitude when viewed chromatically , whereas the exomoon signal will have a chromatic variation much lower ( due to atmospheric molecular absorption ) and typically undetectable ( unless utilizing a telescope such as jwst , see @xcite @xcite ) . as an example",
    ", one could observe the target simultaneously in the visible and infrared wavelengths to test for this chromatic variation .      in this paper",
    ", we have presented a new algorithm called luna  for modelling the transit light curves of a single planet with a single moon transiting a star .",
    "luna  was designed from the outset to satisfy several key criteria :    * analytic ( absolutely no numerical components ) * dynamic ( inherently accounts for all timing effects ) * limb darkening incorporated ( including non - linear laws ) * all orbital elements accounted for ( e.g. eccentricity , longitude of the ascending node , etc )    as a result of being both precise and analytic , luna  is a highly potent weapon in exomoon detection .",
    "all of the previously predicted observational consequences , such as ttv , tdv - v and tdv - tip , are inherently built into the routine , plus previously unconsidered effects such as ingress / egress asymmetry .",
    "this is done by modelling the reflex motion of the planet due the moon at every instance , which is ultimately responsible for all of the aforementioned timing effects .",
    "transits and mutual eclipses are accounted for using non - linear limb darkening laws meaning luna  models all known observational consequences of exomoons for transiting systems .",
    "further , physical parameters of the star , planet and moon may be derived utilizing the dynamical trick described in @xcite .",
    "we have provided simulations of our new algorithm and re - fitted realistic noised data with mcmc methods to demonstrate the inverse retrieval of parameters . in one example , these fits demonstrate that the @xcite technique is capable of estimating the stellar mass and radius down to @xmath6615% and @xmath665% respectively . for the exomoon",
    "this becomes @xmath6612% and @xmath666% respectively . whilst this is only one singular realization ,",
    "the simulations lend credence to the prospect of characterizing the internal structure and composition of earth - mass bodies with current instrumentation .",
    "we stress that these examples are primarily to illustrate the effectiveness of our new algorithm rather than estimate the range of configurations which can be conceivably detected , which will be considered in future work .    in this work ,",
    "we have assumed the moon is small ( @xmath67 ) but future work will focus on relaxing this constraint so that gas giant binaries may be modelled as well .",
    "d. m. k. has been supported by smithsonian institution restricted endowment funds , nasa grant nnx08af23 g and ucl , through the science technology and facilities council ( stfc ) studentships .",
    "special thanks to the anonymous referee for their highly useful advise and suggestions",
    ".    99 carter , j. a. , yee , j. c. , eastman , j. , gaudi , b. s. & winn , j. n. , 2008 , apj , 689 , 499 claret , a. 2000 , a&a , 363 , 1081 cox , a. n. ( ed . ) , allen s astrophysical quantities ( 4th edition ) ( springer , heidelberg ) , 2000 domingos , r. c. , winter , o. c. & yokoyama , t. 2006 , mnras , 373 , 1227 donnison j. r. , 2010 , mnras , 406 , 1918 fewell , m. , `` area of common overlap of three circles '' , tech .",
    "dsto - tn-0722 , 2006 .",
    "[ online ] .",
    "available : http://hdl.handle.net/1947/4551 han , c. & han , w. 2002 , apj , 580 , 490 henry , g. w. , & winn , j. n. 2008 , aj , 135 , 68 irwin , j. , charbonneau , d. , nutzman , p. & falco , e. 2009 , in iau symp .",
    "253 , transiting planets , ed .",
    "f. pont , d. sasselov , & m. holman ( cambridge : cambridge univ . press ) , 37 kipping , d. m. , 2008 , mnras , 389 , 1383 kipping , d. m. , 2009a , mnras , 392 , 181 kipping , d. m. , 2009b , mnras , 396 , 1797 kipping , d. m. , fossey , s. j. & campanella , g. , 2009c , mnras , 400 , 398 kipping , d. m. , fossey , s. j. , campanella , g. , schneider , j. , & tinetti , g. 2009d , in asp conf .",
    "430 , pathways towards habitable planets , ed .",
    "v. c. du foresto , d. m. gelino , & i. ribas ( san francisco , ca : asp ) , 139 kipping , d. m. , 2010a , mnras , 407 , 301 kipping , d. m. 2010b , mnras letters , 409 , l119 kipping , d. m. 2011 , phd thesis , university college london kipping , d. m. & bakos , g. , 2011a , apj , 730 , 50 kipping , d. m. & bakos , g. , 2011b , apj , 733 , 36 kurucz r. , 2006 , stellar model and associated spectra ( http://kurucz.harvard.edu/grids.html ) lewis , k. m. , sackett , p. d. & mardling , r. a. 2008 , apj , 685 , 153 liddle , a. r. 2007 , mnras , 377 , l74 lovis , c. et al .",
    "2011 , a&a , 528 , 112 lucy , l. b. & sweeney , m. a. 1971 , aj , 76 , 544 mandel , k. & agol , e. 2002 , apj , 580 , l171 murray , c. d. & dermott , s. f. ( 1999 ) , solar system dynamics , cambridge university press , cambridge murray , c. d. & correia , a. c. m. 2010 , exoplanets , eds . s. seager , university of arizona press pont , f. et al .",
    "2007 , a&a , 476 , 1347 rabus , m. et al .",
    "2009 , a&a , 494 , 391 sartoretti , p. & schneider , j. , 1999 , a&as , 134 , 553 sato , m. & asada , h. 2009 , pasj , 61 , l29 sato , m. & asada , h. 2009 , pasj , 62 , 1203 schwarz , g. 1978 , the annals of statistics , 6 , 461 silva - valio , a. & lanza , a. f. 2011 , a&a , 529 , 36 simon , a. , szab , gy .",
    "m. & szatmry , k. 2009 , em&p , 105 , 385 szab , gy . m. , szatmry , k. , divki , zs . &",
    "simon , a. 2006 , a&a , 2006 , 450 , 395 vogt , s. s. , butler , r. p. , rivera , e. j. , haghighipour , n. , henry , g. w. & williamson , m. h. 2010 , apj , 723 , 954",
    "we will here derive the relative sky - projected motions of the planet and the moon , as used in the luna  algorithm .",
    "our goal is to find analytic expressions for the terms @xmath2 , @xmath3 and @xmath4 , which were introduced in ",
    "[ sub : conversion ] .",
    "we will assume only a single moon in our model and a single planet .",
    "to predict the positions of the planet and moon at any instant in time , one must solve the three - body problem .",
    "since no general , analytic solution exists for this problem , one must choose to work in a restricted case where analytic expressions can be employed .    in this work , we will use the nested two - body model presented in @xcite .",
    "this considers the motion of the moon to be independent of the star in the reference frame of the planet - moon barycentre ( dubbed the `` inner frame '' ) .",
    "therefore , in the inner frame the motions are keplerian .",
    "the barycentre is then considered to also maintain keplerian motion around the host star in the `` outer frame '' .",
    "as shown in @xcite , this model is an excellent approximation for @xmath68 , where @xmath69 is the moon s semi - major axis around the planet - moon barycentre and @xmath70 is the hill radius of the planet .",
    "since all bounded prograde satellites must satisfy @xmath71 @xcite , then the nested two - body model encompasses all prograde moons .",
    "we also point out that one may switch the module computing the motions fairly simply , but throughout this paper we will use the nested two - body model .",
    "let us consider the inner frame first , comprising of the planet and moon orbiting a common centre of mass .",
    "we define the moon to planet - moon barycentre distance , at any instant in time , as @xmath72 .",
    "the subscript notation represents s to b or `` satellite '' to `` barycentre '' ( where barycentre is understood to be the planet - moon barycentre ) .",
    "this notation scheme will be employed throughout this paper so that there exists no ambiguity as to what is being referred to .      where @xmath69 is the satellite to barycentre semi - major axis",
    ", @xmath7 is the true anomaly of the satellite around the barycentre and @xmath74 is eccentricity of the satellite s orbit around the barycentre .",
    "one of the simplest reference frames in which to view the orbital motion is when the line connecting the apoapse and periapse is the @xmath75-axis and the orbit lies entirely within the @xmath75-@xmath76 plane . placing the barycentre at the focus lying at @xmath77 , the cartesian coordinates of the satellite",
    "are defined by ( lower - case symbols are used to denote this is the simple view of the system not yet accounting for an observer s viewing angle ) :      this is highly analogous to the usual equations describing a planet - star system . in the case of a planet - star ,",
    "one starts with the analogous version of equation  [ eqn : initialsb ] and then performs three rotations to account for the viewing angle an observer has to the system @xcite .",
    "these three angles are the argument of periapsis , @xmath79 , the orbital inclination , @xmath80 , and the longitude of the ascending node , @xmath81 .",
    "the rotations are performed sequentially in a clockwise sense for the @xmath82-@xmath75-@xmath82 axes respectively and are shown in figure  [ fig : complexframe ] .      the same scheme will be adopted here for the planet - moon inner frame .",
    "for the planet - star case , @xmath80 is generally close to @xmath84 for transits and thus is a large rotation .",
    "however , in our case , we choose to perturb the orbit from the coplanar condition .",
    "therefore , we define a small angle for the inclination rotation , @xmath85 , and use @xmath86 so that @xmath87 corresponds to a coplanar case , in an analogous way to what is used for the planet - star case . the three angles and @xmath88 take the range @xmath89 .",
    "we also allow @xmath85 to take the range @xmath89 although only @xmath37 radians are required to uniquely define every point in space .",
    "this is done to prevent boundary conditions when fitting data . ]",
    "we need to rotate by are @xmath90 , @xmath85 and @xmath88 .",
    "@xcite showed that these rotations may be concisely expressed in matrix notation .",
    "following @xcite , we denote the following clockwise rotation matrices about the @xmath75 and @xmath82 axes respectively :              @xmath96 \\nonumber \\\\ y_{sb } & = r_{sb } [ \\sin\\omega_{sb}\\cos(\\omega_{sb}+f_{sb } ) \\nonumber \\\\ \\qquad & + \\sin i_{sb}\\cos\\omega_{sb}\\sin(\\omega_{sb}+f_{sb } ) ] \\nonumber \\\\ z_{sb } & = r_{sb } \\cos i_{sb } \\sin(\\omega_{sb}+f_{sb } ) \\label{eqn : finalsb}\\end{aligned}\\ ] ]          to obtain the overall motion , we now need to account for motion of the planet - moon barycentre around the star . placing the star at the origin , the barycentre - star separation , at any instant ,",
    "is given by :      where @xmath100 is the barycentre to star semi - major axis ( usually just dubbed @xmath101 ) , @xmath6 is the true anomaly of the barycentre around the star ( usually just dubbed @xmath12 ) and @xmath102 is eccentricity of the barycentre s orbit around the star ( usually just dubbed @xmath103 ) .    in exactly the same way",
    "as was done in the inner frame , the barycentre s position can be described in a simple frame which is then rotated to account for the viewing angle of the observer .",
    "the simple frame has the barycentre at cartesian coordinates :          the last rotation , about @xmath82 by @xmath106 , has no bearing on the transit because the light curve is defined by the star - planet separation only , which is invariant about a @xmath82-axis rotation since the observer lies at @xmath107 .",
    "for this reason , there is no need to include this final angle in practice :      to compute the cartesian coordinates of the planet and moon ( rather than the planet - moon barycentre ) , we need to combine the results of the inner frame derivation with the process of the outer frame .",
    "this is achieved by considering that :                    the usual planetary transit light curve is completely described by the sky - projected distance between the planet and the star . in the same way , the light curve of a planet with a moon is described by the sky - projected distances , defined as @xmath116 ( units of the stellar radius are used ) .",
    "using @xmath117 , @xmath118 and @xmath119 , the sky - projected moon - star distance is :    @xmath120 ^ 2 \\nonumber \\\\ \\qquad & + \\big [ r_{b * } ' \\cos i_{b * } \\sin(f_{b*}+\\omega_{b * } ) \\nonumber \\\\ \\qquad & - r_{sb } ' \\cos i_{sb } \\sin i_{b * } \\sin(f_{sb}+\\omega_{sb } ) \\nonumber \\\\ \\qquad & + r_{sb } ' \\cos i_{b * } \\sin i_{sb } \\cos(\\omega_{b*}+\\omega_{sb } ) \\sin(f_{sb}+\\omega_{sb } ) \\nonumber \\\\ \\qquad & + r_{sb } ' \\cos i_{b * } \\sin(\\omega_{b*}+\\omega_{sb } ) \\cos(f_{sb}+\\omega_{sb } ) \\big]^2 \\label{eqn : smoon}\\end{aligned}\\ ] ]      @xmath121 ^ 2 \\nonumber \\\\ \\qquad & + \\big [ r_{b * } ' \\cos i_{b * } \\sin(f_{b*}+\\omega_{b * } ) \\nonumber \\\\ \\qquad & + r_{pb } ' \\cos i_{sb } \\sin_{b * } \\sin(f_{sb}+\\omega_{sb } ) \\nonumber \\\\ \\qquad & - r_{pb } ' \\cos i_{b * } \\sin i_{sb } \\cos(\\omega_{b*}+\\omega_{sb } ) \\sin(f_{sb}+\\omega_{sb } ) \\nonumber \\\\ \\qquad & - r_{pb } ' \\cos i_{b * } \\sin(\\omega_{b*}+\\omega_{sb } ) \\cos(f_{sb}+\\omega_{sb } ) \\big]^2 \\label{eqn : splanet}\\end{aligned}\\ ] ]      @xmath122 ^ 2 \\bigg ( \\big [ \\cos(\\omega_{b*}+\\omega_{sb } ) \\cos(f_{sb}+\\omega_{sb } ) \\nonumber \\\\ \\qquad & -\\sin i_{sb}\\sin(\\omega_{b*}+\\omega_{sb})\\sin(f_{sb}+\\omega_{sb})\\big]^2   \\nonumber \\\\ \\qquad & + \\big [ \\sin i_{b*}\\cos i_{sb}\\sin(f_{sb}+\\omega_{sb } ) \\nonumber \\\\ \\qquad & - \\cos i_{b * } \\sin i_{sb } \\cos(\\omega_{b*}+\\omega_{sb } ) \\sin(f_{sb}+\\omega_{sb } ) \\nonumber \\\\ \\qquad & - \\cos i_{b * } \\sin(\\omega_{b*}+\\omega_{sb } ) \\cos(f_{sb}+\\omega_{sb } ) \\big]^2 \\bigg ) \\label{eqn : smoonplanet}\\end{aligned}\\ ] ]      inspection of the above equations reveals several repeating units . substituting these units allows for a more simple and intuitive expression of the sky projected distances .",
    "the following two units repeat in all three sky projected distances :    @xmath123   \\\\ \\gamma & = r_{sb } ' \\big [ \\cos i_{b * } \\sin i_{sb } \\cos(\\omega_{b*}+\\omega_{sb } )   \\sin(f_{sb}+\\omega_{sb } ) \\nonumber \\\\ \\qquad & + \\cos i_{b * } \\sin(\\omega_{b*}+\\omega_{sb } ) \\cos(f_{sb}+\\omega_{sb } )   \\nonumber \\\\ \\qquad & - \\sin i_{b * } \\cos i_{sb } \\sin(f_{sb}+\\omega_{sb } ) \\big ] \\label{eqn : gammabeta}\\end{aligned}\\ ] ]      @xmath124 ^ 2 \\nonumber \\\\ \\qquad & + [ r_{b * } ' \\cos i_{b * } \\sin(f_{b*}+\\omega_{b * } ) + \\gamma]^2 \\\\ s_{p * } & = [ r_{b * } ' \\cos(f_{b*}+\\omega_{b * } ) - ( m_s / m_p ) \\beta]^2 \\nonumber \\\\ \\qquad & + [ r_{b * } ' \\cos i_{b * } \\sin(f_{b*}+\\omega_{b * } ) - ( m_s / m_p ) \\gamma]^2 \\\\ s_{sp } & = [ 1+(m_s / m_p)]^2 [ \\beta^2 + \\gamma^2]\\end{aligned}\\ ] ]                        here , @xmath131 , the impact parameter of the barycentre across the face of the star , and @xmath132 for a circular orbit .",
    "these two parameters are typically fitted for in planetary light curve analysis , but it is widely known that they share a strong correlation . in matrix form",
    "we have the `` outer '' matrix as :"
  ],
  "abstract_text": [
    "<S> it has been previously shown that moons of extrasolar planets may be detectable with the _ kepler mission _ , for moon masses above @xmath0@xmath1 @xcite . </S>",
    "<S> transit timing effects have been formerly identified as a potent tool to this end , exploiting the dynamics of the system . in this work , </S>",
    "<S> we explore the simulation of transit light curves of a planet plus a single moon including not only the transit timing effects but also the light curve signal of the moon itself . </S>",
    "<S> we introduce our new algorithm , luna , which produces transit light curves for both bodies , analytically accounting for shadow overlaps , stellar limb darkening and planet - moon dynamical motion . by building the dynamics into the core of luna , </S>",
    "<S> the routine automatically accounts for transit timing / duration variations and ingress / egress asymmetries for not only the planet , but also the moon . </S>",
    "<S> + we then generate some artificial data for two feasibly detectable hypothetical systems of interest : a i ) prograde and ii ) retrograde earth - like moon around a habitable - zone neptune for a m - dwarf system . </S>",
    "<S> we fit the hypothetical systems using luna  and demonstrate the feasibility of detecting these cases with _ kepler _ photometry .    </S>",
    "<S> [ firstpage ]    techniques : photometric  planets and satellites : general  planetary systems  eclipses  methods : analytical </S>"
  ]
}