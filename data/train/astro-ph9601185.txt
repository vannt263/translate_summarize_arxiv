{
  "article_text": [
    "recent measurements of galaxy clustering from redshift surveys and angular catalogs , together with limits on the clustering of mass implied by the cobe dmr experiment , yield important constraints on proposed models for the formation of large - scale structure .",
    "however , we lack accurate constraints on fluctuations in galaxy density on scales that overlap with those probed by cobe , and the extant measurements have poor resolution on scales where certain theories predict interesting features in the power spectrum . several surveys , either planned or in progress , promise to yield the desired measurements of the power spectrum of galaxy density fluctuations , but the complex geometry and sampling of these surveys pose a strong challenge to traditional methods of power spectrum analysis .",
    "the ultimate measurement of the galaxy fluctuation spectrum will result from combining all of the available data into one sample .",
    "this possibility begs the question , how do we obtain the best possible estimate of the power spectrum from a sample with arbitrarily complex geometry and with varying sampling density ? in this paper we describe a method for power spectrum estimation that is optimal for any survey .",
    "subsequent papers in this series will describe the results of applying these techniques to observations .      the power spectrum or its fourier transform , the autocorrelation function , measures the lowest order departures from homogeneity .",
    "standard models for the formation of large - scale structure provide strong motivation for measuring the power spectrum : if structure grows via gravitational instability from an initially gaussian density field ( as predicted by inflation ) , then large - scale fluctuations at the present epoch could reveal signatures of the initial conditions .    we choose to focus on the power spectrum rather than the correlation function or other measures of variance because , although the power spectrum and correlation function form a fourier transform pair , the former more clearly reflects the physical scales and processes that affect structure formation on large scales .",
    "for example , in cdm models , the horizon size at the epoch of equality between the density of matter and radiation is revealed by the peak of the power spectrum . a large baryon content in the universe would cause small `` wiggles '' near this scale that might be seen in the power spectrum .",
    "such features would be integrated over and therefore difficult to detect in the correlation function .",
    "in addition to more clearly reflecting the initial conditions , power spectrum estimation has several statistical advantages .",
    "because the power spectrum of any statistical process is positive definite for every wavenumber , we obtain a quick sanity check on our calculations ; a negative value tells us that , e.g. , we have erred in subtracting out the shot noise component of the power . for likelihood analysis of proposed models ,",
    "this bound usefully constrains the available parameter space of power spectrum models .",
    "we note that one formerly - tauted advantage of power spectrum analysis no longer applies ; improved estimators for the correlation function ( landy & szalay 1993 ; hamilton 1993 ) are afflicted by uncertainty in the mean density only to the same degree as the standard power spectrum estimator .    in our discussion of eigenmode analysis , we often mathematically represent the galaxy density fluctuations with the correlation function .",
    "nevertheless , the quantity we seek to estimate is the power spectrum , which we fourier transform to compute quantities in real space , such as the correlation function .      using standard estimation techniques ( as described in section 1.3 below )",
    ", the 3-d redshift - space power spectrum has been estimated for redshift samples of optically - selected ( cfa1 [ baumgart & fry 1991 ] , ssrs1 [ park , gott , & da costa 1992 ] , cfa2 [ vogeley et al 1992 ; park et al . 1994 ] , combined ssrs2+cfa2 [ da costa et al .",
    "1994 ] , las campaas [ lin et al . 1995 ] ) , infrared ( iras 1.2jy",
    "[ fisher et al . 1993 ] , qdot [ feldman , kaiser , & peacock 1994 , fkp hereafter ] ) , and radio galaxies ( peacock & nicholson 1991 ) .",
    "( see vogeley 1995 for a recent review . )",
    "these redshift - space power spectra all roughly agree in shape , @xmath0 with @xmath1 on scales @xmath2 mpc and @xmath3 for @xmath4 mpc , with weak evidence for a turnover on a scale @xmath5 mpc .",
    "the amplitudes of these power spectra vary systematically with the species of galaxy in the sample .",
    "in particular , there is mounting evidence for luminosity bias , in the sense that bright optically - selected galaxies have a larger clustering amplitude than their fainter companions , though with the same power spectrum shape ( park et al .",
    "1994 ) .",
    "these power spectrum measurements yield excellent constraints on models with cdm - like power spectra , but are insufficient to differentiate among the broad classes of contending models .",
    "the data can be well fit by a cdm power spectrum with @xmath6 ( kofman , gnedin , & bahcall 1993 ; peacock & dodds 1994 ) .",
    "the power spectrum of the `` standard '' @xmath7kms@xmath8 model is excluded due to an excess of small vs. large - scale power .",
    "due to the strong influence of peculiar velocities in this model , the shape of the redshift - space power spectrum is roughly correct , but the amplitude is too high ( when normalized to cobe , this model requires _ anti - biasing _ of all but the very brightest galaxies [ stompor , grski , & banday 1995 ] ) .",
    "however , several alternative models predict power spectra with nearly the same shape and the correct normalization , among which the current data do not strongly discriminate .",
    "the list of candidates includes ( but is not limited to ) cdm models with non - zero cosmological constant , open universe cdm , mixed ( cold plus hot ) dark matter models ( e.g. , primack et al .",
    "1995 ) , and warm plus hot dark matter ( e.g. , malaney , starkmane , & widrow 1995 ) .    to further constrain cosmological models ,",
    "we must ( 1 ) close the gap between the scales probed by galaxy surveys and cobe , ( 2 ) measure the detailed shape of the galaxy power spectrum , ( 3 ) determine the dependence of clustering on galaxy species , and ( 4 ) quantify the anisotropy of clustering in redshift space caused by peculiar motions of galaxies .",
    "comparison of power spectra for currently competing models ( e.g. , figure 1 of strauss et al .",
    "1995 ) shows that the shapes of these spectra differ most greatly on scales near and beyond the peak of the spectrum .",
    "there are hints of features in the power spectrum ( e.g. , the feature at @xmath9 mpc in the cfa2 and ssrs2 power spectra [ da costa et al . 1994 ] and the peaks at @xmath10 and @xmath11 mpc seen by broadhurst et al . 1990 ) .",
    "the data are consistent with a turnover on large scales to a @xmath12 spectrum that would be consistent with cobe",
    ". however , more accurate probes of scales @xmath13 mpc and greater are necessary to test for features in the power spectrum on scales where physical processes near the time of matter - radiation equality would leave their imprint and , ultimately , to compare galaxy clustering and the amplitude of mass clustering implied by cmb anisotropy measurements .",
    "the latter , along with knowledge of the dependence of clustering on galaxy selection , will elucidate the relationship between clustering of mass and light in the universe .",
    "measurement of the anisotropy of clustering in redshift space on the largest ( and , therefore , presumably linear - growth ) scales can yield a direct measurement of the mean cosmic density ( kaiser 1987 ; hamilton 1992 ; cole , fisher , & weinberg 1993 ) .      to increase the largest scales that we probe and the resolution of these measurements",
    ", we must survey a larger volume of the universe .",
    "several ongoing and planned surveys promise to yield better constraints on the fluctuation spectrum , but the geometries of these samples pose a challenge to standard methods of power spectrum estimation .",
    "deeper surveys of this type that are completed , or are soon to be , include pencil beam surveys ( broadhurst et al . 1990 , 1995 ) and several deep slice surveys : the las campaas ( shectman et al . 1995 ) , century ( geller et al . 1995 ) , and esp ( vettolani et al . 1995 ) surveys .",
    "within the next two years we also expect results from the aat 2df survey and the sloan digital sky survey ( sdss hereafter ) .",
    "most of the sensitivity of the aat survey to large - scale fluctuations will result from an ensemble of 100 randomly spaced pencil beams of 400 galaxies each . over its five year duration ,",
    "the sdss will obtain redshifts for @xmath14 galaxies over a contiguous area of @xmath15 steradians in the north galactic cap , and therefore have a rather simple geometry , but earlier partial data ( e.g. , @xmath16 galaxies over some set of narrow stripes on the sky in the first year ) and the survey in the south ( three @xmath17 stripes ) will be more complex .",
    "standard methods for estimating the power spectrum all follow the same basic scheme : we directly sum the planewave contributions from each galaxy , @xmath18 where @xmath19 is the weight given to the @xmath20 galaxy and we subtract @xmath21 , which is the contribution to each mode from the finite survey window ( @xmath22 inside the survey and 0 elsewhere ) and the selection function @xmath23 , @xmath24 next we compute the square of the modulus of each fourier coefficient and subtract the power due to shot noise , @xmath25 ^ 2 \\over { 1\\over ( 2\\pi)^3 } \\int d^3k ' \\ , |\\tilde{w}(\\kbf')|^2},\\ ] ] and average these estimates over a shell in k - space to yield an estimate of @xmath26 .",
    "the denominator of equation ( 3 ) enforces the convention that @xmath26 has the units of volume .",
    "methods vary in the details ( compare park et al .",
    "1994 , fisher et al .",
    "1993 , and fkp ) , including the weights applied to each galaxy , how the window function of the survey is computed , corrections ( or lack thereof ) for the damping of large - scale power ( analogous to the integral constraint on the correlation function ",
    "see below ) , and attempts to deconvolve the true power from the window function of the survey .",
    "the standard methods of power spectrum analysis have several weaknesses that become even more serious when applied to surveys with complex geometry and sampling .",
    "a critical problem is that the basis functions of the fourier expansion ( plane waves ) are not orthonormal over a finite non - periodic volume .",
    "following equations ( 1)-(3 ) the power measured at any wavenumber is a convolution of the true power with the window function of the survey , @xmath27 the estimates of power at different wavenumber have a covariance that depends on the shape of the survey volume .",
    "if the survey is oddly - shaped , then estimates @xmath28 with the same @xmath29 but different direction @xmath30 sample different ranges of wavenumber because @xmath31 is anisotropic .",
    "averaging over a shell in @xmath32-space combines power estimates with varying bandpass and , therefore , different signal - to - noise ratios .",
    "further complications arise when we consider how to optimally weight the galaxies ( as in eq .",
    "[ 1 ] ) in different regions of a survey .",
    "the signal - to - noise for detection of clustering depends on the sampling rate of galaxies in the survey , which may vary due to survey strategy ( e.g. , the las campaas survey , which observes the same number of galaxies in each plug plate field ) , extinction ( for a survey which includes galaxies to a fixed apparent magnitude if uncorrected for extinction ) , combining different surveys into a single sample , or simply because the selection function varies with distance ( in the case where we analyze apparent - magnitude limited samples ) .",
    "fkp derive a weighting scheme that yields minimal variance in the standard power spectrum estimator , @xmath33 this weighting scheme is correct in the case where ( 1 ) the density fluctuations are gaussian , ( 2 ) the only source of uncertainty is shot noise , and ( 3 ) the window function is close to spherically symmetric ( the latter is , in fact , the case for the qdot sample that they examine ) .",
    "in general , the set of weights applied to the galaxies should vary with the wavenumber @xmath34 being probed . in practice , most authors use a single set of weights , following the argument that it is tedious to vary them with @xmath34 ( because it requires an _ a priori _ estimate of @xmath35 at each wavenumber ) and that the results do not depend sensitively on varying @xmath35 in the weights .",
    "if the sampling density strongly varies , then this approximation is quite poor . in the case of the fkp analysis of the qdot survey ,",
    "it is clear that the estimated @xmath26 does vary with the weighting scheme applied . because they examine a flux - limited sample , the weighting scheme determines the effective depth of the volume used to probe the fluctuations .",
    "if the sampling density of galaxies varies with position on the sky , as in the las campaas survey , then the variation with wavenumber of the weight per galaxy yields a different pattern on the sky for each mode .",
    "ignorance of this variation with wavenumber of the weighting scheme yields estimates of power with unnecessarily poor signal to noise .",
    "uncertainty in the mean density limits our ability to detect fluctuations on very large scales . in equation ( 1 ) , when we subtract the contribution of the window function to each fourier mode , we attempt to subtract the spike at @xmath36 in the true power , which is due to the non - vanishing mean density of galaxies .",
    "because this spike is convolved with the window function of the survey and because we typically estimate the mean density from the sample itself ( which forces @xmath37 within the survey ) , we erroneously subtract the product of the window function with the component of clustering signal on the scale of the survey , @xmath38 .",
    "in other words , we underestimate clustering on scales comparable to and larger than the survey because we can not ( rather , do not attempt to ) ascertain if our chosen volume is under or overdense relative to the rest of the universe .",
    "it is possible to correct for this damping of power on large scales ( peacock & nicholson 1991 ; park et al .",
    "1994 ) , but only if we know the true power spectrum .",
    "odd geometry only complicates this correction : if the geometry and , therefore , the fourier window is anisotropic , then this power damping will be different for each mode . if the survey volume has elements that are narrow in any direction , then the mean density problem will extend down to relatively smaller scales .",
    "a better method would be to simultaneously estimate both the mean density and the power spectrum .",
    "following standard methods , model testing is made difficult by the non - orthonormality of the fourier modes , ambiguity about the optimal number of modes to include in the analysis , and necessary assumptions about the probability distribution of the measured power per mode . in principle , we could test models by computing the full covariance matrix of the power spectrum estimates for each model in consideration and compare their likelihoods , as approximated in fkp .",
    "this procedure requires that we repeatedly invert large , highly nondiagonal matrices .",
    "the size of the matrices could be reduced if we choose a limited set of modes , but this method does not specify the optimal set of power estimates ; nearby modes have large covariance , but we lose statistical power and resolution if we sample too few .",
    "finally , this method requires that we know the covariance matrix of the _ power _ per mode ( which depends on fourth - order moments of the galaxy density ) and the probability distribution of these fourth - order fluctuations for every model under consideration . to test the likelihood that the observations arise from a model with a particular power spectrum , we only require prediction of the covariance matrix of the expansion coefficients themselves , and knowledge of the probability distribution of second - order fluctuations in the density .",
    "a good choice of basis functions eases calculation of this matrix and increases the statistical power of the likelihood function .      rather than make small modifications to the standard method for power spectrum estimation , in this paper we begin anew and derive the complete set of spatial functions that optimally weight the observed data in order to estimate second - order clustering properties of the galaxy distribution , and describe how this expansion naturally leads to straightforward likelihood analysis of proposed models .",
    "the problem of deriving a set of orthonormal functions that are optimal for representing data with known statistical properties has been studied in detail by investigators in the field of signal processing . for any second - order ( mean - square integrable ) statistical process , a unique set of orthonormal functions can be found such that the expansion coefficients in this basis are statistically orthogonal ( see section 2.1 below for discussion of the differences between statistically _ orthogonal , uncorrelated _ , and _ independent _ ) . expansion of an observed data set in this unique set of functions , or _ eigenmodes _ , is known as the karhunen - love transform ( see , e.g. , therrien 1992 or poor 1994 for discussion of the discrete and continuous transforms , respectively ) . in its discrete form ,",
    "this transform proves useful for image compression , filtering and , as we shall discuss , for testing models that predict the second - order clustering properties of the observations . in a nutshell ( see section 2 for a detailed description ) , the karhunen - love transform uses our _ a priori _ knowledge of noise , clustering , and geometry to derive a unique orthonormal basis set for representing the fluctuations in each survey . because these eigenmodes form a complete basis , are statistically orthogonal , and maximize the signal - to - noise per mode , representation in this basis is optimal for testing the likelihood of proposed clustering models .",
    "this transform simultaneously addresses the problems of forming an orthonormal basis and deriving optimal weights for the data . in vogeley ( 1995 )",
    "we introduce the karhunen - love transform as a tool for probing density fluctuations in the galaxy distribution . in this paper",
    "we describe in detail how we use this method to simultaneously estimate the mean density , power spectrum , and redshift - space distortions from galaxy redshift surveys .    in section 2",
    "we derive the karhunen - love transform and several of its important properties . in section 3",
    "we show how to derive the eigenmodes for a galaxy redshift survey and investigate how these modes form an optimal set of filters for power spectrum estimation .",
    "section 4 provides a brief introduction to model testing in the bayesian paradigm and explains how we estimate the confidence regions for proposed models . in section 5",
    "we summarize our estimation method , compare with other transform methods , and describe plans and predictions for application of our eigenmode method to existing and forthcoming survey data . in appendix",
    "a we show that the karhunen - love transform is the optimal basis set for testing clustering models . in appendix",
    "b we derive an approximate method for computing the integral average of the correlation function between two cells .",
    "because the fourier modes are not orthonormal over the finite volume of the survey , this transform is not ideal for representing the observed distribution of galaxies .",
    "one can construct an infinite number of alternative basis functions that are orthonormal over the survey geometry , but the optimal choice of basis depends on the statistical question that we ask of the data .",
    "we want to test models for the galaxy distribution that predict the expectation value and second moments of the observed density . therefore we should expand the observed density field in a set of orthonormal functions that weight the data to yield optimal signal to noise for the second moment of the density and for which the expansion coefficients are statistically orthogonal ( these two conditions turn out to yield the identical set of functions ) .",
    "these requirements on the basis set of the expansion yield a unique set of spatial filters that are optimal for , among other purposes , power spectrum estimation . in this section",
    "we describe how to derive this set of eigenmodes for any scalar function @xmath39 over the survey volume ; later we must decide which scalar field that should be , e.g. , the observed number counts of galaxies or the density contrast of the number counts .    to allow us to present the mathematics in compact form using matrix algebra , and to expedite the implementation of this method on a computer ,",
    "suppose that we divide the survey volume into @xmath40 cells , each with volume @xmath41 .",
    "the @xmath42 cell is centered at @xmath43 and we measure @xmath44 in each cell .    using matrix notation ,",
    "a scalar function @xmath44 is a vector @xmath45 , which we can expand in a set of @xmath40 orthonormal basis vectors @xmath46 with vector of coefficients @xmath47 , @xmath48 where the vectors @xmath49 form the columns of the matrix @xmath50 .",
    "the coefficients of the expansion are defined by the transform @xmath51 the orthonormality condition is @xmath52 with this condition on the basis set , @xmath50 is a unitary matrix and this expansion is equivalent to a rotation of @xmath45 into the space spanned by the set of basis vectors @xmath53 .",
    "the inverse of a unitary matrix is its adjoint , thus @xmath54 .",
    "when we test the likelihood of the observed expansion coefficients , it will prove useful if the correlation matrix is as diagonal as possible , thus we impose the further condition that the expansion coefficients in this basis be statistically orthogonal , @xmath55 which implies that the basis functions that we seek solve the eigenvalue problem @xmath56 where the correlation matrix of the function @xmath44 has elements @xmath57 , the @xmath58 are the eigenvectors of this correlation matrix , and the eigenvalues are @xmath59 .",
    "expansion in the set of eigenvectors of the correlation matrix is the discrete form of the karhunen - love transform ( k - l hereafter ) .",
    "it is important to clarify the differences between statistically _ orthogonal _ , _ uncorrelated _ , and _",
    "independent_. statistical orthogonality is the condition stated in equation ( 9 ) .",
    "if @xmath39 has zero mean , then this same condition implies that the coefficients are also uncorrelated . for the coefficients to be statistically independent , we further require @xmath39 ( and therefore @xmath60 ) to be a gaussian random process",
    ". statistical orthogonality alone does not require @xmath39 to be a gaussian random process .",
    "here and throughout this paper , the operators @xmath61 denote the expectation value , or ensemble average , of a quantity . under the assumption that galaxy clustering is an ergodic process , the ensemble average is equivalent to a spatial average .",
    "in other words , @xmath62 is not only the expectation value of the density in our particular survey , but also the expectation value of the density at that position within an identically conducted survey in another patch of the universe .",
    "this equivalence is less trivial than it first appears : we are concerned not merely with uncertainty in the measured density at a particular point in space ( caused by , e.g. , poisson fluctuations in number density and measurement errors ) , but also with genuine correlated fluctuations about the cosmic mean .",
    "note that the number of eigenvectors corresponds to the number of pixels with which we divide the survey .",
    "if the cell size is comparable to , or smaller than , the average intergalaxy spacing , then using a finer mesh does not change or increase the number of eigenmodes that sample large - scale fluctuations ; we merely add very low signal to noise modes that are sensitive to small - scale pixel - to - pixel fluctuations and are dominated by shot noise . in section 3.1",
    "we discuss constraints on pixellating a galaxy survey for this analysis .",
    "the k - l transform is unique ; the eigenvectors of the correlation matrix form the only orthonormal basis set for which the transform coefficients @xmath60 are statistically orthogonal . to demonstrate this uniqueness property ( therrien 1992 ) , consider an arbitrary set of orthonormal vectors @xmath63 .",
    "the condition of statistical orthogonality is as above ( eq . [ 9 ] ) , @xmath64 where the @xmath65 are the expansion coefficients in the new basis .",
    "this condition may be rewritten as @xmath66 where @xmath67 .",
    "each of the @xmath68 must be orthogonal to every @xmath69 for @xmath70 and the @xmath69 are orthonormal , thus @xmath68 is simply some constant times @xmath71 , i.e. , @xmath72 so that @xmath71 is an eigenvector of @xmath73 , with eigenvalue @xmath74 . because this is true for all @xmath75 , the eigenvectors of the correlation matrix are the only set of @xmath71 that are statistically orthogonal .",
    "another unique property of the k - l transform is that it yields the most efficient representation of the data if we truncate the expansion to include fewer than @xmath40 modes . to demonstrate this property ,",
    "suppose that we expand the scalar field @xmath39 in the orthonormal basis @xmath53 , but that we truncate the expansion at @xmath76 basis functions , @xmath77 and define the error vector @xmath78 .",
    "the total power lost in the truncation is @xmath79 to minimize the lost power , we must therefore minimize @xmath80 subject to the orthonormality constraints . using the method of lagrange multipliers",
    ", we solve this problem by minimizing the lagrangian @xmath81 note that @xmath82 when the orthonormality condition of the @xmath83 is satisfied , and is minimized when @xmath84 where @xmath85 is the gradient with respect to changes in the basis vectors @xmath83 .",
    "again , we find that the @xmath83 must be eigenvectors of the correlation matrix , with eigenvalues @xmath86 .",
    "the optimal basis vectors for the truncated expansion are therefore the @xmath87 vectors @xmath83 with the largest eigenvalues @xmath88 .",
    "this efficiency property obtains for any number of modes , and therefore for a single mode , thus the first eigenmode yields an optimal estimator for the mean value of the observed field .",
    "if we form the eigenmodes from the covariance matrix ( we first subtract an estimate of the mean field at each point ) rather than the correlation matrix then , of course , we lose this estimator .",
    "if the noise in @xmath44 is white ( e.g. , shot noise ) and we divide the survey volume so that each cell has the same noise , then the efficiency property of the k - l transform implies that this transform also yields the maximum possible signal to noise per mode . as long as the signal and noise in @xmath39 are uncorrelated , the correlation matrix may be written as the sum of terms @xmath89 , which depend on the expected signal and noise , respectively . for constant noise per cell ,",
    "the noise correlation matrix is @xmath90 , the product of a scalar with the identity matrix .",
    "the k - l transform always diagonalizes @xmath73 , so in this case it also diagonalizes the signal correlation matrix @xmath91 , so that the signal and noise remain uncorrelated in the new basis .",
    "the noise power per mode , @xmath92 , is constant , thus sorting the eigenvalues @xmath93 is equivalent to sorting by signal - to - noise ratio ( throughout this paper we assume that the eigenvectors have been sorted in order of decreasing eigenvalue ) .",
    "this property of the k - l transform leads to bond s ( 1994 ) description of these functions as `` signal - to - noise eigenmodes . ''",
    "an important consequence of representing the signal with the smallest possible number of statistically orthogonal modes is that the likelihood function of the coefficients discriminates as strongly as possible between different clustering models ( see appendix a ) .",
    "the k - l transform retains its signal - to - noise optimization property for _ arbitrary _ pixellation if we first apply a whitening transformation to the binned measurements @xmath44 .",
    "because the pixellation may be driven by requirements other than optimizing the signal to noise , it is important to have a prescription for deriving the eigenmodes that does not depend on a particular division of space into cells .",
    "if the noise per cell varies , the noise matrix @xmath94 is not proportional to @xmath95 and a transformation that diagonalizes @xmath73 leaves the signal and noise correlated in the new basis . to ensure that this mixing does not occur ,",
    "we can either make a clever choice of pixellation ( as above ) or weight the cells to account for their varying noise properties .",
    "before we find the eigenvectors , we prewhiten ( diagonalize the noise component of ) the correlation matrix to form @xmath96 where the elements of the whitening transform @xmath97 are the square roots of the elements of @xmath98 and @xmath95 is the identity matrix .",
    "the complete k - l transform of @xmath99 is then @xmath100 where @xmath49 are the eigenvectors of @xmath101 .",
    "the whitening transformation rescales the data space to account for the differing noise per cell .",
    "expansion in the eigenvectors of @xmath101 is a rotation within the data space ( a unitary transformation ) that diagonalizes the signal .",
    "the whitening transform also gives us a procedure for generalization to more complex noise processes , in which the noise correlation matrix is not diagonal . in this case , the whitening transform not only rescales the data space , but also rotates within this space to diagonalize the noise matrix .",
    "the vectors @xmath102 are the solutions @xmath103 to the generalized eigenvalue problem @xmath104 and may be found either by direct solution of this equation or via the two step process above . in appendix",
    "a , we show that the transform @xmath105 is the optimal transform for testing clustering models for any data set .",
    "the eigenvectors that we derive on a mesh of pixels are merely approximations to the true continuous eigenmodes , which are continuous functions of position and are infinite in number . for our purposes , this approximation is sufficient when the scale of the cells is considerably smaller than the scale of the fluctuations that we wish to probe .",
    "to implement this estimation method on a computer , we must divide the survey volume into a finite number of cells .",
    "we specify the shape and volume of the cells , as well as how these vary with position within the survey volume .",
    "we try to make the cells as spherically symmetric as possible , to improve the accuracy of our approximate methods for computing @xmath106 ( see appendix b ) .",
    "if the pixels are too large , then we lose resolution because the binning smooths the galaxy distribution .",
    "available computing resources and one s patience set a practical upper limit to the number of cells .",
    "we suggest two scales to consider as useful lower bounds on the pixel size .",
    "one such scale is the galaxy correlation length , @xmath107mpc , because we are interested in studying fluctuations on much larger scales , which have yet to be accurately probed .",
    "the other scale of interest is the average intergalaxy spacing @xmath108 .",
    "although the best possible results obtain for nearly infinitesimal cells , there are diminishing returns when the number of cells exceeds the number of galaxies , because truly infinitesimal pixels admit eigenvectors with very low signal to noise at the cost of constructing and diagonalizing a larger correlation matrix .    at large distance , where the selection function drops rapidly , the appropriate cell volume quickly blows up ",
    "this is the point at which we should set the outer boundary for a magnitude - limited sample .",
    "a volume - limited sample has a fixed outer boundary  the maximum distance to which our sample is complete to the chosen absolute magnitude limit ( although uncertainty in the apparent magnitudes makes this boundary `` fuzzy '' ) .      we observe a set of galaxy counts @xmath109 in cells @xmath41 of a galaxy redshift survey , which form an observed data vector @xmath110 .",
    "to optimally represent the fluctuations in galaxy density , we expand these observation in the eigenmodes of @xmath111 . rather than subtract the mean density before we apply the k - l transform , we expand the non - zero mean @xmath110 in these eigenmodes .",
    "when we test clustering models , we subtract the expectation value of the k - l coefficients predicted by each model .",
    "thus reduced to a zero - mean process , all of the above results apply for the k - l expansion of the density fluctuations .",
    "the correlation matrix of galaxy density fluctuations in cells has elements ( see peebles 1980 for a derivation of moments of counts - in - cells ) @xmath112 where @xmath113 , @xmath114 for @xmath70 , @xmath115 is the correlation matrix for other sources of noise , and @xmath116 the three terms in equation ( 21 ) are the contributions from clustering of galaxies , shot noise , and extra variance due to , e.g. , magnitude errors or uncertainty in the luminosity function .",
    "the correlation function includes the redshift space distortions , @xmath117 , where @xmath118 is the projected separation , @xmath15 the line of sight separation , and r the distance of the pair of cells from the observer .",
    "the expected counts are @xmath119 we require knowledge of the geometry of the cells and the selection function for galaxies within the survey volume @xmath23 . number density or luminosity evolution of the galaxy population may be included in the function @xmath23 .    to compute the correlation function in redshift space ,",
    "we first compute the real - space correlation function by fourier transform of the real - space power spectrum , then apply a distortion to form the redshift - space correlation function at each position . by explicitly including the redshift distortions as part of the clustering model",
    ", we can simultaneously estimate both the real - space power spectrum and the strength of these distortions .",
    "we could also include a function multiplying @xmath120 that describes modulation of the clustering amplitude by , e.g. , luminosity dependence , clustering evolution , etc .    to compute the average value of the correlation function between cells ,",
    "we adopt either of two approximations , depending on the distance between two cells . for distant cells",
    ", we use an approximation based on expanding the correlation function in a taylor series and using the inertial moments of the cells .",
    "when the cells are close enough that this approximation is no longer valid , we compute the correlation term by monte carlo integration of the correlation function between the two volumes .",
    "we exploit symmetries in the survey geometry to compute the correlation term for the minimal number of unique relative positions of the cells .",
    "appendix b describes the taylor series approximation for computing @xmath106 in the case where we ignore the redshift - space anisotropy .",
    "however , the full power of the eigenmode method depends on accurate modelling of this distortion . we will describe a method for modelling the effects of this anisotropy and an approximation for computing @xmath106 ( without using the `` distant - observer '' approximation ) in a future paper in this series .    for the case where shot noise is the only source of noise , the noise correlation matrix has the simple form @xmath121 . to be complete",
    ", we should also take into account other sources of uncertainty in the observed counts including , for example , magnitude errors and uncertainty in corrections for galactic extinction .",
    "our procedure for constructing the eigenmodes optimally weights the data for varying signal to noise . in the case of correlated noise ,",
    "the noise correlation matrix is not diagonal , in which case the whitening transformation is particularly useful for isolating the uncorrelated set of observed counts .",
    "note that all these calculations implicitly assume a cosmological model and a local flow model to convert redshifts to comoving coordinates . to be consistent",
    ", we must use the same coordinate transformation at each step ( computing the distance to each galaxy , forming the eigenmodes , computing the k - l coefficients , forming the correlation matrix of coefficients for proposed models ) . because the calculation of comoving coordinate distances from redshifts depends on the assumption that the observer is at rest",
    ", we should correct the observed redshifts for our own peculiar motion .",
    "failure to correct to the proper reference frame can yield an erroneous anisotropy in the galaxy distribution , the so - called `` rocket effect '' ( kaiser 1987 ) . for a very shallow survey",
    ", we might want to work in the local group reference frame , and therefore only correct for our motion with respect to virgo .",
    "for much deeper surveys , it makes sense to work in the frame in which the cmb is isotropic .",
    "before we find the eigenvectors of the correlation matrix , we apply a whitening transformation , as described above in section 2.2 and in appendix a. if shot noise is the only source of noise , then the noise correlation matrix has elements @xmath122 , with inverse @xmath123 .",
    "the whitened correlation matrix @xmath124 has elements @xmath125n_j^{-1/2 } \\nonumber \\\\ & = & n_i^{1/2}n_j^{1/2 } \\xi_{ij } + \\delta_{ij}\\end{aligned}\\ ] ] note that we obtain an identical correlation matrix @xmath101 if we first weight each galaxy by the inverse of the selection function ( or any other _ a priori _ set of weights ) because this weighting is removed by the whitening transformation .",
    "we find the eigenvectors @xmath49 of the whitened correlation matrix , which yield the k - l transform of the data , with expansion coefficients @xmath126 .",
    "the eigenvalues @xmath93 are the expectation value of the square of the coefficients @xmath127 .",
    "the elements @xmath128 of the eigenvectors multiplied by the whitening transformation @xmath97 , specify the weight given to the @xmath42 cell for the @xmath129 eigenmode . if shot noise is the only source of uncertainty , then @xmath130 . from these weights per cell",
    "we can form the continuous function of position , @xmath131 for @xmath132 , that obeys the orthonormality condition , @xmath133    we use the first slice of the cfa2 redshift survey ( de lapparent , geller , & huchra 1986 ) to illustrate our methods .",
    "this survey slice covers the region @xmath134 , @xmath135 , and we restrict our example to @xmath136 .",
    "we divide the slice into a single layer of @xmath137 pixels ( slightly more pixels than galaxies ) in spherical coordinates and compute the correlation matrix of expected galaxy counts ( not the observed counts ) in this apparent - magnitude limited sample using the selection function of this survey and assuming the power spectrum measured from the full cfa2 survey ( park et al .",
    "we then find the eigenmodes by whitening this correlation matrix and finding its eigenvectors , as described above .",
    "for the test case of the cfa2 slice that we describe , we use the jacobi transform method to compute the eigenvectors and eigenvalues , as described in press et al .",
    "a more reliable ( slower , but safer ) method is singular value decomposition .",
    "standard linear algebra packages ( e.g. , lapack  anderson et al .",
    "1995 ) include a number of routines for finding the eigenvectors and eigenvalues of a real , symmetric matrix , as is the case for the correlation matrices .",
    "figure 1 shows the most significant ( largest eigenvalue ) 12 eigenmodes .",
    "we plot the discrete approximation to the continuous eigenfunctions , @xmath138 , as in equation ( 25 ) .",
    "these modes resemble dipole , quadrapole , etc . , moments of the galaxy distribution in the slice . because these are eigenmodes of the magnitude - limited galaxy counts ,",
    "the amplitude of each mode varies with depth so that it is most sensitive to fluctuations near the peak of the expected redshift distribution ( @xmath139 peaks near 55@xmath140mpc and approaches zero sensitivity beyond @xmath141mpc .",
    "figure 2a shows the familiar distribution of galaxies in the cfa2 slice , but we bin the galaxies into pixels rather than show the galaxy positions themselves .",
    "figure 2b illustrates the optimal representation property of the k - l transform ; here we reconstruct the galaxy counts using only the first 500 eigenmodes of the survey , yet all the salient features are reproduced . the error image ( fig .",
    "2c ) shows the difference between the true and truncated distribution , which is formed by the remaining 725 eigenmodes , all of which have signal - to - noise of less than unity .",
    "figure 3 shows the expectation value of the `` power spectrum '' of the k - l expansion for the cfa2 slice , in analogy to the familiar power per mode of the fourier expansion .",
    "when we expand the observations @xmath110 in the fluctuation eigenmodes , the expectation value of the total power per mode is the eigenvalue for that mode plus a contribution from the mean density .",
    "the total power per mode has components from the clustering signal , noise , and mean density ( where the primes denote the whitened quantities ) , @xmath142 where @xmath143 is the whitened vector of cell counts , @xmath144 , and using the separation of the whitened correlation matrix into the sum of matrices , @xmath145 .",
    "if shot noise is the only source of noise in the counts ( @xmath121 ) , then these matrices have the simple forms @xmath146",
    "the contribution to the power per mode from the mean density is @xmath147 in the last line we take the limits @xmath148 and @xmath149 , and @xmath138 is defined in equation ( 25 ) .",
    "the power term @xmath150 quantifies the relative sensitivity of each mode to the mean ; if the eigenmode fluctuates around zero , then this integral vanishes . to eliminate any dependence on the mean density",
    ", we could exclude from our analysis those few modes which do carry this information .",
    "the variance of @xmath60 is the sum of the clustering and shot noise power , @xmath151 by construction , the noise power per mode is constant , @xmath152    the clustering power per mode is @xmath153 where we define the function @xmath154 the function @xmath155 has fourier transform @xmath156 , which is the convolution of the fourier transform of the eigenmode with the fourier transform of the square root of the selection function for the survey .",
    "the last line in equation ( 32 ) follows by subsituting in the fourier transform relation @xmath157 this fourier transform relation does not hold exactly in redshift space , because peculiar velocities couple real - space fourier modes with different wavelength ( zaroubi & hoffman 1994 ) .",
    "therefore , this substitution is only approximately correct , but serves to illustrate how each k - l mode is a spatial filter that samples power from the range of wavenumber described by its fourier window @xmath158 .",
    "the clustering signal per mode is the integral of the product ( not the convolution ) of this window with the power spectrum .",
    "figure 4 plots the two - dimensional fourier windows , @xmath159 , of the eigenmodes that are shown in figure 1 , sampling only wavevectors in a plane close to the slice ( we use a two - dimensional fourier transform for this example because the cfa2 slice is narrow in the declination direction , and therefore contains little information in the direction normal to the slice ) . in figure 5",
    "we plot the passbands in the fourier domain for these same eigenmodes .",
    "these passbands are the fourier window functions averaged over all directions @xmath30 .",
    "as we increase the volume covered by a survey , the fourier windows of its eigenmodes narrow and we probe the fluctuations with increasing resolution . in the limit of an infinite volume , these windows approach delta functions , and the k - l eigenmodes become identical to the plane waves of the fourier expansion , modulated by weighting to account for the variation with distance of the selection function .",
    "because the spatial window function of a galaxy survey typically has sharp angular limits , the fourier windows of its eigenmodes can have sidelobes due to `` ringing '' at the survey boundary .",
    "it is tempting to design and apply a filter that smooths these edges ( applied as a set of weights to the galaxies ) and thereby remove this ringing .",
    "however , one does so at the cost of throwing away signal near the survey boundaries . for the purpose of model testing ,",
    "as described in the next section , such a smoothing reduces the statistical power of the data ; the k - l expansion is a complete basis and every mode is weighted in the likelihood function by its signal to noise ratio .",
    "appendix a shows that the k - l expansion is an optimal basis for testing the likelihood of clustering models .",
    "if we weight the data _ a priori _ , then we can only decrease the discriminatory power of this statistic .",
    "the k - l transform addresses the question of how to weight data in different regions to yield an optimal estimator for very large wavelength fluctuations and therefore is particularly useful for probing large - scale clustering using surveys with very complex geometry .",
    "sensitivity to very large - scale density fluctuations is limited by the total volume sampled which , for a survey comprised of disjoint subregions , is the effective volume of the  meta - survey , \" not that of an individual sub - region .",
    "a limiting case is when the survey is a sum of delta functions centered on randomly selected galaxies ( this is the sparse sampling strategy espoused by kaiser 1986 ) .",
    "surveys conducted with multifiber spectrographs typically populate the survey volume with an ensemble of pencil beams or slices . elsewhere",
    "( szalay et al . 1993 ; vogeley 1995 ) we examine how the fourier window function of such a survey depends on the window functions of the individual subregions as well as their combination .",
    "individually , each of the subregions probes the fluctuation spectrum with its own very broad window function ( the volume is narrow , thus the window function is broad ) , and this `` auto - correlation '' provides a poor estimate of large - scale clustering ( in the sparse - sampling limit , the auto - correlations are pure shot noise , with equal power at all wavenumbers ) . the window function for clustering power that arises from the contrast in density between disjoint regions is significantly narrower , lacking the sidelobes of the individual regions geometries , and thus provides a cleaner probe of large - scale power .",
    "one suggestion is to examine only this `` cross - correlation '' part of the observed fluctuations .",
    "such a power spectrum estimate is less than optimal because it does not use any of the fluctuation signal within each subregion , and is statistically more complex because the cross - correlation component is not positive definite .    in the k - l transform ,",
    "the auto - correlation power and cross - correlation power are both represented by the eigenmodes . in this way",
    "we obtain the best possible resolution ( from the cross - correlation modes ) without sacrificing statistical power ( because the auto - correlation modes still contribute to the likelihood ) . in figure 6",
    "we display several of the eigenmodes for a survey comprised of narrow beams within the limits of the cfa2 slice .",
    "comparison with the eigenmodes of the full slice ( fig .",
    "1 ) shows that the modes of the partial survey sample the large - scale fluctuations ( compare modes 1 - 6 in fig .",
    "6 with modes 1 , 2 , 4 , 7 , 3 , and 5 respectively , in fig .",
    "1 ) , as well as the fluctuations within the individual beams .",
    "after we derive the k - l eigenmodes and apply this transform to the observations , the next step is to use the observed k - l coefficients to test cosmological models .",
    "we test these models predictions of the mean and second moments ( e.g. , the power spectrum ) of the galaxy density field , which are sufficient to predict the mean and covariance matrix of the k - l coefficients . to find the best fit model and the corresponding confidence region of model parameters , we apply bayesian methods to compute the posterior probability that a model would yield the observed expansion coefficients .",
    "this probability is proportional to the likelihood of the observed set of coefficients , using the covariance matrix for each model .",
    "this approach contrasts with standard methods for power spectrum estimation , in which one averages the power per mode in bins of wavenumber , and tests the likelihood of the observed power using the covariance matrix of the power that the model predicts .",
    "our use of prior knowledge of the selection function of the survey and the noise and clustering properties of the galaxy density field gives a bayesian flavor to our method for finding the eigenmodes of the survey .",
    "we continue in this spirit and follow bayesian methods to find the model most likely to have yielded the data set that we observed . in this section",
    "we outline the procedure for estimating the posterior probability of a model , with particular attention to how use of the k - l transform simplifies many of the necessary steps and how a bayesian approach increases the discriminatory power of the statistics . though our particular interest is in estimating the power spectrum , we describe how to simultaneously estimate the mean density , power spectrum of density fluctuations , and redshift distortion parameters from the observations .",
    "it might seem that the model assumed for construction of the k - l eigenmodes would prejudice the likelihood analysis of other models .",
    "this is not the case ; the k - l eigenmodes are a complete orthonormal basis regardless of the assumed power spectrum .",
    "we allow the mean density to vary as a parameter of the models , so that the choice of mean does not bias the estimate of large wavelength fluctuations .",
    "however , a bad initial `` guess '' makes the subsequent analysis slightly more difficult because , although the k - l modes would still be orthonormal , they would not quite be statistically orthogonal .",
    "changing @xmath26 changes the expected signal to noise in a pixel , thus the weighting for probing a given range of wavelength scales will not be optimal .",
    "therefore , a bad initial guess at @xmath26 causes covariance and less than optimal signal to noise of the eigenmodes , which broaden the confidence regions , but does not change the peak of the likelihood function . if our initial guess turns out to be particularly bad , we can iterate the estimation procedure by using the best fit model to construct better eigenmodes .    to test proposed models",
    "we employ bayes theorem to compute the posterior probability of a set of model parameters ( for an excellent review of application of bayesian methods to astronomical problems , see loredo 1990 and references therein ) .",
    "given a set of observations @xmath160 and additional ( _ prior _ ) information @xmath161 , the posterior probability of a model that is specified by the parameters @xmath162 is @xmath163 the first factor is the bayesian _ prior _ , which encodes our other information ( i.e. , apart from the new data ) about the probability of this model being correct .",
    "the likelihood function ( as we usually think of it ) enters into @xmath164 .",
    "the denominator is essentially a normalization constant , determined by requiring that the posterior probability integrate to unity over the entire parameter space of possible models .    in our case ,",
    "the observations @xmath160 are the observed galaxy counts , represented by the k - l coefficients , and the model parameters @xmath162 describe the expectation value and second moments of the galaxy density in redshift space .",
    "these parameters may include the mean density of galaxies , the selection function for the survey , the power spectrum of galaxy density fluctuations , and the parameters that describe the distortion of redshift space due to peculiar velocities .",
    "the prior information @xmath161 might include , e.g. , estimates of the mean density , @xmath165 , or the power spectrum , obtained from other surveys or methods , as well as obvious constraints such as @xmath166 and @xmath167 .      the prior distribution @xmath168 describes the probability distribution of the model parameters in the absence of the new data @xmath160 . by adopting an _ informative _ prior probability for the parameters , we narrow the confidence region of the posterior probability for the model , yielding better constraints on the parameters of interest .",
    "an example is the mean galaxy density : most often , we estimate the mean density from the data themselves , but this estimate may differ from the cosmic mean due to shot noise and clustering of galaxies on the scale of the survey volume . rather than choose a single best value for the mean density and risk underestimating the power spectrum on large scales ( see section 1.3 for a discussion of this problem ) , we can include both the mean density and the power spectrum as parameters of the model and simultaneously fit for both . a prior probability distribution that describes the most likely value for the mean galaxy density and its uncertainty will narrow the range of acceptable power spectra .",
    "another example is redshift distortions : they alter the shape of the power spectrum in such a way that it may be difficult to differentiate between a model that has a great deal of power on large scales in real space , but low @xmath169 and thus small redshift distortions , and a model with intrinsically moderate large - scale power but which has large streaming velocities .",
    "if we know , from other observations , that @xmath170 and that the uncertainty is normally distributed , then we can include this probability distribution in the prior to better constrain the real - space power spectrum .",
    "of course , we always have the option to ignore everything else that we know about the universe and adopt a uniform prior , i.e. , equal prior probability for all values of a parameter ( or almost all  for example , we still want to constrain @xmath171 and @xmath167 ) .",
    "note that these bayesian priors differ from the ` prior model ' that we used to construct the eigenmodes , though we would be wise to construct the eigenmodes using model parameters that we deem _ a priori _ most likely .",
    "the second factor in the posterior probability of a particular model ( eq . [ 35 ] ) is the _ likelihood _ that these data deviate from their expectation values as widely as observed .",
    "we observe the counts @xmath110 , whiten these observations with @xmath97 , and expand the whitened counts in the eigenvectors @xmath49 to obtain the k - l coefficients @xmath47 .",
    "each model predicts the mean @xmath172 and covariance matrix @xmath173 of these coefficients .",
    "the covariance matrix @xmath173 has elements @xmath174 where we compute @xmath175 by substituting the model s selection function , power spectrum , etc .",
    ", into equation ( 21 ) .    the quadratic form @xmath176 measures the goodness of fit of the model",
    ". for the set of model parameters used to derive the eigenmodes , @xmath177 , where @xmath88 is the eigenvalue of the @xmath42 mode . in this case , @xmath178 is simply the number of degrees of freedom , i.e. , the number of eigenmodes . in general , because the model under consideration differs from the model used to construct the eigenmodes , @xmath173 will not be diagonal because the eigenmodes of the prior model are not exactly statistically orthogonal under the hypothesis being tested .",
    "although repeated inversion of @xmath173 would seem to be computationally intensive , in practice the models that we will test differ most greatly on large wavelength scales ( where our current knowledge is most uncertain ) , in which case the off - diagonal elements of @xmath173 would be isolated in one corner of the matrix and so these matrices should quickly diagonalize to within machine precision .    to compute the probability @xmath179 for a specific model we must specify the probability distribution of @xmath178 .",
    "if the observed density field and therefore the probability distribution of the k - l coefficients is gaussian , then the likelihood function of the data is a multivariate gaussian , @xmath180 where @xmath40 is the number of eigenmodes included in @xmath178 .",
    "why does @xmath161 appear in @xmath179 ?",
    "one reason is that we make certain assumptions that apply to the models in consideration .",
    "for example , we think it reasonable to use a gaussian likelihood function to probe large wavelength scales only because some previous observations and prevailing theoretical prejudice tell us that the distribution of matter on large wavelength scales is nearly gaussian .",
    "such a separation of linear and non - linear scales is possible because the k - l eigenmodes isolate the statistically independent bands of power on different scales .",
    "it is important to remember that such an assumption implicitly sets the family of models that we test .",
    "a more accurate computation of the likelihood , and one that would allow inclusion of modes that sample smaller wavelength scales , would use a non - gaussian likelihood function . amendola ( 1994 ) describes how to construct such a function using the edgeworth expansion , where the observed higher order clustering properties are used to compute the broadening of the probability distribution of @xmath178 due to non - linear clustering of galaxies .",
    "of course , such an extension to non - linear scales requires prediction of these higher order moments for the model in question .      to find the confidence region of likely model parameters , we employ equation ( 35 ) to compute the posterior probability for models that span the available parameter space , locate contours of constant posterior probability , and then integrate the probability within the contours .",
    "the integral of probability density within these contours yields the bayesian confidence regions .",
    "the assignment of absolute probability to a model , as opposed to the relative likelihood of different models , requires that we know the denominator @xmath181 of equation ( 35 ) , or that the tested parameters space includes all possible models , in which case we determine this normalization by integrating the posterior probability over the entire parameter space .",
    "bayesian and frequentist methods of analysis differ in their interpretation of confidence regions . in the bayesian view ,",
    "the confidence region that we obtain is the region of parameter space in which the models have the same posterior probability given the observed data and prior information .",
    "in contrast , the confidence region obtained in a frequentist analysis describes the distribution of estimated parameters that we could expect to measure for a population of similar data sets , if the true parameters are those which best fit the observed data .    to determine the probability density of some subset of the model parameters , we can marginalize ( integrate eq . [ 35 ] ) over the distribution of all other parameters . for example , to find the most likely power spectrum parameters , we could marginalize over the distribution of the mean density , or vice versa .",
    "at this point we can assess whether the model used to construct the eigenmodes was a good initial guess , by examining where this prior model lies in the confidence region of tested models .",
    "often the first result that we desire from a power spectrum analysis is a plot of the estimated power spectrum and error bars at several wavenumbers .",
    "we can produce such a plot if we apply the methods above to test a model in which the power spectrum parameters are simply the average power in bins of @xmath182 .",
    "the most likely value and 68% confidence region of the marginal distribution of the power in each bin of wavenumber yield the quantities that we want to plot .",
    "very wide bins will yield small uncertainty in the power per bin , because many eigenmodes contribute to the total power , but poor resolution of features in the power spectrum .",
    "narrower bins would better show such features , but the uncertainty in power per bin would be correspondingly larger .",
    "a problem with such plots is that they do not communicate the covariance of power estimates in different bins .",
    "only when the bins of wavenumber are wide compared to the fourier windows of the k - l eigenmodes can we approximate the power in different bins as being independent .",
    "the tradeoff between resolution and uncertainty that one faces in producing such a plot ( cf .",
    "tegmark 1995 for discussion of the ambiguity between `` vertical '' and `` horizontal '' error bars on the power spectrum ) is , however , one of graphical semantics rather than science .",
    "formal testing of proposed models should use the full likelihood function of the observed coefficients rather than `` chi - by - eye '' comparisons of the estimated power spectrum and uncertainties with different model power spectra .",
    "the k - l modes are the narrowest possible statistically orthogonal linear combinations of the fourier modes",
    ". a larger number of spatial filters would not be independent ; a lesser number would cause loss of statistical power and resolution . following the bayesian method that we advocate ,",
    "no binning is required and the modes with large signal to noise naturally receive higher weights in the likelihood function .",
    "the tradeoff between resolution and uncertainty enters when we select the models that we test ( number of parameters in the @xmath26 model ) rather than in binning the power estimates .",
    "another problem with `` model independent '' plots of the power spectrum is that , as we note in section 3.2 , we require specification of a cosmological model in order to compute comoving coordinate distances from the observed redshifts .",
    "in this paper we describe a transform method for analyzing galaxy redshift surveys that allows estimation of the mean density , power spectrum , and redshift - space distortions , and which may prove useful for other purposes in characterizing other properties of the observed large - scale structure . in summary ,",
    "the basic steps in this analysis are :    * divide the survey volume into cells .",
    "* select a prior model and compute the correlation matrix of the galaxy density fluctuations predicted by this model . *",
    "find the eigenvectors and eigenvalues of the correlation matrix , after applying a whitening transformation .",
    "* bin the observed galaxy counts into cells and compute the k - l transform of these observations .",
    "* select the cosmological models to be tested and the prior information to be included in the model testing . *",
    "compute the posterior probability for a range of values of the model parameters and find the confidence regions of these parameters . * if necessary , use the best fit model to construct a more optimal set of eigenmodes and iterate .      because we use the k - l transform rather than the fourier transform to decompose the observations , and work with the probabilities of the coefficients themselves rather than the power per mode , we gain several advantages over the standard method described in the introduction .",
    "the k - l modes are , by construction , statistically orthogonal , thus we begin the likelihood analysis with exactly the required number of probes of clustering power ( one could find the linear combinations of fourier modes that are statistically orthogonal , but such a procedure is just another route to the k - l eigenmodes , where the eigenvectors are a set of weights applied to the fourier modes rather than to the observed cell counts , and would require the additional step of first computing the fourier transform of the data ) . by testing the likelihood of the observed k - l coefficients rather than the probability distribution of the power per mode ,",
    "we require lower order assumptions about the probability distribution of the galaxy density .",
    "we treat the mean density as just another parameter of the model being tested and simultaneously fit both the mean density and power spectrum , thereby differentiating between the case in which the observed mean density is equivalent to the cosmic mean , and the case where the observed mean differs from the cosmic mean due to density fluctuations on the scale of the survey .",
    "the bayesian approach provides a clear method for better constraining the confidence region of power spectrum parameters by inclusion of prior knowledge of the mean density in the calculation of the posterior probability of a model .    as appendix a demonstrates",
    ", the k - l transform method yields the optimal weighting for testing the likelihood of clustering models .",
    "this is a more general result than previous derivations of minimum variance weighting ( e.g. , fkp ) , which find the optimal weighting for fourier analysis under specific idealized conditions .",
    "tailoring of the weighting scheme to obtain better resolution in the power spectrum estimator ( tegmark 1995 ) achieves this improvement at the expense of statistical power to differentiate between clustering models .",
    "the k - l expansion is the optimal basis set if we truncate the expansion to the subset of modes with highest signal to noise , and therefore may be considered a form of principal component analysis ( pca ) or factor analysis .",
    "pca more commonly ( but not exclusively ) describes the case in which we reduce a set of observed variables to a smaller number of linear combinations which completely describe the observations .",
    "factor analysis seeks a lower - dimensional representation that describes all of the correlations among the data . because there is non - zero clustering power on all scales ,",
    "all of the k - l eigenmodes are required to provide a complete representation of the observed galaxy density field .",
    "because the k - l eigenmodes are eigenvectors of the correlation matrix , they differ from basis functions that , although orthonormal , are not statistically orthogonal .",
    "we show that this representation of the redshift - space density field is optimal for testing models for the power spectrum for any survey .",
    "other transform methods offer advantages for other analyses .",
    "for example , fisher et al .",
    "( 1994 ) expand the observed redshift - space density field in spherical bessel functions and spherical harmonics ( fourier - bessel expansion ) in order to reconstruct the real - space density , velocity field , and potential via a wiener filtering method .",
    "similarly , heavens & taylor ( 1995 ) advocate use of this same representation for estimating the redshift - space anisotropy of galaxy clustering .",
    "the fourier - bessel expansion simplifies computation of the effect of redshift distortions on the galaxy density field because these are eigenfunctions of the laplacian in poisson s equation , which describe redshift distortions in linear theory .",
    "for an all - sky survey , redshift space distortions only couple different radial modes , thus the transformation from real to redshift space is straightforward .",
    "the advantages of this approach are lost , however , if there are large gaps in the sky coverage of the survey , which destroy the orthonormality of the spherical harmonics .",
    "the requirement that one truncate the expansion to a finite number of modes is analogous to our division of space into a finite number of pixels .",
    "these functions are not statistically orthogonal , thus model testing using this expansion requires inversion of generally very non - diagonal matrices .    in parallel with the development of alternative means of power spectrum estimation from galaxy surveys ,",
    "various transform methods have also been developed for estimating the power spectrum at recombination from the cobe dmr maps .",
    "analysis of the cmb anisotropy faces many of the problems posed by analysis of the redshift - space galaxy distribution , with the simplifications that the mean is extremely well determined , redshift distortions ( apart from our own dipole motion with respect to the cmb ) play no role , the window function on the sky is relatively simple , the fluctuations are gaussian ( in nearly all theories under consideration ) , and the noise per pixel is almost constant and nearly uncorrelated .",
    "the `` signal - to - noise eigenmodes '' derived by bond ( 1994 ) for analysis of the cobe dmr maps are constructed in similar fashion to the eigenmodes of the galaxy redshift distribution that we describe in this paper .",
    "both methods apply the karhunen - love transform to represent the observations . in the case of the cobe dmr analysis",
    ", one uses an assumed model for the power spectrum at recombination , as well as the correlation matrix of the pixel - pixel noise ( in this case the noise correlation matrix depends on the instrument , in contrast to the dependence on the sampling density of galaxies ) , to construct a complete orthonormal basis in which both the signal and noise correlation matrices of the expansion coefficients are diagonal .",
    "expansion of the pixel maps in this basis allows straightforward bayesian model testing . because the modes are ordered by signal to noise ratio , this basis set is also optimal for wiener filtering of the pixel maps .",
    "an example of a model independent method ( in the sense of requiring no _ a priori _ clustering model ) is that of grski ( 1994 ) , who derives a set of functions that , unlike the spherical harmonics , are orthonormal over the cut sky ( the areal region left after removing areas close to the galactic plane ) of the cobe dmr maps .",
    "this procedure for gram - schmidt orthogonalization yields linear combinations of spherical harmonics that are both orthonormal and that are as compact as possible in the spherical harmonic function space . after removing the monopole and dipole contributions ( which , unlike the case of galaxy observations , are sufficiently well determined to justify their removal ) , bayesian analysis of the expansion coefficients yields estimates of the power spectrum parameters .",
    "neither the noise nor the signal correlation matrices are diagonalized by this transformation . as we see above , such a diagonalization requires assumption of a prior model to form the eigenmodes , which this method seeks to avoid .",
    "the k - l eigenmodes form a complete basis for representing the observations , with no loss of phase information , and thus may be useful for analyses other than power spectrum estimation .",
    "one such application is smoothing of the density field by removal or suppression of modes that sample short wavelength scales .",
    "this form of smoothing could be used for studies of the morphology and topology of large - scale structure and for identification of superclusters in sparse data .",
    "another application is optimal reconstruction of the galaxy density field , facilitated by the signal to noise properties of the eigenmodes ( cf .",
    "bond 1994 and fisher et al .",
    "1994 regarding wiener filtering for reconstruction of the cmb anisotropy and the galaxy density field , respectively ) .",
    "when applied to spectroscopic observations of galaxies , the k - l transform yields an elegant means of spectral classification ( connolly et al .",
    "1995 ) .",
    "this paper is the first in a series in which we apply eigenmode analysis to a variety of data sets .",
    "these include the pencil beam redshift surveys , early redshift observations from the sloan digital sky survey , and the spatial distribution of quasar absorption line systems . for future surveys",
    "( including planning for the sdss ) , we can design the optimal geometry and sampling for the available survey resources , using the k - l transform as a method for estimation of the uncertainty in @xmath26 for an arbitrary survey .",
    "ultimately , we hope to use this transform method to combine all of the available galaxy redshift data and thereby obtain the best possible measurement of the power spectrum of galaxy density fluctuations .",
    "we thank the referee , john peacock , for helpful comments on the text .",
    "we acknowledge support from nsf grant ast-9020380 and the seaver foundation .",
    "partial support for this work was also provided by nasa through grant number ar-05813.01 - 94a from the space telescope science institute , which is operated by the association of universities for research in astronomy , inc .",
    ", under nasa contract nas5 - 26555 .",
    "amendola , l. 1994 , fermilab preprint pub-94/263-a anderson , e. , et al .",
    "1995 , lapack user s guide ( philadelphia : society of industrial and applied mathematics ) baumgart , d. j. & fry , j. n. 1991 , , 375 , 25 bond , j. r. 1994 , in relativistic cosmology , ed .",
    "m. sasaki , ( academic press ) , proc .",
    "8th nishinomiya - yukawa memorial symposium broadhurst , t. j. , ellis , r. s. , koo , d. c. , & szalay , a. s. 1990 , nature , 343 , 726 broadhurst , t. j. , szalay , a. s. , ellis , r. s. , ellman , n. , & koo , d. c. 1995 in wide - field spectroscopy and the distant universe , proc . of 35th herstmonceux conference , eds .",
    "s. j. maddox & a. aragn - salamanca , p. 178 cole , s. , fisher , k. b. , & weinberg , d. h. 1993 , , 267 , 785 connolly , a. j. , szalay , a. s. , bershady , m. a. , kinney , a. l. , & calzetti , d. 1995 , , 110 , 1071 da costa , l. n. , vogeley , m. s. , geller , m. j. , huchra , j. p. , & park , c. 1994 , , 437 , l1 de lapparent , v. , geller , m. j. , & huchra , j. p. 1986",
    ", , 301 , l1 feldman , h.a . , kaiser , n. , & peacock , j. a. 1994 , , 426 , 23 ( fkp ) fisher , k. b. , davis , m. , strauss , m. a. , yahil , a. , & huchra , j. p. 1993",
    ", , 402 , 42 fisher , k. b. , lahav , o. , hoffman , y. , lynden - bell , d. , & zaroubi , s. 1995 , , 272 , 885 geller , m. j. , kurtz , m. j. , huchra , j. p. , fabricant , d. g. , thorstensen , j. r. , & wegner , g. 1995 , in preparation grski , k. m. 1994 , , 430 , l85 hamilton , a. j. s. 1992 , , 385 , l5 hamilton , a. j. s. 1993 , , 417 , 19 heavens , a. f. & taylor , a. n. 1995 , , in press kaiser , n. 1986 , , 219 , 785 kaiser , n. 1987 , , 227 , 1 kofman , l. , gnedin , n. , & bahcall , n. a. 1993 , , 413 , 1 landy , s. d. , & szalay , a. s. 1993 , , 412 , 64 loredo , t. j. 1990 , in maximum entropy and bayesian methods , ed .",
    "p. f. fougre ( dordrecht : kluwer ) , p. 81",
    "lin , h. , kirshner , r. p. , shectman , s. a. , landy , s. d. , oemler , a. , tucker , d. l. , & schechter , p. l. 1995 , , in preparation malaney , r. a. , starkman , g. d. , & widrow , l. 1995 , preprint astro - ph/9504014 park , c. , vogeley , m. s. , geller , m. j. , & huchra , j. p. 1994 , , 431 , 569 park , c. , gott , j. r. , & da costa , l. n. 1992 , , 392 , l51 peacock , j. a. , & dodds , s. j. 1994 , , 267 , 1020 peacock , j. a. , & nicholson , d. 1991 , , 253 , 307 peebles , p. j. e. 1980 , the large - scale structure of the universe ( princeton : princeton univ . press ) poor , h. v. 1994 , an introduction to signal detection and estimation ( new york : springer - verlag ) press , w. h. , flannery , b. p. , teukolsky , s. a. , & vetterling , w. t. 1986 , numerical recipes ( cambridge : cambridge univ . press ) primack , j. r. , holtzman , j. , klypin , a. , & caldwell , d. o. 1995 , , 74 , 2160 regs , e. , & szalay , a. s. 1995 , , 272 , 447 shectman , s. a. , landy , s. d. , oemler , a. , tucker , d. l. , kirshner , r. p. , lin , h. , & schechter , p. l. 1995 , in wide - field spectroscopy and the distant universe , proc . of 35th herstmonceux conference , eds .",
    "s. j. maddox & a. aragn - salamanca , p. 98",
    "stompor , r. , grski , k. m. , & banday , a. j. 1995 , , in press strauss , m. a. , cen , r. , ostriker , j. p. , lauer , t. r. , & postman , m. 1995 , , 444 , 507 szalay , a. s. , broadhurst , t. j. , ellman , n. , koo , d. c. , & ellis , r. s. 1993 , proc . natl . acad .",
    ", 90 , 4853 tegmark , m. 1995 , , 455 , 429 therrien , c. w. 1992 , discrete random signals and statistical signal processing ( englewood cliffs : prentice - hall ) vettolani , g , et al .",
    "1995 , in wide - field spectroscopy and the distant universe , proc . of 35th herstmonceux conference , eds .",
    "s. j. maddox & a. aragn - salamanca , p. 115 vogeley , m. s. , park , c. , geller , m. j. , & huchra , j. p. 1992",
    ", , 391 , l5 vogeley , m. s. 1995 , in wide - field spectroscopy and the distant universe , proc . of 35th herstmonceux conference , eds .",
    "s. j. maddox & a. aragn - salamanca , p. 142 zaroubi , s. , & hoffman , y. 1996 , , in press",
    "to most strongly differentiate among clustering models , we want the volume of the confidence region of the parameter estimates to be as small as possible . in other words ,",
    "we want the likelihood function @xmath183 to be sharply peaked at the true model .",
    "we accomplish this by expanding the observations @xmath110 in a set of basis functions for which the likelihood of the coefficients @xmath47 decreases as steeply as possible as we perturb the clustering model from the best fit model .",
    "the maximum likelihood estimate of the model parameters @xmath162 occurs when the gradient of the likelihood function ( otherwise known as the score function ) is set to zero . here",
    "we assume a gaussian likelihood function , @xmath184 \\\\ & = & ( 2\\pi)^{-1/2 } ( \\det \\cbf)^{-1/2 } \\exp\\left [ -\\trace(\\cbf^{-1}\\zbf)\\right],\\end{aligned}\\ ] ] where @xmath47 are the expansion coefficients in some basis @xmath53 , @xmath185 is the covariance matrix of these coefficients , and @xmath186 is the sample covariance matrix @xmath187 the maximum of @xmath188 is also the minimum of @xmath189 , so we evaluate the derivative of the log - likelihood function with respect to the one of the model parameters @xmath190 : @xmath191 - \\trace \\left [ \\abf\\cbf^{-1}\\zbf \\right ]   + \\trace \\left [ \\cbf^{-1 } { \\partial \\zbf \\over \\partial \\theta_i}\\right],\\nonumber\\end{aligned}\\ ] ] where we define @xmath192 setting this derivative ( eq . [ a4 ] ) to zero we obtain the maximum likelihood estimate of @xmath162 .",
    "the optimal basis functions are those which yield the narrowest confidence region around the best fit model @xmath193 .",
    "the volume of the confidence region depends on the fisher information matrix , or second gradient of the log - likelihood function , which measures how steeply the likelihood falls as we move away from the best fit model , evaluated at the position of the best fit model .",
    "the second derivatives of the log - likelihood function are @xmath194 - \\trace \\left [ { \\partial \\abf_j \\over \\partial \\theta_i } \\cbf^{-1}\\zbf \\right ] + \\trace \\left [ \\abf_j \\abf_i \\cbf^{-1}\\zbf \\right ] \\\\ & - & \\trace \\left [ \\abf_j\\cbf^{-1 } { \\partial \\zbf \\over \\partial\\theta_i } \\right ] - \\trace\\left [ \\abf_i \\cbf^{-1 } { \\partial \\zbf \\over\\partial\\theta_j } \\right ] + \\trace\\left[\\cbf^{-1}{\\partial^2 \\zbf \\over \\partial \\theta_i \\partial \\theta_j } \\right ] .",
    "\\nonumber\\end{aligned}\\ ] ] to evaluate the derivatives , we need the expectation value of the sample covariance matrix and its derivatives : @xmath195 using these identities we obtain @xmath196 + 2{\\partial \\langle\\bbf\\rangle^t \\over \\partial\\theta_i } \\cbf^{-1 } { \\partial \\langle\\bbf\\rangle^t \\over \\partial\\theta_j}.\\ ] ]    to optimize the basis functions for sensitivity to the clustering model , let us assume that we know the true mean density , thus @xmath197\\\\ = \\trace\\left [ \\cbf^{-1 } { \\partial\\cbf \\over \\partial \\theta_i } \\cbf^{-1}{\\partial \\cbf \\over \\partial\\theta_j } \\right].\\ ] ] the covariance matrix is the sum of signal and noise components @xmath198 where @xmath91 and @xmath94 are the signal and noise correlation matrices of the observations .",
    "if we perturb the clustering model from its best fit value @xmath199 , we vary the signal correlation matrix as @xmath200 where @xmath201 is the matrix describing the pertubation .",
    "we want to minimize the second gradient of the likelihood with respect to this pertubation , or maximize @xmath202.\\ ] ] the argument of @xmath203 $ ] is the product of two identical symmetric matrices , thus the maximum of equation ( a14 ) is also the maximum of @xmath204^{-1 } { \\partial \\over \\partial { \\bf p } } \\pbf^{\\dag}(\\sbf+\\nbf)\\pbf \\right \\ } \\\\ & = & \\trace \\left \\ { \\left[\\pbf^{\\dag}(\\sbf+\\nbf)\\pbf\\right ] ^{-1 } \\pbf^{\\dag}2\\sbf\\pbf   \\right \\ } \\nonumber\\\\ & = & 2\\trace \\left \\ { \\pbf^{\\dag}(\\sbf+\\nbf)^{-1 } \\sbf\\pbf \\right \\}. \\nonumber\\end{aligned}\\ ] ]    to find the optimal basis functions , we now maximize equation ( a15 ) with respect to changes in the basis functions @xmath53 , which are columns of the transformation @xmath50 , subject to the constraints that these functions be orthonormal .",
    "we solve this problem using the method of lagrange multipliers , and maximize the lagrangian ( not the likelihood , though they momentarily share the notation @xmath188 ) , @xmath205 where @xmath206 is the diagonal matrix of lagrange multipliers .",
    "we compute the gradient with respect to the matrix @xmath50 and set this to zero , @xmath207 the optimal basis vectors are the solution to this generalized eigenvalue problem , which we can rearrange to form a simple eigenvalue problem : @xmath208 where @xmath95 is the identity matrix , @xmath209 is justified because @xmath206 is an as yet unknown diagonal matrix , and the elements of @xmath97 are the square roots of @xmath98 .",
    "@xmath97 is a whitening transformation , which diagonalizes the noise component of the covariance matrix . written in this fashion , the optimal functions for expanding the observations are @xmath210 , the product of a whitening transformation with the eigenvectors of the whitened signal correlation matrix of the best fit model .",
    "we obtain the identical eigenvectors from the whitened covariance matrix , @xmath211",
    "here we derive an approximation to the integral average of the correlation function between two cells , @xmath106 .",
    "computation of this integral is complicated by redshift distortions , through which the simple theoretical quantity in real space , @xmath212 , becomes a function of both the direction of @xmath213 and the distance of this pair from the observer .",
    "below we present a derivation that ignores redshift distortions .",
    "this treatment is sufficient to estimate the properties of the angle - averaged redshift - space power spectrum , but falls short of using the full statistical power of the eigenmode method .    by explicitly including the redshift - space distortions in the clustering model",
    ", we can simultaneously estimate both the real - space power spectrum and the redshift - space distortions .",
    "to do so we generalize the approximation described below , using techniques similar to those employed in regs & szalay 1994 .",
    "discussion of the physical motivation and details of our method for modelling the redshift distortions is sufficiently lengthy that we will include it in a future paper in this series .",
    "the `` far - field '' approximation ( which assumes that the directions @xmath214 and @xmath215 are parallel , thus @xmath216 ) that is commonly used for examining redshift distortions is not necessarily valid over the entire region of the survey volume .",
    "our method does not rely on the `` far - field '' approximation and therefore is accurate for any survey geometry .",
    "we assume spherical geometry , where each cell is bounded by @xmath217 where @xmath218 are the normal euler coordinates .",
    "the central mass of each cell @xmath219 ( @xmath220 ) is @xmath221 .",
    "the distance between the two cells is @xmath222 .",
    "the vector @xmath223 points from the central mass of the @xmath219th cell to a position within that cell , thus the position of a point in cell @xmath219 is @xmath224 .",
    "we also define the vector @xmath225 between the central masses of the two cells , as well as @xmath226 and @xmath227 .      assuming that the distance between the cells is much larger than the size of each cell",
    ", we can expand @xmath230 in a taylor series up to second order ( as we find below , the first order cancels out , so we do need the second order term ) : @xmath232 the first derivatives are @xmath233 expanding around @xmath234 , @xmath235 the second derivatives are @xmath236 expanding around @xmath237 we obtain @xmath238 where @xmath239 is the kronecker symbol .",
    "thus , the second order taylor series expansion is @xmath240    next we evaluate the different orders of the approximation @xmath241 by integrating equation ( b8 ) over the pair of cells : @xmath242 we calculate the second order in two parts : @xmath243 thus , we obtain the second order term , @xmath244 where the moments @xmath245 and @xmath246 will be evaluated below .",
    "each cell has volume @xmath247 in cartesian coordinates , the center of mass of each cell is @xmath248_{r_l}^{r_u } \\left[{\\vartheta\\over2}-{\\sin2\\vartheta\\over 4}\\right]_{\\vartheta_l } ^{\\vartheta_u } \\left[\\sin\\varphi\\right]_{\\varphi_l}^{\\varphi_u } \\nonumber \\\\ % \\avg{y } & = & { 1\\over v } \\int\\limits_{r_l}^{r_u}dr\\int\\limits_{\\vartheta_l}^{\\vartheta_u}d\\vartheta \\int\\limits_{\\varphi_l}^{\\varphi_u}d\\varphi r^2\\sin\\vartheta r\\sin\\vartheta\\sin\\varphi \\\\ & = & { 1\\over v } \\left[{r^4\\over4}\\right]_{r_l}^{r_u } \\left[{\\vartheta\\over2}-{\\sin2\\vartheta\\over 4}\\right]_{\\vartheta_l } ^{\\vartheta_u } \\left[-\\cos\\varphi\\right]_{\\varphi_l}^{\\varphi_u } \\nonumber \\\\ % \\avg{z } & = & { 1\\over v } \\int\\limits_{r_l}^{r_u}dr\\int\\limits_{\\vartheta_l}^{\\vartheta_u}d\\vartheta \\int\\limits_{\\varphi_l}^{\\varphi_u}d\\varphi r^2\\sin\\vartheta r\\cos\\vartheta \\\\ & = & { 1\\over v } \\left[{r^4\\over4}\\right]_{r_l}^{r_u } \\left[{\\sin^2\\vartheta\\over 2}\\right]_{\\vartheta_l}^{\\vartheta_u } \\left[\\varphi\\right]_{\\varphi_l}^{\\varphi_u}.\\nonumber\\end{aligned}\\ ] ] in spherical coordinates , the center of mass is described by @xmath249_{r_l}^{r_u } \\left[{\\vartheta\\over2}- { \\sin2\\vartheta\\over 4}\\right]_{\\vartheta_l}^{\\vartheta_u } \\sqrt { \\left(\\left[\\sin\\varphi\\right]_{\\varphi_l}^{\\varphi_u}\\right)^2 + \\left(\\left[\\cos\\varphi\\right]_{\\varphi_l}^{\\varphi_u}\\right)^2 } \\over { 1\\over v}\\left[{r^4\\over4}\\right]_{r_l}^{r_u } \\left[{\\sin^2\\vartheta\\over 2}\\right]_{\\vartheta_l}^{\\vartheta_u } \\left[\\varphi\\right]_{\\varphi_l}^{\\varphi_u } } \\\\ & = & { \\vartheta_u-\\vartheta_l-{1\\over2}(\\sin2\\vartheta_u-\\sin2\\vartheta_l ) \\over \\sin^2\\vartheta_u-\\sin^2\\vartheta_l}\\times { \\sqrt{(\\sin\\varphi_u-\\sin\\varphi_l)^2 + ( \\cos\\varphi_u-\\cos\\varphi_l)^2}\\over \\varphi_u-\\varphi_l}\\nonumber \\\\ & = & \\left ( { \\vartheta_u-\\vartheta_l\\over \\sin(\\vartheta_u+\\vartheta_l)\\sin(\\vartheta_u-\\vartheta_l)}- { 1\\over2}\\cot(\\vartheta_u+\\vartheta_l)\\right ) { \\sin{\\varphi_u-\\varphi_l\\over2}\\over(\\varphi_u-\\varphi_l)/2 } \\nonumber\\end{aligned}\\ ] ] @xmath250_{r_l}^{r_u}\\right)^2 \\nonumber\\\\ & \\times & \\left\\ { \\left(\\left[{\\vartheta\\over2}- { \\sin2\\vartheta\\over 4}\\right]_{\\vartheta_l}^{\\vartheta _ u}\\right)^2\\left [ \\left(\\left[\\sin\\varphi\\right]_{\\varphi_l}^{\\varphi_u}\\right)^2 + \\left(\\left[-\\cos\\varphi\\right]_{\\varphi_l}^{\\varphi_u}\\right)^2\\right]+ \\left(\\left[{\\sin^2\\vartheta\\over 2}\\right]_{\\vartheta_l}^{\\vartheta_u } \\left[\\varphi\\right]_{\\varphi_l}^{\\varphi_u}\\right)^2 \\right\\ } \\nonumber \\\\ & = & { ( r_u^4-r_l^4)^2\\over16v^2 } \\left\\ { \\left(\\left[{\\vartheta\\over2}- { \\sin2\\vartheta\\over 4}\\right]_{\\vartheta_l}^ { \\vartheta_u}\\right)^24\\sin^2{\\varphi_u-\\varphi_l\\over2}+",
    "\\left({(\\sin^2\\vartheta_u-\\sin^2\\vartheta_l)(\\varphi_u-\\varphi_l)\\over 2 } \\right)^2 \\right\\}\\nonumber\\end{aligned}\\ ] ] @xmath251    the inertial moments @xmath252 and the @xmath246 in equation ( b13 ) are @xmath253_{r_l}^{r_u } \\left[{\\cos^3\\vartheta\\over3}-\\cos\\vartheta\\right]_{\\vartheta_l}^{\\vartheta_u } \\left[{\\varphi\\over2}+{\\sin2\\varphi\\over4}\\right]_{\\varphi_l}^{\\varphi_u } - \\avg{x}^2 \\nonumber \\\\ q_{xy } = q_{yx } & = & { 1\\over v}\\int\\limits_{r_l}^{r_u}dr \\int\\limits_{\\vartheta_l}^{\\vartheta_u}d\\vartheta \\int\\limits_{\\varphi_l}^{\\varphi_u}d\\varphi r^2\\sin\\vartheta r^2\\sin^2\\vartheta\\sin\\varphi\\cos\\varphi -\\avg{x}\\avg{y } \\\\",
    "& = & { 1\\over v}\\left[{r^5\\over5}\\right]_{r_l}^{r_u } \\left[{\\cos^3\\vartheta\\over3}-\\cos\\vartheta\\right]_{\\vartheta_l}^{\\vartheta_u } \\left[{\\sin^2\\varphi\\over2}\\right]_{\\varphi_l}^{\\varphi_u } -\\avg{x}\\avg{y } \\nonumber \\\\ q_{xz } = q_{zx } & = & { 1\\over v}\\int\\limits_{r_l}^{r_u}dr \\int\\limits_{\\vartheta_l}^{\\vartheta_u}d\\vartheta \\int\\limits_{\\varphi_l}^{\\varphi_u}d\\varphi r^2\\sin\\vartheta r^2\\sin\\vartheta\\cos\\vartheta\\cos\\varphi -\\avg{x}\\avg{z } \\\\ & = & { 1\\over v}\\left[{r^5\\over5}\\right]_{r_l}^{r_u } \\left[{\\sin^3\\vartheta\\over3}\\right]_{\\vartheta_l}^{\\vartheta_u } \\left[\\sin\\varphi\\right]_{\\varphi_l}^{\\varphi_u } -\\avg{x}\\avg{z } \\nonumber \\\\ q_{yy } & = & { 1\\over v}\\int\\limits_{r_l}^{r_u}dr \\int\\limits_{\\vartheta_l}^{\\vartheta_u}d\\vartheta \\int\\limits_{\\varphi_l}^{\\varphi_u}d\\varphi r^2\\sin\\vartheta r^2\\sin^2\\vartheta\\sin^2\\varphi",
    "-\\avg{y}^2 \\\\ & = & { 1\\over v}\\left[{r^5\\over5}\\right]_{r_l}^{r_u } \\left[{\\cos^3\\vartheta\\over3}-\\cos\\vartheta\\right]_{\\vartheta_l}^{\\vartheta_u } \\left[{\\varphi\\over2}-{\\sin2\\varphi\\over4}\\right]_{\\varphi_l}^{\\varphi_u } -\\avg{y}^2 \\nonumber \\\\ q_{yz } = q_{zy } & = & { 1\\over v}\\int\\limits_{r_l}^{r_u}dr \\int\\limits_{\\vartheta_l}^{\\vartheta_u}d\\vartheta \\int\\limits_{\\varphi_l}^{\\varphi_u}d\\varphi r^2\\sin\\vartheta r^2\\sin\\vartheta\\cos\\vartheta\\sin\\varphi - \\avg{y}\\avg{z }   \\\\ & = & { 1\\over v}\\left[{r^5\\over5}\\right]_{r_l}^{r_u } \\left[{\\sin^3\\vartheta\\over3}\\right]_{\\vartheta_l}^{\\vartheta_u } \\left[-\\cos\\varphi\\right]_{\\varphi_l}^{\\varphi_u } -\\avg{y}\\avg{z } \\nonumber \\\\ q_{zz } & = &   { 1\\over v}\\int\\limits_{r_l}^{r_u}dr \\int\\limits_{\\vartheta_l}^{\\vartheta_u}d\\vartheta \\int\\limits_{\\varphi_l}^{\\varphi_u}d\\varphi r^2\\sin\\vartheta r^2\\cos^2\\vartheta - \\avg{z}^2 \\\\ & = & { 1\\over v}\\left[{r^5\\over5}\\right]_{r_l}^{r_u } \\left[-{\\cos^3\\vartheta\\over3}\\right]_{\\vartheta_l}^{\\vartheta_u } \\left[\\varphi\\right]_{\\varphi_l}^{\\varphi_u } -\\avg{z}^2 \\nonumber\\end{aligned}\\ ] ] @xmath254"
  ],
  "abstract_text": [
    "<S> we describe a method for estimating the power spectrum of density fluctuations from galaxy redshift surveys that yields improvement in both accuracy and resolution over direct fourier analysis . the key feature of this analysis is expansion of the observed density field in the unique set of statistically orthogonal spatial functions which obtains for a given survey s geometry and selection function and the known properties of galaxy clustering ( the karhunen - love transform ) . </S>",
    "<S> each of these _ eigenmodes _ of the observed density field optimally weights the data to yield the cleanest ( highest signal / noise ) possible measure of clustering power as a function of wavelength scale for any survey . using bayesian methods , we simultaneously estimate the mean density , power spectrum of density fluctuations , and redshift distortion parameters that best fit the observed data </S>",
    "<S> this method is particularly important for analysis of surveys with small sky coverage , that are comprised of disjoint regions ( e.g. , an ensemble of pencil beams or slices ) , or that have large fluctuations in sampling density . </S>",
    "<S> we present algorithms for practical application of this technique to galaxy survey data .    </S>",
    "<S> # 1 </S>"
  ]
}