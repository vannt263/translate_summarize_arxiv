{
  "article_text": [
    "morphisms and morphic sequences are well known and well studied in combinatorics on words ( e.  g. , see @xcite ) .",
    "we study their subword complexity .",
    "let @xmath3 be a finite alphabet .",
    "a mapping @xmath4 is called a _ morphism _ if @xmath5 for all @xmath6 .",
    "a morphism is determined by its values on single - letter words .",
    "a morphism is called _ nonerasing _ if @xmath7 for each @xmath8 , and is called _ coding _ if @xmath9 for each @xmath8 .",
    "let @xmath10 denote @xmath11 .",
    "let @xmath12 for some @xmath13 , @xmath14 , and suppose @xmath15 is not empty .",
    "then an infinite sequence @xmath16 is well - defined and is called _ pure morphic_. sequences of the form @xmath17 with coding @xmath18 are called _ morphic_.    in this paper we study a natural combinatorial characteristics of sequences , namely subword complexity .",
    "the _ subword complexity _ of a sequence @xmath19 is a function @xmath20 where @xmath21 is the number of all different @xmath22-length subwords occurring in  @xmath19 . for a survey on subword complexity ,",
    "see , e.  g. , @xcite .",
    "pansiot showed  @xcite that the subword complexity of an arbitrary pure morphic sequence adopts one of the five following asymptotic behaviors : @xmath23 , @xmath24 , @xmath25 , @xmath26 , or @xmath27 .",
    "since codings can only decrease subword complexity , the subword complexity of every morphic sequence is @xmath28 .",
    "we formulate the following main result .",
    "[ maintheorem ] the subword complexity @xmath29 of a morphic sequence @xmath19 is either @xmath30 for some @xmath31 , or @xmath32 .",
    "note that for each @xmath33 the complexity class @xmath34 is non - empty  @xcite .",
    "we give an example of a morphic sequence @xmath19 with @xmath35 in section  [ an_example ] .",
    "let @xmath3 be a finite alphabet , @xmath36 be a morphism , @xmath37 be a coding , @xmath38 be a letter such that @xmath39 starts with @xmath40 , @xmath41 be the pure morphic sequence generated by @xmath42 from @xmath40 , and @xmath43 be a morphic sequence . by theorem  7.7.1 from @xcite every morphic sequence can be generated by a nonerasing morphism , so",
    "further we assume that @xmath42 is nonerasing . to prove theorem  [ maintheorem ]",
    ", we will first replace @xmath42 by its power so that it will have better properties , see section [ morphperiodicity ] .",
    "it is already clear from the definition of a pure morphic sequence that if we replace @xmath42 by its power , then @xmath44 and @xmath19 will not change .",
    "possibly , we will also add several ( at most two ) `` new '' letters to @xmath3 so that @xmath42 and @xmath18 will be defined on the `` old '' letters as previously , and will map the `` new '' letters to the `` new '' letters only .",
    "this will not modify @xmath44 and @xmath19 , and the only reason why we do that is that this simplifies formulations of some statements .",
    "for example , we may want to say that a ( finite ) subword @xmath45 of @xmath19 can be written as a finite word @xmath46 repeated several times , where @xmath47 belongs to a prefixed finite set . in a particular case it can turn out that @xmath45 is the empty word , and then it can be written as any word @xmath46 repeated zero times .",
    "however , to ease the formulation of this statement , it is convenient to know that the set where we are allowed to take @xmath47 from is nonempty , even if all letters of all possible words @xmath47 are not present in @xmath19 at all .    to prove theorem  [ maintheorem ] , we will have to develop some `` structure theory '' of pure morphic and morphic sequences ( see sections [ sectionblocks][sectionevolutions ] ) . we will introduce and study the notions of a letter of order @xmath33 , of a @xmath33-block , of a @xmath33-multiblock , of a stable @xmath33-(multi)block , of an evolution , and of a continuously periodic evolution .",
    "actually , these notions will be defined correctly only after we replace @xmath42 with @xmath48 for an appropriate @xmath49 and possibly add several letters to @xmath3 as explained in section [ morphperiodicity ] ( more precisely , if @xmath42 is a strongly 1-periodic morphism with long images , and if @xmath3 contains at least one periodic letter of order 1 and at least one periodic letter of order 2 ) .",
    "these studies of the structure of pure morphic and morphic sequences may be of independent interest .    using these notions",
    ", we can formulate the following two propositions , which the proof of theorem  [ maintheorem ] is based on :    [ largecompl ] let @xmath1 . if @xmath38 is a letter such that @xmath50 for some @xmath51 , and there are evolutions of @xmath33-blocks arising in @xmath41 that are not continuously periodic , then the subword complexity of @xmath52 is @xmath53 .",
    "[ smallcompl ] let @xmath1 .",
    "if @xmath38 is a letter of order at least @xmath54 such that @xmath50 for some @xmath51 , and all evolutions of @xmath33-blocks arising in @xmath41 are continuously periodic , then the subword complexity of @xmath52 is @xmath55 .",
    "however , these two propositions do not cover all cases needed to prove theorem [ maintheorem ] .",
    "this is not clear right now , before we give the definitions , but , for example , if @xmath40 is a letter of order @xmath54 , where @xmath1 , such that @xmath50 for some @xmath51 , and evolutions of @xmath56-blocks that are not continuously periodic do not exist ( as we will see later , in this case evolutions of @xmath56-blocks do not exist at all ) , then proposition [ largecompl ] does not give us any upper estimate , and we can not use proposition [ smallcompl ] either , because if we want to use it for @xmath56-blocks , @xmath40 has to be a letter of order at least @xmath57 .",
    "also , propositions [ largecompl ] and [ smallcompl ] do not say anything about complexity @xmath58 .",
    "the following three propositions will help us to prove theorem [ maintheorem ] in these cases :    [ finordercomplstop ] let @xmath1 .",
    "suppose that @xmath42 is a strongly 1-periodic morphism with long images and @xmath38 is a letter of order @xmath54 such that @xmath50 for some @xmath51 .",
    "suppose that all evolutions of @xmath33-blocks arising in @xmath41 are continuously periodic .",
    "let @xmath59 be the rightmost letter of order @xmath60 in @xmath61 , and let @xmath62 be the rightmost letter of order @xmath60 in @xmath63 .",
    "if there exists a final period @xmath47 such that @xmath64 is a completely @xmath65-periodic word with period @xmath47 , then the subword complexity of @xmath52 is @xmath23 , otherwise it is @xmath66 .",
    "[ ordertwocompl ] if @xmath38 is a letter of order 2 such that @xmath50 for some @xmath51 , then the subword complexity of @xmath67 is @xmath23 .",
    "[ infordercomplstop ] let @xmath1 .",
    "let @xmath38 be a letter of order @xmath68 such that @xmath50 for some @xmath51 , and let @xmath41 .",
    "suppose that if @xmath69 is a letter of finite order @xmath70 and @xmath71 occurs in @xmath44 , then @xmath72 .",
    "suppose that all evolutions of @xmath33-blocks arising in @xmath44 are continuously periodic .",
    "then the subword complexity of @xmath52 is @xmath58 .",
    "when we speak about finite words or about words infinite to the right , their letters are enumerated by nonnegative integer indices ( starting from 0 ) .",
    "the length of a finite word @xmath45 is denoted by @xmath73 .",
    "we will speak about occurrences in @xmath74 . strictly speaking",
    ", we call a pair of a word @xmath45 and a location @xmath75 in @xmath44 _ an occurrence _ if the subword of @xmath44 that starts from position @xmath75 in @xmath44 and is of length @xmath73 is @xmath45",
    ". this occurrence is denoted by @xmath76 if @xmath77 is the index of the last letter that belongs to the occurrence . in particular",
    ", @xmath78 denotes a single - letter occurrence , and @xmath79 denotes an occurrence of the empty word between the @xmath80-th and the @xmath75-th letters . since @xmath81 , @xmath42 might be considered either as a morphism on words ( which we call abstract words sometimes ) , or as a mapping on the set of occurrences in @xmath44 .",
    "usually we speak of the latter , unless stated otherwise .",
    "sometimes we write @xmath82 for the identity morphism .",
    "a finite word @xmath83 is called a _ prefix _ of a ( finite or infinite to the right ) word @xmath45 if @xmath84 .",
    "a finite word @xmath83 is called a _ suffix _ of a finite word @xmath45 if @xmath85 .",
    "we call a finite word @xmath45 _ weakly @xmath86-periodic _ with a _ left _ ( resp",
    ".  _ right _ ) period @xmath83 ( where @xmath87 ) if @xmath88 and @xmath89 ( resp .",
    "@xmath90 ) , where @xmath91 is the remainder of @xmath73 modulo @xmath86 , @xmath92 is allowed here .",
    "we shortly say `` a weakly left ( resp .",
    "right ) @xmath83-periodic word '' instead of `` a weakly @xmath93-periodic word with left ( resp .",
    "right ) period @xmath83 '' .",
    "@xmath83 will be always considered as an abstract word .",
    "the subword @xmath94 ( resp .",
    "@xmath95 ) is called the _ incomplete occurrence_. all the same is with sequences of symbols or numbers . if @xmath92 , then @xmath45 is called _",
    "completely @xmath86-periodic _ with period @xmath83 ( which is both left period and right period in this case , so we sometimes call it a _ complete _ period ) .",
    "again , we shortly say `` a completely @xmath83-periodic word '' instead of `` a completely @xmath93-periodic word with period @xmath83 '' .",
    "clearly , a weakly @xmath86-periodic word with some left period always is also weakly @xmath86-periodic with some right period , and these periods are cyclic shifts of each other .",
    "so , we introduce some notation for cyclic shifts . if @xmath83 is a finite word and @xmath96 , we denote the cyclic shift of @xmath83 that begins with the last @xmath97 letters of @xmath83 and ends with the first @xmath91 letters of @xmath83 by @xmath98 .",
    "in other words , @xmath99 . if @xmath100 and @xmath91 is the residue of @xmath22 modulo @xmath93 , we denote @xmath101 .",
    "in particular , if @xmath102 , then @xmath103 , in other words , @xmath104 is the cyclic shift of @xmath83 that begins with the last @xmath22 letters of @xmath83 and ends with the first @xmath105 letters of @xmath83 .",
    "we widely use the following easy properties of periods and cyclic shifts :    1 .   if @xmath106 , then @xmath107 .",
    "if a finite word @xmath45 is weakly @xmath86-periodic with left period @xmath83 , where @xmath83 is a word of length @xmath86 , then @xmath45 is also weakly @xmath86-periodic with right period @xmath108 .",
    "if a finite word @xmath45 is weakly @xmath86-periodic with right period @xmath83 , where @xmath83 is a word of length @xmath86 , then @xmath45 is also weakly @xmath86-periodic with left period @xmath109 .",
    "4 .   if @xmath83 is a word of length @xmath86 , two finite words @xmath45 and @xmath110 are weakly @xmath86-periodic , and @xmath45 ( resp .",
    "@xmath110 ) is weakly @xmath86-periodic with right ( resp",
    ".  left ) period @xmath83 , then the concatenation @xmath111 is weakly @xmath86-periodic with left period @xmath109 and is also weakly @xmath86-periodic with right period @xmath112 .",
    "the following lemma , informally speaking , shows that if we know a finite word is `` long enough '' and is weakly @xmath86-periodic for some @xmath86 , which we maybe do nt know itself , but we know that @xmath86 is `` small enough '' , then these data determine @xmath86 and the left , right or complete period uniquely .",
    "[ finwordperiods ] let @xmath45 be a finite word .",
    "suppose that @xmath45 is weakly @xmath113-periodic with a left period @xmath83 and is weakly @xmath114-periodic with a left period @xmath115 at the same time .",
    "suppose also that @xmath116 and @xmath117 .",
    "then there exists a finite word @xmath47 such that @xmath83 is @xmath47 repeated @xmath33 times and @xmath115 is @xmath47 repeated @xmath118 times for some @xmath119 .    if @xmath120 , then the statement is obvious .",
    "otherwise , without loss of generality we may suppose that @xmath121 .",
    "then @xmath122 .",
    "note that the fact that @xmath45 is weakly @xmath86-periodic can be written as follows : for all @xmath123 one has @xmath124 .",
    "let us prove that @xmath45 is weakly @xmath125-periodic with a left period @xmath126 .",
    "choose an index @xmath75 , @xmath127 .",
    "if @xmath128 , then @xmath129 ( since @xmath45 is weakly @xmath113-periodic ) and @xmath130 ( since @xmath45 is weakly @xmath114-periodic ) .",
    "if @xmath131 , then @xmath132 since @xmath133 , so @xmath134 .",
    "so @xmath135 .",
    "note that if @xmath113 is divisible by @xmath114 , then the claim is also clear .",
    "otherwise set @xmath136 , and write @xmath137 , where @xmath138 .",
    "if we repeat the argument above @xmath139 times , we will see that @xmath45 is weakly @xmath140-periodic with a left period @xmath141 .",
    "finally , we write euclid algorithm for @xmath113 and @xmath114 : + @xmath142 + @xmath143 + @xmath144 + @xmath145 + @xmath146 .",
    "+ if we repeat all arguments above for each of the pairs @xmath147 , we will finally see that @xmath45 is weakly @xmath148-periodic with a left period @xmath149 , where @xmath148 is the g. c. d. of @xmath113 and @xmath114 .",
    "in particular , since @xmath45 is also weakly @xmath113-periodic with left period @xmath83 and @xmath150 , this also means that @xmath83 is @xmath47 repeated @xmath151 times .",
    "similarly , @xmath115 is @xmath47 repeated @xmath152 times .",
    "the same lemma for right periods instead of left ones can be proved in completely the same way .",
    "after we have this lemma , it is reasonable to give the following definition .",
    "a finite word @xmath47 is called the _",
    "minimal left ( resp .",
    "right ) period _ of a finite word @xmath45 if @xmath153 , @xmath45 is weakly left ( resp .",
    "right ) @xmath47-periodic and @xmath45 is not weakly @xmath86-periodic if @xmath154 .",
    "the following corollary provides more properties of the minimal periods if they exist .",
    "let @xmath45 be a finite word .",
    "if there exists @xmath87 such that @xmath45 is weakly @xmath86-periodic and @xmath155 , then there exist minimal left and right periods of @xmath45 .    if @xmath47 is the minimal left ( resp .",
    "right ) period of @xmath45 , and @xmath45 is weakly @xmath86-periodic with left ( resp .",
    "right ) period @xmath83 , where @xmath155 , then @xmath86 is divisible by @xmath65 and @xmath83 is @xmath47 repeated @xmath156 times .",
    "a similar statement in the case of complete @xmath86-periodicity follows directly since a word is completely @xmath86-periodic exactly if it is weakly @xmath86-periodic and its length is divisible by @xmath86 .",
    "a finite word @xmath47 is called the _ minimal complete period _ of a finite word @xmath47 if @xmath153 , @xmath45 is completely @xmath47-periodic , and @xmath45 is not weakly @xmath86-periodic if @xmath154 .",
    "[ finwordmincompleteperiod ] let @xmath45 be a finite word .",
    "if there exists @xmath87 such that @xmath45 is completely @xmath86-periodic and @xmath155 , then there exist a minimal complete period of @xmath45 .",
    "if @xmath47 is the complete period of @xmath45 , and @xmath45 is weakly @xmath86-periodic with left ( resp .",
    "right ) period @xmath83 , where @xmath155 , then @xmath86 is divisible by @xmath65 and @xmath83 is @xmath47 repeated @xmath156 times .",
    "[ overlapperiod ] let @xmath45 be a finite word , let @xmath157 and @xmath158 be two occurrences in @xmath45 .",
    "suppose that @xmath157 is weakly @xmath86-periodic , and @xmath158 is weakly @xmath159-periodic .",
    "suppose also that these two occurrences overlap , and their intersection ( denote it by @xmath160 ) has length at least @xmath161 . in other words , @xmath162 , @xmath163 , and @xmath164 .",
    "then the union of these two occurrences ( i.  e.  the occurrence @xmath165 , where @xmath166 and @xmath167 ) is a weakly @xmath168-periodic word .    without loss of generality , @xmath169 . then @xmath170 and @xmath171 .",
    "let @xmath83 be the left period of @xmath157 ( so that @xmath88 ) , and let @xmath172 be the left period of @xmath158 ( so that @xmath173 ) . denote the residue of @xmath174 modulo @xmath86 by @xmath91 . then ,",
    "if we write @xmath157 as @xmath83 repeated several times , @xmath175 will be @xmath176 .",
    "moreover , @xmath160 becomes a weakly @xmath86-periodic word with left period @xmath177 .",
    "since @xmath160 is a prefix of @xmath158 , @xmath160 is also a weakly @xmath159-periodic word with left period @xmath172 .",
    "now , by lemma [ finwordperiods ] , there exists a word @xmath47 of length @xmath168 such that @xmath172 is @xmath47 repeated @xmath178 times and @xmath179 is @xmath47 repeated @xmath180 times .",
    "but then @xmath83 can also be written as a cyclic shift of @xmath47 repeated @xmath180 times .",
    "now , since @xmath157 is weakly @xmath86-periodic with left period @xmath83 , it is also weakly @xmath168-periodic . since @xmath158 is weakly @xmath159-periodic with left period @xmath172 , it is also weakly @xmath168-periodic . in other words , if @xmath33 and @xmath181 are two indices such that @xmath182 and @xmath183 , then @xmath184 as an abstract letter .",
    "also , if @xmath33 and @xmath181 are two indices such that @xmath185 and @xmath186 , then again @xmath184 as an abstract letter .",
    "if @xmath187 , we are done . otherwise @xmath188 and @xmath189 , and",
    "we have @xmath190 .",
    "so , if @xmath191 , but @xmath192 , then @xmath193 , @xmath194 , and @xmath184 anyway .",
    "hence , @xmath195 is weakly @xmath168-periodic .",
    "note that in the last computation an inequality @xmath196 instead of @xmath164 would be enough , but we can not replace @xmath164 with @xmath196 in the statement of the corollary , because we also need the inequality @xmath164 in lemma [ finwordperiods ] , and there it can not be a priori replaced by @xmath196 .",
    "an infinite word @xmath197 ( where @xmath198 ) is called periodic with a period @xmath83 ( where @xmath199 , @xmath200 ) if @xmath201 , in other words , if @xmath202 for all @xmath203 , @xmath204 . an infinite word @xmath197 ( where @xmath198 ) is called eventually periodic with a period @xmath83 ( where @xmath199 , @xmath200 ) and a preperiod @xmath172 ( where @xmath205 , @xmath200 ) if @xmath206 , in other words , if @xmath207 for @xmath208 and @xmath209 for all @xmath203 , @xmath204 .",
    "sometimes we will also speak about words infinite to the left .",
    "we enumerate indices in such words by nonpositive indices , i.  e.  such a word can be written as @xmath210 ( where @xmath211 , @xmath212 ) . such a word is called periodic with a period @xmath83 ( where @xmath199 , @xmath200 ) if @xmath213 , in other words , if @xmath214 for all @xmath215 , @xmath204 .",
    "for each letter @xmath69 , the function @xmath216 , latexmath:[$r_b(n ) =    define _ orders of letters _ with respect to @xmath42 .",
    "we say that @xmath218 has _ order @xmath33 _",
    "if @xmath219 , and has _",
    "order @xmath68 _ if @xmath220 for some @xmath221 ( @xmath222 ) .",
    "consider a directed graph @xmath223 defined as follows .",
    "vertices of @xmath223 are letters of  @xmath3 . for every @xmath224 , for each occurrence of @xmath225 in @xmath226 , construct an edge @xmath227 .",
    "for instance , if @xmath228 , we construct two edges @xmath229 and three edges  @xmath227 .",
    "[ gexample ] shows an example of graph @xmath223 .     for the following morphism @xmath42 : @xmath230 , @xmath231 , @xmath232 , @xmath233 , @xmath234 . here",
    "@xmath40 is a letter of order @xmath68 , @xmath71 is a preperiodic letter of order 2 , @xmath225 is a periodic letter of order 2 , @xmath235 and @xmath236 are periodic letters of order 1 . ]    using the graph @xmath223 , let us prove the following lemma .",
    "[ rates ] for every @xmath69 , either @xmath71 has some order @xmath237 , or has order @xmath68 .",
    "if @xmath71 is a letter of order @xmath33 , then @xmath226 contains at least one letter of order @xmath33 . for every @xmath71 of order @xmath237",
    ", either @xmath71 never appears in @xmath238 ( and then @xmath71 is called _ preperiodic _ ) , or for each @xmath22 a unique letter @xmath239 of order @xmath33 occurs in @xmath238 , and the sequence @xmath240 is periodic ( then @xmath71 is called _ periodic _ ) .",
    "if @xmath71 is a letter of order @xmath68 , then @xmath226 contains at least one letter of order @xmath68 , and @xmath238 contains at least two letters of order @xmath68 if @xmath22 is large enough .",
    "if @xmath71 is a periodic letter of order @xmath241 and @xmath71 occurs in @xmath238 , then at least one letter of order @xmath242 occurs in @xmath238 .",
    "consider also the following graph @xmath243 .",
    "vertices of @xmath243 are strongly connected components of @xmath223 .",
    "there is an edge from @xmath244 to @xmath245 iff there is an edge from some of @xmath246 vertices ( in @xmath223 ) to some of @xmath247 vertices .",
    "[ gpexample ] shows an example of the corresponding graph @xmath243 .",
    "corresponding to the graph @xmath223 from the previous example . ]",
    "let @xmath248 be the subgraph of @xmath243 induced by vertices @xmath244 such that for all vertices @xmath249 there is at most one edge outgoing from @xmath71 to a vertex @xmath250 .",
    "let @xmath251 be the subgraph of @xmath248 induced by vertices @xmath252 such that for all vertices @xmath253 there are no edges outgoing from @xmath71 to a vertex @xmath250 . in fig .",
    "[ gpexample ] and [ gexample ] the vertices of @xmath254 ( resp .",
    "the corresponding vertices of @xmath223 ) are black , the vertices of @xmath255 ( resp .",
    "the corresponding vertices of @xmath223 ) are gray , and the vertices of @xmath251 ( resp .",
    "the corresponding vertices of @xmath223 ) are white",
    ". we will now assign orders ( natural numbers or infinity ) to the vertices of @xmath243 ( hence , to the vertices of @xmath223 too ) .",
    "a vertex @xmath252 is called a vertex of order one if it does not have outgoing edges ( in @xmath248 , not in @xmath223 ) .",
    "then assign order one to the vertices ( if any ) of graph @xmath251 that have outgoing edges to the vertices that are already of order one only .",
    "repeat this operation until there are no new vertices of order one .",
    "suppose some vertices already are of order @xmath33 ( and we do nt want to assign order @xmath33 to any other vertex of @xmath243 ) . then a vertex @xmath252 is called vertex of order @xmath60 if all the edges outgoing from it lead to vertices of order @xmath33 or less .",
    "then , consider a vertex @xmath256 that has not been currently assigned to be of some order .",
    "if all its outgoing edges lead to vertices of orders @xmath257 , assign @xmath258 to be of order @xmath60 .",
    "repeat this operation until there are no new vertices of order @xmath60 .",
    "all vertices that currently have no order assigned ( after completing the above procedure for each @xmath33 ) , are called vertices of order @xmath68 .",
    "we have assigned orders to the vertices of @xmath243 , hence also to the vertices of @xmath223 ( that are the letters of @xmath259 ) .",
    "it follows directly from the definition of the order of a vertex that if @xmath260 is a vertex of order @xmath33 , then there is an edge going from @xmath40 to ( possibly another ) vertex of order @xmath33 .",
    "one can prove by induction on @xmath33 that    _ any letter of finite order @xmath33 has the rate of growth @xmath261 .",
    "any letter of infinite order has the rate of growth @xmath262 for some @xmath263 . _",
    "thus , two definitions of the order of a letter are equivalent .",
    "vertices @xmath246 of @xmath243 of order @xmath68 are exactly the vertices of @xmath243 such that there exists a path from @xmath246 to a vertex @xmath264 .",
    "it is already clear that if @xmath71 is a letter of order @xmath68 , then @xmath226 contains a letter of order @xmath68 . to prove that if @xmath22 is large enough , then @xmath238 contains at least two letters of order @xmath68",
    ", we may assume without loss of generality that @xmath71 already belongs to a strongly connected component @xmath246 of @xmath223 such that @xmath265 .",
    "then there exists a vertex @xmath250 such that there are at least two edges leading from @xmath225 to vertices of @xmath223 in @xmath244 .",
    "this means that @xmath266 contains at least two letters of order @xmath68 , and @xmath267 contains @xmath225 for some @xmath268 .",
    "then @xmath238 contains at least two letters of order @xmath68 if @xmath269 .",
    "a vertex of @xmath248 of finite order is called _ preperiodic _ if it actually belongs to @xmath251 , otherwise it is called _",
    "periodic_. a vertex of @xmath223 ( i. e.  a letter ) is called _ periodic _",
    "_ preperiodic _ ) iff the corresponding vertex of @xmath243 is periodic ( resp .",
    "preperiodic ) .",
    "if @xmath260 is a periodic vertex of order @xmath270 , it has exactly one outgoing edge to a vertex of order @xmath33 .",
    "these two vertices correspond to the same vertex @xmath244 , and all vertices of @xmath223 that correspond to @xmath246 ( i. e.  that belong to the strongly connected component @xmath246 ) actually form a directed loop .",
    "unlike that , any edge that starts in a preperiodic vertex @xmath260 of order @xmath33 , leads to a vertex that had been assigned to be of some order @xmath271 before @xmath40 .",
    "hence , this definition of a periodic letter and the definition from the lemma statement are equivalent .    to prove the last claim , observe that if @xmath252 is a periodic letter of order @xmath33 , then there must be an edge going from @xmath246 to a vertex of order @xmath272 , otherwise we would have assigned @xmath246 to be a vertex of order @xmath272 or less .",
    "therefore , there is a vertex @xmath260 corresponding to @xmath246 such such that there is an edge going from @xmath71 to a vertex of @xmath223 of order @xmath272 .",
    "in other words , @xmath273 contains a letter of order @xmath272 .",
    "let @xmath225 be ( possibly another ) vertex of @xmath223 corresponding to @xmath252 .",
    "then we already know that @xmath71 and @xmath225 are contained in a directed loop in @xmath223 .",
    "if @xmath225 occurs in @xmath274 , then @xmath22 is divisible by the length of this loop , hence @xmath22 is greater than or equal to the length of this loop , and there exists @xmath275 ( @xmath276 ) such that @xmath277 contains @xmath71 .",
    "then @xmath278 contains a letter @xmath235 of order @xmath272 , and @xmath274 contains @xmath279 .",
    "the image of a letter of order @xmath272 always contains a letter of order @xmath272 , so a letter of order @xmath272 occurs in @xmath279 and hence in @xmath274 .    in the example of a graph @xmath223 in fig .",
    "[ gexample ] , @xmath235 and @xmath236 are vertices of order one .",
    "we can not assign any other vertex to be of order one , so we assign then @xmath225 to be of order two . it is a periodic vertex .",
    "then we can see that @xmath71 has a single outgoing edge , and it leads to @xmath225 .",
    "thus , @xmath71 should be a preperiodic vertex of order two .",
    "the remaining vertex @xmath40 can not be of finite order since it does not belong to @xmath248 .",
    "it is a vertex of order @xmath68 .",
    "in general , it is possible that all letters in @xmath3 have order @xmath68 .",
    "however , it will be convenient for us if at least one periodic letter of order 1 and at least one periodic letter of order 2 exists .",
    "so , first , if periodic letters of order 1 do not exist in @xmath3 ( then it follows from the construction above that all letters in @xmath3 have order @xmath68 ) , we add one more letter ( that we temporarily denote by @xmath71 ) to @xmath3 and set @xmath280 , @xmath281 ( without varying @xmath42 and @xmath18 on other letters ) .",
    "then @xmath71 is a periodic letter of order 1 . from now on ,",
    "we suppose that periodic letters of order 1 exist in @xmath3 .",
    "second , suppose that periodic letters of order 1 exist in @xmath3 , but periodic letters of order 2 do not exist ( it follows from the above construction that in this case all letters in @xmath3 have either order 1 , or order @xmath68 ) .",
    "let @xmath69 be a periodic letter of order 1 .",
    "we add one more letter to @xmath3 ( denote it temporarily by @xmath225 ) and set @xmath282 , @xmath283 ( again , we do not change @xmath42 and @xmath18 on other letters ) .",
    "then @xmath225 is a periodic letter of order 2 . from now on ,",
    "we suppose that periodic letters of order 2 exist in @xmath3 .",
    "now we are going to replace @xmath42 by @xmath48 for some @xmath49 to get a morphism satisfying better properties .",
    "namely , first let us call a nonerasing morphism @xmath284 _",
    "weakly 1-periodic _ if :    1 .",
    "if @xmath71 is a preperiodic letter of order @xmath33 , then all letters of order @xmath33 in @xmath285 are periodic .",
    "if @xmath71 is a periodic letter of order @xmath33 , then the letter of order @xmath33 contained in @xmath285 is @xmath71 .",
    "we would like to choose @xmath22 so that @xmath48 is a weakly 1-periodic morphism . note first that the orders of letters with respect to @xmath48 are the same as their orders with respect to @xmath42 .",
    "periodic and preperiodic letters with respect to @xmath42 remain periodic and preperiodic ( respectively ) with respect to @xmath48 .",
    "if the first letter in @xmath39 is @xmath40 for some @xmath38 , then @xmath286 begins with @xmath40 as well , and @xmath287 .",
    "there exists @xmath49 such that @xmath48 is a weakly 1-periodic morphism .",
    "if @xmath71 is a preperiodic letter of order @xmath33 , then @xmath238 does not contain @xmath71 for any @xmath288 .",
    "therefore , there exists @xmath289 such that if @xmath290 , then all letters of order @xmath33 in @xmath238 are periodic .",
    "take any @xmath49 such that @xmath290 for all these numbers @xmath268 for all preperiodic letters @xmath69 of finite order .",
    "( clearly , @xmath291 is sufficient , in the example above we can take @xmath292 . ) set @xmath293 . if @xmath71 is a preperiodic letter of order @xmath33 , all letters of order @xmath33 in @xmath294 are periodic , and all letters of order @xmath33 in @xmath295 are also periodic .",
    "so , now it is sufficient to choose @xmath275 so that if @xmath71 is a periodic letter of order @xmath33 , then the letter of order @xmath33 occurring in @xmath295 is @xmath71 again . by the definition of a periodic letter , for each individual periodic letter @xmath71 there",
    "exists @xmath296 such that if @xmath275 is divisible by @xmath297 , then the letter of order @xmath33 contained in @xmath295 is @xmath71 .",
    "now let us take @xmath298 divisible by all numbers @xmath297 for all periodic letters @xmath71 .",
    "( e. g. , we can always take @xmath299 , and in the example above we can take @xmath300 . )",
    "then @xmath301 is a weakly 1-periodic morphism .",
    "from now on , we replace @xmath42 by @xmath284 from the proof and assume that @xmath42 is a weakly 1-periodic morphism .",
    "actually , we want to improve @xmath42 more . for each @xmath1 and for each letter @xmath69 of order @xmath302 ,",
    "the leftmost and rightmost letters of order @xmath302 in @xmath226 will be important for us .",
    "if @xmath303 and @xmath45 is a finite word in @xmath3 containing at least one letter of order @xmath302 , denote the leftmost ( resp .",
    "rightmost ) letter of order @xmath302 in @xmath45 by @xmath304 ( resp .  by @xmath305 ) . observe that if @xmath69 , then @xmath306 since if @xmath225 is a letter of order @xmath33 or less , then @xmath266 consists of letters of order @xmath33 or less only .",
    "hence , @xmath307 is an eventually periodic sequence .",
    "similarly , @xmath308 is also an eventually periodic sequence .",
    "we want to make these sequence as simple as possible , so we call a morphism @xmath42 _ strongly 1-periodic _ if for each @xmath1 and for each letter @xmath69 of order @xmath302 , one has @xmath309 and @xmath310 , in other words , the sequences @xmath307 and @xmath308 are both eventually periodic with periods of length * _ one _ * and preperiods of length 1 .    observe that the definition of a weakly 1-periodic morphism guarantees that if @xmath71 is a letter of * _ finite _ * order , then these sequences have periods of length 1 , but we can not say anything about the length of the preperiods .",
    "also , we can not say anything about the length of the period if all letters @xmath307 have order @xmath68 .",
    "there exists @xmath49 such that @xmath48 is a strongly 1-periodic morphism .",
    "the proof is similar to the proof of the previous lemma .",
    "namely , if @xmath49 is large enough , then for @xmath293 sequences @xmath311 and @xmath312@xmath313 are eventually periodic with preperiods of length 1 for all @xmath1 and for all letters @xmath38 of order @xmath302 .",
    "again , @xmath291 is sufficient for this purpose .",
    "now , if we take a large enough @xmath314 and set @xmath301 , then the sequences @xmath315@xmath316 and @xmath317 will become eventually periodic with periods of length 1 for all @xmath1 and for all letters @xmath38 of order @xmath302 . this time , @xmath299 is sufficient .",
    "clearly , the preperiods of length 1 will remain the same .    from now on ,",
    "we replace @xmath42 by @xmath284 from the proof and assume that @xmath42 is strongly 1-periodic .",
    "our final improvement of the morphism @xmath42 will guarantee that the image of each letter is `` sufficiently long '' .",
    "namely , first we are going to define the set of _ final periods_. let @xmath69 be a letter such that @xmath318 .",
    "then the prefix of @xmath226 to the left of the leftmost occurrence of @xmath71 in @xmath226 consists of letters of order 1 only , denote it by @xmath45 .",
    "that is , if @xmath319 and @xmath320 for @xmath321 , then @xmath322 .",
    "suppose that @xmath45 is nonempty .",
    "then @xmath323 consists of periodic letters of order 1 only .",
    "recall that to construct a morphic sequence , we use @xmath42 and also a coding @xmath18 . consider the word @xmath324 .",
    "since we have repeated @xmath325 twice , we can apply corollary [ finwordmincompleteperiod ] and conclude that there exists the minimal complete period of @xmath324 , denote it by @xmath47 .",
    "we call @xmath47 , as well as all its cyclic shifts , _ final periods_. similarly , we can define a final period using a letter @xmath71 such that @xmath326 and considering the suffix of @xmath226 to the right of the rightmost occurrence of @xmath71 .",
    "these are all words we call final periods , i. e.  a _ final period _ is a word obtained from a letter @xmath69 such that @xmath318 and @xmath327 by the procedure described above or a word obtained from a letter @xmath69 such that @xmath326 and @xmath226 does not end with @xmath71 by a similar procedure .",
    "[ finalnomorethanonce ] if @xmath47 is a final period , then @xmath47 can not be written as a finite word repeated more than once .    since @xmath47 is a final period",
    ", there exists a finite word @xmath328 ( which is also a final period ) and a finite word @xmath45 such that @xmath328 is the minimal complete period of @xmath324 and @xmath329 for some @xmath91 ( @xmath330 ) .",
    "suppose that @xmath47 can be written as a finite word @xmath331 repeated more than once , in other words , that @xmath47 is a completely @xmath331-periodic word and @xmath332 .",
    "but then @xmath333 is a completely @xmath334-periodic word , where @xmath335 .",
    "then the word @xmath324 , which is @xmath328 repeated several times , is also a completely @xmath334-periodic word . but",
    "@xmath336 , and this is a contradiction with the fact that @xmath328 is the minimal complete period of @xmath324 .",
    "note that final periods always exist if @xmath42 is a strongly 1-periodic morphism and there is a periodic letter of order 2 in @xmath3 ( we have already assumed that this is true ) . indeed ,",
    "if @xmath71 is a periodic letter of order 2 , then @xmath226 contains exactly one occurrence of order 2 , which is @xmath71 , and at least one letter of order 1 . in other words ,",
    "@xmath226 can be written as @xmath337 , where the words @xmath45 and @xmath110 consist of letters of order 1 only , and at least one of these words is nonempty . we can use this nonempty word to construct a final period .    clearly , the amount of final periods is finite and their lengths are bounded . denote the maximal length of a final period by @xmath338 .",
    "[ finalperiodsstaythesame ] let @xmath1 .",
    "then the sets of final periods for @xmath42 and for @xmath339 are the same .    if @xmath340 ( resp .",
    "@xmath341 ) is a prefix ( resp .",
    "suffix ) of @xmath226 , where @xmath69 and @xmath45 is a finite word consisting of letters of order 1 only , then @xmath342 ( resp .",
    "@xmath343 ) , where @xmath323 is repeated @xmath272 times , is a prefix ( resp .  suffix ) of @xmath344 .",
    "choose a letter @xmath69 such that @xmath318 .",
    "( the case @xmath326 is completely symmetric . )",
    "suppose that @xmath327 and denote the prefix of @xmath226 to the left of the leftmost occurrence of @xmath71 by @xmath45 .",
    "then @xmath340 is a prefix of @xmath226 and @xmath45 consists of letters of order 1 only .",
    "let us prove by induction on @xmath1 that @xmath342 , where @xmath323 is repeated @xmath272 times , is a prefix of @xmath344 .",
    "for @xmath345 we already know this .",
    "if @xmath342 , where @xmath323 is repeated @xmath272 times , is a prefix of @xmath344 , then @xmath346 , where @xmath347 is repeated @xmath272 times , is a prefix of @xmath348 . recall that @xmath340 is a prefix of @xmath226 , so @xmath349 , where @xmath347 is repeated @xmath272 times , is also a prefix of @xmath348 .",
    "finally , recall that @xmath42 is ( in particular ) weakly 1-periodic , so @xmath323 consists of periodic letters of order 1 only , and @xmath350 .",
    "therefore , @xmath342 , where @xmath323 is repeated @xmath33 times , is a prefix of @xmath348 .",
    "so , the prefix of @xmath351 to the left of the leftmost occurrence of @xmath71 is @xmath352 , where @xmath323 is repeated @xmath272 times . if we apply @xmath284 to this prefix , we will get @xmath323 repeated @xmath33 times ( here we again use the fact that @xmath350 ) .",
    "finally , @xmath353 is @xmath325 repeated @xmath354 times , and , by corollary [ finwordmincompleteperiod ] , @xmath353 has a minimal complete period , and it coincides with the minimal complete period of @xmath324 .",
    "after we have this lemma , it is reasonable to give the following definition : a strongly 1-periodic morphism is called _ a strongly 1-periodic morphism with long images _",
    "if the following holds :    1 .   for each letter @xmath69 such that @xmath318 and the prefix @xmath45 of @xmath226 to the left of the leftmost occurrence of @xmath71 is nonempty , we have @xmath355 .",
    "2 .   for each letter @xmath69 such that @xmath326 and the suffix @xmath45 of @xmath226 to the right of the rightmost occurrence of @xmath71 is nonempty , we have @xmath355 .",
    "[ finalperiodsarecomplete ] let @xmath42 be a strongly 1-periodic morphism with long images .",
    "then for each letter @xmath69 such that @xmath318 ( resp .",
    "@xmath326 ) and the prefix ( resp .",
    "suffix ) @xmath45 of @xmath226 to the left ( resp .  to the right ) of the leftmost ( resp .",
    "rightmost ) occurrence of @xmath71 is nonempty , there exists a minimal complete period of @xmath325 , and it is a final period .",
    "the claim for @xmath324 instead of @xmath325 is just the definition of a final period .",
    "let @xmath47 be the minimal complete period of @xmath324 .",
    "by corollary [ finwordmincompleteperiod ] , @xmath325 is @xmath47 repeated @xmath356 times , i.  e.  @xmath325 is completely @xmath47-periodic . since @xmath355",
    ", we also have @xmath357 , and by corollary [ finwordmincompleteperiod ] again , there exists a minimal complete period @xmath328 of @xmath325 and @xmath47 is @xmath328 repeated several times .",
    "but then @xmath324 is also completely @xmath328-periodic , but @xmath47 was the minimal complete period of @xmath324 , so @xmath358 .",
    "again , let us prove that we can make a strongly 1-periodic morphism with long images out of @xmath42 by replacing it with @xmath48",
    ".    there exists @xmath49 such that @xmath48 is a strongly 1-periodic morphism with long images .",
    "observe first that if @xmath42 is strongly 1-periodic , then @xmath48 is also strongly 1-periodic .    choose a letter @xmath69 such that @xmath318 .",
    "( the case @xmath326 is completely symmetric . )",
    "suppose that @xmath327 .",
    "then , by the second statement of lemma [ finalperiodsstaythesame ] , if @xmath22 is large enough , then the length of the prefix of @xmath238 to the left of the leftmost occurrence of @xmath71 is at least @xmath359 ( here we also use the fact that @xmath42 is nonerasing , so in the statement of lemma [ finalperiodsstaythesame ] we have @xmath360 ) .",
    "let @xmath268 be the maximum of all these numbers @xmath22 for all letters @xmath38 and for the left and the right side .",
    "( @xmath361 is sufficient for this purpose , but a smaller @xmath268 can also work . )",
    "then , by lemma [ finalperiodsstaythesame ] , @xmath362 is a strongly 1-periodic morphism with long images .    from now on ,",
    "we replace @xmath42 by @xmath284 from the proof and assume that @xmath42 is a strongly 1-periodic morphism with long images .",
    "a ( possibly empty ) finite occurrence @xmath363 is _ a @xmath33-block _ if it consists of letters of order @xmath271 , @xmath364 , and the letters @xmath365 and @xmath366 both have order @xmath302 .",
    "the occurrence of a single letter @xmath365 is called the _ left border _ of this block and is denoted by @xmath367 .",
    "the occurrence of a single letter @xmath366 is called the _",
    "right border _ of this block and is denoted by @xmath368 . observe that if we have constructed the whole morphic sequence starting with a letter @xmath38 ( i.  e.  @xmath41 ) , and @xmath40 is a letter of a finite order @xmath33 , then all letters in @xmath44 are of order @xmath271 .",
    "so it makes no sense to define `` @xmath33-blocks '' of the form @xmath369 since it is not possible that all letters @xmath370 have orders @xmath271 , and @xmath366 has order @xmath302 .",
    "note that even if there are no letters of order @xmath33 in @xmath3 , @xmath33-blocks still may exist , then all letters in @xmath33-blocks will be of order @xmath371 ( or a @xmath33-block can also be empty ) , and the borders of such a @xmath33-block will be letters of order @xmath302 ( in fact , as one can deduce from the assignment of orders to letters in the previous section , these letters must have order @xmath68 ) .",
    "a problem that can arise is that letters of order @xmath371 ( or @xmath271 ) may form an infinite sequence , then they do not form a @xmath33-block by definition .",
    "later we will see that this can really happen if all letters in @xmath44 have finite orders , we will discuss this in lemma [ splitconcatenation ] .    the image under @xmath42 of a letter of order @xmath271 can not contain letters of order  @xmath302 .",
    "let @xmath363 be a @xmath33-block .",
    "then @xmath372 is a suboccurrence of some @xmath33-block which is called the _ descendant _ of @xmath363 and is denoted by @xmath373 .",
    "( we use the subscript @xmath33 here to underline that the same occurrence @xmath363 can be a @xmath33-block and an @xmath275-block for some @xmath374 at the same time , for example , if @xmath367 and @xmath368 are both of order @xmath375 , then @xmath76 is a @xmath56-block as well . in this case",
    ", @xmath373 and @xmath376 could be different occurrences in @xmath44 . )",
    "the @xmath118-th superdescendant ( denoted by @xmath377 ) is the descendant of of the descendant of @xmath363 ( @xmath118 times ) .",
    "let @xmath378 be a @xmath33-block in @xmath44 .",
    "then if there exists a @xmath33-block @xmath363 such that @xmath379 , it is unique .",
    "indeed , otherwise there would be a letter of order @xmath302 between those two @xmath33-blocks , and its image would contain a letter of order @xmath302 again . but this letter would belong to @xmath380 . if the @xmath33-block @xmath76 exists , is called the _ ancestor _ of @xmath378 and is denoted @xmath381 .",
    "the @xmath118-th superancestor ( denoted by @xmath382 ) is the ancestor of of the ancestor of @xmath378 ( @xmath118 times ) .",
    "if @xmath381 does not exist ( this can happen only if @xmath383 and @xmath384 belong to the image of the same letter ) , then @xmath378 is called an _",
    "origin_. a sequence @xmath385 of @xmath33-blocks , @xmath386 @xmath387 , where @xmath363 is an origin , is called an _",
    "evolution_. the number @xmath118 is called the _",
    "evolutional sequence number _ of a @xmath33-block @xmath388 .",
    "let @xmath385 be an evolution of @xmath33-blocks .",
    "the letter @xmath389 is the rightmost letter of order @xmath302 in @xmath390 , i.  e.  @xmath391 .",
    "since @xmath42 is a strongly 1-periodic morphism , this means that @xmath392 does not depend on @xmath118 if @xmath393 .",
    "similarly , @xmath394 does not depend on @xmath118 if @xmath393 .",
    "we call the abstract letter @xmath392 ( resp .",
    "@xmath394 ) for any @xmath393 the _ left ( resp right . )",
    "border of @xmath385 _ and denote it by @xmath395 ( resp .  by @xmath396 ) .",
    "the set of all abstract words that can be origins in @xmath44 , is finite .",
    "each origin is a subword of @xmath226 where @xmath71 is a single letter .",
    "moreover , this occurrence inside @xmath226 can not be a prefix or a suffix .",
    "[ finite - number - of - evolutions ] the set of all possible evolutions in @xmath44 ( considered as sequences of abstract words rather than sequences of occurrences in @xmath44 ) , is finite .",
    "let @xmath397 be an origin , which is a suboccurrence of @xmath398 . here",
    "@xmath59 is a letter of order @xmath302 .",
    "then @xmath398 also contains @xmath399 and @xmath400 .",
    "@xmath389 , @xmath401 and @xmath402 itself depend on _ abstract words _",
    "@xmath392 , @xmath394 and @xmath388 only .",
    "thus , all these words became known after we had selected an abstract letter @xmath403 and a suboccurrence inside @xmath226 .",
    "[ splitconcatenation ] let @xmath41 , where @xmath38 .",
    "then :    1 .",
    "if @xmath40 is a letter of a finite order @xmath404 , then @xmath40 is the only letter of order @xmath405 in @xmath44 , and it only occurs once , as @xmath406 . for each @xmath407 , @xmath1 ,",
    "@xmath44 splits into a concatenation of @xmath33-blocks and letters of order @xmath302 .",
    "2 .   if @xmath40 is a letter of order @xmath68 , then for each @xmath1 , @xmath44 splits into a concatenation of @xmath33-blocks and letters of order @xmath302 .",
    "first assume that @xmath40 is a letter of finite order @xmath404 .",
    "then @xmath40 is a periodic letter of order @xmath404 since @xmath39 begins with @xmath40 .",
    "then each word @xmath408 ( @xmath409 ) contains only one letter of order @xmath405 by a property of periodic letters . to prove the claim in this case",
    ", it suffices to prove that @xmath44 contains infinitely many letters of order @xmath410 .",
    "let @xmath45 be the finite word such that @xmath50 . then @xmath411 .",
    "since @xmath40 is a letter of order @xmath33 , @xmath39 contains at least one letter of order @xmath272 .",
    "but then @xmath412 contains at least one letter of order @xmath272 for each @xmath118 .",
    "now let us consider the case when @xmath40 is a letter of order @xmath68 .",
    "then it is sufficient to prove that @xmath44 contains infinitely many letters of order @xmath68 . by lemma [ rates ]",
    ", @xmath408 contains at least two letters of order @xmath68 if @xmath118 is large enough . again",
    "write @xmath50 , then @xmath413 and @xmath411 .",
    "if @xmath414 contains at least two letters of order @xmath68 , then at least one of the words @xmath415 contains a letter of order @xmath68 .",
    "but then , by lemma [ rates ] again , all words @xmath412 for @xmath416 also contain a letter of order @xmath68 , and @xmath44 contains infinitely many letters of order @xmath68 .",
    "now , when we know that @xmath44 can be split into a concatenation of alternating letters of order @xmath417 and @xmath33-blocks ( at least for some @xmath1 ) , it is convenient to consider concatenations of finitely many @xmath33-blocks and letters of order @xmath302 between them .",
    "however , it is not very convenient to consider them as just occurrences in @xmath44 , because @xmath33-blocks can be empty occurrences , and we want to distinguish clearly whether we include a @xmath33-block of the form @xmath418 ( as it was pointed out above , this notation denotes the occurrence of the empty word between @xmath59 and @xmath419 ) into a concatenation of the form @xmath420 or no .",
    "also , we will need to consider possibly empty concatenations of @xmath33-blocks , and their exact locations will be important for us , in particular , if @xmath418 is an empty @xmath33-block , we want to distinguish `` the empty concatenation located directly to the left of @xmath418 '' from `` the empty concatenation located directly to the right of @xmath418 '' .",
    "so we start with the following definition :    a pair of occurrences @xmath421 is called a",
    "_ @xmath33-delimiter _ ( @xmath1 ) in @xmath44 in one of the two cases :    1 .",
    "if exactly one of these two occurrences is a ( possibly empty ) @xmath33-block , and the other one is a single letter of order @xmath302 , or 2 .",
    "if @xmath422 , the occurrence of the empty word before the actual beginning of @xmath44 , and @xmath423 , a letter of order @xmath302 ( it follows from lemma [ splitconcatenation ] that @xmath406 can not be contained in a @xmath33-block since @xmath33-blocks are finite by definition ) .    here",
    "@xmath76 is called _ the left part _ of the @xmath33-delimiter and @xmath424 is called _ the right part _ of the @xmath33-delimiter .",
    "split @xmath44 into a concatenation of @xmath33-blocks and letters of order @xmath302 .",
    "write all these occurrences in @xmath44 in an infinite sequence , mentioning each empty @xmath33-block explicitly .",
    "for example , if @xmath425 , @xmath426 , @xmath427 , @xmath428 , then the orders of letters @xmath429 are @xmath430 , respectively , @xmath431 , and this sequence of occurrences is : @xmath432 . as abstract words ,",
    "the nonempty words in this sequence are : @xmath433 .",
    "the occurrences @xmath434 , @xmath435 , and @xmath436 here are empty 1-blocks . informally speaking , a @xmath33-delimiter is the `` empty space '' between two members of this sequence ( the left and the right parts of the @xmath33-delimiter ) or the `` empty space '' to the left of the whole sequence .",
    "we say that a @xmath33-block or a single letter of order @xmath302 @xmath76 is located _ strictly to the left _ from a @xmath33-block or a single letter of order @xmath302 @xmath380 if @xmath76 is written in this sequence before @xmath380 . in terms of indices",
    "this means that either @xmath437 ( `` the position where @xmath76 starts is before the position where @xmath380 starts '' ) or @xmath438 and @xmath439 ( `` the positions where @xmath76 and @xmath380 start coincide , but @xmath76 ends before @xmath380 ends '' ) , this is possible only if @xmath76 is an occurrence of the empty word ( @xmath440 ) since @xmath33-blocks and letters of order @xmath302 do not overlap .",
    "we also say that a @xmath33-block or a single letter of order @xmath302 @xmath76 is located _ strictly to the right _ from a @xmath33-block or a single letter of order @xmath302 @xmath380 if @xmath380 is located strictly to the left from @xmath76 .",
    "clearly , if @xmath76 is a @xmath33-block or a letter of order @xmath302 and @xmath380 is also a @xmath33-block or a letter of order @xmath302 , then either @xmath76 is located strictly to the left from @xmath380 , or @xmath441 , or @xmath76 is located strictly to the right from @xmath380 .",
    "now let @xmath421 be a @xmath33-delimiter , and let @xmath442 be a @xmath33-block or a single letter of order @xmath302 .",
    "then we want to define when @xmath442 is _ located at the right - hand side _ of @xmath421 . if @xmath443 , then we always say that @xmath442 is located at the right - hand side of @xmath444 .",
    "otherwise we say that @xmath442 is located at the right - hand side of @xmath421 if either @xmath445 as occurrences in @xmath44 , or @xmath442 is located strictly to the right from @xmath424 . in terms of indices",
    "this means that either @xmath446 and @xmath447 , or @xmath448 , or @xmath446 and @xmath449 .",
    "this can be rewritten shorter as follows : either @xmath446 and @xmath450 , or @xmath449 .",
    "similarly , if @xmath443 , then we never say that @xmath442 is _ located at the left - hand side of _ @xmath444 .",
    "if @xmath451 , then we say that @xmath442 is located at the left - hand side of @xmath421 if either @xmath452 as occurrences in @xmath44 , or @xmath442 is located strictly to the left from @xmath76 . in terms of indices",
    "this means that either @xmath453 and @xmath454 , or @xmath455 , or @xmath453 and @xmath456 .",
    "this can be rewritten shorter as follows : either @xmath453 and @xmath457 , or @xmath455 .",
    "again , if @xmath421 is a @xmath33-delimiter , and @xmath442 is a @xmath33-block or a single letter of order @xmath302 , then either @xmath442 is located at the left - hand side of @xmath421 , or @xmath442 is located at the right - hand side of @xmath421 .",
    "if @xmath421 and @xmath458 are @xmath33-delimiters , we say that @xmath458 is _ located at the right - hand side of _",
    "@xmath421 if @xmath442 is located at the right - hand side of @xmath421 . and @xmath421 is said to be _ located at the left - hand side of _",
    "@xmath458 if @xmath458 is located at the right - hand side of @xmath421 . and again , if we have two @xmath33-delimiters , then either they coincide , or one of them is located at the left - hand side of the other one , or one of them is located at the right - hand side of the other one .",
    "finally , we say that a @xmath33-block or a letter of order @xmath302 is _ located between _",
    "one @xmath33-delimiter and another @xmath33-delimiter if this @xmath33-block or this letter of order @xmath302 is located at the right - hand side of the first @xmath33-delimiter and at the left - hand side of the second @xmath33-delimiter .",
    "now we are ready to define @xmath33-multiblocks .",
    "we say that a _ @xmath33-multiblock _ is defined by the following data :    1 .",
    "two @xmath33-delimiters @xmath459 and @xmath460 , where @xmath459 either coincides with @xmath460 , or is located at the left - hand side of @xmath460 .",
    "here @xmath459 ( resp .",
    "@xmath460 ) is called the _ left _",
    "_ right _ ) @xmath33-delimiter of the @xmath33-multiblock , 2 .",
    "the set of all @xmath33-blocks and letters of order @xmath302 located between @xmath459 and @xmath460 .",
    "two @xmath33-multiblocks are called _ consecutive _ if the right @xmath33-delimiter of first @xmath33-multiblock coincides with the left @xmath33-delimiter of the second @xmath33-multiblock .",
    "the @xmath33-multiblock whose left ( resp .",
    "right ) @xmath33-delimiter is the left ( resp .",
    "right ) @xmath33-delimiter of the first ( resp .",
    "second ) @xmath33-multiblock is called their _",
    "concatenation_. a @xmath33-multiblock is called _ empty _ if the left and the right @xmath33-delimiters coincide , in other words , if the set of @xmath33-blocks and letters of order @xmath33 is empty .",
    "a @xmath33-multiblock consisting of a single empty @xmath33-block is not called an empty @xmath33-multiblock .",
    "we need to introduce some convenient notation for @xmath33-multiblocks .",
    "first , a @xmath33-multiblock is determined by two @xmath33-delimiters @xmath459 and @xmath460 , so we can denote it by @xmath461 $ ] .",
    "second , each @xmath33-delimiter is determined by its left or right part , so we can denote the same @xmath33-multiblock by @xmath462 $ ] ( and this notation agrees with the fact that if @xmath459 and @xmath460 are two different @xmath33-delimiters , then the set of @xmath33-blocks and letters of order @xmath302 in this @xmath33-multiblock is the subsequence of the sequence of all @xmath33-blocks and letters of order @xmath302 in @xmath44 that starts at @xmath424 and ends at @xmath442 , inclusively ) . moreover ,",
    "if @xmath463 is not a @xmath33-block , then the occurrence of the form @xmath424 , which is a @xmath33-block or a letter of order @xmath302 , is determined uniquely by the index @xmath464 . however ,",
    "if @xmath463 is a @xmath33-block , then there are two occurrences of the form @xmath424 that we can use as a right part of a @xmath33-delimiter : the empty @xmath33-block @xmath463 and also @xmath465 , which must be a letter of order @xmath302 in this case . in this case",
    "we denote the @xmath33-delimiter whose right part is @xmath463 ( i.  e.  the * _ leftmost _ * @xmath33-delimiter whose right part is of the form @xmath424 ) by @xmath466 , and the @xmath33-delimiter whose right part is @xmath465 ( i.  e.  the * _ rightmost _ * @xmath33-delimiter whose right part is of the form @xmath424 ) by @xmath467 .",
    "if @xmath463 is not a @xmath33-block , we say that @xmath466 and @xmath467 denote the same @xmath33-delimiter , namely , the unique @xmath33-delimiter whose right part is of the form @xmath424 .",
    "similarly , if @xmath468 is a @xmath33-block , then there are two occurrences of the form @xmath442 that are @xmath33-blocks or letters of order @xmath302 : the empty @xmath33-block @xmath468 and a letter @xmath469 of order @xmath302 . and we denote the @xmath33-delimiter whose left part is @xmath468 ( i.  e.  the rightmost @xmath33-delimiter whose left part is of the form @xmath442 ) by @xmath470 , and the @xmath33-delimiter whose left part is @xmath469 ( i.  e.  the leftmost @xmath33-delimiter whose left part is of the form @xmath442 ) by @xmath471 .",
    "if @xmath468 is not a @xmath33-block , then there exists at most one occurrence of the form @xmath442 that can be the left part of a @xmath33-delimiter , and if it exists , we denote the @xmath33-delimiter with this left part by both @xmath471 and @xmath470 .",
    "now we denote the same @xmath33-multiblock as before by @xmath472_k$ ] , where @xmath473 ( resp .",
    "@xmath474 ) is a notation for a @xmath33-delimiter of the form @xmath466 or @xmath467 ( resp .",
    "@xmath471 or @xmath470 ) .",
    "for example , if @xmath76 is a non - empty @xmath33-block , then the @xmath33-multiblock whose set of @xmath33-blocks and letters of order @xmath302 between the @xmath33-delimiters consists of @xmath76 only , is denoted by @xmath475_k$ ] or by @xmath476_k}$ ] ( and two more possibilities ) .",
    "if @xmath59 is a letter of order @xmath302 , then the @xmath33-multiblock that consists of this letter itself if denoted by @xmath477_k$ ] ( and here the signs @xmath478 and @xmath479 are important if @xmath365 or @xmath419 is also a letter of order @xmath302 ) .",
    "let us consider the example of an empty @xmath33-block @xmath418 .",
    "in this case , @xmath480_k$ ] is the @xmath33-multiblock that consists of the empty @xmath33-block @xmath418 only ( the @xmath33-block is located between the two @xmath33-delimiters ) , @xmath481_k$ ] is the empty @xmath33-multiblock `` located directly at the left '' of the @xmath33-block @xmath418 ( the two @xmath33-delimiters coincide and are located at the left - hand side of @xmath418 ) , @xmath482_k$ ] is the empty @xmath33-multiblock `` located directly at the right '' of the empty @xmath33-block , and @xmath483_k$ ] denotes nothing since the two @xmath33-delimiters do not coincide and are not in the correct order .",
    "the @xmath33-multiblocks @xmath481_k$ ] and @xmath480_k$ ] are consecutive ( and their concatenation is @xmath480_k$ ] again ) , and @xmath481_k$ ] and @xmath482_k$ ] are not .    more generally , if we know that there exists an ( empty or nonempty ) @xmath33-block of the form @xmath76 and @xmath380 is a @xmath33-block or letter of order @xmath302 that coincides with @xmath76 or located strictly to the right from @xmath76 , then @xmath484_k$ ] , where @xmath485 is one of the signs @xmath479 and @xmath478 , always denotes a @xmath33-multiblock that includes @xmath76 . and if we know that @xmath59 is a letter of order @xmath302 , and and @xmath380 is a @xmath33-block or letter of order @xmath302 that coincides with @xmath59 or located strictly to the right from @xmath59 , then then @xmath486_k$ ] , where @xmath485 is one of the signs @xmath479 and @xmath478 always denotes a @xmath33-multiblock that begins with @xmath59 as a set of consecutive @xmath33-blocks and letters of order @xmath302 .    for each @xmath33-multiblock one can consider the concatenation of all @xmath33-blocks and letters of order @xmath302 between the two @xmath33-delimiters , this is an occurrence in @xmath44 . as we noted before ,",
    "if the right part of the first @xmath33-delimiter is of the form @xmath424 , and the left part of the second @xmath33-delimiter is of the form @xmath442 , then this concatenation is @xmath487 .",
    "therefore , if @xmath488_k$ ] is a @xmath33-multiblock , where each question mark denotes one of the signs @xmath479 or @xmath478 , then this occurrence in @xmath44 is @xmath76 .",
    "we call it the _ forgetful occurrence _ of the @xmath33-multiblock and denote it by @xmath489_k)$ ]",
    ".    we did not define ( and we are not going to define ) any 0-blocks and 0-delimiters , however , it is convenient to have uniform notation and terminology for 0-multiblocks .",
    "we say that a _ @xmath490-multiblock _ is just a ( possibly empty ) finite occurrence in @xmath44 .",
    "we denote an occurrence @xmath76 by @xmath488_0 $ ] , where each question mark is one of the signs @xmath479 or @xmath478 ( these signs do not play any role here ) .",
    "the notions of consecutiveness and concatenation here are the usual notions of consecutiveness and concatenation for occurrences in @xmath44 .",
    "a 0-multiblock is called empty if it is an occurrence of the empty word .",
    "now we are ready to define descendants of @xmath33-multiblocks .",
    "first , let @xmath59 be a letter of order @xmath302 ( @xmath491 ) .",
    "then the occurrence @xmath398 contains at least one letter of order @xmath302 .",
    "let @xmath62 ( resp .",
    "@xmath492 ) be the leftmost ( resp .",
    "the rightmost ) occurrence of a letter of order @xmath302 in @xmath398 .",
    "then @xmath493_k$ ] is a @xmath33-multiblock that begins with @xmath62 and ends with @xmath492 ( and does not contain @xmath33-blocks of the form @xmath494 or @xmath468 even if these empty occurrences are @xmath33-blocks ) .",
    "we call @xmath493_k$ ] the descendant of the @xmath33-multiblock @xmath477_k$ ] ( which consists of a single letter @xmath59 ) and denote @xmath493_k$ ] by @xmath495_k)$ ] .",
    "[ descendantofperiodic ] if @xmath59 is a periodic letter of order @xmath60 , then @xmath495_k)$ ] consists of a single letter of order @xmath60 , namely , the unique letter of order @xmath60 in @xmath398 .",
    "moreover , since @xmath42 is ( in particular ) weakly 1-periodic , this letter coincides with @xmath59 as an abstract letter .",
    "second , as we have already noted , if @xmath76 is a @xmath33-block ( @xmath303 ) , then @xmath475_k$ ] is always the @xmath33-multiblock that consists of @xmath76 only , independently of whether @xmath76 is empty or no . if @xmath496 , then we say that @xmath497_k)={\\alpha}[<,s\\ldots t,>]_k$ ] ( the @xmath33-block that consists of @xmath380 only ) .",
    "third , let us define the descendants of empty @xmath33-multiblocks ( @xmath498 ) .",
    "an empty @xmath33-multiblock is determined by a delimiter @xmath499 repeated twice , both as the left and as the right delimiter of the @xmath33-multiblock .",
    "if @xmath422 , we say that the descendant of this @xmath33-multiblock is this @xmath33-multiblock itself .",
    "otherwise either @xmath76 or @xmath380 is a @xmath33-block .",
    "if @xmath76 is a @xmath33-block , then @xmath380 is the right border of @xmath76 , and we say that the descendant of @xmath500 $ ] is @xmath501 $ ] . similarly , if @xmath380 is a @xmath33-block , then @xmath76 is its left border , and we say that the descendant of @xmath500 $ ] is @xmath502@xmath503 $ ] .",
    "finally , let @xmath491 , and let @xmath504_k$ ] , where @xmath505 , be a non - empty @xmath33-multiblock .",
    "it consists of consecutive letters of order @xmath302 and ( if @xmath498 ) @xmath33-blocks , and their descendants according to the definitions above are also consecutive @xmath33-multiblocks .",
    "we call the concatenation of these @xmath33-multiblocks the _ descendant _ of @xmath504_k$ ]",
    ". denote it by @xmath506_k)$ ] .",
    "one checks easily using the particular cases of the definition of the descendant of a @xmath33-multiblock above that @xmath506_k)$ ] can be written as @xmath507_k$ ] , where the indices @xmath508 and @xmath509 may differ from @xmath75 and @xmath77 , but the signs @xmath473 and @xmath474 stay the same .",
    "if @xmath409 , we also write @xmath510_k)={\\mathop{\\mathrm{dc}}}_k(\\ldots{\\mathop{\\mathrm{dc}}}_k({\\alpha}[\\mathfrak x , i\\ldots j,\\mathfrak y]_k)\\ldots)$ ] , where @xmath511 is repeated @xmath118 times . we call @xmath510_k)$ ] the _ @xmath118-th superdescendant _ of @xmath504_k$ ]",
    ". observe that if @xmath512 , then @xmath513_0)$ ] is just @xmath514_0)$ ] , but it will be useful to have @xmath511 as a uniform notation later , for example , when we will define atoms inside blocks .",
    "the descendants of two consecutive @xmath33-multiblocks ( @xmath491 ) are always consecutive , even if they contain several @xmath33-blocks and letters of order @xmath302 or one or two of them is empty .",
    "consider the following example : let @xmath515 , @xmath516 , @xmath517 , @xmath518 , @xmath519 .",
    "the orders of letters @xmath520 are @xmath521 , respectively , and @xmath71 is a preperiodic letter , all other letters are periodic .",
    "this morphism @xmath42 is strongly 1-periodic , @xmath522 , so @xmath42 is also a strongly 1-periodic morphism with long images .",
    "consider the corresponding pure morphic sequence @xmath523 and a 1-multiblock @xmath524_1 $ ] consisting of a single letter @xmath71 of order @xmath525 . here",
    "@xmath434 is an empty 1-block , and @xmath435 is also an empty 1-block , but we do not include them into the 1-multiblock .",
    "we have @xmath526_1)={\\alpha}[>,2\\ldots 4,<]_1 $ ] ( @xmath527 ) and @xmath528_1)={\\mathop{\\mathrm{dc}}}_1({\\alpha}[>,2\\ldots 4,<]_1)={\\alpha}[>,7\\ldots 11,<]_1 $ ] ( @xmath529 ) .",
    "if we include both @xmath434 and @xmath435 into the 1-multiblock and consider a 1-multiblock @xmath530_1 $ ] , we will get @xmath531_1)={\\alpha}[<,2\\ldots 6,>]_1 $ ] ( @xmath532 ) and @xmath533_1)={\\mathop{\\mathrm{dc}}}_1({\\alpha}[<,2\\ldots 6,>]_1)={\\alpha}[<,5\\ldots 15,>]_1 $ ] ( @xmath534 ) .",
    "[ inclusionsurvivesbase ] if @xmath1 , @xmath507_{k-1}$ ] is a @xmath535-multiblock consisting of a single letter of order @xmath417 or ( if @xmath536 ) a single @xmath535-block , @xmath380 is a suboccurrence of a @xmath33-block @xmath76 , and @xmath537_{k-1})={\\alpha}[\\mathfrak x , s'\\ldots t',\\mathfrak y]_{k-1}$ ] , then @xmath538 is a suboccurrence of @xmath539 .",
    "the claim follows directly from the definitions of the descendant of a @xmath33-block and of a @xmath535-multiblock consisting of a single @xmath535-block or of a single letter of order @xmath540 .",
    "[ inclusionsurvives ] if @xmath1 , @xmath507_{k-1}$ ] is a @xmath535-multiblock , @xmath380 is a suboccurrence of a @xmath33-block @xmath76 , and @xmath537_{k-1})={\\alpha}[\\mathfrak x , s'\\ldots t',\\mathfrak y]_{k-1}$ ] , then @xmath538 is a suboccurrence of @xmath539 .",
    "now we define _ atoms _ inside @xmath33-blocks ( @xmath1 ) .",
    "let @xmath541 be an evolution of @xmath33-blocks .",
    "the @xmath118th left and right atoms exist in a @xmath33-block @xmath542 iff @xmath543 .",
    "we will also define the zeroth atom , but there will be only one zeroth atom in each @xmath33-block @xmath542 , it will not be left or right .",
    "first , define the @xmath118-th atoms inside the @xmath33-block @xmath388 ( @xmath544 ) .",
    "let @xmath545 .",
    "its ancestor @xmath546 is a @xmath33-block , so it is a concatenation of letters of order @xmath33 and ( if @xmath536 ) @xmath535-blocks , and we can consider a @xmath535-multiblock @xmath547_{k-1}$ ] . if @xmath548 or @xmath549 is a @xmath535-block , we include it into the @xmath535-block , so we are considering a @xmath535-block , which starts with a @xmath535-block and ends with a @xmath535-block .",
    "now consider a @xmath535-block @xmath550_{k-1})$ ] and denote it by @xmath551_{k-1}$ ] .",
    "by corollary [ inclusionsurvives ] , @xmath442 is a suboccurrence of @xmath76 .",
    "it also follows from the definition of the descendant of a @xmath535-block that @xmath552 is a suboccurrence of @xmath442 and that @xmath553 and @xmath554 are letters of order @xmath540 , more precisely , @xmath553 ( resp .",
    "@xmath554 ) is the rightmost ( resp .",
    "the leftmost ) letter of order @xmath540 in @xmath555 ( resp .  in @xmath556 ) .",
    "the @xmath535-multiblock @xmath557_{k-1}$ ] that comes from the image of the left border of the ancestor , is called _",
    "the @xmath118th left atom _ of the block and is denoted by @xmath558 .",
    "[ atomsimplestructleft ] if @xmath536 , then this @xmath535-multiblock is either empty ( does not contain any letters of order @xmath540 or @xmath33-blocks , even empty ones ) if @xmath559 , or it begins with a ( possibly empty ) @xmath535-block of the form @xmath560 and ends with a single letter @xmath553 of order @xmath33 if @xmath561 . if @xmath345 , then @xmath553 is the rightmost letter in @xmath555 , and @xmath562 is an empty occurrence in @xmath44 if and only if @xmath559 if and only if the rightmost letter in @xmath555 is of order @xmath563 .",
    "similarly , the @xmath535-multiblock @xmath564_{k-1 } = { \\mathop{\\mathrm{ra}}}_{k , l}({{{\\alpha}_{i\\ldots j}}})$ ] is called _ the @xmath118-th right atom _ of the @xmath33-block @xmath76 .",
    "[ atomsimplestructright ] if @xmath536 , then it is either an empty @xmath535-multiblock if @xmath454 , or it begins with a single letter @xmath554 of order @xmath33 and ends with a ( possibly empty ) @xmath535-block of the form @xmath565 if @xmath456 .",
    "if @xmath345 , then @xmath554 is the leftmost letter in @xmath556 , and @xmath566 is an empty occurrence in @xmath44 if and only if @xmath454 if and only if the leftmost letter in @xmath556 is of order @xmath563 .",
    "[ kblockstruct ] illustrates this construction .",
    "-block : @xmath553 and @xmath554 are letters of order @xmath33 , all letters in the grayed areas are of order @xmath567 . ]    then , if @xmath568 , the @xmath118th left and right atoms of @xmath542 are defined as follows : @xmath569 , @xmath570 .",
    "then , using remarks [ atomsimplestructleft ] and [ atomsimplestructright ] and the definitions of the descendant of a @xmath535-block or of a @xmath535-multiblock that consists of a single letter of order @xmath540 , we note the following :    [ allatomsimplestruct ] if @xmath536 , then each left ( resp .",
    "right ) atom in any @xmath33-block is either an empty @xmath535-multiblock ( it does not contain any letters of order @xmath540 or @xmath33-blocks , even empty ones ) , or it begins with a ( possibly empty ) @xmath535-block ( resp",
    ".  with a a single letter of order @xmath33 ) and ends with a single letter of order @xmath33 ( resp .  with a ( possibly empty ) @xmath535-block ) .    finally , if @xmath571 , then the zeroth atom of @xmath397 is @xmath572_{k-1}$ ] , i.  e.  it is the largest ( including all possible empty @xmath535-blocks if @xmath536 ) @xmath535-multiblock whose forgetful occurrence is @xmath397 .",
    "the zeroth atoms of other blocks in the evolution are defined by @xmath573 .",
    "[ zerothatomsimplestruct ] if @xmath536 , then each zeroth atom begins with a ( possibly empty ) @xmath535-block and ends with a ( possibly empty ) @xmath535-block .",
    "however , these two @xmath535-blocks may be the same , i.  e.  the zeroth atom can consist of a single @xmath535-block .",
    "the zeroth atom is never empty as a @xmath535-multiblock , i.  e.  it contains at least one ( maybe , empty ) @xmath535-block , but the forgetful occurrence of the zeroth atom may be empty .",
    "therefore , if @xmath574 , then @xmath475_{k-1}$ ] ( the largest @xmath535-multiblock whose forgetful occurrence is @xmath542 ) splits into the concatenation of all atoms in @xmath542 : @xmath475_{k-1}= { \\mathop{\\mathrm{la}}}_{k , m}(\\mathcal e_m){\\mathop{\\mathrm{la}}}_{k , m-1}(\\mathcal e_m)\\ldots{\\mathop{\\mathrm{la}}}_{k,1}(\\mathcal e_m){\\mathop{\\mathrm{a}}}_{k,0}(\\mathcal e_m ) { \\mathop{\\mathrm{ra}}}_{k,1}(\\mathcal e_m)\\ldots{\\mathop{\\mathrm{ra}}}_{k , m-1}(\\mathcal e_m){\\mathop{\\mathrm{ra}}}_{k , m}(\\mathcal e_m)$ ] .",
    "[ lastatomlocation ] let @xmath575 and @xmath576 .",
    "consider an occurrence @xmath577 in @xmath44 .",
    "let @xmath365 be the rightmost occurrence of a letter of order @xmath302 in @xmath577 and let @xmath62 be the rightmost occurrence of a letter of order @xmath417 in @xmath577",
    ".    then @xmath578 and @xmath579 as occurrences in @xmath44 .",
    "the first equality is proved directly by induction on @xmath275 using the definition of the descendant of a @xmath33-block and the fact that the image of a letter of order @xmath271 consists of letters of order @xmath271 only .    the second equality for @xmath580 it follows directly from the definitions of the @xmath581th atom and of the descendant of a @xmath535-block ( see remark [ atomsimplestructleft ] ) .",
    "the second equality in general will follow from the first one and the fact that either @xmath582 is an empty @xmath535-multiblock and @xmath440 , or @xmath582 is not empty , and @xmath62 is the rightmost occurrence of a letter of order @xmath33 in its forgetful occurrence .",
    "we already know this for @xmath580 , to prove this in general , we use induction on @xmath275 . by the definition of a descendant of a single letter @xmath583 of order @xmath540 ,",
    "the rightmost letter in the forgetful occurrence of @xmath584_{k-1})$ ] is the rightmost letter of order @xmath540 in @xmath585 .",
    "therefore , if @xmath582 is not an empty @xmath535-multiblock and the rightmost letter of its forgetful occurrence is @xmath62 , a letter of order @xmath33 , then @xmath586 is also a nonempty @xmath33-multiblock , and the rightmost letter in its forgetful occurrence is the rightmost letter of order @xmath540 in @xmath587 . by the induction hypothesis , @xmath62 is the rightmost occurrence of a letter of order @xmath417 in @xmath577 , so , since images of letters of order @xmath588 consist of letters of order @xmath588 only if @xmath536 , we get that the rightmost occurrence of a letter of order @xmath540 in @xmath587 and rightmost occurrence of a letter of order @xmath540 in @xmath589 coincide .",
    "if @xmath582 is an empty @xmath33-multiblock , then @xmath590 , and ( by the induction hypothesis ) the rightmost occurrence of a letter of order @xmath417 in @xmath577 is @xmath591 .",
    "now it suffices to use the claim for @xmath592 instead of @xmath118 and 1 instead of @xmath275 , but we have already considered this case before .",
    "let @xmath575 and @xmath576 .",
    "consider an occurrence @xmath577 in @xmath44 .",
    "let @xmath419 be the leftmost occurrence of a letter of order @xmath302 in @xmath577 and let @xmath62 be the leftmost occurrence of a letter of order @xmath417 in @xmath577",
    ".    then @xmath593 and @xmath594 as occurrences in @xmath44 .",
    "the proof is completely symmetric to the proof of the previous lemma .",
    "[ atomsperiodicitybig ] if @xmath595 and @xmath596 , then @xmath597 is the same abstract word as @xmath598 and @xmath599 is the same abstract word as @xmath600 . in other words ,",
    "if @xmath595 and @xmath601 , then the abstract words @xmath597 and @xmath599 do not depend on @xmath118 .    since @xmath595 and @xmath42 is a strongly 1-periodic morphism , @xmath602 as abstract letters",
    "denote this abstract letter by @xmath71 .",
    "denote @xmath603 , this is a finite abstract word .",
    "let @xmath604 ( resp .",
    "@xmath605 ) be the rightmost occurrence of a letter of order @xmath302 ( resp .",
    "@xmath417 ) in @xmath45 . by the previous lemma , @xmath606 as abstract words and @xmath607 as abstract words .",
    "the proof for right atoms is analogous .",
    "[ atomsperiodicitysmallleft ] if @xmath595 and @xmath596 , then @xmath608 is the same abstract word as @xmath609 . moreover , if @xmath610 , @xmath611 , @xmath612 , and @xmath613 , then @xmath614 .",
    "in other words , if @xmath595 and @xmath601 , then @xmath608 does not depend on @xmath118 , as an abstract word , and the numbers of letters in @xmath44 between @xmath392 and @xmath608 also does not depend on @xmath118 .",
    "if @xmath615 , then this is just the previous corollary .",
    "if @xmath616 , then by the previous corollary , @xmath597 is the same abstract word as @xmath598 , denote this abstract word by @xmath45 , and @xmath617 is the same abstract word as @xmath618 , denote this abstract word by @xmath83 .",
    "clearly , @xmath83 is a prefix of @xmath45 , so write @xmath619 for some finite abstract word @xmath172 .",
    "but then @xmath620 as abstract words , @xmath621 as abstract words , @xmath622 and @xmath623",
    ".    [ atomsperiodicitysmallright ] if @xmath595 and @xmath596 , then @xmath624 is the same abstract word as @xmath625",
    ". moreover , if @xmath610 , @xmath626 , @xmath612 , and @xmath627 , then @xmath628 . in other words ,",
    "if @xmath595 and @xmath601 , then @xmath624 does not depend on @xmath118 , as an abstract word , and the numbers of letters in @xmath44 between @xmath624 and @xmath392 also does not depend on @xmath118 .",
    "the proof is completely symmetric to the proof of the previous corollary .",
    "observe that the condition @xmath595 can not be omitted since in the proof of corollary [ atomsperiodicitybig ] we used the fact that @xmath602 as abstract letters .",
    "moreover , @xmath629 is a @xmath535-multiblock contained in the image of @xmath399 , and @xmath630 for @xmath631 is contained in the image of @xmath392 , a letter which does not have to be equal to @xmath399 , so the letters of order @xmath33 and ( if @xmath536 ) @xmath535-blocks in @xmath629 and @xmath630 may be different . and the first left atoms of other @xmath33-blocks in the evolution are superdescendants of @xmath629 , while the @xmath118th atoms of other @xmath33-blocks in the evolution are superdescendants of @xmath630 for @xmath631 .",
    "so , the @xmath535-blocks in @xmath632 may belong to totally different evolutions than @xmath535-blocks in @xmath633 for @xmath631 belong to , while the @xmath535-blocks in @xmath634 and in @xmath535-blocks in @xmath635 by corollary [ atomsperiodicitysmallleft ] belong to the same evolutions if evolutions are understood as sequences of abstract words ( as in lemma [ finite - number - of - evolutions ] ) .",
    "these observations and these corollaries justify the following definitions .",
    "if @xmath393 , we call the concatenation of the @xmath535-multiblocks @xmath636 the _ core _ of @xmath388 .",
    "the core of @xmath388 is denoted by @xmath637 . if @xmath595 , the concatenation of the @xmath535-multiblocks @xmath638 ( resp .",
    "@xmath639 ) is called the _ left ( resp .",
    "right ) component_.    by remark [ atomsimplestructleft ] , @xmath630 is either an empty @xmath535-multiblock , or it contains ( actually , the rightmost letter of its forgetful occurrence is ) a letter of order @xmath33 . by corollary [ atomsperiodicitysmallleft ] , either for all @xmath631 @xmath630 is an empty @xmath535-multiblock , or for all @xmath631 @xmath630 contains a letter of order @xmath33 .",
    "so , if each atom @xmath630 for @xmath631 contains a letter of order @xmath33 , we say that _ case i holds for @xmath385 at the left_. if all atoms @xmath630 for @xmath631 are empty @xmath535-blocks , we say that _ case ii holds for @xmath385 at the left_. similarly , cases i and ii are defined for right atoms .",
    "these cases happen independently at right and at left , in any combination .",
    "the left ( resp .",
    "right ) component is empty if and only if case ii holds at the left ( resp .  at the right ) . if case ii holds both at the left and at the right for an evolution @xmath385 of @xmath33-blocks and @xmath393 , then @xmath640 .",
    "note that if @xmath1 , then @xmath33-blocks may exist by definition even if all letters in @xmath44 have either order @xmath371 , or order @xmath68 ( see also lemma [ splitconcatenation ] ) .",
    "in this situation , case ii holds for all evolutions of @xmath33-blocks both at the left and at the right .",
    "now we will consider 1-blocks more accurately .",
    "the fact that @xmath42 is a strongly 1-periodic morphism makes the structure of a 1-block quite easy . during this section",
    ", it will be useful to keep in mind that 0-multiblocks are just occurrences in @xmath44 and their descendants are just their images under @xmath42 .",
    "[ oneblockstructlemmai ] let @xmath385 be an evolution of 1-blocks . then",
    ":    if @xmath631 , then @xmath641 does not depend on @xmath118 as an abstract word and consists of periodic letters only .",
    "if @xmath631 , then @xmath642 and @xmath643 do not depend on @xmath118 as abstract words .    if @xmath631 and @xmath576 , then @xmath644 and @xmath645 as abstract words depend neither on @xmath118 nor on @xmath275 .",
    "they equal @xmath646 and @xmath647 as abstract words , respectively and consist of periodic letters of order 1 only .    since @xmath42 is ( in particular ) weakly 1-periodic , the image of a preperiodic letter of order 1 consists of periodic letters of oder 1 only .",
    "the image of a periodic letter of order 1 is a ( single ) periodic letter of order 1 .",
    "we have @xmath648 .",
    "so , if @xmath631 , all letters in @xmath649 are periodic letters of order 1 . by weak 1-periodicity",
    "again , @xmath650 as abstract words .",
    "but @xmath651 , so we have the first claim .",
    "the second claim is just a particular case of corollaries [ atomsperiodicitysmallleft ] and [ atomsperiodicitysmallright ] . for the third claim ,",
    "we write @xmath652 . using the second claim",
    ", we see that it is sufficient to prove that @xmath653 does not depend on @xmath275 as an abstract word if @xmath576 ( for @xmath580 it clearly equals @xmath646 ) . again , since @xmath42 is weakly 1-periodic , @xmath653 consists of periodic letters of order 1 only if @xmath576 , and , by weak 1-periodicity again , @xmath654 as an abstract words if @xmath576 .",
    "the computation for the right atoms is the same .",
    "after we have this lemma , we can give the following definitions :    given an evolution @xmath385 of 1-blocks , we call the abstract word @xmath641 for any @xmath631 the _ core of @xmath385 _ and denote it by @xmath655 .",
    "the abstract word @xmath642 ( resp .",
    "@xmath643 ) for any @xmath631 is called the _ left ( resp .",
    "right ) preperiod of @xmath385 _ and is denoted by @xmath656 ( resp .  by @xmath657 ) .",
    "the @xmath118th left ( resp .  right ) atom of a particular 1-block @xmath388 , where @xmath631 is called the _ left ( resp .",
    "right ) preperiod of @xmath388 _ and is denoted by by @xmath658 ( resp .  by @xmath659 .",
    "the abstract word @xmath644 ( resp .",
    "@xmath645 ) for any @xmath631 and @xmath576 is called the _ left ( resp .",
    "right ) period of @xmath385 _ and is denoted by @xmath660 ( resp .  by @xmath661 ) . by lemma [ oneblockstructlemmai ] , it equals @xmath662 ( resp .",
    "@xmath663 ) . if @xmath631 , the occurrence between @xmath658 and @xmath641 ( resp .  between @xmath641 and @xmath659 )",
    "is called the _ left ( resp .",
    "right ) regular part _ of @xmath388 and is denoted by @xmath664 ( resp .  by @xmath665 ) . if @xmath666 , it is an occurrence of the empty word , and if @xmath667 , it is the concatenation of left atoms @xmath668 ( resp .  of right atoms @xmath669 )",
    ", all these atoms equal @xmath660 ( resp .",
    "@xmath661 ) as abstract words .    using this terminology",
    ", we formulate the following corollary .",
    "if @xmath385 is an evolution of 1-blocks and @xmath631 , then the 1-block @xmath388 equals the following abstract word : @xmath670 , where @xmath660 and @xmath661 are repeated @xmath671 times each .",
    "@xmath656 ( resp .",
    "@xmath657 ) is an empty word if and only if case ii holds at the left ( resp .  at the right ) for @xmath385 .",
    "@xmath660 ( resp .",
    "@xmath661 ) is an empty word if and only if case ii holds at the left ( resp .  at the right ) for @xmath385 .",
    "the left ( resp .",
    "right ) regular part of @xmath388 consists of periodic letters of order 1 only .",
    "it is an empty word if and only if case ii holds at the left ( resp .  at the right ) for @xmath385 or @xmath666 .",
    "the terminology we introduced and the structure of a 1-block is illustrated by fig .",
    "[ onestruct ] .    .",
    "]    we call a 1-block @xmath388 _ stable _ if @xmath667 , otherwise it is called",
    "_ unstable_. if a 1-block is stable , then its left and right components , preperiods and regular parts , as well as its core , are defined .",
    "the following corollary about lengths of subwords inside 1-blocks follows directly from what we already know about the structure of 1-blocks and from corollary [ finite - number - of - evolutions ] .",
    "[ oneblocklengths ] the lengths of all unstable 1-blocks are bounded by a single constant that depends on @xmath3 and @xmath42 only .",
    "the lengths of all cores and left and right preperiods of all stable 1-blocks are bounded by a single constant that depends on @xmath3 and @xmath42 only .    the the left ( resp .",
    "right ) regular part of a stable 1-block @xmath388 is a nonempty word if and only if case i holds at the left ( resp .  at the right ) .",
    "moreover , it is completely @xmath660-periodic ( resp .",
    "@xmath661-periodic ) , and the length of the left ( resp .",
    "right ) regular part equals @xmath672 ( resp .",
    "@xmath672 ) .    in particular , the length of the left ( resp .",
    "right ) regular part of a 1-block @xmath388 , as well as the length of the left ( resp .",
    "right ) component is either @xmath673 if case i holds at the left ( resp .  at the right ) , or @xmath490 if case ii holds at the left ( resp .",
    "at the right ) .",
    "the length of the whole 1-block @xmath388 is always @xmath674 .",
    "it is @xmath673 if case i holds at the left or at the right , and is @xmath23 if case ii holds both at the left and at the right .",
    "all constants in the @xmath675- and @xmath676-notations in this corollary depend on @xmath3 and @xmath42 only .",
    "now let us recall the definition of a strongly 1-periodic morphism with long images .",
    "let @xmath385 be an evolution of 1-blocks as we already noted , @xmath677 for all @xmath575 .",
    "moreover , suppose now that @xmath393 and @xmath678 as an abstract letter",
    ". then @xmath390 has a suffix @xmath679 .",
    "hence , the word @xmath45 we used in the definition of a final period for @xmath680 is @xmath656 , and @xmath681 by lemma [ oneblockstructlemmai ] ( and by the definitions of the left preperiod and the left period of an evolution ) .",
    "so , the following lemma follows now directly from lemma [ finalperiodsarecomplete ] and from the definition of a a strongly 1-periodic morphism with long images .",
    "[ regpartabslargeone ] if @xmath385 is an evolution of 1-blocks and case i holds at the left ( resp .  at the right ) , then @xmath682 ( resp .",
    "@xmath683 ) has a minimal complete period @xmath47 , and @xmath47 is a final period . @xmath684 and @xmath685 .    if @xmath388 is a stable 1-block and case i holds at the left ( resp .",
    "at the right ) for @xmath385 , then @xmath47 is the minimal complete period of @xmath686 ( resp .",
    "@xmath687 ) . @xmath688 and @xmath689 .",
    "the core of a stable 1-block is called its ( unique ) _ prime central kernel_. it is also called its ( unique ) _ composite central kernel_. if @xmath385 is an evolution of 1-blocks and @xmath667 ( so that @xmath388 is stable ) , then the prime ( resp .",
    "composite ) central kernel of @xmath402 is called the _ descendant _ of the prime ( resp .",
    "composite ) central kernel of @xmath388 .",
    "now we are going to consider @xmath33-blocks more accurately . in this section",
    "we mostly focus on @xmath33-blocks for @xmath536 , referring to the previous section for similar results for @xmath345 . through this section",
    ", we will give examples based on @xmath690 and on the following morphism @xmath42 : @xmath691 , @xmath692 , @xmath693 , @xmath694 , @xmath695 , @xmath696 , @xmath697 , @xmath698 , @xmath699 , @xmath700 , @xmath701 .",
    "then @xmath702 . here",
    "@xmath40 is a periodic letter of order 4 , @xmath703 is a preperiodic letter of order 3 , @xmath71 is a periodic letter of order 3 , @xmath704 and @xmath705 are preperiodic letters of order 2 , @xmath225 and @xmath235 are periodic letters of order 2 , @xmath706 and @xmath707 are preperiodic letters of order 1 , and @xmath236 and @xmath708 are periodic letters of order 1 .",
    "consider an evolution @xmath385 of 2-blocks , whose origin is @xmath709 .",
    "a 2-block @xmath388 where @xmath118 is large enough looks as follows : @xmath710 here case i holds at the right and case ii holds at the left ( and the left component is empty ) .",
    "intervals denoted by @xmath711 may contain many intervals denoted by @xmath712 the ( forgetful occurrence of ) the zeroth atom is @xmath713 , the ( forgetful occurrence of ) the @xmath275th right atom , where @xmath714 is of the form @xmath715 , where @xmath236 is repeated @xmath716 times , the ( forgetful occurrence of ) the @xmath717th right atom is @xmath718 , and the ( forgetful occurrence of ) the @xmath118th right atom is @xmath704 , the @xmath118th atom itself also includes the empty 1-block located immediately to the right of this @xmath704 .",
    "first , let us define _",
    "stable @xmath33-blocks_. a @xmath33-block is called _ stable _ if its evolutional sequence number is at least @xmath719 .",
    "( for @xmath345 we get exactly the definition from the previous section . )",
    "let @xmath541 be an evolution of @xmath33-blocks . if @xmath388 is a stable @xmath33-block ( i.  e.  if @xmath720 ) , the concatenation of atoms @xmath721 ( resp .",
    "@xmath722 ) is called the _ left ( resp .",
    "right ) preperiod _ of @xmath388 and is denoted by @xmath723 ( resp .  by @xmath724 ) .",
    "the concatenation of all atoms between the left preperiod and the core ( resp .  between the core and the right preperiod ) , i.  e.  the concatenation @xmath725 ( resp .",
    "@xmath726 ) is called the _ left ( resp",
    ".  right ) regular part _ of @xmath388 .",
    "it is denoted by @xmath727 ( resp .  by @xmath728 ) .",
    "again , these definitions for @xmath345 coincide with the definition from the previous section .",
    "the following remark is a particular case of corollary [ atomsperiodicitybig ] .",
    "[ preperiodfixed ] if @xmath388 is a stable @xmath33-block , then @xmath729 and @xmath730 do not depend on @xmath118 as abstract words if @xmath720 .",
    "so , we call the abstract word @xmath729 ( resp .",
    "@xmath730 ) for any @xmath720 _ the left ( resp .",
    "right ) preperiod of @xmath385 _ and denote it by @xmath731 ( resp .  by @xmath732 ) . in the example",
    "above , @xmath731 is empty since case ii holds for @xmath385 at the left , and @xmath733 .",
    "[ finitelrprep ] the lengths of all left and right preperiods of all evolutions of @xmath33-blocks arising in @xmath44 are bounded by a single constant that depends on @xmath3 , @xmath42 , and @xmath33 only .",
    "in particular , only finitely many abstract words can equal left and right preperiods of evolutions of @xmath33-blocks arising in @xmath44 .    by corollary [ finite - number - of - evolutions ]",
    ", only finitely many sequences of abstract words can be evolutions in @xmath44 .",
    "therefore , there exists a single constant @xmath734 that depends on @xmath3 , @xmath42 and @xmath33 only such that if @xmath385 is an evolution of @xmath33-blocks , then @xmath735 . by remark [ preperiodfixed ] ,",
    "@xmath731 and @xmath732 are subwords of @xmath736 , so @xmath737 and @xmath738 .",
    "note that we _",
    "* do not * _ claim that if @xmath385 and @xmath739 are two evolutions of @xmath33-blocks such that @xmath740 as an abstract word for all @xmath575 , then @xmath741 and @xmath742 .",
    "now let us prove some facts about atoms inside the regular parts of a stable @xmath33-block ( or about atoms of the form @xmath743 , where @xmath275 is large enough ) .",
    "[ klettersbecomeperiodic ] let @xmath385 be an evolution of @xmath33-blocks .",
    "if @xmath393 and @xmath576 , then all letters of order @xmath33 in @xmath743 ( resp .  in @xmath744 )",
    "are periodic , and there is at least one such letter if case i holds at the left ( resp .  at the right ) .",
    "if @xmath576 , then all letters of order @xmath33 in @xmath745 are periodic .    for @xmath345",
    "we already know this by lemma [ oneblockstructlemmai ] .",
    "suppose that @xmath536 . by the definition of the descendant of a ( @xmath535-multiblock that consists of a ) single letter @xmath59 of order @xmath540 , it is a @xmath535-multiblock that consists of @xmath535-blocks and letters of order @xmath540 inside @xmath398 .",
    "hence , all letters of order @xmath33 in @xmath746 and in @xmath747 ( @xmath393 ) are periodic since they are contained in the images of letters of order @xmath33 in @xmath630 and in @xmath748 . if case i holds at the left ( resp .  at the right ) , then there is at least one letter of order @xmath33 in in @xmath630 ( resp .  in @xmath748 ) , and its descendant gives at least one letter of order @xmath33 for @xmath746 ( resp .  for @xmath747 ) . also , all letters of order @xmath33 in @xmath749 are periodic since they are contained in the images of letters of order @xmath33 in @xmath750 .",
    "now the claim follows from remark [ descendantofperiodic ] and the definition of a left ( right , zeroth ) atom .",
    "[ amountkletterssame ] let @xmath385 be an evolution of @xmath33-blocks . if @xmath595 and @xmath576 , then the amounts of letters of order @xmath33 in @xmath743 and in @xmath744 do not depend on @xmath118 and @xmath275 .",
    "the amounts of letters of order @xmath33 in @xmath751 , in @xmath752 and in @xmath745 do not depend on @xmath275 ( but may differ from the amounts of letters of order @xmath33 in @xmath743 and in @xmath744 for @xmath595 ) .    for @xmath345",
    "this follows from lemma [ oneblockstructlemmai ] .",
    "if @xmath536 , then the fact that these amounts do not depend on @xmath275 follows now from remark [ descendantofperiodic ] , and the fact that they do not depend on @xmath118 if @xmath595 follows from corollaries [ atomsperiodicitysmallleft ] ( for left atoms ) and [ atomsperiodicitysmallright ] ( for right atoms ) .    [ amountkminusoneblockssame ]",
    "let @xmath385 be an evolution of @xmath33-blocks , where @xmath536 .",
    "if @xmath595 and @xmath576 , then the amounts of ( possibly empty ) @xmath535-blocks in @xmath743 and in @xmath744 do not depend on @xmath118 and @xmath275 and equal the amounts of letters of order @xmath33 in @xmath743 and in @xmath744 , respectively .",
    "the amounts of ( possibly empty ) @xmath535-blocks in @xmath751 and in @xmath752 do not depend on @xmath275 and equal the amounts of letters of order @xmath33 in @xmath751 and in @xmath752 , respectively ( but may differ from the amounts of @xmath535-blocks in @xmath743 and in @xmath744 for @xmath595 ) .",
    "recall that by remark [ allatomsimplestruct ] , a left ( resp .",
    "right ) atom is either an empty @xmath535-multiblock , or it begins with a ( possibly empty ) @xmath535-block ( resp .  with a a single letter of order @xmath33 ) and ends with a single letter of order @xmath33 ( resp .  with a ( possibly empty ) @xmath535-block ) .",
    "it follows from the general definition of a @xmath535-multiblock that @xmath535-blocks and letters of order @xmath540 always alternate inside a @xmath535-multiblock .",
    "hence , the amount of letters of order @xmath33 in a left ( resp .",
    "right ) atom is always the same as the amount of @xmath535-blocks in it .",
    "[ amountkminusoneblockssamezero ] let @xmath385 be an evolution of @xmath33-blocks , where @xmath536 .",
    "if @xmath576 , then the amount of ( possibly empty ) @xmath535-blocks in @xmath745 does not depend on @xmath275 and equals one plus the amount of letters of order @xmath33 in @xmath745 .    by remark [ zerothatomsimplestruct ] , the zeroth atom either consists of a single ( possibly empty ) @xmath535-block , or it begins with a ( possibly empty ) @xmath535-block and ends with another ( possibly empty ) @xmath535-block .",
    "again , it follows from the general definition of a @xmath535-multiblock that @xmath535-blocks and letters of order @xmath540 always alternate inside a @xmath535-multiblock .",
    "hence , the amount of @xmath535-blocks in the zeroth atom always equals one plus the amount of letters of order @xmath33 in it .",
    "[ evolseqnolarge ] let @xmath385 be an evolution of @xmath33-blocks , where @xmath536 .",
    "let @xmath576 .",
    "let @xmath76 be a @xmath535-block in a left atom @xmath743 , in a right atom @xmath744 , or in a zeroth atom @xmath745 .",
    "then the evolutional sequence number of @xmath76 is either @xmath275 or @xmath753 .",
    "observe first that all @xmath535-blocks in @xmath630 and in @xmath748 are origins since by lemma [ lastatomlocation ] they are contained in @xmath754 and @xmath755 , respectively , and can not be prefixes or suffixes of @xmath754 and @xmath755 , respectively .",
    "also , all @xmath535-blocks in @xmath750 are origins since @xmath756 is an origin , so it is contained in the image of a single letter and can not be a prefix or a suffix there .",
    "now , let @xmath76 be a @xmath535-block in @xmath757 , in @xmath758 , or in @xmath759 .",
    "then there are two possibilities for @xmath76 : the first possibility is that @xmath76 is the descendant of a @xmath535-block in @xmath630 , in @xmath748 , or in @xmath750 , respectively , and then the evolutional sequence number of @xmath76 is 1 .",
    "the second possibility is that @xmath76 is a suboccurrence of the descendant of a letter @xmath583 of order @xmath33 in @xmath630 , in @xmath748 , or in @xmath750 , respectively .",
    "it follows from the definition of the descendant of a @xmath535-multiblock consisting of a single letter of order @xmath540 only , that in this case @xmath76 is a suboccurrence of @xmath585 , and it can not be a prefix or a suffix of @xmath585 .",
    "then @xmath76 is an origin , and its evolutional sequence number is 0 .",
    "finally , we do induction on @xmath275 . by lemma [ klettersbecomeperiodic ] ,",
    "all letters of order @xmath33 in @xmath743 , in @xmath744 , and in @xmath745 are periodic .",
    "then it follows from remark [ descendantofperiodic ] that all @xmath535-blocks in @xmath760 , in @xmath761 , and in @xmath762 are the descendants of @xmath535-blocks in @xmath743 , in @xmath744 , and in @xmath745 , respectively .",
    "so , if @xmath76 is a @xmath535-block in @xmath760 , in @xmath761 , or in @xmath762 , then @xmath763 is a @xmath535-block in @xmath743 , in @xmath744 , or in @xmath745 . by induction hypothesis ,",
    "the evolutional sequence number of @xmath763 is @xmath275 or @xmath753 , so the evolutional sequence number of @xmath76 is @xmath764 or @xmath275 .",
    "note that a @xmath535-block with evolutional sequence number @xmath753 can appear in the @xmath118th atom of @xmath765 only if there is a letter @xmath71 of order @xmath33 in the @xmath118th atom of @xmath388 whose image contains several letters of order @xmath33 .",
    "in particular , @xmath71 must be preperiodic .",
    "in our example of an evolution of @xmath766-blocks , the @xmath118th atoms of blocks @xmath388 contain preperiodic letters of order 1 , but their images contain only one letter of order 1 , so in our example , each @xmath535-block the @xmath118th atom of @xmath765 has evolutional sequence number @xmath275 , not @xmath753 .",
    "[ regpartstablekminusone ] if @xmath388 is a stable @xmath33-block , where @xmath536 , then all letters of order @xmath33 in @xmath727 , in @xmath728 and in @xmath637 are periodic , and all @xmath535-blocks in @xmath727 , in @xmath728 and in @xmath637 are stable .",
    "[ caseoneexistsleft ] let @xmath385 be an evolution of @xmath33-blocks ( @xmath536 ) such that case i holds at the left .",
    "let @xmath595 and @xmath767 .",
    "there exists a @xmath535-block @xmath76 in @xmath743 such that case i holds at the left or at the right for the evolution of @xmath76 .    by lemma [ klettersbecomeperiodic ]",
    ", there is at least one letter of order @xmath33 in @xmath743 , and all these letters of order @xmath33 are periodic .",
    "let us first assume that there are at least two periodic letters of order @xmath33 in @xmath743 .",
    "let @xmath583 be the leftmost of these letters .",
    "then by remark [ allatomsimplestruct ] , @xmath743 contains a @xmath535-block of the form @xmath768 and a @xmath535-block of the form @xmath769 .",
    "we have @xmath770 and @xmath771 . by lemma [ evolseqnolarge ] ,",
    "the evolutional sequence numbers of these blocks are at least 1 , and the evolutional sequence numbers of the blocks @xmath772 and @xmath773 are at least 2 .",
    "since @xmath583 is a periodic letter of order @xmath33 , @xmath585 contains at least one letter of order @xmath272 . if it is located to the left from ( the unique ) letter of order @xmath33 in @xmath585 , then by remark [ atomsimplestructright ] the @xmath22th right atom of @xmath772 , where @xmath774 is the evolutional sequence number of @xmath772 , contains a letter of order @xmath272 , and case i holds at the right for the evolution of @xmath768 .",
    "similarly , if there is a letter of order @xmath272 in @xmath585 located to the right from the letter of order @xmath33 in @xmath585 , then by remark [ atomsimplestructleft ] , case i holds at the left for the evolution of @xmath769 .    now suppose that there is exactly one periodic letter of order @xmath33 in @xmath743 . by corollary [ amountkletterssame ] , @xmath743 contains exactly one @xmath535-block , denote it by @xmath76 . by lemma [ klettersbecomeperiodic ] and by corollaries [ amountkletterssame ] and [ amountkminusoneblockssame ]",
    ", @xmath775 also consists of one @xmath535-block and one periodic letter of order @xmath33 .",
    "moreover , the periodic letter of order @xmath33 in @xmath776 is the descendant of the periodic letter of order @xmath33 in @xmath775 , so they coincide as abstract letters .",
    "recall also that by remark [ allatomsimplestruct ] , these letters of order @xmath33 are the rightmost letters in the forgetful occurrences of @xmath775 and of @xmath743 . by corollary [ atomsperiodicitysmallleft ] ,",
    "the rightmost letter in @xmath777 is the same letter of order @xmath33 .",
    "therefore , @xmath367 and @xmath368 coincide as abstract letters , denote this abstract letter by @xmath69 . by lemma [ evolseqnolarge ] ,",
    "the evolutional sequence number of @xmath76 is at least 1 .",
    "so , again , @xmath226 contains at least one letter of order @xmath272 . if it is located to the left ( resp .",
    "to the right ) of the unique occurrence of @xmath71 in @xmath226 , then by remark [ atomsimplestructright ] ( resp .",
    "[ atomsimplestructleft ] ) and by the definition of case i , case i holds at the right ( resp .  at the left ) for the evolution of @xmath778 , i.  e.  for the evolution of @xmath76 .",
    "[ caseoneexistsright ] let @xmath385 be an evolution of @xmath33-blocks ( @xmath536 ) such that case i holds at the right .",
    "let @xmath595 and @xmath767 .",
    "there exists a @xmath535-block @xmath76 in @xmath744 such that case i holds at the left or at the right for the evolution of @xmath76 .",
    "the proof is completely similar to the proof of the previous lemma .",
    "[ regpartabslargek ] let @xmath385 be an evolution of @xmath33-blocks such that case i holds at the left ( resp .  at the right )",
    "let @xmath388 be a stable @xmath33-block .",
    "then @xmath779 ( resp .",
    "@xmath780 ) .    for @xmath345",
    "we already know this by lemma [ regpartabslargeone ] .",
    "for @xmath536 note first that @xmath781 ( resp .",
    "@xmath782 ) is nonempty since @xmath720 , and @xmath783 .",
    "now the claim follows by induction on @xmath33 from corollary [ regpartstablekminusone ] and from lemmas [ caseoneexistsleft ] and [ caseoneexistsright ] .",
    "[ regpartabsgrows ] let @xmath385 be an evolution of @xmath33-blocks such that case i holds at the left ( resp .  at the right )",
    "let @xmath388 be a stable @xmath33-block .",
    "then @xmath784 ( resp .",
    "@xmath785 ) .",
    "we can write @xmath781 ( resp .  @xmath782 ) and @xmath786 ( resp .",
    "@xmath787 ) . by corollary [ atomsperiodicitybig ] , @xmath788 and @xmath789 ( resp .",
    "@xmath790 and @xmath791 ) coincide as abstract words , and @xmath792 ( resp .",
    "@xmath793 ) contains at least one letter of order @xmath33 since case i holds at the left ( resp .  at the right ) .",
    "[ kblocklengtho ] let @xmath385 be an evolution of @xmath33-blocks .",
    "then @xmath794 is @xmath795 and @xmath796 is @xmath797 ( for @xmath798 ) , and the constants in the @xmath676-notation depend on @xmath42 , @xmath3 , and @xmath33 only , but not on @xmath385 .    for @xmath345 we already know this by corollary [ oneblocklengths ] . for @xmath536 , we do induction on @xmath33 . without loss of generality , we may consider only the values of @xmath118 grater than or equal to @xmath719 . by remark [ preperiodfixed ] , the lengths of the forgetful occurrences of @xmath799 and of @xmath800 are constants ( they do not depend on @xmath118 ) , and since the total number of different evolutions present in @xmath44 , understood as sequences as abstract words , is finite ( corollary [ finite - number - of - evolutions ] ) , the lengths of all left and right preperiods of all @xmath33-blocks are bounded by a single constant that depends on @xmath3 , @xmath42 and @xmath33 only .    by corollaries [ amountkminusoneblockssame ] and [ amountkminusoneblockssamezero ] , the amount of @xmath535-blocks in @xmath637 does not depend on @xmath118 , and using corollary [ finite - number - of - evolutions ] again , we conclude that all amounts of @xmath535-blocks in @xmath637 are bounded by a single constant that depends on @xmath3 , @xmath42 and @xmath33 only . by lemma [ evolseqnolarge ] , the evolutional sequence numbers of these @xmath535-blocks can be @xmath118 , @xmath801 or @xmath671 ( since @xmath637 is the concatenation of the zeroth and the first atoms ) .",
    "similarly , it follows from corollary [ amountkletterssame ] and from corollary [ finite - number - of - evolutions ] that the amount of letters of order @xmath33 in @xmath637 is bounded by a single constant that depends on @xmath3 , @xmath42 and @xmath33 only .",
    "therefore , it follows from the induction hypothesis for @xmath272 that @xmath796 is @xmath797 .",
    "let us count the total amount of @xmath535-blocks in @xmath727 and in @xmath728 . by corollary [ amountkminusoneblockssame ] ,",
    "the amount of @xmath535-blocks in the @xmath22th left atom , if this atom is inside @xmath727 ( i.  e.  if @xmath802 ) , does not depend on @xmath118 and @xmath22 , denote this amount by @xmath734 .",
    "similarly , denote by @xmath803 the amount of @xmath535-blocks in the @xmath22th right atom if this atom is inside @xmath728 .",
    "the total amount of @xmath535-blocks in @xmath727 and in @xmath728 is @xmath804 . by corollary [ amountkminusoneblockssame ] , the total amount of letters of order @xmath33 in @xmath727 and in @xmath728 is also @xmath804 . using corollary [ finite - number - of - evolutions ] again , we can write this number as @xmath674 . by lemma [ evolseqnolarge ] ,",
    "the evolutional sequence numbers of all @xmath535-blocks in @xmath727 and in @xmath728 are at most @xmath671 .",
    "now observe that it follows from the definition of the descendant of a @xmath535-block and from the fact that @xmath42 is nonerasing that the length of a @xmath535-block is less than or equal to the length of its descendant .",
    "hence , it follows from the induction hypothesis for @xmath272 that if we have a @xmath535-block whose evolutional sequence number is at most @xmath118 , then its length is bounded by a constant ( that depends on @xmath3 , @xmath42 and @xmath33 only ) multiplied by @xmath805 .",
    "therefore , the total length of @xmath806 and @xmath807 is @xmath808 .",
    "finally , @xmath794 is @xmath809 .",
    "[ regpartasym ] let @xmath385 be an evolution of @xmath33-blocks . if case i holds at the left ( resp .  at the right ) for @xmath385 , then @xmath810 ( resp .",
    "@xmath811 ) is @xmath812 .",
    "if case i holds for @xmath385 at least at one side ( at the left or at the right ) , then @xmath794 is @xmath812 .",
    "the constants in the @xmath675-notation here depend on @xmath42 , @xmath3 , and @xmath33 only , but not on @xmath385 .    for @xmath345",
    "this is true by corollary [ oneblocklengths ] .",
    "for @xmath536 we are going to prove this by induction on @xmath33 .",
    "since we already have lemma [ kblocklengtho ] , it is sufficient to prove that if case i holds at the left ( resp .  at the right ) for @xmath385 , then @xmath810 ( resp .",
    "@xmath811 ) is @xmath813 .    by the induction hypothesis for @xmath272 ,",
    "there exist numbers @xmath814 and @xmath815 such that if the evolutional sequence number of a @xmath535-block is @xmath416 and case i holds at the left or at the right for its evolution , then the length of this @xmath535-block is at least @xmath816 . set @xmath817 .",
    "suppose that we are considering a @xmath33-block @xmath388 such that @xmath818 .",
    "note first that @xmath819 and @xmath820 .",
    "hence , if case i holds at the left ( resp .  at the right ) for @xmath385 , then the concatenation of left atoms @xmath821 ( resp .",
    "@xmath822 ) is contained in the left ( resp .",
    "right ) regular part of @xmath388 . by lemma [ evolseqnolarge ] ,",
    "the smallest possible evolutional sequence number of a @xmath535-block contained in one of these atoms is @xmath823 . by lemma [ caseoneexistsleft ] ( resp .",
    "[ caseoneexistsright ] ) , each of these atoms contains at least one @xmath535-block such that case i holds at the left or at the right for its evolution .",
    "so , we have at least @xmath824 such @xmath535-blocks in this concatenation of atoms , and by the induction hypothesis , each of these @xmath535-blocks has length at least @xmath825 .",
    "hence , the length of the forgetful occurrence of the whole left ( resp .",
    "right ) regular part is at least @xmath826 .",
    "these two lemmas explain why letters of order @xmath33 were called letters of order @xmath33 , not letter of order @xmath272 . despite the growth rates of individual letters of order @xmath33 ( in the sense of their repeated images under @xmath42 ) are @xmath827 , the `` growth rates '' of @xmath33-blocks ( i.  e.  occurrences consisting of letters of order at most @xmath33 ) in the sense of their superdescendants and evolutions are @xmath795 and sometimes @xmath812 .",
    "now we are going to define stable @xmath33-multiblocks and ( prime and composite ) kernels in stable @xmath33-multiblocks . here",
    "we also allow @xmath512 .",
    "we call a @xmath33-multiblock _ stable _ if it consists of periodic letters of order @xmath60 and ( if @xmath828 ) stable @xmath33-blocks only .",
    "in particular , an empty @xmath33-multiblock is always stable .",
    "note that it is not true in general that if @xmath118 is large enough , then the @xmath118th superdescendant of a @xmath33-multiblock is stable , namely , if a @xmath33-multiblock contains a letter of order @xmath375 , then its superdescendants never become stable . on the other hand , we can say the following :    if a @xmath33-multiblock @xmath829_k$ ] , where @xmath505 , is stable , then each letter of order @xmath302 in @xmath830_k)$ ] is periodic , has order @xmath60 and is the descendant of ( more precisely , is the only letter of order @xmath302 or @xmath33-block in the descendant of ) a letter of order @xmath33 in @xmath831_k$ ] .",
    "if @xmath829_k$ ] is stable and @xmath828 , then each @xmath33-block in @xmath832_k)$ ] is stable and is the descendant of a @xmath33-block in @xmath831_k$ ] . in other words ,",
    "the operation of taking the descendant of a @xmath33-block or of a letter of order @xmath302 establishes a bijection between the letters of order @xmath302 and ( if @xmath828 ) the @xmath33-blocks in @xmath831_k$ ] and the letters of order @xmath302 and ( if @xmath828 ) the @xmath33-blocks in @xmath830_k)$ ] .",
    "in particular , @xmath830_k)$ ] is also a stable @xmath33-multiblock .",
    "note that if @xmath828 , then the requirement that all letters of order @xmath302 in a stable @xmath33-multiblock are of order exactly @xmath60 and are periodic is essential in the sense that if we only know that all @xmath33-blocks in a given @xmath33-multiblock are stable , then it is not true in general that all @xmath33-blocks in its descendant are also stable .",
    "the descendants of letters of order @xmath833 ( in the sense of the definition of the descendant of a @xmath33-multiblock ) or of preperiodic letters of order @xmath60 can contain @xmath33-blocks with evolutional sequence number 0 ( i.  e.  origins ) , and they are unstable .",
    "in particular , a stable 0-multiblock is just an occurrence in @xmath44 consisting of periodic letters of order 1 only",
    ".    it will also be convenient for us now to introduce the notion of an evolution of stable @xmath33-multiblocks , but we will not introduce ancestors and origins . instead , we say the following : a sequence of _ * stable * _ @xmath33-multiblocks @xmath834 is called an _ evolution _ if @xmath835 for all @xmath575 .",
    "an evolution containing a given stable @xmath33-multiblock always exists ( for example , one can take this block as @xmath836 and set @xmath837 for @xmath544 ) , but is not necessarily unique , for example , if @xmath838 is an evolution of @xmath33-multiblocks , then a @xmath33-multiblock @xmath839 with @xmath544 is also contained in the following evolution @xmath840 : @xmath841 for all @xmath601 .",
    "we call two evolutions @xmath838 and @xmath840 of stable @xmath33-multiblocks _ consecutive _ if @xmath839 and @xmath842 are consecutive @xmath33-multiblocks for all @xmath575 .",
    "if @xmath838 and @xmath840 are two consecutive evolutions of stable @xmath33-multiblocks , we call the evolution @xmath843 , where @xmath844 is the concatenation of @xmath839 and @xmath842 , the _ concatenation _ of @xmath838 and @xmath840 .",
    "now we define prime kernels in a stable @xmath33-multiblock ( @xmath845 )",
    ". they will be suboccurrences in the forgetful occurrence of the @xmath33-multiblock .",
    "more precisely , we are going to define them by induction on @xmath33 .",
    "the only prime kernel of a stable 0-multiblock is just the 0-multiblock itself ( which is already an occurrence in @xmath44 .",
    "suppose that @xmath828 .",
    "let @xmath839 be a stable @xmath33-multiblock .",
    "we say that a suboccurrence @xmath380 in its forgetful occurrence @xmath846 is a prime kernel of @xmath839 if one of the following conditions holds :    1 .",
    "@xmath380 is the forgetful occurrence of the left ( resp .",
    "right ) preperiod of a @xmath33-block in @xmath839 such that case i holds at the left ( resp .  at the right ) for its evolution .",
    "2 .   @xmath380 is a single letter of order @xmath60 .",
    "3 .   there exists a @xmath33-block @xmath76 in @xmath839 such that @xmath380 is a prime kernel of @xmath847 ( recall that the core of a @xmath33-block is by definition a @xmath535-multiblock , so its prime kernels are already defined by the induction hypothesis ) .    [ primekernelsdiffer ] each suboccurrence of @xmath839 is listed in this list at most once , and kernels of a @xmath33-multiblock do not overlap .    for @xmath512",
    "the claim is trivial since there is only one kernel in each 0-multiblock .",
    "if @xmath498 , then a stable @xmath33-multiblock consists of periodic letters of order @xmath60 and stable @xmath33-blocks , and prime kernels are either these letters of order @xmath60 themselves ( and they are listed only once ) , or are suboccurrences of the @xmath33-blocks . clearly , suboccurrences of the @xmath33-blocks can not overlap with letters of order @xmath60 .",
    "suppose that an occurrence @xmath380 is a prime kernel contained in a @xmath33-block @xmath76 .",
    "it can be listed in the list above as a left ( resp .",
    "right ) preperiod only if case i holds at the left ( resp .  at the right ) for the evolution of @xmath76 .",
    "but then the left ( resp .  right ) regular part of @xmath76 is nonempty by lemmas [ regpartabslargeone ] and [ regpartabslargek ] , so @xmath380 can not overlap or coincide with the prime kernels of @xmath847 . by the induction hypothesis , the prime kernels of @xmath847 also do not overlap , and each of them is mentioned in the definition exactly once .",
    "note that we do not claim ( and this is not true in general ) that prime kernels are nonempty occurrences .",
    "the most trivial counterexample is an empty 0-multiblock , i.  e.  an empty occurrence in @xmath44 , then it is its prime kernel .",
    "a bit more general example is a 1-multiblock consisting of a single 1-block whose core is empty .",
    "this can happen if both borders of the origin of an evolution of 1-blocks are , for example , preperiodic letters of order 2 , and their images consist of exactly one periodic letter of order 2 each . more generally , it can happen that the core of a @xmath33-block @xmath76 , where @xmath536 , consists of a single empty @xmath535-block , then using our definition of a prime kernel , we get by induction that this empty @xmath535-block is a prime kernel inside @xmath76 . moreover , if case ii holds , say , at the right for the evolution of @xmath76 , and the @xmath33-multiblock whose prime kernels we are defining contains the right border @xmath366 of @xmath76 as well as @xmath76 , then this empty prime kernel ( which is @xmath463 in this case ) and @xmath465 are both prime kernels .",
    "thus , it is possible that two prime kernels are consecutive occurrences in @xmath44 , and one of them is an empty occurrence .",
    "however , it is not possible ( and the above lemma proves that this is not possible ) that this empty occurrence is called a prime kernel twice , and this is guaranteed ( in particular ) by the fact that we call the forgetful occurrence of the right preperiod a prime kernel only if case i holds at the right .",
    "otherwise in the example above , we would have called @xmath463 a prime kernel twice : first as a prime kernel of @xmath847 and second as the forgetful occurrence of @xmath848 .    one more remark",
    "we make about this definition is the following .",
    "[ primekernelsexist ] an empty 0-multiblock ( i.  e.  an empty occurrence in @xmath44 ) has a prime kernel , which is the 0-multiblock itself , while an empty @xmath33-multiblock for @xmath498 ( which is really empty in the @xmath33-multiblock sense , i.  e.  it does not contain any letters of order @xmath302 and @xmath33-blocks , even empty ones ) does not have any prime kernels according to this definition . however , if a @xmath33-multiblock , where @xmath498 , consists of a single empty @xmath33-block ( which must be stable , otherwise prime kernels are not defined anyway ) does have one prime kernel , which is this @xmath33-block itself .    for example",
    ", let us find all prime kernels in the 2-multiblock consisting of a single stable 2-block in the example above .",
    "the core of this 2-block consists the following 1-blocks and letters of order 2 :    1 .",
    "a 1-block @xmath849 , where the amount of letters @xmath236 equals the amount of letters @xmath708 and is at least 10 if the ambient 2-block is stable .",
    "a letter @xmath235 of order 2 . 3 .   a 1-block @xmath850 , where the amount of letters @xmath236 equals two plus the amount of letters @xmath708 .",
    "there are at least 8 letters @xmath708 if the ambient 2-block is stable .",
    "a letter @xmath225 of order 2 .",
    "a 1-block @xmath851 , where @xmath236 is repeated an even number of times , and at least 18 times if the 2-block is stable .",
    "so , the prime kernels of the 2-multiblock are :    1 .   the left preperiod of the 1-block @xmath849 , which is @xmath852 .",
    "2 .   the core of this 1-block , which is the occurrence @xmath853 in the middle .",
    "3 .   the right preperiod of this 1-block , which is @xmath854 .",
    "the letter @xmath235 of order 2 .",
    "the left preperiod of the 1-block @xmath850 , which is @xmath854",
    "the core of this 1-block , which is the rightmost occurrence of the word @xmath855 in this 1-block . 7 .",
    "the right preperiod of this 1-block , which is @xmath852",
    "the letter @xmath225 of order 2",
    "the left preperiod of the 1-block @xmath851 , which is @xmath852 . 10 .",
    "the core of this 1-block , which is the occurrence of the word @xmath856 located exactly in the middle of this 1-block ( recall that the number of letters @xmath236 in this 1-block is even ) .",
    "the right preperiod of this 1-block , which is @xmath852 .",
    "the right preperiod of the whole 2-block , which is @xmath857 .",
    "now we define _ descendants _ of prime kernels of a stable @xmath33-multiblock @xmath839 , where @xmath838 is an evolution of stable @xmath33-multiblocks . in general",
    ", they are prime kernels of @xmath835 . more precisely ,",
    "if @xmath512 , then the only prime kernel of @xmath839 is @xmath839 itself , and we say that @xmath858 is the descendant of the prime kernel @xmath839 . for @xmath498 , we define the descendants of prime kernels by induction on @xmath33 .",
    "let @xmath380 be a prime kernel of @xmath839 .",
    "consider three cases ( we can do that since we know the statement of lemma [ primekernelsdiffer ] ) .    if @xmath380 is the forgetful occurrence of the left ( resp .",
    "right ) preperiod of a @xmath33-block @xmath76 contained in @xmath839 and such that case i holds at the left ( resp .  at the right ) for its evolution",
    ", then we say that the descendant of the prime kernel @xmath380 is the forgetful occurrence of @xmath859 ( resp .  of @xmath860 ) .",
    "if @xmath380 is a single periodic letter of order @xmath60 , then its descendant in the sense of @xmath33-multiblocks , i.  e.  the only periodic letter of order @xmath60 in @xmath552 , is called the descendant of @xmath380 as a prime kernel .    finally ,",
    "if @xmath380 is a prime kernel of the @xmath535-block @xmath847 , where @xmath76 is a @xmath33-block inside @xmath839 , then the descendant of @xmath380 as of a prime kernel of a @xmath535-multiblock is already defined by the induction hypothesis ( and is a suboccurrence in @xmath861 ) , and we say that the descendant of @xmath380 as of a prime kernel of @xmath839 is the same suboccurrence of @xmath862 .",
    "the descendant of a prime kernel @xmath380 of a stable @xmath33-multiblock is denoted by @xmath863 .",
    "[ suprimekerbijection ] a trivial induction on @xmath33 shows that the operation of taking the descendant of a prime kernel establishes a bijection between the prime kernels of a stable @xmath33-multiblock and the prime kernels of its descendant .",
    "[ borderkernelsleft ] let @xmath829_k$ ] , where @xmath505 , be a stable @xmath33-multiblock . if @xmath498 , suppose also that it is nonempty in the @xmath33-multiblock sense .",
    "then there exists a prime kernel of @xmath829_k$ ] of the form @xmath864 .",
    "if @xmath832_k)={\\alpha}[\\mathfrak x , s\\ldots t,\\mathfrak y]_k$ ] , then @xmath865 is a prime kernel of the form @xmath866 .    for @xmath512",
    "the claim follows directly from the definition .",
    "suppose that @xmath498 .",
    "we use induction on @xmath33 .    if the leftmost @xmath33-block or letter of order @xmath60 contained in @xmath829_k$ ]",
    "is actually a letter of order @xmath60 , then this letter is @xmath59 , and it is a prime kernel itself .",
    "if @xmath832_k)={\\alpha}[\\mathfrak x , s\\ldots t,\\mathfrak y]_k$ ] , then @xmath583 is a periodic letter of order @xmath60 , and @xmath867 .",
    "if the leftmost @xmath33-block or letter of order @xmath60 contained in @xmath829_k$ ] is actually a @xmath33-block , denote it by @xmath560 . if case i holds at the left for the evolution of @xmath560 , then the forgetful occurrence of @xmath868 is a prime kernel , and it starts from position @xmath75 in @xmath44 .",
    "again , if @xmath832_k)={\\alpha}[\\mathfrak x , s\\ldots t,\\mathfrak y]_k$ ] , then @xmath869 starts from position @xmath508 in @xmath44 .",
    "if case ii holds at the left , then the left component of @xmath560 is empty , and the core of @xmath560 is a @xmath535-multiblock of the form @xmath870_{k-1}$ ] for some @xmath871 , and , by remark [ zerothatomsimplestruct ] , it is a non - empty @xmath535-multiblock if @xmath872 . by the induction hypothesis , there exists a prime kernel of @xmath870_{k-1}$ ] of the form @xmath864 .",
    "then @xmath864 is also a kernel of @xmath829_k$ ] . and again , if @xmath832_k)={\\alpha}[\\mathfrak x , s\\ldots t,\\mathfrak y]_k$ ] , then @xmath873_{k-1})={\\alpha}[<,s\\ldots s''',>]_{k-1}$ ] for some @xmath874 , and by the induction hypothesis , @xmath875 is a prime kernel of @xmath876_{k-1}$ ] of the form @xmath866 for some @xmath877 . by the definition of the descendant of a prime kernel in this case",
    ", we also have @xmath878 .    [ borderkernelsright ]",
    "let @xmath829_k$ ] , where @xmath505 , be a stable @xmath33-multiblock . if @xmath498 , suppose also that it is nonempty in the @xmath33-multiblock sense .",
    "then there exists a prime kernel of @xmath829_k$ ] of the form @xmath879 .",
    "if @xmath832_k)={\\alpha}[\\mathfrak x , s\\ldots t,\\mathfrak y]_k$ ] , then @xmath880 is a prime kernel of the form @xmath881 .",
    "the proof is completely symmetric to the proof of the previous lemma .",
    "[ kernelfixed ] if @xmath380 is a prime kernel of a stable @xmath33-multiblock @xmath839 , then @xmath863 coincides with @xmath380 as an abstract word .    for @xmath512",
    "this is true by the definitions of a periodic letter of order 1 and a weakly 1-periodic morphism .",
    "if @xmath498 , we again use induction on @xmath33 .",
    "consider the three cases from the definition of a prime kernel .    if there exists a @xmath33-block @xmath76 in @xmath839 such that @xmath882 ( resp .",
    "@xmath883 ) and case i holds at the left ( resp .  at the right ) for the evolution of @xmath76 , then @xmath884 ( resp .",
    "@xmath885 ) . by remark [ preperiodfixed ] , @xmath886 and @xmath887 ( resp .",
    "@xmath888 and @xmath889 ) coincide as abstract words .",
    "if @xmath380 is a single periodic letter of order @xmath60 , then by remark [ descendantofperiodic ] , @xmath863 is also a single letter , and it coincides with @xmath380 as an abstract letter .",
    "finally , if there is a @xmath33-block @xmath76 in @xmath839 such that @xmath380 is a kernel of @xmath847 , then the claim follows from the induction hypothesis .    [ conskernelsurvives ]",
    "let @xmath839 be a stable @xmath33-multiblock , @xmath76 and @xmath380 be its two prime kernels .",
    "suppose that @xmath76 is located to the left from @xmath380 and that there are no other prime kernels between @xmath76 and @xmath380 .",
    "then they are either consecutive occurrences in @xmath44 , or the occurrence @xmath890 between them is the forgetful occurrence of the ( left or right ) regular part of a stable @xmath70-block @xmath891 ( @xmath892 ) such that case i holds for its evolution at the left or at the right , respectively .",
    "@xmath76 and @xmath380 are consecutive occurrences in @xmath44 if and only if @xmath893 and @xmath863 are consecutive occurrences . if @xmath894 ( resp .",
    "@xmath895 ) and case i holds at the left ( resp .  at the right ) for the evolution of @xmath891 , then the occurrence between @xmath893 and @xmath863 is @xmath896 ( resp .",
    "@xmath897 ) .",
    "for @xmath512 the statement is clear since each 0-multiblock has only one prime kernel . for @xmath498 , we prove the statement by induction on @xmath33 .",
    "@xmath76 and @xmath380 can not be occurrences in two different @xmath33-blocks , otherwise there would be a letter of order @xmath60 between these two @xmath33-blocks , and this letter of order @xmath60 would also be located between @xmath76 and @xmath380 .",
    "so , there are two possible cases : either @xmath76 and @xmath380 are both occurrences in the same @xmath33-block , or one of these occurrences is located in a @xmath33-block , and the other is the left or the right border of this @xmath33-block .",
    "suppose that @xmath76 is an occurrence in a @xmath33-block @xmath442 , and @xmath380 is the right border of @xmath442 , i.  e.   @xmath898 .",
    "by lemma [ borderkernelsright ] , the @xmath33-multiblock consisting of the @xmath33-block @xmath442 has a prime kernel of the form @xmath899 , i.  e.   @xmath900 and @xmath901 .",
    "then @xmath76 and @xmath380 are consecutive , and @xmath902 and @xmath903 are consecutive by the second part of lemma [ borderkernelsright ] .",
    "the case when @xmath380 is an occurrence in a @xmath33-block @xmath442 , and @xmath76 is the left border of @xmath442 is similar to the previous one . in this case",
    ", we have @xmath904 , and , by lemma [ borderkernelsleft ] , @xmath380 starts from position @xmath905 in @xmath44 , i.  e.   @xmath170 .",
    "then @xmath76 and @xmath380 are consecutive occurrences in @xmath44 , and , by the second part of lemma [ borderkernelsleft ] , @xmath906 and @xmath863 are also consecutive .",
    "suppose now that @xmath76 and @xmath380 are both occurrences in a @xmath33-block @xmath442 .",
    "again , there are several possibilities :    first , it is possible that case i holds at the left for the evolution of @xmath442 , and @xmath907 .",
    "then @xmath380 is a prime kernel of @xmath908 ( recall that there are no prime kernels between @xmath76 and @xmath380 , that @xmath908 is a nonempty @xmath535-multiblock if @xmath872 by remark [ zerothatomsimplestruct ] , so by remark [ primekernelsexist ] , @xmath908 has at least one prime kernel ) . by lemma [ borderkernelsleft ] ,",
    "then the forgetful occurrence of @xmath908 starts from position @xmath508 in @xmath44 , so @xmath909 .",
    "we also have @xmath910 , and @xmath863 is the leftmost prime kernel of @xmath911 , so the occurrence between @xmath893 and @xmath863 is @xmath912 .",
    "second , it is possible that case i holds at the right for the evolution of @xmath442 , and @xmath913 , but this case is completely symmetric to the previous one .",
    "the remaining possibility is that both @xmath76 and @xmath380 are prime kernels of @xmath908 , which is a @xmath535-multiblock , but then the claim follows from the induction hypothesis .    this lemma ( together with lemma [ regpartabslargek ] , which implies that the forgetful occurrence of the left or right regular part is nonempty if case i holds at the left or at the right , respectively ) enables us to define _",
    "composite kernels _ of stable @xmath33-multiblocks as maximal ( by inclusion ) concatenations of consecutive prime kernels .",
    "in other words , if @xmath839 is a stable @xmath33-multiblock , then an occurrence @xmath380 is called a composite kernel , if it is a concatenation of consecutive prime kernels of @xmath839 , and letters @xmath383 ( if @xmath914 ) and @xmath384 do not belong to any prime kernels of @xmath839 .",
    "( empty occurrences are allowed by this definition , so , if @xmath548 is an empty prime kernel , and letters @xmath383 and @xmath583 do not belong to any prime kernel , then @xmath548 is also a composite kernel ) . if @xmath839 is a stable @xmath33-multiblock , we can write its composite kernels in a list , as they occur in @xmath846 from the right to the left .",
    "denote the number of these composite kernels by @xmath915 we refer to the elements of this list as to the first , the second , , the @xmath915th composite kernel of @xmath839 , and denote them by @xmath916 .",
    "we also can define the _ descendant _ of a composite kernel as the concatenation of the descendants of all prime kernels inside this composite kernel , they are consecutive by lemma [ conskernelsurvives ] .",
    "in other words , if @xmath917 , where @xmath918 and @xmath919 is a prime kernel for @xmath920 , then we say that the descendant of @xmath839 is @xmath921 , these descendants are consecutive by lemma [ conskernelsurvives ] .",
    "lemma [ kernelfixed ] guarantees that empty prime kernels do not lead to any ambiguity in the notation here since their descendants are also empty . denote the descendant of a composite kernel @xmath922 by @xmath923 .",
    "so , now we have split each stable @xmath33-multiblock into a concatenation of alternating ( possibly empty ) composite kernels and ( nonempty ) forgetful occurrences of left or right regular parts of @xmath70-blocks ( @xmath892 ) such that case i holds for their evolutions at the left or at the right , respectively .",
    "we are going to call these left or right regular parts , as well as some concatenations , the inner pseudoregular parts of the @xmath33-multiblock .",
    "here is the precise definition : let @xmath839 be a stable @xmath33-multiblock .",
    "suppose that @xmath924 .",
    "first , if @xmath925 , @xmath926 and @xmath927 , then we call the occurrence @xmath928 between these two composite kernels the _ @xmath929th inner pseudoregular part _ of @xmath839 and denote it by @xmath930 . second , we say that the _ @xmath931th _ ( resp .",
    "the _ @xmath932th _ ) _ inner pseudoregular part _ of @xmath839 is the empty occurrence @xmath79 ( resp .",
    "@xmath463 ) at the beginning ( resp .",
    "at the end ) of the forgetful occurrence of @xmath839 .",
    "denote it by @xmath933 ( resp .  by @xmath934 ) . finally , choose indices @xmath275 and @xmath935 so that @xmath936 .",
    "we call the concatenation @xmath937 the _ @xmath938th inner pseudoregular part _ of @xmath839 and denote it by @xmath939 .",
    "( by lemmas [ borderkernelsleft ] and [ borderkernelsright ] , these words are really consecutive even if @xmath615 or @xmath940 . ) in particular , @xmath941 . if @xmath942 ( resp .",
    "@xmath943 ) is an empty occurrence , then it coincides with @xmath933 ( resp .  with @xmath934 ) as an occurrence in @xmath44 , and in this case @xmath944 ( resp .",
    "@xmath945 ) for @xmath946 ( resp .  for @xmath947 ) as an occurrence in @xmath44 .    for example , let us list the composite kernels and the regular parts between them for the 2-multiblock consisting of a single 2-block from the example above .",
    "we have already listed its prime kernels , and its composite kernels and regular parts between them are :    1 .   the first prime kernel from the list above , which is @xmath852 .",
    "2 .   the left regular part of @xmath849 , which is @xmath948 .",
    "3 .   the second prime kernel from the list above , which is @xmath853 .",
    "4 .   the left regular part of @xmath849 , which is @xmath949 .",
    "the concatenation of the third , fourth and fifth prime kernels , which is @xmath950 . 6 .",
    "the left regular part of @xmath850 , which is @xmath949 . 7 .",
    "the sixth element of the list above , @xmath855",
    "the right regular part of @xmath850 , which is @xmath948",
    "the concatenation of the seventh , eighth and ninth prime kernels , @xmath951 . 10 .",
    "the left regular part of @xmath851 , which is @xmath948 . 11 .",
    "the tenth prime kernel , @xmath856 .",
    "the right regular part of @xmath851 , which is @xmath948 . 13 .",
    "the eleventh prime kernel , @xmath852 .",
    "the right regular part of the whole 2-block , an occurrence of the form @xmath952 . 15 . the twelfth prime kernel , @xmath857 .",
    "we already know ( remark [ suprimekerbijection ] ) that the operation of taking the descendant of a prime kernel establishes a bijection between the prime kernels of a stable @xmath33-multiblock and the prime kernels of its descendant .",
    "the same is true for composite kernels :    [ sucompkerbijection ] the operation of taking the descendant of a composite kernel establishes a bijection between the composite kernels of a stable @xmath33-multiblock and the composite kernels of its descendant .    in other words ,",
    "if @xmath838 is an evolution of stable @xmath33-multiblocks , then @xmath915 does not depend on @xmath118 and @xmath953 for @xmath575 and for @xmath954 .",
    "so if @xmath838 is an evolution of stable @xmath33-multiblocks , we can denote the number @xmath915 for arbitrary @xmath118 by @xmath955 .",
    "[ compkernelfixed ] if @xmath838 is an evolution of stable @xmath33-multiblocks , then @xmath922 does not depend on @xmath118 as an abstract word for @xmath956 .",
    "this follows directly from lemma [ kernelfixed ] and the definitions of a composite kernel and its descendant .",
    "so , we can denote the abstract word @xmath922 for arbitrary @xmath575 by @xmath957 and call it _ the @xmath275th composite kernel of @xmath838_. the number @xmath955",
    "is then called _ the number of composite kernels of @xmath838_.    [ betweenkernelsreg ] let @xmath838 be an evolution of stable @xmath33-multiblocks , @xmath498 .",
    "let @xmath958 .",
    "then there exist an evolution of @xmath70-blocks @xmath385 ( @xmath892 ) and a number @xmath959 such that one of the following statement holds :    1 .",
    "case i holds for @xmath385 at the left , and for all @xmath575 we have @xmath960 .",
    "2 .   case i holds for @xmath385 at the right , and for all @xmath575 we have @xmath961 .",
    "this follows directly from the last statement of lemma [ conskernelsurvives ] .",
    "[ betweenkernelgrows ] let @xmath838 be an evolution of stable @xmath33-multiblocks , @xmath498 .",
    "let @xmath962 .",
    "for each @xmath575 , denote @xmath963",
    ".    then @xmath964 , @xmath965 strictly grows as @xmath118 grows , and there exists @xmath70 ( @xmath892 ) such that @xmath965 is @xmath966 for @xmath798 .    by the previous lemma , there exist numbers @xmath967 ( @xmath968 ) , evolutions @xmath969 ( @xmath970 is an evolution of @xmath971-blocks ) , and numbers @xmath972 ( @xmath973 ) such that for each @xmath75 ( @xmath974 ) one of the following holds :    1 .",
    "case i holds for @xmath970 at the left , and for each @xmath575 we have @xmath975 .",
    "2 .   case i holds for @xmath970 at the right , and for each @xmath575 we have @xmath976 .    by lemmas [ regpartabslargek ] , [ regpartabsgrows ] , and [ regpartasym ]",
    ", we see that in each of these cases , @xmath977 , that @xmath978 strictly grows as @xmath118 grows , and that @xmath978 is @xmath979 for @xmath798 .",
    "now , @xmath965 is the sum of @xmath980 summands @xmath981 that do not depend of @xmath118 , and of @xmath982 summands @xmath978 .",
    "therefore , @xmath964 , and @xmath965 strictly grows as @xmath118 grows .",
    "the asymptotic of @xmath965 for @xmath798 is @xmath983 where @xmath984 .",
    "[ betweenkernelgrowsgood ] let @xmath838 be an evolution of stable @xmath33-multiblocks , @xmath498 .",
    "suppose that @xmath985 .",
    "let @xmath986 be two indices such that @xmath987 , @xmath988 and @xmath989 .",
    "for each @xmath575 , denote @xmath963 .",
    "( in particular , if @xmath615 and @xmath990 , then @xmath991 .",
    ")    then @xmath964 , @xmath965 strictly grows as @xmath118 grows , and there exists @xmath70 ( @xmath892 ) such that @xmath965 is @xmath966 for @xmath798 .",
    "the only cases in the statement of this corollary not covered by the previous lemma are the cases when @xmath615 or @xmath992 .",
    "if @xmath615 and @xmath993 , then denote @xmath994 ( recall that we assume that @xmath995 ) . by the previous lemma , @xmath996 , @xmath997 strictly grows as @xmath118 grows , and there exists @xmath70 ( @xmath892 ) such that @xmath997 is @xmath966 for @xmath798 . but @xmath933 is always an empty occurrence , so @xmath998 , and @xmath999 , and the first summand does not depend on @xmath118 .",
    "hence , @xmath1000 , @xmath965 strictly grows as @xmath118 grows , and @xmath965 is @xmath1001 for @xmath798 .",
    "the case when @xmath616 , but @xmath992 is completely analogous .    finally ,",
    "if @xmath615 and @xmath992 , then , since @xmath985 by assumption , we can apply the previous lemma to @xmath1002 .",
    "again , @xmath996 , @xmath997 strictly grows as @xmath118 grows , and there exists @xmath70 ( @xmath892 ) such that @xmath997 is @xmath966 for @xmath798 . and",
    "again , since @xmath933 and @xmath1003 are always empty occurrences , we have @xmath1004 .",
    "the first and the last summands do not depend on @xmath118 , so @xmath1005 , @xmath965 strictly grows as @xmath118 grows , and @xmath965 is @xmath1006 for @xmath798 .    the following lemma shows how composite kernels and inner pseudoregular parts behave for concatenations of consecutive evolutions .",
    "[ concatcompker ] let @xmath838 and @xmath840 be two consecutive evolutions of * nonempty * stable @xmath33-multiblocks ( @xmath845 ) , and let @xmath843 be the concatenation of @xmath838 and @xmath840 .",
    "then :    1 .",
    "@xmath1007 2 .",
    "if @xmath1008 , then @xmath1009 for all @xmath575 as an occurrence in @xmath44 and @xmath1010 as an abstract word . if @xmath1011 , then @xmath1012 for all @xmath575 as an occurrence in @xmath44 and @xmath1013 as an abstract word . if @xmath1014 , then @xmath1015 for all @xmath575 as an occurrence in @xmath44 and @xmath1016 as an abstract word .",
    "3 .   if @xmath1017 , then @xmath1018 for all @xmath575 as an occurrence in @xmath44 . if @xmath1019 , then @xmath1020 for all @xmath575 as an occurrence in @xmath44 . if @xmath1021 , then @xmath1022 for all @xmath575 as an occurrence in @xmath44 .",
    "the first two claims follow directly from lemmas [ borderkernelsleft ] and [ borderkernelsright ] and the definition of a composite central kernel .",
    "the third claim follows from the first two claims and the definition of an inner pseudoregular part",
    ".    a particular case of prime and composite kernels will be especially important for us .",
    "if @xmath76 is a stable @xmath33-block ( @xmath828 ) , we call the prime ( resp .  composite ) kernels of @xmath847 the _ prime ( resp .",
    "composite ) central kernels _ of @xmath76 .",
    "denote the number of the composite central kernels of a stable @xmath33-block @xmath76 by @xmath1023 .",
    "observe that this definition coincides with the definition we gave in the previous section for 1-blocks .",
    "again , we can write the composite central kernels of @xmath76 in a list as they occur in @xmath388 , from the left to the right .",
    "we call the elements of this list the first , the second , , the @xmath1023th composite central kernel of @xmath76 and denote them by @xmath1024 .",
    "it follows from lemma [ borderkernelsleft ] and from remark [ zerothatomsimplestruct ] that @xmath1025 .",
    "note that , for example , the first composite central kernel of @xmath76 can be the first or the second composite kernel of the @xmath33-multiblock consisting of the @xmath33-block @xmath76 only , depending on whether case ii or case i holds for the evolution of @xmath76 at the left .",
    "let @xmath385 is an evolution of @xmath33-blocks , and let @xmath388 be a stable @xmath33-block .",
    "we have defined the descendants of these composite central kernels , and they are composite central kernels of @xmath402 . by remark [ sucompkerbijection ] , @xmath1026 , and by lemma [ compkernelfixed ]",
    ", @xmath1027 is the same abstract word as @xmath1028 for @xmath1029 . in other words , the number @xmath1030 and the abstract words",
    "@xmath1031 do not depend on @xmath118 if @xmath720 .",
    "we call these abstract words _ the composite central kernels of @xmath385 _ , denote the number of them by @xmath1032 , and denote the composite central kernels of @xmath385 themselves by @xmath1033",
    ".    in the example above , the composite central kernels of the evolution of 2-blocks are : @xmath852 , @xmath853 , @xmath950 , @xmath855 , @xmath951 , @xmath856 , @xmath852 .",
    "the structure of a 2-block in a bit more general case is shown by fig .",
    "[ twostruct ] .",
    ", where case ii holds at the left and case i holds at the right : 2 denotes a letter of order 2 , 1b denotes a 1-block .",
    "each individual grayed box is a prime central kernel.,title=\"fig : \" ] + , where case ii holds at the left and case i holds at the right : 2 denotes a letter of order 2 , 1b denotes a 1-block .",
    "each individual grayed box is a prime central kernel.,title=\"fig : \" ]    [ finitecker ] the lengths of all composite central kernels of all evolutions of @xmath33-blocks arising in @xmath44 are bounded by a single constant that depends on @xmath3 , @xmath42 , and @xmath33 only .",
    "in particular , only finitely many abstract words can equal central kernels of evolutions of @xmath33-blocks arising in @xmath44 .",
    "the proof is similar to the proof of corollary [ finitelrprep ] . by corollary [ finite - number - of - evolutions ] ,",
    "there are only finitely many sequences of abstract words that can be evolutions in @xmath44 , so there exists a single constant @xmath734 that depends on @xmath3 , @xmath42 and @xmath33 only such that if @xmath385 is an evolution of @xmath33-blocks , then @xmath735 . by definition ,",
    "@xmath1034 for @xmath1035 , and @xmath1036 is a subword of @xmath736 .",
    "therefore , @xmath1037 .",
    "again , as in the proof of corollary [ finitelrprep ] , we do not claim that if two evolutions of @xmath33-blocks equal as sequences of abstract words , then their composite central kernels are equal .",
    "in this section we will define and study continuously periodic evolutions , which will enable us to formulate a criterion for subword complexity of morphic sequences .",
    "we will use the coding @xmath18 a lot as well as the morphism @xmath42 , so we will use some obvious properties of codings without mentioning every time that @xmath18 is a coding . for example , if @xmath45 is a finite word , then @xmath1038 , and if @xmath1039 , then @xmath1040 . also , if @xmath212 , then @xmath1041 . if @xmath157 is an occurrence in a finite word @xmath45 , then @xmath1042 . and",
    "if @xmath76 is an occurrence in @xmath44 , then @xmath1043 .    before we will be able to define continuously periodic evolutions , we need to introduce two more technical notions , namely , we need to define left and right bounding sequences of an evolution of @xmath33-blocks and weak left and right evolutional periods of @xmath33-multiblocks .",
    "the construction of the left and the right bounding sequences is similar to the construction of pure morphic sequences themselves .",
    "let us construct the right bounding sequence , the construction for the left bounding sequence is symmetric .",
    "let @xmath385 be an evolution of @xmath33-blocks such that case ii holds at the right .",
    "first , consider the following sequence of abstract words : @xmath1044 since @xmath42 is strongly 1-periodic and images of letters of order @xmath271 consist of letters of order @xmath271 , the leftmost letter of order @xmath302 in each of these words is @xmath396 .",
    "temporarily denote by @xmath1045 ( resp .",
    "@xmath1046 ) the prefix ( resp .",
    "the suffix ) of @xmath1047 to the left ( resp .  to the right ) from the leftmost occurrence of @xmath396 ( not including this occurrence of @xmath396 ) .",
    "in other words , write @xmath1048 , where @xmath1045 consists of letters of order @xmath271 only .",
    "in particular , @xmath1049 and @xmath1050 are the empty word .",
    "[ rbsremarki ] if @xmath1051 , where @xmath576 , @xmath1052 , where @xmath575 , and @xmath1053 as an occurrence in @xmath44 , then @xmath1054 as an abstract word .",
    "[ rbslemmai ] for all @xmath575 we have @xmath1055 .",
    "we have @xmath1056 .",
    "note that @xmath1057 and @xmath1058 do not contain letters of order @xmath302 , so the leftmost occurrence of @xmath396 in @xmath1059 is the occurrence mentioned in this formula explicitly . on the other hand , by the definition of @xmath1060 and @xmath1061 , the leftmost occurrence of @xmath396 in @xmath1062 is also the occurrence mentioned in this formula explicitly .",
    "hence , @xmath1055 .    for all @xmath575",
    ", @xmath1046 is a prefix of @xmath1061 .",
    "let us prove this by induction on @xmath118 . for @xmath1063",
    "this is clear since @xmath1050 is the empty word .",
    "suppose that @xmath1046 is a prefix of @xmath1061 .",
    "then @xmath1064 is a prefix of @xmath1065 . by lemma [ rbslemmai ] , @xmath1055 and @xmath1066 ,",
    "so @xmath1061 is a prefix of @xmath1067 .    for all @xmath575 , we have @xmath1068 .",
    "recall that we have started with an evolution @xmath385 such that case ii holds at the right . by the definitions of case",
    "ii and of right atoms , @xmath1058 can not contain letters of order @xmath33 , it consists of letters of smaller orders ( or is empty if @xmath345 ) .",
    "but then , if @xmath1069 also had consisted of letters of order @xmath371 only , @xmath396 would have been a letter of order @xmath33 or less .",
    "so , @xmath1069 contains at least one letter of order @xmath417 , in particular , @xmath1069 is nonempty . since @xmath42 is nonerasing , @xmath1070 , and @xmath1071 .",
    "so , we have constructed an infinite sequence of words @xmath1046 , whose lengths strictly increase , and each of them is a prefix of the next one .",
    "let us add @xmath396 at the left of each of these words .",
    "we get an infinite sequence of words @xmath1072 whose lengths strictly increase , and each of them is a prefix of the next one .",
    "so , there exists a unique infinite ( to the right ) word such that all these words @xmath1073 ( for all @xmath575 ) are its prefixes .",
    "we call this infinite word _ the right bounding sequence of @xmath385 _ and denote it by @xmath1074 .    with this definition , remark [ rbsremarki ] can be reformulated as follows :    [ rbsremarkii ] let @xmath385 be an evolution of @xmath33-blocks such that case ii holds at the right , @xmath576 and @xmath575 .",
    "suppose that @xmath1051 , @xmath1075 , and @xmath1053 as an occurrence in @xmath44 .",
    "then @xmath1076 as an abstract word is a prefix of @xmath1074 .",
    "@xmath1074 is an abstract infinite word , it is not an occurrence in @xmath44 .",
    "however , we can prove the following lemma .    for all @xmath575 , if @xmath1077 as an occurrence in @xmath44 , then @xmath1078 .",
    "we prove this by induction on @xmath118 .",
    "if @xmath1063 , then @xmath1079 and , by the definition of @xmath396 , @xmath1080 , and the claim is clear .    suppose that @xmath1077 and @xmath1078 .",
    "let @xmath508 and @xmath509 be the indices such that @xmath1081 as an occurrence in @xmath44 . denote also by @xmath905 and @xmath1082 the indices such that @xmath1083 . by the definition of the descendant of a @xmath33-block , @xmath442 is a suboccurrence of @xmath380 .",
    "consider also the following occurrence in @xmath44 starting from position @xmath905 : @xmath1084 .",
    "since @xmath1058 consists of letters of order @xmath271 only , and @xmath396 is a letter of order @xmath302 , the occurrence of @xmath396 mentioned explicitly in this formula is the right border of @xmath1085 . in other words ,",
    "the occurrence of @xmath1058 mentioned explicitly here is @xmath1086 , and the occurrence of @xmath396 mentioned explicitly here is @xmath384 .",
    "hence , @xmath1087 , and @xmath1088    this lemma still uses the notation @xmath1046 we have introduced temporarily , but the next corollary does not use any temporary notation anymore .",
    "[ presenceofrbs ] let @xmath385 be an evolution of @xmath33-blocks such that case ii holds at the right , and let @xmath83 be an arbitrary finite prefix of @xmath1074 .",
    "then there exists @xmath814 ( that depends on @xmath385 and @xmath83 ) such that if @xmath416 and @xmath1089 as an occurrence in @xmath44 , then @xmath1090 .",
    "since the lengths of the words @xmath1046 strictly grow as @xmath1091 , there exists @xmath1092 such that if @xmath1093 , then @xmath83 is a prefix of @xmath1073 .",
    "set @xmath1094 .",
    "then if @xmath1089 as an occurrence in @xmath44 , then by the previous lemma , @xmath1095 .",
    "since @xmath83 is a prefix of @xmath1096 , we have @xmath1090 .    similarly ,",
    "if case ii holds at the left for an evolution @xmath385 of @xmath33-blocks , we define its _ left bounding sequence _ and denote it by @xmath1097 .",
    "@xmath1098 is a word infinite to the left , and the symmetric version of corollary [ presenceofrbs ] for left bounding sequences can be formulated as follows .",
    "[ presenceoflbs ] let @xmath385 be an evolution of @xmath33-blocks such that case ii holds at the left , and let @xmath83 be an arbitrary finite suffix of @xmath1074 .",
    "then there exists @xmath814 ( that depends on @xmath385 and @xmath83 ) such that if @xmath416 and @xmath1089 as an occurrence in @xmath44 , then @xmath1099 and @xmath1100 .",
    "the symmetric version of remark [ rbsremarkii ] can be formulated as follows .",
    "[ lbsremarkii ] let @xmath385 be an evolution of @xmath33-blocks such that case ii holds at the left , @xmath576 and @xmath575 .",
    "suppose that @xmath1101 , @xmath1102 , and @xmath1053 as an occurrence in @xmath44 .",
    "then @xmath1103 as an abstract word is a suffix of @xmath1098 .",
    "now let us define left and right weak evolutional periods for evolutions @xmath838 of stable nonempty @xmath33-multiblocks ( @xmath828 ) .",
    "the definition will use two indices , @xmath275 and @xmath935 ( @xmath1104 ) .",
    "a final period @xmath47 is called a _ left _",
    "_ right _ ) _ weak evolutional period _ of an evolution @xmath838 of stable @xmath33-multiblocks ( @xmath828 ) for a pair of indices @xmath938 ( @xmath1104 ) if    1 .   for each @xmath575 , @xmath1105 is a weakly left ( resp .",
    "right ) @xmath47-periodic word .",
    "the residue of @xmath1106 ( for @xmath575 ) modulo @xmath65 , i.  e.  the length of the incomplete occurrence in the previous condition , does not depend on @xmath118 .",
    "the second condition here enables us to formulate the following remark :    [ contpermultcycle ] if @xmath47 is a left weak evolutional period of an evolution @xmath838 of stable nonempty @xmath33-multiblocks ( @xmath828 ) for a pair of indices @xmath938 ( @xmath1104 ) and @xmath91 is the residue of @xmath1106 modulo @xmath65 ( for any @xmath118 ) , then @xmath1107 is a right weak evolutional period of @xmath838 for the pair @xmath938 .",
    "if @xmath47 is a right weak evolutional period of an evolution @xmath838 of stable nonempty @xmath33-multiblocks ( @xmath828 ) for a pair of indices @xmath938 ( @xmath1104 ) and @xmath91 is the residue of @xmath1106 modulo @xmath65 ( for any @xmath118 ) , then @xmath1108 is a left weak evolutional period of @xmath838 for the pair @xmath938 .",
    "[ contperweakuniquewideleft ] let @xmath838 be an evolution of stable @xmath33-multiblocks ( @xmath828 ) .",
    "suppose that @xmath985 .",
    "let @xmath1109 be three indices such that @xmath987 , @xmath988 , @xmath1110 , @xmath989 , and @xmath1111 .",
    "if @xmath47 is a left weak evolutional period of @xmath838 for the pair @xmath938 , and @xmath328 is a left weak evolutional period of @xmath838 for the pair @xmath1112 , then @xmath1113 , and @xmath47 is the minimal left period of @xmath1105 for all @xmath575 .    both @xmath47 and @xmath328 are final periods , so @xmath1114 and @xmath1115 . without loss of generality , @xmath1116 , so @xmath939 is a prefix of @xmath1117 for all @xmath575 .",
    "hence , for all @xmath575 , @xmath1105 is both a weakly left @xmath47-periodic word and a weakly left @xmath328-periodic word . by corollary [ betweenkernelgrowsgood ] , @xmath1118 .",
    "since @xmath47 and @xmath328 are final periods , none of them can be written as a word repeated more than once by lemma [ finalnomorethanonce ] .",
    "then lemma [ finwordperiods ] implies that @xmath1113 .",
    "moreover , if @xmath1105 were ( for some @xmath575 ) a weakly left @xmath1119-periodic word , where @xmath1120 , then lemma [ finwordperiods ] would again imply that @xmath47 can be written as another word repeated several times , a contradiction .",
    "therefore , @xmath47 is the minimal left period of @xmath1105 for all @xmath575 .",
    "[ contperweakuniqueleft ] let @xmath838 be an evolution of stable @xmath33-multiblocks ( @xmath828 ) .",
    "suppose that @xmath985 .",
    "let @xmath986 be two indices such that @xmath987 , @xmath988 and @xmath989 .    if there exists a left weak evolutional period of @xmath838 for the pair @xmath938 , then it is unique and is the minimal left period of @xmath1105 for all @xmath575 .",
    "[ contperweakuniquewideright ] let @xmath838 be an evolution of stable @xmath33-multiblocks ( @xmath828 ) .",
    "suppose that @xmath985 .",
    "let @xmath1121 be three indices such that @xmath1122 , @xmath1123 , @xmath1124 , @xmath1125 , and @xmath1126 .",
    "if @xmath47 is a right weak evolutional period of @xmath838 for the pair @xmath1127 , and @xmath328 is a right weak evolutional period of @xmath838 for the pair @xmath1128 , then @xmath1113 , and @xmath47 is the minimal right period of @xmath1105 for all @xmath575 .",
    "the proof is completely symmetric to the proof of lemma [ contperweakuniquewideleft ] .",
    "[ contperweakuniqueright ] let @xmath838 be an evolution of stable @xmath33-multiblocks ( @xmath828 ) .",
    "suppose that @xmath985 .",
    "let @xmath1129 be two indices such that @xmath1123 , @xmath1125 and @xmath1126 .",
    "if there exists a right weak evolutional period of @xmath838 for the pair @xmath1128 , then it is unique and is the minimal right period of @xmath1105 for all @xmath575 .",
    "now we define left and right pseudoregular parts and continuous evolutional periods for evolutions of @xmath33-blocks .",
    "the definition is similar to the definition of inner pseudoregular parts and weak evolutional periods for evolutions of @xmath33-multiblocks , but is not entirely the same .",
    "let @xmath385 be an evolution of @xmath33-blocks , and let @xmath275 be an index ( @xmath1130 ) .",
    "for each @xmath575 we define the left and the right pseudoregular parts of a stable @xmath33-block @xmath388 for index @xmath275 as follows .",
    "let @xmath75 and @xmath77 be indices such that @xmath1089 .",
    "suppose also that @xmath1131 , @xmath1132 , and @xmath1133 .",
    "then _ the left ( resp .",
    "right ) pseudoregular part of @xmath388 for index @xmath275 _ is @xmath1134 ( resp .",
    "@xmath1135 ) . in other words , the left ( resp .",
    "right ) pseudoregular part of @xmath388 for index @xmath275 is the suboccurrence of @xmath388 between the forgetful occurrence of the left preperiod and the @xmath275th composite central kernel ( resp .  between the @xmath275th composite central kernel and the forgetful occurrence of the right preperiod ) .",
    "denote it by @xmath1136 ( resp .  by @xmath1137 ) .",
    "the following remark shows how the definitions of left and right pseudoregular parts of @xmath33-multiblocks and inner pseudoregular parts of @xmath33-multiblocks are connected .",
    "let @xmath385 be an evolution of @xmath33-blocks , @xmath1138 , and let @xmath838 be the evolution of @xmath33-multiblocks defined by @xmath1139 .",
    "let @xmath275 be an index ( @xmath1130 ) .",
    "let @xmath935 ( @xmath1140 ) be the index such that @xmath1141 as an occurrence in @xmath44 for all @xmath575 .",
    "in other words , if case i holds for @xmath385 at the left , then @xmath1142 , otherwise @xmath1143 .    then    1 .   1 .   if case i holds for @xmath385 at the left , then @xmath1144 .",
    "2 .   if case ii holds for @xmath385 at the left , then @xmath1145 .",
    "2 .   1 .   if case i holds for @xmath385 at the right , then @xmath1146 .",
    "2 .   if case ii holds for @xmath385 at the right , then @xmath1147 .",
    "a final period @xmath47 is called a _ left _",
    "_ right _ ) _ continuous evolutional period _ of an evolution of @xmath33-blocks @xmath385 for an index @xmath275 if the following two conditions hold :    1 .",
    "[ contperstd ] 1 .   for each @xmath720 ( i.  e.  if @xmath388 is a stable @xmath33-block ) ,",
    "@xmath1148 ( resp .",
    "@xmath1149 ) is a weakly left ( resp .",
    "right ) @xmath47-periodic word .",
    "2 .   the residue of @xmath1150 ( resp .  of @xmath1151 ) ( for @xmath720 ) modulo @xmath65 , i.  e.  the length of the incomplete occurrence in the previous condition , does not depend on @xmath118 .",
    "[ contperlrbs ] if case ii holds for @xmath385 at the left ( resp .  at the right ) and @xmath1152 ( resp .",
    "@xmath1153 ) ( i.  e.  @xmath1154 is not the leftmost ( resp .",
    "rightmost ) composite central kernel for @xmath385 ) , then @xmath1155 ( resp .",
    "@xmath1156 ) ( this is a sequence infinite to the left ( resp .  to the right ) ) is periodic with period @xmath47 , i.  e.  @xmath1157 ( resp .",
    "@xmath1158 ) .",
    "the following remark shows connection between the definitions of a continuous evolutional period of an evolution of @xmath33-blocks and a weak evolutional period of an evolution of stable @xmath33-multiblocks .",
    "[ evperblockmulrel ] let @xmath385 be an evolution of @xmath33-blocks , let @xmath47 be a final period , and let @xmath838 be the evolution of @xmath33-multiblocks defined by @xmath1159 .",
    "let @xmath275 be an index ( @xmath1130 ) .",
    "again , let @xmath935 ( @xmath1140 ) be the index such that @xmath1160 as an occurrence in @xmath44 for all @xmath575 . in other words , if case i holds for @xmath385 at the left , then @xmath1142 , otherwise @xmath1143",
    ".    then    1",
    ".   1 .   if case i holds for @xmath385 at the left , then @xmath47 is a left continuous evolutional period of @xmath385 for index @xmath275 if and only if @xmath47 is a left weak evolutional period of @xmath838 for pair @xmath1161 .",
    "2 .   if case ii holds for @xmath385 at the left , then condition [ contperstd ] in the definition of a left continuous evolutional period is satisfied for @xmath47 if and only if @xmath47 is a left weak evolutional period of @xmath838 for pair @xmath1162 .",
    "2 .   1 .   if case i holds for @xmath385 at the right , then @xmath47 is a right continuous evolutional period of @xmath385 for index @xmath275 if and only if @xmath47 is a right weak evolutional period of @xmath838 for pair @xmath1163 .",
    "2 .   if case ii holds for @xmath385 at the right , then condition [ contperstd ] in the definition of a right continuous evolutional period is satisfied for @xmath47 if and only if @xmath47 is a right weak evolutional period of @xmath838 for pair @xmath1164 .    let us make several obvious remarks about this definition .",
    "first , if case ii holds at the left for @xmath385 , then the left component is empty , in particular , the left preperiod is empty .",
    "so , @xmath1136 is a prefix of @xmath388 , and by corollary [ presenceoflbs ] , a suffix of the sequence @xmath1165 mentioned in condition [ contperlrbs ] is a subword of @xmath1166 if @xmath118 is large enough . informally speaking , condition [ contperlrbs ]",
    "says that @xmath1155 is periodic and that the periods of @xmath1148 and of @xmath1155 `` agree well '' .",
    "if case ii holds at the left for @xmath385 ( and the left component is empty ) , and we are trying to figure out whether @xmath47 is a left continuous evolutional period of @xmath385 for index 1 ( for the first composite central kernel ) , then it follows from lemma [ borderkernelsleft ] that the word @xmath1148 , whose periodicity is required by condition [ contperstd ] , is actually empty in this case , and the condition is always satisfied .",
    "condition [ contperlrbs ] does not say anything about this case , it only applies if @xmath1152 .    finally , we are ready to give the definition of a continuously periodic evolution .",
    "an evolution @xmath385 of @xmath33-blocks is called _ continuously periodic for an index @xmath275 ( @xmath1130 ) _ if there exist two final periods @xmath47 and @xmath328 such that @xmath47 is a left continuous evolutional period of @xmath385 for the index @xmath275 and @xmath328 is a right continuous evolutional period of @xmath385 for the index @xmath275 .",
    "an evolution @xmath385 of @xmath33-blocks is called _ continuously periodic _ if there exists an index @xmath275 ( @xmath1130 ) such that @xmath385 is continuously periodic for @xmath275 .",
    "[ onecontper ] by lemma [ regpartabslargeone ] , all evolutions of 1-blocks are continuously periodic for index 1 ( recall that there is only one composite central kernel of a 1-block ) .",
    "one more important case when an evolution of @xmath33-blocks is continuously periodic for index 1 is the case when the number of the composite central kernels of an evolution is one , and case ii holds both at the left and at the right .",
    "then all blocks in this evolution in fact consist of letters of order 1 , but this does not necessarily mean that @xmath345 , @xmath33 may be bigger than 1 if the left and the right border of this evolution are letters of order @xmath1167 . condition [ contperstd ] in the definition of a left and a right continuous evolutional period says in this case that some empty words have to be weakly periodic , and this is always true , and condition [ contperlrbs ] does not apply since there is only one composite central kernel , so such an evolution is always continuously periodic for index 1 .    after we gave the definition of a continuously periodic evolution ,",
    "the statements of propositions  [ largecompl][infordercomplstop ] are completely formulated . before we will be able to prove them , we need to give some more definitions .",
    "a sequence @xmath1168 of occurrences in @xmath44 is called a @xmath33-series of obstacles if there exists a number @xmath1169 such that :    1 .",
    "each word @xmath1170 is a weakly @xmath86-periodic word .",
    "the length of @xmath1171 strictly grows as @xmath118 grows , @xmath1172 for all @xmath575 , and there exists @xmath70 ( @xmath892 ) such that @xmath1173 is @xmath1174 for @xmath798 .",
    "3 .   if @xmath1175 , then @xmath1176 and ( if @xmath364 ) @xmath1177 are not weakly @xmath86-periodic words .    we will also need some notion of weak and continuous periodicity for @xmath33-multiblocks .",
    "let @xmath838 be an evolution of stable nonempty @xmath33-multiblocks ( @xmath828 ) .",
    "the multiblocks @xmath839 are nonempty in the multiblock sense , in other words , it is not allowed that @xmath839 contains no @xmath33-blocks and no letters of order @xmath33 , but it is allowed that @xmath839 consists of a single empty @xmath33-block if this @xmath33-block is stable .",
    "we call @xmath838 _ weakly periodic for a sequence of indices @xmath1178 _ ( @xmath1179 ) if there exist final periods @xmath1180 such that @xmath1181 is a left weak evolutional period of @xmath838 for pair @xmath1182 for all @xmath75 ( @xmath1183 ) . by remark [ contpermultcycle ] ,",
    "the left weak evolutional periods in this definition can be replaced by right weak evolutional periods , moreover , this can be done independently for each index @xmath75 .",
    "we call @xmath838 _ weakly periodic _ if there exists a sequence of indices @xmath1178 ( @xmath1184 ) such that @xmath838 is weakly periodic for @xmath1185 .",
    "we call @xmath838 _ continuously periodic for an index @xmath275 _ ( @xmath1186 ) if it is weakly periodic for indices @xmath1187 , i.  e.   if there exist two final periods @xmath47 and @xmath328 such that @xmath47 is a left weak evolutional period of @xmath838 for pair @xmath1188 , and @xmath328 is a right weak evolutional period of @xmath838 for pair @xmath1189",
    ". we call @xmath838 _ continuously periodic _ if there exists an index @xmath275 ( @xmath1186 ) such that @xmath838 is continuously periodic for @xmath275",
    ".    note that in this definition , unlike in the definition for @xmath33-blocks , we do nt have any left and right preperiods or a replacement for them , and the words whose periodicity we require ( the @xmath1188th and the @xmath1189th inner pseudoregular parts ) are a prefix and a suffix ( respectively ) of ( the forgetful occurrence of ) a @xmath33-multiblock .",
    "also , we do nt introduce any left and right bounding sequence , and speak only about periodicity of subwords of ( the forgetful occurrence of ) a @xmath33-multiblock itself .",
    "finally , a final period @xmath47 is called a _",
    "total left ( resp .",
    "right ) evolutional period _ of @xmath838 if it is a weak left ( resp .",
    "right ) evolutional period of @xmath838 for the pair @xmath1190 .",
    "@xmath838 is called _ totally periodic _ if it is weakly periodic for the indices @xmath1191 .",
    "[ nogrowthcontper ] let @xmath838 be an evolution of stable nonempty @xmath33-blocks ( @xmath828 ) such that @xmath1192 .",
    "then @xmath838 is weakly periodic for sequence @xmath1193 and is continuously periodic for index 1 .",
    "the corresponding final periods can be chosen arbitrarily since the inner pseudoregular parts in question in this case are empty occurrences .",
    "[ weakcontperinsleft ] let @xmath838 be an evolution of stable nonempty @xmath33-multiblocks ( @xmath828 ) .",
    "suppose that @xmath838 is weakly periodic for a sequence of indices @xmath1178 .",
    "suppose that @xmath1194 .",
    "then @xmath838 is also weakly periodic for sequence @xmath1195 .",
    "let @xmath47 be a right weak evolutional period of @xmath838 for pair @xmath1196 . by definition",
    "this means that @xmath1197 is a weakly right @xmath47-periodic word for all @xmath575 , and the residue of @xmath1198 modulo @xmath65 does not depend on @xmath118 .",
    "but @xmath1199 , so @xmath1200 is also a weakly right @xmath47-periodic word , and the length of @xmath942 does not depend on @xmath118 , so the residue of latexmath:[$|{\\mathop{\\mathrm{ipr}}}_{k,1,m_1}(\\mathcal f_l)|=    modulo @xmath65 does not depend on @xmath118 either .",
    "so , @xmath47 is also a right weak evolutional period of @xmath838 for pair @xmath1202 .",
    "also , any final period is a ( right ) weak evolutional period of @xmath838 for pair @xmath931 since @xmath933 is always an empty occurrence .",
    "hence , we can insert an index 1 in the sequence for which @xmath838 is weakly periodic .",
    "[ weakcontperinsright ] let @xmath838 be an evolution of stable nonempty @xmath33-multiblocks ( @xmath828 ) .",
    "suppose that @xmath838 is weakly periodic for a sequence of indices @xmath1178 .",
    "suppose that @xmath1203 .",
    "then @xmath838 is also weakly periodic for sequence @xmath1204 .",
    "the proof is completely similar to the proof of the previous lemma .",
    "our next goal is to prove for every @xmath1 that if all evolutions of @xmath33-blocks present in @xmath44 are continuously periodic , then either there exists a @xmath33-series of obstacles in @xmath44 , or all evolutions of @xmath56-blocks present in @xmath44 are continuously periodic . in order to prove this , we prove several lemmas .",
    "let @xmath838 and @xmath840 be two consecutive evolutions of stable nonempty @xmath33-multiblocks ( @xmath828 ) .",
    "suppose that @xmath838 is weakly periodic for a sequence of indices @xmath1205 and @xmath840 is weakly periodic for a sequence of indices @xmath1206 . denote the concatenation of @xmath838 and @xmath840 by @xmath843 .",
    "consider the following sequence : @xmath1207 ( the last equality is lemma [ concatcompker ] ) .",
    "in other words , we did the following .",
    "we removed the last entry @xmath1208 from the sequence @xmath275 and the first entry 0 from the sequence @xmath935 .",
    "then we added @xmath1209 to each remaining entry of the second sequence .",
    "the last remaining entry in the first sequence now coincides with the first remaining entry in the second sequence and equals @xmath955 .",
    "we remove one of these two coinciding entries and take the concatenation of the resulting two sequences .",
    "we are going to prove that @xmath843 is weakly periodic for the sequence @xmath1210 .",
    "[ concatcontper ] let @xmath838 and @xmath840 be two consecutive evolutions of stable nonempty @xmath33-multiblocks ( @xmath828 ) such that @xmath838 is weakly periodic for a sequence of indices @xmath1205 and @xmath840 is weakly periodic for a sequence of indices @xmath1206 .",
    "then the concatenation @xmath843 of @xmath838 and @xmath840 is weakly periodic for the sequence @xmath1211 .",
    "let @xmath1180 be final periods such that @xmath1181 is a left weak evolutional period of @xmath838 for pair @xmath1182 , and let @xmath1212 be final periods such that @xmath1213 is a left weak evolutional period of @xmath840 for pair @xmath1214 .",
    "consider the following sequence of final periods : @xmath1215 .",
    "in other words , we the sequence of final periods @xmath1180 , removed the last entry , took the sequence of final periods @xmath1212 , removed the first entry , and took the concatenation of the resulting two sequences .",
    "set @xmath1216 . by lemma [ concatcompker ]",
    "we see that if @xmath1217 , then @xmath1218 as an occurrence in @xmath44 for all @xmath575 . and",
    "if @xmath1219 , then @xmath1220 as an occurrence in @xmath44 for all @xmath575 .",
    "so , if @xmath1217 , then @xmath1221 is a left weak evolutional period of @xmath838 for pair @xmath1182 , hence it is also a a left weak evolutional period of @xmath843 for pair @xmath1222 . and if @xmath1219 , then @xmath1223 is a left weak evolutional period of @xmath840 for pair @xmath1224 , hence it is also a a left weak evolutional period of @xmath843 for pair @xmath1222 .",
    "therefore , @xmath843 is weakly periodic for the sequence @xmath1225 .",
    "[ concatcontpergen ] let @xmath838 and @xmath840 be two consecutive evolutions of stable nonempty @xmath33-multiblocks ( @xmath828 ) . if @xmath838 and @xmath840 are weakly periodic , then the concatenation of @xmath838 and @xmath840 is also weakly periodic .",
    "let @xmath1226 be a sequence of indices such that @xmath838 is weakly periodic for @xmath1227 .",
    "let @xmath1228 be a sequence of indices such that @xmath840 is weakly periodic for @xmath1229 .",
    "by lemma [ weakcontperinsright ] , without loss of generality ( possibly increasing @xmath22 by 1 ) , we may suppose that @xmath1230 .",
    "similarly , by lemma [ weakcontperinsleft ] , possibly increasing @xmath1231 by 1 , without loss of generality we may suppose that @xmath1232 .",
    "the claim now follows from lemma [ concatcontper ] .",
    "[ multweakper ] let @xmath1 .",
    "suppose that all evolutions of @xmath33-blocks in @xmath44 are continuously periodic .",
    "let @xmath838 be an evolution of nonempty stable @xmath33-multiblocks .",
    "then @xmath838 is weakly periodic .",
    "if each @xmath33-multiblock in @xmath838 consists of a single periodic letter of order @xmath60 , then the claim is clear by remark [ nogrowthcontper ] .",
    "if each @xmath33-multiblock in @xmath838 consists of a single @xmath33-block , then there exists an evolution @xmath385 of @xmath33-blocks and a number @xmath1138 such that @xmath839 consists of @xmath1233 for all @xmath575 . by assumption , @xmath385 is continuously periodic , and there exists an index @xmath275 ( @xmath1035 ) such that @xmath385 is continuously periodic for the index @xmath275 .",
    "now it follows from remark [ evperblockmulrel ] that there exists an index @xmath935 ( it can equal @xmath275 or @xmath764 ) such that @xmath838 is weakly periodic for the sequence @xmath1234 .    finally , the claim for general @xmath838 follows from lemma [ concatcontper ] .    [ contperexpandright ]",
    "let @xmath838 be an evolution of stable @xmath33-multiblocks .",
    "suppose that there exists a final period @xmath47 such that @xmath47 is a left weak evolutional period of @xmath838 for a pair @xmath938 ( @xmath1235 ) .",
    "suppose also that there exists a final period @xmath331 such that @xmath331 is a left weak evolutional period of @xmath838 for a pair @xmath1236 ( @xmath1237 ) .",
    "then exactly one of the following two statements is true :    1 .   @xmath47 is a left weak evolutional period of @xmath838 for pair @xmath1112 .",
    "2 .   there exists a number @xmath1238 such that the following is true for all @xmath575 .",
    "suppose that @xmath924 and @xmath1239 . then : 1 .",
    "@xmath1240 is a weakly left @xmath47-periodic word , and @xmath1241 is not a weakly left @xmath47-periodic word .",
    "2 .   @xmath1242 .",
    "@xmath1243 , i.  e.  @xmath1244 is a letter in @xmath846 .",
    "denote the remainder of @xmath1106 modulo @xmath65 by @xmath91 ( by the definition of a weak left evolutional period , @xmath91 does not depend on @xmath118 ) .",
    "set @xmath1245 . by remark [ contpermultcycle",
    "] , this is a right weak evolutional period of @xmath838 for the pair @xmath938 .",
    "we have two possibilities for @xmath1246 : either @xmath1247 is a weakly left @xmath328-periodic , or @xmath1247 is not weakly left @xmath328-periodic .",
    "if @xmath1247 is not weakly left @xmath328-periodic , denote by @xmath83 the weakly left @xmath328-periodic word of length @xmath1248 , and denote by @xmath509 the minimal ( `` the leftmost '' ) index such that @xmath1249 .",
    "then @xmath1250 is a weakly left @xmath328-periodic word , and @xmath1251 is not a weakly left @xmath328-periodic word .",
    "hence , @xmath1252 is a weakly left @xmath47-periodic word for all @xmath575 , and @xmath1253 is not a weakly left @xmath47-periodic word for all @xmath575 .",
    "set @xmath1254 . if @xmath1239 , then @xmath1255 and @xmath1256 as an occurrence in @xmath44 .",
    "the largest possible value of @xmath509 is @xmath1257 , so @xmath1258 .",
    "@xmath1244 is a letter in @xmath1259 , so @xmath1243 .",
    "suppose now that @xmath1247 is weakly left @xmath328-periodic .",
    "then for all @xmath575 , @xmath1260 is a weakly left @xmath47-periodic word .",
    "if @xmath1261 , then @xmath1262 , and we are done since in this case @xmath1263 for all @xmath575 , and @xmath1248 and the remainder of @xmath1248 modulo @xmath65 do not depend on @xmath118 .",
    "otherwise , denote @xmath1264 .",
    "then @xmath1247 is a weakly right @xmath1119-periodic word and @xmath1260 also is a weakly right @xmath1119-periodic word .",
    "denote by @xmath172 the weakly left @xmath1119-periodic word of length @xmath359 , and denote by @xmath45 the weakly left @xmath331-periodic word of length @xmath359 ( recall that @xmath331 is a left weak evolutional period of @xmath838 for the pair @xmath1236 ) .",
    "now we are considering the case when @xmath1265 , and we also have @xmath1266 , so @xmath1267 , and by corollary [ betweenkernelgrowsgood ] , @xmath1268 for all @xmath575 . since @xmath331 is a left weak evolutional period of @xmath838 for the pair @xmath1236 , @xmath45 is a prefix of @xmath1269 for all @xmath575 .",
    "again , we have two possibilities : @xmath1270 or @xmath1271 .    if @xmath1271 , denote by @xmath509 the smallest index such that @xmath1272 . then @xmath1273 is weakly left @xmath1119-periodic , and @xmath1274 is not weakly left @xmath1119-periodic .",
    "fix a number @xmath575 .",
    "let @xmath75 and @xmath77 be the indices such that @xmath924 , and let @xmath905 and @xmath1082 be the indices such that @xmath1239 . recall that @xmath45 is a prefix of @xmath1269 , that @xmath1260 is a weakly right @xmath1119-periodic word and is a weakly left @xmath47-periodic word for all @xmath575 .",
    "hence , @xmath1275 is a weakly left @xmath47-periodic word , and @xmath1276 is not a weakly left @xmath47-periodic word .",
    "so , we can set @xmath1277 and see that the claim is true in this case since @xmath509 does not depend on @xmath118 , @xmath1278 , and @xmath45 and hence @xmath1274 are prefixes of @xmath1269 , so @xmath1243 .",
    "finally , suppose that @xmath1270 .",
    "since @xmath1119 and @xmath331 are final periods , none of them can be written as a word repeated more than once by lemma [ finalnomorethanonce ] .",
    "then lemma [ finwordperiods ] implies that @xmath1279 .",
    "hence , @xmath1269 is weakly left @xmath1119-periodic for all @xmath575 and the remainder of @xmath1280 modulo @xmath1281 does not depend on @xmath118 .",
    "again , recall that @xmath1260 is a weakly right @xmath1119-periodic word and is a weakly left @xmath47-periodic word for all @xmath575 . therefore , @xmath1282 is also a weakly left @xmath47-periodic word . the remainder of @xmath1283 modulo @xmath65 does not depend on @xmath118 since the remainder of each summand modulo @xmath1284 does not depend on @xmath118 .",
    "so , in this case @xmath47 is a weak left evolutional period of @xmath838 for the pair @xmath1112    [ contperexpandstartright ] let @xmath838 be an evolution of stable @xmath33-multiblocks .",
    "suppose that there exist a final period @xmath47 such that @xmath47 is a right weak evolutional period of @xmath838 for a pair @xmath938 ( @xmath1235 ) . and",
    "@xmath47 is a right weak evolutional period of @xmath838 for a pair @xmath1285 ( @xmath1286 ) .",
    "suppose also that there exists a final period @xmath331 such that @xmath331 is a left weak evolutional period of @xmath838 for a pair @xmath1236 ( @xmath1237 ) .",
    "then there exists a left weak evolutional period of @xmath838 for pair @xmath1112 if and only if there exists a left weak evolutional period of @xmath838 for pair @xmath1287 .",
    "if @xmath1288 , then everything is clear , so suppose that @xmath1289 . then @xmath935 can not be equal to 1 , and @xmath995 , hence , @xmath1267 .",
    "also , @xmath1290 , so @xmath1291 , hence @xmath1292 and @xmath1293 .",
    "denote by @xmath91 the remainder of @xmath1106 modulo @xmath65 ( for any @xmath575 ) and set @xmath333 . by remark [ contpermultcycle ]",
    ", @xmath328 is a left weak evolutional period of @xmath838 for the pair @xmath938 . by lemma [ contperweakuniqueleft ] ,",
    "if there exists a weak left evolutional period of @xmath838 for the pair @xmath1112 , it equals @xmath328 . by lemma [ contperexpandright ] ,",
    "@xmath328 is not a left weak evolutional period of @xmath838 for the pair @xmath1112 if and only if there exists @xmath1238 such that the following is true :    for each @xmath575 , suppose that @xmath924 and @xmath1239 .",
    "then :    1 .",
    "[ perstucks ] @xmath1240 is a weakly left @xmath328-periodic word , and @xmath1241 is not a weakly left @xmath328-periodic word .",
    "2 .   @xmath1242 .",
    "@xmath1243 , i.  e.  @xmath1244 is a letter in @xmath846 .",
    "since @xmath91 is the remainder of @xmath1106 modulo @xmath1294 , @xmath329 , and @xmath1295 is a weakly left @xmath328-periodic word , condition [ perstucks ] in the list above is equivalent to the following condition : @xmath1296 is a weakly left @xmath47-periodic word , and @xmath1297 is not a weakly left @xmath47-periodic word",
    ".    therefore , a weak left evolutional period of @xmath838 for the pair @xmath1112 does not exist if and only if there exists @xmath1238 such that the following is true :    for each @xmath575 , suppose that @xmath924 and @xmath1239 .",
    "then :    1 .",
    "@xmath1296 is a weakly left @xmath47-periodic word , and @xmath1297 is not a weakly left @xmath47-periodic word .",
    "2 .   @xmath1242 .",
    "@xmath1243 , i.  e.  @xmath1244 is a letter in @xmath846 .",
    "but these conditions do not use the indices @xmath275 and @xmath905 , so we can repeat the arguments above for @xmath297 instead of @xmath275 and conclude that the nonexistence of a weak left evolutional period of @xmath838 for the pair @xmath1287 is equivalent to the same list of conditions .",
    "[ contperexpandleft ] let @xmath838 be an evolution of stable @xmath33-multiblocks .",
    "suppose that there exists a final period @xmath47 such that @xmath47 is a right weak evolutional period of @xmath838 for a pair @xmath1128 ( @xmath1298 ) .",
    "suppose also that there exists a final period @xmath331 such that @xmath331 is a right weak evolutional period of @xmath838 for a pair @xmath1299 ( @xmath1300 ) .",
    "then one of the following two statements is true :    1 .   @xmath47 is a right weak evolutional period of @xmath838 for pair @xmath1127 .",
    "2 .   there exists a number @xmath1238 such that the following is true for all @xmath575 .",
    "suppose that @xmath924 and @xmath1301 .",
    "then : 1 .",
    "@xmath1302 is a weakly right @xmath47-periodic word , and @xmath1303 is not a weakly right @xmath47-periodic word .",
    "2 .   @xmath1304 .",
    "@xmath1305 , i.  e.  @xmath1306 is a letter in @xmath846 .",
    "the proof is completely symmetric to the proof of lemma [ contperexpandright ] .",
    "[ contperexpandstartleft ] let @xmath838 be an evolution of stable @xmath33-multiblocks .",
    "suppose that there exist a final period @xmath47 such that @xmath47 is a left weak evolutional period of @xmath838 for a pair @xmath1128 ( @xmath1298 ) .",
    "and @xmath47 is a left weak evolutional period of @xmath838 for a pair @xmath1307 ( @xmath1308 ) .",
    "suppose also that there exists a final period @xmath331 such that @xmath331 is a right weak evolutional period of @xmath838 for a pair @xmath1299 ( @xmath1300 ) .",
    "then there exists a right weak evolutional period of @xmath838 for pair @xmath1127 if and only if there exists a right weak evolutional period of @xmath838 for pair @xmath1309 .",
    "the proof is completely symmetric to the proof of corollary [ contperexpandstartright ] .",
    "[ contperexpandmultiright ] let @xmath838 be an evolution of stable nonempty @xmath33-multiblocks ( @xmath828 ) .",
    "suppose that @xmath838 is weakly periodic for a sequence of indices @xmath1178 , where @xmath774 .",
    "let @xmath1310 be an index ( @xmath1311 ) and let @xmath47 be a right weak evolutional period of @xmath838 for pair @xmath1312 .",
    "suppose also that @xmath47 is not a right weak evolutional period of @xmath838 for pair @xmath1313 .",
    "then there are two possibilities :    1 .",
    "@xmath838 is weakly periodic for the following sequence of indices : @xmath1314 .",
    "2 .   there exists a @xmath33-series of obstacles in @xmath44 .    if @xmath1315 , then everything is clear .",
    "suppose that @xmath1316 .",
    "since @xmath47 is not a right weak evolutional period of @xmath838 for the pair @xmath1313 , it follows from lemma [ contperexpandleft ] that there exists @xmath1238 ( @xmath508 does not depend on @xmath118 ) such that for all @xmath575 , if @xmath1317 , then @xmath1302 is a weakly right @xmath47-periodic word , and @xmath1303 is not a weakly right @xmath47-periodic word . again , denote the residue of @xmath1318 for any @xmath575 by @xmath91 and denote @xmath333 .",
    "then @xmath328 is a weak left evolutional period of @xmath838 for pair @xmath1312 , and , if @xmath1317 , then @xmath1319 is a weakly right @xmath328-periodic word , and @xmath1320 is not a weakly right @xmath328-periodic word .",
    "now let @xmath1321 be the maximal index ( @xmath1322 ) such that @xmath328 is a weak left evolutional period of @xmath838 for pair @xmath1323 .",
    "if @xmath1324 , then @xmath838 is weakly periodic for the sequence @xmath1314 , and we are done .",
    "suppose that @xmath1325 .",
    "then , since @xmath1321 is maximal , it follows from lemma [ contperexpandright ] that there exists @xmath1326 ( @xmath877 does not depend on @xmath118 ) such that for all @xmath575 , if @xmath1327 , then @xmath1328 is a weakly left @xmath328-periodic word , and @xmath1329 is not a weakly left @xmath328-periodic word .",
    "note also that if @xmath1317 and @xmath1327 , then , by the definition of an inner pseudoregular part , @xmath1330 .",
    "summarizing , we have the following weakly periodic and non - weakly periodic words .",
    "fix @xmath575 and let @xmath905 and @xmath1331 be the indices such that @xmath1332 .",
    "the following two occurrences in @xmath1166 are weakly @xmath1333-periodic : @xmath1319 with right period @xmath328 and @xmath1334 with left period @xmath328 . and the following two occurrences are * not * weakly @xmath1333-periodic with right and left period @xmath328 , respectively : @xmath1320 with right period @xmath328 and @xmath1335 with left period @xmath328 .",
    "denote @xmath1336 .",
    "then @xmath1337 is a weakly left @xmath1119-periodic word , @xmath1338 , and @xmath1339 is not a weakly left @xmath1119-periodic word . in other words , if @xmath1340 is the residue of @xmath1341 modulo @xmath1281 , then @xmath1342 .",
    "set @xmath1343 and set @xmath1344 .",
    "let us prove that @xmath1168 is a @xmath33-series of obstacles in @xmath44 .",
    "we have @xmath1345 .",
    "by lemma [ betweenkernelgrows ] ( here we use the fact that @xmath1346 , so @xmath1347 ) , @xmath1348 strictly grows as @xmath118 grows , @xmath1349 , and there exists @xmath1350 ( @xmath892 ) such that @xmath1348 is @xmath1174 for @xmath1091 . since @xmath1351 do not depend on @xmath118 , @xmath1173 also strictly grows as @xmath118 grows , @xmath1172 , and @xmath1173 is @xmath1174 for @xmath1091 .",
    "now let us check the required weak @xmath86-periodicity for the definition of a @xmath33-series of obstacles .",
    "we already know that @xmath1170 is a weakly @xmath86-periodic word with left period @xmath1119 . since @xmath47 is a final period , @xmath1352 , and @xmath1353 , while @xmath1354 , so @xmath1355 is not a weakly @xmath86-periodic word .",
    "similarly , if @xmath1340 is the residue of @xmath1341 modulo @xmath1281 , then @xmath1342 , but since @xmath1356 , we have @xmath1357 , so @xmath1339 is not a weakly @xmath86-periodic word .",
    "( we knew before that @xmath1339 is not a weakly @xmath86-periodic word with left period @xmath1119 , but it is important here that @xmath1356 , otherwise we could have @xmath1358 , and then @xmath1339 would be a weakly @xmath86-periodic word with another left period . )",
    "[ contperexpandmultileft ] let @xmath838 be an evolution of stable nonempty @xmath33-multiblocks ( @xmath828 ) .",
    "suppose that @xmath838 is weakly periodic for a sequence of indices @xmath1178 , where @xmath774 .",
    "let @xmath1310 be an index ( @xmath1311 ) and let @xmath47 be a left weak evolutional period of @xmath838 for pair @xmath1359 .",
    "suppose also that @xmath47 is not a left weak evolutional period of @xmath838 for pair @xmath1313 .",
    "then there are two possibilities :    1 .",
    "@xmath838 is weakly periodic for the following sequence of indices : @xmath1360 .",
    "2 .   there exists a @xmath33-series of obstacles in @xmath44 .",
    "the proof is completely symmetric to the proof of the previous lemma .",
    "[ contperexpandtotalright ] let @xmath838 and @xmath840 be two consecutive evolutions of stable nonempty @xmath33-multiblocks ( @xmath828 ) , and let @xmath843 be their concatenation .",
    "suppose that @xmath985 , and @xmath838 is weakly periodic for a sequence of indices @xmath1178 , where @xmath1203 ( @xmath1361 , and @xmath292 is allowed ) .",
    "suppose that @xmath843 is also weakly periodic for the following sequence : @xmath1362 .",
    "then @xmath840 is totally periodic , moreover , if @xmath47 is the ( unique by corollary [ contperweakuniqueright ] ) right weak evolutional period of @xmath838 for the pair @xmath1363 , then @xmath47 is also a total left evolutional period of @xmath840 .",
    "let @xmath328 be the ( unique by corollary [ contperweakuniqueleft ] ) left weak evolutional period of @xmath838 for the pair @xmath1363 .",
    "by lemma [ weakcontperinsright ] , @xmath838 is weakly periodic for the sequence @xmath1364 , and by lemma [ contperweakuniquewideleft ] , the left weak evolutional period of @xmath838 for the pair @xmath1365 also equals @xmath328 . by lemma [ concatcompker ] , @xmath1366 as an occurrence in @xmath44 for all @xmath575 , so @xmath328 is also the left weak evolutional period of @xmath843 for the pair @xmath1365 .",
    "now , by lemma [ contperweakuniquewideleft ] again , the left weak evolutional period of @xmath843 for the pair @xmath1367 ( it exists by assumption ) also equals @xmath328 .",
    "denote the residue of @xmath1368 modulo @xmath1333 by @xmath91 . by remark [ contpermultcycle ] , @xmath329 . by lemma [ concatcompker ] , @xmath1369 . we know that @xmath1370 is a weakly left @xmath328-periodic word , hence @xmath1371 is a weakly left @xmath47-periodic word .",
    "since @xmath328 is both the weak left evolutional period of @xmath838 for the pair @xmath1363 and the weak left evolutional period of @xmath843 for the pair @xmath1367 , the residues of @xmath1368 and of @xmath1372 modulo @xmath1373 do not depend on @xmath118 .",
    "hence , the residue of latexmath:[$|{\\mathop{\\mathrm{fg}}}(\\mathcal f'_l)|=     modulo @xmath65 does not depend on @xmath118 , and @xmath47 is a left weak evolutional period of @xmath840 for the pair @xmath1375 .",
    "[ contperexpandtotalleft ] let @xmath840 and @xmath838 be two consecutive evolutions of stable nonempty @xmath33-multiblocks ( @xmath828 ) , and let @xmath843 be their concatenation .",
    "suppose that @xmath985 , and @xmath838 is weakly periodic for a sequence of indices @xmath1178 , where @xmath1194 ( @xmath1361 , and @xmath292 is allowed ) .",
    "suppose that @xmath843 is also weakly periodic for the following sequence : @xmath1376 .",
    "then @xmath840 is totally periodic , moreover , if @xmath47 is the ( unique by corollary [ contperweakuniqueleft ] ) left weak evolutional period of @xmath838 for the pair @xmath1196 , then @xmath47 is also a total right evolutional period of @xmath840 .",
    "the proof is completely similar to the proof of the previous lemma .",
    "[ contperexpandtotalrightgood ] let @xmath1 .",
    "suppose that all evolutions of @xmath33-blocks in @xmath44 are continuously periodic .",
    "let @xmath838 and @xmath840 be two consecutive evolutions of stable nonempty @xmath33-multiblocks , and let @xmath843 be their concatenation .",
    "suppose that @xmath985 , and @xmath838 is weakly periodic for a sequence of indices @xmath1178 , where @xmath774 , and @xmath1203 .",
    "let @xmath47 be the ( unique by corollary [ contperweakuniqueright ] ) right weak evolutional period of @xmath838 for the pair @xmath1363 suppose also that @xmath47 is not a right weak evolutional period of @xmath838 for pair @xmath1377 .",
    "then there are two possibilities :    1 .",
    "@xmath840 is totally periodic , moreover , @xmath47 is a left total evolutional period of @xmath840 .",
    "2 .   there exists a @xmath33-series of obstacles in @xmath44 .    by lemma [ multweakper ]",
    ", @xmath840 is weakly periodic for some sequence of indices @xmath1378 . by lemma [ weakcontperinsleft ] , without loss of generality we may suppose that @xmath1232 . by lemma [ weakcontperinsright ] , @xmath838 is also weakly periodic for the sequence @xmath1379 . by lemma [ concatcontper ] , @xmath843 is weakly periodic for the sequence @xmath1380 . in particular , there exists a right weak evolutional period @xmath328 of @xmath843 for the pair @xmath1365 .",
    "we are going to use lemma [ contperexpandmultiright ] . to use it",
    ", we have to prove that @xmath328 is not a weak right evolutional period of @xmath843 for the pair @xmath1381 .",
    "assume the contrary .",
    "by lemma [ concatcompker ] , @xmath1382 as an occurrence in @xmath44 for all @xmath575 . hence , @xmath328 is then also a a weak right evolutional period of @xmath838 for the pair @xmath1381 .",
    "we already know that @xmath838 is weakly periodic for the sequence @xmath1379 , so there exists a weak right evolutional period of @xmath838 for the pair @xmath1365 , and by lemma [ contperweakuniquewideright ] , this period must also be @xmath328 . since @xmath1383 is always an empty occurrence ,",
    "any final period @xmath331 is a left weak evolutional period of @xmath838 for the pair @xmath1384 .",
    "now @xmath328 and @xmath331 satisfy the conditions of corollary [ contperexpandstartright ] , and it implies that there exists a left weak evolutional period of @xmath838 for the pair @xmath1385 if and only if there exists a left weak evolutional period of @xmath838 for pair @xmath1363 . by remark [ contpermultcycle ] ,",
    "we can replace left periods with right ones in this statement , in other words , there exists a right weak evolutional period of @xmath838 for the pair @xmath1385 if and only if there exists a right weak evolutional period of @xmath838 for pair @xmath1363 .",
    "but we know that @xmath47 is a weak right evolutional period of @xmath838 for the pair @xmath1363 , so a weak right evolutional period of @xmath838 for the pair @xmath1385 also exists , and by lemma [ contperweakuniquewideright ] , it also equals @xmath47 , but this contradicts the conditions of the lemma .    therefore , @xmath328 is not a weak right evolutional period of @xmath843 for the pair @xmath1381 . by lemma [ contperexpandmultiright ] , either there exists a @xmath33-sequence of obstacles in @xmath44 , or @xmath843 is weakly periodic for the sequence of indices @xmath1386 . in the latter case",
    "the claim follows directly from lemma [ contperexpandtotalright ] .",
    "[ contperexpandtotalleftgood ] let @xmath1 .",
    "suppose that all evolutions of @xmath33-blocks in @xmath44 are continuously periodic .",
    "let @xmath840 and @xmath838 be two consecutive evolutions of stable nonempty @xmath33-multiblocks , and let @xmath843 be their concatenation .",
    "suppose that @xmath985 , and @xmath838 is weakly periodic for a sequence of indices @xmath1178 , where @xmath774 , and @xmath1194 .",
    "let @xmath47 be the ( unique by corollary [ contperweakuniqueleft ] ) left weak evolutional period of @xmath838 for the pair @xmath1196 suppose also that @xmath47 is not a left weak evolutional period of @xmath838 for pair @xmath1387 .",
    "then there are two possibilities :    1 .",
    "@xmath840 is totally periodic , moreover , @xmath47 is a right total evolutional period of @xmath840 .",
    "2 .   there exists a @xmath33-series of obstacles in @xmath44 .",
    "the proof is completely symmetric to the proof of the previous lemma .",
    "[ contperallmultiblocks ] let @xmath1 .",
    "suppose that all evolutions of @xmath33-blocks in @xmath44 are continuously periodic .",
    "let @xmath838 be an evolution of stable nonempty @xmath33-multiblocks .",
    "then at least one of the following is true :    1 .",
    "@xmath838 is continuously periodic .",
    "2 .   there exists a @xmath33-series of obstacles in @xmath44 .    by lemma [ multweakper ] , @xmath838 is weakly periodic for some sequence of indices @xmath1178",
    ". let @xmath1310 ( @xmath1388 ) be the maximal index such that @xmath838 is weakly periodic for the sequence @xmath1389 .",
    "if @xmath1390 , in other words , if @xmath838 is weakly periodic for the sequence @xmath1391 , then by lemma [ weakcontperinsright ] , @xmath838 is also weakly periodic for the sequence @xmath1392 , and this by definition means that @xmath838 is continuously periodic .",
    "now suppose that @xmath1393 , then @xmath774 .",
    "let @xmath328 be a final period such that @xmath328 is a weak right evolutional period of @xmath838 for the pair @xmath1312",
    ". then @xmath328 can not be a weak right evolutional period for the pair @xmath1394 as well , otherwise @xmath838 would also be weakly periodic for the sequence @xmath1395 , and this is a contradiction with the fact that @xmath1310 was chosen as a maximal index such that @xmath838 is weakly periodic for the sequence @xmath1389 .",
    "so , we can use lemma [ contperexpandmultiright ] .",
    "it implies that either there exists a @xmath33-series of obstacles in @xmath44 , or @xmath838 is weakly periodic for the sequence @xmath1396 , so @xmath838 is continuously periodic for the index @xmath1397 directly by the definition .",
    "[ contpercr ] let @xmath1 .",
    "suppose that all evolutions of @xmath33-blocks in @xmath44 are continuously periodic .",
    "let @xmath385 be an evolution of @xmath56-blocks , and let @xmath838 be the following evolution of stable nonempty @xmath33-multiblocks : @xmath1398 .",
    "then at least one of the following is true :    1 .",
    "@xmath838 is continuously periodic .",
    "2 .   there exists a @xmath33-series of obstacles in @xmath44 .",
    "now we are going to prove some periodicity properties for the ( left and right ) regular parts of @xmath56-blocks or to find a @xmath33-series of obstacles provided that we know that all evolutions of @xmath33-blocks are continuously periodic .",
    "[ atleastonetotal ] let @xmath1 .",
    "suppose that all evolutions of @xmath33-blocks in @xmath44 are continuously periodic .",
    "let @xmath838 , @xmath840 and @xmath843 be three consecutive evolutions of stable nonempty @xmath33-multiblocks .",
    "suppose that @xmath1399 .",
    "then at least one of the following is true :    1 .",
    "at least one of the evolutions @xmath838 , @xmath840 , and @xmath843 is totally periodic .",
    "2 .   there exists a @xmath33-series of obstacles in @xmath44 .",
    "first , apply lemma [ contperallmultiblocks ] to @xmath840 .",
    "either there exists a @xmath33-series of obstacles in @xmath44 ( and then we are done ) , or there exists an index @xmath275 ( @xmath1400 ) such that @xmath840 is continuously periodic for @xmath275 .",
    "suppose that @xmath1152 .",
    "denote the ( unique by corollary [ contperweakuniqueleft ] ) left weak evolutional period of @xmath840 for the pair @xmath1188 by @xmath47 . if @xmath47 is also a weak left evolutional period of @xmath840 for the pair @xmath1375 , @xmath840 is totally periodic , and we are done .",
    "otherwise , by lemma [ contperexpandtotalleftgood ] , either @xmath838 is totally periodic , or there is a @xmath33-series of obstacles in @xmath44 .",
    "now let us consider the case when @xmath580 .",
    "denote the ( unique by corollary [ contperweakuniqueright ] ) right weak evolutional period of @xmath840 for the pair @xmath1401 by @xmath328 .",
    "if @xmath328 is also a weak right evolutional period of @xmath840 for the pair @xmath1375 , @xmath840 is totally periodic . otherwise , by lemma [ contperexpandtotalrightgood ] , either @xmath843 is totally periodic , or there is a @xmath33-series of obstacles in @xmath44 .",
    "[ atleastonereallytotal ] let @xmath838 , @xmath840 and @xmath843 be three consecutive evolutions of stable nonempty @xmath33-multiblocks ( @xmath828 ) .",
    "suppose that @xmath838 , @xmath840 , and @xmath843 are totally periodic .",
    "suppose also that @xmath985 , @xmath1399 , and @xmath1402 .",
    "let @xmath47 ( resp .",
    "@xmath328 ) be the ( unique by corollary [ contperweakuniqueright ] ) total right evolutional period of @xmath838 ( resp .  of @xmath840 ) , and let @xmath334 ( resp @xmath1403 ) be the ( unique by corollary [ contperweakuniqueleft ] ) total left evolutional period of @xmath840 ( resp .  of @xmath843 ) .",
    "then at least one of the following is true :    1 .",
    "2 .   @xmath1405 .",
    "3 .   there exists a @xmath33-series of obstacles in @xmath44 .    by lemma [ weakcontperinsleft ]",
    ", @xmath838 is also weakly periodic for the sequence @xmath1406 . by lemma [ weakcontperinsright ]",
    ", @xmath840 is also weakly periodic for the sequence @xmath1407 .",
    "denote the concatenation of @xmath838 and @xmath840 by @xmath1408 . by lemma [ concatcontper ] , @xmath1408 is weakly periodic for the sequence @xmath1409 .    by lemma [ contperweakuniquewideright ] , the right weak evolutional period of @xmath840 for the pair @xmath1410 equals @xmath328 . by lemma [ concatcompker ] , @xmath1411 as an occurrence in @xmath44 for all @xmath575",
    ", so @xmath328 is also a right weak evolutional period of @xmath1408 for the pair @xmath1412 .",
    "suppose first that @xmath328 is also a weak right evolutional period of @xmath1408 for the pair @xmath1413 .",
    "then , since @xmath840 is totally periodic , we can use lemma [ contperexpandtotalleft ] .",
    "it implies that @xmath334 , which is a left weak evolutional period of @xmath840 for the pair @xmath1375 , is also a right total evolutional period of @xmath838 .",
    "then it follows from corollary [ contperweakuniqueright ] that @xmath1404 .",
    "now let us consider the case when @xmath328 is not a weak right evolutional period of @xmath1408 for the pair @xmath1413 .",
    "then , by lemma [ contperexpandtotalrightgood ] , either there exists a @xmath33-series of obstacles in @xmath44 , or @xmath328 is a left total evolutional period of @xmath843 . in the latter case , @xmath1405 by corollary [ contperweakuniqueleft ] .    [ oneperenoughfortotleft ] let @xmath1 .",
    "suppose that all evolutions of @xmath33-blocks in @xmath44 are continuously periodic .",
    "let @xmath838 be an evolution of stable nonempty @xmath33-multiblocks , and let @xmath47 be a final period .",
    "suppose that there exists @xmath1414 such that @xmath1415 is a weakly left @xmath47-periodic word .",
    "then @xmath47 is a left total period of @xmath838 .    by lemma [ multweakper ]",
    ", @xmath838 is weakly periodic for a sequence of indices @xmath1178 . by lemma [ weakcontperinsleft ] , without loss of generality we may suppose that @xmath1416 . since @xmath933 is always an empty word , @xmath47 is a weak left evolutional period of @xmath838 for the pair @xmath931 .",
    "let @xmath1310 ( @xmath1388 ) be the maximal index such that @xmath47 is a weak left evolutional period of @xmath838 for the pair @xmath1417 .",
    "if @xmath1390 , we are done .    otherwise , we are going to get a contradiction using lemma [ contperexpandright ] .",
    "denote @xmath1418 and @xmath1419 .",
    "if @xmath47 is not a weak left evolutional period of @xmath838 for the pair @xmath1394 , then lemma [ contperexpandright ] implies that there exists @xmath1238 such that @xmath1420 is not a weakly left @xmath47-periodic word , and @xmath1243 , i.  e.  @xmath1244 is a letter in @xmath1421 .",
    "but then @xmath1420 is a prefix of @xmath1415 , and @xmath1415 is weakly left @xmath47-periodic , a contradiction .",
    "the following lemma can be proved symmetrically .",
    "[ oneperenoughfortotright ] let @xmath1 .",
    "suppose that all evolutions of @xmath33-blocks in @xmath44 are continuously periodic .",
    "let @xmath838 be an evolution of stable nonempty @xmath33-multiblocks , and let @xmath47 be a final period .",
    "suppose that there exists @xmath1414 such that @xmath1415 is a weakly right @xmath47-periodic word .",
    "then @xmath47 is a right total period of @xmath838 .",
    "[ atleasttwokersleft ] let @xmath1 .",
    "let @xmath385 be an evolution of @xmath56-blocks such that case i holds at the left .",
    "let @xmath1422 .",
    "then @xmath1423 , where @xmath1424 , is an evolution of stable nonempty @xmath33-multiblocks , and @xmath985 .",
    "the stability follows from corollary [ regpartstablekminusone ] ( and from the definition of the left regular part of @xmath1425 ) , and the nonemptiness follows from the definition of case i.    by lemma [ caseoneexistsleft ] , there exists a @xmath33-block @xmath76 in @xmath1426 such that case i holds at the left or at the right for the evolution of @xmath76 . denote the evolution @xmath76 belongs to by @xmath739 .",
    "then , by the definitions of the descendant of a @xmath33-multiblock and of a left atom , there exists @xmath1414 such that @xmath1427 contains @xmath1428 for all @xmath575 . by lemma [ regpartasym ] ,",
    "@xmath1429 is @xmath812 for @xmath798 .",
    "hence , @xmath1430 can not be bounded for @xmath798 .",
    "but if @xmath1192 , then @xmath1431 for all @xmath575 , and in particular , @xmath1430 is bounded for @xmath798 . therefore , @xmath985 .",
    "the proof of the following lemma is completely symmetric .",
    "[ atleasttwokersright ] let @xmath1 .",
    "let @xmath385 be an evolution of @xmath56-blocks such that case i holds at the right .",
    "let @xmath1422 .",
    "then @xmath1423 , where @xmath1432 , is an evolution of stable nonempty @xmath33-multiblocks , and @xmath985 .",
    "[ onelatotal ] let @xmath1 .",
    "suppose that all evolutions of @xmath33-blocks in @xmath44 are continuously periodic .",
    "let @xmath385 be an evolution of @xmath56-blocks such that case i holds at the left .",
    "consider the following evolution of stable nonempty ( by lemma [ atleasttwokersleft ] ) @xmath33-multiblocks : @xmath1433 .",
    "at least one of the following is true :    1 .",
    "@xmath838 is totally periodic .",
    "2 .   there exists a @xmath33-series of obstacles in @xmath44 .",
    "first , consider the following three evolutions of stable nonempty @xmath33-multiblocks : @xmath1434 , @xmath1435 , and @xmath1436 . by lemma [ atleasttwokersleft ] for @xmath1437 ( resp .  for @xmath1438 , for @xmath1439 )",
    ", we have @xmath1399 ( resp .",
    "@xmath1402 , @xmath1440 ) . also",
    ", these three evolutions are consecutive , so , by lemma [ atleastonetotal ] , either there exists a @xmath33-series of obstacles in @xmath44 ( and then we are done ) , or at least one of these three evolutions is totally periodic .",
    "suppose now that at least one of the evolutions @xmath840 , @xmath843 , and @xmath1408 is totally periodic .",
    "in other words , there exists a final period @xmath47 and a number @xmath275 ( @xmath275 can equal 0 , 1 , or 2 ) such that for all @xmath575 , @xmath1441 is a weakly left @xmath47-periodic word , and the residue of @xmath1442 modulo @xmath65 does not depend on @xmath118 . by corollary [ atomsperiodicitysmallleft ] , @xmath1443 as an abstract word .",
    "therefore , @xmath47 is a left total evolutional period of the following evolution of stable @xmath33-multiblocks : @xmath1444    therefore , @xmath47 is a total left evolutional period of @xmath838 by lemma [ oneperenoughfortotleft ] .",
    "[ oneratotal ] let @xmath1 .",
    "suppose that all evolutions of @xmath33-blocks in @xmath44 are continuously periodic .",
    "let @xmath385 be an evolution of @xmath56-blocks such that case i holds at the right .",
    "consider the following evolution of stable nonempty ( by lemma [ atleasttwokersright ] ) @xmath33-multiblocks : @xmath1445 .",
    "at least one of the following is true :    1 .",
    "@xmath838 is totally periodic .",
    "2 .   there exists a @xmath33-series of obstacles in @xmath44 .",
    "the proof is completely symmetric to the proof of the previous lemma .",
    "[ alllatotal ] let @xmath1 .",
    "suppose that all evolutions of @xmath33-blocks in @xmath44 are continuously periodic .",
    "let @xmath385 be an evolution of @xmath56-blocks such that case i holds at the left .",
    "at least one of the following is true :    1 .   there exists a unique final period @xmath47 and a number @xmath91 ( @xmath1446 ) such that for all @xmath601 , @xmath47 is a left total period of the evolution @xmath838 of stable nonempty ( by lemma [ atleasttwokersright ] ) @xmath33-multiblocks defined by @xmath1447 , moreover , the residue of @xmath1448 always equals @xmath91 ( i.  e.  it does not depend on @xmath275 ) .",
    "2 .   there exists a @xmath33-series of obstacles in @xmath44 .    by lemma [ onelatotal ] , either there exists a @xmath33-series of obstacles in @xmath44 ( and then we are done ) , or the evolution @xmath840 of stable nonempty @xmath33-multiblocks defined by @xmath1449 is totally periodic .",
    "suppose that @xmath840 is totally periodic .",
    "since @xmath1399 by lemma [ atleasttwokersleft ] , it follows from corollary [ contperweakuniqueleft ] that the left total evolutional period of @xmath840 is unique , denote it by @xmath47 .",
    "denote by @xmath91 the remainder of @xmath1450 modulo @xmath65 ( it does not depend on @xmath118 by the definition of a weak left evolutional period ) .",
    "then @xmath1451 is a weakly left @xmath47-periodic word for all @xmath575 . by corollary [ atomsperiodicitysmallleft ] , @xmath1452 as an abstract word .",
    "hence , for all @xmath575 and @xmath601 , @xmath1453 is a weakly left @xmath47-periodic word , and the residue of @xmath1448 equals @xmath91 .",
    "therefore , @xmath47 is a left total period of the evolution @xmath838 of stable nonempty @xmath33-multiblocks defined by @xmath1447 .",
    "[ allratotal ] let @xmath1 .",
    "suppose that all evolutions of @xmath33-blocks in @xmath44 are continuously periodic .",
    "let @xmath385 be an evolution of @xmath56-blocks such that case i holds at the right .",
    "at least one of the following is true :    1 .   there exists a unique final period @xmath47 and a number @xmath91 ( @xmath1446 ) such that for all @xmath601 , @xmath47 is a right total period of the evolution @xmath838 of stable nonempty ( by lemma [ atleasttwokersright ] ) @xmath33-multiblocks defined by @xmath1454 , moreover , the residue of @xmath1455 always equals @xmath91 ( i.  e.  it does not depend on @xmath275 ) .",
    "2 .   there exists a @xmath33-series of obstacles in @xmath44 .",
    "the proof is completely symmetric to the proof of the previous lemma .",
    "[ leftrightcompleteperiod ] let @xmath47 be a final period .",
    "let @xmath45 be a finite word .",
    "suppose that @xmath45 is weakly @xmath65-periodic with both left and right period @xmath47 , and @xmath355 .",
    "then @xmath45 is a completely @xmath47-periodic word .",
    "denote the remainder of @xmath73 modulo @xmath65 by @xmath91 .",
    "set @xmath1456 .",
    "then @xmath45 is a weakly right @xmath328-periodic word .",
    "since @xmath47 is a final period , by lemma [ finalnomorethanonce ] , @xmath47 can not be written as a word repeated more than once , so , by lemma [ finwordperiods ] , @xmath358 .",
    "assume that @xmath1457 .",
    "then the equality @xmath1113 means that @xmath1458 and @xmath1459 .",
    "consider the word @xmath1460 .",
    "let us check that @xmath83 is a weakly @xmath91-periodic word . to see this",
    ", we have to check that @xmath1461 for @xmath1462 ( in other words , @xmath1463 ) .",
    "consider the following three cases for @xmath75 :    \\1 . @xmath1464 .",
    "then @xmath1465 since @xmath1459 .",
    "\\2 . @xmath1466 .",
    "then @xmath1467 since @xmath1458 .",
    "\\3 . @xmath1468 .",
    "then @xmath1469 since @xmath1459 .    therefore , @xmath83 is a weakly @xmath91-periodic word , and @xmath1470 .",
    "clearly , @xmath83 is also a weakly left @xmath47-periodic word and @xmath1471 .",
    "then lemma [ finwordperiods ] implies that there exists a finite word @xmath331 such that @xmath47 is @xmath331 repeated several times ( an integer number of times , so @xmath65 is divisible by @xmath1472 ) , and @xmath91 is also divisible by @xmath1472 .",
    "but then @xmath1473 , and @xmath47 is @xmath331 repeated more than once . but",
    "this contradicts lemma [ finalnomorethanonce ] .",
    "[ alllareallytotal ] let @xmath1 .",
    "suppose that all evolutions of @xmath33-blocks in @xmath44 are continuously periodic .",
    "let @xmath385 be an evolution of @xmath56-blocks such that case i holds at the left .",
    "at least one of the following is true :    1 .   there exists a unique final period @xmath47 such that for all @xmath575 and @xmath601 , @xmath1453 is a * completely * @xmath47-periodic word .",
    "2 .   there exists a @xmath33-series of obstacles in @xmath44 .",
    "suppose that @xmath33-series of obstacles do not exist in @xmath44 .",
    "then , by lemma [ alllatotal ] , there exists a final period @xmath47 and a number @xmath91 ( @xmath1446 ) such that for all @xmath575 and @xmath601 , @xmath1453 is a weakly left @xmath47-periodic word , and the residue of @xmath1448 modulo @xmath65 equals @xmath91 .",
    "it is sufficient to prove that @xmath92 .",
    "again , consider the following three evolutions of stable nonempty @xmath33-multiblocks : @xmath1434 , @xmath1435 , and @xmath1436 .",
    "then @xmath47 is the total left evolutional period of each of them . by lemma [ atleastonereallytotal ]",
    ", @xmath47 is also the total right evolutional period of at least one of the evolutions @xmath840 or @xmath843 .",
    "so , at least one of the words @xmath1474 and @xmath1475 is a weakly @xmath65-periodic word with both left and right period @xmath47 . denote this word by @xmath45 . by corollary [ betweenkernelgrowsgood ] , @xmath355 . by lemma [ leftrightcompleteperiod ] , @xmath45 is a completely @xmath47-periodic word , and @xmath73 is divisible by @xmath65 .",
    "but we also know that the residue of @xmath73 modulo @xmath65 equals @xmath91 , so @xmath92",
    ".    therefore , all words @xmath1453 for all @xmath575 and @xmath601 are completely @xmath47-periodic .",
    "[ lrperiodic ] let @xmath1 .",
    "suppose that all evolutions of @xmath33-blocks in @xmath44 are continuously periodic .",
    "let @xmath385 be an evolution of @xmath56-blocks such that case i holds at the left .",
    "at least one of the following is true :    1 .   there exists a unique final period @xmath47 such that for all @xmath575 , @xmath1476 is a completely @xmath47-periodic word .",
    "@xmath47 is also a total left and a total right period of the evolution @xmath838 of stable nonempty @xmath33-multiblocks defined by @xmath1433 .",
    "2 .   there exists a @xmath33-series of obstacles in @xmath44 .",
    "[ allrareallytotal ] let @xmath1 .",
    "suppose that all evolutions of @xmath33-blocks in @xmath44 are continuously periodic .",
    "let @xmath385 be an evolution of @xmath56-blocks such that case i holds at the right .",
    "at least one of the following is true :    1 .   there exists a unique final period @xmath47 such that for all @xmath575 and @xmath601 , @xmath1477 is a * completely * @xmath47-periodic word .",
    "2 .   there exists a @xmath33-series of obstacles in @xmath44 .",
    "the proof is completely symmetric to the proof of lemma [ alllareallytotal ] .",
    "[ rrperiodic ] let @xmath1 .",
    "suppose that all evolutions of @xmath33-blocks in @xmath44 are continuously periodic .",
    "let @xmath385 be an evolution of @xmath56-blocks such that case i holds at the right .",
    "at least one of the following is true :    1 .   there exists a unique final period @xmath47 such that for all @xmath575 , @xmath1478 is a completely @xmath47-periodic word .",
    "@xmath47 is also a total left and a total right period of the evolution @xmath838 of stable nonempty @xmath33-multiblocks defined by @xmath1445 .",
    "2 .   there exists a @xmath33-series of obstacles in @xmath44 .",
    "now we are going to prove some facts about the periodicity of left and right bounding sequences of evolutions of @xmath56-blocks such that case ii holds at the right or at the left .",
    "[ rbsperiodic ] let @xmath1 .",
    "let @xmath385 be an evolution of @xmath56-blocks such that case ii holds at the right .",
    "let @xmath1479 , and let @xmath838 be an evolution of stable nonempty @xmath33-multiblocks such that @xmath846 is a suffix of @xmath1233 for all @xmath575 .",
    "suppose that @xmath838 is continuously periodic for an index @xmath275 ( @xmath958 ) .",
    "let @xmath47 be the ( unique by corollary [ contperweakuniqueright ] ) weak right evolutional period of @xmath838 for the pair @xmath1189 .",
    "then there are three possibilities :    1 .",
    "@xmath838 is totally periodic .",
    "@xmath1480 is periodic with period @xmath47 .",
    "3 .   there exists a @xmath33-series of obstacles in @xmath44 .",
    "suppose that @xmath33-series of obstacles do not exist in @xmath44 and that @xmath838 is not totally periodic .",
    "then , since @xmath838 is continuously periodic for the index @xmath275 , lemma [ contperexpandleft ] implies that there exists a number @xmath1238 such that for all @xmath575 , if @xmath924 and @xmath1481 , then @xmath1482 is a weakly right @xmath47-periodic word , and @xmath1483 is not a weakly right @xmath47-periodic word .",
    "assume that @xmath1480 is not an infinite periodic sequence with period @xmath47 .",
    "then there exists a number @xmath1484 such that @xmath1485 is a weakly left @xmath47-periodic word , and @xmath1486 is not a weakly left @xmath47-periodic word .",
    "we are going to find a @xmath33-series of obstacles in @xmath44 .    by corollary [ presenceofrbs ]",
    ", there exists @xmath1487 such that if @xmath575 and @xmath1488 , then @xmath1489 . without loss of generality , @xmath1490 .",
    "fix a number @xmath575 .",
    "suppose that @xmath1488 .",
    "then @xmath1491 is a suffix of @xmath1492 , so there exists an index @xmath1493 such that @xmath1494 .",
    "let @xmath1495 be the index such that @xmath1496 .",
    "set @xmath1497 .",
    "first , as an abstract word , @xmath1498 , and @xmath1482 ( resp .",
    "@xmath1499 ) is a weakly right ( resp",
    ".  left ) @xmath47-periodic word , hence , @xmath1170 is weakly left @xmath328-periodic , where @xmath1500 .",
    "since @xmath1501 is not a weakly left @xmath47-periodic word , @xmath1502 is not a weakly left @xmath328-periodic word either . and",
    "since @xmath1483 is not a weakly right @xmath47-periodic word , @xmath1503 .",
    "now , since @xmath958 , by corollary [ betweenkernelgrowsgood ] , @xmath1504 , hence , @xmath1505 .",
    "in particular , @xmath1506 . since @xmath1507 is a weakly left @xmath328-periodic word , @xmath1508 . since @xmath1503",
    ", @xmath1509 is not a weakly @xmath65-periodic word ( with any period ) .",
    "let @xmath91 be the residue of @xmath1510 modulo @xmath65 . then , since @xmath1507 is a weakly left @xmath328-periodic word , @xmath1511 . and",
    "since @xmath1512 is not a weakly left @xmath328-periodic word , @xmath1513 .",
    "therefore , @xmath1512 is not a weakly @xmath65-periodic word ( with any period ) .",
    "finally , let @xmath575 be arbitrary again . by corollary [ betweenkernelgrowsgood ]",
    ", @xmath1514 strictly grows as @xmath118 grows , and there exists @xmath1515 ( @xmath892 ) such that @xmath1514 is @xmath1174 for @xmath798 .",
    "then , since @xmath508 and @xmath877 do not depend on @xmath118 , @xmath1516 also strictly grows as @xmath118 grows , and @xmath1173 is @xmath1174 for @xmath798 .",
    "[ lbsperiodic ] let @xmath1 .",
    "let @xmath385 be an evolution of @xmath56-blocks such that case ii holds at the left .",
    "let @xmath1479 , and let @xmath838 be an evolution of stable nonempty @xmath33-multiblocks such that @xmath846 is a prefix of @xmath1233 for all @xmath575 .",
    "suppose that @xmath838 is continuously periodic for an index @xmath275 ( @xmath1517 ) .",
    "let @xmath47 be the ( unique by corollary [ contperweakuniqueleft ] ) weak left evolutional period of @xmath838 for the pair @xmath1188 .",
    "then there are three possibilities :    1 .",
    "@xmath838 is totally periodic .",
    "@xmath1518 is periodic with period @xmath47 .",
    "3 .   there exists a @xmath33-series of obstacles in @xmath44 .",
    "the proof is completely symmetric to the proof of the previous lemma .",
    "[ lbsrbsperiodic ] let @xmath1 .",
    "let @xmath385 be an evolution of @xmath56-blocks such that case ii holds both at the left and at the right .",
    "suppose that @xmath1519 .",
    "let @xmath838 be the evolution of stable nonempty @xmath33-blocks defined by @xmath1520 .",
    "suppose that @xmath838 is totally periodic , and let @xmath47 ( resp .",
    "@xmath328 ) be the left ( resp .",
    "the right ) total evolutional period of @xmath838 .",
    "then there are three possibilities :    1 .",
    "@xmath1518 is periodic with period @xmath47 .",
    "@xmath1480 is periodic with period @xmath328 .",
    "3 .   there exists a @xmath33-series of obstacles in @xmath44 .",
    "suppose that @xmath1518 is not an infinite periodic sequence with period @xmath47 , and @xmath1480 is not an infinite periodic sequence with period @xmath328 .",
    "we are going to find a @xmath33-series of obstacles in @xmath44 .",
    "let @xmath508 be the length of the maximal weakly right @xmath47-periodic suffix of @xmath1518 , in other words , @xmath1521 is the number such that @xmath1522 is a weakly right @xmath47-periodic word , and @xmath1523 is not a weakly right @xmath47-periodic word .",
    "similarly , let @xmath877 be the length of the maximal weakly left @xmath328-periodic prefix of @xmath1480 , in other words , @xmath1484 is the number such that @xmath1485 is a weakly left @xmath328-periodic word , and @xmath1486 is not a weakly left @xmath328-periodic word . by corollaries [ presenceofrbs ] and [ presenceoflbs ]",
    ", there exists @xmath1414 such that if @xmath575 and @xmath1524 , then @xmath1525 . without loss of generality , @xmath1479 .",
    "fix @xmath575 .",
    "suppose that @xmath1526 .",
    "set @xmath1527 .",
    "we are going to prove that all @xmath1171 for @xmath575 form a @xmath33-series of obstacles .",
    "the argument is similar to the proof of lemma [ rbsperiodic ] .",
    "first , it follows from remark [ contpermultcycle ] and from corollary [ contperweakuniqueright ] that @xmath1528 .",
    "we also know that @xmath1529 is a weakly left @xmath47-periodic word , @xmath1530 is a weakly right @xmath47-periodic word , and @xmath1531 is not a weakly right @xmath47-periodic word .",
    "hence , @xmath1532 is a weakly right @xmath328-periodic word , and @xmath1533 is not a weakly right @xmath328-periodic word .",
    "now , @xmath1534 is a weakly left @xmath328-periodic word , and @xmath1535 is not a weakly left @xmath328-periodic word .",
    "therefore , if @xmath1536 , then @xmath1537 is a weakly left @xmath1119-periodic word , @xmath1538 is not a weakly left @xmath1119-periodic word , and @xmath1539 .    since @xmath1540 , by corollary [ betweenkernelgrowsgood ] , @xmath1541 , hence , @xmath1542 . in particular ,",
    "@xmath1543 . since @xmath1544 is a weakly left @xmath1119-periodic word , @xmath1545 .",
    "since @xmath1539 , @xmath1546 is not a weakly @xmath1281-periodic word ( with any period ) .",
    "let @xmath91 be the residue of @xmath1547 modulo @xmath1281 . then , since @xmath1544 is a weakly left @xmath1119-periodic word , @xmath1548 . and",
    "since @xmath1538 is not a weakly left @xmath1119-periodic word , @xmath1549 .",
    "therefore , @xmath1538 is not a weakly @xmath1281-periodic word ( with any period ) .",
    "finally , let @xmath575 be arbitrary again . by corollary [ betweenkernelgrowsgood ]",
    ", @xmath1550 strictly grows as @xmath118 grows , and there exists @xmath1515 ( @xmath892 ) such that @xmath1550 is @xmath1174 for @xmath798 .",
    "then , since @xmath508 and @xmath877 do not depend on @xmath118 , @xmath1551 also strictly grows as @xmath118 grows , and @xmath1173 is @xmath1174 for @xmath798 .",
    "finally , we are ready to prove that if all evolutions of @xmath33-blocks are continuously periodic , then either there is a @xmath33-series of obstacles , or all evolutions of @xmath56-blocks are continuously periodic .",
    "[ sameperiodcontper ] let @xmath1 .",
    "let @xmath385 be an evolution of @xmath56-blocks such that case i holds at the left ( resp .  at the right ) .",
    "let @xmath47 be a final period , and let @xmath275 be an index @xmath1552 .",
    "denote by @xmath838 the following evolution of @xmath33-multiblocks : @xmath1520 .",
    "suppose that for all @xmath575 , @xmath1476 ( resp .",
    "@xmath1478 ) is a completely @xmath47-periodic word .",
    "suppose also that @xmath47 is a left ( resp .",
    "right ) weak evolutional period of @xmath838 for the pair @xmath1188 ( resp .",
    "@xmath1189 ) .    then @xmath47 is a left continuous evolutional period of @xmath385 for the index @xmath275 .",
    "we prove the lemma for the situation when case i holds at the left .",
    "if case i holds at the right , the proof is completely symmetric .    for all @xmath575",
    ", @xmath1553 is a weakly left @xmath47-periodic word , and the residue of @xmath1554 modulo @xmath65 does not depend on @xmath118 .",
    "@xmath1476 is a completely @xmath47-periodic word , and @xmath1555 , so @xmath1556 is also a weakly left @xmath47-periodic word .",
    "@xmath1557 is divisible by @xmath65 for all @xmath575 , so the residue of @xmath1558 modulo @xmath65 equals the residue of @xmath1559 modulo @xmath65 and does not depend on @xmath118 .",
    "therefore , @xmath47 is a left continuous evolutional period of @xmath385 for the index @xmath275 .",
    "[ corenottotcontper ] let @xmath1 .",
    "suppose that all evolutions of @xmath33-blocks in @xmath44 are continuously periodic .",
    "let @xmath385 be an evolution of @xmath56-blocks such that case i holds at the left ( resp .  at the right ) .",
    "denote by @xmath838 the following evolution of @xmath33-multiblocks : @xmath1520 .",
    "suppose that @xmath838 is continuously periodic for an index @xmath275 ( @xmath1186 ) , but is * not * totally periodic .",
    "then there are two possibilities :    1 .",
    "there exists a left ( resp .",
    "right ) continuous evolutional period of @xmath385 for the index @xmath275 .",
    "2 .   there exists a @xmath33-series of obstacles in @xmath44 .",
    "we prove the lemma for the situation when case i holds at the left .",
    "if case i holds at the right , the proof is completely symmetric .",
    "suppose that @xmath33-series of obstacles do not exist in @xmath44 .",
    "we have to prove that there exists a left continuous evolutional period of @xmath385 for the index @xmath275 .    by corollary [ lrperiodic ] there",
    "exists a final period @xmath47 such that for all @xmath575 , @xmath1476 is a completely @xmath47-periodic word , moreover , @xmath47 is the unique right total evolutional period of the evolution @xmath840 of stable nonempty @xmath33-multiblocks defined by @xmath1449 .",
    "let us check that @xmath47 is also a weak left evolutional period of @xmath838 for the pair @xmath1188 .",
    "if @xmath580 , this is already clear since @xmath933 is always an empty occurrence . if @xmath1152 , then since @xmath840 and @xmath838 are consecutive , the fact that the left weak evolutional period of @xmath838 for the pair @xmath1188 also equals @xmath47 follows from lemma [ contperexpandtotalleftgood ] .",
    "now , @xmath47 is a left continuous evolutional period of @xmath385 for the index @xmath275 by lemma [ sameperiodcontper ] .",
    "[ contperbothone ] let @xmath1 .",
    "suppose that all evolutions of @xmath33-blocks in @xmath44 are continuously periodic .",
    "let @xmath385 be an evolution of @xmath56-blocks such that case i holds both at the left and at the right .",
    "then there are two possibilities :    1 .",
    "@xmath385 is continuously periodic .",
    "2 .   there exists a @xmath33-series of obstacles in @xmath44 .",
    "suppose that @xmath33-series of obstacles do not exist in @xmath44 .",
    "we have to prove that @xmath385 is continuously periodic .",
    "if @xmath1560 , then the claim follows from corollaries [ lrperiodic ] and [ rrperiodic ] .",
    "suppose that @xmath1519 .",
    "denote by @xmath838 the evolution of stable nonempty @xmath33-multiblocks defined by @xmath1520 .",
    "our assumption @xmath1519 means that @xmath985 . by corollary [ contpercr ] , @xmath838 is continuously periodic .",
    "if @xmath838 is not totally periodic , then the claim follows from lemma [ corenottotcontper ] .",
    "let us consider the case when @xmath838 is totally periodic .",
    "again , by corollaries [ lrperiodic ] and [ rrperiodic ] , there exist final periods @xmath47 and @xmath331 such that for all @xmath575 , @xmath1476 is a completely @xmath47-periodic word and @xmath1478 is a completely @xmath331-periodic word .",
    "moreover , @xmath47 ( resp .",
    "@xmath331 ) is the unique right ( resp",
    ".  left ) total evolutional period of the evolution @xmath840 ( resp .",
    "@xmath843 ) of stable nonempty @xmath33-multiblocks defined by @xmath1449 ( resp .  by @xmath1561 ) .",
    "so , @xmath840 , @xmath838 , and @xmath843 are three consecutive totally periodic evolutions of stable nonempty @xmath33-multiblocks , and by lemmas [ atleasttwokersleft ] and [ atleasttwokersright ] , @xmath1399 and @xmath1402 .",
    "we have also assumed that @xmath985 .",
    "now we can use lemma [ atleastonereallytotal ] .",
    "it implies that either @xmath47 is a total left evolutional period of @xmath838 , or @xmath331 is a total right evolutional period of @xmath838 . if @xmath47 is a total left evolutional period of @xmath838 , set @xmath1011 .",
    "then @xmath47 is also a left weak evolutional period of @xmath838 for the pair @xmath1188 by lemmas [ weakcontperinsright ] and [ contperweakuniquewideleft ] , and @xmath331 is a weak right evolutional period of @xmath838 for the pair @xmath1189 since @xmath1003 is always an empty occurrence .",
    "similarly , if @xmath331 is a total right evolutional period of @xmath838 , then set @xmath580 .",
    "then @xmath331 is also a right weak evolutional period of @xmath838 for the pair @xmath1189 by lemmas [ weakcontperinsleft ] and [ contperweakuniquewideright ] , and @xmath47 is a left weak evolutional period of @xmath838 for the pair @xmath1188 since @xmath933 is always an empty occurrence .",
    "the claim now follows from lemma [ sameperiodcontper ] .",
    "[ corenottotcontperii ] let @xmath1 .",
    "let @xmath385 be an evolution of @xmath56-blocks such that case ii holds at the left ( resp .  at the right ) .",
    "denote by @xmath838 the following evolution of @xmath33-multiblocks : @xmath1520 .",
    "suppose that @xmath838 is continuously periodic for an index @xmath275 ( @xmath1186 ) , but is * not * totally periodic .",
    "then there are two possibilities :    1 .",
    "there exists a left ( resp .",
    "right ) continuous evolutional period of @xmath385 for the index @xmath275 .",
    "2 .   there exists a @xmath33-series of obstacles in @xmath44 .",
    "we prove the lemma for the situation when case ii holds at the right .",
    "if case ii holds at the left , the proof is completely symmetric .",
    "suppose that @xmath33-series of obstacles do not exist in @xmath44 .",
    "we have to prove that there exists a right continuous evolutional period of @xmath385 for the index @xmath275 .",
    "if @xmath1562 , then , as we have already noted after the definition of a continuous evolutional period of an evolution of @xmath33-blocks , any final period is a right continuous evolutional period of @xmath385 for the index @xmath275 .",
    "suppose that @xmath1292 .",
    "denote by @xmath47 the ( unique by corollary [ contperweakuniqueright ] ) weak right evolutional period of @xmath838 for the pair @xmath1189 . since case ii holds for @xmath385 at the right",
    ", @xmath1563 is a suffix of @xmath388 for all @xmath393 , and @xmath1564 . by lemma [ rbsperiodic ]",
    ", @xmath1480 is periodic with period @xmath47 , so @xmath47 is a right continuous evolutional period of @xmath385 directly by definition .",
    "[ contperonetwo ] let @xmath1 .",
    "suppose that all evolutions of @xmath33-blocks in @xmath44 are continuously periodic .",
    "let @xmath385 be an evolution of @xmath56-blocks such that case i holds at the left and case ii holds at the right .",
    "then there are two possibilities :    1 .",
    "@xmath385 is continuously periodic .",
    "2 .   there exists a @xmath33-series of obstacles in @xmath44 .",
    "suppose that @xmath33-series of obstacles do not exist in @xmath44 .",
    "we have to prove that @xmath385 is continuously periodic .",
    "if @xmath1560 , then the claim follows from corollary [ lrperiodic ] .",
    "suppose that @xmath1519 .",
    "again , denote by @xmath838 the evolution of stable nonempty @xmath33-multiblocks defined by @xmath1520 . by corollary [ contpercr ] , @xmath838 is continuously periodic .",
    "if @xmath838 is not totally periodic , then the claim follows from lemmas [ corenottotcontper ] and [ corenottotcontperii ] .",
    "suppose that @xmath838 is totally periodic .",
    "denote by @xmath47 and @xmath331 the ( unique by corollaries [ contperweakuniqueleft ] and [ contperweakuniqueright ] since @xmath1565 ) left and right ( respectively ) total evolutional periods of @xmath838 .",
    "it follows from lemmas [ weakcontperinsright ] and [ contperweakuniquewideleft ] that @xmath47 is also a weak left evolutional period of @xmath838 for the pair @xmath1566 , and it follows from lemmas [ weakcontperinsleft ] and [ contperweakuniquewideright ] that @xmath331 is also a weak right evolutional period of @xmath838 for the pair @xmath1401 .",
    "consider the evolution @xmath840 of stable nonempty @xmath33-multiblocks defined by @xmath1449 .",
    "@xmath840 and @xmath838 are consecutive , denote their concatenation by @xmath843 . by corollary [ lrperiodic ]",
    ", there exists a final period @xmath328 such that @xmath328 is both left and right total evolutional period of @xmath840 . by lemma [ weakcontperinsright ] , @xmath840 is also weakly periodic for the sequence @xmath1567 .",
    "now lemma [ concatcontper ] says that @xmath843 is weakly periodic for the sequence @xmath1568 .",
    "first , let us consider the case when @xmath843 is not totally periodic .",
    "we know that @xmath331 is a weak right evolutional period of @xmath838 for the pair @xmath1401 . by lemma [ concatcompker ] , @xmath1569 for all @xmath575 as an occurrence in @xmath44 .",
    "hence , @xmath331 is also a weak right evolutional period of @xmath843 for the pair @xmath1570 . by lemma [ rbsperiodic ]",
    ", @xmath1480 is periodic with period @xmath331 . since case ii holds for @xmath385 at the right , @xmath1571 .",
    "therefore , @xmath331 is a right continuous evolutional period of @xmath385 for index 1 by definition .",
    "it also follows from corollary [ lrperiodic ] that @xmath328 is a left continuous evolutional period of @xmath385 for index 1 , and @xmath385 is continuously periodic .",
    "now suppose that @xmath843 is totally periodic . we know that @xmath1565 , that @xmath840 and @xmath838 are totally periodic , and that @xmath47 is a weak left evolutional period of @xmath838 for the pair @xmath1572 . by lemma [ contperexpandleft ]",
    ", @xmath47 is also a total right evolutional period of @xmath840 . by lemma [ atleasttwokersleft ] , @xmath1399 , so by corollary [ contperweakuniqueright ] , @xmath1113 .",
    "now recall that @xmath47 is also a weak left evolutional period of @xmath838 for the pair @xmath1566 and that corollary [ lrperiodic ] also says that for all @xmath575 , @xmath1476 is a completely @xmath47-periodic word .",
    "therefore , by lemma [ sameperiodcontper ] , @xmath47 is a left continuous evolutional period of @xmath385 for the index @xmath955 . and again , since case ii holds for @xmath385 at the right , any final period is a right continuous evolutional period of @xmath385 for the index @xmath1573 , and @xmath385 is continuously periodic .",
    "[ contpertwoone ] let @xmath1 .",
    "suppose that all evolutions of @xmath33-blocks in @xmath44 are continuously periodic .",
    "let @xmath385 be an evolution of @xmath56-blocks such that case ii holds at the left and case i holds at the right .",
    "then there are two possibilities :    1 .",
    "@xmath385 is continuously periodic .",
    "2 .   there exists a @xmath33-series of obstacles in @xmath44 .",
    "the proof is completely symmetric to the proof of the previous lemma .",
    "[ contperbothtwo ] let @xmath1 .",
    "suppose that all evolutions of @xmath33-blocks in @xmath44 are continuously periodic .",
    "let @xmath385 be an evolution of @xmath56-blocks such that case ii holds both at the left and at the right .",
    "then there are two possibilities :    1 .",
    "@xmath385 is continuously periodic .",
    "2 .   there exists a @xmath33-series of obstacles in @xmath44 .",
    "suppose that @xmath33-series of obstacles do not exist in @xmath44 .",
    "we have to prove that @xmath385 is continuously periodic .    again ,",
    "consider the evolution @xmath838 of stable nonempty @xmath33-multiblocks defined by @xmath1520 . by corollary [ contpercr ] , @xmath838 is continuously periodic .",
    "if @xmath838 is not totally periodic , then the claim follows from lemma [ corenottotcontperii ] .",
    "suppose that @xmath838 is totally periodic . if @xmath1574 , then @xmath385 is automatically continuously periodic , as we have noted right after the definition of a continuously periodic evolution of @xmath33-multiblocks .    if @xmath1575 , denote the ( unique by corollaries [ contperweakuniqueleft ] and [ contperweakuniqueright ] ) left and right total evolutional periods of @xmath838 by @xmath47 and @xmath331 , respectively . by lemma [ lbsrbsperiodic ] , either @xmath1518 is periodic with period @xmath47 , or @xmath1480 is periodic with period @xmath331 . if @xmath1518 is periodic with period @xmath47 , then @xmath47 is a left continuous evolutional period of @xmath385 for the index @xmath1576 , and any final period is a right continuous evolutional period of @xmath385 for the index @xmath1576 .",
    "if @xmath1480 is periodic with period @xmath331 , then @xmath331 is a right continuous evolutional period of @xmath385 for the index 1 , and any final period is a left continuous evolutional period of @xmath385 for the index 1 .",
    "[ contpergreatalt ] let @xmath1 .",
    "suppose that all evolutions of @xmath33-blocks in @xmath44 are continuously periodic .",
    "then either all evolutions of @xmath56-blocks in @xmath44 are continuously periodic , or there exists a @xmath33-series of obstacles in @xmath44 .",
    "this follows directly from lemmas [ contperbothone ] , [ contperonetwo ] , [ contpertwoone ] , and [ contperbothtwo ] .",
    "in this section , we will prove propositions [ largecompl][infordercomplstop ] and theorem [ maintheorem ] .",
    "[ obstcompl ] suppose that there exists a @xmath33-series of obstacles @xmath1577 in @xmath44 .",
    "then the subword complexity of @xmath1578 is @xmath1579 .",
    "let @xmath1515 ( @xmath892 ) be the number such that @xmath1580 for @xmath798 .",
    "this means that there exist @xmath814 and @xmath1581 such that if @xmath416 , then @xmath1582 .",
    "fix an arbitrary @xmath49 , @xmath1583 .",
    "we are going to find a lower estimate for the amount of different subwords of @xmath1584 of length @xmath22 .",
    "n{4y}},\\quad l_2=\\sqrt[k']{\\frac n{2y}},\\quad   l_3=l_2-l_1=\\left(\\sqrt[k']{\\frac12}-\\sqrt[k']{\\frac14}\\right)\\sqrt[k']{\\frac ny}.\\ ] ] then @xmath1586 , and there exist at least @xmath1587 indices @xmath409 such that @xmath1588 .",
    "consider the occurrences @xmath1171 in @xmath44 for @xmath1588 .",
    "since @xmath1173 strictly grows as @xmath118 grows , all these occurrences have different lengths .",
    "moreover , if @xmath1588 , then @xmath1589 and @xmath1590 denote @xmath1591 then if @xmath1588 , then @xmath1592 .    for each @xmath409 , @xmath1588 , denote by @xmath1593 and @xmath1594 the indices such that @xmath1595 . since @xmath1171 is a series of obstacles , there exists @xmath87 ( @xmath1596 ) such that all words @xmath1597 are weakly @xmath86-periodic , and all words @xmath1598 and ( if @xmath1599 ) @xmath1600 are not . since all words @xmath1171 have different lengths , @xmath1593 can not coincide with @xmath1601 if @xmath1602 ( @xmath1603 ) .",
    "denote by @xmath275 ( @xmath1604 ) the index such that @xmath1605 .",
    "let us check that if @xmath1606 , @xmath1588 , then @xmath1607 .",
    "indeed , assume that @xmath1608 .",
    "then @xmath1609 since @xmath1610 . but @xmath1611 , similarly , @xmath1612 .",
    "so , if @xmath1613 , then @xmath1614 , so @xmath1615 and @xmath1616 .",
    "denote @xmath1617 . by corollary [ overlapperiod ] , @xmath1618 is a weakly @xmath86-periodic word . in particular , @xmath1619 is a weakly @xmath86-periodic word , but this contradicts the assumption that @xmath1600 is not a @xmath86-periodic word .",
    "consider the following occurrences in @xmath44 : @xmath1620 , where @xmath1621 and @xmath1588 , @xmath1606 .",
    "we already know that if @xmath1588 , @xmath1606 , then @xmath1607 , so if @xmath1621 and @xmath1588 , @xmath1606 , then @xmath1622 . clearly , all these occurrences have length @xmath22 .",
    "let us prove that all words @xmath1623 are different",
    "_ abstract words_. ( if @xmath1624 , then we have no occurrences , but @xmath1625 if @xmath22 is large enough . during the proof that all these abstract words are different , we suppose that @xmath1625 , and we have at least one word . )",
    "denote @xmath1626 .",
    "temporarily fix an index @xmath508 ( @xmath1621 ) and an index @xmath118 ( @xmath1588 , @xmath1606 ) .",
    "denote @xmath1627 .",
    "then @xmath1628 for @xmath1629 .",
    "we have @xmath1630 and @xmath1631 , so @xmath1632 , @xmath1633 , and @xmath1634 . hence , @xmath1635 , @xmath1636 , and ( if @xmath914 ) @xmath1637 are occurrences in @xmath45 .",
    "we have @xmath1638 .",
    "similarly , @xmath1639 and ( if @xmath914 ) @xmath1640 ( the notation @xmath1641 is well - defined since @xmath1642 ) .",
    "therefore , @xmath1635 is a weakly @xmath86-periodic word , and @xmath1636 and ( if @xmath914 ) @xmath1637 are not .",
    "now assume that @xmath1643 as an abstract word , where @xmath1644 or @xmath1602 .",
    "( here @xmath1645 , @xmath1603 , @xmath1606 , and @xmath1646 . )",
    "denote @xmath1647 .",
    "first , let us consider the case when @xmath1648 and @xmath1602 . without loss of generality , @xmath1649 , so @xmath1650 , and @xmath1651 .",
    "then @xmath1636 is a prefix of @xmath1652 , but @xmath1652 is a @xmath86-periodic word , and @xmath1636 is not , so we have a contradiction .",
    "now suppose that @xmath1644 .",
    "without loss of generality , @xmath1653 , so @xmath914 . since @xmath1654 , @xmath1655 . since @xmath1656 and @xmath1484",
    ", we also have @xmath1657 . since @xmath1658 , @xmath1659 . therefore , if @xmath1660 , then @xmath1661 .",
    "now we can use corollary [ overlapperiod ] . recall that @xmath1635 and @xmath1662 are weakly @xmath86-periodic words . denote @xmath1663 . by corollary [ overlapperiod ] , @xmath165 is a @xmath86-periodic word .",
    "hence , @xmath1664 is also a @xmath86-periodic word ( recall that @xmath1653 and @xmath914 ) , and @xmath1637 is also a @xmath86-periodic word .",
    "but previously we have seen that @xmath1637 is not a @xmath86-periodic word , so we have a contradiction .",
    "let us count how many words @xmath1665 we have .",
    "if @xmath1666 , then we have none of them , and if @xmath1667 then there are @xmath1668 possibilities for @xmath508 and at least @xmath1669 possibilities for @xmath118 .",
    "hence , we have at least @xmath1670{\\frac12}-\\sqrt[k']{\\frac14}\\right)\\sqrt[k']{\\frac ny}-2\\right)\\ ] ] different subwords of @xmath1578 , and the subword complexity of @xmath1584 is @xmath1671 for @xmath1672 .",
    "but @xmath1673 , so the subword complexity of @xmath1584 is also @xmath1579 for @xmath1672 .",
    "note that in the proof of this lemma , we proved in fact that if @xmath1173 is @xmath1174 for @xmath798 , then the subword complexity of @xmath1578 is @xmath1671 for @xmath1672 , and @xmath1674 is @xmath1675 if @xmath72 . later , after we prove proposition [ smallcompl ] , we will see that this is not possible if evolutions of @xmath33-blocks really exist in @xmath44 and all of them are continuously periodic .",
    "therefore , if @xmath33-blocks really exist in @xmath44 , then all @xmath33-series of obstacles obtained from proposition [ contpergreatalt ] actually satisfy @xmath1676 for @xmath798 . however , it was not very convenient to prove this directly , so in the definition of a @xmath33-series of obstacles we allowed @xmath1580 for some @xmath1673 .",
    "we know that there exists a non - continuously periodic evolution of @xmath33-blocks , and we also know ( see remark [ onecontper ] ) that all evolutions of 1-blocks arising in @xmath44 are continuously periodic .",
    "let @xmath1515 be the largest number such that all evolutions of @xmath70-blocks arising in @xmath44 are continuously periodic .",
    "then @xmath1677 . by proposition [ contpergreatalt ]",
    ", there exists a @xmath70-series of obstacles in @xmath44 . by lemma [ obstcompl ] ,",
    "the subword complexity of @xmath52 is @xmath1671 .",
    "but @xmath1677 , so @xmath1678 , and the subword complexity of @xmath19 is @xmath1679 .",
    "the proof of proposition [ smallcompl ] is based on the following lemma .",
    "[ smallcompllemma ] let @xmath1 .",
    "suppose that @xmath38 is a letter of order at least @xmath54 such that @xmath50 for some @xmath51 , and all evolutions of @xmath33-blocks arising in @xmath41 are continuously periodic .",
    "let @xmath1680 be a function and @xmath289 , @xmath1681 be a number such that :    1 .   if @xmath290 , then @xmath1682 .",
    "2 .   if @xmath385 is an evolution of @xmath33-blocks such that case i holds at the left ( resp .  at the right ) and @xmath1683 for some @xmath1684 , @xmath290 , then @xmath1685 ( resp .",
    "@xmath1686 ) .",
    "3 .   if @xmath71 is a letter of order @xmath302 and @xmath1683 for some @xmath1684 , @xmath290 , then @xmath1687 .",
    "then the subword complexity of @xmath52 is @xmath1688",
    ".    denote the total number of all abstract words that can equal the forgetful occurrences of all left and right preperiods of stable @xmath33-blocks or composite central kernels of @xmath33-blocks by @xmath1689 ( by corollary [ finitelrprep ] and by lemma [ finitecker ] , this number is finite ) .",
    "denote the maximal length of the forgetful occurrence of a left or a right preperiod or of a composite central kernel of a stable @xmath33-block by @xmath1690 .",
    "denote the number of all final periods we have by @xmath1691 .    fix a number @xmath1361 ( @xmath290 and @xmath1692 . )",
    "let @xmath76 be an occurrence in @xmath44 of length @xmath290 .",
    "set @xmath1693 . since @xmath41",
    ", @xmath44 can be written as @xmath1694 and as @xmath1695 for all @xmath575 .",
    "let @xmath877 and @xmath1696 be the indices such that @xmath59 ( resp .",
    "@xmath62 ) is contained in @xmath1697 ( resp .  in @xmath1698 ) as an occurrence in @xmath44 .",
    "clearly , @xmath1699 . if @xmath1700 , then set @xmath1648 , @xmath1701 , and @xmath1702 .    if @xmath1703 , then for each @xmath118 ( @xmath1704 ) denote by @xmath1705 and @xmath1706 the indices such that @xmath59 ( resp .",
    "@xmath62 ) is contained in @xmath1707 ( resp .  in @xmath1708 ) as an occurrence in @xmath44 .",
    "let @xmath1310 be the maximal value of @xmath118 such that @xmath1709 .",
    "then @xmath1710 , and both @xmath1711 and @xmath1712 are contained in @xmath1713 as an occurrence in @xmath44 .",
    "so , @xmath1714 . set @xmath1715 and @xmath1716 .    summarizing , we have found indices @xmath508 and @xmath509 and a number @xmath1717 ( @xmath1718 ) such that :    1 .   @xmath1719 .",
    "2 .   @xmath59 ( resp .",
    "@xmath62 ) is contained in @xmath1720 ( resp .  in @xmath1721 ) as an occurrence in @xmath44 .",
    "3 .   if @xmath1722 , then @xmath1723 .",
    "we are going to estimate the amount of different words that can be equal to @xmath1529 as abstract words ( for different @xmath75 and @xmath77 such that @xmath1724 ) .",
    "we will consider the cases @xmath1702 and @xmath1722 separately .",
    "first , suppose that @xmath1702 .",
    "then we do nt have any explicit upper estimates for @xmath1725 so far , but we can say that if @xmath1726 , then @xmath1727 is a suboccurrence in @xmath76 .",
    "so , @xmath1728 , and @xmath1729 can not contain letters of order @xmath302 .",
    "since @xmath1730 is a letter of order at least @xmath54 , by lemma [ splitconcatenation ] , @xmath44 can be split into a concatenation of @xmath33-blocks and letters of order @xmath302 , so @xmath1729 is a suboccurrence in a @xmath33-block .",
    "denote this @xmath33-block by @xmath1731 .",
    "then @xmath1727 is a nonempty suboccurrence in both @xmath76 and @xmath1732 .",
    "let @xmath247 and @xmath246 be the indices such that @xmath1733 . if @xmath1734 , then @xmath1735 is a letter of order @xmath302 , and this letter must be contained in @xmath1720 , so @xmath583 must be a letter of order @xmath302 , and @xmath1736 . similarly ,",
    "if @xmath1737 , then @xmath1738 is a letter of order @xmath302 , and this letter must be contained in @xmath1721 , so @xmath1739 must be a letter of order @xmath302 , and @xmath1740 .    summarizing , we have the following cases :    1 .   [ smallcomplcasei ] @xmath1741 , and @xmath1742 .",
    "[ smallcomplcaseiigen ] @xmath1726 .",
    "there exists a ( unique ) nonempty @xmath33-block @xmath1731 such that @xmath1729 is a suboccurrence in @xmath1731 .",
    "denote @xmath1733 .",
    "then there are the following possibilities : 1 .",
    "[ smallcomplcaseii ] @xmath1743 and @xmath1744 , so @xmath76 is a suboccurrence in @xmath891 .",
    "[ smallcomplcaseiii ] @xmath1734 , but @xmath1744 , then @xmath1736 and @xmath583 is a letter of order @xmath302 .",
    "[ smallcomplcaseiv ] @xmath1743 , but @xmath1737 , then @xmath1740 and @xmath1739 is a letter of order @xmath302 .",
    "[ smallcomplcasev ] @xmath1734 and @xmath1737 , then @xmath1736 , @xmath1740 , and both @xmath583 and @xmath1739 are letters of order @xmath302 .",
    "let us consider these cases one by one .",
    "there exists @xmath1745 ( @xmath1746 ) such that @xmath76 is the concatenation of the suffix of @xmath1720 of length @xmath734 and the prefix of @xmath1721 of length @xmath1747 .",
    "there are at most @xmath1748 possibilities for @xmath76 as an abstract word",
    ". therefore , there are at most @xmath1748 possibilities for @xmath1529 as an abstract word .",
    "observe that , since @xmath1749 , the evolutional sequence number of @xmath891 is at least @xmath1750 .",
    "in particular , @xmath1751 , and @xmath891 is a stable @xmath33-block .",
    "denote the evolution @xmath891 belongs to by @xmath385 . if case i holds for @xmath385 at the left ( resp .  at the right ) , then @xmath1752 ( resp .",
    "@xmath1753 ) . if case i holds for @xmath385 at the left or at the right , then @xmath1754 , and @xmath1755 .",
    "we know that all evolutions of @xmath33-blocks in @xmath44 are continuously periodic , so let @xmath275 ( @xmath1035 ) be an index such that @xmath385 is continuously periodic for the index @xmath275 .",
    "let @xmath47 ( resp .",
    "@xmath331 ) be a left ( resp .",
    "right ) continuous evolutional period of @xmath385 for the index @xmath275 .",
    "let us check that if case ii holds for @xmath385 at the left and @xmath1734 , then @xmath1756 is a suffix of @xmath1098 . recall that in this case , @xmath1757 .",
    "denote @xmath1758 .",
    "then @xmath1759 is the rightmost letter of order @xmath302 in @xmath585 .",
    "let @xmath1760 be the rightmost letter in @xmath1761 , and let @xmath1762 be the leftmost letter in @xmath1763 .",
    "then @xmath1760 is contained in @xmath1720 , so @xmath1764 .",
    "we have @xmath1765 , so @xmath1763 is a suboccurrence in @xmath76 , hence @xmath1762 is contained in @xmath76 , @xmath1766 , and @xmath1767 . on the other hand , @xmath1768 is contained in @xmath1769 , so @xmath1768 is contained in @xmath1770 , @xmath1771 , and @xmath1772 .",
    "therefore , either @xmath1761 is a subword in @xmath76 , or @xmath1773 is a suffix of @xmath1761 .",
    "but @xmath1761 can not be a subword of @xmath76 since @xmath1759 is a letter of order @xmath302 and @xmath1774 , so @xmath1775 . therefore , @xmath1773 is a suffix of @xmath1761 .",
    "we have @xmath1776 , @xmath1777 , and @xmath1778 .",
    "we also have @xmath1758 , so the evolutional sequence number of @xmath1779 is at least 1 .",
    "now it follows from remark [ lbsremarkii ] that @xmath1756 is a suffix of @xmath1098 .",
    "note that we could not use @xmath1731 instead of @xmath1779 in this argument since the evolutional sequence number of @xmath1731 could equal 0 .",
    "similarly , if case ii holds for @xmath385 at the right and @xmath1737 , then @xmath1780 is a prefix of @xmath1074 .",
    "if @xmath1734 , but case i holds for @xmath385 at the left , then we did not define any left bounding sequence , but we know that independently on whether case i or ii holds for @xmath385 at the left , if @xmath1734 , then @xmath1735 is the rightmost letter of order @xmath302 in @xmath585 .",
    "so , if @xmath1734 ( and @xmath1781 is a letter of order @xmath302 ) , denote by @xmath45 the prefix of @xmath1720 that ends with the rightmost letter of order @xmath302 in @xmath1720 .",
    "then @xmath1756 is a suffix of @xmath45 .",
    "clearly , @xmath45 as an abstract word depends only on @xmath1310 and on @xmath583 as an abstract letter .    similarly , if @xmath1737 , denote by @xmath110 the suffix of @xmath1721 that begins with the leftmost letter of order @xmath302 in @xmath1721 . then @xmath1780 is a prefix of @xmath110 , and @xmath110 as an abstract word depends only on @xmath1310 and on @xmath1739 as an abstract letter .",
    "now let us consider cases [ smallcomplcaseii][smallcomplcasev ] one by one .",
    "we can write @xmath891 as @xmath1782 if case i holds at the left , then @xmath1783 , and @xmath76 is a suboccurrence either in @xmath1784 , or in @xmath1785 .",
    "if case ii holds at the left , then @xmath1786 is empty , and @xmath76 is a suboccurrence in @xmath1785 .",
    "so , independently on whether case i or case ii holds at the left , @xmath76 is a suboccurrence either in @xmath1784 , or in @xmath1785 .",
    "if @xmath76 is a suboccurrence in @xmath1785 , and case i holds at the right , then @xmath1787 , and @xmath76 is a suboccurrence either in @xmath1788 , or in @xmath1789 .",
    "if @xmath76 is a suboccurrence in @xmath1785 , and case ii holds at the right , then @xmath1790 is empty , and @xmath76 is a suboccurrence in @xmath1788 anyway .    therefore , independently on whether case i or ii holds at the left or at the right , there are three possibilities for @xmath76 : @xmath76 is a suboccurrence either in @xmath1784 , or in @xmath1788 , or in @xmath1789 .",
    "if @xmath76 is a suboccurrence of @xmath1784 , then @xmath1529 is the concatenation of a suffix of @xmath1791 of length @xmath1792 and the weakly @xmath65-periodic word of length @xmath1747 with a left period @xmath328 , which is a cyclic shift of @xmath47 ( this cyclic shift can be nontrivial if @xmath1793 , and @xmath76 is actually a suboccurrence in @xmath1794 ) , so @xmath328 is a final period as well .",
    "recall that @xmath1692 , so @xmath76 can not be a suboccurrence of @xmath1786 .",
    "we have at most @xmath1795 different words that can equal @xmath1529 .    the situation when @xmath76 is a suboccurrence of @xmath1789",
    "is considered similarly and gives us at most @xmath1795 more possibilities for @xmath1529 as an abstract word .",
    "if @xmath76 is a suboccurrence of @xmath1788 , but is not a suboccurrence of @xmath1784 or @xmath1789 , then @xmath1529 is a subword of the word @xmath1796 , where @xmath83 ( resp .",
    "@xmath172 ) is the weakly @xmath65-periodic ( resp .",
    "@xmath1472-periodic ) word of length @xmath22 with right ( resp",
    ".  left ) period @xmath328 ( resp .",
    "@xmath334 ) , which is a cyclic shift of @xmath47 ( resp .  of @xmath331 ) , and is a final period as well .",
    "we have @xmath1797 , and there are at most @xmath1798 different possibilities for @xmath1529 .",
    "totally , we have @xmath1799 possibilities for @xmath1529 in case [ smallcomplcaseii ] .",
    "again write @xmath1782 this time @xmath1734 , so if case i holds at the right , then @xmath1800 , and @xmath1801 is a suboccurrence in @xmath1802 . and again , if case ii holds at the right , then @xmath1803 , and @xmath1801 is also a suboccurrence in @xmath1802 .",
    "so , independently on whether case i or case ii holds at the right , @xmath1801 is always a suboccurrence in @xmath1802 .",
    "if case i holds at the left , then @xmath1783 , and @xmath1801 is a suboccurrence in @xmath1784 .",
    "therefore , @xmath1529 is the concatenation of the suffix of @xmath1804 of length @xmath1805 and the prefix of length @xmath1806 of the word @xmath1807 , where @xmath83 is the weakly left @xmath47-periodic word of length @xmath22 .",
    "we have at most @xmath1808 possibilities for @xmath1529 .",
    "if case ii holds at the left , then @xmath1801 is a suboccurrence in @xmath1788 .",
    "if @xmath580 , then @xmath1801 is a suboccurrence in @xmath1809 .",
    "then @xmath1529 is the concatenation of the suffix of @xmath1804 of length @xmath1805 and the prefix of length @xmath1806 of the word @xmath1810 , where @xmath83 is the weakly @xmath1472-periodic word of length @xmath22 with left period @xmath334 , which is a cyclic shift of @xmath331 .",
    "again , we have at most @xmath1808 possibilities for @xmath1529 .",
    "if case ii holds at the left and @xmath1152 , then @xmath1155 is a periodic sequence infinite to the left with period @xmath47 . as we have checked previously , @xmath1756 is a suffix of @xmath1155 , so @xmath1811 is a weakly right @xmath47-periodic word .",
    "@xmath1812 is a weakly left @xmath47-periodic word , so @xmath1529 is a subword in a word of the form @xmath1796 , where @xmath83 ( resp .",
    "@xmath172 ) is the weakly @xmath65-periodic ( resp .",
    "@xmath1472-periodic ) word of length @xmath22 with a right ( resp .",
    "a left ) period @xmath328 ( resp .",
    "@xmath334 ) , which is a cyclic shift of @xmath47 ( resp .  of @xmath331 ) , ( so @xmath328 and @xmath334 are final periods ) .",
    "we have at most @xmath1798 possibilities for @xmath1529 .    in total , case [ smallcomplcaseiii ] gives us at most @xmath1813 possibilities for @xmath1529 .",
    "is symmetric to case [ smallcomplcaseiii ] and gives at most @xmath1813 more possibilities for @xmath1529 .",
    "this time @xmath891 is a suboccurrence in @xmath76 , so case ii must hold for @xmath385 both at the left and at the right , otherwise , @xmath1814 .",
    "so , @xmath1815 , and we have several possibilities for the value of @xmath275 .    first , if @xmath580 and @xmath1816 , then @xmath1817 as an abstract word , and there exists a number @xmath1745 ( @xmath1818 ) such that @xmath76 is the concatenation of the suffix of @xmath45 of length @xmath734 , the abstract word @xmath1819 , and the prefix of @xmath110 of length @xmath1820 .",
    "so , there are at most @xmath1821 possibilities for @xmath76 and at most @xmath1821 possibilities for @xmath1529 in this case .",
    "if @xmath580 , but @xmath1822 , then @xmath891 can be written as @xmath1823 , and @xmath1156 is a periodic sequence infinite to the right with period @xmath331 .",
    "@xmath1824 is a weakly right @xmath331-periodic word . as we have checked previously",
    ", @xmath1780 is a prefix of @xmath1074 , so @xmath1825 is a prefix of a word of the form @xmath1826 , where @xmath83 is the weakly @xmath1472-periodic word of length @xmath22 with left period @xmath334 , which is a cyclic shift of @xmath331 ( and is a final period as well ) .",
    "and @xmath1811 is the suffix of length @xmath1827 ( @xmath1828 ) of @xmath1804 .",
    "we get at most @xmath1808 possibilities for @xmath1529 .",
    "the situation when @xmath1829 and @xmath1822 is symmetric to the situation when @xmath580 and @xmath1822 , so it gives us at most @xmath1808 more possibilities for @xmath1529 .    finally ,",
    "if @xmath1830 , then @xmath1155 is a periodic sequence infinite to the left with period @xmath47 , @xmath1156 is a periodic sequence infinite to the right with period @xmath331 , @xmath1756 is a suffix of @xmath1098 , and @xmath1780 is a prefix of @xmath1074 . also , @xmath1812 is a weakly left @xmath47-periodic word , and @xmath1831 is a weakly right @xmath331-periodic word .",
    "therefore , @xmath1529 as an abstract word is a subword of a word of the form @xmath1796 , where @xmath83 is the weakly @xmath65-periodic word of length @xmath22 with right period @xmath328 , which is a cyclic shift of @xmath47 , and where @xmath172 is the weakly @xmath1472-periodic word of length @xmath22 with left period @xmath334 , which is a cyclic shift of @xmath331 . @xmath328 and @xmath334 are final periods , @xmath1832 , so we have at most @xmath1798 possibilities for @xmath1529 .    totally , in case [ smallcomplcasev ]",
    "we have at most @xmath1833 possibilities for @xmath1529 .    summarizing ,",
    "if @xmath1702 , then we have at most @xmath1834 possibilities for @xmath1529 as an abstract word . since @xmath1835 , @xmath1689 , @xmath1691 , and @xmath1690 do not depend on @xmath22 , this number is @xmath1836 for @xmath1672 .",
    "now let us consider the case when @xmath1722 . recall that in this case , @xmath1837 .",
    "denote by @xmath258 the index such that @xmath1760 is the rightmost letter in @xmath585 .",
    "then @xmath76 is the concatenation of the suffix of @xmath1720 of length @xmath1838 and the prefix of @xmath1839 of length @xmath1747 .",
    "so , @xmath76 as an abstract word is determined by the following data : a word of length at least two and at most @xmath1840 , which will be @xmath380 , and two numbers , @xmath1717 ( @xmath1841 ) and @xmath1745 ( @xmath1842 ) .",
    "( this time we need to know @xmath1310 since it is not determined by @xmath22 uniquely anymore .",
    ") there are at most @xmath1843 possibilities for @xmath76 , and hence at most @xmath1844 possibilities for @xmath1529 .",
    "@xmath1835 and @xmath1840 do not depend on @xmath22 , so this number is @xmath1845 for @xmath1672 .",
    "overall , we have at most @xmath1846 possibilities for @xmath1529 as an abstract word . since @xmath1682",
    "if @xmath290 , we can say that the function @xmath1847 is also @xmath1848 for @xmath1672 , and @xmath1849 .",
    "consider the following sequences depending on @xmath1850 .",
    "previously we have seen that all of them have asymptotic @xmath813 for @xmath798 .    1 .   the sequences @xmath810 ( resp .",
    "@xmath811 ) for all evolutions of @xmath33-blocks such that case i holds for @xmath385 at the left ( resp .  at the right ) ( see lemma [ regpartasym ] ) .",
    "2 .   the sequences @xmath1851 , where @xmath69 is a letter of order @xmath302 , including letters of order @xmath68 ( see the definition of the order of a letter ) .    for the sequences @xmath810 and @xmath811 mentioned here , lemma [ regpartasym ] actually says that the asymptotic of these sequences is @xmath812 , and constants in the @xmath675-notation do not depend on @xmath385 .",
    "so , we may suppose that the constants in the @xmath1852-notation do not depend on @xmath385 .",
    "as for the sequences @xmath1851 , where @xmath69 is a letter of order @xmath302 , there are only finitely many of them since there are only finitely many letters in @xmath44 , so we may also suppose that the constants in the @xmath1852-notation do not depend on @xmath71 . therefore , there exist @xmath1853 and @xmath815 such that for all @xmath416 the following is true :    1 .   if @xmath385 is an evolution of @xmath33-blocks such that case i holds for @xmath385 at the left ( resp .  at the right ) , then @xmath1854 ( resp .",
    "@xmath1855 ) .",
    "2 .   if @xmath69 is a letter of order @xmath302 , then @xmath1856 .    without loss of generality",
    ", we will suppose that @xmath1138 .",
    "set @xmath1857 .",
    "consider the following function @xmath1858 : @xmath1859{n / x}$ ] .",
    "if @xmath290 , then @xmath1859{n / x}\\ge \\sqrt[k]{n_0/x}\\ge \\sqrt[k]{(xl_0^k)/x}=l_0\\ge 3k$ ] .",
    "if @xmath290 , @xmath409 , and @xmath1683 , then @xmath1860{n / x}$ ] , so @xmath1861 , @xmath1862 , and , since @xmath1863 , we have the following inequalities :    1 .   if @xmath385 is an evolution of @xmath33-blocks such that case i holds for @xmath385 at the left ( resp .  at the right ) , then @xmath1864 ( resp .",
    "@xmath1865 ) .",
    "2 .   if @xmath69 is a letter of order @xmath302 , then @xmath1866 .",
    "therefore , @xmath708 satisfies the conditions of lemma [ smallcompllemma ] , and the subword complexity of @xmath52 is @xmath1867 .",
    "now we can check that if evolutions of @xmath33-blocks really exist in @xmath44 and all of them are continuously periodic , then all @xmath33-series of obstacles @xmath1577 in @xmath44 actually satisfy @xmath1868 .",
    "( actually , we do not need this fact to prove any subsequent lemmas , propositions or theorems . ) indeed , if @xmath41 and @xmath33-blocks exist in @xmath44 , then by lemma [ splitconcatenation ] , @xmath40 is a letter of order @xmath1869 . if , in addition , all evolutions of @xmath33-blocks are continuously periodic , then by proposition [ smallcompl ] , the subword complexity of @xmath52 is @xmath55 .",
    "but we also have seen in the proof of lemma [ obstcompl ] that if @xmath1577 is a @xmath33-series of obstacles such that @xmath1173 is @xmath1174 for @xmath798 and @xmath72 , then the subword complexity of @xmath19 is @xmath1671 , so it is @xmath1675 , and we have a contradiction .",
    "therefore , @xmath1173 is in fact @xmath812 for @xmath798 .    to prove proposition [ finordercomplstop ] , we first prove the following lemma .",
    "[ finorderstoplemma ] let @xmath1 .",
    "suppose that @xmath41 , where @xmath40 is a letter of order @xmath54 .",
    "let @xmath1850 .",
    "let @xmath583 ( resp .",
    "@xmath59,@xmath62 ) be the rightmost letter of order @xmath1870 in @xmath39 ( resp .  in @xmath408 , in @xmath1871 ) .",
    "then @xmath1872 , @xmath1873_k$ ] and @xmath1874_k$ ] are @xmath33-multiblocks , each of them begins with a ( possibly empty ) @xmath33-block and ends with a letter of order @xmath60 , and @xmath1873_k={\\mathop{\\mathrm{dc}}}_k^l({\\alpha}[<,1\\ldots s,<]_k)$ ] .",
    "first , note that the @xmath33-multiblocks in the statement of the lemma really exist and are nonempty .",
    "indeed , lemma [ splitconcatenation ] says in this case that the only letter of order @xmath54 in @xmath44 is @xmath1730 , and all other letters in @xmath44 are of order @xmath257 .",
    "if @xmath50 , then for all @xmath49 we have @xmath1875 .",
    "since @xmath39 contains @xmath40 , @xmath40 can only be a periodic letter of order @xmath54 , not a preperiodic letter of order @xmath54 .",
    "then @xmath45 contains at least one letter of order @xmath60 , and @xmath1876 contains at least one letter of order @xmath60 for all @xmath49 .",
    "hence , @xmath286 contains at least one letter of order @xmath60 .",
    "moreover , for all @xmath49 , the rightmost letter of order @xmath60 in @xmath286 is the rightmost letter of order @xmath60 in @xmath1877 since @xmath1877 contains at least one letter of order @xmath60 .",
    "hence , @xmath1872 , @xmath1878 .",
    "since @xmath406 and @xmath59 are letters of order @xmath1870 , there really exist ( possibly empty ) @xmath33-blocks of the form @xmath1879 and @xmath1880 , so the notations @xmath1881 and @xmath1882 really denote delimiters .",
    "since @xmath62 and @xmath583 are also letters of order @xmath1870 , @xmath1883 and @xmath1884 also denote delimiters , and the delimiter @xmath1883 ( resp .",
    "@xmath1884 ) is located at the right - hand side of @xmath1881 ( resp .  of @xmath1882 ) .",
    "therefore , @xmath1873_k$ ] and @xmath1874_k$ ] are really nonempty @xmath33-multiblocks , and each of them begins with a ( possibly empty ) @xmath33-block and ends with a letter of order @xmath60 .    if @xmath1063 , then @xmath1885 and @xmath1886 , so the statement of the lemma is trivial",
    "otherwise , we prove the statement by induction on @xmath118 .",
    "let @xmath1739 be the rightmost letter of order @xmath1870 in @xmath1887 .",
    "we have to prove that @xmath1888_k={\\mathop{\\mathrm{dc}}}_k({\\alpha}[<,i+1\\ldots j,<]_k)$ ] .",
    "@xmath1739 is also the rightmost letter of order @xmath1870 in @xmath1889 , so , since @xmath62 is the rightmost letter of order @xmath1870 in @xmath412 , and the image of a letter of order @xmath271 consists of letters of order @xmath271 only , @xmath1739 is also the rightmost letter of order @xmath1870 in @xmath587 .",
    "similarly , @xmath62 is the rightmost letter of order @xmath1870 in @xmath398 .",
    "therefore , @xmath1890_k)$ ] is a @xmath33-multiblock that ends with the letter @xmath1739 of order @xmath1870 .",
    "if @xmath1879 is a @xmath33-block , then @xmath1891 , and @xmath1892 is the rightmost letter of order @xmath302 in @xmath398 , i.  e.  @xmath1893 .",
    "hence , @xmath1894 is a @xmath33-block of the form @xmath1895 for some @xmath1896 , and , by the definition of the descendant of a @xmath33-multiblock , @xmath1897_k)$ ] is the @xmath33-multiblock that begins with the @xmath33-block @xmath1895 and ends with the letter @xmath1739 of order @xmath1870 .",
    "therefore , @xmath1888_k={\\mathop{\\mathrm{dc}}}_k({\\alpha}[<,i+1\\ldots j,<]_k)$ ] .    for each @xmath575 ,",
    "denote by @xmath1898 the index such that @xmath1899 is the rightmost letter of order @xmath1870 in @xmath408 . by lemma [ finorderstoplemma ] , @xmath1900_k={\\mathop{\\mathrm{dc}}}_k^l({\\alpha}[<,1\\ldots s_1,<]_k)$ ] for all @xmath575 . by lemma [ splitconcatenation ] ,",
    "the only letter of order @xmath54 in @xmath44 is @xmath1730 , so all letters of order @xmath1870 in @xmath1901_k$ ] are actually of order @xmath60 .",
    "all letters of order @xmath1870 in @xmath1902_k)$ ] are contained in the images under @xmath1903 of the letters of order @xmath60 from @xmath1901_k$ ] , so , if @xmath393 , then all letters of order @xmath1870 in @xmath1902_k)={\\alpha}[<,s_l+1\\ldots s_{l+1},<]_k$ ] are actually _ periodic _ letters of order @xmath60 .    in particular ,",
    "this is true for @xmath1904 .",
    "therefore , if @xmath393 , then all @xmath33-blocks in @xmath1900_k={\\mathop{\\mathrm{dc}}}_k^l({\\alpha}[<,1\\ldots s_1,<]_k)={\\mathop{\\mathrm{dc}}}_k^{l-1}({\\mathop{\\mathrm{dc}}}_k({\\alpha}[<,1\\ldots s_1,<]_k))= { \\mathop{\\mathrm{dc}}}_k^{l-1}({\\alpha}[<,s_1 + 1\\ldots s_2,<]_k)$ ] are the @xmath717th superdescendants of the @xmath33-blocks in @xmath1905_k$ ] . hence ,",
    "if @xmath393 , then the evolutional sequence number of each @xmath33-block contained in @xmath1900_k$ ] is always at least @xmath801 .",
    "so , if @xmath1906 , then all @xmath33-blocks contained in @xmath1900_k$ ] are stable , and all letters of order @xmath1870 contained in @xmath1900_k$ ] are periodic letters of order @xmath60 . therefore , if @xmath1906 , then @xmath1900_k$ ] is a stable @xmath33-multiblock .",
    "it is nonempty by lemma [ finorderstoplemma ] .",
    "consider the following evolution @xmath838 of stable nonempty @xmath33-multiblocks : @xmath1907@xmath1908_k$ ] , @xmath1909_k)={\\mathop{\\mathrm{dc}}}_k^l({\\mathop{\\mathrm{dc}}}_k^{3k+1}({\\alpha}[<,1\\ldots s_1,<]_k))= { \\mathop{\\mathrm{dc}}}_k^{l+3k+1}({\\alpha}[<,1\\ldots s_1,<]_k)={\\alpha}[<,s_{l+3k+1}+1\\ldots s_{l+3k+2},<]_k$ ] for @xmath575 .",
    "then we can write @xmath1910 . note that @xmath846 contains a letter ( namely , the rightmost letter of order @xmath1870 in @xmath1911 , which we denote by @xmath1912 ) , which does not belong to @xmath1913 by lemma [ finorderstoplemma ]",
    ". hence , @xmath1914 , and the infinite concatenation @xmath1915 is really an infinite word , and it covers thewhole @xmath44 .    first , let us check that @xmath985 .",
    "indeed , otherwise @xmath1916 for all @xmath575 , and by lemma [ compkernelfixed ] , all words @xmath846 coincide as abstract words .",
    "but then @xmath1917 is @xmath674 for @xmath798 . on the other hand , we know that @xmath1918 , and @xmath40 is a letter of order @xmath1919 since @xmath1 , so @xmath1920 is @xmath827 for @xmath798 , and we have a contradiction .",
    "so , @xmath985 .",
    "note that the indices @xmath59 and @xmath62 from the statement of the proposition can now be written as @xmath1921 and @xmath1922 , so @xmath1923_k)= { { { \\alpha}_{s_{3k+1}+1\\ldots s_{3k+2}}}}={{{\\alpha}_{i+1\\ldots j}}}$ ] .",
    "first , let us consider the case when there exists a final period @xmath47 such that @xmath1924 is a completely @xmath47-periodic word . by lemma [ oneperenoughfortotleft ] ,",
    "in this case @xmath47 is a total left evolutional period of @xmath838 . by the definition of a total left evolutional period , the remainder of @xmath1925 modulo @xmath65 does not depend on @xmath118 , so it equals the remainder of @xmath1926 modulo @xmath65 , which is zero .",
    "therefore , all words @xmath1927 are completely @xmath47-periodic words , and @xmath1928 is an eventually periodic word with period @xmath47 , and its subword complexity is @xmath23 .",
    "now suppose that there exist no final period @xmath47 such that @xmath64 is a completely @xmath47-periodic word .",
    "since all evolutions of @xmath33-blocks present in @xmath44 are continuously periodic , proposition [ smallcompl ] guarantees that the subword complexity of @xmath19 is @xmath55 .",
    "we are going to prove that there exists a @xmath33-series of obstacles in @xmath44 .",
    "assume the contrary .",
    "consider the following evolutions of @xmath33-multiblocks : @xmath840 defined by @xmath1929 , and @xmath843 defined by @xmath1930 .",
    "each @xmath33-multiblock @xmath1929 begins with a @xmath33-block , so @xmath839 and @xmath842 are consecutive as @xmath33-multiblocks ( there can not be an empty @xmath33-block between them ) .",
    "so , the evolutions @xmath838 and @xmath840 are consecutive . similarly , @xmath840 and @xmath843 are consecutive . by lemma [ atleastonetotal ] ,",
    "at least one of the evolutions @xmath838 , @xmath840 , and @xmath843 is totally periodic .",
    "hence , there exists a final period @xmath47 such that at least one of the words @xmath1931 , @xmath1932 , or @xmath1933 is a weakly left @xmath47-periodic word .    by lemma [ oneperenoughfortotleft ] , this means that @xmath47 is a total left evolutional period of @xmath838 .",
    "now it follows directly form the definition of a total left evolutional period that @xmath47 is also a total left evolutional period of @xmath840 and of @xmath843 .",
    "then lemma [ atleastonereallytotal ] implies that @xmath47 is either a right total evolutional period of @xmath838 , or a right total evolutional period of @xmath840 . in particular ,",
    "at least one of the words @xmath1931 or @xmath1932 is a weakly right @xmath47-periodic word . by lemma [ oneperenoughfortotright ]",
    ", @xmath47 is a total right evolutional period of @xmath838 .",
    "now we know that @xmath47 is both left and right total evolutional period of @xmath838 . in particular ,",
    "@xmath1931 is weakly @xmath65-periodic word with both left and right period @xmath47 .",
    "since @xmath985 , by corollary [ betweenkernelgrowsgood ] , @xmath1934 .",
    "so , by lemma [ leftrightcompleteperiod ] , @xmath1935 is a completely @xmath47-periodic word , and we have a contradiction ( we are considering the case when there exist no final period @xmath47 such that @xmath64 is a completely @xmath47-periodic word ) .    therefore , there exists a @xmath33-series of obstacles in @xmath44 , and , by lemma [ obstcompl ] , the subword complexity of @xmath52 is @xmath1579 .",
    "we already know that the subword complexity of @xmath19 is @xmath55 , so the subword complexity of @xmath19 is @xmath66 .",
    "write @xmath50 . then for all",
    "@xmath409 we have @xmath1936 and @xmath1937 .",
    "since @xmath40 is contained in @xmath39 , @xmath40 must be a periodic letter of order 2 , not a preperiodic letter of order 2 .",
    "then all letters in @xmath45 have order 1 . since we have assumed that @xmath42 is ( in particular ) weakly 1-periodic morphism , @xmath323 consists of periodic letters of order 1 only , and @xmath350 .",
    "therefore , @xmath1938 , @xmath44 is an eventually periodic sequence with period @xmath323 , so @xmath52 is an eventually periodic sequence with period @xmath325 , and the subword complexity of @xmath19 is @xmath23 .    by lemma [ splitconcatenation ]",
    ", @xmath44 can be split into a concatenation of @xmath33-blocks and letters of order @xmath302 ( i.  e.  letters of order @xmath68 in this case ) . in particular , @xmath33-blocks still exist ( although it is possible that all of them are empty occurrences ) , but case ii must hold for all evolutions of @xmath33-blocks since there are no letters of order @xmath33 .    we are going to use lemma [ smallcompllemma ] . recall that if @xmath71 is a letter of order @xmath68 , then there exists @xmath1939 , @xmath1940 such that @xmath1851 is @xmath1941 for @xmath798 .",
    "let @xmath1942 be the minimal number @xmath1310 for all letters of order @xmath68 .",
    "since there are finitely many letters in @xmath3 , there exists @xmath1943 and @xmath815 such that if @xmath416 and @xmath71 is a letter of order @xmath68 , then @xmath1944 . without loss of generality , @xmath1138 .",
    "set @xmath1945 , and consider the following function @xmath1858 : @xmath1946 .",
    "if @xmath290 , then @xmath1947 , so the first condition in lemma [ smallcompllemma ] is satisfied .",
    "we do not have to check the second condition in lemma [ smallcompllemma ] since case ii holds both at the left and at the right for all evolutions of @xmath60-blocks in @xmath44 .",
    "for the third condition we observe that if @xmath1684 , @xmath290 , @xmath1683 , and @xmath69 is a letter of order @xmath375 , then @xmath71 is a letter of order @xmath68 , @xmath416 , so @xmath1944 .",
    "we also have @xmath1948 , so @xmath1949 , @xmath1950 , and @xmath1687 .",
    "therefore , we can use lemma [ smallcompllemma ] . by lemma [ smallcompllemma ] ,",
    "the subword complexity of @xmath52 is @xmath1951 .",
    "let @xmath38 be a letter such that @xmath50 for a nonempty word @xmath45 , and let @xmath41 .",
    "consider the following three cases : @xmath40 can be either a letter of order 2 , or a letter of finite order @xmath1952 , or a letter of order @xmath68 .",
    "if @xmath40 is a letter of order 2 , then the subword complexity of @xmath52 is @xmath23 by proposition [ ordertwocompl ] .",
    "if @xmath40 is a letter of a finite order @xmath1952 , then denote by @xmath1 the maximal number among the numbers @xmath1953 such that all evolutions of @xmath33-blocks arising in @xmath44 are continuously periodic .",
    "( recall that all evolutions of 1-blocks are always continuously periodic , see remark [ onecontper ] . ) by proposition [ smallcompl ] , the subword complexity of @xmath52 is @xmath55 . if @xmath1954 , then by lemma [ splitconcatenation ] , @xmath44 can be split into a concatenation of @xmath56-blocks and letters of order @xmath375 , so there exist evolutions of @xmath56-blocks in @xmath44 , and there exists a non - continuously periodic evolution of @xmath56-blocks in @xmath44 .",
    "so , by proposition [ largecompl ] , the subword complexity of @xmath19 is @xmath1579 , therefore it is @xmath66 . if @xmath1955 , then by proposition [ finordercomplstop ] , the subword complexity of @xmath19 is either @xmath66 , or it is @xmath23",
    "finally , suppose that @xmath40 is a letter of order @xmath68 .",
    "let @xmath404 be the maximal _ finite _ order of letters occurring in @xmath44 ( i.  e.  all letters occurring in @xmath44 are either of order @xmath1956 , or of order @xmath68 ) .",
    "denote by @xmath1 the maximal number among the numbers @xmath1957 such that all evolutions of @xmath33-blocks in @xmath44 are continuously periodic .",
    "again , by proposition [ smallcompl ] , the subword complexity of @xmath52 is @xmath55 . if @xmath1958 , then there exists an evolution @xmath385 of @xmath60-blocks such that @xmath385 is not continuously periodic . by proposition [ largecompl ] ,",
    "the subword complexity of @xmath19 is @xmath1579 .",
    "therefore , the subword complexity of @xmath19 is @xmath66 . if @xmath1959 , then by proposition [ infordercomplstop ] , the subword complexity of @xmath19 is @xmath58 .",
    "here we give an example of a sequence with complexity @xmath1960 . the easiest way to construct such",
    "a sequence is to use proposition [ finordercomplstop ] .",
    "let @xmath1961 .",
    "consider the following morphism @xmath42 : @xmath1962 and the following coding @xmath18 : @xmath1963 . here",
    "all letters are periodic , @xmath1964 is a letter of order 4 , @xmath1965 is a letter of order 3 , @xmath766 is a letter of order 2 , and @xmath1966 is a letter of order 1 .",
    "@xmath42 is a weakly 1-periodic morphism , but it is not a strongly 1-periodic morphism .",
    "however , for @xmath1967 we have @xmath1968 , @xmath1969 , @xmath1970 , and @xmath1971 , so @xmath1967 is a strongly 1-periodic morphism .",
    "the only final period we have here consists of a single letter @xmath1966 , so @xmath522 , and @xmath1967 is also a strongly 1-periodic morphism with long images .",
    "so , we have @xmath1972 , and @xmath1973 here we have several evolutions of 2-blocks ( when we speak about evolutions of 2-blocks , we should use the morphism @xmath1967 , not just @xmath42 , to compute the descendants since when we defined descendants , we assumed that @xmath42 is a strongly 1-periodic morphism with long images ) , and it is clear that all left borders and all right borders of all these evolutions equal @xmath1965 as abstract letters .",
    "therefore , case i holds for all evolutions of 2-blocks at the left .",
    "the images under @xmath18 of all 2-blocks here consist of letters @xmath1966 only , so each evolution @xmath385 of 2-blocks here is continuously periodic for the index @xmath1974 .",
    "therefore , we can apply proposition [ finordercomplstop ] and say that the subword complexity is @xmath1975 .              j .- j",
    ".  pansiot .",
    "_ complexit des facteurs des mots infinis engendrs par morphimes itrs_. in _ proceedings of icalp84 _ , volume 172 of lecture notes in computer science , pages 380389 .",
    "springer - verlag , 1984 ."
  ],
  "abstract_text": [
    "<S> we study structure of pure morphic and morphic sequences and prove the following result : the subword complexity of arbitrary morphic sequence is either @xmath0 for some @xmath1 , or is @xmath2 . </S>"
  ]
}