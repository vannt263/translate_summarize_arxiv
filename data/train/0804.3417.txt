{
  "article_text": [
    "in the last decade , astronomy has changed from a data - poor to a data - intensive science , and it is important that the analyses of this flood of new data are able to maximally extract important information .",
    "two fundamental analysis modes are ( 1 ) the fitting of parametrized physical models to data , perhaps in a bayesian framework using existing knowledge as priors , and , of equal importance , ( 2 ) the _ empirical _ investigation of data to characterize it on its own terms .",
    "this second method enables one to approach the data with a minimum of pre - existing theoretical bias , and to perhaps make new discoveries that would not be made by simply fitting existing models . with current terascale and upcoming petascale datasets ,",
    "the exploratory mode requires advanced methods of data mining to enable the full extraction of information from the data .    in extracting this information , the classification of , and measuring the distances to",
    ", objects in astronomical survey data provides a fundamental characterization of the dataset .",
    "it forms a vital first step in understanding both its ensemble properties and those of individual objects , and leads to improved investigations of the astrophysical nature of the universe .    in this paper",
    ", we present results from the laboratory for cosmological data mining , a partnership between the department of astronomy and the national center for supercomputing applications ( ncsa ) at the university of illinois at urbana - champaign ( uiuc ) , in collaboration with the automated learning group ( alg ) at ncsa , and the illinois genetic algorithms laboratory at uiuc .",
    "such a collaboration between institutions is atypical , and the combination of expertise allows us to apply the full power of machine learning to contemporary terascale astronomical datasets , guided by appropriate science drivers on which we are then able to follow up .    in the following , we first describe the data , to place the task in context , followed by the computing environment , a brief overview of the results thus enabled , the issues raised by the process , and prospects for the extension of this work to the petascale .",
    "the astrophysical objects considered here are stars , galaxies and quasars .",
    "the stars are a subset of the approximately @xmath1 to @xmath2 stars contained within our galaxy .",
    "likewise the galaxies are a subset of the approximately @xmath1 to @xmath2 galaxies in the observable universe .",
    "quasars are a phenomenon at the heart of many galaxies in which matter is being accreted onto a supermassive black hole . whereas galaxies can be thought of as agglomerations of stars , quasars are driven by different physics .",
    "their brightness renders them visible throughout most of the observable universe , to much greater distances at the same photometric limit than most galaxies .",
    "they are thus an important tracer of cosmic structure and evolution .",
    "modern sky surveys typically contain a set of objects with spectra and a much larger superset with just photometry .",
    "the spectra give detailed information on the type of object seen and , for a galaxy or quasar , its distance via the redshift .",
    "the photometry , however , just gives the brightness of the object in a few broad wavebands .",
    "therefore , the objects with spectra , provided they form a reasonably representative subsample , can be input as a training set to a supervised machine learning algorithm .",
    "the spectral information forms the target property ( e.g. , type or redshift ) , and the photometric information forms the training features .",
    "the machine learning can then be used to make empirical predictions about the much larger sample set objects for which only photometry is available , without a priori sample bias introduced by , for example , color , formed by the difference in magnitudes .",
    "the data investigated here are obtained from the sloan digital sky survey ( sdss ) @xcite .",
    "this is a project to digitally map @xmath3 steradians of the northern galactic cap in five broad optical photometric bands , @xmath4 , @xmath5 , @xmath6 , @xmath7 , and @xmath8 .",
    "the survey is unprecedented in its combination of accurate digital photometry , numbers of objects and spectra , and is thus the best dataset currently available for studying the ensemble properties , classifications , and redshifts of astrophysical objects .",
    "we consider the third and fifth data releases of the survey ( dr3 and dr5 ) .",
    "dr3 consists of 142,705,734 unique objects , of which 528,640 have spectra .",
    "there are 6.0 tb of images , and object catalogs in either fits @xcite format ( 1.2 tb ) or as a sql database ( 2.3 tb ) .",
    "dr5 is a superset of dr3 , approximately one and a half times the size .",
    "we utilize the objects with spectra as training sets . here , the training features are the four colors @xmath9 through @xmath10 in the four magnitude types measured by the sdss , although it is trivial to add any other feature that is measured for objects within the sdss , for example , measures of morphology . for each dataset",
    "we perform _ blind tests _ on subsets of the objects with spectra to obtain a realistic measure of the performance of the machine learning algorithm .",
    "the machine learning algorithms are implemented within the framework of the data - to - knowledge toolkit ( d2k ) @xcite , developed and maintained by the alg at ncsa .",
    "this allows the straightforward implementation of numerous @xmath11 modules , connected together via a gui interface to form itineraries .",
    "the machine learning algorithms available include decision tree , @xmath0-nearest neighbor ( @xmath0nn ) , genetic algorithm , artificial neural network , support vector machine , unsupervised clustering , and rule association . for the terascale datasets in use here ,",
    "our implementation includes enhanced versions of the standard modules that stream data of a fixed type , for example single - precision floating point .",
    "the standard d2k datatype , table , is more flexible , and there are many tools to deal with tables , but the operations usually require the full dataset to fit into machine memory , which is not an option for our analysis .",
    "the algorithms are run on the xeon linux cluster _ tungsten _ at ncsa , as part of a peer - reviewed , nationally allocated , lrac allocation to the lcdm project on this and other machines , renewed over multiple years .",
    "tungsten is a distributed memory system composed of 1280 compute nodes , 2560 processors , 3.8 tb ecc ddr sdram total memory , and a peak performance of 16.4 tflops .",
    "each node is a dell poweredge 1750 server running red hat linux with two intel xeon 3.2 ghz processors , 3 gb of memory , a peak double - precision performance of 6.4 gflops , and 70 gb of scratch disk space . a further 122 tb of general scratch disk space is available via the lustre filesystem , and the archival file storage is provided by the 5 pb unitree diskxtender mass storage system , connected via ftp interface . the node interconnect is myrinet 2000 .",
    "batch jobs are invoked via the load share facility ( lsf ) .    in the publicly distributed version of d2k",
    ", parallelism is implemented via the installation of the d2k server on the intended compute nodes , whose locations are specified in advance . on tungsten , this approach is unsuitable because different nodes are used each time the overall batch job is executed .",
    "what d2k does allow , however , is invocation in batch mode via a script .",
    "we therefore invoke the itineraries in this way directly via an lsf shell script on a head node .",
    "the script uses ssh to connect to multiple child nodes .",
    "each node runs an independent instance of the itinerary on a subset of the data and/or the machine learning parameter space .",
    "the input data are accessed from the global scratch disk space and is not altered , and the output data are independent in the sense that they only need to be collated when the all of the child nodes have returned their results .",
    "our approach is therefore an example of task farming , with no required communication between child nodes .",
    "thus communication libraries such as mpi are not needed .",
    "we give a brief overview of the astrophysical results enabled by the computing environment described above .",
    "using decision trees , we @xcite assigned probabilities p(galaxy , star , neither - star - nor - galaxy ) to each of the 143 million objects in the sdss dr3 .",
    "this enables one to , for example , either emphasize completeness ( the fraction of the true number of targets correctly identified ) , or efficiency ( the fraction of targets assigned a given type that are correct ) in subsamples , both of which have important scientific uses .",
    "our study was the first such classification performed on an astrophysical dataset of this size .",
    "the upper panel of fig .",
    "1 shows a result typical of those in the literature , prior to that from lcdm , for photometric versus spectroscopic redshift for quasars , here reproduced by blind - testing 20% of 11,149 sdss dr5 quasars using a single nearest - neighbor ( nn ) model .",
    "most objects lie close to the ideal diagonal line , but there are regions of ` catastrophic ' failure , in which the photometric redshift assigned is completely incorrect ( more than 0.3 from the true redshift ) .",
    "the correct assignation of these redshifts is vital for large numbers of future studies of the large scale structure in the universe , and the use of nn enables us to significantly reduce the instance of these catastrophics , by ` pulling in ' the outliers ( fig . 1 of @xcite ) .",
    "the rms dispersion between the photometric and spectroscopic redshift is reduced by 25% , from @xmath12 to @xmath13 ( error via 10-fold cross - validation ) .",
    "however , as we show in @xcite , we can improve on this even further : because every observed object magnitude in the sdss has an associated error , one can perturb the testing set numerous times according to the errors on the input features , and use the resulting variation to generate full probability density functions ( pdfs ) in redshift .",
    "this solves a classic machine learning problem of how to account for varying errors on the training set inputs .",
    "taking the mean value from each pdf gives a similar rms dispersion to the result of @xcite , @xmath14 , as expected .",
    "however , for the subset of quasars which have a single pdf peak , about 40% of the objects , the rms dispersion between the photometric and spectroscopic redshift is vastly improved to @xmath15 .",
    "this reduces the fraction of catastrophics from 20.2% to 0.7% , essentially eliminating them from the sample .",
    "this is shown in the lower panel of fig .",
    "1 . the panel shows only the first of the ten cross - validations , and thus the value of @xmath16 is within the error of , but not exactly equal to , 0.117 .",
    "here we summarize tungsten resource usage . because this is a scientific application using existing algorithms on existing proven hardware , we did not keep detailed quantitative records of quantities such as overall efficiency , time spent in compute , communication , or waiting on data from local or remote filesystems .",
    "we monitored the performance with the aim of having the tasks completed in a reasonable amount of time compared to that available , making sure , of course , that we were not navely wasting time .",
    "this is likely to be typical of many science applications in the future .",
    "table 1 shows some typical run times for the creation of these results .",
    "what we can say is that , generally , the usage of the resources is likely to be efficient , because it is dominated by the processing of data in situ at each node .",
    "communication between nodes is negligible because we are task farming , and at present we are not i / o limited .",
    "one of the main inefficiencies is that the time taken for the job is that taken by the slowest node , because the output requires the full set of results to be collated .",
    "the full set of nodes used for the job is reserved during the run .",
    "the problem is most acute when working with subsets of machine learning parameters , because different parameters can result in significant differences in runtime that can be difficult to predict .    for decision tree , in training , the data are small but the work is large , so this is cpu dominated . in applying the tree to 143 million objects , the 80 g file describing the objects is streamed through the d2k itinerary , but the classification process is fast ( about 2000 objects per second ) , so it is possible that data access here is more significant . for nn and @xmath0nn ,",
    "the training is trivial : memorize the positions of the objects in parameter space , and the training data are again small .",
    "the significant computation therefore occurs for the application to new objects , and scales as @xmath17 for @xmath18 training set objects and @xmath19 testing set objects , i.e. it is @xmath20 .",
    "thus the run time is dominated by the processing time to apply the algorithm to the new data , and the available parallelism .",
    "we now describe some of the issues encountered during data mining on tungsten . these form a case study of the specific issues encountered in the course of our work , but they are of general relevance in working with terascale data , and show the in - practice implementation of a science - driven data mining application on a high performance computing cluster .    * we are using tens to hundreds of parallel nodes and streaming many gb of data .",
    "d2k must therefore be invoked via batch script , negating the advantages of its gui interface . the lack of an integrated cyberenvironment results in batch scripts that contain many tens of settings , manually fixed file locations , and commands , that are prone to error .",
    "our large scale embarrassingly parallel processing of data via task farming is likely to become an increasingly common scientific application .",
    "a simple task farming utility that can be called via the job submission script would help to simplify these scripts and make them more robust . * batch job submission via lsf is inflexible , subject to fixed wallclock times and numbers of nodes , unpredictable queuing times and no recourse if a job fails , perhaps due a bug in the script , or a hardware problem in any of the nodes or the file system .",
    "the ability of the system to perform application checkpointing and to check for failure in any of the tasks on the child nodes , and rerun that task if such failure is encountered , would be another useful advance . * any dataset larger than that which fits comfortably in the tungsten home directory ( 5 g quota ) must be stored on the unitree mass storage system , because the scratch filesystem is purged .",
    "unitree is occasionally subject to outages in access or significant wait times . in combination with the queuing system for batch jobs described above",
    ", this can make new scripts that are to access large datasets time - consuming to debug .",
    "this is because the data must be either accessed directly from unitree , extracted to the scratch disk before debugging , or subsampled to a manageable size . * in general , machine learning algorithms have a large parameter space of adjustable settings , which inevitably require significant computing time to optimize before useful results are generated .",
    "the nearest - neighbor approach mitigates this to some extent , in particular the single nearest neighbor , but this in turn is computationally expensive due to the large number of distance calculations required for each object . *",
    "the present lack of fainter training data forces us to extrapolate in order to classify the whole sdss .",
    "while the data and results we obtain are well - behaved ( our training features , the object colors , are largely consistent beyond the limit of the spectroscopic training set ) , it will always be the case in astronomy that some form of extrapolation is ultimately required .",
    "this is simply due to the fact that , physically , photometry to a given depth requires a shorter observation time than spectroscopy .",
    "thus , while our supervised learning represents a vital proof - of - concept over a whole terascale survey , and our already good results can only improve for a given survey as more training data become available , ideally the general data mining approach should include semi - supervised or unsupervised algorithms .",
    "these will help to fully explore the regions of parameter space that lie beyond the available training spectra . *",
    "the data size is such that integrating the sql database with d2k via jdbc is impractical , and the data must be stored as flat files . as database engines become more sophisticated ,",
    "however , it could in the future become possible to offload partial or entire classification rules to a database engine .",
    "doing so , however , would require supercomputing resources for the database engine , which would result in an entirely new class of challenges .",
    "* many algorithms exist for the implementation of data mining on parallel computer systems beyond simple task farming ( e.g. , @xcite ) , but these are not widely used within science compared to the commercial sector , and most scientists are not trained to fully exploit them on parallel computing systems . thus interdisciplinary",
    "collaboration and training between scientists and experts in data mining and supercomputing will continue to be essential , and will only increase in importance on the petascale . * in general , most existing tools designed to deal with",
    "data mining require that the data fits in the machine memory .",
    "what is needed is a cyberenvironment in which the streaming of data that is larger than machine memory is fully integrated into the system , to the extent that the file size does not affect the top - level workflow seen by the user .",
    "given the petascale datasets planned for the next decade ( e.g. , the large synoptic survey telescope , scheduled for first light in 2014 , will generate around 7 pb per year , compared to the 10 tb of the sdss ) , it is vitally important that contemporary data mining can be carried out successfully on this scale .",
    "we discuss some of the issues that we expect to encounter , and estimate our scalability from terascale to petascale .    * for many applications on the petascale ,",
    "the performance becomes i / o limited .",
    "this is quantified by @xcite , who apply amdahl s law @xcite that one byte of memory and one bit per second of i / o are required for each instruction per second , to predict that a petaflop - scale system will require one million disks at a bandwidth of @xmath21 per disk .",
    "they also state that data should be stored locally ( i.e. , not transferred over the internet ) , if the task requires less than 100,000 cpu cycles per byte of data .",
    "many contemporary scientific applications are already such that local storage is favored by over an order of magnitude .",
    "* we can estimate the sizes of the upcoming datasets compared to the required computing power : in 35 years , the sdss will have completed its primary data releases , which will total less than twice the data available now .",
    "however , the proposed petascale system _ blue waters _ will come online at ncsa in @xmath22 years , increasing the computing power by @xmath23 compared to tungsten . in ten years",
    ", the data size will be @xmath24 times that now , i.e. , @xmath25 versus @xmath26 .",
    "however , this will be a further @xmath22 years on from blue waters , which , if moore s law continues to hold , will be another factor of 10 in computing power .",
    "thus computing power will have increased by @xmath24 times to match the data . *",
    "a similar improvement in affordable disk storage is predicted by @xcite .",
    "we therefore predict that it will be possible to perform data mining on petascale astronomical datasets , _ provided _ that ( a ) the i / o infrastructure exists to match the processing power and ( b ) the task farming model scales to many thousands of processors .",
    "condition ( a ) can be met so long as the necessary investment is made , and ( b ) is met because the task is embarrassingly parallel .",
    "we emphasize that this i / o infrastructure is vital to enable the continued effective use of scientific data .",
    "the million disks of @xcite are required even if the i / o rate scales as well as they predict , and this is by no means certain in a real - world system . * in our case",
    ", if we were to continue to use nn , the situation is in fact a little more complex , because the algorithm scales as @xmath17 , ( @xmath18 spectroscopic objects in the training set , @xmath19 photometric objects to classify ) .",
    "currently we have @xmath27 and @xmath28 , and in the next decade these are expected to increase to @xmath29 , via spectrographs such as wfmos or kaos , and @xmath30 via , e.g. , the lsst .",
    "the less rapid growth of @xmath18 and the dominance of @xmath19 that only grows by @xmath23 gives an increase in @xmath17 of @xmath24 .",
    "so our mode of data analysis is viable for at least the next decade .",
    "nevertheless , each object may be run on an unlimited number of nn models , and @xmath17 is still an @xmath31 algorithm , like many of those in data mining .",
    "therefore , there is incentive to pursue both even faster processing , particularly for distance calculations between pairs of points in parameter space , in the form of field - programmable gate arrays ( fpgas ) , general purpose graphical processing units ( gpgpus ) , cell processors , etc .",
    "similarly , faster i / o is always desirable . alternatively , there are treelike nn implementations or other algorithms such as decision tree that scale as @xmath32  log  @xmath32 , at the expense of losing information . *",
    "as mentioned , conventional hardware , in the form of large clusters of multicore compute nodes , is in principle scalable to the petascale .",
    "however , fpgas , gpgpus , and cell processors may be more suited to many data mining tasks , due to their embarrassingly parallel nature and ability to rapidly perform a large number of distance calculations .",
    "the lcdm group , in collaboration with the innovative systems laboratory at ncsa , has demonstrated a 100x speedup for the two - point correlation function ( another astronomical statistic with a large number of distance calculations that scales navely as @xmath31 ) on fpgas using an src-6 map - e system @xcite .",
    "a preliminary implementation of a @xmath0nn algorithm has also been made , although it was non - trivial because the algorithm itself had to be altered ( parallelized ) , in addition to wrapping the code .",
    "the authors acknowledge support from nasa through grants nn6066h156 and nng06gf89 g , from microsoft research , and from the university of illinois .",
    "the authors made extensive use of the storage and computing facilities at the national center for supercomputing applications and thank the technical staff for their assistance in enabling this work .",
    "the authors also wish to thank the reviewers for their helpful suggestions to improve the presentation and technical content of this paper .",
    ".summary of resource usage to obtain the results presented .",
    "dt = decision tree , and one dt model may include multiple bagging and cross - validation .",
    "nn = nearest neighbor algorithm , and @xmath0 is the number of nearest neighbors employed .",
    "the time taken is the number of seconds the job ran for multiplied by the number of nodes .",
    "the number of objects per second is the number of objects divided by this time .",
    "starred values are estimated .",
    "note that many of the individual runs are not especially large , but that the sum total implementation of the framework and the data storage would be infeasible on a desktop machine [ cols=\"<,<,<,<,<,<,<,<,^ \" , ]"
  ],
  "abstract_text": [
    "<S> we present recent results from the lcdm collaboration between uiuc astronomy and ncsa to deploy supercomputing cluster resources and machine learning algorithms for the mining of terascale astronomical datasets . </S>",
    "<S> this is a novel application in the field of astronomy , because we are using such resources for _ data mining _ , and not just performing simulations . via a modified implementation of the ncsa cyberenvironment data - to - knowledge , we are able to provide improved classifications for over 100 million stars and galaxies in the sloan digital sky survey , improved distance measures , and a full exploitation of the simple but powerful @xmath0-nearest neighbor algorithm . </S>",
    "<S> a driving principle of this work is that our methods should be extensible from current terascale datasets to upcoming petascale datasets and beyond . </S>",
    "<S> we discuss issues encountered to - date , and further issues for the transition to petascale . </S>",
    "<S> in particular , disk i / o will become a major limiting factor unless the necessary infrastructure is implemented . </S>"
  ]
}