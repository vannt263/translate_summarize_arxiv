{
  "article_text": [
    "_ rectifiability _ is a fundamental concept in geometric measure theory .",
    "rectifiable sets extend the class of surfaces considered in classical differential geometry ; while admitting a few edges and sharp corners , they are still smooth enough to support a rich theory of local analysis . however , for certain question of more global nature  the boundedness of singular integrals being the main example ",
    "the notion of rectifiability is too qualitative .    in a series of influential papers around the year 1990 , @xcite",
    ", g. david and s. semmes developed an extensive theory of _ quantitative rectifiability _ in euclidean spaces .",
    "one of their main objectives was to find geometric criteria to characterize the @xmath5-dimensional subsets of @xmath6 , @xmath7 , on which `` nice '' singular integral operators ( sio ) are @xmath8-bounded . here ,",
    "`` nice '' refers to sios with smooth , odd caldern - zygmund kernels , the archetype of which is the riesz kernel @xmath9 , @xmath10 .",
    "notice that for @xmath11 and @xmath12 , the riesz kernel essentially coincides with the cauchy kernel @xmath13 in the complex plane .",
    "a motivation for the efforts of david and semmes was the significance of sios for the problem of finding a geometric characterization of _ removable sets _ for bounded analytic functions and lipschitz harmonic functions .",
    "due to seminal papers by david @xcite , david and p. mattila @xcite , and f. nazarov , x. tolsa and a. volberg @xcite , @xcite , it is now known that these removable sets coincide with the purely @xmath14-unrectifiable sets in @xmath6 , i.e. the sets which intersect every @xmath15 hypersurface in a set of vanishing @xmath14-dimensional hausdorff measure",
    ". the geometric characterization of removability , and its connections to geometric measure theory and harmonic analysis , has a very interesting history ; we refer to the excellent survey by volberg and v. eiderman @xcite , and to the recent book of tolsa @xcite .",
    "the problem of characterizing removable sets for lipschitz harmonic functions has a natural analogue outside the euclidean setting in certain non - commutative lie groups , of which the heisenberg group is the simplest example . in this group ,",
    "the role of the euclidean laplace operator is played by the _ sub - laplacian _ and harmonic functions are , by definition , the solutions to the sub - laplacian equation .",
    "the question of characterizing removability for lipschitz harmonic functions was considered in @xcite for heisenberg groups @xmath16 endowed with a sub - riemannian metric . it was shown that sets with hausdorff dimension lower than @xmath17 are removable , while those with dimension higher than @xmath17 are not .",
    "moreover , there exist both removable and non - removable sets with hausdorff dimension equal to @xmath17 .",
    "hence , as in the euclidean case , the dimension threshold for removable sets is @xmath18 , where @xmath19 denotes the hausdorff dimension of @xmath16 .",
    "the results from @xcite were extended in @xcite from heisenberg groups to a larger class of lie groups , the _ carnot groups_. there exists a well developed theory of sub - laplacians in this setting , see for instance the book @xcite by a. bonfiglioli , e. lanconelli and f. uguzzoni .    in order to characterize removable sets for lipschitz harmonic functions in @xmath4 ,",
    "one has to characterize the sets on which the sio associated with the riesz kernel @xmath20 is bounded in @xmath21 . in @xmath22 , one would need to face a sio with kernel @xmath23 for @xmath24 . at this point ,",
    "the knowledge about the action of this sio on @xmath2-dimensional subsets of @xmath22 ( i.e. subsets of co - dimension @xmath25 ) is extremely limited . in the present paper",
    ", we will not address this question further , but it motivates the study of quantitative rectifiability in @xmath22 .",
    "the main purpose of the present paper is to initiate this study , and to introduce some new , relevant concepts in @xmath26 .",
    "our aims are twofold .",
    "first , we demonstrate that some parts , at least , of the euclidean theory of quantitative rectifiability carry over to @xmath0 . to us , this gives hope that  some day in the distant future  questions on the boundedness of sios on subsets of @xmath0 may be understood as well as they currently are in @xmath4 .",
    "our second aim is somewhat more philosophical : we want to demonstrate that building a theory of quantitative rectifiability in @xmath0 is worth the effort . in particular , the proofs are not , merely , technically challenging replicas of their euclidean counterparts .",
    "new phenomena appear .",
    "in particular , proving our main result , theorem [ main ] , involved studying non - smooth solutions of the ( planar ) non - linear pde @xmath27 known as the ( or rather `` a '' ) _ burgers equation_. in proving the euclidean counterpart of theorem [ main ] ,",
    "such considerations are not required . at least to us , any connection between the innocent - looking statement of theorem [ main ] , and the pde , was quite a surprise at first sight .    in the terminology of david and semmes , theorem [ main ]",
    "is the _ weak geometric lemma _ for certain subsets of @xmath0 , called _ intrinsic lipschitz graphs_. for now , we just briefly explain the meaning of these concepts ; precise definitions are postponed to sections [ s : prelim ] and [ s : bpilg ] .",
    "we consider two kinds of subgroups of @xmath0 : _ horizontal _ and _ vertical_. writing @xmath28 , the horizontal subgroups are lines through the origin inside @xmath29 , while the vertical subgroups are planes spanned by a horizontal subgroup and the `` @xmath30-axis '' @xmath31 .    in the present paper , we are mainly concerned with _ intrinsic graphs _ over a fixed ( but arbitrary ) vertical subgroup @xmath32 , which we often take to be the `` @xmath33-plane '' @xmath34 .",
    "let @xmath35 be the horizontal subgroup @xmath36 , and consider a function @xmath37 .",
    "the intrinsic graph of @xmath38 ( over @xmath39 ) is the set @xmath40 where `` @xmath41 '' refers to the heisenberg product ( see section [ s : prelim ] ) .",
    "note that @xmath42 is , in general different , from the `` euclidean graph '' @xmath43 , and in fact @xmath42 need not be representable as the euclidean graph of any function ( see example 2.5 in @xcite ) .",
    "recall that a function @xmath44 is ( euclidean ) lipschitz , if and only if there exists a cone , which , when centered at any point @xmath45 on the graph of @xmath46 , only intersects the graph at @xmath45 .",
    "the notion of _ intrinsic lipschitz function _ in @xmath0 is * defined * with this characterization in mind , with `` graph '' replaced by `` intrinsic graph '' , and `` cone '' replaced by a natural @xmath0-analogue , see .",
    "intrinsic lipschitz functions were introduced by b.  franchi , r.  serapioni and f.serra cassano in @xcite , and they turned out to be very influential in the evolution of geometric analysis in heisenberg groups , see for instance @xcite .",
    "curiously , the definition does not guarantee that an intrinsic lipschitz function is ( metrically ) lipschitz between the spaces @xmath39 and @xmath35 .",
    "if the reader is familiar with the theory of rectifiability in metric spaces , but not with that in @xmath0 , she may wonder why such `` intrinsic '' notions are necessary in the first place ; why can not one study ( metrically ) lipschitz images @xmath47 ?",
    "the reason is simple : a lipschitz image @xmath48 has vanishing @xmath49-dimensional measure for @xmath50 .",
    "this is a result of l. ambrosio and b. kirchheim @xcite .",
    "the work of mattila , serapioni and serra cassano @xcite and franchi , serapioni and serra cassano @xcite suggests that intrinsic lipschitz graphs , instead , are the correct class of sets to consider in connection with @xmath2-rectifiability in the heisenberg group .",
    "we believe that this is true also in the quantitative setting .",
    "lipschitz graphs in @xmath4 are , arguably , the most fundamental examples of quantitatively rectifiable sets in the sense of david and semmes . in the present paper",
    ", we propose that intrinsic lipschitz graphs play the same role in @xmath0 . in @xmath4 ,",
    "the term `` quantitatively rectifiable '' has many meanings ; the fundamental results of david and semmes show that a certain class of sets enjoys  and can be characterized  by a wide variety of properties , both geometric and analytic , each of which could be taken as the definition of `` quantitatively rectifiable '' . in @xmath0 , no such results are available , yet , so we have to specify our viewpoint to `` quantitative rectifiability '' .",
    "it will be that of `` quantitative affine approximation '' .",
    "theorem [ main ] , informally stated , says that intrinsic lipschitz graphs admit good affine approximations `` at most places and scales '' .",
    "the traditional way to quantify such a statement is via the notion of @xmath3-numbers , introduced by p. jones in @xcite in order to control the cauchy singular integral on @xmath25-dimensional lipschitz graphs .",
    "they were later used by jones @xcite and david and semmes @xcite in order to characterize quantitative rectifiability .",
    "the same approach works in @xmath0 , if the @xmath3-numbers are defined correctly . in definition [ verticalbetas ] below , we introduce the _",
    "vertical @xmath3-numbers_. these nearly coincide with the usual ( euclidean ) @xmath3-numbers , defined with respect to the metric in @xmath0 of course : the single , crucial , difference is that approximating affine planes are restricted to sets of the form @xmath51 , where @xmath52 and @xmath53 is a vertical subgroup . viewing @xmath0 as @xmath54 for a moment ,",
    "these sets are simply ( euclidean ) translates of the sets @xmath53 .",
    "so , they are quite literally vertical planes",
    ".    here is , finally , the main result :    [ main ] an intrinsic lipschitz graph in @xmath0 satisfies the weak geometric lemma for the vertical @xmath3-numbers .",
    "for a more precise restatement see theorem [ wglintlg ] . in brief , the weak geometric lemma states that , for any fixed @xmath55 , the vertical @xmath3-numbers of the graph have size at most @xmath55 in all balls , except perhaps a family satisfying a carleson packing condition ( with constants depending on @xmath55 ) .",
    "this manner of quantifying the `` smallness '' of an exceptional family of balls is ubiquitous in the theory of david and semmes .",
    "theorem [ main ] does not explain our need to define the vertical @xmath3-numbers ; since the vertical @xmath3-numbers are , evidently , at least as large as the `` usual '' ones ( with no restrictions on the approximating affine planes ) , the statement of theorem [ main ] merely becomes a little weaker , if the word `` vertical '' is removed .",
    "however , it turns out that the weak geometric lemma for the vertical @xmath3-numbers , combined with a condition on _ vertical projections _ , essentially * characterizes * intrinsic lipschitz graphs .",
    "this is the content of our second main result , a counterpart of a theorem of david and semmes @xcite from 1990 :    [ main2 ] assume that a @xmath2-regular set @xmath56 satisfies the weak geometric lemma for the vertical @xmath3-numbers , and has big vertical projections .",
    "then @xmath57 has big pieces of intrinsic lipschitz graphs .    as before",
    ", we postpone explaining the notions of _ big vertical projections _ ( definition [ bvp ] ) and _ big pieces of intrinsic lipschitz graphs _ ( definition [ bgilg ] ) .",
    "the latter condition does not guarantee that @xmath57 is an intrinsic lipschitz graph ( such a statement would be false , rather obviously ) .",
    "instead , @xmath58 contains a measure - theoretically big piece of an intrinsic lipschitz for every ball @xmath59 centered on @xmath57 .",
    "finally , we mention that theorem [ main2 ] admits a converse , which follows from theorem [ main ] by standard considerations , outlined at the end of the paper :    [ maincor ] assume that a @xmath2-regular set @xmath56 has big pieces of intrinsic lipschitz graphs .",
    "then @xmath56 satisfies the weak geometric lemma for the vertical @xmath3-numbers , and has big vertical projections .",
    "so , the property of having big pieces of intrinsic lipschitz graphs is characterized by the combination of the weak geometric lemma for the vertical @xmath3-numbers , and the big vertical projections condition .",
    "we remark that other versions of sub - riemannian @xmath3-numbers have been defined before .",
    "f. ferrari , b. franchi , and h. pajot @xcite , n. juillet @xcite and recently s. li and r. schul @xcite , @xcite , considered horizontal @xmath3-numbers in order to study curves in the heisenberg group .",
    "we stress that these quantities differ significantly from the vertical @xmath3-numbers . in the case of the horizontal @xmath3-numbers",
    ", approximation is restricted to _ horizontal lines _ , which are @xmath25-dimensional objects . as we mentioned earlier , for the vertical @xmath3-numbers ,",
    "the approximating sets are translated vertical planes , which are @xmath2-dimensional objects in the heisenberg metric .",
    "part of our motivation stems from facilitating the study of removability questions in @xmath0 ; and since the critical dimension for this problem is @xmath2 , we believe that the vertical @xmath3-numbers will be the relevant tool .",
    "the paper is organized as follows . in section [",
    "s : prelim ] we lay down the necessary background in the heisenberg group and we also discuss intrinsic lipschitz graphs and some of their main properties . in section [ s :",
    "bpilg ] , we give sufficient conditions for a @xmath2-dimensional set in the first heisenberg group to have big pieces of intrinsic lipschitz graphs .",
    "section [ s : wgl ] is devoted to the proof of theorem [ main ] and is definitely the most technical part of the paper . to facilitate the reader s navigation through the somewhat lengthy section [ s : wgl ]",
    "a second introductory part appears in section [ outline ] .",
    "* acknowledgements . *",
    "part of the research for this paper was completed while various subsets of the authors visited the universities of bern , helsinki and connecticut .",
    "the hospitality of these institutions is acknowledged .",
    "the _ heisenberg group _ @xmath0 is @xmath60 endowed with the group law @xmath61 for @xmath62 .",
    "we will sometimes identify @xmath60 with @xmath63 and denote points in the heisenberg group by @xmath64 for @xmath65 and @xmath66 .",
    "we use the following metric on @xmath0 : @xmath67 where @xmath68 the closed balls in @xmath69 will be denoted by @xmath70 .",
    "we will also denote by @xmath71 the @xmath72-dimensional hausdorff measure in @xmath69 .",
    "the reader who is not familiar with the notion of hausdorff measures should have a look at @xcite . for more information on the heisenberg group ,",
    "see for instance the book @xcite by capogna , danielli , pauls and tyson .",
    "here we just mention that @xmath73 , and the usual lebesgue measure on @xmath1 coincides ( up to a constant ) with @xmath74 on @xmath0 .",
    "the distance @xmath75 is invariant with respect to left translations @xmath76 and homogeneous with respect to dilations @xmath77    recall that a @xmath78-measurable set @xmath79 is _ @xmath2-(ahlfors - david)-regular _ , if there exists a constant @xmath80 , the _ regularity constant _ of @xmath57 , such that @xmath81 for all @xmath82 and @xmath83 .",
    "we stress once more that metric concepts in @xmath0 , such as `` ball '' , `` hausdorff measure '' or `` ahlfors - david regular '' are always defined with respect to @xmath84 , unless explicitly stated otherwise .",
    "identify @xmath0 with @xmath85 for a moment .",
    "if @xmath86 is a line through the origin , then @xmath87 is called a _ horizontal subgroup of @xmath0 . _",
    "a _ vertical subgroup of @xmath0 _ is a set of the form @xmath88 , where @xmath86 is a line through the origin .",
    "note that both @xmath32 and @xmath89 are subgroups of @xmath0 , and closed under the action of @xmath90 .    under the identification of @xmath32 with @xmath91",
    ", the subgroup @xmath32 can be endowed with the @xmath92-dimensional lebesgue measure @xmath93 .",
    "this turns out to be a haar measure on @xmath94 , and it agrees ( up to a multiplicative constant ) with @xmath78 on @xmath95 , see ( * ? ? ?",
    "* proposition 2.20 ) .    given a vertical subgroup @xmath96 of @xmath0",
    ", we define the _ complementary horizontal subgroup _",
    "@xmath97 where @xmath98 is the orthogonal complement of @xmath99 in @xmath100 .",
    "then every point @xmath101 can be written * uniquely * as @xmath102 with @xmath103 and @xmath104 .",
    "one could also consider other splittings of the heisenberg group , but in this paper we will always assume that the groups @xmath32 and @xmath105 are _ orthogonal _ ; by this we mean that @xmath99 and @xmath106 are orthogonal as above .",
    "let @xmath88 be a vertical subgroup with complementary horizontal subgroup @xmath107 .",
    "as we observed , every point @xmath101 can be written uniquely as @xmath108 with @xmath103 and @xmath104 .",
    "this gives rise to the _ vertical projection _ @xmath109 and _ horizontal projection _",
    "@xmath110 , defined by @xmath111 the mappings @xmath109 and @xmath110 have the following explicit formulae : @xmath112 and @xmath113 for @xmath114 . here",
    "@xmath115 and @xmath116 are the usual orthogonal projections onto the lines @xmath99 and @xmath106 in @xmath100 .",
    "we also used the abbreviating notation @xmath117 for @xmath118 and @xmath119 .",
    "the horizontal projections @xmath110 are both ( metrically ) lipschitz functions , and group homomorphisms .",
    "the vertical projections @xmath109 are neither . however , as we will see many times in this paper , the projections @xmath109 interact well with intrinsic lipschitz graphs , defined below .",
    "let @xmath32 be a vertical subgroup with complementary horizontal subgroup @xmath89 .",
    "@xmath0-cone perpendicular to @xmath32 and with aperture @xmath120 _ is the following set @xmath121 : @xmath122    [ d : intrlip ] a subset @xmath123 is an _",
    "intrinsic @xmath124-lipschitz graph over a vertical subgroup @xmath32 _ , if @xmath125 if @xmath126 is any set , and @xmath89 is the complementary horizontal subgroup of @xmath32 , we say that a function @xmath127 is _ an intrinsic @xmath124-lipschitz function _ , if the _ intrinsic graph of @xmath38 _ , namely @xmath128 is an intrinsic @xmath124-lipschitz graph .",
    "the _ intrinsic lipschitz constant _ of @xmath38 ( or @xmath129 ) is defined as the infimum over all constants @xmath124 for which @xmath38 ( or @xmath129 ) is intrinsic @xmath124-lipschitz .    for a nice picture of intrinsic lipschitz graphs and the @xmath0-cones ,",
    "see section 3 in @xcite .",
    "[ remk : para ] an intrinsic lipschitz graph can be uniquely parametrised by an intrinsic lipschitz function .",
    "more precisely , given an intrinsic @xmath124-lipschitz graph @xmath129 over a vertical subgroup @xmath32 , there exists a unique intrinsic @xmath124-lipschitz function @xmath130 such that @xmath131 .    to see this , one first checks that the cone condition implies the injectivity of @xmath132 .",
    "indeed , assume that @xmath133 for some @xmath134 . writing ( uniquely ) @xmath135 and @xmath136 , this gives @xmath137 since @xmath138 , and @xmath109 annihilates @xmath89 .",
    "hence , @xmath139 for any @xmath140 , and so @xmath141 , implying @xmath142 .",
    "consequently , the following mapping @xmath130 is well - defined : @xmath143 the mapping @xmath144 clearly satisfies @xmath131 , and thus @xmath144 is intrinsic @xmath124-lipschitz by definition .",
    "the uniqueness of @xmath144 follows from the uniqueness of the representation @xmath135 , @xmath145 .",
    "we refer to @xmath144 as the _ parametrisation of @xmath129_.    a key property of intrinsic lipschitz graphs is that they are invariant under left translations and dilations in @xmath0 ; if @xmath129 is an intrinsic @xmath124-lipschitz graph , then @xmath146 is also an intrinsic @xmath124-lipschitz graph for any @xmath101 and @xmath147 .",
    "this is why these sets are called `` intrinsic '' !",
    "[ rotationalinvariance ] we will often `` without loss of generality '' assume that the intrinsic lipschitz functions and graphs under consideration are defined over the specific vertical plane @xmath148 .",
    "this is legitimate , because the notions are invariant under the rotations @xmath149 around the @xmath30-axis , given by @xmath150 .",
    "the rotations are both group homomorphisms and isometries with respect to the metric @xmath84 .",
    "the homomorphism property implies that @xmath151 , and then the isometry property gives the following : if @xmath129 is an intrinsic @xmath124-lipschitz graph over @xmath32 , then @xmath152 is an intrinsic @xmath124-lipschitz graph over @xmath153 .",
    "the class of intrinsic lipschitz functions has ( in greater generality ) been introduced and studied by franchi , serapioni and serra cassano .",
    "the following facts are special cases of the results in @xcite and @xcite :    * for @xmath126 , an intrinsic @xmath124-lipschitz function @xmath154 can be extended to an intrinsic @xmath155-lipschitz function @xmath156 , where @xmath155 depends only on @xmath124 . *",
    "an intrinsic lipschitz function @xmath157 is intrinsically differentiable @xmath93 almost everywhere on @xmath32 . *",
    "an intrinsic @xmath124-lipschitz graph is @xmath2-regular with regularity constant depending only on @xmath124 .",
    "we will write more about intrinsic differentiability and the related notion of _ intrinsic gradient _ in section [ ss : intr_grad ] .",
    "if @xmath158 , we will use the notation @xmath159 to signify that there exists a constant @xmath160 depending only on @xmath161 such that @xmath162 .",
    "if the constant @xmath163 is absolute , we write @xmath164 .",
    "the two - sided inequality @xmath165 is abbreviated to @xmath166 .",
    "in this section , we start proving our two main results . to warm up ,",
    "we begin with the significantly easier theorem [ main2 ] : if a @xmath2-regular set @xmath56 satisfies the weak geometric lemma for vertical @xmath3-numbers , and has big vertical projections ( see definitions below ) , then @xmath57 has bpilg .",
    "the argument is very similar to the euclidean counterpart , due to david and semmes @xcite .",
    "in fact , the greatest surprise here is probably the similarity of the arguments itself : considering that the vertical projections @xmath167 are not lipschitz , one might expect a rockier ride ahead .",
    "we start with a few central definitions and auxiliary results .",
    "[ bvp ] a @xmath2-regular set @xmath168 is said to have _ big vertical projections _",
    "( bvp in short ) if there exists a constant @xmath169 with the following property : for all @xmath82 and for all @xmath170 there exists a vertical subgroup @xmath32 such that @xmath171    [ bgilg ] a @xmath2-regular set @xmath168 has _",
    "big pieces of intrinsic lipschitz graphs _",
    "( bpilg in short ) if there exist constants @xmath172 and @xmath173 with the following property",
    ". for all @xmath82 and @xmath170 , there exists an intrinsic @xmath124-lipschitz graph @xmath129 over some vertical subgroup such that @xmath174    [ verticalbetas ] let @xmath175 be a set , let @xmath176 be a ball with radius @xmath177 centered on @xmath57 , let @xmath32 be a vertical subgroup , and let @xmath52 .",
    "we write @xmath178 and then we define the _ vertical @xmath3-number _ as @xmath179 the infimum is taken over all vertical subgroups @xmath32 , and all points @xmath52 .",
    "[ changeofmidpoint ] the following observation is useful , and not quite as trivial as its euclidean counterpart .",
    "assume @xmath176 is a ball centered on @xmath57 , @xmath32 is any vertical subgroup , and @xmath52 . then @xmath180 to prove this , observe that @xmath181 for any point @xmath101 .",
    "in particular , if @xmath182 , we have @xmath183 hence , if further @xmath184 and @xmath185 , we have @xmath186 since this holds for all @xmath185 , we have @xmath187 as claimed .",
    "[ wgldef ] we say that a @xmath2-regular set @xmath168 satisfies the _ weak geometric lemma for vertical @xmath3-numbers _ ( wgl in short ) , if @xmath188 for all @xmath189 , @xmath82 and @xmath190 .",
    "the following lemma shows that even if the vertical projections @xmath109 are not lipschitz , they still can not increase @xmath78-measure ( too much ) .",
    "this is rather surprising , as it is easy to find less than three - dimensional sets @xmath56 such that @xmath191 , see example 4.1 in @xcite .",
    "[ lipschitzlemma ] let @xmath32 be a vertical subgroup in @xmath0 .",
    "then there exists a constant @xmath192 such that for all @xmath193 , one has @xmath194    the lemma follows from ( * ? ? ?",
    "* lemma 2.20 ) , which , when specialized to the heisenberg group , states that there is a constant @xmath195 such that @xmath196 for all @xmath197 and @xmath198 .",
    "see also ( * ? ? ?",
    "* lemma 3.14 ) .    given a set @xmath199 of positive @xmath200-measure ,",
    "choose a covering of @xmath201 by closed balls @xmath202 , @xmath203 , such that @xmath204 then , we find that @xmath205 this completes the proof .",
    "we recall the construction of _ david cubes _",
    ", first introduced by david in @xcite , which can be defined on any regular set in a geometrically doubling metric space .",
    "let @xmath56 be a @xmath2-regular set .",
    "then , there exists a family of partitions @xmath206 of @xmath57 , @xmath207 , with the following properties :    * if @xmath208 , @xmath209 and @xmath210 , then either @xmath211 , or @xmath212 . * if @xmath209 , then @xmath213 . * every set @xmath209 contains a set of the form @xmath214 for some @xmath215 , and some constant @xmath216 .",
    "the sets in @xmath217 are called david cubes , or just cubes , of @xmath57 . for @xmath209 , we define @xmath218 .",
    "thus , by ( ii ) , we have @xmath219 for @xmath220 . given a fixed cube @xmath221 , we write @xmath222 it follows from ( ii ) , ( iii ) , and the @xmath2-regularity of @xmath57 that @xmath223 for @xmath209 .",
    "it is an easy fact , needed a bit later , that the following holds : if @xmath224 are distinct points , there exists an index @xmath207 , and disjoint cubes @xmath225 , containing @xmath45 and @xmath226 , respectively , with the properties that @xmath227 , @xmath228 indeed , let @xmath207 be the largest integer such that @xmath229 , and let @xmath225 be the unique cubes containing @xmath45 and @xmath226",
    ". then @xmath230 , and since @xmath231 , we have @xmath232 .",
    "the same holds with the roles of @xmath45 and @xmath226 reversed .    in the sequel",
    ", we write @xmath233    the weak geometric lemma ( definition [ wgldef ] ) implies the following reformulation in terms of david cubes .",
    "write @xmath234 then @xmath235 for any @xmath189 and @xmath221 .",
    "deriving this property from definition [ wgldef ] is an easy exercise using the properties of david cubes , and we omit the details .",
    "here is the statement of theorem [ main2 ] once more :    [ t : main1_bpilg ] a @xmath2-regular set in @xmath0 with bvp and satisfying the wgl has bpilg .",
    "let @xmath236 be a system of david cubes on @xmath57 , let @xmath237 be constants , and let @xmath32 be a vertical subgroup . throughout this section",
    ", a cube @xmath220 will be called _ good _ ( more precisely @xmath238-good ) , if @xmath239 and @xmath240 we outline the proof of theorem [ t : main1_bpilg ] .",
    "the proof is divided into two parts , a geometric one , and an abstract one .",
    "the geometric part shows that good cubes @xmath220 are already `` almost '' intrinsic lipschitz graphs in the following sense : if @xmath241 and @xmath242 satisfy @xmath243 , then @xmath244 for some small @xmath140 .",
    "the abstract part uses the wgl and bvp assumptions to infer ( cutting a few corners here ) that only a small fraction of @xmath245 , @xmath246 , meets @xmath247 for some non - good cube @xmath248 .",
    "hence , a large set @xmath249 meets @xmath247 only for good cubes @xmath248 .",
    "unfortunately , this is not literally true , and additional ( technical ) considerations are needed . ignoring these for now",
    ", we can complete the proof as follows .",
    "fixing @xmath250 , we can use the discussion in section [ davidcubes ] to find a cube @xmath220 with @xmath241 , @xmath251 and @xmath252 .",
    "since @xmath250 , we know that @xmath248 is a good cube , and it follows from the geometric part that @xmath253 .",
    "consequently , @xmath254 is an intrinsic lipschitz graph .",
    "the following lemma is our counterpart of lemma 2.19 in david and semmes proof in @xcite .",
    "[ l : ds_lem ] assume that @xmath248 is a @xmath238-good cube , @xmath241 and @xmath242 with @xmath243 .",
    "then @xmath244 , if @xmath55 is sufficiently small with respect to @xmath255 , and @xmath140 is small enough ( depending on the constants @xmath256 ) .",
    "we start with a reduction to `` unit scale '' .",
    "assume that the statement of the lemma fails for certain parameters @xmath257 , and a certain @xmath238-good cube @xmath220 . by this",
    ", we mean that and hold for @xmath248 , yet @xmath258 for some @xmath241 and @xmath242 with @xmath259 .",
    "consider the set @xmath260 , and observe that it , also , satisfies , since @xmath261 and @xmath262 .",
    "the first equation is not altogether trivial , but it follows from the equations @xmath263 and the fact that the mapping @xmath264 , @xmath265 , has unit jacobian for any fixed @xmath101 , see the proof of lemma 2.20 in @xcite , or below .",
    "further , if @xmath266 , then @xmath267 . here , @xmath3 denotes the vertical @xmath3-number associated with @xmath268 .",
    "note that @xmath269 is @xmath2-regular with the same constants as @xmath57 .",
    "finally , note that @xmath270 , and @xmath271 with @xmath272 . to sum up ,",
    "if the lemma fails for @xmath248 , then we can construct another @xmath2-regular set @xmath269 , and another good david cube @xmath273 ( for @xmath269 ) with @xmath270 and @xmath274 , such that the lemma fails for @xmath273 .",
    "thus , it suffices to prove the lemma for a david - cube @xmath248 with the additional properties @xmath275 and @xmath276 .    to this end , assume to the contrary that @xmath277 with @xmath278 .",
    "we will use this to show that the entire projection @xmath279 is contained in a small neighbourhood of the @xmath30-axis @xmath280 .",
    "this will violate . somewhat abusing notation",
    ", we write @xmath281 let @xmath101 and @xmath53 be such that @xmath282 the first task is to show that the angle @xmath283 between @xmath284 and @xmath285 satisfies @xmath286 write @xmath287 .",
    "the plan is to use the smallness of @xmath288 in order to find a point @xmath289 on @xmath53 , but close to @xmath226 , such that latexmath:[\\[\\label{eq : angle }    the angle between @xmath106 and @xmath291 is @xmath292 and thus , as claimed . in order to show , we first observe that the assumption of @xmath277 implies @xmath293 recalling that @xmath278 , this is only possible if @xmath294 indeed , we even have @xmath295 ; otherwise the left hand side of can be bounded from below by @xmath296 , while the upper bound is then @xmath297 .",
    "for small enough @xmath298 , this is impossible .",
    "thus we may suppose .",
    "further , by remark [ changeofmidpoint ] we find for all @xmath299 that @xmath300 by our choice of @xmath161 and @xmath53 .",
    "in particular , for @xmath301 , there exists a vector @xmath302 with @xmath303 by , this gives @xmath304 , and finally , using @xmath277 , @xmath305 this proves and .",
    "so , we know that    * @xmath248 is close to @xmath53 ( by ) , * @xmath53 is close to @xmath285 ( by ) .    as we will next demonstrate , @xmath279 is close to @xmath306 .    indeed ,",
    "since we do not care about the best constants here , we can finish the proof very quickly : let @xmath307 be a number such that if @xmath308 , then @xmath309 for some @xmath310",
    ". recalling , we can pick @xmath311 arbitrarily small by choosing @xmath312 small enough .",
    "now , if @xmath313 , then by and the triangle inequality , we have @xmath314 for some @xmath315 . since @xmath109 is locally @xmath316-hlder continuous , it follows that @xmath317 the same holds with @xmath280 replaced by @xmath318 .",
    "finally , the @xmath319-measure of the @xmath320-neighbourhood of @xmath321 is bounded by a constant depending only on @xmath312 , and this constant tends to zero as @xmath322 . for sufficiently small values of @xmath312 , this violates , and the proof is complete .      in this section , we apply lemma [ l : ds_lem ] to good cubes inside a set @xmath175 satisfying the weak geometric lemma for vertical @xmath3-numbers .",
    "this is a counterpart for theorem 2.11 in @xcite , which in turn is modelled on a result of p.  jones @xcite .",
    "the proof below is very similar to that in @xcite ; given lemmas [ lipschitzlemma ] and [ l : ds_lem ] , the argument does not really see the difference between @xmath0 and @xmath4 .",
    "we still record the full details .",
    "[ t : main2_inv ] assume that @xmath168 is a @xmath2-regular set satisfying the wgl and let @xmath323 .",
    "then there exist numbers @xmath140 and @xmath324 , depending only on @xmath325 and the @xmath2-regularity and wgl constants of @xmath57 , such that the following holds :    for every david cube @xmath326 in @xmath57 and for all vertical projections @xmath109 , there exist intrinsic @xmath327-lipschitz graphs @xmath328 , @xmath329 , @xmath330    let @xmath57 and @xmath325 be as in the assumptions of theorem [ t : main2_inv ] .",
    "let further @xmath331 be a small number to be chosen later ( based on lemma [ l : ds_lem ] ) .",
    "fix an arbitrary cube @xmath221 , and an arbitrary vertical subgroup @xmath32 .",
    "first , we will group the cubes in @xmath332 into `` good '' and `` bad '' cubes , and control the quantity of the bad cubes via the wgl assumption .",
    "second , lemma [ l : ds_lem ] , coupled with a `` coding argument '' , will be used to partition the complement of the `` bad '' cubes in @xmath333 into the sets @xmath334 .",
    "the `` good '' cubes @xmath335 are the familiar @xmath336-good cubes defined right above lemma [ l : ds_lem ] .",
    "the class @xmath337 consists of those maximal ( hence disjoint ) cubes in @xmath326 that violate the first goodness condition , i.e. , @xmath338 let @xmath339 be the class of ( all , not maximal ) cubes that violate the second goodness condition : @xmath340    then , clearly , @xmath341 .",
    "it is also clear that the projections of bad cubes from the first class have small measure : for @xmath342 , we have @xmath343 on the other hand , for the second bad class , one can control the measure of the cubes directly by the variant of wgl formulated in : @xmath344    since @xmath345 for all @xmath346 by lemma [ lipschitzlemma ] , the inequality above shows that the @xmath109-projection of @xmath347 has measure no larger than @xmath348 .",
    "this is a little bit too weak for our purposes ; in analogy with , we wish to replace @xmath349 by a small constant . to this end",
    ", we set @xmath350 where @xmath351 is so large that @xmath352 .",
    "this is possible : @xmath353 with this definition of @xmath354 , lemma [ lipschitzlemma ] gives @xmath355    it remains to find subsets @xmath356 such that @xmath357 and for every @xmath358 and every pair @xmath359 it holds that @xmath360 for @xmath298 small enough ( only depending on @xmath325 and the @xmath2-regularity and wgl constants of @xmath57 ) .",
    "this is done via a `` coding argument '' , which goes back to jones , see @xcite .",
    "the argument is also explained briefly in david s book @xcite , p. 8182 , but we present the full details .    we start with a brief informal overview .",
    "write @xmath361 .",
    "why do we need a `` coding argument '' ?",
    "maybe we can show , directly , that if @xmath362 then @xmath360 ? pick two distinct points @xmath250 , and pick two disjoint cubes @xmath363 of some common generation such that @xmath364 , @xmath365 , @xmath366 and @xmath243 ( such cubes exist , as discussed in section [ davidcubes ] ) .",
    "now , since @xmath367 , we know that @xmath368 . if  and this is the `` big if ''  we also knew that @xmath369 for @xmath189 small enough , we could infer from lemma [ l : ds_lem ] that @xmath244 ( assuming also that @xmath298 is small enough ) .",
    "of course , we do not know that @xmath369 for the particular cube @xmath370 we are interested in : even though @xmath371 , there can still be up to @xmath372 `` exceptional '' cubes @xmath373 such that @xmath374 .",
    "the `` coding argument '' is needed to fix this issue . essentially , if we declare that @xmath375 , say , we want to make sure that the following holds : whenever @xmath373 with @xmath374 , then all the points @xmath376 are stored safely away in the other sets @xmath334 , @xmath377 . once that has been accomplished , the argument above works for @xmath378 ( or any @xmath334 ) in place of @xmath379 .",
    "we turn to the details , which are repeated from @xcite nearly verbatim . for each cube @xmath380",
    ", we will associate a certain finite sequence of @xmath381 s and @xmath25 s , denoted by @xmath382 .",
    "the length of such a sequence is denoted by @xmath383 .",
    "we declare @xmath384 to be the empty sequence .",
    "next , assume inductively that the numbers @xmath382 have been defined for the descendants of @xmath380 down to a certain generation , say @xmath49 .",
    "we now aspire to make the definition for cubes @xmath248 of generation @xmath385 .",
    "if @xmath248 is such a cube , and @xmath386 is its parent , we initially set @xmath387 .",
    "assume that @xmath388 , that is , @xmath374 , and assume that there exists at least one other cube @xmath389 of the same generation as @xmath248 such that @xmath390 ( if either of these assumptions fails , we do not alter @xmath382 now ) .",
    "note that @xmath382 and @xmath391 have both been initially defined .",
    "there are two cases to consider .",
    "* case 1 : @xmath392 .",
    "if @xmath393 , we do not alter @xmath382 or @xmath391 .",
    "but if @xmath394 , we re - define @xmath382 by adding a `` @xmath381 '' , and we re - define @xmath391 by adding a `` @xmath25 '' . *",
    "case 2 : @xmath395 .",
    "if , for instance , @xmath396 , then we do not alter @xmath382 .",
    "but we re - define @xmath391 by adding either `` @xmath381 '' or `` @xmath25 '' to it in such a fashion that the new @xmath391 is * not * an initial segment of @xmath382 . finally ,",
    "if @xmath397 , then we repeat the same step with the roles of @xmath248 and @xmath389 reversed .    after",
    "this procedure is complete , we pick another cube @xmath398 of generation @xmath385 ( if it exists ) , and perform the previous case chase with the pair @xmath399 replaced by @xmath400 . once all the pairs @xmath401 with @xmath402",
    "have been processed , we move on to other pairs @xmath403 with @xmath404 and @xmath405 , and give them the same treatment as above .",
    "the algorithm terminates eventually ( because there are only finitely many cube - pairs to consider ) , and , at the end , every cube @xmath248 of generation @xmath385 has an associated sequence @xmath382 . if @xmath406 for all cubes @xmath404 of generation @xmath385 , then @xmath382 retains the initial value @xmath407 .",
    "even if @xmath408 for some @xmath404 , this can occur only for a bounded number , say @xmath409 , of alternatives @xmath404 of generation @xmath385 .",
    "consequently , @xmath382 differs from @xmath407 by a sequence of length @xmath410 .    by applying the procedure at all generations @xmath49 , every sub - cube of @xmath333",
    "gets associated with a ( finite ) sequence @xmath382 .",
    "next , we wish to extend the definition of these sequences from cubes to points in @xmath411 .",
    "fix @xmath412 , and let @xmath413 be the unique sequence of dyadic cubes converging to @xmath45 . as discussed in the previous paragraph , @xmath414 can differ from @xmath415 only in case @xmath416 is contained in @xmath417 for some @xmath404 of the same generation as @xmath416 . by definition of @xmath371",
    ", there can only be @xmath418 such indices @xmath419 .",
    "in particular , the sequences @xmath415 converge to some finite sequence of @xmath381 s and @xmath25 s , denoted by @xmath420 .",
    "furthermore , for those @xmath418 indices @xmath419 , where @xmath414 possibly differs from @xmath415 , this difference is a sequence of length at most @xmath409 .",
    "consequently , the possible values of @xmath420 form a finite set @xmath421 , whose cardinality can be bounded from above in terms of the constants @xmath372 and @xmath409 . given an element @xmath422 , we now define @xmath423 it remains to check that the sets @xmath424 satisfy the useful property we hinted at in the informal overview .",
    "assume that @xmath250 belong to `` nearby '' two cubes @xmath425 of the same generation , namely with @xmath426 and @xmath366 , and assume that either @xmath427 or @xmath428 .",
    "then , we claim that @xmath45 and @xmath226 belong to two different sets of the form @xmath424 .",
    "consider the sequences @xmath429 and @xmath430 ( which are initial sequences in @xmath420 and @xmath431 , respectively ) .",
    "assume , for instance , that @xmath427 .",
    "this means that @xmath432 , so the pair @xmath433 is considered while defining the sequences @xmath429 and @xmath430 .",
    "then , inspecting case 1 and case 2 , it is clear that neither of the sequences @xmath429 and @xmath430 can be an initial sequence of the other .",
    "this proves that @xmath434 , as claimed .",
    "now , we can quickly prove that if @xmath435 then @xmath360 , if @xmath140 is small enough .",
    "pick @xmath436 , and let @xmath370 and @xmath437 be sub - cubes of @xmath333 , containing @xmath45 and @xmath226 , respectively , with same generation , satisfying @xmath426 and @xmath366 , and with @xmath252 .",
    "it follows from the claim in the previous paragraph that @xmath369 and @xmath438 .",
    "consequently , by lemma [ l : ds_lem ] , we have @xmath244 for small enough @xmath298 .",
    "this completes the proof of the theorem .    we are now prepared to prove theorem [ t : main1_bpilg ] .",
    "again , the proof is very similar to the euclidean argument , see theorem 1.14 in @xcite .",
    "let @xmath57 be a @xmath2-regular subset of @xmath0 with bvp , and satisfying the wgl .",
    "the former property ensures that for fixed @xmath82 and @xmath170 , there is a vertical subgroup @xmath32 such that @xmath439 where @xmath440 is a constant depending only on @xmath57 .",
    "then , there exists @xmath441 , depending only on @xmath440 and the @xmath2-regularity constant of @xmath57 , and a david cube @xmath442 such that @xmath443 and @xmath444    now we apply theorem [ t : main2_inv ] to this particular cube @xmath326 and choice of @xmath441 .",
    "it follows that there exist numbers @xmath140 and @xmath324 ( depending only on @xmath325 , and the @xmath2-regularity and wgl constants of @xmath57 ) with the following property : there exist intrinsic @xmath327-lipschitz graphs @xmath328 , @xmath329 , such that @xmath330 this , together with , implies @xmath445 thus there must exist some @xmath329 such that @xmath446 the proof is complete .",
    "in the first half of the paper , we saw that any @xmath2-ahlfors - david regular subset of @xmath0 with big vertical projections ( bvp ) , and satisfying the weak geometric lemma ( wgl ) , has big pieces of intrinsic lipschitz graphs ( bpilg ) .",
    "the second half of the paper is devoted to proving the converse .",
    "the fact that intrinsic lipschitz graphs ( and thus bpilg as well ) have bvp is almost trivial , see remark [ remark0 ] . hence in order to prove theorem [ maincor ] it suffices to prove the wgl for sets which have bpilg .      theorem [ wglbp ] will follow using standard arguments , recalled at the end of the paper , once we have at out disposal the wgl for intrinsic lipschitz graphs . therefore the rest of the paper will be devoted to the proof of theorem [ main ] , which is precisely stated below .",
    "the proof of theorem [ wglintlg ] in the euclidean case is relatively straightforward , and can be carried out as follows .",
    "assume that @xmath453 is an ( entire ) @xmath124-lipschitz function , and let @xmath236 be a system of dyadic squares on @xmath454 .",
    "assume that @xmath220 is such that @xmath46 is far from affine in @xmath248 , in the sense that @xmath455 for all affine functions @xmath456 .",
    "then , it is fairly easy to verify that the gradient of @xmath46 must fluctuate significantly near @xmath248 : there exists a fairly large sub - cube @xmath457 such that @xmath458 , where @xmath440 only depends on @xmath55 and @xmath124 , and @xmath459 denotes the average of @xmath460 over @xmath248 .",
    "the wgl follows from this observation , plus the fact that @xmath461 .",
    "after all , for such a function , there is a concept of an _ intrinsic gradient _",
    "@xmath462 ( see section [ ss : intr_grad ] below ) , which is known to exist at almost every point on @xmath32 , and moreover @xmath463 .",
    "so , if it were the case that the local `` non - affinity '' of @xmath38 forces @xmath462 to fluctuate noticeably , one could wrap up the argument in the fashion outlined above .",
    "however , this is simply not true : in any bounded domain @xmath464 , the equation @xmath465 admits ( smooth ) non - affine solutions ! for instance , the function @xmath466 satisfies @xmath467 on its domain .",
    "in fact , even non - smooth continuous solutions are possible : the function @xmath468 , discussed in ( * ? ? ? * remark 4.4.2 ) and defined by @xmath469 satisfies @xmath465 on @xmath470 , but it is not @xmath471 .",
    "the intrinsic graph of @xmath38 over the @xmath470 is depicted in figure [ fig1 ] .",
    "further examples of similar flavour have been discussed in @xcite in connection with minimal surfaces in the heisenberg group .",
    "we emphasise that the graphs of non - affine solutions to @xmath465 have plenty of non - zero @xmath3-numbers , but this behaviour is not registered by the fluctuation of @xmath462 .",
    "what can be done ? we still want to use the intrinsic gradient , so we need to invent a condition to replace `` non - affinity '' , which forces @xmath462 to fluctuate locally .",
    "it turns out that the right notion is `` being far from constant - gradient ( cg ) graphs '' .",
    "the following ( informal ) statement may sound almost tautological , but it requires a fair amount of work to verify : if @xmath38 deviates locally from all ( locally defined ) cg intrinsic lipschitz functions , then @xmath462 must fluctuate noticeably . following the euclidean idea ,",
    "this observation ( made precise in proposition [ dreamprop ] ) allows us to conclude that intrinsic lipschitz graphs satisfy a `` wgl for cg @xmath3-numbers '' , see theorem [ t : cg - wgl ] .    up to this point",
    ", the results can be accused of being abstract nonsense ; as far as we know , locally defined cg graphs could be quite wild , and we do not even claim to understand them very well .",
    "what we can understand , however , are * globally defined * cg graphs .",
    "these turn out to be affine ( see proposition [ constantgradientgraphs ] ) ! using this fact , and a compactness argument , we can prove that even locally defined cg graphs have the following key property : if @xmath129 is a cg graph `` defined in the whole ball @xmath70 '' , then @xmath129 is almost flat in all sufficiently small sub - balls of @xmath70 .",
    "this implies almost immediately that the usual wgl holds for cg - graphs , even if we do not record the argument separately .",
    "instead , we use our `` approximation by cg graphs '' result to conclude directly that the wgl holds for all intrinsic lipschitz graphs .",
    "we wish to mention that the proof strategy above was influenced by x. tolsa s proof @xcite of the fact that the _ weak constant density condition _ implies _ uniform rectifiability _ in @xmath4 .",
    "should the reader be familiar with that proof , she may wish to draw the following parallels in her mind : `` weak constant density '' is represented by `` intrinsic lipschitz '' , and `` uniform measure '' is represented by `` constant gradient graph '' .",
    "according to a well known theorem by rademacher , lipschitz maps between euclidean spaces are differentiable almost everywhere .",
    "the same result , appropriately interpreted , holds true for the intrinsic lipschitz functions appearing in this paper .",
    "similarly as in the euclidean setting , a function @xmath157 shall be differentiable at a point @xmath472 , if its graph at @xmath473 can be well approximated by the graph of a `` linear '' function @xmath474 .    following the terminology in @xcite , a function @xmath475 between complementary homogeneous subgroups",
    "is said to be _ intrinsic linear _ , if its intrinsic graph @xmath476 is a homogeneous subgroup of @xmath0 .",
    "if @xmath32 is a vertical subgroup and @xmath89 is a complementary orthogonal horizontal subgroup in @xmath0 , a map @xmath477 is intrinsic linear if and only if it is a _ homogeneous homomorphism _ ( see for instance proposition 3.26 in @xcite ) .",
    "the latter means that @xmath124 is a group homomorphism with the additional property that @xmath478 for all @xmath479 and @xmath198 . to give an example , if @xmath32 denotes the @xmath33-plane , it is not difficult to see that all intrinsic linear maps , or equivalently all homogeneous homomorphisms , are of the form @xmath480 for a constant @xmath481 .",
    "we are now ready to state the definition of _ intrinsic differentiability_. again we assume that @xmath32 is a vertical subgroup with complementary horizontal subgroup @xmath89 .",
    "first let us consider a function @xmath482 defined on an open subset of @xmath464 containing the origin , which we assume to be fixed under @xmath38 .",
    "we say that @xmath38 is intrinsic differentiable at the origin , if there exists an intrinsic linear map @xmath474 such that , for all @xmath479 , @xmath483 the map @xmath124 is called the _ intrinsic differential _ of @xmath38 at @xmath381 and it is denoted by @xmath484 .",
    "since the definition of differentiability is supposed to be _ intrinsic _ , we extend it in a left invariant fashion to arbitrary functions and points . to explain the definition , we consider a function @xmath485 on an open set @xmath464 with intrinsic graph @xmath129 . for @xmath486 ,",
    "we write @xmath487 and let @xmath488 be the uniquely defined function @xmath156 , which parametrizes the graph @xmath489 , see remark [ remk : para ] .",
    "note that the definition of intrinsic graph ensures that any left translate of @xmath129 by a point in @xmath129 is an intrinsic graph passing through the origin .",
    "this uniquely determines the function @xmath488 and it ensures that the origin is fixed under this function .",
    "we also formulate an equivalent definition of intrinsic lipschitz functions using the maps @xmath490 . if @xmath126 , a function @xmath491 with intrinsic graph @xmath129 is an intrinsic @xmath124-lipschitz function if and only if for every @xmath492 @xmath493 for all @xmath494 in the domain of @xmath495 .",
    "see also ( * ? ? ? * proposition 4.49 ) for other equivalent algebraic definitions for intrinsic lipschitz functions .",
    "an explicit formula for @xmath496 is given in lemma [ l : transl ] below .",
    "we say that a function @xmath485 , defined on an open set @xmath464 , is _ intrinsic differentiable _ at a point @xmath497 , if the function @xmath488 for @xmath487 is intrinsic differentiable at the origin .",
    "the _ intrinsic differential _ of @xmath38 at @xmath497 is given by @xmath498    intrinsic differentiability can be characterized in various equivalent ways , see for instance the results in @xcite , @xcite , and @xcite .",
    "one can also define intrinsic differentiability in terms of a `` graph distance '' , see definition 1.4 in @xcite , and for intrinsic lipschitz maps this definition is equivalent to the one above .",
    "the intrinsic differential is unique , and its action can be expressed in terms of a `` gradient '' similarly as in the euclidean case . to explain this",
    ", we identify @xmath499 and @xmath500 .",
    "points in @xmath32 are then denoted by @xmath33 .",
    "assume that a map @xmath501 is intrinsic differentiable at @xmath502 .",
    "then , as pointed out earlier , the intrinsic differential @xmath503 of @xmath38 at @xmath504 is a linear mapping of the form @xmath480 for some @xmath505 .",
    "we next derive a few useful formulae for @xmath507 .",
    "let @xmath508 be the point on the graph of @xmath38 .",
    "by definition of intrinsic differentiability , @xmath509 consequently , dividing by @xmath510 , we have @xmath511 moreover , wherever @xmath38 is differentiable in the usual ( euclidean ) sense , the formula above , and @xmath512 ( this follows from the formula for @xmath513 in lemma [ l : transl ] ) yields the following representation for @xmath514 : @xmath515 this was observed in example 5.5 in @xcite .    a large class of almost everywhere intrinsic differentiable functions is provided by intrinsic lipschitz functions whose target is a @xmath25-dimensional horizontal subgroup . this result",
    "was first proved by franchi , serapioni and serra cassano in ( * ? ? ?",
    "* theorem 4.29 ) for heisenberg groups , and later by franchi , marchi and serapioni in @xcite for certain more general carnot groups .",
    "we state here the result relevant for the current paper :    [ t : intrradem ] let @xmath32 be a vertical subgroup of @xmath0 with complementary horizontal subgroup @xmath89 .",
    "assume that @xmath516 is an open subset of @xmath32 and @xmath485 is intrinsic lipschitz .",
    "then @xmath38 is intrinsic differentiable @xmath93 almost everywhere in @xmath32 .",
    "it follows that the intrinsic gradient @xmath514 of an intrinsic lipschitz function @xmath482 exists almost everywhere in @xmath516 , and it is an @xmath517 function , see for instance proposition 4.4 in @xcite . in our situation",
    ", one can say something more precise :    [ l : bound_grad ] let @xmath32 be a vertical subgroup with complementary horizontal subgroup @xmath89 in @xmath0 , and let @xmath518 be an intrinsic @xmath124-lipschitz function on an open set @xmath464 .",
    "then @xmath519      by theorem [ t : intrradem ] , @xmath38 is intrinsic differentiable in almost every point of @xmath516 .",
    "we let @xmath497 be such a point , and we write @xmath520 for the corresponding point on the graph . recall that the function @xmath496 in is defined as the function",
    "whose graph is the left translate of the graph of @xmath38 by @xmath521 .",
    "we denote the domain of @xmath496 by @xmath522 .    in order to prove",
    ", it suffices to find a bound for the limit in . to this end , let @xmath510 be small enough such that @xmath523 . then by @xmath524 here we have used",
    ". thus @xmath525 . since @xmath497 was an arbitrary point of intrinsic differentiability , follows by theorem [ t : intrradem ] .    in the converse direction ,",
    "proposition 1.8 in @xcite provides local upper bounds for the lipschitz constant in terms of the @xmath517-norm of the intrinsic gradient .",
    "while these results connect @xmath514 to the geometry of intrinsic lipschitz graphs , the intrinsic gradient has a life of its own outside the world of intrinsic lipschitz maps . to see this",
    ", it is best to express @xmath514 as in .",
    "the equation @xmath526 is well known in pde theory as the _ inviscid burgers equation_. this will be discussed further in section [ s : constantgradientgraphs ] below .",
    "in which sense are intrinsic lipschitz functions solutions to an equation of burgers type ?",
    "by theorem [ t : intrradem ] , the intrinsic gradient of an intrinsic lipschitz function exists pointwise almost everywhere . in connection with pde theory ,",
    "it is useful to know that the pointwise intrinsic gradient of an intrinsic lipschitz function is also a _ distributional _ gradient .",
    "this is the content of proposition 4.7 in @xcite .",
    "precisely , if @xmath157 is intrinsic lipschitz with intrinsic gradient @xmath514 , defined almost everywhere by theorem [ t : intrradem ] , then holds in a distributional sense : @xmath527 for all @xmath528 .",
    "we emphasize that the intrinsic lipschitz functions as in definition [ d : intrlip ] coincide with the intrinsic lipschitz functions in the sense of @xcite , see theorem 4.60 in @xcite and remark 3.6 in @xcite .",
    "note further that the formula looks slightly different from @xcite due to a different model for the heisenberg group , see definition 3.1 in @xcite .",
    "while the definition of intrinsic lipschitz continuity is tailored so that the class of intrinsic @xmath124-lipschitz graphs is preserved under dilations and translations in the heisenberg group , the explicit formula for the parametrization of a translated graph becomes in general slightly complicated due to the non - commutativity of the group law . in the case we consider in the present paper : functions from vertical to horizontal subgroups in @xmath529 , the computations are straightforward .    for convenience ,",
    "given a point @xmath197 , we define the map @xmath530 we note that @xmath531 is a diffeomorphism with jacobian determinant constant equal to @xmath25 under the obvious identification of @xmath32 with @xmath91 ( see ( * ? ? ?",
    "* lemma 2.20 ) ) , and with inverse map @xmath532 .",
    "the latter claim follows from the fact that @xmath533    [ l : transl ] let @xmath129 be the intrinsic graph of a function @xmath534 on a vertical subgroup @xmath32 , and let @xmath516 be a domain in @xmath0 .",
    "then , for @xmath535 , the set @xmath536 is the intrinsic graph of the function @xmath537 if @xmath38 is intrinsic @xmath124-lipschitz , then so is @xmath538 with @xmath539 analogously , for @xmath198 , the set @xmath540 is the intrinsic graph of the function @xmath541 if @xmath38 is intrinsic @xmath124-lipschitz , then so is @xmath542 with @xmath543      we concentrate on proving the statement for left translations . in (",
    "* proposition 2.7 ) it has been shown that if @xmath129 is the intrinsic graph of a function @xmath38 over a domain in @xmath89 , then @xmath546 is an intrinsic graph parametrized by the function @xmath538 .",
    "the domain of the new function @xmath538 is simply the image of @xmath546 under the projection onto @xmath32 .",
    "the intrinsic lipschitz property of @xmath538  assuming the corresponding property for @xmath38  is the content of ( * ? ? ?",
    "* theorem 3.2 ) .    to compute the intrinsic gradient",
    ", we may assume without loss of generality that @xmath547 agrees with the @xmath33-plane and that @xmath38 is defined on the entire plane @xmath547 .",
    "in this case , for @xmath548 , we have that @xmath549 we then use the fact , proved in @xcite , that the intrinsic gradient of an intrinsic lipschitz function is also a distributional gradient ; see the discussion in section [ ss : intr_grad ] .",
    "let now @xmath550 be an arbitrary test function , that is , a compactly supported @xmath15 function on @xmath547 .",
    "since @xmath551 we find that @xmath552 this , together with the facts that @xmath553 and @xmath514 is a distributional gradient , recall , gives @xmath554 as this computation is valid for arbitrary test functions @xmath550 , the claim follows .      in this subsection , we prove that `` entire '' intrinsic lipschitz functions with almost surely constant gradient are affine .",
    "as mentioned in section [ ss : intr_grad ] , if @xmath32 is identified with @xmath91 , the differential equation @xmath555 is known as the inviscid burgers equation and it is not difficult to see by the _ method of characteristics _ ( see ( * ? ? ?",
    "* proposition 5.1 ) ) that the only global @xmath15 solutions are constant functions .",
    "if the right - hand side of the equation is replaced by some other constant @xmath255 , one can show in the same vein that the only @xmath471 solutions are affine functions of the form @xmath556 ; see ( * ? ? ?",
    "* remark 4.3 ) .",
    "[ constantgradientgraphs ]",
    "let @xmath157 be an intrinsic lipschitz function .",
    "if there exists a constant @xmath557 such that @xmath558 almost everywhere in @xmath32 , then the graph of @xmath38 is the left translate of some vertical plane @xmath559 .    throughout the proof",
    ", we identify @xmath32 with @xmath91 , using coordinates @xmath33 .",
    "we will prove that @xmath560 for some @xmath561 . since @xmath38 is intrinsic lipschitz ,",
    "it is continuous , see for instance ( * ? ? ?",
    "* proposition 3.4 ) .",
    "we start by observing that the almost sure constancy of the intrinsic gradient leads to improved regularity for @xmath38 . by (",
    "* proposition 4.7 ) , the function @xmath38 is a distributional solution to the equation @xmath562 for @xmath563 . since @xmath564 is constant , it is in particular lipschitz continuous in the euclidean sense and ( * ? ? ?",
    "* corollary 1.4 ) implies that @xmath38 is locally lipschitz on @xmath32 with respect to the euclidean metric ; see also theorem 4.2.1 and theorem 4.4.1 in @xcite .",
    "hence , almost every point @xmath494 of @xmath32 is `` good '' in the sense that the function @xmath38 is differentiable at @xmath494 both in the usual euclidean sense and in the intrinsic sense with @xmath565 .",
    "we denote by @xmath566 the set of such good points in @xmath32 , so that @xmath567 .",
    "let us assume for a moment that @xmath568 is such that @xmath572 for almost every @xmath573 . towards a proof of",
    ", we define the function @xmath574 we note that @xmath575 is locally lipschitz continuous , so @xmath576 exists for almost all @xmath72 .",
    "further , by the assumption that @xmath577 for almost every @xmath72 , we have for such points that @xmath578\\partial_t \\phi(\\gamma_t(s))\\\\ & = -z(s ) \\partial_t \\phi(\\gamma_t(s)).\\end{aligned}\\ ] ] here we have used that @xmath579 on @xmath566 , see and the subsequent discussion .",
    "thus @xmath575 solves an ode of the form @xmath580 clearly , @xmath581 is a solution , but we have to argue that it is the _ only _ solution .",
    "here we are interested in _ carathodory solutions _",
    "@xmath582 , that is , in functions which are absolutely continuous on every closed interval @xmath583\\subset { \\mathbb{r}}$ ] and which fullfill the differential equation pointwise almost everywhere ; see for instance ( * ? ? ?",
    "* chapter 1 ) for a thorough discussion of carathodory differential equations .",
    "since @xmath38 is locally lipschitz as a function on the euclidean plane and @xmath584 is a smooth curve with @xmath572 for almost every @xmath573 , the function @xmath585 is locally integrable on every interval @xmath583\\subset { \\mathbb{r}}$ ] . by theorem 3 in (",
    "* chapter 1 ) , this suffices to ensure that the ode has a unique carathodory solution on @xmath586 .",
    "hence , @xmath581 and follows for this particular choice of @xmath30 .",
    "next , we would like to show that almost every @xmath568 has the crucial property that @xmath572 for almost every @xmath72 .",
    "this is the content of lemma [ avoidance ] below",
    ". the statement would be immediate if we knew that the curves @xmath587 foliated the plane @xmath32 , or even a large portion thereof , but there is no such _ a priori _ information available . in fact , this foliation property is part of the statement we want to prove .",
    "so , we have to work a bit harder , and we are essentially rescued by the local lipschitz regularity of @xmath588 . in the proof of lemma [ avoidance ] we need a sharpened version of the `` easy implication '' in the besicovitch projection theorem .",
    "this result may be known to some experts , but we did not find it in the literature :          we start with a series of reductions . without loss of generality we can assume that @xmath592 is bounded .",
    "moreover it is enough to prove the lemma for @xmath602)$ ] for @xmath603 lipschitz and @xmath190 . to see this , first",
    "recall that if @xmath592 is a bounded rectifiable set there exist countably many lipschitz maps @xmath604 such that @xmath605))=0 $ ] for some @xmath190 . applying the lemma to each of the sets @xmath606)$ ]",
    "we obtain sets @xmath607 satisfying ( i ) and ( ii ) .",
    "now let @xmath608 .",
    "trivially @xmath593 and if @xmath594 is any @xmath595-measurable subset with @xmath609 , then there exists some @xmath610 such that @xmath611 . since @xmath610 satisfies ( ii ) , if @xmath612 then @xmath598 .",
    "fix @xmath189 .",
    "it is enough to find a subset @xmath613 such that @xmath614 and the following property holds : if @xmath615 is measurable with @xmath616 and @xmath617 , then @xmath618 .",
    "then , we can complete the proof by setting @xmath619 .    by (",
    "* theorem 7.4 ) there exists a compact @xmath471-curve @xmath620 such that @xmath621 .",
    "then , if @xmath615 is measurable with @xmath622 , we have @xmath623 .",
    "thus , it actually suffices to construct @xmath624 so that the following holds : if @xmath625 is measurable with @xmath626 and @xmath627 , then @xmath618 . one final reduction : for fixed @xmath628 , we construct a set @xmath629 with the properties that ( a ) @xmath630 , and ( b ) if @xmath625 is measurable with @xmath626 and @xmath631 , then @xmath618 .",
    "this suffices , since @xmath632 is then the set we are after .    to construct @xmath629",
    ", we fix a number @xmath633 , to be specified later , and cover @xmath634 by a a collection @xmath635 of disjoint arcs of length between @xmath636 and @xmath637 .",
    "next , for some @xmath638 depending on @xmath5 , we partition @xmath129 into short , connected sub - curves @xmath639 such that the following holds : for every fixed @xmath640 , the restriction @xmath641 is bi - lipschitz for all @xmath642 , except possibly those @xmath643 in the union of four arcs in @xmath644 ( depending only on @xmath645 ) .",
    "such a partition @xmath646 exists , because @xmath129 is compact and @xmath471 .",
    "consider a bi - partite graph with vertex set @xmath647 and the following edge set @xmath57 : draw an edge between @xmath640 and @xmath648 , if and only if @xmath641 is bi - lipschitz for * all * @xmath649 .",
    "thus , every vertex @xmath646 is adjacent to at least @xmath650 vertices in @xmath644 . for an edge @xmath651 ,",
    "define the weight @xmath652 thus , if @xmath653 is the sum of all the weights of edges in @xmath57 , we have @xmath654 now , write @xmath655 and call a vertex @xmath648 _ light _ , if the total weight of edges emanating from @xmath656 is at most @xmath657 .",
    "other vertices in @xmath644 are _",
    "denoting the light and heavy vertices in @xmath644 by @xmath658 and @xmath659 , respectively , we have @xmath660 .",
    "we now fix @xmath5 so large that @xmath661 , which gives @xmath662",
    ". then , let @xmath663 the set @xmath629 satisfies the correct length estimate : @xmath664 by the choice of @xmath665 .    finally , we want to show that @xmath618 , whenever @xmath625 is measurable with @xmath666 , and @xmath667 .",
    "so , fix @xmath668 with @xmath669 , and write @xmath670 . then @xmath671 then , fix @xmath667 , so that @xmath672 for some @xmath659 .",
    "this implies that @xmath656 is adjacent to at least one vertex @xmath673 ; otherwise , recalling that @xmath674 , we have @xmath675 which contradicts @xmath676 .",
    "now , pick @xmath673 such that @xmath677 . by definition of @xmath57",
    ", this means that @xmath641 is bi - lipschitz , and consequently @xmath678 the proof is complete .",
    "with @xmath683 , we may re - write the claim as follows : @xmath684 so , it suffices to show that for almost every @xmath685 , we have @xmath686 , where @xmath687 assume that this claim is false : there exists a positive measure set @xmath421 of parameters @xmath72 such that @xmath688 . observe that @xmath689 for @xmath422 , where @xmath690 next , write @xmath691 for @xmath692 ; then , up to scaling , @xmath693 is the orthogonal projection onto the line spanned by @xmath694 in the @xmath33-plane . recalling remark [ sfinite ] we can apply lemma [ projectionlemma ] to the lipschitz graph @xmath129 and",
    "obtain a set of parameters @xmath695 with @xmath696 , with the property that @xmath697 , whenever @xmath698 and @xmath699 .",
    "in particular , @xmath697 for almost all @xmath422 . observing that @xmath700 for every @xmath72 , this forces @xmath701 for almost all @xmath422 , which contradicts @xmath702 .",
    "the proof of the lemma is complete .",
    "we have now established that holds for almost every @xmath703 , and the rest of the proof of proposition [ constantgradientgraphs ] is easy .",
    "first , notice that @xmath704 now , if @xmath705 for some @xmath706 , then @xmath707 for some @xmath708 .",
    "it follows that for such @xmath706 , the curves @xmath584 and @xmath709 intersect at @xmath710 .",
    "recall that we aim to show that @xmath711 for some @xmath712 .",
    "we first show that @xmath588 is constant .",
    "pick @xmath30 and @xmath713 satisfying .",
    "if @xmath714 , then by the discussion in the previous paragraph , @xmath715 for some @xmath716",
    ". consequently , @xmath717 by , which contradicts @xmath718 .",
    "so , @xmath588 is constant , say @xmath719 , on the set where holds . referring again to",
    ", we find that , for @xmath319 almost all @xmath720 , we have @xmath721 since @xmath38 is continuous , this is in fact true for all pairs @xmath722 , and hence @xmath723 for all @xmath724 .",
    "the proof is complete .      in this section ,",
    "we start to implement the plan outlined in section [ outline ] : we define a variant of @xmath3-numbers , the _ constant gradient @xmath3-numbers _ , and prove that intrinsic lipschitz graphs satisfy a weak geometric lemma with respect to this new definition .",
    "if @xmath129 is an intrinsic lipschitz graph over @xmath32 , the constant gradient @xmath3-number ( with parameter @xmath124 ) of a ball @xmath70 is designed to described how well @xmath725 can be approximated by the graph of an intrinsic @xmath124-lipschitz function whose gradient is constant almost everywhere in @xmath726 . here",
    "@xmath727 is a small constant , given by the following lemma , and @xmath70 denotes a closed ball with radius @xmath728 centred at @xmath45 .",
    "[ eq : ball_inclusion ] for every @xmath729 there exists a constant @xmath727 such that if @xmath157 is an intrinsic @xmath124-lipschitz function on a vertical subgroup @xmath32 , then @xmath730 for all @xmath45 on the graph @xmath129 of @xmath38 and for all @xmath198 .",
    "let @xmath731 be an intrinsic graph , where @xmath732 is an intrinsic lipschitz function .",
    "fix a point @xmath452 and a radius @xmath147 . then , for @xmath172 , define @xmath733 the infimum is taken over all intrinsic @xmath124-lipschitz functions @xmath734 which have intrinsic gradient constant almost everywhere on the set @xmath726 .",
    "the class of such `` admissible '' functions @xmath550 will be denoted by @xmath735 if the lipschitz constant @xmath124 is clear from the context , we omit the subscript @xmath124 for the constant @xmath727 . note that @xmath736 for @xmath737 by lemma [ l : bound_grad ] .          as explained in section [ outline ] , a large @xmath749 number implies that @xmath462 fluctuates locally .",
    "more precisely , proposition [ dreamprop ] will show that if @xmath750 for some @xmath751 and @xmath752 , then there exists another ball @xmath753 such @xmath754 , @xmath755 and @xmath756 . in section [ ss : wgl_cg ]",
    ", we use this to prove theorem [ t : cg - wgl ] .      before stating proposition [ dreamprop ] , we record a few lemmas .",
    "the first one gives an upper bound on how much @xmath757 can change as a function of @xmath728 .",
    "here and in the following , we employ the notation @xmath758 for the average of a function @xmath46 over a set @xmath201 in the plane .",
    "[ annuluscontrol ] assume that @xmath129 is an intrinsic lipschitz graph defined over @xmath32 , and that @xmath759 .",
    "further , let @xmath145 , and @xmath760 .",
    "then , @xmath761 where @xmath762 is the annulus @xmath763 .",
    "write @xmath764 and @xmath765 . in this proof , let @xmath766 for @xmath767",
    ". then , @xmath768 by the triangle inequality .",
    "next , we observe that @xmath769 \\cap \\gamma ) \\subset \\pi_{{\\mathbb{w}}}(a(x , s_{1},s_{2 } ) \\cap \\gamma)\\ ] ] by the injectivity of @xmath109 restricted to @xmath129 . finally , we use the fact that @xmath770 , recall lemma [ lipschitzlemma ] .          [",
    "l : a - small ] let @xmath771 be metric measure space . for any @xmath776 , there exists a constant @xmath777 with the following property : for any ball @xmath70 with @xmath778 and @xmath147 , there exists a radius @xmath779 $ ] such that @xmath780 has @xmath201-thin boundary .    for a fixed @xmath781 , let @xmath782 be the mapping @xmath783 , and",
    "consider the push - forward measure @xmath784 $ ] .",
    "let @xmath785 be the usual centred hardy - littlewood maximal operator on @xmath586 , namely @xmath786 we extend the definition from @xmath46 to @xmath787 in the obvious way .",
    "it is well - known ( see for instance ( * ? ? ?",
    "* theorem 2.19 ) ) that @xmath785 is weakly bounded in the sense that @xmath788 in particular , @xmath789 for @xmath790 large enough , this implies that there is some @xmath779 $ ] such that @xmath791 recalling the definition of @xmath787 this means precisely that @xmath792 for all such @xmath793 that @xmath794 .",
    "since @xmath795 , this covers all @xmath796 . for @xmath797 ,",
    "the thin boundaries condition is trivial .",
    "[ dreamprop ] for every @xmath189 and @xmath172 there exist constants @xmath798 and @xmath799 with the following property .",
    "assume that @xmath501 is an intrinsic @xmath124-lipschitz function with graph @xmath129 .",
    "assume that @xmath452 and @xmath147 are such that @xmath800 then , there exists a ball @xmath753 with @xmath201-thin boundary ( with respect to @xmath801 ) such that @xmath802 , @xmath754 , and @xmath803 in particular , @xmath804    [ remark0 ] observe that the last statement is an immediate consequence of @xmath226 being contained in the @xmath805-neighborhood of @xmath129 ; this implies that @xmath806 contains a set of the form @xmath807 with @xmath808 and @xmath809 .",
    "further , for such balls @xmath810 centred on @xmath129 , we can apply lemma [ eq : ball_inclusion ] to find @xmath811 for some @xmath812 .",
    "finally , @xmath813 with @xmath814 , recalling that the mapping @xmath815 , has unit jacobian for any @xmath101 , see .",
    "see also ( * ? ? ?",
    "* lemma 3.14 ) .",
    "* we formulate a counter assumption to the main claim in proposition [ dreamprop ] . assuming the validity of this assumption , we find @xmath816 and a sequence of intrinsic @xmath124-lipschitz functions @xmath817 and associated graphs @xmath818 , such that @xmath819 has large @xmath749 number in a ball @xmath820 centred on @xmath819 , yet @xmath821 does not fluctuate much in that ball .",
    "we use a blow - up procedure to normalize so that we may assume @xmath822 for all @xmath419 . *",
    "we show that a subsequence of @xmath817 converges locally uniformly to an intrinsic @xmath124-lipschitz function @xmath38 with graph @xmath129 such that , roughly speaking , + ( i ) @xmath823 is large , + ( ii ) @xmath824 is independent of @xmath825 , @xmath826 . *",
    "we show that the conditions ( i ) and ( ii ) are incompatible , which concludes the proof of proposition [ dreamprop ] .",
    "denote by @xmath827 the metric @xmath440-neighborhood of a set @xmath57 .",
    "given an intrinsic lipschitz graph @xmath129 , a ball @xmath70 with @xmath452 , and @xmath828 , define the following collection of `` good '' balls @xmath829 .",
    "a ball @xmath830 is in @xmath831 , if        [ eq : a ] for every @xmath189 , @xmath172 , there exists @xmath836 with the following property .",
    "if @xmath129 is any intrinsic @xmath124-lipschitz graph and @xmath70 is centred on @xmath129 with @xmath750 , then there exists a ball @xmath837 such that @xmath838      [ l : normalization ] if claim [ eq : a ] fails , then there there exist @xmath840 and @xmath172 such that for every @xmath828 we can find an intrinsic @xmath124-lipschitz graph @xmath841 , parametrised by @xmath842 such that @xmath843 yet @xmath844    by definition , if claim [ eq : a ] fails , then there exist @xmath189 and @xmath172 such that for every @xmath828 we can find an intrinsic @xmath124-lipschitz graph @xmath645 , parametrised by @xmath842 , and _ some ball _ @xmath845 centred on @xmath645 such that @xmath846 yet @xmath847      * is again an intrinsic @xmath124-lipschitz graph ( lemma [ l : transl ] ) , * has @xmath749-number at least @xmath55 on @xmath851 ( lemma [ l : beta ] below ) , * is parametrised by a function @xmath852 so that holds with @xmath853 in place of @xmath854 .",
    "( lemma [ l : average ] below ) .        according to lemma [ l : transl ] and remark [ remk : para ] there exists a uniquely defined intrinsic lipschitz function @xmath857 that parametrizes @xmath858 . by definition ,",
    "@xmath859 we first aim to prove that the family @xmath860 is in @xmath25-to-@xmath25 correspondence with the family @xmath861 .",
    "assume that @xmath744 .",
    "define @xmath862 and note that @xmath863 in the notation of lemma [ l : transl ] .",
    "let us prove that @xmath864 . to this end , we observe first that @xmath865 see for instance ( * ? ? ?",
    "* proposition 2.15 ) . by homogeneity and left invariance of the distance @xmath75 , it follows that @xmath866 and @xmath867 lemma [ l : transl ] then implies that @xmath864 .",
    "[ l : average ] assume that @xmath157 is an intrinsic lipschitz function with graph @xmath129 , @xmath45 is a point on @xmath129 , and @xmath198 .",
    "then @xmath871 and @xmath872 here @xmath873 is the graph parametrized by @xmath857 ( defined as in ) .",
    "we start with the first claim .",
    "since the heisenberg distance is left invariant with respect to the group law , and homogeneous with respect to the dilations @xmath874 , if a ball @xmath834 has @xmath201-thin boundary , then so does the ball @xmath875 .",
    "the remaining conditions that one has to verify in order to prove are also immediate .",
    "regarding , we first recall that lemma [ l : transl ] yields that @xmath876 since @xmath877 restricted to @xmath32 has jacobian determinant constant equal to @xmath878 , and @xmath879 has jacobian determinant equal to @xmath25 , it follows by the usual transformation formula for functions on @xmath91 that @xmath880 and @xmath881 this establishes .      in this section , we work under the standing ( counter ) assumption to proposition [ dreamprop ] .",
    "in particular , we may assume by lemma [ l : normalization ] that there exists @xmath882 and a sequence @xmath883 of intrinsic @xmath124-lipschitz functions with graphs @xmath818 such that @xmath884 , yet the intrinsic gradient @xmath821 fluctuates only little in @xmath885 as quantified in .",
    "[ eq : limit_beta ] the sequence @xmath817 defined above contains a subsequence that converges locally uniformly on @xmath32 to an intrinsic @xmath124-lipschitz function @xmath157 with graph @xmath129 such that @xmath887    since each graph @xmath645 by construction contains the origin , we have @xmath888 for every @xmath419 . therefore [ intrili2 ] implies that the family @xmath889 is locally equibounded .",
    "hence , by proposition 3.10 in @xcite , there exists a subsequence which converges locally uniformly to an intrinsic @xmath124-lipschitz function @xmath38 on @xmath32 with intrinsic graph @xmath129 . for simplicity",
    ", we also denote this subsequence by @xmath883 .",
    "let @xmath890 .",
    "in order to prove that @xmath891 , it suffices to fix @xmath892 and find a point @xmath893 with @xmath894 . to this end",
    ", the assumption @xmath895 implies that , for each @xmath828 , there exists a point @xmath896 such that @xmath897 write @xmath898 . the sequence @xmath899 has a subsequence @xmath900 convergent to a point @xmath901 .",
    "since @xmath109 is continuous , the points @xmath902 converge to @xmath903 .",
    "finally , @xmath904 by the continuity of @xmath550 , and the locally uniform convergence @xmath905 .",
    "the proof is complete .    without loss of generality , we assume in the following that the whole sequence @xmath889 converges locally uniformly to @xmath38 .",
    "our next goal is to prove the following convergence result for the corresponding intrinsic gradients .",
    "[ l : conv_grad ] let @xmath906 be a sequence of intrinsic @xmath124-lipschitz functions converging locally uniformly to an @xmath124-lipschitz function @xmath157 .",
    "then @xmath907 for all balls @xmath908 with @xmath826 , and such that @xmath909 .",
    "the subtle point here is , of course , that the domain of integration is different on both sides of the above equation .",
    "therefore the following auxiliary result will be useful in the proof of lemma [ l : conv_grad ] .",
    "[ annuluscontrol2 ] assume that @xmath645 is a sequence of intrinsic @xmath124-lipschitz graphs , which converges locally in the hausdorff metric in @xmath0 to an intrinsic lipschitz graph @xmath129 .",
    "then , for any @xmath452 and @xmath910 , we have @xmath911    fix @xmath890 .",
    "first , pick @xmath912 and @xmath913 so that @xmath914 then , let @xmath189 be so small that if @xmath915 , then @xmath916 .",
    "let @xmath917 be an @xmath55-net in @xmath918 , and , finally , let @xmath919 be the subset of points @xmath226 in this net with the property that @xmath920 contains a point in @xmath921 .",
    "then @xmath922 by the @xmath2-regularity of intrinsic @xmath124-lipschitz graphs .",
    "for @xmath419 large enough , every ball @xmath923 with @xmath924 also contains a point in @xmath129 , whence @xmath925 , @xmath924 .",
    "since the balls @xmath926 have bounded overlap ( independent of @xmath189 ) , we conclude that @xmath927 for all large enough @xmath419 .",
    "this completes the proof .",
    "we employ the fact proven in ( * ? ? ?",
    "* proposition 4.7 ) that the intrinsic gradient is also a distributional gradient for intrinsic lipschitz functions : if @xmath38 is intrinsic lipschitz and defined on @xmath32 , then @xmath928 \\psi \\ , d{\\mathcal{l}}^{2}\\ ] ] for all compactly supported @xmath471-functions @xmath550 on @xmath32 ( here we assume that @xmath32 is the @xmath33-plane , as we may ) . since uniform convergence implies weak convergence , we infer that @xmath929 \\psi \\ , d{\\mathcal{l}}^{2 } = \\lim_{j \\to \\infty } \\int_{{\\mathbb{w } } } [ \\nabla^{\\phi_{j}}\\phi_{j } ] \\psi \\ , d{\\mathcal{l}}^{2}\\ ] ] for all compactly supported @xmath471 functions @xmath930 .",
    "it remains to deduce from this statement the claim .    to achieve this",
    ", we recall from lemma [ l : bound_grad ] that @xmath931 then , given @xmath908 with @xmath826 , for @xmath331 , choose an open set @xmath932 in @xmath933 so that @xmath934 and @xmath935 .",
    "in particular , @xmath936 for all test functions @xmath550 with @xmath937 and all @xmath938 .",
    "now , let @xmath550 be a smooth cut - off function with compact support in @xmath932 , @xmath937 on @xmath932 and such that @xmath939 on @xmath940 .",
    "then , by , there exists @xmath941 such that for @xmath942 , one has @xmath943 let us denote @xmath944 . combining and , and recalling that @xmath550 is supported on @xmath932 , we find that @xmath945 for @xmath942 .",
    "this yields @xmath946    to establish , it remains to show that @xmath129 on the right hand side of the above equation can be replaced by @xmath819 .",
    "this follows immediately from the uniform bound for @xmath514 and @xmath821 , see , provided we can show the following : @xmath947 we now prove .",
    "here we need to assume that @xmath909 . since @xmath948 there exists for every @xmath169 a number @xmath949 such that @xmath950 let @xmath951 be such and observe that @xmath952 and @xmath953 for @xmath419 larger than some @xmath954 given by uniform convergence .",
    "so @xmath955 for @xmath956 .",
    "since @xmath957 by the general inequality @xmath958 ( lemma [ lipschitzlemma ] ) and by , we infer that @xmath959 as @xmath960 .",
    "it remains to prove the same with the roles of @xmath129 and @xmath645 reversed . repeating the argument above",
    ", it suffices to estimate the measure of the projection @xmath961 .",
    "this is not altogether trivial , since the assumption on @xmath962 concerns @xmath963 , not @xmath964 .",
    "however , lemma [ annuluscontrol2 ] still implies that @xmath965 which proves that @xmath966 since @xmath890 is arbitrary , , and hence also , follows .",
    "this concludes the proof of lemma [ l : conv_grad ] .",
    "we now return to the specific sequence @xmath883 and limit function @xmath38 ( with graph @xmath129 ) given by lemma [ eq : limit_beta ] .",
    "in particular , we work under the standing assumptions that @xmath967 and @xmath821 fluctuates only little on @xmath968 , as made precise in lemma [ l : normalization ] .",
    "pick two balls @xmath973 and @xmath974 with @xmath975 satisfying the assumption stated in the lemma , and let @xmath976 be arbitrary .",
    "our goal is to show that @xmath977 we start by applying the triangle inequality : @xmath978 where @xmath979 to see that @xmath980 for large enough @xmath419 , writing temporarily @xmath766 for @xmath767 , and @xmath981 we perform the following estimate : @xmath982 the same is true with `` 1 '' replaced by `` 2 '' . by and , and the uniform bound @xmath983 , both terms above tend to zero as @xmath960 .",
    "so , it suffices to deal with @xmath984 .",
    "we first make the subsequent estimate for certain @xmath985 and @xmath986 to be fixed soon : @xmath987 where @xmath988 it follows from the key ( counter ) assumption that @xmath989 if the balls @xmath990 and @xmath991 belong to @xmath992 .",
    "this requires that      condition ( a ) is automatically satisfied for large enough @xmath419 , since @xmath998 .",
    "condition ( b ) is also trivially satisfied for large enough @xmath419 , since @xmath985 and @xmath986 . to achieve condition ( c ) , fix an auxiliary parameter @xmath999 , which will depend on @xmath1000 and @xmath124",
    "then , for large enough @xmath419 , lemma [ l : a - small ] guarantees the existence of @xmath1001 $ ] and @xmath1002 $ ] such that ( c ) is satisfied for @xmath990 and @xmath991 .",
    "we choose @xmath1003 accordingly , and then @xmath1004 ( for @xmath1005 ) .",
    "it remains to estimate @xmath1006 and @xmath1007 ; by symmetry , we may concentrate on @xmath1006 .",
    "recalling lemma [ annuluscontrol ] , we first have @xmath1008 since @xmath1009 , and @xmath1010 , see remark [ remark0 ] .",
    "lemma [ annuluscontrol2 ] then tells us that @xmath1011 and now we choose @xmath1012 so small that the right hand side above is smaller than @xmath1013 for some small constant @xmath1014 depending only on @xmath124 , and the same holds with `` @xmath25 '' replaced by `` @xmath92 '' .",
    "if @xmath1014 is small enough , this implies that @xmath1015 .    combining the estimates for @xmath1016 and @xmath1017 above ,",
    "we conclude that @xmath1018 since @xmath890 was arbitrary , this proves that @xmath1019 is independent of the ball @xmath908 with @xmath1020 and satisfying @xmath1021 .      in this section ,",
    "we conclude the proof of proposition [ dreamprop ] . under the standing counter assumption derived in lemma [ l : normalization ]",
    ", we will infer from lemma [ l : a.s.const ] that @xmath462 is a.e .",
    "constant on @xmath1022 .",
    "this will contradict the conclusion of lemma [ eq : limit_beta ] , which gave @xmath891 .",
    "recall that we have shown in lemma [ l : a.s.const ] that the averages of @xmath514 are the same for a large class of sets in @xmath32 . in order to conclude that then @xmath514 must be constant almost everywhere on @xmath1024 , and in particular on @xmath1025",
    ", we apply a lebesgue differentiation theorem for the measure space @xmath1026 endowed with the _ graph distance _ @xmath1027 .",
    "the latter can be defined for an arbitrary intrinsic lipschitz function @xmath1028 with graph @xmath129 by setting @xmath1029      we apply this theorem for @xmath1033 .",
    "more precisely , we choose for every lebesgue point @xmath497 of @xmath1034 a sequence of radii @xmath1035 such that @xmath1036 and @xmath1037 for @xmath1038 . then we apply to conclude that @xmath1039 without loss of generality we may assume here that @xmath497 has been chosen so that the pointwise intrinsic gradient @xmath514 exists in @xmath497 .",
    "finally , it follows immediately from the definition of the graph distance that @xmath1040 for all @xmath226 on the graph of @xmath38 and @xmath1041 , and hence the claim of the lemma follows from and lemma [ l : a.s.const ] .    according to remark [ remark0 ]",
    ", it suffices prove .",
    "assume that this is not true .",
    "then , by lemma [ eq : limit_beta ] and lemma [ l : constancy ] , there exists an intrinsic lipschitz function @xmath501 with graph @xmath129 such that @xmath1042 this contradiction proves proposition [ dreamprop ] .      in this section",
    ", we apply proposition [ dreamprop ] to prove the weak geometric lemma for the @xmath749-numbers , theorem [ t : cg - wgl ] . in brief , if the integral appearing in theorem [ t : cg - wgl ] is large , then we can find many balls centered on the graph @xmath129 with large @xmath749-number ( this is quantified in lemma [ discretisation ] ) . then , proposition [ dreamprop ] implies that @xmath514 fluctuates strongly inside ( the projections of ) such balls , which can be used to find a lower bound for @xmath1043 with @xmath1044 and @xmath190 .",
    "since we also have the upper bound @xmath1045 for this quantity , we will eventually find the correct upper bound for the integral in theorem [ t : cg - wgl ] .",
    "a collection @xmath1046 of balls in a metric space @xmath1047 is _ pre - dyadic _ , if @xmath1048 for any @xmath1049 .",
    "a collection of balls ( or sets in general ) in @xmath1047 is _ dyadic _ , if for every pair of sets @xmath1050 in the family , either @xmath1051 , or @xmath1052 , or @xmath1053 .",
    "[ discretisation ] let @xmath129 be an intrinsic lipschitz graph , and let @xmath452 , @xmath450 .",
    "write @xmath1054 then , there exists a pre - dyadic family of balls @xmath1055 with @xmath1056 such that @xmath1057 for every @xmath1058 , every ball @xmath1059 has @xmath1060-thin boundary with respect to @xmath801 for some @xmath1061 , and @xmath1062    write @xmath1063 . for @xmath1064 ,",
    "let @xmath1065\\}.\\ ] ] let @xmath1066 be a maximal @xmath1067-separated subset , and for each @xmath1068 , choose a radius @xmath1069 $ ] such that @xmath1070 .",
    "then , any pair of balls @xmath1071 with distinct @xmath1072 is disjoint .",
    "further , since the sets @xmath1073 with @xmath1068 cover @xmath1074 , we have @xmath1075 next , observe that for any @xmath1076 , we have @xmath1077 since the left hand side is always bounded by @xmath1078 , and it is evidently zero for @xmath1079 .",
    "it follows that @xmath1080 and consequently @xmath1081 next , observe that if @xmath1082 and @xmath1083 $ ] , then @xmath1084 .",
    "then , for every ball @xmath1085 , apply lemma [ l : a - small ] with @xmath1086 and @xmath1087 to find a radius @xmath1088 $ ] such that @xmath1089 has @xmath1090-thin boundary with respect to @xmath801 , and @xmath1091 .",
    "then the @xmath2-regularity of @xmath129 implies that holds for the balls @xmath1089 as well .",
    "finally , since the balls @xmath1089 with @xmath226 in a fixed set @xmath1092 are disjoint , the collection @xmath1093 is pre - dyadic . indeed ,",
    "if @xmath145 , @xmath1049 and @xmath147 are given , there are clearly at most @xmath1094 indices @xmath419 such that @xmath1095 and @xmath1096 for some @xmath1068 .",
    "the proof is complete .",
    "[ predyadic ] let @xmath771 be a metric measure space , and let @xmath890 and @xmath1097 .",
    "assume that @xmath1098 is a pre - dyadic family of balls with @xmath1099 , and with @xmath1100 .",
    "moreover , assume that every ball @xmath1101 contains a ( possibly empty ) family of disjoint sub - balls @xmath1102 such that that @xmath1103 for @xmath1104 .",
    "finally , assume that all the balls @xmath1105 in the families @xmath1098 and @xmath1102 , @xmath1101 , have @xmath201-thin boundary , and the balls @xmath1101 have the doubling property @xmath1106 then , there exists a dyadic sub - collection @xmath1107 such that      split the balls in @xmath1098 into families @xmath1113 , where @xmath1114 . by the assumption of the family @xmath1098 being pre - dyadic , and the doubling property of the balls @xmath1101 , we can ( by applying the @xmath1115-covering lemma to the balls in @xmath1116 ) choose a subfamily of @xmath1116 * disjoint * balls ( still denoted by @xmath1116 ) with @xmath1117 next , observe that either @xmath1118 we assume that the former option holds , and from now on we will only consider balls @xmath1119 , @xmath207 .",
    "note that if @xmath1120 , @xmath1121 , @xmath1122 and @xmath1123 , then @xmath1124 recalling that @xmath1125 .",
    "since @xmath1099 , the collection @xmath1126 is empty for large enough @xmath419 .",
    "let @xmath1127 be the index of the largest non - empty collection @xmath1128 , and set @xmath1129 inductively , for @xmath1130 , let @xmath1131 be the collection of balls in @xmath1126 , which meet the boundary of one of the balls in @xmath1132 , let @xmath1133 and finally @xmath1134 note that if @xmath1135 , @xmath1130 , then there is some ball @xmath1136 such that @xmath1137 ( the second inclusion follows from ) .",
    "consequently , by the disjointness of the balls in @xmath1138 , and the @xmath201-thinness of boundaries of the balls in @xmath1139 , we infer that @xmath1140 finally , since every ball in @xmath1126 either belongs to one of the collections @xmath1131 , with @xmath1130 , or to @xmath1141 , we have @xmath1142 \\notag\\\\ & \\lesssim a\\sum_{j \\leq j_{0 } } \\left [ \\sum_{j <",
    "i \\leq j_{0 } } 2^{j - i } \\sum_{b ' \\in { \\mathcal{g}}_{i } } \\mu(b ' ) + \\sum_{b \\in { \\mathcal{g}}_{j } } \\mu(b ) \\right ] \\notag\\\\ & \\label{form13 } \\sim a\\sum_{j \\leq j_{0 } } \\sum_{b \\in { \\mathcal{g}}_{j } } \\mu(b ) .",
    "\\end{aligned}\\ ] ] define @xmath1143 inspecting the definition of @xmath831 , it is clear that @xmath335 can indeed be written as @xmath1144 for a certain sub - collection @xmath1107 .",
    "since @xmath1145 for all balls @xmath1146 , we infer from that @xmath1147 , as required by condition ( i ) .",
    "the fact that @xmath1148 is a dyadic family of balls follows immediately from the inductive definition .",
    "in fact , the construction shows that even the family @xmath335 is dyadic , and this combined with implies condition ( ii ) .",
    "the proof is complete .      during the proof , we will abbreviate @xmath1149 and @xmath1150 to simply @xmath1151 and @xmath1152 .",
    "we apply lemma [ discretisation ] to infer that if @xmath1153 then there exists a pre - dyadic family of balls @xmath1148 , contained in @xmath1154 and centred on @xmath129 , with @xmath1155-thin boundaries , with @xmath1156 , and such that @xmath1157 for each such ball @xmath1158 , we use proposition [ dreamprop ] to find another ball @xmath1159 with @xmath1160-thin boundary , such that @xmath1161 , @xmath1162 and @xmath1163    note that every ball in the family @xmath1164 has @xmath1165-thin boundary . hence , using lemma [ predyadic ] on the metric space @xmath1166 , with @xmath1167 and @xmath1168 , we find a dyadic sub - collection @xmath1169 , which still satisfies @xmath1170 . to avoid the double indices",
    ", we assume that the family @xmath1171 is dyadic itself . since @xmath109 is injective on @xmath129 , it follows that the family @xmath1172 with @xmath1173 and @xmath1174 is also dyadic .",
    "moreover , by ( ii ) of lemma [ predyadic ] , the family @xmath1172 even satisfies slightly more , namely if @xmath1110 , then @xmath1175    holding that thought , we now make some remarks of more abstract nature . given two sets @xmath1176 with @xmath1177 ,",
    "let @xmath1178 be the subspace of @xmath1179 consisting of those functions which are zero outside @xmath59 , are constant on both @xmath1180 and @xmath201 , and have integral zero .",
    "let @xmath1181 be the orthogonal projection onto this subspace .",
    "finding an explicit formula for @xmath1182 is simple , as @xmath1178 is one - dimensional , and spanned by the unit vector @xmath1183 here , and for the rest of the proof , we write @xmath1184 for @xmath767 .",
    "it follows that @xmath1185 , and in particular @xmath1186    we apply these observations to the subspaces @xmath1187 with the family @xmath1172 defined above . since this family is dyadic and satisfies , it is easy to check that the subspaces @xmath1187 are pairwise orthogonal .",
    "now , let @xmath1188 and recall that @xmath1189 .",
    "since @xmath1190 for all @xmath828 , it follows from bessel s inequality , , , and ( in this order ) that @xmath1191 \\\\ & \\gtrsim \\delta_{\\varepsilon , l}^{2 } \\sum_{j } |a^{j}| \\sim \\delta_{\\varepsilon , l}^{2 } \\sum_{j } { \\operatorname{diam}}(b_{j})^{3 } \\gtrsim \\delta_{\\varepsilon , l}^{2 } c. \\end{aligned}\\ ] ] recalling the definition of @xmath163 from , this completes the proof of theorem [ t : cg - wgl ] .",
    "armed with theorem [ t : cg - wgl ] , we are nearly ready to prove the wgl for intrinsic lipschitz graphs ( theorem [ wglintlg ] ) .",
    "first , we need a few short lemmas .",
    "the first one states that any intrinsic lipschitz graph @xmath129 has a `` big flat piece '' inside any ball @xmath70 with @xmath452 :    [ bigflatpiece ] for every @xmath189 and @xmath172 , there exists @xmath1192 with the following property .",
    "if @xmath129 is an intrinsic @xmath124-lipschitz graph , @xmath452 and @xmath147 , then there exists a ball @xmath753 with @xmath1193 and @xmath802 such that @xmath1194 .    the proof is based on the compactness of intrinsic @xmath124-lipschitz graphs , and the existence of tangent subgroups .",
    "we make a counter assumption that there exist @xmath189 and @xmath172 with the following properties . for every @xmath828 , there exists an intrinsic lipschitz graph @xmath1195 , and a ball @xmath845 with @xmath1196 such that @xmath1197 for all balls @xmath1198 with @xmath1020 and @xmath833 . without loss of generality ( or recalling a similar reduction from the previous section ) , we may assume that @xmath1199 , and @xmath1200 for all @xmath1201 .",
    "further , by the compactness results for intrinsic @xmath124-lipschitz functions , already employed in the previous section , we may assume without loss of generality that the functions @xmath854 converge locally uniformly to an intrinsic @xmath124-lipschitz function @xmath501 with graph @xmath129 .",
    "one can then easily check ( emulating the argument for lemma [ eq : limit_beta ] ) that @xmath1202 for any ball @xmath908 with @xmath1203 .",
    "but this is absurd : the function @xmath38 is intrinsically differentiable at almost every point of @xmath1204 , which means precisely that @xmath78-almost every point @xmath1203 has a vertical tangent subgroup to @xmath129 ( theorem 4.15 in @xcite ) .",
    "we record that a subgroup @xmath1205 is a tangent group to @xmath129 in @xmath1206 if @xmath1207 with respect to the hausdorff convergence of compact subsets of @xmath0 .",
    "but this is evidently impossible for such @xmath1203 that @xmath1208 for all sufficiently small @xmath1209 .",
    "all the points @xmath1210 have this property by the previous discussion , and we have reached a contradiction .",
    "recall that the graph of an entire intrinsic lipschitz function @xmath157 with constant gradient almost everywhere is a left translate of a vertical plane ( proposition [ constantgradientgraphs ] ) .",
    "the next lemma , essentially a corollary of this fact , gives a substantial improvement over the previous lemma for constant gradient graphs .",
    "[ stability0 ] for every @xmath189 and @xmath172 , there exists @xmath799 with the following property .",
    "assume that @xmath1211 is an intrinsic @xmath124-lipschitz graph , and @xmath452 , @xmath147 are such that @xmath1212 .",
    "then , if @xmath1020 , @xmath1213 , and @xmath1214 , we have @xmath1215    we make a counter assumption : there exist @xmath189 and @xmath172 such that the following holds for every @xmath1216 , @xmath828 .",
    "there exists an intrinsic @xmath124-lipschitz graph @xmath1217 and two balls @xmath1218 with @xmath1219 , such that @xmath1220 we may assume that @xmath1221 .",
    "thus , @xmath1222 and @xmath1223 , and @xmath1224 for a certain point @xmath1225 .",
    "the assumption @xmath1226 implies that the balls @xmath1227)$ ] eventually cover any ball @xmath1228 , @xmath450 .",
    "we infer that a subsequence of the functions @xmath854 converge locally uniformly to an intrinsic @xmath124-lipschitz function @xmath1229 , which has a.e .",
    "constant gradient on @xmath1230 , and such that @xmath1231 ( here @xmath1232 is the graph of @xmath1233 ) . finally , using a diagonal procedure , a further subsequence of the functions @xmath854 converges locally uniformly to an intrinsic @xmath124-lipschitz function @xmath38 , which has a.e .",
    "constant gradient on @xmath32 , and @xmath1234 .",
    "but the existence of such a @xmath38 was ruled out in proposition [ constantgradientgraphs ] , and we have reached a contradiction .",
    "the proof of the lemma is complete .",
    "let @xmath129 be an intrinsic lipschitz graph , and let @xmath236 be a system of david cubes on @xmath129 ; recall that every cube @xmath1235 contains a set of the form @xmath1236 for some point @xmath215 and some constant @xmath1237 . in this section , where our task is to prove the weak geometric lemma for intrinsic @xmath124-lipschitz graphs , we write @xmath1238 where @xmath1239 is a constant depending on @xmath124 only .",
    "the precise requirement for @xmath163 is that @xmath1240 , where @xmath1241 is the constant from the definition of @xmath1242 . with this notation for @xmath247",
    ", we still write @xmath1243 , and @xmath1244 .",
    "the reason for choosing @xmath1245 so large is the following : if @xmath1246 with @xmath1247 , and @xmath890 is any constant , then @xmath1248 as soon as @xmath1249 .",
    "this is easy to check : if @xmath1249 and @xmath1250 , then @xmath1251 we also mention that @xmath1252 implies @xmath1253 which is verified in the similar manner as above . in this section ,",
    "we abbreviate @xmath1254 .",
    "we choose to prove the weak geometric lemma in the following form : for any fixed cube @xmath221 , @xmath1255 where @xmath1256 ; the integral formulation is an easy corollary . to this end",
    ", we note that the following inequality is a simple consequence ( essentially a reformulation ) of theorem [ t : cg - wgl ] : @xmath1257 where @xmath1258 .",
    "let @xmath1259 be a constant , which will depend only on @xmath55 and @xmath124 .",
    "now , by , the weak geometric lemma will follow , if we are able to prove that @xmath1260 the following corollary of lemma [ stability0 ] will be crucial :    [ stability2 ] for every @xmath189 and @xmath172 , there exists @xmath1261 with the following property .",
    "assume that @xmath1246 are cubes such that @xmath1247 , @xmath1262 , and @xmath1263 for all @xmath1264 with @xmath1265",
    ". then @xmath1266 .",
    "write @xmath1267 , where @xmath1268 is the constant from lemma [ stability0 ] .",
    "write @xmath1269 for the @xmath1270",
    "dyadic ancestor of @xmath248 , with @xmath1271 .",
    "let @xmath1272 be a large number depending on @xmath55 and @xmath124 ; we will eventually pick @xmath1273 first , and then require that @xmath1274 is sufficiently small depending on @xmath1273 . if @xmath1275 for some @xmath1276 , we have @xmath1277 assuming @xmath1278 .",
    "this is the first restriction we place on @xmath1274 .    now , assume that @xmath1275 for some @xmath1279 .",
    "it follows that @xmath1280 satisfies @xmath1265 , hence @xmath1281 . recalling remark [ remk : bcg ]",
    "this means that there exists an intrinsic @xmath124-lipschitz function @xmath1282 with graph @xmath1283 such that @xmath550 has a.e .",
    "constant gradient on @xmath1284 , and @xmath1285 let @xmath1286 be the nearest points to @xmath1287 on @xmath1283 , so that @xmath1288 write @xmath1289 , and observe that @xmath1290 for @xmath1274 small enough . then , write @xmath1291 , and observe that gives the following chain of inclusions , assuming @xmath1292 to be large enough , and @xmath1293 to be small enough : @xmath1294 from we first conclude that @xmath550 has a.e.constant gradient on @xmath1295 , which means that @xmath1296 then , from we infer that lemma [ stability0 ] is applicable to the ball @xmath1297 .",
    "consequently , @xmath1298 thus , there exists a set of the form @xmath51 , where @xmath1299 and @xmath53 is a vertical subgroup , such that @xmath1300 for every @xmath1301 . finally , recalling that we wish to prove @xmath1302 , we fix @xmath1303 by we can pick @xmath1304 with @xmath1305 .",
    "then , for @xmath1259 small enough , we have @xmath1301 , and @xmath1306 .",
    "this proves that @xmath1302 , as required .",
    "let @xmath1312 be a constant depending only on @xmath124 , and let @xmath1313 .",
    "by lemma [ bigflatpiece ] applied to the ball @xmath1314 with @xmath1315 , there exists a point @xmath1316 and a radius @xmath1317 such that @xmath1318 and @xmath1194 .",
    "now , it suffices to note that @xmath971 contains a ball of the form @xmath247 for some @xmath1247 with @xmath1319 .",
    "hence @xmath1320 .",
    "choosing @xmath1321 small enough , the lemma follows .",
    "we are prepared to prove the weak geometric lemma .",
    "as discussed , it remains to verify .",
    "the proof is nearly verbatim the same as on the last pages of @xcite , but we record the details for completeness .",
    "* @xmath1325 has a maximal element @xmath1326 , called the _ root _ of @xmath1325 . * if @xmath1327 with @xmath212 , and @xmath1328 , then also @xmath1329 . * if @xmath1330 , then either all , or none , of the children of @xmath248 belong to @xmath1325 . *",
    "those cubes @xmath1330 with no children in @xmath1325 are called the _ stopping cubes _ of @xmath1325 , and they are denoted by @xmath1331 .",
    "we now partition @xmath1323 into trees by an inductive procedure .",
    "the roots of the initial trees are simply the maximal cubes in @xmath1323 .",
    "then , if @xmath1332 is one of these trees , and @xmath1333 , we add all the children of @xmath248 into @xmath1332 if all of them belong to @xmath1323 ; if not , we declare that @xmath1334 and stop building @xmath1325 along this branch .    after the initial trees have been constructed , and in case some cubes in @xmath1323 still remain outside them , we repeat the previous procedure : we pick the maximal cubes in @xmath1323 , which are not , yet , contained in a tree , and we declare these to be the roots of new trees .",
    "these trees are , then , constructed by the rule described above .",
    "iterating this algorithm produces a partition of @xmath1323 into a countable number of trees @xmath1335 .",
    "if @xmath1336 for some ( unique ) @xmath1337 , we set @xmath1338 . in the opposite case , @xmath1339 , it follows from the construction that either the parent or one of the siblings of @xmath1340 , say @xmath1341 is in @xmath1342 . in this case , we set @xmath1343 .    with this notation in hand , and observing that any cube @xmath1341 can only serve as @xmath1344 for boundedly many indices @xmath1058 , we are prepared to show that the roots @xmath1340 satisfy a carleson property : @xmath1345 the last inequality is , of course , .",
    "next , recalling our objective , and writing @xmath1346 , we make the following natural splitting : @xmath1347 by , it remains to prove that @xmath1348 for any fixed @xmath1058 . to this end , let @xmath1349 be the family of maximal cubes @xmath1350 with the property that @xmath1351 . by corollary [ stability2 ] , if @xmath1352 is contained in a cube in @xmath1349 , then @xmath1353 , and hence @xmath1354 .",
    "so , in fact the summation in runs over at most those cubes which are not contained in any cube in @xmath1349 ; let those cubes be called @xmath1355 .",
    "fix @xmath1356 , and let @xmath1309 be the maximal cube with the property that @xmath1311 .",
    "lemma [ bigflatcube ] promises that there exists such a cube @xmath248 with @xmath1357 .",
    "if @xmath1350 , then obviously @xmath1358 , and we set @xmath1359 . if , on the other hand , @xmath248 already lies outside @xmath1360 , then there is some cube @xmath1361 with @xmath1362 , and we set @xmath1363 . in either case latexmath:[$|f(r)| \\gtrsim_{\\eta , l }    @xmath1349 and @xmath1365 consist of disjoint cubes , and that each cube @xmath1366 can only be assigned as @xmath1367 for boundedly many cubes @xmath1368 ( with bounds depending only on @xmath1369 ) , we may conclude that @xmath1370 since @xmath1261 only depends on @xmath55 and @xmath124 , we have proven , and the weak geometric lemma ( theorem [ wglintlg ] ) for intrinsic lipschitz graphs .",
    "we will conclude the paper with a brief discussion of theorem [ wglbp ] .",
    "the analogous result in the euclidean setting is due to david and semmes and it follows by theorem 1.8 ( * ? ? ?",
    "* part iv , chapter 1 ) . before restating it in our setting ,",
    "we record a definition .",
    "let @xmath1371 and @xmath1372 { \\rightarrow}(0,\\infty)$ ] .",
    "we define @xmath1373 to be the collection of @xmath2-regular sets",
    "@xmath56 with regularity constant at most @xmath1374 such that @xmath1375 for @xmath189 , @xmath449 and @xmath450 .      [ ds18heis ]",
    "let @xmath56 be a @xmath2-regular set .",
    "suppose that there exist @xmath1376 and @xmath1372 { \\rightarrow}(0,\\infty)$ ] such that for each @xmath449 and @xmath170 there exists @xmath1377 satisfying @xmath1378 then @xmath57 satisfies the wgl .",
    "as it happens , the proof of theorem [ ds18heis ] follows exactly as the proof of theorem 1.8 ( * ? ? ?",
    "* part iv , chapter 1 ) , modulo notational changes .",
    "therefore we skip the details .",
    "now observe that theorem [ wglbp ] follows from theorem [ wglintlg ] and theorem [ ds18heis ] , since the @xmath2-regularity and wgl constants ( for any fixed @xmath189 ) of an intrinsic @xmath124-lipschitz graph are bounded above by a constants depending only on @xmath55 and @xmath124 .",
    "l. ambrosio , f. serra cassano , d. vittone : _ intrinsic regular hypersurfaces in heisenberg groups _ , j. geom .",
    "16 * ( 2 ) ( 2006 ) , 187232 g. arena and r. serapioni : _ intrinsic regular submanifolds in heisenberg groups are differentiable graphs _ , calc .",
    "* 35 * ( 4 ) ( 2009 ) , 517  536 z. m. balogh , e. durand cartagena , k. fssler , p. mattila and j. t. tyson : _ the effect of projections on dimension in the heisenberg group _ , rev . mat",
    ". iberoam .",
    "* 29 * ( 2013 ) , no .",
    "2 , 381432 f. bigolin : _ intrinsic regular hypersurfaces in heisenberg groups and weak solutions of non linear first - order pdes _ , phd thesis , trento , ( 2009 ) f. bigolin , l. caravenna and f. serra cassano : _ intrinsic lipschitz graphs in heisenberg groups and continuous solutions of a balance equation _ , ann . inst .",
    "h. poincar anal .",
    "non linaire * 32 * ( 5 ) ( 2015 ) , 925963 f. bigolin and f. serra cassano : _ distributional solutions of burgers equation and intrinsic regular graphs in heisenberg groups _ , j. math .",
    "appl . , * 366 * ( 2 ) ( 2010 ) , 561568 a. bonfiglioli , e. lanconelli and f. uguzzoni : _ stratified lie groups and potential theory for their sub - laplacians _ , springer monographs in mathematics 2007 l. capogna , d. danielli , s.d . pauls and j. tyson : _ an introduction to the heisenberg group and the sub - riemannian isoperimetric problem _ , progress in mathematics ( 2007 ) , birkhuser      v. chousionis , v. magnani and j. t. tyson _ removable sets for lipschitz harmonic functions on carnot groups _ ,",
    "* 53 * ( 2015 ) , no . 3 - 4 , 755780 g. citti , m. manfredini , a. pinamonti and f. serra cassano : _ smooth approximation for intrinsic lipschitz functions in the heisenberg group _ ,",
    "pde * 49 * ( 3 ) ( 2014 ) , 12791308 g. david : _ morceaux de graphes lipschitziennes et intgrales singulires sur un surface _ , rev . mat .",
    "iberoamericana * 4 * ( 1988 ) , 73114      g. david : _",
    "unrectifiable @xmath25-sets have vanishing analytic capacity_. rev . mat .",
    "iberoamericana * 14 * ( 1998 ) , no .",
    "2 , 369479 : _ removable sets for lipschitz harmonic functions in the plane_. rev .  mat .",
    "iberoamericana * 16 * , ( 2000 ) , no .",
    "1 , 137215    g. david and s. semmes : _ quantitative rectifiability and lipschitz mappings _ , trans .",
    "* 337 * ( 2 ) ( 1993 ) , 855889 g. david and s. semmes : _ analysis of and on uniformly rectifiable sets .",
    "_ in : mathematical surveys and monographs 38 , amer .",
    "soc . , providence , ri ( 1993 ) g. david and s. semmes : _ singular integrals and rectifiable sets in @xmath1379 : beyond lipschitz graphs .",
    "_ astrisque * 193 * , 152 pp .",
    "( 1991 ) v. eiderman and a. volberg _ non - homogeneous harmonic analysis : 16 years of development _ , russ .",
    "surv . * 68 * 973 , ( 2013 ) l. erds : _ notes on the burgers equation _ , available at https://www.mathematik.uni-muenchen.de/  lerdos / ss06/pde / burg.pdf f. ferrari , b. franchi , and h. pajot : _ the geometric traveling salesman problem in the heisenberg group _ rev . mat . iberoam .",
    "* 23 * ( 2007 ) , no .",
    "2 , 437480 a. f. filippov : _ differential equations with discontinuous righthand sides : control systems _ , springer 1988 b. franchi , m. marchi and r. serapioni : _ differentiability and approximate differentiability for intrinsic lipschitz functions in carnot groups and a rademacher theorem _ , anal . geom .",
    "spaces * 2 * ( 1 ) ( 2014 ) , 22993274 b. franchi and r. serapioni : _ intrinsic graphs within carnot groups _ , j. geom .",
    "26 * , ( 2016 ) , issue 3 , 19461994 b. franchi , r. serapioni and f. serra cassano : _ rectifiability and perimeter in the heisenberg group _ , math",
    "* 321 * ( 2001 ) , 479531 b. franchi , r. serapioni and f. serra cassano : _ intrinsic lipschitz graphs in heisenberg groups _ , j. nonlinear convex anal .",
    "* 7 * ( 3 ) ( 2006 ) , 423441 b. franchi , r. serapioni and f. serra cassano : _ differentiability of intrinsic lipschitz functions within heisenberg groups _ , j. geom .",
    ", * 21 * ( 2011 ) , 10441084 j. heinonen , p. koskela , n. shanmugalingam and j. tyson : _ sobolev spaces on metric measure spaces _ ,",
    "cambridge university press , 2015 p. jones : _ lipschitz and bi - lipschitz functions _ , rev . mat .",
    "iberoamericana * 4 * ( 1988 ) , 115122    p.",
    "jones : _ square functions , cauchy integrals , analytic capacity , and harmonic measure , _ harmonic analysis and partial differential equations ( el escorial , 1987 ) , lecture notes in math .",
    "1384 , springer , berlin , 1989 , 2468            p.",
    "mattila : _ geometry of sets and measures in euclidean spaces _ , cambridge university press , 1995 p. mattila , r. serapioni and f. serra cassano : _ characterizations of intrinsic rectifiability in heisenberg groups _ ,",
    "ann . scuola norm .",
    "* 5 * vol .",
    "ix ( 2010 ) , 687723 : _ on the uniform rectifiability of ad - regular measures with bounded riesz transform operator : the case of codimension 1 _ , acta math .",
    "* 213:2 * ( 2014 ) , 237321      f. serra cassano : _ some topics of geometric measure theory in carnot groups . _ in geometry , analysis and dynamics on sub - riemannian manifolds , vol .",
    "i. edited by d. barilari , u. boscain , m. sigalotti .",
    "ems ser.lect .",
    "notes in math .",
    "ems , zurich , 2016"
  ],
  "abstract_text": [
    "<S> the purpose of this paper is to introduce and study some basic concepts of quantitative rectifiability in the first heisenberg group @xmath0 . in particular </S>",
    "<S> , we aim to demonstrate that new phenomena arise compared to the euclidean theory , founded by g. david and s. semmes in the 90 s . </S>",
    "<S> the theory in @xmath0 has an apparent connection to certain nonlinear pdes , which do not play a role with similar questions in @xmath1 .    </S>",
    "<S> our main object of study are the _ intrinsic lipschitz graphs _ in @xmath0 , introduced by b. franchi , r. serapioni and f. serra cassano in 2006 . </S>",
    "<S> we claim that these @xmath2-dimensional sets in @xmath0 , if any , deserve to be called quantitatively @xmath2-rectifiable . </S>",
    "<S> our main result is that the intrinsic lipschitz graphs satisfy a _ </S>",
    "<S> weak geometric lemma _ with respect to _ vertical @xmath3-numbers_. conversely , extending a result of david and semmes from @xmath4 , we prove that a @xmath2-ahlfors - david regular subset in @xmath0 , which satisfies the weak geometric lemma and has _ big vertical projections _ </S>",
    "<S> , necessarily has _ </S>",
    "<S> big pieces of intrinsic lipschitz graphs_. </S>"
  ]
}