{
  "article_text": [
    "quantum key distribution ( qkd )  @xcite enables an unconditionally secure means of distributing secret keys between two spatially separated parties , alice and bob .",
    "the security of qkd has been rigorously proven based on the laws of quantum mechanics  @xcite .",
    "nevertheless , owing to the imperfections in real - life implementations , a large gap between its theory and practice remains unfilled .",
    "in particular , an eavesdropper ( eve ) may exploit these imperfections and launch specific attacks .",
    "this is commonly called quantum hacking . the first successful quantum hacking against a commercial qkd system was the time - shift attack  @xcite based on a proposal in  @xcite .",
    "more recently , the phase - remapping attack  @xcite and the detector - control attack  @xcite have been implemented against various practical qkd systems .",
    "also , other attacks have appeared in the literature  @xcite .",
    "these results suggest that quantum hacking is a major problem for the real - life security of qkd .    to close the gap between theory and practice , a natural attempt was to characterize the specific loophole and find a countermeasure . for instance ,",
    "yuan , dynes and shields proposed an efficient countermeasure against the detector - control attack  @xcite . once an attack is known , the prevention is usually uncomplicated .",
    "however , unanticipated attacks are most dangerous , as it is impossible to fully characterize real devices and account for _ all _ loopholes .",
    "hence , researchers moved to the second approach  ( full ) device - independent qkd  @xcite .",
    "it requires no specification of the internal functionality of qkd devices and offers nearly perfect security .",
    "its legitimate users ( alice and bob ) can be treated as a _",
    "black box by assuming no memory attacks  @xcite .",
    "nevertheless , device - independent qkd is not really practical because it requires near - unity detection efficiency and generates an extremely low key rate  @xcite .",
    "therefore , to our knowledge , there has been no experimental paper on device - independent qkd .",
    "fortunately , lo , curty and qi have recently proposed an innovative scheme  measurement - device - independent qkd ( mdi - qkd )  @xcite  that removes all detector side - channel attacks , the most important security loophole in conventional qkd implementations  @xcite . as an example of a mdi - qkd scheme ( see fig .",
    "[ fig : model ] ) , each of alice and bob locally prepares phase - randomized signals ( this phase randomization process can be realized using a quantum random number generator such as  @xcite ) in the bb84 polarization states  @xcite and sends them to an _ untrusted _ quantum relay , charles ( or eve ) .",
    "charles is supposed to perform a bell state measurement ( bsm ) and broadcast the measurement result .",
    "since the measurement setting is only used to post - select entanglement ( in an equivalent virtual protocol  @xcite ) between alice and bob , it can be treated as a _ true _ black box .",
    "hence , mdi - qkd is inherently immune to all attacks in the detection system .",
    "this is a major achievement as mdi - qkd allows legitimate users to not only perform secure quantum communications with untrusted relays   but also out - source the manufacturing of detectors to untrusted manufactures .",
    "conceptually , the key insight of mdi - qkd is _",
    "time reversal_. this is in the same spirit as one - way quantum computation  @xcite .",
    "more precisely , mdi - qkd built on the idea of a time - reversed epr protocol for qkd  @xcite . by combining the decoy - state method  @xcite with the time - reversed epr protocol , mdi - qkd gives both good performance and good security .",
    "mdi - qkd is highly practical and can be implemented with standard optical components .",
    "the source can be a non - perfect single - photon source ( together with the decoy - state method ) , such as an attenuated laser diode emitting weak coherent pulses ( wcps ) , and the measurement setting can be a simple bsm realized by linear optics .",
    "hence , mdi - qkd has attracted intensive interest in the qkd community .",
    "a number of follow - up theoretical works have already been reported in  @xcite . meanwhile ,",
    "experimental attempts on mdi - qkd have also been made by several groups  @xcite .",
    "nonetheless , before it can be applied in real life , it is important to address a number of practical issues .",
    "these include :    1 .",
    "modelling the errors : an implementation of mdi - qkd may involve various error sources such as the mode mismatch resulting in a non - perfect hong - ou - mandel ( hom ) interference  @xcite .",
    "thus , the first question is : how will these errors affect the performance of mdi - qkd  @xcite ? or , what is the physical origin of the quantum bit error rate ( qber ) in a practical implementation ? 2 .",
    "finite decoy - state protocol and finite - key analysis : as mentioned before , owing to the lack of true single - photon sources  @xcite , qkd implementations typically use laser diodes emitting wcps  @xcite and single - photon contributions are estimated by the decoy - state protocol  @xcite . in addition , a real qkd experiment is completed in finite time , which means that the length of the output keys is finite .",
    "thus , the estimation of relevant parameters suffers from statistical fluctuations .",
    "this is called the finite - key effect  @xcite .",
    "hence , the second question is : how can one design a practical finite decoy - state protocol and perform a finite - key analysis in mdi - qkd ? 3 .",
    "choice of intensities : an experimental implementation needs to know the optimal intensities for the signal and decoy states in order to optimize the system performance .",
    "previously , @xcite and  @xcite have independently discussed the finite decoy - state protocol .",
    "however , the high computational cost of the numerical approach proposed in  @xcite , together with the lack of a rigorous discussion of the finite - key effect in both  @xcite and  @xcite , makes the optimization of parameters difficult .",
    "thus , the third question is : how can one obtain these optimal intensities ? 4 .",
    "asymmetric mdi - qkd : as shown in fig .",
    "[ fig : general ] , in real life , it is quite common that the two channels connecting alice and bob to charles have different transmittances .",
    "we call this situation _ asymmetric _ mdi - qkd . importantly ,",
    "this asymmetric scenario appeared naturally in a recent proof - of - concept experiment  @xcite , where a tailored length of fiber was intentionally added in the short arm to balance the two channel transmittances .",
    "since an additional loss is introduced into the system , it is unclear whether this solution is optimal .",
    "hence , the final question is : how can one optimize the performance of this asymmetric case ?",
    "the second question has already been discussed in  @xcite and solved in  @xcite . in this paper , we offer additional discussions on this point and answer the other questions .",
    "our contributions are summarized below .    1 .   to better understand the physical origin of the qber , we propose generic models for various error sources . in particular , we investigate two important error sources  polarization misalignment and mode mismatch .",
    "we find that in a polarization - encoding mdi - qkd system  @xcite , polarization misalignment is the major source contributing to the qber and mode mismatch ( in the time or frequency domain ) , however , does not appear to be a major problem .",
    "these results are shown in fig .",
    "[ misalignment : asymptotic ] and fig .",
    "[ timejitter : simulation ] .",
    "moreover , we provide a mathematical model to simulate a mdi - qkd system .",
    "this model is a useful tool for analyzing experimental results and performing the optimization of parameters .",
    "although this model is proposed to study mdi - qkd , it is also useful for other non - qkd experiments involving quantum interference , such as entanglement swapping  @xcite and linear optics quantum computing  @xcite .",
    "this result is shown in  [ app : qande ] .",
    "a previous method to analyze mdi - qkd with a finite number of decoy states assumes that alice and bob can prepare a vacuum state  @xcite . here",
    ", however , we present an analytical approach with two _ general _ decoy states , _",
    "i.e. _ , without the assumption of vacuum .",
    "this is particularly important for the practical implementations , as it is usually difficult to create a vacuum state in decoy - state qkd experiments  @xcite .",
    "the different intensities are usually generated with an intensity modulator , which has a finite extinction ratio ( _ e.g. _ , around 30 db ) .",
    "additionally , we also simulate the expected key rates numerically and thus present an optimized method with two decoy states .",
    "ignoring for the moment the finite - key effect , experimentalists can directly use this method to obtain a rough estimation of the system performance .",
    "table  [ tab : finite : equations ] contains the main results for this point .",
    "by combining the system model , the finite decoy - state protocol , and the finite - key analysis of  @xcite , we offer a general framework to determine the optimal intensities of the signal and decoy states . notice that this framework has already been adopted and verified in the experimental demonstration reported in  @xcite .",
    "these results are shown in fig .",
    "[ fig : flowchart ] and fig .",
    "[ fig : optimal : intensity ] .",
    "4 .   finally ,",
    "we model and evaluate the performance of an _ asymmetric _ mdi - qkd system .",
    "this allows us to study its properties and determine the experimental configuration that maximizes its secret key rate .",
    "these results are shown in table  [ tab : opt : parameters ] and fig .",
    "[ fig : advantage : key ] .",
    "the secure key rate of mdi - qkd in the asymptotic case ( _ i.e. _ , assuming an infinite number of decoy states and signals ) is given by  @xcite @xmath0-q_{z}f_{e}(e_{z})h_{2}(e_{z}),\\ ] ] where @xmath1 and @xmath2 are , respectively , the yield ( _ i.e. _ , the probability that charles declares a successful event ) in the rectilinear ( @xmath3 ) basis and the error rate in the diagonal ( @xmath4 ) basis given that both alice and bob send single - photon states ( @xmath5 denotes this probability in the @xmath3 basis ) ; @xmath6 is the binary entropy function given by @xmath7=@xmath8 ; @xmath9 and @xmath10 denote , respectively , the gain and qber in the @xmath3 basis and @xmath11 is the error correction inefficiency function .",
    "here we use the @xmath3 basis for key generation and the @xmath4 basis for testing only  @xcite . in practice , @xmath9 and @xmath10",
    "are directly measured in the experiment , while @xmath1 and @xmath2 can be estimated using the finite decoy - state method .",
    "next , we introduce some additional notations .",
    "we consider one signal state and two weak decoy states for the finite decoy - state protocol .",
    "the parameter @xmath12 is the intensity ( _ i.e. _ , the mean photon number per optical pulse ) of the signal state  . ] .",
    "@xmath13 and @xmath14 are the intensities of the two decoy states , which satisfy @xmath15 .",
    "the sets \\{@xmath16,@xmath17,@xmath18 } and \\{@xmath19,@xmath20,@xmath21 } contain respectively alice s and bob s intensities .",
    "the sets \\{@xmath22,@xmath23,@xmath24 } and \\{@xmath25,@xmath26,@xmath27 } denote the optimal intensities that maximize the key rate . @xmath28 and @xmath29 ( @xmath30 and @xmath31 )",
    "denote the channel distance and transmittance from alice ( bob ) to charles . in the case of a fiber - based system , @xmath29=@xmath32 with @xmath33 denoting the channel loss coefficient ( @xmath33@xmath340.2 db / km for a standard telecom fiber ) .",
    "@xmath35 is the detector efficiency and @xmath36 is the background rate that includes detector dark counts and other background contributions .",
    "the parameters @xmath37 , @xmath38 , and @xmath39 denote , respectively , the errors associated with the polarization misalignment , the time - jitter and the total mode mismatch ( see definitions below ) .",
    "in this section , we consider the original mdi - qkd setting  @xcite , _ i.e. _ , the symmetric case with @xmath40=@xmath41 . the asymmetric case will be discussed in section  [ sec : asymmetric ] . to model the practical error sources , we focus on the fiber - based polarization - encoding mdi - qkd system proposed in  @xcite and demonstrated in  @xcite .",
    "notice , however , that with some modifications , our analysis can also be applied to other implementations such as free - space transmission , the phase - encoding scheme and the time - bin - encoding scheme .",
    "see also  @xcite and  @xcite respectively for models of phase - encoding and time - bin - encoding schemes .",
    "a comprehensive list of practical error sources is as follows  .    1 .   polarization misalignment ( or rotation ) .",
    "mode mismatch including time - jitter , spectral mismatch and pulse - shape mismatch .",
    "fluctuations of the intensities ( modulated by alice and bob ) at the source .",
    "4 .   background rate .",
    "asymmetry of the beam splitter .    here",
    ", we primarily analyze the first two error sources , _",
    "i.e. _ , polarization misalignment and mode mismatch .",
    "the other error sources present minor contributions to the qber in practice , and are discussed in  [ app : othererrors ] .",
    "polarization misalignment ( or rotation ) is one of the most significant factors contributing to the qber in not only the polarization - encoding bb84 system  @xcite but also the polarization - encoding mdi - qkd system . since mdi - qkd requires two transmitting channels and one bsm ( instead of one channel and a simple measurement as in the bb84 protocol )",
    ", it is cumbersome to model its polarization misalignment . here",
    ", we solve this problem by proposing a simple model in fig .",
    "[ fig : model ] .",
    "one of the polarization beam splitters ( pbs2 in fig .",
    "[ fig : model ] ) is defined as the fundamental measurement basis  .",
    "three unitary operators , \\{@xmath42 , @xmath43 , @xmath44 } , are considered to model the polarization misalignment of each channel  @xcite .",
    "the operator @xmath42 ( @xmath43 ) represents the misalignment of alice s ( bob s ) channel transmission , while @xmath44 models the misalignment of the other measurement setting , pbs1 .    for simplicity",
    ", we consider a simplified model with a 2-dimensional unitary matrix   and @xmath45 , and the outgoing modes by @xmath46 and @xmath47 , then the unitary operator yields an evolution of the form @xmath48 and @xmath49 .",
    "this unitary matrix is a simple form rather than the general one ( see section i.a in  @xcite ) .",
    "nonetheless , we believe that the result for a more general unitary transformation will be similar to our simulation results . ]",
    "@xmath50 where @xmath51=1 , 2 , 3 and @xmath52 ( polarization - rotation angle ) is in the range of [ @xmath53,@xmath54 . for each value of @xmath51",
    ", we define the polarization misalignment error @xmath55=@xmath56 and the total error @xmath57=@xmath58 .",
    "note that @xmath37 is equivalent to the systematic qber in a polarization - encoding bb84 system .",
    ".list of practical parameters for all numerical simulations .",
    "these experimental parameters , including the detection efficiency @xmath35 , the total misalignment error @xmath37 and the background rate @xmath59 , are from the 144 km qkd experiment reported in  @xcite .",
    "since two spds are used in  @xcite , the background rate of each spd here is roughly half of the value there .",
    "we assume that the four spds in mdi - qkd ( see fig .  [",
    "fig : model ] ) have identical @xmath35 and @xmath59 .",
    "the parameter @xmath39 is the total mode mismatch that is quantified from the experimental values of  @xcite . [",
    "cols=\"^,^,^,^,^\",options=\"header \" , ]     the _ optimal choice _ ( indicated by optimum in fig .",
    "[ fig : advantage : key ] and table  [ tab : opt : parameters ] ) that maximizes the key rate can be determined from numerical optimizations .",
    "here we perform such optimizations and also analyze the properties of asymmetric mdi - qkd .",
    "our main results are :    1 .   in the asymptotic case ,",
    "the optimal choice for @xmath60 and @xmath61 does not always satisfy @xmath62=@xmath63 , but the ratio @xmath64 is near 1 . for @xmath65@xmath661 , @xmath64@xmath67[0.3 , 1 ) ; for @xmath65@xmath681 , @xmath64@xmath67[1 , 3.5 ] ; this result can be seen from fig .",
    "[ simu : mumu : withdark ] ) . in the practical case with the two decoy - state protocol and finite - key analysis , \\{@xmath69 , @xmath70 } and \\{@xmath71 , @xmath72 }",
    "satisfy a similar condition with the ratio @xmath64 ( or @xmath73 ) near 1 , while \\{@xmath74 , @xmath75 } are optimized at their smallest value .",
    "see table  [ tab : opt : parameters ] for further details .",
    "2 .   in an asymmetric system with @xmath65=0.1 ( 50 km length difference for two standard fiber links ) ,",
    "the advantage of the optimal choice is shown in fig .  [",
    "fig : advantage : key ] , where the key rate with the optimal choice is around 80% larger than that with the symmetric choice in both asymptotic and practical cases  @xcite .",
    "we remark that when @xmath65 is far from 1 , this advantage is more significant .",
    "for instance , with @xmath65=0.01 ( 100 km length difference ) , the key rate with the optimal choice is about 150% larger than that with the symmetric choice .",
    "3 .   in the asymptotic case , at a short distance where background counts can be ignored : @xmath69 and @xmath70 are _ only _ determined by @xmath65 instead of @xmath29 or @xmath31 ( see the optimal intensities in table  [ tab : opt : parameters ] and theorem  [ theorem1 ] in  [ app : asymptotic ] ) ; assuming a fixed @xmath65 , @xmath69 and @xmath70 can be analytically derived and the optimal key rate is quadratically proportional to @xmath31 ( see  [ app : asymptotic ] ) .",
    "finally , notice that the channel transmittance ratio in calgary s asymmetric system is near 1 ( @xmath65=0.752 ) , hence the optimal choice can slightly improve the key rate compared to the symmetric choice ( around 2% improvement ) .",
    "however , in tokyo s asymmetric system ( @xmath65=0.017 ) , the optimal choice can significantly improve the key rate by over 130% .",
    "a key assumption in mdi - qkd  @xcite is that alice and bob trust their devices for the state preparation , _",
    "i.e. _ , they can generate ideal quantum states in the bb84 protocol .",
    "one approach to remove this assumption is to quantify the imperfections in the state preparation part and thus include them into the security proofs  @xcite .",
    "we believe that this assumption is practical because alice s and bob s quantum states are prepared by themselves and thus can be experimentally verified in a fully protected laboratory environment outside of eve s interference .",
    "for instance , based on an earlier proposal  @xcite , c. c. w. lim _ et al .",
    "_ have introduced another interesting scheme  @xcite in which each of alice and bob uses an entangled photon source ( instead of wcps ) and quantifies the state - preparation imperfections via random sampling .",
    "that is , alice and bob randomly sample parts of their prepared states and perform a local bell test on these samples .",
    "such a scheme is very promising , as it is in principle a fully device - independent approach .",
    "it can be applied in short - distance communications .    in conclusion , we have presented an analysis for practical aspects of mdi - qkd . to understand the physical origin of the qber",
    ", we have investigated various practical error sources by developing a general system model . in a polarization - encoding mdi - qkd system ,",
    "polarization misalignment is the major source contributing to the qber .",
    "hence , in practice , an efficient polarization management scheme such as polarization feedback control  @xcite can significantly improve the polarization stabilization and thus generate a higher key rate .",
    "we have also discussed a simple analytical method for the finite decoy - state analysis , which can be directly used by experimentalists to demonstrate mdi - qkd .",
    "in addition , by combining the system model with the finite decoy - state method , we have presented a general framework for the optimal intensities of the signal and decoy states .",
    "furthermore , we have studied the properties of the asymmetric mdi - qkd protocol and discussed how to optimize its performance .",
    "our work is relevant to both qkd and general experiments on quantum interference .",
    "we thank w.  cui , s. gao , l.  qian for enlightening discussions and v.  burenkov , z.  liao , p.  roztocki for comments on the presentation of the paper . support from funding agencies",
    "nserc , the crc program , european regional development fund ( erdf ) , and the galician regional government ( projects cn2012/279 and cn 2012/260 ,  consolidation of research units : atlanttic \" ) is gratefully acknowledged .",
    "f. xu would like to thank the paul biringer graduate scholarship for financial support .",
    "here , we discuss other practical error sources and show that their contribution to the qber is not very significant in a practical mdi - qkd system . for this reason ,",
    "they are ignored in our simulations .",
    "the intensity fluctuations of the signal and decoy states at the source are relatively small ( @xmath76 0.1 db )  @xcite .",
    "additionally , alice and bob can in principle locally and precisely quantify their own intensities .",
    "therefore , this error source can be mostly ignored in the theoretical model that analyzes the performance of practical mdi - qkd ( but one could easily include it in the analysis ) .",
    "the threshold single photon detector ( spd ) can be modeled by a beam splitter with @xmath35 transmission and ( 1-@xmath35 ) reflection .",
    "the transmission part is followed by a unity efficiency detector , while the reflection part is discarded .",
    "@xmath35 is defined as the detector efficiency .",
    "background counts can be treated to be independent of the incoming signals . for simplicity",
    ", the system model discussed in section  [ app : qande ] assumes that the four spds ( see fig .  [ fig : model ] ) are identical and have a detection efficiency @xmath35 and a background rate @xmath36 .",
    "note , however , that if this condition is not satisfied ( _ i.e. _ , there is some detection efficiency mismatch ) our system model can be adapted to take care also of this case .",
    "all the simulations reported in the main text already consider a background rate of @xmath59=@xmath77 ( see table  [ tab : exp : parameters ] ) .",
    "[ detector : darkcounts ] simulates more general cases of the asymptotic key rates at different background count rates . at 0 km ,",
    "the mdi - qkd system can tolerate up to @xmath78 ( per pulse ) background counts .      in practice , for telecom wavelengths ,",
    "the asymmetry of the beam splitter ( bs ) ( _ i.e. _ , not 50:50 ) is usually small .",
    "for instance , the wavelength dependence of the fiber - based bs in our lab ( newport-13101550 - 5050 fiber coupler ) is experimentally quantified in fig .",
    "[ fig : bsratio ] .",
    "if the laser wavelength is 1542 nm  @xcite , the bs ratio is 0.5007 , which introduces negligible qber ( below 0.01% ) in a mdi - qkd system .",
    "hence , this error source can also be ignored in the theoretical model of mdi - qkd .",
    "in this section , we discuss an analytical method to model a polarization - encoding mdi - qkd system .",
    "that is , we calculate @xmath1 , @xmath2 , @xmath79 and @xmath80 and thus estimate the expected key rate from eq .",
    "( [ eqn : key : formula ] ) .    to simplify our calculation , we make two assumptions about the practical error sources : a ) since most practical error sources do not contribute significantly to the system performance , we only consider the polarization misalignment @xmath57 , the background count rate @xmath36 and the detector efficiency @xmath81 ; b ) for the model of the polarization misalignment , we consider only two unitary operators , @xmath82 and @xmath83 , to represent respectively the polarization misalignment of alice s and bob s channel transmission , _",
    "i.e. _ , set @xmath84=@xmath85 in the generic model of sec .",
    "[ sec : polarization ] . for simplicity , a more rigorous derivation with @xmath44 @xmath86",
    "is not shown here , but it can be easily completed following our procedures discussed below .      in the asymptotic case , we assume that @xmath1 and @xmath2 in eq .",
    "( [ eqn : key : formula ] ) can be perfectly estimated with an infinite number of signals and decoy states .",
    "thus , they are given by @xmath87,\\end{aligned}\\ ] ] where @xmath88=@xmath1 .",
    "importantly , we can see that ignoring the imperfections of polarization misalignment and background counts ( _ i.e. _ , @xmath89 , @xmath90 ) , @xmath91 is zero , while @xmath92 ( @xmath5=@xmath93 ) can be maximized with @xmath60=@xmath61 .",
    "thus , the optimal choice of intensities is @xmath60=@xmath61=1 .",
    "however , in practice , it is inevitable to have certain practical errors , which result in this optimal choice being a _ function _ of the values of practical errors",
    ".      now , let us calculate @xmath9 and @xmath10 , which are eventually given by eq .",
    "( [ qrect : erect ] ) . to further simplify our discussion , we use \\{horizonal , vertical,45-degree,135-degree } to represent the bb84 polarization states .",
    "also , \\{@xmath94 } will denote alice s and bob s encoding modes .",
    "we define the following notations :    @xmath95      first , both alice and bob encode their states in the h mode ( symmetric to v mode ) .",
    "we assume that @xmath82 and @xmath83 ( see eq .",
    "( [ unitary ] ) ) rotate the polarization in the _ same _ direction , i.e. @xmath97 . the discussion regarding rotation in the opposite direction ( i.e. @xmath98 ) is in  [ qhh : oppositeangle ] .    in charles s lab , after the bs and pbs ( see fig .  [",
    "fig : model ] ) , the optical intensities received by each spd are given by @xmath99 where @xmath100 denotes the relative phase between alice s and bob s weak coherent states .",
    "thus , the detection probability of each threshold spd is @xmath101 where @xmath102 .",
    "then , the coincident counts are @xmath103 where @xmath104 and @xmath105 denote , respectively , the probability of the projection on the triplet @xmath106= @xmath107 ) and the singlet @xmath108= @xmath109 ) . here from fig .  [",
    "fig : model ] , triplet means the coincident detections of \\{ch & cv } or \\{dh & dv } ; singlet means the coincident detections of \\{ch & dv } or \\{cv & dh}. after averaging over the relative phase @xmath100 ( integration over [ 0,2@xmath54 ) , we have @xmath110 , \\\\ \\nonumber q_{z}^{hh,\\psi^{-}}&=2e^{-\\frac{\\gamma}{2}}(1-y_{0})^{2}[i_{0}(\\beta-2\\beta e_{d1})+(1-y_{0})^{2}e^{-\\frac{\\gamma}{2 } } \\\\",
    "\\nonumber      & -(1-y_{0})e^{-\\frac{\\gamma(1-e_{d1})}{2}}i_{0}(e_{d1}\\beta)-(1-y_{0})e^{-\\frac{\\gamma e_{d1}}{2}}i_{0}(\\beta - e_{d1}\\beta)],\\end{aligned}\\ ] ] [ qhh : final ] where @xmath111 is the modified bessel function .",
    "therefore , @xmath96 is given by @xmath112    here , to simplify eq .",
    "( [ qhh : final ] ) , we ignore background counts , _",
    "i.e. _ , @xmath113 , and use a 2nd order approximation ( as both @xmath114 and @xmath115 are typically on the order of @xmath116 ) such that @xmath117 then , eq .  ( [ qhh : final ] ) can be estimated as @xmath118 and @xmath96 is given by @xmath119      alice ( bob ) encodes her ( his ) state in the h ( v ) mode ( symmetric to v ( h ) ) .",
    "we also assume @xmath97 . at charles",
    "s side , the optical intensities received by each spd are given by @xmath121    the detection probability of each spd is described by eq .",
    "( [ qhh : detection : prob ] ) . @xmath122 and @xmath123 can be calculated similarly to eq .",
    "( [ qhh : model : final ] ) . after averaging over @xmath100 ,",
    "the results are @xmath124,\\\\ \\nonumber      q_{z}^{hv,\\psi^{-}}&=2e^{-\\frac{\\gamma}{2}}(1-y_{0})^{2}[1+(1-y_{0})^{2}e^{-\\frac{\\gamma}{2}}\\\\ \\nonumber      & -(1-y_{0})e^{-\\frac{\\omega}{2}}i_{0}(\\lambda)-(1-y_{0})e^{-\\frac{\\gamma-\\omega}{2}}i_{0}(\\lambda)].\\end{aligned}\\ ] ]    therefore , @xmath120 is given by @xmath125    to simplify eq .",
    "( [ qhv : final ] ) we once again ignore the background counts and take a 2nd order approximation .",
    "( [ qhv : final ] ) can be estimated as @xmath126 and @xmath120 is given by @xmath127      finally , @xmath9 and @xmath10 can be expressed as @xmath128 where the different terms on the r.h.s . of this equation are given by eqs .",
    "( [ qhh : final ] , [ qhh : finalfinal ] , [ qhv : final ] , [ qhv : finalfinal ] ) . therefore , together with eq .",
    "( [ q11e11:nonideal : final ] ) , we could derive the analytical key rate of eq .",
    "( [ eqn : key : formula ] ) .    if we ignore background counts and take the 2nd order approximation from eqs .",
    "( [ qhh : final : estimation : two ] , [ qhv : final : estimation : two ] ) , @xmath9 and @xmath10 can be written as @xmath129      when @xmath82 and @xmath83 rotate the polarization in the _ opposite _ direction , _",
    "i.e. _ , @xmath98 , eq .  ( [ qhh : meanphotonnumbers : hh ] ) changes to @xmath130    after performing similar procedures to those of section  [ sec : qhh ] , eq .",
    "( [ qhh : final : estimation : two ] ) is altered to @xmath131    since the qber is mainly determined by @xmath96 , by comparing eq .",
    "( [ qhh : final : estimation : two ] ) to ( [ qhh : opposite : final : estimation : two ] ) , we conclude that    @xmath97 : :    projection on @xmath106 results in a larger qber    than that on @xmath108 @xmath98 : :    projection on @xmath106 results in a smaller qber    than that on @xmath108    an equivalent analysis can also be applied to @xmath120 following section  [ sec : qhv ] , and thus eq .  ( [ qhv : final : estimation : two ] ) is altered to @xmath132    therefore , the key rates of @xmath133 ( projections on the triplet ) and @xmath134 ( projections on the singlet ) are _ correlated _ with the relative direction of the rotation angles , while the overall key rate @xmath135 ( @xmath136 ) is _ independent _ of the relative direction of the rotation angles .",
    "we finally remark that in a practical polarization - encoding mdi - qkd system , the polarization rotation angle of each quantum channel ( @xmath137 or @xmath138 ) can be modeled by a gaussian distribution with a standard deviation of @xmath139 ( @xmath140 ) , which means that both @xmath137 and @xmath138 ( mostly ) distribute in the range of [ @xmath141 , @xmath142 and the relative direction between them also randomly distributes between @xmath97 and @xmath98 .",
    "hence , the effect of the polarization misalignment is the same for @xmath133 and @xmath134 , _",
    "i.e. _ , both @xmath133 and @xmath134 are independent of the total polarization misalignment .",
    "we can experimentally choose to measure either the singlet or the triplet by using only two detectors ( but sacrificing half of the total key rate ) , such as in the experiments of  @xcite .",
    "here we discuss the properties of a practical asymmetric mdi - qkd system . for this , we derive an analytical expression for the estimated key rate and we optimize the system performance numerically .      the estimated key rate @xmath143 is defined under the condition that background counts can be ignored . note",
    "that this is a reasonable assumption for a short distance transmission .",
    "[ theorem1 ] @xmath69 and @xmath70 only depend on @xmath65 rather than on @xmath29 or @xmath31 ; under a fixed @xmath65 , @xmath143 is quadratically proportional to @xmath31 .    _ proof _ : when @xmath59 is ignored , @xmath2 and @xmath144 are given by ( see eq .",
    "( [ q11e11:nonideal : final ] ) ) @xmath145 if we take the 2nd order approximation , @xmath9 and @xmath10 are estimated as ( see eq .",
    "( [ qrect : erect : final : estimation ] ) ) @xmath146}{4 } , \\\\ \\nonumber      e_{z}=\\frac{(\\mu_{b}+x\\mu_{a})^{2}(2e_{d}-e_{d}^{2})}{2[2x\\mu_{a}\\mu_{b}+(\\mu_{b}^{2}+x^{2}\\mu_{a}^{2})(2e_{d}-e_{d}^{2})]}.\\end{aligned}\\ ] ] by combining the above two equations with eq .",
    "( [ eqn : key : formula ] ) , the overall key rate can be written as @xmath147 where @xmath148 has the form @xmath149\\\\ \\nonumber                          & -\\frac{2x\\mu_{a}\\mu_{b}+(\\mu_{b}^{2}+x^{2}\\mu_{a}^{2})(2e_{d}-e_{d}^{2})}{2}\\times f_e h_2(e_z),\\end{aligned}\\ ] ] where @xmath10 is given by eq .",
    "( [ qrect : erect : final : estimation : xmuamub ] ) and is also a function of @xmath150 .",
    "therefore , optimizing @xmath143 is equivalent to maximizing @xmath148 and the optimal values , @xmath69 and @xmath70 , are _ only _ determined by @xmath65 . under a fixed @xmath65 , the optimal key rate is quadratically proportional to @xmath31 . for a given @xmath65 , the maximization of @xmath148 can be done by calculating the derivatives over @xmath60 and @xmath61 and verified using the jacobian matrix .",
    "we numerically study the properties of an asymmetric mdi - qkd system . in our simulations below , the asymptotic key rate , denoted by @xmath151 , is rigorously calculated from the key rate formula given by eq .",
    "( [ eqn : key : formula ] ) in which each term is shown in  [ app : qande ] .",
    "@xmath143 denotes the estimated key rate from eq .",
    "( [ key : formula : xmuamub ] ) .",
    "the practical parameters are listed in table  [ tab : exp : parameters ] .",
    "we used the method of  @xcite for the finite - key analysis .",
    "firstly , fig .",
    "[ simu : key : comparision ] simulates the key rates of @xmath151 and @xmath143 at different channel lengths . for short distances ( _ i.e.",
    "_ , total length@xmath152@xmath66100 km ) , the overlap between @xmath143 and @xmath151 demonstrates the accuracy of our estimation model of eq .",
    "( [ key : formula : xmuamub ] ) .",
    "therefore , in the short distance range , we could focus on @xmath143 to understand the behaviors of the key rate .",
    "moreover , from the curve of @xmath30=1 m , we have that this asymmetric system can tolerate up to @xmath65=0.004 ( 120 km length difference for standard fiber links ) .    secondly , fig .",
    "[ simu : mumu : withdark ] shows @xmath69 and @xmath70 , when both @xmath30 and @xmath28 are scanned from 1 m to 100 km .",
    "these parameters numerically verify theorem  [ theorem1 ] : at short distances ( @xmath65@xmath680.5 ) , @xmath69 and @xmath70 depend _ only _ on @xmath65 , while at long distances ( @xmath65@xmath660.5 ) , background counts contribute significantly and result in non - smooth behaviors . @xmath69 and @xmath70 are both in @xmath153 .    finally , we simulate the optimal key rates under two _ fixed _ @xmath65 in fig .  [",
    "fig : key:2decoy : fluc ] .    1 .",
    "solid curves are the asymptotic keys : at short distances ( @xmath30+@xmath28@xmath66120 km ) , the maximal @xmath148 is fixed with a fixed @xmath65 ( see eq .",
    "( [ key : formula : gxmuamub ] ) ) . taking the logarithm with base 10 of @xmath143 and writing @xmath31=@xmath154 , eq .",
    "( [ key : formula : xmuamub ] ) can be expressed as @xmath155 hence , the scaling behavior between the logarithm ( base 10 ) of the key rate and the channel distance is linear , which can be seen in the figure . here , @xmath156 db / km ( standard fiber link ) results in a slope of -0.4 .",
    "dotted curves are the two decoy - state key rates with the finite - key analysis : we consider a total number of signals @xmath157 and a security bound of @xmath158 ; for the dotted curve with @xmath65=0.1 , the optimal intensities satisfy @xmath159 , which means that the ratios for the optimal @xmath12 and @xmath13 are roughly the same and this ratio is mainly determined by @xmath65 . even taking the finite - key effect into account ,",
    "the system can still tolerate a total fiber link of 110 km .",
    "10 bennett c h and brassard g 1984  quantum cryptography : public key distribution and coin tossing \" _ proc .",
    "conf . on computers , systems and signal processing _ ( ieee new york ) pp .",
    "175 - 179        mayers d 2001 _ j. acm _ * 48 * 351 ; lo h - k and chau h f 1999 _ science _ * 283 * 2050 ; shor p and preskill j 2000 _ phys . rev .",
    "lett . _ * 85 * 441 ; scarani v , bechmann - pasquinucci h , cerf n j , duek m , ltkenhaus n and peev m 2009 _ rev .",
    "modern phys . _ * 81 * 1301        fung c - h f , qi b , tamaki k and lo h - k 2007  phase - remapping attack in practical quantum - key - distribution systems \" _ phys .",
    "rev . a _ * 75 * 32314 ; xu f , qi b and lo h - k 2010  experimental demonstration of phase - remapping attack in a practical quantum key distribution system \" _ new j. phys . _",
    "* 113026    lydersen l , wiechers c , wittmann c , elser d , skaar j and makarov v 2010 _ nat .",
    "photonics _ , * 4 * 686 ; gerhardt i , liu q , lamas - linares a , skaar j , kurtsiefer c and makarov v 2011 _ nat . communications _ ,",
    "* 2 * 349    weier h , krauss h , rau m , fuerst m , nauerth s and weinfurter h 2011 _ new j. phys .",
    "_ * 13 * 073024 ; jain n , wittmann c , lydersen l , wiechers c , elser d , marquardt c , makarov v and g. leuchs 2011 _ phys .",
    "lett . _ * 107 * 110501 ; h .- w .",
    "li , s. wang , j .- z .",
    "huang , w. chen , z .- q .",
    "yin , f .- y . li , z. zhou , d. liu , y. zhang , g .- c .",
    "guo , w .- s .",
    "bao , and z .- f .",
    "han 2011 _ phys .",
    "a _ * 84 * 062308 ; sun s , jiang m and liang l , 2011 _ phys .",
    "a _ * 83 * 062331                    hwang w y 2003 _ phys . rev",
    ". lett . _ * 91 * 057901 ; lo h - k , ma x and chen k 2005 _ phys .",
    "* 94 * 230504 ; wang x - b 2005 _ phys .",
    "lett . _ * 94 * 230503 ; ma x , qi b , zhao y and lo h - k 2005 _ phys .",
    "rev . a _ * 72 * 012326                  rubenok a , slater j - a , chan p , lucio - martinez i and tittel w 2013  real - world two - photon interference and proof - of - principle quantum key distribution immune to detector attacks \" _ phys .",
    "lett . _ * 111 * 130501    liu y , chen t - y , wang l - j , liang h , shentu g - l , wang j , cui k , yin",
    "h - l , liu",
    "n - l , li l , ma x , pelc j s , feje r m m , zhang q and pan j - w 2012  experimental measurement - device - independent quantum key distribution \" _ phys",
    "lett . _ * 111 * 130502            from the security aspect , one can in principle operate a mdi - qkd system without knowing the exact origin of the observed qber . however , from the performance aspect , it is important to study the origin of the qber in order to maximize the secure key rate",
    ".            rosenberg d , harrington j w , rice p r , hiskett p a , peterson c g , hughes r j , lita a e , nam s w and nordholt j e 2007 _ phys .",
    "_ * 98 * 010503 ; dixon a , yuan z , dynes j , sharpe a and shields a 2008 _ opt .",
    "express _ * 16 * 18790    rosenberg d , peterson c , harrington j , rice p , dallmann n , tyagi k , mccabe k , nam s , baek b , hadeld r , hughes r j and nordholt j e 2009  practical long - distance quantum key distribution system using decoy levels \" _ new j. phys . _ * 11 * 045009        this list does not consider the state - preparation error  @xcite , because a strict discussion about this problem is related to the security proof of mdi - qkd , which will be considered in future publications .",
    "if we denote the two incoming modes in the horizontal and vertical polarization by the creation operators @xmath160 and @xmath45 , and the outgoing modes by @xmath46 and @xmath47 , then the unitary operator yields an evolution of the form @xmath48 and @xmath49 .",
    "this unitary matrix is a simple one rather than the most general one  @xcite .",
    "nonetheless , we believe that the result for a more general unitary transformation will be similar to our simulation results .",
    "ursin r , _ et al _ 2007  entanglement - based quantum communication over 144 km \" _ nat .",
    "physics _ , * 3 * 481 two remarks for the distribution of the three unitary operators : a ) we assume that the two channel transmissions , _ i.e. _ , @xmath42 and @xmath43 , introduce much larger polarization misalignments than the other measurement basis , @xmath44 ( pbs1 in fig .  [ fig : model ] ) , because pbs1 is located in charles s local station and can be carefully aligned ( in principle ) . hence , we choose @xmath161=@xmath162=0.475@xmath37 and @xmath163=0.05@xmath37 .",
    "b ) notice that the simulation result is more or less _ independent _ of the distribution of @xmath164 .      suppose both alice and bob encode their optical pulses in the same mode of horizontal polarization in the @xmath3 basis .",
    "ignoring the polarization misalignment , the interference result will _ only _ generate a click on the horizontal detectors rather than create coincident detections .",
    "this holds both for the cases of perfect interference ( @xmath165=0 ) and non - interference ( @xmath165=1 ) .",
    "thus , @xmath165=1 does not increase the qber in the @xmath3 basis .    in the derivation of @xmath166 and @xmath167 with mode mismatch , the non - overlapping modes can be essentially treated as background counts increasing the background count rate of each detector .",
    "the final result is a summation over the overlapping and non - overlapping modes .        according to  @xcite , it is also possible for other two combinations of intensities : 1 ) choosing intensity pairs from \\{@xmath16 , @xmath17 , @xmath19 , @xmath20 } and \\{@xmath17 , @xmath18 , @xmath20 , @xmath21 } , substituting @xmath14 with @xmath13 for @xmath170 in eq .",
    "( [ y11:2decoy : qrectm ] ) , and then performing similar calculations ; 2 ) choosing intensity pairs from \\{@xmath16 , @xmath17 , @xmath19 , @xmath20 } and \\{@xmath16 , @xmath18 , @xmath19 , @xmath21 } , substituting @xmath14 with @xmath13 for @xmath170 and substituting @xmath13 with @xmath12 for @xmath171 in eq .",
    "( [ y11:2decoy : qrectm ] ) , and performing similar calculations . here",
    "we numerically found that the optimal intensity choice is to choose from \\{@xmath16 , @xmath18 , @xmath19 , @xmath21 } and \\{@xmath17 , @xmath18 , @xmath20 , @xmath21}.    similar to the estimation of @xmath172 , according to  @xcite , it is also possible for other two combinations , _",
    "i.e. _ , \\{@xmath16 , @xmath17 , @xmath19 , @xmath20 } or \\{@xmath16 , @xmath18 , @xmath19 , @xmath21}. we numerically found that the optimal choice is to choose from \\{@xmath17 , @xmath18 , @xmath20 , @xmath21}.    in theory , @xmath173 .",
    "thus , we can decide to implement the standard decoy - state method only in the @xmath3 basis and estimate @xmath88 from @xmath1 , while in the @xmath4 basis , we only implement the decoy states instead of the signal state .",
    "the advantage of such an implementation is to increase the key rate .",
    "see also  @xcite for a similar discussion .",
    "we assume that , the intensity of the signal state is about 0.5 and the maximum extinction ratio of a practical intensity modulator is around 30 db  @xcite .",
    "thus , the lowest intensity that can be modulated is @xmath174 .",
    "xavier g b , walenta n ,",
    "de faria g v , temporo g p , gisin n , zbinden h and von der weid j p 2009  experimental polarization encoded quantum key distribution over optical fibres with real - time continuous birefringence compensation \" _ new j. phys .",
    "_ * 11 * 045015"
  ],
  "abstract_text": [
    "<S> a novel protocol , measurement - device - independent quantum key distribution ( mdi - qkd ) , removes all attacks from the detection system , the most vulnerable part in qkd implementations . in this paper </S>",
    "<S> , we present an analysis for practical aspects of mdi - qkd . to evaluate its performance , we study various error sources by developing a general system model . we find that mdi - qkd is highly practical and thus can be easily implemented with standard optical devices . moreover , we present a simple analytical method with only two ( general ) decoy states for the finite decoy - state analysis . this method can be used directly by experimentalists to demonstrate mdi - qkd . by combining the system model with the finite decoy - state method </S>",
    "<S> , we present a general framework for the optimal choice of the intensities of the signal and decoy states . </S>",
    "<S> furthermore , we consider a common situation , namely _ asymmetric _ mdi - qkd , in which the two quantum channels have different transmittances . </S>",
    "<S> we investigate its properties and discuss how to optimize its performance . </S>",
    "<S> our work is of interest not only to experiments demonstrating mdi - qkd but also to other non - qkd experiments involving quantum interference . </S>"
  ]
}