{
  "article_text": [
    "linear optical spectroscopy is an important tool to obtain information about multichromophoric complexes like j - aggregates @xcite or photosynthetic light harvesting complexes @xcite .",
    "in particular the combination of linearly polarized spectra and circular dichroism spectra ( difference of absorption of left and right circularly polarized light ) allows one to draw many conclusions about the ( often unknown ) arrangement of the chromophores @xcite or to extract unknown electronic transition energies ( often termed site energies ) of the chromophores @xcite .",
    "the interpretation of measured aggregate spectra is complicated because of often strong coupling of an electronic excitation to internal vibrations ( i.e.  nuclear coordinates of the chromophores ) and other environmental degrees of freedom .",
    "therefore , one has to be careful not to draw conclusions solely based on an electronic exciton theory @xcite .    the influence of vibrations on molecular aggregates has been studied using various methods ( see for example  @xcite ) .",
    "recently we have adopted the so - called non - markovian quantum state diffusion ( nmqsd ) approach @xcite , which allows one to treat aggregates where electronic excitation couples to a structured spectral density ( which can , e.g. , describe damped vibrational modes of the chromophores , see appendix  [ app : aggregate ] ) .    in the present work",
    "we will use a `` bath '' of harmonic oscillators to describe both internal ( nuclear ) and external degrees of freedom on the same footing .",
    "the modes of this `` bath '' we will generally call vibrational modes ( or simply vibrations ) .",
    "the nmqsd method is based on an open system approach . in the present work",
    "we will take the open system to consist of the electronic states of the chromophores , as we have done in refs .",
    "note that one can also make other choices for the system , e.g.  including some vibrational modes explicitly @xcite . in the nmqsd approach a stochastic schrdinger equation that lives only in the space of the system degrees of freedom .",
    "averaging over the stochastic trajectories allows in principle to obtain _ exactly _ the reduced density operator of the system and expectation values of operators in the system space .    while for transfer of excitation the inclusion of stochastic terms in the nmqsd wave function equation is fundamental @xcite , it turned out that for absorption _ from the ` total ground state ' _",
    "( i.e.  zero temperature ) the stochastic noise terms do not enter explicitly the relevant propagation @xcite and only a _",
    "trajectory ( without noise ) needs to be propagated .    in the present work",
    ", we will show that the same formulation can be found for finite temperatures through a mapping to temperature zero , which was introduced for the nmqsd approach in refs .",
    ". we will adopt this treatment in our calculations of optical properties .",
    "the paper is organized as follows : in the following section  [ mod_of_agg ] the model hamiltonian used to describe the aggregate is introduced . then",
    "in section  [ calculation_of_spectra ] we present our method for the calculation of linear spectra .",
    "first the general definitions of absorption and circular dichroism ( cd ) are given , then the thermofield approach providing the mapping to temperature zero is briefly reviewed . in the following subsections  [ sec : abs_in_qsd ] and",
    "[ sec : treat_func_deriv ] the calculation of spectra within the nmqsd approach is derived . in section  [ sec : example_calculations ] we apply the method to calculate absorption and cd spectra of a model dimer .    in several appendices we provide additional details .    throughout the paper we set @xmath0 and @xmath1 .",
    "we consider an aggregate consisting of @xmath2 monomers , labeled by @xmath3 .",
    "we assume that the electronic wave functions of the monomers do not overlap and take them to be real .",
    "the electronic ground state of the aggregate , from which absorption takes place , is then taken as the product @xmath4 of the electronic ground states @xmath5 of all individual monomers .",
    "since we are interested in linear optical properties we will restrict the excited state basis to states in which only one monomer @xmath6 is electronically excited and all other monomers are in their electronic ground state .",
    "these states are denoted by @xmath7 we expand the aggregate hamiltonian w.r.t .",
    "the states defined in eqs .",
    "( [ elgroundstateagg ] ) and ( [ pi_n_states ] ) and neglect states with more than one electronic excitation on the aggregate .",
    "we then write the hamiltonian of the aggregate as @xmath8 here , @xmath9 is the electronic ground state hamiltonian ( for a brief derivation see appendix  [ app : aggregate ] ) @xmath10 where @xmath11 comprises all the ( possibly different ) vibrational modes @xmath12 of the monomers and will later play the role of an environment .",
    "the hamiltonian in the one - excitation subspace is given by ( see appendix  [ app : aggregate ] ) @xmath13 with the purely electronic `` system '' part @xmath14 where the matrix element @xmath15 causes electronic excitation to be transferred from monomer @xmath16 to monomer @xmath6 , and a part @xmath17 describing the `` bath '' of vibrational modes given by eq .",
    "( [ eq : h_env ] ) .",
    "the coupling of electronic excitation to these vibrations is expressed through @xmath18 with the ( hermitian ) system operators @xmath19 .",
    "note that also the inclusion of off - diagonal coupling terms @xmath20 with @xmath21 is possible .",
    "the generalization of the following equations to this case is straightforward .",
    "however , for readability we restrict ourselves to the diagonal coupling terms eq .",
    "( [ hint ] ) and also assume that the baths are uncorrelated .",
    "note that in our previous work we used the symbol @xmath22 instead of @xmath23 for the system coupling operators . here , we only use @xmath22 in appendix  [ sec : general_equations_of_motion ] in order to emphasize that the derivation therein also holds for coupling operators that are not necessarily hermitian .",
    "it is convenient to define the so - called spectral density @xcite of monomer @xmath6 by @xmath24 later , @xmath25 will be considered as a continuous function of frequency . for an interpretation of the spectral density",
    "see appendix  [ app : aggregate ] .      in this appendix",
    "we give a very brief derivation of the model we used .",
    "for a more complete overview , we refer , e.g. , to the book by may and khn @xcite .      for each monomer @xmath6 we take into account its electronic ground state @xmath203 and one excited electronic state @xmath204 . the transition energy between these two states is denoted by @xmath205 .",
    "each monomer has a collection of vibrational modes comprising internal ones as well as modes of the local environment of the chromophore .",
    "we will refer to these degrees of freedom as `` the bath '' .",
    "we choose the vibrational modes to be harmonic and consider a linear coupling of the electronic excitation of monomer @xmath6 to these bath degrees of freedom ( making contact to previous work  @xcite ) .",
    "the hamiltonian of monomer @xmath6 is then given by @xmath206 with the hamiltonian of the vibrations in the electronic ground state @xmath207 ( the energies of the vibrational ground states of all modes in the electronic ground state are chosen to be zero ) .",
    "the excited state hamiltonian of monomer @xmath6 is written as @xmath208 here @xmath209 ( @xmath210 ) denotes the creation ( annihilation ) operator of the local mode @xmath12 of monomer @xmath6 with frequency @xmath57 .",
    "the corresponding coupling strength between the electronic excitation of monomer @xmath6 and this mode is denoted by @xmath211 .",
    "the resulting hamiltonian @xmath212 can be interpreted in terms of two multidimensional shifted harmonic potential energy surfaces ( see fig .",
    "[ fig : shifted_ho ] ) .",
    "this interpretation is discussed , e.g. , in refs .",
    "@xcite .",
    "if the spectral density consists of only a few modes @xmath12 ( or equivalently , it is a sum of a few delta - peaks ) , these modes can be considered as coming from a model of the monomer that consists of ( multitimensional ) harmonic born - oppenheimer surfaces where ground and excited state have the same shape but are shifted with respect to each other .",
    "the freqencies appearing in the spectral density are then simply the frequencies of the harmonic potentials ( in the different directions ) and the coupling strength @xmath213 is related to the shift of the potentials @xcite .",
    "peaks in the spectral density that are not delta - like but broadened can arise due to internal vibrational modes ( as described above ) that are damped by an environment .",
    "this model is discussed , e.g. , in ref .",
    "@xcite .    beside internal vibrations of the monomers also",
    "environmental fluctuations can lead to peaks in the spectral density .",
    "this is discussed , e.g. , in refs .",
    "@xcite .",
    "the total hamiltonian of the aggregate is a sum of the hamiltonians eq .",
    "( [ app : h_n ] ) of the individual monomers and the dipole - dipole interaction operator between them .",
    "taking matrix elements in the basis eq .",
    "( [ elgroundstateagg ] ) and eq .",
    "( [ pi_n_states ] ) we find for the electronic ground state hamiltonian @xmath214 and for the hamiltonian in the electronically excited state @xmath215 with the matrix elements @xmath15 of the interaction operator which are taken to be independent of environmental ( nuclear ) coordinates .",
    "note that @xmath216 and @xmath217 depend on nuclear coordinates through eqs .",
    "( [ hammonground ] ) and ( [ hammonexc ] ) . with the hamiltonians of the monomers eqs .",
    "( [ hammonground ] ) and ( [ hammonexc ] ) we can write eq .",
    "( [ hamtotexc ] ) as eq .",
    "( [ heassysplusintplusenv ] ) of the main text .",
    "the transition dipole operator @xmath26 of monomer @xmath6 is assumed to be independent of nuclear ( environmental ) coordinates and is written as @xmath27 here , @xmath28 denotes the transition dipole moment of monomer @xmath6 ( see , e.g. , ref .",
    "the dipole operator of the aggregate is given by the sum @xmath29 this is the basic quantity that enters the calculation of optical spectra .",
    "the transition strength for the linear optical spectra can be obtained from a half - sided to negative times such that @xmath30 , the transition strength can be calculated as @xmath31 fourier transformation @xcite @xmath32 the explicit form of the correlation function @xmath33 will be specified below for the case of absorption and cd .",
    "the total initial state of system and bath prior to light absorption is taken as @xmath34 where the aggregate is in its electronic ground state eq .",
    "( [ elgroundstateagg ] ) and the bath is in a thermal state at temperature @xmath35 , i.e.   @xmath36 with the inverse temperature @xmath37 . in eq .",
    "( [ eq : rho_th ] ) , @xmath38 denotes the trace over the bath degrees of freedom .",
    "since for the molecules we have in mind ( e.g.  chlorophyll or cyanine dyes ) the electronic transition energies are on the order of an ev , one can safely ignore thermally excited electronic states , as has been done in eq .",
    "( [ eq : rho_0 ] ) .    in order to calculate the correlation function @xmath33 in eq .",
    "( [ eq : spectrum ] ) we introduce a correlation operator @xmath39 in the electronic system defined by @xmath40 with the propagators for system and bath , @xmath41 in the respective electronic states .",
    "in linear response theory , one can then calculate @xmath33 in eq .",
    "( [ eq : spectrum ] ) for the absorption spectrum of an isotropically oriented sample as @xmath42 where @xmath43 is a matrix in the electronic system with matrix elements @xmath44 and the dot denotes the real scalar product .",
    "similarly , for the cd spectrum within the rosenfeld formalism @xcite one has @xmath45 where the matrix elements of @xmath46 are given by @xmath47 here , @xmath48 denotes the distance vector between monomers @xmath6 and @xmath16 .",
    "the validity of the rosenfeld approximation and a more appropriate formula for large aggregates with considerable excitonic delocalization are discussed in @xcite . in appendix",
    "[ sec : c(t ) ] short derivations of @xmath49 and @xmath50 can be found .      in order to evaluate the expression @xmath39 defined in eq .",
    "( [ eq : def : c_nm ] ) we use the thermofield approach @xcite : the thermal initial state @xmath51 of the environment is mapped onto the ( pure ) ground state @xmath52 ( later denoted as `` thermal vacuum '' ) of an enlarged environment with suitably constructed creation and annihilation operators , as detailed below .",
    "the calculation of @xmath39 , which will be discussed in the following section  [ sec : abs_in_qsd ] , then proceeds analogously to the temperature zero case  @xcite . in this subsection",
    "we sketch briefly the procedure for the mapping to the enlarged bath , following the treatment of refs .",
    "@xcite :    first , in addition to the physical bath operators @xmath53 one introduces independent ` fictitious ' negative frequency bath operators @xmath54 resulting in the expression @xmath55 for the new environmental hamiltonian , with @xmath56 and the same ( negative ) frequencies @xmath57 as for the physical bath @xmath17 . with the bar , as in eq .",
    "( [ eq : def : h_env_thermofield ] ) , we indicate that the hamiltonian contains the additional @xmath58-bath . as a consequence ,",
    "the number of degrees of freedom of the new bath hamiltonian @xmath59 is twice that of the original one .",
    "the desired state @xmath52 in the doubled - bath hilbert space is now constructed such that one recovers the correct thermal equilibrium state @xmath51 defined in eq .",
    "( [ eq : rho_th ] ) for the physical @xmath60 bath after tracing out the fictitious @xmath58 degrees of freedom , i.e.   @xmath61 note that the additional degrees of freedom do not alter the dynamics , because they are uncoupled from the physical ones . through a ( temperature - dependent ) bogoliubov transformation of the bath operators @xmath62 and @xmath63 one defines so - called thermal bath annihilation operators @xmath64 and their corresponding adjoint creation operators . here",
    ", @xmath65 is the mean thermal occupation number of the physical mode @xmath12 of monomer @xmath6 .",
    "the thermal operators fulfill the same bosonic commutation relations as the original @xmath60 and @xmath58 operators and thus create their own harmonic oscillator algebra . as a result , the thermal annihilation operators @xmath66 and @xmath67 annihilate the thermal vacuum @xmath68 . here",
    "@xmath69 is a shorthand notation for the product vector of all environmental @xmath70 oscillators being in their vacuum state @xmath71 respectively , i.e. @xmath72 ( and the analogous expression for @xmath73 ) .",
    "the extended environmental hamiltonian with the untransformed bath operators expressed in terms of the thermal bath operators now reads @xmath74 for the electronic ground state hamiltonian one thus obtains @xmath75 whereas for the electronically excited state one gets @xmath76 with @xmath77      to evaluate the expression eq .",
    "( [ eq : def : c_nm ] ) for the correlation operator @xmath39 we apply the thermofield approach outlined in the previous section and insert @xmath51 from eq .",
    "( [ eq : thermal_vacuum ] ) into eq .",
    "( [ eq : def : c_nm ] ) to obtain @xmath78 here , @xmath79 denotes the trace over the original environmental degrees of freedom and @xmath80 is , as in eq .",
    "( [ eq : thermal_vacuum ] ) , the trace over the negative frequency oscillators .",
    "inserting @xmath81 , where @xmath82 is the hamiltonian for the additional bath degrees of freedom defined in eq .",
    "( [ eq : def : h_b ] ) , between the two propagators and rearranging the trace yields @xmath83 analogous to eq .",
    "( [ eq : def : u ] ) , the propagators are defined as @xmath84 and @xmath85 with @xmath86 and @xmath87 given by eqs .",
    "( [ eq : bar_h_g ] ) and ( [ eq : bar_h_e ] ) .",
    "note that the trace is over the full doubled - bath hilbert space .",
    "since @xmath88 , performing the trace leads to @xmath89    the aim in the following is to derive an evolution equation for @xmath39 that can be handled numerically in an efficient way . to this end",
    "we expand the environmental part of the hilbert space in terms of bargmann coherent states  @xcite @xmath90 and @xmath91 of the @xmath92 and @xmath93 vibrations . here the @xmath94 as well as the @xmath95 are complex numbers . defining @xmath96 , and @xmath97 ( and the corresponding expressions for @xmath98 )",
    "the completeness relations for the bargmann states are given by  @xcite @xmath99    using this expansion , one can derive an evolution equation @xcite for a quantity from which @xmath39 can be obtained .",
    "the general form of the resulting equations , which also hold for system coupling operators that are not hermitian , is discussed in appendix  [ sec : general_equations_of_motion ] . in the following , in order to simplify the notation , we will use the fact that for the present case where @xmath100 the general equation ( [ eq : evoleqreducedpropagator ] ) can be written as ( see appendix  [ sec : general_equations_of_motion ] ) @xmath101 which is the nmqsd equation @xcite in its linear form ( and for hermitian @xmath23 ) , one obtains the well - known markovian qsd equation @xcite ( here in its linear form ) . ] with the reduced propagator @xmath102 and the initial condition @xmath103 . in eq .",
    "( [ evoleqreducedpropagator ] ) @xmath104 is the bath correlation function of monomer @xmath6 given by @xmath105 and the @xmath106 are defined as @xmath107 the numbers @xmath108 are defined in appendix  [ sec : general_equations_of_motion ] and combine @xmath109 and @xmath110 .",
    "the factors @xmath111 and frequencies @xmath112 are also defined in appendix  [ sec : general_equations_of_motion ] .",
    "note , that the @xmath106 are deterministic time - dependent complex functions .",
    "however , in refs .",
    "@xcite they play the role of stochastic processes driving the evolution of the system  a viewpoint that is not necessary for this paper .",
    "nonetheless , later on in this work we will also call @xmath106 a stochastic process .",
    "it is important to note that the @xmath113 have the same basic properties as the @xmath114 and @xmath115 , in particular @xmath116 . the reduced propagator @xmath117 is analytic in @xmath118 because of the properties of the bargmann states @xcite and we can taylor expand it resulting in @xmath119 note that the @xmath118-independent part @xmath120 is the same as in eq .",
    "( [ eq : g_zeta_xi_taylor ] ) and that eq .",
    "( [ eq : c(t)=g^(0)(t ) ] ) still holds .",
    "analogous to eqs .",
    "( [ eq : correlation_operator_with_g_of_zeta_xi ] ) and ( [ eq : c(t)=g^(0)(t ) ] ) we have @xmath121    using eq .",
    "( [ evoleqreducedpropagator ] ) , we will derive an evolution equation for @xmath39 , in the following .",
    "equation  ( [ evoleqreducedpropagator ] ) is exact .",
    "it describes the full evolution of the electronic system in the excited state manifold coupled to the environment .",
    "note , however , that the appearance of the functional derivative in eq .",
    "( [ evoleqreducedpropagator ] ) renders a general solution very difficult , even though for the case of absorption considered here we are only interested in @xmath120 , which is independent of the complex numbers ( stochastic processes ) @xmath106 .",
    "there are only a few cases where exact solutions to eq .",
    "( [ evoleqreducedpropagator ] ) are known @xcite . in general",
    ", it might not even be possible to derive an exact closed equation for @xmath122 , but we can still make use of the integrals over the environmental degrees of freedom in eq .",
    "( [ eq : correlation_operator_with_g_of_z ] ) in order to find a tractable expression for @xmath39 that does not involve the @xmath106 anymore .    to achieve this",
    ", we first note that using eq .",
    "( [ eq : correlation_operator_with_g_of_z ] ) we find from the evolution equation  ( [ evoleqreducedpropagator ] ) for the reduced propagator @xmath117 ( for the considered case of self - adjoined coupling ) the evolution equation @xmath123 for the correlation operator @xmath39 .",
    "using @xmath124 , the integrals in the first two terms can be performed and eq .",
    "( [ evoleqcorrelatorwithnoise ] ) can be rewritten to @xmath125 the second term in eq .",
    "( [ evoleqcorrelatorwithnoise ] ) vanishes , because @xmath117 is analytic in @xmath118 and thus its product with @xmath106 is a sum of powers of the form @xmath126 .",
    "the difficult third term still prevents us from having a closed equation for @xmath39 . to tackle this problem",
    ", we show an approach in section  [ sec : treat_func_deriv ] , which leads to a system of ( infinitely many ) coupled equations from which @xmath39 can be approximated numerically .",
    "a second approach that can often be useful and has been employed in the past is outlined in appendix  [ sec : zofe - approach ] .        in our previous work @xcite",
    "we used an ansatz for the functional derivative @xmath127 .",
    "this ansatz is briefly discussed in appendix  [ sec : zofe - approach ] .",
    "however , it is not _ a priori _ clear that this ansatz is always justified .",
    "recently , we developed a scheme that does not use the abovementioned ansatz ( see eq .",
    "( [ eq : def : oop ] ) ) to treat the complicated last term in eq .",
    "( [ evoleqcorrelatorwithnoise ] ) .",
    "this scheme leads to an exact solution of the original problem that can be handled numerically in an efficient way .",
    "details can be found in ref .",
    "@xcite .    in this approach , termed _ hierarchy of pure states _",
    "( hops ) @xcite , one introduces a new operator for the whole memory integral in eq .",
    "( [ evoleqcorrelatorwithnoise ] ) and defines @xmath128 the integral boundaries @xmath129 and @xmath130 from eq .",
    "( [ evoleqreducedpropagator ] ) are recovered later using the initial condition for @xmath117 and requiring causality .",
    "the label @xmath131 in eq .",
    "( [ eq : g_t_hops ] ) is a matrix that has dimension ( number of monomers ) @xmath132 ( number of terms in the bath correlation function ) .",
    "it has a @xmath133 at position @xmath134 and is zero otherwise .",
    "in the following we will map this matrix onto a vector which we denote by @xmath135 .",
    "for these operators @xmath136 one can again derive an evolution equation that leads to a ( formally exact ) hierarchy of coupled equations of motion .",
    "for a practical implementation we expand / approximate the bath correlation functions @xmath137 given in eq .",
    "( [ eq : def : alpha_with_lambda ] ) as sums of exponentials @xmath138 where @xmath139 with complex frequencies @xmath140 and prefactors @xmath141 that may also be complex . as demonstrated in ref .",
    "@xcite , such a decomposition can be made to handle ohmic as well as superohmic spectral densities at finite temperatures by using appropriate fitting routines .",
    "for the bath correlation functions defined in eqs .",
    "( [ eq : def : alpha_decomposition ] ) and  ( [ eq : def : alpha_nj ] ) one finds @xmath142 the vector @xmath143 in eq .",
    "( [ eq : hops_exps ] ) labels the different orders of the hierarchy ( we speak of a term of @xmath144th order when @xmath145 ) . in eq .",
    "( [ eq : hops_exps ] ) the @xmath144th order terms are connected to terms that differ by one order ( as explained above @xmath146 denotes the ( @xmath147)th unit vector , where @xmath6 labels the monomers and @xmath148 the terms of the bath correlation function ) . this scheme ( applied to wave functions instead of the reduced propagators )",
    "has been developed in @xcite . there , also",
    "an appropriate closure of the hierarchy is discussed .    since all the @xmath149 are analytic functions in @xmath150 , one obtains ( see also the argument leading from eq .",
    "( [ eq:_func_expansion_o - op ] ) to eq .",
    "( [ evoleqcorrelatorwithoutnoise ] ) ) an equation for @xmath39 which is independent of the time - dependent complex numbers ( stochastic processes ) @xmath151 . with the definition @xmath152 one finds @xmath153 and",
    "the desired correlation operator @xmath39 is @xmath154    note that from eq .",
    "( [ eq : c(t)_hops ] ) it is apparent that for hermitian coupling operators @xmath23 the ( finite temperature ) bath correlation functions @xmath155 given by eq .",
    "( [ eq : def : alpha_with_lambda ] ) are the only `` environmental quantities '' that are needed for the open system dynamics . in eq .",
    "( [ eq : def : alpha_with_lambda ] ) only the original positive frequency oscillators enter , so that in practice the doubling of the hilbert space for the treatment of finite temperatures does not lead to increased numerical difficulties or a worse scaling of the method .",
    "however , for non - hermitian coupling operators @xmath23 one truly needs two separate bath correlation functions per monomer as explained in appendix  [ sec : general_equations_of_motion ] .",
    "note that one can also obtain @xmath39 by independently propagating the initial states @xmath156 .",
    "the matrix elements @xmath157 are then given by @xmath158 , where @xmath159 denotes a vector obtained by propagating eq .",
    "( [ eq : c(t)_hops ] ) or eq .",
    "( [ evoleqcorrelatorwithoutnoise ] ) for a _ vector _ instead of a matrix and with the initial condition @xmath160 .",
    "( see also appendix  [ sec : dimer ] , where we use this scheme explicitly for a molecular dimer . )",
    "in this section we present calculated absorption and cd spectra to illustrate a typical situation for which the present approach can be used .",
    "we do not aim at a detailed interpretation of the spectra and also do not intend to give an investigation of the speed of convergence of hops with the order of the hierarchy , here .",
    "general convergence properties of hops have been discussed in the supplemental material of ref .",
    "@xcite .",
    "all spectra shown in this work are calculated using the hops approach with order @xmath161 and can be considered to be converged .",
    "we consider the simplest case of an aggregate , i.e.  a dimer composed of two monomers .",
    "the interaction @xmath162 between the two monomers in eq .",
    "( [ h_sys ] ) we denote by @xmath163 .",
    "we take the electronic transition energies and spectral densities to be equal for both monomers ( @xmath164 and @xmath165 ) and consider their local environments to be uncorrelated .",
    "since in this work our concern is not the detailed investigation of the dependence of the spectra on the orientation of the monomers , we restrict the geometry of the dimer by taking the transition dipoles of the monomers perpendicular to the distance vector @xmath166 between them .",
    "then the angle @xmath167 between the monomers is sufficient to describe the geometry , which is sketched in fig .",
    "[ fig : dimer_sketch ] .",
    "if @xmath167 is not equal to @xmath129 or @xmath168 then the system has chirality and shows a cd signal .",
    "sketch of the considered geometry . +",
    "a : the chosen coordinate system .",
    "the centers of the two molecules are located on the @xmath169-axis separated by the distance @xmath170 .",
    "the two transition dipoles are also located at these points and perpendicular to the @xmath169-axis .",
    "their directions contain all information about the molecular orientations necessary for the calculation of optical spectra .",
    "+ b : specification of the geometry used for the spectra shown . ]    the coupling to the ( vibrational ) environment we describe by a continuous spectral density . for the example calculations shown below the spectral density is chosen to be of the simple anti - symmetrized lorentzian form @xmath171 for which the corresponding bath correlation function is known analytically @xcite as a sum of exponentials of the form eq .",
    "( [ eq : def : alpha_decomposition ] ) . in order to calculate the bath correlation function for different temperatures , we use the method described in ref",
    ".  @xcite , which is based on a pad approximation @xcite of the hyperbolic cotangent appearing in eq .",
    "( [ eq : def : alpha_with_lambda ] ) .",
    "note that in ref .",
    "@xcite a much larger class of spectral densities was suggested that allow for an analytic determination of the bath correlation function as such a sum of exponentials .",
    "especially , the spectral densities considered there allow one to describe superohmic behavior near @xmath172 . however , in this work we restrict ourselves to the case eq .",
    "( [ eq:_lorentzian_sd ] ) . this spectral density eq .",
    "( [ eq:_lorentzian_sd ] ) shows a linear increase for small @xmath173 and falls off with the third power for large @xmath173 .",
    "it can be approximately interpreted as describing the coupling of an electronic transition to a damped molecular vibration with frequency @xmath174 , where the damping is described by the constant @xmath175 .",
    "problems of this interpretation are discussed in ref .",
    "the prefactor @xmath176 is connected to the so - called reorganization energy @xmath177 by @xmath178 .",
    "[ fig : spd ] shows a plot of the spectral density for two different width parameters @xmath175 .",
    "all quantities are expressed in units of the central frequency @xmath174 .    in the following we present spectra of dimers as well as the corresponding spectra of the uncoupled monomers .",
    "note that the parameters in this work have been deliberately chosen such that the previously used zofe approximation ( see appendix  [ sec : zofe - approach ] ) does not give reliable results in most of the cases ( i.e.  we choose a relatively strong reorganization energy @xmath179 and a small environmental damping @xmath175 ) .",
    "for the reorganization energy @xmath180 and two different width parameters @xmath175 ( all energies are in units of @xmath174 ) .",
    "+ b : possible interpretation in terms of shifted harmonic born - oppenheimer surfaces for one vibrational coordinate @xmath181 . see appendix  [ app : aggregate ] for details . ]    [ fig : shifted_ho ]      for linear optical properties of molecular aggregates , many general results for the interpretation of absorption and cd can be found in the book by rodger and nordn @xcite .",
    "for the special case of a dimer with internal vibrations of the monomers we refer in particular to ref .",
    "@xcite .    to demonstrate the influence of temperature we present some exemplary spectra that we obtain for the spectral density eq .",
    "( [ eq:_lorentzian_sd ] ) at various temperatures .",
    "we take two pad expansion terms for the hyperbolic cotangent into account for all temperatures . only for @xmath182 and @xmath183",
    "we take three expansion terms .",
    "we show absorption and cd spectra for two uncoupled ( monomer case ) and two coupled ( dimer case ) monomers at different temperatures for two spectral densities with width parameter @xmath184 ( fig .",
    "[ fig : temp_dep_01 ] ) and @xmath183 ( fig .",
    "[ fig : temp_dep_03 ] ) . in the left column of each figure the linear absorption for @xmath185 ,",
    "i.e.  for uncoupled monomers , is shown . in the middle and right columns we plotted linear absorption and cd spectra for a dimer with @xmath186 and @xmath187 .",
    "for non - interacting monomers , which do not possess a cd of their own , the cd vanishes , as expected .",
    "it is well known ( and for the present formalism stated in appendix  [ sec : dimer ] ) that for the chosen geometry the absorption and cd spectrum can be understood by considering the correlation functions of the symmetric and antisymmetric parts of the dimer wave function . in the absorption spectrum",
    "the angle @xmath167 enters as a weighting of the two contributions , in the cd spectra @xmath167 only scales the absolute values .",
    "note that if the interaction between the monomers is of point - dipole - dipole type , then @xmath167 also enters in the interaction strength via @xmath188 .",
    "we have chosen the sign of @xmath163 to be consistent with this type of interaction . in the plots we show the symmetric and anti - symmetric contributions to the spectra ( weighted by their @xmath167-dependent prefactor ) , which we obtain from eq .",
    "( [ eq:_c_abs_plus_minus ] ) for absorption and eq .",
    "( [ eq:_c_cd_plus_minus ] ) for cd , as colored lines ( red and green , respectively ) and the resulting absorption and cd spectra as black curves .",
    "the absorption spectra are normalized to have an area of @xmath189 .",
    "note that the integral over the cd spectra vanishes , as it should . in absorption",
    ", the red curve can be understood as the absorption of light polarized along the @xmath190-axis and the green curve as the spectrum for light polarized along the @xmath191-axis .",
    "first we take a brief look at the situation @xmath185 , i.e.  uncoupled monomers , depicted in the left columns of figs .",
    "[ fig : temp_dep_01 ] and  [ fig : temp_dep_03 ] . in fig .",
    "[ fig : temp_dep_01 ] we see for the monomer case a ` vibrational progression ' corresponding to the ( broadened ) mode @xmath174 of the spectral density ( peaks at @xmath192 ) . with increasing temperature ( from top to bottom )",
    "the spectrum becomes broader .",
    "additionally , absorption at lower energies than the one of the dominating 0 - 0 transition of the mode @xmath174 ( peak at @xmath193 ) increases ( hot bands ) .",
    "the black , red and green curve obviously have the same shape .",
    "let us now consider the dimer case .",
    "we choose a positive dipole - dipole coupling @xmath186 and an angle @xmath187 between the monomer transition dipoles .",
    "absorption and cd spectra for this case are shown in the middle ( absorption ) and right ( cd ) columns of figs .  [",
    "fig : temp_dep_01 ] and  [ fig : temp_dep_03 ] .",
    "one sees that the dimer spectra contain a lot more structure compared with the monomer spectra .",
    "this complicates the interpretation of measured spectra , since one might for example be tempted to interpret the second peak from the left in the dimer absorption spectra as belonging to a vibrational progression with the lowest peak .",
    "methods to extract the usually unknown geometry of the dimer with many vibrational modes from absorption and cd are discussed in refs .",
    "as in the monomer case increasing the temperature leads to a broadening of the spectra .    for the larger value of the width parameter @xmath175 we see in fig .",
    "[ fig : temp_dep_03 ] that the features in the spectra are broadened and smeared out already for the lower temperatures so that less structure of the spectra is visible , as one expects .",
    "temperature dependence of absorption for monomer ( left column ) and dimer ( middle column ) as well as cd ( right column ) .",
    "parameters are @xmath194 , @xmath195 , and @xmath196 ( for the dimer ) .",
    "the temperatures are from top to bottom : @xmath197 @xmath198 .",
    "the red and green curves show the two weighted contributions from the symmetric and antisymmetric parts of the dimer wave function ( see appendix  [ sec : dimer ] ) and the black curves show the resulting absorption and cd spectra .",
    "the zero on the abscissa is chosen as the center of mass of the monomer spectrum in each row .",
    "absorption spectra are given in units of @xmath199 and cd spectra in units of @xmath200 . ]",
    "same as fig .",
    "[ fig : temp_dep_01 ] , but for @xmath183 . ]",
    "in this work we have shown how to calculate linear optical spectra ( in particular absorption and cd ) of molecular aggregates using the nmqsd formalism .",
    "one key aspect was to demonstrate that , while the nmqsd formalism in general requires to calculate many stochastic trajectories , for the calculation of linear optical properties one deterministic propagation is sufficient . to this end",
    "we have mapped the finite temperature case to effective temperature - zero equations for which the stochastics drops out .",
    "we summarize the relevant equations that we used to calculate the transition strength @xmath201 for linear absorption and cd spectra .",
    "the transition strengths are calculated from eq .",
    "( [ eq : spectrum ] ) with the correlation function eq .",
    "( [ eq : def : c_abs ] ) for absorption and eq .",
    "( [ eq : def : c_cd ] ) for cd .",
    "these formulas are for isotropically oriented samples .",
    "however , one can also easily treat the case of oriented samples and light of various polarizations  ( see eq .",
    "( [ eq_app::c_t_full ] ) in appendix  [ sec : c(t ) ] ) .",
    "similar to the treatment in ref .",
    "@xcite one can also go beyond the long wavelength approximation . in all cases one has to calculate the same correlation operator @xmath39 given in its general form in eq .",
    "( [ evoleqcorrelatorwithnoise2 ] ) . to solve this equation , in the present work we used the hops formalism , which leads to the hierarchy of correlation operators",
    "( [ eq : c(t)_hops ] ) whose solution is equivalent to the solution of eq .",
    "( [ evoleqcorrelatorwithnoise2 ] ) . here , one sees explicitly that a single trajectory with @xmath202 is sufficient to obtain the required spectra .    in a similar manner",
    "one can show that also for the zofe approximation ( for details see appendix  [ sec : zofe - approach ] ) only a single trajectory is required . while hops allows for a numerically exact treatment , zofe is computationally much less demanding and yields in many situations of interest very good agreement with the exact result .    as application of the presented formulas we have in mind aggregates typically composed of organic molecules ( monomers ) .",
    "in each monomer the electronic excitation naturally couples to nuclear vibrations of the molecule .",
    "typically , due to interaction with external vibrations , those intramolecular vibrations are damped , which manifests itself in broadened peaks in the spectral density .",
    "this then leads in general to broadened vibrational progressions in the absorption spectra of the single molecules . in molecular aggregates",
    ", however , the electronic interaction between the molecules leads to non - trivial spectra , where the identification of vibrational progressions can be complicated .",
    "the method presented in this work is well - suited to calculate optical properties of molecular aggregates at finite temperatures with explicit inclusion of vibrational modes .",
    "we have shown exemplarily for the case of a dimer how our method can be used .",
    "in this section , the expressions eqs .",
    "( [ eq : def : c_abs ] )  and  ( [ eq : def : c_cd ] ) for the correlation function entering eq .",
    "( [ eq : spectrum ] ) for the absorption strength are derived . for linear absorption",
    "the orientation averaged dipole - autocorrelation function that needs to be evaluated @xcite reads @xmath218 with @xmath219 being the corresponding heisenberg operator for the dipole operator of the aggregate defined in eq .",
    "( [ eq : dip_op_agg ] ) and @xmath220 the total initial density operator of system and environment defined in eq .",
    "( [ eq : rho_0 ] ) .",
    "the dot denotes the scalar product of the vector operators in eq .",
    "( [ eq_app : c_t_muk ] ) , where the time - dependence of the heisenberg operator @xmath219 is given by @xmath221 with @xmath222 and @xmath223 being the full aggregate hamiltonian defined in eq .",
    "( [ eq : h_agg ] ) .",
    "the matrix elements of the ( time - independent ) dipole operator @xmath224 between the basis states eqs .",
    "( [ elgroundstateagg ] )  and  ( [ pi_n_states ] ) are @xmath225 inserting eq .",
    "( [ eq : rho_0 ] ) for @xmath220 into eq .",
    "( [ eq_app : c_t_muk ] ) and evaluating the partial trace over the electronic system degrees of freedom yields @xmath226 after expanding @xmath224 and @xmath227 in terms of the basis states @xmath228 and @xmath229 using eqs .",
    "( [ eq : matrix_elements_mu ] )  and  ( [ eq : def : u ] ) , equation simplifies to @xmath230 with @xmath157 given by eq .",
    "( [ eq : def : c_nm ] ) .",
    "this is eq .",
    "( [ eq : def : c_abs ] ) from the main text .    for calculating cd",
    "one needs to include the polarization and relative phases of the electric field @xmath231 with @xmath232 the complex valued polarization vector ( @xmath233 ) and @xmath234 the wave vector . following the above derivation",
    "the final expression now reads @xmath235 the cd signal is obtained by taking the difference of left and right polarized light .    in the often used rosenfeld formalism @xcite , which essentially corresponds to the approximation @xmath236 the expression for cd is @xmath237 with @xmath238 and @xmath239 as defined above . here again an orientational averaging was done to get the final expression , which is eq .",
    "( [ eq : def : c_cd ] ) from the main text .",
    "note that applying the long wavelength approximation and performing an orientational averaging of yields again eq .  .",
    "we insert the completeness relations eq .",
    "( [ eq : completeness_bargmann ] ) in eq .",
    "( [ eq : correlationoperatorthermofield ] ) for the correlation operator and obtain @xmath240 where we defined the reduced propagator @xmath241 to obtain eq .",
    "( [ eq : def : g_zeta_xi ] ) , we have made use of @xmath242 .",
    "@xmath243 is analytic in @xmath244 and @xmath245 because of the properties of the bargmann states @xcite",
    ". therefore one can taylor expand it with respect to these parameters resulting in @xmath246 inserting this into eq .",
    "( [ eq : correlation_operator_with_g_of_zeta_xi ] ) and noting that @xmath247 ( the same also holds for integrals containing @xmath248 ) , one sees that only the zeroth - order term @xmath120 survives and one obtains @xmath249 it has been shown in ref .",
    "@xcite that there exists an integro - differential equation for @xmath243 which can be used as a starting point to obtain @xmath120 .",
    "we will now first present an evolution equation for the general propagator @xmath243 defined in eq .",
    "( [ eq : def : g_zeta_xi ] ) .",
    "since that equation holds even for system coupling operators that are not necessarily hermitian , we use the symbol @xmath22 in appendix  [ sub : general_propagator ] in order to distinguish them from the hermitian operators @xmath23 . after presenting the general equations",
    ", we treat the special case of hermitian system - bath coupling operators @xmath250 and derive eq .",
    "( [ evoleqreducedpropagator ] ) .",
    "we start by differentiating eq .",
    "( [ eq : def : g_zeta_xi ] ) with respect to time and obtain the evolution equation @xmath251 with @xmath87 given in eq .",
    "( [ eq : bar_h_e ] ) .",
    "( note : unlike the full excited state propagator @xmath252 the reduced propagator @xmath253 obtained by projecting on the environmental degrees of freedom is no longer unitary . )    after a transformation to the interaction picture and using the properties of the bargmann representation one obtains the equation of motion @xmath254 with the not necessarily hermitian system coupling operators @xmath22 instead of the @xmath23 in eq .",
    "( [ hint ] ) . in eq .",
    "( [ eq : evoleqreducedpropagator_lambda ] ) we have defined @xmath255    as shown in refs .  @xcite one can pave the way to an efficient stochastic treatment by rewriting this equation according to @xmath256 with initial condition @xmath257 . in eq .",
    "( [ eq : evoleqreducedpropagator ] ) @xmath258 and @xmath259 are time - dependent complex numbers given by @xmath260 and @xmath261 , @xmath262 are defined as @xmath263      for hermitian coupling operators @xmath264 the above equations simplify considerably , since one can now combine the @xmath265 and @xmath266 terms in the summation . introducing the convention that the mode label @xmath12 runs over positive integers ( i.e.  1 , 2 , 3 ,  )",
    "we define new quantities labeled by @xmath267 according to @xmath268 where the upper row holds for @xmath269 and the lower row for @xmath270 .",
    "equation [ eq : evoleqreducedpropagator_lambda ] can then be written as @xmath271 to obtain eq .",
    "( [ evoleqreducedpropagator ] ) we follow the procedure of ref .",
    "@xcite and introduce @xmath272 note that @xmath273 . using @xmath274",
    "one obtains eq .",
    "( [ evoleqreducedpropagator ] ) with the definition @xmath275 noting that @xmath276 and using @xmath277 one finds eq .",
    "( [ eq : def : alpha_with_lambda ] ) .",
    "an often used approximation to treat the functional derivative of the general nmqsd equation is the so - called zofe approximation . for completeness ,",
    "we briefly show in this appendix how also in this approach the stochastics drops out of the equations and we present the final equations in the zofe treatment .",
    "we follow @xcite and use the ansatz @xmath278 where we replace the action of the functional derivative on the reduced propagator @xmath117 in eq .",
    "( [ evoleqcorrelatorwithnoise2 ] ) by a linear operator @xmath279 in the electronic system that acts on @xmath117 . here",
    ", the lower index @xmath6 at the operator @xmath279 indicates that this operator is connected to the coupling operator @xmath23 of monomer @xmath6 . note that in our previous work @xcite we used an upper index instead .    for convenience",
    "we define the auxiliary operators @xmath280 then eq .  ( [ evoleqcorrelatorwithnoise2 ] )",
    "can be written as @xmath281    the operators @xmath282 in eq .",
    "( [ evoleqpsisysspacemitoquer ] ) describe the coupling of monomer @xmath6 to its local environment and implicitly contain temperature through the environmental correlation function @xmath137 under the memory integral in eq .",
    "( [ eq : def : obar ] ) .",
    "the evolution of @xmath283 can be obtained @xcite from the consistency condition @xmath284    we assume that @xmath285 is analytic in @xmath151 and expand it in a taylor series w.r.t .  the time - dependent complex numbers ( stochastic processes ) @xmath151 , which yields @xmath286 with operator - valued expansion coefficients @xmath287 . for these expansion coefficients",
    "one can derive coupled differential equations describing their time evolution @xcite . when evaluating the integral in eq .",
    "( [ evoleqpsisysspacemitoquer ] ) with the expansion eq .",
    "( [ eq:_func_expansion_o - op ] ) all terms with a @xmath151-dependence yield zero .",
    "this is because both @xmath288 as well as @xmath117 are analytic in @xmath151 and therefore in the product @xmath289 only the combination of the two zeroth - order terms is left after the integration in eq .",
    "( [ evoleqpsisysspacemitoquer ] ) .",
    "the resulting equation for the correlation operator @xmath39 reads @xmath290 with , indeed , only the @xmath118-independent zeroth - order o - operator @xmath291 .",
    "note that although only @xmath291 contributes to the evolution equation for @xmath39 , still @xmath291 has to be determined by solving the coupled hierarchy of equations resulting from eqs .",
    "( [ eq : consistency ] ) and  ( [ eq:_func_expansion_o - op ] ) .    to obtain a numerically efficient method ,",
    "previously we have applied an approximation  @xcite , which we denote as ` zeroth - order functional expansion ' ( zofe ) approximation . for the case of absorption",
    "considered here this approximation amounts to neglecting the coupling of the zeroth order to the higher orders in the hierarchy .",
    "the operators @xmath292 are then determined by the auxiliary evolution equation @xmath293\\\\ & + \\sum_m\\big[{{| \\pi_{m } \\rangle}{\\langle \\pi_{m } |}}\\bar{o}_{m}^{(0)}(t),o_{n}^{(0)}(t , s)\\big]\\nonumber\\end{aligned}\\ ] ] with the initial condition @xmath294 .",
    "note that the zofe approximation is exact in several important limiting cases , e.g. , for weak electronic coupling between the monomers , for weak coupling to the environment , as well as in the markov limit .",
    "furthermore , in many parameter regimes relevant for molecular aggregates , the zofe approximation gives very precise results .",
    "we consider a dimer where the transition dipoles of the monomers are perpendicular to the distance vector @xmath295 between them and are rotated by an angle @xmath167 with respect to each other ( see fig .",
    "[ fig : dimer_sketch ] ) .",
    "then the expressions for @xmath296 and @xmath297 , eqs .",
    "( [ eq : a_abs ] ) and  ( [ eq : a_cd ] ) , can be easily evaluated .",
    "we obtain @xmath298 and @xmath299 this leads to @xmath300 , \\\\ c^{\\rm",
    "cd}(t ) & = -r\\mu^2 \\sin \\theta \\big [ \\mathcal{c}_{12}(t ) + \\mathcal{c}_{21}(t ) \\big ] \\label{eq:_c_cd_12}\\end{aligned}\\ ] ] with @xmath301    keeping in mind ( see subsection  [ sub : vector_propagation ] ) that the propagation of @xmath239 is equivalent to propagating the initial state @xmath156 until time @xmath130 and then projecting on the state @xmath229 one can express the above eqs .",
    "( [ eq:_c_abs_12 ] ) and  ( [ eq:_c_cd_12 ] ) in a way which is sometimes more convenient . for the propagation of the wave function one",
    "uses the same equations as for @xmath239 but with the matrix @xmath239 replaced by a vector @xmath302 , where the lower index @xmath16 indicates that the initial condition is @xmath160 . with",
    "this one can write : @xmath303 , \\\\",
    "c^{\\rm cd}(t ) & = -r\\mu^2 \\sin \\theta \\big [ { \\langle \\pi_1| \\psi_{2}(t ) \\rangle}+ { \\langle \\pi_2| \\psi_{1}(t ) \\rangle } \\big].\\end{aligned}\\ ] ] note that @xmath304 is a state which can be obtained by propagating the initial state @xmath305 .    the above formulas can then be rewritten to @xmath306 \\\\ \\label{eq:_c_cd_plus_minus } c^{\\rm cd}(t )    & = -4 r\\mu^2 \\sin \\theta \\big [ { \\langle \\phi_+| \\psi^+(t ) \\rangle } - { \\langle \\phi_-| \\psi^-(t ) \\rangle } \\big].\\end{aligned}\\ ] ] thus , the absorption spectrum can be calculated from a weighted sum of the symmetric and antisymmetric contributions .",
    "the cd spectrum is just the difference of these two contributions with equal weight ."
  ],
  "abstract_text": [
    "<S> non - markovian quantum state diffusion ( nmqsd ) has turned out to be an efficient method to calculate excitonic properties of aggregates composed of organic chromophores , taking into account the coupling of electronic transitions to vibrational modes of the chromophores . </S>",
    "<S> nmqsd is an open quantum system approach that incorporates environmental degrees of freedom ( the vibrations in our case ) in a stochastic way . </S>",
    "<S> we show in this paper that for linear optical spectra ( absorption , circular dichroism ) _ no stochastics _ is needed , even for finite temperatures . </S>",
    "<S> thus , the spectra can be obtained by propagating a _ single _ trajectory . to this end </S>",
    "<S> we map a finite temperature environment to the zero temperature case using the so - called thermofield method . </S>",
    "<S> the resulting equations can then be solved efficiently by standard integrators . </S>"
  ]
}