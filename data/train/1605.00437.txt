{
  "article_text": [
    "we consider full discretization methods for the time - dependent schrdinger  poisson equation , which typically arises in models of quantum transport  @xcite .",
    "our approach relies on a second - order strang splitting time discretization combined with a conforming @xmath0 finite element space discretization .",
    "the motivation for the proposed solution method is that separate treatment of the nonlinear part suggests the application of special solvers for the poisson equation , which are particularly efficient in the context of an underlying finite element space discretization . for this purpose",
    "it is common to truncate the unbounded spatial domain to a sufficiently large finite domain and impose homogeneous dirichlet boundary conditions .",
    "indeed , the evaluation of the nonlocal convolution integral in the standard formulation generally implies a huge computational effort caused by the suitable treatment of the singular integral kernel for the evaluation on a large domain . by the splitting approach",
    ", we can separately treat the poisson equation by appropriate methods where optimized linear solvers are available as for instance multigrid or domain decomposition methods  @xcite .",
    "the finite element discretization additionally enables a solution on a solution - adapted non - uniform spatial grid , which can be updated in the course of the time integration  @xcite .",
    "our main objective is to provide an error analysis for this full discretization , showing the expected second - order convergence of the strang splitting method and polynomial spatial error decay corresponding with the finite elements employed . by using gauss ",
    "lobatto nodes , the setup of the stiffness matrix is exact ; the errors arising in the construction of the mass matrix and the right - hand side are of higher order than the discretization error and therefore will not be taken into account .",
    "[ [ splitting - methods ] ] splitting methods + + + + + + + + + + + + + + + + +    the computational advantages of operator splitting methods for the time integration of problems in quantum dynamics have been emphasized in recent literature . a comprehensive overview of investigations for time - dependent gross ",
    "pitaevskii equations is given in  @xcite , which summarizes most of the studies conducted in this field .",
    "the crank - nicholson finite difference method preserves most of the important invariants like symmetry in time , mass and energy and is unconditionally stable ; however , the computational cost for this fully implicit method is considerable , and the conservation properties only hold up to the accuracy of the nonlinear solver .",
    "semi - implicit relaxation methods which only treat the kinetic part implicitly share the conservation properties if only a cubic nonlinearity is present , but they are still computationally expensive and suffer from stability limitations .",
    "semi - implicit finite difference schemes lose most of the desired properties . for regular solutions , time - splitting methods in conjunction with fourier- or sine - spectral methods",
    "are overall concluded to be the most successful discretization schemes ; they are unconditionally stable , conserve norm , energy , and also dispersion , which is not the case for many other time - stepping schemes . for non - smooth or random spatial profiles ,",
    "the spectral accuracy may be lost , however , and thus splitting methods in conjunction with finite difference spatial discretizations may be more efficient ( see  @xcite ) .    recently , full discretization of the schrdinger  poisson equation by splitting methods in conjunction with spectral space discretization has been investigated in  @xcite , where the long - range interaction is approximated efficiently by nonuniform fast fourier transform ( nufft ) . the authors conclude superior accuracy and performance of their approach in particular over the sine - spectral method .    [ [ error - analysis ] ] error analysis + + + + + + + + + + + + + +    the stability and error behavior of operator splitting methods for the schrdinger ",
    "poisson equation have first been analyzed in  @xcite .",
    "for the structurally similar equations associated with the multi - configuration time - dependent hartree",
    " fock method , a complete convergence analysis of high - order splitting methods has been given in  @xcite .",
    "an error analysis of splitting methods applied to the schrdinger ",
    "poisson equation in the semiclassical regime is provided in  @xcite .",
    "[ [ finite - element - method ] ] finite element method + + + + + + + + + + + + + + + + + + + + +    the literature on finite element spatial discretizations is vast .",
    "finite element methods ( fem ) have been widely used for electronic structure calculations , see for instance  @xcite and  @xcite . for the solution of time - dependent schrdinger equations",
    "see for example  @xcite and the more recent contribution  @xcite , and for atomic and molecular systems see  @xcite for a general review .",
    "[ [ truncation - to - a - finite - domain ] ] truncation to a finite domain + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    in conjunction with the application of the finite element method , the restriction to a finite domain introduces a truncation error which we do not consider in this work .",
    "strategies to cope with related issues have been proposed for instance in  @xcite .",
    "the investigation in the context of the schrdinger ",
    "poisson equation remains an open question .",
    "[ [ outline ] ] outline + + + + + + +    in sec .  [ sec : setting ] we state the schrdinger  poisson equation .",
    "we specify the full discretization method and formulate our main convergence results . in sec .",
    "[ sec : conv - ana ] we provide the underlying comprehensive stability and error analysis .",
    "our numerical illustrations given in sec .",
    "[ sec : num ] confirm the theoretical convergence result and demonstrate that also higher - order splitting methods show their expected behavior .",
    "the appendices contain proof details , important results from the literature which we rely on and auxiliary estimates used in our analysis .",
    "[ [ schrdinger - poisson - equation ] ] schrdinger - poisson equation + + + + + + + + + + + + + + + + + + + + + + + + + + + +    we consider the time - dependent schrdinger - poisson equation for @xmath1 \\rightarrow { \\mathbb{c}},\\,(x , t ) \\mapsto \\psi(x , t)$ ] ,    [ eq : spe ] @xmath2 where @xmath3 , @xmath4 , is a bounded domain with smooth boundary .",
    "we impose homogeneous dirichlet boundary conditions and an initial condition @xmath5 for the subsequent analysis we will assume that the initial state satisfies instead of @xmath6 , etc . ]",
    "the nonlocal nonlinear term @xmath8 describing the electrostatic self - interaction is the solution @xmath9 of the poisson equation under homogeneous dirichlet boundary conditions , @xmath10    the evolution operator associated with problem   will be denoted by @xmath11 , i.e. , @xmath12    [ [ abstract - formulation ] ] abstract formulation + + + + + + + + + + + + + + + + + + + +    introducing the operator notation    [ eq : operator_notation ] @xmath13 we employ a compact formulation of problem   as an abstract evolution equation @xmath14      [ [ subproblems ] ] subproblems + + + + + + + + + + +    for the discretization of   in time we apply exponential operator splitting methods based on the solution of two subproblems , see for instance  @xcite .",
    "* the evolution operator associated with the linear initial value problem + [ eq : ea - all ] @xmath15 is denoted by @xmath16 , such that @xmath17 * the evolution operator associated with the nonlinear initial value problem + [ eq : eb - all ] @xmath18 is denoted by @xmath19 , such that @xmath20 due to the fact that @xmath21 defines a real - valued function and thus @xmath22 the nonlinear equation   reduces to the linear equation @xmath23 + we will also employ a notation analogous to   but with a linear evolution operator @xmath24 depending on @xmath25 and @xmath26 as the solution to @xmath27 such that @xmath28 .",
    "clearly , @xmath29    [ [ strang - splitting - method ] ] strang splitting method + + + + + + + + + + + + + + + + + + + + + + +    our main focus is on the symmetric second - order strang splitting method applied to the splitting according to  , .",
    "that is , for a time increment @xmath30 , the time - discrete solution values @xmath31 are determined by the recurrence    [ eq : strang - splitting ] @xmath32 for notational simplicity we shall employ a formal notation for the @xmath33-fold composition , @xmath34    [ [ weak - formulation - of - the - subproblems ] ] weak formulation of the subproblems + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    in view of full discretization ( see sec .  [",
    "sec : conforming - fem ] ) we consider the following weak formulations of the subproblems . for  , @xmath35 where we require @xmath36 .",
    "[ eq : subproblemweak - b ] for  , @xmath37 where @xmath38 is the solution of the poisson equation in weak formulation , @xmath39    requiring @xmath40 .    in the following we use the standard denotation for the sobolev semi - norms , i.e. , @xmath41 for @xmath42 , and @xmath43 for @xmath44 .",
    "a full discretization arises by solving both initial value subproblems   and   in their weak reformulation   and  , respectively , by means of a finite element method ( fem ) .",
    "[ [ finite - element - space ] ] finite element space + + + + + + + + + + + + + + + + + + + +    for the space discretization of the subproblems , we choose a tessellation  @xmath45 over subdomains @xmath46 , with @xmath47 which are affine - equivalent to a reference domain  @xmath48 . with",
    "@xmath48 we associate a triplet @xmath49 , where the set  @xmath50 comprises the interpolation nodes  @xmath51 , and  @xmath52 is the linear space spanned by the polynomial nodal basis functions @xmath53 of degree  @xmath54 . we require the finite elements to be conforming and quasi - uniform . as common",
    "we choose a linear indexing of the basis functions , @xmath55 .",
    "the subspace spanned by these functions is denoted by @xmath56    [ [ finite - element - interpolation - and - projection ] ] finite element interpolation and projection + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    by @xmath57 we denote the nodal interpolation operator , @xmath58 the rayleigh - ritz projection @xmath59 is defined implicitly by the galerkin orthogonality relation    @xmath60    satisfying @xmath61 by the poincar inequality @xmath62 , this also implies @xmath63 with a constant @xmath64 depending on @xmath65 .",
    "[ rem : ph ] the rayleigh - ritz projection @xmath66 is connected to the finite element approximation in the following way .",
    "consider a poisson problem @xmath67 with homogeneous dirichlet boundary conditions in weak formulation ( see  ) , @xmath68 and its fem discretization by the galerkin equations ( see   below ) , @xmath69 then , @xmath70 i.e. , @xmath71    for a sufficiently smooth boundary , the @xmath72 regularity estimate @xmath73 fully discrete solution and computational representation + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    the full discretization of the schrdinger - poisson equation is based on solving the subproblems  , arising in the strang splitting time discretization by means of a fem / galerkin space discretization . here",
    ", the coefficients associated with the prescribed initial state are determined by interpolation , @xmath74 in each substep of the time propagation by strang splitting , subproblems of the following types  , for the solutions @xmath75 and @xmath76 are solved .    *",
    "[ eq : discretesubproblemweak - a ] for the first subproblem  , @xmath77 is determined from @xmath78 with the ansatz in terms of the basis  , @xmath79 yields the galerkin equations for the coefficients @xmath80 in the form @xmath81 * for the second subproblem  , @xmath82 is determined such that + [ eq : discretesubproblemweak - b ] @xmath83 where @xmath84 is the solution of the discretized poisson problem @xmath85 with the ansatz in terms of the basis  , @xmath86 we obtain the galerkin equations   in the form @xmath87    the above computations imply that the unknown coefficients @xmath88 satisfy systems of linear ordinary differential equations . for a more compact formulation",
    "we introduce the vectors    [ eq : matrix - definition ] @xmath89 and the invertible symmetric matrices @xmath90    in this notation , the system   reads @xmath91 with solution @xmath92 system   takes the form @xmath93 with solution @xmath94 to realize the fully discrete propagation in time according to the strang recurrence  , systems of this type are alternately solved .",
    "[ [ finite - element - operators ] ] finite element operators + + + + + + + + + + + + + + + + + + + + + + + +    we define the discrete laplace operator @xmath95 ( @xmath96 ) and its inverse @xmath97 ( @xmath98 ) via    [ eq : deltah+i - def ] @xmath99    in particular , means that for the solution @xmath25 of @xmath100 we have @xmath101 in the sense of remark  [ rem : ph ] .",
    "moreover , in analogy to   we set @xmath102 in this notation ,    * @xmath103 is associated with subproblem  , * @xmath104 is associated with subproblem  .",
    "for representing the solution @xmath105 of a system of the type @xmath106 we will also employ an analogous notation as for problem  ,    @xmath107    then , analogously as in  , @xmath108    for the resulting fully discrete strang splitting solution we again write @xmath109 determined by the recurrence    [ eq : strang - splitting - h ] @xmath110 and we again employ a formal notation for the @xmath33-fold composition , @xmath111      the central interest of this paper is to establish a convergence result for the splitting finite element discretization of the schrdinger  poisson equation . here",
    "we give a brief overview of the structure of our convergence proof and state the resulting theorem .",
    "the detailed convergence analysis is worked out in sec .  [",
    "sec : conv - ana ] .    in order to study the global error @xmath112 we separate the terms associated with space and time discretization , respectively . with @xmath113 and @xmath114",
    ", we write @xmath115 the first term represents the error attributable to the space discretization and the second term is the splitting error at the semi - discrete level .    the first term in   is expanded into a telescoping sum in the following way :    @xmath116    we combine a stability argument for the fully discrete splitting operator @xmath117 ( see sec .",
    "[ sec : s - stab ] ) with the approximation properties of the finite - element interpolants ( see theorem  [ thm : brenner - scott1 ] ) and the rayleigh - ritz - projection @xmath118 ( see theorem  [ thm : brenner - scott - ph - conv ] )",
    ". what remains to be estimated are terms of the form @xmath119 , which is worked out in sec .",
    "[ sec : interps - err ] ( see theorem  [ thm : semi - discrete - error - space ] )    the second term in   can similarly be recast as @xmath120    here apply a standard argument for estimating the splitting error at the semi - discrete level combining the stability of the splitting operator @xmath121 ( see sec .",
    "[ sec : s - stab ] ) with an estimate for the local splitting error @xmath122 ( see theorem  [ thm : lubich - conv ] or  @xcite ) .",
    "this leads to the following global error bound for the full discretization .",
    "[ thm : convergence - complete ] suppose that @xmath123 , @xmath124 and that @xmath65 is such that   holds .",
    "consider the fully discretized method from   based on the strang splitting scheme and conforming finite elements of degree @xmath54 , then @xmath125 where @xmath126 and @xmath127 . here",
    ", @xmath128 depends on @xmath65 , @xmath129 , the @xmath130- and the @xmath131-norms of @xmath132 .",
    "the proof of theorem  [ thm : convergence - complete ] is based on the combination of theorem  [ thm : semi - discrete - error - space ] for the contribution @xmath133 and on theorem  [ thm : lubich - conv ] for the contribution of @xmath134 .",
    "[ [ conclusions ] ] conclusions + + + + + + + + + + +    from theorem  [ thm : convergence - complete ] , we can deduce the following convergence properties :    * for an initial value @xmath135 , we obtain the classical convergence order in @xmath136 and @xmath137 , @xmath138 * for an initial value @xmath139 , @xmath140 we obtain convergence of order @xmath141 respectively @xmath142 in space , but with a possibly reduced convergence order in time ( depending in the ratio between @xmath143 and @xmath144 ) , @xmath145 where @xmath126 .",
    "we start by separating the effects of space and time discretization , see   and  , and consider bounds in the @xmath146- and @xmath147-norm .    by a lady",
    "windermere s fan argument and the stability estimates from sec .  [",
    "sec : s - stab ] , the expression @xmath148 in   can be expressed by an @xmath149-bound in @xmath147 and an @xmath150-bound in @xmath146 , as shown in the following theorem  [ thm : semi - discrete - error - space ] .",
    "the norms @xmath151 have already been studied in  @xcite and are summarized in theorem  [ thm : lubich - conv ] below .",
    "this implies the main convergence result stated in theorem  [ thm : convergence - complete ] , where error bounds depending on the regularity of the initial values are given .    in our convergence theory",
    "we make use of several stability estimates and consistency results which are collected in sec .",
    "[ sec : s - stab][sec : regularity - full ] below .",
    "several auxiliary results and estimates are collected in the appendix .",
    "[ thm : semi - discrete - error - space ] let @xmath152 for @xmath124 , @xmath153 , and @xmath154 . then for @xmath155 , the @xmath147 and @xmath146 bounds of the semi - discrete error @xmath156 can be bounded in @xmath147 and @xmath146 : @xmath157 where @xmath127 and @xmath128 depends on @xmath129 , @xmath65 , @xmath158 , @xmath159 and @xmath160 .",
    "@xmath161 +    * _ @xmath162-bound .",
    "_ we proceed as indicated at the beginning of sec .",
    "[ sec : outline ] and use the stability properties   of the splitting operator @xmath117 ( see proposition  [ thm : sh - stability ] in sec .",
    "[ sec : s - stab ] ) : + @xmath163 + by the regularity result for the splitting operator @xmath117 , see lemma  [ thm : sh - regularity ] in sec .  [ sec : regularity - full ] , we can ensure the existence of the constant @xmath164 .",
    "the expressions in   can be bounded using theorems  [ thm : brenner - scott1 ] and  [ thm : brenner - scott - ph - conv ] , @xmath165 and by the bound   from proposition  [ thm : hm - regularity ] we obtain @xmath166 it remains to bound @xmath167 . by theorem  [ thm : interps - err ] from sec .",
    "[ sec : interps - err ] , it follows that @xmath168 for @xmath169 , where @xmath128 depends on @xmath129 , @xmath65 , @xmath170 , and @xmath160 .",
    "altogether , we obtain @xmath171 which concludes the proof for the @xmath147 bound . * _ @xmath172-bound . _",
    "analogously as for the @xmath147-bound , we use theorems  [ thm : brenner - scott1 ] and  [ thm : brenner - scott - ph - conv ] and proposition  [ thm : hm - regularity ] and theorem  [ thm : interps - err ] .",
    "hence we obtain + @xmath173 + where the constant @xmath128 depends on @xmath159 , @xmath158 , and @xmath174 .",
    "the following theorem summarizes the semidiscrete error in time :    [ thm : lubich - conv ] suppose that the exact solution @xmath175 to the schrdinger - poisson equation   is in @xmath176 for @xmath177 .",
    "then , the semi - discrete numerical solution @xmath178 given by the strang splitting scheme   with stepsize @xmath136 satisfies    [ eq : lub - proof12 ] @xmath179    where both constants @xmath180 , @xmath181 depend on @xmath182 , @xmath65 , and on the @xmath176-norm of @xmath132 .    the detailed proof can be found in  @xcite with the restriction that @xmath180 and",
    "@xmath181 depend on the @xmath183- respectively the @xmath130-norm of @xmath132 .",
    "for the improved bounds   in @xmath184 we refer to  @xcite and for full details on the computation of the commutators see  @xcite . in our case , the domain @xmath65 is finite , but the analogous sobolev embeddings hold also in this case , see  @xcite .    for the dominant terms",
    "we now show the sharp estimates directly . for the bound",
    ", the dependence on the @xmath183-norm is indicated in  @xcite to arise from a bound of @xmath185 since all other terms are already bounded in terms of @xmath186 , it suffices to estimate this term likewise . using proposition  [ thm : hmin1-est ] we obtain @xmath187 for the bound   in terms of @xmath186 we refer to the bounds given in  @xcite and the improved bounds from  @xcite . for full details on the computation of the commutators involved ,",
    "see  @xcite .",
    "however , the critical term in the commutator bound is identified as @xmath188 for which we will show in detail that it can be bounded in terms of the @xmath176-norm . using a duality argument in @xmath147 and integration by parts we obtain @xmath189          & \\qquad\\qquad \\qquad { } + \\| \\delta \\psi\\,\\|_{l^2}\\,\\| \\psi\\|_{l^\\infty}\\,\\| \\phi\\|_{l^2}\\big)\\,\\cdot\\,\\|\\psi\\|_{h^2 } \\\\          & \\leq c\\,\\sup_{\\|\\phi\\|_{l^2}=1}\\big ( \\| \\psi\\|_{h^2}\\,\\|\\psi\\|_{h^2}\\,\\|{\\delta^{-1}}(\\phi)\\|_{h^2 }          + \\|\\psi \\|_{h^2}\\,\\| \\nabla\\psi\\|_{h^1}\\,\\| { \\delta^{-1}}(\\phi)\\|_{h^2 } \\\\[-2 mm ]          & \\qquad \\qquad \\qquad { } + \\| \\psi\\|_{h^2}\\,\\| \\psi\\|_{h^2}\\,\\|\\phi\\|_{l^2}\\big)\\,\\cdot\\,\\|\\psi\\|_{h^2 }   \\\\          & \\leq c\\,\\| \\psi\\|_{h^2}^3\\ , ,      \\end{aligned}\\ ] ] concluding the proof .      to reduce the analysis of the global error to the study of the splitting error in a single time step , the following stability estimates for the splitting operators @xmath121 and @xmath117 are required . since , analogously as in  @xcite , the @xmath147- and @xmath146-bounds depend on the @xmath146-norms of the numerical solution , we first need a stability and convergence result in @xmath146 to show the @xmath146-boundedness of the numerical solution . we list @xmath147- and @xmath146-bounds together and verify the @xmath147-bounds in hindsight .",
    "[ thm : sh - stability ] the fully discretized splitting operator @xmath117 defined in   enjoys @xmath146-stability and @xmath146-conditional @xmath147-stability ,    [ eq : sh - stability ] @xmath190    for @xmath191 , with @xmath192 , and @xmath128 depending on @xmath137 , @xmath129 , and @xmath65 .    [ thm : s - stability ] the semi - discrete splitting operator @xmath121 defined in   enjoys @xmath146-stability and @xmath146-conditional @xmath147-stability ,    @xmath193    for @xmath194 , with @xmath195 , and @xmath128 depending on @xmath129 and @xmath65 .",
    "our goal is to find an estimate of @xmath196 for two functions @xmath197 , @xmath198 .",
    "* we combine the unitarity of the operators @xmath199 and @xmath200 ( see proposition  [ thm : discrete - conservation ] , and  ) with the linearity of @xmath199 and the definition of @xmath201 with the linear operator @xmath202 from  . with the abbreviations @xmath203 , @xmath204 we obtain + @xmath205 + to estimate the last term we use the mild formulation  , @xmath206 * to find an estimate for the right - hand side in   we denote @xmath207 , @xmath208 , and consider the galerkin equations @xmath209 the difference @xmath210 is again a discrete poisson problem with solution @xmath211 with this observation we obtain for  : @xmath212 proposition  [ thm : dph - l2-est ] in the appendix yields @xmath213 inserting @xmath214 and @xmath215 again and using proposition  [ thm : ebh - h1-est ] yields @xmath216 with @xmath217 we finally obtain @xmath218 with @xmath219 . to show the boundedness of the constant @xmath159 in @xmath146 , we further need the @xmath146 stability result ( proposition  [ thm : sh - stability ] ) , the @xmath146 interpolation error ( theorem  [ thm : interps - err ] ) and the regularity of the @xmath146 solution ( lemma  [ thm : sh - regularity ] ) .",
    "we start similarly as for the @xmath147 case :    we combine the unitarity of the operator @xmath199 in @xmath146 ( see proposition  [ thm : discrete - conservation ] , ) with the linearity of @xmath199 and the definition of @xmath201 with the linear operator @xmath202 from  . with the abbreviations @xmath203 , @xmath204",
    "we obtain    @xmath220    now we separately estimate   and  .",
    "first , from proposition  [ thm : ebh - h1-est ] we obtain for   @xmath221 to obtain a bound for  , we use the linear variation - of - constant formula as in   and proposition  [ thm : ebh - h1-est ] ,    @xmath222          & \\qquad\\qquad\\qquad\\qquad\\qquad\\qquad { } + \\|({\\widehat{b}}_h({\\widetilde{w}}_h ) - { \\widehat{b}}_h(w_h))\\nabla({\\mathcal{e}_{b_h}}({\\sigma},w_h)\\,w_h ) \\|_{l^2 } \\big)\\label{eq : sh - h1-line - d}\\ , .",
    "\\end{aligned}\\ ] ]    for   we use the bound   from corollary  [ thm : dph - h1-est - corollary ] , @xmath223 for   we use in addition  , the @xmath224 bound from theorem  [ thm : brenner - scott1 ] , @xmath225 summarizing , we conclude @xmath226 where @xmath227 and @xmath128 depends on @xmath137 , on @xmath129 , and on @xmath65 . the dependence on @xmath137 for @xmath228 is negligible and will be omitted in the further analysis .    with @xmath217",
    "we finally obtain @xmath229 finishing the proof .",
    "this is conducted analogously to the proof of proposition  [ thm : sh - stability ] , substituting @xmath230 by @xmath26 and @xmath231 by @xmath232 , with the sobolev embedding replaced by hardy s inequality ( see the proof in  @xcite ) , @xmath233 for the proof of @xmath146-stability , which is less involved for @xmath121 than for @xmath117 , we refer to  @xcite .      the aim of this section is to provide an estimate for @xmath234 in the @xmath146- and the @xmath147-norm , which will be presented in theorem  [ thm : interps - err ] . as an essential part of the proof",
    ", we first bound the approximation error of @xmath199 as compared to @xmath235 in these norms .",
    "[ [ l2 - -and - h1-estimates - for - mathcalp_hvarphi_atau --- varphi_a_htau - mathcalp_hu ] ] @xmath147- and @xmath146-estimates for @xmath236 + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    propositions  [ thm : eadiff ] and  [ thm : eadiff - weak ] below specify bounds for @xmath237 as before , @xmath238 denotes the polynomial degree associated with the fem subspace @xmath239 .",
    "proposition  [ thm : eadiff ] requires a higher sobolev regularity of @xmath240 , but offers an additional dependence on @xmath136 , while proposition  [ thm : eadiff - weak ] requires only a sobolev regularity of @xmath241 .",
    "both results can be recast together as @xmath242 where @xmath127 and @xmath155 . here",
    ", the dependence on @xmath243 indicates a reduced approximation quality for @xmath244 .",
    "[ thm : eadiff ] let @xmath245 for @xmath246 .",
    "then , @xmath247 from   satisfies @xmath248 where @xmath128 depends on @xmath129 and @xmath65 and @xmath249 .",
    "[ thm : eadiff - weak ] let @xmath245 for @xmath250 .",
    "then , @xmath247 from   satisfies @xmath251 where @xmath128 depends on @xmath129 and @xmath65 and @xmath155 .    the proof is given after the proof of proposition  [ thm : eadiff ] .",
    "we denote @xmath252 here , @xmath253 , and @xmath254 and @xmath255 are the solutions of @xmath256 setting @xmath257 and subtracting these equations we obtain @xmath258 with @xmath259 this takes the form @xmath260 due to the property   of the rayleigh - ritz projection we have @xmath261 .",
    "thus we obtain @xmath262 adding these equations gives @xmath263 for the left - hand side of   we find @xmath264 and on the right - hand side of   we apply the cauchy - schwarz and hlder inequalities , @xmath265 hence ,   yields the inequality @xmath266 dividing by @xmath267 we obtain @xmath268 now we apply the bound for the projection operator from theorem  [ thm : brenner - scott - ph - conv ] , yielding @xmath269 where @xmath270 is the degree of maximal sobolev regularity of @xmath271 .",
    "now we integrate over @xmath272 from @xmath273 to @xmath274 , @xmath275 and use the differential equation @xmath276 , which yields @xmath277 with @xmath253 , and taking the supremum over the integrand we finally obtain the @xmath278-estimate  .",
    "the @xmath146-estimate   now follows directly from the inverse estimate , theorem  [ thm : brenner - scottinv ] .",
    "we start as in the proof of proposition  [ thm : eadiff ] and recall   in the form @xmath279 by integrating over @xmath272 from @xmath273 to @xmath274 , applying partial integration and using hlder s inequality we obtain @xmath280_0^t - \\int_0^t({\\mathcal{p}_h}\\,y({\\sigma } ) - y({\\sigma}))\\,\\partial_{\\sigma}\\overline{e_a({\\sigma})}\\,{\\mathrm{d}}{\\sigma}\\,\\big|\\,{\\mathrm{d}}x \\\\      & \\leq 2\\,\\big(\\|{\\mathcal{p}_h}\\,y(t ) -   y(t)\\|_{l^2}\\,\\| e_a(t)\\|_{l^2 }      + \\int_{\\omega}\\,\\sup_{0 \\leq { \\sigma}\\leq t } \\big|{\\mathcal{p}_h}\\,y({\\sigma } ) -   y({\\sigma})\\big|\\,\\cdot\\,\\big|      \\int_0^t \\partial_{\\sigma}e_a({\\sigma})\\,{\\mathrm{d}}{\\sigma}\\,\\big|\\,{\\mathrm{d}}x \\big ) \\\\      & \\leq 2\\,\\big(\\|{\\mathcal{p}_h}\\,y(t ) -   y(t)\\|_{l^2}\\,\\| e_a(t)\\|_{l^2 } + \\sup_{0\\leq { \\sigma}\\leq t}\\,\\|{\\mathcal{p}_h}\\,y({\\sigma } ) - y({\\sigma})\\big\\|_{l^2}\\,\\| e_a(t)\\|_{l^2 } \\big ) \\\\      & \\leq c\\,h^{s } \\sup_{0\\leq { \\sigma}\\leq t}\\,\\| y({\\sigma})\\|_{h^s}\\,\\cdot\\,\\| e_a(t)\\|_{l^2}\\ , ,      \\end{aligned}\\ ] ] for @xmath128 depending on @xmath129 and @xmath65 . since @xmath281 , dividing by @xmath282 results in the @xmath147-estimate of proposition  [ thm : eadiff - weak ] .",
    "the @xmath146-estimate now follows directly from the inverse estimate , theorem  [ thm : brenner - scottinv ] .",
    "the major part of the proof of theorem  [ thm : convergence - complete ] relies on the following consistency result for the splitting operator  @xmath117 .",
    "[ thm : interps - err ] let @xmath283 for @xmath284 , and @xmath285 for @xmath286 .",
    "then , the difference @xmath234 is bounded by @xmath287 where @xmath128 depends on @xmath288 , @xmath129 and @xmath65 .",
    "we consider the specific errors of the subflows @xmath289 and @xmath290 and take account of the special structure of the strang splitting operator .",
    "the difference @xmath291 is recast as a sum of terms with appropriate asymptotics in terms of @xmath136 and @xmath137 . in the final step ,",
    "we use the unitarity of @xmath200 and @xmath292 .",
    "we abbreviate @xmath293 and @xmath294 and obtain    [ eq : sint ] @xmath295    now , we consider the expressions   and obtain the following five estimates .",
    "* for   we use the propositions  [ thm : eadiff ] and  [ thm : eadiff - weak ] and obtain @xmath296 where @xmath286 and @xmath297 .",
    "* for  , we use the linear variation - of - constant formula as in  , with arguments @xmath298 , @xmath299 , and obtain @xmath300 hence @xmath301 since @xmath292 is unitary .",
    "we now proceed similarly as in appendix  [ sec : auxiliary ] . by the same argument as in   we obtain @xmath302 via propositions  [ thm : dph - l2-est ] and  [ thm : ebh - h1-est ]",
    "this can further be bounded by @xmath303 now we use propositions  [ thm : eadiff ] and  [ thm : eadiff - weak ] applied to the term @xmath304 in combination with the conservation properties of @xmath289 and @xmath199 ( see   and  ) and obtain @xmath305 where @xmath286 and @xmath297 .",
    "+ the projection property   and   yield @xmath306 * for   we use variation of constants as in  , @xmath307 hence , with @xmath308 , @xmath309 now we separately estimate the two contributions on the right - hand side .",
    "analogously as for  , we have @xmath310 for the second contribution we make use of an estimate based on theorem  [ thm : brenner - scott1 ] and the sobolev embeddings of @xmath146 in @xmath311 and @xmath312 in @xmath313 , @xmath314}(s)\\ , ,      \\end{aligned}\\ ] ] where @xmath315 is the indicator function .",
    "the two values of @xmath316 are related to different bounds for @xmath317 , @xmath318 , while for higher values of @xmath241 , the bounds are valid with @xmath319 .",
    "+ altogether this yields @xmath320 with @xmath321}(s ) $ ] . * for",
    ", we apply variation of constants as for   and obtain @xmath322 now we consider @xmath323 in more detail for different values of @xmath241 , @xmath324}(s ) - \\chi_{[4,\\infty]}(s)\\ , ,      \\end{aligned}\\ ] ] with @xmath170 from   and where @xmath315 is the indicator function .",
    "hence , @xmath325 * for  , we use the results from propositions  [ thm : eadiff ] and  [ thm : eadiff - weak ] , and obtain @xmath326 where @xmath286 and @xmath297 . *",
    "combining these results , we obtain @xmath327 where @xmath328}(s)$ ] and @xmath329}(s ) - \\chi_{[4,\\infty]}(s)$ ] .",
    "thus , we can find a constant @xmath330 for some @xmath331 such that @xmath332    the @xmath146 approximation result follows directly from the @xmath147 approximation via the inverse estimate , theorem  [ thm : brenner - scottinv ] , @xmath333 which concludes the proof .",
    "[ thm : sh - regularity ] suppose that @xmath334 , @xmath335 is fixed and that @xmath137 is sufficiently small compared to @xmath336 and  @xmath182 .",
    "then we can bound the iterative application of the splitting operator @xmath117 from   in @xmath146 in terms of @xmath337 depending on @xmath158 and on @xmath338 , @xmath339    we use induction over @xmath33 for @xmath340 .",
    "for @xmath341 we apply proposition  [ thm : sh - stability ] , giving @xmath342 where @xmath343 . for @xmath344",
    "we use the consistency estimate  , giving @xmath345 where @xmath346 and where @xmath330 depends in particular on @xmath347 , @xmath348 as it appears in  . here",
    "we have used the @xmath146-bound of theorem  [ thm : interps - err ] for @xmath349 , which involves the regularity requirement @xmath350 . for sufficiently small",
    "@xmath137 we can control the contribution of @xmath351 such that @xmath352 for a constant @xmath337 depending on @xmath158 and @xmath353 .",
    "this follows from the regularity of the splitting solution in @xmath354 , @xmath355 with @xmath356 from  .",
    "[ [ bullet - n - mapsto - n1 ] ] @xmath357 @xmath358 + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    we assume inductively that @xmath359 satisfies @xmath360 and show @xmath361 in particular , the constant @xmath337 depends on @xmath362 and @xmath363 such that @xmath364 now we use this inequality to show that @xmath365 is bounded .",
    "in fact , @xmath366 for sufficiently small @xmath137 to control @xmath367 .",
    "obviously , we can apply the same estimate for terms of the form @xmath368 hence @xmath369    this proof was inspired by  @xcite , where an hermite spectral discretization was considered .",
    "for the efficient implementation of the fem model introduced in sec .",
    "[ sec : setting ] , we use a method based on  @xcite and  @xcite .",
    "to this end we choose ( tensor ) gauss  lobatto nodes of degree @xmath54 on rectangular elements for the definition of the nodal basis and for the numerical evaluation of the inner products in  .",
    "these nodes allow exact integration of polynomials up to degree @xmath370 , hence the evaluation of the matrix @xmath371 , which involves the gradients @xmath372 , is exact .",
    "the evaluation of the matrix @xmath373 involves integrals of the form @xmath374 where @xmath375 are the associated quadrature weights .",
    "hence the matrix @xmath373 is diagonal , and @xmath376 preserves the sparsity of @xmath371 ( see algorithm  [ alg : spe - alg ] ) , and likewise for the matrix @xmath377 .",
    "analogously , the evaluation of @xmath378 simplifies to @xmath379 where @xmath380 denotes component - wise multiplication . for the computation of the numerical solution @xmath381 for the full fem discretization",
    ", we refer to algorithm [ alg : spe - alg ] .",
    "@xmath382 interpolated initial function @xmath383 @xmath384 preliminary calculation of @xmath385 , @xmath386 @xmath387 @xmath388 @xmath389 @xmath390 @xmath391 @xmath392 error estimator@xmath393 @xmath394 , @xmath395 choose smaller @xmath136 to reduce ` err ` @xmath396 @xmath397 @xmath398 @xmath399 @xmath400 [ line : c ] @xmath401 [ line : d ] @xmath402    the obtained systems of differential equations for @xmath199 can be solved efficiently via fast exponential solvers ( for instance the function ` expv ` from the package ` expokit ` , see  @xcite , which is based on an adaptive krylov integrator , see  @xcite ) , and since @xmath371 is a symmetric positive definite band matrix , the poisson problem can be solved efficiently by common solvers for sparse systems of linear equations .",
    "in algorithm  [ alg : spe - alg ] we have indicated a time - adaptive version based on an appropriate local error estimator . for this purpose , one may e.g. adopt the approach from  @xcite .",
    "for adaptivity in space , an appropriate a posteriori error estimator is required , but this is not in the scope of this presentation .",
    "we illustrate the performance of time - splitting for a two - dimensional test example .",
    "the problem data are chosen as follows :    * @xmath403 ^ 2 $ ] * @xmath404 ( gaussian initial state ) * integration from @xmath405 to @xmath406 . in figure",
    "[ fig : plot ] we display the wave function at time @xmath406 using a @xmath407 mesh and polynomial basis functions of degree @xmath408 , obtained via a fourth order splitting method with time stepsize @xmath409 .    [",
    "[ global - time - splitting - error ] ] global time - splitting error + + + + + + + + + + + + + + + + + + + + + + + + + + +    for the finite element discretization we choose @xmath410 uniform rectangular elements of degree @xmath411 with gauss  lobatto nodes .",
    "we apply time - splitting methods of orders @xmath412 to @xmath413 , namely lie ",
    "trotter splitting ( @xmath412 ) , strang splitting ( @xmath414 ) , a scheme of order @xmath415 with rational coefficients by ruth ( ( * ? ? ?",
    "* order scheme from the pair ) ) , and an optimized scheme of order @xmath416 by blanes and moan ( ( * ? ? ?",
    "* order scheme from the pair ) ) ; see the collection  @xcite for tables of coefficients and further references .    in figure",
    "[ fig : t - errors_6methods ] we display the @xmath147-norm of the global error at @xmath417 for different choices of the time stepsize @xmath136 together with the observed orders @xmath418 , @xmath419 a reference solution was obtained using a high order splitting scheme with a significantly refined time stepsize .",
    "[ [ fem - approximation - error ] ] fem approximation error + + + + + + + + + + + + + + + + + + + + + + +    in figure  [ fig : h - errors_4methods - full ] we document the behavior of the spatial discretization error using the strang splitting method for a fixed time stepsize @xmath420 in dependence of the fem - mesh for different values of the polynomial degree @xmath54 , varying the mesh parameter @xmath137 from @xmath421 to @xmath422 and determining the respective observed order @xmath423 of the spatial error via extrapolation for @xmath424 , @xmath425    . left : absolute value @xmath426 .",
    "right : real part @xmath427.,title=\"fig:\",scaledwidth=45.0% ] . left : absolute value @xmath426 .",
    "right : real part @xmath427.,title=\"fig:\",scaledwidth=45.0% ]     at @xmath406 in dependence of the time stepsize @xmath136 for splitting methods orders @xmath412 to @xmath413 .",
    "right : observed order  @xmath418.,title=\"fig:\",scaledwidth=45.0% ]   at @xmath406 in dependence of the time stepsize @xmath136 for splitting methods orders @xmath412 to @xmath413 .",
    "right : observed order  @xmath418.,title=\"fig:\",scaledwidth=45.0% ]     at @xmath406 in dependence of the meshsize @xmath137 for polynomial degree @xmath428 .",
    "right : observed order @xmath429.,title=\"fig:\",scaledwidth=45.0% ]   at @xmath406 in dependence of the meshsize @xmath137 for polynomial degree @xmath428 .",
    "right : observed order @xmath429.,title=\"fig:\",scaledwidth=45.0% ]",
    "since in our context nonlinear operators @xmath430 and @xmath431 arise , we will resort to the following variants of the variation - of - constants formula .",
    "we recall that @xmath430 and @xmath432 are defined in   and define subflows  @xmath290 and @xmath433 in the subproblem   and  . in the spatially discrete case , the operators @xmath431 and @xmath434 are defined in   and define the subproblems   and   for the evolutionary operators @xmath200 and @xmath292 .    a.   * same operators @xmath431 , but with different argument . *",
    "+ to rewrite the difference @xmath435 we use the fact that for all @xmath436 , @xmath437 which defines a new differential equation , @xmath438 by the variation - of - constant formula we obtain the mild formulation @xmath439 b.   * different operators @xmath430 , @xmath431*. + to rewrite the difference @xmath440 we use the fact that @xmath441 , such that for all @xmath442 , @xmath443 again we obtain a differential equation , @xmath444 such that the variation - of - constant formula yields @xmath445",
    "in our theoretical estimates , we recurrently resort to estimates of sobolev type . for convenience of the reader ,",
    "we briefly recapitulate these technical tools here .",
    "we start by repeating some elementary notions from functional analysis , see for example  @xcite .",
    "the underlying space is @xmath147 equipped with the inner product @xmath446 , @xmath447 and the norm @xmath448 , where @xmath65 is a bounded domain with smooth boundary ( for the sobolev embeddings cited below , it is necessary that @xmath65 satisfies the cone condition ) .",
    "the set of all functions in @xmath147 having weak derivatives up to order @xmath449 is denoted as the _ sobolev space _ @xmath450 .",
    "it is equipped with the norm @xmath451 where the sum is over all derivatives up to order @xmath452 .",
    "furthermore , we will denote by @xmath453 the supremum norm on the space of functions bounded almost everywhere .    in our analysis",
    ", we will make use of the following results , see for instance  @xcite .",
    "our formulations are specific to @xmath454 , @xmath455 :    [ thm : sobolev1 ] let @xmath456 such that @xmath457 . then for @xmath458 there is a @xmath459 function in the @xmath147 equivalence class of @xmath197 and @xmath460 where the sum is over all derivatives of order up to @xmath461 .",
    "this implies the following inequalities , see for instance @xcite ,  @xcite ,  @xcite , and  @xcite :    [ cor : sobolev2 ] for @xmath462 , the following inequalities hold : @xmath463",
    "this section contains a collection of useful theorems and bounds which are used in the convergence theory in  section  [ sec : conv - ana ] .",
    "a.   the evolution operator @xmath16 is unitary with respect to @xmath464 and @xmath465 , for @xmath466 and @xmath467 , + [ eq : semidiscrete - conservation - a ] @xmath468 b.   the evolution operator @xmath19 is unitary with respect to @xmath464 for @xmath466 and @xmath467 , @xmath469    a.   we proceed from the weak formulation  , @xmath470 set @xmath471 , @xmath472 and obtain @xmath473 which implies  .",
    "furthermore , setting @xmath474 in  , @xmath475 we obtain @xmath476 which together with   implies  .",
    "b.   for the flow defined by  , @xmath477 and @xmath28 we have @xmath478 which , in particular , implies  .",
    "[ rem : hk - cons ] more generally , the @xmath450-norms for @xmath479 are conserved under the flow @xmath16 . to see this",
    ", we consider the strong formulation  , @xmath480 with @xmath481 and wish to show that @xmath482 for any partial derivative  @xmath483 . we compute @xmath484 via a density argument , the result also holds for all @xmath485 .",
    "a.   the evolution operator @xmath486 is unitary with respect to @xmath464 and @xmath465 , for @xmath466 and @xmath487 , + [ eq : discrete - conservation - a ] @xmath488 b.   the evolution operator @xmath489 is unitary with respect to @xmath464 i.e. , for @xmath466 and @xmath490 , + [ eq : discrete - conservation - b ] @xmath491 for @xmath492 , this implies @xmath493 .",
    "furthermore , @xmath494 satisfies the differential inequality @xmath495 where @xmath496 .",
    "a.   for @xmath487 and @xmath497 we have @xmath498 . hence by the definition of the discrete laplacian  , @xmath499 which implies  .",
    "furthermore , @xmath500 which implies  .",
    "b.   for @xmath501 and @xmath502 we have @xmath503 with @xmath504 , hence @xmath505 since @xmath506 is real .",
    "this implies  .",
    "+ on the other hand , @xmath292 does not conserve the @xmath146-norm . to derive a bound we compute @xmath507 and estimate @xmath508 this implies  , @xmath509 concluding the proof .",
    "we use hlder s inequality , apply theorem  [ thm : brenner - scott1 ] , and use the sobolev embedding of @xmath146 in @xmath532 , @xmath533 where the last inequality follows from a duality argument and the hlder inequality , @xmath534 .",
    "[ [ conditional - h1-stability - of - the - evolution - operator - mathcale_b_htcdot ] ] conditional @xmath538-stability of the evolution operator @xmath489 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~          here we show that an @xmath546-bound for the semi - discrete splitting solution @xmath547 defined in   depends linearly on the @xmath546-norm of the initial value @xmath548 times an exponential function depending on lower order sobolev norms . hence for bounded times",
    "@xmath549 , the @xmath546-norm of the semi - discrete splitting solution will not behave worse than the @xmath546-norm of the initial value .",
    "since @xmath289 conserves the @xmath546-norm , we only consider the properties of the splitting operator @xmath290 , which is the solution of ( see  sec .  [",
    "sec : setting ] ) @xmath558 the basic idea is to bound the right - hand side of   in the corresponding @xmath546-norm , using the following estimates . by the hlder inequality and the sobolev embeddings of @xmath176 in @xmath224 and @xmath146 in @xmath311",
    ", we have @xmath559 we further use the bound @xmath560 and obtain      for the proof of  , we first proceed along the lines of the arguments from  @xcite , where the result was shown for @xmath562 and then extend the result for @xmath563 . for higher values of @xmath461",
    "the proof works analogously but becomes technically more and more involved .",
    "@xmath357 @xmath564 : :    from   we obtain an integral inequality in the @xmath176-norm    using the bound  ,    @xmath565    where @xmath566 .    +    by a gronwall argument it follows that    @xmath567    and thus    @xmath568 .",
    "iterative application yields @xmath569 and the constant @xmath570 reads    @xmath571 . @xmath357",
    "@xmath572 : :    again , we bound the right - hand side of  . by",
    ", we obtain for    @xmath573 , @xmath574    hence , @xmath575    and by a gronwall argument it follows that    @xmath576    setting @xmath577 ,    @xmath578 , and inserting the    bound   for the @xmath176-norms , we conclude that    @xmath579 @xmath357 @xmath580 : :    from   and   we obtain @xmath581    hence @xmath582    setting @xmath577 and    @xmath578 and following the    argument for @xmath573 , we conclude that    @xmath583 @xmath357 @xmath584 : :    in a similar way as before we obtain @xmath585    and thus @xmath586            w.  auzinger , h.  hofsttter , o.  koch , and m.  thalhammer .",
    "defect - based local error estimators for splitting methods , with application to schrdinger equations , part iii : the nonlinear case . , 273:182204 , 2014 .",
    "o.  koch and ch .",
    "lubich . analysis and time integration of the multi - configuration time - dependent hartree - fock equations in electron dynamics .",
    "asc report 4/2008 , inst .  for anal .  and",
    ", vienna univ .  of technology , 2008 .",
    "o.  koch , ch .",
    "neuhauser , and m.  thalhammer .",
    "error analysis of high - order splitting methods for nonlinear evolutionary schrdinger equations and application to the mctdhf equations in electron dynamics .",
    ", 47:12651284 , 2013 ."
  ],
  "abstract_text": [
    "<S> operator splitting methods combined with finite element spatial discretizations are studied for time - dependent nonlinear schrdinger equations . in particular , the schrdinger  </S>",
    "<S> poisson equation under homogeneous dirichlet boundary conditions on a finite domain is considered . </S>",
    "<S> a rigorous stability and error analysis is carried out for the second - order strang splitting method and conforming polynomial finite element discretizations . for sufficiently regular solutions </S>",
    "<S> the classical orders of convergence are retained , that is , second - order convergence in time and polynomial convergence in space is proven . </S>",
    "<S> the established convergence result is confirmed and complemented by numerical illustrations . </S>"
  ]
}