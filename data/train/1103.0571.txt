{
  "article_text": [
    "one of the lasting interests in economics is to study optimal resource allocation in a spatial economy .",
    "for instance , the well known monge - kantorovich transport problem aims at finding an efficient allocation plan or map for transporting some commodity from factories to households .",
    "this problem was pioneered by monge @xcite and advanced fully by kantorovich @xcite who won the nobel prize in economics in 1975 for his seminal work on optimal allocation of resources .",
    "recent advancement of this problem in mathematics can be found in villani villani1,villani and references therein .",
    "monge - kantorovich problem has also been applied to study other related economic problems , e.g. , spatial firm pricing ( buttazzo and carlier @xcite ) , principal - agent problem ( figalli , kim and mccann @xcite ) , hedonic equilibrium models ( chiappori , mccann and nesheim @xcite ; ekeland @xcite ) , matching and partition in labor market ( carlier and ekeland @xcite ; mccann and trokhimtchouk @xcite ) .",
    "recently , a new research field known as _ ramified optimal transportation _ has grown out of monge - kantorovich problem .",
    "representative studies can be found for instance in gilbert @xcite , xia xia1,xia2,xia6,xia8,xia3,xia11,xia12 , maddalena , solimini and morel msm , bernot , caselles and morel @xcite , brancolini , buttazzo and santambrogio @xcite , santambrogio @xcite , devillanova and solimini @xcite , xia and vershynina @xcite . ramified optimal transport problem studies how to find an _",
    "optimal transport path _ from sources to targets as shown in figure [ figure1 ] .",
    "different from the standard monge - kantorovich problem where the transportation cost is solely determined by a transport plan or map , the transportation cost in the ramified transport problem is determined by the actual transport path which transports the commodity from sources to targets . ramified transportation",
    "indeed formally formulates the concept of _ transport economy of scale _ in group transportation observed widely in both nature ( e.g. trees , blood vessels , river channel networks , lightning ) and efficiently designed transport systems of branching structures ( e.g. railway configurations and postage delivery networks ) .",
    "an application of ramified optimal transportation in economics can be found in xia and xu @xcite , which showed that a well designed ramified transport system can improve the welfare of consumers in the system .        in this paper",
    ", we propose an optimal resource allocation problem where a planner chooses both an optimal allocation plan as well as an associated optimal transport path using ramified transport technology . in both monge - kantorovich and",
    "ramified transport problems , one typically assumes an exogenous fixed distribution in both sources and targets .",
    "however , in many resource allocation practices , the distribution in either sources or targets is not pre - determined but rather determined endogenously . for instance , in a _ production allocation _ problem , suppose there are @xmath0 factories and @xmath1 households located in different places in some area .",
    "the demand for some commodity from each household is fixed .",
    "nevertheless , the allocation of production among factories is not pre - determined but rather depends on the distribution of demand among households as well as their relative locations to factories .",
    "a planner needs to make an efficient allocation plan of production over these @xmath0 factories to meet given demands from @xmath2 households .",
    "under ramified optimal transportation , the transportation cost of each production plan is determined by an associated optimal transport path from factories to households .",
    "consequently , the planner needs to find an optimal production plan as well as an associated optimal transport path to minimize overall cost of distributing commodity from factories to households .",
    "another example of similar nature exists in the following _ storage arrangement _ problem .",
    "suppose there are @xmath0 warehouses and @xmath1 factories located in different places in some area .",
    "each factory has already produced some amount of commodity .",
    "however , the assignment of commodity among warehouses is not pre - determined but instead relies on the distribution of production among factories as well as relative locations between factories and warehouses . similarly , a planner needs to make an efficient storage arrangement as well as an associated optimal transport path for storing the produced commodity in the given @xmath0 warehouses with minimal transportation cost .",
    "problem of this category is formulated as the _ ramified optimal allocation problem _ in section 2 . throughout the following context",
    ", we will focus our discussion on the scenario of the production allocation problem .",
    "little additional effort is needed to interpret results for other scenarios .",
    "we start with modeling a transport path from factories to households as a weighted directed graph , where the transportation cost on each edge of the graph depends linearly on the length of the edge but concavely on the amount of commodity moved on the edge .",
    "the motivation of concavity of the cost functional on quantity comes from the observation of transport economy of scale in group transportation .",
    "the more concave is the cost functional or the greater is the magnitude of transport economy of scale , the more efficient is to transport commodity in larger groups .",
    "we define the cost of an allocation plan as the minimum transportation cost of a transport path compatible with this plan .",
    "a planner needs to find an efficient allocation plan such that demands from households will be met in a least cost way . in this problem ,",
    "the distribution of production over factories is not pre - determined as in monge - kantorovich or ramified transport problems , but endogenously determined by the distribution of demands from households as well as their relative locations to factories .",
    "we prove the existence of the ramified allocation problem in section 3 .",
    "it s shown that due to the transport economy of scale in ramified transportation , under any optimal allocation plan , no two factories will be connected on any associated optimal allocation path .",
    "consequently , any optimal allocation path can be decomposed into a set of mutually disjoint transport paths originating from each factory . as a result ,",
    "each household will receive her commodity from only one factory under any optimal allocation plan .",
    "it implies that each optimal allocation plan corresponds equivalently to an optimal assignment map from households to factories .",
    "thus , solving the ramified optimal allocation problem is equivalent to finding an optimal assignment map .",
    "this optimal assignment map is shown to provide a partition not only in households but also in the associated allocation path according to the factories .    because of the equivalence between the optimal allocation plan and assignment map , we can instead focus attention on studying the properties of optimal assignment maps in the ramified optimal allocation problem . in section 4 ,",
    "we develop a method of marginal transportation analysis to study properties of optimal assignment maps .",
    "this method extends the standard marginal analysis in economics into the analysis for transport paths .",
    "it builds upon an intuitive idea that a marginal change on an optimal allocation path should not reduce the existing minimal transportation cost . using this method",
    ", we develop a criterion which relates the optimal assignment of a household with her relative location to factories and other households , as well as her demand and productions at factories .",
    "in particular , it is shown that each factory has a nearby region such that a household living at this region will be assigned to the factory , where the size of this region depends positively on the demand of the household . in this case",
    ", the planner takes advantage of relative spatial locations between households and factories .",
    "also , if an optimal assignment map assigns a household to some factory , then this household has a neighborhood area such that any household with a smaller demand living in this area will also be assigned to the same factory . here",
    ", the planner utilizes the benefit in group transportation due to transport economy of scale embedded in ramified transportation .",
    "the role of spatial location and group transportation in resource allocation is further studied in section 5 by a method of projectional analysis .",
    "we show that under an optimal assignment map , a household will be assigned to some factory only when either she lives close to the factory or she has some nearby neighbors assigned to the factory .",
    "in particular , there is an autarkysituation when households and factories are located on two disjoint areas lying distant away from each other , the demand of households will solely be satisfied from local factories .",
    "an important application of the properties of optimal assignment maps is that they can shed light on the search for those maps . in section 6 ,",
    "we develop a search method utilizing these properties in a notion of state matrix .",
    "a state matrix represents the information set of a planner during the search process for an optimal assignment map .",
    "any zero entry @xmath3 in the matrix reflects that the planner has excluded the possibility of assigning household @xmath4 to factory @xmath5 under this map .",
    "when a state matrix has exactly one non - zero entry in each column , it completely determines an optimal assignment map by those non - zero entries .",
    "our search method uses properties about optimal assignment maps to update some non - zero entries with zeros in a state matrix .",
    "this method is motivated by the observation that via group transportation under ramified transport technology , assignment of each household has a global effect on the allocation path as well as the associated assignment map .",
    "thus , the planner can deduce more information about the optimal assignment map by exploiting the existing information embedded in zero entries of a state matrix .",
    "each updated state matrix contains more zeros and thus more information than its pre - updated counterpart .",
    "this method is useful in the search for optimal assignment maps as each updating step increases the number of zero entries which in turn reduces the size of the restriction set of assignment maps in a large magnitude . in some non - trivial cases ,",
    "it s shown that this method can exactly find an optimal assignment map as desired .",
    "in this section , we describe the setting of the optimal allocation model with ramified optimal transportation .      in a spatial economy , there are @xmath0 factories and @xmath2 households located at @xmath6 and @xmath7 in some area @xmath8 , where @xmath8 is a compact convex subset of a euclidean space @xmath9 . in this model economy , there is only one commodity , and each household @xmath10 has a fixed demand @xmath11 for the commodity .    for analytical convenience , we first represent households and factories as atomic radon measures . recall that a radon measure @xmath12 on @xmath8 is _ atomic _ if @xmath12 is a finite sum of dirac measures with positive multiplicities , i.e. , @xmath13for some integer @xmath14 and some points @xmath15 with @xmath16 for each @xmath17 .",
    "the mass of @xmath12 is denoted by @xmath18we can thus represent the @xmath2 households as an atomic measure on @xmath8 by @xmath19for each @xmath20 denote @xmath21 as the units of the commodity produced at factory @xmath22 located at @xmath23 .",
    "then , the @xmath0 factories can be represented by another atomic measure on @xmath8 by @xmath24 in the study of transport problems , we usually assume @xmath25 , i.e. , @xmath26which simply means that supply equals demand in aggregate .",
    "next , we introduce the concept of transport path from @xmath27 to @xmath28 as in xia @xcite .",
    "suppose @xmath27 _ _  and _ _ @xmath29 are two atomic measures on @xmath30 of equal mass .",
    "a _ transport path from _",
    "@xmath27 _ _  to _ _",
    "@xmath28 is a weighted directed graph @xmath31 consisting of a vertex set @xmath32 , a directed edge set @xmath33 and a weight function @xmath34 such that @xmath35 and for any vertex @xmath36 , there is a balance equation @xmath37where each edge @xmath38 is a line segment from the starting endpoint @xmath39 to the ending endpoint @xmath40 .",
    "denote @xmath41 as the space of all transport paths from @xmath27 to @xmath28 .",
    "note that the balance equation ( [ balance ] ) simply means the conservation of mass at each vertex .",
    "viewing @xmath31 as an one dimensional polyhedral chain , equation ( [ balance ] ) may simply be expressed as @xmath42 .",
    "now , we consider the transportation cost of a transport path .",
    "as observed in both nature and efficiently designed transport networks , there exists a _ transport economy of scale _ underlying group transportation . for this consideration ,",
    "ramified optimal transport theory uses a cost functional depending concavely on quantity and defines the transportation cost of a transport path as follows .    for each transport path @xmath43 and any @xmath44 $ ] ,",
    "the @xmath45 cost of @xmath31 is defined by @xmath46 ^{\\alpha } length\\left ( e\\right ) .",
    "\\label{m_a_cost}\\ ] ]    the parameter @xmath47 represents the magnitude of transport economy of scale .",
    "the smaller the @xmath48 the more efficient is to move commodity in groups .",
    "ramified optimal transport problem studies how to find a transport path to minimize the @xmath45 * *  * * cost , i.e. , @xmath49whose minimizer is called an _ optimal transport path _ from @xmath50 to @xmath29 .",
    "an optimal transport path has many nice properties .",
    "for instance , it contains no cycles by xia ( * ? ? ?",
    "* proposition 2.1 ) .",
    "thus , without loss of generality , we assume that _ all transport paths considered in the following context contain no cycles_. when @xmath51 , an optimal transport path is generally of branching structure . in the scenario with two sources and one target ,",
    "a y - shaped  path is usually more preferable than a v - shaped  path .",
    "the following example illustrates the effect of transport economy of scale on optimal transport path in a spatial economy with one factory @xmath52 located at origin and fifty households @xmath53 of equal demand @xmath54 the locations of these fifty households are randomly selected .",
    "as seen in figure [ figure2 ] , when @xmath55 the optimal transport path is linear  in the sense that the factory will ship commodity directly to each household .",
    "when @xmath51 , the transport path becomes ramified  as the planner would like commodity to be transported in groups in order to utilize the benefit of transport economy of scale .",
    "furthermore , by comparing for instance the width of the transport paths for @xmath56 and @xmath57 , we observe that the smaller the @xmath47 , the more likely the commodity will be transported in a large scale .    for any atomic measures @xmath27 and @xmath29 on @xmath8 of equal mass , define the minimum transportation cost as @xmath58as shown in xia @xcite",
    ", @xmath59 is indeed a metric on the space of atomic measures of equal mass .",
    "also , for each @xmath60 , it holds that @xmath61    without loss of generality , we normalize both @xmath27 and @xmath29 to be a probability measure on @xmath8 , i.e. , @xmath62      for the allocation problem , a key decision a planner needs to make is about the transport plan from factories to households .",
    "suppose @xmath27 and @xmath29 are two atomic probability measures on @xmath8 as in ( [ factories ] ) , ( [ households ] ) and ( [ market clearing ] ) .",
    "a _ transport plan _ from @xmath27 to @xmath29 is an atomic probability measure @xmath63on the product space @xmath64 such that for each @xmath22 and @xmath65 , @xmath66 , @xmath67denote @xmath68 as the space of all transport plans from @xmath27 to @xmath29 .    in a transport plan @xmath69 , the number @xmath70 denotes the amount of commodity received by household @xmath65 from factory @xmath22",
    "now , as in section 7.1 of xia @xcite , we want to consider the compatibility between a transport path and a transport plan .",
    "let @xmath31 be a given transport path in @xmath71 .",
    "since @xmath31 contains no cycles , for each @xmath23 and @xmath72 , there exists at most one directed polyhedral curve @xmath73 on @xmath31 from @xmath23 to @xmath72 . in other words , there exists a list of distinct vertices @xmath74 in @xmath75 with @xmath76 , @xmath77 , and each @xmath78 $ ] is a directed edge in @xmath79 for each @xmath80 . for",
    "some pairs of @xmath81 , such a curve @xmath73 from @xmath23 to @xmath72 may not exist , in which case we set @xmath82 to denote the _ empty _ directed polyhedral curve . by doing so",
    ", we construct a matrix @xmath83with each element of @xmath84 being a polyhedral curve . for any transport path @xmath85 ,",
    "such a matrix @xmath86 is uniquely determined .",
    "let @xmath43 be a transport path and @xmath87 be a transport plan .",
    "the pair @xmath88 is compatible if @xmath89 whenever @xmath82 and @xmath90    here , equation ( [ compatible_pair ] ) means that as polyhedral chains , @xmath91where the product @xmath92 denotes that an amount @xmath70 of commodity is moved along the polyhedral curve @xmath73 from factory @xmath22 to household @xmath65 .    roughly speaking",
    ", the compatibility conditions check whether a transport plan is realizable by a transport path . given a transport plan ,",
    "the planner must design a transport path which can support this plan . to see the concept more precisely , let @xmath93and consider a transport plan @xmath94it is straight forward to see from figure [ compatible_figure ] that @xmath69 is compatible with @xmath95 but not @xmath96 this is because there is no directed curve @xmath97 from factory @xmath98 to household @xmath99 in @xmath100 .      in the standard transport problems , e.g. monge - kantorovich or ramified optimal transportation",
    ", one typically assumes an exogenous fixed distribution of production among factories . in this paper",
    ", we consider a scenario where this distribution is not fixed but endogenously determined . in other words , the atomic measure @xmath27 which represents the @xmath0 factories can have varying production level @xmath21 at each factory @xmath22 .",
    "this consideration is motivated by our observation that in many allocation practices as discussed in the introduction , the distribution of production among factories is not pre - determined but rather depends on the distribution of demand among households as well as their relative locations to factories .",
    "let @xmath101 be a finite subset of @xmath8 , and @xmath29 be the atomic  probability measure representing households defined in ( [ households ] ) .",
    "an allocation plan from @xmath102 to @xmath29 is a probability measure @xmath103on @xmath64 such that @xmath104 for each @xmath22 , @xmath65 and @xmath105denote @xmath106 $ ] as the set of all allocation plans from @xmath102 to @xmath29 .",
    "note that any allocation plan @xmath107 $ ] corresponds to a transport plan @xmath69 from @xmath108 to @xmath28 , where @xmath108 is the probability measure representing @xmath0 factories defined as@xmath109 in other words , @xmath106 $ ] is the union of @xmath110 among all atomic probability measures @xmath27 supported on @xmath102 .",
    "any function @xmath111 determines an allocation plan in @xmath112 $ ] as @xmath113that is , @xmath114    for a given allocation plan , we define the associated transportation cost as follows .    for any allocation plan",
    "@xmath115 $ ] and @xmath116 , the ramified transportation cost of @xmath69 is @xmath117where @xmath118 is defined in ( m_a_cost ) . an _ allocation plan _",
    "@xmath119 $ ] is _ optimal _ if @xmath120 .\\ ] ]    for each allocation plan @xmath121 as in xia ( * ? ? ?",
    "* proposition 7.3 ) , there exists a path @xmath122 such that @xmath123 is compatible with @xmath69 and @xmath124thus , the minimum value in ( [ m_alpha_q ] ) is achieved by @xmath123 for each @xmath69 .",
    "now , we are ready to define the major problem in this paper .",
    "[ problem](ramified optimal allocation problem ) let @xmath8 be a compact convex domain in @xmath9 with the standard norm @xmath125 .",
    "given a finite subset @xmath126 in @xmath8 , an atomic probability measure @xmath29 on @xmath8 defined in ( [ households ] ) , and a parameter @xmath127 .",
    "find a minimizer of @xmath128 among all allocation plans @xmath115 $ ] , i.e. , @xmath129 \\right\\ } .",
    "\\label{assignment problem}\\ ] ]",
    "in this section , we first establish the existence result of the ramified optimal allocation problem .",
    "it s then shown that any optimal allocation plan corresponds to an optimal assignment map from households to factories , which provides a partition in both households and transport paths .",
    "the following proposition proves the existence of problem [ problem ] .",
    "[ existence]the ramified optimal allocation problem ( [ assignment problem ] ) has a solution .",
    "moreover , @xmath129 \\right\\ } = \\min \\text { } \\left\\ { d_{\\alpha } \\left ( \\sum_{i=1}^{k}m_{i}\\delta _ { x_{i}}\\mathbf{,b}\\right ) : \\vec{m}\\in k\\right\\ } ,   \\label{equality}\\]]where @xmath130 and @xmath59 is defined in ( [ d_alpha ] ) .",
    "since @xmath59 is a metric , it is easy to see that @xmath131 is a continuous function in @xmath132 on the compact subset @xmath133 of @xmath134 .",
    "thus , the function @xmath135 achieves its minimum value in @xmath133 at some @xmath136 .",
    "that is , @xmath137where @xmath138 .",
    "now , let @xmath139 be an optimal transport path in @xmath140 with @xmath141 . by xia ( * ? ? ?",
    "* lemma 7.1 ) , @xmath139 has at least one compatible plan @xmath142 $ ] and thus @xmath143for any @xmath115 $ ] , we have @xmath144this shows that @xmath145 \\right\\ } \\text { and } \\mathbf{t}_{\\alpha } \\left ( q^{\\ast } \\right ) = d_{\\alpha } \\left ( \\mathbf{a}^{\\ast } \\mathbf{,b}\\right ) .",
    "\\label{t = d_a}\\]]thus , @xmath146 is a solution to the ramified optimal allocation problem ( [ assignment problem ] ) .",
    "one implication of the above proposition is that there exists a close relationship between optimal allocation plans and underlying transport paths . to further characterize the properties of an optimal allocation plan",
    ", we introduce the concept of allocation paths as follows :    an allocation path from @xmath102 to @xmath29 is a transport path @xmath85 for some atomic probability measure @xmath147 supported on @xmath102 .",
    "denote @xmath148 $ ] as the set of all allocation paths from @xmath102 to @xmath149 .",
    "an allocation path @xmath150 $ ] is optimal if @xmath151 .\\ ] ]    by the definition of @xmath59 , equation ( [ equality ] ) can be alternatively written as@xmath129 \\right\\ } = \\min \\left\\ { \\mathbf{m}_{\\alpha } \\left ( g\\right ) : g\\in path\\left [ \\mathbf{x},\\mathbf{b}\\right ] \\right\\ } , \\label{equalitytm}\\]]which shows that the ramified optimal allocation problem corresponds to a problem of finding an optimal allocation path .",
    "the following lemma establishes the connection between optimal allocation plans and paths via the notion of compatibility .",
    "[ path_plan_lemma]suppose @xmath152 $ ] , @xmath115 $ ] and @xmath153 is compatible .",
    "then , @xmath31 is an optimal allocation path if and only if @xmath69 is an optimal allocation plan with @xmath154 .    if @xmath31 is an optimal allocation path , then by ( [ equalitytm ] ) , @xmath155 \\right\\ } .\\]]since @xmath153 is compatible , @xmath156 .",
    "thus , @xmath157 \\right\\ } = \\mathbf{m}_{\\alpha } \\left ( g\\right ) , \\]]and @xmath69 is an optimal allocation plan .",
    "suppose @xmath69 is an optimal allocation plan with @xmath158 , then @xmath159 \\right\\ } .\\]]by ( [ equalitytm ] ) , @xmath31 is an optimal allocation path .",
    "the next lemma presents a key property of an optimal allocation path .",
    "[ decomposition_lemma]let @xmath152 $ ] be an optimal allocation path from @xmath102 to @xmath29 . then",
    ", for any @xmath160 , @xmath23 and @xmath161 do not belong to the same connected component of @xmath31 .",
    "assume @xmath23 and @xmath161 belong to the same connected component of an optimal allocation path @xmath162 , then there exists a polyhedra curve @xmath163 supported on @xmath31 from @xmath23 to @xmath164 .",
    "we may list edges of @xmath163 as @xmath165here , @xmath166 ( or @xmath167 ) if @xmath168 has the same ( or opposite ) direction as @xmath163 . let @xmath169and consider @xmath170 for @xmath171 .",
    "note that @xmath172 is still in @xmath173 $ ] , and@xmath174 length\\left ( e_{i}\\right ) .\\]]thus",
    ", @xmath175 length\\left ( e_{i}\\right ) .\\end{aligned}\\]]when",
    "@xmath176 , by the strict concavity of @xmath177 , we have @xmath178when @xmath179 , @xmath180 length\\left ( e_{i}\\right ) \\\\ & = & -\\sum \\left\\ { length\\left ( e_{i}\\right ) : w\\left ( e_{i}\\right ) = \\lambda \\right\\ } < 0.\\end{aligned}\\]]thus , when @xmath127 , we have @xmath181i.e .",
    "@xmath182a contradiction with the optimality of @xmath31 in @xmath148 $ ] .",
    "the above lemma says that no two factories will be connected on any optimal allocation path . alternatively speaking , on an optimal allocation path ,",
    "each single household will receive her commodity from only one factory , i.e. , each household is assigned to one factory .",
    "this result is attributed to the transport economy of scale underlying ramified transportation technology . as seen in section 2",
    ", an @xmath127 implies the existence of transport economy of scale with transporting in groups being more cost efficient than transporting separately .",
    "any allocation path on which some single household receives commodity from two factories can not be optimal because the planner would be able to reduce transportation cost by transferring production of one factory to the other .",
    "this transfer makes the benefit of transport economy of scale more likely to be realized as commodity for this household is transported in a larger scale on the path .",
    "the result that each household is assigned to one factory on an optimal allocation path motivates the following notion of assignment map .",
    "an _ assignment map is a function _ @xmath183 .",
    "let @xmath184 $ ] be the set of all _ assignment maps_. for any assignment map @xmath185 $ ] and @xmath127 , define @xmath186where @xmath59 is the metric defined in ( [ d_alpha]),@xmath187an assignment map @xmath188 $ ] is optimal if @xmath189 .\\ ] ]    using the concept of assignment maps , lemma [ decomposition_lemma ] provides a partition result for an optimal allocation path .",
    "[ path_map]let @xmath31 be an optimal allocation path from @xmath102 to @xmath28 .",
    "then , there exists an assignment map @xmath190 $ ] such that @xmath191moreover , for @xmath192 and @xmath193 given in ( [ a_b_i ] ) , the path @xmath31 can be decomposed into the sum of @xmath0 pairwise disjoint transport paths @xmath194where each @xmath195 is an optimal transport path with @xmath196    let @xmath31 be an optimal allocation path from @xmath102 to @xmath29 . by lemma [ decomposition_lemma",
    "] , each @xmath23 determines a connected component @xmath197 of @xmath31 .",
    "thus,@xmath198    for each @xmath199 , @xmath72 is clearly connected to some @xmath23 on @xmath31 . by lemma [ decomposition_lemma ]",
    ", such an @xmath23 must be unique for each @xmath65 .",
    "thus , we may define @xmath200this defines an assignment map @xmath201 $ ] .",
    "also note that @xmath197 is a transport path from @xmath192 to @xmath193 , where @xmath202 are given in ( [ a_b_i ] ) . since @xmath31 is optimal as in ( [ equalitytm ] ) , each @xmath203 must also be optimal , and hence @xmath204therefore , @xmath205    [ g_1 ]   and allocation path @xmath206,title=\"fig:\",scaledwidth=60.0% ]    figure [ partition ] illustrates a partition result under an optimal assignment map .",
    "this spatial economy consists of factories @xmath207 and households @xmath208 with equal demand @xmath209 .",
    "the figure shows a clear partition in both the allocation path and households : first , the allocation path is decomposed into two disjoint sub - transport paths originating from factory @xmath210 and @xmath211 respectively .",
    "second , the @xmath212 households are divided into two unconnected populations centered around the factory from which they receive the commodity .    note that any assignment map @xmath201 $ ] provides a partition among households @xmath213where all households in @xmath193 given in ( [ a_b_i ] ) are assigned to a single factory located at @xmath23 . for each @xmath22 , let @xmath214 be an optimal transport path which transports the commodity produced at factory @xmath22 to households in @xmath215 this yields an allocation path from @xmath102 to @xmath28 @xmath216 ,   \\label{g_s}\\]]which is compatible with the allocation plan @xmath217 given in ( [ q_s ] ) .",
    "thus , @xmath218by proposition [ path_map ] , any optimal allocation path is in the form of ( [ g_s ] ) with respect to its associated assignment map .",
    "now , we state the main results of this section as follows :    [ theorem 1]given a subset @xmath126 in @xmath8 , an atomic probability measure @xmath29 as in ( [ households ] ) , and a parameter @xmath127 .    1 .   [ map_plan]an allocation plan @xmath219 $ ] is optimal if and only if there exists an optimal assignment map @xmath201 $ ] such that @xmath220 .",
    "[ map_path]an allocation path @xmath221 $ ] is optimal if and only if there exists an optimal assignment map @xmath201 $ ] such that @xmath222 for some @xmath223 of @xmath224 defined in ( [ g_s ] ) .",
    "3 .   moreover",
    ", @xmath225 } \\text { } \\mathbf{t}% _ { \\alpha } \\left ( q\\right ) = \\min_{s\\in map\\left [ \\ell , k\\right ] } \\mathbf{e}% _ { \\alpha } \\left ( s;\\mathbf{x},\\mathbf{b}\\right ) = \\min_{g\\in path\\left [ \\mathbf{x},\\mathbf{b}\\right ] } \\mathbf{m}_{\\alpha } \\left ( g\\right ) .",
    "\\label{two_min_equal}\\ ] ]    we first show the equivalence in ( [ map_plan ] ) :    @xmath226 .",
    "suppose @xmath227 $ ] is an optimal allocation plan .",
    "let @xmath228 $ ] be an allocation path that is compatible with @xmath69 and @xmath229 since @xmath69 is an optimal allocation plan , by lemma [ path_plan_lemma ] , @xmath31 is an optimal allocation path . by proposition [ path_map ]",
    ", there exists an assignment map @xmath224 such that @xmath230since @xmath153 is compatible , by ( [ compatible_pair ] ) , we may express @xmath231for each @xmath65 , by lemma [ decomposition_lemma ] , we have @xmath232 whenever @xmath233 . by the compatibility of @xmath88",
    ", we have @xmath234 whenever @xmath233 .",
    "thus , for @xmath235 ,    @xmath236    this shows that @xmath220 .    for any @xmath237 $ ] , by ( e_energy_greater_than_t_energy ) and ( [ e_m_t ] ) , @xmath238thus , @xmath224 is an optimal assignment map .",
    "since @xmath239 , we have the first equality in ( [ two_min_equal ] ) .",
    "suppose @xmath185 $ ] is an optimal assignment map .",
    "then , by ( e_energy_greater_than_t_energy ) and the first equality in ( two_min_equal ) , @xmath241 \\right\\ } \\\\ & = & \\min \\text { } \\left\\ { \\mathbf{t}_{\\alpha } \\left ( \\tilde{q}\\right ) : \\tilde{q% } \\in plan\\left [ \\mathbf{x},\\mathbf{b}\\right ] \\right\\ } .\\end{aligned}\\]]therefore , @xmath242 $ ] is an optimal allocation plan .",
    "this completes the proof of ( [ map_plan ] ) .",
    "the second equality of ( [ two_min_equal ] ) follows from the first equality of ( [ two_min_equal ] ) and ( [ equalitytm ] ) .",
    "we now show the equivalence in ( [ map_path ] ) :    @xmath240  suppose @xmath222 for some optimal assignment map @xmath201 $ ] , then @xmath243 } \\mathbf{e}_{\\alpha } \\left ( \\tilde{s};\\mathbf{x},\\mathbf{b}\\right ) = \\min_{g\\in path\\left [ \\mathbf{x},% \\mathbf{b}\\right ] } \\mathbf{m}_{\\alpha } \\left ( g\\right ) \\text{,}\\end{aligned}\\]]by the optimality of @xmath224 and ( [ two_min_equal ] ) .",
    "thus , @xmath222 is an optimal allocation path .",
    "@xmath226  suppose @xmath244 $ ] is an optimal allocation path . by proposition [ path_map ] , @xmath222 for some @xmath201 $ ] with @xmath245 .",
    "then , the optimality of @xmath224 follows from the optimality of @xmath31 and ( [ two_min_equal ] ) .",
    "theorem [ theorem 1 ] shows that in the ramified optimal allocation problem , there exists an equivalence between optimal allocation plan and optimal assignment map .",
    "this result has an analogous counterpart in monge - kantorovich problems , but has not been observed in current literature on ramified transport problems .",
    "an implication of this theorem is that one can instead search for an optimal assignment map in order to find an optimal allocation plan .",
    "each optimal assignment map @xmath201 $ ] would give an optimal allocation plan @xmath246 $ ] as in ( [ q_s ] ) .",
    "for this consideration , the rest of this paper will focus attention on characterizing the various properties of optimal assignment maps .",
    "in this section , we develop a method of marginal transportation analysis and use it to study the properties of optimal assignment maps .",
    "we first formalize a concept of marginal transportation cost for a single - source transport system .",
    "let @xmath247 be a transport path from a _ single source _",
    "@xmath248 to an atomic measure @xmath12 of mass @xmath249 . for any point @xmath250 on the support of @xmath251",
    ", we set @xmath252which represents the mass flowing through @xmath250 , where @xmath40 denotes the ending endpoint of edge @xmath38 . since @xmath31 has a single source and contains no cycles , for any point @xmath250 on @xmath31 , there exists a unique polyhedral curve @xmath253 on @xmath31 from @xmath248 to @xmath250 .",
    "moreover , for any point @xmath254 , it holds that @xmath255when the mass at @xmath250 changes by an amount @xmath256 with @xmath257 @xmath258 , then the mass flowing through each point of @xmath253 also changes by @xmath256 . as a result ,",
    "the corresponding increment of the transportation cost is @xmath259the _  marginal transportation cost _ at @xmath250 via @xmath31 is defined by @xmath260the following proposition establishes some properties of the function @xmath261 .",
    "those properties are the key elements of marginal transportation analysis used to study optimal assignment maps later .",
    "[ prop increment cost]for any @xmath247 and @xmath250 on @xmath31 , we have @xmath262 ,   \\label{alternative}\\]]where @xmath263 . moreover , for any @xmath264 , we have @xmath265 \\int_{\\gamma _ { p}}ds\\leq \\delta c_{g}\\left ( p,\\delta m\\right ) \\leq \\left [ \\left ( \\theta \\left ( p\\right ) + \\delta m\\right ) ^{\\alpha } -\\theta \\left ( p\\right ) ^{\\alpha } % \\right ] \\int_{\\gamma _ { p}}ds .",
    "\\label{incrementcost_comparison}\\]]if , in addition , @xmath266 is optimal in ( [ ramified transport problem ] ) , then @xmath267for any @xmath257 @xmath268 with @xmath250 on @xmath31 .",
    "let @xmath263 , then when @xmath269 $ ] , @xmath270 ds \\\\",
    "& = & -\\delta c_{\\tilde{g}}\\left ( p,\\delta m\\right ) .\\end{aligned}\\]]for any @xmath271 , note that the function @xmath272 is monotonic non - increasing on @xmath273 when @xmath274 . by ( [ density_comparison ] )",
    ", we have @xmath275thus , by ( [ marginal_increment ] ) , inequalities ( incrementcost_comparison ) hold .    when @xmath31 is also optimal , we have @xmath276 . for any @xmath257 @xmath268 , since @xmath277 , we have @xmath278    now , we apply marginal transportation analysis developed above to study properties of an optimal assignment map .",
    "let @xmath279 $ ] be any optimal allocation path . by theorem [ theorem 1 ]",
    ", @xmath31 must be in the form of ( [ g_s ] ) , which is simply a disjoint union of single - source paths @xmath197 s .",
    "for any @xmath250 on @xmath31 , there exists a unique @xmath280 such that @xmath250 is on @xmath197 .",
    "thus , we can define the corresponding @xmath281 and @xmath282 as in ( [ density ] ) and ( [ marginal_increment ] ) .",
    "then , we set @xmath283for any @xmath250 on the support of @xmath31 .    for any @xmath284 and @xmath285 , define@xmath286the function @xmath287 is decreasing in @xmath288 and increasing in @xmath289 ; also @xmath290 for any @xmath285 . for @xmath179 ,",
    "set @xmath291 when @xmath292 and @xmath293 when @xmath294 .",
    "[ prop key inequality]suppose @xmath295 $ ] is an optimal allocation path as given in ( [ equation_g ] ) .",
    "let @xmath296 be a point on @xmath297 for some @xmath298 and @xmath299 $ ] .",
    "for any @xmath300 on @xmath31 with @xmath301 having zero length , we have@xmath302and @xmath303where @xmath304 stands for the standard norm on @xmath305 . in particular , for any @xmath306 ,",
    "@xmath307moreover , suppose @xmath300 is on @xmath197 with @xmath308 and @xmath309 , then @xmath310    let @xmath311+\\left ( \\delta m\\right ) \\gamma _ { p^{\\ast } } $ ] , where @xmath312 $ ] denotes the line segment from @xmath250 to @xmath300 . then ,",
    "when the intersection of polyhedral curves @xmath313 has length zero , we have @xmath314 ds+\\left ( \\delta m\\right ) ^{\\alpha } \\left\\vert p - p^{\\ast } \\right\\vert \\\\ & & + \\int_{\\gamma _ { p^{\\ast } } } \\left [ \\left ( \\theta \\left ( s\\right ) + \\delta m\\right ) ^{\\alpha } -\\theta \\left ( s\\right ) ^{\\alpha } \\right ] ds \\\\ & \\geq & \\mathbf{m}_{\\alpha } \\left ( \\hat{g}\\right ) -\\mathbf{m}_{\\alpha } \\left ( g\\right ) \\geq 0\\text { , by the optimality of } g.\\end{aligned}\\]]to prove ( [ p_p * ] ) , we observe that @xmath315 \\\\ & = & \\left ( \\delta m\\right ) ^{\\alpha } \\left\\vert p - p^{\\ast } \\right\\vert + \\left [ \\left ( \\theta \\left ( p^{\\ast } \\right ) + \\delta m\\right ) ^{\\alpha } -\\left ( \\theta \\left ( p^{\\ast } \\right ) \\right ) ^{\\alpha } \\right ] \\int_{\\gamma _ { p^{\\ast } } } ds \\\\ & \\geq & \\left ( \\delta m\\right ) ^{\\alpha } \\left\\vert p - p^{\\ast } \\right\\vert + \\delta c_{g}\\left ( p^{\\ast } , \\delta m\\right ) \\text { , by ( \\ref% { incrementcost_comparison } ) } \\\\ & \\geq & -\\delta c_{g}\\left ( p,-\\delta m\\right ) \\text { , by ( \\ref% { increment_cost_inequality } ) } \\\\ & = & \\delta c_{\\tilde{g}}\\left ( p,\\delta m\\right ) \\text { , by ( \\ref{alternative}% ) } \\\\ & \\geq & \\left [ \\left ( \\mathfrak{m}\\left ( \\mathbf{b}_{s}\\right ) \\right ) ^{\\alpha } -\\left ( \\mathfrak{m}\\left ( \\mathbf{b}_{s}\\right ) -\\delta m\\right ) ^{\\alpha } \\right ] \\int_{\\gamma _ { p}}ds\\text { , by ( \\ref% { incrementcost_comparison } ) } \\\\ & = & \\left ( \\delta m\\right ) ^{\\alpha } \\rho _ { \\alpha } \\left ( \\mathfrak{m}\\left ( \\mathbf{b}_{s}\\right ) , \\delta m\\right ) \\int_{\\gamma _ { p}}ds\\geq \\left ( \\delta m\\right ) ^{\\alpha } \\rho _ { \\alpha } \\left ( \\mathfrak{m}\\left ( \\mathbf{b}% _ { s}\\right ) , \\delta m\\right ) \\left\\vert p - x_{s}\\right\\vert \\text{.}\\end{aligned}\\ ] ]    in particular , when @xmath316 for some @xmath22 , ( [ p_p * ] ) becomes ( [ p_x_i ] ) as @xmath317 .    now , suppose @xmath300 is on @xmath197 with @xmath308",
    ". apply ( [ p_x_i ] ) to @xmath300 , we have @xmath318therefore , @xmath319    proposition [ prop key inequality ] rests on the key inequality ( increment_cost_inequality ) , which follows intuitively by standard marginal argument . for convenience of illustration ,",
    "let @xmath250 denote the location @xmath320 of household @xmath65 who is connected to factory @xmath5 by some curve @xmath321 a planner will find it not optimal to choose an allocation path @xmath31 such that @xmath322 for @xmath300 on some @xmath323 it is because in this case the planner has a less costly alternative by transferring @xmath324 amount of production from factory @xmath5 to factory @xmath22 and transporting this additional @xmath256 units of commodity from factory @xmath22 first to a stopover point @xmath300 via curve @xmath325 and then directly from @xmath300 to household @xmath65 .",
    "it s clear that this strategy will send the same amount of commodity to household @xmath65 as before .",
    "however , by the inequality , the reduction in transportation cost @xmath326 on curve @xmath253 exceeds its increase counterpart @xmath327 which can not be the case for an optimal allocation path .",
    "by means of this proposition , we easily obtain the following results regarding the properties of optimal assignment maps .",
    "[ theorem marginal]suppose @xmath201 $ ] is an optimal assignment map .",
    "let @xmath199 and @xmath328 . if @xmath329then @xmath330 .",
    "if @xmath331then @xmath332 .",
    "assume @xmath333 but @xmath334 . let @xmath222 be an allocation path as in ( [ g_s ] ) . by theorem [ theorem 1 ] , @xmath152 $ ] is an optimal allocation path . clearly , @xmath72 is on @xmath297 when @xmath335",
    ". apply ( [ p_x_i ] ) to @xmath336 and @xmath337 , we have @xmath338which contradicts ( [ min_far ] ) .    on the other hand , for each @xmath308 , if @xmath339 , then @xmath340by ( [ min_far ] ) , @xmath341 and @xmath342 for such @xmath308 .",
    "thus , @xmath332 .    intuitively speaking , inequality ( [ min_far ] ) says that if household @xmath65 locates closer  to some factory than factory @xmath5 , then the planner will not assign her to the factory @xmath5 . here",
    "the relative closeness is weighted by a number @xmath343 .",
    "when the production @xmath344 at factory @xmath5 is low , due to the transport economy of scale , one would expect that the planner would less likely assign household @xmath65 to factory @xmath5 .",
    "this predication is justified by theorem [ theorem marginal ] because in this case , inequality ( [ min_far ] ) becomes more likely to hold as @xmath345 is high .",
    "the later part ( [ min_close ] ) of the theorem states a special case that if household @xmath65 is located uniformly closer to a factory @xmath5 than to other factories , then she will be assigned to factory @xmath5 under any optimal assignment map .",
    "we now give a geometric description of the sets @xmath346 and @xmath347 .",
    "[ lemma ball]for any constant @xmath348 , the set @xmath349where @xmath350 denotes the open ball @xmath351 .    indeed , @xmath352    clearly",
    ", the ball @xmath353 given above contains @xmath23 but not @xmath161 . by lemma [ lemma ball ] , ( [ min_far ] )",
    "says that geometrically , if household @xmath65 lies in the union of @xmath354 open balls@xmath355where @xmath356 , then @xmath330 .",
    "also , ( [ min_close ] ) says that if the household @xmath65 lies in the intersection of @xmath357 balls @xmath358 for some @xmath5 , then @xmath332 .    since @xmath359 and the function @xmath360 is decreasing , we have @xmath361 and thus @xmath362for any optimal assignment map @xmath224 .",
    "note that the set @xmath363 ( or @xmath364 ) is still the union ( or intersection ) of @xmath354 balls in @xmath9 , and is independent of @xmath224 .",
    "for example , the sets @xmath364 with @xmath365 and @xmath366 are given by figure [ g_2 ] , where @xmath367 and @xmath368 .     with @xmath369 ( blue ) and @xmath366 ( red ) when @xmath370.,scaledwidth=50.0% ]    [ corollary omega0nj]for any optimal assignment map @xmath371 $ ] and @xmath298 , if @xmath372 , then @xmath330 . if @xmath373 , then @xmath332 .",
    "it follows from theorem [ theorem marginal ] , ( [ f0(nj ) ] ) and ( omega0(nj ) ) .",
    "this corollary shows that if the household @xmath65 falls into the region @xmath374 of some factory @xmath375 then she will be assigned to this factory under any optimal assignment map @xmath224 . as a result ,",
    "if all households belong to the union of regions @xmath364 of factories @xmath5 except factory @xmath22 , then factory @xmath22 will not be used . note that as @xmath376 is increasing in @xmath377 the size of the region @xmath364 increases with @xmath378 as shown in figure [ g_2 ] .",
    "[ theorem_neighborhood]suppose @xmath201 $ ] is an optimal assignment map , @xmath4 and @xmath199 with @xmath379 . if @xmath380 for some @xmath381 and @xmath382then @xmath330 . if @xmath383 for some @xmath381 and @xmath384then @xmath332 .    in the first scenario ,",
    "assume @xmath380 , @xmath385 but @xmath332 .",
    "then @xmath386a contradiction with @xmath387 .",
    "thus , @xmath388    now , in the second scenario , assume @xmath383 , @xmath389 but @xmath390 for some @xmath391 .",
    "then , @xmath392a contradiction with @xmath393 as @xmath394 and @xmath395 .",
    "thus , @xmath396    the first part of theorem [ theorem_neighborhood ] says that if some household @xmath4 is not assigned to factory @xmath5 , then any other nearby household @xmath65 ( i.e. within the neighborhood region @xmath397 ) with a smaller demand will also not be assigned to factory @xmath5 .",
    "the second part says that if some household @xmath4 is assigned to factory @xmath5 , then any other nearby household @xmath65 ( i.e. within the neighborhood region @xmath398 ) with a smaller demand will also be assigned to factory @xmath5 .",
    "these findings agree with the intuition that grouping with nearby households of large demand would make it more likely to realize the benefit of transport economy of scale .",
    "as seen in the previous section , under an optimal assignment map , a household will be assigned to some factory if she lives close to the factory ( theorem [ theorem marginal ] ) or she has some nearby neighbors assigned to the factory ( theorem [ theorem_neighborhood ] ) . in this section , we will show a reverse result ( theorem [ autarky ] ) using a method of projectional analysis .    throughout this section",
    ", we consider the projection map from @xmath9 to the line @xmath399 for fixed points @xmath400 with @xmath401 . under this map ,",
    "each point @xmath402 is mapped to @xmath403 with @xmath404where @xmath405 stands for the standard inner product in @xmath9 .",
    "for instance , when @xmath406 , and @xmath407 , for each @xmath408 , @xmath409 gives the first coordinate of @xmath410 .",
    "we start with two lemmas regarding properties of a single - source transport system .",
    "these lemmas will play a crucial role in establishing theorem autarky later .    [",
    "comparison ] suppose @xmath411is an atomic measure on @xmath412 , and @xmath413 .",
    "if there exists a @xmath414 such that @xmath415then @xmath416where @xmath417and @xmath418    without loss of generality , we assume that @xmath419 .",
    "let @xmath420 be an optimal transport path .",
    "as in ( [ g_matrix ] ) , there exists a unique curve @xmath421 from @xmath422 to @xmath423 for each @xmath65 . since @xmath424 @xmath425 , there exists a point @xmath426 on the curve @xmath427 such that @xmath428 .",
    "let @xmath429then , by the optimality of @xmath31 , we have@xmath430for @xmath431 and @xmath432 given in ( [ constantr ] ) , we consider the set @xmath433which is an @xmath434 dimensional ball perpendicular to the line passing through @xmath250 in the direction @xmath435 . by means of ( [ constantr ] ) , the measure @xmath436 is supported on @xmath437 .",
    "let @xmath438be the projection point of @xmath422 onto the ball @xmath437 .",
    "one can show as in xia and vershynina ( * ? ? ?",
    "* lemma 2.3.1 ) that @xmath439on the other hand , by xia ( * ? ? ?",
    "* theorem 3.1 ) , we have @xmath440where @xmath441therefore , @xmath442 \\text { , by the triangle inequality } \\\\ & = & d_{\\alpha } \\left ( \\mathbf{\\tilde{c}},\\mathfrak{m}\\left ( \\mathbf{c}\\right ) \\delta _ { p}\\right ) -d_{\\alpha } \\left ( \\mathbf{\\tilde{c}},\\mathfrak{m}\\left ( \\mathbf{c}\\right ) \\delta _ { q}\\right ) \\text { , by ( \\ref{d_alpha_cut } ) } \\\\ & \\geq & \\mathfrak{m}\\left ( \\mathbf{c}\\right ) ^{\\alpha } |\\pi \\left ( p\\right ) -t_{1}|-\\mathfrak{m}\\left ( \\mathbf{c}\\right ) ^{\\alpha } \\left ( cr+|\\pi \\left ( q\\right ) -t_{1}|\\right ) .\\end{aligned}\\ ] ]    [ decomposition]let @xmath12 be an atomic measure as given in ( measure_c ) and @xmath443 .",
    "if the set @xmath444 is decomposed as the disjoint union of two nonempty subsets @xmath445then , for any optimal transport path @xmath446 , there exist a vertex point @xmath447 and a decomposition of each @xmath448 : @xmath449such that @xmath31 can be decomposed as@xmath450where for @xmath451 , @xmath197 is an optimal transport path from @xmath452 to @xmath453 for @xmath454@xmath455 is an optimal transport path from @xmath456 to @xmath457 for @xmath458and @xmath459 are pairwise disjoint except at @xmath422 .",
    "moreover , ( [ g_decompoistion ] ) implies @xmath460and by the optimality of @xmath31 , it follows@xmath461    for any @xmath410 on the support of @xmath31 , since @xmath31 is a transport path from a single source @xmath248 , there exists a unique curve @xmath462 on @xmath31 from @xmath248 to @xmath410 .",
    "also , it is easily observed that @xmath463    now , let @xmath464 be the union of all curves @xmath427 with @xmath465 for @xmath451 , and set @xmath466by ( [ single_source ] ) , if @xmath467 , then @xmath468 .",
    "this shows that @xmath469 is a connected subset of the support of @xmath251 containing @xmath248 . since @xmath469 contains no cycles , it is a contractible set containing @xmath248",
    ". then , by calculating the euler characteristic number of @xmath470 , we have either @xmath471 or @xmath469 has at least two endpoints ( i.e. vertices of degree @xmath98 ) .    if @xmath471 , then set @xmath472 , and @xmath473 for @xmath451 . if @xmath474 , pick @xmath422 to be an endpoint of  @xmath469 with @xmath475 .",
    "since @xmath476 , the set @xmath477    for any @xmath478 , @xmath422 divides the curve @xmath427 into two parts : @xmath479 from @xmath248 to @xmath422 and @xmath480 from @xmath422 to @xmath423 .",
    "since @xmath422 is an endpoint of @xmath469 , we have @xmath481for @xmath451 , define @xmath453 using ( [ equation_c_tilde ] ) and denote the part of @xmath31 from @xmath482 to @xmath453 by @xmath197 .",
    "the rest of @xmath31 is denoted by @xmath483 .",
    "then , by construction , @xmath459 are pairwise disjoint except at @xmath422 , and thus ( [ m_g_decomposition ] ) holds . by the optimality of @xmath31",
    ", each @xmath197 must also be optimal for @xmath484 , which yields ( d_a_sum ) .",
    "the following theorem states that : under an optimal assignment map , a household will be assigned to some factory only when either she lives close to the factory or she has some nearby neighbors assigned to the factory . in the first situation ,",
    "the planner takes advantage of relative spatial locations between households and factories ; while in the second situation , the planner takes advantage of group transportation due to transport economy of scale embedded in ramified transport technology .",
    "let @xmath201 $ ] be an optimal assignment map .",
    "for each @xmath485 , define@xmath486and@xmath487    [ autarky ] suppose @xmath201 $ ] is an optimal assignment map .",
    "then , for any @xmath306 and @xmath488 with @xmath489 , there exists @xmath490 , such that @xmath491and @xmath492 is between @xmath493 and @xmath494 , where @xmath495 and @xmath496 are the constants given in ( constantc ) and ( [ r_i ] ) respectively .    without loss of generality",
    ", we may assume that @xmath497 .",
    "let @xmath498for some @xmath499 .",
    "we want to prove ( [ projection_closeness ] ) by contradiction .",
    "assume for any @xmath500 with @xmath501,@xmath502i.e.@xmath503then , there exists a real number @xmath504 such that @xmath505whenever @xmath506 .",
    "in particular , @xmath507as @xmath508 . as a result , @xmath509 can be expressed as the disjoint union of two sets:@xmath510where @xmath511clearly , @xmath512 . if @xmath513 , then @xmath514 and thus @xmath515let @xmath192 and @xmath193 be given as in ( [ a_b_i ] ) . by lemma @xmath516 with @xmath517 , we have @xmath518a contradiction to the optimality of @xmath224 .",
    "thus , @xmath519 .",
    "let @xmath195 be an optimal transport path .",
    "then , by theorem [ theorem 1 ] and optimality of @xmath520 , @xmath521 is an optimal allocation path .",
    "since both @xmath522 and @xmath523 are nonempty , by setting @xmath524 and @xmath525 in lemma [ decomposition ] , there exists a point @xmath526 such that @xmath197 can be decomposed as@xmath527with@xmath528here , for @xmath529 , @xmath530 is an optimal transport path from @xmath531 to @xmath532 for some positive atomic measures @xmath532 with @xmath533 and @xmath534    if @xmath535 , then we can modify @xmath31 into another allocation path @xmath536 by just replacing the corresponding transport path from factory @xmath22 to households @xmath537 with an optimal transport path from factory @xmath538 to @xmath539 .",
    "more precisely , we replace @xmath197 by @xmath540where @xmath541 is an optimal transport path from @xmath542 to @xmath539 , @xmath543 and @xmath544where @xmath545 is the curve on @xmath31 from @xmath23 to @xmath422",
    ". equation ( g_bar ) and ( [ g3 ] ) imply respectively @xmath546and @xmath547consequently , by ( [ equation_m_g_i ] ) , @xmath548where the last equality follows from the optimality of both @xmath549 and @xmath541 .    since @xmath51 ,",
    "for @xmath550 , we have@xmath551due to the optimality of @xmath31 , equation ( [ equation(m_g ) ] ) says@xmath552as a result,@xmath553thus , @xmath554 , which contradicts the optimality of @xmath31 , and thus the inequality ( [ projection_closeness ] ) must hold .    if @xmath555 , then let @xmath556 be the first point of @xmath557 with @xmath558 .",
    "we can modify @xmath31 into another allocation path @xmath559 by just replacing the corresponding transport path from the point @xmath556 to households @xmath560 with an optimal transport path from @xmath556 to @xmath561 .",
    "more precisely , we replace @xmath197 by @xmath562where @xmath563 , @xmath564 is an optimal transport path from @xmath565 to @xmath566 , and @xmath567where @xmath568 is the part of the curve @xmath545 from @xmath556 to @xmath422 .",
    "similar arguments as in the previous case show that @xmath569thus @xmath570 , which contradicts the optimality of @xmath31 .",
    "therefore , the inequality ( [ projection_closeness ] ) must hold .",
    "the following corollary states a scenario when a factory is located far away from the community of households , a planner will never assign any production to this factory under any optimal assignment map .    [",
    "far away]suppose for some @xmath306 , @xmath571for each @xmath10 , where @xmath495 is the constant given in ( constantc ) and @xmath572then , @xmath573 for any optimal assignment map @xmath574 $ ] .",
    "assume there exists @xmath199 with @xmath575 .",
    "without loss of generality , we may assume @xmath576 .",
    "thus , there exists an @xmath577 such that @xmath578for this @xmath579 , by theorem [ autarky ] , there exists a @xmath580 with @xmath581 satisfying ( [ projection_closeness ] ) . by the maximality of @xmath582 , @xmath583 for any @xmath584 .",
    "thus , @xmath585 and by ( [ projection_far ] ) , @xmath586a contradiction with ( [ projection_closeness ] ) .",
    "the next corollary shows an autarkysituation : if households and factories are located on two disjoint areas lying distant away from each other , then the demand of households will solely be satisfied from factories within the same area .",
    "[ autarky1]suppose @xmath587for some @xmath588 @xmath589 with @xmath590where the constants @xmath495 and @xmath432 are given in ( [ constantc ] ) and ( constant_r ) .",
    "if @xmath591\\neq \\emptyset \\text { and } \\left\\ { \\pi \\left ( x_{1}\\right ) , \\cdots , \\pi \\left ( x_{k}\\right ) \\right\\ } \\cap \\lbrack t_{2},t_{2}+\\sigma ) \\neq \\emptyset ,   \\label{nonempty_zone}\\]]then for any optimal assignment map @xmath201 $ ] and interval @xmath592 $ ] or @xmath593 , we have @xmath594for @xmath10 .",
    "it is sufficient to prove that if @xmath595 for some @xmath22 , then the set @xmath596must be empty . indeed , if not , pick @xmath597for some @xmath65 . by theorem [ autarky ] , there exists @xmath598 such that @xmath506 , and @xmath599thus , @xmath600 . on the other hand ,",
    "the maximality of @xmath601 and ( [ empty_zone ] ) yield @xmath602 , a contradiction .    as a direct application of corollary [ autarky1 ] , the next corollary states that households living in a relatively isolated area are more likely to receive their commodity from local factories .",
    "[ autarky2]let @xmath603 @xmath604 be real numbers with @xmath605where the  constants @xmath495 and @xmath432 are given in ( [ constantc ] ) and ( constant_r ) .",
    "= \\left\\ { \\pi \\left ( x_{i}\\right ) \\right\\ }   \\label{single_factory}\\]]for some @xmath306 , and @xmath608\\neq \\emptyset \\text { , } \\left\\ { \\pi \\left ( x_{1}\\right ) , \\cdots , \\pi \\left ( x_{k}\\right ) \\right\\ } \\cap \\lbrack t_{2}^{+},t_{2}^{+}+\\sigma ) \\neq \\emptyset , \\]]then for any optimal assignment map @xmath201 $ ] , @xmath609 \\right\\ } .\\ ] ]    for any @xmath610 , using @xmath611 , @xmath612 in corollary [ autarky1 ] , and the fact @xmath613 , we have @xmath614 .",
    "similarly , using @xmath615 , @xmath616 in corollary [ autarky1 ] , and the fact @xmath617 $ ] , we have @xmath618 $ ] .",
    "thus , @xmath619 $ ] .",
    "this shows that @xmath620 \\right\\ } $ ] .",
    "on the other hand , for any @xmath65 with @xmath621 $ ] , we have @xmath622 and @xmath623 $ ] . using corollary [ autarky1 ] again , we have @xmath624 and @xmath625 $ ] .",
    "thus , @xmath626 $ ] . by ( single_factory ) , @xmath489 . therefore ,",
    "@xmath627 \\right\\ } \\subseteq s^{-1}\\left ( i\\right ) $ ] .",
    "in this section , we show that the properties of optimal assignment maps explored in previous sections can shed light on the search for those maps .",
    "the analysis is built upon a notion of state matrix defined as follows .",
    "let @xmath628 be an @xmath629 matrix with @xmath630 .",
    "the matrix @xmath631 is called    1 .   a state matrix for an optimal assignment map @xmath224 if @xmath632 whenever @xmath633 .",
    "2 .   a uniform state matrix if @xmath631 is a state matrix for any optimal assignment map .    one could think of a state matrix as an information set of a planner during the search process for optimal assignment maps .",
    "an entry @xmath633 ( or @xmath634 ) simply denotes that the planner has ( or has not ) excluded the possibility of assigning household @xmath4 to factory @xmath5 .",
    "recall that finding an optimal assignment map is to minimize the functional @xmath635 over the set @xmath636 $ ] whose cardinality is @xmath637 .",
    "any zero entry of a state matrix @xmath631 for an optimal assignment map @xmath224 may exclude as many as @xmath638 assignment maps in @xmath184 $ ] from being @xmath224 .",
    "the more zero entries in a state matrix @xmath631 , the more information about @xmath224 is contained in @xmath631 .",
    "consequently , we aim at finding a state matrix @xmath631  for @xmath224 with as many zero entries as possible , using properties of optimal assignment maps studied in previous sections . when @xmath631 has exactly one non - zero entry in each column , @xmath224 is completely determined by those non - zero entries in @xmath631 .",
    "we first explore the implication of theorem [ theorem marginal ] on the search for optimal assignment maps in the context of state matrix . for any state matrix @xmath639",
    ", we consider a @xmath629 matrix @xmath640where @xmath641and the function @xmath642 is given in ( [ w - function ] ) . here",
    ", @xmath643 denotes the maximum amount of commodity produced at factory @xmath22 one could conjecture using the existing information in state matrix @xmath644    for any state matrix @xmath631 , define@xmath645and@xmath646for any @xmath647 and @xmath10 . by lemma [ lemma ball ] , each @xmath648 is the union of @xmath354 open balls@xmath649and each set @xmath650 is the intersection of @xmath354 open balls@xmath651    the matrix@xmath652is a uniform state matrix .",
    "then , @xmath653 with @xmath654which is independent of @xmath22 . here",
    ", @xmath655where @xmath656 and @xmath657 are given in ( [ f0(nj ) ] ) and ( [ omega0(nj ) ] ) .",
    "let @xmath201 $ ] be an optimal assignment map .",
    "define @xmath658with @xmath659then , @xmath660 with @xmath661  note that @xmath662where @xmath663 and @xmath664 are given in ( [ min_far ] ) and ( [ min_close ] ) .",
    "given two @xmath629 real matrices @xmath639 and @xmath665 , we define    1 .",
    "@xmath666 if @xmath667 for each @xmath22 and @xmath65 .",
    "2 .   @xmath668 if @xmath666 but @xmath669 .",
    "let @xmath631and @xmath670 be two state matrices for an optimal assignment map @xmath520 .",
    "if @xmath666 , then@xmath671and @xmath672    for each @xmath22 , since @xmath666 , @xmath673then , since @xmath674 is decreasing , it follows @xmath675for each @xmath22 and @xmath65 . by definition , we have both ( [ w_comparison ] ) and ( [ omega_inclusion ] ) .",
    "let @xmath631 be a state matrix for an optimal assignment map @xmath224 . by definitions of @xmath676 in ( [ u_0 ] ) and @xmath677 in ( [ u_s ] )",
    ", it follows that @xmath678thus , by ( [ omega_inclusion ] ) , we have @xmath679these relations , together with theorem [ theorem marginal ] , immediately imply the following proposition :    [ u_1_prop]let @xmath680 be a state matrix for an optimal assignment map @xmath201 $ ] .",
    "for some @xmath5 and @xmath65 ,    1 .   if @xmath681 , then @xmath682 ; 2 .",
    "if @xmath683 , then @xmath684    suppose @xmath631 is a state matrix for an optimal assignment map @xmath371 $ ] .",
    "let @xmath685 be a @xmath629 matrix with @xmath686then , @xmath687 is also a state matrix for @xmath224 with @xmath688 .",
    "if @xmath689 , then either @xmath690 or @xmath691 . in the first case , since @xmath631 is a state matrix for @xmath224 , by definition , @xmath692 . in the second case , by proposition [ u_1_prop ] , @xmath692 .",
    "thus , @xmath687 is also a state matrix for @xmath224 with @xmath693 .",
    "we now explore the implication of theorem [ theorem_neighborhood ] on the search for optimal assignment maps .",
    "suppose @xmath631 is a state matrix for an optimal assignment map @xmath224 .",
    "if @xmath633 for some @xmath694 and @xmath298 , then for each @xmath695 with @xmath379 , we consider the set@xmath696where @xmath697    let @xmath631 and @xmath670 be two state matrices for an optimal assignment map @xmath698 . if @xmath666 , then @xmath699for any @xmath298 , @xmath700 with @xmath633 , and @xmath379 for @xmath701 .    for each @xmath22 , if @xmath702 , then @xmath703 as @xmath666 . by ( [ w_comparison ] )",
    ", we have @xmath704 .",
    "thus , @xmath705consequently , ( [ fishu_comparison ] ) follows from ( [ fishu ] ) .    as a result , by",
    "( [ u_inclusion]),@xmath706where @xmath707 is given in ( min_far_neigh ) .",
    "the following proposition and its associated corollary follow from theorem [ theorem_neighborhood ] .",
    "suppose @xmath631 is a state matrix for an optimal assignment map @xmath371 $ ] .",
    "if @xmath708 for some @xmath709 with @xmath633 and @xmath379 , then @xmath710 .",
    "suppose @xmath631 is a state matrix for an optimal assignment map @xmath371 $ ] .",
    "let @xmath711 be a @xmath629 matrix with @xmath712then , @xmath713 is also a state matrix for @xmath224 with @xmath714 .",
    "we now explore the implication of theorem [ autarky ] on the search for optimal assignment maps .",
    "suppose @xmath631 is a state matrix for an optimal assignment map @xmath224 . for each @xmath306",
    ", let @xmath715clearly , @xmath716where @xmath717 is defined in ( [ psi ] ) .",
    "now , for @xmath718 given in ( pi_projection ) , we define @xmath719without loss of generality , we may assume that @xmath720with @xmath721    suppose @xmath680 is a state matrix for an optimal assignment map @xmath201 $ ] . for each @xmath722 , let @xmath723 and @xmath724 . if @xmath725where @xmath495 and @xmath496 are the constants given in ( [ constantc ] ) and ( r_i_u ) respectively , then @xmath726 for any @xmath727 .",
    "similarly , if @xmath728then @xmath726 for any @xmath729 .    assume ( [ tunnel1 ] ) holds but @xmath730 for some @xmath731 .",
    "without loss of generality , we may assume that @xmath732note that @xmath733 by ( [ order_pi_i ] ) and ( tunnel1 ) .",
    "then , by theorem [ autarky ] , there exists a @xmath734 with @xmath735 such that @xmath736by the maximality of @xmath737 and @xmath734 , we know @xmath738 .",
    "thus , by the ordering in ( order_pi_i ) , we have @xmath739therefore , @xmath740a contradiction with ( [ turnel_t_star ] ) .",
    "this proves ( [ tunnel1 ] ) .",
    "similar arguments give ( [ tunnel2 ] )",
    ".    for each @xmath741 , and @xmath742 , denote @xmath743 , & \\text{if } \\lambda \\leq \\pi \\left ( x_{i}\\right ) \\\\",
    "\\lbrack \\lambda , \\infty ) \\text { , } & \\text{if } \\lambda >",
    "\\pi \\left ( x_{i}\\right)% \\end{array}% \\right .",
    ".\\]]then , for each @xmath718 given in ( pi_projection ) , we define @xmath744    suppose @xmath631 is a state matrix for an optimal assignment map @xmath371 $ ] .",
    "let @xmath745 be a @xmath629 matrix with @xmath746then , @xmath747 is also a state matrix for @xmath224 with @xmath748 .",
    "depending on spatial locations of households and factories , for each fixed @xmath485 , the planner may choose @xmath749 to be one of the standard coordinate functions in @xmath9 , i.e. @xmath750 for some fixed @xmath751 .",
    "in this case , ( [ tunnel1 ] ) and ( [ tunnel2 ] ) may be simply expressed in terms of coordinates of @xmath23 s and @xmath72 s .",
    "another reasonable choice is to set @xmath752 , where @xmath753this will minimize @xmath496 given in ( [ r_i_u ] ) , because the line passing through @xmath754 in direction @xmath755 i.e. @xmath756provides the least supremum norm approximation for @xmath757 in @xmath9 .    given a state matrix @xmath631 for an optimal assignment map @xmath224 , we have used results from previous sections to provide three updated state matrices @xmath758 , @xmath759 , for @xmath631 .",
    "the next proposition makes it possible to combine them together into a further updated state matrix .",
    "[ prop min]suppose @xmath639 and @xmath760 are two state matrices for an optimal assignment map @xmath185 $ ] .",
    "then , the matrix @xmath761 given by@xmath762is also a state matrix for @xmath224 .    if @xmath763 , then either @xmath690 or @xmath763 .",
    "both cases give @xmath692 .",
    "proposition [ prop min ] says that one could deduce more information from any two existing state matrices regarding the optimal assignment map .",
    "using this proposition , we immediately have the following corollary .",
    "[ u updating]suppose @xmath631 is a state matrix for an optimal assignment map @xmath201 $ ] .",
    "for each @xmath22 and @xmath65 , define @xmath764where @xmath765 , @xmath766 and @xmath767 are given in ( u_ij_1 ) , ( [ nbhd_u ] ) and ( [ u_ij_3 ] ) respectively .",
    "then , @xmath768 is also a state matrix for @xmath224 with @xmath769 .",
    "this idea of updating a state matrix @xmath631 into another state matrix @xmath770 as in corollary [ u updating ] can be implemented iteratively to obtain an even further updated state matrix .",
    "given any initial state matrix @xmath771 ( e.g. @xmath772 as in ( [ u_0 ] ) ) for an optimal assignment map @xmath224 .",
    "for each @xmath773 define @xmath774this gives a non - increasing sequence of @xmath629 matrices @xmath775 whose entries are either @xmath776 or @xmath98 .",
    "hence , there exists an @xmath777 such that @xmath778we denote this @xmath779 as @xmath780 . clearly , the matrix @xmath780 is still a state matrix for @xmath224 with @xmath781 and @xmath782 .",
    "this updated state matrix @xmath780 contains more information about @xmath224 than the initial state matrix @xmath783 because @xmath780 contains more zero entries . in some non - trivial cases as illustrated in the following example , @xmath784 may have exactly one non - zero entry in each column .",
    "in such a situation , @xmath780 completely determines the optimal assignment map @xmath224 .",
    "let @xmath631 be a uniform state matrix ( e.g. @xmath772 as in ( u_0 ) ) , and suppose that @xmath785if for each @xmath10,@xmath786for some @xmath787 , then @xmath788 given by @xmath789 is the optimal assignment map .",
    "it is sufficient to show that for any optimal assignment map @xmath224 , it holds that @xmath790 for any @xmath65 . indeed , for any @xmath791 , if @xmath792 , then @xmath330 because @xmath631 is a state matrix for @xmath224 . if @xmath793 , then by assumption ( [ assumption_example ] ) , either @xmath681 or @xmath794 for some @xmath795 with @xmath796 . if @xmath797 , then by proposition u_1_prop , @xmath330 . if @xmath798 for some @xmath795 with @xmath796 , then either @xmath799 or @xmath800 . in the later case , since @xmath801 and @xmath379 , by theorem theorem_neighborhood , we still have @xmath330 .",
    "thus , in all cases for any @xmath791 , we know @xmath802consequently , when @xmath803 , we always have @xmath804 for any @xmath805 , and thus @xmath806 . using ( [ two_cases ] ) again , we get @xmath807 for any @xmath808 , which yields @xmath809 . repeating this process leads to the conclusion that @xmath810  for any @xmath811",
    "this paper proposes an optimal allocation problem with ramified transport technology in a spatial economy .",
    "a planner needs to find an optimal allocation plan as well as an associated optimal allocation path to minimize overall cost of transporting commodity from factories to households .",
    "this problem differentiates itself from existing ramified transportation literature in that the distribution of production among factories is not fixed but endogenously determined as in many allocation practices .",
    "it s shown that due to the transport economy of scale in ramified transportation , each optimal allocation plan corresponds equivalently to an optimal assignment map from households to factories .",
    "this optimal assignment map provides a natural partition of both households and allocation paths .",
    "we develop methods of marginal transportation analysis and projectional analysis to study properties of optimal assignment maps .",
    "these properties are then related to the search for an optimal assignment map in the context of state matrix .",
    "the ramified optimal allocation problem studied in this paper provides a prototype for a class of problems arising in spatial resource allocations .",
    "one natural extension is to allow the locations of factories @xmath812 to vary which then gives rise to an optimal location problem .",
    "an analogous optimal location problem in monge - kantorovich transportation has been extensively studied as in mcasey and mou @xcite , morgan and bolton @xcite and references therein .",
    "meanwhile , one may consider another extension of the ramified allocation problem by generalizing the atomic measure @xmath29 of households to an arbitrary probability measure @xmath813 , not necessarily atomic .",
    "in particular , when @xmath813 represents the lebesgue measure on a domain , a partition of @xmath814 given by an optimal assignment map may analogously lead to a partition of the domain .",
    "this consequently gives rise to an optimal partition problem of dividing the given domain into @xmath0 regions according to ramified optimal transportation .",
    "xia , q. : numerical simulation of optimal transport paths .",
    "arxiv:0807.3723 . the second international conference on computer modeling and simulation ( iccms 2010 ) .",
    "vol . 1 , 2010 , 521 - 525 .",
    "doi : 10.1109/iccms.2010.30 ."
  ],
  "abstract_text": [
    "<S> this paper proposes an optimal allocation problem with ramified transport technology in a spatial economy . </S>",
    "<S> ramified transportation is used to model the transport economy of scale in group transportation observed widely in both nature and efficiently designed transport systems of branching structures . </S>",
    "<S> the ramified allocation problem aims at finding an optimal allocation plan as well as an associated optimal allocation path to minimize overall cost of transporting commodity from factories to households . </S>",
    "<S> this problem differentiates itself from existing ramified transportation literature in that the distribution of production among factories is not fixed but endogenously determined as observed in many allocation practices . </S>",
    "<S> it s shown that due to the transport economy of scale in ramified transportation , each optimal allocation plan corresponds equivalently to an optimal assignment map from households to factories . </S>",
    "<S> this optimal assignment map provides a natural partition of both households and allocation paths . </S>",
    "<S> we develop methods of marginal transportation analysis and projectional analysis to study properties of optimal assignment maps . </S>",
    "<S> these properties are then related to the search for an optimal assignment map in the context of state matrix . </S>"
  ]
}