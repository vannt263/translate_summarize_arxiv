{
  "article_text": [
    "for any universal basis @xmath1 for single - qubit circuits , this natural problem arises : given a single - qubit gate @xmath2 and real @xmath3 , construct an ancilla - free @xmath1-circuit that approximates @xmath2 with precision @xmath4 .",
    "there is a well - known elementary reduction of this problem to its special case where @xmath2 is a @xmath0-rotation @xmath5 [ ref .  ] .",
    "the reduction does not work for all bases but it works for clifford+t , for pauli+v and for most other universal single - qubit bases in the literature .",
    "we restrict attention to the special case .",
    "the matrix of the approximating @xmath1-circuit has the form @xmath6 . in many cases , including those of clifford+t and pauli+v , the circuit can be efficiently constructed from the matrix .",
    "the problem becomes just to find an appropriate pair @xmath7 of complex numbers .    in article [ ref .",
    "] , peter selinger introduced a randomized - search technique for finding a desired pair @xmath7 in the clifford+t framework .",
    "the result was an efficient probabilistic circuit - synthesis algorithm for the clifford+t basis .",
    "`` under a mild hypothesis on the distribution of primes , the expected running time of the probabilistic algorithm is polynomial in @xmath8 , and the depth of the resulting approximating circuit is @xmath9 .",
    "if the gate to be approximated is a @xmath0-rotation , the t - count of the approximating circuit is @xmath10 . ''",
    "let v be the set of 3 unitary operators @xmath11 where @xmath12 is the identity matrix and @xmath13 are the single - qubit pauli matrices .",
    "the group generated by the three operators was introduced and studied in [ refs .  ] .",
    "the use of the v basis for quantum computing was initiated and studied in [ ref .  ] .    using the randomized - search technique ,",
    "two of the present authors and krysta svore developed a probabilistic algorithm analogous to selinger s for pauli+v ( and thus for clifford+v ) circuits [ ref .  ] . under a conjecture on the distribution of primes , the expected running time of their algorithm",
    "is polynomial in @xmath8 , and the depth of the resulting circuit is @xmath14 .",
    "the conjecture is rather credible and purely number - theoretic .",
    "later , also in the framework of clifford+t , ross and selinger replaced the randomized - search technique with an even more efficient deterministic - search technique [ ref .  ] . under a hypothesis on the distribution of primes , the expected running time of the new circuit - synthesis algorithm",
    "is polynomial in @xmath8 , and the t - count of the approximating circuit is @xmath15 . if an oracle to factor integers is available ( e.g. shor s factoring algorithm ) , the approximating circuit has the minimal possible depth .",
    "ross and selinger suggested that some other universal quantum bases may be amenable to a similarly optimal synthesis .",
    "we show in this paper that this suggestion is realized in the case of the pauli+v basis .",
    "the deterministic - search technique simplifies quite substantially in the pauli+v case .",
    "we present two circuit - synthesis algorithms using credible number - theoretic conjectures .",
    "the first synthesis algorithm runs in expected polynomial time with respect to @xmath16 and constructs a pauli+v circuit of depth at most @xmath17 that approximates the axial rotation @xmath18 within @xmath4 .",
    "the second synthesis algorithm takes an additional input parameter , namely an error tolerance @xmath19 .",
    "it runs in time polynomial in @xmath16 and @xmath20 , and it is in fact fast and practical .",
    "it returns nil or constructs a pauli+v circuit of depth at most @xmath17 that approximates the axial rotation @xmath18 within @xmath4 .",
    "the probability of returning nil is at most @xmath21 .",
    "it may be important to find a similar solution in the framework of fibonacci circuits described e.g. in [ ref .  ] .",
    "* related work*after our result was pre - announced in [ ref .",
    "] , neil ross published another confirmation that the deterministic - search technique works for the pauli+v basis [ ref .  ] .",
    "our solution is simpler , conceptually and algorithmically .",
    "consider the complex plane @xmath22 .",
    "the real and imaginary axes meet at point @xmath23 which is the origin of the coordinate system and will be denoted @xmath24 .",
    "every nonzero point @xmath25 can be viewed as a vector from the origin @xmath24 to point @xmath0",
    ". it will be clear from the context when a point is treated as a vector .",
    "if @xmath26 are distinct points of the plane then @xmath27 $ ] is the straight - line segment between @xmath28 and @xmath29 , and @xmath30 is the length of @xmath27 $ ] . if , in addition , points @xmath26 are on the unit circle around @xmath24 and are not the opposites of each other , let @xmath31 be the shorter arc of the unit circle between @xmath28 and @xmath29 .    given a positive real @xmath32 , consider a circular segment , or meniscus , @xmath33 of the unit disk , centered around point @xmath34 .",
    "given a real number @xmath35 , rotate @xmath36 to the angle @xmath37 around @xmath24 ; the resulting meniscus is centered around the point @xmath38 and will be denoted @xmath39 so that @xmath40 .",
    "menisci play important role in our approximation problem .",
    "given a meniscus @xmath41 , centered around the point @xmath42 , let @xmath43 be the two corner points of the meniscus .",
    "let @xmath44 and let @xmath45 be the intersection point of the tangent lines to the unit circle at @xmath46 and @xmath47 .",
    "the following terminology will be useful .    * the chord @xmath48 $ ] is the _ base _ of @xmath49 , and the vectors @xmath50 and @xmath51 are the _ base vectors _ of @xmath49 . * @xmath52 is the _ arc _ of @xmath49 . *",
    "the vector @xmath53 is the _",
    "handle _ of @xmath49 .",
    "note that the handle uniquely defines the meniscus . *",
    "the isosceles triangle formed by points @xmath54 is the _ enclosing triangle _ of @xmath49 .",
    "the base of @xmath49 is also the base of the triangle , and @xmath55 $ ] is the _",
    "median _ of the triangle .",
    "[ lem : arc ] let @xmath49 be a meniscus @xmath39 with base @xmath56 and handle @xmath57 , and let @xmath58 and @xmath59 be the median and one of the two equal sides of the enclosing triangle of @xmath49",
    ". then    * @xmath60 and @xmath61 .",
    "* @xmath62 .",
    "* @xmath63 . * @xmath64 .",
    "the approximate equalities mean that higher powers of @xmath4 are ignored .",
    "let the points @xmath65 be as above .",
    "the first claim follows from the definition of the meniscus .",
    "let @xmath66 .    to prove the second claim , note that @xmath67 . since the taylor series for @xmath68 is @xmath69 , we have @xmath70 and @xmath71 .",
    "let @xmath72 .",
    "we have @xmath73 , so @xmath74 and @xmath75 .",
    "since @xmath76 $ ] , we have @xmath63 .    by definition of @xmath59 , we have @xmath77 , so @xmath78 .",
    "recall that the trace distance @xmath79 between unitary operators @xmath80 ( up to phase factors ) of the hilbert space @xmath81 is @xmath82 .    [",
    "lem : meniscus ] let @xmath83 be a unitary operator @xmath6 on @xmath81 , @xmath84 be a @xmath0-rotation @xmath85 , and @xmath49 be the meniscus @xmath39 .",
    "then @xmath86 where @xmath87    note that @xmath88 .",
    "@xmath89 the penultimate equivalence uses the fact that @xmath90 which is true because @xmath28 occurs in a unitary matrix .",
    "[ cor : meniscus ] if @xmath91 and there exists a complex number @xmath29 satisfying the norm equation @xmath92 , then the matrix @xmath93 is at trace distance @xmath94 from the @xmath0-rotation @xmath95 .    since @xmath91 , we have @xmath96 , @xmath97 , and @xmath98",
    ". now use lemma  [ lem : meniscus ] .",
    "we use the same letter for a linear operator on @xmath81 and its matrix in the standard basis .",
    "unitary operators @xmath11 generate a group @xmath99 that is dense in the special unitary group @xmath100 [ ref .  ] .",
    "here @xmath12 is the identity matrix , and @xmath13 are the single - qubit pauli matrices .",
    "we have @xmath101 the group @xmath99 is in fact freely generated by @xmath102 .",
    "this fact appears without proof in [ ref .  ] . for completeness",
    ", we prove it here ; see corollary  [ cor : free ] below .    in [ ref .",
    "] , we explored a slightly larger group @xmath103 generated by the three operators @xmath104 and three pauli operators @xmath105 .",
    "because of @xmath106 and similar relations , every product of operators in @xmath103 easily reduces to a normal form @xmath107 in the process the number of v factors does not change but the number of pauli factors becomes @xmath108 .",
    "the product @xmath109 is reduced in the sense that no @xmath110 is the inverse of @xmath111 .    by theorem 1 in [ ref .  ] , an @xmath100 operator is in @xmath103 if and only if it can be given in the form @xmath112 where @xmath26 are gaussian integers .",
    "the next theorem will relate the exponent @xmath113 in this formula to the number of factors in the normal form of an element of @xmath103 .",
    "it will also provide similar information about the images in @xmath114 of the pauli+v matrices .",
    "recall how matrices in @xmath100 act as rotations on three - dimensional euclidean space .",
    "they act by conjugation on the 3-dimensional vector space of traceless hermitian matrices @xmath115 where @xmath116 , @xmath117 , and @xmath118 are the pauli matrices , and where we regard the real numbers @xmath119 as coordinates in @xmath120 .",
    "furthermore , this conjugation action preserves the euclidean norm @xmath121 so we get a homomorphism of @xmath100 into the orthogonal group @xmath122 . because @xmath100 is connected , the homomorphism actually maps into @xmath114 .    under this homomorphism , the @xmath99-matrices correspond to rotations by @xmath123 about the three coordinate axes , namely @xmath124    [ thm : free ]    1 .",
    "any matrix obtained as a reduced product of @xmath113 factors taken from @xmath125 has at least one entry which , when written as a fraction in lowest terms , has denominator @xmath126 .",
    "2 .   any matrix obtained as a reduced product of @xmath113 factors taken from @xmath127 has the form , and it can not be written in that form with @xmath113 replaced by a smaller exponent .",
    "3 .   any matrix in the normal form described above , with @xmath113 factors taken from @xmath127 followed by one factor from @xmath128 , has the form , and it can not be written in that form with @xmath113 replaced by a smaller exponent .",
    "the proof of item ( 1 ) in the theorem is rather long and is therefore given in an appendix .",
    "we give here the easy deductions of items  ( 2 ) and ( 3 ) from item  ( 1 ) .",
    "to prove ( 2 ) , consider any product @xmath129 of @xmath113 factors , each of which is in @xmath127 .",
    "each factor is thus a matrix of gaussian integers divided by @xmath130 , so the product @xmath49 is a matrix of gaussian integers dvided by @xmath131 .",
    "we need to show that no lesser power of @xmath132 can serve as the denominator for @xmath49 .",
    "so suppose , toward a contradiction , that @xmath49 is a matrix of gaussian integers divided by @xmath133 with @xmath134 .",
    "then the the same is true of the conjugate transpose of @xmath49 , which is also the inverse of @xmath49 because @xmath49 is unitary .",
    "thus , when @xmath49 acts by conjugation on the three - dimensional space of traceless hermitian matrices , the denominators are ( at most ) @xmath135 , namely a factor @xmath133 from @xmath49 and another factor @xmath133 from @xmath136 .",
    "this means that the image of @xmath49 in @xmath114 , which is given by this conjugation action on traceless hermitian matrices , involves denominators only @xmath135 . but this element of @xmath114 is obtained by multiplying the @xmath84 matrices corresponding to the @xmath99 matrices that produced @xmath49 .",
    "so we would have a reduced product of @xmath113 factors from @xmath125 with only @xmath135 in the denominator .",
    "this contradicts item  ( 1 ) .    finally , for item  ( 3 )",
    ", we must show that what we just proved about products of the form @xmath137 is also valid for @xmath138 where @xmath139 .",
    "but this is easy , since the entries of @xmath140 ( and of @xmath141 , because @xmath142 ) are gaussian integers , so multiplication by @xmath140 has no effect on the number of @xmath130 factors needed in the denominator .",
    "[ cor : free ]    1 .",
    "the matrices @xmath143 and @xmath144 are free generators of the subgroup of @xmath114 that they generate . 2 .   the matrices @xmath145 and @xmath146 are free generators of the subgroup of @xmath100 that they generate .",
    "both parts follow immediately from the corresponding parts of the theorem .",
    "the identity matrix can not be represented by a nonempty reduced word in the given generators and their inverses , because it has no 5 or @xmath130 in the denominator .",
    "the normal forms @xmath138 all represent distinct matrices , so that every element of @xmath103 has a unique normal form .    part  ( 3 ) of theorem  4 immediately implies that two normal forms with distinct lengths represent distinct matrices , for they have different powers of @xmath147 in their simplest forms .",
    "so we need only consider normal forms of one weight @xmath113 at a time .",
    "fix @xmath113 for the rest of this proof .",
    "combining part",
    "( 3 ) of theorem  [ thm : free ] with theorem 1 in [ ref .  2 ] , we find that every matrix in @xmath103 whose simplest form is ( with our fixed @xmath113 ) is represented by a normal form @xmath138 ( again with our fixed @xmath113 ) . to show that this representation is unique , it suffices to show that the number of such matrices equals the number of such normal forms .    to count the relevant matrices , write @xmath148 and @xmath149 , where @xmath150 and @xmath151 are ordinary integers , and observe that the matrix is in @xmath100 if and only if @xmath152 thus , the number of matrices in @xmath100 of the form is the number of representations of @xmath126 as a sum of four squares of integers .",
    "the number of such matrices for which this is the simplest form is then obtained by subtracting the number of such four - square representations in which all of @xmath150 and @xmath151 are divisible by 5 .    by jacobi",
    "s four - square theorem , every positive odd integer @xmath153 has @xmath154 representations as a sum of four squares of integers . in particular , for @xmath155 , there are @xmath156 representations of @xmath126 as a sum @xmath157 . as noted above , we must subtract the number of these representations in which all of @xmath150 and @xmath151 are divisible by 5 . dividing these four integers by 5",
    ", we obtain the representations of @xmath158 as a sum of four squares , so the number to be subtracted is @xmath159 .",
    "therefore , the number of matrices whose simplest form is is @xmath160    now , let us count the number of normal forms @xmath138 .",
    "we have 6 choices for @xmath161 ( namely any of the @xmath162 ) , 5 choices for each subsequent @xmath111 ( namely any of the @xmath162 except the inverse of the immediately preceding @xmath163 ) , and 8 choices for @xmath140 .",
    "that makes @xmath164 normal forms .",
    "since this count agrees with the count of matrices above , the proof of the proposition is complete .",
    "the v-_count _ of a @xmath103-operator @xmath83 is @xmath113 if @xmath83 has a normal form @xmath165 .",
    "every @xmath103-circuit implementing @xmath83 contains at least @xmath113 @xmath99-gates .",
    "we presume that the reader is familiar with continued fractions , and we use khinchin s book [ ref .  ] as our reference on continued fractions .",
    "every rational number @xmath166 has a unique continued - fraction representation @xmath167 $ ] where all @xmath168 are integers , @xmath169 are positive and @xmath170 .",
    "every irrational number has a unique continued - fraction representation @xmath171 $ ] where all @xmath168 are integers , and @xmath169 are positive . if @xmath172 $ ] is an initial segment of the continued - fraction representation of @xmath173 then the reduced fraction @xmath174 represented by @xmath172 $ ] is the @xmath175 approximant ( or convergent ) of @xmath173 .    by a theorem of dirichlet [ ref .  ] , for any real number @xmath173 and any integer @xmath176 , there exist relatively prime integers @xmath177 and @xmath178 such that @xmath179 the proof of theorem  25 in [ ref .  ]",
    "includes this claim : if @xmath174 is the approximant of @xmath173 such that @xmath180 and either @xmath181 or else @xmath182 then @xmath183 .",
    "[ lem : rational ] there is a polynomial - time algorithm that , given a rational @xmath184 and integer @xmath176 , computes an approximant @xmath174 of @xmath184 such that @xmath185 and @xmath186 .",
    "the desired algorithm is recursive .",
    "let @xmath187 , @xmath188 , @xmath189 , @xmath190 , and suppose we computed already @xmath191 . if @xmath192 , stop and output @xmath193 .",
    "otherwise let @xmath194 , @xmath195 and @xmath196 where @xmath197 and @xmath198 .    to estimate the running time of the algorithm , use the fact that any @xmath199 [ ref .",
    "if the output is @xmath174 , we have @xmath200 and @xmath201 .",
    "every real number @xmath173 , used as input to an algorithm in the present paper , comes with an oracle that , given the unary notation for an integer @xmath202 , produces the part @xmath203 of the decimal notation @xmath204 for @xmath173 , where every @xmath205 is an integer and @xmath206 are in @xmath207 .",
    "[ lem : real ] there is a polynomial - time algorithm that , given a real @xmath173 and integer @xmath176 , computes a reduced fraction @xmath208 such that @xmath209 and @xmath210 .",
    "use the oracle companion of @xmath173 to compute a rational @xmath184 such that @xmath211 . use the algorithm of lemma  [ lem : rational ] to compute a fraction @xmath208 such that @xmath212 and @xmath213 .",
    "we have @xmath214 and so @xmath215 .",
    "we recall some well - known facts related to the problem of representing a given ( rational ) integer @xmath216 as a sum of two squares of integers .",
    "all variables will range over the integers . for brevity",
    ", we say that @xmath153 is s2s if it is a sum of two squares .",
    "every prime number of the form @xmath217 is s2s . given any such prime @xmath218 , the rabin - shallit algorithm finds an s2s representation @xmath219 of @xmath218 in expected time @xmath220 [ ref .  ] .",
    "the s2s property is multiplicative . indeed , if @xmath221 and @xmath222 then @xmath223 .",
    "[ lem : s2s ] there is an algorithm that , given the representation of any number @xmath153 as a product of powers of distinct primes , decides whether @xmath153 is s2s and , if yes , produces an s2s representation @xmath219 of @xmath153 .",
    "the algorithm works in expected polynomial time .",
    "a number @xmath153 is s2s if and only if every prime factor @xmath166 of @xmath153 of the form @xmath224 has an even exponent in the representation of @xmath153 as a product of powers of distinct primes [ ref .  ] .",
    "this criterion allows you to decide whether @xmath153 is s2s or not .    if @xmath153 is s2s , use the rabin - shallit algorithm and the multiplicativity of s2s to find an s2s representation of @xmath153 .",
    "we illustrate this part on an example .",
    "suppose that @xmath225 where @xmath226 are primes of the form @xmath217 and @xmath166 is a prime of the form @xmath227 .",
    "use the rabin - shallit algorithm to represent @xmath226 as sums of squares . use the algorithm of the paragraph preceding the lemma , to represent @xmath228 as @xmath229 . then @xmath230 .    by the prime number theorem ,",
    "the number @xmath231 of primes @xmath232 is asymptotically equal to @xmath233 where @xmath234 means the natural logarithm .",
    "the number of primes of the form @xmath217 that are @xmath232 is asymptotically equal to @xmath235 and thus is @xmath236 .",
    "it follows that the fraction of s2s numbers @xmath232 is @xmath237 .",
    "[ pro : r2 ] there is an algorithm that , given a positive integer @xmath153 of the form @xmath217 and a positive @xmath19 , works in time @xmath238 and returns an s2s representation of @xmath153 or nil .",
    "if @xmath153 is prime then , with probability @xmath239 , the algorithm returns an s2s representation of @xmath153 .",
    "let @xmath240 be the rabin - shallit algorithm for finding an s2s representation of a given prime number @xmath241 .",
    "@xmath240 works in two stages . at stage  1",
    ", it solves the equation @xmath242 in the field @xmath243 .",
    "that solution is used at stage  2 to produce an s2s representation of @xmath153 .",
    "stage  2 is performed in linear time .",
    "stage  1 is a while loop . at the @xmath244 round of the loop",
    ", @xmath240 randomly chooses a residue @xmath245 and computes , in linear time , the greatest common divisor @xmath246 of polynomials @xmath247 and @xmath248 . with probability @xmath249 ,",
    "the residue @xmath250 solves @xmath242 ; if this happens , call the round successful .",
    "the expected number of the rounds is 2 .",
    "so @xmath240 works in expected linear time .",
    "let @xmath251 be the modification of @xmath240 that takes an additional input @xmath19 and replaces the while loop with the following for - loop where @xmath252 .",
    "for @xmath253 to @xmath254 do :    1 .",
    "perform one round of the @xmath240 s while loop .",
    "if the round is successful , go to stage  2 .",
    "if @xmath255 then increment @xmath256 else stop and return nil .",
    "the probability that @xmath251 outputs nil is @xmath257 .",
    "the worst - case running time of @xmath251 is @xmath238 .",
    "the desired algorithm @xmath258 is the modification of @xmath251 where the input integer @xmath241 is not necessarily prime .",
    "@xmath258 simulates @xmath251 on the given @xmath153 and @xmath21 .",
    "if @xmath251 returns an alleged s2s representation @xmath229 then @xmath259 checks whether the representation is genuine and returns the same s2s representation of @xmath153 if it is genuine . in all other cases , @xmath258 returns nil .",
    "we present an algorithm that , given a meniscus @xmath39 of the unit disk , constructs an operator @xmath260 such that @xmath261 resides in a vertical band of width @xmath262 .    call a complex number @xmath0 _ quasi - rational _ if @xmath263 or @xmath264 is rational .",
    "every nonzero quasi - rational @xmath0 has a unique _ reduced _ presentation of the form @xmath265 where @xmath58 is real and positive and where @xmath266 are mutually prime integers ; if @xmath267 then @xmath268 is the reduced form of the fraction @xmath264 .",
    "observe that a vector @xmath269 is orthogonal to a given quasi - rational vector @xmath265 if and only if @xmath269 is quasi - rational of the form @xmath270 .",
    "[ lem : tau ] let @xmath166 be a nonzero quasi - rational with reduced presentation @xmath265 .",
    "for any nonzero complex number @xmath269 orthogonal to @xmath166 , there is @xmath260 such that    1 .",
    "@xmath271 and @xmath272 , 2 .",
    "@xmath273 , 3 .",
    "@xmath274 .",
    "use the extended euclidean algorithm to find integers @xmath26 with @xmath275 and let @xmath276 .",
    "then @xmath277 and @xmath278 is some complex number @xmath279 . since @xmath166 and @xmath269 are non - collinear , so are @xmath280 and @xmath281 , and therefore @xmath282 . if @xmath283 , the desired @xmath284 .",
    "otherwise @xmath285 where @xmath286 and @xmath287 for some @xmath21 such that @xmath288 .",
    "we have @xmath289 , @xmath290 , and @xmath291 , so that indeed @xmath272 .    \\2 . by the first part of claim  1 , @xmath292 .",
    "@xmath293 maps the rectangle with sides @xmath166 and @xmath269 to a parallelogram of the same area because @xmath294 .",
    "the parallelogram has a vertical side @xmath271 and side @xmath281 whose horizontal component is @xmath295 , so its area is @xmath296 .",
    "the original rectangle had area @xmath297 . equating the two areas and cancelling @xmath298",
    ", we get the claim .",
    "let @xmath49 be a meniscus with a quasi - rational base vector @xmath166 of reduced form @xmath265 and with handle @xmath57 .",
    "there is @xmath260 such that @xmath280 is vertical , @xmath273 and @xmath299 .",
    "originally , to achieve the goal of this section , we intended to show that , for every meniscus @xmath49 of the unit circle , there exists a slightly bigger meniscus @xmath300 with a base vector @xmath166 and a handle @xmath57 and there exists an operator @xmath294 such that @xmath280 is vertical and @xmath301 .",
    "the intent ran into difficulties with diophantine approximations ; see  [ sub : da ] in this connection .",
    "fortunately there is another way .",
    "[ thm : tau ] let @xmath49 be a meniscus @xmath39 of the unit disk .",
    "there is @xmath260 such that @xmath261 resides in a vertical band of width @xmath262 .",
    "moreover , there is a polynomial - time algorithm that , given @xmath4 and @xmath35 , constructs the desired @xmath293 .",
    "since the isometry @xmath302 makes horizontal bands vertical , it suffices to prove the version of the theorem where `` vertical '' is replaced with `` vertical or horizontal . ''",
    "let @xmath303 be the two corner points of @xmath49 and @xmath304 be the base vector @xmath305 .",
    "we assume that @xmath306 ; otherwise we have nothing to do . without loss of generality ,",
    "@xmath46 is the left of the two corner points of @xmath49 , so that @xmath307 . the enclosing triangle @xmath118 of @xmath49 is formed by points @xmath43 and the intersection point ,",
    "call it @xmath45 , of the tangent lines to the unit circle at @xmath46 and @xmath47 . without loss of generality , @xmath308 ; otherwise , instead of making @xmath309 nearly vertical , we ll make it nearly horizontal ( even though this may look a bit unnatural : if the base is closer to horizontal then we adjust it to become vertical , and if it s closer to vertical then we adjust it to become horizontal . )",
    "we are going to construct an operator @xmath260 such that the horizontal projections of all sides of the triangle @xmath310 are @xmath262 .",
    "let @xmath311 and @xmath312 .",
    "apply the algorithm of lemma  [ lem : real ] to construct a reduced fraction @xmath268 such that @xmath313 and @xmath314 .    since @xmath315 and @xmath56 is an integer , @xmath56 and @xmath316",
    "can not have the opposite signs .",
    "hence @xmath317 or @xmath56 has the sign of @xmath316 which is also the sign of @xmath173 and @xmath318 .",
    "recall that @xmath319 .",
    "we claim that @xmath320 .",
    "indeed , @xmath321 and thus @xmath322 .",
    "let @xmath166 be the quasi - rational @xmath323 .",
    "recall from  [ sub : geometry ] that @xmath324 .",
    "we have @xmath325 and @xmath326 .",
    "consider meniscus @xmath327 such that @xmath328 is parallel to @xmath166 and touches @xmath309 at @xmath46 or @xmath47 .",
    "we consider only the case @xmath329 ; the other case is similar .",
    "let @xmath330 and @xmath331 be the other end of @xmath328 .",
    "the enclosing triangle of @xmath332 is formed by points @xmath333 and the intersection point , call it @xmath334 , of the tangent lines to the unit circle at @xmath335 and @xmath331 .",
    "we have @xmath336 and , by lemma  [ lem : arc ] , @xmath337 .",
    "let @xmath57 be the handle of @xmath332 .",
    "by lemma  [ lem : arc ] , @xmath338 . by lemma  [ lem : tau ]",
    ", there is @xmath260 that makes @xmath328 vertical and such that @xmath339 .",
    "furthermore , a particular @xmath340 is constructed in the proof of the lemma ; we are going to take advantage of that .",
    "the horizontal projection of @xmath341 $ ] is @xmath295 .",
    "we claim that the length of the horizontal projection is @xmath262 .",
    "since @xmath342 preserves the real part of any vector , it suffices to show that @xmath343 .",
    "we have @xmath344   = b\\alpha - a\\beta = \\alpha(b - a\\gamma).\\ ] ] so @xmath345 .",
    "it remains to show that the length of the horizontal projection of @xmath346 $ ] is @xmath262 .",
    "let @xmath347 and @xmath348 .",
    "by lemma  [ lem : arc ] , @xmath349 and @xmath350 ; so @xmath351 .",
    "since the vectors @xmath352 are collinear and operator @xmath293 is linear and projection operators are linear as well , @xmath353 . since @xmath354 , we have @xmath355    it remains to estimate the running time of our algorithm .",
    "to this end we need only to estimate the time needed to compute integers @xmath266 and then integers @xmath26 such that @xmath356 ; the remaining work takes constant time . by lemma  [ lem : real ] , integers @xmath266",
    "are computed in polynomial time . the euclidean algorithm that computes @xmath26 runs in polynomial time as well .",
    "we explain the deterministic search , how it works and why .",
    "we do that essentially on the pauli+v example .",
    "but , to simplify the exposition and minimize distractions , we abstract away some details . it would be easy to abstract away more details with the price of making the exposition a little more involved .",
    "consider a finite universal basis @xmath1 for single - qubit gates .",
    "@xmath1 may contain gates considered negligible gates ; in such a case the depth of a @xmath1-circuit is the number of non - negligible gates in the circuit . in the pauli+v case ,",
    "the pauli gates may be considered negligible , because they are relatively cheap to implement and because at most one pauli gate occurs in the normal form .",
    "assume that @xmath1 comes with a partial function @xmath357 that assigns nonnegative integers to some complex numbers and with an equation @xmath358 such that the following constraints c1-c4@xmath359 hold .    1 .",
    "if @xmath26 are of levels @xmath360 and @xmath358 holds , then the matrix @xmath6 is unitary and exactly realizable by a @xmath1 circuit of depth @xmath360 .",
    "the `` ne '' in `` @xmath358 '' alludes to the fact that the condition is typically expressed as a norm equation on @xmath28 and @xmath29 , with parameter @xmath113 . whether @xmath358 is a pure norm equation or not",
    ", we will refer to it as the _ norm equation_. the reader may be interested how the pauli+v fits the general scheme , in particular what are the levels and norm equation in the pauli+v scheme ; all these questions will be addressed in the next section .",
    "recall that we are seeking to approximate a given @xmath0-rotation @xmath361 to a given precision @xmath4 .",
    "let @xmath362 .",
    "if @xmath363 and @xmath364 , call @xmath28 a _ candidate of level @xmath360_. by corollary  [ cor : meniscus ] , if @xmath28 is a candidate of level @xmath360 and @xmath29 is a complex number of level @xmath360 such that @xmath358 holds , then the matrix @xmath93 is at a distance @xmath94 from @xmath18 .",
    "accordingly , call a candidate @xmath28 of level @xmath360 a _ winning candidate of level @xmath360 _ ( or simply a _ winning candidate _ if @xmath113 is clear from the context ) if there is a complex number @xmath29 of level @xmath360 such that @xmath358 holds .",
    "let @xmath365 be the set of all candidates of levels @xmath360 , and let @xmath366 be the subset of all winning candidates of levels @xmath360 .",
    "assume that the following constraints c2c4 hold .",
    "by default , @xmath234 means natural logarithm .    1 .",
    "there is an efficient algorithm that , given @xmath113 , enumerates the candidates of level @xmath113 .",
    "2 .   there exist a real @xmath367 and an integer @xmath368 such that @xmath369 , and @xmath370 for all @xmath371 , and @xmath372 for all @xmath373 such that @xmath374 is even . here",
    "@xmath368 depends on @xmath4 and @xmath35 while @xmath375 depends on neither .",
    "3 .   @xmath376 as @xmath377 , uniformly with respect to @xmath4 .",
    "the requirement that @xmath374 be even in c3 reflects a peculiarity of the pauli+v case .",
    "[ lem : explore ] @xmath378 for some @xmath379 where @xmath380 depends on @xmath381 and @xmath4 but not @xmath35 .",
    "let @xmath382 be as in c3 .",
    "by c4 , there exist a real @xmath383 and an integer @xmath384 , independent of @xmath381 , @xmath4 or @xmath35 , such that @xmath385 for all @xmath386 .",
    "let @xmath387 , @xmath386 and @xmath374 be even .",
    "then @xmath388 , and so @xmath378 if @xmath389 .",
    "if @xmath390 then @xmath391 the exponential function @xmath392 of @xmath177 quickly outgrows the linear function @xmath393 of @xmath177 .",
    "the desired @xmath113 is @xmath394 where @xmath395 is the least nonnegative real such that @xmath396 , @xmath397 is an even integer and the premise of the implication   holds .",
    "our goal is to ( efficiently ) find a winning candidate , preferably of low level .",
    "our ability to do this depends on our ability to tell whether a given candidate is winning , and in this connection we consider two scenarios .",
    "_ _ scenario  1__we have a deterministic decision procedure that , given an integer @xmath398 and a candidate @xmath399 , decides in polynomial time whether @xmath400 .",
    "then the following obvious deterministic search finds a winning candidate of the minimal possible level .",
    "explore candidates of levels @xmath23 , then candidates of level @xmath34 , etc .",
    "until a winning candidate of some level is found .",
    "the efficiency of such a deterministic search crucially depends on the efficiency of the decision procedure .    _",
    "_ scenario  2__we have a randomizing procedure that , given an integer @xmath398 and a candidate @xmath399 , decides in expected polynomial time whether @xmath28 belongs to a subset @xmath401 of @xmath366 subject to the following constraint .    1 .   @xmath402 as @xmath377 , uniformly with respect to @xmath4 .",
    "then the following randomizing search finds a candidate in @xmath401 of the minimal possible level .",
    "explore candidates of levels @xmath23 , then candidates of level @xmath34 , etc . until , for some @xmath113 , a member of @xmath401 is found .",
    "[ lem : explore ] @xmath403 for some @xmath379 where @xmath380 depends on @xmath381 and @xmath4 but not @xmath35 .",
    "just replace the reference to c4 with a reference to c4@xmath359 in the proof of lemma  [ lem : explore ] .",
    "we specialize  [ sec : detsearch ] to the pauli+v case .",
    "all the assumptions made in  [ sec : detsearch ] need to be justified .",
    "define a complex number @xmath28 to be of level @xmath360 if @xmath404 is a gaussian integer for some nonnegative integer @xmath405 .",
    "the norm equation @xmath358 has a particularly simple form in the pauli+v case : @xmath406 .",
    "if @xmath407 are gaussian integers @xmath408 respectively then the norm equation becomes @xmath409 . by theorem  1 in [ ref .",
    "] , mentioned in ",
    "[ sub : v ] , constraint c1 holds .    toward verifying c2 , construct a linear transformation @xmath293 as in theorem  [ thm : tau ] .",
    "the transformation @xmath293 maps straight lines into straight lines and ellipses into ellipses ; it preserves areas and convexity .",
    "the elliptical meniscus @xmath261 is enclosed in a vertical band of width @xmath262 .",
    "the inflated elliptical meniscus @xmath410 is enclosed in a vertical band that projects onto the real segment @xmath411 $ ] with @xmath412 .",
    "@xmath410 is bounded by segments @xmath413 of a straight line and of an ellipse respectively . to simplify the exposition",
    ", we consider only the case where the straight line segment is above the ellipsis segment .",
    "each gaussian integer in @xmath410 belongs to a vertical segment @xmath414 $ ] where @xmath153 is an integer in the segment @xmath415 $ ] ; see figure [ fig : menuscus : enumeration ] .",
    "this allows us to enumerate efficiently all gaussian integers @xmath416 in @xmath410 and thus to enumerate efficiently all candidates @xmath417 of levels @xmath360 .",
    "constraint c2 holds .",
    "enumeration of gaussian integers in @xmath418 .",
    ", width=336 ]    constraint c3 follows from the following claim based on an observation in [ ref .  ] .",
    "[ clm : exp_growth ] if @xmath419 then for any integer @xmath420 we have @xmath421 .",
    "suppose that @xmath43 are gaussian integers and candidates @xmath422 of levels @xmath360 belong to @xmath49 .",
    "for any @xmath381 , these candidates are also of levels @xmath423 .",
    "since @xmath49 is convex , it contains also the following intermediate candidates of levels @xmath423 : @xmath424    note that a candidate @xmath425 of level @xmath360 is a winning candidate of level @xmath360 if and only if @xmath426 is a sum @xmath229 of two squares . here",
    "@xmath427 are all integers , constraint c4 follows from the following number - theoretic conjecture of [ ref .  ] .",
    "[ con:1 ] let @xmath240 be the area of the meniscus @xmath428 of the disk of complex numbers of norm @xmath429 , and let @xmath430 be the set of gaussian integers @xmath416 in @xmath428 such that @xmath426 is a sum of two squares ( of rational integers ) .",
    "then @xmath431 .",
    "actually , instead of @xmath432 , one finds @xmath433 in [ ref .  ] , but only the lower bound is used there and also here .",
    "define @xmath401 to be the set of members @xmath425 of @xmath366 such that @xmath426 is a prime of the form @xmath217 .",
    "every such prime is a sum of two squares ; see  [ sub : squares ] .    to justify c4@xmath359",
    ", we need an additional number - theoretic conjecture .",
    "[ con:2 ] let @xmath434 be as in conjecture  [ con:1 ] , and let @xmath435 consists of numbers @xmath436 such that @xmath426 is a prime of the form @xmath217",
    ". then @xmath437 .",
    "both conjectures were found credible by the experts in analytic number theory that we consulted .",
    "the conjectures also are supported by experimentation .",
    "the intuition behind the conjectures is that there is no correlation between sets @xmath438 one the one side and prime numbers on the other . as far as sets @xmath430 and @xmath435 are concerned",
    ", the distribution of prime numbers could be random .",
    "`` it is evident that the primes are randomly distributed but , unfortunately , we do nt know what ` random ' means '' quipped the number theorist bob vaughan in 1990 [ ref .  ] .",
    "our first circuit - synthesis algorithm is presented in figure [ fig : syn1 ] where @xmath439 is a procedure that takes a positive integer @xmath153 as input and returns a complex number @xmath440 with @xmath441 or returns nil .",
    "we give 2 variants of the synthesis algorithm that correspond to the two scenarios of  [ sec : detsearch ] .",
    "the two variants differ only in their versions @xmath442 of the procedure @xmath439 .    ;",
    "( zero ) (appr ) ; ( ang ) (zero ) ; ( appr ) (rsea ) ; ( rsea ) (design ) ; ( design ) (synt ) ; ( synt ) (recur ) ; ( recur ) (out ) ;    _ procedure  @xmath443 _ + this ( and only this ) version of @xmath439 presumes the availability of a quantum computer .    1 .",
    "use shor s algorithm [ ref .  ] to factor the given number @xmath153 .",
    "shor s algorithm works in polynomial time on a quantum computer .",
    "2 .   return nil if some prime factor of @xmath153 of the form @xmath227 has an odd exponent in the representation of @xmath153 as a product of powers of distinct primes .",
    "3 .   use the algorithm of lemma  [ lem : s2s ] to find a representation @xmath444 of @xmath153 as a sum of two squares ; return @xmath445 .",
    "_ procedure  @xmath446 _    1 .",
    "check whether @xmath153 has the form @xmath217 , and return nil if not .",
    "2 .   use the lenstra - pomerance version of the aks primality test that runs in time @xmath447 for some real constant @xmath395 [ ref .  ] .",
    "( alternatively use miller s primality test that runs in time @xmath448 but assumes the extended riemann hypothesis [ ref .  ] . )",
    "return nil if @xmath153 is composite .",
    "3 .   use the rabin - shallit algorithm to find a representation @xmath444 of @xmath153 ; return @xmath445 .",
    "the first variant of the synthesis algorithm runs in expected polynomial time and produces an approximating circuit of the least possible depth .",
    "[ thm : syn2 ] given a target angle @xmath35 and real @xmath3 , the second variant of the synthesis algorithm works in expected polynomial time and constructs a pauli+v circuit of depth at most @xmath17 that approximates the axial rotation @xmath18 within @xmath4 .    _",
    "correctness__it should be obvious at this point that the algorithm produces a circuit that approximates @xmath18 within @xmath4 .",
    "_ _ circuit depth__by lemma  [ lem : explore ] , the synthesis algorithm produces a circuit of depth at most @xmath449 where @xmath368 is the least index @xmath113 such that @xmath450 .",
    "it suffices to prove the following lemma .",
    "[ lem : t0 ] @xmath451 for sufficiently small positive @xmath4 .",
    "let @xmath452 .",
    "by lemma  [ lem : arc ] , @xmath453 where @xmath454 .",
    "let @xmath455 .",
    "then @xmath456 the number @xmath457 of gaussian integers in @xmath458 is asymptotically equal to @xmath459 as @xmath377 [ ref .  ] .",
    "so , for sufficiently small positive @xmath4 , @xmath460 and @xmath461 contains at least 2 gaussian integers .    _",
    "_ running time__by lemma  [ lem : explore ] , @xmath401 contains at least two elements for some @xmath113 of the form @xmath462 where @xmath463 .",
    "accordingly , the synthesis algorithm needs to explore only candidates of levels @xmath360 .",
    "each such candidate has the form @xmath464 where @xmath28 is a gaussian integer in @xmath458 .",
    "the number of such gaussian integers is asymptotically equal to @xmath465 where the inequality follows from lemma  [ lem : arc ] .",
    "by lemma  [ lem : t0 ] , @xmath466 for some @xmath467 , so that the algorithm needs to explore at most @xmath468 candidates , that is only a polynomial number of candidates .    in the previous subsection ,",
    "we explained how to enumerate all the candidates in @xmath365 . to this end",
    "we have to walk through all the vertical segments @xmath414 $ ] where @xmath469 .",
    "there are only polynomially many of those vertical segments , namely @xmath470 each vertical segment contains only polynomially many gaussian integers , and the exploration of one candidate involves a procedure @xmath439 that runs in expected polynomial time .",
    "the whole algorithm runs in expected polynomial time    the reader may wonder whether the transformation @xmath293 was necessary .",
    "the original @xmath49 is enclosed in a vertical band of width that may be of the order of @xmath4 .",
    "replacing @xmath471 with @xmath4 gives us exponentially many vertical segments .",
    "the only essential difference of our second synthesis algorithm sa2 from the first one is its version of procedure @xmath439 whose input includes a positive real @xmath21 in addition to an integer .",
    "but this influences the forms of input and output of sa2 .",
    "the input of sa2 comprises three components : a target angle @xmath35 , a precision @xmath3 and an error tolerance @xmath19 .",
    "sa2 returns either an approximation to the rotation @xmath472 or nil .",
    "the probability of returning nil is at most @xmath21 .",
    "sa2 is presented in figure  [ fig : syn2 ] .    ;",
    "( zero ) (appr ) ; ( ang ) (zero ) ; ( appr ) (rsea ) ; ( rsea ) (design ) ; ( design ) (synt ) ; ( synt ) (recur ) ; ( recur ) (out ) ;    but , before we describe the new version of @xmath439 , let s address rabin s primality test [ ref .  ] .",
    "it is an efficient polynomial - time primality test with a parameter @xmath381 .",
    "if @xmath153 is prime then the test result is always correct . for a composite @xmath153",
    "the test may declare @xmath153 to be prime , but the probability of such error is tiny . `` the algorithm produces and employs certain random integers @xmath473  '' writes rabin in [ ref .",
    "] , `` the probability that a composite number will be erroneously asserted to be prime is smaller than @xmath474 . if , say , @xmath475 , then the probability of error is at most @xmath476 . ''    now we are ready to describe the new version of procedure @xmath439 .    1 .",
    "check whether @xmath153 has the form @xmath217 , and return nil if not .",
    "2 .   use rabin s primality test with @xmath477 .",
    "return nil if @xmath153 is found to be composite .",
    "3 .   apply the algorithm of proposition  [ pro : r2 ] to @xmath153 and @xmath21 .",
    "the new procedure @xmath439 returns an s2s representation of @xmath153 or nil .",
    "the probability of returning nil is at most @xmath21 .",
    "[ thm : syn3 ] given a target angle @xmath35 and real @xmath478 , the second synthesis algorithm sa2 works in polynomial time and returns nil or constructs a pauli+v circuit of depth at most @xmath17 that approximates the axial rotation @xmath18 within @xmath4 .",
    "the probability of returning nil is at most @xmath21 .",
    "if the primality test works as intended , sa2 works essentially like the first one . if the primality test errs , which happens with probability at most @xmath21 , sa2 returns nil or constructs a pauli+v circuit of depth at most @xmath479 that approximates the axial rotation @xmath18 within @xmath4 .",
    "in this appendix , we prove item  ( 1 ) of theorem  [ thm : free ] . we shall be concerned with reduced words @xmath480 built from the formal symbols ( letters ) @xmath481 , @xmath482 , @xmath483 , and their ( formal ) inverses .",
    "( as in the theorem , `` reduced '' means that no @xmath484 occurs next to its own inverse in @xmath480 . )",
    "we write @xmath485 $ ] for the product obtained by replacing each formal symbol @xmath484 by the corresponding matrix @xmath486 exhibited just before the statement of theorem  [ thm : free ] , and replacing @xmath487 by the inverse matrix ( also the transpose , as the matrices are orthogonal ) .",
    "we must show that , if a reduced word @xmath480 has length @xmath113 , then the corresponding matrix @xmath485 $ ] contains at least one entry which , when written as a fraction in lowest terms , has denominator @xmath126 .",
    "we shall prove this result by induction on the length @xmath113 of the word .",
    "it is clearly true for @xmath488 and @xmath489 . for the induction step ,",
    "we begin with some preliminary considerations to simplify the problem .",
    "each of the matrices @xmath486 and each of their inverses can be written as @xmath490 times an integer matrix @xmath491 , namely @xmath492 and @xmath493 .",
    "note that we are factoring @xmath490 out of each @xmath486 and each of the inverses @xmath494 , so the remaining factors are the matrices @xmath491 and @xmath495 , not @xmath496 ( which differs from @xmath495 by a factor 25 ) .    thus , if a reduced word @xmath480 has length @xmath113 , then @xmath485=(1/5^t)w[s]$ ] , where @xmath497 $ ] is obtained from @xmath480 by replacing the letters @xmath484 and their inverses @xmath498 in @xmath480 by the matrices @xmath491 and their transposes @xmath495 .",
    "what we must prove is that , in such a product @xmath497 $ ] of @xmath430 matrices , we never have all the entries divisible by 5 ; then , in any entry that is not divisible by 5 , the overall factor of @xmath499 provides the denominator required for our result .",
    "we have thus reduced our task to showing that , if we take a reduced word @xmath480 and substitute for each letter @xmath484 the corresponding @xmath491 and for each @xmath487 the transpose @xmath495 of the corresponding @xmath491 , then the product matrix @xmath497 $ ] will not have all its entries divisible by 5",
    ".    we can reduce the task further .",
    "since we are interested only in divisibility by 5 , we can reduce all entries in the @xmath430 matrices , and their transposes , and their products , modulo 5 .",
    "that is , we can perform the whole calculation using matrices with entries in @xmath500 , namely the matrices @xmath501 obtained by reducing the @xmath430 matrices modulo 5 . as with the @xmath430 matrices , we use the notation",
    "@xmath502 $ ] for the result of taking a word @xmath480 , replacing each @xmath484 and @xmath498 with @xmath503 and the transpose @xmath504 , and multiplying the resulting matrices .",
    "thus , @xmath502 $ ] is a @xmath505 matrix over the 5-element field @xmath500 .    our goal , that the product @xmath497 $ ] of @xmath430 matrices obtained from a reduced word @xmath480 does not have all entries divisible by 5 ,",
    "can now be reformulated as saying that the product @xmath502 $ ] of @xmath506 matrices obtained from a reduced word is not the zero matrix .",
    "not only are the @xmath506 matrices singular ( because each has a column of zeros ) but they have rank only 1 , because , in each of them , the two non - zero columns are proportional .",
    "the same goes for the transposes of these matrices ( either by similar inspection or because transposing a matrix does nt change its rank ) .",
    "let us write @xmath507 for the one - dimensional subspace of @xmath508 that is the range of @xmath503 and @xmath509 for the range of the transpose @xmath504 .",
    "thus , @xmath507 ( resp .",
    "@xmath509 ) is generated as a vector space by either of the non - zero columns ( resp .",
    "rows ) of @xmath503 .    with these preparations , we are ready for the induction step in the proof .",
    "suppose the claim is true for reduced words of a certain length @xmath510 , and suppose we are given a reduced word of length @xmath511 , say @xmath512 , where @xmath513 is the first letter of our given word and @xmath480 is all the rest , i.e. , a word of length @xmath113 .",
    "the first letter of @xmath480 ( which exists as @xmath510 ) is either some @xmath484 or some @xmath498 .",
    "let us consider first the case that the first letter of @xmath480 is @xmath484 .",
    "( the case of an inverse @xmath498 will be similar . ) by induction hypothesis , the matrix @xmath502 $ ] is not the zero matrix .",
    "its range is included in the range @xmath507 of @xmath503 ( because the range of any matrix product @xmath514 is included in the range of the left factor @xmath254 ) and must therefore be all of @xmath507 ( since @xmath507 has dimension only 1 ) . to show that @xmath512 also corresponds to a non - zero matrix",
    ", it therefore suffices to show that @xmath515 $ ] does not annihilate @xmath507 .",
    "( as @xmath513 is a single letter or inverse , @xmath515 $ ] is a single @xmath506 matrix or transpose . ) here it is important that @xmath513 is not @xmath498 , because @xmath512 is a reduced word .",
    "so we need only check that the range @xmath507 of @xmath503 is not annihilated by any of the @xmath516 s or their transposes , except for @xmath504 , and this is just a matter of inspection ( the many 0 s in the matrices make the computations trivial ) .    in the case where the first letter of @xmath517 is some @xmath498 ,",
    "we similarly reduce the problem to showing that the range @xmath509 of @xmath504 is not annihilated by any of the @xmath516 s or their transposes except for @xmath503 .",
    "this again can be done by inspection , thereby completing the induction and thus the proof of theorem  [ thm : free](1 ) ."
  ],
  "abstract_text": [
    "<S> recently neil ross and peter selinger analyzed the problem of approximating @xmath0-rotations by means of single - qubit clifford+t circuits . </S>",
    "<S> their main contribution is a deterministic - search technique which allowed them to make approximating circuits shallower .    </S>",
    "<S> we adapt the deterministic - search technique to the case of pauli+v circuits and prove similar results . because of the relative simplicity of the pauli+v framework , we use much simpler geometric methods . </S>"
  ]
}