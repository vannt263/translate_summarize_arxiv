{
  "article_text": [
    "tidal streams hold enormous promise as probes of both the large - scale structure of the milky way ( mw ) halo s density distribution ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ) and its small - scale fluctuations @xcite .",
    "however , two factors have hampered the practical use of tidal streams in obtaining constraints on the mw gravitational potential .",
    "first , streams do not trace a single orbit , which has led to confusion over how to best fit streams and over how problematic the single - orbit approximation really is @xcite .",
    "second , approaches that go beyond the single - orbit assumption encounter practical difficulties of computational cost and observational data quality making many of these approaches impractical for real , noisy data @xcite .",
    "observed gaps in tidal streams may be due to interactions with dark ",
    "matter subhalos @xcite , but underdensities could also be created by the dynamics of stream stars @xcite .",
    "this hinders our ability to use underdensities in star counts along a tidal stream in order to constrain the number of encounters with dark satellites and their masses @xcite .",
    "simple , analytic models of how tidal streams are generated_generative _ models  would greatly benefit both of these applications .",
    "it has long been clear that the dynamics of tidal streams is most simply described in terms of action  angle coordinates @xcite . once a star has been tidally stripped from the progenitor , the self - gravity of the stream can be neglected and the orbital actions of a stream member are conserved while the angles increase linearly with time . the action ",
    "angle structure of a stream is therefore characterized by strong but straightforward correlations between the actions and angles of stream members , the exploitation of which is crucial for using streams to measure the host gravitational potential @xcite .",
    "the description of a stream in action ",
    "angle coordinates also elucidates the connection between the orbit and velocity dispersion ( or mass ) of the progenitor and the action distribution of the tidal debris @xcite , allowing simple physical models of the stream to be used and to be constrained by observational data .",
    "however , streams are observed in position ",
    "velocity coordinates and for action ",
    "angle descriptions to be useful , we must be able to calculate the transformation between these coordinate systems efficiently . until now this has required accurate phase  space data and specialized algorithms that break down for the eccentric orbits on which tidal - stream progenitors are typically found ( that is , radial and/or vertical actions of similar magnitude as the angular momentum ; @xcite ) .",
    "however , even with gaia @xcite , all of the phase ",
    "space coordinates except for the sky position will typically have non - negligible uncertainties compared to the intrinsic dispersion of the stream and in particular the line - of - sight velocities of the faintest stream members will not be observed for many stars .",
    "additionally , streams are superimposed on a non - negligible background of field stars and background contamination can not be easily taken into account in any of the current stream - fitting methods .    in this paper ,",
    "i present a new method for modeling tidal streams that fundamentally lives in frequency  angle space , because the stream distribution function is essentially one - dimensional in this space .",
    "while many of the results of this paper are more generally valid , the fiducial stream model in this paper consists of a three - dimensional ( close to ) gaussian distribution of frequencies in the stream , a three - dimensional gaussian distribution of initial angle offsets between stream members and the progenitor , and a uniform distribution of stripping times ; the frequency and angle offset distributions are independent of stripping time . while this model oversimplifies the real stripping process , i hypothesize that at least for constraining the gravitational potential with stream data , this simple model is likely unbiased . for detailed mock stream data ,",
    "more elaborate models of the stripping process as a function of time might be necessary and i discuss how these could easily be incorporated into the proposed framework .    to evaluate the model in position ",
    "velocity coordinates , the transformation to and from action ",
    "angle coordinates is computed using a novel method for calculating action ",
    "angle coordinates presented in appendix  [ sec : aa ] .",
    "this transformation is linearized at a small number of points near the stream that span its length . for streams originating from progenitors with masses @xmath0 ,",
    "the separation between the stream track and the progenitor orbit as well as the internal differences within the stream are small , such that the linear approximations used here are accurate enough .",
    "the linear approximation allows for fast evaluation of the average stream location ( the stream `` track '' ) in position  velocity coordinates and efficient mock data generation . for a uniform distribution of stripping times , an observed stream member s phase  space probability distribution function ( pdf ) can be analytically marginalized over stripping time , such that using the linear approximation any evaluation  including marginalization and uncertainty convolution  of the pdf is extremely rapid",
    "this clears the way for proper probabilistic inference of the milky way halo s gravitational potential and progenitor properties using stream data for individual stars .",
    "the framework presented in this paper differs from other approaches that model streams in action ",
    "angle coordinates in a few respects . as in @xcite ,",
    "the model is a generative one in that it gives an analytic prescription for the initial action ",
    "angle distribution of tidal debris that is then evolved in time to generate a tidal stream .",
    "the difference between these two generative models is that i propose simple , few - parameter models for the initial action ",
    "angle distributions , that i work out the properties of streams in observable coordinates in more detail , and that i present and use a general action  angle transformation that allows stream modeling in general potentials . the average location of a stream in phase - space can be computed in the framework presented here and it could be used to replace orbit fitting ; @xcite discussed a similar method to model observed streams .",
    "the method in this paper differs from that of @xcite in that the model is fundamentally located in action ",
    "angle space rather than position  velocity space and in that the width and length of the stream are related to the offsets between the stream , the progenitor s orbit , and the average orbit as a function of stream position .",
    "thus , the present framework does not have to assume a progenitor velocity dispersion , but can constrain it from the stream data as well .",
    "my approach differs from the framework of @xcite , which is also a generative model , in that it lives in action ",
    "angle space rather than energy  angular - momentum space and that it can be applied to arbitrary time - independent potentials rather than just spherical potentials close to a logarithmic potential .",
    "this paper is outlined as follows . in @xmath1  [",
    "sec : dynamics ] i briefly summarize the dynamics of tidal streams in terms of action  angle coordinates .",
    "a generative model of a tidal stream in frequency  angle coordinates is given in @xmath1  [ sec : generative ] . @xmath1  [ sec : track ] describes how to compute the stream s properties as a function of angle along the stream , both in action ",
    "angle coordinates and in position  velocity coordinates .",
    "@xmath1  [ sec : mock ] discusses how to generate mock stream data using the generative model of a tidal stream and in @xmath1  [ sec : pdf ] i show how to calculate the stream pdf for individual stream members as well as its marginalization and convolution over missing and noisy directions .",
    "a discussion and outlook is presented in @xmath1  [ sec : discussion ] and i conclude in @xmath1  [ sec : conclusion ] . in  [ sec : aa ] i review the method of @xcite for calculating actions in any static gravitational potential and i show how it can be simplified and extended to compute frequencies and angles .",
    "the dynamics of tidal streams both in position  velocity and action  angle space has been described previously by various authors ( e.g. , * ? ? ? * ; * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "i provide here a brief description of the dynamics of tidal streams that is relevant for what follows .    in position ",
    "velocity space , a tidal stream forms as stars are stripped from a progenitor cluster or satellite galaxy some time @xmath2 in the past and then evolve ( largely ) independently in a galaxy s host potential , moving away both in position and velocity from the progenitor object as time goes on .",
    "thus , a star was offset by a small amount @xmath3 from the position of the progenitor @xmath4 at that time .",
    "then the star orbited under the influence of the same gravitational potential @xmath5 as the progenitor until the present day @xmath6 , when it was observed : @xmath7 = @xmath8 , where @xmath9 denotes the hamiltonian flow from @xmath10 to @xmath11 ( see @xcite ) ; this is simply the orbit of the star between these times . in phase - space",
    "this orbit can be calculated by solving hamilton s equations : @xmath12 .    in action ",
    "angle space the dynamics of stream formation is much simpler .",
    "a star received an offset ( @xmath13 ) at time @xmath14 from the action ",
    "angle coordinates of the progenitor @xmath15 , similar to the small offset ( @xmath16 . the offset in the actions corresponds to an offset in the frequencies @xmath17 ; ultimately , this frequency offset is responsible for the spreading of the stream over long stretches on the sky . because both the progenitor s angles and the star s angles increase linearly with time , albeit at different frequencies , the difference in the angles also increases linearly in time .",
    "therefore at time @xmath11 the difference in angles is @xmath18 while the difference in actions is constant @xmath19 as the initial offset @xmath20 in angles is small compared to the growth @xmath21 , we have that @xmath22 .",
    "thus , in action ",
    "angle coordinates , the dynamics of tidal - stream formation is simplified to linear growth of small initial angle differences due to small action / frequency differences .",
    "the angle direction @xmath23 along which a star moves away from the progenitor is related to the initial action offset by @xmath24 , in the limit of small action offsets , because @xmath25 , where @xmath26 is the hamiltonian . for an approximately one - dimensional stream to form",
    ", the hessian matrix @xmath27 has to be dominated by a single large eigenvalue ; in this case the angle difference of stars stripped from the stream at any time will fall along approximately the same direction @xmath28 , and the stream will be essentially one dimensional . in detail , because the distribution of initial offsets @xmath29 is not isotropic , the direction @xmath28 is not just determined by the potential ( through @xmath26 ) and the progenitor orbit @xmath30 , but also by the distribution of @xmath29 , which is set through a combination of the internal dynamics of the progenitor and the stripping process .",
    "i illustrate the theoretical considerations set forth in this paper by using a simulated tidal stream . this stream is set up similarly to",
    "that used in @xcite .",
    "the stream is constructed by running an @xmath31-body simulation of a king cluster @xcite on an orbit similar to that of the gd-1 stream @xcite .",
    "specifically , a king cluster with a mass of @xmath32 , a tidal radius of @xmath33 , and a ratio of the central potential to the velocity dispersion squared of @xmath34 is sampled using @xmath35 particles .",
    "the cluster is evolved with self - gravity in an external logarithmic host potential with @xmath36 and a flattening @xmath37 ( @xmath38 $ ] ) using the gyrfalcon code @xcite with a softening of @xmath39 in the nemo toolkit @xcite .",
    "the cluster is evolved for @xmath40 ( @xmath41 $ ] ) from the initial condition @xmath42",
    "@xmath43 @xmath44 @xmath45 and @xmath46 @xmath47 @xmath48 @xmath49 , chosen such that the cluster ends up at roughly the observed location of the gd-1 stream at the end of the simulation @xcite .",
    "the progenitor cluster s orbit has an eccentricity of @xmath50 , a pericenter of @xmath51 , and a current @xmath52 , such that the cluster is close to pericenter at the end of the simulation .",
    "the actions of the progenitor are @xmath53 and its orbital frequencies are @xmath54 .",
    "+    the final position of the stream in @xmath55 is shown in figure  [ fig : gd1_xz ] .",
    "figure  [ fig : gd1_jt ] shows the final position of the stream in action  frequency ",
    "angle coordinates , calculated using the algorithm described in  [ sec : aa ] .",
    "as described in @xmath1  [ sec : dynamics ] , a one - dimensional tidal stream forms because even though the action distribution of the tidal debris is not isotropic or one - dimensional , the hessian @xmath56 is so strongly dominated by a single large eigenvalue ( the ratio of the largest to the second largest eigenvalue is about @xmath57 ) , that the frequency distribution of the debris is essentially one dimensional .",
    "the angle distribution of the debris at the end of the simulation is therefore essentially one dimensional as well .",
    "the action and frequency distributions shown in figure  [ fig : gd1_jt ] combined with the knowledge that for _ any _ tidal stream the hessian @xmath58 must be strongly dominated by a single large eigenvalue leads me to propose that frequency  angle space is a better coordinate system than action ",
    "angle space for modeling tidal streams .",
    "that is , the distribution of actions in a tidal stream has a complicated structure that is hard to capture using a simple , analytic form ( see also the discussion in @xcite ) .",
    "especially the `` bow tie '' structure in @xmath59 and the overlapping leading- and trailing - arm distributions in ( @xmath60 ) are difficult to model with a simple distribution function is the correct action to use instead of @xmath61 .",
    "even though the modeling in this paper also applies to triaxial potentials , we denote @xmath62 as @xmath61 , because the simulation uses an axisymmetric potential . ] .",
    "the distribution of frequencies , however , is close - to one dimensional , its direction of largest variance can be well - modeled as a gaussian ( although below we will model it slightly differently ) , and its parameters can all be easily estimated from the velocity dispersion of the progenitor , the orbit of the progenitor , and the gravitational potential , as discussed below .",
    "therefore , we will model tidal streams in frequency  angle space . because the leading and trailing arm are well - separated in frequency space",
    ", we model each arm individually .    a generative model of a tidal stream in frequency ",
    "angle space requires three ingredients : ( a ) a model for the distribution of times at which stars are stripped from the progenitor , ( b ) a prescription for the distribution of frequency offsets from the progenitor at every given stripping time , and ( c ) a description of the angle offsets for any given frequency offset and stripping time . having specified these ingredients",
    ", we can then generate tidal debris at any given stripping time and evolve it forward using the simple linear dynamics in frequency  angle space discussed in @xmath1  [ sec : dynamics ] .",
    "the initial angle offsets are small enough that they are likely unobservable even with futuristic data ( especially in the direction of the frequency offset , where the initial angle offset is quickly overwhelmed by the subsequent dynamical evolution ; for the simulated stream used here this happens after approximately @xmath63 ) .",
    "for that reason , i will assume that the initial angle offsets are independent of both stripping time and frequency offset .",
    "in what follows , i will model them using a simple isotropic gaussian distribution with a dispersion @xmath64 .    ingredients ( a ) and ( b ) require more careful modeling .",
    "the right panel of figure  [ fig : gd1_times ] shows the distribution of times at which stream particles are stripped from the progenitor .",
    "these stripping times are calculated from the final snapshot by linear regression of a particle s angle offset @xmath65 from the progenitor , versus the frequency offset @xmath17 as @xmath66 the dotted line shows a finely - binned histogram of these stripping times , which indicates that stripping happens in bursts with a period of about @xmath67 , the radial period of the progenitor s orbit .",
    "thus , as expected , stripping happens primarily at pericenter passages , with a smaller number of particles lost between pericenter passages .",
    "realistic models of a stream , especially those that require good models of the surface - density structure of the stream as a function of stream angle , need to model this non - uniform stripping process . in what follows",
    ", we will use a uniform distribution of stripping times .",
    "this is appropriate for modeling the large - scale structure of streams , such as what is used when constraining the gravitational potential .",
    "the middle panel of figure  [ fig : gd1_times ] shows the frequency offsets between stream particles and the progenitor as a function of stripping time , corresponding to ingredient ( b ) above .",
    "the same burstiness that is apparent in the distribution of stripping times shows up here .",
    "particles stripped at pericenter typically have larger frequency offsets than those lost at larger radii .",
    "this can be described as saying that particles are _ removed _ at pericenter , but only _ peeled off _ between pericenter passages . again",
    ", realistic models of tidal streams need to take this detailed structure into account .",
    "the right panel of figure  [ fig : gd1_times ] shows the angle offset ( at the end of the simulation ) versus the stripping time .",
    "there is a spread in the angle offset reached for any given stripping time , but it is nevertheless typically the case that particles that have been stripped earlier are found at larger angle offsets today .",
    "self - sorting  the tendency of particles stripped later with larger frequency offsets to overtake particles stripped earlier at smaller frequency differences and thus to erase correlations between particle position along the stream and stripping time and sort the stream in frequency offset",
    " happens to a small extent but the narrow distribution of frequency offsets limits the ability of particles removed later to reach large distances from the progenitor",
    ".    we can model streams in frequency space because the mapping @xmath68 is of full rank for axisymmetric and triaxial potentials .",
    "however , for spherical potentials this mapping only has rank two , because @xmath69 , such that the determinant @xmath70 is zero . for spherical potentials , tidal streams only spread in a five - dimensional subspace and when modeling streams in spherical potentials we need to keep the direction perpendicular to this subspace constant .",
    "the discussion of the simulated stream s properties as a function of stripping time in the previous section indicates that we can build simple models of the structure of tidal streams when considering them in frequency  angle space . in this section , i propose a very simple fiducial model that i will use in the remainder of this paper .",
    "this model combines simple analytic forms for ease of computation that are nevertheless realistic enough to provide adequate models for tidal streams in many applications .",
    "first , we approximate the bursty , non - uniform distribution of stripping times in figure  [ fig : gd1_times ] with a uniform distribution @xmath71 the thick , solid histogram in the right panel of figure  [ fig : gd1_times ] shows a coarser - binned histogram of stripping times , indicating that the uniform distribution is a good approximation over intervals longer than a radial period ( @xmath72 ) . the _ disruption time",
    "@xmath73 is a free parameter of the model that needs to be determined for each stream . for the model of the simulated stream used here",
    "i set @xmath74 .",
    "this distribution of stripping times is different from that of @xcite , who assumed that stripping happens exactly at pericenter and is therefore a sum of delta functions located at each pericenter passage .",
    "we do not consider such a distribution here further , but it should be straightforward to repeat the analytical calculations in @xmath1  [ sec : track ] and [ sec : pdf ] below for this alternative distribution .",
    "similarly , we model the distribution of frequency offsets between stream particles and the progenitor to be independent of stripping time , even though the middle panel of figure  [ fig : gd1_times ] clearly shows that particles are stripped at larger frequency differences at pericentric passages than between them .",
    "the fact that there is only a small long - term trend in the typical frequency offset means that this is a good model on time - scales larger than the radial period .",
    "while this means that the small - scale structure of the stream will not be perfectly represented by the model , the large - scale structure of the stream will be fine . for using tidal streams to constrain the gravitational potential , large arcs are most important , such that this simple model will be adequate for such inferences .",
    "the distribution of frequencies is three dimensional . because we model the leading and the trailing arm separately , a single - peaked distribution suffices to describe the frequency distribution .",
    "a general description in terms of a gaussian distribution would have nine free parameters .",
    "however , we can model it with fewer free parameters as follows .",
    "first , following @xcite , we approximate the _ action _ distribution as a gaussian with standard deviations given by the approximate spread in the actions @xmath75 in the cluster @xmath76 where @xmath77 is the velocity dispersion of the progenitor , @xmath78 and @xmath79 are the apo- and pericenter radii of the progenitor orbit , respectively , and @xmath80 is the maximum @xmath81 reached on this orbit .",
    "we assume that all of the correlations between the actions are zero ( see figure  [ fig : gd1_jt ] ) .",
    "then we propagate this gaussian variance to frequency space using the hessian @xmath82 can be computed using the method in  [ sec : aa ] by computing @xmath83 and @xmath84 and forming @xmath85 . ] , which gives the variance matrix @xmath86 .",
    "the principal eigenvector of this matrix is the model direction along which the stream spreads . while the model i propose here",
    "is a simple one , it works well without having been tweaked for the simulation under scrutiny .",
    "the angle between the principal eigenvector of @xmath86 and the progenitor s frequency vector is @xmath87 which is close to the value measured from the simulation using the mean frequency - offset vector is @xmath88 ( see figure  [ fig : gd1_jt ] ) . for a model with an isotropic action distribution ,",
    "the misalignment would be @xmath89 , much larger than the measured value .",
    "i then further constrain the mean frequency offset to lie along the principal eigenvector of @xmath86 . therefore , this mean frequency offset can be described in terms of a parameter @xmath90 , where @xmath91 is the square root of the largest eigenvalue of @xmath86 and @xmath92 is the one - dimensional mean frequency offset . the sign of @xmath93 sets whether we are modeling a leading or a trailing arm .",
    "we can gain insight on good values for @xmath93 from the simulation .",
    "figure  [ fig : gd1_dohist ] shows the distribution of frequency offsets in the direction of the median frequency offset in the stream .",
    "two fits to this distribution are displayed in figure  [ fig : gd1_dohist ] .",
    "the dashed line is a gaussian fit to this distribution , while the solid line is a fit of the form @xmath94 where @xmath95 represents a gaussian distribution for @xmath96 with mean @xmath97 and variance @xmath98 .",
    "the fit is equally good ( because the dispersion is much smaller than the mean ) and i choose the second form because it simplifies some of the stream - track calculations below .",
    "the best - fit @xmath99 is @xmath100 for both fits . based on this information , a model with @xmath101 and @xmath102",
    "provides a good fit to the simulation data .",
    "the distribution of frequency offsets in the two - dimensional space perpendicular to the principal eigenvector of @xmath86 is modeled as a zero - mean gaussian with variance matrix given by the projection of @xmath86 onto this space .    because we expect the typical @xmath103 to scale with the velocity dispersion of the progenitor , i conjecture that a constant @xmath93 can be used for modeling tidal streams of any ( small - ish ) velocity dispersion .",
    "further modeling of simulated streams , however , is necessary to check this and to find the optimal value of @xmath93 .",
    "in particular , if the progenitor has internal rotation the action distribution of the debris and @xmath93 may be significantly different .",
    "fixing @xmath93 leaves a single free parameter @xmath104  for modeling the frequency offset distribution of a tidal stream . in modeling",
    "observed data , this parameter needs to be fit and we expect it to be proportional to the velocity dispersion of the progenitor , although this proportionality needs to be checked more carefully .",
    "the discussion in @xmath1  5 and figure 3 in @xcite demonstrates that the size of the frequency distribution scales as mass@xmath105 over more than five orders of magnitude in mass , or approximately as the velocity dispersion through application of the virial theorem and the expression for the tidal radius as a function of the progenitor mass .",
    "similarly , @xcite successfully modeled streams by assuming that the scale of the energy distribution in the stream is proportional to mass@xmath105 .",
    "the initial angle distribution , modeled here as an isotropic gaussian , has a characteristic spread @xmath106 which i set here to @xmath107 ( @xmath108 $ ] ) for the model @xmath109 ; see above ) based on a comparison with the simulation data , and we likewise expect this spread to scale with the velocity dispersion of the progenitor .     +    the fiducial model for a tidal stream in frequency  angle coordinates proposed here is therefore described by essentially two free parameters in addition to the progenitor s phase - space position : the progenitor s velocity dispersion @xmath104  and the disruption time @xmath73 . as shown below",
    ", these two parameters are the most important in determining the track of the stream .",
    "more sophisticated models can leave @xmath93 and @xmath106 as free parameters as well . in",
    "what follows , i will fix these to the values given in the previous paragraphs .",
    "it must be stressed , however , that all of these parameters here have been fixed `` by - eye '' , and better fits might be possible using more quantitative fit procedures .",
    "in this section , i discuss how to calculate the track of a model tidal stream in the generative model described in @xmath1  [ sec : generative ] .",
    "the track consists of the mean location of the stream as a function of angle along the stream .",
    "i also describe how to estimate the dispersion of the stream along this track . in @xmath1  [",
    "sec : trackaa ] , i explain how to calculate the track of the stream in frequency  angle coordinates as well as how to estimate the spread around this track . in @xmath1  [",
    "sec : trackxv ] i discuss how to efficiently project the stream track and dispersion into position ",
    "velocity coordinates @xmath110 or observable coordinates @xmath111 .",
    "+   +      in the generative model described above , the direction of the angle along the stream lies along the principal eigenvector of @xmath86 , the variance matrix of the model @xmath17 distribution .",
    "we denote the angle in this direction as @xmath112 and the frequency in this direction @xmath113 ; the two - dimensional angle- and frequency - space perpendicular to this direction is denoted as @xmath114 and @xmath115 .",
    "first , we compute the distribution of @xmath116 , the frequency offset between stream members and the progenitor given the angle offset @xmath117 as follows ( considering @xmath116 to be positive ) @xmath118 where in the penultimate step i have approximated the initial angle distribution as a delta function ( as the initial angle offset is small with respect to the final offset ) .",
    "this is a fully general expression . for the fiducial stream model ,",
    "this can be simplified to @xmath119 equation  ( [ eq : poparapar ] ) shows why i chose to model @xmath120 as a gaussian multiplied with @xmath121 .",
    "@xmath122 is then a gaussian with mean @xmath92 and variance @xmath123 , for @xmath124 , and zero otherwise .",
    "the mean and variance of such a gaussian is straightforward to calculate in terms of error functions .",
    "the top left panel of figure  [ fig : gd1_apar ] shows the distribution of @xmath121 versus @xmath125 ( absolute value in order to show the trailing and leading stream together ) for the simulated stream , as well as the mean and dispersion calculated from the fiducial model .",
    "the dashed line shows @xmath126 , approximately the angle where the finite disruption time starts to influence the mean @xmath116 of the stream .",
    "the finite disruption time , @xmath127 in this case , of a tidal stream means that for stream members to have reached very large angle differences with respect to the progenitor , they must have been removed at large frequency differences . around @xmath128 ,",
    "average stream stars , i.e. , those removed with the average frequency offset , do not have a large enough offset to reach large angle offsets . therefore , even though the average frequency offset does not change much over time ( see figure  [ fig : gd1_times ] ) , the average frequency offset , and therefore the average orbit , does change with distance from the progenitor .    in the fiducial model , the average @xmath129 , and @xmath130 as a function of @xmath117",
    "therefore , the average stream track as a function of @xmath117 is entirely specified by the mean @xmath131 in the parallel direction and zero offsets in the perpendicular directions .",
    "this track can be rotated into the @xmath132 coordinate system using the eigenvectors of @xmath86 .    to estimate the spread around the stream track",
    ", we need to calculate the distributions @xmath133 and @xmath134 .",
    "the former is just the zero mean gaussian with variance given by the projection of @xmath86 onto the direction perpendicular to the stream .",
    "the distribution @xmath135 , however , does depend on @xmath117 , because @xmath136 and the distribution of @xmath137 depends on @xmath117 .",
    "therefore , we first calculate @xmath138 .",
    "we can calculate @xmath138 as follows @xmath139 where in the last step i have again approximated the initial distribution of parallel angle offsets as a delta function . the first factor in this equation is given by the expression given in equation  ( [ eq : poparapargeneral ] ) ( in general ) or in equation  ( [ eq : poparapar ] ) for the fiducial model .",
    "the lower right panel of figure  [ fig : gd1_apar ] shows the distribution of stripping times for members of the simulated stream as well as the mean and dispersion calculated from equation  ( [ eq : pdtapar ] ) .",
    "similar to the distribution of @xmath116 as a function of @xmath117 , the distribution of @xmath137 has a kink at the angle offset that can only be reached by stars that have to have been stripped at large frequency offsets ( that is , larger than average ) .",
    "we can now also calculate @xmath140 : @xmath141 where @xmath142 for the first and second perpendicular direction . for the fiducial model , this simplifies to @xmath143 where @xmath144 is the model frequency dispersion in the perpendicular direction ( corresponding to the middle and smallest eigenvalue of @xmath86 ) .",
    "i have _ not _ approximated the initial angle - offset distribution as a delta function here , because its width is a significant fraction of that of the final perpendicular - angle - offset distribution . in the fiducial model",
    ", this distribution is the only one of those considered in this section that requires an explicit integration .",
    "however , we can approximate the distribution by using the mean @xmath145 rather than integrating over @xmath137 . the lower left panel of figure  [ fig : gd1_apar ] shows the distribution of perpendicular angle offsets and the grayscale bands show the dispersion calculated using equation  ( [ eq : paperpapar ] ) ; the white dashed line shows the approximate estimate obtained using the mean stripping time rather than integrating over it .",
    "this simple estimate agrees well with the exact calculation .",
    "we can then estimate the dispersion around the stream track , which is useful for getting a sense of the width of the model stream and to find appropriate integration intervals when marginalizing the stream pdf as discussed in @xmath1  [ sec : pdf ] . at a given angle",
    "offset @xmath117 we calculate the dispersion in @xmath116 from equation  ( [ eq : poparapar ] ) and we substitute this appropriately in @xmath86 .",
    "we can also calculate the dispersion in @xmath146 using equation  ( [ eq : paperpapar ] ) . how to estimate the dispersion in @xmath117 near a given @xmath117 is more difficult , and i simply use a dispersion of @xmath147 , as the stream typically spreads out over @xmath148 radian .",
    "we could calculate the correlation between @xmath149 and @xmath150 using similar equations as those given in the previous paragraphs , but for a simple estimate we can approximate these as @xmath151 ; i set the correlation between @xmath116 and @xmath117 to zero",
    ". while these estimates are not perfect , they give a reasonable estimate of the dispersion along the stream track .",
    "this provides an adequate starting point for more precise calculations of the dispersion in @xmath1  [ sec : pdf ] .",
    "having estimated the track of the stream and the dispersion around this in frequency  angle space , we can propagate the track to position ",
    "velocity coordinates by inverting the transformation @xmath152 .",
    "i do this by linearizing the transformation in the vicinity of the stream along an estimate of the stream track , obtained using the procedure below , and inverting this linearized transformation .",
    "that this works relies on the stream being relatively cold ( in that @xmath153 ) for a few different reasons .",
    "first , the track of a cold stream , while in general offset from the orbit of the progenitor , does not stray too far from it close to the progenitor , such that the transformation to frequency  angle coordinates can be linearized over the range of the stream  orbit offset close to the progenitor .",
    "second , cold streams are essentially one - dimensional , that is , they only spread significantly over a single direction .",
    "this means that non - linearity in the @xmath154 transformation only affects a single direction .",
    "therefore , we can linearize the @xmath155 transformation along a one - dimensional grid of points , rather than on a full six - dimensional grid .",
    "third , the coldness of the stream means that any significant mass of the full stream pdf is close enough to the stream track that all frequency  angle calculations can be performed using the linear approximation along the progenitor orbit .",
    "figure  [ fig : track ] illustrates how i linearize the @xmath152 transformation and use it to propagate the track of the stream to position  velocity coordinates and to observable quantities @xmath111 .",
    "the top panel shows the orbit of the progenitor , an auxiliary orbit , and the mean stream track in frequency  angle coordinates .",
    "only the projection onto the parallel direction is shown here .",
    "the auxiliary orbit is determined by converting the mean stream frequency @xmath156 , where @xmath157 is determined using the techniques from the previous section , at zero angle difference with respect to the progenitor to @xmath110 and integrating this orbit . the transformation to configuration space",
    "is done by linearizing the @xmath152 transformation around @xmath158 and inverting this transformation . at a small number of points along the auxiliary orbit , chosen here",
    "to span @xmath159 radians , we calculate the jacobian @xmath160 . in this figure this is done at four points , but for all other figures and calculations in this paper eleven points are used .",
    "each jacobian calculation requires seven frequency  angle calculations , such that the total number of such computations is less than @xmath161 to adequately model the stream ( each computation involves a single orbit integration , see  [ sec : aa ] ) .",
    "we then calculate the stream track in galactocentric position ",
    "velocity coordinates at the parallel angles for which we have linearized the frequency  angle transformation .",
    "this is shown in the middle panel of figure  [ fig : track ] .",
    "similarly , we transform the approximated variance described at the end of the previous section to position ",
    "velocity coordinates under the linear approximation .",
    "we can then interpolate the track of the stream between this small number of points at which it is calculated ; this gives the full track of the stream .",
    "in @xmath1  [ sec : pdf ] , we require an estimate of the dispersion around the track at any angle along the stream ( for calculating the marginalized pdf ) . we can obtain this from interpolating the estimated variances at the calculated track points .",
    "this interpolation can be performed practically as follows .",
    "we decompose the variance matrix at each calculated track point into its eigendecomposition and order the eigenvalues by size .",
    "we then interpolate each of the six eigenvalues using spline interpolation .",
    "the direction of each eigenvector is interpolated using _ slerp _",
    "@xcite , which is a type of spherical linear interpolation . the variance matrix at interpolated track points",
    "can then be constructed from the interpolated eigenvalues and eigenvectors .",
    "all other @xmath162 calculations can then be performed by using the closest interpolated track point in @xmath110 or @xmath163 and using the calculated jacobian from the closest calculated track point .",
    "finally , we can calculate the stream track in observable quantities @xmath111 by converting the interpolated track in @xmath110 to these coordinates .",
    "the dispersion at calculated track points is calculated from that in @xmath163 using the appropriate jacobians and the six - dimensional dispersion can again be interpolated using the eigendecomposition .",
    "this is illustrated in the bottom panel of figure  [ fig : track ] .",
    "this procedure for propagating the stream track from frequency  angle space to configuration space works well when the misalignment between the stream track and a single orbit is not too large ( as is the case for the example used throughout in this paper ) .",
    "however , when this misalignment is large , the auxiliary orbit deviates significantly from the stream track and the linear approximations to go from auxiliary orbit to stream track break down .",
    "this can be diagnosed by calculating the frequencies and angles along the estimated stream track in configuration space using the algorithm in  [ sec : aa ] and comparing it to those of the desired stream track computed using the methods from the previous section .",
    "when the misalignment is large and the linear approximations break down , these two do not agree ( in that they deviate by much more than the spread in the stream around the mean track ) .",
    "we can fix this by iterating the calculation of the stream track .",
    "after the first estimate of the stream track is obtained using the auxiliary orbit , we can compute another estimate starting from the previous estimate of the stream track  now the auxiliary _ track _ , because it is no longer a single orbit  in @xmath110 in the same way as the first estimate was calculated .",
    "thus , we linearize the @xmath155 transformation around points along the auxiliary track and calculate a new estimate of the stream track based on the offset in frequency  angle between the auxiliary track and the desired track . even for large misalignments",
    ", this procedure converges in a few iterations ( that is , the difference between the calculated stream track and the desired stream track in frequency  angle becomes much smaller than the dispersion within the stream ) .",
    "the average stream location computed in the manner described in this section is an approximate track . the mean stream location , for example , in distance from the sun at a given galactic longitude ,",
    "can be exactly calculated by marginalizing over the full six - dimensional stream pdf in @xmath111 over the unobserved dimensions @xmath164 . in general this",
    "will give a slightly different stream location , because the stream df is not exactly gaussian .",
    "however , it is demonstrated in @xmath1  [ sec : pdf ] , where i calculate the full stream pdf , that the approximate mean stream location of this section is sufficiently close to the true average position for all practical purposes .",
    "the same should hold for any cold stream .",
    "figure  [ fig : gd1_xz ] shows the simulated stream particles as well as the stream track calculated in this section in galactocentric @xmath165 and @xmath81 coordinates .",
    "it is clear that the average stream location tracks the position of the simulated stream .",
    "figures  [ fig : gd1_lbd ] and [ fig : gd1_lbv ] show the same , but in observed coordinates @xmath111 .",
    "these figures show that the simple fiducial stream model does a good job of predicting where the stream is located as a function of galactic longitude .",
    "+    using the generative model described in @xmath1  [ sec : modeloa ] , it is straightforward to draw mock stream data in frequency  angle space .",
    "the three ingredients  time , frequency , and angle distributions of the debris  allow for mock data to be generated in four steps .",
    "first , a stripping time @xmath166 is sampled from the distribution of stripping times .",
    "second , a frequency offset @xmath17 with respect to the progenitor is drawn from the frequency distribution at @xmath166 .",
    "third , an initial angle offset is drawn .",
    "fourth , the initial angle offset is incremented by @xmath167 .",
    "this generates the final frequency  angle coordinates of the mock stream member @xmath168 .    for the fiducial stream model of @xmath1  [ sec : fidmodel ]",
    "the procedure for producing mock data is simplified to sampling a small number of easy - to - sample distributions .",
    "first , @xmath166 is drawn uniformly between @xmath169 and @xmath73 .",
    "second , @xmath129 is drawn from the gaussian distribution of @xmath129 . the distribution of @xmath116 is not gaussian , as it is a gaussian in @xmath170 multiplied with @xmath121 over the range @xmath171 .",
    "this distribution is log - concave , that is , the derivative of its logarithm is negative everywhere , and therefore it can be efficiently sampled using adaptive - rejection sampling @xcite .",
    "the sign of @xmath116 is determined by whether we are generating a leading or trailing stream .",
    "third , initial angle offsets are drawn from the gaussian distribution of such offsets .",
    "the fourth step is as above .    to transform the mock stream in frequency",
    " angle coordinates to position  velocity space , we use the approximate procedure for this transformation along the stream track described at the end of the previous section .",
    "the mock stream in @xmath110 can then be further transformed to observable coordinates @xmath111 or any other similar quantities as desired .",
    "figure  [ fig : gd1_mock ] shows mock data generated for the model of the simulated stream described in @xmath1  [ sec : fidmodel ] .",
    "the mock data in this figure have been generated @xmath172 before the final snapshot of the simulation ( that is , @xmath172 before figure  [ fig : gd1_xz ] ) .",
    "the model from @xmath1  [ sec : fidmodel ] , which was for the final snapshot , was adjusted to this earlier time by backward orbit integration of the model progenitor and by revising the disruption time downward by @xmath172 .",
    "no other changes were made to the model .",
    "the bottom panel of figure  [ fig : gd1_mock ] shows the mock data generated from the model in @xmath55 , while the top panel shows the simulated stream data at this time .",
    "overall , the distribution of the mock and simulated data are similar .",
    "data on tidal streams typically come in one of two flavors : data on individual stream members , often with multiple missing phase ",
    "space components , or data describing the mean position and width of the stream . for the proper analysis of these kinds of data",
    "it is useful to be able to evaluate the pdf for the stream model described in this paper and to marginalize over or condition it on certain dimensions .",
    "the generative model described in @xmath1  [ sec : modeloa ] corresponds to the stream pdf in frequency @xmath173 , angle @xmath174 , and stripping time @xmath166 @xmath175 where the three factors on the right are specified through the three ingredients of @xmath1  [ sec : modeloa ] .",
    "the pdf in position ",
    "velocity space is then given by @xmath176 where @xmath70 is equal to the jacobian @xmath177 because @xmath178 .",
    "the pdf in observable quantities @xmath111 can be obtained from @xmath179 by multiplying by the jacobian @xmath180 .",
    "the stripping time @xmath166 can not be observed and should therefore be marginalized over when evaluating the pdf .",
    "one of the great advantages of modeling a stream in frequency  angle coordinates is that this marginalization can be calculated analytically for many choices of @xmath181 if @xmath182 .",
    "specifically , for the fiducial model @xmath181 is uniform up to a maximum disruption time @xmath73 ( see equation  [ [ eq : pt ] ] ) such that we can write @xmath183\\right)\\ , , \\end{split}\\ ] ] where the sum in the argument of the exponential is over the three components of @xmath184 and @xmath185 .",
    "this integral can be done analytically , resulting in @xmath186\\right)\\ , .",
    "\\end{split}\\ ] ] in this expression , @xmath187 .",
    "the expression in square brackets is positive by using the cauchy - schwarz inequality .",
    "the quantities @xmath188 and @xmath189 in this expression are defined by the following expressions @xmath190 the time @xmath191 is the best estimate of the stripping time for a given @xmath17 and @xmath65 .",
    "the quantity @xmath188 then serves to suppress the pdf in case the stripping time is smaller than zero , i.e. , a stream member appears to have been removed _ in the future _ ; in this case @xmath192 and the pdf goes to zero .",
    "similarly , @xmath189 suppresses the pdf when the stripping time is larger than @xmath73 , i.e. , the stream member seems to have been stripped before disruption began .",
    "both of these get a tolerance corresponding to the initial angle spread .",
    "for example , if @xmath191 is negative , but so small such that @xmath193 , the pdf is only mildly suppressed . for stars",
    "well within the stream @xmath194 .",
    "we can marginalize equation  ( [ eq : pxvt ] ) over @xmath166 and find that @xmath195 when evaluating this pdf as a function of @xmath110 or as a function of observable quantities @xmath111 we calculate frequencies and angles using the approximate , linear transformation near the stream track as described at the end of @xmath1  [ sec : trackxv ] .",
    "thus , @xmath196 can be evaluated very quickly by making efficient use of array operations . in this approximation",
    "the jacobian @xmath70 is constant everywhere near the track ( for a given potential ) .",
    "we can marginalize the pdf over unobserved directions , convolve it with uncertainty distributions , or condition it on certain directions using the standard rules of probability theory ; i will refer to all of these as marginalizations in what follows , as they all involve integrations over the pdf . in practice , to perform these marginalizations it is useful to estimate the extent of the pdf to define appropriate intervals for efficient numerical integration . for this",
    "we can use the average stream track and dispersion around it as estimated in @xmath1  [ sec : track ] .",
    "this is most easily explained through an example . to determine @xmath197 , the distribution of galactocentric @xmath81 at a given galactocentric @xmath165",
    ", we need to calculate @xmath198 thus , we need to marginalize over @xmath199 in the numerator and @xmath200 in the denominator . focusing on the numerator",
    ", we find the closest point on the stream track calculated as in @xmath1  [ sec : trackxv ] and calculate its six - dimensional gaussian approximation .",
    "then we condition this six - dimensional gaussian on @xmath55 using the standard rules of gaussian conditioning ( e.g. , appendix b of arxiv version 1 of @xcite ) to obtain the approximate pdf @xmath201 .",
    "we then evaluate @xmath202 by numerical integration over the , e.g. , @xmath203 range of this gaussian ; this numerical integration can be performed efficiently using gaussian quadrature .",
    "figure  [ fig : gd1_pdf_xz ] shows such pdfs of @xmath197 for a few @xmath165 on the leading arm of the stream as well as the estimated gaussian pdfs determined using the procedure in @xmath1  [ sec : trackxv ] .",
    "it is clear that the average stream location as calculated in @xmath1  [ sec : trackxv ] is very close to the actual average location of the stream in @xmath110 and that the estimated dispersion is close to the true model dispersion .",
    "the fact that the estimated gaussian in the right panel is only at the highest peak is by choice ; there is an estimated gaussian dispersion at the lower peak as well , but it is not shown .",
    "similar procedures can be followed to evaluate other projections and marginalizations of the pdf ( e.g. , @xmath204 for the observed track of the stream on the sky ) , to convolve the pdf with observational uncertainties , and to calculate moments of the pdf , e.g. , the density and velocity dispersion along the stream .",
    "another example is shown in figure  [ fig : gd1_pdf_l ] .",
    "this figure shows the model s density as a function of galactic longitude and compares it to that of the simulated stream in the final snapshot ( i.e. , that of figures  [ fig : gd1_lbd ] and [ fig : gd1_lbv ] ) .",
    "the model density here is calculated using a monte carlo mock stream sample , drawn as described in @xmath1  [ sec : mock ] , rather than through direct numerical integration .",
    "i have illustrated the new framework for modeling tidal streams using a cold , narrow stream with a progenitor velocity dispersion of only @xmath205 ( and a progenitor mass of @xmath206 ) . for a tidal stream that is as cold as that , the offset between the progenitor s orbit and the stream track as well as the dispersion within the stream are small ( we expect these relative offsets to be approximately @xmath207 ) . therefore , we can linearize the @xmath162 transformation over the relevant range of @xmath110 .",
    "the stream dispersion and the stream  progenitor - orbit offset scale approximately as mass@xmath105 , such that for streams arising from the tidal disruption of small dwarf galaxies , we expect the stream  progenitor - orbit offset to be around @xmath208 . in the fiducial model and for the simulated stream used in this paper ,",
    "the internal frequency dispersion in the stream is six times smaller than the stream  progenitor - orbit offset .",
    "therefore , bridging the latter with a linearized frequency  angle transformation is the more stringent constraint .    to test whether the framework presented applies to streams arising from the tidal disruption of small dwarf galaxies ,",
    "i have run the same simulation as that described in @xmath1  [ sec : sim ] , but for a progenitor mass of @xmath209 and a velocity dispersion of @xmath210 .",
    "the tidal radius of this progenitor is @xmath211 and i use a softening parameter of @xmath212 in this case .",
    "the final snapshot of this simulation in galactocentric @xmath165 and @xmath81 coordinates is shown in figure  [ fig : gd1-hisigv_xz ] .",
    "i predict the stream track for this simulated stream by taking the same fiducial model as described in @xmath1  [ sec : fidmodel ] , except that the model velocity dispersion @xmath104  is increased by a factor of ten .",
    "this track is shown in figure  [ fig : gd1-hisigv_xz ] .",
    "it is clear from figure  [ fig : gd1-hisigv_xz ] that the fiducial model as well as the action ",
    "angle approximations used in this paper still work for heavier progenitors with masses @xmath213 .",
    "similar experiments with progenitors with masses @xmath214 show that the framework presented here can model the tidal streams produced by such heavy progenitor s as well .",
    "when the stream  progenitor - orbit becomes so large that the assumption of a linear @xmath162 transformation becomes invalid , we can improve the calculation of the stream track by iterating the procedure to calculate the stream track as described in @xmath1  [ sec : trackxv ] and illustrated in figure  [ fig : track ] . with this procedure",
    ", streams originating from progenitors up to masses of @xmath215 should be able to be modeled with the framework presented in this paper .    above @xmath216",
    "the effects of dynamical friction , the dwarf galaxy s gravity , and non - linearity in the @xmath68 transformation are expected to start affecting the structure and location of the stream ( e.g. , * ? ? ?",
    "therefore , streams originating from the heaviest dwarf satellites will have to be modeled with more intricate means",
    ".      there are multiple existing methods for fitting data on tidal streams with models for the milky way potential .",
    "however , none of these allow for the likelihood of a model to be evaluated using a well - defined generative model ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ; * ? ? ?",
    "the only exceptions to this are orbit - fitting methods , but these use a faulty generative model ( see below ) , and the method of @xcite .",
    "the latter is in many ways similar to the method proposed here , in that it calculates the stream track and uses this as the basis of the stream inference .",
    "they calculate the track directly in position  velocity space by orbit integration of stream members released at the lagrange points .",
    "however , they do not relate the observed width of the stream to the velocity dispersion of the progenitor  and thus the location of the lagrange points and the position of the track  which is therefore only weakly constrained and has to be assumed . in general ,",
    "it is straightforward to write down generative models of tidal streams in position  velocity space by substituting our initial offsets @xmath217 by similar offsets @xmath3 and integrating both the progenitor and offset stream members forward in time .",
    "however , evaluating such models when fitting observational data requires large numbers of orbit integrations to marginalize over stripping time ( which can not be performed analytically in this case ) and missing phase ",
    "space dimensions .",
    "thus , any such method will likely be orders of magnitude slower than the method put forth here .",
    "the forward model of this paper is superior to other stream - fitting methods in that it allows easy marginalization over missing or noisily measured phase ",
    "space coordinates .",
    "the obvious exception to this is orbit fitting , which as a purely one - dimensional model is easy to integrate over .",
    "however , orbit fitting likely produces biased results as streams do not delineate single orbits over their full angle widths .",
    "the fiducial model i propose in this paper allows for a straightforward replacement of orbit fitting , at the expense of adding two extra parameters , @xmath77 and @xmath73 , in addition to the six - dimensional position of the progenitor . the orbit in orbit fitting",
    "then gets replaced by the stream track , calculated as in @xmath1  [ sec : track ] . to constrain @xmath77 and @xmath73",
    "it is necessary to also use the observed width and length of the stream .",
    "while cold streams are typically too narrow to be resolved in @xmath218 or any of the velocity components , the observed width of the stream s sky projection can be measured and used as a constraint .",
    "future high - resolution spectroscopic data , @xmath219-level astrometric data , or percent - level distances for standard candles may allow the width and structure of tidal streams to be resolved and provide further constraints on the generative model .",
    "the switch from orbit fitting to stream - track fitting comes at the expense of @xmath220 orbit integrations for each model rather than a single integration .",
    "if the progenitor is unknown we also need to marginalize over whether we are seeing a leading or a trailing stream .",
    "the dynamical framework proposed here can be used in situations where fitting a stream track is insufficient , for example , when high - quality data in some dimensions on individual stars are available .",
    "many of the approaches in the literature do not require a model progenitor position .",
    "this includes methods that attempt to minimize the spread of orbital energies or actions in the stream ( e.g. , @xcite , sanderson et al .",
    ", 2014 , in preparation ) as well as the method of @xcite , which constrains the potential by requiring angle differences in the stream to lie along the same direction as frequency differences ( see equation  [ eq : pdf ] and subsequent discussion ) .",
    "these methods require good measurements of the phase ",
    "space coordinates of stream members , or at the very least , _ some _ measurement of all of the six phase  space coordinates ( although the latter can be relaxed when excellent measurements of the line - of - sight velocity along the stream are available ; @xcite ) .",
    "if such high - quality data are present , these methods can provide good initial guesses for the pdf of potential parameters that fit a stream , which can subsequently be used in a more thorough exploration of the pdf and structure of the stream using the framework of @xmath1  [ sec : pdf ] .",
    "that these methods work also goes to show that the progenitor parameters  phase  space position , @xmath77 and @xmath73are not that important for the constraints on the gravitational potential .",
    "the probability in equation  ( [ eq : pdf ] ) incorporates and elucidates commonly used methods for fitting tidal streams . on the one hand are approaches that search to minimize the spread in energy , integrals of the motion , or actions ( e.g. , @xcite , sanderson et al . , 2014 , in preparation ) .",
    "these approaches ignore the correlations between actions and angles in the stream and only use @xmath221 ; finding the gravitational potential that minimizes the spread in frequencies ( or equivalently , actions ) optimizes @xmath221 . recently",
    ", a new method was proposed that only uses the correlation between the actions and the angles , expressed by the exponential in equation  ( [ eq : pdf ] ) @xcite ; this method does not use the fact that the spread in actions in a tidal stream is small ( expressed by @xmath221 ) , but only uses the fact that the angles and actions / frequencies are highly correlated .",
    "approaches that require stream members to re - unite with the progenitor when integrating their orbits backward in time @xcite use the full pdf ( expressed in position  velocity space ) , but can not be marginalized over unobserved or noisy phase ",
    "space dimensions as easily .    after this",
    "paper first appeared , @xcite presented a similar tidal - stream model in frequency ",
    "angle space as that proposed here .",
    "it employs the algorithm of @xcite for estimating the frequencies and angles by approximating the gravitational potential as a stckel potential in the orbital volume covered by the stream .",
    "the stckel approximation does not perform well for the eccentric orbits that streams are typically on @xcite and the noise induced by the approximation is significant compared to the internal dispersion around a stream s track , especially for cold streams .",
    "@xcite focuses on constraining the gravitational potential using the generative frequency ",
    "angle model and demonstrates that his model , which is essentially the same as that proposed here , is able to recover the parameters of the potential for a gd-1-like stream .",
    "the generative model for a tidal stream proposed here also connects the dynamics of the stream , in particular its average track and the dispersion around this track , to the properties of the progenitor .",
    "primarily , we can constrain @xmath77 , which is proportional to the velocity dispersion or mass@xmath105 of the progenitor ( see @xcite ) , from the observed width of the stream , even if the stream s sky projection is the only projection for which we can resolve the stream .",
    "further @xmath31-body simulations are necessary to characterize the exact relation between the @xmath104  parameter and the velocity dispersion of the progenitor and to determine the importance of the cluster s internal structure , primarily its concentration , in determining @xmath104 .",
    "our calculation of the mean stream orbit as a function of angle along the stream also points the way to determining the location of an `` orphan '' stream s progenitor ( an orphan stream is a stream for which the progenitor is not known ) .",
    "this requires high - quality data that allows the average orbit as a function of position along the stream to be determined .",
    "if this can be done , then the observation of a steady change in the mean orbit followed by a plateau indicates that the progenitor lies in the direction of the plateau .",
    "the change in the mean orbit along the stream is a function of the mean orbit offset ( @xmath92 in the direction of @xmath116 ) , the dispersion in orbit offsets ( @xmath91 in @xmath116 ) , and the disruption time @xmath73 .",
    "the first two of these can be measured from the width of the stream and the plateau in the mean orbit as a function of stream position .",
    "the disruption time @xmath73 can then be measured from the change in mean orbit at the end of the stream . with all of the parameters of the forward model measured",
    ", we can extrapolate the stream backward to the progenitor position .",
    "similarly , we can extrapolate a leading stream to its trailing counterpart , if this is unknown ( and vice versa ) .",
    "while determining the mean orbit as a function of position along the stream requires high - quality data , this should be achievable in the near future .",
    "we can average or `` stack '' noisily measured phase ",
    "space coordinates in small segments of the stream to determine high quality average phase  space positions and use these instead of data on individual stream stars .",
    "these considerations show that further observations of members of the gd-1 and orphan streams would be highly informative for determining the location or fate of their progenitors .      besides allowing for sensitive measurements of the milky way s large - scale gravitational potential through the wide arcs traced by tidal streams , their structure on smaller scales is also sensitive to more subtle features of the halo s density distribution . in particular , the perturbations from dark ",
    "matter subhalos orbiting within the milky way s halo can have the effect of removing stars from small segments of a tidal stream @xcite .",
    "thus , the small - scale density structure of tidal streams can be used to constrain the subhalo mass function at the high - mass end ( @xmath222 ) .",
    "this holds a great promise for testing the basic predictions of dark ",
    "matter clustering in the @xmath223cdm framework and for shedding light on galaxy formation in the smallest galaxies in the universe .",
    "tidal streams , even in the absence of perturbations from orbiting dark  matter subhalos , are not entirely smooth as the effects of the preferential stripping at pericenter and orbital dynamics can create over- and underdensities along the observed stream track ( see figure  [ fig : gd1_times ] ; @xcite ) . these effects can lead to spurious detections of gaps in streams that provide a source of noise in measurements of gaps due to substructure in the halo @xcite",
    ".    the generative stream models proposed in this paper can be useful for generating tailor - made background models for stream gap - finding algorithms .",
    "the generative model allows for the density along the stream to be predicted quickly for a given progenitor orbit and distribution of stripping times .",
    "the example given in figure  [ fig : gd1_pdf_l ] using the simple fiducial model shows that this works well .",
    "however , the fiducial model assumes a uniform distribution of stripping times rather than bursts at pericenter passages , and therefore it can not fully model the under- and over - densities along the stream ( e.g. , `` feathering '' due to epicyclic overdensities ; see @xcite ) in detail .",
    "the mock - stream - generation algorithm given in @xmath1  [ sec : mock ] works almost as simply for more complicated models of the stripping process ( e.g. , a bursty distribution of stripping times and more energetic stripping at pericenter ; @xcite ) and it is therefore straightforward to produce more realistic models of the small - scale density structure of observed tidal streams .",
    "these background models will allow more sensitive detections of substructure due to halo substructure .",
    "i have presented a new method for modeling the dynamics of tidal streams , making extensive use of action ",
    "angle variables .",
    "this new framework consists of simple models for the disruption of a star cluster in frequency ",
    "angle space coupled with a novel method for calculating action ",
    "angle variables for any orbit in any potential .",
    "the model is a generative model , meaning that it can be used to sample mock stream data and evaluate the likelihood of different models for observed tidal stream data .",
    "i have described fast methods for calculating the mean location of the stream in various coordinate systems , for estimating the dispersion of the stream and relating it to the velocity dispersion or mass of the progenitor , and for marginalizing the stream likelihood over noisily or entirely unobserved dimensions of phase space .",
    "the framework allows for the proper analysis of data on tidal streams by taking into account all the relevant dynamical effects , most notably the stream  single - orbit offset . as such",
    ", it should be immediately useful for the proper analysis of data on the gd-1 @xcite , orphan ( e.g. , * ? ? ?",
    "* ) , pal 5 , and other streams .",
    "the ability to quickly marginalize the model over unobserved dimensions will also prove highly useful when gaia data for these streams become available in the near future .",
    "the new framework also provides a straightforward way to generate mock stream data that is useful for detecting anomalies in the structure of tidal streams , such as those that can be caused by fly - bys of dark ",
    "matter subhalos .",
    "besides being a practical tool for proper stream fitting , the framework presented here also clarifies the relation between the stream , the potential , and properties of the progenitor .",
    "i have discussed how we can relate the properties of a stream to those of its progenitor , potentially allowing for the unknown progenitor of streams such as gd-1 or the orphan stream to be located .",
    "further investigations of the dynamics of cluster disruption and tidal - stream generation for different progenitor orbits , a larger and more realistic set of potentials , and different progenitor structures will be necessary to perfect the models in frequency  angle space proposed here and to parameterize the mapping between model parameters and actual progenitor properties .",
    "the full modeling and action  angle framework presented here is available as part of the _ galpy _ galactic dynamics code ( j.  bovy , 2015 , in preparation ) . a tutorial on how to use this code",
    "is given at    .",
    "it is a pleasure to thank mark fardal for comments on the manuscript and diagnosing problems in the public code that have significantly improved the paper .",
    "i also thank james binney , david w. hogg , kathryn johnston , hans - walter rix , jason sanders , and scott tremaine for helpful discussions and comments .",
    "j.b . was supported by nasa through hubble fellowship grant hst - hf-51285.01 from the space telescope science institute , which is operated by the association of universities for research in astronomy , incorporated , under nasa contract nas5 - 26555 .",
    "j.b . acknowledges support from sfb 881 ( a3 ) funded by the german research foundation dfg .",
    "the wide - spread use of action  angle coordinates , in many ways the natural coordinates for studying the orbital structure of galaxies , in dynamical modeling has been frustrated by the difficulty in calculating the transformation to and from these coordinates , @xmath224 . the most general method for calculating the transformation @xmath225",
    "is provided by torus modeling @xcite . in the context of modeling observational data , computing the transformation @xmath226 is more important and the most general method consists of iteratively inverting the torus modeling @xcite , which is computationally expensive .",
    "recently , progress has been made in computing @xmath226 for milky - way - like potentials by either implicitly or explicitly approximating the gravitational potential as a stckel potential @xcite , which allows action  angle coordinates to be computed with percent - level errors for moderately eccentric orbits .",
    "however , these methods break down for orbits with radial and/or vertical actions of a similar magnitude as the angular momentum  that is , orbits that feel the gravitational potential over a volume large enough that the stckel approximation fails .",
    "this is especially problematic for the orbits of stars in tidal streams , as the progenitors of tidal streams are typically on quite eccentric orbits ( e.g. , * ? ? ?",
    "recently , @xcite has suggested a new method for calculating @xmath227 inspired by torus modeling .",
    "this method requires only a single orbit integration and allows the actions to be calculated accurately and as precisely as desired ( that is , a convergence criterion can be applied and convergence can be attained ) .",
    "i describe the fox method briefly here , discuss how it can be simplified , and then show how to extend it to also calculate the frequencies and angles : @xmath152 .    as in torus modeling",
    ", the method of @xcite uses an auxiliary isochrone potential @xmath228 that should be close to the target potential @xmath5 for which the action  angle coordinates should be calculated ( a precise definition of `` close '' will be given below ) .",
    "the discussion here focuses on loop orbits ; for box orbits an auxiliary harmonic oscillator potential can be used .",
    "actions and angles @xmath229 calculated in the auxiliary potential can be related to those in the target potential @xmath230 by a generating function that can be written as @xcite @xmath231 where the @xmath232 sum is over the integer three - dimensional half - space that excludes the origin and the @xmath233 are functions of the target actions that are to be determined .",
    "the canonical transformation corresponding to this generating function is @xmath234 and @xmath235 for axisymmetric potentials @xmath236 , such that all @xmath237 when @xmath238 in the above equations . for axisymmetric potentials we therefore only need to consider @xmath239 and @xmath240 .",
    "the fox method consists of averaging equation  ( [ eq : jjt ] ) over the three - dimensional torus @xmath241 covered by the orbit , such that the mapping defined by the @xmath233 is onto orbital tori of the target hamiltonian , the oscillating cosine behavior cancels , and the target actions are obtained as the auxiliary - angles - averaged auxiliary actions . performing these three - dimensional integrals is difficult , because it is necessary to approximate the three - dimensional volume @xmath242 from a one - dimensional set of points along the integrated orbit . here",
    "i show that the three - dimensional integrals over @xmath243 can be simplified for non - resonant orbits to one - dimensional integrals over one of the auxiliary angles along the path of the orbit .",
    "this significantly simplifies the calculations , especially of @xmath62 and @xmath244 ( see below ) .",
    "that is , we integrate over equation  ( [ eq : jjt ] ) as @xmath245 where the integral is over auxiliary angles calculated on the path of the orbit in the target potential .",
    "the factor @xmath246 comes out of the integral as the target actions are conserved along the orbit . in this equation",
    ", we integrate over the angle coordinate @xmath247 associated with the action @xmath248 that we want to compute ( that is , @xmath249 for @xmath250 and so on ) .",
    "this is because of the factor @xmath251 : the condition @xmath232 means that when calculating @xmath250 there are terms with @xmath252 , which would not cancel according to the argument below when integrating over @xmath253 . for non - resonant orbits and after a long - enough orbit integration , the angles can be considered to be independent ( that is , the orbit `` fills its torus '' ) , such that we can write ( for example , for @xmath249 ) @xmath254\\ , , \\\\    & \\approx \\mathrm{re}\\left[\\exp(-i\\,n_\\phi\\,\\theta^a_\\phi - i\\,n_z\\,\\theta^a_z)\\int { \\mathrm{d}}\\theta_r^a\\,\\exp(-i\\,n_r\\,\\theta^a_r)\\right]\\ , .",
    "\\end{split}\\ ] ] as long as the auxiliary angle @xmath239 goes through the full range @xmath169 to @xmath255 along the orbit , the oscillatory behavior integrates to zero and equation  ( [ eq : jjtint ] ) simplifies to @xmath256 that is , the target action is obtained by averaging the auxiliary action over the auxiliary angle .",
    "the left panel of figure  [ fig : aai ] shows a running average of the radial action calculated using equation  ( [ eq : aaij ] ) along the orbit of the progenitor in the simulation used in the main body of this paper .",
    "the time in this figure is in units of @xmath257 , so the orbit is integrated for a total of @xmath258 .",
    "the auxiliary isochrone potential has a scale parameter of @xmath259 .",
    "after a few radial periods , the radial action quickly converges with a remaining oscillatory behavior that is primarily a function of the radial angle , but that becomes smaller over time . with longer integrations and shorter time - steps",
    ", the radial action can converge to any desired tolerance .",
    "the duration of the orbit integration shown in this figure is what is typically used in this paper and gives a precision of @xmath260 in the actions .    given the orbit integration already performed for calculating the actions , we can use equation  ( [ eq : aat ] ) to calculate the frequencies and angles corresponding to the point @xmath110 ( this procedure is similar to that used in @xcite ) .",
    "we first re - write equation  ( [ eq : aat ] ) in terms of the angle at time zero and the frequencies @xmath261 this is a linear system of equations for each point along the orbit with unknowns @xmath262 , @xmath263 , and the functions @xmath264 . for a finely integrated orbit ,",
    "this system is highly over - constrained ( at least when the number of expansion terms is small ) and its solution can be found by simple linear algebra for any desired number of expansion terms @xmath265 . for extra stability ,",
    "i integrate the orbit both forward and backward in time , such that the desired angle @xmath262 is at the center of the dependent variable @xmath266 .",
    "the right panel of figure  [ fig : aai ] shows the auxiliary radial angle versus the auxiliary vertical angle along the orbit for the progenitor used in the main body of this paper .",
    "the periodic behavior in the angles is removed before the linear fit described in the previous paragraph , which is shown in this figure .",
    "it is clear that the contribution of the oscillatory terms @xmath265 is small , such that a small number of expansion terms is sufficient ( i limit the terms in this axisymmetric case to @xmath267 and @xmath268 ) .",
    "the method described here is completely general and the only obstacle to using it is that a sufficiently close isochrone potential has to be supplied .",
    "sufficiently close means specifically that the auxiliary angles have to go through the full range of @xmath169 to @xmath255 along the orbit in the target potential . whether they do or not is easy to check and",
    "i have found that with limited trial and error a good enough isochrone potential can be determined quickly for milky - way - like axisymmetric potentials in regions where the flattening is mild ( i.e. , in the halo ) . whether this method works near the plane of the disk where the potential is strongly flattened remains to be checked ,",
    "although the fact that disk orbits are close to circular makes the details of the auxiliary potential unimportant .",
    "similarly , the method should be tested in more detail for triaxial potentials as well . for analyzing stream data ,",
    "the necessity of this trial - and - error determination of the auxiliary potential does not pose a practical problem , as all of the stream stars are on very similar orbits .",
    "therefore , the same auxiliary potential can be used for all action  angle calculations for a given potential and for different potentials as well , as long as they are not too different .",
    "more widespread use of this technique may require automated methods for determining a good auxiliary potential . in the unlikely circumstance that no good auxiliary isochrone potential can be found , the method discussed here",
    "can also be used with other auxiliary potentials for which the actions and angles can be calculated , such as other spherical potentials or the family of stckel potentials .",
    "this will , however , add a non - negligible amount of computation for the necessary numerical integrations .",
    "after this paper appeared , a similar technique for calculating actions , frequencies , and angles was presented by @xcite .",
    "their technique fits for the coefficients of @xmath269 in equation  ( [ eq : jjt ] ) to obtain the actions ( similar to how we obtain the frequencies and angles here ) rather than just averaging the auxiliary actions as in equation  ( [ eq : aaij ] ) .",
    "they also include a discussion of how to handle box orbits and a more detailed procedure for finding a good auxiliary potential .",
    "they explicitly and in detail demonstrate that this new procedure for calculating action  angle coordinates works well for triaxial potentials .",
    "binney ,  j. & tremaine ,  s. 2008 , galactic dynamics : second edition binney ,  j. 2008 , , 386 , l47 binney ,  j. 2012 , , 426 , 1324 bovy ,  j. , hogg ,  d.  w. , & roweis ,  s.  t. 2011 , ann .",
    "stat . 5 , 1657 , arxiv:0905.2979v1 carlberg ,  r.  g. 2012 , , 748 , 20 dehnen ,  w. 2000 , , 536 , l39 dehnen ,  w. 2002 , j.  comput .",
    "phys . , 179 , 27 eyre ,  a. & binney ,  j. 2011 , , 413 , 1852 fox ,  m. 2012 , m.  phys .  thesis , univ .",
    "oxford , arxiv:1407.1688 gilks ,  w.  r. & wild ,  p. 1992",
    ", applied statistics , 41 , 337 helmi ,  a. & white ,  s.  d.  m. 1999 , , 307 , 495 johnston ,  k.  v. 1998 , , 495 , 297 johnston ,  k.  v. , zhao ,  h. , spergel ,  d.  n. , & hernquist ,  l. 1999 , , 512 , l109 king ,  i.  r. 1966 , , 71 , 64 koposov ,  s.  e. , rix ,  h .- w .",
    ", & hogg ,  d.  w. 2010 , , 712 , 260 kpper ,  a.  h.  w. , kroupa ,  p. , baumgardt ,  h. , & heggie ,  d.  c. 2010 , , 401 , 105 law ,  d.  r. , johnston ,  k.  v. , & majewski ,  s.  r. 2005 , , 619 , 807 mcgill ,  c. & binney ,  j. 1990 , , 244 , 634 mcmillan ,  p.  j. & binney ,  j.  j. 2008 , , 390 , 429 ngan ,  w.  h.  w. & carlberg ,  r.  g. 2014 , , 788 , 181 pearrubia , j. , koposov ,  s.  e. , & walker ,  m.  g. 2012 , , 760 , 2 perryman ,  m.  a.  c. , et al .",
    "2001 , , 369 , 339 price - whelan ,  a.  m. & johnston ,  k.  v.  2013 , , 778 , l12 sanders ,  j. 2012 , , 426 , 128 sanders ,  j.  l. & binney ,  j. 2013a , , 433 , 1813 sanders ,  j.  l. & binney ,  j. 2013b , , 433 , 1826 sanders , j.  l. 2014 , , 443 , 423 sanders , j.  l. & binney , j.  2014 , , 441 , 3284 sesar ,  b. , grillmair ,  c.  j. , cohen ,  j.  g. , et al .",
    "2013 , , 776 , 26 shoemake ,  k. 1985 , acm siggraph computer graphics 3 , 45 teuben ,  p.  j. 1995 , in astronomical data analysis software and systems iv , ed .",
    "r.  shaw , h.  e.  payne and j.  j.  e.  hayes . , pasp conf series 77 , 398 tremaine ,  s. 1999 , , 307 , 877 varghese ,  a. , ibata ,  r. , & lewis ,  g.  f. 2011 , , 417 , 198 yoon ,  j.  h. , johnston ,  k.  v. , & hogg ,  d.  w. 2011 , , 731 , 58"
  ],
  "abstract_text": [
    "<S> i present a new framework for modeling the dynamics of tidal streams . </S>",
    "<S> the framework consists of simple models for the initial action  angle distribution of tidal debris , which can be straightforwardly evolved forward in time . taking advantage of the essentially one - dimensional nature of tidal streams , the transformation to position  </S>",
    "<S> velocity coordinates can be linearized and interpolated near a small number of points along the stream , thus allowing for efficient computations of a stream s properties in observable quantities . </S>",
    "<S> i illustrate how to calculate the stream s average location ( its `` track '' ) in different coordinate systems , how to quickly estimate the dispersion around its track , and how to draw mock stream data . as a generative model , </S>",
    "<S> this framework allows one to compute the full probability distribution function and marginalize over or condition it on certain phase  </S>",
    "<S> space dimensions as well as convolve it with observational uncertainties . </S>",
    "<S> this will be instrumental in proper data analysis of stream data . </S>",
    "<S> in addition to providing a computationally - efficient practical tool for modeling the dynamics of tidal streams , the action  angle nature of the framework helps elucidate how the observed width of the stream relates to the velocity dispersion or mass of the progenitor , and how the progenitors of `` orphan '' streams could be located .    </S>",
    "<S> the practical usefulness of the proposed framework crucially depends on the ability to calculate action  </S>",
    "<S> angle variables for any orbit in any gravitational potential . </S>",
    "<S> a novel method for calculating actions , frequencies , and angles in any static potential using a single orbit integration is described in an appendix . </S>"
  ]
}