{
  "article_text": [
    "birkhoff  @xcite introduced the problem of _ convex billiard tables _",
    "more than 80 years ago as a way to describe the motion of a free particle inside a closed convex curve such that it reflects at the boundary according to the law `` angle of incidence equals angle of reflection '' .",
    "he also realized that this billiard motion can be modeled by an area preserving map defined on an annulus .",
    "there exists a tight relation between the invariant curves of this billiard map and the caustics of the billiard trajectories .",
    "caustics are curves with the property that a trajectory , once tangent to it , stays tangent after every reflection .",
    "good starting points in the literature of the billiard problem are  @xcite .",
    "we also refer to  @xcite for some nice figures of caustics .",
    "when the billiard curve is an ellipse , any billiard trajectory has a caustic .",
    "the caustics are the conics confocal to the original ellipse : confocal ellipses , confocal hyperbolas , and the foci .",
    "the foci are the singular elements of the family of confocal conics . in this case",
    ", the billiard map is integrable in the sense of liouville , so the annulus is foliated by its invariant curves , the billiard map becomes just a rigid rotation on its regular invariant curves , and the rotation number varies analytically with the curve .",
    "the billiard dynamics inside an ellipse is known .",
    "we stress just three key results related with the search of periodic trajectories .",
    "first , poncelet showed that if a billiard trajectory is periodic , then all the trajectories sharing its caustic conic are also periodic  @xcite .",
    "second , cayley gave some algebraic conditions to determine the caustic conics whose trajectories are periodic  @xcite .",
    "third , the rotation number can be expressed as a quotient of elliptic integrals  @xcite .",
    "we note that the search of periodic trajectories inside an ellipse can be reduced to the search of rational rotation numbers .",
    "a rather natural generalization of this problem is to consider the motion of the particle inside an ellipsoid of @xmath10 .",
    "then the phase space is no longer an annulus , but a symplectic manifold of dimension @xmath1 .",
    "many of the previous results have been extended to ellipsoids , although those extensions are far from being trivial .",
    "for instance , any billiard trajectory inside an ellipsoid has @xmath2 caustics , which are quadrics confocal to the original ellipsoid .",
    "this situation is fairly exceptional , since quadrics are the only smooth hypersurfaces of @xmath10 , @xmath11 , that can have caustics  @xcite .",
    "then the billiard map is still completely integrable in the sense of liouville , being the caustics a geometric manifestation of its integrability . in particular , the phase space is mostly foliated with liouville tori of dimension @xmath2 .",
    "the motion on each liouville torus becomes just a parallel translation with some frequency that varies with the torus .",
    "some extensions of the poncelet theorem can be found in  @xcite .",
    "several generalized cayley - like conditions were stated in  @xcite . finally , the frequency map can be expressed in terms of hyperelliptic integrals , see  @xcite .",
    "the setup of these last two works is @xmath8 , but their formulae are effortless extended to @xmath10 .    from jacobi and darboux",
    "it is known that hyperelliptic functions play a role in the description of the billiard motion inside ellipsoids and the geodesic flow on ellipsoids . nevertheless ,",
    "we skip the algebro - geometric approach ( the interested reader is referred to  @xcite ) along this paper , in order to emphasize the dynamical point of view . here",
    ", we just mention that the billiard dynamics inside an ellipsoid can be expressed in terms of some riemann theta - functions associated to a hyperelliptic curve , and so , one can write down explicitly the parameterizations of the invariant tori that foliate the phase space ; see  @xcite .",
    "periodic orbits are the most distinctive special class of orbits",
    ". therefore , the first task to carry out in any dynamical system should be their study , and one of the simplest questions about them is to look for minimal periods . in the framework of smooth convex billiards",
    "the minimal period is always two .",
    "nevertheless , since all the two - periodic billiard trajectories inside ellipsoids are _ singular _ in the sense that some of their caustics are singular elements of the family of confocal quadrics , two questions arise . which is the minimal period among _ nonsingular _ billiard trajectories ? which ellipsoids display such trajectories ?    in order to get a flavor of the kind of results obtained in this paper , let us consider the three - dimensional problem .",
    "let @xmath4 be the triaxial ellipsoid given by @xmath12 , with @xmath13 .",
    "we assume that @xmath14 without loss of generality .",
    "any billiard trajectory inside @xmath4 has as caustics two elements of the family of confocal quadrics given by @xmath15 we restrict our attention to nonsingular trajectories .",
    "that is , trajectories whose caustics are ellipsoids : @xmath16 , 1-sheet hyperboloids : @xmath17 , or 2-sheet hyperboloids : @xmath18 .",
    "the singular values @xmath19 are discarded .",
    "it is known that there are only four types of couples of nonsingular caustics : eh1 , h1h1 , eh2 , and h1h2 .",
    "the notation is self - explanatory .",
    "it is also known that any nonsingular periodic billiard trajectory inside @xmath4 has three so - called _ winding numbers _",
    "@xmath20 which describe how the trajectory folds in @xmath8 . for instance",
    ", @xmath21 is the period .",
    "the geometric meanings of @xmath22 and @xmath23 depend on the type of the couple of caustics , see section  [ sec:3d ] .",
    "we stand out two key observations about winding numbers .",
    "first , some of them must be even .",
    "namely , the ones that can be interpreted as the number of crossings with some coordinate plane .",
    "second , we conjecture that they are ordered as follows : @xmath24 . this unexpected behaviour is supported by extensive numerical experiments . in fact",
    ", we believe that it holds in any dimension .",
    "the combination of both observations crystallizes in the following lower bounds .",
    "[ thm : lowerbounds3d ] if the previous conjecture on the winding numbers holds , any periodic billiard trajectory inside a triaxial ellipsoid of @xmath8 whose caustics are of type eh1 , h1h1 , eh2 , and h1h2 has period at least five , four , five , and six , respectively .",
    "all the billiard trajectories of periods two and three are singular .",
    "the two - periodic ones are contained in some coordinate axis , so they have two singular caustics .",
    "the three - periodic ones are contained in some coordinate plane , so they have one singular caustic .",
    "we shall prove in section  [ sec : frequencymap ] the generalization of these lower bounds to any dimension , see theorem  [ thm : lowerbounds ] .",
    "samples of periodic trajectories with minimal periods are shown in figure  [ fig : periodictrajectories3d ] .",
    "hence , these lower bounds are optimal .",
    "next , we look for ellipsoids with minimal periodic trajectories .",
    "we recall that @xmath25 , so each ellipsoid @xmath4 is represented by a point in the triangle @xmath26 .",
    "let @xmath27 , @xmath28 , @xmath29 , and @xmath30 be the four regions of @xmath31 that correspond to ellipsoids with minimal periodic trajectories of type eh1 , h1h1 , eh2 , and h1h2 , respectively .",
    "they are shown in figure  [ fig : bifurcationsminimal ] .",
    "their shapes are described below .",
    "[ num : bifurcationsp ] let @xmath32 , @xmath33 , and @xmath34 .",
    "then @xmath35 for some continuous functions @xmath36 \\to { \\mathbb{r}}$ ] such that    1 .",
    "@xmath37 is concave increasing in @xmath38 $ ] , @xmath39 for all @xmath40 , and @xmath41 ; 2 .",
    "@xmath42 is concave increasing in @xmath38 $ ] , @xmath43 for all @xmath40 , and @xmath44 ; 3 .",
    "@xmath45 is the identity in @xmath46 $ ] , concave decreasing in @xmath47 $ ] , and @xmath48 ; and 4 .",
    "@xmath49 is increasing in @xmath50 $ ] , concave decreasing in @xmath51 $ ] , @xmath52 for all @xmath53 , @xmath54 for all @xmath55 , @xmath56 , and @xmath57 .",
    "the functions @xmath58 can be explicitly expressed by means of algebraic formulae .",
    "we shall prove that @xmath59 in proposition  [ pro : bifurcationsh1h1 ] .",
    "we shall study the other three functions in another paper  @xcite , because the techniques change drastically .",
    "a generalized cayley - like condition is the main tool .",
    "for instance , @xmath60 this function @xmath49 is not concave in the interval @xmath50 $ ] .",
    "we shall describe in section  [ sec:3d ] the regions corresponding to ellipsoids that have periodic trajectories with given winding numbers ( or quasiperiodic trajectories with given frequencies ) for the four caustic types .",
    "those general regions have the same shape as these `` minimal '' regions .",
    "that is , they are below the graphs of some functions with properties similar to the ones stated previously .",
    "therefore , we discover a general principle . _",
    "the more spheric is an ellipsoid , the poorer are its four types of billiard dynamics .",
    "_ here , spheric means @xmath61 .",
    "we quantify this principle in propositions  [ pro : criterions ] and  [ pro : criterions2 ] .",
    "the key step for the numerical computation of these regions is to explicitly extend the frequency map for singular values of the caustic parameters .",
    "the extension is `` exponentially sharp '' at some points , which implies another general principle . _ the billiard trajectories with some almost singular caustic are ubiquitous .",
    "_ we shall enlighten it in subsection  [ ssec : singular3d ] by giving a quantitative sample .",
    "the minimal periodic trajectories shown in figure  [ fig : periodictrajectories3d ] reinforce it .",
    "finally , we want to mention that there exist many remarkable results about periodic trajectories in other billiard and geodesic problems . for instance , several nice algebraic closed geodesics on a triaxial ellipsoid can be seen in  @xcite , and a cayley - like condition for billiards _ on _ quadrics was established in  @xcite .",
    "some results stray from any integrable setup .",
    "for example , some general lower bounds on the number of periodic billiard trajectories inside strictly convex smooth hypersurfaces can be found in  @xcite .",
    "the planar case was already solved by birkhoff  @xcite .",
    "of course , these lower bounds are useless for integrable systems where the periodic trajectories are organized in continuous families .",
    "we complete this introduction with a note on the organization of the paper . in section",
    "[ sec : preliminaries ] we review briefly some well - known results about billiards inside ellipsoids in order to fix notations that will be used along the rest of the paper .",
    "next , the frequency map is introduced and interpreted in section  [ sec : frequencymap ] .",
    "this section , concerning ellipsoids of @xmath10 , also contains two conjectures and the lower bounds on the periods .",
    "billiards inside ellipses of @xmath9 and inside triaxial ellipsoids of @xmath8 are thoroughly studied in sections  [ sec:2d ] and [ sec:3d ] , respectively .",
    "billiards inside nondegenerate ellipsoids of @xmath10 are revisited in section  [ sec : nd ] .",
    "some technical lemmas have been relegated to the appendices .",
    "in this section details are scarce and technicalities are avoided .",
    "experts can simply browse this section . we will list several basic references for the more novice readers .",
    "the following results go back to jacobi , chasles , poncelet , and darboux .",
    "the starting point of our discussion is the @xmath2-dimensional nondegenerate ellipsoid @xmath62 where @xmath63 are some fixed real constants such that @xmath64 .",
    "the degenerate cases in which the ellipsoid has some symmetry of revolution are not considered here .",
    "this ellipsoid is an element of the family of _ confocal quadrics _ given by @xmath65 the meaning of @xmath66 is unclear in the singular cases @xmath67 .",
    "in fact , there are two natural choices for the singular confocal quadric @xmath66 when @xmath68 .",
    "the first choice is to define it as the @xmath2-dimensional coordinate hyperplane @xmath69 but it also makes sense to define it as the @xmath70-dimensional _ focal quadric _ @xmath71 which is contained in the hyperplane @xmath72 .",
    "both choices fit in the framework of elliptic billiards , but we shall use the notation @xmath73 along this paper .    [",
    "thm : jacobichasles ] once fixed a nondegenerate ellipsoid @xmath4 , a generic line @xmath74 is tangent to exactly @xmath2 distinct nonsingular confocal quadrics @xmath5 such that @xmath75 , @xmath76 , and @xmath77 , for @xmath78 .",
    "set @xmath79 .",
    "if a generic line @xmath80 has a transverse intersection with the ellipsoid @xmath4 , then @xmath81 , so @xmath82 . the value @xmath83 is attained just when @xmath80 is tangent to @xmath4 .",
    "a line is generic in the sense of the theorem if and only if it is neither tangent to a singular confocal quadric when it is contained in the coordinate hyperplane @xmath72 or when it passes through the focal quadric @xmath84 . ] nor contained in a nonsingular confocal quadric .",
    "if two lines obey the reflection law at a point @xmath85 , then both lines are tangent to the same confocal quadrics  @xcite .",
    "this shows a tight relation between elliptic billiards and confocal quadrics : all lines of a billiard trajectory inside the ellipsoid @xmath4 are tangent to exactly @xmath2 confocal quadrics @xmath5 , which are called _ caustics _ of the trajectory .",
    "we will say that @xmath86 are the _ caustic parameters _ of the trajectory .",
    "a billiard trajectory inside a nondegenerate ellipsoid of the euclidean space @xmath10 is _ nonsingular _ when it has @xmath2 distinct nonsingular caustics ; that is , when its caustic parameter belongs to the _ nonsingular caustic space _",
    "@xmath87    we will only deal with nonsingular billiard trajectories along this paper .",
    "we denote the @xmath88 open connected components of the nonsingular caustic space as follows : @xmath89 for @xmath90 .",
    "for instance , the first caustic @xmath91 is an ellipsoid if and only if @xmath92 ; that is , if and only if @xmath93 with @xmath94 .",
    "we will draw the space @xmath95 for ellipses and triaxial ellipsoids of @xmath8 in sections  [ sec:2d ] and  [ sec:3d ] , respectively .",
    "[ thm : poncelet ] if a nonsingular billiard trajectory closes after @xmath21 bounces , all trajectories sharing the same caustics close after @xmath21 bounces .",
    "poncelet proved this theorem for conics  @xcite .",
    "darboux generalized it to triaxial ellipsoids of @xmath8 .",
    "later on , this result was generalized to any dimension in  @xcite .",
    "[ thm : cayley ] the nonsingular billiard trajectories sharing the caustics @xmath5 close after @xmath96 bounces up to the action of the group of symmetries @xmath97 of @xmath4 , if and only if @xmath98 and @xmath99 where @xmath100 .    the group @xmath101 is formed by the @xmath102 reflections involutive linear transformations with regard to coordinate subspaces .",
    "the phrase `` a billiard trajectory closes after @xmath96 bounces up to the action of @xmath101 '' means that if @xmath103 is the sequence of impact points of the trajectory , then there exists a reflection @xmath104 such that @xmath105 for all @xmath106 .",
    "hence , billiard trajectories that close after @xmath96 bounces up to the action of the group @xmath101 , close after @xmath107 or @xmath108 bounces , because @xmath109 .",
    "cayley proved this theorem for conics  @xcite . later on , this result was generalized to any dimension by dragovi and radnovi in  @xcite .",
    "we recall some results obtained by liouville , arnold , moser , and knrrer .",
    "a symplectic map @xmath110 defined on a @xmath1-dimensional symplectic manifold is _ completely integrable _ if there exist some smooth @xmath111-invariant functions @xmath112 ( the _ integrals _ ) that are in involution that is , whose pair - wise poisson brackets vanish and that are functionally independent almost everywhere on the phase space @xmath113 . in this context",
    ", the map @xmath114 is called the",
    "_ momentum map_. a point @xmath115 is a _ regular point _ of the momentum map when the @xmath2-form @xmath116 does not vanish at @xmath96 .",
    "a vector @xmath117 is a _ regular value _ of the momentum map when every point in the level set @xmath118 is regular , in which case the level set is a lagrangian submanifold of @xmath113 and we say that @xmath118 is a _ regular level set_.    the following result is a discrete version of the liouville - arnold theorem .",
    "any compact connected component of a regular level set @xmath118 is diffeomorphic to @xmath119 , where @xmath120 . in appropriate coordinates the restrictions of the map to this torus becomes a parallel translation @xmath121 .",
    "the map @xmath7 is smooth at the regular values of the momentum map .",
    "thus the phase space @xmath113 is almost foliated by lagrangian invariant tori and the map on each torus is simply a parallel translation .",
    "these tori are called _ liouville tori _ , the shift @xmath3 is the _ frequency _ of the torus , and the map @xmath7 is the _ frequency map_. the dynamics on a liouville torus with frequency @xmath3 is @xmath21-periodic if and only if @xmath122 .",
    "liouville tori become just invariant curves when @xmath123 , in which case the shift is usually called the _ rotation number _ of the invariant curve , and denoted by @xmath124 , instead of @xmath3 .    now , let @xmath4 be a ( strictly ) convex smooth hypersurface of @xmath10 diffeomorphic to the sphere @xmath125 , not necessarily an ellipsoid . the billiard motion inside @xmath4",
    "can be modelled by means of a symplectic diffeomorphism defined on the @xmath1-dimensional phase space @xmath126 we define the billiard map @xmath127 , @xmath128 , as follows .",
    "the new velocity @xmath129 is the reflection of the old velocity @xmath130 with respect to the tangent plane @xmath131 .",
    "that is , if we decompose the old velocity as the sum of its tangent and normal components at the surface : @xmath132 with @xmath133 and @xmath134 , then @xmath135 .",
    "the new impact point @xmath136 is the intersection of the ray @xmath137 with the surface @xmath4 .",
    "this intersection is unique and transverse by convexity .",
    "elliptic billiards fit in the frame of the liouville - arnold theorem .",
    "[ thm : mk ] the billiard map associated to the nondegenerate ellipsoid  ( [ eq : q ] ) is completely integrable and the caustic parameters @xmath138 are the integrals .",
    "the set of regular values of the corresponding momentum map is given by  ( [ eq : nonsingularset ] ) .",
    "the rotation number for the billiard inside an ellipse is a quotient of elliptic integrals ; see  @xcite .",
    "explicit formulae for the frequency map of the billiard inside a triaxial ellipsoid of @xmath8 can be found in  @xcite .",
    "an equivalent formula is given in  @xcite .",
    "both formulae contain hyperelliptic integrals and they can be effortless generalized to any dimension . since we want to avoid as many technicalities as possible , we will not talk about riemann surfaces , basis of holomorphic differential forms , basis of homology groups , period matrices , or other objects that arise in the theory of algebraic curves .",
    "the following notations are required to define the frequency map .",
    "once fixed the parameters @xmath63 of the ellipsoid , and the caustic parameters @xmath138 , we set @xmath139 if @xmath140 , then @xmath141 are pair - wise distinct and positive , so we can assume that @xmath142 hence , @xmath143 is positive in the @xmath144 open intervals @xmath145 , and the improper integrals @xmath146 are absolutely convergent , real , and positive .",
    "we also consider the @xmath144 column vectors @xmath147 it is known that vectors @xmath148 are linearly independent ; see  @xcite .",
    "[ defi : frequencymap ] the _ frequency map",
    "_ @xmath149 of the billiard inside the nondegenerate ellipsoid @xmath4 is the unique solution of the system of @xmath2 linear equations @xmath150    [ remark : homogeneous ] sometimes it is useful to think that the frequency @xmath3 depends on the parameter @xmath151 , and not only on the caustic parameter @xmath152 . in such situations ,",
    "we will write @xmath153 . this map @xmath154 is homogeneous of degree zero and analytic in the domain defined by inequalities  ( [ eq : inequalities ] ) .",
    "homogeneity is deduced by performing a change of scale in the integrals  ( [ eq : kintegrals ] ) .",
    "hence , we can assume without loss of generality that @xmath155 .",
    "analyticity follows from the fact that the integrands in  ( [ eq : kintegrals ] ) are analytic with respect to the variable of integration in all the intervals of integration and with respect to @xmath156 , as long as condition  ( [ eq : inequalities ] ) takes place .",
    "this definition coincides with the formulae contained in  @xcite for @xmath157 .",
    "it is motivated by the characterization of periodic billiard trajectories contained in the next theorem .",
    "the factor @xmath158 has been added to simplify the interpretation of the components of the frequency map , which are all positive , due to the factors @xmath159 .",
    "[ thm : dr ] the nonsingular billiard trajectories inside the nondegenerate ellipsoid @xmath4 are periodic with exactly @xmath160 points at @xmath161 and @xmath160 points at @xmath162 if and only if @xmath163 .",
    "the numbers @xmath164 that appear in theorem  [ thm : dr ] are called _ winding numbers_. the nonsingular billiard trajectories with caustic parameter @xmath165 are periodic with winding numbers @xmath164 if and only if @xmath166 we note that @xmath21 is the number of bounces in the ellipsoid @xmath167 , so it is the period .",
    "[ rem : windingnumbers ] the sequence of winding numbers of a nonsingular periodic billiard trajectory contains information about how the trajectory folds in the space @xmath10 .",
    "the following properties can be deduced from results contained in  @xcite . here",
    ", `` number of '' means `` number of times that any periodic billiard trajectory with those caustic parameters do along one period '' .",
    "the intervals @xmath145 with @xmath168 can adopt exactly four different forms , each one giving rise to its own geometric picture .    1 .   if @xmath169 , then @xmath160 is the number of crossings with @xmath72 , so it is even and @xmath170 is the number of oscillations around the hyperplane @xmath72 ; 2 .   if @xmath171 , then @xmath160 is the number of crossings with @xmath172 , so it is even and @xmath170 is the number of oscillations around the hyperplane @xmath172 ; 3 .",
    "[ item : planeoscillations ] if @xmath173 , then @xmath160 is the number of ( alternate ) crossings with @xmath72 and @xmath172 , so it is even and @xmath170 is the number of rotations that the trajectory performs when projected onto the @xmath174-coordinate plane @xmath175 ; and 4 .   [",
    "item : causticoscillations ] if @xmath176 , then @xmath160 is the number of ( alternate ) tangential touches with @xmath177 and @xmath178 , so it can be even or odd , and it is the number of oscillations between both caustics .",
    "these four properties suggest us the following definitions , which establish the geometric meaning of the components of the frequency map .",
    "they change with the open connected components of the nonsingular caustic space .",
    "let @xmath179 be the frequency map .    1 .   if @xmath169 , then @xmath180 is the _ @xmath72-oscillation number _ ; 2 .   if @xmath171 , then @xmath180 is the _ @xmath172-oscillation number _ ; 3 .   if @xmath173 , then @xmath180 is the _ @xmath175-rotation number _ ; and 4 .",
    "if @xmath176 , @xmath181 is the _",
    "@xmath182-oscillation number_.    [ rem : factor_2 ] it is important to notice that ( only ) when a @xmath21-periodic billiard trajectory has two caustics of the same type that is , when some interval @xmath145 falls into the fourth case , it is possible that @xmath183 , although then @xmath184 .",
    "this is due to the factor @xmath158 that we have added in the definition of the frequency map .",
    "finally , if @xmath91 is not an ellipsoid that is , if @xmath185 , then @xmath186 , and @xmath21 is the number of crossings with @xmath187 , so it is even . therefore , the following corollary holds .",
    "[ cor : odd ] among all the nonsingular billiard trajectories inside a nondegenerate ellipsoid , only those with an ellipsoid as caustic can have odd period .      [ con : frequencylocal ] the frequency map is a local diffeomorphism ; i.e. , it is nondegenerate : @xmath188    this conjecture has several relevant consequences throughout the paper .",
    "popov and topalov  @xcite have shown that the frequency map is _ almost everywhere _ nondegenerate when @xmath4 is a triaxial ellipsoid of @xmath8 , although they only consider the components @xmath189 such that @xmath190 .",
    "the nondegeneracy of the frequency map is important because it is an essential hypothesis although we acknowledge that it can be replaced by some weaker rssmann - like nondegeneracy conditions  @xcite in most kam - like theorems , which are the standard tool to prove the persistence of liouville tori under small smooth perturbations of completely integrable maps .",
    "therefore , if conjecture  [ con : frequencylocal ] holds , we can conclude that most of the liouville tori of the billiard phase space persist under small smooth perturbations of the ellipsoid .",
    "we shall present evidences for this conjecture in sections  [ sec:2d ] and  [ sec:3d ] .",
    "[ con : windingnumbers ] winding numbers of nonsingular periodic billiard trajectories are ordered in a strict decreasing way . more concretely , @xmath191    inequality @xmath192 is immediate , because @xmath193 , so @xmath194 is even .",
    "inequalities @xmath195 for @xmath196 are also immediate , because the number of crossings with any fixed hyperplane or the number of tangential touches with any fixed caustic can not exceed the number of segments of the periodic billiard trajectory .",
    "the strict inequalities @xmath197 could be also established ( using the symmetries of the ellipsoid ) , but we skip the details , since such a small improvement is not worth the effort .",
    "if both conjectures hold , the components of the frequency map are also ordered in a strict decreasing way and lie in the range @xmath198 ; that is , @xmath199 to prove this , we note that conjecture  [ con : frequencylocal ] implies that @xmath200 is open in @xmath201 and @xmath202 is dense in @xmath95 , whereas conjecture  [ con : windingnumbers ] and relation  ( [ eq : frequencywinding ] ) imply that the strict inequalities @xmath203 hold for rational frequencies .",
    "therefore , @xmath204 for any @xmath140 , but these inequalities must be strict because @xmath200 is open .",
    "we have numerically checked that inequalities  ( [ eq : frequencyorder ] ) hold for thousands of random choices of @xmath205 in `` dimensions '' @xmath206 .",
    "the details of the experiments for @xmath157 are presented in section  [ sec:3d ] .      we know from theorem  [ thm : cayley ] that the period @xmath21 of any nonsingular periodic billiard trajectory inside a nondegenerate ellipsoid @xmath0 verifies that @xmath207 .",
    "this result can be improved in several ways using the ordering of the winding numbers stated in conjecture  [ con : windingnumbers ] .",
    "for instance , the global lower bound @xmath208 follows directly .",
    "we present below more refined semi - global lower bounds , holding each one on a different open connected component of the nonsingular caustic space .",
    "they are obtained by realizing that some winding numbers must be even in agreement with the first items in remark  [ rem : windingnumbers ] .",
    "the lower bound associated to some connected component reaches the value @xmath209 , which doubles the original lower bound given in theorem  [ thm : cayley ] .",
    "[ thm : lowerbounds ] given any @xmath90 , let @xmath210 be the subset of @xmath211 such that : 1 ) @xmath212 ; 2 ) @xmath213 ; and 3 ) @xmath214 .    1 .   if @xmath215 are the winding numbers of a periodic trajectory with caustic parameter in @xmath189 , then @xmath160 is even for all @xmath216",
    "2 .   if conjecture  [ con : windingnumbers ] holds , any periodic billiard trajectory inside a nondegenerate ellipsoid of @xmath10 whose caustic parameter is in @xmath189 has period at least @xmath217 3 .",
    "let @xmath218 , @xmath219 , and @xmath220 . then @xmath221    \\(i ) we recall that @xmath160 must be even in the three first cases listed in remark  [ rem : windingnumbers ] .",
    "this is the key property .",
    "for instance , @xmath194 is always even because @xmath193 . if @xmath222 , then @xmath223 and @xmath186 , so @xmath21 is even . if @xmath160 is odd , then @xmath176 and @xmath224 , so @xmath225 .",
    "hence , we have seen that @xmath226 is even .",
    "\\(ii ) this follows directly from the previous item and the definition of @xmath227 .",
    "\\(iii ) first , we note that @xmath228 and @xmath229 .",
    "therefore , @xmath230 , and @xmath231    the minimum value of @xmath21 among all integer sequences such that @xmath232 is attained at the sequence @xmath233 , @xmath234 .",
    "thus , @xmath235 for all @xmath220 , and @xmath236 .    on the other hand , @xmath237 .",
    "hence , @xmath238 for all @xmath220 . finally , @xmath239 .",
    "let @xmath240 and @xmath241",
    ". then @xmath242 and @xmath243 , so @xmath244 and @xmath245 .",
    "all the lower bounds @xmath227 can be explicitly computed when @xmath157 . in that case , @xmath246 where @xmath247 , @xmath248 , @xmath249 , and @xmath250 .",
    "therefore , theorem  [ thm : lowerbounds3d ] about triaxial ellipsoids of @xmath8 is just a particular case of theorem  [ thm : lowerbounds ] .",
    "it suffices to realize that @xmath251 , @xmath252 , @xmath253 , and @xmath254 correspond to the cases eh1 , h1h1 , eh2 , and h1h2 , respectively .",
    "the function @xmath255 is surjective and has average @xmath256 we skip the details , the proof is by induction over @xmath2 .",
    "thus , these semi - global lower bounds improve the global lower bound @xmath257 by , in average , almost @xmath258 .",
    "now , a natural question arises .",
    "are these semi - global lower bounds optimal ?",
    "optimal does not mean that there exists a @xmath227-periodic billiard trajectory whose caustic parameter is in @xmath189 inside _ all _ nondegenerate ellipsoids , but just inside _ some _ of them .",
    "and we put another question . which are the ellipsoids with such `` minimal '' periodic billiard trajectories ?",
    "both questions become almost trivial for ellipses ; see subsection  [ ssec : periodictrajectories2d ] . the case of triaxial ellipsoids of @xmath8",
    "was numerically answered in the introduction .",
    "the general case remains open , but we conjecture that all these semi - global lower bounds are optimal .",
    "in this section we describe the main properties of the frequency map when @xmath123 , in which case it is called rotation number and denoted by @xmath124 .",
    "many of these properties are old , but the observation that the the rotation number is exponentially sharp at the singular caustic parameter seems to be new .",
    "the known results can be found in the monographes  @xcite and the papers  @xcite .      to simplify the exposition",
    ", we write the ellipse as @xmath259 where we could assume , without loss of generality , that @xmath14 ; see remark  [ remark : homogeneous ] . then any nonsingular billiard trajectory inside @xmath4 is tangent to one confocal caustic of the form @xmath260 where the caustic parameter @xmath165 belongs to the nonsingular caustic space ( resp .",
    ", @xmath261 ) the caustic @xmath262 flattens into the region of the x - axis enclosed by ( resp . , outside ) the foci of the ellipse @xmath4 .",
    "when @xmath263 , the caustic flattens into the whole y - axis . ]",
    "@xmath264 we have chosen those names for the connected components of @xmath95 because then @xmath262 is an ellipse for @xmath265 , and a hyperbola for @xmath266 .",
    "we describe now the billiard dynamics inside an ellipse .",
    "this description goes back to birkhoff  @xcite , so it is rather old and we just list the results .",
    "concretely , we want to know how the phase space is foliated by liouville tori ( invariant curves on which the motion becomes a rigid rotation ) and separatrices ( invariant curves on which the motion tends to some hyperbolic periodic trajectories ) .",
    "let us put some global coordinates @xmath267 over the billiard phase space @xmath113 defined in  ( [ eq : phasespace ] ) , just for visualization purposes .",
    "first , following birkhoff , we parameterize the impact points on the ellipse by means of an angular coordinate @xmath268 .",
    "we take , for instance , @xmath269 .",
    "second , given an outward unitary velocity @xmath270 , we set @xmath271 , and so @xmath272",
    ". then the correspondence @xmath273 allows us to identify the phase space @xmath113 with the annulus @xmath274 in these coordinates , the caustic parameter becomes @xmath275 .",
    "the partition of the annulus into invariant level curves of @xmath165 is shown in figure  [ fig : phaseportrait ] .",
    "coordinates for @xmath14 and @xmath276 .",
    "the dashed black lines enclose the phase space  ( [ eq : phasespace2d ] ) .",
    "the black points are the hyperbolic two - periodic points corresponding to the oscillation along the major axis of the ellipse .",
    "the black curves are the separatrices of these hyperbolic points .",
    "the magenta points denote the elliptic two - periodic points corresponding to the oscillation along the minor axis of the ellipse .",
    "the magenta curves are the invariant curves whose rotation number coincides with the frequency of these elliptic points .",
    "the invariant curves with rotation numbers @xmath277 , @xmath278 and @xmath279 are depicted in blue , green and red , respectively .",
    "the red points label a three - periodic trajectory whose caustic is an ellipse . the green points label a four - periodic trajectory whose caustic is a hyperbola.,width=576 ]    each regular level set contains _ two _ liouville curves and represents the family of tangent lines to a fixed nonsingular caustic @xmath262 .",
    "if @xmath262 is an ellipse , each liouville curve has a one - to - one projection onto the @xmath280 coordinate and corresponds to rotations around @xmath262 in opposite directions , so they are invariant under @xmath111 . if @xmath262 is a hyperbola , then each liouville curve corresponds to the impacts on _ one _ of the two pieces of the ellipse between the branches of @xmath262 , so they are exchanged under @xmath111 and invariant under @xmath281 .",
    "the singular level set @xmath282 gives rise to the @xmath283-shaped curve @xmath284 which corresponds to the family of lines through the foci .",
    "this singular level set has rotation number @xmath285 ; see  @xcite .",
    "the cross points on this singular level represent the two - periodic trajectory along the major axis of the ellipse , and the eigenvalues of the differential of the billiard map at them are positive but different from one : @xmath286 with @xmath287 and @xmath288 . on the contrary ,",
    "the two - periodic trajectory along the minor axis correspond to the centers of the regions inside the @xmath283-shaped curve , and the eigenvalues in that case are conjugate complex of modulus one : @xmath289 with @xmath290 and @xmath291 .",
    "therefore , the major axis is a hyperbolic ( unstable ) two - periodic trajectory and the minor axis is an elliptic ( stable ) one .",
    "these are the only two - periodic motions .",
    "the basic results about the stability of two - periodic billiard trajectories can be found in  @xcite .",
    "let @xmath292 be the _ rotation number _ of the billiard trajectories inside the ellipse @xmath4 sharing the nonsingular caustic @xmath262 . from definition  [ defi : frequencymap ]",
    "we get that the function @xmath293 is given by the quotients of elliptic integrals @xmath294 where the parameters @xmath295 are given by @xmath296 and @xmath297 , with @xmath298 and @xmath299 .",
    "the second equality follows from the change of variables @xmath300 .",
    "the second quotient already appears in  @xcite .",
    "other equivalent quotients of elliptic integrals were given in  @xcite .",
    "we have drawn the rotation function @xmath292 in figure  [ fig : rotationfunction ] , compare with  @xcite .",
    "[ pro:2d ] the function @xmath301 given in  ( [ eq : rotationnumber ] ) has the following properties .    1 .",
    "it is analytic in @xmath302 .",
    "it can be continuously extended to the closed interval @xmath303 $ ] with @xmath304 where the limit value @xmath305 is defined by @xmath306 .",
    "3 .   let @xmath307 and @xmath308 be the positive constants given by @xmath309 the asymptotic behavior of @xmath292 at the singular parameters @xmath310 is : 1 .",
    "@xmath311 , as @xmath312 ; 2 .",
    "@xmath313 , as @xmath314 ; and 3 .",
    "@xmath315 , as @xmath263 .",
    "4 .   given any @xmath316 ,",
    "let @xmath317 be the biggest parameter in @xmath318 such that @xmath319 , and let @xmath320 be the smallest parameter in @xmath321 such that @xmath322 .",
    "both parameters become exponentially close to the singular caustic parameter @xmath323 when @xmath324 tends to @xmath285 .",
    "in fact , @xmath325     of the ellipse for @xmath14 and @xmath276 .",
    "colours are taken from figure  [ fig : phaseportrait ] .",
    "the parameters @xmath326 fast approach @xmath323 as @xmath327 tends to @xmath285.,width=576 ]    ( i )  follows from remark  [ remark : homogeneous ] .",
    "the rest of the proof is postponed to  [ sap : proof_2d ] .",
    "if conjecture  [ con : frequencylocal ] holds , then @xmath328 is positive in @xmath318 and negative in @xmath321 , so @xmath292 maps diffeomorphically @xmath318 onto @xmath198 and @xmath321 onto @xmath329 . in particular , the parameters @xmath317 and @xmath320 are unique . the conjecture remains unproven , but we shall see in proposition  [ pro : increasing ] that @xmath292 is increasing in @xmath318 , which suffices to check the unicity of @xmath317 .",
    "the limit rotation number @xmath330 is related to the conjugate complex eigenvalues @xmath289 of the elliptic two - periodic orbit .",
    "concretely , @xmath331 . besides , @xmath330 tends to zero when the ellipse flattens and tends to one half when the ellipse becomes circular .",
    "that is , @xmath332 , and @xmath333 .",
    "[ defi : extended_rho ] the continuous extension @xmath334 \\to { \\mathbb{r}}$ ] is called the _ ( extended ) rotation function _ of the ellipse @xmath4 .",
    "let us assume that the billiard trajectories sharing some nonsingular caustic @xmath262 are @xmath21-periodic , so they describe polygons with @xmath21 sides inscribed in the ellipse @xmath4 .",
    "then , according to theorem  [ thm : dr ] , equation  ( [ eq : frequencywinding ] ) , and corollary  [ cor : odd ] , it turns out that @xmath335 for some integers",
    "@xmath336 such that @xmath22 is always even whereas @xmath21 can be odd only when @xmath262 is an ellipse . besides , from the geometric interpretation of the frequency map presented in section  [ sec : frequencymap ] , we know that : 1 ) if @xmath262 is an ellipse , the polygons are enclosed between @xmath4 and @xmath262 , and make @xmath337 turns around the origin ; and 2 ) if @xmath262 is a hyperbola , they are contained in the region delimited by @xmath4 and the branches of @xmath262 , and cross @xmath22 times the minor axis of the ellipse .",
    "these interpretations can be extended to nonperiodic trajectories .",
    "concretely , @xmath338 where @xmath339 ( respectively , @xmath340 ) is the number of turns around the origin ( respectively , crossings of the minor axis ) of the first @xmath341 segments of a given billiard trajectory with caustic @xmath262 .",
    "[ pro : increasing ] the rotation function @xmath292 is increasing in @xmath318 .",
    "let @xmath342 be a fixed parameterization of the ellipse @xmath4",
    ". then the billiard dynamics inside @xmath4 associated to any caustic @xmath262 , @xmath265 , induces a circle diffeomorphism @xmath343 of rotation number @xmath292 .",
    "let @xmath344 .",
    "the billiard trajectories sharing the small caustic @xmath345 rotate faster than the ones sharing the big caustic @xmath91 , so @xmath346 for any two compatible lifts @xmath347 of the circle diffeomorphisms @xmath348",
    ". then @xmath349 ; see  ( * ? ? ?",
    "* proposition  11.1.8 ) .",
    "thus , @xmath292 is nondecreasing and , by analyticity , increasing .",
    "we have not proved that @xmath292 is decreasing in @xmath321 because it is not easy to construct an ordered family of circle diffeomorphisms for caustic hyperbolas .",
    "we want to determine all the ellipses @xmath350 , @xmath351 , that have billiard trajectories with a prescribed rotation number @xmath352 and with a prescribed type of caustics ( ellipses or hyperbolas ) .",
    "we recall that the rotation function @xmath292 diffeomorphically maps @xmath318 onto @xmath198 , and @xmath321 onto @xmath329 .",
    "therefore , @xmath353 for all ellipses @xmath4 , whereas @xmath354 this shows that flat ellipses have more periodic trajectories than rounded ones .",
    "there exist similar results for triaxial ellipsoids of @xmath8 .",
    "see , for instance , propositions  [ pro : criterions ] and  [ pro : criterions2 ] .       and @xmath276 .",
    "left : period three and the caustic is an ellipse .",
    "right : period four and the caustic is a hyperbola .",
    "the continuous lines are reserved for the trajectories that correspond to the periodic orbits depicted in figure  [ fig : phaseportrait].,title=\"fig:\",width=288 ]   and @xmath276 .",
    "left : period three and the caustic is an ellipse .",
    "right : period four and the caustic is a hyperbola .",
    "the continuous lines are reserved for the trajectories that correspond to the periodic orbits depicted in figure  [ fig : phaseportrait].,title=\"fig:\",width=288 ]    the billiard map associated to an ellipse has no fixed points , its only two - periodic points correspond to the oscillations along the major or minor axis , and only the trajectories with an ellipse as caustic can have odd period . therefore , the periodic trajectories with an ellipse as caustic have period at least three , whereas the ones with a hyperbola as caustic have period at least four .",
    "these lower bounds are optimal ; see figure  [ fig : periodictrajectories2d ] . to be more precise , we set @xmath355 we note that @xmath356 for all @xmath351 , and @xmath357 for all @xmath358 . the trajectories with caustic @xmath359 are three - periodic , the ones with caustic @xmath360 are four - periodic .",
    "the proof is an elementary exercise in euclidean geometry .",
    "we leave it to the reader .",
    "finally , we deduce from the geometric interpretation of the rotation number given before that @xmath361 and @xmath362 .",
    "this second identity explains the restriction @xmath363 ; see  ( [ eq : bifurcations2d ] ) .",
    "the previous section sets the basis of this one . roughly speaking , we want to follow the same steps extension of the frequency map and description of its range in order to find the same results bifurcations in the parameter space and minimal periodic trajectories . but the study of ellipsoids is harder , which has two unavoidable consequences .",
    "first , statements and proofs of the analytical results are more cumbersome .",
    "second , some results remain unproven , so we shall present numerical experiments and semi - analytical arguments as support .",
    "the caustics of a billiard inside a triaxial ellipsoid are described in several places .",
    "the representation of the caustic space shown in figure  [ fig : causticspace ] can also be found in  @xcite .",
    "we write the triaxial ellipsoid as @xmath364 we could assume , again without loss of generality , that @xmath14 .",
    "then the parameter space of triaxial ellipsoids in @xmath8 can be represented as the triangle @xmath365 whose edges represent ellipsoids with a symmetry of revolution ( oblate and prolate ones ) or flat ellipsoids , as illustrated in figure  [ fig : parameterspace ] .",
    "we shall write the statements of the main results for arbitrary values of @xmath366 , but we shall take @xmath14 in the pictures .",
    "( 200,200)(0,0 )    ( 20,20 ) ( 180,20 ) ( 180,180 )    ( 20,20)(1,0)160 ( 180,20)(0,1)160 ( 20,20)(1,1)160    ( 185,170 ) ( 60,100 ) ( 185,90 ) ( 100,55 ) ( 55,10)flat ellipsoids : @xmath367 ( -35,10 ) ( 185,10 )    from theorem  [ thm : jacobichasles ] , we know that any nonsingular billiard trajectory inside the ellipsoid @xmath4 is tangent to _ two _ distinct nonsingular caustics of the confocal family @xmath368 the caustic @xmath262 is an ellipsoid for @xmath265 , a one - sheet hyperboloid when @xmath369 , and a two - sheet hyperboloid if @xmath370 , where @xmath371    in order to have a clearer picture of how these caustics change , let us explain the situation when @xmath165 approaches the singular values @xmath156 , @xmath323 , or @xmath366 .",
    "first , when @xmath372 ( respectively , @xmath373 ) , the caustic @xmath262 flattens into the region of the coordinate plane @xmath374 enclosed by ( respectively , outside ) the _ focal ellipse _",
    "second , when @xmath376 ( resp . , @xmath377 ) , the caustic @xmath262 flattens into the region of the coordinate plane @xmath378 between ( resp . , outside ) the branches of the _ focal hyperbola _",
    "@xmath379 third , the caustic flattens into the whole coordinate plane @xmath380 when @xmath381 .",
    "we recall that not all combinations of caustics can take place .",
    "for instance , both caustics can not be ellipsoids .",
    "the four possible combinations are denoted by eh1 , h1h1 , eh2 , and h1h2 .",
    "hence , the caustic parameter @xmath382 belongs to the nonsingular caustic space @xmath383 where @xmath384 .",
    "for instance ,",
    "@xmath385 for trajectories of type eh1 , which means that @xmath91 is an ellipsoid and @xmath345 is a one - sheet hyperboloid .",
    "( 150,200)(0,0 ) ( 50,0 ) ( 130,0 ) ( 0,50 ) ( 0,130 ) ( 0,170 ) ( 50,50 ) ( 50,130 ) ( 50,170 ) ( 130,130 ) ( 130,170 )    ( -10,48)@xmath156 ( -10,128)@xmath323 ( -10,168)@xmath366 ( -3,187)@xmath386 ( 48,-10)@xmath156 ( 128,-10)@xmath323 ( 152,-3)@xmath387 ( -10,86)@xmath101 ( -10,146)@xmath101 ( 23,41)@xmath388 ( 23,172)@xmath388 ( 85,172)@xmath388 ( 132,146)@xmath388 ( 90,82)@xmath388 ( 23,121)@xmath389 ( 85,121)@xmath389 ( 52,86)@xmath389 ( 52,146)@xmath389 ( 10,86)@xmath390 ( 10,146)@xmath391 ( 70,146)@xmath392 ( 60,102)@xmath393    ( 0,0)(1,0)150 ( 0,0)(0,1)185    ( 0,50)(1,0)50 ( 0,130)(1,0)130 ( 0,170)(1,0)130 ( 0,50)(0,1)120 ( 50,50)(0,1)120 ( 130,130)(0,1)40 ( 50,50)(1,1)80    ( 50,0)(0,1)50 ( 130,0)(0,1)130      to begin with , we extend the frequency map @xmath394 to the borders of the four components of the caustic space  ( [ eq : causticspace3d ] ) , in the same way that the rotation number was extended to the endpoints of the two caustic intervals  ( [ eq : causticspace2d ] ) . the extension depends strongly on the `` piece '' of the border under consideration .",
    "hence , we need some notations for such `` pieces '' .",
    "the set @xmath95 is the union of three open rectangles and one open isosceles rectangular triangle . in total",
    "@xmath95 has eleven edges and eight vertexes .",
    "we consider the partitions @xmath395 where @xmath396 is the set of edges , @xmath397 is the set of vertexes , and @xmath389 , @xmath101 and @xmath388 are the sets formed by the four inner edges , the two left edges , and the remaining five edges , respectively . see figure  [ fig : causticspace ] .",
    "we shall see that the frequency map is quite singular ( in fact , exponentially sharp ) at the four edges in @xmath389 , quite regular at the five edges in @xmath388 , and it is somehow related to the geodesic flow on the ellipsoid @xmath4 at the two edges in @xmath101 .",
    "that motivates the notation .",
    "next , we shall check that the frequency map of the triaxial ellipsoid @xmath4 can be continuously extended to the borders of the caustic space in such a way that its values on the edges and vertexes can be expressed in terms of exactly six functions of one variable that `` glue '' well .",
    "three of them are the extended rotation functions associated to the three ellipses obtained by sectioning @xmath4 with the coordinate planes @xmath398 , @xmath399 , and @xmath400 .",
    "that is , they are the functions @xmath401 \\to { \\mathbb{r}}$ ] , @xmath402 \\to { \\mathbb{r}}$ ] , and @xmath403 \\to { \\mathbb{r}}$ ] defined as @xmath404 using the notation in  ( [ eq : rotationnumber ] ) .",
    "the other three functions are defined in terms of the former ones as follows .",
    "let @xmath405 and @xmath406 .",
    "let @xmath407 , @xmath408 , and @xmath409 . then we consider the functions @xmath410 \\to { \\mathbb{r}}$ ] , @xmath411 \\to { \\mathbb{r}}$ ] , and @xmath412 \\to { \\mathbb{r}}$ ] defined by the identities",
    "@xmath413    [ lem : nu ] the functions @xmath414 , @xmath415 , and @xmath416 have the following properties .    1 .   they are analytic in @xmath417 , @xmath418 , and @xmath419 , respectively .",
    "they can be continuously extended to @xmath420 $ ] , @xmath421 $ ] , and @xmath420 $ ] , respectively .",
    "their asymptotic behavior at the endpoints @xmath422 are : 1 .",
    "@xmath423 , as @xmath312 ; 2 .",
    "@xmath424 , as @xmath312 ; 3 .",
    "@xmath425 , as @xmath426 ; 4 .",
    "@xmath427 , as @xmath426 ; 5 .",
    "@xmath428 , as @xmath429 ; 6 .",
    "@xmath430 , as @xmath429 ; 7 .",
    "@xmath431 , as @xmath377 ; and 8 .",
    "@xmath432 , as @xmath381 .",
    "we know that the function @xmath433 is analytic in @xmath165 , @xmath156 , and @xmath323 , as long as @xmath434 and @xmath435 . besides , the integrand @xmath436 is analytic with respect to the variable of integration @xmath437 in the intervals of integration @xmath438 and @xmath439 , and with respect to the parameters @xmath165 , @xmath156 , @xmath323 , and @xmath366 , as long as @xmath13 and @xmath435 .",
    "hence , the function @xmath440 is analytic in its four variables , as long as @xmath13 and @xmath435 .",
    "the analyticity of @xmath415 and @xmath416 follows from similar arguments .",
    "the study of the asymptotic behavior of the functions @xmath414 , @xmath415 , and @xmath416 has been deferred to  [ sap : nux ] , [ sap : nuy ] , and  [ sap : nuz ] , respectively .",
    "[ rem : numonotone ] we have numerically observed that @xmath414 and @xmath416 are increasing in @xmath318 and decreasing in @xmath187 , whereas @xmath415 is increasing in @xmath418 , but we have not been able to prove it .",
    "[ thm:3d ] the frequency map @xmath441 has the following properties .    1 .",
    "it is analytic in @xmath95 .",
    "it can be continuously extended to the border @xmath442 , and the extension has the form @xmath443 3 .   its asymptotic behavior at the eleven edges in @xmath444 is : 1 .",
    "@xmath445 , as @xmath446 ; 2 .",
    "@xmath447 , as @xmath448 ; 3 .",
    "@xmath449 , as @xmath450 ; and 4 .",
    "@xmath451 , as @xmath452 ; + for some analytic functions @xmath453 and @xmath454 .",
    "its asymptotic behavior at the eight vertexes in @xmath397 is : 1 .",
    "@xmath455 , as @xmath456 ; 2 .",
    "@xmath457 , as @xmath458 ; 3 .",
    "@xmath455 , as @xmath459 ; 4 .",
    "@xmath460 , as @xmath461 ; 5 .",
    "@xmath462 , as @xmath463 ; 6 .",
    "@xmath464 , as @xmath465 ; 7 .",
    "@xmath466 , as @xmath467 ; and 8 .",
    "@xmath468 , as @xmath469 .",
    "( 400,120)(0,0 )    ( 0,97)eh1 : ( 50,100)(1,0)350 ( 90,100)(1,0)10 ( 160,100)(1,0)80 ( 270,100)(1,0)80 ( 90,100 ) ( 160,100 ) ( 270,100 ) ( 350,100 ) ( 88,90)@xmath470 ( 158,90)@xmath156 ( 268,90)@xmath323 ( 348,90)@xmath366 ( 86,106)@xmath471 ( 156,106)@xmath472 ( 266,106)@xmath473 ( 346,106)@xmath474 ( 100,100 ) ( 240,100 ) ( 96,90)@xmath387 ( 236,90)@xmath386 ( 96,106)@xmath475 ( 236,106)@xmath476    ( 0,67)h1h1 : ( 50,70)(1,0)350 ( 90,70)(1,0)70 ( 190,70)(1,0)10 ( 270,70)(1,0)80 ( 90,70 ) ( 160,70 ) ( 270,70 ) ( 350,70 ) ( 88,60)@xmath470 ( 158,60)@xmath156 ( 268,60)@xmath323 ( 348,60)@xmath366 ( 86,76)@xmath471 ( 156,76)@xmath475 ( 266,76)@xmath473 ( 346,76)@xmath474 ( 190,70 ) ( 200,70 ) ( 186,60)@xmath387 ( 196,60)@xmath386 ( 186,76)@xmath472 ( 196,76)@xmath476    ( 0,37)eh2 : ( 50,40)(1,0)350 ( 90,40)(1,0)60 ( 160,40)(1,0)110 ( 280,40)(1,0)70 ( 90,40 ) ( 160,40 ) ( 270,40 ) ( 350,40 ) ( 88,30)@xmath470 ( 158,30)@xmath156 ( 268,30)@xmath323 ( 348,30)@xmath366 ( 86,46)@xmath471 ( 156,46)@xmath472 ( 266,46)@xmath476 ( 346,46)@xmath474 ( 150,40 ) ( 280,40 ) ( 146,30)@xmath387 ( 276,30)@xmath386 ( 146,46)@xmath475 ( 276,46)@xmath473    ( 0,7)h1h2 : ( 50,10)(1,0)350 ( 90,10)(1,0)70 ( 260,10)(1,0)10 ( 340,10)(1,0)10 ( 90,10 ) ( 160,10 ) ( 270,10 ) ( 350,10 ) ( 88,0)@xmath470 ( 158,0)@xmath156 ( 268,0)@xmath323 ( 348,0)@xmath366 ( 86,16)@xmath471 ( 156,16)@xmath475 ( 266,16)@xmath476 ( 346,16)@xmath474 ( 260,10 ) ( 340,10 ) ( 256,0)@xmath387 ( 336,0)@xmath386 ( 256,16)@xmath472 ( 336,16)@xmath473    once fixed the parameters @xmath477 of the ellipsoid and the couple of caustic parameters @xmath387 and @xmath386 , we set @xmath478 four configurations are possible ; see figure  [ fig : c ] .",
    "we said in remark  [ remark : homogeneous ] that the frequency is analytic in @xmath479 provided that @xmath480 .",
    "in particular , this implies that the frequency is analytic in the caustic parameter provided it belongs to @xmath95 .",
    "the frequency map is expressed in terms of six hyperelliptic integrals over the intervals @xmath481 , @xmath482 , and @xmath483 represented in thick lines in figure  [ fig : c ] .",
    "see definition  [ defi : frequencymap ] .",
    "we face its asymptotic behavior at the border @xmath484 , which requires the study of the asymptotic behavior of the six hyperelliptic integrals when some interval defined by the ordered sequence @xmath480 collapses to a point . therefore , there are exactly five simple collapses .",
    "the collapse of the first interval is called _ geodesic flow limit _ : @xmath485 , the collapse of the second or fourth intervals is called _ singular _ : @xmath486 or @xmath487 , and the collapse of the third or fifth intervals is called _ regular _ : @xmath488 or @xmath489 .",
    "thus , regular collapses imply that the interval of integration of a couple of hyperelliptic integrals collapses to a point ; whereas singular collapses imply the connection of two consecutive intervals of integration",
    ". see figure  [ fig : c ] .",
    "it is immediate to check that this terminology agrees with the partition @xmath490 , whereas double collapses that is , two simultaneous simple collapses correspond to the eight vertexes in @xmath397 .",
    "the asymptotic behavior of the frequency map at the eleven edges in @xmath490 is deduced from several results disseminated through  [ ap : hyperellipticintegrals ] . in short ,",
    "some technical lemmas are listed in  [ sap : technicallemmas ] , some notations are introduced in  [ sap : frequency ] , the geodesic flow limit is studied in  [ sap : geodesicflowlimit ] , simple regular collapses are analyzed in  [ sap : simpleregularcollapse ] , and simple singular collapses are computed in  [ sap : simplesingularcollapse ] .",
    "for instance , one can trace the definition of the functions @xmath414 , @xmath415 , and @xmath416 to equation  ( [ eq : rcondition ] ) .",
    "the reader is encouraged to consult the appendix .",
    "here , we just note that the appendix deals with the general high - dimensional setup , since the computations do not become substantially more involved when the dimension is increased .",
    "the computations regarding the vertexes have also been relegated to  [ ap : hyperellipticintegrals ] , although for the sake of brevity we have written out only the computations for two vertexes .",
    "vertex @xmath491 in  [ sap : totalsingularcollapse ] which corresponds to the unique double singular collapse , and vertex @xmath492 in  [ sap : totalregularcollapse ] which correspond to the unique double regular collapse .",
    "the study of the remaining six vertexes does not require additional ideas .",
    "for instance , the three vertexes related to the geodesic flow limit can be simultaneously dealt with simply by using lemma  [ lem : g ] , which ensures that the hyperelliptic integrals over @xmath493 are @xmath494 as @xmath446 .",
    "finally , we realize that the extended frequency map @xmath495 is continuous because the extensions `` glue '' well at the eight vertexes ; see lemma  [ lem : nu ] .",
    "for instance , let us consider the vertex @xmath496 .",
    "we obtain from the three statements of the theorem regarding this vertex that @xmath497 which is consistent : @xmath498 .",
    "[ defi : extended_omega ] the continuous extension @xmath495 is called the _ ( extended ) frequency map _ of the ellipsoid @xmath4 .",
    "the origin of the terminology `` geodesic flow limit '' can be explained as follows .",
    "the phase space of the geodesic flow on an triaxial ellipsoid @xmath499 was completely described by knrrer  @xcite .",
    "any nonsingular geodesic on @xmath4 oscillates between two symmetric curvature lines obtained by intersecting @xmath4 with some hyperboloid @xmath262 , @xmath500 .",
    "the rotation number of those oscillations is the quotient @xmath501 see  @xcite .",
    "this rotation number @xmath502 can be continuously extended to the closed interval @xmath503 $ ] with @xmath504 . on the other hand ,",
    "the geodesic flow on the ellipsoid @xmath4 with caustic lines @xmath505 can be obtained as a limit of the billiard dynamics inside @xmath4 when its first caustic @xmath91 approaches @xmath4 ; that is , when @xmath446 , so that @xmath506 .",
    "therefore , it is natural to look for a relation between the function @xmath507 and the rotation number @xmath508 .    @xmath509 .",
    "thus , @xmath510 , as @xmath446 .    in  [ ap :",
    "g ] we will check that @xmath307 is the unique solution of the linear system @xmath511 where @xmath512 , @xmath513 , and @xmath514 with @xmath515 . therefore , since @xmath500 , it turns out that @xmath516 , @xmath517 , @xmath518 , and @xmath519 . finally , @xmath520 .",
    "$ ] of the frequency map for eight different ellipsoids.,width=593,height=593 ]    we present the numerical experiments about conjecture  [ con : frequencylocal ] stated in section  [ sec : frequencymap ] .",
    "we have computed the jacobian of the frequency map @xmath521 for several ellipsoids , in order to check that it never vanishes .",
    "its visualization close to the four inner edges labelled with the letter @xmath389 in figure  [ fig : causticspace ] has a technical difficulty . to understand this fact",
    ", one can look at the graph of the rotation number @xmath292 shown in figure  [ fig : rotationfunction ] .",
    "the derivative @xmath328 explodes at @xmath522 , which would make difficult its visual representation .",
    "the problem is worse in the spatial case , because the frequency map has the same kind of `` inverse logarithm '' singularity at the four inner edges instead of at a single point .",
    "we overcome the visualization problem by representing the normalized jacobian @xmath523,\\qquad j_*(\\lambda ) = ( 1-\\exp(-|j(\\lambda)|))^{1/4}.\\ ] ] the exponential function is intended to cancel the exponentially sharp behavior of the jacobian at the inner edges .",
    "the exponent @xmath278 has been chosen by trial and error to obtain more informative plots .",
    "the normalized jacobian ranges over the interval @xmath38 $ ] .",
    "we note that @xmath524 and @xmath525 .",
    "the results are shown in figure  [ fig : jacobians ] . in the upper left corner",
    ", we have displayed the parameter space @xmath31 introduced in  ( [ eq : parameterspace ] ) , and sketched in figure  [ fig : parameterspace ] .",
    "we study the eight ellipsoids that correspond to the eight points in @xmath31 labelled from 1 ) to 8) .",
    "in particular , we have chosen at least one sample of each `` kind '' of ellipsoid : 1 ) standard , 2 ) almost spheric , 3 ) standard , 4 ) almost prolate , 5 ) almost oblate , 6 ) close to a segment , 7 ) close to a flat solid ellipse , and 8) close to a flat circle . the color palette is a classical one : cold colors represent low values , hot colors represent high values .",
    "the neighborhood of the inner edges is always a `` hot '' region ; that is , the jacobian is always big on that region . on the contrary",
    ", the jacobian tends to zero close to the hypotenuse of the @xmath526 region .",
    "this can be seen from a symmetry reasoning .",
    "furthermore , the jacobian never vanishes , not even in the cases  7 ) and  8) , which correspond to almost flat ellipsoids .",
    "we recall that if the two conjectures stated in subsection  [ ssec : twoconjectures ] hold , then the components of the frequency map are ordered as stated in  ( [ eq : frequencyorder ] ) .",
    "thus , the range of the frequency map should be a subset of the frequency space @xmath527 we visualize in figure  [ fig : borders ] how each edge of the caustic space is mapped onto the frequency space .",
    "all the depicted curves have been numerically computed from exact formulae given in theorem  [ thm:3d ] .",
    "we have represented the caustic space @xmath95 at the left side , and the frequency space @xmath528 at the right side .",
    "each colored segment in the caustic space is mapped onto the curve of the same color in the frequency space .",
    "the black segment in @xmath95 which represents the geodesic flow limit is mapped onto the origin @xmath529 .",
    "the point @xmath530 is mapped onto @xmath531 .",
    "the images of the magenta and blue segments are folded at this point @xmath532 . henceforth , @xmath533 $ ] stands for the segment with endpoints @xmath532 and @xmath534 , and @xmath535 $ ] stands for the interior of the triangle with vertexes @xmath532 , @xmath534 , @xmath536 .",
    "we see that @xmath537 is enclosed by the magenta segment @xmath538 $ ] , the blue segment @xmath539 $ ] , and a red smooth curve from @xmath540 to @xmath541 ; @xmath542 $ ] ; @xmath543 is enclosed by the magenta segment @xmath538 $ ] , the blue segment @xmath544 $ ] , and a cyan smooth curve from @xmath545 to @xmath541 ; and @xmath546 is enclosed by the magenta segment @xmath547 $ ] , the blue segment @xmath544 $ ] , a brown smooth curve from @xmath545 to @xmath548 , and a green smooth curve from @xmath548 to @xmath549 .",
    "_ on _ the edges of the caustic space for @xmath14 , @xmath550 , and @xmath551",
    ". left : caustic space .",
    "right : frequency space.,width=593 ]    the points @xmath532 , @xmath540 , @xmath545 , @xmath549 , and @xmath548 can be explicitly expressed in terms of the parameters of the ellipsoid @xmath4 .",
    "let @xmath552 be the quantities defined by @xmath553 where @xmath554 is the rotation number  ( [ eq : rotationnumber ] ) . from the formulae contained in theorem  [ thm:3d ] , we get that @xmath531 , @xmath555 , @xmath556 , @xmath557 , and @xmath558 .",
    "we note that @xmath559 , since @xmath560 .",
    "in fact , @xmath561 and @xmath562 , although we do not have a rigorous proof of the inequalities involving @xmath563 .",
    "the four quantities defined in  ( [ eq : varrho ] ) can be interpreted in terms of the restriction of the billiard dynamics to suitable planar sections of the original ellipsoid .",
    "for instance , @xmath563 is the rotation number of the trajectories contained in the section by the plane @xmath400 whose caustic is the focal ellipse  ( [ eq : focalellipse ] ) .",
    "we give now some numerical estimates on the size and the shape of the four ranges .",
    "[ num : ranges ] let @xmath552 be the quantities defined in  ( [ eq : varrho ] ) .",
    "let @xmath564 .",
    "let @xmath529 , @xmath531 , @xmath555 , @xmath556 , @xmath565 , @xmath557 , @xmath566 , @xmath567 , and @xmath558 .",
    "then :    1 .",
    "@xmath568 \\subsetneq   \\omega(e \\times h_j ) \\subsetneq   \\triangle[ab_jo]$ ] for @xmath569 ; 2 .   @xmath542 $ ] ; and 3 .",
    "@xmath570 \\subsetneq   \\omega(h_1 \\times h_2 ) \\subsetneq   \\omega(e \\times h_2 ) \\cap   \\ { ( \\omega_1,\\omega_2 ) \\in \\omega :      \\omega_1 > \\varrho_\\ast,\\ ; \\omega_2 > \\varrho_{{\\rm y}}\\}$ ] .    next , we enlighten some practical consequences of these estimates . to begin with ,",
    "let us present four simple criteria to decide if the ellipsoid has billiard trajectories of frequency @xmath571 and of caustic type eh1 , h1h1 , eh2 , or h1h2 . compare with the criterion for the existence of billiard trajectories inside an ellipse with rotation number @xmath352 and a caustic hyperbola given in  ( [ eq : bifurcations2d ] ) .",
    "[ pro : criterions ] if numerical result  [ num : ranges ] holds , then the following criteria can be applied .    1 .   if @xmath572 , then @xmath573 . if @xmath574 , then @xmath575 .",
    "2 .   @xmath576 if and only if @xmath572 .",
    "3 .   if @xmath577 , then @xmath578 . if @xmath579 , then @xmath580 .",
    "4 .   if @xmath572 and @xmath577 , then @xmath581 . if @xmath582 , or @xmath583 , or @xmath579 , then @xmath584 .",
    "hence , there exist billiard trajectories of the four caustic types when @xmath585 is big enough : @xmath572 and @xmath586 . on the contrary , there does not exist any of such trajectories when @xmath587 is small enough : @xmath588 and @xmath589 .",
    "the first and third criteria follow from @xmath568 \\subset   \\omega(e \\times h_j ) \\subset   \\triangle[ab_jo]$ ] , @xmath569 .",
    "the second one follows from the identity @xmath542 $ ] .",
    "the last one follows from the the last item of numerical result  [ num : ranges ] .",
    "we can also understand how the range of the frequency map depends on the shape of the ellipsoid .",
    "it suffices to see how the quantities @xmath590 , @xmath591 , @xmath592 , and @xmath563 depend on the parameters @xmath13 .",
    "on the one hand , if the ellipsoid flattens that is , if @xmath156 decreases , but @xmath366 and @xmath323 remain fixed , then @xmath563 decreases , so @xmath537 and @xmath593 expand .",
    "indeed , both ranges tend to cover the whole space @xmath528 for flat ellipsoids : @xmath594 , whereas they collapse to the empty set for prolate ellipsoids : @xmath595 . on the other hand ,",
    "if the ellipsoid becomes more oblate that is , if @xmath323 increases , but @xmath366 and @xmath156 remain fixed , then @xmath592 increases , so @xmath543 contracts .",
    "indeed , @xmath543 tends to cover @xmath528 for `` segments '' : @xmath596 , but collapses to the empty set for oblate ellipsoids : @xmath597 .",
    "the behavior of @xmath546 is more complicated , because its vertex @xmath598 can be at any point of the frequency space @xmath528 ; see  ( [ eq : varrho ] ) . anyway ,",
    "if the ellipsoid becomes spheric that is , @xmath156 and @xmath323 approach @xmath366 , then @xmath592 and @xmath563 tend to one half , so @xmath599 tends to @xmath532 and the four ranges collapse to the empty set .",
    "this means that _ the more spheric is an ellipsoid , the poorer are its four types of nonsingular billiard dynamics .",
    "_ some of the criteria stated in propositions  [ pro : criterions ] and  [ pro : criterions2 ] quantify this general principle .",
    "the ranges of the frequency map for eight different ellipsoids are shown in figure  [ fig : ranges ] . in the left upper picture",
    ", we have again marked the ellipsoids as points in the parameter space  ( [ eq : parameterspace ] ) .",
    "the image sets @xmath537 , @xmath593 , @xmath543 , and @xmath546 are depicted in yellow , green , magenta , and blue , respectively .",
    "the transparency allows to visualize simultaneously all four sets .",
    "we can check all their properties stated in numerical result  [ num : ranges ] , together with the ones regarding their dependence on the shape of the ellipsoids .",
    "blue dots correspond to rational frequencies with small common denominators .    in the previous paragraphs",
    "the range of the frequency map has been described by mixing analytic formulae and numerical computations , but some properties can be justified .",
    "the following proposition is an example .",
    "[ pro : local2global ] if conjecture  [ con : frequencylocal ] holds , then @xmath542 \\subsetneq \\omega(e \\times h_1)$ ] , and @xmath600 $ ] is a global diffeomorphism . besides , @xmath576 if and only if @xmath601 .",
    "finally , @xmath602 = \\omega$ ] and @xmath603 = \\emptyset$ ] .    if @xmath604 , then @xmath605 is the triangle with vertexes @xmath606 , @xmath607 , @xmath608 . using the formulae for the extended frequency map established in theorem  [ thm:3d ]",
    ", we get that @xmath609 ) = [ a b_1]$ ] , @xmath610 ) = [ b_1 c_1]$ ] , and @xmath611 ) = [ c_1 a]$ ] .",
    "thus , @xmath612 is the triangle with vertexes @xmath532 , @xmath540 , @xmath549 . in particular , @xmath613 and @xmath614 are jordan curves , so the frequency map @xmath615 verifies the hypotheses of lemma  [ lem : localglobal ] in  [ ap : topological ]",
    ". hence , @xmath616 $ ] and @xmath617 is a global diffeomorphism .    in order to prove the strict inclusion @xmath618\\subsetneq \\omega(e \\times h_1)$ ] , it suffices to see that the red curve from @xmath541 to @xmath540 in the right picture of figure  [ fig : borders ] is strictly below the yellow segment @xmath619 $ ] . and",
    "this is equivalent to prove the inequality @xmath620 due to the formulae for the extended frequency map contained in theorem  [ thm:3d ] .",
    "this inequality was proved in proposition  [ pro : increasing ] .",
    "finally , we note that @xmath621 and @xmath622 ; see the second item of proposition  [ pro:2d ] .",
    "let @xmath623 be the winding numbers of a periodic billiard trajectory of type eh1 .",
    "then @xmath21 is the period . besides , according to remark  [ rem : windingnumbers ] , @xmath22 and @xmath624 are the number of times along one period that the trajectory crosses the coordinate plane @xmath625 and the number of times along one period that it rotates around the coordinate axis @xmath626 , respectively .",
    "therefore , the components of the frequency map have the following geometric meaning : @xmath627 is the number of oscillations around @xmath400 per period , whereas @xmath628 is the number of rotations around @xmath629 per period .",
    "thus , it is quite natural to say that @xmath630 is the _ @xmath631-oscillation number _ and @xmath632 is the _ @xmath631-rotation number _ of the trajectory .    as in the planar case",
    ", these interpretations are extended to quasiperiodic trajectories .",
    "if @xmath633 , then @xmath91 is an ellipsoid , @xmath345 is a one - sheet hyperboloid , and @xmath634 where @xmath339 ( respectively , @xmath340 ) is the number of oscillations around @xmath400 ( respectively , number of rotations around @xmath629 ) of the first @xmath341 segments of _ any _ given trajectory with caustics @xmath91 and @xmath345 .",
    ".geometric meaning of the winding numbers and the frequency vector when @xmath499 .",
    "[ cols=\"^,^,^,^,^\",options=\"header \" , ]     the billiard trajectories of other types can be analyzed following similar arguments .",
    "the results are listed in table  [ tab : geometricmeaning ] and can be checked by visual inspection ; see figure  [ fig : periodictrajectories3d ] .",
    "finally , we stress a point already commented in remark  [ rem : factor_2 ] .",
    "if the trajectory is of type h1h1 that is , if both caustics are one - sheet hyperboloids , then the winding number @xmath22 is the number of ( alternate ) tangential touches with the caustics , so @xmath627 is half the number of oscillations between the one - sheet hyperboloids per period .",
    "in that situation , we call @xmath635 the _ h1-oscillation number _ of the trajectory . in particular , it can happen that @xmath636 .",
    "for instance , if the winding numbers are @xmath637 , @xmath638 , and @xmath639 , the period is four , but @xmath640 .",
    "we want to determine the ellipsoids that have billiard trajectories with a prescribed frequency and with a prescribed caustic type .",
    "we recall that each ellipsoid is represented by a point in @xmath641 , because @xmath14 .",
    "let @xmath642 , @xmath643 , @xmath644 , and @xmath645 be the four regions of @xmath31 that correspond to ellipsoids with billiard trajectories of frequency @xmath646 and caustic type eh1 , h1h1 , eh2 , and h1h2 , respectively .",
    "their shapes are described below .",
    "[ num : bifurcationsg ] once fixed any frequency vector @xmath571 , let @xmath647 , @xmath648 , @xmath649 , and @xmath650 .",
    "then @xmath651 for some continuous functions @xmath652 \\to { \\mathbb{r}}$ ] such that    1 .",
    "@xmath653 is concave increasing in @xmath38 $ ] , @xmath654 for all @xmath40 , and @xmath655 ; 2 .",
    "@xmath656 is concave increasing in @xmath38 $ ] , @xmath657 for all @xmath40 , and @xmath658 ; 3 .",
    "@xmath659 is the identity in @xmath660 $ ] , concave decreasing in @xmath661 $ ] , and @xmath662 ; and 4 .",
    "@xmath663 is increasing in @xmath664 $ ] , concave decreasing in @xmath665 $ ] , @xmath666 for all @xmath667 , @xmath668 for all @xmath669 , @xmath670 , and @xmath671 .",
    "numerical result  [ num : bifurcationsp ] follows from numerical result  [ num : bifurcationsg ] just by choosing suitable rational frequency vectors : @xmath672 in the cases eh1 and eh2 , @xmath673 in the case h1h1 , and @xmath674 in the case h1h2 .",
    "we stress that inequality @xmath675 in numerical result  [ num : bifurcationsp ] and inequality @xmath676 in numerical result  [ num : bifurcationsg ] are not contradictory , because the first one refers to two different frequency vectors : @xmath677 and @xmath678 .",
    "we have numerically checked that @xmath663 is not concave in @xmath664 $ ] .",
    "inclusions @xmath679 and @xmath680 and so , inequalities @xmath681 and @xmath682 are in direct agreement with inclusions @xmath683 and @xmath684 mentioned in numerical result  [ num : ranges ] .",
    ".,title=\"fig:\",width=528 ] .,title=\"fig:\",width=528 ]",
    "some bifurcations curves corresponding to the graphs of the functions @xmath685 \\to { \\mathbb{r}}$ ] are presented in figure  [ fig : bifurcations ] . on top of this figure we consider the eight rational frequencies with the smallest denominators .",
    "the inclusions @xmath679 and @xmath680 can be easily visualized , since all dashed curves are below their continuous pairs . on the bottom",
    ", we depict the bifurcation curves associated to the rational frequencies marked with blue dots in figure  [ fig : ranges ] .",
    "we have needed a multiple precision arithmetic to compute the bifurcation curves close to some of their endpoints , since the involved root - finding problems become quite singular at them .",
    "the programs have been written using the pari system  @xcite .",
    "next , we describe four more criteria to decide if an ellipsoid has billiard trajectories of a given frequency .",
    "they are similar to the four ones established in proposition  [ pro : criterions ] .",
    "[ pro : criterions2 ] if numerical result  [ num : bifurcationsg ] holds , then the following criteria can be applied .    1 .   if @xmath686 , then @xmath573 . if @xmath687 , then @xmath575 .",
    "2 .   if @xmath688 , then @xmath576 . if @xmath689 , then @xmath690 .",
    "3 .   if @xmath691 , then @xmath578 . if @xmath692 , then @xmath580 .",
    "4 .   if @xmath693 , then @xmath581 . if @xmath694 or @xmath695 , then @xmath584 .",
    "from numerical result  [ num : bifurcationsg ] , we get that @xmath696 \\subset p^0_j$ ] , where @xmath697 , @xmath698 , @xmath699 , @xmath700 , @xmath701 , @xmath702 , @xmath703 , and @xmath704 .",
    "it is straightforward to check that a point @xmath705 belongs to the triangles @xmath706 , @xmath707 , @xmath708 , and @xmath709 if and only if @xmath686 , @xmath688 , @xmath710 , and @xmath711 , respectively .",
    "this proves the first part of each criterion for @xmath14 . to prove the general case",
    ", it suffices to take into account that its formulae are homogeneous in the parameters @xmath712 .",
    "the second parts follow from similar arguments .",
    "for instance , @xmath713 for @xmath569 , since @xmath714 are increasing in @xmath38 $ ] and @xmath715 .",
    "proposition  [ pro : criterions ] has been obtained by fixing the ellipsoid and looking at the frequency space . on the contrary ,",
    "proposition  [ pro : criterions2 ] has been derived by fixing the frequency vector and looking at the parameter space .",
    "of course , both approaches are equivalent , but their criteria are slightly different .",
    "the second ones are computationally simpler , because they do not involve any elliptic integral .",
    "although the description of the regions @xmath716 has a strong numerical component , some results can be proved .",
    "the following proposition is an example .",
    "[ pro : bifurcationsh1h1 ] let @xmath571 be a fixed frequency vector .",
    "if conjecture  [ con : frequencylocal ] holds , then @xmath679 , @xmath643 only depends on @xmath585 , and @xmath717 for some increasing analytic function @xmath718 such that @xmath719 for all @xmath720 . besides , @xmath721 . finally , @xmath722",
    "if conjecture  [ con : frequencylocal ] holds , then @xmath723 ; see proposition  [ pro : local2global ] .",
    "therefore , @xmath679 , because @xmath724 on the other hand , since @xmath725 , @xmath726 and @xmath727 , we deduce that @xmath728 we know that the rotation function @xmath729 is increasing in @xmath730 , @xmath731 , and @xmath732 .",
    "hence , the function @xmath733 , @xmath734 , is implicitly defined by @xmath735 where @xmath736 and @xmath14 are fixed parameters .",
    "analyticity of @xmath656 follows from the implicit function theorem , since conjecture  [ con : frequencylocal ] also implies that @xmath737 for all @xmath738 .",
    "indeed , this derivative is positive in @xmath730 and negative in @xmath739 , because @xmath740 is increasing in @xmath730 and decreasing in @xmath739 .",
    "besides , we know that @xmath741 from the symmetry @xmath742 ; see  ( [ eq : rotationnumber ] ) .",
    "hence , by differentiating equation  ( [ eq : implicit ] ) with respect to @xmath323 and setting @xmath743 , we get that @xmath744 using proposition  [ pro:2d ] , we know that @xmath745 . thus , we deduce @xmath721 , since @xmath14 .    finally , we must find the values @xmath746 such that @xmath747 is equal to @xmath279 or @xmath278 .",
    "that is , we must find the values of @xmath748 such that the billiard trajectories inside the ellipse @xmath749 with caustic @xmath750 have period three or four .",
    "this is an old result that goes back to cayley  @xcite .",
    "for instance , @xmath751 in the four - periodic case .",
    "the value for the three - periodic case was given in equation  ( [ eq : minimalcaustics2d ] ) .",
    "the fact that @xmath643 only depends on @xmath585 can be visualized on top left in figure  [ fig : bifurcations ] .",
    "the two dashed curves with @xmath752 coincide , as well as the two ones with @xmath753 .",
    "_ close to _ the edges of the caustic space for @xmath14 , @xmath550 , and @xmath551 .",
    "( compare with figure  [ fig : borders].),width=593 ]    in figure  [ fig : approximatedborders ] we have superposed the edges and borders ( drawn in light colors ) already displayed in figure  [ fig : borders ] , and some new segments and curves ( drawn in heavy colors ) . in the caustic space ,",
    "these new segments are close to the original edges . to be precise ,",
    "the distance between them and the edges is equal to @xmath754 . nevertheless , the images of the black , magenta , and blue ones are far from their corresponding borders in the frequency space .",
    "this phenomenon seems stronger on the magenta and blue borders .",
    "it has to do with the fact that , as stated in theorem  [ thm:3d ] , the frequency map has an _ inverse logarithm _ singularity at the blue and magenta edges of the caustic space .",
    "therefore , one must be _ exponentially close _ to them , just to be close to their images .",
    "on the other hand , the frequency map has a _ squared root _",
    "singularity at the black edges of the caustic space .",
    "thus , one must be _ quadratically close _ to them , just to be close to the origin in the frequency space .",
    "we deduce from this phenomenon that _ billiard trajectories with some almost singular caustic are ubiquitous .",
    "_ let us describe a quantitative sample of this principle using figure  [ fig : approximatedborders ] .",
    "let @xmath755 be the triangle delimited by the yellow , blue and magenta thin segments that are close to the edges of @xmath393 .",
    "it turns out that the area of @xmath593 is approximately 16 times the area of @xmath756 .",
    "hence , if we look for billiard trajectories of type h1h1 inside @xmath4 with a random frequency in @xmath593 , their caustic parameter @xmath382 shall verify @xmath757 with a probability approximately equal to @xmath758 .",
    "it suffices to note that @xmath759 .",
    "we have numerically computed some symmetric periodic trajectories to check that the lower bounds stated in theorem  [ thm : lowerbounds3d ] are optimal ; see figure  [ fig : periodictrajectories3d ] .",
    "all these trajectories are almost singular .",
    "concretely , @xmath760 in the case eh2 ; @xmath761 in the case h1h2 ; @xmath762 and @xmath763 in the case eh1 ; and @xmath764 in the case h1h1 . of course , we did not look for almost singular trajectories , but we got them anyway .",
    "considering the values given in figure  [ fig : periodictrajectories3d ] , and bearing in mind table  [ tab : geometricmeaning ] , we have @xmath765 for the eh2 trajectory , so it performs two turns around the coordinate axis @xmath766 and crosses twice the coordinate plane @xmath398 . as well , @xmath765 for the eh1 trajectory , meaning four crossings with @xmath400 and just one turn around @xmath629 .",
    "again , we have @xmath765 for the h1h2 trajectory , meaning four crossings with @xmath399 and two crossings with @xmath398 . finally , @xmath767 for the h1h1 trajectory , which corresponds to three tangential touches with each of the caustics and a single turn around @xmath629 .",
    "each of those geometric interpretations has been verified on the corresponding trajectory .",
    "we describe briefly the high - dimensional version of some of the analytical results already shown in the spatial case .",
    "we denote again the nondegenerate ellipsoid as in  ( [ eq : q ] ) and the nonsingular caustic space as in  ( [ eq : nonsingularset ] ) .    by analogy with the spatial case , we consider three disjoint partitions : @xmath768 with regard to the first one , @xmath769 is the @xmath341-dimensional border of @xmath95 .",
    "that is , @xmath397 is the set of vertexes , @xmath396 is the set of edges , @xmath770 is the set of faces , and so on .",
    "the second one mimics the distinction among geodesic flow limits , simple regular collapses , and simple singular collapses already seen in the previous section .",
    "for instance , @xmath771 .",
    "the asymptotic behavior of the frequency map in each one of these three situations is expected to be dramatically different ; see the theorem below .",
    "the last partition labels the component of the caustic parameter that becomes singular : @xmath772 . besides ,",
    "given any caustic parameter @xmath140 we shall denote by @xmath773 the caustic parameter obtained from @xmath165 by substituting its @xmath774-th component with @xmath775 .",
    "finally , we introduce the @xmath70-dimensional set @xmath776 which turns out to be the nonsingular caustic space for the geodesic flow on the ellipsoid .",
    "we note that @xmath777 , @xmath778 , and @xmath779 with the notations used in the previous section for triaxial ellipsoids of @xmath8 .",
    "[ thm : nd ] the frequency map @xmath780 has the following properties .    1 .",
    "it is analytic in @xmath95 .",
    "it can be continuously extended to the border @xmath442 , the extended map being as follows : 1 .",
    "it vanishes at @xmath781 ; 2 .",
    "one of its components can be explicitly written as a function of the rest at @xmath782 ; 3 .",
    "its first component is equal to @xmath285 at @xmath783 ; 4 .",
    "its @xmath784-th component is equal to the @xmath785-th component at @xmath786 for @xmath787 ; and 5 .",
    "its `` free '' components are an @xmath70-dimensional frequency of the billiard inside the section of the original ellipsoid by a suitable coordinate hyperplane at @xmath788 .",
    "+ besides , the restriction of the continuous extended map to any of the @xmath341-dimensional connected components of @xmath769 , @xmath789 , is analytic .",
    "its asymptotic behavior at @xmath790 is : 1 .",
    "@xmath791 , as @xmath446 ; 2 .",
    "@xmath792 , as @xmath793 ; 3 .",
    "@xmath451 , as @xmath452 ; + for some analytic functions @xmath794 and @xmath795 .",
    "it follows from the same arguments and computations that in the spatial case .",
    "the arguments are not repeated .",
    "the computations with hyperelliptic integrals have been relegated to  [ ap : hyperellipticintegrals ] .",
    "we recall that , once fixed the parameters @xmath63 of the ellipsoid and the caustic parameters @xmath138 , we write the @xmath796 positive numbers @xmath797 in an ordered way : @xmath798 . then the frequency @xmath799 is defined in terms of some hyperelliptic integrals over the intervals @xmath145 .",
    "if two consecutive elements of @xmath800 collide , then @xmath799 is , a priori , not well - defined .",
    "thus , it is natural to ask : how does @xmath799 behave at these collisions ?    in the previous theorem we have solved this question at the set @xmath801 , which covers just the geodesic flow limit : @xmath485 , the @xmath2 simple regular collapses : @xmath802 for some @xmath784 , and the @xmath2 simple singular collapses : @xmath803 for some @xmath784 .",
    "but there are many more ( multiple ) collapses , from double ones to total ones .",
    "double collapses correspond to the set @xmath804 .",
    "total collapses have multiplicity @xmath2 , so they correspond to set of vertexes @xmath397 .",
    "we believe that it does not make sense to describe the asymptotic behavior of the frequency map at all of them , since the behavior in each case must be the expected one . in order to convince the reader of the validity of this claim , we end the paper with a couple of extreme cases .",
    "as a first example , let us consider the vertex @xmath805 .",
    "it represents the unique total singular collapse , because it is the unique common vertex of the @xmath88 open connected components of the caustic space : @xmath806 using that the point @xmath807 belongs to all the closures @xmath808 , from theorem  [ thm : nd ] we get that @xmath809 . which is the asymptotic behavior of @xmath3 at this vertex ? in  [ sap : totalsingularcollapse ] it is proved that @xmath810 this behavior is singular in the @xmath2 caustic coordinates , as expected .    on the contrary",
    ", the vertex @xmath811 represents the unique total regular collapse , so we predict a regular behavior in the @xmath2 caustic coordinates . in  [ sap : totalregularcollapse ] we show that @xmath812 , where the limit frequencies @xmath813 are defined as @xmath814 , and the asymptotic behavior is @xmath815 once more , the frequency map has the expected behavior .",
    "we studied periodic trajectories of billiards inside nondegenerate ellipsoids of @xmath10 .",
    "first , we trivially extended the definition of the frequency map @xmath3 to any dimension , we presented two conjectures about @xmath3 based on numerical computations , and we deduced from the second one some lower bounds on the periods .",
    "next , we proved that @xmath3 can be continuously extended to any singular value of the caustic parameters , although it is exponentially sharp at the `` inner '' singular caustic parameters .",
    "finally , we focused on ellipses and triaxial ellipsoids , where we found examples of trajectories whose periods coincide with the previous lower bounds .",
    "we also computed several bifurcation curves . despite these results ,",
    "many unsolved questions remain .",
    "we indicate just four .",
    "the most obvious challenge is to tackle any of the conjectures , although it does not look easy .",
    "we have already devoted some efforts without success .",
    "we believe that the proof of any of these conjectures requires either a deep use of algebraic geometry or to rewrite the frequency map as the gradient of a `` hamiltonian '' ; see  @xcite .    another interesting question is to describe completely the phase space of billiards inside ellipsoids in @xmath10 for @xmath11 .",
    "a rich hierarchy of invariant objects appears in these billiards : liouville maximal tori , low - dimensional tori , normally hyperbolic manifolds whose stable and unstable manifolds are doubled , et cetera .",
    "for instance , the stable and unstable invariant manifolds of the two - periodic hyperbolic trajectory corresponding to an oscillation along the major axis of the ellipsoid were fully described in  @xcite .",
    "third , we plan to give a complete classification of the symmetric periodic trajectories inside generic ellipsoids  @xcite . to present the problem , let us consider the symmetric periodic trajectories inside an ellipse displayed in figure  [ fig : periodictrajectories2d ] .",
    "on the one hand , the three - periodic trajectory drawn in a continuous red line has an impact point on ( and is symmetric with respect to ) the @xmath816-axis .",
    "on the other hand , the four - periodic trajectory drawn in a dashed green line has a couple of segments passing through ( and is symmetric with respect to ) the origin .",
    "it is immediate to realize that there do not exist neither a trajectory with a hyperbola as caustic like the first one , neither a trajectory with an ellipse as caustic like the second one .",
    "the problem consists of describing all possible kinds of symmetric periodic trajectories once fixed the type of the @xmath2 caustics for ellipsoids in @xmath10 .",
    "once these trajectories were well understood , we could study their persistence under small symmetric perturbations of the ellipsoid , and the break - up of the liouville tori on which they live .",
    "similar results have already been found in other billiard frameworks : homoclinic trajectories inside ellipsoids of @xmath10 with a unique major axis  @xcite , and periodic trajectories inside circumferences of the plane  @xcite .    finally , we look for simple formulae to express the caustic parameters @xmath138 that give rise to periodic trajectories of small periods in terms of the parameters @xmath63 of the ellipsoid . as a by - product of those formulae , one can find algebraic expressions for the functions @xmath817 that appear in numerical result  [ num : bifurcationsp ] .",
    "this is a work in progress  @xcite .",
    "p. s. casas was supported in part by mcyt - feder grant mtm2006 - 00478 ( spain ) .",
    "r. ramrez - ros was supported in part by micinn - feder grant mtm2009 - 06973 ( spain ) and cur - diue grant 2009sgr859 ( catalonia ) .",
    "useful conversations with jaume amors , lex haro , yuri fedorov , and carles sim are gratefully acknowledged .",
    "[ lem:0 ] let @xmath818)$ ] be a family of functions such that @xmath819 in the @xmath820-topology . then @xmath821    @xmath822 ) } \\int_\\alpha^\\beta ( ( s-\\alpha)(\\beta - s))^{-1/2 } \\rmd s = \\pi |f_\\epsilon - f_0|_{c^0([\\alpha,\\beta ] ) } = \\or(\\epsilon)$ ] .",
    "[ lem : r ] let @xmath823)$ ] with @xmath824 and @xmath825 .",
    "then @xmath826    using the mean value theorem for integrals , we get that there exists some @xmath827 $ ] such that the integral is equal to @xmath828 .",
    "[ lem : g ] let @xmath829)$ ] with @xmath830 .",
    "then @xmath831    @xmath832_{s=0}^{s=\\epsilon } + 2 \\int_0^\\epsilon ( \\epsilon - s)^{1/2}f'(s)\\rmd s = 2 f(0 ) \\epsilon^{1/2 } + \\or(\\epsilon^{3/2})$ ] .",
    "[ lem : s ] let @xmath833)$ ] .",
    "set @xmath834 , @xmath835 , @xmath836 , and @xmath837",
    ". then @xmath838 the first ( respectively , last ) two estimates also hold when @xmath111 has a singularity at @xmath839 ( respectively , at @xmath840 ) , provided @xmath841)$ ] .",
    "we split the first integral as @xmath842 , where @xmath843 is a constant , and @xmath844 by performing the change @xmath845 in the integral @xmath846 , we get that @xmath847_{x=0}^{x=\\sqrt{\\beta-\\alpha } }   = - f(\\alpha ) \\log",
    "\\epsilon + \\hat{\\eta } + \\or(\\epsilon),\\ ] ] where @xmath848 is another constant .",
    "thus , to get the first formula with constant @xmath849 it suffices to see that @xmath850 .",
    "once fixed some @xmath851 , we decompose the integral @xmath852 as the sum @xmath853 , where @xmath854 , @xmath855 , and @xmath856 first , we consider the interval @xmath857 $ ] .",
    "then @xmath858 and @xmath859 is positive in @xmath857 $ ] .",
    "set @xmath860 .",
    "using again the change @xmath845 , we see that @xmath861_{x=0}^{x=\\sqrt{\\delta } } = -\\frac{\\epsilon}{2 } \\log \\epsilon + \\or(\\epsilon ) = \\or(\\epsilon \\log \\epsilon).\\end{aligned}\\ ] ] concerning the other interval , we note that @xmath859 is positive and decreasing in @xmath862 $ ] .",
    "hence , @xmath863 , and so @xmath864 .",
    "this ends the proof of the first formula .",
    "we split the second integral as @xmath865 , where @xmath866 is the constant given in the statement of the lemma , and @xmath867 by performing the change @xmath868 in the integral @xmath869 , we get that @xmath870_{x=0}^{x=\\beta-\\alpha } = \\pi f(\\alpha ) \\epsilon^{-1/2 } + \\or(\\epsilon^{1/2}).\\ ] ] thus , to get the second formula it suffices to see that @xmath871 , which follows from similar computations than the ones above .",
    "the last formulae are obtained by performing the change of variables @xmath872 in the former ones .",
    "[ cor : s ] let @xmath823)$ ] with @xmath873 , and @xmath874 let @xmath875 and @xmath876 be two reals such that @xmath877 .",
    "let @xmath878 with @xmath879 and @xmath880 .",
    "then there exists a constant @xmath881 such that @xmath882 as @xmath883 and @xmath884 , so that @xmath885 .",
    "it follows by applying the first and third estimates of the previous lemma to the integrals @xmath886 and @xmath887 for some point @xmath888 , although before we must fix the lower limit of the first integral with the change @xmath889 , and the upper limit of the second integral with the change @xmath890 .",
    "[ lem : linearsystems ] let @xmath891 be a family of square linear systems defined for @xmath892 .    1 .",
    "if the limits @xmath893 and @xmath894 exist , and @xmath895 is nonsingular , then @xmath896 where @xmath897 is the unique solution of the nonsingular limit system @xmath898 .",
    "if , in addition , the matrix @xmath899 and the vector @xmath900 are differentiable at @xmath901 , then the solution @xmath902 also is differentiable at @xmath901 . to be more precise , if @xmath903 for some square matrix @xmath904 and some vector @xmath905 , then @xmath906 where @xmath897 and @xmath907 .",
    "both results follow directly from classical error bounds in numerical linear algebra .",
    "see , for instance ,  @xcite .",
    "let us write the rotation number as the quotient @xmath908 , where @xmath909 and @xmath910 .",
    "the study of the limit @xmath312 is easy . from lemma  [ lem : g ]",
    ", we get the estimate @xmath911 , as @xmath312 , whereas from lemma  [ lem:0 ] we get that @xmath912 by combining both estimates we get that @xmath913 , so @xmath914 .",
    "next , we consider @xmath429 . after some computations based on lemma  [",
    "lem : s ] , we get @xmath915 where @xmath916 , @xmath849 , @xmath917 , with @xmath918 , @xmath919 , and @xmath920 we have used the change @xmath921 in both integrals .",
    "let @xmath922 and @xmath923 .",
    "then we have the estimate @xmath924 as @xmath925 .",
    "thus , @xmath926 , where @xmath927 .",
    "this implies that @xmath928 .",
    "besides , estimate  ( [ eq : slog ] ) is the key to prove that the caustic parameter @xmath929 is exponentially close to @xmath323 .",
    "once fixed @xmath930 , let @xmath931 be the unique caustic parameter such that @xmath932 , @xmath933 , and @xmath934 . by finding @xmath935 in estimate  ( [ eq : slog ] ) , we get @xmath936 using that @xmath937 and @xmath938 , we check that @xmath939 , with @xmath940 as @xmath941 .",
    "the limit @xmath261 is completely analogous .",
    "we omit the computations .    with respect to the limit @xmath263 , we note that @xmath942 uniformly in the interval @xmath420 $ ] .",
    "hence , @xmath943 besides , from lemma  [ lem : r ] we get the estimate @xmath944 , as @xmath263 .",
    "therefore , @xmath315 , as @xmath263 , where the limit value @xmath945 is defined by @xmath946 .",
    "that is , @xmath306 .",
    "we associate a `` frequency '' @xmath947 to any vector @xmath948 such that @xmath949 in the following way .",
    "first , we consider :    * the polynomial @xmath950 $ ] , which is positive in the @xmath144 intervals of the form @xmath145 ; * the @xmath144 linear functionals @xmath951 =   \\int_{c_{2j}}^{c_{2j+1 } } ( t(s))^{-1/2}p(s ) \\rmd s$ ] ; * the @xmath144 column vectors @xmath952,\\mathcal{k}_j[s],\\ldots,\\mathcal{k}_j[s^{n-1}])^t   \\in { \\mathbb{r}}^n$ ] ; * the @xmath953 nonsingular matrix @xmath954 ; and * the linear functionals @xmath955 = \\mathcal{k}_0[p(s ) ] +   2 \\sum_{j=1}^n ( -1)^j \\omega_j \\mathcal{k}_j[p(s)]$ ] , for @xmath956 .",
    "the hypothesis @xmath957 is not essential to get a nonsingular matrix @xmath895 , but it suffices to assume the strict inequalities @xmath958 ; see  @xcite .",
    "there exists an unique @xmath956 such that @xmath959 = 0,\\qquad \\forall p(s ) \\in { \\mathbb{r}}_{n-1}[s],\\ ] ] or equivalently , such that @xmath960 , which is the matricial form of the linear system given in  ( [ eq : frequency ] ) .    by taking the basis @xmath961 of @xmath962 $ ]",
    ", we see that condition  ( [ eq : frequency2 ] ) is equivalent to the linear system @xmath963 .",
    "therefore , condition  ( [ eq : frequency2 ] ) is an equivalent characterization of the frequency . from now on",
    ", @xmath153 stands for the frequency computed through the previous steps .",
    "[ sap : geodesicflowlimit ]    let @xmath964 , @xmath965 , and @xmath966 .",
    "let @xmath967 be the @xmath953 nonsingular matrix associated to the vector @xmath968 .",
    "let @xmath969 be the unique solution of the linear system @xmath970 .",
    "then @xmath971    the proof is short .",
    "first , we note that @xmath972 uniformly in @xmath973 $ ] .",
    "thus , using lemma  [ lem:0 ] , we get that @xmath974 as @xmath485 . and using lemma  [ lem : g ] we see that @xmath975 as @xmath485",
    ". therefore , the linear systems @xmath970 and @xmath976 are @xmath977-close , being @xmath967 nonsingular , so  ( [ eq : glimit ] ) follows from the first item in lemma  [ lem : linearsystems ] .      set @xmath979 .",
    "let @xmath980 be the polynomial associated to @xmath981 .",
    "let @xmath982 and @xmath983 be the functionals associated to @xmath981 .",
    "let @xmath984 , where @xmath985 is the frequency associated to @xmath981 , and @xmath986 is determined by @xmath987 let @xmath988 . then @xmath989    in order to prove this claim , we first observe that characterization  ( [ eq : frequency2 ] ) is equivalent to the system of @xmath2 linear equations @xmath990 = 0 \\mbox { for $ i=0,\\ldots , n-2 $ } \\\\ \\mathcal{k}[1;\\omega ] = 0 \\end{array } \\right . , \\ ] ] because @xmath991 is a basis of @xmath962 $ ] .",
    "now , using lemmas  [ lem:0 ] and  [ lem : r ] , we deduce the estimates @xmath992 =   \\textstyle{\\int_{c_{2j}}^{c_{2j+1 } }   \\frac{(c^*-s ) s^i \\rmd s}{|c^*-s| \\sqrt{t^s(s ) } + \\or(\\epsilon ) } } = \\cases { \\mathcal{k}^r_j[s^i ] + \\or(\\epsilon )      & \\mbox{if $ j < l$ } , \\\\          \\or(\\epsilon )                             & \\mbox{if $ j = l$ } , \\\\",
    "-\\mathcal{k}^r_{j-1}[s^i ] + \\or(\\epsilon ) & \\mbox{if $ j > l$};}\\ ] ] and @xmath993 =   \\cases{\\pi\\left(-t^r(c^*)\\right)^{-1/2 } + \\or(\\epsilon ) & \\mbox{if $ j = l$ } , \\\\",
    "\\int_{c_{2j}}^{c_{2j+1 } } \\frac{\\rmd s}{|c^*-s|\\sqrt{t^r(s ) } }             + \\or(\\epsilon ) & \\mbox{otherwise}.}\\ ] ]    therefore , the linear system  ( [ eq : r1 ] ) is @xmath994-close to the nonsingular linear system @xmath995 = 0 \\mbox { for $ i=0,\\ldots , n-2 $ } \\\\ \\mbox{condition~(\\ref{eq : rcondition } ) } \\end{array } \\right . , \\ ] ] and the asymptotic formula  ( [ eq : rlimit ] ) follows from the first item in lemma  [ lem : linearsystems ] .      set @xmath996 .",
    "let @xmath997 be the polynomial associated to @xmath998 .",
    "let @xmath999 and @xmath1000 be the functionals associated to @xmath998 .",
    "let @xmath1001 , where @xmath1002 and @xmath1003 let @xmath1004 and @xmath1005 .",
    "then there exists @xmath1006 such that @xmath1007 to prove this claim , we set @xmath1008 . we know that characterization  ( [ eq : frequency2 ] ) is equivalent to the system of @xmath2 linear equations @xmath1009 = 0 \\\\ \\mathcal{k}[(c^*-s)s^i;\\omega ] = 0 \\mbox { for $ i=0,\\ldots , n-2 $ } \\end{array } \\right . , \\ ] ] because @xmath1010 is a basis of @xmath962 $ ] .",
    "now , using lemmas  [ lem:0 ] and  [ lem : s ] , we deduce the following asymptotic estimates . on the one hand , there exist some constants @xmath1011 such that @xmath1012 = \\delta d \\mathcal{k}_j[1 ] = \\cases{1 + \\zeta_j \\delta + \\or(\\epsilon )    & \\mbox{if $ j = l-1,l$ } , \\\\",
    "\\zeta_j \\delta + \\or(\\epsilon\\delta ) & \\mbox{otherwise}.}\\ ] ] on the other hand , @xmath992 =   \\textstyle{\\int_{c_{2j}}^{c_{2j+1 } }   \\frac{(c^*-s ) s^i \\rmd s}{|c^*-s| \\sqrt{t^s(s ) } + \\or(\\epsilon ) } } = \\cases { \\mathcal{k}^s_j[s^i ] + \\or(\\epsilon )       & \\mbox{if $ j < l-1 $ } , \\\\          \\textstyle{\\int_{c_{2l-2}}^{c^ * } \\frac{s^i \\rmd s}{\\sqrt{t^s(s ) } } }             + \\or(\\epsilon ) & \\mbox{if $ j = l-1",
    "$ } , \\\\         -\\textstyle{\\int_{c^*}^{c_{2l+1 } } \\frac{s^i \\rmd s}{\\sqrt{t^s(s ) } } }             + \\or(\\epsilon ) & \\mbox{if $ j = l$ } , \\\\",
    "-\\mathcal{k}^s_{j-1}[s^i ] + \\or(\\epsilon ) & \\mbox{if $ j > l$}.}\\ ] ] in particular , @xmath1013 - \\mathcal{k}_l [ ( c^*-s)s^i ] = \\int_{c_{2l-2}}^{c_{2l+1 } } \\frac{s^i \\rmd s}{\\sqrt{t^s(s ) } } + \\or(\\epsilon ) =   \\mathcal{k}^s_{l-1}[s^i ] + \\or(\\epsilon)$ ] .",
    "we assume now that @xmath1014 .",
    "the case @xmath1015 is studied later on . since @xmath1016 , the linear system  ( [ eq : s ] )",
    "is @xmath1017-close to the nonsingular linear system @xmath1018 = 2(-1)^l ( \\omega^s_l - \\omega^s_{l-1 } ) \\textstyle{\\int_{c^*}^{c_{2l+1 } } \\frac{s^i \\rmd s}{\\sqrt{t^s(s ) } } } \\mbox { for $ i=0,\\ldots , n-2 $ } \\end{array } \\right . , \\ ] ] which in its turn is equivalent to the linear system @xmath1019 = 0 \\mbox { for $ i=0,\\ldots , n-2 $ } \\end{array } \\right.\\ ] ] whose unique solution is @xmath1020 and @xmath1021 .    thus , the asymptotic formula @xmath1022 follows from the first item in lemma  [ lem : linearsystems ] .",
    "in fact , this result can be improved using the second item in lemma  [ lem : linearsystems ] .",
    "it suffices to note that the linear system  ( [ eq : s ] ) is not only @xmath1017-equivalent to  ( [ eq : s0 ] ) , but it is differentiable at @xmath1023 .",
    "hence , ( [ eq : slimit ] ) holds for some vector @xmath308 that could be explicitly computed in terms of the limit system and the constants @xmath1024 .",
    "if @xmath1015 , the linear system  ( [ eq : s ] ) is @xmath1017-equivalent to the nonsingular linear system @xmath1025 = 0 \\mbox { for $ i=0,\\ldots , n-2 $ } \\end{array } \\right . , \\ ] ] and the proof ends with just the same arguments that for @xmath1026 .",
    "we omit the details .",
    "let us study the case of @xmath2 simultaneous collapses , all of them regular .",
    "that is , once fixed a vector @xmath1028 such that @xmath1029 , we study the asymptotic behavior of the frequency @xmath153 when @xmath1027 for all @xmath978 .",
    "let @xmath1030 be the vector whose components verify that @xmath1031 and @xmath1032 .",
    "let @xmath1033 with @xmath1034 .",
    "then @xmath1035    let @xmath1036 .",
    "let @xmath1037 be the basis of @xmath962 $ ] univocally determined by the interpolating conditions @xmath1038 that is , @xmath1039 .",
    "using lemma  [ lem : r ] , we get the estimates @xmath1040 = \\int_0^{c_1 } \\left(\\frac{(-1)^{l-1 } \\sqrt{c^*_l - c_1}}{(c^*_l -s)\\sqrt{c_1-s } } + \\or(\\epsilon)\\right ) \\rmd s          = 2 ( -1)^{l-1 } { \\mathop{\\rm atan}\\nolimits}\\sqrt{\\frac{c_1}{c^*_l - c_1 } } + \\or(\\epsilon),\\ ] ] @xmath1041 = \\pi + \\or(\\epsilon)$ ] , and @xmath1042 = \\or(\\epsilon)$ ] for @xmath1043 .",
    "thus , the @xmath1044 linear system @xmath1045 = 0 \\mbox { for $ l=1,\\ldots , n$}\\ ] ] is @xmath994-close to the nonsingular decoupled linear system @xmath1046 whose unique solution is given by @xmath1047 , and so , by @xmath1032 .",
    "hence , the asymptotic formula  ( [ eq : omegatilde ] ) follows from the first item in lemma  [ lem : linearsystems ] .",
    "let @xmath1049 , @xmath1033 , and @xmath1050 , where @xmath1051 and @xmath1052 .",
    "then @xmath1053    by applying repeatedly the result on simple singular collapses , we see that @xmath1054 in fact , these repeated limits can be taken in any order .",
    "nevertheless , this result is weaker than estimate  ( [ eq : omegahat ] ) , so we need a formal proof of the estimate .",
    "we consider the constants @xmath1055 .",
    "let @xmath1037 be the basis of @xmath962 $ ] univocally determined by @xmath1056 now , using corollary  [ cor : s ] , we get that there exists some constants @xmath1057 such that @xmath1058 = \\delta_l \\mathcal{k}_j[p_l(s ) ] = \\cases{1 + \\zeta_{ll}\\delta_l + { \\mathop{\\rm o}\\nolimits}(\\delta ) & \\mbox{if $ j = l$ } ,",
    "\\\\         \\zeta_{jl}\\delta_l + { \\mathop{\\rm o}\\nolimits}(\\delta )      & \\mbox{otherwise},}\\ ] ] where @xmath234 and @xmath1059 .",
    "therefore , the @xmath1044 linear system @xmath1060 = 0 \\mbox { for $ l=1,\\ldots , n$}\\ ] ] is @xmath1017-close to the nonsingular linear system @xmath1061 whose unique solution is @xmath1062 .",
    "thus , the asymptotic formula  ( [ eq : omegahat ] ) follows from the first item in lemma  [ lem : linearsystems ] .    the vectorial estimate  ( [ eq : omegahat ] ) can be refined in several ways .",
    "for instance , one can get the componentwise estimates @xmath1063 and @xmath1064 for @xmath1065 .",
    "in particular , @xmath1066 .",
    "even more , there exists a @xmath1044 constant _ lower triangular _",
    "matrix @xmath904 such that @xmath1067 we omit the proof , since we do not need this result and the computations are cumbersome .",
    "the function @xmath1068 verifies that @xmath1069 , where the coefficients @xmath1070 were given by @xmath1071 with @xmath407 , @xmath1072 , and @xmath1073 . here , @xmath433 is the rotation function of the ellipse obtained by sectioning the ellipsoid @xmath4 with the coordinate plane @xmath1074 .",
    "the asymptotic properties of rotation functions of billiards inside ellipses were established in proposition  [ pro:2d ] .",
    "first , let us consider the case @xmath1075 .",
    "using lemmas  [ lem:0 ] and  [ lem : g ] we get :    * @xmath1076 , where @xmath1077 ; * @xmath1078 , where @xmath1079 ; * @xmath1080 , where @xmath1081 ; * @xmath1082 , where @xmath1083 can be found in proposition  [ pro:2d ] ; and * @xmath1084 .",
    "it is possible to check that @xmath1085 , but we do not need it .    next ,",
    "let us consider the case @xmath1086 .",
    "we begin by computing the integral @xmath1087 for any @xmath1088 .",
    "then it is immediate to check that @xmath1089 for any @xmath1090 .",
    "we also need the formula @xmath1091 , where @xmath1092 is one of the limits of the rotation number described in proposition  [ pro:2d ] . using these formulae , jointly with lemmas  [ lem:0 ] and  [ lem : r ]",
    ", we see that :    * @xmath1093 , where @xmath1094 ; * @xmath1095 , where @xmath1096 ; * @xmath1097 , where @xmath1098 ; * @xmath1099 ; and * @xmath1100",
    ".    the estimates in the limit @xmath1101 , which means @xmath426 , are :    * @xmath1102 , where @xmath1103 is a constant that can be exactly computed from lemma  [ lem : s ] ; * @xmath1104 , where @xmath1105 is a constant that can be exactly computed from lemma  [ lem : s ] ; * @xmath1106 ; * @xmath1107 , where @xmath1108 according to proposition  [ pro:2d ] ; and * @xmath1109 .",
    "after some tedious , but simple , computations , one gets that @xmath1110 .      the function @xmath1111 verifies that @xmath1112 where the coefficients @xmath1113 were given by @xmath1114 with @xmath408 . here , @xmath1115 is the rotation function of the ellipse obtained by sectioning the ellipsoid @xmath4 with the coordinate plane @xmath1116 .",
    "we begin with the limit @xmath1117 . using",
    "lemmas  [ lem:0 ] and  [ lem : s ] we see that :    * @xmath1118 , where @xmath1119 ; * @xmath1120 ; * @xmath1121 ; * @xmath1122 ; and * @xmath1123 , since @xmath1124 .    next ,",
    "let us consider the case @xmath1125 , which is similar to the limit @xmath1126 studied in the previous subsection , so we need the same simple integrals . using them , jointly with lemmas  [ lem:0 ] and  [ lem : r ]",
    ", we get :    * @xmath1127 , where @xmath1094 ; * @xmath1128 , where @xmath1129 ; * @xmath1130 , where @xmath1131 ; * @xmath1132 ; and * @xmath1133 .      the function @xmath1134 verifies that @xmath1135 where the coefficients @xmath1136 were given by @xmath1137 with @xmath409 , @xmath1072 , and @xmath1073 . here",
    ", @xmath1138 is the rotation function of the ellipse obtained by sectioning the ellipsoid @xmath4 with the coordinate plane @xmath1139 .",
    "first , let us consider the case @xmath1075 . using lemmas  [ lem:0 ] and  [ lem : g ] we see that :    * @xmath1076 , where @xmath1140 ; * @xmath1078 , where @xmath1141 ; * @xmath1080 , where @xmath1142 ; * @xmath1143 , where the constant @xmath1144 can be found in proposition  [ pro:2d ] ; and * @xmath1145 , with @xmath1085 .",
    "the estimates in the limit @xmath1101 , which means @xmath426 , are :    * @xmath1146 ; see lemma  [ lem : s ] ; * @xmath1147 ; * @xmath1148 ; * @xmath1149 , since @xmath1150 is analytic at @xmath1151 ; and * @xmath1152 .    next , we consider the case @xmath1086 . using lemmas  [ lem:0 ] and  [ lem : r ] we get :    * @xmath1153 ; * @xmath1154 , where @xmath1155 ; * @xmath1156 , where @xmath1157 ; * @xmath1158 ; and * @xmath1159 .",
    "we recall that the complement of any jordan curve @xmath613 in the plane @xmath9 has two distinct connected components .",
    "one of them is bounded and simply connected ( the interior , denoted by @xmath1160 ) and the other is unbounded ( the exterior , denoted by @xmath1161 ) .",
    "[ lem : localglobal ] let @xmath613 and @xmath614 be two jordan curves of @xmath9 . if @xmath1162 is a bounded local homeomorphism that has a continuous extension to the boundary @xmath613 such that @xmath1163 , then @xmath1164 is a global homeomorphism .",
    "we note that @xmath1165 is a non - empty open bounded subset of @xmath9 such that @xmath1166 next , we are going to prove that @xmath1167 . using that @xmath1168",
    ", we deduce that the intersection @xmath1169 ( respectively , @xmath1170 ) is open and closed in @xmath1171 ( respectively , in @xmath1172 ) , so it is either the empty set or the whole interior ( respectively , exterior ) .",
    "therefore , we deduce that : 1 ) @xmath1173 , because @xmath1174 is bounded ; 2 ) @xmath1175 , because @xmath1174 is open ; and 3 ) @xmath1176 , because @xmath1174 is open and non - empty . that is , @xmath1177 .",
    "once we know that @xmath1178 is a surjective local homeomorphism , we deduce from covering space theory that it is a global homeomorphism .",
    "it suffices to realize that @xmath1160 is connected and open , and @xmath1171 is simply connected .    in particular , if @xmath1179 is smooth or analytic , then its inverse is also smooth or analytic .",
    "this means that if @xmath111 is a local diffeomorphism whose image is bounded and that has a continuous extension to the boundary @xmath613 such that @xmath1163 , then @xmath1164 is a global diffeomorphism ."
  ],
  "abstract_text": [
    "<S> the billiard motion inside an ellipsoid @xmath0 is completely integrable . </S>",
    "<S> its phase space is a symplectic manifold of dimension @xmath1 , which is mostly foliated with liouville tori of dimension @xmath2 . </S>",
    "<S> the motion on each liouville torus becomes just a parallel translation with some frequency @xmath3 that varies with the torus . besides , any billiard trajectory inside @xmath4 is tangent to @xmath2 caustics @xmath5 , so the caustic parameters @xmath6 are integrals of the billiard map . </S>",
    "<S> the frequency map @xmath7 is a key tool to understand the structure of periodic billiard trajectories . in principle , it is well - defined only for nonsingular values of the caustic parameters .    </S>",
    "<S> we present two conjectures , fully supported by numerical experiments . </S>",
    "<S> we obtain , from one of the conjectures , some lower bounds on the periods . </S>",
    "<S> these bounds only depend on the type of the @xmath2 caustics . </S>",
    "<S> we describe the geometric meaning , domain , and range of @xmath3 . </S>",
    "<S> the map @xmath3 can be continuously extended to singular values of the caustic parameters , although it becomes `` exponentially sharp '' at some of them .    </S>",
    "<S> finally , we study triaxial ellipsoids of @xmath8 . </S>",
    "<S> we compute numerically the bifurcation curves in the parameter space on which the liouville tori with a fixed frequency disappear . </S>",
    "<S> we determine which ellipsoids have more periodic trajectories . </S>",
    "<S> we check that the previous lower bounds on the periods are optimal , by displaying periodic trajectories with periods four , five , and six whose caustics have the right types . </S>",
    "<S> we also give some new insights for ellipses of @xmath9 .    </S>",
    "<S> _ keywords _ : billiards , integrability , frequency map , periodic orbits , bifurcations </S>"
  ]
}