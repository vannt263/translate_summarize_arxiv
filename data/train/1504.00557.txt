{
  "article_text": [
    "usnich  @xcite and blanc  @xcite proved that the group of birational automorphisms of @xmath2 that preserve the volume form @xmath1 is generated by @xmath2 , @xmath3 , and the birational map : @xmath4 in this paper we prove a generalisation of this result valid in all dimensions .",
    "our theorem generalises the theorem of usnich and blanc in the same way that the sarkisov program  @xcite , @xcite generalises the theorem of noether and castelnuovo stating that @xmath5 is generated by @xmath6 and a standard quadratic transformation @xmath7    our main result is the following :    [ thm:1 ] a volume preserving birational map between mori fibred calabi ",
    "yau pairs is a composition of volume preserving sarkisov links .    in the rest of the introduction",
    ", we introduce the terminology needed to make sense of the statement and , along the way , we state the more general factorisation theorem  [ thm:2 ] for volume preserving birational maps of general calabi  yau pairs .",
    "theorem  [ thm:2 ] is used in the proof of the main result and is of independent interest .",
    "we conclude with some additional remarks .",
    "[ dfn:1 ]    1 .",
    "a _ calabi  yau ( cy ) pair _ is a pair @xmath8 of a normal variety @xmath9 and a reduced @xmath10-weil divisor @xmath11 such that @xmath12 is a cartier divisor linearly equivalent to @xmath13 .",
    "we say that a pair @xmath14 has _",
    "( t ,  dlt ) _ , resp .  _",
    "( t ,  lc ) _ singularities or that it `` is '' ( t ,  dlt ) , resp .",
    "( t ,  lc ) if @xmath9 has terminal singularities and the pair @xmath14 has dlt , resp .  lc singularities .",
    "+ similarly @xmath14 has _",
    "( c ,  dlt ) _ , resp .  _",
    "( c ,  lc ) _ singularities or `` is '' ( c ,  dlt ) , resp .",
    "( c ,  lc ) if @xmath9 has canonical singularities and the pair @xmath14 has dlt , resp .",
    "lc singularities .",
    "we say that a pair @xmath8 is _",
    "@xmath15-factorial _ if @xmath9 is @xmath15-factorial .",
    "[ rem:1 ]    1 .",
    "we use the following observation throughout : if @xmath14 is a cy pair , then , because @xmath16 is an integral cartier divisor , for all geometric valuations @xmath17 , @xmath18 .",
    "if in addition @xmath14 is lc or dlt , then @xmath19 implies @xmath20 or @xmath13 .",
    "if @xmath14 is a dlt cy pair , then automatically it is ( c ,  dlt ) .",
    "more precisely if @xmath17 is a geometric valuation with small centre on @xmath9 and if the centre @xmath21 , then @xmath22 .",
    "+ indeed , consider a valuation @xmath17 with small centre on @xmath9 .",
    "then @xmath23 therefore @xmath24 implies @xmath25 and then , because @xmath16 is a cartier divisor , _ either _ @xmath26 , which is impossible because by definition of dlt , see remark  [ rem : nklt ] below , @xmath27 is smooth , _ or _ @xmath28 and @xmath29 .",
    "[ dfn:2 ] let @xmath30 and @xmath31 be cy pairs .",
    "a birational map @xmath32 is _ volume preserving _ if there exists a common log resolution @xmath33_p\\ar[dr]^q & \\\\ x \\ar@{-->}[rr]^\\varphi & & y } \\ ] ] such that @xmath34 .",
    "it is essential to the definition that we are requiring equality here not linear equivalence .",
    "[ rem:7 ] if @xmath30 is a cy pair then there is a ( unique up to multiplication by a nonzero constant ) rational differential @xmath35 ( where @xmath36 ) such that @xmath37 .",
    "similarly there is a distinguished rational differential @xmath38 on @xmath39 . to say that @xmath40 is volume preserving is to say @xmath41 ( up to multiplication by a nonzero constant ) under the identification @xmath42 given by @xmath40",
    "equivalently , @xmath40 is volume preserving if for all geometric valuations @xmath17 , @xmath43 .",
    "it follows that the notion is independent of the choice of common log resolution .",
    "volume preserving maps are called crepant birational in @xcite .",
    "[ rem:2 ] the composition of two volume preserving maps is volume preserving .",
    "the first step in the proof of theorem  [ thm:1 ] is the following general factorisation theorem for volume preserving birational maps between lc cy pairs , which is of independent interest .",
    "see  ( * ? ? ?",
    "* lemma  12(4 ) ) for a similar statement .",
    "[ thm:2 ] let @xmath8 and @xmath44 be lc cy pairs and @xmath45 a volume preserving birational map .",
    "then there are @xmath15-factorial ( t ,  dlt ) cy pairs @xmath46 , @xmath47 and a commutative diagram of birational maps : @xmath48_g\\ar@{-->}[r]^\\chi & y^\\prime\\ar[d]^{g^\\prime}\\\\ x \\ar@{-->}[r]^{\\varphi } &   x^\\prime } \\ ] ] where :    1 .",
    "the morphisms @xmath49 , @xmath50 are volume preserving ; 2 .",
    "@xmath51 is a volume preserving isomorphism in codimension @xmath52 which is a composition of volume preserving mori flips , flops and inverse flips ( not necessarily in that order ) .",
    "[ dfn:3 ] a _ mori fibred ( mf ) cy pair _ is a @xmath15-factorial ( t ,  lc ) cy pair @xmath14 together with a mori fibration @xmath53 .",
    "recall that this means that @xmath54 , @xmath55 is @xmath56-ample , and @xmath57 .    [",
    "[ sec : terminology-1 ] ] terminology + + + + + + + + + + +    we use the following terminology throughout .",
    "* a _ mori divisorial contraction _ is an extremal divisorial contraction @xmath58 from a @xmath15-factorial terminal variety @xmath59 of an extremal ray @xmath60 with @xmath61 .",
    "in particular @xmath9 also has @xmath15-factorial terminal singularities .",
    "+ if @xmath62 and @xmath30 are ( t ,  lc ) cy pairs , then it makes sense to say that @xmath56 is volume preserving . in this context",
    ", this is equivalent to saying that @xmath63 and , in particular , @xmath64 . *",
    "a birational map @xmath65 is a _ mori flip _ if @xmath59 has @xmath15-factorial terminal singularities and @xmath66 is the flip of an extremal ray @xmath60 with @xmath61 .",
    "note that this implies that @xmath67 has @xmath15-factorial terminal singularities .",
    "+ an _ inverse mori flip _ is the inverse of a mori flip . +",
    "a birational map @xmath65 is a _ mori flop _",
    "if @xmath59 and @xmath67 have @xmath15-factorial terminal singularities and @xmath66 is the flop of an extremal ray @xmath60 with @xmath68 .",
    "+ again if @xmath69 and @xmath70 are ( t ,  lc ) cy pairs , it makes sense to say that @xmath66 is volume preserving .",
    "one can see that this just means that @xmath71 .",
    "[ dfn:4 ] let @xmath8 and @xmath44 be mf cy pairs with mori fibrations @xmath72 and @xmath73 .",
    "a _ volume preserving sarkisov link _ is a volume preserving birational map @xmath74 that is a sarkisov link in the sense of @xcite .",
    "thus @xmath40 is of one of the following types :    a.   a _ link of type i _ is a commutative diagram : @xmath75\\ar@{-->}[r ] & x^\\prime\\ar[d ] \\\\",
    "x\\ar[d ] &   & \\ar[lld]s^\\prime \\\\ s & &    } \\ ] ] where @xmath76 is a mori divisorial contraction and @xmath77 a sequence of mori flips , flops and inverse flips ; b.   a _ link of type ii _ is a commutative diagram : @xmath75\\ar@{-->}[r ] & z^\\prime\\ar[dr ] & \\\\ x\\ar[d ] &   & & x^\\prime \\ar[d]\\\\ s\\ar@{=}[rrr ] & & & s^\\prime } \\ ] ] where @xmath76 and @xmath78 are mori divisorial contractions and @xmath79 a sequence of mori flips , flops and inverse flips ; c.   a _ link of type iii _ is the inverse of a link of type i ; d.   a _ link of type iv _ is a commutative diagram : @xmath80\\ar@{-->}[rr ] & & x^\\prime\\ar[d]\\\\ s\\ar[dr ] & & s^\\prime\\ar[dl]\\\\ & t & &   } \\ ] ] where @xmath81 is a sequence of mori flips , flops and inverse flips .    [ rem:6 ] it follows from the definition of sarkisov link that all the divisorial contractions , flips , etc .",
    "that constitute it are volume preserving ; in particular , all varieties in sight are naturally and automatically ( t ,  lc ) cy pairs .    in order to appreciate the statement of our main theorem  [ thm:1 ] , it is important to be aware that , although all mf cy pairs are only required to have lc singularities _ as pairs _ , we insist that all varieties in sight have @xmath15-factorial _ terminal _ singularities .",
    "our factorisation theorem is at the same time a limiting case of the sarkisov program for pairs @xcite and a sarkisov program for varieties @xcite , @xcite .",
    "the sarkisov program for pairs usually spoils the singularities of the underlying varieties , while the sarkisov program for varieties does not preserve singularities of pairs .",
    "the proof our main result is a balancing act between singularities of pairs and of varieties .",
    "we expect that it will be possible in some cases to classify all volume preserving sarkisov links and hence give useful presentations of groups of volume preserving birational maps of interesting mf cy pairs .",
    "we plan to return to these questions in the near future .",
    "the paper is structured as follows . in section  [ sec : mmp ] we develop some general results on cy pairs and volume preserving maps between them and prove theorem  [ thm:2 ] ; in section  [ sec : proof ] we prove theorem  [ thm:1 ] .",
    "we thank paolo cascini , jnos kollr and vladimir lazi for useful comments on a preliminary version .",
    "[ dfn:5 ] let @xmath8 be a lc cy pair , and @xmath82 a birational morphism .",
    "the _ log transform _ of @xmath83 is the divisor @xmath84 where the sum is over all prime divisors @xmath85 .",
    "lemma  [ lem:3 ] is a refinement of  ( * ? ? ?",
    "* theorem 17.10 ) and  ( * ? ? ? * theorem  4.1 ) . in order to state it",
    "we need a definition .",
    "[ dfn:10 ] let @xmath9 be a normal variety .",
    "a _ geometric valuation _ with centre on @xmath9 is a valuation of the function field @xmath86 of the form @xmath87 where @xmath88 is a divisor on a normal variety @xmath39 with a birational morphism @xmath89 .",
    "the _ centre _ of @xmath17 on @xmath9 , denoted @xmath90 , is the generic point of @xmath91 .",
    "let @xmath14 be a lc pair .",
    "the _ nonklt set _ is the set @xmath92 where @xmath17 is a geometric valuation of the function field of @xmath9 with centre the scheme theoretic point @xmath93 .",
    "our notion of nonklt set departs from common usage .",
    "most authors work with the _ nonklt locus_the zariski closure of our nonklt set  which they denote @xmath94 ( in lower case letters ) .    [",
    "rem : nklt ] we use the following statement throughout . it is part of the definition of dlt pairs ( * ? ? ?",
    "* definition  2.37 ) that if @xmath14 is dlt where @xmath95 with @xmath96 a prime divisor , then @xmath97 is the set of generic points of the @xmath98 and @xmath9 is nonsingular at all these points .",
    "[ lem:3 ] let @xmath14 be a lc cy pair where @xmath9 is not necessarily proper , @xmath82 a log resolution , and @xmath99 .",
    "the mmp for @xmath100 over @xmath9 with scaling of a divisor ample over @xmath9 exists and terminates at a minimal model @xmath31 over @xmath9 .",
    "more precisely , this mmp consists of a sequence of steps : @xmath101 where @xmath102 is the divisorial contraction or flip of an extremal ray @xmath103 with @xmath104 , and we denote by @xmath105 the structure morphism and by @xmath106 the end result",
    ". then :    1 .   for all @xmath107 ,",
    "denote by @xmath108 the induced map . for all @xmath107 ,",
    "there are zariski open neighbourhoods : @xmath109 such that @xmath110 is an isomorphism ; 2 .",
    "@xmath111 and @xmath112 ( that is , @xmath113 is a dlt crepant blow - up ) ; 3 .",
    "@xmath31 is a ( t , dlt ) cy pair . in particular , @xmath39 has terminal singularities ; 4 .   the map @xmath114 contracts precisely the prime divisors @xmath85 with @xmath115 .",
    "in other words , a @xmath56-exceptional divisor @xmath85 is not contracted by the map @xmath114 if and only if @xmath116 or @xmath117 .",
    "the mmp exists by  ( * ? ? ?",
    "* theorem  4.1 ) . in the rest of the proof we use the following well - known fact : if @xmath17 is a geometric valuation with centre on @xmath118 , then for all @xmath107 @xmath119 and the inequality is an equality if and only if @xmath120 is an isomorphism in a neighbourhood of @xmath121 . in particular",
    ", this implies at once that @xmath122 and the two sets are equal if and only if there exist zariski open subsets as in ( 1 ) , if and only if for all @xmath17 with @xmath123 @xmath124 is an isomorphism in a neighbourhood of @xmath125 .",
    "now write @xmath126 with @xmath127 , @xmath56-exceptional , with no components in common with @xmath128 .",
    "we are running a @xmath129-mmp , hence if @xmath130 denotes the image of @xmath129 , then the exceptional set of the map @xmath131 is contained in @xmath132 , see  @xcite . from this",
    "it follows that @xmath133 is an isomorphism from @xmath134 to its image in @xmath135 . at the start",
    ", @xmath128 has no components in common with @xmath129 and @xmath136 is a snc divisor : thus , if @xmath137 , then @xmath138 .",
    "it follows that @xmath139 .",
    "together with what we said , this implies ( 1 ) .    as for ( 2 ) , it is obvious that for all @xmath107 @xmath140 . by the negativity lemma ( * ? ? ?",
    "* lemma  3.39 ) @xmath141 implies @xmath142 not nef , so the mmp ends at @xmath143 when @xmath144 , that is , @xmath112 .    for ( 3 )",
    "we need to show that @xmath39 has terminal singularities .",
    "suppose that @xmath17 is a valuation with small centre @xmath145 on @xmath39 . by what we said in remark",
    "[ rem:1 ] , either @xmath146 , or : @xmath147 and we show that this second possibility leads to a contradiction .",
    "write @xmath148 .",
    "note that @xmath149 is never a divisor for this would imply that @xmath150 . by what we said at the start of the proof , for all @xmath107 , @xmath151 with strict inequality if and only if @xmath131 is not an isomorphism in a neighbourhood of @xmath149 .",
    "there must be a point where strict inequality occurs otherwise @xmath152 and @xmath153 is not terminal in a neibourhood of @xmath154 .",
    "this , however , implies that @xmath155 , that is , @xmath156 and then by ( 1 ) @xmath157 is an isomorphism in a neighbourhood of @xmath154 , again a contradiction .",
    "the last statement ( 4 ) is obvious .",
    "[ exa : dflop ] this example should help appreciate the statement of theorem  [ thm:2 ] and the subtleties of its proof .",
    "let @xmath158 and @xmath118 the total space of the vector bundle @xmath159 .",
    "let @xmath160 be a smooth surface such that @xmath161 is a ruling in @xmath17 and a @xmath162-curve in @xmath128 .",
    "let @xmath163 be the contraction of @xmath17 along the first ruling and @xmath164 the contraction along the second ruling .",
    "then @xmath165 and @xmath166 are both dlt , @xmath167 is terminal , @xmath39 is canonical but not terminal , and the map @xmath168 is volume preserving .    let @xmath169_f\\ar[dr]^{f ' } & \\\\ x\\ar@{-->}[rr]^\\varphi &    & x^\\prime}\\ ] ] be a common log resolution",
    ". since @xmath170 is volume preserving , then for all geometric valuations @xmath17 @xmath171 and : @xmath172 where @xmath173 and @xmath174    let @xmath175 and @xmath176 be the end products of the @xmath177-mmp over @xmath9 and @xmath178 as in lemma  [ lem:3 ] , and denote by @xmath179 the induced map . by lemma  [ lem:3](4 )",
    "@xmath180 is an isomorphism in codimension one .",
    "denote by @xmath181 and @xmath182 the obvious maps and write @xmath183 ; by lemma  [ lem:3](1 ) @xmath184 and @xmath185 are isomorphisms onto their images @xmath186 and @xmath187 .",
    "it follows from this that @xmath188 maps @xmath189 isomorphically to @xmath190 .    in the rest of the proof",
    "if @xmath191 is a divisor on @xmath39 we denote by @xmath192 its transform on @xmath167 and conversely : because @xmath180 is an isomorphism in codimension one it is clear what the notation means .",
    "let us choose , as we can by what we just said above , an ample @xmath15-divisor @xmath193 on @xmath167 general enough that both @xmath194 and @xmath195 are dlt .",
    "let @xmath196 be small enough that @xmath197 is ample .",
    "note that , again by what we said above , writing @xmath198 , both pairs @xmath199 and @xmath200 are klt .",
    "since @xmath201 is ample , @xmath202 is the log canonical model of @xmath203 .",
    "it follows that @xmath180 is the composition of finitely many  ( * ? ? ?",
    "* corollary  1.4.2 ) flips @xmath204 of the mmp for @xmath205 .",
    "if @xmath191 is a divisor on @xmath39 , denote by @xmath206 its transform on @xmath207 . for all @xmath107",
    ", @xmath208 is a @xmath209-flip and , at the same time , a @xmath210-flop , and hence all pairs @xmath211 are lc .",
    "we next argue that all @xmath211 are in fact ( t , dlt ) .    because the mmp is a mmp for @xmath212 , the exceptional set of @xmath208",
    "is contained in @xmath213 .",
    "from this it follows that , writing @xmath214 , @xmath215 is an isomorphism onto its image , which we denote by @xmath216 and , by induction on @xmath107 , @xmath217 is an isomorphism onto its image , which we denote by @xmath218 .",
    "we show by induction that , for all @xmath107 , @xmath219 is a zariski neighbourhood of @xmath220 , so that @xmath208 is a local isomorphism at the generic point of each @xmath221 and @xmath222 is a dlt pair . indeed assuming the statement for @xmath223 consider @xmath224 .",
    "let @xmath17 be a valuation with discrepancy @xmath225 , then also @xmath226 , thus @xmath227 and then by what we just said @xmath228 is an isomorphism at @xmath229 , hence @xmath230 .",
    "this shows that all @xmath211 are dlt .",
    "finally we prove that for all @xmath107 @xmath207 is terminal .",
    "assume for a contradiction that @xmath231 is not terminal . by remark  [ rem:1](2 )",
    "@xmath231 is canonical and there is a geometric valuation @xmath17 with @xmath232 , and then also @xmath233 . since @xmath39 is terminal , @xmath234 , and @xmath235 , and @xmath236 , but then @xmath237 , so that we must have that @xmath238 , that is @xmath239 and this is a contradiction .",
    "we fix the following situation , which we keep in force throughout this section : @xmath240_g \\ar@{-->}[rr]^\\chi & & y^\\prime \\ar[d]^{g^\\prime } &   \\\\ x\\ar[d]_p\\ar@{-->}[rr]^\\varphi & & x^\\prime\\ar[d]^{p^\\prime}\\\\ s & & s^\\prime}\\ ] ]    a.   @xmath39 and @xmath167 have @xmath15-factorial terminal singularities and @xmath241 and @xmath242 are birational morphisms .",
    "b.   @xmath179 is the composition of mori flips , flops and inverse flips . c.   @xmath243 and @xmath244 are mfs .",
    "the goal of this section is to prove theorem  [ thm:3 ] below . in the final short section  [ sec : mainthm ]",
    "we show that theorem  [ thm:2 ] and theorem  [ thm:3 ] imply theorem  [ thm:1 ] .",
    "the proof of theorem  [ thm:3 ] is a variation on the proof of @xcite .",
    "[ dfn:6 ] a birational map @xmath245 is _ contracting _ if @xmath246 contracts no divisors .",
    "[ rem:8 ] if a birational map @xmath245 is contracting , then it makes sense to pullback @xmath15-cartier ( @xmath247-cartier ) divisors from @xmath39 to @xmath9 .",
    "choose a normal variety @xmath118 and a factorisation : @xmath33_p \\ar[dr]^q & \\\\ x\\ar@{-->}[rr]^f & & y}\\ ] ] with @xmath248 and @xmath249 proper birational morphisms . if @xmath83 is a @xmath15-cartier ( @xmath247-cartier ) @xmath15-divisor ( @xmath247-divisor ) on @xmath39 the pullback @xmath250 is defined as : @xmath251 ( this is easily seen to be independent of the factorisation ) .",
    "[ thm:3 ] the birational map @xmath252 is a composition of links @xmath253 of the sarkisov program where all the maps @xmath254 are contracting .",
    "we say that the link @xmath253 is _ under @xmath39 _ if the maps @xmath254 and @xmath255 are contracting .        [ dfn:9 ] let @xmath245 be a a contracting birational map .",
    "let @xmath256 be an @xmath247-divisor .",
    "we say that @xmath56 is _ @xmath256-nonpositive _ ( _ @xmath256-negative _ ) if @xmath257 is @xmath247-cartier and @xmath258 where all @xmath259 ( all @xmath260 ) .",
    "note the special case @xmath261 in the definition just given .",
    "[ dfn:8 ] let @xmath262 be a normal variety , proper over @xmath59 , and @xmath83 an @xmath247-divisor on @xmath9 .    1 .",
    "a _ semiample model _ of @xmath83 is a @xmath83-nonpositive contracting birational map @xmath263 to a normal variety @xmath264 proper over @xmath59 such that @xmath265 is semiample over @xmath59 ; 2 .",
    "an _ ample model _ of @xmath83 is a rational map @xmath266 to a normal variety @xmath267 projective over @xmath59 together with an ample @xmath247-cartier divisor @xmath268 , such that there is a factorisation @xmath269 : @xmath270 where @xmath245 is a semiample model of @xmath83 , @xmath271 is a morphism , and @xmath272 .",
    "let @xmath262 be a normal variety proper over @xmath59 and @xmath83 an @xmath247-divisor on @xmath9 .    1 .",
    "suppose that @xmath267 is normal , @xmath268 an ample @xmath247-divisor on @xmath118 , and @xmath273 an ample model of @xmath83 .",
    "if @xmath245 is a semiample model of @xmath83 , then the induced rational map @xmath274 is a morphism and @xmath275 .",
    "all ample models of @xmath83 are isomorphic over @xmath59 .",
    "we refer to@xcite for basic terminology on divisorial rings .",
    "[ thm : decomposition ] ( * ? ? ?",
    "* theorem  4.2 ) let @xmath9 be a projective @xmath15-factorial variety , and @xmath276 a rational polyhedral cone containing a big divisor contains a big divisor so we can say : if @xmath277 is pseudo effective then @xmath83 is effective . ]",
    "such that the ring @xmath278 is finitely generated .",
    "then there exists a finite rational polyhedral fan @xmath279 and a decomposition : @xmath280 such that :    1 .   for all @xmath281 there exists a normal projective variety @xmath282 and a rational map @xmath283 such that for all @xmath284 , @xmath285 is the ample model of @xmath83 . if @xmath286 contains a big divisor , then for all @xmath287",
    ", @xmath285 is a semiample model of @xmath83 .",
    "2 .   for all @xmath288 there exists a morphism @xmath289 such that the diagram @xmath290^{{\\varphi}_\\sigma } \\ar@{-->}[dr]_{{\\varphi}_\\tau } & \\quad & x_\\sigma    \\ar[dl]^{{\\varphi}_{\\sigma \\tau}}\\\\ \\quad & x_\\tau & \\quad } \\ ] ] commutes .",
    "[ rem:4 ]    1",
    ".   under the assumptions of theorem  [ thm : decomposition ] , if a cone @xmath281 intersects the interior of @xmath291 , then it consists of big divisors ( this is because the big cone is the interior of the pseudo - effective cone ) .",
    "this holds in particular if @xmath286 is of maximal dimension .",
    "2 .   theorem  [ thm : decomposition](2 ) follows immediately from part  ( 1 ) and remark  [ rem:5](1 ) .",
    "[ dfn:7 ] let @xmath9 be a projective @xmath15-factorial variety , and @xmath292 a rational polyhedral cone containing a big divisor such that the ring @xmath278 is finitely generated .",
    "we say that @xmath293 is _ generic _ if :    1 .   for all @xmath281 of maximal dimension , ] @xmath282",
    "is @xmath15-factorial .",
    "2 .   for all @xmath281 ,",
    "not necessarily of maximal dimension , and all @xmath294 of codimension one , the morphism @xmath295 has relative picard rank @xmath296 .",
    "if @xmath297 is a @xmath247-vector space and @xmath298 , then we denote by @xmath299 the convex cone in @xmath297 spanned by the @xmath300 .",
    "[ lem:2 ] let @xmath9 be a projective @xmath15-factorial variety , and @xmath292 a generic rational polyhedral cone containing a big divisor .",
    "let @xmath301 such that the cone @xmath302 contains a big divisor , and let @xmath303 .",
    "there exist @xmath304 with @xmath305 such that the cone @xmath306 is generic .",
    "make sure that all cones @xmath307 , @xmath308 , intersect all cones @xmath281 properly .",
    "[ pro:1 ] let @xmath9 be a projective @xmath15-factorial variety , @xmath309 big @xmath15-divisors on @xmath9 such that all pairs @xmath310 are klt , and let @xmath311    then @xmath312 is finitely generated , and if @xmath313 spans @xmath314 as a vector space then @xmath293 is generic .    for the proof see for example (",
    "* theorem  4.5 ) .",
    "note that the assumptions readily imply that @xmath313 contains big divisors .",
    "the finite generation of @xmath315 is of course the big theorem of @xcite .",
    "[ setup:1 ] in what follows we work with a pair @xmath316 where @xmath9 is @xmath15-factorial and :    a.   @xmath317 is a @xmath15-linear combination of irreducible mobile - divisor @xmath318 is mobile if for some integer @xmath319 such that @xmath320 is integral , the linear system @xmath321 has no fixed ( divisorial ) part . ] divisors ; b.   @xmath322 is terminal ; c.   @xmath323 is not pseudoeffective .",
    "assumption  ( i ) implies that when running the mmp for @xmath324 no component of @xmath317 is ever contracted , so that @xmath322 remains terminal throughout the mmp .",
    "assumption  ( iii ) means that the mmp terminates with a mf .",
    "[ cor:1 ] let @xmath9 be a projective @xmath15-factorial variety , @xmath317 as in setup  [ setup:1 ] , @xmath325 big @xmath15-divisors on @xmath9 such that all pairs @xmath326 are klt .",
    "then for all @xmath327 there are ample @xmath15-divisors @xmath328 with @xmath329 such that @xmath330 is generic .",
    "add enough ample divisors to span @xmath331 and then use lemma  [ lem:2 ] to perturb @xmath332 inside a bigger cone .",
    "since @xmath333 , then @xmath334 , and hence there is no need to perturb @xmath317 .",
    "suppose that @xmath268 is a big @xmath15-divisor on @xmath9 such that    a.   the pair @xmath336 is klt ; b.   @xmath337 is ample on @xmath9 ; c.   the cone @xmath338 is generic .    then , the decomposition of @xmath339 given by theorem  [ thm : decomposition ] corresponds to running a mmp for @xmath324 with scaling by @xmath268 .",
    "this mmp exist by ( * ? ? ?",
    "* corollary  1.4.2 ) . in more detail , let @xmath340 be rational numbers such that @xmath341 and the maximal cones of the decomposition correspond to the intervals @xmath342 . for all @xmath343",
    "@xmath344 is ample on @xmath345 .",
    "then @xmath346 is a minimal model program for @xmath324 with scaling by @xmath268 , that is :    1 .",
    "@xmath347 where @xmath348 denotes the push forward of @xmath268 , and @xmath349 is the divisorial contraction or flip of an extremal ray @xmath350 with @xmath351 and 2 .",
    "@xmath352 is @xmath15-linearly equivalent to an effective divisor . ] and @xmath353 is a mf .",
    "moreover : 3 .",
    "genericity means that at each step there is a unique extremal ray @xmath350 with @xmath354 and @xmath355 .",
    "the following follows immediately from genericity .",
    "if @xmath356 is small enough then for all ample @xmath15-divisors @xmath357 with @xmath358 , @xmath359 is ample on @xmath9 , the cone @xmath360 is still generic , and the mmp for @xmath324 with scaling by @xmath361 is identical to the mmp for @xmath324 with scaling by @xmath268 , in the sense that the sequence of steps and end product are identical .      in this subsection",
    "we prove the following special case of theorem  [ thm:3 ] :    [ lem:6 ] suppose that @xmath363 is as in setup  [ setup:1 ] , and that @xmath268 , @xmath364 are big @xmath15-divisors on @xmath39 such that :    a.   @xmath365 and @xmath366 are klt ; b.   @xmath367 and @xmath368 are both ample on @xmath39 ; c.   the cones @xmath369 and @xmath370 are generic ; d.   the mmp for @xmath371 with scaling by @xmath268 , resp .",
    "@xmath364 , ends in a mf @xmath372 , resp .",
    "@xmath373 .",
    "then the birational map @xmath252 is a composition of links @xmath253 of the sarkisov program where each map @xmath254 is contracting .",
    "the proof is the argument of @xcite , which we sketch here for the reader s convenience .",
    "after a small perturbation of @xmath268 and @xmath364 as in corollary  [ cor:1 ] that , as stated in   [",
    "sec : special - case:-2](4 ) , does not change the two mmps or their end products , the cone @xmath374 is generic .",
    "the argument of @xcite then shows how walking along the boundary of @xmath375 corresponds to a chain of sarkisov links from @xmath372 to @xmath373 . by construction ,",
    "all maps from @xmath39 are contracting .",
    "write @xmath376 where each @xmath377 is a mori flip , flop or inverse flip , and @xmath378 , @xmath379 .    for all @xmath15-divisors",
    "@xmath380 on @xmath39 denote by @xmath381 the strict transform on @xmath207 .",
    "choose @xmath380 such that for all @xmath382 :    a.   @xmath381 satisfies the setup  [ setup:1 ] , and b.   @xmath208 is either a @xmath383-flip or antiflip .",
    "is to make sure that there are no flops . ]",
    "one way to choose @xmath380 is as follows : if @xmath208 is a flop , choose @xmath381 ample , general , and very small on @xmath207 . if @xmath381 is small enough then for all @xmath384",
    "if @xmath385 was a flip or antiflip then it still is a flip or antiflip . on the other hand now @xmath208 is a @xmath383-flip .",
    "some other flops may have become flips or antilfips .",
    "if there are still flops repeat the process by adding , on @xmath386 such that @xmath228 is a @xmath387-flop , a very small ample divisor to @xmath388 , and so on until there are no flops left .    for all @xmath389 ,",
    "we choose by induction on @xmath107 a big divisor @xmath348 on @xmath207 is not the transform of @xmath348 on @xmath231 : it is just another divisor .",
    "] such that @xmath390 is ample , @xmath391 is generic , and the mmp for @xmath392 with scaling by @xmath348 terminates with a mf @xmath393 . at the start @xmath394 , but it will not necessarily be the case that @xmath395 .",
    "we prove , also by induction on @xmath107 , that for all @xmath107 the induced map @xmath396 is the composition of sarkisov links under @xmath39 .",
    "finally we prove that the induced map @xmath397 is the composition of sarkisov links under @xmath39 .",
    "suppose that for all @xmath398 @xmath399 has been constructed .",
    "we consider two cases :    a.   if @xmath400 is a @xmath401-flip , choose an ample @xmath15-divisor @xmath402 on @xmath403 such that @xmath404 is generic and the mmp for @xmath405 with scaling by @xmath402 begins with the flip @xmath400 .",
    "this can be accomplished as follows : if @xmath400 is the flip of the extremal contraction @xmath406 then @xmath407 where @xmath408 is ample on @xmath403 and @xmath409 is ample enough on @xmath410 .",
    "now set @xmath411 where @xmath412 is @xmath413-trivial and @xmath196 .",
    "note that @xmath414 generic implies @xmath415 generic .",
    "is ample hence ( moving in linear equivalence class ) @xmath416 is klt  in fact even terminal if we want .",
    "so since @xmath417 then even more @xmath418 is klt .",
    "] we take @xmath419 to be the end product of the mmp for @xmath392 with scaling by @xmath348 .",
    "it follows from lemma  [ lem:6 ] , applied to @xmath403 and the divisors @xmath420 , @xmath402 , that the induced map @xmath421 is a composition of sarkisov links under @xmath403 and hence , since @xmath422 is an isomorphism in codimension one , under @xmath39 .",
    "b.   if @xmath400 is a @xmath401-antiflip , choose @xmath348 ample on @xmath207 such that @xmath423 is generic and the mmp for @xmath392 with scaling by @xmath348 begins with the flip @xmath424 .",
    "we take @xmath419 to be the end product of the mmp for @xmath392 with scaling by @xmath348 .",
    "it follows from lemma  [ lem:6 ] , applied to @xmath403 and the divisors @xmath420 , @xmath425 where @xmath426 is @xmath424-trivial and @xmath196 , that the induced map @xmath427 is a composition of sarkisov links under @xmath403 and hence , since @xmath422 is an isomorphism in codimension one , under @xmath39 .",
    "finally , choose @xmath364 ample on @xmath167 such that @xmath428 is generic and the mmp for @xmath429 with scaling by @xmath364 terminates with the mf @xmath430 .",
    "it follows from lemma  [ lem:6 ] , applied to @xmath431 ( and the divisors @xmath432 , @xmath364 ) , that the induced map @xmath433 is a composition of sarkisov links under @xmath167 and hence , since @xmath168 is an isomorphism in codimension one , under @xmath39 .",
    "let @xmath14 and @xmath44 with @xmath243 and @xmath430 be ( t , lc ) mf cy pairs , and let @xmath434 be a volume preserving birational map .",
    "theorem  [ thm:2 ] gives a diagram : @xmath435_g\\ar@{-->}[r]^\\chi & ( y^\\prime , d_{y^\\prime})\\ar[d]^{g^\\prime}\\\\ ( x , d ) \\ar@{-->}[r]^{\\varphi } &   ( x^\\prime , d^\\prime ) } \\ ] ] where @xmath46 , @xmath436 are ( t , dlt ) @xmath15-factorial cy pairs , @xmath113 , @xmath437 are volume preserving and @xmath180 is a volume preserving composition of mori flips , flops and inverse flips .",
    "in particular , if we forget the @xmath83s , we are in the situation of   [ sec : basic - setup ] , so that by theorem  [ thm:3 ] @xmath438 is the composition of sarkisov links @xmath439 such that all induced maps @xmath440 are contracting . denoting by @xmath441 ,",
    "it is clear that for all @xmath107 @xmath442 is volume preserving hence also @xmath443 is volume preserving , and @xmath444 is a ( t , lc ) cy pair ."
  ],
  "abstract_text": [
    "<S> we prove a version of the sarkisov program for volume preserving birational maps of mori fibred calabi  yau pairs valid in all dimensions . </S>",
    "<S> our theorem generalises the theorem of usnich and blanc on factorisations of birational maps of @xmath0 that preserve the volume form @xmath1 . </S>"
  ]
}