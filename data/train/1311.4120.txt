{
  "article_text": [
    "nonlocal ( long - range ) interactions are encountered in modeling a variety of problems from quantum physics and chemistry to materials science and biology . a typical example is the coulomb interaction in the nonlinear schrdinger equation ( or schrdinger - poisson system in three dimensions ( 3d ) ) as a `` mean field limit '' for @xmath10-electrons , assuming binary coulomb interactions @xcite and the kohn - sham equation of density functional theory ( dft ) for electronic structure calculations in materials simulation and design @xcite .",
    "dipole - dipole interactions arise in quantum chemistry @xcite , in dipolar bose - einstein condensation ( bec ) @xcite , in dipolar fermi gases @xcite , and in dipole - dipole interacting rydberg molecules @xcite .    in physical space ,",
    "the interaction kernel is both long - range and singular at the origin , requiring both accurate quadrature techniques and suitable fast algorithms . when the density function is smooth , however , it is often more convenient to use fourier methods since the frequency content is well - controlled .",
    "unfortunately , the fourier transform of the interaction kernel is singular at the origin of fourier ( phase ) space as well , resulting in significant numerical burdens and challenges @xcite .    in this paper , we present a fast and accurate algorithm for the numerical evaluation of the interaction potential @xcite : @xmath11 and its related interaction energy @xcite @xmath12 where @xmath0 is a nonlocal ( long - range ) interaction kernel and @xmath1 is a density function derived from a complex - valued wave function @xmath2 . here , @xmath13 is a dimensionless interaction constant , and @xmath14 denotes the convolution operator . in most applications ,",
    "the density function @xmath15 is smooth and very rapidly decaying @xcite , so that it can be viewed as having compact support to a prescribed precision @xmath16 .",
    "we focus our attention on the following coulomb and dipole - dipole interactions :    1 .   _ coulomb interactions in 3d @xcite . _",
    "the interaction kernel and its fourier transform are given by the formulas @xmath17 in certain settings , the density is limited to two dimensions and one seeks the coulomb potential in that plane alone .",
    "this arises in various problems of surface physics @xcite , and the governing potential is obtained in two dimensions by dimension reduction from three dimensions under an anisotropic potential .",
    "this is well - known to yield : @xmath18 the superscript @xmath19 is intended to denote that the sources line in a two - dimensional space but that the physical interaction is that of the ambient three - dimensional space . here",
    "@xmath20 is the fourier transform of a function @xmath21 defined by the formula @xmath22 for @xmath23 .",
    "2 .   _ dipole - dipole interactions with the same dipole orientation in 3d @xcite . _",
    "the interaction kernel is given by the formula @xmath24 and its fourier transform is @xcite : @xmath25 where @xmath26 is a fixed unit vector representing the dipole orientation , @xmath27 is the dirac distribution function , @xmath28 and @xmath29 . as in the coulmob case , when the source distribution is two - dimensional , one reduction from three - dimensions under an anisotropic potential @xcite yields : @xmath30 and its fourier transform is @xcite @xmath31}{2\\|{\\mathbf{k}}\\| } , \\qquad { \\mathbf{k}}\\in { \\mathbb{r}}^2,\\ ] ] where @xmath32 , @xmath33 , @xmath34 , @xmath35 , @xmath36 , and @xmath37 is a fixed real constant @xcite .",
    "3 .   _ dipole - dipole interactions with different dipole orientations in 3d @xcite . _",
    "the interaction kernel is @xmath38 and its fourier transform is @xcite @xmath39 where @xmath26 and @xmath40 are two fixed unit vectors representing the two dipole orientations , @xmath41 and @xmath42 .",
    "for a two dimensional distribution , dimension reduction from 3d under an anisotropic potential @xcite yields : @xmath43 and its fourier transform is @xcite @xmath44}{2\\|{\\mathbf{k}}\\| } , \\qquad { \\mathbf{k}}\\in { \\mathbb{r}}^2,\\ ] ] where @xmath45 , @xmath46 , @xmath47 and @xmath37 is a fixed real constant @xcite .",
    "note that the second category above is a special case of the third .",
    "it is listed separately because it is simpler and has some important physical applications .",
    "various numerical methods have been proposed in the literature for evaluating the interaction potential ( [ gpe ] ) and interaction energy ( [ gpe2 ] ) using a uniform grid on a bounded computational domain so as to compute the ground states and dynamics of problems in quantum physics and chemistry . by making direct use of the standard uniform fft @xcite , a phenomoenon",
    "know as  numerical locking \" occurs , limiting the achievable precision @xcite .",
    "this is due , in essence , to the fact that @xmath48 and @xmath49 are unbounded at the origin .    as a result",
    ", there has been some interest in reformulating the problem of convolution with the 3d coulomb kernel ( [ cou3d ] ) in terms of the governing partial differential equation ( the poisson equation ) @xmath50 and convolution with the reduced 2.5d coulomb kernel ( [ cou2d ] ) in terms of the fractional partial differential equation @xmath51 the dipole - dipole interaction in 3d ( [ dipkernel ] ) can be computed from the relation @xcite @xmath52    there is a substantial literature on solving the the pdes ( [ gpe3d ] ) and ( [ gpe2d ] ) , which we do not seek to review here .",
    "we refer the interested reader to @xcite and the references therein .",
    "we would , however , like to point out that when the density function @xmath15 has complicated local structure , an adaptive grid is needed for resolution . in that setting",
    ", fourier methods are highly inefficient and the fast multipole method ( fmm ) or some variant @xcite can be used for evaluating the nonlocal interaction directly in physical space in @xmath53 time , where @xmath10 is the number of grid points . in many applications , however , such as the computation of the ground state and dynamics of bec @xcite , one needs to evaluate @xmath54 on an equispaced grid in physical space many times for different @xmath7 .",
    "this occurs , for example , in time - splitting spectral methods for computing the dynamics of the nonlinear schrdinger / gross - pitaevskii equations @xcite . in such cases",
    ", fourier methods can be very efficient , easy to implement , and high order accurate , so long as care is taken in discrettization .",
    "we begin by noting that in fourier space and the discussion above , the coulomb or dipole - dipole interaction potential is given by @xmath55 where @xmath3 is given by one of the formulae @xmath56}{2\\|{\\mathbf{k}}\\| } , & \\text{2.5d dipole - dipole interactions . }",
    "\\end{aligned}\\right.\\ ] ]    the remainder of this paper is aimed at the construction of a fast and accurate algorithm for the evaluation of long - range interactions of the form as well as the total interaction energy .",
    "there are three essential ingredients .",
    "first , we truncate the integrals in at a frequency beyond which the contribution to @xmath15 is negligible .",
    "this is valid because of our assumption that @xmath15 is smooth .",
    "second , we rewrite using spherical or polar coordinates in 3d or 2d , respectively .",
    "the jacobian of this change of variables cancels the singularity at the origin in fourier space , permitting the use of simple high order quadrature rules .",
    "more precisely , we achieve superalgebraic convergence by using the trapezoidal rule in the azimuthal direction and gauss - legendre quadrature in the radial and inclination directions .",
    "third , we utilize the nonuniform fast fourier transform ( nufft ) ( see , for example , @xcite ) to accelerate the calculation of the sums which arise from discretization , which do not correspond to uniform tensor product grids .",
    "the resulting algorithm is high - order accurate and requires only @xmath9 work , where @xmath10 is the total number of discretization points in physical space .",
    "the paper is organized as follows . in section 2",
    ", we present a brief review of nufft and in section 3 , we describe the numerical algorithm in detail .",
    "the performance of the method is illustrated with several numerical examples in section 4 .",
    "section 5 contains some concluding remarks .",
    "in this section , we summarize the basic steps of the nufft , to make the discussion reasonably self - contained .    the ordinary fft computes the discrete fourier transform ( dft ) and its inverse : @xmath57 in @xmath9 operations by exploiting the algebraic structure of the dft matrix .",
    "the points @xmath58 and the frequencies @xmath59 , however must be equispaced in both the physical and fourier domains ( see , for example , @xcite ) .    the purpose of the nufft is to remove this restriction , while maintaining a computational complexity of @xmath9 , where @xmath10 denotes the total number of points in both the physical and fourier domains .",
    "dutt and rokhlin were the first to construct an algorithm of this type , with full control of precision @xcite , although heuristic versions had been used earlier .",
    "there are , by now , many variants of the nufft ( see , for example , @xcite ) .",
    "all of these algorithms rely on interpolation coupled with a judicious use of the fft on an oversampled grid . here",
    ", we will follow the discussion in the paper @xcite , which describes a simple framework for the nufft using gaussian kernels for interpolation .",
    "the type-1 nufft evaluates sums of the form @xmath60 for  targets \" @xmath61 on a regular grid in @xmath62 , given function values @xmath63 prescribed at arbitrary locations @xmath64 in the dual space .",
    "here , @xmath10 denotes the total number of source points .",
    "the type-2 nufft evaluates sums of the form @xmath65 where the  targets \" @xmath64 are irregularly located points in @xmath62 , given the function values @xmath66 on a regular grid in the dual space .",
    "( the type-3 nufft permits the sampling to be irregular in both domains , and will not be needed in the present paper . )",
    "we now briefly explain the basic idea underlying the nufft @xcite . for simplicity ,",
    "let us consider the one dimensional type-1 nufft : @xmath67 note , now , that describes the exact fourier coefficients of the function @xmath68 viewed as a periodic function on @xmath69 $ ] . here",
    "@xmath70 denotes the dirac function .",
    "it is clearly not well - resolved by a uniform mesh in @xmath71 . by convolving with a heat kernel , however , we will construct a smooth function which can be sampled .",
    "for this , we let @xmath72 denote the 1d periodic heat kernel on @xmath69 $ ] . if we define @xmath73 to be convolution of @xmath74 with @xmath75 : @xmath76 then @xmath77 is a @xmath78-periodic @xmath79 function and is well - resolved by a uniform mesh in @xmath71 whose spacing is determined by @xmath80 .",
    "thus , its fourier coefficients @xmath81 can be computed with high accuracy using the standard fft on a sufficiently fine grid .",
    "that is , @xmath82 where @xmath83 once the value @xmath84 are known , an elementary calculation shows that @xmath85 this is a direct consequence of the convolution theorem and the fact that the fourier transform of @xmath75 is @xmath86",
    ".    optimal selection of the parameters in the algorithm requires a bit of analysis , which we omit here .",
    "we simply note @xcite that if @xmath87 and @xmath88 , and one uses a gaussian to spread each source to the nearest @xmath89 grid points , then the nufft yields about @xmath90 digits of accuracy . with @xmath91 and gaussian",
    "spreading of each source to the nearest @xmath90 grid points , the nufft yields about @xmath92 digits of accuracy .",
    "the type-2 nufft is computed by essentially reversing the steps of type-1 nufft .",
    "we turn now to a detailed description of our numerical algorithms for evaluating the nonlocal ( long - range ) interactions ( [ gpe ] ) and the related interaction energy ( [ gpe2 ] ) .",
    "since we have assumed that the function @xmath15 is smooth and rapidly decaying , we treat it as compactly supported with some prescribed precision @xmath16 in the rectangular box @xmath93\\times\\cdots\\times[-r_d/2,r_d/2]$ ] .",
    "its fourier transform @xmath94 is @xmath95 where @xmath96 , @xmath97 .",
    "let us now be more specific about our smoothness assumption .",
    "we let @xmath98 , so that @xmath99 as @xmath100 .",
    "a straightforward calculation shows that to achieve a tolerance of @xmath16 , then evaluation of ( [ gpe ] ) needs to be done only for @xmath101 , where @xmath102 .",
    "we will refer to @xmath103 as the high - frequency cutoff .",
    "this fixes the range of integration in @xmath5-space and bounds the oscillatory behavior of the term @xmath104 in the integrand of .",
    "together with the fact that @xmath7 is smooth , it follows that the tensor product trapezoidal rule applied to with @xmath105 points along the @xmath106th axis will yield @xmath107 accuracy , where @xmath108 .",
    "the error will decay rapidly once each of the @xmath105 is of the order @xmath109 , so that the integrand is well resolved . if @xmath7 is given on a uniform mesh with @xmath105 points in the @xmath106th dimension , the trapezoidal rule yields @xmath110 where @xmath111 .    to compute the desired solution in physical space , we need to evaluate the inverse fourier transform defined by ( [ ifft ] ) for each of the kernels in ( [ int3dd ] ) . as discussed above",
    ", we can truncate the domain of integration in the fourier domain at @xmath112 , with an error @xmath16 .",
    "thus , the main issue is the design of a high order rule for finite fourier integrals of the form : @xmath113    the principal difficulty is that the integrand above is singular at the origin using cartesian coordinates in @xmath5-space .",
    "it is , however , perfectly smooth in spherical coordinates or polar coordinates , respectively . indeed , using the usual change of variables in , we obtain @xmath114 it is easy to see that the integrand is smooth in both integrals in since the factor @xmath115 ( @xmath116 ) cancels the singularity in @xmath117 by inspection of . @xmath118 , of course , is smooth since it is a band - limited function .    the integrals in can be discretized with high order accuracy by using standard ( shifted and scaled ) gauss - legendre quadrature in the radial direction ( and the longitudinal @xmath119 direction in 3d ) , combined with the trapezoidal rule for the azimuthal @xmath120 variable .",
    "thus , we have @xmath121      it is clear that @xmath122 can be evaluated from at the desired nonequispaced points @xmath123 using the type-2 nufft .",
    "the summations defined in can then be evaluated using the type-1 nufft since the desired output points @xmath61 lie on a uniform grid in physical space .",
    "_ given the dimension @xmath124 , the box size parameters @xmath125 , @xmath126 and the number of equispaced points @xmath105 in each direction , compute @xmath54 defined in on a uniform grid in @xmath127 $ ] .",
    "_    compute the coordinates on the uniform grid in @xmath128 , that is , @xmath129 , @xmath130 , @xmath126 . evaluate the function @xmath131 at these uniform grid points .",
    "compute the gauss - legendre nodes and weights @xmath132 , @xmath133 , @xmath134 for the r direction , the trapezoidal nodes @xmath135 , @xmath136 for the @xmath120 direction , and the gauss - legendre nodes and weights @xmath137 , @xmath138 , @xmath139 for the @xmath119 direction if @xmath140 . use the type-2 nufft to evaluate @xmath94 at these nonuniform grid points . use the type-1 nufft to evaluate @xmath141 defined in .",
    "the total computational cost of algorithm [ alg1 ] is @xmath142 , where @xmath143 is the total number of irregular points in the fourier domain and @xmath144 is the total number of equispaced points in the physical domain .",
    "as discussed in the end of section 2 , the constant in front of @xmath143 is @xmath145 for @xmath90 digits accuracy with @xmath124 the dimension of the problem .",
    "since @xmath143 is often comparable with @xmath144 and the constant in the standard fft is quite small , the @xmath146 term will dominate the computational cost in algorithm [ alg1 ] , making it considerably slower than the standard fft .",
    "we now construct a more elaborate algorithm to reduce the interpolation cost of the preceding scheme , by reducing the number of irregular points @xmath143 .",
    "we note that the only singular point in the fourier domain is the origin .",
    "thus we will split the integral in into two parts using a simple partition of unity .",
    "@xmath147 we now choose the function @xmath148 so that it is a monotone @xmath79 function which decays rapidly , and so that @xmath149 is a smooth function for @xmath150 . by the second property of @xmath148 ,",
    "it is easy to see that @xmath151 can be computed using the regular fft .",
    "if @xmath148 decays much faster than @xmath152 , then @xmath153 can be computed using the nufft but with many fewer irregular points in the fourier domain .",
    "there are many choices for @xmath148 . indeed , any partition of unity function that is @xmath79 in @xmath62 , equals to @xmath154 for @xmath155 and @xmath156 for @xmath157 would work theoretically .",
    "in order to minimize the oversampling factor in the evaluation of @xmath151 , for the two dimensional problems listed in and , we choose @xmath158 as follows : @xmath159 where @xmath160 is the complementary error function defined by the formula @xmath161 .",
    "dimensional analysis indicates that @xmath162 and @xmath163 in the definition of @xmath158 should be proportional to @xmath164 , where @xmath165 ( @xmath166 ) are the mesh size in the @xmath167th direction .",
    "our numerical experiments show that with @xmath168 and @xmath169 , an oversampling factor of @xmath170 for @xmath151 and a @xmath171 irregular grid for @xmath153 yield @xmath90 digits accuracy .",
    "an oversampling factor of @xmath172 for @xmath151 and a @xmath173 irregular grid for @xmath153 yield @xmath92 digits of accuracy .",
    "we have not carried out a more detailed optimization .",
    "for three dimensional problems , we choose a simple gaussian : @xmath174 it is straightforward to verify that @xmath175 has a power series expansion in @xmath176 , so that it is a smooth function of @xmath5 , satisfies the second property .",
    "we still need to choose the parameter @xmath177 in .",
    "obviously , one would need fewer irregular points for @xmath153 if @xmath177 were small , reducing the computational cost of @xmath153 .",
    "however , the gaussian becomes more sharply peaked and one would need to oversample the regular grid in @xmath151 in order to maintain high accuracy , increasing the computational cost .",
    "thus , @xmath177 should be chosen to balance the contributions of the two integral to the net cost .",
    "dimensional analysis indicates that @xmath177 should be of the order @xmath178 where the @xmath165 ( @xmath179 ) are the mesh size in the @xmath167th coordinate direction in physical space .",
    "numerical experiments show that with @xmath180 , the oversampling factor for @xmath151 can be set to @xmath172 .",
    "an irregular ( spherical ) @xmath181 grid in the fourier domain achieves 12 digits of accuracy for @xmath153 , and an irregular @xmath182 grid in the fourier domain achieves 6 digits accuracy for @xmath153 .    _ given the dimension @xmath124 , the box size parameters @xmath125 , @xmath183 and the number of equispaced points @xmath105 in each direction , compute @xmath54 defined in on a uniform grid in @xmath127 $ ] . _",
    "compute the coordinates of the uniform grid in @xmath128 , that is , @xmath129 , @xmath130 , @xmath183 .",
    "evaluate the values of the function @xmath131 at these uniform grid points .",
    "set the oversampling factor to @xmath172 and compute @xmath151 in using regular fft .",
    "use nufft as in algorithm [ alg1 ] to compute @xmath153 in .",
    "compute @xmath184 .",
    "once @xmath54 has been computed via algorithm [ alg2 ] , the interaction energy can be discretized via the trapezoidal rule and evaluated by pointwise multiplication and direct summation in physical space .",
    "the computational cost is obviously linear in the total number of discretization points in physical space .",
    "the computational cost of the interpolation procedure within the nufft has been reduced to @xmath185 in algorithm [ alg2 ] .",
    "our algorithm can be easily modified to evaluate any nonlocal interaction with a convolution structure , so long as the fourier transform of the kernel is known .",
    "if the singularity at the origin of @xmath5-space can not be removed by switching to polar or spherical coordinates , one can easily develop a high order generalized gaussian quadrature rule to discretize the singular integral in the radial direction ( see , for example , @xcite ) .",
    "we have implemented the algorithms above in fortran . for convenience",
    ", we have used the publicly available software package @xcite .",
    "we used the gcc compiler ( version @xmath186 ) with option -o3 on a @xmath187 bit linux workstation with a @xmath188ghz intel xeon cpu and @xmath90 mb of cache .",
    "we restrict our attention to the performance of algorithm [ alg2 ] .    for testing purposes , we have chosen right - hand sides ( densities ) for which the analytical solutions are known . in the following tables , the first column lists the total number of points in physical space",
    ", the second column lists the value of the parameter _",
    "prec_. in 2d problems @xmath189 implies that the oversampling factor for the regular fft is 2 and a @xmath173 polar grid is used for the nufft .",
    "@xmath190 implies that the oversampling factor for the regular fft is 3 and a @xmath171 polar grid is used for the nufft . for 3d problems , @xmath189 implies that the oversampling factor for the regular fft is 2 and a @xmath191 spherical grid is used for the nufft .",
    "@xmath190 implies that the oversampling factor for the regular fft is 2 and a @xmath181 spherical grid is used for the nufft .",
    "the third column lists the time spent using the regular grid and the fft .",
    "the fourth column lists the time spent on the irregular grid and the nufft .",
    "the fifth column lists the total time expended by the algorithm .",
    "all time are measured in seconds .",
    "finally , the last column lists the relative @xmath192 error as compared with the analytical solution on a uniform grid in physical space .",
    "example 1 : coulomb interactions in 2.5d .",
    "we take @xmath193 , @xmath194 as in ( [ cou2d ] ) and @xmath195 with @xmath177 a positive constant in ( [ gpe ] ) .",
    "the analytical solution to ( [ gpe ] ) is given by the formula @xmath196 where @xmath197 is the modified bessel function of order @xmath156 ( see , for example , @xcite ) .",
    "the numerical solution is computed by the formula ( [ ifft ] ) with @xmath193 via algorithm [ alg2 ] .",
    "table [ tab1 ] lists the numerical results for @xmath198 .",
    ".error and timing results for example 1 . [ cols=\"^,^,^,^,^,^\",options=\"header \" , ]     [ tab7 ]    from these tables , it is clear that the timing scales roughly linearly with @xmath10 .",
    "the timing difference between @xmath189 and @xmath190 are not very significant .",
    "thus , we recommend setting @xmath190 in general .",
    "an efficient and high - order algorithm has been constructed for the evaluation of long - range coulomb and dipole - dipole interactions of the type which arise in quantum physics and chemistry , as well as materials simulation and design .",
    "the algorithm evaluates these interactions in the fourier domain , with a coordinate transformation that removes the singularity at the origin .",
    "the fourier integral is then discretized via high - order accurate quadrature , and the resulting discrete summation is carried out using the nonuniform fft ( nufft ) .",
    "the algorithm is straightforward to implement and requires @xmath9 work , where @xmath10 is the total number of points in the physical space discretization .",
    "thus , the net cost is of the same order as that of using the uniform fft for problems with periodic boundary conditions .",
    "our algorithm is easily extended to the computation of any nonlocal interaction that has a suitable convolution structure . when the singularity in the fourier transform can not be accounted for by a simple change of variables ,",
    "generalized gaussian quadrature can be used to create a high - order discretization @xcite , to which the nufft can be applied , achieving nearly optimal computational complexity .",
    "an example where this extension of our algorithm is helpful is the solution of the free space poisson equation in 2d , where the fourier transform of the kernel is @xmath199 and the integrand is still singular after switching to polar coordinates .",
    "we plan to incorporate the method described here into efficient and accurate solvers for computing the ground state and dynamics of dipolar becs , the nonlinear schdinger equation with a coulomb potential , and the kohn - sham equations for electronic structure .",
    "similar ideas have been used for computing stokes interactions with compactly supported data with a mixture of free space and periodic boundary conditions imposed on a unit cell @xcite .",
    "the authors would like to thank mark tygert and anna - karin tornberg for many useful discussions .",
    "part of this work was done when the first and third authors were visiting beijing computational science research center in the summer of 2013 .                                                                                , _ a scalable parallel poisson solver in three dimensions with infinite - domain boundary conditions _ , in 7th international workshop on high performance scientific and engineering computing ( 2005 ) , 814822 ."
  ],
  "abstract_text": [
    "<S> we present a fast and accurate algorithm for the evaluation of nonlocal ( long - range ) coulomb and dipole - dipole interactions in free space . </S>",
    "<S> the governing potential is simply the convolution of an interaction kernel @xmath0 and a density function @xmath1 , for some complex - valued wave function @xmath2 , permitting the formal use of fourier methods . </S>",
    "<S> these are hampered by the fact that the fourier transform of the interaction kernel @xmath3 has a singularity at the origin @xmath4 in fourier ( phase ) space . </S>",
    "<S> thus , accuracy is lost when using a uniform cartesian grid in @xmath5 which would otherwise permit the use of the fft for evaluating the convolution . here , we make use of a high - order discretization of the fourier integral , accelerated by the nonuniform fast fourier transform ( nufft ) . by adopting spherical and polar phase - space discretizations in three and two dimensions , respectively , the singularity in @xmath6 at the origin is canceled , so that only a modest number of degrees of freedom are required to evaluate the fourier integral , assuming that the density function @xmath7 is smooth and decays sufficiently fast as @xmath8 . </S>",
    "<S> more precisely , the calculation requires @xmath9 operations , where @xmath10 is the total number of discretization points in the computational domain . </S>",
    "<S> numerical examples are presented to demonstrate the performance of the algorithm .    </S>",
    "<S> coulomb interaction , dipole - dipole interaction , interaction energy , nonuniform fft , nonlocal , poisson equation .    </S>",
    "<S> 33c10 , 33f05 , 44a35 , 65r10 , 65t50 , 81q40 </S>"
  ]
}