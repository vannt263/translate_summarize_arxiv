{
  "article_text": [
    "cosmic microwave background ( cmb ) is a statistically isotropic @xcite and gaussian @xcite random field .",
    "if we ignore secondary effects , all of the information in high resolution cmb maps is encoded in the angular correlation function or equivalently , in the angular power spectrum , @xmath6 .",
    "the angular power spectrum is widely used to estimate the cosmological parameters .",
    "accurate measurements of angular power spectrum are needed for precise estimation of cosmological parameters .    over the past decade",
    ", cmb power spectrum has been measured over a large range of multipoles , @xmath7 , by various groups @xcite .",
    "and more experiments are under way to measure the @xmath8 on smaller scales with high accuracy @xcite .",
    "most power spectrum analyses use uniform or noise weighted maps .",
    "this performs reasonably well for power spectra that have nearly equal power in equal logarithmic intervals of multipoles , _",
    "@xmath9 for the cmb . for smaller scales , ( larger @xmath7 ) this method is non - optimal , as we show in section [ master ] .",
    "cmb power spectrum estimated from an incomplete sky map is the underlying full - sky power spectrum convolved with the power spectrum of the mask .",
    "this leads to coupling of modes in the estimated power spectrum . for high resolution experiments such as act and spt which will map the small scale anisotropies of the cmb on small patches of the sky ,",
    "this mode - mode coupling will be a serious problem .",
    "the reason is that cmb power spectrum is very red on those scales ( it falls off as @xmath10 at large @xmath7 ) and hence is highly vulnerable to the leakage of power due to mode - mode coupling .",
    "there are two methods to remedy this : to taper the map near the sharp edges , and to pre - whiten the cmb power spectrum . in order to minimize the loss of information due to applying a taper to the map",
    ", we use the multitaper method @xcite .",
    "this method involves weighting the map with a set of orthonormal functions which are space limited but maximally concentrated in the frequency domain .",
    "power spectrum of each of these tapered maps is a measurement of the power spectrum of that map with a different amount of mode coupling .",
    "final power spectrum is obtained from a particular linear combination of these tapered power spectra that minimizes the bias in the estimated power spectrum .",
    "the use of multiple tapers also reduces the error - bars in the measured power spectrum .",
    "mode coupling is less harmful if the map has a nearly white power spectrum .",
    "traditionally , an inverse covariance matrix weighting is used in analysis to prewhiten the maps @xcite .",
    "this method works well , but is a computationally expensive , non - local operation and may be complicated to implement , specially for high resolution experiments @xcite .",
    "we propose a simple and local prewhitening operator in real space (   [ prewhiten ] ) that is fast to implement and reduces the bias due to the leakage of power .",
    "this method prevents the unnecessarily large error bars at @xmath11 due to the point source masks .",
    "usually masks have sharp edges and holes at the positions of point sources .",
    "this leads to a mode - coupled power spectrum that is highly biased at large @xmath7 .",
    "deconvolution of the mode - coupled power spectrum is a well - studied problem in the cmb data analysis literature @xcite and has been applied to many experiments .",
    "but deconvolution of a highly biased power spectrum leads to large error bars in the final power spectrum at large @xmath7 .",
    "the mode coupling problem will be worse for the upcoming set of cmb experiments as bright point sources will be much more of a limiting foreground at high resolution .    as we show in   [ master ]",
    ", prewhitening followed by the multitaper method for power spectrum estimation reduces the error - bars ( specially at large @xmath7 ) in the decoupled power spectrum ( cf . figs .",
    "[ errorcompare ] &  [ pwmasterederrors ] ) .",
    "we begin with a review of the multitaper method in one - dimension in ",
    "[ review ] and discuss the salient features of the method , generalizing it to the two - dimensional case .",
    "next , we discuss the statistical properties of multitaper spectrum estimators . as a simple application ,",
    "we demonstrate the method in context of cmb power spectrum estimation in",
    "  [ application ] .",
    "next , we formulate the prewhitening method (   [ prewhiten ] ) and apply it to the case of cmb power spectrum estimation in presence of masks . in ",
    "[ master ] , we describe the algorithm for deconvolving the power spectrum and the implications of the multitaper method and prewhitening in its context",
    ". we summarize and conclude in   [ conclusion ] .",
    "the problem of estimating the power spectrum of a stationary , ergodic process , sampled at discrete intervals and observed over a finite segment of its duration of occurrence , is an old and well - studied one ( for an extensive treatise , see @xcite ) .",
    "several methods have been traditionally used for power spectrum estimation in one - dimension .",
    "these include non - parametric methods like the periodogram , the lag - window estimators , welch s overlapped segment averaging @xcite and the multitaper method @xcite , and parametric methods like the maximum likelihood estimation . in this paper , we generalize the one - dimensional multitaper method to two - dimensions and adapt it to handle real data with noise and masks on a two - dimensional flat euclidean patch .",
    "we discuss its applications specifically in the case of cmb power spectrum estimation .",
    "the most basic spectral estimation method is to take the square of the fourier transform ( ft ) of the observed data .",
    "taking the ft of a finite segment of data is equivalent to convolving the underlying power spectrum with the power spectrum of a top - hat function .",
    "as the latter has substantial sidelobe power , it leads to spectra leakage and the resulting spectrum is highly biased .",
    "most of the non - parametric methods for power spectrum estimation utilize some kind of a data taper ( a smooth function that goes smoothly to zero at the edges of the observed segment ) to minimize the effect of spectral leakage .",
    "such smoothing reduces the bias in the estimator at the cost of lower spectral resolution .",
    "as the taper down - weights a fraction of the data , one is left with an effectively lower sample size . since tapering also smooths in frequency space , it essentially leads to a loss of information which is reflected in the increased variance of the final estimate .",
    "the first attempt at ameliorating these disadvantages of using a data taper was addressed in a seminal paper by @xcite which laid down the basis of the multitaper method ( mtm ) .",
    "the basic idea of mtm is to apply multiple orthogonal tapers with optimal spectral concentration to minimize the loss of information due to tapering .      throughout this paper",
    ", we will refer to spatial coordinates as the @xmath12 space ( this may be an angular coordinate in radians on the sky , or a comoving distance in @xmath13 , etc . ) and the reciprocal space as the @xmath14 space ( which would be the multipole space @xmath7 , or the fourier modes in @xmath13 , etc ) .",
    "the continuous fourier transform conventions adopted here are , f()&=&d^n   f ( )   ( -i ) + f()&= &   f ( )   ( i ) , where @xmath15 is the dimensionality of the space .    for a stationary process ,",
    "@xmath16 the power spectrum is defined as , ( 2)^n p(k)= .      although power spectrum estimation for the cmb is an inherently two - dimensional problem , we will begin by discussing the multitaper theory in one dimension .",
    "this is because the essential features of the theory are easier to understand in one dimension and can be trivially generalized to higher dimensions .",
    "we consider a stationary , stochastic , zero mean process @xmath17 sampled at @xmath18 discrete points , @xmath19 sampled at regular intervals of size @xmath20 .",
    "let @xmath21 be the true underlying power spectrum of the process .",
    "our problem is to estimate @xmath21 using the sample of size @xmath18 .    the nyquist frequency for the problem is given by @xmath22 and the fundamental frequency by @xmath23 . in the following",
    ", we will assume @xmath24 for simplicity .",
    "let us contemplate windowing our data by some function @xmath25 , generating the product , y(x_j)=g(x_j ) f(x_j ) and taking the power spectrum of the windowed data as , ( 2)p(k)y^*(k ) y(k ) = ^2 , where @xmath26 is the fourier transform of @xmath27 .",
    "the quantity @xmath28 can be thought of as an estimator of @xmath21 , such that its ensemble average is related to @xmath21 through = _",
    "-k_n^k_n ( k - k ) p(k ) .",
    "this means that @xmath28 is an estimator of the true power spectrum convolved with a _",
    "spectral window function _ , ( k)=^2 . if @xmath29 could be designed such that @xmath30 then @xmath28 would be an exact unbiased estimator of @xmath31 .",
    "however , a function like @xmath32 which is spatially limited in extent can not be arbitrarily concentrated in the frequency space .",
    "if the window function is a top - hat , its power spectrum will be a @xmath33 function refers to the _ sinus cardinus _",
    ". power spectrum of a two - dimensional top - hat window is a product of two @xmath33 functions . ] with substantial sidelobes .",
    "this will lead to the aliasing of power on various scales , an effect known as spectral leakage or mode coupling .",
    "mode coupling is specially damaging for a spectrum which is highly colored or structured .    the multitaper method ( mtm )",
    "consists of finding a set of orthogonal window functions or tapers , which are maximally concentrated in some predetermined frequency interval . with the set of tapers",
    ", one can generate several approximately uncorrelated estimates of the power spectrum .",
    "this is superior to the plain fourier transform ( periodogram ) because it not only attempts at remedying mode coupling errors but also helps decrease the uncertainty in the estimated power spectrum by generating independent realizations of the same power spectrum with information from different section of the data .",
    "we formulate the method below .",
    "we desire a set of tapers , such that each of them is spatially limited , @xmath35 @xmath36 and has its power @xmath37 optimally concentrated in some frequency interval , @xmath38 $ ] , with @xmath39 . here",
    "we have introduced the shorthand notation @xmath40 for @xmath41 .",
    "concentration is quantified by the following quantity , ^2(w)=. which is basically the fractional power of the taper inside the desired interval . remembering that , g_k=_j=1^n",
    "g_j e^-i k x_j , the above equation can be re - written as , ^2(w)=_j=1^n_j=1^n",
    "g^*_j g_j/_j=1^n ^2 .",
    "it is easy to see that the sequence @xmath35 that will maximize @xmath42 must satisfy , _",
    "j=1^n g_j = _ ( n , w ) g_j , for @xmath43 this can be immediately recognized as an eigenvalue problem , g=_(n , w ) g where @xmath44 is the @xmath45 toeplitz matrix , _",
    "jj= and @xmath46 is the vector , index limited from @xmath47 to @xmath48 which has the highest concentration in the frequency interval @xmath49 $ ] . here",
    "@xmath50 denotes the indices of the different eigenvalues of the problem .",
    "the solution to this eigenvalue problem is well known @xcite",
    ". there are @xmath18 nonzero eigenvalues of the problem denoted by @xmath51 ( @xmath52 ) with corresponding eigenvectors @xmath53 .",
    "the elements of each of the @xmath18 eigenvectors consist of a finite subset of the discrete prolate spheroidal sequence ( dpss ) .",
    "the zeroth eigenvector @xmath54 which has the highest eigenvalue @xmath55 is composed of the zeroth order dpss , the eigenvector @xmath56 having eigenvalue @xmath57 is composed of first order dpss sequence and so on .",
    "some salient properties of the @xmath18 eigenvectors and eigenvalues are as follows ,    1 .",
    "the eigenvalues are bounded by @xmath58 and @xmath59 : @xmath60 2 .",
    "the eigenvectors are orthogonal and can be standardized so that they are orthonormal , @xmath61 3 .",
    "the eigenvectors form a basis for an @xmath18-dimensional euclidean space .",
    "4 .   usually the eigenvectors are ordered according to decreasing eigenvalues .",
    "the first @xmath62 eigenvalues are close to unity ( most concentrated ) and the eigenvalues rapidly fall to zero thereafter .",
    "this behavior is illustrated in fig .",
    "[ eigenvalues ] .",
    "the number @xmath62 is often referred to in the mtm literature as the _ shanon number_.    one - dimensional dpss taper generation algorithms are usually included in standard signal processing softwares ( e.g. the @xmath63 module of matlab ) . for the purpose of this paper , we used a fortran 90 implementation of the original algorithm by @xcite .",
    "examples of dpss tapers and their corresponding spectral window functions are displayed in fig  [ tapersandpowers ] , where the gradual worsening of the leakage properties of the tapers are apparent .     and",
    "@xmath64 are shown for @xmath65 .",
    "spectral concentration of the tapers rapidly worsen beyond @xmath66 . ]",
    "the fourier transforms of the tapers , ^(k ) = _ j v^(x_j ) e^-i k x_j also have the interesting properties :    1 .",
    "they are orthonormal over the frequency range @xmath67 , @xmath68 2 .   they are also orthogonal over the frequency domain @xmath69 , [ orthoinw ] _",
    "-2w^2w ^(k ) ^(k ) = _ _ .",
    "this means that the functions @xmath70 form an orthonormal set on the inner interval @xmath69 .",
    "having generated the _",
    "eigentapers _ , we can form @xmath71 approximately uncorrelated estimators of the power spectrum with the first @xmath71 eigenvectors having the best concentration , ( 2 ) p^(k)=^2 where @xmath72 .",
    "then we can form a weighted mean of the tapered power spectra , often called the _ eigenspectra _ , to generate the final estimate of @xmath21 , the simplest form of which is , [ mtmspec ] p^(k)= it can be shown that this is the optimal way of estimating @xmath31 in the case where the process is white noise . for colored spectra , a more sophisticated approach is required , which leads to the adaptive multitaper method ( amtm ) to be discussed in the following section .",
    "the important point to note here is that the mtm or variants of it , aim to restore the information lost to a single taper algorithm by weighting different parts of the data by an orthogonal set of tapers , thereby reducing the variance in the final estimate .",
    "lower variance comes at the cost of decreased spectral resolution .",
    "one should bear in mind that the choice of the resolution @xmath73 is completely dependent on the analyst . remembering that the number of useful tapers is @xmath74 and a better spectral resolution , i.e. smaller @xmath73 means that there will be fewer tapers to work with .",
    "the choice of @xmath73 will in most cases be dictated by the type of and the features in the power spectrum being estimated .",
    "as noted above , if the underlying spectrum is white and only modest spectral resolution is needed in the analysis , many eigenspectra can be simply combined with scalar weights to get a good estimate of the true spectrum . however , this is not the case for spectra which are colored and have large dynamic range .",
    "for example , the cosmic microwave background ( cmb ) power spectrum @xmath6 falls like @xmath10 beyond @xmath75 . in cases such as this ,",
    "only the first few tapers are good at avoiding aliasing of power due to mode coupling .",
    "as more and more tapers are used , the estimated power spectrum gets more and more biased .",
    "the adaptive multitaper method ( amtm ) aims at mitigating this problem , thereby allowing the use of a larger number of tapers even for a colored spectrum . in the following we briefly sketch the amtm method .    according to the cramer spectral representation of a stationary process @xcite , a stationary zero mean",
    "process can be represented as , [ cramerrep ] f(x ) = _",
    "-k_n^k_n e^ikxdz(k ) for all @xmath76 , where @xmath77 is an orthogonal incremental process @xcite .",
    "the random orthogonal measure @xmath78 has the properties , = 0 ; = p(k ) dk . where @xmath21 , as before , is the true underlying spectrum .",
    "the fourier transform of the data weighted by an eigentaper can be written as , y^(k ) & = & _ j=1^n",
    "v^(x_j ) f(x_j ) e^-ikx_j + & = & _ -k_n^k_n v^(k - k ) dz(k ) using . note that this contains information from the entire nyquist range .",
    "now consider the case where the signal @xmath17 is convolved with a perfect bandpass filter from @xmath79 to @xmath80 to yield the unobservable yet perfect eigencomponent , ^(k ) = _",
    "k=k-2w ^k+2w dz(k ) which contains information only from the interval @xmath81 .",
    "note that in accordance with we have used the correct orthonormal form for ft of the tapers inside this interval .    the quantity @xmath82 , although fictitious in the sense that it can not be computed from the data , has the desirable property that , = _",
    "k= k -2w^k + 2w ^2 p(k ) d k",
    "i.e. it is the unbiased estimator of the true power spectrum smoothed by a strict bandpass filter of width @xmath83 .",
    "therefore , in a multitaper setting , when combining different tapers with weights , the weights should be chosen such that the eigenspectrum obtained by each of the weighted tapers is as close as possible to this ideal estimate .",
    "this forms the basis of the amtm , where one replaces the scalar weights by frequency dependent weight functions @xmath84 which minimize the mean squared error , ^(k)= .",
    "the minimization leads to the following expression for @xmath85 , [ bms ] b_(k)= where , @xmath86 , the variance of the map , using parseval s theorem .    with this the minimum mean",
    "square error becomes , ^(k ) , and the best estimate of the power spectrum has the form , [ amtmspec ] p^(k)= where @xmath87 is the single taper power spectrum estimate with the @xmath88 taper i.e. the eigenspectrum of order @xmath50 . in case of a white noise spectrum @xmath89 , and therefore @xmath90 , which gives us the formula for the simple mtm",
    "also , in this case @xmath91 .",
    "this shows again that for white noise , for which the first @xmath62 tapers have eigenvalues close to unity , the mean squared error is negligible .",
    "note that the estimation of the power spectrum requires the evaluation of the optimal value for the weights @xmath92 , which assumes knowledge of the true power spectrum .",
    "but the latter is precisely what we are trying to estimate .",
    "therefore , this method has to be implemented iteratively according to the following steps ,    1 .",
    "we use the first one or two tapers ( having the least spectral leakage ) to form a first estimate of the power spectrum @xmath21 via",
    "we use to estimate the weights @xmath84 .",
    "3 .   with the @xmath85 s estimated , we use with @xmath93 tapers to get the second estimate of the power spectrum .",
    "using this new estimate , re - evaluate the weights @xmath84 and repeat steps 2 - 4 .    in the following",
    ", we will generalize the amtm to two dimensions .",
    "so far we have only considered one - dimensional tapers . in the signal processing literature ,",
    "generalizations of the multitaper method to higher dimensions have not been widely discussed .",
    "some of the early works include @xcite .",
    "relatively recently , straightforward generalizations of the method to higher dimensional euclidean spaces @xcite and to patches on the surface of the sphere @xcite have been formulated . in view of the upcoming cmb experiments ( that will map the sky on small scales at high resolution ) , we will be mostly interested in the power spectrum estimation on regularly sampled two - dimensional flat spaces like a projection of a small patch on the sky .",
    "as such we will discuss the 2-d extension of the multitaper method as discussed in @xcite .",
    "two - dimensional tapers are constructed from outer products of one - dimensional tapers .",
    "we assume a two - dimensional map spanned by the coordinates @xmath94 .",
    "the data should be sampled regularly , but the sampling intervals ( pixel sizes ) , @xmath95 , and the number of pixels in each direction , @xmath96 , can be different ( @xmath97 ) .",
    "let us relabel the one - dimensional taper of the previous section as @xmath98 where the extra superscript denotes the number of pixels in a given direction .",
    "then a two - dimensional taper of order @xmath99 and size @xmath100 can be constructed out of the outer product of two one - dimensional tapers : v^(_1_2;n_1n_2 ) = v^(_1,n_1)^t , where we have treated @xmath101 as a column vector .",
    "the spectral concentration eigenvalue of a two - dimensional taper , is easily shown to be the product of the eigenvalues of the one - dimensional tapers out of which the former is constructed : _ ( _ 1_2;n_1n_2)=__1,n_1__2,n_2 .",
    "two - dimensional tapers constructed in this way inherit most of the properties of one - dimensional tapers such as orthogonality on the sample plane , and optimal spectral concentration and orthonormality in the frequency plane .",
    "the two - dimensional power spectrum estimator corresponding to these tapers is defined , similar to the one - dimensional case , as a weighted sum of approximately independent tapered power spectra [ amtm2d ] p^(k_1 , k_2)= , where we have dropped the @xmath102 portion of the labels for simplicity .",
    "note that in the above formula the weights @xmath103 depend on the eigenvalues @xmath104 and are given by an equation analogous to and are to be estimated iteratively .",
    "the quantity @xmath105 is the eigenspectrum of order @xmath106 and is given by ^(_1_2)= ^2 , where @xmath107 is the two - dimensional map , the power spectrum of which is being estimated .",
    "we will introduce a bit of notation at this point .",
    "we will designate the two parameters that control the multitaper method as :    * @xmath108 : the number of tapers used .",
    "its value will be written in the form @xmath109 , where @xmath71 denote the number of one - dimensional tapers .",
    "for example if @xmath110 one - dimensional tapers are used to create @xmath111 two - dimensional tapers via outer products , then we will quote @xmath112 .",
    "* @xmath113 : we will use this as the shorthand for the resolution parameter @xmath114 .",
    "for example , @xmath115 will mean that the half - bandpass chosen for generating the tapers is three times the fundamental frequency .",
    "statistical distribution of the power spectra of a gaussian random field realized on a map with periodic boundary conditions , such as a full sky cmb field , can be described in terms of the simple analytic distributions .",
    "this property stems from the fact that each fourier - mode ( or spherical harmonic component ) of such a map is a statically independent quantity . on a finite patch of the sky or for any map with a non - periodic boundary condition",
    ", these modes get entangled due to the convolution with the window , and are no longer amenable to such simple descriptions . as we will discuss in this subsection , the multitaper method approximately restores many of these nice properties of random fields on a finite patch , and makes the statistical properties of the spectral estimators describable via simple and intuitive analytic expressions .",
    "most of the statistical properties of the different spectral estimators that we have discussed so far stem from the basic result that for most stationary processes with a power spectrum @xmath21 that is continuous over the interval @xmath116 $ ] , the simple fft power spectrum ( periodogram ) @xmath117 is distributed as , [ periodogrampdf ] p^pm(k )    p(k ) ^2_2/2 , & ; + p(k ) ^2_1 , & ,    asymptotically as @xmath118 . here",
    "@xmath119 means `` equal in distribution '' , which means that the statement `` @xmath120 '' is equivalent to saying that the random variable @xmath121 has the same distribution as a chi - square random variable with @xmath122 degrees - of - freedom ( dof ) that has been multiplied by a constant @xmath123 . for a gaussian white noise process",
    "the above result is exact for any @xmath18 .",
    "also , for the asymptotic case , the power spectra for two different frequencies @xmath124 and @xmath125 are uncorrelated .",
    "although these results are true for asymptotically large @xmath18 , in a finite @xmath18 case , they approximately hold for the @xmath126 independent fourier frequencies @xmath127 , if @xmath18 is large enough .    using the above result , it is possible to predict the approximate distribution of an amtm spectrum estimator . using an equivalent degrees - of - freedom argument",
    "( see appendix  [ appendixz ] for details ) , it can be shown that for @xmath118 , p^ ( ) ^2 _ where , [ amtmnu ] ( ) = . therefore , for finite @xmath18 , it is reasonable to expect that the amtm power spectrum at each pixel is approximately distributed as @xmath128 with @xmath122 given by the above equation .",
    "note that in the case of mtm , @xmath129 . if we are only using tapers with eigenvalues close to unity , then @xmath130 , @xmath71 being the total number of tapers used .",
    "now we turn to the approximate form of the distribution for the power spectrum after it is binned in annular rings in @xmath14 space , which we denote by @xmath131 , [ binnedpower ] p^b(k_b ) = _ i , j b p^(k_i , k_j ) where the sum is over all pixels that fall inside bin @xmath132 and @xmath133 is the number of observations in that bin . using a similar argument as before ,",
    "it can be shown ( see appendix  [ appendixz ] ) that , p^b(k_b ) ^2__b where the degree - of - freedom , @xmath134 is given by , [ binnedpdfnu ] 1_b _ i , j b , with @xmath135 given by .",
    "if the degree - of - freedom variable is also slowly varying , then this implies @xmath136 , which is the expected result for the sum of @xmath137 independent identically distributed @xmath138 variables .",
    "note that the appearance of the @xmath139 factor essentially arises from the fact that amtm significantly correlates @xmath139 nearby pixels , and therefore only @xmath140 `` super - pixels '' are approximately statistically independent .    in case of the periodogram , @xmath141 and @xmath142 , so that @xmath143 . in case of mtm with @xmath71 tapers with good leakage properties , @xmath144 and therefore , @xmath145",
    "pixel grid .",
    "the physical size is 8 degrees on a side .",
    "estimation of the power spectrum is done on the 4 degree @xmath1 4 degree subarea indicated by the rectangle .",
    "the color scale represents temperature fluctuations in micro - kelvin . ]    in this section , we will illustrate the multitaper method by applying it to flat - sky cosmic microwave background ( cmb ) maps .",
    "we shall assume the maps to be pure cmb without noise or masks and with uniform weight .",
    "we also assume a square map with square pixels for simplicity , although all the results shown hold for non - square maps and/or non - square pixels .",
    "we adopt a deliberate change of notation at this point to make the following sections more compatible with existing cmb literature .",
    "since we will dealing with angular co - ordinates on the sky , we call the real space variable @xmath146 rather than @xmath12",
    ". we also call the dual fourier space , the @xmath147 space , instead of the @xmath14 space .",
    "the latter is motivated by the fact that the full sky cmb power spectra are expressed in terms of multipole moments , which are denoted by @xmath7 , and the @xmath14 vector is the correct generalization of the @xmath7 modes in the flat - sky case .",
    "we will also denote the power spectrum @xmath21 by @xmath6 .",
    "we generate the cmb maps as gaussian random realizations from a theoretical power spectrum @xmath6 . in order to simulate the effect of non - periodic boundary conditions we first generate larger maps from which the desired region is extracted . in the present example",
    ", we generated @xmath148 realizations of @xmath149 pixel cmb map having a physical size of @xmath0 degrees on a side .",
    "this implies that the sampling intervals ( i.e. pixel scales ) along either axes is @xmath150 .",
    "we extract a @xmath151 pixel 4 degree square sub - map from the center of each such realization and perform the power spectral estimation on this sub - area ( see fig .",
    "[ cmbmap ] ) . given the physical size and the number of pixels , one finds the nyquist and fundamental values of @xmath7 to be @xmath152 and @xmath153 .",
    "therefore , if we choose a resolution parameter of @xmath154 the half - bandwidth outside which spectral leakage is minimized is @xmath155 .",
    "we perform the straight fft or periodogram ( labeled pm ) , mtm and amtm power spectrum estimation on @xmath148 random realizations of the cmb map .",
    "the results are shown in fig  [ montecarlops ] .",
    "these plots show the mean power spectrum binned uniformly in @xmath7 in bins of @xmath156 .",
    "the error bars correspond to the @xmath157 spread in the distribution of their values .",
    "two features are immediately apparent from this figure .",
    "first , it shows that the pm has significant spectral leakage and produces a power spectrum which is highly biased .",
    "although the eigenvalue weighted mtm is better in this respect , it still suffers from significant bias at high @xmath7 s because the higher order tapers can not guard efficiently against spectral leakage .",
    "the amtm seems to do very well in minimizing spectral leakage and producing an approximately unbiased estimate of the input power spectrum .",
    "second , the @xmath157 spread in the uncertainty of the binned value in the pm case is much higher than the corresponding spread for the amtm .",
    "this is one of the main reasons for performing tapered power spectrum estimation with multiple tapers , as has been stressed before . as discussed in   [ master ] this property becomes extremely important when the tapered power spectra are decorrelated via a master - like @xcite algorithm .",
    "the nearly unbiased nature of the amtm power spectrum translates to errorbars in the deconvolved spectrum which are several factors smaller than those obtained from a periodogram in the large @xmath7 regime .",
    "now , we will compare the distributions of the various power spectrum estimators with the theoretical expectations of section  [ statprop ] .",
    "for this purpose , we choose three multipoles @xmath158 at which we study both the single pixel and the binned probability distributions .",
    "the reason for choosing these three numbers is that the first multipole is an example where all three methods are approximately unbiased , the second multipole is a case where the pm is biased but the mtm and amtm are almost unbiased , while the third multipole represents a regime where only the amtm is close to an unbiased estimate .    for the single pixel case , we choose three pixels @xmath159 on the @xmath147-space map , such that values of @xmath160 are close to the three multipoles as described above . we store",
    "the values of @xmath6 realized in the @xmath148 monte carlo simulations in these pixels , and draw up the probability distribution of the quantity @xmath161 from these values , for each of the three methods .",
    "the results are shown in fig  [ singlepixelpdf ] . in the top panel ,",
    "we show the results of the same experiment that was used to generate fig .",
    "[ montecarlops ] , i.e. with @xmath162 and @xmath163 . for the leftmost plot ,",
    "all three methods of power spectrum estimation are approximately unbiased .",
    "the mtm and amtm methods are almost identical here , because the spectrum does not have a large local slope at this multipole so that even in the adaptive method , the higher order tapers do not need to be down - weighted to reduce spectral leakage .",
    "therefore , the equivalent degrees - of - freedom come out to be the same and @xmath164 as expected for a white spectrum from . for the middle plot ,",
    "the multipole @xmath7 is such that the local spectrum is moderately colored and spectral leakage for a periodogram becomes apparent in the biased estimate of the mean power spectrum it generates , as indicated by the dashed vertical line .",
    "the amtm remains approximately unbiased while the mtm is only slightly biased , but the equivalent degrees - of - freedom for amtm is now lower than that of the mtm method .",
    "this is expected because to reduce spectral leakage the weights associated with the higher order tapers have been reduced in the amtm spectrum , thereby lowering the degrees - of - freedom .",
    "this trend continues to higher multipoles , and as shown in the rightmost plot of in the figure , the spectral leakage is kept at a minimum only in the amtm power spectrum by heavily down - weighting the higher order tapers , while both mtm and pm become highly biased .",
    "an important point to note here is that not only does amtm minimize the spectral leakage ( and hence bias ) but it also takes advantage of multiple tapers by reducing the error in the estimate .",
    "this is most easily seen by comparing the width of the distributions of amtm spectra against that of the pm spectra .",
    "the lower panel of fig .",
    "[ singlepixelpdf ] essentially shows the same features but for @xmath165 and @xmath166 . a comparison of the upper and lower panels",
    "also illustrate how by using more tapers the uncertainty in the power spectrum can be reduced .",
    "we would like to remind the reader once again here that the number of usable tapers depend on the spectral resolution chosen - poorer spectral resolution ( in this example @xmath167 vs. @xmath110 ) allows the use of more tapers ( @xmath168 vs. 3 ) and consequently an estimate with lower error .",
    "now , we turn to the distribution of the bandpowers @xmath169 , i.e. the mean power spectrum in annular bands in the @xmath147 space .",
    "this is illustrated in fig .",
    "[ binnedpdf ] .",
    "the top two panels correspond to the same multitaper parameters as in fig .",
    "[ singlepixelpdf ] , binned uniformly in @xmath147 space with bins of width @xmath156 , while in the third panel we show the case for another experiment with @xmath170 and @xmath171 binned at @xmath172 .",
    "the curves plotted over the points are the approximate theoretical distributions expected from .",
    "we note that the theoretical curves are always a good fit for the amtm method .",
    "this is mainly because of the fact that the amtm is approximately unbiased at all multipoles , while the mtm or pm become biased except at the lowest multipoles . since near - unbiasedness was an assumption adopted in deriving the binned distributions ,",
    "the latter two methods suffer from mismatch with theory wherever they are highly biased . for the @xmath170 case",
    ", we chose a bin width of @xmath173 so as to make it large enough to avoid splitting a super - pixel between bins . also , note that the distribution of the binned power spectra are close to gaussian , an expected result , as binning essentially involves combining many variables with almost identical distributions .",
    "next , we investigate the covariance between different bins , in order to study how the bandpowers are correlated with each other .",
    "we define the scaled covariance matrix , _ a b = where , c_ab = .",
    "we use our monte carlo simulations to estimate the quantity above .",
    "the results are displayed in fig .",
    "[ covariancematrixfig ] .",
    "these figures illustrate an extremely desirable feature of the amtm estimator i.e. the bandpowers are essentially uncorrelated beyond the spectral resolution @xmath174 set by the taper parameters .",
    "this implies that if we set the bin widths to be same as @xmath175 then adjacent bins will be uncorrelated .",
    "if our bins are smaller , they will be correlated through a mode coupling matrix which is fairly diagonal , and hence can be easily inverted to decouple them , an issue we will briefly touch upon in   [ master ] .    in the following section",
    ", we turn to the more practical issue of dealing with cmb maps with noise and point source masks in them .",
    "the maps of the cosmic microwave background produced by any experiment will invariably contain instrumental noise and regions , like bright point sources , that are usually masked out before estimating the power spectrum .",
    "the raw sky map also contains other astrophysical contaminants which we will neglect for the purpose of this discussion .",
    "application of point source mask to a map is essentially replacing the pixel values in an area containing each point source with zeros . masking is therefore equivalent to multiplying the map with a function which is unity everywhere except inside discs of varying sizes , where it is zero .",
    "this can also be thought of as successively multiplying the map with a mask for each point source .",
    "taking power spectrum of the final masked map is therefore equivalent to successively convolving the true power spectrum with power spectra of a series of such single - point - source masks . as the size of the discs will in general vary for each such function , the true power spectrum will be convolved with functions that have power over various ranges of multipoles .",
    "although the multiplication with tapers will guard against aliasing of power due to sharp edge of the map , they will be ineffective against the mixing of power due to a point source mask .",
    "we propose here a method for dealing with such issues , which in essence is the following :    1",
    ".   perform local real space convolution of the map with designed kernels so as to make its power spectrum as flat ( white ) as possible , at least over the range of multipoles which is affected most by aliasing of power due to the point source mask .",
    "we refer to this procedure as `` prewhitening '' .",
    "2 .   perform an amtm power spectrum estimation of this prewhitened map in order to minimize any additional aliasing of power due to sharp edges of the map .",
    "3 .   as the prewhitening operation was a convolution",
    "whose fourier space form is ( preferably analytically ) known , divide the power spectrum of the prewhitened map with the fourier space form of the prewhitening function to recover the power spectrum .",
    "note that the design of the prewhitening function will be specific to the type of signal being considered . in the following , we will demonstrate the prewhitening of cmb maps , with forms of the prewhitening function specific to the features in the cmb power spectrum .",
    "we will first consider a noiseless map , in order to motivate the basic form of the prewhitening operation and then generalize to maps with white noise .",
    "let us denote the pure cmb temperature map as @xmath176 .",
    "an important feature of the power spectrum of the cmb @xmath6 is that beyond a multipole of @xmath177 , it is approximately proportional to @xmath10 .",
    "such sharp fall in the power makes it extremely prone to aliasing of power across multipoles due to a point source mask .",
    "if we perform an operation akin to taking the laplacian of this map , then we would effectively multiply the power spectrum by @xmath178 on all scales , thereby making the processed power spectrum nearly white over the large @xmath7 tail .",
    "this would thereby minimize aliasing of power . in the following",
    "we propose a method of achieving this , by a combination of two operations which we call `` disc - differencing '' and `` self - injection '' .",
    "if we convolve the map with a circular disc of radius @xmath179 , generating , ( ) = d^2 w_r(- ) t( ) where @xmath180 is the top - hat filter , w_r ( ) =    & + 0 &    then in fourier space , we will have t_r()= w_r ( ) t ( ) where the fourier space window , @xmath181 is given by , w_r()=2 .",
    "now let us consider smoothing the map with another top - hat window of radius @xmath182 , giving , t_3r()=d^2 w_3r(- ) t( ) .",
    "we then take the difference map , t_r-3r = t_r - t_3r , which in fourier space reads , t_r-3r ( ) & = & w_r-3r ( ) t ( ) + & & 2(-)t ( ) . remembering the asymptotic expansion of @xmath183 for @xmath184 , 2 1- , which shows that for values of @xmath7 such that @xmath185 , we have , t_r-3r()(r)^2 t ( ) , which implies that the power spectrum is now , ( 2 ) ^2^r-3r = ( 2 ) ^2 ^4 r^4 c _ , which is the desired form . the disc - difference window , @xmath186 is shown in fig .",
    "[ discdiffwindow ] . beyond @xmath187 ,",
    "the function starts falling again .",
    "thus by choosing the radius @xmath179 judiciously , one can prewhiten a desired range of the power spectrum .",
    "an important aspect of this method is that it is an effective @xmath188 operation on the map ( @xmath189 is the covariance matrix ) , which is manifestly local , and therefore does not suffer from effects due to edges , which is a common problem in case of the full fourier space operation . maximum likelihood methods of estimation of power spectra naturally involve the @xmath190 operation @xcite .",
    "however , for high resolution experiments , the numerical costs for computing the @xmath190 matrix can be prohibitively large .",
    "also , such an operation is non - local and mixes modes from masks with the map in a non - trivial way .",
    "the method proposed here is approximate but is simple to implement as it involves only convolutions in real space : as such , its effect can be quantified , propagated or undone very easily .",
    "discussed in the text ( solid line ) .",
    "the dashed line represents the function @xmath191.[discdiffwindow ] ]    figure  [ prewhiteningtheory ] illustrates the effect of the disc - differencing operation on the cmb power spectrum , for a radius @xmath192 .",
    "this means that the prewhitening window turns around at @xmath193 .",
    "the application of the disc - differencing produces the processed power spectrum shown by the dashed curve in the figure , which has much smaller dynamic range than the original one shown by the dotted curve .     effect of disc - differencing and self - injection on the power spectrum .",
    "the dotted line is the true power spectrum with a large dynamic range .",
    "the disc - differencing operation alone produces the dashed curve which has a much smaller dynamic range , but is steeply rising at low multipoles .",
    "the disc radius used is @xmath194 .",
    "the dot - dashed curve shows the true power spectrum multiplied by a constant @xmath195 where @xmath196 . if we disc - difference the map followed by self - injection of a fraction @xmath50 of the map , then the power spectrum of the processed map is the solid curve ( given by ) which is conveniently flat over the range of multipoles . ]      one undesirable effect of the application of the disc - differencing function is that it makes the lower multipole part of the cmb power spectrum @xmath197 a steeply rising function , which may aggravate aliasing of power .",
    "a simple way to deal with this problem , is to add a small fraction of the original map back into the disc - differences map , a process we call `` self - injection '' .",
    "if a fraction @xmath198 of the map is self - injected after the disc - differencing , the processed power spectrum looks flat at all multipoles , and is conveniently given by a multiplication of the true power spectrum with an analytic function , [ processedspectrum ] ^pw = ( w_r-3r(r ) + ) ^2 .",
    "this is illustrated for @xmath196 in fig .",
    "[ prewhiteningtheory ] .",
    "having laid out the basic theory of prewhitening , we will now describe a concrete example of power spectrum estimation of a cmb map with a point source mask to judge the effectiveness of this method in recovering the true power spectrum . to this end",
    "we simulate a @xmath199 map as a gaussian random realization from a theory power spectrum .",
    "the map has @xmath200 pixels on a side , making the pixel scale @xmath201 .",
    "we cut out a @xmath202 section from this map to impose non - periodic boundary conditions .",
    "we then simulate a point source mask for this smaller map , which is unity everywhere except inside randomly positioned discs of various radii , where it is zero .",
    "prewhitening and amtm as a remedy to aliasing of power due to point source mask .",
    "the dotted curve represents the input power spectrum from which the map is generated .",
    "the triangles represent the recovered amtm power spectrum ( @xmath203 , @xmath204 ) of the map after a point source mask is applied directly to it . if , on the other hand , the map is first prewhitened ( see text ) and the mask is subsequently applied , one obtains the diamonds as the amtm power spectrum .",
    "the solid curve is the theoretical prediction for the prewhitened power spectrum .",
    "thereafter , one divides the spectrum by the prewhitening transfer function ( see , obtaining a nearly unbiased estimate , denoted by the open circles .",
    "note that the amtm power spectra appear smoother than the true spectra as the former is convolved with the window function of the taper . ]    to motivate the necessity of prewhitening , we first apply the mask directly to the map and take its amtm power spectrum with @xmath205 and @xmath206 .",
    "the result is shown in fig  [ prewhitenexamplenonoise ] .",
    "note that we expressly use only the first few tapers with least leakage to ensure that mode coupling is minimized due to sharp edges of the map .",
    "however , this choice has no bearing against the aliasing of power due to holes in the map and as expected , we find a lot of power aliased from the low to the high multipoles .",
    "next we perform a disc - difference operation on the original map with @xmath207 , followed by a self - injection with @xmath196 .",
    "then , we apply the mask on this prewhitened map and perform amtm power spectrum estimation on it . by comparing with the expected theoretical power spectrum ,",
    "we find that aliasing is almost non - existent in the power spectrum of the prewhitened and masked map .",
    "then we simply divide this power spectrum by the analytical transfer function for the prewhitening operation , to obtain a nearly unbiased estimate of the true power spectrum .      in a real experiment",
    ", the map will be convolved with the instrument beam and will contain noise from the instrument as well as other astrophysical signals . to simulate the simplest of such situations",
    ", we convolve the map from the previous step with a gaussian beam of full - width - at - half - maximum ( fwhm ) of @xmath208 .",
    "next , we add gaussian white noise at a level of @xmath209 @xmath210k per sky pixel ( defined as an area of fwhm@xmath211 on the sky ) .",
    "the power spectrum of the map so generated has the usual initial sharp fall with multipole @xmath7 , but then flattens out beyond the multipole where white noise starts to dominate .",
    "one immediate consequence of this is that the disc differencing operation that multiplies the power spectrum by @xmath212 will make the white noise part rise with @xmath7 instead of remaining flat .",
    "one can try to minimize this effect by judiciously choosing the disc radius @xmath179 so that the disc - differencing window function turns over at the value of @xmath7 where white noise starts to dominate .",
    "however , there may be components to the power spectrum other than white noise which may rise faster than the fall of the disc - differencing window .",
    "all these cases can be effectively dealt with by introducing another component to the prewhitening operation : namely a convolution with a gaussian window after the disc - differencing and the self - injection steps . if we convolve the map with a gaussian of fwhm @xmath213 then after evaluating the power spectrum we can remove its effect by dividing it by the multipole space form @xmath214 . in fig .",
    "[ prewhitenexamplenoise ] we illustrate the prewhitening in presence of white noise .",
    "same as in fig .",
    "[ prewhitenexamplenonoise ] , but for a map with white noise .",
    "in addition to the standard prewhitening operation , a gaussian smoothing has been applied to flatten the tail of the prewhitened map . ]",
    "as discussed earlier , an undesirable feature of the multitaper method is the loss of spectral resolution . for any @xmath215 , a multitaper estimator smooths the power spectrum with a frequency - space window which is wider than the fundamental resolution set by the size of the map . for power spectra which are highly structured ,",
    "this poses the problem of diluting interesting features which may render the power spectrum less useful as a direct probe of the underlying phenomenon .",
    "for example , in case of the cmb , ( a)mtm leads to the smoothing of acoustic features .    in cmb analyses ,",
    "the problem of recovering the true power spectrum from one that has been convolved with a window function is a well studied problem .",
    "it arises naturally in full - sky cmb experiments because of the application of point source and galactic masks .",
    "a detailed account of the procedure to deal with mode - mode coupling in the spherical harmonic space can be found in @xcite . in what follows",
    ", we will discuss the mode - mode coupling in flat space and develop the method of deconvolving the effective tapering window function from the power spectrum .    consider a homogeneous , isotropic and zero - mean gaussian random process realized on a map , @xmath216 , with a power spectrum @xmath21 , = ( 2)^2(- ) p(k ) .",
    "if the map is multiplied by a window @xmath217 , then the fourier transform of the resulting map is given by the convolution , t^w ( ) = t( ) w(- ) .",
    "in the ensemble average sense , we therefore have , [ pseudocl ] & & + & = & p(k ) , which is often referred to as the pseudo power spectrum in cmb literature .",
    "all the multitapered power spectra discussed so far are pseudo - power spectra in this sense , and comparing with , it is easily seen that for amtm , the power spectrum of effective window that couples to the true power spectrum is given by , w^amtm ( ) = .",
    "one is obviously interested in the angle averaged pseudo power spectrum , [ angularavpseudo ] p^w(k ) = p^w ( ) and as demonstrated in appendix [ appendixa ] , this can be expressed in terms of the true power spectrum as , = dk m(k , k^ ) p(k ) where @xmath218 is the mode - mode coupling kernel and depends on the power spectrum of the window @xmath73 .",
    "after the power spectrum is binned , the above relation can be conveniently expressed as a matrix multiplication ( see appendix [ appendixa ] , ) , = _",
    "b_bbp_b where @xmath132 are the indices for the bins and @xmath219 is the binned mode -mode coupling matrix .",
    "the binned mode - mode coupling matrix is more stable to inversion than the un - binned one which tends to be nearly singular , and therefore an estimate of the true power spectrum can be obtained by inverting the above relation , [ deconvol ] p_b = ( ^-1)_bbp^w_b.     fractional errors in the deconvolved binned power spectrum .",
    "the open circles represent the fractional errors for the periodogram method ( left panel of fig .",
    "[ slavesandmasters ] ) .",
    "the filled circles represent the same for the amtm method ( right panel of fig .",
    "[ slavesandmasters ] ) .",
    "although the deconvolved power spectrum obtained from either method is an unbiased estimate of the true power spectrum , the errors from the periodogram method are much larger at high @xmath7 because of the highly biased nature of the mode - coupled periodogram at those multipoles . ]",
    "we first illustrate the deconvolution of the power spectrum without a point source mask . for this purpose",
    ", we simulate a large @xmath220 degree square map , with @xmath200 pixels on a side , using a theoretical power spectrum .",
    "we then perform power spectrum analysis of the central 8 degree square portion of it . for the periodogram , we simply zero out the portion of the larger map outside the central 8 degree square , so that the mask becomes a zero - padded top - hat . for the amtm",
    ", we discard the outer regions and perform the adaptive multitaper analysis with @xmath221 , @xmath222 on the central 8 degree square .",
    "we generate the mode coupled power spectrum with each method and then deconvolve it using .",
    "the results from @xmath223 monte carlo experiments are shown in fig .",
    "[ slavesandmasters ] .",
    "firstly , we note that the construction of the mode - mode coupling matrix , as delineated in appendix  [ appendixa ] , enables us to accurately predict the mode - mode coupled theoretical power spectrum . as such , likelihood analyses for cosmological parameters",
    "can potentially be performed with the mode - coupled amtm power spectrum , and this is specially appealing because the statistical properties of the mode - coupled binned power spectra can be precisely predicted ( see   [ statprop ] ) .    secondly , we find that the deconvolution of the periodogram as well as the amtm power spectrum produces an unbiased estimate of the input power spectrum , but with a very important difference : the uncertainty in the deconvolved periodogram at @xmath224 is larger than that in the deconvolved amtm spectrum , and the difference continues to grow to factors of several for higher multipoles .",
    "this is seen clearly in fig .",
    "[ errorcompare ] , where we have plotted the fractional errors in the deconvolved binned power spectrum against the bin centers .",
    "for instance , at @xmath225 the periodogram method produces @xmath226 times larger error bars .",
    "this owes to the fact that due to spectral leakage , the periodogram produces a pseudo power spectrum that is highly biased relative to the input theory over these higher order multipoles .",
    "this bias adds to the uncertainty in the deconvolved power spectrum . on the other hand , amtm produces a nearly unbiased , albeit smoothed , pseudo power spectrum which , when deconvolved , does not incur any excess uncertainties . ignoring point source masks for the moment , which are very specific to the cmb , this result alone immediately elevates the multitaper method to a far superior status than the periodogram , as a power spectrum estimation method for highly colored spectrum measured from finite maps .",
    "one must bear in mind , that over the range of multipoles where leakage is not a serious problem , and the periodogram is essentially unbiased , the errors bars obtained from the periodogram are the smallest .",
    "this is because the periodogram makes use of all the modes that are available from the entire map , while each taper in a mtm process makes use of a certain fraction of the map . by using several tapers",
    ", one can compete with the periodogram error bars over the nearly white part of the spectrum .",
    "this is essentially seen in the convergence of the fractional error bars from the two methods in the low @xmath7 portion of fig .",
    "[ errorcompare ] .",
    "this , however , is not in contradiction to the fact , as shown in   [ statprop ] that it is possible to have lower uncertainties in any bin for the pseudo power spectrum with amtm than with the periodogram , by choosing a high enough @xmath227 ( and consequently high @xmath228 ) .",
    "unfortunately , this advantage goes away when the power spectrum is deconvolved .",
    "next we turn to the practical issue of dealing with a point source mask for a cmb map . as already discussed in ",
    "[ prewhiten ] , the holes in the mask couple power over various scales , and neither the periodogram nor the amtm remain an unbiased method at large multipoles , necessitating the prewhitening of the map . to study the effect of the mask and prewhitening on the deconvolved power spectrum , we multiply our map with a point source mask and repeat the monte carlo exercise with and without prewhitening .",
    "the mask has a covering fraction of @xmath229 and the holes are of random sizes . for the prewhitening operation",
    "we use the parameters @xmath207 and @xmath196 .",
    "the results on the fractional errors for this case are displayed in fig .",
    "[ pwmasterederrors ] .",
    "this figure shows the power of prewhitening approach .",
    "prewhitening significantly reduces the errors .",
    "it is obvious that like the periodogram , amtm is defenseless against the point source holes in the mask .",
    "this is expected because a taper with holes no longer retains the nice property of being a band - limited function . for both the top - hat and the effective tapered window ,",
    "the sidelobes become dominated by the power produced by the holes .",
    "in such a situation , prewhitening the map becomes a necessity to reduce the uncertainties in the deconvolved power spectrum . with proper prewhitening both the periodogram and",
    "the amtm method can produce nearly unbiased pseudo power spectra and consequently small error bars at the high multipoles , as evident from fig .",
    "[ pwmasterederrors ] .",
    "it is important to note here that the power spectrum of a top - hat has greater sidelobe power than the effective taper in the intermediate range of multipoles between the regions where the central lobe is falling and where the point source power starts to dominate .",
    "therefore , depending on the quality of prewhitening that can be performed on a map , amtm may be a more reliable method to apply on the prewhitened and masked map , rather than the periodogram .",
    "effect of prewhitening on the errors in the deconvolved power spectrum in presence of a point source mask .",
    "_ top panel : _ for the amtm method : the open circles represent the fractional @xmath230 error bars on the deconvolved power spectrum when prewhitening is not performed , showing that holes in the point source mask render the amtm method biased at high multipoles and lead to large error bars .",
    "the filled circles represent the same after prewhitening has been performed , showing that prewhitening remedies the leakage of power and makes the power spectrum estimator nearly unbiased . _",
    "bottom panel : _ the same as above , but for the periodogram or straight fft .",
    "note that prewhitening , if performed properly , makes the periodogram as good a power spectrum tool as the amtm . ]",
    "power spectrum estimation on small sections of the cmb sky is a non - trivial problem due to spectral leakage from the finite nature of the patch , which is further compounded by the application of point source masks .",
    "the direct application of standard decorrelation techniques , like the master algorithm @xcite , to obtain an unbiased estimate of the power spectrum leads to unnecessarily large uncertainties at high multipoles due to the highly biased nature of the pseudo power spectrum at those multipoles .",
    "we have put forward two techniques to reduce the uncertainties in the deconvolved power spectrum .",
    "first , we have formulated a two - dimensional adaptive multitaper method ( amtm ) which produces nearly unbiased pseudo power spectra for maps without point source masks , by minimizing the leakage of power due to the finite size of the patch .",
    "this is achieved at the cost of lowered spectral resolution .",
    "the deconvolution of the pseudo power spectrum so produced , leads to an unbiased estimate of the true power spectrum that has several times smaller error bars at high multipoles than the deconvolved periodogram . in presence of point source masks , however , this method becomes non - optimal because the pseudo power spectrum estimated even by amtm is no longer unbiased . to deal with the point source mask ,",
    "we have put forward a novel way of prewhitening a cmb map , with manifestly local operations which has simple representations in the fourier space .",
    "this operation produces a map , the power spectrum of which has several orders of magnitude lower dynamic range than the original map .",
    "this renders the leakage of power due to holes and edges a relatively benign issue for the prewhitened map .",
    "if the prewhitening operation can be tuned to make the power spectrum of the map nearly white , a pseudo power spectrum obtained via a simple periodogram may be nearly unbiased and therefore , can be deconvolved to give a precisely unbiased estimate of the power spectrum , thereby avoiding unnecessarily large error bars at large multipoles .",
    "if the map can not be made sufficiently white for a periodogram , an amtm method can be applied to the prewhitened map to guard against leakage and achieve the same result .",
    "we have shown that by applying these methods , one can reduce the error bar in the small scale power spectrum by a factor of @xmath231 at @xmath232 .",
    "this can be translated into a many - fold reduction in the required integration time of a cmb experiment to achieve some target uncertainty on the small scale power spectrum than that dictated by standard techniques .",
    "the statistical properties of the multitaper spectral estimators follow from the basic result for the distribution of the periodogram . in the following",
    ", we will use the equivalent degrees of freedom argument to derive the distribution functions for the mtm estimators .",
    "the first result we will use is that the probability distribution of an eigenspectrum @xmath233 at each frequency - space point @xmath14 ( i.e. at each pixel ) will have the same form as for asymptotically large @xmath18 . since the final spectral estimate is a weighted sum of these eigenspectra , it is reasonable to assume that the former is distributed also as a scaled @xmath234 variable .",
    "let us hypothesize , p^ ( ) a ^2 _ where both @xmath122 and @xmath123 are unknown .",
    "now , we will make use of the facts that @xmath235 and @xmath236 .",
    "therefore , = ; a = .",
    "since the eigenspectra @xmath237 are asymptotically uncorrelated and are also unbiased estimators of @xmath238 , we obtain , using the definition of the amtm estimator , & = & p ( ) , + ( p^ ) & = & p^2 ( ) for @xmath239 , which immediately gives us ( ) = . which is equation .",
    "now we turn to the approximate form of the distribution for the binned power spectrum , @xmath240 .",
    "we again postulate that @xmath240 is distributed as @xmath241 , so that , [ nuandc ] _ b = ; c = . now note that because the images or maps we will be concerned with are real , only the half - plane in the @xmath14 space are independent because of reflection symmetry i.e @xmath242 . for the time being , let us assume that all @xmath14 space pixels are uncorrelated , so that all pixels in one half of the @xmath14 plane are independent of each other .",
    "later , we will correct this for the fact the tapers highly correlate adjacent pixels in each resolution element . with these assumptions , can be re - written as , p^b(k_b ) = _ i , j b ; k_j>0",
    "p^(k_i , k_j ) .",
    "therefore , the variance is given by , ( p^b(k_b ) ) & = & _ i , j b ; k_j>0 ^2 + & = & ^2 + & & _ i , j b where in the last step we have assumed that the power spectrum is slowly varying inside a bin .",
    "the factor of @xmath110 inside the summation goes away because we have extended the summation to include the lower half plane .",
    "using , we therefore get 1_b = 2 n_b^2 _ i , j b .",
    "now , we will correct for the fact that all pixels in the upper half plane are not independent .",
    "in fact for a taper with a given @xmath113 , approximately @xmath243 pixels get highly correlated .",
    "therefore we can think of `` super - pixels '' of dimension @xmath244 , which are independent of each other .",
    "if we repeat the calculation above with this assumption , then we obtain the result , 1_b _ i , j b , which essentially reduces the degrees - of - freedom by the number of pixels that fall in each super - pixel .",
    "this is equation .",
    "in the following , we derive the form of the mode - mode coupling kernel . for the sake of completeness ,",
    "we repeat and expand upon some of the calculations from appendix a.1 of @xcite .",
    "note that the symbol @xmath124 ( frequency ) in the said appendix of that paper is smaller by a factor of @xmath245 than the @xmath124 ( angular frequency ) used in the present section .",
    "in other words , the @xmath124 used here is readily identified with the multipole @xmath7 in the flat - sky approximation , while it would stand for @xmath246 in the aforementioned appendix .",
    "we start with the definition of the angle averaged pseudo power spectrum and with the aid of express it as , [ pw ] = p(k_2 ) .",
    "we can express the fourier mode of the window appearing above as w(_1-_2 ) = d^2_3 w(_3 ) ^2(_3-_1+_2 ) which immediately gives , = 2dk_3   k_3 w(k_3 ) ^2(_3-_1+_2 ) where we have introduced the power spectrum of the window , ( 2)^2w(k ) = w^ * ( ) w ( ) . substituting in , we get , [ pw1 ] & = & d_2 p(k_2)dk_3   k_3 w(k_3 ) ^2(_3-_1+_2 ) + & = & dk_2 m_k_1k_2 p(k_2 ) , where we have introduced the mode - mode coupling matrix , [ mcm ] m_k_1k_2 = dk_3   k_3 w(k_3 ) j(k_1,k_2,k_3 ) with , j(k_1,k_2,k_3 ) = d_2 ^2(_3-_1+_2 ) it is instructive to compare with the full - sky result from appendix a.2 of @xcite , [ mcml ] m__1_2 = _ _ 3 ( 2_3 + 1 ) w__3 (          ) ^2 j(_1,_2,_3 ) so that if we identify @xmath247 with @xmath248 , the large @xmath7 limit of the spherical mode - mode coupling matrix goes correctly to the flat - sky expression .",
    "note that the appearance of an extra factor of @xmath110 in the large @xmath7 limit of the summand in over the integrand in is fine because the sum is restricted to values @xmath249 which make @xmath250 even , while the integral over @xmath124 spans the entire allowed range for each @xmath251 pair .",
    "we now turn to the evaluation of the @xmath252 function . using the factorized form of the delta function in plane polar coordinates , @xmath253 ,",
    "we can write , j(k_1,k_2,k_3 ) = 1(2 ) d_2 ^ 2(k_1-)/k_1 .",
    "the integral over @xmath254 can be performed by using the following property of the delta function , ( g(x ) ) = _ i where @xmath255 are the roots of @xmath256 . in our case",
    "there are two roots and the integral finally yields j(k_1,k_2,k_3 ) = 2 1 for @xmath257 , and zero outside the interval , where @xmath258 . as a word of caution against using this form directly into the integral",
    ", we would like to point out that due to the diverging nature of the integrand near the edges of the allowed interval , numerical integration schemes that span the entire range will be unreliable .",
    "instead we find , drawing parallels with the spherical harmonic case , that approximating the integration in by a sum over integral values of @xmath124 , by interpolating @xmath259 onto integers , provides a very stable and reliable way of computing the mode coupling matrix .",
    "in fact , the boundaries of interval can be included in the sum by using the large @xmath7 limit of the @xmath260 functions at those points , (            next , we consider the binning of the pseudo power spectrum . in order to construct the mode - mode coupling kernel relevant to a binned power spectrum , we first define the binning operator @xmath262 , which performs the binning of the integral indexed quantities to binned values and its reciprocal operation @xmath263 .",
    "given the lower and upper boundaries,@xmath264 and @xmath265 of a bin @xmath132 , a simple form of these operators can be written as , b_b =            note that the pseudo power spectrum realized on the two - dimensional @xmath14-space may be directly binned into the bins @xmath132 , by averaging the value in the pixels that fall inside the annuli demarcated by the bin boundaries , without having to go through an intermediate step of interpolating the power spectrum onto integers .",
    "the binned pseudo power spectrum is , therefore related to the binned true power spectrum as & = & b_b m_ p_ + & = & b_b m_ u_ b b_b ",
    "p_ + & = & m_bb p_b , where we have defined the binned mode - mode coupling matrix as @xmath267 .",
    "we dedicate this paper to the memory of eminent geophysicist f. anthony dahlen ( 1942 - 2007 ) , who had suggested to us the idea of multitapering for the cmb .",
    "we would like to thank frederick j. simons , mark a. wieczorek , neelima sehgal and tobias a. marriage for enlightening discussions and viviana acquaviva for useful comments on the manuscript .",
    "sd would like to acknowledge the warm hospitality extended by the mentors and colleagues at jadwin hall , specially lyman page and jo dunkley , while the department of astrophysics was under renovation .",
    "ah would like to thank eric hivon for useful discussions .",
    "ah is supported by the ltsa program .",
    "sd is supported by the charlotte elizabeth procter honorific fellowship from princeton university and nsf grant 0707731 .",
    "dns acknowledges support from nasa atp grant nnx 08ah30 g ."
  ],
  "abstract_text": [
    "<S> estimation of the angular power spectrum of the cosmic microwave background ( cmb ) on a small patch of sky is usually plagued by serious spectral leakage , specially when the map has a hard edge . even on a full sky map </S>",
    "<S> , point source masks can alias power from large scales to small scales producing excess variance at high multipoles . </S>",
    "<S> we describe a new fast , simple and local method for estimation of power spectra on small patches of the sky that minimizes spectral leakage and reduces the variance of the spectral estimate . </S>",
    "<S> for example , when compared with the standard uniform sampling approach on a @xmath0 degree @xmath1 @xmath0 degree patch of the sky with @xmath2 area masked due to point sources , our estimator halves the errorbars at @xmath3 and achieves a more than fourfold reduction in errorbars at @xmath4 . </S>",
    "<S> thus , a properly analyzed experiment will have errorbars at @xmath4 equivalent to those of an experiment analyzed with the now standard technique with @xmath5 times the integration time . </S>"
  ]
}