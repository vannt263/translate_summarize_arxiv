{
  "article_text": [
    "the geant4 monte carlo toolkit was originally developed to support the high energy physics experiments of cern ( allison 2006 ) ; it has since enjoyed widespread usage in the medical physics community for many years ( foppiano 2004 , paganetti 2004 , aso 2007 , wroe 2007 , oborn 2009 , constantin 2010 ) .",
    "geant4 possesses electromagnetic physics models that have been validated for materials and photon / electron energies relevant to radiotherapy ( poon and verhaegen 2005 , tinslay 2007 ) .",
    "geant4 possesses many features that make it suitable for use in radiotherapy .",
    "it enables the simulation of complex geometries using combinatorial geometry , has support for voxelised geometries such as computed tomography ( ct ) data ( aso 2007 ) , and the ability to incorporate tesselated volumes generated by computer aided design ( cad ) programs ( constantin 2010 ) .",
    "this capability is particularly useful in radiation detector development where complicated compositions and geometries can be modelled and sources of artefacts can be identified and mitigated ( othman 2010 ) .",
    "time dependent geometries can also be modelled , which is applicable to modern radiotherapy modalities such as proton therapy ( paganetti 2004 ) , tomotherapy , sliding window imrt , volumetric modulated arc therapy , as well as tumour motion tracking technologies in these modalities .",
    "lastly , geant4 is able to model neutron production from photo - nuclear reactions , which is useful for out - of - field dosimetry studies relevant to higher energy photon beams . with this in mind , there is increasing interest in the use of geant4 as a monte carlo tool for external beam radiotherapy ( jan 2011 , grevillot , constantin 2010 , foppiano 2004 ) .",
    "a recently developed multi - threaded version of geant4 will enable porting of geant4 applications to many core processing units , further placing mc in the reach of routine treatment plan verification studies ( dong 2010 ) .",
    "this note describes an accurate model of a varian radiotherapy linac created using the geant4 toolkit , integration with a dicom - rt interface , and validation by comparison with experimental data .",
    "this tool will ultimately be used for routine independent verification of treatment plans and to support various research projects within the group including : gel dosimetry , plastic scintillator development , neutron dosimetry , and ultrasound based organ motion tracking .",
    "the geometry of the 6 mv varian@xmath0 ix clinac model is illustrated in figure  [ fig : geometry ] and is based on the vendor supplied documentation .",
    "particular attention was paid to target , flattening filter , primary collimator , jaw , and mlc geometry and material composition . for the most part",
    ", geant4 s standard combinatorial geometry ( allison 2006 ) classes were used to model the linac components .",
    "for complex imrt and rapidarc treatments , contributions to the dose distribution from mlc leakage can be significant ( bush 2008 ) ; an accurate model of mlcs is therefore essential .",
    "each individual mlc leaf was modelled using solidworks@xmath0 , including target and isocentre half - leaves , full leaves , and outboard leaves using the approach of constantin ( 2010 ) .",
    "the leaf components were then exported individually as step files ( an iso compliant file format ) before being converted to geometry description markup language ( gdml ) using the fastrad@xmath0 software .",
    "gdml is an xml extension used by geant4 to allow definition of geometry without the need for hard coding .",
    "these gdml files were then loaded into the geant4 application using the gdml parser . in order to create the mlc bank ,",
    "each leaf was placed along the y - axis according to manufacturer specification , taking into account the interleaf gap and leaf divergence from the source .",
    "a number of user interface commands were developed to allow configuration of many aspects of the geometry without the need for recompilation between runs .",
    "this includes gantry angle , collimator angle , jaw and mlc positions , phantom composition and dimensions ( solid water or water ) , phantom source - to - surface distance ( ssd ) , and voxellisation of the readout geometry .",
    "the international electrotechnical commission ( iec 2002 ) has defined a standard for coordinate systems and positive rotation directions for gantry and collimator in radiotherapy .",
    "it provides a hierarchical approach , with each component coordinate system described relative to its mother coordinate system .",
    "geant4 similarly uses a hierarchy of mother - daughter volumes in the construction of a simulation geometry , enabling straight - forward implementation of the iec standard .",
    "standard parameterised electromagnetic physics models were used , taking into account the following processes : for photons , the photoelectric effect , compton scattering , rayleigh scattering , and pair production ; for electrons , bremsstrahlung production , ionisation , and multiple scattering ; and for positrons , multiple scattering , ionisation , and the annihilation process . to preclude the tracking of very low energy secondary particles",
    ", geant4 uses the concept of range cuts ; that is , if a secondary particle is produced with residual range less than the range cut , it is not tracked and assumed to deposit all energy at the point of generation ; @xmath1 range cuts were used throughout the geometry .",
    "this corresponds to secondary electron energy thresholds of 84.7 kev in water , 352 kev in tungsten , and 250 kev in copper .",
    "phase space files were used to reduce computation times . using an approach similar to that of bush ( 2007 ) , each simulation was executed in three phases .",
    "phase i involves the simulation of a number of primary electrons incident on the target , the simulation of the subsequent electromagnetic cascade , and the scoring of photons at a plane below the ionisation chamber ( scoring plane 1 ) .",
    "this section of the geometry remains fixed during any treatment plan and need only be simulated once .",
    "the details of each particle crossing this scoring plane ( position , direction cosines , energy , particle - type , particle weight ) were recorded to a binary phase space file and the particle was no longer tracked . during phase ii , particles were sampled from the first phase space file and transported through the jaws and mlcs , then recorded again at a second scoring plane below the mlcs ( scoring plane 2 ) .",
    "the region between scoring plane 1 and scoring plane 2 does not change between control points ( beamlets ) during an imrt / rapidarc treatment .",
    "the first phase space file was recycled @xmath2 times to populate the second phase space file .",
    "phase iii of the simulation sampled the second phase space file and transported particles through the patient / phantom geometry ; this phase space file was again recycled @xmath2 times .",
    "uniform bremmstrahlung splitting ( ubs ) was implemented using the approach of faddegon ( 2008 ) with a splitting factor of @xmath3 .",
    "a simple form of geometry biasing was also implemented via `` kill zones '' : surfaces placed above the target and around the primary collimator so as to remove particles from the simulation that are unlikely to contribute to a response in the readout geometry .",
    "values of @xmath4 and @xmath5 were optimised via calculation of simulation efficiency for a @xmath6 square field using the methodology of karakow and walters ( 2006 ) .",
    "dose is scored in a voxellised water or patient geometry using the approach of aso ( 2007 ) . the dose delivered to each voxel per primary electron",
    "is calculated for each control point of a treatment plan ( or simulation run ) along with an estimation of the standard error .",
    "all information needed to fully describe a radiotherapy treatment plan can be defined in a number of files using the dicom - rt format . in order to facilitate a monte carlo simulation of treatment plans ,",
    "a dicom - rt interface is required . to this end , the vega library ( locke and zavgorodni 2008 ) was incorporated into the geant4 application .",
    "this library enables parsing of all dicom - rt files as well as the exporting of an mc calculated dose distribution into a dicom - rt dose file for subsequent importation back into the tps . in our implementation , each beam ( gantry angle , collimator angle ) and control point ( jaws , mlc settings , and number of mus ) is read from the tps dicom - rt plan file and translated into geant4 user interface ( macro ) commands .",
    "these in turn modify the geant4 simulation geometry between runs and simulate a pre - determined number of particles from the phase space file .",
    "treatment plans generally give the absolute dose distribution within the phantom / patient , whereas the monte carlo calculation results in dose per primary particle .",
    "analogous to the calibration of a linac monitor chamber , the virtual monitor chamber of a monte carlo simulation may be calibrated using the method outlined by popescu ( 2005 ) . in this approach",
    ", the reference conditions of the linac are simulated , typically a @xmath6 field at an ssd of 100 cm and calibration depth of @xmath7 ( iaea 2000 ) .",
    "a simulation is executed to determine the dose per primary particle at the calibration depth , as well as the dose to the virtual monitor chamber per primary particle .",
    "the absolute dose distribution under general conditions can then be determined by :    @xmath8    where @xmath9 is the normalised dose per incident particle , @xmath10 is the absolute dose per monitor unit as measured at the reference position during calibration of the linac , @xmath11 is the contribution to the monitor chamber dose per incident particle by the beam entering from above ( phase i of the simulation ) , @xmath12 is the contribution by the beam entering from the rear ( phases ii and iii of the simulation ) , @xmath13 is this contribution under reference conditions , @xmath14 is the simulated dose per primary particle under reference conditions , and finally @xmath15 is the number of monitor units delivered for a particular irradiation ( or control point ) .",
    "according to the suggested protocol of verhaegen and seuntjens ( 2003 ) the first stage in the commissioning of a monte carlo linac model is to optimise primary electron beam parameters in order to obtain agreement with experimental results .",
    "these parameters are @xmath16 - the electron beam energy , and @xmath17 - the standard deviation in the approximated gaussian fluence distribution of the primary electron beam that is normally incident on the target ; ie . ,",
    "the spot - size .",
    "dose distributions in a scanditronix water phantom were measured using a standard imaging exradin a16 chamber and scanditronix ic13 chamber ( for larger fields ) as part of the commissioning procedure for the tps .",
    "a subset of this was used for the tuning process ; namely , a @xmath18 and @xmath19 square field irradiation of a water phantom .",
    "the dose distribution in a water phantom was simulated using a spatial resolution of @xmath20 .",
    "initial values of @xmath21 and @xmath22 were based on manufacturer specifications .",
    "a comparison between simulated and experimental percentage depth dose ( pdd ) profiles , sensitive to beam energy , and a crossplane profile ( sensitive to spot - size variations ) at shallow depth ( @xmath23 ) was made .",
    "the spot - size and energy were tuned by nominal amounts until a @xmath24 gamma evaluation ( low , 1998 ) criterion was achieved for 98% of data points .    following primary beam tuning ,",
    "a subset of the complete commissioning dataset was used for validation .",
    "field - sizes relevant to imrt and rapidarc treatments ranging from @xmath25 to @xmath26 were considered with the square fields defined by the x and y jaws .",
    "comparison was made using pdds and cross - plane profiles at depths of @xmath27 , @xmath28 , @xmath29 , @xmath30 , and @xmath31 . again",
    "a @xmath24 gamma evaluation criterion was used to quantify accuracy of the simulation and fine adjustments in the model were made where necessary .    in order to validate the cad model of the multi - leaf collimator , a methodology similar to the approach of heath and seuntjens ( 2003 )",
    "leaf leakage measurements were performed using ebt2 film placed at @xmath32 depth in a solid water phantom at ssd of @xmath33 .",
    "the phantom was irradiated by a @xmath34 jaw - defined field with mlcs fully closed with a collimator rotation of 90 degrees .",
    "optical density changes in the ebt2 film were measured using an epson perfection v700 scanner , 72 dpi resolution ( spatial resolution of @xmath35 ) and 48 bit colour .",
    "perspex frames were used to separate the film pieces from the scanner surface in order to avoid newton s rings artefacts ( kairn 2010 ) .",
    "analysis of the film pieces was conducted using imagej image processing software .",
    "firstly the glass and frame were scanned to obtain a baseline image for the scanner , @xmath36 .",
    "next the film piece was placed on the frame and a scan acquired , @xmath37 . for both images ,",
    "the red colour channel was isolated and converted to 32 bit . in order to calculate optical density the logarithm of the ratio of glass to film images",
    "was taken : @xmath38 ( hartmann 2010 ) . to calculate net optical density variation induced by radiation dose ,",
    "the film was rescanned in this manner ( placed at the same position on the frame as the pre - scanned film ) .",
    "co - registration of images is performed ( typically translation of the image by a few pixels ) and the images are subtracted to calculate the net optical density image ( kairn 2010 ) .",
    "calibration pieces of dimensions @xmath39 @xmath40 were used from the same sheet as the measurement pieces and were exposed to doses in the range 0 - 400 cgy using a @xmath41 @xmath40 square field at depth of @xmath42 in a solid water phantom ( at an ssd of @xmath33 ) .",
    "the pieces were scanned prior to irradiation and at @xmath43hrs after irradiation and net optical densities were calculated as above . a 2nd order polynomial",
    "fit to the calibration curve was made and used to convert net optical density to dose . to ensure that measured doses lay within the range of doses used for the calibration of film , two irradiations were conducted ( heath and seuntjens 2003 ) .",
    "the first was approximately 50 times the number of mus required to give an open field dose of 100 cgy , given that the dose under the leaves is approximately 2% of the open field dose .",
    "likewise , the dose under the abutted leaves is approximately 20% of the open field dose , as such 5 times the mus were considered for this measurement ( heath and seuntjens , 2003 ) . a simulation of the experiment",
    "was then performed .",
    "validation of the linac model , dicom - rt ( plan ) interface , and method of absolute dose calibration , was carried out by simulating a commonly used imrt qa procedure known as the chair test ( van esch 2003 ) .",
    "this test is commonly used to verify the correct functioning of the leaf motion controller , as well as correctness of treatment planning parameters such as transmission and dosimetric leaf separation .",
    "similarly , it was used here to validate these aspects of the geant4 simulation .",
    "a typical chair test plan was delivered to a mapcheck@xmath0 two dimensional detector array at 5 cm depth in the mapphan@xmath0 solid water phantom ( @xmath44 ) , the plan was then simulated with the simulation tool , using the tps generated dicom - rt ( plan ) file for input .",
    "primary electron beam parameters that provided the best - fit to experimental pdds and crossplane profiles at a depth of 15 mm in water phantom were found to be @xmath45 and @xmath46 .",
    "this result is in contrast to published values for tuned beam energy that can often vary from the nominal beam energy by up to 5% ( mesbahi 2006 , verhaegen and seuntjens 2003 ) .",
    "particular attention was paid to the geometry and composition of the key components of the linac . in particular ,",
    "the correct density of target and flattening filter is essential , an over - estimation by a few percent in flattening filter density leads to significant underestimation of beam `` horns '' in the cross - plane profile for larger fields .",
    "furthermore , the simulated pdd was particularly sensitive to the range cuts employed in the simulation .",
    "too high a cut value leads to an over - estimation of the average beam energy ( beam is too hard ) which in turn can lead to an underestimation of the peak dose , requiring an unusually low tuned beam energy to achieve agreement . for each simulation @xmath47 primary electrons were used and simulation times were approximately 2 hrs on 100 cores ( 2.33ghz 64bit intel xeon processor cores ) of a high performance computing facility .",
    "figure  [ fig : commissionpdd ] shows pdd curves , both experimental and simulated , for a number of field sizes relevant to rapidarc and imrt treatments .",
    "the curves are normalised to the dose at a depth of 10 cm .",
    "the uncertainty of simulation results is approximately 2% and curves agree within the specified gamma criteria for at least 98% of points .",
    "figure  [ fig : commissionprofile ] shows crossplane dose profiles , both experimental and simulated , for a number of field sizes and depths in a water phantom .",
    "agreement between experiment and simulation is observed to satisfy a gamma criterion of @xmath24 ( 98% of data points ) and verifies the accuracy of the primary beam model , geometry of the beam modifying components ( barring the mlcs ) , physics processes , and the spectral properties of the 6 mv photon beam .    in order to mitigate the problem of inhomogeneity of ebt2 film sensitivity reported in the literature ( kairn 2010 )",
    ", a simple correction technique was used for which two pieces from the same sheet were used to measure the dose distribution with one of the pieces rotated 180 degrees . using fiducial markers ,",
    "the resulting dose distributions were co - registered and averaged .",
    "two leakage profiles were considered for comparison with simulation predictions ( see figure  [ fig : films ] ) : the first being parallel to the direction of leaf travel on the beam axis , referred to herein as the abutted leaf leakage profile ; the second was perpendicular to the direction of leaf travel and offset from the beam axis by several centimetres , referred to here - in as the interleaf leakage profile .",
    "the results of the abutted and interleaf leakage profiles are shown in figure  [ fig : leakage ] , dose profiles are normalised to the dose at the same position in the phantom for a @xmath48@xmath40 square field .",
    "the abutted leaf leakage profiles show excellent agreement , satisfying the criterion of @xmath24 .",
    "the interleaf leakage profiles show good agreement between the mean value of leakage dose : @xmath49 ( standard deviation ) measured compared to @xmath50 simulated . both in good agreement with the results of heath and seuntjens ( 2003 ) for millenium mlc modelling using beamnrc .",
    "heath and seuntjens ( 2003 ) observed a discrepancy at @xmath51 for the abutted leaf leakage profiles and attributed this to the existence of a single calibration point below @xmath52 on the calibration curve .",
    "this effect was also observed during the current study and mitigated by additional low dose calibration points below @xmath52 .",
    "results of the chair - test measurement and simulation are shown in figure  [ fig : chair ] .",
    "figure  [ fig : chair](b ) shows an x - profile along the y - axis , through the ` seat ' of the chair , where agreement between simulation and experiment is good .",
    "figure  [ fig : chair](a ) shows an x - profile at a y - offset of @xmath53 ; ie . , across the back of the chair .",
    "discrepancy in absolute doses of around 4% between experiment and simulation can be seen for the region that is blocked by the mlcs for the entire irradiation ( @xmath54 ) .",
    "the discrepancy was thought to be due to an over - response by the mapcheck array to the lower energy photons in this region ( dominated by particles scattered in the phantom or transmitted through the leaves ) . to test this hypothesis , leaf leakage measurements shown in figure  [ fig : leakage ]",
    "were repeated using the mapcheck device .",
    "this yielded an interleaf leakage measurement of @xmath55 , around @xmath56 higher than simulation and film measurements , yet agreeing within the stated uncertainty .",
    "figure  [ fig : chair](c ) shows an x - profile at a y - offset of @xmath53 ; ie .",
    ", across the legs of the chair .",
    "again discrepancy is seen in the central region that is either directly under a stationary leaf - body , or traversed by fully closed leaves . despite these discrepancies , these results do confirm the ability of the tool to simulate the control points of a treatment plan , accurately reproducing leaf movements , number of mus per control point , as well as the method of absolute dose calculation .",
    "a geant4 based simulation tool has been developed that is capable of accurately simulating the dosimetric properties of a 6 mv varian@xmath0 ix clinac .",
    "the simulation includes detailed modelling of key components using cad software and was tuned and validated against both film and ionisation chamber dosimetry measurements in solid water and water phantoms .",
    "the accuracy of the multi - leaf collimator model and dicom - rt interface was verified against mapcheck measurements in a solid water phantom subject to irradiation by a chair - test .",
    "this tool will form the basis of a treatment plan verification tool for radiotherapy and the model will be extended to include higher energy beams as well as cad modelled electron applicators for modelling electron beams .",
    "further validation will be performed by simulating rapidarc treatment plans delivered to homogeneous solid water phantoms and anthropomorphic phantoms and comparisons with experimental measurement .",
    "this project is funded by the queensland cancer physics collaborative ( queensland health ) , australia .",
    "computational resources and services used in this work were provided by the hpc and research support unit , queensland university of technology , brisbane , australia ( 404 core lyra altix se compute cluster ) .",
    "the authors would like to thank the geant4 collaboration for providing the toolkit and examples , regular updates , documentation , and the online user forum .",
    "the authors would also like to thank tanya kairn and john kenny of premion for discussions and guidance related to the use of ebt2 film .",
    "allison j _ et al _ 2006 geant4 developments and applications _ ieee trans . nucl .",
    "* 53 * 270278        constantin m , constantin d e , keall p j , narula a , svatos m and perl j 2010 linking computer - aided design ( cad ) to geant4-based monte carlo simulations for precise implementation of complex treatment head geometries n211n220      faddegon b a , asai m , perl j , ross c , sempau j , tinslay j , salvat f 2008 benchmarking of monte carlo simulation of bremsstrahlung from thick targets at radiotherapy energies _ med . phys . _ * 35(10 ) * 43084317    foppiano f , mascialino b , pia m.g and piergentili m 2004 a geant4-based simulation of an accelerator s head used for intensity modulated radiation therapy _ ieee nucl .",
    "rec . _ * 4 * 21282132                          othman m a r , cutajar d l , hardcastle n , guatelli s and rosenfeld a b 2010 monte carlo study of mosfet packaging , optimised for improved energy response : single mosfet filtration _ rad .",
    "dos . _ * 141(1 ) * 1017        oborn b m , metcalfe p e , butson m j and rosenfeld a b 2009 high resolution entry and exit monte carlo dose calculations from a linear accelerator 6 mv beam under the influence of transverse magnetic fields * 36(8 ) * 35493559                van esch a , bohsung j , sorvari p , tenhunen m , paiusco m , iori m , engstrm p , nystrm h and huyskens d p 2002 acceptance tests and quality control ( qc ) procedures for the clinical implementation of intensity modulated radiotherapy ( imrt ) using inverse planning and the sliding window technique : experience from five radiotherapy departments .",
    "_ radiother .",
    "oncol . _ * 65(1 ) * 5370"
  ],
  "abstract_text": [
    "<S> a geant4 based simulation tool has been developed to perform monte carlo modelling of a 6 mv varian@xmath0 ix clinac . </S>",
    "<S> the computer aided design interface of geant4 was used to accurately model the linac components , including the millenium multi - leaf collimators ( mlcs ) . </S>",
    "<S> the simulation tool was verified via simulation of standard commissioning dosimetry data acquired with an ionisation chamber in a water phantom . </S>",
    "<S> verification of the mlc model was achieved by simulation of leaf leakage measurements performed using gafchromic@xmath0 film in a solid water phantom . </S>",
    "<S> an absolute dose calibration capability was added by including a virtual monitor chamber into the simulation . </S>",
    "<S> furthermore , a dicom - rt interface was integrated with the application to allow the simulation of treatment plans in radiotherapy . </S>",
    "<S> the ability of the simulation tool to accurately model leaf movements and doses at each control point was verified by simulation of a widely used intensity - modulated radiation therapy ( imrt ) quality assurance ( qa ) technique , the chair test . </S>"
  ]
}