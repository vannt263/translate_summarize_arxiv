{
  "article_text": [
    "in this paper we generate random @xmath0-noncrossing partial matchings and @xmath0-noncrossing rna structures with uniform probability in polynomial time .",
    "three decades ago waterman pioneered the concept of rna secondary structures @xcite .",
    "these coarse grained rna structures are subject to strict combinatorial constraints : there exist no two arcs that cross in their diagram representation .",
    "it is well - known , however , that there exist cross - serial interactions , i.e.  crossing base pairs @xcite .",
    "these configurations are called pseudoknots @xcite and occur in functional rna ( rnasep @xcite ) , ribosomal rna @xcite and are conserved in the catalytic core of group i introns .",
    "pseudoknots appear in plant viral rnas and _ in vitro _",
    "rna evolution @xcite experiments have produced families of rna structures with pseudoknot motifs , when binding hiv-1 reverse transcriptase .",
    "@xmath0-noncrossing rna structures @xcite allow to express pseudoknots and generalize the concept of rna secondary structures in a natural way .",
    "due to their cross - serial interactions pseudoknot structures can not be recursively generated .",
    "this renders the _ ab initio _ folding into minimum free energy configurations @xcite as well as the derivation of detailed statistical properties a difficult task .",
    "a partial matching over @xmath2=\\{1,\\dots , n\\}$ ] is a labeled graph on @xmath2 $ ] , having vertices of degree at most one , represented by drawing its vertices in increasing order on a horizontal line and its arcs @xmath3 in the upper halfplane . without loss of generality",
    "we shall assume @xmath4 .",
    "two arcs @xmath5 and @xmath6 are crossing if @xmath7 holds and nesting if @xmath8 .",
    "a @xmath0-crossing is a sequence of arcs @xmath9 such that @xmath10 .",
    "there is an analogous notion of a @xmath0-nesting .",
    "a partial matching is called @xmath0-noncrossing ( @xmath0-nonnesting ) if it does not contain any @xmath0-crossing ( @xmath0-nesting ) . a partial matching without isolated vertices",
    "is called a matching .",
    "the numbers of @xmath0-noncrossing partial matchings and @xmath0-noncrossing matchings over @xmath2 $ ] are denoted by @xmath11 and @xmath12 , respectively .",
    "a @xmath0-noncrossing rna structure @xcite is a @xmath0-noncrossing partial matching without arcs of the form @xmath13 , @xmath14 .    for @xmath0-noncrossing partial matchings",
    "there exists no relation expressing @xmath0-noncrossing partial matchings over @xmath15 vertices via those over @xmath16 vertices as , for instance , the path - concatenation formula expressing motzkin - paths , see figure  [ f : sec ] , of length @xmath15 via shorter paths depending on whether the initial step is an up - step or a horizontal - step .",
    "flajolet _ et al .",
    "_ @xcite have shown how to uniformly generate via boltzman generators elements of a combinatorial class , for which such a recurrence exists . however , there is no comparable framework for the uniform generation of elements a non - inductive combinatorial class , a question arguably of pure mathematical interest .",
    "the subject of uniform generation via markov - processes has been studied extensively .",
    "a computational study on the uniform generation of random graphs via markov - chains has been given by @xcite .",
    "work on the uniform generation of specific graphs in the context of parallel random access machine ( pram ) can be found in @xcite and jerrum _ et al . _",
    "@xcite studied approximation algorithms in the context of rapidly mixing markov - chains @xcite .",
    "the motivation of this paper comes from the above mentioned rna pseudoknot structures @xcite , modeled as @xmath0-noncrossing partial matchings without @xmath17-arcs @xcite , see figure  [ f : pse ] .    at present time",
    "only a few statistical results , that is , central limit and discrete limit theorems , derived via singularity analysis of the corresponding bivariate generating functions are known @xcite .",
    "the results of this paper do not only facilitate the derivation of detailed statistics of rna pseudoknot structures but also open the door for studies along the lines of @xcite and novel , randomized folding routines .",
    "our algorithms are freely available at http://www.combinatorics.cn/cbpc/unif.html .",
    "our approach is as follows : we consider the bijection @xcite between @xmath0-noncrossing partial matchings and specific sequences of ferrers diagrams and then use the @xmath18-finiteness @xcite of the ordinary generating function . in some sense",
    ", @xmath18-finiteness is the next best thing if constructive recurrences are not available .",
    "@xmath18-finiteness implies @xmath1-recursiveness @xcite , i.e.  the existence of a finite recurrence relation for the cardinalities of the combinatorial class with polynomial coefficients .",
    "therefore the key quantities , i.e.  the transition probabilities of the specific stochastic processes can be derived with linear time complexity .",
    "[ s : bijection ]",
    "in this section we recall the main ideas on the bijection between @xmath0-noncrossing partial matchings and @xmath19-tableaux , a specific class of vacillating tableaux @xcite .",
    "the bijection facilitates the interpretation of @xmath0-noncrossing partial matchings and @xmath0-noncrossing structures as paths of the stochastic processes .",
    "a ferrers diagram , or shape , @xmath20 , is a collection of squares arranged in left - justified rows with weakly decreasing number of boxes in each row .",
    "a standard young tableau ( syt ) , denoted by @xmath21 , is a filling of the squares by numbers which is strictly decreasing in each row and in each column .",
    "we refer to standard young tableaux as young tableaux .",
    "elements can be inserted into syt via the rsk - algorithm @xcite .",
    "we will refer to syt simply as tableaux .",
    "a @xmath19-tableaux of shape @xmath20 and of length @xmath15 is a sequence of shapes @xmath22 , where @xmath23 , @xmath24 , such that for all @xmath25 , the shape @xmath26 is obtained from @xmath27 by either adding one square , removing one square , or doing nothing .",
    "a @xmath19-tableaux , in which any two subsequent shapes @xmath28 are different is called an oscillating tableaux .",
    "our first observation @xcite puts rsk - insertion into context with @xmath19-tableaux .",
    "it is the key for proving theorem  [ t : chen ] , which establishes the bijection between @xmath19-tableaux of empty shape and length @xmath15 , having at most @xmath29 rows and @xmath0-noncrossing , partial matchings on @xmath2 $ ] .",
    "it may be viewed as a `` reverse '' rsk , facilitating the construction of @xmath19-tableaux via partial matchings .",
    "@xcite[l : extract ] suppose we are given two shapes @xmath30 , which differ by exactly one square .",
    "let @xmath31 and @xmath32 be syt of shape @xmath27 and @xmath33 , respectively .",
    "then there exists a unique @xmath34 contained in @xmath31 and a unique tableau @xmath32 such that @xmath31 is obtained from @xmath32 by inserting @xmath34 via the @xmath35-algorithm",
    ".    we shall proceed by illustrating how the bijection @xcite works .",
    "given a @xmath19-tableaux of empty shape , @xmath36 , reading @xmath37 from left to right , at step @xmath38 , we do the following : + @xmath39 for a @xmath40-step we insert @xmath38 into the new square + @xmath39 for a @xmath41-step we do nothing + @xmath39 for a @xmath42-step we extract the unique entry , @xmath43 , of the tableaux @xmath44 , which via rsk - insertion into @xmath45 recovers it ( lemma  [ l : extract ] ) .",
    "the latter extractions generate the arc - set @xmath46 of a @xmath0-noncrossing , partial matching , see fig .",
    "[ f : tab - pm ] .    given a @xmath0-noncrossing partial matching ,",
    "we next construct a unique @xmath19-tableaux as follows : starting with the empty shape , consider the sequence @xmath47 and do the following : + @xmath39 if @xmath34 is the endpoint of an arc @xmath3 , then rsk - insert @xmath38 + @xmath39 if @xmath34 is the startpoint of an arc @xmath48 , then remove the square containing @xmath34 .",
    "+ @xmath39 if @xmath34 is an isolated point , then do nothing , see fig .",
    "[ f : pm - tab ] .",
    "+    the above construction leads to    @xcite[t : chen ] each @xmath19-tableaux of length @xmath15 , containing shapes with at most @xmath29-rows , corresponds uniquely to a @xmath0-noncrossing partial matching on @xmath2 $ ] .",
    "of course , the above bijection induces a correspondence between oscillating tableaux and @xmath0-noncrossing matchings .",
    "[ s : weyl ]",
    "suppose @xmath22 is a @xmath19-tableaux of shape @xmath20 having at most @xmath29 rows .",
    "let @xmath49 and @xmath50 denote the numbers of @xmath19-tableaux and oscillating tableaux of shape @xmath26 and length @xmath51 , respectively .",
    "in this section we establish that these quantities can be computed with @xmath52 time and space complexity .",
    "in addition , in the case of @xmath53 , we derive explicit formulas .      given a @xmath19-tableaux of shape @xmath20 , @xmath22 , where @xmath24 , we consider the number of squares in the @xmath54th row of shape @xmath26 , denoted by @xmath55 .",
    "it is evident that a @xmath19-tableaux of shape @xmath20 with at most @xmath29 rows uniquely corresponds to a walk of length @xmath15 which starts at @xmath56 and ends at @xmath57 having steps @xmath58 , @xmath59 such that @xmath60 at any step .",
    "that is , a @xmath19-tableaux of shape @xmath20 with at most @xmath29 rows corresponds to a lattice path in @xmath61 that remains in the interior of the dominant weyl chamber @xcite . for @xmath62 ,",
    "let @xmath63 denote a walk of length @xmath15 which starts at @xmath56 , ends at @xmath64 and that has steps @xmath58 , @xmath65 such that @xmath66 at any step .",
    "let @xmath67 be the number of such walks . for our purposes",
    ", it suffices to consider walks without @xmath68-steps . to this end , let @xmath69 denote a @xmath63-walk that does not contain any zero - steps and let @xmath70 denote their number . in case of @xmath71 , theorem  [ t : chen ]",
    "implies @xmath72 where @xmath20 represents the unique shape with at most @xmath29 rows that corresponds to the lattice point @xmath73 .",
    "let @xmath74 be the hyperbolic bessel function of the first kind of order @xmath75 .",
    "the following lemma is implied by the reflection principle @xcite and due to grabiner and magyar @xcite .",
    "it expresses the exponential generation functions of @xmath76 and @xmath77 via a determinant of bessel functions :    @xcite[l : gamma ] the exponential generating function for the numbers of @xmath0-noncrossing matchings , @xmath78 , is given by @xmath79|_{i , j=1}^{k-1}.\\ ] ]    consequently we have an algebraic relation for the exponential generating function .",
    "since @xmath18-finite functions form an algebra @xcite , the above relation implies , that the ordinary generating function @xmath80 is also @xmath18-finite .",
    "that is , the ordinary generating function of oscillating tableaux with at most @xmath29 rows of arbitrary shape @xmath20 , @xmath81 , is @xmath18-finite @xcite .",
    "since @xmath18-finitness is equivalent to the @xmath1-recursiveness @xcite , we have    [ c : recursive ] for fixed shape @xmath20 with at most @xmath29 rows and @xmath82 , there exists some @xmath83 and polynomials @xmath84 such that @xmath85 in particular , the numbers @xmath86 can be computed in @xmath52 time .",
    "the key point here is , that for given @xmath15 and @xmath20 , the derivation of eq .",
    "( [ e : recur ] ) is a preprocessing step .",
    "it has to be derived only once , for instance employing zeilberger s algorithm @xcite .",
    "@xmath87 let @xmath88 be a @xmath89-pair with the endpoints @xmath90 , @xmath91 and let @xmath92 denote the number of such pairs .",
    "a @xmath89-pair can readily be identified with a pair of non - intersecting paths , @xmath93 as follows : @xmath94 since @xmath93 are non - intersecting paths , lindstrm s theorem @xcite allows to compute @xmath92 . since @xmath95 , @xmath96 , @xmath97 and @xmath98 @xmath99 inserting two up - steps",
    ", we observe that @xmath100 uniquely corresponds to a path starting at @xmath101 and ending at @xmath102 of length @xmath103 , that does not cross the line @xmath104 and has only up- and down - steps . let @xmath105 denote the number of paths of length @xmath15 starting at @xmath106 and ending at @xmath107 , having up- and down - steps and that stay within the first quadrant . then @xcite    [ l:22 ] @xmath108    _ proof : _ clearly , there are @xmath109 paths having up- and down - steps , that start at @xmath106 and end at @xmath107 .",
    "we call such a path good , if it never touches the line @xmath110 and bad , otherwise . reflecting the segment of a bad path which starts at @xmath106 and ends at the first intersection point at the line @xmath110 , we observe that the set of bad paths is in one - to - one correspondence with the set of all paths having only up- and down - steps from @xmath111 to @xmath107 . subtracting the number of these paths , @xmath112 , from the number of all paths , the lemma follows",
    ".    we can now give explicit formulas for @xmath113 and @xmath114 @xcite    [ c:1 ] let @xmath115 denote the shape with at most two rows , where @xmath116 and @xmath117 .",
    "then we have @xmath118 @xmath119",
    "in this section we generate @xmath0-noncrossing partial matchings with uniform probability .",
    "the construction is as follows : first we compute for any shape @xmath20 , having at most @xmath29 rows , the recursion relation of corollary  [ c : recursive ] .",
    "second we compute the array @xmath120 , indexed by @xmath20 and @xmath51 .",
    "then we specify a markov - process that constructs a @xmath0-noncrossing partial matching with uniform probability with linear time and space complexity .",
    "[ t:1 ] random @xmath0-noncrossing partial matchings can be generated with uniform probability in polynomial time .",
    "the algorithmic implementation , see algorithm [ a:1 ] , has @xmath121 preprocessing time and @xmath122 space complexity .",
    "each @xmath0-noncrossing partial matching is generated with @xmath52 time and space complexity .    ' '' ''    [ a:1 ]     ' '' ''    @xmath123 binomial(@xmath15 ) ( computation of all binomial    coefficients , @xmath124 . )",
    "@xmath125 arrayp(n , k ) ( computation of @xmath49 , @xmath126    @xmath127 , @xmath26 , stored in the @xmath128 array ,    @xmath129 )    x[j]@xmath130 @xmath131    @xmath130 _ sum_+x[j ]    @xmath130 random(_sum _ ) ( random generates the random    shape @xmath132 )    @xmath133 @xmath134    @xmath135 insert _ shape _ into _ tableaux _ ( the sequence of shapes ) .",
    "@xmath136 * end while *    @xmath137 map(_tableaux _ ) ( maps _ tableaux _ into its corresponding    partial matching )    ' '' ''    figure  [ f:79 ] illustrates that * algorithm 1 * indeed generates each @xmath0-noncrossing partial matching with uniform probability .",
    "_ proof : _ suppose @xmath22 is a @xmath19-tableaux of shape @xmath20 having at most @xmath29 rows . by definition , a shape @xmath132 does only depend on its predecessor , @xmath33 .",
    "accordingly , we can interpret any given @xmath19-tableaux of shape @xmath20 as a path of a markov - process @xmath138 over shapes , given as follows : + @xmath39 @xmath139 and @xmath140 is a shape having at most @xmath29 rows + @xmath39 for @xmath141 , @xmath140 and @xmath142 differ by at most one square + @xmath39 the transition probabilities are given by @xmath143    we next observe @xmath144 where @xmath145 accordingly , the markov - process , @xmath138 , generates @xmath0-noncrossing partial matchings with uniform probability .",
    "clearly , the pascal triangle of binomial coefficients can be generated in @xmath146 time and space and for any fixed @xmath26 , having at most @xmath29 rows , we can via corollary  [ c : recursive ] compute @xmath147 in @xmath52 time .",
    "consequently , we can generate the array of numbers @xmath148 as well as @xmath49 for all shapes @xmath20 in @xmath149 time and @xmath122 space .",
    "the first factor @xmath52 represents the time complexity for deriving the recursion and the second comes from the computation of all numbers @xmath148 for fixed @xmath150 for all @xmath51 .    as for the generation of a random @xmath0-noncrossing partial matching , for each shape @xmath26",
    ", the transition probabilities can the be derived in @xmath151 time .",
    "therefore , a @xmath0-noncrossing partial matching can be computed with @xmath52 time and space complexity , whence the theorem.@xmath152",
    "in this section we generate @xmath0-noncrossing structures with uniform probability .",
    "the approach is analogous to that of the previous section , however the stochastic process required here is not a markov - process any more . in order to avoid generating arcs of the form @xmath13 ( @xmath17-arcs ) , some kind of one - step memory is needed .    to formalize this intuition",
    ", we shall begin by giving the formula for the number of @xmath0-noncrossing structures , or equivalently partial matchings without @xmath17-arcs @xcite @xmath153 we observe that a @xmath17-arc corresponds via theorem  [ t : chen ] to a subsequence of shapes @xmath154 , @xmath132 , @xmath155 , obtained by first adding and then removing a square in the first row .",
    "this sequence corresponds to a pair of steps @xmath156 , where @xmath157 and @xmath158 indicate that a square is added and subtracted in the first row , respectively .",
    "let @xmath159 denote the set of @xmath19-tableaux of shape @xmath33 of length @xmath51 having at most @xmath29 rows containing exactly @xmath34 pairs @xmath156 and set @xmath160 . furthermore , let @xmath161 denote the number of @xmath19-tableaux of shape @xmath26 with at most @xmath29 rows of length @xmath51 that do not contain any such pair of steps .",
    "_ proof : _ let @xmath164 be a @xmath19-tableaux of shape @xmath26 .",
    "we select from the set @xmath165 an increasing sequence of labels @xmath166 . for each @xmath167",
    "we insert a pair @xmath156 after the corresponding shape @xmath168 , see fig .",
    "[ f : square ] .",
    "this insertion generates a @xmath19-tableaux of length @xmath51 of shape @xmath26 .",
    "+    considering the above insertion for all sequences @xmath166 , we arrive at a family @xmath169 of @xmath19-tableaux of length @xmath51 containing at least @xmath64 pairs , @xmath156 . since we can insert at any position @xmath170",
    ", @xmath169 has cardinality @xmath171 . by construction , each @xmath19-tableaux @xmath172 , that exhibits exactly @xmath34 pairs @xmath156 appears with multiplicity @xmath173 , whence            [ t:2 ] a random @xmath0-noncrossing structure can be generated , after polynomial preprocessing time , with uniform probability in linear time .",
    "the algorithmic implementation , see algorithm  [ a:2 ] , has @xmath121 pre - processing time and @xmath122 space complexity .",
    "each @xmath0-noncrossing structure is generated with @xmath52 space and time complexity .",
    "for this purpose we index the shapes @xmath132 according to their predecessors : let @xmath208 and @xmath209 . setting @xmath210 , we write @xmath211 , if @xmath132 is obtained via + @xmath39 doing nothing ( @xmath212 ) + @xmath39 adding a square in the @xmath34th row ( @xmath213 ) + @xmath39 deleting a square in the @xmath34th row ( @xmath214 ) .",
    "+ with this notation , the number of good @xmath19-tableaux of shape @xmath215 of length @xmath216 is given as follows : @xmath217 in order to derive transition probabilities , we establish two equations : first , for any @xmath218 , where @xmath219 @xmath220 and second , in case of @xmath221 @xmath222 we are now in position to specify the process @xmath138 : + @xmath39 @xmath139 and @xmath140 is a shape having at most @xmath29 rows + @xmath39 for @xmath141 , @xmath140 and @xmath142 differ by at most one square + @xmath39 there exists no subsequence @xmath223 obtained by first adding and second removing a square in the first row + @xmath39 for @xmath219 @xmath224 @xmath39 for @xmath221 @xmath225 as in the proof of theorem  [ t:1 ] we observe that eq .",
    "( [ e : w0 ] ) and eq .",
    "( [ e : w1 ] ) imply @xmath226 consequently , the process @xmath138 generates random @xmath0-noncrossing structures with uniform probability in @xmath52 time and space .",
    "according to corollary  [ c : recursive ] , we can for any @xmath26 , having at most @xmath29 rows , compute @xmath227 in @xmath52 time .",
    "consequently , we can generate the arrays @xmath228 and @xmath229 in @xmath230 time and @xmath122 space ."
  ],
  "abstract_text": [
    "<S> in this paper we derive polynomial time algorithms that generate random @xmath0-noncrossing matchings and @xmath0-noncrossing rna structures with uniform probability . </S>",
    "<S> our approach employs the bijection between @xmath0-noncrossing matchings and oscillating tableaux and the @xmath1-recursiveness of the cardinalities of @xmath0-noncrossing matchings . </S>",
    "<S> the main idea is to consider the tableaux sequences as paths of stochastic processes over shapes and to derive their transition probabilities .    </S>",
    "<S> rna pseudoknot structure , @xmath0-noncrossing structure , uniform generation , oscillating tableaux , stochastic process </S>"
  ]
}