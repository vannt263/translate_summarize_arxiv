{
  "article_text": [
    "optics , aberration , matrices .",
    "an optical system can be effectively modelled in paraxial approximation by a product of @xmath0 matrices , each representing one elementary transformation of the light rays @xcite ; the elementary transformations are either translations of the ray in homogeneous media or the effects of surfaces separating different media .",
    "a more accurate approach implies the consideration of higher order terms but the fact that snell s law makes use of the sine function rules out the terms of even order ; as a consequence , when one wants to improve on the paraxial approximation , one has to consider third order terms .",
    "aberrations have already been studied extensively @xcite but work is still going on in order to design symbolic models of optical systems that computers can use for optimisation purposes and humans can look at to gain a better understanding of systems performance .    the matrix theory has been extended to deal with higher order terms @xcite through the use of a vector basis that incorporates two position and two orientation coordinates as well as all their third or higher order monomials , increasing the overall dimension which becomes 24 for third order approximation .",
    "it is possible to apply axis symmetry to reduce the matrix dimension through the use of complex coordinates and their higher order monomials ; for instance , in third order the matrices to be considered for axis - symmetric systems are @xmath1 @xcite .",
    "the set of four coordinates normally used to describe the ray consists of the two rectangular coordinates , @xmath2 and @xmath3 along with the two ray slopes @xmath4 and @xmath5 .",
    "i chose to replace the ray slopes with the direction cosines relative to the coordinate axes , respectively @xmath6 and @xmath7 , in order to allow an easier and more elegant formulation of the snell s law at a surface but at the expense of rendering the translation transformation non - linear .",
    "this work details a general method that can be used to establish all the coefficients needed for any order modelling of optical systems built with surfaces of unspecified shape .",
    "the power of the method is exemplified with determination of matrix coefficients for spherical systems in seventh order and for a toroidal surface in third order .",
    "the optical axis is assumed to lie along the @xmath8 axis , so the position of any point is determined by the two coordinates @xmath2 and @xmath3 ; when dealing with axis symmetric systems , the two coordinates can be combined in the complex coordinate @xmath9 .",
    "the ray orientation is defined by cosines of the angles with the @xmath2 and @xmath3 axes , respectively @xmath6 and @xmath7 ; again a complex orientation coordinate can be used , @xmath10 , in order to simplify the rotational treatment of axis symmetric systems .    using the same notation of reference @xcite",
    ", @xmath11 is the vector whose components are the coordinates and their monomials up to order @xmath12 : @xmath13 where total order @xmath14 is @xmath12 or less and odd , with all exponents greater than zero . by convention",
    "the vector elements are placed in the order of smaller @xmath12 and larger four digit number @xmath15 .",
    "any transformation of @xmath11 into @xmath16 can be represented by a square matrix @xmath17 of dimension @xmath18 equal to the size of @xmath11 , following the equation : @xmath19    the matrix @xmath17 has the following structure : @xmath20 the four submatrices that form @xmath17 have the following meaning : @xmath21 contains the paraxial constants of the optical system , @xmath22 has @xmath23 high order coefficients from the series expansion of the transformed coordinates , @xmath24 is composed of zeroes and finally @xmath25 is obtained from the elements of the first four lines by a procedure called extension whereby the elements of lines 5 to @xmath18 from @xmath16 are calculated and all terms of orders higher than @xmath12 are dropped . more specifically ,",
    "if we wish to determine the coefficients for the line corresponding to the monomial @xmath26 , we take the polynomial expressions for @xmath2 , @xmath3 , @xmath6 and @xmath7 from lines 1 to 4 and raise them to the powers @xmath27 , @xmath28 , @xmath29 and @xmath30 , respectively , making their product afterwards ; the result is a polynomial of degree @xmath31 from which only the terms of orders up to @xmath12 should be considered .",
    "the submatrix @xmath25 can itself be subdivided into components of different orders and components with all zero elements .",
    "although the ray transformation is described by an @xmath32 matrix , the above considerations show that only the @xmath23 elements from the first four lines need be considered , as the extension procedure is standard for all transformations . in cases where symmetry exists the number of independent coefficients",
    "can be greatly reduced @xcite .",
    "it is apparent that the matrix for any given transformation can be considered completely defined when the first four lines coefficients have been evaluated , i.e. when the transformed coordinates have been expressed in a power series of order @xmath12 .",
    "the coordinate conventions made above are not the same as those made in references @xcite and indeed by the majority of authors ; they may appear to be a poorer choice because , as we shall see , they lead to a non - linear translation transformation ; on the other hand they will simplify the determination of refraction coefficients .",
    "it should be noted , however , that a coordinate change can be seen as a transformation , itself governed by a matrix ; it is not difficult to follow the procedure outlined below and then change from cosines into slopes , if needed .",
    "the first elementary transformation that has to be considered is just the translation of the ray in an homogeneous medium ; the orientation coordinates do nt change but the position coordinates change according to the equations @xmath33 where @xmath34 is the distance travelled , measured along the optical axis .",
    "the series expansion of the equations is rather straightforward ; up to the seventh order it is : @xmath35    the previous equations give directly the coefficients for lines 1 and 2 of the matrix @xmath36 which describes the translation transformation ; lines 3 and 4 are made up of zeroes , except for the diagonal elements which are 1 ; this translates the two relations @xmath37 and @xmath38 .",
    "the lines 5 to @xmath18 can be obtained by the extension procedure described before .",
    "if slopes were used instead of direction cosines the translation matrix would have a much simpler form , corresponding to a linear transformation @xcite .",
    "the influence of the surface power on the ray coordinates must now be considered .",
    "it is useful to analyse separately the changes on the ray orientation and the modification of the position coordinates .",
    "the ray orientation changes due to the application of snell s law when the ray encounters the surface of separation between the two media ; let this surface be defined by the general formula : @xmath39    let a ray impinge on the surface on a point of coordinates @xmath2 and @xmath3 with direction cosines @xmath6 and @xmath7 .",
    "the normal to the surface at the incidence point is the vector : @xmath40 the direction of the incident ray is the unit vector : @xmath41 and the refracted ray has a direction which is represented by the vector : @xmath42 where @xmath43 and @xmath44 are the direction cosines after refraction .",
    "one can apply snell s law by equating the cross products of the ray directions with the normal on both sides of the surface multiplied by the respective refractive indices : @xmath45 where @xmath46 represents the refractive index ratio of the two media .",
    "the algebraic solutions of the equation above can be found for many surfaces by means of suitable symbolic processing software like mathematica ; in certain cases the solution is easier to find after a suitable change of coordinates along the @xmath8 axis , which will not affect the final result ; for instance , for a spherical surface it is convenient to shift the coordinate origin to the center . in order to find the coefficients for the matrix @xmath47 , representing the change in the ray orientation",
    ", the explicit expressions for @xmath43 and @xmath44 must be expanded in series ; this can again be programmed into mathematica .",
    "the examples given later show this procedure for two different surfaces .",
    "the use of just two position coordinates implies that these are referenced to a plane normal to the axis .",
    "when a ray is refracted at a surface , the position coordinates that apply are those of the incidence point ; nevertheless the translation to the surface is referenced to the vertex plane and thus the position coordinates that come out of the translation transformation , are those of the intersection with that plane ; the difference between the two positions is named surface offset .",
    "the figure [ offset ] illustrates the problem that must be solved : the reference plane for the position coordinates of the ray in a refraction process is the plane of the surface vertex ; the coordinates of the point of intersection of the ray with this plane are not the same before and after the refraction .",
    "the surface matrix must account not only for the orientation changes but also for the position offset introduced by the refraction process .",
    "if the origin of the rectangular coordinates is located at the vertex and @xmath48 are the coordinates of the ray when it crosses the plane of the vertex , the current coordinates of a point on the incident ray are given by the two equations : @xmath49    as the intersection point has to verify both ( [ eq : offset1 ] ) and ( [ eq : surface ] ) it is possible to solve a system of three simultaneous equations to determine its coordinates .",
    "in fact there may be several intersection points , as the ray may intercept a complex surface in several points ; it is not difficult , however , to select the solution of interest by careful examination of the surface region that has been hit ; we are usually interested in the solution that has the smallest @xmath50 value .    as before a series expansion of the exact expressions of @xmath51 and @xmath52",
    "must be performed taking only the terms up to the @xmath12th order ; this will yield the coefficients for the matrix @xmath53 which describes the transformation from point @xmath54 to point @xmath55 and will be called the forward offset .",
    "the offset from point @xmath55 to point @xmath56 , designated backward offset , is the reverse transformation of the forward offset , for a ray whose direction coordinates have been modified by refraction .",
    "we solve ( [ eq : offset1 ] ) and ( [ eq : surface ] ) in terms of @xmath2 and @xmath3 and apply the previous procedure to determine the coefficients of the transformation matrix , @xmath57 .    the matrix describing the transformations imposed by the surface is the product @xmath58 , as the ray has to suffer the three successive transformations : forward offset , refraction and backward offset .",
    "the surface matrix is called @xmath59 .",
    "the entrance pupil of the optical system plays an important role in the overall aberrations ; the center of the pupil defines the chief ray , which determines the paraxial image point .",
    "the ray fan usually extends equally in all directions around the chief ray and the points of intersection of the various rays in the fan with the image plane determine the ray aberrations . when matrices are used to model the system the image appears described in terms of the position and orientation coordinates of the rays when these are subjected to the first transformation , be it a refraction or a translation ; in terms of ray aberrations this corresponds to a situation where the object is located at infinity and the entrance pupil is placed where the first transformation takes place .",
    "in fact , the orientation coordinates play the role of object coordinates and the position coordinates are the actual pupil coordinates , if this coincides with the first transformation ; the chief ray can be found easily just by zeroing the position coordinate .",
    "ray aberrations can be evaluated correctly if the image is described in terms of both object and stop coordinates or some appropriate substitutes ; an object point is then set by the object coordinates , the paraxial image point is found when the stop coordinate is zero and the aberrations are described by the differences to this point .",
    "this can be done adequately when the stop is located before the first surface and so coincides with the entrance pupil .",
    "if the object is at infinity the problem is very easy to solve and application examples have already been described @xcite .",
    "if the entrance pupil is located at the position @xmath60 relative to the first surface , this means that the rays must perform a translation of @xmath61 prior to hitting it ; this can be accommodated via the right product by a translation matrix @xmath62 , where the index indicates the amount of translation .",
    "[ htb ]    the case of near objects is more difficult to deal with because we are faced with a dilemma : if a translation from the pupil position to the first surface is applied the position coordinates of the incident rays become pupil coordinates but the rays origins on the object are lost .",
    "conversely we can apply a translation from the object position , ending up with the reverse problem of knowing the rays origins and ignoring their point of passage through the pupil .",
    "we need the position coordinates both at the object and pupil location ; this suggests that the ray s orientation should be specified not by its direction cosines but by the coordinates of the point of passage through the pupil . in figure [ pupil ]",
    "a ray leaves an object point of coordinates @xmath63 and crosses the entrance pupil plane at a point of coordinates @xmath64 ; then the direction cosines , @xmath6 and @xmath7 can be calculated by : @xmath65 where @xmath66 is the position of the pupil relative to the object .    the matrix theory developed before",
    "was based on direction cosines rather than pupil coordinates ; in consequence a coordinate change is needed before the translation from the object to the first surface is applied to the rays .",
    "rather than use equations ( [ eq : pupil ] ) it is more convenient to look at them as a coordinate change governed by a matrix @xmath67 ; for the determination of its coefficients we apply the standard procedure of series expansion .",
    "the following is the result for 7th order : @xmath68 a similar expression exists for @xmath7 .",
    "the equation above allows the determination of the coefficients for matrix @xmath67 which converts the coordinates @xmath69 into @xmath70 before the rays enter the system at the object position ; as a symmetrical conversion is not performed when the rays leave the system , there is no place for the use of matrix @xmath71 , as would be the case in a similarity transformation .",
    "a case study would involve the following successive steps :    * determine the matrices for all the translation and refraction transformations suffered by the ray from the object point to the image plane . *",
    "determine the matrix @xmath67 , relative to the entrance pupil position .",
    "* multiply all the matrices in reverse order , starting with the translation from the last surface to the image plane and ending with matrix @xmath67 ; the result is matrix @xmath17 . * determine a vector base @xmath11 with the set of coordinates @xmath72 .",
    "* make the product @xmath73 .",
    "once @xmath16 has been calculated , its first four elements are polynomials of @xmath12th degree on the independent variables @xmath72 , which model the position and direction cosines of the rays on the image plane .",
    "most optical systems have stops located after the first surface , and so the method described above is not adequate .",
    "one can always find the gaussian entrance pupil of any system and so revert to the previous situation ; this will work even if the entrance pupil is found to lie beyond the first surface , in which case it will give rise to a negative translation .",
    "the problem is that the gaussian entrance pupil is a first order transformation of the stop , whereas the real entrance pupil is an aberrated image of the stop given by the portion of the optical system that lies before it .",
    "ideally one should try to describe the image in terms of the object coordinates and the point of passage through the stop , which can be rather difficult .",
    "alternatively one can find a reference ray , defined as the ray that passes through the center of the stop and is not necessarily the same as the chief ray , and work with position and orientation coordinates on the image plane , relative to the reference ray .",
    "the plot of the relative ray position versus its relative direction cosines can be used to describe ray aberrations @xcite .",
    "a sphere of radius @xmath74 with its center at @xmath75 is defined by the equation : @xmath76 this equation will replace ( [ eq : surface ] ) in the algorithm for the determination of matrix coefficients . in a previous work @xcite we presented the results for third order ; these are now extended to seventh order .",
    "this is a situation where symmetry must be considered in order to reduce the size of the matrices involved ; we use the complex variables @xmath54 and @xmath77 previously defined , leading to a complex vector base @xmath78 whose elements have the general form @xmath79 with @xmath80 and @xmath81 representing the complex conjugates of @xmath54 and @xmath77 .",
    "kondo et al . @xcite",
    "have shown that the powers must obey the condition @xmath82 ; for seventh order the allowable combinations are : @xmath83    equation ( [ eq : snell ] ) can now be solved and the resulting expressions for @xmath43 and @xmath44 can be expanded in series up to the seventh order ; the results can be combined into one complex variable @xmath84 . the second column of table [ t : spherical ] lists the coefficients for this expansion . similarly the forward offset coefficients can be found solving equations ( [ eq : offset1 ] ) and combining @xmath51 and @xmath52 expansions into one single complex variable @xmath55 ; the resulting coefficients are listed in column 3 of table [ t : spherical ] .",
    "the backward offset coefficients are obtained in a similar way , although now it is the @xmath2 and @xmath3 expansions that must be combined into a single complex variable @xmath56 .",
    "toroidal surfaces are used to correct eye astigmatism ; they can be fabricated easily without resorting to sophisticated machinery . in this example",
    "we deem to show that the method is applicable to general surfaces but it is not our purpose to list high order coefficients for this particular shape ; therefore we will restrict the study to third order .",
    "also , as there is no rotational symmetry we will not use complex coordinates ; there is symmetry relative to two perpendicular planes and if we were to use complex coordinates the terms should obey the condition @xmath85 as explained in reference @xcite ; we feel that it is clearer not to invoke symmetry at all .",
    "the surface is generated by a circle of radius @xmath86 normal to the @xmath87 plane whose center is displaced along a circle of radius @xmath88 laying on this plane .",
    "this surface has curvature radii of @xmath86 and @xmath89 respectively on the @xmath87 and @xmath90 planes .",
    "the surface equation can be written as : @xmath91    the solution of equation ( [ eq : snell ] ) originates the expressions for @xmath43 and @xmath44 ; these are then expanded in series up to the third order and the resulting coefficients are listed in columns 2 and 3 of table [ t : toroid ] . the same procedure was applied to the expressions for @xmath51 and @xmath52 resulting from equation ( [ eq : offset1 ] ) ; columns 4 and 5 of the same table list these coefficients .",
    "the backward offset coefficients need not be listed , as in third order they can be obtained by sign reversal from the forward offset coefficients .",
    "matrices can be used to model optical systems built with surfaces of unspecified shape to any desired degree of approximation .",
    "the method that was described differs from those found in literature by the choice of direction cosines rather than ray slopes to specify ray orientations .",
    "this results in a very elegant formulation of snell s law which can be easily programmed into symbolic computation software . in spite of some added complication in translation matrices the algorithm",
    "is limited only by computing power in it s ability to determine the matrix coefficients , irrespective of surface complexity and order of approximation . for axis - symmetric systems the matrices have a dimension @xmath92 for seventh order and",
    "can usually be dealt with by ordinary pcs ; the influence of stops can also be incorporated in the matrix description as was demonstrated .",
    "the unconventional coordinate system that was used can , if needed , be converted to the more usual ray slope coordinate system through the product with conversion matrices of the same dimension .",
    "two examples were shown for illustration of the method s capabilities ; the first one supplies a list of seventh order coefficients for systems made up with spherical surfaces and allows the reader an immediate use .",
    "the second example applies the method to a fourth degree toroidal surface , showing that complex shapes can be accommodated .",
    "almeida , `` the use of matrices for third order modeling of optical systems '' , in _ international optical design conference _ , k.p .",
    "thompson and l.r .",
    "gardner , eds .",
    "spie * 3482 * , 917 - 925 , ( 1998 ) ."
  ],
  "abstract_text": [
    "<S> the non - linear transformations incurred by the rays in an optical system can be suitably described by matrices to any desired order of approximation . in systems composed of uniform refractive index elements </S>",
    "<S> , each individual ray refraction or translation has an associated matrix and a succession of transformations correspond to the product of the respective matrices . </S>",
    "<S> this paper describes a general method to find the matrix coefficients for translation and surface refraction irrespective of the surface shape or the order of approximation . </S>",
    "<S> the choice of coordinates is unusual as the orientation of the ray is characterised by the direction cosines , rather than slopes ; this is shown to greatly simplify and generalise coefficient calculation . </S>",
    "<S> two examples are shown in order to demonstrate the power of the method : the first is the determination of seventh order coefficients for spherical surfaces and the second is the determination of third order coefficients for a toroidal surface . </S>"
  ]
}