{
  "article_text": [
    "this paper is devoted to exploring a weak formulation and an accompanying numerical technique for the schrdinger equation with dirichlet boundary conditions .",
    "let @xmath0 @xmath1 be an open bounded domain with lipschitz boundary .",
    "the space variable @xmath2 lies in @xmath3 while the time variable @xmath4 lies in the open interval @xmath5 with @xmath6 .",
    "the classical form of schrdinger initial boundary value problem reads as follows :    [ eq : ls2 ] @xmath7    where @xmath8 denotes the time derivative @xmath9 and @xmath10 denotes the laplacian with respect to the spatial variable  @xmath2 . here",
    "@xmath11 is any given function in @xmath12 and @xmath13 throughout .",
    "the numerical technique we want to apply to   is the discontinuous petrov - galerkin ( dpg ) method  @xcite . among its desirable properties",
    "are mesh independent stability , inheritance of discrete stability from the wellposedness of the undiscretized problem , and the availability of a canonical error indicator computed as part of the solution .",
    "the dpg method has been successfully applied to a wide variety of problems such as second order elliptic problems  @xcite , convective phenomena  @xcite , elasticity  @xcite , stokes flow  @xcite , and spacetime problems  @xcite .",
    "it seems natural therefore that the dpg method should work for   as well . in this paper",
    ", we will show that the dpg method does indeed faithfully approximate the solutions of   we do not recast   into a first order system .",
    "many applications of interest come as a first order system even if they are often displayed as second order partial differential equations .",
    "for example , the second order heat equation is really a combination of two first order equations , namely the fourier law of heat conduction and the conservation of energy .",
    "similarly , the linear elasticity equation while often displayed as a second order equation for displacement , is really a combination of the two first order equations , the constitutive ( hooke s ) law and the equation of static equilibrium .",
    "thus its no surprise that it makes physical sense to bring back the heat equation or the elasticity equation to first order form before discretizing .",
    "however , it makes no physical sense to do this for the schrdinger equation as its not derived from first order physical laws .",
    "it makes no mathematical sense either .",
    "one might be tempted to introduce a `` flux '' @xmath14 formulate the first order system @xmath15 and @xmath16 and claim its equivalence to   when @xmath17 this claim is false because while the schrdinger problem   is wellposed for @xmath18 , _ the first order system can not be wellposed in @xmath19 _ indeed , denoting the norm of @xmath20 by @xmath21 , if the first order system were wellposed , then there are constants @xmath22 such that @xmath23 but then the second equation of the system implies that @xmath24 for any solution  @xmath25 , which is false : in the next two paragraphs we will exhibit a schrdinger solution for which @xmath26 even when @xmath27 and @xmath18 .    first observe that given any @xmath28 in @xmath20 , it is possible to solve   by the `` method of galerkin approximations ''  @xcite ( distinct from the galerkin finite element method ) .",
    "let @xmath29 in @xmath30 and @xmath31 be an eigenpair of @xmath10 satisfying @xmath32 normalized so that @xmath33 for all natural numbers @xmath34 . since fubini s theorem for product measures implies that @xmath35 is in @xmath36 , the following definitions make sense :    [ eq : fkukfmum ] @xmath37    it is not difficult to show ( see the proof of theorem  [ thm : strong ] below ) that @xmath38 exists in @xmath20 and solves  .",
    "now consider the one - dimensional case @xmath39 where @xmath40 and choose @xmath41 then by the orthonormality of @xmath42 , we have that @xmath43 , @xmath44 , @xmath45 the solution @xmath25 is the limit of @xmath46 .",
    "the above calculations clearly show that as @xmath47 , while @xmath48 , the limit of @xmath49 diverges . _",
    "thus it is possible to obtain a schrdinger solution @xmath25 whose @xmath50-norm is infinite even when @xmath18 .",
    "_ note that finer arguments are needed to understand the regularity of schrdinger solutions in unbounded domains , which although a topic of wide mathematical interest  @xcite , is not our concern here .    to our knowledge , this paper is the first work to analyze the feasibility of the dpg methodology for a system without ready access to an equivalent first order formulation .",
    "the second order form necessitates formulations in the non - standard graph spaces of the second order schrdinger operator .",
    "one of the contributions of this paper is the proof of wellposedness of a strong and a weak formulation of   in these graph spaces .",
    "the general spaces and arguments required for this analysis are collected in a standalone appendix  [ apn : weak ] anticipating uses outside of the schrdinger example . the analysis in appendix  [ apn : weak ]",
    "is motivated by the modern theory of friedrichs systems  @xcite but applies beyond friedrichs systems .",
    "borrowing the approach of  @xcite , we are able to prove wellposedness without developing a trace theory for the graph spaces .",
    "the other contributions involve the numerical implications of this wellposedness .",
    "numerical methods using the strong formulation must use conforming finite element subspaces of the graph spaces .",
    "on the other hand , numerical methods using the weak formulation need only use existing standard finite element spaces . in either case ,",
    "an interpolation theory in the schrdinger graph norm is needed to estimate convergence rates .",
    "we address this issue in one space dimension .    in the next section ,",
    "we investigate wellposedness ( in the sense of hadamard ) for a strong and weak variational formulation for the schrdinger problem .",
    "this will require an abstract definition of a boundary operator and duality pairings in a graph space .",
    "such abstract definitions that apply beyond the schrdinger setting are in appendix  [ apn : weak ] .",
    "their particular realizations for the schrdinger case are used in section  [ sec : schrodinger ] . to avoid repetitions of the general definitions in the specific case",
    ", we will often refer to appendix  [ apn : weak ] in section  [ sec : schrodinger ] .",
    "section 3 provides a verification of a density assumption made in section 2 .",
    "section 4 details our construction of a conforming finite element space and interpolation error estimates .",
    "section 5 points to an application in dispersive optical fibers and contains some numerical results .",
    "we now provide a functional setting within which a strong and a weak formulation of the spacetime schrdinger problem can be proved to be well posed ( i.e. , _ inf - sup _ stable ) .",
    "the analysis is an application of the general theory detailed in appendix  [ apn : weak ] .",
    "the classical form of the problem is already presented in  . recalling that @xmath51 , define these parts of @xmath52 : @xmath53 \\cup { { \\varomega}}_0 \\times \\{0\\ } , \\qquad   { \\vargamma}^ * = \\partial { { \\varomega}}_0 \\times [ 0,t ] \\cup { { \\varomega}}_0 \\times \\{t\\}\\ ] ] ( see fig .  [",
    "fig : domain ] ) . then the initial and boundary conditions together can be written as @xmath54 .",
    "we want to write   as an operator equation ( see  ) to apply the general results of appendix  [ apn : weak ] .",
    "to this end , consider the setting of appendix  [ apn : weak ] with @xmath55 the space @xmath56 is then defined by   and the operator @xmath57 is defined by  . as usual , let @xmath58 denote the restrictions of functions from @xmath59 to @xmath60 .",
    "the operator @xmath61 ( often called the `` boundary operator '' in the theory of friedrichs systems  @xcite ) , satisfies @xmath62 for all @xmath63 .",
    "note that the integrals on the right hand side may not exist for all functions in @xmath64 .",
    "however , @xmath61 is defined on all @xmath64 through  .",
    "although we set the differential operators @xmath65 and @xmath66 to be equal above , note that we consider each as an unbounded operator with its own domain .",
    "we set the domain of @xmath65 to @xmath67 where @xmath68 the adjoint of the schrdinger operator @xmath65 is the same differential operator @xmath69 , but has a different domain .",
    "the domain of the adjoint is given by the usual  @xcite general prescription : @xmath70 there is an @xmath71 such that @xmath72 for all @xmath73 here @xmath74 denotes the ( complex ) inner product in @xmath20 .",
    "finally , as in the appendix , set @xmath75 and @xmath76 with the understanding that both @xmath77 and @xmath78 are endowed with the @xmath64-topology , while @xmath79 and @xmath80 have the topology of @xmath20 .",
    "( top ) at ( 0,2 ) ; ( bot ) at ( 2.5,0 ) ; ( lft ) at ( 0,0 ) ; ( rgt ) at ( 2.5,2 ) ;    ( lft ) ",
    "node[midway , fill = white ] @xmath3 ( bot ) ; ( top ) ",
    "node[midway , fill = white ] @xmath81 ( rgt ) ; ( rgt ) ",
    "node[midway , fill = white ] @xmath81 ( bot ) ; ( top ) ",
    "node[midway , fill = white ] @xmath81 ( lft ) ;    ( bot )  ( rgt )  ( top )",
    "(lft ) ; ( 2.5,0 )  ( @xmath82 ) node[below ] @xmath2 ; ( 0,2 )  ( @xmath83 )",
    "node[left ] @xmath4 ;    ( top ) at ( 0,2 ) ; ( bot ) at ( 2.5,0 ) ; ( lft ) at ( 0,0 ) ; ( rgt ) at ( 2.5,2 ) ;    ( rgt ) ",
    "node[midway , fill = white ] @xmath84 ( bot ) ; ( top ) ",
    "node[midway , fill = white ] @xmath84 ( lft ) ; ( lft ) ",
    "node[midway , fill = white ] @xmath84 ( bot ) ;    ( bot )  ( rgt )  ( top )",
    "(lft ) ;    at ( 1.25,1.75 ) @xmath60 ; ( 2.5,0 )  ( @xmath82 ) node[below ] @xmath2 ; ( 0,2 )  ( @xmath83 )",
    "node[left ] @xmath4 ;    we readily verify that the conditions of   are satisfied by the above set @xmath85 and @xmath79 .",
    "hence lemma  [ lem : v1 ] shows that @xmath80 equals @xmath86 rewriting   in the same style , @xmath87 thus @xmath77 and @xmath78 are closed subspaces of @xmath64 .",
    "let @xmath88 .",
    "[ lem : vvsubset ] @xmath89 and @xmath90 .",
    "equation   implies @xmath91 for all @xmath92 and @xmath93 hence , any @xmath94 is also in @xmath95 which by   implies that @xmath92 .",
    "thus @xmath89 .",
    "if @xmath96 , then   shows that @xmath97 for all @xmath98 , i.e. , @xmath99 which by   implies @xmath100 is in @xmath78 .    in  ,",
    "@xmath101 may be replaced by @xmath78 provided a density result is available , as we show next .",
    "[ asm : dense ] suppose @xmath101 is dense in @xmath78 and @xmath102 is dense in @xmath77 .",
    "[ lem : vdv * ] if assumption  [ asm : dense ] holds , then @xmath103 and @xmath104    clearly @xmath105 implies @xmath106 to prove the reverse containment , suppose @xmath107 and @xmath108 . by density",
    ", there is a sequence @xmath109 in @xmath101 satisfying @xmath110 .",
    "since @xmath111 by continuity of @xmath61 , we have @xmath112 hence @xmath113 .",
    "the second identity is proved similarly .",
    "the strong formulation of the schrdinger problem   is based on these sesquilinear and conjugate linear forms : @xmath114    [ prb : strong ] _ given any @xmath18 , find @xmath98 satisfying @xmath115 _    [ thm : strong ] suppose assumption  [ asm : dense ] holds . then the linear schrdinger operator @xmath116 is a continuous bijection .",
    "hence problem  [ prb : strong ] is well posed .    to prove the surjectivity of @xmath65 ,",
    "suppose @xmath18 .",
    "recall the definitions of @xmath42 , @xmath117 and @xmath118 from   and  .",
    "clearly , @xmath119 .",
    "since @xmath46 and any @xmath120 are smooth enough for integration by parts using @xmath121 and @xmath122 we have @xmath123 hence @xmath124 for all @xmath125 by  , this implies that @xmath46 is in @xmath77 .",
    "next , we show that @xmath46 is a cauchy sequence in @xmath77 . for any @xmath126 , @xmath127",
    "both of which converge to 0 as @xmath47 , because @xmath18 .",
    "thus @xmath46 is cauchy .",
    "it must therefore have an accumulation point @xmath25 in @xmath77 . moreover , since @xmath128 and @xmath11 are @xmath20-limits of the same sequence @xmath129 , we have @xmath130 .",
    "thus @xmath131 is surjective .",
    "we use a similar argument ( with @xmath117 defined by integrals from @xmath132 to @xmath4 ) to show that @xmath133 is also surjective .",
    "we omit the details , but note that the only difference is that instead of  , we must now use @xmath134 which follows from  , assumption  [ asm : dense ] and lemma  [ lem : vdv * ] .",
    "finally , since @xmath135 , the surjectivity of @xmath136 shows that @xmath137 is injective , thus completing the proof of the stated bijectivity .",
    "an example of a standard wellposedness result for the schrdinger equation obtained using semigroup theory is ( * ? ? ? * theorem  4.8.1 ) , which proves that there is one and only one solution to   whenever @xmath138 and @xmath139 is in @xmath140 . in theorem",
    "[ thm : strong ] , we have shown ( by a different method ) that the existence of a unique solution holds for any @xmath18 .",
    "note that in the above proof , we used assumption  [ asm : dense ] only to obtain injectivity . if one opts to use the results of  @xcite ( with @xmath141 and @xmath138 ) to conclude injectivity , then there is no need to place assumption  [ asm : dense ] in theorem  [ thm : strong ] .",
    "now we consider a mesh - dependent weak formulation that is the basis of the dpg method .",
    "this formulation , sometimes called the `` ultraweak '' formulation , is given in a general setting in problem  [ prb : weak ] of appendix  [ apn : weak ] .",
    "we apply this to our example of the schrdinger equation .",
    "the spacetime domain @xmath60 is partitioned into a mesh @xmath142 of finitely many open elements @xmath143 such that @xmath144 where @xmath145 .",
    "applying the general definitions in appendix  [ apn : weak ] to the schrdinger example ( see   through  ) , we set @xmath146 @xmath147 , @xmath148 and @xmath149 . denoting the duality pairing in @xmath150 by @xmath151 ,",
    "define the sesquilinear form @xmath152 on @xmath153 .    [",
    "prb : weakschrodinger ] _ given @xmath154 find @xmath155 and @xmath156 such that @xmath157 _    [ thm : uw_schrod ] suppose assumption  [ asm : dense ] holds",
    ". then problem  [ prb : weakschrodinger ] is well posed , i.e. , there is a @xmath158 such that given any @xmath159 , there is a unique solution @xmath160 to problem  [ prb : weakschrodinger ] and it satisfies @xmath161 moreover , if @xmath162 for some @xmath163 then  @xmath25 is in  @xmath77 and @xmath164 .",
    "the result follows from theorem  [ thm : wellposed - mesh ] . since lemma  [ lem : vdv * ] together with   implies   and theorem  [ thm : strong ] implies  , the assumptions of theorem  [ thm : wellposed - mesh ] are verified .",
    "in the next three sections , @xmath3 is set to be the interval @xmath165 and @xmath166 where @xmath167 the purpose of this section is to verify the density assumption ( assumption  [ asm : dense ] ) in this case of one space dimension .",
    "[ thm : dense ] let @xmath168 .",
    "then @xmath169 is dense in @xmath78 and @xmath170 is dense in @xmath171    since the proofs of both the stated density results are similar , we will only show the proof of density of @xmath101 in @xmath78 .",
    "_ _ let @xmath172\\times ( 0,t)$ ] and @xmath173 .",
    "define an operator @xmath174 that extends functions on @xmath60 to @xmath175 by @xmath176 ( and @xmath177 for all @xmath178 ) .",
    "let @xmath179 be the reverse operator that maps functions on @xmath180 to @xmath60 by @xmath181 for all @xmath178 ( see figure  [ fig : density ] ) .",
    "such definitions are to be interpreted a.e .",
    ", so that for example , @xmath182 is well defined for any @xmath183 in @xmath20 .",
    "it is easy to see by a change of variable that @xmath184    next , we claim that @xmath185 clearly , @xmath186 is in @xmath187 .",
    "let @xmath188 .",
    "the action of the distribution @xmath189 on @xmath190 equals @xmath191 because of  . by the chain rule applied to the smooth function @xmath192 , we find that @xmath193 hence , @xmath194 now observe that @xmath195 .",
    "hence by lemma  [ lem : vvsubset ] , @xmath196 is in @xmath77 . since @xmath197 and @xmath198 , the last term of   must vanish by  .",
    "thus @xmath199 completing the proof of the claim  . in view of",
    ", we conclude that @xmath186 is in @xmath200 whenever @xmath201 .",
    "( 2,0)(2,1.5)(4,1.5)(4,0)cycle ; ( 0,0 ) (0 , 1.5)(2,1.5)(2,0)cycle ; ( 4,0 ) (4,1.5)(6,1.5)(6,0)cycle ; ( 0.8 , 1 ) node [ below ] @xmath202 ; ( 5 , 1 ) node [ below ] @xmath203 ; ( 3 , 1 ) node [ below ] @xmath204 ; ( -.2 , 1.9 ) node [ below ] @xmath180 ; ( 2 , -0.5-.3 )  ( 2 , 2 ) node[left ] @xmath4 ; ( -0.5 , 0 )  ( 7 , 0 ) node[below ] @xmath2 ; at ( -.3,-0.2 ) @xmath205 ; at ( 4,-0.2 ) @xmath206 ; at ( 6.3,-0.2 ) @xmath207 ; at ( 2,0 ) ; at ( 2,-.2 ) @xmath208 ; at ( 3,-.6 ) @xmath209 ; at ( 3,1.7 ) @xmath210 ;    ( 5.5,1.7 ) edge [ bend left ] node[above ] @xmath211 ( 7.7,1.7 ) ;    ( 4,0)(4,2.1 - 0.6)(6,2.1 - 0.6)(6,0)cycle ; ( 2,0)(2,2.1 - 0.6)(4,2.1 - 0.6)(4,0)cycle ; ( 0,0)(0,2.1 - 0.6)(2,2.1 - 0.6)(2,0)cycle ;    ( 6,2.1 - 0.3 )  ( 6,2.1 )  ( 0,2.1 ) (0,2.1 - 0.3 ) ; ( 0,0.3 ) (0,0 )  ( 6,0 )  ( 6,0.3 ) ;    ( 0,0+.3 ) (0,1.5+.3)(6,1.5+.3)(6,0+.3)cycle ; ( 3 , 1+.3 ) node [ below ] @xmath212 ; ( 2 , -0.5 )  ( 2 , 2+.6 ) node[left ] @xmath4 ; ( -0.5 , 0+.3 )  ( 7 , 0+.3 ) node[below ] @xmath2 ; ( 6 , 2.7 ) node [ below ] @xmath213 ; at ( -.3,0.1 ) @xmath205 ; at ( 4,0.1 ) @xmath206 ; at ( 6.3,0.1 ) @xmath207 ; at ( 2,0+.3 ) ; at ( 2,+.1 ) @xmath208 ;    ( 5,2.1 + 0.2)(5,2.1 ) ; ( 5,2.1 - 0.5)(5,2.1 - 0.3 ) ; at ( 5,2.1 - 0.15 ) @xmath214 ;    _ _ let @xmath215 denote extension of @xmath216 by zero to @xmath217 , i.e. , @xmath215 equals @xmath216 on @xmath218 and equals zero elsewhere .",
    "let @xmath219 be the translation operator in the @xmath220 direction by @xmath214 , i.e. , @xmath221 its well known ( @xcite ) that @xmath222 let @xmath223 and let @xmath224 denote the restriction of functions on @xmath217 to @xmath225 . by a change of variable , @xmath226",
    "we now claim that @xmath227 indeed , for any @xmath228 , the action of the distribution @xmath229 on @xmath190 equals @xmath230 where we have used  , , and   consecutively . since @xmath231 lemma  [ lem : vvsubset ] shows that @xmath232 is in @xmath77 , and consequently the last term above vanishes for all @xmath197 . continuing and using   and   once more ,",
    "@xmath233 this proves  .",
    "_ _ consider the mollifier @xmath234 , for each @xmath235 , defined by @xmath236 where @xmath237 and @xmath238 is a constant chosen so that @xmath239 it is well known ( @xcite ) that when any function @xmath183 in @xmath240 is convolved with @xmath241 , the result @xmath242 is infinitely smooth and satisfies @xmath243 consider any small enough @xmath244 , say @xmath245 , and define two functions @xmath246 and @xmath247 note that the two smooth functions @xmath248 and @xmath249 need not coincide everywhere .",
    "however , because of  , they coincide on @xmath60 whenever @xmath250 : @xmath251 let us therefore set @xmath214 to , say , @xmath252 and let @xmath253 go to zero .",
    "note that @xmath254 using   and   it now immediately follows that @xmath255    to conclude , examine the value of @xmath256 at points @xmath257 for any @xmath258 , namely @xmath259 the integrand of the inner integral is the product of an even function @xmath260 of @xmath261 and an odd function @xmath262 of @xmath261 .",
    "hence @xmath263 .",
    "the same holds for points @xmath264 .",
    "moreover , since @xmath265 is identically zero in a neighborhood of @xmath266 for all @xmath267 , we conclude that @xmath268",
    "continuing to consider the set @xmath60 as defined in section  [ sec : dense ] , we now proceed to analyze the convergence of the ideal dpg method for problem  [ prb : weakschrodinger ] .",
    "the ideal dpg method finds @xmath269 and @xmath270 in finite dimensional subspaces @xmath271 and @xmath272 respectively , satisfying @xmath273 here @xmath274 is defined by @xmath275 for all @xmath276 and any @xmath277 .",
    "the main feature of the ideal dpg method is that the wellposedness of problem  [ prb : weakschrodinger ] implies quasioptimality of the method s error  @xcite .",
    "the wellposedness of problem  [ prb : weakschrodinger ] follows from theorem  [ thm : uw_schrod ] , now that we have verified assumption  [ asm : dense ] in theorem  [ thm : dense ] .",
    "hence to obtain convergence rates for specific subspaces , we need only develop interpolation error estimates .",
    "since the interpolation properties of the @xmath278-conforming @xmath279 are standard , we need only discuss those of @xmath280 to study this , we will create a spacetime finite element space @xmath281 , then identify @xmath282 as @xmath283 , and finally establish interpolation estimates for @xmath282 using those for  @xmath284 . note that @xmath284 will be used only in the proof ( and not in the computations ) .    to transparently present the ideas , we shall limit ourselves to the very simple case of a uniform mesh @xmath142 of spacetime square elements of side length  @xmath285 .",
    "let @xmath286 denote the set of edges of @xmath142 . on any @xmath287",
    "let @xmath288 denote the space of polynomials on the edge of degree at most  @xmath289 . on any @xmath290 ,",
    "let @xmath291 denote the space of polynomials of degree at most @xmath289 in @xmath2 and at most @xmath289 in @xmath4 . to begin the finite element construction",
    ", we consider the reference element @xmath292 and the element space @xmath293 endowed with the following degrees of freedom : for each @xmath294 and @xmath295 write @xmath296 and @xmath297 and set @xmath298 together , these form a set @xmath299 with @xmath300 linear functionals .",
    "the triple @xmath301 is a unisolvent finite element , in the sense of  @xcite , as we show next .",
    "( top ) at ( 0,3 ) ; ( bot ) at ( 2.5,0 ) ; ( lft ) at ( 0,0 ) ; ( rgt ) at ( 2.5,3 ) ; ( lft )  ( bot ) ; ( top )  ( rgt ) ; ( rgt )  ( bot ) ; ( top )  ( lft ) ; ( 0,0 ) circle ( 1.5pt ) ; ( 0,1 ) circle ( 1.5pt ) ; ( 0,2 ) circle ( 1.5pt ) ; ( 0,3 ) circle ( 1.5pt ) ; ( 2.5,0 ) circle ( 1.5pt ) ; ( 2.5,1 ) circle ( 1.5pt ) ; ( 2.5,2 ) circle ( 1.5pt ) ; ( 2.5,3 ) circle ( 1.5pt ) ; ( 2.5,3 ) circle ( 1.5pt ) ;    ( 0,0 ) ",
    "( @xmath302 ) ; ( 0,1 )  ( @xmath303 )",
    "node[left ] ; ( 0,2 )  ( @xmath304 )",
    "node[below ] ; ( 0,3 )  ( @xmath305 )",
    "node[left ] ;    ( 2.5,0 ) ",
    "( @xmath306 ) ; ( 2.5,1 )  ( @xmath307 ) ; ( 2.5,2 )  ( @xmath308 ) ; ( 2.5,3 )  ( @xmath309 ) ;    ( bot )  ( rgt )  ( top )",
    "(lft ) ; ( 2.5,0 )  ( @xmath82 ) node[below ] @xmath2 ; ( 0,2 )  ( @xmath310 ) node[left ] @xmath4 ;    ( top ) at ( 0,3 ) ; ( bot ) at ( 2.5,0 ) ; ( lft ) at ( 0,0 ) ; ( rgt ) at ( 2.5,3 ) ; ( lft ) ",
    "( bot ) ; ( top )  ( rgt ) ; ( rgt )  ( bot ) ; ( top )  ( lft ) ; ( 0,0 ) circle ( 1.5pt ) ; ( 0,3/5 ) circle ( 1.5pt ) ; ( 0,2 * 3/5 ) circle ( 1.5pt ) ; ( 0,3 * 3/5 ) circle ( 1.5pt ) ; ( 0,4 * 3/5 ) circle ( 1.5pt ) ; ( 0,5 * 3/5 ) circle ( 1.5pt ) ;    ( 2.5/3,0 ) circle ( 1.5pt ) ; ( 2.5/3,3/5 ) circle ( 1.5pt ) ; ( 2.5/3,2 * 3/5 ) circle ( 1.5pt ) ; ( 2.5/3,3 * 3/5 ) circle ( 1.5pt ) ; ( 2.5/3,4 * 3/5 ) circle ( 1.5pt ) ; ( 2.5/3,5 * 3/5 ) circle ( 1.5pt ) ; ( 2 * 2.5/3,0 ) circle ( 1.5pt ) ; ( 2 * 2.5/3,3/5 ) circle ( 1.5pt ) ; ( 2 * 2.5/3,2 * 3/5 ) circle ( 1.5pt ) ; ( 2 * 2.5/3,3 * 3/5 ) circle ( 1.5pt ) ; ( 2 * 2.5/3,4 * 3/5 ) circle ( 1.5pt ) ; ( 2 * 2.5/3,5 * 3/5 ) circle ( 1.5pt ) ;    ( 2.5,0 ) circle ( 1.5pt ) ; ( 2.5,3/5 ) circle ( 1.5pt ) ; ( 2.5,2 * 3/5 ) circle ( 1.5pt ) ; ( 2.5,3 * 3/5 ) circle ( 1.5pt ) ; ( 2.5,4 * 3/5 ) circle ( 1.5pt ) ; ( 2.5,5 * 3/5 ) circle ( 1.5pt ) ;    ( 0,0 )  ( @xmath302 ) ; ( 0,3/5 )  ( @xmath311 ) ; ( 0,2 * 3/5 )  ( @xmath312 ) ; ( 0,3 * 3/5 )  ( @xmath313 ) ; ( 0,4 * 3/5 )  ( @xmath314 ) ; ( 0,5 * 3/5 )  ( @xmath315 ) ;    ( 2.5+.0,0 )  ( @xmath316 ) ; ( 2.5 + 0,3/5 )  ( @xmath317 ) ; ( 2.5 + 0,2 * 3/5 )  ( @xmath318 ) ; ( 2.5 + 0,3 * 3/5 ) ",
    "( @xmath319 ) ; ( 2.5 + 0,4 * 3/5 )  ( @xmath320 ) ; ( 2.5 + 0,5 * 3/5 )  ( @xmath321 ) ;    ( bot )  ( rgt )  ( top ) (lft ) ; ( 2.5,0 )  ( @xmath82 )",
    "node[below ] @xmath322 ; ( 0,2 )  ( @xmath310 ) node[left ] @xmath323 ;    [ lem : unisolv ] suppose @xmath324 .",
    "then any polynomial @xmath325 is uniquely defined by the values of its degrees of freedom @xmath326 in @xmath327    suppose @xmath328 and @xmath329 for all @xmath330 . then @xmath331 is a polynomial of degree @xmath289 in one variable ( @xmath2 ) .",
    "the hermite and lagrange degrees of freedom on @xmath332 imply @xmath333 .",
    "now , fixing  @xmath2 , observe that the polynomial @xmath204 is of degree at most @xmath289 in the variable @xmath4 and has @xmath334 zeros .",
    "hence @xmath335 and the proof is complete since @xmath336 equals the number of degrees of freedom .",
    "next , consider the global finite element space @xmath337 and @xmath338 are in @xmath20 and @xmath339 for all @xmath340 each element @xmath290 is obtained by mapping the reference element @xmath341 by @xmath342 @xmath343 , where @xmath344 is the lower left corner vertex of @xmath345 and the element space @xmath291 is the pull back of the reference element space @xmath346 under this map .",
    "the space @xmath347 can be controlled by a global set of degrees of freedom obtained by mapping the reference element degrees of freedom and , as usual , coalescing those that coincide at the mesh element interfaces .    on the reference element @xmath341",
    ", the degrees of freedom define an interpolation operator @xmath348 where , as usual , @xmath349 is the set of shape functions obtained as the dual basis of  @xmath299 . by the sobolev inequality in two dimensions ,",
    "@xmath350 is continuous .",
    "similarly , the global degrees of freedom define an interpolation operator @xmath351 satisfying @xmath352    [ lem : interp_err ] if @xmath353 , then for all @xmath324 , @xmath354    changing variables @xmath355 as @xmath356 runs over @xmath357 integrating , and using  ,    [ eq : interpolations ] @xmath358    on the reference element , since @xmath359 the interpolation operator @xmath360 is continuous . moreover @xmath361 for all @xmath362 .",
    "hence , the bramble - hilbert lemma yields a @xmath363 such that @xmath364 for all @xmath365 . since @xmath366 combining with and summing over all the elements in @xmath367",
    ", we obtain the result .",
    "now we are ready to present the main result of this section .",
    "set @xmath368 and @xmath369    [ thm : ee ] let @xmath324 .",
    "suppose @xmath370 and @xmath371 solve problem  [ prb : weakschrodinger ] and suppose @xmath372 is set by  .",
    "then , there exists a constant @xmath373 independent of @xmath285 such that the discrete solution @xmath374 and @xmath375 solving   satisfies @xmath376 for @xmath377 .    by  (",
    "* theorem  2.2 ) the ideal dpg method is quasioptimal : @xmath378 because of the standard approximation estimate @xmath379 for @xmath380 it suffices to focus on @xmath381 . since @xmath382 by the definition of @xmath149-norm  , and the fact that any @xmath383 in @xmath282 equals @xmath384 for some @xmath385 , we have @xmath386 applying lemma  [ lem : interp_err ] , the result follows .",
    "we conclude this section by examining a property of @xmath282 that is useful for computations .",
    "let @xmath387 and @xmath388 denote the set of vertical and horizontal ( closed ) mesh edges , respectively , and @xmath389 .",
    "let @xmath390 and @xmath391 denote the closed set formed by the union of all edges in @xmath392 and @xmath393 , respectively .",
    "let @xmath394 for all @xmath395 and @xmath396 is continuous on @xmath391 and @xmath397 for all @xmath398 and @xmath399 for any @xmath385 , since @xmath400 is a polynomial on each element , we may integrate by parts element by element to get @xmath401 for all @xmath402 .",
    "thus @xmath403 satisfies @xmath404 where @xmath405 and @xmath406 in computations , one may therefore identify @xmath282 with the interfacial polynomial space @xmath407 whose components are of degree at most  @xmath289 .",
    "this section is motivated by our interest in simulating electromagnetic pulse propagation in dispersive optical fibers .",
    "nonlinear , dispersive maxwell equations in the context of optical fibers have been studied extensively  @xcite .",
    "the common approach to model dispersive , intensity - dependent nonlinearities is based on several simplifying approximations .",
    "these approximations include a slowly varying pulse envelope , a quasi - monochromatic optical field , a specific polarization maintained along the fiber length , and approximation of nonlinear terms as perturbations of the purely linear case . with these assumptions ,",
    "the full maxwell equations are reduced  @xcite to the `` nonlinear schrdinger equation '' @xmath408 where @xmath2 is the distance along the fiber , @xmath4 is an observation window ( in time ) , @xmath409 is some given fiber - dependent constant , and @xmath410 is a complexified amplitude of the pulse .",
    "since the roles of @xmath2 and @xmath4 in this application may be confusing , we switch them to agree with the previous sections and consider the simple case of @xmath411 in other words , we present numerical results obtained using a practical dpg method applied to the one dimensional schrdinger problem @xmath412    to describe the method we used in practice , first set @xmath413 using the schrdinger operator @xmath414 and recall  ( [ discrete ] ) . as mentioned in the previous section , the action of any @xmath415 on the boundary of each element ,",
    "can be viewed as a combination of two _ independent _ boundary actions of variables @xmath416 and @xmath417 that are of the same polynomial order . however , we are led to implement a slightly different space because our computational tool is a standard petrov - galerkin code supporting the exact sequence elements of the first type  @xcite .",
    "accordingly , @xmath416 is discretized with ( continuous ) traces of @xmath50 conforming elements of order @xmath289 but @xmath417 is discretized with ( discontinuous ) traces of the compatible @xmath418 conforming elements of order @xmath419 , i.e. , one order less than required by the presented interpolation theory .",
    "let @xmath420 represent this reduced space .",
    "the next modification needed in our implementation is an approximation of  @xmath132 .",
    "let @xmath421 be defined by @xmath422 for all @xmath423 and any @xmath424 , where @xmath425 for all @xmath426 .",
    "thus the practically implemented method , in contrast to  ( [ discrete ] ) , finds @xmath374 and @xmath427 satisfying @xmath428 for all @xmath429 . in all the results presented below",
    ", no significant differences were seen between @xmath430 and @xmath431 , so we only report the results obtained with @xmath432 .",
    ".,title=\"fig:\",height=207 ] .,title=\"fig:\",height=207 ]    we report the observed rates of convergence for two problems : _ ( a ) _  the first case is when the exact solution is a complex gaussian @xmath433 where @xmath434 and @xmath409 are fiber - dependent constants ( see @xcite ) . our simulations used non - dimensionalized units of @xmath435 and @xmath436 . _",
    "( b ) _  the second example uses an exact solution which is a wave packet traveling along the fiber whose in - packet oscillations are of moderately high wavenumber  @xmath437 , namely @xmath438 where the amplitude @xmath439 and the wavenumber is @xmath440 . plots of solutions in either case are displayed in figure  [ fig : solution ] .",
    "the observed convergence rates are displayed in figure  [ fig : rates ] ( the left plot shows results from case  _ ( a ) _ and the right plot shows results from case  _ ( b)_. we experiment with @xmath441 and @xmath442 cases .",
    "for the ideal dpg method using the @xmath372 in  , theorem  [ thm : ee ] implies that the convergence rate in terms of the number of degrees of freedom @xmath443 is @xmath444 where @xmath445 .",
    "we observe from figure  [ fig : rates ] that in spite of reducing @xmath282 to @xmath420 and in spite of approximating @xmath132 by @xmath446 , we continue to observe a rate higher than  @xmath447 .",
    "namely , in the @xmath441 case , while we expected a rate of @xmath448 , the observed rate is @xmath449 . in the @xmath450 case , while the expected rate is @xmath451 , the observed rate is between @xmath452 and @xmath453 .",
    "an improved error analysis explaining these observations is yet to be found .",
    "note the flattening out of the curves in left plot of figure  [ fig : rates ] .",
    "this is due to conditioning issues . as with any method using second order derivatives",
    ", we should be wary of conditioning .",
    "indeed , the dpg system with @xmath441 or @xmath450 , after 4 or 5 uniform refinements , has a condition number in the vicinity of @xmath454 .",
    "therefore , the roundoff effect becomes apparent after we achieve an error threshold around @xmath455 or @xmath456 .",
    "this is the cause of convergence curves flattening out in case _",
    "( a)_. in case _",
    "( b ) _ , due to @xmath457 , we start with a higher error so the loss of digits due to conditioning issues is postponed .",
    "in this section , we consider a boundary value problem involving a general partial differential operator .",
    "we derive a mesh - dependent weak formulation of the boundary value problem and show that it is possible to identify sufficient conditions for its wellposedness .",
    "this section can be read independently of the remainder of the paper .",
    "[ eq : a ] @xmath464_i = \\d^\\alpha ( a_{ij\\alpha } u_j),\\ ] ] where @xmath465 are bounded functions for all @xmath466 , @xmath467 and all multi - indices @xmath468 whose length is @xmath469 , and we have used the summation convention to sum over all such @xmath470 and @xmath471 . as usual , @xmath472 .",
    "we assume that the domain of @xmath65 , denoted by @xmath79 , is chosen so that @xmath473 this implies that @xmath65 is a densely defined operator .",
    "then , identifying the dual of ( cartesian products of ) @xmath20 with itself , recall that the adjoint @xmath474 is a uniquely defined ( unbounded ) closed linear operator  @xcite on @xmath475 there is an @xmath71 such that @xmath72 for all @xmath476 satisfying @xmath477 for all @xmath478 and @xmath479 here and throughout , @xmath74 and @xmath21 denotes the inner product and the norm , respectively , in @xmath20 or its cartesian products . note that @xmath480 . for any @xmath25 in @xmath481 ,",
    "the function @xmath128 is obviously a well defined distribution in @xmath482 .",
    "we assume that the coefficients @xmath483 are such that @xmath484      for any nonempty open subset @xmath485 define the space @xmath486 normed by @xmath487 and the space @xmath488 normed by @xmath489 to simplify notation , we abbreviate @xmath490 , @xmath491 . clearly these are inner product spaces .",
    "since the proofs for @xmath492 and @xmath493 are similar , we only show the first .",
    "suppose @xmath494 is a cauchy sequence in @xmath64 .",
    "then @xmath494 is cauchy in @xmath495 and @xmath496 is cauchy in @xmath497 .",
    "hence there is a @xmath498 and @xmath499 such that @xmath500 and @xmath501 .",
    "we will show that @xmath25 is in @xmath502    let @xmath503 . for each @xmath504 ,",
    "the distributional action of @xmath505 on @xmath506 , denoted by @xmath507 equals @xmath508 .",
    "if @xmath183 is also in @xmath492 , then @xmath509 for all @xmath510 in @xmath511 . to complete the proof ,",
    "we apply   with @xmath512 to get @xmath513 for all @xmath510 in @xmath511 .",
    "hence @xmath514 and @xmath25 is in @xmath492 .",
    "next , define bounded linear operators @xmath515 and @xmath516 by @xmath517 for all @xmath518 and @xmath519 . here , like in , and in the remainder , we use @xmath520 to denote the action of a linear functional in @xmath521 on an element of @xmath522 .",
    "when @xmath79 is endowed with the topology of @xmath523 , we call it @xmath77 , i.e. , although @xmath77 and @xmath524 coincide as sets , @xmath77 has the topology of @xmath523 and @xmath79 has the topology of @xmath481 .",
    "similarly , @xmath80 is called @xmath78 when it is endowed with the topology of @xmath525 . for the next result ,",
    "recall that the left annihilator of any subspace @xmath526 of the dual space @xmath521 of any banach space @xmath522 is defined by @xmath527      according to the ( above - mentioned ) definition of @xmath80 , for any @xmath529 , there is an @xmath530 such that @xmath531 due to  , we may choose @xmath532 in @xmath533 . by",
    ", @xmath534 is a distribution and by   this distribution is in @xmath481 and equals @xmath535 in particular , @xmath536 is in @xmath525 .",
    "hence   is applicable , and in combination with   yields @xmath537 for all @xmath201 . hence @xmath538 and",
    "we have proved that @xmath539 .",
    "the reverse containment is also easy to prove .",
    "we are interested in the boundary value problem of finding @xmath25 satisfying @xmath540 given @xmath541 .",
    "homogeneous boundary conditions are incorporated in @xmath171 consider the scenario where @xmath60 is partitioned into a mesh @xmath142 of finitely many open elements @xmath143 such that @xmath144 . here the index @xmath285 denotes @xmath542 .",
    "define @xmath543 and @xmath544 by replacing @xmath60 by @xmath143 in   and  .",
    "additionally , set @xmath545 the spaces @xmath546 and @xmath547 are defined similarly . the component on an element @xmath143 of functions in such product spaces are indicated by placing @xmath143 as subscript , e.g. , for any @xmath183 in @xmath150 , the component of @xmath183 on element @xmath143 is denoted by @xmath548 .",
    "let @xmath549 be the continuous linear operator defined by @xmath550 for all @xmath551 and @xmath552 . to simplify notation , we abbreviate @xmath553 to @xmath554 , i.e. , duality pairing in @xmath546",
    "is simply denoted by @xmath151 . for any @xmath551 ,",
    "we denote by @xmath555 the function obtained by applying @xmath65 to @xmath548 , element by element , for all @xmath290 .",
    "the resulting function @xmath556 is an element of @xmath557 , which is identified to be the same as @xmath558 .",
    "the operator @xmath559 is defined similarly .",
    "thus @xmath560 for all @xmath551 and @xmath552 .        to derive the mesh - dependent weak formulation , multiply   by a test function @xmath276 and apply the definition of @xmath543 .",
    "summing over all @xmath290 , we obtain @xmath569 for all @xmath532 in @xmath546 .",
    "let @xmath570 setting @xmath571 to be a new unknown @xmath572 in @xmath149 , we have thus derived the following weak formulation with @xmath573 .",
    "[ thm : wellposed - mesh ] in the setting of  , suppose @xmath577 then , problem  [ prb : weak ] is well posed .",
    "moreover , if @xmath162 for some @xmath578 then the unique solution  @xmath25 of problem  [ prb : weak ] is in  @xmath579 solves  , and satisfies @xmath164 .",
    "before we prove this theorem , we must note how our assumptions allow a natural topology on @xmath149 .",
    "specifically , implies that @xmath77 is a closed subspace of @xmath64 .",
    "it is also a closed subspace of  @xmath150 since @xmath64 is continuously imbedded in  @xmath150 .",
    "the same imbedding also shows that restriction of @xmath147 to @xmath77 , denoted by @xmath580 , is continuous .",
    "note that @xmath149 is the range of @xmath581 . for any @xmath582 in @xmath149 , we use @xmath583 to denote the pre - image of @xmath582 , i.e. , set of all @xmath201 such that @xmath584 the continuity of @xmath581 implies that @xmath585 is a closed subspace of @xmath77 .",
    "hence @xmath586 is a norm on @xmath149 .",
    "this quotient norm makes @xmath149 complete .",
    "the wellposedness result of theorem  [ thm : wellposed - mesh ] is to be understood with @xmath149 endowed with this norm .",
    "we verify the uniqueness and inf - sup conditions of the babuka theory to obtain wellposedness . to verify the uniqueness condition",
    ", we must prove that if @xmath597 then @xmath25 and @xmath572 vanishes . since @xmath598 for some @xmath599 , by virtue of lemma  [ lem : dhv ] , @xmath600 for any @xmath532 in @xmath78 . hence   implies @xmath601 in particular , since @xmath602",
    ", this implies that @xmath603 and therefore @xmath604 .",
    "hence   and   imply @xmath605 , or equivalently @xmath606 for all @xmath197 . thus @xmath607 .",
    "the bijectivity of @xmath608 then implies that @xmath609 . returning to   and setting @xmath609",
    ", we see that @xmath610 for all @xmath611 , so @xmath612 as well .",
    "it only remains to prove the inf - sup condition @xmath613 where @xmath614 and @xmath615 . given any @xmath616",
    ", we use the bijectivity of @xmath617 and the banach open mapping theorem to obtain a @xmath532 in @xmath77 satisfying @xmath618 and @xmath619 then , setting @xmath620 and @xmath621 we have @xmath622 and @xmath623 .",
    "hence @xmath624 where @xmath625 depends only on @xmath373 . hence   follows .",
    "various elements of the arguments used in this proof are well - known in the dpg literature  see e.g. , @xcite .",
    "a generalization of these ideas to make a unified theory for dpg approximations of all friedrichs systems was attempted in  @xcite .",
    "however , ( * ? ? ?",
    "* equation  ( 2.17 ) ) is not correct ( a counterexample is easily furnished by the laplace example ) and unfortunately that equation is used in ( * ? ? ?",
    "* lemma  2.4 and corollary 2.5 ) to prove the existence of a solution for problem  [ prb : weak ] .",
    "the above proof provides a corrigendum to  @xcite and shows that the results claimed there for symmetric friedrichs systems are indeed correct for operators of the form   with @xmath626 and with @xmath77 and @xmath78 set respectively to the null spaces of the operators @xmath627 and @xmath628 defined there .",
    "the above analysis is applicable beyond friedrichs systems as the example of schrdinger equation shows .",
    "`` instead of working with one equation of higher than first order , '' writes friedrichs in his early work  @xcite , `` we prefer to work with a system of equations of first order . ''",
    "we have already noted the difficulties in reformulating the schrdinger equation as a first order system .",
    "the modern theory of friedrichs systems ( for operators of the form   with @xmath629 ) starts with the assumption that @xmath630 for all @xmath631  see ( * ? ? ?",
    "* equation ( t2 ) ) .",
    "this assumption does not hold for the schrdinger operator .",
    "to prove the reverse containment , let @xmath638 satisfy @xmath639 for all @xmath640 for any @xmath641 , the distribution @xmath642 satisfies @xmath643 .",
    "the last term is zero , because by  , @xmath644 .",
    "hence @xmath645 and @xmath646 is in @xmath647 .",
    "thus by lemma  [ lem:1 ] , @xmath648 , so @xmath649 . hence @xmath646 is in @xmath78 by lemma  [ lem : v1 ] .",
    "the supremum , denoted by @xmath447 , is attained by the function @xmath651 in @xmath546 satisfying @xmath652 choosing @xmath653 in  , we conclude that the distribution @xmath654 is in @xmath558 .",
    "hence   is applicable with @xmath655 and we obtain          next , we show that @xmath661 is in @xmath77 . by",
    ", it suffices to prove that @xmath662 . for any @xmath536 in  @xmath663 we have , using lemma  [ lem:1 ] , @xmath664 .",
    "the last term is zero because @xmath598 for some @xmath599 and @xmath665 by lemma  [ lem : v1 ] .",
    "hence @xmath666    the infimum of the lemma is @xmath667 by virtue of  , to complete the proof , it suffices to show that @xmath668 the last equality is obvious from @xmath669 and @xmath670 , hence we need only show that @xmath671 .",
    "standard variational arguments show that the infimum defining @xmath672 is attained by a unique minimizer @xmath673 satisfying @xmath674 and @xmath675 for all @xmath676 and @xmath677 since @xmath678 choosing @xmath679 , we conclude that the distribution @xmath680 is in @xmath481 and satisfies @xmath681 .",
    "but in view of  , this means that @xmath682 .      since   follows with @xmath686 from lemma  [ lem : infsupinterface ]",
    ", we only need to prove  .",
    "first note that since @xmath77 is closed ( by  ) , @xmath65 is a closed operator . by",
    ", the range of @xmath65 is closed . by the closed range theorem for closed operators , range of @xmath66 is closed .",
    "also , the well - known identity @xmath687 , in combination with  , implies that @xmath66 is injective .",
    "hence there exists a @xmath158 such that @xmath688 this implies the following inf - sup condition : @xmath689 to complete the proof , we note that by standard arguments the order of arguments in the inf and sup may be reversed to get @xmath690 by lemma  [ lem : unbroken ] , @xmath691 , thus completing the proof of  .    the idea behind lemma  [ lem : infsupinterface ] ( to consider the two related problems   and , one with essential boundary conditions and the other with natural boundary conditions ) was first presented in  @xcite , tailored to the specific needs of a maxwell problem . a generalization for first order operators",
    "was presented later in  @xcite . the argument to prove   using the closed range theorem ,",
    "was first presented for the case of first order sobolev spaces in  ( * ? ? ?",
    "* theorem  6.6 ) .                  c.  carstensen , leszek demkowicz , and j.  gopalakrishnan .",
    "methods for maxwell equations . in susanne  c. brenner , carsten carstensen , leszek demkowicz , and peter wriggers , editors , _ oberwolfach reports : computational engineering _ , volume 43/2015 , september 2015 ."
  ],
  "abstract_text": [
    "<S> a spacetime discontinuous petrov galerkin ( dpg ) method for the linear time - dependent schrdinger equation is proposed . </S>",
    "<S> the spacetime approach is particularly attractive for capturing irregular solutions . </S>",
    "<S> motivated by the fact that some irregular schrdinger solutions can not be solutions of certain first order reformulations , the proposed spacetime method uses the second order schrdinger operator . </S>",
    "<S> two variational formulations are proved to be well posed : a strong formulation ( with no relaxation of the original equation ) and a weak formulation ( also called the `` ultraweak formulation '' , that transfers all derivatives onto test functions ) . </S>",
    "<S> the convergence of the dpg method based on the ultraweak formulation is investigated using an interpolation operator . </S>",
    "<S> a standalone appendix analyzes the ultraweak formulation for general differential operators . </S>",
    "<S> reports of numerical experiments motivated by pulse propagation in dispersive optical fibers are also included . </S>"
  ]
}