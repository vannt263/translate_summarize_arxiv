{
  "article_text": [
    "energy harvesting wireless networks offer the possibility of perpetual network lifetime , yielding low maintenance costs and less energy storage requirements at each node @xcite .",
    "however , the intermittent availability of harvested energy also renders realizing the full potential of these benefits challenging .",
    "in particular , it is possible for central nodes of the network to become energy deprived due to energy harvesting conditions , impacting the network s performance . to combat such energy outages , recent results utilizing wireless energy transfer @xcite offer the possibility of energy cooperation for wireless ad - hoc networks in addition to signal cooperation @xcite . in this paper",
    ", we consider a generalized setting in this realm , and study multi - transmitter models where nodes can receive or transfer energy , in order to gain insights into network design by jointly optimizing data and energy transfer policies .",
    "optimal power allocation in energy harvesting wireless networks has recently been studied extensively . in @xcite , an energy harvesting transmitter with infinite energy storage capability",
    "is considered , and the transmission completion time minimizing power allocation in a single link is found .",
    "the short - term throughput maximization problem is studied in @xcite , where the setting of @xcite is extended to finite energy storage .",
    "a wireless fading channel with an energy harvesting transmitter is considered in @xcite , showing that a directional water - filling algorithm can be utilized to find the optimal power allocation .",
    "multiterminal models , and energy harvesting transmitters and receivers are subsequently studied , see for example @xcite and references therein .",
    "in addition to optimal power policies found in @xcite , alternative power management approaches such as nodes with inactive states @xcite are also considered in previous work .",
    "since energy harvesting networks may experience energy deprivation when sufficient energy is not available to harvest , they can benefit from the recent advances in wireless energy transfer .",
    "short range energy transfer is already present in today s rfid systems @xcite .",
    "energy cooperation is a viable option in mid - range as well , with wireless energy transfer efficiency values reaching up to 40% using coupled magnetic resonance @xcite .",
    "this provides the possibility of energy cooperation , allowing networks to have additional control over the energy available at each node , as proposed in @xcite .",
    "in essence , energy cooperation introduces a new dimension for network optimization in energy harvesting networks .    the problem of optimizing energy consumption for data transmission and energy transfer is introduced in @xcite , where a two - hop network with an energy harvesting transmitter and relay is considered , and the source can transfer energy to the relay .",
    "it is shown that throughput can be improved with respect to energy harvesting alone @xcite , even with uni - directional energy transfer .",
    "two - way and multiple access channels with uni - directional energy cooperation are also studied by the same authors in @xcite , proposing a two - dimensional water - filling algorithm to find the optimal policy .",
    "these studies assume an infinite battery size for the transmitters . additionally , a different line of work studies transferring energy and information jointly , see @xcite and many others .    in this paper",
    ", we follow the model of transferring energy and data separately as in @xcite .",
    "we generalize this set up to energy harvesting nodes all of which are capable of transferring energy to one another , i.e. , in any direction .",
    "we consider a general energy transfer model , which could be realized via various energy transfer technologies such as magnetic induction , magnetically coupled resonance , or rf harvesting . whereas the recent paradigm of simultaneous wireless information and power transfer ( swipt ) focuses on harvesting rf signals for powering devices , and the associated trade - offs between using the energy for device operation or information decoding , we focus on optimally allocating and sharing of energy between devices over time . as communication models",
    ", we consider those in @xcite , i.e. , two - way , two - hop , and multiple access channels , allowing unrestricted energy transfers between all nodes .",
    "in addition to generalizing earlier works to unrestricted energy transfers , we also extend these models to the case where all nodes have finite battery and establish the optimal policy when the battery sizes are finite .",
    "we will see that allowing unrestricted energy transfers and limited batteries both require a careful solution methodology and bring on new design insights .",
    "specifically , we optimize transmit powers and energy transfers under the aforementioned general setting . for clarity of exposition , first , in sections  [ sect_model ] , [ sect_properties ] , and [ sect_twc ]",
    ", we consider the two - way channel with infinite - sized batteries at the transmitters .",
    "we prove that a subset of feasible policies , composed of those which postpone energy transfers until immediately needed , includes an optimal policy . named _ procrastinating policies _ , this subset allows a decomposition of the joint optimization problem into separate energy transfer allocation and consumed power allocation problems .",
    "we subsequently show that the separation extends to two - hop ( section  [ sect_twohop ] ) and multiple access channels ( section  [ sect_mac ] ) .",
    "we demonstrate that a generalized extension of the directional water - filling algorithm @xcite for the two - way channel solves the power allocation problem , while a single - user policy as in @xcite , with scaled aggregate arrivals , suffices for the multiple access channel . in section  [ sect_finite_bat ] ,",
    "we extend our study to transmitters with finite - sized batteries , and show that _ partially procrastinating policies _ , defined therein , are optimal .",
    "next , we leverage a simplified version of the two - dimensional water - filling algorithm in @xcite to solve the throughput optimization problem with joint energy transfer and transmit powers .",
    "we present numerical results in section  [ sect_numerical ] , demonstrating the advantage of bi - directional energy cooperation in energy harvesting networks over no cooperation @xcite and uni - directional cooperation @xcite .",
    "section  [ sect_conclusion ] concludes the paper .",
    "we will first focus on the two - way channel and solve the problem at hand .",
    "we will then extend our solutions to the two - hop and multiple access models in sections  [ sect_twohop ] and [ sect_mac ] , respectively .    consider the gaussian two - way channel ( twc ) @xcite with two energy harvesting and energy cooperating ( ehec ) nodes , @xmath0 and @xmath1 , as shown in fig .",
    "[ fig_twoway_model ] . denoting the channel inputs by @xmath2 and the channel power gains by @xmath3 , @xmath4 ,",
    "the channel outputs at nodes @xmath0 and @xmath1 after self interference cancellation are given by @xmath5 where @xmath6 is gaussian noise with power @xmath7 at node @xmath8 , @xmath4 .",
    "each node cancels out its own contribution to the channel output , i.e. , @xmath8 subtracts @xmath2 from @xmath9 , thus reducing the model to two parallel additive white gaussian noise ( awgn ) channels with channel power gains @xmath10 and @xmath11 .",
    "we consider a static , i.e. , time - invariant channel where @xmath7 and @xmath3 , @xmath4 , remain constant throughout the transmission duration .",
    "the communication session is divided into @xmath12sec long time slots , indexed by @xmath13 . throughout the paper",
    ", we denote node indices by the first subscripts @xmath14 , @xmath15 and @xmath16 , and time slot indices by the second subscripts @xmath17 and @xmath18 . in time slot @xmath17 , node @xmath8 , @xmath4 , harvests @xmath19 units of energy , which it stores in its battery of size @xmath20 . within this time slot",
    ", @xmath8 transmits with average power @xmath21 , which requires @xmath21 units of energy due to the unit slot length .",
    "in addition to harvesting energy , the nodes are also capable of transferring energy to each other . in time",
    "slot @xmath17 , @xmath8 transfers @xmath22 units of energy to @xmath23 , @xmath24 .",
    "this transfer has an end - to - end efficiency of @xmath25 , and @xmath23 receives @xmath26 units of energy as a result .",
    "the end - to - end transfer efficiency includes propagation loss , as well as other factors that scale linearly with the amount of energy transferred , e.g. , circuit energy consumption at both parties .",
    "the _ power policy _ of the network is defined as the collection of transmit powers and transferred energy values @xmath27 for all @xmath14 , @xmath15 and @xmath17 .",
    "the power policy of the network is constrained by the energy available to each node in each time slot .",
    "in particular , the energy remaining in the battery of node @xmath8 depends on the energy harvested at node @xmath8 , the transmit power of the node , and the energy transferred to and received from node @xmath23 for @xmath24 .",
    "we refer to the energy stored in the battery of @xmath8 at the end of time slot @xmath17 as the battery state @xmath28 , which evolves as @xmath29 for @xmath4 , with @xmath30 .",
    "the initial charge of the batteries are introduced to the model through the energy harvests @xmath31 and @xmath32 in the first time slot . to ensure that the energy used by @xmath8 does not exceed the energy available at the node",
    ", we impose the set of _ energy causality constraints _ @xcite @xmath33 for @xmath4 , @xmath13 , which can equivalently be expressed as @xmath34 for @xmath4 and @xmath13 .",
    "these causality constraints imply that energy can not be consumed , neither for transmission nor for transfer , before it is harvested or received .    for average transmit powers @xmath35 and @xmath36 in time slot @xmath17 , the sum - capacity of the gaussian two - way channel in fig .",
    "[ fig_twoway_model ] with full - duplex nodes is given by @xcite @xmath37    we consider the offline problem ( see also @xcite ) , where the energy harvests @xmath19 throughout the session are known at the beginning of the communication session .",
    "in addition to being applicable in networks with predictable energy arrivals , this approach also allows us to benchmark the performance limits of energy harvesting networks with energy cooperation .",
    "we consider the ehec sum - throughput maximization problem for the twc over transmit powers @xmath21 and energy transfers @xmath22 , throughout a communication session of @xmath38 time slots , i.e. ,    [ eqn_problem_twc ] @xmath39    where ( [ eqn_problem_twc_b ] ) are the energy causality constraints , and ( [ eqn_problem_twc_c ] ) are the non - negativity constraints for transmit power and transferred energy .",
    "we remark that similar problems that consider other criteria such as fairness can be formulated by updating the objective of ( [ eqn_problem_twc ] ) accordingly .",
    "we note that ( [ eqn_problem_twc ] ) is either solved by all nodes in the network separately , or solved by one of the nodes and the output communicated to the others .",
    "this requires energy harvests and channel parameters to be shared between all energy harvesting transmitters in the system .",
    "the relatively small communication overhead , which is in the order of a few bytes per time slot , will be omitted in this work for the sake of simplicity .",
    "lastly , we remark that while linear end - to - end energy transfer losses are represented by @xmath40 , we do not explicitly account for other circuit or processing energy costs for energy cooperation .",
    "these can be incorporated into the optimization problem by embedding their cost models into ( [ eqn_model_bk ] ) .",
    "currently , experimental such models are being developed for specific transfer technologies , see for example @xcite for strongly coupled magnetic resonance as the energy transfer technology .",
    "we begin with the infinite battery case , @xmath41 . in addition to providing insights about the optimal policy ,",
    "this case is also a good approximation for systems where battery capacity is sufficiently large , harvested energy is sufficiently low , or transmission session is sufficiently brief with respect to harvesting period .",
    "the properties found in this section are extended to the finite battery case in section  [ sect_finite_bat ] . for this case , the battery state in ( [ eqn_model_bk ] ) can be rewritten as @xmath42 for @xmath43 and @xmath24 .",
    "the problem in ( [ eqn_problem_twc ] ) involves the joint optimization of transferred energy and transmit powers of the two nodes over @xmath38 time slots , i.e. , @xmath44 variables in total . in this section",
    ", we identify properties of optimal policies , the use of which helps us eliminate the additional complexity introduced by energy cooperation .",
    "we first show that a subset of power policies , named _ procrastinating policies _",
    ", includes at least one optimal policy .",
    "[ def_lazy ] a power policy @xmath27 is a procrastinating policy if it satisfies @xmath45    in each time slot , a procrastinating policy transfers energy from one node to the other only if all of the transferred energy is to be consumed for transmission immediately .",
    "this can be interpreted as the energy transferring nodes delaying energy transfers until the time slot they are immediately needed at the receiving end , hence the name _ procrastinating _ policies . in a procrastinating policy ,",
    "energy transfers that are necessary for the feasibility of @xmath21 are postponed until the conditions in ( [ eqn_lazy1 ] ) are satisfied .",
    "the following lemma establishes the optimality of procrastinating policies .",
    "[ lem_procrastinating ] there exists at least one procrastinating policy that is a solution of ( [ eqn_problem_twc ] ) .",
    "let @xmath46 be an optimal policy which is not procrastinating , i.e. , there exists @xmath47 for some @xmath18 , @xmath15 and @xmath14 , @xmath24 .",
    "starting from @xmath48 , if @xmath49 , set @xmath50 , and update @xmath51 and @xmath52 .",
    "this postpones excess transferred energy to the next time slot whenever ( [ eqn_lazy1 ] ) is violated .",
    "note that the update in time slot @xmath17 only affects @xmath28 and @xmath53 in ( [ eqn_problem_twc_b ] ) , decreasing the former by @xmath54 and increasing the latter by @xmath55 .",
    "however , since @xmath34 in the original policy and @xmath56 from lemma  [ lem_unidirectional ] , this change does not violate ( [ eqn_problem_twc_b ] ) . repeating the updates for @xmath57 and @xmath4",
    "yields a feasible procrastinating policy .",
    "meanwhile , since @xmath58 is unchanged , the objective in ( [ eqn_problem_twc_a ] ) is unchanged , and therefore the resulting procrastinating policy is also optimal .",
    "lemma  [ lem_procrastinating ] shows that by delaying energy transfers unless immediately required for transmission , any feasible transmit power policy @xmath59 can be realized with a procrastinating policy .",
    "next , we utilize this property to decompose ( [ eqn_problem_twc ] ) into two subproblems regarding the energy harvesting and energy cooperation aspects of the original problem .",
    "we define the _ consumed power _ @xmath60 as the power drawn from the battery of node @xmath8 , taking both transmission and transfers in time slot @xmath17 into consideration .",
    "this term is expressed as @xmath61 note that by definition , consumed power can be negative . however , a procrastinating policy , as defined in definition  [ def_lazy ] , satisfies @xmath62 for all @xmath13 and @xmath4 .",
    "we first present the following lemma .",
    "[ lem_unidirectional ] there exists an optimal policy which satisfies @xmath63 for all @xmath43 , @xmath24 , @xmath13 , i.e. , energy transfer is never in both directions in a given time slot .",
    "let @xmath46 be an optimal policy .",
    "define @xmath64 for all @xmath43 , @xmath65 , and @xmath66 , which satisfies @xmath67 .",
    "with these energy transfers , @xmath28 in ( [ eqn_properties_bk ] ) increases for all @xmath14 and @xmath17 , and therefore the procrastinating policy @xmath68 is feasible .",
    "since @xmath58 are unchanged , it also yields the same objective as @xmath69 and is therefore optimal .",
    "lemma  [ lem_unidirectional ] is a natural consequence of transfer efficiencies being less than 100% , and is intuitively pleasing . as a consequence of the lemma",
    ", we can restrict our attention to policies satisfying the lemma without loss of optimality .",
    "hence , for procrastinating policies satisfying the lemma , the non - negativity constraints @xmath70 in ( [ eqn_problem_twc_c ] ) are equivalent to @xmath71 , @xmath13 , @xmath4 . restricting the feasible set of ( [ eqn_problem_twc ] ) to procrastinating policies satisfying lemma  [ lem_unidirectional ] , without loss of optimality , we rewrite ( [ eqn_problem_twc ] ) as    [ eqn_problem2 ] @xmath72 \\bigg ) \\\\",
    "\\label{eqn_problem2_b }      \\mbox{s.t . }",
    "\\quad ~ & \\sum_{n=1}^{i}e_{k , n } - \\bar{p}_{k , n } \\geq 0 , ~~ k=1,2 , ~ i=1,\\dots , n , \\\\ \\label{eqn_problem2_c }      & \\bar{p}_{k , i } \\geq \\delta_{k , i } , ~ \\delta_{k , i } \\geq 0 , ~~ k=1,2 , ~ i=1,\\dots , n.\\end{aligned}\\ ] ]    here , @xmath73=(p_{1,i},p_{2,i})$ ] denotes both parameters of @xmath74 , which are found by substituting @xmath4 and @xmath24 .",
    "note that the constraints in ( [ eqn_problem_twc_b ] ) , which include both energy transfers @xmath22 and transmit powers @xmath21 , are replaced with ( [ eqn_problem2_b])-([eqn_problem2_c ] ) where energy transfers and consumed powers are now decoupled .",
    "furthermore , the @xmath17th summation term in the objective ( [ eqn_problem2_a ] ) depends only on the variables for the respective time slot @xmath17 .",
    "hence , ( [ eqn_problem2 ] ) can be decomposed as    [ eqn_problem_pa ] @xmath75    where @xmath76 is the _ per - slot sum - rate _ for consumed powers @xmath77 and @xmath78 , defined as    [ eqn_problem_et ] @xmath79 \\right ) \\\\",
    "\\label{eqn_problem_et_b } & ~~ \\mbox{s.t . }",
    "~~ \\bar{p}_{k , i } \\geq \\delta_{k , i } , ~~ \\delta_{k , i } \\geq 0 , ~k=1,2.\\end{aligned}\\ ] ]    note that ( [ eqn_problem_et ] ) yields the optimal energy transfers @xmath22 within a single time slot @xmath17 for a fixed pair of consumed powers @xmath80 .",
    "being separated from @xmath22 , ( [ eqn_problem_pa ] ) finds the optimal allocation of consumed powers @xmath60 , @xmath13 throughout the transmission .",
    "this decomposition implies that the power transfer optimization can be performed separately and in a slot - by - slot basis , i.e. , the optimal energy transfers @xmath22 can be found using only the consumed powers @xmath60 in the same time slot .",
    "[ lem_concavity_of_r ] @xmath81 , is jointly concave in @xmath82 and @xmath83 .",
    "the proof can be found in appendix  [ app_proof_concavity ] .    as a result of lemma  [ lem_concavity_of_r ] ,",
    "the consumed power allocation problem in ( [ eqn_problem_pa ] ) is a convex program .",
    "furthermore , the constraints in ( [ eqn_problem_pa_b ] ) and ( [ eqn_problem_pa_c ] ) are separable among transmitters @xmath4 , and hence a block coordinate descent ( alternating maximization ) algorithm that alternates between @xmath84 and @xmath85 converges to the optimal policy @xcite .",
    "in particular , at each iteration , a single transmitter problem with a concave objective function and linear energy causality constraints is solved .",
    "the iterations evolve , alternating over the optimized variables , until the policies converge .",
    "namely , we solve    [ eqn_problem_pa_iter ] @xmath86    for a fixed @xmath14 at each iteration , alternating between @xmath87 and @xmath88 , while @xmath89 , @xmath24 , is held constant .",
    "note that ( [ eqn_problem_pa_iter ] ) differs from its counterpart without energy cooperation @xcite only in the rate function @xmath76 .",
    "however , @xmath90 , @xmath24 , may change in time , and hence the solution to each iteration step in ( [ eqn_problem_pa_iter ] ) is not the constant power policy in @xcite .",
    "instead , it can be found using a generalized directional water - filling algorithm , as we will describe next .",
    "the decomposition in ( [ eqn_problem_pa])-([eqn_problem_et ] ) simplifies the analysis of the problem by separating the power allocation problem from energy transfer variables @xmath91 , and calculating optimal energy transfers in a slot - by - slot basis .",
    "we first solve the energy transfer problem within a single slot , i.e. , ( [ eqn_problem_et ] ) , which we then substitute in ( [ eqn_problem_pa_iter ] ) to solve ( [ eqn_problem_pa ] ) .",
    "consider time slot @xmath17 first .",
    "we focus on the two subsets of the feasible space of ( [ eqn_problem_et ] ) , namely those satisfying @xmath92 and @xmath93 , one of which contains an optimal policy as implied by lemma  [ lem_unidirectional ] .",
    "we solve ( [ eqn_problem_et ] ) for these subsets , and choose the maximum of the two .",
    "for the policies satisfying @xmath94 , the solution to ( [ eqn_problem_et ] ) is found as @xmath95^+ \\right\\}\\end{aligned}\\ ] ] for @xmath96 , where @xmath97^+$ ] denotes @xmath98 .",
    "this yields two optimal transfer candidates , @xmath99 and @xmath100 , each requiring the other to be zero .",
    "note that the case where both candidates are positive , i.e. , @xmath101 and @xmath102 , requires @xmath103 , which is not possible since @xmath104 by definition .",
    "hence , at least one of the two candidates is always zero , and ( [ eqn_twc_et_solution ] ) immediately gives the solution to ( [ eqn_problem_et ] ) .",
    "the per - slot sum - rate achieved by the optimal energy transfer policy , corresponding to @xmath76 in ( [ eqn_problem_pa ] ) and ( [ eqn_problem_et ] ) , is then expressed as @xmath105      substituting ( [ eqn_twoway_r ] ) in ( [ eqn_problem_pa_iter ] ) , it remains to solve for the optimal @xmath106 by iterating between @xmath77 and @xmath78 .",
    "we now show that the solution to each iteration admits a _ generalized directional water - filling _ interpretation , and consequently ( [ eqn_problem_twc ] ) can be solved using the generalized iterative directional water - filling algorithm @xcite .    as shown in lemma",
    "[ lem_concavity_of_r ] , ( [ eqn_problem_pa_iter ] ) is a convex program with affine constraints .",
    "we also remark that @xmath81 in ( [ eqn_twoway_r ] ) is a continuously differentiable function in both @xmath107 and @xmath108 .",
    "hence , the kkt optimality conditions of ( [ eqn_problem_pa_iter ] ) are necessary and sufficient for optimality , and are found as @xmath109 for @xmath43 , @xmath24 , and @xmath13 . here , @xmath110 and @xmath111 are the lagrange multipliers for the constraints in ( [ eqn_problem_pa_iter_b ] ) and ( [ eqn_problem_pa_iter_c ] ) , respectively . for the optimal @xmath106 solving ( [ eqn_problem_pa_iter ] ) ,",
    "there exists a set of non - negative lagrangian multipliers that satisfy the conditions in ( [ eqn_inf_stat_1])-([eqn_inf_cs_1 ] ) , and vice versa .",
    "we define @xmath112 from ( [ eqn_inf_cs_1 ] ) , we observe that whenever @xmath113 , we have @xmath114 . in this case , from ( [ eqn_inf_stat_1 ] ) , we see that optimal @xmath115 are constant in @xmath17 unless @xmath116 .",
    "meanwhile , a positive @xmath117 is only possible when @xmath118 , i.e. , the battery is empty .",
    "moreover , since @xmath117 are non - negative , optimal @xmath115 are non - decreasing in @xmath17 . due to this behavior",
    ", we refer to @xmath115 as _ generalized water levels _ , and utilize the directional water - filling interpretation in @xcite to find the optimal water levels .    in particular ,",
    "in each iteration for @xmath8 , transmit powers and water levels are initialized by setting @xmath119 for all @xmath13 .",
    "if the water levels satisfy @xmath120 for some @xmath17 , this results in water ( energy ) flow from slot @xmath17 to slot @xmath121 , which is achieved by decreasing @xmath60 and increasing @xmath122 by the same amount .",
    "the flow stops when the two water levels are equalized , or when @xmath123 . in the latter case , ( [ eqn_inf_stat_1 ] )",
    "is satisfied via some @xmath124 , which is feasible since @xmath123 .",
    "flow in the reverse direction , e.g. , from time slot @xmath121 to @xmath17 , is not allowed since it violates the energy causality constraints in ( [ eqn_problem_twc_b ] ) .",
    "the algorithm terminates when water levels do not permit any water flow .",
    "the generalized directional water - filling algorithm above is then repeated at each iteration . for the iterations on @xmath60 , where @xmath90 , @xmath24 is kept constant , the water levels are given by @xmath125    we present an example of the directional water - filling algorithm for @xmath126  time slots of length @xmath12  sec and @xmath127 in fig .",
    "[ fig_wf_twc ] .",
    "energy arrivals to the two nodes are @xmath128 $ ]  mj and @xmath129 $ ]  mj .",
    "the final ( equilibrium ) water levels are shown in blue for node @xmath0 , and in green for node @xmath1 , for @xmath130  db , and @xmath131  w for a 1  mhz bandwidth . observe that in the first time slot , @xmath132  mw and @xmath133 yields the optimal energy transfers @xmath134  mj and @xmath135 , i.e. , node @xmath0 transfers @xmath12  mj of energy to node @xmath1 as indicated with the red arrow .",
    "the energy transfer candidates for time slots @xmath136 are zero , and no energy is transferred . in the last time slot , the optimal energy transfer rate is found as @xmath137 and @xmath138  mj , i.e. , the energy transfer is from node @xmath1 to node @xmath0 . with the final water levels in the figure ,",
    "no further water flow is feasible for either node .    ) . ]",
    "we next consider a two - hop channel ( thc ) with infinite - sized batteries as a simple example of a multi - hop setting as done in @xcite , extended to bi - directional energy transfers .",
    "the channel model is as shown in fig .",
    "[ fig_twohop_model ] . for this case",
    ", we denote the transmit power of the source node by @xmath35 , the relay node by @xmath36 , and the source - relay and relay - destination channel power gains by @xmath10 and @xmath11 , respectively .",
    "the messages are delay constrained , and the relay node @xmath1 needs to forward all received messages immediately to the destination .",
    "as such , the relay does not have a data buffer , and departs packets in the same time slot they are received . the source and the relay are both capable of energy transfer .",
    "the sum - capacity for this channel with a full - duplex relay is given by @xmath139 note that as in the two - way model , @xmath140 is jointly concave in @xmath35 and @xmath36 since it is the minimum of two jointly concave functions .",
    "hence , the throughput maximization problem for this channel also satisfies lemma  [ lem_procrastinating ] , and therefore allows the decomposition in ( [ eqn_problem_pa])-([eqn_problem_et ] ) .",
    "given the capacity expression in ( [ eqn_twohop_rate ] ) , the two - hop version of ( [ eqn_problem_et ] ) can be written as    [ eqn_twohop_et ] @xmath141    the objective is the minimum of two linear functions , and the two terms of the minimum change in opposite directions with @xmath142 or @xmath143 .",
    "hence , the optimal is attained when the two terms are equal , if feasible . solving ( [ eqn_twohop_et ] ) for @xmath142 and @xmath143 satisfying @xmath144 yields the energy transfers    [ eqn_marc_delta_opt_single ] @xmath145 ^+ , \\\\ \\delta_{2,i } & = \\left [ \\frac{\\sigma_2 ^ 2 h_2\\bar{p}_{2,i } - \\sigma_1 ^ 2 h_1 \\bar{p}_{1,i}}{\\alpha_{2}\\sigma_1 ^ 2 h_1 + \\sigma_2 ^ 2 h_2 } \\right ] ^+ , \\end{aligned}\\ ] ]    where @xmath97^+$ ] denotes @xmath98 . since @xmath146 , these energy transfer values are feasible and therefore optimal .",
    "observe that due to ( [ eqn_marc_delta_opt_single ] ) , the difference of received powers , i.e. , @xmath147 determines the direction of energy transfer , and the transferred energy is nonzero unless the two received powers are equal .      substituting the optimal values in ( [ eqn_marc_delta_opt_single ] ) into the power allocation problem in ( [ eqn_problem_pa ] ) yields    [ eqn_marc_subproblem ] @xmath148    due to the convexity of the problem , the generalized iterative water - filling algorithm in section  [ sub_twc_pa ]",
    "can also be used for ( [ eqn_marc_subproblem ] ) by solving ( [ eqn_marc_subproblem ] ) iteratively in @xmath84 and @xmath85 . in this model ,",
    "the generalized water levels are found for the @xmath106 iteration , keeping @xmath89 , @xmath65 constant , as @xmath149 we remark that the water levels are linear in transmit powers , and therefore the algorithm resembles conventional water - filling @xcite . in the iteration on @xmath106 ,",
    "the consumed powers @xmath89 , @xmath24 are kept constant , which introduces a base level over which water - filling is performed .",
    "the first terms in ( [ eqn_thc_wlevel ] ) are consumed powers , the second terms are base levels due to the other transmitter , and the third terms are constant .",
    "we further remark that water levels @xmath150 and @xmath151 are linearly related , with ratio @xmath152 or @xmath153 depending on the direction of energy transfer . as a consequence ,",
    "unless @xmath154 , if the water levels in two consecutive time slots are equal for both transmitters , the direction of energy transfer must remain the same as well .",
    "an insight that can be drawn from this observation is that the direction of energy transfer remains unchanged in time unless the water levels change for one of the nodes , which only occurs when the respective node is out of energy .",
    "combining these two remarks , we observe that the generalized directional water - filling algorithm has an intuitive two - fluid interpretation for the two - hop channel .",
    "namely , we can solve ( [ eqn_marc_subproblem ] ) by considering @xmath77 and @xmath78 as levels of _ two immiscible fluids _ , and scaling these fluids appropriately in each iteration while performing directional water - filling based on the total water level .",
    "the analogy is even more apparent in the uni - directional energy transfer case , where @xmath155 .",
    "this gives @xmath156 whenever @xmath157 , thus restricting the solution to @xmath158 . with this restriction , we have @xmath159 , and therefore no iteration is necessary .",
    "the optimal consumed powers are found as the resulting water levels when both fluids are allowed to flow while satisfying the condition @xmath158 .",
    "an example to this two - fluid water - filling is depicted in fig .  [ fig_waterfilling ] for @xmath160 , @xmath155 , @xmath161 $ ]  mj ,",
    "@xmath162 $ ]  mj , and the same channel parameters in fig .",
    "[ fig_wf_twc ] . note that in this example , water flow for node @xmath1 ( green ) from @xmath163 to @xmath164 occurs , even against the level gradient , until the condition @xmath165 is satisfied .    .",
    "the blue , green and orange areas correspond to source consumption @xmath166 , relay consumption @xmath167 and the constant term in ( [ eqn_thc_wlevel ] ) , respectively . ]",
    "in this section , we extend the results in sections  [ sect_properties ] and [ sect_twc ] to the gaussian multiple access channel ( mac ) with infinite - sized batteries , shown in fig .",
    "[ fig_mac_model ] .",
    "the sum - capacity for this channel in time slot @xmath17 is given by @xmath168 the corresponding sum - throughput maximization problem , i.e. , the mac version of ( [ eqn_problem_twc ] ) , is    [ eqn_problem_mac ] @xmath169    since @xmath170 is also jointly concave in @xmath35 and @xmath36 , the mac sum - throughput maximization problem also satisfies lemma  [ lem_procrastinating ] , yielding the decomposition in ( [ eqn_problem_pa])-([eqn_problem_et ] ) . in the following subsections ,",
    "we address the energy transfer and power allocation subproblems for the mac .      substituting the consumed powers in ( [ eqn_equivalent_consumed ] ) into ( [ eqn_problem_mac ] ) yields    [ eqn_problem_mac_pa ] @xmath171 \\right ) \\\\",
    "\\label{eqn_problem_mac_pa_b }      \\mbox{s.t . }",
    "~ & \\sum_{n=1}^{i}e_{k , n } - \\bar{p}_{k ,",
    "n } \\geq 0 , \\quad k=1,2,~ i=1,\\dots , n,\\end{aligned}\\ ] ]    where @xmath142 and @xmath143 are found as the solution to the energy transfer problem    [ eqn_problem_mac_et ] @xmath172    note that ( [ eqn_problem_mac_et ] ) is a linear program , with the optimal achieved at a corner of the rectangle defined by ( [ eqn_problem_mac_et_b ] ) .",
    "the optimal policy is to choose @xmath173 if @xmath174 , and choose @xmath175 otherwise .",
    "consequently , the allocated power at @xmath8 is entirely transferred to @xmath23 if @xmath174 , or is entirely used for transmission if @xmath176 .",
    "this also implies that energy transfers only depend on the channel parameters , and hence the optimal energy transfer direction remains the same throughout the transmission . as a result , uni - directional energy transfer is sufficient from one user to the other in the direction determined by the channels and their transfer efficiency values .",
    "the analysis in section  [ sub_mac_optimal ] reveals that in the optimal policy , either no energy transfer occurs , or one node transfers all of its energy to the other . in the former case , we get an energy harvesting mac without energy transfers , the sum - capacity of which was found in @xcite .",
    "the problem is solved by combining harvested energy in a single pool , thus reducing the problem to the single link power allocation problem in @xcite . in the latter case ,",
    "let @xmath177 without loss of generality . then , the optimal energy transfers in section  [ sub_mac_optimal ] yield the water - levels @xmath178 note that @xmath179 . in this case",
    ", we can equivalently consider the policy of node @xmath0 only , and transfer all energy harvested by node @xmath1 immediately to node @xmath0 .",
    "we establish this by scaling @xmath180 with the end - to - end efficiency of the transfer , @xmath152 , and adding them to the harvests of the transmitting node , @xmath181 .",
    "the resulting problem consists of a single energy harvesting link , which can be solved as in @xcite .",
    "therefore , in both cases , the power allocation problem reduces to that of a single link . in order to generalize the solution to all cases , we define @xmath182 and find the optimal power allocation policy as the solution to the single user problem with equivalent energy harvests @xmath183 the solution is a piecewise constant , non - decreasing sum - power policy , in which the sum - power only changes when",
    "all batteries are depleted .",
    "a depiction of the optimal sum - power policy is presented in fig .",
    "[ fig_stairs_mac ] for @xmath126 time slots , where the staircase represents the cumulative harvested energy and the piecewise linear curve represents the cumulative consumed energy .     time slots . ]    optimality of procrastinating policies also extends to channels with more than two transmitters , such as the @xmath184-user mac , as shown in @xcite . in this case , lemma  [ lem_unidirectional ] extends to not transferring and receiving energy simultaneously , regardless of the direction ( * ? ? ?",
    "* lemma  1 ) .",
    "the procrastination condition extends to the sum of energy transfers arriving to a node ( * ? ? ?",
    "* eqn  12 ) .",
    "this allows the iterative directional water - filling algorithms above to be used for such models , by iterating over all transmitters .",
    "due to space restrictions , we refer the reader to @xcite for details .",
    "we now extend our model , formulation , and solution to nodes with finite - sized batteries . in lemma  [ lem_procrastinating ]",
    ", it is shown that an optimal procrastinating policy exists if the batteries are infinite - sized .",
    "this is justified by always being able to postpone energy transfers which are not consumed within the same time slot , i.e. , which do not satisfy ( [ eqn_lazy1 ] ) . in the case of finite - sized batteries ,",
    "this argument is no longer sufficient , since postponing energy transfers from @xmath8 to @xmath23 may yield a battery overflow at @xmath8 that the original energy transfer policy would have avoided . in this section",
    ", we provide a class of policies that procrastinate to the point they can avoid such overflows , and show that they are optimal policies for the ehec two - way channel with finite - sized batteries .",
    "consider the finite battery two - way channel model in section  [ sect_model ] , i.e. , @xmath185 in ( [ eqn_model_bk ] ) .",
    "we first reiterate that the optimal policy should not cause any battery overflows .",
    "this is an extension of ( * ? ? ?",
    "* lemma 2 ) , which states that a power policy that yields a battery overflow is suboptimal . in particular , energy overflow in time slot @xmath17 can be avoided by consuming more energy in time slot @xmath186 .",
    "this strictly increases the sum - throughput in time slot @xmath186 , and does not affect the battery state @xmath187 for @xmath188 .",
    "therefore , without loss of optimality , we restrict our attention to policies that do not cause energy overflows",
    ". we use ( [ eqn_properties_bk ] ) , while imposing the constraint @xmath189 in ( [ eqn_problem_twc ] ) . the equivalent sum - throughput maximization problem for a twc with finite - sized batteries is    [ eqn_problem_twc_finite ] @xmath190    where @xmath28 is given by ( [ eqn_properties_bk ] ) .",
    "we next modify the set of procrastinating policies to prevent energy overflows .",
    "we begin by splitting @xmath22 into two components , @xmath191 and @xmath192 , as @xmath193 these components represent the portion of the transferred energy that is consumed immediately , and the excess portion that is stored for future use , respectively . clearly",
    ", power policies defined as @xmath194 include all feasible power policies for ( [ eqn_problem_twc ] ) . based on these variables ,",
    "we define _ partially procrastinating policies _ , which are an extension of procrastinating policies in section  [ sub_equivalent_procrastinating ] , as follows :    [ def_pro ] a power policy @xmath194 is a partially procrastinating policy if it satisfies @xmath195 for @xmath43 , @xmath24 , and @xmath13 .    in a _ partially procrastinating _ policy , the condition for procrastination , i.e. , ( [ eqn_lazy1 ] ) , is restricted to the immediately consumed component @xmath196 , as seen in ( [ eqn_pro_def1 ] )",
    ". meanwhile , the excess component @xmath197 can only be nonzero if the battery of @xmath8 is full , i.e. , @xmath198 , as dictated by ( [ eqn_pro_def3 ] ) .",
    "this component allows transferring the excess energy that would otherwise be lost due to battery overflows .",
    "we next show that there exists at least one optimal policy that is partially procrastinating .",
    "[ lem_procrastinating_partial ] there exists a partially procrastinating policy @xmath194 such that the transferred energy values @xmath91 calculated from ( [ eqn_pro_delta ] ) and the transmit powers @xmath59 solve ( [ eqn_problem_twc_finite ] ) .",
    "the proof can be found in appendix  [ app_proof_partial ] .",
    "we update the definition of consumed powers in ( [ eqn_equivalent_consumed ] ) as @xmath199 for @xmath43 , @xmath24 , and @xmath13 . substituting in ( [ eqn_properties_bk ] ) , this yields the battery state @xmath200 we next rewrite ( [ eqn_problem_twc_finite ] ) in terms of @xmath60 , @xmath196 , and @xmath197 as    [ eqn_problem_twc_finite2 ] @xmath201 \\right ) & & & ~\\\\ \\label{eqn_problem_twc_finite2_b } \\mbox{s.t . }",
    "\\quad ~~     & e_k^{max } \\geq s_{k , i } \\geq 0 ,     ~~ k=1,2 , ~ i=1,\\dots , n , \\\\ \\label{eqn_problem_twc_finite2_c }                  & \\hspace{-0.5 in } \\bar{p}_{k , i } \\geq \\gamma_{k , i } \\geq 0 , ~ \\gamma_{1,i}\\gamma_{2,i}=0 , ~~ k=1,2 , ~ i=1,\\dots , n , \\\\ \\label{eqn_problem_twc_finite2_d }                  & \\hspace{-0.5 in } \\bar{p}_{k , i } \\geq 0 , ~ \\epsilon_{k , i } \\geq 0 ,   ~~ k=1,2 , ~ i=1,\\dots , n.\\end{aligned}\\ ] ]    in ( [ eqn_problem_twc_finite2 ] ) , we have selectively imposed the partial procrastination conditions ( [ eqn_pro_def1 ] ) and ( [ eqn_pro_def2 ] ) without loss of optimality due to lemma  [ lem_procrastinating_partial ] .",
    "note that ( [ eqn_problem_twc_finite2_a ] ) and ( [ eqn_problem_twc_finite2_c ] ) are independent of @xmath197 , while ( [ eqn_problem_twc_finite2_b ] ) and ( [ eqn_problem_twc_finite2_d ] ) are independent of @xmath196 .",
    "moreover , the @xmath17th summation term in ( [ eqn_problem_twc_finite2_a ] ) depends on @xmath60 , @xmath196 , and @xmath197 only , allowing us to decompose ( [ eqn_problem_twc_finite2 ] ) as    [ eqn_finite_problempa ] @xmath202    where @xmath76 is the per - slot sum - rate , given by    [ eqn_finite_problemet ] @xmath203 \\right)\\\\ \\label{eqn_finite_problemet_b } \\mbox{s.t . } ~~ & ~ \\bar{p}_{k , i } \\geq \\gamma_{k , i } \\geq 0 , \\quad k=1,2,\\\\ \\label{eqn_finite_problemet_c }      & ~ \\gamma_{1,i}\\gamma_{2,i}=0.\\end{aligned}\\ ] ]    we remark that ( [ eqn_finite_problempa ] ) and ( [ eqn_finite_problemet ] ) are the finite - sized battery extensions of the power allocation and energy transfer problems in ( [ eqn_problem_pa ] ) and ( [ eqn_problem_et ] ) , respectively . as in section  [ sub_twc_et ]",
    ", the solution to ( [ eqn_finite_problemet ] ) is given by ( [ eqn_twc_et_solution])-([eqn_twoway_r ] ) .",
    "it remains to solve ( [ eqn_finite_problempa ] ) and identify the optimal @xmath106 and @xmath204 .",
    "observing that ( [ eqn_finite_problempa ] ) is a convex program , we write the kkt optimality conditions @xmath205 for @xmath43 , @xmath24 , and @xmath13 . here ,",
    "@xmath110 and @xmath206 are the lagrange multipliers for the constraints in ( [ eqn_finite_problempa_b ] ) , and @xmath111 and @xmath207 are the lagrange multipliers for the constraints in ( [ eqn_finite_problempa_c ] ) .",
    "for the water levels in ( [ eqn_inf_waterlevel ] ) , ( [ eqn_finite_stat_1 ] ) yields @xmath208    for @xmath209 , the optimal water levels @xmath210 may increase only when the battery is empty , @xmath118 , and decrease only when the battery is full , @xmath211 . omitting ( [ eqn_finite_stat_2 ] ) , this is the finite - sized battery extension of ( [ eqn_inf_stat_1])-([eqn_inf_cs_1 ] ) , and can be solved by the iterative generalized directional water - filling algorithm where the water flow between time slots is limited to @xmath212 @xcite .",
    "note that energy cooperation over @xmath197 introduces the possibility of energy ( and hence water ) flow between the two nodes in addition to between two time slots .",
    "this flow dimension was first considered in the _ two dimensional directional water filling algorithm _",
    "( 2d - dwf ) in ( * ? ? ?",
    "1 ) for nodes with infinite batteries . here",
    ", we extend it to the finite - sized battery case , and simplify the algorithm significantly by observing the structure of optimal energy transfers @xmath204 .",
    "if the generalized directional water - filling algorithm with finite - sized batteries yields @xmath213 for some @xmath17 , then @xmath214 is optimal , i.e. , energy transfer from @xmath8 to @xmath23 with the purpose of storage is not necessary in the optimal policy .",
    "since @xmath106 is the output of the generalized directional water - filling algorithm , there exists @xmath117 , @xmath215 , and @xmath216 that satisfy ( [ eqn_finite_stat_1 ] ) , ( [ eqn_finite_cs_1 ] ) , and ( [ eqn_finite_cs_2 ] ) .",
    "given @xmath213 , the second sum term in ( [ eqn_finite_stat_2 ] ) is equal to @xmath217 , while the first sum term in ( [ eqn_finite_stat_2 ] ) is greater than or equal to @xmath218 due to @xmath111 . by ( [ eqn_wlevel_1 ] ) , water levels always satisfy @xmath219 , and hence ( [ eqn_finite_stat_2 ] ) can be satisfied for some @xmath220 by choosing @xmath214 .",
    "the lemma implies that it is sufficient to have a nonzero @xmath197 only when @xmath221 .",
    "we combine this insight with the condition in ( [ eqn_pro_def3 ] ) , which implies that it is sufficient to have a nonzero @xmath197 only when the battery of @xmath8 is full , and propose the _ 2d - dwf algorithm _ * _ with restricted transfers_*. in this implementation , we modify the 2d - dwf algorithm by allowing water flow from @xmath8 to @xmath23 only if the battery of @xmath8 is full and @xmath221 .",
    "we allow water flow until ( [ eqn_finite_stat_2 ] ) is satisfied for @xmath222 .",
    "in accordance with the battery capacity constraint , we also limit the water flow among neighboring time slots to @xmath20 .",
    "the 2d - dwf algorithm with restricted transfers is demonstrated in fig .",
    "[ fig_finite_example ] .",
    "initially , the entire harvested energy @xmath19 is allocated to transmission , i.e. , @xmath223 , and water levels are obtained from ( [ eqn_wlevel_1 ] ) .",
    "this state is depicted in fig .",
    "[ fig_finite_example]a .",
    "next , directional water flow is allowed for each user individually and in time only , i.e. , flow in the vertical direction is not allowed .",
    "the _ taps _ marked with right facing arrows limit water flow to a maximum of @xmath20 between time slots .",
    "the resulting water levels are shown in fig .",
    "[ fig_finite_example]b .",
    "finally , vertical water flow is allowed only in the time slots ending with a full battery , e.g. , at @xmath163 from @xmath0 to @xmath1 , by turning on the taps marked with vertical arrows .",
    "water flow from @xmath0 to @xmath1 continues until ( [ eqn_finite_stat_2 ] ) is satisfied , yielding the optimal water levels in fig .",
    "[ fig_finite_example]c .",
    "recall that water flow from @xmath8 to @xmath23 , which represents @xmath197 , is only one component of transferred energy .",
    "energy transfer @xmath22 may be taking place at @xmath224 via the immediately consumed component @xmath196 , which are found using ( [ eqn_twc_et_solution ] ) .",
    "to @xmath23 is not allowed unless the battery of @xmath8 is full , as seen at @xmath163 in ( b ) . ]",
    "the proof of lemma  [ lem_procrastinating_partial ] is independent of the objective function of ( [ eqn_problem_twc_finite ] ) .",
    "hence , the optimality of partially procrastinating policies , shown in lemma  [ lem_procrastinating_partial ] , immediately extends to the two - hop and multiple access models in sections  [ sect_twohop ] and [ sect_mac ] . as a result",
    ", the 2d - dwf algorithm with restricted transfers can be used for these models as well , provided that the water levels are updated as in ( [ eqn_thc_wlevel ] ) for the thc and ( [ eqn_mac_wlevel ] ) for the mac .",
    "in our simulations of the three channel models , we consider a transmission period of @xmath225 time slots , a noise spectral density of @xmath226  w / hz and a bandwidth of @xmath227  mhz for both nodes .",
    "battery capacities are @xmath228  mj . unless otherwise stated , the energy arrivals are generated uniformly and independently in @xmath229 $ ]  mj , the channel power gains are @xmath130  db , and the energy transfer efficiency values are @xmath230 .",
    "these are typical system parameters similar to those in previous work @xcite .",
    "for the purpose of comparison with conventional power allocation policies , we also evaluate the performance of a _ constant power policy_. nodes employing the constant power policy attempt transmission with a transmit power equal to their average energy harvesting rate , i.e. , @xmath231\\}$ ] , whenever they are not in an energy outage . to verify that the difference in performance is not solely due to energy cooperation",
    ", we additionally allow energy cooperation between nodes employing the constant power policy for their consumed powers , i.e. , @xmath232\\}$ ] , while allowing the optimal instantaneous energy transfers given by ( [ eqn_twc_et_solution ] ) , ( [ eqn_marc_delta_opt_single ] ) and below ( [ eqn_problem_mac_et ] ) .      for the two - way channel , the average sum - throughput values are plotted in fig .",
    "[ fig_sim_twc ] for the optimal policy with two - way energy cooperation , optimal policy without energy cooperation , and the two constant power policies .",
    "the plots are obtained by varying the peak harvest rate of @xmath0 , referred to as @xmath233 , in @xmath229 $ ]  mj , while @xmath234 is distributed uniformly on @xmath235 $ ] .",
    "it can be observed that energy cooperation yields a significant increase in performance , particularly since @xmath0 is energy deprived compared to @xmath1 . in other evaluations not shown here , a similar insight is observed to hold when one node has a notably worse channel .",
    "constant power policies , on the other hand , perform consistently worse than the respective optimal policies found via generalized directional water - filling .",
    "for the two - way channel with and without energy transfer , compared with the heuristic constant power policy . ]    in most cases , one node is clearly at a disadvantage in terms of energy , and the direction of optimal energy transfer is usually fixed , i.e. , uni - directional energy transfer usually suffices to achieve the maximum throughput with energy cooperation .",
    "however , cases where bi - directional transfer outperforms uni - directional transfer in either direction are frequently observed .",
    "these include cases where the energy budgets and channel parameters of the nodes are comparable , where the energy - deprived node changes within the transmission duration , and where the battery capacity is reached at both nodes at different points in time .",
    "an example is shown in fig .",
    "[ fig_sim_oneway ] for the same channel parameters in fig .",
    "[ fig_sim_twc ] but with an energy arrival scenario where @xmath0 is energy deprived for one half of the transmission , and @xmath1 is energy deprived for the other .",
    "note that for low or high harvest rates for node @xmath0 , the uni - directional energy transfer performs better in different directions , and both directions are essential to achieve the optimal throughput .    .",
    "]    fig .",
    "[ fig_sim_oneway ] also shows the _ no excess energy transfers _ policy , where the excess energy transfers @xmath197 are forced to be zero while instantaneously consumed energy transfers , @xmath196 are chosen freely .",
    "the departure of this policy from the full cooperation case indicates that the excess energy transfers are necessary to find the optimal policy , whereas their impact on throughput is not as significant as the impact of instantaneously consumed energy transfers .",
    "this departure can be seen more clearly in fig .",
    "[ fig_sim_twc_alpha ] , in which @xmath236  mj is fixed , and the transfer efficiency @xmath153 is varied in @xmath237 $ ] .",
    "we also remark that below a certain energy transfer efficiency , energy cooperation in the direction from @xmath0 to @xmath1 is not necessary to achieve the optimal throughput .",
    "however , as energy transfer becomes more efficient , i.e. , for @xmath238 , the optimal throughput increases for both the uni - directional and bi - directional energy cooperation cases .     for the two - way channel .",
    "]      we next provide numerical results for the two - hop channel , by varying the peak harvest rate of @xmath0 in @xmath229 $ ]  mj , in fig .",
    "[ fig_sim_thc ] .",
    "we observe that in this setup , @xmath0 being energy deprived significantly hinders the performance in the absence of energy cooperation , since both @xmath0 and @xmath1 need to have sufficient energy to transmit in order to have non - zero end - to - end throughput .",
    "hence , in this case , energy cooperation is observed to be very useful for low @xmath233 .",
    "meanwhile , the performance of constant power policies are significantly worse .",
    "for the two - hop channel with and without energy transfer , compared with the heuristic constant power policy .",
    "]      finally , we present numerical results for the two - user multiple access channel , once again varying the peak harvest rate of @xmath0 in @xmath229 $ ]  mj .",
    "the channel gains for users 1 and 2 are @xmath239  db and @xmath240  db , respectively . performance of the optimal policies with and without energy transfer , and constant power policies , are shown in fig .  [ fig_sim_mac ] .",
    "it can be seen that when @xmath0 , which has a better channel to the receiver that that of @xmath1 , is energy deprived , energy cooperation from @xmath1 to @xmath0 significantly increases the throughput .     for the multiple access channel with and without energy transfer , compared with the heuristic constant power policy . ]",
    "in this work , we have identified the jointly optimal transmit power and energy cooperation policies of energy harvesting channels for maximizing sum - throughput .",
    "this is done by identifying a class of policies that contain an optimal policy and that enable the decomposition of the problem into energy transfer allocation and consumed power allocation problems that can be solved in tandem .",
    "for the two - way channel , the two - hop channel , and the multiple access channel , we have found optimal procrastinating policies using variations of directional water - filling .",
    "although the algorithms yielding the optimal policies have the water - filling analogy in common , these models display notable differences that also affect the resulting optimal policies .",
    "in particular , in the two - way channel , the two users communication rates are unaffected by one another , and thus water - filling is performed separately and iteratively for each transmitter . on the other hand , in the two - hop channel , the resulting water - filling algorithm admits a two - fluid interpretation .",
    "finally , in the multiple access channel , the sum - rate is governed by the sum - power , and the problem reduces to a single transmitter counterpart with aggregate arrivals based on the efficiency of energy transfers .",
    "overall , we have demonstrated how ( partially ) procrastinating policies simplify the joint optimization problem , both in the infinite and finite battery cases .",
    "simulations have demonstrated that energy cooperation provides a notable increase in sum - throughput , particularly when one node is at a disadvantage in terms of channel power gains or harvesting rate , and the end - to - end throughput depends on both nodes being able to transmit .",
    "we have also noted that energy transfer in one direction is not always sufficient , and that bi - directional cooperation is needed to achieve the maximum sum - throughput .",
    "optimality of procrastinating policies has recently proved to be a useful tool that extends to more involved channel models such as the diamond channel @xcite .",
    "it would therefore be interesting to extend these results to various other channels .",
    "other future directions include considering offline policies for imperfect channel state information or imperfect energy harvest information , online policies inspired by the offline solutions presented in this work , extensions to models with channel fading where channel state information dynamics and availability at various parties can change the underlying rate regions , data buffers , delay constraints , storage inefficiencies , and processing energy cost .",
    "lastly , we note that while we considered a deterministic approach with energy accumulation , transfer , and usage , a queueing treatment of the same remains an interesting future direction .",
    "lemma  [ lem_concavity_of_r ] follows from the constraints ( [ eqn_problem_et_b ] ) being linear , and the function @xmath74 in ( [ eqn_problem_et_a ] ) being jointly concave in its arguments .",
    "specifically , let the solution to ( [ eqn_problem_et ] ) for @xmath241 $ ] and @xmath242 $ ] find @xmath243 $ ] and @xmath244 $ ] , respectively . for consumed powers",
    "@xmath245 $ ] with @xmath246 , the energy transfers @xmath247 $ ] are feasible , and yield @xmath248 ) \\geq ar([\\pi_k])+(1-a)r([\\tilde{\\pi}_k]),\\end{aligned}\\ ] ] due to the joint concavity of @xmath249 in @xmath250 and @xmath251 .",
    "let @xmath46 , @xmath4 , @xmath13 , be a solution to ( [ eqn_problem_twc_finite ] ) .",
    "we will construct a partially procrastinating policy @xmath252 that is feasible .",
    "let @xmath253 , @xmath4 .",
    "starting from @xmath48 , we calculate @xmath254 for @xmath43 , @xmath24 , and @xmath13 .",
    "note that @xmath255 in ( [ eqn_pro_lem1 ] ) satisfy ( [ eqn_pro_def1 ] ) by definition .",
    "next , for @xmath13 , let @xmath256 this yields @xmath257 that satisfy both ( [ eqn_pro_def1 ] ) and ( [ eqn_pro_def2 ] ) .",
    "let @xmath258 for @xmath43 , @xmath24 , and @xmath13 .",
    "starting from @xmath48 , we recalculate @xmath22 from ( [ eqn_pro_delta ] ) using @xmath259 , and calculate @xmath28 using the recalculated @xmath22 , i.e. , @xmath260 for @xmath43 and @xmath24 , while updating the optimal stored component @xmath261 as @xmath262 note that this immediately satisfies ( [ eqn_pro_def3 ] ) for all @xmath43 and @xmath13 .",
    "the process outlined above postpones energy transfers that are not immediately needed via ( [ eqn_pro_lem1])-([eqn_pro_lem2 ] ) , eliminates cases of simultaneous bi - directional energy transfer via ( [ eqn_pro_lem3 ] ) , and transfers excess energy that is overflowing via ( [ eqn_pro_lem5 ] ) .",
    "the resulting policy , @xmath252 , is a partially procrastinating policy .",
    "given that the original policy @xmath46 is feasible , @xmath252 is also feasible by construction .",
    "this policy is also optimal since the objective of ( [ eqn_problem_twc_finite ] ) depends only on the transmit powers @xmath59 , and the transmit powers @xmath263 are equal in both policies .",
    "s.  ulukus , a.  yener , e.  erkip , o.  simeone , m.  zorzi , p.  grover , and k.  huang , `` energy harvesting wireless communications : a review of recent advances , '' _ ieee jour . on selected areas in comm .",
    "_ , vol .",
    "33 , no .  3 , pp .",
    "360381 , mar .",
    "2015 .",
    "a.  kurs , a.  karalis , r.  moffatt , j.  d. joannopoulos , p.  fisher , and m.  soljai , `` wireless power transfer via strongly coupled magnetic resonances , '' _ science _ ,",
    "5834 , pp . 8386 , jul .",
    "2007 .",
    "o.  ozel , k.  tutuncuoglu , j.  yang , s.  ulukus , and a.  yener , `` transmission with energy harvesting nodes in fading wireless channels : optimal policies , '' _ ieee jour . on selected areas in comm .",
    "_ , vol .  29 , no .  8 , pp . 17321743 , sep",
    ". 2011 .",
    "j.  yang and s.  ulukus , `` optimal packet scheduling in a multiple access channel with energy harvesting transmitters , '' _ jour . of comm . and networks , special issue on energy harvesting in wireless networks _ , vol .",
    "14 , no .  2 ,",
    "pp . 140150 , apr .",
    "k.  tutuncuoglu and a.  yener , `` sum - rate optimal power policies for energy harvesting transmitters in an interference channel , '' _ jour . of comm . and networks , special issue on energy harvesting in wireless networks _ ,",
    "14 , no .  2 ,",
    "pp . 151161 , apr .",
    "2012 .    c.  huang , r.  zhang , and s.  cui , `` throughput maximization for the gaussian relay channel with energy harvesting constraints , '' _ ieee jour . on selected areas in comm .",
    "_ , vol .  31 , no .  8 , pp . 14691479 , aug . 2013 .",
    "i.  ahmed , a.  ikhlef , r.  schober , and r.  k. mallik , `` power allocation for conventional and buffer - aided link adaptive relaying systems with energy harvesting nodes , '' _ ieee trans . on wireless comm .",
    "_ , vol .  13 , no .  3 , pp . 11821195 , mar",
    ". 2014 .",
    "y.  luo , j.  zhang , and k.  b. letaief , `` optimal scheduling and power allocation for two - hop energy harvesting communication systems , '' _ ieee trans . on wireless comm .",
    "_ , vol .  12 , no .  9 , pp . 47294741 , sep",
    ". 2013 .",
    "b.  varan and a.  yener , `` the energy harvesting two - way decode - and - forward relay channel with stochastic data arrivals , '' in _ proc .",
    "ieee globalsip symposium on energy harvesting and green wireless comm .",
    "_ , dec . 2013 .",
    "d.  niyato , e.  hossain , and a.  fallahi , `` sleep and wakeup strategies in solar - powered wireless sensor / mesh networks : performance analysis and optimization , '' _ ieee trans . on mobile computing _ ,",
    "vol .  6 , no .  2 ,",
    "221236 , feb .",
    "2007 .",
    "d.  w.  k. ng , e.  s. lo , and r.  schober , `` energy - efficient resource allocation in multiuser ofdm systems with wireless information and power transfer , '' in _ proc .",
    "ieee wireless comm . and networking conference , wcnc _ , apr . 2013 .",
    "d.  s. michalopoulos , h.  a. suraweera , and r.  schober , `` simultaneous information transmission and wireless energy transfer via selecting one out of two relays , '' in _ proc .",
    "6th international symposium on communications , control and signal processing , isccsp _ , apr .",
    " , `` relay selection for simultaneous information transmission and wireless energy transfer : a tradeoff perspective , '' _ ieee jour . on selected areas in comm .",
    "_ , vol .",
    "2015 , [ online ] http://arxiv.org/abs/1303.1647 .",
    "x.  chen , x.  wang , and x.  chen , `` energy - efficient optimization for wireless information and power transfer in large - scale mimo systems employing energy beamforming , '' _ ieee wireless comm .",
    "letters _ , vol .  2 , no .  6 , pp .",
    "667670 , dec . 2013 .",
    "k.  tutuncuoglu and a.  yener , `` multiple access and two - way channels with energy harvesting and bidirectional energy cooperation , '' in _ proc .",
    "information theory and applications workshop , ita _ , feb .",
    "k.  tutuncuoglu , a.  yener , and s.  ulukus , `` optimum policies for an energy harvesting transmitter under energy storage losses , '' _ ieee jour . on",
    "selected areas in comm .",
    ": wireless comm . powered by energy harvesting and wireless energy transfer _ ,",
    "vol .  33 , no .  3 , pp . 467481 , mar ."
  ],
  "abstract_text": [
    "<S> this paper considers multiterminal networks with energy harvesting transmitter nodes that are also capable of wirelessly transferring energy to or receiving energy from other nodes in the network . in particular , the jointly optimal transmit power and energy transfer policies that maximize sum - throughput for the two - way , two - hop , and multiple access channels are identified . </S>",
    "<S> it is shown for nodes with infinite - sized batteries that delaying energy transfers until energy is needed immediately at the receiving node is sum - throughput optimal . </S>",
    "<S> focusing on such _ procrastinating _ policies without loss of optimality , the stated joint optimization problem can be decomposed into energy transfer and consumed energy allocation problems which are solved in tandem . </S>",
    "<S> this decomposition is shown to hold for the finite - sized battery case as well , using partially procrastinating policies that avoid battery overflows . </S>",
    "<S> it is observed that for the two - hop channel , the proposed algorithm has a two fluid water - filling interpretation , and for the multiple access channel , it reduces to a single transmitter problem with aggregate energy arrivals . </S>",
    "<S> numerical results demonstrate the throughput improvement with bi - directional energy cooperation over no cooperation and uni - directional cooperation .    </S>",
    "<S> energy harvesting networks , energy cooperation , procrastinating power policies , two - way channel , two - hop network , multiple access channel , finite energy storage . </S>"
  ]
}