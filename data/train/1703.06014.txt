{
  "article_text": [
    "for classical lens design , a typical problem is to find two surfaces so that the region sandwiched between them and filled with an homogeneous material refracts light in a desired manner . for metalens design ,",
    "a surface is given and the question is to find a function on the surface ( a phase discontinuity ) so that the pair , surface together with the phase discontinuity ( the metalens ) refracts light in a desired manner .",
    "the subject of metalenses is a flourishing area of research and one of the nine runners - up for science s breakthrough of the year 2016 @xcite .",
    "metalenses have been designed for flat geometries with the scalar generalized laws of reflection and refraction with phase discontinuities , see @xcite , @xcite , @xcite , and the comprehensive review article @xcite .",
    "these general laws have been experimentally observed by using arrays of optical antennas on silicon .",
    "the review in @xcite describes the past 15 years of progress on metasurfaces , from experimental realization of the generalized laws of refraction , to applications in wavefront and beam shaping .",
    "recently , it has been proven @xcite that at certain frequencies , a thin layer of nanoparticles on a perfectly conducting sheet acts as a metasurface .",
    "for more recent work in the area and an extensive up to date bibliography , we refer to @xcite ; see also @xcite and @xcite .",
    "the purpose of this paper is to provide a mathematically rigorous foundation to deal with general metasurfaces and to determine the relationships between the curvature of the surface and the phase discontinuity .",
    "a problem we solve is the following : when light emanates from a point source , find a metalens that refracts light into a prescribed set of directions or points , see figure [ fig : general problem ] .",
    "in fact , given a surface and a compatible set of directions , satisfying appropriate curvature type conditions , we show that a phase discontinuity exists on the surface so that the metalens refracts light into the prescribed set of directions , section [ sec : m variable ] .",
    "vice versa , given a phase discontinuity and a fixed direction , we find the admissible surfaces for that phase discontinuity and direction , section [ subsec : given the field find the phase discontinuity ] . of great importance to answer these questions in general geometries is the formulation of a generalized snell s law in vector form , equation , which is deduced using wave fronts in section [ sec : derivationofsnelllawwithfasediscontinuities ] . in term of wave vectors , a vector law is formulated in ( * ? ? ?",
    "* equation ( 2 ) ) . however , equation is effective and flexible for the actual calculation of phase discontinuities in general and to obtain our results .",
    "we illustrate these with explicit constructions for planar and spherical interfaces , sections [ subsec : case of the plane ] , [ subsec : caseofthespherecenteredatzero ] , [ subsec : near field plane case ] , and [ subsec : near field spherical case ] ; see also remark [ rmk : aieta case is incorrect ] .",
    "the outline of the paper is as follows . in section [ sec : classical snell law ] , we briefly recall the classical snell s law for surfaces without phase discontinuities .",
    "then in section [ sec : derivationofsnelllawwithfasediscontinuities ] we derive a generalized snell s law in the presence of a phase discontinuity using wavefronts , equation ( [ vect2 ] ) , and analyze the possible critical angles .",
    "the far field problem is studied in section [ sec : far field uniformly refracting surfaces ] for the plane and the sphere . in section",
    "[ sec : m variable ] we allow for variable directions @xmath0 in the far field . in section [ subsec : given the field find the phase discontinuity ] , conditions are derived so that given a phase discontinuity a surface exists . finally , in section",
    "[ sec : near field case ] the near field problem is addressed .",
    "we recall the classical snell s law in vector form here .",
    "suppose @xmath1 is a surface in @xmath2 that separates two media @xmath3 and @xmath4 that are homogeneous and isotropic , with refractive indices @xmath5 and @xmath6 respectively . if a ray of light having direction @xmath7 , the unit sphere in @xmath2 , and traveling through medium @xmath3 strikes @xmath1 at the point @xmath8 , then this ray is refracted in the direction @xmath9 through medium @xmath4 according to the snell law in vector form :",
    "@xmath10 where @xmath11 is the unit normal to the surface to @xmath1 at @xmath8 pointing towards medium @xmath4 ; see ( * ? ? ? * subsection 4.1 ) .",
    "it is assumed here that @xmath12 .",
    "this has several consequences :    1 .",
    "the vectors @xmath13 are all on the same plane ( called the plane of incidence ) ; 2 .",
    "the well known snell s law in scalar form holds : @xmath14 where @xmath15 is the angle between @xmath16 and @xmath11 ( the angle of incidence ) , and @xmath17 is the angle between @xmath0 and @xmath11 ( the angle of refraction ) .    equation is equivalent to @xmath18 , which means that the vector @xmath19 is parallel to the normal vector @xmath11 . if we set @xmath20 , then @xmath21 for some @xmath22 .",
    "notice that univocally determines @xmath23 . taking dot products with @xmath16 and @xmath0 in we get @xmath24 , @xmath25 , and @xmath26}$ ] .",
    "in fact , there holds @xmath27    the formulation is useful solve refraction problems for lens design , see @xcite , @xcite , @xcite , @xcite , and @xcite for a numerical implementation .",
    "let @xmath28 be the refractive indices of two homogeneous media @xmath3 and @xmath4 , respectively .",
    "suppose a surface @xmath1 separates the two media , and an incoming light ray in medium @xmath3 with wave vector @xmath29 strikes @xmath1 .",
    "assume that there is a real - valued function @xmath30 , _ the phase discontinuity _ , defined in a neighborhood of the surface @xmath1 .",
    "notice that @xmath30 must be defined in a neighborhood of @xmath1 because the gradient of @xmath30 will be considered .",
    "if @xmath11 denotes the unit normal vector to @xmath1 , then the refracted wave vector @xmath31 satisfies ( * ? ? ? * equation ( 2 ) ) : @xmath32 we give an alternate formulation and derivation of this result by using wavefronts ; our starting point is ( * ? ? ?",
    "* section 2.2 ) .",
    "for each @xmath33 , @xmath34 denotes a surface in the variables @xmath35 that separates the part of the space that is at rest from the part of the space that is disturbed by the electric and magnetic fields .",
    "this surface is called a _ wave front _ , and the light rays are the orthogonal trajectories to the wave fronts at each time @xmath33 .",
    "we assume that @xmath36 , and so we can solve @xmath37 in @xmath33 , obtaining that @xmath38 ; so letting @xmath33 run , the wave fronts are then the level sets of @xmath39 .",
    "let @xmath28 , and @xmath1 be as above .",
    "an incoming wave front @xmath40 on medium @xmath3 strikes the surface @xmath1 and it is then transmitted into a wave front @xmath41 in medium @xmath4 ( of course , there is also a wave front reflected back ) . assuming as before that @xmath42 , @xmath43 , and solving in @xmath33 , we get that the wave fronts are given by @xmath44 for @xmath43 , respectively .",
    "suppose the surface @xmath1 is parameterized by @xmath45 , @xmath46 , @xmath47 .",
    "if there were no phase discontinuity on the surface @xmath1 , then we would have @xmath48 along @xmath1 .",
    "but since there is now a phase discontinuity @xmath30 on @xmath1 , we have the following jump condition along @xmath1 : @xmath49 taking derivatives in @xmath50 and @xmath51 yields @xmath52 and @xmath53 that is , the vector @xmath54 must be normal to @xmath1 ; as such there exists a real number @xmath23 such that @xmath55 where @xmath11 is the unit normal to @xmath1 .",
    "let @xmath56 denote the light rays in medium @xmath57 having speed @xmath58 , for @xmath43 ; i.e. , the orthogonal trajectories to @xmath59 .",
    "in particular , we have that @xmath60 , and by the chain rule @xmath61 if we parameterize the rays so that @xmath62 , then we obtain @xmath63 since @xmath64 is parallel to @xmath65 .",
    "letting @xmath66 we obtain from the following formula @xmath67 taking cross products with the unit normal @xmath11 in ( [ vect2 ] ) , we obtain the equivalent formula @xmath68 recall that @xmath16 is the unit direction of the incident ray , @xmath0 is the unit direction of the refracted ray , @xmath11 is the unit outer normal at the incident point on @xmath1 and @xmath69 is calculated at the incident point .",
    "note that in the case @xmath30 is constant , we recover the classical snell s law in vector form ( [ snellwithcrossproduct])constant , then @xmath70 . taking dot product with @xmath0 yields",
    "this means that @xmath0 is on the plane through the origin having normal @xmath72 which is the plane generated by @xmath11 and @xmath16 .",
    "therefore @xmath73 are all on the same plane , i.e. , the plane of incidence . on the other hand , if @xmath30 is not necessarily constant , then from @xmath74 . again taking dot product with @xmath0 yields @xmath75 , that is , @xmath76 .",
    "that is , now the refracted vector @xmath0 lies on the plane through the origin and perpendicular to the vector @xmath77 where @xmath69 is calculated at the point on the surface @xmath1 where the ray with direction @xmath16 strikes it .",
    "this shows that in the general case the refracted vector @xmath0 is not on the plane generated by @xmath11 and @xmath16 . ] .",
    "starting from , we now calculate @xmath23 . taking dot products in and solving for @xmath78 yields @xmath79 next taking dot products in with itself , expanding , and substituting @xmath78 from the previous expression , yields that @xmath23 satisfies the quadratic equation : @xmath80 \\lambda + |n_1 x -\\nabla \\psi|^2 - n_2 ^ 2 = 0.\\ ] ] solving for @xmath23 yields    [ formulaforlambda ] = ( n_1x - ) .",
    "since @xmath23 must be a real number , the quantity under the square root must be non - negative , i.e. , @xmath81 ^ 2.\\ ] ] assuming this for now , it remains to check which sign ( @xmath82 ) to take in .",
    "dotting ( [ vect2 ] ) with @xmath11 and using yields    n_1 x - n_2 m = ( n_1x - ) + ,    so    -n_2 m = .    since @xmath83 and @xmath84",
    ", we obtain that @xmath85 ^ 2\\right ) } .\\ ] ]    we next analyze , which will yield the critical angles .",
    "equation is equivalent to @xmath86 thus , if @xmath16 is such that @xmath87 then holds . on the other hand ,",
    "if @xmath88 then holds when either @xmath89 therefore , the critical angles between @xmath16 and @xmath11 are @xmath90 with    & x = _ c = + + & + & x = _ c= - .    in two dimensions",
    "the critical angles are considered in @xcite .",
    "it is assumed there that the interface @xmath1 is the @xmath16-axis , the region @xmath91 is filled with a material with refractive index @xmath5 , and the region @xmath92 with a material with refractive index @xmath6 .",
    "also the phase discontinuity satisfies that @xmath69 is constant and is tangential to the interface , i.e. , @xmath93 with , for example , @xmath94 .",
    "therefore , the above calculations applied to this case yield @xmath95 where @xmath96 .",
    "squaring both sides we obtain    ^2 _ c=1-_c + -^2 ,    and the critical angles @xmath90 are therefore the solutions to the equation    ^2 _ c -_c + -^2=0 ,    i.e. ,    _ c= ( ) ,    which is in agreement with ( * ? ? ?",
    "* formula ( 3 ) ) .    in three dimensions",
    "the critical angles are considered in @xcite .",
    "the interface @xmath1 is the @xmath97-plane , the region @xmath98 is filled with a material with refractive index @xmath5 , and the region @xmath99 with a material with refractive index @xmath6 .",
    "also the phase discontinuity is tangential to the interface , i.e. , @xmath100 and without loss of generality we may assume @xmath101 .",
    "once again , the above calculations applied to this case yield @xmath102 proceeding as before we find    _ c= ( ) ,    recovering ( * ? ? ?",
    "* formula ( 8) ) .",
    "the reflection case is when @xmath103 , so and become @xmath104 ^ 2\\right ) } , \\ ] ] with @xmath16 the unit incident direction , @xmath0 the unit reflected vector , @xmath11 the unit normal to the interface at the striking point , and @xmath69 at the striking point . notice that the choice of the plus sign in front of the square root is because for reflection @xmath105 .",
    "let @xmath1 be a surface in three dimensional space and @xmath106 be a vector valued function defined on @xmath1 ; @xmath107 .",
    "if @xmath16 is an incident unit direction striking @xmath1 at a point @xmath8 , and @xmath0 is the unit refracted direction , then we obtain , dividing by @xmath5 in the generalized snell law , that @xmath108 where @xmath109 is the unit outer normal to @xmath1 at @xmath8 for some @xmath110 ; @xmath20 .",
    "suppose rays emanate from the origin and we are given a fixed unit vector @xmath0 .",
    "our goal is to answer the following two questions .",
    "first , given a surface @xmath1 separating media @xmath5 and @xmath6 , find a field @xmath106 defined on @xmath1 so that all rays from the origin are refracted into the direction @xmath0 .",
    "the second question is , given a field @xmath106 defined in a region of @xmath2 , find a separation surface @xmath1 between @xmath5 and @xmath6 within that region so that all rays emanating from the origin are refracted into the direction @xmath0 .",
    "we begin in this section answering the first question when @xmath1 is either a plane or a sphere , surfaces of traditional interest in optics , showing explicit phase discontinuities . for general surfaces , the first question is considered in section [ sec : m variable ] , even for the more general case of variable @xmath0 .",
    "the second question is answered in section [ subsec : given the field find the phase discontinuity ] .",
    "let @xmath1 be the plane @xmath111 in @xmath2 with @xmath94 .",
    "we want to determine a field @xmath112 defined on @xmath1 so that all rays emanating from the origin are refracted into the unit direction @xmath113 , with @xmath114 , figure [ fig : case of the plane ] .    using spherical coordinates @xmath115 , @xmath116 , @xmath1",
    "is described parametrically by @xmath117 since the normal to the plane @xmath1 is @xmath118 , then implies that @xmath119 and @xmath120 . hence @xmath121 and @xmath122 are univocally determined .",
    "also , from we get @xmath123 notice also that from , @xmath124 which in the present case yields @xmath125 this means that in each @xmath126 determines @xmath23 and vice - versa .",
    "we now write the field @xmath106 in rectangular coordinates @xmath127 . since @xmath128 , we can write @xmath129 for @xmath130 . from @xmath131 and @xmath132 , so @xmath133 .",
    "let @xmath134 .",
    "therefore , if on the plane @xmath135 we give the field @xmath136 then resulting metasurface does the desired refraction job . if we want @xmath106 to be the gradient of a function , then @xmath137 must be a gradient , which is only possible when @xmath138 a constant ; that is , @xmath139 . as a particular case",
    "when @xmath140 , @xmath141 , and @xmath142 , we obtain the equivalent ( * ? ? ?",
    "* formula ( 2 ) ) ( where a different orientation of the coordinates is used ) with @xmath143 .",
    "notice also that if we want @xmath106 in to be tangential to the plane @xmath111 , that is , @xmath144 , then @xmath145 .",
    "now , the surface @xmath1 considered is a sphere of radius @xmath146 centered at the origin , that is , @xmath147 , with @xmath148 spherical coordinates .",
    "we denote by @xmath149 ; figure [ fig : case of the sphere ] .",
    "since @xmath1 is a sphere , the normal @xmath150 and from we get @xmath151 so @xmath152 that is , @xmath153 \\left (   \\begin{matrix } v_1+\\kappa\\,m_1\\\\ v_2+\\kappa\\,m_2\\\\ v_3+\\kappa\\,m_3 \\end{matrix } \\right ) = 0.\\ ] ] notice that @xmath154=0 $ ] . set @xmath155 , so the system is equivalent to @xmath156 \\left (   \\begin{matrix } w_1\\\\ w_2\\\\ w_3 \\end{matrix } \\right ) = 0.\\ ] ] if @xmath157 , the last matrix has rank two , so the space of solutions has dimension one and the solutions are given by @xmath158 with @xmath159 arbitrary . therefore , @xmath160 with @xmath122 arbitrary .",
    "notice that if in we take cross product with @xmath16 , we get @xmath161 hence , if we want to pick @xmath106 tangential to the sphere , we obtain @xmath162 @xmath106 is a field defined on the sphere of radius @xmath146 .",
    "we shall determine a function @xmath30 defined in a neighborhood of the sphere of radius @xmath146 such that @xmath163 , and satisfying @xmath164 in fact , we have ( @xmath149 ) @xmath165 and similarly , @xmath166 integrating the derivative in @xmath167 yields @xmath168 and integrating the derivate in @xmath169 we obtain @xmath170 with @xmath171 an arbitrary constant . writing this in rectangular coordinates yields",
    "@xmath172 we now define @xmath30 on a neighborhood of @xmath173 so that holds .",
    "define @xmath174 we have @xmath175 so for @xmath176 , with @xmath177 , we obtain @xmath178 as desired .",
    "therefore the phase discontinuity @xmath30 from has gradient tangential to the sphere and can be placed on the spherical interface @xmath173 so that all rays from the origin are refracted into the fixed direction @xmath0 .",
    "suppose @xmath179 is a given @xmath180 unit field of directions , and let @xmath1 be a @xmath180 surface given parametrically by @xmath181 where @xmath148 are spherical coordinates and @xmath182 is the polar radius .",
    "we want to see when is it possible to have a phase discontinuity @xmath30 on the surface @xmath1 so that each ray from the origin with direction @xmath148 is refracted into the direction @xmath183 . from @xmath184 so @xmath185 taking cross product with @xmath11 yields @xmath186 if @xmath106 is tangential to @xmath1 , then @xmath187 and so @xmath188 that is , @xmath189 if @xmath190 , then @xmath191 since @xmath192 and @xmath193 , @xmath194 and similarly @xmath195 let us now consider the first order system in @xmath196 @xmath197 where @xmath198 .",
    "if the given set of directions @xmath183 and the surface @xmath1 satisfy @xmath199 then by ( * ? ? ?",
    "* chapter 6 , pp .",
    "117 - 118)(see also below ) there exists @xmath196 solving . by integration",
    "we then obtain that the phase discontinuity @xmath30 satisfies along @xmath1 that @xmath200 to find the gradient of @xmath30 we need to have @xmath30 defined in a neighborhood of the surface @xmath201 such that holds and that its gradient satisfies on @xmath201 @xmath202 notice that this implies @xmath203 . to construct the function @xmath30 in a neighborhood of the surface @xmath1",
    "( we will construct it in a neighborhood of each point in @xmath1 ) , given parametrically by @xmath201 , we use the notion of envelope from classical differential geometry ; see for example ( * ? ? ?",
    "* chapter 5 , section 4 ) or ( * ? ? ?",
    "* chapter 3 ) .",
    "we will actually construct a surface that is developable , in particular , it has gauss curvature zero .",
    "for a recent reference on developable surfaces , its applications and design see @xcite .",
    "since the required @xmath30 must satisfy , consider the surface @xmath204 given parametrically by @xmath205 in four dimensions . at each point @xmath206 , consider the 4-dimensional vector @xmath207 where @xmath149 and @xmath11 is the unit normal to the surface @xmath1 at @xmath201 .",
    "next consider the plane @xmath208 passing through the point @xmath206 and with normal @xmath209 , that is , in coordinates @xmath210 , @xmath208 has equation @xmath211    therefore we have a family of planes @xmath208 depending on the parameters @xmath212 , and we will let @xmath213 be by definition the envelope to this family of planes . of course ,",
    "we need to know under what conditions on @xmath201 and @xmath183 this envelope @xmath30 exists . it will be defined by solving the system of equations @xmath214",
    "\\dfrac{\\partial f}{\\partial u}(x_1,x_2,x_3,x_4,u , v)&=0\\\\[2ex ] \\dfrac{\\partial f}{\\partial v}(x_1,x_2,x_3,x_4,u , v)&=0 .",
    "\\end{cases}\\end{aligned}\\ ] ] in fact , let us fix values @xmath215 , and let @xmath216 be the corresponding value on the surface @xmath204 ; and consider the map @xmath217 the function @xmath218 has continuous partial derivatives in a neighborhood of the point @xmath219 , and @xmath220 by the implicit function theorem , if the jacobian determinant @xmath221 \\dfrac{\\partial^2 f}{\\partial x_4\\partial u } & \\dfrac{\\partial^2 f}{\\partial u\\partial u } & \\dfrac{\\partial^2 f } { \\partial v\\partial u}\\\\[2ex ] \\dfrac{\\partial^2 f}{\\partial x_4\\partial v } & \\dfrac{\\partial^2 f}{\\partial u\\partial v } & \\dfrac{\\partial^2 f } { \\partial v\\partial v } \\end{matrix } \\right)\\right|_{\\left(p_1,p_2,p_3,p_4,u_0,v_0 \\right)}\\neq 0,\\ ] ] then there are unique differentiable functions @xmath222 in the variables @xmath127 defined in a neighborhood @xmath223 of @xmath224 such that @xmath225 , @xmath226 and @xmath227 with @xmath228 for all @xmath229 .",
    "therefore , if we let @xmath230 for @xmath229 , then @xmath30 is the function we need , i.e. , @xmath30 is by construction defined in a neighborhood of the point @xmath231 and satisfies and .",
    "we now analyze under what conditions on the surface @xmath1 and @xmath0 , holds .",
    "notice first that since @xmath232 , the matrix inside the determinant in equals @xmath233 0 & \\dfrac{\\partial^2 f}{\\partial u\\partial u } & \\dfrac{\\partial^2 f } { \\partial v\\partial u}\\\\[2ex ] 0 & \\dfrac{\\partial^2 f}{\\partial u\\partial v } & \\dfrac{\\partial^2 f } { \\partial v\\partial v } \\end{matrix } \\right),\\ ] ] and therefore means @xmath234",
    "\\dfrac{\\partial^2 f}{\\partial u\\partial v } & \\dfrac{\\partial^2 f } { \\partial v\\partial v } \\end{matrix } \\right)\\neq 0.\\ ] ] let us find what this means in terms of the initial surface @xmath1 and the field @xmath0 . to simplify the notation",
    "let @xmath235 , so we can write as @xmath236 by calculation @xmath237 we first show that @xmath238 indeed , we have    @xmath239 so @xmath240 hence @xmath241 since @xmath242 and @xmath243 . the same calculation with @xmath244 instead of @xmath245 yields the second identity in .",
    "next , differentiating with respect to @xmath167 and @xmath169 yields @xmath246 since @xmath247 . hence letting @xmath248 in yields @xmath249",
    "now let us calculate these dot products .",
    "first set @xmath250 and write @xmath251_u\\,\\nu-\\left[(x-\\kappa\\,m)\\cdot \\nu\\right]\\,\\nu_u,0 \\right\\}\\\\ & = \\left(\\rho_u\\,x+\\rho\\,x_u \\right ) \\cdot \\left(x_u-\\kappa\\,m_u - b_u\\,\\nu - b\\,\\nu_u \\right)\\\\ & = \\left(\\rho_u\\,x+\\rho\\,x_u \\right ) \\cdot x_u - \\kappa\\,\\left(\\rho_u\\,x+\\rho\\,x_u \\right ) \\cdot m_u - b_u\\,\\left(\\rho_u\\,x+\\rho\\,x_u \\right ) \\cdot \\nu - b\\,\\left(\\rho_u\\,x+\\rho\\,x_u \\right ) \\cdot \\nu_u\\\\ & = \\left(\\sin^2v\\right)\\,\\rho - \\kappa\\,\\left(\\rho_u\\,x+\\rho\\,x_u \\right ) \\cdot",
    "m_u- b\\,\\left(\\rho_u\\,x+\\rho\\,x_u \\right ) \\cdot \\nu_u=\\left(\\sin^2v\\right)\\,\\rho - \\kappa\\,r_u\\cdot m_u- b\\,r_u \\cdot \\nu_u,\\end{aligned}\\ ] ] since @xmath252 , and @xmath242 .",
    "also @xmath253 and @xmath254 , so we obtain similarly @xmath255 next , differentiating @xmath256 yields @xmath257 therefore @xmath258 and so @xmath259,\\end{aligned}\\ ] ] with @xmath260 . notice that the first and third matrices in the last determinant are respectively the first fundamental form of the 2-sphere , and the second fundamental form of the surface @xmath1 . _",
    "therefore , we have proved the following : if a variable field @xmath0 and a surface @xmath1 satisfy the compatibility condition , and the determinant is not zero at a point @xmath261 , then there is a neighborhood @xmath223 of the point @xmath262 and a phase discontinuity function @xmath30 defined in @xmath223 for the surface @xmath1 , with gradient @xmath69 tangential to @xmath1 , so that it yields the desired refraction job , i.e. , each ray emanating in the direction @xmath148 , for @xmath263 in a neighborhood of @xmath261 , is refracted by the metasurface @xmath264 into the direction @xmath183 . _",
    "[ rmk : case when m is constant]if @xmath265 is constant , then is clearly satisfied by any @xmath1 and in condition the second matrix on the right hand side is zero .    to illustrate the determinant condition ,",
    "let us consider the special case when @xmath1 is a sphere centered at the origin , and @xmath0 is a constant vector .",
    "we have @xmath147 , and @xmath266 .",
    "so @xmath267 and similarly for @xmath268 and @xmath269 . also @xmath270 , @xmath271 , and @xmath272 hence @xmath273 , @xmath274 , and @xmath275",
    "therefore the determinant in equals @xmath276 for example , if @xmath277 , i.e. , all rays are refracted vertically , then the determinant equals @xmath278 which is not zero as long as @xmath279 or zero .",
    "this shows also that for the sphere the phase discontinuity @xmath30 exists and can be obtained by solving the system of equations .",
    "notice that in this case a phase discontinuity @xmath30 was calculated explicitly in section [ subsec : caseofthespherecenteredatzero ] and given by .",
    "[ rmk : aieta case is incorrect]a case considered in ( * ? ? ?",
    "* section 3 ) is when a sphere of radius @xmath146 is centered at a point @xmath280 with @xmath281 , and the authors claim there that it is not possible to find a phase discontinuity on such a sphere so that all rays from the origin are refracted into the vertical direction .",
    "we believe this claim is in error and in fact , with the method above will show that for each unit @xmath113 with @xmath282 , there is a phase discontinuity @xmath30 defined in a neighborhood of such a sphere so that its gradient is tangential to the sphere and so that radiation from the origin is refracted into a fixed direction @xmath0 , see figure [ fig : off centered sphere ] .        in particular , when @xmath0 is vertical a phase discontinuity exists .",
    "by reversibility of optical paths , this shows that the conclusion in ( * ? ? ?",
    "* section 3 ) is incorrect .",
    "first , the lower part of the sphere with center at @xmath280 and radius @xmath146 is parametrized by the vector @xmath181 with @xmath283 where @xmath284 ; and the unit normal to the sphere pointing upwards is @xmath285 to show our claim , we need to verify that the determinant in is not zero . from we",
    "obtain by simple calculations that @xmath286 therefore the determinant in equals @xmath287 with @xmath288 the last determinant is not zero for @xmath212 such that @xmath289 let us take for example @xmath277 , i.e. , rays are refracted vertically , then we get @xmath290 so @xmath291 is independent of @xmath167 . if @xmath292 , then @xmath293 , @xmath294 and @xmath295 , so @xmath296 recall that @xmath20 .",
    "if @xmath297 , since @xmath298 , we obtain that @xmath299 .",
    "if @xmath300 , then @xmath299 if and only if @xmath301 . this shows that in these cases the determinant in is not zero for @xmath302 with @xmath169 close to zero . therefore there exists a phase discontinuity @xmath30 , on the sphere centered at @xmath280 with radius @xmath146 , defined in a neighborhood of each point of the form @xmath303 with @xmath169 close to zero .",
    "we now turn to the second question proposed at the beginning of section [ sec : far field uniformly refracting surfaces ] , that is , of finding the surface @xmath1 when the field @xmath112 is given .",
    "the unknown surface is given parametrically by @xmath304 where @xmath148 are spherical coordinates as before , and we seek the polar radius @xmath305 ; the value of @xmath106 along the surface is @xmath306 . from , @xmath307 is a multiple of the normal @xmath11 at @xmath201 , so @xmath308 we have @xmath309_u\\,x(u , v)+\\rho(u , v)\\,x_u(u , v),\\\\ r_v(u , v)&=\\left[\\rho(u , v)\\right]_v\\,x(u , v)+\\rho(u , v)\\,x_v(u , v),\\end{aligned}\\ ] ] so @xmath310_u\\,x(u , v)+\\rho(u , v)\\,x_u(u , v)\\right)\\cdot \\left(x(u , v)-\\kappa\\,m- v(r(u , v ) ) \\right)\\\\ & = \\left[\\rho(u , v)\\right]_u\\left(1-x(u , v)\\cdot\\left[\\kappa\\ , m+v(r(u , v))\\right]\\right ) -\\rho(u , v)\\,x_u(u , v)\\cdot \\left[\\kappa\\ , m+v(r(u , v))\\right ] ,   \\end{aligned}\\ ] ] and a similar equation for @xmath311 .",
    "that is , @xmath312 satisfies the first order nonlinear system of pdes ( depending on @xmath106)\\neq 0 $ ] . ] : @xmath313}{1-x(u , v)\\cdot\\left[\\kappa\\ , m+v\\left(\\rho(u , v)\\,x(u , v)\\right)\\right]}\\,\\rho(u , v)=0\\\\[2ex ] \\rho_v(u , v ) -\\dfrac{x_v\\cdot \\left[\\kappa\\ , m+v\\left(\\rho(u , v)\\,x(u , v)\\right)\\right]}{1-x(u , v)\\cdot\\left[\\kappa\\ , m+v\\left(\\rho(u , v)\\,x(u , v)\\right)\\right]}\\,\\rho(u , v)=0 . \\end{cases}\\ ] ] if @xmath314 with @xmath315}{1-x(u , v)\\cdot\\left[\\kappa\\ , m+v\\left(\\rho\\,x(u , v)\\right)\\right]}\\,\\rho\\\\ f_2(u , v,\\rho)&=\\dfrac{x_v\\cdot \\left[\\kappa\\ , m+v\\left(\\rho\\,x(u , v)\\right)\\right]}{1-x(u , v)\\cdot\\left[\\kappa\\ , m+v\\left(\\rho\\,x(u , v)\\right)\\right]}\\,\\rho,\\end{aligned}\\ ] ] then can be written as @xmath316 to solve the system we need an initial condition , say @xmath317 , and use a result from ( * ? ? ?",
    "* chapter 6 , pp .",
    "117 - 118 ) , that is , if @xmath318 holds for all @xmath319 in an open set @xmath320 , then for each @xmath321 there is neighborhood @xmath223 of @xmath261 and a unique solution @xmath312 defined for @xmath322 solving the system and satisfying @xmath317 .",
    "we will see under what circumstances on the field @xmath106 condition is satisfied , and therefore the existence of the desired surface @xmath201 will be guaranteed .",
    "set @xmath323 then @xmath324}\\,\\rho , \\qquad f_2(u , v,\\rho)=\\dfrac{x_v\\cdot w(u , v,\\rho)}{1-x(u , v)\\cdot \\left[w(u , v,\\rho)\\right]}\\,\\rho.\\ ] ] we have @xmath325 hence    - = \\{(x_uw_v -x_vw_u)(1-xw)^-1 + ( ( xw_v)(x_uw)-(xw_u)(x_vw ) ) ( 1-xw)^-2 }    and    f_2- f_1 + = ( x_vw)(1-xw)^-1 + - ( x_uw)(1-xw)^-1 + = ( ( x_uw_)(x_vw)- ( x_vw_)(x_uw))(1-xw)^-2",
    ".    therefore holds if @xmath326 since we assume @xmath327 and @xmath328 , this is equivalent to @xmath329 that is ,    [ eq : conditionequivalenttohartman ] ( x_uw_v -x_vw_u)(1-xw ) + ( ( ( xw_v)-(x_vw_))(x_uw)- ( ( xw_u)-(x_uw_))(x_vw ) ) = 0 .",
    "we have @xmath330 now @xmath331 if we let @xmath332 \\dfrac{\\partial v_2}{\\partial y_1 } & \\dfrac{\\partial v_2}{\\partial y_2 } & \\dfrac{\\partial v_2}{\\partial y_3 } \\\\[2ex ] \\dfrac{\\partial v_3}{\\partial y_1 } & \\dfrac{\\partial v_3}{\\partial y_2 } & \\dfrac{\\partial v_3}{\\partial y_3 } \\\\",
    "\\end{matrix } \\right),\\ ] ] then @xmath333 where @xmath334 are row vectors and @xmath33 denotes the transpose .",
    "similarly @xmath335 suppose @xmath336 , then @xmath337 is a symmetric matrix , so @xmath338 @xmath339 @xmath340 and reads @xmath341 which can be written as @xmath342 from the cauchy - binet formula for cross products . ]",
    ", this means that @xmath343 and since @xmath344 , is equivalent to the following geometric condition : @xmath345    _ therefore ,",
    "if the field @xmath336 , @xmath346 is given in , and ( or equivalently ) holds in an open set @xmath320 in the variables @xmath347 , then for each @xmath348 the system has a unique solution @xmath312 defined in a neighborhood of @xmath261 and satisfying the initial condition @xmath317 .",
    "_ notice that if @xmath349 is a constant field , then @xmath350 and so obviously holds . in this case , can be easily integrated and the solution is @xmath351 with @xmath352 constants .    notice also that with the choice @xmath106 as in , with @xmath353 so @xmath327 , the system of equations becomes @xmath354 whose solution is @xmath355 , where the constant @xmath356 is determined by the point where the solution passes through .",
    "this is in agreement with .",
    "the near field case can be regarded as a special case from section [ sec : m variable ] when the vector field @xmath183 points towards a fixed point @xmath357 , and therefore the method from that section can be used to derive conditions for the existence of the desired metasurface .",
    "in fact , if the surface @xmath1 is parametrized by @xmath201 and @xmath358 , then it is easy to see that the compatibility condition holds .",
    "the existence of the phase discontinuity then follows when the determinant in is not zero .",
    "however , the phase discontinuities in the planar and spherical cases can be obtained explicitly as follows ; see figure [ fig : cases of plane and sphere near field ] .",
    "let @xmath320 be the origin in medium @xmath3 with index @xmath5 and let @xmath359 be a point in medium @xmath4 with index @xmath6",
    ". denote by @xmath1 the plane with equation @xmath111 so that it separates the points @xmath320 and @xmath357 .",
    "we find the field @xmath106 so that rays from @xmath320 are refracted into @xmath357 .",
    "we know from section [ subsec : case of the plane ] that @xmath1 is given parametrically by ; the normal @xmath118 .",
    "so we seek @xmath106 such that holds .",
    "since the refracted vector from each point @xmath201 on the plane interface to the point @xmath357 has unit direction @xmath360 , @xmath106 must satisfy @xmath361 re writing these equations in rectangular coordinates yields @xmath362 therefore , @xmath363 , @xmath364 , are determined : @xmath365 where @xmath23 is chosen arbitrarily .",
    "notice that if we let @xmath366 and choose @xmath367 , then @xmath336 , and so the plane with the phase discontinuity function @xmath30 does the desired refraction job .      if @xmath1 is the sphere of radius @xmath146 centered at the origin , that is , @xmath147 , then the normal @xmath150 , and from we get @xmath368 as before taking cross product with @xmath16 yields @xmath369 assuming @xmath106 is tangential to the sphere , @xmath370 if @xmath371 , then @xmath372 hence @xmath373 and similarly @xmath374 since @xmath193 .",
    "since @xmath30 is assumed @xmath180 , we get @xmath375 integrating in @xmath167 yields @xmath376 for some function @xmath377 . to calculate @xmath377 ,",
    "we differentiate the integral with respect to @xmath169 and use : @xmath378 which implies @xmath379 from .",
    "therefore , the phase discontinuity @xmath30 on the sphere satisfies @xmath380 with @xmath356 a constant . writing this in rectangular coordinates yields @xmath381 we now define @xmath30 on a neighborhood of @xmath173 so that holds .",
    "let @xmath382 we have @xmath383 so for @xmath176 , with @xmath177 , we obtain @xmath384 as desired .",
    "therefore the phase discontinuity @xmath30 in has gradient tangential to the sphere and can be placed on the spherical interface @xmath173 so that all rays from the origin are refracted into the point @xmath357 .",
    "a rigorous mathematical foundation of general metasurfaces is provided .",
    "the starting point is the derivation of a generalized snell s law in the presence of a phase discontinuity using wavefronts .",
    "this is used also to derive all possible critical angles .",
    "we solve , under appropriate curvature type conditions on the surface @xmath1 , the problem of finding a phase discontinuity , so that the pair ( surface and phase discontinuity ) refracts light in a desired manner .",
    "when a phase discontinuity is given , we derive conditions so that a surface is admissible for that phase discontinuity in the far field setting .",
    "extensions to the case when the far field is a set of variable directions are given , and examples and explicit calculations of phase discontinuities are also provided .",
    "the near field case is also studied .",
    "francesco aieta , patrice genevet , nanfang yu , mikhail  a. kats , zeno gaburro , and federico capasso .",
    "out - of - plane reflection and refraction of light by anisotropic optical antenna metasurfaces with phase discontinuities .",
    ", 12(3):17021706 , 2012 .",
    "francesco aieta , ali kabiri , patrice genevet , nanfang yu , mikhail  a kats , zeno gaburro , and federico capasso .",
    "reflection and refraction of light from metasurfaces with phase discontinuities .",
    ", 6(1):063532063532 , 2012 .",
    "habib ammari , matias ruiz , wei wu , sanghyeon yu , and hai zhang .",
    "mathematical and numerical framework for metasurfaces using thin layers of periodically distributed plasmonic nanoparticles . in _ proc .",
    "a _ , volume 472 .",
    "the royal society , 2016 .",
    "patrice genevet , federico capasso , francesco aieta , mohammad rezakhorasaninejad , and robert devlin .",
    "recent advances in planar optics : from plasmonic to dielectric metasurfaces . , 4(1):23342536 , january 2017 .",
    "mohammadreza khorasaninejad , wei  ting chen , robert  c. devlin , jaewon oh , alexander  y. zhu , and federico capasso .",
    "metalenses at visible wavelengths : diffraction - limited focusing and subwavelength resolution imaging . , 352(6290):11901194 , june 2016 .",
    "nanfang yu , patrice genevet , mikhail  a. kats , francesco aieta , jean - philippe tetienne , federico capasso , and zeno gaburro .",
    "light propagation with phase discontinuities : generalized laws of reflection and refraction .",
    ", 334(6054):333337 , 2011 ."
  ],
  "abstract_text": [
    "<S> this paper provides a mathematical approach to study metasurfaces in non flat geometries . </S>",
    "<S> analytical conditions between the curvature of the surface and the set of refracted directions are introduced to guarantee the existence of phase discontinuities . </S>",
    "<S> the approach contains both the near and far field cases . </S>",
    "<S> a starting point is the formulation of a vector snell law in presence of abrupt discontinuities on the interfaces . </S>"
  ]
}