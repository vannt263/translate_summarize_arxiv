{
  "article_text": [
    "the general problem of finding suitable approximations of homeomorphisms @xmath7 with piecewise affine homeomorphisms has a long history . as far as we know , in the simplest non - trivial setting ( i.e. @xmath8 , approximations in the @xmath9-norm )",
    "the problem was solved by rad  @xcite . due to its fundamental importance in geometric topology , the problem of finding piecewise affine homeomorphic approximations in the @xmath9-norm and dimensions @xmath10 was deeply investigated in the 50s and 60s . in particular ,",
    "it was solved by moise  @xcite and bing  @xcite in the case @xmath11 ( see also the survey book  @xcite ) , while for contractible spaces of dimension @xmath12 the result follows from theorems of connell  @xcite , bing  @xcite , kirby  @xcite and kirby , siebenmann and wall  @xcite ( for a proof see , e.g. , rushing  @xcite or luukkainen  @xcite ) . finally , twenty years later , while studying the class of quasi - conformal varietes , donaldson and sullivan  @xcite proved that the result is false in dimension 4 in the context of manifolds .",
    "once completely solved in the uniform sense , the approximation problem suddenly became of interest again in a completely different context , namely , for variational models in nonlinear elasticity .",
    "let us briefly explain why . in the setting of nonlinear elasticity ( see for instance the pioneering work by ball  @xcite ) , one is led to study existence and regularity properties of minimizers of energy functionals of the form @xmath13 where @xmath14 ( @xmath15 ) models the deformation of a homogeneous elastic material with respect to a reference configuration @xmath2 and prescribed boundary values , while @xmath16 is the stored - energy functional . in order for the model to be physically relevant , as pointed out by ball in  @xcite",
    ", one has to require that @xmath17 is a homeomorphism this corresponds to the non - impenetrability of the material and that @xmath18 the first condition in   prevents from too high compressions of the elastic body , while the latter guarantees that the orientation is preserved .",
    "another property of @xmath19 that appears naturally in many problems of nonlinear elasticity is the _ quasiconvexity _ ( see for instance  @xcite ) .",
    "unfortunately , no general existence result is known under condition  ( [ e_wa ] ) , not even if the quasiconvexity assumption is added : one has either to drop condition   and impose @xmath20-growth conditions on @xmath19 ( see  @xcite ) , or to require that @xmath19 is _ polyconvex _ and that some coercivity conditions are satisfied ( see  @xcite ) .",
    "moreover , also in the cases in which the existence of @xmath21 minimizers is known , very little is known about their regularity .    as pointed out by ball in  @xcite ( who ascribes the question to evans  @xcite ) , an important issue toward the understanding of the regularity of the minimizers in this setting ( i.e. , @xmath19 quasiconvex and satisfying  ) would be to show the existence of minimizing sequences given by piecewise affine homeomorphisms or by diffemorphisms . in particular , a first step would be to prove that any homeomorphism @xmath22 , @xmath23 , can be approximated in @xmath21 by piecewise affine ones or smooth ones .",
    "one of the main reasons why one should want to do that , is that the usual approach for proving regularity is to test the weak equation or the variation formulation by the solution itself ; but unfortunately , in general this makes no sense unless some apriori regularity of the solution is known .",
    "therefore , it would be convenient to test the equation with a smooth test mapping in the given class which is close to the given homeomorphism .",
    "more in general , a result saying that one can approximate a given homeomorphism with a sequence of smooth ( or piecewise affine ) homeomorphisms would be extremely useful , because it would significantly simplify many other known proofs , and it would easily lead to stronger new results .",
    "it is important to mention here that the choice of dimension @xmath24 is not only motivated by the physical model , but also by the fact that the approximation is false in dimension @xmath25 , as shown in the very recent paper  @xcite .",
    "however , the finding of diffeomorphisms near a given homeomorphism is not an easy task , as the usual approximation techniques like mollification or lipschitz extension using maximal operator destroy , in general , the injectivity . and",
    "on the other hand , we need of course to approximate our homeomorphism not just with smooth maps , but with smooth homeomorphisms ( otherwise the approximating sequence would be not even admissible for the original problem ) .",
    "few words have to be said about the choice of the required property for the approximating sequence , namely , either smooth or piecewise affine .",
    "actually , both results would be interesting in different contexts .",
    "luckily , the two things are equivalent : more precisely , it is clear that an approximation with diffeomorphisms easily generates another approximation with piecewise affine homeomorphisms ; the converse is not immediate but , at least in the plane , it is anyway known ( see  @xcite ) .",
    "therefore , one can approximate in either of the two ways , and the other one automatically follows ( for instance , in this paper we will look only for piecewise affine approximations ) .",
    "it is important to clarify a point : whenever we say that a map is piecewise affine , we mean that there is a _ locally finite _ triangulation of @xmath2 such that the map is affine on every triangle .",
    "it is actually possible to find _ finite _ triangulations whenever this makes sense ; but for instance , if @xmath2 is not a polygon , then the triangles must obviously become smaller and smaller near the boundary , so a finite triangulation does clearly not exist .",
    "let us now describe the results which are known in the literature in this direction .",
    "the first ones were obtained in 2009 by mora - corral  @xcite ( for planar bi - lipschitz mappings that are smooth outside a finite set ) and by bellido and mora - corral  @xcite , in which they prove that if @xmath26 for some @xmath27 $ ] , then one can find piecewise affine approximations @xmath28 of @xmath17 in @xmath29 , where @xmath30 depends only on @xmath31 .",
    "more recently , iwaniec , kovalev and onninen  @xcite almost completely solved the approximation problem of planar sobolev homeomorphisms , proving that any homeomorphism @xmath32 , for any @xmath33 , can be approximated by diffeomorphisms @xmath34 in the @xmath21 norm ( improving the previous result , of the same authors , for the case @xmath35 , see  @xcite ) .",
    "later on , it was shown by daneri and pratelli in  @xcite and  @xcite that any planar bi - lipschitz mapping @xmath5 can be approximated by diffeomorphisms @xmath4 such that @xmath4 converge to @xmath5 in @xmath21 norm and simultaneously @xmath36 converge to @xmath37 in @xmath21 , giving the first result in which also the distance of the inverse mappings is approximated .",
    "the goal of the present paper is to prove the approximation of planar @xmath38 homeomorphism in the @xmath38 sense , so basically dealing with the important case @xmath39 which was left out in  @xcite . in particular , our main result is the following .",
    "[ main ] let @xmath0 be an open set and @xmath1 be a homeomorphism .",
    "for every @xmath40 there is a smooth diffeomorphism ( as well as a countably but locally finitely piecewise affine homeomorphism ) @xmath41 such that @xmath42 . if in addition @xmath5 is continuous up to the boundary of @xmath2 , then the same holds for @xmath34 , and @xmath43 on @xmath44 .    actually , our piecewise affine functions @xmath34 will be globally _ finitely _ piecewise affine , thus also bi - lipschitz , as soon as @xmath2 is a polygon and @xmath5 is piecewise affine on @xmath44 , see theorem  [ main2 ] .",
    "if even just one of these two conditions does not hold , then this is clearly impossible ( see remark  [ remmain2 ] ) .",
    "we conclude the introduction with a short comparison between the techniques of this paper and those of the other papers discussed above .",
    "the proofs in  @xcite are based on a clever refinement of the supremum norm approximation of moise  @xcite , while the approach of  @xcite and of the other contributions of the same authors makes use of the identification @xmath45 and involves coordinate - wise @xmath20-harmonic functions .",
    "the techniques of the present paper are completely different with respect to them ; basically , our proof is constructive , and it is based on an explicit subdivision of the domain @xmath5 which depends on the lebesgue points of @xmath46 .",
    "our techniques resembles the basic ideas of  @xcite and  @xcite , and we will also use some of the tools introduced there , but there are some extremely important differences . more precisely , on one hand in  @xcite and  @xcite one had to approximate at the same time @xmath46 and @xmath47 while here we need only to approximate @xmath46 , and this is a deep simplification .",
    "but on the other hand , in this paper we look for a sharp estimate , that is , @xmath5 is only in @xmath38 and we want an approximation exactly in @xmath38 , thus we have not so regular maps and we can not lose sharpness of the power anywhere , while in  @xcite and  @xcite the maps were much better , namely bi - lipschitz , and in several steps the sharpness of the power was lost .",
    "roughly speaking , we can say that the most difficult steps of  @xcite and  @xcite correspond to much simpler steps here , and vice versa .",
    "in this section we outline the basic plan of our proof , to underline the main steps and help the reading of the construction .",
    "we remind the reader that our aim is to find an approximation done with piecewise affine homeomorphisms , and then the existence of an approximation with smooth diffeomorphisms will eventually immediately follow applying the result of  @xcite .",
    "first of all , we will divide our domain into some locally finite grid of small squares , these squares becoming maybe smaller and smaller close to @xmath48 .",
    "we will then consider separately the `` good '' squares , and the `` bad '' ones .",
    "more precisely , a square @xmath49 in the grid will be called good if @xmath5 can be well approximated by a linear mapping @xmath50 there , where @xmath51 coincides with @xmath46 in some lebesgue point close to @xmath52 : in particular , we will need that @xmath53 is small enough . since almost every point of @xmath2",
    "is a lebesgue point for @xmath46 , we will be able to deduce that , up to consider a sufficiently fine grid , the area covered by the good squares is as close as we wish to the total area of @xmath2 .",
    "moreover , up to a slight modification of the value of @xmath5 on the boundary of the squares , we will reduce ourselves to the case that @xmath54 where @xmath55 is a big , but fixed , constant .",
    "we will then define an approximation of @xmath5 ( which will eventually become @xmath34 ) on the grid : on the boundary of each square , we will find a piecewise linear approximation of @xmath5 , very close to @xmath5 , in such a way that these approximations on the whole grid remain one - to - one ( we do not have just to take care of the approximation on a single square , but also check that the different approximations coincide on the common sides , and that they do not overlap with each other ) .",
    "of course this will be much easier for the good squares , since on a whole good square @xmath5 is already almost affine , and more complicated for the bad squares .",
    "we will do our approximation @xmath56 in such a way that , for any bad square @xmath57 , @xmath58 the next step is then to extend the piecewise linear maps to the interior of each square ; a good thing is that , being @xmath56 already defined on the grid in a one - to - one way , the extension inside each square is completely independent with what happens on the other squares .",
    "the rough idea to do so is that on good squares we can obtain very good estimates , while in bad squares we can get only bad estimates ; but since the total area of the bad squares is arbitrarily small , in the end everything will work .",
    "the first tool which we will need , presented in section  [ sect3 ] , says that any piecewise linear map @xmath56 defined on the boundary of a square @xmath57 can be extended to a piecewise affine homeomorphism @xmath59 in the interior of @xmath57 in such a way that @xmath60 this construction is done first by choosing many points on the boundary of the square ; then , for any two of these points , say @xmath61 and @xmath62 , we will select the shortest path joining @xmath63 with @xmath64 remaining inside the portion of @xmath65 having @xmath66 as boundary . using in a careful way these shortest paths , we will then eventually obtain the definition of @xmath59 such that  ( [ uuu ] ) holds true .",
    "this estimate , together with  ( [ aha ] ) and  ( [ jyv ] ) , readily implies that for every bad square @xmath57 one has @xmath67 we have then just to take a very fine grid , so that a very small portion @xmath68 of @xmath2 is covered with bad squares , and hence we will have @xmath69 it remains then to consider the good squares , and here we will have to be extremely precise .",
    "as already said , around every good square @xmath57 the map @xmath5 is very close to being affine , hence the image of @xmath57 is very close to a parallelogram ; therefore , there is no problem unless this parallelogram degenerates .",
    "let us be more precise : for all the squares corresponding to a matrix @xmath51 with strictly positive determinant ( hence , the parallelogram does not degenerate ) , the extension inside @xmath57 is trivial ; it is enough to divide the square in two triangles and consider on each triangle the affine map which equals @xmath5 on the three vertices . by construction , we will easily see that this works perfectly .",
    "the good squares corresponding to @xmath70 are a problem only in principle : indeed , we can treat them as bad squares .",
    "the estimate  ( [ estibad ] ) says that this gives a cost of a big constant @xmath55 times the total integral of @xmath46 on those squares ; however , since they are good squares and the corresponding matrix is @xmath70 , by definition the integral of @xmath46 will be extremely small , and everything will work .",
    "the hard problem , instead , is for good squares for which @xmath71 but @xmath72 : these correspond to degenerate parallelograms , and we have to treat them carefully because these squares can cover a large portion of @xmath2 : in fact , recall that the set @xmath73 can have positive or even full measure for a sobolev homeomorphism ( see  @xcite ) .",
    "section  [ sect4 ] is devoted to build the extension for this specific case , which is somehow similar to the one with the shortest paths described above .",
    "the big difference with that case is , on one hand , that this time we are in a good square , hence very close to a lebesgue point for @xmath46 , and this helps even for the degenerate case .",
    "but on the other hand , this time we are not satisfied with an estimate like  ( [ uuu ] ) , where a big constant @xmath55 appears , and we need instead an approximation @xmath59 which is very close to the original @xmath5 . this extension procedure will be the most delicate step of the construction .",
    "the construction of the proof , divided in its several steps , is done in the last section  [ sect5 ] .",
    "basically , putting together all the ingredients described above , the proof will then be concluded for what concerns the existence of the piecewise affine approximation ; the existence of the smooth approximation will then follow thanks to the result of  @xcite , while the claim about the boundary values will be easily deduced by the whole construction .",
    "in this section we shortly list the basic notation that will be used throughout the paper . by @xmath49",
    "we denote the square centered at @xmath52 , side length @xmath74 and sides parallel to the coordinate axis , while @xmath75 is the `` rotated square '' , that we use only in section  [ sect3 ] .",
    "similarly , @xmath76 is the ball centered at @xmath52 with radius @xmath77 .",
    "the points in the domain @xmath2 will be usually denoted by capital letters , such as @xmath78 , @xmath79 and so on , while points in the image @xmath3 will be always denoted by bold capital letters , such as @xmath80 , @xmath81 and similar . to shorten the notation and",
    "help the reader , whenever we use the same letter @xmath78 for a point in the domain and @xmath80 ( in bold ) for a point in the target , this always means that @xmath80 is the image of @xmath78 under the mapping that we are considering in that moment . by @xmath82 ( resp . , @xmath83 ) we denote the segment between the points @xmath78 and @xmath79 ( resp . @xmath80 and @xmath81 ) .",
    "the length of this segment is denoted as @xmath84 , or as @xmath85 , while @xmath86 is the length of a curve @xmath87 . with the notation @xmath88 ( or @xmath89 ) we will denote a particular path between @xmath78 and @xmath79 ( or @xmath90 and @xmath91 )",
    ", whose length will be then @xmath92 , or @xmath93 ) ; we will use this notation only when it is clear what is the path we are referring to ( often this will be a shortest path between the points ) . given three",
    "non - aligned points @xmath94 ( or @xmath95 ) , we will denote by @xmath96 ( or @xmath97 ) the angle in @xmath98 between them , and by @xmath99 ( or @xmath100 ) the triangle having them as vertices .",
    "we will denote the ( modulus of the ) horizontal and vertical derivatives of any mapping @xmath101 as @xmath102 and @xmath103 are written as @xmath104 whenever a continuous function @xmath56 is defined on some curve @xmath87 ( usually , @xmath87 will simply be the boundary of a square ) we will denote by @xmath105 the tangent vector to @xmath87 at @xmath106 , and by @xmath107 the derivative of @xmath56 at @xmath108 in the direction of @xmath105 . with a small abuse of notation , even if the derivative is not necessarily defined , we will write @xmath109 to denote the length of the curve @xmath110 : notice that the latter length is always well - defined , possibly @xmath111 , and it actually coincides with @xmath112 as soon as this is defined .",
    "finally , notice that , if a function @xmath5 is affine on a square @xmath57 , being @xmath113 for some matrix @xmath51 , and we call @xmath56 the restriction of @xmath5 to @xmath114 , then @xmath115 for any @xmath116",
    ".    the letter @xmath55 will always be used to denote a large purely geometrical constant , not depending on anything ; we will not modify the letter , even if the constant may always increase from line to line . for the sake of simplicity ( and since the precise value of @xmath55 does not play any role ) we do not explicitely calculate the value of this constant .",
    "this section is entirely devoted to show the result below about the extension of a map from the boundary of the square to the whole interior .",
    "[ extension ] let @xmath117 be a piecewise linear and one - to - one function .",
    "there is a finitely piecewise affine homeomorphism @xmath118 such that @xmath119 on @xmath120 , and @xmath121    the construction of the map @xmath59 is quite long and technical , and hence we subdivide it in several steps .    for our construction , we will need to assume that @xmath122 does not concentrate too much around the corners ; more precisely , we will need that @xmath123 being @xmath124 and @xmath125 .",
    "it is quite easy to achieve that : in fact , it is enough to find two opposite points @xmath126 such that @xmath127 because then we can apply a bi - lipschitz transformation ( with bi - lipschitz constant independent from @xmath128 and @xmath129 ) which moves the points @xmath128 and @xmath129 on the vertices @xmath130 and @xmath131 , and get  ( [ goodpoint ] ) . and in turn , to obtain  ( [ goodcorner ] ) , we notice that every point of @xmath120 is a possible choice for @xmath128 or @xmath129 unless it is , or its opposite point is , in the set @xmath132 by a vitali covering argument , we can cover @xmath133 with countably many balls @xmath134 such that every @xmath135 is in @xmath133 , and the corresponding sets @xmath136 are as in the definition of @xmath133 and are pairwise disjoint .",
    "therefore , we can calculate @xmath137 and since @xmath138 it clearly follows that two opposite points both in @xmath139 exist and then satisfy  ( [ goodcorner ] ) , as required .    to define our map @xmath59",
    ", we will make use of a fine grid made by horizontal segments in @xmath140 .",
    "more precisely , we will take several ( but finitely many ) distinct points @xmath141 in @xmath142 , all with non - positive first coordinate @xmath143 and with second coordinate @xmath144 increasing , with respect to @xmath145 , from @xmath146 to @xmath147 ; on the opposite side , we will take the corresponding points @xmath148 , so that the segments @xmath149 are horizontal .",
    "the way to choose our points is simple : since @xmath56 is piecewise linear , we can take the points in such a way that @xmath56 is linear on every segment @xmath150 , as well as in every @xmath151 .",
    "since this property is of course not destroyed if we _",
    "add _ more points @xmath152 ( as long as we also add the corresponding points @xmath153 , of course ) , we are allowed to add more points during the construction , of course taking care to add only finitely many : we will do this a first time in few lines , and then also later .",
    "from now on , we will call @xmath154 the bounded component of @xmath155 , which is a polygon because @xmath56 is piecewise linear ; notice that the map @xmath59 that we want to construct must be a homeomorphism between @xmath140 and @xmath154 . then , for any @xmath156 , we define @xmath157 the shortest path which connects @xmath158 and @xmath159 inside the closure of @xmath154 ( this shortest path is unique , as we will show in step  3 ) . notice that , since @xmath154 is a polygon , every @xmath157 is piecewise linear , and any junction between two consecutive linear pieces is in @xmath160 .    up to add one more point between @xmath161 and @xmath162 ( plus the corresponding one on the right part ) , we can suppose that @xmath163 is either a segment between @xmath164 and @xmath165 , and this happens if and only if the angle between @xmath166 , @xmath167 and @xmath168 which goes inside @xmath154 is smaller than @xmath169 , or it is done by the union of the two segments @xmath170 and @xmath171 , thus it entirely lies on @xmath160 .",
    "we do the same between @xmath172 and @xmath173 .",
    "let @xmath174 be a simply connected closed planar domain with polygonal boundary .",
    "we briefly recall the proof of the well - known fact that , for any two points in @xmath174 not necessarily on the boundary there is a unique shortest path inside @xmath174 .",
    "since the existence is obvious , we just have to check the uniqueness .",
    "if the claim were not true , there would be two points @xmath175 and two shortest paths @xmath176 and @xmath177 between @xmath78 and @xmath79 inside @xmath174 , such that @xmath176 and @xmath177 meet only at @xmath78 and @xmath79 .",
    "the union of the two paths is then a polygon , say with @xmath178 sides .",
    "the sum of the internal angles of this polygon is @xmath179 , and thus there must be a vertex of the polygon , different from @xmath78 and @xmath79 and thus inside one of the shortest paths , corresponding to an angle strictly less than @xmath169 . since the interior of the polygon is entirely in the interior of @xmath174 , this is of course impossible , because cutting around that vertex would strictly shorten the length of the path , against the minimality .    for two curves @xmath87 and @xmath180 inside @xmath154 and with endpoints in @xmath160 , we say that `` @xmath87 is above @xmath180 '' if @xmath87 does not intersect the interior of the ( possibly disconnected ) subset of @xmath154 whose boundary is the union between @xmath180 and the path on @xmath160 connecting the endpoints of @xmath180 and containing @xmath181 .",
    "we want to show that , for any @xmath182 , the path @xmath183 is above @xmath157 .    to show that , assume that two points @xmath184 and @xmath185 belong to both the paths @xmath157 and @xmath183 .",
    "then , the two restrictions of @xmath157 and @xmath183 from @xmath186 to @xmath187 are two shortest paths , and by step  3 we derive that @xmath157 and @xmath183 coincide between @xmath188 and @xmath189 . as an immediate consequence of this observation",
    ", we get that @xmath183 is above @xmath157 as claimed .",
    "another immediate consequence is the following : the intersection between @xmath157 and @xmath183 is always a connected subpath , possibly empty .",
    "if it is not empty , and then it is a path @xmath190 , we will subdivide both @xmath157 and @xmath183 in three parts , writing @xmath191 where @xmath192 ( resp .",
    "@xmath193 ) is the first part , from @xmath158 to @xmath188 ( resp . , from @xmath194 to @xmath188 ) ; @xmath195 ( resp .",
    "@xmath196 ) is the second part , from @xmath188 to @xmath189 ( thus the common part , and @xmath197 ) ; and @xmath198 ( resp . , @xmath199 )",
    "is the third and last part , from @xmath189 to @xmath159 ( resp .",
    ", from @xmath189 to @xmath200 ) .",
    "if @xmath157 and @xmath183 have empty intersection , then we simply set @xmath201 and @xmath202 , letting @xmath195 , @xmath198 , @xmath196 and @xmath199 be empty paths .",
    "the situation is depicted in figure  [ fig : paths ] , where the common part @xmath197 is done by two segments , one on @xmath160 and the other one in the interior of @xmath154 .",
    "notice that this subdivision of a path does not depend only on the path itself , but also on the other path that we are considering ; in other words , the subdivision of the path @xmath203 done when @xmath204 , and then considering the possible common part between @xmath203 and @xmath205 , does not need to coincide with the subdivision of the same path done when @xmath206 , and then considering the possible common part between @xmath203 and @xmath207 .",
    "let us call @xmath188 the last point of the path @xmath208 ; hence @xmath188 is the first common point with @xmath157 , if @xmath157 and @xmath183 have a non - empty intersection , while otherwise @xmath209 .",
    "we claim that the polygon having @xmath210 as its boundary is convex ( notice that in principle the curve @xmath208 and the segment @xmath211 could have other intersection points in addition to @xmath194 and @xmath188 ) .",
    "we start assuming that @xmath212 , at the end of this step we will then consider the other case .",
    "if @xmath208 is a single point , or just a segment , then the claim is emptily true , and the convex polygon is degenerate .",
    "let us assume then that @xmath208 is done at least by two affine pieces , and assume also , just to fix the ideas , that the direction of the oriented segment @xmath213 is @xmath214 , as in figure  [ fig : range ] , left .",
    "call then @xmath215 the polygon having , as boundary , the jordan curve @xmath216 .",
    "the same argument as in step  3 immediately ensures that , for any vertex of @xmath183 ( i.e. , any junction point between two consecutive linear pieces of @xmath208 ) , the angle pointing inside @xmath154 ( hence in particular inside @xmath217 ) is bigger than @xmath169 . by construction , and recalling step  4",
    ", we get also that none of these points can belong to the curve in @xmath160 connecting @xmath158 and @xmath159 and containing @xmath218 , since such a point should necessarily belong also to @xmath157 , against the definition of @xmath188 .",
    "of course , this already `` suggests '' that our convexity claim is true , but observe that the proof is still not over , since in principle @xmath208 could be some spiral - like curve connecting @xmath194 with @xmath188 .",
    "to conclude the proof , for any vertex of @xmath208 ( except @xmath188 ) consider the range of directions pointing toward the interior of @xmath217 : for instance , the range associated to @xmath194 in the situation of figure  [ fig : range ] , left , is done by the angles between @xmath219 and @xmath220 .",
    "we claim that , for each vertex of the curve @xmath208 , this range can not contain the angle @xmath221 : observe that this will immediately imply the required convexity .",
    "assume then by contradiction that this claim is false , and let @xmath189 be the first vertex of @xmath208 having @xmath214 in its range of directions ; by a trivial perturbation argument we can assume that @xmath214 is in the interior of this range , and then the vertical line passing through @xmath189 is in the interior of @xmath217 for a while , both above and below @xmath189 itself . call then , as in figure  [ fig : range ] , left , @xmath222 and @xmath223 the first points of this line , respectively below and above @xmath189 , which are on @xmath224 .",
    "since the segment @xmath225 is parallel to @xmath226 , each of these points must belong either to @xmath192 or to @xmath208 .",
    "observe now that , if @xmath87 is a shortest path in @xmath227 between its extremes , it is also a shortest path in @xmath227 between any pair of its points .",
    "in particular , if the line connecting two points of @xmath87 is entirely in the closure of @xmath227 , then @xmath87 must be the segment between these two points .",
    "this immediately imply that none of the points @xmath222 and @xmath223 can belong to @xmath208 , because otherwise @xmath208 should be a segment between that point and @xmath189 ; as a consequence , both the points @xmath222 and @xmath223 must belong to @xmath192 , but this is also impossible because then @xmath192 should be the segment between them .",
    "the contradiction shows the claim , and then we have obtained the required convexity .",
    "of course , the very same argument works for the polygon having boundary @xmath228 , being this time @xmath184 the first point of @xmath199 , and everything also works for the polygons around the path @xmath157 instead of @xmath183 .",
    "let us then consider the case when @xmath229 , that is , the case when @xmath157 and @xmath183 are disjoint : this situation is depicted in figure  [ fig : range ] , right .",
    "this time , we define @xmath217 the polygon having , as boundary , the jordan curve @xmath230 . the very same argument as in the first case ensures again that every vertex of @xmath183 has angle bigger than @xmath169 in the direction inside @xmath217 ; as a consequence , the required convexity follows , as before , if the range of every vertex of @xmath183 does not contain the direction @xmath221 .",
    "however , this time it is not impossible that a vertex @xmath189 of @xmath183 has @xmath214 in its range . let then , as before , @xmath189 be the first vertex ( if any ) with this property , and let @xmath231 be as before .",
    "as already noticed , none of the points @xmath232 can be in @xmath183 , and at most one in @xmath157 .",
    "hence , the only possibility is that one point is in @xmath157 , and the other one in @xmath233 .",
    "a simple topological argument ensures that @xmath222 must be in @xmath157 and @xmath223 in @xmath233 .",
    "indeed , consider the path , contained in @xmath224 and not containing @xmath226 , which connects @xmath189 and @xmath222 ; together with the segment @xmath234 , this is a jordan curve , and then it can not intersect the other path in @xmath224 which contains @xmath226 : in particular , it must contain @xmath223 , and it readily follows , as claimed , that @xmath235 , @xmath236 .",
    "the very same topological argument ensures also that @xmath200 is the `` left '' vertex ( that is , the one in the direction @xmath226 ) of the segment @xmath233 , and @xmath159 is the `` right '' one , as in figure  [ fig : range ] , right .",
    "let us now restrict our attention to the subset @xmath237 of @xmath217 made by the polygon whose boundary is the part of @xmath183 connecting @xmath189 to @xmath200 , plus the two segments @xmath238 and @xmath239 .",
    "the same argument of the first half of this step ensures that the range of directions , toward the interior of @xmath237 , corresponding to any vertex of @xmath183 in @xmath240 , can never contain the direction of the segment @xmath233 , since otherwise a segment parallel to @xmath233 and contained in @xmath237 should have both the endpoints in the segment @xmath241 , which is impossible .    finally , it is immediate to notice that this property of the directions , analogously as before , is enough to ensure the required convexity of the polygon having @xmath242 as boundary .    in this step ,",
    "we associate to any vertex @xmath188 of the curve @xmath183 a point ( or many points ) @xmath189 of the curve @xmath157 , and vice versa . every such segment @xmath243 , which we will call `` vertical '' ,",
    "will be contained in the closure of the polygon @xmath244 having boundary @xmath245 , any two vertical segments will have empty intersection , except possibly at a common endpoint , and the following estimate for the length of the vertical segments will hold , @xmath246 let us give our definition distinguishing the possible cases , as in step  5 .",
    "first of all , consider the situation , depicted in figure  [ fig : vertical ] , left , when @xmath157 and @xmath183 have a non - empty intersection . in the common part @xmath247",
    ", we will associate to any vertex @xmath188 of @xmath183 the same point @xmath248 , which is also in @xmath157 by definition .",
    "the segment @xmath243 is just a point , which is of course in the closure of @xmath217 , and the length is @xmath249 , so that  ( [ estilength ] ) of course holds . in",
    "the `` left '' part of the paths , instead , we will give the following simple definition . to any vertex @xmath250 ,",
    "we associate the point @xmath251 so that the segment @xmath243 is parallel to @xmath252 : the existence and uniqueness of such a point , the validity of  ( [ estilength ] ) , and the fact that @xmath243 is contained in the closure of @xmath217 , all come immediately from the convexity obtained in step  5 .",
    "we do the very same thing for the vertices of @xmath192 , and we argue completely similarly for the `` right '' part of the paths , of course taking segments parallel to @xmath253 , instead of @xmath252 .",
    "then we have already completed our definition of the vertical segments , and the fact that any two such segments do not intersect is obvious from the construction .",
    "consider now the situation when @xmath254 , see figure  [ fig : vertical ] , right . without loss of generality we can think that , as in the figure , the direction of @xmath213 is vertical , while the segment @xmath255 goes `` toward left '' .",
    "let then @xmath256 and @xmath257 be the two closest points such that the segment @xmath258 is vertical ; notice that it is possible that @xmath259 or that @xmath260 , this makes no difference in our proof , even if the picture shows an example where @xmath261 is in the interior of the curve @xmath183 .",
    "let us now consider the subset @xmath262 whose boundary is given by the two segments @xmath226 and @xmath263 , together with the parts of @xmath157 ( resp . , @xmath183 ) , connecting @xmath158 and @xmath264 ( resp . , @xmath265 and @xmath261 ) .",
    "again by the convexity result of step  5 , it is clear that at any point of @xmath183 between @xmath194 and @xmath261 starts a vertical segment , whose interior is entirely contained in @xmath237 , which ends in a point of @xmath157 between @xmath158 and @xmath264 .",
    "we define then in the obvious way the `` vertical segments '' inside @xmath237 , which are in fact vertical .",
    "the validity of  ( [ estilength ] ) is as usual obvious from the convexity .",
    "consider now the half - line starting at @xmath261 and parallel to @xmath266 .",
    "the choice of the points @xmath261 and @xmath264 , together with the convexity proved in step  5 , ensure that this half - line remains inside @xmath267 for a while , after the point @xmath261 ; therefore , the intersection of this half - line with @xmath217 is a segment @xmath268 , and the point @xmath269 is on @xmath157 by construction .",
    "observe that @xmath269 coincides with @xmath264 in the particular case when @xmath253 is parallel to @xmath252 , but otherwise it stays , as in the figure , outside of @xmath237 .",
    "the construction implies that all the half - lines , parallel to @xmath253 and starting at a point of @xmath183 after @xmath261 , remain in @xmath217 for a while and then intersect @xmath157 at some point after @xmath269 .",
    "we use this observation to associate to any vertex of @xmath183 after @xmath261 a point of @xmath157 after @xmath269 , and we call then `` vertical segments '' all the corresponding segments , which are actually not vertical but parallel to @xmath253 . finally , to every vertex of @xmath157 between @xmath264 and @xmath269 , if any , we associate always the point @xmath261 .",
    "the validity of  ( [ estilength ] ) for all the vertical segments is then again clear by the construction and by step  5 , and any two vertical segments have always empty intersection , unless in the case when they meet at @xmath261 .",
    "this concludes the step .    from now on , we will always consider as `` vertices '' the points @xmath261 , @xmath264 and @xmath269 , even if they were not vertices in the sense of the piecewise linear curves .",
    "moreover , for every vertex of @xmath157 , or of @xmath183 , we will consider as `` vertex '' also the corresponding point in the other curve , which again could be or not be a vertex in the classical sense .",
    "notice that in this way we are adding a _ finite number _ of new vertices and , as already pointed out before , it is always admissible to regard as `` vertices '' also finitely many new points in our curves .",
    "summarizing , on the piecewise linear curve @xmath157 we are considering as `` vertices '' all the actual vertices , plus some other new points .",
    "however , these `` new points '' have been selected working on the region between @xmath157 and @xmath183 , and then they do not need to coincide with the `` new points '' selected by working on the region between @xmath270 and @xmath157 .",
    "we are now ready to define a function on @xmath140 which extends @xmath56 ; for simplicity , we start now with the definition of a `` temptative '' function @xmath271 , without taking care of the injectivity . the definitive function @xmath59 will be obtained later .",
    "recall that we have selected several horizontal segments @xmath149 , @xmath272 , in the square @xmath140 ; the square is then divided in @xmath273 `` horizontal strips '' , i.e. the regions between two consecutive horizontal segments , plus two triangles , the `` top one '' @xmath274 and the `` bottom one '' @xmath275 .",
    "we start defining the function @xmath271 on the `` @xmath147-dimensional skeleton '' , that is , the union of @xmath120 with all the horizontal segments @xmath149 : more precisely , we set @xmath276 on the boundary @xmath120 , while for every @xmath272 we define @xmath271 on the horizontal segment @xmath149 as the piecewise linear function , parametrized at constant speed , whose image is the path @xmath157 .",
    "notice that , with this definition , @xmath271 is continuous on the @xmath147-skeleton .    to extend @xmath271 to the whole @xmath140 , we can then argue separately on each of the horizontal strips of @xmath140 , as well as on the top and bottom triangle .",
    "first , let us consider the bottom triangle @xmath277 : thanks to the construction of step  2 , we know that the path @xmath163 is either the segment @xmath278 , or the union of the two segments @xmath279 and @xmath280 . in the first case , we define @xmath271 on the bottom triangle as the affine function extending the values on the boundary ; in the second case , let @xmath186 be the point of the segment @xmath281 such that @xmath282 , let us extend @xmath271 as constantly @xmath218 on the segment @xmath283 , and let @xmath271 be the ( degenerate ) affine function extending the values on the boundary on each of the two triangles @xmath284 and @xmath285 . in the top triangle , we give of course the very same definition of @xmath271 .",
    "let us now consider the horizontal strip @xmath286 between @xmath149 and @xmath287 , and let us call @xmath288 the bounded region in @xmath154 having as boundary the closed curve @xmath289 . in step  6 ,",
    "we have selected a finite number of points on @xmath157 and on @xmath183 , and we have called `` vertical segments '' the corresponding segments . more precisely , let us denote the points in @xmath290 as @xmath291 , @xmath128 ,  , @xmath292 , @xmath293 , and the points in @xmath149 as @xmath294 , @xmath295 ,  , @xmath296 , @xmath297 ;",
    "as always , let us write @xmath298 , and @xmath299 .",
    "keep in mind that each segment @xmath300 , whose interior is entirely contained in @xmath288 , has been called a `` vertical segment '' , and notice that the points @xmath301 and @xmath302 are not necessarily all different : for instance , the point @xmath261 of figure  [ fig : vertical ] , right , is the point @xmath301 for three consecutive indices @xmath303 .",
    "we are finally in position to give the definition of @xmath271 on the interior of each strip @xmath286 ( and , since @xmath271 has been already defined in the @xmath147-skeleton and on the top and bottom triangle , this will conclude the present step ) .",
    "the strip @xmath286 is the essentially disjoint union of the triangles @xmath304 and @xmath305 for all @xmath306 , and @xmath288 is the essentially disjoint union of the corresponding triangles @xmath307 and @xmath308 , where the triangles in @xmath288 ( but not those in @xmath286 ) can be degenerate , in particular they are degenerate for the points in @xmath309 .",
    "we define then @xmath271 on @xmath286 as the function which is affine on each of the above - mentioned triangles .",
    "notice that , by construction , @xmath271 is linear on each side @xmath310 and @xmath311 , hence this definition on @xmath286 is a continuous extension of the definition on the @xmath147-skeleton .    in this and in the following step",
    ", we aim to estimate the integral of @xmath312 on @xmath140 ; in particular , in this step we will consider the bottom triangle @xmath313 ( by symmetry , we will get an estimate valid also for the top triangle , of course ) , while in the next step we will consider the situation of the horizontal strips @xmath286 .",
    "the aim of this step is to show the validity of the bound @xmath314 where as usual @xmath55 denotes a purely geometric constant . by simplicity ,",
    "let us call @xmath315 recall that , on the bottom triangle , the function @xmath271 has been defined as an affine function , if the angle @xmath316 , pointing inside @xmath154 , is smaller than @xmath169 or , equivalently , if the curve @xmath163 coincides with the segment @xmath317 and as two degenerate affine functions on the two triangles @xmath284 and @xmath285 ( being @xmath186 as in step  7 ) otherwise .",
    "let us then estimate the @xmath318 norm of @xmath319 on the bottom triangle in both cases .",
    "first of all , consider the non - degenerate case when @xmath271 is a single affine function on the bottom triangle . in particular , the image of the segment @xmath320 is the segment @xmath321 , while the image of the segment @xmath322 is the segment @xmath280",
    "; this implies that , on the bottom triangle , one has @xmath323 where by @xmath324 and @xmath325 we denote the constant value of @xmath326 and @xmath327 on the bottom triangle .",
    "this readily implies @xmath328 on the other hand , @xmath329 which inserted in  ( [ touse1 ] ) , and using  ( [ goodpoint ] ) from step  1 , gives @xmath330 hence , we deduce that @xmath331 thus the validity of  ( [ step8 ] ) follows .",
    "let us now consider the degenerate case , where in the bottom triangle the function @xmath271 is made by two degenerate affine pieces , one on the left triangle @xmath332 and the other on the right triangle @xmath333 ; we call @xmath334 and @xmath335 the constant values of @xmath319 respectively on the left and on the right triangle . since the image of the segment @xmath281 through the map @xmath271 is the path @xmath163 ( that is , the union of the two segments @xmath279 and @xmath336 ) , parametrized at constant speed , we get that @xmath337 ( while in general @xmath338 ) ; more precisely , latexmath:[\\[\\label{touse2 }",
    "moreover , the affine map in the right triangle transforms the segment @xmath322 in the segment @xmath280 , while the affine map in the left triangle moves @xmath320 onto @xmath321 ; this implies @xmath340 which together with  ( [ touse2 ] ) gives @xmath341 ) of step  1 , we obtain again the validity of  ( [ step8 ] ) , possibly with a slightly larger , but still purely geometric , constant @xmath55 .",
    "in this step , we want again to find an estimate for the integral of @xmath312 , but this time on the generic horizontal strip @xmath286 , @xmath342 .",
    "our goal is to obtain the estimate @xmath343 where by @xmath344 we denote the area of the horizontal strip @xmath286 .",
    "consider the horizontal segment @xmath287 : by symmetry , it is not restrictive to assume that this segment is below the @xmath61-axis , precisely at a distance @xmath345 from the `` south pole '' @xmath346 ; in other words , we have that @xmath347 and @xmath348 .",
    "moreover , let us call @xmath349 the distance between the segment @xmath287 and the segment @xmath149 , and @xmath350 remember now that , in step  7 , we defined @xmath271 as the function which is affine on each of the triangles @xmath351 , and @xmath352 , sending each of the points point @xmath353 ( resp . , @xmath354 ) in @xmath140 onto @xmath355 ( resp . , @xmath356 ) in @xmath357 .",
    "let us then concentrate ourselves on the generic triangle @xmath358 ( for the triangles of the form @xmath352 the very same argument will work ) ; since @xmath271 is affine on @xmath359 , let us for simplicity denote by @xmath360 the constant value of @xmath319 on @xmath359 .",
    "first of all let us recall that , on the segment @xmath287 , the function @xmath271 has been defined as the piecewise linear function whose image is @xmath183 , parametrized at constant speed ; this ensures that @xmath361 we observe now that , by definition , @xmath183 is the shortest path in the closure of @xmath154 connecting @xmath194 with @xmath200 ; in particular , @xmath183 is shorter than the image , through @xmath56 , of the curve connecting @xmath362 with @xmath363 on @xmath120 passing through the south pole .",
    "this implies in particular that @xmath364 which inserted in  ( [ late1 ] ) and recalling  ( [ goodpoint ] ) gives @xmath365 let us now use the fact that the affine map @xmath271 on @xmath359 sends the segment @xmath366 onto the segment @xmath300 .",
    "calling , as in figure  [ fig : deriv ] , @xmath367 and @xmath368 the distances between @xmath362 and @xmath369 , and between @xmath152 and @xmath370 , we derive that @xmath371 where in the last equality we have used the estimate  ( [ estilength ] ) from step  6 , which is valid since @xmath300 is a vertical segment in the sense of step  6 .",
    "let us now use once again the fact that @xmath183 is the shortest path between @xmath194 and @xmath200 on the closure of @xmath357 : in particular , @xmath183 is shorter than the path obtained as the union of @xmath252 , the part of @xmath157 between @xmath158 and @xmath302 , the segment @xmath372 , and the part of @xmath183 between @xmath301 and @xmath200 ; namely , @xmath373 which implies @xmath374 the completely symmetric argument , using that @xmath157 is the shortest path between @xmath158 and @xmath159 , thus shorter than the union of @xmath226 , the part of @xmath183 between @xmath194 and @xmath301 , the segment @xmath300 , and the part of @xmath157 between @xmath302 and @xmath159 , gives the opposite inequality , hence we get @xmath375 which further implies @xmath376 using now  ( [ late1 ] ) , we can rewrite the above estimate as @xmath377 which recalling also  ( [ usenow ] ) finally gives @xmath378 we can then easily evaluate the integral of @xmath379 on @xmath359 , also by  ( [ tq ] ) , as @xmath380 adding now the above estimate over all the triangles @xmath359 forming @xmath286 , and recalling  ( [ obvious ] ) and the fact that @xmath381 , we directly obtain  ( [ step9 ] ) .",
    "we start observing that , adding the estimates  ( [ step8 ] ) for the top and for the bottom triangle together with the estimates  ( [ step9 ] ) for all the horizontal strips , we directly obtain the validity of  ( [ hope ] ) for the function @xmath271 .",
    "however , the proof is still not over , because @xmath271 satisfies  ( [ hope ] ) , coincides with @xmath56 on @xmath142 , and it is finitely piecewise affine , but it is not a homeomorphism ( unless all the paths @xmath157 lie in the interior of @xmath154 ) .",
    "however , we can easily obtain this with a simple modification of @xmath271 : more precisely , let us slightly modify all the paths @xmath157 , so that they remain piecewise linear but they live in the interior of @xmath154 and they do not intersect each other .",
    "the idea , depicted in figure  [ fig : step10 ] , is obvious .",
    "notice that , since there are only finitely many paths @xmath157 , and each of them has only finitely many vertices , it is clear that we can `` separate '' as desired all the paths , and we can also move each of them of a distance which is arbitrarily smaller than all the other distances between extreme points . then , we define the function @xmath59 exactly in the same way as we defined @xmath271 , except that we use not the original paths @xmath157 but the modified ones ; therefore , the function @xmath59 is now not only finitely piecewise affine and coinciding with @xmath56 on @xmath142 , but it is also a homeomorphism .",
    "moreover , the estimate  ( [ hope ] ) is still valid , with a geometric constant @xmath55 which is as close as we wish to the one found above .",
    "the proof of the theorem is then now concluded .",
    "[ ext1rem ] a trivial rotation and dilation argument proves the following generalization of theorem  [ extension ] .",
    "if @xmath57 is a square of side @xmath74 and @xmath382 is a piecewise linear and one - to - one function , there exists a piecewise affine extension @xmath383 of @xmath56 such that @xmath384",
    "as already explained in the description of section  [ briefdesc ] , a crucial difficulty in our proof will be the case when a square @xmath57 is `` good '' ( this means that @xmath46 is almost constantly equal to some matrix @xmath51 within @xmath57 ) , but @xmath72 , while being @xmath71",
    ". it will be important to handle this case with care , because the map @xmath5 on @xmath57 is then very close to an affine map , but this affine map is degenerate . the goal of this section is to prove a single result , which will solve this difficulty .",
    "recall that , whenever a map @xmath56 is defined on @xmath387 , for any @xmath388 we denote by @xmath105 the tangent vector to @xmath114 at @xmath108 , by @xmath107 the derivative of @xmath56 in the direction @xmath105 ( whenever it exists ) , and by @xmath389 the length of the curve @xmath390 .",
    "[ extension2 ] let @xmath57 be a square of unit side and @xmath382 a piecewise linear and one - to - one function such that @xmath391 for @xmath392 , where @xmath393 is a geometric quantity .",
    "then there is a finitely piecewise affine homeomorphism @xmath394 such that @xmath119 on @xmath387 and @xmath395    we divide this proof in several steps , to make it as clear as possible .",
    "first of all we notice that , since @xmath56 is a one - to - one piecewise linear function , then its image @xmath390 is the boundary of a nondegenerate polygon , that we call @xmath396 .",
    "moreover , thanks to  ( [ bound ] ) , we know that this polygon is very close to a horizontal segment in @xmath65 . up to a translation , we can assume that the first coordinates of the points in @xmath396 are between @xmath249 and @xmath397 .",
    "fix now any @xmath398 : it is reasonable to expect that there are exactly two points in @xmath390 having first coordinate @xmath349 , and that the two counterimages in @xmath114 are more or less one above the other ( this means , with the same first coordinate ) . in the situation of figure  [ fig:3.2st1 ] , this happens with @xmath349 , but not with @xmath399 , since the points in @xmath400 with first coordinate @xmath399 are four .",
    "we define then `` good '' any @xmath401 with the property that exactly two points in @xmath402 have first coordinate @xmath349 , and with the additional requirement that @xmath403 and @xmath404 .       for any such @xmath349 ,",
    "we call @xmath405 and @xmath406 the two above - mentioned points , being @xmath405 above @xmath406 , and we call @xmath407 and @xmath408",
    ". we can immediately show that a big percentage of the points are good , more precisely @xmath409 indeed , take any segment @xmath410 in @xmath114 on which @xmath56 is linear , and call as usual @xmath411 and @xmath412 : by definition , we have that @xmath413 as a consequence , if the segment @xmath414 is going backward ( that is , @xmath415 and @xmath416 have opposite sign ) , then its horizontal spread is bounded by the above integral on the interval @xmath410 .",
    "recalling  ( [ bound ] ) , this means that all the backward segments have a projection on @xmath417 with total lenght less than @xmath418 . since of course",
    "any @xmath419 which is not good must belong to this projection , the validity of  ( [ lengthbad ] ) follows .    by adding the inequality  ( [ alwaysthis ] ) for all the segments of @xmath114 , we find also that @xmath397 equals the horizontal width of @xmath57 up to an error @xmath420 , thus in particular @xmath421 moreover , take any good @xmath349 and consider all the segments on @xmath114 connecting @xmath422 and @xmath423 : again adding  ( [ alwaysthis ] ) on all these segments , and recalling that @xmath405 and @xmath406 have the same first projection",
    ", we derive that @xmath424 that is , the points @xmath422 and @xmath423 are always exactly one above the other up to an error @xmath420 : the factor @xmath425 comes by the possibility of choosing either of the two paths in @xmath57 from @xmath422 to @xmath423 .    finally , assume that @xmath422 and @xmath423 lie on a same side of @xmath57 for some good @xmath349 .",
    "adding once again  ( [ alwaysthis ] ) among all the segments where @xmath56 is linear connecting @xmath422 and @xmath423 , we derive that , up to an error @xmath418 , the sum of all the horizontal spreads of these segments coincides with the corresponding sum of the horizontal spreads in @xmath402 ; however , the first sum is smaller than @xmath420 by  ( [ smallspread ] ) , while the second is at least the minimum between @xmath426 and @xmath427 , which is impossible by the definition of good @xmath349 .",
    "in other words , we have proved that @xmath422 and @xmath423 never lie on a same side of @xmath57 if @xmath349 is good .",
    "observe now that , since @xmath56 is piecewise linear , then by definition @xmath417 is a finite union of intervals , alternately done entirely by bad @xmath349 and entirely by good ones .",
    "however , the endpoints of all these intervals are always bad .",
    "therefore , we slightly shrink the intervals made by good points and we call _ good intervals _ these shrinked intervals .",
    "thanks to  ( [ lengthbad ] ) , we can do this in such a way that the union of the good intervals covers the whole @xmath417 up to a length of @xmath428 : notice that all the points of any good interval are good points , also the endpoints , while the bad intervals may also contain good points .",
    "finally , it is convenient to make the following further slight modification : up to replace a good interval with a finite union of good intervals , we can also assume that whenever @xmath429 is a good interval , the map @xmath56 is linear in the segments @xmath430 and @xmath431 .    in this step",
    ", we extend @xmath56 which is defined on @xmath114 to a union of segments in @xmath57 . more precisely ,",
    "recall that @xmath417 has been divided in intervals , which can be either bad or good .",
    "moreover , the extremes of these intervals are all good points except @xmath249 and @xmath397 .",
    "take then any other of these extremes , say @xmath349 , and consider the points @xmath422 and @xmath423 in @xmath387 .",
    "we define @xmath56 on the segment @xmath432 as the linear function such that @xmath433 and @xmath434 ; notice that all the different open segments @xmath432 are contained in the interior of @xmath57 by step  1 , and they do not intersect with each other by construction .",
    "we have then many segments @xmath432 inside @xmath57 , almost vertical by  ( [ smallspread ] ) , on each of which a linear function @xmath56 is defined .",
    "observe that , as a consequence , @xmath57 has been divided in several quadrilaterals ( actually , the first and the last one are generally triangles ) , and @xmath56 is defined in the whole corresponding @xmath147-dimensional grid ; also @xmath396 has then been subdivided by the images of @xmath56 in a union of several polygons .",
    "a positive consequence of this fact is that we can now define the extension @xmath59 of @xmath56 in an independent way from each quadrilateral in @xmath57 to the corresponding polygon in @xmath396 respecting of course the boundary data , and being a piecewise affine homeomorphism : then , the resulting function @xmath59 will automatically be a piecewise affine homeomorphism .",
    "let us conclude this short step with another piece of notation : any quadrilateral in @xmath57 will be called a _ good quadrilateral _ if it corresponds to a good interval in @xmath417 , and a _ bad quadrilateral _ otherwise . in the remaining of the proof",
    ", we will first give an estimate for the good quadrilaterals ; then , we will give one for the first and the last quadrilateral , that is , the one starting at @xmath249 and the one ending at @xmath397 : notice that these quadrilaterals are always bad by definition , and actually they are usually triangles . finally , we will give an estimate for the `` internal '' bad quadrilaterals , which we obtain by considering two subcases .",
    "let us first start by considering a good quadrilateral , corresponding to the good interval @xmath429 in @xmath417 ; for brevity , we will write @xmath435 in place of @xmath436 .",
    "recall that the map @xmath56 is linear between @xmath186 and @xmath437 , as well as between @xmath187 and @xmath438 , thanks to the construction in step  1 . as a consequence ,",
    "the image under @xmath56 of the boundary of the quadrilateral @xmath439 is the boundary of the quadrilateral @xmath440 , and we have to define the extension @xmath59 by sending the interior of @xmath439 onto the interior of @xmath441 .",
    "let @xmath59 simply be the piecewise affine map sending @xmath442 onto @xmath443 and @xmath444 onto @xmath445 .",
    "we need to estimate @xmath446 the estimate in the triangle @xmath447 being then of course identical .",
    "let us define for shortness @xmath448 we refer to figure  [ fig:3.2st3 ] for help with the notation . by definition ,",
    "the constant value of @xmath449 in @xmath442 satisfies @xmath450 let us start by defining @xmath451 so that adding the values of @xmath452 on the different segments we will get less than @xmath418 by  ( [ bound ] ) .",
    "we claim now the validity of the following estimates , all obtained again arguing as in  ( [ alwaysthis ] ) : @xmath453 , so they are valid with the small constant @xmath452 ; instead , to get the third estimate we have to integrate on all the segments connecting @xmath186 and @xmath187 on @xmath114 , so we can only estimate with @xmath418 ; the fourth estimate is given by  ( [ smallspread ] ) .",
    "finally , the evaluation of @xmath454 follows by a simple geometric argument , just recalling that @xmath403 , ( [ smallspread ] ) and that we have defined @xmath455 as the direction of the side containing @xmath456 .",
    "let us now start by evaluating @xmath457 : inserting the third equation of  ( [ affinedh ] ) into the first one , we get @xmath458 from which we readily obtain , by using the estimates  ( [ various ] ) and recalling that @xmath459 , @xmath460 substituting the value of @xmath457 again in the third equation of  ( [ affinedh ] ) , we get then @xmath461 we control now the derivatives of @xmath462 : inserting the second equation of  ( [ affinedh ] ) into the fourth , we get @xmath463 so that , again using  ( [ various ] ) and again recalling that @xmath459 , we deduce @xmath464 estimating the integral in  ( [ testm ] ) is then straightforward . notice that @xmath418 is a fixed constant , not depending on the subdivision in intervals : as a consequence , we can assume without loss of generality that @xmath465 , otherwise it is enough to subdivide a good interval in a finite union of good intervals ; the area of the triangle @xmath442 is then less than @xmath466 , and so from  ( [ est11 ] ) , ( [ est21 ] ) and  ( [ est2212 ] ) we obtain @xmath467 where we have also used that @xmath468 and @xmath469 ( the latter follows by straightforward geometrical arguments ) .",
    "of course , the fully analogous estimate holds for the integral in the triangle @xmath447 , up to replace the segment @xmath456 by @xmath470 in the definition  ( [ defeps ] ) of @xmath452 .    to conclude , we need to evaluate the total integral in the union of the good quadrilaterals ; this is simply achieved by summing the above estimates over all the different quadrilaterals .",
    "notice that the constant @xmath418 is fixed and does not depend on the quadrilateral , while the constants @xmath471 and @xmath472 are specific of each quadrilateral . by definition  ( [ defeps ] ) of @xmath452",
    ", it appears clear that the sum of all the different @xmath452 s is less than @xmath418 , while by definition of the lengths in the square it is clear that the sum of the different @xmath472 , as well as of the different @xmath473 , is bounded by @xmath474 . as a consequence",
    ", we deduce that @xmath475 where @xmath476 denotes the union of all the good quadrilaterals in @xmath57 , while @xmath55 is as usual a purely geometric constant .    in this and in the next step",
    "we are going to consider the bad quadrilaterals .",
    "notice that , since almost the whole square is done by good quadrilaterals thanks to  ( [ lengthbad ] ) , we can even be satisfied by a rough estimate here , while we needed a precise one in the preceding step : what is important , is that we can define a piecewise affine homeormophism @xmath59 on each of the bad quadrilaterals .    here",
    "we begin with the `` first '' and the `` last '' quadrilateral , that is , with the quadrilaterals which correspond to the two intervals having @xmath249 or @xmath397 as one endpoint . notice that these `` quadrilaterals '' are actually triangles , unless some side of the square is very close to being vertical .",
    "more precisely , let us consider just the first bad quadrilateral @xmath477 , by symmetry : as figure  [ fig:3.2st4 ] depicts , it can be either a triangle @xmath478 , being @xmath479 the left vertex of the square , or a quadrilateral @xmath480 , if @xmath479 and @xmath481 are the two left vertices of the square , being the side @xmath482 almost vertical , and then the sides @xmath483 and @xmath484 almost horizontal .",
    "notice that all the sides of @xmath477 belong to @xmath387 except @xmath485 .",
    "we need to send @xmath477 on the polygon @xmath486 inside @xmath396 made by the points which have first coordinate less than @xmath487 , shaded in the right of the figure .",
    "keep in mind that by construction ( recall step  1 ) the coordinate @xmath349 is good , and the bad intervals cover only a portion less than @xmath488 of @xmath489 : this means that @xmath490 . as a consequence , again by using several times  ( [ alwaysthis ] ) and  ( [ smallspread ] ) , we know that latexmath:[\\ ] ] as a consequence , we get first that @xmath570 and then that @xmath571 recall now that the estimates  ( [ various ] ) ensure @xmath572 notice carefully that the estimates  ( [ various ] ) were obtained in a good quadrilateral , so they are not valid now , but since the segment @xmath485 corresponds to a good @xmath349 , and in particular it is in the boundary of the good quadrilateral immediately preceding @xmath477 , the estimates about @xmath454 and @xmath573 are still valid and we can use them now . as a consequence , by  ( [ fafe ] ) we get @xmath574 and substituting this in  ( [ estigene ] ) we have also @xmath575 from which we derive @xmath576 since the area of the triangle @xmath559 is bounded by @xmath577 , by  ( [ fin1 ] ) and  ( [ fin2 ] ) , and recalling again @xmath578 , we get @xmath579 so that repeating the same estimate in the triangle @xmath560 , and adding  ( [ stibr1 ] ) , we obtain that in a bad quadrilateral @xmath477 where @xmath542 the estimate @xmath580 holds .",
    "we can now put together all the estimates of the last steps to conclude the proof .",
    "let us start by considering the bad quadrilaterals , whose union is @xmath581 , since in step  3 we have defined @xmath476 as the union of the good quadrilaterals .",
    "thanks to  ( [ intbad5a ] ) and  ( [ intbad5b ] ) , we know that the integral of @xmath563 in any internal bad quadrilateral can always be estimated by @xmath582 .",
    "if we add the different @xmath473 s corresponding to the bad quadrilaterals , up to an error @xmath418 we find the sum of the lengths of the internal bad intervals , which is at most @xmath488 by construction . on the other hand , adding the different @xmath515 s and recalling  ( [ propeta ] ) , we get something smaller than ( twice ) the sum of the lengths of the bad intervals . as a consequence , putting together the estimates for all the internal bad quadrilaterals , and also adding the estimate  ( [ priultqua ] ) for the first and the last bad quadrilateral , we obtain @xmath583 since the total area of the bad quadrilaterals can be estimated by ( twice ) the total length of their horizontal projections , which in turn corresponds with the total length of the bad intervals up to an error @xmath418 , and so it is less than @xmath584 , we can now insert  ( [ intgood ] ) to get @xmath585 which is  ( [ thesisext2 ] ) , and then the proof is concluded .",
    "[ ext2rem ] a trivial rotation and dilation argument proves the following generalization of theorem  [ extension2 ] : whenever @xmath57 is a square of side @xmath74 , @xmath382 is a piecewise linear and one - to - one function , and @xmath51 is a matrix with @xmath72 , there is a finitely piecewise affine extension @xmath383 of @xmath56 such that @xmath586 as soon as @xmath587",
    "this last section is devoted to give the proof of theorem  [ main ] .",
    "this proof is still quite involved , but the overall idea is simple after the preceding sections . as already explained in the introduction , the idea is to divide the whole @xmath2 in squares , and then treat them in three different ways : roughly speaking , the `` good '' squares , where the function is very close to an affine map ( and this group will be further divided in two subgroups ) , and the `` bad '' ones , where this is not true .",
    "moreover , we will have to slightly change the value of @xmath5 on the boundaries of all these squares , in order to become piecewise linear .",
    "then , in the bad squares we will simply use theorem  [ extension ] to get an extension , and the constant @xmath55 in  ( [ hope ] ) will not be a problem because the bad squares will cover only a small portion of @xmath2 .",
    "instead , we have to perform a very precise approximation of @xmath5 in the good squares ; to do so , we will treat differently the squares where the affine map close to @xmath5 has zero determinant , and those where the determinant is strictly positive . for the first ones",
    ", we will use theorem  [ extension2 ] , while for the second ones it will be enough to interpolate the values of @xmath5 on the boundary , as we show in section  [ secgoodsquares ] .        [ defphi _ ] let @xmath592 be a square , and denote by @xmath593 and @xmath594 the two triangles on which @xmath57 is subdivided by the diagonal connecting @xmath595 and @xmath596 .",
    "we call @xmath597 the piecewise affine function which is affine on the two triangles @xmath593 and @xmath594 , and which coincides with @xmath5 on the four vertices of @xmath598 .",
    "[ genlemma ] for every @xmath40 and every matrix @xmath51 , there exists @xmath599 such that the following holds : if @xmath49 is a lebesgue square with matrix @xmath51 and constant @xmath600 , @xmath601 where @xmath602 is the piecewise affine map of definition  [ defphi _ ] and @xmath603 is an affine function satisfyiny @xmath604 .",
    "if in addition @xmath605 , then @xmath606 is injective and @xmath607    we assume for simplicity of notation that the point @xmath52 is the origin of @xmath65 , and we write @xmath608 instead of @xmath609 .",
    "let @xmath610 be a big constant , depending only on @xmath51 and @xmath452 , to be specified later , and let us define the two sets @xmath78 and @xmath79 as @xmath611 by definition of lebesgue square , we immediately get that @xmath612 with @xmath613 , and let us define @xmath614 as @xmath615 : it is clear that @xmath616 is an affine map with @xmath617 , and calling @xmath618 we have by definition @xmath619 .",
    "we claim that @xmath620 ( if @xmath621 the obvious modification of the argument works ) . recalling that @xmath622 and that @xmath623 and @xmath624 , we can evaluate @xmath625 and  ( [ stim1 ] ) is proved .",
    "let now @xmath626 be a generic point .",
    "by  ( [ smallab ] ) , we can find @xmath627 and @xmath628 such that for @xmath629 we have @xmath630 , @xmath631 , @xmath632 and @xmath633 .",
    "hence , @xmath634 is inside the small rectangle @xmath635 having sides with coordinate @xmath636 and @xmath637 , and by  ( [ stim1 ] ) we know that @xmath638 is a small parallelogram around @xmath639 , with @xmath640 having defined @xmath641 .",
    "this estimate , together with  ( [ boundr ] ) , ensures that the whole curve @xmath642 is done by points with distance less than @xmath643 from @xmath639 .",
    "since @xmath5 is a homeomorphism , the point @xmath644 is inside this curve , hence we finally deduce latexmath:[\\[\\label{firstinfty }    where the last inequality holds as soon as @xmath610 has been chosen big enough , depending on @xmath51 and on @xmath452 , and then @xmath646 has been chosen small enough , depending on @xmath610 and @xmath452 , and thus ultimately only on @xmath51 and @xmath452 .",
    "hence , we have obtained the third estimate in  ( [ lemmatoprove ] ) .",
    "let us now consider the function @xmath647 , and let us call @xmath648 the four vertices of the square @xmath608 . by definition , @xmath649 at every vertex @xmath650",
    ": then , in the triangle @xmath593 ( and the same holds true in the triangle @xmath594 ) we have that the two affine functions @xmath606 and @xmath616 satisfy @xmath651 at every vertex , thus  ( [ firstinfty ] ) gives @xmath652 and this , together with  ( [ firstinfty ] ) , implies the first estimate in  ( [ lemmatoprove ] ) .    concerning the second one , let us call @xmath653 the constant value of @xmath654 in @xmath593 , and notice that by  ( [ estivarphipsi ] ) we get @xmath655 and the same estimate holds true for @xmath656 simply by checking the vertices @xmath130 and @xmath657 . as a consequence , we have that the constant value of @xmath658 in @xmath593 is less than @xmath659 , and the same holds true of course also in @xmath594 . in other words , @xmath660 .",
    "since @xmath661 is constantly equal to @xmath51 in the square @xmath608 , by the definition of lebesgue square we get @xmath662 where the last inequality is true up to possibly decrease the value of @xmath646 : this gives the second estimate in  ( [ lemmatoprove ] ) .",
    "let us now suppose that @xmath605 . as a consequence , the image of @xmath608 under @xmath616 is a non - degenerate parallelogram , and then the image of @xmath608 under @xmath606 is the disjoint union of two non - degenerate triangles , as soon as @xmath663 is small enough , depending on @xmath51",
    "; moreover , also the validity of  ( [ stp ] ) is obvious as soon as @xmath664 is small enough , depending on @xmath51 and on @xmath452 .",
    "since  ( [ firstinfty ] ) is valid for every @xmath665 , we get  ( [ stp ] ) up to further increase the value of @xmath610 and decrease the value of @xmath646 , again depending only on @xmath51 and on @xmath452 ; thus , the proof is concluded .",
    "notice that , in the last estimate of the above proof , the final values of @xmath666 and of @xmath418 behave more or less as @xmath452 multiplied by @xmath667 , and the latter number is strictly positive exactly when @xmath605 .",
    "this clarifies the need of the assumption @xmath605 in order to get  ( [ stp ] ) .",
    "we can come to the same conclusion also directly by considering the claim of  ( [ stp ] ) : we can not hope it to be valid for the case when @xmath72 ; indeed , it is true that @xmath5 is as close as we wish to an affine function , but this affine function is degenerate , hence the image of a small square around @xmath52 is close to a degenerate parallelogram , which is a segment ( or even a point if @xmath70 ) . and of course , knowing that the four vertices of a small square are sent very close to the vertices of a parallelogram does not even imply that the piecewise affine function @xmath597 is injective , if this parallelogram is degenerate !",
    "[ genlemmarem ] a quick look at the proof of the above lemma ensures that the constant @xmath668 actually depends only on @xmath452 , @xmath669 , and @xmath670 : more precisely , @xmath668 is the minimum between a constant which continuously depend on @xmath452 , @xmath669 , and @xmath670 for @xmath671 ( found in the first part of the proof ) , and another constant which also depends continuously on @xmath452 , @xmath669 , and @xmath670 , but in the range @xmath605 ( found at the end of the proof ) : this second constant explodes when @xmath672 . as a consequence",
    ", @xmath646 is bounded if @xmath452 is bounded from below , @xmath669 from above , and if @xmath670 is either @xmath249 or it is bounded both from above and below ( with a strictly positive constant ) .      [ 4.6 ] let @xmath589 be given and let @xmath673 be a lebesgue point for @xmath46 .",
    "then , there exists @xmath674 such that , for any @xmath675 and any @xmath676 , the square @xmath598 is a lebesgue square with matrix @xmath677 and constant @xmath418 .",
    "let @xmath678 , @xmath588 and @xmath589 be as in the claim .",
    "since @xmath673 is a lebesgue point , there exists @xmath679 such that , for any @xmath675 , one has @xmath680 and @xmath681 let now @xmath676 .",
    "we have @xmath682 , and moreover  ( [ thisest ] ) gives @xmath683 and by definition  [ lebsquare ] this means that @xmath598 is a lebesgue square with matrix @xmath51 and constant @xmath418 .",
    "thus , the proof is concluded .      in this section",
    "we describe how to `` move the vertices '' of a grid in order to be able to control the average of @xmath684 inside a square with the average of @xmath684 on the boundary of the same square .",
    "to do so , we first introduce the following notation .",
    "we say that the domain @xmath2 is an _",
    "@xmath77-set _ if it is the finite union of essentially disjoint squares , all having side @xmath74 and sides parallel to the coordinate axes .",
    "any side of one of these squares will be called _ side of type a _ if both the endpoints are in the interior of @xmath2 , _ side of type b _ if at least one endpoint is in @xmath44 , but the interior of the side is inside @xmath2 , and _ side of type c _ if the whole side is in @xmath48 .",
    "any vertex of one of the squares will be then called _ vertex of type a _ if it belongs to the interior of @xmath2 , _ vertex of type b _ if it belongs to @xmath44 but it is endpoint of at least one side of type b , and _ vertex of type c _ otherwise .",
    "let @xmath2 be an @xmath77-set , @xmath685 and let @xmath686 be a vertex of type a. we call @xmath687 the segment of length @xmath688 centered at @xmath479 and with direction @xmath689 , namely @xmath690 notice that all the segments @xmath687 lie inside @xmath2 and they do not intersect with each other .",
    "the main result that we prove ensures that the average of @xmath684 in a side of a square can be always estimated with the average of @xmath684 in the whole square , up to move the two vertices in the corresponding segments @xmath691 .",
    "actually , in order to be able also to treat lebesgue squares with @xmath72 , we will in fact estimate @xmath692 instead of @xmath684 for some matrix @xmath51 : then , we will apply this result with @xmath70 for all the non - lebesgue squares , and with @xmath677 for lebesgue squares `` almost centered '' at a lebesgue point @xmath673 .",
    "unfortunately ( but the reason is quite evident ) the estimate must explode as @xmath693 ; however , this will not be a problem for our construction .",
    "[ movegrid ] let @xmath2 be an @xmath77-set , let @xmath82 be a side of type a , and let @xmath694 be a matrix .",
    "calling @xmath695 the union of the @xmath696 squares of the grid having either @xmath78 or @xmath79 ( or both ) as one vertex and @xmath697 one has @xmath698    let us suppose , just to fix the ideas , that the side @xmath82 is horizontal , as in figure  [ fig : move ] ; suppose also , for the moment , that @xmath70 .",
    "let then @xmath699 be the small parallelogram dark shaded in the figure , while @xmath635 is light shaded whose four vertices are the endpoints of the segments @xmath700 and @xmath701 .",
    "a simple change of variable argument , together with the fact that @xmath702 , ensures that @xmath703 on the other hand , writing @xmath704 for shortness , we also have @xmath705 hence we deduce @xmath706 from which  ( [ moveclaim ] ) immediately follows .    to show the general case with @xmath71 ,",
    "it is enough to apply the above argument to the function @xmath707 : of course the set @xmath708 coincides with the set @xmath709 corresponding to the function @xmath710 , hence  ( [ moveclaim ] ) follows also in the general case",
    ".    the above result will be useful in order to treat the internal squares , but we have to take care also of the boundary squares .",
    "let us then extend the definition of the segment @xmath687 to the vertices of type b.    let @xmath2 be an @xmath77-set and let @xmath711 be a vertex of type b. if @xmath479 is vertex of exactly two squares of the decomposition , and these two squares are adjacent ( as for @xmath130 in figure  [ fig : gener ] , left ) , then we call @xmath687 the segment of length @xmath712 on @xmath48 centered at @xmath479",
    ". if @xmath479 is vertex of three squares of the decomposition ( as for @xmath131 in the figure ) , then we call @xmath687 the union of the two segments contained in @xmath44 , of length @xmath713 , having @xmath479 as one endpoint .",
    "notice that we have defined @xmath687 only for the vertices of type a and b , thus for instance not for points as @xmath714 of @xmath657 in figure  [ fig : gener ] .",
    "we want now to extend the validity of lemma  [ movegrid ] for sides of type b. to do so near points like @xmath131 in figure  [ fig : gener ] left , we need a last simple definition .",
    "[ def : tilde ] let @xmath2 be an @xmath77-set and let @xmath711 be a vertex of three squares of the decomposition , say @xmath715 .",
    "we call @xmath716 the right triangle having right angle at @xmath479 , two sides of length @xmath717 , one horizontal and one vertical , and being not contained in @xmath2 , and for @xmath718 we call @xmath719 the square contained in @xmath720 , having one vertex at @xmath479 , and side @xmath717 .",
    "then , we let @xmath721 be the obvious piecewise affine homeomorphism between @xmath722 and @xmath723 , which is bi - lipschitz with constant @xmath724 . finally , we call @xmath725 the union of @xmath2 with all the triangles @xmath716 for vertices @xmath479 as above , and we call @xmath726 the piecewise affine homeomorphism which coincides with @xmath721 around every vertex @xmath479 , and which is the identity outside ( see figure  [ fig : gener ]",
    ", right ) .",
    "notice that @xmath727 is the identity in a @xmath77-neighborhood of all the internal squares of the decomposition , and it is globally @xmath724-bilipschitz .",
    "finally , for every @xmath728 such that the segment @xmath729 is contained in @xmath730 , we call @xmath731 the counterimage , under @xmath727 , of this segment ( which is of course a piecewise linear path ) .      [ movegrid2 ] let @xmath2 be an @xmath77-set and let @xmath732 be a side of type b. calling @xmath695 the union of the squares of the grid having either @xmath78 or @xmath79 ( or both ) as one vertex and defining @xmath733 one has @xmath734    this is a very simple generalization of lemma  [ movegrid ] , we just have to consider a few possible cases , all depicted in figure  [ fig : geneps ] . without loss of generality",
    ", we can assume that @xmath735 and that the segment @xmath82 is horizontal .",
    "if @xmath79 belongs to three squares of the decomposition , then there are three possible subcases .",
    "first of all , @xmath78 can be inside @xmath2 ( this is the first case depicted in the figure ) ; second , @xmath78 can also belong to three squares of the decomposition ( depending on how these squares are , this is the second or the third case in the figure ) ; last , @xmath78 can belong to two squares , which are then necessarily the two squares having @xmath82 as a side ( this is the fourth case in the figure ) .",
    "otherwise , @xmath79 can belong to exactly two adjacent squares of the decomposition , and then again @xmath78 can either be inside @xmath2 ( fifth case in the figure ) or in the boundary of @xmath2 : in this latter case ( the sixth and last one in the figure ) @xmath78 must also belong only to the same two squares to which @xmath79 belong , since otherwise we fall back into an already considered case . to clarify the situation , figure  [ fig : geneps ]",
    "does not show the situation in @xmath2 , but directly in @xmath725 .",
    "the proof is now almost identical to the proof already done in lemma  [ moveclaim ] .",
    "let us call again @xmath736 the quadrilateral having as vertices the endpoints of @xmath737 and @xmath738 ; this quadrilateral , depicted in the figure for all the possible cases , belongs to @xmath725 .",
    "notice that , depending on the case , @xmath635 can be done by @xmath724 , or @xmath739 , or @xmath474 , or @xmath740 squares , and the figure always shows only ( the image under @xmath727 of ) these squares . to conclude the proof we only have to keep in mind that we are interested in what happens in the real domain @xmath2 , not in the simplified domain @xmath725 .",
    "however , we can use the map @xmath727 to move the situation from @xmath2 to @xmath725 ; then , we notice that the very simple calculation done in lemma  [ moveclaim ] works perfectly in the new situation ; and finally , we use @xmath741 to get back to the case of @xmath2 .",
    "the only detail which changes , since @xmath727 is @xmath724-bilipschitz , is that the constant @xmath742 in the old definition of @xmath743 for internal sides becomes @xmath744 for the new definition of @xmath743 for sides touching the boundary .",
    "let us now fix a matrix @xmath745 for any side @xmath82 of type a , and write for brevity @xmath746 .",
    "thanks to the above results , we have defined a set of `` bad pairs '' @xmath747 , where `` bad '' means that in the segment @xmath748 ( or in the curve @xmath731 ) too much derivative is concentrated .",
    "we can now find a selection of points @xmath749 for any vertex @xmath479 , so that for any side @xmath82 the pair @xmath750 does not belong to @xmath751 .",
    "[ selection ] let @xmath2 be an @xmath77-set , and let us fix a matrix @xmath752 for any side of type a. it is possible to select a point @xmath749 for any vertex @xmath479 of type a or b in such a way that , for every side @xmath82 of type a or b , one has @xmath753 .",
    "we will argue recursively .",
    "first of all , let us enumerate all the vertices of type a or b as @xmath754 , for some @xmath755 .",
    "then , we aim to show that it is possible to select by recursion points @xmath756 in every @xmath757 in such a way that , whenever @xmath758 is a side of type a or b , the point @xmath636 is chosen in such a way that @xmath759 notice that , since we will define the points recursively , then the above requests make sense : in particular , if @xmath760 then the point @xmath761 has been already chosen when we have to choose @xmath636 .",
    "of course , if we can select all the points @xmath636 according to  ( [ howtopick ] ) , then we are done : the thesis will be simply given by the second property in  ( [ howtopick ] ) , but the first one is essential to let the recursion work .",
    "let then @xmath762 , and let us suppose that the points @xmath763 for @xmath764 have been already chosen according to  ( [ howtopick ] ) ; let @xmath765 ( resp . ,",
    "@xmath766 ) be the number of the indices @xmath764 ( resp . , @xmath767 )",
    "such that @xmath768 is a side of type a or b. by  ( [ howtopick ] ) applied to the indices @xmath764 , we know that the points @xmath769 such that @xmath770 for some @xmath764 corresponding to a side @xmath768 cover a portion at most @xmath771 of @xmath757 . on the other hand , by lemma  [ movegrid2 ] , the points @xmath769 such that @xmath772 for some @xmath767 for which @xmath768 is a side of type a or b cover a portion at most @xmath773 of @xmath757 . since of course @xmath774 , we can pick a point @xmath775 for which none of the above problems occur , hence by definition this choice fulfills  ( [ howtopick ] ) .",
    "the recursion argument is then proved , and the proof is concluded .    the last goal of this section is to define an approximating function @xmath710 of @xmath5 on the grid given by the boundaries of the squares .",
    "first of all , let us give the definition of `` grid '' and `` modified grid '' .",
    "[ defgrid ] let @xmath2 be an @xmath77-set , and for any vertex @xmath479 of type b let @xmath481 be a given point @xmath776 in @xmath687 ; instead , let @xmath777 for any vertex @xmath479 of type a or c. we call _ grid _ the union @xmath778 of all the sides @xmath82 of the squares of the decomposition , while the _ modified grid _ is the union @xmath779 of all the `` modified sides '' , that is , the piecewise linear curves @xmath780 .",
    "notice that , if @xmath781 , it might happen that the curve @xmath780 has not been defined in definition  [ def : tilde ] ; if this is the case , we simply denote by @xmath780 the shortest curve in @xmath782 connecting @xmath783 and @xmath784 : notice that this shortest curve lies entirely inside @xmath44 , and that actually this minimizing property for @xmath780 is true also for the sides @xmath785 where @xmath780 was already defined in definition  [ def : tilde ] . for every square @xmath57 of the grid , we call @xmath786 the union of its modified sides .",
    "observe that the grid @xmath779 coincides with the grid @xmath778 , except near the boundary of @xmath2 ; analogously , the piecewise linear curve @xmath780 is nothing else than the segment @xmath82 , if it is a side of type a. notice that both the grid and the modified grid contain the boundary of @xmath2 .",
    "we give now our last definition of a map @xmath710 on @xmath787 .",
    "[ defabo ] let @xmath2 be an @xmath77-set , and for any side @xmath82 of type a fix a matrix @xmath745 .",
    "let the points @xmath749 for the different vertices @xmath479 of type a or b be as in lemma  [ selection ] .",
    "we define the function @xmath788 as follows . for any side @xmath82 of type",
    "a or b , we define @xmath56 on the curve @xmath780 as the reparameterization , at constant speed , of the function @xmath5 on the curve @xmath789 ; moreover , we let @xmath790 on @xmath791 .    in the above definition , it is important not to confuse the points @xmath776 with the points @xmath481 : according with definition  [ defgrid ] , @xmath792 if @xmath479 is a vertex of type b , while @xmath777 if @xmath479 is a vertex of type a or c. in particular , if @xmath82 is a side of type a , then @xmath780 is simply the segment @xmath82 , hence @xmath56 on the segment @xmath82 is the reparameterized copy of @xmath5 on the segment @xmath793 .",
    "we conclude this section with an estimate for the function @xmath56 .    [ 4.16 ] let @xmath2 be an @xmath77-set , and let the matrices @xmath745 , the points @xmath776 and the function @xmath794 be as in definition  [ defabo ] .",
    "then , for any side @xmath82 of type a , calling @xmath795 the unit vector with direction @xmath82 and @xmath635 again the union of the squares of the grid having either @xmath78 or @xmath79 as one vertex , we have @xmath796 instead , for any side @xmath82 of type b , we have @xmath797    let us start with a side @xmath82 of type a , and call for brevity @xmath798 and @xmath799 . by lemma  [ movegrid ] , we already know that @xmath800 recall now that , by definition , the function @xmath56 on the segment @xmath82 is simply the reparameterization of the function @xmath5 on the segment @xmath748 .",
    "define then @xmath801 , and call @xmath802 the unit vector with direction @xmath748 : notice that by construction @xmath803 as a consequence , by a change of variable we obtain @xmath804 thus recalling  ( [ alreadyknow ] ) we get  ( [ firstthesis ] ) .",
    "let now @xmath82 be a side of type b , and call again for brevity @xmath798 and @xmath805 . in this case , by lemma  [ movegrid2 ] we already know that @xmath806 now , by definition of @xmath56 we have that the image of @xmath780 under @xmath56 coincides with the image of @xmath731 under @xmath5 , hence the lengths of the two curves coincide , which means @xmath807 hence , ( [ secondthesis ] ) directly follows from  ( [ hereabove ] ) , and the proof is concluded .      in this section ,",
    "we show how to modify a function on a one - dimensional grid ; more precisely , we take a generic function defined on a grid , and we modify it in order to become piecewise linear .",
    "we have to do so because both our big results , namely theorems  [ extension ] and  [ extension2 ] , need a function which is piecewise linear on the boundary of a square .",
    "we start with a rather simple modification , which we will eventually apply to the `` bad '' squares and to the `` good '' squares corresponding to a matrix with @xmath72 ; this construction is reminiscent to the one made in  @xcite , where the situation was more complicated because also the inverse should be approximated .    [ notgoodforgood ]",
    "let @xmath2 be an @xmath77-set , let @xmath778 and @xmath787 be a grid and a modified grid according to definition  [ defgrid ] , and let @xmath808 be a continuous , injective function which is piecewise linear on @xmath44 .",
    "then , there exists a piecewise linear and injective function @xmath809 such that @xmath810 on @xmath44 , @xmath811 for every vertex @xmath479 of the grid , and for every side @xmath82 of type a and every matrix @xmath51 one has @xmath812 while for every side @xmath82 of type b one has @xmath813 moreover , on each curve @xmath780 the function @xmath814 is an interpolation of finitely many points of the curve @xmath815 .",
    "we define the map @xmath814 in two steps , namely , we work first around the vertices , and then in the interior of the sides .",
    "figure  [ fig : interpol ] depicts how the construction works .",
    "let us start by selecting a vertex @xmath479 of type a , that is , @xmath479 belongs to the interior of @xmath2 .",
    "there are then four sides of the grid for which @xmath479 is an endpoint , and we can call @xmath816 the four other endpoints of these sides . since @xmath56 is continuous and injective , the quantity @xmath817 is strictly positive : let us then select a small radius @xmath818 , much smaller than this quantity .",
    "hence , by definition , the ball @xmath819 intersects the image of the grid @xmath787 under @xmath56 only in points of the form @xmath63 for @xmath61 belonging to one of the four sides @xmath820 . on the other hand , for each @xmath821 there is at least a point @xmath822 such that @xmath63 belongs to @xmath823 .",
    "let us then call @xmath824 the last point @xmath61 of the segment @xmath820 for which @xmath825 , where `` last '' means `` the farthest from @xmath479 '' .",
    "we define then the function @xmath814 , on each of the four segments @xmath826 , simply as the linear function connecting @xmath827 with @xmath828 .",
    "let us now consider a vertex @xmath479 of type b , that is , @xmath479 belongs to @xmath48 but there is some side of the grid , contained in the interior of @xmath2 , of which @xmath479 is an endpoint : let us call @xmath829 the number of such sides , and notice that by construction @xmath829 is either one or two ( keep in mind figure  [ fig : geneps ] ) .",
    "we argue then similarly as before : we call @xmath650 , for @xmath830 the other endpoints of these internal sides , and we consider the strictly positive quantity @xmath831 this time , we will define @xmath832 not only much smaller than the above quantity , but also so small that @xmath833 is the union of two segments ( this is surely true as soon as @xmath834 is small enough , since @xmath56 is piecewise linear on @xmath44 ) .",
    "exactly as before , for @xmath830 we call @xmath835 the last point @xmath836 such that @xmath837 : up to further decrease @xmath838 , we can also assume that the portion of the piecewise linear curve @xmath839 connecting @xmath481 and @xmath835 is simply a segment .",
    "then , as before we define @xmath814 on each of the @xmath829 segments @xmath840 as the linear function connecting @xmath841 with @xmath842 .    up to now",
    ", we have defined @xmath814 on a neighborhood of each vertex of type a and b ; moreover , @xmath814 is already automatically defined on @xmath44 , since it must be @xmath810 on @xmath44 .",
    "therefore , to conclude we have to define @xmath814 on the remaining portion of @xmath787 . by construction , this remaining portion is a finite and disjoint union of internal parts of sides of type a or b : more precisely , for every side @xmath82 of type a there is a segment @xmath843 where @xmath814 has to be defined , while for every side @xmath82 of type b @xmath814 has still to be defined in some piecewise linear curve @xmath844 .",
    "let us first consider the case of a side @xmath82 of type a : the function @xmath814 has been already defined in the segment @xmath845 ( resp .",
    ", @xmath846 ) as the linear function connecting @xmath847 and @xmath848 ( resp . , @xmath849 and @xmath850 ) , and moreover the points @xmath851 and @xmath852 are in the boundary of the disks @xmath853 and @xmath854 respectively .",
    "we have to define @xmath814 in the segment @xmath855 , and this must be a piecewise linear curve connecting @xmath848 and @xmath849 . observe that @xmath56 , in the segment @xmath855 , is already a curve connecting @xmath848 and @xmath849 , the only problem being that it is not necessarily piecewise linear .",
    "we can then select many points @xmath856 in the segment @xmath855 , and define @xmath814 in @xmath855 as the piecewise affine interpolation of these values ( that is , @xmath857 and @xmath814 is linear on each @xmath858 ) . a very simple geometric argument ( similar to  ( * ? ? ?",
    "* lemma  5.5 ) , but much easier ) shows that , by choosing carefully many points , the map @xmath814 in @xmath855 is injective , it never crosses the two disks @xmath859 and @xmath860 , and its @xmath861 distance with @xmath56 is much smaller than @xmath862 let us now consider a side @xmath82 of type b : in this case , @xmath814 is piecewise linear in the two segments @xmath863 and @xmath864 , and we have to extend the definition to the piecewise linear curve @xmath865 .",
    "this can be done exactly as we just did for a side of type a , the only difference is that , by doing the interpolation , the points @xmath135 must include all the extremes of the segments forming the curve @xmath865 .",
    "apart from that , nothing else changes , thus the definition of @xmath814 is finally concluded . to conclude the proof , we just need to check that @xmath814 fulfills all the required properties .",
    "the fact that @xmath810 on @xmath48 and at every vertex is true by construction , as well as the fact that @xmath814 is an interpolation of finitely many points of the curve @xmath815 on every side @xmath780 of @xmath779 . to check  ( [ check1 ] ) and",
    "( [ check2 ] ) , we just have to keep in mind that @xmath866 is the length of the curve @xmath56 on the segment @xmath82 , while @xmath867 is the length of the ( piecewise affine ) curve @xmath814 on @xmath82 . but any interpolation of points of a curve is shorter than the curve itself , thus  ( [ check1 ] ) follows immediately for the case @xmath70 , and the very same argument with @xmath780 in place of @xmath82 ensures also  ( [ check2 ] ) .    to show  ( [ check1 ] ) when @xmath71 , let @xmath868 be a segment where @xmath814 is linear and satisfies @xmath869 , @xmath870 : then @xmath871 thus adding over the segments where @xmath814 is linear we get  ( [ check1 ] ) and the proof is finished .",
    "we conclude this section with the following generalization of the above result , rather technical but very useful to obtain theorem  [ main ] , and whose proof is actually nothing else than a straightforward modification of the previous one .    [ goodforstarting ] let @xmath872 be a finite union of closed segments in @xmath65 , and let @xmath873 , with @xmath874 , be a selection of some of them .",
    "let @xmath875 be a continuous one - to - one function , and let @xmath876 be given .",
    "then , there exists another continuous and one - to - one function @xmath877 such that @xmath810 at every endpoint of each segment , @xmath878 is contained in the @xmath515-neighborhood of @xmath879 , @xmath814 is piecewise linear on @xmath879 , and for every side of @xmath477 the estimates  ( [ check1 ] ) and  ( [ check2 ] ) hold .",
    "the proof can be done almost exactly as in proposition  [ notgoodforgood ] .",
    "first of all , up to a subdivision of some of the segments , we can assume that every two segments are either disjoint , or they meet at a common endpoint .",
    "then , we start defining @xmath810 on all the sides both whose endpoints are not contained in @xmath879 .",
    "further , we consider any of the remaining vertices , say @xmath479 .",
    "we can select a small @xmath834 such that the ball @xmath819 contains only points of the form @xmath63 for @xmath61 belonging to one of the ( finitely many ) segments @xmath820 having @xmath479 as an endpoint ; up to decrease @xmath834 , we can also ensure that @xmath880 for any such @xmath61 .",
    "we define then the points @xmath835 exactly as in step  i of proposition  [ notgoodforgood ] , and we let @xmath814 be linear on each segment @xmath881 : the continuity and injectivity of @xmath814 up to now is then clear . in the portions of the segments where @xmath814 has not yet been defined ,",
    "we can then define it in two different ways : inside the segments which belong to @xmath879 , we define a piecewise linear @xmath814 exactly as in step  ii of proposition  [ notgoodforgood ] ; inside the other segments , we simply let @xmath810 .",
    "we are finally in position to give the proof of theorem  [ main ] , which will come by putting together all the results that we got up to now . for the reader",
    "s convenience , we split the proof in some parts .",
    "the first one is a very peculiar case , namely , when @xmath2 is an @xmath77-set and the function @xmath5 is already piecewise linear on the boundary ; nevertheless , most of the difficulties are contained in this part .",
    "[ allhere ] under the assumption of theorem  [ main ] , assume that in addition @xmath2 is an @xmath77-set , and that @xmath5 is continuous up to @xmath44 and piecewise linear there .",
    "then , for every @xmath40 there exists a finitely piecewise affine homeomorphism @xmath882 such that @xmath883    the idea of the construction is rather simple : we divide the squares in four groups , namely , the lebesgue squares with positive determinant , the lebesgue squares with @xmath71 but zero determinant , the lebesgue squares with @xmath70 , and the other ones . inside the first squares we can substitute @xmath5 with @xmath884 and rely on lemma  [ genlemma ] , for the second ones we will use theorem  [ extension2 ] , and for the third and fourth ones theorem  [ extension ] .",
    "however , to treat each square separately , we need to take care of the values on the boundaries of the squares : on one hand , they must be piecewise linear , in order to allow us to apply theorems  [ extension2 ] and  [ extension ] , and this will be obtained thanks to proposition  [ notgoodforgood ] ; but on the other hand , any two adjacent squares must have the same boundary values on the common side , and this will require same care . let us then start with the proof , dividing it in several steps .",
    "first of all , we have to take five small constant @xmath885 for @xmath886 .",
    "more precisely , @xmath887 is a small geometric constant ( for instance , @xmath888 is enough ) ; instead , the constants @xmath889 will depend on the data , that is , @xmath890 and @xmath452 .",
    "more precisely , since @xmath891 , we can select @xmath892 so small that @xmath893 where @xmath55 is a purely geometric constant , which we will make explicit during the proof .",
    "then , we define @xmath894 in such a way that @xmath895 this estimate is surely true as soon as @xmath896 is small enough , depending on @xmath897 , on @xmath2 , and on @xmath5 .",
    "now , we define the following two subsets of the matrices @xmath694 , @xmath898 which of course depend only on @xmath896 . finally , we let @xmath899 be so that @xmath900 and we set @xmath901 as @xmath902 where @xmath646 are the constants of lemma  [ genlemma ] .",
    "observe that @xmath903 really depends only on @xmath896 and @xmath904 by construction , as observed in remark  [ genlemmarem ] .",
    "the last constant to select is @xmath77 : indeed , @xmath2 is an @xmath77-set , but then we can regard it as an @xmath905-set for every @xmath906 ; as a consequence , we can now change the value of @xmath77 , making it as small as we need : in particular , we let @xmath77 be so small that @xmath907 where the constants @xmath908 have been defined in lemma  [ 4.6 ] for every @xmath909 which is a lebesgue points for @xmath46 ( so , for almost every point of @xmath2 ) , and where @xmath910 is as usual the perimeter of @xmath78 , that is , @xmath911 .    having fixed all the constants @xmath885 , and having also chosen the final value of @xmath77 , we can now enumerate the squares of the grid as @xmath912 , and we subdivide these squares in four groups , namely , @xmath913 we aim now to show that most of the squares belong to the first three groups .",
    "in fact , let us consider the total area of the squares containd in @xmath914 .",
    "the union of those which touch the boundary of @xmath2 has of course an area smaller than @xmath915 .",
    "let us instead consider a square @xmath916 compactly contained in @xmath2 : this means that , for every point @xmath917 , either we can not apply lemma  [ 4.6 ] with constant @xmath903 to @xmath61 ( thus , @xmath918 ) , or @xmath61 belongs to the set in  ( [ firstbad ] ) . since the area of @xmath49 is four times greater than the area of @xmath919 , by  ( [ firstbad ] ) and  ( [ secondbad ] ) we deduce @xmath920    let us now show that squares in @xmath921 and @xmath922 never meet , that is , no vertex of a square in @xmath921 can be vertex also of a square in @xmath922 : this will come as a simple consequence of the @xmath861 estimate  ( [ lemmatoprove ] ) in lemma  [ genlemma ] . indeed ,",
    "assume for simplicity of notations that @xmath923 and @xmath924 have some common vertex , and that @xmath925 .",
    "then , lemma  [ genlemma ] provides us with two affine functions @xmath926 satisfying @xmath927 , each @xmath720 being a lebesgue square with matrix @xmath928 .",
    "let us now call @xmath929 so that by  ( [ lemmatoprove ] ) and recalling  ( [ defhatdelta ] ) , we have @xmath930 since @xmath931 , by construction we can find two points @xmath932 such that @xmath933 and @xmath934 .",
    "the last inequality , keeping in mind the definition of @xmath921 , yields then @xmath935 since this is in contradiction with  ( [ here345 ] ) , we have concluded the proof of this step . for later use",
    "we underline that , more in general , we have proved what follows : @xmath936    in this step , we define a modified grid @xmath937 and a function @xmath938 on it .",
    "to do so , we simply have to choose a matrix @xmath752 for every side @xmath82 of type a of the grid @xmath778 ; once done this , we get first the points @xmath939 from lemma  [ selection ] applied with @xmath940 in place of @xmath452 , then the modified grid @xmath937 from definition  [ defgrid ] , and finally the function @xmath941 from definition  [ defabo ] .",
    "the matrices @xmath752 will be defined as follows . for any side @xmath82 of type",
    "a , let for a moment @xmath942 and @xmath943 be the two squares of the grid having @xmath82 as a side : then , if neither @xmath942 nor @xmath943 belong to @xmath922 , we let @xmath944 ; if @xmath945 but @xmath946 , then we let @xmath947 , and analogously if @xmath948 and @xmath949 we let @xmath950 ; finally , if both @xmath942 and @xmath943 belong to @xmath922 , then we set @xmath752 to be arbitrarily one between @xmath951 and @xmath952 : it makes no difference which one we choose , since by  ( [ adjasimil ] ) we know that @xmath953 .",
    "we want now to evaluate @xmath954 for some of the modified squares @xmath955 ( recall definition  [ defgrid ] ) .",
    "let us start by taking a square @xmath956 , and let us call @xmath957 the union of the nine squares around it ( more precisely , of those which are inside @xmath2 ) .",
    "take any side @xmath958 of type a or b , and observe that the union @xmath959 of the squares touching @xmath78 or @xmath79 is contained in @xmath960 .",
    "if @xmath82 is of type a but @xmath944 , or if @xmath82 is of type b , we can apply lemma  [ 4.16 ] ( using  ( [ firstthesis ] ) or  ( [ secondthesis ] ) if @xmath82 is of type a or b respectively ) and get @xmath961 instead , if @xmath962 , then of course @xmath963 since the boundary of @xmath955 is nothing else than the union of its four modified sides @xmath780 , adding the last two estimates for the four sides of @xmath114 we get @xmath964 being @xmath965 let us now consider a square @xmath966 , and notice that by definition it is compactly contained in @xmath2 , so @xmath967 and @xmath968 for any of its sides .",
    "let @xmath82 be one of those sides , and notice that @xmath969 , being @xmath57 a lebesgue square with matrix @xmath51 and constant @xmath903 : indeed if the other square having @xmath82 as a side is not in @xmath922 , then @xmath970 , and otherwise the inequality is given by  ( [ adjasimil ] ) . as a consequence ,",
    "again  ( [ firstthesis ] ) of lemma  [ 4.16 ] and the definition of @xmath971 give @xmath972 where in the last inequality we have used definition  [ lebsquare ] together with the fact that @xmath973 .    in this step , we define a second modified grid and a second temptative function ; the idea is to repeat almost exactly the procedure of step  iii , but using the neighborhoods @xmath974 instead of those @xmath975 .",
    "in fact , the presence of @xmath940 is perfect for the squares in @xmath922 , since in  ( [ benecosi ] ) we only have small terms like @xmath976 or @xmath977 ; instead , for the squares in @xmath978 , the constant @xmath940 in  ( [ tul ] ) is too small , and we would need something much larger than @xmath897 . since there is no constant which is at the same time much larger than @xmath897 and much smaller than @xmath896 , we are forced to repeat the procedure .",
    "this time , let us define the matrices @xmath979 for all the sides @xmath82 of type a , and let us consider a slightly modified version of the intervals @xmath974 .",
    "more precisely , we let @xmath980 for all the vertices @xmath479 which are not in the boundary of some square of @xmath921 or @xmath922 . instead",
    ", if a vertex @xmath686 belongs to the boundary of at least a square in @xmath921 or @xmath922 ( these two things can not happen simultaneously , thanks to step  ii ) , let us define @xmath981 as a translation of @xmath974 of @xmath982 , where the two choices of the sign @xmath983 are done in such a way that the whole interval is inside a square of @xmath921 or @xmath922 ; for instance , if @xmath479 is the lower - left corner of a square in @xmath921 ( or @xmath922 ) , we can set @xmath984 compare with  ( [ defi_eps ] ) .",
    "if @xmath479 is corner of more than one square in @xmath921 or @xmath922 , then we let @xmath981 be inside one of them arbitrarily , this will not make any difference .",
    "figure  [ fig : ieps ] shows an example of a portion of an @xmath77-set @xmath2 , where eight intervals @xmath981 are depicted and the shaded squares are those in @xmath921 ( or @xmath922 ) .",
    "notice that the intervals @xmath985 and @xmath986 could be inside each of the two shaded squares , in this example we have put the first interval inside the above square and the second interval in the below one .",
    "after a quick look at the proof of lemma  [ movegrid ] , it is evident that it works perfectly even with the intervals @xmath981 in place of the @xmath974 : indeed , in that simple proof we just used that the internal intervals are all of length @xmath987 , with direction at @xmath988 , and placed very close to the vertices . as a consequence , we obtain the points @xmath989 from lemma  [ selection ] , the modified grid @xmath787 from definition  [ defgrid ] , and the function @xmath990 from definition  [ defabo ] . the modified grid that we obtained now is the `` correct '' one , and we will use the function @xmath938 ( resp . ,",
    "@xmath991 ) around squares in @xmath922 ( resp . , @xmath992 and @xmath914 ) .",
    "the very same calculations of last step work also for this new case , just substituting the constant @xmath940 with @xmath887 . in particular , since this time @xmath979 for all the sides , the estimate  ( [ tul ] ) is true for every square in @xmath978 , so we can rewrite it ( with @xmath887 in place of @xmath940 ) as @xmath993    we are now in position to define a function @xmath994 on the grid @xmath787 introduced in step  iv .",
    "this function will behave almost correctly on the whole grid , its only fault ( which will be solved in next step ) being not to be piecewise linear .",
    "as we already observed , we would like to set @xmath995 on the boundary of any square @xmath996 , @xmath997 on the boundary of the squares in @xmath922 , and @xmath998 on the boundary of squares in @xmath992 or @xmath914 ; of course , this is impossible because the function @xmath994 would then not be continuous and injective . as a consequence , we use the above overall strategy to define @xmath994 , but with some _ ad hoc _ modification where squares of different types meet , so to get continuity and injectivity .",
    "let us start with the easy part of this definition .",
    "for every side @xmath82 which is in the boundary of some square of @xmath921 , we define @xmath994 on @xmath82 as the linear interpolation which satisfies @xmath999 and @xmath1000 : as a consequence , @xmath995 on @xmath387 for every @xmath1001 , where @xmath1002 is given by definition  [ defphi _ ] .",
    "second , for every side @xmath82 which is in the boundary of some square in @xmath922 , we let @xmath997 on @xmath82 : recall that vertices of squares in @xmath921 and vertices of squares in @xmath922 are disctinct by step  ii . finally , for every side @xmath82 such that",
    "neither @xmath78 nor @xmath79 are vertices of squares of @xmath921 or of @xmath922 , we let @xmath998 on @xmath1003 , where the points @xmath783 and @xmath784 are those given by step  iv .",
    "notice that , up to now , the function @xmath994 is continuous and injective : this comes as a straightforward consequence of the @xmath861 estimate around squares in @xmath921 , and of the fact that @xmath994 is a reparameterization of @xmath5 on different segments around squares in @xmath922 or @xmath978 .",
    "nevertheless , @xmath994 has still not been defined in the whole @xmath787 .",
    "let us then consider a side @xmath82 such that @xmath994 has not yet been defined on @xmath780 : by construction , this means that at least one between @xmath78 and @xmath79 is vertex of a square in @xmath921 or @xmath922 , thus in particular @xmath82 is not in the boundary of @xmath2 , and both the squares of the grid having @xmath82 in the boundary belong to @xmath978 .",
    "we aim now to define @xmath994 on @xmath780 .",
    "to do so , let us keep in mind that we would like to set @xmath998 , and observe also that @xmath991 , on @xmath780 , is nothing else than the reparametrization , at constant speed , of the image @xmath1004 of some piecewise linear curve @xmath1005 under @xmath5 .",
    "our idea is to define @xmath994 , on @xmath780 , again as the reparametrization at constant speed of some modification @xmath87 of @xmath1004 . in particular",
    ", @xmath87 and @xmath1004 will coincide in their big `` internal '' parts , the difference being only near the endpoints of these curves .    for simplicity ,",
    "let us start assuming that @xmath78 is not vertex of squares in @xmath921 or @xmath922 , and @xmath79 is vertex of at least a square in @xmath922 ( by construction and recalling step  ii , @xmath79 is then vertex of either one or two squares in @xmath922 , and of no square in @xmath921 ) . by step  iv , we know that the interval @xmath985 is entirely inside a square @xmath57 of @xmath922 which has @xmath79 as a vertex .",
    "as in figure  [ fig : hlp ] ( left ) , let us call @xmath1006 the vertex of @xmath57 such that there is a square having both @xmath78 and @xmath1007 as vertices .",
    "the function @xmath994 has already been defined , on @xmath1008 , as the reparametrization of the image of a segment @xmath1009 under @xmath5 ; by definition and by construction , the segment @xmath1009 and the curve @xmath1005 meet in some point @xmath186 near @xmath79 ; notice that @xmath1010 , and then the curve @xmath1005 is actually a segment , except possibly in a small neighborhood of @xmath1011 .",
    "we are now ready to define the curve @xmath87 : first , we define @xmath180 as the image , under @xmath5 , of the union between the part of @xmath1005 from @xmath1012 to @xmath186 and the segment @xmath1013 .",
    "then , since @xmath180 and @xmath1014 have of course a part in common , we let @xmath87 be a slight modification of @xmath180 which intersects @xmath1014 only at @xmath1015 . of course , we need to modify @xmath180 only between @xmath1016 and @xmath81 : this modification can be done as the enlargement of figure  [ fig : hlp ] ( right ) shows , and it works exactly as in step  10 of the proof of theorem  [ extension ] ; in particular , the length of @xmath87 is as close as we wish to the length of @xmath180 . by definition",
    ", we have @xmath1017 thanks to  ( [ benecosi ] ) , calling for a moment @xmath51 the matrix associated to @xmath57 , we know that @xmath1018 and then  ( [ hund0 ] ) becomes @xmath1019    let us now assume , instead , that @xmath78 is still not vertex of squares in @xmath921 or @xmath922 , and that @xmath79 is vertex of some square in @xmath921 .",
    "we can then define @xmath57 and @xmath1007 as before ; this time , @xmath994 in the segment @xmath1008 is not defined as the reparametrization of the image under @xmath5 of some segment @xmath1009 , but as the affine interpolation satisfying @xmath1000 and @xmath1020 .",
    "however , the @xmath861 estimate  ( [ lemmatoprove ] ) and the property  ( [ stp ] ) immediately imply that , exactly as before , the curve @xmath1004 intersects the image of @xmath1008 under @xmath994 ( which is the segment @xmath1021 ) .",
    "if we call @xmath188 the first point of intersection ( starting from @xmath1022 ) , we can argue exactly as before : we define @xmath87 as a slight modification of @xmath180 , which is this time the union of the curve @xmath1004 from @xmath1022 to @xmath188 with the segment @xmath1023 . in this case , instead of  ( [ hund0 ] )",
    "we get the estimate @xmath1024 and since by the @xmath861 estimate of lemma  [ genlemma ] we have of course @xmath1025 then also in this case we get the validity of  ( [ estihund ] ) : of course even the better estimate without the big term in parentheses is true , but it is simpler to consider the same estimate  ( [ estihund ] ) in both cases .",
    "let us finally consider the general case for the segment @xmath82 : both the points @xmath78 and @xmath79 can be vertices of some square in @xmath921 or in @xmath922 .",
    "nevertheless , as noticed above , in the cases already considered the path @xmath180 coincides with @xmath1004 from the starting point @xmath1011 to almost the final point @xmath1026 , and only a small part near the end has been modified .",
    "as a consequence , it is obvious how to deal with the case when both the points @xmath78 and @xmath79 are vertices of squares in @xmath921 or in @xmath922 : we let @xmath180 be the path which coincides in a large central part with @xmath1004 , and we apply one of the above described modifications both near the starting point , and near the endpoint .",
    "of course , for a side @xmath82 where we have done two modifications , instead of  ( [ estihund ] ) we will have @xmath1027 where as usual @xmath959 is the union of the squares having either @xmath78 or @xmath79 as a vertex , which contains both @xmath57 and the corresponding square around @xmath78 . in this way",
    ", we have finally defined @xmath994 in the whole grid @xmath779 , and by construction it is clear that the map @xmath994 is injective and coincides with @xmath5 on @xmath44 .",
    "we conclude this step by evaluating the integral of @xmath1028 on the boundary of the different squares : for any square @xmath57 of the grid , we call again @xmath960 the intersection with @xmath2 of the nine squares around @xmath57 .    if @xmath996 we do not need any particular estimate , in the next steps we will only need to use that @xmath994 coincides with @xmath1002 on @xmath114 . if @xmath1029 , instead , we know that @xmath994 coincides with @xmath938 on @xmath114 , hence we only need to keep in mind the estimate  ( [ benecosi ] ) already found in step  iii , which ( adding on the four sides of @xmath57 ) gives @xmath1030 finally , if @xmath1031",
    ", then @xmath1032 is the sum of the integrals on the four sides ; for each side @xmath780 , either @xmath998 , and then of course @xmath1033 or @xmath1034 for some curve @xmath1035 defined as above . since the length of @xmath87 can be taken as close as we wish to the length of @xmath180 , from  ( [ genhund ] ) we derive @xmath1036 since  ( [ goodcs ] ) is stronger than  ( [ badcs ] ) , we get the validity of  ( [ badcs ] ) for any side @xmath82 of any square @xmath1031 . as a consequence , adding  ( [ badcs ] ) on the four sides and keeping in mind  ( [ tul2 ] ) and the fact that @xmath1037 , we get @xmath1038    in this step , we want to define a piecewise linear function @xmath1039 : this one will finally be the correct map on the grid @xmath779 , in the sense that our approximating function @xmath34 will coincide with @xmath1040 on @xmath779 . to do so , it is enough to apply proposition  [ notgoodforgood ] to the map @xmath994 and call @xmath1041 the resulting map . as a consequence ,",
    "@xmath1040 is a piecewise linear map on @xmath779 , which coincides with @xmath5 on @xmath44 .",
    "moreover , since for every side @xmath82 of the grid the map @xmath1040 on @xmath780 is an interpolation of values of @xmath994 on @xmath780 , of course we still have @xmath1042 on the boundary of every square @xmath996 .",
    "moreover , ( [ check1 ] ) and  ( [ check2 ] ) imply that the estimates  ( [ finalina_2 ] ) and  ( [ finalina_3 ] ) are valid also with @xmath1040 in place of @xmath994 .",
    "we are almost at the end of the proof , since we can finally define the required function @xmath34 .",
    "we set @xmath1043 on the grid @xmath779 , hence in particular @xmath43 on @xmath44 ; by construction , @xmath34 is injective and piecewise linear on @xmath779 . to keep the injectivity , is then enough to extend @xmath34 in the interior of any square @xmath955 , in such a way that @xmath34 remains continuous and injective on it .",
    "we will argue differently on the different squares .    if @xmath996 , then we know that @xmath1044 on @xmath114 , so we extend @xmath1044 on the whole square @xmath57 : this map is continuous and injective by construction , and by  ( [ lemmatoprove ] ) of lemma  [ genlemma ] we know that @xmath1045 let us now consider a square @xmath1029 : in this case , we want to apply theorem  [ extension2 ] to the function @xmath1046 on @xmath114 . keeping in mind the generalization of theorem  [ extension2 ] observed in remark  [ ext2rem ] , and calling @xmath34",
    "the obtained extension on @xmath57 , we get @xmath1047 as soon as the estimate @xmath1048 holds .",
    "thanks to  ( [ finalina_2 ] ) , which holds also with @xmath1040 in place of @xmath994 as noticed in step  vi , and recalling that @xmath1049 by definition of @xmath922 and that @xmath1050 is a small purely geometric constant , the latter estimate is true thanks to  ( [ here345 ] ) . as a consequence , recalling that @xmath57 is a lebesgue square with matrix @xmath51 and constant @xmath903 , that @xmath1051 by  ( [ defhatdelta ] ) and by definition of @xmath646 , and using also that @xmath1052 , from  ( [ nes ] ) and  ( [ finalina_2 ] ) we get @xmath1053 where @xmath55 is as always a purely geometric constant .",
    "finally , let @xmath57 be a square in @xmath978 .",
    "this time , since @xmath1040 is piecewise linear on @xmath1054 and @xmath955 is ( a @xmath724-bilipschitz copy of ) a square of side @xmath74 , we let @xmath34 on @xmath955 be the extension of @xmath1040 given by theorem  [ extension ] , keeping in mind also the generalization of remark  [ ext1rem ] .",
    "the estimate  ( [ hopeext ] ) , together with  ( [ finalina_3 ] ) , which is valid also with @xmath1040 in place of @xmath994 by step  vi , gives then @xmath1055 since @xmath1056 since @xmath1052 , and since @xmath55 is a purely geometric constant while @xmath1057 , we deduce @xmath1058 notice that the same estimate holds true also for @xmath1059 ; nevertheless , in this case we can say even something more . indeed , since @xmath57 is a lebesgue square with matrix @xmath70 , by definition  [ lebsquare ] we know @xmath1060 as a consequence , for squares in @xmath992 we can deduce from  ( [ truea3 ] ) @xmath1061    we are now ready to conclude .",
    "indeed , by construction @xmath34 is a finitely piecewise affine homeomorphism which coincides with @xmath5 on @xmath44 .",
    "moreover , it is immediate by construction that @xmath1062 and @xmath1063 are as small as we wish ( it is enough to have chosen at the beginning @xmath77 small enough ) ; as a consequence , we can assume that they are smaller than @xmath1064 each . as a consequence ,",
    "to get  ( [ thesis1 ] ) and conclude , we only have to check that @xmath1065 thanks to  ( [ truea1 ] ) , ( [ truea2 ] ) , ( [ truea3 ] ) and  ( [ truea33 ] ) , and calling , for @xmath1066 , @xmath1067 we have @xmath1068 let us now recall that , for each square @xmath720 of the grid , the set @xmath1069 is the union of the nine squares around it ( to be precise , to those which belong to @xmath2 ) . as a consequence , calling for brevity @xmath1070 , also recalling  ( [ smalleps2 ] ) we have @xmath1071 .",
    "thus , by  ( [ defeps2 ] ) we can write @xmath1072 analogously , each side in @xmath44 can belong to @xmath1073 for at most eleven different indices @xmath145 with @xmath1074 , hence by  ( [ secondbad ] ) we get @xmath1075 finally , by  ( [ here345 ] ) we have @xmath1076 inserting the last three estimates inside  ( [ finhere ] ) we get  ( [ nohere ] ) , so the proof is concluded .",
    "the above proposition shows that , under stronger assumptions than in theorem  [ main ] , we can obtain something better than what claimed in theorem  [ main ] .",
    "indeed , if @xmath2 is an @xmath77-set and @xmath5 is piecewise linear on @xmath44 , then we do not only get simply a _",
    "countably _ piecewise affine approximation , but a much better _ finitely _ piecewise affine one .",
    "we can now give the sharpest possible result of this approximation , that is , we can prove the existence of a finitely piecewise affine approximation with the weakest possible assumptions .",
    "[ main2 ] let @xmath0 be a polygon and let @xmath1 be a homeomorphism , continuous up to the boundary and such that @xmath5 is piecewise linear on @xmath44 .",
    "then , for every @xmath40 there exists a finitely piecewise affine homeomorphism @xmath882 such that @xmath42 , and @xmath43 on @xmath44 .",
    "since @xmath2 is a polygon , there exists an @xmath77-set @xmath1077 and a finitely piecewise affine homeomorphism @xmath1078 .",
    "there exists then some constant @xmath1079 such that @xmath1080 for almost every @xmath909 .",
    "let us then define @xmath1081 as @xmath1082 ; by construction , @xmath1083 belongs to @xmath1084 , and it is continuous up to @xmath1085 and piecewise linear there . as a consequence , we can apply proposition  [ allhere ] to @xmath1083 in @xmath1077 , finding a finitely piecewise affine homeomorphism @xmath1086 which coincides with @xmath1083 on @xmath1087 and such that @xmath1088 we can then define @xmath1089 : this is a finitely piecewise affine homeomorphism , of course it coincides with @xmath56 on @xmath1090 , and we have @xmath1091 by a simple change of variable argument , we obtain then @xmath1092 and similarly @xmath1093 inserting the last three estimates in  ( [ estinrset ] ) , we conclude that @xmath34 is the desired approximation .",
    "[ remmain2 ] it is immediate to observe that the assumption of theorem  [ main2 ] are sharp .",
    "indeed , assume that a homeomorphism @xmath1 admits a finitely piecewise affine approximation @xmath34 .",
    "since @xmath34 is finitely piecewise affine , it is defined on a polygon , hence @xmath2 must be a polygon .",
    "similarly , @xmath34 is piecewise linear on @xmath44 by definition , and since @xmath43 on @xmath44 the same must be true for @xmath5 .",
    "we will argue in a way quite similar to proposition  [ allhere ] , we only need some additional care to reach the boundary of @xmath2 .",
    "first of all , we look for a piecewise affine approximation , the smooth one will be found at the end .",
    "we again start by selecting the small constants @xmath885 : first of all , we let @xmath887 be a small geometric constant , say @xmath888 . then , since @xmath891 , we can select a constant @xmath897 such that @xmath1094 the next step is to write @xmath2 as a countable union of @xmath1095-sets .",
    "more precisely , we can take a sequence of constants @xmath1096 and a sequence of disjoint open sets @xmath1097 , in such a way that each @xmath1098 is an @xmath1095-set , the union of the closures @xmath1099 is the whole @xmath2 , and for each @xmath1100 we can divide the boundary of @xmath1098 in two disjoint parts @xmath1101 , being @xmath1102 since @xmath891 , we can select these sequences in such a way that @xmath1103 and we can also take @xmath1104 large enough so that that @xmath1105 naively speaking , the idea now is to try to work on each set @xmath1098 separately .",
    "however , since @xmath5 is not necessarily piecewise linear on the boundaries of the sets @xmath1098 , we can not simply rely on proposition  [ allhere ] for each @xmath1098 ; moreover , since @xmath2 has not necessarily finite area , estimates like  ( [ truea1 ] ) or  ( [ truea2 ] ) , where the area of a square appears , are not acceptable because they could give an infinite contribution after adding .",
    "let us now concentrate on @xmath1104 in order to select the constants @xmath1106 and @xmath904 : indeed , we will use these constants only inside @xmath1104 . arguing exactly as in the proof of proposition  [ allhere ] , we first let @xmath896 be a constant such that @xmath1107 then we let again @xmath898 then we let @xmath1108 be such that @xmath1109 and finally we let @xmath901 be given by @xmath1110 where @xmath646 are the constants of lemma  [ genlemma ] .",
    "the last thing we have to fix , is the final value of the constants @xmath1095 : indeed , each @xmath1098 is an @xmath1095-set , but then it can be regarded as a @xmath1111-set for every constants @xmath1112 . as a consequence , we can now decrease the values of @xmath1095 ( without changing the sets @xmath1098 , of course ) ; in particular , also thanks to  ( [ noinfper ] ) , we can assume that @xmath1113 is so small that @xmath1114 being @xmath1115 the constants of lemma  [ 4.6 ] , while any other @xmath1095 is so small that @xmath1116 notice that the last requirement basically means that the `` thickness '' of any @xmath1098 is of several squares .",
    "having fixed the sets @xmath1098 and the corresponding @xmath1095 , any @xmath1098 is divided in a finite union of squares , all with side @xmath1117 .",
    "let us enumerate them by saying that the squares of the grid of @xmath1098 are @xmath1118 with @xmath1119 ; then , we subdivide the squares of @xmath1104 in four groups , namely , @xmath1120 , as follows , @xmath1121 we immediately record that , exactly as in step  i of the proof of proposition  [ allhere ] , from  ( [ vve-2.5 ] ) and  ( [ vve-2.8 ] ) it follows that @xmath1122      let us notice that the only assumption which is true for @xmath2 in proposition  [ allhere ] and may fail now for the generic @xmath1098 is the following one : @xmath5 is assumed to be piecewise linear on @xmath44 in proposition  [ allhere ] , while @xmath5 needs now not to be piecewise linear on the boundaries @xmath1128 ; on the other hand , this assumption has been used only in step  vi of the proof of proposition  [ allhere ] . as a consequence , we can repeat _ verbatim _ all the arguments of steps  ii , iii , iv and  v of that proof for @xmath1104 : so , we discovery first that squares in @xmath1129 and @xmath1130 can never touch , then we define a temptative modified grid @xmath1131 with a function @xmath1132 , then the correct modified grid @xmath1133 with the function @xmath1134 , and finally the function @xmath1135 . by definition ,",
    "the function @xmath1136 is injective and coincides with @xmath5 on @xmath1137 ( this was explicitely decided in definition  [ defabo ] ) , and moreover we have the estimates @xmath1138 where @xmath55 is a purely geometric constant ( it suffices to take @xmath1139 here ) .",
    "let us now consider @xmath1098 for any @xmath1123 . in this case",
    ", the situation is much simpler than in proposition  [ allhere ] : indeed , by definition we only have squares in @xmath1140 , so we do not need the arguments of steps  ii and  iii and we can directly start with the analogous of step  iv , which immediately gives us a function @xmath1141 satisfying the analogous of  ( [ tul2 ] ) , that is , @xmath1142 again since there are no squares in @xmath1125 , @xmath1126 and @xmath1127 , we do not even need the argument of step  v , and we can simply set the function @xmath1143 .",
    "let us now observe that every function @xmath1144 coincides with @xmath5 , by construction and by definition  [ defabo ] , on @xmath1128 . as a consequence , if we call @xmath779 the union of all the grids @xmath1145 and we set @xmath1146 as @xmath1147 on each @xmath1145 , then the resulting function @xmath994 is also injective .",
    "the last thing we have to do , before having the right of treating each @xmath1098 separately , is to modify @xmath994 so to become piecewise linear on the boundary of each @xmath1098 ; we will do that by applying proposition  [ goodforstarting ] .",
    "more precisely , for every @xmath1148 we define @xmath1149 the union of all the segments of @xmath1150 and @xmath1151 , and @xmath1152 .",
    "we apply then proposition  [ goodforstarting ] with @xmath1153 , @xmath1154 , @xmath1155 , and with the function @xmath1156 ; thus , we get a function @xmath1157 , piecewise linear on @xmath1158 , which coincides with @xmath56 ( hence , with @xmath994 ) out of a @xmath515-neighborhood of @xmath1158 . as a consequence ,",
    "the function @xmath1157 is different from @xmath994 only on the boundary of squares which meet @xmath1158 .",
    "then , let us define the function @xmath1159 as @xmath1160 on the boundary of squares touching @xmath1158 , and @xmath1161 on the boundaries of all the other squares . by construction and by proposition  [ goodforstarting ] ,",
    "the function @xmath1162 is injective , piecewise linear on each @xmath1163 , and the estimates  ( [ reallyend ] ) and  ( [ reallyend2 ] ) are valid with @xmath1162 in place of @xmath994 .",
    "now , for every @xmath1100 we apply proposition  [ notgoodforgood ] to the set @xmath1098 with the function @xmath1162 on @xmath1164 , and we get a new function @xmath1165 , piecewise linear on @xmath1145 and coinciding with @xmath1162 on @xmath1128 .",
    "finally , we define @xmath1166 as @xmath1167 on every @xmath1145 : also this function satisfies  ( [ reallyend ] ) and  ( [ reallyend2 ] ) , and it is piecewise linear on the boundary of each square of any grid .",
    "we are now ready to define the piecewise affine approximation @xmath34 : indeed , for every @xmath1100 , the function @xmath1040 on @xmath1164 is injective and piecewise linear on the boundary .",
    "exactly as in step  vii of the proof of proposition  [ allhere ] , we can then define @xmath1168 on @xmath1098 , which is a finitely piecewise affine function coinciding with @xmath1040 on @xmath1128 , and then set @xmath882 as the function which coincides with @xmath1168 on every @xmath1098 .",
    "this function @xmath34 is by construction a countably piecewise affine homeomorphism , and also locally finitely piecewise affine ; moreover , it is clear that @xmath1169 and @xmath1170 are as small as we wish as soon as the constants @xmath1095 have been chosen small enough : in particular , we can think that both them are smaller than @xmath1064 , and moreover we get the fact that @xmath43 on @xmath44 whenever @xmath5 is continuous up to @xmath44 . as a consequence , to conclude the proof of theorem  [ main ] for what concerns the piecewise affine approximation , we just have to check that @xmath1171 this will be obtained arguing almost exactly as in steps  vii and  viii of the proof of proposition  [ allhere ] .",
    "more precisely , let us start with @xmath1104 : repeating _ verbatim _ the arguments bringing to  ( [ truea1 ] ) , ( [ truea2 ] ) , ( [ truea3 ] ) and  ( [ truea33 ] ) , this time from  ( [ reallyend ] ) we get @xmath1172 \\bal\\int_\\s |df_\\eps - df| \\leq kr_1 ^ 2 \\bigg(\\frac{\\eps_5}{\\eps_4}+\\frac{\\eps_4}{\\eps_3}\\bigg)\\eal & \\forall \\s\\in\\a^1_2\\,,\\\\ \\bal\\int_{\\widetilde\\s } |df_\\eps - df| \\leq kr_1\\int_{\\partial\\s^+\\cap\\partial\\omega_1 } |df|\\ , d\\h^1 + k\\bigg(\\frac{\\eps_5}{\\eps_4}+\\frac{\\eps_4}{\\eps_3}+\\frac{\\eps_5}{\\eps_1}\\bigg)r_1 ^ 2 \\eal & \\forall\\ , \\s\\in\\a^1_3\\,,\\\\ \\bal\\int_{\\widetilde\\s } |df_\\eps - df| \\leq \\frac k{\\eps_1 } \\int_{\\s^+ } |df| + kr_1\\int_{\\partial\\s^+\\cap\\partial\\omega_1 } |df|\\ , d\\h^1 + k\\bigg(\\frac{\\eps_5}{\\eps_4}+\\frac{\\eps_4}{\\eps_3}\\bigg)r_1 ^ 2 \\eal & \\forall\\ , \\s\\in\\a^1_4\\ , .",
    "\\end{array}\\ ] ] instead , for every @xmath1123 , we apply theorem  [ extension ] recalling also remark  [ ext1rem] to the generic @xmath955 , which is a @xmath724-bilipschitz copy of a square of side @xmath74 : then , also from  ( [ reallyend2 ] ) , we get @xmath1173 notice that this estimate is better than the corresponding one for proposition  [ allhere ] , namely , ( [ truea3 ] ) : indeed , there we had also the additional term @xmath1174 , which now would be quite a problem since in principle @xmath2 may have infinite area .",
    "the reason why we do not have this term now , is that it was coming from the interaction between squares in @xmath914 touching squares in @xmath921 or @xmath922 , while now in @xmath1098 we only have squares in @xmath1124 .",
    "the very same argument as in proposition  [ allhere ] implies again that every square can belong to @xmath960 at most for @xmath1175 different squares @xmath57 , and that every side of some @xmath1128 can belong to @xmath1176 at most for @xmath1177 different squares of the grid of @xmath1098 ; as a consequence , adding  ( [ vve1 ] ) and  ( [ vve2 ] ) for all the squares of the different grid , we find @xmath1178 where @xmath1179 is the union of the sets @xmath960 for all the squares @xmath1180 , so that by  ( [ vve-3 ] ) we have @xmath1181 , and where we have used  ( [ vve-1 ] ) , ( [ vve-2 ] ) , ( [ vve-4 ] ) and  ( [ vve-5 ] ) . as a consequence , we have established the validity of  ( [ isthisthelast ] ) , so the proof of the existence of the required piecewise affine approximation is concluded .    as already remarked , once the piecewise affine approximation is found ,",
    "the existence of the required approximating diffeomorphisms is exactly the content of  ( * ? ? ?",
    "* theorem  a ) , so we have finished our proof .",
    "part of this research was done when the first author was visiting university of erlangen , and while the second author was visiting charles university .",
    "they wish to thank both departments for hospitality .",
    "both authors were supported through the erc cz grant ll1203 of the czech ministry of education and the erc st.g .",
    "anoptsetcon of the european community ."
  ],
  "abstract_text": [
    "<S> let @xmath0 be a domain and let @xmath1 be a homeomorphism ( between @xmath2 and @xmath3 ) . </S>",
    "<S> then there exists a sequence of smooth diffeomorphisms @xmath4 converging to @xmath5 in @xmath6 and uniformly . </S>"
  ]
}