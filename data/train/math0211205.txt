{
  "article_text": [
    "let @xmath5=\\{1,2,\\ldots , n\\}$ ] and @xmath6 denote the set of all permutations of @xmath5 $ ] .",
    "we shall view permutations in @xmath6 as words with @xmath0 distinct letters in @xmath5 $ ] .",
    "a pattern is a permutation @xmath7 , and an occurrence of @xmath8 in a permutation @xmath9 is a subsequence of @xmath10 that is order equivalent to @xmath8 .",
    "for example , an occurrence of @xmath2 is a subsequence @xmath11 ( @xmath12 ) of @xmath10 such that @xmath13 .",
    "we denote by @xmath14 the number of occurrences of @xmath15 in @xmath10 , and we denote by @xmath16 the number of permutations @xmath17 such that @xmath18 .    in the last decade",
    "much attention has been paid to the problem of finding the numbers @xmath16 for a fixed @xmath19 and a given pattern @xmath15 ( see @xcite ) .",
    "most of the authors consider only the case @xmath20 , thus studying permutations _ avoiding _ a given pattern .",
    "only a few papers consider the case @xmath21 , usually restricting themselves to patterns of length @xmath22 . using two simple involutions ( _ reverse _ and _ complement _ ) on @xmath6 it is immediate that with respect to being equidistributed , the six patterns of length three fall into the two classes @xmath23 and @xmath24 .",
    "noonan @xcite proved that @xmath25 a general approach to the problem was suggested by noonan and zeilberger @xcite ; they gave another proof of noonan s result , and conjectured that @xmath26 and @xmath27 the first conjecture was proved by fulmek @xcite and the latter conjecture was proved by bna in @xcite .",
    "a conjecture of noonan and zeilberger states that @xmath16 is @xmath28-recursive in @xmath0 for any @xmath3 and @xmath15 .",
    "it was proved by bna @xcite for @xmath29 .",
    "mansour and vainshtein @xcite suggested a new approach to this problem in the case @xmath29 , which allows one to get an explicit expression for @xmath30 for any given @xmath3 .",
    "more precisely , they presented an algorithm that computes the generating function @xmath31 for any @xmath32 . to get the result for a given @xmath3 , the algorithm performs certain routine checks for each element of the symmetric group @xmath33 .",
    "the algorithm has been implemented in c , and yields explicit results for @xmath34 .",
    "let @xmath10 be any permutation .",
    "the number of _ inversions _ of @xmath10 is given by @xmath35 .",
    "the _ signature _ of @xmath10 is given by @xmath36 .",
    "we say @xmath10 is an _ even permutation _ [ respectively ; _ odd permutation _ ] if @xmath37 [ respectively ; @xmath38 .",
    "we denote by @xmath39 [ respectively ; @xmath40 the set of all even [ respectively ; odd ] permutations in @xmath6 . clearly , @xmath41 for all @xmath42 .",
    "the following lemma holds immediately by definitions .",
    "[ slem1 ] for any permutation @xmath10 , @xmath43 .",
    "we denote by @xmath44 [ respectively ; @xmath45 the number of even [ respectively ; odd ] permutations @xmath46 [ respectively ; @xmath47 such that @xmath18 .    apparently , for the first time the relation between even ( odd ) permutations and pattern avoidance problem",
    "was suggested by simion and schmidet in @xcite for @xmath48 . in particularly , simion and schmidt @xcite proved that @xmath49    in this paper , as a consequence of @xcite , we suggest a new approach to this problem in the case of even ( or odd ) permutations where @xmath29 , which allows one to get an explicit expression for @xmath50 for any given @xmath3 . more precisely , we present an algorithm that computes the generating functions @xmath51 and @xmath52 for any @xmath32 . to get the result for a given @xmath3 , the algorithm performs certain routine checks for each element of the symmetric group @xmath33 . the algorithm has been implemented in c , and yields explicit results for @xmath53 .",
    "to any @xmath17 we assign a bipartite graph @xmath54 in the following way .",
    "the vertices in one part of @xmath54 , denoted @xmath55 , are the entries of @xmath10 , and the vertices of the second part , denoted @xmath56 , are the occurrences of @xmath2 in @xmath10 .",
    "entry @xmath57 is connected by an edge to occurrence @xmath58 if @xmath59 enters @xmath60 .",
    "for example , let @xmath61 , then @xmath10 contains @xmath62 occurrences of @xmath2 , and the graph @xmath54 is presented on figure  [ graph ] .",
    "= 2.5 in    we denote by @xmath63 the connected component of @xmath54 containing entry @xmath0 .",
    "let @xmath64 be the entries of @xmath10 belonging to @xmath63 , and let @xmath65 be the corresponding permutation .",
    "we say that @xmath64 is the _ kernel _ of @xmath10 and denote it @xmath66 , @xmath8 is called the _ shape _ of the kernel , or the _ kernel shape _ , @xmath67 is called the _ size _ of the kernel , and the number of occurrences of @xmath2 in @xmath66 is called the _ capacity _ of the kernel . for example , for @xmath61 as above , the kernel equals @xmath68 , its shape is @xmath69 , the size equals @xmath62 , and the capacity equals @xmath70 .",
    "[ mvth1 ] ( mansour and vainshtein  ( * ? ? ? * theorem  1 ) ) let @xmath17 such that @xmath71 , then the size of the kernel of @xmath10 is at most @xmath72 .",
    "we say that @xmath73 is a _ kernel permutation _ if it is the kernel shape for some permutation @xmath10 . evidently @xmath73 is a kernel permutation if and only if @xmath74 .",
    "let @xmath75 be an arbitrary kernel permutation .",
    "we denote by @xmath76 the set of all the permutations of all possible sizes whose kernel shape equals @xmath73 . for any @xmath77",
    "we define the _ kernel cell decomposition _ as follows .",
    "the number of cells in the decomposition equals @xmath78 .",
    "let @xmath79 ; the _ cell _ @xmath80 for @xmath81 and @xmath82 is defined by @xmath83 where @xmath84 , @xmath85 , and @xmath86 for any @xmath10 .",
    "if @xmath10 coincides with @xmath73 itself , then all the cells in the decomposition are empty .",
    "an arbitrary permutation in @xmath76 is obtained by filling in some of the cells in the cell decomposition .",
    "a cell @xmath87 is called _ infeasible _ if the existence of an entry @xmath88 would imply an occurrence of @xmath2 that contains @xmath89 and two other entries @xmath90 .",
    "clearly , all infeasible cells are empty for any @xmath77 .",
    "all the remaining cells are called _ feasible _ ; a feasible cell may , or may not , be empty . consider the permutation @xmath91 .",
    "the kernel of @xmath10 equals @xmath92 , its shape is @xmath93 .",
    "the cell decomposition of @xmath10 contains four feasible cells : @xmath94 , @xmath95 , @xmath96 , and @xmath97 ( see figure  [ cell ] ) .",
    "all the other cells are infeasible ; for example , @xmath98 is infeasible , since if @xmath99 , then @xmath100 is an occurrence of @xmath2 for any @xmath101 whose kernel is of shape @xmath93 .",
    "= 2.5 in    as another example , permutation @xmath102 belongs to the same class @xmath103 .",
    "its kernel is @xmath104 , and the feasible cells are @xmath105 , @xmath106 , @xmath107 , @xmath108 .",
    "given a cell @xmath109 in the kernel cell decomposition , all the kernel entries can be positioned with respect to @xmath109 .",
    "we say that @xmath110 lies _ below _",
    "@xmath109 if @xmath111 , and _ above _",
    "@xmath109 if @xmath112 . similarly , @xmath113 lies to the _ left _ of @xmath109 if @xmath114 , and to the _ right _ of @xmath109 if @xmath115 . as usual",
    ", we say that @xmath113 lies to the _ southwest _ of @xmath109 if it lies below @xmath109 and to the left of it ; the other three directions , northwest , southeast , and northeast , are defined similarly .",
    "let us define a partial order @xmath116 on the set of all feasible cells by saying that @xmath117 if @xmath118 and @xmath119 .    [ mvlem2 ] ( mansour and vainshtein  @xcite )",
    "\\(i ) @xmath116 is a linear order .",
    "\\(ii ) let @xmath120 and @xmath121 be two nonempty feasibly cells such that @xmath122 . then for any pair of entries @xmath123 , @xmath124 , one has @xmath125 .",
    "\\(iii ) let @xmath120 and @xmath126 be two nonempty feasibly cells such that @xmath127 .",
    "then any entry @xmath128 lies to the right of any entry @xmath129 .",
    "let @xmath10 be any permutation with a kernel permutation @xmath73 , and assume that the feasible cells of the kernel cell decomposition associated with @xmath73 are ordered linearly according to @xmath116 , @xmath130 . let @xmath131 be the size of @xmath132 .",
    "for example , let @xmath91 with kernel permutation @xmath133 , as on figure  [ cell ] , then @xmath134 , @xmath135 , @xmath136 , and @xmath137 . + we denote by @xmath138 the number of the entries of @xmath73 that lie to the north - west from @xmath132 or lie to the south - east from @xmath132 .",
    "for example , let @xmath133 , as on figure  [ cell ] , then @xmath139 , @xmath140 , @xmath141 , and @xmath142 . clearly , @xmath143 and @xmath144 for any nonempty kernel permutation @xmath73 .    [ alem1 ] for any permutation @xmath10 with a kernel permutation @xmath73 , @xmath145    to verify this formula , let us count the number of occurrences of the pattern @xmath146 in @xmath10 .",
    "there four possibilities for an occurrence of @xmath146 in @xmath10 .",
    "the first possibility is an occurrence occurs in one of the cells @xmath132 , so in this case there are @xmath147 occurrences .",
    "the second possibility is an occurrence occurs in @xmath73 , so there are @xmath148 occurrences .",
    "the third possibility is an occurrence of two elements which the first belongs to @xmath73 and the second belongs to @xmath149 , so there are @xmath150 ( see theorem  [ mvlem2 ] ) occurrences .",
    "the fourth possibility is an occurrence of two elements which the first belongs to @xmath149 and the second belongs to @xmath132 where @xmath151 ( theorem  [ mvlem2 ] yields every entry of @xmath149 is greater than every entry of @xmath132 for all @xmath151 ) , so there are @xmath152 occurrences .",
    "therefore , by lemma  [ slem1 ] we have @xmath153 equivalently , @xmath154 .",
    "we say the vector @xmath155 is a _ binary vector _ if @xmath156 for all @xmath59 , @xmath157 .",
    "we denote the set of all binary vectors of length @xmath0 by @xmath158 . for any @xmath159",
    ", we define @xmath160 . for example , @xmath161 and @xmath162 .",
    "let @xmath73 be any kernel permutations , we denote by @xmath163 [ respectively ; @xmath164 the set of all the binary vectors @xmath165 such that @xmath166 [ respectively ; @xmath167 .",
    "for any @xmath165 , we define @xmath168 let @xmath73 be any kernel permutations and @xmath169 , we denote by @xmath170 the set of all permutations of all sizes with kernel permutation @xmath73 such that the corresponding cells @xmath132 satisfy @xmath171 , in such a context @xmath172 is called a _ length argument vector _ of @xmath73 . by definitions ,",
    "the following result holds immediately .",
    "[ alem2 ] for any kernel permutation @xmath73 , @xmath173    let @xmath73 be any kernel permutations and let @xmath174 , @xmath175 , we denote by @xmath176 the set of all permutations in @xmath170 such that the corresponding cells @xmath132 satisfy @xmath177 if and only if @xmath178 , in such a context @xmath179 is called a _ signature argument vector _ of @xmath73 . by lemma  [ alem2 ] , the following result holds immediately .",
    "[ alem3 ] for any kernel permutation @xmath73 , @xmath180    for any @xmath181 we define @xmath182 by definitions , the following result holds immediately .",
    "[ alem4 ] let @xmath181 .",
    "the generating function for all permutations @xmath10 such that @xmath71 , @xmath183 , and @xmath184 is given by @xmath185 .",
    "the main result of this note can be formulated as follows .",
    "denote by @xmath186 the set of all kernel permutations , and by @xmath187 the set of all kernel shapes for permutations in @xmath188 .",
    "let @xmath73 be any kernel permutation , for any @xmath181 and any @xmath189 we define @xmath190    [ thm ] let @xmath191 .",
    "for any @xmath181 , @xmath192    let us fix a kernel permutation @xmath193 , a length argument vector @xmath194 , and a signature argument vector @xmath195 .",
    "recall that the kernel @xmath73 of any @xmath10 contains exactly @xmath196 occurrences of @xmath2 .",
    "the remaining @xmath197 occurrences of @xmath2 are distributed between the feasible cells of the kernel cell decomposition of @xmath10 . by theorem  [ mvlem2 ] , each occurrence of @xmath2 belongs entirely to one feasible cell , and the occurrences of @xmath2 in different cells do not influence one another .",
    "let @xmath10 be any permutation such that @xmath71 , @xmath184 and @xmath183 together with a kernel permutations @xmath73 , length argument vector @xmath172 , and signature argument vector @xmath179 .",
    "then by lemma  [ alem3 ] , the cells @xmath132 satisfy the following conditions :    \\(1 ) @xmath198 if and only if @xmath131 is an even number ,    \\(2 ) @xmath178 if and only if @xmath177 ,    \\(3 ) @xmath199 , and    \\(4 ) @xmath200 .    therefore , by lemma  [ alem4 ] this contribution gives @xmath201 hence by lemma  [ alem3 ] and ( * ? ? ?",
    "* theorem  1 ) , if summing over all the kernel permutations @xmath193 , length argument vectors @xmath202 , and signature argument vectors @xmath203 then we get the desired result .",
    "theorem  [ thm ] provides a finite algorithm for finding @xmath204 and @xmath205 for any given @xmath1 , since we have to consider all permutations in @xmath206 , and to perform certain routine operations with all shapes found so far .",
    "moreover , the amount of search can be decreased substantially due to the following proposition .",
    "[ pro1 ] the only kernel permutation of capacity @xmath207 and size @xmath72 is @xmath208 its parameters are given by @xmath209 , @xmath210 , @xmath211 , @xmath212 , and @xmath213 .",
    "the first part of the proposition holds by ( * ? ? ?",
    "* prorposition ) . besides , by using the form of @xmath73 we get @xmath209 , @xmath210 , @xmath211 ; @xmath212 , and @xmath214 for all @xmath215 and @xmath216",
    ". therefore , @xmath213 .    by this proposition",
    ", it suffices to search only permutations in @xmath33 .",
    "below we present several explicit calculations .",
    "let us start from the case @xmath20 .",
    "observe that theorem  [ thm ] remains valid for @xmath20 , provided the left hand side of equation  [ meq ] for @xmath217 is replaced by @xmath218 ; subtracting @xmath219 here accounts for the empty permutation .",
    "so , we begin with finding kernel shapes for all permutations in @xmath220 .",
    "the only shape obtained is @xmath221 , and it is easy to see that @xmath222 , @xmath223 , @xmath224 , @xmath225 and @xmath226 therefore , equation  [ meq ] for @xmath217 gives @xmath227 ( equation  [ meq ] for @xmath228 and @xmath229 gives @xmath230 equation  [ meq ] for @xmath231 and @xmath232 gives @xmath233 and equation  [ meq ] for @xmath234 gives @xmath235 out present aim to find explicitly @xmath236 and @xmath237 , thus we need the following notation .",
    "we define @xmath238 for all @xmath32 . clearly , @xmath239 for all @xmath32 . therefore , by subtracting ( respectively ; adding ) equation  [ ra3 ] and equation  [ ra1 ] , and by subtracting ( respectively ; adding ) equation  [ ra4 ] and equation  [ ra2 ] we get @xmath240 hence , @xmath241",
    "\\(i ) the generating function for the number of even permutations avoiding @xmath2 is given by ( see @xcite ) @xmath242 ( ii ) the generating function for the number of odd permutations avoiding @xmath2 is given by ( see @xcite ) @xmath243 ( iii ) the generating function for the number of permutations avoiding @xmath2 is given by ( see @xcite ) @xmath244      since permutations in @xmath246 do not exhibit kernel shapes distinct from @xmath247 , the only possible new shape is the exceptional one , @xmath248 .",
    "calculation of the parameters of @xmath249 gives @xmath250 , @xmath251 , @xmath252 , @xmath253 and @xmath254 therefore , by theorem  [ thm ] we have @xmath255 using the expression for @xmath256 ( see the case @xmath20 ) we get @xmath257 similarly , if considering the expressions for @xmath258 and @xmath259 we get @xmath260    \\(i ) the generating function for the number of even permutations containing @xmath2 exactly once is given by @xmath261",
    "\\(ii ) the generating function for the number of odd permutations containing @xmath2 exactly once is given by @xmath262    \\(iii ) the generating function for the number of permutations containing @xmath2 exactly once is given by ( see @xcite ) @xmath260      we have to check the kernel shapes of permutations in @xmath264 .",
    "exhaustive search adds four new shapes to the previous list ; these are @xmath265 , @xmath266 , @xmath93 , and @xmath267 ; besides , there is the exceptional @xmath268 .",
    "calculation of the parameters @xmath67 , @xmath269 , @xmath270 , @xmath271 , @xmath272 , @xmath273 is straightforward , and we get    \\(i ) the generating function for the number of even permutations containing @xmath2 exactly twice is given by @xmath274    \\(ii ) the generating function for the number of odd permutations containing @xmath2 exactly once is given by @xmath275    \\(iii ) the generating function for the number of permutations containing @xmath2 exactly twice is given by ( see @xcite ) @xmath276      let @xmath277 ; exhaustive search in @xmath278 , @xmath279 , @xmath280 , and @xmath281 reveals @xmath282 , @xmath283 , @xmath284 , and @xmath285 new nonexceptional kernel shapes , respectively , and we get    let @xmath277 , then @xmath286 where @xmath287    @xmath288 @xmath289 and @xmath290    moreover , for @xmath277 , @xmath291 and @xmath292",
    "first of all , let us simplify the expression @xmath293 where @xmath294 , @xmath295 for all @xmath60 .",
    "let us define an order on the set @xmath158 , we say the vector @xmath300 if there exists @xmath60 such that @xmath301 , and @xmath302 for all @xmath303 .",
    "we say the @xmath304 vectors @xmath305 of @xmath158 are satisfy the _ @xmath306-property _",
    "if @xmath307 and we say the @xmath304 vectors @xmath305 are satisfy the _",
    "c - property _ if the vectors @xmath308 are satisfy the @xmath306-property for all @xmath309 .",
    "for example , the vectors of @xmath310 are satisfy the c - property by @xmath311 first of all , let us prove by induction on @xmath0 that there exists an order of the vectors of @xmath158 with c - property , for all @xmath312",
    ". for @xmath313 the c - property holds with @xmath314 .",
    "suppose that there exists an order of the vector of @xmath315 with the c - property .",
    "let @xmath316 for all @xmath317 and @xmath318 for all @xmath317 . by definitions , @xmath319 and @xmath320 ,",
    "so the @xmath306-property holds for @xmath321 .",
    "hence , by induction on @xmath322 we get that there exists an order of the vector of @xmath158 with the c - property .",
    "now we are ready to prove the lemma . without loss of generality",
    "we can assume that @xmath323 ( which means @xmath228 ) ; otherwise it is enough to replace @xmath89 by @xmath324 .",
    "let @xmath325 all the vectors of @xmath158 with the c - property .",
    "using @xmath323 together with the c - property we get that @xmath326 and @xmath327 for all @xmath328 .",
    "therefore , for all @xmath328 , @xmath329 where @xmath330 for all @xmath331 , and @xmath332 . using the c - property for @xmath325 we get that the vectors @xmath333 are satisfy the c - property in @xmath334 . hence by induction on @xmath0 ( by definitions , the lemma holds for @xmath313 ) , we get that the expression equals to @xmath335 .        as a remark , the above theorem yields two equations ( for @xmath231 and @xmath228 ) that are linear on @xmath340 and @xmath341 .",
    "so , theorem  [ thba1 ] provides a finite algorithm for finding @xmath340 for any given @xmath1 , since we have to consider all permutations in @xmath206 , and to perform certain routine operations with all shapes found so far .",
    "moreover , the amount of search can be decreased substantially due to the following proposition which holds immediately by proposition  [ pro1 ] and theorem  [ thba1 ] ."
  ],
  "abstract_text": [
    "<S> we study the generating function for the number of even ( or odd ) permutations on @xmath0 letters containing exactly @xmath1 occurrences of @xmath2 . </S>",
    "<S> it is shown that finding this function for a given @xmath3 amounts to a routine check of all permutations in @xmath4 .    </S>",
    "<S> 2000 mathematics subject classification : primary 05a05 , 05a15 ; secondary 05c90 </S>"
  ]
}