{
  "article_text": [
    "the _ guarded fragment _ of first - order logic ( @xmath5 ) , defined through the relativisation of quantifiers by atomic formulas , was introduced by andrka , van benthem , and nmeti  @xcite , who proved that the satisfiability problem for @xmath6 is decidable .",
    "grdel  @xcite proved that every satisfiable guarded first - order sentence has a finite model , i.e. , that @xmath6 has the _ finite model property _",
    "( fmp ) . in the same paper ,",
    "grdel also proved that satisfiability of @xmath6-sentences is complete for @xmath7 , and @xmath8-complete for sentences involving relations of bounded arity .",
    "the guarded fragment has since been intensively studied and extended in various ways .",
    "for example , the _ clique guarded fragment @xmath9 _",
    "@xcite properly extends @xmath5but still enjoys the finite model property as shown by hodkinson  @xcite , see also  @xcite for a simpler proof .",
    "guardedness has emerged as a main new paradigm for decidability and other benign properties such as the fmp , and has applications in various areas of computer science . while the guarded fragment was originally introduced to embed and naturally extend propositional modal logics within first - order logic  @xcite , it has various applications and was more recently shown to be relevant to description logics  @xcite and to database theory  @xcite .",
    "fragments of @xmath5were recently studied for query answering in such contexts , see e.g.  @xcite .",
    "the main problems studied in the present paper are motivated by such applications .      in the present paper",
    "we study the problem of _ querying guarded theories _ using conjunctive queries or unions of conjunctive queries . a boolean conjunctive query ( @xmath10 ) @xmath0 consists of an existentially closed conjunction of atoms .",
    "a union of boolean conjunctive queries ( @xmath11 ) is a disjunction of a finite number of @xmath10 .",
    "if @xmath1 is a guarded sentence ( or , equivalently , a finite guarded theory ) , we say that a query @xmath0 evaluates to true against @xmath1 , iff @xmath12 . in this context , we consider the following non - trivial main questions .    [ [ finite - controllability . ] ] _ finite controllability . _",
    "+ + + + + + + + + + + + + + + + + + + + + + + + +    is it true that for each @xmath6-sentence @xmath1 and each @xmath11@xmath0 if all finite models of @xmath1 satisfy @xmath0 then the same is true also for all infinite models of @xmath1 , in symbols , that @xmath13 ?",
    "since the query @xmath0 may not be guarded , the finite model property of the guarded fragment is not sufficient to answer this question positively .",
    "rather , this question amounts to whether for each @xmath1 and @xmath0 as above , whenever @xmath2 is consistent , it also has a finite model .",
    "this is equivalent to the finite model property of the extended fragment @xmath14 of @xmath6 , where universally quantified boolean combinations of negative atoms can be conjoined to guarded sentences .",
    "the concept of finite controllability was introduced by rosati  @xcite . ) ; the definition given here is , however , better suited for the full guarded fragment . ]",
    "[ [ size - of - finite - models . ] ] _ size of finite models . _ + + + + + + + + + + + + + + + + + + + + + + + +    how can we bound the size of finite models ?",
    "in particular , in case @xmath15 , how can we bound the size of the smallest finite models @xmath16 of @xmath1 for which @xmath17 ? note that any recursive bound on the size of such models @xmath16 immediately yields the decidability of query answering . on the other hand ,",
    "if @xmath1 is consistent and @xmath3 , then the existence of a finite model @xmath16 such that @xmath18 follows trivially from the fmp of @xmath6 , because every model @xmath16 of @xmath1 is also a model of @xmath0 .",
    "however , little was known about the size of the smallest finite models of a satisfiable guarded sentence @xmath1 .",
    "grdel s finite - model construction in  @xcite , in case of unbounded arities , first transforms @xmath1 into a doubly exponentially sized structure , which is then input to a transformation according to herwig s theorem  @xcite , requiring a further exponential blow - up in the worst case .",
    "this suggests a triple - exponential upper bound .",
    "can we do better ?",
    "[ [ hypergraph - covers . ] ] _ hypergraph covers . _",
    "+ + + + + + + + + + + + + + + + + + + +    approaching the above problems on a slightly more abstract level we construct hypergraph covers satisfying certain acyclicity criteria , which we refer to as weakly @xmath19-acyclic covers ( see section  [ sec_covers ] ) .",
    "very informally , a hypergraph cover is a bisimilar companion @xmath20 of @xmath21 with a bisimulation induced by a homomorphic projection @xmath22 . and",
    "weak @xmath19-acyclicity implies that every subset of @xmath20 of size at most @xmath19 projects via @xmath23 into an acyclic ( not necessarily induced ) sub - hypergraph of @xmath21 .",
    "this notion is thus intimately related to the query answering problem and the existence of finite covers is a key to finite controllability .",
    "this problem has been previously studied by the third author , who in  @xcite gave a non - elementary construction of weakly @xmath19-acyclic hypergraph covers .    of further interest ,",
    "in particular in connection with finite controllability of query answering for the more general clique - guarded fragment , is the existence of hypergraph covers that are both conformal and weakly @xmath19-acyclic for a suitable @xmath19 .",
    "existence of conformal covers , with no regard to acycliciy constraints , was established in  @xcite ; their doubly exponential construction being the only known bound .",
    "is it possible to find better , possibly polynomial constructions of hypergraph covers with the above properties ?    [ [ decidability - and - complexity . ] ] _ decidability and complexity . _ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    is @xmath11-answering over guarded theories decidable , and if so , what is the complexity of deciding whether @xmath3 for a @xmath11@xmath0 and a guarded sentence @xmath1 ?    [ [ canonisation - and - capturing . ] ] _ canonisation and capturing . _",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + +    a further problem of independent interest , which can be solved on the basis of the methods developed for the above questions , is @xmath24canonisation  the problem of providing a unique representative for each guarded bisimulation equivalence class of structures , to be computed in @xmath24 from any given member of that class .",
    "this has implications for capturing the guarded bisimulation invariant fragment of @xmath24 in the sense of descriptive complexity . + we provide answers to all these questions . before summarising our results ,",
    "let us briefly explain how the above questions relate to database theory and description logic .      in the database area",
    ", _ query answering under integrity constraints _ plays an important role . in this context a relational database @xmath25 , consisting of a finite set ( conjunction ) of ground atoms",
    "is given , and a set @xmath26 of _ integrity constraints _ is specified on @xmath25 .",
    "the database @xmath25 does not necessarily satisfy @xmath26 , and may thus be `` incomplete '' .",
    "the problem of answering a @xmath10@xmath0 on @xmath25 under @xmath26 consists of determining whether @xmath27 , also written as @xmath28 .",
    "an important class of integrity constraints in this context are the so - called tuple - generating dependencies  @xcite . given a relational schema ( i.e. , signature ) @xmath29 , a",
    "_ tuple - generating dependency _ ( tgd ) @xmath30 over @xmath29 is a first - order formula of the form @xmath31 , where @xmath32 and @xmath33 @xmath34 are conjunctions of atoms over  @xmath29 , called the _",
    "body _ and the _ head _ of @xmath30 , respectively .",
    "it is well known that database query answering under tgd is undecidable , see  @xcite , even for very restricted cases  @xcite . for the relevant class of _",
    "guarded tgd _",
    "@xcite , however , query answering is decidable and actually 2exptime - complete  @xcite",
    ". a tgd @xmath30 is _ guarded _ ( gtgd ) if it has an atom in its body that contains all universally quantified variables of @xmath30 .",
    "for example , the sentence @xmath35 is a gtgd stating that if @xmath36 is a manager named @xmath19 belonging to and managing department @xmath25 , then there must be at least one employee @xmath37 having some name @xmath38 in department @xmath25 reporting to @xmath36 . in general , gtgd are , strictly speaking , not guarded sentences , because their heads may be unguarded .",
    "however , by using `` harmless '' auxiliary predicates and splitting up tgd heads into several rules , each set of gtgd can be rewritten into a guarded sentence that is ( for all relevant purposes ) equivalent to the original set .",
    "for instance , the above tgd can be rewritten into the following three guarded sentences @xmath39    the class of _ inclusion dependencies _",
    "( i d ) is a simple subclass of the class of gtgd .",
    "an i d has the logical form @xmath40 , where @xmath41 and @xmath42 are single atoms . in",
    "@xcite it was shown that query answering under i d is decidable and , more precisely , pspace - complete in the general case and np - complete for bounded arities .",
    "one very important problem was left open in  @xcite : the finite controllability of query answering in the presence of ids .",
    "given that in the database world attention is limited to _",
    "finite databases _ ,",
    "a boolean query that would be false in infinite models of @xmath43 only , would still be finitely satisfied by @xmath43 and should be answered positively .",
    "do such queries exist ?",
    "this problem was solved by rosati  @xcite , who , by using a finite model generation procedure called _ finite chase _ , showed that query answering in the presence of ids is finitely controllable .",
    "result is actually formulated as follows .",
    "[ prop_rosati ] for every finite set of facts @xmath25 and set @xmath44 of i d and for every @xmath19 there exists a finite structure @xmath45 extending @xmath25 and satisfying @xmath44 and such that for every boolean conjunctive query @xmath0 comprised of at most @xmath19 atoms @xmath46 iff @xmath47 .    _",
    "description logics _ are used for ontological reasoning in the semantic web and in other contexts .",
    "some description logics such as dl - lite@xmath48 and dl - lite@xmath49  @xcite are essentially based on ids , and are thus finitely controllable . the already mentioned class of gtgd and the yet more expressive class of _ weakly guarded tgd ( wgtgd ) _",
    "have been introduced and studied in  @xcite as powerful tools for data integration , data exchange  @xcite , and ontological reasoning .",
    "as shown in  @xcite , the class of gtgd augmented to also allow rules with the truth constant @xmath50 (= `` false '' ) as their head , generalizes the main dl - lite description logic families .",
    "the wgtgd class is yet more general , and captures , unlike the gtgd class , plain datalog .",
    "the finite controllability of gtd and wgtd theories , however , was left as an open problem .",
    "unfortunately , rosati s finite chase can not be directly applied to gtgd or to wgtgd .",
    "let us briefly sketch how finite controllability of query answering in the presence of gtgd and wgtgd follows from the finite controllability of query answering against @xmath5 , which is the main result of the present paper . for gtgd theories",
    "this is easy .",
    "as explained above , they can be rewritten as guarded sentences and can thus be considered a sub - fragment of @xmath5 .",
    "let us now turn our attention to wgtgd theories , and first give some intuition about how they are defined .",
    "roughly , for a tgd set @xmath26 , the set of all argument positions @xmath51 of all atoms of predicates of @xmath26 can be partitioned into sets @xmath52 and @xmath53 .",
    "@xmath52 are the so - called _ affected positions _",
    ", where , when the rules are executed over a database @xmath25 , skolem terms ( i.e. , new instance values of existentially quantified head - variables ) may need to be introduced , whereas @xmath54 are those argument positions , which never need to hold skolem terms ( see  @xcite for a more precise definition ) .",
    "a tgd set @xmath26 is _ weakly guarded _",
    "( i.e. , @xmath26 is a wgtgd set ) if each rule body has an atom ( a _ weak guard _ ) that covers all those body variables that only occur in affected positions .",
    "note that weakly guarded tgd sets are , in general , unguarded . however , each theory @xmath55 , where @xmath25 is a database and @xmath26 a wgtdg set can be replaced by an equivalent theory @xmath56 where @xmath57 is a gtgd set as follows : @xmath57 is obtained from @xmath26 by replacing each rule @xmath30 of @xmath26 by all possible instantiations of variables in unaffected positions in @xmath26 by constants from @xmath25 .",
    "it is easy to see that for each @xmath11@xmath0 , @xmath28 iff @xmath58 and , moreover , if @xmath59 , then for each model @xmath36 of @xmath25 and @xmath57 such that @xmath60 it also holds that @xmath61 .",
    "it follows that query answering under wgtgd theories is finitely controllable if query answering under gtgd theories is finitely controllable .",
    "thus , if we can establish that query answering under @xmath5theories is finitely controllable , then query answering under gtgd theories ( constituting a sub - fragment of @xmath5 ) is finitely controllable , and so is query answering under wgtgd theories .      @xmath62    [ [ finite - controllability.-1 ] ] _ finite controllability . _ + + + + + + + + + + + + + + + + + + + + + + + + +    that answering @xmath11against guarded sentences is finitely controllable was already implicit in the report  @xcite , although not formulated in this terminology .",
    "the finite models constructed in  @xcite are of non - elementary size and do not yield meaningful complexity results . the following central result of our paper , derived by a completely new proof , yields a much better size bound .",
    "[ thrm_fincontrol ] for every @xmath5sentence @xmath1 and every @xmath11@xmath0 , @xmath63 . more specifically , if @xmath64 is satisfiable then it has a model of size @xmath65 , where @xmath66 depends solely on the signature of @xmath1 .",
    "answering @xmath11against gtgd or wgtgd theories is finitely controllable .",
    "more refined estimates on the size of finite models are provided in section  [ sec_fmp ] . to obtain theorem  [ thrm_fincontrol ]",
    ", we establish new results on hypergraph covers , which are of independent  interest .",
    "[ [ hypergraph - covers.-1 ] ] _ hypergraph covers . _",
    "+ + + + + + + + + + + + + + + + + + + +    we relate finite controllability to the concept of hypergraph covers .",
    "hypergraph cover _ for a given hypergraph @xmath67 consists of a hypergraph @xmath68 together with a homomorphism @xmath69 that induces a hypergraph bisimulation between @xmath68 and @xmath67 .",
    "this notion naturally extends to relational structures @xmath70 on the basis of homomorphism - induced guarded bisimulations .",
    "the following main technical result is used to derive most other results ( for definitions of notions mentioned see section 2 ) .",
    "[ thrm_main ] given @xmath71 and a hypergraph @xmath67 , one can construct an @xmath19-conformal hypergraph @xmath72 constituting a weakly @xmath19-acyclic hypergraph cover of @xmath67 .",
    "moreover , @xmath73 and @xmath72 is conformal whenever @xmath74 , where @xmath75 is the width of @xmath67 and , for fixed @xmath75 and @xmath19 , @xmath72 can be computed in polynomial time from @xmath67 .",
    "the direct analogue for guarded covers of relational structures is immediate . in both settings we call @xmath72",
    "@xmath19-th rosati cover _ of @xmath67 .",
    "let us explain very informally the role of the rosati covers in establishing theorem  [ thrm_fincontrol ] . in an easy but key step (",
    "lemma  [ lemma_treeification ] in section  [ sec_prelim ] ) we first reduce a problem instance @xmath3 for a @xmath5-sentence @xmath1 and a @xmath11@xmath0 to the equivalent question of entailment @xmath76 , where @xmath77 is a disjunction of _ acyclic queries _ stemming from the original query @xmath0 . crucially ,",
    "being acyclic , @xmath77 can be equivalently reformulated as a @xmath5-sentence , ultimately reducing the initial query answering problem to the unsatisfiability of the @xmath5-sentence @xmath78 .",
    "it is more difficult to show that this reduction is also valid over finite models , i.e. , that @xmath79 .",
    "in particular , that given a finite @xmath80 , a finite model of @xmath64 can also be found .",
    "observe that the `` unravelling '' of @xmath67 yields a tree - like model @xmath81 of @xmath78 and an acyclic cover of @xmath67 .",
    "thus , by virtue of acyclicity , @xmath82 .",
    "however , @xmath81 is typically infinite .",
    "the challenge is to find a finite cover of @xmath67 retaining a `` sufficient degree of acyclicity '' so as not to render it a model of @xmath0 .",
    "this is captured by the notion of a weakly @xmath19-acyclic cover @xmath72 of @xmath67 , which ensures that , similarly to tree unravellings , @xmath83 implies @xmath84 , but with the qualification that @xmath85 .",
    "theorem  [ thrm_main ] shows that such covers can be constructed .",
    "[ [ conformal - covers . ] ] _ conformal covers . _",
    "+ + + + + + + + + + + + + + + + + + +    hodkinson and otto showed in  @xcite that all hypergraphs admit guarded bisimilar covers by conformal hypergraphs ( for definitions , see section  [ sec_prelim ] ) .",
    "while the construction in  @xcite involves a doubly exponential blow - up in size , we here obtain a polynomial construction of conformal covers as a corollary to theorem  [ thrm_main ] .",
    "[ coroll_conformal covers ] every hypergraph @xmath21 of width @xmath75 admits a conformal hypergraph cover of size @xmath86 . for bounded width",
    ", we thus obtain polynomial size conformal covers .    [",
    "[ finite - model - property - of - the - clique - guarded - fragment . ] ] _ finite model property of the clique - guarded fragment . _ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    as it happens , our construction used for theorem  [ thrm_fincontrol ] also yields an extension of theorem  [ thrm_fincontrol ] to the clique - guarded fragment , @xmath87 .",
    "[ thrm_fincontrol_cgf ] for every @xmath88 and every @xmath89 we have @xmath90 .",
    "more specifically , if @xmath91 is satisfiable then it has a finite model of size @xmath92 , where @xmath93 is the height of @xmath0 , @xmath94 is the signature of @xmath1 , and @xmath95 .    in particular",
    ", we obtain finite models of any satisfiable clique - guarded formula , and thereby a new proof of the finite model property of the clique - guarded fragment .",
    "in fact , our construction yields more compact finite models than hitherto known .    [ [ small - model - property . ] ] _ small model property . _",
    "+ + + + + + + + + + + + + + + + + + + + + + +    through our new method of finite - model construction , we are able to improve the bounds implicit in  @xcite for @xmath5and the overhead for @xmath87 implicit in  @xcite on the size of the smallest finite model of a satisfiable ( clique-)guarded sentence .",
    "[ thrm_small_models ] every satisfiable formula of @xmath87@xmath96and thus of @xmath97 has a finite model of size exponential in the length and doubly exponential in the width of the formula .",
    "moreover , for every @xmath98 , the @xmath99-variable fragment of @xmath87@xmath100 has finite models of exponential size in the length of the formula .",
    "another important fragment of first - order logic that has the finite model property is @xmath101-variable first - order logic , denoted by @xmath102 .",
    "it was shown in  @xcite that if an @xmath102 formula @xmath103 is satisfiable , then it has a model of cardinality singly exponential in the size of @xmath103 , improving an earlier doubly exponential bound by mortimer  @xcite . as a consequence",
    ", @xcite also proved @xmath104-completeness of the satisfiability problem for @xmath102 . a more powerful fragment that embeds a number of key features of description logics is the extension of the @xmath101-variable fragment with counting quantifiers , denoted @xmath105 .",
    "in contrast to @xmath106 , @xmath107does not have the finite model property , but computationally it is no more difficult than @xmath106 : both satisfiability and finite satisfiability of @xmath107-formulas are decidable and @xmath104-complete  @xcite . in  @xcite",
    "grdel proposed the guarded fragment of @xmath102 as a testbed for simple description logics .",
    "a more suitable fragment for this purpose is obtained by imposing on the one hand a restriction to guarded quantification while allowing on the other hand the use of counting quantifiers .",
    "the two - variable guarded fragment with counting quantifiers , @xmath108 , properly subsumes the description logic @xmath109 , cf .",
    "e.g.  @xcite , for which finite satisfiability was shown decidable in @xmath8 by lutz et al .  @xcite . in  @xcite kazakov gave a polynomial , satisfiability - preserving translation from @xmath108to the @xmath110-variable guarded fragment @xmath111 thus establishing @xmath8-completenes of satisfiability of @xmath108-formulas .",
    "finite satisfiability for @xmath108was also shown to be @xmath8-complete by pratt - hartmann  @xcite .",
    "the latter decision method is based on a reduction to integer programming .",
    "it is interesting to note that the optimal lower bound on the size of smallest finite models of finitely satisfiable @xmath108-formulas is doubly exponential  @xcite .",
    "[ [ complexity - of - query - answering . ] ] _ complexity of query answering . _",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    in @xcite grdel proved that satisfiability of @xmath5-sentences is complete for @xmath7 , and @xmath8-complete in case of bounded arity .",
    "we show that , more generally , answering @xmath11on the class of models of a @xmath5-sentence can also be performed in @xmath7 , which solves the initially posed complexity question about query answering over guarded theories .",
    "it follows from the work of lutz @xcite , however , that query answering remains @xmath7-complete for @xmath10even in the bounded arity case .",
    "considering unions of _ acyclic _ conjunctive queries we derive an @xmath8 solution to the query answering problem , and prove @xmath8-completeness already for a particular fixed @xmath5sentence .",
    "our algorithms are built around grdel s solution of the satisfiability problem for @xmath5 .",
    "the first step consists in reducing @xmath3 to @xmath112 , where @xmath77 is a disjunction of acyclic queries stemming from the original query .",
    "the formula @xmath77 may , however , be of exponential size in terms of the length of @xmath0 , demanding a closer inspection of the contribution of different dimensions of @xmath77 to the overall complexity of checking ( un)satisfiability of the guarded sentence @xmath113 .",
    "we also investigate the problem of query answering over models of a fixed guarded sentence , and provide a number of useful bounds .",
    "our bounds for fixed sentences @xmath1 are not all tight and leave room for future research .",
    "[ [ canonisation - and - capturing.-1 ] ] _ canonisation and capturing . _ + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    as a further consequence of the proof method employed for theorem  [ thrm_main ] , we find a polynomial solution to the canonisation problem for guarded bisimulation equivalence @xmath114 . this allows us to capture the @xmath114-invariant fragment of @xmath24 in the sense of descriptive complexity , i.e. , to provide effective syntax with @xmath24model checking for the class of all @xmath24queries that are closed under guarded bisimulation equivalence .",
    "canonisation is achieved through inversion of the natural game invariant @xmath115 that uniquely characterises the guarded bisimulation class , or the complete @xmath6-theory , of a given finite structure @xmath67 .",
    "a @xmath24reconstruction of a model from the abstract specification of its equivalence class yields @xmath24canonisation .",
    "[ thrm_canon ] for every relational signature @xmath94 there exists a @xmath24algorithm computing from a given invariant @xmath115 of an unspecified @xmath94-structure @xmath67 a finite @xmath94-structure @xmath116 such that @xmath117 ; hence @xmath118 and @xmath119 whenever @xmath120 .",
    "[ coroll_capture ] the class of all those @xmath24boolean queries that are invariant under guarded bisimulation , @xmath121 , can be captured in the sense of descriptive complexity .",
    "section  [ sec_prelim ] defines the main concepts and introduces guarded bisimilar hypergraph covers as a main tool .",
    "it also states the above - mentioned lemma  [ lemma_treeification ] .",
    "section  [ sec_rosati ] presents the construction of the rosati cover . from this and",
    "lemma  [ lemma_treeification ] , the finite controllability of @xmath6 is proven in section  [ sec_fmp ] .",
    "section  [ sec_complexity ] establishes our new complexity results .",
    "section  [ sec_capture ] deals with canonisation and capturing .",
    "we work with finite relational signatures .",
    "let us fix such a signature @xmath94 and let @xmath122 denote the the maximal arity of any of the relation symbols in @xmath94 .      the guarded fragment of first - order logic , @xmath6 , as introduced by andrka et al .",
    "@xcite , is the collection of first - order formulas with certain syntactic restrictions in the quantification pattern , which is analogous to the relativised nature of modal logic .",
    "the set of @xmath123 formulas is the smallest set    * containing all atomic formulas of signature @xmath94 and equalities between variables ; * closed under boolean connectives : @xmath124 , @xmath125 , @xmath126 , @xmath127 , @xmath128 ; * and such that whenever @xmath129 is a @xmath123 formula with all free variables indicated and @xmath130 is a @xmath94-atom ( or an equality ) involving all free variables of @xmath131 , then the following are in @xmath123 as well : @xmath132    in a @xmath94-structure @xmath67 a non - empty set @xmath133 of elements is said to be _ guarded _ if it is a singleton or there is an atom @xmath134 such that every member of @xmath133 occurs in @xmath135 .",
    "maximal guarded set _ is one not properly included in any other guarded set .",
    "a tuple @xmath136 of elements is guarded if the set of its components is guarded .",
    "+ while @xmath6 provides an important extension of the modal fragment , guarded quantification is too restrictive to express some basic temporal operators . to remedy this shortcoming various relaxations of the notion of guardedness and corresponding fragments",
    "have been introduced , chief among them the clique - guarded fragment .    the _ clique guarded fragment _ ,",
    "@xmath137 , relaxes the constraints on guards @xmath41 in @xmath6 to allow existentially quantified conjunctions of atoms as guards that guarantee that the tuple of free variables is clique - guarded .",
    "a set @xmath133 of elements of a structure @xmath67 is _ clique - guarded _ if every pair of elements of @xmath133 is guarded , equivalently , if @xmath133 induces a clique in the gaifman graph of @xmath67 .",
    "a tuple @xmath135 is clique - guarded whenever the set of its components is .",
    "observe that while guarded sets are bounded in size by the width of the signature , there can be arbitrarily large clique - guarded sets whenever the width is at least @xmath101 .",
    "recall that the _ width _ of a formula @xmath1 , @xmath138 is the maximal number of free variables in any of its subformulas . in a clique - guarded formula @xmath1 the maximal size of a clique - guarded set quantified over",
    "is bounded by @xmath138 .",
    "observe that guardedness and clique - guardedness ( of tuples of any fixed arity ) are definable in the corresponding logic .",
    "that is , there are formulas @xmath139 expressing that the tuple @xmath140 is guarded in the sense appropriate for the fragment .",
    "e.g. , @xmath141 where @xmath41 ranges over all @xmath94-atoms in tuples of variables comprising at least @xmath140 , as indicated .",
    "a formula @xmath142 can be similarly defined .",
    "+ an _ atomic @xmath94-type _",
    "@xmath143 is a maximal consistent set of @xmath94-literals ( atoms or negated atoms , including ( in)equalities ) whose constituent terms are among the variables @xmath144 and the constants from @xmath94 .",
    "an atomic type @xmath143 determines , for every choice of indices @xmath145 , its _ restriction _ to components @xmath146 , which is an atomic type in @xmath99 variables @xmath147 denoted @xmath148 ; conversely we say that @xmath149 is an _ extension _ of @xmath148 .",
    "in a @xmath94-structure @xmath67 the atomic type @xmath150 of a tuple @xmath135 is the unique atomic type @xmath151 such that @xmath152 .",
    "one says that @xmath149 is _ realised _ by @xmath135 in @xmath67 .",
    "each atomic type can be identified with the isomorphism type of the sub - structure induced by any tuple realising it . over a signature of @xmath153 many relational symbols of maximal arity @xmath75 and @xmath99",
    "constants there are @xmath154 many atomic types in @xmath155 variables .",
    "we identify each atomic type with the conjunction of its literals .",
    "[ [ guarded - bisimulation ] ] _ guarded bisimulation _",
    "+ + + + + + + + + + + + + + + + + + + + + +    the notion of guarded bisimulation  @xcite , denoted @xmath114 , can be defined either in terms of the guarded bisimulation game , a variant of the ehrenfeucht - frass style pebble game in which the set of pebbles must at any given time be guarded , or as a back - and - forth system of partial isomorphisms whose domain and image are both guarded .",
    "@xmath6 is preserved under guarded bisimulation  @xcite , see also : @xmath156    given a relational structure @xmath67 , its _ guarded bisimulation game graph _",
    ", denoted @xmath157 , has as its vertices the set @xmath158 of all _ maximal guarded tuples _ of @xmath67 , each labeled by its atomic type , equivalently , by the isomorphism type of the substructure induced by the tuple .",
    "two such tuples @xmath135 and @xmath136 are linked by an edge labeled by a partial bijection @xmath159 whenever @xmath160 for all @xmath161 .",
    "note that structures @xmath67 and @xmath68 are guarded bisimilar iff @xmath157 and @xmath162 are bisimilar in the modal sense  @xcite .",
    "the _ guarded bisimulation invariant _",
    "@xmath115 of @xmath67 is defined as the bisimulation quotient of @xmath157 .",
    "vertices of @xmath115 correspond to @xmath114-classes of maximal guarded tuples of @xmath67 , labeled by their atomic types ( induced isomorphism types ) . a @xmath163-labeled edge links vertices @xmath164 and @xmath75 if there are guarded tuples @xmath135 and @xmath136 in @xmath67 realising the @xmath114-classes represented by @xmath164 and by @xmath75 , respectively , and such that @xmath160 for all @xmath161 .    [ [ scott - normal - form - and - satisfiability - criterion ] ] _ scott normal form and satisfiability criterion _ + +",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    grdel s analysis of decidability for @xmath6 @xcite uses the following scott normal form corresponding to a relational skolemisation .    [ lemma_normalform ] to every ( clique-)guarded @xmath94-sentence @xmath1 one can associate a companion ( clique-)guarded @xmath165-sentence @xmath166 such that @xmath167 and every  @xmath168   has a @xmath165-expansion @xmath169 . here",
    "@xmath170 , @xmath171 and the @xmath172 , @xmath173 are quantifier - free .    a guarded bisimulation game graph @xmath174 or ,",
    "similarly , a guarded - bisimulation invariant @xmath175 is said to satisfy the formula @xmath131 in scott normal form if    * its vertices are labeled by atomic types in the signature of @xmath131 that are guarded and that satisfy the universal conjuncts of @xmath131 ; and * for each vertex @xmath164 with label @xmath176 and for each conjunct @xmath177 of @xmath131 such that @xmath178 there exists a vertex @xmath75 labeled with some type @xmath179 such that @xmath180 and @xmath164 and @xmath75 are linked by an edge labeled with the mapping @xmath181 .",
    "[ prop_satcrit ] let @xmath131 be the normal form of @xmath1 as in",
    ". then @xmath1 is satisfiable if , and only if , there exists a guarded bisimulation invariant @xmath182 satisfying @xmath131 and such that vertices of @xmath182 are labeled by distinct guarded atomic types .",
    "+      a _ hypergraph _ is a pair @xmath183 with @xmath184 its set of elements and @xmath185 a set of subsets of @xmath184 , which are called hyperedges .",
    "for a set of hyperedges @xmath186 , let @xmath187 stand for the closure of @xmath186 under subsets .",
    "a set @xmath133 of elements of @xmath188 is guarded if @xmath189 .",
    "the gaifman graph @xmath190 of @xmath188 is the undirected graph having vertex set @xmath184 and , as edges , all non - degenerate guarded pairs of @xmath188 .",
    "the maximal size of any hyperedge is referred to as the _ width _ of @xmath188 . to every @xmath94-structure",
    "@xmath67 one associates in a natural way a hypergraph @xmath191 $ ] with @xmath184 the universe of @xmath67 and @xmath186 the collection of maximal guarded subsets of @xmath67 . the width of @xmath191 $ ]",
    "is then bounded by @xmath122 .",
    "the gaifman graph of @xmath67 is @xmath192 : = \\gamma(h[{\\mathfrak{a}}])$ ] .",
    "a _ homomorphism _ @xmath193 between hypergraphs @xmath194 and @xmath195 is a map from @xmath184 to @xmath196 such that @xmath197 for all @xmath198 .",
    "a hypergraph homomorphism @xmath93 is _ rigid _ if @xmath199 for every hyperedge @xmath200 .",
    "every homomorphism @xmath201 between relational structures induces a hypergraph homomorphism from @xmath191 $ ] to @xmath202 $ ] .",
    "game graphs @xmath203 and invariants @xmath204 are defined similarly for hypergraphs @xmath188 as for relation structures , where instead of guarded bisimulation we use the natural notion of _ hypergraph bisimulation_. it is safe to think of hypergraph bisimulation as of guarded bisimulation stripped of all atomic relational information .",
    "vertices in the game graph are maximal hyperedges each labeled with the isomorphism type of the sub - hypergraph induced by it , in other words , the label carries the information about all hyperedges lying inside a maximal hyperedge . edges of the game graph connect overlapping maximal hyperedges and are in bijection with and are labeled by partial bijections compatible with the actual overlap .",
    "a hypergraph @xmath188 is ( @xmath19-)_conformal _ if every clique in @xmath190 ( of size at most @xmath19 ) is covered by a hyperedge of @xmath188 .",
    "a structure @xmath67 is ( @xmath19-)conformal whenever @xmath191 $ ] is , i.e. , if every @xmath99-clique ( @xmath205 ) in its gaifman graph is covered by a ground atom . over conformal structures guarded quantification is as powerful as clique - guarded quantification .",
    "a hypergraph @xmath188 is ( @xmath19-)_chordal _ if all cycles in @xmath190 of length greater than @xmath110 ( and at most @xmath19 ) have a chord in @xmath190 .",
    "an analogous notion for relational structures @xmath67 is similarly defined in terms of the gaifman graph @xmath206 .",
    "a hypergraph is ( @xmath19-)_acyclic _ if it is both ( @xmath19-)chordal and ( @xmath19-)conformal . for finite hypergraphs acyclicity is equivalent to tree decomposability .",
    "a finite hypergraph is _ tree decomposable _ if it can be reduced to the empty hypergraph by iteratively deleting some non - maximal hyperedge or some vertex contained in at most one hyperedge ( graham s algorithm ) cf .",
    "we say that a relational structure @xmath67 is _ guarded tree decomposable _ if @xmath67 allows a tree decomposition in the sense of robertson ",
    "seymour with guarded bags .",
    "this is equivalent to @xmath191 $ ] being tree decomposable , i.e.  acyclic .",
    "a homomorphism @xmath193 into the hypergraph @xmath207 is called _ tree decomposable _ if there is some @xmath208 such that  @xmath209 is a homomorphism into @xmath210 and @xmath211 is tree decomposable ; anaolgously , for relational structures . in this sense",
    "a homomorphism between relational structures @xmath212 is _ guarded tree decomposable _ if @xmath213 for homomorphisms @xmath214 and @xmath215 where @xmath216 is guarded tree decomposable .",
    "we describe this situation by saying that @xmath93 _ factors _ through @xmath214 .",
    "the following key notion employs this idea to capture a subtle relaxation of @xmath19-acyclicity in the context of coverings .",
    "[ def_cover ] a _ guarded bisimilar cover _",
    "( or just _ cover _ for short ) @xmath217 is an onto homomorphism @xmath218 inducing a guarded bisimulation @xmath219 @xmath220 between relational structures @xmath68 and @xmath67 of the same vocabulary . a cover @xmath217 is _",
    "weakly @xmath19-acyclic _ if , for all homomorphisms @xmath221 with @xmath222 , there is a guarded tree decomposable structure @xmath223 and homomorphisms @xmath224 , @xmath225 such that @xmath226 .",
    "analogous notions of hypergraph covers are defined mutatis mutandis with the additional stipulation that the restriction of a cover homomorphism to every hyperedge is expressly required to be injective , i.e.  that the cover homomorphism is to be rigid .",
    "( in the case of guarded bisimilar covers among relations structures the analogous condition is implied by the above definition .",
    "that is , every guarded bisimular cover @xmath217 induces a hypergraph cover @xmath227 { \\stackrel{\\sim~}{\\rightarrow}}h[{\\mathfrak{a}}]$ ] such that @xmath228 is a rigid homomorphism of hypergraphs ) .",
    "_ conjunctive queries _ ( @xmath229 ) are formulas of the form @xmath230 , where the @xmath231 are positive literals .",
    "a boolean conjunctive query ( @xmath10 ) is one with no free variables .",
    "a union of ( boolean ) conjunctive queries ( @xmath11 ) is a disjunction of @xmath10 .",
    "the size @xmath232 of a @xmath11@xmath0 is its length as a formula , and its _ height _ is the maximal size of its disjuncts ( constituent @xmath229 ) .    to every @xmath10@xmath233 of signature @xmath94",
    "one can associate the @xmath94-structure @xmath234 having as its universe the set of variables in @xmath140 and atoms as prescribed by the @xmath231 of @xmath235 .",
    "then @xmath236 iff there exists a homomorphism @xmath237 , @xcite .",
    "we say that @xmath238 is _ acyclic _ if the associated structure @xmath234 is acyclic .",
    "note that this is equivalent to the existence of a _ guarded _ conjunctive query equivalent to @xmath235 , i.e. , one that is both in @xmath5and in @xmath229  @xcite .    for each @xmath10@xmath235",
    "we define its _ treeification in signature @xmath94 _ , denoted @xmath239 , as the disjunction of all _ acyclic _",
    "@xmath10  @xmath240 in the signature @xmath94 comprised of _ at most three times as many atoms _ as @xmath235 and such that @xmath241 .",
    "further , for @xmath242 a @xmath11we set @xmath243 . it is obvious that @xmath244 for every @xmath0 . in the following @xmath94",
    "will always be an expansion of the signature of @xmath0 , and will be omitted whenever clear from the context or of no import .",
    "[ lemma_treeification ] let @xmath94 be a signature consisting of @xmath153 relation symbols of maximal arity @xmath75 ( the width of @xmath94 ) .",
    "consider a @xmath11@xmath242 over @xmath94 and let @xmath245 ( the height of @xmath0 ) .    1 .   for a @xmath94-structure @xmath67",
    "we have @xmath246 if there is a guarded tree decomposable homomorphism @xmath247 for some @xmath248 .",
    "2 .   in particular , for all  @xmath249 $ ] : @xmath12 iff @xmath250 .",
    "the size of the treeification @xmath251 is at most @xmath252 ; + moreover , @xmath251 can be constructed in time @xmath253 .",
    "\\(i ) let @xmath247 be a guarded tree decomposable homomorphism .",
    "this means that @xmath254 for some guarded tree decomposable @xmath68 , a ( not - necessarily induced ) substructure of @xmath67 .",
    "consider a fixed guarded tree decomposition of @xmath68 represented as @xmath255 with @xmath256 a forest with transitive edges and @xmath257 assigning to each node an atom of @xmath68 , the guard of the corresponding bag of the tree decomposition .",
    "as @xmath258 maps @xmath259 homomorphically into @xmath68 , for each atom @xmath41 of @xmath259 we can pick a node @xmath260 with @xmath261 guarding the image of @xmath41 under @xmath258 .",
    "let @xmath262 be the closure of the set of all these @xmath263 under greatest lower bounds w.r.t .",
    "then @xmath265 represents a guarded tree decomposition of the structure @xmath266 consisting of those atoms in the image of @xmath258 together with atoms of the form @xmath267 for @xmath268 .",
    "note that at least half of the nodes in @xmath262 are of the form @xmath263 , therefore @xmath266 has at most three times as many atoms as @xmath259 .",
    "and we have @xmath269 .",
    "to @xmath266 corresponds an acyclic @xmath10@xmath240 , whose models are precisely those structures containing a homomorphic image of @xmath266",
    ". then @xmath270 and hence @xmath240 is one of the disjuncts in @xmath251 .",
    "therefore @xmath246 .",
    "\\(ii ) since @xmath244 , trivially @xmath250 implies @xmath12 . to prove the converse implication",
    "assume indirectly that @xmath12 but @xmath271 were satisfiable .",
    "note that the latter is equivalent to a guarded formula .",
    "then , by the tree model property of @xmath6 @xcite , there is a guarded tree decomposable model @xmath272 . by our assumption @xmath273 , i.e.  @xmath274 for some @xmath10@xmath248 in @xmath0 , which means that there is a homomorphism @xmath275 . given that @xmath223 is guarded tree decomposable , so is @xmath258 . by ( i )",
    "therefore @xmath276 , contradicting our assumption .",
    "\\(iii ) recall that , for a @xmath10  @xmath235 , the formula @xmath239 is a disjunction of several ( acyclic ) @xmath10 @xmath240 , each of which has at most @xmath277 many atoms and therefore requires no more than @xmath278 many variables ; the overall number of constituent @xmath10  of these dimensions is bounded by @xmath279 , and each such @xmath240 has length @xmath280 .",
    "all in all , @xmath281 .    for a @xmath11",
    "@xmath242 we have , by definition , @xmath282 , and , if the height of @xmath0 is @xmath93 , then @xmath283 by the previous estimate .",
    "one way to compute @xmath251 is to exhaustively enumerate all acyclic @xmath229   of the right dimensions and to check each one for entailment of some @xmath248 ( verifiable in time @xmath284 for each @xmath285 ) .",
    "such a procedure can be carried out in time @xmath253 .    concerning the size of treeifications ,",
    "note that for a fixed signature the figure from  ( iii ) simplifies to @xmath286 and that a @xmath287 lower bound can be established even if we require treeifications to be free of redundant disjuncts .",
    "indeed , in the signature @xmath288 , where @xmath37 is binary and @xmath240 is ternary , it is easy to see that the @xmath10  @xmath289 for which @xmath290 is a simple @xmath37-cycle of length @xmath155 , the number of triangulations of @xmath290 and hence the number of disjuncts in @xmath291 is @xmath292 .",
    "+ the next key fact is a direct consequence of lemma  [ lemma_treeification ]  ( i ) and definition  [ def_cover ] that highlights the role of query treeification and motivates our interest in weakly @xmath19-acyclic covers .",
    "[ fact_covers_and_treeification ] for every weakly @xmath19-acylic cover @xmath217 of @xmath94-structures , for every @xmath249 $ ] and every @xmath293 $ ] of height at most @xmath19 : @xmath294    using this fact and the finite model property of the guarded fragment , theorem  [ thrm_fincontrol ] will follow , once it is established that every finite relational structure admits suitably sized finite weakly @xmath19-acyclic covers for all @xmath19 .",
    "that is precisely the content of theorem  [ thrm_main ] . before engaging in the proof of this main technical result",
    "let us point out a noteworthy consequence of item  ( ii ) of lemma  [ lemma_treeification ] .",
    "consider the fragments @xmath6 and @xmath295 ( equivalently , the positive existential fragment ) of first - order logic in a relational signature .",
    "they are incomparable with respect to expressive power and , as mentioned above , the intersection of the two fragments comprises ( up to semantic equivalence ) precisely the unions of guarded conjunctive queries , or unions of acyclic conjunctive queries ( @xmath296 ) . in one reading , lemma  [ lemma_treeification ]  ( ii ) states that the fragments @xmath6 and @xmath295 have a strong form of interpolation with @xmath296 interpolants . indeed , consider some @xmath297 and @xmath89 in signature @xmath94 . then @xmath298 and it is interesting to note that the treeification @xmath251 of the query @xmath0 is a uniform interpolant for all @xmath249 $ ] that entail @xmath0 . as a consequence of our theorem  [ thrm_fincontrol ]",
    "we will see that the interpolation property   remains intact when the semantics is restricted to finite models .",
    "rosati proved proposition  [ prop_rosati ] using a `` finite chase '' procedure  @xcite that safely reuses variables and results in very compact finite models .",
    "however , his proof of correctness of the finite chase with respect to conjunctive query answering is very intricate .",
    "we adapt the core idea of his model construction to give a more general guarded bisimilar cover construction for finite models , and a conceptually cleaner and simpler proof of faithfulness with respect to   conjunctive queries of bounded size .",
    "[ thrm_main_from_gbis_invariant ] given a bisimulation invariant @xmath299 of an unspecified hypergraph @xmath67 , for all @xmath71 one can construct hypergraphs @xmath300 such that @xmath301 , each @xmath300 is @xmath19-conformal and each @xmath302 is a weakly @xmath19-acyclic cover of  @xmath300 . moreover , @xmath303 , where @xmath75 is the width  . ]",
    "of @xmath67 and , for fixed @xmath75 and @xmath19 , @xmath300 can be computed in polynomial time from @xmath182 .",
    "the analogous claim for the guarded bisimulation invariant @xmath304 of a finite relational structure @xmath67 , and concerning guarded bisimilar covers , follows .",
    "it is not hard to see how this formulation entails the statement of theorem  [ thrm_main ] as given in the introduction .",
    "observe that @xmath305 , where @xmath157 is the bisimulation game graph of the given @xmath67 ( without passage to a non - trivial quotient ) , can be enforced by introducing new predicates to distinguish each individual guarded tuple of @xmath67 .",
    "then @xmath306 is a weakly @xmath19-acyclic ( guarded ) bisimilar cover of @xmath67 itself and has size @xmath307 . since @xmath19-conformality implies conformality at large if @xmath308 , moreover @xmath309  is a conformal cover of @xmath67 and we also obtain corollary  [ coroll_conformal covers ] .",
    "we first define , for every @xmath19 , the @xmath19-th rosati cover of a given finite hypergraph ( or relational structure ) .",
    "after preliminary observations much resembling some of rosati s key lemmas  @xcite we prove their two crucial properties : @xmath19-conformality of @xmath300 and the weak @xmath19-acyclicity of @xmath302 as a cover over @xmath300 .",
    "in fact , the structures @xmath300 will form a chain of covers of increasing degrees of conformality and weak acyclicity , similar to the construction of  @xcite .",
    "let @xmath75 be the width of @xmath67 ( apparent from @xmath299 ) , i.e.  the maximal size of any of its hyperedges ( guarded sets ) .",
    "we assume throughout that @xmath311 , since width  @xmath312 is trivial .",
    "for the rest of this section we also fix @xmath313 , @xmath71 .",
    "consider a relational structure @xmath67 and its guarded - bisimulation invariant @xmath299 . recall that the vertices of @xmath115 represent complete @xmath6-types of maximal guarded tuples @xmath135 such that @xmath314 for all @xmath315 and are labeled by the isomorphism type of the sub - structure induced by any ( and all ) corresponding tuple .",
    "we denote vertices of @xmath182 by symbols @xmath316 and for each @xmath317_{{\\sim_\\mathrm{g}}}$ ] we let @xmath318=\\{1,\\ldots,|{{\\overline{{a}}}}|\\}$ ] .",
    "edges of @xmath182 are triples @xmath319,e)$ ] , where @xmath320_{{\\sim_\\mathrm{g}}}$ ] and @xmath321_{{\\sim_\\mathrm{g}}}$ ] and the label @xmath322 $ ] is a non - empty partial injection @xmath323\\to[e]$ ] such that @xmath160 for all @xmath324 $ ] .",
    "( in this case @xmath163 induces a @xmath114-preserving partial isomorphism @xmath325 } \\to { { \\overline{{b}}}}'\\restriction{{{\\mathrm{img}}}[\\rho]}$ ] for any @xmath326 and any @xmath327 . ) symbols @xmath328 etc .",
    "will refer to edges of @xmath182 , their respective labels will be denoted @xmath322,[\\sigma]$ ] , etc .",
    "we adapt the same notation in the case of a hypergraph and its hypergraph bisimulation invariant .",
    "recall that the latter is the bisimulation quotient of the hypergraph bisimulation game graph as described earlier . in the following we often blur the distinction in phrasing and notation between the cases of hypergraphs and of relational structures , opting to treat these perfectly analogous cases as one .",
    "we associate to the invariant @xmath182 a set of constant and function symbols as follows .",
    "= 1.7em    to every vertex @xmath329 , every @xmath330 $ ] and @xmath331 we associate a constant symbol @xmath332 .    to every edge @xmath319,e)$ ] and",
    "every @xmath330 \\setminus { { \\mathrm{img}}}[\\rho]$ ] and @xmath331 we associate a function symbol @xmath333 of arity @xmath334|$ ] .",
    "we work with well - formed terms in the above signature . as shorthand",
    "we write @xmath335 for @xmath336 , and @xmath337 for @xmath338}$ ] and for every tuple @xmath339 we let @xmath340 stand for @xmath341 . for each term",
    "@xmath149 let @xmath342 denote the set of `` @xmath343-values '' occurring in the superscript of a function symbol at any depth within @xmath149 .",
    "this notion extends naturally to tuples of terms .",
    "thus @xmath344 and @xmath345 .",
    "the _ truncation _ of a term @xmath149 at depth @xmath346 , denoted @xmath347 , is defined by the following recursive rules and is extended to tuples of terms and to sets of terms in the obvious way .",
    "@xmath348,e ) ) \\\\    f^j_{\\rho , i}({{\\overline{{t}}}})/_{\\kappa+1 } & = & f^j_{\\rho , i}({{\\overline{{t}}}}/_{\\kappa } )",
    "\\end{array}\\ ] ] the @xmath19-th rosati cover @xmath300 is made up of terms of height at most @xmath19 and is built to realise all guarded bisimulation types in @xmath182 . to that end",
    "we first define the sets @xmath349 of `` instances of @xmath329 at height  @xmath153 '' for each @xmath350 and @xmath351 by simultaneous recursion .",
    "@xmath352    { \\mathcal{k}}^{r+1}_n(e ) & = & \\ { \\ , { \\rho\\hspace{-0.565em}\\rho\\hspace{0.1em}}^j({{\\overline{{s}}}}\\restriction{{{\\mathrm{dom}}}[\\rho ] } ) \\ \\ , \\mid   \\ ,                                 & { { \\overline{{s } } } } \\in { \\mathcal{k}}^r_n(d ) , \\ , \\rho=(d,[\\rho],e ) , \\\\",
    "& &         & j < w^{m+2 } , \\ , j \\not\\in j({{\\overline{{s}}}}\\restriction{{{\\mathrm{dom}}}[\\rho ] } ) \\ , \\ }   \\end{array}\\ ] ] where for each edge @xmath319,e)$ ] in @xmath182 and terms @xmath353 and @xmath343 as appropriate @xmath354})$ ] denotes the tuple @xmath355|})$ ] such that @xmath356 \\ , )                  \\\\[.5em ]                   f^j_{\\rho , i}({{\\overline{{s}}}}_{/n-1 } ) & ( \\ , i \\not\\in { { \\mathrm{img}}}[\\rho ] \\ , )                    \\end{array } \\right .",
    "\\text { for each } i \\in [ e ] \\ .\\ ] ] obviously @xmath354})$ ] depends solely on @xmath357}$ ] , wherefore more often than not we shall simply write @xmath358 so that , in particular , @xmath359 .    the sets @xmath360 of _ hyperedges above @xmath329 ( at height @xmath153 ) _ are obtained from the above by simply forgetting the tuple ordering : @xmath361 ; further set @xmath362 and @xmath363 .",
    "all terms @xmath149 appearing in some hyperedge in @xmath364 have height at most @xmath19 and , due to the stipulation @xmath365 in , no function symbol at the root of a subterm of @xmath149 occurs again within that subterm .    observe that every @xmath366 is either of the form @xmath367 for some @xmath153 and @xmath329 the target of @xmath163 or is equal to some @xmath368 . crucially ,",
    "under the assumption @xmath71 the constraint @xmath365 of ensures that the former partitioning of @xmath93 is unique and we say that @xmath369 is obtained by _",
    "@xmath163-extension _ of some ( not necessarily unique ) hyperedge @xmath370 , with @xmath319,e)$ ] , and denote this using the shorthand @xmath371 .",
    "note , in particular , that the sets @xmath372 partition @xmath373 . henceforth we often omit the subscript @xmath19 writing @xmath373 , @xmath372 , etc .    a hyperedge @xmath93 will be called a _ primary guard of @xmath133 _ if it is a guard of @xmath133 , viz .",
    "@xmath374 , and is not the @xmath163-extension of some @xmath375 also guarding @xmath133 .",
    "[ lemma_primguard ] assume @xmath376 .",
    "then for every guarded set @xmath133 of terms there is an @xmath377 such that all primary guards of @xmath133 belong to @xmath378 .",
    "consider a hyperedge @xmath93 that is a primary guard of @xmath133 . if @xmath379 for appropriate @xmath329 and @xmath343 , then @xmath93 is the only primary guard of @xmath133 , and we can set @xmath380 .",
    "otherwise we have @xmath381 for an appropriate edge @xmath382 in @xmath182 , some superscript @xmath343 , and terms @xmath383 . because @xmath93 is by choice a primary guard of @xmath133",
    ", it can not be that @xmath384 .",
    "so there is some @xmath385 in @xmath133 , and we set @xmath386 to be the target of @xmath163 .",
    "suppose indirectly that our choice of @xmath387 was not unique , i.e.  that there is some @xmath388 and a primary guard of @xmath133 of the form @xmath389 .",
    "then , by the previous argument , some @xmath390 would have to be in @xmath133 .",
    "this , however , would imply that @xmath391 had to be among @xmath392 and vice versa @xmath393 among @xmath394 .",
    "given that @xmath71 this would contradict the requirement that @xmath343 and @xmath395 each have but one occurrence in these terms .",
    "let @xmath396 be comprised of the hyperedges in @xmath364 together with sub - hyperedges @xmath397 for each @xmath398 precisely as specified by the type @xmath399 labeling @xmath350 .",
    "it follows from the above that whether some such @xmath375 is included in @xmath396 does not depend on the choice of @xmath93 . indeed , by lemma  [ lemma_primguard ]",
    ", we may assume that @xmath93 is a primary guard of @xmath375 since for every @xmath319,e)$ ] the types @xmath400}$ ] and @xmath401}$ ] are identical .",
    "+     + we define @xmath402 as having universe @xmath403 and hyperedges @xmath396 .    for the purposes of theorem  [ thrm_main_from_gbis_invariant ] we shall take @xmath404 and @xmath405 with @xmath406 .",
    "using similar reasoning as in lemma  [ lemma_primguard ] one can verify that @xmath182 is indeed the guarded bisimulation invariant of @xmath402 , i.e. , that @xmath407 for any @xmath67 with @xmath408",
    ".    [ lemma_gbisim ] for all @xmath376 it holds that @xmath409 .",
    "in particular , for each @xmath350 all hyperedges in @xmath410 realise the guarded bisimulation type represented by @xmath350 .",
    "consider @xmath411 and @xmath412 such that @xmath413 .",
    "as in lemma  [ lemma_primguard ] we can find primary guards @xmath414 of @xmath133 by tracing backward from @xmath415 and from @xmath416 , respectively , through extension sequences @xmath417 let @xmath418 for all @xmath419 and @xmath420 for all @xmath421 . then in @xmath182 we have the following paths .",
    "@xmath422 \\over \\longleftarrow } \\ e_1 \\",
    "\\cdots \\     e_{r-1 } \\",
    "{ \\buildrel [ \\rho_r ] \\over \\longleftarrow } \\",
    "\\ { \\buildrel [ \\sigma_s ] \\over \\longrightarrow } \\",
    "d_{s-1 } \\cdots \\",
    "d_{1 } \\ { \\buildrel [ \\sigma_1 ] \\over \\longrightarrow } \\ d_0\\ ] ] given the nature of edges in a ( guarded ) bisimulation invariant as representing partial isomorphisms they are invertible and compositional in the sense that for each @xmath423 \\over \\longrightarrow}\\ , w$ ] there is also @xmath424^{-1 } \\over \\longrightarrow}\\ , v$ ] and then for every @xmath425 \\over \\longrightarrow}\\ , u$ ] there is also @xmath426\\circ[\\rho ] \\over \\longrightarrow}\\ , u$ ] as long as @xmath427\\circ[\\rho ] \\neq \\emptyset$ ] .",
    "this means that for any non - empty @xmath428 \\subseteq     [ \\sigma_1 ] \\circ \\cdots \\circ [ \\sigma_s ]",
    "\\circ [ \\rho_r]^{-1 } \\circ \\cdots \\circ [ \\rho_1]^{-1}$ ] there is an edge @xmath429,d_0)$ ] in @xmath182 and now there is one such @xmath428 $ ] that maps the projection of @xmath133 in @xmath430 to the projection of @xmath133 in @xmath431 .",
    "it follows that all moves made from any @xmath432 to any @xmath433 in the guarded bisimulation game on @xmath402 have corresponding edges from @xmath430 to @xmath431 in @xmath182 .",
    "the converse of this being enforced by the very definition of @xmath402 , we can establish that the ( guarded ) bisimulation invariant of @xmath402 is no other than @xmath182 .",
    "[ lemma_chain ] @xmath434 for all @xmath435 , all @xmath153 , and all @xmath350 .",
    "truncation of terms at depth @xmath99 thus acts as a homomorphic projection from @xmath402 onto @xmath436 inducing a guarded bisimulation .",
    "therefore , for every @xmath437 , we have the following chain of covers .",
    "@xmath438    for @xmath439)$ ]",
    "a permutation of @xmath343-values and @xmath149 a term let @xmath440 denote the term obtained by translating all superscripts @xmath343 in @xmath149 according to @xmath30 .",
    "@xmath441 based on definitions and it is straightforward to verify by induction on @xmath19 and on @xmath153 that @xmath442 and that @xmath360 is closed under translations @xmath443 for all @xmath329 .    using the latter one can in fact",
    "show by induction that @xmath444 for all @xmath153 , @xmath350 and @xmath445 .",
    "this amounts to proving that all hyperedges @xmath446})\\ } \\in { \\mathcal{h}}^{r+1}_{n-1}(e)$ ] obtained by @xmath163-extension of some @xmath447 can also be obtained as truncations of hyperedges in @xmath448 , assuming , by the induction hypothesis , that @xmath449 , i.e. , that there is a @xmath450 such that @xmath451 . while @xmath452})$ ] in this case , cf . , it is conceivable that @xmath343 does occur in @xmath453}$ ] at depth @xmath19 .",
    "if so , then take a permutation @xmath439)$ ] that fixes @xmath454})\\setminus\\{j\\}$ ] pointwise but does not fix @xmath343 ( that such a permutation exists follows from @xmath455 ) , otherwise let @xmath456 . then , by closure under translations , @xmath457 and by the choice of @xmath30 we have @xmath458 and @xmath459})$ ] .",
    "consequently @xmath460})\\}$ ] is a hyperedge in @xmath448 and @xmath461}/_{n-2})\\ }    \\cup \\{{{\\overline{{u}}}}^\\sigma|_{{{\\mathrm{dom}}}[\\rho]}/_{n-1}\\ } = h$ ] as needed .",
    "it follows that @xmath462 for all @xmath463 .",
    "truncation of terms at depth @xmath464 is therefore a homomorphism from @xmath402 to @xmath465 that is onto . by lemma  [ lemma_gbisim ]",
    "it also induces a ( guarded ) bisimulation @xmath466 yielding a chain of covers as claimed .",
    "the size of @xmath402 can be bounded as follows .",
    "let @xmath75 be the width of @xmath182 , assume that @xmath467 and let @xmath468 .",
    "then there are @xmath469 many constants @xmath332 and function symbols @xmath333 altogether , and each term of height up to @xmath19 contains at most @xmath470 many such symbols . for @xmath406 , therefore , the total number of terms in @xmath471 is at most @xmath472 as stated in theorem  [ thrm_main_from_gbis_invariant ] .",
    "consider a hyperedge @xmath473 .",
    "the elements of @xmath474 will be referred to as _ siblings _ ; we denote the sibling relation as @xmath475 .",
    "we also say that these terms are _ introduced in the hyperedge @xmath93 _ and that _ @xmath93 is a @xmath163-extension_. furthermore , elements of @xmath476 are said to be _ predecessors _ of those in @xmath474 , and we denote this by writing @xmath477 , for @xmath478 and @xmath285 as appropriate .",
    "constants covered by a hyperedge @xmath368 are also regarded as siblings introduced in that hyperedge .",
    "compare lemmas  49 of  @xcite for some of the following properties .    [ lemma_props ]",
    "let @xmath376 as before .    1 .   [ props_partition ] the relations @xmath479 , @xmath480 , and its inverse @xmath481 partition the set of all guarded pairs of @xmath402 .",
    "[ props_sib_equiv ] @xmath479 is an equivalence relation having guarded equivalence classes .",
    "[ props_pred_sib ] whenever @xmath482 then @xmath483 is guarded and @xmath484 .",
    "[ props_pred_nacylic ] @xmath402 has no directed @xmath480-cycles of length @xmath485 .",
    "[ props_prim_max ] if @xmath93 is a primary guard of @xmath133 then some @xmath480-maximal element of @xmath93 must be in @xmath133 . 6 .",
    "[ props_pred_trans ] assuming @xmath486 , the relation @xmath480 is transitive on every guarded set of terms . 7 .",
    "[ props_prim_trunc ] if @xmath486 and @xmath487 is a ( primary ) guard of @xmath488 then @xmath489 is a ( primary ) guard of @xmath490 . in particular , @xmath491 for every guarded set @xmath488 .    as to item , observe that the sibling and predecessor relationships are reflected in the terms themselves .",
    "siblings are identical terms for all but the indices in the subscript of their respective root symbol , and the @xmath492-truncation of each predecessor of a term occurs in it as an immediate subterm of the root symbol . given that @xmath71 and that the @xmath343 superscripts are by definition unique within each term , it is impossible for some @xmath493 to have @xmath494 as a subterm at depth @xmath101 , and hence it is impossible to have some @xmath495 .",
    "item can be equivalently stated in a form similar to that of , asserting that whenever @xmath496 then @xmath483 is guarded and also @xmath497 holds .",
    "let us first verify that @xmath498 is guarded in both these cases . for item",
    "this is obviously the case if @xmath499 are sibling constants belonging to some @xmath335",
    ". otherwise let @xmath500 be any primary guard of the pair @xmath501 . then ,",
    "whether @xmath502 or @xmath503 the term @xmath504 must have been introduced in the hyperedge @xmath93 and must therefore take the form @xmath505 . being a sibling of @xmath504 , @xmath506 and as such is contained in @xmath93 , which therefore guards @xmath498 .",
    "now it is obvious from the definition of the sibling and predecessor relations that @xmath497 or @xmath484 , according to whether @xmath502 or @xmath503 .",
    "item is a trivial consequence of the requirement that superscripts @xmath343 must not occur twice in any term in @xmath402 . indeed ,",
    "if @xmath507 is a predecessor chain of length @xmath508 then @xmath509 is , for each @xmath510 , a subterm of @xmath511 at depth @xmath153 .",
    "this implies that @xmath512 are pairwise distinct .",
    "property is a straightforward consequence of the definitions .",
    "consider @xmath93 a primary guard of @xmath133 .",
    "either @xmath379 and each @xmath332 is @xmath480-maximal within @xmath93 , or @xmath513 introduces some @xmath514 , which is then @xmath480-maximal within @xmath93 .",
    "assuming @xmath486 , property follows from the prior ones .",
    "indeed , let @xmath515 such that @xmath516 is guarded . then , according to either @xmath517 or @xmath518 or @xmath484 .",
    "in the first case we have @xmath519 by and thus a two - cycle @xmath520 , in the second case we have a three - cycle @xmath521 , both contradicting .",
    "therefore @xmath484 .",
    "finally , towards consider a hyperedge @xmath93 that is a guard ( i.e.  superset ) of @xmath488 . by lemma  [ lemma_chain ] ,",
    "also @xmath489 is a hyperedge in @xmath465 , and it guards @xmath522 . if @xmath489 is _ not _ a primary guard of @xmath522 then @xmath489 is of the form @xmath523 and @xmath524 . by lemma  [ lemma_chain ]",
    "again , @xmath525 for some terms @xmath526 such that @xmath527 .",
    "suppose now that @xmath93 is a primary guard of @xmath133 and thus there is some term @xmath528 belonging to @xmath133 .",
    "then @xmath529 belongs to @xmath522 .",
    "given that @xmath530 , this contradicts the assumption @xmath524 , i.e.  that @xmath489 is not a primary guard of @xmath522 .",
    "consider @xmath531 and an @xmath478-clique @xmath532 in @xmath300 , i.e. , such that all pairs @xmath533 are guarded . by lemma  [ lemma_props ]",
    "there are no predecessor - cycles in @xmath532 but there is a term , wlog .",
    "@xmath511 , such that every one of @xmath534 is either a predecessor or a sibling of @xmath511 .",
    "observe that the projection of any primary guard of @xmath511 to @xmath465 guards @xmath535 .",
    "this would already be sufficient to establish a weaker form of theorem  [ thrm_main_from_gbis_invariant ] still yielding theorem  [ thrm_fincontrol ] for @xmath6 .",
    "however , we can show that the entire @xmath478-clique is guarded already in @xmath300 .",
    "[ prop_conformality ] assume that for some @xmath536 there are @xmath537 in @xmath300 such that all pairs @xmath533 are guarded .",
    "then the entire clique @xmath532 is guarded in @xmath300 .    from the trivial base case for @xmath538",
    "we proceed by induction on @xmath478 . by the preceding observation",
    "we may assume wlog .  that each of @xmath534 is either a predecessor or a sibling of @xmath511 . by the induction hypothesis @xmath539",
    "is guarded .",
    "consider first the case when @xmath540 for some @xmath541 .",
    "then @xmath542 is a @xmath480-maximal element of @xmath133 and as such is necessarily introduced in any primary guard @xmath93 of @xmath133 .",
    "but then @xmath511 , being a sibling of @xmath542 , is also introduced in @xmath93 , which therefore guards the entire clique .",
    "otherwise we know that @xmath543 for all @xmath544 . also , @xmath133 being guarded it contains a @xmath480-maximal element , wlog .",
    "@xmath504 . let @xmath545 be a primary guard of the pair @xmath546 .",
    "given that @xmath519 , then @xmath511 is introduced in @xmath545 , cf .",
    "property . in this case @xmath511 takes the form @xmath547 for some @xmath548 and appropriate @xmath549 and @xmath550 where @xmath551 for some @xmath552 .",
    "note that each @xmath553 is a subterm of @xmath511 at depth one , i.e. , is among those in @xmath554 .",
    "for each @xmath285 , let @xmath555 denote the component of @xmath526 such that @xmath556 and let @xmath557 .",
    "thus @xmath558 .",
    "crucially @xmath559 , for it is included in @xmath560 .",
    "also observe that , because @xmath504 is @xmath480-maximal in @xmath133 , for each @xmath561 either @xmath562 or @xmath563 also occurs as a subterm of @xmath504 .",
    "tracing backward from @xmath545 and @xmath560 as above we can find a chain of expansions @xmath564 with @xmath565 a guard of @xmath566 for each @xmath567 until we reach some @xmath568 a primary guard of @xmath566 .",
    "let @xmath569 and consider some @xmath570 , a primary guard of @xmath133 .",
    "given that @xmath571 and @xmath558 , according to lemma  [ lemma_props ]   we have @xmath572 , thereby @xmath573 . from this",
    "it follows that the extension sequence @xmath574 is applicable to @xmath575 . however , our aim is to mimic the exact same derivation sequence with the same @xmath576-values as in starting from @xmath575 .",
    "notice that @xmath504 being @xmath480-maximal among @xmath133 , it is also @xmath480-maximal in @xmath575 , in accordance with lemma  [ lemma_props ] .",
    "therefore , every @xmath577 is either a sibling or a predecessor of @xmath504 .",
    "similarly , every @xmath578 is a sibling or a predecessor , respectively , of @xmath579 .",
    "in other words , the exact relationships within @xmath575 are mirrored in @xmath580 .",
    "given that @xmath581 this implies @xmath582 .",
    "having ascertained @xmath582 , it now follows that the same extension sequence @xmath583 as in is applicable to @xmath575  with the very same @xmath576-values  producing an analogous derivation to that of @xmath545 from @xmath580 : @xmath584 ending in some @xmath585 .",
    "note that , because each @xmath565 is a guard of @xmath566 , also each @xmath586 is a guard of @xmath133 .",
    "moreover , a simple induction shows that @xmath587 for all @xmath588 . in particular ,",
    "@xmath589 where @xmath590 and @xmath591 .",
    "as such , @xmath592 introduces @xmath593 and thus guards the entire clique .",
    "[ prop_acyclicity ] let @xmath594 and consider a homomorphism @xmath595 with @xmath596 and the projection @xmath597 .",
    "then there is a guarded tree - decomposable ( not necessarily induced ) sub - structure @xmath223 of @xmath402 containing the @xmath598-image of @xmath599 .",
    "weak @xmath19-acyclicity of @xmath600 follows since @xmath598 trivially factors through @xmath601 with @xmath602 .",
    "then obviously also @xmath603 is weakly @xmath19-acyclic . following the analogous result in  ( * ? ? ?",
    "* section 5 ) , the proof of the proposition is based on the @xmath19-conformality of @xmath402 ( cf .   proposition  [ prop_conformality ] ) and an inductive use of the next observation .",
    "[ lemma_chords ] consider an @xmath478-cycle @xmath604 in the gaifman graph of @xmath436 , with @xmath605 .",
    "then there is some @xmath285 such that @xmath606 is a guarded triangle in @xmath607 and @xmath608 a cycle of length @xmath609 .    given an @xmath478-cycle in @xmath402 as above , by lemma  [ lemma_props ]",
    "( i ) we know that for every @xmath285 either @xmath610 or @xmath611 or @xmath612 . according to lemma  [ lemma_props ]  ( iv ) there are no predecessor cycles of length @xmath485 in @xmath402 , hence it can not be the case that @xmath611 for all @xmath285 , nor that @xmath613 for all @xmath285 . then for some @xmath285 one of the following cases must hold :    * @xmath614 : then , by lemma  [ lemma_props ]  , @xmath615 is guarded and @xmath616 ; * @xmath617 : then , by lemma  [ lemma_props ]  , @xmath615 is guarded and @xmath618 ; * @xmath619 : then , similarly , @xmath615 is guarded and @xmath620 ; * @xmath621 : then both @xmath622  and  @xmath623 are maximal proper subterms of @xmath542 ; therefore , the projection @xmath489 of any hyperedge @xmath93 of @xmath402 in which @xmath542 was introduced guards @xmath624 in @xmath465 .",
    "in each case we will have found some @xmath285 such that @xmath625 constitutes in @xmath465 a cycle of length @xmath609 and @xmath624 a guarded triangle .    .5em",
    "recall from lemma  [ lemma_chain ] that for @xmath626 the structures @xmath627 form a chain of covers induced by the projections @xmath628 .",
    "let @xmath629 and @xmath630 .",
    "for every @xmath631 we shall inductively construct a finite structure @xmath632 and a homomorphism @xmath633 such that i ) the @xmath634-image of every chordless cycle in the gaifman graph of @xmath635 contains a chord in @xmath636 and ii ) no element of @xmath637 lies on a chordless cycle in the gaifman graph of @xmath636",
    ".    if there are no chordless cycles in the gaifman graph of @xmath635 then let @xmath638 and let @xmath639 be the identity on @xmath635 .",
    "note that once this happens , the construction stabilizes in the sense that @xmath640 will hold for all @xmath641 .",
    "otherwise , from lemma  [ lemma_chords ] we know that for every chordless cycle @xmath45 in the gaifman graph of @xmath635 , its image @xmath642 does have a chord in @xmath643 in the form of a guarded pair @xmath644 with @xmath645,@xmath646 non - neighboring elements of @xmath45 . in the degenerate case @xmath647 ; otherwise the chord results from some relational atom @xmath648 of @xmath649 with both @xmath650 and @xmath651 among @xmath652 . to construct @xmath636 we take @xmath653 amalgamated with a fresh copy of @xmath654 for every chordless cycle in the gaifman graph of @xmath635 , whereby the copy of each @xmath654 is attached to @xmath653 only at those two elements @xmath650,@xmath651 forming the new - found chord of @xmath45 .",
    "this ensures , as asserted , that no element of @xmath636 thus introduced outside of @xmath653 lies on a chordless cycle in the gaifman graph of @xmath636 .",
    "we define @xmath639 to act as the identity on @xmath653 and to map the copy of each @xmath654 to the original @xmath654 inside @xmath643 .",
    "notice that since every cycle in whatever @xmath635 involves only images of elements of @xmath655 , of which there are no more than @xmath19 , the above process must stabilize after at most @xmath656 many steps , the number of pairs of elements of @xmath599 whose images can potentially arise as chords of any cycle in any @xmath635 .",
    "thus we will have found an @xmath657 such that the gaifman graph of @xmath658 contains no chordless cycles , viz.it is chordal , whence the same can be said of its image in @xmath402 .",
    "given that , by proposition  [ prop_conformality ] , @xmath402 is @xmath19-conformal , it follows that the @xmath659-image of @xmath658 in @xmath402 is contained in an acyclic ( not - necessarily induced ) sub - structure @xmath223 of @xmath402 .",
    "relying on theorem  [ thrm_main ] one can show that @xmath295 answering against @xmath5and even against @xmath87sentences is finitely controllable .",
    "the sharper theorem  [ thrm_main_from_gbis_invariant ] also yields optimal upper bounds on the minimal size of finite models for each of these fragments as expressed in theorems  [ thrm_fincontrol ]  &  [ thrm_small_models ] below .",
    "matching lower bounds are implicit in @xcite .    for every @xmath297 and every @xmath89 : @xmath660 more specifically ,",
    "if @xmath91 is satisfiable then it has a finite model of size @xmath92 , where @xmath93 is the height of @xmath0 , @xmath94 is the signature of @xmath1 , and @xmath75 the width of @xmath94 .",
    "recall the properties of @xmath77 from lemma  [ lemma_treeification ] .",
    "we establish the claim by proving the following equivalences . @xmath661",
    "the first equivalence was proved in lemma  [ lemma_treeification ]  ( ii ) and the second equivalence follows from the finite model property of the guarded fragment .",
    "also @xmath662 is a trivial consequence of @xmath663 .",
    "it remains to be seen that @xmath664 implies @xmath665 .",
    "note that @xmath664 is the same as @xmath666 thanks to the finite model property of @xmath6 .",
    "so assume that @xmath78 is satisfiable .",
    "then , by proposition  [ prop_satcrit ] , there is some invariant @xmath182 satisfying the scott normal form @xmath131 of @xmath1 as in lemma  [ lemma_normalform ] .",
    "let @xmath93 be the height of @xmath0 , viz .",
    "the maximal size of its consituent @xmath229 . applying theorem  [ thrm_main_from_gbis_invariant ] on input",
    "@xmath182 with @xmath667 we obtain finite models @xmath668 and @xmath669 of @xmath78 , with @xmath669 a weakly @xmath19-acyclic cover of @xmath668 .",
    "from fact  [ fact_covers_and_treeification ] it then follows that @xmath670 .",
    "this concludes the proof of finite controllability .    according to theorem  [ thrm_main_from_gbis_invariant ] , @xmath671 , where @xmath75 is the width of the signature @xmath94 . from proposition  [ prop_satcrit ]",
    "it follows that @xmath672 is bounded by the number of atomic types in the signature of @xmath131 , which is of the order @xmath673 .",
    "finally , lemma  [ lemma_treeification ]  ( iii ) gives @xmath674 .",
    "putting it all together we obtain the estimate @xmath675 as claimed .",
    "naturally , both the size and the width of the signature of a @xmath5-formula are bounded by its length .",
    "it is thus easy to see how the above statement of theorem  [ thrm_fincontrol ] implies that given in the introduction . in particular , we observe the following corollaries",
    ".    for every @xmath99 , every satisfiable sentence of the @xmath99-variable guarded fragment has finite models of exponential size in the length of the formula .    for a finite set @xmath676 of @xmath94-structures",
    "let @xmath677 denote the class of those @xmath94-structures not allowing a homomorphic image of any member of @xmath676 .",
    "if a guarded sentence @xmath1 has a model in @xmath677 then it also has one of size @xmath678 .",
    "another corollary is the validity of the uniform interpolation property for @xmath5and the positive existential fragment also in the finite model semantics .",
    "consider some @xmath297 and @xmath89 in signature @xmath94 . then @xmath679      the above results easily carry over to the clique - guarded fragment with essentially the same bounds . in (",
    "* section 3.3 ) a reduction of the ( finite ) satisfiability problem for @xmath137 to the ( finite ) satisfiability problem for @xmath6 is presented .",
    "we borrow their idea with some adaptations to keep the blow - up in formula size to a minimum .",
    "our reduction maps a given clique - guarded sentence @xmath680 $ ] to a guarded sentence @xmath681 $ ] , where @xmath174 is a fresh relation symbols of arity @xmath682 .",
    "first , we translate @xmath1 to @xmath683 by replacing each clique - guarded quantifier occurring in @xmath1 according to the pattern is to be understood as referring to the padding of @xmath684 to a @xmath75-tuple , say , by repeated occurrences of the last variable of the tuple @xmath685 .",
    "this is merely to render @xmath686 a well - formed atom ; in the context of the actual choice of padding has no import . ]",
    "@xmath687 '   & = &     ( \\exists { { \\overline{{y}}}}.g({{\\overline{{x}}}}{{\\overline{{y}}}}))\\ , \\bigl ( \\alpha({{\\overline{{x}}}}{{\\overline{{y } } } } ) \\land \\psi ' \\bigr ) \\\\    \\left[\\,(\\forall { { \\overline{{y}}}}.\\alpha({{\\overline{{x}}}}{{\\overline{{y } } } } ) ) \\,\\psi\\,\\right ] '   & = &     ( \\forall { { \\overline{{y}}}}.g({{\\overline{{x}}}}{{\\overline{{y}}}}))\\ ,   \\bigl ( \\alpha({{\\overline{{x}}}}{{\\overline{{y } } } } ) { \\rightarrow}\\psi ' \\bigr ) \\end{array}\\ ] ] otherwise trivially commuting with boolean connectives .",
    "the intended role of @xmath688 is to reflect guardedness of @xmath689 in the expanded signature @xmath690 .",
    "accordingly , @xmath691 is defined as the conjunction of @xmath683 and @xmath692 where @xmath693 ranges over @xmath690 and @xmath689 and @xmath526 are of the appropriate arity such that all variables in @xmath526 also occur in @xmath689 .",
    "the following properties of this translation are readily verified .    1 .   [ fact_cgf2gf_1 ] @xmath694 where @xmath75 is as above .",
    "[ fact_cgf2gf_2 ] every model of @xmath1 can be expanded to a model of @xmath691 by interpreting @xmath174 as the universal relation of arity @xmath75 .",
    "3 .   [ fact_cgf2gf_3 ]",
    "every _ conformal _ model of @xmath691 is also a model of @xmath1 : in conformal models every clique - guarded tuple is also guarded and hence , by , guarded by a @xmath174-atom .",
    "all conformal models of thus satisfy @xmath695 for every clique - guard @xmath41 and , therefore , also @xmath696 .",
    "these properties enable us to extend the scope of the reduction from mere satisfiability ( in the finite ) to the more general query entailment problem ( in the finite ) .",
    "[ lemma_cgf2gf_qa ] let @xmath88 and @xmath89 be arbitrary , and let @xmath697 be the translation of @xmath1 as explained above",
    ". then @xmath698    assume first that @xmath699 and let @xmath67 be a ( finite ) model of @xmath1 .",
    "then , by property  ( [ fact_cgf2gf_2 ] ) of the translation , @xmath67 has an expansion @xmath700 .",
    "obviously , @xmath81 is finite whenever @xmath67 is finite .",
    "so by assumption , @xmath701 , which trivially implies @xmath702 , given that the interpretation of @xmath174 has no bearing on @xmath0 .",
    "assume now that @xmath703 and take any ( finite ) model @xmath704 .",
    "let @xmath705 , and let @xmath706 be the @xmath19-th rosati cover of @xmath68 as in theorem  [ thrm_main ] for @xmath707 . then @xmath708",
    "furthermore , @xmath706 is @xmath19-conformal and hence also conformal , since @xmath709 .",
    "therefore , by property ( [ fact_cgf2gf_3 ] ) of the translation , we have @xmath710 , and so , by assumption , @xmath711 , since @xmath706 is finite whenever @xmath68 is finite .",
    "then , according to fact  [ fact_covers_and_treeification ] , @xmath712 , and via lemma  [ lemma_treeification ] item  ( ii ) we conclude that @xmath713 .    combining the above with theorem  [ thrm_fincontrol ] yields its generalisation to",
    "@xmath87as follows .    for every @xmath88 and every @xmath89 we have @xmath90 . more specifically ,",
    "if @xmath91 is satisfiable then it has a finite model of size @xmath92 , where @xmath93 is the height of @xmath0 , @xmath94 is the signature of @xmath1 , and @xmath95 .",
    "theorem  [ thrm_fincontrol ] together with lemma  [ lemma_cgf2gf_qa ] provide the following chain of equivalences @xmath714 proving the first assertion . towards the size bound ,",
    "if @xmath64 is satisfiable then , by lemma  [ lemma_cgf2gf_qa ] , so is @xmath715 .",
    "recall that @xmath694 by property   of the translation . according to theorem  [ thrm_fincontrol ]",
    ", there exists a model @xmath68 of @xmath715 of size @xmath716 finally , as in the proof of lemma  [ lemma_cgf2gf_qa ] we construct the model @xmath706 of @xmath64 by taking the @xmath19-th rosati cover of @xmath68 with @xmath717 . by theorem  [ thrm_main ] , @xmath718 , which is still of the same order of magnitude @xmath719 as @xmath720 , as claimed .",
    "theorem  [ thrm_small_models ] as announced in the introduction is a straightforward corollary of the above .",
    "in this paper _ query answering _ is the problem of deciding @xmath12 for a given @xmath297 and @xmath0 a @xmath11 . by lemma  [ lemma_treeification ]  ( ii )",
    "this amounts to testing unsatisfiability of the guarded sentence @xmath78 , known to be @xmath7-complete and in dtime(@xmath721 ) , where @xmath153 is the size and @xmath75 the width of @xmath94 @xcite . with these parameters for @xmath94 recall from lemma  [ lemma_treeification ] that @xmath722 and that @xmath251 is computable in time @xmath723 for any @xmath11@xmath0 of height @xmath93 .",
    "query answering is thus @xmath7-complete , even for a fixed query , and in dtime(@xmath724 ) .",
    "notice that there is a double - exponential dependence only in terms of the height @xmath93 of queries and the width @xmath75 of the signature .",
    "under increasing constraints on the variability of signatures we can break down and simplify the time complexity as follows :    * @xmath725 under no restrictions on @xmath0 nor on @xmath1 nor on @xmath94 ; * @xmath726 without restrictions but highlighting the influence of query height ; * @xmath727 when the width of @xmath94 is bounded ( a matching double - exponential lower bound in this case follows from the work of lutz @xcite ) ; * @xmath728 for any fixed signature @xmath94 ( for this case we provide a single - exponential lower bound as stated in theorem  [ thrm_complexity ] and proved in proposition  [ prop_exptime ] below ) ; * @xmath729 for queries of bounded height and over signatures of bounded width ;    in @xcite lutz considered the query answering problem against specifications in various description logics , among them a certain @xmath730 , which can be naturally seen as a fragment of @xmath5 .",
    "lutz proved that answering @xmath10 against @xmath730 specifications is @xmath7-complete . given that description logics are interpreted over relational structures involving unary and binary predicates only , this implies that query answering against @xmath5is @xmath7-complete already for @xmath10and on signatures of width two .",
    "a further important particular case is that of _ acyclic queries_. below @xmath731are unions of acylcic boolean conjunctive queries .",
    "observe that for @xmath0 an @xmath731the exponential blow - up in passing from @xmath0 to @xmath251 can be avoided by rewriting @xmath0 as a guarded existential sentence @xmath732 of essentially the same length as @xmath0 .",
    "query answering for @xmath731reduces in polynomial time to @xmath5-satisfiability . regarding query answering against a fixed @xmath297",
    "we thus find that for @xmath731the complexity reduces to @xmath8 .",
    "in fact , it can also be shown to be @xmath8-complete for certain @xmath1 , cf .",
    "proposition  [ prop_exptime ] below .",
    "+ for a fixed @xmath733 $ ] _ target query answering _ is the problem of deciding @xmath734 on input @xmath0 a @xmath11 and @xmath25 a @xmath94-structure ( given as a conjunction of ground atoms with elements of @xmath25 as individual constants ) .",
    "the next theorem summarises our observations on query answering and some results on subproblems of target query answering .",
    "+     [ thrm_complexity ]    1 .",
    "deciding @xmath12 , on input @xmath297 and @xmath0 a @xmath11 , is @xmath7-complete already for a fixed query @xmath0  @xcite , or with the width of @xmath1 bounded and @xmath0 a @xmath10  @xcite .",
    "2 .   for each @xmath297 , deciding @xmath12 on input @xmath0 an @xmath731is in exptime ; and it is @xmath8-complete for certain @xmath1 .",
    "3 .   there is a @xmath6-sentence @xmath131 such that deciding @xmath735 , on input @xmath235 a @xmath10and @xmath25 a conjunction of atoms _ of bounded width _ , is pspace - hard .",
    "4 .   for all",
    "_ universal _",
    "@xmath736 , deciding @xmath734 , on input @xmath0 a @xmath11and @xmath25 a conjunction of atoms , is in @xmath737 ; and for certain _ universal _ @xmath131 it is @xmath737-complete already for @xmath229@xmath0 . 5 .   for all @xmath736 and @xmath0",
    "a @xmath11 , deciding @xmath734 on input @xmath25 , is in _ co - np _ and _ co - np_-complete already for @xmath738 and certain _ universal _ @xmath131 .",
    "hence , satisfiability of @xmath739 on input @xmath25 is in np , and is np - complete for certain _ universal _ @xmath736 .    observe that item ( 2 ) implies that satisfiability for @xmath6 can be @xmath8-complete already for a fixed signature , see proposition  [ prop_exptime ] below .",
    "this strengthens a result of @xcite , where @xmath8-completeness of satisfiability was shown for @xmath5formulas over bounded arity but variable signatures .",
    "[ coroll_exptime ] for some relational signature @xmath94 satisfiability for @xmath740 $ ] is @xmath8-complete .",
    "note that item ( 1 ) is but a restatement of results of grdel @xcite and lutz @xcite , listed here for the sake of completeness .",
    "similarly , the upper bound in item ( 2 ) is a consequence of @xcite as remarked at the beginning of this section .",
    "we prove each of the remaining claims separately in the propositions to follow .",
    "[ prop_exptime ] there is a @xmath6-sentence @xmath1 such that deciding @xmath741 for @xmath731 @xmath235 is @xmath8-hard .",
    "it is well known that deterministic exponential time equals alternating polynomial space .",
    "we show how to encode the behaviour of polynomial - space alternating turing machines into the query answering problem over a fixed formula . the formula @xmath1 in question will merely provide the means of alternation blindly generating all trees potentially suitable for encoding any strategy of the existential player in any alternating run of any atm on any input .",
    "then , for any given atm @xmath36 and input @xmath75 we craft an appropriate @xmath11@xmath742 comprising as disjuncts various conjunctive queries , each matching a different source of error in the encoding of the behaviour or acceptance of @xmath36 on input @xmath75 .",
    "ultimately the goal is to have @xmath743 if , and only if , @xmath36 has no accepting run on @xmath75 , i.e. , if the existential player has no winning strategy in the game corresponding to the computation of @xmath36 on input @xmath75 .    by standard arguments we may restrict attention to normalised atm in which universal and existential states alternate in any run , which have a single universal initial state , disjoint sets of accepting and rejecting states , and every configuration of which has precisely two successor configurations ( including accepting and rejecting configurations , which have only accepting or rejecting successor configurations , respectively ) .",
    "moreover we may assume that on each input of length @xmath155 the run of the normalised atm uses precisely @xmath744 amount of space for a polynomial @xmath745 .",
    "let @xmath1 be the conjunction of the following guarded formulas , where @xmath746 denotes exclusive or .",
    "@xmath747 intuitively speaking , every model of @xmath1 ( or rather its guarded unravelling ) represents a tree whose vertices correspond to instances of the variables @xmath748 and @xmath749 in the above formulation .",
    "there are three kinds of vertices : plain @xmath750-vertices , the root @xmath693-vertex and @xmath240-vertices .",
    "each vertex represents a bit , hence the letter @xmath750 , whose value is either @xmath751 or @xmath50 as witnessed by the predicates of the same name .",
    "there are four kinds of successor edges in every such tree corresponding to a model of @xmath1 : @xmath186,@xmath676,@xmath752 and @xmath753-successors .",
    "every vertex is either a @xmath240-vertex or it has an @xmath186-successor .",
    "the intention is that maximal @xmath186-successor chains connecting @xmath240-vertices encode individual configurations . in this sense",
    "a @xmath240-vertex is a terminal vertex of the configuration it belongs to and encodes its last bit .",
    "the predicates @xmath37 and @xmath754 mark whether the state of a given configuration is existential or universal , respectively .",
    "all vertices belonging to the same configuration ( in between consecutive @xmath240-vertices ) carry the same @xmath37 or @xmath754 marking , which is passed down along @xmath186-edges .",
    "a @xmath240-vertex terminating a configuration in an existential state has an @xmath676-successor vertex beginning a new configuration .",
    "a @xmath240-vertex belonging to a configuration with a universal state has both an @xmath752- and an @xmath753-successor vertex , each starting a successor configurations .",
    "note that for query answering one can always restrict attention to _ minimal models _ of @xmath1 , which have only one @xmath693-vertex and at any vertex have at most one successor of whatever kind required and no other kind of successor vertices , and every vertex of which is reachable from the @xmath693-vertex via a sequence of overlapping @xmath186- , @xmath676- , @xmath752- and @xmath753-atoms . minimal models of @xmath1 are well suited to encode strategies of the existential player in any game determined by a normalised atm and an input word .    using the framework provided by ( minimal ) models of @xmath1",
    "the power of unions of conjunctive queries suffices to filter out those models that do _ not _ represent a winning strategy for the existential player in the game defined by a given atm @xmath36 on a given input @xmath75 . to demonstrate this we must first choose an appropriate encoding of turing machine configurations .",
    "as is customary we write @xmath755 for the configuration with tape contents @xmath756 when the machine is in state @xmath0 and its head is positioned on the first letter of @xmath42 .",
    "the tape alphabet is binary , i.e.  @xmath757 .",
    "a configuration @xmath755 will be encoded as a bit string @xmath758 , where @xmath759 = \\alpha[i]$ ] and @xmath760 = 0 $ ] for all @xmath761 , and similarly for @xmath42 and @xmath762 , and where @xmath763 if @xmath0 is the @xmath343-th of the @xmath153 many states of @xmath36 in some fixed enumeration . in brief : the state is encoded in unary interleaved with @xmath312 digits at the point of the head position and around it",
    "the tape contents are interleaved with @xmath764 digits to clearly identify the position where the state is encoded .",
    "let @xmath36 have @xmath153 states and use precisely @xmath765-space on inputs of size @xmath766 .",
    "the query @xmath742 will then consist of a disjunction of acyclic conjunctive queries ( each of size @xmath767 exhausting the reasons a model of @xmath1 could fail to encode a winning strategy for the existential player in the game of @xmath36 on @xmath75 :    * @xmath229asserting the existence of an @xmath186-successor chain connecting @xmath240-vertices too short to represent a configuration , or the existence of too long an @xmath186-successor chain : + @xmath768 for @xmath769 and similarly with @xmath770 and @xmath771 or @xmath772 in place of @xmath773 , and @xmath774 * @xmath229asserting that on odd positions of a maximal @xmath186-successor chain the bit values do not constitute a word in @xmath775 : @xmath776 for @xmath777 , along with @xmath778 etc . * @xmath229asserting that the configuration beginning with the root vertex is not the initial configuration for the given input word : one @xmath229for each bit in the encoding of the initial configuration looking for a wrong bit value , such as @xmath779 for @xmath780 odd or @xmath781 for @xmath782 odd , and ( assuming for simplicity that the initial state is the @xmath312st one ) for @xmath783 even ; further @xmath784 for @xmath785=1 $ ] and similarly for @xmath785=0 $ ] ; * @xmath229checking that consecutive @xmath186-successor chains do not represent successor configurations , e.g. , by asserting that in a given tape position not under the head of the atm the bit values in the two configurations are not identical : for instance as in @xmath786 and , similarly , with @xmath787 or @xmath788 in place of @xmath789 and with the bit values at corresponding positions @xmath790 and @xmath791 swapped , and all this for each @xmath792 ; * @xmath229asserting that the @xmath793-successor configuration of a universal configuration was not derived by the @xmath285-th of the two applicable transitions ; * @xmath229asserting the existence of a configuration in reject state : @xmath794 for each rejecting state @xmath0 .",
    "much as those examples illustrated above , all of the flaws in the encoding of an accepting run can likewise be expressed using acyclic conjunctive queries , polynomially many in total , and each of size @xmath795 .",
    "[ prop_pspace ] there is a @xmath6-sentence @xmath131 ( using constants ) such that deciding @xmath735 on input @xmath235 a @xmath10and @xmath25 a conjunction of atoms ( of bounded width ) is pspace - hard .",
    "the proof is by reduction from qbf .",
    "we may assume that the qbf instances are sentences in prenex normal form @xmath796 with @xmath797 a 3cnf - formula with free variables among @xmath798 .",
    "to represent `` valuation strategies '' for the existentially quantified variables we use a variant of the formula  . on the one hand ,",
    "the encoding is greatly simplified to single bit `` configurations '' representing boolean values . on the other hand ,",
    "boolean values need to be encoded as elements of the domain of models to allow for a stronger form of pattern matching . to that end",
    "we rely on constants @xmath764 and @xmath312 and encode bit values using a binary predicate @xmath799 where @xmath646 is either @xmath764 or @xmath312 .",
    "let @xmath131 be the conjunction of the following ( where , again , @xmath746 stands for exclusive or ) .",
    "@xmath800 we may think of models of @xmath131 ( more precisely their guarded unravelling ) as representing infinite boolean valuation trees with all possible assignments encoded at every odd level and encoding a choice of a boolean value at each node at an even distance from the root . in minimal models of @xmath131 nodes at even levels ( those marked with @xmath754 ) have precisely two successors representing the two boolean values , whereas all nodes at odd levels ( marked with @xmath37 ) have precisely one successor representing an existential choice of a boolean value .",
    "for the encoding of boolean valuations of the variables of   only the first @xmath801 levels of these trees will play a role .    for each q3cnf formula with matrix @xmath797 consisting of @xmath99 clauses we assign an input data structure @xmath802 defined as the conjunction",
    "@xmath803 together with the conjunction of atoms @xmath804 for all @xmath805 and @xmath806 and @xmath807 such that setting @xmath808 to @xmath646 does _ not _ satisfy the @xmath285-th clause .",
    "the elements @xmath809 and @xmath810 of the `` database '' @xmath802 are perceived as constants , however , unlike @xmath764 and @xmath312 , in @xmath131 they are not accessible by ( constant ) names .    as in the proof of proposition  [ prop_exptime ] we design queries @xmath811 to hold true in a model precisely when it contains a branch corresponding to an assignment of the variables falsifying ( one of the clauses in ) @xmath797 .",
    "in fact , we use @xmath811 merely as a general clause checking pattern , hence our reduction will use the same query @xmath812 for every q3cnf formula with @xmath801 alternately quantified variables : @xmath813 in other words , the query @xmath814 matches the variables @xmath140 to the corresponding constants @xmath815 of @xmath25 and the variables @xmath685 to a single branch in any given model of @xmath739 and @xmath689 to the sequence of boolean values assigned to the variables @xmath816 on that branch",
    ". then @xmath814 is satisfied in a given model ( which encodes a particular choice of skolem functions for the existentially quantified variables @xmath817 ) iff there is a clause @xmath66 that is falsified by an assignment to the universally quantified variables corresponding to some path within the model .",
    "therefore , @xmath814 is true in all models of @xmath818 iff is false .",
    "[ prop_piptwo ] the problem of deciding @xmath735 for a fixed universal @xmath6 sentence @xmath131 on input consisting of a conjunction of atoms @xmath25 and a @xmath11@xmath235 is in @xmath737 for each @xmath131 , and for some @xmath131 is @xmath737-complete already for @xmath10 @xmath235 .    as in the previous propositions we may restrict attention to minimal models of @xmath739 as regards query answering .",
    "note that now , due to the universality of @xmath131 , all minimal models of @xmath739 have the same universe as @xmath25 .",
    "hence , to check @xmath735 , one merely has to universally choose a model of @xmath131 on the universe of @xmath25 and existentially guess elements realising @xmath235 in the model chosen .",
    "this involves first universally choosing then existentially guessing a polynomial number of bits in terms of @xmath819 , whence membership in @xmath737 .",
    "we show @xmath737-hardness by reduction from the validity problem for quantified propositional formulas of the form @xmath820 with @xmath797 a 3cnf formula with free variables @xmath821 .    in the input structure",
    "@xmath822 the universally quantified variables @xmath823 are encoded as a successor chain @xmath824 along with the entire table of satisfying assignments of each of the three - literal clauses @xmath825 the formula @xmath131 is devised so that ( minimal ) models of @xmath739 will correspond to all possible assignments of the variables @xmath823 , for whatever @xmath155 .",
    "we set @xmath826 finally , we use the query @xmath811 to guess boolean values for the existentially quantified variables @xmath827 and to test satisfaction of @xmath797 by checking all triplets of boolean values for variables occurring together in a clause against the truth table of the type of that clause .",
    "let @xmath828 it is now easy to verify that @xmath829 iff @xmath830 is valid .",
    "[ prop_np ] for any fixed @xmath736 and input @xmath25 a conjunction of atoms , satisfiability of @xmath739 is in np and is np - complete for certain universal @xmath131 .",
    "deciding @xmath735 on input @xmath25 for any fixed @xmath131 as before and fixed @xmath11@xmath235 is in co - np ; and it is co - np - complete already for @xmath831 and certain universal @xmath131 .    to test satisfiability of @xmath739 for a fixed @xmath131 one can pre -",
    "compute the scott normal form @xmath832 of @xmath131 as in , as well as the set of admissible guarded atomic types in its signature , i.e.  those atomic types that can be realised in some model of @xmath832 .",
    "having done that , for each given input @xmath25 it remains to be verified that its atoms can be assigned admissible atomic types wrt .",
    "@xmath832 such that ( i ) the type assigned to each atom actually contains that atom ; ( ii ) overlapping atoms are assigned consistent types restricted to their overlap ; and ( iii ) the resulting structure satisfies @xmath832 .",
    "such an assignment can be guessed and verified in np .",
    "to show np - hardness of satisfiability of @xmath739 for an appropriate @xmath131 observe that @xmath110-colourability of graphs can be directly formalised within this problem .",
    "every simple graph @xmath833 can be identified with the conjunction @xmath834 with vertices @xmath835 perceived as distinct constants .",
    "then @xmath174 is @xmath110-colourable iff @xmath836 is satisfiable , where @xmath837    turning to the problem @xmath735 for fixed @xmath131 and @xmath235 and input @xmath25 , note that this is equivalent to the unsatisfiability of @xmath838 , where @xmath839 is the `` treeification '' of @xmath235 , that can now be precomputed since @xmath235 is fixed .",
    "thus , by the above argument , @xmath735 on input @xmath25 can be verified in co - np for any fixed @xmath131 and @xmath235 ; and it is co - np - complete for @xmath131 of and @xmath831 .",
    "the abstract version of the _ capturing ptime problem _ asks for an effective ( recursive , syntactic ) representation of all polynomial - time computable boolean queries over finite relational structures .",
    "the core problem is not so much the effective representation of the class of all polynomial - time algorithms , which is easy via polynomially clocked turing machines , say .",
    "rather it lies in the requirement that these machines or algorithms must represent _ queries _ on finite structures , i.e. , they need to respect isomorphism in the sense of producing the same answer on isomorphic structures ( or on inputs that represent isomorphic structures ) . in notation to be used below , we indicate this constraint explicitly in writing @xmath840 for the set of those @xmath24algorithms that respect isomorphism .",
    "this undecidable semantic constraint is almost trivially enforcible and therefore mostly goes unnoticed when dealing with queries on _ linearly ordered _ finite structures .",
    "this is because there is an obvious canonisation procedure on the class of all linearly ordered @xmath841-structures ( we let @xmath842 be the distinguished binary relation that is interpreted as a linear ordering in the class @xmath843 of all linearly ordered finite @xmath841-structures ) .    by _ canonisation _",
    "( w.r.t .",
    "isomorphism over @xmath844 ) we here mean a map @xmath845 such that @xmath846 and @xmath847 whenever @xmath848 . indeed , for @xmath849 we may just identify the linearly ordered universe of @xmath67 , @xmath850 , with an initial segment of @xmath851 to obtain such a canonical representative of the isomorphism type of @xmath67",
    ". then the application of arbitrary polynomial time decision procedures to @xmath116 for @xmath849  i.e. , the application of semantically unconstrained algorithms after pre - processing with @xmath852  provides an effective representation of the class of all polynomial time computable boolean queries on @xmath844 .",
    "it is well known from the fundamental results of immerman  @xcite and vardi  @xcite that this abstract capturing result finds a concrete logical counterpart in the logics @xmath853(least fixpoint logic ) and @xmath854(inductive fixpoint logic ) . the open question whether @xmath24may also be captured , abstractly or by some suitable logic , over all not necessarily ordered finite structures has driven much of the development of descriptive complexity in finite model theory .",
    "interesting variations of this question concern      we point to the work of grohe and his survey  @xcite for successes with larger and larger natural classes of structures in the sense of  ( a ) , and to  @xcite for a very simple but interesting capturing result in the sense of  ( b ) concerning bisimulation - invariant @xmath24(@xmath856 ) .",
    "the class @xmath856 consists of those @xmath24boolean queries that respect bisimulation equivalence ; it can be regarded as the class of @xmath24queries in the modal world . in that case",
    ", canonisation is obtained through passage to a definably ordered version of the bisimulation quotient of the given structure , @xmath857 where @xmath858 such that @xmath859 is trivially satisfied . for reasons indicated above , the distinction between ( canonical ) standard representations and definably linearly ordered versions of structures is often blurred , and in fact immaterial for our concerns .",
    "hence we may avoid explicit passage to a standard representation of a linearly ordered structure like @xmath860 and seemingly weaken the requirement that @xmath861 for @xmath862 to @xmath863 .    a polynomial time canonisation procedure @xmath864 w.r.t .",
    "some equivalence @xmath865 ( on  @xmath844 ) will always yield an abstract capturing result for the class of all @xmath24computable boolean queries on finite structures from @xmath844 that respect @xmath865 , which we denote by @xmath866 ( over  @xmath844 ) . since pre - processing with the canonisation procedure",
    "can be performed in @xmath24and enforces @xmath865-invariance , it can be coupled with any effective representation of otherwise unconstrained @xmath24decision algorithms to capture @xmath866 : @xmath867 in a notation that suggests how canonisation acts as a filter to guarantee the required semantic invariance . if canonisation produces linearly ordered output structures , which we indicate notationally as in @xmath868 , then @xmath866 is in fact captured by @xmath853or @xmath854over the canonisation results by the immerman ",
    "vardi theorem : @xmath869    in the case of @xmath856 , @xcite correspondingly translates the abstract capturing result into capturing by a suitable extension of the modal @xmath870-calculus , which exactly matches the expressive power of @xmath853 over the ( internally interpretable ) linearly ordered canonisations @xmath871 indicated above .    here",
    "we primarily want to provide an abstract capturing result for @xmath114-invariant @xmath24 , @xmath872 , which corresponds to @xmath24 in the guarded world .",
    "this is achieved through a polynomial canonisation w.r.t .  guarded bisimulation equivalence which produces ( definably ) linearly ordered representatives of the complete guarded bisimulation types of given finite relational structures .",
    "this canonisation may be of interest beyond our application to the capturing issue . the proposed canonisation produces linearly ordered output structures @xmath873 that are uniformly interpretable over powers of the original structures @xmath67 in @xmath854and @xmath853 in a @xmath114-invariant manner .",
    "an adaptation of the approach of  @xcite therefore also entails a concrete logical capturing result by means of some higher - dimensional guarded fixpoint logic , but we do not pursue this here .",
    "we fix some terminology , similar to the one discussed e.g.  in  @xcite , which makes sense for arbitrary equivalences @xmath865 between structures ; we are going to use these notions solely with reference to guarded bisimulation equivalence .      1 .",
    "a _ complete invariant @xmath874 _ for @xmath865 on @xmath844 ( with values in some set @xmath875 ) is a map @xmath876 such that @xmath877 for all @xmath878 . or @xmath879 to indicate an invariant or canonisation that produces as output some relational structure , which is ( definably ) linearly ordered .",
    "in this context we relax e.g.  the condition @xmath877 to @xmath880 without any loss . ] 2 .",
    "an _ inversion of the invariant @xmath874 _ is then a map @xmath881 that acts as a right inverse to @xmath874 : @xmath882 , or , equivalently , @xmath883 for all @xmath884 .",
    "canonisation _ w.r.t .",
    "@xmath865 over @xmath844 is a map @xmath885 such that @xmath886 and @xmath847 for all @xmath878 .",
    "note that canonisations are complete invariants whose values are structures of the original kind while an invariant in general may produce values of a different format .",
    "clearly an inversion of an invariant always yields a canonisation of the form @xmath887 .",
    "note also that ( 1 ) says that @xmath865 is induced by equality of @xmath874-images .",
    "guarded bisimulation equivalence on finite relational structures admits @xmath24canonisation .",
    "more specifically , definably linearly ordered versions of the guarded bisimulation game invariants @xmath888 discussed above are @xmath24computable complete invariants w.r.t .",
    "@xmath114 and admit @xmath24inversions @xmath676 such that @xmath889 produces linearly ordered representatives from the @xmath114-class of every finite relational structure @xmath67 .",
    "the values of both maps , @xmath890 and @xmath873 are uniformly @xmath854- and @xmath853-interpretable as ordered quotients over @xmath891 in a @xmath114-invariant manner , for fixed relational vocabulary @xmath94 of width @xmath75 .",
    "we fix a finite relational vocabulary @xmath94 of width @xmath75 . for a finite @xmath94-structure @xmath67 ,",
    "we let @xmath893 be the set of all maximal guarded tuples of @xmath67 ( with repetitions of components where appropriate , to uniformly pad tuples to arity @xmath75 ) .",
    "the guarded bisimulation game graph @xmath157 introduced in section  [ sec_prelim ] has @xmath158 as its set of vertices , unary predicates for atomic types , and edge relations @xmath894 for the set @xmath26 of all partial bijections @xmath895 , where @xmath896    the guarded bisimulation invariant @xmath897 , as discussed in section  [ sec_prelim ] , is obtained as the quotient of this game graph w.r.t .",
    "_ modal _ bisimulation equivalence .- equivalence classes of vertices in @xmath157 are precisely the @xmath114-equivalence classes of the maximal guarded tuples in @xmath158 . ]",
    "passage from @xmath67 to this quotient @xmath115 almost provides a complete invariant for @xmath114 in the sense of definition  [ invcandef ] , but not quite : clearly @xmath120 implies @xmath898 and hence @xmath899 , but not @xmath877 as required . as discussed above , this defect is overcome as soon as we provide a definable linear ordering of the universes @xmath900 of @xmath115 and thus turn them into linearly ordered complete invariants @xmath888 .",
    "such a definable linear ordering can be obtained in an inductive refinement process , which produces a sequence of pre - orderings @xmath901 on @xmath158 .",
    "this refinement process starts from an arbitrary but fixed ordering of the finite set of atomic types of @xmath75-tuples , which is uniformly imposed as a global pre - order so that @xmath902 i.e. , the equivalence relation induced by @xmath903 is atomic equivalence , which is @xmath904-equivalence , of maximal guarded tuples . in other words",
    ", @xmath905 uniformly defines a linear ordering of the quotient @xmath906 ( or , equivalently , of @xmath907 in terms of modal bisimulation ) .",
    "the refinement proceeds in such a manner that each level @xmath901 induces a linear ordering of the quotient @xmath908 ( or @xmath909 ) .",
    "then the inductive fixpoint of this refinement sequence produces a pre - ordering @xmath264 that linearly orders the quotient @xmath900 ( or @xmath910 ) and thus yields the desired @xmath890 .",
    "besides @xmath903 we fix an arbitrary ordering on the set @xmath26 of edge labels in the game graphs @xmath157 .",
    "for @xmath911 we define boolean incidence functions @xmath912 for @xmath913 and @xmath914 according to @xmath915    note that the @xmath912-value precisely describes the existence or non - existence of a move along a @xmath163-edge to a position in the @xmath916-class @xmath42 .",
    "a simple analysis of one round in the guarded bisimulation game shows that @xmath917      let @xmath919 be the linearly ordered version of the quotient of the guarded bisimulation game graph @xmath157 described above .",
    "we now refer to this linearly ordered structure as the _ ordered guarded - bisimulation invariant of @xmath67 . _    the following is then immediate from the preceding discussion and the fact that the inductive refinement process outlined above is naturally captured as an inductive fixpoint ( in the sense of inductive fixpoint logic @xmath854 ) , and hence , buy the gurevich  shelah theorem also by a least fixpoint process ( in the sense of least fixpoint logic @xmath853 ) .",
    "@xmath920 provides a complete invariant w.r.t .",
    "guarded bisimulation equivalence on the class of all finite @xmath94-structures .",
    "moreover , @xmath890 is @xmath24computable from @xmath67 and uniformly interpretable in a @xmath114-invariant manner as a quotient over @xmath891 , where @xmath75 is the width of @xmath94 , in @xmath854and @xmath853 .    in order to prove theorem  [ thrm_canon ] and , as our main goal , the abstract capturing result of corollary  [ capcor ]",
    ", it therefore suffices to provide a @xmath24computable ( and hence also @xmath854- and @xmath853-interpretable ) inversion for the complete invariant @xmath920 .",
    "this , in combination with @xmath920 , produces a @xmath24computable ( and automatically @xmath854- and @xmath853-interpretable ) canonisation as follows : @xmath921^{{{\\mathrm{can}}}^ < } \\ar@{|->}[rr]^{{{\\mathbb{i}}}^ < } & &     * + + { { { \\mathbb{i}}}^<({\\mathfrak{a } } ) } \\ar@{|->}[rr]^{f^ < } & &    * + + { \\makebox(1,1)[l]{${{\\mathrm{can}}}^<({\\mathfrak{a } } ) = f^<({{\\mathbb{i}}}^<({\\mathfrak{a } } ) ) = ( { { \\mathrm{can}}}({\\mathfrak{a}}),<)$ } } } \\rule{6cm}{0pt } \\ ] ]      in fact , we obtain @xmath873 as an ordered version of the rosati cover @xmath922 obtained from an ordered version of @xmath115 . indeed , from theorem  [ thrm_main_from_gbis_invariant ] we already know that @xmath923 is a suitable candidate for inverting an ordered guarded bisimulation invariant @xmath924 , because @xmath925 .",
    "it remains to define a canonical linear ordering of the rosati cover .",
    "this is a trivial exercise given the term structure of the elements of @xmath926 .",
    "first , using the linear order of a given invariant @xmath924 and the standard ordering of natural numbers we define a linear ordering of constants @xmath332 , say , in a lexicographic manner applied to the corresponding tuples @xmath927 .",
    "we also fix a similarly defined ordering of all function symbols @xmath333 arising from @xmath182 as introduced in section  [ sec_rosatidef ] .",
    "it is then straighforward to extend these to a linear ordering of all terms ( of depth @xmath101 in the case of @xmath923 ) by stipulating that constants , i.e.  terms of height zero precede all terms of height one , which in turn precede all terms of height two in the ordering ; and that terms of the same height are ordered first according to their root function symbols , then according to their sets of subterms inductively .",
    "it is apparent that such an ordering of @xmath923 can be computed in polynomial time given the ordered invariant @xmath924 .",
    "hence @xmath928 is well defined , polynomial - time computable and fulfills the claims of theorem  [ thrm_canon ] .                                                            c.  lutz . .",
    "proceedings of the 2007 international workshop on description logics ( dl2007 ) , ceur - ws , 2007 .",
    "long version available from authors website : http://www.informatik.uni-bremen.de/  clu / papers / archive / dl07a.pdf ."
  ],
  "abstract_text": [
    "<S> evaluating a boolean conjunctive query @xmath0 against a guarded first - order theory @xmath1 is equivalent to checking whether @xmath2 is unsatisfiable . </S>",
    "<S> this problem is relevant to the areas of database theory and description logic . </S>",
    "<S> since @xmath0 may not be guarded , well known results about the decidability , complexity , and finite - model property of the guarded fragment do not obviously carry over to conjunctive query answering over guarded theories , and had been left open in general . by investigating finite guarded bisimilar covers of hypergraphs and relational structures , and by substantially generalising rosati s finite chase , we prove for guarded theories @xmath1 and ( unions of ) conjunctive queries </S>",
    "<S> @xmath0 that ( i ) @xmath3 iff @xmath4 , that is , iff @xmath0 is true in every finite model of @xmath1 and ( ii ) determining whether @xmath3 is 2exptime - complete . </S>",
    "<S> we further show the following results : ( iii ) the existence of polynomial - size conformal covers of arbitrary hypergraphs ; ( iv ) a new proof of the finite model property of the clique - guarded fragment ; ( v ) the small model property of the guarded fragment with optimal bounds ; ( vi ) a polynomial - time solution to the canonisation problem modulo guarded bisimulation , which yields ( vii ) a capturing result for guarded bisimulation invariant ptime . </S>"
  ]
}