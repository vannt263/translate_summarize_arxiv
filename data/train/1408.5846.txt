{
  "article_text": [
    "models of high energy astrophysics are closely related to relativistic fluid dynamics , because most of the sources are identified with the dynamics of gas or plasma associated to a high energy source . in the most complex cases ,",
    "the models involve magnetic fields and cooling processes associated to various reactions taking place in the plasma .",
    "we know moreover , that interesting sources of this sort involve also strong gravitational fields .",
    "in this sense , the most complete models approaching realistic scenarios within the field of high energy astrophysics involve three main ingredients : relativistic hydrodynamics ( rhd ) , magnetic fields ( rmhd ) and strong gravitational fields ( grmhd ) , which are further complicated with the introduction of various cooling processes and realistic equations of state . in this way",
    ", the most modern relativistic models involve the solution of the coupled system of equations composed by the einstein - euler - maxwell equations under very general conditions .",
    "given the complexity of this system of partial differential equations , these have been solved numerically for particular scenarios as a system of evolution equations , which requires the development of a code .",
    "particular examples of high energy phenomena with some of these ingredients are the propagation of jets on flat space - times , accretion of tori around black holes , supernovae core collapse processes , mergers of binary neutron stars , etc . @xcite .",
    "astrophysical models of rapidly moving gas involve also a degree of idealization , in particular the gas equation of state , the conditions on magnetic fields and sometimes symmetries .",
    "the more powerful a code is , the less idealizations it assumes .",
    "various codes have been presented that are distinguished in terms of what type of problems each one is able to solve . as examples we mention some of the currently most used codes .",
    "cactus einstein toolkit , a multi usage package mounted on cactus @xcite , capable of solving the general relativistic mhd @xcite .",
    "whisky , a code that in its most sophisticated version can evolve general relativistic resistive magnetohydrodynamics @xcite , also mounted cactus .",
    "genesis , which is a code capable of solving the rmhd equations for relativistic and ultrarelativistic flows .",
    "harm , a general relativistic code for a fixed space - time @xcite and its latest version including radiation terms @xcite .",
    "had , that is capable of evolving binary compact stars in the presence of magnetic fields , in general relativity @xcite .",
    "there are also independent codes , dealing with general relativistic hydrodynamics , for instance the one in @xcite .",
    "coconut , evolves the general relativistic magneto - hydrodynamics to simulate the core collapse of massive stars and the evolution of neutron stars @xcite .",
    "specific purpose codes also include @xcite , designed to evolve the accretion of magnetized winds onto black holes .",
    "the pluto code , solves the rmhd equations @xcite , so as that in @xcite . and a certainly more complete list of codes designed for various purposes that can be found in for instance @xcite .    even though the codes are extremely advanced , including coupling to general relativity and radiation cooling processes ( e.g. , * ? ? ?",
    "* ; * ? ? ?",
    "* ) , and knowing that new state of the art numerical methods to handle the high resolution shock capturing ( hrsc ) schemes in relativistic and general relativistic hydrodynamics are now being studied and tested , it is our intention in this paper , to present and certify our code cafe , which in its first version focuses on the solution of rmhd equations , with the intention of extending it to general background space - times and will be applied to the study of accretion processes on black holes .",
    "additionally , considering we have not presented the tests of the rhd implementation before , we include also in this paper the tests in this regime .",
    "the paper is organized as follows . in section [ sec : mhd ] we present the standard ideal rmhd equations that are solved . in section [ sec : tests ] we show the tests for the zero magnetic field case , which reduces the system to the pure rhd regime and also show how our implementation performs on the standard tests of the rmhd .",
    "in section [ sec : conclusions ] we mention some final comments .",
    "finally , in appendix  [ appendix ] we provide details of the implementation in cylindrical coordinates , required in one of the tests .",
    "special relativistic ideal magnetohydrodynamic equations ( srmhd ) can be derived from the conservation of the rest mass , the local conservation of the stress - energy tensor @xmath0 and maxwell equations    @xmath1    where @xmath2 is the rest mass density of a fluid , @xmath3 is the 4-velocity of the fluid elements and @xmath4 are the components of the faraday dual tensor , where @xmath5 are the components of the levi - civita tensor .",
    "we use the rescaled faraday tensor and its dual with the factor @xmath6 , in order to avoid the inclusion of the permittivity and permeability of free space in cgs - gaussian units . notice that our definitions assume geometric units where @xmath7 .    in this work",
    "we consider the magnetized fluid is described by the sum of the stress - energy tensor of a perfect fluid @xmath8 and maxwell stress - energy tensor @xmath9    @xmath10    where @xmath11 is the fluid pressure , @xmath12 is the component of the maxwell tensor parallel to the 4-velocity of the fluid ( magnetic 4-vector measured by an observer comoving with the fluid ) , @xmath13 is the magnitude of the magnetic field , @xmath14 are the components of the minkowski metric and @xmath15 is the specific enthalpy , where @xmath16 is the rest frame specific internal energy density of the fluid . then , the total stress - energy tensor reads    @xmath17    where @xmath18 is the addition of the gas pressure @xmath11 and the magnetic pressure @xmath19 . in the same way ,",
    "@xmath20 is the sum of the specific enthalpy of the fluid @xmath21 and the specific magnetic enthalpy @xmath22 .    in order to track the evolution of the fluid",
    "it is convenient to write down srmhd as a system of flux balance laws @xcite on the minkowski space - time .",
    "following @xcite , the evolution scheme is written as a first - order hyperbolic system of flux - conservative equations for the conservative variables ( @xmath23 ) , which are defined in terms of the primitive variables ( @xmath24 ) as    @xmath25    where @xmath26 is the lorentz factor , @xmath27 is the 3-velocity measured by an eulerian observer and defined in terms of the spatial part of the 4-velocity @xmath28 , as @xmath29 and @xmath30 is the spatial magnetic field measured by an eulerian observer .",
    "thus , the srmhd euler equations ( [ eq : lc ] ) form a system of conservation laws , which can be written , in cartesian coordinates , as    @xmath31    where @xmath32 is the vector whose entries are the conservative variables and the vector @xmath33 contains the fluxes along the spatial directions .",
    "all these ingredients are explicitly      where @xmath35 is the kronecker delta .    in these definitions",
    "the components of the magnetic field measured by the comoving observer and an eulerian observer are related as follows    @xmath36    where the magnitude of the magnetic field can be written as    @xmath37    with @xmath38 . finally , the rmhd system of equations ( [ eq : valencia],[eq : constraint ] ) , is a set of eight equations for either , the primitive variables @xmath39 or the conservative variables @xmath40 . as usual ,",
    "the system is closed with an equation of state relating @xmath41 .",
    "specifically , we choose the fluid to obey an ideal gas equation of state @xmath42 , where @xmath43 is the adiabatic index .      for a time - dependent pde problem ,",
    "a complete basic solver has several components : grid generation , initial conditions , boundary conditions , spatial discretization and time integration . in our case ,",
    "the relativistic magnetized euler evolution equations are solved on a single uniform cell centered grid .",
    "the integration in time uses the method of lines , with a third order total variation diminishing runge - kutta time integrator ( rk3 ) @xcite .",
    "the srmhd equations are discretized using a finite volume approximation together with high resolution shock capturing methods .",
    "thus , the system of equations ( [ eq : valencia ] ) can be expressed in a semi - discrete form as follows    @xmath44    where @xmath45 , @xmath46 and @xmath47 are the numerical fluxes at the respective cell interface .",
    "the rigth hand side of this expression is what we will call right hand side of the conservative variables from now on .",
    "cafe provides different types of spatial reconstruction schemes which are applied on the primitive variables @xmath48 .",
    "specifically , we use the minmod and mc linear piecewise reconstructors , which are second - order methods . for higher order reconstructions ,",
    "we use the third - order piecewise parabolic method ( ppm ) , which was developed by @xcite and adapted to the relativistic case by @xcite .",
    "we use this recipe with parameters @xmath49 , @xmath50 , @xmath51 , @xmath52 , @xmath53 , @xmath54 and @xmath55 . in regions near contact discontinuities ,",
    "the interpolation is modified in such a way that in the vicinity of local extrema , the scheme reduces to a piecewise constant approximation in order to avoid shock oscillations .",
    "we also use the fifth - order weighted essentially non oscillatory ( weno5 ) , which approaches the variables with high order of accuracy using polynomial interpolation , see @xcite , and is efficient at capturing the structure of turbulent fluxes .",
    "our framework is such that other schemes can be incorporated easily .      in order to solve the system of equations [ eq : dis ] , we have implemented the hlle @xcite approximate riemann solver formula    @xmath56    where @xmath57 and @xmath58 are the fluxes whereas @xmath59 and @xmath60 are the conservative variables at the left and right sides of the interface between cells ; @xmath61 , @xmath62 and @xmath63 denote the @xmath11 eigenvalue of the jacobian matrix for the left and right states respectively .",
    "different approximate riemann solvers require different characteristic information from the jacobian matrix @xmath64 , for instance the marquina @xcite and roe @xcite approximate riemann solvers , require the eigenvalues and eigenvectors .",
    "one of the appealing properties of the hlle approximate riemann solver is that it requires only the eigenvalues of the jacobian matrix .",
    "specifically , the hlle solver uses a two - wave approximation to compute the fluxes across the discontinuity at the cell interfaces .",
    "one disadvantage of this flux formula is that it does not resolve properly the contact discontinuity and it is more dissipative than other methods like hllc which actually does solve the contact discontinuity @xcite .",
    "however , less dissipative formulas may produce undesirable effects , such as the carbuncle artifact along the axis of propagation of strong shocks @xcite .",
    "furthermore , in our hrsc scheme that solves the relativistic magnetized euler equations ( [ eq : valencia ] ) , in order to calculate the eigenvalue structure , we follow the formalism introduced in @xcite and further developed in @xcite .",
    "the expressions of the seven eigenvalues associated to entropic , alfvn fast and slow magnetosonic waves are the following :    @xmath65    where @xmath66 is the total energy density measured by an observer comoving with the fluid .",
    "the fast and slow magnetosonic waves , which are required in the computation of the numerical fluxes , can be obtained by solving the following quartic equation in each direction @xmath67 for the unknown @xmath68 @xmath69 where @xmath70    and @xmath71 is the sound speed .    in order to solve this equation , we use an approximate method for the calculation of the eigenvalues related to the fast magnetosonic waves .",
    "the method was introduced by and basically consists in reducing the original quartic equation ( [ eq : quartic ] ) to a quadratic equation , which can be solved analytically .",
    "finally , due to the structure of the hlle formula , which uses the upper and lower bounds of the eigenvalues , it is not necessary to incorporate the slow magnetosonic waves .",
    "although the analytic solutions of maxwell equations guarantee the constraint ( [ eq : constraint ] ) , the experience shows that it is not the case when calculating numerical solutions of these equations .",
    "instead , the numerical evolution of initial data involving maxwell equations may eventually lead to a violation of the divergence free constraint ( [ eq : constraint ] ) , giving as a consequence the development of unphysical results like the presence of magnetic monopolar sources .",
    "+   + _ a. flux constraint transport _",
    "+   + there are various methods available to control the growth of the constraint violation ( e.g. , * ? ? ?",
    "* ) , in our code we use a version of the constrained transport method `` ct '' originally proposed in @xcite , which is based on the use of the fluxes computed with a conservative scheme .",
    "this algorithm is known as flux - ct and was proposed in @xcite . following @xcite , the resulting discretized cell - faced evolution equations for the magnetic field components",
    "are given in terms of @xmath72 as    @xmath73    where @xmath74 , @xmath75 and @xmath76 are the magnetic field components defined as the average on each surface @xmath77 , @xmath78 and @xmath79 respectively , see figure [ fig : cube ]",
    ". moreover , the @xmath80 terms in the right hand side of equations ( [ eq : dbxdt],[eq : dbydt],[eq : dbzdt ] ) are defined at the cell vertex .",
    "these terms are computed using the simple average of the neighboring values of the numerical fluxes at the intercells as follows    @xmath81    where @xmath82 , @xmath83 and @xmath84 , are the appropriate flux components @xmath85 computed with the hlle flux formula along each spatial direction .",
    "+ in figure [ fig : cruz ] we show an example of the values used to compute the cell vertex flux @xmath86 . as we can see , for example in equation ( [ eq : omegafluxes ] ) , we need the four values @xmath87 , @xmath88 , @xmath89 and @xmath90 , where two of these are computed along the @xmath91-direction whereas the other two along the @xmath92-direction . the procedure to calculate @xmath93 and @xmath94 is similar .",
    "this figure shows a numerical cell centered at @xmath95 , and contains the detailed labels of the corners required in the calculations.,width=264 ]     numerical cell centered at @xmath95 and two adjacent faces .",
    "we show an example to illustrate the cell corner interpolation of the numerical fluxes using the four values computed using the hlle flux formula .",
    "we can see that the fluxes @xmath96 and @xmath97 are computed along @xmath91 and @xmath92 directions at points @xmath98 , @xmath99 , @xmath100 and @xmath101 .",
    "we use this values to compute @xmath86 using the formula given by the equation ( [ eq : omegafluxes ] ) .",
    ", width=264 ]    once the magnetic field is evolved at the interfaces , in order to compute the cell centered magnetic field we use a simple average in each direction : @xmath102 and similarly @xmath103 and @xmath104 . finally ,",
    "the discretized magnetic field divergence , calculated at the corner of the grid , is given by    @xmath105    which is the discretized expression the constraint has to be monitored with .    _",
    "b. hyperbolic divergence cleaning _",
    "+   + we also implemented the divergence cleaning method , which preserves the magnetic field constraint by solving a modified version of maxwell equations @xmath106 , where a new field variable @xmath107 and a diffusive term @xmath108 are added .",
    "the parameter @xmath109 may be adjusted in order to absorb errors in the constraint , and @xmath107 vanishes when @xmath110 is exactly satisfied . here",
    "@xmath111 is the normal vector to the hypersurface .",
    "the hyperbolic divergence cleaning method used was proposed by @xcite .",
    "to see how explicitly maxwell equations are modified , we refer the reader to @xcite .",
    "the field variable @xmath107 satisfies the damped wave equation @xmath112 , this means that the amplitude of @xmath107 decreases in time during the evolution , recovering the unmodified maxwell equations .",
    "thus , the modified maxwell equations in special relativity are written as    @xmath113    and aditionally , we have an evolution equation for the new variable @xmath107 given by    @xmath114    which is incorporated to the set of evolution equations .",
    "the code evolves the conservative @xmath115 , but not the primitive variables @xmath48 .",
    "however , the numerical fluxes depend on both sets of variables . therefore ,",
    "after each time step within the evolution scheme , one needs to recover the primitive variables out of the conservative ones . by definition",
    ", the conservative quantities can be written in terms of the primitives , however a solution to the inverse problem is not known and a numerical algorithm is required .",
    "the method we use is based on @xcite and is as follows . as a starting point ,",
    "the definitions of @xmath116 , @xmath117 , and an auxiliary variable @xmath118 are used .",
    "then , it is necessary to compute @xmath119 and @xmath117 in terms only of @xmath120 and @xmath121 as follows    @xmath122    where @xmath123 and @xmath11 can be expressed in terms of @xmath124 and @xmath125    @xmath126    from equation ( [ eq : ss ] ) it is possible to express the lorentz factor in terms of @xmath124 , @xmath127 and @xmath128    @xmath129    and then substituting this into ( [ eq : tau ] ) we obtain    @xmath130    in order to solve this algebraic equation , we use a numerical iterative algorithm , which is a combination of the newton - raphson and bisection methods @xcite .",
    "the newton - raphson method requires the derivative @xmath131    @xmath132    where    @xmath133    finally , after calculating @xmath124 it is possible to find the other primitive variables as follows : once @xmath124 is known , @xmath125 can be recovered from equation ( [ eq : lorentz ] ) , then the pressure from equation ( [ eq : press ] ) , @xmath134 from the definiton of @xmath135 and the velocity components from the expresion    @xmath136    which is obtained from the definiton of @xmath137 .",
    "the first set of tests involve the evolution with the magnetic field switched off , which is the domain of the relativistic hydrodynamics ( rhd ) , considered to be as important because we have not shown prior evidence of the ability of our code to handle this system .",
    "a second set of tests involves non - trivial magnetic fields , and includes a complete set of rmhd tests .      in order to illustrate how our implementation handles the evolution of a relativistic gas , in this subsection we present the standard tests showing that our code works properly .",
    "the 1d tests are riemann problems under various conditions and we compare the numerical results with the exact solution we implemented based on @xcite .",
    "we calculate the numerical solution of these tests using various limiters , however , unless otherwise specified : all the results in the 1d test figures corresponding to reimann problems use the hlle formula and the mc limiter , the problem is solved in the domain @xmath138 $ ] with @xmath139 identical cells , a courant factor @xmath140 , and with the initial discontinuity located at @xmath141 .",
    "the resolutions we have used for the error estimates are @xmath142 , @xmath143 , @xmath144 , @xmath145 , @xmath146 and @xmath147 .",
    "for these tests we are using the 3d code with five cells along the transverse directions .",
    "the various parameters of 1d tests are summarized in table [ tab : rhd_tests ] .",
    "the first 1d riemann problem test corresponds to a mildly relativistic blast wave explosion , characterized by an initial static state with higher pressure in the region on the left .",
    "the results can be seen in figure [ fig : midst1d ] , where we compare the numerical solution ( points ) with the exact solution ( lines ) .",
    "the comparison between the exact and numerical solutions is as good as that obtained by other codes . in this test",
    "the most important feature is that with a relatively small number of cells the shock speed is pretty much the exact one .",
    "test 1 : mildly relativistic blast wave explosion problem at @xmath148 .",
    "we show proper rest mass density , pressure and velocity . , width=264 ]      in this problem , unlike the previous one , the evolution of the initial discontinuity produces a sharper blast moving to the right .",
    "the standard initial data are those in @xcite . in figure",
    "[ fig : strong1d ] we show our results and contrast them with the exact solution . due to the important difference of pressure between the left and right states , behind the shock",
    "there is an extremely thin dense shell , which is a feature expected to be controlled by a code .",
    "the fact that the thin shell is not well resolved is a matter of resolution , and in this particular case @xmath149 is not enough , however with @xmath150 the shell is well resolved and within the convergence regime .",
    "test 2 : strong relativistic blast wave problem at time @xmath151 .",
    "as in the previous case , proper rest mass density , pressure and velocity are shown .",
    "the value of the numerical density peak of magnitude @xmath152 , is similar to what is found with other schemes .,width=264 ]      in this case , the initial velocity in the two chambers is high and with opposite direction , and consequently two strong shocks form and propagate to the left and right decelerating the gas to a very low speed .",
    "the evolution produces lorentz factors of the order of 10000 , which tests the capability of an implementation to control extremely high fluid speeds .",
    "the numerical results compared with the exact solution are shown in figure [ fig : headon ] . due to the strength of the shocks",
    ", unphysical oscillations may appear behind them , and in order to avoid these oscillations we use the minmod reconstructor , which is more dissipative than the mc .",
    "test 3 : head - on stream collision .",
    "this test shows that our implementation is capable to track the evolution of the fluid with lorentz factors of the order of @xmath153 .",
    "the snapshot is taken at @xmath151 .",
    "we show the proper rest mass density , pressure and velocity.,width=264 ]      in this problem a strong reverse shock forms , in which post - shock oscillations are visible for the numerical methods used in our simulations .",
    "specifically these oscillations are more evident in the pressure and density .",
    "the numerical results compared with the exact solution are shown in figure [ fig : reverse ] . under these extreme conditions",
    "none of the reconstructors used here is capable of diminishing the oscillations , however the amplitude of the oscillations converges to zero with resolution .",
    "test 4 : strong reverse shock at @xmath148 .",
    "we show the proper rest mass density , the pressure and the velocity.,width=264 ]      many problems of interest in hydrodynamics involve strong shear flows .",
    "for example , astrophysical jets include shearing layers of ambient material into the fast jet flow .",
    "it is therefore important to test the ability of numerical codes to handle riemann problems with velocity components transverse to the direction of propagation of the main flow . in this first case ,",
    "the problem is relatively easy because the transverse velocity is in the cold gas of the right state , not in the relativistically hot left state or in the rarefaction fan which subsequently propagates into it .",
    "the numerical results compared with the exact solution are shown in figure [ fig : neasy ] , and there is no major difficulty to resolve the shock using resolution @xmath149 .     test 5 : non - zero transverse velocity easy test at @xmath148 .",
    "this test problem is relatively easy and can be resolved with @xmath149 .",
    "again we show the proper rest mass density , the pressure and the velocity.,width=264 ]      this is a very severe test requiring very high resolution to resolve the complicated structure of the transverse velocity .",
    "this test is particularly hard because the transverse velocity is high not only where the gas is cold but also in the hot region .",
    "the numerical results compared with the exact solution are shown in figure [ fig : nhard ] and the initial set of parameters can be seen in table [ tab : rhd_tests ] .          in order to systematically compare the numerical solutions under different combinations of limiters implemented in our code , we have calculated the error for each 1d riemann test , and the results are summarized in table [ tab : rhd_error ] . in all the numerical solutions",
    "presented we found consistency , that is , the error decreases when resolution is increased . for this",
    "we calculate the @xmath154 norm of the error of these tests as compared with the exact solution .",
    "since we always consider the resolution factors of two , the order of convergence is given by @xmath155 , where @xmath67 is the error calculated with the resolution @xmath156 .",
    "we carried out the tests with five resolutions and for the methods used in our code , involving the use of only the rk3 time integrator , first order convergence is expected since the problems start with discontinuous initial data . for tests 1 , 2 , 3 , 4 and 5 we spotted the desirable nearly first order convergence regime for at least a combination of resolution and reconstructor used .",
    "the strong test 6 on the other hand , needs more resolution than the previous ones , however we nearly approach first order convergence for the highest resolutions .",
    "it is important to mention that with error estimates , we also locate the resolutions required to safely work on a convergence regime of resolution . in fact",
    "these error estimates could be important in amr codes , in which the resolution in a certain region may be prescribed by the strength and type of local riemann problems contained in the tests presented here .",
    "[ cols=\"^,^,^,^,^,^,^,^,^\",options=\"header \" , ]      the first 2d test is a magnetic rotor defined on the @xmath157 plane .",
    "the initial density within a cylinder of radius @xmath158 is @xmath159 , and has angular velocity @xmath160 .",
    "the initial pressure is constant in the whole domain @xmath161 and the magnetic field has components @xmath162 , @xmath163 .",
    "the components of the initial velocity inside the cylinder are defined by @xmath164 and @xmath165 . in the exterior region ( @xmath166 ) , the fluid density is @xmath167 and the velocity is zero .",
    "the results of the evolution for @xmath168 are shown in figure [ fig : rmrotor2d ] at @xmath148 , where the different shocks and the rotational alfvn waves can be observed and reproduce the morphology in .",
    "we show additionally the violation of the divergence of the magnetic field constraint calculated with the flux - ct method . in this case",
    "the violation is bounded to be @xmath169 for minmod . as expected",
    ", the magnetic field slows down the rotor velocity , reducing the lorentz factor from @xmath170 at initial time to @xmath171 at time @xmath148 and all the variables are affected by the dragging of the initial angular velocity . in figure",
    "[ fig : rmrotor1d ] , we show 1d slices for two different resolutions , showing the variable profiles along the @xmath91 and @xmath172 axes .",
    "the variable profiles reproduce those in @xcite .",
    "the second 2d test is the cylindrical explosion , starting the evolution with a cylindrical inner region with radius @xmath173 , where the rest mass density is @xmath174 and the pressure is @xmath175 . in the outer region",
    "@xmath176 the variables are @xmath177 and @xmath178 .",
    "the magnetic field is uniform in the whole domain initially @xmath179 and @xmath163 , whereas the adiabatic index is @xmath180 . in this configuration",
    "the fluid is initially at rest .",
    "we also use a smoothing function for the density and pressure for @xmath181 as in @xcite .",
    "@xmath182    where @xmath183 .",
    "a similar smoothing function is used for the pressure .",
    "we again practice the test in the @xmath157 plane .",
    "the results of the evolution are shown in figure [ fig : cylindrical2d ] , and reproduce those in . in this test , in order to compare the two different methods implemented to prevent the growth of the constraint violation of the magnetic field , we present the numerical calculations with flux - ct and divergence cleaning methods . in the first case ,",
    "the divergence of the magnetic field remains of the order @xmath184 whereas in the second one the violation is of the order @xmath185 in some regions , which is comparable with previous analyses @xcite .",
    "additionally , like in the relativistic rigid rotor test , in figure [ fig : cylindrical1d ] we show 1d slices for two different resolutions , showing the variable profiles along the @xmath91 and @xmath172 axes .",
    "the variable profiles are better resolved with higher resolution as in @xcite .",
    "the evolution shows an exterior shock wave expanding radially at nearly the speed of light with a very small amplitude .",
    "it is also possible to handle stronger magnetic fields , for instance , we evolved the cylindrical explosion test with @xmath186 using the mc reconstructor , the flux - ct method to control the constraint and a courant factor 0.1 , however using a higher external pressure @xmath187 . in figure",
    "[ fig : cylindrical2dstrong ] we show the results , which are consistent with those in and @xcite for such strong field and our code tolerates magnetic filed strength up to @xmath188 . without increasing the external pressure it has been possible to carry out this test , however using hllc fluxes @xcite .",
    "another standard 2d test is the magnetized kelvin - helmholtz ( mkh ) instability .",
    "the initial condition sets the fluid in three separate regions . in one of them",
    "it moves in one direction and in the other two in the opposite direction . along the layers dividing the three regions",
    "the velocity is perturbed .",
    "we study this test in the @xmath157 plane covering the domain @xmath189 \\times [ -0.5 , 0.5]$ ] , using @xmath190 cells .",
    "the fluid in the strip @xmath191 moves along the @xmath91 direction with velocity @xmath192 , and density @xmath167 .",
    "the fluid outside this area moves in the opposite direction with a speed @xmath193 and density @xmath194 .",
    "the initial pressure is constant throughout the domain , the adiabatic index is @xmath195 , and the magnetic field is uniform along the @xmath91 direction , @xmath196 .",
    "the @xmath172 component of the velocity is also perturbed , and the velocity field including the perturbation at initial time is + @xmath197    where @xmath198 is the number of nodes of the perturbation along the domain .",
    "the perturbation triggers the instabilities shown in figure [ fig : mkelvin2d ] , where we show the proper rest mass density , magnetic pressure , lorentz factor and the constraint violation at @xmath199 using weno5 . as we can see , the constraint violation is of the order of @xmath200 when using the flux - ct method .",
    "+          like in the non - magnetized case , it would also be interesting to estimate the saturation time and to follow the evolution until the turbulent regime as in , however this would deserve a separate space elsewhere .",
    "this is a test modeling a loop of magnetic field that is being advected similar to that in @xcite .",
    "the initial pressure gradients are zero and the dynamics is ruled by the velocity field that carries the magnetic field with it .",
    "we set the initial constant density and pressure to @xmath201 with adiabatic index @xmath202 .",
    "the magnetic field is initialized using a vector potential defined by @xmath203,0)$ ] with @xmath204 the 2d cylinder - type radius measured from an axis parallel to @xmath79 . in order to have an oblique advection we choose the vector potential such that its only component lies along the diagonal of the @xmath205 plane .",
    "since we choose the numerical domain to be @xmath189 \\times [ -0.5 , 0.5 ] \\times [ -1,1]$ ] , the rotation @xmath206 makes the vector potential to have the single component @xmath79 along such diagonal .",
    "the 2d radius perpendicular to this diagonal is thus @xmath207 .",
    "we choose the amplitude @xmath208 to be small so that the field is weak compared to the gas pressure and thus maintain magnetostatic equilibrium .",
    "we use @xmath209 and the loop radius @xmath210 .",
    "face - centered magnetic fields are computed using finite differences to calculate @xmath211 to set @xmath212 initially up to numerical error .",
    "the velocity field is defined by @xmath213 , @xmath214 and @xmath215 , such that the loop propagates along the diagonal of the @xmath205 plane . in order to preserve the magnetic field constraint we use the flux constraint transport method .",
    "the 3d simulation was calculated using @xmath216 cells , a courant factor @xmath140 and periodic boundary conditions .",
    "in figure [ fig : mhdloop ] we present snapshots of the squared magnitude of the magnetic field . this shows the magnetic field is being advected across the domain .",
    "it is also shown that the magnetic field constraint is kept under control during the evolution .",
    "we have presented a new 3d code designed to solve the relativistic ideal magnetohydrodynamics equations and shown that it passes the rhd and rmhd standard tests .    among the various combinations between methods in a hrsc implementation ,",
    "we have shown the tests only for a reduced set of linear reconstructors ( minmod , mc ) , parabolic ppm and the fifth order weno5 limiter , all of them combined with the hlle flux formula and the rk3 time integrator .",
    "we have also presented an error analysis for the rhd and rmhd 1d tests . in all the cases the numerical solutions",
    "are consistent .",
    "furthermore , the convergence achieved is the expected nearly first order for initial data with shocks and second for smooth data , at least within a resolution regime and a particular linear reconstructor . in the 2d and 3d cases of rmhd",
    ", we have shown the ability of our code to keep the violation of the constraint under control , by using either the flux - ct and cleaning methods . in our case , in unigrid mode",
    "both methods are comparably easy to implement , however the flux - ct method may offer extra complication when implemented on adaptive mesh refinement , unlike the cleaning method , which is implemented as an extra evolution equation . also the flux - ct shows the advantage that the errors in the constraint are kept very low of the order of round off error , whereas the divergence cleaning method is easy to implement but the errors are not as low , which on the other hand is consistent with previous experience .    finally we want to confirm some of the general limitations of the methods used here that have been described in the past .",
    "we confirm that mc captures the shocks better than minmod in most of the cases , however , depending on the strength of the shocks , it introduces high frequency noise on discontinuities . on the other hand , even though the ppm is a third order method , the parameters we used for this reconstructor show similar errors and convergence rates as those for the linear reconstructors .",
    "finally , the weno5 is a fifth order reconstructor , which is expensive but the reconstruction is in most cases free of unphysical oscilations .",
    "we are thankful to the anonymous referee , whose feedback has been essential .",
    "we also thank ian hawke and luciano rezzolla for reading the manuscript and providing important criticism and suggestions .",
    "this research is partly supported by grants cic - umsnh-4.9 and conacyt 106466 .",
    "f.s.g . acknowledges support from the conacyt program for sabbatical visits in foreign countries .",
    "f.d.l - c gratefully acknowledges dgapa postdoctoral grant to universidad nacional autnoma de mxico ( unam ) and finantial support from conacyt 57585 .",
    "in the particular test corresponding to the jets our numerical code requieres the implementation of the srmhd equaitons in cylindrical coordinates @xmath217 . in this case , the minkowski metric becomes @xmath218 .",
    "then the srmhd equations can be written in a conservative form as follows          @xmath221,~~~~ { \\bf f}^{(\\phi)}=    \\left [ \\begin{array}{l }   d v^{\\phi }                               \\\\",
    "m_{r}v^{\\phi } - b_{r } b^{\\phi}/w     \\\\",
    "m_{\\phi}v^{\\phi } + p^ *   - b_{\\phi } b^{\\phi}/w    \\\\",
    "m_{z}v^{\\phi } - b_{z } b^{\\phi}/w          \\\\",
    "\\tau v^{\\phi } + p^*v^{\\phi } - b^{0 } b^{\\phi}/w\\\\   v^{\\phi } b^r - v^r b^{\\phi } \\\\   0                \\\\",
    "v^{\\phi } b^{z } - v^{z } b^{\\phi }    \\end{array } \\right],~~~~ { \\bf f}^{(z)}=    \\left [ \\begin{array}{l }   d v^{z }                          \\\\",
    "m_{r}v^{z } - b_{r } b^{z}/w       \\\\",
    "m_{\\phi}v^{z } - b_{\\phi } b^{z}/w    \\\\",
    "m_{z}v^{z }   + p^ * - b_{z } b^{z}/w          \\\\",
    "\\tau v^{z } + p^*v^{z } - b^{0 } b^{z}/w\\\\   v^{z } b^r - v^r b^{z } \\\\",
    "v^{z } b^{\\phi } - v^{\\phi } b^{z}\\\\    0            \\end{array } \\right],\\end{aligned}\\ ] ]                                                                goodale , t. , allen , g. , lanfermann , g. , mass , j. , radke , t. , seidel , e. , & shalf , j. 2003 , in vector and parallel processing ",
    "vecpar2002 , 5th international conference , lecture notes in computer science ( berlin : springer ) http://edoc.mpg.de/3341 [ ]"
  ],
  "abstract_text": [
    "<S> we introduce cafe , a new independent code designed to solve the equations of relativistic ideal magnetohydrodynamics ( rmhd ) in 3d . </S>",
    "<S> we present the standard tests for a rmhd code and for the relativistic hydrodynamics ( rhd ) regime since we have not reported them before . </S>",
    "<S> the tests include the 1d riemann problems related to blast waves , head - on collision of streams and states with transverse velocities , with and without magnetic field , which is aligned or transverse , constant or discontinuous across the initial discontinuity . among the 2d and 3d tests , without magnetic field </S>",
    "<S> we include the 2d riemann problem , a one dimensional shock tube along a diagonal , the high speed emery wind tunnel , the kelvin - helmholtz instability , a set of jets and a 3d spherical blast wave , whereas in the presence of a magnetic field we show the magnetic rotor , the cylindrical explosion , a case of kelvin - helmholtz instability and a 3d magnetic field advection loop . </S>",
    "<S> the code uses high resolution shock capturing methods and we present the error analysis for a combination that uses the hlle flux formula combined with linear , ppm and fifth order weno reconstructors . </S>",
    "<S> we use the flux - ct and the divergence cleaning methods to control the divergence free magnetic field constraint . </S>"
  ]
}