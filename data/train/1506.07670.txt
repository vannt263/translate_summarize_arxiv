{
  "article_text": [
    "both problems , the inverse refractor and the inverse reflector problem , from illumination optics can be formulated in the following framework : let a point - shaped light source and a target area be given , e.g. a wall .",
    "then we would like to construct an apparatus that projects a prescribed illumination pattern , e.g. an image or a logo , onto the target .",
    "since we aim for maximizing the efficiency , we would like to construct our optical device in such a way that , neglecting losses , it redirects all light emitted by the light source to the target .",
    "we focus our attention to the design of such an optical system in the simple case that it either consists of a single free - form lens or of a single free - form mirror , see figure  [ fig : parametrization ] for an illustration of the former case .",
    "our goal is now to compute the shape of the optically active surfaces , modeled as _ free - form surfaces _ , such that the desired light intensity distribution is generated on the target . since these problems from illumination optics from the mathematical point of view conceptually fall into the class of inverse problems , they are also called _ inverse reflector problem _ and _ inverse refractor problem _ , respectively . in particular , since the size of the optical system is comparable to that of the projected image , we address the case of the near field problems .    , while the surrounding has the refractive index @xmath0 . ]",
    "there is a variety of technical applications of such optical systems , e.g. spotlights with prescribed illumination patterns used in street lamps or car headlamps , see e.g.  @xcite .",
    "the authors present in  @xcite a solution method for the inverse reflector problem via numerically solving a strongly nonlinear second - order _ partial differential equation ( pde ) of monge ",
    "ampre type_. due to the high potential of this approach we now extend this method to the case of illumination lenses .",
    "this paper is organized as follows : since the reflector problem has been discussed in detail in  @xcite we mainly focus on the refractor problem .",
    "we start with the state of the art for its solution in section  [ sec : state_of_the_art ] .",
    "then , we formulate the problem via a partial differential equation of monge  ampre type which we discuss in section  [ sec : refractor_problem ] for the construction of a refractor . for completeness we also give the monge ",
    "ampre formulation for the reflector problem in section  [ sec : reflector_problem ] .",
    "next , the numerical method is explained in section  [ sec : collocation ] . since this type of optical design problem raises many difficulties in the solution process we discuss in section  [ sec : ma_in_optics ]",
    "how these can be resolved .",
    "finally , in section  [ sec : results ] we look at numerical results for the inverse reflector and refractor problems and end this paper in section  [ sec : outlook ] with our conclusions .",
    "in this section we discuss the methods available for the solution of the inverse design problems in nonimaging optics , see the monographies by chaves  @xcite and by winston , miano and bentez  @xcite for an introduction to nonimaging optics and the paper by patow and pueyo  @xcite for a survey article on inverse surface design from the graphics community s point of view . for a detailed survey of solution techniques for the inverse reflector problem , we refer the reader to ( * ? ? ?",
    "* section 2 ) .",
    "focusing on the inverse refractor problem , in the paper by wester an buerle  @xcite there is a list of approaches , a discussion on practical problems , e.g. extended sources and fresnel losses , and examples with led lighting , e.g. a lens for automotive fog light and a lens producing a logo .    in the rest of this section ,",
    "we first give a short overview of other solution techniques in section  [ sect : sota_nopdeapproach ] and then focus on methods based on pdes in section  [ sect : sota_pdeapproach ] , which is also our problem formulation of choice .",
    "finally , we discuss some advanced topics in section  [ sect : sota_advancedtopics ] and draw our conclusions in section  [ sect : sota_conclusion ] .",
    "we distinguish three different groups of techniques for the solution of inverse problems in nonimaging optics , which are not based on a pde : there are methods resorting from optimization techniques , others built from cartesian ovals and a third group of methods which are geometrical constructions .",
    "[ [ optimization - approaches ] ] optimization approaches + + + + + + + + + + + + + + + + + + + + + + +    there are methods for the design of optical surfaces , which are based on optimization techniques , see e.g. @xcite . starting from an initial guess ,",
    "the outline of the iterative optimization process for the determination of the optical surfaces is as follows : first , the current approximation of the optical surfaces is validated by ray tracing . in a second step , using an objective function , which is often closely related to the euclidean norm , the resulting irradiance distribution is compared to the desired one and a correction of the optical surfaces is determined .",
    "the process ends , when a suitable quality criterion is fulfilled , otherwise these two steps are repeated .",
    "the advantage of this method is that it is very flexible .",
    "however , optimization procedures are very costly because of the repeated application of the ray tracing and it is unclear if the iterative methods converge at all .",
    "[ [ cartesian - ovals - methods ] ] cartesian ovals methods + + + + + + + + + + + + + + + + + + + + + + +    cartesian ovals are curves of fourth order in the plane .",
    "they can be associated with two foci such that light emitted at one focus is collected at the other focus . here",
    "the cartesian oval coincides with the interface of two optical media with different refractive indices .",
    "cartesian ovals can be extended to surfaces in 3d with the same property . by combining clippings of several of these surfaces in an iterative procedure a new segmented surface",
    "can be constructed that approximates the solution .",
    "this strategy has first been developed by kochengin and oliker  @xcite for the construction of solutions for the inverse reflector problem . later this has been extended to the inverse refractor problem  @xcite using cartesian ovals , see also ( * ? ? ?",
    "* section 2 ) for some theoretical background , and for a collimated light beam instead of a point light source  @xcite using hyperboloids .",
    "although this technique has the advantage to permit the construction of continuous but non - differentiable surfaces  @xcite , the number of clippings @xmath1 required grows linearly in the number of pixels in the image .",
    "for example , using ellipsoids of revolution for the construction of a mirror with accuracy @xmath2 , the complexity of the method scales like @xmath3 , see @xcite , such that it quickly becomes infeasible for higher resolutions .",
    "[ [ geometric - construction - methods ] ] geometric construction methods + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    reflective and refractive free - form surfaces can also be designed by geometric approaches .",
    "probably the most famous of these techniques is the simultaneous multiple surfaces ( sms ) method extending the ideas of cartesian - oval methods , see e.g. ( * ? ? ?",
    "* chapter 8) and @xcite and the references therein .",
    "the main idea of the sms method is the simultaneous construction of two optical surfaces , e.g. both surfaces of a lens , which permits to couple two prescribed incoming wave fronts , e.g. coming from two point light sources , with two prescribed outgoing wave fronts .",
    "while in its 2d version , the method is used to design rotationally symmetric optical surfaces , in a 3d variant it is also capable to construct free - form optical surfaces .",
    "however , the authors could not find any hint on the computational costs in the literature but conjecture that this scheme is expensive especially for complex target illumination patterns .      in several publications for the inverse refractor problem a pde",
    "is derived , whose solution models the desired optical free - form surfaces , see e.g. @xcite .",
    "in these approaches usually the low wavelength limit is assumed to hold , i.e. the problems are formulated using the geometrical optics approximation .    some examples for the inverse refractor problem with a more complex target illumination pattern are shown in @xcite . however , in all four articles the descriptions and discussions of the numerical methods are incomplete . to the best of the authors knowledge",
    "the solution method is not fully documented in the literature .",
    "while we consider the case of a point light source , an interesting and closely related problem is shaping the irradiance distribution of a collimated light beam , see e.g. @xcite for the theory including some results on existence and uniqueness of solutions .",
    "we refer the reader to the monography by gutirrez  @xcite for a general overview of monge  ampre - type equations .    since we are looking for an optical surface which redirects light coming from a source onto a target , one can model this problem in terms of optimal transportation .    [",
    "[ optimal - transport ] ] optimal transport + + + + + + + + + + + + + + + + +    there are also methods which are based on a problem of optimal transport which leads to monge  ampre - type equations , see e.g. @xcite .",
    "first the ray mapping , i.e. the mapping of the incoming light rays onto the points at the target , is computed via an optimal transport approach . at this point",
    "the optical surface is still unknown but in a next step it is constructed from the knowledge of the target coordinates for each incoming light ray . in 1998",
    "parkyn  @xcite already described a very similar procedure .      in the current formulation of the problem",
    "only one single idealized point light source has been used . an extension to multiple point light sources",
    "is discussed by lin  @xcite where the optical refractors are determined from those calculated for single point light sources by a weighted least - squares approach .",
    "more techniques for the case of extended light sources can be found in the papers by bortz and shatz  @xcite and wester et al .",
    "@xcite .    in particular for the refractor problem , some energy is lost for the illumination of the target because of internal reflections in the lens material .",
    "a theoretical discussion of these fresnel losses can be found in the publications by gutirrez  ( * ? ? ?",
    "* section 5.13 ) and gutirrez and mawi  @xcite . in @xcite",
    "the losses are minimized by free - form shaping of both refractive surfaces of the lens .",
    "our approach is motivated by the fact that even for the special case of a single point light source and the computation of just one surface of the lens we could not find any fully detailed method in the literature which can produce complex illumination patterns on the target area . from the authors point of view , the most promising approach is the one by solving a pde of monge  ampre type .",
    "this section is devoted to the formulation of the monge  ampre equation that models the near field refractor problem as given in the paper by gutirrez and huang  @xcite .",
    "since the full theory is a bit involved , we restrict ourselves to a summary of the most important aspects and refer the reader to ( * ? ? ?",
    "* appendix a ) and the paper by karakhanyan and wang  @xcite for the details .",
    "our notation also follows these sources .",
    "we now proceed as follows : at first , we fix the geometric setting and the implicit definition of the refracting and the target surfaces in section  [ subsec : geo_setting ] .",
    "then we apply snell s law of refraction in section  [ subsec : snell ] and follow the path of the light ray in section  [ subsec : light_path ] . finally , in section  [ subsec : ma ] we obtain the desired equation of monge  ampre type .      since a lens has two surfaces we need to design both of them . for simplicity",
    "we choose a spheric inner surface , i.e. the surface which faces the light source is a subset of a sphere with center at the position of the light source .",
    "thus there is no refraction of the incoming light at this interface , the inner surface is optically inactive .    it remains to compute the shape of the outer surface facing the target area . to that end",
    "let us define the quotient @xmath4 of the refractive indices of the lens material @xmath5 and the environment @xmath0 .",
    "we assume that the light source illuminates a non - empty subset @xmath6 of the northern hemisphere of the unit sphere @xmath7",
    ". the third component of an incoming light ray with direction @xmath8 is then given as @xmath9 .",
    "thus we define @xmath10 and parametrize our outer lens surface by the distance function @xmath11 , i.e. the surface is given as @xmath12 .",
    "the target @xmath13 is defined as a subset of a hypersurface implicitly given by the zero level set of a continuously differentiable function @xmath14 via @xmath15 note that for the numerical solution procedure in the newton - type method we require that @xmath14 is twice continuously differentiable . while in general much more complicated situations are supported @xcite , for simplicity we restrict ourselves to the case where the target @xmath13 is on a shifted @xmath16-@xmath17-plane such that @xmath18 for a shift @xmath2 .    to model the _ luminous intensity _ of the source we define the density function @xmath19 , where @xmath20 .",
    "the corresponding density function for the desired illumination pattern on the target @xmath13 is denoted by @xmath21 . since we want to redirect all incoming light onto the target the density functions need to fulfill the _ energy conservation _",
    "condition @xmath22 note that for simplicity we neglect the loss of reflected light intensity . for a more complicated derivation of a monge  ampre - type equation for the refractor problem taking losses into account see @xcite .",
    "according to snell s law of refraction in vectorial notation ( see e.g. ( * ? ? ?",
    "* chapter 4.4 ) or ( * ? ? ? * chapter 12 ) ) , the direction of the light ray after refraction at the point @xmath23 is @xmath24 , where @xmath25 and @xmath26 is the outer unit normal on @xmath27 defined as a function on @xmath6 .    as detailed in ( * ? ? ?",
    "* ( 2.15 ) ) , for the outer normal unit vector at @xmath28 we find @xmath29 where @xmath30 denotes the gradient of a function @xmath31 and @xmath32 . to ease notation , we define the utility function @xmath33 which represents the denominator in , i.e. @xmath34      next , we consider the line which contains the light ray after refraction , defined by the point @xmath35 and the direction vector @xmath36 .",
    "we now turn to finding the point @xmath37 where the refracted light ray hits the target @xmath13 . in order to determine the third component @xmath38 of @xmath39",
    ", we first define the utility point @xmath40 as the intersection point of this line with the plane @xmath41 which is given as @xmath42 for a @xmath43 . for a proof of the existence of @xmath44 see ( * ? ? ?",
    "* appendix a.2 ) . using , we confirm that @xmath45 where the utility function @xmath46 is given by @xmath47 after refraction at the point @xmath23 the light ray hits the target @xmath13 at point @xmath37 given as @xmath48 from the third component we know that @xmath49 .",
    "we introduce the short notation @xmath50 .",
    "let us define @xmath51 and denote its partial derivatives by @xmath52 , @xmath53 and @xmath54 , respectively .    a lengthy computation using standard calculus and some tensor identities of sherman  morrison type yields @xmath55 where @xmath56 and @xmath57 .",
    "note that @xmath58    in a bit more involved computation along the same lines we compute @xmath59 with @xmath60 , @xmath61 and @xmath62 , where @xmath63      the energy conservation   clearly also holds if we replace @xmath6 with any arbitrary subset @xmath64 and @xmath13 with @xmath65 , where @xmath66 , @xmath67 . by coordinate transformation",
    "this yields the identity @xmath68 .",
    "finally , we can derive the monge  ampre equation for the refractor problem @xmath69 where @xmath70 and @xmath71 is computed by @xmath72 see ( * ? ? ?",
    "* appendix a ) .",
    "[ [ existence - and - uniqueness - of - solutions ] ] existence and uniqueness of solutions + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    in general , for boundary value problems with monge ",
    "ampre equations proving well - posedness , i.e. existence and uniqueness of the solution and continuous dependency on the parameters , is a hard problem , e.g. see ( * ? ? ?",
    "* section 1.4 ) for an example of a discretized monge  ampre equation obtained by finite differences on a grid of @xmath73 cells which has @xmath74 different solutions .",
    "some theoretical results for the existence of a solution for the refractor problem under some appropriate conditions can be found in @xcite in theorem 5.8 for @xmath75 and theorem 6.9 for @xmath76 .",
    "additionally there are results on the uniqueness of the solution if just finitely many single points on the target are illuminated , see ( * ? ? ?",
    "* theorem 5.7 ) for @xmath75 and ( * ? ? ?",
    "* theorem 6.8 ) for @xmath76 .    for proving existence and uniqueness of a solution one typically requires the equation of monge  ampre type to be elliptic .",
    "a necessary condition is that the right - hand side of is positive .",
    "for this reason we demand that @xmath77 or , equivalently , @xmath78 .",
    "if this term is positive we can simply replace @xmath14 by @xmath79 .",
    "the inverse reflector problem can be modeled as a monge  ampre - type equation very similarly to the case of the inverse refractor problem in section  [ sec : refractor_problem ] , see  @xcite .    using the same definitions and notation as in section  [ sec : reflector_problem ] and introducing the substitution @xmath80",
    ", we first define @xmath81 we assume that @xmath82 , i.e. , @xmath83 , and @xmath84 .",
    "then the monge  ampre equation for the inverse reflector problem reads @xmath85 see @xcite and @xcite for the details .",
    "the numerical solution of strongly nonlinear second - order pdes , including those of monge  ampre type , is a highly active topic in current mathematical research .",
    "there are many different approaches available on the market , see the review paper by feng , glowinski and neilan  @xcite and also @xcite for an overview .",
    "however , most methods are not well - suited for all equations of monge  ampre type such that it remains unclear if a particular method can be successfully applied to our problems . in @xcite",
    "the authors propose to use a spline collocation method which turns out to provide an efficient solution strategy for monge  ampre equations arising in the inverse reflector problem .    in section  [ subsec : collocation ]",
    "we explain the idea of a collocation method , which reduces the problem to finding an approximation of the solution within a finite dimensional space .",
    "then we discuss the choice of appropriate basis functions in section  [ subsec : splines ] .",
    "as discretization tool for the monge ",
    "ampre equations arising in the reflector and refractor problem , we propose a collocation method , see e.g. bellomo et al .",
    "@xcite for examples of collocation methods applied to nonlinear problems .",
    "let the pde @xmath86 in @xmath87 and constraints @xmath88 on @xmath89 be given . in this",
    "setting we approximate @xmath90 in a finite - dimensional trial subspace of @xmath91 , i.e. for some finite set @xmath92 and basis functions @xmath93 we choose the ansatz @xmath94 .",
    "next , we only require that the pde holds true on a collocation set @xmath95 which contains only finitely many points .",
    "so our approximation @xmath96 of the solution of our pde satisfies @xmath97 this discrete nonlinear system of equations is solved by a quasi - newton method , which uses trust - region techniques for ensuring global convergence of the method , see chapter  4.2.1 in @xcite and the references cited therein for the details and the proofs .",
    "we choose to apply a space of spline functions as ansatz space because of their advantageous properties , see e.g. @xcite for details on the theory of splines .    for a given interval",
    "@xmath98 $ ] we fix an equidistant knot sequence @xmath99 with @xmath100-fold knots at the interval end points @xmath101 for @xmath102 and @xmath103 for @xmath104 .",
    "moreover , we require that the knot sequence is strictly increasing inside the interval @xmath105 , i.e. @xmath106 for @xmath107 .    then , an appropriate basis for our spline space is given by the b - spline functions @xmath108 of order @xmath100 which can be defined via the recursion formula @xmath109}(t ) , \\quad n_{i , n}(t ) = ( n_{i , n-1 } * n_{i,1})(t),\\end{aligned}\\ ] ] where @xmath110}$ ] is the characteristic function of the interval @xmath111 \\subset { \\ensuremath{\\mathbb{r}}}$ ] and the convolution of two functions is defined as @xmath112 .",
    "since we require that the ansatz functions are twice differentiable , we choose cubic splines , i.e. @xmath113 .    in two dimensions the ansatz functions on a rectangular domain are obtained via a tensor ansatz and then are used as the @xmath114 in the previous subsection .",
    "the collocation points are chosen to coincide with the sequence of equidistant knots .",
    "since this leads to an underdetermined system of equations we use a _ not - a - knot condition _ at the very but last knot at each interval end , i.e. we require that the spline function is three times continuously differentiable at this knot .",
    "in other words , the restriction of the spline to the union of the two subintervals closest to each interval end is a cubic polynomial and the knot could be removed without changing the spline function .",
    "this is a much simpler approach than the one used in the previous work  ( * ? ? ?",
    "* section 4.2.3 ) but provides approximately the same accuracy .",
    "next , we consider the particular difficulties that we have to overcome to efficiently solve the equations of monge  ampre type that arise in the reflector and refractor problems .      the boundary conditions for both , the inverse reflector and refractor problems , are realized via a picard - type iteration as similarly proposed by froese  ( * ? ? ?",
    "* section 3.4 ) .",
    "we assume that the light rays hitting the boundary of the optical surface also hit the boundary of the target , i.e. @xmath115 , see ( * ? ? ?",
    "* section 4.5 ) for the details .",
    "this assumption is related to the edge ray principle , see",
    "e.g.  ( * ? ? ?",
    "* appendix b ) . note that @xmath39 also depends on the solution @xmath116 and its derivative @xmath117 . in order to have a boundary condition which is easier to handle",
    ", we do not fix the target coordinate on the boundary but only its normal component . since we do not know the normal component of the mapping @xmath39 for the exact solution we proceed as follows : for solving the nonlinear system of equations from our collocation method we use a newton - type method producing iterations @xmath118 , @xmath119 , starting with an initial guess @xmath120 .",
    "we denote the corresponding mappings by @xmath121 . in the @xmath122th iteration",
    "we require that the outer normal of the mapping @xmath123 of the current iteration and of the orthogonal projection of the mapping @xmath124 of the last iteration onto the boundary coincide , i.e. @xmath125 see ( * ? ? ?",
    "* section 4.5 ) ( cf . also ( * ? ? ? * section 3.3 ) ) .",
    "the left - hand side is then used as function @xmath33 in section  [ subsec : collocation ] .    since the last iteration is involved in the boundary condition the function @xmath33 changes in each iteration so that we solve different problems in successive steps . in order to ensure the existence of a solution of the subproblems we follow the approach by froese  (",
    "* section 3.4 ) and add a parameter @xmath126 in front of the right - hand side of the monge  ampre equation  , i.e. we replace @xmath31 by @xmath127 where @xmath126 is an additional unknown in our equation . an additional constraint to compensate this new degree of freedom",
    "is discussed in section  [ sec : size ] .      for proofs of results for existence and uniqueness of a solution",
    "we require the equation of monge  ampre type to be elliptic . in order to ensure ellipticity we manipulate the determinant in the same way as explained in  (",
    "* section 4.4 ) ( cf . also ( * ? ? ? * section 4.3 ) ) : let @xmath128_{1\\leq i ,",
    "j\\leq 2}\\in{\\ensuremath{\\mathbb{r}}}^{2\\times 2}$ ] be a matrix . for a penalty parameter @xmath129",
    "we define the modified determinant @xmath130 \\end{aligned}\\ ] ] which we use instead of the determinant in the left - hand side of the monge  ampre equation  . for an elliptic solution of this equation",
    "the left - hand side is exactly the same for the determinant and the modified determinant , see ( * ? ? ?",
    "* lemma 4.2 ) .",
    "furthermore , each non - elliptic solution of is not a solution of this equation , when the determinant is replaced by the modified determinant .      up to now",
    "the refractor is at most uniquely determined up to its size .",
    "therefore we define our initial guess @xmath131 of the problem appropriately and search for a solution @xmath90 of same size requiring that @xmath132 holds true , see also  ( * ? ? ?",
    "* section 4.5 ) .    note that this condition is taken account of by the additional unknown @xmath126 introduced in section  [ subsec : boundary_condition ] .      in case that @xmath133",
    "it is possible that a ray of light exceeds the critical angle and total internal reflection occurs , such that this light ray does not reach the target .",
    "of course we know that this is not true for the solution , because we require that all light rays hit the target .",
    "however during the iteration process of our nonlinear solver this phenomenon can appear .",
    "if this is the case the argument of the square root in the definition of @xmath134 in section  [ subsec : snell ] is negative at this position .    to overcome this instability we replace @xmath135 by its stabilized counterpart @xmath136 .",
    "then the situation of total internal reflection is treated like the case when the light ray hits the surface exactly at the critical angle .",
    "the refracted light ray most likely also misses the target and therefore this intermediate step can not satisfy the monge  ampre equation   such that further iterations are performed .    if total internal reflection does nt occur , which is the case we intend to have for our solution , we have @xmath137 and therefore obtain an equivalent problem .",
    "the convergence of newton - type methods sensitively depends on the choice of an initial guess that is close enough to the solution .",
    "we apply a nested iteration strategy in order to largely increase the stability of the solver but also in order to accelerate the solution procedure .",
    "we start with a coarse grid for the spline surface and a blurred version of the image for the illumination pattern .",
    "the blurring process is necessary because a coarse grid can not produce a very detailed image on the target area . for this reason we convolve the image , which is given as a raster graphic in our case , with a discrete version of the _ standard mollifier function _",
    "@xmath138 if @xmath139 and zero otherwise , namely with @xmath140 for @xmath141 and indices @xmath142 for the pixel coordinates .",
    "if our grid has @xmath143 nodes we alternately increase the resolution @xmath144 of the grid and decrease the strength @xmath100 of blurring , i.e. we solve the problem for different pairs of @xmath145 , see also ( * ? ? ?",
    "* sections 4.3 and 5.2 ) .      for the refractor problem we simply use the surface of a sphere with center at the position of the light source and a prescribed radius as initial guess .    for the reflector problem",
    "we start with a reflective surface producing a homogeneous illumination pattern on the target .",
    "we obtain this reflector by first using the method of supporting ellipsoids  @xcite and our collocation technique afterwards , see also  ( * ? ? ?",
    "* section 5.2.3 ) .",
    "the density function @xmath146 corresponds to the target illumination on @xmath13 and is given by @xmath147 bit digital grayscale images ( integer gray values in the range from @xmath148 to @xmath149 ) .",
    "since we divide by @xmath146 in right - hand side of the monge  ampre equation  , the function @xmath146 should be bounded away from zero . to guarantee this lower bound we adjust the image and use the modified function @xmath150 with @xmath151 , see also  ( * ? ? ?",
    "* ( 5.9 ) ) .",
    "numerical experiments show that the value @xmath152 leads to good results . in order to satisfy the energy conservation condition the function @xmath153 needs to be scaled accordingly .",
    "in this section we discuss some numerical simulation results obtained by the collocation method for the inverse reflector and refractor problems .      for both optical problems and all of our simulations we use the domain @xmath154 and a light source with a lambertian - type emission characteristics .",
    "its emitted luminous intensity @xmath155 is rotationally symmetric , shows a fast decay and is proportional to @xmath156 , where @xmath157 $ ] is the angle between the @xmath158-axis and the direction of observation .",
    "figure  [ fig : lightin ] shows the emission density function @xmath31 depending on our two - dimensional parameter @xmath159 and on @xmath160 .",
    "we choose a light source with this characteristic because the maximum possible angular direction for our rectangular domain is about @xmath161 and we therefore have a very low intensity at the edges of @xmath87 to make the setting more difficult .    as desired target illumination patterns we chose four images with a variety of characteristics , i.e. many different patterns and features ,",
    "see first row in figure  [ fig : refractor_results1 ] .",
    "the first three test images are taken from @xcite , while the fourth test image is our institute s logo .",
    "figure  [ fig : parametrization_mirror ] shows our geometrical setting for the inverse reflector problem where the resulting reflectors are approximately of the size as in this figure .",
    "here we have @xmath162 \\times [ -4,4 ] \\times \\{20\\}$ ] .        for the refractor problem",
    "the dimensions including the size of the optical surfaces are chosen very similarly to the case of the reflector problem to have a comparable situation , see figure  [ fig : parametrization_lens ] . here",
    "we use a part of the surface of a sphere with radius @xmath163 as initial guess , see also section  [ sec : initial_guess ] , and @xmath164 \\times [ -4,4 ] \\times \\ { 20 \\}$ ] .",
    "as refractive indices we use @xmath165 for the lens representing an average glass material and @xmath166 for the environment .",
    "the calculated reflector or lens is verified using the ray tracing software pov - ray  @xcite .      in the nested iteration",
    "we successively solve the nonlinear systems of equations for the following pairs @xmath167 of grid resolutions : @xmath168 , @xmath169 , @xmath170 , @xmath171 , @xmath172 , @xmath173 , @xmath174 , @xmath175 , @xmath176 , and @xmath177 , see section  [ sect : nestediteration ] for the details .",
    "the newton - type method ends after at most @xmath178 iterations .",
    "the regularization parameter in the modified determinant as defined in section  [ sec : ellipticity ] is set to @xmath179 which turns out to be an appropriate choice for all examples .",
    "( 0.09,-4.66 ) rectangle ( 12.76 , 4.84 ) ;    the results of the numerical simulations are depicted in figure  [ fig : refractor_results1 ] . in the first row",
    "the original test images are shown .",
    "the first three of them are chosen to examine different characteristics within the images , like thin straight lines and lettering as in the image `` boat '' , see figure  [ fig : reflector_results1_a ] .",
    "different patterns of high and low contrast are present in the image `` goldhill '' , see figure  [ fig : reflector_results1_b ] , in particular at the windows and roofs of the houses and the surrounding landscape in the background .",
    "the image `` mandrill '' in figure  [ fig : reflector_results1_c ] shows the face of a monkey with a lot of fine details like the whiskers .",
    "the fourth and most challenging of our test pictures is the logo of our institute in figure  [ fig : reflector_results1_d ] because it shows the highest possible contrast and contains jumps in the gray value from black to white",
    ". the iteration counts and timings for the numerical experiments are given in tables  [ tab : reflectors_a ] and [ tab : reflectors_b ] .",
    ".number of iterations of the newton - type method for each of the ten nested iterations and overall computing time in seconds for the standard test images in figure  [ fig : reflector_results1_a ]  boat `` , figure  [ fig : reflector_results1_b ] ' ' goldhill `` , and figure  [ fig : reflector_results1_c ] ' ' mandrill  . [ cols=\">,^,^,^,<,^,^,^ \" , ]     [ tab : reflectors_b ]    first , we notice that for a given original image the output images obtained by forward simulation for the reflector and refractor problem look very similar . in comparison to the original images",
    "the output images are slightly blurred and have a little less contrast but visually they only differ locally at very few locations .",
    "major deviations can be observed in the background of the institute s logo which is not completely black after the forward simulation of the mirror and the lens .",
    "this is because of the minimal gray value needed to avoid the division by zero , see section  [ sec : min_gray ] .",
    "we see that all of these characteristics of the first three test images are well preserved by our method .",
    "the computing time for the refractor is approximately twice as long as for the reflector but still acceptable with about @xmath180 minutes .    for the fourth test image we had to adjust the parameters in the nested iteration process to handle the sharp edges and work with a finer grid ,",
    "see table  [ tab : reflectors_b ] .",
    "we also raised the minimal gray value in section  [ sec : min_gray ] from @xmath181 to @xmath182 obtaining a proportion between black and white of @xmath183 .",
    "these parameters lead to results showing also a very sharp logo for both the inverse refractor and reflector problems .",
    "note that nevertheless in two stages of the nested iteration for the refractor problem the quasi - newton method was stopped because the maximal number of iterations was reached without meeting the required tolerances , see table  [ tab : reflectors_b ] .",
    "this happened only for two intermediate steps of the nested iteration process while we observe convergence in the last iteration , which shows us that this does not affect the overall method . in the case of the refractor problem the gray line below the letters",
    "is irregularly illuminated and slightly too bright .",
    "nevertheless , the shape of this line is reproduced very precisely .",
    "the optically active surface of the lens for the projection of the institute s logo is displayed in figure  [ fig : refractor_results2 ] .",
    "note that the characters used in the logo can be recognized on the surface .",
    "we observe that they cover about the half of the lens surface while this is not the case in the original image .",
    "of course this is what we expect because we want to redirect a maximal amount of incoming light onto these letters .",
    "for the efficient and stable solution of the inverse reflector and refractor problems we propose a numerical b - spline collocation method which is applied to the formulation of the inverse optical problems as partial differential equations of monge  ampre type and appropriate boundary conditions .",
    "several challenges for the construction of a stable numerical solution method have been met , e.g. we detailed how to enforce ellipticity constraints to ensure uniqueness of the solution and how to handle the involved boundary conditions .",
    "a nested iteration approach simultaneously considerably improves the convergence behavior and speeds up the numerical procedure .    for the inverse refractor problem",
    "our algorithm provides a reliable and fast method to compute one of the two surfaces of the lens under the assumption of a point - shaped light source . shaping the second surface of the lens , e.g. to minimize fresnel losses , and exploring possible solution strategies for the problem for extended real light sources are topics of upcoming research .",
    "the authors are deeply indebted to professor dr .",
    "wolfgang dahmen for many fruitful and inspiring discussions on the topic of solving equations of monge  ampre type .",
    "we thank elisa friebel , silke glas , and gudula kmmer for proofreading the manuscript .",
    ", _ generalized functional method of nonimaging optical design _ , in nonimaging optics and efficient illumination systems iii , 2006 , p.  633805 .",
    "doi : http://dx.doi.org/10.1117/12.678600[10.1117/12.678600 ] .",
    ", _ solving the monge - ampre equations for the inverse reflector problem _ , math .",
    "models methods appl .",
    ", 25 ( 2015 ) , pp .",
    "doi : http://dx.doi.org/10.1142/s0218202515500190[10.1142/s0218202515500190 ] .",
    ", _ recent developments in numerical methods for fully nonlinear second order partial differential equations _ , siam rev . , 55 ( 2013 ) , pp .",
    "doi : http://dx.doi.org/10.1137/110825960[10.1137/110825960 ] .",
    ", _ a numerical method for the elliptic monge - ampre equation with transport boundary conditions _ , siam j. sci .",
    "comput . , 34 ( 2012 ) , pp .",
    "doi : http://dx.doi.org/10.1137/110822372[10.1137/110822372 ] .",
    ", _ the monge  ampre equation _",
    "44 of progress in nonlinear differential equations and their applications , birkhuser , basel , 2001 .",
    "doi : http://dx.doi.org/10.1007/978-1-4612-0195-3[10.1007/978-1-4612-0195-3 ] .",
    ", _ fully nonlinear pdes in real and complex geometry and optics _ , vol .  2087 of lecture notes in math . ,",
    "springer , heidelberg , 2014 , ch .",
    "refraction problems in geometric optics , pp",
    ".  95150 .",
    "doi : http://dx.doi.org/10.1007/978-3-319-00942-1_3[10.1007/978-3-319-00942-1_3 ] .",
    ", _ determination of reflector surfaces from near - field scattering data .",
    "ii : numerical solution _ , numer . math .",
    ", 79 ( 1998 ) , pp .",
    "doi : http://dx.doi.org/10.1007/s002110050351[10.1007/s002110050351 ] .",
    ", _ designing freeform lenses for intensity and phase control of coherent light with help from geometry and mass transport _ , arch . ration .",
    ", 201 ( 2011 ) , pp .  10131045 .",
    "doi : http://dx.doi.org/10.1007/s00205-011-0419-x[10.1007/s00205-011-0419-x ] .",
    ", _ differential equations for design of a freeform single lens with prescribed irradiance properties _ , opt . engrg .",
    ", 53 ( 2014 ) , p.  031302 .",
    "doi : http://dx.doi.org/10.1117/1.oe.53.3.031302[10.1117/1.oe.53.3.031302 ] .",
    ", _ illumination lenses designed by extrinsic differential geometry _ , in proceedings of spie , vol .",
    "3482 , spie , bellingham , wa , 1998 , pp .",
    "doi : http://dx.doi.org/10.1117/12.322042[10.1117/12.322042 ] .",
    ", _ a survey of inverse surface design from light transport behavior specification .",
    "_ , computer graphics forum , 24 ( 2005 ) , pp",
    ".  773789 .",
    "doi : http://dx.doi.org/10.1111/j.1467-8659.2005.00901.x[10.1111/j.1467-8659.2005.00901.x ] .",
    ", _ tailoring freeform lenses for illumination _ , in proceedings of spie , j.  m. sasian and p.  k. manhart , eds .",
    "4442 of novel optical systems design and optimization iv , spie , bellingham , wa , 2001 , pp .",
    "doi : http://dx.doi.org/10.1117/12.449957[10.1117/12.449957 ] .",
    ", _ efficient optimal design of smooth optical freeform surfaces using ray targeting _ , opt .",
    "commun . , 300 ( 2013 ) , pp .",
    "doi : http://dx.doi.org/10.1016/j.optcom.2013.02.067[10.1016/j.optcom.2013.02.067 ] .",
    ", _ freeform illumination design : a nonlinear boundary problem for the elliptic monge  ampre equation _ , opt .",
    "lett . , 38 ( 2013 ) , pp .",
    "doi : http://dx.doi.org/10.1364/ol.38.000229[10.1364/ol.38.000229 ] ."
  ],
  "abstract_text": [
    "<S> we consider the inverse refractor and the inverse reflector problem . the task is to design a free - form lens or a free - form mirror that , when illuminated by a point light source , produces a given illumination pattern on a target . </S>",
    "<S> both problems can be modeled by strongly nonlinear second - order partial differential equations of monge  ampre type . in [ math . </S>",
    "<S> models methods appl . </S>",
    "<S> sci . 25 ( 2015 ) , </S>",
    "<S> pp . </S>",
    "<S> 803837 , doi : http://dx.doi.org/10.1142/s0218202515500190[10.1142/s0218202515500190 ] ] the authors have proposed a b - spline collocation method which has been applied to the inverse reflector problem . </S>",
    "<S> now this approach is extended to the inverse refractor problem . </S>",
    "<S> we explain in depth the collocation method and how to handle boundary conditions and constraints . </S>",
    "<S> the paper concludes with numerical results of refracting and reflecting optical surfaces and their verification via ray tracing .    </S>",
    "<S> inverse refractor problem , inverse reflector problem , elliptic monge  ampre equation , b - spline collocation method , picard - type iteration    35j66 , 35j96 , 35q60 , 65n21 , 65n35    * ocis . </S>",
    "<S> * ( 000.4430 ) numerical approximation and analysis , ( 080.1753 ) computation methods , ( 080.4225 ) nonspherical lens design , ( 080.4228 ) nonspherical mirror surfaces , ( 080.4298 ) nonimaging optics , ( 100.3190 ) inverse problems </S>"
  ]
}