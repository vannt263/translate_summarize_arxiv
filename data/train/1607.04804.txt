{
  "article_text": [
    "an inverse atmospheric dispersion problem is stated as follows : given the topography , the meteorological conditions and a set of detector readings determine where and when the hazardous substance was released and in which quantities .",
    "the problem is known as a source reconstruction problem , and it is easy to state but harder to solve due to being , like most inverse problems , ill - posed @xcite,@xcite .",
    "spurred by various applications including the locating of industrial plants marchuk1986 , determining the amount of radioactive nuclides released from chernobyl @xcite and fukushima @xcite , pin - pointing nuclear tests @xcite , estimation of material released from volcanoes @xcite,@xcite,@xcite a number of different methods for addressing the inverse problem have been suggested . even though the main difference perhaps lies in the interpretation of the results these methods",
    "are usually divided into two main categories : the probabilistic approach with its bayesian methods and the deterministic approach with its optimisation methods . in the bayesian setting a likelihood function is calculated and weighted with any a priori information that one has at hand to yield a posterior probability density function , which is then sampled to yield an estimate of the sought source term ( see e.g. @xcite for an introduction to general bayesian inverse problems ) . in the deterministic setting with optimisation methods a norm is devised under which the sensor response of candidate sources is compared with the given sensor readings .",
    "the candidate source that best fits the given sensor readings ( minimizes the distances under the chosen norm ) is then deemed the solution to the inverse problem .    for linear inverse atmospheric dispersion problems",
    "these methods come in many different flavours and have often been devised with a given application in mind : usually there are - a priori imposed - restrictions on the source characteristics , e.g. the method may assume that the source is well localised ( located at a single point in space ) and that the release was instantaneous .",
    "for example yee and coauthors have written a series of papers adapting the bayesian method to inverse dispersion problems of increasing complexity @xcite,@xcite,@xcite,@xcite and @xcite .    to use an optimisation method",
    "the inverse dispersion problem has to be cast in a manner where the distance ( under a chosen norm ) function between model sensor data and the given sensor readings can be minimized .",
    "usually a least squares solution is sought , and in @xcite conditions under which the least square problem is well defined is presented .",
    "much of the literature focuses on the problem where it is a - priori assumed that there is only a single source , see e.g. @xcite,@xcite,@xcite and iss2012 .",
    "there are however exceptions , for example in @xcite the renormalisation method ( least square method under the renormalisation norm ) presented in @xcite is generalised to cover an unknown number of point sources , and in @xcite the space - time has been discretised and an optimal source term is constructed by forming a union of ( space - time ) grid sized point sources .    in this paper",
    "we make a contribution to the literature on optimisation methods by applying a bilevel optimisation method , see @xcite , to a linear inverse dispersion problem .",
    "a bilevel optimisation method splits the optimisation problem in two : into a leader ( upper level ) problem and a follower ( lower level ) problem and they are solved concurrently rather than simultaneously .",
    "we consider dispersion problems where the source is a single point source emitting at a constant rate .",
    "this problem is well suited to a bilevel optimisation method where the follower problem concerns solving for the emission rate and the leader problem pinpointing the location of the source . for the bilevel optimisation method to work",
    "properly the follower problem is required to have minima , ideally a strict minimum .",
    "we therefore study local strict convexity of the follower problem , see theorem thm : local_convexity for sufficient conditions .",
    "we then explore the concept of local strict convexity and its connection to ill - possedness of inverse problems through a few toy - model examples . following this the paper",
    "is rounded off with the bilevel optimisation method being applied to dispersion data from a series of wind tunnel experiments of urban environments of varying complexity .",
    "the wind tunnel data was collected as part of the european defence agency category b project moditic . in all cases",
    "the boundary layer is neutrally stable , and we only consider cases where the released gas is neutrally buoyant making the dispersion problem linear .",
    "a bilevel optimization problem is a constrained optimization problem where the constraints also includes an optimization problem .",
    "the problem is divided into an upper level or leader problem , with decision variables @xmath0 , and a lower level or follower problem , with decision variables @xmath1 . here",
    "@xmath2 and @xmath3 may be restricted to integers or nonnegative values .",
    "we follow the notation of @xcite , p. 6 .",
    "the leader problem has the form @xmath4where @xmath5 and @xmath6 , respectively , are the leader objective function and constraint function , and @xmath7 is an optimal solution to the follower problem@xmath8an ambiguity occurs if the follower problem has several optimal solutions , i.e. , @xmath9 is set  valued .",
    "then the follower is indifferent towards these points , but the leader objective may be different for different points in @xmath9 , and there is no way for the leader to direct the follower to the upper level optimal point . therefore , there may be no optimal solution to the bilevel program although all functions are continuous and @xmath10 are compact , cf .",
    "@xcite , p. 11 . in our problem",
    "the sets @xmath10 will be positive orthants , the follower objective function @xmath11 will be a mahalanobis distance function measuring the discrepancy between model data and measurements . the leader objective function @xmath5 will have the form@xmath12hence minimizing the least square function , but penalizing large values of @xmath13 , which will act as a regularization of the problem ( @xmath14 is a regularization parameter ) .",
    "in the setting we are considering we have a priori assumed that the source is a point source releasing a neutrally buoyant substance at a constant rate . under these assumptions",
    "the source location @xmath15 is a  nonlinear model parameter while the emission rate @xmath16 is a linear model parameter . in general",
    ", our model formulation allows a linear combination of basic sources , with a linear positive weight vector @xmath17 . to solve the inverse problem",
    "we need a source - sensor relationship . since the problem is linear the source - sensor relationship is given a matrix relationship , which for computational efficiency @xcite is expressed through the adjoint formulation of the problem , thus @xmath18 is a matrix function with nonnegative elements ( no sinks are considered ) and the adjoint model data @xmath19 .",
    "the measured data @xmath20 is the sensor response.we regard @xmath21 as a random vector , and we assume that the adjoint model data @xmath22 represent the mean of @xmath21 .",
    "we also assume that the components @xmath23 of @xmath21 are statistically independent and that the variance of @xmath23 is@xmath24where @xmath25 is a given function . we let the follower objective function be the _ mahalanobis distance _ between @xmath26 and @xmath22 , viz .",
    ", @xmath27 in particular , we want to be able to choose a scale invariant distance function , giving equal emphasis to all @xmath28 , regardless of their size .",
    "if the follower problem is strictly convex , the follower problem has a unique optimal solution @xmath29 for each @xmath30 , and by mild assumptions on @xmath31 , an envelope theorem holds ( e.g. , milgromsegal2002 , theorem 2 , p. 586 ) , which implies that the optimal value function@xmath32is continuous .",
    "therefore , the leader problem @xmath33has a solution since@xmath34however , in our setting the only situation when the follower problem is guaranteed to be strictly convex is when @xmath35 is constant , i.e. , the classical least square method .",
    "however , we may derive conditions for _ local convexity _ , as the following theorem shows .",
    "[ thm : local_convexity]assume that @xmath36where@xmath37and @xmath38 .",
    "consider a fixed @xmath13 and suppose that @xmath39 is positive and twice continuously differentiable in a neigbourhood of @xmath40.then@xmath41where@xmath42moreover , if @xmath43 has full rank then    1 .   if @xmath44 for all @xmath45 then @xmath46 is strictly convex in a neighborhood of @xmath47 .",
    "2 .   if @xmath48 for all @xmath45 then @xmath46 is strictly concave in a neigborhood of @xmath47 .",
    "the formulas for the first and second derivatives of @xmath46 are proved by elementary but tedious calculations , using the chain rule and the quotient rule for differentiation .",
    "if @xmath43 has full rank , and @xmath49 for all @xmath45 , then@xmath50for all @xmath51,where@xmath52hence @xmath53 .",
    "assume that @xmath54 .",
    "then @xmath55 for all @xmath45 .",
    "note that @xmath56 , since when @xmath57 we have @xmath58hence @xmath59 , since the vectors @xmath60 , @xmath61 span @xmath62 .",
    "this shows that @xmath63 is positive definite at @xmath47 . by continuity",
    ", @xmath63 is positive definite , and hence @xmath46 strictly convex , in a neighborhood of @xmath47 .",
    "similarly , if @xmath43 has full rank and @xmath64 , then @xmath65where @xmath66and it follows with a similar argument as above that @xmath46 is strictly concave in a neighborhood of @xmath47 .",
    "most inverse modelling methods works perfectly for synthetic data , i.e. when the `` observed '' sensor response is calculated using a dispersion model ( the same dispersion model that is then used to solve the inverse problem ) . indeed showing that an inverse modelling method works well for synthetic data and , in particular , slightly perturbed synthetic data",
    "is usually included in the body of work motivating the method . in view of the theorem",
    "we make the following observation .",
    "note that when @xmath57 , then @xmath67 , so for small enough @xmath68 , @xmath69 is always positive , if @xmath40 is restricted to a compact set .",
    "hence for @xmath21 sufficiently close to @xmath70 , @xmath71 is convex .",
    "this explains why most methods work well on synthetic model data with small perturbations .",
    "we will now restrict ourselves to functions @xmath35 which are continuous , increasing , convex , and positive for @xmath72 , and satisfying@xmath73moreover , we assume that @xmath39 is twice continuously differentiable , except possibly at a finite number of points . hence @xmath74 at all points where @xmath75 exists . note that if @xmath35 satisfies these conditions , so does @xmath76for any @xmath77 ,",
    "so the class of functions @xmath39 we consider is scale  invariant .",
    "we consider three examples:@xmath78    functions . ]",
    "recall that    @xmath79    since we assume that @xmath80 and @xmath81 for @xmath82 , we can write @xmath69 on the form@xmath83where@xmath84clearly , @xmath85 if and only if the two factors have the same sign , i.e. , @xmath86 ^{c}$ ] , and @xmath87 if and only if @xmath88 .",
    "to analyze these conditions further we need to consider the cases when @xmath89 have the same sign and when they have different signs .",
    "if @xmath89 have the same sign then @xmath88 if and only if @xmath90 ( this includes the limiting cases @xmath91 or @xmath92 , with @xmath93 and @xmath94 ) .",
    "if @xmath95 have different signs , i.e. , @xmath96 , then @xmath97 if and only if @xmath98 ^{c}$ ] . by the assumptions on @xmath39 , @xmath99 and @xmath100 are defined everywhere except possibly at a finite number of points .",
    "henceforth , we only consider points where @xmath99 and @xmath100 are defined",
    ". we can now conclude that @xmath87 if and only if either i ) @xmath101 and @xmath102 , or ii ) @xmath103 ^{c}$ ] and @xmath96 , or iii ) @xmath104 and @xmath105 .",
    "likewise , we can conclude by complementarity that @xmath85 if and only if either i ) @xmath106 ^{c}$ ] and @xmath107 , or ii ) @xmath108 and @xmath96 , or iii ) @xmath109 and @xmath105 or iv ) @xmath110 .",
    "relying on these inequalities we can find domains where a distance function is guaranteed to be strictly convex or strictly concave .",
    "consider @xmath111 , the linear case . then @xmath112 and @xmath113 . hence @xmath114 and @xmath115 if and only if @xmath116 , i.e. , @xmath117 .",
    "moreover , @xmath118 if and only if @xmath119 .",
    "hence for fixed @xmath21 , @xmath46 is strictly convex on the set @xmath120 , and strictly concave on the set @xmath121 .",
    "let for example@xmath122then@xmath123and @xmath46 is strictly convex on @xmath124 , and strictly concave on @xmath125 ( the last condition is not active ) .",
    "of course , @xmath46 may be strictly convex or concave on points outside these sets also ;  these conditions are sufficient , but not necessary .",
    "the domains of local convexity and local concavity are plotted in the next figure .    , the local convexity region ( blue ) and the local concavity region ( red ) , determined from theorem 1 .",
    "the minimum point is marked with a red circle . ]",
    "when @xmath39 is rescaled  ( i.e. , replacing @xmath35 by @xmath126 ) , the derivatives are scaled according to @xmath127 and @xmath128 , and hence @xmath129 is replaced by @xmath130 , and @xmath131 is replaced by @xmath132 .",
    "in theorem [ thm : local_convexity ] we established sufficient conditions for the objective function @xmath46 to be locally strictly convex with the view of determining when the follower problem is well posed .",
    "alas , strict convexity of the objective function is not sufficient to make the follower problem convex as the constraints have to be taken into account .",
    "we explore the interplay between the objective function and the constraints and their effect on minima and well posedness of the minimization problem through a series of examples .",
    "it is instructive to begin with the linear case @xmath133 , and then proceed to the nonlinear cases ( smooth threshold and piecewise linear ) , compare ( [ eqn : thesigmas ] ) .      in the linear case ,",
    "the minimization problem for @xmath46 can be formulated as a constrained minimization problem with a convex objective function . however , the constraints are not convex , which can cause multiple minimum points for certain values of @xmath43 and @xmath21 . for @xmath134 ,",
    "@xmath46 is a strictly convex function of @xmath135:@xmath136writing @xmath5 on the form@xmath137where @xmath138 is the number of @xmath139 , we see that for @xmath140 , the level surface @xmath141 is an @xmath142axial ellipsoidal cylinder with center coordinates @xmath143 and corresponding semiaxes @xmath144 for all @xmath45 such that @xmath145 , extending linearly along all coordinates @xmath146 for which @xmath147 .",
    "let us assume that all @xmath148 for simplicity .",
    "then for @xmath140 the level surface @xmath149 is an @xmath150axial ellipsoid centered at @xmath151 with semiaxes @xmath152 .",
    "the minimization problem for @xmath46 can be formulated as a constrained minimization problem@xmath153where @xmath154 , and @xmath155 , where@xmath156and @xmath157the objective function @xmath158 , is convex , and depends on @xmath159 , but is independent of @xmath43 .",
    "the inequality constraints are linear and hence convex .",
    "the equality constraints depend on @xmath43 , but are independent of @xmath21 , and are not convex , so the problem is not convex .",
    "we have thus separated the dependencies of @xmath43 and @xmath21 into the objective and constraint functions , respectively .",
    "the equality constraints @xmath160 define an @xmath161dimensional parametrized surface @xmath162 in @xmath163 by @xmath164 .",
    "the @xmath161dimensional tangent space to @xmath165 at @xmath166 is spanned by the tangent vectors@xmath167the karush - kuhn - tucker ( kkt ) conditions ( see e.g. @xcite ) for the minimization problem are@xmath168which are necessary conditions for minimum .",
    "assume for simplicity that we have a minimum with @xmath169 .",
    "then @xmath170 so @xmath171 .",
    "substituting the first equation in the second we get @xmath172geometrically , this conditions means that the gradient of @xmath5 is orthogonal to the tangent space of @xmath165 at @xmath173 .",
    "hence , in the @xmath174space , minimal points @xmath175 are characterized by points @xmath176 where the @xmath161dimensional surface @xmath177 is tangent to the ellipsoid @xmath178 .",
    "the optimal value is then @xmath179 .",
    "suppose now that @xmath43 is fixed .",
    "for @xmath21 , the center of the ellipsoidal isosurfaces of @xmath5 , let @xmath180 denote the smallest isosurface of @xmath5 that intersects @xmath165 .",
    "for generic @xmath181 , the ellipsoid @xmath180 will contain only one point @xmath182 , defined by the unique minimum point @xmath175 .",
    "however , for @xmath26 in some exceptional lower  dimensional set , @xmath183 will touch @xmath165 at several points , in which case we have several minimum points @xmath175 . in that case ,",
    "@xmath43 or @xmath26 can be perturbed so that either of the multiple minima is perturbed into a single global minimum .",
    "hence the global minimum point varies discontinuously with @xmath43 and @xmath21 , and the problem is ill posed ( unless @xmath21 is restricted to be generic , e.g. , if @xmath184 is sufficiently close to the surface @xmath165 ) .",
    "[ ex : linear]let@xmath185where @xmath186 .    .",
    "the figure shows minimum point @xmath187 as a red dot , the surface @xmath165 parametrized for @xmath188 , and the ellipsoidal isosurface for @xmath46 with optimal value @xmath189 . the center @xmath21 of the ellipsoid is marked by a blue cross . ]    .",
    "the figure shows the minimum point @xmath190 marked with a red circle , with the minimal value @xmath189 .",
    "also isocurves for @xmath46 are shown . ]    , two minimum points @xmath191 , @xmath192 marked by red dots , parametric surface @xmath165 plotted for @xmath188 , and ellipsoidal isosurface for @xmath46  and optimal value @xmath193 .",
    "the center @xmath21 of the ellipsoid is marked by a blue cross . ]    .",
    "two minimal points @xmath194 , @xmath195 , marked by red circles .",
    "minimum value @xmath196 .",
    "isosurfaces for @xmath46 also shown . ]",
    "[ [ the - onedimensional - case ] ] the one  dimensional case + + + + + + + + + + + + + + + + + + + + + + + +    distinct minima can not occur in the case @xmath197 .",
    "we have    if @xmath198 , and some @xmath199 then @xmath200where @xmath201and @xmath46 has minimum value @xmath202 , attained for@xmath203which is a strict minimum .",
    "moreover , the minimum point @xmath204 depends continuously on @xmath205 , @xmath206 , so the minimization problem is well  posed .",
    "the formula for @xmath46 is proved by elementary calculations .",
    "the final conclusion follows from the observation that @xmath207 is a second order polynomial in @xmath208 .",
    "note that @xmath209 and @xmath210 , and the sensitivity of the minimum point @xmath211 is given by@xmath212so the minimum point @xmath204 is very sensitive for @xmath205 and @xmath206 when @xmath213 is small , provided that @xmath214 .",
    "in contrast to the linear case , @xmath46 can have multiple local minima for @xmath197 in the nonlinear case .",
    "for certain values of @xmath43,@xmath21 , these minimum values may be identical , hence distinct global minima .",
    "when this occurs , the minimum problem becomes ill  posed , as the following example shows .",
    "let@xmath215and @xmath216if @xmath217 , then @xmath46 has two distinct global minimum points for the smooth threshold @xmath218 , ( the smooth threshold is defined in equation ( [ eqn : thesigmas ] ) ) , see figure [ fig : globalmin_t10732 ] . moreover , for all @xmath219 in a neighborhood @xmath220 of @xmath221 , @xmath46 has two distinct local minima . for @xmath222 in @xmath220 ,",
    "the left local minimum of @xmath46 is global , and for @xmath223 in @xmath220 , the right local minimum of @xmath46 is global .",
    "hence when @xmath219 increases from @xmath224 to @xmath225 , the global minimum point @xmath226 of @xmath207 jumps from @xmath227 to @xmath228 at @xmath229 , see figures [ fig : globalmin_t105 ] and fig : globalmin_t110 .",
    "the function @xmath46 shows a similar behaviour for the piecewise linear @xmath39 , with a slightly different value of @xmath221 .     for @xmath217 .",
    "at this transition point , the smooth threshold @xmath230 gives two distinct global minima , while the piecewise linear @xmath230 gives a single global minimum to the right .",
    "the transition point for the piecewise linear @xmath230 occurs for a sligthly different value of @xmath219 . ]     for @xmath224 .",
    "both smooth threshold and piecewise linear @xmath230 give two distinct local minima , the left one is also global minimum . ]     for @xmath231 .",
    "both smooth threshold and piecewise linear @xmath230 give two distinct local minima , the right one is also global minimum . ]    in higher dimensions , nonlinear @xmath39 give similar behaviour of @xmath46 regarding multiple global minima and ill ",
    "posedness of the minimization problem .    in higher dimensions ,",
    "the nonlinear @xmath39 functions causes a similar behaviour as the linear @xmath39 regarding multiple local minimas of @xmath46 . to illustrate this",
    ", we show a slight perturbation of the bimodal example , example [ ex : linear ] , above for the linear @xmath39 .",
    "the perturbed problem still have two local minima , but only one of them is a global min .",
    "let @xmath232then we get     functions give two local minima in this case , and quite similar isocurve pattern .",
    "comparison with the linear case , figure [ fig : linear_case_t5 ] , in the previous example reveals a similar pattern.,title=\"fig : \" ]   functions give two local minima in this case , and quite similar isocurve pattern . comparison with the linear case , figure [ fig : linear_case_t5 ] ,",
    "in the previous example reveals a similar pattern.,title=\"fig : \" ]    in some cases there are huge differences between smooth threshold and piecewise linear @xmath39 .",
    "for example , by randomly choosing @xmath43 and @xmath26 , we found@xmath233which gives        a motivation for using a scaled piecewise linear @xmath39 rather than the linear @xmath39 is that model values @xmath40 ( averages ) below a detection limit should give a variance @xmath39 of the measurement value @xmath234 which is independent of @xmath40 ( corresponding to the background noise ) .",
    "we think it is a good compromise to use the smooth threshold @xmath39 , giving a variance with a strictly positive lower bound , but avoiding potential numerical difficulties as pictured in figure [ fig : qualitative_difference ] above .",
    "we will now apply the bilevel optimisation method to experimental data reconstructing the source term .",
    "the different choices of distance function , smooth threshold , piecewise linear , linear and constant will be compared and contrasted .",
    "the experimental data stems from the european defence agency category b project moditic where wind tunnel experiments were conducted involving release of both neutrally buoyant gas as well as dense gas over urban environments of varying complexity . in all cases the wind tunnel boundary layer was neutrally stable .",
    "the gas was released from a single point source either as a puff or continuously at a constant rate . for the full details on the experimental set up we refer to @xcite and @xcite .      as the bilevel optimisation method described above",
    "is designed for linear inverse dispersion problems we only consider cases where the released gas is neutrally buoyant , and to further reduce the scope we focus on two scenarios referred to as the simple array , a symmetric case with four buildings , and the complex array , a less symmetric case involving fourteen buildings .      the dimensions of the simple array , with the positions of the synchronized detectors we use for backtracking is shown in figure [ fig : simplearray ] .",
    "the wind direction in the wind tunnel experiments is aligned with the x - axis in figure [ fig : simplearray ] , and as shown in the figure the simple array may aligned at two different angles : we denote the alignment in the upper pane as 0 degrees  and the alignment in the lower pane as 45 degrees . in each scenario four",
    "synchronized detectors were used , hence the reference 4 ffid in figure [ fig : simplearray ] , and we chose three different sets of locations for these detectors : we refer to these as case a , b and c. in addition to this two different source locations were available : these we denote s1 and s2 , both s1 and s2 ( at the origin ) are located at 8h upwind ( = -0.88 m ) in the x direction , but s1 is shifted off the x - axis by 1.5h ( = 0.165 m ) in the + y direction . the location of s2 was chosen to be the origin of the coordinate system .",
    "the diameter of the sources is 0.1 m ( to be compared to building height and sides of h=0.11 m ) .",
    "a constant release rate of 50l / min=8.33e-4 m@xmath235/s was used in all scenarios .      in the complex array there more buildings present and there is less symmetry .",
    "the configuration also opens up for a larger number of sensible detector locations , however , still only 4 synchronized detectors were used in these scenarios . for the complex array we chose five different sets of detector configurations : these are denoted case a through to e , and these are shown together with the geometry of the complex array in figure fig : complexarray .",
    "note that some detectors are located on the roof tops ( cases a and c ) and other are inside the street canyons ( cases b , d and e ) .",
    "two different source locations were used s1 and s2 .",
    "the diameter of the sources is 0.1 m .",
    "the source s1 is defined to be at the origin ( see figure [ fig : complexarray ] ) while s2 is located upwind at x=-8h=-0.88 m and y=0 . s1 and s2 are both located on the ground . as for the empty and complex array the source strength is 50l / min=8.33e-4m@xmath235/s .      to apply the bilevel optimisation method to the sensor data retrieved from the wind tunnel",
    "we need a relationship between the source and the sensors , i.e. a dispersion model .",
    "since we are in a setting where a ) we are considering an urban environment and b ) we are trying to gauge the fidelity of the inverse solver , we opt to use a computational fluid dynamics solver for the wind field .",
    "we are only considering the steady state of the dispersion scenario ( not the transient behaviour when the source is turned on and subsequently off ) , hence a reynolds - averaged navier - stokes ( rans ) solver is suitable .",
    "see @xcite for rans solutions of moditic scenarios . the rans solution in each case defines a source - sensor relationship which could be used to solve the inverse problem , however , due to computational efficiency it is preferable to solve the adjoint dispersion problem @xcite .",
    "the dispersion problem is self - adjoint , hence the adjoint solution is obtained by reversing the advection while leaving the diffusive component untouched .",
    "the rans solver in pheonics was adapted accordingly to yield adjoint rans solutions for the simple array and the complex array @xcite .",
    "one adjoint wind field was computed for each sensor .",
    "these adjoint flow fields constitute a source - sensor relationship .",
    "we will briefly outline the bilevel optimisation algorithm before using it to reconstruct the moditic sources .      in each case",
    "four synchronous sensors where used , let us number them @xmath236 . for each sensor @xmath45 compute the adjoint dispersion plume @xmath237 for each grid point @xmath238 . using the adjoint plume the model sensor data is given by @xmath239 where @xmath240 is the source strength of a point source located at grid point @xmath238 .",
    "we denote the sensor data obtained in the wind tunnel @xmath241 .    1",
    ".   choose the weight @xmath39 in the distance function .",
    "choose detection threshold @xmath242 ( may be known from the sensor manufacturer ) .",
    "choose penalty coefficient @xmath243 .",
    "follower problem : solve for the optimal emission rate @xmath244 in each grid point @xmath238 by@xmath245 3 .",
    "compute the envelope grid function @xmath246 for each @xmath238 in the grid .",
    "leader problem : minimize the grid function@xmath247,where @xmath248 is a penalty term , to find the optimal source location @xmath249 5 .   the optimal solution is given by @xmath250 .",
    "below we present the source reconstruction results by showing the estimation error in the @xmath251 and @xmath234 directions ( source location ) and in the emission rate respectively . as the estimated emission rate varies over a large range we present the error in the @xmath252 value of the emission rate .",
    "we consider four different choices of weight @xmath39 in the distance function : smooth threshold , piecewise linear , linear ( as defined in equation ( [ eqn : thesigmas ] ) ) and in addition a constant weight @xmath253 .",
    "the error for each parameter for each choice of @xmath39 for each data set in the simple and complex arrays are presented in scatter plots for comparison .",
    "these results are presented for two different choices of high emission rate penalty factor @xmath243 , @xmath254 and @xmath255 .",
    "in addition the results are presented for two different flavours of the inverse problem : the `` unconstrained '' one where the source could be located anywhere on or above the ground , and the `` conditional '' case where the source is assumed ( correctly ! ) to be on the ground .    to be specific , @xmath253 in the constant case .",
    "in the other cases , a scaled @xmath39 is used : @xmath256 . in the probabilistic interpretation , @xmath257",
    "may be thought of as a detection limit . when the model value @xmath40 is below the detection limit , the standard deviation of the measured value @xmath258 is exactly @xmath242 in the piecewise linear case , and approximately @xmath257 in the smooth case",
    "we use @xmath259 in this study ( a choice of @xmath260 gives no noticeable difference ) .      setting @xmath254 and",
    "@xmath259 yield the following results .",
    "the average errors ( averaged over all data sets ) is presented in the following table :    [ cols= \" < , < , < , < , < \" , ]",
    "the bilevel optimisation method is well suited to linear inverse atmospheric dispersion problems where a single source is emitting at a constant rate : the problem decouples in a manner where the optimal source strength in each grid point can be solved for first ( follower problem ) and then the optimal location of the source can be determined ( leader problem ) . when gauging how good a candidate source is , namely how near its candidate sensor readings are to the observed sensor readings - indeed how near its averaged candidate sensor readings are to the averaged observed sensor readings , a distance function is required .",
    "the distance function can be weighted , and since averaged sensor readings are compared a natural choice of weight involves the variance of the measurements .",
    "the simple choice is the let the weight vary linearly with the model sensor reading .",
    "as the model sensor reading @xmath263 drops below the detection threshold however it is desired that the variance of the real measurement @xmath234 becomes independent of the model sensor reading @xmath40 .",
    "the piecewise linear weight remedies this , but it comes at the price of introducing a non - smoothness . we propose that this shortcoming is addressed by introducing a smooth threshold weight keeping the benefit of the piecewise linear weight ( giving a variance with a strictly positive lower bound ) . as shown in figure [ fig : qualitative_difference ] the non - smoothness of the piecewise linear weight can yield a minimization problem which is qualitatively different from smooth threshold distance function and the linear one .",
    "the method has been applied to experimental data from wind tunnel studies of built up environments . comparing average errors in the estimated parameters , the smooth threshold distance function performs as well as the piecewise linear one and usually better than the linear one .",
    "we also note that the unweighted ( constant ) distance function is outperforming the others when it comes to estimating the emission rate in the 2d case where it is a priori assumed that the source is located on the ground . increasing the penalty coefficient @xmath264penalising high emission rates , from @xmath265 to @xmath266 decreases the average errors",
    ". it would be interesting to study how @xmath243 should be chosen optimally .",
    "stohl a , seibert p , wotawa g , arnold d , burkhart j f , eckhardt s , tapia c , vargas a and yasunari t j 2012 xenon-133 and caesium-137 releases into the atmosphere from the fukushima dai - ichi nuclear power plant : determination of the source term , atmospheric dispersion , and deposition _ atmos .",
    "* 12 * 23132343    ringbom a , axelsson a , aldener m , auer m , bowyer t w , fritioff t , hoffman i , khrustalev k , nikkinen m , popov y , ungar k and wotawa g 2014 radioxenon detections in the vtbt international monitoring system likely related to the announced nuclear test in north korea on febuary 12 , 2013 _ journal of environmental radioactivity _ * 128 * 4763    n. theys , r. campion , l. clarisse , h. brenot , j. van gent , b. dils , s. corradini , l. merucci , p .- f .",
    "coheur , m. van roozendael , d. hurtmans , c. clerbaux , s. tait , and f. ferrucci 2013 volcanic so2 fluxes derived from satellite data : a survey using omi , gome-2 , iasi and modis _ atmos .",
    "_ , 13 , 59455968    a. stohl , a. j. prata , s. eckhardt , l. clarisse , a. durant , s. henne , n. i. kristiansen , a. minikin , u. schumann , p. seibert , k. stebel , h. e. thomas , t. thorsteinsson , k. trseth , and b. weinzierl 2011 determination of time- and height - resolved volcanic ash emissions and their use for quantitative ash dispersion modeling : the 2010 eyjafjallajkull eruption , _ atmos . chem . phys .",
    "_ , 11 , 43334351                      thomson l c , hirst b , gibson g , gillespie s , jonathan p , skeldon k d and padget m j 2007 an improved algorithm for locating a gas source using inverse methods _ atmospheric environment _ * 41 * 6 11281134                    robins , a. , m. carpentieri , p. hayden , j. batten , j. benson and a. nunn , 2016 : moditic wind tunnel experiments , conference proceedings of the 17th international conference on harmonisation within atmospheric dispersion modelling for regulatory purposes ( harmo17 ) .",
    "s. burkhart and j. burman , 2016 , moditic wind tunnel experiments neutral and heavy gas simulation using rans , conference proceedings of the 17th international conference on harmonisation within atmospheric dispersion modelling for regulatory purposes ( harmo17 )    n. brnnstrm , s. burkhart , j. burman , x. busch , j .-",
    "issartel , l.  .",
    "persson , 2016 , moditic wp7000 backtracking - linear inverse modelling of neutral gases in urban environments , foi report ( in preparation ) ."
  ],
  "abstract_text": [
    "<S> we consider a bilevel optimatisation method for inverse linear atmospheric dispersion problems where both linear and non - linear model parameters are to be determined . </S>",
    "<S> we propose that a smooth weighted mahalanobis distance function is used and derive sufficient conditions for when the follower problem has local strict convexity . </S>",
    "<S> a few toy - models are presented where local strict convexity and ill - posedness of the inverse problem are explored , indeed the smooth distance function is compared and contrasted to linear and piecewise linear ones . </S>",
    "<S> the bilevel optimisation method is then applied to sensor data collected in wind tunnel experiments of a neutral gas release in urban environments ( moditic ) . </S>"
  ]
}