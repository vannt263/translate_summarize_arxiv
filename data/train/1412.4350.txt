{
  "article_text": [
    "in this paper we present a general numerical approach to shape optimization with state constraints .",
    "our line of action is to first reformulate the optimization problem on a fixed reference domain , using conformal pull - back .",
    "this leads to a nonlinear elliptic optimal control problem with state constraints which can be discretized and solved by nonlinear programming ( nlp ) techniques .",
    "the existing strategies for shape optimization problems with state constraints include treating the constraint through a penalty term in the cost functional ( cf .",
    "this however does not assure that the constraint is fulfilled in a strict sense .",
    "optimal control problems with state constraints , i.e. without shape dependence , are actively studied in the literature . for the general theory and several applications",
    "we refer to @xcite .",
    "first order necessary and second order sufficient conditions are derived in @xcite .",
    "numerical approaches to a variety of problems can be found in @xcite .",
    "a common praxis , which assures that the state constraints are treated in a strict sense , is to discretize the control problem leading to a nonlinear programming problem which can be solved using nlp - techniques .",
    "there are basically two options for the discretization concept : one can either discretize both control and state variables and implement their relation explicitly through equality constraint . or one can treat the discretized control as the only optimization variable and compute the state as a function of the control .",
    "see @xcite for a comparison of these approaches . for our case",
    "we utilize the first setting , such that both control and state appear as variables of the nlp . especially for nonlinear problems",
    "the choice of the nlp - solver is of great importance .",
    "as suggested in @xcite we use the interior point method developed in @xcite .    for an overview of the general theory of shape optimization",
    "we refer to @xcite .",
    "see @xcite for existence and convergence results of general elliptic shape optimization problems .",
    "see @xcite for examples of structural optimization .",
    "however , most concepts from standard theory do not apply to problems with state constraints .",
    "at least not without relaxing the constraints , which we want to avoid . for our approach",
    "we exploit the riemann mapping theorem ( cf .",
    "@xcite ) which states that any two simply connected domains in @xmath0 can be mapped onto each other by conformal maps .",
    "conformal maps however are determined by a scalar function which we call the conformal parameter .",
    "we can utilize this by pulling - back the optimization system to a fixed reference domain , where the shape dependence is then hidden in the conformal parameter which influences the differential operator as a coefficient .",
    "thus , we can optimize on the reference domain and reconstruct the optimal domain later from the optimal conformal parameter .",
    "we introduce the approach with the help of a stokes flow with supremum norm cost functional .",
    "the task is to find a domain @xmath1 such that the wall shear stress on the boundary is supremum norm close to some given target wall shear stress .",
    "our application in view is the improvement of polymer distributors as they are used in fiber production .",
    "another application from hemodynamics can be found in @xcite and @xcite .",
    "we begin by introducing basic concepts about conformal maps in section [ sec : conformal maps ] .",
    "the flow problem under consideration is given in section [ sec : stokes flow ] and a shape optimization problem with supremum norm cost functional is formulated in section [ sec : linf : optimization problem ] . the existence of an optimal control is shown in section [ sec : ex optimal control ] .",
    "since the influence of the conformal parameter is global , section [ sec : inflow constraints ] deals with the question of how characteristic features of the geometry , like the shape of the inflow boundaries , can be preserved by applying constraints to the conformal parameter .",
    "then , section [ state : sec : discretization ] explains how the nlp is obtained through discretization by finite elements .",
    "numerical results are presented in section [ sec : numerical results ] after which we close with a conclusion .",
    "conformal maps are a special class of diffeomorphisms which are angle preserving .",
    "we use them to pull - back a shape - dependent problem to a fixed reference domain .",
    "the shape information is then hidden in a so called conformal parameter , which is a scalar function living on the reference domain .",
    "let @xmath2 be two - dimensional domains .",
    "then a @xmath3-diffeomorphism @xmath4 , @xmath5 is called conformal map , if it fulfills the cauchy - riemann equations @xmath6 on @xmath7 .",
    "therefore , it is possible to identify conformal maps with holomorphic complex functions .",
    "we define the conformal parameter @xmath8 such that @xmath9 in the following we write @xmath10 for a conformal map corresponding to the conformal parameter @xmath11 .",
    "conformal maps can also be defined in higher dimensions , however , already in three dimensions the set of reachable domains is negligible small . on the other hand in two dimensions",
    "the riemann mapping theorem states that all simply connected domains can be reached from a simply connected reference domain by conformal deformations :    let @xmath12 be two sufficiently regular simply connected domains .",
    "then , there exists a conformal map @xmath13 .",
    "the riemann mapping theorem signifies why it makes sense to use conformal shape deformations for two - dimensional shape problems .",
    "it shows that the conformal approach does not restrict the set of reachable shapes .",
    "the advantage of using this approach is that it enables us to reformulate problems on the reference domain with coefficients depending on the conformal parameter . to do this we proof the following result which shows for what conformal parameters a corresponding conformal map exists .",
    "the proof uses arguments for holomorphic functions ( cf .",
    "@xcite ) , therefore , we identify the conformal map with a complex function .",
    "[ lemma : existence conformal map ] let @xmath14 be simply connected and assume that @xmath15 , @xmath16 is harmonic , i.e. @xmath17 . then , there exists a conformal map @xmath10 with conformal parameter @xmath11 .",
    "furthermore , @xmath18 is unique up to global translation and rotation of @xmath19 .",
    "we identify @xmath0 with the complex plane @xmath20 . because @xmath11 is harmonic we know from @xcite that there exists a holomorphic function @xmath21 such that @xmath22 .",
    "we write @xmath23 for some imaginary part @xmath24 . we know that @xmath24 is uniquely determined up to a constant which we can fix by @xmath25 for a certain point @xmath26 . then , @xmath27 is also holomorphic and thus there exists a unique holomorphic function @xmath28 such that @xmath29 for some @xmath30 .",
    "the value @xmath31 can be obtainted by integration over an arbitrary path from @xmath32 to @xmath33 . and",
    "since @xmath7 is simply connected it is independent to the choice of the path ( cf .",
    "@xcite ) . on the one hand @xmath34 and on the other hand when identifying @xmath18 with the corresponding diffeomorphism we get @xmath35 which yields @xmath36 .",
    "defining @xmath37 , we have constructed a conformal diffeomorphism @xmath10 for the conformal parameter @xmath11 .    by construction",
    "the conformal map is unique up to the choice of constants @xmath30 and @xmath38 .",
    "then , @xmath39 can be used for global translations and @xmath40 induces a rotation of @xmath19 around the point @xmath39 .",
    "we have seen that the conformal map for a given conformal parameter is unique up to global translation and rotation of the conformal domain @xmath19 .",
    "this means that the shape is unique and just the embedding into the @xmath0 plane is undetermined .",
    "we take equivalence classes to get a unique relation between conformal parameter and corresponding conformal domain .",
    "the problem under consideration is well - defined with respect to these equivalence classes .",
    "note that it may happen that for certain conformal parameters the conformal map constructed in lemma [ lemma : existence conformal map ] produces a self - overlapping domain which can not be embedded into the two - dimensional plane . in this case",
    "@xmath18 would not be bijective .",
    "but we could restore the bijectivity by interpreting @xmath19 as a suitable defined manifold .",
    "let @xmath14 be a simply connected bounded reference domain of class @xmath41 .",
    "let the boundary @xmath42 decompose into the in- and outflow parts @xmath43 and the wall parts @xmath44 .",
    "we consider an optimization problem with supremum norm cost functional based on the stokes flow together with conformal shape variations .",
    "let the admissible set of conformal parameters @xmath45 be given .",
    "further constraints on @xmath46 are reasonable to preserve certain features of the geometry , like the shape of the inflow boundaries . in section [ sec : inflow constraints ] we discuss this subject further and introduce specific choices for @xmath46 , which we examine with the help of numerical examples in section [ sec : numerical results ] .    since @xmath47 embeds into @xmath48 , lemma [ lemma : existence conformal map ] yields the existence of the conformal map @xmath10 corresponding to @xmath49 .",
    "therefore , we can define the set of admissible shapes by @xmath50 furthermore , we define @xmath51 for @xmath52 .",
    "let @xmath53 be a given reference inflow condition with @xmath54 where @xmath55 denotes the tangential derivative at the boundary .",
    "this means , as we see in , that there is no flow through the wall boundaries . for every @xmath52",
    "we define @xmath56 where @xmath57 is a diffeomorphism to be defined later .",
    "let @xmath58 be the unique solution of @xmath59 where @xmath60 and @xmath61 are called stream function and vorticity . by defining the flow velocity @xmath62",
    "this biharmonic problem is equivalent to the incompressible stokes problem ( cf .",
    "the boundary conditions lead to the following velocity conditions : on the boundary @xmath63 which vanishes on @xmath64 due to and @xmath65 furthermore the wall shear stress which we denote by @xmath66 is equal to the vorticity evaluated on the wall boundaries @xmath67    the following lemma states the existence and regularity of the solution of and provides the equivalent pull - back formulation on the reference domain .    [ lemma : linf : regularity ] let @xmath68 and define @xmath69 and @xmath70 . then is equivalent to @xmath71 assume that @xmath72 or @xmath73 is sufficiently regular .",
    "then the solution is unique and @xmath74 and especially @xmath75 .",
    "let @xmath49 .",
    "the equivalence of and follows from @xcite .",
    "define the bilinear form @xmath76 we have @xmath77 , therefore , @xmath78 is positive and bounded away from zero and infinity . then , standard existence and regularity theory ( cf .",
    "@xcite ) yields the existence of a unique solution @xmath74 .",
    "finally , @xmath75 follows from the lemma of sobolev ( see @xcite ) .",
    "it remains to define the map @xmath57 which is used to push - forward the inflow condition .",
    "we consider two choices : the simplest way is to use the conformal map itself , i.e. @xmath79 unfortunately , this can alter the velocity inflow condition , i.e. @xmath80 would not hold . to see this",
    "remember that the velocity corresponding to the stream function @xmath60 is @xmath81 then , @xmath82 and for , @xmath83 in general .",
    "to fulfill @xmath80 we define @xmath84 such that @xmath85 of course such a map can only exist if the corresponding inflow parts have the same length , i.e. if for every @xmath52 @xmath86 where the set of connected components of the inflow boundary is defined by @xmath87 then we can use @xmath88 to push - forward the boundary condition .    if @xmath89 , then for every @xmath52 which fulfills , @xmath80 holds and therewith we get a realistic mapping of the inflow condition .",
    "we have @xmath90 by . then , by definition @xmath91 on @xmath43 and @xmath92 on @xmath44 which yields the result .",
    "using has the advantage that the inflow condition is mapped isometrically .",
    "however , this does increase the complexity of the optimization problem , because the isometry must be computed which adds additional nonlinearities , as we are going to see in section [ sec : inflow constraints ] .",
    "we can now formulate the shape optimization problem with supremum norm cost functional .",
    "let @xmath93 be a given target wall shear stress and let @xmath94 .",
    "we want to solve the problem @xmath95 thus the task is to minimize the supremum norm distance between wall shear stress @xmath96 and target wall shear stress .",
    "note that the high regularity of the control space @xmath97 and regularization term is necessary to assure that @xmath98 holds ( cf .",
    "lemma [ lemma : linf : regularity ] ) and thus that the optimal control problem is well - defined . on the other hand ,",
    "if we would use an @xmath99-cost functional instead of a @xmath100-functional , we would require less regularity .",
    "we eliminate the shape - dependence by applying the conformal pull - back operator @xmath101 to the whole system .",
    "using lemma [ lemma : linf : regularity ] yields a new optimization problem on the reference domain @xmath7 which is equivalent to . instead of @xmath52 the conformal parameter @xmath49 acts as the control .",
    "@xmath102      in order to eliminate the supremum norm from the cost functional , we use a standard technique ( e.g .. @xcite ) and replace it by a scalar variable @xmath103 together with additional inequality constraints which make sure that the distance between @xmath104 and @xmath105 does not grow bigger than @xmath106 .",
    "this yields    [ eq : state : optsystemconformal ] @xmath107    this is a nonlinear optimal control problem given on a fixed domain and we can use established methods to compute the solution .",
    "all geometric information is hidden in the conformal parameter @xmath49 and the optimal shape can be recovered later after the optimal @xmath11 has been computed ( see section [ state : sec : reconstruction ] ) .",
    "note that in the case the dirichlet condition simplifies to @xmath108 on @xmath42 .",
    "to analyze the minimization problem and to form a basis for its numerical treatment we show the existence of an optimal control .",
    "the proof is straightforward and the idea can be found in @xcite . for simplicity we only consider the conformal case , since the isometric case would involve some regularity issues at the intersection of the inflow and wall boundaries .",
    "we use @xmath109 as the control space .",
    "then lemma [ lemma : linf : regularity ] yields the existence of a unique state @xmath110 and lemma [ lemma : existence conformal map ] assures the existence of a corresponding conformal domain .",
    "later in section [ sec : inflow constraints ] , where we start to deal with the application , we redefine @xmath46 and add additional constraints in order to preserve certain features of the inflow boundaries . however , to keep the existence proof simple we use for now .",
    "let @xmath111 , let @xmath112 and let @xmath72 .",
    "then there exists an optimal control for the optimization problem .",
    "lemma [ lemma : linf : regularity ] yields the existence of a unique state @xmath113 for every control @xmath49 and the state solves @xmath114 for @xmath115 we define the cost functional @xmath116    clearly , @xmath46 is nonempty since @xmath117 . furthermore , @xmath118 for all @xmath119 and thus @xmath120 exists .",
    "we choose a minimizing sequence @xmath121 such that @xmath122 then , because of the regularization term and since @xmath112 , there exists a constant @xmath123 such that @xmath124 and @xcite yields the existence of a weakly convergent subsequence of @xmath125 which we again denote by @xmath125 , i.e. @xmath126 with @xmath127 .",
    "because of the continuity of the laplace operator @xmath46 is closed and since it is also convex @xmath46 is weakly closed ( cf .",
    "@xcite ) which yields @xmath128 . furthermore ,",
    "the lemma of sobolev ( cf .",
    "@xcite ) yields a compact embedding which implies the strong convergence ( cf .",
    "@xcite ) @xmath129    let @xmath130 be an extension with @xmath131 and @xmath132 and define @xmath133 .",
    "then the standard existence and regularity theory ( see @xcite ) applied to the equation @xmath134 yields the estimate @xmath135 here @xmath136 is a constant depending on the coefficient @xmath137 and this coefficient is bounded @xmath138 since @xmath124 .",
    "thus , @xmath139 is bounded with a constant @xmath140 independent of @xmath141 . by @xcite",
    "there exists a weakly convergent subsequence of @xmath142 @xmath143 with @xmath144 .",
    "the lemma of sobolev yields a compact embedding which implies the strong convergence @xmath145    since @xmath146 and @xmath125 solve we know that @xmath142 and @xmath125 solve the weak formulation @xmath147 then and are sufficient to pass to the limit and we conclude @xmath148 this shows that @xmath149 and @xmath150 solve the state equation , i.e. @xmath151 .    because of together with the continuity of the norm and since the @xmath47-norm is weakly lower semicontinuous ( see @xcite ) we conclude @xmath152 and thus @xmath153 .",
    "in this section we want to redefine the set of admissible conformal parameters in a way that it is suitable for the application .",
    "an important property of the conformal parameter is that its influence is global .",
    "so if we change it in a small region the corresponding conformal domain changes everywhere . or",
    "if we move the wall boundaries to change the wall shear stress , the inflow boundaries are moved as well . however , from the applications point of view one usually wants to keep the inflow boundaries fixed and only change the wall boundaries .",
    "therefore , let us deal with the question of how certain features of the inflow boundaries , like length or curvature , can be preserved by applying constraints to the conformal parameter .",
    "basically we do this by restricting the conformal parameter @xmath49 by either homogeneous dirichlet or neumann boundary conditions . however , note that only apply these boundary conditions on the inflow boundaries and not on the wall boundaries .    in the following",
    "we define three different choices for the conformal parameter set @xmath46 and discuss the effects : on the one hand we can use a dirichlet condition @xmath154 which assures that the boundary of the reference domain is mapped isometrically to the corresponding conformal boundary .",
    "especially , this makes sure that the total length of the inflow boundaries is preserved .",
    "unfortunately , this does not fix the curvature and thus a formerly straight inflow can bend . for this setup",
    "@xmath155 holds , so and are equivalent .",
    "the effects of are illustrated in figure [ fig : state : example 1 ] .",
    "on the other hand we can use a neumann condition @xmath156 which preserves the curvature .",
    "thus , bending of the inflow boundaries is not possible , but now its length can change .",
    "thus , condition does not hold and we can only use . see figure [ fig :",
    "state : example 2 ] for an example .",
    "naturally we would like to be able to preserve curvature and length at the same time .",
    "this is possible by combining the neumann constraint with an additional integral constraint @xmath157 the integral constraint makes sure that for every @xmath52 and @xmath158 the length of @xmath159 and @xmath160 is equal .",
    "this can be seen by @xmath161 in this case condition is fulfilled and we can either use or .",
    "examples which illustrate the effects of the choices for @xmath46 are compared in figures [ fig : state : example 1 ] , [ fig : state : example 2 ] and [ fig : state : example 3 ] .",
    "note that the conformal parameter @xmath49 acts as the control of the optimization problem .",
    "furthermore , since @xmath11 must fulfill the laplace equation together with either dirichlet or neumann boundary condition on the inflow @xmath43 , we can also interprete @xmath162 as the control .",
    "in order to solve problem we derive a full discretization using finite elements . therefore , let @xmath163 be a triangulation approximating the reference domain @xmath7 and let @xmath164 be the boundary of @xmath163 which decomposes into the inflow @xmath165 and wall parts @xmath166 .",
    "let @xmath167 be a finite element space on @xmath163 , let @xmath168 be a finite element space on the boundary and let there exist a linear trace operator @xmath169 .",
    "let @xmath170 and let @xmath171 .",
    "first we deal with , which leads to the simplification @xmath172 on @xmath42 .",
    "then , there exist linear operators @xmath173 and @xmath174 and an inhomogeneous right hand side @xmath175 such that @xmath176 approximates equation together with the boundary conditions and . here",
    "the operation @xmath177 is to be interpreted pointwise . for details on computing the approximation we refer to any text book about finite elements ( e.g. @xcite ) . in our case",
    "we use the finite element software freefem++ ( see @xcite ) to compute the discretization .",
    "on the other hand when using we have to show how the dirichlet condition @xmath178 can be transformed in such a way that it can be handled by the nlp - solver .",
    "let @xmath173 , @xmath174 and @xmath175 be chosen such that approximates equation together with the boundary conditions and , i.e. it does not account for the inflow dirichlet condition . to implement the inflow dirichlet condition ,",
    "let @xmath179 be an inflow part and let @xmath180 and @xmath181 be the first and the last point of @xmath182 , respectively .",
    "we introduce the additional length variable @xmath183 , which we define by @xmath184 let @xmath185 \\rightarrow \\gamma_h^k$ ] be the isometric parameterization of the curve @xmath182 , where @xmath186 is the length of that curve and @xmath187 and @xmath188 holds .",
    "because of the necessary length constraint @xmath189 holds and on @xmath182 equation is equivalent to @xmath190 then , the function @xmath191 can be precomputed and equation can be approximated by @xmath192 where @xmath193 and @xmath194 are linear operators .",
    "moving on to the next equation , there exists a linear operator @xmath195 such that @xmath196 approximates equation .",
    "the inequality constraints are interpreted pointwise by @xmath197    we have to assure that @xmath198 is a sufficient approximation of @xmath46 .",
    "when using there exists a linear operator @xmath199 discretizing @xmath17 together with @xmath200 on @xmath43 and we can define @xmath201 in the same way for there exists a linear operator @xmath199 approximating @xmath17 together with @xmath202 on @xmath43 and we define @xmath201 for let @xmath199 approximate @xmath17 together with @xmath202 on @xmath43 .",
    "furthermore , the additional length constraint must hold which we can approximate using a linear operator @xmath203 and an inhomogeneous right hand side @xmath204 .",
    "this yields @xmath205    while the the theoretical analysis has required a high regularity of the control space , we now relax this and only use a @xmath206-regularization instead of a @xmath47-regularization . as a compensation",
    "we apply additional box constraints on the control , i.e. @xmath207 with @xmath208 .",
    "moreover , @xmath209 should hold , because otherwise @xmath210 .",
    "the computed results show that this is sufficient for the numerics .    putting everything together ,",
    "we end with an nlp of the following form @xmath211 this problem has the form of an nlp which can be solved using existing methods . in the following we use the interior point solver loqo ( see @xcite ) .",
    "after an optimal solution of problem has been computed , it remains to reconstruct the optimal domain @xmath212 .",
    "therefore , let @xmath213 be the projection of the optimal conformal parameter into the space @xmath214 , i.e. the space of lagrangian finite elements of order one .",
    "let @xmath215 represent the conformal map which is to be computed .",
    "let @xmath216 be the set of edges of the triangulation of @xmath163 . for every edge @xmath217",
    "e$ ] the corresponding vertex coordinates are denoted by @xmath218 . by definition of the conformal parameter @xmath219",
    "is the scaling factor of every infinite length element .",
    "then , for every finite edge @xmath217 \\in e$ ] the following should hold @xmath220 where @xmath221 and @xmath222 are the values of @xmath223 in @xmath224 and @xmath225 , respectively . considering this @xmath226 can be computed by minimizing the functional @xmath227 \\in e }     \\left (      { \\left | \\theta(v_i)-\\theta(v_j ) \\right |}^2 - e^{(\\alpha_i + \\alpha_j ) } { \\left | v_i - v_j \\right |}^2     \\right)^2 .",
    "\\end{aligned}\\ ] ] computing the solution @xmath226 is easy and can be done using existing methods .",
    "the optimal domain is then given by @xmath228 .",
    "this gives rise to algorithm [ algo : linf state constraint ] for supremum norm shape optimization problems with state constraints .",
    "let the initial domain @xmath7 and target wall shear stress @xmath105 be given .",
    "solve using an nlp solver , which yields the optimal conformal parameter @xmath223 .",
    "use @xmath223 to reconstruct the optimal domain @xmath228 by solving .",
    "we want test the proposed method using two different geometric scenarios .",
    "the first is a simple rectangular geometry which we use to demonstrate the effect of the different choices of the conformal parameter set @xmath46 ( cf .",
    "section [ sec : inflow constraints ] ) .",
    "the second geometry is a distributor with a small inflow tube at the top and a broad outflow at the bottom , which is inspired by the industrial application of a polymer flow distributor . in the end",
    "we provide statistics for all examples on different mesh sizes .    note that both geometries are smooth except for a finite set of corner points .",
    "hence , we have dropped the assumption that @xmath7 is of class @xmath41 .",
    "the numerics do still work but we must consider the following fact : conformal maps are angle preserving , therefore , the angle of each corner is fixed and can not be altered .",
    "thus , the set of admissible shapes does only contain geometries whose corner points have the same angles than the reference geometry .",
    "let @xmath167 be the space of second order lagrangian elements on @xmath7 and let @xmath168 be the space of first order lagrangian elements on the boundary .",
    "we use freefem++ @xcite to generate the mesh as well as to assemble the problem and compute the finite element matrices necessary for the nlp .",
    "solving the nlp is the crucial step which can be effectively done using the interior point solver loqo @xcite and its interface to the algebraic modeling language ampl @xcite .",
    "+      +      +      +     in the first three test cases we compute solutions of problem on a simple rectangular domain given by @xmath229 let the left and right sides of @xmath7 be the inflow boundaries @xmath43 and let the top and bottom sides be the wall boundaries @xmath44 .",
    "let the inflow condition @xmath230 be defined by @xmath231 this condition is chosen in such a way that @xmath232 vanishes on the wall boundaries and that the total amount flowing in and out of the domain is normalized to one .",
    "integration over the boundary yields @xmath233    [ rm : corner points ] note that under sufficient regularity assumptions the value of @xmath234 in a corner point is already determined by the boundary condition @xmath235 .",
    "this is due to the fact that there are two independent boundary directions for that corner point and thus the value of @xmath236 is determined by the stream function boundary condition . due to this property",
    "it is reasonable to use target wall shear stresses @xmath105 which agree with the intrinsic condition in the corner points .    on account of this remark",
    "we define the following target wall shear stress @xmath237 for @xmath238 .",
    "see figures [ fig : state : example 1]-[fig : state : example 3 ] for an illustration .",
    "furthermore , we choose the regularization parameter @xmath239 and the control constraints @xmath240 and @xmath241 .",
    "the control constraints are chosen in such a way that they are active in all test cases .",
    "see table [ state : table : performanceinf ] for results with inactive control constraints which show that the target wall shear stress is actually reachable if the control is unconstrained .    using this setup",
    "we compute the optimal solutions for the following three test cases , where our goal is to compare the effects of the different choices of @xmath46 .",
    "* example 1 : using and / which are equivalent .",
    "* example 2 : using and .",
    "* example 3 : using and .",
    "the results are shown in figures [ fig : state : example 1 ] , [ fig : state : example 2 ] and [ fig : state : example 3 ] .",
    "we have used a mesh with @xmath242 vertices .",
    "the first plot compares the reference shape @xmath7 with the optimal shape @xmath212 .",
    "the second one is a plot over the arc length of the reference boundary , which shows the absolute values of the reference wall shear stress on @xmath7 , the target wall shear stress @xmath105 and the optimal wall shear stress on @xmath212 together with the error region , i.e. the region between @xmath243 and @xmath244 .",
    "the black markers help to draw a connection between geometry and arc length plot . in all three cases",
    "we have succeeded to drive the wall shear stress close to the target wall shear stress .    from figure",
    "[ fig : state : example 1 ] we can see that has preserved the length of both inflow boundaries , but their curvature has changed . on the other hand has kept the inflow straight but it was shortened , as we can see in figure [ fig : state : example 2 ] . only has preserved both characteristic properties , as shown by figure [ fig : state : example 3 ] .    these examples have illustrated how constraints on the conformal parameter can preserve characteristic properties of the inflow boundaries . with the application in view it makes sense to use and , because these preserve length and curvature of the inflow and leave the inflow condition unaltered .",
    "the only thing which can still change is the relative position of two inflow parts to each other as we can see from figure [ fig : state : example 3 ] .",
    "+      the previous examples have shown the general functionality of the approach .",
    "next we discuss a distributor geometry depicted in figure [ fig : state : example 4 ] .",
    "we have a small inflow tube at the top from where the geometry widens into a broad outflow at the bottom .",
    "let @xmath7 be the reference domain as shown in figure [ fig : state : example 4 ] .",
    "the inflow condition @xmath232 is defined in the following way .",
    "let @xmath245 \\rightarrow \\gamma_0^{i_t}$ ] and @xmath246 \\rightarrow \\gamma_0^{i_b}$ ] be isometric parameterizations of the top and bottom boundary , respectively .",
    "then , we define @xmath247 $ , i.e. on $ \\gamma_0^{i_t}$ }     \\\\",
    "u_0(s_b(t ) ) & = -\\frac{5632}{5 } ( ( t-0.5)^{10 } - 0.5^{10 } ) \\qquad & &      \\mbox{$t \\in [ 0 , 1]$ , i.e. on $ \\gamma_0^{i_b}$ }     \\\\",
    "u_0 & = 0 \\qquad & &      \\mbox{on $ \\gamma_0^w$ }     \\end{aligned }    \\end{aligned}\\ ] ] as in the previous example @xmath232 is scaled in such a way that the total amount flowing into the domain and the total amount flowing out is normalized to one .",
    "the boundary condition for the stream function @xmath235 can be obtained by integration of @xmath232 over the boundary .",
    "the next task is to define the target wall shear stress @xmath105 .",
    "therefore , let @xmath248 \\rightarrow \\gamma_0^{w_l}$ ] and @xmath249 \\rightarrow \\gamma_0^{w_r}$ ] be isometric parameterizations of the left and right wall boundary , respectively and let @xmath250 be the wall shear stress on the reference domain . due to remark [ rm : corner points ] we define @xmath105 such that it agrees with the reference wall shear stress @xmath251 in the corner points of the domain .",
    "we define @xmath252 $ }      \\\\",
    "\\sigma_d(s_r(l_r - t ) ) & = \\left ( 1- \\sqrt{\\frac{t}{l_r } } \\right ) \\sigma_0(s_r(l_r ) ) + \\sqrt{\\frac{t}{l_r } } \\sigma_0(s_r(0 ) ) \\quad & &      \\mbox{$t \\in [ 0 , l_r]$}.     \\end{aligned }    \\end{aligned}\\ ] ] to clarify this we refer to the plot of the target wall shear stress @xmath105 in figure [ fig : state : example 4 ] .",
    "in order to get realistic results , we want that both curvature and length of the lower inflow boundary are preserved and that the inflow condition is mapped isometrically , i.e. we use and . on the upper inflow boundary we use , but as we can see from the result bending is not a problem .",
    "furthermore , we use the regularization parameter @xmath253 and control constraints @xmath240 and @xmath241 .",
    "we have used a mesh with 967 vertices and results are shown in figure [ fig : state : example 4 ] .",
    "again we have succeeded to reach a wall shear stress close to the target stress and the characteristic properties of the geometry have been preserved .",
    ".performance overview for the previous examples on different mesh sizes with active control constraints @xmath240 and @xmath241 .",
    "the mesh cases which have been used for figures [ fig : state : example 1]-[fig : state : example 4 ] are marked in _",
    "_ italics .",
    "_ _ [ cols=\"<,>,>,>,>,>,>\",options=\"header \" , ]     note that we could have obtained the same results by disabling the control constraints , i.e. @xmath254 and @xmath255 , but as one may have expected the nlp solver shows a better performance if control constraints are available , even if they are not active .",
    "thus it is in general a good idea to apply control constraints , even when they are not necessary for the application .",
    "we have presented a general numerical approach to solve shape optimization problems with state constraints on two - dimensional geometries , by illustrating how the shape - dependent problem can be transformed into a nonlinear problem on a fixed reference domain using conformal pull - back .",
    "and we have demonstated that the structure of the nonlinear problem is such that it can be solved by modern nlp solvers like loqo .",
    "furthermore , we have suggested constraints on the conformal parameter that preserve the shape of the inflow boundaries and therewith the characteristics of the geometry .",
    "it is relatively easy to transfer the approach to a wide class of problems on two - dimensional domains with many different constraints .",
    "however , when moving on to higher dimensional geometries problems arise : it is still possible to use conformal maps , but there is no riemann mapping theorem and the class of reachable geometries would be negligibly small . of course one could use more general mappings , but this would increase the complexity of the problem , which would already be quite high in the three - dimensional setup .",
    "this work was supported by the german federal ministry of education and research ( bmbf ) grant no . 03ms606f .",
    "height 2pt depth -1.6pt width 23pt , _ optimization techniques for solving elliptic control problems with control and state constraints .",
    "part 2 : distributed control _ , computational optimization and applications , 18 ( 2001 ) , pp ."
  ],
  "abstract_text": [
    "<S> we present a general numerical approach to shape optimization with state constraints for 2-dimensional geometries , without relaxing the constraints . to do this we reformulate the problem on a fixed reference domain using conformal pull - back . </S>",
    "<S> the shape dependence is then hidden in a conformal parameter , which appears as a coefficient in the differential operators . </S>",
    "<S> the problem on the reference domain can be discretized , leading to an nlp which can be handled using existing solvers . </S>",
    "<S> furthermore , we deal with the question how constraints on the conformal parameter can be used to preserve characteristic features of the geometry . </S>",
    "<S> we introduce this approach with the help of a stokes flow , where the task is finding a shape such that the wall shear stress is supremum norm close to some given target .    </S>",
    "<S> shape optimization , optimal control , supremum norm , state constraints , conformal map    49q10 , 90c90 , 30c20 </S>"
  ]
}