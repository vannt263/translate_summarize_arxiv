{
  "article_text": [
    "increasing computational power and algorithmic advancements are making many computational materials problems more tractable .",
    "for example , density functional theory ( dft ) is used to assess the stability of potential metal alloys with high accuracy . however ,",
    "dft computational burdens prevent feasible exploration of all possible configurations of a system . in certain cases ,",
    "one can map first - principles results on to a faster hamiltonian , the cluster expansion ( ce ) @xcite . over the past 30 years",
    ", ce has been used in combination with first - principles calculations to predict the stability of metal alloys @xcite , to study the stability of oxides @xcite , and to model interaction and ordering phenomena at metal surfaces @xcite . numerical error and",
    "_ relaxation _ effects decrease the predictive power of ce models .",
    "the aim of this paper is to demonstrate the effects of both and to provide a heuristic for knowing when a reliable ce model can be expected for a particular material system .",
    "ce treats alloys as a purely configurational problem , i.e. , a problem of decorating a fixed lattice with the alloying elements @xcite .",
    "however , ce models are usually constructed with data taken from `` relaxed '' first - principles calculations where the individual atoms assume positions that minimize the total energy , displaced from ideal lattice positions .",
    "unfortunately , cluster expansions of systems with larger lattice relaxation converge more slowly than cluster expansions for unrelaxed systems @xcite .",
    "in fact , ce with increased relaxation may fail to converge altogether . no rigorous description of conditions for when the ce breakdown occurs exists in the literature .",
    "a persistent question in the ce community regards the impact of relaxation on the accuracy of the cluster expansion .",
    "proponents of ce argue that the ce formalism holds even when the training structures are relaxed because there is a one - to - one correspondence in configurational space between relaxed and unrelaxed structures . in this paper",
    ", we demonstrate a relationship between relaxation and loss of sparsity in the ce model .",
    "as sparsity decreases , the accuracy of ce prediction decreases .",
    "in addition to the effects of relaxation , we also examine the impact of numerical error on the reliability of the ce fits .",
    "there are several sources of numerical error : approximations to the physics of the model , the number of @xmath0-points , the smearing method , basis set sizes and types , etc .",
    "most previous studies @xcite only examine the effect of gaussian errors on the ce model , but arnold et al .",
    "@xcite also investigated systematic error ( round - off and saturation error ) .",
    "they showed that , above a certain threshold , the ce model fails to recover the correct answer , that is , the ce model started to incorporate spurious terms ( i.e. , sparsity was reduced ) . a primary question that we seek to answer",
    "is how the shape of the error distribution impacts predictive performance of a ce model .    in this study",
    ", we quantify the effects of : 1 ) relaxation , by comparing ce fits for relaxed and unrelaxed data sets , and 2 ) numerical error , by adding different error distributions ( i.e. , gaussian , skewed , etc . )",
    "to ideal ce models .",
    "we study more than one hundred hamiltonians ranging from very simple pair potentials to first - principles dft hamiltonians .",
    "we present a heuristic for judging the quality of the ce fits .",
    "we find that a small mean - squared displacement is indicative of a good ce model . in agreement with past studies ,",
    "we show that the predictive power of ce is lowered when the level of error is increased .",
    "we find that there is no clear correlation between the shape of the error profile and the ce predictive power .",
    "it is possible to decide whether the computational cost of generating ce fitting data is worthwhile by examining the degree of relaxation in a smaller set of 50150 structures .",
    "relaxation is distinct from numerical error ",
    "it is not an error  but it has a similar negative effect . when relaxations are significant , it is less likely that a reliable ce model exists .",
    "relaxation is a systematic form of distortion , the local adjustment of atomic positions to accommodate atoms of different sizes .",
    "atoms `` relax '' away from ideal lattice sites to reduce the energy , with larger atoms taking up more room , smaller atoms giving up volume .",
    "the type of relaxations ( i.e. , the distortions that are possible ) for a particular unit cell are limited by the symmetry of the initially undistorted case , as shown in fig .",
    "[ fig : symmetry_allowed_relaxations ] . in the rectangular case ( left ) ,",
    "the unit cell aspect ratio may change without changing the initial rectangular symmetry . at the same time , the position of the blue atom is _ not allowed _ to change because doing so would destroy rectangular symmetry .",
    "in contrast , the two blue atoms in the similar structure shown in the right panel of the figure can move horizontally without reducing the symmetry .",
    "( color online ) symmetry- allowed distortions for two different unit cells .",
    "the atomic positions of the cell on the left do not have any symmmetry - allowed degrees of freedom , but the aspect ratio of the unit cell is allowed to change . for the unit cell on the right , the horizontal positions of the atoms in the middle layer may change without destroying the symmetry .",
    "( the unit cell aspect ratio may also change.),scaledwidth=55.0% ]    conceptually , the cluster expansion is a technique that describes the local environment around an atom and then sums up all the `` atomic energies '' ( environments in a unit cell ) to determine a total energy for the unit cell . for the cluster expansion model to be sparse  to be a predictive model with few parameters  it relies on the premise that any specific local neighborhood contributes the same atomic energy to the total energy regardless of the crystal in which it is embedded . for example , the top row of fig .",
    "[ fig : relaxex ] shows the same local environment ( denoted by the hexagon around the central blue atom ) embedded in two distinct crystals .",
    "if the contribution of this local environment to the total energy is the same in both cases , then the cluster expansion of the energy will be sparse .",
    "the effect of relaxation on the sparsity becomes clear in the bottom row of fig .",
    "[ fig : relaxex ] . in the left - hand case [ panel ( a )",
    "] , the crystal relaxes dramatically and the central blue atom is now _ four - fold coordinated _ entirely by red atoms .",
    "by contrast , in the right - hand case [ panel ( b ) ] , a collapse of the layers is not possible and the blue atoms are allowed by symmetry to move closer to each other . from the point of view of the cluster expansion ,",
    "the local environments of the central blue atom are the same for both cases .",
    "this fact , that two different relaxed local environments have identical descriptions in the cluster expansion basis , leads to a slow convergence of cluster expansion models .",
    "the problem is severe when the atomic mismatch is large and relaxations are significant ( i.e. , when atoms move far from the ideal lattice positions . )     ( color online ) relaxation scheme .",
    "the top images show the original unrelaxed configurations , while the bottom figures show the relaxed configuration .",
    "the left images ( a ) shows the relaxation where the hexagon is contracted as shown by the black arrows in bottom left figure .",
    "the relaxation in the right images ( b ) is restricted to displacement of the blue atoms as shown by the black arrows in bottom right figure .",
    ", scaledwidth=55.0% ]      we investigated the predictive power of cluster expansions using data from more than one hundred hamiltonians generated from density functional theory ( dft ) , the embedded atom method , lennard - jones potential and stillinger - weber potential . to investigate the effects of relaxation",
    ", we examined different metrics to measure the degree of atomic relaxation in a crystal configuration .",
    "first - principles dft calculations have been used to simulate metal alloys and for building cluster expansion models @xcite . however , dft calculations are too expensive to extensively examine the relaxation in many different systems ( lattice mismatch ) .",
    "thus , we examine other methods such as the embedded atom method ( eam ) which is a multibody potential .",
    "the eam potential is a semi - empirical potential derived from first - principles calculations .",
    "eam potentials of metal alloys such as ni - cu , ni - al , and cu - al have been parameterized from dft calculations and validated to reproduce their experimental properties such as bulk modulus , elastic constants , lattice constants , etc . @xcite .",
    "eam potentials are computationally cheaper , allowing us to explore the effects of relaxation for large training sets ; however , we are limited by the number of eam potentials available .    therefore , we also selected two classical potentials , lennard - jones ( lj ) and stillinger - weber ( sw ) , to adequately examine various degrees of relaxation , which can be varied using free parameters in each model .",
    "the lennard - jones potential is a pairwise potential . using the lj potential , we can model a binary ( @xmath1 ) alloy with different lattice mismatch and interaction strength between the a and b atoms by adjusting the @xmath2 parameter in the model .",
    "additionally , we also examined the stillinger - weber potential which has a pair term and an angular ( three - body ) term . in attempting to determine the conditions under which the ce formalism breaks down , we implemented a set of parameters in the sw potential where",
    "the angular dependent term could be turned on / off using the @xmath3 coefficient @xcite .",
    "for example , depending on the strength of @xmath3 , the local atomic environment in 2d could switch between 3- , 4- and 6-fold coordination by changing a single parameter .",
    "thus , when the system relaxes to a different coordination , the ce fits would no longer be valid or at least not sparse .",
    "all first - principles calculations were performed using the vienna ab initio simulation package ( vasp ) @xcite .",
    "we used the projector - augmented - wave ( paw ) @xcite potential and the exchange - correlation functional proposed by perdew , burke , and ernzerhof ( pbe ) @xcite . in all calculations",
    ", we used the default settings implied by the high - precision option of the code .",
    "equivalent @xmath0-point meshes were used for brillioun zone integration to reduce numerical errors @xcite .",
    "we used 1728 ( @xmath4 ) @xmath0-points for the pure element structures and an equivalent mesh for the binary alloy configurations .",
    "each structure was allowed to fully relax ( atomic , cell shape and cell volume ) .",
    "relaxation was carried out using molecular dynamics simulations for eam , lj and sw potentials .",
    "two molecular dynamics packages were used to study the relaxation : gulp @xcite and lammps @xcite .",
    "details for the lj , sw and eam potentials and the dft calculations can be found in the supplementary materials .",
    "the universal cluster expansion ( uncle ) software @xcite was used to generate 1000 derivative superstructures each of face - centered cubic ( fcc ) , body - centered cubic ( bcc ) and hexagonal closed - packed ( hcp ) lattice . for the dft calculations",
    ", we used only 500 structures instead of 1000 due to the computational cost .",
    "we generated a set of 1100 clusters , ranging from 2-body up to 6-body interactions .",
    "100 independent ce fits were performed for each system ( hamiltonian and lattice ) .",
    "we performed cluster expansions using the uncle software @xcite .",
    "we briefly discuss some important details about cluster expansion here , but for a more complete description , see the supplementary materials and past works @xcite .",
    "cluster expansion is a generalized ising model with many - body interactions .",
    "the cluster expansion formalism allows one to map a physical property , such as e , to configuration ( @xmath5 ) : @xmath6 where e is energy , @xmath7 is the correlation matrix ( basis ) , and @xmath8 is coefficient or effective cluster interaction ( eci ) .    when constructing a ce model , we are solving for the effective cluster interactions , or @xmath8s .",
    "we used the compressive sensing ( cs ) framework to solve for these coefficients @xcite . the key assumption in compressive",
    "sensing is that the solution vector has few nonzero components , i.e. , the solution is sparse @xcite .",
    "the cs framework guarantees that the sparse solution can be recovered from a limited number of dft energies . using the @xmath8s",
    ", we can build a ce model to interpolate the configuration space .",
    "each ce fit used a random selection of 25% of the data for training and 75% for validation .",
    "results were averaged over the 100 ce fits with error bars computed from the standard deviation .",
    "we defined the percent error as a ratio of the prediction root mean squared error ( rms ) over the standard deviation of the input energies , @xmath9 this definition of percent error allowed us to consistently compare different systems .      currently , there is no standard measure to indicate the degree of relaxation .",
    "we evaluated different metrics as a measure of the relaxation : normalized mean- squared displacement , ackland s order parameter @xcite , difference in steinhardt order parameter ( @xmath10 ) @xcite , soap @xcite , and the centro - symmetry parameter @xcite .",
    "we compared the metrics across various hamiltonians to find a criterion that is independent of the potentials and systems .",
    "we found that none of these metrics are descriptive / general enough except for the normalized mean- squared displacement .      to measure the relaxation of each structure / configuration",
    ", we used the mean- squared displacement ( msd ) to measure the displacement of an atom from its reference position , i.e. , the unrelaxed atomic position .",
    "the msd metric is implemented in the lammps software @xcite , which also incorporates the periodic boundary conditions to properly account for displacement across a boundary .",
    "the msd is the total squared displacement averaged over all atoms in the crystal :    @xmath11 - x[0])^2\\ ] ]    where @xmath12 is the final relaxed configuration and 0 is the initial unrelaxed configuration .",
    "additionally , we defined a normalized mean - square displacement ( nmsd ) percent : @xmath13 which is the ratio of msd to volume of the system .",
    "this allows for a relaxation comparison parameter that is independent of the overall scale .      to explore the effects of relaxation on ce predictability ,",
    "we examine relaxation in various systems from very high accuracy ( dft ) to very simple , tunable systems ( lj and sw potentials ) .",
    "we examine more than one hundred different hamiltonians and we find several common trends among the different systems .    in most cases , we find that the relaxed ce fits are worse ( higher prediction error and higher number of coefficients ) than the unrelaxed .",
    "for example , fig .",
    "[ fig : unrel - rel - vasp - eam ] shows the cluster expansion fitting for unrelaxed and relaxed data sets of ni - cu alloy system using dft and eam with two different primitive lattices .",
    "though it seems strange for us to model ni- cu using a bcc primitive lattice when ni - cu is closed - packed , this is a method for us to evaluate the relaxation of ni - cu for a highly relaxed system . as fig .",
    "[ fig : unrel - rel - vasp - eam ] shows , ni - cu alloy fitting for a fcc lattice is below 10% error , while bcc fitting result in more @xmath8s and higher percent error ( above 10% ) .",
    "we find similar results in the relaxation of ni - cu alloy using first - principles dft and eam potential .",
    "the difference between relaxed and unrelaxed ce fits are negligible when relaxations are small .",
    "this is shown in fig .",
    "[ fig : unrel - rel - vasp - eam ] for the relaxation of fcc superstructures using a ni - cu eam potential .",
    "( color online ) cluster expansion fits for ni - cu alloy using dft or eam potential .",
    "each bar represents the average percent error and error bar ( standard deviations ) for 100 independent ce fits .",
    "the blue bars represent the unrelaxed ce fits , while the red bars represent the relaxed ce fits .",
    "the colored number represents the average number of coefficients used in the ce models .",
    "when the configurations are relaxed , we find that the ce fits are often worse ( higher prediction error and higher number of @xmath8s ) than unrelaxed system .",
    "however , we show that in one case ( ni - cu eam ) the unrelaxed and relaxed ce fits are identical ( same error and same number of coefficients ) and this is due to a small relaxation.,scaledwidth=50.0% ]    0.55     [ fig : vasp - fcc - prob ]    0.55        0.180        0.178     0.55     [ fig : vasp - bcc - prob ]    0.55        0.178        0.192     fig . [",
    "fig : unrel - rel - vasp - eam ] shows that increased relaxation is associated with reduced sparsity ( increased cardinality of @xmath8s ) .",
    "one possible implication is that number of coefficients ( @xmath8 ) could be used to evaluate the predictive performance of the ce fits . the number of coefficients used in the fits ( such as in fig .",
    "[ fig : unrel - rel - vasp - eam ] ) is a simple way to determine whether or not a ce fit can be trusted .",
    "[ fig : vasp - fcc - ce ] and [ fig : vasp - bcc - ce ] show similar clusters across the 100 independent ce fittings ; thus , vertical lines indicate the presence of the same cluster across all ce fits . when the fit is good , only a small subset of clusters is needed ( fig .",
    "[ fig : vasp - fcc - ce ] ) . on the other hand ,",
    "[ fig : vasp - bcc - ce ] shows some common clusters in all of the ce fits with several additional clusters .",
    "[ fig : rms - js ] shows the correlation of the percent error with the number of terms in the expansion .",
    "we find that as the number of coefficients increases the percent error increases .",
    "however , this is not a sufficient metric as shown in fig . [",
    "fig : rms - js ] where the number of coefficient varies a lot .",
    "nonetheless , the number of coefficients may be used as a general , quick test .",
    "0.5   displays the ce fitting error vs the number of coefficients , while plot [ fig : msd - js ] highlights the relationship between number of coefficients and relaxation .",
    "the dashed line approximates what we consider as the maximum acceptable error for a ce model ( 10% ) . the dashed line in fig .",
    "[ fig : msd - js ] marks the estimated threshold for acceptable relaxation level .",
    "each symbol represents 100 independent ce fittings for each hamiltonian .",
    "higher error correlates with a higher number of coefficients.,title=\"fig : \" ]       0.5   displays the ce fitting error vs the number of coefficients , while plot [ fig : msd - js ] highlights the relationship between number of coefficients and relaxation .",
    "the dashed line approximates what we consider as the maximum acceptable error for a ce model ( 10% ) . the dashed line in fig .",
    "[ fig : msd - js ] marks the estimated threshold for acceptable relaxation level .",
    "each symbol represents 100 independent ce fittings for each hamiltonian .",
    "higher error correlates with a higher number of coefficients.,title=\"fig : \" ]    the degree of relaxation is crucial to define whether or not the ce model is accurate or not . however , there is no standard for _ when _ cluster expansion fails due to relaxation . thus far",
    ", we have made some remarks about relaxation and ce fits .",
    "but the question of how much relaxation is allowed has not been addressed . by examining a few metrics : nmsd , soap @xcite , d6 @xcite , ackland @xcite and centro - symmetry @xcite",
    ", we find that there is a relationship between degree of relaxation and the quality of ce fits .",
    "as shown in the supplementary information , we have used these metrics to investigate over 100 + systems ( different potentials , lattice mismatches , and interaction strengths ) . here , we present a heuristic to measure the degree of relaxation based on the nmsd",
    ".    in general , cluster expansion will fail when the relaxation is large .",
    "figure [ fig : msd - js ] shows that a small nmsd weakly correlates with a small number of coefficients .",
    "however , figure [ fig : rms - msd ] highlights the correlation between degree of relaxation and prediction error .",
    "there is a roughly linear relationship between the degree of relaxation and the ce prediction .",
    "we partition the quality of the ce models into three regions : good ( nmsd @xmath14 0.1% ) , maybe ( 0.1% @xmath15 nmsd @xmath15 1% ) and bad ( nmsd @xmath16 1% ) .",
    "the `` maybe '' region is the gray area where the ce fit can be good or bad .",
    "this metric provide a heuristic to evaluate the reliability of the ce models , i.e. , any systems that exhibit high relaxation will fail to provide an accurate ce model .",
    "as we have shown in the previous section , greater relaxation results in worse ce fitting .",
    "in addition to the effects of relaxation , we now investigate the effects of numerical error on reliability of ce models .",
    "numerical error arises from various sources such as the number of @xmath0-points , the smearing method , minimum force tolerance , basis set sizes and types , etc .",
    "these errors are not stochastic error or measurement errors ; they arise from tuning the numerical methods .",
    "we assume that the relaxation - induced change in energy for each structure is an _ error term _ that the ce fitting algorithm must handle .",
    "the collection of these `` errors '' from all structures in the alloy system then form an error profile ( or distribution ) . using the simulated relaxation error profiles from the previous section together with common analytic distributions , we built `` toy '' ce models with known coefficients .",
    "we then examined whether or not the shape of the error distribution affects the ce predictive ability .",
    "the numerical errors in dft calculations are largely understood , but it is difficult to disentangle the effects of different , individual error sources . instead of studying the effects of errors separately , we added different distributions of error to a `` toy '' model in order to imitate the aggregate effects of the numerical error on ce models .",
    "hence , we opt to simplify the problem by creating a `` toy '' problem for which the exact answer is known . to restrict the number of independent variables",
    ", we formulated a `` toy '' cluster expansion model by selecting five non - zero values for a subset of the total clusters . using this toy ce ,",
    "we predicted a set of energies @xmath17 for 2000 known derivative superstructures of an fcc lattice , these @xmath17 values are used as the true energies for all subsequent analysis .",
    "we added error to @xmath17 , chosen from either : 1 ) `` simulated '' distributions obtained by computing the difference between relaxed and unrelaxed energies predicted by either dft , eam , lj or sw models ( fig .",
    "[ fig : experimentaldistrbutions ] ) ; or 2 ) common analytic distributions ( fig .",
    "[ fig : analyticequalwidthdistributions ] ) .    to generate the simulated distributions , we chose a set of identical structures and fitted them using a variety of classical and semi - classical potentials , and quantum mechanical calculations using vasp .",
    "for each of the potentials we selected , we calculated an unrelaxed total energy @xmath17 for each structure and then performed relaxation to determine the lowest energy state , @xmath18 .",
    "the difference between these two energies ( @xmath19 ) was considered to be the `` relaxation '' error .",
    "( color online ) distributions from real relaxations using classical and semi - classical potentials , as well as dft calculations .",
    "the distributions are all normalized to fall within 0 and 1 .",
    "the widths , @xmath20 , were calculated by taking the difference between the 25@xmath21 and 75@xmath21 percentiles.,scaledwidth=50.0% ]     ( color online ) the analytic , equal width distributions used for adding error to the toy model ce fit.,scaledwidth=50.0% ]    certain assumptions are usually made about the error in the signal , namely that it is gaussian .",
    "the original cs paradigm proves that the @xmath22 error for signal recovery obeys @xcite : @xmath23    where @xmath24 bounds the amount of error in the data , @xmath25 is the cs solution , @xmath26 is the true solution , and @xmath27 is the vector @xmath26 with all but the largest @xmath28 components set to zero .",
    "this shows that , _ at worst , the error in the recovery is bounded by a term proportional to the error_. for our plots of this error , we first normalized @xmath29 so that @xmath30 $ ] using @xmath31    not surprisingly , the various potentials produced different error profiles .    the expectation value of the distributions was set to be a percentage of the average , unrelaxed energy across all structures",
    ". thus , `` 15% error '' means that each unrelaxed energy was changed by adding a randomly drawn value from a distribution with an expectation value of 15% of the mean energy .",
    "we performed ce fits as a function of the % -error added ( 2,5,10 and 15% ) for each distribution .",
    "although we only present the 15% error results in the next section , all results at different error levels can be found in the supporting information . for each data point",
    ", we performed 100 independent ce fits and used the mean and standard deviation to produce the values and error bars for the plots .",
    "as shown in fig .",
    "[ fig : equalwidthsummary ] , the error is weakly uniform across all ( analytic and simulated ) distributions , implying that there is no correlation between specific distribution and error .",
    "none of the normal quantifying descriptions of distribution shape ( e.g. width , skewness , kurtosis , standard deviation , etc . ) show a correlation with the ce prediction error .",
    "the error increased proportionally with the level of error in each system ( 2 , 5 , 10 and 15% error ) .",
    "we therefore turn to the compressive sensing ( cs ) formalism for insight .",
    "( color online ) comparison of the predictive error in ce fits as the shape of relaxation error changes .",
    "( a ) refers to the analytic distribution while ( s ) refers to simulated distribution .",
    "the fits are ordered from lowest to highest distribution width .",
    "fits were averaged over 100 randomly selected subsets with 500/2000 data points used for training ; the remaining 1500 were used to verify the model s predictions .",
    "the black and red colored symbols represent 2% and 15% error levels , respectively .",
    "the circles and triangles represent the analytical and simulated distributions , respectively .",
    "higher error produces higher prediction errors .",
    ", scaledwidth=50.0% ]    the theorems of tao and cands @xcite guarantee that the solution for an underdetermined cs problem can be recovered _ exactly _ with overwhelming probability provided :    * the solution is sparse within the chosen representation basis .",
    "* sufficient data points , sampled independent and identically distributed ( i.i.d ) .",
    "* the sensing and representation bases are maximally incoherent .",
    "if all of these conditions are met , we know that cs will provide a solution that is very close to the true answer .",
    "conversely , if cs can not converge to a good solution , it means that one of these conditions has been violated .",
    "we have control over the number of training points , and the incoherence of the sensing- representation bases .",
    "however , we _ can not _ control whether the true physical solution is sparsely represented for relaxed systems .",
    "this suggests a useful connection between the cs framework and the robustness of ce : if cs can not reproduce a good ce fit ( quantified below ) , then sparsity has been lost .    in the cs framework",
    ", the foundational assumption is that of sparsity , meaning that the compressed signal ( or cluster expansion ) requires only a few terms to accurately represent the true signal ( physics ) .",
    "thus , the number of terms recovered by cs to produce the ce is a good measure of the quality of the cs fit .",
    "this begs the question : can we use the number of terms within the cs framework to heuristically predict _ in advance _ whether the ce fit will converge well ?    in answering the question of predictability for a good ce fit , we define three new quantities :    1 .   [",
    "item : xidefinition ]",
    "@xmath32 : total number of unique clusters used over 100 ce fits of the same dataset .",
    "we also call this the model complexity .",
    "[ item : notindefinition ] @xmath33 : number of `` exceptional '' clusters .",
    "these are clusters that show up fewer than 25 times across 100 fits , implying that they are not responsible for representing any real physics in the signal , but are rather included because the ce basis is no longer a sparse representation for the relaxed alloy system .",
    "they are sensitive to the training / fitting structures .",
    "3 .   [ item : lambdadefinition ] @xmath34 : number of _ significant _ clusters in the fit ; essentially just the total number of unique clusters minus the number of `` exceptional '' clusters , @xmath35 .    in the relaxation section",
    ", we showed that the average number of coefficient is not sufficient to determine the quality of the ce model . here , we decompose the number of @xmath8s into three new quantities to provide additional insights into the reliability of the ce fits . in fig .",
    "[ fig : errorvsmodelcomplexity ] , we plot the ce error , ordered by model complexity and show that it reproduces the trend identified by the number of coefficients ( indeed they are intimately related , @xmath32 being the statistically averaged number of coefficients across many fits ) .",
    "an ordering by the number of exceptional clusters @xmath33 produces an identical trend , showing that it may also serve to quantify a good fit .",
    "( color online ) prediction error over 65% of the structures for the `` toy '' cluster expansion ( at 15% error added ) .",
    "the systems are ordered by @xmath32 , which is the total number of unique clusters used by any of the 100 ce fits for the system .",
    "this ordering shows a definite trend with increasing @xmath32.,scaledwidth=50.0% ]    as indicated earlier , all these experiments were performed for a _ known _ ce model that had 5 non - zero terms .",
    "additional insight is gained by plotting the errors , ordered by @xmath34 , the number of significant clusters ( fig .",
    "[ fig : errorvssignificantterms ] ) .",
    "[ fig : errorvssignificantterms ] shows that in almost all cases , once we remove the exceptional clusters @xmath36 , the remaining model is almost _ exactly _ the known ce model that we started with .",
    "the cs framework provides a rigorous mathematical framework for this statement because it guarantees to _ exactly _ recover the original function with high probability as long as we have enough measurements and our representation basis is truly sparse .",
    "once the cluster expansion stops converging , we lose sparsity and cs fails .",
    "this gives us confidence to use the cs framework as a predictive tool for ce robustness .",
    "( color online ) prediction error over 65% of the structures for the `` toy '' ce model ( at 15% error added ) .",
    "the errors are ordered by @xmath34 , the number of significant terms in the expansion . as expected , the values are close to the known model complexity ( 5 terms ) and the ordering once more appears random.,scaledwidth=50.0% ]    provided the training structures are independent and identically distributed , we do not necessarily need hundreds of costly dft calculations to tell us that the ce will not converge . using our toy ce model , we discovered that for all error distributions , a training set size of 50 data points was sufficient to recover the actual model complexity ( 5 terms ) .",
    "for actual dft calculations , where relaxation was known to disrupt ce convergence , we saw a similar trend with about 100 data points needed to identify whether the ce would converge with more data or not .",
    "we conclude that ce robustness for relaxed systems can be predicted with a _ much _ smaller number of data points than is typically needed for a good ce fit ( on the order of 5 - 10% from our experience ) .",
    "the proposed heuristic to verify convergence of the relaxed ce , when trained with a limited dataset , is to examine the values of @xmath34 and @xmath32 over a large number of independent fits . if the number of the exceptional clusters @xmath33 is significant compared to @xmath34 , then it is likely that the ce will _ not _ converge on a larger dataset as shown in fig .",
    "[ fig : errorvssingleshow ] .",
    "figure [ fig : norm - training ] highlights the ce fitting as function of training set size .",
    "we observe small relaxation ( black curve ) correlates with a small number of coefficients ; thus the ce can fit using a small number of @xmath8s even with 5% ( 25 ) to 10% ( 50 ) of the structures . on the other hand , red and blue curves which have high relaxation ,",
    "do not converge . by using a small relaxed dataset ( 50 to 100 structures ) , we can predict whether or not the computational cost of relaxing _ many _ structures is fruitful .",
    "( color online ) plot of predictive error over 65% of the structures for the `` toy '' problem ( at 15% error added ) .",
    "the systems are ordered by @xmath33 the number of clusters that were used less than 25 times across all 100 ce fits .",
    "these are considered exceptions to the overall fit for the system . as for figure",
    "[ fig : errorvsmodelcomplexity ] , there is a definite trend toward higher error for systems with more exceptional clusters.,scaledwidth=50.0% ]     ( color online ) for a reliable ce model , the number of coefficients converges as a function of the training set size .",
    "a total of 500 structure were available for training .",
    "the number of coefficients in a fit and its error bars give us an indication of the predictive power of ce with only a small training set .",
    "the black curve represents a good ce fit ; only 25 to 50 ( or 5 to 10% ) of training structures were needed . on the other hand ,",
    "the red and blue curves show that ce fails to fit the data due to a slowly converging expansion .",
    "the error bars on the blue points indicate extremely bad fitting.,scaledwidth=50.0% ]",
    "relaxation and error decrease the reliability of the cluster expansion fit because the ce model is no longer sparse .",
    "nevertheless , until now , there has been no measure of relaxation that provides a heuristic as to when the ce fitting data is reliable . using four different hamiltonians ( first - principles , lennard - jones , stillinger - weber and embedded atom method ) ,",
    "we show that the normalized mean - squared displacement of alloy configuration is a good measure of relaxation and ce predictability .",
    "a small displacement percent , e.g. , less than 0.1% , will usually generate a reliable ce model .",
    "the number of cluster terms in the ce models is also a good indicator of how well cluster expansions can perform",
    ". as the number of clusters increases , the predictability of ce model decreases .",
    "ce tends to fail when the number of @xmath8s exceeds 80 .    in our error analysis",
    ", we investigated the ability of the compressive sensing framework to obtain fits to a toy , cluster expansion model as the energy of relaxation changes in a predictable way .",
    "we used 16 relaxation error distributions ( both analytic and simulated ) and compared the prediction errors of the resulting ce fits for the relaxed vs. unrelaxed case .",
    "no clear correlation appears between the statistical measures of distribution shape and the predictive errors . however , there are clear correlations between the predictive error , the complexity of the resulting ce model , and the number of significant terms in that model",
    ".    we can not use the relaxation distributions alone to determine the viability of a ce fit in advance .",
    "however , the analysis does reveal that the majority of the clusters used by the unrelaxed ce fit will also be present in the relaxed case ( albeit with adjusted @xmath8 values ) if the ce fit is viable .",
    "this suggests that it may be possible to decide whether the computational cost of full ce is worthwhile by making predictions for a few relaxed systems ( 50 - 100 ) and determining whether the error remains small enough .",
    "the authors thank volker blum , lance j. nelson and mark k. transtrum for useful discussions . this work was supported by funding from onr ( muri n00014 - 13 - 1 - 0635 ) .",
    "we thank the fulton supercomputing lab at brigham young university for allocation of computing time .",
    "10    j.  m. sanchez , f.  ducastelle , and d.  gratias . .",
    ", 128(1 - 2):334350 , 1984 .",
    "j.  m. sanchez . .",
    ", 48(18):1401314015 , nov 1993 .",
    "j.  m. sanchez . .",
    ", 81(22):224202 , jun 2010 .",
    "j.  w  d connolly and a.  r. williams . . ,",
    "27(8):51695172 , apr 1983 .",
    "l.  g. ferreira , a  a mbaye , and alex zunger . .",
    ", 35(12):64756478 , apr 1987 .",
    "l.  g. ferreira , a.  a. mbaye , and a.  zunger . .",
    ", 37(18):10547 , 1988 .",
    "l.  g. ferreira , s .- h .",
    "wei , and a.  zunger . .",
    ", 40(5):3197 , 1989 .",
    "z.  w. lu , s .- h .  h. wei , alex zunger , s.  frota - pessoa , and l.  g. ferreira . .",
    ", 44(2):512544 , 1991 .",
    "c  wolverton and a  zunger . .",
    ", 8(1 - 2):107121 , 1997 .    a.  van  de walle and g.  ceder .",
    ", 23(4):348359 , aug 2002 .",
    "sergey  v. barabash , volker blum , stefan mller , and alex zunger . . ,",
    "74(3):035108 , jul 2006 .",
    "m  asato , h  takahashi , t  inagaki , n  fujima , r  tamura , and t  hoshino . . ,",
    "48(7):17111716 , 2007 .",
    "lance  j. nelson , vidvuds ozoli , c.  shane reese , fei zhou , and gus l.  w. hart . .",
    ", 88(15):155105 , 2013 .    p.h .",
    "gargano , p.r .",
    "alonso , and g.h .",
    "rubiolo . .",
    ", 9:239245 , 2015 .",
    "manuel aldegunde , nicholas zabaras , and jesper kristensen . . ,",
    "( july ) , 2016 .",
    "ravi chinnappan , b.k .",
    "panigrahi , and axel van  de walle . .",
    ", 54:125133 , 2016 .",
    "g  ceder , a  van  der ven , c  marianetti , and d  morgan . .",
    ", 8:311321 , 2000 .",
    "atsuto seko , koretaka yuge , fumiyasu oba , akihide kuwabara , and isao tanaka . .",
    ", 73(18):15 , 2006 .",
    "atsuto seko , atsushi togo , fumiyasu oba , and isao tanaka . .",
    ", 100(4):25 , 2008 .",
    "isao tanaka , atsushi togo , atsuto seko , fumiyasu oba , yukinori koyama , and akihide kuwabara . .",
    ", 20(46):10335 , 2010 .",
    "isao tanaka , atsuto seko , atsushi togo , yukinori koyama , and fumiyasu oba .",
    ", 22(38):384207 , 2010 .",
    "stefan mller . .",
    ", 15(34):r1429r1500 , 2003 .",
    "ralf drautz , r  singer , and m  fhnle . .",
    ", 67(3):035418 , 2003 .",
    "s.  mller , m.  sthr , and o.  wieckhorst . .",
    ", 82(3 spec .",
    "iss.):415419 , 2006 .",
    "laura  m. herder , jason  m. bray , and william  f. schneider . .",
    ", 640:104111 , 2015 .",
    "ryohei tanaka , kazuhito takeuchi , and koretaka yuge . .",
    "56(7):10771080 , 2015 .    david  b. laks , l.  g. ferreira , sverre froyen , and alex zunger . .",
    ", 46(19):1258712605 , nov 1992 .",
    "bjoern arnold , alejandro  diaz ortiz , gus l  w hart , and helmut dosch . .",
    ", 81(9):111 , 2010 .",
    "alejandro daz - ortiz and helmut dosch . .",
    ", 76(1):012202 , jul 2007 .",
    "alejandro daz - ortiz , helmut dosch , and ralf drautz . .",
    ", 19:406206 , 2007 .",
    "s.  m. foiles , m.  i. basker , and m.  s. daw . .",
    ", 33(12 ) , 1986 .",
    "frank  h. stillinger and thomas  a. weber . .",
    ", 31(8):52625271 , 1985 .",
    "g.  kresse and j.  hafner . .",
    ", 47(1):558561 , 1993 .    g.  kresse and j.  hafner . .",
    ", 49(20):1425114269 , 1994 .",
    "g.  kresse and j.  furthmller . .",
    ", 6(1):1550 , 1996 .",
    "g.  kresse and j.  furthmller . .",
    ", 54(16):1116911186 , 1996 .    p.  e. blchl . .",
    ", 50(24):1795317979 , dec 1994 .",
    "john  p. perdew , kieron burke , matthias ernzerhof , department of  physics , and new orleans louisiana 70118  john quantum theory group tulane university . . ,",
    "77(18):38653868 , 1996 .",
    "sverre froyen . . , 39(5):31683172 ,",
    "feb 1989 .",
    "julian  d. gale . .",
    ", 93(4):629637 , 1997 .",
    "julian  d. gale and andrew  l. rohl . .",
    ", 29(5):291341 , may 2003 .",
    "s.  plimpton . .",
    ", 117(june 1994):119 , 1995 .    see supplemental materials for details about the different potentials and their parameters .",
    "gus l.  w. hart and rodney  w. forcade . .",
    ", 77(22):112 , 2008 .",
    "gus l  w hart and rodney  w. forcade . .",
    ", 80(1):18 , 2009 .",
    "d  lerch , o  wieckhorst , g  l  w hart , r  w forcade , and s  mller . .",
    ", 17(5):055003 , sep 2009 .    see supplemental materials for more details on cluster expansion .",
    "ferreira , s .- h .",
    "wei , and alex zunger . .",
    ", 5(1):3456 , mar 1991 .",
    "alex zunger , l  g wang , gus l  w hart , and mahdi sanati . . ,",
    "10(6):685706 , 2002 .",
    "axel van  de walle . . ,",
    "65(11):15231532 , nov 2013 .",
    "lance  j. nelson , gus l.  w. hart , fei zhou , and vidvuds ozoli . .",
    ", 87(3):035125 , 2013 .",
    "emmanuel  j. candes and terence tao .",
    ", 52(12):54065425 , dec 2006 .    e.j .",
    "candes and m.b .",
    ", 25(2):2130 , mar 2008 .",
    "g.  j. ackland and a.  p. jones . . , 73(5):054104 ,",
    "feb 2006 .",
    "paul  j. steinhardt , david  r. nelson , and marco ronchetti . .",
    ", 28(2):784805 , jul 1983 .",
    "albert  p. bartk , risi kondor , and gbor csnyi . .",
    ", 87(18):116 , 2013 .",
    "cynthia  l. kelchner , s.  j. plimpton , and j.  c. hamilton . . ,",
    "58(17):1108511088 , nov 1998 .",
    "see supplemental materials for details about the different relaxation metrics .    in our experience",
    ", a percent error above 10% often gives unreliable ce model .",
    "see supplemental materials for additional plots at different levels of error .",
    "the supplementary data has many plots from the hundreds of ce fits that we performed for this analysis .    for typical binary ces",
    "we typically need about 300 - 500 structures to get a good fit , which is then verified using an additional 200 + dft calculations .",
    "cluster expansion is a generalized ising model with many - body interactions .",
    "the ce model provides a fast , accurate way to compute physical properties which are function of the configuration .",
    "consider a binary alloy @xmath37 , the alloy is treated as a lattice problem .",
    "each site of a given lattice is assigned a occupation variable , @xmath38 ( i=1,2, ... ,n ) with @xmath38 = 1 or + 1 depending on the site @xmath39 being occupied by an a or a b atom . any atomic configuration on a given lattice",
    "can then be specified using a vector of the occupation variable , @xmath40 $ ] .",
    "a physical quantity such as energy can be expressed as a linear combination of basis function : @xmath41 where the argument to the function is a vector of occupation variable , @xmath42 .",
    "the @xmath43 are the basis function or often referred to as the cluster functions .",
    "each cluster function corresponds to a cluster of lattice sites .",
    "the coefficients @xmath44 are the effective cluster interactions or eci s .",
    "the main task of building a ce model is to find the @xmath8s and their values .",
    "we can solved for the @xmath8s using the structure inversion method @xcite .",
    "however , we use a new approach based on compressive sensing to solve for these coefficients @xcite .",
    "this is a more extensive version of the method present in the paper including the various parameters , forms of the potential and relaxation metrics .",
    "two molecular dynamics packages were used to study the relaxation : gulp and lammps .",
    "gulp ( general utility lattice program ) is written to perform a variety of tasks based on force field methods such molecular dynamics , monte carlo and etc @xcite .",
    "gulp is a general purpose code for the modeling of solids , clusters , embedded defects , surfaces , interfaces and polymers @xcite .",
    "lammps ( large - scale atomic molecular massively parallel simulator ) is a widely used molecular dynamics program @xcite .",
    "we used these two programs to minimize / relaxed each structure .",
    "we computed the energy of each structure ( unrelaxed and relaxed ) .",
    "relaxation of each structure was obtained by minimization of total energy using gulp or lammps via a conjugate gradient scheme .",
    "molecular dynamics simulations were carried for the embedded atom method ( eam ) , lennard - jones ( lj ) and stillinger - weber ( sw ) potentials .",
    "the eam potential is a semi - empirical potential derived from first - principles calculations .",
    "the embedded atom method ( eam ) potential has following form : @xmath45 eam potentials of metal alloys such ni - cu , ni - al , cu - al have been parameterized from first - principle calculations and validated to reproduce experimental properties , bulk modulus , elastic constants , lattice constants , etc @xcite .",
    "compared to first - principles calculations , eam potentials are computationally cheaper .",
    "thus , this allows us to explore the effect of relaxation for large training sets . nonetheless , we are limited by the number of eam potentials available .",
    "we used various eam potentials to study the relaxation ; these binary eam potentials are shown in table [ eam - parameter ] .    .eam",
    "potentials used to study the relaxation .",
    "lattice mismatch is shown in percentage .",
    "lattice mismatch = ( @xmath46)/ ( ( @xmath47)/2 ) @xmath48 , where @xmath49 is the lattice constant of the pure element . [ cols=\"^,^\",options=\"header \" , ]      in order to distinguish and measure the relaxation of the atoms from their ideal positions , we examined several metrics ( order parameters ) to quantify the relaxation : normalized mean - squared displacement or nmsd ( see the method in the main article ) , ackland s order parameter @xcite , @xmath10 , soap , and centro - symmetry .",
    "we found that some of these order parameters are not descriptive / general enough for all cases ( potentials and crystal lattices ) .",
    "we used the ackland s order parameter to identify the crystal structure after relaxation .",
    "ackland s op identify each atomic local environment and assign it as fcc , bcc , hcp and unknown @xcite .",
    "we used this op to determine which structures remain the same or on lattice and which structures undergo a structural change .",
    "we can use this order parameter to separate / sort those structure that remain the same to examine the robustness of ce due the relaxation of crystal structure . similar to the ackland s order parameter , the centro - symmetry identifies the crystal structure of each atom based on the local arrangement ( neighbors ) .    for example , figure [ fig : relaxed - sw - ack - fcc ] shows the mapping of msd and ackland order parameter for each structure at 5% ( top plot ) and 15% ( bottom plot ) .",
    "overall , we can see that the msd increases with higher lattice mismatch . the spread of the ackland s order parameter is also affected .",
    "going from 5% ( system a in table [ sw - parameter ] ) to 15% ( system c in table [ sw - parameter ] ) , the ce fitting error increases from 41.2% ( 110 clusters ) to 63.5% ( 156 clusters ) for the bcc .",
    "when the lattice mismatch increases , the mean - squared displacement also increases .",
    "ackland s order parameter and centro - symmetry are useful since they provide information about individual atoms . however , ackland s order parameter and centro - symmetry is too specific and it does not provide a useful measure of relaxation .",
    "in addition to using the crystallographic information as a measure of relaxation , we used a variant of the steinhardt s bond order parameter @xcite that we called the @xmath10 order parameter or the @xmath10 metric , which is a measure of the difference between the local atomic environment ( relaxed and unrelaxed ) .",
    "we computed the local atomic environment using the @xmath50 ( spherical harmonic with @xmath51 ) for the unrelaxed and relaxed configuration .",
    "we averaged the difference of the two configurations , @xmath52 .",
    "figure [ fig : d6-op ] shows the @xmath10 metric as a measure of relaxation vs the mean - squared displacement ( msd ) .",
    "we observe that @xmath10 metric does not correlate withe msd . as relaxation increases ( higher msd ) ,",
    "we expect that the @xmath10 value also increase .",
    "however , this metric is not robust for all systems , that is , we can not compare the relaxation across all hamiltonians ( potentials and crystal lattices ) .",
    "similar to the @xmath10 metrics , we used another metrics known as the soap ( smooth overlap of atomic position ) similarity kernel .",
    "the soap similarity kernel measures the difference in configuration ( 1 when it is identical and decreasing as the difference increases ) .",
    "the soap kernel is invariant to rotation and translation @xcite ; however , this metric is not applicable for multiple species cases .",
    "[ fig : soap - error ] shows the prediction error vs soap .",
    "similar to @xmath10 , the soap value does not correlate with the prediction error or displacement , that is , these metrics are too broad and vary too much for small displacements .",
    "this problem lies in the normalization of soap and @xmath10 values .     as a measure of the relaxation using a lennard- jones potential .",
    "we show that the @xmath10 metric does not correlated with the displacement .",
    "we show the relaxation of three crystal lattice .",
    "lj favor fcc/ hcp ; thus , we should not observe high relaxation ( this is indicated by the displacement which is less than 0.001 @xmath53 .",
    "however , the @xmath10 metrics show a very broad range from 0.0 ( identical configuration ) up to 0.1 .",
    "although we only show this plot for lj , the results of sw and eam potential reveal the same conclusion , that is , @xmath10 is not a sufficient metric to analyze the various crystal lattices and potentials.,scaledwidth=50.0% ]          none of the normal quantifying descriptions of distribution shape ( e.g. , width , skewness , kurtosis , standard deviation , etc . )",
    "show a correlation with the ce prediction error .",
    "the error increased proportionally with the level of error in each system ( 2 , 5 , 10 and 15% error ) .",
    "0.47   ( color online ) width , skewness and kurtosis using the relaxation energies .",
    "the relaxation energies are obtained by taking the absolute difference of unrelaxed and relaxed energies .",
    "we show only the 2% and 15% error instead of all four error levels .",
    "this allows us to illustrate the effect of error level on the width , skewness and kurtosis of the distribution.,title=\"fig : \" ]    0.47   ( color online ) width , skewness and kurtosis using the relaxation energies .",
    "the relaxation energies are obtained by taking the absolute difference of unrelaxed and relaxed energies .",
    "we show only the 2% and 15% error instead of all four error levels .",
    "this allows us to illustrate the effect of error level on the width , skewness and kurtosis of the distribution.,title=\"fig : \" ]    0.47   ( color online ) width , skewness and kurtosis using the relaxation energies .",
    "the relaxation energies are obtained by taking the absolute difference of unrelaxed and relaxed energies .",
    "we show only the 2% and 15% error instead of all four error levels .",
    "this allows us to illustrate the effect of error level on the width , skewness and kurtosis of the distribution.,title=\"fig : \" ]",
    "one other possibility is that the presence of outliers has a large impact on the performance of the bcs fit . to rule out that possibility , we performed fits with 0 , 1 , 2 , 10 , 20 , 30 , 40 , 50 and 60 outliers added to the error ( representing between 0 and 3% of the total data ) .",
    "outliers were selected randomly from between 2 and 4 standard deviations from the mean and then appended to the regular list of errors drawn from the distribution ( the total number of values equaling 2000 again to match the number of structures ) . the summary is plotted in figure [ fig : outliersummary ] .",
    "the difference between fits as the number of outliers changes is comparable to the variance in the individual fits .",
    "we conclude then that outliers have no direct effect on the error profile s performance .",
    "+     ( color online ) fitting errors as outliers are added to the error profile .",
    "the difference between fits as the number of outliers changes is comparable to the variance in the individual fits.,scaledwidth=50.0% ]      to further elucidate the claims relative to the ce framework s failures , we investigated whether we could measure the change in configuration upon relaxation . since the @xmath8 values selected in the model are backed by geometric clusters , the presence or absence of certain clusters has some correlation to the configuration of the physical system . when the physics is mostly dependent on configuration , the function can be sparsely represented by the ce basis .",
    "thus , we expect that the sparsity will be a good heuristic in determining when the ce breaks down .",
    "when the expansion terms do not decay well in the representation , it shows a misapplication of the ce basis to a problem that is not mostly configurational .      1 .",
    "[ item : xidefinition ] @xmath32 : total number of unique clusters used over 100 ce fits of the same dataset .",
    "we also call this the model complexity as shown in fig .",
    "[ fig : errorvsmodelcomplexity ] .",
    "[ item : notindefinition ] @xmath33 : number of `` exceptional '' clusters .",
    "these are clusters that show up fewer than 25 times across 100 fits , implying that they are not responsible for representing any real physics in the signal , but are rather included because the ce basis is no longer a sparse representation for the relaxed alloy system ( shown in fig .",
    "[ fig : errorvssingleshow ] .",
    "it is sensitive to the training subsets .",
    "[ item : lambdadefinition ] @xmath34 : number of _ significant _ clusters in the fit ; essentially just the total number of unique clusters minus the number of `` exceptional '' clusters , @xmath35 ( see fig .",
    "[ fig : errorvssignificantterms ] ) ."
  ],
  "abstract_text": [
    "<S> cluster expansion ( ce ) is effective in modeling the stability of metallic alloys , but sometimes cluster expansions fail . </S>",
    "<S> failures are often attributed to atomic relaxation in the dft - calculated data , but there is no metric for quantifying the degree of relaxation . </S>",
    "<S> additionally , numerical errors can also be responsible for slow ce convergence . </S>",
    "<S> we studied over one hundred different hamiltonians and identified a heuristic , based on a normalized mean - squared displacement of atomic positions in a crystal , to determine if the effects of relaxation in ce data are too severe to build a reliable ce model . using this heuristic , </S>",
    "<S> ce practitioners can determine a priori whether or not an alloy system can be reliably expanded in the cluster basis . </S>",
    "<S> we also examined the error distributions of the fitting data . </S>",
    "<S> we find no clear relationship between the type of error distribution and ce prediction ability , but there are clear correlations between ce formalism reliability , model complexity , and the number of significant terms in the model . </S>",
    "<S> our results show that the _ size _ of the errors is much more important than their distribution . </S>"
  ]
}