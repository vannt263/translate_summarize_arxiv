{
  "article_text": [
    "in numerical computations of the hydrodynamic evolution of astrophysical flows the usage of a rotating coordinate system is often desirable .",
    "for example , in calculating the evolution of an accretion disk in a cataclysmic variable system usually a coordinate system which rotates with the orbital speed of the secondary is used ( eg .",
    "heemskeerk , 1994 ) . then the secondary star remains at a fixed location in the grid , simplifying the numerical procedure . also , in computations of a disk around a binary star ( artymowicz & lubow , 1994 ) or with an embedded planet in the disk ( kley , 1998 , bryden et al .",
    "1998 ) corotating coordinates are very useful . in particular , this simplifies grid refinement in the vicinity of an embedded planet to resolve the detailed flow within the planet s roche lobe .    in standard , recent approaches to model the tidal effect on an accretion disk in a binary system the coriolis terms are treated as explicit source terms in the equations of motion ( eg . heemskerk 1994 , godon 1996 , kunze et al . 1997 ) .",
    "using this procedure , the coriolis force does not conserve total angular momentum .",
    "we are not aware that in any of these computations comparison runs between the inertial and corotating frame have been performed .",
    "as will be shown in this letter , using the sample calculation on an embedded planet within an accretion disk , the explicit approach yields incorrect results concerning the overall evolution of the system .",
    "we then proceed to demonstrate that , on the contrary , the conservative formulation of the coriolis term in the angular momentum equation leads to results which are identical to those performed in the inertial frame .    in the following section 2 the physical setup of the calculation",
    "is described . in section 3",
    ", the dependence of the obtained results on the treatment of the coriolis force are displayed , and in section 4 we summarize .",
    "in an accretion disk where the vertical thickness @xmath0 is usually much smaller than the distance @xmath1 from the center ( @xmath2 ) it is customary to work only with vertically averaged quantities . hence , the system under consideration consists of an infinitesimally thin disk with an embedded protoplanet .",
    "we work in a rotating coordinate system where the planet is at a fixed location .",
    "we shall work in cylindrical coordinates ( @xmath3 ) , where @xmath1 is the radial coordinate , @xmath4 is the azimuthal angle , and @xmath5 is the vertical axis , and the rotation is around the @xmath5-axis , i.e @xmath6 .",
    "the origin of the coordinate system is located at the center of mass of the system .    in a flat disc located in the @xmath7 plane ,",
    "the velocity components are @xmath8 . in the following",
    "we will use the symbol @xmath9 for the radial velocity and @xmath10 for the angular velocity of the flow , which are measured in the corotating frame .",
    "then the vertically integrated equations of motion are @xmath11 @xmath12 @xmath13}{\\partial t } }     + \\nabla ( \\sigma r^2 \\omega { \\bf u } )           =          - 2 \\sigma v \\ , \\omega \\ , r - { \\frac{\\partial p}{\\partial \\varphi } }          - \\sigma { \\frac{\\partial \\phi}{\\partial \\varphi } } + f{_{\\rm \\varphi } }        \\label{u_phi}\\ ] ] here @xmath14 denotes the surface density and @xmath15 the vertically integrated ( two - dimensional ) pressure .",
    "the gravitational potential @xmath16 created by the protostar with mass @xmath17 and the planet having mass @xmath18 is given by @xmath19 where @xmath20 is the gravitational constant and @xmath21 are the radius vectors to the star and planet , respectively . to model the potential of the planet within the roche lobe we introduce a smoothing length of 1/5 of the roche radius .",
    "the effects of viscosity are contained in the terms @xmath22 , and @xmath23 which give the viscous force per unit area acting in the radial and azimuthal direction .",
    "the explicit form of these terms is given in kley ( 1998 ) .",
    "note , that in the angular momentum equation ( [ u_phi ] ) the coriolis forces are included explicitly as source terms on the right hand side .",
    "if treated numerically , they do not conserve total angular momentum , and to demonstrate the effect of this formulation on the physical results the following , additional conservative formulation is used in the computations @xmath24}{\\partial t } }     + \\nabla [ \\sigma r^2 ( \\omega + \\omega ) { \\bf u } ]           =          - { \\frac{\\partial p}{\\partial \\varphi } } - \\sigma { \\frac{\\partial \\phi}{\\partial \\varphi } }     + f{_{\\rm \\varphi } }        \\label{u_phi2}.\\ ] ] as will be shown , only this latter form leads to correct results in the corotating frame .",
    "an energy equation is not required since an isothermal equation of state is used where the pressure is given by @xmath25 .",
    "the sound speed is set to a constant fraction of the keplerian velocity @xmath26 , which is equivalent to a fixed relative thickness of the disk , @xmath27 .",
    "the kinematic viscosity coefficient in these test calculations is set to a constant value @xmath28 in dimensionless units ( see below ) , and the bulk viscosity is set to zero . for the mass ratio of the planet to the star",
    "we assume @xmath29 .",
    "to solve the equations of motion dimensionless units are used where the unit of length is given by the distance @xmath30 of the planet to the star .",
    "the unit of time is given by @xmath31 where @xmath32 is the orbital speed of the planet ; identical to the speed of the rotating coordinate system .",
    "the other units follow from these .",
    "the disk is non self - gravitating , and the density scales out of the problem .",
    "the time in the result section , and the plots is given units of the period @xmath33 of the planet .",
    "the detailed description of the physical model used for the present analysis is outlined in kley ( 1998 ) and is not repeated here .",
    "the main results of this letter are obtained with a code called _ nirvana _",
    "( ziegler & yorke , 1997 ) , which is a 3d - multi - grid mhd code .",
    "it was adapted for this 2d , single grid , purely hydrodynamic application and extended by including the viscous terms explicitly .",
    "the code uses a spatially second order accurate , explicit method which handles advection by a monotonic transport algorithm .",
    "hence , the advective parts of the code conserve globally mass and angular momentum .",
    "an additional run , using identical physical parameter , has been performed with a different , independent code _",
    "wk _ developed by kley ( 1989 ) , which uses an implicit treatment of viscosity .",
    "the initial setup consists of a keplerian disk , with a density profile @xmath34 which follows in case of a constant kinematic viscosity .",
    "additionally , an initial gap ( lowering of the density ) is assumed around the planet whose size can be estimated by equating viscous and gravitational torques ( lin & papaloizou , 1993 ) .",
    "the initial @xmath35 profile is given for example in fig .",
    "the radial velocity is set to zero initially .",
    "the inner and outer boundary are closed throughout the evolution .",
    "the computational domain has the extent @xmath36 , @xmath37 , and covers the whole azimuthal range @xmath38 , @xmath39 .",
    "the grid resolution consists of @xmath40 equidistantly spaced grid points .",
    "the physical parameter for all 4 models presented are identical , and we state in table 1 the main , differing computational features of the models .",
    ".numerical parameter of the models [ cols=\"<,<,<\",options=\"header \" , ]",
    "this initially axially symmetric disk setup is evolved under the influence of the perturbing potential of the planet , which very soon creates non - axisymmetric features in the density distribution . trailing spiral arms are developing inside and outside of the planet s radial location . for details and the influence of the variation of the physical parameter",
    "see kley ( 1998 ) , and bryden et al .",
    "( 1998 ) . here",
    "we are only interested in numerical aspects of the computations .",
    "the total evolution time of the system covers about 200 orbital periods of the planet .    in figs .",
    "1 to 3 mountain plots of the surface density distribution at t=200 are given for the different calculations , where for clearity only half the grid points are displayed .",
    "while figs .",
    "1 and 2 refer to the computation using a corotating coordinate system fig .",
    "3 refers to a computation in the inertial frame where @xmath41 has been set to zero . in obtaining fig .",
    "1 the conservative treatment ( [ u_phi2 ] ) of the angular momentum equation has been used , while fig .",
    "2 was computed using the explicit version ( [ u_phi ] ) .    clearly , there are distinct differences in the density distribution in the two formulations of the problem .",
    "when the explicit form ( [ u_phi ] ) of the coriolis terms is used the obtained density profile is much shallower radially around the planet ( located at @xmath42 and @xmath43 ) .",
    "more matter seems to be pushed away from the planet to larger radii .",
    "this indicates an additional unphysical transport of angular momentum from inside out in the vicinity of the planet .",
    "in contrast , the inertial frame calculation ( fig .  3 ) and the first , conservative calculation ( fig .",
    "1 ) agree very well with each other . as the physical results should not depend on any assumed rotation of the coordinates",
    "we conclude that _ only _ in the case where the coriolis terms are treated in a conservative fashion the correct results are obtained .",
    "this important finding is corroborated by looking at the time evolution of the radial distribution of the surface density averaged over the azimuthal angle @xmath4 as given in fig  4 and 5 . in the conservative treatment ( fig .",
    "4 ) the averaged density distribution reaches a quasi - stationary state which does not evolve any further .",
    "this is to be expected once gravitational and viscous torques are in equilibrium .",
    "in contrast , the explicit formulation shows a continuing evolution of the density profile in the outer region ( fig .  5 ) , where mass appears to be accumulating near the outer boundary .",
    "a physically interesting question is related to possible mass accretion through the gap to form more massive planets as observed in extrasolar systems ( boss , 1996 ) . to model",
    "such a situation , mass has been removed continually within the roche lobe of the planet with a half emptying time of about 1/4 orbital periods of the planet ( kley 1998 ) . in figure 6",
    "the obtained mass accretion rate for the planets ( in dimensionless units ) is plotted versus time for the four models where the model named _ wk _ has been obtained in the inertial frame with a different code ( kley 1989 ) .",
    "obviously the codes _ nirvana _ and _ wk _ agree very well with each other , as do the conservative and inertial frame calculation .",
    "only the explicit form ( [ u_phi ] ) deviates again strongly and shows additionally a decline with time . the reduced accretion onto the planet appears to be caused by artificial angular momentum increase of the explicit model .",
    "to verify the conjecture above , we perform a local analysis of the finite difference equations .",
    "specifically , let us consider the change of angular momentum @xmath44 within one gridcell during one timestep @xmath45 . for simplicity , axial symmetry is assumed , and pressure and viscous effects are not considered .",
    "the change in the @xmath46 radial gridcell with volume @xmath47 using the conservative treatment is then given purely by the advection term @xmath48 \\delta t,\\ ] ] with the angular momentum flux ( flow per unit length and time ) @xmath49 , through the curcumference @xmath50 .",
    "to demonstrate the effect , we consider a simple upwind scheme on a staggered , equidistant grid , where @xmath51 and @xmath52 are located at @xmath53 in the middle of the cell interfaces @xmath54 and @xmath55 .",
    "the radial velocities @xmath56 are located at @xmath54 , and in ( [ jcons ] ) positive velocities are assumed .",
    "for the explcicit treatment ( eq . [ u_phi ] ) we obtain @xmath57 \\delta t , \\nonumber \\\\            &   + & \\delta j^{cor}_i   + r_{i+1/2}^2 \\omega \\delta m_i \\end{aligned}\\ ] ] where @xmath58 is the change in angular momentum caused by the explicit coriolis term , and @xmath59 is the change of mass in the gridcell .",
    "taking now the difference @xmath60 , and assuming @xmath61 and a quasi - stationary density distribution @xmath62 , then we find @xmath63 where @xmath64 .",
    "thus , for positive velocities which inevitably occur at the outer edge of the gap and a positive gradient of the density ( see fig . 4 and 5 ) , we find that @xmath65 .",
    "hence , the explicit treatment shows an artificial enhancement of angular momentum , which tends to widen the gap created by the planet even further ( see fig.5 ) .",
    "we notice , that the identical relation ( [ deltaj ] ) is obtained for negative velocity ( @xmath66 ) which means that for a standard accretion disk with @xmath67 and @xmath68 negative , the explcicit treatment yields to an artificial increase of angular momentum as well .",
    "both effects play a role in the presented model calculations of a planet embedded in an accretion disk .",
    "we have performed numerical computations of a planet embedded in a disk using different treatments of the coriolis force in the angular momentum equation .",
    "three different models , one with an explicit coriolis force , the second using a conservative formulation for the coriolis term , and the third in the inertial frame ( @xmath69 ) have been calculated .",
    "it was seen that only the second and the third model yield identical results , which were also confirmed by an additional calculation using a completely independent numerical code .",
    "we conclude that in performing numerical models which use a rotating reference frame , care must be taken to incorporate the coriolis terms correctly in the angular momentum equation .",
    "as often in numerical computations a conservative formulation of the coriolis force turned out to be superior over an explicit , non - conservative treatment . in the future numerical modelers should be aware of this potential problem when calculating applications such as disks in binary systems , circumbinary disks , rotating stars , or similar problems .",
    "the author is very grateful to dr .",
    "udo ziegler for making his code _ nirvana _ publicly available .",
    "useful discussions with dr .",
    "steve lubow ( stsci ) are gratefully acknowledged .",
    "this work was supported by the max - planck - gesellschaft grant no .",
    "02160 - 361-tg74 .",
    "artymowicz p. , lubow s.h .",
    ", 1994 , apj , 421 , 651 boss a.p .",
    ", 1996 , physics today , 49/9 , p32 .",
    "bryden g. , chen x. , lin d.n.c . ,",
    "nelson , r.p . ,",
    "papaloizou , j.c.b . , 1998 ,",
    "preprint , submitted to apj heemskerk m.h.m . , 1994 , a&a , 288 , 807 godon p. , 1997 ,",
    "apj , 480 , 329 kley , w. , 1989 , a&a , 208 , 98 kley , w. , 1998 , submitted to mnras kunze s. , speith r. , riffert h. , mnras , 289 , 889 lin d.n.c . ,",
    "papaloizou j.c.b . , 1993 , in _ protostars and planets iii _ , ed .",
    "levy , j.i.lunine , u. arizona p. , tucson .",
    "ziegler u. , yorke h.w . ,"
  ],
  "abstract_text": [
    "<S> in numerical computations of astrophysical flows one frequently has to deal with situations which require the use of a corotating coordinate system . </S>",
    "<S> then , in addition to the centrifugal force , the coriolis terms have to be included in the navier - stokes equations . in usual numerical treatments of solving the equations of motion these non - inertial forces </S>",
    "<S> are included explicitly as source terms . in this letter </S>",
    "<S> we show that this procedure , if applied to the angular momentum equation , may lead to erroneous results . using the specific sample calculation of a protoplanet embedded in a protostellar disk </S>",
    "<S> , we then demonstrate that only a conservative treatment of the coriolis term in the angular momentum equation yields results which are identical to those obtained by computations performed in the inertial frame . </S>"
  ]
}