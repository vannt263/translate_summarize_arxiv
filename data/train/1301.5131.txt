{
  "article_text": [
    "the definition and study of metrics for the comparison of rooted phylogenetic trees on the same set of taxa is a classical problem in phylogenetics ( * ? ? ?",
    "30 ) , and many metrics have been introduced so far with this purpose . a recent addition to the set of metrics available in this context",
    "cophenetic metrics _",
    "@xmath0 introduced in @xcite .",
    "based on a fifty years old idea of sokal and rohlf , these metrics compare phylogenetic trees on a same set of taxa by first encoding the trees by means of their vectors of cophenetic values of pairs of taxa and depths of single taxa , and then computing the @xmath2 norm of the difference of the corresponding vectors .",
    "once the disimilarity between two phylogenetic trees has been computed through a given metric , it is convenient in many situations to assess its signifiance .",
    "one possibility is to compare the value obtained with its expected , or mean , value : is it much larger , much smaller , similar ? @xcite",
    "this makes it necessary to study the distribution of the metric , or , at least , to have a formula for the expected value of the metric for any number @xmath4 of leaves .",
    "the distribution of several metrics has been studied so far : see , for instance , @xcite .",
    "the expected value of a distance depends on the probability distribution on the space of phylogenetic trees under consideration .",
    "the most popular distribution on the space @xmath5 of binary phylogenetic trees with @xmath4 leaves is the uniform distribution , under which all trees in @xmath5 are equiprobable . but phylogeneticists consider also other probability distributions on @xmath5 , defined through stochastic models of evolution ( * ? ? ?",
    "the most popular is the so - called yule model @xcite , defined by an evolutionary process where , at each step , each currently extant species can give rise , with the same probability , to two new species .",
    "under this model , different phylogenetic trees with the same number of leaves may have different probabilities , which depend on their shape .",
    "in this paper we provide explicit formulas for the expected values under the uniform and the yule models of the square of the _ euclidean cophenetic metric _ @xmath3 .",
    "the proofs of these formulas are based on long and tedious algebraic computations and thus , to ease the task of the reader interested only in the formulas and the path leading to them , but not in the details , we have moved these computations to an appendix at the end of the paper .    besides the aforemenentioned application of this value in the assessment of tree comparisons , the knowledge of formulas for the expected value of @xmath6 under different models may allow the use of @xmath3 to test stochastic models of tree growth , a popular line of research in the last years which so far has been mostly based on shape indices ; see , for instance , @xcite . as a proof of concept , in  4",
    "we report on a basic , preliminary such test performed on the binary phylogenetic trees contained in the treebase database @xcite .",
    "in this paper , by a _ phylogenetic tree _ on a set @xmath7 of taxa we mean a fully resolved , or binary , rooted tree with its leaves bijectively labeled in @xmath7 .",
    "we understand such a rooted tree as a directed graph , with its arcs pointing away from the root . to simplify the language , we shall always identify a leaf of a phylogenetic tree with its label .",
    "we shall also use the term _ phylogenetic tree with @xmath4 leaves _ to refer to a phylogenetic tree on the set @xmath8 .",
    "we shall denote by @xmath9 the space of all phylogenetic trees on @xmath7 and by @xmath5 the space of all phylogenetic trees with @xmath4 leaves .",
    "let @xmath10 be a phylogenetic tree .",
    "if there exists a directed path from @xmath11 to @xmath12 in @xmath10 , we shall say that @xmath12 is a _ descendant _ of @xmath11 and also that @xmath11 is an _ ancestor _ of @xmath12 .",
    "the _ lowest common ancestor _ @xmath13 of a pair of nodes @xmath14 in @xmath10 is the unique common ancestor of them that is a descendant of every other common ancestor of them .",
    "the _ depth _ @xmath15 of a node @xmath12 in @xmath10 is the distance ( in number of arcs ) from the root of @xmath10 to @xmath12 .",
    "the _ cophenetic value _",
    "@xmath16 of a pair of leaves @xmath17 in @xmath10 is the depth of their lca . to simplify the notations , we shall often write @xmath18 to denote the depth @xmath19 of a leaf @xmath20 .    given two phylogenetic trees @xmath21 on disjoint sets of taxa @xmath22 , respectively",
    ", we shall denote by @xmath23 the phylogenetic tree on @xmath24 obtained by connecting the roots of @xmath10 and @xmath25 to a ( new ) common root .",
    "every phylogenetic tree @xmath26 is obtained as @xmath27 , for some @xmath28 , some subset @xmath29 with @xmath30 elements , some tree @xmath31 on @xmath32 and some tree @xmath33 on @xmath34 .",
    "actually , every phylogenetic tree in @xmath5 is obtained in this way twice .",
    "the _ yule _ , or _ equal - rate markov _ , model of evolution @xcite is a stochastic model of phylogenetic trees growth .",
    "it starts with a node , and at every step a leaf is chosen randomly and uniformly and it is splitted into two leaves .",
    "finally , the labels are assigned randomly and uniformly to the leaves once the desired number of leaves is reached .",
    "this corresponds to a model of evolution where , at each step , each currently extant species can give rise , with the same probability , to two new species . under this stochastic model ,",
    "if @xmath26 is a phylogenetic tree with set of internal nodes @xmath35 , and if for every @xmath36 we denote by @xmath37 the number of its descendant leaves , then the probability of @xmath10 is @xcite @xmath38    the _ uniform _ , or _",
    "proportional to distinguishable arrangements _ , model @xcite is another stochastic model of phylogenetic trees growth . unlike the yule model",
    ", its main feature is that all phylogenetic trees @xmath26 have the same probability : @xmath39 from the point of view of tree growth , this model is described as the process that starts with a node labeled 1 and then , at the @xmath30-th step , a new pendant arc , ending in the leaf labeled @xmath40 , is added either to a new root ( whose other child will be , then , the original root ) or to some edge , with all possible locations of this new pendant arc being equiprobable @xcite . although this is not an explicit model of evolution , only of tree growth , several interpretations of it in terms of evolutionary processes have been given in the literature : see @xcite and the references therein .",
    "let @xmath26 be a phylogenetic tree with @xmath4 leaves .",
    "the _ cophenetic vector _ of @xmath10 is @xmath41 with its elements lexicographically ordered in @xmath42 .",
    "it turns out @xcite that the mapping @xmath43 sending each @xmath26 to its cophenetic vector @xmath44 , is injective up to isomorphism .",
    "as it is well known , this allows to induce metrics on @xmath5 from metrics defined on powers of @xmath45 .",
    "in particular , in this paper we consider the cophenetic metric @xmath3 on @xmath5 induced by the euclidean distance : @xmath46 to distinguish it from other cophenetic metrics obtained through other @xmath2 normes , we shall call it the _ euclidean cophenetic metric_.    consider the phylogenetic trees @xmath47 depicted in fig . [ fig:1 ] .",
    "their total cophenetic vectors are @xmath48 and therefore @xmath49 . as we shall see below , the expected values of the square of @xmath3 on @xmath50 under the uniform and the yule models are , respectively , @xmath51 and @xmath52 , and hence these two trees are quite more similar than average with respect to the euclidean cophenetic metric under both models .",
    "( 0,0 ) node [ tre ] ( 1 ) ; 1 ( 3,0 ) node [ tre ] ( 2 ) ; 2 ( 6,0 ) node [ tre ] ( 3 ) ; 3 ( 9,0 ) node [ tre ] ( 4 ) ; 4 ( 1.5,3 ) node [ tre ] ( a ) ; ( 7.5,3 ) node [ tre ] ( b ) ; ( 4.5,6 ) node [ tre ] ( r ) ; ( r)(a ) ; ( r)(b ) ; ( a)(1 ) ; ( a)(2 ) ; ( b)(3 ) ; ( b)(4 ) ; ( 4.5,-1.5 ) node @xmath10 ;    ( 0,0 ) node [ tre ] ( 1 ) ; 1 ( 3,0 ) node [ tre ] ( 2 ) ; 2 ( 6,0 ) node [ tre ] ( 3 ) ; 3 ( 9,0 ) node [ tre ] ( 4 ) ; 4 ( 7.5,2 ) node [ tre ] ( b ) ; ( 6,4 ) node [ tre ] ( a ) ; ( 4.5,6 ) node [ tre ] ( r ) ; ( r)(a ) ; ( r)(1 ) ; ( a)(2 ) ; ( a)(b ) ; ( b)(3 ) ; ( b)(4 ) ; ( 4.5,-1.5 ) node @xmath25 ;    let @xmath53 the random variable that chooses a pair of trees @xmath54 and computes @xmath55 .",
    "its expected values under the yule and the uniform models are given by the following two theorems .",
    "recall that the @xmath4-th _ harmonic number _ @xmath56 is defined as @xmath57 .",
    "[ th : yule ] for every @xmath58 , the expected value of @xmath53 under the yule model is @xmath59    [ th : unif ] for every @xmath58 , the expected value of @xmath53 under the uniform model is @xmath60    since @xmath61 and @xmath62 , these formulas imply that @xmath63    we shall prove the formulas in theorems [ th : yule ] and [ th : unif ] by reducing the computation of the expected value of @xmath53 to that of the following random variables :    * @xmath64 , the random variable that chooses a tree @xmath26 and computes its sackin index @xmath7 @xcite , defined by @xmath65 * @xmath66 , the random variable that chooses a tree @xmath26 and computes its total cophenetic index @xmath67 @xcite , defined by @xmath68 * @xmath69 , the random variable that chooses a tree @xmath26 and computes @xmath70    for the models under consideration , the expected values of these variables are related to that of @xmath53 by the next proposition . in it and henceforth , we shall denote by @xmath71 the expected value of a random variable @xmath72 on @xmath5 under a generic probability distribution @xmath73 $ ] on @xmath5 invariant under relabelings .",
    "the probability distributions @xmath74 and @xmath75 defined by the yule and the uniform models , respectively , are invariant under relabelings , and therefore the expected values under these specific models , which will be denoted by @xmath76 and @xmath77 , respectively , are special cases of @xmath78 .",
    "[ prop : e ] @xmath79    to simplify the notations , let    * @xmath80 be the random variable that chooses a tree @xmath26 and computes @xmath81 . * @xmath82 be the random variable that chooses a tree @xmath26 and computes @xmath83 .",
    "let us compute now @xmath84 from its very definition : @xmath85 @xmath86 now , the values of @xmath87 and @xmath88 can be easily obtained from @xmath89 and @xmath90 , respectively , using the invariance under relabelings of the probability distribution under which we compute the expected values @xmath78 : @xmath91 the formula in the statement is then obtained by replacing @xmath87 and @xmath88 by these values .",
    "the expected values of @xmath64 and @xmath66 under the yule and the uniform models are known : @xmath92 \\displaystyle    e_y(\\phi_n)=n(n-1)-2n(h_n-1 ) & \\qquad \\displaystyle e_u(\\phi_n)=\\frac{1}{2 } \\binom{n}{2 } \\big(\\frac{(2n-2)!!}{(2n-3)!!}-2 \\big )   \\end{array}\\ ] ] the formula for @xmath93 was proved in @xcite and the other three , in @xcite .    to obtain the expected values of @xmath53 , it remains to compute the expected values of @xmath69 .",
    "they are given by the following result .",
    "[ prop : d^2 ] for every @xmath58 ,    a.   @xmath94 b.   @xmath95    this proposition is proved in the appendix at the end of this paper .",
    "finally , the identities given in theorems [ th : yule ] and [ th : unif ] are obtained by replacing , in the identity given in proposition [ prop : e ] , @xmath89 , @xmath90 , and @xmath96 by their values under the yule and the uniform models , respectively .",
    "we leave the last details to the reader .",
    "in this section we report on a very simple experiment to show how @xmath3 can be used to test evolutionary hypotheses . in this experiment , we have compared the expected value of @xmath97 on @xmath5 under the uniform and the yule models with its average value on the set treebase@xmath98 of binary phylogenetic trees with @xmath4 leaves contained in treebase @xcite .    to perform this experiment , we have taken some decisions . first , since there are only very few values @xmath99 such that @xmath100 , we have decided to consider only those binary trees contained in treebase with @xmath101 leaves . on the other hand , even for those @xmath4 such that @xmath102 is relatively large , in most cases it does not contain many pairs of trees with the same taxa .",
    "so , instead of computing the average value of @xmath97 on @xmath102 by averaging the values @xmath103 for pairs of trees @xmath21 with exactly the same @xmath4 taxa , we have made use of the formula given in proposition [ prop : e ] , as if @xmath102 was closed under relabelings : that is , we have taken only into account the shapes of the trees contained in it .",
    "this is consistent with the fact that our final goal is to test models of evolution that produce tree shapes .",
    "so , we have computed the average values of @xmath104 , of the sackin index @xmath7 , and of the total cophenetic index @xmath67 on @xmath102 , and we have taken as average value of @xmath97 on this set the result of appying the formula in proposition [ prop : e ] .",
    "the detailed results of these computations , as well as the python and r scripts used to compute and analyze them , are available in the supplementary material web page http://bioinfo.uib.es/~recerca / phylotrees / expectedcophdist/.    fig .",
    "2 plots the log of these average values as a function of @xmath105 .",
    "we have added the curves of the log of the expected values of @xmath53 under the yule distribution ( lower , dotted curve ) and under the uniform distribution ( upper , dashed curve ) , again as a function of @xmath105 .",
    "the graphic shows that the expected value of @xmath97 on ( the shapes of ) the phylogenetic trees contained in treebase is better explained by the uniform model than by the yule model .",
    "this agrees with the results of similar experiments using other measures ( see , for instance , @xcite ) .     for the binary trees in treebase with a fixed number @xmath4 of leaves , of @xmath106 ( dotted curve ) and @xmath107 ( dashed curve).,title=\"fig:\",height=226 ] [ means ]",
    "in this paper we have obtained formulas for the expected values under the yule and the uniform models of the square of the euclidean cophenetic metric @xmath3 , defined by the euclidean distance between cophenetic vectors .",
    "these formulas are explicit and hold on spaces @xmath5 of fully resolved phylogenetic trees with any number @xmath4 of leaves .",
    "these formulas have been obtained through long algebraic manipulations of sums of sequences .",
    "to double - check our results , we have computed the exact value of @xmath106 and @xmath107 for @xmath108 , by generating all trees with up to @xmath109 leaves .",
    "moreover , we have computed numerical approximations to these values for @xmath110 , by generating pairs of random trees until the numerical method stabilizes .",
    "these numerical experiments confirm that our formulas give the right figures .",
    "table [ table:1 ] gives the exact values for @xmath108 .",
    "the results of the simulations for @xmath110 , as well as the python scripts used in these computations , are also available in the aforementioned supplementary material web page http://bioinfo.uib.es/~recerca / phylotrees / expectedcophdist/.    .[table:1]values of @xmath106 and @xmath107 for @xmath111 .",
    "they agree with those given by our formulas . [ cols=\">,^,^,^,^,^\",options=\"header \" , ]     the formulas for @xmath106 and @xmath107 grow in different orders : @xmath106 is in @xmath112 , while @xmath107 is in @xmath113 .",
    "therefore , they can be used to test the yule and the uniform models as null stochastic models of evolution for collections of phylogenetic trees reconstructed by different methods .",
    "we have reported on a first experiment of this type , which reinforces the conclusion that `` real world '' phylogenetic trees ( that is , those contained in treebase ) are not consistent with the yule model of evolution . we plan to report in a future paper on more extensive tests on stochastic models of evolutionary processes , including ford s @xmath114-model @xcite and aldous @xmath115-model @xcite .",
    "the research reported in this paper has been partially supported by the spanish government and the ue feder program , through projects mtm2009 - 07165 and tin2011 - 15874-e .    11    m. abramowitz , i. stegun , _ handbook of mathematical functions with formulas , graphs , and mathematical tables_. dover ( 1964 ) .",
    "d. aldous .",
    "probability distributions on cladograms .",
    "random discrete structures , i m a vol .",
    "76 ( springer,1996 ) , 118 .",
    "m. g. b. blum , o. franois , which random processes describe the tree of life ?",
    "a large - scale study of phylogenetic tree imbalance .",
    "55 ( 2006 ) , 685691 .",
    "j. brown , probabilities of evolutionary trees .",
    "43 ( 1994 ) , 7891 .",
    "d. bryant , m. steel , computing the distribution of a tree metric .",
    "ieee / acm trans . comp .",
    "bioinf . 16",
    "( 2009 ) , 420426 .",
    "g. cardona , a. mir , f. rossell , the expected value under the yule model of the squared path - difference distance .",
    "25 ( 2012 ) , 20312036 .",
    "g. cardona , a. mir , f. rossell , exact formulas for the variance of several balance indices under the yule model . to appear in j. math .",
    "http://dx.doi.org/10.1007/s00285-012-0615-9    g. cardona , a. mir , l. rotger , f. rossell , d. snchez , cophenetic metrics for phylogenetic trees , after sokal and rohlf .",
    "bmc bioinformatics ( 2013 ) 14:3    l. l. cavalli - sforza , a. edwards , phylogenetic analysis .",
    "models and estimation procedures . am . j. hum .",
    ", 19 ( 1967 ) , 233257",
    ". j.  felsenstein , _ inferring phylogenies_. sinauer associates inc . , 2004 .",
    "probabilities on cladograms : introduction to the alpha model . `",
    "arxiv : math/0511246 [ math.pr ] ` ( 2005 ) .    http://functions.wolfram.com/hypergeometricfunctions/hypergeometric3f2/03/07/02 .",
    "http://functions.wolfram.com/hypergeometricfunctions/hypergeometric2f1/03/03/01 .",
    "e. harding , the probabilities of rooted tree - shapes generated by random bifurcation . adv .",
    "prob . 3 ( 1971 ) , 4477 .",
    "s. b. heard , patterns in tree balance among cladistic , phenetic , and randomly generated phylogenetic trees .",
    "evolution 46 ( 1992 ) , 18181826 .",
    "m. hendy , c. little , d. penny , comparing trees with pendant vertices labelled .",
    "siam j. applied math .",
    "44 ( 1984 ) , 10541065 .    a. mir , f. rossell , the mean value of the squared path - difference distance for rooted phylogenetic trees . j. math .",
    "371 ( 2010 ) , 168176 .    a. mir , f. rossell , l. rotger , a new balance index for phylogenetic trees . math .",
    "biosc . 241",
    "( 2013 ) , 125136 .",
    "a. mooers , s. b. heard , inferring evolutionary process from phylogenetic tree shape .",
    "72 ( 1997 ) , 3154 .",
    "v. morell , treebase : the roots of phylogeny .",
    "science 273 ( 1996 ) , 569560 .",
    "m. petkovsek , h. wilf , d. zeilberger , @xmath116 .",
    "ak peters ltd .",
    "available online at http://www.math.upenn.edu/~wilf/aeqb.html .",
    "d. e. rosen , vicariant patterns and historical explanation in biogeography .",
    "( 1978 ) , 159188 .",
    "m. j. sackin , `` good '' and `` bad '' phenograms .",
    "zool , 21 ( 1972 ) , 225226 .",
    "r. sokal , f. rohlf , the comparison of dendrograms by objective methods .",
    "taxon 11 ( 1962 ) , 3340 .",
    "m. steel , distribution of the symmetric difference metric on phylogenetic trees .",
    "siam j. discr .",
    "math . 1 ( 1988 )",
    ", 541551 .",
    "m. steel , a. mckenzie , distributions of cherries for two models of trees . math . biosc .",
    "164 ( 2000 ) , 8192 .    m. steel , a. mckenzie , properties of phylogenetic trees generated by yule - type speciation models .",
    "biosc . 170 ( 2001 ) , 91112 .",
    "m.  a. steel , d.  penny , distributions of tree comparison metrics  some new results , syst .",
    "42  ( 2 ) ( 1993 ) 126141 .",
    "g. u. yule , a mathematical theory of evolution based on the conclusions of dr j. c. willis .",
    "royal soc .",
    "( london ) series b 213 ( 1924 ) , 2187 .",
    "to compute @xmath121 , we shall use an argument similar to the one used in the proof of ( * ? ? ?",
    "3 ) . notice that @xmath122 now , on the one hand , we have the following easy lemma on @xmath123 : see ( * ? ? ?",
    "* lem . 1 ) .",
    "so , if we set @xmath135 , we have that @xmath136   \\frac{2}{(n-1)\\binom{n}{k } } p_y(t_{k})p_y(t'_{n - k})\\\\   \\displaystyle\\quad    = \\frac{1}{n-1}\\sum_{k=1}^{n-1 }   \\big [ \\sum_{t_k}\\sum_{t'_{n - k } } { \\overline\\phi^{(2)}}(t_k)p_y(t_{k})p_y(t'_{n - k } )    \\\\ \\displaystyle\\qquad + \\sum_{t_k}\\sum_{t'_{n - k } } { \\overline\\phi^{(2)}}(t'_{n - k})p_y(t_{k})p_y(t'_{n - k } ) \\\\",
    "\\displaystyle\\qquad + 2\\sum_{t_k}\\sum_{t'_{n - k } } { \\overline\\phi}(t_k)p_y(t_{k})p_y(t'_{n - k})\\\\ \\displaystyle\\qquad + 2\\sum_{t_k}\\sum_{t'_{n - k } } { \\overline\\phi}(t'_{n - k})p_y(t_{k})p_y(t'_{n - k } ) \\\\ \\displaystyle\\qquad + \\sum_{t_k}\\sum_{t'_{n - k } } f(k , n - k)p_y(t_{k})p_y(t'_{n - k } ) \\big]\\\\    \\quad   \\displaystyle   = \\frac{1}{n-1}\\sum_{k=1}^{n-1 }   \\big [ \\sum_{t_k}{\\overline\\phi^{(2)}}(t_k)p_y(t_{k } )   + \\sum_{t'_{n - k } } { \\overline\\phi^{(2)}}(t'_{n - k})p_y(t'_{n - k})\\\\ \\displaystyle\\qquad + 2\\sum_{t_k}{\\overline\\phi}(t_k)p_y(t_{k } ) + 2\\sum_{t'_{n - k } } { \\overline\\phi}(t'_{n - k})p_y(t'_{n - k } ) + f(k , n - k ) \\big]\\\\",
    "\\quad   \\displaystyle   = \\frac{1}{n-1}\\sum_{k=1}^{n-1 }   \\big[e_y({\\overline\\phi^{(2)}}_k)+e_y({\\overline\\phi^{(2)}}_{n - k } ) + 2e_y({\\overline\\phi}_k)+2e_y({\\overline\\phi}_{n - k})\\\\ \\displaystyle\\qquad + \\binom{k+1}{2}+\\binom{n - k+1}{2}\\big]\\\\ \\quad   \\displaystyle   = \\frac{2}{n-1}\\sum_{k=1}^{n-1 }   e_y({\\overline\\phi^{(2)}}_k ) + \\frac{4}{n-1}\\sum_{k=1}^{n-1}e_y({\\overline\\phi}_k)+\\frac{1}{3}n(n+1 ) .",
    "\\end{array}\\ ] ] in particular @xmath137 and therefore @xmath138 \\quad \\displaystyle=\\frac{n-2}{n-1 } e_y({\\overline\\phi^{(2)}}_{n-1})+\\frac{2}{n-1}e_y({\\overline\\phi^{(2)}}_{n-1})+\\frac{4}{n-1}e_y({\\overline\\phi}_{n-1})+n\\\\[1ex ] \\quad \\displaystyle=\\frac{n}{n-1 } e_y({\\overline\\phi^{(2)}}_{n-1})+5n-8 . \\end{array}\\ ] ] setting @xmath139 , this recurrence becomes @xmath140 and the solution of this recursive equation with @xmath141 is @xmath142 from where we deduce that @xmath143 , as we claimed .",
    "a formula for @xmath151 was obtained in the proof of ( * ? ? ?",
    "21 ) : @xmath152 as far as @xmath153 goes , we have the following result . in it , and henceforth , @xmath154 denotes the ( _ generalized _ ) _ hypergeometric function _ defined by @xmath155 b_1 , & \\ldots ,   & b_q\\end{array};z\\right)=\\sum_{k{\\geqslant}0 } \\frac{(a_1)_k\\cdots ( a_p)_k}{(b_1)_k\\cdots ( b_q)_k}\\cdot \\frac{z^k}{k!},\\ ] ] where @xmath156 and @xmath157 for @xmath158 .",
    "let us start by proving @xmath159 by induction on @xmath4 .",
    "it is clear that @xmath162 .",
    "assume now that @xmath163 .",
    "every phylogenetic tree @xmath10 with @xmath4 leaves such that @xmath164 , that is , where @xmath165 is the root , is obtained by taking a phylogenetic tree @xmath25 with @xmath166 leaves such that @xmath167 and adding a new pendant edge , ending in the leaf @xmath4 , to any edge in @xmath25 .",
    "then , since there are @xmath168 trees @xmath169 such that @xmath167 , and each one of them has @xmath170 edges where we can add the new edge , we obtain @xmath171    now , to compute @xmath153 for @xmath158 , we shall study the structure of a tree @xmath172 such that @xmath173 ; to simplify the notations , let us denote by @xmath174 the node @xmath165 , which has depth @xmath30 , and by @xmath175 the subtree of @xmath10 rooted at @xmath174 .    then , on the one hand , @xmath175 is a phylogenetic tree on a subset @xmath176 containing @xmath177 , and since its root @xmath174 is the lca of 1 and 2 in @xmath10 , we have that @xmath178 . on the other hand",
    ", there is a path @xmath179 in @xmath10 from @xmath180 to @xmath174 .",
    "for every @xmath181 , let @xmath182 be the subtree rooted at the child of @xmath183 other than @xmath184 ; see fig .",
    "[ fig : forests ] .      * a number @xmath185 , so that @xmath186 will be the number of leaves of the phylogenetic tree @xmath175 rooted at @xmath165 * a subset @xmath187 of @xmath188 .",
    "there are @xmath189 such subsets . * a phylogenetic tree @xmath175 on @xmath190 such that @xmath178 .",
    "there are @xmath191 such trees . *",
    "an _ ordered @xmath30-forest _ , that is , an ordered sequence of phylogenetic trees @xmath192 such that @xmath193 . the number of such ordered @xmath30-forests is ( see , for instance , ( * ? ? ?",
    "* lem .  1 ) )",
    "@xmath194    ( 0,2 ) node[tre ] ( x ) ; x ( -2,-1.5 ) node @xmath195 ; ( 2,-1.5 ) node @xmath196 ; ( x)(-2,-1)(2,-1)(x ) ; ( 0,0 ) node @xmath175 ; ( 2,4 ) node[tre ] ( x1 ) ; ( x1)(x ) ; ( x1)(3,5 ) ; ( 3.3,5.3 ) node . ;",
    "( 3.6,5.6 ) node . ;",
    "( 3.9,5.9 ) node . ; ( 5,7 ) node[tre ] ( x2 ) ; ( 4.2,6.2)(x2 ) ; ( 7,9 ) node[tre ] ( r ) ; ( x2)(r ) ; ( 5,3 ) node[tre ] ( tk ) ; ( tk)(3.6,0)(6.4,0)(tk ) ; ( 5,1 ) node @xmath197 ; ( x1)(tk ) ; ( 8,6 ) node[tre ] ( t2 ) ; ( t2)(6.6,3)(9.4,3)(t2 ) ; ( 8,4 ) node @xmath198 ; ( x2)(t2 ) ; ( 10,8 ) node[tre ] ( t1 ) ; ( t1)(8.6,5)(11.4,5)(t1 ) ; ( 10,6 ) node @xmath199 ; ( r)(t1 ) ;    this shows that @xmath153 can be computed as @xmath200 &   \\qquad\\qquad \\cdot \\mbox{(number of trees in $ { \\mathcal{t}}_{m+2}$ with $ \\varphi_t(1,2)=0 $ ) } \\\\ & \\qquad\\qquad \\cdot \\mbox{(number of   ordered $ k$-forests   on $ n - m-2 $ leaves ) } \\\\ & = \\displaystyle \\sum_{m=0}^{n - k-2 }   \\binom{n-2}{m}\\cdot ( 2 m ) ! !",
    "\\cdot \\frac{(2n-2m - k-5)!k}{(n - m - k-2)!2^{n - m - k-2}}\\\\ & = \\displaystyle k\\sum_{m=0}^{n - k-2 } \\frac{(n-2 ) !",
    "m ! 2^m ( 2n-2m - k-5)!}{m!(n - m-2)!(n - m - k-2)!2^{n - m - k-2}}\\\\ & = \\displaystyle\\frac{(n-2)!k}{2^{n - k-2}}\\sum_{m=0}^{n - k-2 } \\frac{4^m ( 2n-2m - k-5)!}{(n - m-2)!(n - m - k-2 ) ! } \\end{array}\\ ] ] now , taking into account that @xmath201 we have that @xmath202 from where we deduce that @xmath203 and hence @xmath204 as we claimed .        the proof of these identities is standard , using well known equalities for hypergeometric functions and the _ lookup algorithm _ given in @xcite",
    ". we shall prove in detail the identity for @xmath209 , and we leave the details of the rest to the reader .",
    "as to @xmath212 , @xmath213 if we set @xmath214 we have that @xmath215 and therefore , by the _ lookup algorithm _ @xcite , we have that @xmath216 1\\end{array};\\frac{1}{2}\\bigg)\\\\ \\quad \\displaystyle = \\frac{(n-1)!}{2}\\cdot 2^n\\cdot { } _ 2 f_1 \\bigg(\\begin{array}{l } n,\\ -1 \\\\[-0.5ex ] 1\\end{array};-1\\bigg)\\quad\\mbox{(using ( 15.3.4 ) in \\cite[p . 559]{as})}\\\\ \\quad   \\displaystyle = ( n-1)!2^{n-1}\\sum_{k{\\geqslant}0 } \\frac{(n)_k(-1)_k}{(1)_k}\\cdot \\frac{(-1)^k}{k!}\\\\ \\quad   \\displaystyle = ( n-1)!2^{n-1}\\big(\\frac{(n)_0(-1)_0}{(1)_0}\\cdot \\frac{(-1)^0}{0!}+ \\frac{(n)_1(-1)_1}{(1)_1}\\cdot \\frac{(-1)^1}{1!}\\big)\\\\ \\quad   \\displaystyle=(n-1)!2^{n-1}(n+1 ) \\end{array}\\ ] ]    as to @xmath217 , @xmath218 if we take now @xmath219 we have that @xmath220 and therefore , again by the _ lookup algorithm _",
    "@xcite , we have that @xmath221 n-1,\\ n-1\\end{array};\\frac{1}{2}\\bigg)\\\\ \\qquad \\displaystyle   = \\frac{(n-1)^2(2n-3)!}{(n-1 ) ! 2^{n-1}}\\big [ { } _ 2 f_1 \\bigg(\\begin{array}{l } 2n-2,\\ 1 \\\\[-0.5ex ] n-1\\end{array};\\frac{1}{2}\\bigg)+\\frac{1}{n-1 } \\cdot { } _ 2 f_1 \\bigg(\\begin{array}{l } 2n-1,\\ 2 \\\\[-0.5ex ] n\\end{array};\\frac{1}{2}\\bigg)\\big]\\\\ \\quad \\hspace*{\\fill } \\mbox{(using \\cite{hf1})}. \\end{array}\\ ] ] now @xmath222 n-1\\end{array};\\frac{1}{2}\\bigg)=2\\cdot { } _ 2 f_1 \\bigg(\\begin{array}{l } 1-n,\\ 1 \\\\[-0.5ex ] n-1\\end{array};-1\\bigg)\\quad\\mbox{(using ( 15.3.4 ) in \\cite[p . 559]{as})}\\\\ \\qquad \\displaystyle=2\\cdot",
    "\\frac{2^{2(n-2)}\\gamma(n-1)}{\\gamma(2n-2)}\\big[\\frac{\\gamma(n-1)}{\\gamma(0)}+ \\frac{\\gamma(n)}{\\gamma(1)}+\\frac{2\\gamma(n-\\frac{1}{2})}{\\gamma(\\frac{1}{2})}\\big]\\quad\\mbox{(using \\cite{hf2})}\\\\ \\qquad \\displaystyle = 2\\cdot \\frac{2^{2(n-2)}(n-2)!}{(2n-3)!}\\big[(n-1)!+2\\cdot \\frac{(2n-3)!!}{2^{n-1}}\\big]\\\\ \\qquad \\displaystyle=\\frac{2^{n-1}(n-1)!}{(2n-3)!!}+2\\\\[2ex ] \\displaystyle   { } _ 2 f_1 \\bigg(\\begin{array}{l } 2n-1,\\ 2 \\\\[-0.5ex ] n\\end{array};\\frac{1}{2}\\bigg)= 2 ^ 2\\cdot { } _ 2 f_1 \\bigg(\\begin{array}{l } 2,\\ 1-n \\\\[-0.5ex ] n\\end{array};-1\\bigg)\\quad\\mbox{(using ( 15.3.4 ) in \\cite[p .",
    "559]{as})}\\\\ \\qquad \\displaystyle= 4\\cdot \\frac{\\gamma(n)}{2^{2(2-n)}\\gamma(2n-1)}\\big(\\frac{\\gamma(n-\\frac{1}{2})}{\\gamma(\\frac{1}{2})}+\\frac{\\gamma(n+\\frac{1}{2})}{\\gamma(\\frac{3}{2})}+2\\gamma(n)\\big ) \\quad\\mbox{(using \\cite{hf2})}\\\\ \\qquad \\displaystyle= \\frac{2^{2n-2}(n-1)!}{(2n-2)!}\\big(\\frac{(2n-3)!!}{2^{n-1}}+\\frac{(2n-1)!!}{2^{n-1}}+2\\cdot ( n-1)!\\big)\\\\ \\qquad \\displaystyle= \\frac{2^{n-1}(n-1)!}{(2n-2)!}({(2n-3)!!}+{(2n-1)!!}+2^n\\cdot ( n-1 ) ! ) \\end{array}\\ ] ] therefore , @xmath223\\\\ \\quad\\displaystyle = 2^{n-2}(n+1)(n-1)!+ ( 2n-1 ) ! !",
    "\\end{array}\\ ] ] and finally @xmath224 as we claimed .          to simplify the notations , set @xmath228 . as we have seen in the proof of lemma [ lem : f ] , @xmath229 and therefore @xmath230 set now @xmath231 since @xmath232 , we have that @xmath233 and @xmath234 @xmath235 \\\\ \\qquad \\displaystyle = -\\frac{(p-1)^2}{2^{p-1}}+\\frac{1}{2^{p-1}(p-1 ) ! } \\sum_{k=0}^{p-2 } \\frac{(p - k-1)^3(p+k-2)!}{2^{k}k ! } \\\\ \\qquad \\displaystyle = -\\frac{(p-1)^2}{2^{p-1}}+\\frac{1}{(2p-2)!!}\\big((4p-1)(2p-3)!!-3(2p-2)!!\\big)\\quad\\mbox{(by lemma \\ref{sum : d } ) } \\\\ \\qquad \\displaystyle = -\\frac{(p-1)^2}{2^{p-1}}+(4p-1)\\frac{(2p-3)!!}{(2p-2)!!}-3   \\end{array}\\ ] ]      summarizing , by lemmas [ lem:9 ] , [ sum : d ] , and [ sum : f ] , we have that @xmath240\\\\ \\qquad \\displaystyle = \\frac{1}{6 } n ( 4 n^2 + 21 n-7)-\\frac{3n(n+3)}{4}\\cdot \\frac{(2n-2)!!}{(2n-3 ) ! ! } \\end{array}\\ ] ] as we claimed ."
  ],
  "abstract_text": [
    "<S> the cophenetic metrics @xmath0 , for @xmath1 , are a recent addition to the kit of available distances for the comparison of phylogenetic trees . based on a fifty years old idea of sokal and rohlf </S>",
    "<S> , these metrics compare phylogenetic trees on a same set of taxa by encoding them by means of their vectors of cophenetic values of pairs of taxa and depths of single taxa , and then computing the @xmath2 norm of the difference of the corresponding vectors . in this paper </S>",
    "<S> we compute the expected value of the square of @xmath3 on the space of fully resolved rooted phylogenetic trees with @xmath4 leaves , under the yule and the uniform probability distributions .    </S>",
    "<S> phylogenetic tree , cophenetic metric , uniform model , yule model , sackin index , total cophenetic index </S>"
  ]
}