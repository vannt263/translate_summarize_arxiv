{
  "article_text": [
    "one of the cornerstones of the copenhagen interpretation of quantum mechanics is the measurement postulate : after a projective measurement , the wave function collapses into an eigenstate of the measured observable . in this framework ,",
    "two subsequent measurements of an observable are not independent , as the first measurement perturbs the state of the system and thereby affects the result of the second @xcite . still , there are quantities in classical physics which are not `` local '' in time and need two ( or more ) observations to be determined . among them",
    "are the charge flowing through and the work done on a system .",
    "in such cases , the extension of classical definitions and protocols to the quantum realm is not straightforward .",
    "recently , the statistics of the work done on a quantum system and , more generally , its energy exchanges have attracted much attention @xcite .",
    "besides a fundamental interest , the thermodynamics of quantum systems has important implications to the energetic performance of quantum devices @xcite and quantum heat engines @xcite .",
    "an established protocol to measure work involves a double _ projective _ measurement of the energy of the system at the beginning and at the end of the evolution .",
    "such a two - measurement protocol ( tmp ) can be described in terms of classical conditional probabilities @xcite .",
    "it has proven successful in formulating quantum fluctuation relations in a setting where the system is initially in a statistical mixture of energy eigenstates . however , has limitations that have so far failed to receive the due attention .",
    "these limitations become apparent when one tries to apply to a more general class of processes , namely , those in which the system is initially in a quantum - coherent superposition of different energy eigenstates .",
    "most quantum gates developed in the context of quantum information and computation @xcite belong to this class .",
    "the problem with is that the initial measurement forces the system into an eigenstate of the initial hamiltonian .",
    "the ultimate result of this operation is to reduce the dynamics to a classical statistical one @xcite and to destroy the interference effects that generate , in feynman s words , the `` interfering alternatives '' in the dynamics @xcite . in this respect ,",
    "fails to answer in a general way the most straightforward and important question @xcite : how much energy is it needed in order to perform a given quantum operation on an arbitrarily prepared quantum system ?    in this , we address the key question we have just posed by proposing a measurement protocol that is meant to preserve the quantum - mechanical nature of the work performed on a quantum system . in this protocol , a quantum detector",
    "is coupled to the system at the beginning and at the end of the evolution .",
    "the information on the energy is stored in a phase shift that can be measured , for example , by interferometric means .",
    "our protocol can be formally derived from a path - integral description of the dynamics by adding a constraint on the admissible paths @xcite .",
    "its predictions coincide with that of for a mixed initial state .",
    "however , as soon as we introduce quantum coherence in the initial state , we find a stark disagreement between the two protocols , even at the level of the first moment of the distribution , that is , the average work .",
    "we discuss the reasons for this disagreement and set the stage for further investigation .",
    "we also discuss how to extend our protocol to measure the dissipated work in driven , open quantum systems , by accessing the degrees of freedom of the system only .",
    "as compared to previous proposals relying on measurements of the environment @xcite , our protocol may provide an experimentally more accessible way to measure the statistics of heat and work in this case .",
    "it is known that the work done on a quantum system can not be associated to a hermitian operator and , therefore , it is not an observable @xcite . in general , the work performed on an open system depends on the full evolution of the system and not only on its initial and final state . as quantum trajectories ( or paths ) play a key role in determining energy exchanges and dissipation , we find it natural to tackle the work measurement problem by using a path integral approach @xcite .",
    "the formalism we describe in this section is an adaptation of that developed by sokolovski in a series of papers @xcite .",
    "we refer to the appendix [ app : path_integral ] and to the original papers for more technical details .",
    "we consider a closed quantum system whose dynamics is generated by a time - dependent hamiltonian @xmath0 .",
    "the drive starts at @xmath1 and ends at @xmath2 .",
    "the corresponding unitary evolution operator can be approximated as @xmath3 where @xmath4 denotes the time - ordering product and in the second writing we have discretized the time in @xmath5 steps of length @xmath6 and used the notation @xmath7 .    the probability amplitude to go from the initial state @xmath8 to a given final state @xmath9",
    "can be decomposed into feynman paths @xcite . differently from the usual approach , in which the dynamics is described in the position - momentum basis",
    ", we exploit the freedom to choose any complete basis at each time to decompose the paths .",
    "if we are interested in the behavior of a time dependent operator @xmath10 , the preferred basis is the one composed of its eigenstates , i.e. , @xmath11 .",
    "the idea behind this choice is that it allows us to associate to @xmath10 a value @xmath12 depending on the path traversed during the evolution . in a more formal way",
    ", we write @xmath13 and @xmath14 for a complete basis set . by inserting the completeness relation for @xmath15 into the expression for the probability amplitude to go from @xmath8 to @xmath9 ,",
    "we obtain ( see [ app : path_integral ] ) @xmath16 where @xmath17 is the path defined by the sequence of states @xmath18 ( see fig .  [ path_figure ] ) and @xmath19 is the probability amplitude to go from @xmath8 to @xmath9 , associated to that path . along the path @xmath17 , the operator @xmath10 takes the set of values @xmath20 .",
    "thus , we can also associate to @xmath17 any functional @xmath21 $ ] of @xmath12 .    at this point",
    ", we add a constraint to the evolution by requiring @xmath21 $ ] to take the value @xmath22 .",
    "the constrained probability amplitude reads",
    "@xmath23 = \\sum _ { { \\mathcal{p } } } \\delta(f [ { \\mathcal{p}}]- f ) \\mathcal{a } _ { { \\mathcal{p}}}$ ] . as in @xcite , we consider functionals of the form @xmath21 =   \\int_0^{\\mathcal{t}}dt \\beta(t ) a(t ) = \\delta t \\sum_{k=0}^n \\beta_k",
    "a_{i_k}^k$ ] , where @xmath24 is an arbitrary function . the dirac delta in the expression for @xmath23 $ ] can be written as a fourier transform in a conjugate space described by the variable @xmath25 , as follows : @xmath26- f ) = \\int d\\lambda \\exp{[i \\lambda ( f [ { \\mathcal{p}}]- f ) ] } $ ] .",
    "notice @xcite that @xmath25 and @xmath22 can be thought of as eigenvalues of conjugate operators @xmath27 and @xmath28 acting on an additional hilbert space , their corresponding eigenstates @xmath29 and @xmath30 satisfying the relation @xmath31 . denoting with @xmath32 and recalling that @xmath33 , we can write ( see appendix [ app : path_integral ] ) @xmath23 = \\int d \\lambda   \\sum _ { { \\mathcal{p } } } { a _ { { \\mathcal{p}}}^{\\lambda f}}$ ] , where @xmath34 is the probability amplitude to go from the state @xmath35 to the state @xmath36 @xcite . the evolution described by @xmath37 is generated by the effective hamiltonian @xmath38 equation plays a central role in our work and it is worth a few comments .",
    "( i ) the additional hilbert space we introduced can be related to a detector in the von neumann measurement scheme @xcite .",
    "therefore , requiring that the functional @xmath39 assumes the value @xmath22 along the evolution is equivalent to introducing a detector and coupling it to the observable we wish to measure . here",
    ", @xmath27 and @xmath40 act as the momentum and position operator of the detector , respectively .",
    "( ii ) the interaction described by does not induce any transition between the eigenstates @xmath29 of the detector momentum .",
    "( iii ) the information about the system - detector interaction  and hence about the value taken by the functional @xmath39  is encoded in the phase accumulated between the eigenstates @xmath29 and @xmath41 .",
    "( in this case an eigenstate fo the initial hamiltonian ) to the generic final state @xmath42 , described in terms of paths in energy space .",
    "the time - dependent energy spectrum @xmath43 of the system hamiltonian is plotted in black .",
    "quantum trajectories ( blue , red ) consists of a sequence of jumps between different eigenstates .",
    "the red trajectory satisfies the constraint ( in this case @xmath44 ) while the blue ones do not . ]    observation ( iii ) suggests that the statistics of the integrated observable @xmath10 can be determined by measuring the phase of the detector , as done in the full - counting - statistics approach ( fcs ) @xcite .",
    "let the composite system be initially described by the factorized density operator @xmath45 , where @xmath46 and @xmath47 are the density operators of the system and the detector , respectively .",
    "then the phase difference acquired between the eigenstates @xmath48 and @xmath49 of the detector reads @xmath50    \\label{eq : cgf}\\ ] ] where @xmath51}$ ] is the evolution operator generated by ( [ eq : h_von_neumann ] ) .",
    "the function @xmath52 plays the role of a moment generating function , as the @xmath53-th moment of @xmath54 is given by @xmath55 @xcite .",
    "we now have the instruments to determine the variation of the internal energy of a driven closed system . starting from eq .",
    "( [ eq : h_von_neumann ] ) , we take @xmath56 and @xmath57 @xcite .",
    "this corresponds to coupling the detector and the system only at the beginning and at the end of the drive .",
    "( more precisely , we couple the system and the detector at time @xmath58 and at time @xmath59 , i.e. , immediately before and after the starting and ending drive . ) the resulting @xmath52 is given by eq .",
    "( [ eq : cgf ] ) , with the evolution operator ( see appendix [ app : path_integral ] ) @xmath60 the so - obtained @xmath52 is a measurable quantity and can be used to determine all moments of the internal - energy variation @xmath61 in the system .",
    "however , the interpretation of this result presents some subtleties , which we are now going to discuss .",
    "it is known from previous work @xcite that , in general , the fourier transform of the @xmath52 in eq .",
    "( [ eq : cgf ] ) can not be associated to a probability distribution .",
    "a similar problem is encountered when defining the fcs of electron transfer across a superconducting device @xcite .",
    "if a probability distribution can not be defined for the variation of the internal energy , the question then arises what is the meaning of the moments generated by @xmath52 . to clarify this point ,",
    "let us first analyze the first moment , which for a closed system corresponds to the average work performed on the system .",
    "a physical expectation for the result can be developed by considering the following _",
    "gedankenexperiment_. we repeatedly prepare the system in the same initial state @xmath62 .",
    "half of times we just measure @xmath63 and determine its average @xmath64 .",
    "the remaining times we first apply the desired evolution to arrive at @xmath65 and then measure @xmath66 to determine @xmath67 . according to this procedure",
    ", we estimate variation of the internal energy as @xmath68 .",
    "this result is the same as obtained from eq .",
    "( [ eq : cgf ] ) ; by contrast , it can not be reproduced by . to pinpoint the differences between the two methods ,",
    "let us explicitly write @xmath61 as obtained from eq .",
    "( [ eq : cgf ] ) : @xmath69 where @xmath70 , @xmath71 , @xmath72 , @xmath73 , and @xmath74 and @xmath75 are the eigenstates of the hamiltonian at the beginning and at the end of the evolution , respectively .",
    "the first term in is the same as in @xcite and can be straightforwardly interpreted in terms of classical conditional probabilities .",
    "on the contrary , the remaining terms , which depend on the initial coherences @xmath76 , are of a purely quantum nature .",
    "these terms are destroyed by the initial measurement of @xmath63 performed in tmp .",
    "the fact that the interfering terms can have important effect in the statistics of the work was first pointed out in ref .",
    "@xcite .",
    "the situation is well exemplified by the cyclic evolution of a coherent superposition of energy eigenstates into itself . as both the initial and final state and the initial and final hamiltonians are the same",
    ", we would naturally expect @xmath44 .",
    "however , this needs not be the case in , as the individual energy eigenstates after the first measurement can evolve into different states with different energies . as specific example we consider the case of two level system driven by a periodic hamiltonian so that @xmath77 .",
    "we initialize the system in a state @xmath8 that , a part from a phase factor , in left unchanged by the evolution generated by @xmath66 , i.e. , @xmath78 .",
    "the existence of such a state is guaranteed , for instance , by floquet theorem @xcite . clearly , the internal energy of the system does not change and , therefore , @xmath79",
    "this is correctly predicted by the first moment calculated from @xmath52 .",
    "but , in general , @xmath80 needs not be an eigenstate of @xmath81 .",
    "we consider the case in which @xmath82 where @xmath83 ( @xmath84 ) are eigenstate of the initial ( and final ) hamiltonian .",
    "if we take @xmath85 to be a free parameter , then the requirement of cyclic evolution for @xmath80 forces the evolution operator to take the form in the @xmath86 @xmath87 with the tmp , after the first measurement , the system is found in @xmath88 with probability @xmath89 and in @xmath90 with probability @xmath91 .",
    "these two states now evolve independently as the `` interfering alternatives '' have been destroyed by the projective measurement .",
    "the final result for the work distribution can be computed in terms of classical conditional probabilities @xmath92 for the system to make a transition between states @xmath93 and @xmath94 . in particular , for the average change in the internal energy , one finds @xmath95 where @xmath96 .",
    "we have thus found that @xmath61 is generally nonzero , except in the cases @xmath97 ( trivial evolution ) , @xmath98 ( the initial state is an energy eigenstate ) , and @xmath99 ( equal superposition of the two eigenstates ) .",
    "the interpretation of higher - order moments is not trivial and stands as an open question in the field @xcite .",
    "as already mentioned , it is known from the fcs @xcite that the fourier transform of @xmath52 is a quasi - probability which can assume negative values .",
    "a probability distribution can be retrieved in some cases after partial integration of the relevant wigner function @xcite .",
    "ultimately , these complications are rooted in the full quantum treatment of the detector @xcite .",
    "indeed , different types of measurements performed at the end of the evolution yield different distributions for the same quantity , each of which must be interpreted accordingly .",
    "the measurement of the phase of the detector has the advantage that , since @xmath27 is a constant of motion , preserves the `` quantumness '' of the evolution and leads to eq .  .",
    "it is our belief that the quantum correlations stemming from eq .",
    "should not be ignored ; instead , they deserve further exploration . for instance , the negativity in the quasi - probability distribution of work can be thought of as due to nonclassical temporal correlations of the energy , leading to the violation of a leggett - garg - type inequality @xcite .",
    "further progress in this direction will hopefully appear in future work .",
    "we now turn our attention to the more general case in which the system is coupled to an environment during the drive . in order to determine the work performed on the system , we need to complement the measurement of the internal energy discussed above with one of the dissipated heat . to this end ,",
    "different approaches have been proposed , including the measurement of an engineered environment @xcite . yet measuring the environment is a challenging task , restricting the applicability of these proposal to specific physical realizations . in the following ,",
    "we describe an extension of our measurement protocol that allows one to obtain the statistics of the work and dissipated heat by accessing only the system degrees of freedom .",
    "we describe the open system by the hamiltonian @xmath100 where @xmath101 and @xmath102 are the environment and system - environment coupling hamiltonians , respectively , and assume weak coupling between the system and environment .",
    "we first take both @xmath103 and @xmath104 to be time independent and consider a measurement of @xmath104",
    ". then ( [ eq : u_t ] ) simplifies into @xmath105 .",
    "as @xmath103 and @xmath104 are constant , no external work is done on the system and the variation of internal energy must correspond to the dissipated heat .",
    "we can also show ( see appendix [ app : syst_vs_env_meas ] ) that the statistics obtained from the above equation is the same as the one obtained by measuring the environment degrees of freedom @xcite .",
    "we conclude that for an open system with constant hamiltonian , the scheme gives the statistics of the dissipated heat @xmath106 ( appendix [ app : syst_vs_env_meas ] ) .    for a time - dependent @xmath0 ,",
    "we discretize the evolution in @xmath107 time intervals @xmath6 , denote @xmath108 with @xmath109 . within each time interval @xmath6 ,",
    "the hamiltonian is constant . at the beginning and at the end of each interval",
    ", we instantaneously couple our detector to @xmath110 . in analogy with",
    ", the evolution operator for each interval reads @xmath111 each @xmath112 is defined so that we keep track of the heat @xmath113 dissipated in the time interval @xmath114 . as a result , the information on the dissipated heat along the evolution is stored in the phase of the detector .",
    "notice the opposite sign in the exponents with respect to eq .",
    "( [ eq : h_von_neumann ] ) takes into account the fact that an emission ( absorption ) by the environment , i.e. , decreasing ( increasing ) of the environment energy , corresponds to an absorption ( emission ) process of the system , i.e. , increasing ( decreasing ) of the system energy .    in order to account for the variation of the internal energy as well",
    ", we must add a measurement of @xmath115 at the beginning and end of the evolution ( appendix [ app : first_moment ] ) .",
    "putting things together , the total evolution operator reads @xmath116 a pictorial representation of the scheme described by is presented in fig .",
    "[ meas_figure ] . in the case of unitary evolution , @xmath117 and",
    "we immediately recover the closed - system result for the variation of the internal energy .",
    "the moment generating function is the same as in ( [ eq : cgf ] ) with @xmath118 given by ( [ eq : u_full_work ] ) .    ) .",
    "the evolution steps @xmath119 are represented by the flat line and characterized by the hamiltonian @xmath120 .",
    "each coupling with the detector is represented by a dot .",
    "the coupling is either of the form @xmath121 ( red dots ) , or @xmath122 ( blue dots ) . in the blue - shadowed region ,",
    "the evolution is frozen ( @xmath123 ) and the hamiltonian changes by @xmath124 . in the red - shadowed region ,",
    "the hamiltonian is constant ( @xmath125 ) while the density operator changes by @xmath126 . ]",
    "let us calculate its first moment , which gives the average work @xmath127 .",
    "we find ( appendix [ app : first_moment ] ) @xmath128 ,      \\label{eq : w_meas}\\ ] ] where @xmath129 . in the first two terms we recognize the variation of the internal energy of the system : @xmath130 $ ] . accordingly",
    ", we identify the remaining term with the dissipated heat : @xmath131 $ ] .",
    "notice that while @xmath61 depends only on the initial and final state of the system , @xmath106 is determined by the full dissipative evolution as in the classical counterpart ( appendix [ app : first_moment ] ) .    in the fast - decoherence limit , the dissipated heat takes an illuminating form .",
    "when energy - relaxation processes are much faster than the dynamics induced by the drive , we always find the system in its instantaneous thermal equilibrium state @xmath132}/z_s(t)$ ] where @xmath133 is the partition function of the system and @xmath134 is the temperature of the environment .",
    "in other words , the system evolves through states of quasi - equilibrium . defining the von neumann entropy as @xmath135 $ ] , we can show ( see appendix [ app : entropy ] ) that the variation of the density operator is related to it by @xmath136   = k_b t   \\delta s_k$ ] where @xmath137 is the variation of entropy at time @xmath138 .",
    "then we can link the variation of entropy to the dissipated heat by the relation @xmath139 , confirming the above interpretation of @xmath106 as the dissipated heat .",
    "there is an alternative way to interpret eq .",
    "( [ eq : w_meas ] ) . taking the time derivative of the average internal energy",
    ", we have @xmath140 @xcite .",
    "if the evolution is unitary , the second contribution vanishes and we can relate the variation of the system hamiltonian to the instantaneous work done on the system . by expanding the product in , we identify pairs of sequential system - detector interactions of the form @xmath141 .",
    "each such pair effectively keeps track of a variation in the hamiltonian .",
    "as the variation is instantaneous , the system has no dynamics .",
    "we can interpret the action of the pairs as a `` measurement '' of the work done on the system by an external force .",
    "this interpretation is strengthened by the analysis of eq .",
    "( [ eq : w_meas ] ) . by regrouping the terms ,",
    "we can write it as @xmath142 $ ] where @xmath143 .",
    "one may wonder whether the repeated coupling to the detector can freeze the dynamics of the system ( dynamic zeno effect ) .",
    "this turns out not to be the case : a dynamic zeno effect would require @xmath144 , while we derive our physical quantities , i.e. , the moments of the work done , in the opposite limit @xmath145 .",
    "our protocol can instead be regarded as a noninvasive measurement @xcite of the work distribution .",
    "in fact , the moments generated by @xmath146 depend on evolution operators that describe the dynamics of the open system without a detector .",
    "in summary , we have shown that the statistics of work performed on a quantum system exhibits nonclassical correlations in a deeper and more fundamental way that it had so far been appreciated .",
    "such correlations become apparent once one replaces the customary double projective measurement with a less - invasive coupling to a quantum detector .",
    "the resulting protocol is immediately applicable to the case of unitary evolution and can be suitably extended to treat open quantum systems .",
    "our approach puts the problem of work under a new perspective and leads the way toward further investigations .",
    "in particular , the links between quantum - mechanical work , leggett - garg - type inequalities @xcite , weak measurements @xcite , and stochastic quantum trajectories @xcite , await to be fully elucidated .",
    "an experimental test of our predictions is in reach of state - of - the art quantum technology . among different architectures ,",
    "superconducting quantum circuits in combination with nearly - quantum - limited parametric amplifiers are a first choice , given the high degree on control achieved in recent experiments @xcite .",
    "we gratefully acknowledge a. braggio and m. carrega for fruitful discussions .",
    "has received funding from the european union fp7/2007 - 2013 under rea grant agreement no 630925  coheat and from miur - firb2013  project coca ( grant no .",
    "rbfr1379ux ) .",
    "s.g . acknowledges financial support from the swiss national science foundation ( snf ) project 150046 .",
    "we consider a closed quantum system whose dynamics is generated by a time - dependent hamiltonian @xmath0 .",
    "the drive starts at @xmath1 and ends at @xmath2 .",
    "the corresponding unitary evolution operator is @xmath147 where @xmath4 denotes the time - ordering product and in the second writing we have discretized the time in @xmath5 steps of length @xmath6 and used the notation @xmath7 .",
    "our goal is to write the probability amplitude to go from @xmath8 to @xmath9 in terms of feynman paths @xcite .",
    "equation ( [ eq_app : u_dyn ] ) is approximated to the order @xmath148 and it is a convenient way to describe the evolution in terms of path integral . as a final step , we will take the limit @xmath149 to recover the usual continuous description of the evolution .",
    "_ at any time _ @xmath138 we can find a basis @xmath14 such that the completeness relation @xmath150 holds . in this notation , @xmath151 is a _ time _ index and @xmath152 denotes the eigenstate basis index at time @xmath138 . by inserting the completeness relation for @xmath15 into the expression for the probability amplitude",
    "we obtain @xmath153 the term @xmath154 is the probability amplitude to go from @xmath155 to @xmath15 .",
    "then , @xmath156 is the probability amplitude to go from @xmath8 to @xmath9 passing through the sequence of states : @xmath157 .",
    "this sequence define a _",
    "path _ @xmath17 in the basis space @xmath158 .",
    "we interpret ( [ eq : path_int_prob_ampl ] ) as the sum over all the possible _ paths _ of the probability amplitudes : @xmath159 in the limit @xmath149 , we obtain a continuous path @xmath12 . in this way , we can associate to the path @xmath17 a physical quantity @xmath21 $ ] depending on it .",
    "mathematically , @xmath39 is then a functional of @xmath17 .",
    "we now add a constraint and select only the paths that satisfy some properties .",
    "we are asking which is the probability amplitude @xmath23 $ ] to go from @xmath8 to @xmath9 though a path @xmath17 determined by @xmath12 for which the functional @xmath21 $ ] assumes the values @xmath22 .",
    "the constrained probability amplitude reads @xmath160 = \\sum _ { { \\mathcal{p } } } \\delta(f [ { \\mathcal{p}}]- f ) \\mathcal{a } _ { { \\mathcal{p}}}\\end{aligned}\\ ] ] where the delta function restricts the admissible paths to those for which @xmath21 = f$ ] .",
    "@xmath21 $ ] could a generic functional of @xmath17 .",
    "however , as in ref .",
    "@xcite , we assume that the functional depends on the integral of the path @xmath12 ( or @xmath161 in the discretized expression ) @xmath162 =   \\int_0^{\\mathcal{t}}dt \\beta(t ) a(t ) =   \\delta t \\sum_{k=0}^n \\beta_k a_{i_k}^k\\ ] ] where @xmath24 is an arbitrary function .    by writing the dirac delta in terms of fourier transform @xmath26- f ) = \\int d \\lambda~\\exp{[- i \\lambda   ( f- f [ { \\mathcal{p}}])]}$ ] inserting it in the path integral representation , and splitting the term @xmath21 $ ] with respect to the corresponding time interval , we obtain @xmath160 & = & \\int d \\lambda~e^{-i \\lambda   f } \\sum _ { { \\mathcal{p } } }     { { \\mathinner{\\langle{\\psi_{\\mathcal{t}}}| { e^{-i \\delta t   { \\hat{h}}_s^n } e^{i \\delta t   \\lambda   \\beta_n a_{i_n}^n } } | { a_{i_n}^n}\\rangle } } } ... \\nonumber \\\\    & & { { \\mathinner{\\langle{a_{i_1}^1}| { e^{-i \\delta t   { \\hat{h}}_s^{0 } } e^{i \\delta t   \\lambda   \\beta_{0 } a_{i_0}^0 } } | { a_{i_0}^0}\\rangle } } }   \\braket{a_{i_0}^0|\\psi_0}.\\end{aligned}\\ ] ] we must choose the time - dependent basis set @xmath158 considering the observable @xmath10 we are interested in .",
    "in particular , we must take them in order that @xmath163 . for small @xmath6 @xcite ,",
    "we can write @xmath160       & \\approx & \\int d \\lambda~e^{-i \\lambda   f } \\sum _ { { \\mathcal{p } } }     { { \\mathinner{\\langle{\\psi_{\\mathcal{t}}}| { e^{-i \\delta t   ( { \\hat{h}}_s^n - \\lambda   \\beta_n { \\hat{a}}_n ) } } | { a_{i_n}^n}\\rangle } } } ... \\nonumber \\\\     & & { { \\mathinner{\\langle{a_{i_1}^1}| { e^{-i \\delta t   ( { \\hat{h}}_s^{0 } - \\lambda   \\beta_{0 } { \\hat{a}}_{0 } ) } } | { a_{i_0}^0}\\rangle } } }   \\braket{a_{i_0}^0|\\psi_0 } \\nonumber \\\\    & = & \\int d \\lambda ~e^{-i \\lambda   f } \\sum _ { { \\mathcal{p } } } \\mathcal{a } _ { \\mathcal{p}}^{\\lambda } .",
    "\\label{app : eq_a_f } \\end{aligned}\\ ] ] therefore , the constrained amplitude probability @xmath164 $ ] can be written as the sum of the path amplitudes @xmath165 , which are generated by the effective hamiltonian @xmath166 . by defining the corresponding unitary operator as @xmath167 } ,",
    "\\label{app : eq_u_lambda}\\ ] ] we have @xmath168 } \\mathcal{a } _",
    "{ \\mathcal{p}}=   \\sum _ { { \\mathcal{p } } } \\mathcal{a } _ { \\mathcal{p}}^{\\lambda } =    { { \\mathinner{\\langle{\\psi_{\\mathcal{t}}}| { u_{\\lambda } ( t ) } | { \\psi_0}\\rangle } } } .",
    "\\label{eq : a_p_relation}\\ ] ]    we can go further with the interpretation of the constraint . the parameter @xmath25 and @xmath22 can be thought of as eigenvalues of conjugate operators @xmath27 and @xmath28 satisfying the relation @xmath31 . using the relation @xmath169 , we can write @xmath160    & = &    \\int d \\lambda \\sum _ { { \\mathcal{p } } }      { { \\mathinner{\\langle{\\psi_{\\mathcal{t } } , \\lambda } | { e^{-i \\delta t   ( { \\hat{h}}^n - { \\hat{\\lambda}}\\beta_n { \\hat{a}}_n ) } } | { a_{i_n}^n}\\rangle } } } ...",
    "\\nonumber \\\\ & & { { \\mathinner{\\langle{a_{i_1}^1}| { e^{-i \\delta t   ( { \\hat{h}}^{0 } - { \\hat{\\lambda}}\\beta_{0 } { \\hat{a}}_{0 } ) } } | { a_{i_0}^0}\\rangle } } }   \\braket{a_{i_0}^0|\\psi_0 , f }   \\label{app : eq_af}\\end{aligned}\\ ] ] based on eq .",
    "( [ app : eq_af ] ) , we can interpret @xmath23 $ ] is the probability amplitude to go from the state @xmath170 to the state @xmath36 , where @xmath27 and @xmath40 are conjugate operator acting on an additional hilbert space .",
    "the latter is interpreted as _ the hilbert space of the detector needed to measure the special observable _ @xcite .",
    "the effective hamiltonian describing the system and a quantum detector dynamics is @xmath171 the approach outlined above applies to any time - dependent observable @xmath10 . in this work",
    "we take @xmath10 to be the time - dependent hamiltonian .",
    "the power operator considered in ref .",
    "@xcite would be another meaningful choice .    to determine the variation of the internal energy , we take @xmath56 and @xmath172 .",
    "when using a discretized evolution , we assume that @xmath173 for @xmath174 and @xmath175 elsewhere . from eqs .",
    "( [ app : eq_u_lambda ] ) we have , in the limit of @xmath149 @xcite @xmath176 therefore , the total unitary evolution corresponds to two fast couplings with the detector with an central driven evolution of the system . from this",
    "we immediately arrive to the moment generating function @xmath52 discussed in the main text .",
    "in the main text we have discussed how to measure the dissipated heat statistics though the system degrees of freedom . here",
    "we show that this statistics is the same as we would obtain by measuring directly the environment @xcite .",
    "we make the standard assumption that the system and the environment are weakly coupled .",
    "this allows us to neglect the energy related to system - environment coupling hamiltonian .",
    "we consider @xmath104 to be time - independent as in the fundamental interaction block discussed in the main text .",
    "the total hamiltonian reads @xmath177 .",
    "if we measure the degrees of freedom of the environment , we obtain a @xmath178 that has the form of @xmath52 with @xmath179 @xcite .    in the weak coupling limit , @xmath180 } \\approx \\exp { [ i \\lambda   ( { \\hat{h}}- { \\hat{h}}_s)/2]}$ ] and @xmath181 \\approx 0 $ ] .",
    "therefore , @xmath182 from eq .",
    "( [ app : eq_u_lambda ] ) it follows that @xmath183 and the statistics generated by measuring @xmath101 is equal to the one obtained by measuring @xmath104 with opposite sign .",
    "the opposite sign in the exponents with respect to eq . ( [ app : eq_u_lambda ] ) takes into account the fact that an emission ( absorption ) by the environment , i.e. , decreasing ( increasing ) of the environment energy , corresponds to an absorption ( emission ) process of the system , i.e. , increasing ( decreasing ) of the system energy .",
    "we first restrict our attention to the dissipated heat and calculate the first moment of the moment generating function @xmath52 @xmath184 \\big|_{\\lambda=0 }      \\label{eq : first_moment}\\ ] ] where @xmath185 , @xmath186 , and we follow the convention that the heat flowing into the system is given a positive sign @xcite .    the first term in eq",
    ".   reads @xmath187 \\ .",
    "\\label{eq : app_du}\\end{aligned}\\ ] ] where we used the compact notation @xmath109 . in an analogous way",
    ", the second term reads @xmath188\\ .\\end{aligned}\\ ] ] putting everything together in eq .",
    "( [ eq : first_moment ] ) and using the cyclic property of the trace , it is possible to simplify some of the evolution operators @xmath189 . after defining @xmath190 and @xmath191 , we have @xmath192 .",
    "\\label{eq : app_q1}\\ ] ] the trace over the system and environment can be separated by observing that @xmath193 = { { \\rm tr}}_{s } \\big [ { \\hat{h}}_s^{n } { { \\rm tr}}_{e } \\big(\\rho_{n}- \\rho_{n-1}\\big ) \\big ] = { { \\rm tr}}_{s } \\big [ { \\hat{h}}_s^{n } ( \\rho_{s , n}- \\rho_{s , n-1 } ) \\big]$ ] . therefore , the dissipated heat written in terms of the system degrees of freedom reads @xmath194",
    "= \\sigma_{k } { { \\rm tr}}_{s } \\big [   h_s^{k } \\delta \\rho_{s , k } \\big ] =   \\sigma_{k } q_k      \\label{eq : q_meas}\\ ] ] where @xmath195 is the dissipated heat in the time interval @xmath196 .",
    "let us now introduce a coupling between the system and the detector at the beginning and at the end of the evolution .",
    "the unitary operator then reads @xmath197 accordingly , the calculation in eq .",
    "( [ eq : app_du ] ) is modified as @xmath198 which differs from eq .",
    "( [ eq : app_du ] ) by the addition of the term @xmath199 .",
    "we find that the average work @xmath200 is @xmath201      \\label{eq : app_w_meas}\\ ] ] which differs from eq .",
    "( [ eq : q_meas ] ) by the variation of the internal energy @xmath202 $ ] .",
    "therefore , we have obtained the usual result @xmath203 @xcite .",
    "the heat contributions @xmath113 in are related to the variation of the system density operator @xmath204 during infinitesimal evolutions generated by constant hamiltonians .",
    "we can check that if the evolution is unitary , i.e. , @xmath205 , then the @xmath113 vanish and no heat is dissipated .",
    "in fact , we have @xmath206 , @xmath207=0 $ ] , and @xmath208 \\nonumber \\\\    & = & { { \\rm tr}}_{s } \\big [ u_k h_s^{k } \\rho_{s , k-1 } u_k^\\dagger - h_s^{k } \\rho_{s , k-1 }   \\big ] = 0 \\ .\\end{aligned}\\ ] ]    the interpretation of the @xmath113 as the dissipative contribution to the dynamics is strengthened by the following observation .",
    "the dissipated heat depends on the variation of the density operator @xmath209 , which , in turn , can be due to both unitary and non - unitary dynamics . however , the unitary contribution to the change of @xmath210 , i.e. , the one given by @xmath211 $ ] , vanishes identically when we calculate @xmath212 .",
    "thus , the @xmath113 are related solely to the dissipative dynamics .",
    "this result is analogous to the one obtained in ref .",
    "@xcite .",
    "the expressions for @xmath106 and @xmath213 can be written in another meaningful way as follows .",
    "instead of grouping @xmath204 , we can keep the terms @xmath214 as written in eq .",
    "( [ eq : app_du ] ) . then the dissipated heat in eq .",
    "( [ eq : app_q1 ] ) reads @xmath215.\\ ] ] as the contributions of the initial and final measurements are the same , we have that @xmath216.\\ ] ] this confirms the interpretation discussed in the main text that the work can be seen as the instantaneous energy injected in the system due to the variation of the hamiltonian in time .",
    "the von neumann entropy in a quantum system is defined as @xmath135 $ ] . writing it in the basis @xmath217",
    "in which @xmath218 is diagonal , we obtain @xmath219 .",
    "if we take the time derivative of the entropy , we have @xmath220 where the last equation comes from the fact that @xmath221 due to trace conservation .",
    "if the decoherence time is smaller than all the system time - scale , the system is always in the ( time - dependent ) thermalized state . under this hypothesis",
    "the above equation should be rewritten explicitly with the time - dependence @xmath222}/z_s(t)$ ] where @xmath223 is the inverse temperature of the environment and @xmath133 is the partition function .",
    "in addition , we have @xmath224 = -{\\hat{h}}_s(t ) - \\log [ z_s(t)]$ ] . again",
    ", this must be intended in terms of component in the basis in which @xmath218 and @xmath104 are diagonal .",
    "if @xmath225 is the energy of the state @xmath226 , we have @xmath227 and @xmath228 $ ] . with eq .",
    "( [ eq : ds ] ) , we can write @xmath229 =    \\frac{1}{k_b t }   \\sum_i    \\dot{\\rho}_{s , ii } \\epsilon_i .\\ ] ]    keeping in mind that @xmath230 , we have that @xmath231   = { { \\rm tr}}[\\frac{d\\rho_s}{dt } h_s ] $ ] and we can rewrite the above equation as @xmath232= t \\frac{ds}{dt}.     \\label{eq : entropy_mapping}\\ ] ] the variation of the entropy can be related , as in the classical case , to the dissipated heat . with this identification",
    "we find @xmath233   = k_b t   \\delta s_k$ ] ."
  ],
  "abstract_text": [
    "<S> we propose a novel approach to define and measure the statistics of work , internal energy and dissipated heat in a driven quantum system . in our framework </S>",
    "<S> the presence of a physical detector arises naturally and work and its statistics can be investigated in the most general case . in particular , we show that the quantum coherence of the initial state can lead to measurable effects on the moments of the work done on the system . at the same time , we recover the known results if the initial state is a statistical mixture of energy eigenstates . our method can also be applied to measure the dissipated heat in an open quantum system . by sequentially coupling the system to a detector </S>",
    "<S> , we can track the energy dissipated in the environment while accessing only the system degrees of freedom . </S>"
  ]
}