{
  "article_text": [
    "the study of weighted inequalities for classical operators such as the hardy - littlewood maximal function and the hilbert transform has been an active area of research in harmonic analysis since the seminal paper of muckenhoupt , @xcite . here , by weighted inequalities",
    "we mean the study of the boundedness properties of an operator @xmath15 on some weighted lebesgue space @xmath16 , where @xmath17 is an appropriate non - negative , locally integrable function , that is , a _",
    "weight_. indeed , the weights @xmath17 for which the hardy - littlewood maximal function , the hilbert transform , as well as more general caldern - zygmund operators are bounded on @xmath16 were identified in @xcite as well as in the subsequent works @xcite ; these investigations led to the definition of the @xmath18 classes of weights ; see definition  [ d.ap ] .",
    "the first quantitative estimate of the operator norm @xmath19 on the _ @xmath18-constant of the weight _ was proved in @xcite for the hardy - littlewood maximal function @xmath20 . in recent years",
    ", the corresponding question concerning the sharp dependence of the norm of a caldern - zygmund operator @xmath21 on the @xmath18-constant of the weight has spurred an overwhelming amount of activity and development of relevant tools .",
    "important representatives of these results include ( but are not exhausted to ) the work of petermichl in @xcite , where the sharp bound for the hilbert transform is proved , as well as the resolution of the celebrated @xmath22 conjecture by hytnen in @xcite where the sharp bound is exhibited for general caldern - zygmund operators .",
    "subsequent important developments and simplifications of the proof of the @xmath22 theorem can be found in @xcite and @xcite .",
    "the two - weight problem for the hilbert transform was also a notoriously hard problem , asking for necessary and sufficient conditions on a pair of weights @xmath23 so that the hilbert transform is bounded from @xmath16 to @xmath24 .",
    "the two - weight inequalities have been intensively investigated in several papers which led to the very recent resolution by lacey in @xcite , following previous results by lacey , sawyer , shen and uriarte - tuero in @xcite .",
    "all the results mentioned so far concern the classical or one - parameter theory , where the operators under study commute with one - parameter dilations of @xmath25 . on the other hand , the most basic example of",
    "the multi - parameter theory is the strong maximal function @xmath26 , namely the maximal average of a function with respect to @xmath27-dimensional rectangles with sides parallel to the coordinate axes .",
    "this operator is in many senses the prototype for multi - parameter analysis while there are also natural multi - parameter versions of the hilbert transform as well as of more general singular integral operators .",
    "see for example @xcite . as the terminology suggests ,",
    "these operators commute with @xmath27-parameter dilations of @xmath25 . a general introduction to multi - parameter harmonic analysis",
    "is contained in @xcite .",
    "the basic weighted theory for the strong maximal function is also pretty well developed in a series of important papers such as @xcite , @xcite , @xcite , @xcite and @xcite . a natural starting point for",
    "a more quantitative multi - parameter weighted theory would be the analogue of buckley s theorem for the strong maximal function , namely , a sharp estimate on @xmath28 in terms of the ( strong ) @xmath18-constant of the weight .",
    "no such quantitative estimate is currently known , a serious obstruction in carrying over the already described achievements of classical weighted theory to the multi - parameter setting .",
    "a possible reason why such a sharp weighted theorem is elusive in the multi - parameter world is the failure of the besicovitch covering argument for rectangles with arbitrary eccentricities .",
    "indeed , it is an essential fact , underlying many of the sharp quantitative estimates in the classical weighted theory , that the ( centered ) hardy - littlewood maximal operator , defined with respect to a general measure , is _ always _ bounded independently of the measure .",
    "this fails quite dramatically for the strong maximal function and this is just another manifestation of the failure of the besicovitch covering argument .",
    "see @xcite .",
    "the relevance of this fact to proving bounds on the operator norms @xmath29 is revealed by abstract theorems characterizing two - weight norm inequalities in terms of the boundedness of corresponding weighted maximal operators .",
    "for example it is implicit in sawyer s two - weight norm inequalities for the hardy - littlewood maximal function in @xcite and for the strong maximal function in @xcite .",
    "see also @xcite and @xcite .      for the weighted strong maximal function @xmath30 one",
    "thus requires some restriction on the weight @xmath17 so that @xmath30 is bounded on @xmath16 . a sufficient condition is provided by the result of fefferman , @xcite , that states that if a weight @xmath31 , that is if @xmath17 is a strong muckenhoupt weight , then @xmath32 is bounded on @xmath16 .",
    "see  [ s.overview ] for precise definitions .",
    "it is thus no big surprise that many results in multi - parameter weighted theory begin with the assumption that @xmath33 .",
    "this assumption has also been used in order to derive the fefferman - stein inequality for the strong maximal function in @xcite , @xcite , @xcite and @xcite .",
    "an apparently weaker substitute for the hypothesis @xmath33 , usually referred to as condition @xmath34 , is that @xmath17 satisfies a _",
    "tauberian condition _ of the form @xmath35 where @xmath36 is any measurable set .",
    "this condition was introduced in @xcite in the context of weighted inequalities for quite general maximal functions .",
    "a consequence of our main theorem is however that is equivalent to @xmath33 .",
    "the previous discussion also motivates the seeking of conditions on a measure @xmath2 such that the strong maximal function @xmath37 , defined with respect to the measure @xmath2 , is bounded on @xmath38 . with more general results and precise definitions to follow ,",
    "one of our main theorems implies :    [ t.main ] let @xmath2 be a borel non - negative measure which is locally finite and doubling with respect to rectangles with sides parallel to the coordinate axes .",
    "then the operator @xmath37 satisfies @xmath39 for every measurable set @xmath13 if and only if @xmath37 is bounded on @xmath38 for some @xmath40 .",
    "this theorem can be thought of as a testing condition on the operator @xmath37 . as it will become apparent ,",
    "the constant @xmath41 is not important as it can be replaced by any fixed level @xmath42 in the statement of the theorem .      a dual point of view and motivation for the investigations in this paper",
    "can be given in the language of differentiation theory .",
    "given a collection of convex sets in @xmath25 which is invariant under dilations and translations we want to study when the corresponding maximal operator differentiates @xmath43 .",
    "it turns out that boundedness properties of quite general maximal operators can also be characterized in terms of tauberian conditions in the spirit of .",
    "indeed , it is a classical result of busemann and feller , @xcite , that a homothecy invariant basis @xmath44 consisting of open sets differentiates @xmath43 if and only if the corresponding maximal operator @xmath45 satisfies a tauberian condition @xmath46 for _ every _ @xmath47 and for every measurable set @xmath13 .",
    "see theorem  [ t.bf ] for the details .",
    "this point of view is discussed in detail in @xcite and taken up in @xcite . in the last work it is shown that a homothecy invariant basis consisting of convex sets differentiates @xmath43 ( with respect to the lebesgue measure ) if and only if it differentiates @xmath48 for some sufficiently large @xmath40 .",
    "note here that , lacking the convexity hypothesis on the basis one needs tauberian conditions at all levels @xmath49 .",
    "this should be contrasted to the results in @xcite as well as in the current paper where the convexity assumption allows us to only assume a tauberian condition at a _ fixed level _ , say @xmath50 .",
    "it is a natural question whether such results persist under the presence of a weight , or somewhat more generally , a measure @xmath2 .",
    "more precisely , one seeks conditions on the measure @xmath2 and the basis @xmath44 so that the @xmath2-averages of a function @xmath51 converge to @xmath52 @xmath2-almost everywhere . if @xmath44 is some abstract basis of convex sets it is in general hard to tell whether @xmath44 differentiates functions in @xmath38 with respect to @xmath2 , for some @xmath40 .",
    "for the basis of rectangles with sides parallel to the coordinate axes this is just a rephrasing of the question : `` when is the strong maximal function @xmath37 , defined with respect to a measure @xmath2 , bounded on @xmath38 for some @xmath40 ? ''",
    "however our results address the more general case of homothecy invariant bases consisting of convex sets .",
    "our most general theorem has the following form :    let @xmath44 be a homothecy invariant basis consisting of open convex sets and assume that @xmath53 are locally finite , non - negative borel measures on @xmath25 .",
    "assume further that the measure @xmath2 is doubling with respect to @xmath44 .",
    "let @xmath54 denote the maximal operator with respect to the basis @xmath44 and the measure @xmath2",
    ". then @xmath54 satisfies @xmath55 if and only if @xmath54 is bounded on @xmath56 for some @xmath40 .    among other consequences ,",
    "we get as a corollary a `` weighted '' version of the busemann - feller theorem :    let @xmath44 be a homothecy invariant basis consisting of convex sets and @xmath53 be locally finite , non - negative measures on @xmath25",
    ". assume in addition that @xmath2 is doubling with respect to @xmath44 .",
    "if @xmath57 then @xmath44 differentiates @xmath58 with respect to the measure @xmath2 .",
    "a few words concerning the notation used in this paper are necessary . due to the technical nature of some of the proofs",
    "the notation becomes quite cumbersome but we have tried to be consistent with our choice of symbols .",
    "the current paragraph can be used as a guide to the notation and the reader is encouraged to consult it in order to avoid any sort of confusion .",
    "we write @xmath59 whenever @xmath60 for some constant @xmath61 and @xmath62 if @xmath59 and @xmath63 .",
    "we write @xmath64 whenever the implied constant depends on some parameter @xmath27 .",
    "we omit such dependencies when they are of no importance .",
    "in this paper we use several differentiation bases which are basically collections of open sets in @xmath25 .",
    "we use the symbol @xmath44 to denote a generic basis consisting of convex sets , the symbol @xmath65 to denote a generic basis consisting of rectangles , the symbol @xmath66 for the basis of all rectangles with sides parallel to the coordinate axes , the symbol @xmath67 for the collection of all euclidean balls and the symbol @xmath68 for the collection of all cubes in @xmath25 with sides parallel to the coordinate axes .    for a rectangle @xmath69",
    "we denote by @xmath70 the mesh of `` dyadic rectangles '' associated to @xmath71 .",
    "the `` dyadic children '' of @xmath71 are produced by dividing each side of @xmath71 into two equal parts while the dyadic parent of @xmath71 is the rectangle @xmath72 whose sidelengths are double the corresponding sidelengths of @xmath71 and shares exactly one corner with @xmath71 .",
    "thus every @xmath73 has exactly @xmath74 dyadic children and is contained in a unique dyadic parent .",
    "for a dyadic rectangle @xmath71 we write @xmath72 for the parent of @xmath71 and @xmath75 for the ancestor of @xmath71 which is @xmath76 generations `` before '' @xmath71 . for more details",
    "see the discussion before proposition  [ p.dyadicmaximal ] .",
    "the measures @xmath53 that appear in this paper are always assumed to be locally finite , non - negative borel measures . the symbol @xmath5 is used to denote such a measure in the underlying space .",
    "thus we prove bounds on @xmath56 .",
    "we use the symbol @xmath2 to denote a measure which is additionally assumed to be _ doubling _ with respect to some differentiation basis @xmath44 .",
    "the doubling constant of @xmath2 with respect to @xmath44 is denoted by @xmath77 .",
    "we omit these indices when the definition of the underling measure or basis is clear from the context .",
    "the measure @xmath2 is typically used in order to define some maximal operator @xmath54 . thus our main questions concern the mapping property @xmath78 .",
    "we use the symbol @xmath17 to denote a non - negative locally integrable function , that is , a weight . in this case",
    "we write @xmath79 for the weighted maximal function with respect to @xmath44 and @xmath17 .",
    "some words are also necessary concerning the dilations that we use in the paper .",
    "there are three kinds of dilations of a set @xmath13 with respect to some parameter @xmath80 . if the set @xmath13 has a natural center of symmetry then @xmath81 denotes the dilates of @xmath13 by a factor @xmath82 , with respect to its center . if @xmath83 is a convex set we write @xmath84 even if @xmath83 is not symmetric with respect to some point",
    ". in this case",
    "the homothecy center is taken to be the center of the john ellipsoid of @xmath83 .",
    "see   [ s.john ] .",
    "we write @xmath85 , that is , for the dilation with respect to @xmath86 .",
    "finally we write @xmath87 whenever @xmath71 is a `` dyadic rectangle '' to denote the dilation of @xmath71 by the factor @xmath82 , with respect to the corner shared by @xmath71 and its parent @xmath72 .",
    "we also consider translations of sets ; for @xmath88 and @xmath36 we set @xmath89 .",
    "finally , almost all the logarithms that appear in this paper are base-@xmath90 logarithms ; we still just write @xmath91 for @xmath92 .",
    "by a _ basis _ @xmath44 we mean a collection of bounded open sets in @xmath25 .",
    "the differentiation properties of a basis @xmath44 are determined by the boundedness properties of the corresponding maximal function , acting on locally integrable functions @xmath52 as @xmath93 if @xmath94 and @xmath95 otherwise .",
    "particular attention will be given to two special bases of open sets ; namely the basis @xmath68 , consisting of all @xmath27-dimensional cubes with sides parallel to the coordinate axes , and the basis @xmath66 consisting of all rectangles with sides parallel to the coordinate axes .",
    "the corresponding maximal operators are the _ hardy - littlewood maximal function _ @xmath96 and the _ strong maximal function _",
    "we are interested in @xmath98-bounds for the maximal functions @xmath45 of the type @xmath99 together with appropriate endpoint bounds as @xmath100 .",
    "the existence of such bounds can not be guaranteed in the generality of @xmath44 discussed above . indeed , if @xmath44 is the family of _ all _ rectangles in @xmath25 , allowing all rotations , dilations and translations , then @xmath45 is called the _ universal maximal function _ which is known to be unbounded for any @xmath101 ; see @xcite .",
    "note , however , that this operator restricted to radial functions is bounded on @xmath48 for @xmath102 .",
    "see @xcite and @xcite . on the other hand ,",
    "the maximal operators defined with respect to the bases @xmath66 and @xmath68 are well understood , with the corresponding sharp endpoint bounds being @xmath103 here @xmath104 and @xmath105 .",
    "the first weak inequality above is the classical maximal theorem of hardy and littlewood ; see for example @xcite .",
    "the second distributional inequality is the strong maximal theorem of jessen , marcinkiewicz and zygmund from @xcite .",
    "see also @xcite for a geometric approach to the same result . by interpolation ,",
    "the previous endpoint bounds imply for both @xmath68 and @xmath66 .",
    "we say that @xmath17 is a _",
    "weight _ associated to the basis",
    "@xmath44 if @xmath17 is a non - negative locally integrable function on @xmath106 and @xmath107 for every @xmath108 . the weighted analogue of estimate takes the form @xmath109 the corresponding endpoint bounds as @xmath100 are also of great interest and are typically harder ( and stronger ) than their @xmath98-analogues .    again , for the bases @xmath68 and @xmath66 , estimates are much better understood and the validity of for any @xmath110 is characterized by the membership of @xmath17 to the classes of muckenhoupt weights @xmath111 :    [ d.ap ] we say that a weight @xmath17 belongs to the class @xmath111 , @xmath110 , if @xmath112_{a_{p,\\mathfrak b}}\\coloneqq \\sup_{b\\in\\mathfrak b}\\bigg (    \\frac{1}{|b|}\\int_b w(y)dy\\bigg)\\bigg(\\frac{1}{|b|}\\int_b w(y)^{1-p'}dy\\bigg)^{p-1}<+\\infty.\\end{aligned}\\ ] ] here and throughout the paper @xmath113 denotes the dual exponent of @xmath7 , that is @xmath114    for the limiting case @xmath115 the class @xmath116 is defined to be the set of weights @xmath17 such that @xmath117_{a_{1,\\mathfrak b}}\\coloneqq     \\sup_{b\\in\\mathfrak b}\\bigg(\\frac{1}{|b|}\\int_b w(y)dy \\bigg ) \\operatorname*{ess\\,sup}_{b } ( w^{-1})<+\\infty.\\end{aligned}\\ ] ] this is equivalent to @xmath17 having the property @xmath118_{a_{1,\\mathfrak b}}\\cdot w(x),\\quad\\text{a.e.}\\ x\\in\\r^n.\\end{aligned}\\ ] ] it follows from hlder s inequality and the definitions above that for all @xmath119 we have that @xmath120 , that is , the classes @xmath111 are increasing in @xmath121 .",
    "it is thus natural to define the limiting class @xmath122 as @xmath123 for the special bases @xmath124 we use the shorthand notation @xmath125 and @xmath126 .    for a general basis @xmath44 ,",
    "as considered here , there is really no `` obvious '' definition of the class @xmath122 . for the basis",
    "@xmath68 many definitions have appeared in the literature and they are all equivalent to each other .",
    "see for example @xcite .",
    "this remains true for the basis @xmath66 .",
    "however , for a general basis @xmath44 , these different definitions may define different classes of weights .",
    "we adhere to the definition of the class @xmath122 as the union of the classes @xmath127 for notational simplicity mostly , keeping in mind that for the bases @xmath68 and @xmath66 the definition above coincides with all the standard definitions that appear in the literature .    for the bases @xmath68 and @xmath66 , the boundedness properties of the corresponding maximal operators on weighted lebesgue spaces are well known .",
    "this is completely classical and due to muckenhoupt for the basis @xmath128 ; see @xcite .",
    "the theorem of muckenhoupt extends without difficulty to the basis @xmath66 whenever @xmath40 ; see for example @xcite .",
    "we summarize these results below .",
    "[ t.complete ] the following statements are true .    * let @xmath44 be either @xmath68 or @xmath66 and @xmath110",
    ". then @xmath129 if and only if @xmath130 , if and only if @xmath131 . * for @xmath68 : @xmath132 if and only if @xmath133 .",
    "* for @xmath66 : if @xmath134 then @xmath135    thus , the boundedness properties of @xmath45 on @xmath16 , @xmath110 , are completely characterized for the bases @xmath136 , and the same is true for the weighted endpoint estimate @xmath137 . however , the endpoint estimate for the strong maximal function is not so transparent .",
    "indeed , the presence of the logarithmic terms on the right hand side of the results in the condition @xmath138 being sufficient , but not necessary , for the validity of . a necessary condition for , which is weaker than @xmath134 , appears in @xcite but the authors show that it is not sufficient . on the other hand , the weighted endpoint estimate has been characterized in @xcite in terms of a certain covering property for rectangles .",
    "see also @xcite*theorem 4.3.1 for a detailed proof of this fact .",
    "similar characterizations of the boundedness properties of maximal operators on general @xmath38-spaces in terms of covering properties are contained for example in @xcite*theorem 2.2 and @xcite*lemma iv.6.11 , while the approach goes back to @xcite and @xcite .",
    "there is however no characterization in the spirit of the muckenhoupt @xmath139-classes , of the weights @xmath17 such that holds .",
    "let @xmath2 be a non - negative measure on @xmath25 , finite on compact sets , and let @xmath44 be a basis . for @xmath140 we write @xmath141 if @xmath94 and @xmath142 if @xmath143 . if @xmath144 for some weight @xmath17 associated to the basis @xmath44 we just write @xmath79 for @xmath54 and this operator will be called the weighted maximal operator with respect to @xmath17 .",
    "the boundedness properties of @xmath54 are much harder than the corresponding properties of the unweighted maximal operator , with definitive information only for special cases of bases @xmath44 and measures @xmath2 .",
    "again , we mainly restrict our attention to the case that @xmath44 is either @xmath68 or @xmath66 . as in the unweighted case ,",
    "the one - parameter operator @xmath145 is easier to analyze than the operator @xmath37 .",
    "however , even in the one - parameter case , there is no complete characterization of the measures @xmath2 for which @xmath145 is bounded on @xmath146 .",
    "below we give a brief overview of the known results for the bases @xmath68 or @xmath66 and refer the interested reader to the monograph @xcite for further details and proofs .      in dimension",
    "@xmath147 , let @xmath2 be any non - negative borel measure .",
    "we have that @xmath148 and by interpolation @xmath149 for all @xmath150 .",
    "this result is very special to one dimension since the proof depends on a covering lemma for intervals of the real line .",
    "observe that there is essentially no restriction on the measure @xmath2 .",
    "see for example @xcite for the details of this result .",
    "a common variation of @xmath145 is the _ centered _ weighted hardy - littlewood maximal function , given as @xmath151 where @xmath152 denotes the cube with sides parallel to the coordinate axes and sidelength @xmath153 , centered at @xmath154 .",
    "then for any non - negative borel measure @xmath2 we have that @xmath155 and thus , by interpolation , @xmath156 for all @xmath150 .",
    "the proof of this result depends on the besicovitch covering lemma and it remains valid whenever the besicovitch argument goes through .",
    "thus , the condition that the maximal function defined above is centered is essential .",
    "for example , it was shown in @xcite that if @xmath157 is the gaussian measure in @xmath158 then the non - centered weighted maximal operator @xmath159 does not map @xmath160 to @xmath161 .",
    "the second essential hypothesis , hidden in the definition of @xmath162 , is that it is a _ one - parameter _ maximal operator , that is , we average with respect to a one - parameter family of cubes . here",
    "one could replace cubes by euclidean balls or more general `` balls '' , given by translations and _ one - parameter _ dilations of a convex set in @xmath106 symmetric about the origin .    on the other hand , emphasizing the need for the one - parameter hypothesis mentioned previously",
    ", the boundedness fails for the weighted strong maximal function , even in its centered version .",
    "the reason is that the family @xmath66 is an @xmath27-parameter family of sets for which the besicovitch covering is not valid .",
    "see for example @xcite for an example of a locally finite measure @xmath2 for which @xmath163 is unbounded on @xmath38 for all @xmath164 .",
    "let @xmath2 be a non - negative borel measure .",
    "the following definition is standard .",
    "the measure @xmath2 is called _ doubling _ if there is a constant @xmath165 such that , for every cube @xmath166 we have @xmath167 where @xmath168 .    it is an easy observation that for @xmath2 doubling , the non - centered weighted maximal operator @xmath145 is pointwise equivalent to its centered version , that is , @xmath169 , where the implicit constants depend only on @xmath170 .",
    "it follows from the discussion in ",
    "[ s.cent ] that the maximal operator @xmath145 with respect to a doubling measure @xmath2 maps @xmath171 to @xmath172 and @xmath38 to @xmath38 for all @xmath173 .    here , the doubling hypothesis can not be removed .",
    "indeed , the example from @xcite mentioned above shows that there exists a non - doubling measure , in particular the gaussian measure in @xmath158 , such that @xmath159 does not map @xmath160 to @xmath161 .",
    "most of the results in the literature that study @xmath54 for non - doubling measures concern the basis @xmath67 consisting of all _ euclidean balls _ in @xmath25 and radial measures .",
    "for example it is shown in @xcite that if @xmath2 is rotationally invariant and assigns positive measure to all open sets then @xmath174 if and only if @xmath2 is _ doubling away from the origin_. in @xcite the authors provide a sufficient condition on a radial measure @xmath2 so that @xmath175 satisfies certain weak type inequalities close to @xmath171 which in turn imply that @xmath176 .",
    "an example of a radial measure @xmath2 such that @xmath175 is unbounded on all @xmath38-spaces , @xmath101 , can be found in @xcite .",
    "note that in the non - doubling case , the operators @xmath145 and @xmath175 can behave quite differently , unlike the doubling case .",
    "for example , if @xmath2 is a product of non - negative one - dimensional borel measures then obviously @xmath177 . by the one - dimensional result mentioned in  [ s.one ] and the methods from @xcite we get that @xmath37 , and a fortiori @xmath145 , is bounded on @xmath38 and satisfies the endpoint estimate @xmath178 one such product measure is the gaussian measure @xmath157 on @xmath25 for which we can thus conclude @xmath179 on the other hand it was shown in @xcite that @xmath180 and that this is actually sharp .",
    "it is not currently known whether estimate is sharp .",
    "the previous discussion shows however that , surprisingly , the operator @xmath181 on @xmath158 exhibits stronger endpoint behavior than @xmath182 .",
    "the rectangle case is less understood .",
    "even if the measure @xmath2 is doubling , it is not known in general whether @xmath37 maps @xmath146 to @xmath146 .",
    "notable exceptions are the one - dimensional case as well as the case where @xmath2 is a product measure , as we have already seen in  [ s.ncent ] .",
    "the case @xmath144 has been studied more systematically , the main result being that of r. fefferman from @xcite : if @xmath33 then @xmath183 for all @xmath173 .",
    "the endpoint inequality @xmath184 is also true whenever @xmath33 .",
    "this was proved by jawerth and torchinsky in  @xcite and independently by long and shen @xcite . a weaker sufficient condition for the boundedness of @xmath30 appears in @xcite but it is quite technical and we will not describe here",
    "; it shows however that @xmath33 is _ not _ a necessary condition for the boundedness of @xmath30 on @xmath16 , nor for the corresponding endpoint distributional estimate above .      for general bases @xmath44 and associated weights @xmath17 ,",
    "very little is known concerning the boundedness of @xmath45 and @xmath79 on @xmath16 .",
    "however , the following abstract theorem from @xcite gives a necessary and sufficient condition for the boundedness of the @xmath79 , in terms of the unweighted maximal function @xmath45 in the special case that @xmath185 .",
    "[ t.perez ] let @xmath44 be a basis .",
    "the following are equivalent :    * for every @xmath110 and every @xmath131 we have that @xmath186 * for every @xmath110 and every @xmath185 we have that @xmath187    the previous theorem as well as theorem [ t.complete ] motivate the following definition , which is also from @xcite .",
    "a basis @xmath44 is a _ muckenhoupt basis _",
    "if for every @xmath110 and every @xmath131 , we have that @xmath188    with this definition theorem  [ t.perez ] states that @xmath44 is a muckenhoupt basis if and only if the weighted maximal function satisfies @xmath189 for every @xmath110 and every @xmath185 .",
    "on the other hand , theorem [ t.complete ] shows that both @xmath68 and @xmath66 are muckenhoupt bases .",
    "another interesting example of muckenhoupt basis is given by the crdoba - zygmund basis in @xmath190 , consisting of rectangles with sides parallel to the coordinate axes and sidelengths of the form @xmath191 .",
    "see @xcite and @xcite for this and related facts .",
    "an example of a basis that is _ not _ a muckenhoupt basis is the collection of all rectangles in @xmath25 . to see this ,",
    "observe that the lebesgue measure satisfies the @xmath18 condition in definition  [ d.ap ] with respect to this basis for all @xmath192 , although the corresponding universal maximal operator is unbounded on @xmath48 for @xmath192 .",
    "the purpose of this section is to give a new characterization of the class of muckenhoupt weights @xmath193 in the case that @xmath44 is a homothecy invariant basis consisting of convex sets .",
    "this is the content of theorem [ t.taubw ] and corollary [ c.taubw ] below .",
    "the main interest is in the case of the basis @xmath66 consisting of all rectangles in @xmath25 with sides parallel to the coordinate axes .",
    "we show that @xmath194 coincides with the class of weights @xmath17 satisfying a weighted tauberian condition which , until now , had been considered weaker than @xmath195 .      in this paragraph we are concerned with bases @xmath44 that are _ homothecy invariant _ , namely they satisfy    1 .   for every @xmath108 and every @xmath196 we have that @xmath197 , where @xmath198 .",
    "for every @xmath108 and @xmath199 we have that @xmath200 , where @xmath201 .",
    "an example of a muckenhoupt basis which is not homothecy invariant is provided by the basis @xmath202 consisting of intervals on the real line .",
    "it is shown in @xcite that @xmath203 is a muckenhoupt basis and clearly it is not homothecy invariant .",
    "we will say that the corresponding maximal operator @xmath45 satisfies a _ tauberian condition _ with respect to a fixed @xmath42 if there exists some constant @xmath204 such that , for every measurable set @xmath205 , we have @xmath206 it is essential to notice here that the previous estimate is supposed to hold only for a fixed @xmath42 .",
    "however , in practice , many times one has a tauberian condition of the form for every @xmath42 and typically @xmath207 blows up to infinity as @xmath208",
    ".    this condition has appeared in different contexts in several places but we are mainly interested in the investigations initiated in @xcite .",
    "there are a couple of situations where such a condition can arise naturally .",
    "for example if the operator @xmath45 is known to be of weak type @xmath209 for some @xmath210 then @xmath45 satisfies with respect to every @xmath47 .",
    "more interestingly , the tauberian condition appears naturally when one considers _",
    "density bases_.",
    "let @xmath44 be a homothecy invariant basis in @xmath25 .",
    "then @xmath44 is called a _ density basis _ if it differentiates @xmath43 , namely if for every @xmath211 , for almost every @xmath154 and for every sequence @xmath212 such that @xmath213 and @xmath214 we have @xmath215    note that since translations and dilations of all sets in @xmath44 are still in @xmath44 there is always a sequence of sets @xmath216 as in the previous definition .",
    "the relevance of density bases to tauberian conditions is revealed by the following theorem of busemann and feller @xcite ; see also @xcite*chapter iii , theorem 1.2 :    [ t.bf ] let @xmath44 be a homothecy invariant basis and @xmath45 be the corresponding maximal operator .",
    "then @xmath44 is a density basis if and only if , for every @xmath217 there is a constant @xmath218 such that , for every measurable set @xmath36 we have @xmath219    thus for homothecy invariant density bases @xmath44",
    "consisting of convex sets , the corresponding maximal operator satisfies tauberian conditions of the type with respect to _ every _ @xmath42 .",
    "the same is true if the operator @xmath45 is known to be of weak type @xmath209 for some @xmath121 . even though this is apparently stronger than a single tauberian condition with respect to a fixed @xmath42 , the following striking theorem was proved in @xcite :    [ t.stokhag ] let @xmath44 be a homothecy invariant basis consisting of convex sets in @xmath25",
    ". then the following are equivalent :    1 .",
    "the operator @xmath45 satisfies a tauberian condition   with respect to some _ fixed _ @xmath42 .",
    "2 .   there exists some @xmath220 such that @xmath221 for all @xmath222 .    in virtue of the previous theorem ,",
    "the tauberian condition for a single @xmath42 is equivalent to tauberian conditions for _ every _",
    "@xmath42 whenever @xmath44 is a homothecy invariant basis consisting of convex sets in @xmath25 .",
    "we now come to the main subject of the current paper which investigates variations of the tauberian condition under the presence of a weight @xmath17 or , somewhat more generally , a measure @xmath2 . for this section",
    "we still consider the _ unweighted _ maximal operator @xmath45 acting on the weighted space @xmath16",
    ". we will be mostly interested in the case that @xmath44 is either @xmath68 or @xmath66 , but we will see that our results remain valid for general homothecy invariant bases consisting of convex sets .",
    "we thus fix a basis @xmath44 and a weight @xmath17 associated to @xmath44 .",
    "we will say that the maximal operator @xmath45 satisfies a weighted tauberian condition with respect to some @xmath42 and a weight @xmath17 if there exists a constant @xmath223 such that , for all measurable sets @xmath36 we have @xmath224    the weighted tauberian condition has been considered many times in the literature , especially in the context of weighted inequalities for the strong maximal function .",
    "indeed , it appears for example in @xcite , @xcite , @xcite , @xcite , @xcite and @xcite .",
    "condition is typically presented in the literature as a presumably weaker substitute for the hypothesis @xmath225 and is usually referred to as condition @xmath226 . for example , in @xcite condition is used as a hypothesis in order to prove @xmath16-bounds for the weighted strong maximal function @xmath30 .",
    "likewise , in @xcite it is shown that if @xmath44 is a muckenhoupt basis and @xmath45 satisfies for a fixed @xmath42 then @xmath45 satisfies a fefferman - stein inequality , namely @xmath227 finally , in @xcite and @xcite , the condition is used in order to deal with covering properties of rectangles which are relevant in the study of two weight problems for the strong maximal function .",
    "the following theorem shows however that condition is just an equivalent characterization of @xmath122 for quite a large class of bases @xmath44 .",
    "this is the content of our first main result :    [ t.taubw ] let @xmath44 be a homothecy invariant basis consisting of convex sets .",
    "let @xmath17 be a non - negative , locally integrable function on @xmath25 .",
    "then the following are equivalent :    * condition is satisfied for the weight @xmath17 and the basis @xmath44 , for a fixed level @xmath42 .",
    "* there exists @xmath228 such that @xmath129 for all @xmath222 .",
    "it is trivial that ( ii ) implies ( i ) .",
    "the converse implication for @xmath229 is essentially @xcite*theorem 1 . now",
    "a careful inspection of the proofs of the relevant results in @xcite reveals that the arguments therein actually show that if @xmath230 and @xmath17 satisfy then @xmath45 is of restricted type @xmath231 for some @xmath232 , with respect to the weight @xmath17 .",
    "marcinkiewicz interpolation now gives ( ii ) for any @xmath233 .",
    "alternatively , the proof follows from the more general result in the current paper , namely theorem  [ t.convdoubling ] .",
    "in fact the same proof goes through to show that if @xmath2 is a non - negative borel measure which is finite on compact sets and @xmath234 for every measurable set @xmath13 then @xmath235 for some @xmath40 .",
    "we will not insist on the this generalization here as theorem  [ t.convdoubling ] below provides a much more general statement .    if the basis @xmath44 is additionally a muckenhoupt basis we immediately get the following corollary :    [ c.taubw ] let @xmath44 be a homothecy invariant basis consisting of convex sets which is also a muckenhoupt basis",
    ". then @xmath185 if and only if @xmath17 satisfies for _ some fixed level _ @xmath42 .",
    "specializing to the case @xmath236 or @xmath237 , corollary  [ c.taubw ] provides a new characterization of the usual muckenhoupt class @xmath238 and the strong muckenhoupt class @xmath195 , respectively . however , condition is a lot harder to check in practice than all the other equivalent formulations of @xmath238 and @xmath195 that appear in the literature .",
    "our main point however is that the assumption for @xmath237 is exactly the same as @xmath239 and not weaker , as it was so far believed .",
    "consider the maximal function @xmath54 defined with respect to a non - negative measure @xmath2 which is finite on compact sets and a homothecy invariant basis @xmath44 in @xmath25 , consisting of open and bounded convex sets with non - empty interior .",
    "our main objective is to find a characterization of the measures @xmath2 such that @xmath78 for some @xmath40 in terms of a mixed @xmath53-tauberian condition . to make this precise we give the following definition",
    ":    we will say that the maximal operator @xmath54 satisfies the tauberian condition with respect to some _ fixed _",
    "@xmath47 if there is a constant @xmath240 such that for all measurable sets @xmath205 we have @xmath241    if @xmath78 for some @xmath40 then is satisfied for all @xmath42 .",
    "we want to investigate if the converse is true , namely , if for some fixed @xmath42 implies the boundedness of @xmath54 on @xmath56 for sufficiently large @xmath40 .",
    "we will not pursue this in full generality but rather confine ourselves to the case that the measure @xmath2 is doubling with respect to the underlying basis .      in this section",
    "we discuss the properties of measures which are doubling with respect to a basis of convex sets . by a basis of convex sets we will always mean a homothecy invariant basis @xmath44 consisting of non - empty , bounded , open convex sets with non - empty interior .",
    "we begin by the definition of doubling in this general context .",
    "remember that for @xmath242 , @xmath36 and @xmath80 we write @xmath243 and @xmath244 .",
    "let @xmath2 be a non - negative measure which is finite on compact sets .",
    "we will say that @xmath2 is doubling with respect to @xmath44 if there is a constant @xmath245 such that , for every @xmath246 and every @xmath88 such that @xmath247 we have @xmath248 we always assume @xmath77 to be the smallest possible constant so that the previous inequality holds uniformly for all @xmath108 .",
    "when the underlying basis @xmath44 is clear from the context we will write @xmath249 for @xmath77",
    ".    the previous definition of a doubling measure reduces to the usual doubling condition ( up to changes in the doubling constant ) if @xmath236 or @xmath250 .",
    "however , the doubling condition with respect to @xmath66 , say , is quite different than the doubling condition with respect to cubes .",
    "in fact , if one wants to study the behavior of the operator @xmath37 with respect to a measure @xmath2 then the `` natural '' condition is that @xmath2 is doubling with respect to @xmath66 .",
    "for example in @xcite , measures that are doubling with respect to @xmath66 are called _ product - doubling _ and we will adopt the same terminology here . the same notion of product - doubling is discussed for example in @xcite .",
    "naturally , weights @xmath251 give product - doubling measures @xmath252 .",
    "observe also that for a general basis of convex sets @xmath44 there is in general no natural homothecy center as the convex sets in @xmath44 might not be symmetric with respect to some point . in order to avoid confusion in all these subtle issues",
    "we will always specify the basis according to which a measure is assumed to be doubling .",
    "one of the technical annoyances when dealing with general convex sets is the lack of a natural homothecy center as the convex sets we will consider will not in general be symmetric with respect to some point . in order to deal with this lack of symmetry and resulting technical issues , the classical lemma of f. john , @xcite , will be very useful .",
    "see also @xcite for a very nice exposition of this and related topics .",
    "let @xmath83 be a bounded convex set in @xmath25 .",
    "then @xmath83 contains a unique ellipsoid @xmath253 , of maximal volume .",
    "we will call @xmath253 the _ john ellipsoid _ of @xmath83 .",
    "the john ellipsoid of @xmath83 is such that @xmath254 here @xmath255 denotes the dilation of the ellipsoid @xmath253 by a factor @xmath80 with respect to its center .",
    "given a basis @xmath44 consisting of convex sets we will now construct an associated basis @xmath256 consisting of rectangles as in @xcite . to this end let @xmath108 and @xmath253 be the john ellipsoid of @xmath83 .",
    "then there is a ( not necessarily unique ) rectangle @xmath257 of minimal volume .",
    "it is elementary to check that for any ellipsoid @xmath258 , a rectangle @xmath71 of minimal volume that contains @xmath258 satisfies @xmath259 given @xmath260 , let @xmath261 be a rectangle of minimal volume containing @xmath262 . by the above observations and john s lemma we get for every @xmath263 that @xmath264    here the dilations @xmath84 are with respect to the center of the john ellipsoid associated to @xmath83 .",
    "we now define the basis @xmath265 as @xmath266 since @xmath44 is homothecy invariant the rectangle @xmath261 may be selected so that @xmath267 is homothecy invariant . in this paper",
    "we will always assume that this is the case .",
    "the following lemma is an immediate consequence of the above discussion .",
    "we omit the easy proof .",
    "[ l.convrect ] let @xmath44 be a basis of convex sets and @xmath256 be the homothecy invariant basis of associated rectangles as constructed above .",
    "suppose that @xmath2 is doubling with respect to @xmath44 with doubling constant @xmath77 .",
    "we have :    * the measure @xmath2 is doubling with respect to @xmath265 with doubling constant @xmath268 * we have the pointwise equivalence @xmath269 where @xmath270 . *",
    "if @xmath108 and @xmath271 is the associated rectangle of @xmath83 with @xmath272 then @xmath273 where @xmath274 and @xmath275 as defined in ( ii ) .",
    "the doubling condition has some important consequences in that the measure is `` homogeneously '' distributed in the space .",
    "we summarize these properties in the proposition below .",
    "we note that these properties are classical and refer the reader to @xcite*8.6 for more details .",
    "[ p.noboundarymass ] let @xmath2 be a ( not identically zero ) locally finite , non - negative borel measure .",
    "assume that @xmath2 is doubling with respect to some family @xmath276 consisting of all the homothetic copies of a fixed rectangle .",
    "the following properties are satisfied .",
    "* we have @xmath277 for every open set @xmath278 .",
    "* let @xmath279 and @xmath70 be the dyadic grid generated by @xmath71 .",
    "there exists a constant @xmath280 , depending only on the doubling constant of @xmath2 and the dimension @xmath27 such that @xmath281 , where @xmath282 is the ancestor of @xmath71 , @xmath283 generations higher .",
    "in particular @xmath284 . * the maximal operator @xmath285 is of weak type @xmath286 and strong type @xmath209 for all @xmath173 , with respect to @xmath2 , and the operator norms depend only on the doubling constant of the measure @xmath2 , the exponent @xmath7 and the dimension @xmath27 . also the centered maximal operator",
    "@xmath287 satisfies the same bounds . *",
    "if @xmath83 is a convex set in @xmath25 we have @xmath288 where @xmath289 is the boundary of @xmath83 .",
    "the proof of ( i ) can be found for example in @xcite*8.6 .",
    "for ( ii ) let @xmath72 be the dyadic parent of @xmath71 and let @xmath290 denote the dyadic children of @xmath72 and suppose that @xmath291 .",
    "then @xmath292 where @xmath293 is the doubling constant of @xmath2 .",
    "let @xmath294 .",
    "since @xmath71 is @xmath283 generations inside @xmath282 we iterate to get @xmath295 as desired .    for ( iii )",
    "observe that @xmath285 is essentially the hardy - littlewood maximal operator with respect to a doubling measure and the result is classical . since the measure @xmath2 is doubling the operators @xmath296 are pointwise comparable and satisfy the same bounds .",
    "finally for ( iv ) let us fix the convex set @xmath83 and @xmath297 .",
    "let @xmath298 be a supporting hyperplane of @xmath83 through @xmath299 and let @xmath300 be the open half - space defined by @xmath298 so that @xmath301 .",
    "let @xmath302 , centered at @xmath299 and @xmath303 be the rectangle with the same center as @xmath71 and sides @xmath304 times the corresponding sides of @xmath71 .",
    "so @xmath303 is an homothetic copy of @xmath71 .",
    "consider the @xmath305 subrectangles @xmath306 produced by dividing each side of @xmath303 into four equal parts .",
    "now at least one of these @xmath306 s is contained in the open half space @xmath300 .",
    "let us call this rectangle @xmath307 and observe that it is of the form @xmath308 and @xmath309 .",
    "we can then estimate @xmath310 with @xmath311 . applying ( iii ) for the centered operator @xmath287 we see that @xmath312 which implies that @xmath288 .",
    "we now turn our attention to the maximal function @xmath313 defined with respect to a non - negative measure @xmath2 which is finite on compact sets and a homothecy invariant basis @xmath65 in @xmath25 consisting of rectangles .",
    "observe that we do not assume the rectangles in @xmath65 to have sides parallel to the coordinate axes but one possible choice of @xmath65 is the basis @xmath66 .",
    "our main objective is to find a characterization of the measures @xmath2 such that @xmath314 for some @xmath40 in terms of a mixed @xmath53-tauberian condition .",
    "the tauberian condition now takes the form    @xmath315    our second main result gives a characterization of the boundedness of @xmath313 on @xmath56 in terms of the tauberian condition , whenever the measure @xmath2 is doubling with respect to @xmath65 .",
    "note that for the measure @xmath5 we only assume that it is non - negative and locally finite .",
    "[ t.doubling ] let @xmath65 be a homothecy invariant basis consisting of rectangles and @xmath53 be two non - negative measures on @xmath25 , finite on compact sets .",
    "assume that @xmath2 is doubling with respect to @xmath65 .",
    "the following are equivalent :    * the measures @xmath53 satisfy the tauberian condition with respect to some _ fixed level @xmath42_. * there exists @xmath316 such that @xmath314 for all @xmath222 .",
    "the previous theorem has an interesting corollary whenever @xmath317 . in this special case",
    "our main theorem concerns the boundedness of the operator @xmath313 on @xmath38 , for sufficiently large @xmath40 and @xmath318 doubling with respect to @xmath65 . as discussed in ",
    "[ s.generalmeasures ] this scenario is very well understood for the basis @xmath68 .",
    "indeed , we already know that for a doubling measure @xmath2 the operator @xmath145 is of weak type @xmath286 and thus of strong type @xmath209 for all @xmath40 .",
    "thus both ( i ) and ( ii ) of this theorem are always satisfied for @xmath68 and @xmath319 . however , for @xmath320 and @xmath2 product - doubling we get a new characterization of the measures @xmath2 such that @xmath37 is bounded on @xmath38 , for sufficiently large @xmath40 .    when @xmath317 the mixed tauberian condition becomes : @xmath321 we then have :    [ c.taubmu ] let @xmath65 be a homothecy invariant basis consisting of rectangles and @xmath2 be a non - negative measure on @xmath25 , finite on compact sets .",
    "assume that @xmath2 is doubling with respect to @xmath65 .",
    "the following are equivalent :    * the measure @xmath2 satisfies the tauberian condition with respect to some _ fixed level @xmath42_. * there exists @xmath322 such that @xmath323 for all @xmath222 .      in this subsection",
    "we give the details of the proof of theorem  [ t.doubling ] .",
    "first of all observe that if @xmath324 then trivially is satisfied for every @xmath42 .",
    "for the rest of this section we will thus assume that holds for some @xmath47 .",
    "let @xmath325 .",
    "any such choice of @xmath326 will work equally well but for definitiveness we can take @xmath326 to be the arithmetic mean of @xmath157 and @xmath327 .",
    "the hypothesis implies that @xmath328 here @xmath329 but we suppress these dependencies for the sake of simplicity .",
    "we will need the following notation introduced in @xcite .",
    "for every measurable set @xmath330 we define @xmath331 and for @xmath332 @xmath333 with these definitions at hand it is not difficult to check the following basic properties . let @xmath334 be non - negative integers and @xmath335 measurable subsets of @xmath25 . then @xmath336 the properties above will be used in several parts of the proof with no particular mention .",
    "the following lemma is the heart of the proof of theorem  [ t.doubling ] .",
    "[ l.main ] let @xmath2 be a doubling measure with respect to @xmath65 , with doubling constant @xmath170 , and @xmath13 be a measurable set in @xmath106 .",
    "suppose that for some @xmath337 and @xmath338 we have @xmath339 .",
    "then @xmath340 here we denote by @xmath341 the smallest positive integer which is no less than @xmath299 .",
    "before giving the proof of the lemma let us see how we can use it to conclude the proof of theorem  [ t.doubling ] . by restricted weak type interpolation it suffices to show that for every @xmath342 and every measurable set @xmath36 we have the estimate @xmath343 for some @xmath344 and some constant @xmath61 , independent of @xmath345 and @xmath13 .",
    "estimate above is the claim that the sublinear operator @xmath313 is of restricted weak type @xmath346 with respect to the measure @xmath5 , for some @xmath344 .",
    "now we have @xmath347 by , for all @xmath348 . in order to estimate",
    "the first summand let @xmath349 .",
    "for every @xmath350 there exists @xmath351 and @xmath352 with @xmath353 by lemma [ l.main ] we get that @xmath354 . now observe that @xmath355 is a nonincreasing function of @xmath356 .",
    "thus for all @xmath357 we have that @xmath358 which by implies that @xmath359 . combining these observations",
    "we get that @xmath360 using we now see that @xmath361 by the explicit expression for @xmath362 observe that we can write @xmath363 with @xmath364 , depending only on @xmath326 and @xmath2 .",
    "thus @xmath365 with @xmath366 .",
    "remember that @xmath326 is completely determined by the level @xmath157 in hypothesis so that @xmath367 . together with",
    "this completes the proof of and thus of theorem  [ t.doubling ] .    for the proof of lemma [ l.main ]",
    "we will need an intermediate result .",
    "for this we introduce a final piece of notation . if @xmath338 then there is a natural `` dyadic system of rectangles '' associated to @xmath368 which we will denote by @xmath369 .",
    "this system has the properties    * we have that @xmath370 . *",
    "every @xmath371 has a unique dyadic parent @xmath372 and @xmath74 dyadic children .",
    "furthermore , each corner of a rectangle @xmath373 is shared by @xmath374 and exactly one of its dyadic children . *",
    "if @xmath375 then @xmath376 .    we leave the details of the dyadic construction above to the interested reader .",
    "we now define the dyadic weighted maximal function with respect to @xmath70 and @xmath2 as @xmath377 the dyadic maximal function just defined satisfies all the desired bounds :    [ p.dyadicmaximal ] let @xmath2 be a locally finite non - negative measure .",
    "we have that @xmath378 .",
    "we conclude that the family @xmath379 differentiates @xmath380 .",
    "note that there is no doubling assumption on the measure @xmath2 in this proposition .",
    "indeed , the proof amounts to selecting the maximal `` dyadic rectangles '' @xmath381 such that @xmath382 and noting that they are disjoint .",
    "one then lets @xmath383 .",
    "an identical argument works for `` dyadic rectangles '' contained in the other quadrants of @xmath25 .",
    "we leave the details to the interested reader .",
    "[ l.interm ] let @xmath384 and @xmath71 be as in the hypothesis of lemma [ l.main ] above .",
    "then there exists a non - negative integer @xmath385 such that @xmath386    we perform a caldern - zygmund decomposition of @xmath387 at level @xmath326 with respect to the dyadic grid @xmath70 .",
    "namely , let @xmath388 be the collection of `` dyadic rectangles '' which are maximal among the @xmath389 that satisfy @xmath390 observe that @xmath391 for all rectangles @xmath374 by proposition  [ p.noboundarymass ] .",
    "furthermore @xmath392 so that every dyadic rectangle @xmath374 as above is contained in a maximal dyadic rectangle .",
    "this selection algorithm together with the hypothesis @xmath393 allows us to choose a @xmath2-a.e .",
    "disjoint family @xmath388 such that @xmath394 for any constant @xmath395 we let @xmath396 denote the rectangle containing @xmath397 that has sidelength @xmath82 times the sidelength of @xmath397 and has a common corner with @xmath397 and @xmath398 .",
    "with this notation we have @xmath399 while the doubling hypothesis for @xmath2 implies that @xmath400 for every @xmath76 .",
    "for each @xmath76 we set @xmath401 .",
    "suppose we have defined @xmath402 for some @xmath403 .",
    "we define @xmath404 to be a rectangle of the form @xmath405 , where @xmath406 is chosen so that @xmath407 and @xmath408 observe that such a choice is always possible since the function @xmath409 satisfies @xmath410 , @xmath411 as @xmath412 and by ( iv ) of proposition  [ p.noboundarymass ] it is continuous on @xmath413 .    for @xmath414 we now set @xmath415 observe that for @xmath414 we have @xmath416 indeed if @xmath417 then @xmath418 for some @xmath419 .",
    "we estimate @xmath420 by .",
    "next we claim that for every @xmath414 we have @xmath421 for @xmath422 this is an immediate consequence of since @xmath423 assume now that is valid for some @xmath414 . by , the inductive hypothesis and properties",
    ", we get that @xmath424 which proves the claim .",
    "now let @xmath385 be the smallest non - negative integer such that @xmath425 , where @xmath170 is the doubling constant of the measure @xmath2 .",
    "it follows that @xmath426 for every @xmath76 .",
    "indeed , assume for the sake of contradiction that @xmath427 .",
    "then the doubling property of @xmath2 implies that @xmath428 thus @xmath429 which contradicts the choice of @xmath385 .    now implies that for every @xmath76 we have @xmath430 and we can conclude that for every @xmath76 @xmath431 hence @xmath432 let @xmath433 denote the maximal elements of @xmath434 .",
    "then the sets @xmath433 are @xmath2-a.e .",
    "pairwise disjoint and @xmath435 .",
    "note that all @xmath436 s are contained in @xmath71 since for all @xmath76 we have @xmath437 .",
    "we also have that we have @xmath438 for any @xmath439 . indeed ,",
    "if @xmath440 for some @xmath439 then we would have @xmath441 which is impossible because of the maximality of the @xmath442 s among the @xmath443 s .",
    "thus none of the @xmath442 were selected in the caldern - zygmund decomposition so that @xmath444 and hence @xmath445 for all @xmath446 since @xmath447 for all @xmath446 . using the last estimate and we",
    "now have @xmath448 now implies that @xmath449 almost everywhere so that @xmath450 .",
    "thus the previous estimate reads @xmath451 which by implies that @xmath452 as desired .",
    "we can now conclude the proof of lemma [ l.main ] .    by the hypothesis of the lemma there",
    "exists @xmath337 and @xmath453 with @xmath454 .",
    "let @xmath455 be the smallest positive integer such that @xmath456 .",
    "such an integer obviously exists since @xmath457 .",
    "there are two possibilities .",
    "we have that @xmath458 for @xmath459",
    ". then we claim that we have @xmath460 we will prove by induction on @xmath446 .",
    "indeed , the case @xmath461 is just lemma [ l.interm ] .",
    "assume that is true for some @xmath462 .",
    "then , since @xmath463 we can apply lemma [ l.interm ] for the rectangle @xmath71 and the set @xmath464 in place of @xmath13 to conclude that @xmath465 however this is just for @xmath466 since @xmath467 .",
    "now by for @xmath468 we get that @xmath469 by the choice of @xmath455 .",
    "this implies that @xmath470 .",
    "we have that @xmath471 for some @xmath472 .",
    "in fact , by the hypothesis we necessarily have that @xmath473 in this case . then @xmath474 which implies that @xmath475 .",
    "observe that in either one of the complementary cases considered above we can conclude that @xmath470 .",
    "this proves the lemma with @xmath476 .",
    "it remains to estimate @xmath355 .",
    "this can be easily done by going back to the way the integers @xmath385 and @xmath455 were chosen . for @xmath385",
    "remember that it is the smallest non - negative integer such that @xmath477 . if @xmath478 then the choice @xmath479 will do . if @xmath480 then we get that @xmath385 is the smallest positive integer which is greater or equal to @xmath481 .",
    "thus the choice @xmath482 covers both cases .",
    "likewise , @xmath455 is the smallest integer such that @xmath483 or @xmath455 is the smallest integer greater than @xmath484 .",
    "thus we can choose @xmath485 we set @xmath486 of course , any integer greater than the @xmath355 above will also do since the sets @xmath487 are increasing in @xmath446 .",
    "the purpose of this section is to provide an extension of theorem  [ t.doubling ] to the case that the tauberian condition is given with respect to a homothecy invariant basis @xmath44 consisting of convex sets : @xmath488 as in the previous section where the basis @xmath65 consisted of rectangles , we will need to assume the doubling property of the measure @xmath2 with respect to the basis @xmath44 .",
    "the main theorem of this section is the following .    [ t.convdoubling ]",
    "let @xmath44 be a homothecy invariant basis consisting of convex sets and @xmath53 be two non - negative measures on @xmath25 , finite on compact sets .",
    "assume that @xmath2 is doubling with respect to @xmath44 .",
    "the following are equivalent :      the general strategy of the proof is the following . assuming that is satisfied for some level @xmath42 we will show that the maximal operator @xmath490 also satisfies a tauberian condition with respect to every level @xmath491",
    ". we will then use theorem [ t.doubling ] to conclude that @xmath490 is bounded on some @xmath56-space , for sufficiently large @xmath7 . according to lemma  [ l.convrect ] the operators @xmath490 , @xmath54 are pointwise comparable so this will complete the proof of theorem [ t.convdoubling ] .",
    "[ l.taubassoc ] suppose that @xmath54 satisfies the tauberian condition   for some fixed level @xmath42 .",
    "then for all @xmath492 the operator @xmath493 satisfies a tauberian condition with respect to @xmath356 : @xmath494 where @xmath495 depends on @xmath496 , the measures @xmath53 , the dimension @xmath27 , @xmath157 and @xmath356 .",
    "we will adopt the definitions and notation of   [ s.gendoubling ] , namely for every @xmath108 we consider the associated rectangle @xmath271 where @xmath497 and @xmath498 forms a homothecy invariant basis .",
    "our basic assumption is that @xmath2 is doubling with respect to @xmath44 with doubling constant @xmath499 . by lemma  [ l.convrect ]",
    "this implies that @xmath2 is also doubling with respect to @xmath265 , with doubling constant @xmath500 .",
    "all these notions and constants will be fixed throughout this section so we will just write @xmath501 and @xmath502 .",
    "we now fix a convex set @xmath83 and its associated rectangle @xmath503 and work locally inside @xmath71 . by using a bijection @xmath504 we always have @xmath505^n = q = t(r)$ ] and then we set @xmath506 . by considering the pushforward of @xmath2 , that is the measure defined as @xmath507 for every measurable set @xmath13",
    ", we readily see that the measure @xmath508 is doubling with respect to the basis @xmath509 with doubling constant @xmath170 .",
    "also the measure @xmath508 is doubling with respect to the basis @xmath510 with doubling constant @xmath511 . using these invariances we can and",
    "will henceforth assume that @xmath512 and @xmath83 is a convex set inside @xmath513 .",
    "we will use the same notation @xmath2 for the measure @xmath508 .",
    "this will hopefully create no confusion as all our estimates will only depend on the doubling constants which are the same for both measures .",
    "[ l.weighted ] let @xmath514 be a convex set contained in the unit cube @xmath515^n$ ] and @xmath2 be a doubling measure which is doubling with respect to euclidean cubes in @xmath25 with doubling constant @xmath511 .",
    "for every @xmath516 we have the estimate @xmath517 where @xmath518 .",
    "let @xmath283 be a positive integer and @xmath519 denote the dyadic cubes of sidelength @xmath520 , contained in @xmath513 and disjoint from @xmath514 .",
    "then @xmath521 where @xmath522 as @xmath523 and @xmath524 is as in lemma  [ l.weighted ] .",
    "suppose that @xmath525 and @xmath526 . then since the cubes @xmath527 have diameter less than @xmath528 we have that @xmath529 for some @xmath76 . thus @xmath530 using lemma  [ l.weighted ] and the previous inclusion we conclude @xmath531 which is the desired estimate with @xmath532 .",
    "some remarks are in order concerning lemma  [ l.weighted ] and its corollary above .",
    "if @xmath2 is replaced by the lebesgue measure then lemma  [ l.weighted ] appears in @xcite*lemma 2 and is one of the main ingredients for the proof of the lebesgue - measure analogue of lemma  [ l.taubassoc ] . in the lebesgue measure case ,",
    "lemma  [ l.weighted ] is a simple calculation that crucially depends on the fact that the lebesgue measure of an `` annulus '' around a convex set can be calculated as the sum of the @xmath533-dimensional hausdorff measures of the boundaries of an increasing sequence of convex sets .",
    "since the @xmath533-dimensional hausdorff measure of the boundary of a convex set contained in @xmath513 is at most @xmath534 this yields the desired estimate . under the presence of a general doubling measure the proof of such a result is more involved . in order not to divert the attention from the proof of lemma  [ l.taubassoc ] we postpone the proof of lemma  [ l.weighted ] until   [ s.proofoflemma ] .",
    "let @xmath13 be a set in @xmath25 , @xmath242 and @xmath80 .",
    "remember the notations @xmath535 and @xmath536 . in the following lemma we iterate the construction of lemma  [ l.weighted ] in order to get `` many '' disjoint homothetic copies of a convex set @xmath83 inside its associated rectangle @xmath271 , with diameters bounded away from zero and whose union captures a big portion of the measure of @xmath271 .",
    "[ l.homcopies ] let @xmath108 be a convex set in let @xmath540 be the associated rectangle of @xmath83 so that @xmath541 .",
    "let @xmath283 be a a large positive integer so that @xmath542 . for every positive integer @xmath385 there exists a set @xmath543 with the following properties :    *",
    "the set @xmath544 is a finite union of pairwise disjoint homothetic copies of @xmath83 .",
    "that is , @xmath545 , each @xmath546 is an homothetic copy of @xmath83 and the @xmath547 s are pairwise disjoint .",
    "* let @xmath548 be a homothetic copy of @xmath83 in @xmath544 and let @xmath549 be the associated rectangle of @xmath548 .",
    "then @xmath549 is a `` dyadic rectangle '' in @xmath70 which is at most @xmath550 generations inside @xmath71 .",
    "this means that @xmath551 for some non - negative integer @xmath552 .",
    "* for the @xmath2-measure of @xmath544 we have the estimate @xmath553 where @xmath554 .    by the discussion before lemma  [ l.weighted ] concerning affine invariance",
    "we can assume that @xmath555^n$ ] and @xmath556 .",
    "we will thus construct the set @xmath557 as in the statement of the lemma , assuming everything takes place inside the unit cube @xmath513 .",
    "let @xmath519 denote the pairwise disjoint cubes from lemma  [ l.weighted ] which satisfy @xmath558 .",
    "it is essential to note that @xmath537 depends only on the dimension , the doubling constant of @xmath2 and @xmath283 , and that @xmath559 as @xmath523 .",
    "remember that by lemma  [ l.convrect ] we have for every @xmath246 with associated rectangle @xmath271 that @xmath560 .",
    "since we have reduced everything to the case @xmath561 this means that we have @xmath562 for all the convex sets",
    "@xmath563 which are homothetic copies of @xmath514 and for @xmath564 being the associated cube of @xmath565 . throughout this proof ( and for the rest of the paper )",
    "we assume that @xmath283 is sufficiently large , depending upon the dimension , @xmath511 and @xmath170 only , so that @xmath566 .",
    "consider @xmath567 such that @xmath568 and set @xmath569 .",
    "observe that @xmath527 is the associated cube of the convex set @xmath570 , just like @xmath513 is the associated rectangle of @xmath514 .",
    "combining this observation with we see that @xmath571 and thus @xmath572 by lemma  [ l.weighted ] we estimate @xmath573 now @xmath574 and @xmath575 thus @xmath576 we call @xmath577 since this quantity will appear quite a lot in what follows .",
    "observe that @xmath578 .",
    "now let @xmath579 and @xmath580 .",
    "the previous estimate reads @xmath581 we iterate the estimate of lemma  [ l.weighted ] as follows : @xmath582 noting that the coefficient in front of @xmath583 is positive and using @xmath584 together with the lower bound for @xmath585 we can conclude @xmath586 thus @xmath587 satisfies @xmath588 we continue inductively .",
    "if @xmath589 has been defined and satisfies @xmath590 we can set @xmath591 and @xmath592 and in the same fashion we show that @xmath593 we conclude that for every positive integer @xmath385 we have @xmath594 .",
    "remember that @xmath603 .",
    "we begin by fixing @xmath283 large enough so that @xmath542 and @xmath604 for the previous inequality to be true it is enough to define @xmath283 so that @xmath605 this is always possible since @xmath606 and @xmath607 . with this value of @xmath283",
    "fixed we now let the positive integer @xmath385 be large enough so that @xmath608 a straightforward calculation shows that it is enough to take @xmath609 these values of @xmath283 and @xmath385 prove the statement of the lemma .",
    "let us assume that @xmath54 satisfies the tauberian condition for a fixed level @xmath42 and let @xmath610 .",
    "as in the proof of theorem  [ t.doubling ] any such @xmath326 will work equally well , but a concrete choice is @xmath611 .",
    "then the tauberian condition implies @xmath612 for any @xmath2-measurable set @xmath36 . for every @xmath613",
    "there exists a rectangle @xmath614 with @xmath615 and @xmath616 we will use the basic inclusion @xmath617 denoting @xmath618 we will show that @xmath619 for some positive integer @xmath446 .    to this end",
    "let @xmath620 be one of these rectangles .",
    "observe that there is some @xmath108 such that @xmath621 is the associated rectangle of the convex set @xmath83 and @xmath622 .",
    "we now consider the set @xmath544 as in lemma  [ l.homcopies ] with the choice of parameters @xmath597 provided by lemma  [ l.mn ] applied for @xmath623 .",
    "observe that we have @xmath624 and @xmath544 is a disjoint union of homothetic copies of @xmath83 inside @xmath271 , with each homothetic copy having associated a rectangle which is dyadic , and at most @xmath625 generations `` inside '' @xmath271 .",
    "we claim that for at least one of the homothetic copies of @xmath83 forming @xmath544 , say @xmath626 , we have @xmath627 indeed , if this is not the case then we would have @xmath628 which contradicts  .",
    "the previous claim just proved immediately implies that @xmath629    if @xmath630 is the associated rectangle of @xmath626 we get by the construction of lemma  [ l.homcopies ] that @xmath630 is a dyadic rectangle which is at most @xmath625 generations `` inside '' @xmath71 .",
    "thus @xmath631 . remembering that @xmath632 we arrive at @xmath633 from the doubling property of @xmath2 with respect to @xmath634 we now get that @xmath635    we define a nested sequence of homothetic copies of @xmath626 as follows .",
    ". assuming we have defined @xmath637 then we set @xmath638 where @xmath639 is chosen so that @xmath640 this is possible because of the continuity of the measure @xmath2 proved in ( iv ) of proposition  [ p.noboundarymass ] . here",
    "remember that @xmath641 denotes dilation with respect to the center of the john ellipsoid of @xmath626 .",
    "it is not hard to see that @xmath642 whenever @xmath395 .",
    "we define @xmath643 to be the smallest positive integer such that @xmath644 observe that for this it suffices to set @xmath645 with the choices of @xmath597 given by lemma  [ l.mn ] with @xmath623",
    ". then we claim that @xmath646 if this is not the case then necessarily @xmath647 since both sets in the previous inclusion are of the form @xmath641 and , as already observed , one must contain the other",
    ". this would imply @xmath648 which contradicts the choice of @xmath446 .",
    "now for every @xmath649 the choice in implies that @xmath650 iterating the previous inclusion we get @xmath651 by .",
    "it is now routine to complete the proof of theorem  [ t.convdoubling ] . indeed , suppose that @xmath54 satisfies for some fixed level @xmath42",
    ". then lemma  [ l.taubassoc ] implies that the associated operator @xmath490 satisfies .",
    "since @xmath265 is an homothecy invariant basis of rectangles and @xmath2 is doubling with respect to that basis , theorem  [ t.doubling ] implies that @xmath490 is bounded on @xmath56 for @xmath655 with @xmath656 depending on @xmath657 and the constant @xmath658 in the tauberian condition . by lemma  [ l.convrect ]",
    "the operators @xmath490 and @xmath54 are pointwise comparable .",
    "we conclude that @xmath54 is bounded on @xmath56 for @xmath655 .",
    "this section is dedicated to the proof of lemma  [ l.weighted ] .",
    "remember that @xmath515^n$ ] is the unit cube in @xmath25 and @xmath561 is a convex set and our purpose is to estimate the @xmath2-measure of the `` annulus '' @xmath659 .",
    "the estimate of the lemma is only interesting when @xmath660 is small so it is without loss of generality to assume that @xmath661 .",
    "we consider the larger cube @xmath662 which is the cube with the same center as @xmath513 and and sidelength equal to @xmath663 . now",
    "let us fix a positive integer @xmath664 such that @xmath665 .",
    "it obviously suffices to estimate the measure of the `` annulus '' @xmath666 let @xmath667 and consider @xmath668 such that @xmath669 . let @xmath670 be a supporting hyperplane through @xmath7 and @xmath671 be the half space defined by @xmath670 and such that @xmath672 .",
    "we now consider the half line @xmath673 which is emanating from the point @xmath7 , is perpendicular to @xmath670 and is contained in @xmath671 , and suppose that @xmath673 meets @xmath674 at some point @xmath675 . since @xmath676 and @xmath673 is perpendicular to @xmath670 , we have for @xmath677 : @xmath678    thus we can conclude @xmath679\\supset [ 0 , 1]\\end{aligned}\\ ] ] since @xmath680 .",
    "now let @xmath681 $ ] for some @xmath682",
    ". by the continuity of the distance function there exists @xmath683 such that @xmath684 .",
    "let @xmath685 denote the whitney cubes associated to @xmath514 and remember that these cubes satisfy @xmath686 here @xmath687 denotes the interior of a set @xmath688 .",
    "see for example @xcite*vi.1 for the details of the construction of the whitney cubes .",
    "since the whitney cubes cover @xmath689 and @xmath690 , there is a whitney cube @xmath691 such that @xmath692 .",
    "we then have that @xmath693 and on the other hand @xmath694 so that @xmath695 .",
    "thus the whitney cube @xmath696 satisfies @xmath697 by we also get that @xmath698 .",
    "remember that @xmath667 satisfies @xmath699 .",
    "an easy calculation now verifies that @xmath700 , where we remember that the dilation is taken with respect to the center of @xmath696 .",
    "we have actually shown that for every @xmath667 and every @xmath701 $ ] , there exists a whitney cube @xmath702 such that @xmath703 let @xmath704 denote the whitney cubes such that @xmath705 .",
    "observe that for different @xmath76 s the collections @xmath706 are disjoint .",
    "we can write for every positive integer @xmath707 @xmath708 and thus @xmath709 summing in @xmath710 yields @xmath711 with @xmath712 denoting the largest integer less or equal to @xmath299 . now all the whitney cubes @xmath374 that appear on the right hand side of the last display satisfy @xmath713 and @xmath714 , and thus they are all contained in @xmath715 .",
    "since the families @xmath706 are pairwise disjoint , and every family @xmath706 consists of pairwise @xmath2-a.e .",
    "disjoint cubes , the previous estimate implies @xmath716 since @xmath717 this completes the proof of lemma  [ l.weighted ] ."
  ],
  "abstract_text": [
    "<S> let @xmath0 be a homothecy invariant collection of convex sets in @xmath1 . </S>",
    "<S> given a measure @xmath2 , the associated weighted geometric maximal operator @xmath3 is defined by @xmath4 it is shown that , provided @xmath2 satisfies an appropriate doubling condition with respect to @xmath0 and @xmath5 is an arbitrary locally finite measure , the maximal operator @xmath3 is bounded on @xmath6 for sufficiently large @xmath7 if and only if it satisfies a tauberian condition of the form @xmath8 as a consequence of this result we provide an alternative characterization of the class of muckenhoupt weights @xmath9 for homothecy invariant muckenhoupt bases @xmath0 consisting of convex sets . moreover , it is immediately seen that the strong maximal function @xmath10 , defined with respect to a product - doubling measure @xmath2 , is bounded on @xmath6 for some @xmath11 if and only if @xmath12 holds for all @xmath5-measurable sets @xmath13 in @xmath1 . </S>",
    "<S> in addition , we discuss applications in differentiation theory , in particular proving that a @xmath2-weighted homothecy invariant basis of convex sets satisfying appropriate doubling and tauberian conditions must differentiate @xmath14 . </S>"
  ]
}