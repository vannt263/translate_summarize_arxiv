{
  "article_text": [
    "_ boundary alignment _ is a critical feature of meshes in many applications . in a boundary",
    "aligned mesh the boundary , or some other line , is traced by the sides of high - quality cells , see fig .",
    "[ fig : bound_align ] . the definition of a well - shaped  cell may be application dependent , but in many cases , cells similar in shape to squares ( for quadrilateral cells ) or equilateral triangles ( for triangles ) are preferred . characteristics of the entire mesh are also important , such as smooth cells - size and cell - shape transitions .",
    "[ ptb ]    the problem of producing boundary aligned meshes with well - shaped cells has been the subject of extensive research @xcite . still ,",
    "many popular algorithms are heuristic in nature , and a more general understanding of the subject is called for , especially when quadrilateral meshes are considered .",
    "a key difficulty is the problem s _ global _ character : the shape and position of every cell in the mesh is , at least in principle , related to that of any other cell .    in a previous work @xcite , we described a relation between the problem of two - dimensional unstructured mesh generation , on both planar and curved surfaces , and another well - known problem , namely the _ inverse poisson _ ( ip ) problem .",
    "the ip problem is concerned with reconstructing a _ source distribution _",
    "@xmath0 of the poisson equation @xmath1 , from information on the potential @xmath2 at the boundaries . in that work",
    ", the mesh was assumed to be _ conformal _ away from the irregular vertices ( vertices whose degree is different than four ) , like a grid mapped by a conformal mapping .",
    "such grids have the property of having square cells in the limit of an increasingly finer grid . under this assumption ,",
    "the problem of mesh generation was then shown to reduce to an ip problem .",
    "the irregular vertices of the mesh correspond to point sources ( delta functions ) of @xmath0 , and @xmath2 is interpreted as the logarithm of the local resolution .",
    "this theoretical framework turns the focus to the irregular vertices of the mesh : once their distribution is fixed , the continuum properties of the mesh - local resolution and directionality - are known .",
    "note that it is also an explicitly global formulation , since the resolution at any given point is affected , via the function @xmath2 , by the locations of all irregular vertices in the mesh",
    ".    in this paper the generation of planar quadrilateral meshes is discussed .",
    "resting on the results of @xcite , a new ip algorithm is presented , designed to construct source distributions of the appropriate type , which approximate the resolution and mesh directionality inputs at user - specified points , such as at the boundaries .",
    "the ip algorithm is then incorporated into a complete mesh generation scheme , which also includes a technique for generating the final mesh .",
    "an implementation is described , and shown in example cases to generate boundary aligned meshes , where well - placed point sources create smooth cell transitions and high quality cells .",
    "a similar procedure is probably applicable to triangular meshes , but is not discussed in the present work .",
    "remeshing of curved surfaces has recently attracted considerable attention ; for a review see @xcite .",
    "many of the algorithms receive an input mesh directionality throughout the surface , usually the principal curvature directions of the surface .",
    "this setting presents different challenges than those addressed here , since the mesh structure is determined , to a large extent , when mesh directionality is given everywhere in the domain .",
    "for example , the locations of critical irregular vertices are dictated by the mesh directionality in the _ vicinity _ of these points .",
    "another related subject is surface parameterization , concerned with creating mapping of surfaces to the plane .",
    "conformal surface parameterizations are created in @xcite , but boundary alignment is not addressed .",
    "the paper is organized as follows : section [ sec : ip_review ] shortly reviews the relevant theoretical background , with emphasis on the relation between the ip problem and unstructured mesh generation .",
    "sections [ sec : algorithm ] and [ sec : create_final ] describe the proposed ip algorithm , and the mesh generation scheme . section [ sec : implementation ] describes an implementation of the algorithm , and section [ sec : examples ] gives examples of meshes generated . conclusions and possible directions for future research",
    "are discussed in section [ sec : conclusions ] .",
    "in this section an overview of the background theory will be given .",
    "section [ sec : motivation ] explains the rationale underlying the mathematical formulation . in section [ sec : definitions ] , some key conformal geometry concepts are discussed , together with their relevance to the present problem .",
    "section [ sec : ip_background ] summarizes the results developed in @xcite , relating mesh generation with the ip problem .",
    "the exposition is limited to planar two - dimensional mesh generation ; a detailed account , in the more general setting of curved surfaces , can be found in @xcite .",
    "we start by considering mesh generation using conformal mappings , which can be viewed as a special case of the theory to be described .",
    "mapping techniques , in general , construct a function from one domain , for which a mesh already exists , to a second domain , which is being meshed . the mapping function",
    "is then used to map the mesh into the second domain .",
    "a key idea is that continuum properties of the mapping function control the shapes of the cells of the new mesh , at least for small enough cells .",
    "for example , if the mapping is conformal , i.e. angle preserving , a cell with right inner angles ( rectangle ) will be mapped to a target cell with approximately right inner angles .    in unstructured mesh generation",
    "the connectivity of the mesh is not known in advance , and a more general framework is called for . in what follows ,",
    "the interplay between the two domains which serves as a paradigm of mapping techniques , is replaced with an interplay between two definitions of distances on the input domain . instead of imagining the mesh as being the image of a mesh on a different domain , we _ redefine the distances _ on the domain to be meshed , and _",
    "fix the cell edge length_. thus , the local mesh resolution will be proportional to the new local distance definition : a large new distance between two given points will mean more cells will be placed in between , hence a higher local resolution .",
    "distances are redefined using the concept of a _ metric _ , known from riemannian geometry .    since we focus on cells which are squares in the limit of an increasingly finer mesh , we need to define only two local properties : the resolution ( inverse of cell - size ) , and the direction of the  cell - edges .",
    "the new resolution , as noted before , is  controlled by a new distance definition .",
    "we use a new distance which is localy a scaling  of the old distances : the new distance between a point and other nearby points is equal to the old distance , multiplied by a scalar factor which is independent of the direction .",
    "thus , a small square measured in one distance definition is also ( approximately ) a square according to the new distance definition .",
    "in riemannian geometry terminology , the old and new metrics are said to be _ conformally related_. the mesh directionality is related to the resolution , as is described in the following section .",
    "it is convenient to work with a function @xmath3 , defined as the _ logarithm _ of the local scaling factor .",
    "that is , a small square of side length @xmath4 measured with the original , cartesian distance definition , is a square with side length @xmath5 as measured with the new distance definition , see fig .",
    "[ fig : lay_grid1],a .. if we imagine that the domain is covered with many small squares , all with the same side length @xmath6 in the new distance definition , the size of these cells in the original distance definition will be @xmath7 . the ( local ) resolution is the inverse of the local - cell - size , hence @xmath8 where the proportionality constant is a single number for the whole mesh .",
    "the second continuum property is the local directionality of the cell edges .",
    "the edges should ideally meet at right angles everywhere , except at _ irregular vertices _ , where the number of edges incident on the vertex is different than four .",
    "it is therefore natural to assign to every point a set of four directions , mutually parallel or perpendicular .",
    "this concept was expressed by many authors , and given various names , such as _ mesh directionality _",
    "4-symmetry direction field _",
    "@xcite , and _ frame field _ , although the last may refer to a structure which  also holds cell - size information @xcite .",
    "graphically , this object can be represented by a cross at every point , see fig .",
    "[ fig : lay_grid1],a . , and here will be called a _ cross - field _ @xcite . on the plane",
    ", the cross direction can be measured by the angle @xmath9 from the @xmath10-axis to one of the directions of the cross .",
    "this angle is fixed up to an addition of @xmath11 radians , i.e. @xmath12 represent the same cross iff @xmath13 , for some integer @xmath14 .",
    "[ ptb ]    the function @xmath2 and the cross - field are not unrelated ; due to conformality , lines that trace the edge directions bend towards the side with smaller cells , see fig . [",
    "fig : lay_grid1],a .. in the continuum theory , these lines  are known as _",
    "geodesics _ of the manifold .",
    "geodesics are a generalization of the concept of straight lines to non - euclidian geometries . in the original , cartesian coordinates , the geodesic obeys the following differential equation : @xmath15 where @xmath16 is the curvature of the geodesic in the cartesian coordinate system , and @xmath17 is the derivative of the function @xmath2 in the direction normal to the tangent , see fig .",
    "[ fig : lay_grid1],b .. eq . ( [ eq : kappa_dphi_dn ] ) allows one to calculate the change in the direction of the cross - field between two points connected by a geodesic .",
    "there is also a direct way of calculating the change in the direction of a cross - field between any two points , along any curve connecting the two points , known as _ parallel - transport_. let @xmath18 be some curve from point @xmath19 to point @xmath20 , and let @xmath21 be the angles of the crosses at points @xmath19,@xmath20 respectively ( as noted above , the angles are defined up to an addition of a @xmath11 radians ) .",
    "then @xmath22 where the integration denotes a line integral along the curve @xmath18 , according to the length parameter @xmath23 on @xmath18 , as measured in the original coordinate system .",
    "the differential formulation of this equation is @xmath24 where @xmath25 are a pair of perpendicular vectors that form a right hand system .",
    "where the function @xmath2 is defined , that is , at any point in the domain that is not a singularity , @xmath2  can be shown to _",
    "harmonic _ , that is to obey the laplace equation : @xmath26 where , again , the derivatives are taken with the original coordinate system .",
    "( [ eq : kappa_dphi_dn],[eq : phi_laplace ] ) are well - known results of conformal geometry @xcite,@xcite .",
    "( [ eq : theta_change_par_tranport ] ) is derived in @xcite      equations ( [ eq : kappa_dphi_dn],[eq : phi_laplace ] ) fully describe the relations between the cross - field and the function @xmath2 , at any regular point of the domain , that is , any point that is not a singularity of the function @xmath2 .",
    "the singularities of the function @xmath2 are a key ingredient of the theory , since they correspond to the irregular vertices of the mesh , and unstructured meshes are those which contain irregular vertices . a detailed analysis of the possible of singularities of the harmonic function @xmath2 , and their effect on the resulting mesh , was carried out in @xcite , and shows that the only type of singularity that corresponds to a mesh with a finite number of cells is of the type @xmath27 , where @xmath28 is the location of the singularity . in the ip literature , such a sigularity is known as a _ point source_. furthermore , the prefactor of the logarithm is directly related to the degree of the irregular vertex in the final mesh . more specifically , suppose there are @xmath29 singularities in a domain @xmath30 , at points @xmath31 , then the function @xmath2 can be written as    * condition 1 : * @xmath32 where @xmath33 is a harmonic function , @xmath34 , and @xmath35 .",
    "the numbers @xmath36 are known as _ charges _ , so condition 1 states that the charges are integer multiples of @xmath11 .",
    "we will refer to the numbers @xmath37 simply as the @xmath38 -values  of the singularities .",
    "the degree ( number of incident edges ) of the irregular vertex corresponding to the source at @xmath39 is equal to @xmath40 .",
    "so , for example , irregular vertices of degrees 3 and 5 will correspond to a singularities with @xmath41 and @xmath42 , respectively .    in a geometrical context",
    ", a logarithmic singularity of @xmath2 represents a _ cone - point _ - the tip of a cone - in the new distance definition .",
    "the charge corresponds to the angle deficit of the tip of the cone .",
    "related subjects where manifolds with cone - points are considered include the study of disclinations in elastic media @xcite , and surface parameterizations @xcite .",
    "an unstructured mesh is required to be aligned with the boundary .",
    "namely , that one of the cross directions be parallel to the tangent to the boundary ( where a tangent exists ) :    * boundary alignment definition : * @xmath43 where @xmath44 is a curve tracing the boundary , @xmath45 and @xmath46 .",
    "since @xmath9 is fixed up to an addition of a multiple of @xmath11 radians , this definition depends only on the cross - field itself , and not on the particular choice of @xmath9 .    requiring boundary alignment , as defined in eq .",
    "( [ eq : bound_align ] ) can be shown to be equivalent to three more conditions on the function @xmath2 @xcite .",
    "the following , condition 2 , applies to a point on a smooth section of the boundary , @xmath47 .",
    "it roughly states that a smooth section of the boundary is a geodesic .",
    "this provides information on the derivative of @xmath2 normal to the boundary :    * condition 2 : * @xmath48 @xmath16 is the boundary curvature at @xmath49 .",
    "the next condition is concerned with _ junction points _ of the boundary , where the tangent to the boundary is discontinuous .",
    "it assures that the cross - field will be aligned with the boundary on both sides of the junction point .",
    "let @xmath18 be a curve from point @xmath19 to point @xmath20 on both sides of a point @xmath50 of the boundary , see fig .",
    "[ fig : cond_3_4],b .. then    * condition 3 : * @xmath51 where @xmath52 is the angle of the boundary , and @xmath46 .",
    "this means that for some inner angles @xmath2 will contain a singularity at @xmath50 ; at a distance @xmath53 from @xmath50 , the singularity will be of type @xmath54 .",
    "[ ptb ]    the final condition is concerned with the relation between two different boundary components .",
    "it is just a restatement of eq .",
    "( [ eq : theta_change_par_tranport ] ) for two points on two different boundary segments .",
    "* condition 4 : *    let @xmath19,@xmath20 be two points on two boundary curves @xmath55 .",
    "let @xmath18 be a curve from @xmath19 to @xmath20 .",
    "then @xmath56 conditions 1 - 4 form a complete set of conditions on @xmath2 , for a cross - field that is boundary aligned to exist .",
    "that is , conditions 1 - 3 , and condition 4 on a number of selected curves , one from a selected point to each boundary component , are sufficient for a boundary aligned cross - field to exist , see @xcite .",
    "the mesh generation scheme consists of the following steps :    1 .",
    "setup and solution of the ip problem . finds the sources locations and charges . described in sections [ sec : input]-[sec : calc_locations ] .",
    "solution of the direct poisson problem , to obtain the functions @xmath57 throughout the domain , see section [ sec : restore_harmonic ] .",
    "generation of the final mesh , see section [ sec : create_final ] .",
    "suppose that we are given an open domain @xmath30 , with boundary @xmath47 , and are given the required resolution function on @xmath47 .",
    "( [ eq : phi_is_log_res ] ) , this is readily translated to the required value of @xmath2 on the boundary : @xmath58    condition 1 ( eq . ( [ eq : cond1 ] ) ) is a solution of the poisson equation @xmath1 , with point sources , whose locations and charges are yet unknown .",
    "the problem is to find a distribution of sources ( location and charge ) adhering to the boundary alignment definition , eq .",
    "( [ eq : bound_align ] ) , or alternatively to conditions 2 - 4 ( eq .",
    "( [ eq : cond2])-([eq : cond4 ] ) ) , as well as to eq .",
    "( [ eq : phi_from_res ] ) .",
    "such a problem is known as an _ inverse poisson _ ( ip ) problem .",
    "the ip problem may be compared with the _ direct poisson _",
    "problem , where the source distribution is given , as well as some boundary information ( e.g. , dirichlet or newmann boundary conditions ) , and the value of the function @xmath2 is to be found . in the ip problem ,",
    "the source distribution is unknown , and a source distribution adhering to the known boundary information is to be found .",
    "ip problems have important applications in various areas of science and engineering @xcite,@xcite,@xcite,@xcite , @xcite . by its nature , the ip problem is ill - posed , and the solution might not be unique , and may be sensitive to small changes of the input , such as small changes in boundary conditions . in delicate problems of this type ,  any prior information on the source distribution may greatly affect the applicability of a specific solution procedure . in the present problem , we seek a point source distribution",
    ". a number of algorithms for solving an ip problem with point sources appear in the literature . in @xcite , an inverse problem where all sources have the same charge is solved . in our implementation , however , at least two different charge values must be incorporated ( @xmath59 ) . in @xcite,@xcite,@xcite an inverse problem where both the locations of sources and their charges are unknown , and",
    "are reconstructed .",
    "this gives more freedom in the reconstruction than we can allow , since for the present purposes the charges must be multiples of @xmath11 .",
    "another important aspect of the present problem is that the domain of the ip problem may be of any shape and topology ( i.e. , may contain holes ) , whereas the above works only deal with a simply connected region ( a circle , usually ) .",
    "it is important to note that in the present application , in contrast to other standard applications , the input to the ip problem is not generated by some existing source distribution ( perhaps with some added noise ) , but by the domain s shape and input resolution .",
    "the existence of a source distribution which reconstructs the input data , at least approximately , is therefore not obvious .",
    "this is an interesting and important subject , but is beyond the scope of the present work .",
    "as is well known , the real and imaginary parts of a complex analytic function are harmonic functions @xcite .",
    "this correspondence has been utilized in ip algorithms @xcite,@xcite,@xcite , and will be used here as well .",
    "we define the complex - valued function    @xmath60    where @xmath61 , with @xmath62 the components of @xmath63 , that were defined in condition 1 .",
    "@xmath4 is a function on @xmath30 , such that @xmath64 then , recalling that @xmath65 , it follows that @xmath66 with @xmath3 defined in condition 1 , and @xmath67 , with @xmath68 .    the functions @xmath69 and @xmath70 for some @xmath71  are analytic in a neighborhood of any point that is not a singularity of @xmath2 .",
    "however , as functions over the entire domain @xmath30 , they may be _ multi - valued_.  multi - valued functions accept many - values at a point , depending on the path taken to that point .",
    "it is well known that the complex function @xmath72 is multi - valued . defining @xmath73 as @xmath74 , where @xmath75 is a path from @xmath76 to @xmath77 , the imaginary part of @xmath72",
    "is only fixed up to an addition of multiples of @xmath78 , depending on the path taken .",
    "if the domain @xmath30 is not simply - connected ( i.e. , contains holes ) , then the function @xmath69 may also be multi - valued , since by following different paths around the holes , different values of @xmath79 may be obtained .",
    "the function @xmath80 , being a sum of multi - valued functions , may also be multi - valued . according to eq .",
    "( [ eq : re_f_is_phi ] ) , the real part of @xmath81 is single - valued , as it is equal to @xmath2 at that point .",
    "we thus turn to examine the imaginary part of @xmath81 .",
    "the real and imaginary parts of a complex function are related by the cauchy - reimann ( cr ) equations @xcite .",
    "recall that for a complex differentiable function @xmath82 , where @xmath83 are real - valued , the cauchy - reimann equations read @xmath84 , and @xmath85 .",
    "this allows one to recover the imaginary part of a analytic function if its real part is given .",
    "writing eq .",
    "( [ eq : phi_theta_right_hand_relation ] ) in the two right hand coordinate systems @xmath86 , gives the relations @xmath87 and @xmath88 .",
    "these are precisely the cr equations for the complex function @xmath89 , where @xmath90 is any real constant , hence @xmath91 the constant @xmath90 is arbitrary , and will be taken to be zero .",
    "the multi - valued nature of @xmath81 is explicit in the integral formulation in eq .",
    "( [ eq : f_is_phi_i_theta ] ) . the right - hand - side ( rhs ) of eq .",
    "( [ eq : f_is_phi_i_theta ] ) shows that the since the imaginary part of @xmath81 is @xmath92 , and @xmath9 must be fixed up to additions of @xmath11 , then the integral @xmath93 must also be fixed up to additions of @xmath11 . indeed ,",
    "this was shown to hold if conditions 1 - 3 ( eq .",
    "( [ eq : cond1])-([eq : cond3 ] ) ) hold , see @xcite .    to summarize ,",
    "the problem is restated as finding a multi - valued complex function @xmath81 , given by eq .",
    "( [ eq : f_def ] ) , and whose value at points on the boundary of @xmath30 is : @xmath94    in the following sections , an algorithm for solving the problem as it was here restated is described .",
    "the ip algorithm first removes the contribution of @xmath69 from the boundary conditions , paying special attention to the junction points , and then constructs the source distribution .",
    "the function @xmath2 , and hence the function @xmath81 , may be singular at junction points .",
    "special procedures for addressing this behavior are taken as part of two different steps of the algorithm :    a. : :    choosing the input resolution near junction points .",
    "b. : :    special treatment of junction points when @xmath4 is removed    from the boudary conditions .",
    "the two subjects are discussed in the following subsections , [ sec : input_near_junc ] and [ sec : remove_harmonic_junc ] .      except in the special cases when @xmath52 is a multiple of @xmath11 , the behavior of @xmath2 at a small neighborhood in @xmath30 of a junction point is singular , with the singularity at the junction point ,",
    "see condition 3 ( eq . ( [ eq : cond3 ] ) ) .",
    "if the input resolution in a small neighbourhood of the junction point does not match this singular behavior , solution of the ip problem will feature sources at any distance from the junction , no matter how small , resulting in a distribution with an infinite number of sources . in practice , this means that an ip algorithm will cluster many sources near the junction point , in a futile attempt to reconstruct the boundary conditions there . to avoid this problem ,",
    "we adjust the _ input _ @xmath2 at a neighborhood of the junction point",
    ". this adjustment should vanish rapidly at a distance larger than 1 - 2 cell - sizes , so as to have little effect on the original required resolution .",
    "condition 3 states that the gradient of @xmath2 near a junction point must diverge as @xmath95 , where @xmath53 is the distance from the junction point .",
    "such a flux is formed by a logarithmic singularity at the junction point ( see also @xcite , section 7.1 ) .",
    "consider a singular source term of the form @xmath96 , where @xmath53 is the distance from the junction point .",
    "then the flux through a circular arc @xmath97 , at distance @xmath53 from the junction point is ( see also fig . [",
    "fig : cond_3_4],a . ) : @xmath98 where @xmath52 is the junction inner angle .",
    "then by condition 3 , @xmath99 , hence @xmath100 @xmath101 is integer , which must be positive , otherwise a mesh with an infinite number of cells will result ( @xcite , section 7.1 ) .",
    "in fact , @xmath101 has a simple interpretation : it is the number of cells incident upon the junction point in the resulting mesh ) nearby cone - points may be joined , and cone - points may be shifted to the boundary , depending on the final cell - size .",
    "in such a case , the number of cells incident on a junction point , as well as on other boundary points , may change . ] .",
    "a reasonable choice for @xmath101 is therefore @xmath102 for which the inner angles of the cells incident on the junction point are closest to @xmath11 .    in order to restrict the effect of this correction of @xmath2 to a small region in @xmath30 , a source term with the opposite charge @xmath103",
    "can be placed _ outside _",
    "@xmath30 , at a distance of about 1 - 2 edge lengths .",
    "see for example the second and third examples in section [ sec : examples ] .      in section [ sec :",
    "remove_harmonic ] a method will be described for calculating and removing the contribution of @xmath69 to the boundary conditions . at junction points ,",
    "however , the function @xmath79 may be singular : as @xmath30 is an open set , boundary singularities are part of @xmath69 , so care should be taken when preforming the calculations described in section [ sec : remove_harmonic ] , especially in a numerical implementation of the technique .    to avoid these problems",
    ", we subtract the junction singularities from the boundary value of @xmath80 before proceeding with removing @xmath69 .",
    "let @xmath104 be the locations of the junction points , and @xmath105 the charges as given by eq .",
    "( [ eq : junc_charge ] ) , ( [ eq : junc_incidence ] ) .",
    "the complex function corresponding to @xmath106 is @xmath72 , so the contribution of the junctions is @xmath107    if a singularity is located on an inner boundary component , the logarithms must contain a branch cut somewhere in @xmath30 . in order to avoid adding a cut , we add another term to every hole , equal to minus the total charge  in each hole .",
    "denote the inner boundaries by @xmath108 , and let @xmath109 be arbitrary points inside the respective holes .",
    "the following terms are therefore added to @xmath80 : @xmath110 in this way , the additional terms form an analytic function in @xmath30 , with no branch cut , and are a part of @xmath69 .",
    "since the contribution of @xmath69 is removed from @xmath80 as described in the next section , the exact form of this additional term , i.e. the choice of points @xmath111 , does not affect the results .      in this section a technique for calculating @xmath69",
    "is presented .",
    "after @xmath69 is calculated , its contribution to @xmath80 at the boundary can be subtracted . to simplify notation ,",
    "let @xmath112 denote the sum of logarithms in @xmath113 : @xmath114    in the context of ip algorithms , the idea that the contribution of the harmonic part to the solution can be removed from the boundary information was suggested in @xcite .",
    "there , an ip problem in the unit disk @xmath115 is discussed .",
    "the value of the analytic part of @xmath80 on the boundary of @xmath115 can then be calculated by taking the fourier transform of @xmath80 , and leaving only the positive frequency components , as can be shown by considering the lourent series of @xmath80 in the unit disk . by its construction",
    ", this technique applies to functions defined on the unit disk .",
    "it can be extended to other domains , if a conformal mapping of the domain to the unit disk ( which exists according to the riemann mapping theorem ) is calculated . for our present purposes , since the domain @xmath30  in every problem input is different , using this technique would require constructing a mapping to the unit disk for each domain being meshed separately . furthermore , the domains in our problem may contain holes , which further complicates the matter .",
    "we therefore use an alternative approach , which is now described .",
    "it is based on the cauchy integral theorem , and is similar to the sum factorization  step in the weiner - hopf technique @xcite , applied to a bounded domain ( @xmath116 , defined below ) in place of an infinite strip .    as in @xcite , we assume there is a positive distance @xmath117  between the boundary of @xmath30 and the source closest to it , as is the case , for example , when the number of sources is finite . let @xmath116 be the set of points at a distance smaller than @xmath117 to the boundary , see fig .",
    "[ fig : cauchy],a .. as will become apparent later , the value of @xmath117 does not enter the calculation and is irrelevant , as long as there exists some @xmath118 as required .",
    "[ ptb ]    we first consider a simply - connected domain @xmath30 , with boundary @xmath47 .",
    "define the flux through any curve @xmath18 : @xmath119 the flux @xmath120 through the boundary can be calculated : the value of @xmath17 at smooth boundary points is known from condition 2 ( eq .",
    "( [ eq : cond2 ] ) ) , and the flux at junction points is calculated from condition 3 , as is explained in section [ sec : input_near_junc ] above .",
    "this flux can be shown to be a multiple of @xmath11 .",
    "[ remark : flux_calc]using conditions 2,3 and the fact that the rotation of a tangent in a simple curve is @xmath121 , the total flux through a boundary component @xmath122 can be shown to be equal to @xmath123 , where @xmath124 are the junction points , @xmath125 for each junction is given by eq .",
    "( [ eq : junc_incidence ] ) , and @xmath126 for inner and outer boundary components , respectively .",
    "see also @xcite .    to proceed with the decomposition calculation",
    ", we assume that @xmath127 , as calculated from eq .",
    "( [ eq : bound_flux_def ] ) above .",
    "if this is not the case , following @xcite , we subtract a source term to the boundary conditions , centered at some point @xmath128 inside the domain : @xmath129 such that @xmath120 is zero .",
    "as will be shown below , the choice of @xmath128 does not affect the results . since @xmath120 was equal to a multiple of @xmath11 before , @xmath130 . when @xmath131 , the function @xmath80 is single - valued and analytic in @xmath116 , as follows from the integral representation of @xmath80 in eq .",
    "( [ eq : f_is_phi_i_theta ] ) , along with @xmath131 .",
    "we now use the cauchy s theorem , stating that for every point @xmath132 : @xmath133 the boundary @xmath134 of @xmath116 has two boundary connectivity components : the outer boundary ( which is also the boundary of @xmath30 ) , and the inner boundary . denote them by @xmath135 and @xmath136 respectively , see fig .",
    "[ fig : cauchy],a .. eq . ( [ eq : cauchy_d_simply_con ] ) now reads @xmath137 the function @xmath138 is harmonic on @xmath116 .",
    "according to a decomposition theorem ( see @xcite , chapter 9 ) its decomposition into @xmath139 and @xmath140 , is also unique .",
    "it follows that the decomposition of the multi - valued complex function @xmath81 into @xmath141 and @xmath4 is unique , up to the arbitrary constant @xmath90 in eq .",
    "( [ eq : f_is_phi_i_theta ] ) , chosen before to be zero .",
    "the two integrals expressions on the rhs of eq .",
    "( [ eq : cauchy_on_omega ] ) correspond exactly to the two components of the ( unique ) decomposition of @xmath80 in @xmath116 as described in @xcite , hence @xmath142 where we have used the fact that @xmath143 .",
    "we would like to find @xmath141 on @xmath47 , but @xmath136 is not known , nor is @xmath80 on @xmath136 , so @xmath112 can not be computed directly from the second equation .",
    "the first equation can however be used , since @xmath80 is given on @xmath47 , so @xmath69 can be calculated on @xmath47 ( more precisely , since @xmath4 is defined in @xmath30 , it is the limit of @xmath4 as @xmath47 is approached ) .",
    "then @xmath112 on @xmath47 is given by @xmath144 , according to eq .",
    "( [ eq : fp_def ] ) .    finally , we add back the source term subtracted before @xmath145    we now turn to the case when @xmath30 is not simply - connected .",
    "we add source terms : one inside the domain , as discussed above ( eq . ( [ eq : source_in_d ] ) ) , and one inside every hole ( i.e. _ outside _",
    "@xmath30 ) , such that the flux @xmath146 through every boundary connectivity element is zero , see fig .",
    "[ fig : cauchy],b .. @xmath147 the @xmath111 can be the same points used in section [ sec : remove_harmonic_junc ] , or other points .",
    "the results do not depend on the additional charges locations , as will be explained below .",
    "we now introduce cuts so that the boundary contains a single connectivity element ( the cuts play a part in the derivation , but drop out of the final calculation ) , see fig .",
    "[ fig : cauchy],b .. the cuts introduced also serve as the branch cuts of the logarithms .",
    "denote this new boundary @xmath148 .",
    "using @xmath149 , we proceed as when @xmath30 is simply connected : define @xmath116 as before , see fig .",
    "[ fig : cauchy],b . , and subtract the source term inside @xmath30 , as in eq .",
    "( [ eq : source_in_d ] ) . according to eq .",
    "( [ eq : cauchy_2_parts ] ) : @xmath150 the second integral on the rhs denotes the integral over the cuts introduced to form @xmath149 .",
    "note that each cut - path is traversed twice , back and forth .",
    "since the flux @xmath146 through each and every hole boundary is zero , the value of @xmath151 , when integrated along @xmath149 , is continuous across the branch cuts , and the integrations over each cut traversed in both directions cancel each other , and drop from the total integration .",
    "therefore @xmath152 as in eq . ( [ eq : cauchy_2_parts ] ) . as before , @xmath144 .",
    "finally , the source term inside @xmath30 is added back , as in eq .",
    "( [ eq : source_in_d_back ] ) .",
    "the boundary value of @xmath141 obtained after this source term is added back may be multi - valued , with a branch cut discontinuity in the imaginary part that is a multiple of @xmath11 .",
    "this is a valid input to the next step , as explained in section [ sec : calc_locations ] below ( following eq .",
    "( [ eq : xsi_def ] ) ) .",
    "the choice of the added singularities locations outside @xmath30 ( inside the holes ) does not affect the results : changing the location of a singularity with some charge  from @xmath153 to @xmath154 is equivalent to adding a singularity with opposite charge at @xmath153 , and with the same charge at @xmath154 . since these two singularities lay outside @xmath116 , and",
    "are of opposite charge , this amounts to adding an analytic function to @xmath81 , which is removed by the cauchy integral technique described above .",
    "the result is also unaffected by the location @xmath128 of the source term subtracted inside @xmath30 , since its location only affects the @xmath141 and it is later added back . the choice of cuts in eq .",
    "[ eq : cauchy_with_cuts ] , of course , does not affect the cauchy integral calculation , since the cuts do not enter the final calculation , eq .",
    "( [ eq : cauchy_final_calc ] ) .      at this point",
    ", we are given the value of @xmath112 on the boundary @xmath47 of the domain @xmath30 .",
    "( [ eq : f_def ] ) , we define @xmath155 = \\exp\\left [ { \\displaystyle\\sum\\limits_{m=1}^{n_{c } } } k_{m}\\ln\\left (   z - z_{m}\\right )   \\right ]   \\text{.}\\label{eq : xsi_def}\\ ] ] note that while @xmath141 may be have a multi - valued imaginary part with a branch cut discontinuity : @xmath156 , for some integer @xmath14 , @xmath157 is single valued , since @xmath158   = 1 $ ] .",
    "since the @xmath38-values , @xmath37 , are integers , we can assume without loss of generality that @xmath159 .",
    "other charges may be formed by placing several sources at the same location .",
    "we can therefore write eq .",
    "( [ eq : f_def ] ) as : @xmath160 where @xmath161 are the number of sources with @xmath162 respectively .    according to the divergence theorem",
    ", the difference @xmath163 is equal to @xmath164 ( this can also be shown directly by calculating the integral of @xmath141 along @xmath47 ) .",
    "since @xmath120 is known ( see also remark [ remark : flux_calc ] ) , @xmath163 is known .",
    "therefore , to fix @xmath161 only one number remains to be chosen , e.g. @xmath165 .",
    "the choice of the total number of sources affects the accuracy of the reconstruction of the input data , see sections [ sec : ipsummary ] and section [ sec : implementation].[remark : divergence ]    substituting eq .",
    "( [ eq : fp_only_plus_minus ] ) , eq .",
    "( [ eq : xsi_def ] ) now reads @xmath166    in eq .",
    "( [ eq : rational_roots ] ) , the numbers @xmath167 are the roots of polynomials , and we proceed by presenting the polynomials in a different form . later ,",
    "once the polynomials are found , the @xmath168 are recovered by finding the roots of the polynomials .",
    "we rewrite eq .",
    "( [ eq : rational_roots ] ) as @xmath169 where @xmath170 are unknown coefficients .",
    "note that the prefactors of @xmath171 are indeed equal to @xmath76 , as can be seen by expanding the polynomials in eq .",
    "( [ eq : rational_roots ] ) . to find the unknown coefficients numerically , we discretize eq .",
    "( [ eq : rational_standard_poly ] ) , and give @xmath157 at @xmath172 points @xmath173 , @xmath174 , and write @xmath175 : @xmath176 the rhs of eq .",
    "( [ eq : rational_discrete ] ) is a _ rational function interpolation _ of the @xmath177 data ( see e.g. @xcite ) . in the implementation described below ,",
    "the unknowns @xmath178 are evaluated as follows . rearranging , eq .",
    "( [ eq : rational_discrete ] ) reads @xmath179 these are @xmath172 linear equations for the @xmath165 unknowns : @xmath178 .",
    "since @xmath172 will typically be larger than @xmath165 , the solution will only be approximate , e.g. , a solution in the least - mean - square ( lms ) sense .    once the unknown variables @xmath178 are found , the source terms locations @xmath180 are calculated by finding the roots of the two polynomials appearing in the rhs of eq .",
    "( [ eq : rational_discrete ] ) .    a solution in the lms sense , as described in eq .",
    "( [ eq : linear_system ] ) , is not recommended if the resulting errors in the @xmath177 s are large , when compared with @xmath177 .",
    "this is due to two reasons : first , the input data @xmath177 appears in both sides of eq .",
    "( [ eq : linear_system ] ) , so the errors in the lms  solution might not reflect the errors in @xmath177 , and moreover , the lms  solution may be sensitive to the choice of the coordinate system origin .",
    "secondly , an error in @xmath177 scales as a difference in the resolution ( since @xmath181 ) , rather than the more natural  error definition given by the _ ratio _ of input and obtained resolution .",
    "this means that at low resolutions ( large cell - sizes ) , errors in @xmath182 might represent large relative resolution deviations .",
    "once the sources locations have been determined , the function @xmath2 can be calculated everywhere in the domain .",
    "the solution will usually be approximate , i.e. , the resulting sum of sources will only approximate the required @xmath183 , and some deviation from both boundary alignment and resolution requirements may be found . the trade - off between the two requirements",
    "can be  partly controlled by choosing an appropriate harmonic @xmath33 in eq .",
    "( [ eq : cond1 ] ) . in order to satisfy the cell - size requirements exactly",
    ", one can solve the ( direct ) poisson equation , given by eq . ( [ eq : cond1 ] ) , but this time with a known charge distribution , and with dirichlet boundary conditions , i.e. by specifying @xmath2 on the boundary .",
    "a different approach is to try and satisfy the boundary alignment conditions , by solving eq .",
    "( [ eq : cond1 ] ) with newmann boundary conditions .",
    "this gives a new @xmath2 on the boundary .",
    "the difference between the input ( required ) @xmath184 , and the @xmath2 obtained on the boundary can be used to evaluate the quality of the source distribution calculated by the ip algorithm , and the total number @xmath165 of sources can be changed accordingly . note that when @xmath30 is not simply connected , solving @xmath33 with neumann boundary conditions ( condition 2 ) does _ not _ mean that exact boundary alignment is obtained , because condition 4 might not be exactly fulfiled .",
    "the steps followed in calculating the source distribution ( locations and charges ) can be summarized as follows :    1 .",
    "adjusting  the input resolution near the junction points ( section [ sec : input_near_junc ] ) .",
    "2 .   subtracting the junction source terms ( sections [ sec : remove_harmonic_junc],[sec : remove_harmonic ] ) .",
    "@xmath185 3 .   calculating the cauchy integral to find @xmath69 on the boundary .",
    "finding @xmath183 on the boundary .",
    "( section [ sec : remove_harmonic ] ) .",
    "adding back the source inside @xmath30  ( section [ sec : remove_harmonic ] ) : @xmath186 5 .   calculating the locations of sources ( section [ sec : calc_locations ] ) , using some initial total number of sources @xmath165 .",
    "6 .   solving the ( direct ) poisson problem to find the new @xmath81 approximating the original @xmath81 .",
    "according to the quality of reconstruction , step 5 can be repeated with a different total number of charges .",
    "once the function @xmath187  is set throughout the domain , the final mesh can be constructed .",
    "there are various possible approaches to this problem .",
    "we present a simple method that was used to create the examples in section [ sec : examples ] . in this method",
    ", the domain is cut along geodesics that follow the cross - field directions .",
    "every source is at the end of a cut , and every inner boundary component is connected to the outer boundary by a cut , see fig .",
    "[ fig : mapping_sketch],a .. the direction of the geodesics emanating from the sources and directed along the cross - field are calculated as explained in appendix a. the cut domain , which we denote by@xmath188 , does not contain any sources in its interior , and its boundary consists of a single connected component .",
    "a conformal mapping @xmath189 of @xmath190 into the plane can be constructed , with a conformal factor ( local scaling ) of @xmath191 .",
    "we consider @xmath190 and @xmath192 as lying in the complex plane .",
    "first , note that since @xmath190 contains no sources in its interior and is simply - connected , @xmath193 is uniquely defined in @xmath190 .",
    "denote by @xmath194 this single - valued  @xmath193 . to calculate the mapped boundary @xmath192",
    ", we calculate the function @xmath195 along the ( single ) boundary @xmath196 of @xmath190 : @xmath197    [ ptb ]    if this mapping is used to create a mesh , by placing a cartesian grid on @xmath192 , and mapping it back to @xmath190 by taking the inverse of @xmath189 , the mesh obtained will be invalid : the grid will  not be continuous across the cuts , will contain invalid cells at the sources , and cut cells at the boundaries . to correct this , and obtain a valid final mesh",
    ", we seek a function @xmath198 on @xmath196 approximating @xmath199 .",
    "a related problem , for surface meshes without boundary alignment , was addressed in @xcite .",
    "first , note that because the cuts are added along geodesics aligned with the cross field , @xmath199 is a piecewise straight line , whose straight segments are either horizontal or vertical . in order to obtain a valid final mesh , the new function @xmath198 should have the following properties :    1 .",
    "@xmath198  must map the closed path @xmath196 to a closed path .",
    "2 .   @xmath200 must be a piecewise straight line , composed of horizontal and vertical lines only .",
    "to each segment in @xmath201 corresponds a segment in @xmath202 , at the same order along the paths .",
    "each segment in @xmath200 must be directed in the same direction as the corresponding segment in @xmath203 , or be of zero length .",
    "if @xmath204 is a geodesic cut of @xmath196 , it is followed in both directions : @xmath204 and @xmath205 .",
    "then @xmath206 and @xmath207 must have the same length .",
    "this ensures the same number of cells on both sides of a single cut .",
    "we describe a simple algorithm for creating @xmath208 , meeting these requirements .",
    "to create @xmath200 , the path @xmath199 is followed , and the segments of @xmath209 are modified one after the other , in the order they appear in @xmath210 , see fig .",
    "[ fig : mapping_sketch ] .",
    "each segment is shifted to a parallel line of the integer grid .",
    "this is usually the nearest segment , except in the case the length of the segment directly before this segment dictates a different shift , according to properties ( 3,4 ) above , see fig . [",
    "fig : mapping_sketch],c .. this algorithm requires that at least one junction exist in @xmath47 , which is mapped to a right angle in @xmath201 .",
    "the algorithm starts from the segment following this junction , so that when the last segment is reached and shifted , a change in the length of the first segment will be allowed .",
    "the resulting modified path is similar to @xmath211 , only with different segments lengths .",
    "@xmath200 is then defined as the composition of @xmath199 followed by a linear mapping of each segment of @xmath203 to the corresponding segment in the modified path .",
    "once @xmath212 is known , @xmath213 can be defined . in the implementation described below this",
    "is done by placing a triangular mesh in @xmath190 , and solving the laplace equation for both @xmath214 and @xmath215 on @xmath190 .",
    "@xmath198 obtained in this way is not in general analytic , since the cr conditions might not hold between @xmath214 and @xmath216 , so the final mesh will not exactly conformal , but only approximately , as @xmath198 approximates the analytical function @xmath217 .",
    "the mesh edges are then extracted by tracing the integer - valued lines of @xmath218 and @xmath219 .",
    "once the connectivity of the mesh has been established , a final smoothing procedure  which involves all the interior vertices , including those on the cut path , is preformed . in the definition of @xmath198 ,",
    "both @xmath214 and @xmath215 are harmonic functions .",
    "a standard finite difference approximation to a harmonic function on a uniform grid , assigns to each vertex the average of its four neighboring vertices .",
    "this  is applied to all vertices inside the mesh , including those on the cuts of @xmath196 , which can be interpreted as a generalization of the defintion of @xmath198 ( to be more precise , in this smoothing procedure it is @xmath220 which is assumed to be harmonic ) .",
    "this procedure is the well - known laplacian smoothing procedure , in which the location of every vertex is equal to the average location of its neighboring vertices , and in this application it is theoretically justified if @xmath221 is approximately @xmath217 , i.e. if @xmath212 is close to @xmath199 .",
    "the algorithm described in the previous section was implemented in matlab @xcite , using standard matlab functions , such as a least - mean square solver for linear systems , an ode solver , etc ..    to calculate the cauchy integral ( section [ sec : remove_harmonic ] ) , the boundary was approximated by a piecewise linear path between sampled points , with a constant value of @xmath2 on each segment .",
    "this allows the integral over each segment of the path to be calculated analytically , and the path integral there is equal to the sum of the integral over the segments .",
    "this is a low order approximation , but was sufficient for the present purposes .",
    "the linear system , eq . ( [ eq : linear_system ] ) , was solved in the least - mean - square sense , using matlab s ` mldivide `  function .",
    "note that the coefficients in this system contain powers of the @xmath173 s , the boundary data locations .",
    "this leads to ill - conditioned linear systems , which are more sensitive to the numerical round - off errors , as the number of sources @xmath161 increases , or the range of @xmath222 increases .",
    "tests indicate that when the solver issues a warning , indicating that the matrix is rank deficient to the working precision , the results of the ip algorithm become unreliable ( this was not the case in the examples in section [ sec : examples ] ) . for input domains where many sources or a high @xmath222 range are required ,",
    "a different solver implementation may be needed , such as a varying precision arithmetic computation , working at higher floating - point accuracies .",
    "after sources locations are recovered by taking the roots of the polynomials , the function @xmath33 of eq .",
    "( [ eq : cond1 ] ) is calculated , given the newmann boundary conditions in eq .",
    "( [ eq : cond2 ] ) .",
    "this was done using the method of fundamental solutions ( mfs ) , see e.g. @xcite , where the solution to the laplace for @xmath33 is approximated by a sum of ( real ) source terms , i.e. functions of the form @xmath223 , with the locations @xmath224 lying _ outside _ the domain @xmath30  where @xmath33 is harmonic .",
    "the charges @xmath225 are then calculated to best fit the boundary conditions .    once the function @xmath2 is given everywhere in @xmath30 , the directions of the star - geodesics at each source are calculated , as described in appendix a. the star - geodesics , emanating from the source were then traced by solving the differential equation , eq .",
    "( [ eq : kappa_dphi_dn ] ) , using a runge - kutta ode solver .",
    "the cut - tree was constructed by taking one source at a time at some arbitrary order , and introducing a cut along a star - geodesic of the added source , that is closest to the cut - tree constructed so - far .",
    "this construction of the cut tree is admitantly arbitrary , and may not be optimal in some cases .",
    "lastly , the algorithm described in section [ sec : create_final ] is applied .",
    "in the first example , a domain with two boundary components is meshed , see fig .",
    "[ multi_diamond_var_res],a .",
    "the side lengths of the outer and inner squares are @xmath226 and @xmath227 respectively , centered at the origin , and the inner square is rotated at angle @xmath228 radians . the ratio of input resolution between outer and inner boundaries is @xmath229 .",
    "the inner and outer boundaries were sampled with @xmath230 and @xmath231 points , respectively , which were used both for calculating the cauchy integral , and for the sources locations calculation .",
    "singularities of @xmath2 are not required at the junctions points , since all inner angles are multiples of @xmath11 radians . as there is no flux of @xmath232 through either boundary ( because the boundaries curvature is @xmath233 , see eq .",
    "( [ eq : cond1 ] ) , and @xmath2 is regular at the junctions ) , the total charge inside is zero ( see remark [ remark : divergence ] ) .",
    "hence an equal number of @xmath234 and @xmath235 charges were used .",
    "[ multi_diamond_var_res],a . , shows the domain boundary , together with the calculated sources locations .",
    "squares mark sources with @xmath234 , and circles sources with @xmath235 .",
    "the distribution is composed of @xmath236 sources of each type , i.e. a total of @xmath237 sources .",
    "the value of @xmath2 obtained by solving the poisson equation with this  charge distribution is shown in fig .",
    "[ multi_diamond_var_res],b . , and",
    "compared to the input @xmath2 requested , denoted by @xmath238 .",
    "the difference @xmath239 is also plotted . for visual clarity ,",
    "the average of the @xmath238 was subtracted from both @xmath2 and @xmath238 ( this is just a scaling of the resolution by a constant factor ) ; this was also done in the resolution comparisons below , in fig .",
    "( [ fig : multi_ex2]),c . , fig .",
    "( [ fig : multi_ex3 ] ) , b . and fig .",
    "( [ fig : multi_ex4]),c .. the number of sources was chosen to be the smallest for which @xmath240 at all boundary points .",
    "this criterion is used for choosing the number of sources is also used in the following examples . the cut - tree used in creating the final mesh",
    "is shown in fig .",
    "[ multi_diamond_var_res],c . , and the final mesh in shown fig .",
    "[ multi_diamond_var_res],d .",
    "[ ptbh ]    the domain in the second example is the union of three unit radius circles which pass through the origin , see fig .",
    "[ fig : multi_ex2],a .",
    "the boundary has three junctions , all with the same inner angle , @xmath241 .",
    "boundary alignment requires @xmath2 to be singular at the junctions , corresponding to sources with charge @xmath242 , or @xmath38-value @xmath243 , see eq .",
    "( [ eq : junc_charge]),([eq : junc_incidence ] ) .",
    "as explained in section [ sec : input_near_junc ] , singular functions can be added the input resolution in order to avoid clustering of sources near the junction points . in this example , we compose the input @xmath2 from a sum of pairs of source terms , with @xmath38-values as marked in fig .",
    "[ fig : multi_ex2 ] , a .. the pairs of nearby sources with opposite charge create the desired singularities at the junctions , and have only a small effect at distances large compared with the distance between the sources of each pair .",
    "we can now calculate the total flux of @xmath2 through the boundary in this example .",
    "the ( singular ) flux through each junction is @xmath244 ( positive value when @xmath232 is directed outward ) .",
    "the flux through each of the three arcs is @xmath245 along the arc , and since for each arc @xmath246 , the total flux through the boundary is @xmath247 .",
    "this is in agreement with the formula given in remark [ remark : flux_calc ] .",
    "therefore , the sum of @xmath38-values of the sources inside the domain should be @xmath248 , so @xmath249 . hence , @xmath250 of eq .",
    "( [ eq : source_in_d ] ) was @xmath248 ; @xmath251 was used .",
    "the lowest number of sources for which @xmath240 , shown in fig . [",
    "fig : multi_ex2],b .",
    ", has @xmath252 , @xmath253 .",
    "the boundary was sampled at @xmath254 points .",
    "[ ptbh ]    the boundary in the third example is composed of two boundary components , each with a single junction point .",
    "the inner angles at the inner and outer boundary junctions are @xmath255 respectively , so a singularity of @xmath2 will form at the inner boundary junction . as in the previous example , we add a singular function to the input @xmath2 , by adding a pair of source  terms , one at the junction point with @xmath256 , as obtained from eq .",
    "( [ eq : junc_charge]),([eq : junc_incidence ] ) with @xmath257 .",
    "no inner source term is required , and from the flux trough the hole boundary it follows that @xmath258 . after subtracting the junction source term with @xmath256  ( see section [ sec : junc_points ] ) a source with total charge of @xmath259",
    "is added inside the hole , see fig .",
    "[ fig : multi_ex3],a .. the inner and outer boundary components are sampled at @xmath260 and @xmath261 points , respectively .",
    "the distribution with @xmath262 , the smallest number of sources for which @xmath240 , is plotted at fig .",
    "[ fig : multi_ex3],a . , with squares and circles representing charges as in previous examples .",
    "two pairs of @xmath263 charges are located inside the inner boundary , i.e. , outside the domain .",
    "their constitute a correction to the homogeneous @xmath33 , which is very small , since in each pair the opposite charges almost overlap .",
    "the obtained @xmath2 reconstruction is given in fig .",
    "[ fig : multi_ex3],b .. the final mesh , fig .",
    "[ fig : multi_ex3],c . , contains @xmath264 irregular vertices , @xmath265 of each type .",
    "this is because two pairs of sources lay outside the domain , and another pair ( the pair of sources closest to the inner junction ) was eliminated  in the creation of the final mesh ( section [ sec : create_final ] ) : the two opposite charges where united , giving a zero total charge .    [ ptbh ]    in the final example the boundary of the square @xmath266\\times\\lbrack-2,2]$ ] was assigned a varying  input resolution proportional to : @xmath267    the resolution thus varies by a factor of @xmath268 within the domain . as always , eq .",
    "( [ eq : phi_from_res ] ) , @xmath269 .",
    "the total charge is zero , so @xmath270 .",
    "the boundary was sampled at @xmath271 points .",
    "a source distribution with @xmath240 was obtained with just @xmath226 charges , i.e. with @xmath272 .",
    "[ fig : multi_ex4],a . shows the source distribution , fig .",
    "[ fig : multi_ex4],b . shows the obtained @xmath2 vs. the input @xmath2 , and the final mesh is shown in fig .",
    "[ fig : multi_ex4],c .. it is instructive to compare the star - geodesics and cut - tree with the final mesh .",
    "the two are overlaid in fig .",
    "[ fig : multi_ex4],d .",
    "( this would create a crowded  appearence when more sources are present ) .",
    "the black solid line traces the cut - tree , the dashed lines are additional star - geodesics , and the mesh is drawn with the background in gray lines .",
    "[ ptbh ]    cell shape quality was measured using a variant of the quality measure @xmath273 @xcite , as defined in @xcite .",
    "@xmath274 represents a square cell , while @xmath275 represents a cell with an inner angle of @xmath276 .",
    "cells with a high aspect ratio are also given low @xmath273-values .",
    "table 1 shows the minimum and average @xmath273 values , and the total number of cells , for the examples in fig .",
    "[ multi_diamond_var_res]-[fig : multi_ex4 ] . for each example , the tabulated information is given for the mesh shown in the corresponding figure , and for a finer mesh of the same domain , where the resolution function was doubled ( prodcing a mesh with about four times the number of cells ) .",
    "note that multiplying the resolution by a factor amounts to adding a constant to @xmath2 , which does not change the source distribution obtained from the ip algorithm , as this constant , which is part of @xmath69 , is readily removed when @xmath69 is subtracted .",
    "@xmath277{|c|c|c|c|}\\hline & num .",
    "cells & min .",
    "$ ] @xmath278@xmath279    @xmath280    table 1 : mesh statistics .",
    "an unstructured quadrilateral mesh generation scheme in planar domains was presented .",
    "the method rests on a theoretical foundation , linking the mesh generation problem with the inverse poisson ( ip ) problem .",
    "an ip solution algorithm is presented , whose output is interpreted as the location and type ( degree ) of irregular vertices in the domain .",
    "the continuum fields obtained , describing mesh resolution and directionality , are conformal everywhere except on the irregular vertices , and fit the required input properties at the boundary , or at other user - defined locations .",
    "an algorithm for creating a valid final mesh is also presented .",
    "example meshes feature irregular vertices where they are needed , in combination with highly regular regions where possible .",
    "directions for future work include  more sophisticated methods for solving the rational function interpolation equations , and for constructing the final mesh .",
    "the relations between conformal unstructured mesh generation , the ip problem and rational function interpolation raise many research questions .",
    "these may lead to a deeper understanding of the properties of high quality meshes , and to better algorithms for creating them .",
    "* acknowledgements . *",
    "the author would like to thank mirela ben - chen , shlomi hillel , dov levine , yair shokef and vincenzo vitelli for helpful discussions and critical reading of the manuscript .",
    "a cross is defined at every point @xmath49 of the domain , that is not a singularity of the function @xmath2 .",
    "geodesic curves that start at @xmath49 can be drawn in all four directions of the cross . by the definition of a cross - field",
    ", such a geodesic will be aligned with the cross - field everywhere along the curve . if @xmath49 is a singular point , with @xmath38-value  @xmath281 , a cross",
    "is not defined at @xmath49 , but there are @xmath282 geodesics that are incident on @xmath49 and follow the cross - field directions elsewhere on the curve .",
    "these will be called _ star - geodesics_. for example , the geodesics drawn in fig .",
    "[ multi_diamond_var_res],c .  and [ fig : multi_ex4],d .",
    "are star - geodesics .",
    "denote the angle from the @xmath10-axis around @xmath49 by @xmath283 , and the cross direction when @xmath49 is approached from direction @xmath283 by @xmath284 , see fig .",
    "[ fg : star_directions ] . to calculate the directions in which star - geodesics emanate from @xmath49 ,",
    "we first calculate the cross when @xmath49  is approached from some direction , e.g. the positive @xmath10-axis .",
    "this can be done using eq .",
    "( [ eq : theta_change_par_tranport ] ) along a curve from the boundary to @xmath49 which approaches @xmath49 from the direction @xmath285 .",
    "once @xmath286 is known , @xmath287 for any @xmath283 can be calculated by using eq .",
    "( [ eq : theta_change_par_tranport ] ) along a small circular arc around @xmath49 at radius @xmath53 , @xmath97 .",
    "the singularity term at @xmath2 is @xmath288 , and according to eq .",
    "( [ eq : theta_change_par_tranport ] ) @xmath289 note that contributions to @xmath2 that are regular at @xmath49 do not affect @xmath287 for @xmath290 .",
    "the star - geodesic directions are those for which the cross is directed along the ray from @xmath49 , or @xmath291 with @xmath46 . substituting eq .",
    "( [ eq : app_a_th_calc ] ) into eq ( [ eq : app_a_star_cond ] ) and rearranging , we find @xmath292 it is easy to show that there are exactly @xmath293 different @xmath283-values for which this equation is fulfilled .",
    "they are equally distributed around @xmath49 .",
    "m. hmlinen , r. hari , r. j. ilmoniemi , j. knuutila and o. v. lounasmaa , magnetoencephalography - theory , instrumentation , and applications to noninvasive studies of the working human brain , _ reviews of modern physics _ * 65 * issue 2 ( 1993 ) 413 - 497 ."
  ],
  "abstract_text": [
    "<S> a novel approach to unstructured quadrilateral mesh generation for planar domains is presented . </S>",
    "<S> away from irregular vertices , the resulting meshes have the properties of nearly conformal grids . </S>",
    "<S> the technique is based on a theoretical relation between the present problem , and the inverse poisson ( ip ) problem with point sources . </S>",
    "<S> an ip algorithm is described , which constructs a point - source distribution , whose sources correspond to the irregular vertices of the mesh . both the background theory and the ip  algorithm address the global nature of the mesh generation problem . </S>",
    "<S> the ip algorithm is incorporated in a complete mesh generation scheme , which also includes an algorithm for  creating the final mesh . </S>",
    "<S> example results are presented and discussed . </S>"
  ]
}