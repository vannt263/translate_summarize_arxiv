{
  "article_text": [
    "dose distributions of radiotherapy are represented by point doses at orthogonally arranged grids . in treatment - planning practice ,",
    "the grid intervals are defined from a physical , clinical , and practical points of view , often resulting in cubic dimensions of a few millimeters .",
    "accuracy , efficiency and their balance are essential in practice , for which the pencil - beam algorithm is commonly used .",
    "that is mathematically a convolution integral of total energy released per mass ( terma ) with elementary beam - spread kernel , which may be computationally demanding .",
    "the grid - dose - spreading ( gds ) algorithm was developed for fast dose calculation of heavy - charged - particle beams in patient body @xcite .",
    "the gds algorithm employs approximation to extract beam - interaction part from the integral at the expense of distortion of dose distribution for a beam tilted with respect to the grid axes , as originally recognized in ref .",
    "the beam - tilting distortion may be generally insignificant when beam blurring is as small as the required spatial resolution , for example , for a carbon - ion beam .",
    "in fact , the gds method was successfully incorporated into a clinical treatment - planning system for carbon - ion radiotherapy with vertical and horizontal fixed beams @xcite , for which tilting was intrinsically absent .    in that particular implementation",
    ", a simplistic post process was added to the original broad - beam algorithm so as to spread an intermediate terma distribution uniformly @xcite . in general , the spreading kernel could be spatially modulated using the pencil - beam model for more accurate heterogeneity correction @xcite .",
    "there are two reciprocal approaches for convolution , _",
    "i.e. _ to collect doses transferred from nearby interactions to a grid or _ the dose - deposition point of view _ and to spread a terma from an interaction to nearby grids or _ the interaction point of view_. the latter is usually more efficient than the former for three - dimensional dose calculation @xcite .",
    "the pencil - beam model implicitly assumes homogeneity of the medium within the elementary beam spread .",
    "beams that have grown excessively thick in heterogeneous transport are thus incompatible . as a general and rigorous solution , gaussian - beam splitting was proposed , with which overgrown beams are subdivided into smaller ones at locations of large lateral heterogeneity @xcite .",
    "figure [ fig : split ] demonstrates its effectiveness for a simple density boundary , where the non - splitting beam happened to traverse an edge of a bone - equivalent material while about a half of the split beams traverse the bone - equivalent material .",
    "the splitting causes explosive beam multiplication in a shower - like process . in this particular case for example ,",
    "the original beam recursively split into 28 final beams . slowing down of dose calculation due to beam multiplication will be a problem in practice .",
    "( a ) non - splitting and ( b ) splitting dose calculations with isodose lines at every 10% levels of the maximum non - splitting dose in the @xmath0 cross section , where a proton pencil beam with @xmath1 mev and @xmath2 mm is incident into water with a bone - equivalent material ( @xmath3 ) inserted halfway ( gray area).,width=321 ]    in ref .",
    "@xcite , the beam - splitting method was stated as efficient due to certain `` algorithmic techniques to be explained elsewhere '' , which in fact implied this work to construct a framework , where the gds and beam - splitting methods work compatibly for accurate and efficient dose calculations . in addition",
    ", we will refine the gds algorithm with a fix against the beam - tilting distortion and with the pencil - beam model in the interaction point of view for better heterogeneity correction .    although the gaussian - beam approximation may be reasonable for the multiple - scattering effect",
    ", two or more gaussian components would improve the accuracy of lateral dose distribution of proton and ion pencil beams @xcite .",
    "however , such large - sized components are intrinsically incompatible with fine heterogeneity . in addition",
    ", it is inconceivable to apply the beam - splitting method for large - sized components to secure practical efficiency",
    ".    this framework will be applicable not only to broad - beam delivery but also to pencil - beam scanning , where a physical scanned beam may have to be decomposed into virtual elementary beams to address heterogeneity @xcite .",
    "as this work aims to improve computing methods , we focus on evaluation of efficiency and settlement of the intrinsic artifacts with respect to the ideal beam models that are mathematically given , without repeating experimental assessments of accuracy @xcite .",
    "we will solve the beam - tilting distortion of the gds algorithm by defining intermediate grids for dose calculation , which are arranged to be normal to the beam - field axes .",
    "as shown in figure [ fig : coordinates ] , the original dose grids along numbered axes 1 , 2 , and 3 are defined with basis vectors @xmath4 , @xmath5 , and @xmath6 and intervals @xmath7 , @xmath8 , and @xmath9 . for a given radiation field , the field coordinates @xmath10 , @xmath11 , and @xmath12 with basis vectors @xmath13 , @xmath14 , and @xmath15 are associated , where the origin is at the isocenter and @xmath15 is in the source direction . with lateral margins for penumbra",
    ", the normal - grid volume is defined as the supremum of normal rectangular - parallelepiped volume of @xmath16 containing the original grids in the margined field .",
    "quadratic projection of the original - grid voxel gives the normal - grid intervals @xmath17 , @xmath18 , and @xmath19 as @xmath20 to approximately conserve the equivalent resolution .",
    "normal grids @xmath21 are defined at equally spaced positions @xmath22 for indices @xmath23 $ ] , @xmath24 $ ] and @xmath25 $ ] , where @xmath26 is the ceiling function .",
    "schematic of grid normalization in cross - section view perpendicular to @xmath27 , where shown are a field ( gray area ) with axes @xmath13 and @xmath15 , margins ( light gray areas ) , original grids with axes @xmath4 and @xmath5 , and normal grids of width @xmath28 and height @xmath29 . ]",
    "because the elementary pencil beams are almost parallel to vector @xmath15 , normal - grid doses @xmath30 can be accurately and efficiently calculated with @xmath31 where @xmath32 , @xmath33 , and @xmath34 are the terma , the spread , and the position of normal grid @xmath35 , and @xmath36 is the gaussian distribution of mean @xmath37 and standard deviation @xmath38 whose integral is readily given by the standard error function .",
    "dose @xmath39 at original grid @xmath40 is then given by trilinear interpolation , which is repeated for all the original grids in the margined field .",
    "in this manner , we only deal with normal grids in the gds algorithm hereafter .",
    "beam-@xmath41 spread @xmath42 at grid @xmath40 is given by beam - transport calculation @xcite and terma contribution @xmath43 is defined @xcite as @xmath44 where @xmath45 is the number of particles that is modeled as a constant , @xmath46 is the dose per in - air fluence that is measured as a depth  dose curve , and @xmath47 is the step length in voxel @xmath40 . in the original gds algorithm ,",
    "grid terma @xmath48 and spread @xmath49 are intermediately defined with formulas @xmath50 which are straightforward extensions of eqs .",
    "( 13 ) and ( 14 ) in ref .",
    "@xcite . that would be , however , problematic when the beams are arranged independently to the grids .",
    "as shown in figure [ fig : sharing](a ) , only several beams may traverse each voxel .",
    "due to interplay between the beam and grid structures , the total beam - path length per voxel and consequently the grid terma @xmath48 largely fluctuates .",
    "the fluctuation would be smeared out only with large spreading with @xmath51 .    to fully resolve the fluctuation",
    ", we will distribute step terma @xmath43 to the nearest four grids in a regulatory manner .",
    "as shown in figures [ fig : sharing](b ) and [ fig : sharing](c ) , the @xmath10 and @xmath11 axes comprise the lateral plane , where any beam @xmath41 is now modeled to have cross section @xmath52 of size @xmath53 centered at mid - step point @xmath54 in current voxel @xmath55 at grid @xmath56 .",
    "the four voxels that intersect @xmath52 share terma contribution @xmath57 by areal fractions . equation ( [ eq : original ] ) is then modified in such a way that the terma and spread distributions will be formed when all the beams have been processed as @xmath58 where the areal fraction is given by @xmath59 for nearby grid @xmath40 with @xmath60 and @xmath61 or otherwise 0 .    essentially , this beam - sharing operation is one form of convolution with a rectangular kernel .",
    "we thus modify axial dose spreading @xmath62 at grid @xmath56 in ( [ eq : spreading ] ) to correct the extra rectangular spreading as @xmath63 for which , sufficiently fine grid intervals @xmath64 must be given .",
    "schematic of inter - grid beam sharing in the cross - section views with grid points ( + ) , voxel boundaries ( dashed lines ) , beam paths ( arrows ) , mid - step points ( @xmath65 ) , and rectangular @xmath52 ( gray areas ) .",
    "one of many beams in ( a ) is focused in ( b ) , where the dotted line indicates the @xmath10@xmath11 cross section in ( c).,width=321 ]      [ [ tilted - pencil - beam ] ] tilted pencil beam + + + + + + + + + + + + + + + + + +    we examine the effect of grid normalization using an analytic 150 mev proton pencil beam model with formulated dose per in - air fluence @xcite and lateral spread @xcite .",
    "the beam with rms projected angle @xmath66 mrad and size @xmath67 mm was placed at the isocenter to incident into water in the direction of patient - support angle @xmath68 and gantry angle @xmath69 in the standard coordinate system @xcite .",
    "the original grids were defined cubically as @xmath70 mm to form a volume of 10 cm @xmath71 15 cm @xmath71 10 cm . around the beam axis ,",
    "1-cm margins were added to define the normal - grid volume .",
    "the dose distributions were calculated using the gds algorithm with and without grid normalization for comparison .",
    "[ [ broad - beam - with - heterogeneity ] ] broad beam with heterogeneity + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    we examine a broad beam in a heterogeneous medium , which approximates clinical situations .",
    "the dose per in - air fluence was modeled based on an experiment @xcite , where a carbon - ion beam with incident nucleon kinetic energy @xmath72 mev was broadened by spiral wobbling @xcite and was range - modulated by a semi - gaussian filter of @xmath73 mm . in the calculation ,",
    "a radiation from a source at height 500 cm was limited by a collimator at height 50 cm to form a 4 cm @xmath71 4 cm field on the isocenter plane , which yielded @xmath74 original pencil beams . in a 20 cm @xmath71 20",
    "cm @xmath71 10 cm volume gridded at intervals of 1 mm along axes 1 , 2 , and 3 , an 19 cm diameter cylindrical water phantom was defined at the center .",
    "the phantom included a 2 cm diameter dense ( @xmath75 ) rod at radius 6 cm .",
    "the dosimetric effects of grid normalization and inter - grid sharing were investigated for two gantry angles @xmath76 and @xmath77 with the concurrently rotated phantom so that the rod was always in the middle of the field to see any angular artifact .",
    "the computing times were measured using 2.4 ghz intel core2duo processor on apple macbook computer .",
    "[ [ tilted - pencil - beam-1 ] ] tilted pencil beam + + + + + + + + + + + + + + + + + +    figure [ fig : pencil ] shows the projected dose distributions for the tilted proton pencil beam .",
    "the original gds algorithm severely distorted the analytic model that was exactly the dose kernel of the algorithm .",
    "the grid normalization greatly reduced the distortion .    projected dose at every 10% levels for ( a ) the analytic proton - beam model , ( b ) the original gds calculation , and ( c )",
    "the normalized gds calculation.,width=321 ]    [ [ heterogeneous - broad - beam ] ] heterogeneous broad beam + + + + + + + + + + + + + + + + + + + + + + + +    table [ tab : configurations ] and figures [ fig : broad ] and [ fig : broadp ] show the configurations for broad carbon - ion beam calculations , the computing times , and the dose distribution in the @xmath78 cross - section and along the @xmath10 and @xmath12 axes of the beam field .",
    "configurations a and d resulted in severe dose artifacts for the beam  grid interplay and for the tilted incidence while the others are hardly distinguishable . from the a  b comparison , we find that the inter - grid sharing resolved the interplay artifact and added marginal computing load . from the d ",
    "e comparison , we find that the grid normalization resolved the angle issue and unexpectedly reduced the computing time . from the b ",
    "c and e  f comparisons , we find that the beam splitting increased the computing time by factors 7.8 and 6.6 although the dosimetric effect was only marginal dose fluctuation from moderate heterogeneity of the round structures .",
    ".[tab : configurations ] definitions of calculation configurations a  f in combinations of with ( @xmath79 ) or without ( @xmath80 ) @xmath77 tilt @xmath81 , grid normalization @xmath82 , inter - grid sharing @xmath83 , and beam splitting @xmath84 and total computing times for a broad beam in a heterogeneous phantom . [ cols=\"^,^,^,^,^,^\",options=\"header \" , ]     [ tab : broad ]     dose distributions in the @xmath78 cross section for a carbon - ion beam calculated in configurations a  f .",
    "the solid and dotted lines indicate every 10% dose levels and the field @xmath10 and @xmath12 axes .",
    "the light - gray and medium - gray areas indicate the water phantom and the high - density rod.,width=321 ]     dose profiles along the ( a ) @xmath10 and ( b ) @xmath12 axes for a carbon - ion beam in configurations a ( solid ) , b ( dashed ) , c ( dotted ) , d ( @xmath79 ) , e ( @xmath85 ) , and f ( @xmath71 ) in units of arbitrary reference dose @xmath86.,width=321 ]",
    "in this work , we introduced grid normalization to successfully resolve the problems with tilted incidence .",
    "the interpolation errors are limited by the grid intervals , which may be generally tolerable and controllable because the grid intervals are normally specified by a treatment planner .",
    "we found no apparent loss of speed for interpolation .",
    "in fact , the areal convolution with normal grids was faster than the volumetric convolution with tilted grids .",
    "the beam  grid interplay artifact was overlooked in the original formulation of the gds algorithm @xcite that was implemented as an extension to the broad - beam algorithm so that the termas and the spreads were calculated exactly at the grids and were free from the interplay .",
    "the inter - grid beam sharing , which is essentially rectangular - kernel convolution , has fully resolved the problem .    as shown in ref .",
    "@xcite , the beam splitting resolved the intrinsic problems with the pencil - beam model for fine heterogeneity by dynamic subdivision .",
    "this inevitably requires the interaction - point - of - view approach because otherwise it would be difficult to trace histories of the split beams backwards from each dose - deposition grid @xcite . since the gds convolution is directly coupled not to individual beams but to resultant terma and spread distributions , beam multiplication due to splitting will not increase the computing time for dose convolution . in other words ,",
    "the combination of the gds and beam - splitting methods is a rational consequence .",
    "the observed slowing by a factor of several times was mainly attributed to increased transport calculation of the split beams .",
    "these slowing factors were comparable to that originally reported @xcite , not surprisingly because they in fact used a similar framework of the beam - splitting gds algorithm though without grid normalization nor inter - grid sharing .",
    "those examples happened to be of normal incidence and of small interplay and were only intended for a proof of principle of beam splitting .",
    "the terma - weighted mean for the gridded beam spread @xmath49 in eq .",
    "( [ eq : sigmag ] ) can not be generally valid because the mean spread only approximately represents the contributing gaussian components .",
    "it was originally assumed that its variation would be small enough to be handled as locally uniform",
    ". however , beam splitting changes the spread abruptly . on the other hand , the beam splitting converts the major part of beam spreads directly into a terma distribution . as a result ,",
    "grid - dose spreading handles only the residuals , for which the terma - weighted mean may suffice .",
    "a known problem of tilted incidence with the original gds algorithm was naturally resolved by the grid - normalization method without serious loss of accuracy or efficiency .",
    "another problem of beam  grid interplay artifact was revealed and was resolved by the inter - grid beam - sharing method .    the beam - splitting method for fine - heterogeneity correction will inevitably multiply beams to transport and",
    "thus will slow down dose calculation . with the gds algorithm ,",
    "the dose convolution is made only once after all the beams have been transported , which minimizes the impact of the beam multiplication on computing time .",
    "in fact , for the beams individually split into several tens , the calculation time increased only by several times with the gds .",
    "this algorithmic framework will thus enable fast and accurate treatment planning of heavy charged particle radiotherapy in the presence of density heterogeneity finer than the size of intrinsic beam blurring .",
    "00        kanematsu n , endo m , futami y , kanai t , asakura h , oka h , yusa k. treatment planning for the layer - stacking irradiation system for three - dimensional conformal heavy - ion radiotherapy . med phys 2002;29:282329 .",
    "kanematsu n , komori m , yonai s , ishizaki a. dynamic splitting of gaussian pencil beams in heterogeneity - correction algorithms for radiotherapy with heavy charged particles .",
    "phys med biol 2009;54:201527 .",
    "pedroni e , scheib s , bhringer t , coray a , grossmann m , lin s , lomax a. experimental characterization and physical modeling of the dose distribution of scanned proton pencil beams .",
    "phys med biol 2005;50:54161 .",
    "schaffner b , pedroni e , lomax a. dose calculation models for proton treatment planning using a dynamic beam delivery system : an attempt to include heterogeneity effects in the analytical dose calculations .",
    "phys med biol 1999;44:2741 ."
  ],
  "abstract_text": [
    "<S> this work addresses computing techniques for dose calculations in treatment planning with proton and ion beams , based on an efficient kernel - convolution method referred to as grid - dose spreading ( gds ) and accurate heterogeneity - correction method referred to as gaussian beam splitting . </S>",
    "<S> the original gds algorithm suffered from distortion of dose distribution for beams tilted with respect to the dose - grid axes . </S>",
    "<S> use of intermediate grids normal to the beam field has solved the beam - tilting distortion . </S>",
    "<S> interplay of arrangement between beams and grids was found as another intrinsic source of artifact . </S>",
    "<S> inclusion of rectangular - kernel convolution in beam transport , to share the beam contribution among the nearest grids in a regulatory manner , has solved the interplay problem . </S>",
    "<S> this algorithmic framework was applied to a tilted proton pencil beam and a broad carbon - ion beam . in these cases , while the elementary pencil beams individually split into several tens , the calculation time increased only by several times with the gds algorithm . </S>",
    "<S> the gds and beam - splitting methods will complementarily enable accurate and efficient dose calculations for radiotherapy with protons and ions .    </S>",
    "<S> proton , ion beam , pencil - beam algorithm , treatment planning , inhomogeneity correction 87.55.d- , 87.55.kd </S>"
  ]
}