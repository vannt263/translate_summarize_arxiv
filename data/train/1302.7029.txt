{
  "article_text": [
    "the _ kepler _ spacecraft continuously observes more than @xmath5 target stars in a 115 square - degree field of view to discover earth - like planets transiting sun - like stars through analysis of photometric data @xcite .",
    "the _ kepler _ spacecraft collects photometric data for each target star which is compressed and stored on - board to be downlinked at monthly intervals . the _ kepler _ science operations center at nasa ames research center processes the data with the science processing pipeline , which is composed of several modules including the transiting planet search ( tps ) @xcite .",
    "to search for transit signatures , tps employs a bank of wavelet - based matched filters that form a grid on a three dimensional parameter space of transit duration , period , and epoch @xcite . owing to non - stationary and non - gaussian noise , uncorrected systematics , and poorly mitigated noise events of either astrophysical or non - astrophysical nature ,",
    "large spurious threshold crossing events ( tces ) can be produced by the matched filtering performed in tps .",
    "the optimal linear filter for a deterministic signal buried in gaussian noise is a simple matched filter @xcite .",
    "the output of a matched filter can be large , both , when a true signal is contained in the data and when the noise mimmicks the true signal closely enough . in a perfect detection scenario",
    "the noise would be stationary and gassian , furnishing static false alarm and detection probabilities . under this scenario",
    ", one can easily apply the neyman - pearson criterion to set a detection threshold that maximizes the detection probability for a given , tolerable , false alarm rate . in reality however , a plethora of outside influences can contribute non - stationary and non - gaussian noise to the data stream .",
    "an effort can and should be made to understand as many of these periphereal noise sources as possible and remove their effect through model fitting .",
    "imperfections in the removal of known noise sources and other spurious noise events may then however necessitate the formulation of a discrimination strategy for the remaining false alarms that contribute to a false alarm rate that is above what is expected from consideration of gaussian statistics alone .",
    "the chosen discrimination method should have as a requirement to preserve the existing detection probability while simultaneously reducing the false alarm rate .",
    "true positives should easily pass the test , while false positives should be mitigated .",
    "a clever approach to this problem was developed by allen @xcite for use in gravity wave searches in ligo data . in that work ,",
    "the chief astrophysical source of interest was the inspiraling compact binary system .",
    "the signal , or chirp , from such a system is a sinusoid with both a frequency and amplitude that diverge as the stars approach the merger phase of the inspiral event .",
    "the @xmath3 discriminator is essentially built by breaking up the frequency band of the detector into chunks and for each chunk comparing the expected response , given the template waveform , to the actual response .",
    "allen @xcite shows that the expectation value of the @xmath3 statistic is independent of whether or not a signal is present in the data .",
    "this property makes it a good discriminator since its value deviates from the expectation value only when the noise deviates from its assumed gaussianity and stationarity .",
    "so it provides a method for targeting contributions from non - gaussian tails that end up furnishing tces .",
    "allen s work goes on to show that under the assumptions of both stationary and gaussian noise , the @xmath3 statistic can be proven to have a @xmath3 probability density function .",
    "the paper also shows that when there is mismatch between the true signal and the template , the probability density function of the @xmath3 statistic then becomes a non - central @xmath3 distribution whose non - centrality parameter depends on both the signal - template mismatch and the square of the expected snr .",
    "allen s method was originally formulated for use with broad - band deterministic signals , with unkown signal parameters , and detectors with potentially non - ideal observing noise . in the case of planet detection ,",
    "the problem is similar .",
    "the waveforms used by tps depend on a set of three parameters , namely , epoch , period , and transit duration ( @xmath6 respectively ) .",
    "planetary transits produce periodic depressions in the light curves of their host stars .",
    "the exact shape of the depression depends strongly on both stellar and planetary parameters .",
    "tps avoids this complication by simply using pulse trains of square waves , which means that the templates and true signal are inherently mismatched .",
    "the degree of mismatch is furthered by the fact that only a discrete set of points in the three dimensional parameter space is searched over .",
    "the goal of tps is to simply identify those targets that potentially have something interesting and should be followed up with the final pipeline module , data validation ( dv ) .",
    "dv then does a much more thorough job of fitting an astrophysical transit model to determine the validity of the tce .",
    "although the signal detection problems differ between the gravity wave detection , for which the @xmath3 formalism was originally developed , and the transiting planet detection , the basic ideas can still be applied .",
    "rather than breaking up the detector s bandwidth into different channels , we instead analyze the components of our test statistics in multiple ways that are completely analogous with the @xmath3 formalism developed by allen .",
    "many of the results can then be directly applied .",
    "this paper is organized as follows .",
    "section  [ s : detection ] reproduces the detection theory employed by tps for completeness .",
    "section  [ s : chisquares ] then applies the @xmath3 formalism to produce a discriminator for tps and discusses its expected distribution .",
    "section  [ s : otherchis ] discusses some of the other possible versions of the @xmath3 discriminator .",
    "section  [ s : signaltemplatemismatch ] shows what the effect of a mismatch between the signal and template has on the @xmath3 statistic . in this section",
    "the true mismatch is estimated by a monte carlo study which also proves to be useful for generating an astrophysically motivated set of templates for tps .",
    "section  [ s : thresholds ] shows how tps uses the discriminators for thresholding purposes now and and how it might use them in the future .",
    "section  [ s : examples ] gives some examples that illustrate how the @xmath3 discriminators work and what their strengths and weaknesses are .",
    "section  [ s : results ] gives some results based on analysis of twelve quarters of _ kepler _ data .",
    "then section  [ s : conclusion ] gives a conclusion which summarizes the main results , gives prospects for future work , followed by acknowledgments .",
    "the data input to tps are discrete , contiguous , flux fraction time series that have been corrected for systematics and had some other more localized noise artifacts removed such as sudden pixel sensitivity dropouts , cosmic rays , and thermal transients . for a discussion of how the data are prepared for the search in tps see @xcite .",
    "let @xmath7 be this discrete , contiguous , flux fraction time series , where @xmath8 $ ] . under the null hypothesis , @xmath9",
    ", there is no transit signal present and we have only noise @xmath10 which we assume to be zero - mean , white gaussian noise ( wgn ) , with variance @xmath11 . under the alternative hypothesis ,",
    "@xmath12 , there is a transit pulse signal @xmath13 present in the data ( for simplicity , assume for now a single pulse is present rather than a pulse train ) .",
    "we then have : @xmath14 an often used result from detection theory is that for a known signal , the optimal detection statistic is a simple matched filter of the form @xmath15 where we have used bold - faced type to denote vector quantities and @xmath16 is the standard deviation of @xmath10 . since @xmath17 is a linear combination of gaussian random variables , it too is a gaussian random variable .",
    "the mean and variance of @xmath17 under the two hypotheses therefore completely characterize the detection problem .",
    "it is straightforward to show that under both hypotheses , the variance of @xmath17 is unity , while the mean under @xmath9 is zero and the mean under @xmath12 is the snr of the signal : @xmath18 @xmath19 @xmath20 now it is easy to see that the probability density functions under the two hypotheses are given by : @xmath21 , \\",
    "\\ i = \\{0,1\\},\\ ] ] and the corresponding false alarm and detection probabilities as a function of the decision making threshold @xmath22 are : @xmath23 @xmath24 in this detection scenario there is no knowledge of prior probabilities nor any costs associated with false alarms or false dismissals , so the best strategy to adopt is to apply the neyman - pearson criteria .",
    "a maximum tolerable false alarm is chosen which determines the threshold @xmath22 and the corresponding detection probability .",
    "since we are observing the light from many target stars with highly varied properties , the noise @xmath10 is typically not white , but colored .",
    "colored gaussian noise can be modeled as the result of filtering white gaussian noise through a linear but possibly time - varying filter @xcite .",
    "the noise will generally then possess an auto - correlation matrix , @xmath25 , with non - zero off - diagonal components .",
    "the optimal detector is still the simple matched filter but it must account for the off - diagonal components : @xmath26 since @xmath25 is an autocorrelation matrix of the noise @xmath10 , it is non - singular and symmetric and therefore possesses a square root .",
    "so we can rewrite ( [ autocorr ] ) as @xmath27 where @xmath28 and @xmath29 are whitened versions of the data and signal vectors . since @xmath30 is typically not available ,",
    "one is faced with the difficult task of designing an appropriate whitening filter to construct the test statistic in the presence of colored noise . since the stellar irradiance can clearly exhibit ( colored ) nonstationary behaviour , a wavelet - based adaptive matched filter that constructs a time - varying",
    "whitener is employed @xcite .",
    "this detector performs a joint time - frequency decomposition of the data to estimate the properties of the noise as a function of time , then applies a matched filter to the whitened data in the wavelet domain , taking into account the effect of the whitener on the shape of the transit pulse .",
    "the wavelet based approach employed by tps uses an over - complete ( discrete - time ) wavelet transform ( owt ) of the data and template with debauchies 12-tap wavelets @xcite .",
    "the wavelet domain is a natural choice for designing time - varying filters since it _ is _ a joint time - frequency representation of the transformed data .",
    "the wavelet - based matched filter uses an octave - band filter bank to separate input flux time series into different band passes to estimate the noise power spectral density ( psd ) as a function of time . for details of the filter bank implementation see @xcite . for our purposes here , define the owt of @xmath7 as @xmath31 where @xmath32 ` @xmath33 ' denotes convolution , and the @xmath34 are the impulse responses of the filters in the filter bank implementation of the wavelet expansion with corresponding frequency responses @xmath35 .",
    "the filter @xmath36 is a high - pass filter that passes frequency content from half the nyquist frequency to nyquist ( @xmath37 $ ] ) .",
    "the next filter , @xmath38 , then passes frequency content in the interval @xmath39 $ ] .",
    "each subsequent filter passes content in the next lower bandpass until the final filter , @xmath40 , passes the lowest bandpass on down to dc .",
    "the time - varying channel variance , @xmath41 , in each channel @xmath42 of the filter bank is estimated by a moving circular median absolute deviation ( mad ) with an analysis window chosen to be significantly longer than the duration of transit pulse .    to obtain the wavelet - based expression for the matched filter , we need to be able to express the dot product in the wavelet domain .",
    "for an overcomplete , dyadic , wavelet expansion , the dot product can be expressed as : @xmath43 where @xmath44 and @xmath45 are time series , and @xmath46 and @xmath47 are the wavelet components which are also time series @xcite .",
    "the restriction on the power of two in ( [ waveletdot ] ) is necessary because the last two channels of the owt have the same bandwidth .",
    "the detection statistic is now computed by multiplying the whitened wavelet coefficients of the data by the whitened wavelet coefficients of the transit pulse and employing the dot product relation : @xmath48    this equation ( [ sesorig ] ) is the single event statistic ( ses ) .",
    "it allows us to compute the detection statistic for a transit pulse @xmath49 of a specific duration , where the transit is centered at a single point in time @xmath50 .",
    "the @xmath51 are the whitening coefficients which are variance estimates for each time point and for each wavelet scale @xmath42 .",
    "these are estimated by a moving circular median absolute deviation ( mad ) at each scale with a base window size that is thirty times longer than the pulse duration .    at the outset of our analysis ,",
    "the timing of a real transit signal , namely its epoch and period , is unknown .",
    "therefore , it would be useful to generate a time series of detection statistics , @xmath52 , which represents the detection statistic at sample @xmath50 for a single transit pulse which is centered at @xmath50 . this can be done via @xmath53 repeated invocations of equation ( [ sesorig ] ) , in which we recenter the transit pulse at all possible times @xmath54 sequentially .",
    "although effective , this method of computing @xmath52 is cumbersome , requiring that the wavelet transform of equation ( [ wavelettransform ] ) and the dot product in equation ( [ sesorig ] ) be performed for each of the @xmath53 unique transit pulse models @xmath49 .",
    "an equivalent result can be achieved more efficiently by recognizing that the mass of invocations of equation ( [ sesorig ] ) is equivalent to computing a cross correlation , in which the array of different @xmath49 vectors is replaced by a single one , representing a single transit of unit depth centered at @xmath55 .    to compute the detection statistic @xmath17 for a given transit pulse centered at all possible time steps",
    ", we can simply doubly whiten @xmath56 ( i.e. divide @xmath57 point - wise by @xmath51 ) , correlate the results with @xmath58 , and apply the dot product relation , performing the analogous operations for the denominator , noting that @xmath59 is itself a time series : @xmath60 \\ast s_i(-n)}{\\sqrt{\\sum_{i=1}^m 2^{-\\min(i , m-1 ) } \\hat{\\sigma}_i^{-2}(n ) \\ast s_i^2(-n ) } } .",
    "\\\\\\end{aligned}\\ ] ] note that the ` @xmath61 ' in @xmath62 indicates time reversal .",
    "the @xmath63 and @xmath64 are introduced for convenience later on .    the quantity @xmath52 in equation ( [ ses ] )",
    "is referred to as the single event statistic ( ses ) time series .",
    "note that the quantity @xmath65 is the epected snr of the template in the data as a function of time , or the expected snr of a true signal that matches the shape and amplitude of the template exactly . to make explicit the dependence on the signal amplitude , @xmath66 , under @xmath12 let : @xmath67 the relevant statistical quantities",
    "are then given by : @xmath68 @xmath69 where , under @xmath9 , we can simply let @xmath70 .",
    "so under either hypothesis , the ses has unit variance .    up until now",
    "we have only explicitly used one of the signal parameters , namely , the transit duration @xmath71 , which is built into the template .",
    "the tps module currently searches over 14 trial transit durations logarithmically spaced between 1.5 hours up to 15 hours . to perform the search over the remaining two parameters , period and phase ( @xmath72 and @xmath73 respectively )",
    ", we must lay down a grid in the parameter space that balances the need to preserve sensitivity to the astrophysically interesting parameter space with the need for computational tractability .",
    "the sensitivity requirements dictate the spacing on the parameter space . for a discussion of this see @xcite . to perform the search over period and phase",
    ", the single event statistics must be folded using each discrete point in parameter space . in practice however , to reduce computation , a more sophisticated folding routine is employed that ensures all interesting portions of parameter space get searched while uninteresting portions are skipped over on a target - by - target basis @xcite . a description of how to compute the multiple event statistic ( mes ) , @xmath74 , is given here .    choosing a particular point in the @xmath75 space",
    "selects out a set , @xmath76 , of @xmath77 samples , one for each transit , that start with the sample corresponding to the epoch @xmath73 and are spaced @xmath72 samples apart .",
    "these samples form a subset of @xmath78 , @xmath79 .",
    "the mes is then constructed as : @xmath80",
    "this section will derive a version of the @xmath3 statistic that has been found to be useful in the analysis of _ kepler _ data .",
    "a brief summary of the formalism developed by allen is first in order .    the basic idea behind the construction of the test statistic is to break up the matched filter output into several contributions and compare each contribution with what is expected .",
    "what follows in this paragraph is taken from @xcite for completeness .",
    "first , the detector output @xmath17 is broken up into @xmath81 chunks .",
    "mathematically we have , @xmath82 where the @xmath83 are additive chunks of the filter output that when added together reproduce exactly the output value of the filter .",
    "these are the actual contributions to the filter output .",
    "next consider the @xmath81 quantities defined by @xmath84 where @xmath85 and the @xmath86 are the expected fractional contribution to @xmath17 from the @xmath87th chunk",
    ". the @xmath88 are then the set of differences between the @xmath81 actual contributions and expected contributions . by definition ,",
    "the @xmath88 s sum to zero @xmath89 and their expectation values vanish @xmath90 the @xmath3 statistic is then defined as @xmath91 note that with some basic assumptions on the detector noise , the expectation value of this statistic is independent of whether or not a signal is present in the data , thereby making this an ideal discriminator for noise events . the noise considered here",
    "is assumed to meet the following criteria : @xmath92 @xmath93 where @xmath94 is the dirac delta function .",
    "so we assume the whitened noise has zero mean , unit variance , and is uncorrelated .",
    "this concept can now be applied to the mes given in ( [ mes ] ) by breaking it up into a set of @xmath77 contributions , where again , @xmath77 is the number of transits .",
    "the mes calculation was done in the wavelet domain to properly whiten the data and templates . due to the imperfect localization of the filters in the owt however ,",
    "the wavelet components become correlated in an intricate way . in order to eliminate this correlation effect",
    "we can simply apply the inverse owt on the whitened data and template prior to computing the veto .",
    "this will also make it easier to compute the statistical properties of the quantities of interest as well as shed light on some of the subtle issues surrounding the calculation .",
    "the mes can be re - written as : @xmath95 where ` @xmath96 ' denotes a whitened vector and @xmath97 is a template with a transit pulse centered at the time corresponding to transit @xmath98 .",
    "now , let @xmath99 so clearly we have : @xmath100 similarly , identify @xmath86 as @xmath101 where clearly @xmath102 the @xmath83 are the temporal contributions to the mes and the @xmath86 are the fractional expected temporal contributions .",
    "the @xmath88 and @xmath3 statistic can be constructed as : @xmath103 @xmath104    there are three subtle issues involved in this calculation that have been neglected .",
    "the first issue is related to the calculation of the whitening coefficients , or the @xmath16 s , in ( [ sesorig ] ) .",
    "the noise is estimated at each wavelet scale by a moving circular mad filter .",
    "this method is robust against outliers but if there is a planetary transit signal in the data then it can perturb the whitening coefficients .",
    "the @xmath3 calculation requires that the @xmath105 components be explicitly independent of the presence of a transit signal .",
    "therefore , prior to computing the whitening coefficients , the in - transit samples are gapped and filled using an auto - regressive algorithm to guarantee the necessary signal independence of the whitening coefficients .    to understand the next subtlety associated with the calculation of the veto , consider that under @xmath12 , the data can in general be written : @xmath106 where @xmath107 is a transit pulse train rather than a transit centered at some time corresponding to transit @xmath87 as in the template version of @xmath108 .",
    "this difference introduces correlation in the @xmath83 s .",
    "this issue can be handled in a similar manner as the whitening coefficients above .",
    "to get rid of this correlation we simply have to gap and fill all the in - transit samples that are not associated to the transit identified by @xmath87 prior to computing each @xmath83 .",
    "this effectively turns @xmath109 into @xmath110 : @xmath111    the final subtlety is that after whitening our template in the wavelet domain we have to zero out all the out - of - transit samples since the effect of the transit gets smeared out across more samples even after doing the inverse owt .",
    "in fact , there would not be any out - of - transit samples with a value of zero in the template without the windowing .",
    "this correction is necessary so that the @xmath83 components achieve the correct statistical properties and so the @xmath88 have the correct correlation structure .",
    "note also that this windowing will make @xmath112 in general . in what follows",
    "it is assumed that these subtleties are being corrected for as stated above .",
    "the relevant statistical properties of the various quantities of interest can now be computed and summarized : @xmath113 where , @xmath114 the @xmath115 is the kronecker delta , and the statistical properties under @xmath9 can be obtained by letting @xmath70 .    using the afforementioned assumptions on the detector noise and also assuming a perfect match between the signal and template , a proof was given in @xcite that this @xmath3 statistic is @xmath3-distributed with @xmath116 degrees of freedom",
    "was proven to be a non - central @xmath3 distribution with @xmath116 degrees of freedom and a non - centrality parameter that was proportional to the mismatch and the snr squared . since we have assumed zero mismatch between the signal and template , the non - centrality parameter is zero and therefore the non",
    "- central @xmath3 distribution becomes the ( central ) @xmath3 distribution . ] .",
    "the cumulative probability that @xmath117 is given by : @xmath118 where @xmath119 is the incomplete gamma function . to check for this expected behavior we performed a 100,000 sample monte carlo under both @xmath9 and @xmath12 . to speed up the test we used 1024 sample time series of random white noise generated with different noise seeds . in the run under @xmath12",
    "we then injected three square waves that were 12 samples long and spaced 400 samples apart .",
    "each injected square wave had a depth of @xmath120 .",
    "the cumulative distribution functions for each hypothesis are shown in figure  [ f : cdfmontecarlo ] .",
    "the curves under both the null and alternative hypotheses match with the theoretical model extremely well for this gaussian noise case .    note that this version of the @xmath3 discriminator has been referenced in appendix",
    "a of @xcite .",
    "there , it is referred to as @xmath121 .",
    "the results presented in that work however use an older version that had not been fixed to account for the subtleties mentioned above .",
    "the version presented in that paper was also cast in the wavelet domain , which is flawed due to the correlation introduced as mentioned above .",
    "results given here in section  [ s : results ] are obtained with an updated codebase that takes into account all the subtleties and uses this re - cast time domain version . to allow for easier comparison",
    ", we will refer to this version of the @xmath3 in subsequent sections of this paper as @xmath121 .",
    "the @xmath3 statistic presented in section  [ s : chisquares ] involves splitting up the mes into its temporal contributions .",
    "in addition to this version , several other versions have also been explored that break up the detector output in other ways .",
    "one such alternate method analyzes the wavelet contributions to the ses . starting with ( [ ses ] )",
    ", we can identify the @xmath122 and @xmath105 wavelet components as : @xmath123 \\ast s_i(-n)}{\\sqrt{\\sum_{k=1}^m 2^{-\\min(k , m-1 ) } \\hat{\\sigma}_k^{-2}(n ) \\ast s_k^2(-n ) } } \\\\   & \\end{aligned}\\ ] ] and @xmath124 where now the @xmath125 are the actual contributions the the ses time series from the @xmath42th wavelet component and @xmath126 are the corresponding expected contributions .",
    "the @xmath127 and @xmath128 are the wavelet components of the previously defined @xmath63 and @xmath64 .",
    "now the @xmath3 statistic can be formed : @xmath129 @xmath130 ^ 2}{q_i(n)},\\ ] ] where @xmath131 is the number of wavelet scales and is determined by the number of data samples @xmath53 and the length of the mother wavelet filter chosen to implement the filter bank .",
    "this statistic would be @xmath3 distributed with @xmath132 degrees of freedom if there was no overlap between the wavelet scales . since there is overlap however , using this statistic for vetoing purposes can be dangerous because the overlap is difficult to model .",
    "we have a value for this statistic at each @xmath98 , so we can form a coherent statistic by adding up the @xmath77 points that contribute to the mes .",
    "this gives @xmath133 ^ 2}{q_i(j)}. \\\\\\end{aligned}\\ ] ] the degrees of freedom in the perfect case with no overlap between the wavelet scales would then become @xmath134 .",
    "in reality however , the overlap lowers the degrees of freedom and alters the correlation structure of the @xmath135 s thereby skewing the distribution form .",
    "this version of the statistic has been referenced in appendix a of @xcite .",
    "there it was referred to as @xmath136 as it is now being refferred to in this paper .",
    "there is no difference in the way this version was formulated in @xcite .    in a similar way",
    ", we could also analyze the wavelet contributions to the mes .",
    "@xmath138 where @xmath139 are the actual wavelet contributions to the mes and the @xmath140 are the expected wavelet contributions .",
    "now , @xmath3 can be constructed : @xmath141 @xmath142 where now @xmath143 is the sum over @xmath42 of @xmath139 in equation ( [ znew ] ) . again however , this statistic is not @xmath3-distributed with @xmath132 degrees of freedom due to the overlap between the wavelet scales .",
    "this statistic has not proven to be very useful , so it is being omitted from the numbering scheme .",
    "a version more akin to a classical @xmath3 statistic can be formulated by simply comparing each ses that contributes to the mes with what we expect .",
    "the observed value for each ses is given by equation ( [ sesorig ] ) , where we can make it more explicit that the transit pulse is centered at some time @xmath144 where @xmath98 . to avoid the subtle correlation issues that arise in the wavelet domain we also use whitened time domain vectors : @xmath145 the expected value is given by equation ( [ expectedses ] ) , again with the pulse centered at a specific @xmath144 : @xmath146 where a is the signal depth which can be estimated by robustly fitting the full whitened trial pulse train to the whitened data .",
    "with these components we can construct the classical @xmath3 as : @xmath147    other versions can be formulated that analyze the contributions to the ses and mes from each in - transit sample as well .",
    "these tend not to work well however since the number of degrees of freedom can become very high , thereby diluting the effect of any glitch that might be causing problems for the detector .",
    "of course , still more versions can be formulated by mixing these up in all possible permutations , for example , analyzing the wavelet contributions to the in - transit samples .",
    "up to this point it has been assumed that the true astrophysical signal matches exactly with one of the templates in the template bank . in tps currently however , this is never the case .",
    "the transiting planet search currently uses as its model a square wave pulse train that is parameterized by three parameters , namely , epoch or phase , period , and duration ( @xmath6 respectively ) .",
    "a discrete grid of templates on this three dimensional parameter space is used for the search , so even if a true astrophysical signal were square wave in shape , there would be mismatch induced by the discrete nature of the search grid . in transit duration",
    ", tps uses a logarithmically spaced set of 14 different values from 1.5 to 15 hours . for period and epoch",
    ", there is a minimum correlation requirement of 0.9 between neighboring templates that is used to determine the spacing .",
    "periods are searched in the range from a half a day out to half the length of the data since we currently require 3 transits for a detection .",
    "the epoch is then searched over @xmath148 $ ] . the mismatch induced by using this discrete three dimensional grid",
    "then adds to whatever inherent shape mismatch there is between the square wave pulse and the true astrophysical signal .",
    "the size of the total mismatch drives down the signal - to - noise ratio ( snr ) .",
    "this gives rise to a sort of balancing act between detection efficiency and computational time or tractability of the search . for a discussion of the correlation coefficient and",
    "how it relates to the match between neighboring templates see @xcite or @xcite .",
    "when a target is identified by tps as containing a threshold crossing event it gets sent on to the data validation ( dv ) portion of data processing pipeline .",
    "here , a model fitting algorithm fits an astrophysical model to the light curve .",
    "the astrophysical model employed is the geometric transit model of mandel and agol @xcite .",
    "the limb darkening is taken into account using the non - linear limb darkening model of claret @xcite which depends on some stellar parameters for the target star , namely its effective temperature , metallicity , and surface gravity .",
    "this level of complexity is required to produce the correct transit shape , which is not a square wave . in what follows",
    "we will assume that the true signal is perfectly described by this transit model pulse train that dv produces .    here",
    "we will consider only how the mismatch between signal and template can affect the distribution of @xmath121 of section  [ s : chisquares ] . recall that @xmath121 examines the temporal contributions to the mes .",
    "effectively then , each piece of the statistic is independent of the period since they are all treated individually .",
    "the mismatch in period simply causes the timing offset for a given transit to be a function of the transit time .",
    "so the period mismatch can just be lumped together with the epoch mismatch when we consider how much an individual transit can potentially be mismatched in time from the real transit .    to begin , let @xmath149 and @xmath150 denote the whitened , windowed , template and true astrophysical transit respectively , centered at some arbitrary time .",
    "now under @xmath12 the true signal is present in the data : @xmath151 where the ses is now given by : @xmath152 } { \\sqrt { \\tilde{\\textbf{s } } \\cdot \\tilde{\\textbf{s}}}}.\\end{aligned}\\ ] ] now schwartz s inequality can be used to bound the inner product of the template and signal vectors : @xmath153 or in terms of the associated unit vectors we have @xmath154 so the dot product of the unit vectors has to be in the range @xmath155 $ ] . as in @xcite ,",
    "this quantity is often referred to as the fitting factor ( and is directly related to the correlation coefficient discussed above ) .",
    "following @xcite , we can let @xmath156 or , adding back in the dependence on the normalization : @xmath157 where , without loss of generality , we can restrict @xmath158 to be in the range @xmath159 $ ] .",
    "now the template mismatch @xmath160 is given by : @xmath161    the mean and variance of the ses given in equations ( [ expectedses ] ) and ( [ sesvar ] ) can now be re - computed to account for this mismatch : @xmath162 @xmath163 where now @xmath164 is @xmath165 with @xmath49 replaced with @xmath166 .",
    "now it easy to understand the significance of the fitting factor .",
    "the optimal snr is reduced by this factor when the data is filtered with a template @xmath49 that does not match the true signal @xmath166 exactly .",
    "this analysis can easily be extended now to the mes by considering the full set of pulses .",
    "summing over the pulse set @xmath167 is equivalent to simply using the full pulse train @xmath168 since each pulse is being windowed : @xmath169 @xmath170 where the kronecker delta is used since the set of pulses are completely uncorrelated .",
    "this then gives : @xmath171 and substituting into ( [ schwarz ] ) gives : @xmath172 if we consider just the @xmath87th temporal contribution then the total fitting factor must be divided up : @xmath173 where the @xmath174 are a set of @xmath77 real constants satisfying : @xmath175 this shows quite simply that each temporal contribution has its own portion of the total mismatch of the pulse train and that they can all be different .",
    "this makes sense since , even if the shape of the transits in the pulse train are not changing , a period mismatch between the model and true signal will easily make the fractional mismatch depend on transit time .",
    "we are now in a position to re - calculate all the statistical properties of the relevant quantities as in equation ( [ statprops ] ) : @xmath176 where again , @xmath114 now the expectation value of the @xmath3 is given by : @xmath177 where @xmath178 is given by : @xmath179 the variance of the @xmath3 is then given by : @xmath180 so @xmath178 is a parameter depending on the degree of mismatch as well as the noise and is manifestly positive . in @xcite",
    "a proof was given that this @xmath3 actually has a non - central @xmath3 distribution with @xmath116 degrees of freedom and non - centrality parameter given by @xmath181 .",
    "as in @xcite , we can obtain an upper limit on @xmath178 from schwarz s inequality : @xmath182 now , summing both sides over @xmath87 and using ( [ keq ] ) , we have : @xmath183    since we have no prior knowledge of the mismatch between the true astrophysical signal and the template , we have no choice but to pick a suitable value for the purpose of estimating the non - centrality parameter . to this end",
    ", a monte carlo study has been performed to get an estimate of the integral average of the signal / template mismatch .",
    "the true astrophysical signal is generated exaclty as it is described above for dv , namely , using the mandel - agol geometric transit model with the non - linear limb darkening of claret .",
    "the impact parameter has been sampled uniformly in the range @xmath184 $ ] , the model transit durations have been sampled uniformly in the range @xmath185 $ ] , the transit depths have been sampled logarithmically ( to favor weaker signals ) in the range @xmath186 $ ] , and the stellar parameters used for limb darkening are pulled randomly from the set of @xmath187 + targets in the kepler input catalog ( kic ) that are routinely searched .",
    "i have assumed the noise is wgn .    for this study ,",
    "we focus on a single transit pulse rather than the full pulse train .",
    "however , the potential mismatch in period has been used to expand the range on the allowable epoch mismatches , so in effect it is being taken into account .",
    "in tps , the allowed period mismatch is @xmath188 where @xmath189 is the correlation coefficient ( set to 0.9 ) , @xmath71 is the transit duration , and @xmath53 is the number of transits . the epoch mismatch is then randomly sampled between : @xmath190 where @xmath71 is the pulse duration in the set that tps uses that most closely matches the randomly selected model value and @xmath53 is set to @xmath191 here since tps requires a minimum of @xmath191 transits . the epoch and transit duration mismatches",
    "have both been turned off , simultaneously , turned on , and also tested individually .",
    "two sets of pulse shapes have been used .",
    "one set is comprised of the square wave pulses that tps currently employs .",
    "the other set has been generated by using this monte carlo framework to build a set of normalized templates , averaged over randomly selected astrophysical models taken from the parameter space of interest mentioned above .",
    "this set of templates should on average have the best possible match to some random , true astrophysical signal . directly searching over the astrophysical parameter space in tps",
    "would add too much additional volume to the search parameter space and would push us outside the computational realm of feasability with our current resources .",
    "however , using these astrophysically motivated templates , that have been averaged over the parameter space , will be the subject of an investigation in the near future and could help us to achieve better detection efficiency and may also improve the vetoing power of the @xmath121 veto ( more details in section  [ s : thresholds ] ) .",
    "the results of this study are given in table [ mctable ] .",
    "from the table it is evident that the mismatch in transit duration is a small effect whereas period / epoch mismatch raises the average consistently by @xmath192 . even with the astrophysical model the mismatch for a single pulse is on average around @xmath193 , which is expected given that @xmath194 .",
    "this can be lowered by moving to a smaller spacing along the period dimension of parameter space at the price of increasing the computational time .",
    "this may prove to be better than searching over the space of true astrophysical models since that would require increasing the dimensionality of the parameter space .",
    "this will be the subject of future investigation .",
    "it is clear from the results however , that using the set of averaged astrophysical templates cuts the mismatch down by about a factor of @xmath195 .",
    "if the signal and template matched perfectly , then the results of section  [ s : chisquares ] show that our test statistic would be @xmath3 distributed . in this case",
    ", a threshold could be set by simply evaluating the @xmath3 cumulative distribution function . in reality",
    "however , there is mismatch between the signal and templates , so our test statistic has a non - central @xmath3 distribution . the threshold , @xmath196 , that we choose then depends on the expected snr and the mismatch .",
    "still , if we had a perfect understanding of the mismatch then we could set a reasonable threshold by evaluating the non - central @xmath3 cumulative distribution function .",
    "since we have no prior knowledge of the true astrophysical signal however , one way to proceed , as described in the previous section , is to understand what the integral average of the mismatch is and try and minimize it in any way possible ( e.g. by using astrophysically motivated templates ) .",
    "clearly , we need to allow some room for the true spread in mismatch when we set our threshold .",
    "the threshold for each candidate event will then be a function of the number of degrees of freedom and the non - centrality parameter .    in @xcite , one approach suggested is based around the fact that near the distribution maximum , when the non - centrality parameter is large compared to the degrees of freedom , the non - central @xmath3 distribution can be approximated by a gaussian of width @xmath16 , where @xmath16 is the standard deviation of the non - central @xmath3 distribution .",
    "so in that case , it is suggested that a reasonable threshold would be : @xmath197 where @xmath81 is a parameter that can be tuned empirically but would typically be something like  @xmath198 .",
    "this sort of threshold has been investigated for use in tps and is a subject of continued work .",
    "to date however , this method has not been successful , largely it is thought due to the variance of the set of true mismatches . so using this sort of thresholding scheme may hinge on our ability to lower the signal / template mismatch as described previously .",
    "an alternative thresholding method that seems to work well has additionally been investigated and is mentioned in @xcite and described for tps in @xcite . for completeness , it is now reproduced here .",
    "the dependence of the mean of @xmath121 on the degrees of freedom can be eliminated by dividing it out and forming what is commonly referred to as the reduced @xmath3 , or , @xmath199 ( assuming the signal and template matches perfectly and we have a @xmath3 distribution rather than the non - central @xmath3 discussed above ) : @xmath200 after doing this the expectation value becomes unity @xmath201 now we could simply choose a value of @xmath199 to threhold on empirically by testing it on prior search results . while doing this testing however it was noticed that there is some small advantage to thresholding on a different quantity that essentially converts the quantity into units equivalent to @xmath16 .",
    "the study was done using some of the earliest @xmath3 results from the pipeline and has since been revisited now that all the subtleties pointed out in section  [ s : chisquares ] have been addressed .",
    "the quantity we currently threshold on in the pipeline is given by : @xmath202 we currently use a value of @xmath203 for @xmath204 ( note that the mes threshold is set to @xmath0 based on a performance study in @xcite ) .",
    "we currently use both @xmath205 and @xmath121 for vetoing purposes in this manner .",
    "since the @xmath205 formalism is flawed by the fact that there is overlap in the wavelet components , we are working to replace that version with @xmath206 .",
    "for this reason , examples below will only be given for @xmath121 .",
    "since the method of thresholding , the model pulse shape , and the versions of the @xmath3 statistic used for vetoing are a subject of ongoing work , the goal here is to present some basic examples that utilize the current state of the art .",
    "begin by injecting three square wave pulses , each with a duration of @xmath207 samples , equidistant from one another in a @xmath208 sample time series .",
    "the square waves will be injected on top of zero mean , unit variance , gaussian noise and will each have a depth of @xmath209 .",
    "figure [ f : ex1 ] shows the whitened data chunks @xmath210 and the corresponding @xmath83 and @xmath86 for each transit .    for this example ,",
    "the mes given by equation ( [ mes ] ) is @xmath211 whereas the sum over all the @xmath83 is @xmath212 .",
    "the @xmath83 components and @xmath86 components , given by summing over the points in the corresponding plots , are : @xmath213 note that these values have been rounded .",
    "the @xmath3 can then be computed : @xmath214 with an associated probability computed by equation ( [ cumprob ] ) : @xmath215 and @xmath22 given by : @xmath216 so this is a very simple detection as it should be , but it serves to illustrate how the calculation works .",
    "now , the same three square waves will be injected except that the last one will have its duration halved by a factor of two .",
    "the results obtained are now : @xmath217 the mes is then @xmath218 and the @xmath3 , probability , and @xmath22 can then be computed : @xmath219 @xmath220 @xmath221 this illustrates how sensitive the veto is to mismatch in signal and template .    as another example",
    ", the same three square waves will be injected except the last one will now have its amplitude reduced by a factor of two .",
    "the results obtained are now : @xmath222 the mes is then @xmath223 and the @xmath3 , probability , and @xmath22 can then be computed : @xmath224 @xmath225 @xmath226 so the veto is sensitive to a mismatch in depth of one of the pulses as well .",
    "a logical extension of this would be to ask : how do these numbers change when there are more transits and still only a single transit is perturbed in some way ?",
    "when the degrees of freedom get large enough , the effect will get washed out to the point that the veto will no longer work .",
    "this behavior is acceptable in this case however , because if there are say , @xmath227 transits , and only one of them is perturbed in some way , we would still have reasonable belief there is something interesting in the data . clearly though",
    ", if many of the transits do not match well then the veto will work as it should .",
    "as described in @xcite , events that pass the mes threshold of @xmath0 in tps are then subjected to both a robust statistic test as well as the two @xmath3 tests mentioned in section  [ s : thresholds ] , in that order .",
    "recently , tps was run over a set of @xmath228 targets , ( known eclipsing binaries were all removed ) , with quarters @xmath229 , and with the @xmath3 thresholds turned down to gain an understanding of their operating characteristics .",
    "the set of kepler objects of interest ( koi s ) was used to understand the detection probability .",
    "the set of koi s is comprised mostly of known planets as well as planet candidates which have not gone through the vetting process .",
    "a set of @xmath230 koi stars , the best of the best , were set aside to examine the detection probability . to understand the false alarm probability ,",
    "the full set of @xmath231 unique koi target stars were removed from the total set of targets , the remainder of which forms the false alarm population of targets .",
    "of course , some of these false alarms may actually be true positives , but it is thought that the number is fairly low .",
    "it should also be noted that the false alarm and detection probabilities gleaned by a study of this sort are only to be used as an indicator since the true pipeline version of tps allows for searching over many period and epoch combinations , for each target , that produce a mes above threshold .",
    "here we have limited the number of searched combinations to only one per target .    after applying the mes threshold of @xmath0 ,",
    "there are @xmath232 targets that get filtered out of the @xmath230 koi s , giving a @xmath233 detection probability .",
    "there are then @xmath234 non - koi targets that produce `` false alarms '' , for a false alarm rate of @xmath235 . applying the robust statistic threshold of @xmath236 filters out an additional @xmath237 of the @xmath230 koi s for an overall detection probability of @xmath238 .",
    "the number of non - koi targets producing false alarms is reduced to @xmath239 , for an overall false alarm rate of @xmath240 .",
    "now we will just use these two sets of remaining targets namely , the set of @xmath241 koi s and the set of @xmath239 non - koi s , to explore various thresholds on @xmath242 .",
    "figure [ f : oc ] shows the operating characteristic curve for each @xmath22 individually .",
    "you can clearly see that @xmath243 achieves the best detection efficiency but would still , for some reasonable detection probability , let through an unacceptable number of false alarms if used alone . in figure",
    "[ f : probs ] , the corresponding false alarm and detection probabilities are plotted as a function of threshold @xmath244 .    as mentioned in @xcite ,",
    "tps currently uses @xmath245 and @xmath243 for vetoing purposes , the threshold for both set to @xmath203 .",
    "using @xmath246 instead of @xmath245 is the subject of ongoing work but is desirable due to the fact that the @xmath205 formalism is flawed for reasons mentioned previously . on this data",
    "set , using the current tps thresholds gives an overall ( mes , robust statistic , @xmath245 , and @xmath243 all being used ) detection probability of @xmath247 and an overall false alarm probability of @xmath248 or @xmath249 false alarm targets .",
    "if we were to replace @xmath245 with @xmath246 , and require the same detection probability , then the threshold for @xmath246 would have to be set at @xmath250 and would give an overall false alarm probability of @xmath251 , or @xmath252 targets .",
    "further investigation reveals that there is an issue with the fitted depth @xmath66 being used in the calculation of @xmath246 .",
    "the fitted depth comes from the robust fit of a whitened model pulse train to the whitened data when the robust statistic is being calculated .",
    "this value can be perturbed by the robust statistic algorithmn however , since it has some machinery built in that allows it to deemphasize cadences based on the robust fit weights .",
    "this can throw off the comparison between the observed and expected values . to address this problem , and hopefully improve the detection efficiency of @xmath246 enough to make it a more suitable replacement , the fitted depth is now being calculated by : @xmath253 we await future results .",
    "another recent run of tps was done over the same set of quarters and @xmath254 targets . in this run",
    "however , the full looping machinery was employed so that tps was examining up to @xmath255 events for each target that produced a sufficiently high mes . in this set of targets",
    "there were @xmath256 targets with high quality koi s , and @xmath257 total koi s in the sample .",
    "there were @xmath258 targets producing threshld crossing events ( tces ) .",
    "our detection probability in this run was @xmath259 whereas the overall false alarm probability was @xmath260 . in this run , using @xmath245 and @xmath243 with thresholds both at @xmath203 caused @xmath261 , or about half , of the total loss in detection probability . using the vetoes however dropped the number of false alarms from @xmath262 down to @xmath263 , or from @xmath264 overall false alarm rate down to just @xmath260 .",
    "this paper extends the conceptual framework in @xcite so that the formalism can be applied to the case of interest here , namely , in vetoing false alarms coming from the transiting planet search component of the _ kepler _ data processing pipeline .",
    "we have presented a set of potential vetoes and selected two , @xmath121 and @xmath206 , to be the subject of future work and development based upon the results presented here .",
    "these vetoes cut down the false alarm rate considerably and are crucial in maintaining a large enough search parameter space and detection probability .",
    "further mitigation of some of the known sources of systematic error ( image artifacts , etc ) , combined with improvements to this set of vetoes ( using better templates and switching to the method of thresholding described in section  [ s : thresholds ] ) are other avenues being pursued to improve detection efficiency .",
    "the author wishes to thank bruce allen for the original work on this subject from which most of this work is based . _",
    "kepler _ was selected as the @xmath265 mission of nasa s discovery program .",
    "funding for this work is provided by nasa s science mission directorate .",
    "d.  g.  koch , w.  j.  borucki , g.  basri , n.  m.  batalha , t.  m.  brown , d.  caldwell , j.  christensen - dalsgaard and w.  d.  cochran _ et al .",
    "_ , `` kepler mission design , realized photometric performance , and early science , '' astrophys .",
    "j.   * 713 * , l79 ( 2010 ) [ arxiv:1001.0268 [ astro-ph.ep ] ] .",
    "j.  m.  jenkins , d.  a.  caldwell , h.  chandrasekaran , j.  d.  twicken , s.  t.  bryson , e.  v.  quintana , b.  d.  clarke and j.  li _ et al .",
    "_ , `` overview of the kepler science processing pipeline , '' arxiv:1001.0258 [ astro-ph.ep ] .",
    "p.  tenenbaum , j.  m.  jenkins , s.  seader , c.  j.  burke , j.  l.  christiansen , j.  f.  rowe , d.  a.  caldwell and b.  d.  clarke _ et al .",
    "_ , `` detection of potential transit signals in the first twelve quarters of kepler mission data , '' arxiv:1212.2915 [ astro-ph.ep ] .",
    "j.  m. jenkins , l.  r. doyle , and d.  k. cullers , `` a matched filter method for ground - based sub - noise detection of terrestrial extrasolar planets in eclipsing binaries : application to cm draconis , '' icarus , 119:244 - 260 , february 1996 ."
  ],
  "abstract_text": [
    "<S> the _ kepler _ spacecraft observes a host of target stars to detect transiting planets . requiring a @xmath0 sigma detection in twelve quarters of data yields over @xmath1 detections , </S>",
    "<S> many of which are false alarms . after a second cut </S>",
    "<S> is made on a robust detection statistic @xcite , some @xmath2 or more targets still remain . </S>",
    "<S> these false alarms waste resources as they propagate through the remainder of the software pipeline and so a method to discriminate against them is crucial in maintaining the desired sensitivity to true events . </S>",
    "<S> this paper describes a @xmath3 test which represents a novel application of the formalism developed by allen @xcite for false alarm mitigation in searches for gravitational waves . using this technique , </S>",
    "<S> the false alarm rate can be lowered to @xmath4 .    </S>",
    "<S> [ 1]>m#1 </S>"
  ]
}