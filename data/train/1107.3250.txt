{
  "article_text": [
    "in this paper we are interested in hamilton - jacobi ( hj ) equations posed on a one dimensional domain containing one single singularity . this is a special case of a more general setting where hj equations are posed in domains that are unions of submanifolds whose dimensions are different @xcite .",
    "an intermediate setting is the study of hj equations on networks , see in particular @xcite .",
    "we will restrict ourselves to a very simple network : the union of a finite numbers of half - lines of the plane with a single common point .",
    "such a domain is referred to as a _ junction _ and the common point is called the _ junction point_. we point out that getting a comparison principle is the most difficult part in such a study ; it is obtained in @xcite for similar special networks ( bounded star - shaped ones ) .",
    "our motivation comes from traffic flows . for this reason ,",
    "it is natural to impose different dynamics on each _ branch _ of the junction .",
    "consequently , the resulting hamiltonian is by nature discontinuous at the junction point . together with the singularity of the domain",
    ", this is the major technical difficulty to overcome .",
    "the analysis relies on the complete study of some _ minimal action _ ( or _ metric _ ) related to the optimal control interpretation of the equation @xcite .",
    "we prove in particular that this minimal action is semi - concave by computing it .",
    "we first present the problem and the main results in details .",
    "then we recall existing results and compare them with ours .      in this subsection , the analytical problem is introduced in details .",
    "we first define the junction , then the space of functions on the junction and finally the hamilton - jacobi equation .",
    "[ [ the - junction . ] ] the junction .",
    "+ + + + + + + + + + + + +    let us consider @xmath0 different unit vectors @xmath1 for @xmath2 .",
    "we define the branches @xmath3 and the _ junction _ ( see figure [ f6 ] ) @xmath4 the origin @xmath5 is called the _ junction point_. it is also useful to write @xmath6 .    for a time @xmath7",
    ", we also define @xmath8 the reader can remark that we chose to embed the junction in a two - dimensional euclidean space .",
    "but we could also have considered an abstract junction , or we could have embedded it for instance in a higher dimensional euclidean space .",
    "we made such a choice for the sake of clarity .",
    "[ [ space - of - functions . ] ] space of functions .",
    "+ + + + + + + + + + + + + + + + + + +    for a function @xmath9 , we denote by @xmath10 the restriction of @xmath11 to @xmath12 .",
    "then we define the natural space of functions on the junction @xmath13 in particular for @xmath14 and @xmath15 with @xmath16 , we define @xmath17 then we set @xmath18    [ [ hj - equation - on - the - junction . ] ] hj equation on the junction .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + +    we are interested in continuous functions @xmath19 which are _ viscosity solutions _",
    "( see definition  [ defi : main ] ) on @xmath20 of @xmath21 submitted to an initial condition @xmath22 because of the optimal control problem we have in mind ( see subsection [ ss13 ] below ) , we restrict ourselves to the simplest case of discontinuous hamiltonians ; precisely , we consider @xmath23 where @xmath24 are convex functions whose legendre - fenchel transform is denoted @xmath25 .",
    "we recall that @xmath26 and @xmath27 we also consider @xmath28 therefore equation ( [ eq : main ] ) can be rewritten as follows @xmath29    [ [ the - optimal - control - framework . ] ] the optimal control framework .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    in this paragraph , we give an optimal control interpretation @xcite of the hamilton - jacobi equation .",
    "we define the set of admissible controls at a point @xmath30 by @xmath31 for @xmath32\\times j$ ] with @xmath33 ( the case @xmath34 being trivial and forcing @xmath35 ) , we define the set of admissible trajectories from @xmath36 to @xmath37 by @xmath38;{\\mathbb{r}}^2)\\colon   \\left|\\begin{array}{ll } x(\\tau)\\in j &   \\mbox{for all}\\quad \\tau \\in ( s , t),\\\\",
    "\\dot{x}(\\tau ) \\in a(x(\\tau ) ) & \\mbox{for a.e.}\\quad \\tau \\in ( s , t)\\\\ x(s)=y   & \\mbox{and}\\quad x(t)=x   \\end{array}\\right . \\right\\}.\\ ] ] for @xmath39 with @xmath40 , we define the lagrangian on the junction @xmath41 with @xmath42 the reader can be surprised by the definition of @xmath43 for @xmath5 .",
    "in fact , if one considers only trajectories that do not stay at the junction point , then the ones staying at @xmath44 are approximated by those staying very close to @xmath44 on a branch @xmath45 and moving `` slowly '' ( @xmath46 ) .",
    "we make the following assumptions :    [ [ a0 ] ] * ( a0 ) * + + + + + +    the initial data @xmath47 is lipschitz continuous .",
    "[ [ a1 ] ] * ( a1 ) * + + + + + +    there exists a constant @xmath48 , and for all @xmath2 , there exists @xmath49 functions @xmath25 satisfying @xmath50 , such that ( [ eq::r14 ] ) and ( [ eq::r13 ] ) hold .    [ th::r2 ] assume ( a0)-(a1 ) and let @xmath7 .",
    "then there exists a unique viscosity solution @xmath11 of ( [ eq : main])-([eq : ci ] ) on @xmath20 in the sense of definition  [ defi : main ] , satisfying for some constant @xmath51 @xmath52 moreover the function @xmath11 is lipschitz continuous with respect to @xmath37 on @xmath20 .    on one hand",
    ", we will see below that the existence of a solution can be obtained with perron s method under weaker assumptions than ( a1 ) ( see theorem  [ thm : perron ] ) . on the other hand ,",
    "we are able to get uniqueness of the solution only under assumption ( a1 ) and this is a consequence of the following result :    [ th::r1 ] assume ( a0)-(a1 ) .",
    "let @xmath7 and let @xmath11 ( resp .",
    "@xmath53 ) be a sub - solution ( resp .",
    "a super - solution ) of ( [ eq : main])-([eq : ci ] ) on @xmath20 in the sense of definition  [ defi : main ] .",
    "we also assume that there exists a constant @xmath51 such that for all @xmath54 @xmath55 then we have @xmath56 on @xmath20 .    in order to prove this strong uniqueness result",
    ", we will use in an essential way the _ value function _ associated to the optimal control problem described in subsection  [ ss13 ] : for @xmath57 , @xmath58 where @xmath59 is defined in ( [ eq::r15 ] ) and @xmath60 is defined in ( [ eq::r16 ] ) .",
    "[ th::r3 ] assume ( a0)-(a1 ) and let @xmath7 .",
    "the unique solution given by theorem [ th::r2 ] is @xmath61 with @xmath62 given in ( [ eq::r17 ] ) .",
    "moreover , we have the following hopf - lax representation formula @xmath63 with @xmath64    the comparison principle is obtained by combining    * a super - optimality principle for counterrevolutions @xmath53 , which implies @xmath65 ; * a direct comparison result with sub solutions @xmath11 , which gives @xmath66 .",
    "we finally have the following result which shed light on the role of the junction condition ( see the second line of ( [ eq::r12 ] ) ) .    [ th::r4 ]",
    "assume ( a0)-(a1 ) and let @xmath7 .",
    "let @xmath67 be such that @xmath68 and for each @xmath69 , the restriction @xmath10 of @xmath11 to @xmath12 is a classical viscosity solution of @xmath70 then @xmath11 is a sub - solution of ( [ eq : main])-([eq : ci ] ) on @xmath20 in the sense of definition  [ defi : main ] , and @xmath71 .",
    "an immediate consequence of theorem  [ th::r4 ] is the fact that the optimal control solution @xmath62 is the maximal continuous function which is a viscosity solution on each open branch .",
    "we apply in section  [ s5 ] our hj approach to describe traffic flows on a junction . in particular , we recover the well - known junction conditions of lebacque ( see @xcite ) or equivalently those for the riemann solver at the junction as in the book of garavello and piccoli @xcite ; see also @xcite .",
    "we already mentioned that the main difficulties we have to overcome in order to get our main results are on one hand the singular geometry of the domain and on the other hand the discontinuity of the hamiltonian .",
    "[ [ discontinuity . ] ] * discontinuity . * + + + + + + + + + + + + + + + +       several papers in the literature deal with hjb equations with discontinuous coefficients ; see for instance @xcite .",
    "note that in these works the optimal trajectories do cross the regions of discontinuities ( i.e. the junction in the present paper ) only on a set of time of measure zero . in the present paper",
    ", the optimal trajectories can remain on the junction during some time intervals , and the results cited above do not apply then to the problem studied here .",
    "on the other hand , the analysis of scalar conservation laws with discontinuous flux functions has been extensively studied , we refer to @xcite and references therein .",
    "we also point out that a uniqueness result is proved in @xmath72 in the framework corresponding a junction with two branches @xcite . to the best of our knowledge ,",
    "in the case of junctions with more than two branches , there are no uniqueness result .",
    "moreover , the link between hjb equations and conservation laws with discontinuous has been seldom investigated @xcite .",
    "the main differences between the study in @xcite and the one carried out in the present paper lie in the fact that in @xcite the lagrangian can depend on @xmath73 and is continuous with respect to this variable , while we consider a lagrangian which is constant in @xmath73 on each branch but can be discontinuous ( with respect to @xmath73 ) at the junction .",
    "we point out that we can not extend directly our approach to lagrangians depending on @xmath73 since we use extensively the representation formula ``  la hopf - lax '' . in order to generalise results in this direction ,",
    "the semi - concavity of the `` fundamental solution '' @xmath74 should be proved without relying on explicit computations .",
    "this question is very interesting but is out of the scope of the present paper .",
    "[ [ networks . ] ] * networks .",
    "* + + + + + + + + + + +       it is by now well known that the study of traffic flows on networks is an important motivation that give rise to several difficulties related to scalar conservation laws with discontinuous coefficients .",
    "this topic has been widely studied by many authors , see for instance @xcite and the references therein .",
    "however , the study of hjb equations on networks has been considered very recently ; the reader is referred to @xcite where eikonal equations are considered .",
    "a more general framework was also studied in @xcite where a definition of viscosity solutions on networks , similar to definition  [ defi : main ] , has been introduced .",
    "it would be interesting to extend the results of the present paper to more general networks but the obstacle is the same than the one to be overcome if one wants to deal with lagrangians depending on @xmath73 : for a general network , the complete study of the fundamental solution is probably out of reach .",
    "this is the reason why we only consider the very specific case of a junction in order to be able to overcome the difficulty of the discontinuity of the lagrangian .    [",
    "[ the - optimal - control - interpretation . ] ] * the optimal control interpretation . * + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +       as explained above , the comparison principle is proved by using in an essential way the optimal control interpretation of the hamilton - jacobi equation .",
    "the use of representation formulas and/or optimality principles is classical in the study of hamilton - jacobi equations @xcite .",
    "more specifically , it is also known that a `` metric '' interpretation of the hamilton - jacobi equation is fruitful @xcite .",
    "such an interpretation plays a central role in the weak kam theory @xcite .",
    "as far as our problem is concerned , we are not able to prove uniqueness of viscosity solutions by using the classical techniques of doubling variable .",
    "the idea used here is based on the equivalence between the viscosity super - solution and the super - optimality principle ( also known as weak - invariance principle ) , and by using representation formulas for the viscosity sub solutions .",
    "this representation seems to be new for hjb equations with discontinuous coefficients , see for instance @xcite .",
    "we would like next to be a bit more precise .",
    "the technical core of the paper lies in theorem  [ thm : minimal - action ] .",
    "this result implies that the function @xmath75 is semi - concave with respect to @xmath37 and @xmath36 and , if there are at least two branches ( @xmath76 ) , that @xmath74 satisfies @xmath77 ( in a weak sense made precise in the statement of theorem  [ thm : minimal - action ] ) . in the case where the lagrangians coincide at the junction point ( @xmath78 )",
    ", it turns out that the restriction @xmath79 of @xmath80 to @xmath81 belong to @xmath82 and is convex .",
    "a more general case is considered in this paper : lagrangians can differ at the junction point and in this case , the functions @xmath83 are not convex nor @xmath84 anymore for some @xmath85 .",
    "let us point out here that the assumptions on the hamiltonian @xmath24 , and in particular the fact that it does not depend on the space variable @xmath73 , plays a crucial role to establish the properties satisfied by the minimal action function @xmath86 .",
    "[ [ generalization - and - open - problems . ] ] * generalization and open problems . *",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    eventually , we briefly mention natural generalizations of our results and some important open problems .",
    "first of all , it would be natural to extend the results of this paper to more general setting where the hamiltonians @xmath24 depend on the space variable @xmath73 .",
    "moreover , it would be interesting to consider general networks with several junction points .",
    "dealing with non - convex and non - coercive hamiltonians is quite challenging and would require first to have a direct proof of the comparison principle which does not need to go through the interpretation of the viscosity solution as the value function of an optimal control problem .",
    "section  [ s5 ] is devoted to the application of our results to some traffic flow problems .",
    "in particular , the hj equation is derived and the junction condition is interpreted . in section  [ sec : visc ] , the definition of ( viscosity ) solutions is made precise . in section  [ sec : oc ] , the first important properties of optimal trajectories are given .",
    "section  [ sec : op ] is devoted to the proof of the main results of the paper .",
    "in particular , the comparison principle is proved by proving a super - optimality principle and by comparing sub solutions with the solution given by the optimal control interpretation of the equation . section  [ sec : complete ] is devoted to the proof of the technical core of the paper , namely the existence of test functions for the minimal action associated with the optimal control interpretation .",
    "[ [ distance - and - coordinates - in - the - junction . ] ] distance and coordinates in the junction .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    we denote by @xmath87 the geodesic distance defined on @xmath88 by @xmath89 for @xmath90 , @xmath91 denotes the ( open ) ball centered at @xmath73 of radius @xmath92 .",
    "we also consider balls @xmath93 centered at @xmath94 of radius @xmath95 . for @xmath30 ,",
    "let us define the index @xmath96 of the branch where @xmath73 lies .",
    "precisely we set : @xmath97 up to reordering the indices , we assume that there exists an index @xmath98 such that @xmath99 we also set @xmath100    [ [ functions - defined - in - mathbfj2 . ] ] functions defined in @xmath101 . + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    for a function @xmath102 defined on @xmath103 , we call @xmath104 its restriction to @xmath105",
    ". then we define the space @xmath106 we also call for @xmath15 with @xmath16 and @xmath107 with @xmath108 @xmath109 and @xmath110 and similarly @xmath111 we also set @xmath112",
    "in this section we present the derivation of the hamilton - jacobi formulation of traffic on a junction .",
    "we also discuss the meaning of our junction condition in this framework and relate it to known results .",
    "we consider a junction ( represented on figure [ f5 ] )    with @xmath113 incoming roads ( labeled by the index @xmath114 ) and @xmath115 outgoing roads ( labeled by @xmath116 ) .",
    "this means that the cars move on the incoming roads in the direction of the junction and then have to choose to go on one of the @xmath117 outgoing roads .",
    "we assume that the proportion of cars coming from the branch @xmath118 is a fixed number @xmath119 ( which may be not realistic for @xmath120 ) , and that the proportion of cars going on each branch @xmath121 is also a fixed number @xmath122 .",
    "we also assume the obvious relations ( for conservation of cars ) @xmath123 we denote by @xmath124 the car density at time @xmath125 and at the position @xmath126 on the branch @xmath127 .",
    "in particular , we assume that the traffic is described on each branch @xmath127 by a flux function @xmath128 .",
    "we assume @xmath129 the typical example of such flux function is given by the lwr model ( lighthill , whitham @xcite and richards @xcite ) , with @xmath130 where @xmath131 and @xmath132 are respectively the maximal velocity and the maximal car density in the model ) . in this model the critical car density @xmath133 where @xmath134 is maximal , is equal to @xmath135 .",
    "we assume that the car densities are solution of non linear transport equations : @xmath136 where we assume that the junction point is located at the origin @xmath137 .",
    "we do not precise yet the junction condition at @xmath137 , and we now proceed formally to deduce the hamilton - jacobi model of such a junction . for a function @xmath138 to determine ,",
    "let us consider the functions    @xmath139    then we can compute formally for @xmath140 @xmath141 this shows that for @xmath140 @xmath142 where @xmath143 remark that we can show similarly that ( [ eq::r3 ] ) is still true for the index @xmath144 replaced by @xmath118 with @xmath145 in particular , this shows ( at least when the quantities in ( [ eq::r3 ] ) are well defined ) that we can choose @xmath138 such that the total flux @xmath146 is given by @xmath147 and then we have @xmath148 if and only if @xmath149 which is exactly the expected condition which says that the proportion of incoming cars going in the junction from the branch @xmath150 is @xmath151 and the proportion of cars getting out of the junction which choose to go on the branch @xmath144 is @xmath152 .",
    "let us notice that if we choose the initial condition @xmath153 , then we deduce from ( [ eq::r4 ] ) that we have with @xmath154 @xmath155 which shows that _ @xmath156 can be interpreted as the total quantity of cars passing through the junction point @xmath137 during the time interval @xmath157_. as a consequence , the quantity @xmath158 can also be interpreted as the instantaneous flux of cars passing through the junction point .",
    "we now give a further interpretation of the problem in the special case @xmath159 . in the special case @xmath159 ,",
    "imagine for a moment , that we come back to a discrete description of the traffic , where each car of label @xmath127 has a position @xmath160 with the ordering @xmath161 .",
    "we can be interested in the label @xmath127 of the car @xmath162 which is the closest to the junction point @xmath137 .",
    "let us call it @xmath163 .",
    "we can normalize the initial data such that @xmath164 .",
    "then the quantity of cars that have passed through the junction point @xmath137 during the time interval @xmath157 is equal to @xmath165 , which is the exact discrete analogue of the continuous quantity @xmath166 .    on the other hand",
    "the number of cars between the positions @xmath167 and @xmath168 is obviously equal to @xmath169 , and its continuous analogue on the branch @xmath170 with @xmath171 , is @xmath172 .",
    "this shows that @xmath173 can be interpreted as the exact continuous analogue of the discrete labeling of the cars moving in the traffic .",
    "this interpretation is also meaningful on the `` exit '' branches , i.e. for @xmath121 . indeed , for such @xmath144 s",
    ", @xmath174 is the continuous analogue of the discrete label of the car that have decided to choose the branch @xmath144 and which is at time @xmath125 close to the position @xmath175 .",
    "we now set @xmath176 and we define the convex hamiltonians @xmath177 then we deduce from ( [ eq::r3 ] ) that we have @xmath178 with equality of the functions at the origin , i.e. @xmath179 notice that for the choice @xmath180 in ( [ eq::r155 ] ) , we get with @xmath181 for all @xmath182 , that @xmath183 in particular this shows that the @xmath184 are not all the same , even in the simplest case .",
    "a junction condition is still needed so that the solution of ( [ eq::r8 ] ) be uniquely defined . indeed , at first glance , one may think that @xmath185 is equal to @xmath146 which is given by ( [ eq::r4 ] ) ( where we have assumed ( [ eq::r11 ] ) ) .",
    "the point is that this condition can not be satisfied for every time .",
    "one way to be convinced oneself of that fact is to consider the case @xmath186 with @xmath187 .",
    "then , we look at solutions @xmath11 of the hamilton - jacobi equation in @xmath72 with the artificial junction . we can simply associate with it the classical conservation law on the whole real line .",
    "we can then consider a single shock moving with constant velocity for the conservation law .",
    "when this shock will pass through the junction point",
    "( let us say at time @xmath188 ) , this will mean that @xmath189 is discontinuous in space at the junction point .",
    "in particular the formal computations of subsection  [ s51 ] are no longer valid at that time @xmath188 , even if they are valid for @xmath190 . for a general problem",
    ", one may expect that our formal computations are only valid for almost every time ( even if it is not clear for us ) .    in view of theorem [ th::r4 ] ,",
    "if we restrict our attention to continuous solutions @xmath11 , then we will have @xmath71 where @xmath62 is the solution associated to the optimal control problem .",
    "this shows in particular that we have @xmath191 which means ( in view of ( [ eq::r6 ] ) and the interpretation of @xmath192 given in subsection [ s51 ] ) that we have a universal bound on the total amount of cars passing through the junction point during the time interval @xmath157 .",
    "if we assume moreover that this amount of cars is maximal , then we can choose ( and indeed have to choose ) @xmath61 and the natural junction condition is then @xmath193 with @xmath194 using our assumption ( [ eq::r0 ] ) on the functions @xmath195 , let us define for @xmath196 the demand functions @xmath197 and the supply functions @xmath198 from assumption ( [ eq::r0 ] ) on the functions @xmath195 , we deduce that @xmath199 condition ( [ eq::r9 ] ) means that @xmath200 notice that from ( [ eq::r11 ] ) , it is natural to compare @xmath201 then condition ( [ eq::r10 ] ) is nothing else that the demand and supply condition of lebacque , which claims that the passing flux is equal to the minimum between the demand and the supply , as it is defined in @xcite ( at least in the case @xmath159 ) .    in the special case @xmath159 , it is explained in @xcite that this condition ( [ eq::r10 ] ) is also equivalent to the condition defining the riemann solver at the junction point in the book of garavello and piccoli @xcite .",
    "let us notice that this condition is also related to the bardos , le roux , ndelec @xcite boundary condition .",
    "in this section , we consider a weaker assumption than ( a1 ) . we introduce the following assumption :    [ [ a1 - 1 ] ] ( a1 ) + + + + +    for each @xmath202 ,",
    "* the function @xmath203 is continuous and @xmath204 * there exists @xmath205 such that @xmath24 is non - increasing on @xmath206 $ ] and non - decreasing on @xmath207 ;    when ( a1 ) holds true , the function @xmath208 is defined by @xmath209 .",
    "we now make the following useful remark whose proof is left to the reader .",
    "[ lem::r18 ] assumption ( a1 ) implies assumption ( a1 ) .",
    "next we give equivalent definitions of viscosity solutions for .",
    "we give a first definition where the junction condition is satisfied in `` the classical sense '' ; we then prove that it is equivalent to impose it in `` the generalized sense '' .",
    "it is essential if one expects solutions to be stable .",
    "we give a first definition of viscosity solutions for in terms of test functions by imposing the junction condition in the classical sense .",
    "we recall the definition of the upper and lower semi - continuous envelopes @xmath210 and @xmath211 of a function @xmath212 : @xmath213    [ defi : main ] a function @xmath214 is a _ sub - solution ( resp .",
    "super - solution ) of on @xmath20 _ if it is upper semi - continuous ( resp .",
    "lower semi - continuous ) and if for any @xmath215 such that @xmath216 in @xmath217 for some @xmath218 , @xmath95 and such that @xmath219 at @xmath220 , we have @xmath221 that is to say    * if @xmath222 , then @xmath223 * if @xmath224 , then @xmath225    a function @xmath214 is a _ sub - solution ( resp .",
    "super - solution ) of - on @xmath20 _ if it is a sub - solution ( resp .",
    "super - solution ) of on @xmath20 and moreover satisfies @xmath226 ( resp .",
    "@xmath227 ) .    a function @xmath228 is a _ ( viscosity ) solution of ( resp .",
    "- ) on @xmath20 _ if @xmath210 is a sub - solution and @xmath211 is a super - solution of ( resp .",
    "- ) on @xmath20 .    as mentioned above , the following proposition is important in order to get discontinuous stability results for the viscosity solutions of definition  [ defi : main ] .",
    "[ prop : equiv - def ] assume ( a1 ) .",
    "a function @xmath229 is a sub - solution ( resp .",
    "super - solution ) of on @xmath20 if and only if for any function @xmath230 such that @xmath216 in @xmath20 and @xmath219 at @xmath231 ,    * if @xmath222 , then @xmath232 * if @xmath224 , then either there exists @xmath233 such that @xmath234 or holds true .",
    "we classically reduce to the case where the ball @xmath217 is replaced with @xmath20 .",
    "the `` if '' part is clear . let us prove the `` only if '' one .",
    "we distinguish the sub - solution case and the super - solution one .",
    "we start with super - solutions since it is slightly easier .    * case 1 : super - solution case .",
    "* we consider a test function @xmath215 such that @xmath235 in @xmath20 and @xmath236 at @xmath237 .",
    "there is nothing to prove",
    "if @xmath238 so we assume @xmath239 .",
    "we have to prove that @xmath240 .",
    "we argue by contradiction and we assume that @xmath241    then it is easy to see that there exists a function @xmath242 such that @xmath243 with equality at the point @xmath244 and such that @xmath245 notice that @xmath246 the first inequality is straightforward . to check the second inequality , we have to distinguish two cases .",
    "either we have @xmath247 , and then @xmath248 and we use the fact that the minimum of @xmath208 is @xmath249 . or @xmath250 and then this common value belongs to the interval @xmath206 $ ] on which we have @xmath251 .    since @xmath252 in @xmath20 and @xmath253 at @xmath244 , we conclude that either @xmath254 or there exists @xmath233 such that @xmath255 in view of and , we obtain a contradiction with .    * case 2 : sub - solution case . * we consider a function @xmath256 such that @xmath216 in @xmath20 and @xmath236 at @xmath237",
    ". there is nothing to prove if @xmath257 and we thus assume @xmath239 .",
    "we have to prove that @xmath258 .",
    "we argue by contradiction and we assume that @xmath259    in order to construct a test function @xmath260 , we first consider @xmath261 the set of @xmath144 s such that @xmath262 since @xmath263 is coercive , there exists @xmath264 such that @xmath265 .",
    "we next consider a test function @xmath266 such that @xmath267 with equality at @xmath244 and such that @xmath268 notice that for all @xmath269 , @xmath270 where for the inequality , we have in particular used the fact that @xmath263 is non - decreasing on @xmath271 .    since @xmath272 in @xmath20 and @xmath253 at @xmath244",
    ", we conclude that either @xmath273 or there exists @xmath269 such that @xmath274 in view of and , we obtain a contradiction with .",
    "this ends the proof of the proposition .",
    "we now prove theorem  [ th::r4 ] .",
    "let us consider a function @xmath215 such that @xmath275 with equality at @xmath244 with @xmath276 .",
    "modifying @xmath277 if necessary , we can always assume that the supremum of @xmath278 is strict ( and reached at @xmath244 ) .",
    "for @xmath279 , we set @xmath280 because @xmath11 is continuous at @xmath244 , we get for @xmath281 that @xmath282 where @xmath283 is a point where the supremum in @xmath284 is reached .",
    "moreover given the components @xmath285 for @xmath286 , we can use ( [ eq::r21 ] ) in order to find @xmath287 small enough to ensure that @xmath288 .",
    "then we have in particular the following sub - solution viscosity inequality at that point @xmath289 : @xmath290 therefore passing to the limit @xmath291 , we get @xmath292 because this is true for any @xmath293 , we finally get the sub - solution viscosity inequality at the junction : @xmath294 now the fact that @xmath295 follows from the comparison principle .",
    "this ends the proof of the theorem .",
    "we already mentioned that the optimal control solution of the hamilton - jacobi equation defined by plays a central role in our analysis .",
    "we remark that for @xmath90 and @xmath296 , @xmath297 where @xmath298 more generally , keeping in mind the weak kam theory , we define the so - called _ minimal action",
    "_ @xmath299 by @xmath300 it is convenient to extend @xmath301 to @xmath302 .",
    "we do so by setting @xmath303    under assumptions ( a0)-(a1 ) , it is possible ( and easy ) to prove the following dynamic programming principle : for all @xmath30 and @xmath304 $ ] , @xmath305 notice that a super - optimality principle will be proved in proposition  [ prop : superopt ] .    before stating the main result of this section , we    the following result can be considered as the core of our analysis .",
    "the most important part of the following theorem is the fact that the minimal action is semi - concave with respect to @xmath37 ( resp .",
    "@xmath36 ) .",
    "[ thm : minimal - action ] @xmath301 is finite , continuous in @xmath306 and lower semi - continuous in @xmath307 .",
    "moreover , for all @xmath308 and @xmath309 , @xmath310 , there exist two functions @xmath311 and @xmath95 such that    * @xmath312 on a ball @xmath313 with equality at @xmath314 and @xmath315 * @xmath316 on a ball @xmath317 with equality at @xmath318 and @xmath319    moreover , for all @xmath320 , there exists a constant @xmath321 such that we have @xmath322    as we shall see when proving this result , we can even require equalities instead of inequalities in and .",
    "since the proof of theorem  [ thm : minimal - action ] is lengthy and technical , we postpone it until section  [ sec : complete ] . when proving the main results of our paper in the next section , we also need the following lower bound on @xmath301 .",
    "we remark that this bound ensures in particular that it is finite .",
    "[ lem : am ] assume ( a1 ) .",
    "then @xmath323 where @xmath324 , @xmath325 appears in ( a1 ) , @xmath326 and @xmath327 is chosen as in ( [ eq::r26 ] ) .",
    "moreover , @xmath328 in particular , if @xmath329 , then @xmath330 as @xmath331 .",
    "we only prove the first inequality since the remaining of the statement is elementary .",
    "we have @xmath332 this shows that @xmath333 thus we can write for @xmath334 , @xmath335 then jensen s inequality allows us to conclude .",
    "in this section , we investigate the uniqueness of the solution of - . in particular , we will show that the solution constructed by perron s method coincide with the function @xmath62 coming from the associated optimal control problem .      in this subsection",
    ", we will show that a super - solution satisfies a super - optimality principle .",
    "for the sake of clarity , we first give a formal argument to understand this claim .",
    "we consider the auxiliary function , for @xmath336 , @xmath337 and we are going to explain formally that it is non - decreasing with respect to @xmath338 as soon as @xmath11 is a super - solution of .",
    "we call this property a super - optimality principle .",
    "notice that this is strongly related to the fact that the quantity @xmath339 is constant in @xmath338 if @xmath11 is equal to the optimal control solution @xmath62 .",
    "assume that the infimum defining @xmath340 is attained for some @xmath341 .",
    "then we write @xmath342 moreover assuming @xmath301 to be smooth ( which is not the case ) , we formally get from ( [ eq::r61 ] ) the fact that @xmath343 ( at least in the case @xmath76 ) . hence @xmath344",
    "we thus conclude that @xmath345 is non - decreasing if @xmath11 is a super - solution of .",
    "we now give a precise statement and a rigorous proof .",
    "[ prop : superopt ] assume ( a1 ) .",
    "let @xmath19 be a super - solution of on @xmath20 such that there exists @xmath346 such that for all @xmath347 , @xmath348 then for all @xmath347 and @xmath349 $ ] , @xmath350 assume moreover ( a0 ) and that @xmath11 is a super - solution of ( [ eq : main])-([eq : ci ] ) on @xmath20 .",
    "then we have @xmath351 on @xmath352 .",
    "the proof proceeds in several steps",
    ".    * step 1 : preliminary . * notice first that from ( [ eq::r41 ] )",
    ", we get @xmath353 using the lower semi - continuity of @xmath301 , we see that the infimum in @xmath354 of this function is then reached for bounded @xmath354 s .",
    "moreover by lower semi - continuity of the map @xmath355 , we deduce in particular that the map @xmath356 ( and then also @xmath357 ) is lower semi - continuous .    *",
    "step 2 : the map @xmath358 is non - decreasing .",
    "* we are going to prove that for @xmath359 , @xmath360 in the viscosity sense .",
    "we consider a test function @xmath102 touching @xmath345 from below at @xmath361 .",
    "there exists @xmath362 such that @xmath363 we deduce from the definition of @xmath345 that @xmath364 \\le u(s , y ) - u ( \\bar s , \\bar y).\\ ] ] by theorem  [ thm : minimal - action ] , there exists a test function @xmath365 such that @xmath366 on a ball @xmath367 with equality at @xmath368 .",
    "hence , we can rewrite the previous inequality by replacing @xmath74 with @xmath365 .",
    "we then obtain that @xmath369 is a test function touching @xmath11 at @xmath370 from below .",
    "since @xmath11 is a super - solution of , we have in the cases @xmath371 or @xmath372 and @xmath373 @xmath374 and in the case @xmath372 and @xmath375 @xmath376 where we used the properties of the function @xmath365 given by theorem  [ thm : minimal - action ]",
    ".    * step 3 : conclusion .",
    "* let us define for @xmath54 the following kind of lower semi - continuous envelope ( for the past in time ) @xmath377 let us notice that we have @xmath378 given a point @xmath54 , let us consider a sequence @xmath379 such that @xmath380 using lemma  [ lem : am ] , we have for any @xmath381 @xmath382 therefore from the lower semi - continuity of @xmath340 , we get @xmath383 again from the lower semi - continuity of the map @xmath384 , we get passing to the lower semi - continuous envelopes in @xmath37 : @xmath385 where we have used ( [ eq::r71 ] ) .",
    "this shows ( [ eq : superopt ] ) for @xmath386 .",
    "this is still true for @xmath34 by definition of @xmath301 .",
    "the proof is now complete .",
    "[ prop : subopt ] let @xmath387 be a sub - solution of -([eq : ci ] ) on @xmath20 , such that there exists @xmath346 such that for all @xmath347 , @xmath388 then we have @xmath295 on @xmath20 .    in order to prove proposition  [ prop : subopt ] , we first state and prove two lemmas .",
    "[ lem::r46 ] assume ( a0)-(a1 ) .",
    "then the function @xmath62 defined in ( [ eq::r17 ] ) satisfies @xmath389    we first get a bound from below . using ( [ eq::r41 ] ) , we deduce ( denoting by @xmath390 the lipschitz constant for @xmath47 ) : @xmath391 with @xmath392 this implies that @xmath393    we next get a bound from above .",
    "we have @xmath394 with @xmath395 this ends the proof of the lemma .",
    "[ lem::r72 ] assume ( a0)-(a1 ) .",
    "let @xmath396 be a sub - solution of -([eq : ci ] ) on @xmath20 , satisfying .",
    "then there exists a constant @xmath397 such that @xmath398    using the lipschitz regularity of @xmath47 , we can easily consider a smooth approximation @xmath399 of @xmath47 such that @xmath400 and @xmath401 as @xmath402 .",
    "then consider the following supremum for @xmath403 @xmath404 we claim that @xmath405 for some @xmath406 large enough independent on @xmath407 small enough .",
    "the lemma will be obtained by letting @xmath408 and @xmath409 go to @xmath44 .",
    "we argue by contradiction and assume that @xmath410 .",
    "thanks to , the supremum @xmath411 is attained for some @xmath412 .",
    "if @xmath413 , we have @xmath414 .",
    "therefore @xmath296 and we can use the fact that @xmath11 is a sub - solution to obtain for @xmath15 @xmath415 where we have used assumption ( a1 ) to estimate @xmath416 from below . notice that we have also made use of a slight abuse of notation in the case @xmath224 .",
    "choosing @xmath417 allows us to conclude to a contradiction .",
    "this ends the proof of lemma  [ lem::r72 ] .",
    "we now turn to the proof of proposition  [ prop : subopt ] .",
    "the proof proceeds in several steps .",
    "* step 1 : preliminaries .",
    "* let us consider @xmath418 from lemmas  [ lem::r46 ] and [ lem::r72 ] , we deduce that we have @xmath419 .",
    "we want to prove that @xmath420 .    to this end",
    ", we perform the usual corrections considering the following supremum for @xmath407 @xmath421    as it is proved classically , we also have that @xmath422 as @xmath423 where @xmath424 we argue by contradiction by assuming that @xmath425 and then @xmath426 for @xmath427 small enough and fixed for the rest of the proof",
    ".    * step 2 : reduction to @xmath428 . * notice that the supremum @xmath429 is achieved for points @xmath430 . using again lemmas  [ lem::r46 ] and [ lem::r72 ]",
    ", we also deduce that @xmath431 and hence @xmath432 for @xmath408 small enough .",
    "* step 3 : a priori bounds . * using the argument of step  1 of the proof of proposition [ prop : superopt ] , we see that there exists @xmath433 such that @xmath434 therefore we can rewrite @xmath429 as @xmath435 and the supremum is achieved for @xmath436 .",
    "notice that this supremum looks like the classical one for proving the comparison principle for viscosity solutions , with the usual penalization term @xmath437 replaced here by the function @xmath438 .    in view of the bound ( [ eq::r41",
    "] ) from below on @xmath301 and , we derive from @xmath439 that @xmath440 where @xmath390 denotes the lipschitz constant of @xmath47 .",
    "we conclude that there exists @xmath441 such that @xmath442 where @xmath441 depends on @xmath443 , @xmath444,@xmath445 , @xmath390 and @xmath325 .",
    "* step 4 : getting the viscosity inequality . * since @xmath446 , we have in particular that @xmath447 by theorem  [ thm : minimal - action ] , there exists a test function @xmath277 such that @xmath448 on a ball @xmath449 with equality at @xmath450 .",
    "hence , we can rewrite the previous inequality by replacing @xmath74 with @xmath277 .",
    "we then obtain that @xmath451 touches @xmath11 from above at @xmath452 with @xmath453 .",
    "we use next that @xmath11 is a sub - solution of and get for @xmath454 @xmath455 where we have made use of a slight abuse of notation in the case @xmath456 . on the other hand , we have @xmath457 therefore @xmath458 on the one hand , from ( [ eq : penal ] ) , we have @xmath459 . on the other hand , we can use ( [ eq : penal ] ) and ( [ eq::r73 ] ) in order to conclude that @xmath460 for some constant @xmath461 which does not depend on @xmath408 .",
    "we can now use the fact that the hamiltonians are locally lipschitz continuous in order to get the desired contradiction for @xmath408 small enough .",
    "this ends the proof of the proposition .      in this subsection",
    ", we prove the main results announced in the introduction .",
    "we simply apply propositions  [ prop : superopt ] and [ prop : subopt ] and get @xmath462 which implies the result .    in order to prove theorem  [ th::r2 ]",
    ", we should first prove that solutions are lipschitz continuous .",
    "[ pro::r74 ] assume ( a0)-(a1 ) .",
    "let @xmath11 be a solution of - on @xmath20 .",
    "then @xmath11 is lipschitz continuous with respect to @xmath37 on @xmath20 .",
    "we first recall ( see lemma  [ lem::r18 ] ) that ( a1 ) implies ( a1 ) . we know that the solution @xmath463 given by theorem  [ thm : perron ]",
    "satisfies for some constant @xmath397 and all @xmath347 , @xmath464 from the comparison principle ( theorem  [ th::r1 ] ) , we deduce that @xmath465 and then the solution @xmath466 is continuous .    for @xmath467 small ( with @xmath468 ) , we now consider @xmath469 and @xmath470 this new function satisfies in particular @xmath471 . therefore @xmath53 is a sub - solution of - on @xmath472 .",
    "we thus conclude from the comparison principle that @xmath473 , which implies @xmath474 arguing similarly , we can prove that @xmath475 . because @xmath476 can be chosen arbitrarily small ,",
    "we conclude that @xmath11 is lipschitz continuous with respect to time on the whole @xmath20 .",
    "since @xmath11 is a viscosity solution of , it satisfies in particular ( in the viscosity sense ) for each @xmath202 : @xmath477 this implies that there exists a constant @xmath478 such that ( in the viscosity sense ) @xmath479 this implies that @xmath11 is lipschitz continuous with respect to the space variable .",
    "this ends the proof of the lemma .",
    "we now turn to the proof of theorem  [ th::r2 ] .",
    "the uniqueness of the solution follows from theorem  [ th::r1 ] .",
    "the existence is obtained thanks to the optimal control interpretation ( @xmath62 is a solution ) .",
    "the lipschitz regularity was proved in lemma  [ pro::r74 ] above .",
    "the proof of theorem  [ th::r2 ] is now complete .",
    "the fact that the solution is equal to @xmath62 follows from propositions  [ prop : superopt ] and [ prop : subopt ] .",
    "the representation formula  ( [ eq::r77 ] ) follows from ( [ eq::r76 ] ) .",
    "we start this section with the following remark : the analysis can be reduced to the case @xmath480 . precisely , using the fact that the hamiltonian does not depend on time and is positively homogeneous with respect to the state",
    ", the reader can check that a change of variables in time yields the following    [ lem : reduced ] for all @xmath481 and @xmath482 , we have @xmath483    this is the reason why we consider the reduced minimal action @xmath484 defined by @xmath485 thanks to the previous observation , it is enough to prove the following theorem in order to get theorem  [ thm : minimal - action ] .    [",
    "thm : minimal - action-0 ] let us assume ( a1 ) .",
    "then for all @xmath486 , the @xmath487 is finite .",
    "it is continuous in @xmath488 and for all @xmath489 , there exists a function @xmath490 such that @xmath491 on @xmath488 , @xmath492 and we have @xmath493 and if @xmath494 , @xmath495 and if @xmath496 , @xmath497 moreover , for all @xmath498 , there exists @xmath321 such that for all @xmath481 , @xmath499    if @xmath500 , then we have @xmath501 .",
    "this good case corresponds to the case where all the @xmath502 s are equal .",
    "we can interpret lemma  [ lem : am ] as follows .",
    "assume ( a1 ) .",
    "then @xmath503 where constants are made precise in lemma  [ lem : am ] .",
    "we are going to see that the infimum defining the minimal action can be computed among piecewise linear trajectories , and more precisely among trajectories that are linear as long as they do not reach the junction point .",
    "this is a consequence of the fact that the hamiltonians do not depend on @xmath73 and are convex ( through jensen s inequality ) .    in order to state a precise statement",
    ", we first introduce that optimal curves are of two types : either they reach the junction point , or they stay in a branch and are straight lines .",
    "this is the reason why we introduce first the action associated with straight line trajectories @xmath504 and the action associated with piecewise linear trajectories passing through the junction point @xmath505 where @xmath506 and @xmath507    by defining the @xmath508 s in such a way , we treat the degenerate cases : @xmath5 or @xmath496 .",
    "indeed , @xmath509 ( resp .",
    "@xmath510 ) measures how long it takes to the trajectory to reach the junction point ( resp . the final point @xmath73 ) from the starting point @xmath354 ( resp .",
    "the junction point ) .",
    "the following facts will be used several times .",
    "[ lem : cont - ei ] the function @xmath511 ( resp .",
    "@xmath512 ) is continuous in @xmath513 \\times j^*$ ] ( resp . in @xmath514 ) .",
    "[ lem : lsc - ei ] the function @xmath508 , @xmath515 are lower semi - continuous in @xmath516 \\times j$ ] .",
    "consider the function defined for @xmath517\\times j$ ] by @xmath518 from the inequality for @xmath519 ( consequence of ( [ eq::r50 ] ) ) : @xmath520 we deduce that @xmath138 is lower semi - continuous .",
    "consequently , the map @xmath511 is lower semi - continuous .",
    "we proceed similarly for @xmath512 .",
    "we first show the main lemma of this subsection .",
    "[ lem : optim - curv ] the infimum defining the reduced minimal action @xmath80 can be computed among piecewise linear trajectories ; more precisely , for all @xmath481 , @xmath521    we write with obvious notation @xmath522 . in order to prove the lemma ,",
    "it is enough to consider a curve @xmath523 and prove that @xmath524 to do so , we first remark that the uniform convexity of @xmath25 implies that for all @xmath525 , we have @xmath526 we now consider an admissible trajectory @xmath527 \\to j$ ] and we treat different cases .",
    "case a : @xmath528 .",
    "we assume that a curve @xmath126 stays in one of the branch @xmath529 on the time interval @xmath530 with @xmath531 .",
    "in such a case , we consider the curve @xmath532 with same end points @xmath533 and @xmath534 in @xmath535 but linear .",
    "if @xmath525 is such that @xmath536 for @xmath537 and @xmath538 , we deduce from that @xmath539    case b : @xmath540 ) \\subset j_i$ ] with @xmath541 . in that case , let us set @xmath542 for @xmath543 $ ] . using ( [ eq::r42 ] ) with @xmath544 and the definition of @xmath545 as a minimum of the @xmath546 s ( see ( [ eq::r26 ] ) )",
    ", we get that @xmath547 from what we deduce that ( [ eq::r27 ] ) still holds true .",
    "case c : the general case . by assumption , we have @xmath548)$ ] .",
    "we then distinguish two cases .",
    "either @xmath549)$ ] , and then we define @xmath532 as in case  a. in this case , implies that @xmath550 or @xmath551)$ ] , and then we call @xmath552\\subset [ s , t]$ ] the largest interval such that @xmath553 , and define @xmath532 as follows : it is linear between @xmath44 and @xmath509 , and reaches @xmath44 at @xmath509 ; it stays at @xmath44 in @xmath554 ; then it is linear in @xmath555 and reaches @xmath73 at @xmath556 .",
    "using again the continuity of @xmath126 , we can find a decomposition of @xmath552 $ ] as a disjoint union of intervals @xmath557 ( with an at most countable union ) @xmath558=\\bigcup_{k } { \\mathcal i}_k\\ ] ] such that for each @xmath127 , @xmath559 for some @xmath560 and @xmath137 on @xmath561 .",
    "using case a or case b on each segment @xmath562 , we deduce that @xmath563      [ lem : dzun - cont ] the function @xmath564 is continuous in @xmath488 .",
    "we first prove that @xmath564 is lower semi - continuous .",
    "we know from lemma  [ lem : lsc - ei ] that the function @xmath565 is lower semi - continuous for @xmath486 and @xmath566 .",
    "therefore the function @xmath567 is also lower semi - continuous ( since the infimum is taken over a compact set ) . besides , the infimum is in fact a minimum .",
    "we now prove that @xmath564 is upper semi - continuous at any point @xmath568 .",
    "consider first @xmath569 ^ 2 $ ] such that @xmath570 given any sequence @xmath571 , we want to show that @xmath572 we use @xmath573 with an appropriate choice of @xmath574 .",
    "[ [ case-1-yin - j_j - xin - j_i . ] ] case 1 : @xmath575 , @xmath576 .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    in this case , we choose @xmath577 and we use lemma  [ lem : cont - ei ] in order to get @xmath578 and @xmath579 hence we conclude that ( [ eq::r85 ] ) holds true .    [ [ case-2-y0-xin - j_i . ] ] case 2 : @xmath496 , @xmath576 .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    we choose @xmath580 we still have @xmath581 and we can use lemma  [ lem : cont - ei ] in order to get @xmath582 we also have ( if @xmath583 ) @xmath584 hence we conclude that ( [ eq::r85 ] ) holds true .",
    "[ [ case-3-yin - j_j - x0 . ] ] case 3 : @xmath575 , @xmath5 .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    we choose @xmath585 ^ 2 $ ] we still have @xmath586 and then @xmath578 ( since @xmath511 is continuous in @xmath513 \\times j^*$ ] )",
    ". we also have ( if @xmath587 ) @xmath588 hence we conclude that ( [ eq::r85 ] ) holds true .",
    "[ [ case-4-y0-x0 . ] ] case 4 : @xmath496 , @xmath5 .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    we choose @xmath589 $ ] .",
    "we deduce from and .",
    "the function @xmath80 is continuous in @xmath488 .",
    "since @xmath590 is lower semi - continuous , we can use lemmas  [ lem : optim - curv ] and [ lem : dzun - cont ] in order to conclude that @xmath80 is lower semi - continuous .    consider @xmath591 .",
    "then either @xmath5 or @xmath496 .",
    "moreover for @xmath592 and @xmath15 , @xmath593 therefore for each @xmath202 , we have for @xmath594 , @xmath595 therefore we have with @xmath592 , @xmath15 @xmath596 this implies that @xmath80 is continuous in @xmath488 .      in view of",
    ", we see that the study of @xmath80 can now be reduced to the study of @xmath564 . the function @xmath564 is defined as a minimum over a triangle @xmath597 ^ 2 : \\tau_1 \\le \\tau_2 \\}$ ] .",
    "we will see below that @xmath564 is defined implicitly when the constraint @xmath598 is active ( @xmath599 ) or defined explicitly if not ( @xmath600 ) . in other words , it will be linear `` as long as '' trajectories stay some time ( @xmath601 ) at the junction point .",
    "we first define for @xmath602 , @xmath603 the continuity of @xmath599 will be used later on .",
    "[ lem::r101 ] the restrictions @xmath604 of @xmath599 are continuous in @xmath605 and continuous at @xmath606 if @xmath607 or @xmath608 .    from lemma",
    "[ lem : lsc - ei ] , we deduce that @xmath604 is lower semi - continuous on @xmath81 .",
    "we now show that @xmath604 is upper semi - continuous at any point @xmath609 and also at @xmath606 if @xmath607 or @xmath608 .",
    "we first consider @xmath610 $ ] such that @xmath611 for any sequence @xmath571 with @xmath612 , we want to show that @xmath613 arguing as in lemma  [ lem : dzun - cont ] , we use @xmath614 and we choose @xmath615 as follows @xmath616 , \\\\ \\text{if } x=0 , j\\in i_0 : & \\tau^k=1-|x^k| \\in ( 0,1 ] , \\\\",
    "\\text{if } y=0 , x=0 , i\\in i_0 : & \\tau^k=|y^k| \\in [ 0,1 ) .",
    "\\end{array}\\ ] ] this ends the proof of the lemma .",
    "we next define for @xmath617 @xmath618 where @xmath619 are defined thanks to the following function ( for @xmath620 ) @xmath621 precisely , @xmath622 when @xmath623 ( see lemma  [ lem : k ] below ) .",
    "we will see that @xmath624 plays an important role in the analysis of @xmath564 .",
    "in particular , it allows us to define , when @xmath625 and @xmath626 , the following convex subset ( triangle ) of @xmath627 : @xmath628 it is convenient to set @xmath629 if @xmath45 or @xmath630 .",
    "we next state a series of lemmas before proving them .",
    "[ lemma : junc-1 ] @xmath631    [ lemma : junc-2 ] the functions @xmath632 , @xmath633 and @xmath604 are convex and @xmath84 in @xmath634 and , if @xmath635 is one of them , it satisfies for @xmath636 @xmath637    [ lemma : junc-3 ] for @xmath638 , there exists a unique @xmath639 such that @xmath640 moreover , @xmath641    [ lem::r111 ] for @xmath642 , there is a unique @xmath643 $ ] such that @xmath644 moreover @xmath645 and @xmath646    [ lem::r91 ] then we have @xmath647 with @xmath648 where @xmath649 satisfy @xmath650 moreover we have @xmath651 and @xmath652    before proving these lemmas , the reader can check the following useful properties of the function @xmath624 that will be used in their proofs .",
    "[ lem : k ] assume ( a1 ) .",
    "then for any @xmath653 , we have @xmath654 we define @xmath655 as the inverse of the function @xmath624 restricted to @xmath656 $ ] , and @xmath657 as the inverse of the function @xmath624 restricted to @xmath658 .",
    "we set @xmath659 then we have @xmath660 moreover we have @xmath661    the proof proceeds in several steps .",
    "* step 1 : first study of @xmath632 . *",
    "let us define @xmath662 for @xmath663 , and setting @xmath664 and @xmath665 and @xmath666 , we compute @xmath667 therefore @xmath668 is in particular convex on @xmath669 . because @xmath668 is in particular lower semi - continuous on @xmath516\\times [ 0,1]\\times j_j^*\\times j_i^*$ ] , and @xmath670 we deduce that @xmath671 this implies that @xmath632 is also convex in @xmath634 . notice that in particular @xmath672 and @xmath673 the map @xmath674 is then strictly convex on the convex set @xmath675 therefore using again ( [ eq::r96 ] ) and the lower semi - continuity of @xmath668 , we deduce that it has a unique minimum that we denote by @xmath554 satisfying @xmath676 .    * step 2 : study of @xmath604 .",
    "* let us consider the following function @xmath677 for @xmath678 , setting @xmath679 and proceeding similarly as in step 1 , we can deduce that @xmath680 and that @xmath604 is also convex on @xmath634 .",
    "we can also deduce that the map @xmath681 is strictly convex on @xmath682 for @xmath638 and that it has a unique minimum that we denote by @xmath678 such that @xmath683    using the derivative with respect to @xmath684 , we see that @xmath684 is characterized by the equation @xmath685 moreover @xmath686 using the regularity @xmath687 of @xmath688 given in assumption ( a1 ) , we see that the unique solution @xmath689 of @xmath690 is continuously differentiable with respect to @xmath568 . therefore we deduce that @xmath691 .",
    "we have @xmath692 writing @xmath684 for @xmath693 , and using the optimality condition  , we get @xmath694 where we have used ( [ eq::r98 ] ) in the second and in the fourth line .",
    "hence @xmath604 satisfies ( [ eq::r99 ] ) on @xmath695",
    ".    * step 3 : further study of @xmath632 .",
    "* we concluded at the end of step 1 that for @xmath638 we have @xmath696 with @xmath676 .",
    "then we can distinguish two cases .    * case 1 : @xmath697 .",
    "* in that case this implies that @xmath698 which can be written as @xmath699 with @xmath649 defined in ( [ eq::r97 ] ) .    using lemma  [ lem : k ] , we conclude that holds true if and only if @xmath700 and @xmath701 ; i.e. @xmath702 . in this case",
    "we have @xmath703 and @xmath704 and then @xmath705 moreover , we have in this case @xmath706 .    using legendre - fenchel s equality together with @xmath707 and @xmath708",
    ", we have @xmath709 and @xmath710 hence @xmath633 satisfies ( [ eq::r99 ] ) on @xmath634 .",
    "finally we deduce from that the condition : @xmath711 is equivalent to @xmath712 and then by continuity of @xmath632 and @xmath633 , we get @xmath713    * case 2 : @xmath714 . *",
    "if for @xmath636 we have @xmath715 with @xmath714 , then we have seen that @xmath716 and @xmath717 . from lemma  [ lem::r101 ]",
    ", we also have that @xmath718 if @xmath607 or @xmath608 and in that case @xmath629 . on the other hand",
    ", we have @xmath719 if @xmath720 with @xmath721 in that case .",
    "therefore in all cases we have @xmath722 now from the continuity of @xmath564 , we deduce that @xmath723    * step 4 : on the boundary @xmath724 .",
    "* we already know that @xmath564 is continuous , therefore if @xmath725 : @xmath726 on the other hand , recall that @xmath638 , the real @xmath678 is characterized by ( [ eq : cno ] ) , i.e. @xmath727 notice that if we choose @xmath728 we deduce from @xmath729 that @xmath730 which are obvious solutions of ( [ eq::r103 ] ) .",
    "therefore we conclude that this is the solution . using ( [ eq::r32])-([eq : dzo - dir ] ) and",
    "the expression of @xmath633 , ( [ eq::r104 ] ) implies the equality of the gradients of @xmath633 and @xmath604 on the boundary @xmath731 .",
    "finally this shows that @xmath732 .",
    "this ends the proof of the lemmas .",
    "the proof proceeds in several steps .",
    "* continuity of @xmath443 .",
    "* we set for @xmath733\\times j_j\\times j_i$ ] @xmath734 from proposition  [ lemma : junc-1 ] , we already know that there exists a unique @xmath735 $ ] such that @xmath736 on the other hand , we have @xmath737 notice that in cases  1 and 2 , there is a unique @xmath735 $ ] such that @xmath738 and @xmath739 in case 1 , @xmath740 $ ] in case 2",
    ". then the continuity of @xmath741 in @xmath742 follows from the lower semi - continuity of @xmath743 on @xmath516\\times j_j\\times j_i$ ] and the uniqueness of @xmath684 such that ( [ eq::r112 ] ) holds .",
    "* computation of @xmath443 .",
    "* we distinguish cases .",
    "case 1 : @xmath744 .",
    "notice that we have @xmath745 if @xmath746 , then @xmath747 and @xmath748 .    if @xmath749 , then @xmath750 is a solution of @xmath751 and @xmath752 .",
    "case 2 : @xmath753 .",
    "notice that we have @xmath754 if @xmath755 , then @xmath756 and @xmath757 .    if @xmath758 , then @xmath759 is a solution of @xmath760 and @xmath761 .",
    "this ends the proof of the lemma .",
    "the proof proceeds in several steps .    * step 1 : continuity . * from proposition",
    "[ lemma : junc-1 ] , we already know that @xmath762 and ( [ eq::r106 ] ) holds true with @xmath763 where @xmath741 in the first line . therefore , in order to prove that @xmath764 , it is sufficient to prove that if @xmath765 , and if @xmath766 is a sequence of points such that @xmath571 , then we have with @xmath767 @xmath768 where @xmath769 is given by ( [ eq::r109 ] ) .",
    "let us recall that @xmath615 is characterized by the equation @xmath770 we will assume ( up to extract a subsequence ) that @xmath771 for some limit @xmath772 $ ] . because we have @xmath773 , it is easy to deduce from ( [ eq::r107 ] ) , that there exists a constant @xmath774 such that @xmath775 this can be proved by contradiction , distinguishing the cases @xmath776 , @xmath777 and @xmath778 . up to extract a subsequence , we can then pass to the limit in ( [ eq::r107 ] ) and get @xmath779 in the following cases , we now identify one of the two quantities @xmath780 or @xmath781 , the other one being determined by ( [ eq::r113 ] ) .",
    "* case 1 : @xmath782 . * from lemma  [ lem::r111 ] , we know that @xmath783 , and then @xmath784 and from ( [ eq::r116 ] ) , we get @xmath785    * case 2 : @xmath786 . * from lemma  [ lem::r111 ] , we know that @xmath787 , and then @xmath788 and from ( [ eq::r116 ] ) , we get @xmath789    * case 3 : @xmath790 . * this case only occurs if @xmath607 or @xmath608 .",
    "moreover at least one of the two quantities @xmath791 and @xmath792 tends to zero .",
    "if @xmath793 , then @xmath794 and hence @xmath795 if @xmath796 , then @xmath797 and hence @xmath798 this implies that @xmath799 by the uniqueness of the limit , this finally shows that @xmath800 and ( [ eq::r109 ] ) holds .",
    "* step 2 : checking ( [ eq::r116 ] ) and ( [ eq::r115 ] ) . * from ( [ eq::r118 ] ) and ( [ eq::r119 ] ) , we deduce ( [ eq::r116 ] ) on @xmath801 . from @xmath802 on @xmath803 , we deduce that ( [ eq::r116 ] ) is also true on @xmath804 .",
    "then ( [ eq::r115 ] ) follows from a simple computation for @xmath805 .",
    "this is still true for @xmath806 , because @xmath632 is @xmath84 .",
    "this ends the proof of the lemma .",
    "the following lemma will be used below . since it is elementary ,",
    "its proof is omitted .",
    "[ lem::r123 ] for @xmath807 , we have for @xmath808 with @xmath805 if @xmath809 : @xmath810 and @xmath811      we are now in position to prove theorem  [ thm : minimal - action-0 ] .",
    "we prove several lemmas successively .",
    "[ lem : dzo-1 ] for @xmath808 , we have @xmath812 in particular @xmath813 in the first two cases .",
    "[ lem : dzo-1bis ] in the case @xmath814 , we have @xmath815 moreover , in this case there exists a curve @xmath816 such that @xmath817 .",
    "this curve connects @xmath818 and @xmath819 and is contained in @xmath820    the results of these two lemmas are illustrated in figures   [ fig2 ] and [ fig4 ] .",
    "we only have to treat the case @xmath821 .",
    "the convexity of @xmath25 implies that for @xmath678 : @xmath822 therefore for @xmath638 with @xmath823 , we have @xmath824 when @xmath825 , we have @xmath826 , and then @xmath827 for @xmath638 and then also for @xmath828 , by continuity of the functions .    we first prove and then describe the curve @xmath829 .    [ [ proof - of - eqr120 . ] ]",
    "proof of ( [ eq::r120 ] ) . + + + + + + + + + + + + + + + + + + + + + +    combining and , we obtain @xmath830 on the other hand , we have ( a strictly convex function being above its tangent ) for @xmath831 and @xmath832 @xmath833 this shows that @xmath834 we see that ( [ eq::r121 ] ) and ( [ eq::r122 ] ) imply ( [ eq::r120 ] ) .    [ [ description - of - leftmathcald_mathrmlinearjimathcald_mathrmstraightjirightcap - deltaji . ] ] description of @xmath835 .",
    "+ + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + + +    notice that @xmath836 this means that the functions @xmath633 and @xmath837 coincide at the two points @xmath819 and @xmath838 .",
    "therefore we have @xmath839x_i , y_j[\\ ] ] because @xmath633 is linear and @xmath837 is strictly convex as a function of @xmath840 .",
    "+ the function @xmath841 being convex because @xmath842 is linear , we can consider the convex set @xmath843 then for @xmath814 , the set @xmath844 is contained in the boundary of the convex set @xmath845 .",
    "more precisely , we have @xmath846 which shows that @xmath816 is a curve and @xmath847    [ lem : dzo-2 ] for all @xmath848 , and @xmath849 where @xmath83 is @xmath84 : @xmath850 moreover for all @xmath851 ( with @xmath852 if @xmath809 ) @xmath853 and for all @xmath854 ( with @xmath855 if @xmath809 ) @xmath856 we also have @xmath857 for all @xmath858 except for @xmath859 for which we exclude points @xmath860 .",
    "moreover for @xmath861 , we have @xmath862 and @xmath809 , we have @xmath863    using proposition  [ lemma : junc-1 ] for @xmath632 , lemma  [ lem::r123 ] for @xmath837 , and ( [ eq::r130 ] ) for @xmath633 and the property ( [ eq::r120 ] ) , we get @xmath864 which implies ( [ eq::r131 ] ) .",
    "similarly we get @xmath865 which implies ( [ eq::r132 ] )",
    ". relations ( [ eq::r133 ] ) and ( [ eq::r134 ] ) follow both from proposition  [ lemma : junc-1 ] and lemma [ lem::r123 ] .",
    "finally ( [ eq::r140 ] ) and ( [ eq::r141 ] ) follows from the previous results .",
    "this ends the proof of the lemma .",
    "we now can check the equations satisfied by @xmath80 at the boundary .",
    "[ lem : dzo - bdry-1 ] at any point @xmath866 with @xmath867 if @xmath868 , we have for any @xmath869 @xmath870    [ lem : dzo - bdry-2 ] at any point @xmath871 with @xmath832 if @xmath872 , we have for any @xmath873 @xmath874    we first remark the general fact that @xmath875 on the one hand , from lemma  [ lem : dzo-1 ] , we have for points @xmath866 where @xmath876 is @xmath84 @xmath877 and this common quantity is independent on @xmath127 . therefore to conclude to ( [ eq::r136 ] ) in the case @xmath76 ,",
    "it is enough to show that there exists at least an index @xmath127 such that @xmath878    [ [ case-1 ] ] case 1 : + + + + + + +    @xmath76 and @xmath879 .",
    "then we have @xmath880 and then @xmath881 therefore holds true for @xmath882 .",
    "[ [ case-2 ] ] case 2 : + + + + + + +    @xmath372 and @xmath883",
    ". then we have @xmath884 and by lemma  [ lem::r123 ] , we have for @xmath885 which is in particular true for @xmath496 .",
    "this shows ( [ eq::r136 ] ) in the case @xmath372 .    from lemma  [ lem : dzo-1 ]",
    ", we have for points @xmath871 where @xmath886 is @xmath84 @xmath887 and this common quantity is independent on @xmath127 . therefore to conclude to ( [ eq::r137 ] ) , it is enough to show that there exists at least an index @xmath127 such that @xmath888    * case 1 : * @xmath607 .",
    "then from lemma  [ lem : dzo-1 ] , we have with @xmath889 @xmath890 therefore ( [ eq::r137 ] ) holds true for @xmath889 .",
    "* case 2 : * @xmath872 .",
    "we distinguish sub - cases .",
    "subcase 2.1 : @xmath891 . from lemma  [ lem :",
    "dzo-1 ] , we still have ( [ eq::r142 ] ) with @xmath889 , which again implies ( [ eq::r137 ] ) for @xmath889 .",
    "subcase 2.2 : @xmath758 .",
    "then we choose an index @xmath892 , and lemma  [ lem : dzo-1 ] implies that @xmath893 which again implies ( [ eq::r137 ] ) for such @xmath894 .",
    "this ends the proof of the lemma",
    ".    we can now prove theorem  [ thm : minimal - action-0 ] .    from lemma  [ lem : dzo-1 ] ,",
    "we know that @xmath80 has the regularity @xmath895 except on certain curves @xmath896 for @xmath809 .",
    "so if @xmath568 is a point of local @xmath895 regularity of @xmath80 , then we simply set @xmath897 if @xmath568 is a point where @xmath80 is not @xmath895 , then we have @xmath898 , and we can simply set @xmath899 the required equalities follow from lemmas  [ lem : dzo-1 ] , [ lem : dzo - bdry-1 ] , [ lem : dzo - bdry-2 ] .",
    "estimate  ( [ eq : grad - control ] ) follows from the fact that @xmath80 is the minimum of @xmath900 and of functions in @xmath901 for some @xmath150 .",
    "this ends the proof of the theorem .",
    "this section contains classical results from viscosity solutions , whose statements are adapted to the equation studied in the present paper .          * consider a family of sub solutions ( resp .",
    "super - solutions ) @xmath902 of on @xmath20 such that the u.s.c .",
    "( resp . l.s.c . )",
    "envelope @xmath11 of @xmath903 is finite everywhere .",
    "then @xmath11 is a sub - solution ( resp .",
    "super - solution ) of on @xmath20 . * consider a family of sub solutions ( resp .",
    "super - solutions ) @xmath904 of on @xmath20 such that the upper ( resp .",
    "lower ) relaxed semi - limit @xmath11 is finite everywhere .",
    "then @xmath11 is a sub - solution ( resp .",
    "super - solution ) of on @xmath20 .            the first author is partially supported by the kamfaible project ( anr-07-blan-0361 ) .",
    "the authors thank a. briani for useful discussions and important indications on the recent literature on the subject .",
    "the authors are very grateful to j .- p .",
    "lebacque for fruitful and enlightening discussions on the modeling of traffic flows and indications on the related literature .",
    "the second author thanks m. khoshyaran for discussions on the topic .",
    "the authors also thank y. achdou , g. barles , p. cardaliaguet , e. chasseigne , h. frankowska and m.  garavello for discussions about this work .",
    ", _ optimal control and viscosity solutions of hamilton - jacobi - bellman equations _ , systems & control : foundations & applications , birkhuser boston inc . , boston , ma , 1997 . with appendices by maurizio falcone and pierpaolo soravia .        height 2pt depth -1.6pt width 23pt , _ solutions de viscosit des quations de hamilton - jacobi _ , vol .",
    "17 of mathmatiques & applications ( berlin ) [ mathematics & applications ] , springer - verlag , paris , 1994 .",
    "height 2pt depth -1.6pt width 23pt , _ first order macroscopic traffic flow models : intersection modeling , network modeling _ , in transportation and traffic theory .",
    "flow , dynamics and human interaction , elsevier , 2005 , pp .",
    "365386 .                        height 2pt depth -1.6pt width 23pt , _ optimality principles and representation formulas for viscosity solutions of hamilton - jacobi equations",
    ". i. equations of unbounded and degenerate control problems without uniqueness _ , adv .",
    "differential equations , 4 ( 1999 ) , pp .  275296 .    height 2pt depth -1.6pt width 23pt , _ optimality principles and representation formulas for viscosity solutions of hamilton - jacobi equations .",
    "equations of control problems with state constraints _ , differential integral equations , 12 ( 1999 ) , pp ."
  ],
  "abstract_text": [
    "<S> this paper is concerned with the study of a model case of first order hamilton - jacobi equations posed on a `` junction '' , that is to say the union of a finite number of half - lines with a unique common point . </S>",
    "<S> the main result is a comparison principle . </S>",
    "<S> we also prove existence and stability of solutions . </S>",
    "<S> the two challenging difficulties are the singular geometry of the domain and the discontinuity of the hamiltonian . as far as discontinuous hamiltonians are concerned , these results seem to be new . </S>",
    "<S> they are applied to the study of some models arising in traffic flows . </S>",
    "<S> the techniques developed in the present article provide new powerful tools for the analysis of such problems .    _ dedicated to j .- b . </S>",
    "<S> hiriart - urruty _    * keywords : * hamilton - jacobi equations , discontinuous hamiltonians , viscosity solutions , optimal control , traffic problems , junctions    * msc : * 35f21 , 35d40 , 35q93 , 35r05 , 35b51 </S>"
  ]
}