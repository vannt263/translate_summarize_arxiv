{
  "article_text": [
    "diffusive shock acceleration ( dsa ) is now widely accepted as the model to explain the production of cosmic rays ( cr ) in a wide range of astrophysical environments @xcite .",
    "the concept behind dsa , first - order fermi acceleration of charged particles trapped between convergent flows across a shock , is quite simple .",
    "however , the full dsa problem is actually extremely complex , because the nonlinear interactions between energetic particles , resonantly scattering waves and the underlying plasma can become dominant effects .",
    "important consequences of nonlinear interactions include such things as generation and damping of the scattering wave field , injection of suprathermal particles into the cr population , as well as heating and compression of the plasma flow due to the cr pressure .",
    "owing to these complex nonlinear physics involved in the model , numerical simulations have been quite useful and successful in understanding the details of the acceleration process and dynamical feedback of the crs to the underlying plasma @xcite .    in continuum",
    "approaches to numerical simulations of dsa theory , the cr diffusion - convection equation is solved at each of a large number of suprathermal momentum values simultaneously with a set of fluid equations describing the flow associated with the bulk , thermal plasma , including the nonlinear interactions between the plasma , crs and scattering waves .",
    "particle acceleration is effected by diffusion across velocity gradients in the motion of the scattering centers , which are usually assumed to be tied to the bulk flow .",
    "pressure by the diffusing crs , in turn , decelerates and compresses flow into the shock , forming a shock `` precursor '' .",
    "since that development eliminates the original , simple velocity jump seen by the crs , the dsa is then modified according to details of the flow within the precursor , whose scales are characterized by the so - called diffusion length , @xmath0 , where @xmath1 is the spatial diffusion coefficient for crs of momentum @xmath2 , and @xmath3 is the characteristic flow velocity against which the crs must swim , @xcite .",
    "accurate solutions to the cr diffusion - convection equation require a computational grid spacing significantly smaller than @xmath4 , typically , @xmath5 . in a realistic diffusion transport model , it is thought that the diffusion coefficient should have a steep momentum dependence , @xmath6 , with @xmath7 . for the lowest energy cr particles the diffusion lengths ( @xmath8 ) are only slightly greater than the shock thickness , while they can be many orders of magnitude greater than that for the highest energy particles .",
    "thus , a wide range of length scales is required to be resolved in order to solve the diffusion convection equation correctly for the model with a realistic diffusion coefficient .",
    "previous numerical simulations which adopted the traditional flux - differencing method on a uniform grid were often forced to assume a weak momentum dependence , for example , @xmath9 in @xcite .    to overcome this numerical problem",
    ", @xcite introduced a `` change of variables technique '' in which the radial coordinate is transformed into a new variable , @xmath10 $ ] where @xmath11 is the shock radius , defined for each particle momentum for the upstream region .",
    "a uniform grid is used for the downstream region .",
    "this allowed them to solve the coupled system of gasdynamic equations and the cr transport equation even when the diffusion coefficient has a strong momentum dependence ( @xmath12 ) .",
    "their code is designed for simulations of supernova remnants , which are represented by piston - driven spherical shocks in one - dimensional geometry .",
    "it is different from conventional eulerian codes in several ways .",
    "both gasdynamic equations and the cr transport equation are solved separately either side of the gas subshock .",
    "then the gasdynamic solutions at both sides of the subshock are used to solve the riemann problem , which determines how the subshock evolves .",
    "also an iteration scheme is applied to match the downstream and upstream solutions for the cr diffusion - convection equation at the subshock . in any case",
    "this has enabled them to explore several important issues regarding the particle acceleration at supernova remnants more fully than was possible before , @xcite .",
    "however , no consistency - check for this method has been attempted so far , since no existing conventional codes can handle such a strongly momentum dependent diffusion coefficient .",
    "fermi shock acceleration affects those particles with a mean free path greater than the shock thickness that can resonantly scatter with self - generated alfvn waves . in the so - called `` thermal leakage '' type injection model",
    ", the diffusion and acceleration of these particles out of the suprathermal tail of the maxwellian distribution determines the cr injection rate @xcite .",
    "a self  consistent , analytic and nonlinear model for ion injection based on the interactions of the suprathermal particles with self  generated magneto  hydrodynamic waves in strong shocks has been presented by @xcite . by adopting this analytic solution , @xcite have developed a numerical treatment of the injection model at a strong quasi ",
    "parallel shock , which is then incorporated into the combined gas dynamics and the cr diffusion  convection code .",
    "since the suprathermal particles have mean free paths a few times that of thermal particles , resolving these smallest scales is of critical importance in estimating the injection and acceleration efficiency in such numerical simulations of the cr modified shocks .",
    "in fact , @xcite were able to run their simulations , with a conventional eulerian scheme on a uniform grid , only up to the time when the maximum accelerated momentum was of order of @xmath13 for a bohm type diffusion model because of severe requirements for computational resources needed to evolve the cr distribution to highly relativistic momenta .",
    "this calls for an alternative method comparable to berezhko s code , which solves the cr diffusion - convection equation on a grid whose spacing scales with the diffusion length at each momentum value sampled .    in this contribution",
    ", we present a new numerical scheme that follows cr modified shocks in one dimensional , plane - parallel geometry .",
    "we take advantage of the fact that the diffusion and acceleration of the low energy particles are important only close to the shock owing to their small diffusion lengths .",
    "they are simply advected along with the underlying gas flow far upstream and downstream of the shock .",
    "thus it is necessary to resolve numerically the diffusion length of the particles only around the shock .",
    "so we first implement a shock tracking scheme to locate the shock position exactly and then increase the grid resolution only around the shock by applying multi - levels of refined grids .",
    "toward this end , we have adopted the shock tracking method of @xcite and the adaptive mesh refinement ( amr ) technique of @xcite , and modified the code to use multiple levels of grid refinement only around the shock .    in the following section we outline our numerical methods , while in  3 we present and discuss our test results .",
    "section 4 provides a summary .",
    "the diffusive transport model for cr acceleration separates the plasma into two components distinguished by scattering length .",
    "the bulk plasma consists of thermal particles whose scattering lengths are small enough to fit within a dissipative shock .",
    "they are described by the standard gasdynamic equations with cr pressure terms added @xcite .",
    "the diffusion - convection equation , which describes the time evolution of the cr distribution function @xmath14 ( @xcite ) is given by @xmath15 where @xmath16 is the total time derivative in the fluid frame and the diffusion coefficient @xmath17 is assumed to be a scalar . as in our previous studies , the function @xmath18 is solved instead of @xmath19 .",
    "except for the special shock tracking and amr features , our treatments of the underlying gas dynamics and the cr transport are relatively standard @xcite , so we do not repeat them here .    the spatial diffusion coefficient can be expressed in terms of a mean scattering length , @xmath20 , as @xmath21 , where @xmath22 is the particle speed .",
    "the scattering length , @xmath20 , and thus @xmath17 , should be in principle determined by the intensity of resonantly interacting alfvn waves .",
    "for example , the bohm diffusion model represents a saturated wave spectrum and gives the minimum diffusion coefficient as @xmath23 when the particles scatter within one gyration radius ( @xmath24 ) due to completely random scatterings off the self - generated waves .",
    "this gives @xmath25 .",
    "hereafter we will express particle momenta in units @xmath26 .",
    "we consider here only the proton cr component . for our test runs",
    ", we will also adopt a power - law form as @xmath27 for low momenta ( @xmath28 ) in some models in addition to @xmath29 .",
    "we note that the bohm diffusion coefficient becomes @xmath30 in the limit of @xmath31 and @xmath32 in the limit of @xmath33 . in order to model amplification of self - generated turbulent waves due to compression of the perpendicular component of the magnetic field ,",
    "the spatial dependence of the diffusion is modeled as @xmath34 where @xmath35 is the upstream gas density .",
    "this form is also required to prevent the acoustic instability of the precursor @xcite .",
    "we also adopt the thermal leakage type injection model introduced in @xcite . in this model , below a certain momentum , @xmath36 , chosen high enough to include most of the postshock thermal population , the distribution is forced to maintain a maxwellian form consistent with the local gas temperature and density determined from the gasdynamical equations . above @xmath36 particles are allowed to evolve according to the diffusion - convection equation , so the form will deviate from maxwellian .",
    "however , only for @xmath37 are they included in calculations of cr pressure and energy .",
    "we relate @xmath36 and @xmath38 to the peak of the postshock maxwellian distribution , @xmath39 , as @xmath40 , and @xmath41 , and we assume @xmath42 and @xmath43 for all test runs here . here",
    "@xmath39 corresponds to the peak in the partial pressure of thermal particles .",
    "the choice of @xmath36 influences the injection rate directly , since it determines the fraction of suprathermal particles in the maxwellian tail that can be injected into the crs .",
    "the hydrodynamic conservation equations are solved in the 1d plane - parallel geometry by the _ wave - propagation _",
    "algorithm described in @xcite . in this method",
    "a nonlinear riemann problem is solved at each interface between grid cells , and the wave solutions ( , speeds of waves and jumps associated with three wave modes ) are used directly to update the dynamic variables at each cell . within this method a sub - zone shock - tracking algorithm of @xcite can be incorporated easily , since the riemann solutions tell us exactly how the waves propagate .",
    "the underlying eulerian grid , which is called the `` base '' grid through this paper , has uniform cells .",
    "an additional cell boundary is introduced at the location of the shock , subdividing a uniform cell into two sub - cells . in the next time step , this cell boundary ( shock front ) is moved to a new location using the riemann solutions at the current shock location ( , @xmath44 ) and the waves are propagated onto the new set of grid zones . since the new grid is chosen so that the shock wave coincides exactly with an irregular cell boundary , _ the shock remains as an exact discontinuity without smearing_. one advantage of using the wave - propagation method for the shock tracking scheme is that the large time step satisfying the courant condition for the uniform grid can be used even if the shock is very close to the boundary of the uniform cell and so the sub - cell is much smaller than the uniform cell .",
    "the cr diffusion - convection equation is solved in two steps : 1 ) the diffusion term is solved by the crank - nicholson scheme as described in @xcite .",
    "2 ) the advection term is solved by the wave - propagation method as for the gasdynamic variables .",
    "ideal gasdynamic equations in 1d planar geometry do not contain any intrinsic length scales to be resolved , but once the precursor due to the cr pressure modification becomes significant , the grid spacing should be fine enough to resolve the precursor structure . according to previous numerical studies  @xcite , convergence of numerical solutions to cr modified shocks , especially the subshock transition ,",
    "requires that the precursor be resolved with sufficient accuracy .",
    "while the full extent of the precursor increases with the cr pressure and is related with the diffusion length of the maximum accelerated momentum @xmath45 , the dominant scale length of the precursor is similar to an averaged diffusion length of the particle populations with the greatest contribution to the cr pressure .",
    "typically a strong shock becomes significantly modified due to nonlinear feedback from the cr pressure when the maximum acceleration momentum becomes mildly relativistic ( @xmath46 ) .",
    "thus in order to follow the development of the precursor and the time evolution of the cr modified shock , the gasdynamic equations should be solved on a base underlying grid whose spacing is smaller than the diffusion length of mildly relativistic particles . as discussed earlier , it would be most natural to solve the cr transport equation on a grid whose spacing scales with the particle s momentum as in @xcite . in that case",
    ", the cr distribution @xmath47 should be mapped onto the base hydrodynamic grid in order to calculate the cr pressure and its dynamical feedback on the dynamics of the underlying flow .",
    "here we take a different approach in which the immediate upstream and downstream regions around the shock are refined by applying multi - level grids with increasingly finer resolution by an integer factor of two , so that the transport of low energy particles right adjacent to the shock is at the most refined grid . here",
    "we refer each level grid by the grid level index @xmath48 which runs from 0 to @xmath49 , corresponding to the base grid and the finest grid , respectively .",
    "since the grid spacing decreases by an integer factor , we can lay down the refined grid in such a way that cell boundaries align between two adjacent levels .",
    "this feature allows us to use a much simpler mapping scheme between two adjacent levels , compared to the case where non - integer refinement factors are used .",
    "we adopt the adaptive mesh refinement technique developed by @xcite . in the general version of the amr code of @xcite ,",
    "the code identifies the refinement regions where the desired level of numerical accuracy is not achieved and the multi - level grids are generated within the refinement regions . compared to that general version , a much simpler scheme is sufficient for our needs , since we only need to refine the region around the shock whose location is exactly known in our shock - tracking code .",
    "in fact , it is crucial to have the shock - tracking in order to lay down the multi - level grids around the shock , so that the shock remains near the middle of the computational domain at all levels .",
    "a fixed number of cells around the shock ( @xmath50 ) are identified as the `` refinement region '' on the base grid ( @xmath51 grid ) .",
    "the 1st level grid is generated by placing @xmath52 cells within the refinement region , so each cell is refined by a factor of two .",
    "we use the refinement factor of two , since it is relatively simpler in terms of programming and it improves robustness and stability of the code .",
    "then @xmath50 cells around the shock out of @xmath52 cells on the 1st level grid are chosen to be refined further to the 2nd level grid , making the length of the refinement region a half of that in the 1st level grid . here",
    "the refinement region is chosen so that the shock is always in its middle .",
    "the same refinement procedure is applied to higher level grids .",
    "so at all levels , there are @xmath52 cells around the shock , but the length of the computation domain is shrunk by a factor of 2 from the previous level . at each level",
    "the grid spacing is given by @xmath53 , where @xmath54 is the grid spacing at the base grid .",
    "1 shows an example of refined grid levels up to @xmath55 with @xmath56 .",
    "the value of @xmath50 should be chosen so that the refined region at the base grid includes most of the precursor during the early stages when particles get accelerated to mildly relativistic energies . in real test simulations presented here , typical values of @xmath57 .",
    "the spatial extent of the highest refined grid can be much smaller than the length scale of the precursor , since it need only resolve structures `` seen '' by the lowest energy crs immediately next to the shock .    in order to ensure that the shock remains near the middle of the computational domain at all grid levels during the time integration of one time step of the base grid",
    ", we do the following procedure .",
    "first , the velocity in the refined grid is transformed so that the shock is at rest in the frame of the numerical simulation at each level except the base grid .",
    "secondly , the multi - level grids are redefined at each time step so that they center around the new location of the shock , and all hydrodynamic variables and the particle distribution function @xmath58 are mapped onto the newly defined grids .",
    "thus the refinement region at all levels is moving along with the shock .",
    "although the original shock tracking code of @xcite can treat multiple shocks , we modify it in the current version of our code to include only one shock , in order to keep the code structures as simple as possible for our initial studies .",
    "integration of the gasdynamic variables and advection of the cr distribution function are done by the wave - propagation method at each level grid .",
    "the time step at each level , @xmath59 , is determined by a standard courant condition , that is , @xmath60 , where @xmath3 and @xmath61 are the flow velocity and sound speed at each cell , respectively .",
    "if the highest level is specified to be @xmath62 , to advance from @xmath63 to @xmath64 at the base grid , we need the following steps : 1 ) all equations are integrated at the base grid .",
    "2 ) the same is done twice with @xmath65 at the @xmath66 level for the refined region . the cells immediately outside the refinement region at the @xmath67 level provide the necessary boundary conditions for the integrations . here",
    "we need boundary conditions at two spatial points at both ends of the refined grid , @xmath68 , @xmath69 , @xmath70 , and @xmath71 , and also at two points in time , @xmath72 and @xmath73 .",
    "some of them are interpolated in time and space coordinates from the variables defined at the grid one level below .",
    "3 ) the values at the @xmath74 level are mapped onto the refinement region at the base grid .",
    "4 ) finally the values at the interface just outside the refinement region at the base grid should be corrected to preserve global conservation . the base idea and also the detailed procedure applied for one level of refinement",
    "can be found in @xcite .",
    "when @xmath49 is greater than 1 , the same procedures should be repeated recursively at each time step at each level .",
    "the variables within the refinement region at the @xmath48 level grid are replace with the more accurate values at the @xmath75 level grid after the corresponding pair of time steps at the @xmath75 level are completed . in one time step in the base grid ,",
    "we carry out @xmath76 time steps at the @xmath48 level grid , so total number of time steps in all level grids required to advance one time step in the base grid becomes the sum of @xmath77 .",
    "once advection of the cr distribution is done , diffusive transport including the first - order acceleration is solved in a separate step .",
    "although an implicit crank - nicholson scheme is used for the diffusion term , the time step is still restricted by the acceleration term as @xmath78 $ ] . within a single hydrodynamic time step ,",
    "several crank - nicholson time steps are performed if @xmath79 .",
    "number of this sub - cycling is about 4 - 5 for the momentum bin size considered here ( , @xmath80 ) .",
    "as we go up and down on the ladder of `` time stepping '' for one time step in the base grid , the base grid being the lowest , the values at a coarser grid propagate upward as boundary conditions for a finer grid and more accurate values at the finger grid propagate downward by being mapped onto the coarser grid .",
    "in this section we present some test simulations with our cr / amr code .",
    "the dynamics of the cr modified shock depends on four parameters : the gas adiabatic index , @xmath81 , gas mach number of the shock , @xmath82 , @xmath83 , and the diffusion coefficient , where @xmath61 and @xmath84 are the upstream sound speed and the speed of light , respectively . for all simulations we present here , @xmath85 , and @xmath81 .",
    "we considered three values for mach number , @xmath86 and 20 for the initial shock jump by adjusting the preshock gas pressure .",
    "the initial jump conditions in the rest frame of the shock for all test problems are : @xmath87 in upstream region and @xmath88 in downstream region . here",
    "the velocities are normalized to the initial shock speed , @xmath89 .",
    "normalization of the length and the time variables depends on the diffusion coefficient : @xmath90 , where @xmath91 is the computational coefficient , @xmath92 is the physical value , and @xmath93 is the normalization constant .",
    "so the corresponding normalization constants are : @xmath94 , @xmath95 .",
    "these correspond to roughly the diffusion length and diffusion time scale for @xmath96 . for the bohm diffusion coefficient with the magnetic field of 1 microgauss , for example ,",
    "@xmath97 with @xmath98 , so that @xmath99 and @xmath100 . the particle number density , @xmath101 is arbitrary , but the gas density and pressure are normalized to @xmath102 and @xmath103 , respectively .",
    "we use 230 logarithmic momentum zones in @xmath104=[-3.0,+3.0 ] and the momentum is in units of @xmath105 . the distribution function @xmath19 is expressed in units of @xmath106 , so that @xmath107 .      in this section",
    "we consider the @xmath108 shock with a diffusion model @xmath109 . in order to see how the cr / amr code performs at different resolutions , we ran the simulations with different levels of refinements , @xmath110 .",
    "the numerical domain is [ -25,+75 ] and the number of cells , @xmath111 , so the grid spacing is @xmath112 which corresponds to 1/20 of the diffusion length of the particles of @xmath113 .",
    "the number of refined cells around the shock is @xmath114 on the base grid and so there are @xmath115 cells on each refined level",
    ". since the diffusion length of @xmath116 is @xmath117 , the transport of the suprathermal particles can be resolved at the @xmath118 level .    with the refinement of @xmath118 level",
    ", the cr transport for the particles at the injection pool should be resolved and so the evolution of the cr should be converged .",
    "2 shows the time evolution of the model shock with the maximum refinement of @xmath119 .",
    "this shows how the precursor develops and modifies the shock structure as the cr pressure increases in time .",
    "the numerical frame is chosen so that the initial shock moves to the right with @xmath120 , but the simulated shock drifts to the left due to the cr pressure .",
    "3 shows the density structure at each refined grid ( solid lines ) for @xmath121 and 4 levels , superposed on the density structure at the base grid ( dotted lines ) in the @xmath119 simulation shown in fig .",
    "this demonstrates how the size of refinement region decreases at higher levels and how the refinement regions move along with the shock .",
    "as indicated by two points at downstream and upstream of the subshock in the top - left panel , the shock is tracked as a perfect discontinuity .",
    "given the same resolution at the base grid , the simulations with larger refinement levels show faster acceleration and faster growth of @xmath122 .",
    "4 shows how the particle distribution ( @xmath123 ) at the shock evolves with time in the simulations with different refinement levels for the same shock model shown in fig .",
    "2 : there are 5 curves corresponding to @xmath124 0 , 1 , 2 , 3 , and 4 in each panel .",
    "they show the typical maxwellian distribution that peaks at @xmath125 and the cr distribution that asymptotes to a power - law as time increases . for @xmath126 ( dotted lines ) ,",
    "the cell size @xmath127 is too large for the diffusion of the particles in the injection pool to be treated correctly , so the injection and the acceleration are under - estimated and the slope just above the injection pool is steeper than the canonical strong - shock test - particle spectrum of @xmath128 . for the highest refinement case , @xmath119 ( solid lines ) ,",
    "the cr pressure becomes dominant over the gas pressure and the compression ratio at the subshock becomes 3.3 . as a result ,",
    "the distribution function steepens from a power - law of @xmath129 at lower momentum just above the injection momentum .",
    "but it flattens at higher momenta since high energy particles diffuse on a much larger scale and sample a larger velocity jump .",
    "these opposite trends lead to a concave curve in the middle , which is a typical signature of nonlinear effects @xcite .",
    "5 shows how the cr pressure increases with time in the simulations with different refinement levels shown in fig .",
    "it demonstrates that injection and acceleration are much slower in under - resolved simulations ( @xmath130 ) . from comparison between results of @xmath131 (",
    "dashed line ) and @xmath118 ( solid lines ) , we have concluded that the simulation is mostly converged for @xmath118 .",
    "for example , the cr pressure at the shock at @xmath132 50 and 60 is the same for @xmath131 and 4 simulations , although the shock position is slightly different in the two cases due to slightly different evolution in early stages .",
    "the required computing time increases with @xmath49 and @xmath133 , given the same resolution at the base grid .",
    "for the simulation considered here in which @xmath134 , the computing time increases by factors of 1.5 , 2.3 , 4 , 7 for the maximum refinement levels @xmath124 1 , 2 , 3 , 4 , respectively , compared with the case of no refinement ( @xmath126 ) .",
    "the computing time would increase by factors of @xmath135 , if the simulations were done on a uniform grid spacing that matches the cell size at the highest refined level grid .",
    "6 compares the computing time for these two cases .",
    "since only the precursor region needs to be refined , our cr / amr code will be most cost - effective for simulations where the precursor is only a small fraction of the total computational domain .      in this section we explore how a simulation with our cr / amr code using multi - level refinements would be compared with that with no refinement but on a single uniform grid of the same spacing as the highest level of the other . for this test , we use the following diffusion model : @xmath136 for @xmath137 and @xmath138 for @xmath139 .",
    "this model has a bohm - type diffusion at higher momenta , but much weaker momentum dependence at lower momenta .",
    "this allows us to use larger grid spacing near the injection pool ( @xmath140 ) compared with a bohm diffusion model which scales as @xmath141 for @xmath31 .",
    "the initial shock parameters are the same as the @xmath108 shock model in previous section .",
    "we consider the following three models : model a , a uniform grid with @xmath142 and @xmath126 , model b , an adaptively refined grid with @xmath142 and @xmath143 , and model c , a uniform grid with @xmath144 and @xmath126 .",
    "the numerical domain is [ -50,+50 ] and the number of cells , @xmath145 for models a and b , and @xmath146 for model c. so model c has the same grid spacing as the @xmath143 level grid of model b. the computing time for model c with a single fine grid is about 150 times longer than that for model b with the refinement .",
    "we expect that in the model a simulation the transport of low energy particles are under - resolved , so it is included only for comparison .",
    "we choose @xmath147 for model b , so 10 % of the base grid is refined .",
    "the major difference between models b and c is that the refined grid at @xmath143 covers only about 1/32 of the precursor in model b , while the entire grid of model c has the finest resolution .",
    "7 shows the evolution of the gas density and the cr pressure , and the cr distribution function at the shock in models b and c. in model b with refinement the crs are accelerated a little faster than in model c with a single fine grid , so that the difference in the cr pressure at the shocks is 8.3 % @xmath148 , but this fraction decreases to 4.6 % at @xmath149 and to 3.0 % at @xmath150 .",
    "thus , the two methods appear to converge at slightly different rates , but both give reasonable results once the resolution next to the shock is refined to resolve @xmath151 by more than an order of magnitude .",
    "this test convinces us that our cr / amr code can perform the intended simulations with a reasonable accuracy in a very cost - effective way .",
    "finally in this section we explore briefly how different diffusion models affect evolution of the injection and the acceleration efficiency in cr modified shocks .",
    "first we consider the @xmath108 shock and the following three diffusion models . for lower momenta , @xmath28 ,",
    "model k1 uses @xmath152 , model k2 @xmath153 , and model k3 @xmath154 .",
    "all three models use the bohm type diffusion at higher momenta , that is , @xmath138 for @xmath139 and so @xmath155 continuously matches onto @xmath156 at @xmath113 .",
    "the grid spacing for the base grid , @xmath157 , and 0.005 for models k1 , k2 , and k3 , respectively . the maximum refinement level , @xmath158 and 7 for models k1 , k2 , and k3 , respectively . these parameters are chosen so that the grid spacing at the finest grid is fine enough to treat the low momentum particles near @xmath36 with the assumed diffusion model . while model k1 was integrated for @xmath159 and model k2 for @xmath150 , model k3 is integrated only up to @xmath148 due to much longer required computing time .",
    "8 shows the gas density , the cr pressure , and the cr distribution function at the shock for the @xmath108 shock at @xmath148 simulated with the three different @xmath91 ( k1 : solid line , k2 : dotted line , k3 : dashed line ) .",
    "model k3 has the smallest @xmath8 , while model k1 has the largest @xmath8 for the particles in the injection pool ( @xmath140 ) .",
    "so the injection takes place the fastest and the cr pressure increases most efficiently in model k3 during the early evolution . according to earlier evolution ( not shown ) , the time evolution of these three models differs significantly when the maximum accelerated momentum is still nonrelativistic ( @xmath160 ) . at @xmath148 , however , @xmath161 and mildly relativistic particles dominate the cr pressure , so the different diffusion models at nonrelativistic momenta no longer play a significant role . at this time",
    "all three models evolve in a similar way , since the same @xmath162 is used for all models when @xmath163 .",
    "especially models k2 and k3 show very similar evolution up to this time .",
    "subsequent development of the shocks is almost independent of the form for @xmath164 .",
    "the bottom right panel shows the cr distribution at the shock at @xmath150 in models k1 and k2 ( k3 was ended at @xmath148 ) , demonstrating the very similar cr distribution evolution in models k1 and k2 at later times .",
    "considering the earlier trend that models k2 and k3 are already very similar at @xmath148 , we can deduce all three models evolve the same way when @xmath45 becomes much larger than one .",
    "this implies that @xmath165 can be used instead of @xmath29 as long as the detailed evolution at early stage when the particles are still mostly nonrelativistic is not taken seriously .",
    "simulations with @xmath32 model allow much coarser grid spacings to follow the lowest momentum particles than those with a bohm type diffusion , which reduces the required level of refinements and the associated costs .",
    "the same set of simulations were repeated for @xmath166 and @xmath167 shocks , and we came to the same conclusion ( see fig . 9 for results from the mach 10 simulation ) .",
    "this validates the notion that @xmath12 can be used instead of @xmath168 in the cr / hydro simulation of snrs @xcite .",
    "we also ran a model with a pure power - law type diffusion model , that is , @xmath169 for all momenta until @xmath170 to study the long - term evolution . for this simulation , the computational domain",
    "is increased to [ -4000,+4000 ] , the zone number in the base grid to @xmath171 and the maximum refinement level to @xmath172 .",
    "10 shows the shock structure , the cr distribution at the shock , and its power - law slope , @xmath173 , at @xmath132 200 , 800 , @xmath174 , @xmath175 , and @xmath176 .",
    "the cr pressure at the shock seems to have reached a quasi - steady state value at @xmath177 , even though the maximum momentum continues to increase with time .",
    "the compression ratio at the subshock is @xmath178 at @xmath179 which leads to the test - particle slope of @xmath180 .",
    "so the particle distribution near the injection pool reflects this slope .",
    "although the cr pressure at the shock stays more or less constant after @xmath181 , and the total shock jump does also , the precursor and its associated velocity structure broadens with time .",
    "thus , since @xmath91 does not change over time in this idealized simulation , the particles of a given momentum sample a smaller velocity jump , @xmath182 , around the shock , as the precursor broadens , resulting in slightly steeper slope . on the other hand , the highest momentum particles sample something close to the full velocity jump on their diffusion scales , so the slope flattens gradually to @xmath183 toward @xmath45 , which corresponds to the total compression ratio , @xmath184 .",
    "this hardening of the cr distribution from @xmath180 to @xmath183 produces concave curves in @xmath185 versus @xmath186 plot .",
    "this illustrates the importance of following correctly the non - linear feedbacks between the crs and the dynamics inside the precursor , which requires one to resolve numerically all relevant scales .",
    "finally , fig .",
    "11 shows how the postshock gas temperature decreases as the cr pressure becomes dominant in the precursor and how the injection parameter settles down to a constant value at @xmath187 after the shock has reached a quasi - steady state .",
    "the injection parameter @xmath188 is defined in @xcite and represents the fraction of the incident proton flux that is injected into the cr population at the shock .",
    "we also plot the adiabatic index of the cr population at the shock which also settles down to a constant value at @xmath189 .",
    "the injection parameter and the cr adiabatic index along with the mean diffusion coefficient are three free parameters for the so - called two - fluid model for the cr modified shock simulations .",
    "we have developed a new hydro / cr dynamics code which is specifically designed to solve the time dependent evolution of cr shocks .",
    "diffusive shock acceleration of the cr particles depends on the diffusion of particles whose momenta span many orders of magnitude . since the length and time scales for evolution of the cr kinetic equation scale directly with the diffusion coefficient , an accurate solution to the problem requires that one include all of those scales in the simulation , beginning just outside the gas subshock thickness .",
    "thus , in order to follow accurately the evolution of a cr modified shock , it is necessary to resolve the precursor structure upstream of the subshock and , at the same time , to solve correctly the diffusion of the low energy particles near the injection pool .",
    "these low energy particles have diffusion lengths that are much smaller than the scale length of the precursor , so a large dynamic range of resolved scales is required for cr shock simulations . to solve this problem",
    "generally we have successfully combined a powerful `` adaptive mesh refinement '' ( amr ) technique @xcite and a `` shock tracking '' technique @xcite , and implemented them into a hydro / cr code based on the wave - propagation method @xcite .",
    "the amr technique allows us to `` zoom in '' inside the precursor structure with a hierarchy of small , refined grid levels applied around the shock .",
    "the shock tracking technique tracks hydrodynamical shocks and maintains them as true discontinuities , thus allowing us to refine the region around the shock at an arbitrary level .",
    "the result is an enormous savings in both computational time and data storage over what would be required to solve the problem using more traditional methods on a single fine grid .",
    "the code has been applied to simulations of cr modified shocks with several diffusion coefficient models with strong momentum dependence , which were not possible previously due to severe computational requirements .",
    "the main conclusions from the simulations can be summarized as follows :    1 .",
    "our cr / amr technique code proves to be very cost effective . in typical simulations where",
    "10% of the base grid is refined with @xmath190 levels , for example , the computing time increases by factors of @xmath191 compared with the case of no refinement ( @xmath126 ) .",
    "it should be compared with the time increases by factors of @xmath135 for the simulations of an uniform grid spacing that matches the cell size at the @xmath192 refined level grid . in a simulation where the precursor scale is only a small fraction of the computational domain ,",
    "the advantage in computing time of the refined multi - level grid over a single fine grid becomes even greater .",
    "a convergence test is performed for a mach 20 gas shock with @xmath193 , which evolves into a cr pressure dominated shock .",
    "comparison between a simulation on a coarse grid with multi - level refinement and another simulation on a single fine grid without refinement has demonstrated that our cr / amr code can perform the intended simulation with reasonable accuracy at a much shorter computing time .",
    "the difference in the cr pressure in two test simulations is around 10% in early evolution , but deceases to a few % after the shock has reached a quasi - steady state in later evolution .",
    "the required computing time is reduced by a factor of 150 in the amr simulation .",
    "we also carried out a set of simulations when three different diffusion models , @xmath194 , @xmath195 , and @xmath196 for @xmath28 , are included , while a bohm type , @xmath138 is assumed for @xmath197 .",
    "three simulations generate similar results once the cr pressure is dominated by the relativistic particles ( @xmath198 ) , when the maximum acceleration momentum becomes @xmath199 .",
    "thus a diffusion model of @xmath165 can be used instead of a bohm model as long as one does not focus on the early evolution when @xmath200 .",
    "since we can use much larger grid spacings in simulations with @xmath165 model than those with a bohm type diffusion at low momenta @xmath31 , the required level of refinements and so the computing resources can be reduced greatly .",
    "4 .   for a mach 20 shock , with an injection rate of @xmath187 ,",
    "the shock becomes cr dominated and develops a significant precursor . since the flow is decelerated gradually through the precursor , the velocity jump that the cr particles sample across the shock depends on the diffusion length of the particle , that is , @xmath201 .",
    "so the slope of the particle distribution function , defined as @xmath202 , increases with @xmath2 .",
    "in the simulated shock , the compression ratios across the subshock and across the total transition are 3.1 and 11 , respectively , so @xmath19 is @xmath203 at low energy momenta but flattens to @xmath204 at high energy momenta just below @xmath45 .",
    "this demonstrates that nonlinear feedbacks between the precursor dynamics and the cr injection and acceleration should be treated accurately in numerical simulations of cr shocks .",
    "we are currently implementing a numerical scheme for the self - consistent injection model by @xcite which is based on the plasma - physics study of the nonlinear wave - particle interactions in shocks presented by @xcite .",
    "this will allow us to eliminate any free parameters for the injection process from the cr shock simulations .",
    "we intend also to extend the code to treat spherical shocks in order to study cr acceleration in supernova remnants .",
    "hk was supported by korea research foundation grant ( krf-99 - 015-di0114 ) .",
    "twj is supported by the university of minnesota supercomputing institute , by nsf grant ast-9619438 and by nasa grant nag5 - 5055 .",
    "rjl is supported in part by doe grant de - fg03 - 96er25292 and nsf grant dms-9626645 .",
    "kms was supported in part by national science council of republic of china grant nsc-89 - 2115-m-002 - 019 ."
  ],
  "abstract_text": [
    "<S> we have developed a novel computer code designed to follow the evolution of cosmic - ray modified shocks , including the full momentum dependence of the particles for a realistic diffusion coefficient model . in this form </S>",
    "<S> the problem is technically very difficult , because one needs to cover a wide range of diffusive scales , beginning with those slightly larger than the physical shock thickness . with most finite difference schemes for euler s equations </S>",
    "<S> the numerical shock thickness is at least one zone across , so this provides a lower bound on the physical scale for diffusive transport computation . </S>",
    "<S> our code uses sub - zone shock tracking @xcite and multi - level adaptive mesh refinement @xcite to provide enhanced spatial resolution around shocks at modest cost compared to the coarse grid and vastly improved cost effectiveness compared to a uniform , highly refined grid . </S>",
    "<S> we present and discuss the implications from our initial results . </S>"
  ]
}