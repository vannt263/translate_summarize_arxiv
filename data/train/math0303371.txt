{
  "article_text": [
    "a physically motivated class of nonlinear systems are _ gradient control systems _ , see  @xcite and the references quoted therein .",
    "these systems are described in the following way : they are nonlinear affine control systems , which are endowed with a pseudo - riemannian metric on the state space manifold .",
    "the drift vector field of the system is the gradient vector field associated with an internal potential function with respect to the pseudo - riemannian metric , and the input vector fields are the gradient vector fields associated with the output functions of the system .",
    "examples of gradient control systems include nonlinear electrical rlc networks , and dissipative systems where the inertial effects are neglected . in the case of rl or rc networks ,",
    "the pseudo - riemannian metric is positive - definite , and thus is a usual riemannian metric , while for general rlc networks the metric is indefinite .",
    "we refer to  @xcite for more background on the modeling of nonlinear networks as gradient systems .",
    "another relevant class of nonlinear systems is the family formed by the _",
    "hamiltonian control systems_. in this case , the state space manifold is equipped with a symplectic form .",
    "the drift vector field and the input vector fields are the hamiltonian vector fields associated , respectively , to an internal energy function and the output functions of the system with respect to the symplectic form .",
    "hamiltonian equations are of central importance in the modeling of physical systems as they are the starting point to describe the dynamics of a very large class of phenomena , including mechanical , electrical and electromagnetic systems .    apart from their physical and engineering importance , gradient and hamiltonian systems also possess very peculiar mathematical properties .",
    "for instance , a linear input - state - output system is a hamiltonian control system  @xcite ( respectively a gradient control system  @xcite ) if and only if its impulse response matrix @xmath0 satisfies @xmath1 ( respectively @xmath2 ) .",
    "although they are typically not amenable to linearization techniques , their rich geometric structure makes possible to combine powerful tools from nonlinear control theory , differential geometry and classical mechanics in the study of a variety of problems including stability and stabilization , input - output decoupling , structural synthesis and interconnection .",
    "their theoretical and practical relevance , together with their meaningful geometric properties and the wide range of results available for them , make the classes of hamiltonian and gradient systems _ distinct _ within the family of nonlinear affine control systems .",
    "this explains the interest in identifying those systems that can be written as either hamiltonian or gradient .",
    "this _ characterization problem _ is motivated by the realization problem in systems theory and the inverse problem in mechanics .",
    "the realization problem addresses the question of when the input - output map of a system can be realized as the external behavior of a hamiltonian ( respectively gradient ) input - output system .",
    "the inverse problem , which has a longstanding history in mathematical physics , poses the question of when a second - order differential equation can be realized as the euler - lagrange equations corresponding to certain lagrangian function . for further reference on these problems ,",
    "the reader is referred to  @xcite .    in  @xcite ,",
    "necessary and sufficient conditions were given under which a minimal nonlinear affine control system with an equal number of inputs and outputs is a hamiltonian control system with respect to some symplectic structure , which turned out to be unique . in the present paper",
    "we describe an analogous theory for the case of gradient systems .",
    "as we discuss below , there are a number of key differences in the treatment of the characterization problem for the hamiltonian and the gradient case , which make the latter more involved .",
    "the role played in the hamiltonian setting by the lie bracket and the hamiltonian vector fields is taken in the gradient setting by the symmetric product associated with an affine connection and the gradient vector fields .",
    "a fundamental observation is that , while every input - state - output system admits a natural extension to a hamiltonian system living on the cotangent bundle of its state space , the construction of a gradient extension on the cotangent bundle relies on the selection of a torsion - free connection on the state space .",
    "this motivates the introduction of a novel _ compatibility condition _ of the given nonlinear system with the selected affine connection guaranteeing an appropriate choice of the latter one .",
    "the compatibility condition is expressed as a relation of the symmetric products of the drift vector field and the input vector fields with the output functions of the system , and turns out to play a prominent role in the characterization of gradient control systems presented in theorem  [ th : characterization ] below .",
    "the paper is organized as follows . in section  [",
    "se : gradient - control - systems ] we present the class of nonlinear systems considered along the paper .",
    "we also introduce the notions of prolongation and gradient extension of a nonlinear system , whose observability properties are studied in section  [ se : observability ] .",
    "section  [ se : externally - equivalent ] introduces the concept of ( weakly ) externally equivalent systems . in section  [",
    "se : main ] , we introduce the important notion of compatibility between a nonlinear system and a given affine connection . at this point , we are ready to state and prove the main result of the paper , namely the characterization of when a general nonlinear control system is gradient . in section  [ se : uniqueness - realization ] we investigate the uniqueness ( up to isometry ) of gradient realizations with the same input - output behavior and we give an alternative proof of a result in  @xcite .",
    "we present our conclusions in section  [ se : conclusions ] .",
    "finally , an appendix in section  [ se : appendix ] contains a simplifying result concerning the checkability of the compatibility condition for a nonlinear affine control system .",
    "let @xmath3 be an @xmath4-dimensional differentiable manifold",
    ". we will denote by @xmath5 , @xmath6 the tangent and cotangent bundles of @xmath3 , by @xmath7 the set of smooth vector fields on @xmath3 , by @xmath8 the set of smooth one - forms on @xmath3 , and by @xmath9 the set of smooth functions on @xmath3 . throughout the paper",
    ", the manifold @xmath3 and the mathematical objects defined on it will be assumed to be real - analytic .",
    "consider a nonlinear control system @xmath10 with state space @xmath3 , affine in the inputs , and with an equal number of inputs and outputs , @xmath11 where @xmath12 , @xmath13 and @xmath14 .",
    "the vector fields @xmath15 on @xmath3 are assumed to be complete and @xmath16 are real - valued functions on @xmath3 .",
    "the set @xmath17 is the control space , which for simplicity is assumed to be an open subset of @xmath18 , containing @xmath19 .",
    "the function @xmath20 belongs to a certain class of functions of time , denoted by @xmath21 , called the _",
    "admissible controls_. for our purposes , we may restrict the admissible controls to be the piecewise constant right continuous functions .",
    "an important subclass of the family of nonlinear systems   is formed by the hamiltonian control systems , see  @xcite . here",
    ", we will instead focus our attention on the family of gradient control systems .",
    "let @xmath22 be a pseudo - riemannian metric on @xmath3 , i.e. a non - degenerate symmetric ( 0,2)-tensor on @xmath3 ( not necessarily positive definite ) .",
    "consider the ` musical ' isomorphisms associated with @xmath22 , @xmath23 , @xmath24 defined by @xmath25 where @xmath26 and @xmath27 .",
    "the _ gradient vector field _ associated with a function @xmath28 is given by @xmath29 .",
    "reciprocally , a vector field @xmath30 is said to be _ locally gradient _ if the one - form @xmath31 is closed . by poincar s lemma , this is equivalent to saying that there exists a locally defined function @xmath28 such that @xmath32 .",
    "if this equality holds globally , @xmath33 is called _ gradient _ and will be denoted by @xmath34 . along the paper , we will drop the subindex when it is clear from the context the pseudo - riemannian metric with respect to which the gradient vector field is computed .",
    "if we fix coordinates @xmath35 on @xmath3 , then the pseudo - riemannian metric can be locally expressed as @xmath36 , where @xmath37 is a symmetric matrix .",
    "the musical isomorphisms are then given by @xmath38 , @xmath39 , where @xmath40 is the inverse matrix of @xmath41 .",
    "finally , the gradient vector field associated with @xmath42 reads @xmath43    now , assume that the state space @xmath3 in   is a pseudo - riemannian manifold , @xmath44 . furthermore , assume that the drift vector field @xmath45 is locally gradient and the input vector fields @xmath46 , @xmath47 are gradient with respect to the functions @xmath48 , i.e. @xmath49 , @xmath50 .",
    "then , the resulting system @xmath51 is called a _ locally gradient control system on @xmath3_. if the drift @xmath45 is a gradient vector field , then the system is called a _ gradient control system on @xmath3_.    our objective is to characterize when a nonlinear system of the form   is actually a locally gradient control system  , i.e. find necessary and sufficient conditions for the existence of a pseudo - riemannian metric on the state space @xmath3 such that the system   equals system  .",
    "these conditions will be given in terms of the output behavior of the so - called prolonged system and the gradient extension of @xmath10 , which we describe next .",
    "given an initial state @xmath52 , take a coordinate neighborhood of @xmath3 containing @xmath53 .",
    "let @xmath54 , @xmath55 $ ] be the solution of   corresponding to the input functions @xmath56 and the initial state @xmath52 , such that @xmath54 remains within the selected coordinate neighborhood .",
    "denote the resulting output by @xmath57 , with @xmath58 .",
    "then the _ variational system _ along the state - input - output trajectory @xmath59 is given by the following time - varying system , @xmath60 where @xmath61 , and @xmath62 , @xmath63 denote the inputs and the outputs of the variational system .",
    "the reason behind the terminology ` variational ' comes from the following fact : let @xmath64 , @xmath65 $ ] be a family of state - input - output trajectories of   parameterized by @xmath66 , with @xmath67 , @xmath68 and @xmath69 , @xmath70 $ ] .",
    "then , the infinitesimal variations @xmath71 satisfy equation  .",
    "additionally , if the initial state is the same for the whole family of trajectories , @xmath72 , then the variational state @xmath73 at time @xmath19 is necessarily @xmath19 .",
    "the _ prolongation or prolonged system _ of   corresponds to considering together the original system   and the variational system , @xmath74 with inputs @xmath75 , @xmath76 , outputs @xmath77 , @xmath78 and state @xmath79 . to state a coordinate - free definition of the prolonged system   on the whole tangent space @xmath5",
    ", we need to introduce the notions of vertical and complete lifts of functions and vector fields .",
    "we do this following  @xcite . given a function @xmath42 on @xmath3 , the _ complete lift _ of @xmath42 to @xmath5 , @xmath80 is defined by @xmath81 . in the induced local coordinates on @xmath5 , @xmath82 ,",
    "this reads @xmath83 the _ vertical lift _ of @xmath42 to @xmath5 , @xmath84 , is defined by @xmath85 , where @xmath86 denotes the tangent bundle projection .",
    "given a vector field @xmath33 on @xmath3 , the _ complete lift _ of @xmath33 to @xmath5 , @xmath87 is defined as the unique vector field verifying @xmath88 , for any @xmath89 . alternatively ,",
    "if @xmath90 , @xmath91 denotes the flow of @xmath33 , then we can define @xmath92 as the vector field whose flow is given by @xmath93 . in local coordinates , @xmath94 the _ vertical lift _ of @xmath33 to @xmath5 , @xmath95 is the unique vector field such that @xmath96 , for any @xmath89 . in local coordinates ,",
    "@xmath97    the following definition provides an intrinsic way of pasting together the system   with the variational systems associated with its state - input - output trajectories .",
    "[ dfn : prolonged - system ] the prolonged system @xmath98 of a nonlinear system @xmath10 of the form   is defined by @xmath99 where @xmath100 , and @xmath101 .",
    "one can easily check that in the induced tangent bundle coordinates , the local expression of the system   is precisely  .    in the same way as we have presented above",
    ", one can also introduce the notions of adjoint variational system and hamiltonian extension of the nonlinear system  .",
    "these notions play a key role in the characterization of when a general system admits a hamiltonian description , see  @xcite .      when dealing with the hamiltonian extension of a nonlinear system , one relies on the fact that the cotangent bundle is endowed with a canonical symplectic structure .",
    "however , this is not the case when treating gradient systems , since a canonical pseudo - riemannian structure on the cotangent bundle does not exist . in order to define the gradient extension of a nonlinear system of the form",
    ", we will first select a torsion - free affine connection @xmath102 on @xmath3 , and then consider its riemannian extension to @xmath6 ( cf .",
    "@xcite ) .",
    "let us briefly present some basic notions on affine connections and riemannian geometry .",
    "an _ affine connection _",
    "@xcite on a manifold @xmath3 is defined as an assignment @xmath103 which is @xmath104-bilinear and satisfies @xmath105 and @xmath106 , for any @xmath33 , @xmath107 , @xmath108 .",
    "this implies that @xmath109 only depends on @xmath110 and the value of @xmath111 along a curve which is tangent to @xmath33 at @xmath112 .",
    "let @xmath113 \\mapsto c(t)= ( x^1(t),\\ldots , x^n(t))\\in m$ ] be a curve on @xmath3 and @xmath114 a vector field along @xmath115 , i.e. a map @xmath116\\rightarrowtm}$ ] such that @xmath117 for all @xmath118 $ ] .",
    "let @xmath42 be a vector field that satisfies @xmath119 .",
    "the _ covariant derivative of @xmath114 along @xmath115 _ is defined by @xmath120 this definition makes sense because of the defining properties of the affine connection .",
    "now , we may take @xmath121 and set up @xmath122 .",
    "this equation is called the _ geodesic equation _ , and its solutions are termed the _",
    "geodesics _ of  @xmath102 . in local coordinates",
    ", this condition can be expressed as @xmath123 , @xmath124 , where the @xmath125 are the _",
    "christoffel symbols _ of the affine connection , defined by @xmath126 the vector field @xmath127 on @xmath5 describing the geodesic equation is called the _ geodesic spray _ associated with the affine connection @xmath102 . in local coordinates , @xmath128 therefore , the integral curves of the geodesic spray @xmath127 are the solutions of the geodesic equation . the torsion tensor of an affine connection is defined by @xmath129 \\ , , \\end{array}\\ ] ] locally , we have @xmath130 given an affine connection , the _ symmetric product _  @xcite of two vector fields @xmath131 is defined by the operation @xmath132 the geometric meaning of the symmetric product is the following  @xcite : a distribution @xmath133 on @xmath3 is geodesically invariant ( meaning that each geodesic of @xmath102 whose initial velocity is in @xmath133 has all its velocities in @xmath133 ) if and only if @xmath134 , for all @xmath33 , @xmath135 . the symmetric product plays a crucial role within the so - called affine connection formalism for mechanical control systems in the study of a variety of aspects such as controllability , series expansions , motion planning and optimal control  @xcite .    associated with the metric @xmath22 there is a natural affine connection , called the _ levi - civita _ connection .",
    "the levi - civita connection @xmath136 is determined by the formula @xmath137 ) - { { \\mathcal{g}}}(x,[y , z ] ) + { { \\mathcal{g}}}(z,[x , y ] ) \\ , , \\quad x , y , z \\in    \\mathfrak{x}(m ) \\ , .\\end{gathered}\\ ] ] one can compute the christoffel symbols of @xmath138 to be @xmath139 the levi - civita connection is torsion - free , that is @xmath140 , for any @xmath33 , @xmath141 .",
    "therefore , a pseudo - riemannian metric on @xmath3 defines a unique affine connection on @xmath3 , but the converse is not always true . given a pseudo - riemannian metric @xmath22 on @xmath3",
    ", we can define the so - called beltrami bracket  @xcite of functions on @xmath3 , @xmath142 in local coordinates , one has the expression , @xmath143 it is interesting to note that the mapping @xmath144 is a homomorphism of symmetric algebras , i.e. , @xmath145 , for all @xmath146 .",
    "the latter observation is the gradient analog of the following fact in the hamiltonian setting : consider the mapping @xmath147)$ ] ( where @xmath148 denotes the poisson bracket and @xmath149 $ ] denotes the lie bracket ) , associating to each function @xmath150 its hamiltonian vector field @xmath151 .",
    "then this mapping is a homomorphism of lie algebras , i.e. @xmath152 $ ] .",
    "let us now turn our discussion to the cotangent bundle of @xmath3 .",
    "first , we introduce the construction that associates to each vector field @xmath33 on @xmath3 a function @xmath153 on @xmath6 , defined by @xmath154 .",
    "the notion of _ vertical lift _ of a function @xmath42 on @xmath3 to a function @xmath155 on @xmath6 is given by @xmath156 , where @xmath157 is the cotangent bundle projection .",
    "an object which will play a key role in the subsequent discussion is the _",
    "riemannian extension _",
    "@xcite of a torsion - free affine connection .",
    "let @xmath102 be a torsion - free affine connection on @xmath3 .",
    "then , @xmath102 defines a pseudo - riemannian metric on @xmath6 , denoted @xmath158 , as the unique ( 0,2)-tensor on @xmath6 which satisfies @xmath159 the fact that this single equality completely determines the riemannian extension @xmath158 is a consequence of the result in proposition  4.2 in chapter  vii of  @xcite , which asserts that any @xmath160-tensor field on @xmath6 is univocally defined by its action on the complete lifts of vector fields of @xmath3 .",
    "the matrix representations of the musical isomorphisms defined by @xmath158 in the induced local coordinates @xmath161 on @xmath6 are given by @xmath162 as for the gradient vector fields associated with the functions @xmath153 , @xmath163 , @xmath164 , @xmath165 , one has the local expressions @xmath166    [ dfn : gradient - extension ] the gradient extension @xmath167 of a nonlinear system @xmath10 of the form   with respect to a torsion - free affine connection @xmath102 on @xmath3 is given by @xmath168 where @xmath169 , @xmath170 , @xmath171 , and @xmath172 .",
    "note that the gradient extension @xmath173 is itself a gradient control system .",
    "in this section , we investigate the observability properties of the prolonged system and the gradient extension of a nonlinear system .",
    "we start by briefly reviewing some notions such as distinguishable points and local observability .",
    "let @xmath174 denote the space of absolutely continuous functions on @xmath3 with values in @xmath18 .",
    "for a nonlinear system of the form  , the _ input - output map _",
    "@xmath175 , @xmath176 is defined by assigning to each initial condition @xmath177 and any admissible control @xmath178 the output of the system , @xmath179 where @xmath180 denotes the solution of @xmath181 starting at @xmath53 .",
    "now , two points @xmath182 , @xmath183 are said to be _ indistinguishable _",
    ", @xmath184 , if @xmath185 for any @xmath186 .    [ dfn : observability ] a system @xmath10 is _ observable _ if for any @xmath182 , @xmath183 , one has that @xmath187",
    ". alternatively , for any @xmath188 , there exists an admissible control such that the output functions resulting from the initial conditions @xmath189 , resp .",
    "@xmath190 , are different .",
    "the system is _ locally observable _ at @xmath53 if there exists a neighborhood @xmath191 of @xmath53 such that this holds for points in @xmath191 .",
    "denote by @xmath192 the @xmath104-linear space in @xmath9 spanned by the functions of the form @xmath193 , with @xmath194 , and @xmath195 .",
    "alternatively , we may take @xmath196 to be arbitrary elements of the accessibility algebra corresponding to the vector fields @xmath15 .",
    "@xmath192 is called the _ observation space _ of @xmath10 .",
    "it follows from the analyticity assumption that the system is observable if and only if @xmath192 distinguishes points in @xmath3 , i.e. for every @xmath182 , @xmath183 with @xmath197 , there exists @xmath198 such that @xmath199 , cf .",
    "@xcite .",
    "[ prop : observability - prolongation ] consider a nonlinear system @xmath10 of the form  , with observation space @xmath192 .",
    "then , the observation space @xmath200 of the prolongation @xmath98 is given by @xmath201 , where @xmath202 and @xmath203 .",
    "the following corollary is a modified statement of corollary  3.3 in  @xcite .",
    "assume the codistribution @xmath204 is of constant rank .",
    "then the system @xmath10 is ( locally ) observable if and only if its prolongation is ( locally ) observable .    following  @xcite , @xmath10 is locally observable if and only @xmath205 . in addition",
    ", the codistribution @xmath204 on @xmath3 has constant rank if and only if the codistribution @xmath206 on @xmath5 has constant rank .",
    "therefore , @xmath207 if and only if @xmath208 if and only if @xmath98 is locally observable .",
    "the statement regarding observability is proved as in corollary  3.3 in  @xcite .",
    "let us turn our attention to the observability properties of the gradient extension of a nonlinear system of the form  .",
    "the following lemma will be most helpful .",
    "[ le : accessory ] let @xmath102 be a torsion - free affine connection on a manifold @xmath3 , and let @xmath158 denote its riemannian extension to @xmath6 . then ,",
    "for any vector fields @xmath33 , @xmath141 , and any functions @xmath150 , @xmath209 , the following identities hold    1 .",
    "2 .   @xmath211 .",
    "3 .   @xmath212 .",
    "the first equality in ( i ) is the definition of the beltrami bracket associated with @xmath158 . for the second one ,",
    "we resort to the local expressions in   to compute @xmath213 the third equality corresponds to the definition of @xmath158 .",
    "the first and second equalities in ( ii ) follow again by definition . as for the third one , note that @xmath214 finally , the equalities in ( iii ) are straightforward .",
    "denote by @xmath215 the @xmath104-linear space in @xmath216 spanned by the vector fields of the form @xmath217 , with @xmath218 , and @xmath195 .",
    "alternatively , one can define @xmath215 as the smallest subspace of @xmath216 such that ( i ) @xmath219 ; and ( ii ) if @xmath220 , then @xmath221 for all @xmath222 .",
    "we denote by @xmath223 the distribution on @xmath3 generated by the space @xmath215 , @xmath224    [ prop : observation - extension ] consider a nonlinear system @xmath10 of the form  , with observation space @xmath192 .",
    "let @xmath102 be a torsion - free affine connection on @xmath3 .",
    "then , the observation space @xmath225 of the gradient extension @xmath167 is given by @xmath226 , where @xmath227 and @xmath228 is spanned by @xmath229 , with @xmath196 , @xmath230 , equal to @xmath231 , @xmath222 , @xmath232 and @xmath47 .",
    "the observation space of the gradient extension of @xmath10 is spanned by @xmath233 where @xmath196 , @xmath230 is equal to @xmath234 , @xmath235 , @xmath222 , @xmath47 .",
    "now , using lemma  [ le : accessory ] , we have that @xmath236 with @xmath222 and @xmath237 . considering the next step of lie derivatives yields @xmath238 with @xmath239 .",
    "further iterating this process , we get to the desired result .",
    "[ cor : observability - gradient - extension ] consider a nonlinear system @xmath10 of the form  , with observation space @xmath192 .",
    "assume the codistribution @xmath204 is of constant rank .",
    "let @xmath102 be a torsion - free affine connection on @xmath3 and further assume that the distribution @xmath223 is full - rank . then",
    ", @xmath10 is ( locally ) observable implies that @xmath167 is ( locally ) observable .",
    "since the codistribution @xmath204 has constant rank , @xmath10 is locally observable if and only if @xmath240 .",
    "since @xmath223 is full - rank , it is clear that @xmath10 locally observable implies that @xmath225 has constant maximal rank , and therefore @xmath167 is locally observable . with respect to observability ,",
    "let @xmath241 , @xmath242 and assume that @xmath243 for all @xmath244 .",
    "since @xmath245 , this yields @xmath246 for any @xmath198 .",
    "so , under observability of @xmath10 , we conclude that @xmath247 .",
    "then , we have that @xmath248 , for all @xmath220 , which finally implies that @xmath249 .",
    "in this section we introduce the notion of ( weakly ) externally equivalent systems , which will be instrumental in the statement of the main result in section  [ se : main ] .",
    "consider two nonlinear systems @xmath250 , of the form , @xmath251 denote by @xmath252 , @xmath250 , the associated observation spaces .",
    "take a function @xmath253 , @xmath254 , with @xmath255 , @xmath256 , @xmath230 and @xmath257 .",
    "consider the function in @xmath258 defined by @xmath259 , with @xmath260 , @xmath230 .",
    "then we say that @xmath261 and @xmath262 formally _ correspond _ to each other .",
    "this notion is useful to define the concept of _ weakly externally equivalent _ systems .",
    "[ dfn : weakly - externally - equivalent ] the systems @xmath263 and @xmath264 are weakly externally equivalent if and only if for all @xmath265 , there exists @xmath266 such that @xmath267 for all corresponding @xmath253 , @xmath268 , and vice versa .",
    "[ dfn : externally - equivalent ] the systems @xmath263 and @xmath264 are externally equivalent if and only if for all @xmath265 , there exists @xmath266 such that the input - output maps corresponding to @xmath269 and @xmath270 coincide , i.e. @xmath271 , for all @xmath272 , and vice versa .",
    "equivalently , @xmath263 and @xmath264 are externally equivalent if and only if their behaviors are equal",
    ". clearly , if two systems are externally equivalent , then they are weakly externally equivalent .",
    "[ prop : existence - unique - diffeomorphism ] assume that @xmath263 and @xmath264 are weakly externally equivalent , observable and that the codistributions @xmath273 , @xmath250 , have constant rank",
    ". then there exists a unique diffeomorphism @xmath274 with @xmath275 .",
    "let @xmath265 .",
    "by definition , there exists @xmath266 such that @xmath276 for all corresponding @xmath253 , @xmath277 .",
    "since @xmath258 distinguishes points in @xmath278 , it follows that @xmath270 is unique .",
    "define @xmath279 , @xmath280 .",
    "using @xmath281 and the inverse function theorem , it follows that @xmath282 is smooth .",
    "indeed , for each @xmath266 , there exists a neighborhood @xmath42 of @xmath278 at @xmath283 and @xmath284 independent functions @xmath285 on @xmath42 , such that @xmath282 is given by @xmath286 analogously , we can construct the inverse mapping @xmath287 , making use of the fact that @xmath288 is observable , which concludes the proof .",
    "[ cor : equivalent ] let the systems @xmath263 and @xmath264 be observable and the codistributions @xmath273 , @xmath250 , have constant rank",
    ". then @xmath263 and @xmath264 are weakly externally equivalent if and only if they are externally equivalent .",
    "we already know that if the systems are externally equivalent , then they are weakly externally equivalent .",
    "conversely , assume that @xmath263 and @xmath264 are weakly externally equivalent . from proposition",
    "[ prop : existence - unique - diffeomorphism ] , we have that there exists a diffeomorphism @xmath279 with @xmath289 . using this latter fact , and since the vector fields @xmath290 , @xmath291 are determined by their action as derivations on @xmath252 , @xmath250 , we conclude that @xmath292 , @xmath293 , @xmath47 .",
    "the map @xmath282 in the previous proof is called a _ state space diffeomorphism_.",
    "this section contains the main result of the paper . under certain technical conditions , theorem  [ th : characterization ] below characterizes when a nonlinear control systems admits a gradient realization . before stating this result",
    ", we need to introduce the novel notion of _ compatibility _ between a nonlinear system and an affine connection .",
    "[ dfn : compatibility ] let @xmath102 be an affine connection on @xmath3 .",
    "a nonlinear control system @xmath10 of the form   is compatible with @xmath102 if and only if the following two conditions hold :    \\(a ) for all vector fields @xmath294 , @xmath295 , and all indexes @xmath296 , @xmath297 \\\\",
    "= { \\mathcal{l}}_{{\\langle y_1 : { \\langle y_2 : { \\langle \\ldots                : { \\langle y_{s_2 } : g_k\\rangle}\\rangle}\\ldots\\rangle}\\rangle } } \\left [ { \\mathcal{l}}_{x_1 } { \\mathcal{l}}_{x_2 }          \\ldots { \\mathcal{l}}_{x_{s_1 } } v_j \\right ] \\ , .",
    "\\end{gathered}\\ ] ]    \\(b ) for all vector fields @xmath294 , @xmath298 , @xmath299 , and all indexes @xmath300 , @xmath301",
    "\\\\        = { \\mathcal{l}}_{{\\langle z_1 : { \\langle z_2 : { \\langle \\ldots                : { \\langle z_{s_3 } : g_l\\rangle}\\rangle}\\ldots\\rangle}\\rangle } } \\left [          { \\mathcal{l}}_{{\\langle x_1 : { \\langle x_2 : { \\langle \\ldots                  : { \\langle x_{s_1 } : g_j\\rangle}\\rangle}\\ldots\\rangle}\\rangle } } \\left [ { \\mathcal{l}}_{y_1 } { \\mathcal{l}}_{y_2 }            \\ldots { \\mathcal{l}}_{y_{s_2 } } v_k \\right ] \\right ] \\ , .      \\end{gathered}\\ ] ]     note that a locally gradient control system of the form   is compatible in the above sense with the levi - civita connection associated with the pseudo - riemannian metric @xmath22 .",
    "indeed , let @xmath302 , @xmath303 denote , respectively , the symmetric product and the beltrami bracket corresponding to @xmath136 and @xmath22 . take @xmath304 , @xmath305 , @xmath306 , @xmath307 ( which can always be written at least locally ) , then @xmath308 \\\\",
    "= { \\mathcal{l}}_{\\grad          { \\ { v_{\\alpha_1 } : { \\ { v_{\\alpha_2 } : { \\ { \\ldots                : { \\ { v_{\\alpha_{s_1 } } : v_j \\ } } \\}}\\ldots \\ } } \\ } } } \\left [          { \\ { v_{\\beta_1 } : { \\ { v_{\\beta_2 } : { \\ { \\ldots                : { \\ { v_{\\beta_{s_2 } } : v_k \\ } } \\}}\\ldots \\ } } \\}}\\right ] \\\\ =        { \\mathcal{l}}_{\\grad          { \\ { v_{\\beta_1 } : { \\ { v_{\\beta_2 } : { \\ { \\ldots                : { \\ { v_{\\beta_{s_2 } } : v_k \\ } } \\}}\\ldots \\ } } \\ } } } \\left [          { \\ { v_{\\alpha_1 } : { \\ { v_{\\alpha_2 } : { \\ { \\ldots                : { \\ { v_{\\alpha_{s_1 } } : v_j \\ } } \\}}\\ldots \\ } } \\ } } \\right ]",
    "\\\\        = { \\mathcal{l}}_{{\\langle y_1 : { \\langle y_2 : { \\langle \\ldots                : { \\langle y_{s_2 } : g_k\\rangle}\\rangle}\\ldots\\rangle}\\rangle } } \\left [ { \\mathcal{l}}_{x_1 } { \\mathcal{l}}_{x_2 }          \\ldots { \\mathcal{l}}_{x_{s_1 } } v_j \\right ] \\ , ,      \\end{gathered}\\ ] ] and @xmath309 \\\\",
    "= { \\mathcal{l } } _ { \\grad { \\ {   { \\ {               v_{\\alpha_1 } : { \\ { v_{\\alpha_2 } : { \\ { \\ldots                  : { \\ { v_{\\alpha_{s_1 } } : v_j \\ } } \\}}\\ldots \\ } } \\ } } :             { \\ { v_{\\beta_1 } : { \\ { v_{\\beta_2 } : { \\ { \\ldots                  : { \\ { v_{\\beta_{s_2 } } : v_k \\ } } \\}}\\ldots \\ } } \\ } } \\ } } } \\\\        \\left [ { \\ { v_{\\gamma_1 } : { \\ { v_{\\gamma_2 } : { \\ { \\ldots                : { \\ { v_{\\gamma_{s_3 } } : v_l \\ } } \\}}\\ldots \\ } } \\ } } \\right ]        \\\\        = { \\mathcal{l } } _ { \\grad { \\ {             v_{\\gamma_1 } : { \\ { v_{\\gamma_2 } : { \\ { \\ldots                : { \\ { v_{\\gamma_{s_3 } } : v_l \\ } } \\}}\\ldots \\ } } \\ } } } \\\\        \\left [ { \\ {   { \\ {               v_{\\alpha_1 } : { \\ { v_{\\alpha_2 } : { \\ { \\ldots                  : { \\ { v_{\\alpha_{s_1 } } : v_j \\ } } \\}}\\ldots \\ } } \\ } } :             { \\ { v_{\\beta_1 } : { \\ { v_{\\beta_2 } : { \\ { \\ldots                  : { \\ { v_{\\beta_{s_2 } } : v_k \\ } } \\}}\\ldots \\ } } \\ } } \\ } } \\right ]",
    "\\\\        = { \\mathcal{l}}_{{\\langle z_1 : { \\langle z_2 : { \\langle \\ldots                : { \\langle z_{s_3 } : g_l\\rangle}\\rangle}\\ldots\\rangle}\\rangle } } \\left [          { \\mathcal{l}}_{{\\langle x_1 : { \\langle x_2 : { \\langle \\ldots                  : { \\langle x_{s_1 } : g_j\\rangle}\\rangle}\\ldots\\rangle}\\rangle } } \\left [ { \\mathcal{l}}_{y_1 } { \\mathcal{l}}_{y_2 }            \\ldots { \\mathcal{l}}_{y_{s_2 } } v_k \\right ] \\right ] \\ , .",
    "\\end{gathered}\\ ] ]     in case the distribution @xmath223 is full - rank , note that property ( b ) in the above definition implies property ( a ) up to a constant on each connected component of @xmath3 . to see this",
    ", one can use the symmetry of the symmetric product to deduce from ( b ) that @xmath310 \\right ] \\\\",
    "= { \\mathcal{l}}_{{\\langle z_1 : { \\langle z_2 : { \\langle \\ldots                : { \\langle z_{s_3 } : g_l\\rangle}\\rangle}\\ldots\\rangle}\\rangle } } \\left [          { \\mathcal{l}}_{{\\langle y_1 : { \\langle y_2 : { \\langle \\ldots                  : { \\langle y_{s_2 } : g_k\\rangle}\\rangle}\\ldots\\rangle}\\rangle } } \\left [ { \\mathcal{l}}_{x_1 } { \\mathcal{l}}_{x_2 }            \\ldots { \\mathcal{l}}_{x_{s_1 } } v_j \\right ] \\right ] \\ , .",
    "\\end{gathered}\\ ] ] now , one concludes the result from the full - rankness of @xmath223 .",
    "another interesting observation in this case is that the checkability of the compatibility condition can be performed taking a basis of vector fields in @xmath215 as we discuss later in lemma  [ le : checkability ] .",
    "now , we come to the main result of the paper .",
    "[ th : characterization ] let @xmath10 be a nonlinear control system of the form  .",
    "let @xmath102 be a torsion - free affine connection defined on the state manifold @xmath3 .",
    "assume @xmath10 is observable with @xmath311 constant , compatible with @xmath102 and that the distribution @xmath223 is full - rank .",
    "then , @xmath10 is a locally gradient control system if and only if its prolonged system @xmath98 and its gradient extension @xmath312 are weakly externally equivalent .",
    "@xmath313 ) consider a locally gradient control system @xmath10 on @xmath314 ( cf .  ) , together with its prolongation @xmath98 on @xmath5 and its gradient extension @xmath167 on @xmath6 .",
    "recall that in the induced bundle coordinates @xmath315 on @xmath5 , @xmath316 on @xmath6 , the musical isomorphisms associated with @xmath22 read @xmath317 and @xmath318 .",
    "we are going to show that @xmath319 is actually an isomorphism between the prolongation and the gradient extension , i.e. we will prove that @xmath320 along the solutions of   and   respectively .",
    "this will be a consequence of the following equalities @xmath321 for all @xmath222 , @xmath47 . in order to show  , we will make use of the following identities , @xmath322 let @xmath323 . in local coordinates , @xmath324 . using",
    ", we get @xmath325 on the other hand , we have that @xmath326 now , suppose that @xmath327 is a locally gradient vector field . in local coordinates ,",
    "this means that @xmath328 , for a certain function @xmath42 , which in turn implies that @xmath329 , that is @xmath330 substituting into the above expression for @xmath331 , @xmath332 therefore , the first equality in   holds for every @xmath222 .",
    "the equality @xmath333 , @xmath47 , follows by considering   and the fact that the vector fields @xmath46 are gradient by hypothesis , @xmath334 as for @xmath335 , for each @xmath336 , we compute @xmath337 .",
    "the last equality follows trivially .",
    "consequently , the prolongation and the gradient extension of a nonlinear system @xmath10 which is itself gradient are externally equivalent , in particular weakly externally equivalent systems .    to prove the converse implication , we need some intermediate steps .",
    "[ le : mapping ] let @xmath10 be a nonlinear system of the form  . under the hypothesis of theorem  [ th : characterization ] , assume that the prolongation @xmath98 and the gradient extension @xmath167 are weakly externally equivalent .",
    "then there exists a unique diffeomorphism @xmath338 such that @xmath339 for all @xmath222 , @xmath47 .",
    "moreover , @xmath282 is a bundle morphism over the identity @xmath340 , i.e. in natural coordinates @xmath341 , for certain map",
    "@xmath342 , @xmath12 .    by proposition  [ prop : observability - prolongation ] and corollary  [ cor : observability - gradient - extension ] , we have that both the prolongation and the gradient extension are observable systems .",
    "since they are also weakly externally equivalent by assumption , corollary  [ cor : equivalent ] ensures that there exists a unique diffeomorphism @xmath343 verifying  . applying now corollary  [ cor : equivalent ] to @xmath344 , we deduce that there exists a unique diffeomorphism from @xmath3 to @xmath3 mapping the original nonlinear system to itself , namely the identity mapping . using uniqueness and the fact that @xmath282 satisfies",
    ", it then follows that @xmath282 is of the form @xmath341 , for certain map @xmath342 , @xmath12 .",
    "[ le : mapping - structure ] under the same assumptions as in lemma  [ le : mapping ] , there exists a unique pseudo - riemannian metric @xmath22 on @xmath3 such that @xmath345 , i.e. @xmath346 for all @xmath336 .",
    "it follows from @xmath347 ( cf .",
    "equation  ) and the structure of the diffeomorphism @xmath282 that @xmath348 furthermore , from @xmath349 ( see eq .  ) , it follows that @xmath350 using now lemma  [ le : accessory ] ( i ) , we get @xmath351 . in general for all @xmath352 , @xmath353 with the @xmath196 , @xmath230 equal to some @xmath231 , @xmath222 .",
    "since the right - hand side of this equation is linear in @xmath354 and the distribution generated by the space @xmath215 is full - rank by hypothesis , it follows that for each @xmath12 there exists a unique matrix @xmath355 such that @xmath356 .",
    "since @xmath282 is a diffeomorphism , @xmath355 is non - singular for every @xmath112 and depends smoothly on the base point .",
    "consider the adjoint mapping of @xmath282 , @xmath357 , defined by @xmath358 , @xmath359 , @xmath360 .",
    "then , @xmath361 .",
    "it follows from   that @xmath355 satisfies @xmath362 with the @xmath196 as above .",
    "let us see now that @xmath363 .",
    "note that in local coordinates @xmath364 yields , @xmath365 or , equivalently , @xmath366 , @xmath47 , which in intrinsic terms , can be written as @xmath367 .",
    "now , @xmath368 using  , the latter is equal to @xmath369 where in the last equality we have used the property ( a ) of the compatibility definition between the nonlinear system @xmath10 and the affine connection @xmath102",
    ". finally , @xmath370 by the assumption on the full - rankness of the distribution @xmath223 , we conclude that @xmath371 which in turn implies that @xmath372 , i.e. , the matrix @xmath355 is symmetric .",
    "[ le : concluding ] under the same assumptions as in lemma  [ le : mapping ] , the torsion - free affine connection @xmath102 is the levi - civita connection corresponding to the pseudo - riemannian metric  @xmath22 .",
    "first of all , note that @xmath373 \\nonumber \\\\      & \\quad = { \\mathcal{l}}_{{\\langle z_1 : { \\langle z_2 : { \\langle \\ldots              : { \\langle z_{s_3 } : g_l\\rangle}\\rangle}\\ldots\\rangle}\\rangle } } \\left [        { \\mathcal{l}}_{{\\langle x_1 : { \\langle x_2 : { \\langle \\ldots                : { \\langle x_{s } : g_j\\rangle}\\rangle}\\ldots\\rangle}\\rangle } } \\left [ { \\mathcal{l}}_{y_1 }          { \\mathcal{l}}_{y_2 } \\ldots { \\mathcal{l}}_{y_{s_2 } } v_k \\right ] \\right ] \\\\      &",
    "\\quad = < { \\left (          { \\mathcal{l}}_{{\\langle x_1 : { \\langle x_2 : { \\langle \\ldots                  : { \\langle x_{s } : g_j\\rangle}\\rangle}\\ldots\\rangle}\\rangle } } \\left[{\\mathcal{l}}_{y_1 } { \\mathcal{l}}_{y_2 }            \\ldots { \\mathcal{l}}_{y_{s_2 } } v_k \\right ] \\right)^{\\textsc{c } } } \\circ \\varphi^{-1 } , d      ( { \\mathcal{l}}_{z_1 } { \\mathcal{l}}_{z_2 } \\ldots { \\mathcal{l}}_{z_{s_3 } } v_l ) > .",
    "\\nonumber    \\end{aligned}\\ ] ] since the observation space of the nonlinear system @xmath10 is generated by the functions of the form @xmath374 , and @xmath10 is observable by hypothesis , we conclude that @xmath375 \\right)^{\\textsc{c } } } \\ , .",
    "\\end{gathered}\\ ] ] given the structure of the mapping @xmath282 ( cf .",
    "lemmas  [ le : mapping ] and  [ le : mapping - structure ] ) , and equation  , this equality can be rewritten as , @xmath376 since @xmath377 , we conclude @xmath378 using the fact that @xmath223 is full - rank , we deduce that @xmath379 for all @xmath33 , @xmath380 .",
    "finally , using the fact that @xmath102 is torsion - free , we compute @xmath381 \\right ) =      \\frac{1}{2 } \\left ( { \\langle x : y\\rangle}_{{\\mathcal{g}}}+ [ x , y ] \\right ) = \\nabla^{{{\\mathcal{g}}}}_x y \\ ,      , \\quad \\forall x , y \\in \\mathfrak{x } ( m ) \\ , ,    \\end{aligned}\\ ] ] which concludes the result .    we are now ready to conclude the proof of theorem  [ th : characterization ]",
    ".    _ proof of theorem  [ th : characterization]_. @xmath382 ) assume the prolongation @xmath98 and the gradient extension @xmath167 are weakly externally equivalent . from lemmas  [ le : mapping ] ,  [ le : mapping - structure ] and  [ le : concluding ] , we deduce the existence of a pseudo - riemannian metric @xmath22 on @xmath3 such that @xmath383 and the unique diffeomorphism between @xmath5 and @xmath6 relating @xmath98 and @xmath167 and verifying   is @xmath384 . from @xmath385 , we deduce @xmath386 , and hence @xmath387 , @xmath47 . finally , we show that @xmath45 is a locally gradient vector field . from @xmath388 and",
    "the local expression   of the christoffel symbols of the levi - civita connection @xmath138 , we deduce that @xmath389 which implies that the one - form @xmath390 is closed .",
    "note that , given the torsion - free affine connection @xmath102 , the pseudo - riemannian metric @xmath22 obtained in the proof of theorem  [ th : characterization ] is unique such that @xmath10 is locally gradient with respect to it . in section  [ se : uniqueness - realization ]",
    "below , we investigate the uniqueness ( up to isometry ) of gradient realizations with the same input - output behavior .    in general , we can not ensure that the drift vector field @xmath45 is globally gradient , unless we impose some additional conditions on the topology of the state space @xmath3 ( for instance , that the first betti number of @xmath3 is zero ) .",
    "this is analogous to the situation in the hamiltonian setting  @xcite .",
    "one can verify that the pseudo - riemannian metric on @xmath5 defined by @xmath391 corresponds to the complete lift to @xmath5 of the original metric @xmath22 on @xmath3 ( see  @xcite ) .    a different way to prove the same result which indeed keeps a closer parallelism with the proof for the hamiltonian case  @xcite would be the following .",
    "once one has proved lemmas  [ le : mapping ] and  [ le : mapping - structure ] , instead of proving lemma  [ le : concluding ] , one can show that @xmath392 for any @xmath195 and @xmath393 , @xmath230 .",
    "this can be done by considering the following vector fields on @xmath6 , @xmath394 and showing that their action on the observation space @xmath225 of @xmath167 is the same . to see this , recall from proposition  [ prop : observation - extension ] that @xmath395 .",
    "consider a function of the form @xmath193 , with @xmath196 , @xmath230 , equal to @xmath231 , @xmath222 , and @xmath47 .",
    "then , @xmath396 = \\\\        = \\left ( { \\mathcal{l}}_{{{\\langle x_1 : { \\langle x_2 : { \\langle \\ldots                    : { \\langle x_{s } : g_j\\rangle}\\rangle}\\ldots\\rangle}\\rangle}^{\\textsc{c } } } } \\left [            { ( { \\mathcal{l}}_{x_1 } { \\mathcal{l}}_{x_2 } \\ldots { \\mathcal{l}}_{x_s } v_j)^{\\textsc{v } } } \\circ            \\varphi          \\right ] \\right ) \\circ \\varphi^{-1 } = \\\\        = { \\left ( { \\mathcal{l}}_{{\\langle x_1 : { \\langle x_2 : { \\langle \\ldots                    : { \\langle x_{s } : g_j\\rangle}\\rangle}\\ldots\\rangle}\\rangle } } \\left [ { \\mathcal{l}}_{x_1 } { \\mathcal{l}}_{x_2 }              \\ldots { \\mathcal{l}}_{x_s } v_j \\right]\\right)^{\\textsc{v } } } \\ , ,      \\end{gathered}\\ ] ] where we have used twice the fact that @xmath282 is the identity mapping on the base manifold @xmath3 . on the other hand , @xmath397 = { \\left (            { \\mathcal{l}}_{{\\langle x_1 : { \\langle x_2 : { \\langle \\ldots                    : { \\langle x_{s } : g_j\\rangle}\\rangle}\\ldots\\rangle}\\rangle } } \\left [ { \\mathcal{l}}_{x_1 } { \\mathcal{l}}_{x_2 }              \\ldots { \\mathcal{l}}_{x_s } v_j \\right]\\right)^{\\textsc{v } } } \\ , ,      \\end{aligned}\\ ] ] using property ( ii ) in lemma  [ le : accessory ] .",
    "the same argument also guarantees that the action of @xmath398 and @xmath399 is the same over the vertical lifts of the functions spanning @xmath228 .",
    "finally , let @xmath400 and consider the corresponding function on @xmath6 , @xmath401 .",
    "then , @xmath402 = \\\\        = \\left ( { \\mathcal{l}}_{{{\\langle x_1 : { \\langle x_2 : { \\langle \\ldots                    : { \\langle x_{s } : g_j\\rangle}\\rangle}\\ldots\\rangle}\\rangle}^{\\textsc{c } } } } \\left [            v^{{\\langle y_1 : { \\langle y_2 : { \\langle \\ldots                    : { \\langle y_{s_2 } : g_k\\rangle}\\rangle } \\ldots \\rangle}\\rangle } }            \\circ \\varphi   \\right ] \\right ) \\circ \\varphi^{-1 } =",
    "\\\\        = \\left ( { \\mathcal{l}}_{{{\\langle x_1 : { \\langle x_2 : { \\langle \\ldots                    : { \\langle x_{s } : g_j\\rangle}\\rangle}\\ldots\\rangle}\\rangle}^{\\textsc{c } } } }          \\left[{({\\mathcal{l}}_{y_1 } { \\mathcal{l}}_{y_2 } \\ldots { \\mathcal{l}}_{y_{s_2 } } v_k)^{\\textsc{c } } }          \\right ]        \\right ) \\circ   \\varphi^{-1 }",
    "\\\\        = { \\left ( { \\mathcal{l}}_{{\\langle x_1 : { \\langle x_2 : { \\langle \\ldots                    : { \\langle x_{s } : g_j\\rangle}\\rangle}\\ldots\\rangle}\\rangle } } \\left[{\\mathcal{l}}_{y_1 } { \\mathcal{l}}_{y_2 }              \\ldots { \\mathcal{l}}_{y_{s_2 } } v_k \\right ] \\right)^{\\textsc{c } } } \\circ \\varphi^{-1 }        \\ , ,      \\end{gathered}\\ ] ] where we have used equation  . in addition , @xmath403 =        v^{{\\langle { \\langle x_1 : { \\langle x_2 : { \\langle \\ldots                  : { \\langle x_{s } : g_j\\rangle}\\rangle } \\ldots \\rangle}\\rangle } :             { \\langle y_1 : { \\langle y_2 : { \\langle \\ldots                  : { \\langle y_{s_2 } : g_k\\rangle}\\rangle } \\ldots \\rangle}\\rangle}\\rangle } } \\ , ,      \\end{aligned}\\ ] ] where we have used property ( i ) in lemma  [ le : accessory ] .",
    "now , equation   implies that   and   coincide .",
    "therefore , @xmath398 and @xmath399 coincide over @xmath225 , and this concludes the proof of  .",
    "now , one can proceed by taking local coordinates @xmath35 in @xmath3 such that every coordinate function @xmath404 is of the form @xmath405 for a certain @xmath195 and certain vector fields @xmath393 , @xmath230 .",
    "it follows from   that there exists @xmath4 independent vector fields @xmath406 of the form @xmath407 such that @xmath408 . finally , spelling out eq .   for the vector fields @xmath409 and making use of the symmetry of @xmath22 ,",
    "one obtains that the christoffel symbols of the affine connection @xmath102 are precisely given by  , which concludes the result .",
    "in this section , we investigate the gradient analog of the following well - known result for hamiltonian systems : if two minimal hamiltonian systems have the same input - output map , then they are symplectomorphic  @xcite .",
    "we will see how the setting of theorem  [ th : characterization ] also provides sufficient conditions under which a similar result holds for gradient realizations .    in  @xcite",
    ", p. varaiya conjectured that if there exists a state space diffeomorphism between two locally controllable gradient systems , then the diffeomorphism is actually an isometry between the underlying pseudo - riemannian manifolds ( see also  @xcite ) .",
    "subsequently , in  @xcite , j. basto gonalves produced an example of two locally controllable and observable gradient systems living on the same state space with state space diffeomorphism given by the identity mapping , where however the riemannian metrics are different ; thus providing a counterexample to the conjecture by varaiya .",
    "for the sake of completeness , we review it in the following .    [ ex : example ] consider two gradient systems @xmath263 and @xmath264 on @xmath410 with riemannian metrics @xmath411 and @xmath412 given respectively by @xmath413 furthermore , let @xmath263 and @xmath264 have both zero drift vector fields and the same output functions given by @xmath414 from the definition of @xmath411 and @xmath412 , it easily follows that the input vector fields of both systems are the same , i.e. , @xmath415 therefore , @xmath263 and @xmath264 are externally equivalent with state space diffeomorphism given by the identity mapping @xmath416 . however , the metrics @xmath411 and @xmath412 are different , and hence the identity mapping is _ not _ an isometry .",
    "it should also be noted that @xmath263 and @xmath264 are both controllable and observable .",
    "the following result shows that , under the hypotheses of theorem  [ th : characterization ] , a state space diffeomorphism linking two gradient systems is an isometry , _ provided _ the state space diffeomorphism is already known to respect the affine connections determined by their respective pseudo - riemannian metrics . a similar statement",
    "is already contained in  @xcite . here",
    "we make use of an argument given in  @xcite , p.  58",
    "for the case of hamiltonian systems .",
    "[ prop : uniqueness - realization ] let @xmath263 and @xmath264 be two gradient systems with state spaces @xmath417 and @xmath418 , respectively . for @xmath419 , assume that @xmath420 is observable with @xmath421 constant , and that the distribution @xmath422 is full - rank .",
    "furthermore , let @xmath263 and @xmath264 be externally equivalent with the corresponding state space diffeomorphism @xmath423 satisfying @xmath424 then @xmath425 , that is , @xmath426 is an isometry .    by lemmas  [ le : mapping ] and",
    "[ le : mapping - structure ] , the map @xmath427 is the unique diffeomorphism satisfying   for system @xmath420 , @xmath419 .",
    "it is easily checked that since @xmath263 and @xmath264 are externally equivalent with state space diffeomorphism @xmath426 , then their prolongations @xmath428 and @xmath429 are externally equivalent with uniquely determined state space diffeomorphism given by @xmath430 .",
    "furthermore , it can be readily checked that the gradient extensions @xmath431 and @xmath432 are externally equivalent with state space diffeomorphism @xmath433 , _ provided _",
    "@xmath426 satisfies  .",
    "this is because   implies that @xmath434 respects the riemannian extensions @xmath435 and @xmath436 determined , respectively , by the affine connections @xmath437 and @xmath438 .",
    "hence , by the uniqueness of all these state space diffeomorphisms , we obtain the following commutative diagram    ( 2.3,2.3)(-0.7,0 ) ( 0,1.8)(0,0)[c]@xmath439 ( 2.5,1.8)(0,0)[c]@xmath440 ( 0,0)(0,0)[c]@xmath441 ( 2.5,0)(0,0)[c]@xmath442    ( 1.9,0)(-1,0)1.3 ( 0.6,1.8)(1,0)1.3 ( 0,1.4)(0,-1)1 ( 2.5,1.4)(0,-1)1    ( 1.3,2)(0,0)[c]@xmath443 ( 2.75,1)(0,0)[c]@xmath444 ( -0.25,1)(0,0)[c]@xmath445 ( 1.3,-0.2)(0,0)[c]@xmath434    that is , @xmath446 recalling that @xmath427 , @xmath447 , it is readily seen that   is equivalent to @xmath448 that is , @xmath449 is an isometry .",
    "note that in example  [ ex : example ] the torsion - free connections determined by @xmath411 and @xmath412 are _ different _ , and hence the identity map does not respect them .     since eq .",
    "is equivalent to eq .",
    ", one may also conclude that under the conditions of theorem  [ th : characterization ] , the state space diffeomorphism @xmath450 is an isometry if and only if @xmath451 is a state space diffeomorphism between @xmath431 and @xmath432 .",
    "we have discussed necessary and sufficient conditions for a nonlinear control system to be realizable as a gradient control system with respect to a pseudo - riemannian metric .",
    "the results rely on a suitable notion of compatibility of the system with respect to a given affine connection , and on the input - output behavior of the prolonged system and the gradient extension . the symmetric product associated with an affine connection plays a key role in the discussion .",
    "we believe that the developments in this paper do not only give insight in the system - theoretic properties of the physically motivated class of gradient control systems , but also shed light on the differential - geometric properties of gradient and lagrangian control systems .",
    "future work will include the investigation of equivalent characterizations in terms of the input - output behavior of the original nonlinear system .",
    "the first author s work was partially supported by nsf grant cms-0100162 and by the european union training and mobility of researchers program , erb fmrxct-970137 .    99    j. basto gonalves : equivalence of gradient systems .",
    "_ control theory centre report _",
    "84 , university of warwick , uk , 1979 .",
    "j. basto gonalves : equivalencia de sistemas de gradiente . _",
    "_ * 40 * ( 3 ) ( 1981 ) , 263 - 277 .",
    "j. basto gonalves : realization theory for hamiltonian systems .",
    "_ siam j. control optim . _",
    "* 25 * ( 1 ) ( 1987 ) , 63 - 73 .",
    "brayton , j.k .",
    "moser : a theory of nonlinear networks , part i and part ii . _ quart .",
    "_ * 22 * ( 1964 ) , 1 - 33 and 81 - 104 .",
    "brockett , a. rahimi : lie algebras and linear differential equations . in _ ordinary differential equations _ , l. weiss ed . ,",
    "academic press , new york , 1972 .",
    "f. bullo , a.d .",
    "lewis : _ geometric control of simple mechanical systems_. text in applied mathematics series , springer verlag , 2002 , submitted .",
    "do carmo : _",
    "riemannian geometry_. birkhuser , boston - basel - berlin , 1992 .",
    "j. corts , a.j .",
    "van der schaft , p.e .",
    "crouch : gradient realization of nonlinear control systems .",
    "ifac workshop on lagrangian and hamiltonian methods for nonlinear control _",
    ", seville , spain , 2003 , to appear",
    "crouch : geometric structures in systems theory .",
    "d. control theory and applications _ * 128 * ( 5 ) ( 1981 ) , 242 - 252 .",
    "crouch , m. irving : on finite volterra series which admit hamiltonian realizations .",
    "systems theory _ * 17 * ( 1984 ) , 293 - 318 .    p.e . crouch , f. lamnabhi - lagarrigue , a.j .",
    "van der schaft : adjoint and hamiltonian input - output differential equations .",
    "_ ieee trans .",
    "contr . _ * ac-40 * ( 1995 ) , 603 - 615 .",
    "crouch , a.j .",
    "van der schaft : _ variational and hamiltonian control systems_. lectures notes in control and information sciences * 101 * , springer - verlag , new york , 1987 .",
    "r. hermann , a.j .",
    "krener : nonlinear controllability and observability .",
    "_ ieee trans .",
    ". control _ * ac-22 * ( 1977 ) , 728 - 740 .",
    "b. jakubczyk : hamiltonian realizations of nonlinear systems . in _ theory and applications of nonlinear control systems _ , c.i .",
    "byrnes , a. lindquist eds .",
    ", north - holland , 1986 , pp .",
    "261 - 271 .",
    "s. kobayashi , k. nomizu : _ foundations of differential geometry_. interscience tracts in pure and applied mathematics , interscience publishers , wiley , new - york , 1963 .",
    "lewis : affine connections and distributions with applications to nonholonomic mechanics . _",
    "* 42 * ( 1/2 ) ( 1998 ) , 135 - 164 .",
    "lewis , r.m .",
    "murray : configuration controllability of simple mechanical control systems .",
    "_ siam j. control optim . _",
    "* 35 * ( 3 ) ( 1997 ) , 766 - 790 .",
    "patterson , a.g .",
    "walker : riemann extensions . _",
    "quart . j. math .",
    "_ * 3 * ( 1952 ) , 19 - 28 .",
    "santilli : _ foundations of theoretical mechanics i_. springer - verlag , new york , 1978 .",
    "w. sarlet , g. thompson , g.e .",
    "prince : the inverse problem of the calculus of variations : the use of geometrical calculus in douglas s analysis . _ trans .",
    "* 354 * ( 7 ) ( 2002 ) , 2897 - 2919 .",
    "van der schaft : _ system theoretic descriptions of physical systems_. cwi tract , no .",
    "3 , cwi , amsterdam , 1984 .",
    ". van der schaft : linearization of hamiltonian and gradient systems .",
    "_ i m a j. math . contr . & inf .",
    "_ * 1 * ( 1984 ) , 185 - 198 .",
    "p. varaiya : equivalent non - linear networks . in _ siam - ams proceedings iii _ ,",
    "ams , providence , 1971 , pp .",
    "141 - 147 .",
    "verma : equivalence of nonlinear networks . ph.d .",
    "dissertation , university of california , berkeley , 1969 .",
    "willems : dissipative dynamical systems , part ii .",
    "_ arch . rat .",
    "* 45 * ( 1972 ) , 352 - 292 .",
    "k. yano , s. ishihara : _ tangent and cotangent bundles_. marcel dekker , new york , 1973 .",
    "in this appendix we present a simplifying result concerning the compatibility hypothesis in the statement of theorem  [ th : characterization ] . in general , checking conditions ( a ) and ( b ) in the definition of compatibility between the affine connection @xmath102 and the nonlinear system @xmath10 can not be performed for every possible choice of vector fields in @xmath452 and @xmath453 .",
    "the following result shows that it is enough to check the compatibility condition on a basis of vector fields and the corresponding associated functions once we know that the prolongation and the gradient extension of @xmath10 are weakly externally equivalent .",
    "[ le : checkability ] let @xmath102 be a torsion - free affine connection .",
    "assume @xmath10 is observable with @xmath311 constant , and that the distribution @xmath223 is full - rank .",
    "assume the prolongation @xmath98 and the gradient extension @xmath312 of @xmath10 are weakly externally equivalent .",
    "then @xmath10 is compatible with @xmath102 if and only if properties ( a ) and ( b ) are verified by a basis of vector fields in @xmath215 .",
    "let @xmath454 be linearly independent vector fields of the form @xmath455 , @xmath456 .",
    "let @xmath457 denote the function on @xmath3 given by @xmath458 . from equation  , we know that @xmath459 .",
    "assume properties ( a ) and ( b ) in the definition of the compatibility condition ( cf .",
    "definition  [ dfn : compatibility ] ) are verified by any combination of the vector fields @xmath460 and the functions @xmath461 .",
    "let @xmath462 be any element of @xmath215 , and @xmath463 the associated function on @xmath3 .",
    "since @xmath223 is full - rank , we have that @xmath464 .",
    "then , @xmath465 now , let us see that properties ( a ) and ( b ) are naturally verified by all possible choices of vector fields in @xmath215 and generating functions in @xmath192 .",
    "first , @xmath466 \\\\      = \\sum_{i=1}^n f^i_y d v_{r_i } \\left ( \\sum_{j=1}^n f^j_x r_j \\right ) =      \\sum_{i , j=1}^n f^i_y f^j_x d v_{r_j } \\left ( r_i \\right )      = \\sum_{j=1}^n f^j_x d v_{r_j } \\left ( \\sum_{i=1}^n f^i_x r_i \\right )",
    "\\\\      = { \\mathcal{l}}_{{\\langle y_1 : { \\langle y_2 : { \\langle \\ldots              : { \\langle y_{s_2 } : g_k\\rangle}\\rangle}\\ldots\\rangle}\\rangle } } \\left [ { \\mathcal{l}}_{x_1 } { \\mathcal{l}}_{x_2 }        \\ldots { \\mathcal{l}}_{x_{s_1 } } v_j \\right ] \\ , ,    \\end{gathered}\\ ] ] where we have used that condition ( a ) is verified by the vector fields @xmath460 and the functions @xmath461 .",
    "secondly , @xmath467      \\\\      = \\sum_{i=1}^n f^i_{z } dv_{r_i } \\left ( \\sum_{j=1}^n f^j_{{\\langle x : y\\rangle } }        r_j \\right ) = \\sum_{i , j=1}^n f^i_{z } f^j_{{\\langle x : y\\rangle } } dv_{r_j }      \\left ( r_i \\right )      \\\\",
    "= \\sum_{j=1}^n f^j_{{\\langle x : y\\rangle } } dv_{r_j } \\left ( \\sum_{i=1}^n f^i_{z }        r_i \\right ) = < \\sum_{j=1}^n f^j_{{\\langle x : y\\rangle } } dv_{r_j } , z > \\ , .",
    "\\end{gathered}\\ ] ] let us compute the coefficients @xmath468 .",
    "we have @xmath469 r_j + f^j_y r_j        [ f^i_x ] r_i \\right ) \\\\      = \\sum_{k=1}^n \\left ( \\sum_{i , j=1}^n f^i_x f^j_y f_{{\\langle r_i : r_j\\rangle}}^k        + \\sum_{i=1}^n f^i_x r_i [ f^k_y ] + \\sum_{j=1}^n f^j_y r_j [ f^k_x ]      \\right ) r_k \\ , .",
    "\\end{gathered}\\ ] ] now , note that @xmath470 using condition ( a ) for the vector fields @xmath460 and the functions @xmath461 .",
    "moreover , using condition ( b ) , @xmath471 ) , r_l>$ ] . hence , @xmath472)$ ] . on the other hand , @xmath473 dv_{r_k }",
    "= f^i_x < df^k_y , r_i > dv_{r_k } \\\\      = f^i_x < dv_{r_k } , r_i > df^k_y + f^i_x",
    "\\left ( df^k_y \\wedge dv_{r_k }      \\right ) ( r_i,\\cdot )    \\end{gathered}\\ ] ] since @xmath474 , we have @xmath475 dv_{r_k } = f^i_x < dv_{r_k } , r_i > df^k_y \\ , .\\ ] ] analogously , one can see that @xmath476 dv_{r_k } = f^j_y    < dv_{r_k } , r_j > df^k_x$ ] . finally , @xmath477 + \\sum_{j=1}^n f^j_y r_j [ f^k_x ] \\right ) dv_{r_k }      \\\\      = \\sum_{i , j=1}^n f^i_x f^j_y d ( dv_{r_i } [ r_j ] ) + \\sum_{i , j=1}^n f^i_x      < dv_{r_j } , r_i >",
    "df^j_y + \\sum_{i , j=1}^n f^j_y < dv_{r_i } , r_j > df^i_x      \\\\",
    "= d \\left ( \\sum_{i , j=1}^n f^i_{x } f^j_{y } dv_{r_i } [ r_j ] \\right ) = d      ( { \\mathcal{l}}_y \\left [ v_{x } \\right ] ) \\ , .    \\end{gathered}\\ ] ] plugging this equality in  , we get the desired result ."
  ],
  "abstract_text": [
    "<S> we investigate necessary and sufficient conditions under which a general nonlinear affine control system with outputs can be written as a gradient control system corresponding to some pseudo - riemannian metric defined on the state space . </S>",
    "<S> the results rely on a suitable notion of compatibility of the system with respect to a given affine connection , and on the output behavior of the prolonged system and the gradient extension . the symmetric product associated with an affine connection plays a key role in the discussion .    </S>",
    "<S> gradient control systems , symmetric product , prolongation and gradient extension of a nonlinear system , externally equivalent systems .    93c10 , 93b29 , 53b05 , 93b15 </S>"
  ]
}