{
  "article_text": [
    "a major challenge of the theory of strongly correlated lattice - fermion models is to predict the real - time dynamics of local observables on a long time scale .",
    "@xcite using exact - diagonalization techniques , i.e. , full diagonalization or krylov - space methods , @xcite only lattices with a small number of sites can be addressed such that artificial boundary effects start to dominate the dynamics after a few elementary hopping processes .",
    "much larger systems are in principle accessible by means of quantum monte - carlo methods .",
    "@xcite while there has been substantial progress in the recent past , the sign ( or complex phase ) problem still prevents a computationally efficient simulation including also those models and parameter regimes which are known as sign - problem - free at thermal equilibrium .",
    "one - dimensional or impurity systems represent a notable exception . here , recent extensions of the numerical renormalization group @xcite and of the density - matrix renormalization group @xcite to the time domain have been shown to be highly efficient and accurate .    for lattice models in two or higher dimensions , on the other hand",
    ", one has to resort to approximations , e.g.  to weak - coupling perturbation theory .",
    "naive perturbative techniques , however , usually violate the macroscopic conservation laws that result from the continuous symmetries of the lattice - fermion model .",
    "as has been shown by baym and kadanoff , @xcite `` conserving approximations '' can be constructed diagrammatically by deriving the self - energy from a ( truncated ) luttinger - ward functional @xcite involving , e.g. , certain re - summations of diagram classes , and by calculating the single - particle green s function self - consistently . due to the necessary truncation of the @xmath0 functional ,",
    "however , such conserving approximations are necessarily restricted to the weak - coupling limit .",
    "@xcite    nonperturbative conserving approximations can be constructed within the framework of the nonequilibrium generalization @xcite of self - energy - functional theory ( sft ) .",
    "@xcite here , the green s function is self - consistently obtained from an optimal self - energy which makes the grand potential of the initial thermal state , expressed as a functional of the nonequilibrium self - energy , stationary .",
    "the equilibrium sft comprises different approximations , such as the variational cluster approximation @xcite and the dynamical impurity approximation .",
    "@xcite these techniques have been extended to real - time dynamics and have been applied recently to study the dynamical mott transition @xcite in the hubbard model @xcite and a variant of the periodic anderson model .",
    "another nonperturbative conserving approach , which can be derived within the sft framework but has actually been proposed much earlier , is the ( nonequilibrium ) dynamical mean - field theory .",
    "@xcite being the exact theory in the limit of infinite spatial dimensions , conservation laws are naturally satisfied in this case .",
    "first cluster extensions of the dmft have been reported as well .",
    "@xcite those combine the mean - field concept with an improved description of spatial correlations .",
    "the nonequilibrium extension @xcite of cluster - perturbation theory ( cpt ) @xcite is a strongly simplified variant of a cluster - embedding approach .",
    "still , the numerical solution of the basic cpt equation is complicated by the presence of memory effects which are encoded in real - time green s functions within the keldysh formalism .",
    "this is very similar to the nonequilibrium dyson or kadanoff - baym equations in other diagrammatic approaches .",
    "as has been shown recently , @xcite however , the problem can be mapped exactly onto a noninteracting problem with additional auxiliary degrees of freedom .",
    "adopting this idea , we could demonstrate @xcite that the cpt real - time dynamics can be understood as a simple markovian dynamics of a system of noninteracting fermions but in a much larger time - dependent bath of virtual degrees of freedom . using this reformulation of the cpt",
    ", it has been possible to formally study the real - time dynamics of an inhomogeneous setup in the two - dimensional hubbard model consisting of @xmath1 sites up to times of the order of @xmath2 where the inverse nearest - neighbor hopping serves a the time unit .",
    "those plain cpt calculations , however , suffer from a couple of conceptual problems .",
    "the drawback of _ any _ mean - field theory is the missing feedback of certain correlations on the dynamics of the observables of interest , such as , e.g. , the missing feedback of nonlocal spatial correlations on the local self - energy in the case of the dmft . in the case of plain cpt ,",
    "the situation is even worse as there is no feedback at all .",
    "in particular , plain cpt calculations can not be expected to respect the macroscopic conservation laws emerging from the symmetries of the underlying hamiltonian .",
    "this can be traced back to the fact that the plain cpt does not contain any element of self - consistency .",
    "therefore , it is not surprising that a violation of , e.g. , total - energy conservation has been observed .",
    "@xcite    with the present study we give a proof of principle that this drawback can be overcome .",
    "we make use of the fact that the cpt can be viewed as an all - order perturbation theory @xcite in the inter - cluster hopping around a system of decoupled clusters , where the starting point , i.e. , the intra - cluster hamiltonian , is not at all predetermined .",
    "the idea is to formulate the macroscopic conservation laws as local continuity equations on the discrete lattice in terms of the single - particle green s function .",
    "these equations are then used as local conditional equations to fix the intra - cluster one - particle parameters and thereby to optimize the starting point for the cluster - perturbation expansion .",
    "this defines a novel `` conserving cluster - perturbation theory . ''",
    "the theory is conserving by construction , it is nonperturbative , and in principle controlled by the inverse cluster size as a small parameter . in practice , however , the accessible cluster size is limited by the exponential growth of the cluster hilbert space . hence , conserving cpt must be seen as a typical cluster mean - field theory which correctly accounts for nonlocal correlations up to the linear scale of the cluster .",
    "opposed to standard mean - field theories , the `` mean - field '' or the renormalization of the one - particle parameters is organized by continuity equations , i.e. , it is finally the symmetries of the lattice model which dictates the time - dependent cluster embedding .",
    "as the theory relies on _ local _ self - consistency or conditional equations , it can easily be extended to inhomogeneous models or initial states .",
    "while the underlying idea is conceptually simple , its practical realization requires a couple of new theoretical concepts which are discussed here in detail .",
    "in particular , the implementation of a causal time - stepping algorithm requires a careful analysis to which order the renormalization of the intra - cluster parameters at a certain time slice enters the conditional equations .",
    "we are able to demonstrate that an efficient numerical implementation of the theory is possible and discuss first results for weak interaction quenches in a two - dimensional hubbard model .",
    "the algorithm scales linearly with the propagation time and exponentially in the cluster size .",
    "conservation laws are satisfied with numerical accuracy . yet",
    ", long time scales can not be achieved with the present implementation due to singular points which are found to evolve during the time propagation .",
    "the next section briefly states the model and the necessary elements of the keldysh formalism .",
    "section [ sec : prep ] introduces the cpt and discusses the formulation of the continuity equations .",
    "the mapping onto a noninteracting auxiliary problem is described in sec .",
    "[ sec : hamiltonian_based ] .",
    "the main theoretical work addressing the solution of the continuity equations is presented in sec .",
    "[ sec : solve_for_lambda ] .",
    "numerical results are discussed in sec .",
    "[ sec : num ] , and the conclusions are summarized in sec.[sec : con ] .",
    "we consider the single - band , fermionic hubbard model on an arbitrary lattice with a time - dependent hopping matrix @xmath3 and interaction strength @xmath4 .",
    "the hopping is assumed as spin - diagonal for simplicity .",
    "the hamiltonian reads @xmath5 where the operators @xmath6 ( @xmath7 ) create ( annihilate ) a fermion with spin @xmath8 at site @xmath9 ( @xmath10 ) , and where @xmath11 denotes the spin - dependent local density operator . at time @xmath12 , the system is assumed to be in thermal equilibrium with inverse temperature @xmath13 and chemical potential @xmath14 .",
    "nonequilibrium real - time dynamics for @xmath15 is initiated by the time dependence of the hopping matrix or the interaction strength . in principle , this covers challenging experimental setups such as time - resolved photoemission spectroscopy@xcite or experiments with ultracold gases in optical lattices.@xcite    our central quantity of interest is the one - particle green s function which is defined as @xmath16_{ij\\sigma}(t , t ' )     & =       -i{\\ensuremath{\\langle { { \\ensuremath{\\mathcal{t}_c}}\\,{\\ensuremath{\\hat{c}_{i\\sigma}}}(t){\\ensuremath{\\hat{c}^\\dagger_{j\\sigma}}}(t ' ) } \\rangle}}_{h_{t , u } } \\\\    & \\equiv    \\frac{-i}{z }    { \\ensuremath{\\mathrm{tr}\\left ( {      { \\ensuremath{\\mathrm{exp}\\left ( {      -\\beta h_{t , u}(0 )      } \\right ) } }      \\left [        { \\ensuremath{\\mathcal{t}_c}}\\,{\\ensuremath{\\hat{c}_{i\\sigma}}}(t){\\ensuremath{\\hat{c}^\\dagger_{j\\sigma}}}(t ' )      \\right ]    } \\right)}}.\\nonumber\\end{aligned}\\ ] ] here `` @xmath17 '' traces over the fock space , i.e. , we take averages using the grand - canonical ensemble . defines the grand - canonical partition function and @xmath18 the time - ordering operator on the keldysh - matsubara contour @xmath19 . the time variables @xmath20 and @xmath21 are thus understood as contour times .",
    "an in - depth introduction to the keldysh formalism @xcite can be found in refs . , . throughout the text we use the convention that operators with a hat carry a time dependence according to the heisenberg picture , i.e. ,  @xmath22 , where @xmath23 , for @xmath24 , is the system s time - evolution operator and @xmath25 the time - ordering operator .",
    "the dependence of the green s function on @xmath3 and @xmath4 is made explicit in the notation using subscripts , i.e. , @xmath26 , where convenient .",
    "a similar notation is also used for other quantities .    through dyson s equation , the green s function",
    "is linked to the self - energy @xmath27 where @xmath28 is the noninteracting propagator .",
    "its ( contour ) inverse is @xmath29_{ij\\sigma}(t , t ' )                  = \\left [                   \\delta_{ij}(i\\partial_t + \\mu ) - t_{ij\\sigma}(t ) )                   \\right]\\delta_c(t , t').\\ ] ] in eq .",
    "( [ eq : dyson ] ) we made use of the shorthand notation `` @xmath30 '' for the convolution of contour matrices .",
    "in particular @xmath31_{ij\\sigma}(t , t ' )    =    \\int_c { \\ensuremath{\\mathrm{d}t}}_1     \\sum_{l }    [ \\sigma_{t , u}]_{il\\sigma}(t , t_1)[g_{t , u}]_{lj\\sigma}(t_1 , t ' ) .\\ ] ] note that in this context we implicitly assume a contour dirac delta function @xmath32 present in case of time - local quantities .",
    "for example , @xmath3 should be replaced by @xmath33 in a contour convolution , so that @xmath34_{ij\\sigma}(t , t ' )    & =    \\int_c { \\ensuremath{\\mathrm{d}t}}_1     \\sum_{l }    t_{il\\sigma}(t)\\delta_c(t , t_1)[g_{t , u}]_{lj\\sigma}(t_1 , t ' )    \\nonumber\\\\    & =    \\sum_{l}t_{il\\sigma}(t)[g_{t , u}]_{lj\\sigma}(t , t').\\end{aligned}\\ ] ]    combining dyson s equation with the equation of motion for the one - particle green s function , we get @xmath35_{ij\\sigma}(t , t ' )    = -i u(t ) [ g_{t , u}^{(2l)}]_{ij\\sigma}(t , t'),\\ ] ] where @xmath36 is the two - particle green s function @xmath37_{ij\\sigma}(t , t ' )     =     { \\ensuremath{\\langle {      \\mathcal{t}_c\\,\\hat{n}_{i\\bar\\sigma}(t){\\ensuremath{\\hat{c}_{i\\sigma}}}(t){\\ensuremath{\\hat{c}^\\dagger_{j\\sigma}}}(t ' )    } \\rangle } } , \\ ] ] and where @xmath38 indicates a flip of the spin index @xmath39 , i.e. , @xmath40 and vice versa .",
    "analogously to eq .",
    ", we furthermore have @xmath41_{ij\\sigma}(t , t ' ) u(t ' )    =    [ g_{t , u } \\circ \\sigma_{t , u}]_{ij\\sigma}(t , t'),\\end{aligned}\\ ] ] where @xmath42 is defined as @xmath43_{ij\\sigma}(t , t ' )     =     { \\ensuremath{\\langle {      \\mathcal{t}_c\\,{\\ensuremath{\\hat{c}_{i\\sigma}}}(t)\\hat{n}_{j\\bar\\sigma}(t'){\\ensuremath{\\hat{c}^\\dagger_{j\\sigma}}}(t ' )    } \\rangle}}.\\ ] ] the local doublon density @xmath44 can be expressed through the two - particle green s functions as @xmath45_{ii\\sigma}(t , t^+ )     =     -[g^{(2r)}_{t , u}]_{ii\\sigma'}(t , t^+),\\nonumber\\end{aligned}\\ ] ] with @xmath46 being infinitesimally `` later '' than @xmath20 in the sense of time ordering on the keldysh - matsubara contour .",
    "to enforce conservation laws within cluster perturbation theory ( cpt ) , we proceed in two steps .",
    "first , we like to emphasize that the cpt approach is not unique and that there are free parameters at one s disposal .",
    "second , we suggest to employ continuity equations expressing the conservation laws , resulting from continuous symmetries of the hubbard model , as conditional equations to fix these parameters . we start with a discussion of the main idea of the cpt and of the continuity equations of the local spin and doublon density .",
    "the idea of the cpt @xcite is to partition the lattice into clusters small enough to be treated exactly , e.g. , using krylov - space methods or full diagonalization , and to subsequently include the connections between the clusters perturbatively . on the level of the hamiltonian",
    "one starts by partitioning the full hopping matrix @xmath47 into the intra - cluster hopping @xmath48 and the inter - cluster hopping @xmath49 so that @xmath48 only contains terms which connect lattice sites within the individual clusters , while @xmath49 contains all remaining terms such that @xmath50 , see fig .",
    "[ fig : cpt_vs_optcpt ] .",
    "corresponding to the intra - cluster hopping , we define a cluster hamiltonian @xmath51 which describes the system of isolated clusters , also referred to as the reference system .",
    "its green s function and self - energy are denoted as @xmath52 and @xmath53 , respectively .    for the equilibrium as well as for the nonequilibrium case , @xcite the cpt can be seen as an all - order perturbation theory in the inter - cluster hopping @xmath49 which provides the one - particle green s function of the original system by expanding around the cluster green s function : @xmath54 we also have : @xmath55 in the noninteracting case , this is exact since @xmath56 . for finite @xmath4",
    ", however , the cpt green s function @xmath57 represents an approximation of the exact green s function @xmath26 .",
    "is decomposed @xmath50 into the intra - cluster ( @xmath48 ) and the inter - cluster hopping @xmath49 .",
    "the problem defined by @xmath48 ( and the local hubbard - type interaction ) is solved exactly .",
    "@xmath49 is treated by all - order perturbation theory ( neglecting vertex corrections ) , see eq .",
    "( [ eq : cptdyson ] ) . _ conserving cpt : _ the same as plain cpt but with `` renormalized '' intra- ( @xmath58 ) and inter - cluster hopping @xmath59 , where the time - dependent renormalization @xmath60 ( indicated in red ) is used to enforce conservation laws .",
    "note that @xmath60 may also comprise the on - site energies .",
    ", scaledwidth=40.0% ]    a closer look reveals that the cpt is not unique since one may consider a different starting point for the all - order perturbation theory in @xmath49 . to this end , consider a starting point with a renormalized intra - cluster hopping , @xmath61 , resulting in a renormalized cluster green s function @xmath62 and self - energy @xmath63 .",
    "correspondingly , also the inter - cluster hopping @xmath49 must be renormalized as @xmath64 .",
    "summation of the geometrical series yields @xmath65    =     \\frac{1}{g_{t'-\\lambda , u}^{-1}-(v+\\lambda ) }    =     \\frac{1}{g_{t,0}^{-1}-\\sigma_{t ' - \\lambda , u}},\\end{aligned}\\ ] ] where we emphasized the special role of the renormalization parameter @xmath60 by square brackets . for @xmath66",
    ", we have @xmath67 = g_{t,0}$ ] for any @xmath60 . for an interacting system ,",
    "however , the choice for @xmath60 is crucial , i.e. , the resulting cpt green s function does depend on the starting point of the all - order perturbation theory in the inter - cluster hopping .",
    "this ambiguity in the definition of the cpt seems to be problematic on first sight , yet it can be turned into an advantage by interpreting the renormalization @xmath60 as an optimization parameter .",
    "this has been worked out systematically in the context of the ( nonequilibrium ) self - energy functional theory ( sft ) , @xcite where the optimal @xmath60 is derived from a variational principle based on the self - energy . here",
    ", we will take a different route and use the freedom in @xmath60 to enforce the continuity equations for spin and doublon density .      while conservation laws like particle - number or energy conservation are naturally fulfilled",
    "if one is able to treat a physical problem exactly , this is not necessarily the case when working with approximate methods . for greens - function - based methods",
    "it was shown by baym and kadanoff @xcite that respecting certain symmetry relations for the two - particle green s function is sufficient to ensure that an approximation is conserving .    to discuss the continuity equations , we consider the exact time evolution of a system described by the hubbard hamiltonian @xmath68 . to keep the notations simple ,",
    "we write @xmath69 , @xmath70 and @xmath70 in this subsection .",
    "the time evolution of the system will preserve the total particle number and the @xmath71-component of the total spin which can be traced back to the local continuity equation of the spin - dependent density @xmath72_{ii\\sigma}(t ,",
    "t^+),\\nonumber\\\\    \\leftrightarrow\\quad    f_{i\\sigma}(t )    & \\equiv     g^{(2l)}_{ii\\sigma}(t , t^+ ) - g^{(2r)}_{ii\\sigma}(t , t^+ ) = 0 .",
    "\\label{eq : con_dens}\\end{aligned}\\ ] ] it can be verified directly using eq .  .",
    "similarly , the doublon density is subject to a continuity equation @xmath73\\\\    &    -    2\\sum_{j\\sigma }    \\left [      t_{ij\\sigma}(t)g^{(2r)}_{ji\\sigma}(t , t^+ )      -      g^{(2l)}_{ij\\sigma}(t , t^+)t_{ji\\sigma}(t )    \\right ] = 0.\\nonumber\\end{aligned}\\ ] ] assuming @xmath74 holds as well , eq .",
    "ensures that the doublon density can be derived consistently from each spin component of either @xmath36 or @xmath42 , see eq .  .",
    "furthermore , in case of a time - independent hamiltonian , i.e. , @xmath75 for @xmath76 , eq .   ( [ eq : con_energy ] ) implies total - energy conservation . a formal derivation of eq .",
    "can be found in ref .   and",
    "is also carried out in the appendix [ ap : con_double_occ ] .    to enforce conservation laws within the cpt",
    ", we simply reverse the previous argumentation : if a greens - function - based approximation fulfills @xmath74 and @xmath77 , then it will consequently respect particle - number , spin and energy conservation . finding a renormalization @xmath78 that enforces both equations within",
    "the cpt is the main goal of this paper .",
    "in the last section we have introduced the cpt in its usual form , i.e. , based on the self - energy @xmath79 of the reference system and dyson s equation . a major drawback of this approach is its limitation for the maximum propagation time that can be reached in a practical numerical calculation .",
    "this is due to the fact that the cpt green s function and the self - energy of the reference system are nonlocal in time through their dependence on two contour times . the necessary storage for these quantities scales quadratically with the maximum propagation time , the effort for solving dyson s equation scales cubically .",
    "this intrinsic limitation can be overcome if a so - called lehmann representation of the self - energy is available .",
    "this allows us to solve the dyson equation by means of a markovian propagation scheme which permits to reach much longer time scales .",
    "@xcite in the following , we consider this lehmann representation of the self - energy as given .",
    "its existence for an arbitrary , fermionic lattice system out of equilibrium has been shown in ref .   where also a constructive numerical scheme has been presented .",
    "it can be used in case of small clusters accessible to exact - diagonalization techniques . in the following we briefly recall the main results and then discuss the application to conservation laws and the respective continuity equations .",
    "the nonequilibrium self - energy @xmath80 of any lattice - fermion model has a unique lehmann representation : @xcite @xmath81 here , @xmath82 is the time - local hartree - fock term .",
    "the second term has a hybridization - function - like structure @xcite where @xmath83 denotes the hopping between a physical site @xmath9 and an additional _ virtual _ site labeled by the index @xmath84 .",
    "the time - independent on - site energy of the virtual site is given by @xmath85 .",
    "furthermore , @xmath86 is the noninteracting green s function of an isolated one - particle mode ( @xmath87 ) with excitation energy @xmath88 : @xmath89 e^{-i\\epsilon(t - t')}.\\ ] ] here , @xmath90 denotes the fermi - function , and @xmath91 refers to the contour variant of the heaviside step function , i.e. , @xmath92 for @xmath93 , and @xmath94 otherwise .",
    ", the elements @xmath95 of the physical sector and the time - independent elements @xmath96 of the virtual sector . , scaledwidth=45.0% ]    the hybridization - function - like structure is the immediate and important advantage of the lehmann representation .",
    "it allows to write down an effective , noninteracting model specified by the hamiltonian @xmath97 which reproduces the one - particle green s function @xmath69 _ exactly _ when evaluated at the physical sites @xmath98 .",
    "we emphasize that @xmath99 includes all correlation effects through the hybridization strengths @xmath83 and on - site energies @xmath100 of the virtual sites .",
    "furthermore , the previously mentioned interpretation of the @xmath84-degrees of freedom as additional virtual sites becomes obvious in eq .  .",
    "their total number is the limiting factor in a numerical calculation as it grows exponentially in system size .",
    "@xcite    for clarity , we use the following convention throughout the paper : @xmath101 defining @xmath102 , the effective hamiltonian can be written as ( cf .  fig .",
    "[ fig : hcpt ] ) @xmath103 the corresponding green s function is given on the physical but also on the virtual sites , @xmath104 so that the original , physical green s function @xmath105 is obtained if we restrict @xmath106 to physical sites only , i.e. , @xmath107 .",
    "many - particle correlation functions , e.g. , spin - spin correlations , are in general not accessible from the effective hamiltonian .",
    "there is , however , one important exception .",
    "namely , the two - particle green s functions @xmath36 and @xmath42 can be expressed as contour convolutions of the system s self - energy with the green s function , cf .",
    "eqs .   and .",
    "in the hamiltonian - based formalism this convolution is greatly simplified and becomes a straightforward matrix multiplication . by comparing dyson s equation with the equation of motion that follows from eq .",
    ", one readily finds the identity @xmath108_{ij\\sigma}(t , t ' )    =    & \\sum_{l }    \\left [      h_{il\\sigma}(t)-t_{il\\sigma}(t ) + \\delta_{il}\\mu    \\right ]    g_{lj\\sigma}(t , t ' ) \\nonumber\\\\    & +    \\sum_s h_{is\\sigma}(t ) g_{sj\\sigma}(t , t').\\end{aligned}\\ ] ] an analogous relation can be derived for @xmath109 .",
    "the result can be written in a more compact form by defining a new quantity @xmath110 via @xmath111 and @xmath112 .",
    "this is consistent with the alternative definition given in appendix [ ap : math_eff ] which also holds for @xmath66 . in the physical sector",
    "it implies @xmath113 as follows from @xmath114 [ cf .",
    "eqs . , and ] . with this definition for @xmath115 and with the relations @xmath116 and @xmath117 we get @xmath118 recall at this point that quantities like @xmath119 or @xmath120 ( as well as @xmath99 , @xmath36 , etc . ) are functionals of @xmath47 and @xmath121 .",
    "let us now discuss how the cpt green s function can be obtained from an effective one - particle hamiltonian and how to set up a markovian time - propagation scheme .",
    "@xcite as discussed in sec .",
    "[ sec : cpt ] , we have @xmath50 where @xmath122 is the renormalized intra - cluster and @xmath123 the renormalized inter - cluster hopping . for each set of parameters @xmath60 ,",
    "an effective one - particle cpt hamiltonian can be defined by adding the inter - cluster hopping to the effective hamiltonian of the reference system : @xmath124(t )     & =    h^\\mathrm{eff}_{t ' - \\lambda , u}(t )    +     \\sum_{ij\\sigma } [ v_{ij\\sigma}(t ) + \\lambda_{ij\\sigma}(t ) ]    { \\ensuremath{c^\\dagger_{i\\sigma}}}{\\ensuremath{c_{j\\sigma}}}\\nonumber\\\\    & \\equiv     \\sum_{xy\\sigma } h^\\text{cpt}_{xy\\sigma}(t ) { \\ensuremath{c^\\dagger_{x\\sigma}}}{\\ensuremath{c_{y\\sigma}}}.\\end{aligned}\\ ] ] the cpt green s function , as computed from @xmath125(t)$ ] , @xmath126_{xy\\sigma}(t , t ' )    =    -i{\\ensuremath{\\langle {    { \\ensuremath{\\mathcal{t}_c}}{\\ensuremath{\\hat{c}_{x\\sigma}}}(t){\\ensuremath{\\hat{c}^\\dagger_{y\\sigma}}}(t ' )    } \\rangle}}_{h^\\text{cpt}[\\lambda]}\\ ] ] then coincides with the original definition in eq .",
    "if only the physical sector is considered , i.e. , @xmath127 .",
    "this can be verified easily by integrating out the virtual , @xmath84 degrees of freedom from @xmath128 .",
    "reflects the freedom we have in the cpt construction as the @xmath60-terms cancel in the physical sector .",
    "@xmath60 only enters implicitly through the hybridization strengths @xmath129 , through the on - site energies @xmath130 ( where @xmath131 ) and through the hartree - fock term @xmath132 of the reference system s hamiltonian @xmath133 .    for each set of parameters @xmath60 ,",
    "the two - particle correlation function @xmath36 is approximated within the context of the cpt as @xmath134_{ij\\sigma}(t , t ' )     & =     i\\sum_x     \\eta'[\\lambda]_{ix\\sigma}(t )    g^\\text{cpt}[\\lambda]_{xj\\sigma}(t , t ' ) , \\end{aligned}\\ ] ] where we have defined @xmath135\\equiv \\eta_{t'-\\lambda , u } .\\ ] ] eq .",
    "( [ eq : g2lcpt ] ) corresponds to the exact expression given by eq.([eq : g2l_hambased ] ) .",
    "@xmath136 $ ] is defined analogously , and thus the symmetry relation @xmath137_{ji\\sigma}(t , t^+ )     =     \\left[g^{(2l)}[\\lambda]_{ij\\sigma}(t , t^+)\\right]^*\\ ] ] is ensured within the cpt independently of @xmath60 . note that this symmetry is not sufficient to allow for an unambiguous definition of the doublon density based on @xmath36 and @xmath42 [ cf .",
    "instead , it requires both continuity equations to be fulfilled as discussed in sec .",
    "[ sec : con_eqs ] . in case of an arbitrary",
    ", non - conserving set of parameters @xmath60 this ambiguity needs to be circumvented by defining the doublon density as an average @xmath138(t )     =     -\\frac{1}{4 }    \\sum_\\sigma    \\left [      g^{(2l)}[\\lambda]_{ii\\sigma}(t , t^+ )       +      g^{(2l)}[\\lambda]_{ii\\sigma}(t , t^+ )     \\right].\\ ] ] for @xmath139 , however , we have @xmath140(t )     =     -g^{(2l)}[\\lambda^\\text{opt}]_{ii\\sigma}(t , t^+ )     =    - g^{(2r)}[\\lambda^\\text{opt}]_{ii\\sigma'}(t , t^+).\\ ] ] the final forms of the conditional equations for @xmath141 are obtained by replacing @xmath42 and @xmath36 by their cpt approximations @xmath142 $ ] and @xmath136 $ ] in the expressions for @xmath143 and @xmath19 given by eqs .   and : @xmath144_{i\\sigma}(t )    \\stackrel{!}{= }    0 ,",
    "\\quad    c[\\lambda^\\text{opt}]_{i\\sigma}(t )    \\stackrel{!}{= }    0.\\ ] ]",
    "having formulated the self - consistency conditions ( [ eq : selfcon_cpt ] ) using the hamiltonian - based formalism , it remains to explicitly solve these equations for @xmath141 . to this end",
    "it is helpful to first analyze in which order a variation @xmath145 actually shows up in our equations .",
    "since the cpt is by construction a causal theory , it is possible to construct a time - propagation scheme that allows to determine @xmath146 step by step on the time axis .",
    "it is thus sufficient to consider _ time - local _ variations only .",
    "assume that we have found the optimal renormalization @xmath146 for @xmath147 .",
    "we introduce a variation @xmath148 which affects the current ( the @xmath149-th ) time step only : @xmath150},\\\\        0 \\,\\,\\,\\ , & \\text{else}.      \\end{aligned }    \\right.\\ ] ] for simplicity , we require the variations to be symmetric , i.e. , @xmath151 . this implies a restriction to symmetric solutions @xmath141 .",
    "consider now an arbitrary , causal functional @xmath152(t)$ ] , i.e. , a functional that at time @xmath20 only depends on @xmath153 with @xmath154 .",
    "for such an object , the variational operator @xmath148 is related to the conventional functional derivative through @xmath155(t )     & =    \\sum_{\\sigma}\\sum_{i \\ge j }    \\int_{t_n}^t { \\ensuremath{\\mathrm{d}t } } '    \\frac{\\delta m[\\lambda](t)}{\\delta \\lambda_{ij\\sigma}(t ' ) }    \\delta\\lambda_{ij\\sigma}(t'),\\end{aligned}\\ ] ] where the restriction @xmath156 is necessary because of the symmetry requirement @xmath157 .",
    "we now take the combined limit @xmath158 such that we always have @xmath159 $ ] to define the time - local variation @xmath160 in the continuum limit @xmath161(t )    & =     \\lim_{\\substack{\\delta t \\rightarrow 0 \\\\ n\\rightarrow \\infty } }    { \\ensuremath{\\delta_\\mathrm{loc}}}^n m[\\lambda](t),\\end{aligned}\\ ] ] with the corresponding variational quotient @xmath162(t)}{{\\ensuremath{\\delta_\\mathrm{loc}}}\\lambda_{ij\\sigma}(t ) }    \\equiv    \\lim_{\\substack{\\delta t \\rightarrow 0 \\\\",
    "n\\rightarrow \\infty } }    \\int_{t_n}^t { \\ensuremath{\\mathrm{d}t } } '    \\frac{\\delta m[\\lambda](t)}{\\delta \\lambda_{ij\\sigma}(t')}.\\end{aligned}\\ ] ] this variational quotient describes the linear response of @xmath152(t)$ ] when varying the parameters at the latest time step : @xmath161(t )    =    \\sum_{\\sigma}\\sum_{i \\ge j }    \\frac{{\\ensuremath{\\delta_\\mathrm{loc}}}m[\\lambda](t)}{{\\ensuremath{\\delta_\\mathrm{loc}}}\\lambda_{ij\\sigma}(t ) }    \\delta\\lambda_{ij\\sigma}(t).\\end{aligned}\\ ] ]      with the appropriate variation for our purposes at hand , we can study the effect of the variation on the main quantities within the cpt framework .",
    "we first consider the time - evolution operator ( `` propagator '' ) of the reference system @xmath163\\equiv \\mathcal{u}_{t'-\\lambda , u}$ ] .",
    "it is instructive to study the effect of the operator @xmath148 first , i.e. , the effect of a time - local variation with finite time step @xmath164 .",
    "keeping only terms of the order @xmath165 one finds @xmath166(t,0 )    & =     -i",
    "\\left [      \\sum_{ij\\sigma }       \\int_{t_n}^{t }      \\delta\\lambda_{ij\\sigma}(t ' ) { \\ensuremath{\\hat{c}^\\dagger_{i\\sigma}}}{\\ensuremath{\\hat{c}_{j\\sigma } } } { \\ensuremath{\\mathrm{d}t } } '    \\right ]    \\mathcal{u}'[\\lambda](t_n,0)\\nonumber\\\\    & \\phantom{=}\\,\\,+     o(\\delta t^2 ) .",
    "\\label{eq : du_vanishes}\\end{aligned}\\ ] ] in lowest order we thus have @xmath167 .",
    "this means that the linear response vanishes identically in the limit @xmath168 .",
    "this property originates from the fact that @xmath169 is integrated over time within the propagator @xmath170 , and that the contribution of a single time step , @xmath159 $ ] , to this integral is of zero measure in the limit @xmath168 .",
    "a finite time - local variation is obtained for the first time derivative of the propagator rather than for the propagator itself .",
    "namely , the corresponding time - local variational quotient remains non - zero in the continuum limit : @xmath171(t ) ] }    { { \\ensuremath{\\delta_\\mathrm{loc}}}\\lambda_{ij\\sigma}(t ) }    =     -    \\bigl [      { \\ensuremath{c^\\dagger_{j\\sigma}}}{\\ensuremath{c_{i\\sigma } } }       +       { \\ensuremath{c^\\dagger_{i\\sigma}}}{\\ensuremath{c_{j\\sigma } } }       -      \\delta_{ij}{\\ensuremath{c^\\dagger_{i\\sigma}}}{\\ensuremath{c_{i\\sigma } } }    \\bigr ]    \\mathcal{u}'[\\lambda](t,0).\\ ] ] multiplying this equation with @xmath172 , summing over @xmath173 and comparing with the standard equation of motion @xmath174(t,0 ) = h_{t ' - \\lambda , u}(t ) \\mathcal{u}'[\\lambda](t,0)$ ] , shows that the time derivative of the propagator is of the general form @xmath175(t,0 )    =    \\sum_\\sigma\\sum_{i\\ge j }    \\frac{{\\ensuremath{\\delta_\\mathrm{loc}}}[i\\partial_t \\mathcal{u}'[\\lambda ] ] }    { \\delta_\\mathrm{loc}\\lambda_{ij\\sigma}(t ) }    \\lambda_{ij\\sigma}(t )    +    \\xi_{\\mathcal{u}'}[\\lambda](t),\\ ] ] where @xmath176(t ) = h_{t ' , u}(t ) \\mathcal{u}'[\\lambda](t,0)$ ] .    with this definition and with eq .  , it is obvious that the variational derivative and @xmath176(t)$ ] on the right - hand side of eq .",
    "( [ eq : du_form ] ) depend on @xmath169 only through an integration over time within the propagator @xmath163(t,0)$ ]",
    ". we will call such quantities _ integrated _ quantities in @xmath60 .",
    "integrated quantities in @xmath60 inherit an important property from the cluster propagator @xmath163 $ ] , see eq .  :",
    "their time - local variation vanishes in the limit @xmath168 .",
    "furthermore , the time derivative of any quantity @xmath152 $ ] that is integrated in @xmath60 , i.e. , the time derivative of a functional of the form @xmath152(t ) = m(\\mathcal{u}'[\\lambda](t,0))$ ] , can be brought into a form analogous to eq .  .",
    "this follows immediately from the chain rule in calculus as @xmath177(t ) = \\frac{i\\partial m(\\mathcal{u}')}{\\partial \\mathcal{u}'}\\frac{\\partial \\mathcal{u}'[\\lambda](t,0)}{\\partial t}$ ] .",
    "explicitly this result reads @xmath178(t )    =    \\sum_\\sigma\\sum_{i\\ge j }    \\frac{{\\ensuremath{\\delta_\\mathrm{loc}}}[i\\partial_t m[\\lambda](t ) ] }    { \\delta_\\mathrm{loc}\\lambda_{ij\\sigma}(t ) }    \\lambda_{ij\\sigma}(t )    +    \\xi_{m}[\\lambda](t),\\ ] ] where @xmath179(t ) ] } { \\delta_\\mathrm{loc}\\lambda_{ij\\sigma}(t)}$ ] and @xmath180 $ ] are again integrated quantities in @xmath60 .",
    "we furthermore conclude that a time - local variation of the time derivative of an integrated quantity in @xmath60 is non - zero in general .",
    "the main idea in the following is to combine the conditional equations into a single equation @xmath181(t ) \\stackrel{!}{= } 0 $ ] such that @xmath182 $ ] is of the form @xmath182(t ) = j[\\lambda](t ) \\lambda(t ) + \\xi_\\gamma[\\lambda](t)$ ] where @xmath183 $ ] and @xmath184 $ ] are integrated quantities in @xmath60 .",
    "this is formally easily solved for @xmath146 by matrix inversion and allows to derive an efficient propagation scheme for numerical purposes .",
    "the main building blocks of the continuity equations for the spin - dependent density , eq .   , and the doublon density , eq . , are given by the two - particle correlation functions @xmath36 and @xmath42 .",
    "within the cpt approximation they are defined through eq .   .",
    "we therefore have to understand the @xmath60 dependence of @xmath185\\equiv \\eta_{t ' - \\lambda , u}$ ] and @xmath67 $ ] .",
    "one can easily see that @xmath185 $ ] is an integrated quantity in @xmath60 .",
    "consider , for example , the physical sector . from eq .",
    "we have @xmath186(t ) = \\delta_{ij}{\\ensuremath{\\langle { \\hat{n}_{i\\bar\\sigma}(t ) } \\rangle}}_{h_{t ' - \\lambda , u}}$ ] .",
    "the only @xmath60-dependence of this expression indeed stems from the propagator @xmath163 $ ] . to obtain a non - vanishing time - local variation we thus have to consider the first derivative with respect to time",
    "this is worked out in appendix [ ap : d_eta ] : @xmath187    &    =    \\eta'_{ii\\sigma}(t)\\delta\\lambda_{ij\\sigma}(t )    -    \\sum_{l\\sigma ' }    [ \\delta\\lambda_{il\\sigma'}(t)]\\gamma^{l\\sigma'}_{ij\\sigma}(t ) ,    \\nonumber \\\\    { \\ensuremath{\\delta_\\mathrm{loc}}}[i\\partial_t \\eta'_{is\\sigma}(t ) ]    &    =    -\\sum_{l\\sigma ' }    [ \\delta \\lambda_{il\\sigma'}(t)]\\gamma^{l\\sigma'}_{is\\sigma}(t ) ,    \\label{eq : eta_variation}\\end{aligned}\\ ] ] where the newly introduced tensor @xmath188^{l\\sigma'}_{is\\sigma}(t)$ ] is cluster - diagonal , i.e. , @xmath188^{l\\sigma'}_{is\\sigma}(t ) \\neq 0 $ ] if and only if @xmath9 and @xmath189 refer to lattice sites within the same cluster .",
    "it furthermore follows that @xmath190(t)$ ] can be brought into the form specified by eq .  , where the variational derivative @xmath191_{ix\\sigma}(t ) ] } { \\delta\\lambda_{jl\\sigma}(t)}$ ] , as given by eq .  , and @xmath192_{ix\\sigma}(t)$ ] are integrated quantities in @xmath60 .",
    "an explicit expression for the latter is not needed for our purposes .",
    "let us now take a look at the cpt green s function .",
    "it depends on @xmath60 through the hamiltonian @xmath193 $ ] , which in turn depends on @xmath60 through the hybridization strengths @xmath194_{is\\sigma}(t ) = u(t ) \\eta'[\\lambda]_{is\\sigma}(t)$ ] and the hartree - fock term @xmath195^\\text{hf}_{ij\\sigma}(t ) = u(t)\\eta'[\\lambda]_{ij\\sigma}(t)$ ] .",
    "the hamiltonian @xmath196 is therefore an integrated quantity in @xmath60 .",
    "as the propagator @xmath197(t,0 ) = t { \\ensuremath{\\mathrm{exp}\\left({-i\\int_0^t { \\ensuremath{\\mathrm{d}t } } ' h^\\text{cpt}[\\lambda](t')}\\right)}}$ ] involves a second integral over time , we conclude that @xmath198 . in this sense , @xmath199 must be seen as an integrated quantity in @xmath60 of second order .",
    "consequently , the time - local variation of its first derivative with respect to time vanishes : @xmath200(t , t^+ ) ]    = 0.\\ ] ] we note that the time derivative involves the product of the matrix elements of the cpt hamiltonian , eq .",
    "( [ eq : hcpt ] ) , with @xmath67(t , t^+)$ ] , i.e. , the product of an integrated quantity in @xmath60 with an integrated quantity in @xmath60 of second order , respectively . obviously , the product scales like an ordinary integrated quantity in @xmath60 when a time - local variation is applied , i.e. , @xmath201 in lowest order in @xmath164 .    concluding , to get a non - vanishing time - local variation",
    ", one must consider the first time derivative of the two - particle green s functions @xmath36 and @xmath42 .",
    "we find @xmath202    =    \\sum_{x }    \\left (      { \\ensuremath{\\delta_\\mathrm{loc}}}[i\\partial_t \\eta'_{ix\\sigma}(t ) ]    \\right )    g^\\text{cpt}_{xj\\sigma}(t , t^+)\\end{aligned}\\ ] ] and an analogous expression for @xmath42 .",
    "only the @xmath203-term contributes to the variation , cf .",
    "eq .  , while the variation of the cpt green s function vanishes , cf .",
    "we also note that eq",
    ".   may be used at this point and that @xmath204 [ and analogously @xmath205 is of the form @xmath206_{ij\\sigma}(t),\\ ] ] where both , the variational derivative @xmath207 , as given by eq .  , and the quantity @xmath208 , which is not needed in explicit form for our purposes , scale like integrated quantities in @xmath60 under time - local variations .",
    "this follows from the fact that @xmath209 scales like an integrated quantity in @xmath60 under time - local variations and the related discussion above .      the continuity equation for the spin - dependent density , eq .",
    ", is formulated in terms of the difference between @xmath36 and @xmath42",
    ". therefore its first derivative with respect to time must be considered to obtain a non - vanishing time - local variation : @xmath210_{i\\sigma}(t ) ]    =    { \\ensuremath{\\delta_\\mathrm{loc}}}&\\left [    i\\partial_t g^{(2l)}[\\lambda]_{ii\\sigma}(t , t^+ )     \\right.\\\\    & \\quad\\quad\\quad\\quad \\left .      -      i\\partial_t g^{(2r)}[\\lambda]_{ii\\sigma}(t , t^+ )     \\right],\\nonumber\\end{aligned}\\ ] ] for the time - local variation of the continuity equation of the doublon density , eq .  , on the other hand , one finds @xmath211_{i\\sigma}(t )    =    { \\ensuremath{\\delta_\\mathrm{loc}}}&\\left [    i\\partial_t g^{(2l)}[\\lambda]_{ii\\sigma}(t , t^+ )     \\right.\\\\    & \\quad\\quad\\quad\\quad \\left .",
    "+      i\\partial_t g^{(2r)}[\\lambda]_{ii\\sigma}(t , t^+ )     \\right],\\nonumber\\end{aligned}\\ ] ] since @xmath212(t , t^+ ) = 0 $ ] , where we made use of the fact that @xmath213 is the hopping of the original system and thus independent of @xmath60 .    to treat both continuity equations in a combined formal frame",
    ", we define the functional @xmath182 $ ] : @xmath214_a(t ) =     \\left\\ {       \\begin{aligned }        & i \\partial_t         f[\\lambda]_{i\\sigma}(t ) \\quad \\text{if } \\quad 0 \\le a < 2l\\ : , \\\\        & c[\\lambda]_{i\\sigma}(t ) \\quad \\text{if } \\quad 2l \\le a < 4l \\ : ,       \\end{aligned }    \\right.\\ ] ] where @xmath215 is the number of lattice sites . with this , the conditional equation for the optimal renormalization reads @xmath181 \\stackrel{!}{= } 0 $ ] . from the previous discussion and eq .",
    "it follows that @xmath182_a(t)$ ] is of the form @xmath216_a(t )     =     \\sum_{b }",
    "j[\\lambda]_{ab}(t ) \\lambda_b(t )    +    \\xi_\\gamma[\\lambda]_a(t),\\ ] ] where we introduced the super - index @xmath217 which labels the set of free parameters : @xmath218 , @xmath219 . both @xmath183 $ ] and @xmath184 $ ] scale like integrated quantities in @xmath60 under time - local variations .",
    "the jacobian matrix @xmath220 is defined as @xmath221_{ab}(t )     \\equiv     \\frac{{\\ensuremath{\\delta_\\mathrm{loc}}}\\gamma_a[\\lambda](t)}{{\\ensuremath{\\delta_\\mathrm{loc}}}\\lambda_b(t)}.\\ ] ] the matrix @xmath183(t)$ ] is quadratic if the number of free parameters @xmath222 is chosen such that it equals the number of conditional equations [ see eq .  ] . assuming that @xmath183(t)$ ] is regular",
    ", one can formally solve the conditional equation for the optimal renormalization : @xmath223(t ) \\stackrel{!}{= } 0    \\quad    \\leftrightarrow    \\quad",
    "\\lambda^\\mathrm{opt}(t )     =     -    \\left [      j[\\lambda^\\text{opt}](t )    \\right]^{-1 }    \\xi_\\gamma[\\lambda^\\text{opt}](t ) \\ : , \\ ] ] see eq .",
    "( [ eq : gform ] ) .",
    "this completes our derivation .",
    "let us emphasize that the single point @xmath224 represents a null set with respect to the time - integrations in @xmath225(t)$ ] and @xmath226(t)$ ] .",
    "this can be exploited to derive an efficient numerical scheme to obtain @xmath146 step by step on the time axis ( as detailed in the next subsection ) .",
    "we further note that an explicit expression for @xmath183(t)$ ] in terms of known quantities is available via from eqs .",
    "on the other hand , it is more tedious to get an explicit expression for @xmath184(t)$ ] .",
    "as is argued below , however , this can in fact be circumvented .",
    "finally , we like to set up an efficient numerical scheme to determine @xmath146 . this should be based on a time - propagation algorithm where the error is of high order in the basic time step @xmath164 .",
    "let us assume that for each time step the taylor expansion of @xmath146 is well defined .",
    "for each time interval and for arbitrary @xmath227 $ ] we then have @xmath228 where each @xmath60-term must be considered as a tuple with components labelled by the super - index @xmath217 , e.g. , @xmath229_b)$ ] , where @xmath149 refers to the @xmath149-th time interval , and where @xmath230 runs from @xmath231 up to the maximum order of the polynomial @xmath232 . during the time propagation , the polynomial approximation must be updated after each time step .",
    "this is done by fixing the coefficients at each interfacing time @xmath233 such that @xmath181(t_n ) = 0 $ ] . for times",
    "@xmath234 we then have @xmath181(t ) = o(\\delta t^{n_p + 1})$ ] .",
    "writing @xmath235(t)$ ] and @xmath236(t)$ ] for short and applying the product rule to @xmath237 , the self - consistency condition is readily rewritten in terms of the taylor coefficients : @xmath238_{t = t_n }       \\lambda_{n , r }      -       [ \\partial_t^p \\xi_{\\gamma}(t)]_{t = t_n }    \\right).\\ ] ]    suppose that @xmath239 is known for all @xmath240 , i.e. , suppose that the propagation has been completed over the interval @xmath241 .",
    "the next step is to update the coefficients . at this point",
    "we can exploit that @xmath242 and @xmath243 scale like integrated quantities in @xmath60 under time - local variations which implies @xmath244 and @xmath245 .",
    "hence , at @xmath246 , both are independent of @xmath247 .",
    "we define @xmath248 then , @xmath249(t_n),\\ ] ] and we are now able to solve eq .   for @xmath250 . the first derivatives @xmath251 and @xmath252 explicitly depend on @xmath253 , which is now known , but are integrated quantities in the first derivative @xmath254 , i.e. , they are independent of @xmath255 . therefore , the same idea can be applied and in fact be repeated again and again until finally @xmath256 is known up to the desired order .",
    "we emphasize that the presented algorithm gives a fully converged @xmath257 for @xmath258 within a single iteration .      initially , at time @xmath12 the system is assumed to be in a thermal state .",
    "the cpt approximation for the initial thermal state suffers from the fact that the starting point of the all - order perturbation theory in the inter - cluster hopping is not unique .",
    "this is completely analogous to the cpt description of the real - time dynamics .",
    "unlike the real - time dynamics , however , the continuity equations can not be used to fix the renormalization parameters @xmath259 for the initial state , and thus a nontrivial self - consistency condition is not available , unfortunately .",
    "this can be seen as follows : let us assume that the hopping matrix @xmath47 , and consequently @xmath48 and @xmath49 , are real and symmetric . consider @xmath36 at times @xmath260 . via eq .",
    "this is given as @xmath142_{ij\\sigma}(0,0^+ ) = i\\sum_{x } \\eta'[\\lambda]_{ix\\sigma}(0 ) g^\\text{cpt}[\\lambda]_{xj\\sigma}(0,0^+)$ ] . in appendix",
    "[ ap : math_eff ] it is shown that at time @xmath12 the imaginary part @xmath261_{ix\\sigma}(0)\\}$ ] vanishes , independently of @xmath262 .",
    "hence , eq .   implies that @xmath125(0)$ ] is real and symmetric , and therefore @xmath67_{xy\\sigma}(0,0^+ ) = i{\\ensuremath{\\langle { { \\ensuremath{\\hat{c}^\\dagger_{y\\sigma}}}(0 ) { \\ensuremath{\\hat{c}_{x\\sigma}}}(0 ) } \\rangle}}_{h^\\text{cpt}[\\lambda]}$ ] is purely imaginary .",
    "consequently , @xmath142(0,0^+)$ ] is real .",
    "finally , we conclude with eq . that @xmath263_{ij\\sigma}(0,0^+ ) = g^{(2r)}[\\lambda]_{ji\\sigma}(0,0^+).\\ ] ] this directly proves that @xmath264_{i\\sigma}(0)=0 $ ] , and furthermore @xmath265_{i\\sigma}(0 )    =    2\\sum_{j\\sigma }    t_{ij\\sigma}(0 )    & \\left [      g^{(2r)}[\\lambda]_{ji\\sigma}(0,0^+ )    \\right.\\\\    & \\quad\\quad    \\left .      -      g^{(2l)}[\\lambda]_{ij\\sigma}(0,0^+ )    \\right ]    =    0    \\nonumber \\end{aligned}\\ ] ] irrespective of @xmath262 , i.e.",
    ", both continuity equations hold trivially .    for the concrete numerical calculations we therefore circumvent this issue and consider a noninteracting initial state .",
    "in this case the cpt is exact , independent of the choice of @xmath60 .",
    "the initial value @xmath262 is then fixed by requiring @xmath60 to be continuous so that @xmath266 .",
    "the conserving cpt has been implemented numerically .",
    "first results are discussed for the two - dimensional hubbard model on an @xmath267 square lattice with periodic boundary conditions .",
    "as these results shall serve as a proof of concept only , we restrict ourselves to the most simple approximation , i.e. , to the smallest meaningful cluster as the building block of the reference system , namely a cluster consisting of @xmath268 sites . hence , the entire system is partitioned into @xmath269 clusters in total , see fig .",
    "[ fig : setup ] .",
    "initially , the system is prepared in its noninteracting ground state at half - filling by choosing @xmath270 .",
    "note that the cpt description of this initial state is exact ( and independent of the renormalization ) .",
    "the hopping of the original system is restricted to nearest neighbors , and we set the nearest - neighbor hopping @xmath271 to fix energy and time units . to drive the system out of equilibrium we consider an interaction quench where the hubbard-@xmath121 is suddenly , at time @xmath12 , switched on to a finite value @xmath272 : @xmath273 here , @xmath274 denotes the heaviside step function . for times",
    "@xmath275 the interaction strength is constant . to maintain particle - hole symmetry and half - filling ,",
    "the chemical potential is quenched as well , from @xmath276 to @xmath277 in the final state .",
    "studying the model at the particle - hole symmetric point is convenient since the conservation of the total particle number is trivially respected in this case .",
    "@xcite for a spin - independent parameter quench , as considered here , the cpt also trivially respects the conservation of the total spin .",
    "total - energy conservation , on the other hand , is violated in a conventional cpt approach as has been explicitly demonstrated recently .",
    "@xcite for the present setup we will therefore employ the nearest - neighbor hopping within the @xmath268 reference system to enforce the energy - conservation law .",
    "this specifies the time - dependent renormalization parameter @xmath169 ( see fig.[fig : setup ] ) .",
    "lattice with periodic boundary conditions .",
    "reference system : @xmath269 clusters of size @xmath268 .",
    "the figure shows a @xmath278 excerpt .",
    "clusters are indicated by dashed rectangles .",
    "nearest - neighbor hopping @xmath47 and optimization parameter @xmath169 are indicated by black and red lines .",
    "the time - dependent renormalization @xmath169 is employed to enforce the conservation of energy in the real - time dynamics following an interaction quench .",
    ", scaledwidth=16.0% ]    we note that the computational effort to self - consistently solve the presented theory numerically is essentially determined by the underlying solver for the nonequilibrium cpt with little overhead . since our approach uses the time - local , hamiltonian - based solver developed in ref .",
    ", it also inherits its linear scaling in the maximum propagation time regarding computation time and a constant memory consumption .",
    "in particular , we have used a time step of @xmath279 to propagate the system up to @xmath280 steps up to a maximum propagation time of @xmath281 . for each such time",
    "step @xmath233 , the scheme developed in sec .",
    "[ sec : high - order ] has been employed with @xmath282 , i.e. , we have calculated the taylor coefficients @xmath250 and @xmath283 .    while the required computational resources are very moderate , accessing longer time scales has turned out to be hindered by mathematical complications . as is obvious from eq .",
    ", an inversion of the jacobian matrix @xmath242 is necessary to obtain @xmath146 at each time step .",
    "however , with increasing @xmath284 this matrix exhibits singular points of non - invertibility at earlier and earlier times .",
    "in fact , one finds numerically that also the starting point @xmath285 is singular , namely the jacobian matrix vanishes : @xmath286 .",
    "fortunately , one also has @xmath287 , such that this problem is fixed by applying lhpital s rule . at time @xmath285 , the defining equation for @xmath288 becomes @xmath289(0^+ )    \\right]^{-1 }    [ \\partial_t \\xi_\\gamma[\\lambda^\\text{opt}](0^+)].\\ ] ] while this solves the problem at time @xmath290 , finding a systematic and convenient way to propagate beyond the singular points of the jacobian matrix at _ finite _ times remains topic for future investigations .    .",
    "grey lines : plain cpt .",
    "blue lines : conserving cpt .",
    "results for different @xmath284 ranging from @xmath291 ( top curve ) to @xmath292 ( bottom ) with equidistant steps @xmath293 . for the conserving cpt calculations ,",
    "propagation times are limited by singular jacobians .",
    ", scaledwidth=45.0% ]    apart from this technical problem , the suggested scheme works as expected .",
    "results for the time evolution of the doublon density are shown in fig.[fig : docc ] .",
    "it is evident that the renormalization @xmath60 has a strong influence on the dynamics and leads to qualitatively different results when comparing the plain unoptimized cpt calculation with the novel conserving cpt .",
    "while the dynamics is characterized by ongoing oscillations when using plain cpt , there is a monotonous decay of the doublon density in case of the conserving cpt .",
    "the longest maximum propagation time is achieved for the quench @xmath294 .",
    "here , the first singular point of the jacobian shows up at @xmath295 . on this time scale ,",
    "the doublon density seems to relax to a stationary state with little to no oscillations .     for different @xmath284 as indicated and corresponding to fig .",
    "[ fig : docc ] .",
    "inset : time dependence of the total energy ( plain and conserving cpt ) .",
    ", scaledwidth=45.0% ]    the qualitatively different time dependence of the doublon density reflects the qualitatively different behavior found for the total energy in the plain and the conserving cpt : this is shown in the inset of fig .",
    "[ fig : energy ] . for the conserving cpt",
    ", the total energy is perfectly conserved within numerical accuracy  by construction of the approach . in the plain cpt calculation , however , the total energy shows unphysical oscillations . here ,",
    "maxima and minima of @xmath296 nicely correspond to maxima and minima in the plain - cpt doublon density seen in fig .",
    "[ fig : docc ] .",
    "it must be concluded that those are artifacts of the plain cpt approach .",
    "we also note that small unphysical oscillations of the total energy _ density _",
    "@xmath297 ( with @xmath298 ) with amplitudes less than @xmath299 lead to much stronger oscillations in the doublon density with amplitudes of about 0.04 .    the main part of fig .",
    "[ fig : energy ] displays the results for the time evolution of the renormalization parameter @xmath169 .",
    "its dependence on @xmath284 turns out to be rather weak on a time scale of a few inverse hoppings .",
    "irrespective to the final interaction strength @xmath300 , the initial equilibrium value is found as @xmath301 . for @xmath15 and for all @xmath300 , the renormalization parameter rapidly increases to @xmath302 within a very short time @xmath303 .",
    "this corresponds to the rapid initial drop of the doublon density ( cf .",
    "fig.[fig : docc ] ) .",
    "results for longer times are again only available for the quench @xmath304 . on the time scale",
    "up to @xmath305 , we observe a subsequent slow relaxation of @xmath169 toward an average final value @xmath306 with small superimposed oscillations .",
    "it seems reasonable to assume that a similar behavior would also be found for the other quenches , given that the short - time dynamics is very similar for the different @xmath300 .",
    "one should note that @xmath307 amounts @xmath308 , i.e. , a vanishing renormalized intra - cluster hopping .",
    "apart from the remaining oscillations of the renormalization parameter around @xmath309 , this means that the system `` chooses '' the atomic limit of the hubbard model as the optimal starting point for the all - order perturbation theory in the inter - cluster hopping for long times .",
    "this may be interpreted as follows : first of all , the remaining oscillations are understood as being necessary to keep the total energy constant within the conserving cpt . disregarding the oscillations",
    ", the value @xmath310 means that , on the level of the reference system , the doublon density becomes a conserved quantity for long times .",
    "this , however , is in fact a plausible starting point if the doublon density of the full lattice model approaches a constant in the course of time . as is seen in fig .",
    "[ fig : docc ] , this is almost the case .",
    "the remaining time dependence of the doublon density of the lattice model is weak and would be exclusively due to the inter - cluster hopping ( if @xmath311 exactly ) .",
    "let us compare the cpt result for the doublon density with the results of previous calculations for the one - dimensional hubbard model @xcite using the density - matrix renormalization group ( dmrg ) and for the model in infinite dimensions using the dynamical mean - field theory ( dmft ) .",
    "@xcite in both cases , a very fast relaxation of the doublon density on a time scale of one inverse hopping has been found in fact .",
    "typically , however , the doublon density first develops a minimum before it saturates to an almost constant value .",
    "this minimum is absent in the conserving cpt calculations ( see fig.[fig : docc ] ) .",
    "note , that on the intermediate time scale discussed here and in the dmrg and dmft studies the doublon density does not relax to its thermal value due to kinematic constraints becoming active after the ultrashort initial relaxation step .",
    "@xcite indeed , one expects a subsequent relaxation on a much longer time scale .",
    "let us emphasize that while our data in fig.[fig : docc ] are compatible with these expectations , serious predictions using the conserving cpt are not yet possible .",
    "this would require a much more systematic study involving different and in particular larger clusters , an analysis of the dependence on the cluster shape and also a systematic discussion of the different possibilities to choose renormalization parameters for the self - consistent procedure .",
    "cluster - perturbation theory , as proposed originally , represents the most simple way to construct a mean - field theory which incorporates to some extent the effects of short - range correlations .",
    "we have emphasized that the starting point of the perturbational expansion in the inter - cluster hopping is by no means predetermined and that the according freedom in the choice of the intra - cluster hopping parameters can be exploited to `` optimize '' the mean - field theory .",
    "there are different conceivable optimization schemes .",
    "one way is to add an additional self - consistency condition as , for example , a self - consistent renormalization of the on - site energies which would be very much in the spirit of the hubbard - i approximation .",
    "the disadvantage of such ideas is their _ ad hoc _ character .",
    "an optimization following a general variational principle is much more satisfying and physically appealing .",
    "this is the route that is followed up by self - energy - functional theory .",
    "unfortunately , total - energy conservation is not straightforwardly implemented within the sft context .",
    "an appealing idea is thus to use the above - mentioned freedom to _ enforce _ energy conservation , and actually any conservation law dictated by the symmetries of the problem at hand .",
    "this leads to the conserving cpt proposed in the present paper .    as we have argued ( see sec .",
    "[ sec : initial_state ] ) , this idea can exclusively be used to constrain the cpt real - time dynamics while other concepts must be invoked for the initial thermal state . on the other hand",
    ", there is an urgent need for numerical approaches , even for comparatively simple cluster mean - field concepts , which are able to address the real - time dynamics of strongly correlated lattice fermion models beyond the more simple extreme limits of one and infinite lattice dimension . with the present paper",
    "we could give a proof of principle that a nonequilibrium conserving cluster - perturbation theory is possible and can be evaluated numerically in practice .",
    "an highly attractive feature of this approach is the linear scaling with the propagation time , while the exponential scaling with the cluster size is the typical bottleneck of any cluster mean - field theory .",
    "the mapping of the original nonequilibrium cpt onto an effective auxiliary problem specified by a noninteracting hamiltonian with additional virtual ( `` bath '' ) degrees of freedom is crucial for the practical implementation of the approach .",
    "one should note that the number of virtual sites is related to the number of one - particle excitations and thus grows exponentially with the original cluster size .",
    "hence , any practical calculation is limited to a few ( say , at most 10 ) cluster sites only .",
    "this implies that a systematic finite - size scaling analysis will be problematic if long - range correlations dominate the essential physical properties  this is the above - mentioned drawback that is shared with any available cluster - mean - field theory .",
    "we therefore expect that the field of applications of conserving cpt is limited to problems with possibly strong but short - ranged correlations .",
    "due to its formulation in terms of green s functions with time arguments on the keldysh contour , the cpt has an inherently causal structure . with the present paper",
    "we could in particular demonstrate how to exploit this causality for an efficient time - stepping algorithm where updates of the parameter renormalization can be limited to the respective last time slice during time propagation .",
    "the essential problem that had to be solved here consists in controlling the order ( in the sense of a taylor series ) at which the parameter renormalization on a single time slice enters other physical quantities , such as the basic time - evolution operator , green s functions , etc .",
    "this has allowed us to set up a highly accurate numerical algorithm where conservation laws are respected with machine precision .    for convenience ,",
    "first numerical results have been generated for interaction quenches of the two - dimensional hubbard model on a square lattice at half - filling , where particle - number and spin conservation are respected trivially .",
    "energy conservation has been enforced by time - dependent renormalization of the intra - cluster hopping in the @xmath312 reference cluster .",
    "it is worth pointing out that even with this simple approximation ( small cluster ) the impact of the self - consistency condition is substantial .",
    "comparing the conserving against plain cpt , there is a qualitative change of the time - dependence of the doublon density which is plausible and improves the theory : artificial oscillations due to the finite cluster size are almost completely suppressed , and an ultrafast relaxation to a ( prethermal ) state with nearly constant doublon density is predicted as might be expected from previous computations for one- and infinite - dimensional lattices .",
    "interestingly , the conditional equations for the renormalization parameters feature singular points of non - invertibility .",
    "technically , this currently restricts our investigations to quenches with small final interaction and short propagation times .",
    "it is not clear at the moment whether or not a physical meaning can be attributed to those singular points ; this requires further and more systematic studies . according to our present experience , it is well conceivable that , with a suitable regularization scheme , time propagation through a singularity of the jacobian is possible and has no apparent impact on the time dependence of physical observables .",
    "developing such a regularization scheme is the next task for future studies and an important issue to make the conserving cpt a powerful numerical tool to address , e.g. , real - time magnetization dynamics , even of inhomogeneous models on long time scales .",
    "we thank roman rausch for providing an exact - diagonalization solver for the hubbard model and felix hofmann for valuable discussions . this work has been supported by the deutsche forschungsgemeinschaft through the excellence cluster `` the hamburg centre for ultrafast imaging - structure , dynamics and control of matter at the atomic scale '' and through the sonderforschungsbereich 925 ( project b5 ) .",
    "numerical calculations were performed on the physnet computer cluster at the university of hamburg .",
    "in eq .   we have stated the effective one - particle hamiltonian @xmath313 for an interacting lattice system .",
    "its corresponding matrix elements are given by @xmath314 , cf .",
    "eq .  . in ref",
    ".   it is shown that @xmath315 can be constructed from the lehmann representation of the one - particle green s function @xmath316 .",
    "it is given by @xmath317 o^*_{y\\sigma ( m , n)}(t).\\ ] ] the matrix @xmath318 can explicitly be stated within the physical sector only ( i.e. , @xmath107 ) . there",
    "it takes the form @xmath319 where @xmath320 denotes the @xmath321-th eigenstate with corresponding eigenenergy @xmath322 of the initial hamiltonian , i.e. , @xmath323 .",
    "@xmath324 denotes the grand - canonical partition function , @xmath13 the inverse temperature of the equilibrium initial state .",
    "the remaining matrix elements @xmath325 are defined uniquely , up to rotations in invariant subspaces , by requiring @xmath318 to be a unitary transform , see ref .   for details .",
    "eq .   is now easily derived from @xmath326 where @xmath327 with the definition @xmath328 we arrive at eq .  .",
    "it is instructive to note that the elements @xmath329 in the physical sector are easily evaluated as @xmath330 where @xmath331 denotes the anti - commutator . from a numerical point of view we note , that @xmath332 as well as its derivatives with respect to time of arbitrary order can be easily evaluated using the exact - diagonalization - based scheme presented in ref .  .",
    "regarding our discussion of the initial state in sec .",
    "[ sec : initial_state ] it is now easy to proof that @xmath333 . at time",
    "@xmath12 the elements @xmath334 can be chosen as real , since the hamiltonian @xmath335 is symmetric and therefore has real eigenvectors @xmath320 .",
    "similarly , the physical sector @xmath336 is real in this case and completion to a unitary matrix @xmath318 allows for an orthogonal , i.e. , real @xmath318 .",
    "it then follows that @xmath333 from eq .  .",
    "we note that any non - real choice @xmath337 can be brought into the form @xmath338 , where the matrix @xmath339 contains the phase factors and possibly rotations in invariant subspaces .",
    "however , from eq .",
    "it follows that @xmath340 and therefore the @xmath339 matrix cancels .",
    "the same proof holds for the reference system , i.e. , @xmath341_{ix\\sigma}(0)\\ } = 0 $ ] , assuming @xmath60 is real .",
    "within this subsection we will use the shorthand notation @xmath342 and @xmath343 . to prove the continuity equation of the doublon density , we consider @xmath344 } \\rangle}}_{h_{t , u } } \\nonumber\\\\    & =     \\sum_{\\sigma }    { \\ensuremath{\\langle {      \\left [        \\sum_{jk}t_{jk\\sigma}(t){\\ensuremath{\\hat{c}^\\dagger_{j\\sigma}}}(t){\\ensuremath{\\hat{c}_{k\\sigma}}}(t ) ,        \\hat n_{i\\sigma}(t )       \\right]\\hat n_{i\\bar\\sigma}(t ) } \\rangle}}_{h_{t , u}},\\nonumber\\end{aligned}\\ ] ] where we used that the double occupation operator commutes with the interaction term of the hamiltonian @xmath345 .",
    "using further that @xmath346\\\\    & =    \\sum_{jk}t_{jk\\sigma}(t )    \\left (      \\delta_{ki}{\\ensuremath{\\hat{c}^\\dagger_{j\\sigma}}}(t){\\ensuremath{\\hat{c}_{i\\sigma}}}(t )      -      \\delta_{ji}{\\ensuremath{\\hat{c}^\\dagger_{i\\sigma}}}(t){\\ensuremath{\\hat{c}_{k\\sigma}}}(t )    \\right),\\nonumber\\end{aligned}\\ ] ] we find the continuity equation of the doublon density by comparing with eqs . and and using the relation @xmath347 .",
    "this implies @xmath348\\\\    & =    2\\sum_{j\\sigma }    \\left [      t_{ij\\sigma}(t)g^{(2r)}_{ji\\sigma}(t , t^+ )      -      g^{(2l)}_{ij\\sigma}(t , t^+)t_{ji\\sigma}(t )    \\right],\\nonumber\\end{aligned}\\ ] ] which completes our derivation of eq .  .",
    "let @xmath349 denote the matrix elements of the effective hamiltonian of the reference system @xmath350 , cf .",
    "eqs . and .",
    "through eq .  , or equivalently eq .   , a corresponding matrix @xmath351 is defined .",
    "we are interested in how it transforms under time - local variations .",
    "since @xmath203 is an integrated quantity in @xmath60 , we first calculate its derivative with respect to time .",
    ".   implies @xmath352    [ o']^\\dagger_{(m , n)x\\sigma}(t),\\nonumber\\end{aligned}\\ ] ] where @xmath353 and @xmath354 . with @xmath355 , the time - local variation of @xmath356",
    "is given by @xmath357    =    z^{(m , n)}{\\ensuremath{\\langle m \\vert}}{\\ensuremath{\\delta_\\mathrm{loc}}}\\left [      \\hat{n}_{i\\bar{\\sigma}}(t )      { \\ensuremath{\\hat{c}_{i\\sigma}}}(t),\\hat{h}'(t )    \\right]{\\ensuremath{\\vert n \\rangle}}\\nonumber\\\\    & =    -z^{(m , n ) }    \\sum_{j }    { \\ensuremath{\\langle m \\vert } }    \\delta\\lambda_{ij\\sigma}(t )    \\hat{n}_{i\\bar{\\sigma}}(t){\\ensuremath{\\hat{c}_{j\\sigma}}}(t)\\nonumber\\\\    & \\phantom{=}\\quad\\quad    +    \\delta\\lambda_{ij\\bar\\sigma}(t )    \\left [      { \\ensuremath{\\hat{c}^\\dagger_{i\\bar\\sigma}}}(t){\\ensuremath{\\hat{c}_{j\\bar\\sigma}}}(t )      -      { \\ensuremath{\\hat{c}^\\dagger_{j\\bar\\sigma}}}(t){\\ensuremath{\\hat{c}_{i\\bar\\sigma}}}(t )    \\right]{\\ensuremath{\\hat{c}_{i\\sigma}}}(t )    { \\ensuremath{\\vert n \\rangle}},\\end{aligned}\\ ] ] where we further introduced @xmath358 and exploited @xmath359 .",
    "the time - local variation of @xmath360 , on the other hand , vanishes since it is an integrated quantity in @xmath60 .",
    "this follows directly from the definition of its physical sector , cf .",
    "we define @xmath361^*_{x\\sigma ( m , n)}(t),\\\\    \\gamma_{ix\\sigma}^{l\\bar\\sigma}(t )    & =    \\sum_{mn }    z^{(m , n ) }    { \\ensuremath{\\langle m \\vert } }      \\left [        { \\ensuremath{\\hat{c}^\\dagger_{i\\bar\\sigma}}}(t){\\ensuremath{\\hat{c}_{l\\bar\\sigma}}}(t )      \\right.\\\\      & \\qquad\\qquad\\qquad      \\left .      -        { \\ensuremath{\\hat{c}^\\dagger_{l\\bar\\sigma}}}(t){\\ensuremath{\\hat{c}_{i\\bar\\sigma}}}(t )    \\right ]    { \\ensuremath{\\hat{c}_{i\\sigma}}}(t )    { \\ensuremath{\\vert n \\rangle } }    [ o']^*_{x\\sigma ( m , n)}(t),\\nonumber\\end{aligned}\\ ] ] and therewith obtain eq .  ."
  ],
  "abstract_text": [
    "<S> using the recently introduced time - local formulation of the nonequilibrium cluster perturbation theory ( cpt ) , we construct a generalization of the approach such that macroscopic conservation laws are respected . </S>",
    "<S> this is achieved by exploiting the freedom for the choice of the starting point of the all - order perturbation theory in the inter - cluster hopping . </S>",
    "<S> the proposed conserving cpt is a self - consistent propagation scheme which respects the conservation of energy , particle number and spin , which treats short - range correlations exactly up to the linear scale of the cluster , and which represents a mean - field - like approach on length scales beyond the cluster size . using green s functions , </S>",
    "<S> conservation laws are formulated as local continuity equations for the local spin - dependent particle and the doublon density . </S>",
    "<S> we consider them as conditional equations to self - consistently fix the time - dependent intra - cluster one - particle parameters . </S>",
    "<S> thanks to the intrinsic causality of the cpt , this can be set up as a step - by - step time propagation scheme with a computational effort scaling linearly with the maximum propagation time and exponentially in the cluster size . as a proof of concept , we consider the dynamics of the two - dimensional , particle - hole - symmetric hubbard model following a weak interaction quench by simply employing two - site clusters only . </S>",
    "<S> conservation laws are satisfied by construction . </S>",
    "<S> we demonstrate that enforcing them has strong impact on the dynamics . </S>",
    "<S> while the doublon density is strongly oscillating within plain cpt , a monotonous relaxation is observed within the conserving cpt . </S>"
  ]
}