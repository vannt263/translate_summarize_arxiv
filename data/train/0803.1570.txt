{
  "article_text": [
    "it is well known that solving an optimal control problem ( ocp ) can be a very hard task notwithstanding the power of theoretical tools such pontryagin s minimum principle and hamilton - jacobi - bellman optimality condition .",
    "this statement is particularly true when dealing with state and input constraints",
    ".    * contribution . * in this paper we consider the class of ocps for which all problem data are polynomial .",
    "the approach we deploy ( which was introduced in @xcite ) is based on moment theory and consists in deriving a hierarchy of convex linear matrix inequality ( lmi ) relaxations of the ocp which give an increasing sequence of lower bounds on the optimal value .",
    "these lmi problems can be solved using off - the - shelf semidefinite programming ( sdp ) solvers .",
    "the contribution with respect to @xcite and its extended version @xcite is twofold .",
    "first , the derivation of the relaxation is obtained in a simpler way , starting from basic concepts .",
    "the second and more important contribution is that we show how the methodology can be applied to approximate the optimal value function on a set and to derive constructively and computationally a control law .",
    "the approach is illustrated on a few simple examples .",
    "* notation . *",
    "@xmath0 and @xmath1 denote respectively the sets of real and integer numbers .",
    "@xmath2=[y_1 , \\dots , y_n]$ ] denotes the ring of polynomials in the variable @xmath3 .",
    "@xmath2_d=[y_1 , \\dots , y_n]$ ] denotes the ring of polynomials of degree at most @xmath4 in the variable @xmath3 .",
    "when @xmath5 and @xmath6 , @xmath7 stands for @xmath8 .",
    "given a polynomial function @xmath9 , @xmath10 is the maximal degree of its monomials .",
    "given a differentiable function @xmath11 , @xmath12 $ ] is its gradient with respect to @xmath3 .",
    "@xmath13 is the dirac measure at @xmath14 .",
    "@xmath15 denotes the transpose of @xmath16 .",
    "consider continuous - time systems described by the differential equation @xmath17 where @xmath18 and @xmath19 are respectively the state vector and input vector . by defining the cost function",
    "@xmath20 the initial constraint @xmath21 and the final constraint @xmath22 we can formulate several ocps .",
    "e.g. , when @xmath23 and @xmath24 contain only one point we have the classical problem of driving the system from an assigned initial condition @xmath25 to a final condition @xmath26 by minimizing a given cost .    in the sequel",
    ", we will consider all the problems which can be cast in this framework with the additional constraint on the trajectory @xmath27 , where @xmath28    an important assumption which is necessary for the derivation of the methodology is that all problem data are polynomial .",
    "more precisely :    [ as : poly ] the functions @xmath29 , @xmath30 , @xmath31 , @xmath32 , @xmath33 and @xmath34 are polynomial .",
    "the key idea underlying the moment approach is that of defining three _ occupation measures _ which convey the information about the initial condition of the system , its trajectory and the final condition .",
    "the ocp is then rephrased in terms of the moments of such measures .",
    "the convex problem obtained contains three ingredients :    * a set of linear equality constraints on the moments which characterize the system dynamics ; * a set of semidefinite constraints which come from the fact that the moments belong to a measure ; * a set of semidefinite constraints which translate the constraints induced by @xmath23 , @xmath35 and @xmath24 on the supports of the measures .    to derive this constraints we assume horizon @xmath36",
    "is fixed .      to obtain the trajectory constraints we start from the idea that the system trajectories can be characterized studying how certain _ test functions _ evolve along the trajectories . for this purpose , we choose functions which are monomials of the form @xmath37 .",
    "consider a trajectory @xmath38 .",
    "using the fundamental theorem of calculus we can write @xmath39 the trajectory constraints are obtained by rephrasing equation ( [ eq : ftoc ] ) in terms of three properly defined occupation measures .    the _ final occupation measure _",
    "@xmath40 captures the information on the state at time @xmath36 @xmath41 the _ initial occupation measure _",
    "@xmath42 captures the information on the initial condition of the system @xmath43 the _ trajectory occupation measure _",
    "@xmath44 captures the information on the value of @xmath45 , @xmath38 and @xmath46 along the trajectory @xmath47 notice that @xmath40 and @xmath42 are probability measures , their mass is equal to @xmath48 .",
    "next , if @xmath49 $ ] then @xmath50 $ ] because @xmath51 for some coefficients @xmath52 that depend on @xmath29 .",
    "the degree of the derivative is @xmath53 . using previous equations , ( [ eq : ftoc ] )",
    "can be rephrased as @xmath54 i.e. , a _ linear _ relationship between the moments of @xmath55 and @xmath44 .",
    "namely , introducing the notation @xmath56 , @xmath57 , @xmath58 , we obtain @xmath59 for every @xmath60 .",
    "notice that from ( [ eq : momcons ] ) , the mass of @xmath44 is @xmath36 . in compact notation",
    ", consider test functions of degree up to @xmath61 and the canonical basis of monomials of degree at most @xmath61 : @xmath62'.\\ ] ] define the vectors @xmath63 , @xmath64 and @xmath65 .",
    "then , @xmath66 where @xmath67 and the coefficients of the matrices @xmath68 , @xmath69 and @xmath70 can be obtained from equation ( [ eq : momcons ] ) .",
    "define the coefficient vectors @xmath71 and @xmath72 to be such that @xmath73 observe that @xmath74 i.e. , the criterion of the ocp is a linear functional on @xmath75 and @xmath76 .",
    "so far , for a given trajectory @xmath38 , we have characterized linear constraints satisfied by the moments of the three associated occupation meaures .",
    "now , if the trajectory is unknown , the three measures are unknown , and we can consider the abstract linear programming ( lp ) problem @xmath77 subject to ( [ eq : meascons ] ) , which aims at finding the occupation measures associated with the optimal trajectory .",
    "the measures @xmath40 , @xmath42 , @xmath44 are characterized through their respective truncated moment vectors @xmath75 , @xmath78 , @xmath76 , the remaining difficulty being finding conditions that ensure that those vectors and indeed moment vectors of measures with respective supports @xmath24 , @xmath23 , @xmath35 .",
    "this is explained in the next section .",
    "a nice feature of the approach is that we can play with the initial and final measures .",
    "for instance , if @xmath79 we retrieve the optimal cost @xmath80 of the ocp with fixed initial state @xmath81 .",
    "now , if @xmath42 is unknown , but with known support @xmath23 , then @xmath82 . finally ,",
    "if @xmath42 is known , but not a dirac , solving the above lp problem aims at computing @xmath83 .      there exist linear programming ( lp ) or semidefinite programming ( sdp ) necessary and sufficient conditions for an infinite vector to be a _ moment _ vector , i.e. , the vector of moments of some finite borel measure on a compact basic semi - algebraic set ; see e.g. @xcite . we chose the latter since it has shown to be more effective for numerical purposes @xcite .    with @xmath61 an even number ,",
    "let @xmath84 be the _ moment matrix _ of order @xmath61 associated with @xmath40 .",
    "obviously , @xmath85 is positive semidefinite , denoted @xmath86 .",
    "therefore , in the convex relaxation of the ocp , one imposes @xmath87 and similar constraints are imposed on @xmath78 and @xmath76 .",
    "similarly to the previous subsection , one may express the support constraints induced by @xmath23 , @xmath35 and @xmath24 in terms of linear matrix inequalities on @xmath88 and @xmath76 . to derive such inequalities , define @xmath89 and the localizing matrix @xmath90 the matrix @xmath91 is positive semidefinite for every value of @xmath92 such that @xmath93 .",
    "hence if @xmath40 is supported on @xmath24 then @xmath94 for every @xmath95 .",
    "therefore , in the convex relaxation of the ocp one imposes the semidefinite constraint @xmath96 and similar semidefinite constraints for @xmath78 and @xmath76 .",
    "further details on moment and localizing matrix constraints can be found in @xcite .      to construct the convex relaxation of the ocp ,",
    "let @xmath61 and @xmath97 be even numbers such that @xmath98 in this paper , we will assume that the initial probability measure @xmath42 is known through its moments @xmath78 .",
    "the convex relaxation is the following truncated moment problem : @xmath99 where the notation @xmath100 indicates that the moment vector is known .",
    "two important facts should be noticed for the moment problem ( [ eq : momocp2 ] ) :    * the constraints on the moments correspond to necessary conditions and therefore , in general one only obtains a lower bound on the optimal value of ocp ; * with @xmath101 and @xmath102 , the constraints of the original problem with @xmath61 and @xmath97 are a subset of the constraints of the problem with @xmath103 and @xmath104 . therefore , increasing the value of @xmath61 and @xmath97 yields a monotonically nondecreasing sequence of lower bounds on the optimal value .",
    "if the initial measure @xmath42 was unknown , we would have to include the additional constraints @xmath105 , @xmath106 , @xmath107 with now @xmath78 being an unknown moment vector with first entry equal to one .",
    "one goal of this paper is to derive the convex relaxation of the ocp starting from really basic notions .",
    "the same optimization problem can be also obtained using as a starting point the duality between the banach space of bounded continuous functions on a compact set @xmath108 and the banach space of finite signed borel measures on @xmath108 , as done in @xcite where the sequence of lower bounds on the optimal value is shown to converge under some assumptions on the problem data .",
    "the interested reader is referred to these paper for further details .",
    "for the developments of the results in sections [ se : set_approx ] and [ se : control ] and a better understanding of the moment approach to ocp , it is important to look at its dual formulation which has an interesting interpretation in terms of sos polynomials .",
    "a polynomial @xmath109 $ ] of degree @xmath110 is an sos if @xmath111 for some @xmath112 $ ] , and this implies that @xmath113 is non - negative .",
    "and @xmath113 is an sos if and only if there exists a positive semidefinite matrix @xmath114 such that @xmath115 .",
    "denote by @xmath116 $ ] the set of sos polynomials and by @xmath116_r$ ] ( with @xmath61 even ) the set of sos polynomials of degree at most @xmath61 .",
    "see @xcite for more details .",
    "the sdp dual of ( [ eq : momocp2 ] ) is @xmath117 where the symbol @xmath118 indicates the adjoint operator , @xmath119 is the dual variable associated with the ( moment ) trajectory constraint , @xmath120 and @xmath114 are the dual variables associated with the moment matrix constraints and @xmath121 and @xmath122 are the dual variables associated with the localizing matrix constraints . to interpret problem ( [ eq : dualocpsdp ] ) in terms of sos polynomials , define the polynomial function @xmath123 explicitating the adjoint operators yields the following problem : @xmath124_r , s\\in \\sigma[t , x , u]_k , q\\in \\sigma[x]_r \\\\",
    "s_j\\in \\sigma[t , x , u]_{k - d_{t_j } } , q_j\\in \\sigma[x]_{r - d_{f_j } } } } ~ & \\varphi(0,x(0 ) ) \\\\ & \\hspace{-3 cm } \\frac{\\partial\\varphi(x , t)}{\\partial t } + \\nabla_x \\varphi(x , t)f(t , x , u ) + h(t , x , u ) = s(t , x , u)+ \\sum_{j=1}^{n_t } g_{t_j}(t , x , u)s_j(t , x , u ) \\\\ & \\hspace{-3 cm } \\varphi(x , t ) - h(x ) = -q(x)-\\sum_{j=1}^{n_f } g_{f_j}(x)q_j(x ) .",
    "\\end{split}\\ ] ] consider the right handsides of the first and second constraints in ( [ eq : sosocp ] ) .",
    "the first one is a polynomial non - negative on @xmath35 , while the second one is a polynomial non - positive on @xmath24 .",
    "in fact , both are putinar s sos representations of their respective left - hand - side @xcite . as a consequence ,",
    "every feasible solution @xmath9 of ( [ eq : sosocp ] ) is such that @xmath125 for all @xmath126 and @xmath127 suppose the ocp has a solution and consider an optimal control law @xmath128 which generates an optimal trajectory @xmath129 .",
    "therefore , the optimal value function is @xmath130 since a solution @xmath131 $ ] of the optimization problem ( [ eq : sosocp ] ) is differentiable , the fundamental theorem of calculus yields @xmath132 combining with the two preceding equations yields @xmath133 \\ ! + \\\\ \\quad [ \\int_t^t\\frac{\\partial\\varphi(\\bar x(\\theta),\\theta)}{\\partial \\theta } \\ ! + \\ ! \\nabla_x \\varphi(\\bar x(\\theta ) , \\theta ) f(\\theta , \\bar x(\\theta ) ,   \\bar u(\\theta ) ) \\ ! + \\ !",
    "h(\\theta , \\bar x(\\theta ) , \\bar u(\\theta ) ) d\\theta ] .",
    "\\end{array}\\ ] ] from ( [ eq : postraj ] ) and ( [ eq : posfin ] ) , both terms in square braces in the right handside of ( [ eq : intdiff ] ) are non - negative . therefore :    * @xmath134 and so , as in the moment formulation , one obtains a lower bound on the optimal value function .",
    "therefore , the sos formulation can be interpreted as the search of a smooth subsolution of the hamilton - jacobi - bellman optimality condition @xmath135 = 0\\ ] ] ( @xmath136 being the set of admissible input at @xmath137 ) . * if @xmath138 is small , both terms in the right handside of ( [ eq : intdiff ] ) are small .",
    "this implies that the integrand of the second term is small all along the trajectory .",
    "[ re : no_t ] so far we have discussed only ocps for which the value of @xmath36 is fixed .",
    "the moment approach also applies for problems with free terminal time and when the dynamics does not depend on @xmath45 . by bellman s principle of optimality ,",
    "the optimal value function does not depend on @xmath45 and so , in this case , the test functions are of the form @xmath139 and the occupation measure @xmath44 is on @xmath140 ( instead of @xmath141 .",
    "we next illustrate the effectiveness of the approach on a simple numerical example which also motivates the developments of the next section .",
    "[ ex : dint ] consider the double integrator @xmath142 with constraints @xmath143 and @xmath144 , @xmath145 .",
    "driving in minimum time @xmath146 any initial condition @xmath147 to the origin is an interesting test problem because an analytic solution is available @xcite . indeed , with @xmath148 ,",
    "@xmath149 consider the initial condition @xmath150 for which @xmath151 .",
    "to apply the moment approach , set @xmath152 and @xmath153 . solving the moment problem for different values of the degree @xmath61 yields the values 0.2 cm    [ cols=\"<,<,<,<,<\",options=\"header \" , ]     0.2 cm observe that for @xmath154 the performance of the control is rather satisfactory .",
    "although the gap is decreasing as expected ( if optimality could be reached the gap would be @xmath155 ) , the variation is really small .",
    "this is probably due to the fact that the current sdp solvers have some difficulties handling even medium size problems .",
    "figure [ fig : nonlinear ] shows the trajectories obtained for @xmath156 .    using the moment approach",
    "we can also show that the proposed control drives the state to the origin for every initial condition in @xmath157 .",
    "indeed , we consider the controlled system and the following problem : maximize @xmath158 under the constraint @xmath159 ( all the occupation measures and @xmath36 are undetermined ) . by solving this problem for @xmath160",
    ", we found an upper bound on the cost .",
    "since by linearization we can verify the origin is a local attractor , this upper bound implies that every trajectory starting from @xmath157 reaches the origin .",
    "this paper is a follow - up to @xcite where a sequence of lower bounds were derived for the optimal value of a polynomial optimal control problem ( ocp ) , following an occupation measure approach . in the current paper",
    ", we propose some techniques to constructively derive a control law from the solution of the convex linear matrix inequality ( lmi ) relaxations of the ocp .",
    "so our contribution can be seen as an extension to synthesis of the performance analysis results of @xcite .    generally speaking , we believe that the moment formulation of ocp is an appealing alternative to indirect methods based on lyapunov or hamilton - jacobi - bellman techniques .",
    "the moment formulation deals directly with systems trajectories .",
    "the resulting primal lmi moment problem admit a dual lmi sum - of - squares ( sos ) formulation which is , however , instrumental to the explicit computation of a control law . in this context , the nice interplay between functional analysis ( measure theory ) and algebraic geometry ( representation of polynomial positive on semialgebraic )",
    "may provide constructive answers to potentially difficult control synthesis problems .",
    "current limitations of the approach are as follows .",
    "first , as we are seeking a polynomial value function ( a smooth subsolution of the hamilton - jacobi - bellman equation ) that approximates the ( possibly non - smooth ) optimal value function @xmath161 , it may happen that precision deterioriates at points where @xmath161 is non - smooth .",
    "partitioning of the state - space , and/or iterative computation of the polynomial value function in a neighborhood moving along optimal trajectories ( like in example [ ex : dint_continuedbis ] ) could help address this issue , at the price of an increased computational burden .",
    "second , we are relying on the performance of current available general - purpose sdp solvers .",
    "semidefinite programming is a relatively young research field , and the degree of maturity of sdp solvers is far from that of , say , linear or convex quadratic programming solvers .",
    "more specifically , as far as we know , there is currently no numerically stable sdp solver , and no tractable estimate of the conditioning of an lmi problem .",
    "for example , it is expected that the choice of a basis to represent polynomials and moments has a significant impact on the problem conditioning , and hence on the numerical behavior of the solvers .",
    "third , the number of variables and constraints in the lmi problems grows quickly as a function of the number of state and input variables and the degree of the polynomial approximation of the value function .",
    "current general - purpose sdp solvers can deal with a few thousands variables and constraints , well below the dimensions of moment lmi problems corresponding to ocps with , say , 6 states and 2 inputs .",
    "for these reasons , dedicated primal - dual interior - point methods tailored to the specific quasi - hankel or quasi - toeplitz structure of moment lmi problems would be welcome .",
    "finally , we are currently working on a user - friendly ocp module for gloptipoly 3 @xcite , that helps formulating explicitly an ocp as a generalized problem of moments .",
    "the user only provides the polynomial data of the ocp , and the module automatically generates an approximate optimal control law .",
    "once it is ready and fully documented , the software will be freely available for download from the gloptipoly 3 webpage    www.laas.fr/@xmath162henrion/software/gloptipoly3",
    "this work was partly supported by project moga of the french national research agency ( anr ) , and by project no .",
    "102/06/0652 of the grant agency of the czech republic ( gar ) .",
    "j. b. lasserre , c. prieur , d. henrion , _ nonlinear optimal control : numerical approximations via moments and lmi relaxations .",
    "_ proceedings of the ieee conference on decision and control , seville , december 2005 ."
  ],
  "abstract_text": [
    "<S> we consider nonlinear optimal control problems ( ocps ) for which all problem data are polynomial . in the first part of the paper , we review how occupation measures can be used to approximate pointwise the optimal value function of a given ocp , using a hierarchy of linear matrix inequality ( lmi ) relaxations . in the second part </S>",
    "<S> , we extend the methodology to approximate the optimal value function on a given set and we use such a function to constructively and computationally derive an almost optimal control law . </S>",
    "<S> numerical examples show the effectiveness of the approach . </S>"
  ]
}