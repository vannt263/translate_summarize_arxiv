{
  "article_text": [
    "we define field variables with directional properties , and use them to show how to optimise both our understanding of pulse propagation and numerical simulations .",
    "simple plane - polarized versions of these were originally introduced by fleck @xcite , using @xmath0 .",
    "however , these were little used and the bulk of the paper primarily addressed generating ultra - short pulses by q - switched lasers , discussing numerical techniques and simulation results . here",
    "we derive wave equations and present results using generalised versions of these field variables .",
    "in the course of our investigations , we use these variables to illuminate several interesting features of @xmath1-propagated optical pulse simulations which are usually overlooked in a `` forward - only '' approximation .",
    "the main novelty of these new field variables is that they correspond to forward and backward directed energy fluxes ; and are constructed from combinations of the electric and magnetic fields , along with the properties of the propagation medium .",
    "i also derive wave equations describing the propagation of these field components , in fully vectorised and plane - polarized versions .",
    "in addition to these exact re - expressions of maxwell s equations , i also present second order and envelope - based wave equations for @xmath2 , in both stationary and moving frames .",
    "a further advantage of this approach is that it is as easy to include magneto - optic effects as electro - optics ones ( i.e. dispersion and nonlinearity ) .",
    "for example , i will later show that the plane polarized first order wave equations describing the @xmath1-propagation of @xmath2 in the spectral ( @xmath3 ) domain are ",
    "@xmath4   ~~   -    \\frac{\\imath \\omega \\alpha_r }         { 2 }    \\beta_c    *    \\left [ g ^+ - g^- \\right ] , \\label{eqn - intro - egpropag}\\end{aligned}\\ ] ] where @xmath5 contain the linear response of the medium , and @xmath6 contains nonlinearity that affects the electric field , and @xmath7 is its magnetic counterpart . using these forward and backward directed @xmath2 variables has three main advantages : +   the forward directed field variable @xmath8 is the appropriate physical choice to use when studying the forward propagating part of the field  as is the case for most pulse propagation investigations .",
    "+   because we can choose to simulate only the forward directed field variable @xmath8 , we have half the calculations to do , and hence gain a speed advantage . by using a @xmath1-propagated pssd algorithm@xcite",
    ", we also get a fast and flexible treatment of dispersive and nonlinear effects ; hence our simulations significantly outperform standard fdtd approaches",
    ". +   most other approaches ( even the recent @xcite ) assume the backward propagating parts of the field are negligible .",
    "since our @xmath9 describes the backward directed part , we have a clear and physically appropriate basis on which to calculate it , and hence can ( when appropriate ) rigorously justify the common forward - only approximation .",
    "we can do even better by changing to a co - moving frame .",
    "this simplifies the @xmath10 propagation , by removing the frequency - like oscillations , but has the price of making the @xmath11 oscillations faster .",
    "however , in the limit where we decide to approximate by ignoring the backward propagating @xmath11 part of the field , this price becomes irrelevant .",
    "fleck s definitions were brought to my attention by geoff new shortly after i started working with at imperial in 2001 . because they gave rise to additional @xmath12 terms in the polarization , when compared to standard forms , he wondered whether there was a link with the brabec and krausz derivation@xcite of similar - looking corrections to an envelope propagation equation . although it turns out that this was not the case , i continued working on the idea .",
    "at first i focussed on generating a second order wave equation of @xmath13 , in analogy to the one usually presented for the @xmath14 field .",
    "although i generalized my gfea derivation @xcite to include fleck - like terms , there seemed no practical use for the technique .    in 2002 a phd student in our group ( jca tyrrell ) started working on maxwell s equations solvers , and applying them to pulse propagation in nonlinear media .",
    "he developed the pssd method @xcite for solving maxwell s equations , where the field is held as a function of time and propagated forward in space .",
    "this is common in envelope - based nonlinear optics simulations , but had not been applied to full maxwell s solvers before .",
    "this got me thinking about representing maxwell s equations using @xmath13 , and put the project on track to being of practical use , although there were many outstanding questions on interpretation of the fields and the wave equations while trying to clarify these issues , i became aware of work by kolesik and co - workers @xcite ) , who projected out maxwell s equations into a directional form .",
    "their treatment motivated me on to vectorize the definitions , and get a phd student ( sbp radnor ) to start on simulations .",
    "as we worked on the paper eventually published as @xcite , i further generalised the definitions to include the longitudinal parts of the fields , fully developed the variant forms of the variables , and derived envelope versions of the wave equations .    as it stands , these kinds of directional wave equations , either using my @xmath13 variables , or the kolesik et.al .",
    "approach make traditional envelope theories based on the second order wave equation for @xmath14 utterly redundant .",
    "this is true even for the generalised ones such as @xcite which incorporate wideband corrections .",
    "directional wave equations simple provide propagation equations without introducing the many approximations inherent in theories based on second order forms , as are detailed exaustively in @xcite .",
    "this is treated in more detail in my report _",
    "`` field and envelope methods in nonlinear optics''_.    i am occasionally asked why i picked @xmath13 instead of ( e.g. ) @xmath15 to name these directional fields  after all , @xmath16 follows alphabetically from the electric field ( letter ) @xmath14 , and it is the first letter of fleck s surname , so it might seem the more obvious choice .",
    "unfortunately i ca nt remember why ; but there was a reason why i passed over @xmath16 , i think something to do with some other @xmath16 i was using at the time .",
    "i should have picked @xmath17 , anyway .",
    "kolesik et.al .",
    "@xcite also use not - dissimilar combinations of field variables .",
    "they introduce projection operators for the forward and backward parts of the field in their eqn ( kmm  1 ) , which i rewrite slightly using @xmath18 :   @xmath19 \\\\    \\mathscr{p}^{\\pm }     \\vec{h}(\\vec{k } ) & = &    \\frac{1}{2 }    \\left [      \\vec{h}(\\vec{k } ) )     \\pm        \\textrm{sgn}(kz ) \\frac{\\omega(k)}{k }       \\vec{u }         \\times \\vec{d } ( \\vec{k } )    \\right ] .\\end{aligned}\\ ] ]   they then use these , with maxwell s equations to generate their uppe in eqn ( kmm  7 ) :   @xmath20 .",
    "\\label{eqn - kolesik-7}\\end{aligned}\\ ] ]    there are three main difference compared with my generalised fleck - style @xmath13 approach .",
    "they :    1 .",
    ": :    describe things in terms of projection operators , 2 .",
    ": :    project out _ both _ a directional @xmath21 and a directional    @xmath22 , 3 .",
    ": :    construct their ( effective ) directional variables in a different ( but    related ) way .",
    "another difference is that , when implimenting a solution , they keep the _ time derivatives _ on the lhs , and manipulate the @xmath23 terms on the rhs ; so their uppe gives a time derivative of the field , and so their fields are propagated through time .",
    "this contrasts with my approach which keeps the @xmath24 on the lhs , and manipulates the time derivatives  hence my fields are propagated through space .",
    "their choice is ( most probably ) why they choose to work with the displacement field @xmath21 rather than @xmath14 . in the time domain ,",
    "the use of @xmath21 avoids the need for the @xmath25 convolution of the field with the permittivity , at least on the time - derivative side of the maxwell s equations .",
    "they ( presumably ) remove the space derivatives resulting from the @xmath23 terms when going into the spatial frequency ( @xmath26 ) domain , leading to the appearance of @xmath27 terms on the rhs .",
    "however it is not so easy to avoid complication when solving maxwell s equations .",
    "their use of @xmath21 simplifies the time derivative side , but there is a cost to pay on the space derivative ( @xmath23 ) side , where they need to reconstruct @xmath14 from @xmath21 ( see eqn ( dmn  2 ) ) , and similarly evaluate the nonlinearity ( see eqn ( dmn  3 ) ) .",
    "even then , just prior to eqn ( dmn  7 ) , kolesik et.al .",
    "explain how they go into the frequency domain anyway ! as an aside , they might easily have used @xmath28 and not @xmath22 in their equations , and so included the possibility of magnetic media in their model .",
    "in contrast , i leave the space derivative ( @xmath23 ) sides alone , and work with the time derivative side .",
    "this has the advantage that when i go into the frequency domain , the convolution becomes a simple product , and i do not have to resort to reconstructions of @xmath14 and @xmath29 .",
    "it is interesting to compare the `` @xmath30 '' uppe with my similar - looking `` @xmath31 '' eqn ( [ eqn - stationarygpropagation ] ) that follows later , where they neglect to introduce the advantages of a co - moving frame ( cf my eqn([eqn - movinggpropagation ] ) ) .",
    "see also [ ss - altfleck - vskolesik ] , where i attempt a conversion between my formulation and theirs .",
    "* summary : * maxwell - like theory with combined @xmath32-like variables , but no co - moving frame .",
    "temporal propagation only .",
    "this work @xcite is an extension of the method proposed in @xcite , and contains a variety of applications .",
    "it discusses both @xmath33 and @xmath1 propagated approaches , and includes decomposition into transverse modes .",
    "they develop an envelope version of their wave equation , but do not discuss using multiple envelopes .",
    "in general they only solves for @xmath14 , not both @xmath14 and @xmath22 separately , there is also no examination ( or calculation ) of the significance of backward propagating fields .",
    "they separate the polarization @xmath34 from displacement @xmath21 ; and includes current terms .",
    "see also [ ss - altfleck - vskolesik ] , where i attempt a conversion between my formulation and theirs .      in fidel et.al .",
    "1997 @xcite _ `` hybrid ray fdtd moving window approach to pulse propagation '' _ , they look at a variety of moving window and moving frame approaches to solving for pulse propagation with maxwell s equations using fdtd",
    ". they do introduce a co - moving frame , and derive the appropriate discretized maxwell s equations ; but they do not use combined @xmath14 and @xmath28 variables as done by fleck , and as done in the following sections here .",
    "* summary : * maxwell - like theory with co - moving frame , but no combined @xmath32-like variables .",
    "the @xmath36 fields i constuct here bear a superficial resemblance to beltrami variables @xcite , which are defined along the lines of @xmath37 .",
    "however , they differ in two important respects .",
    "first , for a given beltrami @xmath38 you immediately know what the component @xmath39 and @xmath40 fields are , whereas you require both @xmath36 to do the same .",
    "secondly , @xmath38 does not assume any preferred direction , whereas the construction of @xmath36 requires a direction @xmath41 to be chosen .",
    "it s interesting to wonder whether the @xmath42 approaches might generalise to something like @xmath43 ) .",
    "however , since @xmath44 is unique for a given @xmath14 and @xmath22 ; and @xmath45 is not unique without both components , so it s not obvious how it might work .",
    "note that some discussions of beltrami fields refer to `` force free '' systems , where @xmath46 , which are not ( as far as i can see ) applicable to an optics regime .",
    "14 natexlab#1#1bibnamefont # 1#1bibfnamefont # 1#1citenamefont # 1#1url # 1`#1`urlprefix[2]#2 [ 2][]#2    , * * , ( ) , http://link.aps.org/abstract/prb/v1/p84 .    , , , * * , ( ) .    , * * , ( ) , http://arxiv.org/physics/0611215 .    , , , * * , ( ) .    , * * , ( ) , http://link.aps.org/abstract/pre/v70/e036604 .    , , , * * , ( ) , http://link.aps.org/abstract/prl/v89/p283902 .    , * * , ( ) , http://link.aps.org/abstract/pra/v67/e023813 .    , * * , ( ) , http://link.aps.org/abstract/prl/v78/p3282 .    , * * , ( ) , http://arxiv.org/physics/0212014 .    , * * , ( ) , http://dx.doi.org/10.1006/jcph.1997.5827 .    , * * , ( ) , http://prola.aps.org/abstract/pre/v49/i6/p5722_1 .    , * * , ( ) .    , * * , ( ) .    , * * , ( ) .",
    "maxwell s equations describe propagation of the em field through a medium described by permittivity @xmath47 and permeability @xmath48 . in addition , it is common to add in a `` polarization '' term @xmath49 , which is used to relate the displacement field @xmath50 to @xmath39 in the usual way : @xmath51 . in my treatment , i hide this polarization inside the definition of @xmath47 ( writing instead just @xmath52 for the same system ) ; similarly any magnetic polarization would be hidden inside @xmath48 and not written out separately .",
    "note that i do make a split of the total permittivity ( and also the permeability ) into two pieces , a `` reference '' part and a `` correction '' part , and these will not necessarily be the same as the traditional division .    note 1 : i use the `` @xmath53 '' notation for convolutions @xmath54 .",
    "note 2 : quantities in the frequency domain are indicated by tildes .",
    "we first denote the linear response of the medium to be @xmath55 , and its nonlinear response to be @xmath56 .",
    "the nonlinear term may include some time response , such as e.g. @xmath57 .",
    "the effect of the total permittivity can be expressed in either the time domain or the frequency domain ( indicated by tildes ) .",
    "it is   @xmath58 similar expressions can be written down for the case of magnetic dispersion or magnetic nonlinearities ,   @xmath59    the definitions of @xmath60 ( and their generalized vector counterparts @xmath61 , introduced below ) depend on the properties of the propagation medium through the permittivity @xmath47 and permeability @xmath48 . in principle",
    "it might seem attractive to define @xmath61 using the exact values of @xmath62 ( including the nonlinearity ) , but we will usually want to be able to uniquely reconstruct the fields @xmath14 and @xmath22 from our new fields .",
    "we do this by including as much as possible of the dispersive properties in the reference parameters ( and hence the definitions of @xmath61 ) , leaving nonlinear properties ( and potentially some residual dispersion ) for correction terms . for example , if the true dispersion was multi - valued or zero in places , it is possible to define the reference to include an approximation to the true dispersion without those inconvenient properties , and use the correction term to compensate .",
    "the frequency domain is the starting point for calculating the necessary parameters .",
    "this is because the formulae are simplest in the @xmath3 domain , where any linear response is described using products rather than convolutions .",
    "this will mean that we calculate the time - domain parameters by ( back ) fourier transforming the frequency domain ones .",
    "the frequency domain definitions are   @xmath63 where the correction parameters @xmath64 and @xmath65 represent the discrepancy between the true values and the reference .",
    "the smaller these correction terms are , the better the match . by using these frequency dependent parameters in the generalized definitions of @xmath60",
    ", we will be able to propagate pulses using only the @xmath66 variable , a gain in both mathematical simplicity and computational speed .",
    "note that since the definitions of @xmath60 depend ( roughly speaking ) on the square roots of @xmath67 and @xmath68 , we have introduced the @xmath69 and @xmath70 parameters , which will feature prominently ( along with their time domain counterparts @xmath71 ) , in the generalized definitions of @xmath72 that follow .",
    "to recap , i split the medium properties into two parts :    * first , * there are the `` reference '' parts @xmath73 and @xmath74 .",
    "these are the contributions from the material properties which will be incorporated into the definition(s ) of @xmath2",
    ". these will only contain _ linear _ response terms , to guarantee we can reconstruct @xmath75 from @xmath13    * second , * there are the `` correction '' parts @xmath76 and @xmath77 , which will contain the difference between the chosen reference and the true behaviour of the material .",
    "these will only contain any _ nonlinear _ response terms , but may also contain an residual linear response also .",
    "we might also choose to split the correction terms up into more pieces ",
    "e.g. a dispersive part , and a nonlinear part : e.g. ,   @xmath78        in practise , therefore , calculation of an instantaneous nonlinear term will involve calculating @xmath90 , fourier tranforming ( denoted by @xmath91 ) the result , then dividing it by the ( possibly frequency dependent ) reference parameter @xmath92 .",
    "if the reference parameter @xmath92 is a constant , then the fourier transform is redundant and the nonlinear step can be handled while remaining entirely in the time domain .",
    "note that there is no way we can avoid convolutions if the reference @xmath92 contains any frequency dependence  even if our nonlinearity is instantaneous .",
    "this is because to calculate @xmath6 i have to remove the reference @xmath92 from @xmath64 ; since @xmath93 .",
    "here i go significantly further than fleck@xcite in two respects : i _ vectorise the definitions _ , and _ allow for dispersive effects_. an important addition is the inclusion of a longitudinal field component , which is required in order to retain a full vector description of the em field .",
    "originally i tried to generate a motivation for the directional @xmath13 fields described above by taking maxwells equations and moving to a co - moving frame .",
    "however , it seems now that while they certainly seem to describe parts of the field propagating in opposite directions , they do not seem tied to any particular choice of frame .    after a brief discussion of what fleck did ,",
    "i define a vector form @xmath61 of the fleck - style fields @xmath13 .",
    "this requires the definition of a `` direction of propagation '' denoted by the constant unit vector @xmath41 .",
    "i can then achieve the swapping of the transverse components of @xmath40 ( since @xmath94 ) by using the cross product of @xmath41 with the magnetic field variable @xmath40 .",
    "secondly i use `` reference '' material parameters which i use to construct my @xmath13 fields .",
    "this allows me to distinguish between the parameters used in my construction of @xmath13 from the actual material properties , which may be too complicated to use in that context .",
    "generally , i include all of the linear response of the medium in these reference parameters , which makes it easiest to define @xmath61 in the frequency domain .",
    "this is because the linear time - response convolution in the time - domain becomes a simple product in the frequency domain .",
    "a good ( accurate ) choice of reference medium for a particular problem will ensure that the contribution due to the backward directed part of the field ( @xmath95 ) is small .",
    "in general we would want the reference part to include as much about the material as is practicable , to ensure the smallest possible correction term(s ) for propagation .    note that whether or not the @xmath62 contain dispersion , we here restrict ourself to the case where they are _ scalar_. also , i let the _ argument _ of the vector field quantities tell us whether we are in the time or frequency domain , to avoid too much notational clutter . as a final note , in the following calculations",
    "the assumption will be made that the media are bulk , without ( implicit ) interfaces hidden in @xmath47 or @xmath48 .",
    "this means that @xmath96 is assumed .",
    "fleck defines a relative permittivity @xmath47 , and magnetic permeability @xmath48 in a dispersionless host medium ",
    "it is clear that these are relative parameters because he later defines @xmath97 as the refractive index of the of host medium ( just after eqn ( f1.4b ) ) .",
    "he allows for a conductivity @xmath98 ; and a polarization @xmath34 which characterises the active atoms and which may be amplifying or absorbing .",
    "the electric field is @xmath99 and the magnetic field @xmath100 . as usual",
    ", the speed of light @xmath101 is just related to the permittivity and permeability of the vacuum , i.e. @xmath102 .",
    "fleck simplifies plane polarised maxwell field equations , treating them only along the @xmath1 direction , resulting in his eqn.(f1.1a , b )   @xmath103    then fleck defines new combined em field variables @xmath104 in eqn.(f1.3 ) , but i write them @xmath2 to avoid confusion with the @xmath14 field variables .",
    "@xmath105    because of the relative phases of @xmath14 and @xmath22 in these definitions , if the the two fields @xmath10 and @xmath11 are constants multiplied by a standard exponentially oscillating carrier wave , they are associated with an energy flux ( i.e. poynting vector ) in opposite directions along the @xmath1 axis ; this will presumably also hold nearly true when replacing the constant amplitude with `` slowly varying '' pulse envelopes .",
    "see also section [ s - eflux ] .",
    "fleck uses his definitions to obtain equations of motion for his field variables @xmath10 and @xmath11 ( @xmath104 ) , recorded in his eqn.(f1.4 ) .",
    "they are   @xmath106    i now scale eqns.([fleck1.4a],[fleck1.4b ] ) ( fleck ( f1.4a , f1.4b ) ) , setting @xmath107 , @xmath108 , and @xmath109 . in the following , i will drop the prime ( @xmath110 ) marks and use @xmath32 for @xmath111 ( etc ) in order to reduce the visual clutter and make equations easier to read . _ for this subsection only _",
    ", from this point onwards each occurence of @xmath13 , @xmath34 , or @xmath98 should be understood to refer to the prime variables @xmath112 , @xmath113 & @xmath114  _ unless explicitly stated otherwise_. the scaled equations are   @xmath115      the `` standard '' definition for directional fields handles the electric field @xmath14 most easily ; although rather non - intuitively we will find that it makes it hard to include longitudinal @xmath14 components . fortunately ,",
    "other definitions are possible , and these follow the standard `` primary @xmath39 '' definition presented next in subsection [ ss - definitions - vector ] , in subsections [ ss - definitions - vectorh ] , [ ss - definitions - vectord ] , and [ ss - definitions - vectorb ] .",
    "use of an alternative definition can protentially shift the non - transverse effects to a field variable where it causes less trouble .",
    "note that circularly polarized forms can be generated for all types the same way as is described for primary-@xmath39 type @xmath36 variables in subsubsection [ sss - definitions - vector - circularpolarization ] .",
    "these alternative expressions are represented only in the frequency domain ; time domain forms are presented for primary-@xmath39 only ; for the other forms it is a simple matter to construct their time domain representation . in the case of dispersionless reference media ( i.e. constant @xmath116 )",
    ", the time and frequency forms look very similar .",
    "the set of alternative definitions was ( partly ) inspired by pdd suggesting ( private communication , 24 february 2003 ) trying alternative combinations  such as swapping @xmath21 for @xmath14 and/or @xmath28 for @xmath22 .",
    "definition : thf  transverse @xmath22 ( magnetic intensity ) field ( i.e. @xmath123 ) .",
    "a derivation of the wave equations using this form is in section [ s-1stordere ] .      in the normal description of em ,",
    "the divergence @xmath124 .",
    "however the picture here is based on @xmath39 , so we need a way to construct @xmath50 from @xmath39 .",
    "we follow the following iterative procedure , which should work for the usual case of weak nonlinearities   @xmath125 \\\\ & = &    \\tilde{\\alpha}_r^{-2 } \\vec{d}(\\omega )   -    \\tilde{\\alpha}_r^{-3 } \\tilde{\\alpha}_c *   \\vec{d}(\\omega )   +     \\tilde{\\alpha}_r^{-2 } \\tilde{\\alpha}_c * \\tilde{\\alpha}_c *   \\vec{e}(\\omega ) \\\\ & = &    \\tilde{\\alpha}_r^{-2 } \\vec{d}(\\omega )   -    \\tilde{\\alpha}_r^{-3 } \\tilde{\\alpha}_c *   \\vec{d}(\\omega )   +     \\tilde{\\alpha}_r^{-2 } \\tilde{\\alpha}_c * \\tilde{\\alpha}_c *    \\left [      \\tilde{\\alpha}_r^{-2 } \\vec{d}(\\omega )     -      \\tilde{\\alpha}_r^{-1 } \\tilde{\\alpha}_c *   \\vec{e}(\\omega )    \\right ] \\\\ & = &    \\tilde{\\alpha}_r^{-2 } \\vec{d}(\\omega )   -    \\tilde{\\alpha}_r^{-3 } \\tilde{\\alpha}_c *   \\vec{d}(\\omega )   +     \\tilde{\\alpha}_r^{-4 } \\tilde{\\alpha}_c * \\tilde{\\alpha}_c * \\vec{d}(\\omega )     -      \\tilde{\\alpha}_r^{-3 }       \\tilde{\\alpha}_c * \\tilde{\\alpha}_c * \\tilde{\\alpha}_c *      \\vec{e}(\\omega ) \\\\ & = &    \\sum_{i=0}^{\\infty }      \\tilde{\\alpha}_r^{-2-i }      \\left [ - \\tilde{\\alpha}_c * \\right]^i      \\vec{d}(\\omega)\\end{aligned}\\ ] ]      it is worth noting that in the alternative constructions following this `` primary @xmath39 '' one , it is far simpler to calculate the divergence . in any case",
    ", we can now write the divergence of @xmath127 as follows   @xmath128   ~~   \\mp    \\tilde{\\beta}_r     \\vec{u } \\cdot       \\vec{j } .\\end{aligned}\\ ] ]    thus i never use the ( no monopoles condition ) @xmath129 . clearly , if @xmath61 are pure transverse ( not just thf , which is built into the definition , but no longitudinal @xmath14 fields either ) , then   @xmath130        handling circularly polarized light is easy using @xmath36 fields .",
    "just as for @xmath14 and @xmath22 fields , you define   @xmath132    we get   @xmath133    \\cos ( \\omega t )   +    \\vec{y }    \\left [ e_y \\pm h_x \\right ]    \\cos ( \\omega t - \\phi ) \\\\",
    "\\vec{g}^\\pm & = &    \\vec{x }    g_x^\\pm    \\cos ( \\omega t - \\phi )   +    \\vec{y }    g_y^\\pm    \\cos ( \\omega t)\\end{aligned}\\ ] ]    similar definitions will hold for choices other than the standard `` primary @xmath39 '' @xmath36 fields .",
    "assume   @xmath134    compare with the results we get from an @xmath14 carrier - based approach   @xmath135        we would do this so that the magnetic terms not included in the reference medium ( i.e. in the definitions of @xmath137 ) would lose the non - transverse correction terms ( see later ) , although terms like those would then appear on the electric terms ( and i would define a transverse electric fields ( tef ) approximation instead ) .",
    "a derivation of the wave equations using this form is in section [ s-1storderh ] .",
    "here we need to calculate @xmath138 from @xmath40 , giving us something like @xmath139 ; just as for the primary @xmath39 form where we needed to calculate @xmath50 from @xmath39 .",
    "however , rather than repeat an almost identical calculation , i simply note that @xmath129 ( no magnetic monopoles ) , which will cause the term to vanish anyway .",
    "the divergence calculation is   @xmath140 .\\end{aligned}\\ ] ]    so no longitudinal magnetic intensity field @xmath22 means zero divergence .",
    "clearly , if @xmath141 are pure transverse ( not just tef , which is built into the definition , but no longitudinal @xmath22 fields either ) , then the divergence is zero .",
    "we would do this so that the displacement field ( and magnetic fields ) could be easily reconstructed from @xmath143 ; and , in analogy to the thf and tef mentioned above , we would use a transverse magnetic @xmath28 field approximation ( tbf ) .",
    "a derivation of the wave equations using this form is in section [ s-1storderd ] .",
    "@xmath144    ~~   \\mp    \\tilde{\\beta}_r^{-1 }    \\tilde{\\beta}^2      \\vec{j } ( \\omega ) .\\end{aligned}\\ ] ]    thus i never use the ( no monopoles condition ) @xmath129 .",
    "clearly , if @xmath145 are pure transverse ( not just tbf , which is built into the definition , but no longitudinal @xmath21 fields either ) , then the divergence is depends only on the charge density   @xmath146    nb :   @xmath147    ~~    -    2    \\tilde{\\beta}_r^{-1 }    \\tilde{\\beta}^2      \\vec{j}\\end{aligned}\\ ] ]        in analogy to the thf and tef mentioned above , we would use a transverse displacement field approximation ( tdf ) .",
    "a derivation of the wave equations using this form is ( not yet ) in section [ s-1storderb ] .",
    "@xmath149 .\\end{aligned}\\ ] ]    clearly , if @xmath150 are pure transverse ( not just tdf , which is built into the definition , but no longitudinal @xmath28 fields either ) , then the divergence is zero .",
    "( needs updating with alteration of @xmath16 , @xmath151 definitions at 20050727/8 )      barring my dropping of the @xmath153 factor , their @xmath154 can clearly be identified with my `` primary @xmath21 '' formulation of directional fields ( see [ ss - definitions - vectord ] ) .",
    "of course , there are differences , notably that their dispersion is only applied to the magnetic field ( either @xmath22 or @xmath28 ) ; my `` primary @xmath14 '' formulation applied @xmath47 dispersion to @xmath14 only , and @xmath48 dispersion to @xmath22 only .",
    "they also present an equation for a directional @xmath22 which corresponds to the `` primary @xmath28 '' form ( @xmath151 ) as opposed to the @xmath21 ( @xmath16 ) one .",
    "it is often useful to transform the following wave equation derivations into a moving frame .",
    "the frame will be defined by the speed @xmath155 in analogy to the reference and correction parameters above .",
    "a sensible choice of @xmath156 is probably helpful , e.g. @xmath157 or possibly @xmath158 , the pulse group velocity .",
    "the ( non relativistic ) @xmath1-direction frame translation itself is   @xmath159    so that   @xmath160    when doing vector calculations , i will need a vector form of the frame translation .",
    "i use   @xmath161    assuming @xmath41 is along the @xmath1-direction ",
    "@xmath162    i will often find it useful to define the ratio of the reference and frame speeds :   @xmath163    this moving frame is very useful in a space - propagated model since the pulse is held as a function of time , and so it will stay ( nearly ) centered while propagating forward .",
    "although it has no sensible limit as the frame speed tends to zero , we can recover that case by setting @xmath164 ( or @xmath165 ) and rewriting the primed variables as unprimed ones .      in the frequency domain ,",
    "the space derivative transforms like   @xmath166    which seems to leave open the intriguing possibility of a _ frequency _ dependent ( `` dispersive '' ) moving frame by allowing @xmath167 and @xmath168 a frequency dependence .",
    "i could put _ all _ the linear evolution in the reference , and match it to the frame ( so that @xmath169 and @xmath170 and @xmath171 ) .",
    "this means that the only alterations to the pulse profile would be those due to nonlinear effects .    we might hope to use a dispersive frame in the following way .",
    "imagine a pulse being propagated in a strongly dispersive medium with some nonlinearity ; and that the pulse might be expected to broaden by a large factor of ( e.g. ) twenty during propagation .",
    "this would mean we would need a much wider time window in our simulation than suggested by the initial pulse width . in a dispersive frame matched to a dispersive reference medium ,",
    "our simulated pulse would not broaden _ at all _ due to dispersion , so we then hope retain a narrow time window throughout the simulation , hence saving computer time .",
    "the drawback is that our nonlinear term absorbs the reference dispersion , and this may cause significant pulse broadening of itself , perhaps of similar extent to the dispersion would .",
    "assuming it did give an advantage , at the end of the simulation we would have to take our dispersive - frame pulse and convert back to a non - dispersive frame to see the `` lab '' pulse profile .",
    "fortunately the computational cost of this conversion is minimal .",
    "weiglhofer and lakhtakia @xcite present a number of quantities related to the em field using their beltrami style definitions .",
    "if i rearrange the factors of @xmath48 s and @xmath47 , i might rewrite these as   @xmath172    analogously , and since we use @xmath173 the curl-@xmath22 equation ( which has @xmath21 , @xmath174 on the rhs ) ",
    "@xmath175    it might also be interesting to construct beltrami - like combinations of the directional @xmath13 fields , i.e.   @xmath176      if i define a velocity @xmath177 , there is a curious similarity between the force on a moving charge and the construction of my @xmath178 field variable .",
    "we have ",
    "@xmath179    so if @xmath180 ,   @xmath181    this seems to be a remarkable coincidence !",
    "here i derive coupled wave equations for the @xmath36 fields defined in [ ss - definitions - vector ] .",
    "i also discuss how things look in various frames of reference , and in subsection [ ss-1stordere - gstationaryvector ] generate first - order differential equations for forward and backward propagating fields . in the following",
    "i do not introduce any envelope - carrier decomposition for the field variables ; although the introduction of a moving frame plays a related role .",
    "note that the vector stationary frame subsection ( [ ss-1stordere - gstationaryvector ] ) also contains the plane - polarized special case , as well as a transformation to the moving frame as well ; and should be considered to contain the authoritative results .",
    "note there are still some sign discrepancies between the vector calculations and the plane polarized ones .",
    "note that is better to follow the ( authoritative ) vector stationary frame derviation ( see [ ss-1stordere - gstationaryvector ] ) instead . however , his is a simpler derivation that gives a nice overview of the approach .",
    "it is superceeded by the full vectorized ( and moving - frame ) derivation(s ) below .",
    "i begin with the source - free maxwell s equations ",
    "@xmath182    because the convolutions @xmath183 and @xmath184 complicate the analysis , i will fourier transform into the frequency domain where their linear parts become simple products . using the definitions in subsection [ s - medium ] , and carelessly dropping the tildes off the @xmath185 and @xmath186 parameters ,",
    "i can proceed with the calculation ",
    "@xmath187   +    \\imath \\omega    \\beta_r \\alpha_c *     \\left [      \\alpha_r \\tilde{e_x }    \\right ] \\label{eqn - defs - noframes - dbh } , \\\\",
    "\\frac{\\partial } { \\partial z }    \\alpha_r   \\tilde{e_x } & = &    \\imath \\omega \\alpha_r   \\beta_r     \\left [      \\beta_r   \\tilde{h}_y    \\right ]   +    \\imath \\omega      \\alpha_r   \\beta_c *    \\left [      \\beta_r   \\tilde{h}_y    \\right ] \\label{eqn - defs - noframes - dae}\\end{aligned}\\ ] ]    adding and subtracting eqns .",
    "( [ eqn - defs - noframes - dbh ] , [ eqn - defs - noframes - dae ] ) , and using the fourier transform of the definitions for @xmath188 , we get   @xmath189    the `` non - magnetic '' limit ( strictly , no magnetic corrections to the frame ) , where @xmath190 is   @xmath191    the reference - only limit of the above equations ( with @xmath192 ) is exactly as you would expect ( see eqn.([eqn - defs - frames - vgplusminus ] ) ) ",
    "@xmath193    clearly , even if @xmath194 , both @xmath10 and @xmath11 evolve on similar scales , as specified by the leading rhs term .",
    "it is interesting to compare kolesik et.al.s",
    "eqn(kmm  7 ) ( i.e. ( [ eqn - kolesik-7 ] ) ) with my eqn ( [ eqn - stationarygpropagation ] ) above .",
    "of course their equation has the @xmath195 terms projected out , but otherwise the two are similar in form .      here",
    "i avoid calculations using the @xmath196 , and @xmath1 components of the field , and retain a fully vector description . using the definitions in subsection [ s - medium",
    "] , i can proceed with the calculation ",
    "@xmath197    the vector @xmath36 fields ( defined in eqn ( [ eqn - s - defs - gvector ] ) ) are   @xmath198    this means i need to convert both the second term on the lhs of the sum - and - difference equation above , as well as the rhs .",
    "it is most imortant for the lhs to be simple , because this will define the type of propagation specified by the rhs . to convert the lhs",
    ", we need two vector identities , as used in subsection [ s - vectorid ] to get eqn.([eqn - vectorid - combined ] ) . so using   @xmath199              we see from the following [ sss-1stordere - longitudinal ] that these two equations are sufficient to describe the fields as long as there is no longitudinal @xmath39 component ( i.e. @xmath36 is transverse ) or longitudinal @xmath208 ( also with reference to the divergence calculation in [ sss - definitions - vector - divergence ] ) .      taking",
    "the @xmath173 of the @xmath209 equation removed a part of the field dynamics lying in the direction of the propagation vector @xmath41 .",
    "this part also include the response to longitudinal currents . to rectify this omission , we take the dot product with @xmath41 . using the standard vector identity eqn.([eqn - vectorid - i-7 ] ) :   @xmath210 and using @xmath211 ; we get   @xmath212    \\right )   +    2    \\alpha_r \\beta_r    \\vec{u }     \\cdot    \\vec{j } \\label{eqn-1stordere - statframe - longitgraddot}\\end{aligned}\\ ] ]    this is the same as the source - free divergence - difference equation seen in [ sss - definitions - vector - divergence ] ; where we see that both parts of the lhs are zero if @xmath213 and @xmath214 .",
    "* plane polarized & magnetic ( @xmath217 ) : *    the @xmath218 components of the lhs and rhs contain the @xmath219 values  as a result of the curl and cross - products respectively .",
    "compare the previous stand - alone calculation in eqn.([eqn - stationarygpropagation ] ) to   @xmath220   ~~   -    \\frac{\\imath \\omega \\alpha_r }         { 2 }    \\beta_c   *    \\left [ g_x ^+ - g_x^- \\right ] \\label{eqn-1stordere - propagation - planepol}\\end{aligned}\\ ] ]    this contains a single sign discrepancy compared to eqn ( [ eqn - stationarygpropagation ] ) ; the rhs has the opposite sign .",
    "nb : recheck curl / cross - product component signs ? ( checked ok 20041028 )    * vector moving frame , transverse , magnetic : *      this agrees with the standalone vector moving frame calculation in the transverse case ( see subsection [ ss-1stordere - gmovingvector ] ) ; which culminates in eqn ( [ eqn - ss-1stordere - movingvector ] ) .",
    "i use the transverse case ( not the general ) to avoid the moving - frame altered @xmath224 that occurs in one of the terms .    * plane polarized moving frame , magnetic : *    this is just a special case of the above vector moving frame equation ",
    "@xmath225   ~~   -    \\frac{\\imath \\omega \\alpha_r }         { 2 }      \\beta_c    *      \\left [ g_x^+ - g_x^- \\right]\\end{aligned}\\ ] ]    this has sign conflicts with the stand - alone calculation in subsection [ ss-1stordere - gmoving ] which culminates in eqn ( [ eqn - movinggpropagation ] ) .",
    "* beltrami - like form : *    this might be written   @xmath226 where @xmath227 is a `` source '' term , but note that actually it will be some complicated function of @xmath36 .",
    "note the @xmath228 prefactors on the rhs s  these trivially convert ( @xmath229 ) to a wavevector prefactor @xmath230 , as would be expected for this kind of spatially propagating description .",
    "inspection of the equations shows that even if ( e.g. ) @xmath10 starts identically equal to zero , that it will pick up some value due to the interaction of the @xmath11 components with the non - vacuum part of the permittivity .",
    "however , so as long as @xmath194 , the transfer will be slow , and because of the leading @xmath231 term , @xmath10 will rapidly oscillate . as a result",
    ", we can assume ( in an appropriate limit ) that any @xmath10 contribution to the evolution of @xmath11 will spatially average to zero in a kind of rotating wave approximation ( rwa ) , although we should properly define criteria for `` slow transfer '' and `` rwa ''    one approach that would avoid throwing away the backward propagating terms would be to describe the @xmath10 field with the reverse frame transformation . whilst this would result in some inconvenience ,",
    "when simulating numerically it could be useful in that fields propagating in the unimportant direction could be thrown away only once they had ceased overlapping with the range covered by the pulse travelling in the important direction .",
    "note : in this example calculation , the convolutions required for the nonlinearity are not explicitly included in the notation .",
    "this does not affect the result , as long as they are reinserted correctly in the final equations .        adding and subtracting eqns .",
    "( [ eqn - defs - frames - dbh ] , [ eqn - defs - frames - dae ] ) , and using the fourier transform of the definitions for @xmath188 , we get   @xmath234    the `` non - magnetic '' limit , where @xmath235 is   @xmath236    the reference limit of the above equations ( with @xmath192 ) when the frame is matched to the reference @xmath157 is exactly as you would expect , given that the new frame is moving in the direction of the @xmath11 component , and since the pulse does not evolve ( relative to its centre ) in a vacuum , @xmath237 is zero ( see eqn.([eqn - defs - frames - vgminus ] ) ) .",
    "conversely , the @xmath10 component is moving the opposite way to our frame at @xmath101 , thus relative to the frame it moves at @xmath238 , hence the derivative is double that in a stationary frame ( see eqn.([eqn - defs - frames - vgplus ] ) ) .",
    "@xmath239      note : in this example calculation , the nonlinear convolutions are not explicitly included in the notation .",
    "this does not affect the result , as long as they are reinserted correctly in the final equations .",
    "the vector @xmath36 fields ( defined in eqn ( [ eqn - s - defs - gvector ] ) ) are   @xmath198    this means i need to convert both the second term on the lhs of the sum - and - difference equation above , as well as the rhs .",
    "it is most imortant for the lhs to be simple , because this will define the type of propagation specified by the rhs . to convert the lhs",
    ", we need two vector identities , as used in subsection [ s - vectorid ] to get eqn.([eqn - vectorid - combined ] ) .",
    "so using   @xmath199    warning !",
    "these are moving frame @xmath224 s arriving from the vector identities ! !",
    "note that the non - transverse corrections depend only on the _ magnetic _ field @xmath40 .",
    "i assume this is a curiousity of the chosen @xmath32 definition , as ( i think ) choosing @xmath245 would produce non - transverse corrections depending on the electric field .",
    "as yet i do not have a simple vectorised form for calculating @xmath22 purely in terms of @xmath32 s without these non - transverse corrections occuring .",
    "consider a plane polarized field propagating through a non - magnetic medium .",
    "i choose a stationary frame , and a dispersionless linear reference ( so @xmath250 are constants ) .",
    "the permeability of the medium is the vacuum value @xmath251 , and the permittivity has three contributions : a vacuum ( reference ) @xmath252 , a linear dispersion @xmath253 , and an instantaneous nonlinearity @xmath56 .",
    "the medium properties are therefore broken down in the following fashion    @xmath254    we can see here that choosing a dispersive reference medium would modify both the dispersive correction and the nonlinear term .",
    "i m the nonlinear case , this adds a time dependence which did not previously exist , which would increase the computational effort needed if the nonlinearity @xmath255 was instantaneous .",
    "the first order evolution equation , using the parameter definitions at eqns.([eqn - defs - alphax ] , [ eqn - defs - betax ] ) ) , is   @xmath256 \\\\ & = &   \\mp     \\imath \\omega     \\tilde{\\alpha}_r \\tilde{\\beta}_r          \\left ( 1 \\mp \\xi \\right )    ~    g_x^\\pm   ~~   \\mp     \\frac{\\imath \\omega \\tilde{\\alpha}_c^d \\tilde{\\beta}_r }         { 2 }    \\left [ g_x^+ + g_x^- \\right ]   ~~",
    "\\mp     \\frac{\\imath \\omega \\tilde{\\beta}_r }         { 2 }    \\tilde{\\alpha}_c^{nl }     *    \\left [ g_x^+ + g_x^- \\right]\\end{aligned}\\ ] ]    this has three terms  a reference carrier - oscillation - like term ( @xmath257 ) , a linear dispersion term ( @xmath258 ) , and a nonlinear polarization term ( @xmath259 ) . the straightforward way of solving this using a split step method , where each contribution is considered to be relatively weak , hence we solve the above in three steps .",
    "each one integrates forward a distance @xmath260 , but since we do one after the other ( rather than doing them simultaneously ) , the procedure is only accurate to first order ",
    "but for small enough @xmath260 , the error can be assured negligible .",
    "the reference term just applies a complex rotation to the field in frequency space , which can be calculated exactly ",
    "@xmath261 \\label{eqn-1stordere - example1-g1 } .\\end{aligned}\\ ] ]    this will have no effect if we choose the frame velocity to be the same as the phase velocity of the reference medium .",
    "this might seem to differ from the usual @xmath14 field approaches , where choosing the frame velocity to match the group velocity gives the best cancellation of propagation terms .",
    "however , remember that the way we have chosen our reference medium ( in this example ) means that group velocity corrections appear in the second rhs term as part of @xmath262 . choosing a frame velocity equal to the group velocity here will leave a residual reference - like term , but this",
    "can then cancel with part of the group - velocity - like contribution from the dispersion term , which in most cases would give the best cancellation  just as in the usual @xmath14 field approaches .",
    "if we wanted , we could easily rearrange eqn.([eqn-1stordere - example1-g1 ] ) to incorporate such a cancellation , and then solve the equation appropriately .",
    "the next step is solving for the linear dispersion @xmath263 in the frequency domain .",
    "fortunately , this part of the equation is ( also ) trivial to solve exactly in the frequency domain , and results in the following exponential solution ",
    "@xmath264        .        \\delta",
    "z      \\right ] .\\end{aligned}\\ ] ]    although both reference and dispersion steps can be solved exactly using exponentials , there is an important difference .",
    "the reference evolution of @xmath10 depends only on @xmath10 , whereas the dispersion evolution depends on the sum @xmath265 , since the dispersion acts on the electric field . in the forward - only approximation , of course",
    ", @xmath266 and the two steps can be trivally combined  as is automagically done in most approaches solving for the propagation of optical pulses .",
    "the final ( third ) step is to transform into the time domain and solve for the @xmath81-th order nonlinear effects .",
    "since our reference @xmath250 are constants , @xmath267 is trivial to calculate and will be just @xmath268 , so ( for a simple euler method integration )   @xmath269^n    \\delta z\\end{aligned}\\ ] ]    for a narrow - band field , the time derivative would be dominated by ( proportional to ) its centre frequency ; and indeed in most envelope theories we only see a factor of ( carrier frequency ) @xmath270 in the analogous expression . for a wider - band field , there would be corrections , as found for the gfea approach @xcite .    in an envelope theory ,",
    "the time derivative would be dominated by the carrier frequency @xmath270 , hence we would only see a factor of @xmath270 rather than the differential here .",
    "a few - cycle envelope theory would give us corrections to the @xmath270 prefactor .",
    "if you wanted to , the derivative used in this nonlinear step could be calculated in the spectral domain ",
    "you d have to ft @xmath32 into the time domain , raise it to the @xmath81-th power , and ft back ...      here",
    "i describe how to make the `` best matched '' initial conditions for @xmath13 describing a pulse propagating _ only _ in the `` + '' direction .",
    "note that it may be helpful to read section [ s - interpretations ] if you are confused by the use of terms like `` pseudo - reflection '' or by the meaning of the co - propagating @xmath11 component .",
    "the procedure is :    \\(1 ) pick a suitable electric field @xmath271    \\(2 ) find out the full dispersive properties of the medium , as described by @xmath272 and @xmath273 .",
    "you can even put the nonlinear or any other properities into @xmath272 and @xmath273 as well  but only if you will still know how get a solution for steps ( 3 ) and ( 5 ) below with those added complications .",
    "\\(3 ) calculate the @xmath274 corresponding to @xmath271 for a `` + '' propagating pulse :   @xmath275    \\(4 ) choose our reference medium parameters @xmath276 and @xmath277 .",
    "\\(5 ) calculate our initial @xmath13 for the chosen reference medium , given our initial @xmath271 and @xmath274 fields .",
    "@xmath278    e(\\omega ) .\\end{aligned}\\ ] ]    these @xmath13 initial conditions are the best guess we can make for a `` + '' propagating pulse in our medium .       note that in step ( 3 ) above , i have ( in effect ) used the definition of @xmath13 with a `` reference '' equal to the full dispersive properties of the medium , and achieved a `` + '' propagating pulse by setting @xmath11 to zero . in the case where we intend to use these full dispersive properties as or simulation reference , of course step ( 5 ) becomes trivial .    because our reference @xmath279 will not ( in general ) include all the dispersion @xmath280 , our initial conditions will contain both a @xmath10 and a @xmath11 part .",
    "this initial @xmath11 part will co - propagate along with the @xmath10 , the combination being a ( hopefully ) good match to the medium .",
    "if our `` full '' dispersion @xmath280 are not a perfect match to the simulated medium , then there will be an initial pseudo - reflection .",
    "this pseudo - reflection will consist of a reverse propagating @xmath11 , whose size will be equivalent to that of the reflection from an interface between the dispersion used to construct the initial conditions and the simulated medium ( with @xmath281 )",
    ". mostly this kind of pseudo - reflection can be eliminated with appropriate choice of @xmath280 ; although nonlinear corrections will usually be impossible to treat , and so will still cause pseudo - reflections ",
    "albiet hopefully very small ones .",
    "for example , if we construct our initial conditions using a vacum @xmath282 , but simulate a medium with some refractive index @xmath81 , this will be equivalent to simulating a @xmath283 interface .",
    "such an interface will cause a ( pseudo ) reflection , which will consist of a reverse propagating @xmath11 , whose size will be equivalent to that of the reflection from a vacuum/@xmath81 interface . a mirror image of the pseudo - reflection will also appear , and co - propagate with the @xmath10 pulse  to ensure that the tramsmitted @xmath14 field has reduced appropriately for such an interface .",
    "note that the `` forward ( co ) propagating '' @xmath11 component still has a poynting vector directed _",
    "backwards_.      here i do the simplest possible comparison between two different implementations of the same physical system ; and see that ( within the limits set by the approximaions ) that they are identical . in the uncoupled stationary frame ( @xmath10 only )",
    "case , the wave equation with only a reference @xmath284 term is   @xmath285^{1/2 }    \\beta_r     ~    g_x^+ \\\\ & = &   \\mp     \\imath \\omega     \\alpha_r \\beta_r     \\left [      1     +      \\alpha_l / \\alpha_r    \\right]^{1/2 }    ~    g_x^+ \\\\ & \\approx &   \\mp     \\imath \\omega     \\alpha_r \\beta_r     \\left [      1     +      \\frac{1 }           { 2 }      \\alpha_l / \\alpha_r    \\right ]    ~    g_x^+ \\\\ & = &   \\mp     \\imath \\omega     \\left [      \\alpha_r \\beta_r      +      \\frac{1 }           { 2 }      \\alpha_l \\beta_r    \\right ]    ~    g_x^+ \\\\ & = &   \\mp     \\imath \\omega     \\alpha_r \\beta_r     ~    g_x^+   ~~   \\mp     \\frac{\\imath \\omega \\alpha_l \\beta_r }         { 2 }    g_x^+\\end{aligned}\\ ] ]    this is identical to the equivalent wave equation with both a reference and correction term , with the two sets of @xmath185 parameters linked by the appropriate relation @xmath286 . the uncoupled approximation ( no @xmath11 i.e. @xmath287 ) and small correction ( @xmath288 ) are true in the same regime .",
    "here i avoid calculations using the @xmath196 , and @xmath1 components of the field , and retain a fully vector description . using the definitions in subsection [ s - medium ] ,",
    "i can proceed with the calculation ",
    "@xmath290    the vector @xmath137 fields ( defined in eqn ( [ eqn - s - defs - gpvector ] ) ) are   @xmath291    this means i need to convert both the second term on the lhs of the sum - and - difference equation above , as well as the rhs .",
    "it is most imortant for the lhs to be simple , because this will define the type of propagation specified by the rhs . to convert the lhs",
    ", we need two vector identities , as used in subsection [ s - vectorid ] to get eqn.([eqn - vectorid - combined ] ) . so using   @xmath199        so",
    ",   @xmath294      \\vec{u }     ~~     -      \\beta_r \\alpha^2       *      \\left (        \\vec{u } \\times \\left [ \\vec{u } \\times \\vec{e } \\right ]      \\right )     ~~     \\mp       \\alpha_r \\beta^2       *      \\left [ \\vec{u } \\times \\vec{h }   \\right ]    \\right\\ }   \\mp    \\nabla \\left ( \\vec{u } \\cdot \\alpha_r \\vec{e } \\right )   ~~   +   ~~    \\beta_r \\vec{j } \\\\ & = &   +    \\imath \\omega     \\left\\ {      \\beta_r \\alpha^2       *      \\vec{u } \\times \\left [ \\vec{u } \\times \\vec{e } \\right ]     \\pm      \\alpha_r \\beta^2       *      \\left [ \\vec{u } \\times \\vec{h } \\right ]    \\right\\ }   ~~   -    \\imath \\omega       \\beta_r \\alpha^2       *      \\left [        \\vec{u }",
    "\\cdot \\vec{e }      \\right ]      \\vec{u }   ~~   \\mp    \\nabla \\left ( \\vec{u } \\cdot \\alpha_r \\vec{e } \\right )   ~~   +   ~~    \\beta_r \\vec{j}\\end{aligned}\\ ] ]        we see from the following [ sss-1storderh - longitudinal ] that these two equations are sufficient to describe the fields as long as there is no longitudinal @xmath40 component ( i.e. @xmath137 is transverse ) ; ( also with reference to the divergence calculation in [ sss - definitions - vectorh - divergence ] ) .      taking",
    "the @xmath173 of the @xmath297 equation removed a part of the field dynamics lying in the direction of the propagation vector @xmath41 . to rectify this omission , we take the dot product with @xmath41 . using the standard vector identity eqn.([eqn - vectorid - i-7 ] ) :   @xmath210 and using @xmath211 ; we get   @xmath298   \\right)\\end{aligned}\\ ] ]    this is the same as the divergence - difference equation seen in [ sss - definitions - vectorh - divergence ] ; where we see that both parts of the lhs are zero if @xmath299 .",
    "* plane polarized & magnetic ( @xmath217 ) : *    the @xmath218 components of the lhs and rhs contain the @xmath219 values  as a result of the curl and cross - products respectively .",
    "compare the previous stand - alone calculation in eqn.([eqn - stationarygpropagation ] ) to   @xmath301   ~~   -    \\frac{\\imath \\omega \\alpha_r }         { 2 }    \\beta_c   *    \\left [ { g_x ' } ^+ - { g_x'}^- \\right]\\end{aligned}\\ ] ]    * vector moving frame , transverse , magnetic : *      * plane polarized moving frame , magnetic : *    this is just a special case of the above vector moving frame equation ",
    "@xmath305   ~~   \\mp    \\frac{\\imath \\omega \\alpha_r }         { 2 }      \\beta_c     *      \\left [ { g_x'}^+ - { g_x'}^- \\right]\\end{aligned}\\ ] ]",
    "we would do this so that the displacement field ( and magnetic fields ) could be easily reconstructed from @xmath143 ; and , in analogy to the thf and tef mentioned above , we would use a transverse magnetic induction @xmath28 approximation ( tbf ) .",
    "this this form differs from the primary @xmath14 form that defines @xmath2 in that it contains @xmath308 not @xmath309 ; i.e. the electric - like contribution differs only by @xmath310 .",
    "a similar comparison holds for the magnetic components .      here",
    "i avoid calculations using the @xmath196 , and @xmath1 components of the field , and retain a fully vector description . using the definitions in subsection [ s - medium ] ,",
    "i can proceed with the calculation ",
    "@xmath311    the vector @xmath306 fields ( defined in eqn ( [ eqn - s - defs - fvector ] ) ) are   @xmath312    this means i need to convert both the second term on the lhs of the sum - and - difference equation above , as well as the rhs .",
    "it is most imortant for the lhs to be simple , because this will define the type of propagation specified by the rhs . to convert the lhs",
    ", we need two vector identities , as used in subsection [ s - vectorid ] to get eqn.([eqn - vectorid - combined ] ) . so using   @xmath199              we see from the following [ sss-1storderd - longitudinal ] that these two equations are sufficient to describe the fields as long as there is no longitudinal @xmath50 component ( i.e. @xmath306 is transverse ) or longitudinal @xmath208 ( also with reference to the divergence calculation in [ sss - definitions - vectord - divergence ] ) .      taking",
    "the @xmath173 of the @xmath209 equation removed a part of the field dynamics lying in the direction of the propagation vector @xmath41 .",
    "this part also include the response to longitudinal currents . to rectify this omission , we take the dot product with @xmath41 . using the standard vector identity eqn.([eqn - vectorid - i-7 ] ) :   @xmath210 and using @xmath211 ; we get   @xmath319    \\right )   +    \\left ( \\beta_r +",
    "\\beta_c \\right )    *    \\left (      \\vec{u }       \\cdot      \\vec{j }     \\right ) \\label{eqn-1storderd - statframe - divergence}\\end{aligned}\\ ] ]    this is the same as the divergence - difference equation seen in [ sss - definitions - vectord - divergence ] ; where we see that both parts of the lhs are zero if @xmath320 and @xmath214 .",
    "* plane polarized & magnetic ( @xmath323 ) : *    the @xmath324 components of the lhs and rhs contain the @xmath325 values  as a result of the curl and cross - products respectively .",
    "compare the previous stand - alone calculation in eqn.([eqn - stationarygpropagation ] ) to   @xmath326   ~~   \\mp    \\frac{\\imath \\omega \\alpha_r }         { 2 }    \\beta_c    *    \\left [ f_x ^+ + f_x^- \\right]\\end{aligned}\\ ] ]    * vector moving frame , transverse , magnetic : *      * plane polarized moving frame , magnetic : *    this is just a special case of the above vector moving frame equation ",
    "@xmath328     \\right )   ~~   -    \\frac{\\imath \\omega \\beta_r }         { 2 }     \\alpha_c     *     \\left (      \\left [ f_x^+ - f_x^- \\right ]     \\right)\\end{aligned}\\ ] ]    * beltrami - like form : *    this might be written   @xmath329 where @xmath227 is a `` source '' term , but note that actually it will be some complicated function of @xmath36 .",
    "follows the derivation in the previous sections , but uses the `` primary @xmath138 '' ( or @xmath330 ) form , as defined in [ ss - definitions - vectorb ] , with eqns .",
    "( [ eqn - s - defs - fpvector ] , [ eqn - s - defs - dvectorfp ] , [ eqn - s - defs - bvectorfp ] ) .",
    "* note : * not yet calculated , but it will have many similarities to the preceeding three derivations in sections [ s-1stordere ] , [ s-1storderh ] , [ s-1storderd ] .",
    "here i discuss the role and calculation of the energy densities and poynting vector for the em field described in terms of the primary @xmath39 ( @xmath36 ) fields . while it turns out that the thf poynting vector is always a simple function of the @xmath36 fields , the energy density is more complicated and depends on the degree of mismatch between the reference parameters and the true material parameters . because of this difficulty of reconstructing @xmath40 from @xmath36 , all these calculations currently resort to restricting themselves to the thf case only ( i.e. @xmath331 , see [ ss - definitions - vector ] ) .    in practise it might well be simpler to just reconstuct the @xmath39 and @xmath138 fields from known @xmath36 , and use the traditional forms for energy density and poynting vector rather than evaluate the complicated expressions derived in this section .",
    "nevertheless , these complicated expression may provide insight into the nature of the @xmath36 fields , even if they a not used for computation .    here",
    "i will restrict mself to the non - dispersive reference case , where @xmath62 are constants independent of frequency . without this , getting @xmath332 from @xmath333 requires a deconvolution to get the frequency - dependance of @xmath62 out of @xmath333 .",
    "this restriction can be avoided entirely by taking the formulae below to hold in the frequency ( rather than time ) domain .",
    "i define @xmath334 , denoting a convolving dot product , and @xmath335 , denoting a convolving cross product , so   @xmath336    i ve used   @xmath337 \\cdot \\vec{c}(t )   \\leftrightarrow     \\left [ a(\\omega ) \\vec{b}(\\omega ) \\right ] \\odot \\vec{c}(\\omega ) \\\\",
    "\\left [ a(t ) \\ast \\vec{b}(t ) \\right ] \\times \\vec{c}(t )   \\leftrightarrow     \\left [ a(\\omega ) \\vec{b}(\\omega ) \\right ] \\otimes \\vec{c}(\\omega ) .\\end{aligned}\\ ] ]    to avoid cluttered equations , i will also use this shorthand notation   @xmath338      the standard expression for bulk energy density of the em field in terms of the electric and magnetic fields can be easily converted into one in terms of @xmath36 in the thf case . in the following ,",
    "i explicitly allow for the possibility of mismatched reference and material parameters ( i.e. @xmath339 etc ) .",
    "we see here that the energy density takes a more complicated form if we choose to use reference parameters that do not match the true medium ones .",
    "if the reference parameters have a different degree of mismatch between @xmath47 and @xmath48 , which will in fact normally be the case , then the cross terms dependent on @xmath348 do not vanish .",
    "the poynting vector defines the energy flux , and is   @xmath352    we will see that a @xmath10 component always corresponds to a poynting vector ( energy flux ) in the @xmath353 direction , and the @xmath11 to an flux in the opposite direction ( i.e. @xmath354 ) .",
    "this is the basis of the assertion that these @xmath13 variable are direction , and thus correspond to forward and backward directed field components .",
    "* note : * a critique of poynting vectors  see e.g w. gough , _",
    "`` poynting in the wrong direction '' _ , eur .",
    "* 3 * , 83 ( 1982 ) .",
    "the most comprehensive discussions on the interpretation of @xmath13 fields are contained in kinsler et.al .",
    "2005 @xcite .",
    "other important remarks on the behaviour of the propagating fields at interfaces are covered in my report _ `` causality in spatially propagated optics '' _ ( tb arxiv ) .",
    "in sections [ s-1stordere ] , [ s-1storderh ] , and [ s-1storderd ] i calculated various forms of first - order propagation equation for the @xmath2 field variables . however , many pulse propagation theories start from a second - order form for @xmath14 , as in e.g. @xcite ,   @xmath361    to address this point of interest , here i follow a similar path and derive a second - order @xmath2 propagation equation .",
    "as expected , it looks rather similar to the standard equivalents for @xmath14 , but with some extra derivative ( curl ) terms .",
    "first i attempt to make eqns.([scaled - a],[scaled - b ] ) look similar to eqn.([startingpoint - copy ] ) in subsection [ ss - evolution - scalar ] .",
    "then in subsection [ ss - evolution - vector ] i present a more complete derivation of the vector form in the transverse field case .",
    "now i simplify the term in braces @xmath366 , but retain the ordering of @xmath98 s and @xmath367 , because @xmath98 contains @xmath47  i might like to make the medium dispersive , even though it is customary to add dispersion at a later stage .   @xmath368    \\left [     \\partial_t      +     \\partial_z      +     \\sigma    \\right ] -    \\sigma^2 \\right\\ } g^{+ }",
    "\\\\ \\left\\ {    \\left [      \\left (        \\partial_t + \\sigma      \\right )     -     \\partial_z     \\right ]    \\left [      \\left (        \\partial_t + \\sigma      \\right )     +     \\partial_z     \\right ] -    \\sigma^2 \\right\\ } g^{+ } \\\\",
    "\\left\\ {      \\left (        \\partial_t + \\sigma      \\right)^2     +      \\left ( \\partial_t + \\sigma \\right )       \\partial_z     -      \\partial_z      \\left ( \\partial_t + \\sigma \\right )      -     \\partial_z^2 -    \\sigma^2 \\right\\ } g^{+ } \\\\",
    "\\left\\ {      \\left (        \\partial_t + \\sigma      \\right)^2",
    "+     \\partial_t \\partial_z - \\partial_z \\partial_t     +     \\sigma \\partial_z - \\partial_z \\sigma     -     \\partial_z^2 -    \\sigma^2 \\right\\ } g^{+ } \\\\",
    "\\left\\ {      \\left (        \\partial_t + \\sigma      \\right)^2     +     \\left ( \\sigma \\partial_z - \\partial_z \\sigma \\right )     -     \\partial_z^2 -    \\sigma^2 \\right\\ } g^{+ } \\\\",
    "\\left\\ {      \\partial_t^2      +       \\sigma \\partial_t     +       \\partial_t \\sigma     +     \\left ( \\sigma \\partial_z - \\partial_z \\sigma \\right )     -     \\partial_z^2 \\right\\ } g^{+ } .\\end{aligned}\\ ] ]    and for @xmath9 , the term would be @xmath369 . apply this to the full equation , assert the usual case of a uniform material ( so @xmath370 ) , and then duplicate the calculation for @xmath11 ...",
    "@xmath371 \\partial_t p \\label{scaledsecond - a } , \\\\",
    "\\left\\ {      \\partial_z^2    -      \\partial_t^2      -       \\sigma \\partial_t     -       \\partial_t \\sigma \\right\\ } g^{- } & = & \\left [   \\partial_t    +   \\partial_z   \\right ] \\partial_t p , \\label{scaledsecond - b}\\end{aligned}\\ ] ]    compare this to the `` standard '' second order wave equation eqn.([startingpoint - copy ] ) : ( 1 ) the @xmath372 is analogous to @xmath373 ; ( 2 ) @xmath374 has an extra @xmath375 part which might be expected given the directional nature of @xmath13 ; ( 3 ) the @xmath376 is the analogous term to @xmath377 ; remember that @xmath98 is a conductivity term not usually included in pulse propagation problems .",
    "if we add and subtract eqns.([scaledsecond - a ] ) and ( [ scaledsecond - b ] ) , setting @xmath378 , we get   @xmath379 of course @xmath380 , and @xmath381 , so the equivalence between eqn.([scaledsecond - e ] ) and eqn.([startingpoint - copy ] ) is to be expected .",
    "presumably there would also be a related equivalence between eqn.([scaledsecond - h ] ) and the @xmath382 version of eqn.([startingpoint - copy ] ) .",
    "this is a vectorised derivation of the second order wave equation for @xmath36 fields . unlike the previous scalar derivation , it is reasonably complete and without stringent approximation ( barring its transverse field approx ) . the polarization term @xmath34 remains as part of the dispersion term , thus simplifying the equations ; until the end when i split it off for illustrative purposes . from section [ s - definitions ] , the unit vector in the propagation direction is @xmath41 , and the vectorised version of @xmath32 is given by eqn.([eqn - s - defs - gvector ] ) ",
    "@xmath383    in frequency space ,   @xmath384          since i ve already assumed transverse fields , in the source - free case @xmath395 ) so @xmath396 .",
    "thus ,   @xmath397     \\pm      \\beta_c \\ast      \\left [        \\vec{g}^{+ } - \\vec{g}^{- }      \\right ]    \\right\\ } & = & 0.\\end{aligned}\\ ] ]    note the strong similarity to eqns.([scaledsecond - a],[scaledsecond - b ] ) .",
    "the usual polarization term @xmath49 is contained in the @xmath6 ( and @xmath7 ) terms .",
    "if i write @xmath398 and @xmath399 ; dropping the magnetic terms ( i.e. @xmath190 ) gives us :   @xmath400 & = &   +      \\frac{1}{2\\alpha_r }    \\frac{d}{dt }    \\left\\ {      \\frac{1}{c_r }      \\frac{d}{dt }     \\mp      \\vec{u } \\times       \\nabla \\times     \\right\\ }    \\vec{p } .\\end{aligned}\\ ] ]    the @xmath401 prefactor occurs on the rhs because we are relating @xmath13 to the polarization @xmath34 , rather than the usual @xmath14 and @xmath34 .",
    "we could use these second order equations to apply diffraction to a standard first - order equation propagation , by split - stepping the diffraction given here @xmath402 with the usual dispersive and nonlinear propagation .",
    "my _ `` few cycle pulse propagation '' _ detailed calculation @xcite has included terms for @xmath13 field envelopes ; where the gfea equation is ( @xmath403 ) :   @xmath404      \\frac {        \\left (                1 \\pm \\imath \\partial_\\tau          \\right )      }      {               { \\left ( 1 \\pm \\imath \\sigma ' \\partial_\\tau \\right ) }      }      b(\\vec{r}_\\bot,\\xi,\\tau ; a )     +       \\frac { t_\\upsilon + t_{rhs } }           { 1 \\pm \\imath \\sigma ' \\partial_\\tau } \\label{exact - bkp - extra } .\\end{aligned}\\ ] ]    here the @xmath405 and @xmath406 symbols act like the usual @xmath407 ones ; but varying according to which @xmath32 variable is being described  i.e. @xmath408 .",
    "the normal @xmath407 ones are relate to the carrier direction .",
    "it is common in relatively narrowband cases to solve for the propagation of field envelopes centred around chosen carrier frequencies rather than the full detailed oscillations of the em field .",
    "in fact , if sufficient care is taken with approximations , and if the system simulated is well behaved , even quite wideband pulses can be sucessfully modelled using envelopes .",
    "the advantage of the @xmath13 wave equations presented in sections [ s-1stordere ] , [ s-1storderh ] , and [ s-1storderd ] is that we dispense with the second order form of the wave equation , and generate envelope equations from first order equations .",
    "this greatly reduces the number of approximations without increasing the complexity of the theory .",
    "although a full model requires four envelopes to describe the @xmath13 , just as a full maxwell theory requires four envelopes , ( both backward and forward travelling @xmath14 and @xmath22 ) , this is rarely a case we are interested in solving , and so in practice we can use just one envelope .    a full expansion of @xmath13 into forward and backward envelopes @xmath409 , @xmath410 would be   @xmath411 where we have suppressed the @xmath1 argument on the envelope functions for brevity .",
    "note that the argument shift ( @xmath412 ) is how the @xmath413 part of the carrier wave is accounted for .",
    "if inserted into the wave equations , this expansion would result in a large number of terms to consider , even for the relatively simple case of a third order nonlinearity .",
    "however , by specializing to the typical case where we are only interested in forward travelling waves , we can instead use   @xmath414    this has the nice advantage that it eliminates and backward travelling waves , and so we can propagate pulses efficiently in a moving frame .",
    "this is important , because the backward parts in a moving frame move at _ twice _ the frame speed . in a full ( non - envelope )",
    "simulation , we need to either take special efforts to filter out these backward parts , or any hoped - for numerical gains are reversed by the finer @xmath1-step required to integrate ( the backward parts ) accurately .",
    "i start with the plane polarized first order wave eqn .",
    "( [ eqn-1stordere - propagation - planepol ] )   @xmath415   ~~   -    \\frac{\\imath \\omega \\alpha_r }         { 2 }      \\beta_c    *      \\left [ g_x^+ - g_x^- \\right ] .",
    "\\label{eqn - envelope-2398756}\\end{aligned}\\ ] ]      if we do the sensible thing and relate the carrier parameters @xmath421 and @xmath270 using the reference parameters ( so @xmath422 ) , we have @xmath423 :   @xmath424    now transform into the moving frame .",
    "note that we will no longer want the frame to move at the phase velocity at @xmath270 , because that job has been taken over by the carrier ; but we could use it to absorb any residual ( reference ) dispersion affecting one of the envelopes ( most likely for @xmath425 ) .",
    "however , it will then make the residual ( reference ) dispersion term acting on the other envelope ( e.g. @xmath426 ) twice as large .",
    "anyway   @xmath427      see @xcite , which includes correction terms appropriate to @xmath13 fields .",
    "note that there i can think of no reason to use the second order form , since the first order form performs as well with fewer complications .",
    "* ( 1 ) * identity ( old physics 31.320 vector identity sheet , ( i-5 ) ) : @xmath428    * ( 2 ) * identity ( old physics 31.320 vector identity sheet , ( i-10 ) ) : @xmath429    these two identities , specialised to the case involving our unit vector @xmath41 in the propagation direction , mean that we can equate   @xmath430    note also   @xmath431    so in our case where @xmath432 and @xmath433 are both unit vectors   @xmath434    also , i use ( old physics 31.320 vector identity sheet , ( i-7 ) ) : @xmath435"
  ],
  "abstract_text": [
    "<S> i construct combined electric and magnetic field variables which independently represent energy flows in the forward and backward directions respectively , and use these to re - formulate maxwell s equations . </S>",
    "<S> the emphasis is on detailed calculations , with a more general overview being published in phys . </S>",
    "<S> rev . </S>",
    "<S> a72 and arxiv . </S>",
    "<S> these directional variables enable us to not only judge the effect and significance of backward - travelling field components , but also to discard them when appropriate . </S>",
    "<S> they thereby have the potential to simplify numerical simulations , leading to potential speed gains of up to 100% over standard fdtd or pssd simulations . </S>",
    "<S> these field variables are also used to derive both envelope equations useful for narrow - band pulse propagation , and a second order wave equation . </S>",
    "<S> alternative definitions are also presented , along with their associated wave equations .    </S>",
    "<S> = 10000    this report should be read along with the paper phys.rev.a72 , 063807 ( 2005 ) _ </S>",
    "<S> `` theory of directional pulse propagation '' _ </S>",
    "<S> , by p. kinsler , s.b.p . </S>",
    "<S> radnor , g.h.c . </S>",
    "<S> new , for proper context .    </S>",
    "<S> this document is primarily intended as a complete ( as possible ) record of the calculational steps that were necessarily abbreviated ( or omitted ) from that published work ; it also contains a great many other relevant calculations along with some speculation . </S>",
    "<S> it is an edited version of a longer document from which on - going work has been excised ; and , as a `` work in progress '' , despite my best efforts , may contain occasional mistakes . </S>",
    "<S> please contact me if you have any comments , corrections or queries .       </S>",
    "<S> www : qols group http://www.qols.ph.ic.ac.uk/ + www : physics dept . </S>",
    "<S> http://www.ph.ic.ac.uk/ + www : imperial college http://www.ic.ac.uk/ + email : paul kinsler dr.paul.kinsler@physics.org + email : g.h.c . </S>",
    "<S> new g.new@ic.ac.uk     </S>"
  ]
}