{
  "article_text": [
    "in principle , the task of beam extraction and the following low - energy beam transport ( lebt ) system are quite simple .",
    "the ion source extraction consists of the front plate of the ion source , which is known as the plasma electrode , and at least one other electrode , the puller ( or extractor ) electrode , which provides the electric field for accelerating the charged particles from the ion source to form an ion beam . whether or not the extraction contains any other electrodes , the beam leaves the extraction at energy @xmath0 defined by the charge @xmath1 of the particles and the potential difference between the ion source , @xmath2 , and the following beamline , @xmath3 , which is typically the laboratory ground , as shown in fig .",
    "[ fig : concept ] .",
    "the ion source voltage is therefore set according to the requirements of the subsequent application .",
    "the intensity of the particle beam depends , as a first approximation , on the flux of charged particles hitting the plasma electrode aperture .",
    "the extracted ion beam current can therefore be estimated as @xmath4 where @xmath5 is the plasma electrode aperture , @xmath1 is the charge of the particles , @xmath6 is the ion density in the plasma and @xmath7 is the mean velocity of extracted particles in the ion source plasma . assuming a maxwell  boltzmann distribution for the extracted plasma particles , the mean velocity @xmath8 . from the point of view of the extraction",
    ", the plasma electrode aperture can be adjusted to tune the beam intensity .",
    "the practical solutions are unfortunately much more complicated in most cases . the applications following the lebt , which typically are accelerators to bring the beam to higher energies , often pose strict requirements for the ion beam parameters .",
    "not only do the beam intensity , energy and species spectrum need to meet the requirements , but also the beam spatial and temporal structure are specified . for an example of what kind of parameters the specifications might contain , please see table  [ tab : specifications ] .",
    ".specifications of the h@xmath9 ion beam at the end of the lebt , entering the 2.5umev radio frequency quadrupole ( rfq ) accelerator of the spallation neutron source ( sns ) @xcite . [ cols=\"<,^,^\",options=\"header \" , ]     the spatial requirements for the beam mean that focusing is necessary in the lebt .",
    "similarly , the temporal requirements necessitate beam chopping . without careful design of the focusing elements , the space - charge force of the beam blows up the beam to the walls of the vacuum chamber , and",
    "only a part of the generated beam gets transported to the following accelerator .",
    "the extraction focusing systems must also provide some adjustability because , in most cases , the plasma conditions might not be constant in day - to - day operations .",
    "the lebt has to be able to adapt to days of lower and higher performance , while maximizing the throughput to the following accelerator .",
    "designing such systems is not easy . from the ion optics point of view",
    ", a system that is as short as possible would be preferred , but at the same time the system design also has to take into account the practical engineering constraints .",
    "for example , the beamline needs to have space for diagnostics and vacuum pumps in addition to the focusing elements .",
    "this chapter concentrates mainly on the topic of ion optics in low - beam - energy systems : the focusing elements , beam space - charge blow - up , beam  plasma interface and how to model these systems with computer codes .",
    "the ion beam travels in the beam transport line from one ion optical element to another along a curved path , which is usually defined as the longitudinal direction @xmath10 .",
    "the transverse directions @xmath11 and @xmath12 are defined relative to the centre of the transport line , the optical axis , where @xmath13 and @xmath14 . the transport line is usually designed in such a way that a so - called reference particle travels along the optical axis with nominal design parameters . the ion beam ( bunch ) is an ensemble of charged particles around the reference particle , with each individual particle at any given time described by spatial coordinates @xmath15 and momentum coordinates @xmath16 .",
    "this six - dimensional space is known as the particle _",
    "phase space_. in addition to these coordinates , often inclination angles @xmath17 and @xmath18 or the corresponding tangents @xmath19 and @xmath20 are used .",
    "these are defined by @xmath21    the motion of a charged particle in electromagnetic fields @xmath22 and @xmath23 is described by the lorentz force @xmath24 and newton s second law , giving @xmath25 where @xmath26 is the momentum and @xmath27 is the velocity of the particle with charge @xmath1 . in general , the trajectory of a charged particle can be calculated by integrating the equation of motion if the fields are known . in the case of beam transport , the fields have two origins : ( i )  external fields , which are mainly generated by the ion optical elements ; and ( 2 )  beam - generated fields .",
    "generally , in lebt ion optics , we assume that the particle density in a beam is low enough that single particle  particle interactions are negligible .",
    "it is therefore sufficient to take into account the collective beam - generated fields .",
    "the ion optical elements of the beam transport line come in two varieties : magnetic and electric . in the case of high - energy beams , where @xmath28 , magnetic elements are used because the force , which is created with an easily produced magnetic field of 1ut , equals the force from an electric field of 300umvum@xmath29 , which is impossible to produce in a practical device . in lebt systems , where the beam velocity is low , and",
    "the practical limit for electric fields is about 5umvum@xmath29 , the achievable forces are comparable , and other factors , such as size , cost , power consumption and the effects of beam space - charge compensation , come into play .",
    "an important factor in the selection of the type of beamline elements is also the fact that electrostatic fields do not separate ion species . in electrostatic systems",
    "the particles follow trajectories defined only by the system voltages .",
    "the magnetic elements , on the other hand , have a dependence on mass - to - charge ratio @xmath30 .",
    "this allows separation of different particle species from each other .",
    "the common beamline elements that are used to build lebt systems include immersion lens , einzel lens , solenoid , dipole and quadrupole lenses . a short introduction to each of these elements is given below . for more detailed analyses ,",
    "the reader is referred to literature ( refs .",
    "@xcite and @xcite , for example ) .",
    "the immersion lens ( or gap lens ) is simply a system of two electrodes with a potential difference of @xmath31 .",
    "the lens can be either accelerating or decelerating , and , in addition to changing the particle energy by @xmath32 , the element also has a focusing action .",
    "the focal length of the immersion lens is given by @xcite @xmath33 where @xmath34 is the distance between the electrodes .",
    "the electrostatic extraction systems always have gap lenses , which accelerate the beam to the required energy . the first acceleration gap ( plasma electrode to puller electrode ) is a special case of the immersion lens because of the effect of the plasma on the electric field",
    ". it will be addressed later in this chapter .",
    "the einzel lens is made by combining two gap lenses into one three - electrode system with first and last electrodes at the beamline potential @xmath35 and the centre electrode at a different potential @xmath36 .",
    "the einzel lens , which is typically cylindrically symmetric for round beams , is the main tool for beam focusing in many electrostatic extraction systems .",
    "the einzel focusing power is dependent on the geometry and the voltage ratio @xmath37 , assuming that zero potential is where the beam kinetic energy is zero .",
    "the einzel lens may have the first gap accelerating and the second gap decelerating ( known as accelerating einzel lens , @xmath38 ) or vice versa ( known as decelerating einzel lens , @xmath39 ) .",
    "both configurations are focusing , but the refractive power of the einzel in decelerating mode is much higher than in accelerating mode with the same lens voltage .",
    "for example , for the geometry shown in fig .",
    "[ fig : einzel_power ] , the focal length @xmath40 for a decelerating mode , @xmath41 . to achieve the same focal length in accelerating mode ,",
    "a voltage @xmath42 is needed . on the other hand",
    ", accelerating einzel lenses should be preferred if the required higher voltage ( and electric fields ) can be handled , because they have lower spherical aberrations than decelerating einzel lenses , especially when the required refractive power is high .     as a function of the voltage ratio @xmath43 .",
    "the lens is much stronger in decelerating mode compared to accelerating mode.,title=\"fig:\",width=188 ]   as a function of the voltage ratio @xmath43 .",
    "the lens is much stronger in decelerating mode compared to accelerating mode.,title=\"fig:\",width=340 ]    a special case of the einzel lens , where the first electrode and the third electrode are at different potentials , is also possible .",
    "this kind of set - up is known as a three - aperture immersion lens or zoom lens .",
    "it provides adjustable focusing in a system that otherwise acts as an immersions lens @xcite .",
    "a solenoid lens is the magnetic equivalent of the electrostatic einzel lens .",
    "it consists of rotationally symmetric coils wound around the beam tube , creating a longitudinal magnetic field peaking at the centre of the solenoid .",
    "the focusing action of the solenoid is somewhat difficult to derive , but the idea can be described as follows , assuming a thin lens @xcite .",
    "the radial magnetic field at the entrance of the solenoid gives the particle entering the field with @xmath44 at radius @xmath45 an azimuthal thrust @xmath46 which makes the trajectories helical inside the solenoid .",
    "at the exit of the solenoid , the particle receives a thrust cancelling the azimuthal velocity , but leaving the particle with a radial velocity @xmath47 this radial velocity causes the beam to converge towards the optical axis .",
    "the refractive power of the lens is given by @xmath48      the electrostatic dipole and magnetic dipole are elements that are primarily used to deflect charged - particle beams .",
    "the magnetic dipole is constructed from coil windings , creating a constant magnetic field in the transverse direction .",
    "the particles in the magnetic field follow circular trajectories as usual , with radius @xmath49 where @xmath50 is the voltage used to accelerate the particles from zero to @xmath51 .",
    "similarly , an electrostatic dipole may be constructed from cylindrical electrodes of radii @xmath52 and @xmath53 with voltages @xmath54 and @xmath55 .",
    "the radius of curvature of the particle between the plates becomes @xmath56 where @xmath22 is the electric field and @xmath35 is the potential at the orbit ( again assuming that zero potential is where the beam kinetic energy is zero ) .",
    "the voltage and electric field between the plates are @xmath57 by choosing the plate voltages symmetrically as @xmath58 and @xmath59 , the required plate voltage can be found as @xmath60 the optical axis of such a system is at radius @xmath61 .",
    "this is not the only possibility for the cylindrical dipole .",
    "the optical axis can also be chosen to be in the middle of the plates , which leads to asymmetric voltages .",
    "the dipole elements also have focusing / defocusing properties .",
    "for example , the magnetic dipole with edges perpendicular to the optical axis ( edge angle 0@xmath62 ) focuses the beam in the bending plane ( @xmath11 ) as shown in fig .",
    "[ fig : mag_dip_focusing1](a ) . directly from geometry , a so - called barber s rule can be derived : the centre of curvature of the optical axis and the two focal points are on a straight line . for a symmetric set - up",
    "this means that @xmath63 .",
    "there is no focusing action in the @xmath12 direction .",
    "edge angles can be described by barber s rule : the center of curvature of optical axis and the two focal points are on a straight line .",
    "( b )  if the edge angles are positive , as shown , the focusing power is decreased.,title=\"fig:\",width=245 ]   edge angles can be described by barber s rule : the center of curvature of optical axis and the two focal points are on a straight line .",
    "( b )  if the edge angles are positive , as shown , the focusing power is decreased.,title=\"fig:\",width=302 ]     component at non - zero @xmath12 coordinates , focusing the beam in the @xmath12 direction.,width=340 ]    if the magnet edge angles deviate from @xmath64 , the focusing power in the @xmath11 direction can be adjusted .",
    "if the edge angle is made positive ( as shown in fig .",
    "[ fig : mag_dip_focusing1](b ) ) , there is weaker focusing in the @xmath11 direction . if the angle is negative , there is stronger focusing in the @xmath11 direction .",
    "changing the edge angle also has an important effect in the @xmath12 direction : if the angles are positive , the fringing field of the magnet will focus the beam in the @xmath12 direction , as shown in fig .",
    "[ fig : mag_dip_focusing2 ] .",
    "overall , this means that the focusing in the @xmath11 direction can be traded for @xmath12 focusing .",
    "the focal length from the edge focusing is given by @xmath65 in a symmetric double - focusing dipole ( where there is the same focal length in @xmath11 and @xmath12 directions ) , the angles and distances are given by @xmath66 for a @xmath67 bending magnet , the edge angles become @xmath68 and the focal distances @xmath69 .    a dipole magnet focusing in the @xmath12 direction can also be made by making the pole faces conical , as shown in fig .",
    "[ fig : mag_dip_inhomo ] .",
    "this kind of magnet is known as a radially inhomogeneous sector magnet .",
    "the magnetic field of such a magnet can be approximated as @xmath70 where @xmath71 is the magnetic field on the optical axis with radius @xmath43 and @xmath6 is the so - called field index , which depends on the angle of the magnet pole .",
    "the first - order approximation shows that the magnet is focusing in the @xmath11 direction if @xmath72 and focusing in the @xmath12 direction if @xmath73 .",
    "the focusing forces inside the magnet are symmetric at @xmath74 .     due to increasing gap , which also leads to @xmath75 increasing with @xmath12.,width=283 ]    the regular cylindrical electrostatic dipole only has focusing in the @xmath11 direction similar to the regular straight edge magnetic dipole .",
    "the @xmath12 focusing can be introduced by adjusting the ends of the cylindrical plates for edge focusing or by using spherical or toroidal plates .    for small - angle deflection ,",
    "typically electrostatic parallel plates or so - called @xmath76 magnets are used .",
    "the parallel plates with @xmath77 voltages bend the beam by an angle @xmath78 where @xmath34 is the length of the plates in the @xmath10 direction and @xmath79 is the distance between the plates .",
    "this kind of system is typically used for small corrections in beamlines and for beam chopping . for example , in fig .",
    "[ fig : chop ] , a simulation of a fast chopping system in an lbnl - built neutron generator is shown .",
    "the @xmath76 magnets are the magnetic equivalent of parallel plates , with typically two pairs of windings in a single instrument for correction in both transverse directions .",
    "the beam deflection is given by @xmath80 where @xmath34 is the field length and @xmath23 is the field strength inside the device .",
    "uv switches for generating 5uns beam pulses is shown.,scaledwidth=70.0% ]      electrostatic and magnetic quadrupoles are often used as focusing elements in lebt systems in addition to einzel lenses and solenoids .",
    "the electrostatic quadrupole consists of four hyperbolic electrodes placed symmetrically around the beam axis with positive potential @xmath81 on the electrodes in the @xmath82 and @xmath83 directions and negative potential @xmath84 on the electrodes in the @xmath85 and @xmath86 directions , as shown in fig .",
    "[ fig : quad ] .",
    "the potential in such a configuration is given by @xmath87 where @xmath88 is the radius of the quadrupole .",
    "this leads to an electrostatic field @xmath89 from which we can see that such a quadrupole focuses a positive ion beam in the @xmath11 direction and defocuses in the @xmath12 direction . by analysing the particle trajectories in such fields",
    ", it can be shown that the refractive powers of the system are @xmath90 where @xmath91 and @xmath34 is the effective length of the quadrupole .",
    "being the distance from the optical axis to the electrode tip , width=245 ]    the magnetic quadrupole has a similar construction to the electrostatic one : the magnet poles are made to be hyperbolic and windings are coiled in such a way that every other pole has magnetic flux in to the beam and every other out of the beam .",
    "the magnetic field in such a system is @xmath92 where @xmath93 is the magnetic field density at the pole tip . positively charged particles having velocity @xmath94 feel a force @xmath95 , which is focusing in the @xmath11 direction and defocusing in the @xmath12 direction .",
    "the magnetic force leads to the same refractive powers as presented by eqs .   and , but with @xmath96    quadrupole lenses are typically used as doublets or triplets for solutions that are focusing in both transverse directions .",
    "quadrupoles can also be used for transforming asymmetric beams such as slit beams from a penning ion source , for example , into a round beam .",
    "traditionally the emittance is defined as the six - dimensional volume limited by a contour of constant particle density in the @xmath97 phase space .",
    "this volume obeys the liouville theorem and is constant in conservative fields . with practical accelerators ,",
    "a more important beam quality measure is the volume of the _ envelope _ surrounding the beam bunch .",
    "this is not conserved generally  only in the case where the forces acting on the particles are linear ( see fig .",
    "[ fig : emittance_conservation ] ) . typically in the case of continuous ( or long pulse ) beams , where the longitudinal direction of the beam is not of interest , transverse distributions @xmath98 and @xmath99 are used instead of the full phase - space distribution for simplicity .",
    "also for these distributions the envelope surrounding the distribution changes when nonlinear forces ( non - idealities of beamline elements , for example ) act on the particles .",
    "the size and shape of the transverse distribution envelope are important quality measures for beams because most complex ion optical devices such as accelerators have an acceptance window in the phase space within which they can operate .          for calculation and modelling purposes ,",
    "a simple shape is needed to model the ion beam envelope in @xmath98 phase space .",
    "real well - behaved ion beams usually have gaussian distributions in both @xmath11 and @xmath19 directions . because the contours of two - dimensional ( 2d ) gaussian distributions are ellipses",
    ", it is an obvious solution to use the ellipse as the model in 2d phase spaces ( and ellipsoids in higher dimensions ) .",
    "the equation for an origin - centred ellipse is @xmath100 where the scaling @xmath101 is chosen . here",
    "@xmath102 is the _ two - dimensional transverse emittance _ , and @xmath17 , @xmath18 and @xmath103",
    "are known as the _ twiss parameters _ defining the ellipse orientation and aspect ratio .",
    "the area of the ellipse is @xmath104 where @xmath105 and @xmath106 are the major and minor radii of the ellipse .",
    "because of the connection between the area of the ellipse and @xmath102 , there is sometimes confusion about whether to include @xmath107 in the above formula for quoted emittance values .",
    "the unit of emittance is often written as @xmath107ummumrad .",
    "this is done to emphasize that the quoted emittance number is the product of the radii and _ not _ the area of the ellipse .",
    "always , when communicating about emittance numbers , it should be clearly indicated what the number is to avoid confusion .    from eq .",
    "the dimensions of the ellipse can be calculated .",
    "some of the most important dimensions needed in calculations are shown in fig .",
    "[ fig : ellipse_geom ] .          how do @xmath102 and the twiss parameters relate to phase - space distributions ?",
    "how is the envelope defined ?",
    "there are numerous ways to fit an ellipse to particle data .",
    "often , a minimum - area ellipse containing some fraction of the beam is wanted ( e.g.  @xmath108 ) , but unfortunately this is difficult to produce in a robust way . a well - defined way to produce",
    "the ellipse is by using a statistical definition known as the _ r.m.s .",
    "emittance _ , @xmath109 with the expectation values defined as @xmath110 where @xmath111 is the magnitude of the beam current at the differential area @xmath112 of phase space at @xmath98 .",
    "similarly , the twiss parameters can be calculated from the particle distribution with @xmath113 for these formulas , it is assumed that the emittance distribution is centred at the origin , so that @xmath114 and @xmath115 . with measured emittances ,",
    "additional difficulties arise from background noise and amplifier offsets in @xmath116 data .",
    "filtering methods for processing experimental data exist , from simple thresholding to more refined algorithms such as scubeex @xcite .",
    "the meaning of the r.m.s .",
    "emittance can be more easily understood by looking at the amount of beam that is enclosed by the ellipse .",
    "this , of course , depends on the particle distribution shape . for real measured distributions",
    ", there is no direct rule . for theoretical",
    "known distributions , this can be calculated .",
    "the two most used model distributions used for beams are the bi - gaussian and the kapchinskij ",
    "vladimirskij ( kv ) distribution .    the bi - gaussian distribution oriented along the axes is given by @xmath117,\\ ] ] where @xmath118 and @xmath119 are the standard deviations of the distribution in the @xmath11 and @xmath19 directions . in practice",
    ", the distribution can be additionally rotated by angle @xmath120 .",
    "the kv distribution has a uniform beam density inside an elliptical phase space given by @xmath121      0 &            \\text{otherwise}.    \\end{cases}\\ ] ]    in fig .",
    "[ fig : rms_integral ] the beam fraction inside the ellipse is shown as a function of the area of the ellipse for hard - edged kv and bi - gaussian distributions . because four times the r.m.s .",
    "ellipse fully encloses the kv distribution , the so - called emittance is often used as the quoted number instead of the emittance .     for hard - edged kv distribution ( blue ) and for gaussian distribution ( red).,width=359 ]      the transverse emittance",
    "defined in @xmath98 space has the property that it is also dependent on the longitudinal beam velocity . if the beam is accelerated and @xmath122 increases , then @xmath123 decreases .",
    "this effect is eliminated by normalizing the velocity to the speed of light @xmath124 , which gives @xmath125 at non - relativistic velocities .",
    "the normalized emittance can therefore be calculated from the unnormalized emittance using @xmath126      an ion beam formed by letting charged particles from a plasma be emitted from a round aperture has an emittance defined by the plasma ion temperature @xmath127 and the aperture radius @xmath128 , assuming that the acceleration to velocity @xmath51 does not add aberrations .",
    "this minimum emittance can be calculated by using eqs .   and using a particle distribution defined by a circular extraction hole and gaussian transverse ion distribution , i.e. @xmath129 after normalization , the resulting r.m.s .",
    "emittance becomes @xmath130 the calculation can be performed similarly for a slit - beam extraction , which gives @xmath131 in the round aperture case , the emittance of the beam is linearly proportional to the plasma aperture radius . on the other hand ,",
    "the beam current is roughly proportional to the area of the plasma aperture .",
    "scaling of the aperture size does not therefore change the _ beam brightness _",
    ", @xmath132 in a first approximation .",
    "in electron cyclotron resonance ( ecr ) and microwave ion sources , there is a strong solenoidal magnetic field at the plasma electrode location , where the beam formation happens .",
    "this has a strong influence on the beam quality .",
    "as the particles exit the solenoidal magnetic field , they receive an azimuthal thrust described by eq .  .",
    "the emittance of the beam can be calculated outside the solenoid by considering the particle coordinates far away , where the azimuthal particle motion has completely changed to radial motion , @xmath133 the r.m.s .",
    "emittance of the beam can be calculated from the radius of the constant - current - density beam at extraction and the asymptotic radial angle , @xmath134 the normalized emittance is given by @xmath135    for ecr ion sources , the effect of the magnetic field dominates the emittance compared to the effect of the ion temperature , as a result of the high magnetic fields in these devices .",
    "unfortunately , the formula given here is not able to predict the emittance values , as measurements indicate that , for a given element , the higher - charge - state ions have lower emittances than lower - charge - state ions ( see fig .  [",
    "fig : ecr_emittance ] ) .",
    "this trend contradicts the prediction of eq .  .",
    "the only possible interpretation is that the ions are not being extracted from a uniform plasma .",
    "the higher charge states are confined closer to the axis at the extraction aperture , and therefore their emittance in the beam is lower .",
    "this example shows the additional difficulty in analysing ecr extractions , as there are no simple self - consistent plasma models describing the starting conditions for the ions @xcite .",
    "t. reproduced from ref .",
    "@xcite.,width=302 ]      the ion beam charge density @xmath136 plays a major role in beam extraction systems , where current densities are high and velocities are low compared to other parts of accelerator systems . the space charge induces forces , which increase the divergence and emittance , ` blowing up ' the beam . at higher - energy parts of the accelerator , the magnetic force generated by the beam particles starts to compensate the blow - up , but it is insignificant at @xmath137 .      assuming a cylindrical constant - current - density beam with radius @xmath128 propagating with constant velocity @xmath51 , the beam - generated electric field is given by gauss s law , @xmath138      \\displaystyle\\frac{i}{2 \\rmpi \\epsilon_0 v_z } \\displaystyle\\frac{1}{r } &      \\text{otherwise}.    \\end{cases }    \\label{eq : e_field}\\ ] ] the potential inside a beam tube with radius @xmath139 is therefore @xmath140 & \\text{if}\\ r \\le r_{\\text{beam } } ,    \\\\[15pt ]      \\displaystyle\\frac{i}{2",
    "\\rmpi \\epsilon_0 v }      \\log\\left(\\displaystyle\\frac{r}{r_{\\text{tube}}}\\right ) &      \\text{otherwise}.    \\end{cases}\\ ] ] the potential distribution is plotted in fig .",
    "[ fig : beam_potential ] for a 10uma , 10ukev proton beam inside a 100umm beam tube .        the electric field in the constant - current - density case , given by eq .",
    ", is linear with radius and therefore does not cause emittance growth , but it does cause increasing divergence of the beam . a particle at the beam boundary experiences a repulsive force @xmath141 therefore , the particle acceleration is @xmath142 the particle trajectory is given by the differential equation @xmath143 where @xmath144 assuming that the beam divergence is small ( i.e.  eq .   is valid ) .",
    "the differential equation can be integrated after a change of variable @xmath145 , which gives @xmath146 assuming @xmath147 at @xmath148 .",
    "the solution is separable and can be integrated again to achieve the final solution @xcite @xmath149 with @xmath150 the last integral is not analytic , but can be numerically integrated for estimates of divergence . as an example , a parallel zero - emittance beam of @xmath151ta@xmath152 accelerated with 60ukv has initial radius of @xmath153umm .",
    "the size of a 120uma beam after a drift of 100umm can be solved from @xmath154 , which gives @xmath155umm .    with practical drifting low - energy beams ,",
    "a more realistic model for the beam distribution is bi - gaussian , for example .",
    "this kind of distribution leads to nonlinear space - charge forces , which cause emittance growth in addition to increase of beam divergence .",
    "computer simulations are required to estimate these effects .",
    "the potential well of the beam formed by the accelerated charged particles acts as a trap for oppositely charged particles in areas where there are no external electric fields to drain the created charges .",
    "the trapped particles compensate the charge density of the beam , decreasing the depth of the potential well and therefore also decreasing the magnitude of the beam space - charge effects described above .",
    "this process is called _ space - charge compensation_. the most abundant process for the production of compensating particles is the ionization of the background gas within the beam . in the case of positive ion beams ,",
    "the electrons produced in the background gas ionization are trapped in the beam , while slow positive ions are repelled to the beamline walls . in the case of negative ion beams ,",
    "the compensating particles are the positive ions created in the gas .",
    "the creation rate of the compensating particles can be estimated with @xmath156 where @xmath157 is the flux of beam particles , @xmath158 is the gas density and @xmath159 is the ionization cross - section .",
    "if the creation rate is high enough , the space - charge compensation is finally limited by the leakage of compensating particles from the potential well as the compensation factor approaches @xmath160% .",
    "the compensation factor achieved in a real system is difficult to estimate accurately because it depends on the lifetime of the compensating particles in the potential well .",
    "the most important processes affecting the lifetime are ( i )  leakage of particles at the beamline ends , which can be limited with accelerating einzel lenses or magnetic fields , for example , ( ii )  recombinative processes and ( iii )  scattering processes leading to ejection of particles from the potential well . assuming that the creation rate of compensating particles is high , the time - scale for achieving full compensation is @xmath161 where @xmath162 is the charge state of the beam and @xmath27 is the velocity of the beam .",
    "this equation can be used , for example , to estimate if compensation is possible in pulsed beams .    in high - beam - intensity lebt systems , a controlled amount of background gas is often added to the vacuum chamber to increase the amount of compensation .",
    "a @xmath163@xmath164% beam loss in the increased ionization processes can lead to @xmath165% increase in total beam transmission due to decreased divergence .",
    "the magnitude of the compensation can be estimated , for example , by measurement of the energy distribution of the ions ejected from the beam as a function of background gas pressure , as shown in fig .",
    "[ fig : ion_energy_dist ] .",
    "there are also particle - in - cell ( pic ) computer codes , such as warp @xcite and solmaxp for modelling the relevant processes affecting beam compensation .",
    "these programs can be used for analysing beam transport with self - consistent compensation . with other beam transport programs ,",
    "a typical solution is to scale the beam current locally with the space - charge compensation factor estimated by the user . for more information on space - charge compensation",
    ", please see the chapter by n.  chauvin in these proceedings dedicated to this topic @xcite .",
    "40uv to @xmath16610uv when the pressure is increased from @xmath167umbar to @xmath168umbar . reproduced from ref .",
    "in the introduction of this chapter it was assumed that the ion beam is simply formed by accelerating the plasma particles hitting the plasma electrode aperture , which separates the quasi - neutral plasma and the unneutralized beam . in this section , the physics of beam formation is analysed in more detail .      in the first acceleration gap , where the beam is formed",
    ", the space - charge forces acting on the beam are largest .",
    "the situation can be evaluated in one dimension by assuming a beam starting with zero velocity with poisson equation @xmath169 where @xmath10 is the location , @xmath170 is the gap potential , @xmath171 is the beam current density and @xmath172 is the vacuum permittivity .",
    "the emission surface is at @xmath173 and the extractor surface is at @xmath174 . for @xmath175 ,",
    "the potential distribution between the surfaces is linear .",
    "as the emission current density increases , the electric field at the emission surface decreases until it becomes zero , as shown in fig .",
    "[ fig : child](a ) . at that point",
    "the emission current is at the maximum level , for which eq .",
    "can be solved with the boundary condition @xmath176 .",
    "this condition is known as space - charge - limited emission , and the resulting limit for the maximum emission current density can be calculated using the following equation , which is known as the child ",
    "langmuir law @xcite : @xmath177        thermionic electron guns are often operated in the space - charge - limited mode for stability and uniformity reasons  even if the local emission conditions change , the emitted current stays constant as long as the emission is limited by the child ",
    "langmuir law .",
    "the plasma ion sources are typically operated in emission - limited mode , i.e.  the potential difference between the plasma electrode and puller electrode is made sufficiently large to handle the beam space charge .",
    "the law in the form shown here is not strictly valid for ion source plasma extraction because of the effects of plasma neutralization and higher ` starting ' velocity of particles in plasma extraction .",
    "the physics of the space - charge limit is still valid and the child ",
    "langmuir law can be used to estimate it .    in any system ,",
    "the maximum extractable current is dependent on the geometry , the emission current density and the voltage via the space - charge limit . in the space - charge - limited region ,",
    "the current is proportional to @xmath178 .",
    "this leads to the definition of the beam _ perveance _ as @xmath179 which is the proportionality constant describing the system .",
    "as long as the emission is space - charge - limited , the beam perveance is roughly constant .",
    "when the voltage is further increased and the beam emission is no longer space - charge - limited , the beam perveance decreases .",
    "see fig .",
    "[ fig : child](b ) for an example of the current  voltage characteristic of a plasma extraction .",
    "the space - charge forces try to blow up the beam , as was shown above .",
    "this happens especially in the first acceleration gap because of the low velocity of the beam . to counteract the space - charge forces in the transverse direction ,",
    "the electrodes can be shaped in such a way that the electric field in the first gap is not only accelerating but also focusing . in the case of space - charge - limited surface - emitted electrons , there is a perfect solution providing a parallel electron beam accelerated from the cathode @xcite .",
    "the solution is to have a field shaping electrode around the cathode ( at cathode potential ) in a @xmath180 angle with respect to the emitting surface normal , as shown in fig .",
    "[ fig : pierce ] .",
    "this geometry is known as pierce geometry . for plasma ion sources",
    ", there is no such magic geometry because the ions do not start from a fixed surface , but from plasma with varying starting conditions .          in the case of ion plasma extraction",
    ", the beam formation is more complicated than in the case of surface - emitted electrons described above .",
    "the ions are born in the quasi - neutral plasma and get extracted into the unneutralized beam .",
    "it is obvious that the extraction can not be modelled without considering the neutralizing effect of the plasma . the simplest description of the necessary transition layer or _ plasma sheath _ was given by bohm for an ion",
    " electron plasma @xcite .",
    "the ions are assumed to arrive from the bulk plasma into the sheath with velocity @xmath181 .",
    "the charge density of ions can be calculated by assuming a quasi - neutral situation @xmath182 at the bulk plasma in the plasma potential @xmath183 , where @xmath184 is the plasma electrode potential .",
    "using ion continuity @xmath185 and energy conservation @xmath186 , the ion density becomes @xmath187 the electrons are assumed to be in thermal equilibrium and therefore they follow the boltzmann distribution @xmath188 the potential in the sheath is described by the poisson equation @xmath189 .",
    "\\label{sheath_poisson}\\ ] ] an important feature can be observed from the equation : the shielding condition , @xmath190 is only fulfilled when the space charge is non - negative , i.e.  @xmath191 for all @xmath192 .",
    "the necessary condition @xmath193 is known as the _ bohm sheath criterion _ and @xmath194 as the _ bohm velocity_. the criterion sets a low - velocity limit for ions arriving at the sheath edge and in most cases the equation holds with equality @xcite .",
    "the poisson equation is impossible to solve analytically , and often a numerical approach or approximations are used even in the presented one - dimensional case .",
    "the computational approach that is used in plasma extraction simulations in higher dimensions is presented in section  [ codesbeamextracttransport ] .",
    "the situation at the plasma extraction is simple according to the model ( see fig .",
    "[ fig : plasma_model_pos](a ) ) .",
    "positive ions flow from quasi - neutral bulk plasma into the extraction sheath with velocity @xmath194 .",
    "the compensating electron density , which is defined by the potential , is equal to the ion density in bulk plasma and decays exponentially towards the extraction .",
    "far enough in the extraction , the compensation becomes ( essentially ) zero . from the model ,",
    "it is obvious that there is no well - defined boundary between neutralized plasma and the unneutralized extraction .",
    "often , such a boundary would be useful for judging the focusing action of the electric field close to the plasma electrode and for communicating about the plasma sheath shape .",
    "therefore , an equipotential surface at @xmath195 in the case of positive ion extraction is often chosen as an artificial ` boundary ' , known as the _ plasma meniscus_. this choice works as a thought model even though in reality there is no such boundary .",
    "see fig .",
    "[ fig : plasma_model_pos](b ) for a two - dimensional example of the plasma sheath .",
    "the process of beam formation varies not only with the extraction electric field strength and shape , but also with the properties of the plasma , i.e.  plasma density , electron and ion temperatures . in fig .",
    "[ fig : plasma_meniscus ] , three simulated cases are shown with differing plasma densities . all other parameters are unchanged . in case ( a )",
    "the plasma density is low and 25uma of protons are extracted .",
    "the strong electric field in the extraction makes the plasma meniscus concave and the extracted beam is over - focused , causing increase in beam emittance . in case ( b ) the plasma density is higher and 60uma of beam is extracted .",
    "the meniscus shape is almost flat , which provides the lowest beam emittance . in case ( c ) ,",
    "the plasma density is even higher and 95uma of beam is extracted .",
    "the plasma meniscus is convex , the beam is divergent and the emittance is higher than in the optimal case . because of this effect , it is important that the electric field strength of the extraction system can be somehow adjusted if changing plasma densities are expected .",
    "possible adjustments are changing the plasma electrode to puller electrode gap or changing the puller electrode voltage .",
    "the negative ion plasma extraction model is similar to the positive ion extraction model presented above .",
    "the bulk plasma is at positive plasma potential @xmath196 and it is separated from the plasma electrode at @xmath197uv by a plasma sheath . it is assumed that the extractable negative ions , which are either volume- or surface - produced , are born close to the wall potential and extracted from a uniform plasma volume .",
    "these charges form a potential well and counteract the formation of a saddle point at the extraction aperture .",
    "the non - existence of the saddle point is supported by the observed good emittance from h@xmath9 ion sources @xcite .",
    "the potential deviates from zero going into the bulk plasma due to the plasma potential and towards the extraction due to the acceleration voltage .",
    "this potential structure causes positive ions from the bulk plasma to be accelerated towards the extraction , having energy @xmath198 at the zero potential .",
    "these ions propagate until they are reflected back into the plasma by the increasing potential in the extraction .",
    "the potential well acts as a trap for thermal positive ions .",
    "the negative ions and electrons are accelerated from the wall potential towards the bulk plasma and more importantly towards the extraction . a schematic view of the negative ion extraction model is shown in fig .",
    "[ fig : plasma_model_neg ] @xcite .",
    "the negative ion plasma sheath from the zero potential towards the extraction can be described by the poisson equation @xmath199 where @xmath200 . here",
    "@xmath201 is the space - charge density of negative particles , @xmath202 is the space - charge density of fast positive ions and @xmath203 is the space - charge density of trapped positive thermal ions .",
    "the model allows several different negative ion species to be extracted from the ion source and also many positive ion species to be used as compensating plasma particles .",
    "each of the thermal ion species has a separate maxwellian velocity distribution with the associated space - charge distribution @xmath204 where @xmath205 is the space - charge density of the thermal ion species at the wall potential and @xmath206 is the corresponding thermal ion temperature .",
    "the fast ions are decelerated and turned back into the plasma by the extraction voltage .",
    "the space - charge distribution of the fast ions is defined by the virtual cathode formation and it is @xmath207 at @xmath208 and zero otherwise .",
    "here @xmath209 is the space - charge density of fast ions at the wall potential and @xmath210 is the corresponding kinetic energy , which should be around @xmath211 as the particles are flowing from the bulk plasma .",
    "the quasi - neutrality of the plasma requires @xmath212 at @xmath213uv .    in the negative ion extraction ,",
    "the plasma sheath acts similarly to the positive ion extraction case .",
    "the smallest beam emittance is achieved with extraction field optimized for the plasma density of the ion source .",
    "the biggest difference from the positive ion case is that , with a positive puller electrode voltage , also electrons will be extracted from the plasma in addition to the negative ions .",
    "depending on the ion source , the amount of co - extracted electrons may be as high as 100200 times the amount of negative ions extracted or as low as  1 as is the case in caesiated surface production h@xmath9 sources . especially in the cases where the amount of electrons is high , the electrons need to be dumped in a controlled manner as soon as possible to avoid unnecessary emittance growth due to the additional space charge .",
    "often the electron beam current is so high that the dumping can not be done at the full beam energy required by the application . in other words ,",
    "the electron beam has to be dumped on an intermediate electrode at lower potential than ground .",
    "typically the electron dumping is done by utilizing a magnetic dipole field generated with permanent magnets . as the magnetic field also deflects the negative ion beam , the negative ion source may be mounted to the rest of the beam transport line at an angle to compensate for the deflection .",
    "another solution is to use another dipole field in the opposite direction to correct the angle of the negative ion beam back perpendicular to the original axis .",
    "the resulting offset in the beam centre has to be corrected using deflector plates , @xmath76 magnets or mechanical offset .",
    "there are three locations , which are generally used for dumping the electron beam in negative ion sources : 1 .",
    "puller electrode with low voltage with respect to the ion source can be used as an electron dump @xcite , 2 . a separate intermediate electrode before the puller electrode can be used if a higher voltage is needed on the puller electrode @xcite or 3 .",
    "the electrons are dumped on an electrode after the puller electrode , as shown in fig .",
    "[ fig : sns_new ] .",
    "the third method has the advantage that the voltage of the puller electrode can be optimized for plasma density matching without affecting the electron dumping @xcite .     and for dumping up to 1ua of electrons into a v - shaped electron dump .",
    "the puller electrode can be adjusted to cope with varying current levels .",
    "the electron dump ( einzel ) electrode has permanent magnets embedded for a dipole  antidipole field structure @xcite.,height=264 ]",
    "the modelling and analysis of modern beam extraction and transport systems is so complicated that most of the work is done using specialized computer simulation codes . in this section , a brief overview of the wide spectrum of codes",
    "is presented .",
    "traditionally , modelling of ion optical transport lines has been done using the transfer matrix formalism , which describes the effect of ion optical elements ( and drifts between them ) on trajectories using transfer matrices . in the computer program transport @xcite , for example , the properties of a single - particle trajectory at any given point of the transport line are described by a vector @xmath214 , where @xmath11 and @xmath12 are the transverse displacements of the trajectory with respect to the reference trajectory , @xmath19 and @xmath20 are the tangents of angles of the trajectory with respect to the reference trajectory , @xmath215 is the path - length difference between the trajectory and the reference trajectory , and @xmath216 is the fractional momentum deviation of the trajectory from the reference trajectory .",
    "the trajectory component @xmath217 after propagation through an ion optical element can be calculated from @xmath218 where @xmath219 are the components of the trajectory before the ion optical element , and @xmath220 , @xmath221 , @xmath222 , ",
    "are the first - order , second - order , third - order ,   transfer coefficients .",
    "this can be described as matrix  vector multiplication , with a @xmath223 matrix in first order , a @xmath224 matrix in second order , a @xmath225 matrix in third order , etc . , using an extended trajectory vector containing also the higher - order terms , for example , @xmath226 in the second order .",
    "if the element matrices are expanded as square matrices , the propagation of the trajectory through the whole beamline can be calculated from the product of the element matrices @xmath227 instead of using eq .   for each element @xmath228 .",
    "the propagation of trajectory @xmath229 through the whole system is given by @xmath230 the cumulative matrix @xmath227 can be used to calculate several trajectories through the transport line much faster than just by using the projection from element to element one after another .",
    "the first - order approximation matrices can be easily derived analytically by assuming that the displacements and angles relative to the reference trajectory are small enough to justify the truncation of higher - order terms .",
    "for example , the first - order matrix for a magnetic quadrupole lens is @xmath231 where @xmath34 is the effective length of the quadrupole , @xmath232 and @xmath103 is the relativistic factor .",
    "some ion optical effects can also be derived to higher - order approximations analytically .",
    "usually the highest - order matrices are constructed using numerical integration of known fields .",
    "in addition to transporting single trajectories or distributions , the same matrix formalism can be used to transport elliptical beam envelopes through the transport line in the first order . in this case , the beam envelope ( in one dimension ) is described by the beam matrix @xmath233 where @xmath17 , @xmath18 and @xmath103 are the twiss parameters and @xmath102 is the beam emittance .",
    "the transformation of the envelope @xmath234 through a system described by matrix @xmath227 can be calculated with @xmath235    programs using the transfer matrix formalism are typically used for modelling long beam transport lines at relatively high energies , where the beam size and angles are small .",
    "the calculation of trajectories is fast , which allows automatic optimization of ion optics , etc .",
    "many of the programs even have models for space - charge - induced divergence growth ( similar to what was presented in section  [ sec : space_charge_effects ] ) and/or r.m.s .",
    "emittance growth modelling using the paraxial approximation for particle distributions , which makes them more suitable for modelling the low - energy and high - current systems such as lebt and accelerator injection systems .",
    "the use of the space - charge models , of course , makes the calculation slower , but the codes are still much faster than the ray - tracing codes discussed in section  [ raytraceextract ] .",
    "some of the most commonly used codes of this type include the following :    * cosy infinity @xcite , up to infinite order , no space charge modelling * dimad @xcite , up to third - order calculation , space charge of kv beam * gios @xcite , up to third - order calculation , space charge of kv beam * path manager ( travel ) @xcite , up to second order , more advanced space - charge modelling for particle distributions ( mesh or coulomb model ) * trace-3d @xcite , mainly linear with space charge of kv beam * transport @xcite , up to third - order calculation , no space - charge modelling        for systems where the approximations made in the transfer matrix codes are not valid , another more fundamental method has to be used .",
    "an approach taken by so - called _ ray - tracing codes _ is to directly integrate the particle equation of motion ( eq .  )",
    "using mesh - based maps for @xmath236 and @xmath237 fields . in the extraction system case , it is typically assumed that the @xmath237 field is defined only by external sources , i.e.  the beam - generated magnetic field is negligible .",
    "on the other hand , the space charge of the beam plays a major role , and the self - consistent solution of the beam transport can be found using the iterative approach shown in fig .",
    "[ fig : iteration ] .",
    "the iteration starts with computation of the electric potential on the system using the laplace equation .",
    "the electric field is then calculated from the potential , and particles are traced through the system .",
    "the current carried by the particles is deposited onto the underlying mesh for the following solution of the poisson equation for a new estimate of the electric potential .",
    "the iteration is continued like this until convergence is reached .",
    "a code of this type may also have a nonlinear poisson solver for taking into account the compensating particles of the plasma using analytical formulas , as described in sections [ sec : positive_plasma ] and [ sec : negative_plasma ] .",
    "pioneering work in the field using this method was done by s.  a.  self @xcite and j.  h.  whealton @xcite in the 1960s and 1970s . this type of code is often called an _ extraction code _ or _ ion gun code_. the most used codes of this type include the following :    * igun @xcite , a code with plasma modelling for negative and positive ions , only 2d and cylindrically symmetric geometries * pbguns @xcite , plasma modelling for positive and negative ions , only 2d and cylindrically symmetric geometries * kobra @xcite , a more advanced 3d @xmath22 field solver , positive ion plasma modelling , simple particle - in - cell capability * ibsimu @xcite , 1d , 2d or 3d and cylindrically symmetric @xmath22 field solver , plasma modelling for positive and negative ions    in the following , the typical methods used in extraction codes are described in more detail .",
    "the particular choices presented here are those that are used in the ibsimu code , which was written by the author , but many codes of this type use the same or similar methods .",
    "the geometry of the simulation domain is discretized using a regular grid , where the coordinates of calculation nodes can be calculated from integer indices @xmath238 , @xmath239 , @xmath240 , with @xmath241 , @xmath242 and @xmath243 .",
    "the poisson equation @xmath244 in three dimensions is discretized using the finite difference method ( fdm ) , i.e.  by replacing the derivatives with finite differences .",
    "the poisson equation becomes @xmath245 for nodes that do not have electrodes as close neighbours .",
    "the nodes that are close to electrodes use a modified form of the poisson equation with uneven node distances to take into account the real distance of the calculation node from the surface for more accurate , smooth solution near the surface .",
    "the finite difference for the partial derivative in the @xmath11 direction becomes @xmath246 where @xmath247 is the distance from @xmath248 to the location where the potential is known in the negative @xmath11 direction and @xmath249 is the distance from @xmath248 to the location where the potential is known in the positive @xmath11 direction .",
    "the near - solid distances ( @xmath17 and @xmath18 coefficients ) are stored in a table for all calculation nodes that are neighbours to surfaces .",
    "the nodes that are on the boundaries of the simulation domain have to be constrained by a boundary condition , either a dirichlet boundary condition ( fixed potential ) @xmath250 or a neumann boundary condition ( fixed derivative with respect to the normal of the boundary ) @xmath251 in the case of a boundary with normal in the positive @xmath11 direction .",
    "the numerical formulation of the poisson equation then becomes a system of @xmath252 simultaneous equations , where @xmath252 is the number of free ( non - constant ) nodes .",
    "the problem is often described as a matrix equation @xmath253 where @xmath254 is an @xmath255 matrix of coefficients , @xmath237 is a vector of coefficients from eqs .   and @xmath256 is the solution electric potential vector . in the case of plasma modelling , the poisson equation contains an analytical term for the space - charge density of the compensating plasma particles .",
    "this leads to a nonlinear poisson problem , which is typically formulated as @xmath257 in the typical scale of systems being investigated , @xmath252 is @xmath258@xmath259 , which makes the solution of eq .   computationally intensive .",
    "the problem is typically solved using @xmath252-dimensional newton  raphson methods with iterative linear solvers .",
    "the electric field is calculated using meshes with @xmath260 location offset from the electric potential map nodes to avoid making further approximations . for @xmath261 field",
    "the node location is @xmath262 , while @xmath263 and @xmath264 coordinates of the nodes are as before .",
    "the electric field is evaluated with @xmath265 and similarly for @xmath266 and @xmath267 as shown in fig .",
    "[ fig : efields ] .",
    "the near - solid distances ( @xmath17 and @xmath18 ) described before are also used here to modify the electric field calculation near the solids .",
    "the particles in this type of simulation represent several physical particles , and therefore they are typically called _ macro - particles_. each particle is given charge @xmath1 and mass @xmath268 , which are parameters of the physical particle , and current @xmath269 , which is a parameter of the macro - particle .",
    "the particle also has location @xmath270 and velocity @xmath271 , which are set according to the definition given by the user . in a typical case , where particles are starting inside the plasma ,",
    "the location is sampled from a quasi - random distribution to fill a cylindrical surface on the boundary of the simulation domain .",
    "the longitudinal @xmath10 component of the velocity is defined to be larger than the bohm velocity , while the transverse components are sampled from a gaussian distribution with standard deviation @xmath272 , where @xmath206 is the ion transverse temperature .",
    "the code also contains many other possibilities for beam definition , such as rectangular beams , beams with kv- or gaussian - distributed emittance pattern or definition of beam particle - by - particle .",
    "the propagation of particles in the simulation domain is calculated by integrating the particle equation of motion in the form of a set of ordinary differential equations .",
    "using the non - relativistic approximation in 3d , the set is @xmath273 the integration of the system of equations is done with a runge  kutta cash ",
    "karp adaptive algorithm and , at each step , the full set of particle coordinates @xmath274 is stored .",
    "the particle trajectories are used to calculate the space - charge density in the simulation domain .",
    "this is done by depositing the charge carried by the trajectories into the nodes of the mesh in which the poisson equation is solved .",
    "each particle trajectory carries current @xmath269 .",
    "the simulated macro - particles must have a finite size so that space charge can be defined . the simplest scheme for space - charge deposition would be to assume a box - like particle shape with @xmath275      0             & \\text{elsewhere } ,    \\end{cases}\\ ] ] where @xmath276 and @xmath277 are the coordinates transverse to the trajectory .",
    "this is known as the closest - node weighting and it is prone to numerical noise .",
    "a better solution is to distribute the space charge to closest nodes with bilinear weighting .",
    "the particle space - charge distribution @xmath278      0             & \\text{elsewhere } ,    \\end{cases }    \\label{eq : bilinear_space_charge}\\ ] ] leads to much smoother space - charge densities .",
    "the charge deposition to the nodes is done based on the closest distance from the trajectory , as shown in fig .",
    "[ fig : space_charge ] .     and height @xmath279 , where @xmath280 is line charge density carried by the 2d trajectory .",
    "( b )  as the particle passes through the domain , it covers mesh nodes with space - charge density according to the particle shape .",
    "the space charge deposited to mesh nodes is calculated according to the closest distance @xmath79 of the node from the trajectory.,title=\"fig:\",height=151 ]   and height @xmath279 , where @xmath280 is line charge density carried by the 2d trajectory .",
    "( b )  as the particle passes through the domain , it covers mesh nodes with space - charge density according to the particle shape .",
    "the space charge deposited to mesh nodes is calculated according to the closest distance @xmath79 of the node from the trajectory.,title=\"fig:\",height=151 ]    even with the smooth space charge deposition of eq .",
    ", the overall iteration may not converge in all cases . in a typical case a region of space",
    "gets a high @xmath281 , which leads to electric fields directing the particles away from the region in the next iteration round .",
    "this will lead to a low @xmath281 , which then leads to electric fields directing the particles into the area .",
    "this phenomenon happens easily especially where the particle velocities are low and trajectories get deflected by low electric fields .",
    "a simple method for suppressing the effect is to use under - relaxation of the space - charge map to avoid the over - shooting of @xmath281 .",
    "other computer codes that may be useful for ion optics include poisson superfish @xcite and femm @xcite , which can be used to calculate magnetostatics in 2d and cylindrically symmetric geometries using the finite element method , and radia-3d @xcite , which uses boundary integral methods to solve magnetostatic problems in 3d .",
    "commercial computational suites such as cobham vector fields @xcite , comsol multiphysics @xcite and ies lorentz @xcite provide advanced finite element- and boundary element - based field solvers .",
    "these packages provide nicely packaged , easily used tools with graphical user interfaces for typical problems such as electrostatic and magnetostatic field solution , heat transfer and even charged - particle tracers .",
    "unfortunately , serious plasma modelling capabilities are still missing from the commercial packages .",
    "all of the above - mentioned codes can be used together with ibsimu , for example , for providing @xmath23 field maps of magnetic elements .",
    "there also exist many specialized programs for modelling space - charge compensation , beam bunching , cyclotron injection , radio frequency quadrupole ( rfq ) acceleration , collisional ion source plasmas , etc .",
    ", with many different methods .",
    "the reader is encouraged to seek more information about such software from the literature and the world wide web .",
    "r.  thomae , r.  gough , r.  keller , k.  n.  leung , t.  schenkel , a.  aleksandrov , m.  stockli and r.  welton , beam measurements on the h@xmath9 source and low energy beam transport system for the spallation neutron source .",
    "instrum . _",
    "* 73 * ( 2002 ) 2016 .",
    "vay , p.  colella , j.  w.  kwan , p.  mccorquodale , d.  b.  serafini , a.  friedman , d.  p.  grote , g.  westenskow , j .- c .",
    "adam , a.  hron and i.  haber , application of adaptive mesh refinement to particle - in - cell simulations of plasmas and beams .",
    "plasmas _ * 11 * ( 2004 ) 2928 .",
    "r.  becker , mathematical formulation and numerical modelling of the extraction of h@xmath9 ions , proc .",
    "10th int . symp . on the production and neutralization of negative ions and beams .",
    "_ aip conf .",
    "* 763 * ( 2005 ) 194 .",
    "t.  kalvas , o.  tarvainen , h.  clark , j.  brinkley and j.  rje , application of 3d code ibsimu for designing an h@xmath9/d@xmath9 extraction system for the texas a&m facility upgrade , proc .",
    "2nd int . symp . on negative ions , beams and sources , takayama , japan",
    ". _ aip conf .",
    "_ * 1390 * ( 2011 ) 439 .",
    "r.  keller , d.  cheng , r.  digennaro , r.  a.  gough , j.  greer , k.  n.  leung , a.  ratti , j.  reijonen , r.  w.  thomae , t.  schenkel , j.  w.  staples , r.  yourd , a.  aleksandrov , m.  p.  stockli and r.  w.  welton , ion - source and low - energy beam - transport issues with the front - end systems for the spallation neutron source .",
    "instrum . _",
    "* 73 * ( 2002 ) 914 .",
    "t.  kalvas , r.  f.  welton , o.  tarvainen , b.  x.  han and m.  p.  stockli , simulation of h@xmath9 ion source extraction systems for the spallation neutron source with ibsimu .",
    "instrum . _",
    "* 83 * ( 2012 ) 02a705 .",
    "d.  c.  carey , k.  l.  brown and f.  rothacker , third - order transport with mad input  a computer program for designing charged particle beam transport systems , fermilab - pub-98/310 , fermi national accelerator laboratory , october 1998 ."
  ],
  "abstract_text": [
    "<S> this chapter gives an introduction to low - energy beam transport systems , and discusses the typically used magnetostatic elements ( solenoid , dipoles and quadrupoles ) and electrostatic elements ( einzel lens , dipoles and quadrupoles ) . </S>",
    "<S> the ion beam emittance , beam space - charge effects and the physics of ion source extraction are introduced . </S>",
    "<S> typical computer codes for analysing and designing ion optical systems are mentioned , and the trajectory tracking method most often used for extraction simulations is described in more detail . </S>"
  ]
}