{
  "article_text": [
    "the _ @xmath0-core _ of a graph @xmath1 is the maximal subgraph of @xmath1 with minimum degree at least @xmath0 ; if @xmath1 has no such ( non - trivial ) subgraph , then the @xmath0-core of @xmath1 is empty .",
    "this concept was introduced by bollobs  @xcite , in the context of finding large @xmath0-connected subgraphs of random graphs .",
    "as edges are added one by one to a graph , the @xmath0-core grows ; in particular , it is empty up to some point , and then non - empty ( and often large ) .",
    "the question of when the @xmath0-core emerges in a random graph ( or random graph process ) also arose in the context of finding the chromatic number of sparse random graphs ; more specifically , let @xmath9 be the erds - rnyi random graph with @xmath10 vertices , in which the possible edges are present independently , each with probability @xmath11 .",
    "if a graph has no @xmath0-core , it is @xmath0-colourable ; chvtal  @xcite used this to show that @xmath12 is whp  3-colourable . here ,",
    "as usual , an event holds _ with high probability _ , or whp , if it holds with probability @xmath13 as @xmath14 .",
    "it is natural to ask : for @xmath5 fixed , what is the critical value @xmath15 of @xmath16 above which a ( non - empty ) @xmath0-core first appears whp  in @xmath3 ?    there is a natural ` guess ' as to the answer , given by a branching process : let @xmath17 be a galton  watson branching process that starts with a single particle @xmath18 in generation zero , where the number of children of each particle has a poisson distribution with mean @xmath16 , and these numbers are independent for different particles .",
    "of course , @xmath17 provides a good ` local ' model of the neighbourhood of a vertex of @xmath3 .",
    "let @xmath19 be the event that @xmath18 has at least @xmath0 children each of which has at least @xmath20 children each of which has at least @xmath20 children each of which ",
    ", i.e. , that @xmath18 is in a @xmath0-regular tree contained in @xmath17 .",
    "( we reserve the notation @xmath21 for an associated event whose role in the analysis is more fundamental . ) let @xmath22 be the probability that @xmath17 has the property @xmath19 .",
    "one might expect that , up to probability @xmath23 , a vertex is in the @xmath0-core if its neighbourhoods up to a suitable distance have a property corresponding to @xmath19 , and thus that the fraction of vertices of @xmath3 in the @xmath0-core is @xmath24 ; this turns out to be the case .",
    "pittel , spencer and wormald  @xcite showed that , except at the critical point , the number of vertices in the @xmath0-core of @xmath3 is indeed @xmath25 . in particular ,",
    "the threshold @xmath2 for the emergence of the @xmath0-core is @xmath26 .",
    "recently , simpler proofs of this result have been given , as well as generalizations to various other contexts ; see , for example , @xcite . as far as we are aware , although the branching process heuristic was described already in @xcite , none of these proofs works by directly coupling the neighbourhoods of a vertex of the graph with the branching process ; there seems to be a problem relating the inescapably global property of lying in the @xmath0-core to a simple local property .",
    "here we give a new proof that does proceed in this way , using a carefully chosen ( and not very simple ) local property .",
    "as the proof will be a little involved , we give a very rough outline to motivate what follows : we shall define a certain event @xmath27 depending on the first @xmath28 generations of @xmath17 , where @xmath29 but @xmath30 , such that @xmath31 is almost as large as @xmath32 , and @xmath33 . as @xmath27 is a ` local ' event , the number of vertices in @xmath3 with ( neighbourhoods having the equivalent of ) property @xmath27 will be @xmath34 . defining @xmath27 in the right way",
    ", we can show that , given that a vertex has property @xmath27 , with probability @xmath35 it is the root of a @xmath0-regular tree of height at most @xmath28 all of whose leaves have property @xmath27 .",
    "but then whp  _ every _ vertex with property @xmath27 is the root of such a tree , and the union of these trees has minimum degree at least @xmath0 .",
    "most of the work will be in the analysis of the branching process : having found the right event , the translation to the graph will be relatively straightforward .",
    "unfortunately , the event @xmath27 we have to work with is rather complicated . roughly speaking , we look for a tree @xmath36 of height @xmath28 that branches a little faster than a @xmath0-regular tree .",
    "having found such a tree , if we select leaves of @xmath36 independently with an appropriate probability ( around @xmath37 ) , it is very likely that we can find a @xmath0-regular tree whose leaves are a subset of the selected leaves .",
    "when we explore the neighbourhood of a vertex @xmath38 in the graph , finding a tree @xmath36 as above , we then wish to explore from each leaf @xmath39 of @xmath36 to see whether the neighbourhoods of @xmath39 have the property @xmath27 . in doing this",
    ", it turns out that we can not afford to ignore the edge along which we reached @xmath39 when exploring from @xmath38 , and that we must re - use parts of the tree @xmath36 in establishing that @xmath39 has property @xmath27 .",
    "this , together with the need to achieve ( approximate ) independence of the explorations from different leaves @xmath39 , places rather subtle constraints on the properties @xmath27 we can use .",
    "the next section is devoted to the study of the @xmath0-core in @xmath3 . in section [ sec_nonunif ]",
    ", we turn to inhomogeneous random graphs : an advantage of the direct branching process approach is that it extends easily to other random graph models in which the neighbourhoods of a vertex can be modelled by a suitable branching process .",
    "this includes the general sparse inhomogeneous model of bollobs , janson and riordan  @xcite .",
    "indeed , the present work started at the conference random structures and algorithms 2005 in poznan , when alan frieze asked whether we knew the size of the @xmath0-core in this model .",
    "as a special case , we study the graph on @xmath40 $ ] in which edges are present independently , and the probability of an edge between @xmath41 and @xmath42 is @xmath43 for a parameter @xmath44 .",
    "we find the threshold ( in terms of @xmath4 ) at which the @xmath0-core appears in this graph , and the size of the @xmath0-core above this threshold ; in contrast to @xmath3 , just above the threshold the @xmath0-core is small .",
    "we start with some standard basic preliminaries .",
    "let us write @xmath45 for the probability measure associated to the branching process @xmath17 ; when discussing @xmath17 , we shall use the terms ` event ' and ` property of the branching process ' interchangeably , to refer to a ( measurable ) subset of the set of all rooted , unlabelled trees .",
    "when we say that a particle @xmath46 of the branching process has a certain property , we mean that the process consisting of @xmath46 ( as the new root ) and its descendants has the property . throughout we write @xmath18 for the initial particle of @xmath17 . when @xmath16 is clear from the context ( or specified in the notation for our probability measure ) , we may write @xmath47 for @xmath17 . many of the events and quantities we shall define below depend on @xmath0 . almost always , we regard @xmath48 as fixed and suppress this dependence .",
    "let @xmath49 denote the probability that a poisson random variable with mean @xmath16 takes a value that is at least @xmath50 .",
    "let @xmath51 be the event that @xmath47 contains a @xmath52-ary tree of height @xmath53 with @xmath18 as the root , and let @xmath54 be the event that @xmath47 contains an infinite @xmath52-ary tree with root @xmath18 . then @xmath55 . also , each particle in the first generation of @xmath17 has probability @xmath56 of having property @xmath51 .",
    "as these events are independent for different particles , the number of particles in the first generation with property @xmath51 has a poisson distribution with mean @xmath57 .",
    "thus , @xmath58 .",
    "since @xmath59 is a continuous , increasing function of @xmath46 , it follows that @xmath60 is given by the maximum solution @xmath11 to the equation @xmath61 .",
    "we denote this solution by @xmath37 . as in the introduction ,",
    "let @xmath19 be the event that @xmath47 contains an infinite @xmath0-regular tree with root @xmath18 , i.e. , that @xmath18 has at least @xmath0 children with property @xmath21 ; we shall write @xmath62 for the corresponding event depending only on the first @xmath53 generations , i.e. , that @xmath18 has at least @xmath0 children with property @xmath63 . note that @xmath64 let @xmath65 .",
    "it is easy to see that ( in this uniform case ) the functions @xmath37 and @xmath22 have a jump at @xmath66 ( for @xmath5 ) , and are continuous and strictly increasing for @xmath67 .",
    "pittel , spencer and wormald  @xcite proved the following result , with sharper error estimates .",
    "as usual , if @xmath68 is a sequence of random variables , we write @xmath69 if @xmath70 in probability ,",
    "i.e. , if @xmath71 whp  for any @xmath72 .",
    "[ t1 ] let @xmath5 be fixed , and define @xmath2 and @xmath22 as above .",
    "if @xmath73 is constant , then the number of vertices of @xmath3 in the @xmath0-core is @xmath25 as @xmath14 .",
    "note that the @xmath74-core of a graph @xmath1 is just the union of the cycles in @xmath1 , together with all paths joining two cycles .",
    "it is easy to see that a large @xmath74-core first appears in @xmath3 at the same time as the giant component , i.e. , when @xmath75 , although there may be a small @xmath74-core when @xmath76 . with the weak error bounds above , theorem [ t1 ]",
    "holds for @xmath77 as well . for us",
    ", there will be no difference between the cases @xmath77 and @xmath5 , although the latter is the more interesting .",
    "the proof of the upper bound is easy ; we postpone this to the end of the section .",
    "our proof of the lower bound will require considerable preparation .",
    "although the functions @xmath37 and @xmath22 are continuous except at @xmath66 , we shall avoid using this fact , with an eye to generalizations .    if @xmath78 , @xmath79 are properties of the branching process , with @xmath78 depending only on the first @xmath53 generations , let @xmath80 denote the event that @xmath78 holds if we delete from @xmath47 all particles in generation @xmath53 that do not have property @xmath79 .",
    "for example , with @xmath81 the property of having at least @xmath20 children , as above , @xmath82 , the property of having at least @xmath20 children with at least @xmath20 children ( and perhaps other children with fewer than @xmath20 children ) .",
    "let @xmath83 be the event that @xmath51 holds in a _ robust _ manner , meaning that @xmath51 holds even after any single particle in generation @xmath53 is deleted .",
    "then , as @xmath84 , the event @xmath85 is the event that @xmath21 holds after any single particle in generation @xmath53 is deleted . of course , whenever a particle is deleted ,",
    "so are its descendants .",
    "[ l1 ] if @xmath86 is continuous at @xmath16 then @xmath87 as @xmath88 .",
    "fix @xmath89 .",
    "consider the natural coupling of @xmath17 and @xmath90 , obtained by constructing @xmath17 , and then deleting each edge ( of the rooted tree ) independently with probability @xmath6 , and taking for @xmath90 the set of particles still connected to the root . in this coupling ,",
    "if @xmath21 does not hold for @xmath17 , it certainly does not hold for @xmath90 . furthermore ,",
    "if @xmath91 holds for @xmath17 , then there is some particle @xmath46 in generation @xmath53 such that if @xmath46 is deleted , then @xmath21 no longer holds .",
    "but the probability that @xmath46 is not deleted when passing to @xmath90 is exactly @xmath92 .",
    "it follows that @xmath93 since @xmath94 , the sequence @xmath95 is increasing . taking the limit of the inequality above , @xmath96 letting @xmath8 , the lemma follows",
    ".    it will often be convenient to _ mark _ some subset of the particles in generation @xmath53 . if @xmath97 is an event depending on the first @xmath53 generations",
    ", then we write @xmath98 for the event that @xmath97 holds after deleting all unmarked particles in generation @xmath53 .",
    "we write @xmath99 for the probability that @xmath98 holds when , given @xmath17 , we mark the particles in generation @xmath53 independently with probability @xmath11 .",
    "we suppress @xmath53 from the notation , since it will be clear from the event @xmath97 .",
    "let @xmath100    [ l2 ] let @xmath101 be fixed , with @xmath102 continuous at @xmath103 .",
    "then there is a @xmath53 such that @xmath104    let us construct a branching process @xmath105 as follows .",
    "start with @xmath106 .",
    "then , independent of @xmath106 , add a @xmath107 number of ` extra ' children of the initial particle .",
    "each extra child then has descendants as in @xmath106 .",
    "clearly , we may consider @xmath105 as a subset of @xmath108 .",
    "given @xmath109 , let us mark each particle in generation @xmath53 if it has property @xmath21 . now",
    "the descendants of a particle in generation @xmath53 have the distribution of @xmath106 , with independence for different particles .",
    "thus , given the first @xmath53 generations of @xmath105 , we mark each particle in generation @xmath53 independently with probability @xmath110 .",
    "hence , @xmath111 is at least the probability that @xmath85 holds in @xmath105 .",
    "each extra child has property @xmath21 independently with probability @xmath11 .",
    "hence , the event @xmath78 that there are at least @xmath0 extra children with property @xmath21 has probability @xmath112 .",
    "now @xmath78 is independent of @xmath106 .",
    "also , if @xmath78 holds in @xmath105 , then so does @xmath113 , and hence @xmath85 for any @xmath53 .",
    "thus , the probability that @xmath85 holds in @xmath105 is at least @xmath114 by lemma  [ l1 ] , as @xmath88 we have @xmath115 , so @xmath116 and there is a @xmath53 with @xmath117 , completing the proof .",
    "we shall use robustly branching trees , i.e. , rooted trees with height @xmath53 having property @xmath83 , in two ways .",
    "the first is the obvious way : we shall use the fact that at least two leaves must be deleted in order to destroy all branching subtrees , i.e. , all subtrees with property @xmath51 .",
    "the second is less direct , and is described in the next lemma , for which we first need a definition .",
    "we say that a finite rooted tree has the property @xmath118 if all its leaves are at distances between @xmath119 and @xmath53 from the root , and every non - leaf has degree at least  @xmath0 .",
    "[ brp ] let @xmath120 be a rooted tree of height @xmath121 that is minimal with respect to having property @xmath122 .",
    "let @xmath39 be a vertex of @xmath120 at distance @xmath53 from the root , and let @xmath123 be the parent of @xmath39 .",
    "if the graph @xmath120 is regarded as a rooted tree with root @xmath39 , then it has a subtree @xmath124 with the property @xmath125 , such that all leaves of @xmath124 are leaves of @xmath120 .    the proof is illustrated in figure [ fig1 ] .",
    "although it is not clear that a written proof adds anything to the figure , to be formal we include one .",
    "let @xmath126 denote the first @xmath53 generations of @xmath120 , a tree with property @xmath83 in which ( by minimality ) every non - leaf has at least @xmath20 children .",
    "by definition of the property @xmath83 , deleting @xmath39 from @xmath126 leaves a tree with property @xmath51 ; let @xmath127 be a minimal subtree of @xmath128 with property @xmath51 , so @xmath127 is a @xmath52-ary tree . in @xmath120",
    ", there is a unique path @xmath129 from @xmath39 to @xmath127 , meeting @xmath127 at @xmath130 , say . consider the tree @xmath124 obtained by taking @xmath129 together with the descendants in @xmath120 of every vertex of @xmath129 . regarding this tree",
    "as rooted at @xmath39 , the children of @xmath130 in @xmath124 are exactly its children in @xmath127 , of which there are @xmath20 .",
    "furthermore , any vertex @xmath131 of @xmath129 other than @xmath130 and @xmath39 has the same number of children in @xmath124 as in @xmath120 ( we lose one neighbour on @xmath129 and gain the other ) , which is at least @xmath20 .",
    "all other vertices of @xmath124 have the same children in @xmath124 as in @xmath120 , except for @xmath39 , which has one additional child @xmath123 in @xmath124 .",
    "thus all non - leaves of @xmath124 have at least @xmath20 children , the root @xmath39 has at least @xmath0 , and all leaves of @xmath124 are leaves of @xmath120 . observing finally that the height of @xmath124 is at most @xmath132 , the result follows .",
    "let us briefly recall harris lemma .",
    "let @xmath47 be a finite set ( here consisting of some or all possible edges of @xmath9 ) , and let @xmath133 be a random subset of @xmath47 formed by selecting each element independently with probability @xmath11 .",
    "an event @xmath134 is _ increasing _ if @xmath135 and @xmath136 imply @xmath137 , and _ decreasing _ if @xmath135 and @xmath138 imply @xmath137 .",
    "if @xmath139 are increasing events and @xmath140 , then @xmath141    in other words , increasing events are positively correlated .",
    "of course , it follows that decreasing events are also positively correlated .",
    "this was proved by harris in 1960  @xcite , and rediscovered by kleitman  @xcite .",
    "we shall need one simple lemma concerning @xmath9 ; this is because we wish to prove a result about the neighbourhoods of _ every _ vertex , and cycles within these neighbourhoods will cause problems . to avoid this , we consider the random graph @xmath142 whose distribution is that of @xmath3 conditioned on the absence of any cycles of length at most @xmath143 .",
    "although globally @xmath3 is very likely to contain cycles , locally , conditioning on their absence makes little difference : after this conditioning , given that a certain not too large set of edges is present , and that a certain other set of edges is absent , the probability that another edge is present is close to @xmath144 , as long as this edge would not complete a ` known ' cycle .",
    "[ l_small ] let a constant @xmath145 and a function @xmath146 be given . if @xmath10 is large enough then , whenever @xmath147 , @xmath148 and @xmath149 are disjoint sets of possible edges of @xmath142 with @xmath150 such that @xmath151 contains no cycle of length at most @xmath143 , we have @xmath152    let @xmath153 denote the ( distribution of the ) random graph @xmath154 conditioned on the presence of every edge in @xmath148 and the absence of every edge in @xmath147 , so the probability we wish to bound is @xmath155 .",
    "note that @xmath153 may be described as follows : start from @xmath3 , and first condition on the presence of the edges in @xmath148 and the absence of the edges in @xmath147 . at this point ,",
    "each edge of @xmath156 is present independently with probability @xmath144 .",
    "writing @xmath157 for the power - set of a set @xmath158 , we next condition on the event @xmath159 that the set of edges @xmath160 from @xmath161 present is such that the whole graph does not contain a short ( length at most @xmath143 ) cycle , i.e. , that @xmath162 does not contain a short cycle . in terms of the edges in @xmath160 ,",
    "the event @xmath163 is a decreasing event .",
    "the upper bound ( which we shall not in fact use ) is thus essentially trivial : as the event @xmath164 is increasing , by harris lemma @xmath165    for the lower bound , let us call a set @xmath166 a _ pre - cycle _ if it is minimal subject to @xmath167 containing a short cycle that includes the edge @xmath168",
    ". as legal configurations in the graph @xmath153 have the same relative probabilities in @xmath153 as in @xmath3 , the conditional probability @xmath169 is @xmath7 if @xmath170 contains a pre - cycle , and @xmath144 otherwise .",
    "thus , @xmath171 where the last step is again from harris lemma .",
    "thus , it suffices to show that with probability at least @xmath172 the set @xmath160 contains no pre - cycle .",
    "but any pre - cycle must include a path of length @xmath173 joining two vertices in @xmath174 , the set of endpoints of edges in @xmath175 .",
    "since @xmath176 , the expected number of such paths is at most @xmath177 if @xmath10 is large enough .",
    "hence , the probability that such a path is present is at most @xmath178 , and so is the probability that @xmath160 contains a pre - cycle , completing the proof .",
    "we are now ready to prove theorem  [ t1 ] .",
    "we start with the more difficult bound , the lower bound on the size of the @xmath0-core .",
    "note that @xmath37 and @xmath22 are continuous except at @xmath66 .",
    "( we shall not use this fact elsewhere in this proof . )",
    "hence it suffices to prove that if @xmath179 , then whp  the @xmath0-core of @xmath180 contains at least @xmath181 vertices .",
    "let us fix @xmath179 .",
    "we may assume that @xmath182 , as otherwise there is nothing to prove .",
    "fix any @xmath183 with @xmath184 continuous at @xmath185 .",
    "( an increasing function has at most countably many discontinuities . ) letting @xmath186 , we have @xmath187 .",
    "hence , @xmath188 thus we may choose @xmath189 so that @xmath190 we may also assume that @xmath37 is continuous at @xmath103 .",
    "by lemma [ l2 ] there is a constant @xmath53 such that holds ; fix such a @xmath53 .",
    "once @xmath37 is positive , it is strictly increasing , so @xmath191 .",
    "hence , by lemma [ l1 ] , there is a @xmath192 such that @xmath193 .",
    "set @xmath194 as @xmath195 is measurable , there is an integer @xmath196 and an event @xmath197 depending only on the first @xmath196 generations of the branching process such that @xmath198 , where @xmath199 denotes symmetric difference .",
    "we may and shall assume that @xmath200 .",
    "writing @xmath201 for the indicator function of an event @xmath97 , and @xmath202 $ ] for the first @xmath196 generations of the branching process , we have @xmath203\\bigr ) } \\bigr),\\ ] ] where @xmath204 is the expectation corresponding to @xmath205 . set @xmath206\\bigr ) } \\ge 1-\\eta \\bigr\\},\\ ] ] noting that the event @xmath207 depends only on the first @xmath196 generations of @xmath47 .",
    "since the expectation appearing in is at least @xmath208 , we have @xmath209 , so @xmath210 also , recalling that @xmath200 , so @xmath211 , whenever @xmath207 holds we have @xmath212\\bigr ) } \\ge   { { \\mathop{\\mathbb p{}}\\nolimits}}_{{\\lambda}_2}{\\bigl({{\\mathcal r}}_{d_1}{\\circ}{{\\mathcal b}}\\mid x[l]\\bigr)}\\ge 1-\\eta\\ge 1-k^{-3d}.\\ ] ]    let @xmath213 , and for @xmath214 set @xmath215 .",
    "thus , @xmath216 is a ` recursively robust ' version of the event @xmath217 . from the independence of the descendants of different particles in generation @xmath53 of @xmath108 we have @xmath218 thus ,",
    "by , , and induction on @xmath50 , we have @xmath219 for every @xmath50 . recalling that @xmath220 , let us note for later that @xmath221 where the final inequality is from .",
    "if @xmath97 depends on the first @xmath53 generations of @xmath47 , let @xmath222)$ ] denote the conditional probability given the first @xmath53 generations that @xmath98 holds if we mark particles in generation @xmath53 independently with probability @xmath11 .",
    "note that this conditional probability does not depend on @xmath16 . from , whenever @xmath213 holds we have @xmath223 ) = { { \\mathop{\\mathbb p{}}\\nolimits}}_{{\\lambda}_2}({{\\mathcal r}}_l{\\circ}{{\\mathcal b}}\\mid x[l ] )   \\ge 1-k^{-3d}.\\ ]",
    "] let @xmath224 , so @xmath225 and @xmath226 for @xmath227 .",
    "we claim that for any @xmath228 , whenever @xmath216 holds , then @xmath229 ) \\ge 1-k^{-(2^t+2)d}.\\ ] ] for @xmath230 , this is just .",
    "we prove the claim by induction on @xmath50 ; let us assume that @xmath227 , and that holds with @xmath50 replaced by @xmath231 .",
    "we condition on the first @xmath232 generations of @xmath47 , and assume that @xmath216 holds . since @xmath215 , there is a set @xmath233 of particles in generation @xmath53 such that @xmath234 holds for each @xmath235 , and @xmath236 holds if we mark only the particles in @xmath233 .",
    "as any tree witnessing @xmath83 contains a subtree witnessing @xmath83 in which each particle has at most @xmath0 children , we may assume that @xmath237 .",
    "now let us mark each particle in generation @xmath232 independently with probability @xmath238 , and let @xmath239 be the set of particles @xmath123 in @xmath233 such that @xmath240 holds for @xmath123 .",
    "each @xmath235 is included independently in @xmath239 , and , by the induction hypothesis , the probability that a particular @xmath235 is included is at least @xmath241 .",
    "thus @xmath242 from the definition of @xmath83 , whenever @xmath243 then @xmath51 holds if we keep in generation @xmath53 only the particles in @xmath239 .",
    "but then @xmath244 holds , proving .",
    "this proves the claim by induction .",
    "given an event @xmath97 , let @xmath245 be the event that there is a set @xmath158 of _ targets _ in generations between @xmath119 and @xmath246 such that @xmath97 holds for each target , and in the tree consisting of the targets and their ancestors every non - leaf ( i.e. , every non - target ) has degree at least @xmath0 ; in the notation of lemma  [ brp ] , we require the targets and their ancestors to form a tree with property @xmath247 .",
    "note that we need not ( and in general must not ) take all particles in generations between @xmath119 and @xmath246 that have property @xmath97 to be targets .",
    "thus , if @xmath97 is increasing , so is @xmath245 .",
    "let @xmath248 be any function with @xmath249 and @xmath250 .",
    "note that , until now , the branching process events we have defined do not depend on @xmath10 .",
    "set @xmath251 . since @xmath252 ,",
    "from we have @xmath253    let @xmath254 , so @xmath27 depends on the first @xmath255 generations of the branching process . by standard properties of branching processes , for any constant @xmath16 we have @xmath256|\\ge n^{1/10}\\bigr ) } = o(n^{-1}),\\ ] ] where @xmath257|$ ] is the total size of the first @xmath258 generations of the branching process .",
    "indeed , a simple calculation shows that for any @xmath259 we have @xmath260|^m)=o({\\lambda}^{mt})$ ] as @xmath261 .",
    "thus @xmath262|^{20}\\bigr)}=o{\\bigl({\\lambda}^{40s}\\bigr)}=o(n)$ ] , and follows by markov s inequality .    with this branching - process preparation behind us , we are now ready to turn to the graph @xmath180 .",
    "let @xmath263 be the graph obtained from @xmath180 by conditioning on the absence of any cycles of length at most @xmath264 .",
    "let @xmath265 denote the number of vertices in the @xmath0-core of a graph @xmath1 . as @xmath266 is an increasing event , while the absence of short cycles is a decreasing event , we have @xmath267 for any @xmath46 .",
    "hence it suffices to prove a lower bound for @xmath268 that holds whp  instead of the corresponding bound for @xmath265 .",
    "we shall work entirely with @xmath154 .",
    "let @xmath38 be a random vertex of @xmath154 , and explore its successive neighbourhoods @xmath269 , @xmath270 , in the usual way , where @xmath269 is the set of vertices of @xmath154 at graph distance @xmath50 from @xmath38 .",
    "we start with @xmath38 ` active ' and all other vertices ` untested ' . at each step",
    "we pick an ` active ' vertex @xmath39 closest to @xmath38 , and test edges from @xmath39 to untested vertices one by one , marking any neighbour of @xmath39 found in this way as ` active ' . after testing all possible edges from @xmath39",
    "we mark @xmath39 as ` tested ' . by lemma  [ l_small ] ,",
    "as long as we have reached at most @xmath271 vertices , conditional on everything so far each test succeeds with probability @xmath272 ; we never attempt to test an edge that might complete a cycle . as",
    "the number of untested vertices is @xmath273 , we may couple the number of new neighbours of @xmath39 found with a poisson distribution with mean @xmath274 so that the two numbers agree with probability @xmath275 .",
    "let @xmath276 $ ] be the subgraph of @xmath154 formed by the vertices within distance @xmath50 of @xmath38 , noting that for @xmath270 this graph is by definition a tree .",
    "since , whp , @xmath277 $ ] contains at most @xmath278 particles , whp  @xmath279 $ ] contains at most @xmath278 vertices .",
    "it follows from the coupling above that we may couple @xmath279 $ ] and @xmath277 $ ] so as to agree in the natural sense whp .",
    "let us say that @xmath38 has property @xmath27 if @xmath279 $ ] has property @xmath27 when viewed as a branching process , an event that depends only on @xmath280 $ ] .",
    "we have shown that @xmath38 has property @xmath27 with probability @xmath281 .    to establish concentration of the number of vertices @xmath38 with property @xmath27",
    ", we use a simple trick also used in @xcite .",
    "let @xmath38 and @xmath39 be independently chosen random vertices of @xmath154 . since the probability that @xmath38 and @xmath39 are within distance @xmath258 is @xmath23 , we may couple @xmath280 $ ] and @xmath282 $ ] with independent copies of @xmath283 $ ] so as to agree whp . hence , the probability that both @xmath38 and @xmath39 have property @xmath27 is @xmath284 .",
    "writing @xmath285 for the number of vertices with property @xmath27 , we thus have @xmath286 hence ( by chebyshev s inequality ) , @xmath287 converges in probability to @xmath288 thus , @xmath289 to complete the proof of the lower bound on the size of the @xmath0-core , it thus suffices to show that @xmath290 whp .",
    "we do this by showing that whp  _ every _ vertex with property @xmath27 is in the @xmath0-core .",
    "let @xmath38 be a random vertex of @xmath154 .",
    "let us test whether @xmath38 has property @xmath27 by exploring its neighbourhoods as follows .",
    "throughout we regard the graph @xmath279 $ ] as a branching process with @xmath38 as initial particle ; this is valid since the graph contains no cycles .",
    "thus we shall speak of the children and descendants of a vertex .",
    "if @xmath39 is a vertex in generation @xmath50 ( i.e. , at graph distance @xmath50 from @xmath38 ) , we shall write @xmath291 for the set of descendants of @xmath39 in generation @xmath292 . let @xmath293 and @xmath294 be initially empty sets of vertices . at each stage",
    ", every vertex in @xmath293 will have property @xmath295 in the tree / branching process rooted at @xmath38 . in other words , @xmath39 and its descendants will form a tree with property @xmath295 . recall that @xmath251 .",
    "first , let us reveal the descendants of @xmath38 unto generation @xmath296 . for each child @xmath39 of @xmath38 , examine its descendants to relative generation @xmath297 , to see whether @xmath39 has property @xmath295 .",
    "if so , put @xmath39 into @xmath293 and the vertices in @xmath291 into @xmath294 .",
    "if @xmath293 is large enough to guarantee that @xmath38 has @xmath27 , stop .",
    "( at this stage , this happens if and only if @xmath298 . ) otherwise , examine each @xmath39 in generation 2 that is not a descendant of a vertex in @xmath293 in turn . for each @xmath39 , reveal its descendants up to @xmath297 generations later , and test whether @xmath39 has @xmath295 .",
    "if so , include @xmath39 into @xmath293 and the vertices of @xmath291 into @xmath294 .",
    "continue in this way until either ( a ) the set @xmath293 shows that @xmath27 holds ( i.e. , @xmath293 contains a set of targets witnessing @xmath299 ) , or ( b ) we have tested all vertices in generations up to @xmath246 not descended from vertices in @xmath293 for property @xmath295 without finding such a set . in case ( b ) , @xmath251 does not hold .",
    "hence , @xmath38 has @xmath27 if and only if ( a ) holds .",
    "let us condition on @xmath38 having property @xmath27 .",
    "the key points are that this event is guaranteed by the vertices in @xmath294 and their ancestors , and that we have not examined the children of any vertex in @xmath294 .",
    "let us suppose that at most @xmath278 vertices have been examined , an event of probability @xmath35 by .",
    "we now examine the vertices @xmath300 one by one . for each @xmath39",
    "we explore its descendants for the next @xmath301 generations to test whether , in the branching process rooted at @xmath38 , the particle @xmath39 has the property @xmath302 .",
    "we abandon the exploration associated to a given @xmath39 if we reach more than @xmath278 vertices in this exploration .",
    "if the test is successful , we mark @xmath39 .",
    "note that , from , the probability that any exploration is abandoned is @xmath303 .",
    "provided no previous exploration has been abandoned , the argument above shows that we may couple the descendants of @xmath39 to agree with a branching process @xmath304 with probability @xmath13 .",
    "hence , if @xmath10 is large enough , the probability that we mark @xmath39 is at least @xmath305 using . in summary , ignoring an error probability of @xmath35 , we can view each @xmath300 as marked independently with probability ( at least ) @xmath238 .",
    "let @xmath306 be the tree rooted at @xmath38 with leaves the marked vertices in @xmath294 . since @xmath250 , we have @xmath307 if @xmath10 is large enough .",
    "hence , from , with probability @xmath35 every vertex of @xmath293 has property @xmath308 guaranteed by its descendants in @xmath306 , so with probability @xmath35 the tree @xmath306 has the property @xmath309 when viewed as a branching process .",
    "let us suppose that @xmath306 has property @xmath310 , and let @xmath311 be a minimal subtree with this property .",
    "recalling that @xmath312 , note that every non - leaf of @xmath311 has degree at least @xmath0 in @xmath311 .",
    "we claim that each leaf @xmath39 of @xmath311 has property @xmath27 in the graph @xmath154 . to see this ,",
    "let @xmath46 be the ancestor of @xmath39 in @xmath311 that is @xmath196 generations above @xmath39 , so the subtree @xmath126 of @xmath311 rooted at @xmath46 is a tree of height @xmath196 that is minimal with respect to having property @xmath313 .",
    "all leaves of @xmath126 are leaves of @xmath311 and hence marked , so they have the property @xmath302 in the tree @xmath279 $ ] rooted at @xmath38 .",
    "hence we may take @xmath20 children of each leaf and add them to @xmath126 to form a tree @xmath120 with property @xmath314 in which every leaf has property @xmath295 . by lemma  [ brp ] ,",
    "taking @xmath39 as the root , this tree @xmath120 has a subtree @xmath124 with property @xmath247 all of whose leaves are leaves of @xmath120 and hence have property @xmath295 .",
    "thus @xmath39 has property @xmath315 in the graph , as claimed .",
    "we have shown that with probability @xmath316 _ every _ vertex @xmath38 with property @xmath27 is the root of a tree @xmath311 in which each non - leaf has degree at least @xmath0 and each leaf has property @xmath27 ( in the graph @xmath154 ) .",
    "when this happens , the union of the trees @xmath311 is a subgraph of @xmath154 with minimum degree at least @xmath0 containing all @xmath285 vertices with property @xmath27 , so @xmath317 .",
    "this completes our proof of the lower bound .",
    "the proof of the upper bound on @xmath318 is much simpler : the events @xmath62 decrease to @xmath19 as @xmath88 .",
    "hence , given any @xmath72 , there is a @xmath53 with @xmath319 .",
    "exploring the first @xmath53 neighbourhoods of a random vertex @xmath38 of @xmath3 as above , the probability that we encounter a cycle is @xmath23 .",
    "let us say that @xmath38 has property @xmath62 if its @xmath53-neighbourhood is a tree with property @xmath62 .",
    "considering the local exploration described above for @xmath154 , in the simpler context of @xmath3 it is easy to check that @xmath320 vertices @xmath38 have property @xmath62 , while @xmath321 vertices have a cycle in their @xmath53-neighbourhood .",
    "but any vertex in the @xmath0-core must have one of these properties , so @xmath322 as @xmath72 was arbitrary , this completes the proof .",
    "theorem [ t1 ] implies that the natural coupling between the neighbourhoods of a vertex @xmath38 in @xmath3 and the branching process @xmath17 can be adapted to the @xmath0-core . with @xmath48",
    "fixed as usual , let @xmath323 denote the @xmath0-core of @xmath1 , and let @xmath324 denote the ( possibly empty ) branching process consisting of all particles in @xmath17 that are in a @xmath0-regular tree in @xmath17 containing the initial particle .",
    "[ cor1 ] let @xmath48 , @xmath145 and @xmath196 be fixed .",
    "if @xmath37 is continuous at @xmath16 , then the first @xmath196 neighbourhoods in @xmath325 of a random vertex of @xmath3 may be coupled with the first @xmath196 generations of @xmath324 so as to agree whp .",
    "we use only the result of theorem [ t1 ] , not anything from the proof .",
    "we may assume that @xmath326 , as otherwise @xmath327 is empty whp , while @xmath324 is empty with probability @xmath119 .",
    "since @xmath328 , if @xmath329 then @xmath330 .",
    "note that @xmath331 .    if @xmath329 sufficiently slowly then , by standard arguments , we may couple the branching process @xmath17 with the neighbourhood process @xmath332 so that whp  they agree for the first @xmath333 generations .",
    "( this follows from the @xmath53 constant case of the coupling . )",
    "if @xmath38 is in the @xmath0-core @xmath334 , then either @xmath335 holds for @xmath233 , or the first @xmath333 neighbourhoods of @xmath38 contain a cycle .",
    "now @xmath336 where the first step is from the coupling and the last from theorem [ t1 ] .",
    "provided @xmath337 , which we may assume , @xmath321 vertices @xmath38 have a cycle in their @xmath333-neighbourhoods .",
    "thus , whp  either all three of @xmath338 , @xmath339 and @xmath340 hold , or none .",
    "the argument above holds with @xmath341 in place of @xmath333 .",
    "let us call a vertex @xmath39 _ exceptional _ if it is within distance @xmath341 of a cycle , or if its neighbourhoods to distance @xmath341 have the property corresponding to @xmath342 but @xmath39 is not in the @xmath0-core .",
    "all other vertices are _",
    "normal_. then the probability that a given vertex @xmath39 is exceptional is @xmath23 , so there are @xmath321 exceptional @xmath39 . since , for any fixed @xmath50 , the @xmath50-neighbourhood of any set of @xmath321 vertices in @xmath3 has size @xmath321 , returning to the random vertex @xmath38 , with probability @xmath13 all vertices within distance @xmath196 of @xmath38 are normal .",
    "suppose that the coupling above succeeds for the neighbourhoods of a random vertex @xmath38 to distance @xmath333 , and let @xmath158 be the set of vertices near ( i.e. , within distance @xmath196 of ) @xmath38 that are in the @xmath0-core .",
    "as whp  every vertex near @xmath38 is normal , whp  @xmath158 is the set of vertices corresponding to particles @xmath123 in the first @xmath196 generations of @xmath17 with the property @xmath342 in the tree @xmath17 with @xmath123 as root .",
    "as @xmath196 is fixed and @xmath343 , this latter set agrees whp  with the set @xmath344 of particles @xmath130 in the first @xmath196 generations of @xmath17 having property @xmath19 in @xmath17 with @xmath130 as root , i.e. , contained in some infinite @xmath0-regular tree .",
    "but the set of particles in @xmath344 reachable from the root @xmath18 by a path in @xmath344 is just the first @xmath196 generations of @xmath324 , so whp  the first @xmath196 generations of @xmath324 correspond to the first @xmath196 neighbourhoods of @xmath38 in the @xmath0-core , as required .",
    "the argument above shows that , once we have the asymptotic number of vertices in the @xmath0-core @xmath334 , we can count up to @xmath321 all ` local ' structures in @xmath334 , including , for example , the number of vertices of a given degree .",
    "of course , we can also estimate the sum of the degrees , say , and hence the number of edges .",
    "more generally , we can estimate the sum of any function of the @xmath196-neighbourhood with a well - behaved tail , where the contribution from the @xmath23-probability case when the coupling breaks down is small .",
    "let @xmath345 be an isomorphism - invariant function of graphs @xmath1 rooted at a vertex @xmath38 .",
    "as in @xcite , we call @xmath346 an @xmath196-_neighbourhood function _ if it depends only on the subgraph of @xmath1 induced by the vertices within distance @xmath196 of @xmath38 .",
    "( thus the degree of @xmath38 in @xmath1 is a @xmath119-neighbourhood function . )",
    "we interpret @xmath347 in the natural way , viewing the branching process as a tree with root @xmath18 .",
    "[ tcount ] let @xmath48 , @xmath348 , @xmath349 and an @xmath196-neighbourhood function @xmath346 be given . if @xmath345 is bounded by a polynomial of the number of vertices in the @xmath196-neighbourhood of @xmath38 , then @xmath350 where @xmath334 denotes the @xmath0-core of @xmath3 .",
    "the simple proof follows exactly that of the corresponding result for the @xmath74-core of a more general graph , lemma 11.11 of @xcite . as the result is very unsurprising in the light of corollary [ cor1 ] ,",
    "we omit the proof .",
    "the condition that @xmath346 be polynomially bounded can be replaced by a fourth moment condition , as in @xcite .",
    "many random graph models have been considered in which edges are independent but different possible edges have different probabilities , including numerous ` sparse ' models generalizing @xmath3 , where the expected number of edges is linear in the number of vertices ; see @xcite and the references therein .",
    "a very general model of this type was introduced by bollobs , janson and riordan in @xcite ; let us recall the definitions .",
    "a _ ground space _ is a pair @xmath351 , where @xmath352 is a separable metric space and @xmath353 is a borel probability measure on @xmath352 .",
    "mostly , we shall consider the cases @xmath352 finite , with @xmath353 any ( strictly positive ) measure on @xmath352 , and @xmath354 $ ] or @xmath355 $ ] , with @xmath353 lebesgue measure .      a _ vertex space _",
    "@xmath360 is a triple @xmath361 , where @xmath351 is a ground space and , for each @xmath362 , @xmath363 is a random sequence @xmath364 of @xmath10 points of @xmath352 , such that @xmath365 as @xmath14 , for every @xmath353-continuity set  @xmath357",
    ".    the sequence @xmath366 will give the _ type _ of each vertex @xmath41 in a graph on @xmath40 $ ] still to be defined . the convergence condition",
    "says that distribution of the types of the vertices is essentially @xmath353 .",
    "more precisely , the empirical distribution @xmath367 of the types converges in probability to @xmath353 . in the _ finite - type _ case , where @xmath368=\\{1,2,\\ldots , r\\}$ ] and @xmath369 for @xmath370 , the condition says that the number @xmath371 of vertices of each type @xmath41 satisfies @xmath372 .",
    "no assumption is made about the dependence between the types of different vertices .",
    "finally , let @xmath373 be a kernel on the vertex space @xmath360",
    ". given the ( random ) sequence @xmath375 , let @xmath376 be the random graph on @xmath40 $ ] in which edges are present independently , and the probability that the edge @xmath377 is present is @xmath378    in other words , we assign vertices types from @xmath352 with the types asymptotically distributed according to @xmath353 , and then join vertices of types @xmath46 and @xmath123 with probability @xmath379 . if @xmath380 takes the constant value @xmath16 , then @xmath376 is exactly @xmath3 .",
    "the model just described includes many models of inhomogeneous graphs previously defined .",
    "as the model is very general , it may help to bear in mind a few special cases .",
    "the most fundamental is the finite - type case described above .",
    "this is an extremely natural generalization of @xmath3 , and has been considered earlier by several authors ( e.g. , sderberg @xcite ) , perhaps with slightly different assumptions on the distribution of the types .",
    "( for example , the types of the vertices being independent , or @xmath371 equal to @xmath381 or @xmath382 . ) several other interesting special cases have @xmath354 $ ] , @xmath353 lebesgue measure , and @xmath383 , so the probability that the edge @xmath377 is present is @xmath384 .",
    "taking @xmath385 gives @xmath386 ; minor variants of the corresponding random graph were introduced independently by dubins in 1984 ( see @xcite ) and by callaway , hopcroft , kleinberg , newman and strogatz  @xcite in 2001 ; see @xcite .    in order to prove results about @xmath376",
    ", some additional assumptions are needed to avoid pathologies .",
    "following @xcite , we assume throughout that @xmath380 is continuous almost everywhere on @xmath387 , that @xmath388 and that @xmath389 as @xmath390 .",
    "the last condition says that the number of edges of @xmath376 is ` what it should be ' , at least in expectation . without this condition ,",
    "it is impossible to relate the behaviour of @xmath376 to that of @xmath380 ( or rather , to that of the branching process @xmath391 defined below ) : changing @xmath380 on a set of measure zero should not affect the model , but @xmath376 may depend _ only _ on the values of @xmath380 on such as set , for example , when @xmath383 .",
    "surprisingly , the very natural and rather weak condition is enough to enable many results about @xmath376 to be proved ; see @xcite for a discussion of this .",
    "we shall need one further definition : a kernel @xmath380 on a ground space @xmath351 is _ reducible _ if @xmath392 and _ irreducible _ otherwise .",
    "roughly speaking , reducible kernels correspond to disconnected graphs ; much of the time , nothing is lost by considering only irreducible kernels .",
    "the actual definitions in @xcite are slightly more general in two ways ; firstly , the kernel @xmath380 is allowed to depend somewhat on @xmath10 .",
    "we shall not bother with this additional generality here .",
    "secondly , the number of vertices of @xmath376 need not be exactly @xmath10 , but may be @xmath393 .",
    "this latter relaxation complicates only the notation , not the proofs .",
    "the key to the analysis of @xmath376 turns out to be the multi - type galton ",
    "watson branching process @xmath391 associated to @xmath394 .",
    "this starts with a single particle @xmath18 whose type is distributed according to @xmath353 .",
    "each particle of type @xmath46 has a set of children whose types are distributed as a poisson process on @xmath352 with intensity @xmath395 . in other words ,",
    "the number of children with types in a subset @xmath356 has a poisson distribution with mean @xmath396 , and these numbers are independent for disjoint sets @xmath357 and for different particles ; see , for example , kallenberg @xcite .",
    "sometimes it will be convenient to start the process with a particle of a fixed type @xmath46 instead of a random type .",
    "we write @xmath397 for this branching process .",
    "if @xmath380 takes the constant value @xmath16 , then @xmath391 is just @xmath17 as defined in section  [ sec_unif ] . in general",
    ", the relationship of @xmath391 to @xmath376 is the same as that of @xmath17 to @xmath3 .",
    "for example , under suitable regularity conditions , which certainly hold in the finite - type case , the first few neighbourhoods of a random vertex @xmath38 of @xmath376 may be coupled with the branching process @xmath391 in the natural sense ( so that the type of a vertex is the same as the type of the corresponding particle in the branching process ) ; see @xcite .",
    "one of the main results of @xcite is that , under suitable mild assumptions , the size of the giant component in @xmath376 is asymptotically @xmath10 times the probability that the branching process @xmath391 never dies out .",
    "this generalizes the classical result giving the size of the giant component of @xmath3 in terms of @xmath17 .",
    "we shall write @xmath398 for the probability measure associated to @xmath391 , and @xmath399 for that associated to @xmath397 . thus , if @xmath27 is some property of rooted trees , we write @xmath400 , or simply @xmath401 , for the probability that @xmath391 has this property when viewed as a tree .",
    "turning to the @xmath0-core , let us define @xmath402 and @xmath403 as before , but for @xmath391 .",
    "thus @xmath404 , and @xmath405 .",
    "we shall also write @xmath406 for @xmath407 , and @xmath408 for @xmath409 . by analogy with the result for @xmath3 , we expect the @xmath0-core of @xmath376 to have size @xmath410 , at least under suitable conditions .",
    "the strategy of starting with the finite - type case , and then using approximation and monotonicity arguments to attack the general case , is used throughout @xcite .",
    "we use the same strategy here ; we have written the proof of theorem [ t1 ] so that it carries over almost immediately to the finite - type case . recall that we write @xmath265 for @xmath411 , where @xmath323 is the @xmath0-core of a graph @xmath1 .",
    "[ t2 ] let @xmath48 be fixed .",
    "let @xmath380 be a kernel on a vertex space @xmath412 with @xmath368 $ ] , @xmath413 , and @xmath414 for each @xmath41 .",
    "if the function @xmath415 is continuous at @xmath416 , then @xmath417    we may assume without loss of generality that @xmath380 is irreducible ; indeed , in the finite - type case , if @xmath380 is reducible the graph @xmath376 may be written as the disjoint union of two or more graphs given by instances of the same model with irreducible kernels .",
    "( as each @xmath371 is random , these graphs have a random number of vertices , but this does not matter . )    as in the proof of theorem [ t1 ] , the upper bound is easy . indeed , arguing as for @xmath3 , it is easy to see that for fixed @xmath53 one can couple the @xmath53-neighbourhoods of a random vertex @xmath38 of @xmath376 with the first @xmath53 generations of @xmath391 to agree with probability @xmath13 .",
    "the upper bound on the @xmath0-core follows as in the uniform case .    for the lower bound , it again suffices to prove that if @xmath179 , then whp  the @xmath0-core of @xmath418 contains at least @xmath419 vertices .",
    "the proof is essentially the same as in the uniform case , _ mutatis mutandis _ ; we indicate the changes briefly .",
    "the proof of lemma [ l1 ] extends unchanged .",
    "since @xmath369 for each @xmath41 , it then follows that @xmath420 as @xmath88 , for each @xmath421 $ ] . for @xmath422 , let @xmath423 be the probability that @xmath236 holds if we mark the particles in generation @xmath53 of @xmath424 independently , marking a particle of type @xmath42 with probability @xmath425 . in place of lemma [ l2 ]",
    "we obtain @xmath426 for every @xmath41 , where @xmath427 ; in the proof , we add @xmath428 ` extra ' particles of some type @xmath42 with @xmath429 .",
    "the irreducibility of @xmath380 guarantees that such a type @xmath42 exists , and also that @xmath430 for every @xmath42 whenever @xmath431 .",
    "lemma [ l_small ] adapts immediately , as harris lemma applies to random subsets obtained by selecting elements independently , even if the selection probabilities are different for different elements .",
    "next , in place of we have @xmath432 for each @xmath41 . arguing as for , but taking @xmath433 we find an event @xmath207 depending on the first @xmath196 generations with @xmath434 ) \\ge 1-k^{-3d}\\ ] ] whenever @xmath207 holds , and @xmath435 for each @xmath41 .",
    "it follows as before that @xmath436 for each @xmath41 , and the rest of the proof is essentially unchanged .",
    "the continuity condition in theorem [ t2 ] is non - trivial : unlike in the uniform case , @xmath437 may have several discontinuities .",
    "one way this can happen is when @xmath380 is reducible , so the graph decomposes into two separate pieces , whose @xmath0-cores may emerge at different points .",
    "perhaps surprisingly , this is not the only way .",
    "let @xmath438 , and set @xmath439 with @xmath440 .",
    "let @xmath441 , @xmath442 and @xmath443 , say . it is easy to check that a @xmath0-core first emerges near @xmath444 , where @xmath2 is the critical parameter for the emergence of a @xmath445-core in @xmath3 ; at this point , the vertices of type @xmath119 form a uniform random graph with large enough average degree to contain a @xmath0-core .",
    "when @xmath16 is close to @xmath2 , the probability @xmath446 that a vertex of type @xmath74 is in the @xmath0-core is related to the largest solution to @xmath447 , where @xmath448 is the ( unknown ) probability that a vertex of type @xmath119 is in the @xmath0-core . since @xmath449 , it is easy to check that the solution jumps near @xmath66 , and in fact that @xmath450 jumps from around @xmath451 to around @xmath452 .    as in the uniform case ,",
    "theorem [ t2 ] implies the equivalents of corollary [ cor1 ] and theorem [ tcount ] for the finite - type case .",
    "the statements and proofs are direct translations of those in section [ sec_unif ] , so we omit them .",
    "theorem [ t2 ] extends easily to more general kernels under some mild assumptions . to state these",
    ", we need another definition : a kernel @xmath453 is _ regular finitary _ if there is a partition of @xmath352 into a finite number @xmath454 of @xmath353-continuity sets @xmath455 , such that @xmath453 is constant on each @xmath456 .",
    "such kernels correspond to finite - type kernels in an obvious way .",
    "when studying the @xmath0-core in @xmath3 , we assumed that @xmath184 ( or , equivalently , @xmath457 ) was continuous from below at @xmath16 , i.e. , that @xmath458 for every sequence @xmath459 .",
    "of course , it makes no difference if we consider only one sequence @xmath460 , as long as this increases strictly to @xmath16 .",
    "it is this latter , formally weaker , condition that we shall adapt to general kernels , with the restriction that our kernels tending up from below be of finite type .",
    "when studying @xmath376 , we shall assume that the functional @xmath461 is _ continuous from below at @xmath380 _ , in the weak sense that @xmath462 for _ some _ sequence @xmath463 of regular finitary kernels with @xmath464 for all @xmath46 and @xmath123 , and some sequence @xmath465 of real numbers with @xmath466 for all @xmath259 .",
    "( equivalently , we require @xmath467 for some finite - type kernels @xmath463 with @xmath468 for all @xmath259 . when @xmath469 , this is equivalent to continuity from below in the usual sense . ) as we have seen , this is a non - trivial condition ; however , we expect it to hold for almost all @xmath380 , in some imprecise sense .",
    "we return to this later .",
    "also , it may well be the case that , if @xmath380 is irreducible , then this condition is equivalent to the condition that @xmath467 for _ all _ sequences @xmath463 of ( arbitrary ) kernels increasing to @xmath380 ( almost everywhere ) .",
    "note that @xmath470 is always continuous from above : if @xmath463 is a sequence of kernels decreasing pointwise to @xmath380 , then one can couple the branching processes @xmath471 and @xmath391 so that @xmath472 , and @xmath473 .",
    "it follows that @xmath474 .",
    "our continuity assumption can be viewed as the assertion that @xmath475 edges will not change the size of the @xmath0-core much . due to the flexibility of the model",
    ", it would be unreasonable to expect a precise result without this condition ; as shown in @xcite , the condition used to exclude pathologies still permits the insertion of @xmath321 edges into @xmath376 in a more or less arbitrary way , while changing @xmath380 on a set of measure zero , which does not alter @xmath403 .",
    "our second assumption will state essentially that a small set of ` exceptional ' vertices ( or edges ) can not have many vertices in its @xmath196-neighbourhood , for any fixed @xmath196 .",
    "perhaps the most natural form of this assumption involves counting paths : let @xmath476 denote the number of @xmath143-edge paths in a graph @xmath1 , let @xmath477 and suppose that @xmath478 as @xmath14 , for each @xmath479 .",
    "the convergence condition says essentially that the expected number of paths in @xmath376 is ` what it should be ' .",
    "as shown in @xcite , it holds whenever @xmath380 is bounded , or whenever the types of the vertices are independent with distribution @xmath353 .",
    "theorem 17.1 in @xcite shows that convergence in expectation in implies convergence in probability ; we shall not directly use this fact .    by lemma 7.3(ii ) of @xcite , there is a sequence of regular finitary kernels @xmath463 with @xmath480 pointwise , such that @xmath481 for almost all @xmath482 . from dominated convergence",
    "we have @xmath483 for each @xmath143 .",
    "it is easy to check that for a regular finitary kernel @xmath453 we have @xmath484 in particular , if holds then as @xmath485 we have @xmath486 since @xmath480 , we may couple @xmath487 and @xmath376 so that @xmath488 . condition says essentially that , if @xmath143 is fixed and @xmath489 , then almost all paths of length @xmath143 in @xmath376 are already present in the subgraph @xmath490 .",
    "the actual assumption we shall need is a tiny bit weaker .",
    "we shall assume that there is an increasing sequence @xmath463 of regular finitary kernels with @xmath480 pointwise , and a coupling @xmath488 , with the following property : for any @xmath479 and any @xmath72 there is an @xmath491 such that @xmath492 for all @xmath493 and all large enough @xmath10 , where @xmath494 is the set of vertices that are endpoints of a path of length @xmath143 in @xmath376 not present in @xmath487 .",
    "in other words , if @xmath489 , then @xmath495 .",
    "as a path has a bounded number of endpoints , immediately implies this condition : all paths present in @xmath487 are also present in @xmath376 , and the expected number of additional paths is small .",
    "[ t3 ] let @xmath48 be fixed .",
    "let @xmath380 be a kernel on a vertex space @xmath360 .",
    "suppose that @xmath380 is continuous almost everywhere on @xmath387 , and that and hold .",
    "if , in addition , @xmath461 is continuous at @xmath380 in the sense of , and holds , then @xmath496 as @xmath14 .",
    "let @xmath463 be a sequence of regular finitary kernels with @xmath480 pointwise , and @xmath465 a sequence of real numbers with @xmath466 , such that @xmath497 .",
    "such sequences exists by our continuity assumption .",
    "let @xmath72 be arbitrary .    since @xmath497",
    ", there is an @xmath259 with @xmath498 .",
    "since @xmath499 is an increasing , continuous function of @xmath4 , there is a @xmath4 with @xmath500 at which this function is continuous . as @xmath501 for all @xmath46 and @xmath123 , we may couple @xmath502 and @xmath376 so that @xmath503 for every @xmath10 . applying theorem [ t2 ] to the finite - type kernel corresponding to @xmath504 in the natural way , we have @xmath505 so whp@xmath506    to prove the upper bound , let @xmath480 be a sequence of regular finitary kernels satisfying .",
    "( we shall not assume that @xmath507 for this sequence . ) since @xmath328 , there is a @xmath53 with @xmath508 . by , for any @xmath509",
    "there is an @xmath259 such that @xmath510 for all @xmath511 and all large enough @xmath10 .",
    "let @xmath38 be a vertex of @xmath376 , so @xmath38 is also a vertex of @xmath487 .",
    "if @xmath38 is in the @xmath0-core of @xmath376 , then either the @xmath53-neighbourhood @xmath512 of @xmath38 in @xmath376 contains a tree with the property @xmath62 , or it contains a cycle .",
    "thus , one of the following three cases holds : ( i ) @xmath513 contains a tree with property @xmath62 , ( ii ) @xmath513 contains a cycle , or ( iii ) @xmath512 contains an edge not present in @xmath487 . in case ( iii ) , @xmath38 is an endpoint of a path of length at most @xmath53 contained in @xmath376 but not in @xmath487 , i.e. , @xmath514 . from , with probability @xmath515",
    "there are at most @xmath516 such @xmath38 . by the finite - type equivalent of corollary [ cor1 ] ,",
    "the number of vertices with property ( i ) is @xmath517 also , by the same result , or by directly counting short cycles ( noting that @xmath463 is bounded ) , only @xmath321 vertices @xmath38 have property ( ii ) .",
    "it follows that , for any @xmath518 , if @xmath10 is large enough we have @xmath519 with probability at least @xmath520 .        in some sense , under mild assumptions , theorem [ t3 ] is the complete answer to the question `",
    "how large is the @xmath0-core in @xmath376 ? ' in another sense , it is just the beginning : it remains to determine @xmath403 .",
    "although there is no further combinatorics involved , depending on the form of the solution required , this is in general very difficult .",
    "however , it is very easy to determine @xmath403 in terms of the solution to a certain functional equation .    from the definition of @xmath522 and the definition of the branching process , we have @xmath523 indeed , starting with a particle of type @xmath46 , the number of children having property @xmath21 is poisson with mean @xmath524 . with",
    "@xmath380 fixed , we regard as a functional equation in a function @xmath525 . arguing as in the uniform case , it is easy to see that @xmath406 is given by the maximum solution to this equation ( i.e. , the supremum of all solutions , which is itself a solution ) . arguing as for",
    ", we have @xmath526 while , of course , @xmath527    turning to the continuity of @xmath528 at @xmath380 , suppose that @xmath529 , and define @xmath530 by @xmath531 this limit exists as the sequence is increasing and bounded by @xmath119 . by monotone convergence ,",
    "@xmath532 for every @xmath46 , so @xmath533 in other words , @xmath530 also satisfies the functional equation .",
    "also , again by monotone convergence , @xmath534 in sufficiently nice cases , this can be used to establish the continuity of @xmath380 , by showing that the functional equation has only one strictly positive solution , and using a simple special form of @xmath535 to ensure that @xmath536 .",
    "one of the most studied examples of the general model @xmath376 is the following : let @xmath354 $ ] , with @xmath353 lebesgue measure , let @xmath537 , and set @xmath383 .",
    "then the edges of @xmath376 are present independently , and the probability that the edge @xmath377 is present is @xmath43 , or , if @xmath538 , the minimum of this quantity and @xmath119 .",
    "this random graph @xmath376 is the ` mean - field ' version of the ` scale - free ' random graph introduced by barabsi and albert in @xcite as a model of the world - wide web , and studied in many papers , especially in the computer science and statistical physics literature .    for this kernel , @xmath539 for all @xmath540 : the ` early ' vertices ( with @xmath541 small )",
    "have large degree , and , while the average degree is bounded as @xmath14 , the average square degree is not .",
    "if @xmath143 is fixed , @xmath541 is bounded away from zero , and @xmath8 slowly , then the expected number of paths from vertex @xmath41 to an ` early ' vertex @xmath42 with @xmath542 is large ( order @xmath543 ) , and one can check that does not hold . on the other hand ,",
    "it is easy to check that the probability that there is such a path tends to zero uniformly in @xmath10 as @xmath8 . indeed , this probability is bounded by the expected number of _ late  early _ paths of length at most @xmath143 starting at @xmath41 , where a late  early path is a path all of whose vertices have indices at least @xmath516 , apart from the last vertex which does not ; see section 4 of @xcite .",
    "let @xmath544 be the ` truncated ' kernel that agrees with @xmath380 on @xmath545 ^ 2 $ ] and is zero otherwise ; in the graph , this corresponds to deleting all edges incident with early vertices . from the observation above , if @xmath546 , then @xmath321 vertices are within graph distance @xmath143 of an early vertex , so only @xmath321 vertices of @xmath376 are incident with a path of length @xmath143 in @xmath376 not present in @xmath547 .",
    "letting @xmath8 slowly enough , it is easy to approximate the bounded kernels @xmath544 by regular finitary kernels ( for example , step functions ) , and so to deduce that holds .",
    "thus we shall be able to apply theorem [ t3 ] , if we can establish the required continuity of @xmath470 .",
    "since we shall vary the parameter @xmath4 , it will be convenient to write @xmath380 as @xmath548 , where @xmath549 .",
    "the size of the giant component in @xmath550 was found in @xcite ; in section 6.1 it was shown that the size is @xmath551 , where @xmath552 is the survival probability of the branching process @xmath553 .",
    "( this is a special case of the main result of @xcite . ) in section 6.2 of @xcite , this survival probability is calculated in terms of the exponential integral .",
    "it turns out that there is a giant component for _ any _ @xmath44 , although it is extremely small when @xmath4 is small : @xmath554 as @xmath555 , where @xmath556 is euler s constant .",
    "one might expect that for @xmath0 fixed , there would be a @xmath0-core in @xmath550 for any @xmath44 , perhaps with size a constant fraction of that of the giant component when @xmath4 is small . in fact , there is a positive threshold above which the @xmath0-core first appears . just above this threshold ,",
    "the @xmath0-core is small : this is in sharp contrast to @xmath3 . in this result",
    "we write @xmath557 for @xmath470 when it is necessary to indicate the dependence on @xmath0 .",
    "[ t4 ] let @xmath549 . for @xmath44 ,",
    "let @xmath550 be the graph on @xmath40=\\{1,2,\\ldots , n\\}$ ] in which edges are present independently , and the probability that @xmath41 and @xmath42 are joined is @xmath558 . for each @xmath48",
    "we have @xmath559        thus , there is always a ` giant ' @xmath74-core ; for small @xmath4 its size is essentially the square of that of the giant component ( times a factor @xmath566 , which is logarithmic in terms of the normalized size of the giant component ) . for @xmath5 ,",
    "the @xmath0-core emerges at a positive threshold , @xmath567 , and does so slowly . in the terminology of @xcite , for @xmath5 the emergence of the @xmath0-core exhibits a phase transition of _ exponent _ @xmath568 , where this is the exponent of @xmath6 appearing above",
    "this contrasts with the exponent @xmath7 transition in @xmath3 .",
    "( the term ` order ' is often used in this context , but not always in the same way . )      for the second and third statements , let us write @xmath522 for @xmath569 , which depends on @xmath4 and also on @xmath0 .",
    "then equation becomes @xmath570 define @xmath571 by @xmath572 then @xmath573 so to determine @xmath522 it remains to determine @xmath357 .",
    "substituting into , we see that @xmath574 , where @xmath575 so far the argument is very similar to that in section 6.2 of @xcite ; indeed , for @xmath77 the event @xmath21 is the event that the branching process survives , so @xmath522 is the probability of survival starting with a particle of type @xmath46 ; this is denoted @xmath576 in @xcite ( see page 919 ) , where it is given by with @xmath577 as @xmath555 , where @xmath556 is euler s constant .",
    "it turns out that the case @xmath5 is much easier to handle .",
    "suppose that @xmath5 .",
    "then , substituting @xmath578 , so @xmath579 , we have @xmath580 where @xmath581 for any given @xmath5 , it is straightforward to calculate @xmath582 explicitly . indeed , @xmath583 , and for @xmath584 we have @xmath585 .",
    "thus , for @xmath5 , @xmath586 in particular , @xmath587 .",
    "it is easy to verify by differentiating that @xmath588 so @xmath589 also , for each @xmath590 , @xmath591 which is @xmath592 times a polynomial in @xmath593 that may be easily evaluated . rather than do this , let us note that , as @xmath594 , @xmath595 so @xmath596    note that @xmath597 is decreasing ( from the form of )",
    ". thus the equation @xmath598 has a positive solution if and only if @xmath599 , i.e. , if and only if @xmath600 .",
    "furthermore , when @xmath600 , the solution @xmath601 is unique .",
    "recalling that any solution to the functional equation has the form with @xmath357 satisfying @xmath574 , and that the probability @xmath608 is given by the maximum solution to this equation , we have shown that if @xmath609 , then @xmath610 for all @xmath46 , while if @xmath611 , then @xmath612 using and , we have @xmath613 if @xmath609 .",
    "otherwise , @xmath614 let @xmath615 as @xmath594 we have @xmath616 hence , from and , @xmath617 which is exactly .      to complete the proof of theorem [ t4 ]",
    ", it remains to show that there is a sequence @xmath463 of finite - type kernels with @xmath619 for every @xmath259 , such that @xmath620 .",
    "we may assume that @xmath600 , as otherwise @xmath613 and there is nothing to prove .",
    "given a sequence @xmath463 tending up to @xmath380 , let @xmath530 be defined by .",
    "then , from , the function @xmath621 also satisfies the functional equation .",
    "we have shown above that this functional equation has exactly two solutions , the zero function , and @xmath522 . hence ,",
    "writing @xmath622 for @xmath623 , from we have @xmath624 or @xmath625 .",
    "we shall rule out the former case by constructing the first element @xmath535 of our approximating sequence suitably . as a first step , we consider a bounded kernel that approximates @xmath548 .",
    "let @xmath626 be fixed .",
    "given @xmath72 , let @xmath544 be the kernel given by @xmath627 if @xmath46 , @xmath628 , and @xmath629 otherwise . arguing exactly as for @xmath548 , we have @xmath630 for @xmath631 , and @xmath632 otherwise , where @xmath633 is the largest solution to @xmath634 , with @xmath635 since @xmath636 , there is a @xmath637 with @xmath638 ; fix such a @xmath593 . as @xmath8",
    ", we have @xmath639 , so there is an @xmath72 with @xmath640 .",
    "it follows that @xmath641 , and hence that @xmath642 . to complete the proof ,",
    "let @xmath535 be a regular finitary kernel with @xmath643 for all @xmath644 .",
    "such a kernel is easy to construct as @xmath380 is continuous and bounded away from @xmath7 on the compact set @xmath545 ^ 2 $ ] , where it coincides with @xmath544 .",
    "it is easy to construct a sequence of finite - type kernels @xmath463 with @xmath645 , with @xmath463 tending up to @xmath548 and starting with this particular @xmath535 . then @xmath646 .",
    "since @xmath624 or @xmath647 , we have @xmath647 as required .",
    "there is a sense in which theorem [ t4 ] does not illustrate the full power of theorem [ t3 ] .",
    "indeed , the kernel @xmath648 has a special property : it may be written as @xmath649 for some function @xmath650 on @xmath352 .",
    "such kernels are called _ rank 1 _ in @xcite .",
    "the branching process corresponding to a rank 1 kernel is much simpler than the general case : roughly speaking , while the distribution of the _ number _ of children of a particle depends on its type , the distribution of their _ types _ does not .",
    "there is a minor variant of the model @xmath376 , where the edge probabilities are taken as @xmath651 , so @xmath652 . as in @xcite ,",
    "all our results here apply equally to this variant . as noted in section 16.4 of @xcite , using this variant , if @xmath380 has rank 1 then , conditional on the degree sequence , @xmath376 is equally likely to be any graph with the given degree sequence . thus the structure of @xmath376 is simpler than in the general case . also , @xmath376 is then closely related to random graphs defined by first fixing a degree sequence ( perhaps exactly , or perhaps asymptotically ) , and then choosing a random graph with this degree sequence .",
    "graphs of this form have been studied by many authors , including molloy and reed @xcite in the general case , and aiello , chung and lu @xcite in the power - law case .",
    "the @xmath0-core of such graphs has been studied by janson and luczak @xcite and by fernholz and ramachandran @xcite ; it is probable that theorem [ t4 ] could be proved by the methods of either of these papers , although the calculation of @xmath653 must still be carried out .",
    "in fact , fernholz and ramachandran studied the @xmath0-core in random graphs with a given power - law degree sequence with exponent @xmath654 : they assume a limiting fraction @xmath655 of vertices with degree @xmath41 for each @xmath656 . when @xmath657 , this model is very close to @xmath550 , where the degree distribution satisfies @xmath658 as @xmath659 , for a constant @xmath131 depending on @xmath4 .",
    "note , however , that , having fixed the degree exponent , the model considered here is much more flexible , due to the presence of the parameter @xmath4 , which allows control of the overall number of edges .",
    "for this reason , the result in @xcite , that whp  there is a @xmath0-core if @xmath660 , and whp  there is no @xmath0-core when @xmath661 , gives no insight into the transition studied in theorem [ t4 ] . roughly speaking ,",
    "the @xmath657 case of this result corresponds to showing that there is no @xmath445-core in @xmath550 for a specific @xmath4 .",
    "however , the correspondence is not direct : in the model of @xcite , the presence or absence of the @xmath0-core depends very much on the entire degree distribution , not just its asymptotics , and in @xmath550 , the distribution of the small degrees does not follow exactly a power - law",
    ".    it would be interesting to use theorem [ t3 ] to compute the size of the @xmath0-core in examples of @xmath376 where @xmath380 does not have rank one .",
    "a particularly interesting case is the kernel @xmath662 on @xmath663 ^ 2 $ ] , corresponding to the ` uniformly grown random graph ' proposed by dubins ( as an infinite random graph ) in 1984 ( see  @xcite ) .",
    "a closely related model was introduced by callaway , hopcroft , kleinberg , newman and strogatz  @xcite in 2001 .",
    "the emergence of the giant component in this model shows particularly interesting behaviour : at @xmath664 there is an ` infinite order ' phase transition ; see  @xcite .",
    "the functional equation is likely to be harder to handle in this case , but may well still be tractable . indeed , although the exact solution could not be calculated , good bounds on the size of the giant component just above the transition were obtained in @xcite by bounding the solution to a related functional equation for the giant component in a generalization of this model .",
    "b.  bollobs , s. janson and o.  riordan , the phase transition in inhomogeneous random graphs , to appear in _",
    "random structures and algorithms_. preprint available from `  ~http://www.arxiv.org / abs / math.pr/0504589 `                r.  durrett , rigorous result for the chkns random graph model , proceedings , discrete random walks 2003 , cyril banderier and christian krattenthaler , eds",
    ". _ discrete mathematics and theoretical computer science _ * ac * ( 2003 ) , 95104 . `"
  ],
  "abstract_text": [
    "<S> the _ @xmath0-core _ of a graph @xmath1 is the maximal subgraph of @xmath1 having minimum degree at least @xmath0 . in 1996 , </S>",
    "<S> pittel , spencer and wormald found the threshold @xmath2 for the emergence of a non - trivial @xmath0-core in the random graph @xmath3 , and the asymptotic size of the @xmath0-core above the threshold . </S>",
    "<S> we give a new proof of this result using a local coupling of the graph to a suitable branching process . </S>",
    "<S> this proof extends to a general model of inhomogeneous random graphs with independence between the edges . as an example , we study the @xmath0-core in a certain power - law or ` scale - free ' graph with a parameter @xmath4 controlling the overall density of edges . for each @xmath5 </S>",
    "<S> , we find the threshold value of @xmath4 at which the @xmath0-core emerges , and the fraction of vertices in the @xmath0-core when @xmath4 is @xmath6 above the threshold . </S>",
    "<S> in contrast to @xmath3 , this fraction tends to @xmath7 as @xmath8 . </S>"
  ]
}