{
  "article_text": [
    "the prospect of high precision all sky maps of the cosmic microwave sky from the map and planck satellites has galvanized cosmology . these maps will contain millions of accurate , independent temperature measurements which can be used to test theories of the early universe and cosmic structure formation . this paper deals with the very practical issue of how to store the data so that it can be easily manipulated and analyzed .",
    "in particular we discuss the question of how to pixelize the sky .",
    "this is clearly a question of some importance : data of this quantity and quality are likely to form the basis for much of cosmology over the next decade .",
    "as we shall discuss , the right choice of pixelization will both dramatically improve and accelerate analysis .",
    "numerous suggestions for pixelization of the sky have already been made @xcite .",
    "the simplest uses equal divisions in latitude and longitude ( @xmath2 and @xmath3 ) .",
    "this has been called the equidistant cylindrical projection ( ecp ) .",
    "it has the advantages of being both azimuthal and simply hierarchical , in that the data can be easily coarse grained by combining neighbouring pixels .",
    "the azimuthal symmetry allows for fast spherical harmonic transforms , speeding many operations such as map simulation and inversion@xcite .",
    "the biggest failure of the ecp pixelization is that the pixels near the poles are small and very distorted . in a real experiment",
    ", they might be very noisy or even contain no data at all .",
    "these extra pixels are also wasteful in later analysis .",
    "the ecp scheme can be improved upon by grouping more and more pixels together as one approaches the pole , and this is the idea behind the pixelizations we advocate below .",
    "previous all sky cmb maps , produced by the cobe satellite , used a pixelization based on the quadrilateralized sky cube projection , or ` quad cube ' @xcite .",
    "the edges of a cube are projected onto a sphere , dividing the sky into six equal areas .",
    "these are subdivided into a roughly square , hierarchical lattice .",
    "the main drawback of the resulting pixelizations is their lack of azimuthal symmetry , making spherical harmonic transforms time consuming . other suggested pixelizations have hexagonal instead of square pixels .",
    "one is an icosahedral version of the quad cube @xcite , another is a class based on fullerenes @xcite .",
    "while these pixels are closest to the ideal , round pixels , they lack azimuthal symmetry or any obvious hierarchical structure for coarse graining .",
    "gorski and collaborators have recently made available a package of programs , called healpix , which include a novel pixelization scheme based on a rhombic dodecahedron and associated software for performing fast spherical transforms @xcite .",
    "the centers of the healpix pixels are located on a lattice possessing discrete azimuthal symmetry at each latitude .",
    "such symmetry is essential for making use of fast fourier transforms with respect to the azimuthal coordinate @xmath3 .",
    "however in healpix the pixel shapes vary around circles of constant latitude , so the integrations needed for spherical transforms are only performed approximately , effectively assuming the pixels are azimuthally symmetric , identical and round .",
    "in contrast , the pixelizations we consider do possess exact azimuthal symmetry at each latitude , so that we can perform the the integrations needed for spherical transforms exactly .",
    "an attractive feature of the ` igloo ' schemes we focus on is that they have an exact discrete azimuthal symmetry at each latitude , allowing fast and exact spherical harmonic transforms . in particular , this allows one to rapidly create simulated skies in which the effects of pixels smoothing have been exactly included ( up to machine accuracy ) .",
    "the ability to perform such transforms quickly is also likely to be essential to computing the angular power spectrum of the observed sky ( for a recent discussion see @xcite ) .    for comparative purposes we consider several different igloo schemes , which satisfy the following criteria to varying extents :    * lack of pixel distortion ",
    "pixelization of the data suppresses modes with wavelengths shorter than the pixel dimensions in any given direction . to minimize this effect one should try to make the largest pixel diameter as small as possible",
    ". the ideal ( unachievable ) limit would be to have circular pixels where the largest diameter is @xmath4 where @xmath5 is the total number of pixels on the sky .",
    "( one can see this by considering the average pixel area , @xmath6 . ) for square pixels , the best one can achieve is @xmath7 , about 25% larger .",
    "in general we define the distortion of a pixel to be the length of longest diameter divided by this ideal value @xmath8 .",
    "* equal area pixels  this is desirable in order to get the best resolution for a fixed number of pixels , and so that the pixels , in the first approximation , have equal statistical weight .",
    "however , since sky coverage and and foregrounds are unlikely to be uniform , it is not clear that exactly equal area pixels are essential .",
    "* built - in hierarchy  a hierarchical pixelization scheme allows for coarse graining of the data at different resolutions .",
    "this is likely to be at least very useful , and probably essential , in analyzing the data .",
    "we require that the hierarchy be nested , that is that each higher resolution pixels should fit perfectly into a single lower resolution pixel .",
    "ideally one would like the hierarchy to coarsen to as small a base set of pixels as possible , maintaining minimal distortion and roughly equal area pixels at each level .    in section",
    "ii , we describe the general features of igloo pixelizations as well as specific characteristics of the models that we consider here . in section iii",
    ", we present some general considerations for creating and inverting pixelized maps , and describe how the azimuthal symmetry can be exploited . finally , in section iv , we create and invert realistic maps with the various pixelizations and examine the accuracy with which the power spectra can be extracted .",
    "by an igloo pixelization , we mean one divided into rows with edges of constant latitude and where each row is divided into identical pixels by lines of constant longitude .",
    "the pixels are roughly trapezoidal shaped , becoming nearly rectangular away from the poles . for simplicity and to speed calculations , the northern and southern hemispheres are tiled identically .",
    "igloo tilings have many advantages .",
    "first , they are quite simple .",
    "they are also naturally azimuthal and can be easily made equal area , with most pixels nearly square .",
    "but perhaps their biggest advantage is that the pixel edges are defined along constant lines of the spherical polar coordinates @xmath2 and @xmath3 , allowing for an exact , fast integration of spherical harmonics over the pixels .",
    "this is essential in constructing exact simulated skies , and in optimally recovering the sky power spectrum from real data .",
    "the simplest example of an igloo pixelization is the ecp pixelization itself , which we will include in our comparison . in it",
    ", every row has the same number of pixels , and the pixels become quite narrow near the poles .",
    "the other models we consider have pixels which are more nearly square and nearly ( or exactly ) equal area . to do this the number of pixels in each row must decrease as one approaches the poles ( figure 2 ) .",
    "one can construct igloo pixelizations with either rows equally spaced in latitude , like the ecp , or with pixels of uniform area .",
    "the advantage of equal latitude spacing is that the pixelization can be created by a simple rebinning of an ecp pixelization , providing the latter is chosen to have an appropriate number of pixels .",
    "in addition , by letting the pixel areas vary , one can make them less distorted .",
    "an equal area pixelization will not be exactly equally spaced in latitude , but has the advantage that all of the pixels will have the same statistical weight .",
    "igloo pixelizations can also be made hierarchical .",
    "to do this , one first divides the sphere into a base pixelization with relatively few pixels , optimized to minimize the pixel distortion .",
    "each of these coarse pixels is then divided into four by bisecting it in longitude and latitude .",
    "the latter division is chosen either to keep the pixels the same area or to maintain a constant latitude spacing of the rows .",
    "thus one creates a finer grained pixelization with four times the number of pixels .",
    "this procedure can be repeated until we reach the required resolution .    reducing the number of base pixels tends to increase the level of pixel distortions , so",
    "some compromise must be found .",
    "while there are clear advantages to having fewer base pixels , it is not obvious how they should be weighed against the advantages of having more uniform pixels . here",
    ", we will consider two possible extremes , pixelizations with twelve base pixels ( roughly @xmath9 each ) , and one with 12,116 @xmath10 base pixels .",
    "the latter number was chosen because an analysis at this resolution is comparable to what has already been accomplished for cobe , and it is unlikely one will need an analysis at a lower resolution .",
    "the hierarchical division causes some of the subpixels to become more distorted than the coarser pixels , especially near the poles .",
    "away from the poles , there is a limit to how distorted the pixels become , even at the highest resolutions .",
    "however , if the polar cap were simply bisected in @xmath2 and @xmath3 , the pixels would become more and more distorted , as occurs in the ecp .",
    "thus , we must use another method for dividing the polar regions .    in our pixelization",
    ", we have chosen to initially divide the cap of each pole into three equal wedges .",
    "higher resolution pixelizations are found by dividing each wedge into four pieces , one central wedge and three pieces surrounding it .",
    "( see figure [ fig : cap ] . )",
    "this process is iterated , with the interior wedge always being divided in this way and the outer pieces being divided by lines of constant @xmath2 and @xmath3 .",
    "this prescription is designed in order to minimize the distortions in the highest resolution pixels .",
    "we would like to begin with base pixels that are as uniform and undistorted as possible .",
    "we can make the pixels nearly square by choosing the right number of pixels in each row .",
    "the best number at a given latitude is given by the distance around the sphere at that latitude divided by the width of each pixel .",
    "thus , if the average area of each pixel is @xmath11 , then the ideal number in a row at angle @xmath2 is @xmath12 . since the number of pixels must be an integer , some slight distortion of the pixels is inevitable .",
    "if we treat the region near the pole as effectively flat , then it is simple to calculate the ideal numbers in the concentric layers . assuming the pixels are square",
    ", the radius for each layer increases by @xmath13 , so that the ring area increases by @xmath14 .",
    "thus , the number in a layer is related to the number in the previous layer by @xmath15 .",
    "if the cap is initially divided into three wedges , the next row should contain nine pixels , and there should be roughly six more pixels in each additional row .",
    "the precise numbers are chosen to minimize pixel distortion at the highest resolutions .",
    "one possible sequence might be 3 , 9 , 15 , 22 , 28 , 34 , 40 , 46 ...    having arbitrary integers in the rows reduces the effectiveness of fast fourier transforms ( ffts ) , whose speed depends on the number of pixels in a row being a product of low primes . to minimize this effect",
    ", one should be selective in choosing the number of pixels allowed in a row .",
    "for example , we may chose only numbers of the form , @xmath16 or @xmath17 .",
    "since allowing more possibilities reduces the amount of pixel distortion , one might alternatively consider all numbers which do not have large prime factors .",
    "for example , in the 12,116 base pixel model we exclude only numbers with prime factors bigger than 23 .",
    "we parameterize the distortion in terms of the largest pixel diameter , @xmath8 , which is related to the pixel height , @xmath18 , and its width , @xmath19 : @xmath20 .",
    "the width is given by @xmath21 , where @xmath22 is the ideal number of pixels at a given latitude and @xmath23 is the actual number . in the equal latitude pixelizations ,",
    "the pixel height is fixed ( ideally at @xmath24 , ) so that d^2 a ( 1 + ( n()/n_p)^2 ) . in the equal area case ,",
    "the height varies inversely with the width , so that d^2 a ( ( n_p / n())^2 + ( n()/n_p)^2 ) .",
    "the distortions are smaller on average in the constant latitude case , but the pixel areas vary from row to row .",
    "if one allows large number of base pixels , then the pixel widths and heights can be made almost equal ( @xmath25 ) for most of the pixels , with the distortions being the worst at the poles . even in the finest subdivision however",
    ", the pixel distortions do not become arbitrarily bad .",
    "the most distorted pixels never have diameters larger than about @xmath26 in any of the pixelizations we consider , and these are relatively rare .",
    "these pixelizations are optimized to be both azimuthal and hierarchical .",
    "the data need to be ordered differently depending on which of these properties we are interested in utilizing . for the creation and analysis of maps , it is helpful to have an azimuthal ordering . however , to facilitate coarsening , one would reorder the data into chunks associated with the coarsest graining . within these chunks , the data would be ordered like each face in the quad cubed , so that adding the data in groups of four converts it to the next coarser level .      for definiteness , here we consider four possible igloo pixelizations :    * an ecp pixelization * a twelve pixel scheme ( 3:6:3 ) divided with equal area * a twelve pixel scheme ( 3:6:3 ) divided with equal latitude spacing * an equal area scheme with 12,116 base pixels    in the twelve pixel scheme , the base pixels are arranged as shown in figure 2 ( bold lines ) , with three pixels at each cap and six around the center .",
    "the divisions between the layers lie at @xmath27 .",
    "( we note that the pixelizations recently suggested by gorski @xcite also involve twelve base pixels , but arranged instead in rows of 4:4:4 . )",
    "to facilitate comparisons , the ecp model was chosen to have nearly the same number of pixels as the other models , and was based on a @xmath28 grid , with the base pixels having edges of @xmath29 .",
    "* distortions : * we evaluate these schemes given roughly equal numbers of pixels in each .",
    "we expect naively that the quality of the pixelization should depend on the average diameter of the pixels .",
    "figure [ fig : distort ] shows the percentage of pixels with a given maximum diameter for the various models .",
    "the least distortions result from the pixelizations with the greatest number of base pixels , and for 12,116 base pixels the amount of distortions is very close to the ideal ( square ) result . when the number of base pixels is reduced to twelve ,",
    "greater distortions result . in the equal area case ,",
    "the minimum diameter is fixed and grows larger for pixels that are less square . in the equal latitude case ,",
    "the distortions are comparable .",
    "however , the pixels with less area can have a smaller diameter , so that the average diameter is actually smaller than in the equal area case .",
    "finally , the distortions in the ecp are the largest because many of its pixels contain very little area , which makes the remaining ones larger .",
    "* area : * only two of these pixelizations , the twelve pixel equal latitude and the ecp pixelization , are not equal area by construction .",
    "we might hope that variations in pixel area themselves will have little effect , because we calculate the spherical transforms properly weighting for the different pixel areas .",
    "nevertheless the ecp scheme is at a disadvantage because the large number of small pixels implies that , for a fixed number of pixels , the largest pixels ( and the average pixel diameter ) are bigger than in the other models .",
    "figure [ fig : area ] shows the distribution of area for the ecp and the equal latitude 3:6:3 scheme . while the pixel areas do vary in the equal latitude 3:6:3 scheme , they do so in a way which keeps the pixel distortion small .",
    "* hierarchy : * in regards to hierarchy , the best pixelization is the ecp , which in its simplest implementation can be reduced to just two pixels , the east and west hemispheres .",
    "the 3:6:3 models are nearly as good , having only twelve base pixels .",
    "of the two , the equal latitude case is somewhat simpler and has the advantage that it can be subdivided into an ecp pixelization with @xmath30 pixels .",
    "clearly , the poorest pixelization in this regard is the 12,116 base pixelization , which only coarsens down to two degree patches , and so requires more information to specify uniquely .",
    "the criteria we use to judge the various pixelizations are the speed and accuracy with which one can create and invert realistic sky maps .",
    "any reasonable pixelization should do well in finding the low multipoles which do not vary appreciably over the pixels .",
    "the true test is how well one can extract the power spectrum at high multipoles , corresponding to wavelengths on the sky approaching the dimensions of the pixel .    to evaluate different pixelizations ,",
    "we create realizations assuming gaussian statistics and a sample ( cdm ) power spectrum .",
    "the simulated multipole coefficients are then exactly transformed into pixelized maps .",
    "we then perform an exact spherical transform of the pixelized maps to attempt to recover the initial power spectrum . in this final step",
    ", errors occur in two ways .",
    "first , the pixelized maps contain only @xmath5 numbers : information regarding modes whose wavelength is shorter than the pixel size has been lost .",
    "second , when one attempts to correct the recovered multipole coefficients for the effect of pixel smoothing , one can do so at various levels of approximation ( and speed ) , as will be discussed below .",
    "two maps must be considered , the true map of the temperature on the sky , and the map projected into the pixelization of the sky .",
    "the true continuous temperature can be expressed as t ( , ) = _ l , m a_lm y_lm ( , ) where the @xmath31 s are variables that are gaussianly distributed with zero mean and variance given by the power spectrum , @xmath32 this can be inverted using the orthogonality of the spherical harmonics to find a_lm = t ( , ) y^*_lm ( , ) d. for our present purposes , the true map is the sky smoothed by the experimental window function .",
    "the two point correlation function is t()t( ) & = & _ lmc_l y_lm ( ) y^*_lm( ) + & = & 1 4 _",
    "l ( 2l+1)c_l p_l(_ ) , where @xmath33 is the angular separation of the two points .",
    "unfortunately , the true map is not directly observable .",
    "experiments will produce pixelized maps where the temperature in each pixel is the true temperature averaged over the area of the pixel .",
    "the measured temperature in one of these pixels is given by t_p = w^p ( , ) t ( , ) d where @xmath34 is the pixel window function for the p@xmath35 pixel , equal to @xmath36 ( where @xmath37 is the area of the pixel ) within the pixel and zero otherwise .",
    "thus , @xmath38 is the average of the temperature in the pixel .",
    "expanding the temperature in terms of spherical harmonics , we find t_p & = & w^p ( , ) _",
    "l , m a_lm y_lm ( , ) d + & = & _ l , m a_lm w^p_lm where @xmath39 is defined by @xmath40 and @xmath41 the vector @xmath42 , @xmath43 , is the pixelized analog of the continuous function @xmath44 .",
    "the pixelized analog to the two point correlation function is the pixel - pixel correlation , t_p t_q = _ lm c_l w^p_lm w^q*_lm . in general",
    ", this can not be further simplified because the pixelization breaks rotational invariance .",
    "for the special case of white noise , @xmath45 is constant , and the pixel - pixel correlation is simply @xmath46 .    while the pixelized map is discrete , it is a well defined function on the sky and can itself be expanded in terms of orthogonal functions : t^pix ( , ) & = & _ p t_p a_p w^p ( , ) + & = & _ l , m a^pix_lm y_lm ( , ) . this can be inverted to find that a^pix_lm & = & t^pix ( , ) y^*_lm ( , ) d + & = & _",
    "p t_p a_p w^p ( , ) y^*_lm ( , ) d + & = & _ p",
    "t_p a_p w^p*_lm.this is the pixelized analog of equation ( 3.2 ) . in principle , all the pixelized multipoles , an infinite number of them , are well defined and could be calculated . however , since there are only @xmath5 independent pixel temperatures , only a finite number of the extracted @xmath47 s can be linearly independent , which we can take to be the lowest @xmath5 @xmath48 s ( i.e. with @xmath49 up to @xmath50 ) .",
    "the pixelized multipoles can be related to the true multipoles by substituting the above expression for @xmath38 , a^pix_lm = _ lm",
    "a_lm _ p a_p w^p*_lm w_lm^p .",
    "[ eqn : exact ] this equation tells us that the @xmath48 are special linear combinations of the true underlying @xmath31 s we are interested in .",
    "a pixelized map can only provide a finite number of constraints on the infinite number of possible multipoles which might exist .",
    "we can not recover the underlying @xmath31 s without making an additional assumption , the simplest being that they are all zero beyond some value of @xmath49 .",
    "this is perhaps the most natural choice , because while all the multipoles might in principle be non - zero , the highest multipoles will eventually be suppressed due to the finite resolution of the antenna and the pixel size .",
    "( if higher multipoles are present , then these will mimic combinations of the lower multipoles and so will reduce the accuracy to which they can be extracted . ) with this assumption , we can attempt to solve equation ( [ eqn : exact ] ) for the true @xmath31 s .    one possible way to solve equation ( [ eqn : exact ] ) for the @xmath31 s exactly is by iteration , making a guess for the @xmath31 s and then making a correction based on that guess . consider the positive semi - definite function f= _",
    "p a_p t_p^2(error ) [ eqn : func ] where @xmath51 is the temperature difference between the measured temperature on the @xmath52th pixel and the temperature one would get given some guess for the @xmath31 s , t_p(error ) = t_p(guess)- t_p(true ) .",
    "the scheme to solve ( [ eqn : exact ] ) is then just to minimize the function @xmath53 in ( [ eqn : func ] ) , which can be straightforwardly calculated for any conjectured set of @xmath31 s using the fast fourier transforms described below .",
    "the minimization of @xmath53 can be done iteratively in a very simple manner , and we report on results from this method below .",
    "one danger in making this inversion is that the multipoles we have chosen to extract might not fully span all the degrees of freedom of temperature map . if this were the case ,",
    "the matrix in equation ( [ eqn : exact ] ) is singular and can not be inverted .",
    "for example , two apparently orthogonal functions might appear identical when they are pixelized , making a unique inversion for the @xmath31 s impossible .",
    "in reality , this degeneracy of functions will only be approximate , but it will make solving for the underlying @xmath31 s difficult . to minimize these dangers , it makes sense for the ideal pixelization to represent all the multipoles we have chosen to solve for ( those below @xmath54 ) as orthogonally as possible .    while it is important that in principle a scheme exists for solving ( [ eqn : exact ] ) exactly for the @xmath31 s ( modulo the necessary assumption that they vanish for high @xmath49 ) , in practice one may be more interested in a fast scheme for recovering the @xmath31 s approximately .",
    "when the spherical harmonics do not vary much across the pixels ( i.e. , for low @xmath49 ) , then the orthogonality of the spherical harmonics , @xmath55 implies that _",
    "w^p*_lm w_lm^p n_lm _ ll_mm , where , @xmath56 . in this case",
    ", the inversion can be found to be a^est_lm .",
    "[ eqn : approx ] this relation naturally breaks down at high multipoles , when the number of multipoles to be extracted approaches the number of pixels .",
    "one can estimate the power spectrum from these extracted multipole moments .",
    "the naive estimate is simply , c_l^est _",
    "m |a^est_lm|^2 .",
    "unfortunately , this estimator is biased and tends to overestimate the power spectrum , especially at high multipoles .",
    "this is easy to understand .",
    "suppose one has a single mode on the sky , which is then pixelized .",
    "the lack of orthogonality of the modes projected on the pixelization implies that when inverting the pixelization , one would recover the original mode , plus an admixture of small contributions to other modes .",
    "the latter tend to increase the extracted power .",
    "one can construct an unbiased estimator from @xmath57 ( or from @xmath58 . )",
    "it can be shown that c_l^est = m_ll c_l where , _",
    "ll _ mm 1 n_lm^2 _",
    "a_p w^p*_lm w_lm^p _ q",
    "a_q w^q_lm w_lm^q*. this matrix is a function of the pixelization alone , so need be calculated only once . given this matrix , an unbiased estimator of the power spectrum is c_l^unbiased = m^-1_ll c^est_l. [ eqn : unbias ] this removes the systematic effect of leakage from other multipoles and is quick to calculate .",
    "however , it ignores off - diagonal correlations between the @xmath59 s , and so is not the best possible estimator of the power spectrum .",
    "for azimuthal pixelizations , it is helpful to replace the general pixel index @xmath52 , with two indices @xmath60 where the former represents the row number and the latter identifies the pixel within that row .",
    "each row has @xmath23 identical pixels placed periodically in @xmath3 .",
    "we can expand the spherical harmonics as y_lm ( , ) = _ l^m ( ) e^i m , where @xmath61 are the normalized legendre polynomials , defined in terms of the associated legendre polynomials by _",
    "l^m(x ) = ( ( 2l+1 ) 4 ( l - m ) ! ( l+m ) ! ) ^1/2 p_l^m(x ) , following the notation of muciaccia , natoli and vittorio ( mnv , 1997 ) .    the window functions in azimuthal pixelizations can be easily calculated .",
    "w^pq_lm & = & dw^pq ( , ) y_lm ( , ) + & = & 1 a_p^2q / n_p_2(p-1)/n_q e^i m d^_p+1__p ^m_l ( ) d + &",
    "= & e^i mq2/n_pw^p_lm where we have defined the @xmath62 independent part of the window function as , w^p_lm = e^i m / n_p(m / n_p)(m / n_p ) 1 x_p^_p+1__p ^m_l ( ) d , and @xmath63 .",
    "the final integral can be evaluated very quickly in a recursive fashion , comparable to the time required to evaluate the legendre functions themselves .",
    "( see appendix a. ) the ability to exactly integrate over the pixels quickly is an important advantage of the igloo class of tilings .",
    "it is the simple dependence on @xmath62 of the window functions that allow the creation and inversion of maps to be evaluated using fast fourier transforms . to take advantage of this in creating maps , it is useful to rewrite the expression for the pixel temperature , reordering the sums in a suggestive way ( again adapting the notation of mnv ) : t_pq & = & _ l=0^l_max _ m = -l^l a_lm w^p_lm e^i mq2/n_p + & = & _ m = -l_max^l_max _ l=|m|^l_max a_lm w^p_lm e^i mq2/n_p + & = & _ m = -l_max^l_max b_m(_p ) e^i mq2/n_p.here , b_m(_p ) =",
    "_ l=|m|^l_max a_lm w^p_lm = _",
    "qt_pq e^-i mq2/n_p , and the transformation between @xmath64 and @xmath65 can be made with a fft . however , since there are only a limited number of pixels , only the frequencies @xmath66 can be represented on the lattice .",
    "when the number of modes exceeds @xmath67 , the modes appear on the lattice like modes with frequency @xmath68 and their power must be aliased into these lower frequencies .",
    "since the northern and southern hemispheres are tiled in the same way , we can use this symmetry to save a factor of two in computing time @xcite .",
    "the associated legendre polynomials are even or odd functions across the equator , depending on whether @xmath69 is an even or odd number",
    ". we can break the @xmath64 functions into even and odd pieces and evaluate them in only the northern hemisphere , and find the full function by b_m(_p , north ) & = & b_m(_p , even ) + b_m(_p , odd ) + b_m(_p , south ) & = & b_m(_p , even ) - b_m(_p , odd ) .",
    "the inversion of the maps can be performed similarly , a_lm & = & 1 n_lm _ pq t_pq a^p w^pq*_lm + & = & 1 n_lm _ p=1^n_rows a^p w^p*_lm _",
    "qt_pq e^-i mq2/n_p + & = & 1 n_lm _ p=1^n_rows b_m(_p ) a^p w^p*_lm .",
    "similarly , care must be taken in the inversion to map the power from the lower modes to the higher ones .",
    "it is the effect of the higher modes on the pixelization mimicking the lower ones which is primarily responsible for making the exact inversion of the map impossible . in the continuous case ,",
    "the orthogonality of the spherical harmonic functions is enforced in two ways : first , the azimuthal functions ( @xmath70 ) are orthogonal for @xmath71 and second , when @xmath72 ( and only then ) , the associated legendre functions are orthogonal for @xmath73 . in the pixelized case , this remains approximately true when @xmath74 , but this breaks down for larger modes , so that modes with @xmath71 are not necessarily orthogonal .",
    "then the lack of orthogonality for the legendre polynomials means these functions can appear to be the same .    to minimize this effect , it is helpful to have as many pixels per azimuthal row as possible . for the equal area models we consider ,",
    "each pixel has an area of @xmath75 , with edges of length @xmath76 .",
    "thus there are @xmath77 pixels along the equator , and the problem of orthogonality becomes a serious problem near the nyquist frequency at the equator , @xmath78 .",
    "this is close to the maximum we could reasonably hope for given the finite number of pixels , @xmath79 .",
    "the normalization of each mode can be found quickly from the expression , n_lm = _ p=1^n_rows a_p w^p*_lm w_lm^p n_p . for round pixels ,",
    "the normalization is independent of @xmath80 and this is usually assumed for the sake of simplicity . in a more realistic pixelization ,",
    "however , there can be large variations for different @xmath80 s , especially at high multipoles .",
    "thus , the ability to calculate these individual normalizations is a great advantage in making an inversion .",
    "we begin by showing the average normalization , @xmath81 , for the various pixelizations .",
    "this illustrates the average suppression of modes by the pixelization and is equivalent to its window function .",
    "the mean window functions are virtually identical for all the pixelizations with the exception of the ecp which falls off slightly more quickly .",
    "the shape of these curves reflects primarily the effective area of the pixels , and while the ecp has the same average area , its skewed distribution of shapes makes them dominated by the larger pixels .",
    "a more pronounced difference appears in the variance of the window functions for a fixed @xmath49 , as indicated by the error bars .",
    "this is correlated with the average amount of distortion of the pixelization , with the ecp having the largest variance and the 12,116 base the least .",
    "in addition , a feature appears in the variance of the window functions precisely at @xmath82 , when particular modes can be either in phase or out of phase with the pixelization .    to minimize aliasing of the higher multipoles ,",
    "the ideal window function would be zero above a given cutoff in @xmath49 ( @xmath83 , ) so that the pixelization would have no response to the higher modes .",
    "however , we have been assuming the pixels have a sharp cutoff in real space , which makes aliasing from higher @xmath49 modes inevitable . for both the temperature map and its fourier transform to be as local as possible",
    ", it could be advantageous for the window function to be effectively gaussian , falling off both at large distances and at high multipoles .",
    "however , such a scheme would make eliminating foregrounds more difficult .",
    "how well can we recover an input power spectrum ?",
    "we first consider inverting using the fast , approximate approach described in equation ( [ eqn : approx ] ) .",
    "figure [ fig : delta ] shows the errors in inverting the power spectra using that technique for the four models we are considering . here and below , we plot the fractional error in the estimated multipole , @xmath84 and take the absolute value when plotting on a log scale . for this figure",
    "we have assumed a standard cdm power spectrum with a smoothing of @xmath85 .",
    "we compare the various pixelizations with approximately three million pixels in each .",
    "the accuracy seems to follow a power law ( @xmath86 ) at small multipoles and then rises quickly at higher multipoles , when the orthogonality of the modes breaks down and the power spectrum is systematically overestimated . at these multipoles , aliasing due to the other multipoles can not be ignored .",
    "as one might expect , due to the larger average diameter , the ecp pixelization performs worst of the models we consider , for fixed number of pixels .",
    "the best performing model is the 12,116 base pixel model , which has been shown to have the least pixel distortions and has exactly equal area .",
    "it is able to invert the power spectrum an order of magnitude better than the other models considered for most of the multipoles . in the middle range lie the 3:6:3 models , which have a smaller diameter than the ecp model , but are more distorted than the large base pixel model . here",
    ", the equal latitude model works somewhat better than the equal area models , implying that the diameter of the pixels is a key factor evaluating the pixelizations .    for comparison",
    ", we also include a rough measure of the level of cosmic variance which occurs because we can only measure a finite number of multipoles for a given @xmath49 .",
    "this sample variance drops roughly as @xmath87 . at low @xmath49 ,",
    "the uncertainties in extracting the multipoles are far outweighed by the sample variance .",
    "these converge as one goes to higher and higher @xmath49 .",
    "while the errors from the pixelization can be generally be made much smaller than the cosmic variance , they can not be ignored if they are systematic in nature .",
    "it important to understand how these conclusions change when the resolution increases , keeping the same base number of pixels .",
    "figure [ fig : scale ] shows two of the pixelizations for a range of resolutions , from @xmath88 to 7. to good approximation , the effect of increasing the number of pixels by four is to shift the curves to higher @xmath49 by a factor of two .",
    "( the residual differences between the curves is likely to be due to the varying shape of the input power spectrum . ) at low @xmath49 , increasing the number of pixels by a factor of four decreases the errors in the extracted power by approximately the same factor .",
    "our results are qualitatively different from those found by mnv , who found the percentage errors were roughly constant as a function of @xmath49 .",
    "this is likely because they were creating and inverting the maps using the same assumptions , evaluating the spherical harmonics in the center of the pixels , rather than integrating over the pixels as we do here . in this approach ,",
    "pixel smoothing can be approximated by assuming the pixels are uniform round tophats with the same area of the the true pixels .",
    "however , creating the maps in this way effectively ignores the true pixel shapes and leads to a sizable underestimation of the errors arising from the pixelization .",
    "figure [ fig : point ] shows the effect of inverting such a realistic map by assuming round pixels .",
    "one can see that the effect of this is to greatly reduce the accuracy of the inversion , even for the lowest multipoles .",
    "the systematic error introduced by using an inaccurate window function appears to dominate the statistical errors .",
    "when testing the quality of their inversions , previous analyses have assumed that the power spectrum of the initial maps cuts off precisely at the nyquist frequency on the equator , @xmath89 .",
    "thus , they have only put in the power that they could extract .",
    "however , this is not a realistic assumption  the higher multipole modes exist and must be included to understand the accuracy of the extracted power spectrum .",
    "though these modes tend to be damped by experimental and pixel smoothing , even when the pixel size is much smaller than the beam size the spectrum falls off smoothly rather than sharply .",
    "thus , the power above any given cutoff is always comparable to that just below it and can not be ignored .",
    "the presence of these higher modes can adversely affect the inversion because they can mimic the lower modes on the pixelization .",
    "the presence of the higher modes can be corrected for , in part , by using the unbiased estimator defined in equation ( [ eqn : unbias ] ) .",
    "figure [ fig : unbias ] shows the errors in the recovered power spectra with and without correcting for this bias . without the correction ,",
    "the power spectrum is greatly overestimated at high frequencies . with the correction ,",
    "the power spectrum can be recovered even beyond @xmath82 , though with decreasing accuracy .",
    "we have been comparing models assuming they have nearly the same numbers of pixels . rather than using the number of pixels as our criterion , it might be fairer to compare pixelizations for a given speed , or equivalently a given number of azimuthal rows .",
    "for example , the ecp pixelization has @xmath90 20% fewer rows than the other models we considered and would perform much better if it had the same number of rows , when it would have 50% more pixels .",
    "this would improve its accuracy , making it comparable to the 12,116 base model .",
    "it is worth considering whether for a given pixelization one should increase the number of pixels per row , which would improve the orthogonality of spherical harmonics without adding much to the computation time .",
    "( though , some it would not improve much , for example the @xmath91 modes . ) if one chooses to make the pixels more narrow , however , it would be better to do it in a uniform way for all of the pixels , rather than just at the poles , as the ecp pixelization does .",
    "finally , we have also attempted to invert equation ( [ eqn : exact ] ) directly rather than only approximately .",
    "we constructed simulated skies in which we set the @xmath31 s equal to zero beyond some cutoff value @xmath92 and used an iterative scheme described in @xcite to find the minimum of the function @xmath53 , defined in equation ( [ eqn : func ] ) , taking advantage of the sparseness of the matrix .",
    "one difficulty in an exact inversion is that as @xmath92 approaches @xmath93 , the number of directions in which @xmath53 is flat grows .",
    "that is , some particular linear combinations of @xmath31 s have very little impact on the pixelized temperatures : the pixelization effectively washes out these combinations .",
    "these multipoles are thus very difficult to extract .",
    "to overcome this problem , we conduct a number of trial simulations and minimizations , and compute the fractional error @xmath94 for each @xmath49 and @xmath80 .",
    "modes where this fractional error exceeds some threshold are those which are hardest to recover .",
    "these modes are a function of the pixelization and are the same from run to run .",
    "the most naive prescription is then to just ignore the recovered @xmath31 s for these ` hard ' values of @xmath49 and @xmath80 .",
    "figure [ fig : correct ] shows results for @xmath95 , @xmath96 , where the number of multipoles which one is ignoring is of the order of ten per cent of the total ( most of these are at @xmath49 very close to @xmath92 ) .",
    "the errors in the recovered @xmath97 s shown are for a run independent from those which determined which modes were to be excluded .",
    "this graph demonstrates that there is much recoverable information available in the pixelized maps about modes up to @xmath98 , at the cost of increased computational effort .",
    "however , we have performed this inversion using a very simple scheme , and there may well be more efficient ways of recovering it . in particular it may be worthwhile to consider using two pixelizations in which the ` poles ' lie along orthogonal directions .",
    "the underlying @xmath31 s which were hardest to recover from one pixelization would be very different from those which were hardest to recover from the other .",
    "so replacing the function @xmath53 in ( [ eqn : func ] ) by the sum of the two functions @xmath53 for each pixelization would likely remove some of the flat directions .",
    "we have shown that simple igloo pixelizations have much to commend them .",
    "they can easily be made hierarchical with pixels that are quite uniform .",
    "more importantly , they are naturally azimuthal , which speeds the calculation of spherical harmonics and allows for the exact calculation of the effect of the pixel shape . including the effects of the pixel shapes is essential for the accurate extraction of the power spectrum without greatly over sampling the sky , and for understanding the systematic errors which can arise .",
    "we should emphasize that in the limit of an infinite number of pixels , all the pixelizations are equivalent . in practice ,",
    "the beam will be oversampled , which will help reduce the effects of pixelization for the multipoles of greatest interest .",
    "however , computational pressure will drive the number of pixels down , and remnants of the pixelization will exist to some degree .",
    "igloo pixelizations provide an exact way of correcting for them .    in deciding what particular pixelization to use , a tradeoff must be made between the simplicity inherent in having few base pixels and the advantages of having pixels with the smallest amount of distortion possible .",
    "we have shown that having many base pixels has advantages in making the spherical harmonic representations on the pixelizations orthogonal , which minimizes errors in extracting power spectra .",
    "however , these factors must be weighed against the practical advantages having a simple and hierarchical scheme .    of the models we have considered here ,",
    "perhaps the best compromise between these considerations is the 3:6:3 equal latitude model .",
    "it has only twelve base pixels and can easily be created from an ecp pixelization . while it is only approximately equal area , we have found that this is actually an advantage because it allows us to prevent the average pixels from becoming more distorted .",
    "if exactly equal area models are favored , these can also be implemented using a 3:6:3 base igloo model .",
    "finally , we emphasize that there are many issues which we have not addressed here . for simplicity ,",
    "we have assumed full sky coverage , though in practice the galaxy foreground will have to be removed .",
    "we also have focused on an ideal situation with no experimental noise , while realistically this will be large and will vary across the sky .",
    "these issues are crucial to eventually understanding the microwave background , but we have put them aside here to isolate the effects that arise from the process of the pixelization alone .",
    "we wish to thank richard battye , kris gorski , steven gratton , david spergel and ned wright for useful conversations , as well as members of the cambridge planck analysis center .",
    "r.c . acknowledges support from a pparc advanced fellowship .",
    "in calculating the true window function of a particular pixelization , it is useful to have an algorithm for the quick calculation of @xmath99 and its normalized counterpart , @xmath100 just as for the calculation of the @xmath101 s themselves , they can be calculated by means of a recurrence relation .",
    "two of the recurrence relations that hold for the associated legendre polynomials are @xcite ( 1-x^2 ) d p_l^m(x ) dx & = & ( l+1)xp_l^m(x ) - ( l - m+1)p_l+1^m(x ) , + ( 2l+1)xp_l^m(x ) & = & ( l - m+1)p_l+1^m(x ) + ( l+m ) p_l-1^m(x ) .",
    "numerically , equation ( a2 ) is generally used recursively to evaluate the legendre polynomials , beginning with @xmath102 and @xmath103 @xcite .",
    "integrating the first relation , one finds ( 1-x^2 ) p_l^m(x ) = ( l-1)xp_l^m(x ) dx - ( l - m+1)p_l+1^m(x)dx . now substituting in the second relation , we find the recursion relation for the legendre polynomials p_l+1^m(x)dx = ( l-1 ) ( l+2)(l+m ) ( l - m+1 ) p_l-1^m(x)dx - 2l+1 ( l+2)(l - m+1 ) ( 1-x^2 ) p_l^m(x ) . in terms of the normalized polynomials ,",
    "the recursion relation is , _",
    "l+1^m(x)dx = ( 2l+3 ( l+m+1)(l - m+1))^1/2 1 l+2 ( ( l-1)(l^2-m^2)^1/2 ( 2l-1)^1/2 _ l-1^m(x)dx - ( 2l+1)^1/2 ( 1-x^2 ) _",
    "l^m(x ) ) .",
    "this recursion requires the initial values , @xmath104 and @xmath105 .",
    "the first of these can be found recursively , working up from @xmath106 .",
    "however , this recursion becomes unstable when @xmath107 is very small .",
    "when this is the case , one can rewrite the recursion as an expansion in powers of @xmath108 , which quickly converges .",
    "the second integral is given simply by the identity , @xmath109 . to avoid round - off error",
    ", we perform the recursion for the integrals over the range of interest @xmath110 , rather than doing them separately and taking the difference ( i.e. @xmath111 . )",
    "pixelization projects the sky , which has infinite degrees of freedom parameterized by its @xmath31 s , into a subspace of @xmath5 dimensions , parameterized by the pixel temperatures , @xmath38 .",
    "thus , one can think of the operation which takes the true map to the pixelized map as a projection operator .    in real space",
    "this is self evident  pixelization projects the multi - dimensional temperature map over a pixel into a one dimensional space parameterized by its averaged temperature . in multipole space , this interpretation is less obvious . from equation ( [ eqn : exact ] ) , we can define the projection operator in multipole space to be _",
    "lmlm _ p a_p w^p_lmw^p*_lm so that _",
    "lmlm a_lm = a_lm^pix where the repeated indices are summed over .",
    "projection operators have the property that @xmath112 .",
    "one can show this for the operator defined above using the completeness of the spherical harmonics : _",
    "lm y_lm ( ) y^*_lm( ) = ( -  ) .",
    "multiplying both sides by @xmath113 and integrating over both solid angles , one finds the pixelized analog _",
    "lm w^p_lm w^q*_lm = 1 a_p _ pq . thus , _ lmlm p_lmlm  & = & _ p a_p w^p_lmw^p*_lm _ q a_q w^q_lmw^q*_lm  + & = & _ p a_p w^p_lm _ q a_q w^q*_lm  1 a_p _ pq + & = & _ p a_p w^p_lm w^p*_lm",
    " = p_lmlm  in real space , this is equivalent to saying that pixelizing a map that has already been pixelized yields the same map ."
  ],
  "abstract_text": [
    "<S> we investigate various pixelizations of the sky which allow for fast spherical transforms , for implementation in full sky cmb experiments such as planck and map . </S>",
    "<S> we study the effect of varying pixel shape and area on the extraction of the cmb power spectrum . </S>",
    "<S> we argue for the benefits of having a truly azimuthal , or ` igloo ' pixelization . </S>",
    "<S> such pixelizations are simple and allow for fast , exact simulations of pixelized skies . </S>",
    "<S> they also allow for precise correction to be made which accounts for the effects of pixel smoothing on extracted multipole moments . 0.2 in    psfig.tex # 1= 0.8 # 1= 0.7 # 1#2#3#4#5#6#7    to#2    ' '' ''    </S>",
    "<S> # 1= 0.8 # 1 = 1.7    # 1@xmath0#1 # 1@xmath1    2cm^-2 2cm^2 3cm^-3 3gcm^-3 # 1#1 # 1#23.6pt </S>"
  ]
}