{
  "article_text": [
    "one of the most exciting prospects for the upcoming planck satellite is its capability to measure the polarization anisotropies of the cmb over the entire sky in nine frequency channels .",
    "the potential rewards from these measurements are many and include tighter constraints on cosmological parameters , determination of the reionization history of the universe , and detection of signatures left by primordial gravitational waves generated during inflation @xcite .",
    "measurement of the cmb polarization signal presents a great experimental challenge as it is an order of magnitude smaller than the temperature signal and is especially susceptible to distortions due to optical systematics and foreground contaminants . indeed ,",
    "if left untreated , leakage from the much stronger temperature signal will contaminate the polarization maps .",
    "maps and spectra will also suffer from leakage from e - mode polarization to b - mode polarization , jeopardizing the potential detection of inflationary b - modes . at the resolution and sensitivity of the next generation of experiments , including the planck mission ,",
    "studies of primordial non - gaussianity may also be sensitive to beam - induced systematics . in this paper",
    ", we present a novel technique for both assessing and removing systematic effects due to beams in temperature and polarization maps .",
    "the planck satellite is designed to extract essentially all of the information in the primordial temperature anisotropies and to measure the polarization anisotropies to high accuracy for @xmath1 .",
    "this will be achieved by measuring the full - sky signal to an angular resolution of 5 , to a sensitivity of @xmath2t / t @xmath3x@xmath4 , and over a frequency range of 30 - 857 ghz @xcite .",
    "the scientific performance of planck depends , in part , on the behavior of systematic effects which may distort the signal .",
    "a primary objective of planck is to produce all - sky cmb maps at each frequency .",
    "the process by which the satellite s time - ordered data ( tod ) is wrapped back on to the sphere to create an image is known as map - making .",
    "the map - making process becomes difficult due to a number of challenges : distortions in the beam , foreground contamination through far - side lobes , size of the data , and correlated noise effects .",
    "it is of critical importance to fully characterize the beam , and use this information during map - making to deconvolve beam effects .",
    "we have previously described a powerful map - making algorithm which implements the beam deconvolution technique for temperature measurements @xcite . in this paper",
    ", we will extend that description to include _ polarization _ measurements .",
    "we refer to this new technique as prebeam : polarized regularized beam deconvolution map - making .",
    "while we focus on reconstructing the map with a uniform effective beam and realize corrections to the power spectrum as a consequence , other work by @xcite and @xcite has focused on deriving corrections to the power spectrum due to asymmetric ( non - circular ) beam effects .    within the planck collaboration",
    ", the ctp working group has developed five map - making methods and compared their results using the simulated 30 ghz data in what is known as the trieste paper @xcite .",
    "the trieste paper assessed the impact of beam asymmetries on the planck spectra without attempting to treat the problem of beam asymmetry at the map - making level ( an angular power spectrum correction method was developed based on simplifying assumptions ) .",
    "in addition to prebeam , another deconvolution map - making technique for planck has been established by @xcite .",
    "both methods allow for arbitrary beam shapes and in both cases the asymmetry of the beam is parametrized by an asymmetry parameter @xmath5 which can vary between 0 and @xmath6 .",
    "our method scales computationally as a function of @xmath5 ; this is advantageous when large gains in accuracy can be achieved with small increases in @xmath5 .",
    "in contrast , the harrison method incurs a fixed computational expense for arbitrarily large @xmath5 .",
    "the harrison method takes advantage of the planck scanning strategy to condense the full tod into phase - binned rings , thereby achieving a significant reduction in processing time .    a complete characterization of the beam includes both the main beam and the far - side lobes .",
    "sidelobes are located as far away as @xmath7 from the main focal plane beam , and therefore require a large @xmath5 parameter for a complete harmonic description .",
    "in @xcite we demonstrated the full potential of our method using far - side lobes and maps with foreground signals . here",
    ", we show the usefulness of prebeam for deconvolving main - beam distortions . in fact",
    ", we find that it makes sense to use prebeam for main beam effects since only a small @xmath5 parameter is needed to capture the azimuthal structure of the main beam . in this way , we profit from the computational advantage of our method in the case of small @xmath5 , allowing for the unified treatment of main beam and side lobe effects .",
    "in  [ sec : deconv ] we describe the deconvolution map - making algorithm for prebeam .",
    "the simulated data and beams are detailed in ",
    "[ sec : sims ] .",
    "we present results in  [ sec : results ] showing the effectiveness of prebeam in removing systematic effects due to beam asymmetry and we discuss computational considerations .",
    "we finish with our conclusions from this study in  [ sec : conclusion ] .",
    "first we review the standard set - up to the map - making problem for a solution of the least - squares ( or maximum - likelihood ) type .",
    "the tod generated by a detector is effectively a convolution of the true cmb sky with a beam function .",
    "if we consider the sky as a pixelized vector , it will have length @xmath8 where @xmath9 for the i ( total intensity ) , q , and u stokes components . the @xmath10-length tod vector * d * is the result of a matrix multiplication of the observation matrix * a * with the sky * s * @xmath11 in our implementation of the maximum - likelihood solution , we refer to * a * as the convolution operator . * a * encodes information about both the scanning strategy and the optics of the scanning instrument .",
    "the least - squares estimate of the true sky , @xmath12 , is given by the normal equation @xmath13 where @xmath14 is the transpose convolution operator .",
    "equation ( [ eq : normal ] ) is exact if the noise is stationary and uncorrelated in the time - ordered domain .",
    "the generalization to non - white noise is as follows @xmath15 where * n * is a noise covariance matrix . in this work",
    "we consider cmb only and cmb plus white noise .",
    "we modify the normal equation by introducing a regularization technique in order cope with the ill - conditioned nature of the coefficient matrix * a*@xmath16*a*. we split off the ill - conditioned part of * a * by factoring it into two parts : * a * = * bg*. the factor * g * is what we refer to as the _ regularizer _ in prebeam . in general , the regularizer can be any target beam ; a natural choice would be the angle - averaged detector beam . in our study",
    ", we choose * g * to be a gaussian smoothing matrix , defined in harmonic space as @xmath17 where @xmath18 = fwhm/@xmath19 . the superscripts @xmath20 and @xmath21 refer to the gradient and curl components in the typical linear polarization decomposition .",
    "our modified normal equation becomes @xmath22 where we are solving for * x * = * g*@xmath23 . in this way , we do not attempt to reconstruct the sky at a higher resolution than that of the instrument .    in a standard pixel - based solution of equation ( [ eq : normal ] ) ,",
    "in which one assumes that the observing beam is spherically symmetric , @xmath24 is a sparsely - filled pointing matrix",
    ". for polarization measurements , each row of @xmath24 contains only three non - zero elements .",
    "the deconvolution map - making approach does not assume spherically symmetric beams , instead allowing for arbitrary beam shapes .",
    "we achieve this added complexity primarily by solving the normal equation in spherical harmonic space in order to make use of fast and exact algorithms for the convolution and transpose convolution of two arbitrary functions on the sphere @xcite .",
    "these algorithms are described in abbreviated form below .",
    "a secondary advantage of operating entirely in harmonic space is that artifacts due to pixelization ( such as uneven sampling of the pixel ) are completely avoided .      for a full presentation of the formalism for convolution of an instrument beam with a sky signal ,",
    "the reader is referred to @xcite .    in compact spherical harmonic basis ,",
    "equation ( [ eq : normal ] ) is written as @xmath25 where @xmath26 is the spherical harmonic representation of the sky and @xmath27 is defined as the result of a convolution of a band - limited function b with the sky s. the planck level - s software @xcite nomenclature refers to @xmath27 as a _ ring set_. this is written in harmonic space as @xmath28 where @xmath29 are fixed parameters which define the scanning geometry .    in equation ( [ eq : conv_harm ] ) ,",
    "@xmath30 and @xmath31 are related to the wigner d - matrices by @xmath32    analogously , the transpose convolution in harmonic space is given by @xmath33 where @xmath34 .",
    "now we outline the algorithmic steps taken to make a map from a tod vector by prebeam .",
    "first we construct the right - hand side of equation ( [ eq : norm_harm ] ) in two steps : converting tod to a @xmath27 array and applying @xmath35 .",
    "@xmath27 is constructed by transpose interpolating the tod vector * d*. the transpose interpolation of the tod vector onto the @xmath27 grid is akin to a binning step , where each element of the tod is mapped , via interpolation weights , to several elements of the @xmath27 cube according to the orientation and position of that data point in the scanning - strategy .",
    "the interpolation scheme is described in greater detail in  [ sec : interpol ] .",
    "next , we transpose convolve the beam coefficients @xmath36 with @xmath27 according to equation ( [ eq : tconv_harm ] ) .",
    "once the right - hand side has been computed , we use the conjugate gradient iterative method to solve equation ( [ eq : normal ] ) . with each iteration , the coefficient matrix @xmath37 ,",
    "is applied using the following procedure :    1 .",
    "apply the convolution operator , * a * , to project the sky @xmath38 on to the convolution grid @xmath27 2 .",
    "inverse fourier transform over the first two indices of @xmath27 to get @xmath39 ( we omit the transform over @xmath40 as it is incorporated in the interpolation scheme ) 3 .",
    "forward interpolate from @xmath39 to a tod vector 4 .",
    "transpose interpolate from the tod vector to a new ring set @xmath41 5 .",
    "fourier transform over the first two indices of @xmath41 to get @xmath42 6 .",
    "apply the transpose convolution operator , @xmath35 , to project the ring set @xmath42 back into a new sky @xmath38 vector      prebeam uses the same polynomial interpolation as implemented in the level - s software used to generate the simulation tods and as described in @xcite .",
    "the objective of forward interpolation is to construct a tod element at a particular co - latitude , longitude and beam orientation using several elements of the ring set @xmath43 and their corresponding weights .",
    "transpose interpolation operates in exactly the opposite manner as the forward interpolation : distributing a single element in the tod to multiple elements of the ring set .",
    "this is done using the same weights calculated for the forward interpolation .",
    "the entire operation of interpolation and transpose interpolation from ring set to tod and back again is depicted in figure [ fig : interpol ]    prebeam also includes the option to zero - pad during the fft and inverse fft steps .",
    "this means that the working array ( either @xmath27 or @xmath39 ) is enlarged and padded with zeroes out to @xmath44 .",
    "this has the effect of decreasing the sampling interval .",
    "we found that the combined effects of small - order polynomial interpolation ( order 1 or 3 ) and zero - padding of @xmath45 or @xmath46 dramatically reduced the residuals in our maps .",
    "prebeam employs a hierarchical parallelization scheme using both shared - memory ( openmp ) and distributed - memory ( mpi ) types of parallelization .",
    "the map - making was performed on the nersc computer bassi .",
    "bassi processors are distributed among compute nodes , with 8 processors per node .",
    "openmp tasks occur within a node and mpi tasks occur between nodes .",
    "we show a diagram of our hybrid parallelization scheme in figure [ fig : parallel ] .",
    "the full tod and pointings are divided equally between the nodes for input and storage of pointings . within an iteration loop ,",
    "four head nodes are designated to perform the convolutions , while the remaining active nodes are dedicated to the interpolation routines .",
    "each of these four nodes performs the convolution of the sky with one of the four detectors .",
    "the resulting arrays are then distributed to all nodes for interpolation over the segment of data stored there and then gathered back onto the designated nodes for transpose convolution .",
    "finally , the @xmath38 are summed , using mpi task mpi_reduce , into a single @xmath38 on a single node ; this is the new estimate for the sky vector .",
    "this particular scheme was devised so that the four distinct convolutions that must occur ( one sky with four different beams ) can take place simultaneously , while the pointings are distributed among as many nodes as possible for maximum speed in interpolation .",
    "both convolution and interpolation and their transpose operations make use of all processors on a node by using openmp directives .",
    "the simulated planck data on which prebeam was run was generated by the planck ctp working group for the study of the performance and accuracy of five map - making codes summarized in the trieste paper @xcite .",
    "planck will spin at a rate of approximately one rpm , with an angle between the spin axis and the optical axis of @xmath47 .",
    "we used the cycloidal scan strategy in which the spin axis follows a circular path with a period of six months , and the angle between the spin axis and the anti - sun direction is @xmath48 .",
    "tods were generated for 366 days for the four 30 ghz low frenquency instrument ( lfi ) detectors . at a sampling frequency of 32.5 hz",
    ", this corresponds to 1.028x@xmath49 samples per detector , for a total of over 65 gb of data and pointings .",
    "the simulated data also included the effects of variable spin velocity and nutation ( the option to include the effects of a finite sampling period was not included ) .",
    "the data was simulated with elliptical having with a geometric mean fwhm of @xmath50 and ellipticity ( maximum fwhm divided by minimum fwhm ) of 1.3562 and 1.3929 for each pair of horns .",
    "the widths and orientations of the beams were different ; this was referred to as _ beam mismatch _ in the trieste paper . in spherical harmonic space ,",
    "the simulation beams were described up to a beam @xmath5 of 14 .",
    "the same beams were used in prebeam to solve for the map , although we allowed the beam asymmetry parameter @xmath5 to vary .",
    "for this paper , we make temperature and polarization maps from simulated one - year observations of the four 30 ghz detectors of the planck lfi . we examine two cases : cmb signal only and cmb plus uncorrelated ( white ) noise .",
    "foreground signals and correlated noise properties will be examined in a future paper .",
    "the 30 ghz data was an optimal choice for this analysis because the low sampling rate and resolution minimize the data volume , while the large beam ellipticity allows us to demonstrate the full potential of our beam deconvolution technique .",
    "prebeam operates entirely in harmonic space , solving for and producing as output @xmath38 . for visualization purposes ,",
    "maps were made from @xmath38 s out to @xmath6 512 and at the healpix @xcite resolution of nside 512 ( @xmath51 pixel size ) .",
    "most of the results presented in this paper were attained with an fft zero - padding of factor four , an interpolation order of 3 , and an asymmetry parameter of @xmath524 ( we note where the parameters differ from this ) . to compare with the input signal , a reference map representing the true sky was created by smoothing the input @xmath38 by a gaussian beam of fwhm = @xmath50 .",
    "similarly , our regularizer @xmath20 ( in equation ( [ eq : regular ] ) ) was set to have a fwhm of @xmath50 to match this smoothing . as noted in ",
    "[ sec : sims ] , the same data we use here has been processed by five map - making codes in @xcite . we have chosen to compare our results with the analogous results from springtide , one of the codes in this study .",
    "springtide was chosen , out of the five codes , because it is the map - making code installed in and used by the planck data processing centers for the hfi and lfi instrument .",
    "it is sufficient to compare with springtide only as no significant differences in accuracy were found between codes ( with similar baselines and in the absence of noise ) @xcite . in the absence of noise",
    ", springtide is algorithmically akin to a straight - forward binning of the tod into a sky pixel map . because we are using springtide to represent all non - beam - deconvolution methods we will refer to the springtide maps as the _ binned _ maps .",
    "we begin by examining the spectra in the binned map , prebeam map and the smoothed input map shown in figure [ fig : cls ] .",
    "the effect of the beam mismatch is clearly seen where the peaks and valleys of the binned map spectra have been shifted towards higher multipoles .",
    "the detectors measure different stokes i which translates to artifacts in the polarization map .",
    "deconvolution suppresses leakage from temperature to polarization as evidenced by the prebeam spectra which overlays the input spectra .",
    "this shift is expected to remain apparent in the te spectra of non - beam - deconvolved maps even in the presence of noise because of larger temperature signal and the temperature - to - polarization cross - coupling .",
    "the fractional difference in the angular power spectrum ( defined as @xmath53 ) of the input and output maps is shown in figure [ fig : cls_frac ] .",
    "we show the fractional difference spectra for the tt , ee , and cross - correlation te signals , omitting the bb spectra since @xmath54 is zero in the simulation of the cmb map .",
    "the results for prebeam are shown at three intervals : the 25th , 50th and 75th iterations .",
    "this shows the behavior of the power spectra as prebeam converges on the solution .",
    "the beam mismatch effect is also seen in figure [ fig : cls_frac ] , where the fractional difference in the prebeam spectra lie closer to zero than the binned map spectra over the full range of multipole moments for ee and te .",
    "as described earlier , prebeam allows for variation in the asymmetry parameter @xmath5 .",
    "we examined the performance of prebeam as a function of @xmath5 , setting it to 2 , 4 and 6 .",
    "a remarkable improvement in the power spectra was found by increasing @xmath5 from 2 to 4 , while an increase from 4 to 6 only resulted in marginal improvements .",
    "this effect is best seen in the bb power spectra as shown in figure [ fig : mmax ] .",
    "thus , while the input tod was simulated with a beam having an @xmath5 cut - off of 14 , prebeam operates optimally at an @xmath5 of just 4 , thereby allowing us to capitalize on the computational property that prebeam scales as @xmath5 .",
    "we define a quantity called @xmath55 @xmath56 which we use to quantify the maximum , or worst - case bias beam systematics could induce in a cosmological parameter that happened to be degenerate with that parameter .",
    "the quantity @xmath57 is the expected one - sigma errors for the lfi 30 ghz channel , computed as the diagonal elements of the covariance matrix for the simulated input spectra , assuming a sky fraction of 0.65 .",
    "the @xmath58 values are plotted in figure [ fig : nsigs ] and show that prebeam reduces the worst case bias due to untreated beam systematics from tens of sigma to much less than one sigma over the entire @xmath59 range .",
    "we examine the resulting temperature and polarization ( q and u ) maps .",
    "the output map for both prebeam and the binned map was subtracted from the smoothed input map at the same resolution to make the residual maps shown in figure [ fig : resmaps ] .",
    "prebeam residuals were plotted on the same color scale as the binned map , showing that prebeam attained smaller residuals for both temperature and polarization .    as a final test , we run prebeam on tod containing cmb signal and white noise and compare with the smoothed input cmb spectrum and the analogous results from springtide ( in this case we refer to springtide directly since this is not simply a binned map ) .",
    "the level of the uncorrelated noise is specifed in the detector database and has a nominal standard deviation per sample time of @xmath60 @xcite .",
    "prebeam achieves a noticeably superior fit to the input spectrum compared with springtide from @xmath61 to @xmath62 .",
    "assessing the relative performance of prebeam and springtide in more detail would require performing monte carlo averages .",
    "we focus on the te spectrum since the improvement is visible even for a single simulation . for the other spectra prebeam",
    "performs as least as well as springtide but the detailed difference are more difficult to assess without a monte carlo study .      the computational costs and advantages of our method should be noted . to perform a convolution up to",
    "@xmath6 requires @xmath63 for the general case .",
    "since @xmath5 is bounded by @xmath6 , the cost never scales worse than @xmath64 and is only @xmath65 for the symmetric beam case . by comparison ,",
    "a brute force computation in pixel space would require @xmath66 . in this study , data was simulated with beams having an asymmetry parameter of @xmath67 , but maps were made using a cut - off value of @xmath68 in prebeam .",
    "we have demonstrated that computational cost can be conserved while still achieving the benefits of beam deconvolution    it was found that an increase in the zero - padding factor from two to four produced superior results over an increase in the interpolation order from one to three .",
    "an optimal run of prebeam will therefore include the largest zero - padding possible given machine memory constraints in conjunction with a polynomial interpolation of order one or three .",
    "this is advantageous since the time spent in an fft is nearly negligible and affected only minimally with an increase in zero - padding .",
    "in contrast , time for interpolation scales as interpolation - order - squared and as this is a tod - handling step , it dominates over any cost incurred by convolutions . in the case of the results shown here ,",
    "interpolation steps consume more than 90% of the wall - clock time per iteration .",
    "the results produced here were generated using 12 nodes on nersc computer bassi ( making use of all 8 processors per node ) and was complete in about 29 wall - clock hours , for a total of 2797-cpu hours .",
    "the maximum task memory was 20 gb on a single node .",
    "we have found that prebeam has outperformed the standard binned noiseless map using two measures : spectra and residual maps .",
    "we examined the fractional differences in the spectra and found markedly smaller differences in the prebeam spectra versus the binned map spectra across a range of multipole moments .",
    "we find that map - making codes which do not deconvolve beam asymmetries lead to significant systematics in the polarization power spectra measurements .",
    "the temperature - to - polarization cross - coupling due to beam asymmetries is manifested as shifts in the peaks and valleys of the spectra .",
    "these shifts are absent from the prebeam spectra .",
    "we translated the errors found in the power spectra to an estimate of the statistical significance of the errors in a parameter estimation resulting from these spectra , which we call @xmath55 .",
    "this analysis showed that the worst case parameter bias due to beam - induced power spectrum systematics could be tens of sigma while prebeam reduces the risk of parameter bias due to beam systematics to much less than 1 sigma we also found the i , q , and u component residual maps to be smaller for prebeam than for the binned map , implying smaller map - making errors .",
    "we have presented here the first results from prebeam for a straightforward test cases of cmb only and cmb plus white noise , and including only the effects of beams in the main focal plane . however , there is great potential for using prebeam to remove or assess systematics due to the combination of foregrounds and beam side lobes .",
    "systematics introduced by side lobes will appear on the largest scales , potentially impeding the detection of primordial b - modes on the scales where they are most likely to be measured .",
    "we have already shown for temperature measurements @xcite that our deconvolution technique can be used to remove effects due to side lobes .",
    "future work will examine the noise properties of prebeam maps and will include foregrounds from extragalactic sources and diffuse galactic emission .",
    "armitage , c. , & wandelt , b. 2004 , phys .",
    "d 70 , 123007 ashdown , m. a. j. et al .",
    "2008 , submitted to aa , astro - ph 0702483 challinor , a. et al 2000 , phys .",
    "d 62 , 123002 grski , k. et al 2005 , `` the healpix primer '' ( version 2.00 ) , available at http://healpix.jpl.nasa.gov harrison , d. l. , van leeuwen , f. , and ashdown , m. a. j. 2008 , in preparation mitra , s. , et al . 2007 , astro - ph 0702100 the planck collaboration 2005 , esa - sci(2005)-1 . ,",
    "astro - ph 0604069v1 reinecke , m. et al .",
    "2006 , a&a , 445 , 373 souradeep , t. et al .",
    "2006 , , 50 , 1030 wandelt , b. & grski , k. 2001 , phys . rev .",
    "d 63 , 123002"
  ],
  "abstract_text": [
    "<S> we describe a maximum likelihood regularized beam deconvolution map - making algorithm for data from high resolution , polarization sensitive instruments , such as the planck data set . </S>",
    "<S> the resulting algorithm , which we call prebeam , is pixel - free and solves for the map directly in spherical harmonic space , avoiding pixelization artifacts . </S>",
    "<S> while fourier methods like ours are expected to work best when applied to smooth , large - scale asymmetric beam systematics ( such as far - side lobe effects ) we show that our @xmath0-truncated spherical harmonic representation of the beam results in negligible reconstruction error  even for @xmath0 as small as 4 for a polarized elliptically asymmetric beam . </S>",
    "<S> we describe a hybrid openmp / mpi parallelization scheme which allows us to store and manipulate the time - ordered data from instruments with arbitrary scanning strategy . </S>",
    "<S> finally , we apply our technique to noisy data and show that it succeeds in removing visible power spectrum artifacts without generating excess noise on small scales . </S>"
  ]
}