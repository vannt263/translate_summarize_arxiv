{
  "article_text": [
    "chemical reaction networks ( crns ) and mass action kinetics are well studied formalisms for modelling biochemical systems @xcite . in recent years , crns have also been successfully used as a formal programming language for biochemical systems @xcite .",
    "there are two well established approaches for analyzing chemical networks : deterministic and stochastic @xcite .",
    "the deterministic approach models the kinetics of a crn as a system of ordinary differential equations ( odes ) and represents average behaviour , valid in the thermodynamic limit @xcite .",
    "the stochastic approach , on the other hand , is based on the chemical master equation ( cme ) and models the crn as a continuous - time markov chain ( ctmc ) @xcite .",
    "the stochastic behavior can be analyzed by stochastic simulation @xcite or by exhaustive probabilistic model checking of the ctmc , which can be performed , for example , by using prism @xcite .",
    "exhaustive analysis of the ctmc is able to find the best- and worst - case scenarios and is correct for any population size , but suffers from the state - space explosion problem @xcite and can only be used for relatively small systems . in contrast , deterministic methods are much more robust with respect to state - space explosion , but unable to represent stochastic fluctuations , which play a fundamental role when the system is not in thermodynamic equilibrium .",
    "* contributions . * in this paper we develop a novel approach for analysing the stochastic evolution of a crn based on the linear noise approximation ( lna ) of the cme .",
    "we formulate sel ( stochastic evolution logic ) , a probabilistic logic for crns that enables reasoning about probability , expectation and variance of linear combinations of populations of the species .",
    "examples of properties that can be specified in our logic are shown in example [ ex-1 ] .",
    "we propose an approximate model checking algorithm for the logic based on the lna and implement it in matlab and java .",
    "we demonstrate that the complexity of model checking is polynomial in the initial number of species and independent of the initial molecule counts , thus ameliorating state - space explosion .",
    "further , we show that model checking is exact when approaching the thermodynamic limit . though the algorithm may not be accurate for systems far from the deterministic limit ,",
    "this generally happens when the populations are small , in which case the analysis can be performed by transient analysis of the induced ctmc @xcite .",
    "our approach is essential for crns that can not be analyzed by ( partial ) state space exploration , because of large or infinite state spaces .",
    "moreover , it is useful for a fast ( approximate ) stochastic characterization of crns , since solving the lna is much faster than solving the cme @xcite .",
    "we prove asymptotic correctness of lna - based model checking and show on four examples that it is still possible to obtain very good approximations even for small population systems , comparing with standard uniformisation @xcite and statistical model checking implemented in prism  @xcite",
    ".    * related work . *",
    "the closest work to ours is by bortolussi _",
    "@xcite , which uses the central limit approximation ( cla ) ( essentially the same as the lna ) for checking restricted timed automata specifications , assuming a fixed population size . wolf _",
    "@xcite develop a sliding window method to approximately verify infinite - state ctmcs , which applies to cases where most of the probability mass is concentrated in a confined region of the state space .",
    "recently , finite state projection algorithms ( fsp algorithms ) for the solution or approximation of the cme have been introduced @xcite .",
    "both methods apply to the induced ctmc , but require at least partial exploration of the state space , and are thus not immune to state - space explosion .",
    "* structure of the paper .",
    "* in section [ crn - sec ] we summarise the deterministic and stochastic modelling approaches for crns , and in section [ lna - sec ] we describe the linear noise approximation method . section [ logic - sec ] introduces the logic sel and the corresponding model checking algorithm based on the lna . in section [ results - sec ]",
    "we demonstrate our approach on four networks taken from the literature .",
    "section  [ concl - sec ] concludes the paper .",
    "a _ chemical reaction network ( crn ) _",
    "@xmath0 is a pair of finite sets , where @xmath1 is the set of _ chemical species _ and @xmath2 the set of reactions .",
    "@xmath3 denotes the size of the set of species .",
    "a _ reaction _",
    "@xmath4 is a triple @xmath5 , where @xmath6 and @xmath7 .",
    "@xmath8 and @xmath9 represent the stoichiometry of reactants and products and @xmath10 is the coefficient associated to the rate of the reaction ; its dimension is @xmath11 .",
    "we often write reactions as @xmath12 instead of @xmath13^t,[0,2,0]^t , k_1 ) $ ] , where @xmath14 indicates the transpose of a vector .",
    "we define the _ net change _ associated to a reaction @xmath15 by @xmath16 . for example , for @xmath17 as above , we have @xmath18^t$ ] .",
    "we make the assumption that the system is well stirred , that is , the probability of the next reaction occurring between two molecules is independent of the location of those molecules .",
    "we consider fixed volume @xmath19 and temperature ; under these assumptions a _ configuration _ or _ state _ @xmath20 of the system is given by the number of molecules of each species .",
    "we define @xmath21=\\frac{x}{n}$ ] , the vector of the species _ concentration _ in @xmath22 for a given @xmath23 , where @xmath24 is the volumetric factor , @xmath19 is the volume of the solution and @xmath25 is avogadro s number .",
    "the physical dimension of @xmath23 is @xmath26 , where @xmath27 indicates mole and @xmath28 is litre .",
    "given @xmath29 then @xmath30 represents the number of molecules of @xmath31 in @xmath22 and @xmath32\\_x\\in \\mathbb{r}$ ] the concentration of @xmath31 in the same configuration . in some cases we elide @xmath22 , and we simply write @xmath33 and @xmath32 $ ] instead of @xmath34 and @xmath32\\_x$ ] .",
    "they are related by @xmath32=\\frac{\\#\\lambda_i}{n}$ ] .",
    "the dimension of @xmath32 $ ] is @xmath35 .",
    "the propensity @xmath36 of a reaction @xmath15 in terms of the number of molecules is a function of the current configuration of the system @xmath22 such that @xmath37 is the probability that a reaction event occurs in the next infinitesimal interval @xmath38 . in this paper",
    "we assume as valid the stochastic form of the law of mass action , so the propensity rates are proportional to the number of molecules that participate in the reaction @xcite .",
    "stochastic models consider the system in terms of numbers of molecules , while deterministic ones , generally , in terms of concentrations , and the relationship is as follows . for a reaction @xmath5 , given the configuration @xmath22 and @xmath39 ,",
    "the @xmath40-th component of @xmath8 , then @xmath41\\_x)}^{r_{\\tau , i}}$ ] is the propensity function expressed in terms of concentrations as given by the deterministic law of mass action .",
    "it is possible to show that , for any order of reaction , @xmath42 if @xmath23 is sufficiently large @xcite .",
    "note that @xmath43 is independent of @xmath23 .",
    "in this paper we are interested only in finite time horizon , because of the problematic character of studying solutions of odes for infinite time horizon @xcite .",
    "r0.46        [ ex-1 ] consider the crn @xmath44 , where @xmath45 , with initial conditions @xmath46 , for a system with @xmath47 .",
    "figure [ fig : example ] plots the expectation and standard deviation of population sizes . we may wish to check if the maximum expected value of @xmath48 remains smaller than @xmath49 molecules during the first @xmath50 . however , the system is stochastic , so we also need to analyse whether the variance is limited enough when @xmath48 reaches the maximum .",
    "sometimes , analysis of first and second moments does not suffice , so it could be of interest to check the probability of some events , for instance , is the probability that , between @xmath51 and @xmath52 , @xmath53 greater than @xmath54    * deterministic semantics .",
    "* let @xmath0 be a crn .",
    "the deterministic model approximates the concentration of the species of the system over time as a set of autonomous polynomial first order differential equations : @xmath55 @xmath56 and @xmath57 .",
    "function @xmath58 describes the behaviour of the system as a set of deterministic equations assuming a continuous state - space semantics , therefore @xmath59 is the vector of the species concentrations at time @xmath60 . assuming @xmath61 , the initial condition is @xmath62 $ ] , expressed as a concentration .",
    "note that @xmath63 is lipschitz continuous , so @xmath64 exists and is unique @xcite .    *",
    "* stochastic semantics.**crns are well represented by ctmcs , whose transient analysis can be performed via the chemical master equation ( cme ) @xcite .",
    "[ ctmc - defn ] given a crn @xmath0 and the volumetric factor @xmath23 , we define a time - homogeneous ctmc @xcite @xmath65 with state space @xmath66 .",
    "given @xmath67 , the initial configuration of the system , then @xmath68 .",
    "the transition rate from state @xmath69 to state @xmath70 is defined as @xmath71 .",
    "@xmath72 describes the stochastic evolution of molecular populations of each species at time @xmath60 . for @xmath73 , we define @xmath74 , where @xmath75 is the initial configuration .",
    "the cme describes the time evolution of @xmath76 as : @xmath77 the cme can be equivalently defined in terms of the infinitesimal generator matrix @xcite , which admits computing an approximation of the cme using , for example , fast adaptive uniformisation @xcite or the sliding window method @xcite .",
    "we also define the ctmc @xmath78 with state space @xmath79 .",
    "if @xmath80 \\in s$ ] is the initial configuration , then @xmath81)=1.$ ] the transition rate from state @xmath82 $ ] to @xmath83 $ ] is defined as @xmath84,[x_j ] ) = \\sum_{\\{\\tau \\in r   | [ x_j]=[x_i]+ \\frac{v_{\\tau}}{n}\\ } }   n\\alpha_{c,\\tau}(x_i)$ ] .",
    "@xmath85 is the random vector describing the system at time @xmath60 in terms of concentrations . in @xcite",
    "it is proved that @xmath86 \\|=0 $ ] almost surely for every time @xmath60 .",
    "this explains the relationship between the two different semantics , where the deterministic solution can be viewed as a limit of the stochastic solution , valid when close enough to the thermodynamic limit .",
    "the solution of the cme can be computationally expensive , or even infeasible , because the set of reachable states can be huge or infinite .",
    "the linear noise approximation ( lna ) has been introduced by van kampen as a second order approximation of the system size expansion of the cme @xcite .",
    "since stochastic fluctuations depend on @xmath23 , and specifically , for average concentrations , are of the order of @xmath87 @xcite , to derive the expansion van kampen assumes that : @xmath88 where @xmath89 is the random vector , independent of @xmath23 , representing the stochastic fluctuations , @xmath90 is given by the solution of eqn and @xmath72 is the random vector of definition  [ ctmc - defn ] . using this substitution in the system size expansion and then truncating at the second order ,",
    "the probability distribution of @xmath91 is found to be given by the following linear fokker - plank equation @xcite : @xmath92 where @xmath93 and @xmath94 is the @xmath95th component of @xmath63 .",
    "the solution of eqn gives a gaussian process .",
    "for every time @xmath60 , @xmath91 has a multivariate normal distribution , whose expected value and covariance matrix are the solution of the following equations @xcite : @xmath96}{\\mathrm d t }   = j_f(\\phi(t))e[z(t ) ] \\label{eq : ev1}\\ ] ] @xmath97 } { \\mathrm d t }   = j_f(\\phi(t))c[z(t ) ] + c[z(t)]{j^t}_f(\\phi(t))+g(\\phi(t ) ) \\label{eq : cov1}\\ ] ] where @xmath98 is the jacobian of @xmath63 .",
    "we consider as initial conditions @xmath99=0 $ ] and @xmath100=0 $ ] .",
    "this means that @xmath101=0 $ ] for every @xmath60 .",
    "it is possible to justify the hypothesis noting that in the lowest order the cme expansion reduces to eqn , and with the following theorem by kurtz :    @xcite[lna - thm ] consider the subset @xmath102 on which are defined the propensity functions @xmath43 .",
    "let @xmath103 be the random vector given by @xmath104 .",
    "suppose that @xmath105 for each compact @xmath106 , and that , for @xmath107 , @xmath108 , then @xmath103 converges in distribution to @xmath91 .",
    "the lna thus permits approximation of the probability distribution of @xmath72 with the probability distribution of @xmath109 .",
    "it is easy to show that @xmath110 has a gaussian distribution ; indeed , @xmath91 is gaussian distributed , and @xmath23 and @xmath90 are deterministic .    to compute the lna it is necessary to solve @xmath111 first order differential equations , but",
    "the complexity is independent of the initial number of molecules of each species .",
    "therefore , one can avoid the exploration of the state space that methods based on uniformisation rely upon .",
    "theorem [ lna - thm ] alone only guarantees convergence in distribution . however , in @xcite",
    ", lna is derived as an approximation of the chemical langevin equation ( cle ) @xcite , rather than system size expansion .",
    "this shows that lna is valid for every real chemical system close enough to the thermodynamical limit , at least for a limited time .",
    "thus , lna is exact in the limit of high populations , but can also be used for small populations if the behaviour is not too far from the deterministic limit , taking into account the continuous nature of the approximation and gaussian assumptions on the noise @xcite .",
    "we have shown that @xmath76 can be approximated by @xmath112 , where @xmath110 has a multivariate gaussian distribution , so it is completely characterized by its expected value and covariance matrix , whose values are respectively @xmath113=n\\phi(t)$ ] and @xmath114=n^{\\frac{1}{2 } } c[z(t ) ] n^{\\frac{1}{2}}=n c[z(t)]$ ] .    since @xmath115 has a multivariate normal distribution then every linear combination of its components",
    "is normally distributed . therefore , given @xmath116 $ ] where @xmath117 , we can consider the random variable @xmath118 , which defines a linear combination of the species at time @xmath60 .",
    "for every @xmath60 , @xmath119 is a normal random variable , whose expected value and variance are @xmath120= be[{y^{n}}(t ) ]          \\label{eq : excom}\\ ] ] @xmath121= bc[{y^{n}}(t)]b^t          \\label{eq : varcom}\\ ] ] for a specific time @xmath122 , it is possible to calculate the probability that @xmath123 is within a set @xmath124 of closed , disjoint real intervals @xmath125 $ ] , where @xmath126 .",
    "this probability @xmath127 is given by @xmath128 \\in i } \\int\\limits_{l_i}^{u_i } g(x|e[b{y^{n}(t_k ) } ] , c[b{y^{n}(t_k)}])dx \\label{eq : combination}\\ ] ] where @xmath129 is the gaussian distribution with expected value @xmath130 and covariance @xmath131 .",
    "we recall that it is possible to find numerical solution of eqn in constant time using the z table @xcite .",
    "consider the crn of example [ ex-1 ] , then we can obtain the probability that @xmath132 is at least @xmath133 at time @xmath134 by defining @xmath135 , \\",
    ", i'=\\{[10,+\\infty]\\}$ ] and calculating @xmath136 .",
    "the following theorems are consequences of results in @xcite , which can be generalized for reactions with a finite number of reagents and products .",
    "they show asymptotic pointwise convergence of expected value , variance and probability .",
    "[ prob - thm ] let @xmath0 be a crn .",
    "suppose the solution of eqn is bounded , then , approaching the thermodynamic limit , for any finite instant of time @xmath137 @xmath138 where @xmath139 is the probability that @xmath140 is within @xmath124 at time @xmath137 .",
    "[ exp - var - thm ] suppose the solution of eqn is bounded , then , approaching the thermodynamic limit , for any finite instant of time @xmath122 @xmath141 - c[bx^{n}(t_k ) ] \\| = 0\\ ] ] @xmath142 -e[bx^{n}(t_k ) ] \\| = 0.\\ ] ]    to solve the differential equations and , it is necessary to use a numerical method such as adaptive runge - kutta algorithm @xcite .",
    "this yields the solution for a finite set of sampling times @xmath143 \\in \\mathbb{r}^{|\\sigma|}$ ] , where @xmath144 and @xmath145 is the sample size .",
    "assuming @xmath115 is separable , that is , it is possible to completely define the behavior of @xmath115 by only considering a countable number of points , we can calculate @xmath146 for any point in @xmath147 and if points are dense enough then this set exhaustively describes the probability that @xmath148 is within @xmath124 over time .",
    "this restriction is not a limitation since for any stochastic process there exists a separable modification of it @xcite .",
    "let @xmath149 be a crn with initial state @xmath75 , in a system of size @xmath23 .",
    "we now define the logic sel ( stochastic evolution logic ) which enables evaluation of the probability , variance and expectation of linear combinations of populations of the species of @xmath150 .",
    "the syntax of sel is given by    @xmath151_{[t_1,t_2 ] }   \\quad |\\quad q_{\\sim v}[b]_{[t_1,t_2 ] } \\quad |\\quad \\eta_1 \\wedge \\eta_2 \\quad   | \\quad \\eta_1 \\vee \\eta_2 \\quad\\ ] ]    where @xmath152 , @xmath153 , @xmath154 $ ] , @xmath155 , @xmath156 , @xmath157 \\ , | \\ , l_i , u_i \\in \\mathbb{r } \\cup [ + \\infty,-\\infty ] \\ ,",
    "\\wedge [ l_i , u_i]\\cap [ l_j , u_i]=\\emptyset , \\",
    ", i \\neq j\\}$ ] and @xmath158 $ ] is a closed interval , with the constraint that @xmath159 and @xmath160 . if @xmath161 the interval reduces to a singleton .",
    "formulae @xmath162 describe global properties of the stochastic evolution of the system .",
    "@xmath163 specifies a linear combination of the species of @xmath150 and a set of intervals , where @xmath156 is the vector defining the linear combination and @xmath124 represents a set of disjoint closed real intervals .",
    "@xmath164_{[t_1,t_2]}$ ] is the probabilistic operator , which specifies the probability that the linear combination defined by @xmath165 falls within the range @xmath124 over the time interval @xmath158 $ ] .",
    "@xmath166 respectively yield the supremum and infimum of expected value and variance of the random variables associated to @xmath165 within the specified time interval .",
    "consider the crn of example [ ex-1 ] .",
    "checking if the variance of @xmath167 remains smaller than @xmath168 within @xmath169 $ ] can be expressed as @xmath170_{[t_j , t_k]}$ ] .",
    "another example is checking if , in the same interval , @xmath171 is at least @xmath172 or within @xmath173 $ ] , with @xmath174 , with probability greater than @xmath175 : .",
    "equivalently , instead of writing @xmath165 , we write directly the linear combination it defines .",
    "for example , in the latter case we have @xmath176,[k_2,\\infty])]_{[t_j , t_k]}$ ] .      given a crn @xmath0 with initial configuration @xmath75 in a system of fixed volumetric factor @xmath23 , its stochastic behaviour is described by the ctmc @xmath76 of definition [ ctmc - defn ] .",
    "we define a path of ctmc @xmath76 as a sequence @xmath177 where @xmath69 is a state and @xmath178 is the time spent in the state @xmath69 .",
    "a path is finite if there is a state @xmath179 that is absorbing .",
    "@xmath180 is the state of the path at time @xmath60 .",
    "@xmath181 is the set of all ( finite and infinite ) paths of the ctmc starting in @xmath75 .",
    "we work with the standard probability measure @xmath182 over paths @xmath181 defined using cylinder sets @xcite .",
    "we first define when a path @xmath183 satisfies @xmath184 at time @xmath60 @xmath185 \\in i \\,.\\ ,    l_i \\leq",
    "b(\\omega \\otimes t ) \\leq u_i .\\ ] ] note that @xmath186 is well defined because @xmath187 .",
    "we now define @xmath188 , then if the time interval is a singleton the satisfaction relation for the probabilistic operator is @xmath189_{[t_1,t_1 ] }    \\quad \\leftrightarrow \\quad   pr^{x^n}_{b , i } ( t_1 ) \\sim p\\ ] ] instead , for @xmath190 we have @xmath189_{[t_1,t_2 ] }    \\quad \\leftrightarrow \\quad \\frac{1}{t_2-t_1 }   \\int_{t_1}^{t_2 } pr^{x^n}_{b , i } ( t)\\,\\mathrm{d}t \\sim p\\ ] ] @xmath191 is the probability of the set of paths of @xmath76 such that the linear combination of the species defined by @xmath165 falls within @xmath124 .",
    "it is well defined since we have previously defined the probability measure @xmath182 on @xmath192 . to define the satisfaction relation of the probabilistic operator we simply take the average value of @xmath191 during the interval",
    "@xmath158 $ ] . for the remaining operators",
    "the satisfaction relation is defined as @xmath193_{[t_1,t_2 ] }   \\quad     \\leftrightarrow \\quad    sup(c[b(x^n)],[t_1,t_2 ] ) \\sim v\\ ] ] @xmath194_{[t_1,t_2 ] }   \\quad     \\leftrightarrow \\quad      inf(c[b(x^n)],[t_1,t_2 ] ) \\sim v\\ ] ] @xmath195_{[t_1,t_2 ] }   \\quad     \\leftrightarrow \\quad      sup(e[b(x^n)],[t_1,t_2 ] ) \\sim v\\ ] ] @xmath196_{[t_1,t_2 ] }   \\quad     \\leftrightarrow \\quad      inf(e[b(x^n)],[t_1,t_2 ] ) \\sim v\\ ] ] @xmath197 @xmath198 @xmath199)$ ] and @xmath200)$ ] respectively denote the infimum and supremum within @xmath158 $ ] .",
    "stochastic model checking of crns is usually achieved by transient analysis of the ctmc @xmath76 @xcite , which involves solving the cme and thus suffers from the state - space explosion problem .",
    "we propose an approximate model checking algorithm based on lna .",
    "the inputs are a sel formula @xmath162 , the stochastic process @xmath76 induced by the crn and initial state @xmath75 .",
    "the output is @xmath201 in case the formula is verified , and otherwise @xmath202 .",
    "the algorithm proceeds by induction on the structure of formula @xmath162 , successively computing whether each subformula is satisfied or not .",
    "we assume that eqn and are solved numerically where @xmath147 is the finite set of sample points on which their solution is defined and that @xmath203 , initial time , and @xmath204 , final time , are always sampling points .      to evaluate @xmath205_{[t_1,t_2]}$ ]",
    "we construct the function @xmath206 for @xmath207 ( alternatively , can be constructed as the interpolation of the values of @xmath146 over @xmath147 points ) .",
    "@xmath208 is integrable on @xmath209 .",
    "theorem [ prob - thm ] guarantees the pointwise correctness of @xmath208 and its integrability allows us to compute the following approximation , then compare to threshold @xmath210 to decide the truth value . if @xmath211 then @xmath212 else if @xmath161 then @xmath213 .      to evaluate @xmath214,[t_1,t_2 ] ) $ ] , @xmath215,[t_1,t_2])$ ] , @xmath216,[t_1,t_2 ] ) $ ] and @xmath217,[t_1,t_2])$ ] we use the lna , namely , compute the expected value and variance of eqn and .",
    "theorem [ exp - var - thm ] guarantees the quality of the approximation .",
    "we can now compute the following approximations , then compare to the threshold @xmath218 : @xmath219,[t_1,t_2])\\approx max   \\ { c[by^{n}(t_k ) ] \\ , | \\ , ( t_k \\in \\sigma \\wedge t_1\\leq t_k \\leq t_2 ) \\vee ( t_k \\in l_{[t_1,t_2 ] } ) \\}\\ ] ] @xmath220,[t_1,t_2])\\approx min \\ { c[by^{n}(t_k ) ] \\ , | \\ , ( t_k \\in \\sigma \\wedge t_1\\leq t_k \\leq t_2 ) \\vee ( t_k \\in l_{[t_1,t_2 ] } ) \\}\\ ] ] and similarly for the expected value .",
    "t_i \\in \\sigma   \\ ,   \\ , \\wedge \\,\\ , \\nexists",
    "t_j \\in \\sigma$ ] @xmath222 @xmath223 @xmath224 ensures that for any time interval there is at least one sampling point , even if the interval is a singleton .",
    "note that , for each sub - formula , the algorithm involves the calculation of some quantity , so one can define a quantitative semantics for sel as in @xcite .",
    "lna - based model checking can also be used for systems far from the thermodynamic limit , at a cost of some loss of precision .",
    "lna assumes continuous state space , and it is not possible to justify this assumption for very small populations . however , if the distributions of interest are not multi - modal and the noise term is finite and approximated by a gaussian distribution , then lna gives very good approximation even for quite small systems .",
    "it is clear that model checking accuracy increases as @xmath23 grows .",
    "we emphasise that the model checking algorithm we have presented is also able to handle crns whose stochastic semantics is an infinite ctmc , which occur frequently in biological models .",
    "the time complexity for model checking formula @xmath162 against a crn @xmath0 is linear in @xmath225 . in the worst case , analysis of a single operator",
    "requires the solution of @xmath111 polynomial differential equations for a bounded time .",
    "however , an efficient implementation can solve the @xmath111 odes only once for the interval @xmath226 $ ] , and then reuse this result for every operator , where @xmath204 is the greatest ( finite ) time of interest .",
    "note that odes are solved in terms of concentrations ( a value between @xmath227 and @xmath228 by convention ) , ensuring independence of the number of molecules of each species , although stiffness can slow down the solution of the lna .",
    "we implemented the methods in a framework based on matlab and java .",
    "the experiments were run on an intel dual core @xmath229 machine with @xmath230 gb of ram . to solve the differential equations",
    ", we use @xmath231 @xmath232 , a variable step runge - kutta algorithm .",
    "we employ lna - based model checking for the analysis of four biological reaction networks : a phosphorelay network @xcite , a gene expression model @xcite , the fgf pathway @xcite and the gw network @xcite . for every network ,",
    "the crn and parameters have been taken from the referenced papers .",
    "we coded the same crns in prism in order to compare accuracy and time of execution with standard uniformisation of the cme @xcite and statistical model checking ( smc ) techniques ( confidence interval method ) as implemented in prism .",
    "for the fgf and gw case studies , we can not use global analysis nor smc , because the state space is too large for direct analysis , and smc requires many time - consuming simulations to obtain good accuracy .",
    "* phosphorelay network .",
    "* we consider a three - layer phosphorelay network whose structure is derived from @xcite .",
    "each layer @xmath233 can be found in phosphorylate form @xmath234 .",
    "we consider the initial condition @xmath235 , where @xmath236 .",
    "then we analyse the ligand @xmath165 , whose initial condition is @xmath237 .",
    "we are interested in checking the following sel property : @xmath238_{[0,100]}\\wedge p_{>0.98}[(\\#l3p-\\#l1p),[0,+\\infty]]_{[300,600]}\\ ] ] which is verified if , in the first interval , the probability that @xmath239 is greater than @xmath240 is @xmath241 and if , between @xmath242 and @xmath243 , with probability @xmath244 , @xmath240 is greater than @xmath239 .",
    "we evaluate this formula in three different initial conditions , firstly @xmath245 and @xmath246 , then @xmath247 and @xmath248 , and finally @xmath249 and @xmath250 , so the same concentration but different numbers of molecules . in all cases ,",
    "the lna - based model checking evaluates the formula as true . to understand the quality of the approximation",
    ", we check the following quantitative formula @xmath251)]_{[t , t]}$ ] for @xmath252 $ ] ( in our implementation @xmath253 gives the quantitity calculated by model checking the operator ) . we compare the results with the evaluation of the corresponding csl formula using standard uniformisation ( @xmath254 ) with error @xmath255 @xcite .",
    "the following table shows the results .",
    "@xmath256 is the maximum error computed by lna - based approach compared to standard uniformisation and @xmath257 is the average error ; @xmath258 stands for execution time .    [",
    "cols=\"<,<,<,<,<\",options=\"header \" , ]     * fgf . * we consider the model of fibroblast growth factor ( fgf ) signalling pathway developed in @xcite composed of more than @xmath259 reactions and species .",
    "we consider the system with initially 105 molecules for species with non - zero initial concentration .",
    "analysis of the model reveals that the phosphorylated form of @xmath260 can bind the protein @xmath261 , and then this new complex , @xmath261:@xmath260 , can relocate out .",
    "we want to check if the expected value of @xmath262:@xmath260 during the first @xmath263 seconds reaches a maximum value greater than @xmath264 .",
    "we do that by checking the property @xmath265:@xmath266_{[0,3000]}$ ] .",
    "the formula evaluates to true , and in figure [ fig : sto ] we analyze the expected value and standard deviation of @xmath267:@xmath260 .",
    "we obtain these values directly from the logic considering the quantitative interpretation of @xmath268:@xmath266_{[t , t]}$ ] and @xmath269:@xmath266_{[t , t]}$ ] for @xmath270 $ ] .",
    "it is possible to see that , after an initial peak , relocation causes exponential decay .",
    "r0.54        in the same figure we show a single stochastic simulation of the system for the same initial conditions , confirming our evaluation .",
    "moreover , the approximation can be justified theoretically .",
    "@xmath262:@xmath260 converges to zero necessarily and this demonstrates the unimodality of the distribution of the species ; we note that the variance is finite , so eqn holds .",
    "* dna strand displacement of gw network * gw is a network related to the g2-m cell cycle switch @xcite . under particular initial conditions",
    ", it has been shown that gw can emulate the approximate majority algorithm @xcite . here",
    ", we consider the two - domain dna strand - displacement implementation of gw @xcite .",
    "the corresponding crn is composed of @xmath271 species and @xmath272 reactions . for our analysis",
    "the species of interest are @xmath2 and @xmath273 , whose initial conditions are @xmath274 and @xmath275 ; initial conditions of other species are taken from the referenced papers .",
    "we check the property @xmath276_{[6000,35000]}$ ] for a system of size @xmath277 , which is verified as true in @xmath278 minutes .",
    "we presented a novel probabilistic logic for analysing stochastic behaviour of crns and proposed an approximate model checking algorithm based on the lna of the cme .",
    "we have demonstrated on four non - trivial examples that lna - based model checking enables analysis of crns with hundreds of species , and even infinite ctmcs , at a cost of some loss of accuracy .",
    "it would be interesting to find bounds on the approximation error when the system is far from the thermodynamic limit .",
    "however , the error is not only dependent on the value of @xmath23 , but also on the structure of the crn , the rates , and the property . as future work",
    ", we plan to improve the accuracy of the method near critical points similarly to the approach of @xcite , and to extend the logic with more expressive temporal operators in the style of csl @xcite .",
    "we also intend to release a software tool based on lbs @xcite .",
    "the authors would like to thank luca bortolussi for helpful discussions .",
    "@xmath279 is riemann integrable on @xmath209 .",
    "@xmath208 is a bounded function with at most @xmath280 discontinuities , where @xmath281 .",
    "therefore , the set of discontinuities is a countable set , and countable sets have measure @xmath227 .",
    "therefore , the conditions of the lebesgue criterion for integrability holds .",
    "this concludes the proof ."
  ],
  "abstract_text": [
    "<S> stochastic evolution of chemical reactions networks ( crns ) over time is usually analysed through solving the chemical master equation ( cme ) or performing extensive simulations . </S>",
    "<S> analysing stochasticity is often needed , particularly when some molecules occur in low numbers . </S>",
    "<S> unfortunately , both approaches become infeasible if the system is complex and/or it can not be ensured that initial populations are small . we develop a probabilistic logic for crns that enables stochastic analysis of the evolution of populations of molecular species . </S>",
    "<S> we present an approximate model checking algorithm based on the linear noise approximation ( lna ) of the cme , whose computational complexity is independent of the population size of each species and polynomial in the number of different species . </S>",
    "<S> the algorithm requires the solution of first order polynomial differential equations . </S>",
    "<S> we prove that our approach is valid for any crn close enough to the thermodynamical limit . </S>",
    "<S> however , we show on four case studies that it can still provide good approximation even for low molecule counts . </S>",
    "<S> our approach enables rigorous analysis of crns that are not analyzable by solving the cme , but are far from the deterministic limit . </S>",
    "<S> moreover , it can be used for a fast approximate stochastic characterization of a crn . </S>"
  ]
}