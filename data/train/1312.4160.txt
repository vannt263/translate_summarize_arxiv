{
  "article_text": [
    "relativistic fluid dynamics has been applied to various high energy phenomena in astrophysics , nuclear and hadron physics , from collision of galaxies down to the evolution of femtometer - size droplets of dense matter created in ultra - relativistic heavy ion collisions . in astrophysics",
    "typical applications of relativistic fluid dynamics are collapse of massive stars , formation of and flow around black holes , collisions of neutron stars and passage of relativistic jets through intergalactic matter  @xcite . on earth",
    "relativistic flows appear in ultrarelativistic heavy - ion collisions , where the formed matter depicts collective behaviour .",
    "especially the anisotropies of the final particle distribution were described so well using ideal fluid dynamics , that the matter was called almost perfect fluid with the lowest possible viscosity .",
    "the determination of the dissipative properties of this matter has became one of the major goals of heavy - ion physics , and requires sophisticated fluid dynamical calculations .",
    "the equations of motion of relativistic fluid dynamics are notoriusly difficult to solve . except in very idealised situations ,",
    "no analytic solutions exist , and the equations must be solved numerically .",
    "several groups have developed several codes for fluid dynamical modeling of heavy - ion collisions  @xcite , but many of these codes assume boost - invariant longitudinal expansion  @xcite and/or zero net baryon density in the entire system .",
    "neither of these assumptions is a good approximation in collisions at the beam energy scan energies ( @xmath039 gev ) at bnl rhic ( relativistic heavy - ion collider ) nor in collisions in the forthcoming experiments at fair or nica .",
    "we have therefore developed a new code where both of these assumptions have been relaxed . in this paper",
    "we present the results of test simulations of this code .",
    "high - resolution shock - capturing ( hrsc ) algorithms are particularly suitable for solving the equations of relativistic fluid dynamics , and are applied for a wide variety of problems  @xcite .",
    "hrsc algorithms are designed to treat discontinuous shock configurations in hydrodynamic solution , or shock waves .",
    "the methods usually incorporate higher - order schemes which minimize numerical errors .",
    "most of hrsc algorithms are formulated in conservative form , where the time evolution of cell averaged quantities is governed by numerical fluxes evaluated at cell boundaries .",
    "the conservative form ensures that the total energy and momentum in the system is conserved during the time evolution",
    ". a sub - family of hrsc algorithms are godunov - type algorithms , which are based on exact or approximate solutions of the riemann problem at the cell boundaries in order to compute time - averaged fluxes through it .",
    "our code is based on the godunov - type relativistic harten - lax - van  leer - einfeldt ( hlle ) approximate riemann solver @xcite .",
    "this particular choice of the approximate riemann solver is motivated by its simplicity , reliability , and stability for the simulations related to the physics of ultra - relativistic heavy ion collisions .",
    "the riemann problem is formulated for an inviscid fluid , where shock wave solutions are allowed .",
    "basing on the algorithms established for inviscid fluid , we aim to study the evolution of nearly ideal fluid ( fluids with close - to - minimal viscosity ) like the one presumably created in ultrarelativistic heavy ion collisions .",
    "to do this , we employ additional methods to solve the equations of relativistic viscous hydrodynamics in the israel - stewart framework @xcite , keeping the ability to solve the equations of ideal hydrodynamics in the limit of zero shear and bulk viscosities .",
    "the use of an ( approximate ) riemann solver makes it possible to treat the highly inhomogeneous matter configurations emerging from event - by - event initial conditions as employed in the most recent studies of heavy ion collisions .",
    "the present hydrodynamic code is already being used as a part of epos3 event generator for ultra - relativistic heavy ion collisions @xcite and as a part of hydrodynamic+cascade model @xcite in a studies focused on beam energy scan ( bes ) project at the bnl relativistic heavy ion collider ( rhic ) .",
    "the article is organized as follows . in sec .",
    "[ secequations ] the formalism is presented , sec .",
    "[ secnumerical ] provides the details of the numerical implementation .",
    "[ sectests ] is devoted to the description and results of test simulations , including a comparison for the physical setup for the matter expansion in relativistic a+a collisions , and we summarize in sec .  [ secconclusions ] .",
    "throughout this work natural units are employed , i.e. the speed of light in vacuum @xmath1 , the boltzmann constant @xmath2 and the planck constant @xmath3 .",
    "the equations of relativistic ( viscous ) hydrodynamics follow from the laws of energy - momentum and charge conservation : @xmath4 with @xmath5 being the energy - momentum tensor and @xmath6 the charge current , index @xmath7 enumerates the conserved charges if there are multiple conserved charges in the system .    the landau definition of flow velocity @xmath8 ( landau frame ) as a flow of energy @xcite is adopted , i.e. @xmath9 . in this frame",
    ", the energy - momentum tensor for a viscous fluid can be decomposed as : @xmath10 @xmath11 where    * @xmath12 and @xmath13 are energy density in fluid rest frame and equilibrium pressure , respectively , * @xmath14 is the projector orthogonal to @xmath8 , * @xmath15 and @xmath16 are the shear stress tensor and bulk pressure , * @xmath17 are charge diffusion currents .",
    "the hydrodynamic equations are closed with the equation of state ( eos ) @xmath18 , which has to be supplied from some external model .    in the israel - stewart framework of relativistic viscous hydrodynamics @xcite",
    "the shear stress tensor and bulk pressure are independent dynamical variables .",
    "recent studies @xcite show that there can be infinitely many choices for the explicit form and coefficients in equations of motion for @xmath15 and @xmath16 . in the present work",
    "the following choice for the equations of motion for the shear stress tensor and bulk pressure is used , where we neglect vorticity terms :    @xmath19    and where @xmath20 denotes a covariant derivative .",
    "this choice has already been widely used in recent simulations of nucleus - nucleus collisions at relativistic energies . for the purpose of the tests and our current applications we do not include the baryon / electric charge diffusion , i.e. @xmath21 . angle brackets in ( [ evolutionshear ] )",
    "are defined as : @xmath22 and denote the symmetric , traceless and orthogonal to @xmath8 part of @xmath23 .",
    "@xmath24 are the values of shear stress tensor and bulk pressure in limiting navier - stokes case .    for hydrodynamic simulations related to the physics of ultrarelativistic heavy ion collisions milne coordinates for the @xmath25 plane in spacetime ( @xmath26 being the collision axis ) are chosen .",
    "the new coordinates are expressed in terms of minkowski coordinates @xmath27 as @xmath28 , @xmath29 , while the definitions of @xmath30 and @xmath31 coordinates are unchanged .",
    "the form of hydrodynamic equations in arbitrary coordinate systems is : @xmath32 where @xmath33 are affine connections or christoffel symbols .",
    "we choose west coast convention @xmath34 for metric tensor in minkowski spacetime , so in milne coordinates the invariant interval is : @xmath35 , and the metric tensor is @xmath36    although spacetime is still flat , there are nontrivial christoffel symbols , the nonzero components being : @xmath37 which leads to the following explicit form of hydrodynamic equations : @xmath38    in milne coordinates , @xmath5 and @xmath39 keep the same structure , however the velocities are expressed through the longitudinal / transverse rapidities in the cartesian frame as : @xmath40 where @xmath41 is longitudinal flow rapidity and @xmath42 is transverse flow rapidity . from the equation above one can see that @xmath43 when @xmath44 , which means that @xmath43 corresponds to scaling bjorken flow in cartesian coordinates , @xmath45 .",
    "thus , milne coordinates naturally describe the expansion along @xmath26 axis from a point - like source .    as one can see ,",
    "almost all source terms in ( [ eqns0 ] ) are proportional to @xmath46 , which makes them dominant for the hydrodynamic evolution at small @xmath47 .",
    "this is natural when one remembers that the gradient of the longitudinal scaling flow is inversely proportional to @xmath48 in the cartesian frame .",
    "the accurate numerical solution would eventually require to apply a higher order numerical time integration scheme .",
    "we circumvent this by redefining the variables in milne coordinates as : @xmath49 rewriting the equations for @xmath50 : @xmath51 with @xmath52 all the components of @xmath53 have the same units as well as @xmath54 [ 1/length ] .",
    "the actual conserved variables used in the code are then @xmath55 , fluxes are @xmath56 , so that @xmath57 and @xmath58 does not include the factor @xmath46 ( cf .",
    ". [ umu ] ) .",
    "[ eqns1 ] provides the explicit form of the energy - momentum and charge conservation equations which are solved numerically .    in the same way as it was done for energy - momentum conservation equations ,",
    "we separate the factors @xmath46 from @xmath15 as follows : @xmath59 ,  @xmath60 , as well as @xmath61 and @xmath62",
    ". then we rewrite ( [ evolutionshear],[evolutionbulk ] ) in terms of tilded variables : @xmath63 and solve the above equations numerically . here",
    "@xmath64 and @xmath65 ( @xmath66 ) are the components of 3-velocity .",
    "the additional source terms are : @xmath67\\tilde u^\\lambda\\tilde{\\partial}_{;\\lambda } \\tilde u_\\beta - i^{\\mu\\nu}_{\\pi , g } , \\label{ipi}\\\\   i_\\pi&=-\\frac 4 3 \\pi\\,\\tilde{\\partial}_{;\\gamma}\\tilde u^\\gamma,\\end{aligned}\\ ] ] where in a given coordinate system all covariant derivatives of the four - velocity are equal to ordinary derivatives , except for : @xmath68 so that @xmath69 . also , @xmath70 denote geometrical source terms ( coming from christoffel symbols ) : @xmath71 most of the tests presented below , as well as heavy - ion related simulations , are performed in milne coordinates",
    ". however , to perform shock tube test we use a version of the code which works in cartesian coordinates . in the latter case",
    "we solve the original hydrodynamic equations ( [ energyconserv ] ) , as well as @xmath72 in ( [ ipi ] ) .",
    "as a result , transformations ( [ tildetransform ] ) and ( [ eqns1 ] ) and tilde notation in general are not used , and @xmath26 coordinate stands for the third direction in space .",
    "let us rewrite eq .",
    "[ energyconserv ] in a form of evolution equations in minkowski spacetime for simplicity : @xmath73 where index @xmath74 denotes spatial dimensions . @xmath75 and @xmath76 are conventionally called conserved quantities , if the fluxes at the spatial boundaries of the system vanish or compensate each other , then @xmath77 is conserved .",
    "also , @xmath78 and @xmath79 are flux terms .",
    "we use a finite volume method to solve hydrodynamic equations ( [ conservativeform]),([conservativeform2 ] ) . in this method ,",
    "one works in terms of the averaged values of @xmath80 in mesh @xmath74 , which in one dimension reads : @xmath81 and time - averaged fluxes through left and right facets of the mesh : @xmath82 then , integrating the conservation laws ( [ conservativeform ] ) within @xmath83 $ ] and @xmath84 $ ] , one gets the exact relation between the conserved quantities and the fluxes : @xmath85 which can be used to propagate @xmath86 to the next timestep .",
    "the idea of the godunov method @xcite is to take a piecewise uniform distribution of @xmath87 on a mesh and to provide an estimate for @xmath88 based on exact or approximate solution of the riemann problem at @xmath89 with initial left and right state parameters @xmath90 and @xmath91 , respectively . in the next timestep , the wave structure from a riemann problem at previous timestep",
    "is completely discarded and piecewise uniform distributions for @xmath92 are used again .",
    "one can estimate the criterion of stability for such schemes from the courant - friedrichs - lewy condition @xcite , which is a necessary condition for numerical scheme to be stable .",
    "for the godunov scheme , the criterion is @xmath93 , where @xmath94 is a maximal value of the signal velocity . to be on the safe side , we assume @xmath95 and use @xmath96 .    in milne coordinates the definition of conserved quantities and fluxes are modified as deduced from the transformed energy - momentum conservation equations ( [ eqns1 ] ) : @xmath97 @xmath98 as well as now there are nonzero source terms in ( [ num1 ] ) . for the case of a viscous fluid one can decompose the conserved quantities and fluxes into their ideal and viscous parts :",
    "@xmath99 where @xmath100 , and @xmath101 denote viscous corrections to conserved quantities , fluxes and source terms respectively .    then , the effects of ideal and viscous fluxes / sources in eq .",
    "( [ num2 ] ) can be accounted for separately , in the same way as it is done in @xcite : @xmath102 @xmath103 note that there are only ideal quantities in ( [ num1ideal ] ) , whereas ( [ num1visc ] ) describes viscous corrections to the evolution .",
    "the full solution ( [ num2 ] ) for one timestep then proceeds in the substeps : + * substep 1 ) * @xmath104 is obtained by evolving only the ideal part of the energy - momentum tensor , eq . [ num1ideal ] over the full timestep @xmath105 using godunov - type method .",
    "+ * substep 2 ) * the israel - stewart equations eq .",
    "[ evolshearfinal],[evolbulkfinal ] are solved to propagate @xmath15 and @xmath16 for the next timestep .",
    "here one has to know the values of shear / bulk terms in the navier - stokes limit , @xmath106 , which depend on velocity gradients .",
    "we calculate @xmath106 at @xmath107 ( half - step ) using @xmath108 and @xmath109 @xmath110 where central differences are used for second order of accuracy .",
    "the asterisk ( * ) denotes the values obtained from substep 1 ( updated with only ideal fluxes / sources ) . +",
    "* substep 3 ) * @xmath111 is obtained by evolving eq .",
    "( [ num1visc ] ) over the full timestep @xmath105 with viscous fluxes / sources only . the initial condition for this substep is @xmath112 , the first term obtained from the solution of substep 1 .",
    "+ to update @xmath113 according to eq .",
    "( [ num1visc ] ) , we use edge / half - step values of flux / source terms @xmath114 , @xmath115 , saved at substep 2 .    note that for the splitting itself , eq . [ num1ideal],[num1visc ] , no assumption of the smallness of the viscous corrections is needed . however the assumption becomes necessary when we calculate the fluxes in the evolution equations .",
    "for example , when one calculates @xmath116 for the ideal substep one assumes that the godunov method works well , which is proven to be the case for hydrodynamics of inviscid fluid .",
    "thus , we can apply the scheme for nearly perfect fluids , keeping in mind that viscosity should only introduce ( small ) corrections to the evolution .    in what follows",
    "we describe substeps 1 and 2 in detail , whereas the application of eq .",
    "( [ num1visc ] ) for substep 3 is straightforward .      for the godunov - type method employed in substep 1",
    ", we use an approximate solution to the riemann problem constructed with the relativistic extension of the hlle solver .",
    "below we provide the main points of the method , whereas for a detailed description the reader is referred to @xcite .",
    "in the hlle method , the evolution of initial discontinuity ( riemann problem ) between left @xmath117 and right @xmath118 states is approximated by a single uniform intermediate state bounded by two shock waves propagating to the left and to the right from the initial discontinuity , as seen in fig .",
    "[ fighlle ] . within this approximation , by integrating the hydrodynamic equations over @xmath119 $ ] and @xmath120 $ ] one can derive the properties of the intermediate state with the algebraic relations : @xmath121 and the corresponding flux : @xmath122 where @xmath123 enumerates the lorentz index and charge index .",
    "for the completeness of the scheme one has to specify the signal velocities @xmath124 .",
    "we take an advanced estimate for signal velocities from @xcite : @xmath125 where @xmath126 , @xmath127 , and @xmath128 together with the suggested value of @xmath129 .    for cells facing with vacuum , i.e. when",
    "@xmath130 or @xmath131 , we put @xmath132 or @xmath133 respectively .    for the second order accuracy of the scheme in space , a piecewise linear distributions in the cells ( ` muscl ` scheme ) are introduced .",
    "we reconstruct the values at right and left cell boundary ( @xmath134 ) as follows : @xmath135 here we use the so - called ` minmod ` slope limiter : @xmath136 where @xmath137 , @xmath138 are used .",
    "the slope limiter choses the smallest possible slope , and does not introduce new extrema . therefore it avoids possible oscillations in the numerical solution .    to employ the piecewise linear distributions we substitute @xmath139 , @xmath140 ( and correspondingly @xmath141 , @xmath142 etc . ) in eq .",
    "[ qhlle],[fhlle ] .    for the second order accuracy in time we use the half - step ( or predictor - corrector ) method .",
    "first we propagate the evolution for half of timestep : @xmath143 then the propagation is performed for a full timestep , based on fluxes and source terms calculated from @xmath144 : @xmath145 where @xmath146 , @xmath147 and the propagated @xmath148 is marked by an asterisk to keep the notation consistent with ( [ num1ideal],[num1visc ] ) .",
    "this completes the description of the scheme in one spatial dimension . to perform the evolution in three dimensions",
    "we apply the hlle solver to calculate the fluxes through the cell boundaries independently for the @xmath30 , @xmath31 and @xmath149 directions .",
    "the predictor step reads : @xmath150 and the corrector step reads : @xmath151 where the half - step updated variables are calculated from the full three dimensional predictor step .",
    "it might happen that in a small amount of cells either @xmath152 or @xmath153 do not satisfy the requirement @xmath154 , which must hold since physical energy density is positive and the velocity @xmath155 .",
    "for these cases we proportionally rescale @xmath156 wherever needed for the condition to be satisfied .",
    "this results in negligible deviations in a total energy - momentum balance in the system .",
    "in parallel to energy - momentum conservation equations , we integrate the equations of motion for the viscous terms , eq .",
    "[ evolshearfinal],[evolbulkfinal].in the following we denote by @xmath157 either a component of @xmath15 or @xmath16 , since the structure of their evolution equations is the same , except for different geometrical source terms .",
    "we split this substep into :    * a ) * integration of source terms , which is performed using the predictor - corrector method : @xmath158 where @xmath159 as defined by ( [ ipi ] ) .",
    "optionally , if @xmath160 is small enough , following the idea in @xcite we use a formal solution to the equation with relaxation part only : @xmath161 and integrate @xmath162 separately .",
    "this is important since in heavy ion collision scenarios , depending on the ansatz and thermodynamical parameters taken , @xmath160 may be comparable to the timestep .",
    "* b ) * advection using first order upwind method : @xmath163 where @xmath164 , and @xmath165 @xmath166 with similar expressions for @xmath167 and @xmath168    the variables propagated for a half step are kept in memory and are used later for the calculation of the viscous fluxes and the source terms in the energy - momentum equations for the full timestep .",
    "we evolve 10 independent components of @xmath15 , thus taking into account only that it is a symmetric tensor .",
    "this allows to check the consistency of the numerical solution by verification the achieved accuracy for the resulting orthogonality relations @xmath169 and the tracelessness relation @xmath170 .",
    "an additional advantage is the simplicity of the velocity finding procedure , coming from the fact that one does not need to know the velocity to recover all components of @xmath15 .",
    "it has been checked that employing the lax - wendroff method for advection substep and strang splitting between advection / source substeps in heavy ion collision scenarios does not alter the evolution significantly .",
    "however , the upwind method is more stable for inhomogeneous distributions of @xmath15 emerging from fluctuating initial conditions in event - by - event hydrodynamic simulations for heavy ion collisions .",
    "the israel - stewart framework by itself does not restrict the values of the shear stress tensor or the bulk pressure . however , it is required that the viscous corrections are sufficiently small compared to the ideal quantities for the framework to be applicable .",
    "nevertheless , in the practical applications it sometimes happens that @xmath171 or @xmath172 are not small due to large gradients of @xmath8 when the lorentz - gamma factor is large .",
    "as a result , instabilities may develop in the hydrodynamical solution . to prevent this we monitor the conditions : @xmath173 where @xmath174 is some constant of the order one , but smaller than one .",
    "we rescale @xmath15 and @xmath16 where needed , to keep condition ( [ cutcond ] ) satisfied on all hydro grid points .",
    "we found that condition ( [ cutcond ] ) may only be violated in the regions with very small density during the matter expansion into the vacuum , as long as the initial conditions for dissipative quantities and values of relaxation times are within reasonable limits . in principle",
    "this indicates that in those regions the viscous hydrodynamic approximation becomes inapplicable .",
    "however , in heavy ion collision scenarios this does not affect the hydrodynamic evolution of the dense core region .",
    "the cell average @xmath175 is updated assuming that the values in neighbouring cells @xmath176 are known .",
    "this is not the case for the cells on the boundary of hydrodynamic grid . instead of introducing some special algorithm for them which depends on a type of boundary condition ,",
    "we do somewhat easier procedure and extend the computational grid to include two additional cells on either end ( in @xmath30,@xmath31,@xmath149 directions ) , called ghost cells . in applications to heavy ion collisions we study the matter expansion with vacuum .",
    "the computational boundary is therefore artificial and there should be no incoming signal , which means outflow ( non - reflecting ) boundary conditions . to realize it , at the beginning of each timestep the values of conservative variables in ghost cells",
    "are reset by the values from the nearest `` physical '' cell at either end of the grid , e.g. for @xmath30 direction : @xmath177 where physical cells are in the range @xmath178 $ ] .",
    "then the fluxes are calculated between _ all _ cells which have both neighbours in a given direction .      as was mentioned above",
    ", the conserved quantities @xmath179 , are used .",
    "for the completeness of the algorithm , one has to restore the so - called primitive variables - energy / charge densities and fluid velocity - several times during each timestep for each hydro cell : the fluxes / source terms have no explicit expressions in terms of @xmath180 . also the primitive variables are relevant for the output and further physical analysis",
    ". obviously the recovery procedure should be fast .",
    "we employ a procedure , based on the one dimensional numerical root search as described in [ appendvelfind ] .",
    "+     +     +",
    "* shock tube*. let us start with a one dimensional shock tube problem .",
    "we initialize the system with two uniform ( left and right ) states @xmath181 and @xmath182 , separated at @xmath183 by an imaginary membrane .",
    "the eos for a relativistic massless gas @xmath184 is used . to extract the temperature or entropy density ( for viscous hydro evolution ) in this eos we assume 2.5 massless quark degrees of freedom and @xmath185 degeneracy factor and @xmath186 for massless gluons . at @xmath187 the membrane",
    "is removed and the initial discontinuity decays into compression shock wave propagating into the region of smaller density and a rarefaction wave propagating in the opposite direction .",
    "for such a case an analytical solution exists .",
    "the comparison between the analytical and numerical solution is shown in fig .",
    "[ figshocktube ] , upper panel .",
    "no scale parameters are present in such setup and the solution is expressed in terms of the dimensionless variable @xmath188 . as it was pointed out in @xcite ,",
    "it is essential to explore how many timesteps it takes for the numerical solution to approach the analytical one .",
    "the situation does not depend on the cell size provided that the courant number @xmath189 is kept the same . since eulerian grid is used , the wave profile is being resolved by the number of grid points / cells which increases with time ( about 130 hydro cells at @xmath190 ) . from the comparison one can see at the @xmath191th timestep",
    "there is substantial smearing of the profile , while at the @xmath192th timestep the profile is practically undistinguishable from the analytical result .",
    "next , to check the dependence of the simulations on the grid direction ( rotational invariance ) we rotate the initial discontinuity by 45 degrees in the @xmath193 plane and consider the same rarefraction / shock wave profile propagating in diagonal direction .",
    "the results are presented in the middle panel of fig .",
    "[ figshocktube ] .",
    "one can see that the propagation in the diagonal direction is consistent with principal direction at @xmath194 , while there are some differences at @xmath195 when the numerical solution still does not approximate the analytical solution well .",
    "finally , the bottom panels of fig . [ figshocktube ] compare the simulations with shear viscosity to the solution of riemann problem in the ideal case .    in figs .",
    "[ figvacuum ] , [ figvacuum2 ] we consider a special case of the riemann problem with @xmath181 and @xmath196 .",
    "this corresponds to a matter expansion to vacuum . in this case",
    "the analytical solution further depends on the dimensionless variable @xmath197 , however at @xmath198 left and right ( vacuum ) states are connected with a rarefaction wave only , while the velocity of matter reaching the speed of light , @xmath199 at the boundary with vacuum .",
    "[ figvacuum ] shows the results for the energy density profile ( top ) and the velocity profile ( bottom ) .",
    "after @xmath190 timesteps the numerical solution approaches the analytical solution .",
    "for this simulation we choose @xmath200 , thus the rarefaction wave at @xmath190 is spread over 100 hydrodynamic cells .        , velocity profile.,title=\"fig:\",scaledwidth=49.0% ] +    since we take @xmath201 , one has to treat the rate of matter expansion to vacuum carefully . in the numerical solution , at each timestep matter from the boundary cells propagates to the next vacuum cells .",
    "this makes the effective velocity of the matter front to be @xmath202 , i.e. dependent on @xmath203 .",
    "we prevent this artefact by keeping the relative position of the matter front inside the cell , and allow to propagate to the next vacuum cell only after it crossed the current cell completely .",
    "* gubser flow*. recently , a family of analytical relativistic hydrodynamic solutions was found for three - dimensional expansion of a conformal fluid , @xmath184 .",
    "the solution assumes azimuthal symmetry in @xmath204 plane and longitudinal scaling flow @xcite : @xmath205^{4/3},\\end{aligned}\\ ] ] @xmath206 ,   &   u^\\eta = 0 \\\\ &",
    "u^x = \\frac{x}{r_t}\\sinh[k(\\tau , r_t ) ] ,   &   u^y = \\frac{y}{r_t}\\sinh[k(\\tau , r_t)]\\end{aligned}\\ ] ] @xmath207 where @xmath208 function has a meaning of transverse flow rapidity in milne coordinates .",
    "we set the parameters as follows : @xmath209",
    "@xmath210 [ arbitrary  units ] , @xmath211 [ arbitrary  units ] . fig .",
    "[ figgubser ] depicts the comparison of the numerical solution to the analytical gubser solution .",
    "the parameters correspond to an effective system size in transverse direction on the order of 1 fm , which is much smaller than the typical size of a heavy nucleus . due to the strong initial transverse flow and persistent longitudinal flow",
    "the system expands and cools down very quickly .",
    "the evolution of this challenging initial state is reproduced by the numerical solution accurately , even after 10 fm / c time the very rarefied final state is reproduced well .",
    ", transverse velocity profile , scaledwidth=49.0% ]      it is also important to check the accuracy of the scheme in the viscous case . viscosity complicates the equations of relativistic hydrodynamics drastically .",
    "thus analytical solutions exist only for very simple scenarios .",
    "first we consider the ( 0 + 1 ) dimensional bjorken case .",
    "the system is homogeneous in all space directions with @xmath212 ( which equals to scaling flow @xmath45 ) in the navier - stokes limit .",
    "then @xmath213 , and we obtain a modified bjorken equation for the energy density evolution : @xmath214 assuming an ideal massless gas eos , @xmath184 and @xmath215 , one obtains the analytical solution for @xmath216 in the viscous case as @xmath217.\\ ] ] for the ideal fluid case @xmath218 , the well known cooling law @xmath219 for the scaling flow is restored . to compare to the numerical solution , the system is initialized with an energy density of @xmath220 gev/@xmath221 at @xmath222 fm / c . using the eos for massless particles",
    "as described above , the initial temperature is @xmath223 mev .",
    "we set @xmath224 and @xmath225  fm ( so that navier - stokes limit is well approximated ) for the viscous case .",
    "[ figanalns ] shows the comparison of the numerical solution for temperature to the analytical solution for the inviscid and viscous cases .",
    "one observes an agreement between the numerical and the analytical solutions .         in analytical 0 + 1d solution to israel - stewart equations ( solid lines ) with the @xmath226 term ( indicated as `` full is '' ) and without it ( indicated as `` cut is '' ) .",
    "dashed line is numerical solution.,scaledwidth=49.0% ]    to check how well the integration scheme for viscous fluxes works at finite @xmath160 , we consider the evolution of the bulk pressure , @xmath227 or @xmath228 are all very similar , therefore we only discuss the evolution of the bulk pressure . ] in the same ( 0 + 1 ) dimensional case , but at finite @xmath229 . in this case , knowing that @xmath230 one has : @xmath231 eq . [ bulkisanal ] , _ without _ the term @xmath232 has an analytical solution expressed in terms of exponential integral function @xmath233 : @xmath234\\end{gathered}\\ ] ] the inclusion of the @xmath232 term leads to a more complicated analytical solution . in fig .",
    "[ figanalisbulk ] a comparison between both ( with and without the @xmath232 term ) analytical and numerical solutions is given .",
    "the specific set of parameters is @xmath235 , @xmath236  fm , @xmath237  fm and @xmath238 .",
    "one observes an excellent reproduction of both , the full and the `` cut '' ( with and without @xmath232 term , respectively ) analytical viscous solutions .",
    "let us now turn to a more realistic scenario .",
    "we compare the present hydrodynamic simulations for a physical scenario related to heavy ion collisions with the open techqm results @xcite .",
    "the initial state has full homogeneity in @xmath149 direction ( @xmath239 , which corresponds to longitudinal scaling flow @xmath45 ) and the initial conditions in the transverse ( @xmath193 ) plane are taken from the optical glauber model for symmetric nucleus - nucleus collision : @xmath240^a \\right\\}+\\\\ c\\cdot t_a(r_x-\\frac{b}{2},r_y)\\left\\ { 1-\\left[1-t_a(r_x+\\frac{b}{2},r_y)\\frac{\\sigma_{nn}}{a}\\right]^a \\right\\ } , \\label{icglauber}\\end{gathered}\\ ] ] where the nuclear thickness function @xmath241 is normalized so that @xmath242 , and @xmath243 + 1)$ ] is the density distribution for nucleons in the nucleus . for au - au collision",
    "the parameters are @xmath244 , @xmath245  fm , @xmath246  fm , @xmath247  mb is the inelastic nucleon - nucleon cross section and @xmath174 is chosen so that @xmath248  gev/@xmath221 .",
    "again we use the eos for a relativistic massless gas , @xmath184 , assuming 2.5 massless quark degrees of freedom .",
    "the degeneracy factors are @xmath185 for quarks and",
    "@xmath186 for gluons .    for viscous hydrodynamic simulations the bulk viscosity",
    "is set to zero , @xmath15 at @xmath249 is initialized with the navier - stokes values , yielding @xmath250 .",
    "the relaxation time for the shear is taken as @xmath251 .",
    "averaged radial flow as a function of proper time for our hydro code ( vhlle ) compared to ` vish2 + 1 ` @xcite.,scaledwidth=50.0% ]    fig .",
    "[ figradflowsong ] shows the comparison between the present simulations and the ( 2 + 1 ) dimensional result by song and heinz for the average transverse velocity as a function of evolution time @xmath47 for initial conditions with impact parameter @xmath252 .",
    "the average is defined as @xmath253 where @xmath254 and the integration is made for a slice of the system ( cells ) with rapidity @xmath255 .",
    "shear viscosity works to equalize the expansion in different directions , thus decreasing work in longitudinal direction and accelerating the transverse expansion .",
    "this results in an additional acceleration of the transverse radial flow .",
    "our results on the radial expansion for the ideal and viscous case are consistent with the benchmark results from the ` vish2 + 1 ` code .",
    "flow anisotropies @xmath256 and @xmath257 ( see text for explanation ) as a function of proper time for our hydro code ( vhlle ) compared to ` vish2 + 1 ` @xcite.,scaledwidth=50.0% ]    in the same way shear viscosity suppresses the development of flow anisotropies in the transverse plane , the latter being generated by anisotropic pressure gradients in hydrodynamics . to explore this effect , we set the initial conditions to @xmath258  fm . fig .",
    "[ figepsilonpsong ] shows the corresponding time evolution of the flow anisotropy , defined as @xmath259 @xmath260 where @xmath261 .",
    "the quantities @xmath256 and @xmath257 are calculated using the ideal part of the energy - momentum tensor and the full energy - momentum tensor , respectively .",
    "the observed suppression of @xmath256 in the viscous case relative to the ideal case comes solely from the rearrangement of collective flow , while @xmath257 is suppressed stronger due to contributions from @xmath15 .",
    "the results are consistent with the benchmark results from the ` vish2 + 1 ` code @xcite .",
    "iso - thermal surface corresponding to @xmath262  mev obtained with our hydro code ( vhlle ) compared to the results from ` vish2 + 1 ` @xcite.,scaledwidth=50.0% ]    finally , in fig .",
    "[ figfreezeoutsong ] we show the iso - thermal surfaces for the case @xmath252 corresponding to temperature @xmath262  mev ( or @xmath263  gev/@xmath221 ) . the small differences ( less than @xmath264  fm )",
    "are related to the details ( interpolation scheme ) of the freezeout surface resolution .",
    "the present scheme is conservative when minkowski coordinates are used .",
    "however it loses the conservation property in milne coordinates because the source terms are non - zero , and the accuracy of total energy conservation is determined by the source term integration part . to quantify the numerical accuracy of the energy conservation in a physical scenario , we run the code with initial conditions from the glauber model ( eq .",
    "[ icglauber ] ) with a limited rapidity profile , so that there is no energy / momentum leak through the grid edges in rapidity : @xmath265\\end{gathered}\\ ] ] where @xmath266 corresponds to the beam rapidity , @xmath267 , and @xmath268 is the size of plateau around midrapidity .",
    "the hydrodynamic grid consists of @xmath269 cells with @xmath270  fm / c , @xmath271 units , and corresponding @xmath272 .",
    "the total energy on the hypersurface of constant @xmath47 is defined as @xmath273 , which can be expanded as : @xmath274\\end{gathered}\\ ] ] @xmath275    numerically @xmath276 .",
    ".total energy and entropy calculated in the beginning [ @xmath277 fm / c ] and in the end [ @xmath278 fm / c ] of 3d hydrodynamic evolution with initial energy density profile ( [ epsilon0_3d ] ) for different viscosity / eos combinations .",
    "small numbers in parentheses denote percentage of increase compared to the value at @xmath277 fm / c . [",
    "cols=\"^,^,^,^\",options=\"header \" , ]     it is important to note that in israel - stewart framework the entropy current @xmath279 includes non - equilibrium corrections : @xmath280 where the coefficient in front of @xmath281 is taken consistently with the evolution equations ( [ ipi ] ) , and @xmath282 since we consider shear viscosity only .    the resulting values of total energy and entropy in the beginning and in the end of hydrodynamic evolution are shown in table [ tbetot ] .",
    "we conclude that energy is conserved on a level better than 3% .",
    "since we study the effects of physical viscosity with the code , the important question which has to be answered is : what amount of numerical viscosity the code has , and how does it depend on the parameters ?    to study this , we follow the method used in @xcite and examine the sound wave attenuation in numerical hydrodynamic solution .",
    "the initial conditions for 1d hydrodynamic simulation in minkowski coordinates are taken as @xmath283 supplemented by an eos for an ultrarelativistic gas , @xmath184 .",
    "given that @xmath284 , this represents a sound wave with length @xmath285 propagating on the static uniform background with energy density @xmath286 .",
    "we link the last cell in @xmath30 direction to the first one to set up periodic boundary conditions on the hydro mesh , so that @xmath287 , @xmath288 .",
    "this setup mimics the propagation of a plain sound wave over an infinite medium . in hydrodynamics",
    "the attenuation ( or damping ) of the sound wave amplitude is only possible due to viscosity .",
    "provided that the damping is not fast ( i.e. that the amplitude does not change significantly during one cycle ) there is an analytical expression for the amplitude of sound wave after one cycle @xmath289 : @xmath290 here and further @xmath291 . however , due to the presence of numerical dissipation , the attenuation of the sound wave is also possible even with zero physical viscosity . to quantify the differences between the solutions",
    "we calculate the l1 norm for the energy density function on one - wavelength segment , defined as : @xmath292 which is compared to the same quantity based on the difference between inviscid and viscous solutions : @xmath293 for the latter quantity , in the limit of an infinitely small cell size one gets an analytical result : @xmath294 which is also quite accurate for finite cell size .",
    "comparing the two quantities , @xmath295 one gets : @xmath296\\ ] ]     and corresponding @xmath297 values ( the latter using upper estimate for the temperature @xmath298  gev ) observed from sound wave attenuation for different grid sizes.,scaledwidth=50.0% ]    we initialize the system with the following parameter values : @xmath299 fm , @xmath300 gev/@xmath221 and @xmath301 gev/@xmath221 .",
    "the values of the resulting numerical viscosity for different grid sizes are shown in fig .",
    "[ figetanum ] .",
    "since the shear viscosity coefficient is proportional to density , the relevant ( and dimensionless ) quantity for relativistic case is the ratio of shear viscosity to entropy density , @xmath302 . assuming zero chemical potential , one gets : @xmath303.\\ ] ] note that since @xmath304 , the above expression depends only on @xmath285 and @xmath305 . assuming @xmath298  gev as an upper estimate for the initial phase of the hydrodynamic expansion in a+a collisions and @xmath299  fm",
    ", one gets @xmath306 for @xmath307 . for @xmath308 , which is a typical grid size for the physical simulations , @xmath309 .",
    "i.e. , the value of the numerical viscosity to entropy density is about 50 times smaller than the lower bound for the physical viscosity @xmath310 .",
    "we should finally note that the estimate does not guarantee that a similar amount of numerical viscosity is present in full - fledged ( 3 + 1 ) dimensional simulations of matter expansion with the given code . to estimate the numerical viscosity in arbitrary geometry is a rather complicated topic beyond this paper .",
    "we have presented a detailed description and test results of a ( 3 + 1 ) dimensional relativistic viscous hydrodynamic code based on the godunov method and the relativistic hlle approximation for the solution of the riemann problem for its inviscid part .",
    "this choice ensures that the code is capable of treating shock wave configurations accurately .",
    "it has been shown that the code is capable of solving the equations of relativistic viscous hydrodynamics in the israel - stewart framework with the help of the ideal - viscous splitting method .",
    "we have presented the results of several test problems : the 1 dimensional ( 2 dimensional ) shock tube , gubser flow and two analytical viscous hydrodynamic solutions .",
    "the numerical viscosity of the code in the inviscid case has been estimated and found to be sufficiently small .",
    "the primary application of the code is the simulations of the hydrodynamic expansion of qcd matter created in relativistic heavy ion collisions . for this aim",
    "we have also checked the code against the test cases by the techqm group .",
    "the authors acknowledge the financial support by the extreme matter institute emmi and hessian loewe initiative .",
    "the work of p.h . was supported by bmbf under contract no . 06fy9092 .",
    "computational resources have been provided by the center for scientific computing ( csc ) at the goethe - university frankfurt .",
    "an important part of hydrodynamic algorithm is the procedure to find the flow velocity @xmath311 , energy density @xmath12 and densities of conserved charges @xmath312 in the fluid rest frame from the conserved variables @xmath313 .",
    "the procedure is essentially the same for inviscid and viscous cases . in the latter case to account for shear viscosity , one has to subtract the @xmath314 ( which are evolved independently with is equations ) from the total energy - momentum tensor : @xmath315 .",
    "the definition of the energy - momentum tensor of the fluid gives the following system of equations : @xmath316 in terms of @xmath12 , @xmath317 , @xmath318 , @xmath319 and @xmath320 ( @xmath7 is numbering the conserved charges ) , which is closed with an equation of state : @xmath321 due to the symmetry of the equations , @xmath322 .",
    "this allows one to reduce the problem to a one - dimensional equation for the absolute value of the velocity , which has to be solved numerically @xcite : @xmath323 then the rest of unknowns are recovered as @xmath324 for non - exotic equation of state eq .",
    "( [ velocityroot ] ) has exactly one root in the interval @xmath325 and is solved with newton s method .",
    "t. hirano , k.  tsuda , k.  kajimoto , arxiv : nucl - th/0011087 ; + t. hirano , phys .",
    "c * 65 * ( 2002 ) 011901 .",
    "kolb , j.  sollfrank , u.  heinz , phys .",
    "c * 62 * ( 2000 ) 054909 .",
    "aguiar , t.  kodama , t.  osada , y.  hama , j.  phys .",
    "g * 27 * ( 2001 ) 75 ; t.  kodama , c.e .",
    "aguiar , t.  osada , y.  hama , j.  phys .",
    "g * 27 * ( 2001 ) 557 . c. nonaka , s.  a.  bass , phys .",
    "c * 75 * ( 2007 ) 014902 ; c.  nonaka , e.  honda and s.  muroya , eur .  phys .",
    "j.  c * 17 * ( 2000 ) 663 .",
    "h. song , u.  heinz , phys .",
    "c * 77 * ( 2008 ) 064901 .",
    "r. baier , p.  romatschke , eur .",
    "j.  c * 51 * ( 2007 ) 677 - 687 .",
    "a. muronga , phys .",
    "c * 76 * ( 2007 ) 014909 .",
    "s. pratt , j.  vredevoogd , phys .",
    "c * 78 * ( 2008 ) 054906 .",
    "h. petersen , j.  steinheimer , g.  burau , m.  bleicher , h.  stcker , phys .",
    "c * 78 * ( 2008 ) 044901 .",
    "e.  molnar , h.  niemi and d.  h.  rischke , eur .",
    "j.  c * 65 * ( 2010 ) 615 .",
    "b. schenke , s.  jeon , c.  gale , phys .",
    "c * 82 * ( 2010 ) 014903 .",
    "k. werner _",
    "c * 82 * ( 2010 ) 044904 .",
    "karpenko , yu.m .",
    "sinyukov , phys .",
    "c * 81 * ( 2010 ) 054903 .",
    "h. holopainen , h.  niemi , k.  eskola , phys .",
    "c * 83 * ( 2011 ) 034901 .",
    "p.  bozek , phys .",
    "c * 85 * ( 2012 ) 034901 .",
    "j. gerhard , v.  lindenstruth , m.  bleicher , comp .",
    "* 184 * ( 2013 ) 311 .",
    "y.  akamatsu , s.  inutsuka , c.  nonaka , m.  takamoto , j.  comput .",
    "* 256 * ( 2014 ) 34 - 54 .",
    "j.  noronha - hostler , g.  s.  denicol , j.  noronha , r.  p.  g.  andrade and f.  grassi , phys .",
    "c * 88 * ( 2013 ) 044916 .",
    "l.  del zanna _",
    "et al . _ , eur .",
    "j.  c * 73 * ( 2013 ) 2524 .",
    "j.  d.  bjorken , phys .",
    "d * 27 * ( 1983 ) 140 .",
    "a.  harten , p.d .",
    "lax , b.  van  leer , siam rev .",
    "* 25 * ( 1983 ) 35 ; + b.  einfeldt , siam j.  numer .",
    "25 * ( 1988 ) 294 .",
    "v.  schneider , u.  katscher , d.h .",
    "rischke , b.  waldhauser , j.a .",
    "maruhn , c.d .",
    "munz , j.  comput .",
    "* 105 * ( 1993 ) 92 - 107 .",
    "k.  werner , m.  bleicher , b.  guiot , iu .",
    "karpenko , t.  pierog , arxiv:1307.4379 [ nucl - th ] ; k.  werner , b.  guiot , iu .",
    "karpenko , t.  pierog , arxiv:1312.1233 [ nucl - th ] .",
    "karpenko , m.  bleicher , p.  huovinen , h.  petersen , arxiv:1310.0702 [ nucl - th ] ; arxiv:1311.0133 [ nucl - th ] .",
    "landau , e.m .",
    "fluid mechanics , pergamon press 1959 .",
    "w. israel , ann .",
    "* 100 * ( 1976 ) 310 ; stewart , proc .",
    "a * 357 * ( 1977 ) 59 ; w. israel and j.m .",
    "stewart , ann .",
    "phys .  * 118 * ( 1979 ) 341 . g. s. denicol , e. molnr , h. niemi , d. h. rischke , eur .  phys .",
    "j.  a , * 48 * 11 ( 2012 ) 170 .",
    "godunov , math .",
    "sbornik * 47 * ( 1959 ) 271 ; translated us joint publ .",
    "service , jprs 7226 , 1969 .",
    "r.  courant , k.o .",
    "friedrichs , and h.  lewy .",
    "* 100 * ( 1928 ) 32 - 74 .",
    "m. takamoto , s. inutsuka , j.  comput .",
    "* 230 * ( 2011 ) 7002 .",
    "rischke , s.  bernard , j.a .",
    "maruhn , nucl .",
    "phys .  a * 595 * ( 1995 ) 346 - 382 .",
    "gubser , phys .",
    "d * 82 * ( 2010 ) 85027 .",
    "techqm working group , https://wiki.bnl.gov/techqm/index.php/bulk_evolution m.  laine and y.  schroder , phys .",
    "d * 73 * ( 2006 ) 085009 ."
  ],
  "abstract_text": [
    "<S> we describe the details of 3 + 1 dimensional relativistic hydrodynamic code for the simulations of quark - gluon / hadron matter expansion in ultra - relativistic heavy ion collisions . </S>",
    "<S> the code solves the equations of relativistic viscous hydrodynamics in the israel - stewart framework . with the help of ideal - viscous splitting </S>",
    "<S> , we keep the ability to solve the equations of ideal hydrodynamics in the limit of zero viscosities using a godunov - type algorithm . </S>",
    "<S> milne coordinates are used to treat the predominant expansion in longitudinal ( beam ) direction effectively . </S>",
    "<S> the results are successfully tested against known analytical relativistic inviscid and viscous solutions , as well as against existing 2 + 1d relativistic viscous code . </S>"
  ]
}